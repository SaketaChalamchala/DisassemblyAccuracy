;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	FEFD3AE3ED74C113C38A5C4B98CAA4AD
; Input	CRC32 :	50BE49F2

; File Name   :	C:\compspace\compare\gpg\dlls\full\gpg-protect-tool.exe
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 000270D4 ( 159956.)
; Section size in file		: 00027200 ( 160256.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
; [00000002 BYTES: COLLAPSED FUNCTION nullsub_1]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401010	proc near		; DATA XREF: .CRT:00433004o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch

		sub	esp, 2Ch
		mov	eax, ds:dword_430524
		mov	[esp+2Ch+var_1C], offset dword_430018
		mov	[esp+2Ch+var_24], offset dword_43000C
		mov	[esp+2Ch+var_28], offset dword_430008
		mov	ds:dword_430018, eax
		mov	eax, ds:dword_430528
		mov	[esp+2Ch+var_2C], offset dword_430004
		mov	[esp+2Ch+var_20], eax
		call	__getmainargs
		mov	ds:dword_43001C, eax
		add	esp, 2Ch
		retn
sub_401010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401060	proc near		; DATA XREF: .CRT:00433010o

var_1C		= dword	ptr -1Ch

		sub	esp, 1Ch
		xor	eax, eax
		cmp	word ptr ds:400000h, 5A4Dh
		mov	ds:dword_430534, 1
		mov	ds:dword_430530, 1
		mov	ds:dword_43052C, 1
		mov	ds:dword_430540, 1
		jz	short loc_401100

loc_401098:				; CODE XREF: sub_401060+B6j
					; sub_401060+C8j ...
		mov	ds:dword_430014, eax
		mov	eax, ds:dword_430544
		test	eax, eax
		jz	short loc_4010F0
		mov	[esp+1Ch+var_1C], 2
		call	__set_app_type

loc_4010B2:				; CODE XREF: sub_401060+9Cj
		mov	[esp+1Ch+var_1C], 0FFFFFFFFh
		call	sub_426140
		mov	edx, ds:dword_430548
		mov	ds:dword_430998, eax
		mov	ds:dword_43099C, eax
		mov	eax, ds:_fmode
		mov	[eax], edx
		call	sub_426480
		cmp	dword_42930C, 1
		jz	short loc_401150
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4010F0:				; CODE XREF: sub_401060+44j
		mov	[esp+1Ch+var_1C], 1
		call	__set_app_type
		jmp	short loc_4010B2
; ---------------------------------------------------------------------------
		align 10h

loc_401100:				; CODE XREF: sub_401060+36j
		mov	edx, ds:40003Ch
		cmp	dword ptr [edx+400000h], 4550h
		lea	ecx, [edx+400000h]
		jnz	short loc_401098
		movzx	edx, word ptr [ecx+18h]
		cmp	dx, 10Bh
		jz	short loc_401162
		cmp	dx, 20Bh
		jnz	loc_401098
		cmp	dword ptr [ecx+84h], 0Eh
		jbe	loc_401098
		mov	edx, [ecx+0F8h]
		xor	eax, eax
		test	edx, edx
		setnz	al
		jmp	loc_401098
; ---------------------------------------------------------------------------
		align 10h

loc_401150:				; CODE XREF: sub_401060+81j
		mov	[esp+1Ch+var_1C], offset sub_426420
		call	sub_426410
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_401162:				; CODE XREF: sub_401060+C1j
		cmp	dword ptr [ecx+74h], 0Eh
		jbe	loc_401098
		mov	ecx, [ecx+0E8h]
		xor	eax, eax
		test	ecx, ecx
		setnz	al
		jmp	loc_401098
sub_401060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_401180	proc near		; CODE XREF: .text:004014C5j start+15j

dwMilliseconds	= dword	ptr -88h
lpProcName	= dword	ptr -84h
Size		= dword	ptr -80h
var_6D		= byte ptr -6Dh
var_6C		= dword	ptr -6Ch
var_5C		= byte ptr -5Ch
var_30		= byte ptr -30h
var_2C		= word ptr -2Ch

		push	ebp
		xor	eax, eax
		mov	ebp, esp
		mov	ecx, 11h
		push	edi
		push	esi
		lea	edx, [ebp+var_5C]
		push	ebx
		mov	edi, edx
		sub	esp, 7Ch
		rep stosd
		mov	al, 30h
		call	sub_4271F0
		sub	esp, eax
		lea	eax, [esp+88h+var_6D]
		and	eax, 0FFFFFFF0h
		mov	dword ptr [eax], 0CCCCCCCCh
		mov	dword ptr [eax+4], 0CCCCCCCCh
		mov	dword ptr [eax+8], 0CCCCCCCCh
		mov	dword ptr [eax+0Ch], 0CCCCCCCCh
		mov	dword ptr [eax+10h], 0CCCCCCCCh
		mov	dword ptr [eax+14h], 0CCCCCCCCh
		mov	dword ptr [eax+18h], 0CCCCCCCCh
		mov	dword ptr [eax+1Ch], 0CCCCCCCCh
		and	esp, 0FFFFFFF0h
		mov	eax, ds:dword_430544
		test	eax, eax
		jnz	loc_401473

loc_4011EE:				; CODE XREF: sub_401180+2FFj
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_401214
; ---------------------------------------------------------------------------
		align 10h

loc_401200:				; CODE XREF: sub_401180+B1j
		cmp	eax, ebx
		jz	loc_401420
		mov	[esp+88h+dwMilliseconds], 3E8h ; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_401214:				; CODE XREF: sub_401180+7Dj
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], ebx
		mov	[esp+88h+dwMilliseconds], offset dword_4309A0
		call	sub_4274E0
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_401200
		mov	eax, ds:dword_4309A4
		xor	ebx, ebx
		cmp	eax, 1
		jz	loc_401433

loc_401243:				; CODE XREF: sub_401180+2ADj
		mov	eax, ds:dword_4309A4
		test	eax, eax
		jz	loc_401484
		mov	ds:dword_430000, 1

loc_40125A:				; CODE XREF: sub_401180+322j
		mov	eax, ds:dword_4309A4
		cmp	eax, 1
		jz	loc_401450

loc_401268:				; CODE XREF: sub_401180+2C7j
					; sub_401180+2EEj
		test	ebx, ebx
		jnz	short loc_401273
		lock xchg ebx, ds:dword_4309A0

loc_401273:				; CODE XREF: sub_401180+EAj
		mov	eax, ds:off_42ED98
		test	eax, eax
		jz	short loc_401298
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], 2
		mov	[esp+88h+dwMilliseconds], 0
		call	eax ; TlsCallback_0
		sub	esp, 0Ch

loc_401298:				; CODE XREF: sub_401180+FAj
		call	sub_426730
		mov	[esp+88h+dwMilliseconds], offset TopLevelExceptionFilter ; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	ds:dword_43054C, eax
		call	sub_426CE0
		mov	[esp+88h+lpProcName], offset ProcName ;	"_set_invalid_parameter_handler"
		mov	[esp+88h+dwMilliseconds], eax ;	hModule
		call	ds:GetProcAddress
		sub	esp, 8
		test	eax, eax
		jz	short loc_4012D8
		mov	[esp+88h+dwMilliseconds], offset nullsub_1
		call	eax

loc_4012D8:				; CODE XREF: sub_401180+14Dj
		call	sub_426DA0
		mov	eax, ds:dword_430544
		test	eax, eax
		jz	short loc_401344
		mov	eax, ds:_acmdln
		xor	ecx, ecx
		mov	eax, [eax]
		jmp	short loc_4012FC
; ---------------------------------------------------------------------------

loc_4012F1:				; CODE XREF: sub_401180+182j
		test	dl, dl
		jz	short loc_401320
		test	cl, cl
		jz	short loc_401315

loc_4012F9:				; CODE XREF: sub_401180+18Fj
		add	eax, 1

loc_4012FC:				; CODE XREF: sub_401180+16Fj
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_4012F1
		mov	ebx, ecx
		xor	ebx, 1
		cmp	dl, 22h
		cmovz	ecx, ebx
		jmp	short loc_4012F9
; ---------------------------------------------------------------------------

loc_401311:				; CODE XREF: sub_401180+19Ej
		test	dl, dl
		jz	short loc_401320

loc_401315:				; CODE XREF: sub_401180+177j
		add	eax, 1
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_401311

loc_401320:				; CODE XREF: sub_401180+173j
					; sub_401180+193j
		movzx	edx, [ebp+var_2C]
		test	[ebp+var_30], 1
		mov	ds:dword_4308E4, eax
		mov	eax, 0Ah
		mov	ds:dword_4308EC, 400000h
		cmovnz	eax, edx
		mov	ds:dword_4308E8, eax

loc_401344:				; CODE XREF: sub_401180+164j
		mov	edx, ds:dword_430004
		xor	ebx, ebx
		lea	eax, ds:4[edx*4]
		mov	[ebp+var_6C], edx
		mov	[esp+88h+dwMilliseconds], eax ;	Size
		call	malloc
		mov	edi, ds:dword_430008
		mov	[ebp-70h], eax
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jle	short loc_4013AA
		xchg	ax, ax

loc_401370:				; CODE XREF: sub_401180+225j
		mov	eax, [edi+ebx*4]
		mov	[esp+88h+dwMilliseconds], eax ;	Str
		call	strlen
		lea	esi, [eax+1]
		mov	[esp+88h+dwMilliseconds], esi ;	Size
		call	malloc
		mov	edx, [ebp-70h]
		mov	[edx+ebx*4], eax
		mov	edx, [edi+ebx*4]
		add	ebx, 1
		mov	[esp+88h+Size],	esi ; Size
		mov	[esp+88h+dwMilliseconds], eax ;	Dst
		mov	[esp+88h+lpProcName], edx ; Src
		call	memcpy
		cmp	ebx, [ebp+var_6C]
		jnz	short loc_401370
		shl	ebx, 2

loc_4013AA:				; CODE XREF: sub_401180+1ECj
		mov	eax, [ebp-70h]
		mov	dword ptr [eax+ebx], 0
		mov	ds:dword_430008, eax
		call	sub_426E30
		mov	eax, ds:__initenv
		mov	edx, ds:dword_43000C
		mov	[eax], edx
		mov	eax, ds:dword_43000C
		mov	[esp+88h+Size],	eax
		mov	eax, ds:dword_430008
		mov	[esp+88h+lpProcName], eax
		mov	eax, ds:dword_430004
		mov	[esp+88h+dwMilliseconds], eax
		call	sub_4032E3
; ---------------------------------------------------------------------------
		mov	esi, ds:dword_430014
		test	esi, esi
		mov	ds:dword_430010, eax
		jz	loc_4014A7
		mov	ebx, ds:dword_430000
		test	ebx, ebx
		jnz	short loc_401411
		call	_cexit
		mov	eax, ds:dword_430010

loc_401411:				; CODE XREF: sub_401180+285j
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_401420:				; CODE XREF: sub_401180+82j
		mov	eax, ds:dword_4309A4
		mov	ebx, 1
		cmp	eax, 1
		jnz	loc_401243

loc_401433:				; CODE XREF: sub_401180+BDj
		mov	[esp+88h+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, ds:dword_4309A4
		cmp	eax, 1
		jnz	loc_401268
		lea	esi, [esi+0]

loc_401450:				; CODE XREF: sub_401180+E2j
		mov	[esp+88h+lpProcName], offset dword_433008
		mov	[esp+88h+dwMilliseconds], offset dword_433000
		call	_initterm
		mov	ds:dword_4309A4, 2
		jmp	loc_401268
; ---------------------------------------------------------------------------

loc_401473:				; CODE XREF: sub_401180+68j
		mov	[esp+88h+dwMilliseconds], edx ;	lpStartupInfo
		call	ds:GetStartupInfoA
		sub	esp, 4
		jmp	loc_4011EE
; ---------------------------------------------------------------------------

loc_401484:				; CODE XREF: sub_401180+CAj
		mov	ds:dword_4309A4, 1
		mov	[esp+88h+lpProcName], offset dword_433018
		mov	[esp+88h+dwMilliseconds], offset dword_43300C
		call	_initterm
		jmp	loc_40125A
; ---------------------------------------------------------------------------

loc_4014A7:				; CODE XREF: sub_401180+277j
		mov	[esp+88h+dwMilliseconds], eax ;	Code
		call	exit
sub_401180	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		mov	ds:dword_430544, 1
		call	sub_426E50
		add	esp, 0Ch
		jmp	sub_401180
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

		public start
start		proc near
		sub	esp, 0Ch
		mov	ds:dword_430544, 0
		call	sub_426E50
		add	esp, 0Ch
		jmp	sub_401180
start		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4014F0	proc near		; CODE XREF: sub_4280A0+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_429318
		test	eax, eax
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj-12.dll"
		call	ds:GetModuleHandleA
		mov	edx, 0
		sub	esp, 4
		test	eax, eax
		jz	short loc_40152E
		mov	[esp+18h+lpProcName], offset a_jv_registercl ; "_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	eax ; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		mov	edx, eax

loc_40152E:				; CODE XREF: sub_4014F0+26j
		test	edx, edx
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset dword_429318
		call	edx

locret_40153B:				; CODE XREF: sub_4014F0+Dj
					; sub_4014F0+40j
		leave
		retn
sub_4014F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401540()
sub_401540	proc near		; DATA XREF: sub_4280A0+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401540	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401550	proc near		; CODE XREF: sub_402D35+176p
					; sub_403806+10Ep

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_401550	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40155D	proc near		; DATA XREF: sub_4032E3+17o

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 29h ; switch 42 cases
		ja	short loc_4015C6 ; jumptable 00401576 default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_42A410
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_401578:				; CODE XREF: sub_40155D+19j
					; DATA XREF: .rdata:off_42A410o
		mov	[ebp+var_C], offset aGpgProtectTool ; jumptable	00401576 case 11
		jmp	short loc_4015CD
; ---------------------------------------------------------------------------

loc_401581:				; CODE XREF: sub_40155D+19j
					; DATA XREF: .rdata:off_42A410o
		mov	[ebp+var_C], offset a2_0_30 ; jumptable	00401576 case 13
		jmp	short loc_4015CD
; ---------------------------------------------------------------------------

loc_40158A:				; CODE XREF: sub_40155D+19j
					; DATA XREF: .rdata:off_42A410o
		mov	[ebp+var_C], offset aMingw32 ; jumptable 00401576 case 17
		jmp	short loc_4015CD
; ---------------------------------------------------------------------------

loc_401593:				; CODE XREF: sub_40155D+19j
					; DATA XREF: .rdata:off_42A410o
		mov	[esp+28h+var_28], offset aPleaseReportBu ; jumptable 00401576 case 19
		call	sub_420034
		mov	[ebp+var_C], eax
		jmp	short loc_4015CD
; ---------------------------------------------------------------------------

loc_4015A4:				; CODE XREF: sub_40155D+19j
					; DATA XREF: .rdata:off_42A410o
		mov	[esp+28h+var_28], offset aUsageGpgProtec ; jumptable 00401576 cases 1,40
		call	sub_420034
		mov	[ebp+var_C], eax
		jmp	short loc_4015CD
; ---------------------------------------------------------------------------

loc_4015B5:				; CODE XREF: sub_40155D+19j
					; DATA XREF: .rdata:off_42A410o
		mov	[esp+28h+var_28], offset aSyntaxGpgProte ; jumptable 00401576 case 41
		call	sub_420034
		mov	[ebp+var_C], eax
		jmp	short loc_4015CD
; ---------------------------------------------------------------------------

loc_4015C6:				; CODE XREF: sub_40155D+Aj
					; sub_40155D+19j
					; DATA XREF: ...
		mov	[ebp+var_C], 0	; jumptable 00401576 default case

loc_4015CD:				; CODE XREF: sub_40155D+22j
					; sub_40155D+2Bj ...
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40155D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4015D2	proc near		; CODE XREF: sub_401A61+3Cp

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_30], eax
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_34], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_38], eax
		call	gcry_sexp_sscan
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_401634
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		mov	edx, [ebp+var_18]
		mov	[esp+38h+var_2C], eax
		mov	[esp+38h+var_30], edx
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+38h+var_34], eax ;	char
		mov	[esp+38h+var_38], offset aInvalidSExpres ; "invalid S-Expression in `%s' (off=%u): "...
		call	sub_42091D
		mov	eax, 0
		jmp	locret_4016DE
; ---------------------------------------------------------------------------

loc_401634:				; CODE XREF: sub_4015D2+2Dj
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], 1
		mov	[esp+38h+var_38], eax
		call	gcry_sexp_sprint
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40167C
		mov	[esp+38h+var_30], 0D6h ; int
		mov	[esp+38h+var_34], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/agent/protect-tool."...
		mov	[esp+38h+var_38], offset aLen ;	"len"
		call	sub_4276E0

loc_40167C:				; CODE XREF: sub_4015D2+8Cj
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	gcry_xmalloc
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_10]
		mov	[esp+38h+var_2C], edx
		mov	edx, [ebp+var_14]
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+var_34], 1
		mov	[esp+38h+var_38], eax
		call	gcry_sexp_sprint
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4016D0
		mov	[esp+38h+var_30], 0D9h ; int
		mov	[esp+38h+var_34], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/agent/protect-tool."...
		mov	[esp+38h+var_38], offset aLen ;	"len"
		call	sub_4276E0

loc_4016D0:				; CODE XREF: sub_4015D2+E0j
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+var_38], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_14]

locret_4016DE:				; CODE XREF: sub_4015D2+5Dj
		leave
		retn
sub_4015D2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4016E0	proc near		; CODE XREF: sub_401AB5+A3p
					; sub_401BD6+10Dp ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_30], eax
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_34], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_38], eax
		call	gcry_sexp_sscan
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40173B
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		mov	edx, dword ptr [ebp+var_18]
		mov	[esp+38h+var_30], eax
		mov	[esp+38h+var_34], edx ;	char
		mov	[esp+38h+var_38], offset aInvalidCanonic ; "invalid canonical S-Expression (off=%u)"...
		call	sub_42091D
		mov	eax, 0
		jmp	locret_4017E5
; ---------------------------------------------------------------------------

loc_40173B:				; CODE XREF: sub_4016E0+2Dj
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], 3
		mov	[esp+38h+var_38], eax
		call	gcry_sexp_sprint
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_401783
		mov	[esp+38h+var_30], 0EEh ; int
		mov	[esp+38h+var_34], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/agent/protect-tool."...
		mov	[esp+38h+var_38], offset aLen ;	"len"
		call	sub_4276E0

loc_401783:				; CODE XREF: sub_4016E0+85j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	gcry_xmalloc
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_10]
		mov	[esp+38h+var_2C], edx
		mov	edx, [ebp+var_14]
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+var_34], 3
		mov	[esp+38h+var_38], eax
		call	gcry_sexp_sprint
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4017D7
		mov	[esp+38h+var_30], 0F1h ; int
		mov	[esp+38h+var_34], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/agent/protect-tool."...
		mov	[esp+38h+var_38], offset aLen ;	"len"
		call	sub_4276E0

loc_4017D7:				; CODE XREF: sub_4016E0+D9j
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+var_38], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_14]

locret_4017E5:				; CODE XREF: sub_4016E0+56j
		leave
		retn
sub_4016E0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4017E7(char *Filename, int)
sub_4017E7	proc near		; CODE XREF: sub_401A61+13p
					; sub_402637+19p ...

File		= dword	ptr -68h
ElementSize	= dword	ptr -64h
Count		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_50		= byte ptr -50h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
DstBuf		= dword	ptr -0Ch
Filename	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 60h
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset asc_42A541 ; "-"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	loc_401913
		mov	[ebp+var_14], 0
		mov	eax, ds:_iob
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[esp+68h+File],	eax ; File
		call	_fileno
		mov	[esp+68h+ElementSize], 8000h
		mov	[esp+68h+File],	eax
		call	_setmode
		mov	[ebp+DstBuf], 0
		mov	[ebp+var_10], 0

loc_401853:				; CODE XREF: sub_4017E7+121j
		add	[ebp+var_14], 2000h
		cmp	[ebp+DstBuf], 0
		jnz	short loc_401870
		mov	eax, [ebp+var_14]
		mov	[esp+68h+File],	eax
		call	gcry_xmalloc
		mov	[ebp+DstBuf], eax
		jmp	short loc_401885
; ---------------------------------------------------------------------------

loc_401870:				; CODE XREF: sub_4017E7+77j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+ElementSize], eax
		mov	eax, [ebp+DstBuf]
		mov	[esp+68h+File],	eax
		call	gcry_xrealloc
		mov	[ebp+DstBuf], eax

loc_401885:				; CODE XREF: sub_4017E7+87j
		mov	eax, [ebp+DstBuf]
		add	eax, [ebp+var_10]
		mov	edx, [ebp+var_18]
		mov	[esp+68h+var_5C], edx ;	File
		mov	[esp+68h+Count], 2000h ; Count
		mov	[esp+68h+ElementSize], 1 ; ElementSize
		mov	[esp+68h+File],	eax ; DstBuf
		call	fread
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 1FFFh
		ja	short loc_4018FB
		mov	eax, [ebp+var_18]
		mov	[esp+68h+File],	eax ; File
		call	ferror
		test	eax, eax
		jz	short loc_4018FB
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+File],	eax ; int
		call	strerror
		mov	[esp+68h+ElementSize], eax ; char
		mov	[esp+68h+File],	offset aErrorReadingSt ; "error	reading	`[stdin]': %s\n"
		call	sub_42091D
		mov	eax, [ebp+DstBuf]
		mov	[esp+68h+File],	eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_401A5A
; ---------------------------------------------------------------------------

loc_4018FB:				; CODE XREF: sub_4017E7+CDj
					; sub_4017E7+DCj
		mov	eax, [ebp+var_1C]
		add	[ebp+var_10], eax
		cmp	[ebp+var_1C], 2000h
		jz	loc_401853
		jmp	loc_401A4F
; ---------------------------------------------------------------------------

loc_401913:				; CODE XREF: sub_4017E7+2Ej
		mov	eax, offset Mode ; "rb"
		mov	[esp+68h+ElementSize], eax ; Mode
		mov	eax, [ebp+Filename]
		mov	[esp+68h+File],	eax ; Filename
		call	fopen
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_401962
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+File],	eax ; int
		call	strerror
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+Filename]
		mov	[esp+68h+ElementSize], eax ; char
		mov	[esp+68h+File],	offset aCanTOpenSS ; "can't open `%s': %s\n"
		call	sub_42091D
		mov	eax, 0
		jmp	loc_401A5A
; ---------------------------------------------------------------------------

loc_401962:				; CODE XREF: sub_4017E7+147j
		mov	eax, [ebp+var_18]
		mov	[esp+68h+File],	eax ; File
		call	_fileno
		lea	edx, [ebp+var_50]
		mov	[esp+68h+ElementSize], edx
		mov	[esp+68h+File],	eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		test	eax, eax
		jz	short loc_4019BF
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+File],	eax ; int
		call	strerror
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+Filename]
		mov	[esp+68h+ElementSize], eax ; char
		mov	[esp+68h+File],	offset aCanTStatSS ; "can't stat `%s': %s\n"
		call	sub_42091D
		mov	eax, [ebp+var_18]
		mov	[esp+68h+File],	eax ; File
		call	fclose
		mov	eax, 0
		jmp	loc_401A5A
; ---------------------------------------------------------------------------

loc_4019BF:				; CODE XREF: sub_4017E7+199j
		mov	eax, [ebp+var_38]
		mov	edx, [ebp+var_34]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[esp+68h+File],	eax
		call	gcry_xmalloc
		mov	[ebp+DstBuf], eax
		mov	eax, [ebp+DstBuf]
		mov	edx, [ebp+var_18]
		mov	[esp+68h+var_5C], edx ;	File
		mov	[esp+68h+Count], 1 ; Count
		mov	edx, [ebp+var_10]
		mov	[esp+68h+ElementSize], edx ; ElementSize
		mov	[esp+68h+File],	eax ; DstBuf
		call	fread
		cmp	eax, 1
		jz	short loc_401A44
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+File],	eax ; int
		call	strerror
		mov	[esp+68h+Count], eax
		mov	eax, [ebp+Filename]
		mov	[esp+68h+ElementSize], eax ; char
		mov	[esp+68h+File],	offset aErrorReadingSS ; "error	reading	`%s': %s\n"
		call	sub_42091D
		mov	eax, [ebp+var_18]
		mov	[esp+68h+File],	eax ; File
		call	fclose
		mov	eax, [ebp+DstBuf]
		mov	[esp+68h+File],	eax
		call	gcry_free
		mov	eax, 0
		jmp	short loc_401A5A
; ---------------------------------------------------------------------------

loc_401A44:				; CODE XREF: sub_4017E7+216j
		mov	eax, [ebp+var_18]
		mov	[esp+68h+File],	eax ; File
		call	fclose

loc_401A4F:				; CODE XREF: sub_4017E7+127j
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+DstBuf]

loc_401A5A:				; CODE XREF: sub_4017E7+10Fj
					; sub_4017E7+176j ...
		add	esp, 60h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4017E7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401A61(char *)
sub_401A61	proc near		; CODE XREF: sub_401AB5+Dp
					; sub_401BD6+Dp ...

Filename	= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Filename], eax	; Filename
		call	sub_4017E7
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_401A89
		mov	eax, 0
		jmp	short locret_401AB3
; ---------------------------------------------------------------------------

loc_401A89:				; CODE XREF: sub_401A61+1Fj
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Filename], eax
		call	sub_4015D2
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+var_10]

locret_401AB3:				; CODE XREF: sub_401A61+26j
		leave
		retn
sub_401A61	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401AB5(char *)
sub_401AB5	proc near		; CODE XREF: sub_4032E3+3F5p

Str		= dword	ptr -48h
Size		= dword	ptr -44h
Count		= dword	ptr -40h
File		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str], eax ; char *
		call	sub_401A61
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_401BCC
		mov	[esp+48h+Str], 1
		call	sub_403806
		mov	[ebp+var_10], eax
		lea	eax, [ebp+var_20]
		mov	[esp+48h+File],	eax
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+Count], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Size],	eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str], eax
		call	sub_404830
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str], eax
		call	sub_403991
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str], eax
		call	gcry_free
		cmp	[ebp+var_14], 0
		jz	short loc_401B42
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Str], eax
		call	gpg_strerror
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+Str], offset aProtectingTheK ;	"protecting the	key failed: %s\n"
		call	sub_42091D
		jmp	loc_401BD0
; ---------------------------------------------------------------------------

loc_401B42:				; CODE XREF: sub_401AB5+6Bj
		mov	eax, ds:dword_430024
		test	eax, eax
		jz	short loc_401B99
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Size],	edx
		mov	[esp+48h+Str], eax
		call	sub_4016E0
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Str], eax
		call	gcry_free
		cmp	[ebp+var_18], 0
		jz	short loc_401BCF
		mov	eax, [ebp+var_18]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_20], eax

loc_401B99:				; CODE XREF: sub_401AB5+94j
		mov	eax, ds:_iob
		lea	ecx, [eax+20h]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+File],	ecx ; File
		mov	[esp+48h+Count], 1 ; Count
		mov	[esp+48h+Size],	edx ; Size
		mov	[esp+48h+Str], eax ; Str
		call	fwrite
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Str], eax
		call	gcry_free
		jmp	short loc_401BD0
; ---------------------------------------------------------------------------

loc_401BCC:				; CODE XREF: sub_401AB5+19j
		nop
		jmp	short loc_401BD0
; ---------------------------------------------------------------------------

loc_401BCF:				; CODE XREF: sub_401AB5+BAj
		nop

loc_401BD0:				; CODE XREF: sub_401AB5+88j
					; sub_401AB5+115j ...
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_401AB5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401BD6(char *)
sub_401BD6	proc near		; CODE XREF: sub_4032E3+40Dp

Str		= dword	ptr -68h
Size		= dword	ptr -64h
Count		= dword	ptr -60h
File		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_3C		= dword	ptr -3Ch
var_30		= byte ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 64h
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Str], eax ; char *
		call	sub_401A61
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_401D57
		mov	[esp+68h+Str], 1
		call	sub_403806
		mov	dword ptr [ebp+var_10],	eax
		lea	eax, [ebp+var_20]
		mov	[esp+68h+var_58], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+68h+File],	eax
		lea	eax, [ebp+var_30]
		mov	[esp+68h+Count], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+68h+Size],	eax ; char
		mov	eax, [ebp+var_C]
		mov	[esp+68h+Str], eax
		call	sub_4056C4
		mov	[ebp+var_14], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+68h+Str], eax
		call	sub_403991
		mov	eax, [ebp+var_C]
		mov	[esp+68h+Str], eax
		call	gcry_free
		cmp	[ebp+var_14], 0
		jz	short loc_401C7F
		mov	eax, ds:dword_430044
		test	eax, eax
		jz	short loc_401C5F
		mov	[esp+68h+Str], offset aProtectToolBad ;	"[PROTECT-TOOL:] bad-passphrase\n"
		call	sub_4208F3

loc_401C5F:				; CODE XREF: sub_401BD6+7Bj
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Str], eax
		call	gpg_strerror
		mov	[esp+68h+Size],	eax ; char
		mov	[esp+68h+Str], offset aUnprotectingTh ;	"unprotecting the key failed: %s\n"
		call	sub_42091D
		jmp	loc_401D5B
; ---------------------------------------------------------------------------

loc_401C7F:				; CODE XREF: sub_401BD6+72j
		mov	eax, ds:dword_430904
		test	eax, eax
		jz	short loc_401CCD
		lea	eax, [ebp+var_30]
		add	eax, 0Dh
		mov	[esp+68h+var_50], eax
		lea	eax, [ebp+var_30]
		add	eax, 0Bh
		mov	[esp+68h+var_54], eax
		lea	eax, [ebp+var_30]
		add	eax, 9
		mov	[esp+68h+var_58], eax
		lea	eax, [ebp+var_30]
		add	eax, 6
		mov	[esp+68h+File],	eax
		lea	eax, [ebp+var_30]
		add	eax, 4
		mov	[esp+68h+Count], eax
		lea	eax, [ebp+var_30]
		mov	[esp+68h+Size],	eax ; char
		mov	[esp+68h+Str], offset aKeyProtectionD ;	"key protection	done at	%.4s-%.2s-%.2s %"...
		call	sub_4208F3

loc_401CCD:				; CODE XREF: sub_401BD6+B0j
		mov	eax, ds:dword_430024
		test	eax, eax
		jz	short loc_401D24
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_1C]
		mov	[esp+68h+Size],	edx
		mov	[esp+68h+Str], eax
		call	sub_4016E0
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+68h+Str], eax
		call	gcry_free
		cmp	[ebp+var_18], 0
		jz	short loc_401D5A
		mov	eax, [ebp+var_18]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_20], eax

loc_401D24:				; CODE XREF: sub_401BD6+FEj
		mov	eax, ds:_iob
		lea	ecx, [eax+20h]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_1C]
		mov	[esp+68h+File],	ecx ; File
		mov	[esp+68h+Count], 1 ; Count
		mov	[esp+68h+Size],	edx ; Size
		mov	[esp+68h+Str], eax ; Str
		call	fwrite
		mov	eax, [ebp+var_1C]
		mov	[esp+68h+Str], eax
		call	gcry_free
		jmp	short loc_401D5B
; ---------------------------------------------------------------------------

loc_401D57:				; CODE XREF: sub_401BD6+19j
		nop
		jmp	short loc_401D5B
; ---------------------------------------------------------------------------

loc_401D5A:				; CODE XREF: sub_401BD6+124j
		nop

loc_401D5B:				; CODE XREF: sub_401BD6+A4j
					; sub_401BD6+17Fj ...
		add	esp, 64h
		pop	edi
		pop	ebp
		retn
sub_401BD6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401D61(char *)
sub_401D61	proc near		; CODE XREF: sub_4032E3+428p

Str		= dword	ptr -58h
Size		= dword	ptr -54h
Count		= dword	ptr -50h
File		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_2D		= dword	ptr -2Dh
var_29		= dword	ptr -29h
var_25		= dword	ptr -25h
var_21		= dword	ptr -21h
var_1D		= byte ptr -1Dh
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	[ebp+var_2D], 333A3828h
		mov	[ebp+var_29], 33323331h
		mov	[ebp+var_25], 32343333h
		mov	[ebp+var_21], 2933343Ah
		mov	[ebp+var_1D], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str], eax ; char *
		call	sub_401A61
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	loc_401EBF
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+Count], eax ; int
		lea	eax, [ebp+var_2D]
		mov	[esp+58h+Size],	eax ; void *
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Str], eax ; int
		call	sub_40639D
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Str], eax
		call	gcry_free
		cmp	[ebp+var_14], 0
		jz	short loc_401DED
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Str], eax
		call	gpg_strerror
		mov	[esp+58h+Size],	eax ; char
		mov	[esp+58h+Str], offset aShadowingTheKe ;	"shadowing the key failed: %s\n"
		call	sub_42091D
		jmp	loc_401EC3
; ---------------------------------------------------------------------------

loc_401DED:				; CODE XREF: sub_401D61+6Aj
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+File],	0
		mov	[esp+58h+Count], 0
		mov	[esp+58h+Size],	0
		mov	[esp+58h+Str], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_401E35
		mov	[esp+58h+Count], 1BCh ;	int
		mov	[esp+58h+Size],	offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/agent/protect-tool."...
		mov	[esp+58h+Str], offset aResultlen ; "resultlen"
		call	sub_4276E0

loc_401E35:				; CODE XREF: sub_401D61+B6j
		mov	eax, ds:dword_430024
		test	eax, eax
		jz	short loc_401E8C
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_C]
		mov	[esp+58h+Size],	edx
		mov	[esp+58h+Str], eax
		call	sub_4016E0
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Str], eax
		call	gcry_free
		cmp	[ebp+var_18], 0
		jz	short loc_401EC2
		mov	eax, [ebp+var_18]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax

loc_401E8C:				; CODE XREF: sub_401D61+DBj
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+File],	edx ; File
		mov	[esp+58h+Count], 1 ; Count
		mov	edx, [ebp+var_C]
		mov	[esp+58h+Size],	edx ; Size
		mov	[esp+58h+Str], eax ; Str
		call	fwrite
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Str], eax
		call	gcry_free
		jmp	short loc_401EC3
; ---------------------------------------------------------------------------

loc_401EBF:				; CODE XREF: sub_401D61+39j
		nop
		jmp	short loc_401EC3
; ---------------------------------------------------------------------------

loc_401EC2:				; CODE XREF: sub_401D61+101j
		nop

loc_401EC3:				; CODE XREF: sub_401D61+87j
					; sub_401D61+15Cj ...
		add	esp, 54h
		pop	edi
		pop	ebp
		retn
sub_401D61	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401EC9(char *)
sub_401EC9	proc near		; CODE XREF: sub_4032E3+443p

Str		= dword	ptr -48h
Size		= dword	ptr -44h
Count		= dword	ptr -40h
File		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str], eax ; char *
		call	sub_401A61
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_402012
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+Size],	eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str], eax
		call	sub_40671C
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str], eax
		call	gcry_free
		cmp	[ebp+var_10], 0
		jz	short loc_401F2F
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str], eax
		call	gpg_strerror
		mov	[esp+48h+Size],	eax ; char
		mov	[esp+48h+Str], offset aGet_shadow_inf ;	"get_shadow_info failed: %s\n"
		call	sub_42091D
		jmp	loc_402016
; ---------------------------------------------------------------------------

loc_401F2F:				; CODE XREF: sub_401EC9+44j
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+File],	0
		mov	[esp+48h+Count], 0
		mov	[esp+48h+Size],	0
		mov	[esp+48h+Str], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_401F77
		mov	[esp+48h+Count], 1E0h ;	int
		mov	[esp+48h+Size],	offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/agent/protect-tool."...
		mov	[esp+48h+Str], offset aInfolen ; "infolen"
		call	sub_4276E0

loc_401F77:				; CODE XREF: sub_401EC9+90j
		mov	eax, ds:dword_430024
		test	eax, eax
		jz	short loc_401FEA
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_14]
		mov	[esp+48h+Size],	edx
		mov	[esp+48h+Str], eax
		call	sub_4016E0
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_402015
		mov	eax, ds:_iob
		lea	ebx, [eax+20h]
		mov	eax, [ebp+var_18]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_18]
		mov	[esp+48h+File],	ebx ; File
		mov	[esp+48h+Count], 1 ; Count
		mov	[esp+48h+Size],	edx ; Size
		mov	[esp+48h+Str], eax ; Str
		call	fwrite
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Str], eax
		call	gcry_free
		jmp	short loc_402016
; ---------------------------------------------------------------------------

loc_401FEA:				; CODE XREF: sub_401EC9+B5j
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+File],	edx ; File
		mov	[esp+48h+Count], 1 ; Count
		mov	edx, [ebp+var_14]
		mov	[esp+48h+Size],	edx ; Size
		mov	[esp+48h+Str], eax ; Str
		call	fwrite
		jmp	short loc_402016
; ---------------------------------------------------------------------------

loc_402012:				; CODE XREF: sub_401EC9+1Aj
		nop
		jmp	short loc_402016
; ---------------------------------------------------------------------------

loc_402015:				; CODE XREF: sub_401EC9+D0j
		nop

loc_402016:				; CODE XREF: sub_401EC9+61j
					; sub_401EC9+11Fj ...
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_401EC9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40201D(char *)
sub_40201D	proc near		; CODE XREF: sub_4032E3+4C0p

Str		= dword	ptr -38h
Size		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; char *
		call	sub_401A61
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_40212B
		mov	[esp+38h+File],	0
		mov	[esp+38h+Count], 0
		mov	[esp+38h+Size],	0
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_402085
		mov	[esp+38h+Count], 1FBh ;	int
		mov	[esp+38h+Size],	offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/agent/protect-tool."...
		mov	[esp+38h+Str], offset aKeylen ;	"keylen"
		call	sub_4276E0

loc_402085:				; CODE XREF: sub_40201D+4Aj
		mov	eax, ds:dword_430028
		test	eax, eax
		jz	short loc_4020B6
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, [ebp+var_C]
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 1 ; Count
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		jmp	short loc_40211E
; ---------------------------------------------------------------------------

loc_4020B6:				; CODE XREF: sub_40201D+6Fj
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Size],	eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax
		call	sub_4016E0
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_40211E
		mov	eax, ds:_iob
		lea	ebx, [eax+20h]
		mov	eax, [ebp+var_14]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_14]
		mov	[esp+38h+File],	ebx ; File
		mov	[esp+38h+Count], 1 ; Count
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax
		call	gcry_free

loc_40211E:				; CODE XREF: sub_40201D+97j
					; sub_40201D+B2j
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax
		call	gcry_free
		jmp	short loc_40212C
; ---------------------------------------------------------------------------

loc_40212B:				; CODE XREF: sub_40201D+1Aj
		nop

loc_40212C:				; CODE XREF: sub_40201D+10Cj
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40201D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402133(char *)
sub_402133	proc near		; CODE XREF: sub_4032E3+45Bp

Format		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Format], eax ;	char *
		call	sub_401A61
		mov	dword ptr [ebp+var_10],	eax
		cmp	dword ptr [ebp+var_10],	0
		jz	loc_4021FD
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], 0
		mov	eax, dword ptr [ebp+var_10]
		mov	dword ptr [esp+38h+var_34], eax	; char
		lea	eax, [ebp+var_14]
		mov	[esp+38h+Format], eax
		call	gcry_sexp_new
		test	eax, eax
		jz	short loc_402185
		mov	[esp+38h+Format], offset aGcry_sexp_newF ; "gcry_sexp_new failed\n"
		call	sub_42091D
		jmp	short locret_4021FE
; ---------------------------------------------------------------------------

loc_402185:				; CODE XREF: sub_402133+42j
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+38h+Format], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		lea	edx, [ebp+var_28]
		mov	dword ptr [esp+38h+var_34], edx	; char
		mov	[esp+38h+Format], eax
		call	gcry_pk_get_keygrip
		test	eax, eax
		jnz	short loc_4021B4
		mov	[esp+38h+Format], offset aCanTCalculateK ; "can't calculate keygrip\n"
		call	sub_42091D
		jmp	short locret_4021FE
; ---------------------------------------------------------------------------

loc_4021B4:				; CODE XREF: sub_402133+71j
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Format], eax
		call	gcry_sexp_release
		mov	[ebp+var_C], 0
		jmp	short loc_4021E9
; ---------------------------------------------------------------------------

loc_4021C8:				; CODE XREF: sub_402133+BAj
		lea	eax, [ebp+var_28]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset Format ; "%02X"
		mov	dword ptr [esp+38h+var_34], edx
		mov	[esp+38h+Format], eax ;	Format
		call	printf
		add	[ebp+var_C], 1

loc_4021E9:				; CODE XREF: sub_402133+93j
		cmp	[ebp+var_C], 13h
		jle	short loc_4021C8
		mov	[esp+38h+Format], 0Ah ;	Ch
		call	putchar
		jmp	short locret_4021FE
; ---------------------------------------------------------------------------

loc_4021FD:				; CODE XREF: sub_402133+18j
		nop

locret_4021FE:				; CODE XREF: sub_402133+50j
					; sub_402133+7Fj ...
		leave
		retn
sub_402133	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402200	proc near		; CODE XREF: sub_402637+17Fp

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[ebp+var_C], 0
		mov	[esp+48h+var_48], 0
		call	gcry_mpi_snew
		mov	[ebp+var_10], eax
		mov	[esp+48h+var_48], 0
		call	gcry_mpi_snew
		mov	[ebp+var_14], eax
		mov	[esp+48h+var_48], 0
		call	gcry_mpi_snew
		mov	[ebp+var_18], eax
		mov	[esp+48h+var_48], 0
		call	gcry_mpi_snew
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+10h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+48h+var_40], edx
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_mul
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_cmp
		test	eax, eax
		jz	short loc_402290
		mov	[esp+48h+var_48], offset aRsaOopsNPQ ; "RSA oops: n != p * q\n"
		call	sub_42091D
		add	[ebp+var_C], 1

loc_402290:				; CODE XREF: sub_402200+7Ej
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+10h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	dword ptr [esp+48h+var_44], edx	; char
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_cmp
		test	eax, eax
		jle	short loc_402323
		mov	[esp+48h+var_48], offset aSwappingSecret ; "swapping secret primes\n"
		call	sub_4208F3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_copy
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+10h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	dword ptr [esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_set
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+var_20]
		mov	dword ptr [esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_set
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_release
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[esp+48h+var_40], ecx
		mov	dword ptr [esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_invm

loc_402323:				; CODE XREF: sub_402200+AAj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+48h+var_40], 1
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_sub_ui
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+48h+var_38], 0
		mov	[esp+48h+var_3C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+var_10]
		mov	dword ptr [esp+48h+var_44], eax
		mov	[esp+48h+var_48], 0
		call	gcry_mpi_div
		mov	dword ptr [esp+48h+var_44], 0 ;	char
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_cmp_ui
		test	eax, eax
		jnz	short loc_402393
		mov	[esp+48h+var_48], offset aRsaOopsEDivide ; "RSA	oops: e	divides	p-1\n"
		call	sub_42091D
		add	[ebp+var_C], 1

loc_402393:				; CODE XREF: sub_402200+181j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+48h+var_40], 1
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_sub_ui
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+48h+var_38], 0
		mov	[esp+48h+var_3C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+var_10]
		mov	dword ptr [esp+48h+var_44], eax
		mov	[esp+48h+var_48], 0
		call	gcry_mpi_div
		mov	dword ptr [esp+48h+var_44], 0 ;	char
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_cmp_ui
		test	eax, eax
		jnz	short loc_402403
		mov	[esp+48h+var_48], offset aRsaOopsEDivi_0 ; "RSA	oops: e	divides	q-1\n"
		call	sub_4208F3
		add	[ebp+var_C], 1

loc_402403:				; CODE XREF: sub_402200+1F1j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+48h+var_40], 1
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_sub_ui
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+48h+var_40], 1
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_sub_ui
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_mul
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_1C]
		mov	[esp+48h+var_40], edx
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_invm
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_cmp
		test	eax, eax
		jz	loc_402516
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_gcd
		mov	[esp+48h+var_38], 0
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_3C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], eax
		mov	dword ptr [esp+48h+var_44], 0
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_div
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_10]
		mov	[esp+48h+var_40], edx
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_invm
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_cmp
		test	eax, eax
		jz	short loc_402516
		mov	[esp+48h+var_48], offset aRsaOopsBadSecr ; "RSA	oops: bad secret exponent\n"
		call	sub_42091D
		add	[ebp+var_C], 1

loc_402516:				; CODE XREF: sub_402200+289j
					; sub_402200+304j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+10h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+48h+var_40], edx
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_invm
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_cmp
		test	eax, eax
		jz	short loc_40255E
		mov	[esp+48h+var_48], offset aRsaOopsBadUPar ; "RSA	oops: bad u parameter\n"
		call	sub_4208F3
		add	[ebp+var_C], 1

loc_40255E:				; CODE XREF: sub_402200+34Cj
		cmp	[ebp+var_C], 0
		jz	short loc_402570
		mov	[esp+48h+var_48], offset aRsaSecretKeyCh ; "RSA	secret key check failed\n"
		call	sub_4208F3

loc_402570:				; CODE XREF: sub_402200+362j
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_release
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_release
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_release
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_mpi_release
		cmp	[ebp+var_C], 0
		jz	short loc_4025A9
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4025AE
; ---------------------------------------------------------------------------

loc_4025A9:				; CODE XREF: sub_402200+3A0j
		mov	eax, 0

locret_4025AE:				; CODE XREF: sub_402200+3A7j
		leave
		retn
sub_402200	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4025B0	proc near		; DATA XREF: sub_402637+C6o

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_30		= byte ptr -30h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+48h+var_40], offset aCertificate ;	"CERTIFICATE"
		mov	dword ptr [esp+48h+var_44], eax
		lea	eax, [ebp+var_30]
		mov	[esp+48h+var_48], eax
		call	sub_40B177
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4025FA
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+48h+var_44], eax
		lea	eax, [ebp+var_30]
		mov	[esp+48h+var_48], eax
		call	sub_40B283
		mov	[ebp+var_C], eax

loc_4025FA:				; CODE XREF: sub_4025B0+2Cj
		lea	eax, [ebp+var_30]
		mov	[esp+48h+var_48], eax
		call	sub_40B5A3
		mov	[ebp+var_10], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_402614
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_402614:				; CODE XREF: sub_4025B0+5Cj
		cmp	[ebp+var_C], 0
		jz	short locret_402635
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aErrorWritingAr ; "error writing armored certificate: %s\n"
		call	sub_42091D

locret_402635:				; CODE XREF: sub_4025B0+68j
		leave
		retn
sub_4025B0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402637(char *Filename)
sub_402637	proc near		; CODE XREF: sub_4032E3+473p

Buf1		= dword	ptr -0B8h
Buf2		= dword	ptr -0B4h
Size		= dword	ptr -0B0h
File		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_7C		= dword	ptr -7Ch
var_74		= byte ptr -74h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
Str		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
Filename	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0ACh
		lea	eax, [ebp+var_40]
		mov	[esp+0B8h+Buf2], eax ; int
		mov	eax, [ebp+Filename]
		mov	[esp+0B8h+Buf1], eax ; Filename
		call	sub_4017E7
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	loc_402AAB
		mov	eax, [ebp+var_40]
		cmp	eax, 1Dh
		jbe	short loc_4026CE
		mov	[esp+0B8h+Size], 12h ; Size
		mov	[esp+0B8h+Buf2], offset	aThePassphraseI	; "The passphrase is "
		mov	eax, [ebp+var_24]
		mov	[esp+0B8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_4026CE
		mov	[ebp+var_1C], 12h
		jmp	short loc_402696
; ---------------------------------------------------------------------------

loc_402692:				; CODE XREF: sub_402637+74j
		add	[ebp+var_1C], 1

loc_402696:				; CODE XREF: sub_402637+59j
		mov	eax, [ebp+var_40]
		cmp	[ebp+var_1C], eax
		jnb	short loc_4026AD
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_24]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_402692

loc_4026AD:				; CODE XREF: sub_402637+65j
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_40]
		cmp	[ebp+var_1C], eax
		jnb	short loc_4026D7
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_24]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_4026D7
		add	[ebp+var_1C], 1
		jmp	short loc_4026D7
; ---------------------------------------------------------------------------

loc_4026CE:				; CODE XREF: sub_402637+31j
					; sub_402637+50j
		mov	[ebp+var_1C], 0
		jmp	short loc_4026D8
; ---------------------------------------------------------------------------

loc_4026D7:				; CODE XREF: sub_402637+80j
					; sub_402637+8Fj ...
		nop

loc_4026D8:				; CODE XREF: sub_402637+9Ej
		mov	[esp+0B8h+Buf1], 2
		call	sub_403806
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_40]
		sub	eax, [ebp+var_1C]
		mov	edx, [ebp+var_1C]
		mov	ecx, [ebp+var_24]
		add	ecx, edx
		mov	[esp+0B8h+var_A8], 0
		mov	[esp+0B8h+File], offset	sub_4025B0
		mov	edx, [ebp+var_28]
		mov	[esp+0B8h+Size], edx
		mov	[esp+0B8h+Buf2], eax ; char
		mov	[esp+0B8h+Buf1], ecx
		call	sub_40913F
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_28]
		mov	[esp+0B8h+Buf1], eax
		call	sub_403991
		mov	eax, [ebp+var_24]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_free
		cmp	[ebp+var_2C], 0
		jnz	short loc_402748
		mov	[esp+0B8h+Buf1], offset	aErrorParsingOr	; "error parsing or decrypting the PKCS-12"...
		call	sub_42091D
		jmp	loc_402AB2
; ---------------------------------------------------------------------------

loc_402748:				; CODE XREF: sub_402637+FEj
		mov	[ebp+var_20], 0
		jmp	short loc_402755
; ---------------------------------------------------------------------------

loc_402751:				; CODE XREF: sub_402637+12Bj
		add	[ebp+var_20], 1

loc_402755:				; CODE XREF: sub_402637+118j
		mov	eax, [ebp+var_20]
		shl	eax, 2
		add	eax, [ebp+var_2C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_402751
		cmp	[ebp+var_20], 8
		jz	short loc_40277B
		mov	[esp+0B8h+Buf1], offset	aInvalidStructu	; "invalid structure of	private	key\n"
		call	sub_42091D
		jmp	loc_402AB2
; ---------------------------------------------------------------------------

loc_40277B:				; CODE XREF: sub_402637+131j
		mov	eax, [ebp+var_2C]
		mov	eax, [eax]
		mov	[ebp+var_5C], eax
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+4]
		mov	[ebp+var_58], eax
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+8]
		mov	[ebp+var_54], eax
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_48], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Buf1], eax
		call	sub_402200
		test	eax, eax
		jnz	loc_402AAE
		mov	edi, [ebp+var_48]
		mov	esi, [ebp+var_4C]
		mov	ebx, [ebp+var_50]
		mov	ecx, [ebp+var_54]
		mov	edx, [ebp+var_58]
		mov	eax, [ebp+var_5C]
		mov	[esp+0B8h+var_94], 0
		mov	[esp+0B8h+var_98], edi
		mov	[esp+0B8h+var_9C], esi
		mov	[esp+0B8h+var_A0], ebx
		mov	[esp+0B8h+var_A4], ecx
		mov	[esp+0B8h+var_A8], edx
		mov	[esp+0B8h+File], eax
		mov	[esp+0B8h+Size], offset	aPrivateKeyRsaN	; "(private-key(rsa(n%m)(e%m)(d%m)(p%m)(q%"...
		mov	[esp+0B8h+Buf2], 0
		lea	eax, [ebp+var_60]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_sexp_build
		mov	[ebp+var_30], eax
		mov	[ebp+var_20], 0
		jmp	short loc_402833
; ---------------------------------------------------------------------------

loc_40281C:				; CODE XREF: sub_402637+200j
		mov	eax, [ebp+var_20]
		shl	eax, 2
		add	eax, [ebp+var_2C]
		mov	eax, [eax]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_mpi_release
		add	[ebp+var_20], 1

loc_402833:				; CODE XREF: sub_402637+1E3j
		cmp	[ebp+var_20], 7
		jle	short loc_40281C
		mov	eax, [ebp+var_2C]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_free
		cmp	[ebp+var_30], 0
		jz	short loc_40286A
		mov	eax, [ebp+var_30]
		mov	[esp+0B8h+Buf1], eax
		call	gpg_strerror
		mov	[esp+0B8h+Buf2], eax ; char
		mov	[esp+0B8h+Buf1], offset	aFailedToCreate	; "failed to created S-expression from key"...
		call	sub_42091D
		jmp	loc_402AB2
; ---------------------------------------------------------------------------

loc_40286A:				; CODE XREF: sub_402637+211j
		mov	eax, [ebp+var_60]
		lea	edx, [ebp+var_74]
		mov	[esp+0B8h+Buf2], edx ; char
		mov	[esp+0B8h+Buf1], eax
		call	gcry_pk_get_keygrip
		test	eax, eax
		jnz	short loc_402891
		mov	[esp+0B8h+Buf1], offset	aCanTCalculateK	; "can't calculate keygrip\n"
		call	sub_42091D
		jmp	loc_402AB2
; ---------------------------------------------------------------------------

loc_402891:				; CODE XREF: sub_402637+247j
		mov	[esp+0B8h+Buf1], offset	aKeygrip ; "keygrip: "
		call	sub_4208F3
		mov	[ebp+var_20], 0
		jmp	short loc_4028C6
; ---------------------------------------------------------------------------

loc_4028A6:				; CODE XREF: sub_402637+293j
		lea	eax, [ebp+var_74]
		add	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+0B8h+Buf2], eax ; char
		mov	[esp+0B8h+Buf1], offset	Format ; "%02X"
		call	sub_4209E4
		add	[ebp+var_20], 1

loc_4028C6:				; CODE XREF: sub_402637+26Dj
		cmp	[ebp+var_20], 13h
		jle	short loc_4028A6
		mov	[esp+0B8h+Buf1], offset	asc_42A887 ; "\n"
		call	sub_4209E4
		mov	eax, [ebp+var_60]
		mov	[esp+0B8h+File], 0
		mov	[esp+0B8h+Size], 0
		mov	[esp+0B8h+Buf2], 1
		mov	[esp+0B8h+Buf1], eax
		call	gcry_sexp_sprint
		mov	[ebp+var_40], eax
		mov	eax, [ebp+var_40]
		test	eax, eax
		jnz	short loc_402921
		mov	[esp+0B8h+Size], 2FDh ;	int
		mov	[esp+0B8h+Buf2], offset	a____Gnupg22_0_	; "../../gnupg2-2.0.30/agent/protect-tool."...
		mov	[esp+0B8h+Buf1], offset	aBuflen	; "buflen"
		call	sub_4276E0

loc_402921:				; CODE XREF: sub_402637+2CCj
		mov	eax, [ebp+var_40]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_xmalloc_secure
		mov	[ebp+var_34], eax
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_60]
		mov	[esp+0B8h+File], edx
		mov	edx, [ebp+var_34]
		mov	[esp+0B8h+Size], edx
		mov	[esp+0B8h+Buf2], 1
		mov	[esp+0B8h+Buf1], eax
		call	gcry_sexp_sprint
		mov	[ebp+var_40], eax
		mov	eax, [ebp+var_40]
		test	eax, eax
		jnz	short loc_402976
		mov	[esp+0B8h+Size], 300h ;	int
		mov	[esp+0B8h+Buf2], offset	a____Gnupg22_0_	; "../../gnupg2-2.0.30/agent/protect-tool."...
		mov	[esp+0B8h+Buf1], offset	aBuflen	; "buflen"
		call	sub_4276E0

loc_402976:				; CODE XREF: sub_402637+321j
		mov	eax, [ebp+var_60]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_sexp_release
		mov	[esp+0B8h+Buf1], 4
		call	sub_403806
		mov	[ebp+var_28], eax
		lea	eax, [ebp+var_44]
		mov	[esp+0B8h+File], eax
		lea	eax, [ebp+Str]
		mov	[esp+0B8h+Size], eax
		mov	eax, [ebp+var_28]
		mov	[esp+0B8h+Buf2], eax
		mov	eax, [ebp+var_34]
		mov	[esp+0B8h+Buf1], eax
		call	sub_404830
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_28]
		mov	[esp+0B8h+Buf1], eax
		call	sub_403991
		mov	eax, [ebp+var_34]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_free
		cmp	[ebp+var_30], 0
		jz	short loc_4029EF
		mov	eax, [ebp+var_30]
		mov	[esp+0B8h+Buf1], eax
		call	gpg_strerror
		mov	[esp+0B8h+Buf2], eax ; char
		mov	[esp+0B8h+Buf1], offset	aProtectingTheK	; "protecting the key failed: %s\n"
		call	sub_42091D
		jmp	loc_402AB2
; ---------------------------------------------------------------------------

loc_4029EF:				; CODE XREF: sub_402637+396j
		mov	eax, ds:dword_430024
		test	eax, eax
		jz	short loc_402A4A
		mov	edx, [ebp+var_44]
		mov	eax, [ebp+Str]
		mov	[esp+0B8h+Buf2], edx
		mov	[esp+0B8h+Buf1], eax
		call	sub_4016E0
		mov	[ebp+var_38], eax
		mov	eax, [ebp+Str]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_free
		cmp	[ebp+var_38], 0
		jz	loc_402AB1
		mov	eax, [ebp+var_38]
		mov	[ebp+Str], eax
		mov	eax, [ebp+var_38]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_44], eax

loc_402A4A:				; CODE XREF: sub_402637+3BFj
		mov	eax, ds:dword_43002C
		test	eax, eax
		jz	short loc_402A78
		mov	ecx, ds:dword_430030
		mov	edx, [ebp+var_44]
		mov	eax, [ebp+Str]
		mov	[esp+0B8h+File], ecx
		mov	[esp+0B8h+Size], edx
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+var_74]
		mov	[esp+0B8h+Buf1], eax
		call	sub_4039ED
		jmp	short loc_402A9E
; ---------------------------------------------------------------------------

loc_402A78:				; CODE XREF: sub_402637+41Aj
		mov	eax, ds:_iob
		lea	ecx, [eax+20h]
		mov	edx, [ebp+var_44]
		mov	eax, [ebp+Str]
		mov	[esp+0B8h+File], ecx ; File
		mov	[esp+0B8h+Size], 1 ; Count
		mov	[esp+0B8h+Buf2], edx ; Size
		mov	[esp+0B8h+Buf1], eax ; Str
		call	fwrite

loc_402A9E:				; CODE XREF: sub_402637+43Fj
		mov	eax, [ebp+Str]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_free
		jmp	short loc_402AB2
; ---------------------------------------------------------------------------

loc_402AAB:				; CODE XREF: sub_402637+25j
		nop
		jmp	short loc_402AB2
; ---------------------------------------------------------------------------

loc_402AAE:				; CODE XREF: sub_402637+186j
		nop
		jmp	short loc_402AB2
; ---------------------------------------------------------------------------

loc_402AB1:				; CODE XREF: sub_402637+3E5j
		nop

loc_402AB2:				; CODE XREF: sub_402637+10Cj
					; sub_402637+13Fj ...
		add	esp, 0ACh
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_402637	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402ABD	proc near		; CODE XREF: sub_402D35+37Bp

Buf1		= dword	ptr -58h
Buf2		= dword	ptr -54h
Size		= dword	ptr -50h
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		mov	[esp+58h+Size],	0
		mov	[esp+58h+Buf2],	offset aPrivateKey ; "private-key"
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Buf1],	eax
		call	gcry_sexp_find_token
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_402AF3
		mov	eax, 0
		jmp	loc_402CD5
; ---------------------------------------------------------------------------

loc_402AF3:				; CODE XREF: sub_402ABD+2Aj
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Buf1],	eax
		call	gcry_sexp_cadr
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Buf1],	eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_18], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+Size],	eax
		mov	[esp+58h+Buf2],	0
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Buf1],	eax
		call	gcry_sexp_nth_data
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_402B5C
		mov	eax, [ebp+var_2C]
		cmp	eax, 3
		jnz	short loc_402B5C
		mov	[esp+58h+Size],	3 ; Size
		mov	[esp+58h+Buf2],	offset aRsa ; "rsa"
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_402B71

loc_402B5C:				; CODE XREF: sub_402ABD+76j
					; sub_402ABD+7Ej
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Buf1],	eax
		call	gcry_sexp_release
		mov	eax, 0
		jmp	loc_402CD5
; ---------------------------------------------------------------------------

loc_402B71:				; CODE XREF: sub_402ABD+9Dj
		mov	[ebp+var_24], offset aNedpqu ; "nedpqu"
		mov	eax, [ebp+var_24]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+58h+Buf2],	4
		mov	[esp+58h+Buf1],	eax
		call	gcry_xcalloc
		mov	[ebp+var_28], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_24]
		mov	[ebp+var_C], eax
		jmp	loc_402CB9
; ---------------------------------------------------------------------------

loc_402BBF:				; CODE XREF: sub_402ABD+204j
		mov	[esp+58h+Size],	1
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Buf2],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Buf1],	eax
		call	gcry_sexp_find_token
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_402C2A
		mov	[ebp+var_10], 0
		jmp	short loc_402C02
; ---------------------------------------------------------------------------

loc_402BEB:				; CODE XREF: sub_402ABD+14Bj
		mov	eax, [ebp+var_10]
		shl	eax, 2
		add	eax, [ebp+var_28]
		mov	eax, [eax]
		mov	[esp+58h+Buf1],	eax
		call	gcry_mpi_release
		add	[ebp+var_10], 1

loc_402C02:				; CODE XREF: sub_402ABD+12Cj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_402BEB
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Buf1],	eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Buf1],	eax
		call	gcry_sexp_release
		mov	eax, 0
		jmp	loc_402CD5
; ---------------------------------------------------------------------------

loc_402C2A:				; CODE XREF: sub_402ABD+123j
		mov	eax, [ebp+var_14]
		shl	eax, 2
		mov	ebx, eax
		add	ebx, [ebp+var_28]
		mov	[esp+58h+Size],	5
		mov	[esp+58h+Buf2],	1
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Buf1],	eax
		call	gcry_sexp_nth_mpi
		mov	[ebx], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Buf1],	eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	eax, [ebp+var_28]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_402CB1
		mov	[ebp+var_10], 0
		jmp	short loc_402C8C
; ---------------------------------------------------------------------------

loc_402C75:				; CODE XREF: sub_402ABD+1D5j
		mov	eax, [ebp+var_10]
		shl	eax, 2
		add	eax, [ebp+var_28]
		mov	eax, [eax]
		mov	[esp+58h+Buf1],	eax
		call	gcry_mpi_release
		add	[ebp+var_10], 1

loc_402C8C:				; CODE XREF: sub_402ABD+1B6j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_402C75
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Buf1],	eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Buf1],	eax
		call	gcry_sexp_release
		mov	eax, 0
		jmp	short loc_402CD5
; ---------------------------------------------------------------------------

loc_402CB1:				; CODE XREF: sub_402ABD+1ADj
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1

loc_402CB9:				; CODE XREF: sub_402ABD+FDj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_402BBF
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Buf1],	eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_28]

loc_402CD5:				; CODE XREF: sub_402ABD+31j
					; sub_402ABD+AFj ...
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_402ABD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402CDC	proc near		; CODE XREF: sub_402D35+29p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		jmp	short loc_402D16
; ---------------------------------------------------------------------------

loc_402CEB:				; CODE XREF: sub_402CDC+4Bj
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	[esp+28h+Str], offset Str ; "01234567890ABCDEF"
		call	strchr
		test	eax, eax
		jnz	short loc_402D12
		mov	eax, 0
		jmp	short locret_402D33
; ---------------------------------------------------------------------------

loc_402D12:				; CODE XREF: sub_402CDC+2Dj
		add	[ebp+var_C], 1

loc_402D16:				; CODE XREF: sub_402CDC+Dj
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_402D29
		cmp	[ebp+var_C], 28h
		jle	short loc_402CEB

loc_402D29:				; CODE XREF: sub_402CDC+45j
		cmp	[ebp+var_C], 28h
		setz	al
		movzx	eax, al

locret_402D33:				; CODE XREF: sub_402CDC+34j
		leave
		retn
sub_402CDC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402D35(char *)
sub_402D35	proc near		; CODE XREF: sub_4032E3+48Bp

File		= dword	ptr -108h
Size		= dword	ptr -104h
Count		= dword	ptr -100h
var_FC		= dword	ptr -0FCh
var_F8		= byte ptr -0F8h
var_F4		= dword	ptr -0F4h
var_DC		= dword	ptr -0DCh
var_D1		= byte ptr -0D1h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Str		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 100h
		mov	[ebp+var_14], 0
		mov	[ebp+var_9C], 0
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+108h+File], eax
		call	sub_402CDC
		test	eax, eax
		jz	loc_402E1B
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_DC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_DC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 28h
		jz	short loc_402DB1
		mov	[esp+108h+Count], 37Bh ; int
		mov	[esp+108h+Size], offset	a____Gnupg22_0_	; "../../gnupg2-2.0.30/agent/protect-tool."...
		mov	[esp+108h+File], offset	aStrlenFname40 ; "strlen(fname)	== 40"
		call	sub_4276E0

loc_402DB1:				; CODE XREF: sub_402D35+5Ej
		mov	ebx, offset a_key ; ".key"
		mov	eax, [ebp+arg_0]
		mov	[esp+108h+Size], eax
		lea	eax, [ebp+var_D1]
		mov	[esp+108h+File], eax
		call	sub_421FFD
		mov	edx, [ebx]
		mov	[eax], edx
		movzx	edx, byte ptr [ebx+4]
		mov	[eax+4], dl
		mov	eax, ds:dword_430020
		mov	[esp+108h+var_FC], 0
		lea	edx, [ebp+var_D1]
		mov	[esp+108h+Count], edx
		mov	[esp+108h+Size], offset	aPrivateKeysV1_	; "private-keys-v1.d"
		mov	[esp+108h+File], eax
		call	sub_42141F
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_48]
		mov	[esp+108h+File], eax ; char *
		call	sub_401A61
		mov	[ebp+Str], eax
		mov	eax, [ebp+var_48]
		mov	[esp+108h+File], eax
		call	gcry_free
		jmp	short loc_402E29
; ---------------------------------------------------------------------------

loc_402E1B:				; CODE XREF: sub_402D35+30j
		mov	eax, [ebp+arg_0]
		mov	[esp+108h+File], eax ; char *
		call	sub_401A61
		mov	[ebp+Str], eax

loc_402E29:				; CODE XREF: sub_402D35+E4j
		cmp	[ebp+Str], 0
		jz	loc_4032D5
		mov	eax, [ebp+Str]
		mov	[esp+108h+File], eax
		call	sub_405E15
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 2
		jnz	loc_402F1E
		mov	[esp+108h+File], 1
		call	sub_403806
		mov	dword ptr [ebp+var_4C],	eax
		lea	eax, [ebp+var_A4]
		mov	dword ptr [esp+108h+var_F8], eax
		lea	eax, [ebp+var_A0]
		mov	[esp+108h+var_FC], eax
		mov	[esp+108h+Count], 0
		mov	eax, dword ptr [ebp+var_4C]
		mov	[esp+108h+Size], eax ; char
		mov	eax, [ebp+Str]
		mov	[esp+108h+File], eax
		call	sub_4056C4
		mov	[ebp+var_50], eax
		mov	eax, dword ptr [ebp+var_4C]
		mov	[esp+108h+File], eax
		call	sub_403991
		cmp	[ebp+var_50], 0
		jz	short loc_402EF3
		mov	eax, ds:dword_430044
		test	eax, eax
		jz	short loc_402EC1
		mov	eax, [ebp+var_50]
		mov	[esp+108h+File], eax
		call	sub_401550
		cmp	eax, 0Bh
		jnz	short loc_402EC1
		mov	[esp+108h+File], offset	aProtectToolBad	; "[PROTECT-TOOL:] bad-passphrase\n"
		call	sub_4208F3

loc_402EC1:				; CODE XREF: sub_402D35+16Ej
					; sub_402D35+17Ej
		mov	eax, [ebp+var_50]
		mov	[esp+108h+File], eax
		call	gpg_strerror
		mov	[esp+108h+Count], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+108h+Size], eax ; char
		mov	[esp+108h+File], offset	aUnprotectingKe	; "unprotecting	key `%s' failed: %s\n"
		call	sub_42091D
		mov	eax, [ebp+Str]
		mov	[esp+108h+File], eax
		call	gcry_free
		jmp	loc_4032D9
; ---------------------------------------------------------------------------

loc_402EF3:				; CODE XREF: sub_402D35+165j
		mov	eax, [ebp+Str]
		mov	[esp+108h+File], eax
		call	gcry_free
		mov	eax, [ebp+var_A0]
		mov	[ebp+Str], eax
		mov	eax, [ebp+var_A4]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+Str]
		mov	[esp+108h+File], eax
		call	sub_405E15
		mov	[ebp+var_18], eax

loc_402F1E:				; CODE XREF: sub_402D35+110j
		cmp	[ebp+var_18], 3
		jnz	short loc_402F69
		mov	eax, [ebp+arg_0]
		mov	[esp+108h+Size], eax ; char
		mov	[esp+108h+File], offset	aSIsAShadowedPr	; "`%s' is a shadowed private key - can't "...
		call	sub_42091D
		mov	eax, [ebp+Str]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_24], eax
		jmp	short loc_402F53
; ---------------------------------------------------------------------------

loc_402F45:				; CODE XREF: sub_402D35+222j
		mov	eax, [ebp+var_20]
		mov	byte ptr [eax],	0
		add	[ebp+var_20], 1
		sub	[ebp+var_24], 1

loc_402F53:				; CODE XREF: sub_402D35+20Ej
		cmp	[ebp+var_24], 0
		jnz	short loc_402F45
		mov	eax, [ebp+Str]
		mov	[esp+108h+File], eax
		call	gcry_free
		jmp	loc_4032D9
; ---------------------------------------------------------------------------

loc_402F69:				; CODE XREF: sub_402D35+1EDj
		cmp	[ebp+var_18], 1
		jz	short loc_402FB4
		mov	eax, [ebp+arg_0]
		mov	[esp+108h+Size], eax ; char
		mov	[esp+108h+File], offset	aSIsNotAPrivate	; "%s' is not a private key\n"
		call	sub_42091D
		mov	eax, [ebp+Str]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_2C], eax
		jmp	short loc_402F9E
; ---------------------------------------------------------------------------

loc_402F90:				; CODE XREF: sub_402D35+26Dj
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	0
		add	[ebp+var_28], 1
		sub	[ebp+var_2C], 1

loc_402F9E:				; CODE XREF: sub_402D35+259j
		cmp	[ebp+var_2C], 0
		jnz	short loc_402F90
		mov	eax, [ebp+Str]
		mov	[esp+108h+File], eax
		call	gcry_free
		jmp	loc_4032D9
; ---------------------------------------------------------------------------

loc_402FB4:				; CODE XREF: sub_402D35+238j
		mov	eax, ds:dword_430038
		test	eax, eax
		jz	short loc_40300E
		lea	eax, [ebp+var_9C]
		mov	[esp+108h+Size], eax ; int
		mov	[esp+108h+File], offset	asc_42A541 ; "-"
		call	sub_4017E7
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40300E
		mov	eax, [ebp+Str]
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_34], eax
		jmp	short loc_402FF8
; ---------------------------------------------------------------------------

loc_402FEA:				; CODE XREF: sub_402D35+2C7j
		mov	eax, [ebp+var_30]
		mov	byte ptr [eax],	0
		add	[ebp+var_30], 1
		sub	[ebp+var_34], 1

loc_402FF8:				; CODE XREF: sub_402D35+2B3j
		cmp	[ebp+var_34], 0
		jnz	short loc_402FEA
		mov	eax, [ebp+Str]
		mov	[esp+108h+File], eax
		call	gcry_free
		jmp	loc_4032D9
; ---------------------------------------------------------------------------

loc_40300E:				; CODE XREF: sub_402D35+286j
					; sub_402D35+2A5j
		mov	[esp+108h+var_FC], 0
		mov	[esp+108h+Count], 0
		mov	eax, [ebp+Str]
		mov	[esp+108h+Size], eax ; char
		lea	eax, [ebp+var_80]
		mov	[esp+108h+File], eax
		call	gcry_sexp_new
		test	eax, eax
		jz	short loc_40307D
		mov	[esp+108h+File], offset	aGcry_sexp_newF	; "gcry_sexp_new failed\n"
		call	sub_42091D
		mov	eax, [ebp+Str]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_3C], eax
		jmp	short loc_40305C
; ---------------------------------------------------------------------------

loc_40304E:				; CODE XREF: sub_402D35+32Bj
		mov	eax, [ebp+var_38]
		mov	byte ptr [eax],	0
		add	[ebp+var_38], 1
		sub	[ebp+var_3C], 1

loc_40305C:				; CODE XREF: sub_402D35+317j
		cmp	[ebp+var_3C], 0
		jnz	short loc_40304E
		mov	eax, [ebp+Str]
		mov	[esp+108h+File], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		mov	[esp+108h+File], eax
		call	gcry_free
		jmp	loc_4032D9
; ---------------------------------------------------------------------------

loc_40307D:				; CODE XREF: sub_402D35+2FDj
		mov	eax, [ebp+Str]
		mov	[ebp+var_40], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_44], eax
		jmp	short loc_403099
; ---------------------------------------------------------------------------

loc_40308B:				; CODE XREF: sub_402D35+368j
		mov	eax, [ebp+var_40]
		mov	byte ptr [eax],	0
		add	[ebp+var_40], 1
		sub	[ebp+var_44], 1

loc_403099:				; CODE XREF: sub_402D35+354j
		cmp	[ebp+var_44], 0
		jnz	short loc_40308B
		mov	eax, [ebp+Str]
		mov	[esp+108h+File], eax
		call	gcry_free
		mov	eax, [ebp+var_80]
		mov	[esp+108h+File], eax
		call	sub_402ABD
		mov	[ebp+var_54], eax
		mov	eax, [ebp+var_80]
		mov	[esp+108h+File], eax
		call	gcry_sexp_release
		cmp	[ebp+var_54], 0
		jnz	short loc_4030E5
		mov	[esp+108h+File], offset	aErrorConvertin	; "error converting key	parameters\n"
		call	sub_42091D
		mov	eax, [ebp+var_14]
		mov	[esp+108h+File], eax
		call	gcry_free
		jmp	loc_4032D9
; ---------------------------------------------------------------------------

loc_4030E5:				; CODE XREF: sub_402D35+392j
		mov	eax, [ebp+var_54]
		mov	eax, [eax]
		mov	[ebp+var_98], eax
		mov	eax, [ebp+var_54]
		mov	eax, [eax+4]
		mov	[ebp+var_94], eax
		mov	eax, [ebp+var_54]
		mov	eax, [eax+8]
		mov	[ebp+var_90], eax
		mov	eax, [ebp+var_54]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_8C], eax
		mov	eax, [ebp+var_54]
		mov	eax, [eax+10h]
		mov	[ebp+var_88], eax
		mov	eax, [ebp+var_54]
		mov	eax, [eax+14h]
		mov	[ebp+var_84], eax
		mov	eax, [ebp+var_54]
		mov	[esp+108h+File], eax
		call	gcry_free
		mov	eax, [ebp+var_98]
		mov	[ebp+var_78], eax
		mov	eax, [ebp+var_94]
		mov	[ebp+var_74], eax
		mov	eax, [ebp+var_90]
		mov	[ebp+var_70], eax
		mov	eax, [ebp+var_88]
		mov	[ebp+var_6C], eax
		mov	eax, [ebp+var_8C]
		mov	[ebp+var_68], eax
		mov	[esp+108h+File], 0
		call	gcry_mpi_snew
		mov	[ebp+var_64], eax
		mov	edx, [ebp+var_6C]
		mov	eax, [ebp+var_64]
		mov	[esp+108h+Count], 1
		mov	[esp+108h+Size], edx
		mov	[esp+108h+File], eax
		call	gcry_mpi_sub_ui
		mov	ecx, [ebp+var_64]
		mov	edx, [ebp+var_90]
		mov	eax, [ebp+var_64]
		mov	[esp+108h+Count], ecx
		mov	[esp+108h+Size], edx
		mov	[esp+108h+File], eax
		call	gcry_mpi_mod
		mov	[esp+108h+File], 0
		call	gcry_mpi_snew
		mov	[ebp+var_60], eax
		mov	edx, [ebp+var_68]
		mov	eax, [ebp+var_60]
		mov	[esp+108h+Count], 1
		mov	[esp+108h+Size], edx
		mov	[esp+108h+File], eax
		call	gcry_mpi_sub_ui
		mov	ecx, [ebp+var_60]
		mov	edx, [ebp+var_90]
		mov	eax, [ebp+var_60]
		mov	[esp+108h+Count], ecx
		mov	[esp+108h+Size], edx
		mov	[esp+108h+File], eax
		call	gcry_mpi_mod
		mov	eax, [ebp+var_84]
		mov	[ebp+var_5C], eax
		mov	[ebp+var_58], 0
		mov	[esp+108h+File], 3
		call	sub_403806
		mov	dword ptr [ebp+var_4C],	eax
		mov	edx, ds:dword_430048
		mov	eax, [ebp+var_9C]
		lea	ecx, [ebp+var_7C]
		mov	[esp+108h+var_F4], ecx ; int
		mov	dword ptr [esp+108h+var_F8], edx ; char
		mov	edx, dword ptr [ebp+var_4C]
		mov	[esp+108h+var_FC], edx ; int
		mov	[esp+108h+Count], eax ;	size_t
		mov	eax, [ebp+var_14]
		mov	[esp+108h+Size], eax ; void *
		lea	eax, [ebp+var_78]
		mov	[esp+108h+File], eax ; int
		call	sub_40ABDF
		mov	[ebp+Str], eax
		mov	eax, dword ptr [ebp+var_4C]
		mov	[esp+108h+File], eax
		call	sub_403991
		mov	eax, [ebp+var_14]
		mov	[esp+108h+File], eax
		call	gcry_free
		mov	[ebp+var_10], 0
		jmp	short loc_403276
; ---------------------------------------------------------------------------

loc_403263:				; CODE XREF: sub_402D35+545j
		mov	eax, [ebp+var_10]
		mov	eax, [ebp+eax*4+var_78]
		mov	[esp+108h+File], eax
		call	gcry_mpi_release
		add	[ebp+var_10], 1

loc_403276:				; CODE XREF: sub_402D35+52Cj
		cmp	[ebp+var_10], 7
		jle	short loc_403263
		cmp	[ebp+Str], 0
		jz	short loc_4032D8
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+108h+File], eax ; File
		call	_fileno
		mov	[esp+108h+Size], 8000h
		mov	[esp+108h+File], eax
		call	_setmode
		mov	eax, ds:_iob
		lea	ecx, [eax+20h]
		mov	edx, [ebp+var_7C]
		mov	eax, [ebp+Str]
		mov	[esp+108h+var_FC], ecx ; File
		mov	[esp+108h+Count], 1 ; Count
		mov	[esp+108h+Size], edx ; Size
		mov	[esp+108h+File], eax ; Str
		call	fwrite
		mov	eax, [ebp+Str]
		mov	[esp+108h+File], eax
		call	gcry_free
		jmp	short loc_4032D9
; ---------------------------------------------------------------------------

loc_4032D5:				; CODE XREF: sub_402D35+F8j
		nop
		jmp	short loc_4032D9
; ---------------------------------------------------------------------------

loc_4032D8:				; CODE XREF: sub_402D35+54Bj
		nop

loc_4032D9:				; CODE XREF: sub_402D35+1B9j
					; sub_402D35+22Fj ...
		add	esp, 100h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_402D35	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_4032E3	proc near		; CODE XREF: sub_401180+265p

Code		= dword	ptr -64h
var_60		= byte ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_2C		= dword	ptr -2Ch
Filename	= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		and	esp, 0FFFFFFF0h
		sub	esp, 60h
		call	sub_426E30
		mov	[esp+64h+var_8], 0
		mov	[esp+64h+Code],	offset sub_40155D
		call	sub_42477E
		mov	[esp+64h+Code],	1Ch
		call	gcry_control
		mov	dword ptr [esp+64h+var_60], 1 ;	int
		mov	[esp+64h+Code],	offset aGpgProtectTo_0 ; "gpg-protect-tool"
		call	sub_4203B4
		call	sub_40B92C
		call	sub_40B9A4
		mov	[esp+64h+Code],	offset a1_5_0 ;	"1.5.0"
		call	gcry_check_version
		test	eax, eax
		jnz	short loc_403376
		mov	[esp+64h+Code],	0
		call	gcry_check_version
		mov	ebx, eax
		mov	[esp+64h+Code],	offset aSIsTooOldNeedS ; "%s is	too old	(need %s, have %s)\n"
		call	sub_420034
		mov	[esp+64h+var_58], ebx
		mov	[esp+64h+var_5C], offset a1_5_0	; "1.5.0"
		mov	dword ptr [esp+64h+var_60], offset aLibgcrypt ;	"libgcrypt"
		mov	[esp+64h+Code],	eax ; char *
		call	sub_420960
; ---------------------------------------------------------------------------

loc_403376:				; CODE XREF: sub_4032E3+5Bj
		call	sub_40BB55
		mov	[esp+64h+var_5C], 0
		mov	dword ptr [esp+64h+var_60], 4000h
		mov	[esp+64h+Code],	18h
		call	gcry_control
		call	sub_40C1A5
		mov	ds:dword_430020, eax
		call	sub_40D028
		mov	ds:dword_430050, eax
		lea	eax, [ebp+arg_0]
		mov	[esp+64h+var_44], eax
		lea	eax, [ebp+arg_4]
		mov	[esp+64h+var_40], eax
		mov	[esp+64h+var_3C], 1
		jmp	loc_4035FD
; ---------------------------------------------------------------------------

loc_4033C6:				; CODE XREF: sub_4032E3+330j
		mov	eax, [esp+64h+var_34]
		cmp	eax, 1FAh
		jz	loc_403579
		cmp	eax, 1FAh
		jg	loc_403469
		cmp	eax, 76h
		jz	loc_4034EC
		cmp	eax, 76h
		jg	short loc_403421
		cmp	eax, 61h
		jz	loc_4034FE
		cmp	eax, 61h
		jg	short loc_40340A
		cmp	eax, 50h
		jz	loc_4035A2
		jmp	loc_4035F4
; ---------------------------------------------------------------------------

loc_40340A:				; CODE XREF: sub_4032E3+117j
		cmp	eax, 70h
		jz	loc_403538
		cmp	eax, 75h
		jz	loc_403545
		jmp	loc_4035F4
; ---------------------------------------------------------------------------

loc_403421:				; CODE XREF: sub_4032E3+109j
		cmp	eax, 1F7h
		jz	loc_40356C
		cmp	eax, 1F7h
		jg	short loc_40344E
		cmp	eax, 1F5h
		jz	loc_403552
		cmp	eax, 1F6h
		jz	loc_40355F
		jmp	loc_4035F4
; ---------------------------------------------------------------------------

loc_40344E:				; CODE XREF: sub_4032E3+14Ej
		cmp	eax, 1F8h
		jz	loc_403598
		cmp	eax, 1F9h
		jz	loc_40350D
		jmp	loc_4035F4
; ---------------------------------------------------------------------------

loc_403469:				; CODE XREF: sub_4032E3+F7j
		cmp	eax, 1FFh
		jz	loc_4035D1
		cmp	eax, 1FFh
		jg	short loc_4034AC
		cmp	eax, 1FCh
		jz	loc_40358D
		cmp	eax, 1FCh
		jl	loc_403583
		cmp	eax, 1FDh
		jz	loc_4035AD
		cmp	eax, 1FEh
		jz	loc_4035B9
		jmp	loc_4035F4
; ---------------------------------------------------------------------------

loc_4034AC:				; CODE XREF: sub_4032E3+196j
		cmp	eax, 202h
		jz	loc_4035DD
		cmp	eax, 202h
		jg	short loc_4034D5
		cmp	eax, 200h
		jz	loc_4035C5
		cmp	eax, 201h
		jz	short loc_40351C
		jmp	loc_4035F4
; ---------------------------------------------------------------------------

loc_4034D5:				; CODE XREF: sub_4032E3+1D9j
		cmp	eax, 203h
		jz	loc_4035E8
		cmp	eax, 204h
		jz	short loc_40352A
		jmp	loc_4035F4
; ---------------------------------------------------------------------------

loc_4034EC:				; CODE XREF: sub_4032E3+100j
		mov	eax, ds:dword_430904
		add	eax, 1
		mov	ds:dword_430904, eax
		jmp	loc_4035FD
; ---------------------------------------------------------------------------

loc_4034FE:				; CODE XREF: sub_4032E3+10Ej
		mov	ds:dword_430024, 1
		jmp	loc_4035FD
; ---------------------------------------------------------------------------

loc_40350D:				; CODE XREF: sub_4032E3+17Bj
		mov	ds:dword_430028, 1
		jmp	loc_4035FD
; ---------------------------------------------------------------------------

loc_40351C:				; CODE XREF: sub_4032E3+1EBj
		mov	eax, [esp+64h+var_2C]
		mov	ds:dword_430020, eax
		jmp	loc_4035FD
; ---------------------------------------------------------------------------

loc_40352A:				; CODE XREF: sub_4032E3+202j
		mov	eax, [esp+64h+var_2C]
		mov	ds:dword_43004C, eax
		jmp	loc_4035FD
; ---------------------------------------------------------------------------

loc_403538:				; CODE XREF: sub_4032E3+12Aj
		mov	[esp+64h+var_8], 70h
		jmp	loc_4035FD
; ---------------------------------------------------------------------------

loc_403545:				; CODE XREF: sub_4032E3+133j
		mov	[esp+64h+var_8], 75h
		jmp	loc_4035FD
; ---------------------------------------------------------------------------

loc_403552:				; CODE XREF: sub_4032E3+155j
		mov	[esp+64h+var_8], 1F5h
		jmp	loc_4035FD
; ---------------------------------------------------------------------------

loc_40355F:				; CODE XREF: sub_4032E3+160j
		mov	[esp+64h+var_8], 1F6h
		jmp	loc_4035FD
; ---------------------------------------------------------------------------

loc_40356C:				; CODE XREF: sub_4032E3+143j
		mov	[esp+64h+var_8], 1F7h
		jmp	loc_4035FD
; ---------------------------------------------------------------------------

loc_403579:				; CODE XREF: sub_4032E3+ECj
		mov	[esp+64h+var_8], 1FAh
		jmp	short loc_4035FD
; ---------------------------------------------------------------------------

loc_403583:				; CODE XREF: sub_4032E3+1A8j
		mov	[esp+64h+var_8], 1FBh
		jmp	short loc_4035FD
; ---------------------------------------------------------------------------

loc_40358D:				; CODE XREF: sub_4032E3+19Dj
		mov	eax, [esp+64h+var_2C]
		mov	ds:dword_430048, eax
		jmp	short loc_4035FD
; ---------------------------------------------------------------------------

loc_403598:				; CODE XREF: sub_4032E3+170j
		mov	[esp+64h+var_8], 1F8h
		jmp	short loc_4035FD
; ---------------------------------------------------------------------------

loc_4035A2:				; CODE XREF: sub_4032E3+11Cj
		mov	eax, [esp+64h+var_2C]
		mov	ds:dword_43003C, eax
		jmp	short loc_4035FD
; ---------------------------------------------------------------------------

loc_4035AD:				; CODE XREF: sub_4032E3+1B3j
		mov	ds:dword_43002C, 1
		jmp	short loc_4035FD
; ---------------------------------------------------------------------------

loc_4035B9:				; CODE XREF: sub_4032E3+1BEj
		mov	ds:dword_430030, 1
		jmp	short loc_4035FD
; ---------------------------------------------------------------------------

loc_4035C5:				; CODE XREF: sub_4032E3+1E0j
		mov	ds:dword_430034, 1
		jmp	short loc_4035FD
; ---------------------------------------------------------------------------

loc_4035D1:				; CODE XREF: sub_4032E3+18Bj
		mov	ds:dword_430038, 1
		jmp	short loc_4035FD
; ---------------------------------------------------------------------------

loc_4035DD:				; CODE XREF: sub_4032E3+1CEj
		mov	eax, [esp+64h+var_2C]
		mov	ds:dword_430040, eax
		jmp	short loc_4035FD
; ---------------------------------------------------------------------------

loc_4035E8:				; CODE XREF: sub_4032E3+1F7j
		mov	ds:dword_430044, 1
		jmp	short loc_4035FD
; ---------------------------------------------------------------------------

loc_4035F4:				; CODE XREF: sub_4032E3+122j
					; sub_4032E3+139j ...
		mov	[esp+64h+var_38], 2
		nop

loc_4035FD:				; CODE XREF: sub_4032E3+DEj
					; sub_4032E3+216j ...
		mov	dword ptr [esp+64h+var_60], offset dword_429000
		lea	eax, [esp+64h+var_44]
		mov	[esp+64h+Code],	eax
		call	sub_4234E9
		test	eax, eax
		jnz	loc_4033C6
		mov	[esp+64h+Code],	0
		call	sub_4200D0
		test	eax, eax
		jz	short loc_403635
		mov	[esp+64h+Code],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_403635:				; CODE XREF: sub_4032E3+344j
		mov	[esp+64h+Filename], offset asc_42A541 ;	"-"
		mov	eax, [ebp+arg_0]
		cmp	eax, 1
		jnz	short loc_403650
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+64h+Filename], eax
		jmp	short loc_403664
; ---------------------------------------------------------------------------

loc_403650:				; CODE XREF: sub_4032E3+360j
		mov	eax, [ebp+arg_0]
		cmp	eax, 1
		jle	short loc_403664
		mov	[esp+64h+Code],	1
		call	sub_4245D2

loc_403664:				; CODE XREF: sub_4032E3+36Bj
					; sub_4032E3+373j
		mov	ebx, ds:dword_430050
		mov	ecx, ds:dword_43004C
		mov	edx, ds:dword_430020
		mov	eax, ds:dword_430904
		mov	[esp+64h+var_4C], ebx
		mov	[esp+64h+var_50], 0
		mov	[esp+64h+var_54], 0
		mov	[esp+64h+var_58], ecx
		mov	[esp+64h+var_5C], edx
		mov	dword ptr [esp+64h+var_60], eax
		mov	[esp+64h+Code],	4
		call	sub_40D9C2
		mov	eax, ds:dword_430040
		test	eax, eax
		jz	short loc_4036CA
		mov	eax, ds:dword_430040
		mov	dword ptr [esp+64h+var_60], 0
		mov	[esp+64h+Code],	eax
		call	sub_40E309
		mov	ds:dword_430040, eax

loc_4036CA:				; CODE XREF: sub_4032E3+3CBj
		cmp	[esp+64h+var_8], 70h
		jnz	short loc_4036E2
		mov	eax, [esp+64h+Filename]
		mov	[esp+64h+Code],	eax ; char *
		call	sub_401AB5
		jmp	loc_4037A8
; ---------------------------------------------------------------------------

loc_4036E2:				; CODE XREF: sub_4032E3+3ECj
		cmp	[esp+64h+var_8], 75h
		jnz	short loc_4036FA
		mov	eax, [esp+64h+Filename]
		mov	[esp+64h+Code],	eax ; char *
		call	sub_401BD6
		jmp	loc_4037A8
; ---------------------------------------------------------------------------

loc_4036FA:				; CODE XREF: sub_4032E3+404j
		cmp	[esp+64h+var_8], 1F5h
		jnz	short loc_403715
		mov	eax, [esp+64h+Filename]
		mov	[esp+64h+Code],	eax ; char *
		call	sub_401D61
		jmp	loc_4037A8
; ---------------------------------------------------------------------------

loc_403715:				; CODE XREF: sub_4032E3+41Fj
		cmp	[esp+64h+var_8], 1F6h
		jnz	short loc_40372D
		mov	eax, [esp+64h+Filename]
		mov	[esp+64h+Code],	eax ; char *
		call	sub_401EC9
		jmp	short loc_4037A8
; ---------------------------------------------------------------------------

loc_40372D:				; CODE XREF: sub_4032E3+43Aj
		cmp	[esp+64h+var_8], 1F7h
		jnz	short loc_403745
		mov	eax, [esp+64h+Filename]
		mov	[esp+64h+Code],	eax ; char *
		call	sub_402133
		jmp	short loc_4037A8
; ---------------------------------------------------------------------------

loc_403745:				; CODE XREF: sub_4032E3+452j
		cmp	[esp+64h+var_8], 1FAh
		jnz	short loc_40375D
		mov	eax, [esp+64h+Filename]
		mov	[esp+64h+Code],	eax ; Filename
		call	sub_402637
		jmp	short loc_4037A8
; ---------------------------------------------------------------------------

loc_40375D:				; CODE XREF: sub_4032E3+46Aj
		cmp	[esp+64h+var_8], 1FBh
		jnz	short loc_403775
		mov	eax, [esp+64h+Filename]
		mov	[esp+64h+Code],	eax ; char *
		call	sub_402D35
		jmp	short loc_4037A8
; ---------------------------------------------------------------------------

loc_403775:				; CODE XREF: sub_4032E3+482j
		cmp	[esp+64h+var_8], 1F8h
		jnz	short loc_40379C
		mov	eax, ds:dword_430904
		test	eax, eax
		jnz	short loc_403795
		mov	eax, ds:dword_430904
		add	eax, 1
		mov	ds:dword_430904, eax

loc_403795:				; CODE XREF: sub_4032E3+4A3j
		call	sub_404198
		jmp	short loc_4037A8
; ---------------------------------------------------------------------------

loc_40379C:				; CODE XREF: sub_4032E3+49Aj
		mov	eax, [esp+64h+Filename]
		mov	[esp+64h+Code],	eax ; char *
		call	sub_40201D

loc_4037A8:				; CODE XREF: sub_4032E3+3FAj
					; sub_4032E3+412j ...
		mov	[esp+64h+Code],	0
		call	$+5
sub_4032E3	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_4037B4	proc near		; CODE XREF: sub_403806+15Ap

Code		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_4037DE
		mov	[esp+18h+Code],	0
		call	sub_4200D0
		test	eax, eax
		jz	short loc_4037D7
		mov	eax, 2
		jmp	short loc_4037DC
; ---------------------------------------------------------------------------

loc_4037D7:				; CODE XREF: sub_4037B4+1Aj
		mov	eax, 0

loc_4037DC:				; CODE XREF: sub_4037B4+21j
		jmp	short loc_4037E1
; ---------------------------------------------------------------------------

loc_4037DE:				; CODE XREF: sub_4037B4+Aj
		mov	eax, [ebp+arg_0]

loc_4037E1:				; CODE XREF: sub_4037B4:loc_4037DCj
		mov	[ebp+arg_0], eax
		mov	eax, ds:dword_430050
		mov	[esp+18h+Code],	eax
		call	sub_40D0A3
		mov	ds:dword_430050, 0
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Code],	eax ; Code
		call	exit
sub_4037B4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403806	proc near		; CODE XREF: sub_401AB5+26p
					; sub_401BD6+26p ...

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	[ebp+var_10], 0
		mov	eax, ds:dword_43003C
		test	eax, eax
		jz	short loc_40382F
		mov	eax, ds:dword_43003C
		mov	[esp+48h+var_48], eax
		call	gcry_xstrdup
		jmp	loc_40398B
; ---------------------------------------------------------------------------

loc_40382F:				; CODE XREF: sub_403806+15j
		call	sub_40B949
		mov	[ebp+var_14], eax
		cmp	[ebp+arg_0], 1
		jnz	short loc_403850
		mov	eax, ds:dword_430040
		test	eax, eax
		jz	short loc_403850
		mov	eax, ds:dword_430040
		mov	[ebp+var_C], eax
		jmp	short loc_4038B2
; ---------------------------------------------------------------------------

loc_403850:				; CODE XREF: sub_403806+35j
					; sub_403806+3Ej
		cmp	[ebp+arg_0], 2
		jnz	short loc_403867
		mov	[esp+48h+var_48], offset aPleaseEnterThe ; "Please enter the passphrase	to unprotec"...
		call	sub_420034
		mov	[ebp+var_C], eax
		jmp	short loc_4038B2
; ---------------------------------------------------------------------------

loc_403867:				; CODE XREF: sub_403806+4Ej
		cmp	[ebp+arg_0], 3
		jnz	short loc_403885
		mov	[esp+48h+var_48], offset aPleaseEnterT_0 ; "Please enter the passphrase	to protect "...
		call	sub_420034
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 1
		jmp	short loc_4038B2
; ---------------------------------------------------------------------------

loc_403885:				; CODE XREF: sub_403806+65j
		cmp	[ebp+arg_0], 4
		jnz	short loc_4038A3
		mov	[esp+48h+var_48], offset aPleaseEnterT_1 ; "Please enter the passphrase	to protect "...
		call	sub_420034
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 1
		jmp	short loc_4038B2
; ---------------------------------------------------------------------------

loc_4038A3:				; CODE XREF: sub_403806+83j
		mov	[esp+48h+var_48], offset aPleaseEnterT_2 ; "Please enter the passphrase	or the PIN\"...
		call	sub_420034
		mov	[ebp+var_C], eax

loc_4038B2:				; CODE XREF: sub_403806+48j
					; sub_403806+5Fj ...
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	sub_40B962
		mov	[esp+48h+var_48], offset aPassphrase ; "Passphrase:"
		call	sub_420034
		lea	edx, [ebp+var_1C]
		mov	[esp+48h+var_2C], edx
		mov	[esp+48h+var_30], 1
		mov	edx, [ebp+var_10]
		mov	[esp+48h+var_34], edx
		mov	edx, [ebp+var_10]
		mov	[esp+48h+var_38], edx
		mov	edx, [ebp+var_C]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+var_44], 0 ; char
		mov	[esp+48h+var_48], 0
		call	sub_40DBAB
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_403965
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_401550
		cmp	eax, 63h
		jnz	short loc_403934
		mov	[esp+48h+var_48], offset aCancelled ; "cancelled\n"
		call	sub_420034
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_4208F3
		jmp	short loc_403959
; ---------------------------------------------------------------------------

loc_403934:				; CODE XREF: sub_403806+116j
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+48h+var_48], offset aErrorWhileAski ; "error while	asking for the passphrase: "...
		call	sub_420034
		mov	[esp+48h+var_44], ebx ;	char
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_42091D

loc_403959:				; CODE XREF: sub_403806+12Cj
		mov	[esp+48h+var_48], 0
		call	sub_4037B4
; ---------------------------------------------------------------------------

loc_403965:				; CODE XREF: sub_403806+106j
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jnz	short loc_403988
		mov	[esp+48h+var_40], 4AEh ; int
		mov	[esp+48h+var_44], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/agent/protect-tool."...
		mov	[esp+48h+var_48], offset aPw ; "pw"
		call	sub_4276E0

loc_403988:				; CODE XREF: sub_403806+164j
		mov	eax, [ebp+var_1C]

loc_40398B:				; CODE XREF: sub_403806+24j
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_403806	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403991	proc near		; CODE XREF: sub_401AB5+57p
					; sub_401BD6+5Ep ...

var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	[ebp+arg_0], 0
		jz	short loc_4039E7
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_4039D6
; ---------------------------------------------------------------------------

loc_4039C8:				; CODE XREF: sub_403991+49j
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1

loc_4039D6:				; CODE XREF: sub_403991+35j
		cmp	[ebp+var_10], 0
		jnz	short loc_4039C8
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	gcry_free

loc_4039E7:				; CODE XREF: sub_403991+Bj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_403991	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4039ED	proc near		; CODE XREF: sub_402637+43Ap

Filename	= dword	ptr -58h
var_54		= byte ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3D		= byte ptr -3Dh
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		lea	eax, [ebp+var_3D]
		mov	[esp+58h+var_50], eax
		mov	dword ptr [esp+58h+var_54], 14h
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Filename], eax
		call	sub_40E9C4
		mov	eax, offset a_key ; ".key"
		lea	edx, [ebp+var_3D]
		add	edx, 28h
		mov	ecx, [eax]
		mov	[edx], ecx
		movzx	eax, byte ptr [eax+4]
		mov	[edx+4], al
		mov	eax, ds:dword_430020
		mov	[esp+58h+var_4C], 0
		lea	edx, [ebp+var_3D]
		mov	[esp+58h+var_50], edx
		mov	dword ptr [esp+58h+var_54], offset aPrivateKeysV1_ ; "private-keys-v1.d"
		mov	[esp+58h+Filename], eax
		call	sub_42141F
		mov	[ebp+var_10], eax
		cmp	[ebp+arg_C], 0
		jz	short loc_403A6C
		mov	edx, offset aWb	; "wb"
		mov	eax, [ebp+var_10]
		mov	dword ptr [esp+58h+var_54], edx	; int
		mov	[esp+58h+Filename], eax	; char *
		call	sub_411413
		mov	[ebp+var_C], eax
		jmp	loc_403B05
; ---------------------------------------------------------------------------

loc_403A6C:				; CODE XREF: sub_4039ED+61j
		mov	dword ptr [esp+58h+var_54], 0 ;	char
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Filename], eax
		call	_access
		test	eax, eax
		jnz	short loc_403AEE
		mov	eax, ds:dword_430044
		test	eax, eax
		jz	short loc_403A98
		mov	[esp+58h+Filename], offset aProtectToolSec ; "[PROTECT-TOOL:] secretkey-exists\n"
		call	sub_4208F3

loc_403A98:				; CODE XREF: sub_4039ED+9Dj
		mov	eax, ds:dword_430034
		test	eax, eax
		jz	short loc_403AB6
		mov	eax, [ebp+var_10]
		mov	dword ptr [esp+58h+var_54], eax	; char
		mov	[esp+58h+Filename], offset aSecretKeyFileS ; "secret key file `%s' already exists\n"
		call	sub_4208F3
		jmp	short loc_403AC9
; ---------------------------------------------------------------------------

loc_403AB6:				; CODE XREF: sub_4039ED+B2j
		mov	eax, [ebp+var_10]
		mov	dword ptr [esp+58h+var_54], eax	; char
		mov	[esp+58h+Filename], offset aSecretKeyFileS ; "secret key file `%s' already exists\n"
		call	sub_42091D

loc_403AC9:				; CODE XREF: sub_4039ED+C7j
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Filename], eax
		call	gcry_free
		mov	eax, ds:dword_430034
		test	eax, eax
		jz	short loc_403AE4
		mov	eax, 0
		jmp	short loc_403AE9
; ---------------------------------------------------------------------------

loc_403AE4:				; CODE XREF: sub_4039ED+EEj
		mov	eax, 0FFFFFFFFh

loc_403AE9:				; CODE XREF: sub_4039ED+F5j
		jmp	locret_403C4D
; ---------------------------------------------------------------------------

loc_403AEE:				; CODE XREF: sub_4039ED+94j
		mov	edx, offset aWbx ; "wbx"
		mov	eax, [ebp+var_10]
		mov	dword ptr [esp+58h+var_54], edx	; int
		mov	[esp+58h+Filename], eax	; char *
		call	sub_411413
		mov	[ebp+var_C], eax

loc_403B05:				; CODE XREF: sub_4039ED+7Aj
		cmp	[ebp+var_C], 0
		jnz	short loc_403B48
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+58h+Filename], eax	; int
		call	strerror
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_10]
		mov	dword ptr [esp+58h+var_54], eax	; char
		mov	[esp+58h+Filename], offset aCanTCreateSS ; "can't create `%s': %s\n"
		call	sub_42091D
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Filename], eax
		call	gcry_free
		mov	eax, 0FFFFFFFFh
		jmp	locret_403C4D
; ---------------------------------------------------------------------------

loc_403B48:				; CODE XREF: sub_4039ED+11Cj
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], 1
		mov	eax, [ebp+arg_8]
		mov	dword ptr [esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Filename], eax
		call	sub_4128D8
		cmp	eax, 1
		jz	short loc_403BC1
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+58h+Filename], eax	; int
		call	strerror
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_10]
		mov	dword ptr [esp+58h+var_54], eax	; char
		mov	[esp+58h+Filename], offset aErrorWritingSS ; "error writing `%s': %s\n"
		call	sub_42091D
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Filename], eax	; void *
		call	sub_41202A
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Filename], eax	; Filename
		call	remove
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Filename], eax
		call	gcry_free
		mov	eax, 0FFFFFFFFh
		jmp	locret_403C4D
; ---------------------------------------------------------------------------

loc_403BC1:				; CODE XREF: sub_4039ED+17Fj
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Filename], eax	; void *
		call	sub_41202A
		test	eax, eax
		jz	short loc_403C15
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+58h+Filename], eax	; int
		call	strerror
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_10]
		mov	dword ptr [esp+58h+var_54], eax	; char
		mov	[esp+58h+Filename], offset aErrorClosingSS ; "error closing `%s': %s\n"
		call	sub_42091D
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Filename], eax	; Filename
		call	remove
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Filename], eax
		call	gcry_free
		mov	eax, 0FFFFFFFFh
		jmp	short locret_403C4D
; ---------------------------------------------------------------------------

loc_403C15:				; CODE XREF: sub_4039ED+1E1j
		mov	eax, [ebp+var_10]
		mov	dword ptr [esp+58h+var_54], eax	; char
		mov	[esp+58h+Filename], offset aSecretKeyStore ; "secret key stored	as `%s'\n"
		call	sub_4208F3
		mov	eax, ds:dword_430044
		test	eax, eax
		jz	short loc_403C3D
		mov	[esp+58h+Filename], offset aProtectToolS_0 ; "[PROTECT-TOOL:] secretkey-stored\n"
		call	sub_4208F3

loc_403C3D:				; CODE XREF: sub_4039ED+242j
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Filename], eax
		call	gcry_free
		mov	eax, 0

locret_403C4D:				; CODE XREF: sub_4039ED:loc_403AE9j
					; sub_4039ED+156j ...
		leave
		retn
sub_4039ED	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403C50	proc near		; CODE XREF: sub_403C77+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_403C70
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_403C75
; ---------------------------------------------------------------------------

loc_403C70:				; CODE XREF: sub_403C50+7j
		mov	eax, 0

loc_403C75:				; CODE XREF: sub_403C50+1Ej
		pop	ebp
		retn
sub_403C50	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403C77	proc near		; CODE XREF: sub_403C92+Ep
					; sub_403D3D+57p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 4
		call	sub_403C50
		leave
		retn
sub_403C77	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403C92	proc near		; CODE XREF: sub_403CA7+6p
					; .text:00406A02p ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_403C77
		leave
		retn
sub_403C92	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403CA7	proc near		; CODE XREF: sub_404392+A7p
					; sub_404392+137p ...
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		call	sub_403C92
		leave
		retn
sub_403CA7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403CB4	proc near		; CODE XREF: sub_403D3D+64p
					; sub_4041C5+36p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_4], eax
		mov	[ebp+var_8], 0
		jmp	short loc_403CEE
; ---------------------------------------------------------------------------

loc_403CCB:				; CODE XREF: sub_403CB4+60j
		mov	edx, [ebp+var_8]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_8], eax
		add	[ebp+var_4], 1

loc_403CEE:				; CODE XREF: sub_403CB4+15j
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_403D16
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_403D16
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_403D16
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jbe	short loc_403CCB

loc_403D16:				; CODE XREF: sub_403CB4+42j
					; sub_403CB4+4Cj ...
		cmp	[ebp+var_8], 0
		jz	short loc_403D26
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_403D2D

loc_403D26:				; CODE XREF: sub_403CB4+66j
		mov	eax, 0
		jmp	short locret_403D3B
; ---------------------------------------------------------------------------

loc_403D2D:				; CODE XREF: sub_403CB4+70j
		mov	eax, [ebp+var_4]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+var_8]

locret_403D3B:				; CODE XREF: sub_403CB4+77j
		leave
		retn
sub_403CB4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403D3D	proc near		; CODE XREF: sub_404830+411p
					; sub_40519A+341p ...

var_14		= dword	ptr -14h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_4], eax
		jmp	short loc_403DC6
; ---------------------------------------------------------------------------

loc_403D55:				; CODE XREF: sub_403D3D+8Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jnz	short loc_403D6E
		add	[ebp+var_4], 1
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+var_C], eax
		jmp	short loc_403DC6
; ---------------------------------------------------------------------------

loc_403D6E:				; CODE XREF: sub_403D3D+20j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jnz	short loc_403D87
		sub	[ebp+var_4], 1
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+var_C], eax
		jmp	short loc_403DC6
; ---------------------------------------------------------------------------

loc_403D87:				; CODE XREF: sub_403D3D+39j
		cmp	[ebp+var_4], 0
		jnz	short loc_403D9B
		mov	[esp+14h+var_14], 53h
		call	sub_403C77
		jmp	short locret_403DE1
; ---------------------------------------------------------------------------

loc_403D9B:				; CODE XREF: sub_403D3D+4Ej
		lea	eax, [ebp+var_C]
		mov	[esp+14h+var_14], eax
		call	sub_403CB4
		mov	[ebp+var_8], eax
		cmp	[ebp+var_8], 0
		jnz	short loc_403DBD
		mov	[esp+14h+var_14], 53h
		call	sub_403C77
		jmp	short locret_403DE1
; ---------------------------------------------------------------------------

loc_403DBD:				; CODE XREF: sub_403D3D+70j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_8]
		mov	[ebp+var_C], eax

loc_403DC6:				; CODE XREF: sub_403D3D+16j
					; sub_403D3D+2Fj ...
		cmp	[ebp+var_4], 0
		jg	short loc_403D55
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_4]
		mov	[eax], edx
		mov	eax, 0

locret_403DE1:				; CODE XREF: sub_403D3D+5Cj
					; sub_403D3D+7Ej
		leave
		retn
sub_403D3D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403DE3(int, int, void	*)
sub_403DE3	proc near		; CODE XREF: sub_4041C5+6Ap
					; sub_404830+C6p ...

Buf1		= dword	ptr -38h
Buf2		= dword	ptr -34h
Size		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		cmp	eax, [ebp+var_C]
		jnz	short loc_403E33
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Size],	edx ; Size
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Buf2],	edx ; Buf2
		mov	[esp+38h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_403E3A

loc_403E33:				; CODE XREF: sub_403DE3+2Fj
		mov	eax, 0
		jmp	short loc_403E4E
; ---------------------------------------------------------------------------

loc_403E3A:				; CODE XREF: sub_403DE3+4Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, 1

loc_403E4E:				; CODE XREF: sub_403DE3+55j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_403DE3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403E54	proc near		; CODE XREF: .text:00406248p
					; .text:00406358p

var_14		= dword	ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		mov	[ebp+var_4], eax
		cmp	[ebp+arg_4], 2
		jbe	short loc_403ED1
		sub	[ebp+var_4], 1
		mov	eax, [ebp+var_4]
		mov	byte ptr [eax],	0
		sub	[ebp+var_4], 1
		mov	eax, [ebp+var_4]
		mov	byte ptr [eax],	3Ah

loc_403E7F:				; CODE XREF: sub_403E54+7Bj
		sub	[ebp+var_4], 1
		mov	ecx, [ebp+arg_8]
		mov	edx, 0CCCCCCCDh
		mov	eax, ecx
		mul	edx
		shr	edx, 3
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_4]
		mov	[eax], dl
		mov	ecx, [ebp+arg_8]
		mov	[ebp+var_14], ecx
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_14]
		mul	edx
		mov	eax, edx
		shr	eax, 3
		mov	[ebp+arg_8], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_403ED1
		mov	eax, [ebp+var_4]
		cmp	eax, [ebp+arg_0]
		ja	short loc_403E7F

loc_403ED1:				; CODE XREF: sub_403E54+15j
					; sub_403E54+73j
		cmp	[ebp+arg_C], 0
		jz	short loc_403EF1
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		mov	edx, eax
		mov	eax, [ebp+var_4]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_403EF1:				; CODE XREF: sub_403E54+81j
		mov	eax, [ebp+var_4]
		leave
		retn
sub_403E54	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403EF6(LPFILETIME)
sub_403EF6	proc near		; CODE XREF: sub_403F46+Dp
					; sub_40402A+Cp

hProcess	= dword	ptr -48h
lpCreationTime	= dword	ptr -44h
lpExitTime	= dword	ptr -40h
lpKernelTime	= dword	ptr -3Ch
lpUserTime	= dword	ptr -38h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	eax, [ebp+arg_0]
		add	eax, 18h
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		lea	edi, [eax+10h]
		mov	eax, [ebp+arg_0]
		lea	esi, [eax+8]
		mov	ebx, [ebp+arg_0]
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	edx, [ebp+var_1C]
		mov	[esp+48h+lpUserTime], edx ; lpUserTime
		mov	[esp+48h+lpKernelTime],	edi ; lpKernelTime
		mov	[esp+48h+lpExitTime], esi ; lpExitTime
		mov	[esp+48h+lpCreationTime], ebx ;	lpCreationTime
		mov	[esp+48h+hProcess], eax	; hProcess
		mov	eax, ds:GetProcessTimes
		call	eax ; GetProcessTimes
		sub	esp, 14h
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_403EF6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403F46	proc near		; CODE XREF: sub_40402A+76p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= _FILETIME ptr	-38h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		lea	eax, [ebp+var_38]
		mov	[esp+48h+var_48], eax ;	LPFILETIME
		call	sub_403EF6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	edx, 0
		mov	ecx, eax
		mov	ebx, edx
		mov	ebx, ecx
		mov	ecx, 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, 0
		mov	ecx, eax
		mov	ebx, edx
		mov	ebx, ecx
		mov	ecx, 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		add	[ebp+var_10], eax
		adc	[ebp+var_C], edx
		mov	eax, [ebp+var_24]
		mov	edx, 0
		mov	ecx, eax
		mov	ebx, edx
		mov	ebx, ecx
		mov	ecx, 0
		mov	eax, [ebp+var_28]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_1C]
		mov	edx, 0
		mov	ecx, eax
		mov	ebx, edx
		mov	ebx, ecx
		mov	ecx, 0
		mov	eax, [ebp+var_20]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		add	[ebp+var_18], eax
		adc	[ebp+var_14], edx
		mov	ecx, [ebp+var_10]
		mov	ebx, [ebp+var_C]
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		sub	eax, ecx
		sbb	edx, ebx
		mov	[esp+48h+var_40], 2710h
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_48], eax
		mov	[esp+48h+var_44], edx
		call	sub_427220
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_403F46	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40402A	proc near		; CODE XREF: sub_4040A7+15p
					; sub_4040A7+CAp

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_3C		= _FILETIME ptr	-3Ch
var_1C		= byte ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		lea	eax, [ebp+var_3C]
		mov	[esp+68h+var_68], eax ;	LPFILETIME
		call	sub_403EF6
		mov	[esp+68h+var_50], 10h
		lea	eax, [ebp+var_1C]
		mov	[esp+68h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_58], eax
		mov	[esp+68h+var_5C], offset aSaltsalt ; "saltsalt"
		mov	[esp+68h+var_60], 3
		mov	[esp+68h+var_64], 2
		mov	[esp+68h+var_68], offset a123456789abcde ; "123456789abcdef0"
		call	sub_405ECF
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40409A
		mov	[esp+68h+var_60], offset aCalibrate_s2k_ ; "calibrate_s2k_count_one"
		mov	[esp+68h+var_64], 8Ch
		mov	[esp+68h+var_68], offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/agent/protect.c"
		call	sub_420AAC
; ---------------------------------------------------------------------------

loc_40409A:				; CODE XREF: sub_40402A+52j
		lea	eax, [ebp+var_3C]
		mov	[esp+68h+var_68], eax
		call	sub_403F46
		leave
		retn
sub_40402A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4040A7	proc near		; CODE XREF: sub_404198+Fp

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_24		= word ptr -24h
var_22		= word ptr -22h
var_20		= qword	ptr -20h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	dword ptr [ebp+var_C], 10000h
		jmp	short loc_4040F1
; ---------------------------------------------------------------------------

loc_4040B6:				; CODE XREF: sub_4040A7+4Ej
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_40402A
		mov	[ebp+var_10], eax
		mov	eax, ds:dword_430904
		cmp	eax, 1
		jle	short loc_4040E8
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_30], eax
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aS2kCalibration ; "S2K	calibration: %lu -> %lums\n"
		call	sub_4208F3

loc_4040E8:				; CODE XREF: sub_4040A7+25j
		cmp	[ebp+var_10], 64h
		ja	short loc_4040F9
		shl	dword ptr [ebp+var_C], 1

loc_4040F1:				; CODE XREF: sub_4040A7+Dj
		cmp	dword ptr [ebp+var_C], 0
		jnz	short loc_4040B6
		jmp	short loc_4040FA
; ---------------------------------------------------------------------------

loc_4040F9:				; CODE XREF: sub_4040A7+45j
		nop

loc_4040FA:				; CODE XREF: sub_4040A7+50j
		mov	eax, dword ptr [ebp+var_C]
		mov	edx, 0
		mov	dword ptr [ebp+var_20],	eax
		mov	dword ptr [ebp+var_20+4], edx
		fild	[ebp+var_20]
		mov	eax, [ebp+var_10]
		mov	edx, 0
		mov	dword ptr [ebp+var_20],	eax
		mov	dword ptr [ebp+var_20+4], edx
		fild	[ebp+var_20]
		fdivp	st(1), st
		fld	ds:dbl_42AE50
		fmulp	st(1), st
		fnstcw	[ebp+var_22]
		movzx	eax, [ebp+var_22]
		mov	ah, 0Ch
		mov	[ebp+var_24], ax
		fldcw	[ebp+var_24]
		fistp	[ebp+var_20]
		fldcw	[ebp+var_22]
		mov	eax, dword ptr [ebp+var_20]
		mov	edx, dword ptr [ebp+var_20+4]
		mov	dword ptr [ebp+var_C], eax
		mov	eax, dword ptr [ebp+var_C]
		shr	eax, 0Ah
		mov	dword ptr [ebp+var_C], eax
		shl	dword ptr [ebp+var_C], 0Ah
		cmp	dword ptr [ebp+var_C], 0FFFFh
		ja	short loc_404162
		mov	dword ptr [ebp+var_C], 10000h

loc_404162:				; CODE XREF: sub_4040A7+B2j
		mov	eax, ds:dword_430904
		test	eax, eax
		jz	short loc_404193
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_40402A
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_30], eax
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aS2kCalibrati_0 ; "S2K	calibration: %lu iterations for	%lu"...
		call	sub_4208F3

loc_404193:				; CODE XREF: sub_4040A7+C2j
		mov	eax, dword ptr [ebp+var_C]
		leave
		retn
sub_4040A7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404198	proc near		; CODE XREF: sub_4032E3:loc_403795p
					; sub_404392:loc_4044D3p ...
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, ds:dword_430054
		test	eax, eax
		jnz	short loc_4041B1
		call	sub_4040A7
		mov	ds:dword_430054, eax

loc_4041B1:				; CODE XREF: sub_404198+Dj
		mov	eax, ds:dword_430054
		mov	edx, 10000h
		cmp	eax, 10000h
		cmovb	eax, edx
		leave
		retn
sub_404198	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4041C5	proc near		; CODE XREF: sub_4056C4+656p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_4041EC
		mov	[esp+28h+var_28], 53h
		call	sub_403C77
		jmp	locret_404390
; ---------------------------------------------------------------------------

loc_4041EC:				; CODE XREF: sub_4041C5+14j
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_18], eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	sub_403CB4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40421A
		mov	[esp+28h+var_28], 53h
		call	sub_403C77
		jmp	locret_404390
; ---------------------------------------------------------------------------

loc_40421A:				; CODE XREF: sub_4041C5+42j
		mov	[esp+28h+var_20], offset aPrivateKey_0 ; "private-key"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_24], eax ;	int
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_403DE3
		test	eax, eax
		jnz	short loc_404249
		mov	[esp+28h+var_28], 68h
		call	sub_403C77
		jmp	locret_404390
; ---------------------------------------------------------------------------

loc_404249:				; CODE XREF: sub_4041C5+71j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_404264
		mov	[esp+28h+var_28], 68h
		call	sub_403C77
		jmp	locret_404390
; ---------------------------------------------------------------------------

loc_404264:				; CODE XREF: sub_4041C5+8Cj
		mov	eax, [ebp+var_18]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_18], eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	sub_403CB4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_404298
		mov	[esp+28h+var_28], 53h
		call	sub_403C77
		jmp	locret_404390
; ---------------------------------------------------------------------------

loc_404298:				; CODE XREF: sub_4041C5+C0j
		mov	eax, [ebp+var_18]
		add	eax, [ebp+var_C]
		mov	[ebp+var_18], eax
		jmp	loc_40432C
; ---------------------------------------------------------------------------

loc_4042A6:				; CODE XREF: sub_4041C5+16Fj
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_18], eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	sub_403CB4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4042D4
		mov	[esp+28h+var_28], 53h
		call	sub_403C77
		jmp	locret_404390
; ---------------------------------------------------------------------------

loc_4042D4:				; CODE XREF: sub_4041C5+FCj
		mov	eax, [ebp+var_18]
		add	eax, [ebp+var_C]
		mov	[ebp+var_18], eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	sub_403CB4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_404302
		mov	[esp+28h+var_28], 53h
		call	sub_403C77
		jmp	locret_404390
; ---------------------------------------------------------------------------

loc_404302:				; CODE XREF: sub_4041C5+12Aj
		mov	eax, [ebp+var_18]
		add	eax, [ebp+var_C]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jz	short loc_404323
		mov	[esp+28h+var_28], 53h
		call	sub_403C77
		jmp	short locret_404390
; ---------------------------------------------------------------------------

loc_404323:				; CODE XREF: sub_4041C5+14Ej
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_18], eax

loc_40432C:				; CODE XREF: sub_4041C5+DCj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	loc_4042A6
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jz	short loc_404352
		mov	[esp+28h+var_28], 53h
		call	sub_403C77
		jmp	short locret_404390
; ---------------------------------------------------------------------------

loc_404352:				; CODE XREF: sub_4041C5+17Dj
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_14], eax
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], 2
		call	gcry_md_hash_buffer
		mov	eax, 0

locret_404390:				; CODE XREF: sub_4041C5+22j
					; sub_4041C5+50j ...
		leave
		retn
sub_4041C5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404392(void *, size_t, int, int, int,	int)
sub_404392	proc near		; CODE XREF: sub_404830+563p

Dst		= dword	ptr -0B8h
Src		= dword	ptr -0B4h
Size		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_6C		= dword	ptr -6Ch
var_67		= byte ptr -67h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0B0h
		mov	[ebp+var_14], offset aOpenpgpS2k3Sha ; "openpgp-s2k3-sha1-aes-cbc"
		mov	[ebp+var_C], 0
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		mov	[esp+0B8h+var_AC], 1
		mov	[esp+0B8h+Size], 3
		mov	[esp+0B8h+Src],	7
		lea	eax, [ebp+var_38]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_cipher_open
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4043F8
		mov	eax, [ebp+var_10]
		jmp	loc_404826
; ---------------------------------------------------------------------------

loc_4043F8:				; CODE XREF: sub_404392+5Cj
		mov	[esp+0B8h+Dst],	7
		call	gcry_cipher_get_algo_blklen
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		add	eax, [ebp+arg_4]
		add	eax, 29h
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	edx, eax
		sar	edx, 1Fh
		idiv	[ebp+var_1C]
		imul	eax, [ebp+var_1C]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_20]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_malloc_secure
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_404441
		call	sub_403CA7
		mov	[ebp+var_10], eax

loc_404441:				; CODE XREF: sub_404392+A5j
		cmp	[ebp+var_10], 0
		jnz	short loc_4044A4
		mov	eax, [ebp+var_1C]
		add	eax, 4
		add	eax, eax
		mov	[esp+0B8h+Dst],	eax
		call	gcry_malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_404471
		mov	[esp+0B8h+Dst],	8056h
		call	sub_403C77
		mov	[ebp+var_10], eax
		jmp	short loc_4044A4
; ---------------------------------------------------------------------------

loc_404471:				; CODE XREF: sub_404392+CCj
		mov	eax, [ebp+var_1C]
		add	eax, 4
		add	eax, eax
		mov	[esp+0B8h+Src],	eax
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_create_nonce
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_38]
		mov	[esp+0B8h+Size], edx
		mov	edx, [ebp+var_C]
		mov	[esp+0B8h+Src],	edx
		mov	[esp+0B8h+Dst],	eax
		call	gcry_cipher_setiv
		mov	[ebp+var_10], eax

loc_4044A4:				; CODE XREF: sub_404392+B3j
					; sub_404392+DDj
		cmp	[ebp+var_10], 0
		jnz	loc_404541
		mov	[ebp+var_28], 10h
		mov	eax, [ebp+var_28]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_malloc_secure
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jnz	short loc_4044D3
		call	sub_403CA7
		mov	[ebp+var_10], eax
		jmp	short loc_404541
; ---------------------------------------------------------------------------

loc_4044D3:				; CODE XREF: sub_404392+135j
		call	sub_404198
		mov	edx, [ebp+var_1C]
		add	edx, edx
		add	edx, [ebp+var_C]
		mov	ecx, [ebp+var_28]
		mov	[esp+0B8h+var_A0], ecx
		mov	ecx, [ebp+var_2C]
		mov	[esp+0B8h+var_A4], ecx
		mov	[esp+0B8h+var_A8], eax
		mov	[esp+0B8h+var_AC], edx
		mov	[esp+0B8h+Size], 3
		mov	[esp+0B8h+Src],	2
		mov	eax, [ebp+arg_8]
		mov	[esp+0B8h+Dst],	eax
		call	sub_405ECF
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_404536
		mov	eax, [ebp+var_38]
		mov	edx, [ebp+var_28]
		mov	[esp+0B8h+Size], edx
		mov	edx, [ebp+var_2C]
		mov	[esp+0B8h+Src],	edx
		mov	[esp+0B8h+Dst],	eax
		call	gcry_cipher_setkey
		mov	[ebp+var_10], eax

loc_404536:				; CODE XREF: sub_404392+186j
		mov	eax, [ebp+var_2C]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_free

loc_404541:				; CODE XREF: sub_404392+116j
					; sub_404392+13Fj
		cmp	[ebp+var_10], 0
		jnz	loc_404664
		mov	eax, [ebp+var_18]
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		mov	byte ptr [eax],	28h
		add	[ebp+var_30], 1
		mov	eax, [ebp+var_30]
		mov	byte ptr [eax],	28h
		add	[ebp+var_30], 1
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_30]
		mov	ecx, [ebp+arg_4]
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Src],	edx ; Src
		mov	[esp+0B8h+Dst],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_4]
		add	[ebp+var_30], eax
		mov	edx, offset a4Hash4Sha120 ; ")(4:hash4:sha120:"
		mov	eax, [ebp+var_30]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		movzx	edx, byte ptr [edx+10h]
		mov	[eax+10h], dl
		add	[ebp+var_30], 11h
		mov	edx, [ebp+arg_C]
		mov	eax, [ebp+var_30]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	edx, [edx+10h]
		mov	[eax+10h], edx
		add	[ebp+var_30], 14h
		mov	eax, [ebp+var_30]
		mov	byte ptr [eax],	29h
		add	[ebp+var_30], 1
		mov	eax, [ebp+var_30]
		mov	byte ptr [eax],	29h
		add	[ebp+var_30], 1
		mov	ecx, [ebp+var_1C]
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_1C]
		add	edx, eax
		mov	eax, [ebp+var_30]
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Src],	edx ; Src
		mov	[esp+0B8h+Dst],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_1C]
		add	[ebp+var_30], eax
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_18]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+var_20]
		jz	short loc_404638
		mov	[esp+0B8h+Size], 15Fh ;	int
		mov	[esp+0B8h+Src],	offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/agent/protect.c"
		mov	[esp+0B8h+Dst],	offset aPOutbufOutlen ;	"p - outbuf == outlen"
		call	sub_4276E0

loc_404638:				; CODE XREF: sub_404392+288j
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_38]
		mov	[esp+0B8h+var_A8], 0
		mov	[esp+0B8h+var_AC], 0
		mov	[esp+0B8h+Size], edx
		mov	edx, [ebp+var_18]
		mov	[esp+0B8h+Src],	edx
		mov	[esp+0B8h+Dst],	eax
		call	gcry_cipher_encrypt
		mov	[ebp+var_10], eax

loc_404664:				; CODE XREF: sub_404392+1B3j
		mov	eax, [ebp+var_38]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_cipher_close
		cmp	[ebp+var_10], 0
		jz	short loc_404693
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		jmp	loc_404826
; ---------------------------------------------------------------------------

loc_404693:				; CODE XREF: sub_404392+2E1j
		call	sub_404198
		mov	[esp+0B8h+var_AC], eax
		mov	[esp+0B8h+Size], offset	aLu ; "%lu"
		mov	[esp+0B8h+Src],	23h
		lea	eax, [ebp+var_67]
		mov	[esp+0B8h+Dst],	eax
		call	sub_416641
		lea	eax, [ebp+var_67]
		mov	[ebp+var_6C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_6C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_14]
		mov	[ebp+var_6C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_6C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+0B8h+var_84], offset dword_42AD08
		mov	edx, [ebp+var_24]
		mov	[esp+0B8h+var_88], edx
		lea	edx, [ebp+var_44]
		mov	[esp+0B8h+var_8C], edx
		mov	edx, [ebp+var_24]
		mov	[esp+0B8h+var_90], edx
		mov	[esp+0B8h+var_94], offset dword_42AD08
		mov	edx, [ebp+var_1C]
		mov	[esp+0B8h+var_98], edx
		lea	edx, [ebp+var_40]
		mov	[esp+0B8h+var_9C], edx
		mov	edx, [ebp+var_1C]
		mov	[esp+0B8h+var_A0], edx
		lea	edx, [ebp+var_67]
		mov	[esp+0B8h+var_A4], edx
		mov	[esp+0B8h+var_A8], ebx
		lea	edx, [ebp+var_3C]
		mov	[esp+0B8h+var_AC], edx
		mov	edx, [ebp+var_14]
		mov	[esp+0B8h+Size], edx
		mov	[esp+0B8h+Src],	eax
		mov	[esp+0B8h+Dst],	offset a9ProtectedDS4S ; "(9:protected%d:%s((4:sha18:%n_8bytes_%u"...
		call	sub_41691D
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	short loc_404787
		call	sub_403CA7
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_free
		mov	eax, [ebp+var_34]
		jmp	loc_404826
; ---------------------------------------------------------------------------

loc_404787:				; CODE XREF: sub_404392+3CDj
		mov	eax, [ebp+var_30]
		mov	[ebp+var_6C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_6C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_30]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_1C]
		add	eax, eax
		add	edx, eax
		mov	ecx, [ebp+var_30]
		mov	eax, [ebp+var_3C]
		add	eax, ecx
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	edx, [edx+4]
		mov	[eax+4], edx
		mov	ecx, [ebp+var_1C]
		mov	edx, [ebp+var_C]
		mov	ebx, [ebp+var_30]
		mov	eax, [ebp+var_40]
		add	eax, ebx
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Src],	edx ; Src
		mov	[esp+0B8h+Dst],	eax ; Dst
		call	memcpy
		mov	ecx, [ebp+var_24]
		mov	edx, [ebp+var_18]
		mov	ebx, [ebp+var_30]
		mov	eax, [ebp+var_44]
		add	eax, ebx
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Src],	edx ; Src
		mov	[esp+0B8h+Dst],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_free
		mov	eax, 0

loc_404826:				; CODE XREF: sub_404392+61j
					; sub_404392+2FCj ...
		add	esp, 0B0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_404392	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404830	proc near		; CODE XREF: sub_401AB5+49p
					; sub_402637+374p

Buf1		= dword	ptr -0B8h
Buf2		= dword	ptr -0B4h
Size		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
Src		= dword	ptr -84h
var_7F		= byte ptr -7Fh
var_5D		= byte ptr -5Dh
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
Dst		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0B4h
		mov	[ebp+var_8C], 0
		mov	edx, offset a12ProtectedAt1 ; "(12:protected-at15:"
		lea	eax, [ebp+var_7F]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		movzx	ecx, word ptr [edx+10h]
		mov	[eax+10h], cx
		movzx	edx, byte ptr [edx+12h]
		mov	[eax+12h], dl
		lea	eax, [ebp+var_7F]
		add	eax, 13h
		mov	[esp+0B8h+Buf1], eax
		call	sub_4169F8
		mov	[ebp+var_5D], 29h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_48]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_4048A4
		mov	[esp+0B8h+Buf1], 53h
		call	sub_403C77
		jmp	loc_404F61
; ---------------------------------------------------------------------------

loc_4048A4:				; CODE XREF: sub_404830+61j
		mov	eax, [ebp+var_8C]
		add	eax, 1
		mov	[ebp+var_8C], eax
		mov	eax, [ebp+var_48]
		add	eax, 1
		mov	[ebp+var_48], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0B8h+Buf1], eax
		call	sub_403CB4
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_4048E1
		mov	[esp+0B8h+Buf1], 53h
		call	sub_403C77
		jmp	loc_404F61
; ---------------------------------------------------------------------------

loc_4048E1:				; CODE XREF: sub_404830+9Ej
		mov	[esp+0B8h+Size], offset	aPrivateKey_0 ;	"private-key"
		mov	eax, [ebp+var_28]
		mov	[esp+0B8h+Buf2], eax ; int
		lea	eax, [ebp+var_48]
		mov	[esp+0B8h+Buf1], eax ; int
		call	sub_403DE3
		test	eax, eax
		jnz	short loc_404910
		mov	[esp+0B8h+Buf1], 68h
		call	sub_403C77
		jmp	loc_404F61
; ---------------------------------------------------------------------------

loc_404910:				; CODE XREF: sub_404830+CDj
		mov	eax, [ebp+var_48]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_40492B
		mov	[esp+0B8h+Buf1], 68h
		call	sub_403C77
		jmp	loc_404F61
; ---------------------------------------------------------------------------

loc_40492B:				; CODE XREF: sub_404830+E8j
		mov	eax, [ebp+var_8C]
		add	eax, 1
		mov	[ebp+var_8C], eax
		mov	eax, [ebp+var_48]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_48]
		add	eax, 1
		mov	[ebp+var_48], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0B8h+Buf1], eax
		call	sub_403CB4
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_40496E
		mov	[esp+0B8h+Buf1], 53h
		call	sub_403C77
		jmp	loc_404F61
; ---------------------------------------------------------------------------

loc_40496E:				; CODE XREF: sub_404830+12Bj
		mov	[ebp+var_20], 0
		jmp	short loc_40497B
; ---------------------------------------------------------------------------

loc_404977:				; CODE XREF: sub_404830+18Fj
		add	[ebp+var_20], 1

loc_40497B:				; CODE XREF: sub_404830+145j
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_429180
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4049C1
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_429180
		mov	eax, [eax]
		mov	[esp+0B8h+Size], eax ; void *
		mov	eax, [ebp+var_28]
		mov	[esp+0B8h+Buf2], eax ; int
		lea	eax, [ebp+var_48]
		mov	[esp+0B8h+Buf1], eax ; int
		call	sub_403DE3
		test	eax, eax
		jz	short loc_404977

loc_4049C1:				; CODE XREF: sub_404830+161j
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_429180
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4049EA
		mov	[esp+0B8h+Buf1], 54h
		call	sub_403C77
		jmp	loc_404F61
; ---------------------------------------------------------------------------

loc_4049EA:				; CODE XREF: sub_404830+1A7j
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_429180
		mov	eax, [eax+4]
		mov	[ebp+var_C], eax
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_429180
		mov	eax, [eax+8]
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_429180
		mov	eax, [eax+0Ch]
		mov	[ebp+var_14], eax
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_18], eax
		mov	[ebp+var_24], 0
		jmp	loc_404BAC
; ---------------------------------------------------------------------------

loc_404A4B:				; CODE XREF: sub_404830+38Fj
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_10]
		jnz	short loc_404A59
		mov	eax, [ebp+var_48]
		mov	[ebp+var_18], eax

loc_404A59:				; CODE XREF: sub_404830+221j
		mov	eax, [ebp+var_48]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_404A74
		mov	[esp+0B8h+Buf1], 53h
		call	sub_403C77
		jmp	loc_404F61
; ---------------------------------------------------------------------------

loc_404A74:				; CODE XREF: sub_404830+231j
		mov	eax, [ebp+var_8C]
		add	eax, 1
		mov	[ebp+var_8C], eax
		mov	eax, [ebp+var_48]
		add	eax, 1
		mov	[ebp+var_48], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0B8h+Buf1], eax
		call	sub_403CB4
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_404AB1
		mov	[esp+0B8h+Buf1], 53h
		call	sub_403C77
		jmp	loc_404F61
; ---------------------------------------------------------------------------

loc_404AB1:				; CODE XREF: sub_404830+26Ej
		cmp	[ebp+var_28], 1
		jnz	short loc_404AC5
		mov	eax, [ebp+var_48]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+var_30]
		jz	short loc_404B30

loc_404AC5:				; CODE XREF: sub_404830+285j
		cmp	[ebp+var_28], 5
		jnz	short loc_404B1F
		mov	eax, [ebp+var_48]
		mov	[esp+0B8h+Size], 5 ; Size
		mov	[esp+0B8h+Buf2], offset	aCurve ; "curve"
		mov	[esp+0B8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_404B1F
		cmp	[ebp+var_24], 0
		jnz	short loc_404B1F
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_429190
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_404B1F
		mov	[ebp+var_C], offset a?qd ; "?qd"
		mov	[ebp+var_10], 2
		mov	[ebp+var_14], 2
		jmp	short loc_404B30
; ---------------------------------------------------------------------------

loc_404B1F:				; CODE XREF: sub_404830+299j
					; sub_404830+2B8j ...
		mov	[esp+0B8h+Buf1], 53h
		call	sub_403C77
		jmp	loc_404F61
; ---------------------------------------------------------------------------

loc_404B30:				; CODE XREF: sub_404830+293j
					; sub_404830+2EDj
		mov	eax, [ebp+var_48]
		add	eax, [ebp+var_28]
		mov	[ebp+var_48], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0B8h+Buf1], eax
		call	sub_403CB4
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_404B5E
		mov	[esp+0B8h+Buf1], 53h
		call	sub_403C77
		jmp	loc_404F61
; ---------------------------------------------------------------------------

loc_404B5E:				; CODE XREF: sub_404830+31Bj
		mov	eax, [ebp+var_48]
		add	eax, [ebp+var_28]
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_48]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jz	short loc_404B82
		mov	[esp+0B8h+Buf1], 53h
		call	sub_403C77
		jmp	loc_404F61
; ---------------------------------------------------------------------------

loc_404B82:				; CODE XREF: sub_404830+33Fj
		mov	eax, [ebp+var_8C]
		sub	eax, 1
		mov	[ebp+var_8C], eax
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_14]
		jnz	short loc_404B9F
		mov	eax, [ebp+var_48]
		mov	[ebp+var_1C], eax

loc_404B9F:				; CODE XREF: sub_404830+367j
		mov	eax, [ebp+var_48]
		add	eax, 1
		mov	[ebp+var_48], eax
		add	[ebp+var_24], 1

loc_404BAC:				; CODE XREF: sub_404830+216j
		mov	eax, [ebp+var_24]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	loc_404A4B
		mov	eax, [ebp+var_48]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jnz	short loc_404BDB
		cmp	[ebp+var_18], 0
		jz	short loc_404BDB
		cmp	[ebp+var_1C], 0
		jnz	short loc_404BEC

loc_404BDB:				; CODE XREF: sub_404830+39Dj
					; sub_404830+3A3j
		mov	[esp+0B8h+Buf1], 53h
		call	sub_403C77
		jmp	loc_404F61
; ---------------------------------------------------------------------------

loc_404BEC:				; CODE XREF: sub_404830+3A9j
		mov	eax, [ebp+var_8C]
		sub	eax, 1
		mov	[ebp+var_8C], eax
		mov	eax, [ebp+var_48]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_48]
		add	eax, 1
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_8C]
		cmp	eax, 1
		jz	short loc_404C31
		mov	[esp+0B8h+Size], 1F6h ;	int
		mov	[esp+0B8h+Buf2], offset	a____Gnupg22__0	; "../../gnupg2-2.0.30/agent/protect.c"
		mov	[esp+0B8h+Buf1], offset	aDepth1	; "depth == 1"
		call	sub_4276E0

loc_404C31:				; CODE XREF: sub_404830+3E3j
		lea	eax, [ebp+var_8C]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0B8h+Buf1], eax
		call	sub_403D3D
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jz	short loc_404C57
		mov	eax, [ebp+var_38]
		jmp	loc_404F61
; ---------------------------------------------------------------------------

loc_404C57:				; CODE XREF: sub_404830+41Dj
		mov	eax, [ebp+var_8C]
		test	eax, eax
		jz	short loc_404C7D
		mov	[esp+0B8h+Size], 1FAh ;	int
		mov	[esp+0B8h+Buf2], offset	a____Gnupg22__0	; "../../gnupg2-2.0.30/agent/protect.c"
		mov	[esp+0B8h+Buf1], offset	aDepth ; "!depth"
		call	sub_4276E0

loc_404C7D:				; CODE XREF: sub_404830+42Fj
		mov	eax, [ebp+var_48]
		sub	eax, 1
		mov	[ebp+var_3C], eax
		mov	[esp+0B8h+Size], 0
		mov	[esp+0B8h+Buf2], 2
		lea	eax, [ebp+var_90]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_md_open
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jz	short loc_404CB5
		mov	eax, [ebp+var_38]
		jmp	loc_404F61
; ---------------------------------------------------------------------------

loc_404CB5:				; CODE XREF: sub_404830+47Bj
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_2C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+var_90]
		mov	[esp+0B8h+Size], edx
		mov	edx, [ebp+var_2C]
		mov	[esp+0B8h+Buf2], edx
		mov	[esp+0B8h+Buf1], eax
		call	gcry_md_write
		mov	eax, [ebp+var_90]
		mov	[esp+0B8h+Size], 23h
		lea	edx, [ebp+var_7F]
		mov	[esp+0B8h+Buf2], edx
		mov	[esp+0B8h+Buf1], eax
		call	gcry_md_write
		mov	eax, [ebp+var_90]
		mov	[esp+0B8h+Size], 1
		mov	[esp+0B8h+Buf2], offset	asc_42AD7A ; ")"
		mov	[esp+0B8h+Buf1], eax
		call	gcry_md_write
		mov	eax, [ebp+var_90]
		mov	[esp+0B8h+Buf2], 2
		mov	[esp+0B8h+Buf1], eax
		call	gcry_md_read
		mov	edx, [eax]
		mov	[ebp+var_5C], edx
		mov	edx, [eax+4]
		mov	[ebp+var_58], edx
		mov	edx, [eax+8]
		mov	[ebp+var_54], edx
		mov	edx, [eax+0Ch]
		mov	[ebp+var_50], edx
		mov	eax, [eax+10h]
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_90]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_md_close
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_18]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		add	eax, 1
		lea	edx, [ebp+var_88]
		mov	[esp+0B8h+var_A4], edx ; int
		lea	edx, [ebp+Src]
		mov	[esp+0B8h+var_A8], edx ; int
		lea	edx, [ebp+var_5C]
		mov	[esp+0B8h+var_AC], edx ; int
		mov	edx, [ebp+arg_4]
		mov	[esp+0B8h+Size], edx ; int
		mov	[esp+0B8h+Buf2], eax ; size_t
		mov	eax, [ebp+var_18]
		mov	[esp+0B8h+Buf1], eax ; void *
		call	sub_404392
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jz	short loc_404DA9
		mov	eax, [ebp+var_38]
		jmp	loc_404F61
; ---------------------------------------------------------------------------

loc_404DA9:				; CODE XREF: sub_404830+56Fj
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+var_88]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+var_1C]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		add	eax, ecx
		lea	edx, [eax+2Dh]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_malloc
		mov	[ebp+Dst], eax
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+Dst]
		mov	[eax], edx
		cmp	[ebp+Dst], 0
		jnz	short loc_404E12
		call	sub_403CA7
		mov	[ebp+var_44], eax
		mov	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_free
		mov	eax, [ebp+var_44]
		jmp	loc_404F61
; ---------------------------------------------------------------------------

loc_404E12:				; CODE XREF: sub_404830+5C2j
		mov	edx, offset a21Protected ; "(21:protected-"
		mov	eax, [ebp+Dst]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		movzx	edx, word ptr [edx+0Ch]
		mov	[eax+0Ch], dx
		add	[ebp+Dst], 0Eh
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		sub	eax, 4
		mov	ecx, eax
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+4]
		mov	eax, [ebp+Dst]
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Buf2], edx ; Src
		mov	[esp+0B8h+Buf1], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+arg_0]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		sub	eax, 4
		add	[ebp+Dst], eax
		mov	ecx, [ebp+var_88]
		mov	eax, [ebp+Src]
		mov	edx, eax
		mov	eax, [ebp+Dst]
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Buf2], edx ; Src
		mov	[esp+0B8h+Buf1], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_88]
		add	[ebp+Dst], eax
		mov	eax, [ebp+Dst]
		lea	edx, [ebp+var_7F]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	ecx, [edx+10h]
		mov	[eax+10h], ecx
		mov	ecx, [edx+14h]
		mov	[eax+14h], ecx
		mov	ecx, [edx+18h]
		mov	[eax+18h], ecx
		mov	ecx, [edx+1Ch]
		mov	[eax+1Ch], ecx
		movzx	ecx, word ptr [edx+20h]
		mov	[eax+20h], cx
		movzx	edx, byte ptr [edx+22h]
		mov	[eax+22h], dl
		add	[ebp+Dst], 23h
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+var_1C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	ecx, eax
		mov	eax, [ebp+var_1C]
		lea	edx, [eax+1]
		mov	eax, [ebp+Dst]
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Buf2], edx ; Src
		mov	[esp+0B8h+Buf1], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+var_1C]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		add	[ebp+Dst], eax
		mov	edx, [ebp+Dst]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		cmp	edx, eax
		jz	short loc_404F4E
		mov	[esp+0B8h+Size], 22Bh ;	int
		mov	[esp+0B8h+Buf2], offset	a____Gnupg22__0	; "../../gnupg2-2.0.30/agent/protect.c"
		mov	[esp+0B8h+Buf1], offset	aPResultResultl	; "p - *result == *resultlen"
		call	sub_4276E0

loc_404F4E:				; CODE XREF: sub_404830+700j
		mov	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_free
		mov	eax, 0

loc_404F61:				; CODE XREF: sub_404830+6Fj
					; sub_404830+ACj ...
		add	esp, 0B4h
		pop	ebx
		pop	ebp
		retn
sub_404830	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404F6A	proc near		; CODE XREF: sub_4056C4+5B0p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[ebp+var_C], 0
		mov	[esp+48h+var_48], 7
		call	gcry_cipher_get_algo_blklen
		mov	[ebp+var_10], eax
		cmp	[ebp+arg_4], 3
		jbe	short loc_404F9F
		mov	ecx, [ebp+var_10]
		mov	eax, [ebp+arg_4]
		mov	edx, 0
		div	ecx
		mov	eax, edx
		test	eax, eax
		jz	short loc_404FB0

loc_404F9F:				; CODE XREF: sub_404F6A+20j
		mov	[esp+48h+var_48], 6Ah
		call	sub_403C77
		jmp	locret_405198
; ---------------------------------------------------------------------------

loc_404FB0:				; CODE XREF: sub_404F6A+33j
		mov	[esp+48h+var_3C], 1
		mov	[esp+48h+var_40], 3
		mov	[esp+48h+var_44], 7
		lea	eax, [ebp+var_24]
		mov	[esp+48h+var_48], eax
		call	gcry_cipher_open
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_404FE4
		mov	eax, [ebp+var_C]
		jmp	locret_405198
; ---------------------------------------------------------------------------

loc_404FE4:				; CODE XREF: sub_404F6A+70j
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	gcry_malloc_secure
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_405000
		call	sub_403CA7
		mov	[ebp+var_C], eax

loc_405000:				; CODE XREF: sub_404F6A+8Cj
		cmp	[ebp+var_C], 0
		jnz	short loc_405022
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+arg_18]
		mov	[esp+48h+var_40], edx
		mov	edx, [ebp+arg_14]
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	gcry_cipher_setiv
		mov	[ebp+var_C], eax

loc_405022:				; CODE XREF: sub_404F6A+9Aj
		cmp	[ebp+var_C], 0
		jnz	loc_4050B8
		mov	[ebp+var_18], 10h
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_malloc_secure
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_405051
		call	sub_403CA7
		mov	[ebp+var_C], eax
		jmp	short loc_4050B8
; ---------------------------------------------------------------------------

loc_405051:				; CODE XREF: sub_404F6A+DBj
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_30], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], 3
		mov	[esp+48h+var_44], 2
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_48], eax
		call	sub_405ECF
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4050AD
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_18]
		mov	[esp+48h+var_40], edx
		mov	edx, [ebp+var_1C]
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	gcry_cipher_setkey
		mov	[ebp+var_C], eax

loc_4050AD:				; CODE XREF: sub_404F6A+125j
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_free

loc_4050B8:				; CODE XREF: sub_404F6A+BCj
					; sub_404F6A+E5j
		cmp	[ebp+var_C], 0
		jnz	short loc_4050E8
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+arg_4]
		mov	[esp+48h+var_38], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+48h+var_3C], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+48h+var_40], edx
		mov	edx, [ebp+var_14]
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	gcry_cipher_decrypt
		mov	[ebp+var_C], eax

loc_4050E8:				; CODE XREF: sub_404F6A+152j
		mov	eax, [ebp+var_24]
		mov	[esp+48h+var_48], eax
		call	gcry_cipher_close
		cmp	[ebp+var_C], 0
		jz	short loc_40510C
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	locret_405198
; ---------------------------------------------------------------------------

loc_40510C:				; CODE XREF: sub_404F6A+18Dj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_40513C
		mov	eax, [ebp+var_14]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_40513C
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	[esp+48h+var_48], 0Bh
		call	sub_403C77
		jmp	short locret_405198
; ---------------------------------------------------------------------------

loc_40513C:				; CODE XREF: sub_404F6A+1AAj
					; sub_404F6A+1B7j
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_405172
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_20]
		cmp	eax, [ebp+arg_4]
		jnb	short loc_40518B

loc_405172:				; CODE XREF: sub_404F6A+1FBj
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	[esp+48h+var_48], 0Bh
		call	sub_403C77
		jmp	short locret_405198
; ---------------------------------------------------------------------------

loc_40518B:				; CODE XREF: sub_404F6A+206j
		mov	eax, [ebp+arg_1C]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, 0

locret_405198:				; CODE XREF: sub_404F6A+41j
					; sub_404F6A+75j ...
		leave
		retn
sub_404F6A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40519A	proc near		; CODE XREF: sub_4056C4+606p

Dst		= dword	ptr -58h
Src		= dword	ptr -54h
Size		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_18]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_1C]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_4], 19h
		ja	short loc_4051DB
		mov	[esp+58h+Dst], 3Bh
		call	sub_403C77
		jmp	locret_4056C2
; ---------------------------------------------------------------------------

loc_4051DB:				; CODE XREF: sub_40519A+2Ej
		mov	[esp+58h+var_4C], 0
		mov	[esp+58h+Size],	0
		mov	[esp+58h+Src], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Dst], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_405218
		mov	[esp+58h+Dst], 3Bh
		call	sub_403C77
		jmp	locret_4056C2
; ---------------------------------------------------------------------------

loc_405218:				; CODE XREF: sub_40519A+6Bj
		mov	[esp+58h+var_4C], 0
		mov	[esp+58h+Size],	0
		mov	[esp+58h+Src], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+Dst], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_405255
		mov	[esp+58h+Dst], 3Bh
		call	sub_403C77
		jmp	locret_4056C2
; ---------------------------------------------------------------------------

loc_405255:				; CODE XREF: sub_40519A+A8j
		mov	eax, [ebp+var_24]
		add	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Dst], eax
		call	gcry_malloc_secure
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_405279
		call	sub_403CA7
		jmp	locret_4056C2
; ---------------------------------------------------------------------------

loc_405279:				; CODE XREF: sub_40519A+D3j
		mov	edx, offset a11PrivateKey ; "(11:private-key"
		mov	eax, [ebp+var_28]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	edx, [edx+0Ch]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_28]
		add	eax, 0Fh
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+arg_4]
		lea	ecx, [eax-19h]
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+19h]
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Size],	ecx ; Size
		mov	[esp+58h+Src], edx ; Src
		mov	[esp+58h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_4]
		sub	eax, 19h
		add	[ebp+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_4052F6
		mov	eax, [ebp+var_3C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_4052F6
		mov	[esp+58h+Dst], 3Bh
		call	sub_403C77
		jmp	locret_4056C2
; ---------------------------------------------------------------------------

loc_4052F6:				; CODE XREF: sub_40519A+13Cj
					; sub_40519A+149j
		mov	eax, [ebp+var_3C]
		add	eax, 2
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_30], eax
		jmp	short loc_405369
; ---------------------------------------------------------------------------

loc_405307:				; CODE XREF: sub_40519A+1D7j
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax
		call	sub_403CB4
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	loc_405670
		mov	eax, [ebp+var_3C]
		add	eax, [ebp+var_24]
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax
		call	sub_403CB4
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	loc_405673
		mov	eax, [ebp+var_3C]
		add	eax, [ebp+var_24]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jnz	loc_405676
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax

loc_405369:				; CODE XREF: sub_40519A+16Bj
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_405307
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jnz	loc_405679
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jnz	loc_40567C
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax
		call	sub_403CB4
		mov	[ebp+var_24], eax
		mov	[esp+58h+Size],	offset aHash ; "hash"
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Src], eax ; int
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax ; int
		call	sub_403DE3
		test	eax, eax
		jz	loc_40567F
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax
		call	sub_403CB4
		mov	[ebp+var_24], eax
		mov	[esp+58h+Size],	offset aSha1 ; "sha1"
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Src], eax ; int
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax ; int
		call	sub_403DE3
		test	eax, eax
		jz	loc_405682
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax
		call	sub_403CB4
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 14h
		jnz	loc_405685
		mov	eax, [ebp+var_3C]
		mov	edx, eax
		mov	eax, [ebp+arg_C]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	edx, [edx+10h]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_3C]
		add	eax, [ebp+var_24]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jnz	loc_405688
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_30]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	ecx, eax
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Size],	ecx ; Size
		mov	[esp+58h+Src], edx ; Src
		mov	[esp+58h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_30]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+var_2C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_4054BE
		mov	[esp+58h+Size],	2DCh ; int
		mov	[esp+58h+Src], offset a____Gnupg22__0 ;	"../../gnupg2-2.0.30/agent/protect.c"
		mov	[esp+58h+Dst], offset aS ; "*s == '('"
		call	sub_4276E0

loc_4054BE:				; CODE XREF: sub_40519A+306j
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		mov	[ebp+var_40], 1
		lea	eax, [ebp+var_40]
		mov	[esp+58h+Src], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax
		call	sub_403D3D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_405637
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jnz	short loc_405573
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax
		call	sub_403CB4
		mov	[ebp+var_24], eax
		mov	[esp+58h+Size],	offset aProtectedAt ; "protected-at"
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Src], eax ; int
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax ; int
		call	sub_403DE3
		test	eax, eax
		jz	short loc_40556D
		mov	[ebp+var_40], 1
		lea	eax, [ebp+var_40]
		mov	[esp+58h+Src], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax
		call	sub_403D3D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_40563A
		mov	eax, [ebp+var_3C]
		mov	edx, eax
		mov	eax, [ebp+var_38]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_40556D:				; CODE XREF: sub_40519A+396j
		mov	eax, [ebp+var_38]
		mov	[ebp+var_3C], eax

loc_405573:				; CODE XREF: sub_40519A+35Bj
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_30], eax
		mov	[ebp+var_40], 2
		lea	eax, [ebp+var_40]
		mov	[esp+58h+Src], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Dst], eax
		call	sub_403D3D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_40563D
		mov	eax, [ebp+var_3C]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jz	short loc_4055C8
		mov	[esp+58h+Size],	2F7h ; int
		mov	[esp+58h+Src], offset a____Gnupg22__0 ;	"../../gnupg2-2.0.30/agent/protect.c"
		mov	[esp+58h+Dst], offset aS1 ; "s[-1] == ')'"
		call	sub_4276E0

loc_4055C8:				; CODE XREF: sub_40519A+410j
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4055EA
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+arg_18]
		mov	[eax], edx

loc_4055EA:				; CODE XREF: sub_40519A+43Bj
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_30]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	ecx, eax
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Size],	ecx ; Size
		mov	[esp+58h+Src], edx ; Src
		mov	[esp+58h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_30]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+var_2C], eax
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_28]
		mov	[eax], edx
		mov	eax, [ebp+arg_14]
		mov	edx, [ebp+var_20]
		mov	[eax], edx
		mov	eax, 0
		jmp	locret_4056C2
; ---------------------------------------------------------------------------

loc_405637:				; CODE XREF: sub_40519A+34Dj
		nop
		jmp	short loc_40563E
; ---------------------------------------------------------------------------

loc_40563A:				; CODE XREF: sub_40519A+3B8j
		nop
		jmp	short loc_40563E
; ---------------------------------------------------------------------------

loc_40563D:				; CODE XREF: sub_40519A+3FFj
		nop

loc_40563E:				; CODE XREF: sub_40519A+49Ej
					; sub_40519A+4A1j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_14], eax
		jmp	short loc_40565A
; ---------------------------------------------------------------------------

loc_40564C:				; CODE XREF: sub_40519A+4C4j
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1
		sub	[ebp+var_14], 1

loc_40565A:				; CODE XREF: sub_40519A+4B0j
		cmp	[ebp+var_14], 0
		jnz	short loc_40564C
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	short locret_4056C2
; ---------------------------------------------------------------------------

loc_405670:				; CODE XREF: sub_40519A+188j
		nop
		jmp	short loc_405689
; ---------------------------------------------------------------------------

loc_405673:				; CODE XREF: sub_40519A+1A9j
		nop
		jmp	short loc_405689
; ---------------------------------------------------------------------------

loc_405676:				; CODE XREF: sub_40519A+1C0j
		nop
		jmp	short loc_405689
; ---------------------------------------------------------------------------

loc_405679:				; CODE XREF: sub_40519A+1E1j
		nop
		jmp	short loc_405689
; ---------------------------------------------------------------------------

loc_40567C:				; CODE XREF: sub_40519A+1FEj
		nop
		jmp	short loc_405689
; ---------------------------------------------------------------------------

loc_40567F:				; CODE XREF: sub_40519A+237j
		nop
		jmp	short loc_405689
; ---------------------------------------------------------------------------

loc_405682:				; CODE XREF: sub_40519A+267j
		nop
		jmp	short loc_405689
; ---------------------------------------------------------------------------

loc_405685:				; CODE XREF: sub_40519A+27Fj
		nop
		jmp	short loc_405689
; ---------------------------------------------------------------------------

loc_405688:				; CODE XREF: sub_40519A+2BAj
		nop

loc_405689:				; CODE XREF: sub_40519A+4D7j
					; sub_40519A+4DAj ...
		mov	eax, [ebp+var_28]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_1C], eax
		jmp	short loc_4056A5
; ---------------------------------------------------------------------------

loc_405697:				; CODE XREF: sub_40519A+50Fj
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	0
		add	[ebp+var_18], 1
		sub	[ebp+var_1C], 1

loc_4056A5:				; CODE XREF: sub_40519A+4FBj
		cmp	[ebp+var_1C], 0
		jnz	short loc_405697
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Dst], eax
		call	gcry_free
		mov	[esp+58h+Dst], 53h
		call	sub_403C77

locret_4056C2:				; CODE XREF: sub_40519A+3Cj
					; sub_40519A+79j ...
		leave
		retn
sub_40519A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4056C4	proc near		; CODE XREF: sub_401BD6+50p
					; sub_402D35+14Ep

Str		= dword	ptr -0A8h
EndPtr		= dword	ptr -0A4h
Radix		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
Buf2		= byte ptr -68h
Buf1		= byte ptr -54h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0A4h
		mov	[ebp+var_6C], 0
		cmp	[ebp+arg_8], 0
		jz	short loc_4056E1
		mov	eax, [ebp+arg_8]
		mov	byte ptr [eax],	0

loc_4056E1:				; CODE XREF: sub_4056C4+15j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_405702
		mov	[esp+0A8h+Str],	53h
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_405702:				; CODE XREF: sub_4056C4+2Bj
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_403CB4
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_405730
		mov	[esp+0A8h+Str],	53h
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_405730:				; CODE XREF: sub_4056C4+59j
		mov	[esp+0A8h+Radix], offset aProtectedPriva ; "protected-private-key"
		mov	eax, [ebp+var_28]
		mov	[esp+0A8h+EndPtr], eax ; int
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax ; int
		call	sub_403DE3
		test	eax, eax
		jnz	short loc_40575F
		mov	[esp+0A8h+Str],	68h
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_40575F:				; CODE XREF: sub_4056C4+88j
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_40577A
		mov	[esp+0A8h+Str],	68h
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_40577A:				; CODE XREF: sub_4056C4+A3j
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_403CB4
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_4057A8
		mov	[esp+0A8h+Str],	53h
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_4057A8:				; CODE XREF: sub_4056C4+D1j
		mov	[ebp+var_10], 0
		jmp	short loc_4057B5
; ---------------------------------------------------------------------------

loc_4057B1:				; CODE XREF: sub_4056C4+135j
		add	[ebp+var_10], 1

loc_4057B5:				; CODE XREF: sub_4056C4+EBj
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_429180
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4057FB
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_429180
		mov	eax, [eax]
		mov	[esp+0A8h+Radix], eax ;	void *
		mov	eax, [ebp+var_28]
		mov	[esp+0A8h+EndPtr], eax ; int
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax ; int
		call	sub_403DE3
		test	eax, eax
		jz	short loc_4057B1

loc_4057FB:				; CODE XREF: sub_4056C4+107j
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_429180
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_405824
		mov	[esp+0A8h+Str],	54h
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_405824:				; CODE XREF: sub_4056C4+14Dj
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_2C], eax
		cmp	[ebp+arg_8], 0
		jz	loc_40593A
		jmp	loc_40592C
; ---------------------------------------------------------------------------

loc_405839:				; CODE XREF: sub_4056C4+270j
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_403CB4
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_40586D
		mov	[esp+0A8h+Str],	53h
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_40586D:				; CODE XREF: sub_4056C4+196j
		mov	[esp+0A8h+Radix], offset aProtectedAt ;	"protected-at"
		mov	eax, [ebp+var_28]
		mov	[esp+0A8h+EndPtr], eax ; int
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax ; int
		call	sub_403DE3
		test	eax, eax
		jz	short loc_4058F9
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_403CB4
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_4058B0
		mov	[esp+0A8h+Str],	53h
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_4058B0:				; CODE XREF: sub_4056C4+1D9j
		cmp	[ebp+var_28], 0Fh
		jz	short loc_4058C7
		mov	[esp+0A8h+Str],	68h
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_4058C7:				; CODE XREF: sub_4056C4+1F0j
		mov	eax, [ebp+var_3C]
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		movzx	ecx, word ptr [edx+0Ch]
		mov	[eax+0Ch], cx
		movzx	edx, byte ptr [edx+0Eh]
		mov	[eax+0Eh], dl
		mov	eax, [ebp+arg_8]
		add	eax, 0Fh
		mov	byte ptr [eax],	0
		jmp	short loc_40593A
; ---------------------------------------------------------------------------

loc_4058F9:				; CODE XREF: sub_4056C4+1C5j
		mov	eax, [ebp+var_3C]
		add	eax, [ebp+var_28]
		mov	[ebp+var_3C], eax
		mov	[ebp+var_40], 1
		lea	eax, [ebp+var_40]
		mov	[esp+0A8h+EndPtr], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_403D3D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40592C
		mov	eax, [ebp+var_C]
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_40592C:				; CODE XREF: sub_4056C4+170j
					; sub_4056C4+25Ej
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	loc_405839

loc_40593A:				; CODE XREF: sub_4056C4+16Aj
					; sub_4056C4+233j
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_3C], eax
		jmp	short loc_405943
; ---------------------------------------------------------------------------

loc_405942:				; CODE XREF: sub_4056C4+315j
		nop

loc_405943:				; CODE XREF: sub_4056C4+27Cj
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_40595E
		mov	[esp+0A8h+Str],	53h
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_40595E:				; CODE XREF: sub_4056C4+287j
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_403CB4
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_405992
		mov	[esp+0A8h+Str],	53h
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_405992:				; CODE XREF: sub_4056C4+2BBj
		mov	[esp+0A8h+Radix], offset aProtected ; "protected"
		mov	eax, [ebp+var_28]
		mov	[esp+0A8h+EndPtr], eax ; int
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax ; int
		call	sub_403DE3
		test	eax, eax
		jnz	short loc_4059E7
		mov	eax, [ebp+var_3C]
		add	eax, [ebp+var_28]
		mov	[ebp+var_3C], eax
		mov	[ebp+var_40], 1
		lea	eax, [ebp+var_40]
		mov	[esp+0A8h+EndPtr], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_403D3D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_405942
		mov	eax, [ebp+var_C]
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_4059E7:				; CODE XREF: sub_4056C4+2EAj
		nop
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_403CB4
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_405A0D
		mov	[esp+0A8h+Str],	53h
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_405A0D:				; CODE XREF: sub_4056C4+336j
		mov	[esp+0A8h+Radix], offset aOpenpgpS2k3Sha ; "openpgp-s2k3-sha1-aes-cbc"
		mov	eax, [ebp+var_28]
		mov	[esp+0A8h+EndPtr], eax ; int
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax ; int
		call	sub_403DE3
		test	eax, eax
		jnz	short loc_405A3C
		mov	[esp+0A8h+Str],	69h
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_405A3C:				; CODE XREF: sub_4056C4+365j
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jnz	short loc_405A53
		mov	eax, [ebp+var_3C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_405A64

loc_405A53:				; CODE XREF: sub_4056C4+380j
		mov	[esp+0A8h+Str],	53h
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_405A64:				; CODE XREF: sub_4056C4+38Dj
		mov	eax, [ebp+var_3C]
		add	eax, 2
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_403CB4
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_405A92
		mov	[esp+0A8h+Str],	53h
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_405A92:				; CODE XREF: sub_4056C4+3BBj
		mov	[esp+0A8h+Radix], offset aSha1 ; "sha1"
		mov	eax, [ebp+var_28]
		mov	[esp+0A8h+EndPtr], eax ; int
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax ; int
		call	sub_403DE3
		test	eax, eax
		jnz	short loc_405AC1
		mov	[esp+0A8h+Str],	69h
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_405AC1:				; CODE XREF: sub_4056C4+3EAj
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_403CB4
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 8
		jz	short loc_405AE6
		mov	[esp+0A8h+Str],	6Ah
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_405AE6:				; CODE XREF: sub_4056C4+40Fj
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_3C]
		add	eax, [ebp+var_28]
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_403CB4
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_405B1A
		mov	[esp+0A8h+Str],	6Ah
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_405B1A:				; CODE XREF: sub_4056C4+443j
		mov	eax, [ebp+var_3C]
		add	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jz	short loc_405B38
		mov	[esp+0A8h+Str],	53h
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_405B38:				; CODE XREF: sub_4056C4+461j
		mov	eax, [ebp+var_3C]
		mov	[esp+0A8h+Radix], 0Ah ;	Radix
		mov	[esp+0A8h+EndPtr], 0 ; EndPtr
		mov	[esp+0A8h+Str],	eax ; Str
		call	strtoul
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_405B6D
		mov	[esp+0A8h+Str],	6Ah
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_405B6D:				; CODE XREF: sub_4056C4+496j
		cmp	[ebp+var_14], 0FFh
		ja	short loc_405B93
		mov	eax, [ebp+var_14]
		and	eax, 0Fh
		lea	edx, [eax+10h]
		mov	eax, [ebp+var_14]
		shr	eax, 4
		add	eax, 6
		mov	ebx, edx
		mov	ecx, eax
		shl	ebx, cl
		mov	eax, ebx
		mov	[ebp+var_14], eax

loc_405B93:				; CODE XREF: sub_4056C4+4B0j
		cmp	[ebp+var_14], 0FFFFh
		ja	short loc_405BAD
		mov	[esp+0A8h+Str],	6Ah
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_405BAD:				; CODE XREF: sub_4056C4+4D6j
		mov	eax, [ebp+var_3C]
		add	eax, [ebp+var_28]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_403CB4
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 10h
		jz	short loc_405BE4
		mov	[esp+0A8h+Str],	6Ah
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_405BE4:				; CODE XREF: sub_4056C4+50Dj
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_3C]
		add	eax, [ebp+var_28]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jz	short loc_405C0E
		mov	[esp+0A8h+Str],	53h
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_405C0E:				; CODE XREF: sub_4056C4+537j
		mov	eax, [ebp+var_3C]
		add	eax, 1
		mov	[ebp+var_3C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Str],	eax
		call	sub_403CB4
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_405C3C
		mov	[esp+0A8h+Str],	53h
		call	sub_403C77
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_405C3C:				; CODE XREF: sub_4056C4+565j
		mov	eax, [ebp+var_3C]
		lea	edx, [ebp+var_6C]
		mov	[esp+0A8h+var_8C], edx
		mov	[esp+0A8h+var_90], 10h
		mov	edx, [ebp+var_38]
		mov	[esp+0A8h+var_94], edx
		mov	edx, [ebp+var_14]
		mov	[esp+0A8h+var_98], edx
		mov	edx, [ebp+var_34]
		mov	[esp+0A8h+var_9C], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+0A8h+Radix], edx
		mov	edx, [ebp+var_28]
		mov	[esp+0A8h+EndPtr], edx
		mov	[esp+0A8h+Str],	eax
		call	sub_404F6A
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_405C8A
		mov	eax, [ebp+var_C]
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_405C8A:				; CODE XREF: sub_4056C4+5BCj
		mov	edx, [ebp+var_6C]
		mov	ecx, [ebp+var_30]
		mov	eax, [ebp+arg_0]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		lea	ecx, [ebp+var_7C]
		mov	[esp+0A8h+var_8C], ecx
		lea	ecx, [ebp+var_78]
		mov	[esp+0A8h+var_90], ecx
		lea	ecx, [ebp+var_74]
		mov	[esp+0A8h+var_94], ecx
		lea	ecx, [ebp+var_70]
		mov	[esp+0A8h+var_98], ecx
		lea	ecx, [ebp+Buf1]
		mov	[esp+0A8h+var_9C], ecx
		mov	[esp+0A8h+Radix], edx
		mov	[esp+0A8h+EndPtr], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+Str],	eax
		call	sub_40519A
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_6C]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_1C], eax
		jmp	short loc_405CEE
; ---------------------------------------------------------------------------

loc_405CE0:				; CODE XREF: sub_4056C4+62Ej
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	0
		add	[ebp+var_18], 1
		sub	[ebp+var_1C], 1

loc_405CEE:				; CODE XREF: sub_4056C4+61Aj
		cmp	[ebp+var_1C], 0
		jnz	short loc_405CE0
		mov	eax, [ebp+var_6C]
		mov	[esp+0A8h+Str],	eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_405D0D
		mov	eax, [ebp+var_C]
		jmp	loc_405E0C
; ---------------------------------------------------------------------------

loc_405D0D:				; CODE XREF: sub_4056C4+63Fj
		mov	eax, [ebp+var_70]
		lea	edx, [ebp+Buf2]
		mov	[esp+0A8h+EndPtr], edx
		mov	[esp+0A8h+Str],	eax
		call	sub_4041C5
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_405D55
		mov	[esp+0A8h+Radix], 14h ;	Size
		lea	eax, [ebp+Buf2]
		mov	[esp+0A8h+EndPtr], eax ; Buf2
		lea	eax, [ebp+Buf1]
		mov	[esp+0A8h+Str],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_405D55
		mov	[esp+0A8h+Str],	6Ah
		call	sub_403C77
		mov	[ebp+var_C], eax

loc_405D55:				; CODE XREF: sub_4056C4+662j
					; sub_4056C4+680j
		cmp	[ebp+var_C], 0
		jz	short loc_405D8D
		mov	eax, [ebp+var_70]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_74]
		mov	[ebp+var_24], eax
		jmp	short loc_405D77
; ---------------------------------------------------------------------------

loc_405D69:				; CODE XREF: sub_4056C4+6B7j
		mov	eax, [ebp+var_20]
		mov	byte ptr [eax],	0
		add	[ebp+var_20], 1
		sub	[ebp+var_24], 1

loc_405D77:				; CODE XREF: sub_4056C4+6A3j
		cmp	[ebp+var_24], 0
		jnz	short loc_405D69
		mov	eax, [ebp+var_70]
		mov	[esp+0A8h+Str],	eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	short loc_405E0C
; ---------------------------------------------------------------------------

loc_405D8D:				; CODE XREF: sub_4056C4+695j
		mov	eax, [ebp+var_7C]
		test	eax, eax
		jz	short loc_405DD7
		mov	edx, [ebp+var_74]
		mov	eax, [ebp+var_78]
		sub	edx, eax
		mov	eax, [ebp+var_7C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_70]
		mov	ebx, [ebp+var_78]
		mov	edx, [ebp+var_7C]
		add	edx, ebx
		add	edx, eax
		mov	ebx, [ebp+var_70]
		mov	eax, [ebp+var_78]
		add	eax, ebx
		mov	[esp+0A8h+Radix], ecx ;	Size
		mov	[esp+0A8h+EndPtr], edx ; Src
		mov	[esp+0A8h+Str],	eax ; Dst
		call	memmove
		mov	edx, [ebp+var_74]
		mov	eax, [ebp+var_7C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_74], eax

loc_405DD7:				; CODE XREF: sub_4056C4+6CEj
		mov	edx, [ebp+var_70]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+var_70]
		mov	[esp+0A8h+var_9C], 0
		mov	[esp+0A8h+Radix], 0
		mov	[esp+0A8h+EndPtr], 0
		mov	[esp+0A8h+Str],	eax
		call	gcry_sexp_canon_len
		mov	edx, [ebp+arg_10]
		mov	[edx], eax
		mov	eax, 0

loc_405E0C:				; CODE XREF: sub_4056C4+39j
					; sub_4056C4+67j ...
		add	esp, 0A4h
		pop	ebx
		pop	ebp
		retn
sub_4056C4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405E15	proc near		; CODE XREF: sub_402D35+104p
					; sub_402D35+1E1p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_405E35
		mov	eax, 0
		jmp	locret_405ECD
; ---------------------------------------------------------------------------

loc_405E35:				; CODE XREF: sub_405E15+14j
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[ebp+var_10], eax
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_403CB4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_405E59
		mov	eax, 0
		jmp	short locret_405ECD
; ---------------------------------------------------------------------------

loc_405E59:				; CODE XREF: sub_405E15+3Bj
		mov	[esp+28h+var_20], offset aProtectedPriva ; "protected-private-key"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_24], eax ;	int
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_403DE3
		test	eax, eax
		jz	short loc_405E7E
		mov	eax, 2
		jmp	short locret_405ECD
; ---------------------------------------------------------------------------

loc_405E7E:				; CODE XREF: sub_405E15+60j
		mov	[esp+28h+var_20], offset aShadowedPrivat ; "shadowed-private-key"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_24], eax ;	int
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_403DE3
		test	eax, eax
		jz	short loc_405EA3
		mov	eax, 3
		jmp	short locret_405ECD
; ---------------------------------------------------------------------------

loc_405EA3:				; CODE XREF: sub_405E15+85j
		mov	[esp+28h+var_20], offset aPrivateKey_0 ; "private-key"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_24], eax ;	int
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_403DE3
		test	eax, eax
		jz	short loc_405EC8
		mov	eax, 1
		jmp	short locret_405ECD
; ---------------------------------------------------------------------------

loc_405EC8:				; CODE XREF: sub_405E15+AAj
		mov	eax, 0

locret_405ECD:				; CODE XREF: sub_405E15+1Bj
					; sub_405E15+42j ...
		leave
		retn
sub_405E15	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405ECF	proc near		; CODE XREF: sub_40402A+46p
					; sub_404392+17Ap ...

Dst		= dword	ptr -58h
Src		= dword	ptr -54h
Size		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_1C], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_405F12
		cmp	[ebp+arg_8], 1
		jz	short loc_405F12
		cmp	[ebp+arg_8], 3
		jnz	short loc_405F2A

loc_405F12:				; CODE XREF: sub_405ECF+35j
					; sub_405ECF+3Bj
		cmp	[ebp+arg_4], 0
		jz	short loc_405F2A
		cmp	[ebp+arg_18], 0
		jz	short loc_405F2A
		cmp	[ebp+arg_14], 0
		jz	short loc_405F2A
		cmp	[ebp+arg_0], 0
		jnz	short loc_405F3B

loc_405F2A:				; CODE XREF: sub_405ECF+41j
					; sub_405ECF+47j ...
		mov	[esp+58h+Dst], 37h
		call	sub_403C77
		jmp	loc_40619F
; ---------------------------------------------------------------------------

loc_405F3B:				; CODE XREF: sub_405ECF+59j
		cmp	[ebp+arg_8], 1
		jz	short loc_405F47
		cmp	[ebp+arg_8], 3
		jnz	short loc_405F5E

loc_405F47:				; CODE XREF: sub_405ECF+70j
		cmp	[ebp+arg_C], 0
		jnz	short loc_405F5E
		mov	[esp+58h+Dst], 37h
		call	sub_403C77
		jmp	loc_40619F
; ---------------------------------------------------------------------------

loc_405F5E:				; CODE XREF: sub_405ECF+76j
					; sub_405ECF+7Cj
		mov	[esp+58h+Size],	1
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Src], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+Dst], eax
		call	gcry_md_open
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_405F89
		mov	eax, [ebp+var_20]
		jmp	loc_40619F
; ---------------------------------------------------------------------------

loc_405F89:				; CODE XREF: sub_405ECF+B0j
		mov	[ebp+var_C], 0
		jmp	loc_406183
; ---------------------------------------------------------------------------

loc_405F95:				; CODE XREF: sub_405ECF+2BAj
		cmp	[ebp+var_C], 0
		jz	short loc_406003
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Dst], eax
		call	gcry_md_reset
		mov	[ebp+var_10], 0
		jmp	short loc_405FFB
; ---------------------------------------------------------------------------

loc_405FAF:				; CODE XREF: sub_405ECF+132j
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_24]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_405FE0
		mov	[esp+58h+Size],	0
		mov	[esp+58h+Src], 0
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Dst], eax
		call	gcry_md_write

loc_405FE0:				; CODE XREF: sub_405ECF+F4j
		mov	eax, [ebp+var_24]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_24]
		mov	byte ptr [edx+eax+0Ch],	0
		lea	edx, [eax+1]
		mov	eax, [ebp+var_24]
		mov	[eax+4], edx
		add	[ebp+var_10], 1

loc_405FFB:				; CODE XREF: sub_405ECF+DEj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_C]
		jl	short loc_405FAF

loc_406003:				; CODE XREF: sub_405ECF+CAj
		cmp	[ebp+arg_8], 1
		jz	short loc_406013
		cmp	[ebp+arg_8], 3
		jnz	loc_4060DC

loc_406013:				; CODE XREF: sub_405ECF+138j
		mov	eax, [ebp+var_1C]
		add	eax, 8
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_18], eax
		cmp	[ebp+arg_8], 3
		jnz	short loc_406079
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_28]
		cmp	eax, [ebp+var_18]
		jbe	short loc_406079
		mov	eax, [ebp+var_28]
		mov	[ebp+var_18], eax
		jmp	short loc_406079
; ---------------------------------------------------------------------------

loc_40603E:				; CODE XREF: sub_405ECF+1B1j
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Size],	8
		mov	edx, [ebp+arg_C]
		mov	[esp+58h+Src], edx
		mov	[esp+58h+Dst], eax
		call	gcry_md_write
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Size],	edx
		mov	edx, [ebp+arg_0]
		mov	[esp+58h+Src], edx
		mov	[esp+58h+Dst], eax
		call	gcry_md_write
		mov	eax, [ebp+var_28]
		sub	[ebp+var_18], eax
		jmp	short loc_40607A
; ---------------------------------------------------------------------------

loc_406079:				; CODE XREF: sub_405ECF+157j
					; sub_405ECF+165j ...
		nop

loc_40607A:				; CODE XREF: sub_405ECF+1A8j
		mov	eax, [ebp+var_28]
		cmp	eax, [ebp+var_18]
		jb	short loc_40603E
		cmp	[ebp+var_18], 7
		ja	short loc_4060A3
		mov	eax, [ebp+var_2C]
		mov	edx, [ebp+var_18]
		mov	[esp+58h+Size],	edx
		mov	edx, [ebp+arg_C]
		mov	[esp+58h+Src], edx
		mov	[esp+58h+Dst], eax
		call	gcry_md_write
		jmp	short loc_4060F5
; ---------------------------------------------------------------------------

loc_4060A3:				; CODE XREF: sub_405ECF+1B7j
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Size],	8
		mov	edx, [ebp+arg_C]
		mov	[esp+58h+Src], edx
		mov	[esp+58h+Dst], eax
		call	gcry_md_write
		sub	[ebp+var_18], 8
		mov	eax, [ebp+var_2C]
		mov	edx, [ebp+var_18]
		mov	[esp+58h+Size],	edx
		mov	edx, [ebp+arg_0]
		mov	[esp+58h+Src], edx
		mov	[esp+58h+Dst], eax
		call	gcry_md_write
		jmp	short loc_4060F5
; ---------------------------------------------------------------------------

loc_4060DC:				; CODE XREF: sub_405ECF+13Ej
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Size],	edx
		mov	edx, [ebp+arg_0]
		mov	[esp+58h+Src], edx
		mov	[esp+58h+Dst], eax
		call	gcry_md_write

loc_4060F5:				; CODE XREF: sub_405ECF+1D2j
					; sub_405ECF+20Bj
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_4C], 0
		mov	[esp+58h+Size],	0
		mov	[esp+58h+Src], 5
		mov	[esp+58h+Dst], eax
		call	gcry_md_ctl
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Dst], eax
		call	gcry_md_get_algo_dlen
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		mov	ecx, [ebp+arg_18]
		mov	ebx, ecx
		sub	ebx, edx
		mov	edx, ebx
		cmp	eax, edx
		jbe	short loc_406148
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_18]
		mov	edi, edx
		sub	edi, eax
		mov	eax, edi
		mov	[ebp+var_10], eax

loc_406148:				; CODE XREF: sub_405ECF+268j
		mov	ebx, [ebp+var_10]
		mov	eax, [ebp+var_2C]
		mov	edx, [ebp+arg_4]
		mov	[esp+58h+Src], edx
		mov	[esp+58h+Dst], eax
		call	gcry_md_read
		mov	edx, eax
		mov	ecx, [ebp+arg_14]
		mov	eax, [ebp+var_14]
		add	eax, ecx
		mov	ecx, ebx
		mov	[esp+58h+Size],	ecx ; Size
		mov	[esp+58h+Src], edx ; Src
		mov	[esp+58h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_10]
		add	[ebp+var_14], eax
		add	[ebp+var_C], 1

loc_406183:				; CODE XREF: sub_405ECF+C1j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_18]
		jb	loc_405F95
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Dst], eax
		call	gcry_md_close
		mov	eax, 0

loc_40619F:				; CODE XREF: sub_405ECF+67j
					; sub_405ECF+8Aj ...
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_405ECF	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-14h], 0
		jmp	short loc_4061C4
; ---------------------------------------------------------------------------

loc_4061BC:				; CODE XREF: .text:004061D9j
		add	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-0Ch], 2

loc_4061C4:				; CODE XREF: .text:004061BAj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4061DB
		mov	eax, [ebp-0Ch]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4061BC

loc_4061DB:				; CODE XREF: .text:004061CCj
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-3Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-3Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp-14h]
		add	eax, 2Bh
		mov	[esp], eax
		call	gcry_malloc
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_406221
		mov	eax, 0
		jmp	loc_406397
; ---------------------------------------------------------------------------

loc_406221:				; CODE XREF: .text:00406215j
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	28h
		add	dword ptr [ebp-10h], 1
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp-14h]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 14h
		lea	eax, [ebp-2Ch]
		mov	[esp], eax
		call	sub_403E54
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_421FFD
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	loc_406304
; ---------------------------------------------------------------------------

loc_40626A:				; CODE XREF: .text:00406319j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_406287
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_4062B3
; ---------------------------------------------------------------------------

loc_406287:				; CODE XREF: .text:00406272j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4062A2
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_4062B1
; ---------------------------------------------------------------------------

loc_4062A2:				; CODE XREF: .text:0040628Fj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_4062B1:				; CODE XREF: .text:004062A0j
		mov	edx, eax

loc_4062B3:				; CODE XREF: .text:00406285j
		mov	eax, [ebp-0Ch]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4062CE
		mov	eax, [ebp-0Ch]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_4062F5
; ---------------------------------------------------------------------------

loc_4062CE:				; CODE XREF: .text:004062BEj
		mov	eax, [ebp-0Ch]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4062E9
		mov	eax, [ebp-0Ch]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_4062F5
; ---------------------------------------------------------------------------

loc_4062E9:				; CODE XREF: .text:004062D9j
		mov	eax, [ebp-0Ch]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_4062F5:				; CODE XREF: .text:004062CCj
					; .text:004062E7j
		add	edx, eax
		mov	eax, [ebp-10h]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		add	dword ptr [ebp-0Ch], 2

loc_406304:				; CODE XREF: .text:00406265j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40631F
		mov	eax, [ebp-0Ch]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_40626A

loc_40631F:				; CODE XREF: .text:0040630Cj
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-3Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-3Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	dword ptr [esp+0Ch], 0
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 14h
		lea	eax, [ebp-2Ch]
		mov	[esp], eax
		call	sub_403E54
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_421FFD
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_421FFD
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	29h
		add	dword ptr [ebp-10h], 1
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-18h]

loc_406397:				; CODE XREF: .text:0040621Cj
		add	esp, 54h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40639D(int, void *, int)
sub_40639D	proc near		; CODE XREF: sub_401D61+53p

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_C], 0
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+Size],	0
		mov	[esp+38h+Src], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dst], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_10], eax
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+Size],	0
		mov	[esp+38h+Src], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Dst], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_14], eax
		cmp	[ebp+var_10], 0
		jz	short loc_406402
		cmp	[ebp+var_14], 0
		jnz	short loc_406413

loc_406402:				; CODE XREF: sub_40639D+5Dj
		mov	[esp+38h+Dst], 37h
		call	sub_403C77
		jmp	locret_40671A
; ---------------------------------------------------------------------------

loc_406413:				; CODE XREF: sub_40639D+63j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_406434
		mov	[esp+38h+Dst], 53h
		call	sub_403C77
		jmp	locret_40671A
; ---------------------------------------------------------------------------

loc_406434:				; CODE XREF: sub_40639D+84j
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_24]
		add	eax, 1
		mov	[ebp+var_24], eax
		lea	eax, [ebp+var_24]
		mov	[esp+38h+Dst], eax
		call	sub_403CB4
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_406466
		mov	[esp+38h+Dst], 53h
		call	sub_403C77
		jmp	locret_40671A
; ---------------------------------------------------------------------------

loc_406466:				; CODE XREF: sub_40639D+B6j
		mov	[esp+38h+Size],	offset aPublicKey ; "public-key"
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Src], eax ; int
		lea	eax, [ebp+var_24]
		mov	[esp+38h+Dst], eax ; int
		call	sub_403DE3
		test	eax, eax
		jnz	short loc_406495
		mov	[esp+38h+Dst], 68h
		call	sub_403C77
		jmp	locret_40671A
; ---------------------------------------------------------------------------

loc_406495:				; CODE XREF: sub_40639D+E5j
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_4064B0
		mov	[esp+38h+Dst], 68h
		call	sub_403C77
		jmp	locret_40671A
; ---------------------------------------------------------------------------

loc_4064B0:				; CODE XREF: sub_40639D+100j
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_24]
		add	eax, 1
		mov	[ebp+var_24], eax
		lea	eax, [ebp+var_24]
		mov	[esp+38h+Dst], eax
		call	sub_403CB4
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_4064E2
		mov	[esp+38h+Dst], 53h
		call	sub_403C77
		jmp	locret_40671A
; ---------------------------------------------------------------------------

loc_4064E2:				; CODE XREF: sub_40639D+132j
		mov	eax, [ebp+var_24]
		add	eax, [ebp+var_18]
		mov	[ebp+var_24], eax
		jmp	loc_40659C
; ---------------------------------------------------------------------------

loc_4064F0:				; CODE XREF: sub_40639D+207j
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_40650B
		mov	[esp+38h+Dst], 53h
		call	sub_403C77
		jmp	locret_40671A
; ---------------------------------------------------------------------------

loc_40650B:				; CODE XREF: sub_40639D+15Bj
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_24]
		add	eax, 1
		mov	[ebp+var_24], eax
		lea	eax, [ebp+var_24]
		mov	[esp+38h+Dst], eax
		call	sub_403CB4
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_40653D
		mov	[esp+38h+Dst], 53h
		call	sub_403C77
		jmp	locret_40671A
; ---------------------------------------------------------------------------

loc_40653D:				; CODE XREF: sub_40639D+18Dj
		mov	eax, [ebp+var_24]
		add	eax, [ebp+var_18]
		mov	[ebp+var_24], eax
		lea	eax, [ebp+var_24]
		mov	[esp+38h+Dst], eax
		call	sub_403CB4
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_40656B
		mov	[esp+38h+Dst], 53h
		call	sub_403C77
		jmp	locret_40671A
; ---------------------------------------------------------------------------

loc_40656B:				; CODE XREF: sub_40639D+1BBj
		mov	eax, [ebp+var_24]
		add	eax, [ebp+var_18]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jz	short loc_40658F
		mov	[esp+38h+Dst], 53h
		call	sub_403C77
		jmp	locret_40671A
; ---------------------------------------------------------------------------

loc_40658F:				; CODE XREF: sub_40639D+1DFj
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_24]
		add	eax, 1
		mov	[ebp+var_24], eax

loc_40659C:				; CODE XREF: sub_40639D+14Ej
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jnz	loc_4064F0
		mov	eax, [ebp+var_24]
		mov	[ebp+var_1C], eax
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_24]
		add	eax, 1
		mov	[ebp+var_24], eax
		cmp	[ebp+var_C], 1
		jz	short loc_4065DF
		mov	[esp+38h+Size],	4A7h ; int
		mov	[esp+38h+Src], offset a____Gnupg22__0 ;	"../../gnupg2-2.0.30/agent/protect.c"
		mov	[esp+38h+Dst], offset aDepth1 ;	"depth == 1"
		call	sub_4276E0

loc_4065DF:				; CODE XREF: sub_40639D+224j
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		add	eax, edx
		add	eax, 20h
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dst], eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_406617
		call	sub_403CA7
		jmp	locret_40671A
; ---------------------------------------------------------------------------

loc_406617:				; CODE XREF: sub_40639D+26Ej
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax], 3A303228h
		mov	dword ptr [eax+4], 64616873h
		mov	dword ptr [eax+8], 6465776Fh
		mov	dword ptr [eax+0Ch], 6972702Dh
		mov	dword ptr [eax+10h], 65746176h
		mov	dword ptr [eax+14h], 79656B2Dh
		mov	byte ptr [eax+18h], 0
		add	[ebp+var_20], 18h
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		add	eax, 0Eh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	ecx, eax
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+0Eh]
		mov	eax, [ebp+var_20]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		add	eax, 0Eh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax], 733A3828h
		mov	dword ptr [eax+4], 6F646168h
		mov	dword ptr [eax+8], 35646577h
		mov	dword ptr [eax+0Ch], 2D31743Ah
		mov	word ptr [eax+10h], 3176h
		mov	byte ptr [eax+12h], 0
		add	[ebp+var_20], 12h
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_20]
		mov	ecx, [ebp+var_14]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_14]
		add	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	byte ptr [eax],	29h
		add	[ebp+var_20], 1
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_1C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	ecx, eax
		add	ecx, [ebp+var_10]
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_20]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_1C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, [ebp+var_10]
		add	[ebp+var_20], eax
		mov	eax, 0

locret_40671A:				; CODE XREF: sub_40639D+71j
					; sub_40639D+92j ...
		leave
		retn
sub_40639D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40671C	proc near		; CODE XREF: sub_401EC9+2Dp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_40674A
		mov	[esp+28h+var_28], 53h
		call	sub_403C77
		jmp	locret_40695F
; ---------------------------------------------------------------------------

loc_40674A:				; CODE XREF: sub_40671C+1Bj
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[ebp+var_14], eax
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	sub_403CB4
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40677C
		mov	[esp+28h+var_28], 53h
		call	sub_403C77
		jmp	locret_40695F
; ---------------------------------------------------------------------------

loc_40677C:				; CODE XREF: sub_40671C+4Dj
		mov	[esp+28h+var_20], offset aShadowedPrivat ; "shadowed-private-key"
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_24], eax ;	int
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_403DE3
		test	eax, eax
		jnz	short loc_4067AB
		mov	[esp+28h+var_28], 68h
		call	sub_403C77
		jmp	locret_40695F
; ---------------------------------------------------------------------------

loc_4067AB:				; CODE XREF: sub_40671C+7Cj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_4067C6
		mov	[esp+28h+var_28], 68h
		call	sub_403C77
		jmp	locret_40695F
; ---------------------------------------------------------------------------

loc_4067C6:				; CODE XREF: sub_40671C+97j
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[ebp+var_14], eax
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	sub_403CB4
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4067F8
		mov	[esp+28h+var_28], 53h
		call	sub_403C77
		jmp	locret_40695F
; ---------------------------------------------------------------------------

loc_4067F8:				; CODE XREF: sub_40671C+C9j
		mov	eax, [ebp+var_14]
		add	eax, [ebp+var_10]
		mov	[ebp+var_14], eax

loc_406801:				; CODE XREF: sub_40671C+1CAj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jnz	short loc_40681C
		mov	[esp+28h+var_28], 68h
		call	sub_403C77
		jmp	locret_40695F
; ---------------------------------------------------------------------------

loc_40681C:				; CODE XREF: sub_40671C+EDj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_406837
		mov	[esp+28h+var_28], 53h
		call	sub_403C77
		jmp	locret_40695F
; ---------------------------------------------------------------------------

loc_406837:				; CODE XREF: sub_40671C+108j
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[ebp+var_14], eax
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	sub_403CB4
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_406869
		mov	[esp+28h+var_28], 53h
		call	sub_403C77
		jmp	locret_40695F
; ---------------------------------------------------------------------------

loc_406869:				; CODE XREF: sub_40671C+13Aj
		mov	[esp+28h+var_20], offset aShadowed ; "shadowed"
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_24], eax ;	int
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_403DE3
		test	eax, eax
		jnz	short loc_4068EB
		mov	eax, [ebp+var_14]
		add	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	sub_403CB4
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4068B5
		mov	[esp+28h+var_28], 53h
		call	sub_403C77
		jmp	locret_40695F
; ---------------------------------------------------------------------------

loc_4068B5:				; CODE XREF: sub_40671C+186j
		mov	eax, [ebp+var_14]
		add	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jz	short loc_4068D9
		mov	[esp+28h+var_28], 53h
		call	sub_403C77
		jmp	locret_40695F
; ---------------------------------------------------------------------------

loc_4068D9:				; CODE XREF: sub_40671C+1AAj
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[ebp+var_14], eax
		jmp	loc_406801
; ---------------------------------------------------------------------------

loc_4068EB:				; CODE XREF: sub_40671C+169j
		nop
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	sub_403CB4
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40690E
		mov	[esp+28h+var_28], 53h
		call	sub_403C77
		jmp	short locret_40695F
; ---------------------------------------------------------------------------

loc_40690E:				; CODE XREF: sub_40671C+1E2j
		mov	[esp+28h+var_20], offset aT1V1 ; "t1-v1"
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_24], eax ;	int
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_403DE3
		test	eax, eax
		jz	short loc_406953
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_406944
		mov	[esp+28h+var_28], 53h
		call	sub_403C77
		jmp	short locret_40695F
; ---------------------------------------------------------------------------

loc_406944:				; CODE XREF: sub_40671C+218j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, 0
		jmp	short locret_40695F
; ---------------------------------------------------------------------------

loc_406953:				; CODE XREF: sub_40671C+20Ej
		mov	[esp+28h+var_28], 79h
		call	sub_403C77

locret_40695F:				; CODE XREF: sub_40671C+29j
					; sub_40671C+5Bj ...
		leave
		retn
sub_40671C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_406976
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0

loc_406976:				; CODE XREF: .text:0040696Bj
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_406985
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 0

loc_406985:				; CODE XREF: .text:0040697Aj
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_4069A6
		mov	dword ptr [esp], 53h
		call	sub_403C77
		jmp	locret_406AC7
; ---------------------------------------------------------------------------

loc_4069A6:				; CODE XREF: .text:00406993j
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[ebp-10h], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_403CB4
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4069D4
		mov	dword ptr [esp], 53h
		call	sub_403C77
		jmp	locret_406AC7
; ---------------------------------------------------------------------------

loc_4069D4:				; CODE XREF: .text:004069C1j
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_406A0C
		mov	eax, [ebp-10h]
		mov	dword ptr [esp+8], 0
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_40E9C4
		mov	edx, [ebp+0Ch]
		mov	[edx], eax
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_406A0C
		call	sub_403C92
		jmp	locret_406AC7
; ---------------------------------------------------------------------------

loc_406A0C:				; CODE XREF: .text:004069D8j
					; .text:00406A00j
		mov	eax, [ebp-10h]
		add	eax, [ebp-0Ch]
		mov	[ebp-10h], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_403CB4
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_406A53
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_406A45
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[esp], eax
		call	gcry_free
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0

loc_406A45:				; CODE XREF: .text:00406A2Dj
		mov	dword ptr [esp], 53h
		call	sub_403C77
		jmp	short locret_406AC7
; ---------------------------------------------------------------------------

loc_406A53:				; CODE XREF: .text:00406A27j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_406AC2
		mov	eax, [ebp-0Ch]
		add	eax, 1
		mov	[esp], eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+10h]
		mov	[eax], edx
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_406A9A
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_406A93
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[esp], eax
		call	gcry_free
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0

loc_406A93:				; CODE XREF: .text:00406A7Bj
		call	sub_403C92
		jmp	short locret_406AC7
; ---------------------------------------------------------------------------

loc_406A9A:				; CODE XREF: .text:00406A75j
		mov	eax, [ebp-10h]
		mov	edx, eax
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		mov	ecx, [ebp-0Ch]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		add	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0

loc_406AC2:				; CODE XREF: .text:00406A57j
		mov	eax, 0

locret_406AC7:				; CODE XREF: .text:004069A1j
					; .text:004069CFj ...
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406ACC	proc near		; CODE XREF: sub_406CE6+47p
					; sub_407751+26p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax+10h], 0
		cmp	[ebp+var_C], 0
		jnz	short loc_406B10
		mov	eax, 0FFFFFFFFh
		jmp	locret_406CE4
; ---------------------------------------------------------------------------

loc_406B10:				; CODE XREF: sub_406ACC+38j
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_18], eax
		add	[ebp+var_8], 1
		sub	[ebp+var_C], 1
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+10h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_8]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_18]
		and	eax, 0C0h
		mov	edx, eax
		sar	edx, 6
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_18]
		and	eax, 20h
		test	eax, eax
		setnz	al
		movzx	edx, al
		mov	eax, [ebp+arg_8]
		mov	[eax+4], edx
		mov	eax, [ebp+var_18]
		and	eax, 1Fh
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 1Fh
		jnz	short loc_406BBB
		mov	[ebp+var_4], 0

loc_406B6F:				; CODE XREF: sub_406ACC+EDj
		shl	[ebp+var_4], 7
		cmp	[ebp+var_C], 0
		jnz	short loc_406B83
		mov	eax, 0FFFFFFFFh
		jmp	locret_406CE4
; ---------------------------------------------------------------------------

loc_406B83:				; CODE XREF: sub_406ACC+ABj
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_18], eax
		add	[ebp+var_8], 1
		sub	[ebp+var_C], 1
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+10h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_8]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_18]
		and	eax, 7Fh
		or	[ebp+var_4], eax
		mov	eax, [ebp+var_18]
		and	eax, 80h
		test	eax, eax
		jnz	short loc_406B6F

loc_406BBB:				; CODE XREF: sub_406ACC+9Aj
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_4]
		mov	[eax+8], edx
		cmp	[ebp+var_C], 0
		jnz	short loc_406BD4
		mov	eax, 0FFFFFFFFh
		jmp	locret_406CE4
; ---------------------------------------------------------------------------

loc_406BD4:				; CODE XREF: sub_406ACC+FCj
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_18], eax
		add	[ebp+var_8], 1
		sub	[ebp+var_C], 1
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+10h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_8]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_18]
		and	eax, 80h
		test	eax, eax
		jnz	short loc_406C11
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+arg_8]
		mov	[eax+0Ch], edx
		jmp	loc_406CA0
; ---------------------------------------------------------------------------

loc_406C11:				; CODE XREF: sub_406ACC+135j
		cmp	[ebp+var_18], 80h
		jnz	short loc_406C26
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax+14h], 1
		jmp	short loc_406CA0
; ---------------------------------------------------------------------------

loc_406C26:				; CODE XREF: sub_406ACC+14Cj
		cmp	[ebp+var_18], 0FFh
		jnz	short loc_406C39
		mov	eax, 0FFFFFFFFh
		jmp	locret_406CE4
; ---------------------------------------------------------------------------

loc_406C39:				; CODE XREF: sub_406ACC+161j
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_18]
		and	eax, 7Fh
		mov	[ebp+var_14], eax
		jmp	short loc_406C91
; ---------------------------------------------------------------------------

loc_406C4B:				; CODE XREF: sub_406ACC+1C9j
		shl	[ebp+var_10], 8
		cmp	[ebp+var_C], 0
		jnz	short loc_406C5F
		mov	eax, 0FFFFFFFFh
		jmp	locret_406CE4
; ---------------------------------------------------------------------------

loc_406C5F:				; CODE XREF: sub_406ACC+187j
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_18], eax
		add	[ebp+var_8], 1
		sub	[ebp+var_C], 1
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+10h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_8]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_18]
		and	eax, 0FFh
		or	[ebp+var_10], eax
		sub	[ebp+var_14], 1

loc_406C91:				; CODE XREF: sub_406ACC+17Dj
		cmp	[ebp+var_14], 0
		jnz	short loc_406C4B
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_10]
		mov	[eax+0Ch], edx

loc_406CA0:				; CODE XREF: sub_406ACC+140j
					; sub_406ACC+158j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_406CBD
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_406CBD
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax+0Ch], 0

loc_406CBD:				; CODE XREF: sub_406ACC+1DBj
					; sub_406ACC+1E5j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_C]
		jbe	short loc_406CCF
		mov	eax, 0FFFFFFFFh
		jmp	short locret_406CE4
; ---------------------------------------------------------------------------

loc_406CCF:				; CODE XREF: sub_406ACC+1FAj
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_8]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, 0

locret_406CE4:				; CODE XREF: sub_406ACC+3Fj
					; sub_406ACC+B2j ...
		leave
		retn
sub_406ACC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406CE6	proc near		; CODE XREF: sub_4077C8+47Ap
					; sub_408758+E9p ...

Dst		= dword	ptr -48h
Src		= dword	ptr -44h
Size		= dword	ptr -40h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_10], 0
		jz	loc_406DE1

loc_406D19:				; CODE XREF: sub_406CE6+ACj
		lea	eax, [ebp+var_30]
		mov	[esp+48h+Size],	eax
		lea	eax, [ebp+var_18]
		mov	[esp+48h+Src], eax
		lea	eax, [ebp+var_14]
		mov	[esp+48h+Dst], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_406DE4
		mov	eax, [ebp+var_30]
		test	eax, eax
		jnz	short loc_406D94
		mov	eax, [ebp+var_28]
		cmp	eax, 4
		jnz	short loc_406D94
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jnz	short loc_406D94
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jnz	short loc_406D94
		mov	ecx, [ebp+var_24]
		mov	eax, [ebp+var_14]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_24]
		add	eax, edx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_24]
		add	[ebp+var_C], eax
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_24]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		jmp	short loc_406D19
; ---------------------------------------------------------------------------

loc_406D94:				; CODE XREF: sub_406CE6+59j
					; sub_406CE6+61j ...
		mov	eax, [ebp+var_30]
		test	eax, eax
		jnz	short loc_406DE5
		mov	eax, [ebp+var_28]
		test	eax, eax
		jnz	short loc_406DE5
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jnz	short loc_406DE5
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_10]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		cmp	[ebp+arg_8], 0
		jz	short loc_406DDC
		mov	eax, [ebp+arg_8]
		mov	edx, [eax]
		mov	eax, [ebp+var_14]
		mov	ecx, eax
		mov	eax, [ebp+arg_0]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_406DDC:				; CODE XREF: sub_406CE6+DAj
		mov	eax, [ebp+var_10]
		jmp	short loc_406E15
; ---------------------------------------------------------------------------

loc_406DE1:				; CODE XREF: sub_406CE6+2Dj
		nop
		jmp	short loc_406DE5
; ---------------------------------------------------------------------------

loc_406DE4:				; CODE XREF: sub_406CE6+4Ej
		nop

loc_406DE5:				; CODE XREF: sub_406CE6+B3j
					; sub_406CE6+BAj ...
		cmp	[ebp+arg_8], 0
		jz	short loc_406E05
		mov	eax, [ebp+arg_8]
		mov	edx, [eax]
		mov	eax, [ebp+var_14]
		mov	ecx, eax
		mov	eax, [ebp+arg_0]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_406E05:				; CODE XREF: sub_406CE6+103j
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Dst], eax
		call	gcry_free
		mov	eax, 0

loc_406E15:				; CODE XREF: sub_406CE6+F9j
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_406CE6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406E1B	proc near		; CODE XREF: sub_407285+62p
					; sub_407285+EEp ...

var_138		= dword	ptr -138h
var_134		= byte ptr -134h
var_130		= dword	ptr -130h
var_12C		= dword	ptr -12Ch
var_128		= dword	ptr -128h
var_10C		= dword	ptr -10Ch
var_108		= dword	ptr -108h
var_104		= byte ptr -104h
var_100		= byte ptr -100h
var_80		= byte ptr -80h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 134h
		mov	[ebp+var_2C], 0
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_10C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_10C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 1Fh
		jle	short loc_406E77
		mov	[esp+138h+var_138], offset aPasswordTooLon ; "password too long\n"
		call	sub_42091D
		mov	eax, 0FFFFFFFFh
		jmp	loc_40727C
; ---------------------------------------------------------------------------

loc_406E77:				; CODE XREF: sub_406E1B+44j
		cmp	[ebp+arg_8], 7
		ja	short loc_406E93
		mov	[esp+138h+var_138], offset aSaltTooShort ; "salt too short\n"
		call	sub_42091D
		mov	eax, 0FFFFFFFFh
		jmp	loc_40727C
; ---------------------------------------------------------------------------

loc_406E93:				; CODE XREF: sub_406E1B+60j
		lea	eax, [ebp+var_100]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	short loc_406EC7
; ---------------------------------------------------------------------------

loc_406EA5:				; CODE XREF: sub_406E1B+B0j
		mov	eax, [ebp+var_C]
		mov	edx, 0
		div	[ebp+arg_8]
		mov	eax, edx
		add	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_406EC7:				; CODE XREF: sub_406E1B+88j
		cmp	[ebp+var_C], 3Fh
		jle	short loc_406EA5
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	short loc_406F11
; ---------------------------------------------------------------------------

loc_406EDC:				; CODE XREF: sub_406E1B+FAj
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_10]
		add	eax, [ebp+arg_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_1C]
		jle	short loc_406F0D
		mov	[ebp+var_10], 0

loc_406F0D:				; CODE XREF: sub_406E1B+E9j
		add	[ebp+var_C], 2

loc_406F11:				; CODE XREF: sub_406E1B+BFj
		cmp	[ebp+var_C], 3Fh
		jle	short loc_406EDC

loc_406F17:				; CODE XREF: sub_406E1B+45Cj
		mov	[esp+138h+var_130], 0
		mov	dword ptr [esp+138h+var_134], 2
		lea	eax, [ebp+var_28]
		mov	[esp+138h+var_138], eax
		call	gcry_md_open
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_406F5E
		mov	eax, [ebp+var_20]
		mov	[esp+138h+var_138], eax
		call	gpg_strerror
		mov	dword ptr [esp+138h+var_134], eax ; char
		mov	[esp+138h+var_138], offset aGcry_md_openFa ; "gcry_md_open failed: %s\n"
		call	sub_42091D
		mov	eax, [ebp+var_20]
		jmp	loc_40727C
; ---------------------------------------------------------------------------

loc_406F5E:				; CODE XREF: sub_406E1B+11Ej
		mov	[ebp+var_C], 0
		jmp	short loc_406FB7
; ---------------------------------------------------------------------------

loc_406F67:				; CODE XREF: sub_406E1B+1A0j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_24]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_406F98
		mov	[esp+138h+var_130], 0
		mov	dword ptr [esp+138h+var_134], 0
		mov	eax, [ebp+var_24]
		mov	[esp+138h+var_138], eax
		call	gcry_md_write

loc_406F98:				; CODE XREF: sub_406E1B+160j
		mov	eax, [ebp+var_24]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_0]
		mov	ecx, edx
		mov	edx, [ebp+var_24]
		mov	[edx+eax+0Ch], cl
		lea	edx, [eax+1]
		mov	eax, [ebp+var_24]
		mov	[eax+4], edx
		add	[ebp+var_C], 1

loc_406FB7:				; CODE XREF: sub_406E1B+14Aj
		cmp	[ebp+var_C], 3Fh
		jle	short loc_406F67
		mov	eax, [ebp+var_28]
		mov	[esp+138h+var_130], 80h
		lea	edx, [ebp+var_100]
		mov	dword ptr [esp+138h+var_134], edx
		mov	[esp+138h+var_138], eax
		call	gcry_md_write
		mov	eax, [ebp+var_28]
		mov	dword ptr [esp+138h+var_134], 0
		mov	[esp+138h+var_138], eax
		call	gcry_md_read
		mov	edx, [eax]
		mov	[ebp+var_40], edx
		mov	edx, [eax+4]
		mov	[ebp+var_3C], edx
		mov	edx, [eax+8]
		mov	[ebp+var_38], edx
		mov	edx, [eax+0Ch]
		mov	[ebp+var_34], edx
		mov	eax, [eax+10h]
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_28]
		mov	[esp+138h+var_138], eax
		call	gcry_md_close
		mov	[ebp+var_C], 1
		jmp	short loc_407044
; ---------------------------------------------------------------------------

loc_40701E:				; CODE XREF: sub_406E1B+22Fj
		mov	[esp+138h+var_12C], 14h
		lea	eax, [ebp+var_40]
		mov	[esp+138h+var_130], eax
		lea	eax, [ebp+var_40]
		mov	dword ptr [esp+138h+var_134], eax
		mov	[esp+138h+var_138], 2
		call	gcry_md_hash_buffer
		add	[ebp+var_C], 1

loc_407044:				; CODE XREF: sub_406E1B+201j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_C]
		jl	short loc_40701E
		mov	[ebp+var_C], 0
		jmp	short loc_407070
; ---------------------------------------------------------------------------

loc_407055:				; CODE XREF: sub_406E1B+261j
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+arg_18]
		add	edx, eax
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		mov	[edx], al
		add	[ebp+var_18], 1
		add	[ebp+var_C], 1

loc_407070:				; CODE XREF: sub_406E1B+238j
		cmp	[ebp+var_C], 13h
		jg	short loc_40707E
		mov	eax, [ebp+arg_14]
		cmp	eax, [ebp+var_18]
		ja	short loc_407055

loc_40707E:				; CODE XREF: sub_406E1B+259j
		mov	eax, [ebp+arg_14]
		cmp	eax, [ebp+var_18]
		jnz	short loc_40709B
		mov	eax, [ebp+var_2C]
		mov	[esp+138h+var_138], eax
		call	gcry_mpi_release
		mov	eax, 0
		jmp	loc_40727C
; ---------------------------------------------------------------------------

loc_40709B:				; CODE XREF: sub_406E1B+269j
		mov	[ebp+var_C], 0
		jmp	short loc_4070D9
; ---------------------------------------------------------------------------

loc_4070A4:				; CODE XREF: sub_406E1B+2C2j
		mov	ecx, [ebp+var_C]
		mov	edx, 66666667h
		mov	eax, ecx
		imul	edx
		sar	edx, 3
		mov	eax, ecx
		sar	eax, 1Fh
		sub	edx, eax
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		mov	edx, ecx
		sub	edx, eax
		movzx	edx, byte ptr [ebp+edx+var_40]
		lea	eax, [ebp+var_80]
		add	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_4070D9:				; CODE XREF: sub_406E1B+287j
		cmp	[ebp+var_C], 3Fh
		jle	short loc_4070A4
		lea	eax, [ebp+var_104]
		mov	[esp+138h+var_128], eax
		mov	[esp+138h+var_12C], 40h
		lea	eax, [ebp+var_80]
		mov	[esp+138h+var_130], eax
		mov	dword ptr [esp+138h+var_134], 5
		lea	eax, [ebp+var_2C]
		mov	[esp+138h+var_138], eax
		call	gcry_mpi_scan
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_407139
		mov	eax, [ebp+var_20]
		mov	[esp+138h+var_138], eax
		call	gpg_strerror
		mov	dword ptr [esp+138h+var_134], eax ; char
		mov	[esp+138h+var_138], offset aGcry_mpi_scanF ; "gcry_mpi_scan failed: %s\n"
		call	sub_42091D
		mov	eax, 0FFFFFFFFh
		jmp	loc_40727C
; ---------------------------------------------------------------------------

loc_407139:				; CODE XREF: sub_406E1B+2F7j
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_2C]
		mov	[esp+138h+var_130], 1
		mov	dword ptr [esp+138h+var_134], edx
		mov	[esp+138h+var_138], eax
		call	gcry_mpi_add_ui
		mov	[ebp+var_C], 0
		jmp	loc_40726D
; ---------------------------------------------------------------------------

loc_40715F:				; CODE XREF: sub_406E1B+456j
		mov	eax, [ebp+var_C]
		lea	edx, [ebp+var_100]
		add	edx, eax
		lea	eax, [ebp+var_104]
		mov	[esp+138h+var_128], eax
		mov	[esp+138h+var_12C], 40h
		mov	[esp+138h+var_130], edx
		mov	dword ptr [esp+138h+var_134], 5
		lea	eax, [ebp+var_108]
		mov	[esp+138h+var_138], eax
		call	gcry_mpi_scan
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_4071C4
		mov	eax, [ebp+var_20]
		mov	[esp+138h+var_138], eax
		call	gpg_strerror
		mov	dword ptr [esp+138h+var_134], eax ; char
		mov	[esp+138h+var_138], offset aGcry_mpi_scanF ; "gcry_mpi_scan failed: %s\n"
		call	sub_42091D
		mov	eax, 0FFFFFFFFh
		jmp	loc_40727C
; ---------------------------------------------------------------------------

loc_4071C4:				; CODE XREF: sub_406E1B+382j
		mov	ecx, [ebp+var_2C]
		mov	edx, [ebp+var_108]
		mov	eax, [ebp+var_108]
		mov	[esp+138h+var_130], ecx
		mov	dword ptr [esp+138h+var_134], edx
		mov	[esp+138h+var_138], eax
		call	gcry_mpi_add
		mov	eax, [ebp+var_108]
		mov	dword ptr [esp+138h+var_134], 200h
		mov	[esp+138h+var_138], eax
		call	gcry_mpi_clear_highbit
		mov	eax, [ebp+var_108]
		mov	edx, [ebp+var_C]
		lea	ecx, [ebp+var_100]
		add	edx, ecx
		mov	[esp+138h+var_128], eax
		lea	eax, [ebp+var_104]
		mov	[esp+138h+var_12C], eax
		mov	[esp+138h+var_130], 40h
		mov	dword ptr [esp+138h+var_134], edx
		mov	[esp+138h+var_138], 5
		call	gcry_mpi_print
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_40725B
		mov	eax, [ebp+var_20]
		mov	[esp+138h+var_138], eax
		call	gpg_strerror
		mov	dword ptr [esp+138h+var_134], eax ; char
		mov	[esp+138h+var_138], offset aGcry_mpi_print ; "gcry_mpi_print failed: %s\n"
		call	sub_42091D
		mov	eax, 0FFFFFFFFh
		jmp	short loc_40727C
; ---------------------------------------------------------------------------

loc_40725B:				; CODE XREF: sub_406E1B+41Cj
		mov	eax, [ebp+var_108]
		mov	[esp+138h+var_138], eax
		call	gcry_mpi_release
		add	[ebp+var_C], 40h

loc_40726D:				; CODE XREF: sub_406E1B+33Fj
		cmp	[ebp+var_C], 7Fh
		jle	loc_40715F
		jmp	loc_406F17
; ---------------------------------------------------------------------------

loc_40727C:				; CODE XREF: sub_406E1B+57j
					; sub_406E1B+73j ...
		add	esp, 134h
		pop	edi
		pop	ebp
		retn
sub_406E1B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407285	proc near		; CODE XREF: sub_4073CF+AEp

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_24		= byte ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		cmp	[ebp+arg_14], 5
		jz	short loc_4072B5
		cmp	[ebp+arg_14], 18h
		jz	short loc_4072B5
		mov	[esp+48h+var_40], 1ACh ; int
		mov	[esp+48h+var_44], offset a____Gnupg22__1 ; "../../gnupg2-2.0.30/agent/minip12.c"
		mov	[esp+48h+var_48], offset aKeybytes5Keyby ; "keybytes ==	5 || keybytes == 24"
		call	sub_4276E0
		jmp	short loc_4072B6
; ---------------------------------------------------------------------------

loc_4072B5:				; CODE XREF: sub_407285+Aj
					; sub_407285+10j
		nop

loc_4072B6:				; CODE XREF: sub_407285+2Ej
		lea	eax, [ebp+var_24]
		mov	[esp+48h+var_30], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+var_3C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax
		mov	[esp+48h+var_48], 1
		call	sub_406E1B
		test	eax, eax
		jz	short loc_4072FA
		mov	eax, 0FFFFFFFFh
		jmp	locret_4073CD
; ---------------------------------------------------------------------------

loc_4072FA:				; CODE XREF: sub_407285+69j
		mov	eax, [ebp+arg_14]
		mov	[esp+48h+var_40], eax
		lea	eax, [ebp+var_24]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	gcry_cipher_setkey
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_407341
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aGcry_cipher_se ; "gcry_cipher_setkey failed: %s\n"
		call	sub_42091D
		mov	eax, 0FFFFFFFFh
		jmp	locret_4073CD
; ---------------------------------------------------------------------------

loc_407341:				; CODE XREF: sub_407285+95j
		lea	eax, [ebp+var_24]
		mov	[esp+48h+var_30], eax
		mov	[esp+48h+var_34], 8
		mov	eax, [ebp+arg_10]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+var_3C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax
		mov	[esp+48h+var_48], 2
		call	sub_406E1B
		test	eax, eax
		jz	short loc_407383
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4073CD
; ---------------------------------------------------------------------------

loc_407383:				; CODE XREF: sub_407285+F5j
		mov	[esp+48h+var_40], 8
		lea	eax, [ebp+var_24]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	gcry_cipher_setiv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4073C8
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aGcry_cipher__0 ; "gcry_cipher_setiv failed: %s\n"
		call	sub_42091D
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4073CD
; ---------------------------------------------------------------------------

loc_4073C8:				; CODE XREF: sub_407285+11Fj
		mov	eax, 0

locret_4073CD:				; CODE XREF: sub_407285+70j
					; sub_407285+B7j ...
		leave
		retn
sub_407285	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4073CF	proc near		; CODE XREF: sub_40755B+1AEp
					; sub_40ABDF+30Bp ...

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], 3
		mov	eax, [ebp+arg_18]
		mov	dword ptr [esp+48h+var_44], eax
		lea	eax, [ebp+var_28]
		mov	[esp+48h+var_48], eax
		call	gcry_cipher_open
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_407442
		mov	eax, [ebp+var_24]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aGcry_cipher_op ; "gcry_cipher_open failed: %s\n"
		call	sub_42091D
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		jmp	short loc_407437
; ---------------------------------------------------------------------------

loc_407429:				; CODE XREF: sub_4073CF+6Cj
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1

loc_407437:				; CODE XREF: sub_4073CF+58j
		cmp	[ebp+var_10], 0
		jnz	short loc_407429
		jmp	locret_407559
; ---------------------------------------------------------------------------

loc_407442:				; CODE XREF: sub_4073CF+2Fj
		cmp	[ebp+arg_18], 133h
		jnz	short loc_407452
		mov	eax, 5
		jmp	short loc_407457
; ---------------------------------------------------------------------------

loc_407452:				; CODE XREF: sub_4073CF+7Aj
		mov	eax, 18h

loc_407457:				; CODE XREF: sub_4073CF+81j
		mov	edx, [ebp+var_28]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+48h+var_3C], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_8]
		mov	dword ptr [esp+48h+var_44], eax
		mov	[esp+48h+var_48], edx
		call	sub_407285
		test	eax, eax
		jz	short loc_4074AD
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_18], eax
		jmp	short loc_4074A2
; ---------------------------------------------------------------------------

loc_407494:				; CODE XREF: sub_4073CF+D7j
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		add	[ebp+var_14], 1
		sub	[ebp+var_18], 1

loc_4074A2:				; CODE XREF: sub_4073CF+C3j
		cmp	[ebp+var_18], 0
		jnz	short loc_407494
		jmp	loc_40754E
; ---------------------------------------------------------------------------

loc_4074AD:				; CODE XREF: sub_4073CF+B5j
		cmp	[ebp+arg_1C], 0
		jz	short loc_4074DE
		mov	eax, [ebp+var_28]
		mov	[esp+48h+var_38], 0
		mov	[esp+48h+var_3C], 0
		mov	edx, [ebp+arg_4]
		mov	[esp+48h+var_40], edx
		mov	edx, [ebp+arg_0]
		mov	dword ptr [esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	gcry_cipher_encrypt
		jmp	short loc_407507
; ---------------------------------------------------------------------------

loc_4074DE:				; CODE XREF: sub_4073CF+E2j
		mov	eax, [ebp+var_28]
		mov	[esp+48h+var_38], 0
		mov	[esp+48h+var_3C], 0
		mov	edx, [ebp+arg_4]
		mov	[esp+48h+var_40], edx
		mov	edx, [ebp+arg_0]
		mov	dword ptr [esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	gcry_cipher_decrypt

loc_407507:				; CODE XREF: sub_4073CF+10Dj
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_40754E
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_20], eax
		jmp	short loc_40752C
; ---------------------------------------------------------------------------

loc_40751E:				; CODE XREF: sub_4073CF+161j
		mov	eax, [ebp+var_1C]
		mov	byte ptr [eax],	0
		add	[ebp+var_1C], 1
		sub	[ebp+var_20], 1

loc_40752C:				; CODE XREF: sub_4073CF+14Dj
		cmp	[ebp+var_20], 0
		jnz	short loc_40751E
		mov	eax, [ebp+var_24]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aEnDeCrytionFai ; "en/de-crytion failed: %s\n"
		call	sub_42091D
		nop

loc_40754E:				; CODE XREF: sub_4073CF+D9j
					; sub_4073CF+13Fj
		mov	eax, [ebp+var_28]
		mov	[esp+48h+var_48], eax
		call	gcry_cipher_close

locret_407559:				; CODE XREF: sub_4073CF+6Ej
		leave
		retn
sub_4073CF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40755B(void *, void *, size_t, int, int, int,	int, int, int)
sub_40755B	proc near		; CODE XREF: sub_4077C8+573p
					; sub_408758+557p

Dst		= dword	ptr -58h
Src		= dword	ptr -54h
Size		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_C], 0
		jmp	loc_40772B
; ---------------------------------------------------------------------------

loc_407583:				; CODE XREF: sub_40755B+1DCj
		mov	eax, [ebp+var_C]
		mov	eax, ds:off_42B7C0[eax*4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_4076AD
		cmp	[ebp+var_10], 0
		jnz	short loc_4075E8
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Dst], eax
		call	gcry_malloc_secure
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4075E8
		mov	[esp+58h+Dst], offset aOutOfSecureMem ;	"out of	secure memory while converting p"...
		call	sub_4208F3
		jmp	loc_407740
; ---------------------------------------------------------------------------

loc_4075E8:				; CODE XREF: sub_40755B+41j
					; sub_40755B+7Aj
		mov	eax, [ebp+var_C]
		mov	eax, ds:off_42B7C0[eax*4]
		mov	[esp+58h+Src], offset aUtf8 ; "utf-8"
		mov	[esp+58h+Dst], eax
		call	sub_4255E9
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jz	loc_407726
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_14]
		sub	eax, 1
		mov	[ebp+var_28], eax
		lea	eax, [ebp+var_28]
		mov	[esp+58h+var_48], eax
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_4C], eax
		lea	eax, [ebp+var_24]
		mov	[esp+58h+Size],	eax
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+Src], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Dst], eax
		call	sub_425603
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_407682
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Dst], eax
		call	sub_425632
		jmp	loc_407727
; ---------------------------------------------------------------------------

loc_407682:				; CODE XREF: sub_40755B+115j
		mov	eax, [ebp+var_20]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Dst], eax
		call	sub_425632
		mov	eax, [ebp+var_C]
		mov	eax, ds:off_42B7C0[eax*4]
		mov	[esp+58h+Src], eax ; char
		mov	[esp+58h+Dst], offset aDecryptionFail ;	"decryption failed; trying charset `%s'\"...
		call	sub_4208F3

loc_4076AD:				; CODE XREF: sub_40755B+37j
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		mov	ecx, [ebp+arg_8]
		mov	[esp+58h+Size],	ecx ; Size
		mov	[esp+58h+Src], edx ; Src
		mov	[esp+58h+Dst], eax ; Dst
		call	memcpy
		cmp	[ebp+var_10], 0
		jz	short loc_4076D1
		mov	eax, [ebp+var_10]
		jmp	short loc_4076D4
; ---------------------------------------------------------------------------

loc_4076D1:				; CODE XREF: sub_40755B+16Fj
		mov	eax, [ebp+arg_18]

loc_4076D4:				; CODE XREF: sub_40755B+174j
		mov	[esp+58h+var_3C], 0
		mov	edx, [ebp+arg_1C]
		mov	[esp+58h+var_40], edx
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+58h+Size],	eax
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+Src], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Dst], eax
		call	sub_4073CF
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+Src], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Dst], eax
		mov	eax, [ebp+arg_20]
		call	eax
		test	eax, eax
		jnz	short loc_40773F
		jmp	short loc_407727
; ---------------------------------------------------------------------------

loc_407726:				; CODE XREF: sub_40755B+AEj
		nop

loc_407727:				; CODE XREF: sub_40755B+122j
					; sub_40755B+1C9j
		add	[ebp+var_C], 1

loc_40772B:				; CODE XREF: sub_40755B+23j
		mov	eax, [ebp+var_C]
		mov	eax, ds:off_42B7C0[eax*4]
		test	eax, eax
		jnz	loc_407583
		jmp	short loc_407740
; ---------------------------------------------------------------------------

loc_40773F:				; CODE XREF: sub_40755B+1C7j
		nop

loc_407740:				; CODE XREF: sub_40755B+88j
					; sub_40755B+1E2j
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Dst], eax
		call	gcry_free
		add	esp, 54h
		pop	edi
		pop	ebp
		retn
sub_40755B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407751	proc near		; DATA XREF: sub_4077C8+540o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 2Ch
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_18]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [ebp+var_20]
		mov	[esp+2Ch+var_28], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+2Ch+var_2C], eax
		call	sub_406ACC
		test	eax, eax
		jz	short loc_407787
		mov	eax, 0
		jmp	short locret_4077C6
; ---------------------------------------------------------------------------

loc_407787:				; CODE XREF: sub_407751+2Dj
		mov	eax, [ebp+var_18]
		test	eax, eax
		jnz	short loc_407796
		mov	eax, [ebp+var_10]
		cmp	eax, 10h
		jz	short loc_40779D

loc_407796:				; CODE XREF: sub_407751+3Bj
		mov	eax, 0
		jmp	short locret_4077C6
; ---------------------------------------------------------------------------

loc_40779D:				; CODE XREF: sub_407751+43j
		lea	eax, [ebp+var_18]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [ebp+var_20]
		mov	[esp+2Ch+var_28], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+2Ch+var_2C], eax
		call	sub_406ACC
		test	eax, eax
		jz	short loc_4077C1
		mov	eax, 0
		jmp	short locret_4077C6
; ---------------------------------------------------------------------------

loc_4077C1:				; CODE XREF: sub_407751+67j
		mov	eax, 1

locret_4077C6:				; CODE XREF: sub_407751+34j
					; sub_407751+4Aj ...
		leave
		retn
sub_407751	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4077C8	proc near		; CODE XREF: sub_40913F+3F1p

Buf1		= dword	ptr -0B8h
Buf2		= dword	ptr -0B4h
Size		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_7C		= dword	ptr -7Ch
Dst		= byte ptr -78h
var_64		= byte ptr -64h
Src		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0B4h
		mov	eax, [ebp+arg_0]
		mov	[ebp+Src], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [ebp+var_64],	eax
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 0
		mov	[ebp+var_7C], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 0
		cmp	[ebp+arg_1C], 0
		jz	short loc_40781D
		mov	eax, [ebp+arg_1C]
		mov	dword ptr [eax], 0

loc_40781D:				; CODE XREF: sub_4077C8+4Aj
		mov	dword ptr [ebp+var_10],	offset aStart ;	"start"
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_4085C9
		mov	eax, [ebp+var_5C]
		cmp	eax, 2
		jnz	loc_40861B
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	loc_40861B
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_4085CC
		mov	eax, [ebp+var_54]
		cmp	eax, 10h
		jnz	loc_4085CF
		mov	dword ptr [ebp+var_10],	offset aBag_encryptedd ; "bag.encryptedData.version"
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_4085D2
		mov	eax, [ebp+var_54]
		cmp	eax, 2
		jnz	loc_40861B
		mov	eax, [ebp+var_50]
		cmp	eax, 1
		jnz	loc_40861B
		mov	eax, [ebp+Src]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_40861B
		mov	eax, [ebp+Src]
		add	eax, 1
		mov	[ebp+Src], eax
		mov	eax, dword ptr [ebp+var_64]
		sub	eax, 1
		mov	dword ptr [ebp+var_64],	eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_4085D5
		mov	eax, [ebp+var_54]
		cmp	eax, 10h
		jnz	loc_4085D8
		mov	dword ptr [ebp+var_10],	offset aBag_encrypte_0 ; "bag.encryptedData.data"
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_4085DB
		mov	eax, [ebp+var_54]
		cmp	eax, 6
		jnz	loc_40861B
		mov	eax, [ebp+var_50]
		cmp	eax, 9
		jnz	loc_40861B
		mov	eax, [ebp+Src]
		mov	[esp+0B8h+Size], 9 ; Size
		mov	[esp+0B8h+Buf2], offset	dword_42AE60 ; Buf2
		mov	[esp+0B8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+Src]
		add	eax, 9
		mov	[ebp+Src], eax
		mov	eax, dword ptr [ebp+var_64]
		sub	eax, 9
		mov	dword ptr [ebp+var_64],	eax
		mov	dword ptr [ebp+var_10],	offset aBag_encrypte_1 ; "bag.encryptedData.keyinfo"
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_4085DE
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_54]
		cmp	eax, 10h
		jnz	loc_40861B
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_4085E1
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	short loc_407A35
		mov	eax, [ebp+var_54]
		cmp	eax, 6
		jnz	short loc_407A35
		mov	eax, [ebp+var_50]
		cmp	eax, 0Ah
		jnz	short loc_407A35
		mov	eax, [ebp+Src]
		mov	[esp+0B8h+Size], 0Ah ; Size
		mov	[esp+0B8h+Buf2], offset	dword_42AEA8 ; Buf2
		mov	[esp+0B8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_407A35
		mov	eax, [ebp+Src]
		add	eax, 0Ah
		mov	[ebp+Src], eax
		mov	eax, dword ptr [ebp+var_64]
		sub	eax, 0Ah
		mov	dword ptr [ebp+var_64],	eax
		jmp	short loc_407A94
; ---------------------------------------------------------------------------

loc_407A35:				; CODE XREF: sub_4077C8+228j
					; sub_4077C8+230j ...
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_54]
		cmp	eax, 6
		jnz	loc_40861B
		mov	eax, [ebp+var_50]
		cmp	eax, 0Ah
		jnz	loc_40861B
		mov	eax, [ebp+Src]
		mov	[esp+0B8h+Size], 0Ah ; Size
		mov	[esp+0B8h+Buf2], offset	word_42AE9E ; Buf2
		mov	[esp+0B8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+Src]
		add	eax, 0Ah
		mov	[ebp+Src], eax
		mov	eax, dword ptr [ebp+var_64]
		sub	eax, 0Ah
		mov	dword ptr [ebp+var_64],	eax
		mov	[ebp+var_24], 1

loc_407A94:				; CODE XREF: sub_4077C8+26Bj
		mov	dword ptr [ebp+var_10],	offset aRc2or3desParam ; "rc2or3des-params"
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_4085E4
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_54]
		cmp	eax, 10h
		jnz	loc_40861B
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_4085E7
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_54]
		cmp	eax, 4
		jnz	loc_40861B
		mov	eax, [ebp+var_50]
		cmp	eax, 7
		jbe	loc_40861B
		mov	eax, [ebp+var_50]
		cmp	eax, 14h
		ja	loc_40861B
		mov	eax, [ebp+var_50]
		mov	[ebp+var_40], eax
		mov	eax, [ebp+Src]
		mov	edx, eax
		lea	eax, [ebp+Dst]
		mov	ecx, [ebp+var_40]
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Buf2], edx ; Src
		mov	[esp+0B8h+Buf1], eax ; Dst
		call	memcpy
		mov	eax, [ebp+Src]
		add	eax, [ebp+var_40]
		mov	[ebp+Src], eax
		mov	eax, dword ptr [ebp+var_64]
		sub	eax, [ebp+var_40]
		mov	dword ptr [ebp+var_64],	eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_4085EA
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_54]
		cmp	eax, 2
		jnz	loc_40861B
		mov	eax, [ebp+var_50]
		test	eax, eax
		jz	loc_40861B
		mov	[ebp+var_14], 0
		jmp	short loc_407BCA
; ---------------------------------------------------------------------------

loc_407BA2:				; CODE XREF: sub_4077C8+407j
		shl	[ebp+var_14], 8
		mov	eax, [ebp+Src]
		movzx	edx, byte ptr [eax]
		movzx	edx, dl
		or	[ebp+var_14], edx
		add	eax, 1
		mov	[ebp+Src], eax
		mov	eax, dword ptr [ebp+var_64]
		sub	eax, 1
		mov	dword ptr [ebp+var_64],	eax
		mov	eax, [ebp+var_50]
		sub	eax, 1
		mov	[ebp+var_50], eax

loc_407BCA:				; CODE XREF: sub_4077C8+3D8j
		mov	eax, [ebp+var_50]
		test	eax, eax
		jnz	short loc_407BA2
		mov	dword ptr [ebp+var_10],	offset aRc2or3desCiphe ; "rc2or3des-ciphertext"
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_4085ED
		mov	eax, [ebp+Src]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_7C], eax
		mov	eax, [ebp+var_5C]
		cmp	eax, 2
		jnz	short loc_407C7D
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	short loc_407C7D
		mov	eax, [ebp+var_58]
		test	eax, eax
		jz	short loc_407C7D
		mov	eax, [ebp+var_48]
		test	eax, eax
		jz	short loc_407C7D
		mov	dword ptr [ebp+var_10],	offset aCramRc2or3desC ; "cram-rc2or3des-ciphertext"
		mov	eax, [ebp+Src]
		lea	edx, [ebp+var_7C]
		mov	[esp+0B8h+Size], edx
		lea	edx, [ebp+var_64]
		mov	[esp+0B8h+Buf2], edx
		mov	[esp+0B8h+Buf1], eax
		call	sub_406CE6
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	loc_4085F0
		mov	eax, [ebp+var_20]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+Src], eax
		cmp	[ebp+arg_C], 0
		jz	short loc_407C6E
		mov	edx, [ebp+var_7C]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_407C6E:				; CODE XREF: sub_4077C8+49Cj
		mov	[ebp+arg_C], 0
		mov	eax, dword ptr [ebp+var_64]
		mov	[ebp+var_50], eax
		jmp	short loc_407C9F
; ---------------------------------------------------------------------------

loc_407C7D:				; CODE XREF: sub_4077C8+448j
					; sub_4077C8+44Fj ...
		mov	eax, [ebp+var_5C]
		cmp	eax, 2
		jnz	loc_40861B
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_50]
		test	eax, eax
		jz	loc_40861B

loc_407C9F:				; CODE XREF: sub_4077C8+4B3j
		cmp	[ebp+var_24], 0
		jz	short loc_407CAC
		mov	eax, offset a3des ; "3DES"
		jmp	short loc_407CB1
; ---------------------------------------------------------------------------

loc_407CAC:				; CODE XREF: sub_4077C8+4DBj
		mov	eax, offset aRc2 ; "RC2"

loc_407CB1:				; CODE XREF: sub_4077C8+4E2j
		mov	edx, [ebp+var_50]
		mov	[esp+0B8h+Size], eax
		mov	[esp+0B8h+Buf2], edx ; char
		mov	[esp+0B8h+Buf1], offset	aLuBytesOfSEncr	; "%lu bytes of	%s encrypted text\n"
		call	sub_4208F3
		mov	eax, [ebp+var_50]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_malloc_secure
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_407CED
		mov	[esp+0B8h+Buf1], offset	aErrorAllocatin	; "error allocating decryption buffer\n"
		call	sub_42091D
		jmp	loc_40861B
; ---------------------------------------------------------------------------

loc_407CED:				; CODE XREF: sub_4077C8+512j
		cmp	[ebp+var_24], 0
		jz	short loc_407CFA
		mov	eax, 2
		jmp	short loc_407CFF
; ---------------------------------------------------------------------------

loc_407CFA:				; CODE XREF: sub_4077C8+529j
		mov	eax, 133h

loc_407CFF:				; CODE XREF: sub_4077C8+530j
		mov	ebx, [ebp+var_14]
		mov	ecx, [ebp+var_50]
		mov	edx, [ebp+Src]
		mov	[esp+0B8h+var_98], offset sub_407751 ; int
		mov	[esp+0B8h+var_9C], eax ; int
		mov	eax, [ebp+arg_10]
		mov	[esp+0B8h+var_A0], eax ; int
		mov	[esp+0B8h+var_A4], ebx ; int
		mov	eax, [ebp+var_40]
		mov	[esp+0B8h+var_A8], eax ; int
		lea	eax, [ebp+Dst]
		mov	[esp+0B8h+var_AC], eax ; int
		mov	[esp+0B8h+Size], ecx ; size_t
		mov	eax, [ebp+var_18]
		mov	[esp+0B8h+Buf2], eax ; void *
		mov	[esp+0B8h+Buf1], edx ; void *
		call	sub_40755B
		mov	eax, [ebp+var_50]
		mov	dword ptr [ebp+var_64],	eax
		mov	[ebp+arg_8], 0
		mov	eax, [ebp+var_18]
		mov	[ebp+Src], eax
		mov	eax, [ebp+Src]
		mov	[ebp+var_C], eax
		mov	dword ptr [ebp+var_10],	offset aOuter_outer_se ; "outer.outer.seq"
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jz	short loc_407D89
		mov	[ebp+var_1C], 1
		jmp	loc_40861B
; ---------------------------------------------------------------------------

loc_407D89:				; CODE XREF: sub_4077C8+5B3j
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	short loc_407D98
		mov	eax, [ebp+var_54]
		cmp	eax, 10h
		jz	short loc_407DA4

loc_407D98:				; CODE XREF: sub_4077C8+5C6j
		mov	[ebp+var_1C], 1
		jmp	loc_40861B
; ---------------------------------------------------------------------------

loc_407DA4:				; CODE XREF: sub_4077C8+5CEj
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jz	loc_408581
		mov	[ebp+var_1C], 1
		jmp	loc_40861B
; ---------------------------------------------------------------------------

loc_407DD1:				; CODE XREF: sub_4077C8+DBFj
		mov	[ebp+var_30], 0
		mov	[ebp+var_34], 0
		mov	dword ptr [ebp+var_10],	offset aCertbag_nextce ; "certbag.nextcert"
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_54]
		cmp	eax, 10h
		jnz	loc_40861B
		mov	dword ptr [ebp+var_10],	offset aCertbag_object ; "certbag.objectidentifier"
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_4085F3
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_54]
		cmp	eax, 6
		jnz	loc_40861B
		mov	eax, [ebp+var_50]
		cmp	eax, 0Bh
		jnz	short loc_407E7A
		mov	eax, [ebp+Src]
		mov	[esp+0B8h+Size], 0Bh ; Size
		mov	[esp+0B8h+Buf2], offset	dword_42AE88 ; Buf2
		mov	[esp+0B8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_407E7A
		mov	eax, [ebp+Src]
		add	eax, 0Bh
		mov	[ebp+Src], eax
		mov	eax, dword ptr [ebp+var_64]
		sub	eax, 0Bh
		mov	dword ptr [ebp+var_64],	eax
		jmp	loc_407F04
; ---------------------------------------------------------------------------

loc_407E7A:				; CODE XREF: sub_4077C8+67Aj
					; sub_4077C8+699j
		mov	eax, [ebp+var_50]
		cmp	eax, 0Bh
		jnz	short loc_407EBC
		mov	eax, [ebp+Src]
		mov	[esp+0B8h+Size], 0Bh ; Size
		mov	[esp+0B8h+Buf2], offset	byte_42AE93 ; Buf2
		mov	[esp+0B8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_407EBC
		mov	eax, [ebp+Src]
		add	eax, 0Bh
		mov	[ebp+Src], eax
		mov	eax, dword ptr [ebp+var_64]
		sub	eax, 0Bh
		mov	dword ptr [ebp+var_64],	eax
		mov	[ebp+var_30], 1
		jmp	short loc_407F04
; ---------------------------------------------------------------------------

loc_407EBC:				; CODE XREF: sub_4077C8+6B8j
					; sub_4077C8+6D7j
		mov	eax, [ebp+var_50]
		cmp	eax, 0Bh
		jnz	loc_40861B
		mov	eax, [ebp+Src]
		mov	[esp+0B8h+Size], 0Bh ; Size
		mov	[esp+0B8h+Buf2], offset	word_42AE72 ; Buf2
		mov	[esp+0B8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+Src]
		add	eax, 0Bh
		mov	[ebp+Src], eax
		mov	eax, dword ptr [ebp+var_64]
		sub	eax, 0Bh
		mov	dword ptr [ebp+var_64],	eax
		mov	[ebp+var_34], 1

loc_407F04:				; CODE XREF: sub_4077C8+6ADj
					; sub_4077C8+6F2j
		mov	dword ptr [ebp+var_10],	offset aCertbag_before ; "certbag.before.certheader"
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax ; char
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_4085F6
		mov	eax, [ebp+var_5C]
		cmp	eax, 2
		jnz	loc_40861B
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	loc_40861B
		cmp	[ebp+var_30], 0
		jz	short loc_407F74
		mov	[esp+0B8h+Buf1], offset	aSkippingUnsupp	; "skipping unsupported	crlBag\n"
		call	sub_4208F3
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_50]
		add	eax, edx
		mov	[ebp+Src], eax
		mov	edx, dword ptr [ebp+var_64]
		mov	eax, [ebp+var_50]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	dword ptr [ebp+var_64],	eax
		jmp	loc_4084BB
; ---------------------------------------------------------------------------

loc_407F74:				; CODE XREF: sub_4077C8+77Fj
		cmp	[ebp+var_34], 0
		jz	short loc_407FB1
		cmp	[ebp+var_28], 0
		jnz	short loc_407F86
		cmp	[ebp+arg_1C], 0
		jnz	short loc_407FB1

loc_407F86:				; CODE XREF: sub_4077C8+7B6j
		mov	[esp+0B8h+Buf1], offset	aOneKeybagAlrea	; "one keyBag already processed; skipping "...
		call	sub_4208F3
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_50]
		add	eax, edx
		mov	[ebp+Src], eax
		mov	edx, dword ptr [ebp+var_64]
		mov	eax, [ebp+var_50]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	dword ptr [ebp+var_64],	eax
		jmp	loc_4084BB
; ---------------------------------------------------------------------------

loc_407FB1:				; CODE XREF: sub_4077C8+7B0j
					; sub_4077C8+7BCj
		cmp	[ebp+var_34], 0
		jz	loc_408343
		mov	[esp+0B8h+Buf1], offset	aProcessingSimp	; "processing simple keyBag\n"
		call	sub_4208F3
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_54]
		cmp	eax, 10h
		jnz	loc_40861B
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_54]
		cmp	eax, 2
		jnz	loc_40861B
		mov	eax, [ebp+var_50]
		cmp	eax, 1
		jnz	loc_40861B
		mov	eax, [ebp+Src]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_40861B
		mov	eax, [ebp+Src]
		add	eax, 1
		mov	[ebp+Src], eax
		mov	eax, dword ptr [ebp+var_64]
		sub	eax, 1
		mov	dword ptr [ebp+var_64],	eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_54]
		cmp	eax, 10h
		jnz	loc_40861B
		mov	eax, [ebp+var_50]
		mov	[ebp+var_38], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_4085F9
		mov	eax, [ebp+var_4C]
		cmp	eax, [ebp+var_38]
		jg	loc_4085FC
		mov	eax, [ebp+var_4C]
		sub	[ebp+var_38], eax
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_54]
		cmp	eax, 6
		jnz	loc_40861B
		mov	eax, [ebp+var_50]
		cmp	eax, 9
		jnz	loc_40861B
		mov	eax, [ebp+Src]
		mov	[esp+0B8h+Size], 9 ; Size
		mov	[esp+0B8h+Buf2], offset	dword_42AEBC ; Buf2
		mov	[esp+0B8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+Src]
		add	eax, 9
		mov	[ebp+Src], eax
		mov	eax, dword ptr [ebp+var_64]
		sub	eax, 9
		mov	dword ptr [ebp+var_64],	eax
		mov	edx, [ebp+var_38]
		mov	eax, [ebp+var_50]
		cmp	edx, eax
		jb	loc_4085FF
		mov	edx, [ebp+var_38]
		mov	eax, [ebp+var_50]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_38], eax
		mov	edx, [ebp+var_38]
		mov	eax, dword ptr [ebp+var_64]
		cmp	edx, eax
		ja	loc_408602
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_38]
		add	eax, edx
		mov	[ebp+Src], eax
		mov	edx, dword ptr [ebp+var_64]
		mov	eax, [ebp+var_38]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	dword ptr [ebp+var_64],	eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_54]
		cmp	eax, 4
		jnz	loc_40861B
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_54]
		cmp	eax, 10h
		jnz	loc_40861B
		mov	eax, [ebp+var_50]
		mov	[ebp+var_38], eax
		mov	[esp+0B8h+Buf2], 4 ; char
		mov	[esp+0B8h+Buf1], 0Ah
		call	gcry_calloc
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_408215
		mov	[esp+0B8h+Buf1], offset	aErrorAllocat_0	; "error allocating result array\n"
		call	sub_42091D
		jmp	loc_40861B
; ---------------------------------------------------------------------------

loc_408215:				; CODE XREF: sub_4077C8+A3Aj
		mov	[ebp+var_2C], 0
		mov	dword ptr [ebp+var_10],	offset aReading_keybag ; "reading.keybag.key-parameters"
		mov	[ebp+var_2C], 0
		jmp	loc_408324
; ---------------------------------------------------------------------------

loc_40822F:				; CODE XREF: sub_4077C8+B66j
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_54]
		cmp	eax, 2
		jnz	loc_40861B
		mov	eax, [ebp+var_4C]
		cmp	eax, [ebp+var_38]
		jg	loc_408605
		mov	eax, [ebp+var_4C]
		sub	[ebp+var_38], eax
		mov	edx, [ebp+var_38]
		mov	eax, [ebp+var_50]
		cmp	edx, eax
		jb	loc_408608
		mov	edx, [ebp+var_38]
		mov	eax, [ebp+var_50]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_38], eax
		cmp	[ebp+var_2C], 0
		jnz	short loc_4082AE
		mov	eax, [ebp+var_50]
		cmp	eax, 1
		jnz	short loc_4082AE
		mov	eax, [ebp+Src]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40830A

loc_4082AE:				; CODE XREF: sub_4077C8+AD2j
					; sub_4077C8+ADAj
		mov	ecx, [ebp+var_50]
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_2C]
		shl	eax, 2
		add	eax, [ebp+var_28]
		mov	[esp+0B8h+var_A8], 0
		mov	[esp+0B8h+var_AC], ecx
		mov	[esp+0B8h+Size], edx
		mov	[esp+0B8h+Buf2], 5
		mov	[esp+0B8h+Buf1], eax
		call	gcry_mpi_scan
		mov	[ebp+var_44], eax
		cmp	[ebp+var_44], 0
		jz	short loc_408306
		mov	eax, [ebp+var_44]
		mov	[esp+0B8h+Buf1], eax
		call	gpg_strerror
		mov	[esp+0B8h+Buf2], eax ; char
		mov	[esp+0B8h+Buf1], offset	aErrorParsingKe	; "error parsing key parameter:	%s\n"
		call	sub_42091D
		jmp	loc_40861B
; ---------------------------------------------------------------------------

loc_408306:				; CODE XREF: sub_4077C8+B1Cj
		add	[ebp+var_2C], 1

loc_40830A:				; CODE XREF: sub_4077C8+AE4j
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_50]
		add	eax, edx
		mov	[ebp+Src], eax
		mov	edx, dword ptr [ebp+var_64]
		mov	eax, [ebp+var_50]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	dword ptr [ebp+var_64],	eax

loc_408324:				; CODE XREF: sub_4077C8+A62j
		cmp	[ebp+var_38], 0
		jz	short loc_408334
		cmp	[ebp+var_2C], 8
		jle	loc_40822F

loc_408334:				; CODE XREF: sub_4077C8+B60j
		cmp	[ebp+var_38], 0
		jz	loc_4084BB
		jmp	loc_40861B
; ---------------------------------------------------------------------------

loc_408343:				; CODE XREF: sub_4077C8+7EDj
		mov	[esp+0B8h+Buf1], offset	aProcessingCert	; "processing certBag\n"
		call	sub_4208F3
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_40860B
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_54]
		cmp	eax, 10h
		jnz	loc_40861B
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_40860E
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_54]
		cmp	eax, 6
		jnz	loc_40861B
		mov	eax, [ebp+var_50]
		cmp	eax, 0Ah
		jnz	loc_40861B
		mov	eax, [ebp+Src]
		mov	[esp+0B8h+Size], 0Ah ; Size
		mov	[esp+0B8h+Buf2], offset	dword_42AEB2 ; Buf2
		mov	[esp+0B8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+Src]
		add	eax, 0Ah
		mov	[ebp+Src], eax
		mov	eax, dword ptr [ebp+var_64]
		sub	eax, 0Ah
		mov	dword ptr [ebp+var_64],	eax
		mov	dword ptr [ebp+var_10],	offset aCertbag_befo_0 ; "certbag.before.octetstring"
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_408611
		mov	eax, [ebp+var_5C]
		cmp	eax, 2
		jnz	loc_40861B
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	loc_40861B
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_408614
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_54]
		cmp	eax, 4
		jnz	loc_40861B
		mov	eax, [ebp+var_48]
		test	eax, eax
		jnz	loc_40861B
		cmp	[ebp+arg_14], 0
		jz	short loc_4084A1
		mov	edx, [ebp+var_50]
		mov	eax, [ebp+Src]
		mov	[esp+0B8h+Size], edx
		mov	[esp+0B8h+Buf2], eax
		mov	eax, [ebp+arg_18]
		mov	[esp+0B8h+Buf1], eax
		mov	eax, [ebp+arg_14]
		call	eax

loc_4084A1:				; CODE XREF: sub_4077C8+CBEj
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_50]
		add	eax, edx
		mov	[ebp+Src], eax
		mov	edx, dword ptr [ebp+var_64]
		mov	eax, [ebp+var_50]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	dword ptr [ebp+var_64],	eax

loc_4084BB:				; CODE XREF: sub_4077C8+7A7j
					; sub_4077C8+7E4j ...
		mov	eax, dword ptr [ebp+var_64]
		cmp	eax, 8
		ja	short loc_4084CA
		mov	dword ptr [ebp+var_64],	0

loc_4084CA:				; CODE XREF: sub_4077C8+CF9j
		mov	eax, dword ptr [ebp+var_64]
		test	eax, eax
		jz	loc_408582
		mov	dword ptr [ebp+var_10],	offset aBag_attributes ; "bag.attributes"
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_408617
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	short loc_40850C
		mov	eax, [ebp+var_54]
		cmp	eax, 10h
		jz	short loc_408582

loc_40850C:				; CODE XREF: sub_4077C8+D3Aj
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	loc_40861B
		mov	eax, [ebp+var_54]
		cmp	eax, 11h
		jnz	loc_40861B
		mov	eax, [ebp+var_48]
		test	eax, eax
		jnz	loc_40861B
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_50]
		add	eax, edx
		mov	[ebp+Src], eax
		mov	edx, dword ptr [ebp+var_64]
		mov	eax, [ebp+var_50]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	dword ptr [ebp+var_64],	eax
		mov	eax, dword ptr [ebp+var_64]
		cmp	eax, 8
		ja	short loc_408557
		mov	dword ptr [ebp+var_64],	0

loc_408557:				; CODE XREF: sub_4077C8+D86j
		mov	eax, dword ptr [ebp+var_64]
		test	eax, eax
		jz	short loc_408582
		lea	eax, [ebp+var_5C]
		mov	[esp+0B8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0B8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0B8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_40861A
		jmp	short loc_408582
; ---------------------------------------------------------------------------

loc_408581:				; CODE XREF: sub_4077C8+5F7j
		nop

loc_408582:				; CODE XREF: sub_4077C8+D07j
					; sub_4077C8+D42j ...
		mov	eax, dword ptr [ebp+var_64]
		test	eax, eax
		jnz	loc_407DD1
		cmp	[ebp+arg_C], 0
		jz	short loc_40859B
		mov	edx, [ebp+var_7C]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_40859B:				; CODE XREF: sub_4077C8+DC9j
		mov	eax, [ebp+var_18]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_free
		mov	eax, [ebp+var_20]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_free
		cmp	[ebp+arg_1C], 0
		jz	short loc_4085BF
		mov	eax, [ebp+arg_1C]
		mov	edx, [ebp+var_28]
		mov	[eax], edx

loc_4085BF:				; CODE XREF: sub_4077C8+DEDj
		mov	eax, 0
		jmp	loc_4086BE
; ---------------------------------------------------------------------------

loc_4085C9:				; CODE XREF: sub_4077C8+77j
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_4085CC:				; CODE XREF: sub_4077C8+AFj
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_4085CF:				; CODE XREF: sub_4077C8+BBj
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_4085D2:				; CODE XREF: sub_4077C8+E3j
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_4085D5:				; CODE XREF: sub_4077C8+13Cj
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_4085D8:				; CODE XREF: sub_4077C8+148j
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_4085DB:				; CODE XREF: sub_4077C8+170j
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_4085DE:				; CODE XREF: sub_4077C8+1E5j
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_4085E1:				; CODE XREF: sub_4077C8+21Dj
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_4085E4:				; CODE XREF: sub_4077C8+2EEj
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_4085E7:				; CODE XREF: sub_4077C8+326j
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_4085EA:				; CODE XREF: sub_4077C8+3A9j
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_4085ED:				; CODE XREF: sub_4077C8+42Bj
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_4085F0:				; CODE XREF: sub_4077C8+486j
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_4085F3:				; CODE XREF: sub_4077C8+657j
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_4085F6:				; CODE XREF: sub_4077C8+75Ej
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_4085F9:				; CODE XREF: sub_4077C8+8F4j
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_4085FC:				; CODE XREF: sub_4077C8+900j
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_4085FF:				; CODE XREF: sub_4077C8+96Cj
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_408602:				; CODE XREF: sub_4077C8+989j
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_408605:				; CODE XREF: sub_4077C8+AA5j
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_408608:				; CODE XREF: sub_4077C8+AB9j
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_40860B:				; CODE XREF: sub_4077C8+BA2j
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_40860E:				; CODE XREF: sub_4077C8+BDAj
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_408611:				; CODE XREF: sub_4077C8+C5Aj
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_408614:				; CODE XREF: sub_4077C8+C92j
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_408617:				; CODE XREF: sub_4077C8+D2Fj
		nop
		jmp	short loc_40861B
; ---------------------------------------------------------------------------

loc_40861A:				; CODE XREF: sub_4077C8+DB1j
		nop

loc_40861B:				; CODE XREF: sub_4077C8+83j
					; sub_4077C8+8Ej ...
		cmp	[ebp+var_28], 0
		jz	short loc_40865B
		mov	[ebp+var_3C], 0
		jmp	short loc_408641
; ---------------------------------------------------------------------------

loc_40862A:				; CODE XREF: sub_4077C8+E86j
		mov	eax, [ebp+var_3C]
		shl	eax, 2
		add	eax, [ebp+var_28]
		mov	eax, [eax]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_mpi_release
		add	[ebp+var_3C], 1

loc_408641:				; CODE XREF: sub_4077C8+E60j
		mov	eax, [ebp+var_3C]
		shl	eax, 2
		add	eax, [ebp+var_28]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40862A
		mov	eax, [ebp+var_28]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_free

loc_40865B:				; CODE XREF: sub_4077C8+E57j
		cmp	[ebp+arg_C], 0
		jz	short loc_408669
		mov	edx, [ebp+var_7C]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_408669:				; CODE XREF: sub_4077C8+E97j
		mov	eax, [ebp+var_18]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_free
		mov	eax, [ebp+var_20]
		mov	[esp+0B8h+Buf1], eax
		call	gcry_free
		mov	eax, [ebp+Src]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, [ebp+arg_8]
		mov	[esp+0B8h+Size], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+0B8h+Buf2], eax ; char
		mov	[esp+0B8h+Buf1], offset	aEncrypteddataE	; "encryptedData error at \"%s\", offset %"...
		call	sub_42091D
		cmp	[ebp+var_1C], 0
		jz	short loc_4086B9
		mov	[esp+0B8h+Buf1], offset	aPossiblyBadPas	; "possibly bad	passphrase given\n"
		call	sub_42091D

loc_4086B9:				; CODE XREF: sub_4077C8+EE3j
		mov	eax, 0FFFFFFFFh

loc_4086BE:				; CODE XREF: sub_4077C8+DFCj
		add	esp, 0B4h
		pop	ebx
		pop	ebp
		retn
sub_4077C8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4086C7	proc near		; DATA XREF: sub_408758+520o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 2Ch
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_18]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [ebp+var_20]
		mov	[esp+2Ch+var_28], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+2Ch+var_2C], eax
		call	sub_406ACC
		test	eax, eax
		jnz	short loc_408705
		mov	eax, [ebp+var_18]
		test	eax, eax
		jnz	short loc_408705
		mov	eax, [ebp+var_10]
		cmp	eax, 10h
		jz	short loc_40870C

loc_408705:				; CODE XREF: sub_4086C7+2Dj
					; sub_4086C7+34j
		mov	eax, 0
		jmp	short locret_408756
; ---------------------------------------------------------------------------

loc_40870C:				; CODE XREF: sub_4086C7+3Cj
		lea	eax, [ebp+var_18]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [ebp+var_20]
		mov	[esp+2Ch+var_28], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+2Ch+var_2C], eax
		call	sub_406ACC
		test	eax, eax
		jnz	short loc_40874A
		mov	eax, [ebp+var_18]
		test	eax, eax
		jnz	short loc_40874A
		mov	eax, [ebp+var_10]
		cmp	eax, 2
		jnz	short loc_40874A
		mov	eax, [ebp+var_C]
		cmp	eax, 1
		jnz	short loc_40874A
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_408751

loc_40874A:				; CODE XREF: sub_4086C7+60j
					; sub_4086C7+67j ...
		mov	eax, 0
		jmp	short locret_408756
; ---------------------------------------------------------------------------

loc_408751:				; CODE XREF: sub_4086C7+81j
		mov	eax, 1

locret_408756:				; CODE XREF: sub_4086C7+43j
					; sub_4086C7+88j
		leave
		retn
sub_4086C7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408758	proc near		; CODE XREF: sub_40913F+4D8p

Buf1		= dword	ptr -0A8h
Buf2		= dword	ptr -0A4h
Size		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_6C		= dword	ptr -6Ch
Dst		= byte ptr -68h
var_54		= dword	ptr -54h
Src		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0A4h
		mov	eax, [ebp+arg_0]
		mov	[ebp+Src], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_54], eax
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 0
		mov	[ebp+var_2C], 0
		mov	[ebp+var_6C], 0
		mov	dword ptr [ebp+var_10],	offset aStart ;	"start"
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0A8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_409068
		mov	eax, [ebp+var_4C]
		cmp	eax, 2
		jnz	loc_4090A5
		mov	eax, [ebp+var_44]
		test	eax, eax
		jnz	loc_4090A5
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0A8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_40906B
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_44]
		cmp	eax, 4
		jnz	loc_4090A5
		mov	eax, [ebp+Src]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_6C], eax
		mov	eax, [ebp+var_48]
		test	eax, eax
		jz	short loc_408874
		mov	eax, [ebp+var_38]
		test	eax, eax
		jz	short loc_408874
		mov	dword ptr [ebp+var_10],	offset aCramData_outer ; "cram-data.outersegs"
		mov	eax, [ebp+Src]
		lea	edx, [ebp+var_6C]
		mov	[esp+0A8h+Size], edx
		lea	edx, [ebp+var_54]
		mov	[esp+0A8h+Buf2], edx
		mov	[esp+0A8h+Buf1], eax
		call	sub_406CE6
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jz	loc_40906E
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+Src], eax
		cmp	[ebp+arg_C], 0
		jz	short loc_40886D
		mov	edx, [ebp+var_6C]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_40886D:				; CODE XREF: sub_408758+10Bj
		mov	[ebp+arg_C], 0

loc_408874:				; CODE XREF: sub_408758+C5j
					; sub_408758+CCj
		mov	dword ptr [ebp+var_10],	offset aData_outerseqs ; "data.outerseqs"
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0A8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_409071
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_44]
		cmp	eax, 10h
		jnz	loc_4090A5
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0A8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_409074
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_44]
		cmp	eax, 10h
		jnz	loc_4090A5
		mov	dword ptr [ebp+var_10],	offset aData_objectide ; "data.objectidentifier"
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0A8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_409077
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_44]
		cmp	eax, 6
		jnz	loc_4090A5
		mov	eax, [ebp+var_40]
		cmp	eax, 0Bh
		jnz	loc_4090A5
		mov	eax, [ebp+Src]
		mov	[esp+0A8h+Size], 0Bh ; Size
		mov	[esp+0A8h+Buf2], offset	dword_42AE7D ; Buf2
		mov	[esp+0A8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+Src]
		add	eax, 0Bh
		mov	[ebp+Src], eax
		mov	eax, [ebp+var_54]
		sub	eax, 0Bh
		mov	[ebp+var_54], eax
		mov	dword ptr [ebp+var_10],	offset aShroudedOuters ; "shrouded,outerseqs"
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0A8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_40907A
		mov	eax, [ebp+var_4C]
		cmp	eax, 2
		jnz	loc_4090A5
		mov	eax, [ebp+var_44]
		test	eax, eax
		jnz	loc_4090A5
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0A8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_40907D
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_44]
		cmp	eax, 10h
		jnz	loc_4090A5
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0A8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_409080
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_44]
		cmp	eax, 10h
		jnz	loc_4090A5
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0A8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_409083
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_44]
		cmp	eax, 6
		jnz	loc_4090A5
		mov	eax, [ebp+var_40]
		cmp	eax, 0Ah
		jnz	loc_4090A5
		mov	eax, [ebp+Src]
		mov	[esp+0A8h+Size], 0Ah ; Size
		mov	[esp+0A8h+Buf2], offset	word_42AE9E ; Buf2
		mov	[esp+0A8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+Src]
		add	eax, 0Ah
		mov	[ebp+Src], eax
		mov	eax, [ebp+var_54]
		sub	eax, 0Ah
		mov	[ebp+var_54], eax
		mov	dword ptr [ebp+var_10],	offset a3desParams ; "3des-params"
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0A8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_409086
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_44]
		cmp	eax, 10h
		jnz	loc_4090A5
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0A8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_409089
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_44]
		cmp	eax, 4
		jnz	loc_4090A5
		mov	eax, [ebp+var_40]
		cmp	eax, 7
		jbe	loc_4090A5
		mov	eax, [ebp+var_40]
		cmp	eax, 14h
		ja	loc_4090A5
		mov	eax, [ebp+var_40]
		mov	[ebp+var_30], eax
		mov	eax, [ebp+Src]
		mov	edx, eax
		lea	eax, [ebp+Dst]
		mov	ecx, [ebp+var_30]
		mov	[esp+0A8h+Size], ecx ; Size
		mov	[esp+0A8h+Buf2], edx ; Src
		mov	[esp+0A8h+Buf1], eax ; Dst
		call	memcpy
		mov	eax, [ebp+Src]
		add	eax, [ebp+var_30]
		mov	[ebp+Src], eax
		mov	eax, [ebp+var_54]
		sub	eax, [ebp+var_30]
		mov	[ebp+var_54], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0A8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_40908C
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_44]
		cmp	eax, 2
		jnz	loc_4090A5
		mov	eax, [ebp+var_40]
		test	eax, eax
		jz	loc_4090A5
		mov	[ebp+var_14], 0
		jmp	short loc_408BC9
; ---------------------------------------------------------------------------

loc_408BA1:				; CODE XREF: sub_408758+476j
		shl	[ebp+var_14], 8
		mov	eax, [ebp+Src]
		movzx	edx, byte ptr [eax]
		movzx	edx, dl
		or	[ebp+var_14], edx
		add	eax, 1
		mov	[ebp+Src], eax
		mov	eax, [ebp+var_54]
		sub	eax, 1
		mov	[ebp+var_54], eax
		mov	eax, [ebp+var_40]
		sub	eax, 1
		mov	[ebp+var_40], eax

loc_408BC9:				; CODE XREF: sub_408758+447j
		mov	eax, [ebp+var_40]
		test	eax, eax
		jnz	short loc_408BA1
		mov	dword ptr [ebp+var_10],	offset a3desCiphertext ; "3des-ciphertext"
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0A8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_40908F
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_44]
		cmp	eax, 4
		jnz	loc_4090A5
		mov	eax, [ebp+var_40]
		test	eax, eax
		jz	loc_4090A5
		mov	eax, [ebp+var_40]
		mov	[esp+0A8h+Buf2], eax ; char
		mov	[esp+0A8h+Buf1], offset	aLuBytesOf3desE	; "%lu bytes of	3DES encrypted text\n"
		call	sub_4208F3
		mov	eax, [ebp+var_40]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_malloc_secure
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_408C52
		mov	[esp+0A8h+Buf1], offset	aErrorAllocatin	; "error allocating decryption buffer\n"
		call	sub_42091D
		jmp	loc_4090A5
; ---------------------------------------------------------------------------

loc_408C52:				; CODE XREF: sub_408758+4E7j
		mov	eax, [ebp+Src]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+var_40]
		add	edx, eax
		mov	eax, [ebp+var_6C]
		add	eax, edx
		mov	[ebp+var_6C], eax
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+Src]
		mov	[esp+0A8h+var_88], offset sub_4086C7 ; int
		mov	[esp+0A8h+var_8C], 2 ; int
		mov	ebx, [ebp+arg_10]
		mov	[esp+0A8h+var_90], ebx ; int
		mov	[esp+0A8h+var_94], ecx ; int
		mov	ecx, [ebp+var_30]
		mov	[esp+0A8h+var_98], ecx ; int
		lea	ecx, [ebp+Dst]
		mov	[esp+0A8h+var_9C], ecx ; int
		mov	[esp+0A8h+Size], edx ; size_t
		mov	edx, [ebp+var_1C]
		mov	[esp+0A8h+Buf2], edx ; void *
		mov	[esp+0A8h+Buf1], eax ; void *
		call	sub_40755B
		mov	eax, [ebp+var_40]
		mov	[ebp+var_54], eax
		mov	[ebp+arg_8], 0
		mov	eax, [ebp+var_1C]
		mov	[ebp+Src], eax
		mov	eax, [ebp+Src]
		mov	[ebp+var_C], eax
		mov	dword ptr [ebp+var_10],	offset aDecryptedText ;	"decrypted-text"
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0A8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_44]
		cmp	eax, 10h
		jnz	loc_4090A5
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0A8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_44]
		cmp	eax, 2
		jnz	loc_4090A5
		mov	eax, [ebp+var_40]
		cmp	eax, 1
		jnz	loc_4090A5
		mov	eax, [ebp+Src]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4090A5
		mov	eax, [ebp+Src]
		add	eax, 1
		mov	[ebp+Src], eax
		mov	eax, [ebp+var_54]
		sub	eax, 1
		mov	[ebp+var_54], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0A8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_44]
		cmp	eax, 10h
		jnz	loc_4090A5
		mov	eax, [ebp+var_40]
		mov	[ebp+var_18], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0A8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_409092
		mov	eax, [ebp+var_3C]
		cmp	eax, [ebp+var_18]
		jg	loc_409095
		mov	eax, [ebp+var_3C]
		sub	[ebp+var_18], eax
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_44]
		cmp	eax, 6
		jnz	loc_4090A5
		mov	eax, [ebp+var_40]
		cmp	eax, 9
		jnz	loc_4090A5
		mov	eax, [ebp+Src]
		mov	[esp+0A8h+Size], 9 ; Size
		mov	[esp+0A8h+Buf2], offset	dword_42AEBC ; Buf2
		mov	[esp+0A8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+Src]
		add	eax, 9
		mov	[ebp+Src], eax
		mov	eax, [ebp+var_54]
		sub	eax, 9
		mov	[ebp+var_54], eax
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_40]
		cmp	edx, eax
		jb	loc_409098
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_40]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_54]
		cmp	edx, eax
		ja	loc_40909B
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_18]
		add	eax, edx
		mov	[ebp+Src], eax
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_18]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_54], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0A8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_44]
		cmp	eax, 4
		jnz	loc_4090A5
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0A8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_44]
		cmp	eax, 10h
		jnz	loc_4090A5
		mov	eax, [ebp+var_40]
		mov	[ebp+var_18], eax
		mov	[esp+0A8h+Buf2], 4 ; char
		mov	[esp+0A8h+Buf1], 0Ah
		call	gcry_calloc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_408F22
		mov	[esp+0A8h+Buf1], offset	aErrorAllocat_0	; "error allocating result array\n"
		call	sub_42091D
		jmp	loc_4090A5
; ---------------------------------------------------------------------------

loc_408F22:				; CODE XREF: sub_408758+7B7j
		mov	[ebp+var_24], 0
		mov	dword ptr [ebp+var_10],	offset aReading_keyPar ; "reading.key-parameters"
		mov	[ebp+var_24], 0
		jmp	loc_409031
; ---------------------------------------------------------------------------

loc_408F3C:				; CODE XREF: sub_408758+8E3j
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+Buf2], eax
		lea	eax, [ebp+Src]
		mov	[esp+0A8h+Buf1], eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	loc_4090A5
		mov	eax, [ebp+var_44]
		cmp	eax, 2
		jnz	loc_4090A5
		mov	eax, [ebp+var_3C]
		cmp	eax, [ebp+var_18]
		jg	loc_40909E
		mov	eax, [ebp+var_3C]
		sub	[ebp+var_18], eax
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_40]
		cmp	edx, eax
		jb	loc_4090A1
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_40]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_408FBB
		mov	eax, [ebp+var_40]
		cmp	eax, 1
		jnz	short loc_408FBB
		mov	eax, [ebp+Src]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_409017

loc_408FBB:				; CODE XREF: sub_408758+84Fj
					; sub_408758+857j
		mov	ecx, [ebp+var_40]
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_24]
		shl	eax, 2
		add	eax, [ebp+var_20]
		mov	[esp+0A8h+var_98], 0
		mov	[esp+0A8h+var_9C], ecx
		mov	[esp+0A8h+Size], edx
		mov	[esp+0A8h+Buf2], 5
		mov	[esp+0A8h+Buf1], eax
		call	gcry_mpi_scan
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jz	short loc_409013
		mov	eax, [ebp+var_34]
		mov	[esp+0A8h+Buf1], eax
		call	gpg_strerror
		mov	[esp+0A8h+Buf2], eax ; char
		mov	[esp+0A8h+Buf1], offset	aErrorParsingKe	; "error parsing key parameter:	%s\n"
		call	sub_42091D
		jmp	loc_4090A5
; ---------------------------------------------------------------------------

loc_409013:				; CODE XREF: sub_408758+899j
		add	[ebp+var_24], 1

loc_409017:				; CODE XREF: sub_408758+861j
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_40]
		add	eax, edx
		mov	[ebp+Src], eax
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_40]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_54], eax

loc_409031:				; CODE XREF: sub_408758+7DFj
		cmp	[ebp+var_18], 0
		jz	short loc_409041
		cmp	[ebp+var_24], 8
		jle	loc_408F3C

loc_409041:				; CODE XREF: sub_408758+8DDj
		cmp	[ebp+var_18], 0
		jnz	short loc_4090A4
		mov	eax, [ebp+var_2C]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_free
		cmp	[ebp+arg_C], 0
		jz	short loc_409060
		mov	edx, [ebp+var_6C]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_409060:				; CODE XREF: sub_408758+8FEj
		mov	eax, [ebp+var_20]
		jmp	loc_409136
; ---------------------------------------------------------------------------

loc_409068:				; CODE XREF: sub_408758+5Aj
		nop
		jmp	short loc_4090A5
; ---------------------------------------------------------------------------

loc_40906B:				; CODE XREF: sub_408758+92j
		nop
		jmp	short loc_4090A5
; ---------------------------------------------------------------------------

loc_40906E:				; CODE XREF: sub_408758+F5j
		nop
		jmp	short loc_4090A5
; ---------------------------------------------------------------------------

loc_409071:				; CODE XREF: sub_408758+13Ej
		nop
		jmp	short loc_4090A5
; ---------------------------------------------------------------------------

loc_409074:				; CODE XREF: sub_408758+176j
		nop
		jmp	short loc_4090A5
; ---------------------------------------------------------------------------

loc_409077:				; CODE XREF: sub_408758+1B5j
		nop
		jmp	short loc_4090A5
; ---------------------------------------------------------------------------

loc_40907A:				; CODE XREF: sub_408758+235j
		nop
		jmp	short loc_4090A5
; ---------------------------------------------------------------------------

loc_40907D:				; CODE XREF: sub_408758+26Dj
		nop
		jmp	short loc_4090A5
; ---------------------------------------------------------------------------

loc_409080:				; CODE XREF: sub_408758+2A5j
		nop
		jmp	short loc_4090A5
; ---------------------------------------------------------------------------

loc_409083:				; CODE XREF: sub_408758+2DDj
		nop
		jmp	short loc_4090A5
; ---------------------------------------------------------------------------

loc_409086:				; CODE XREF: sub_408758+35Dj
		nop
		jmp	short loc_4090A5
; ---------------------------------------------------------------------------

loc_409089:				; CODE XREF: sub_408758+395j
		nop
		jmp	short loc_4090A5
; ---------------------------------------------------------------------------

loc_40908C:				; CODE XREF: sub_408758+418j
		nop
		jmp	short loc_4090A5
; ---------------------------------------------------------------------------

loc_40908F:				; CODE XREF: sub_408758+49Aj
		nop
		jmp	short loc_4090A5
; ---------------------------------------------------------------------------

loc_409092:				; CODE XREF: sub_408758+671j
		nop
		jmp	short loc_4090A5
; ---------------------------------------------------------------------------

loc_409095:				; CODE XREF: sub_408758+67Dj
		nop
		jmp	short loc_4090A5
; ---------------------------------------------------------------------------

loc_409098:				; CODE XREF: sub_408758+6E9j
		nop
		jmp	short loc_4090A5
; ---------------------------------------------------------------------------

loc_40909B:				; CODE XREF: sub_408758+706j
		nop
		jmp	short loc_4090A5
; ---------------------------------------------------------------------------

loc_40909E:				; CODE XREF: sub_408758+822j
		nop
		jmp	short loc_4090A5
; ---------------------------------------------------------------------------

loc_4090A1:				; CODE XREF: sub_408758+836j
		nop
		jmp	short loc_4090A5
; ---------------------------------------------------------------------------

loc_4090A4:				; CODE XREF: sub_408758+8EDj
		nop

loc_4090A5:				; CODE XREF: sub_408758+66j
					; sub_408758+71j ...
		mov	eax, [ebp+var_1C]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_free
		cmp	[ebp+var_20], 0
		jz	short loc_4090F0
		mov	[ebp+var_28], 0
		jmp	short loc_4090D6
; ---------------------------------------------------------------------------

loc_4090BF:				; CODE XREF: sub_408758+98Bj
		mov	eax, [ebp+var_28]
		shl	eax, 2
		add	eax, [ebp+var_20]
		mov	eax, [eax]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_mpi_release
		add	[ebp+var_28], 1

loc_4090D6:				; CODE XREF: sub_408758+965j
		mov	eax, [ebp+var_28]
		shl	eax, 2
		add	eax, [ebp+var_20]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4090BF
		mov	eax, [ebp+var_20]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_free

loc_4090F0:				; CODE XREF: sub_408758+95Cj
		mov	eax, [ebp+var_2C]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_free
		mov	eax, [ebp+Src]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, [ebp+arg_8]
		mov	[esp+0A8h+Size], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+0A8h+Buf2], eax ; char
		mov	[esp+0A8h+Buf1], offset	aDataErrorAtSOf	; "data	error at \"%s\", offset	%u\n"
		call	sub_42091D
		cmp	[ebp+arg_C], 0
		jz	short loc_409131
		mov	edx, [ebp+var_6C]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_409131:				; CODE XREF: sub_408758+9CFj
		mov	eax, 0

loc_409136:				; CODE XREF: sub_408758+90Bj
		add	esp, 0A4h
		pop	ebx
		pop	ebp
		retn
sub_408758	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40913F	proc near		; CODE XREF: sub_402637+DCp

Buf1		= dword	ptr -78h
Buf2		= dword	ptr -74h
Size		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= byte ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 74h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [ebp+var_48],	eax
		mov	[ebp+var_4C], 0
		mov	[ebp+var_1C], 0
		mov	dword ptr [ebp+var_10],	offset aPfx ; "pfx"
		lea	eax, [ebp+var_40]
		mov	[esp+78h+Size],	eax
		lea	eax, [ebp+var_48]
		mov	[esp+78h+Buf2],	eax
		lea	eax, [ebp+var_44]
		mov	[esp+78h+Buf1],	eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_4096FD
		mov	eax, [ebp+var_38]
		cmp	eax, 10h
		jnz	loc_409700
		mov	dword ptr [ebp+var_10],	offset aPfxversion ; "pfxVersion"
		lea	eax, [ebp+var_40]
		mov	[esp+78h+Size],	eax
		lea	eax, [ebp+var_48]
		mov	[esp+78h+Buf2],	eax
		lea	eax, [ebp+var_44]
		mov	[esp+78h+Buf1],	eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_409703
		mov	eax, [ebp+var_38]
		cmp	eax, 2
		jnz	loc_40972E
		mov	eax, [ebp+var_34]
		cmp	eax, 1
		jnz	loc_40972E
		mov	eax, [ebp+var_44]
		movzx	eax, byte ptr [eax]
		cmp	al, 3
		jnz	loc_40972E
		mov	eax, [ebp+var_44]
		add	eax, 1
		mov	[ebp+var_44], eax
		mov	eax, dword ptr [ebp+var_48]
		sub	eax, 1
		mov	dword ptr [ebp+var_48],	eax
		mov	dword ptr [ebp+var_10],	offset aAuthsave ; "authSave"
		lea	eax, [ebp+var_40]
		mov	[esp+78h+Size],	eax
		lea	eax, [ebp+var_48]
		mov	[esp+78h+Buf2],	eax
		lea	eax, [ebp+var_44]
		mov	[esp+78h+Buf1],	eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_409706
		mov	eax, [ebp+var_38]
		cmp	eax, 10h
		jnz	loc_409709
		lea	eax, [ebp+var_40]
		mov	[esp+78h+Size],	eax
		lea	eax, [ebp+var_48]
		mov	[esp+78h+Buf2],	eax
		lea	eax, [ebp+var_44]
		mov	[esp+78h+Buf1],	eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_40970C
		mov	eax, [ebp+var_38]
		cmp	eax, 6
		jnz	loc_40972E
		mov	eax, [ebp+var_34]
		cmp	eax, 9
		jnz	loc_40972E
		mov	eax, [ebp+var_44]
		mov	[esp+78h+Size],	9 ; Size
		mov	[esp+78h+Buf2],	offset dword_42AE60 ; Buf2
		mov	[esp+78h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	loc_40972E
		mov	eax, [ebp+var_44]
		add	eax, 9
		mov	[ebp+var_44], eax
		mov	eax, dword ptr [ebp+var_48]
		sub	eax, 9
		mov	dword ptr [ebp+var_48],	eax
		lea	eax, [ebp+var_40]
		mov	[esp+78h+Size],	eax
		lea	eax, [ebp+var_48]
		mov	[esp+78h+Buf2],	eax
		lea	eax, [ebp+var_44]
		mov	[esp+78h+Buf1],	eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_40970F
		mov	eax, [ebp+var_40]
		cmp	eax, 2
		jnz	loc_40972E
		mov	eax, [ebp+var_38]
		test	eax, eax
		jnz	loc_40972E
		lea	eax, [ebp+var_40]
		mov	[esp+78h+Size],	eax
		lea	eax, [ebp+var_48]
		mov	[esp+78h+Buf2],	eax
		lea	eax, [ebp+var_44]
		mov	[esp+78h+Buf1],	eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_409712
		mov	eax, [ebp+var_40]
		test	eax, eax
		jnz	loc_40972E
		mov	eax, [ebp+var_38]
		cmp	eax, 4
		jnz	loc_40972E
		mov	eax, [ebp+var_3C]
		test	eax, eax
		jz	short loc_409354
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jz	short loc_409354
		mov	dword ptr [ebp+var_10],	offset aCramBags ; "cram-bags"
		mov	eax, [ebp+var_44]
		mov	[esp+78h+Size],	0
		lea	edx, [ebp+var_48]
		mov	[esp+78h+Buf2],	edx
		mov	[esp+78h+Buf1],	eax
		call	sub_406CE6
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_409715
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+var_44], eax

loc_409354:				; CODE XREF: sub_40913F+1D2j
					; sub_40913F+1D9j
		mov	dword ptr [ebp+var_10],	offset aBags ; "bags"
		lea	eax, [ebp+var_40]
		mov	[esp+78h+Size],	eax
		lea	eax, [ebp+var_48]
		mov	[esp+78h+Buf2],	eax
		lea	eax, [ebp+var_44]
		mov	[esp+78h+Buf1],	eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_409718
		mov	eax, [ebp+var_40]
		test	eax, eax
		jnz	loc_40972E
		mov	eax, [ebp+var_38]
		cmp	eax, 10h
		jnz	loc_40972E
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_34]
		mov	[ebp+var_14], eax
		jmp	loc_4096D3
; ---------------------------------------------------------------------------

loc_4093A4:				; CODE XREF: sub_40913F+598j
					; sub_40913F+5A2j
		mov	dword ptr [ebp+var_10],	offset aBagSequence ; "bag-sequence"
		lea	eax, [ebp+var_40]
		mov	[esp+78h+Size],	eax
		lea	eax, [ebp+var_48]
		mov	[esp+78h+Buf2],	eax
		lea	eax, [ebp+var_44]
		mov	[esp+78h+Buf1],	eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_40971B
		cmp	[ebp+var_24], 0
		jz	short loc_4093EB
		mov	eax, [ebp+var_40]
		test	eax, eax
		jnz	short loc_4093EB
		mov	eax, [ebp+var_38]
		test	eax, eax
		jnz	short loc_4093EB
		mov	eax, [ebp+var_3C]
		test	eax, eax
		jz	loc_4096E9

loc_4093EB:				; CODE XREF: sub_40913F+291j
					; sub_40913F+298j ...
		mov	eax, [ebp+var_40]
		test	eax, eax
		jnz	loc_40972E
		mov	eax, [ebp+var_38]
		cmp	eax, 10h
		jnz	loc_40972E
		cmp	[ebp+var_24], 0
		jnz	short loc_409437
		mov	eax, [ebp+var_30]
		cmp	eax, [ebp+var_14]
		jg	loc_40971E
		mov	eax, [ebp+var_30]
		sub	[ebp+var_14], eax
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_34]
		cmp	edx, eax
		jb	loc_409721
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_34]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax

loc_409437:				; CODE XREF: sub_40913F+2C7j
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_34]
		mov	[ebp+var_18], eax
		lea	eax, [ebp+var_40]
		mov	[esp+78h+Size],	eax
		lea	eax, [ebp+var_48]
		mov	[esp+78h+Buf2],	eax ; char
		lea	eax, [ebp+var_44]
		mov	[esp+78h+Buf1],	eax
		call	sub_406ACC
		test	eax, eax
		jnz	loc_409724
		cmp	[ebp+var_28], 0
		jz	short loc_409472
		mov	eax, [ebp+var_30]
		mov	[ebp+var_18], eax
		jmp	short loc_409478
; ---------------------------------------------------------------------------

loc_409472:				; CODE XREF: sub_40913F+329j
		mov	eax, [ebp+var_30]
		sub	[ebp+var_18], eax

loc_409478:				; CODE XREF: sub_40913F+331j
		mov	eax, [ebp+var_38]
		cmp	eax, 6
		jnz	loc_409557
		mov	eax, [ebp+var_34]
		cmp	eax, 9
		jnz	loc_409557
		mov	eax, [ebp+var_44]
		mov	[esp+78h+Size],	9 ; Size
		mov	[esp+78h+Buf2],	offset dword_42AE69 ; Buf2
		mov	[esp+78h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	loc_409557
		mov	[ebp+var_50], 0
		mov	eax, [ebp+var_44]
		add	eax, 9
		mov	[ebp+var_44], eax
		mov	eax, dword ptr [ebp+var_48]
		sub	eax, 9
		mov	dword ptr [ebp+var_48],	eax
		cmp	[ebp+var_28], 0
		jnz	short loc_4094DB
		mov	eax, [ebp+var_18]
		sub	eax, 9
		mov	[ebp+var_18], eax

loc_4094DB:				; CODE XREF: sub_40913F+391j
		mov	dword ptr [ebp+var_10],	offset aBag_encrypte_2 ; "bag.encryptedData"
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	short loc_4094EE
		lea	eax, [ebp+var_4C]
		jmp	short loc_4094F3
; ---------------------------------------------------------------------------

loc_4094EE:				; CODE XREF: sub_40913F+3A8j
		mov	eax, 0

loc_4094F3:				; CODE XREF: sub_40913F+3ADj
		mov	edx, [ebp+var_44]
		mov	ecx, edx
		mov	edx, [ebp+var_C]
		mov	ebx, ecx
		sub	ebx, edx
		mov	ecx, dword ptr [ebp+var_48]
		mov	edx, [ebp+var_44]
		mov	[esp+78h+var_5C], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+78h+var_60], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+78h+var_64], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+78h+var_68], eax
		lea	eax, [ebp+var_50]
		mov	[esp+78h+var_6C], eax
		mov	[esp+78h+Size],	ebx
		mov	[esp+78h+Buf2],	ecx
		mov	[esp+78h+Buf1],	edx
		call	sub_4077C8
		test	eax, eax
		jnz	loc_409727
		cmp	[ebp+var_28], 0
		jz	loc_409665
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_50]
		add	eax, edx
		mov	[ebp+var_18], eax
		jmp	loc_409665
; ---------------------------------------------------------------------------

loc_409557:				; CODE XREF: sub_40913F+33Fj
					; sub_40913F+34Bj ...
		mov	eax, [ebp+var_38]
		cmp	eax, 6
		jnz	loc_40963D
		mov	eax, [ebp+var_34]
		cmp	eax, 9
		jnz	loc_40963D
		mov	eax, [ebp+var_44]
		mov	[esp+78h+Size],	9 ; Size
		mov	[esp+78h+Buf2],	offset dword_42AE60 ; char
		mov	[esp+78h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	loc_40963D
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jz	short loc_4095C4
		mov	[esp+78h+Buf1],	offset aAlreadyGotAnKe ; "already got an key object, skipping thi"...
		call	sub_4208F3
		mov	edx, [ebp+var_44]
		mov	eax, [ebp+var_34]
		add	eax, edx
		mov	[ebp+var_44], eax
		mov	edx, dword ptr [ebp+var_48]
		mov	eax, [ebp+var_34]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	dword ptr [ebp+var_48],	eax
		jmp	loc_409668
; ---------------------------------------------------------------------------

loc_4095C4:				; CODE XREF: sub_40913F+458j
		mov	[ebp+var_54], 0
		mov	eax, [ebp+var_44]
		add	eax, 9
		mov	[ebp+var_44], eax
		mov	eax, dword ptr [ebp+var_48]
		sub	eax, 9
		mov	dword ptr [ebp+var_48],	eax
		cmp	[ebp+var_28], 0
		jnz	short loc_4095EC
		mov	eax, [ebp+var_18]
		sub	eax, 9
		mov	[ebp+var_18], eax

loc_4095EC:				; CODE XREF: sub_40913F+4A2j
		mov	eax, [ebp+var_44]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	ebx, edx
		sub	ebx, eax
		mov	edx, dword ptr [ebp+var_48]
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+arg_8]
		mov	[esp+78h+var_68], ecx
		lea	ecx, [ebp+var_54]
		mov	[esp+78h+var_6C], ecx
		mov	[esp+78h+Size],	ebx
		mov	[esp+78h+Buf2],	edx
		mov	[esp+78h+Buf1],	eax
		call	sub_408758
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jz	loc_40972A
		cmp	[ebp+var_28], 0
		jz	short loc_409668
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_54]
		add	eax, edx
		mov	[ebp+var_18], eax
		jmp	short loc_409668
; ---------------------------------------------------------------------------

loc_40963D:				; CODE XREF: sub_40913F+41Ej
					; sub_40913F+42Aj ...
		mov	[esp+78h+Buf1],	offset aUnknownBagType ; "unknown bag type - skipped\n"
		call	sub_4208F3
		mov	edx, [ebp+var_44]
		mov	eax, [ebp+var_34]
		add	eax, edx
		mov	[ebp+var_44], eax
		mov	edx, dword ptr [ebp+var_48]
		mov	eax, [ebp+var_34]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	dword ptr [ebp+var_48],	eax
		jmp	short loc_409669
; ---------------------------------------------------------------------------

loc_409665:				; CODE XREF: sub_40913F+402j
					; sub_40913F+413j
		nop
		jmp	short loc_409669
; ---------------------------------------------------------------------------

loc_409668:				; CODE XREF: sub_40913F+480j
					; sub_40913F+4EFj ...
		nop

loc_409669:				; CODE XREF: sub_40913F+524j
					; sub_40913F+527j
		cmp	[ebp+var_18], 0
		js	loc_40972E
		mov	edx, [ebp+var_18]
		mov	eax, dword ptr [ebp+var_48]
		cmp	edx, eax
		ja	loc_40972E
		mov	edx, [ebp+var_44]
		mov	eax, [ebp+var_18]
		add	eax, edx
		mov	[ebp+var_44], eax
		mov	edx, dword ptr [ebp+var_48]
		mov	eax, [ebp+var_18]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	dword ptr [ebp+var_48],	eax
		cmp	[ebp+var_28], 0
		jz	short loc_4096D3
		lea	eax, [ebp+var_40]
		mov	[esp+78h+Size],	eax
		lea	eax, [ebp+var_48]
		mov	[esp+78h+Buf2],	eax
		lea	eax, [ebp+var_44]
		mov	[esp+78h+Buf1],	eax
		call	sub_406ACC
		test	eax, eax
		jnz	short loc_40972D
		mov	eax, [ebp+var_40]
		test	eax, eax
		jnz	short loc_40972E
		mov	eax, [ebp+var_38]
		test	eax, eax
		jnz	short loc_40972E
		mov	eax, [ebp+var_3C]
		test	eax, eax
		jnz	short loc_40972E

loc_4096D3:				; CODE XREF: sub_40913F+260j
					; sub_40913F+560j
		cmp	[ebp+var_14], 0
		jnz	loc_4093A4
		cmp	[ebp+var_24], 0
		jnz	loc_4093A4
		jmp	short loc_4096EA
; ---------------------------------------------------------------------------

loc_4096E9:				; CODE XREF: sub_40913F+2A6j
		nop

loc_4096EA:				; CODE XREF: sub_40913F+5A8j
		mov	eax, [ebp+var_1C]
		mov	[esp+78h+Buf1],	eax
		call	gcry_free
		mov	eax, [ebp+var_4C]
		jmp	loc_4097A8
; ---------------------------------------------------------------------------

loc_4096FD:				; CODE XREF: sub_40913F+49j
		nop
		jmp	short loc_40972E
; ---------------------------------------------------------------------------

loc_409700:				; CODE XREF: sub_40913F+55j
		nop
		jmp	short loc_40972E
; ---------------------------------------------------------------------------

loc_409703:				; CODE XREF: sub_40913F+7Dj
		nop
		jmp	short loc_40972E
; ---------------------------------------------------------------------------

loc_409706:				; CODE XREF: sub_40913F+DDj
		nop
		jmp	short loc_40972E
; ---------------------------------------------------------------------------

loc_409709:				; CODE XREF: sub_40913F+E9j
		nop
		jmp	short loc_40972E
; ---------------------------------------------------------------------------

loc_40970C:				; CODE XREF: sub_40913F+10Aj
		nop
		jmp	short loc_40972E
; ---------------------------------------------------------------------------

loc_40970F:				; CODE XREF: sub_40913F+178j
		nop
		jmp	short loc_40972E
; ---------------------------------------------------------------------------

loc_409712:				; CODE XREF: sub_40913F+1B0j
		nop
		jmp	short loc_40972E
; ---------------------------------------------------------------------------

loc_409715:				; CODE XREF: sub_40913F+203j
		nop
		jmp	short loc_40972E
; ---------------------------------------------------------------------------

loc_409718:				; CODE XREF: sub_40913F+237j
		nop
		jmp	short loc_40972E
; ---------------------------------------------------------------------------

loc_40971B:				; CODE XREF: sub_40913F+287j
		nop
		jmp	short loc_40972E
; ---------------------------------------------------------------------------

loc_40971E:				; CODE XREF: sub_40913F+2CFj
		nop
		jmp	short loc_40972E
; ---------------------------------------------------------------------------

loc_409721:				; CODE XREF: sub_40913F+2E3j
		nop
		jmp	short loc_40972E
; ---------------------------------------------------------------------------

loc_409724:				; CODE XREF: sub_40913F+31Fj
		nop
		jmp	short loc_40972E
; ---------------------------------------------------------------------------

loc_409727:				; CODE XREF: sub_40913F+3F8j
		nop
		jmp	short loc_40972E
; ---------------------------------------------------------------------------

loc_40972A:				; CODE XREF: sub_40913F+4E5j
		nop
		jmp	short loc_40972E
; ---------------------------------------------------------------------------

loc_40972D:				; CODE XREF: sub_40913F+57Dj
		nop

loc_40972E:				; CODE XREF: sub_40913F+89j
					; sub_40913F+95j ...
		mov	eax, [ebp+var_44]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[esp+78h+Size],	eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+78h+Buf2],	eax ; char
		mov	[esp+78h+Buf1],	offset aErrorAtSOffset ; "error	at \"%s\", offset %u\n"
		call	sub_42091D
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jz	short loc_409798
		mov	[ebp+var_20], 0
		jmp	short loc_40977C
; ---------------------------------------------------------------------------

loc_409763:				; CODE XREF: sub_40913F+64Cj
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_20]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+78h+Buf1],	eax
		call	gcry_mpi_release
		add	[ebp+var_20], 1

loc_40977C:				; CODE XREF: sub_40913F+622j
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_20]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_409763
		mov	eax, [ebp+var_4C]
		mov	[esp+78h+Buf1],	eax
		call	gcry_free

loc_409798:				; CODE XREF: sub_40913F+619j
		mov	eax, [ebp+var_1C]
		mov	[esp+78h+Buf1],	eax
		call	gcry_free
		mov	eax, 0

loc_4097A8:				; CODE XREF: sub_40913F+5B9j
		add	esp, 74h
		pop	ebx
		pop	ebp
		retn
sub_40913F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4097AE	proc near		; CODE XREF: sub_409888+4Ep
					; sub_409888+68p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_0], 7Fh
		ja	short loc_4097C7
		add	[ebp+var_C], 2
		jmp	short loc_4097F8
; ---------------------------------------------------------------------------

loc_4097C7:				; CODE XREF: sub_4097AE+11j
		cmp	[ebp+arg_0], 0FFh
		ja	short loc_4097D6
		add	[ebp+var_C], 3
		jmp	short loc_4097F8
; ---------------------------------------------------------------------------

loc_4097D6:				; CODE XREF: sub_4097AE+20j
		cmp	[ebp+arg_0], 0FFFFh
		ja	short loc_4097E5
		add	[ebp+var_C], 4
		jmp	short loc_4097F8
; ---------------------------------------------------------------------------

loc_4097E5:				; CODE XREF: sub_4097AE+2Fj
		mov	[esp+28h+var_28], offset aObjectTooLarge ; "object too larger to encode\n"
		call	sub_42091D
		mov	eax, 0
		jmp	short locret_4097FB
; ---------------------------------------------------------------------------

loc_4097F8:				; CODE XREF: sub_4097AE+17j
					; sub_4097AE+26j ...
		mov	eax, [ebp+var_C]

locret_4097FB:				; CODE XREF: sub_4097AE+48j
		leave
		retn
sub_4097AE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4097FD	proc near		; CODE XREF: sub_409888+11Bp
					; sub_409888+156p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 10h
		jnz	short loc_40980A
		or	[ebp+arg_4], 20h

loc_40980A:				; CODE XREF: sub_4097FD+7j
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		cmp	[ebp+arg_8], 7Fh
		ja	short loc_40982E
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		jmp	short loc_409883
; ---------------------------------------------------------------------------

loc_40982E:				; CODE XREF: sub_4097FD+1Fj
		cmp	[ebp+arg_8], 0FFh
		ja	short loc_409851
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	81h
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		jmp	short loc_409883
; ---------------------------------------------------------------------------

loc_409851:				; CODE XREF: sub_4097FD+38j
		cmp	[ebp+arg_8], 0FFFFh
		ja	short loc_409883
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	82h
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_8]
		shr	eax, 8
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1

loc_409883:				; CODE XREF: sub_4097FD+2Fj
					; sub_4097FD+52j ...
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_4097FD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409888	proc near		; CODE XREF: sub_40ABDF+4B9p

Dst		= dword	ptr -98h
Src		= dword	ptr -94h
Size		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_70		= dword	ptr -70h
var_6C		= byte ptr -6Ch
var_58		= byte ptr -58h
var_50		= dword	ptr -50h
var_48		= dword	ptr -48h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 98h
		mov	dword ptr [ebp+var_10],	0
		mov	[ebp+var_18], 1
		mov	[ebp+var_C], 0
		jmp	short loc_4098BB
; ---------------------------------------------------------------------------

loc_4098A8:				; CODE XREF: sub_409888+40j
		mov	eax, [ebp+var_C]
		shl	eax, 3
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		add	dword ptr [ebp+var_10],	eax
		add	[ebp+var_C], 1

loc_4098BB:				; CODE XREF: sub_409888+1Ej
		mov	eax, [ebp+var_C]
		shl	eax, 3
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4098A8
		mov	eax, dword ptr [ebp+var_10]
		mov	[ebp+var_38], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+98h+Dst], eax
		call	sub_4097AE
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		add	dword ptr [ebp+var_10],	eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[ebp+var_3C], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+98h+Dst], eax
		call	sub_4097AE
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		add	dword ptr [ebp+var_10],	eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[ebp+var_40], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+98h+Dst], eax
		call	sub_4097AE
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		add	dword ptr [ebp+var_10],	eax
		add	dword ptr [ebp+var_10],	0Bh
		mov	eax, dword ptr [ebp+var_10]
		mov	[ebp+var_48], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+98h+Dst], eax
		call	sub_4097AE
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		add	dword ptr [ebp+var_10],	eax
		add	dword ptr [ebp+var_10],	3
		cmp	[ebp+var_18], 0
		jz	short loc_409944
		add	dword ptr [ebp+var_10],	33h

loc_409944:				; CODE XREF: sub_409888+B6j
		mov	eax, dword ptr [ebp+var_10]
		mov	[ebp+var_50], eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+98h+Dst], eax
		call	sub_4097AE
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		add	dword ptr [ebp+var_10],	eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+98h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_409988
		mov	[esp+98h+Dst], offset aErrorAllocat_1 ;	"error allocating buffer\n"
		call	sub_42091D
		mov	eax, 0
		jmp	locret_409D41
; ---------------------------------------------------------------------------

loc_409988:				; CODE XREF: sub_409888+E8j
		mov	eax, [ebp+var_20]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_50]
		mov	[esp+98h+Size],	eax
		mov	[esp+98h+Src], 10h
		mov	eax, [ebp+var_14]
		mov	[esp+98h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	2
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	1
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	3
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_48]
		mov	[esp+98h+Size],	eax
		mov	[esp+98h+Src], 10h
		mov	eax, [ebp+var_14]
		mov	[esp+98h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_14], eax
		mov	[esp+98h+Size],	9
		mov	[esp+98h+Src], 6
		mov	eax, [ebp+var_14]
		mov	[esp+98h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	edx, ds:dword_42AE60
		mov	[eax], edx
		mov	edx, ds:dword_42AE64
		mov	[eax+4], edx
		movzx	edx, ds:byte_42AE68
		mov	[eax+8], dl
		add	[ebp+var_14], 9
		mov	eax, [ebp+var_40]
		mov	[esp+98h+Size],	eax
		mov	[esp+98h+Src], 0A0h
		mov	eax, [ebp+var_14]
		mov	[esp+98h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+98h+Size],	eax
		mov	[esp+98h+Src], 4
		mov	eax, [ebp+var_14]
		mov	[esp+98h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_38]
		mov	[esp+98h+Size],	eax
		mov	[esp+98h+Src], 10h
		mov	eax, [ebp+var_14]
		mov	[esp+98h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	short loc_409ACB
; ---------------------------------------------------------------------------

loc_409A8C:				; CODE XREF: sub_409888+250j
		mov	eax, [ebp+var_C]
		shl	eax, 3
		add	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	eax, [ebp+var_C]
		shl	eax, 3
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[esp+98h+Size],	ecx ; Size
		mov	[esp+98h+Src], edx ; Src
		mov	[esp+98h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		shl	eax, 3
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		add	[ebp+var_14], eax
		add	[ebp+var_C], 1

loc_409ACB:				; CODE XREF: sub_409888+202j
		mov	eax, [ebp+var_C]
		shl	eax, 3
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_409A8C
		cmp	[ebp+var_18], 0
		jz	loc_409D05
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_24]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_28], eax
		mov	[esp+98h+Size],	1
		mov	[esp+98h+Src], 8
		lea	eax, [ebp+var_58]
		mov	[esp+98h+Dst], eax
		call	gcry_randomize
		lea	eax, [ebp+var_6C]
		mov	[esp+98h+var_80], eax
		mov	[esp+98h+var_84], 14h
		mov	eax, [ebp+arg_4]
		mov	[esp+98h+var_88], eax
		mov	[esp+98h+var_8C], 800h
		mov	[esp+98h+Size],	8
		lea	eax, [ebp+var_58]
		mov	[esp+98h+Src], eax
		mov	[esp+98h+Dst], 3
		call	sub_406E1B
		test	eax, eax
		jz	short loc_409B60
		mov	eax, [ebp+var_20]
		mov	[esp+98h+Dst], eax
		call	gcry_free
		mov	eax, 0
		jmp	locret_409D41
; ---------------------------------------------------------------------------

loc_409B60:				; CODE XREF: sub_409888+2C1j
		mov	[esp+98h+Size],	2
		mov	[esp+98h+Src], 2
		lea	eax, [ebp+var_70]
		mov	[esp+98h+Dst], eax
		call	gcry_md_open
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jz	short loc_409BB4
		mov	eax, [ebp+var_2C]
		mov	[esp+98h+Dst], eax
		call	gpg_strerror
		mov	[esp+98h+Src], eax ; char
		mov	[esp+98h+Dst], offset aGcry_md_openFa ;	"gcry_md_open failed: %s\n"
		call	sub_42091D
		mov	eax, [ebp+var_20]
		mov	[esp+98h+Dst], eax
		call	gcry_free
		mov	eax, 0
		jmp	locret_409D41
; ---------------------------------------------------------------------------

loc_409BB4:				; CODE XREF: sub_409888+2FAj
		mov	eax, [ebp+var_70]
		mov	[esp+98h+Size],	14h
		lea	edx, [ebp+var_6C]
		mov	[esp+98h+Src], edx
		mov	[esp+98h+Dst], eax
		call	gcry_md_setkey
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jz	short loc_409C12
		mov	eax, [ebp+var_2C]
		mov	[esp+98h+Dst], eax
		call	gpg_strerror
		mov	[esp+98h+Src], eax ; char
		mov	[esp+98h+Dst], offset aGcry_md_setkey ;	"gcry_md_setkey	failed:	%s\n"
		call	sub_42091D
		mov	eax, [ebp+var_70]
		mov	[esp+98h+Dst], eax
		call	gcry_md_close
		mov	eax, [ebp+var_20]
		mov	[esp+98h+Dst], eax
		call	gcry_free
		mov	eax, 0
		jmp	locret_409D41
; ---------------------------------------------------------------------------

loc_409C12:				; CODE XREF: sub_409888+34Dj
		mov	eax, [ebp+var_70]
		mov	edx, [ebp+var_28]
		mov	[esp+98h+Size],	edx
		mov	edx, [ebp+var_24]
		mov	[esp+98h+Src], edx
		mov	[esp+98h+Dst], eax
		call	gcry_md_write
		mov	eax, [ebp+var_14]
		mov	edx, ds:dword_42AF20
		mov	[eax], edx
		mov	edx, ds:dword_42AF24
		mov	[eax+4], edx
		mov	edx, ds:dword_42AF28
		mov	[eax+8], edx
		mov	edx, ds:dword_42AF2C
		mov	[eax+0Ch], edx
		mov	edx, ds:dword_42AF30
		mov	[eax+10h], edx
		mov	edx, ds:dword_42AF34
		mov	[eax+14h], edx
		mov	edx, ds:dword_42AF38
		mov	[eax+18h], edx
		mov	edx, ds:dword_42AF3C
		mov	[eax+1Ch], edx
		mov	edx, ds:dword_42AF40
		mov	[eax+20h], edx
		mov	edx, ds:dword_42AF44
		mov	[eax+24h], edx
		mov	edx, ds:dword_42AF48
		mov	[eax+28h], edx
		mov	edx, ds:dword_42AF4C
		mov	[eax+2Ch], edx
		movzx	edx, ds:word_42AF50
		mov	[eax+30h], dx
		movzx	edx, ds:byte_42AF52
		mov	[eax+32h], dl
		mov	eax, [ebp+var_14]
		lea	ecx, [eax+27h]
		lea	eax, [ebp+var_58]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	eax, [ebp+var_70]
		mov	[esp+98h+Src], 0
		mov	[esp+98h+Dst], eax
		call	gcry_md_read
		mov	edx, [ebp+var_14]
		add	edx, 11h
		mov	ecx, [eax]
		mov	[edx], ecx
		mov	ecx, [eax+4]
		mov	[edx+4], ecx
		mov	ecx, [eax+8]
		mov	[edx+8], ecx
		mov	ecx, [eax+0Ch]
		mov	[edx+0Ch], ecx
		mov	eax, [eax+10h]
		mov	[edx+10h], eax
		add	[ebp+var_14], 33h
		mov	eax, [ebp+var_70]
		mov	[esp+98h+Dst], eax
		call	gcry_md_close

loc_409D05:				; CODE XREF: sub_409888+256j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_20]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_30], eax
		mov	eax, dword ptr [ebp+var_10]
		cmp	eax, [ebp+var_30]
		jz	short loc_409D36
		mov	eax, [ebp+var_30]
		mov	[esp+98h+Size],	eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+98h+Src], eax ; char
		mov	[esp+98h+Dst], offset aLengthMismatch ;	"length	mismatch: %lu, %lu\n"
		call	sub_4209BA

loc_409D36:				; CODE XREF: sub_409888+492j
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_30]
		mov	[eax], edx
		mov	eax, [ebp+var_20]

locret_409D41:				; CODE XREF: sub_409888+FBj
					; sub_409888+2D3j ...
		leave
		retn
sub_409888	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409D43	proc near		; CODE XREF: sub_40ABDF+37Dp

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_10], 3
		mov	[ebp+var_C], 0
		jmp	loc_409DF2
; ---------------------------------------------------------------------------

loc_409D5C:				; CODE XREF: sub_409D43+BCj
		mov	[ebp+var_34], 0
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+58h+var_48], eax
		lea	eax, [ebp+var_34]
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], 0 ; char
		mov	[esp+58h+var_58], 1
		call	gcry_mpi_print
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_409DC3
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	[esp+58h+var_54], eax ;	char
		mov	[esp+58h+var_58], offset aErrorFormattin ; "error formatting parameter:	%s\n"
		call	sub_42091D
		mov	eax, 0
		jmp	locret_40A1A2
; ---------------------------------------------------------------------------

loc_409DC3:				; CODE XREF: sub_409D43+59j
		mov	eax, [ebp+var_34]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_34]
		mov	[esp+58h+var_58], eax
		call	sub_4097AE
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_34]
		test	eax, eax
		jnz	short loc_409DE8
		mov	eax, 0
		jmp	locret_40A1A2
; ---------------------------------------------------------------------------

loc_409DE8:				; CODE XREF: sub_409D43+99j
		mov	eax, [ebp+var_34]
		add	[ebp+var_10], eax
		add	[ebp+var_C], 1

loc_409DF2:				; CODE XREF: sub_409D43+14j
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_409D5C
		cmp	[ebp+var_C], 8
		jz	short loc_409E21
		mov	[esp+58h+var_58], offset aInvalidParamet ; "invalid parameters for p12_build\n"
		call	sub_42091D
		mov	eax, 0
		jmp	locret_40A1A2
; ---------------------------------------------------------------------------

loc_409E21:				; CODE XREF: sub_409D43+C6j
		mov	eax, [ebp+var_10]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_4097AE
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_34]
		test	eax, eax
		jnz	short loc_409E46
		mov	eax, 0
		jmp	locret_40A1A2
; ---------------------------------------------------------------------------

loc_409E46:				; CODE XREF: sub_409D43+F7j
		mov	eax, [ebp+var_34]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_4097AE
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_34]
		test	eax, eax
		jnz	short loc_409E71
		mov	eax, 0
		jmp	locret_40A1A2
; ---------------------------------------------------------------------------

loc_409E71:				; CODE XREF: sub_409D43+122j
		mov	eax, [ebp+var_34]
		add	[ebp+var_10], eax
		mov	[ebp+var_28], 0Dh
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_28]
		add	eax, edx
		add	eax, 2
		mov	[ebp+var_10], eax
		add	[ebp+var_10], 3
		mov	eax, [ebp+var_10]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_4097AE
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_34]
		test	eax, eax
		jnz	short loc_409EB5
		mov	eax, 0
		jmp	locret_40A1A2
; ---------------------------------------------------------------------------

loc_409EB5:				; CODE XREF: sub_409D43+166j
		mov	eax, [ebp+var_34]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		add	eax, 8
		mov	[esp+58h+var_58], eax
		call	gcry_malloc_secure
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	short loc_409EE8
		mov	[esp+58h+var_58], offset aErrorAllocat_2 ; "error allocating encryption	buffer\n"
		call	sub_42091D
		mov	eax, 0
		jmp	locret_40A1A2
; ---------------------------------------------------------------------------

loc_409EE8:				; CODE XREF: sub_409D43+18Dj
		mov	eax, [ebp+var_30]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+var_54], 10h
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_58], eax
		call	sub_4097FD
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	2
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	1
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+var_54], 10h
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_58], eax
		call	sub_4097FD
		mov	[ebp+var_14], eax
		mov	[esp+58h+var_50], 9
		mov	[esp+58h+var_54], 6
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_58], eax
		call	sub_4097FD
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	edx, ds:dword_42AEBC
		mov	[eax], edx
		mov	edx, ds:dword_42AEC0
		mov	[eax+4], edx
		movzx	edx, ds:byte_42AEC4
		mov	[eax+8], dl
		add	[ebp+var_14], 9
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	5
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+var_54], 4
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_58], eax
		call	sub_4097FD
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_20]
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+var_54], 10h
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_58], eax
		call	sub_4097FD
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	2
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	1
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		add	[ebp+var_14], 1
		mov	[ebp+var_C], 0
		jmp	loc_40A116
; ---------------------------------------------------------------------------

loc_409FFE:				; CODE XREF: sub_409D43+3E0j
		mov	[ebp+var_34], 0
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+58h+var_48], eax
		lea	eax, [ebp+var_34]
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], 0
		mov	[esp+58h+var_54], 0
		mov	[esp+58h+var_58], 1
		call	gcry_mpi_print
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_40A070
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	[esp+58h+var_54], eax ;	char
		mov	[esp+58h+var_58], offset aOopsErrorForma ; "oops: error	formatting parameter: %s\n"
		call	sub_42091D
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, 0
		jmp	locret_40A1A2
; ---------------------------------------------------------------------------

loc_40A070:				; CODE XREF: sub_409D43+2FBj
		mov	eax, [ebp+var_34]
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+var_54], 2
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_58], eax
		call	sub_4097FD
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_30]
		add	eax, edx
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+var_34]
		mov	[esp+58h+var_48], edx
		lea	edx, [ebp+var_34]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_54], eax
		mov	[esp+58h+var_58], 1
		call	gcry_mpi_print
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_40A10C
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	[esp+58h+var_54], eax ;	char
		mov	[esp+58h+var_58], offset aOopsErrorStori ; "oops: error	storing	parameter: %s\n"
		call	sub_42091D
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	eax, 0
		jmp	locret_40A1A2
; ---------------------------------------------------------------------------

loc_40A10C:				; CODE XREF: sub_409D43+397j
		mov	eax, [ebp+var_34]
		add	[ebp+var_14], eax
		add	[ebp+var_C], 1

loc_40A116:				; CODE XREF: sub_409D43+2B6j
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_409FFE
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_30]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_18]
		jz	short loc_40A15C
		mov	[esp+58h+var_50], 6F7h ; int
		mov	[esp+58h+var_54], offset a____Gnupg22__1 ; "../../gnupg2-2.0.30/agent/minip12.c"
		mov	[esp+58h+var_58], offset aNeededPlainlen ; "needed == plainlen"
		call	sub_4276E0

loc_40A15C:				; CODE XREF: sub_409D43+3FBj
		mov	eax, [ebp+var_18]
		mov	edx, eax
		and	edx, 7
		mov	eax, 8
		sub	eax, edx
		mov	[ebp+var_34], eax
		mov	[ebp+var_C], 0
		jmp	short loc_40A18D
; ---------------------------------------------------------------------------

loc_40A177:				; CODE XREF: sub_409D43+452j
		mov	eax, [ebp+var_34]
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1
		add	[ebp+var_18], 1

loc_40A18D:				; CODE XREF: sub_409D43+432j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_34]
		cmp	edx, eax
		jb	short loc_40A177
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_18]
		mov	[eax], edx
		mov	eax, [ebp+var_30]

locret_40A1A2:				; CODE XREF: sub_409D43+7Bj
					; sub_409D43+A0j ...
		leave
		retn
sub_409D43	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40A1A4(void *, size_t, int, int, int,	int)
sub_40A1A4	proc near		; CODE XREF: sub_40ABDF+41Fp
					; sub_40ABDF+458p

Dst		= dword	ptr -68h
Src		= dword	ptr -64h
Size		= dword	ptr -60h
var_58		= dword	ptr -58h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	eax, [ebp+arg_4]
		mov	[esp+68h+Dst], eax
		call	sub_4097AE
		mov	dword ptr [ebp+var_1C],	eax
		mov	eax, [ebp+arg_4]
		add	dword ptr [ebp+var_1C],	eax
		add	dword ptr [ebp+var_1C],	1Eh
		mov	eax, dword ptr [ebp+var_1C]
		mov	[ebp+var_38], eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+68h+Dst], eax
		call	sub_4097AE
		add	dword ptr [ebp+var_1C],	eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[ebp+var_3C], eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+68h+Dst], eax
		call	sub_4097AE
		add	dword ptr [ebp+var_1C],	eax
		cmp	[ebp+arg_C], 0
		jz	short loc_40A1F7
		add	dword ptr [ebp+var_1C],	7Eh

loc_40A1F7:				; CODE XREF: sub_40A1A4+4Dj
		add	dword ptr [ebp+var_1C],	0Dh
		mov	eax, dword ptr [ebp+var_1C]
		mov	[ebp+var_44], eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+68h+Dst], eax
		call	sub_4097AE
		add	dword ptr [ebp+var_1C],	eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[ebp+var_48], eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+68h+Dst], eax
		call	sub_4097AE
		add	dword ptr [ebp+var_1C],	eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[ebp+var_4C], eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+68h+Dst], eax
		call	sub_4097AE
		add	dword ptr [ebp+var_1C],	eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[ebp+var_50], eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+68h+Dst], eax
		call	sub_4097AE
		add	dword ptr [ebp+var_1C],	eax
		add	dword ptr [ebp+var_1C],	0Bh
		mov	eax, dword ptr [ebp+var_1C]
		mov	[ebp+var_58], eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+68h+Dst], eax
		call	sub_4097AE
		add	dword ptr [ebp+var_1C],	eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+68h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_20], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_40A293
		mov	[esp+68h+Dst], offset aErrorAllocat_1 ;	"error allocating buffer\n"
		call	sub_42091D
		mov	eax, 0
		jmp	loc_40A593
; ---------------------------------------------------------------------------

loc_40A293:				; CODE XREF: sub_40A1A4+D7j
		mov	eax, [ebp+var_58]
		mov	[esp+68h+Size],	eax
		mov	[esp+68h+Src], 10h
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_20], eax
		mov	[esp+68h+Size],	9
		mov	[esp+68h+Src], 6
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	edx, ds:dword_42AE60
		mov	[eax], edx
		mov	edx, ds:dword_42AE64
		mov	[eax+4], edx
		movzx	edx, ds:byte_42AE68
		mov	[eax+8], dl
		add	[ebp+var_20], 9
		mov	eax, [ebp+var_50]
		mov	[esp+68h+Size],	eax
		mov	[esp+68h+Src], 0A0h
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_4C]
		mov	[esp+68h+Size],	eax
		mov	[esp+68h+Src], 4
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_48]
		mov	[esp+68h+Size],	eax
		mov	[esp+68h+Src], 10h
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_44]
		mov	[esp+68h+Size],	eax
		mov	[esp+68h+Src], 10h
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_20], eax
		mov	[esp+68h+Size],	0Bh
		mov	[esp+68h+Src], 6
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	edx, ds:dword_42AE7D
		mov	[eax], edx
		mov	edx, ds:dword_42AE81
		mov	[eax+4], edx
		movzx	edx, ds:word_42AE85
		mov	[eax+8], dx
		movzx	edx, ds:byte_42AE87
		mov	[eax+0Ah], dl
		add	[ebp+var_20], 0Bh
		mov	eax, [ebp+var_3C]
		mov	[esp+68h+Size],	eax
		mov	[esp+68h+Src], 0A0h
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_38]
		mov	[esp+68h+Size],	eax
		mov	[esp+68h+Src], 10h
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	edx, ds:dword_42AEC5
		mov	[eax], edx
		mov	edx, ds:dword_42AEC9
		mov	[eax+4], edx
		mov	edx, ds:dword_42AECD
		mov	[eax+8], edx
		mov	edx, ds:dword_42AED1
		mov	[eax+0Ch], edx
		mov	edx, ds:dword_42AED5
		mov	[eax+10h], edx
		mov	edx, ds:dword_42AED9
		mov	[eax+14h], edx
		mov	edx, ds:dword_42AEDD
		mov	[eax+18h], edx
		movzx	edx, ds:word_42AEE1
		mov	[eax+1Ch], dx
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_20]
		add	edx, 12h
		mov	ecx, [eax]
		mov	[edx], ecx
		mov	eax, [eax+4]
		mov	[edx+4], eax
		add	[ebp+var_20], 1Eh
		mov	eax, [ebp+arg_4]
		mov	[esp+68h+Size],	eax
		mov	[esp+68h+Src], 4
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_20], eax
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_20]
		mov	ecx, [ebp+arg_4]
		mov	[esp+68h+Size],	ecx ; Size
		mov	[esp+68h+Src], edx ; Src
		mov	[esp+68h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_4]
		add	[ebp+var_20], eax
		cmp	[ebp+arg_C], 0
		jz	loc_40A557
		mov	eax, [ebp+var_20]
		mov	edx, offset dword_42AF60
		mov	ebx, 6Ah
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_40A4B6
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_40A4B6:				; CODE XREF: sub_40A1A4+302j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_40A4CE
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_40A4CE:				; CODE XREF: sub_40A1A4+319j
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_40A4F6
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_40A4F6:				; CODE XREF: sub_40A1A4+345j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_40A504
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_40A504:				; CODE XREF: sub_40A1A4+357j
		mov	[ebp+var_24], 0
		jmp	short loc_40A527
; ---------------------------------------------------------------------------

loc_40A50D:				; CODE XREF: sub_40A1A4+387j
		mov	eax, [ebp+var_24]
		add	eax, 25h
		add	eax, eax
		add	eax, [ebp+var_20]
		mov	edx, [ebp+var_24]
		add	edx, [ebp+arg_10]
		movzx	edx, byte ptr [edx]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_40A527:				; CODE XREF: sub_40A1A4+367j
		cmp	[ebp+var_24], 7
		jle	short loc_40A50D
		add	[ebp+var_20], 6Ah
		mov	edx, [ebp+arg_C]
		mov	eax, [ebp+var_20]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	edx, [edx+10h]
		mov	[eax+10h], edx
		add	[ebp+var_20], 14h

loc_40A557:				; CODE XREF: sub_40A1A4+2E8j
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_28]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_2C], eax
		mov	eax, dword ptr [ebp+var_1C]
		cmp	eax, [ebp+var_2C]
		jz	short loc_40A588
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+Size],	eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+68h+Src], eax ; char
		mov	[esp+68h+Dst], offset aLengthMismatch ;	"length	mismatch: %lu, %lu\n"
		call	sub_4209BA

loc_40A588:				; CODE XREF: sub_40A1A4+3C8j
		mov	eax, [ebp+arg_14]
		mov	edx, [ebp+var_2C]
		mov	[eax], edx
		mov	eax, [ebp+var_28]

loc_40A593:				; CODE XREF: sub_40A1A4+EAj
		add	esp, 5Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40A1A4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40A59B(void *, size_t, int, int)
sub_40A59B	proc near		; CODE XREF: sub_40ABDF+32Bp

Dst		= dword	ptr -58h
Src		= dword	ptr -54h
Size		= dword	ptr -50h
var_3C		= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Dst], eax
		call	sub_4097AE
		mov	dword ptr [ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		add	dword ptr [ebp+var_C], eax
		add	dword ptr [ebp+var_C], 1Eh
		add	dword ptr [ebp+var_C], 0Bh
		mov	eax, dword ptr [ebp+var_C]
		mov	[ebp+var_28], eax
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+58h+Dst], eax
		call	sub_4097AE
		add	dword ptr [ebp+var_C], eax
		add	dword ptr [ebp+var_C], 3
		mov	eax, dword ptr [ebp+var_C]
		mov	[ebp+var_30], eax
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+58h+Dst], eax
		call	sub_4097AE
		add	dword ptr [ebp+var_C], eax
		mov	eax, dword ptr [ebp+var_C]
		mov	[ebp+var_34], eax
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+58h+Dst], eax
		call	sub_4097AE
		add	dword ptr [ebp+var_C], eax
		add	dword ptr [ebp+var_C], 0Bh
		mov	eax, dword ptr [ebp+var_C]
		mov	[ebp+var_3C], eax
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+58h+Dst], eax
		call	sub_4097AE
		add	dword ptr [ebp+var_C], eax
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+58h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40A645
		mov	[esp+58h+Dst], offset aErrorAllocat_1 ;	"error allocating buffer\n"
		call	sub_42091D
		mov	eax, 0
		jmp	locret_40A832
; ---------------------------------------------------------------------------

loc_40A645:				; CODE XREF: sub_40A59B+92j
		mov	eax, [ebp+var_3C]
		mov	[esp+58h+Size],	eax
		mov	[esp+58h+Src], 10h
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_14], eax
		mov	[esp+58h+Size],	9
		mov	[esp+58h+Src], 6
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	edx, ds:dword_42AE69
		mov	[eax], edx
		mov	edx, ds:dword_42AE6D
		mov	[eax+4], edx
		movzx	edx, ds:byte_42AE71
		mov	[eax+8], dl
		add	[ebp+var_14], 9
		mov	eax, [ebp+var_34]
		mov	[esp+58h+Size],	eax
		mov	[esp+58h+Src], 0A0h
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+Size],	eax
		mov	[esp+58h+Src], 10h
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	2
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	1
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Size],	eax
		mov	[esp+58h+Src], 10h
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_14], eax
		mov	[esp+58h+Size],	9
		mov	[esp+58h+Src], 6
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	edx, ds:dword_42AE60
		mov	[eax], edx
		mov	edx, ds:dword_42AE64
		mov	[eax+4], edx
		movzx	edx, ds:byte_42AE68
		mov	[eax+8], dl
		add	[ebp+var_14], 9
		mov	eax, [ebp+var_14]
		mov	edx, ds:dword_42AEE3
		mov	[eax], edx
		mov	edx, ds:dword_42AEE7
		mov	[eax+4], edx
		mov	edx, ds:dword_42AEEB
		mov	[eax+8], edx
		mov	edx, ds:dword_42AEEF
		mov	[eax+0Ch], edx
		mov	edx, ds:dword_42AEF3
		mov	[eax+10h], edx
		mov	edx, ds:dword_42AEF7
		mov	[eax+14h], edx
		mov	edx, ds:dword_42AEFB
		mov	[eax+18h], edx
		movzx	edx, ds:word_42AEFF
		mov	[eax+1Ch], dx
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_14]
		add	edx, 12h
		mov	ecx, [eax]
		mov	[edx], ecx
		mov	eax, [eax+4]
		mov	[edx+4], eax
		add	[ebp+var_14], 1Eh
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Size],	eax
		mov	[esp+58h+Src], 80h
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_14], eax
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_14]
		mov	ecx, [ebp+arg_4]
		mov	[esp+58h+Size],	ecx ; Size
		mov	[esp+58h+Src], edx ; Src
		mov	[esp+58h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_4]
		add	[ebp+var_14], eax
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, dword ptr [ebp+var_C]
		cmp	eax, [ebp+var_18]
		jz	short loc_40A827
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Size],	eax
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+58h+Src], eax ; char
		mov	[esp+58h+Dst], offset aLengthMismatch ;	"length	mismatch: %lu, %lu\n"
		call	sub_4209BA

loc_40A827:				; CODE XREF: sub_40A59B+270j
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_18]
		mov	[eax], edx
		mov	eax, [ebp+var_10]

locret_40A832:				; CODE XREF: sub_40A59B+A5j
		leave
		retn
sub_40A59B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40A834(void *, size_t, int, int, int)
sub_40A834	proc near		; CODE XREF: sub_40ABDF+2A3p

Dst		= dword	ptr -78h
Src		= dword	ptr -74h
Size		= dword	ptr -70h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_38		= dword	ptr -38h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_5C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_5C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 8
		jz	short loc_40A87D
		mov	[esp+78h+Size],	7F1h ; int
		mov	[esp+78h+Src], offset a____Gnupg22__1 ;	"../../gnupg2-2.0.30/agent/minip12.c"
		mov	[esp+78h+Dst], offset aStrlenKeyidstr ;	"strlen	(keyidstr) == 8"
		call	sub_4276E0

loc_40A87D:				; CODE XREF: sub_40A834+2Bj
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+Dst], eax
		call	sub_4097AE
		mov	dword ptr [ebp+var_1C],	eax
		mov	eax, [ebp+arg_4]
		add	dword ptr [ebp+var_1C],	eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[ebp+var_38], eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+78h+Dst], eax
		call	sub_4097AE
		add	dword ptr [ebp+var_1C],	eax
		add	dword ptr [ebp+var_1C],	0Ch
		mov	eax, dword ptr [ebp+var_1C]
		mov	[ebp+var_40], eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+78h+Dst], eax
		call	sub_4097AE
		add	dword ptr [ebp+var_1C],	eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[ebp+var_44], eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+78h+Dst], eax
		call	sub_4097AE
		add	dword ptr [ebp+var_1C],	eax
		cmp	[ebp+arg_8], 0
		jz	short loc_40A8DB
		add	dword ptr [ebp+var_1C],	7Eh

loc_40A8DB:				; CODE XREF: sub_40A834+A1j
		add	dword ptr [ebp+var_1C],	0Dh
		mov	eax, dword ptr [ebp+var_1C]
		mov	[ebp+var_4C], eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+78h+Dst], eax
		call	sub_4097AE
		add	dword ptr [ebp+var_1C],	eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[ebp+var_50], eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+78h+Dst], eax
		call	sub_4097AE
		add	dword ptr [ebp+var_1C],	eax
		mov	eax, dword ptr [ebp+var_1C]
		add	eax, 8
		mov	[esp+78h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_20], eax
		cmp	[ebp+var_2C], 0
		jnz	short loc_40A93A
		mov	[esp+78h+Dst], offset aErrorAllocat_1 ;	"error allocating buffer\n"
		call	sub_42091D
		mov	eax, 0
		jmp	loc_40ABD7
; ---------------------------------------------------------------------------

loc_40A93A:				; CODE XREF: sub_40A834+EEj
		mov	eax, [ebp+var_50]
		mov	[esp+78h+Size],	eax
		mov	[esp+78h+Src], 10h
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_4C]
		mov	[esp+78h+Size],	eax
		mov	[esp+78h+Src], 10h
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_20], eax
		mov	[esp+78h+Size],	0Bh
		mov	[esp+78h+Src], 6
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	edx, ds:dword_42AE88
		mov	[eax], edx
		mov	edx, ds:dword_42AE8C
		mov	[eax+4], edx
		movzx	edx, ds:word_42AE90
		mov	[eax+8], dx
		movzx	edx, ds:byte_42AE92
		mov	[eax+0Ah], dl
		add	[ebp+var_20], 0Bh
		mov	eax, [ebp+var_44]
		mov	[esp+78h+Size],	eax
		mov	[esp+78h+Src], 0A0h
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_40]
		mov	[esp+78h+Size],	eax
		mov	[esp+78h+Src], 10h
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_20], eax
		mov	[esp+78h+Size],	0Ah
		mov	[esp+78h+Src], 6
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	edx, ds:dword_42AEB2
		mov	[eax], edx
		mov	edx, ds:dword_42AEB6
		mov	[eax+4], edx
		movzx	edx, ds:word_42AEBA
		mov	[eax+8], dx
		add	[ebp+var_20], 0Ah
		mov	eax, [ebp+var_38]
		mov	[esp+78h+Size],	eax
		mov	[esp+78h+Src], 0A0h
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+Size],	eax
		mov	[esp+78h+Src], 4
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Dst], eax
		call	sub_4097FD
		mov	[ebp+var_20], eax
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_20]
		mov	ecx, [ebp+arg_4]
		mov	[esp+78h+Size],	ecx ; Size
		mov	[esp+78h+Src], edx ; Src
		mov	[esp+78h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_4]
		add	[ebp+var_20], eax
		cmp	[ebp+arg_8], 0
		jz	loc_40AB62
		mov	eax, [ebp+var_20]
		mov	edx, offset dword_42AF60
		mov	ebx, 6Ah
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_40AAC1
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_40AAC1:				; CODE XREF: sub_40A834+27Dj
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_40AAD9
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_40AAD9:				; CODE XREF: sub_40A834+294j
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_40AB01
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_40AB01:				; CODE XREF: sub_40A834+2C0j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_40AB0F
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_40AB0F:				; CODE XREF: sub_40A834+2D2j
		mov	[ebp+var_28], 0
		jmp	short loc_40AB32
; ---------------------------------------------------------------------------

loc_40AB18:				; CODE XREF: sub_40A834+302j
		mov	eax, [ebp+var_28]
		add	eax, 25h
		add	eax, eax
		add	eax, [ebp+var_20]
		mov	edx, [ebp+var_28]
		add	edx, [ebp+arg_C]
		movzx	edx, byte ptr [edx]
		mov	[eax], dl
		add	[ebp+var_28], 1

loc_40AB32:				; CODE XREF: sub_40A834+2E2j
		cmp	[ebp+var_28], 7
		jle	short loc_40AB18
		add	[ebp+var_20], 6Ah
		mov	edx, [ebp+arg_8]
		mov	eax, [ebp+var_20]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	edx, [edx+10h]
		mov	[eax+10h], edx
		add	[ebp+var_20], 14h

loc_40AB62:				; CODE XREF: sub_40A834+263j
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_2C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_24], eax
		mov	eax, dword ptr [ebp+var_1C]
		cmp	eax, [ebp+var_24]
		jz	short loc_40AB93
		mov	eax, [ebp+var_24]
		mov	[esp+78h+Size],	eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+78h+Src], eax ; char
		mov	[esp+78h+Dst], offset aLengthMismatch ;	"length	mismatch: %lu, %lu\n"
		call	sub_4209BA

loc_40AB93:				; CODE XREF: sub_40A834+343j
		mov	eax, [ebp+var_24]
		mov	edx, eax
		and	edx, 7
		mov	eax, 8
		sub	eax, edx
		mov	[ebp+var_30], eax
		mov	[ebp+var_28], 0
		jmp	short loc_40ABC4
; ---------------------------------------------------------------------------

loc_40ABAE:				; CODE XREF: sub_40A834+396j
		mov	eax, [ebp+var_30]
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[eax], dl
		add	[ebp+var_20], 1
		add	[ebp+var_28], 1
		add	[ebp+var_24], 1

loc_40ABC4:				; CODE XREF: sub_40A834+378j
		mov	eax, [ebp+var_28]
		cmp	eax, [ebp+var_30]
		jb	short loc_40ABAE
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_24]
		mov	[eax], edx
		mov	eax, [ebp+var_2C]

loc_40ABD7:				; CODE XREF: sub_40A834+101j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40A834	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40ABDF(int, void *, size_t, int, char, int)
sub_40ABDF	proc near		; CODE XREF: sub_402D35+507p

Dest		= dword	ptr -0C8h
Format		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_BC		= dword	ptr -0BCh
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_9C		= dword	ptr -9Ch
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_79		= byte ptr -79h
var_70		= dword	ptr -70h
var_60		= byte ptr -60h
var_5F		= byte ptr -5Fh
var_5E		= byte ptr -5Eh
var_5D		= byte ptr -5Dh
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_44		= dword	ptr -44h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= byte ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0BCh
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 0
		mov	[ebp+var_3C], 0
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_38], eax
		lea	eax, [ebp+var_70]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	dword ptr [eax+0Ch], 0
		mov	dword ptr [eax+10h], 0
		mov	[ebp+var_79], 0
		cmp	dword ptr [ebp+arg_10],	0
		jz	loc_40ADEB
		cmp	[ebp+arg_C], 0
		jz	loc_40ADEB
		mov	eax, [ebp+arg_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_40ADEB
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_9C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_9C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, eax
		add	eax, 1
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		mov	[esp+0C8h+Dest], eax
		call	gcry_malloc_secure
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_40ACB1
		mov	[esp+0C8h+Dest], offset	aOutOfSecureMem	; "out of secure memory	while converting p"...
		call	sub_42091D
		jmp	loc_40B0AC
; ---------------------------------------------------------------------------

loc_40ACB1:				; CODE XREF: sub_40ABDF+BFj
		mov	[esp+0C8h+Format], offset aUtf8	; "utf-8"
		mov	eax, dword ptr [ebp+arg_10]
		mov	[esp+0C8h+Dest], eax
		call	sub_4255E9
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0FFFFFFFFh
		jnz	short loc_40AD0C
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+0C8h+Dest], eax ; int
		call	strerror
		mov	[esp+0C8h+var_C0], eax
		mov	eax, dword ptr [ebp+arg_10]
		mov	[esp+0C8h+Format], eax ; char
		mov	[esp+0C8h+Dest], offset	aCanTConvertPas	; "can't convert passphrase to requested c"...
		call	sub_42091D
		mov	eax, [ebp+var_24]
		mov	[esp+0C8h+Dest], eax
		call	gcry_free
		mov	[ebp+var_24], 0
		jmp	loc_40B0AC
; ---------------------------------------------------------------------------

loc_40AD0C:				; CODE XREF: sub_40ABDF+ECj
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_80], eax
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_9C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_9C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_88], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_84], eax
		mov	eax, [ebp+var_28]
		sub	eax, 1
		mov	[ebp+var_8C], eax
		lea	eax, [ebp+var_8C]
		mov	[esp+0C8h+var_B8], eax
		lea	eax, [ebp+var_84]
		mov	[esp+0C8h+var_BC], eax
		lea	eax, [ebp+var_88]
		mov	[esp+0C8h+var_C0], eax
		lea	eax, [ebp+var_80]
		mov	[esp+0C8h+Format], eax
		mov	eax, [ebp+var_34]
		mov	[esp+0C8h+Dest], eax
		call	sub_425603
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40ADD1
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+0C8h+Dest], eax ; int
		call	strerror
		mov	[esp+0C8h+var_C0], eax
		mov	eax, dword ptr [ebp+arg_10]
		mov	[esp+0C8h+Format], eax ; char
		mov	[esp+0C8h+Dest], offset	aErrorConvert_0	; "error converting passphrase to requeste"...
		call	sub_42091D
		mov	eax, [ebp+var_24]
		mov	[esp+0C8h+Dest], eax
		call	gcry_free
		mov	[ebp+var_24], 0
		mov	eax, [ebp+var_34]
		mov	[esp+0C8h+Dest], eax
		call	sub_425632
		jmp	loc_40B0AC
; ---------------------------------------------------------------------------

loc_40ADD1:				; CODE XREF: sub_40ABDF+1A6j
		mov	eax, [ebp+var_84]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_34]
		mov	[esp+0C8h+Dest], eax
		call	sub_425632
		mov	eax, [ebp+var_24]
		mov	[ebp+arg_C], eax

loc_40ADEB:				; CODE XREF: sub_40ABDF+62j
					; sub_40ABDF+6Cj ...
		cmp	[ebp+arg_4], 0
		jz	loc_40AF45
		cmp	[ebp+arg_8], 0
		jz	loc_40AF45
		mov	eax, [ebp+arg_8]
		mov	[esp+0C8h+var_BC], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+var_C0], eax
		lea	eax, [ebp+var_70]
		mov	[esp+0C8h+Format], eax
		mov	[esp+0C8h+Dest], 2
		call	gcry_md_hash_buffer
		movzx	eax, [ebp+var_5D]
		movzx	esi, al
		movzx	eax, [ebp+var_5E]
		movzx	ebx, al
		movzx	eax, [ebp+var_5F]
		movzx	ecx, al
		movzx	eax, [ebp+var_60]
		movzx	edx, al
		mov	eax, offset a02x02x02x02x ; "%02x%02x%02x%02x"
		mov	[esp+0C8h+var_B4], esi
		mov	[esp+0C8h+var_B8], ebx
		mov	[esp+0C8h+var_BC], ecx
		mov	[esp+0C8h+var_C0], edx
		mov	[esp+0C8h+Format], eax ; Format
		lea	eax, [ebp+var_79]
		mov	[esp+0C8h+Dest], eax ; Dest
		call	sprintf
		lea	eax, [ebp+var_3C]
		mov	[esp+0C8h+var_B8], eax ; int
		lea	eax, [ebp+var_79]
		mov	[esp+0C8h+var_BC], eax ; int
		lea	eax, [ebp+var_70]
		mov	[esp+0C8h+var_C0], eax ; int
		mov	eax, [ebp+arg_8]
		mov	[esp+0C8h+Format], eax ; size_t
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Dest], eax ; void *
		call	sub_40A834
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_40B0A2
		mov	[esp+0C8h+var_C0], 1
		mov	[esp+0C8h+Format], 8
		lea	eax, [ebp+var_44]
		mov	[esp+0C8h+Dest], eax
		call	gcry_randomize
		mov	eax, [ebp+var_3C]
		mov	[esp+0C8h+var_AC], 1
		mov	[esp+0C8h+var_B0], 133h
		mov	edx, [ebp+arg_C]
		mov	[esp+0C8h+var_B4], edx
		mov	[esp+0C8h+var_B8], 800h
		mov	[esp+0C8h+var_BC], 8
		lea	edx, [ebp+var_44]
		mov	[esp+0C8h+var_C0], edx
		mov	[esp+0C8h+Format], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+Dest], eax
		call	sub_4073CF
		mov	eax, [ebp+var_3C]
		lea	edx, [ebp+var_38]
		mov	[esp+0C8h+var_BC], edx ; int
		lea	edx, [ebp+var_44]
		mov	[esp+0C8h+var_C0], edx ; int
		mov	[esp+0C8h+Format], eax ; size_t
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+Dest], eax ; void *
		call	sub_40A59B
		mov	edx, [ebp+var_20]
		mov	[ebp+edx*8+var_5C], eax
		mov	edx, [ebp+var_38]
		mov	eax, [ebp+var_20]
		mov	[ebp+eax*8+var_58], edx
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+Dest], eax
		call	gcry_free
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+var_20]
		mov	eax, [ebp+eax*8+var_5C]
		test	eax, eax
		jz	loc_40B0A5
		add	[ebp+var_20], 1

loc_40AF45:				; CODE XREF: sub_40ABDF+210j
					; sub_40ABDF+21Aj
		cmp	[ebp+arg_0], 0
		jz	loc_40B06E
		lea	eax, [ebp+var_3C]
		mov	[esp+0C8h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+Dest], eax
		call	sub_409D43
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_40B0A8
		mov	[esp+0C8h+var_C0], 1
		mov	[esp+0C8h+Format], 8
		lea	eax, [ebp+var_44]
		mov	[esp+0C8h+Dest], eax
		call	gcry_randomize
		mov	eax, [ebp+var_3C]
		mov	[esp+0C8h+var_AC], 1
		mov	[esp+0C8h+var_B0], 2
		mov	edx, [ebp+arg_C]
		mov	[esp+0C8h+var_B4], edx
		mov	[esp+0C8h+var_B8], 800h
		mov	[esp+0C8h+var_BC], 8
		lea	edx, [ebp+var_44]
		mov	[esp+0C8h+var_C0], edx
		mov	[esp+0C8h+Format], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+Dest], eax
		call	sub_4073CF
		cmp	[ebp+arg_4], 0
		jz	short loc_40B00C
		cmp	[ebp+arg_8], 0
		jz	short loc_40B00C
		mov	eax, [ebp+var_3C]
		lea	edx, [ebp+var_38]
		mov	[esp+0C8h+var_B4], edx ; int
		lea	edx, [ebp+var_79]
		mov	[esp+0C8h+var_B8], edx ; int
		lea	edx, [ebp+var_70]
		mov	[esp+0C8h+var_BC], edx ; int
		lea	edx, [ebp+var_44]
		mov	[esp+0C8h+var_C0], edx ; int
		mov	[esp+0C8h+Format], eax ; size_t
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+Dest], eax ; void *
		call	sub_40A1A4
		mov	edx, [ebp+var_20]
		mov	[ebp+edx*8+var_5C], eax
		jmp	short loc_40B043
; ---------------------------------------------------------------------------

loc_40B00C:				; CODE XREF: sub_40ABDF+3EEj
					; sub_40ABDF+3F4j
		mov	eax, [ebp+var_3C]
		lea	edx, [ebp+var_38]
		mov	[esp+0C8h+var_B4], edx ; int
		mov	[esp+0C8h+var_B8], 0 ; int
		mov	[esp+0C8h+var_BC], 0 ; int
		lea	edx, [ebp+var_44]
		mov	[esp+0C8h+var_C0], edx ; int
		mov	[esp+0C8h+Format], eax ; size_t
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+Dest], eax ; void *
		call	sub_40A1A4
		mov	edx, [ebp+var_20]
		mov	[ebp+edx*8+var_5C], eax

loc_40B043:				; CODE XREF: sub_40ABDF+42Bj
		mov	edx, [ebp+var_38]
		mov	eax, [ebp+var_20]
		mov	[ebp+eax*8+var_58], edx
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+Dest], eax
		call	gcry_free
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+var_20]
		mov	eax, [ebp+eax*8+var_5C]
		test	eax, eax
		jz	short loc_40B0AB
		add	[ebp+var_20], 1

loc_40B06E:				; CODE XREF: sub_40ABDF+36Aj
		mov	eax, [ebp+var_20]
		mov	[ebp+eax*8+var_5C], 0
		mov	eax, [ebp+var_20]
		mov	[ebp+eax*8+var_58], 0
		lea	eax, [ebp+var_3C]
		mov	[esp+0C8h+var_C0], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+Format], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0C8h+Dest], eax
		call	sub_409888
		mov	[ebp+var_1C], eax
		jmp	short loc_40B0AC
; ---------------------------------------------------------------------------

loc_40B0A2:				; CODE XREF: sub_40ABDF+2AFj
		nop
		jmp	short loc_40B0AC
; ---------------------------------------------------------------------------

loc_40B0A5:				; CODE XREF: sub_40ABDF+35Cj
		nop
		jmp	short loc_40B0AC
; ---------------------------------------------------------------------------

loc_40B0A8:				; CODE XREF: sub_40ABDF+389j
		nop
		jmp	short loc_40B0AC
; ---------------------------------------------------------------------------

loc_40B0AB:				; CODE XREF: sub_40ABDF+489j
		nop

loc_40B0AC:				; CODE XREF: sub_40ABDF+CDj
					; sub_40ABDF+128j ...
		cmp	[ebp+var_24], 0
		jz	short loc_40B0F4
		mov	eax, [ebp+var_24]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_30], eax
		jmp	short loc_40B0CE
; ---------------------------------------------------------------------------

loc_40B0C0:				; CODE XREF: sub_40ABDF+4F3j
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	0
		add	[ebp+var_2C], 1
		sub	[ebp+var_30], 1

loc_40B0CE:				; CODE XREF: sub_40ABDF+4DFj
		cmp	[ebp+var_30], 0
		jnz	short loc_40B0C0
		mov	eax, [ebp+var_24]
		mov	[esp+0C8h+Dest], eax
		call	gcry_free
		jmp	short loc_40B0F4
; ---------------------------------------------------------------------------

loc_40B0E1:				; CODE XREF: sub_40ABDF+519j
		mov	eax, [ebp+var_20]
		mov	eax, [ebp+eax*8+var_5C]
		mov	[esp+0C8h+Dest], eax
		call	gcry_free
		sub	[ebp+var_20], 1

loc_40B0F4:				; CODE XREF: sub_40ABDF+4D1j
					; sub_40ABDF+500j
		cmp	[ebp+var_20], 0
		jnz	short loc_40B0E1
		cmp	[ebp+var_1C], 0
		jz	short loc_40B105
		mov	eax, [ebp+var_3C]
		jmp	short loc_40B10A
; ---------------------------------------------------------------------------

loc_40B105:				; CODE XREF: sub_40ABDF+51Fj
		mov	eax, 0

loc_40B10A:				; CODE XREF: sub_40ABDF+524j
		mov	edx, [ebp+arg_14]
		mov	[edx], eax
		mov	eax, [ebp+var_1C]
		add	esp, 0BCh
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40ABDF	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B120	proc near		; CODE XREF: sub_40B147+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_40B140
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_40B145
; ---------------------------------------------------------------------------

loc_40B140:				; CODE XREF: sub_40B120+7j
		mov	eax, 0

loc_40B145:				; CODE XREF: sub_40B120+1Ej
		pop	ebp
		retn
sub_40B120	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B147	proc near		; CODE XREF: sub_40B162+Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_40B120
		leave
		retn
sub_40B147	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B162	proc near		; CODE XREF: sub_40B177+F8p
					; sub_40B283:loc_40B59Cp ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_40B147
		leave
		retn
sub_40B162	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B177	proc near		; CODE XREF: sub_4025B0+20p

var_28		= dword	ptr -28h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	eax, [ebp+arg_0]
		mov	edx, 20h
		mov	ecx, 0
		mov	ebx, eax
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_40B19E
		mov	[eax], cl
		add	eax, 1
		sub	edx, 1

loc_40B19E:				; CODE XREF: sub_40B177+1Dj
		mov	ebx, eax
		and	ebx, 2
		test	ebx, ebx
		jz	short loc_40B1B0
		mov	[eax], cx
		add	eax, 2
		sub	edx, 2

loc_40B1B0:				; CODE XREF: sub_40B177+2Ej
		mov	esi, edx
		and	esi, 0FFFFFFFCh
		mov	ebx, 0

loc_40B1BA:				; CODE XREF: sub_40B177+4Bj
		mov	[eax+ebx], ecx
		add	ebx, 4
		cmp	ebx, esi
		jb	short loc_40B1BA
		add	eax, ebx
		mov	ebx, edx
		and	ebx, 2
		test	ebx, ebx
		jz	short loc_40B1D5
		mov	[eax], cx
		add	eax, 2

loc_40B1D5:				; CODE XREF: sub_40B177+56j
		and	edx, 1
		test	edx, edx
		jz	short loc_40B1E1
		mov	[eax], cl
		add	eax, 1

loc_40B1E1:				; CODE XREF: sub_40B177+63j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+0Ch], edx
		cmp	[ebp+arg_8], 0
		jz	short loc_40B20B
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40B20B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 10h
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		jmp	short loc_40B276
; ---------------------------------------------------------------------------

loc_40B20B:				; CODE XREF: sub_40B177+77j
					; sub_40B177+81j
		cmp	[ebp+arg_8], 0
		jz	short loc_40B276
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, offset aPgp ; "PGP	"
		mov	ecx, 4
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40B252
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 20h
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0B704CEh

loc_40B252:				; CODE XREF: sub_40B177+C0j
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_28], eax
		call	gcry_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_40B276
		call	sub_40B162
		jmp	short loc_40B27B
; ---------------------------------------------------------------------------

loc_40B276:				; CODE XREF: sub_40B177+92j
					; sub_40B177+98j ...
		mov	eax, 0

loc_40B27B:				; CODE XREF: sub_40B177+FDj
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40B177	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B283	proc near		; CODE XREF: sub_4025B0+42p

File		= dword	ptr -38h
var_34		= dword	ptr -34h
Size		= dword	ptr -30h
var_28		= byte ptr -28h
var_27		= byte ptr -27h
var_26		= byte ptr -26h
var_25		= byte ptr -25h
Dst		= byte ptr -24h
var_23		= byte ptr -23h
var_22		= byte ptr -22h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_20], eax
		cmp	[ebp+arg_8], 0
		jnz	short loc_40B2BB
		cmp	[ebp+arg_4], 0
		jz	short loc_40B2B1
		mov	eax, [ebp+var_20]
		mov	[esp+38h+File],	eax ; File
		call	fflush
		test	eax, eax
		jnz	loc_40B592

loc_40B2B1:				; CODE XREF: sub_40B283+19j
		mov	eax, 0
		jmp	locret_40B5A1
; ---------------------------------------------------------------------------

loc_40B2BB:				; CODE XREF: sub_40B283+13j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		and	eax, 1
		test	eax, eax
		jnz	loc_40B369
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	loc_40B35A
		mov	eax, offset aBegin ; "-----BEGIN "
		mov	edx, [ebp+var_20]
		mov	[esp+38h+var_34], edx ;	File
		mov	[esp+38h+File],	eax ; Str
		call	fputs
		cmp	eax, 0FFFFFFFFh
		jz	loc_40B59C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+var_20]
		mov	[esp+38h+var_34], edx ;	File
		mov	[esp+38h+File],	eax ; Str
		call	fputs
		cmp	eax, 0FFFFFFFFh
		jz	loc_40B59C
		mov	eax, offset asc_42BC31 ; "-----\n"
		mov	edx, [ebp+var_20]
		mov	[esp+38h+var_34], edx ;	File
		mov	[esp+38h+File],	eax ; Str
		call	fputs
		cmp	eax, 0FFFFFFFFh
		jz	loc_40B59C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		and	eax, 20h
		test	eax, eax
		jz	short loc_40B35A
		mov	eax, offset asc_42BC38 ; "\n"
		mov	edx, [ebp+var_20]
		mov	[esp+38h+var_34], edx ;	File
		mov	[esp+38h+File],	eax ; Str
		call	fputs
		cmp	eax, 0FFFFFFFFh
		jz	loc_40B595

loc_40B35A:				; CODE XREF: sub_40B283+50j
					; sub_40B283+B8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_40B369:				; CODE XREF: sub_40B283+42j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_C], 3
		jle	short loc_40B39D
		mov	[esp+38h+Size],	0CFh ; int
		mov	[esp+38h+var_34], offset a____Gnupg22__2 ; "../../gnupg2-2.0.30/common/b64enc.c"
		mov	[esp+38h+File],	offset aIdx4 ; "idx < 4"
		call	sub_4276E0

loc_40B39D:				; CODE XREF: sub_40B283+FCj
		mov	ecx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		add	eax, 14h
		mov	edx, eax
		lea	eax, [ebp+Dst]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+var_34], edx ;	Src
		mov	[esp+38h+File],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		and	eax, 20h
		test	eax, eax
		jz	short loc_40B425
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_18], eax
		jmp	short loc_40B40E
; ---------------------------------------------------------------------------

loc_40B3DE:				; CODE XREF: sub_40B283+18Fj
		mov	eax, [ebp+var_1C]
		mov	edx, eax
		shl	edx, 8
		mov	eax, [ebp+var_1C]
		shr	eax, 10h
		movzx	ecx, al
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		xor	eax, ecx
		mov	eax, ds:dword_42B820[eax*4]
		xor	eax, edx
		mov	[ebp+var_1C], eax
		add	[ebp+var_14], 1
		sub	[ebp+var_18], 1

loc_40B40E:				; CODE XREF: sub_40B283+159j
		cmp	[ebp+var_18], 0
		jnz	short loc_40B3DE
		mov	eax, [ebp+var_1C]
		mov	edx, eax
		and	edx, 0FFFFFFh
		mov	eax, [ebp+arg_0]
		mov	[eax+18h], edx

loc_40B425:				; CODE XREF: sub_40B283+142j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		jmp	loc_40B553
; ---------------------------------------------------------------------------

loc_40B430:				; CODE XREF: sub_40B283+2D4j
		mov	eax, [ebp+var_14]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+Dst]
		add	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1
		cmp	[ebp+var_C], 2
		jle	loc_40B54B
		movzx	eax, [ebp+Dst]
		shr	al, 2
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, byte_429220[eax]
		mov	[ebp+var_28], al
		movzx	eax, [ebp+Dst]
		movzx	eax, al
		shl	eax, 4
		mov	edx, eax
		and	edx, 30h
		movzx	eax, [ebp+var_23]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		or	eax, edx
		and	eax, 3Fh
		movzx	eax, byte_429220[eax]
		mov	[ebp+var_27], al
		movzx	eax, [ebp+var_23]
		movzx	eax, al
		shl	eax, 2
		mov	edx, eax
		and	edx, 3Ch
		movzx	eax, [ebp+var_22]
		shr	al, 6
		movzx	eax, al
		and	eax, 3
		or	eax, edx
		and	eax, 3Fh
		movzx	eax, byte_429220[eax]
		mov	[ebp+var_26], al
		movzx	eax, [ebp+var_22]
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, byte_429220[eax]
		mov	[ebp+var_25], al
		mov	[ebp+var_C], 0
		jmp	short loc_40B4F5
; ---------------------------------------------------------------------------

loc_40B4D6:				; CODE XREF: sub_40B283+276j
		lea	eax, [ebp+var_28]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	edx, [ebp+var_20]
		mov	[esp+38h+var_34], edx ;	File
		mov	[esp+38h+File],	eax ; Ch
		call	putc
		add	[ebp+var_C], 1

loc_40B4F5:				; CODE XREF: sub_40B283+251j
		cmp	[ebp+var_C], 3
		jle	short loc_40B4D6
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_20]
		mov	[esp+38h+File],	eax ; File
		call	ferror
		test	eax, eax
		jnz	loc_40B598
		add	[ebp+var_10], 1
		cmp	[ebp+var_10], 0Fh
		jle	short loc_40B54B
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		and	eax, 10h
		test	eax, eax
		jnz	short loc_40B54B
		mov	eax, offset asc_42BC38 ; "\n"
		mov	edx, [ebp+var_20]
		mov	[esp+38h+var_34], edx ;	File
		mov	[esp+38h+File],	eax ; Str
		call	fputs
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40B59B

loc_40B54B:				; CODE XREF: sub_40B283+1C3j
					; sub_40B283+29Aj ...
		add	[ebp+var_14], 1
		sub	[ebp+arg_8], 1

loc_40B553:				; CODE XREF: sub_40B283+1A8j
		cmp	[ebp+arg_8], 0
		jnz	loc_40B430
		mov	ecx, [ebp+var_C]
		lea	edx, [ebp+Dst]
		mov	eax, [ebp+arg_0]
		add	eax, 14h
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+var_34], edx ;	Src
		mov	[esp+38h+File],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+8], edx
		mov	eax, 0
		jmp	short locret_40B5A1
; ---------------------------------------------------------------------------

loc_40B592:				; CODE XREF: sub_40B283+28j
		nop
		jmp	short loc_40B59C
; ---------------------------------------------------------------------------

loc_40B595:				; CODE XREF: sub_40B283+D1j
		nop
		jmp	short loc_40B59C
; ---------------------------------------------------------------------------

loc_40B598:				; CODE XREF: sub_40B283+28Cj
		nop
		jmp	short loc_40B59C
; ---------------------------------------------------------------------------

loc_40B59B:				; CODE XREF: sub_40B283+2C6j
		nop

loc_40B59C:				; CODE XREF: sub_40B283+6Dj
					; sub_40B283+8Bj ...
		call	sub_40B162

locret_40B5A1:				; CODE XREF: sub_40B283+33j
					; sub_40B283+30Dj
		leave
		retn
sub_40B283	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B5A3	proc near		; CODE XREF: sub_4025B0+50p

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_20		= byte ptr -20h
var_1F		= byte ptr -1Fh
var_1E		= byte ptr -1Eh
var_1D		= byte ptr -1Dh
var_1C		= byte ptr -1Ch
var_1B		= byte ptr -1Bh
var_1A		= byte ptr -1Ah
File		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		and	eax, 1
		test	eax, eax
		jz	loc_40B8F4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[ebp+File], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		cmp	[ebp+var_10], 3
		jle	short loc_40B5FD
		mov	[esp+38h+Size],	10Eh ; int
		mov	[esp+38h+Src], offset a____Gnupg22__2 ;	"../../gnupg2-2.0.30/common/b64enc.c"
		mov	[esp+38h+Dst], offset aIdx4 ; "idx < 4"
		call	sub_4276E0

loc_40B5FD:				; CODE XREF: sub_40B5A3+3Cj
		mov	ecx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		add	eax, 14h
		mov	edx, eax
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		cmp	[ebp+var_10], 0
		jz	loc_40B72B
		movzx	eax, [ebp+var_1C]
		shr	al, 2
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, byte_429220[eax]
		mov	[ebp+var_20], al
		cmp	[ebp+var_10], 1
		jnz	short loc_40B663
		movzx	eax, [ebp+var_1C]
		movzx	eax, al
		shl	eax, 4
		and	eax, 30h
		movzx	eax, byte_429220[eax]
		mov	[ebp+var_1F], al
		mov	[ebp+var_1E], 3Dh
		mov	[ebp+var_1D], 3Dh
		jmp	short loc_40B6A9
; ---------------------------------------------------------------------------

loc_40B663:				; CODE XREF: sub_40B5A3+9Dj
		movzx	eax, [ebp+var_1C]
		movzx	eax, al
		shl	eax, 4
		mov	edx, eax
		and	edx, 30h
		movzx	eax, [ebp+var_1B]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		or	eax, edx
		and	eax, 3Fh
		movzx	eax, byte_429220[eax]
		mov	[ebp+var_1F], al
		movzx	eax, [ebp+var_1B]
		movzx	eax, al
		shl	eax, 2
		and	eax, 3Ch
		movzx	eax, byte_429220[eax]
		mov	[ebp+var_1E], al
		mov	[ebp+var_1D], 3Dh

loc_40B6A9:				; CODE XREF: sub_40B5A3+BEj
		mov	[ebp+var_10], 0
		jmp	short loc_40B6D1
; ---------------------------------------------------------------------------

loc_40B6B2:				; CODE XREF: sub_40B5A3+132j
		lea	eax, [ebp+var_20]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	edx, [ebp+File]
		mov	[esp+38h+Src], edx ; File
		mov	[esp+38h+Dst], eax ; Ch
		call	putc
		add	[ebp+var_10], 1

loc_40B6D1:				; CODE XREF: sub_40B5A3+10Dj
		cmp	[ebp+var_10], 3
		jle	short loc_40B6B2
		mov	[ebp+var_10], 0
		mov	eax, [ebp+File]
		mov	[esp+38h+Dst], eax ; File
		call	ferror
		test	eax, eax
		jnz	loc_40B8DD
		add	[ebp+var_14], 1
		cmp	[ebp+var_14], 0Fh
		jle	short loc_40B72B
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		and	eax, 10h
		test	eax, eax
		jnz	short loc_40B72B
		mov	eax, offset asc_42BC38 ; "\n"
		mov	edx, [ebp+File]
		mov	[esp+38h+Src], edx ; File
		mov	[esp+38h+Dst], eax ; Str
		call	fputs
		cmp	eax, 0FFFFFFFFh
		jz	loc_40B8E0

loc_40B72B:				; CODE XREF: sub_40B5A3+7Cj
					; sub_40B5A3+156j ...
		cmp	[ebp+var_14], 0
		jz	short loc_40B75A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		and	eax, 10h
		test	eax, eax
		jnz	short loc_40B75A
		mov	eax, offset asc_42BC38 ; "\n"
		mov	edx, [ebp+File]
		mov	[esp+38h+Src], edx ; File
		mov	[esp+38h+Dst], eax ; Str
		call	fputs
		cmp	eax, 0FFFFFFFFh
		jz	loc_40B8E3

loc_40B75A:				; CODE XREF: sub_40B5A3+18Cj
					; sub_40B5A3+198j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		and	eax, 20h
		test	eax, eax
		jz	loc_40B885
		mov	eax, [ebp+File]
		mov	[esp+38h+Src], eax ; File
		mov	[esp+38h+Dst], 3Dh ; Ch
		call	putc
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		shr	eax, 10h
		mov	[ebp+var_1C], al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		shr	eax, 8
		mov	[ebp+var_1B], al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[ebp+var_1A], al
		movzx	eax, [ebp+var_1C]
		shr	al, 2
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, byte_429220[eax]
		mov	[ebp+var_20], al
		movzx	eax, [ebp+var_1C]
		movzx	eax, al
		shl	eax, 4
		mov	edx, eax
		and	edx, 30h
		movzx	eax, [ebp+var_1B]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		or	eax, edx
		and	eax, 3Fh
		movzx	eax, byte_429220[eax]
		mov	[ebp+var_1F], al
		movzx	eax, [ebp+var_1B]
		movzx	eax, al
		shl	eax, 2
		mov	edx, eax
		and	edx, 3Ch
		movzx	eax, [ebp+var_1A]
		shr	al, 6
		movzx	eax, al
		and	eax, 3
		or	eax, edx
		and	eax, 3Fh
		movzx	eax, byte_429220[eax]
		mov	[ebp+var_1E], al
		movzx	eax, [ebp+var_1A]
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, byte_429220[eax]
		mov	[ebp+var_1D], al
		mov	[ebp+var_10], 0
		jmp	short loc_40B847
; ---------------------------------------------------------------------------

loc_40B828:				; CODE XREF: sub_40B5A3+2A8j
		lea	eax, [ebp+var_20]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	edx, [ebp+File]
		mov	[esp+38h+Src], edx ; File
		mov	[esp+38h+Dst], eax ; Ch
		call	putc
		add	[ebp+var_10], 1

loc_40B847:				; CODE XREF: sub_40B5A3+283j
		cmp	[ebp+var_10], 3
		jle	short loc_40B828
		mov	eax, [ebp+File]
		mov	[esp+38h+Dst], eax ; File
		call	ferror
		test	eax, eax
		jnz	loc_40B8E6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		and	eax, 10h
		test	eax, eax
		jnz	short loc_40B885
		mov	eax, offset asc_42BC38 ; "\n"
		mov	edx, [ebp+File]
		mov	[esp+38h+Src], edx ; File
		mov	[esp+38h+Dst], eax ; Str
		call	fputs
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40B8E9

loc_40B885:				; CODE XREF: sub_40B5A3+1C1j
					; sub_40B5A3+2C7j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_40B8F7
		mov	eax, offset aEnd ; "-----END "
		mov	edx, [ebp+File]
		mov	[esp+38h+Src], edx ; File
		mov	[esp+38h+Dst], eax ; Str
		call	fputs
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40B8EA
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+File]
		mov	[esp+38h+Src], edx ; File
		mov	[esp+38h+Dst], eax ; Str
		call	fputs
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40B8EA
		mov	eax, offset asc_42BC31 ; "-----\n"
		mov	edx, [ebp+File]
		mov	[esp+38h+Src], edx ; File
		mov	[esp+38h+Dst], eax ; Str
		call	fputs
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40B8F7
		jmp	short loc_40B8EA
; ---------------------------------------------------------------------------

loc_40B8DD:				; CODE XREF: sub_40B5A3+148j
		nop
		jmp	short loc_40B8EA
; ---------------------------------------------------------------------------

loc_40B8E0:				; CODE XREF: sub_40B5A3+182j
		nop
		jmp	short loc_40B8EA
; ---------------------------------------------------------------------------

loc_40B8E3:				; CODE XREF: sub_40B5A3+1B1j
		nop
		jmp	short loc_40B8EA
; ---------------------------------------------------------------------------

loc_40B8E6:				; CODE XREF: sub_40B5A3+2B7j
		nop
		jmp	short loc_40B8EA
; ---------------------------------------------------------------------------

loc_40B8E9:				; CODE XREF: sub_40B5A3+2E0j
		nop

loc_40B8EA:				; CODE XREF: sub_40B5A3+303j
					; sub_40B5A3+31Dj ...
		call	sub_40B162
		mov	[ebp+var_C], eax
		jmp	short loc_40B8F8
; ---------------------------------------------------------------------------

loc_40B8F4:				; CODE XREF: sub_40B5A3+17j
		nop
		jmp	short loc_40B8F8
; ---------------------------------------------------------------------------

loc_40B8F7:				; CODE XREF: sub_40B5A3+2EAj
					; sub_40B5A3+336j
		nop

loc_40B8F8:				; CODE XREF: sub_40B5A3+34Fj
					; sub_40B5A3+352j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_40B91A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+38h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0

loc_40B91A:				; CODE XREF: sub_40B5A3+35Dj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40B5A3	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B92C	proc near		; CODE XREF: sub_4032E3+43p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_40C78E
		mov	[esp+18h+var_14], eax ;	char *
		mov	[esp+18h+var_18], offset aGnupg2 ; "gnupg2"
		call	sub_41F74E
		leave
		retn
sub_40B92C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B949	proc near		; CODE XREF: sub_403806:loc_40382Fp
					; .text:0040B97Cp

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 1
		call	sub_4200C2
		mov	eax, 0
		leave
		retn
sub_40B949	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B962	proc near		; CODE XREF: sub_403806+B2p
					; .text:0040B998p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 0
		call	sub_4200C2
		leave
		retn
sub_40B962	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_40B949
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_420034
		mov	[ebp-10h], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_40B962
		mov	eax, [ebp-10h]
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B9A4	proc near		; CODE XREF: sub_4032E3+48p

wVersionRequested= word	ptr -1A8h
lpWSAData	= dword	ptr -1A4h
WSAData		= WSAData ptr -198h

		push	ebp
		mov	ebp, esp
		sub	esp, 1A8h
		mov	dword ptr [esp+1A8h+wVersionRequested],	0
		call	sub_42488B
		lea	eax, [ebp+WSAData]
		mov	[esp+1A8h+lpWSAData], eax ; lpWSAData
		mov	dword ptr [esp+1A8h+wVersionRequested],	202h ; wVersionRequested
		mov	eax, ds:WSAStartup
		call	eax ; WSAStartup
		sub	esp, 8
		call	sub_411400
		leave
		retn
sub_40B9A4	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B9DC	proc near		; CODE XREF: sub_40BA03+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_40B9FC
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_40BA01
; ---------------------------------------------------------------------------

loc_40B9FC:				; CODE XREF: sub_40B9DC+7j
		mov	eax, 0

loc_40BA01:				; CODE XREF: sub_40B9DC+1Ej
		pop	ebp
		retn
sub_40B9DC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BA03	proc near		; CODE XREF: sub_40BA1E+Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_40B9DC
		leave
		retn
sub_40BA03	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BA1E	proc near		; CODE XREF: .text:0040BDBEp

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_40BA03
		leave
		retn
sub_40BA1E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40BA33(int, int, char	*, va_list)
sub_40BA33	proc near		; DATA XREF: sub_40BB55+Eo

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		cmp	eax, 1Eh
		jz	short loc_40BA82
		cmp	eax, 1Eh
		jg	short loc_40BA56
		cmp	eax, 0Ah
		jz	short loc_40BA70
		cmp	eax, 14h
		jz	short loc_40BA79
		test	eax, eax
		jz	short loc_40BA67
		jmp	short loc_40BAA6
; ---------------------------------------------------------------------------

loc_40BA56:				; CODE XREF: sub_40BA33+11j
		cmp	eax, 32h
		jz	short loc_40BA94
		cmp	eax, 64h
		jz	short loc_40BA9D
		cmp	eax, 28h
		jz	short loc_40BA8B
		jmp	short loc_40BAA6
; ---------------------------------------------------------------------------

loc_40BA67:				; CODE XREF: sub_40BA33+1Fj
		mov	[ebp+arg_4], 1
		jmp	short loc_40BAAE
; ---------------------------------------------------------------------------

loc_40BA70:				; CODE XREF: sub_40BA33+16j
		mov	[ebp+arg_4], 2
		jmp	short loc_40BAAE
; ---------------------------------------------------------------------------

loc_40BA79:				; CODE XREF: sub_40BA33+1Bj
		mov	[ebp+arg_4], 3
		jmp	short loc_40BAAE
; ---------------------------------------------------------------------------

loc_40BA82:				; CODE XREF: sub_40BA33+Cj
		mov	[ebp+arg_4], 4
		jmp	short loc_40BAAE
; ---------------------------------------------------------------------------

loc_40BA8B:				; CODE XREF: sub_40BA33+30j
		mov	[ebp+arg_4], 5
		jmp	short loc_40BAAE
; ---------------------------------------------------------------------------

loc_40BA94:				; CODE XREF: sub_40BA33+26j
		mov	[ebp+arg_4], 6
		jmp	short loc_40BAAE
; ---------------------------------------------------------------------------

loc_40BA9D:				; CODE XREF: sub_40BA33+2Bj
		mov	[ebp+arg_4], 7
		jmp	short loc_40BAAE
; ---------------------------------------------------------------------------

loc_40BAA6:				; CODE XREF: sub_40BA33+21j
					; sub_40BA33+32j
		mov	[ebp+arg_4], 4
		nop

loc_40BAAE:				; CODE XREF: sub_40BA33+3Bj
					; sub_40BA33+44j ...
		mov	eax, [ebp+arg_C]
		mov	[esp+18h+var_10], eax ;	va_list
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_14], eax ;	char *
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_4208D2
		leave
		retn
sub_40BA33	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_40BAC9	proc near		; DATA XREF: sub_40BB55+22o

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_8], 0
		jnz	short loc_40BAE2
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax
		call	gpg_strerror
		jmp	short loc_40BAE5
; ---------------------------------------------------------------------------

loc_40BAE2:				; CODE XREF: sub_40BAC9+Aj
		mov	eax, [ebp+arg_8]

loc_40BAE5:				; CODE XREF: sub_40BAC9+17j
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aLibgcryptProbl ; "libgcrypt problem: %s\n"
		call	sub_420960
sub_40BAC9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BAF5	proc near		; DATA XREF: sub_40BB55+36o

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_430058
		test	eax, eax
		jnz	short loc_40BB4E
		mov	ds:dword_430058, 1
		mov	eax, [ebp+arg_8]
		and	eax, 1
		test	al, al
		jz	short loc_40BB33
		mov	[esp+18h+var_18], offset aOutOfCoreInSec ; "out	of core	in secure memory while allo"...
		call	sub_420034
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+18h+var_14], edx	; char
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_420960
; ---------------------------------------------------------------------------

loc_40BB33:				; CODE XREF: sub_40BAF5+21j
		mov	[esp+18h+var_18], offset aOutOfCoreWhile ; "out	of core	while allocating %lu bytes"
		call	sub_420034
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+18h+var_14], edx	; char
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_420960
; ---------------------------------------------------------------------------

loc_40BB4E:				; CODE XREF: sub_40BAF5+Dj
		mov	eax, 0
		leave
		retn
sub_40BAF5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BB55	proc near		; CODE XREF: sub_4032E3:loc_403376p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_14], 0
		mov	[esp+18h+var_18], offset sub_40BA33
		call	gcry_set_log_handler
		mov	[esp+18h+var_14], 0
		mov	[esp+18h+var_18], offset sub_40BAC9
		call	gcry_set_fatalerror_handler
		mov	[esp+18h+var_14], 0
		mov	[esp+18h+var_18], offset sub_40BAF5
		call	gcry_set_outofcore_handler
		leave
		retn
sub_40BB55	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_40BBB9
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_40BBC0
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40BBC0

loc_40BBB9:				; CODE XREF: .text:0040BBA0j
		mov	eax, offset aStdout ; "[stdout]"
		jmp	short loc_40BBC3
; ---------------------------------------------------------------------------

loc_40BBC0:				; CODE XREF: .text:0040BBAAj
					; .text:0040BBB7j
		mov	eax, [ebp+8]

loc_40BBC3:				; CODE XREF: .text:0040BBBEj
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_40BBE5
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_40BBEC
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40BBEC

loc_40BBE5:				; CODE XREF: .text:0040BBCCj
		mov	eax, offset aStdin ; "[stdin]"
		jmp	short loc_40BBEF
; ---------------------------------------------------------------------------

loc_40BBEC:				; CODE XREF: .text:0040BBD6j
					; .text:0040BBE3j
		mov	eax, [ebp+8]

loc_40BBEF:				; CODE XREF: .text:0040BBEAj
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_421828
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BC19	proc near		; CODE XREF: .text:0040BC63p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_C]
		mov	[esp+18h+var_C], eax ; int
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	FILE *
		call	sub_421858
		leave
		retn
sub_40BC19	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40BC19
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	loc_40BD0C
; ---------------------------------------------------------------------------

loc_40BC7B:				; CODE XREF: .text:0040BD10j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_40BCA3
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_40BCB5
; ---------------------------------------------------------------------------

loc_40BCA3:				; CODE XREF: .text:0040BC8Dj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 37h

loc_40BCB5:				; CODE XREF: .text:0040BCA1j
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	putc
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_40BCE6
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_40BCF5
; ---------------------------------------------------------------------------

loc_40BCE6:				; CODE XREF: .text:0040BCD3j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 37h

loc_40BCF5:				; CODE XREF: .text:0040BCE4j
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	putc
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp+10h], 1

loc_40BD0C:				; CODE XREF: .text:0040BC76j
		cmp	dword ptr [ebp+10h], 0
		jnz	loc_40BC7B
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_421A23
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	dword ptr [ebp-10h], 0
		mov	dword ptr [ebp-34h], 3
		mov	byte ptr [ebp-30h], 42h
		mov	byte ptr [ebp-2Fh], 5Ah
		mov	byte ptr [ebp-2Eh], 68h
		mov	byte ptr [ebp-2Dh], 0
		mov	dword ptr [ebp-2Ch], 3
		mov	byte ptr [ebp-28h], 1Fh
		mov	byte ptr [ebp-27h], 8Bh
		mov	byte ptr [ebp-26h], 8
		mov	byte ptr [ebp-25h], 0
		mov	dword ptr [ebp-24h], 4
		mov	byte ptr [ebp-20h], 50h
		mov	byte ptr [ebp-1Fh], 4Bh
		mov	byte ptr [ebp-1Eh], 3
		mov	byte ptr [ebp-1Dh], 4
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_419926
		test	eax, eax
		jnz	short loc_40BDA0
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_40BDAA

loc_40BDA0:				; CODE XREF: .text:0040BD98j
		mov	eax, 0
		jmp	locret_40BE92
; ---------------------------------------------------------------------------

loc_40BDAA:				; CODE XREF: .text:0040BD9Ej
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4199B9
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jnz	short loc_40BDD4
		call	sub_40BA1E
		mov	edx, eax
		mov	eax, [ebp+0Ch]
		mov	[eax], edx
		mov	eax, 0
		jmp	locret_40BE92
; ---------------------------------------------------------------------------

loc_40BDD4:				; CODE XREF: .text:0040BDBCj
		lea	eax, [ebp-1Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_41B864
		test	edx, edx
		jg	short loc_40BE05
		test	edx, edx
		js	short loc_40BDF3
		cmp	eax, 3
		ja	short loc_40BE05

loc_40BDF3:				; CODE XREF: .text:0040BDECj
		mov	eax, [ebp-1Ch]
		test	eax, eax
		jnz	short loc_40BE05
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0
		jmp	short loc_40BE84
; ---------------------------------------------------------------------------

loc_40BE05:				; CODE XREF: .text:0040BDE8j
					; .text:0040BDF1j ...
		mov	dword ptr [esp+8], 4
		lea	eax, [ebp-18h]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_41B2D7
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40BE31
		mov	eax, [ebp-14h]
		mov	edx, [eax+3Ch]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx
		jmp	short loc_40BE84
; ---------------------------------------------------------------------------

loc_40BE31:				; CODE XREF: .text:0040BE22j
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_40BE7C
; ---------------------------------------------------------------------------

loc_40BE3A:				; CODE XREF: .text:0040BE82j
		mov	eax, [ebp-0Ch]
		mov	eax, [ebp+eax*8-34h]
		lea	edx, [ebp-34h]
		mov	ecx, [ebp-0Ch]
		shl	ecx, 3
		add	edx, ecx
		add	edx, 4
		mov	[esp+8], eax
		mov	[esp+4], edx
		lea	eax, [ebp-18h]
		mov	[esp], eax
		call	memcmp
		test	eax, eax
		jnz	short loc_40BE78
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0
		mov	dword ptr [ebp-10h], 1
		jmp	short loc_40BE84
; ---------------------------------------------------------------------------

loc_40BE78:				; CODE XREF: .text:0040BE64j
		add	dword ptr [ebp-0Ch], 1

loc_40BE7C:				; CODE XREF: .text:0040BE38j
		mov	eax, [ebp-0Ch]
		cmp	eax, 2
		jbe	short loc_40BE3A

loc_40BE84:				; CODE XREF: .text:0040BE03j
					; .text:0040BE2Fj ...
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_4195A1
		mov	eax, [ebp-10h]

locret_40BE92:				; CODE XREF: .text:0040BDA5j
					; .text:0040BDCFj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h

loc_40BE9A:				; CODE XREF: .text:0040BEF8j
		mov	dword ptr [esp+4], offset asc_42BD10 ; "|"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strcspn
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40BEFC
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_40BEDC
		mov	eax, 1
		jmp	short locret_40BF02
; ---------------------------------------------------------------------------

loc_40BEDC:				; CODE XREF: .text:0040BED3j
		mov	eax, [ebp-0Ch]
		add	[ebp+8], eax
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_40BEF0
		add	dword ptr [ebp+8], 1

loc_40BEF0:				; CODE XREF: .text:0040BEEAj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40BE9A
		jmp	short loc_40BEFD
; ---------------------------------------------------------------------------

loc_40BEFC:				; CODE XREF: .text:0040BEB4j
		nop

loc_40BEFD:				; CODE XREF: .text:0040BEFAj
		mov	eax, 0

locret_40BF02:				; CODE XREF: .text:0040BEDAj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40BF04(LPCSTR)
sub_40BF04	proc near		; CODE XREF: sub_40BF91+42p

lpLibFileName	= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+lpLibFileName], eax ; lpLibFileName
		mov	eax, ds:LoadLibraryA
		call	eax ; LoadLibraryA
		sub	esp, 4
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40BF04	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40BF22(HMODULE, LPCSTR)
sub_40BF22	proc near		; CODE XREF: sub_40BF91+5Ep

hModule		= dword	ptr -28h
lpProcName	= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_40BF60
		cmp	[ebp+arg_4], 0
		jz	short loc_40BF60
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lpProcName], eax ; lpProcName
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hModule], eax ; hModule
		mov	eax, ds:GetProcAddress
		call	eax ; GetProcAddress
		sub	esp, 8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40BF5B
		mov	eax, 0
		jmp	short locret_40BF65
; ---------------------------------------------------------------------------

loc_40BF5B:				; CODE XREF: sub_40BF22+30j
		mov	eax, [ebp+var_C]
		jmp	short locret_40BF65
; ---------------------------------------------------------------------------

loc_40BF60:				; CODE XREF: sub_40BF22+Aj
					; sub_40BF22+10j
		mov	eax, 0

locret_40BF65:				; CODE XREF: sub_40BF22+37j
					; sub_40BF22+3Cj
		leave
		retn
sub_40BF22	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40BF67(HANDLE)
sub_40BF67	proc near		; CODE XREF: sub_40BF91+77p

hObject		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_40BF8A
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		jmp	short locret_40BF8F
; ---------------------------------------------------------------------------

loc_40BF8A:				; CODE XREF: sub_40BF67+Aj
		mov	eax, 0FFFFFFFFh

locret_40BF8F:				; CODE XREF: sub_40BF67+21j
		leave
		retn
sub_40BF67	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BF91	proc near		; CODE XREF: sub_40C06B+77p
					; sub_40C465+5Ap ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, ds:dword_4301D4
		test	eax, eax
		jnz	loc_40C02C
		mov	ds:dword_4301D4, 1
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		jmp	short loc_40C018
; ---------------------------------------------------------------------------

loc_40BFBE:				; CODE XREF: sub_40BF91+99j
		mov	eax, [ebp+var_10]
		mov	eax, off_429260[eax*4]
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax ;	LPCSTR
		call	sub_40BF04
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40C014
		mov	[esp+38h+var_34], offset aShgetfolderpat ; "SHGetFolderPathA"
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax ;	HMODULE
		call	sub_40BF22
		mov	ds:dword_4301D8, eax
		mov	eax, ds:dword_4301D8
		test	eax, eax
		jnz	short loc_40C014
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax ;	HANDLE
		call	sub_40BF67
		mov	[ebp+var_C], 0

loc_40C014:				; CODE XREF: sub_40BF91+4Ej
					; sub_40BF91+6Fj
		add	[ebp+var_10], 1

loc_40C018:				; CODE XREF: sub_40BF91+2Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_40C02C
		mov	eax, [ebp+var_10]
		mov	eax, off_429260[eax*4]
		test	eax, eax
		jnz	short loc_40BFBE

loc_40C02C:				; CODE XREF: sub_40BF91+Dj
					; sub_40BF91+8Bj
		mov	eax, ds:dword_4301D8
		test	eax, eax
		jz	short loc_40C064
		mov	edx, ds:dword_4301D8
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	edx ; dword_4301D8
		sub	esp, 14h
		jmp	short locret_40C069
; ---------------------------------------------------------------------------

loc_40C064:				; CODE XREF: sub_40BF91+A2j
		mov	eax, 0FFFFFFFFh

locret_40C069:				; CODE XREF: sub_40BF91+D1j
		leave
		retn
sub_40BF91	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C06B	proc near		; CODE XREF: sub_40C1A5+14p
					; sub_40C1A5+B2p

lpPathName	= dword	ptr -148h
lpSecurityAttributes= dword ptr	-144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_11C		= dword	ptr -11Ch
var_114		= byte ptr -114h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:lpPathName
		test	eax, eax
		jnz	loc_40C199
		call	sub_40C338
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_430060
		test	eax, eax
		jz	short loc_40C0B9
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+lpSecurityAttributes], offset	aHome ;	"\\home"
		mov	eax, [ebp+var_C]
		mov	[esp+148h+lpPathName], eax
		call	sub_4224E6
		mov	ds:lpPathName, eax
		jmp	loc_40C199
; ---------------------------------------------------------------------------

loc_40C0B9:				; CODE XREF: sub_40C06B+27j
		lea	eax, [ebp+var_114]
		mov	[esp+148h+var_138], eax
		mov	[esp+148h+var_13C], 0
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+lpSecurityAttributes], 801Ah
		mov	[esp+148h+lpPathName], 0
		call	sub_40BF91
		test	eax, eax
		js	loc_40C18F
		lea	eax, [ebp+var_114]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 7
		mov	[esp+148h+lpPathName], eax
		call	gcry_xmalloc
		mov	[ebp+var_10], eax
		mov	ebx, offset aGnupg ; "\\gnupg"
		lea	eax, [ebp+var_114]
		mov	[esp+148h+lpSecurityAttributes], eax
		mov	eax, [ebp+var_10]
		mov	[esp+148h+lpPathName], eax
		call	sub_421FFD
		mov	edx, [ebx]
		mov	[eax], edx
		movzx	edx, word ptr [ebx+4]
		mov	[eax+4], dx
		movzx	edx, byte ptr [ebx+6]
		mov	[eax+6], dl
		mov	eax, [ebp+var_10]
		mov	ds:lpPathName, eax
		mov	eax, ds:lpPathName
		mov	[esp+148h+lpSecurityAttributes], 0
		mov	[esp+148h+lpPathName], eax
		call	_access
		test	eax, eax
		jz	short loc_40C199
		mov	eax, ds:lpPathName
		mov	[esp+148h+lpSecurityAttributes], 0 ; lpSecurityAttributes
		mov	[esp+148h+lpPathName], eax ; lpPathName
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8
		jmp	short loc_40C199
; ---------------------------------------------------------------------------

loc_40C18F:				; CODE XREF: sub_40C06B+7Ej
		mov	ds:lpPathName, offset aCGnupg ;	"c:/gnupg"

loc_40C199:				; CODE XREF: sub_40C06B+12j
					; sub_40C06B+49j ...
		mov	eax, ds:lpPathName
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40C06B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C1A5	proc near		; CODE XREF: sub_4032E3+B4p

VarName		= dword	ptr -28h
var_24		= dword	ptr -24h
lpValueName	= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_40C338
		mov	eax, ds:dword_430060
		test	eax, eax
		jz	short loc_40C1C3
		call	sub_40C06B
		jmp	locret_40C283
; ---------------------------------------------------------------------------

loc_40C1C3:				; CODE XREF: sub_40C1A5+12j
		mov	[esp+28h+VarName], offset VarName ; "GNUPGHOME"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40C1E6
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_40C269

loc_40C1E6:				; CODE XREF: sub_40C1A5+31j
		mov	eax, ds:dword_4301CC
		test	eax, eax
		jnz	short loc_40C261
		cmp	[ebp+var_C], 0
		jz	short loc_40C1FF
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40C24E

loc_40C1FF:				; CODE XREF: sub_40C1A5+4Ej
		mov	[esp+28h+lpValueName], offset ValueName	; "HomeDir"
		mov	[esp+28h+var_24], offset aSoftwareGnuGnu ; "Software\\GNU\\GnuPG"
		mov	[esp+28h+VarName], 0 ; int
		call	sub_4257A2
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40C240
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40C240
		mov	eax, [ebp+var_10]
		mov	[esp+28h+VarName], eax
		call	gcry_free
		mov	[ebp+var_10], 0

loc_40C240:				; CODE XREF: sub_40C1A5+7Dj
					; sub_40C1A5+87j
		cmp	[ebp+var_10], 0
		jz	short loc_40C24E
		mov	eax, [ebp+var_10]
		mov	ds:dword_4301CC, eax

loc_40C24E:				; CODE XREF: sub_40C1A5+58j
					; sub_40C1A5+9Fj
		mov	eax, ds:dword_4301CC
		test	eax, eax
		jnz	short loc_40C261
		call	sub_40C06B
		mov	ds:dword_4301CC, eax

loc_40C261:				; CODE XREF: sub_40C1A5+48j
					; sub_40C1A5+B0j
		mov	eax, ds:dword_4301CC
		mov	[ebp+var_C], eax

loc_40C269:				; CODE XREF: sub_40C1A5+3Bj
		cmp	[ebp+var_C], 0
		jz	short loc_40C279
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40C280

loc_40C279:				; CODE XREF: sub_40C1A5+C8j
		mov	[ebp+var_C], offset aCGnupg ; "c:/gnupg"

loc_40C280:				; CODE XREF: sub_40C1A5+D2j
		mov	eax, [ebp+var_C]

locret_40C283:				; CODE XREF: sub_40C1A5+19j
		leave
		retn
sub_40C1A5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C285	proc near		; CODE XREF: sub_40C338+91p

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	[esp+38h+var_30], 0
		mov	dword ptr [esp+38h+var_34], offset aGpgconf_exe	; "\\gpgconf.exe"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_4224E6
		mov	dword ptr [ebp+var_C], eax
		mov	dword ptr [esp+38h+var_34], 0
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	_access
		test	eax, eax
		jz	short loc_40C2D7
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aRequiredBinary ; "required binary '%s' is not installed\n"
		call	sub_42091D
		jmp	short loc_40C326
; ---------------------------------------------------------------------------

loc_40C2D7:				; CODE XREF: sub_40C285+3Bj
		mov	ebx, offset aCtl ; "ctl"
		mov	eax, dword ptr [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 3
		add	eax, dword ptr [ebp+var_C]
		mov	edx, [ebx]
		mov	[eax], edx
		mov	dword ptr [esp+38h+var_34], 0
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	_access
		test	eax, eax
		jnz	short loc_40C326
		mov	ds:dword_430060, 1

loc_40C326:				; CODE XREF: sub_40C285+50j
					; sub_40C285+95j
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40C285	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C338	proc near		; CODE XREF: sub_40C06B+18p
					; sub_40C1A5+6p ...

hModule		= dword	ptr -28h
lpFilename	= dword	ptr -24h
nSize		= dword	ptr -20h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, ds:dword_4300AC
		test	eax, eax
		jnz	loc_40C447
		mov	[esp+28h+nSize], 104h ;	nSize
		mov	[esp+28h+lpFilename], offset Filename ;	lpFilename
		mov	[esp+28h+hModule], 0 ; hModule
		mov	eax, ds:GetModuleFileNameA
		call	eax ; GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_40C395
		mov	[esp+28h+hModule], 0 ; DWORD
		call	sub_421C5A
		mov	[esp+28h+lpFilename], eax ; char
		mov	[esp+28h+hModule], offset aGetmodulefilen ; "GetModuleFileName failed: %s\n"
		call	sub_4209BA
		mov	ds:Filename, 0

loc_40C395:				; CODE XREF: sub_40C338+38j
		mov	ds:dword_4300AC, 1
		mov	[esp+28h+lpFilename], 5Ch ; Ch
		mov	[esp+28h+hModule], offset Filename ; Str
		call	strrchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40C426
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	[esp+28h+hModule], offset Filename
		call	sub_40C285
		mov	[esp+28h+lpFilename], 5Ch ; Ch
		mov	[esp+28h+hModule], offset Filename ; Str
		call	strrchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40C426
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	edx, eax
		mov	eax, offset aBin ; "bin"
		mov	ecx, 4
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40C426
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	ds:dword_430064, 1

loc_40C426:				; CODE XREF: sub_40C338+82j
					; sub_40C338+B1j ...
		cmp	[ebp+var_C], 0
		jnz	short loc_40C447
		mov	[esp+28h+lpFilename], offset Filename ;	char
		mov	[esp+28h+hModule], offset aBadFilenameSRe ; "bad filename `%s' returned for this pro"...
		call	sub_4209BA
		mov	ds:Filename, 0

loc_40C447:				; CODE XREF: sub_40C338+Fj
					; sub_40C338+F2j
		movzx	eax, ds:Filename
		test	al, al
		jz	short loc_40C459
		mov	eax, offset Filename
		jmp	short loc_40C45E
; ---------------------------------------------------------------------------

loc_40C459:				; CODE XREF: sub_40C338+118j
		mov	eax, offset aCGnupg_0 ;	"c:\\gnupg"

loc_40C45E:				; CODE XREF: sub_40C338+11Fj
		lea	esp, [ebp-8]
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40C338	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C465	proc near		; CODE XREF: .text:0040C561p

var_148		= dword	ptr -148h
var_144		= dword	ptr -144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_11C		= dword	ptr -11Ch
var_114		= byte ptr -114h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:dword_4300A8
		test	eax, eax
		jnz	loc_40C53D
		call	sub_40C338
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_430060
		test	eax, eax
		jz	short loc_40C496
		mov	eax, [ebp+var_C]
		jmp	loc_40C542
; ---------------------------------------------------------------------------

loc_40C496:				; CODE XREF: sub_40C465+27j
		lea	eax, [ebp+var_114]
		mov	[esp+148h+var_138], eax
		mov	[esp+148h+var_13C], 0
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+var_144], 23h
		mov	[esp+148h+var_148], 0
		call	sub_40BF91
		test	eax, eax
		js	short loc_40C52D
		lea	eax, [ebp+var_114]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 5
		mov	[esp+148h+var_148], eax
		call	gcry_xmalloc
		mov	[ebp+var_10], eax
		mov	ebx, offset aGnu ; "\\GNU"
		lea	eax, [ebp+var_114]
		mov	[esp+148h+var_144], eax
		mov	eax, [ebp+var_10]
		mov	[esp+148h+var_148], eax
		call	sub_421FFD
		mov	edx, [ebx]
		mov	[eax], edx
		movzx	edx, byte ptr [ebx+4]
		mov	[eax+4], dl
		mov	eax, [ebp+var_10]
		mov	ds:dword_4300A8, eax
		jmp	short loc_40C53D
; ---------------------------------------------------------------------------

loc_40C52D:				; CODE XREF: sub_40C465+61j
		mov	eax, [ebp+var_C]
		mov	[esp+148h+var_148], eax
		call	gcry_xstrdup
		mov	ds:dword_4300A8, eax

loc_40C53D:				; CODE XREF: sub_40C465+12j
					; sub_40C465+C6j
		mov	eax, ds:dword_4300A8

loc_40C542:				; CODE XREF: sub_40C465+2Cj
		add	esp, 140h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40C465	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_4300A4
		test	eax, eax
		jnz	loc_40C5E3
		call	sub_40C465
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aEtcGnupg ;	"\\etc\\gnupg"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_4300A4, eax
		mov	eax, ds:dword_4300A4
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_421FFD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_40C5E3:				; CODE XREF: .text:0040C55Bj
		mov	eax, ds:dword_4300A4
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C5EF	proc near		; CODE XREF: sub_40C63B+6p
					; sub_40C93A+2Ep ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_40C338
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_430064
		test	eax, eax
		jz	short loc_40C636
		mov	eax, ds:dword_4300A0
		test	eax, eax
		jnz	short loc_40C62F
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], offset aBin_0	; "\\bin"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_4224E6
		mov	ds:dword_4300A0, eax

loc_40C62F:				; CODE XREF: sub_40C5EF+1Ej
		mov	eax, ds:dword_4300A0
		jmp	short locret_40C639
; ---------------------------------------------------------------------------

loc_40C636:				; CODE XREF: sub_40C5EF+15j
		mov	eax, [ebp+var_C]

locret_40C639:				; CODE XREF: sub_40C5EF+45j
		leave
		retn
sub_40C5EF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C63B	proc near		; CODE XREF: sub_40C93A+160p
					; sub_40C93A+292p ...
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		call	sub_40C5EF
		leave
		retn
sub_40C63B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_43009C
		test	eax, eax
		jnz	loc_40C6DF
		call	sub_40C338
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aLibGnupg ;	"\\lib\\gnupg"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_43009C, eax
		mov	eax, ds:dword_43009C
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_421FFD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_40C6DF:				; CODE XREF: .text:0040C657j
		mov	eax, ds:dword_43009C
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_430098
		test	eax, eax
		jnz	loc_40C782
		call	sub_40C338
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aShareGnupg	; "\\share\\gnupg"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_430098, eax
		mov	eax, ds:dword_430098
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_421FFD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_40C782:				; CODE XREF: .text:0040C6FAj
		mov	eax, ds:dword_430098
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C78E	proc near		; CODE XREF: sub_40B92C+6p

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_430094
		test	eax, eax
		jnz	loc_40C825
		call	sub_40C338
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aShareLocale ; "\\share\\locale"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_430094, eax
		mov	eax, ds:dword_430094
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_421FFD
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40C825:				; CODE XREF: sub_40C78E+Fj
		mov	eax, ds:dword_430094
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40C78E	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:dword_430090
		test	eax, eax
		jnz	loc_40C92B
		lea	eax, [ebp-110h]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 24h
		mov	dword ptr [esp], 0
		call	sub_40BF91
		test	eax, eax
		jns	short loc_40C89F
		mov	edx, offset aCWindows ;	"C:\\WINDOWS"
		lea	eax, [ebp-110h]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	ecx, word ptr [edx+8]
		mov	[eax+8], cx
		movzx	edx, byte ptr [edx+0Ah]
		mov	[eax+0Ah], dl

loc_40C89F:				; CODE XREF: .text:0040C879j
		mov	dword ptr [ebp-0Ch], offset aS_dirmngr ; "\\S.dirmngr"
		lea	eax, [ebp-110h]
		mov	dword ptr [ebp-11Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-11Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-11Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-11Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_430090, eax
		mov	eax, ds:dword_430090
		lea	edx, [ebp-110h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_421FFD
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_40C92B:				; CODE XREF: .text:0040C843j
		mov	eax, ds:dword_430090
		add	esp, 140h
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C93A	proc near		; CODE XREF: sub_41C657+192p

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		cmp	[ebp+arg_0], 0Ah ; switch 11 cases
		ja	loc_40CF52	; jumptable 0040C959 default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_42BF00
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40C95B:				; CODE XREF: sub_40C93A+1Fj
					; DATA XREF: .rdata:off_42BF00o
		mov	eax, ds:dword_430068 ; jumptable 0040C959 case 1
		test	eax, eax
		jnz	loc_40C9EA
		call	sub_40C5EF
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aGpgAgent_exe ; "\\gpg-agent.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_430068, eax
		mov	eax, ds:dword_430068
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_421FFD
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40C9EA:				; CODE XREF: sub_40C93A+28j
		mov	eax, ds:dword_430068
		jmp	loc_40CF6E
; ---------------------------------------------------------------------------

loc_40C9F4:				; CODE XREF: sub_40C93A+1Fj
					; DATA XREF: .rdata:off_42BF00o
		mov	eax, ds:dword_43006C ; jumptable 0040C959 case 2
		test	eax, eax
		jnz	loc_40CA83
		call	sub_40C5EF
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aPinentry_exe ; "\\pinentry.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_43006C, eax
		mov	eax, ds:dword_43006C
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_421FFD
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40CA83:				; CODE XREF: sub_40C93A+C1j
		mov	eax, ds:dword_43006C
		jmp	loc_40CF6E
; ---------------------------------------------------------------------------

loc_40CA8D:				; CODE XREF: sub_40C93A+1Fj
					; DATA XREF: .rdata:off_42BF00o
		mov	eax, ds:dword_430070 ; jumptable 0040C959 case 3
		test	eax, eax
		jnz	loc_40CB1C
		call	sub_40C63B
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aScdaemon_exe ; "\\scdaemon.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_430070, eax
		mov	eax, ds:dword_430070
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_421FFD
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40CB1C:				; CODE XREF: sub_40C93A+15Aj
		mov	eax, ds:dword_430070
		jmp	loc_40CF6E
; ---------------------------------------------------------------------------

loc_40CB26:				; CODE XREF: sub_40C93A+1Fj
					; DATA XREF: .rdata:off_42BF00o
		mov	eax, ds:dword_430074 ; jumptable 0040C959 case 4
		test	eax, eax
		jnz	loc_40CBB5
		call	sub_40C5EF
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aDirmngr_exe ; "\\dirmngr.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_430074, eax
		mov	eax, ds:dword_430074
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_421FFD
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40CBB5:				; CODE XREF: sub_40C93A+1F3j
		mov	eax, ds:dword_430074
		jmp	loc_40CF6E
; ---------------------------------------------------------------------------

loc_40CBBF:				; CODE XREF: sub_40C93A+1Fj
					; DATA XREF: .rdata:off_42BF00o
		mov	eax, ds:dword_430078 ; jumptable 0040C959 case 5
		test	eax, eax
		jnz	loc_40CC4E
		call	sub_40C63B
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aGpgProtectTo_1 ; "\\gpg-protect-tool.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_430078, eax
		mov	eax, ds:dword_430078
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_421FFD
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40CC4E:				; CODE XREF: sub_40C93A+28Cj
		mov	eax, ds:dword_430078
		jmp	loc_40CF6E
; ---------------------------------------------------------------------------

loc_40CC58:				; CODE XREF: sub_40C93A+1Fj
					; DATA XREF: .rdata:off_42BF00o
		mov	eax, ds:dword_43007C ; jumptable 0040C959 case 6
		test	eax, eax
		jnz	loc_40CCE7
		call	sub_40C63B
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aGpgCheckPatter ; "\\gpg-check-pattern.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_43007C, eax
		mov	eax, ds:dword_43007C
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_421FFD
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40CCE7:				; CODE XREF: sub_40C93A+325j
		mov	eax, ds:dword_43007C
		jmp	loc_40CF6E
; ---------------------------------------------------------------------------

loc_40CCF1:				; CODE XREF: sub_40C93A+1Fj
					; DATA XREF: .rdata:off_42BF00o
		mov	eax, ds:dword_430080 ; jumptable 0040C959 case 7
		test	eax, eax
		jnz	loc_40CD80
		call	sub_40C5EF
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aGpgsm_exe	; "\\gpgsm.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_430080, eax
		mov	eax, ds:dword_430080
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_421FFD
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40CD80:				; CODE XREF: sub_40C93A+3BEj
		mov	eax, ds:dword_430080
		jmp	loc_40CF6E
; ---------------------------------------------------------------------------

loc_40CD8A:				; CODE XREF: sub_40C93A+1Fj
					; DATA XREF: .rdata:off_42BF00o
		mov	eax, ds:dword_430084 ; jumptable 0040C959 case 8
		test	eax, eax
		jnz	loc_40CE19
		call	sub_40C5EF
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aGpg2_exe ; "\\gpg2.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_430084, eax
		mov	eax, ds:dword_430084
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_421FFD
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40CE19:				; CODE XREF: sub_40C93A+457j
		mov	eax, ds:dword_430084
		jmp	loc_40CF6E
; ---------------------------------------------------------------------------

loc_40CE23:				; CODE XREF: sub_40C93A+1Fj
					; DATA XREF: .rdata:off_42BF00o
		mov	eax, ds:dword_430088 ; jumptable 0040C959 case 9
		test	eax, eax
		jnz	loc_40CEB2
		call	sub_40C5EF
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aGpgConnectAgen ; "\\gpg-connect-agent.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_430088, eax
		mov	eax, ds:dword_430088
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_421FFD
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40CEB2:				; CODE XREF: sub_40C93A+4F0j
		mov	eax, ds:dword_430088
		jmp	loc_40CF6E
; ---------------------------------------------------------------------------

loc_40CEBC:				; CODE XREF: sub_40C93A+1Fj
					; DATA XREF: .rdata:off_42BF00o
		mov	eax, ds:dword_43008C ; jumptable 0040C959 case 10
		test	eax, eax
		jnz	loc_40CF4B
		call	sub_40C5EF
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aGpgconf_exe ; "\\gpgconf.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_43008C, eax
		mov	eax, ds:dword_43008C
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_421FFD
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40CF4B:				; CODE XREF: sub_40C93A+589j
		mov	eax, ds:dword_43008C
		jmp	short loc_40CF6E
; ---------------------------------------------------------------------------

loc_40CF52:				; CODE XREF: sub_40C93A+Cj
					; sub_40C93A+1Fj
					; DATA XREF: ...
		mov	[esp+38h+var_30], offset aGnupg_module_n ; jumptable 0040C959 default case
		mov	[esp+38h+Source], 229h
		mov	[esp+38h+Dest],	offset a____Gnupg22__3 ; "../../gnupg2-2.0.30/common/homedir.c"
		call	sub_420AAC
; ---------------------------------------------------------------------------

loc_40CF6E:				; CODE XREF: sub_40C93A+B5j
					; sub_40C93A+14Ej ...
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40C93A	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CF78	proc near		; CODE XREF: sub_40CF9F+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_40CF98
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_40CF9D
; ---------------------------------------------------------------------------

loc_40CF98:				; CODE XREF: sub_40CF78+7j
		mov	eax, 0

loc_40CF9D:				; CODE XREF: sub_40CF78+1Ej
		pop	ebp
		retn
sub_40CF78	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CF9F	proc near		; CODE XREF: sub_40CFBA+Ep
					; .text:0040D4D7p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_40CF78
		leave
		retn
sub_40CF9F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CFBA	proc near		; CODE XREF: sub_40D1D0+1BFp
					; sub_40D1D0+24Bp

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_40CF9F
		leave
		retn
sub_40CFBA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CFCF	proc near		; CODE XREF: sub_40D694+107p
					; sub_40D694+117p
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_40CFCF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CFD9	proc near		; CODE XREF: sub_41C2DE+E2p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		js	short loc_40CFF5
		mov	eax, [ebp+var_4]
		cmp	eax, 7
		jbe	short loc_40CFFC

loc_40CFF5:				; CODE XREF: sub_40CFD9+12j
		mov	eax, 0
		jmp	short locret_40D026
; ---------------------------------------------------------------------------

loc_40CFFC:				; CODE XREF: sub_40CFD9+1Aj
		mov	eax, [ebp+var_4]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		cmp	[ebp+arg_4], 0
		jz	short loc_40D01C
		mov	eax, [ebp+var_4]
		mov	edx, off_429284[eax*8]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx

loc_40D01C:				; CODE XREF: sub_40CFD9+32j
		mov	eax, [ebp+var_4]
		mov	eax, off_429280[eax*8]

locret_40D026:				; CODE XREF: sub_40CFD9+21j
		leave
		retn
sub_40CFD9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D028	proc near		; CODE XREF: sub_4032E3+BEp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_24], 0Ch
		mov	[esp+28h+var_28], 1
		call	gcry_calloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40D09E
		mov	eax, ds:dword_4301E0
		test	eax, eax
		jz	short loc_40D05B
		mov	eax, ds:dword_4301E0
		jmp	short loc_40D060
; ---------------------------------------------------------------------------

loc_40D05B:				; CODE XREF: sub_40D028+2Aj
		mov	eax, 8

loc_40D060:				; CODE XREF: sub_40D028+31j
		mov	edx, [ebp+var_C]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+var_24], 4
		mov	[esp+28h+var_28], eax
		call	gcry_calloc
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_40D09E
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	[ebp+var_C], 0

loc_40D09E:				; CODE XREF: sub_40D028+21j
					; sub_40D028+62j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40D028	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D0A3	proc near		; CODE XREF: sub_4037B4+38p

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	loc_40D140
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 8
		jbe	short loc_40D0DF
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 3Ah
		ja	short loc_40D0DF
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, ds:dword_4301E0
		cmp	edx, eax
		jbe	short loc_40D0DF
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	ds:dword_4301E0, eax

loc_40D0DF:				; CODE XREF: sub_40D0A3+18j
					; sub_40D0A3+22j ...
		mov	[ebp+var_C], 0
		jmp	short loc_40D118
; ---------------------------------------------------------------------------

loc_40D0E8:				; CODE XREF: sub_40D0A3+80j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40D114
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		call	gcry_free

loc_40D114:				; CODE XREF: sub_40D0A3+57j
		add	[ebp+var_C], 1

loc_40D118:				; CODE XREF: sub_40D0A3+43j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	short loc_40D0E8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		jmp	short locret_40D141
; ---------------------------------------------------------------------------

loc_40D140:				; CODE XREF: sub_40D0A3+Aj
		nop

locret_40D141:				; CODE XREF: sub_40D0A3+9Bj
		leave
		retn
sub_40D0A3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D143(int, char *)
sub_40D143	proc near		; CODE XREF: .text:0040D51Dp
					; .text:0040D590p

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		jmp	short loc_40D1BC
; ---------------------------------------------------------------------------

loc_40D152:				; CODE XREF: sub_40D143+84j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40D1B8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str2],	eax ; Str2
		mov	[esp+28h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40D1B8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+28h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	dword ptr [eax], 0

loc_40D1B8:				; CODE XREF: sub_40D143+21j
					; sub_40D143+47j
		add	[ebp+var_C], 1

loc_40D1BC:				; CODE XREF: sub_40D143+Dj
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	short loc_40D152
		mov	eax, 0
		leave
		retn
sub_40D143	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D1D0(int, char *, size_t, int, int)
sub_40D1D0	proc near		; CODE XREF: .text:0040D551p
					; .text:0040D5D6p ...

Str1		= dword	ptr -48h
Str2		= dword	ptr -44h
MaxCount	= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
Size		= dword	ptr -18h
Src		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	[ebp+var_10], 0FFFFFFFFh
		cmp	[ebp+arg_C], 0
		jz	short loc_40D1EC
		mov	eax, [ebp+arg_C]
		mov	[ebp+Src], eax
		jmp	short loc_40D1F8
; ---------------------------------------------------------------------------

loc_40D1EC:				; CODE XREF: sub_40D1D0+12j
		mov	eax, [ebp+arg_8]
		add	eax, 1
		add	eax, [ebp+arg_4]
		mov	[ebp+Src], eax

loc_40D1F8:				; CODE XREF: sub_40D1D0+1Aj
		mov	eax, [ebp+Src]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+Size], eax
		mov	[ebp+var_C], 0
		jmp	loc_40D33A
; ---------------------------------------------------------------------------

loc_40D226:				; CODE XREF: sub_40D1D0+175j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40D245
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	loc_40D336
; ---------------------------------------------------------------------------

loc_40D245:				; CODE XREF: sub_40D1D0+68j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+MaxCount], eax	; MaxCount
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str2],	eax ; Str2
		mov	[esp+48h+Str1],	edx ; Str1
		call	strncmp
		test	eax, eax
		jnz	loc_40D336
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		add	eax, 8
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, [ebp+arg_8]
		jnz	loc_40D336
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, [ebp+Size]
		jnz	short loc_40D330
		mov	edx, [ebp+Src]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [ebp+var_C]
		shl	ecx, 2
		add	eax, ecx
		mov	eax, [eax]
		mov	eax, [eax]
		mov	ecx, [ebp+Size]
		mov	[esp+48h+MaxCount], ecx	; Size
		mov	[esp+48h+Str2],	edx ; Src
		mov	[esp+48h+Str1],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		cmp	[ebp+arg_10], 0
		setnz	dl
		movzx	edx, dl
		mov	[eax+4], edx
		mov	eax, 0
		jmp	loc_40D4B4
; ---------------------------------------------------------------------------

loc_40D330:				; CODE XREF: sub_40D1D0+10Fj
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax

loc_40D336:				; CODE XREF: sub_40D1D0+70j
					; sub_40D1D0+A0j ...
		add	[ebp+var_C], 1

loc_40D33A:				; CODE XREF: sub_40D1D0+51j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	loc_40D226
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	loc_40D3FF
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	edx, eax
		jnz	loc_40D3ED
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		add	eax, 0Ah
		mov	[ebp+var_1C], eax
		mov	[esp+48h+Str2],	4
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Str1],	eax
		call	gcry_calloc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_40D399
		call	sub_40CFBA
		jmp	loc_40D4B4
; ---------------------------------------------------------------------------

loc_40D399:				; CODE XREF: sub_40D1D0+1BDj
		mov	[ebp+var_C], 0
		jmp	short loc_40D3C1
; ---------------------------------------------------------------------------

loc_40D3A2:				; CODE XREF: sub_40D1D0+1FCj
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+var_20]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+8]
		mov	ecx, [ebp+var_C]
		shl	ecx, 2
		add	edx, ecx
		mov	edx, [edx]
		mov	[eax], edx
		add	[ebp+var_C], 1

loc_40D3C1:				; CODE XREF: sub_40D1D0+1D0j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	short loc_40D3A2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+48h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_20]
		mov	[eax+8], edx

loc_40D3ED:				; CODE XREF: sub_40D1D0+192j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[ebp+var_10], eax
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+4], edx

loc_40D3FF:				; CODE XREF: sub_40D1D0+17Fj
		mov	eax, [ebp+Size]
		mov	edx, [ebp+arg_8]
		add	eax, edx
		add	eax, 0Dh
		mov	[esp+48h+Str1],	eax
		call	gcry_malloc
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_40D425
		call	sub_40CFBA
		jmp	loc_40D4B4
; ---------------------------------------------------------------------------

loc_40D425:				; CODE XREF: sub_40D1D0+249j
		cmp	[ebp+arg_10], 0
		setnz	al
		movzx	edx, al
		mov	eax, [ebp+var_24]
		mov	[eax+4], edx
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_24]
		add	eax, 8
		mov	ecx, [ebp+arg_8]
		mov	[esp+48h+MaxCount], ecx	; Size
		mov	[esp+48h+Str2],	edx ; Src
		mov	[esp+48h+Str1],	eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+arg_8]
		add	eax, edx
		mov	byte ptr [eax+8], 0
		mov	eax, [ebp+var_24]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_8]
		add	eax, 1
		add	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], edx
		mov	eax, [ebp+var_24]
		mov	eax, [eax]
		mov	edx, [ebp+Src]
		mov	[esp+48h+Str2],	edx ; Source
		mov	[esp+48h+Str1],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_10]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+48h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_10]
		shl	edx, 2
		add	edx, eax
		mov	eax, [ebp+var_24]
		mov	[edx], eax
		mov	eax, 0

loc_40D4B4:				; CODE XREF: sub_40D1D0+15Bj
					; sub_40D1D0+1C4j ...
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_40D1D0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_40D4D0
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40D4DE

loc_40D4D0:				; CODE XREF: .text:0040D4C4j
		mov	dword ptr [esp], 37h
		call	sub_40CF9F
		jmp	short locret_40D556
; ---------------------------------------------------------------------------

loc_40D4DE:				; CODE XREF: .text:0040D4CEj
		mov	dword ptr [esp+4], 3Dh
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	strchr
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+0Ch]
		jnz	short loc_40D50A
		mov	dword ptr [esp], 37h
		call	sub_40CF9F
		jmp	short locret_40D556
; ---------------------------------------------------------------------------

loc_40D50A:				; CODE XREF: .text:0040D4FAj
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40D524
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40D143
		jmp	short locret_40D556
; ---------------------------------------------------------------------------

loc_40D524:				; CODE XREF: .text:0040D50Ej
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40D1D0

locret_40D556:				; CODE XREF: .text:0040D4DCj
					; .text:0040D508j ...
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_40D56F
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40D57D

loc_40D56F:				; CODE XREF: .text:0040D563j
		mov	dword ptr [esp], 37h
		call	sub_40CF9F
		jmp	short loc_40D5DB
; ---------------------------------------------------------------------------

loc_40D57D:				; CODE XREF: .text:0040D56Dj
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_40D597
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40D143
		jmp	short loc_40D5DB
; ---------------------------------------------------------------------------

loc_40D597:				; CODE XREF: .text:0040D581j
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	dword ptr [esp+10h], 0
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40D1D0

loc_40D5DB:				; CODE XREF: .text:0040D57Bj
					; .text:0040D595j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_40D5FD
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_40D5FD
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40D607

loc_40D5FD:				; CODE XREF: .text:0040D5EBj
					; .text:0040D5F1j
		mov	eax, 0
		jmp	locret_40D692
; ---------------------------------------------------------------------------

loc_40D607:				; CODE XREF: .text:0040D5FBj
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_40D680
; ---------------------------------------------------------------------------

loc_40D610:				; CODE XREF: .text:0040D68Bj
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		mov	edx, [ebp-0Ch]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40D67C
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		mov	edx, [ebp-0Ch]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		lea	edx, [eax+8]
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	[esp], edx
		call	strcmp
		test	eax, eax
		jnz	short loc_40D67C
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		mov	edx, [ebp-0Ch]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_40D675
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		mov	edx, [ebp-0Ch]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	eax, [eax]
		jmp	short loc_40D67A
; ---------------------------------------------------------------------------

loc_40D675:				; CODE XREF: .text:0040D65Fj
		mov	eax, 0

loc_40D67A:				; CODE XREF: .text:0040D673j
		jmp	short locret_40D692
; ---------------------------------------------------------------------------

loc_40D67C:				; CODE XREF: .text:0040D622j
					; .text:0040D648j
		add	dword ptr [ebp-0Ch], 1

loc_40D680:				; CODE XREF: .text:0040D60Ej
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	short loc_40D610
		mov	eax, 0

locret_40D692:				; CODE XREF: .text:0040D602j
					; .text:loc_40D67Aj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D694(int, char *VarName, int)
sub_40D694	proc near		; CODE XREF: sub_41C2DE+3Cp
					; sub_41C2DE+109p

Str1		= dword	ptr -48h
Str2		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
VarName		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		cmp	[ebp+arg_8], 0
		jz	short loc_40D6AA
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0

loc_40D6AA:				; CODE XREF: sub_40D694+Bj
		cmp	[ebp+arg_0], 0
		jz	short loc_40D6C0
		cmp	[ebp+VarName], 0
		jz	short loc_40D6C0
		mov	eax, [ebp+VarName]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40D6CA

loc_40D6C0:				; CODE XREF: sub_40D694+1Aj
					; sub_40D694+20j
		mov	eax, 0
		jmp	loc_40D898
; ---------------------------------------------------------------------------

loc_40D6CA:				; CODE XREF: sub_40D694+2Aj
		mov	[ebp+var_C], 0
		jmp	short loc_40D74E
; ---------------------------------------------------------------------------

loc_40D6D3:				; CODE XREF: sub_40D694+C5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40D74A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		lea	edx, [eax+8]
		mov	eax, [ebp+VarName]
		mov	[esp+48h+Str2],	eax ; Str2
		mov	[esp+48h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40D74A
		cmp	[ebp+arg_8], 0
		jz	short loc_40D733
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40D733
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 1

loc_40D733:				; CODE XREF: sub_40D694+7Dj
					; sub_40D694+94j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	eax, [eax]
		jmp	loc_40D898
; ---------------------------------------------------------------------------

loc_40D74A:				; CODE XREF: sub_40D694+51j
					; sub_40D694+77j
		add	[ebp+var_C], 1

loc_40D74E:				; CODE XREF: sub_40D694+3Dj
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	loc_40D6D3
		mov	eax, [ebp+VarName]
		mov	[esp+48h+Str1],	eax ; VarName
		call	getenv
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40D77D
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40D7B3

loc_40D77D:				; CODE XREF: sub_40D694+DDj
		mov	[esp+48h+Str2],	offset Str2 ; "GPG_TTY"
		mov	eax, [ebp+VarName]
		mov	[esp+48h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40D7B3
		mov	[esp+48h+Str1],	0
		call	sub_40CFCF
		test	eax, eax
		jz	short loc_40D7B3
		mov	[esp+48h+Str1],	0
		call	sub_40CFCF
		mov	[ebp+var_10], eax

loc_40D7B3:				; CODE XREF: sub_40D694+E7j
					; sub_40D694+FEj ...
		cmp	[ebp+var_10], 0
		jz	loc_40D893
		mov	eax, [ebp+VarName]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	[esp+48h+var_38], 1 ; int
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_3C], eax ;	int
		mov	[esp+48h+var_40], edx ;	size_t
		mov	eax, [ebp+VarName]
		mov	[esp+48h+Str2],	eax ; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str1],	eax ; int
		call	sub_40D1D0
		mov	[ebp+var_C], 0
		jmp	short loc_40D882
; ---------------------------------------------------------------------------

loc_40D80A:				; CODE XREF: sub_40D694+1F9j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40D87E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		lea	edx, [eax+8]
		mov	eax, [ebp+VarName]
		mov	[esp+48h+Str2],	eax ; Str2
		mov	[esp+48h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40D87E
		cmp	[ebp+arg_8], 0
		jz	short loc_40D86A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40D86A
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 1

loc_40D86A:				; CODE XREF: sub_40D694+1B4j
					; sub_40D694+1CBj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	eax, [eax]
		jmp	short loc_40D898
; ---------------------------------------------------------------------------

loc_40D87E:				; CODE XREF: sub_40D694+188j
					; sub_40D694+1AEj
		add	[ebp+var_C], 1

loc_40D882:				; CODE XREF: sub_40D694+174j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	loc_40D80A

loc_40D893:				; CODE XREF: sub_40D694+123j
		mov	eax, 0

loc_40D898:				; CODE XREF: sub_40D694+31j
					; sub_40D694+B1j ...
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_40D694	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[ebp-4], eax
		cmp	dword ptr [ebp+8], 0
		jz	short loc_40D8B8
		cmp	dword ptr [ebp-4], 0
		jns	short loc_40D937

loc_40D8B8:				; CODE XREF: .text:0040D8B0j
		mov	eax, 0
		jmp	locret_40D94E
; ---------------------------------------------------------------------------

loc_40D8C2:				; CODE XREF: .text:0040D943j
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		mov	edx, [ebp-4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40D931
		mov	eax, [ebp-4]
		lea	edx, [eax+1]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_40D8FF
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		mov	edx, [ebp-4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	edx, [eax+4]
		mov	eax, [ebp+14h]
		mov	[eax], edx

loc_40D8FF:				; CODE XREF: .text:0040D8E5j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_40D91C
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		mov	edx, [ebp-4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	edx, [eax]
		mov	eax, [ebp+10h]
		mov	[eax], edx

loc_40D91C:				; CODE XREF: .text:0040D903j
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		mov	edx, [ebp-4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		add	eax, 8
		jmp	short locret_40D94E
; ---------------------------------------------------------------------------

loc_40D931:				; CODE XREF: .text:0040D8D4j
		add	dword ptr [ebp-4], 1
		jmp	short loc_40D938
; ---------------------------------------------------------------------------

loc_40D937:				; CODE XREF: .text:0040D8B6j
		nop

loc_40D938:				; CODE XREF: .text:0040D935j
		mov	edx, [ebp-4]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	loc_40D8C2
		mov	eax, 0

locret_40D94E:				; CODE XREF: .text:0040D8BDj
					; .text:0040D92Fj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D950	proc near		; CODE XREF: sub_40D977+14p
					; sub_40DBAB+2A2p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_40D970
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_40D975
; ---------------------------------------------------------------------------

loc_40D970:				; CODE XREF: sub_40D950+7j
		mov	eax, 0

loc_40D975:				; CODE XREF: sub_40D950+1Ej
		pop	ebp
		retn
sub_40D950	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D977	proc near		; CODE XREF: sub_40D9AD+Ep
					; sub_40DBAB+96p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_40D950
		leave
		retn
sub_40D977	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D992	proc near		; CODE XREF: sub_40DBAB+280p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_40D992	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D99F	proc near		; CODE XREF: sub_40DBAB+271p
					; sub_40DBAB+292p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		shr	eax, 18h
		and	eax, 7Fh
		pop	ebp
		retn
sub_40D99F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D9AD	proc near		; CODE XREF: sub_40DBAB+345p
					; sub_40DBAB:loc_40DF04p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_40D977
		leave
		retn
sub_40D9AD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D9C2	proc near		; CODE XREF: sub_4032E3+3BFp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ds:dword_430220, eax
		mov	eax, [ebp+arg_4]
		mov	ds:dword_430224, eax
		mov	eax, [ebp+arg_8]
		mov	ds:dword_430228, eax
		mov	eax, [ebp+arg_C]
		mov	ds:dword_43022C, eax
		mov	eax, [ebp+arg_10]
		mov	ds:dword_430230, eax
		mov	eax, [ebp+arg_14]
		mov	ds:dword_430234, eax
		mov	eax, [ebp+arg_18]
		mov	ds:dword_430238, eax
		pop	ebp
		retn
sub_40D9C2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D9FF	proc near		; CODE XREF: sub_40DBAB+30p
					; .text:loc_40DF5Dp

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
Str		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	eax, ds:dword_430200
		test	eax, eax
		jz	short loc_40DA1B
		mov	eax, 0
		jmp	loc_40DAE0
; ---------------------------------------------------------------------------

loc_40DA1B:				; CODE XREF: sub_40D9FF+10j
		mov	eax, ds:dword_430224
		mov	[ebp+var_2C], eax
		mov	edi, ds:dword_430238
		mov	esi, ds:dword_430234
		mov	ebx, ds:dword_430230
		mov	ecx, ds:dword_43022C
		mov	edx, ds:dword_430228
		mov	eax, ds:dword_430220
		mov	[ebp+var_30], eax
		mov	[esp+68h+var_40], 0 ; int
		mov	[esp+68h+var_44], 0 ; int
		mov	[esp+68h+var_48], 0 ; int
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+var_4C], eax ;	int
		mov	[esp+68h+var_50], edi ;	int
		mov	[esp+68h+var_54], esi ;	int
		mov	[esp+68h+var_58], ebx ;	int
		mov	[esp+68h+Str], ecx ; Str
		mov	[esp+68h+var_60], edx ;	int
		mov	eax, [ebp+var_30]
		mov	[esp+68h+var_64], eax ;	int
		mov	[esp+68h+var_68], offset dword_430200 ;	int
		call	sub_41C657
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_40DADD
		mov	eax, ds:dword_430200
		mov	[esp+68h+var_4C], 0
		mov	[esp+68h+var_50], 0
		mov	[esp+68h+var_54], 0
		mov	[esp+68h+var_58], 0
		mov	[esp+68h+Str], 0
		mov	[esp+68h+var_60], 0
		mov	[esp+68h+var_64], offset aOptionAllowPin ; "OPTION allow-pinentry-notify"
		mov	[esp+68h+var_68], eax
		call	assuan_transact

loc_40DADD:				; CODE XREF: sub_40D9FF+97j
		mov	eax, [ebp+var_1C]

loc_40DAE0:				; CODE XREF: sub_40D9FF+17j
		add	esp, 5Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40D9FF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40DAE8	proc near		; DATA XREF: sub_40DBAB+236o
					; .text:0040DFB6o

Str		= dword	ptr -18h
EndPtr		= dword	ptr -14h
Radix		= dword	ptr -10h
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 10h
		mov	eax, dword ptr [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aPinentry_launc ; "PINENTRY_LAUNCHED"
		mov	ecx, 11h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40DB5A
		mov	eax, dword ptr [ebp+arg_4]
		add	eax, 11h
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40DB32
		mov	eax, dword ptr [ebp+arg_4]
		add	eax, 11h
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40DB5A

loc_40DB32:				; CODE XREF: sub_40DAE8+3Bj
		mov	eax, dword ptr [ebp+arg_4]
		add	eax, 11h
		mov	[esp+18h+Radix], 0Ah ; Radix
		mov	[esp+18h+EndPtr], 0 ; EndPtr
		mov	[esp+18h+Str], eax ; Str
		call	strtoul
		mov	[esp+18h+Str], eax ; DWORD
		call	sub_41D0C0
		jmp	short loc_40DB6D
; ---------------------------------------------------------------------------

loc_40DB5A:				; CODE XREF: sub_40DAE8+2Ej
					; sub_40DAE8+48j
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+18h+EndPtr], eax ;	char
		mov	[esp+18h+Str], offset aIgnoringGpgAge ;	"ignoring gpg-agent inquiry `%s'\n"
		call	sub_4209BA

loc_40DB6D:				; CODE XREF: sub_40DAE8+70j
		mov	eax, 0
		add	esp, 10h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40DAE8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40DB79(int, void *, size_t)
sub_40DB79	proc near		; DATA XREF: sub_40DBAB+248o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_40DBA4
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax ;	size_t
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	void *
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_41D3B4

loc_40DBA4:				; CODE XREF: sub_40DB79+10j
		mov	eax, 0
		leave
		retn
sub_40DB79	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40DBAB	proc near		; CODE XREF: sub_403806+FAp

var_458		= dword	ptr -458h
var_454		= dword	ptr -454h
var_450		= dword	ptr -450h
var_44C		= dword	ptr -44Ch
var_448		= dword	ptr -448h
var_444		= dword	ptr -444h
var_440		= dword	ptr -440h
var_43C		= dword	ptr -43Ch
var_438		= dword	ptr -438h
var_428		= dword	ptr -428h
var_424		= dword	ptr -424h
var_412		= byte ptr -412h
var_29		= byte ptr -29h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 450h
		mov	[ebp+var_24], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_1C]
		mov	dword ptr [eax], 0
		call	sub_40D9FF
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40DBF1
		mov	eax, [ebp+var_C]
		jmp	loc_40DF30
; ---------------------------------------------------------------------------

loc_40DBF1:				; CODE XREF: sub_40DBAB+3Cj
		mov	eax, ds:dword_430200
		mov	[esp+458h+var_43C], 0
		mov	[esp+458h+var_440], 0
		mov	[esp+458h+var_444], 0
		mov	[esp+458h+var_448], 0
		mov	[esp+458h+var_44C], 0
		mov	[esp+458h+var_450], 0
		mov	[esp+458h+var_454], offset aGetinfoCmd_has ; "GETINFO cmd_has_option GET_PASSPHRASE r"...
		mov	[esp+458h+var_458], eax
		call	assuan_transact
		test	eax, eax
		jz	short loc_40DC4B
		mov	[esp+458h+var_458], 3Ch
		call	sub_40D977
		jmp	loc_40DF30
; ---------------------------------------------------------------------------

loc_40DC4B:				; CODE XREF: sub_40DBAB+8Dj
		cmp	[ebp+arg_0], 0
		jz	short loc_40DC60
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40DC60
		mov	eax, [ebp+arg_0]
		jmp	short loc_40DC65
; ---------------------------------------------------------------------------

loc_40DC60:				; CODE XREF: sub_40DBAB+A4j
					; sub_40DBAB+AEj
		mov	eax, 0

loc_40DC65:				; CODE XREF: sub_40DBAB+B3j
		mov	[ebp+var_24], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_40DC90
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40DC90
		mov	eax, [ebp+arg_4]
		mov	[esp+458h+var_458], eax
		call	sub_40DFE4
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	loc_40DEFD

loc_40DC90:				; CODE XREF: sub_40DBAB+C1j
					; sub_40DBAB+CBj
		cmp	[ebp+arg_8], 0
		jz	short loc_40DCB8
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40DCB8
		mov	eax, [ebp+arg_8]
		mov	[esp+458h+var_458], eax
		call	sub_40DFE4
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	loc_40DF00

loc_40DCB8:				; CODE XREF: sub_40DBAB+E9j
					; sub_40DBAB+F3j
		cmp	[ebp+arg_C], 0
		jz	short loc_40DCE0
		mov	eax, [ebp+arg_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40DCE0
		mov	eax, [ebp+arg_C]
		mov	[esp+458h+var_458], eax
		call	sub_40DFE4
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	loc_40DF03

loc_40DCE0:				; CODE XREF: sub_40DBAB+111j
					; sub_40DBAB+11Bj
		cmp	[ebp+var_18], 0
		jz	short loc_40DCEB
		mov	esi, [ebp+var_18]
		jmp	short loc_40DCF0
; ---------------------------------------------------------------------------

loc_40DCEB:				; CODE XREF: sub_40DBAB+139j
		mov	esi, offset asc_42C069 ; "X"

loc_40DCF0:				; CODE XREF: sub_40DBAB+13Ej
		cmp	[ebp+var_14], 0
		jz	short loc_40DCFB
		mov	ebx, [ebp+var_14]
		jmp	short loc_40DD00
; ---------------------------------------------------------------------------

loc_40DCFB:				; CODE XREF: sub_40DBAB+149j
		mov	ebx, offset asc_42C069 ; "X"

loc_40DD00:				; CODE XREF: sub_40DBAB+14Ej
		cmp	[ebp+var_10], 0
		jz	short loc_40DD0B
		mov	ecx, [ebp+var_10]
		jmp	short loc_40DD10
; ---------------------------------------------------------------------------

loc_40DD0B:				; CODE XREF: sub_40DBAB+159j
		mov	ecx, offset asc_42C069 ; "X"

loc_40DD10:				; CODE XREF: sub_40DBAB+15Ej
		cmp	[ebp+var_24], 0
		jz	short loc_40DD1B
		mov	edx, [ebp+var_24]
		jmp	short loc_40DD20
; ---------------------------------------------------------------------------

loc_40DD1B:				; CODE XREF: sub_40DBAB+169j
		mov	edx, offset asc_42C069 ; "X"

loc_40DD20:				; CODE XREF: sub_40DBAB+16Ej
		cmp	[ebp+arg_14], 0
		jz	short loc_40DD2D
		mov	eax, offset aCheck ; "--check "
		jmp	short loc_40DD32
; ---------------------------------------------------------------------------

loc_40DD2D:				; CODE XREF: sub_40DBAB+179j
		mov	eax, offset dword_42C074

loc_40DD32:				; CODE XREF: sub_40DBAB+180j
		mov	[esp+458h+var_438], esi
		mov	[esp+458h+var_43C], ebx
		mov	[esp+458h+var_440], ecx
		mov	[esp+458h+var_444], edx
		mov	edx, [ebp+arg_10]
		mov	[esp+458h+var_448], edx
		mov	[esp+458h+var_44C], eax
		mov	[esp+458h+var_450], offset aGet_passphrase ; "GET_PASSPHRASE --data %s--repeat=%d -- "...
		mov	[esp+458h+var_454], 3E9h
		lea	eax, [ebp+var_412]
		mov	[esp+458h+var_458], eax
		call	sub_416641
		mov	[ebp+var_29], 0
		mov	eax, [ebp+var_10]
		mov	[esp+458h+var_458], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		mov	[esp+458h+var_458], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+458h+var_458], eax
		call	gcry_free
		cmp	[ebp+arg_18], 0
		jz	short loc_40DDAE
		mov	[esp+458h+var_454], 40h
		lea	eax, [ebp+var_424]
		mov	[esp+458h+var_458], eax
		call	sub_41D364
		jmp	short loc_40DDC4
; ---------------------------------------------------------------------------

loc_40DDAE:				; CODE XREF: sub_40DBAB+1E9j
		mov	[esp+458h+var_454], 40h
		lea	eax, [ebp+var_424]
		mov	[esp+458h+var_458], eax
		call	sub_41D314

loc_40DDC4:				; CODE XREF: sub_40DBAB+201j
		mov	eax, ds:dword_430200
		mov	[esp+458h+var_43C], 0
		mov	[esp+458h+var_440], 0
		mov	[esp+458h+var_444], 0
		mov	[esp+458h+var_448], offset sub_40DAE8
		lea	edx, [ebp+var_424]
		mov	[esp+458h+var_44C], edx
		mov	[esp+458h+var_450], offset sub_40DB79
		lea	edx, [ebp+var_412]
		mov	[esp+458h+var_454], edx
		mov	[esp+458h+var_458], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40DE55
		mov	eax, [ebp+var_C]
		mov	[esp+458h+var_458], eax
		call	sub_40D99F
		test	eax, eax
		jz	short loc_40DE55
		mov	eax, [ebp+var_C]
		mov	[esp+458h+var_458], eax
		call	sub_40D992
		cmp	eax, 115h
		jnz	short loc_40DE55
		mov	eax, [ebp+var_C]
		mov	[esp+458h+var_458], eax
		call	sub_40D99F
		mov	[esp+458h+var_454], 63h
		mov	[esp+458h+var_458], eax
		call	sub_40D950
		mov	[ebp+var_C], eax

loc_40DE55:				; CODE XREF: sub_40DBAB+269j
					; sub_40DBAB+278j ...
		cmp	[ebp+var_C], 0
		jz	short loc_40DEAE
		lea	eax, [ebp+var_428]
		mov	[esp+458h+var_454], eax
		lea	eax, [ebp+var_424]
		mov	[esp+458h+var_458], eax
		call	sub_41D4E6
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jz	short loc_40DEA1
		mov	eax, [ebp+var_28]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_428]
		mov	[ebp+var_20], eax
		jmp	short loc_40DE9B
; ---------------------------------------------------------------------------

loc_40DE8D:				; CODE XREF: sub_40DBAB+2F4j
		mov	eax, [ebp+var_1C]
		mov	byte ptr [eax],	0
		add	[ebp+var_1C], 1
		sub	[ebp+var_20], 1

loc_40DE9B:				; CODE XREF: sub_40DBAB+2E0j
		cmp	[ebp+var_20], 0
		jnz	short loc_40DE8D

loc_40DEA1:				; CODE XREF: sub_40DBAB+2CFj
		mov	eax, [ebp+var_28]
		mov	[esp+458h+var_458], eax
		call	gcry_free
		jmp	short loc_40DEF8
; ---------------------------------------------------------------------------

loc_40DEAE:				; CODE XREF: sub_40DBAB+2AEj
		mov	[esp+458h+var_450], 1 ;	size_t
		mov	[esp+458h+var_454], offset dword_42C074	; void *
		lea	eax, [ebp+var_424]
		mov	[esp+458h+var_458], eax	; int
		call	sub_41D3B4
		mov	[esp+458h+var_454], 0
		lea	eax, [ebp+var_424]
		mov	[esp+458h+var_458], eax
		call	sub_41D4E6
		mov	edx, [ebp+arg_1C]
		mov	[edx], eax
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40DEF8
		call	sub_40D9AD
		mov	[ebp+var_C], eax

loc_40DEF8:				; CODE XREF: sub_40DBAB+301j
					; sub_40DBAB+343j
		mov	eax, [ebp+var_C]
		jmp	short loc_40DF30
; ---------------------------------------------------------------------------

loc_40DEFD:				; CODE XREF: sub_40DBAB+DFj
		nop
		jmp	short loc_40DF04
; ---------------------------------------------------------------------------

loc_40DF00:				; CODE XREF: sub_40DBAB+107j
		nop
		jmp	short loc_40DF04
; ---------------------------------------------------------------------------

loc_40DF03:				; CODE XREF: sub_40DBAB+12Fj
		nop

loc_40DF04:				; CODE XREF: sub_40DBAB+353j
					; sub_40DBAB+356j
		call	sub_40D9AD
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+458h+var_458], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		mov	[esp+458h+var_458], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+458h+var_458], eax
		call	gcry_free
		mov	eax, [ebp+var_C]

loc_40DF30:				; CODE XREF: sub_40DBAB+41j
					; sub_40DBAB+9Bj ...
		add	esp, 450h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_40DBAB	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 418h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_40DF53
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40DF5D

loc_40DF53:				; CODE XREF: .text:0040DF47j
		mov	eax, 0
		jmp	locret_40DFE0
; ---------------------------------------------------------------------------

loc_40DF5D:				; CODE XREF: .text:0040DF51j
		call	sub_40D9FF
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40DF70
		mov	eax, [ebp-0Ch]
		jmp	short locret_40DFE0
; ---------------------------------------------------------------------------

loc_40DF70:				; CODE XREF: .text:0040DF69j
		mov	eax, [ebp+8]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset aClear_passphra ; "CLEAR_PASSPHRASE %s"
		mov	dword ptr [esp+4], 3E9h
		lea	eax, [ebp-3F6h]
		mov	[esp], eax
		call	sub_416641
		mov	byte ptr [ebp-0Dh], 0
		mov	eax, ds:dword_430200
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], offset sub_40DAE8
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		lea	edx, [ebp-3F6h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	assuan_transact

locret_40DFE0:				; CODE XREF: .text:0040DF58j
					; .text:0040DF6Ej
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40DFE4	proc near		; CODE XREF: sub_40DBAB+D3p
					; sub_40DBAB+FBp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_14], 1
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		jmp	short loc_40E02F
; ---------------------------------------------------------------------------

loc_40DFF9:				; CODE XREF: sub_40DFE4+53j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Bh
		jz	short loc_40E021
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jz	short loc_40E021
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_40E021
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		ja	short loc_40E027

loc_40E021:				; CODE XREF: sub_40DFE4+1Dj
					; sub_40DFE4+27j ...
		add	[ebp+var_14], 3
		jmp	short loc_40E02B
; ---------------------------------------------------------------------------

loc_40E027:				; CODE XREF: sub_40DFE4+3Bj
		add	[ebp+var_14], 1

loc_40E02B:				; CODE XREF: sub_40DFE4+41j
		add	[ebp+var_10], 1

loc_40E02F:				; CODE XREF: sub_40DFE4+13j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40DFF9
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	gcry_malloc
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_40E05D
		mov	eax, 0
		jmp	locret_40E0FB
; ---------------------------------------------------------------------------

loc_40E05D:				; CODE XREF: sub_40DFE4+6Dj
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		jmp	short loc_40E0E4
; ---------------------------------------------------------------------------

loc_40E065:				; CODE XREF: sub_40DFE4+108j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Bh
		jz	short loc_40E08D
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jz	short loc_40E08D
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_40E08D
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		ja	short loc_40E0BB

loc_40E08D:				; CODE XREF: sub_40DFE4+89j
					; sub_40DFE4+93j ...
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], offset a02x_0	; "%%%02X"
		mov	[esp+28h+var_24], 4
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_416641
		add	[ebp+var_C], 3
		jmp	short loc_40E0E0
; ---------------------------------------------------------------------------

loc_40E0BB:				; CODE XREF: sub_40DFE4+A7j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_40E0D1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	2Bh
		add	[ebp+var_C], 1
		jmp	short loc_40E0E0
; ---------------------------------------------------------------------------

loc_40E0D1:				; CODE XREF: sub_40DFE4+DFj
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_40E0E0:				; CODE XREF: sub_40DFE4+D5j
					; sub_40DFE4+EBj
		add	[ebp+var_10], 1

loc_40E0E4:				; CODE XREF: sub_40DFE4+7Fj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_40E065
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_18]

locret_40E0FB:				; CODE XREF: sub_40DFE4+74j
		leave
		retn
sub_40DFE4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E0FD	proc near		; CODE XREF: sub_40E287+46p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_4], eax
		jmp	loc_40E219
; ---------------------------------------------------------------------------

loc_40E10E:				; CODE XREF: sub_40E0FD+124j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_40E1EE
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_40E1EE
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_40E1EE
		add	[ebp+arg_4], 1
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_40E15F
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_40E18B
; ---------------------------------------------------------------------------

loc_40E15F:				; CODE XREF: sub_40E0FD+4Dj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_40E17A
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_40E189
; ---------------------------------------------------------------------------

loc_40E17A:				; CODE XREF: sub_40E0FD+6Aj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_40E189:				; CODE XREF: sub_40E0FD+7Bj
		mov	edx, eax

loc_40E18B:				; CODE XREF: sub_40E0FD+60j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_40E1A6
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_40E1CD
; ---------------------------------------------------------------------------

loc_40E1A6:				; CODE XREF: sub_40E0FD+99j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_40E1C1
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_40E1CD
; ---------------------------------------------------------------------------

loc_40E1C1:				; CODE XREF: sub_40E0FD+B4j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_40E1CD:				; CODE XREF: sub_40E0FD+A7j
					; sub_40E0FD+C2j
		add	edx, eax
		mov	eax, [ebp+var_4]
		mov	[eax], dl
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40E1E8
		mov	eax, [ebp+arg_C]
		mov	edx, eax
		mov	eax, [ebp+var_4]
		mov	[eax], dl

loc_40E1E8:				; CODE XREF: sub_40E0FD+DFj
		add	[ebp+arg_4], 1
		jmp	short loc_40E211
; ---------------------------------------------------------------------------

loc_40E1EE:				; CODE XREF: sub_40E0FD+19j
					; sub_40E0FD+2Aj ...
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Bh
		jnz	short loc_40E206
		cmp	[ebp+arg_8], 0
		jz	short loc_40E206
		mov	eax, [ebp+var_4]
		mov	byte ptr [eax],	20h
		jmp	short loc_40E211
; ---------------------------------------------------------------------------

loc_40E206:				; CODE XREF: sub_40E0FD+F9j
					; sub_40E0FD+FFj
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_4]
		mov	[eax], dl

loc_40E211:				; CODE XREF: sub_40E0FD+EFj
					; sub_40E0FD+107j
		add	[ebp+var_4], 1
		add	[ebp+arg_4], 1

loc_40E219:				; CODE XREF: sub_40E0FD+Cj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_40E10E
		mov	edx, [ebp+var_4]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		leave
		retn
sub_40E0FD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E235	proc near		; CODE XREF: sub_40E287+Cp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		jmp	short loc_40E278
; ---------------------------------------------------------------------------

loc_40E244:				; CODE XREF: sub_40E235+4Bj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_40E270
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40E270
		mov	eax, [ebp+arg_0]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40E270
		add	[ebp+arg_0], 1
		add	[ebp+arg_0], 1

loc_40E270:				; CODE XREF: sub_40E235+17j
					; sub_40E235+24j ...
		add	[ebp+arg_0], 1
		add	[ebp+var_4], 1

loc_40E278:				; CODE XREF: sub_40E235+Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40E244
		mov	eax, [ebp+var_4]
		leave
		retn
sub_40E235	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E287	proc near		; CODE XREF: sub_40E309+1Bp
					; .text:0040E346p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40E235
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+var_28], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40E304
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_40E0FD
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_C]
		jz	short loc_40E2F9
		mov	[esp+28h+var_20], 92h ;	int
		mov	[esp+28h+var_24], offset a____Gnupg22__4 ; "../../gnupg2-2.0.30/common/percent.c"
		mov	[esp+28h+var_28], offset aNNbytes ; "n == nbytes"
		call	sub_4276E0

loc_40E2F9:				; CODE XREF: sub_40E287+54j
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		add	eax, edx
		mov	byte ptr [eax],	0

loc_40E304:				; CODE XREF: sub_40E287+29j
		mov	eax, [ebp+var_10]
		leave
		retn
sub_40E287	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E309	proc near		; CODE XREF: sub_4032E3+3DDp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_10], eax
		mov	[esp+18h+var_14], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_40E287
		leave
		retn
sub_40E309	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40E287
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E34D	proc near		; CODE XREF: .text:0040E4A8p
					; .text:0040E4CAp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+var_8]
		mov	[ebp+var_4], eax
		jmp	loc_40E471
; ---------------------------------------------------------------------------

loc_40E364:				; CODE XREF: sub_40E34D+12Cj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_40E444
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_40E444
		mov	eax, [ebp+arg_0]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_40E444
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40E3B5
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_40E3E1
; ---------------------------------------------------------------------------

loc_40E3B5:				; CODE XREF: sub_40E34D+53j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_40E3D0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_40E3DF
; ---------------------------------------------------------------------------

loc_40E3D0:				; CODE XREF: sub_40E34D+70j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_40E3DF:				; CODE XREF: sub_40E34D+81j
		mov	edx, eax

loc_40E3E1:				; CODE XREF: sub_40E34D+66j
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40E3FC
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_40E423
; ---------------------------------------------------------------------------

loc_40E3FC:				; CODE XREF: sub_40E34D+9Fj
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_40E417
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_40E423
; ---------------------------------------------------------------------------

loc_40E417:				; CODE XREF: sub_40E34D+BAj
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_40E423:				; CODE XREF: sub_40E34D+ADj
					; sub_40E34D+C8j
		add	edx, eax
		mov	eax, [ebp+var_4]
		mov	[eax], dl
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40E43E
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, [ebp+var_4]
		mov	[eax], dl

loc_40E43E:				; CODE XREF: sub_40E34D+E5j
		add	[ebp+arg_0], 1
		jmp	short loc_40E469
; ---------------------------------------------------------------------------

loc_40E444:				; CODE XREF: sub_40E34D+1Fj
					; sub_40E34D+30j ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Bh
		jnz	short loc_40E45C
		cmp	[ebp+arg_4], 0
		jz	short loc_40E45C
		mov	eax, [ebp+var_4]
		mov	byte ptr [eax],	20h
		jmp	short loc_40E469
; ---------------------------------------------------------------------------

loc_40E45C:				; CODE XREF: sub_40E34D+FFj
					; sub_40E34D+105j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_4]
		mov	[eax], dl

loc_40E469:				; CODE XREF: sub_40E34D+F5j
					; sub_40E34D+10Dj
		add	[ebp+var_4], 1
		add	[ebp+arg_0], 1

loc_40E471:				; CODE XREF: sub_40E34D+12j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_40E364
		mov	edx, [ebp+var_4]
		mov	eax, [ebp+var_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		leave
		retn
sub_40E34D	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40E34D
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40E34D
		leave
		retn
; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		mov	dword ptr [ebp-0Ch], 0
		jmp	loc_40E61F
; ---------------------------------------------------------------------------

loc_40E4EC:				; CODE XREF: .text:0040E625j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40E500
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40E528

loc_40E500:				; CODE XREF: .text:0040E4F4j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_40E514
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_40E528

loc_40E514:				; CODE XREF: .text:0040E508j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_40E576
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_40E576

loc_40E528:				; CODE XREF: .text:0040E4FEj
					; .text:0040E512j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40E542
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40E580

loc_40E542:				; CODE XREF: .text:0040E533j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_40E55C
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_40E580

loc_40E55C:				; CODE XREF: .text:0040E54Dj
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_40E576
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	short loc_40E580

loc_40E576:				; CODE XREF: .text:0040E51Cj
					; .text:0040E526j ...
		mov	eax, 0FFFFFFFFh
		jmp	locret_40E686
; ---------------------------------------------------------------------------

loc_40E580:				; CODE XREF: .text:0040E540j
					; .text:0040E55Aj ...
		mov	eax, [ebp-0Ch]
		mov	ecx, eax
		add	ecx, [ebp+0Ch]
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40E5A5
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_40E5D1
; ---------------------------------------------------------------------------

loc_40E5A5:				; CODE XREF: .text:0040E590j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_40E5C0
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_40E5CF
; ---------------------------------------------------------------------------

loc_40E5C0:				; CODE XREF: .text:0040E5ADj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_40E5CF:				; CODE XREF: .text:0040E5BEj
		mov	edx, eax

loc_40E5D1:				; CODE XREF: .text:0040E5A3j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40E5EC
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_40E613
; ---------------------------------------------------------------------------

loc_40E5EC:				; CODE XREF: .text:0040E5DCj
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_40E607
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_40E613
; ---------------------------------------------------------------------------

loc_40E607:				; CODE XREF: .text:0040E5F7j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_40E613:				; CODE XREF: .text:0040E5EAj
					; .text:0040E605j
		add	eax, edx
		mov	[ecx], al
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 2

loc_40E61F:				; CODE XREF: .text:0040E4E7j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jb	loc_40E4EC
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40E65D
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_40E656
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_40E65D

loc_40E656:				; CODE XREF: .text:0040E63Dj
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40E686
; ---------------------------------------------------------------------------

loc_40E65D:				; CODE XREF: .text:0040E633j
					; .text:0040E654j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jz	short loc_40E66C
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40E686
; ---------------------------------------------------------------------------

loc_40E66C:				; CODE XREF: .text:0040E663j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40E67A
		add	dword ptr [ebp-10h], 1

loc_40E67A:				; CODE XREF: .text:0040E674j
		mov	edx, [ebp-10h]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_40E686:				; CODE XREF: .text:0040E57Bj
					; .text:0040E65Bj ...
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-0Ch], 0
		jmp	loc_40E81D
; ---------------------------------------------------------------------------

loc_40E6A7:				; CODE XREF: .text:0040E823j
		cmp	dword ptr [ebp-0Ch], 1
		jnz	short loc_40E6C4
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_40E6C4
		mov	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_40E6EA
; ---------------------------------------------------------------------------

loc_40E6C4:				; CODE XREF: .text:0040E6ABj
					; .text:0040E6B5j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_40E6DA
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_40E6DA
		add	dword ptr [ebp-10h], 1
		jmp	short loc_40E6EA
; ---------------------------------------------------------------------------

loc_40E6DA:				; CODE XREF: .text:0040E6C8j
					; .text:0040E6D2j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_40E6EA
		mov	eax, 0FFFFFFFFh
		jmp	locret_40E895
; ---------------------------------------------------------------------------

loc_40E6EA:				; CODE XREF: .text:0040E6C2j
					; .text:0040E6D8j ...
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40E6FE
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40E726

loc_40E6FE:				; CODE XREF: .text:0040E6F2j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_40E712
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_40E726

loc_40E712:				; CODE XREF: .text:0040E706j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_40E774
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_40E774

loc_40E726:				; CODE XREF: .text:0040E6FCj
					; .text:0040E710j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40E740
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40E77E

loc_40E740:				; CODE XREF: .text:0040E731j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_40E75A
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_40E77E

loc_40E75A:				; CODE XREF: .text:0040E74Bj
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_40E774
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	short loc_40E77E

loc_40E774:				; CODE XREF: .text:0040E71Aj
					; .text:0040E724j ...
		mov	eax, 0FFFFFFFFh
		jmp	locret_40E895
; ---------------------------------------------------------------------------

loc_40E77E:				; CODE XREF: .text:0040E73Ej
					; .text:0040E758j ...
		mov	eax, [ebp-0Ch]
		mov	ecx, eax
		add	ecx, [ebp+0Ch]
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40E7A3
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_40E7CF
; ---------------------------------------------------------------------------

loc_40E7A3:				; CODE XREF: .text:0040E78Ej
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_40E7BE
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_40E7CD
; ---------------------------------------------------------------------------

loc_40E7BE:				; CODE XREF: .text:0040E7ABj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_40E7CD:				; CODE XREF: .text:0040E7BCj
		mov	edx, eax

loc_40E7CF:				; CODE XREF: .text:0040E7A1j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40E7EA
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_40E811
; ---------------------------------------------------------------------------

loc_40E7EA:				; CODE XREF: .text:0040E7DAj
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_40E805
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_40E811
; ---------------------------------------------------------------------------

loc_40E805:				; CODE XREF: .text:0040E7F5j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_40E811:				; CODE XREF: .text:0040E7E8j
					; .text:0040E803j
		add	eax, edx
		mov	[ecx], al
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 2

loc_40E81D:				; CODE XREF: .text:0040E6A2j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jb	loc_40E6A7
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_40E83A
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40E895
; ---------------------------------------------------------------------------

loc_40E83A:				; CODE XREF: .text:0040E831j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40E86C
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_40E865
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_40E86C

loc_40E865:				; CODE XREF: .text:0040E84Cj
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40E895
; ---------------------------------------------------------------------------

loc_40E86C:				; CODE XREF: .text:0040E842j
					; .text:0040E863j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jz	short loc_40E87B
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40E895
; ---------------------------------------------------------------------------

loc_40E87B:				; CODE XREF: .text:0040E872j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40E889
		add	dword ptr [ebp-10h], 1

loc_40E889:				; CODE XREF: .text:0040E883j
		mov	edx, [ebp-10h]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_40E895:				; CODE XREF: .text:0040E6E5j
					; .text:0040E779j ...
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E897	proc near		; CODE XREF: sub_40E9C4+22p
					; .text:0040EA0Fp

var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jnz	short loc_40E913
		cmp	[ebp+arg_C], 0
		jz	short loc_40E8B0
		mov	eax, 3
		jmp	short loc_40E8B5
; ---------------------------------------------------------------------------

loc_40E8B0:				; CODE XREF: sub_40E897+10j
		mov	eax, 2

loc_40E8B5:				; CODE XREF: sub_40E897+17j
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		imul	eax, [ebp+arg_4]
		add	eax, 1
		mov	[ebp+var_18], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_40E8F5
		mov	eax, [ebp+var_18]
		sub	eax, 1
		mov	edx, 0
		div	[ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jz	short loc_40E8F5
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0
		jmp	locret_40E9C2
; ---------------------------------------------------------------------------

loc_40E8F5:				; CODE XREF: sub_40E897+32j
					; sub_40E897+45j
		mov	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	gcry_malloc
		mov	[ebp+arg_8], eax
		cmp	[ebp+arg_8], 0
		jnz	short loc_40E913
		mov	eax, 0
		jmp	locret_40E9C2
; ---------------------------------------------------------------------------

loc_40E913:				; CODE XREF: sub_40E897+Aj
					; sub_40E897+70j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		jmp	loc_40E9AF
; ---------------------------------------------------------------------------

loc_40E924:				; CODE XREF: sub_40E897+11Cj
		cmp	[ebp+arg_C], 0
		jz	short loc_40E93C
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_0]
		jz	short loc_40E93C
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	3Ah
		add	[ebp+var_10], 1

loc_40E93C:				; CODE XREF: sub_40E897+91j
					; sub_40E897+99j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_40E95E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 30h
		jmp	short loc_40E96A
; ---------------------------------------------------------------------------

loc_40E95E:				; CODE XREF: sub_40E897+B7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 37h

loc_40E96A:				; CODE XREF: sub_40E897+C5j
		mov	edx, [ebp+var_10]
		mov	[edx], al
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_40E992
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_40E99E
; ---------------------------------------------------------------------------

loc_40E992:				; CODE XREF: sub_40E897+EBj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 37h

loc_40E99E:				; CODE XREF: sub_40E897+F9j
		mov	edx, [ebp+var_10]
		mov	[edx], al
		add	[ebp+var_10], 1
		sub	[ebp+arg_4], 1
		add	[ebp+var_C], 1

loc_40E9AF:				; CODE XREF: sub_40E897+88j
		cmp	[ebp+arg_4], 0
		jnz	loc_40E924
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_8]

locret_40E9C2:				; CODE XREF: sub_40E897+59j
					; sub_40E897+77j
		leave
		retn
sub_40E897	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E9C4	proc near		; CODE XREF: sub_4039ED+1Bp
					; .text:004069EFp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_40E897
		leave
		retn
sub_40E9C4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 1
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40E897
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EA16	proc near		; CODE XREF: .text:0040ECFAp
					; .text:0040ED81p

C		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_18], 0
		cmp	[ebp+arg_C], 0
		jz	short loc_40EA38
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0

loc_40EA38:				; CODE XREF: sub_40EA16+17j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_40EA4F
; ---------------------------------------------------------------------------

loc_40EA47:				; CODE XREF: sub_40EA16+8Dj
					; sub_40EA16+A7j ...
		add	[ebp+var_C], 2
		add	[ebp+var_14], 1

loc_40EA4F:				; CODE XREF: sub_40EA16+2Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40EA63
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40EA8B

loc_40EA63:				; CODE XREF: sub_40EA16+41j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_40EA77
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_40EA8B

loc_40EA77:				; CODE XREF: sub_40EA16+55j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_40EADD
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_40EADD

loc_40EA8B:				; CODE XREF: sub_40EA16+4Bj
					; sub_40EA16+5Fj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40EAA5
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40EA47

loc_40EAA5:				; CODE XREF: sub_40EA16+80j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_40EABF
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_40EA47

loc_40EABF:				; CODE XREF: sub_40EA16+9Aj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_40EADD
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	loc_40EA47

loc_40EADD:				; CODE XREF: sub_40EA16+69j
					; sub_40EA16+73j ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40EB12
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_40EB08
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_40EB12

loc_40EB08:				; CODE XREF: sub_40EA16+D9j
		mov	eax, 0
		jmp	locret_40ECD5
; ---------------------------------------------------------------------------

loc_40EB12:				; CODE XREF: sub_40EA16+CFj
					; sub_40EA16+F0j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_0]
		jz	short loc_40EB34
		mov	eax, [ebp+var_C]
		sub	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jnz	short loc_40EB34
		mov	eax, [ebp+var_C]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	short loc_40EB3B

loc_40EB34:				; CODE XREF: sub_40EA16+102j
					; sub_40EA16+10Fj
		mov	eax, 1
		jmp	short loc_40EB40
; ---------------------------------------------------------------------------

loc_40EB3B:				; CODE XREF: sub_40EA16+11Cj
		mov	eax, 0

loc_40EB40:				; CODE XREF: sub_40EA16+123j
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_40EB4D
		add	[ebp+var_14], 1

loc_40EB4D:				; CODE XREF: sub_40EA16+131j
		cmp	[ebp+arg_4], 0
		jz	loc_40ECBF
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_8]
		jbe	short loc_40EB69
		mov	eax, 0
		jmp	locret_40ECD5
; ---------------------------------------------------------------------------

loc_40EB69:				; CODE XREF: sub_40EA16+147j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_40EC1A
; ---------------------------------------------------------------------------

loc_40EB7B:				; CODE XREF: sub_40EA16+258j
					; sub_40EA16+276j ...
		mov	eax, [ebp+var_10]
		mov	ecx, eax
		add	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40EBA0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_40EBCC
; ---------------------------------------------------------------------------

loc_40EBA0:				; CODE XREF: sub_40EA16+175j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_40EBBB
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_40EBCA
; ---------------------------------------------------------------------------

loc_40EBBB:				; CODE XREF: sub_40EA16+192j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_40EBCA:				; CODE XREF: sub_40EA16+1A3j
		mov	edx, eax

loc_40EBCC:				; CODE XREF: sub_40EA16+188j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40EBE7
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_40EC0E
; ---------------------------------------------------------------------------

loc_40EBE7:				; CODE XREF: sub_40EA16+1C1j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_40EC02
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_40EC0E
; ---------------------------------------------------------------------------

loc_40EC02:				; CODE XREF: sub_40EA16+1DCj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_40EC0E:				; CODE XREF: sub_40EA16+1CFj
					; sub_40EA16+1EAj
		add	eax, edx
		mov	[ecx], al
		add	[ebp+var_10], 1
		add	[ebp+var_C], 2

loc_40EC1A:				; CODE XREF: sub_40EA16+160j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40EC2E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40EC56

loc_40EC2E:				; CODE XREF: sub_40EA16+20Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_40EC42
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_40EC56

loc_40EC42:				; CODE XREF: sub_40EA16+220j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_40ECB0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_40ECB0

loc_40EC56:				; CODE XREF: sub_40EA16+216j
					; sub_40EA16+22Aj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40EC74
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	loc_40EB7B

loc_40EC74:				; CODE XREF: sub_40EA16+24Bj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_40EC92
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	loc_40EB7B

loc_40EC92:				; CODE XREF: sub_40EA16+269j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_40ECB0
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	loc_40EB7B

loc_40ECB0:				; CODE XREF: sub_40EA16+234j
					; sub_40EA16+23Ej ...
		cmp	[ebp+var_18], 0
		jz	short loc_40ECBF
		mov	eax, [ebp+var_10]
		add	eax, [ebp+arg_4]
		mov	byte ptr [eax],	0

loc_40ECBF:				; CODE XREF: sub_40EA16+13Bj
					; sub_40EA16+29Ej
		cmp	[ebp+arg_C], 0
		jz	short loc_40ECD2
		mov	eax, [ebp+var_14]
		sub	eax, 1
		mov	edx, eax
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_40ECD2:				; CODE XREF: sub_40EA16+2ADj
		mov	eax, [ebp+var_C]

locret_40ECD5:				; CODE XREF: sub_40EA16+F7j
					; sub_40EA16+14Ej
		leave
		retn
sub_40EA16	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40EA16
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40ED2B
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_40ED17
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0

loc_40ED17:				; CODE XREF: .text:0040ED0Cj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	short locret_40EDA9
; ---------------------------------------------------------------------------

loc_40ED2B:				; CODE XREF: .text:0040ED06j
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_40ED44
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+0Ch]
		mov	[eax], edx

loc_40ED44:				; CODE XREF: .text:0040ED2Fj
		mov	eax, [ebp-14h]
		add	eax, 1
		mov	[esp], eax
		call	gcry_malloc
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40ED62
		mov	eax, 0
		jmp	short locret_40EDA9
; ---------------------------------------------------------------------------

loc_40ED62:				; CODE XREF: .text:0040ED59j
		mov	eax, [ebp-14h]
		add	eax, 1
		mov	dword ptr [esp+0Ch], 0
		mov	[esp+8], eax
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40EA16
		test	eax, eax
		jnz	short loc_40EDA6
		mov	dword ptr [esp+8], offset aHex2str_alloc ; "hex2str_alloc"
		mov	dword ptr [esp+4], 0F4h
		mov	dword ptr [esp], offset	a____Gnupg22__5	; "../../gnupg2-2.0.30/common/convert.c"
		call	sub_420AAC
; ---------------------------------------------------------------------------

loc_40EDA6:				; CODE XREF: .text:0040ED88j
		mov	eax, [ebp-10h]

locret_40EDA9:				; CODE XREF: .text:0040ED29j
					; .text:0040ED60j
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EDAC	proc near		; CODE XREF: sub_40EE1E+32p
					; sub_40EE1E+82p ...
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_40EDAC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EDB1	proc near		; CODE XREF: .text:00412189p
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_40EDB1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40EDBB(size_t)
sub_40EDBB	proc near		; CODE XREF: sub_40EDD8+12p
					; sub_40EE1E+Dp ...

Size		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_40EDCB
		add	[ebp+arg_0], 1

loc_40EDCB:				; CODE XREF: sub_40EDBB+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Size],	eax ; Size
		call	malloc
		leave
		retn
sub_40EDBB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40EDD8(void *, size_t)
sub_40EDD8	proc near		; CODE XREF: .text:00412BDBp
					; .text:00412E07p
					; DATA XREF: ...

Memory		= dword	ptr -18h
NewSize		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_40EDF1
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+Memory], eax ;	size_t
		call	sub_40EDBB
		jmp	short locret_40EE03
; ---------------------------------------------------------------------------

loc_40EDF1:				; CODE XREF: sub_40EDD8+Aj
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+NewSize], eax ; NewSize
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	realloc

locret_40EE03:				; CODE XREF: sub_40EDD8+17j
		leave
		retn
sub_40EDD8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40EE05(void *)
sub_40EE05	proc near		; CODE XREF: sub_40EEB1+5Ap
					; sub_40F648+29p ...

Memory		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_40EE1C
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

locret_40EE1C:				; CODE XREF: sub_40EE05+Aj
		leave
		retn
sub_40EE05	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EE1E	proc near		; CODE XREF: sub_4101FC+E7p

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 0Ch ;	size_t
		call	sub_40EDBB
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40EE42
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_40EEAC
; ---------------------------------------------------------------------------

loc_40EE42:				; CODE XREF: sub_40EE1E+19j
		cmp	[ebp+arg_4], 0
		jnz	short loc_40EE55
		mov	eax, ds:dword_430244
		mov	[esp+28h+var_28], eax
		call	sub_40EDAC

loc_40EE55:				; CODE XREF: sub_40EE1E+28j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_0]
		mov	[eax], edx
		mov	edx, ds:dword_430240
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+8], offset dword_430240
		mov	eax, ds:dword_430240
		test	eax, eax
		jz	short loc_40EE8A
		mov	eax, ds:dword_430240
		mov	edx, [ebp+var_10]
		add	edx, 4
		mov	[eax+8], edx

loc_40EE8A:				; CODE XREF: sub_40EE1E+5Cj
		mov	eax, [ebp+var_10]
		mov	ds:dword_430240, eax
		cmp	[ebp+arg_4], 0
		jnz	short loc_40EEA5
		mov	eax, ds:dword_430244
		mov	[esp+28h+var_28], eax
		call	sub_40EDAC

loc_40EEA5:				; CODE XREF: sub_40EE1E+78j
		mov	[ebp+var_C], 0

loc_40EEAC:				; CODE XREF: sub_40EE1E+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40EE1E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EEB1	proc near		; CODE XREF: sub_410323+20p

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 0
		jnz	short loc_40EECA
		mov	eax, ds:dword_430244
		mov	[esp+28h+var_28], eax
		call	sub_40EDAC

loc_40EECA:				; CODE XREF: sub_40EEB1+Aj
		mov	eax, ds:dword_430240
		mov	[ebp+var_C], eax
		jmp	short loc_40EF1B
; ---------------------------------------------------------------------------

loc_40EED4:				; CODE XREF: sub_40EEB1+6Ej
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_40EF12
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		mov	edx, [edx+4]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40EF05
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		mov	edx, [edx+8]
		mov	[eax+8], edx

loc_40EF05:				; CODE XREF: sub_40EEB1+43j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40EE05
		jmp	short loc_40EF21
; ---------------------------------------------------------------------------

loc_40EF12:				; CODE XREF: sub_40EEB1+2Bj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[ebp+var_C], eax

loc_40EF1B:				; CODE XREF: sub_40EEB1+21j
		cmp	[ebp+var_C], 0
		jnz	short loc_40EED4

loc_40EF21:				; CODE XREF: sub_40EEB1+5Fj
		cmp	[ebp+arg_4], 0
		jnz	short locret_40EF34
		mov	eax, ds:dword_430244
		mov	[esp+28h+var_28], eax
		call	sub_40EDAC

locret_40EF34:				; CODE XREF: sub_40EEB1+74j
		leave
		retn
sub_40EEB1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EF36	proc near		; CODE XREF: sub_41234E+4Bp

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, ds:dword_430244
		mov	[esp+28h+var_28], eax
		call	sub_40EDAC
		mov	eax, ds:dword_430240
		mov	[ebp+var_C], eax
		jmp	short loc_40EF73
; ---------------------------------------------------------------------------

loc_40EF5A:				; CODE XREF: sub_40EF36+41j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+arg_0]
		call	eax
		or	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[ebp+var_C], eax

loc_40EF73:				; CODE XREF: sub_40EF36+22j
		cmp	[ebp+var_C], 0
		jnz	short loc_40EF5A
		mov	eax, ds:dword_430244
		mov	[esp+28h+var_28], eax
		call	sub_40EDAC
		mov	eax, [ebp+var_10]
		leave
		retn
sub_40EF36	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40EF8B()
sub_40EF8B	proc near		; DATA XREF: sub_40EFA9+19o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 0
		call	sub_41234E
		leave
		retn
sub_40EF8B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EFA9	proc near		; CODE XREF: sub_411400+6p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_430258
		test	eax, eax
		jnz	short loc_40EFCE
		mov	ds:dword_430258, 1
		mov	[esp+18h+var_18], offset sub_40EF8B ; _onexit_t
		call	sub_426210

loc_40EFCE:				; CODE XREF: sub_40EFA9+Dj
		mov	eax, 0
		leave
		retn
sub_40EFA9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EFD5	proc near		; CODE XREF: sub_410D56+69p
					; .text:004115AAp ...

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 0
		jnz	short loc_40F004
		cmp	[ebp+arg_8], 0
		jnz	short loc_40EFED
		cmp	[ebp+arg_C], 0
		jz	short loc_40F004

loc_40EFED:				; CODE XREF: sub_40EFD5+10j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_40F0BD
; ---------------------------------------------------------------------------

loc_40F004:				; CODE XREF: sub_40EFD5+Aj
					; sub_40EFD5+16j
		mov	[esp+28h+var_28], 28h ;	size_t
		call	sub_40EDBB
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40F025
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_40F0BA
; ---------------------------------------------------------------------------

loc_40F025:				; CODE XREF: sub_40EFD5+42j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_20]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	[eax+8], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_24]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_10]
		mov	[eax+18h], edx
		cmp	[ebp+arg_14], 0
		setnz	dl
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		and	ecx, 1
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFFEh
		or	edx, ecx
		mov	[eax+1Ch], dl
		cmp	[ebp+arg_18], 0
		jz	short loc_40F08A
		mov	eax, [ebp+arg_18]
		jmp	short loc_40F08F
; ---------------------------------------------------------------------------

loc_40F08A:				; CODE XREF: sub_40EFD5+AEj
		mov	eax, offset sub_40EDD8

loc_40F08F:				; CODE XREF: sub_40EFD5+B3j
		mov	edx, [ebp+var_10]
		mov	[edx+20h], eax
		cmp	[ebp+arg_1C], 0
		jz	short loc_40F0A0
		mov	eax, [ebp+arg_1C]
		jmp	short loc_40F0A5
; ---------------------------------------------------------------------------

loc_40F0A0:				; CODE XREF: sub_40EFD5+C4j
		mov	eax, offset sub_40EE05

loc_40F0A5:				; CODE XREF: sub_40EFD5+C9j
		mov	edx, [ebp+var_10]
		mov	[edx+24h], eax
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_40F0BA:				; CODE XREF: sub_40EFD5+4Bj
		mov	eax, [ebp+var_C]

locret_40F0BD:				; CODE XREF: sub_40EFD5+2Aj
		leave
		retn
sub_40EFD5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40F0BF(int, void *, size_t)
sub_40F0BF	proc near		; DATA XREF: .data:off_4292C0o

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+arg_8]
		jnb	short loc_40F0F7
		mov	eax, [ebp+var_C]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+arg_8], eax

loc_40F0F7:				; CODE XREF: sub_40F0BF+21j
		cmp	[ebp+arg_8], 0
		jz	short loc_40F134
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		add	edx, eax
		mov	eax, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+10h], edx

loc_40F134:				; CODE XREF: sub_40F0BF+3Cj
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		leave
		retn
sub_40F0BF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40F13F(int, void *, size_t)
sub_40F13F	proc near		; DATA XREF: .data:off_4292C4o

Dst		= dword	ptr -48h
Src		= dword	ptr -44h
Size		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+arg_8], 0
		jnz	short loc_40F15C
		mov	eax, 0
		jmp	loc_40F3BD
; ---------------------------------------------------------------------------

loc_40F15C:				; CODE XREF: sub_40F13F+11j
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		and	eax, 8
		test	eax, eax
		jz	short loc_40F174
		mov	eax, [ebp+var_10]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	[eax+10h], edx

loc_40F174:				; CODE XREF: sub_40F13F+27j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	edx, eax
		jnb	short loc_40F1A0
		mov	[esp+48h+Size],	283h ; int
		mov	[esp+48h+Src], offset a____Gnupg22__6 ;	"../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+48h+Dst], offset aMem_cookieMemo ;	"mem_cookie->memory_size >= mem_cookie->"...
		call	sub_4276E0

loc_40F1A0:				; CODE XREF: sub_40F13F+43j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 1
		test	al, al
		jnz	short loc_40F1D1
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_14]
		jbe	short loc_40F1D1
		mov	eax, [ebp+var_14]
		mov	[ebp+arg_8], eax

loc_40F1D1:				; CODE XREF: sub_40F13F+82j
					; sub_40F13F+8Aj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_14]
		jbe	loc_40F357
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_40F1EF
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		jmp	short loc_40F206
; ---------------------------------------------------------------------------

loc_40F1EF:				; CODE XREF: sub_40F13F+A6j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_14]
		mov	ecx, [ebp+arg_8]
		mov	ebx, ecx
		sub	ebx, edx
		mov	edx, ebx
		add	eax, edx
		mov	[ebp+var_C], eax

loc_40F206:				; CODE XREF: sub_40F13F+AEj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	eax, [ebp+var_C]
		jbe	short loc_40F228
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	loc_40F3BD
; ---------------------------------------------------------------------------

loc_40F228:				; CODE XREF: sub_40F13F+D0j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	short loc_40F289
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		add	eax, [ebp+var_C]
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	eax, [ebp+var_C]
		jbe	short loc_40F263
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	loc_40F3BD
; ---------------------------------------------------------------------------

loc_40F263:				; CODE XREF: sub_40F13F+10Bj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_C]
		mov	edx, 0
		div	[ebp+var_2C]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_C]
		imul	eax, edx
		mov	[ebp+var_C], eax

loc_40F289:				; CODE XREF: sub_40F13F+F1j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_40F2B5
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_C]
		jnb	short loc_40F2B5
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Ch
		mov	eax, 0FFFFFFFFh
		jmp	loc_40F3BD
; ---------------------------------------------------------------------------

loc_40F2B5:				; CODE XREF: sub_40F13F+152j
					; sub_40F13F+15Dj
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		mov	[esp+48h+Src], edx
		mov	[esp+48h+Dst], eax
		call	ecx
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_40F2E0
		mov	eax, 0FFFFFFFFh
		jmp	loc_40F3BD
; ---------------------------------------------------------------------------

loc_40F2E0:				; CODE XREF: sub_40F13F+195j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	edx, eax
		jnb	short loc_40F31E
		mov	[esp+48h+Size],	2B6h ; int
		mov	[esp+48h+Src], offset a____Gnupg22__6 ;	"../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+48h+Dst], offset aMem_cookieMemo ;	"mem_cookie->memory_size >= mem_cookie->"...
		call	sub_4276E0

loc_40F31E:				; CODE XREF: sub_40F13F+1C1j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_14]
		jbe	short loc_40F357
		mov	[esp+48h+Size],	2B9h ; int
		mov	[esp+48h+Src], offset a____Gnupg22__6 ;	"../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+48h+Dst], offset aSizeNleft ; "size <= nleft"
		call	sub_4276E0

loc_40F357:				; CODE XREF: sub_40F13F+98j
					; sub_40F13F+1FAj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		add	eax, edx
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+14h]
		cmp	edx, eax
		jbe	short loc_40F3A3
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_10]
		mov	[eax+14h], edx

loc_40F3A3:				; CODE XREF: sub_40F13F+251j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_10]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]

loc_40F3BD:				; CODE XREF: sub_40F13F+18j
					; sub_40F13F+E4j ...
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_40F13F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F3C3	proc near		; DATA XREF: .data:off_4292C8o

Dst		= dword	ptr -48h
Val		= dword	ptr -44h
Size		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_8]
		cmp	eax, 1
		jz	short loc_40F3F0
		cmp	eax, 2
		jz	short loc_40F419
		test	eax, eax
		jnz	short loc_40F442
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_40F459
; ---------------------------------------------------------------------------

loc_40F3F0:				; CODE XREF: sub_40F3C3+12j
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+10h]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_14]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_40F459
; ---------------------------------------------------------------------------

loc_40F419:				; CODE XREF: sub_40F3C3+17j
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+14h]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_14]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_40F459
; ---------------------------------------------------------------------------

loc_40F442:				; CODE XREF: sub_40F3C3+1Bj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_40F5DE
; ---------------------------------------------------------------------------

loc_40F459:				; CODE XREF: sub_40F3C3+2Bj
					; sub_40F3C3+54j ...
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jg	loc_40F56E
		cmp	edx, [ebp+var_C]
		jl	short loc_40F47B
		cmp	eax, [ebp+var_10]
		jnb	loc_40F56E

loc_40F47B:				; CODE XREF: sub_40F3C3+ADj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 1
		test	al, al
		jnz	short loc_40F4A0
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Ch
		mov	eax, 0FFFFFFFFh
		jmp	locret_40F5DE
; ---------------------------------------------------------------------------

loc_40F4A0:				; CODE XREF: sub_40F3C3+C4j
		mov	eax, [ebp+var_14]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		add	eax, edx
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jg	short loc_40F4DF
		cmp	edx, [ebp+var_C]
		jl	short loc_40F4C8
		cmp	eax, [ebp+var_10]
		jnb	short loc_40F4DF

loc_40F4C8:				; CODE XREF: sub_40F3C3+FEj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_40F5DE
; ---------------------------------------------------------------------------

loc_40F4DF:				; CODE XREF: sub_40F3C3+F9j
					; sub_40F3C3+103j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_18]
		mov	edx, 0
		div	[ebp+var_2C]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_18]
		imul	eax, edx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_40F531
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_18]
		jnb	short loc_40F531
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Ch
		mov	eax, 0FFFFFFFFh
		jmp	locret_40F5DE
; ---------------------------------------------------------------------------

loc_40F531:				; CODE XREF: sub_40F3C3+14Aj
					; sub_40F3C3+155j
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_18]
		mov	[esp+48h+Val], edx
		mov	[esp+48h+Dst], eax
		call	ecx
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_40F55C
		mov	eax, 0FFFFFFFFh
		jmp	locret_40F5DE
; ---------------------------------------------------------------------------

loc_40F55C:				; CODE XREF: sub_40F3C3+18Dj
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_1C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_18]
		mov	[eax+8], edx

loc_40F56E:				; CODE XREF: sub_40F3C3+A4j
					; sub_40F3C3+B2j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jg	short loc_40F5C2
		cmp	edx, [ebp+var_C]
		jl	short loc_40F588
		cmp	eax, [ebp+var_10]
		jnb	short loc_40F5C2

loc_40F588:				; CODE XREF: sub_40F3C3+1BEj
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_14]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		add	eax, edx
		mov	edx, ecx
		mov	[esp+48h+Size],	edx ; Size
		mov	[esp+48h+Val], 0 ; Val
		mov	[esp+48h+Dst], eax ; Dst
		call	memset
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	[eax+14h], edx

loc_40F5C2:				; CODE XREF: sub_40F3C3+1B9j
					; sub_40F3C3+1C3j
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	[eax+10h], edx
		mov	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	eax, 0

locret_40F5DE:				; CODE XREF: sub_40F3C3+91j
					; sub_40F3C3+D8j ...
		leave
		retn
sub_40F3C3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F5E0	proc near		; DATA XREF: sub_411638+109o

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+arg_4], 1
		jnz	short loc_40F62F
		mov	eax, [ebp+var_10]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [eax+10h]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+10h], 0
		mov	[ebp+var_C], 0
		jmp	short loc_40F643
; ---------------------------------------------------------------------------

loc_40F62F:				; CODE XREF: sub_40F5E0+10j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	[ebp+var_C], 0FFFFFFFFh

loc_40F643:				; CODE XREF: sub_40F5E0+4Dj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40F5E0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F648	proc near		; CODE XREF: sub_410D56+33Fp
					; .text:00411631p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_40F676
		mov	eax, [ebp+var_C]
		mov	edx, [eax+24h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+28h+var_28], eax
		call	edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40EE05

loc_40F676:				; CODE XREF: sub_40F648+10j
		mov	eax, 0
		leave
		retn
sub_40F648	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F67D	proc near		; CODE XREF: sub_4118BC+55p
					; .text:00413333p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 8 ; size_t
		call	sub_40EDBB
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40F6A1
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_40F6E0
; ---------------------------------------------------------------------------

loc_40F6A1:				; CODE XREF: sub_40F67D+19j
		mov	eax, [ebp+arg_8]
		and	eax, 8000h
		test	eax, eax
		jz	short loc_40F6C0
		mov	[esp+28h+var_24], 8000h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	_setmode

loc_40F6C0:				; CODE XREF: sub_40F67D+2Ej
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_40F6E0:				; CODE XREF: sub_40F67D+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40F67D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F6E5	proc near		; DATA XREF: .data:off_4292D0o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40F704
		mov	[ebp+var_C], 0
		jmp	short loc_40F736
; ---------------------------------------------------------------------------

loc_40F704:				; CODE XREF: sub_40F6E5+14j
					; sub_40F6E5+4Fj
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	_read
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_40F736
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_40F704

loc_40F736:				; CODE XREF: sub_40F6E5+1Dj
					; sub_40F6E5+41j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40F6E5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F73B	proc near		; DATA XREF: .data:off_4292D4o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40F759
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		jmp	short loc_40F78B
; ---------------------------------------------------------------------------

loc_40F759:				; CODE XREF: sub_40F73B+14j
					; sub_40F73B+4Ej
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	_write
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_40F78B
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_40F759

loc_40F78B:				; CODE XREF: sub_40F73B+1Cj
					; sub_40F73B+40j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40F73B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F790	proc near		; DATA XREF: .data:off_4292D8o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40F7BD
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Dh
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_40F819
; ---------------------------------------------------------------------------

loc_40F7BD:				; CODE XREF: sub_40F790+15j
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	ecx, [ecx]
		mov	ebx, [ebp+arg_8]
		mov	[esp+28h+var_1C], ebx
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_28], ecx
		call	j__lseeki64
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_14]
		mov	edx, eax
		xor	edx, 0FFFFFFFFh
		mov	eax, [ebp+var_18]
		xor	eax, 0FFFFFFFFh
		or	eax, edx
		test	eax, eax
		jnz	short loc_40F804
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_40F819
; ---------------------------------------------------------------------------

loc_40F804:				; CODE XREF: sub_40F790+69j
		mov	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	[ebp+var_C], 0

loc_40F819:				; CODE XREF: sub_40F790+2Bj
					; sub_40F790+72j
		mov	eax, [ebp+var_C]
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_40F790	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F822	proc near		; CODE XREF: sub_411413+10Fp
					; sub_4118BC+DAp ...

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40F875
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40F847
		mov	[ebp+var_C], 0
		jmp	short loc_40F868
; ---------------------------------------------------------------------------

loc_40F847:				; CODE XREF: sub_40F822+1Aj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_40F860
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		call	_close
		jmp	short loc_40F865
; ---------------------------------------------------------------------------

loc_40F860:				; CODE XREF: sub_40F822+2Dj
		mov	eax, 0

loc_40F865:				; CODE XREF: sub_40F822+3Cj
		mov	[ebp+var_C], eax

loc_40F868:				; CODE XREF: sub_40F822+23j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40EE05
		jmp	short loc_40F87C
; ---------------------------------------------------------------------------

loc_40F875:				; CODE XREF: sub_40F822+10j
		mov	[ebp+var_C], 0

loc_40F87C:				; CODE XREF: sub_40F822+51j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40F822	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40F881(int, FILE *, int, int)
sub_40F881	proc near		; CODE XREF: sub_4119F1+67p

File		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+File],	8 ; size_t
		call	sub_40EDBB
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40F8A5
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_40F8EC
; ---------------------------------------------------------------------------

loc_40F8A5:				; CODE XREF: sub_40F881+19j
		mov	eax, [ebp+arg_8]
		and	eax, 8000h
		test	eax, eax
		jz	short loc_40F8CC
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+File],	eax ; File
		call	_fileno
		mov	[esp+28h+var_24], 8000h
		mov	[esp+28h+File],	eax
		call	_setmode

loc_40F8CC:				; CODE XREF: sub_40F881+2Ej
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_40F8EC:				; CODE XREF: sub_40F881+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40F881	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40F8F1(int, void *, size_t)
sub_40F8F1	proc near		; DATA XREF: .data:off_4292E0o

DstBuf		= dword	ptr -28h
ElementSize	= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40F92E
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Count], eax ; Count
		mov	[esp+28h+ElementSize], 1 ; ElementSize
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+DstBuf], eax ;	DstBuf
		call	fread
		mov	[ebp+var_C], eax
		jmp	short loc_40F935
; ---------------------------------------------------------------------------

loc_40F92E:				; CODE XREF: sub_40F8F1+13j
		mov	[ebp+var_C], 0

loc_40F935:				; CODE XREF: sub_40F8F1+3Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_40F953
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+DstBuf], eax ;	File
		call	ferror
		test	eax, eax
		jz	short loc_40F953
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40F956
; ---------------------------------------------------------------------------

loc_40F953:				; CODE XREF: sub_40F8F1+48j
					; sub_40F8F1+59j
		mov	eax, [ebp+var_C]

locret_40F956:				; CODE XREF: sub_40F8F1+60j
		leave
		retn
sub_40F8F1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40F958(int, void *, size_t)
sub_40F958	proc near		; DATA XREF: .data:off_4292E4o

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40F995
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Count], eax ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		mov	[ebp+var_C], eax
		jmp	short loc_40F99B
; ---------------------------------------------------------------------------

loc_40F995:				; CODE XREF: sub_40F958+13j
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax

loc_40F99B:				; CODE XREF: sub_40F958+3Bj
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jz	short loc_40F9AA
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40F9AD
; ---------------------------------------------------------------------------

loc_40F9AA:				; CODE XREF: sub_40F958+49j
		mov	eax, [ebp+var_C]

locret_40F9AD:				; CODE XREF: sub_40F958+50j
		leave
		retn
sub_40F958	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F9AF	proc near		; DATA XREF: .data:off_4292E8o

File		= dword	ptr -28h
Offset		= dword	ptr -24h
Origin		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40F9D8
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Dh
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40FA37
; ---------------------------------------------------------------------------

loc_40F9D8:				; CODE XREF: sub_40F9AF+13j
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Origin], ecx ;	Origin
		mov	[esp+28h+Offset], edx ;	Offset
		mov	[esp+28h+File],	eax ; File
		call	fseek
		test	eax, eax
		jz	short loc_40FA05
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40FA37
; ---------------------------------------------------------------------------

loc_40FA05:				; CODE XREF: sub_40F9AF+4Dj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		call	ftell
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_40FA22
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40FA37
; ---------------------------------------------------------------------------

loc_40FA22:				; CODE XREF: sub_40F9AF+6Aj
		mov	eax, [ebp+var_10]
		mov	edx, eax
		sar	edx, 1Fh
		mov	ecx, [ebp+arg_4]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	eax, 0

locret_40FA37:				; CODE XREF: sub_40F9AF+27j
					; sub_40F9AF+54j ...
		leave
		retn
sub_40F9AF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40FA39	proc near		; CODE XREF: sub_4119F1+101p
					; DATA XREF: .data:off_4292ECo

File		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40FA98
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40FA84
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		call	fflush
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_40FA7A
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		call	fclose
		jmp	short loc_40FA7F
; ---------------------------------------------------------------------------

loc_40FA7A:				; CODE XREF: sub_40FA39+30j
		mov	eax, 0

loc_40FA7F:				; CODE XREF: sub_40FA39+3Fj
		mov	[ebp+var_C], eax
		jmp	short loc_40FA8B
; ---------------------------------------------------------------------------

loc_40FA84:				; CODE XREF: sub_40FA39+19j
		mov	[ebp+var_C], 0

loc_40FA8B:				; CODE XREF: sub_40FA39+49j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+File],	eax ; void *
		call	sub_40EE05
		jmp	short loc_40FA9F
; ---------------------------------------------------------------------------

loc_40FA98:				; CODE XREF: sub_40FA39+10j
		mov	[ebp+var_C], 0

loc_40FA9F:				; CODE XREF: sub_40FA39+5Dj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40FA39	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40FAA4	proc near		; CODE XREF: sub_411413+55p
					; .text:00411F21p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0FFFFFFFFh
		mov	[esp+28h+var_28], 8 ; size_t
		call	sub_40EDBB
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40FAD6
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_40FB43
; ---------------------------------------------------------------------------

loc_40FAD6:				; CODE XREF: sub_40FAA4+27j
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_20], 180h
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_28], eax
		call	_open
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_40FB02
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_40FB43
; ---------------------------------------------------------------------------

loc_40FB02:				; CODE XREF: sub_40FAA4+53j
		mov	eax, [ebp+arg_C]
		and	eax, 8000h
		test	eax, eax
		jz	short loc_40FB21
		mov	[esp+28h+var_24], 8000h
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	_setmode

loc_40FB21:				; CODE XREF: sub_40FAA4+68j
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_40FB43:				; CODE XREF: sub_40FAA4+30j
					; sub_40FAA4+5Cj
		cmp	[ebp+var_C], 0
		jz	short loc_40FB54
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40EE05

loc_40FB54:				; CODE XREF: sub_40FAA4+A3j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40FAA4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40FB59	proc near		; CODE XREF: sub_411413+28p
					; .text:00411551p ...

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	eax, 72h
		jz	short loc_40FB79
		cmp	eax, 77h
		jz	short loc_40FB89
		cmp	eax, 61h
		jz	short loc_40FB99
		jmp	short loc_40FBA9
; ---------------------------------------------------------------------------

loc_40FB79:				; CODE XREF: sub_40FB59+12j
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	short loc_40FBBD
; ---------------------------------------------------------------------------

loc_40FB89:				; CODE XREF: sub_40FB59+17j
		mov	[ebp+var_C], 1
		mov	[ebp+var_10], 300h
		jmp	short loc_40FBBD
; ---------------------------------------------------------------------------

loc_40FB99:				; CODE XREF: sub_40FB59+1Cj
		mov	[ebp+var_C], 1
		mov	[ebp+var_10], 108h
		jmp	short loc_40FBBD
; ---------------------------------------------------------------------------

loc_40FBA9:				; CODE XREF: sub_40FB59+1Ej
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40FC17
; ---------------------------------------------------------------------------

loc_40FBBD:				; CODE XREF: sub_40FB59+2Ej
					; sub_40FB59+3Ej ...
		add	[ebp+arg_0], 1
		jmp	short loc_40FBFB
; ---------------------------------------------------------------------------

loc_40FBC3:				; CODE XREF: sub_40FB59+AAj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	eax, 62h
		jz	short loc_40FBE4
		cmp	eax, 78h
		jz	short loc_40FBED
		cmp	eax, 2Bh
		jnz	short loc_40FBF6
		mov	[ebp+var_C], 2
		jmp	short loc_40FBF7
; ---------------------------------------------------------------------------

loc_40FBE4:				; CODE XREF: sub_40FB59+76j
		or	[ebp+var_10], 8000h
		jmp	short loc_40FBF7
; ---------------------------------------------------------------------------

loc_40FBED:				; CODE XREF: sub_40FB59+7Bj
		or	[ebp+var_10], 400h
		jmp	short loc_40FBF7
; ---------------------------------------------------------------------------

loc_40FBF6:				; CODE XREF: sub_40FB59+80j
		nop

loc_40FBF7:				; CODE XREF: sub_40FB59+89j
					; sub_40FB59+92j ...
		add	[ebp+arg_0], 1

loc_40FBFB:				; CODE XREF: sub_40FB59+68j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40FBC3
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, 0

locret_40FC17:				; CODE XREF: sub_40FB59+62j
		leave
		retn
sub_40FB59	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40FC19	proc near		; CODE XREF: sub_410434+2Fp
					; sub_410C6C+4Bp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+230h]
		test	eax, eax
		jnz	short loc_40FC4E
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 28h
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_40FCAA
; ---------------------------------------------------------------------------

loc_40FC4E:				; CODE XREF: sub_40FC19+1Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+230h]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_40FC9D
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_40FCAA
; ---------------------------------------------------------------------------

loc_40FC9D:				; CODE XREF: sub_40FC19+72j
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0

loc_40FCAA:				; CODE XREF: sub_40FC19+33j
					; sub_40FC19+82j
		cmp	[ebp+var_10], 0
		jz	short loc_40FCC8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl
		jmp	short loc_40FCE4
; ---------------------------------------------------------------------------

loc_40FCC8:				; CODE XREF: sub_40FC19+95j
		cmp	[ebp+var_C], 0
		jnz	short loc_40FCE4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 2
		mov	[eax+24Ch], dl

loc_40FCE4:				; CODE XREF: sub_40FC19+ADj
					; sub_40FC19+B3j
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_10]
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_40FC19	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40FD34	proc near		; CODE XREF: sub_4100F8+7Cp
					; sub_41054B+35p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 30h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+234h]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_40FD75
		mov	[esp+38h+var_30], 4F3h ; int
		mov	[esp+38h+var_34], offset a____Gnupg22__6 ; "../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+38h+var_38], offset aStreamFlags_wr ; "stream->flags.writing"
		call	sub_4276E0

loc_40FD75:				; CODE XREF: sub_40FD34+23j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_40FEA0
		cmp	[ebp+var_18], 0
		jnz	short loc_40FD95
		mov	[ebp+var_C], 28h
		jmp	loc_40FEA7
; ---------------------------------------------------------------------------

loc_40FD95:				; CODE XREF: sub_40FD34+53j
		mov	[ebp+var_14], 0
		mov	[ebp+var_C], 0
		jmp	short loc_40FE01
; ---------------------------------------------------------------------------

loc_40FDA5:				; CODE XREF: sub_40FD34+DEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	ecx, eax
		sub	ecx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+38h+var_30], ecx
		mov	[esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+var_18]
		call	eax
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jnz	short loc_40FDEF
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_40FDF5
; ---------------------------------------------------------------------------

loc_40FDEF:				; CODE XREF: sub_40FD34+A9j
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_10], eax

loc_40FDF5:				; CODE XREF: sub_40FD34+B9j
		mov	eax, [ebp+var_10]
		add	[ebp+var_14], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40FE16

loc_40FE01:				; CODE XREF: sub_40FD34+6Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		sub	eax, [ebp+var_14]
		test	eax, eax
		jle	short loc_40FE17
		cmp	[ebp+var_C], 0
		jz	short loc_40FDA5
		jmp	short loc_40FE17
; ---------------------------------------------------------------------------

loc_40FE16:				; CODE XREF: sub_40FD34+CBj
		nop

loc_40FE17:				; CODE XREF: sub_40FD34+D8j
					; sub_40FD34+E0j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_14]
		jnz	short loc_40FEA7
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+var_18]
		call	eax
		jmp	short loc_40FEA7
; ---------------------------------------------------------------------------

loc_40FEA0:				; CODE XREF: sub_40FD34+49j
		mov	[ebp+var_C], 0

loc_40FEA7:				; CODE XREF: sub_40FD34+5Cj
					; sub_40FD34+FDj ...
		cmp	[ebp+var_C], 0
		jz	short loc_40FEC3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl

loc_40FEC3:				; CODE XREF: sub_40FD34+177j
		mov	eax, [ebp+var_C]
		add	esp, 30h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_40FD34	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40FECD	proc near		; CODE XREF: sub_41073E+116p
					; sub_411224+33p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40FEFD
		mov	[esp+18h+var_10], 536h ; int
		mov	[esp+18h+var_14], offset a____Gnupg22__6 ; "../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+18h+var_18], offset aStreamFlags__0 ; "!stream->flags.writing"
		call	sub_4276E0

loc_40FEFD:				; CODE XREF: sub_40FECD+12j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		leave
		retn
sub_40FECD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40FF1D	proc near		; CODE XREF: sub_4101FC+D5p
					; .text:00411F79p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_4]
		mov	[eax+214h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+218h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+228h], 0
		mov	dword ptr [eax+22Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_C]
		mov	[eax+230h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_10]
		mov	[eax+234h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_14]
		mov	[eax+238h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+23Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_18]
		mov	[eax+240h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+244h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_8]
		mov	[eax+248h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFEFh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+254h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+258h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+25Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFEh
		mov	[eax+24Ch], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+24Ch], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFFDh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFF3h
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFFEh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+220h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFDFh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+arg_1C]
		and	eax, 1
		test	al, al
		jnz	short loc_4100DA
		mov	eax, [ebp+arg_1C]
		and	eax, 2
		test	eax, eax
		jz	short loc_4100E9

loc_4100DA:				; CODE XREF: sub_40FF1D+1B1j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		or	edx, 1
		mov	[eax+20h], dl
		jmp	short loc_4100F6
; ---------------------------------------------------------------------------

loc_4100E9:				; CODE XREF: sub_40FF1D+1BBj
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_4100F6:				; CODE XREF: sub_40FF1D+1CAj
		pop	ebp
		retn
sub_40FF1D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4100F8	proc near		; CODE XREF: sub_4101FC+112p
					; sub_410323+2Bp ...

File		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+25Ch]
		test	eax, eax
		jz	short loc_41014A
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+25Ch]
		mov	[esp+28h+File],	eax ; File
		call	fclose
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+25Ch], 0
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_41014A:				; CODE XREF: sub_4100F8+14j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+240h]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_41018E
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax
		call	sub_40FD34
		mov	[ebp+var_18], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41018E
		cmp	[ebp+var_18], 0
		jz	short loc_41018E
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_41018E:				; CODE XREF: sub_4100F8+74j
					; sub_4100F8+88j ...
		cmp	[ebp+var_14], 0
		jz	short loc_4101BD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+File],	eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4101BD
		cmp	[ebp+var_18], 0
		jz	short loc_4101BD
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_4101BD:				; CODE XREF: sub_4100F8+9Aj
					; sub_4100F8+B7j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	[esp+28h+File],	eax ; void *
		call	sub_40EE05
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+220h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFDFh
		mov	[eax+250h], dl
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4100F8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4101FC	proc near		; CODE XREF: sub_410D56+C8p
					; sub_411413+B9p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[esp+38h+var_38], 28h ;	size_t
		call	sub_40EDBB
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_410231
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_4102FC
; ---------------------------------------------------------------------------

loc_410231:				; CODE XREF: sub_4101FC+27j
		mov	[esp+38h+var_38], 260h ; size_t
		call	sub_40EDBB
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_410252
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_4102FC
; ---------------------------------------------------------------------------

loc_410252:				; CODE XREF: sub_4101FC+48j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+4], 200h
		mov	eax, [ebp+var_14]
		lea	edx, [eax+200h]
		mov	eax, [ebp+var_10]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+18h], 10h
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		mov	[eax+24h], edx
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+38h+var_38], eax
		call	sub_40EDAC
		mov	eax, [ebp+arg_1C]
		mov	[esp+38h+var_1C], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+var_24], eax
		mov	eax, [ebp+arg_18]
		mov	[esp+38h+var_20], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_40FF1D
		mov	eax, [ebp+arg_20]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_40EE1E
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4102FB
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_4102FC
; ---------------------------------------------------------------------------

loc_4102FB:				; CODE XREF: sub_4101FC+F3j
		nop

loc_4102FC:				; CODE XREF: sub_4101FC+30j
					; sub_4101FC+51j ...
		cmp	[ebp+var_C], 0
		jz	short loc_41031E
		cmp	[ebp+var_10], 0
		jz	short loc_41031E
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_4100F8
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax ;	void *
		call	sub_40EE05

loc_41031E:				; CODE XREF: sub_4101FC+104j
					; sub_4101FC+10Aj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4101FC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_410323(void *, int)
sub_410323	proc near		; CODE XREF: sub_410D56+32Bp
					; .text:00411FA9p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_0], 0
		jz	short loc_41036F
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40EEB1
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4100F8
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40EE05
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40EE05

loc_41036F:				; CODE XREF: sub_410323+11j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_410323	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410374	proc near		; CODE XREF: sub_41054B+DFp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+230h]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	short loc_4103E7
; ---------------------------------------------------------------------------

loc_41039B:				; CODE XREF: sub_410374+79j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_4103DB
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_4103F2
; ---------------------------------------------------------------------------

loc_4103DB:				; CODE XREF: sub_410374+5Cj
		cmp	[ebp+var_18], 0
		jz	short loc_4103F1
		mov	eax, [ebp+var_18]
		add	[ebp+var_C], eax

loc_4103E7:				; CODE XREF: sub_410374+25j
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jnz	short loc_41039B
		jmp	short loc_4103F2
; ---------------------------------------------------------------------------

loc_4103F1:				; CODE XREF: sub_410374+6Bj
		nop

loc_4103F2:				; CODE XREF: sub_410374+65j
					; sub_410374+7Bj
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+var_C]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_410374	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410434	proc near		; CODE XREF: sub_41051D+21p
					; sub_41054B+141p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		jmp	loc_4104FB
; ---------------------------------------------------------------------------

loc_41044D:				; CODE XREF: sub_410434+D3j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_41047F
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_40FC19
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_41047F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	loc_41050F

loc_41047F:				; CODE XREF: sub_410434+27j
					; sub_410434+3Bj
		cmp	[ebp+var_14], 0
		jnz	short loc_4104FB
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+var_18]
		jbe	short loc_4104B7
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_4104B7:				; CODE XREF: sub_410434+7Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		add	eax, edx
		mov	edx, ecx
		mov	ecx, [ebp+var_C]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_C]
		add	[ebp+var_10], eax

loc_4104FB:				; CODE XREF: sub_410434+14j
					; sub_410434+4Fj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_10]
		jz	short loc_410510
		cmp	[ebp+var_14], 0
		jz	loc_41044D
		jmp	short loc_410510
; ---------------------------------------------------------------------------

loc_41050F:				; CODE XREF: sub_410434+45j
		nop

loc_410510:				; CODE XREF: sub_410434+CDj
					; sub_410434+D9j
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		leave
		retn
sub_410434	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41051D	proc near		; CODE XREF: sub_41054B+110p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_410434
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41051D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41054B	proc near		; CODE XREF: sub_41258B+22p
					; sub_412795+3Bp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4105D2
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40FD34
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_410696
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl
		jmp	short loc_4105D2
; ---------------------------------------------------------------------------

loc_4105A1:				; CODE XREF: sub_41054B+97j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+14h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		sub	eax, 1
		add	eax, ecx
		movzx	eax, byte ptr [eax]
		mov	[edx], al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_0]
		mov	[eax+1Ch], edx
		add	[ebp+var_C], 1

loc_4105D2:				; CODE XREF: sub_41054B+2Dj
					; sub_41054B+54j
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jz	short loc_4105E4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_4105A1

loc_4105E4:				; CODE XREF: sub_41054B+8Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+244h]
		cmp	eax, 4
		jz	short loc_410603
		cmp	eax, 40h
		jz	short loc_410634
		test	eax, eax
		jz	short loc_410665
		jmp	loc_410697
; ---------------------------------------------------------------------------

loc_410603:				; CODE XREF: sub_41054B+A8j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_410374
		mov	[ebp+var_10], eax
		jmp	short loc_410697
; ---------------------------------------------------------------------------

loc_410634:				; CODE XREF: sub_41054B+ADj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41051D
		mov	[ebp+var_10], eax
		jmp	short loc_410697
; ---------------------------------------------------------------------------

loc_410665:				; CODE XREF: sub_41054B+B1j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_410434
		mov	[ebp+var_10], eax
		jmp	short loc_410697
; ---------------------------------------------------------------------------

loc_410696:				; CODE XREF: sub_41054B+41j
		nop

loc_410697:				; CODE XREF: sub_41054B+B3j
					; sub_41054B+E7j ...
		cmp	[ebp+arg_C], 0
		jz	short loc_4106AA
		mov	eax, [ebp+var_18]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_4106AA:				; CODE XREF: sub_41054B+150j
		mov	eax, [ebp+var_10]
		leave
		retn
sub_41054B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4106AF(int, void *, size_t, int)
sub_4106AF	proc near		; CODE XREF: .text:00412769p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jbe	short loc_4106D8
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_8], eax

loc_4106D8:				; CODE XREF: sub_4106AF+21j
		cmp	[ebp+arg_8], 0
		jz	short loc_41072D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		add	eax, edx
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_0]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+24Ch], dl
		jmp	short loc_41072E
; ---------------------------------------------------------------------------

loc_41072D:				; CODE XREF: sub_4106AF+2Dj
		nop

loc_41072E:				; CODE XREF: sub_4106AF+7Cj
		cmp	[ebp+arg_C], 0
		jz	short locret_41073C
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+arg_8]
		mov	[eax], edx

locret_41073C:				; CODE XREF: sub_4106AF+83j
		leave
		retn
sub_4106AF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41073E	proc near		; CODE XREF: sub_410B2C+58p
					; sub_410D56+270p ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_40], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+238h]
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_410781
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 28h
		mov	[ebp+var_1C], 0FFFFFFFFh
		jmp	loc_41089E
; ---------------------------------------------------------------------------

loc_410781:				; CODE XREF: sub_41073E+28j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4107B4
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_40FD34
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_41089D
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_4107B4:				; CODE XREF: sub_41073E+4Fj
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[ebp+var_30], eax
		mov	[ebp+var_2C], edx
		cmp	[ebp+arg_C], 1
		jnz	short loc_410813
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+8]
		mov	ebx, 0
		mov	esi, eax
		mov	edi, edx
		sub	esi, ecx
		sbb	edi, ebx
		mov	ecx, esi
		mov	ebx, edi
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[ebp+var_30], eax
		mov	[ebp+var_2C], edx
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+1Ch]
		mov	ebx, 0
		sub	eax, ecx
		sbb	edx, ebx
		mov	[ebp+var_30], eax
		mov	[ebp+var_2C], edx

loc_410813:				; CODE XREF: sub_41073E+86j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	edx, [ebp+arg_C]
		mov	[esp+58h+var_50], edx
		lea	edx, [ebp+var_30]
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+var_20]
		call	eax
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0FFFFFFFFh
		jnz	short loc_410847
		mov	[ebp+var_1C], 0FFFFFFFFh
		jmp	short loc_41089E
; ---------------------------------------------------------------------------

loc_410847:				; CODE XREF: sub_41073E+FEj
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_40FECD
		cmp	[ebp+arg_10], 0
		jz	short loc_41086D
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	ecx, [ebp+arg_10]
		mov	[ecx], eax
		mov	[ecx+4], edx

loc_41086D:				; CODE XREF: sub_41073E+11Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+24Ch], dl
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+24h]
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	[ecx+228h], eax
		mov	[ecx+22Ch], edx
		jmp	short loc_41089E
; ---------------------------------------------------------------------------

loc_41089D:				; CODE XREF: sub_41073E+63j
		nop

loc_41089E:				; CODE XREF: sub_41073E+3Ej
					; sub_41073E+107j ...
		cmp	[ebp+var_1C], 0
		jz	short loc_4108BA
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl

loc_4108BA:				; CODE XREF: sub_41073E+164j
		mov	eax, [ebp+var_1C]
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_41073E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4108C5	proc near		; CODE XREF: sub_410A66+79p
					; sub_410B2C+B6p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+234h]
		mov	[ebp+var_14], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_4108F4
		cmp	[ebp+var_14], 0
		jnz	short loc_4108F4
		mov	[ebp+var_10], 28h
		jmp	loc_41098A
; ---------------------------------------------------------------------------

loc_4108F4:				; CODE XREF: sub_4108C5+1Bj
					; sub_4108C5+21j
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	short loc_41094A
; ---------------------------------------------------------------------------

loc_410904:				; CODE XREF: sub_4108C5+8Bj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_410944
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_410952
; ---------------------------------------------------------------------------

loc_410944:				; CODE XREF: sub_4108C5+74j
		mov	eax, [ebp+var_18]
		add	[ebp+var_C], eax

loc_41094A:				; CODE XREF: sub_4108C5+3Dj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jnz	short loc_410904

loc_410952:				; CODE XREF: sub_4108C5+7Dj
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+var_C]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_C]
		mov	[eax], edx

loc_41098A:				; CODE XREF: sub_4108C5+2Aj
		mov	eax, [ebp+var_10]
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_4108C5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410994	proc near		; CODE XREF: sub_410A66+ACp
					; sub_410B2C+100p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		jmp	loc_410A47
; ---------------------------------------------------------------------------

loc_4109AD:				; CODE XREF: sub_410994+BFj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnz	short loc_4109CB
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_40FD34
		mov	[ebp+var_14], eax

loc_4109CB:				; CODE XREF: sub_410994+27j
		cmp	[ebp+var_14], 0
		jnz	short loc_410A47
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+var_18]
		jbe	short loc_410A03
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_410A03:				; CODE XREF: sub_410994+67j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		lea	ecx, [edx+eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	eax, edx
		mov	edx, ecx
		mov	ecx, [ebp+var_C]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_C]
		add	[ebp+var_10], eax

loc_410A47:				; CODE XREF: sub_410994+14j
					; sub_410994+3Bj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_10]
		jz	short loc_410A59
		cmp	[ebp+var_14], 0
		jz	loc_4109AD

loc_410A59:				; CODE XREF: sub_410994+B9j
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		leave
		retn
sub_410994	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410A66	proc near		; CODE XREF: sub_410B2C+DBp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+var_24], 0Ah
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_4220F5
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_410AE7
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40FD34
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_410AE7
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_4]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4108C5
		mov	[ebp+var_C], eax

loc_410AE7:				; CODE XREF: sub_410A66+3Cj
					; sub_410A66+50j
		cmp	[ebp+var_C], 0
		jnz	short loc_410B1A
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_14]
		add	eax, [ebp+arg_4]
		lea	edx, [ebp+var_18]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_410994
		mov	[ebp+var_C], eax

loc_410B1A:				; CODE XREF: sub_410A66+85j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		add	edx, eax
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		leave
		retn
sub_410A66	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410B2C	proc near		; CODE XREF: sub_4110CF+2Ep
					; .text:004117B9p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_410BAB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+238h]
		test	eax, eax
		jz	short loc_410BAB
		mov	[esp+38h+var_28], 0
		mov	[esp+38h+var_2C], 1
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_30], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_41073E
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_410BAB
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 1Dh
		jnz	loc_410C36
		mov	[ebp+var_C], 0

loc_410BAB:				; CODE XREF: sub_410B2C+20j
					; sub_410B2C+30j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+244h]
		cmp	eax, 4
		jz	short loc_410BC7
		cmp	eax, 40h
		jz	short loc_410BEC
		test	eax, eax
		jz	short loc_410C11
		jmp	short loc_410C37
; ---------------------------------------------------------------------------

loc_410BC7:				; CODE XREF: sub_410B2C+8Ej
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_4108C5
		mov	[ebp+var_C], eax
		jmp	short loc_410C37
; ---------------------------------------------------------------------------

loc_410BEC:				; CODE XREF: sub_410B2C+93j
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_410A66
		mov	[ebp+var_C], eax
		jmp	short loc_410C37
; ---------------------------------------------------------------------------

loc_410C11:				; CODE XREF: sub_410B2C+97j
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_410994
		mov	[ebp+var_C], eax
		jmp	short loc_410C37
; ---------------------------------------------------------------------------

loc_410C36:				; CODE XREF: sub_410B2C+72j
		nop

loc_410C37:				; CODE XREF: sub_410B2C+99j
					; sub_410B2C+BEj ...
		cmp	[ebp+arg_C], 0
		jz	short loc_410C45
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_410C45:				; CODE XREF: sub_410B2C+10Fj
		mov	eax, [ebp+var_10]
		test	eax, eax
		jz	short loc_410C67
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_410C67
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		or	edx, 1
		mov	[eax+20h], dl

loc_410C67:				; CODE XREF: sub_410B2C+11Ej
					; sub_410B2C+12Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_410B2C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410C6C	proc near		; CODE XREF: sub_410D56+10Ep

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_410CA1
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40FD34
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_410CFF
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_410CA1:				; CODE XREF: sub_410C6C+12j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_410CC5
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40FC19
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_410D02

loc_410CC5:				; CODE XREF: sub_410C6C+43j
		cmp	[ebp+arg_4], 0
		jz	short loc_410CDD
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], edx

loc_410CDD:				; CODE XREF: sub_410C6C+5Dj
		cmp	[ebp+arg_8], 0
		jz	short loc_410CF6
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		sub	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_410CF6:				; CODE XREF: sub_410C6C+75j
		mov	[ebp+var_C], 0
		jmp	short loc_410D03
; ---------------------------------------------------------------------------

loc_410CFF:				; CODE XREF: sub_410C6C+26j
		nop
		jmp	short loc_410D03
; ---------------------------------------------------------------------------

loc_410D02:				; CODE XREF: sub_410C6C+57j
		nop

loc_410D03:				; CODE XREF: sub_410C6C+91j
					; sub_410C6C+94j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_410C6C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410D08	proc near		; CODE XREF: sub_410D56+1BBp
					; sub_410D56+207p

var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jbe	short loc_410D39
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_410D51
; ---------------------------------------------------------------------------

loc_410D39:				; CODE XREF: sub_410D08+19j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	[ebp+var_C], 0

loc_410D51:				; CODE XREF: sub_410D08+2Fj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_410D08	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410D56	proc near		; CODE XREF: .text:00412B87p

Buf		= dword	ptr -68h
Val		= dword	ptr -64h
MaxCount	= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	[ebp+var_14], 0
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		lea	eax, [ebp+var_24]
		mov	[esp+68h+var_44], 0
		mov	[esp+68h+var_48], 2
		mov	[esp+68h+var_4C], offset sub_40EE05
		mov	[esp+68h+var_50], offset sub_40EDD8
		mov	[esp+68h+var_54], 1
		mov	[esp+68h+var_58], 200h
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+MaxCount], 0
		mov	[esp+68h+Val], 0
		mov	[esp+68h+Buf], eax
		call	sub_40EFD5
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_41105F
		mov	eax, [ebp+var_24]
		mov	[esp+68h+var_48], 0
		mov	[esp+68h+var_4C], 2
		mov	edx, off_4292C0
		mov	[esp+68h+var_5C], edx
		mov	edx, off_4292C4
		mov	[esp+68h+var_58], edx
		mov	edx, off_4292C8
		mov	[esp+68h+var_54], edx
		mov	edx, off_4292CC
		mov	[esp+68h+var_50], edx
		mov	[esp+68h+MaxCount], 0FFFFFFFFh
		mov	[esp+68h+Val], eax
		lea	eax, [ebp+var_20]
		mov	[esp+68h+Buf], eax
		call	sub_4101FC
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_411062
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	short loc_410E40
; ---------------------------------------------------------------------------

loc_410E3F:				; CODE XREF: sub_410D56+210j
		nop

loc_410E40:				; CODE XREF: sub_410D56+E7j
		cmp	[ebp+arg_4], 0
		jz	short loc_410E50
		cmp	[ebp+var_C], 1
		jz	loc_410F6E

loc_410E50:				; CODE XREF: sub_410D56+EEj
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+MaxCount], eax
		lea	eax, [ebp+var_28]
		mov	[esp+68h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Buf], eax
		call	sub_410C6C
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_410F6F
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jz	loc_410F6F
		mov	eax, [ebp+var_C]
		lea	edx, [eax-1]
		mov	eax, [ebp+var_2C]
		cmp	edx, eax
		jnb	short loc_410E97
		mov	eax, [ebp+var_C]
		sub	eax, 1
		mov	[ebp+var_2C], eax

loc_410E97:				; CODE XREF: sub_410D56+136j
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	[esp+68h+MaxCount], edx	; MaxCount
		mov	[esp+68h+Val], 0Ah ; Val
		mov	[esp+68h+Buf], eax ; Buf
		call	memchr
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_410F18
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_28]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+MaxCount], ecx
		mov	[esp+68h+Val], edx
		mov	[esp+68h+Buf], eax
		call	sub_4127FA
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_410F62
		mov	eax, [ebp+var_2C]
		sub	[ebp+var_C], eax
		mov	eax, [ebp+var_2C]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Buf], eax
		call	sub_410D08
		jmp	short loc_410F6F
; ---------------------------------------------------------------------------

loc_410F18:				; CODE XREF: sub_410D56+162j
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+MaxCount], ecx
		mov	[esp+68h+Val], edx
		mov	[esp+68h+Buf], eax
		call	sub_4127FA
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_410F62
		mov	eax, [ebp+var_2C]
		sub	[ebp+var_C], eax
		mov	eax, [ebp+var_2C]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Buf], eax
		call	sub_410D08

loc_410F62:				; CODE XREF: sub_410D56+1A0j
					; sub_410D56+1ECj
		cmp	[ebp+var_18], 0
		jz	loc_410E3F
		jmp	short loc_410F6F
; ---------------------------------------------------------------------------

loc_410F6E:				; CODE XREF: sub_410D56+F4j
		nop

loc_410F6F:				; CODE XREF: sub_410D56+11Aj
					; sub_410D56+125j ...
		cmp	[ebp+var_18], 0
		jnz	loc_411065
		cmp	[ebp+arg_4], 1
		jbe	short loc_410FA0
		cmp	[ebp+var_10], 0
		jnz	short loc_410FA0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 2
		mov	[eax+24Ch], dl
		jmp	loc_41106C
; ---------------------------------------------------------------------------

loc_410FA0:				; CODE XREF: sub_410D56+227j
					; sub_410D56+22Dj
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_58], 0
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+Val], 0
		mov	[esp+68h+MaxCount], 0
		mov	[esp+68h+Buf], eax
		call	sub_41073E
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_411068
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_411001
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[esp+68h+Buf], eax ; size_t
		call	sub_40EDBB
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_411009
		mov	[ebp+var_18], 0FFFFFFFFh
		jmp	short loc_41106C
; ---------------------------------------------------------------------------

loc_411001:				; CODE XREF: sub_410D56+289j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_411009:				; CODE XREF: sub_410D56+2A0j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_5C], 0
		mov	ecx, [ebp+var_10]
		mov	[esp+68h+MaxCount], ecx
		mov	[esp+68h+Val], edx
		mov	[esp+68h+Buf], eax
		call	sub_412795
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_41106B
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		add	eax, edx
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41104F
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_41104F:				; CODE XREF: sub_410D56+2EFj
		cmp	[ebp+arg_C], 0
		jz	short loc_41106C
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_41106C
; ---------------------------------------------------------------------------

loc_41105F:				; CODE XREF: sub_410D56+75j
		nop
		jmp	short loc_41106C
; ---------------------------------------------------------------------------

loc_411062:				; CODE XREF: sub_410D56+D4j
		nop
		jmp	short loc_41106C
; ---------------------------------------------------------------------------

loc_411065:				; CODE XREF: sub_410D56+21Dj
		nop
		jmp	short loc_41106C
; ---------------------------------------------------------------------------

loc_411068:				; CODE XREF: sub_410D56+27Cj
		nop
		jmp	short loc_41106C
; ---------------------------------------------------------------------------

loc_41106B:				; CODE XREF: sub_410D56+2DBj
		nop

loc_41106C:				; CODE XREF: sub_410D56+245j
					; sub_410D56+2A9j ...
		mov	eax, [ebp+var_20]
		test	eax, eax
		jz	short loc_411088
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Val], 0 ; int
		mov	[esp+68h+Buf], eax ; void *
		call	sub_410323
		jmp	short loc_41109A
; ---------------------------------------------------------------------------

loc_411088:				; CODE XREF: sub_410D56+31Bj
		mov	eax, [ebp+var_24]
		test	eax, eax
		jz	short loc_41109A
		mov	eax, [ebp+var_24]
		mov	[esp+68h+Buf], eax
		call	sub_40F648

loc_41109A:				; CODE XREF: sub_410D56+330j
					; sub_410D56+337j
		cmp	[ebp+var_18], 0
		jz	short loc_4110CA
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4110B4
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Buf], eax ; void *
		call	sub_40EE05

loc_4110B4:				; CODE XREF: sub_410D56+351j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl

loc_4110CA:				; CODE XREF: sub_410D56+348j
		mov	eax, [ebp+var_18]
		leave
		retn
sub_410D56	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4110CF	proc near		; DATA XREF: sub_411127+2Bo

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_4]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_410B2C
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_C]
		mov	edx, [edx+24h]
		mov	ecx, [edx+258h]
		mov	edx, [ebp+var_14]
		add	edx, ecx
		mov	[eax+258h], edx
		mov	eax, [ebp+var_10]
		leave
		retn
sub_4110CF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411127	proc near		; CODE XREF: .text:00412F5Bp
					; .text:00412F90p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+258h], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], offset sub_4110CF
		call	sub_415E33
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41116E
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41117A
; ---------------------------------------------------------------------------

loc_41116E:				; CODE XREF: sub_411127+3Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+258h]

locret_41117A:				; CODE XREF: sub_411127+45j
		leave
		retn
sub_411127	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41117C	proc near		; CODE XREF: sub_411224+4Ep
					; .text:0041182Fp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jz	short loc_4111A9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		cmp	[ebp+arg_4], 0
		setnz	dl
		mov	ecx, edx
		and	ecx, 1
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFEh
		or	edx, ecx
		mov	[eax+24Ch], dl

loc_4111A9:				; CODE XREF: sub_41117C+7j
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jz	short loc_4111D4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		cmp	[ebp+arg_8], 0
		setnz	dl
		and	edx, 1
		lea	ecx, [edx+edx]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		or	edx, ecx
		mov	[eax+24Ch], dl

loc_4111D4:				; CODE XREF: sub_41117C+31j
		pop	ebp
		retn
sub_41117C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4111D6	proc near		; CODE XREF: sub_4121ED+1Cp
					; sub_412251+1Cp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_411201
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+24Ch]
		and	eax, 1
		movzx	eax, al
		mov	[ebp+var_4], eax
		jmp	short loc_41121F
; ---------------------------------------------------------------------------

loc_411201:				; CODE XREF: sub_4111D6+11j
		cmp	[ebp+arg_8], 0
		jz	short loc_41121F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+24Ch]
		shr	al, 1
		and	eax, 1
		movzx	eax, al
		mov	[ebp+var_4], eax

loc_41121F:				; CODE XREF: sub_4111D6+29j
					; sub_4111D6+2Fj
		mov	eax, [ebp+var_4]
		leave
		retn
sub_4111D6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_411224(int, int, int,	size_t)
sub_411224	proc near		; CODE XREF: .text:00411E61p
					; .text:0041342Dp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_411251
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40FD34
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41125C
		jmp	loc_411344
; ---------------------------------------------------------------------------

loc_411251:				; CODE XREF: sub_411224+12j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40FECD

loc_41125C:				; CODE XREF: sub_411224+26j
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41117C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		and	eax, 1
		test	al, al
		jz	short loc_4112B7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFFEh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40EE05
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0

loc_4112B7:				; CODE XREF: sub_411224+65j
		cmp	[ebp+arg_8], 4
		jnz	short loc_4112C9
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 0
		jmp	short loc_41132E
; ---------------------------------------------------------------------------

loc_4112C9:				; CODE XREF: sub_411224+97j
		cmp	[ebp+arg_4], 0
		jz	short loc_4112D7
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		jmp	short loc_411301
; ---------------------------------------------------------------------------

loc_4112D7:				; CODE XREF: sub_411224+A9j
		cmp	[ebp+arg_C], 0
		jnz	short loc_4112E4
		mov	[ebp+arg_C], 200h

loc_4112E4:				; CODE XREF: sub_411224+B7j
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_28], eax ;	size_t
		call	sub_40EDBB
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_411301
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_411344
; ---------------------------------------------------------------------------

loc_411301:				; CODE XREF: sub_411224+B1j
					; sub_411224+D2j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_C]
		mov	[eax+4], edx
		cmp	[ebp+arg_4], 0
		jnz	short loc_41132E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		or	edx, 1
		mov	[eax+250h], dl

loc_41132E:				; CODE XREF: sub_411224+A3j
					; sub_411224+F2j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_8]
		mov	[eax+244h], edx
		mov	[ebp+var_C], 0

loc_411344:				; CODE XREF: sub_411224+28j
					; sub_411224+DBj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_411224	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411349	proc near		; CODE XREF: .text:0041249Fp
					; .text:004124EEp

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jl	short loc_4113A1
		cmp	edx, [ebp+var_C]
		jg	short loc_411391
		cmp	eax, [ebp+var_10]
		jbe	short loc_4113A1

loc_411391:				; CODE XREF: sub_411349+41j
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		jmp	short loc_4113B2
; ---------------------------------------------------------------------------

loc_4113A1:				; CODE XREF: sub_411349+3Cj
					; sub_411349+46j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, 0
		sub	[ebp+var_10], eax
		sbb	[ebp+var_C], edx

loc_4113B2:				; CODE XREF: sub_411349+56j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_411349	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4113BE	proc near		; CODE XREF: .text:004134F3p
					; .text:0041353Dp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_8], 0
		jz	short loc_4113D8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [eax+218h]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_4113D8:				; CODE XREF: sub_4113BE+7j
		cmp	[ebp+arg_4], 0
		jz	short loc_4113ED
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_4]
		mov	[eax+218h], edx

loc_4113ED:				; CODE XREF: sub_4113BE+1Ej
		pop	ebp
		retn
sub_4113BE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4113EF	proc near		; CODE XREF: sub_412145+Cp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+248h]
		pop	ebp
		retn
sub_4113EF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411400	proc near		; CODE XREF: sub_40B9A4+30p

var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_40EFA9
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_411400	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_411413(char *, int)
sub_411413	proc near		; CODE XREF: sub_4039ED+72p
					; sub_4039ED+110p

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_14]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		call	sub_40FB59
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_411503
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_50], eax
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_54], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	sub_40FAA4
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_411506
		mov	[ebp+var_C], 1
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_38], 0
		mov	[esp+58h+var_3C], ecx
		mov	ecx, off_4292D0
		mov	[esp+58h+var_4C], ecx
		mov	ecx, off_4292D4
		mov	[esp+58h+var_48], ecx
		mov	ecx, off_4292D8
		mov	[esp+58h+var_44], ecx
		mov	ecx, off_4292DC
		mov	[esp+58h+var_40], ecx
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+var_54], eax
		lea	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	sub_4101FC
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_411509
		mov	eax, [ebp+var_18]
		test	eax, eax
		jz	short loc_41150A
		cmp	[ebp+arg_0], 0
		jz	short loc_41150A
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_50], 1 ; int
		mov	edx, [ebp+arg_0]
		mov	[esp+58h+var_54], edx ;	char *
		mov	[esp+58h+var_58], eax ;	int
		call	sub_41355B
		jmp	short loc_41150A
; ---------------------------------------------------------------------------

loc_411503:				; CODE XREF: sub_411413+34j
		nop
		jmp	short loc_41150A
; ---------------------------------------------------------------------------

loc_411506:				; CODE XREF: sub_411413+61j
		nop
		jmp	short loc_41150A
; ---------------------------------------------------------------------------

loc_411509:				; CODE XREF: sub_411413+C5j
		nop

loc_41150A:				; CODE XREF: sub_411413+CCj
					; sub_411413+D2j ...
		cmp	[ebp+var_10], 0
		jz	short loc_411524
		cmp	[ebp+var_C], 0
		jz	short loc_411524
		mov	edx, off_4292DC
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	edx ; sub_40F822

loc_411524:				; CODE XREF: sub_411413+FBj
					; sub_411413+101j
		mov	eax, [ebp+var_18]
		leave
		retn
sub_411413	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-0Ch], 0
		lea	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp+20h]
		mov	[esp], eax
		call	sub_40FB59
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_411615
		mov	edx, [ebp-14h]
		lea	eax, [ebp-1Ch]
		mov	dword ptr [esp+24h], 0
		mov	[esp+20h], edx
		mov	edx, [ebp+1Ch]
		mov	[esp+1Ch], edx
		mov	edx, [ebp+18h]
		mov	[esp+18h], edx
		mov	edx, [ebp+14h]
		mov	[esp+14h], edx
		mov	dword ptr [esp+10h], 200h
		mov	edx, [ebp+10h]
		mov	[esp+0Ch], edx
		mov	edx, [ebp+0Ch]
		mov	[esp+8], edx
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_40EFD5
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_411618
		mov	dword ptr [ebp-0Ch], 1
		mov	edx, [ebp-14h]
		mov	eax, [ebp-1Ch]
		mov	dword ptr [esp+20h], 0
		mov	[esp+1Ch], edx
		mov	edx, off_4292C0
		mov	[esp+0Ch], edx
		mov	edx, off_4292C4
		mov	[esp+10h], edx
		mov	edx, off_4292C8
		mov	[esp+14h], edx
		mov	edx, off_4292CC
		mov	[esp+18h], edx
		mov	dword ptr [esp+8], 0FFFFFFFFh
		mov	[esp+4], eax
		lea	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_4101FC
		mov	[ebp-10h], eax
		jmp	short loc_411619
; ---------------------------------------------------------------------------

loc_411615:				; CODE XREF: .text:0041155Dj
		nop
		jmp	short loc_411619
; ---------------------------------------------------------------------------

loc_411618:				; CODE XREF: .text:004115B6j
		nop

loc_411619:				; CODE XREF: .text:00411613j
					; .text:00411616j
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_411633
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_411633
		mov	edx, off_4292CC
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	edx ; sub_40F648

loc_411633:				; CODE XREF: .text:0041161Dj
					; .text:00411623j
		mov	eax, [ebp-18h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411638	proc near		; CODE XREF: .text:00411777p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		lea	eax, [ebp+var_C]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	sub_40FB59
		test	eax, eax
		jz	short loc_41166C
		mov	eax, 0
		jmp	locret_41174E
; ---------------------------------------------------------------------------

loc_41166C:				; CODE XREF: sub_411638+28j
		mov	eax, [ebp+var_C]
		or	eax, 2
		mov	[ebp+var_C], eax
		mov	edx, [ebp+var_C]
		lea	eax, [ebp+var_14]
		mov	ecx, [ebp+arg_0]
		mov	[esp+48h+var_24], ecx
		mov	[esp+48h+var_28], edx
		mov	[esp+48h+var_2C], offset sub_40EE05
		mov	[esp+48h+var_30], offset sub_40EDD8
		mov	[esp+48h+var_34], 1
		mov	[esp+48h+var_38], 200h
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+var_44], 0
		mov	[esp+48h+var_48], eax
		call	sub_40EFD5
		test	eax, eax
		jz	short loc_4116D1
		mov	eax, 0
		jmp	short locret_41174E
; ---------------------------------------------------------------------------

loc_4116D1:				; CODE XREF: sub_411638+90j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_28], 0
		mov	[esp+48h+var_2C], edx
		mov	edx, off_4292C0
		mov	[esp+48h+var_3C], edx
		mov	edx, off_4292C4
		mov	[esp+48h+var_38], edx
		mov	edx, off_4292C8
		mov	[esp+48h+var_34], edx
		mov	edx, off_4292CC
		mov	[esp+48h+var_30], edx
		mov	[esp+48h+var_40], 0FFFFFFFFh
		mov	[esp+48h+var_44], eax
		lea	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	sub_4101FC
		test	eax, eax
		jz	short loc_411734
		mov	edx, off_4292CC
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	edx ; sub_40F648

loc_411734:				; CODE XREF: sub_411638+ECj
		mov	eax, [ebp+var_10]
		test	eax, eax
		jz	short loc_41174B
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+23Ch], offset sub_40F5E0

loc_41174B:				; CODE XREF: sub_411638+101j
		mov	eax, [ebp+var_10]

locret_41174E:				; CODE XREF: sub_411638+2Fj
					; sub_411638+97j
		leave
		retn
sub_411638	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_41176A
		mov	eax, [ebp+8]
		cmp	eax, [ebp+14h]
		jnb	short loc_41176A
		mov	eax, [ebp+14h]
		mov	[ebp+8], eax

loc_41176A:				; CODE XREF: .text:0041175Aj
					; .text:00411762j
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_411638
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	loc_411834
		cmp	dword ptr [ebp+10h], 0
		jz	loc_411834
		cmp	dword ptr [ebp+14h], 0
		jz	loc_411834
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp+14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_410B2C
		test	eax, eax
		jz	short loc_4117EE
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_41202A
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp-10h]
		mov	[eax], edx
		jmp	short loc_411834
; ---------------------------------------------------------------------------

loc_4117EE:				; CODE XREF: .text:004117C0j
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_41073E
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_41117C

loc_411834:				; CODE XREF: .text:00411783j
					; .text:0041178Dj ...
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-10h], 0
		lea	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_40FB59
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4118B6
		mov	eax, [ebp-10h]
		mov	dword ptr [esp+20h], 0
		mov	[esp+1Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+14h]
		mov	[esp+10h], eax
		mov	eax, [ebp+18h]
		mov	[esp+14h], eax
		mov	eax, [ebp+1Ch]
		mov	[esp+18h], eax
		mov	dword ptr [esp+8], 0FFFFFFFFh
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_4101FC
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jmp	short loc_4118B7
; ---------------------------------------------------------------------------

loc_4118B6:				; CODE XREF: .text:00411866j
		nop

loc_4118B7:				; CODE XREF: .text:004118B4j
		mov	eax, [ebp-14h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4118BC	proc near		; CODE XREF: .text:004119C0p
					; .text:004119EAp ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_14]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		call	sub_40FB59
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_41197A
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_54], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	sub_40F67D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41197D
		mov	[ebp+var_C], 1
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_1C]
		mov	ecx, [ebp+arg_C]
		mov	[esp+58h+var_38], ecx
		mov	[esp+58h+var_3C], edx
		mov	edx, off_4292D0
		mov	[esp+58h+var_4C], edx
		mov	edx, off_4292D4
		mov	[esp+58h+var_48], edx
		mov	edx, off_4292D8
		mov	[esp+58h+var_44], edx
		mov	edx, off_4292DC
		mov	[esp+58h+var_40], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+var_54], eax
		lea	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	sub_4101FC
		mov	[ebp+var_10], eax
		jmp	short loc_41197E
; ---------------------------------------------------------------------------

loc_41197A:				; CODE XREF: sub_4118BC+34j
		nop
		jmp	short loc_41197E
; ---------------------------------------------------------------------------

loc_41197D:				; CODE XREF: sub_4118BC+61j
		nop

loc_41197E:				; CODE XREF: sub_4118BC+BCj
					; sub_4118BC+BFj
		cmp	[ebp+var_10], 0
		jz	short loc_411998
		cmp	[ebp+var_C], 0
		jz	short loc_411998
		mov	edx, off_4292DC
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	edx ; sub_40F822

loc_411998:				; CODE XREF: sub_4118BC+C6j
					; sub_4118BC+CCj
		mov	eax, [ebp+var_18]
		leave
		retn
sub_4118BC	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4118BC
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4118BC
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4119F1(FILE *, int, int, int)
sub_4119F1	proc near		; CODE XREF: .text:00411B20p
					; .text:00411B4Ap ...

File		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 54h
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_14]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+File],	eax
		call	sub_40FB59
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_411AD6
		cmp	[ebp+arg_0], 0
		jz	short loc_411A3D
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+File],	eax ; File
		call	fflush

loc_411A3D:				; CODE XREF: sub_4119F1+3Fj
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx ;	int
		mov	[esp+58h+var_50], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_54], eax ;	FILE *
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+File],	eax ; int
		call	sub_40F881
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_411AD9
		mov	[ebp+var_C], 1
		mov	ebx, [ebp+var_14]
		cmp	[ebp+arg_0], 0
		jz	short loc_411A83
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+File],	eax ; File
		call	_fileno
		jmp	short loc_411A88
; ---------------------------------------------------------------------------

loc_411A83:				; CODE XREF: sub_4119F1+83j
		mov	eax, 0FFFFFFFFh

loc_411A88:				; CODE XREF: sub_4119F1+90j
		mov	edx, [ebp+var_1C]
		mov	ecx, [ebp+arg_C]
		mov	[esp+58h+var_38], ecx
		mov	[esp+58h+var_3C], ebx
		mov	ecx, off_4292E0
		mov	[esp+58h+var_4C], ecx
		mov	ecx, off_4292E4
		mov	[esp+58h+var_48], ecx
		mov	ecx, off_4292E8
		mov	[esp+58h+var_44], ecx
		mov	ecx, off_4292EC
		mov	[esp+58h+var_40], ecx
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+var_54], edx
		lea	eax, [ebp+var_18]
		mov	[esp+58h+File],	eax
		call	sub_4101FC
		mov	[ebp+var_10], eax
		jmp	short loc_411ADA
; ---------------------------------------------------------------------------

loc_411AD6:				; CODE XREF: sub_4119F1+35j
		nop
		jmp	short loc_411ADA
; ---------------------------------------------------------------------------

loc_411AD9:				; CODE XREF: sub_4119F1+73j
		nop

loc_411ADA:				; CODE XREF: sub_4119F1+E3j
					; sub_4119F1+E6j
		cmp	[ebp+var_10], 0
		jz	short loc_411AF4
		cmp	[ebp+var_C], 0
		jz	short loc_411AF4
		mov	edx, off_4292EC
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+File],	eax
		call	edx ; sub_40FA39

loc_411AF4:				; CODE XREF: sub_4119F1+EDj
					; sub_4119F1+F3j
		mov	eax, [ebp+var_18]
		add	esp, 54h
		pop	ebx
		pop	ebp
		retn
sub_4119F1	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4119F1
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4119F1
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, ds:dword_430244
		mov	[esp], eax
		call	sub_40EDAC
		cmp	dword ptr [ebp+8], 0
		js	short loc_411B97
		cmp	dword ptr [ebp+8], 2
		jg	short loc_411B97
		mov	eax, [ebp+8]
		add	eax, offset byte_430254
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_411B97
		mov	eax, [ebp+8]
		mov	edx, [ebp+0Ch]
		mov	ds:dword_430248[eax*4],	edx
		mov	eax, [ebp+8]
		add	eax, offset byte_430254
		mov	byte ptr [eax],	1

loc_411B97:				; CODE XREF: .text:00411B68j
					; .text:00411B6Ej ...
		mov	eax, ds:dword_430244
		mov	[esp], eax
		call	sub_40EDAC
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		mov	ecx, [ebp+8]
		mov	edx, 55555556h
		mov	eax, ecx
		imul	edx
		mov	eax, ecx
		sar	eax, 1Fh
		sub	edx, eax
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		mov	[ebp+8], eax
		mov	eax, ds:dword_430244
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, ds:dword_430240
		mov	[ebp-0Ch], eax
		jmp	short loc_411C32
; ---------------------------------------------------------------------------

loc_411BEC:				; CODE XREF: .text:00411C36j
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		and	eax, 2
		test	al, al
		jz	short loc_411C29
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		shr	al, 2
		and	eax, 3
		movzx	eax, al
		cmp	eax, [ebp+8]
		jnz	short loc_411C29
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		jmp	short loc_411C38
; ---------------------------------------------------------------------------

loc_411C29:				; CODE XREF: .text:00411C00j
					; .text:00411C1Dj
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+4]
		mov	[ebp-0Ch], eax

loc_411C32:				; CODE XREF: .text:00411BEAj
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_411BEC

loc_411C38:				; CODE XREF: .text:00411C27j
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_411E9C
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_411C7D
		movzx	eax, ds:byte_430254
		test	al, al
		jz	short loc_411C7D
		mov	eax, ds:dword_430248
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aR ; "r"
		mov	[esp], eax
		call	sub_4118BC
		mov	[ebp-10h], eax
		jmp	short loc_411CEB
; ---------------------------------------------------------------------------

loc_411C7D:				; CODE XREF: .text:00411C46j
					; .text:00411C51j
		cmp	dword ptr [ebp+8], 1
		jnz	short loc_411CB8
		movzx	eax, ds:byte_430255
		test	al, al
		jz	short loc_411CB8
		mov	eax, ds:dword_43024C
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aA ; "a"
		mov	[esp], eax
		call	sub_4118BC
		mov	[ebp-10h], eax
		jmp	short loc_411CEB
; ---------------------------------------------------------------------------

loc_411CB8:				; CODE XREF: .text:00411C81j
					; .text:00411C8Cj
		movzx	eax, ds:byte_430256
		test	al, al
		jz	short loc_411CEB
		mov	eax, ds:dword_430250
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aA ; "a"
		mov	[esp], eax
		call	sub_4118BC
		mov	[ebp-10h], eax

loc_411CEB:				; CODE XREF: .text:00411C7Bj
					; .text:00411CB6j ...
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_411D83
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_411D25
		mov	eax, ds:_iob
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aR ; "r"
		mov	[esp], eax
		call	sub_4119F1
		mov	[ebp-10h], eax
		jmp	short loc_411D83
; ---------------------------------------------------------------------------

loc_411D25:				; CODE XREF: .text:00411CF9j
		cmp	dword ptr [ebp+8], 1
		jnz	short loc_411D58
		mov	eax, ds:_iob
		add	eax, 20h
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aA ; "a"
		mov	[esp], eax
		call	sub_4119F1
		mov	[ebp-10h], eax
		jmp	short loc_411D83
; ---------------------------------------------------------------------------

loc_411D58:				; CODE XREF: .text:00411D29j
		mov	eax, ds:_iob
		add	eax, 40h
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aA ; "a"
		mov	[esp], eax
		call	sub_4119F1
		mov	[ebp-10h], eax

loc_411D83:				; CODE XREF: .text:00411CEFj
					; .text:00411D23j ...
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_411DFF
		cmp	dword ptr [ebp+8], 0
		jz	short loc_411D96
		mov	eax, offset aA	; "a"
		jmp	short loc_411D9B
; ---------------------------------------------------------------------------

loc_411D96:				; CODE XREF: .text:00411D8Dj
		mov	eax, offset aR	; "r"

loc_411D9B:				; CODE XREF: .text:00411D94j
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_4119F1
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_411DFF
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp], eax
		call	strerror
		mov	edx, offset aFatalErrorCrea ; "fatal: error creating a dummy estream f"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	[esp], ecx
		call	fprintf
		call	abort
; ---------------------------------------------------------------------------

loc_411DFF:				; CODE XREF: .text:00411D87j
					; .text:00411DC2j
		mov	eax, [ebp-10h]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		or	edx, 2
		mov	[eax+250h], dl
		mov	eax, [ebp-10h]
		mov	eax, [eax+24h]
		mov	edx, [ebp+8]
		and	edx, 3
		and	edx, 3
		lea	ecx, ds:0[edx*4]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFF3h
		or	edx, ecx
		mov	[eax+250h], dl
		cmp	dword ptr [ebp+8], 2
		jnz	short loc_411E66
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 40h
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_411224

loc_411E66:				; CODE XREF: .text:00411E41j
		cmp	dword ptr [ebp+8], 0
		jz	short loc_411E80
		cmp	dword ptr [ebp+8], 1
		jnz	short loc_411E79
		mov	eax, offset aStdout_0 ;	"[stdout]"
		jmp	short loc_411E7E
; ---------------------------------------------------------------------------

loc_411E79:				; CODE XREF: .text:00411E70j
		mov	eax, offset aStderr ; "[stderr]"

loc_411E7E:				; CODE XREF: .text:00411E77j
		jmp	short loc_411E85
; ---------------------------------------------------------------------------

loc_411E80:				; CODE XREF: .text:00411E6Aj
		mov	eax, offset aStdin_0 ; "[stdin]"

loc_411E85:				; CODE XREF: .text:loc_411E7Ej
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_41355B

loc_411E9C:				; CODE XREF: .text:00411C3Cj
		mov	eax, ds:dword_430244
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp-10h]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		cmp	dword ptr [ebp+8], 0
		jz	loc_411FF3
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4100F8
		lea	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_40FB59
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_411F80
		mov	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		lea	eax, [ebp-1Ch]
		mov	[esp+4], eax
		lea	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_40FAA4
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_411F83
		mov	dword ptr [ebp-10h], 1
		mov	ecx, [ebp-14h]
		mov	edx, [ebp-1Ch]
		mov	eax, [ebp-18h]
		mov	[esp+1Ch], ecx
		mov	ecx, off_4292D0
		mov	[esp+0Ch], ecx
		mov	ecx, off_4292D4
		mov	[esp+10h], ecx
		mov	ecx, off_4292D8
		mov	[esp+14h], ecx
		mov	ecx, off_4292DC
		mov	[esp+18h], ecx
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_40FF1D
		jmp	short loc_411F84
; ---------------------------------------------------------------------------

loc_411F80:				; CODE XREF: .text:00411F04j
		nop
		jmp	short loc_411F84
; ---------------------------------------------------------------------------

loc_411F83:				; CODE XREF: .text:00411F2Dj
		nop

loc_411F84:				; CODE XREF: .text:00411F7Ej
					; .text:00411F81j
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_411FB7
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_411F9B
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_40F822

loc_411F9B:				; CODE XREF: .text:00411F8Ej
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_410323
		mov	dword ptr [ebp+10h], 0
		jmp	short loc_412025
; ---------------------------------------------------------------------------

loc_411FB7:				; CODE XREF: .text:00411F88j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_411FDD
		cmp	dword ptr [ebp+8], 0
		jz	short loc_411FDD
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_41355B

loc_411FDD:				; CODE XREF: .text:00411FBBj
					; .text:00411FC1j
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		jmp	short loc_412025
; ---------------------------------------------------------------------------

loc_411FF3:				; CODE XREF: .text:00411EB8j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4100F8
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_410323
		mov	dword ptr [ebp+10h], 0

loc_412025:				; CODE XREF: .text:00411FB5j
					; .text:00411FF1j
		mov	eax, [ebp+10h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41202A(void *)
sub_41202A	proc near		; CODE XREF: sub_4039ED+1AFp
					; sub_4039ED+1DAp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_24], 0 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_410323
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41202A	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+0Ch], 0
		jz	loc_412102
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+23Ch]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_412092
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 28h
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jmp	loc_41211E
; ---------------------------------------------------------------------------

loc_412092:				; CODE XREF: .text:00412077j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4120C1
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40FD34
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_41211A
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_4120C1:				; CODE XREF: .text:0041209Ej
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		lea	edx, [ebp-14h]
		mov	[esp+0Ch], edx
		mov	edx, [ebp+0Ch]
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		mov	eax, [ebp-10h]
		call	eax
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_41211D
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_412102
		mov	edx, [ebp-14h]
		mov	eax, [ebp+10h]
		mov	[eax], edx

loc_412102:				; CODE XREF: .text:00412055j
					; .text:004120F8j
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_410323
		mov	[ebp-0Ch], eax
		jmp	short loc_41211E
; ---------------------------------------------------------------------------

loc_41211A:				; CODE XREF: .text:004120B2j
		nop
		jmp	short loc_41211E
; ---------------------------------------------------------------------------

loc_41211D:				; CODE XREF: .text:004120F2j
		nop

loc_41211E:				; CODE XREF: .text:0041208Dj
					; .text:00412118j ...
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_412140
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_412140
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[esp], eax
		call	sub_40EE05
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0

loc_412140:				; CODE XREF: .text:00412122j
					; .text:00412128j
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_412145	proc near		; CODE XREF: .text:004121CCp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		mov	[esp+4+var_4], eax
		call	sub_4113EF
		leave
		retn
sub_412145	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDB1
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_412145
		mov	[ebp-4], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4121ED	proc near		; CODE XREF: .text:00412230p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	[esp+0Ch+var_4], 1
		mov	[esp+0Ch+var_8], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_4111D6
		leave
		retn
sub_4121ED	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4121ED
		mov	[ebp-4], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_412251	proc near		; CODE XREF: .text:00412294p
					; sub_41371A+3B4p ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	[esp+0Ch+var_4], 0
		mov	[esp+0Ch+var_8], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_4111D6
		leave
		retn
sub_412251	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_412251
		mov	[ebp-4], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4122B5	proc near		; CODE XREF: .text:004122F8p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	[esp+0Ch+var_4], 0
		mov	[esp+0Ch+var_8], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_41117C
		leave
		retn
sub_4122B5	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4122B5
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_412313	proc near		; CODE XREF: sub_41234E+26p
					; DATA XREF: sub_41234E:loc_412392o

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_412337
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40FD34
		mov	[ebp+var_C], eax
		jmp	short loc_412349
; ---------------------------------------------------------------------------

loc_412337:				; CODE XREF: sub_412313+12j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40FECD
		mov	[ebp+var_C], 0

loc_412349:				; CODE XREF: sub_412313+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_412313	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41234E	proc near		; CODE XREF: sub_40EF8B+Dp

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_412392
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_40EDAC
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_412313
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_40EDAC
		jmp	short loc_4123A1
; ---------------------------------------------------------------------------

loc_412392:				; CODE XREF: sub_41234E+Aj
		mov	[esp+28h+var_28], offset sub_412313
		call	sub_40EF36
		mov	[ebp+var_C], eax

loc_4123A1:				; CODE XREF: sub_41234E+42j
		cmp	[ebp+var_C], 0
		jz	short loc_4123AE
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4123B3
; ---------------------------------------------------------------------------

loc_4123AE:				; CODE XREF: sub_41234E+57j
		mov	eax, 0

locret_4123B3:				; CODE XREF: sub_41234E+5Ej
		leave
		retn
sub_41234E	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp+0Ch]
		mov	edx, eax
		sar	edx, 1Fh
		mov	dword ptr [esp+10h], 0
		mov	ecx, [ebp+10h]
		mov	[esp+0Ch], ecx
		mov	[esp+4], eax
		mov	[esp+8], edx
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41073E
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+0Ch]
		mov	[ebp-20h], eax
		mov	eax, [ebp+10h]
		mov	[ebp-1Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	dword ptr [esp+10h], 0
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp-20h]
		mov	edx, [ebp-1Ch]
		mov	[esp+4], eax
		mov	[esp+8], edx
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41073E
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_411349
		mov	[ebp-4], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [ebp-8], 0FFFFFFFFh
		mov	dword ptr [ebp-4], 0FFFFFFFFh
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_411349
		mov	[ebp-8], eax
		mov	[ebp-4], edx
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp-8]
		mov	edx, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41073E
		mov	dword ptr [esp+8], 0FFFFFFFFh
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41117C
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41258B	proc near		; CODE XREF: .text:0041267Cp
					; .text:004129EFp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_D]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], 1
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41054B
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4125CB
		mov	eax, [ebp+var_14]
		test	eax, eax
		jz	short loc_4125CB
		movzx	eax, [ebp+var_D]
		movzx	eax, al
		jmp	short locret_4125D0
; ---------------------------------------------------------------------------

loc_4125CB:				; CODE XREF: sub_41258B+2Ej
					; sub_41258B+35j
		mov	eax, 0FFFFFFFFh

locret_4125D0:				; CODE XREF: sub_41258B+3Ej
		leave
		retn
sub_41258B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4125D2	proc near		; CODE XREF: .text:0041270Cp
					; sub_41371A+BBp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_D], al
		lea	eax, [ebp+var_D]
		mov	[esp+28h+var_1C], 0
		mov	[esp+28h+var_20], 1
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_410B2C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41260E
		mov	eax, [ebp+arg_0]
		jmp	short locret_412613
; ---------------------------------------------------------------------------

loc_41260E:				; CODE XREF: sub_4125D2+35j
		mov	eax, 0FFFFFFFFh

locret_412613:				; CODE XREF: sub_4125D2+3Aj
		leave
		retn
sub_4125D2	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_412676
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_412676
		mov	eax, [ebp+8]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_412676
		mov	eax, [ebp+8]
		mov	ecx, [eax]
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+0Ch], ecx
		jmp	short loc_412681
; ---------------------------------------------------------------------------

loc_412676:				; CODE XREF: .text:0041263Bj
					; .text:0041264Bj ...
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41258B

loc_412681:				; CODE XREF: .text:00412674j
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4126FF
		mov	eax, [ebp+0Ch]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_4126FF
		cmp	dword ptr [ebp+8], 0Ah
		jz	short loc_4126FF
		mov	eax, [ebp+0Ch]
		mov	ecx, [eax]
		mov	eax, [ebp+0Ch]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		mov	ecx, [ebp+8]
		mov	[eax], cl
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+0Ch]
		mov	[edx+0Ch], ecx
		jmp	short loc_412711
; ---------------------------------------------------------------------------

loc_4126FF:				; CODE XREF: .text:004126C3j
					; .text:004126D3j ...
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4125D2

loc_412711:				; CODE XREF: .text:004126FDj
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-9], al
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		lea	eax, [ebp-9]
		lea	edx, [ebp-10h]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_4106AF
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp-10h]
		test	eax, eax
		jz	short loc_41278E
		mov	eax, [ebp+8]
		jmp	short locret_412793
; ---------------------------------------------------------------------------

loc_41278E:				; CODE XREF: .text:00412787j
		mov	eax, 0FFFFFFFFh

locret_412793:				; CODE XREF: .text:0041278Cj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_412795	proc near		; CODE XREF: sub_410D56+2CFp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jz	short loc_4127EE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_40EDAC
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41054B
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_40EDAC
		jmp	short loc_4127F5
; ---------------------------------------------------------------------------

loc_4127EE:				; CODE XREF: sub_412795+Aj
		mov	[ebp+var_C], 0

loc_4127F5:				; CODE XREF: sub_412795+57j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_412795	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4127FA	proc near		; CODE XREF: sub_410D56+194p
					; sub_410D56+1E0p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jz	short loc_412853
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_40EDAC
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_410B2C
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_40EDAC
		jmp	short loc_41285A
; ---------------------------------------------------------------------------

loc_412853:				; CODE XREF: sub_4127FA+Aj
		mov	[ebp+var_C], 0

loc_41285A:				; CODE XREF: sub_4127FA+57j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4127FA	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		test	eax, eax
		jz	short loc_4128CC
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		lea	edx, [ebp-10h]
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_41054B
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp-10h]
		mov	edx, 0
		div	dword ptr [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	short loc_4128D3
; ---------------------------------------------------------------------------

loc_4128CC:				; CODE XREF: .text:0041286Ej
		mov	dword ptr [ebp-0Ch], 0

loc_4128D3:				; CODE XREF: .text:004128CAj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4128D8	proc near		; CODE XREF: sub_4039ED+177p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		imul	eax, [ebp+arg_8]
		test	eax, eax
		jz	short loc_412945
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_40EDAC
		mov	eax, [ebp+arg_4]
		imul	eax, [ebp+arg_8]
		lea	edx, [ebp+var_10]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_28], eax
		call	sub_410B2C
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_40EDAC
		mov	eax, [ebp+var_10]
		mov	edx, 0
		div	[ebp+arg_4]
		mov	[ebp+var_C], eax
		jmp	short loc_41294C
; ---------------------------------------------------------------------------

loc_412945:				; CODE XREF: sub_4128D8+Fj
		mov	[ebp+var_C], 0

loc_41294C:				; CODE XREF: sub_4128D8+6Bj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4128D8	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_41296D
		mov	eax, 0
		jmp	locret_412A4F
; ---------------------------------------------------------------------------

loc_41296D:				; CODE XREF: .text:00412961j
		mov	dword ptr [ebp-10h], 0FFFFFFFFh
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		jmp	short loc_41299C
; ---------------------------------------------------------------------------

loc_41298A:				; CODE XREF: .text:00412A01j
		mov	eax, [ebp-10h]
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp+0Ch], 1

loc_41299C:				; CODE XREF: .text:00412988j
		cmp	dword ptr [ebp+0Ch], 1
		jle	short loc_412A03
		mov	eax, [ebp+10h]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_4129E9
		mov	eax, [ebp+10h]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+10h]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_4129E9
		mov	eax, [ebp+10h]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_4129E9
		mov	eax, [ebp+10h]
		mov	ecx, [eax]
		mov	eax, [ebp+10h]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+10h]
		mov	[edx+0Ch], ecx
		jmp	short loc_4129F4
; ---------------------------------------------------------------------------

loc_4129E9:				; CODE XREF: .text:004129AEj
					; .text:004129BEj ...
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_41258B

loc_4129F4:				; CODE XREF: .text:004129E7j
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jz	short loc_412A03
		cmp	dword ptr [ebp-10h], 0Ah
		jnz	short loc_41298A

loc_412A03:				; CODE XREF: .text:004129A0j
					; .text:004129FBj
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_412A2C
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_412A2C
		mov	eax, 0
		jmp	short locret_412A4F
; ---------------------------------------------------------------------------

loc_412A2C:				; CODE XREF: .text:00412A1Bj
					; .text:00412A23j
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jz	short loc_412A46
		cmp	dword ptr [ebp+0Ch], 1
		jle	short loc_412A46
		mov	eax, [ebp-10h]
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1

loc_412A46:				; CODE XREF: .text:00412A30j
					; .text:00412A36j
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+8]

locret_412A4F:				; CODE XREF: .text:00412968j
					; .text:00412A2Aj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp-0Ch], eax
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_410B2C
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_412AAB
		mov	eax, 0FFFFFFFFh
		jmp	short loc_412AB0
; ---------------------------------------------------------------------------

loc_412AAB:				; CODE XREF: .text:00412AA2j
		mov	eax, 0

loc_412AB0:				; CODE XREF: .text:00412AA9j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_412AB6	proc near		; CODE XREF: .text:00413D96p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+38h+var_38], eax
		call	sub_40EDAC
		mov	[esp+38h+var_2C], 0
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	sub_410B2C
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+38h+var_38], eax
		call	sub_40EDAC
		cmp	[ebp+var_10], 0
		jz	short loc_412B38
		mov	eax, 0FFFFFFFFh
		jmp	short loc_412B3D
; ---------------------------------------------------------------------------

loc_412B38:				; CODE XREF: sub_412AB6+79j
		mov	eax, 0

loc_412B3D:				; CODE XREF: sub_412AB6+80j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_412AB6	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-18h], 0
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		lea	eax, [ebp-14h]
		lea	edx, [ebp-18h]
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_410D56
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		cmp	dword ptr [ebp-0Ch], 0
		jnz	loc_412C5F
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		test	eax, eax
		jz	loc_412C4B
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	edx, [ebp-18h]
		add	edx, 1
		cmp	eax, edx
		jnb	short loc_412C04
		mov	eax, [ebp-18h]
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_40EDD8
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_412BF2
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jmp	short loc_412C04
; ---------------------------------------------------------------------------

loc_412BF2:				; CODE XREF: .text:00412BE7j
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, [ebp-10h]
		jz	short loc_412C04
		mov	edx, [ebp-10h]
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_412C04:				; CODE XREF: .text:00412BC7j
					; .text:00412BF0j ...
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_412C3E
		mov	eax, [ebp-18h]
		lea	ecx, [eax+1]
		mov	eax, [ebp-14h]
		mov	edx, eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp+0Ch]
		mov	edx, [eax]
		mov	eax, [ebp-18h]
		cmp	edx, eax
		jz	short loc_412C3E
		mov	edx, [ebp-18h]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx

loc_412C3E:				; CODE XREF: .text:00412C08j
					; .text:00412C34j
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_40EE05
		jmp	short loc_412C60
; ---------------------------------------------------------------------------

loc_412C4B:				; CODE XREF: .text:00412BB4j
		mov	eax, [ebp-14h]
		mov	edx, eax
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	edx, [ebp-18h]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx
		jmp	short loc_412C60
; ---------------------------------------------------------------------------

loc_412C5F:				; CODE XREF: .text:00412BA7j
		nop

loc_412C60:				; CODE XREF: .text:00412C49j
					; .text:00412C5Dj
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_412C6B
		mov	eax, [ebp-18h]
		jmp	short locret_412C6E
; ---------------------------------------------------------------------------

loc_412C6B:				; CODE XREF: .text:00412C64j
		mov	eax, [ebp-0Ch]

locret_412C6E:				; CODE XREF: .text:00412C69j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		mov	[ebp-14h], eax
		mov	dword ptr [ebp-18h], 0
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_412C9A
		mov	eax, [ebp+14h]
		mov	eax, [eax]
		jmp	short loc_412C9F
; ---------------------------------------------------------------------------

loc_412C9A:				; CODE XREF: .text:00412C91j
		mov	eax, 0

loc_412C9F:				; CODE XREF: .text:00412C98j
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_412CF5
		mov	dword ptr [ebp-14h], 100h
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_40EDBB
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp-10h]
		mov	[eax], edx
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_412CED
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 0
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_412CE3
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0

loc_412CE3:				; CODE XREF: .text:00412CD8j
		mov	eax, 0FFFFFFFFh
		jmp	locret_412F2C
; ---------------------------------------------------------------------------

loc_412CED:				; CODE XREF: .text:00412CC9j
		mov	eax, [ebp+10h]
		mov	edx, [ebp-14h]
		mov	[eax], edx

loc_412CF5:				; CODE XREF: .text:00412CA6j
		cmp	dword ptr [ebp-14h], 3
		ja	short loc_412D12
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_412F2C
; ---------------------------------------------------------------------------

loc_412D12:				; CODE XREF: .text:00412CF9j
		sub	dword ptr [ebp-14h], 3
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp-10h]
		mov	[ebp-1Ch], eax
		jmp	loc_412EAA
; ---------------------------------------------------------------------------

loc_412D35:				; CODE XREF: .text:00412F03j
		mov	eax, [ebp-18h]
		cmp	eax, [ebp-14h]
		jnz	loc_412E92
		cmp	dword ptr [ebp-20h], 0
		jz	loc_412DDE
		mov	eax, [ebp-14h]
		cmp	eax, [ebp-20h]
		jbe	loc_412DDE

loc_412D57:				; CODE XREF: .text:00412DB6j
		cmp	dword ptr [ebp-0Ch], 0Ah
		jz	short loc_412DB8
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_412DA4
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_412DA4
		mov	eax, [ebp+8]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_412DA4
		mov	eax, [ebp+8]
		mov	ecx, [eax]
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+0Ch], ecx
		jmp	short loc_412DAF
; ---------------------------------------------------------------------------

loc_412DA4:				; CODE XREF: .text:00412D69j
					; .text:00412D79j ...
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41258B

loc_412DAF:				; CODE XREF: .text:00412DA2j
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_412D57

loc_412DB8:				; CODE XREF: .text:00412D5Bj
		mov	eax, [ebp-1Ch]
		mov	byte ptr [eax],	0Ah
		add	dword ptr [ebp-1Ch], 1
		add	dword ptr [ebp-18h], 1
		cmp	dword ptr [ebp+14h], 0
		jz	loc_412F0B
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0
		jmp	loc_412F0B
; ---------------------------------------------------------------------------

loc_412DDE:				; CODE XREF: .text:00412D45j
					; .text:00412D51j
		add	dword ptr [ebp-14h], 3
		cmp	dword ptr [ebp-14h], 3FFh
		ja	short loc_412DF2
		mov	eax, 100h
		jmp	short loc_412DF7
; ---------------------------------------------------------------------------

loc_412DF2:				; CODE XREF: .text:00412DE9j
		mov	eax, 400h

loc_412DF7:				; CODE XREF: .text:00412DF0j
		add	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_40EDD8
		mov	edx, [ebp+0Ch]
		mov	[edx], eax
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_412E73
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp-24h], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_40EE05
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 0
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_412E49
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0

loc_412E49:				; CODE XREF: .text:00412E3Ej
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp-24h]
		mov	[eax], edx
		mov	eax, 0FFFFFFFFh
		jmp	locret_412F2C
; ---------------------------------------------------------------------------

loc_412E73:				; CODE XREF: .text:00412E18j
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp+10h]
		mov	edx, [ebp-14h]
		mov	[eax], edx
		sub	dword ptr [ebp-14h], 3
		mov	eax, [ebp-18h]
		mov	edx, [ebp-10h]
		add	eax, edx
		mov	[ebp-1Ch], eax

loc_412E92:				; CODE XREF: .text:00412D3Bj
		mov	eax, [ebp-0Ch]
		mov	edx, eax
		mov	eax, [ebp-1Ch]
		mov	[eax], dl
		add	dword ptr [ebp-1Ch], 1
		add	dword ptr [ebp-18h], 1
		cmp	dword ptr [ebp-0Ch], 0Ah
		jz	short loc_412F0E

loc_412EAA:				; CODE XREF: .text:00412D30j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_412EF1
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_412EF1
		mov	eax, [ebp+8]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_412EF1
		mov	eax, [ebp+8]
		mov	ecx, [eax]
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+0Ch], ecx
		jmp	short loc_412EFC
; ---------------------------------------------------------------------------

loc_412EF1:				; CODE XREF: .text:00412EB6j
					; .text:00412EC6j ...
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41258B

loc_412EFC:				; CODE XREF: .text:00412EEFj
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	loc_412D35
		jmp	short loc_412F0F
; ---------------------------------------------------------------------------

loc_412F0B:				; CODE XREF: .text:00412DCAj
					; .text:00412DD9j
		nop
		jmp	short loc_412F0F
; ---------------------------------------------------------------------------

loc_412F0E:				; CODE XREF: .text:00412EA8j
		nop

loc_412F0F:				; CODE XREF: .text:00412F09j
					; .text:00412F0Cj
		mov	eax, [ebp-1Ch]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp-18h]

locret_412F2C:				; CODE XREF: .text:00412CE8j
					; .text:00412D0Dj ...
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40EE05
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_411127
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_411127
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_412FB1	proc near		; CODE XREF: sub_41371A+31Ap

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_411127
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_412FB1	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+10h]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_411127
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_416783
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jns	short loc_41306E
		mov	eax, 0
		jmp	short locret_413071
; ---------------------------------------------------------------------------

loc_41306E:				; CODE XREF: .text:00413065j
		mov	eax, [ebp-14h]

locret_413071:				; CODE XREF: .text:0041306Cj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_416783
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jns	short loc_4130A2
		mov	eax, 0
		jmp	short locret_4130A5
; ---------------------------------------------------------------------------

loc_4130A2:				; CODE XREF: .text:00413099j
		mov	eax, [ebp-10h]

locret_4130A5:				; CODE XREF: .text:004130A0j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4130A7	proc near		; CODE XREF: .text:004132FDp

nBufferLength	= dword	ptr -178h
lpBuffer	= dword	ptr -174h
dwShareMode	= dword	ptr -170h
lpSecurityAttributes= dword ptr	-16Ch
dwCreationDisposition= dword ptr -168h
dwFlagsAndAttributes= dword ptr	-164h
hTemplateFile	= dword	ptr -160h
var_14C		= dword	ptr -14Ch
Buffer		= byte ptr -146h
var_2C		= dword	ptr -2Ch
hObject		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 174h
		mov	eax, ds:GetCurrentProcessId
		call	eax ; GetCurrentProcessId
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+Buffer]
		mov	[esp+178h+lpBuffer], eax ; lpBuffer
		mov	[esp+178h+nBufferLength], 105h ; nBufferLength
		mov	eax, ds:GetTempPathA
		call	eax ; GetTempPathA
		sub	esp, 8
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_413117
		cmp	[ebp+var_20], 104h
		jg	short loc_413117
		lea	eax, [ebp+Buffer]
		mov	[ebp+var_14C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 104h
		jbe	short loc_41312E

loc_413117:				; CODE XREF: sub_4130A7+36j
					; sub_4130A7+3Fj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 2
		mov	eax, 0FFFFFFFFh
		jmp	loc_4132D6
; ---------------------------------------------------------------------------

loc_41312E:				; CODE XREF: sub_4130A7+6Ej
		lea	eax, [ebp+Buffer]
		mov	[ebp+var_14C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp+Buffer]
		add	eax, edx
		mov	[ebp+var_10], eax
		mov	edx, offset a_estream ;	"_estream"
		mov	eax, [ebp+var_10]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	edx, byte ptr [edx+8]
		mov	[eax+8], dl
		add	[ebp+var_10], 8
		mov	[esp+178h+lpBuffer], 0 ; lpSecurityAttributes
		lea	eax, [ebp+Buffer]
		mov	[esp+178h+nBufferLength], eax ;	lpPathName
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[ebp+var_24], eax
		mov	[ebp+var_C], 0
		jmp	loc_4132BA
; ---------------------------------------------------------------------------

loc_4131B5:				; CODE XREF: sub_4130A7+217j
		mov	eax, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	eax, ds:GetTickCount
		call	eax ; GetTickCount
		mov	edx, [ebp+var_1C]
		shl	edx, 10h
		xor	eax, edx
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		jmp	short loc_413206
; ---------------------------------------------------------------------------

loc_4131D6:				; CODE XREF: sub_4130A7+163j
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		cmp	eax, 9
		ja	short loc_4131EC
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		add	eax, 30h
		jmp	short loc_4131F5
; ---------------------------------------------------------------------------

loc_4131EC:				; CODE XREF: sub_4130A7+138j
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		add	eax, 37h

loc_4131F5:				; CODE XREF: sub_4130A7+143j
		mov	edx, [ebp+var_10]
		mov	[edx], al
		add	[ebp+var_10], 1
		shl	[ebp+var_14], 4
		add	[ebp+var_18], 1

loc_413206:				; CODE XREF: sub_4130A7+12Dj
		cmp	[ebp+var_18], 7
		jle	short loc_4131D6
		mov	edx, offset a_tmp ; ".tmp"
		mov	eax, [ebp+var_10]
		mov	ecx, [edx]
		mov	[eax], ecx
		movzx	edx, byte ptr [edx+4]
		mov	[eax+4], dl
		mov	[esp+178h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+178h+dwFlagsAndAttributes], 4000100h ; dwFlagsAndAttributes
		mov	[esp+178h+dwCreationDisposition], 1 ; dwCreationDisposition
		mov	[esp+178h+lpSecurityAttributes], 0 ; lpSecurityAttributes
		mov	[esp+178h+dwShareMode],	0 ; dwShareMode
		mov	[esp+178h+lpBuffer], 0C0000000h	; dwDesiredAccess
		lea	eax, [ebp+Buffer]
		mov	[esp+178h+nBufferLength], eax ;	lpFileName
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0FFFFFFFFh
		jz	short loc_4132A5
		mov	eax, [ebp+hObject]
		mov	[esp+178h+lpBuffer], 0
		mov	[esp+178h+nBufferLength], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0FFFFFFFFh
		jnz	short loc_4132A0
		mov	eax, [ebp+hObject]
		mov	[esp+178h+nBufferLength], eax ;	hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0FFFFFFFFh
		jmp	short loc_4132D6
; ---------------------------------------------------------------------------

loc_4132A0:				; CODE XREF: sub_4130A7+1E0j
		mov	eax, [ebp+var_2C]
		jmp	short loc_4132D6
; ---------------------------------------------------------------------------

loc_4132A5:				; CODE XREF: sub_4130A7+1C2j
		mov	[esp+178h+nBufferLength], 1 ; dwMilliseconds
		mov	eax, ds:Sleep
		call	eax ; Sleep
		sub	esp, 4
		add	[ebp+var_C], 1

loc_4132BA:				; CODE XREF: sub_4130A7+109j
		cmp	[ebp+var_C], 9
		jle	loc_4131B5
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 2
		mov	eax, 0FFFFFFFFh

loc_4132D6:				; CODE XREF: sub_4130A7+82j
					; sub_4130A7+1F7j ...
		mov	edi, [ebp+var_4]
		leave
		retn
sub_4130A7	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-14h], 302h
		mov	dword ptr [ebp-20h], 0
		call	sub_4130A7
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jnz	short loc_413317
		mov	dword ptr [ebp-10h], 0FFFFFFFFh
		jmp	loc_41339E
; ---------------------------------------------------------------------------

loc_413317:				; CODE XREF: .text:00413309j
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp-14h]
		mov	[esp+8], eax
		mov	eax, [ebp-18h]
		mov	[esp+4], eax
		lea	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_40F67D
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_41339D
		mov	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-20h]
		mov	dword ptr [esp+20h], 0
		mov	edx, [ebp-14h]
		mov	[esp+1Ch], edx
		mov	edx, off_4292D0
		mov	[esp+0Ch], edx
		mov	edx, off_4292D4
		mov	[esp+10h], edx
		mov	edx, off_4292D8
		mov	[esp+14h], edx
		mov	edx, off_4292DC
		mov	[esp+18h], edx
		mov	edx, [ebp-18h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		lea	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_4101FC
		mov	[ebp-10h], eax
		jmp	short loc_41339E
; ---------------------------------------------------------------------------

loc_41339D:				; CODE XREF: .text:0041333Fj
		nop

loc_41339E:				; CODE XREF: .text:00413312j
					; .text:0041339Bj
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_4133CF
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_4133B7
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_40F822
		jmp	short loc_4133C8
; ---------------------------------------------------------------------------

loc_4133B7:				; CODE XREF: .text:004133A8j
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jz	short loc_4133C8
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	_close

loc_4133C8:				; CODE XREF: .text:004133B5j
					; .text:004133BBj
		mov	dword ptr [ebp-1Ch], 0

loc_4133CF:				; CODE XREF: .text:004133A2j
		mov	eax, [ebp-1Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_4133EC
		cmp	dword ptr [ebp+10h], 40h
		jz	short loc_4133EC
		cmp	dword ptr [ebp+10h], 4
		jnz	short loc_41344B

loc_4133EC:				; CODE XREF: .text:004133DEj
					; .text:004133E4j
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_4133FE
		cmp	dword ptr [ebp+14h], 0
		jnz	short loc_4133FE
		cmp	dword ptr [ebp+10h], 4
		jnz	short loc_41344B

loc_4133FE:				; CODE XREF: .text:004133F0j
					; .text:004133F6j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_411224
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		jmp	short loc_41345F
; ---------------------------------------------------------------------------

loc_41344B:				; CODE XREF: .text:004133EAj
					; .text:004133FCj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh

loc_41345F:				; CODE XREF: .text:00413449j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_41348B
		mov	eax, 0
		jmp	short loc_413490
; ---------------------------------------------------------------------------

loc_41348B:				; CODE XREF: .text:00413482j
		mov	eax, 4

loc_413490:				; CODE XREF: .text:00413489j
		mov	dword ptr [esp+0Ch], 200h
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_411224
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4113BE
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		lea	eax, [ebp-4]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4113BE
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41355B(int, char *, int)
sub_41355B	proc near		; CODE XREF: sub_411413+E9p
					; .text:00411E97p ...

Dest		= dword	ptr -28h
Source		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		test	eax, eax
		jz	short loc_4135AB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		and	eax, 20h
		test	al, al
		jnz	short loc_4135AB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	[esp+28h+Dest],	eax ; void *
		call	sub_40EE05
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+220h], 0

loc_4135AB:				; CODE XREF: sub_41355B+16j
					; sub_41355B+2Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		test	eax, eax
		jnz	loc_413657
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Bh
		jz	short loc_4135D2
		mov	[ebp+arg_8], 0
		jmp	short loc_4135DF
; ---------------------------------------------------------------------------

loc_4135D2:				; CODE XREF: sub_41355B+6Cj
		cmp	[ebp+arg_8], 0
		setnz	al
		movzx	eax, al
		mov	[ebp+arg_8], eax

loc_4135DF:				; CODE XREF: sub_41355B+75j
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+24h]
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_8]
		add	eax, edx
		add	eax, 1
		mov	[esp+28h+Dest],	eax ; size_t
		call	sub_40EDBB
		mov	[ebx+220h], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_413658
		cmp	[ebp+arg_8], 0
		jz	short loc_413635
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	byte ptr [eax],	5Ch

loc_413635:				; CODE XREF: sub_41355B+C9j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [eax+220h]
		mov	eax, [ebp+arg_8]
		add	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Source], eax ;	Source
		mov	[esp+28h+Dest],	edx ; Dest
		call	strcpy
		jmp	short loc_413658
; ---------------------------------------------------------------------------

loc_413657:				; CODE XREF: sub_41355B+5Ej
		nop

loc_413658:				; CODE XREF: sub_41355B+C3j
					; sub_41355B+FAj
		add	esp, 20h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41355B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short locret_4136AD
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41355B
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC

locret_4136AD:				; CODE XREF: .text:00413669j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	[ebp-4], eax
		cmp	dword ptr [ebp-4], 0
		jz	short loc_4136F4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		or	edx, 20h
		mov	[eax+250h], dl

loc_4136F4:				; CODE XREF: .text:004136DCj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		cmp	dword ptr [ebp-4], 0
		jnz	short loc_413715
		mov	dword ptr [ebp-4], offset a? ; "[?]"

loc_413715:				; CODE XREF: .text:0041370Cj
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41371A(int, int, int,	char *,	int)
sub_41371A	proc near		; CODE XREF: .text:00413DDBp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+Str], eax
		call	sub_40EDAC
		jmp	loc_413AB0
; ---------------------------------------------------------------------------

loc_413746:				; CODE XREF: sub_41371A+39Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_41378E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_41378E
		cmp	[ebp+arg_C], 0
		jz	loc_413A3F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jnz	short loc_41378E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_413A3F

loc_41378E:				; CODE XREF: sub_41371A+34j
					; sub_41371A+3Ej ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4137C7
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_4137C7
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	5Ch
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_4137DA
; ---------------------------------------------------------------------------

loc_4137C7:				; CODE XREF: sub_41371A+80j
					; sub_41371A+90j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 5Ch
		call	sub_4125D2

loc_4137DA:				; CODE XREF: sub_41371A+ABj
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_41383D
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_413821
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_413821
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	6Eh
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_413834
; ---------------------------------------------------------------------------

loc_413821:				; CODE XREF: sub_41371A+DAj
					; sub_41371A+EAj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 6Eh
		call	sub_4125D2

loc_413834:				; CODE XREF: sub_41371A+105j
		add	[ebp+var_10], 1
		jmp	loc_413AA4
; ---------------------------------------------------------------------------

loc_41383D:				; CODE XREF: sub_41371A+CCj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_41389C
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_413880
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_413880
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	72h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_413893
; ---------------------------------------------------------------------------

loc_413880:				; CODE XREF: sub_41371A+139j
					; sub_41371A+149j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 72h
		call	sub_4125D2

loc_413893:				; CODE XREF: sub_41371A+164j
		add	[ebp+var_10], 1
		jmp	loc_413AA4
; ---------------------------------------------------------------------------

loc_41389C:				; CODE XREF: sub_41371A+12Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_4138FB
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4138DF
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_4138DF
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	66h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_4138F2
; ---------------------------------------------------------------------------

loc_4138DF:				; CODE XREF: sub_41371A+198j
					; sub_41371A+1A8j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 66h
		call	sub_4125D2

loc_4138F2:				; CODE XREF: sub_41371A+1C3j
		add	[ebp+var_10], 1
		jmp	loc_413AA4
; ---------------------------------------------------------------------------

loc_4138FB:				; CODE XREF: sub_41371A+18Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_41395A
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_41393E
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_41393E
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	76h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_413951
; ---------------------------------------------------------------------------

loc_41393E:				; CODE XREF: sub_41371A+1F7j
					; sub_41371A+207j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 76h
		call	sub_4125D2

loc_413951:				; CODE XREF: sub_41371A+222j
		add	[ebp+var_10], 1
		jmp	loc_413AA4
; ---------------------------------------------------------------------------

loc_41395A:				; CODE XREF: sub_41371A+1E9j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_4139B9
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_41399D
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_41399D
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	62h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_4139B0
; ---------------------------------------------------------------------------

loc_41399D:				; CODE XREF: sub_41371A+256j
					; sub_41371A+266j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 62h
		call	sub_4125D2

loc_4139B0:				; CODE XREF: sub_41371A+281j
		add	[ebp+var_10], 1
		jmp	loc_413AA4
; ---------------------------------------------------------------------------

loc_4139B9:				; CODE XREF: sub_41371A+248j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_413A18
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4139FC
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_4139FC
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	30h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_413A0F
; ---------------------------------------------------------------------------

loc_4139FC:				; CODE XREF: sub_41371A+2B5j
					; sub_41371A+2C5j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 30h
		call	sub_4125D2

loc_413A0F:				; CODE XREF: sub_41371A+2E0j
		add	[ebp+var_10], 1
		jmp	loc_413AA4
; ---------------------------------------------------------------------------

loc_413A18:				; CODE XREF: sub_41371A+2A7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x ; "x%02x"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_412FB1
		add	[ebp+var_10], 3
		jmp	short loc_413AA4
; ---------------------------------------------------------------------------

loc_413A3F:				; CODE XREF: sub_41371A+44j
					; sub_41371A+6Ej
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_413A88
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_413A88
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_413A88
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+var_C]
		movzx	edx, byte ptr [edx]
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_413AA0
; ---------------------------------------------------------------------------

loc_413A88:				; CODE XREF: sub_41371A+331j
					; sub_41371A+341j ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Val], edx
		mov	[esp+28h+Str], eax
		call	sub_4125D2

loc_413AA0:				; CODE XREF: sub_41371A+36Cj
		add	[ebp+var_10], 1

loc_413AA4:				; CODE XREF: sub_41371A+11Ej
					; sub_41371A+17Dj ...
		sub	[ebp+arg_8], 1
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_413AB0:				; CODE XREF: sub_41371A+27j
		cmp	[ebp+arg_8], 0
		jnz	loc_413746
		cmp	[ebp+arg_10], 0
		jz	short loc_413AC8
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_413AC8:				; CODE XREF: sub_41371A+3A4j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_412251
		test	eax, eax
		jz	short loc_413ADE
		mov	eax, 0FFFFFFFFh
		jmp	short loc_413AE3
; ---------------------------------------------------------------------------

loc_413ADE:				; CODE XREF: sub_41371A+3BBj
		mov	eax, 0

loc_413AE3:				; CODE XREF: sub_41371A+3C2j
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+Str], eax
		call	sub_40EDAC
		mov	eax, [ebp+var_14]
		leave
		retn
sub_41371A	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_413B1C
		mov	eax, 0
		jmp	locret_413CE8
; ---------------------------------------------------------------------------

loc_413B1C:				; CODE XREF: .text:00413B10j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	loc_413C9B
; ---------------------------------------------------------------------------

loc_413B3B:				; CODE XREF: .text:00413C9Fj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_413BA2
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_413BA2
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		shr	dl, 4
		movzx	edx, dl
		and	edx, 0Fh
		cmp	edx, 9
		jg	short loc_413B89
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		shr	dl, 4
		add	edx, 30h
		jmp	short loc_413B95
; ---------------------------------------------------------------------------

loc_413B89:				; CODE XREF: .text:00413B79j
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		shr	dl, 4
		add	edx, 37h

loc_413B95:				; CODE XREF: .text:00413B87j
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx
		jmp	short loc_413BEB
; ---------------------------------------------------------------------------

loc_413BA2:				; CODE XREF: .text:00413B47j
					; .text:00413B57j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_413BCA
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_413BDC
; ---------------------------------------------------------------------------

loc_413BCA:				; CODE XREF: .text:00413BB4j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 37h

loc_413BDC:				; CODE XREF: .text:00413BC8j
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_4125D2

loc_413BEB:				; CODE XREF: .text:00413BA0j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_413C4F
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_413C4F
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		and	edx, 0Fh
		cmp	edx, 9
		jg	short loc_413C36
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		and	edx, 0Fh
		add	edx, 30h
		jmp	short loc_413C42
; ---------------------------------------------------------------------------

loc_413C36:				; CODE XREF: .text:00413C26j
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		and	edx, 0Fh
		add	edx, 37h

loc_413C42:				; CODE XREF: .text:00413C34j
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx
		jmp	short loc_413C8F
; ---------------------------------------------------------------------------

loc_413C4F:				; CODE XREF: .text:00413BF7j
					; .text:00413C07j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_413C71
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_413C80
; ---------------------------------------------------------------------------

loc_413C71:				; CODE XREF: .text:00413C5Ej
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 37h

loc_413C80:				; CODE XREF: .text:00413C6Fj
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_4125D2

loc_413C8F:				; CODE XREF: .text:00413C4Dj
		add	dword ptr [ebp-10h], 2
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp+10h], 1

loc_413C9B:				; CODE XREF: .text:00413B36j
		cmp	dword ptr [ebp+10h], 0
		jnz	loc_413B3B
		cmp	dword ptr [ebp+18h], 0
		jz	short loc_413CB3
		mov	eax, [ebp+18h]
		mov	edx, [ebp-10h]
		mov	[eax], edx

loc_413CB3:				; CODE XREF: .text:00413CA9j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_412251
		test	eax, eax
		jz	short loc_413CC9
		mov	eax, 0FFFFFFFFh
		jmp	short loc_413CCE
; ---------------------------------------------------------------------------

loc_413CC9:				; CODE XREF: .text:00413CC0j
		mov	eax, 0

loc_413CCE:				; CODE XREF: .text:00413CC7j
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40EDAC
		mov	eax, [ebp-14h]

locret_413CE8:				; CODE XREF: .text:00413B17j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_413D13
; ---------------------------------------------------------------------------

loc_413D00:				; CODE XREF: .text:00413D19j
		mov	eax, [ebp-0Ch]
		mov	edx, [ebp-10h]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_413D1D
		add	dword ptr [ebp-0Ch], 1

loc_413D13:				; CODE XREF: .text:00413CFEj
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jb	short loc_413D00
		jmp	short loc_413D1E
; ---------------------------------------------------------------------------

loc_413D1D:				; CODE XREF: .text:00413D0Dj
		nop

loc_413D1E:				; CODE XREF: .text:00413D1Bj
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jnb	loc_413DB9
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_413D3B
		mov	eax, [ebp+14h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		jmp	short loc_413D40
; ---------------------------------------------------------------------------

loc_413D3B:				; CODE XREF: .text:00413D2Ej
		mov	eax, 0

loc_413D40:				; CODE XREF: .text:00413D39j
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_4255BF
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp+18h], 0
		jz	short loc_413D89
		mov	eax, [ebp-18h]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+18h]
		mov	[eax], edx

loc_413D89:				; CODE XREF: .text:00413D63j
		mov	eax, [ebp-18h]
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_412AB6
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	gcry_free
		cmp	dword ptr [ebp-1Ch], 0FFFFFFFFh
		jz	short loc_413DB4
		mov	eax, [ebp-0Ch]
		jmp	short loc_413DB7
; ---------------------------------------------------------------------------

loc_413DB4:				; CODE XREF: .text:00413DADj
		mov	eax, [ebp-1Ch]

loc_413DB7:				; CODE XREF: .text:00413DB2j
		jmp	short loc_413DE0
; ---------------------------------------------------------------------------

loc_413DB9:				; CODE XREF: .text:00413D24j
		mov	eax, [ebp-10h]
		mov	edx, [ebp+18h]
		mov	[esp+10h], edx
		mov	edx, [ebp+14h]
		mov	[esp+0Ch], edx
		mov	edx, [ebp+10h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41371A

loc_413DE0:				; CODE XREF: .text:loc_413DB7j
		add	esp, 54h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413DE8	proc near		; CODE XREF: sub_413FE9+6E9p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 12h	; switch 19 cases
		ja	loc_413FE7	; jumptable 00413E01 default case
		mov	eax, ds:off_42C22C[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_413E03:				; CODE XREF: sub_413DE8+19j
					; DATA XREF: .rdata:off_42C22Co
		mov	eax, [ebp+arg_0] ; jumptable 00413E01 case 0
		mov	dword ptr [eax+24h], 0
		jmp	loc_413FE7	; jumptable 00413E01 default case
; ---------------------------------------------------------------------------

loc_413E12:				; CODE XREF: sub_413DE8+19j
					; DATA XREF: .rdata:off_42C22Co
		mov	eax, [ebp+arg_0] ; jumptable 00413E01 case 1
		mov	eax, [eax+10h]
		cmp	eax, 7		; switch 8 cases
		ja	short loc_413E7A ; jumptable 00413E24 default case
		mov	eax, ds:off_42C278[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_413E26:				; CODE XREF: sub_413DE8+3Cj
					; DATA XREF: .rdata:off_42C278o
		mov	eax, [ebp+arg_0] ; jumptable 00413E24 case 1
		mov	dword ptr [eax+24h], 2
		jmp	short loc_413E85
; ---------------------------------------------------------------------------

loc_413E32:				; CODE XREF: sub_413DE8+3Cj
					; DATA XREF: .rdata:off_42C278o
		mov	eax, [ebp+arg_0] ; jumptable 00413E24 case 2
		mov	dword ptr [eax+24h], 4
		jmp	short loc_413E85
; ---------------------------------------------------------------------------

loc_413E3E:				; CODE XREF: sub_413DE8+3Cj
					; DATA XREF: .rdata:off_42C278o
		mov	eax, [ebp+arg_0] ; jumptable 00413E24 case 3
		mov	dword ptr [eax+24h], 8
		jmp	short loc_413E85
; ---------------------------------------------------------------------------

loc_413E4A:				; CODE XREF: sub_413DE8+3Cj
					; DATA XREF: .rdata:off_42C278o
		mov	eax, [ebp+arg_0] ; jumptable 00413E24 case 4
		mov	dword ptr [eax+24h], 0Ah
		jmp	short loc_413E85
; ---------------------------------------------------------------------------

loc_413E56:				; CODE XREF: sub_413DE8+3Cj
					; DATA XREF: .rdata:off_42C278o
		mov	eax, [ebp+arg_0] ; jumptable 00413E24 case 5
		mov	dword ptr [eax+24h], 0Fh
		jmp	short loc_413E85
; ---------------------------------------------------------------------------

loc_413E62:				; CODE XREF: sub_413DE8+3Cj
					; DATA XREF: .rdata:off_42C278o
		mov	eax, [ebp+arg_0] ; jumptable 00413E24 case 6
		mov	dword ptr [eax+24h], 11h
		jmp	short loc_413E85
; ---------------------------------------------------------------------------

loc_413E6E:				; CODE XREF: sub_413DE8+3Cj
					; DATA XREF: .rdata:off_42C278o
		mov	eax, [ebp+arg_0] ; jumptable 00413E24 case 7
		mov	dword ptr [eax+24h], 12h
		jmp	short loc_413E85
; ---------------------------------------------------------------------------

loc_413E7A:				; CODE XREF: sub_413DE8+33j
					; sub_413DE8+3Cj
					; DATA XREF: ...
		mov	eax, [ebp+arg_0] ; jumptable 00413E24 default case
		mov	dword ptr [eax+24h], 6
		nop

loc_413E85:				; CODE XREF: sub_413DE8+48j
					; sub_413DE8+54j ...
		jmp	loc_413FE7	; jumptable 00413E01 default case
; ---------------------------------------------------------------------------

loc_413E8A:				; CODE XREF: sub_413DE8+19j
					; DATA XREF: .rdata:off_42C22Co
		mov	eax, [ebp+arg_0] ; jumptable 00413E01 cases 2-5
		mov	eax, [eax+10h]
		cmp	eax, 7		; switch 8 cases
		ja	short loc_413EF2 ; jumptable 00413E9C default case
		mov	eax, ds:off_42C298[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_413E9E:				; CODE XREF: sub_413DE8+B4j
					; DATA XREF: .rdata:off_42C298o
		mov	eax, [ebp+arg_0] ; jumptable 00413E9C case 1
		mov	dword ptr [eax+24h], 3
		jmp	short loc_413EFD
; ---------------------------------------------------------------------------

loc_413EAA:				; CODE XREF: sub_413DE8+B4j
					; DATA XREF: .rdata:off_42C298o
		mov	eax, [ebp+arg_0] ; jumptable 00413E9C case 2
		mov	dword ptr [eax+24h], 5
		jmp	short loc_413EFD
; ---------------------------------------------------------------------------

loc_413EB6:				; CODE XREF: sub_413DE8+B4j
					; DATA XREF: .rdata:off_42C298o
		mov	eax, [ebp+arg_0] ; jumptable 00413E9C case 3
		mov	dword ptr [eax+24h], 9
		jmp	short loc_413EFD
; ---------------------------------------------------------------------------

loc_413EC2:				; CODE XREF: sub_413DE8+B4j
					; DATA XREF: .rdata:off_42C298o
		mov	eax, [ebp+arg_0] ; jumptable 00413E9C case 4
		mov	dword ptr [eax+24h], 0Bh
		jmp	short loc_413EFD
; ---------------------------------------------------------------------------

loc_413ECE:				; CODE XREF: sub_413DE8+B4j
					; DATA XREF: .rdata:off_42C298o
		mov	eax, [ebp+arg_0] ; jumptable 00413E9C case 5
		mov	dword ptr [eax+24h], 10h
		jmp	short loc_413EFD
; ---------------------------------------------------------------------------

loc_413EDA:				; CODE XREF: sub_413DE8+B4j
					; DATA XREF: .rdata:off_42C298o
		mov	eax, [ebp+arg_0] ; jumptable 00413E9C case 6
		mov	dword ptr [eax+24h], 11h
		jmp	short loc_413EFD
; ---------------------------------------------------------------------------

loc_413EE6:				; CODE XREF: sub_413DE8+B4j
					; DATA XREF: .rdata:off_42C298o
		mov	eax, [ebp+arg_0] ; jumptable 00413E9C case 7
		mov	dword ptr [eax+24h], 12h
		jmp	short loc_413EFD
; ---------------------------------------------------------------------------

loc_413EF2:				; CODE XREF: sub_413DE8+ABj
					; sub_413DE8+B4j
					; DATA XREF: ...
		mov	eax, [ebp+arg_0] ; jumptable 00413E9C default case
		mov	dword ptr [eax+24h], 7
		nop

loc_413EFD:				; CODE XREF: sub_413DE8+C0j
					; sub_413DE8+CCj ...
		jmp	loc_413FE7	; jumptable 00413E01 default case
; ---------------------------------------------------------------------------

loc_413F02:				; CODE XREF: sub_413DE8+19j
					; DATA XREF: .rdata:off_42C22Co
		mov	eax, [ebp+arg_0] ; jumptable 00413E01 cases 6-13
		mov	eax, [eax+10h]
		cmp	eax, 3
		jz	short loc_413F1E
		cmp	eax, 8
		jnz	short loc_413F2A
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0Dh
		jmp	short loc_413F35
; ---------------------------------------------------------------------------

loc_413F1E:				; CODE XREF: sub_413DE8+123j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0Ch
		jmp	short loc_413F35
; ---------------------------------------------------------------------------

loc_413F2A:				; CODE XREF: sub_413DE8+128j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0Ch
		nop

loc_413F35:				; CODE XREF: sub_413DE8+134j
					; sub_413DE8+140j
		jmp	loc_413FE7	; jumptable 00413E01 default case
; ---------------------------------------------------------------------------

loc_413F3A:				; CODE XREF: sub_413DE8+19j
					; DATA XREF: .rdata:off_42C22Co
		mov	eax, [ebp+arg_0] ; jumptable 00413E01 case 14
		mov	dword ptr [eax+24h], 6
		jmp	loc_413FE7	; jumptable 00413E01 default case
; ---------------------------------------------------------------------------

loc_413F49:				; CODE XREF: sub_413DE8+19j
					; DATA XREF: .rdata:off_42C22Co
		mov	eax, [ebp+arg_0] ; jumptable 00413E01 case 15
		mov	dword ptr [eax+24h], 0Eh
		jmp	loc_413FE7	; jumptable 00413E01 default case
; ---------------------------------------------------------------------------

loc_413F58:				; CODE XREF: sub_413DE8+19j
					; DATA XREF: .rdata:off_42C22Co
		mov	eax, [ebp+arg_0] ; jumptable 00413E01 case 16
		mov	dword ptr [eax+24h], 13h
		jmp	loc_413FE7	; jumptable 00413E01 default case
; ---------------------------------------------------------------------------

loc_413F67:				; CODE XREF: sub_413DE8+19j
					; DATA XREF: .rdata:off_42C22Co
		mov	eax, [ebp+arg_0] ; jumptable 00413E01 case 17
		mov	dword ptr [eax+24h], 0Eh
		jmp	short loc_413FE7 ; jumptable 00413E01 default case
; ---------------------------------------------------------------------------

loc_413F73:				; CODE XREF: sub_413DE8+19j
					; DATA XREF: .rdata:off_42C22Co
		mov	eax, [ebp+arg_0] ; jumptable 00413E01 case 18
		mov	eax, [eax+10h]
		cmp	eax, 7		; switch 8 cases
		ja	short loc_413FDB ; jumptable 00413F85 default case
		mov	eax, ds:off_42C2B8[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_413F87:				; CODE XREF: sub_413DE8+19Dj
					; DATA XREF: .rdata:off_42C2B8o
		mov	eax, [ebp+arg_0] ; jumptable 00413F85 case 1
		mov	dword ptr [eax+24h], 15h
		jmp	short loc_413FE6
; ---------------------------------------------------------------------------

loc_413F93:				; CODE XREF: sub_413DE8+19Dj
					; DATA XREF: .rdata:off_42C2B8o
		mov	eax, [ebp+arg_0] ; jumptable 00413F85 case 2
		mov	dword ptr [eax+24h], 16h
		jmp	short loc_413FE6
; ---------------------------------------------------------------------------

loc_413F9F:				; CODE XREF: sub_413DE8+19Dj
					; DATA XREF: .rdata:off_42C2B8o
		mov	eax, [ebp+arg_0] ; jumptable 00413F85 case 3
		mov	dword ptr [eax+24h], 18h
		jmp	short loc_413FE6
; ---------------------------------------------------------------------------

loc_413FAB:				; CODE XREF: sub_413DE8+19Dj
					; DATA XREF: .rdata:off_42C2B8o
		mov	eax, [ebp+arg_0] ; jumptable 00413F85 case 4
		mov	dword ptr [eax+24h], 19h
		jmp	short loc_413FE6
; ---------------------------------------------------------------------------

loc_413FB7:				; CODE XREF: sub_413DE8+19Dj
					; DATA XREF: .rdata:off_42C2B8o
		mov	eax, [ebp+arg_0] ; jumptable 00413F85 case 5
		mov	dword ptr [eax+24h], 1Ah
		jmp	short loc_413FE6
; ---------------------------------------------------------------------------

loc_413FC3:				; CODE XREF: sub_413DE8+19Dj
					; DATA XREF: .rdata:off_42C2B8o
		mov	eax, [ebp+arg_0] ; jumptable 00413F85 case 6
		mov	dword ptr [eax+24h], 1Bh
		jmp	short loc_413FE6
; ---------------------------------------------------------------------------

loc_413FCF:				; CODE XREF: sub_413DE8+19Dj
					; DATA XREF: .rdata:off_42C2B8o
		mov	eax, [ebp+arg_0] ; jumptable 00413F85 case 7
		mov	dword ptr [eax+24h], 1Ch
		jmp	short loc_413FE6
; ---------------------------------------------------------------------------

loc_413FDB:				; CODE XREF: sub_413DE8+194j
					; sub_413DE8+19Dj
					; DATA XREF: ...
		mov	eax, [ebp+arg_0] ; jumptable 00413F85 default case
		mov	dword ptr [eax+24h], 17h
		nop

loc_413FE6:				; CODE XREF: sub_413DE8+1A9j
					; sub_413DE8+1B5j ...
		nop

loc_413FE7:				; CODE XREF: sub_413DE8+Cj
					; sub_413DE8+25j ...
		pop	ebp		; jumptable 00413E01 default case
		retn
sub_413DE8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413FE9	proc near		; CODE XREF: sub_415E33+58p

NumOfElements	= dword	ptr -68h
SizeOfElements	= dword	ptr -64h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Memory		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+Memory], eax
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_0], 0
		jnz	loc_4146ED
		jmp	loc_41472C
; ---------------------------------------------------------------------------

loc_41400D:				; CODE XREF: sub_413FE9+70Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_4146E3
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_414713
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	loc_4146E6
		mov	[ebp+var_2C], 0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jle	loc_4140D9
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4140D9
		mov	eax, [ebp+var_C]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_2C], eax
		add	[ebp+var_C], 1
		jmp	short loc_41409E
; ---------------------------------------------------------------------------

loc_41407B:				; CODE XREF: sub_413FE9+C7j
		mov	edx, [ebp+var_2C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_2C], eax
		add	[ebp+var_C], 1

loc_41409E:				; CODE XREF: sub_413FE9+90j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4140B2
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41407B

loc_4140B2:				; CODE XREF: sub_413FE9+BDj
		cmp	[ebp+var_2C], 0
		js	loc_414716
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	short loc_4140CC
		add	[ebp+var_C], 1
		jmp	short loc_4140D9
; ---------------------------------------------------------------------------

loc_4140CC:				; CODE XREF: sub_413FE9+DBj
		mov	[ebp+var_2C], 0
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_C], eax

loc_4140D9:				; CODE XREF: sub_413FE9+67j
					; sub_413FE9+75j ...
		mov	[ebp+var_18], 0
		jmp	short loc_414123
; ---------------------------------------------------------------------------

loc_4140E2:				; CODE XREF: sub_413FE9+142j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 20h	; switch 17 cases
		cmp	eax, 10h
		ja	short loc_41412F ; jumptable 004140FA default case
		mov	eax, ds:off_42C2D8[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4140FC:				; CODE XREF: sub_413FE9+111j
					; DATA XREF: .rdata:off_42C2D8o
		or	[ebp+var_18], 1	; jumptable 004140FA case 39
		jmp	short loc_41411F
; ---------------------------------------------------------------------------

loc_414102:				; CODE XREF: sub_413FE9+111j
					; DATA XREF: .rdata:off_42C2D8o
		or	[ebp+var_18], 2	; jumptable 004140FA case 45
		jmp	short loc_41411F
; ---------------------------------------------------------------------------

loc_414108:				; CODE XREF: sub_413FE9+111j
					; DATA XREF: .rdata:off_42C2D8o
		or	[ebp+var_18], 4	; jumptable 004140FA case 43
		jmp	short loc_41411F
; ---------------------------------------------------------------------------

loc_41410E:				; CODE XREF: sub_413FE9+111j
					; DATA XREF: .rdata:off_42C2D8o
		or	[ebp+var_18], 8	; jumptable 004140FA case 32
		jmp	short loc_41411F
; ---------------------------------------------------------------------------

loc_414114:				; CODE XREF: sub_413FE9+111j
					; DATA XREF: .rdata:off_42C2D8o
		or	[ebp+var_18], 10h ; jumptable 004140FA case 35
		jmp	short loc_41411F
; ---------------------------------------------------------------------------

loc_41411A:				; CODE XREF: sub_413FE9+111j
					; DATA XREF: .rdata:off_42C2D8o
		or	[ebp+var_18], 20h ; jumptable 004140FA case 48
		nop

loc_41411F:				; CODE XREF: sub_413FE9+117j
					; sub_413FE9+11Dj ...
		add	[ebp+var_C], 1

loc_414123:				; CODE XREF: sub_413FE9+F7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4140E2
		jmp	short loc_414130
; ---------------------------------------------------------------------------

loc_41412F:				; CODE XREF: sub_413FE9+108j
					; sub_413FE9+111j
					; DATA XREF: ...
		nop			; jumptable 004140FA default case

loc_414130:				; CODE XREF: sub_413FE9+144j
		mov	[ebp+var_30], 0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	loc_4141E3
		mov	[ebp+var_1C], 0FFFFFFFEh
		add	[ebp+var_C], 1
		cmp	[ebp+var_2C], 0
		jz	loc_414269
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jle	loc_414269
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	loc_414269
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_30], eax
		add	[ebp+var_C], 1
		jmp	short loc_4141AE
; ---------------------------------------------------------------------------

loc_41418B:				; CODE XREF: sub_413FE9+1D7j
		mov	edx, [ebp+var_30]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_30], eax
		add	[ebp+var_C], 1

loc_4141AE:				; CODE XREF: sub_413FE9+1A0j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4141C2
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41418B

loc_4141C2:				; CODE XREF: sub_413FE9+1CDj
		cmp	[ebp+var_30], 0
		jle	loc_414719
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	loc_41471C
		add	[ebp+var_C], 1
		jmp	loc_414269
; ---------------------------------------------------------------------------

loc_4141E3:				; CODE XREF: sub_413FE9+156j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_414262
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_414262
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_1C], eax
		add	[ebp+var_C], 1
		jmp	short loc_414243
; ---------------------------------------------------------------------------

loc_41420C:				; CODE XREF: sub_413FE9+26Cj
		cmp	[ebp+var_1C], 0
		jnz	short loc_414220
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	loc_41471F

loc_414220:				; CODE XREF: sub_413FE9+227j
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_1C], eax
		add	[ebp+var_C], 1

loc_414243:				; CODE XREF: sub_413FE9+221j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_414257
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41420C

loc_414257:				; CODE XREF: sub_413FE9+262j
		cmp	[ebp+var_1C], 0
		jns	short loc_414269
		jmp	loc_41472C
; ---------------------------------------------------------------------------

loc_414262:				; CODE XREF: sub_413FE9+202j
					; sub_413FE9+20Cj
		mov	[ebp+var_1C], 0FFFFFFFFh

loc_414269:				; CODE XREF: sub_413FE9+16Bj
					; sub_413FE9+179j ...
		mov	[ebp+var_34], 0
		mov	[ebp+var_20], 0FFFFFFFFh
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Eh
		jnz	loc_4143DC
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		setz	al
		movzx	eax, al
		mov	[ebp+var_40], eax
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	loc_414349
		mov	[ebp+var_20], 0FFFFFFFEh
		add	[ebp+var_C], 1
		cmp	[ebp+var_2C], 0
		jz	loc_4143CF
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jle	loc_4143CF
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	loc_4143CF
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_34], eax
		add	[ebp+var_C], 1
		jmp	short loc_414314
; ---------------------------------------------------------------------------

loc_4142F1:				; CODE XREF: sub_413FE9+33Dj
		mov	edx, [ebp+var_34]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_34], eax
		add	[ebp+var_C], 1

loc_414314:				; CODE XREF: sub_413FE9+306j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_414328
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_4142F1

loc_414328:				; CODE XREF: sub_413FE9+333j
		cmp	[ebp+var_34], 0
		jle	loc_414722
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	loc_414725
		add	[ebp+var_C], 1
		jmp	loc_4143CF
; ---------------------------------------------------------------------------

loc_414349:				; CODE XREF: sub_413FE9+2BCj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4143C8
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4143C8
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_20], eax
		add	[ebp+var_C], 1
		jmp	short loc_4143A9
; ---------------------------------------------------------------------------

loc_414372:				; CODE XREF: sub_413FE9+3D2j
		cmp	[ebp+var_20], 0
		jnz	short loc_414386
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	loc_414728

loc_414386:				; CODE XREF: sub_413FE9+38Dj
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_20], eax
		add	[ebp+var_C], 1

loc_4143A9:				; CODE XREF: sub_413FE9+387j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4143BD
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_414372

loc_4143BD:				; CODE XREF: sub_413FE9+3C8j
		cmp	[ebp+var_20], 0
		jns	short loc_4143CF
		jmp	loc_41472C
; ---------------------------------------------------------------------------

loc_4143C8:				; CODE XREF: sub_413FE9+368j
					; sub_413FE9+372j
		mov	[ebp+var_20], 0

loc_4143CF:				; CODE XREF: sub_413FE9+2D1j
					; sub_413FE9+2DFj ...
		cmp	[ebp+var_40], 0
		jz	short loc_4143DC
		mov	[ebp+var_20], 0FFFFFFFFh

loc_4143DC:				; CODE XREF: sub_413FE9+296j
					; sub_413FE9+3EAj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 4Ch	; switch 47 cases
		cmp	eax, 2Eh
		ja	loc_41447C	; jumptable 004143F8 default case
		mov	eax, ds:off_42C31C[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4143FA:				; CODE XREF: sub_413FE9+40Fj
					; DATA XREF: .rdata:off_42C31Co
		mov	eax, [ebp+var_C] ; jumptable 004143F8 case 104
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 68h
		jnz	short loc_414414
		mov	[ebp+var_24], 1
		add	[ebp+var_C], 1
		jmp	short loc_41441B
; ---------------------------------------------------------------------------

loc_414414:				; CODE XREF: sub_413FE9+41Cj
		mov	[ebp+var_24], 2

loc_41441B:				; CODE XREF: sub_413FE9+429j
		add	[ebp+var_C], 1
		jmp	short loc_414484
; ---------------------------------------------------------------------------

loc_414421:				; CODE XREF: sub_413FE9+40Fj
					; DATA XREF: .rdata:off_42C31Co
		mov	eax, [ebp+var_C] ; jumptable 004143F8 case 108
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 6Ch
		jnz	short loc_41443B
		mov	[ebp+var_24], 4
		add	[ebp+var_C], 1
		jmp	short loc_414442
; ---------------------------------------------------------------------------

loc_41443B:				; CODE XREF: sub_413FE9+443j
		mov	[ebp+var_24], 3

loc_414442:				; CODE XREF: sub_413FE9+450j
		add	[ebp+var_C], 1
		jmp	short loc_414484
; ---------------------------------------------------------------------------

loc_414448:				; CODE XREF: sub_413FE9+40Fj
					; DATA XREF: .rdata:off_42C31Co
		mov	[ebp+var_24], 5	; jumptable 004143F8 case 106
		add	[ebp+var_C], 1
		jmp	short loc_414484
; ---------------------------------------------------------------------------

loc_414455:				; CODE XREF: sub_413FE9+40Fj
					; DATA XREF: .rdata:off_42C31Co
		mov	[ebp+var_24], 6	; jumptable 004143F8 case 122
		add	[ebp+var_C], 1
		jmp	short loc_414484
; ---------------------------------------------------------------------------

loc_414462:				; CODE XREF: sub_413FE9+40Fj
					; DATA XREF: .rdata:off_42C31Co
		mov	[ebp+var_24], 7	; jumptable 004143F8 case 116
		add	[ebp+var_C], 1
		jmp	short loc_414484
; ---------------------------------------------------------------------------

loc_41446F:				; CODE XREF: sub_413FE9+40Fj
					; DATA XREF: .rdata:off_42C31Co
		mov	[ebp+var_24], 8	; jumptable 004143F8 case 76
		add	[ebp+var_C], 1
		jmp	short loc_414484
; ---------------------------------------------------------------------------

loc_41447C:				; CODE XREF: sub_413FE9+402j
					; sub_413FE9+40Fj
					; DATA XREF: ...
		mov	[ebp+var_24], 0	; jumptable 004143F8 default case
		nop

loc_414484:				; CODE XREF: sub_413FE9+436j
					; sub_413FE9+45Dj ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 41h	; switch 56 cases
		cmp	eax, 37h
		ja	loc_414583	; jumptable 004144A0 default case
		mov	eax, ds:off_42C3D8[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4144A2:				; CODE XREF: sub_413FE9+4B7j
					; DATA XREF: .rdata:off_42C3D8o
		mov	[ebp+var_28], 1	; jumptable 004144A0 cases 100,105
		jmp	loc_41458A
; ---------------------------------------------------------------------------

loc_4144AE:				; CODE XREF: sub_413FE9+4B7j
					; DATA XREF: .rdata:off_42C3D8o
		mov	[ebp+var_28], 2	; jumptable 004144A0 case 111
		jmp	loc_41458A
; ---------------------------------------------------------------------------

loc_4144BA:				; CODE XREF: sub_413FE9+4B7j
					; DATA XREF: .rdata:off_42C3D8o
		mov	[ebp+var_28], 3	; jumptable 004144A0 case 117
		jmp	loc_41458A
; ---------------------------------------------------------------------------

loc_4144C6:				; CODE XREF: sub_413FE9+4B7j
					; DATA XREF: .rdata:off_42C3D8o
		mov	[ebp+var_28], 4	; jumptable 004144A0 case 120
		jmp	loc_41458A
; ---------------------------------------------------------------------------

loc_4144D2:				; CODE XREF: sub_413FE9+4B7j
					; DATA XREF: .rdata:off_42C3D8o
		mov	[ebp+var_28], 5	; jumptable 004144A0 case 88
		jmp	loc_41458A
; ---------------------------------------------------------------------------

loc_4144DE:				; CODE XREF: sub_413FE9+4B7j
					; DATA XREF: .rdata:off_42C3D8o
		mov	[ebp+var_28], 6	; jumptable 004144A0 case 102
		jmp	loc_41458A
; ---------------------------------------------------------------------------

loc_4144EA:				; CODE XREF: sub_413FE9+4B7j
					; DATA XREF: .rdata:off_42C3D8o
		mov	[ebp+var_28], 7	; jumptable 004144A0 case 70
		jmp	loc_41458A
; ---------------------------------------------------------------------------

loc_4144F6:				; CODE XREF: sub_413FE9+4B7j
					; DATA XREF: .rdata:off_42C3D8o
		mov	[ebp+var_28], 8	; jumptable 004144A0 case 101
		jmp	loc_41458A
; ---------------------------------------------------------------------------

loc_414502:				; CODE XREF: sub_413FE9+4B7j
					; DATA XREF: .rdata:off_42C3D8o
		mov	[ebp+var_28], 9	; jumptable 004144A0 case 69
		jmp	short loc_41458A
; ---------------------------------------------------------------------------

loc_41450B:				; CODE XREF: sub_413FE9+4B7j
					; DATA XREF: .rdata:off_42C3D8o
		mov	[ebp+var_28], 0Ah ; jumptable 004144A0 case 103
		jmp	short loc_41458A
; ---------------------------------------------------------------------------

loc_414514:				; CODE XREF: sub_413FE9+4B7j
					; DATA XREF: .rdata:off_42C3D8o
		mov	[ebp+var_28], 0Bh ; jumptable 004144A0 case 71
		jmp	short loc_41458A
; ---------------------------------------------------------------------------

loc_41451D:				; CODE XREF: sub_413FE9+4B7j
					; DATA XREF: .rdata:off_42C3D8o
		mov	[ebp+var_28], 0Ch ; jumptable 004144A0 case 97
		jmp	short loc_41458A
; ---------------------------------------------------------------------------

loc_414526:				; CODE XREF: sub_413FE9+4B7j
					; DATA XREF: .rdata:off_42C3D8o
		mov	[ebp+var_28], 0Dh ; jumptable 004144A0 case 65
		jmp	short loc_41458A
; ---------------------------------------------------------------------------

loc_41452F:				; CODE XREF: sub_413FE9+4B7j
					; DATA XREF: .rdata:off_42C3D8o
		mov	[ebp+var_28], 0Eh ; jumptable 004144A0 case 99
		jmp	short loc_41458A
; ---------------------------------------------------------------------------

loc_414538:				; CODE XREF: sub_413FE9+4B7j
					; DATA XREF: .rdata:off_42C3D8o
		mov	[ebp+var_28], 0Fh ; jumptable 004144A0 case 115
		jmp	short loc_41458A
; ---------------------------------------------------------------------------

loc_414541:				; CODE XREF: sub_413FE9+4B7j
					; DATA XREF: .rdata:off_42C3D8o
		mov	[ebp+var_28], 10h ; jumptable 004144A0 case 112
		jmp	short loc_41458A
; ---------------------------------------------------------------------------

loc_41454A:				; CODE XREF: sub_413FE9+4B7j
					; DATA XREF: .rdata:off_42C3D8o
		mov	[ebp+var_28], 12h ; jumptable 004144A0 case 110
		jmp	short loc_41458A
; ---------------------------------------------------------------------------

loc_414553:				; CODE XREF: sub_413FE9+4B7j
					; DATA XREF: .rdata:off_42C3D8o
		mov	[ebp+var_28], 0Eh ; jumptable 004144A0 case 67
		mov	[ebp+var_24], 3
		jmp	short loc_41458A
; ---------------------------------------------------------------------------

loc_414563:				; CODE XREF: sub_413FE9+4B7j
					; DATA XREF: .rdata:off_42C3D8o
		mov	[ebp+var_28], 0Fh ; jumptable 004144A0 case 83
		mov	[ebp+var_24], 3
		jmp	short loc_41458A
; ---------------------------------------------------------------------------

loc_414573:				; CODE XREF: sub_413FE9+4B7j
					; DATA XREF: .rdata:off_42C3D8o
		mov	[ebp+var_28], 11h ; jumptable 004144A0 case 109
		mov	[ebp+var_2C], 0FFFFFFFFh
		jmp	short loc_41458A
; ---------------------------------------------------------------------------

loc_414583:				; CODE XREF: sub_413FE9+4AAj
					; sub_413FE9+4B7j
					; DATA XREF: ...
		mov	[ebp+var_28], 0	; jumptable 004144A0 default case

loc_41458A:				; CODE XREF: sub_413FE9+4C0j
					; sub_413FE9+4CCj ...
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_8]
		jb	loc_41465B
		mov	eax, [ebp+arg_8]
		add	eax, 0Ah
		mov	[ebp+var_44], eax
		mov	eax, [ebp+var_44]
		cmp	eax, [ebp+arg_8]
		jbe	loc_41472B
		mov	[esp+68h+SizeOfElements], 28h ;	SizeOfElements
		mov	eax, [ebp+var_44]
		mov	[esp+68h+NumOfElements], eax ; NumOfElements
		call	calloc
		mov	[ebp+var_48], eax
		cmp	[ebp+var_48], 0
		jz	loc_41473B
		mov	[ebp+var_38], 0
		jmp	short loc_414632
; ---------------------------------------------------------------------------

loc_4145D4:				; CODE XREF: sub_413FE9+64Fj
		mov	edx, [ebp+var_38]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+var_48]
		mov	ecx, [ebp+var_38]
		mov	edx, ecx
		shl	edx, 2
		add	edx, ecx
		shl	edx, 3
		add	edx, [ebp+Memory]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	ecx, [edx+10h]
		mov	[eax+10h], ecx
		mov	ecx, [edx+14h]
		mov	[eax+14h], ecx
		mov	ecx, [edx+18h]
		mov	[eax+18h], ecx
		mov	ecx, [edx+1Ch]
		mov	[eax+1Ch], ecx
		mov	ecx, [edx+20h]
		mov	[eax+20h], ecx
		mov	edx, [edx+24h]
		mov	[eax+24h], edx
		add	[ebp+var_38], 1

loc_414632:				; CODE XREF: sub_413FE9+5E9j
		mov	eax, [ebp+var_38]
		cmp	eax, [ebp+var_14]
		jb	short loc_4145D4
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		cmp	eax, [ebp+Memory]
		jz	short loc_41464F
		mov	eax, [ebp+Memory]
		mov	[esp+68h+NumOfElements], eax ; Memory
		call	free

loc_41464F:				; CODE XREF: sub_413FE9+659j
		mov	eax, [ebp+var_48]
		mov	[ebp+Memory], eax
		mov	eax, [ebp+var_44]
		mov	[ebp+arg_8], eax

loc_41465B:				; CODE XREF: sub_413FE9+5A7j
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	[ebp+var_4C], eax
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 2
		mov	edx, eax
		mov	eax, [ebp+var_4C]
		mov	[eax], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_1C]
		mov	[eax+8], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_20]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_24]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_28]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_2C]
		mov	[eax+18h], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_30]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_34]
		mov	[eax+20h], edx
		mov	eax, [ebp+var_4C]
		mov	[esp+68h+NumOfElements], eax
		call	sub_413DE8
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_0], eax
		jmp	short loc_4146E7
; ---------------------------------------------------------------------------

loc_4146E3:				; CODE XREF: sub_413FE9+2Cj
		nop
		jmp	short loc_4146E7
; ---------------------------------------------------------------------------

loc_4146E6:				; CODE XREF: sub_413FE9+52j
		nop

loc_4146E7:				; CODE XREF: sub_413FE9+6F8j
					; sub_413FE9+6FBj
		add	[ebp+arg_0], 1
		jmp	short loc_4146EE
; ---------------------------------------------------------------------------

loc_4146ED:				; CODE XREF: sub_413FE9+19j
		nop

loc_4146EE:				; CODE XREF: sub_413FE9+702j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_41400D
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+Memory]
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, 0
		jmp	short locret_41475F
; ---------------------------------------------------------------------------

loc_414713:				; CODE XREF: sub_413FE9+44j
		nop
		jmp	short loc_41472C
; ---------------------------------------------------------------------------

loc_414716:				; CODE XREF: sub_413FE9+CDj
		nop
		jmp	short loc_41472C
; ---------------------------------------------------------------------------

loc_414719:				; CODE XREF: sub_413FE9+1DDj
		nop
		jmp	short loc_41472C
; ---------------------------------------------------------------------------

loc_41471C:				; CODE XREF: sub_413FE9+1EBj
		nop
		jmp	short loc_41472C
; ---------------------------------------------------------------------------

loc_41471F:				; CODE XREF: sub_413FE9+231j
		nop
		jmp	short loc_41472C
; ---------------------------------------------------------------------------

loc_414722:				; CODE XREF: sub_413FE9+343j
		nop
		jmp	short loc_41472C
; ---------------------------------------------------------------------------

loc_414725:				; CODE XREF: sub_413FE9+351j
		nop
		jmp	short loc_41472C
; ---------------------------------------------------------------------------

loc_414728:				; CODE XREF: sub_413FE9+397j
		nop
		jmp	short loc_41472C
; ---------------------------------------------------------------------------

loc_41472B:				; CODE XREF: sub_413FE9+5BCj
		nop

loc_41472C:				; CODE XREF: sub_413FE9+1Fj
					; sub_413FE9+274j ...
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		jmp	short loc_41473C
; ---------------------------------------------------------------------------

loc_41473B:				; CODE XREF: sub_413FE9+5DCj
		nop

loc_41473C:				; CODE XREF: sub_413FE9+750j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		cmp	eax, [ebp+Memory]
		jz	short loc_414751
		mov	eax, [ebp+Memory]
		mov	[esp+68h+NumOfElements], eax ; Memory
		call	free

loc_414751:				; CODE XREF: sub_413FE9+75Bj
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh

locret_41475F:				; CODE XREF: sub_413FE9+728j
		leave
		retn
sub_413FE9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414761	proc near		; CODE XREF: sub_415E33+502p

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	[ebp+var_C], 0
		jmp	loc_414A28
; ---------------------------------------------------------------------------

loc_414774:				; CODE XREF: sub_414761+2CDj
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_0]
		add	eax, 8
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 1Ch ; switch 29 cases
		ja	loc_414A1D	; jumptable 004147B4 default case
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	eax, offset off_42C4B8
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4147B6:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 1
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		jmp	loc_414A24
; ---------------------------------------------------------------------------

loc_4147CD:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 20
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_414A24
; ---------------------------------------------------------------------------

loc_4147E2:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 2
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		jmp	loc_414A24
; ---------------------------------------------------------------------------

loc_4147F9:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 21
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_414A24
; ---------------------------------------------------------------------------

loc_41480E:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 3
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		jmp	loc_414A24
; ---------------------------------------------------------------------------

loc_414825:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 4
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dx
		jmp	loc_414A24
; ---------------------------------------------------------------------------

loc_41483D:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 5
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dx
		jmp	loc_414A24
; ---------------------------------------------------------------------------

loc_414855:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 22
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_414A24
; ---------------------------------------------------------------------------

loc_41486A:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 6
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_414A24
; ---------------------------------------------------------------------------

loc_41487F:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 23
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_414A24
; ---------------------------------------------------------------------------

loc_414894:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 7
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_414A24
; ---------------------------------------------------------------------------

loc_4148A9:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 8
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_414A24
; ---------------------------------------------------------------------------

loc_4148BE:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 9
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_414A24
; ---------------------------------------------------------------------------

loc_4148D3:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 24
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_414A24
; ---------------------------------------------------------------------------

loc_4148E8:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 10
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	loc_414A24
; ---------------------------------------------------------------------------

loc_414903:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 11
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	loc_414A24
; ---------------------------------------------------------------------------

loc_41491E:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 25
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_414A24
; ---------------------------------------------------------------------------

loc_414933:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 12
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		fld	qword ptr [eax]
		mov	eax, [ebp+var_10]
		fstp	qword ptr [eax]
		jmp	loc_414A24
; ---------------------------------------------------------------------------

loc_414948:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 13
		lea	edx, [eax+0Ch]
		mov	[ebp+arg_8], edx
		mov	ecx, [eax+8]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ebx, [ebp+var_10]
		mov	[ebx], eax
		mov	[ebx+4], edx
		mov	[ebx+8], ecx
		jmp	loc_414A24
; ---------------------------------------------------------------------------

loc_414969:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 14
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_414A24
; ---------------------------------------------------------------------------

loc_41497E:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 19
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_414A24
; ---------------------------------------------------------------------------

loc_414993:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 15
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_414A24
; ---------------------------------------------------------------------------

loc_4149AB:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 26
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_414A24
; ---------------------------------------------------------------------------

loc_4149BD:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 16
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_414A24
; ---------------------------------------------------------------------------

loc_4149D5:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 17
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_414A24
; ---------------------------------------------------------------------------

loc_4149E7:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 27
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_414A24
; ---------------------------------------------------------------------------

loc_4149F9:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 18
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_414A24
; ---------------------------------------------------------------------------

loc_414A0B:				; CODE XREF: sub_414761+53j
					; DATA XREF: .rdata:off_42C4B8o
		mov	eax, [ebp+arg_8] ; jumptable 004147B4 case 28
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_414A24
; ---------------------------------------------------------------------------

loc_414A1D:				; CODE XREF: sub_414761+40j
					; sub_414761+53j
					; DATA XREF: ...
		mov	eax, 0FFFFFFFFh	; jumptable 004147B4 default case
		jmp	short loc_414A39
; ---------------------------------------------------------------------------

loc_414A24:				; CODE XREF: sub_414761+67j
					; sub_414761+7Cj ...
		add	[ebp+var_C], 1

loc_414A28:				; CODE XREF: sub_414761+Ej
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_4]
		jb	loc_414774
		mov	eax, 0

loc_414A39:				; CODE XREF: sub_414761+2C1j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_414761	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414A3F	proc near		; CODE XREF: sub_414ABD+4C6p
					; sub_414ABD+5BAp ...

Dst		= dword	ptr -48h
Val		= dword	ptr -44h
Size		= dword	ptr -40h
var_30		= byte ptr -30h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		jmp	short loc_414AB0
; ---------------------------------------------------------------------------

loc_414A47:				; CODE XREF: sub_414A3F+75j
		mov	eax, [ebp+arg_C]
		mov	edx, 20h
		cmp	eax, 20h
		cmova	eax, edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Size],	eax ; Size
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Val], eax ; Val
		lea	eax, [ebp+var_30]
		mov	[esp+48h+Dst], eax ; Dst
		call	memset
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Size],	eax
		lea	eax, [ebp+var_30]
		mov	[esp+48h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Dst], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_414A98
		mov	eax, [ebp+var_10]
		jmp	short locret_414ABB
; ---------------------------------------------------------------------------

loc_414A98:				; CODE XREF: sub_414A3F+52j
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		sub	eax, [ebp+var_C]
		mov	[ebp+arg_C], eax

loc_414AB0:				; CODE XREF: sub_414A3F+6j
		cmp	[ebp+arg_C], 0
		jg	short loc_414A47
		mov	eax, 0

locret_414ABB:				; CODE XREF: sub_414A3F+57j
		leave
		retn
sub_414A3F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414ABD	proc near		; CODE XREF: sub_415953+317p

var_D8		= dword	ptr -0D8h
var_D4		= dword	ptr -0D4h
var_D0		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A5		= byte ptr -0A5h
var_A4		= byte ptr -0A4h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0D4h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_B8], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_B4], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_B0], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_AC], eax
		mov	[ebp+var_A5], 0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 1
		jnz	loc_414BE4
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		sub	eax, 4		; switch 15 cases
		cmp	eax, 0Eh
		ja	loc_414BA4	; jumptable 00414B1A default case
		mov	eax, ds:off_42C558[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_414B1C:				; CODE XREF: sub_414ABD+5Dj
					; DATA XREF: .rdata:off_42C558o
		movzx	eax, word ptr [ebp+var_B8] ; jumptable 00414B1A	case 4
		cwde
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_414BAE
; ---------------------------------------------------------------------------

loc_414B31:				; CODE XREF: sub_414ABD+5Dj
					; DATA XREF: .rdata:off_42C558o
		mov	eax, [ebp+var_B8] ; jumptable 00414B1A case 6
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_414BAE
; ---------------------------------------------------------------------------

loc_414B44:				; CODE XREF: sub_414ABD+5Dj
					; DATA XREF: .rdata:off_42C558o
		mov	eax, [ebp+var_B8] ; jumptable 00414B1A case 8
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_414BAE
; ---------------------------------------------------------------------------

loc_414B57:				; CODE XREF: sub_414ABD+5Dj
					; DATA XREF: .rdata:off_42C558o
		mov	eax, [ebp+var_B8] ; jumptable 00414B1A case 10
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_414BAE
; ---------------------------------------------------------------------------

loc_414B6B:				; CODE XREF: sub_414ABD+5Dj
					; DATA XREF: .rdata:off_42C558o
		mov	eax, [ebp+var_B8] ; jumptable 00414B1A case 17
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], 0
		jmp	short loc_414BAE
; ---------------------------------------------------------------------------

loc_414B7D:				; CODE XREF: sub_414ABD+5Dj
					; DATA XREF: .rdata:off_42C558o
		mov	eax, [ebp+var_B8] ; jumptable 00414B1A case 15
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_414BAE
; ---------------------------------------------------------------------------

loc_414B91:				; CODE XREF: sub_414ABD+5Dj
					; DATA XREF: .rdata:off_42C558o
		mov	eax, [ebp+var_B8] ; jumptable 00414B1A case 18
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_414BAE
; ---------------------------------------------------------------------------

loc_414BA4:				; CODE XREF: sub_414ABD+50j
					; sub_414ABD+5Dj
					; DATA XREF: ...
		mov	eax, 0FFFFFFFFh	; jumptable 00414B1A default case
		jmp	loc_415147
; ---------------------------------------------------------------------------

loc_414BAE:				; CODE XREF: sub_414ABD+72j
					; sub_414ABD+85j ...
		cmp	[ebp+var_24], 0
		jns	short loc_414BD3
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_24]
		neg	eax
		adc	edx, 0
		neg	edx
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	[ebp+var_A5], 2Dh
		jmp	loc_414C90
; ---------------------------------------------------------------------------

loc_414BD3:				; CODE XREF: sub_414ABD+F5j
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	loc_414C90
; ---------------------------------------------------------------------------

loc_414BE4:				; CODE XREF: sub_414ABD+3Ej
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		sub	eax, 5		; switch 14 cases
		cmp	eax, 0Dh
		ja	loc_414C86	; jumptable 00414BFD default case
		mov	eax, ds:off_42C594[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_414BFF:				; CODE XREF: sub_414ABD+140j
					; DATA XREF: .rdata:off_42C594o
		movzx	eax, word ptr [ebp+var_B8] ; jumptable 00414BFD	case 5
		movzx	eax, ax
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_414C90
; ---------------------------------------------------------------------------

loc_414C15:				; CODE XREF: sub_414ABD+140j
					; DATA XREF: .rdata:off_42C594o
		mov	eax, [ebp+var_B8] ; jumptable 00414BFD case 7
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_414C90
; ---------------------------------------------------------------------------

loc_414C27:				; CODE XREF: sub_414ABD+140j
					; DATA XREF: .rdata:off_42C594o
		mov	eax, [ebp+var_B8] ; jumptable 00414BFD case 9
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_414C90
; ---------------------------------------------------------------------------

loc_414C39:				; CODE XREF: sub_414ABD+140j
					; DATA XREF: .rdata:off_42C594o
		mov	eax, [ebp+var_B8] ; jumptable 00414BFD case 11
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_414C90
; ---------------------------------------------------------------------------

loc_414C4D:				; CODE XREF: sub_414ABD+140j
					; DATA XREF: .rdata:off_42C594o
		mov	eax, [ebp+var_B8] ; jumptable 00414BFD case 17
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_414C90
; ---------------------------------------------------------------------------

loc_414C5F:				; CODE XREF: sub_414ABD+140j
					; DATA XREF: .rdata:off_42C594o
		mov	eax, [ebp+var_B8] ; jumptable 00414BFD case 16
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_414C90
; ---------------------------------------------------------------------------

loc_414C73:				; CODE XREF: sub_414ABD+140j
					; DATA XREF: .rdata:off_42C594o
		mov	eax, [ebp+var_B8] ; jumptable 00414BFD case 18
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_414C90
; ---------------------------------------------------------------------------

loc_414C86:				; CODE XREF: sub_414ABD+133j
					; sub_414ABD+140j
					; DATA XREF: ...
		mov	eax, 0FFFFFFFFh	; jumptable 00414BFD default case
		jmp	loc_415147
; ---------------------------------------------------------------------------

loc_414C90:				; CODE XREF: sub_414ABD+111j
					; sub_414ABD+122j ...
		movzx	eax, [ebp+var_A5]
		cmp	al, 2Dh
		jz	short loc_414CC5
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 4
		test	eax, eax
		jz	short loc_414CB1
		mov	[ebp+var_A5], 2Bh
		jmp	short loc_414CC5
; ---------------------------------------------------------------------------

loc_414CB1:				; CODE XREF: sub_414ABD+1E9j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 8
		test	eax, eax
		jz	short loc_414CC5
		mov	[ebp+var_A5], 20h

loc_414CC5:				; CODE XREF: sub_414ABD+1DCj
					; sub_414ABD+1F2j ...
		movzx	eax, [ebp+var_A5]
		test	al, al
		setnz	al
		movzx	eax, al
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+var_A4]
		add	eax, 64h
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	short loc_414D03
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_414E8F

loc_414D03:				; CODE XREF: sub_414ABD+236j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 1
		jz	short loc_414D1D
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jnz	loc_414DCF

loc_414D1D:				; CODE XREF: sub_414ABD+24Fj
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	[ebp+var_38], offset byte_42C52C

loc_414D2B:				; CODE XREF: sub_414ABD+307j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 1
		test	al, al
		jz	short loc_414D62
		add	[ebp+var_2C], 1
		cmp	[ebp+var_2C], 3
		jnz	short loc_414D62
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_414D62
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_38]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	[ebp+var_2C], 0

loc_414D62:				; CODE XREF: sub_414ABD+279j
					; sub_414ABD+283j ...
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[esp+0D8h+var_D0], 0Ah
		mov	[esp+0D8h+var_CC], 0
		mov	[esp+0D8h+var_D8], eax
		mov	[esp+0D8h+var_D4], edx
		call	sub_427320
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[esp+0D8h+var_D0], 0Ah
		mov	[esp+0D8h+var_CC], 0
		mov	[esp+0D8h+var_D8], eax
		mov	[esp+0D8h+var_D4], edx
		call	sub_427220
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	loc_414D2B
		jmp	loc_414E8F
; ---------------------------------------------------------------------------

loc_414DCF:				; CODE XREF: sub_414ABD+25Aj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 2
		jnz	short loc_414E30

loc_414DDA:				; CODE XREF: sub_414ABD+34Ej
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_10]
		and	eax, 7
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		shrd	eax, edx, 3
		shr	edx, 3
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	short loc_414DDA
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_414E8F
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	short loc_414E8F
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	30h
		jmp	short loc_414E8F
; ---------------------------------------------------------------------------

loc_414E30:				; CODE XREF: sub_414ABD+31Bj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 4
		jnz	short loc_414E42
		mov	eax, offset a0123456789abcd ; "0123456789abcdef"
		jmp	short loc_414E47
; ---------------------------------------------------------------------------

loc_414E42:				; CODE XREF: sub_414ABD+37Cj
		mov	eax, offset a0123456789ab_0 ; "0123456789ABCDEF"

loc_414E47:				; CODE XREF: sub_414ABD+383j
		mov	[ebp+var_34], eax

loc_414E4A:				; CODE XREF: sub_414ABD+3BFj
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_10]
		and	eax, 0Fh
		add	eax, [ebp+var_34]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		shrd	eax, edx, 4
		shr	edx, 4
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	short loc_414E4A
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_414E8F
		add	[ebp+var_1C], 2

loc_414E8F:				; CODE XREF: sub_414ABD+240j
					; sub_414ABD+30Dj ...
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 20h
		test	eax, eax
		jz	short loc_414EE8
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_414EE8
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_414EE8
		cmp	[ebp+var_3C], 0
		jz	short loc_414EE8
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_414EE8
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		sub	eax, [ebp+var_3C]
		mov	[ebp+var_18], eax
		jmp	short loc_414F12
; ---------------------------------------------------------------------------

loc_414EE8:				; CODE XREF: sub_414ABD+3ECj
					; sub_414ABD+3F7j ...
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jle	short loc_414F0B
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_414F0B
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		sub	eax, [ebp+var_3C]
		mov	[ebp+var_18], eax
		jmp	short loc_414F12
; ---------------------------------------------------------------------------

loc_414F0B:				; CODE XREF: sub_414ABD+433j
					; sub_414ABD+43Ej
		mov	[ebp+var_18], 0

loc_414F12:				; CODE XREF: sub_414ABD+429j
					; sub_414ABD+44Cj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_414F99
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_414F99
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_414F99
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		mov	edx, eax
		sub	edx, [ebp+var_3C]
		mov	eax, [ebp+var_18]
		cmp	edx, eax
		jb	short loc_414F99
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		mov	edx, eax
		sub	edx, [ebp+var_3C]
		mov	eax, [ebp+var_18]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	edx, [ebp+arg_1C]
		mov	[esp+0D8h+var_C8], edx
		mov	[esp+0D8h+var_CC], eax
		mov	[esp+0D8h+var_D0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+var_D8], eax
		call	sub_414A3F
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_414F99
		mov	eax, [ebp+var_40]
		jmp	loc_415147
; ---------------------------------------------------------------------------

loc_414F99:				; CODE XREF: sub_414ABD+460j
					; sub_414ABD+46Aj ...
		movzx	eax, [ebp+var_A5]
		test	al, al
		jz	short loc_414FDF
		mov	[esp+0D8h+var_D0], 1
		lea	eax, [ebp+var_A5]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_414FD2
		mov	eax, [ebp+var_40]
		jmp	loc_415147
; ---------------------------------------------------------------------------

loc_414FD2:				; CODE XREF: sub_414ABD+50Bj
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_414FDF:				; CODE XREF: sub_414ABD+4E5j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_41504E
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 4
		jz	short loc_415002
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 5
		jnz	short loc_41504E

loc_415002:				; CODE XREF: sub_414ABD+538j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 4
		jnz	short loc_415014
		mov	eax, offset a0x	; "0x"
		jmp	short loc_415019
; ---------------------------------------------------------------------------

loc_415014:				; CODE XREF: sub_414ABD+54Ej
		mov	eax, offset a0x_0 ; "0X"

loc_415019:				; CODE XREF: sub_414ABD+555j
		mov	[esp+0D8h+var_D0], 2
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_415041
		mov	eax, [ebp+var_40]
		jmp	loc_415147
; ---------------------------------------------------------------------------

loc_415041:				; CODE XREF: sub_414ABD+57Aj
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_41504E:				; CODE XREF: sub_414ABD+52Dj
					; sub_414ABD+543j
		cmp	[ebp+var_18], 0
		jz	short loc_41508D
		mov	eax, [ebp+arg_1C]
		mov	[esp+0D8h+var_C8], eax
		mov	eax, [ebp+var_18]
		mov	[esp+0D8h+var_CC], eax
		mov	[esp+0D8h+var_D0], 30h
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+var_D8], eax
		call	sub_414A3F
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_41508D
		mov	eax, [ebp+var_40]
		jmp	loc_415147
; ---------------------------------------------------------------------------

loc_41508D:				; CODE XREF: sub_414ABD+595j
					; sub_414ABD+5C6j
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[esp+0D8h+var_D0], eax
		mov	eax, [ebp+var_14]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_4150C0
		mov	eax, [ebp+var_40]
		jmp	loc_415147
; ---------------------------------------------------------------------------

loc_4150C0:				; CODE XREF: sub_414ABD+5F9j
		mov	eax, [ebp+arg_1C]
		mov	edx, [eax]
		mov	ecx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jz	short loc_415142
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_415142
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		sub	eax, [ebp+var_18]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_415142
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		sub	eax, [ebp+var_18]
		sub	eax, [ebp+var_3C]
		mov	edx, [ebp+arg_1C]
		mov	[esp+0D8h+var_C8], edx
		mov	[esp+0D8h+var_CC], eax
		mov	[esp+0D8h+var_D0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+var_D8], eax
		call	sub_414A3F
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_415142
		mov	eax, [ebp+var_40]
		jmp	short loc_415147
; ---------------------------------------------------------------------------

loc_415142:				; CODE XREF: sub_414ABD+626j
					; sub_414ABD+630j ...
		mov	eax, 0

loc_415147:				; CODE XREF: sub_414ABD+ECj
					; sub_414ABD+1CEj ...
		add	esp, 0D4h
		pop	ebx
		pop	ebp
		retn
sub_414ABD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415150	proc near		; CODE XREF: sub_415953+35Bp

Dest		= dword	ptr -1F8h
Format		= dword	ptr -1F4h
var_1F0		= qword	ptr -1F0h
var_1E8		= dword	ptr -1E8h
var_1D0		= dword	ptr -1D0h
var_1CC		= dword	ptr -1CCh
var_1C8		= qword	ptr -1C8h
var_1C0		= dword	ptr -1C0h
var_1BC		= dword	ptr -1BCh
var_1AF		= byte ptr -1AFh
var_1AE		= byte ptr -1AEh
var_19A		= byte ptr -19Ah
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= qword	ptr -28h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 1F0h
		mov	eax, [ebp+arg_C]
		mov	dword ptr [ebp+var_1C8], eax
		mov	eax, [ebp+arg_10]
		mov	dword ptr [ebp+var_1C8+4], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_1C0], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_1BC], eax
		mov	eax, 0
		mov	edx, 0
		mov	ecx, 0
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	[ebp+var_10], ecx
		mov	[ebp+var_1C], 0
		mov	[ebp+var_1AF], 0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 0Ch
		jz	short loc_4151B7
		cmp	eax, 0Dh
		jz	short loc_4151C2
		jmp	short loc_4151EB
; ---------------------------------------------------------------------------

loc_4151B7:				; CODE XREF: sub_415150+5Ej
		fld	[ebp+var_1C8]
		fstp	[ebp+var_28]
		jmp	short loc_4151F5
; ---------------------------------------------------------------------------

loc_4151C2:				; CODE XREF: sub_415150+63j
		fldz
		fstp	[ebp+var_28]
		mov	eax, dword ptr [ebp+var_1C8]
		mov	edx, dword ptr [ebp+var_1C8+4]
		mov	ecx, [ebp+var_1C0]
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	[ebp+var_10], ecx
		mov	[ebp+var_1C], 1
		jmp	short loc_4151F5
; ---------------------------------------------------------------------------

loc_4151EB:				; CODE XREF: sub_415150+65j
		mov	eax, 0FFFFFFFFh
		jmp	loc_41557B
; ---------------------------------------------------------------------------

loc_4151F5:				; CODE XREF: sub_415150+70j
					; sub_415150+99j
		lea	eax, [ebp+var_1AE]
		add	eax, 14h
		mov	[ebp+var_2C], eax
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		sub	eax, 6		; switch 8 cases
		cmp	eax, 7
		ja	short loc_415282 ; jumptable 00415220 default case
		mov	eax, ds:off_42C5CC[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_415222:				; CODE XREF: sub_415150+D0j
					; DATA XREF: .rdata:off_42C5CCo
		sub	[ebp+var_2C], 1	; jumptable 00415220 case 6
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	66h
		jmp	short loc_41528C
; ---------------------------------------------------------------------------

loc_41522E:				; CODE XREF: sub_415150+D0j
					; DATA XREF: .rdata:off_42C5CCo
		sub	[ebp+var_2C], 1	; jumptable 00415220 case 7
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	46h
		jmp	short loc_41528C
; ---------------------------------------------------------------------------

loc_41523A:				; CODE XREF: sub_415150+D0j
					; DATA XREF: .rdata:off_42C5CCo
		sub	[ebp+var_2C], 1	; jumptable 00415220 case 8
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	65h
		jmp	short loc_41528C
; ---------------------------------------------------------------------------

loc_415246:				; CODE XREF: sub_415150+D0j
					; DATA XREF: .rdata:off_42C5CCo
		sub	[ebp+var_2C], 1	; jumptable 00415220 case 9
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	45h
		jmp	short loc_41528C
; ---------------------------------------------------------------------------

loc_415252:				; CODE XREF: sub_415150+D0j
					; DATA XREF: .rdata:off_42C5CCo
		sub	[ebp+var_2C], 1	; jumptable 00415220 case 10
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	67h
		jmp	short loc_41528C
; ---------------------------------------------------------------------------

loc_41525E:				; CODE XREF: sub_415150+D0j
					; DATA XREF: .rdata:off_42C5CCo
		sub	[ebp+var_2C], 1	; jumptable 00415220 case 11
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	47h
		jmp	short loc_41528C
; ---------------------------------------------------------------------------

loc_41526A:				; CODE XREF: sub_415150+D0j
					; DATA XREF: .rdata:off_42C5CCo
		sub	[ebp+var_2C], 1	; jumptable 00415220 case 12
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	61h
		jmp	short loc_41528C
; ---------------------------------------------------------------------------

loc_415276:				; CODE XREF: sub_415150+D0j
					; DATA XREF: .rdata:off_42C5CCo
		sub	[ebp+var_2C], 1	; jumptable 00415220 case 13
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	41h
		jmp	short loc_41528C
; ---------------------------------------------------------------------------

loc_415282:				; CODE XREF: sub_415150+C7j
		mov	eax, 0FFFFFFFFh	; jumptable 00415220 default case
		jmp	loc_41557B
; ---------------------------------------------------------------------------

loc_41528C:				; CODE XREF: sub_415150+DCj
					; sub_415150+E8j ...
		cmp	[ebp+var_1C], 0
		jz	short loc_41529C
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	4Ch

loc_41529C:				; CODE XREF: sub_415150+140j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_415315
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		mov	edx, 64h
		cmp	eax, 64h
		cmovg	eax, edx
		mov	[ebp+var_30], eax

loc_4152BB:				; CODE XREF: sub_415150+1B9j
		sub	[ebp+var_2C], 1
		mov	ecx, [ebp+var_30]
		mov	edx, 0CCCCCCCDh
		mov	eax, ecx
		mul	edx
		shr	edx, 3
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_2C]
		mov	[eax], dl
		mov	ecx, [ebp+var_30]
		mov	[ebp+var_1CC], ecx
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_1CC]
		mul	edx
		mov	eax, edx
		shr	eax, 3
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	short loc_4152BB
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	2Eh

loc_415315:				; CODE XREF: sub_415150+155j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_41532C
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	23h

loc_41532C:				; CODE XREF: sub_415150+1D0j
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	25h
		cmp	[ebp+var_1C], 0
		jz	short loc_415368
		mov	ebx, [ebp+var_2C]
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	ecx, [ebp+var_10]
		mov	dword ptr [esp+1F8h+var_1F0], eax
		mov	dword ptr [esp+1F8h+var_1F0+4],	edx
		mov	[esp+1F8h+var_1E8], ecx
		mov	[esp+1F8h+Format], ebx ; Format
		lea	eax, [ebp+var_19A]
		mov	[esp+1F8h+Dest], eax ; Dest
		call	sprintf
		jmp	short loc_415384
; ---------------------------------------------------------------------------

loc_415368:				; CODE XREF: sub_415150+1EAj
		mov	eax, [ebp+var_2C]
		fld	[ebp+var_28]
		fstp	[esp+1F8h+var_1F0]
		mov	[esp+1F8h+Format], eax ; Format
		lea	eax, [ebp+var_19A]
		mov	[esp+1F8h+Dest], eax ; Dest
		call	sprintf

loc_415384:				; CODE XREF: sub_415150+216j
		lea	eax, [ebp+var_19A]
		mov	[ebp+var_2C], eax
		lea	eax, [ebp+var_19A]
		mov	[ebp+var_1D0], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1D0]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		add	eax, edx
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_2C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_4153DE
		mov	[ebp+var_1AF], 2Dh
		add	[ebp+var_2C], 1
		sub	[ebp+var_30], 1
		jmp	short loc_415408
; ---------------------------------------------------------------------------

loc_4153DE:				; CODE XREF: sub_415150+27Bj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 4
		test	eax, eax
		jz	short loc_4153F4
		mov	[ebp+var_1AF], 2Bh
		jmp	short loc_415408
; ---------------------------------------------------------------------------

loc_4153F4:				; CODE XREF: sub_415150+299j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 8
		test	eax, eax
		jz	short loc_415408
		mov	[ebp+var_1AF], 20h

loc_415408:				; CODE XREF: sub_415150+28Cj
					; sub_415150+2A2j ...
		movzx	eax, [ebp+var_1AF]
		test	al, al
		setnz	al
		movzx	eax, al
		mov	[ebp+var_38], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_415481
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_415481
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		cmp	eax, [ebp+var_30]
		jbe	short loc_415481
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		sub	eax, [ebp+var_30]
		mov	edx, [ebp+arg_1C]
		mov	[esp+1F8h+var_1E8], edx
		mov	dword ptr [esp+1F8h+var_1F0+4],	eax
		mov	dword ptr [esp+1F8h+var_1F0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+1F8h+Dest], eax
		call	sub_414A3F
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_415481
		mov	eax, [ebp+var_3C]
		jmp	loc_41557B
; ---------------------------------------------------------------------------

loc_415481:				; CODE XREF: sub_415150+2D5j
					; sub_415150+2DFj ...
		movzx	eax, [ebp+var_1AF]
		test	al, al
		jz	short loc_4154C7
		mov	dword ptr [esp+1F8h+var_1F0], 1
		lea	eax, [ebp+var_1AF]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Dest], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_4154BA
		mov	eax, [ebp+var_3C]
		jmp	loc_41557B
; ---------------------------------------------------------------------------

loc_4154BA:				; CODE XREF: sub_415150+360j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_4154C7:				; CODE XREF: sub_415150+33Aj
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_2C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	dword ptr [esp+1F8h+var_1F0], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Dest], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_4154FA
		mov	eax, [ebp+var_3C]
		jmp	loc_41557B
; ---------------------------------------------------------------------------

loc_4154FA:				; CODE XREF: sub_415150+3A0j
		mov	eax, [ebp+arg_1C]
		mov	edx, [eax]
		mov	ecx, [ebp+var_34]
		mov	eax, [ebp+var_2C]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jz	short loc_415576
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_415576
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		cmp	eax, [ebp+var_30]
		jbe	short loc_415576
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		sub	eax, [ebp+var_30]
		mov	edx, [ebp+arg_1C]
		mov	[esp+1F8h+var_1E8], edx
		mov	dword ptr [esp+1F8h+var_1F0+4],	eax
		mov	dword ptr [esp+1F8h+var_1F0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+1F8h+Dest], eax
		call	sub_414A3F
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_415576
		mov	eax, [ebp+var_3C]
		jmp	short loc_41557B
; ---------------------------------------------------------------------------

loc_415576:				; CODE XREF: sub_415150+3CDj
					; sub_415150+3D7j ...
		mov	eax, 0

loc_41557B:				; CODE XREF: sub_415150+A0j
					; sub_415150+137j ...
		add	esp, 1F0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_415150	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415585	proc near		; CODE XREF: sub_415953+39Fp

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 6
		jz	short loc_4155B5
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4155F5
; ---------------------------------------------------------------------------

loc_4155B5:				; CODE XREF: sub_415585+27j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_D], al
		mov	[esp+38h+var_30], 1
		lea	eax, [ebp+var_D]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4155E3
		mov	eax, [ebp+var_C]
		jmp	short locret_4155F5
; ---------------------------------------------------------------------------

loc_4155E3:				; CODE XREF: sub_415585+57j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, 0

locret_4155F5:				; CODE XREF: sub_415585+2Ej
					; sub_415585+5Cj
		leave
		retn
sub_415585	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4155F7	proc near		; CODE XREF: sub_415953+3E3p

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 0Eh
		jz	short loc_41562B
		mov	eax, 0FFFFFFFFh
		jmp	loc_415792
; ---------------------------------------------------------------------------

loc_41562B:				; CODE XREF: sub_4155F7+28j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41563E
		mov	[ebp+var_10], offset aNull ; "(null)"

loc_41563E:				; CODE XREF: sub_4155F7+3Ej
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		js	short loc_415676
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		jmp	short loc_41565F
; ---------------------------------------------------------------------------

loc_415657:				; CODE XREF: sub_4155F7+7Bj
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1

loc_41565F:				; CODE XREF: sub_4155F7+5Ej
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_C]
		jbe	short loc_415698
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_415657
		jmp	short loc_415698
; ---------------------------------------------------------------------------

loc_415676:				; CODE XREF: sub_4155F7+4Fj
		mov	eax, [ebp+var_10]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax

loc_415698:				; CODE XREF: sub_4155F7+71j
					; sub_4155F7+7Dj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_4156F9
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_4156F9
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		jbe	short loc_4156F9
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_C]
		mov	edx, [ebp+arg_1C]
		mov	[esp+58h+var_48], edx
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_414A3F
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_4156F9
		mov	eax, [ebp+var_18]
		jmp	loc_415792
; ---------------------------------------------------------------------------

loc_4156F9:				; CODE XREF: sub_4155F7+ACj
					; sub_4155F7+B6j ...
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_415720
		mov	eax, [ebp+var_18]
		jmp	short loc_415792
; ---------------------------------------------------------------------------

loc_415720:				; CODE XREF: sub_4155F7+122j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jz	short loc_41578D
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_41578D
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		jbe	short loc_41578D
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_C]
		mov	edx, [ebp+arg_1C]
		mov	[esp+58h+var_48], edx
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_414A3F
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_41578D
		mov	eax, [ebp+var_18]
		jmp	short loc_415792
; ---------------------------------------------------------------------------

loc_41578D:				; CODE XREF: sub_4155F7+143j
					; sub_4155F7+14Dj ...
		mov	eax, 0

loc_415792:				; CODE XREF: sub_4155F7+2Fj
					; sub_4155F7+FDj ...
		add	esp, 54h
		pop	edi
		pop	ebp
		retn
sub_4155F7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415798	proc near		; CODE XREF: sub_415953+427p

var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_7C		= byte ptr -7Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0A4h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_98], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_94], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_90], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_8C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 13h
		jz	short loc_4157DB
		mov	eax, 0FFFFFFFFh
		jmp	loc_415896
; ---------------------------------------------------------------------------

loc_4157DB:				; CODE XREF: sub_415798+37j
		mov	eax, [ebp+var_98]
		mov	[ebp+var_C], eax
		lea	eax, [ebp+var_7C]
		add	eax, 64h
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_10], eax

loc_4157F3:				; CODE XREF: sub_415798+7Ej
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		and	eax, 0Fh
		movzx	edx, ds:byte_42C5F3[eax]
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		mov	eax, [ebp+var_C]
		shr	eax, 4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4157F3
		jmp	short loc_415824
; ---------------------------------------------------------------------------

loc_41581A:				; CODE XREF: sub_415798+9Bj
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	30h

loc_415824:				; CODE XREF: sub_415798+80j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, 7
		jbe	short loc_41581A
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	78h
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	30h
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	[esp+0A8h+var_A0], eax
		mov	eax, [ebp+var_10]
		mov	[esp+0A8h+var_A4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+var_A8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_415879
		mov	eax, [ebp+var_18]
		jmp	short loc_415896
; ---------------------------------------------------------------------------

loc_415879:				; CODE XREF: sub_415798+DAj
		mov	eax, [ebp+arg_1C]
		mov	edx, [eax]
		mov	ecx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, 0

loc_415896:				; CODE XREF: sub_415798+3Ej
					; sub_415798+DFj
		add	esp, 0A4h
		pop	ebx
		pop	ebp
		retn
sub_415798	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41589F	proc near		; CODE XREF: sub_415953+468p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		sub	eax, 15h	; switch 8 cases
		cmp	eax, 7
		ja	short loc_415945 ; jumptable 004158D2 default case
		mov	eax, ds:off_42C608[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4158D4:				; CODE XREF: sub_41589F+33j
					; DATA XREF: .rdata:off_42C608o
		mov	eax, [ebp+var_10] ; jumptable 004158D2 case 21
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], dl
		jmp	short loc_41594C
; ---------------------------------------------------------------------------

loc_4158E0:				; CODE XREF: sub_41589F+33j
					; DATA XREF: .rdata:off_42C608o
		mov	eax, [ebp+var_10] ; jumptable 004158D2 case 22
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], dx
		jmp	short loc_41594C
; ---------------------------------------------------------------------------

loc_4158ED:				; CODE XREF: sub_41589F+33j
					; DATA XREF: .rdata:off_42C608o
		mov	eax, [ebp+var_10] ; jumptable 004158D2 case 24
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_41594C
; ---------------------------------------------------------------------------

loc_4158F9:				; CODE XREF: sub_41589F+33j
					; DATA XREF: .rdata:off_42C608o
		mov	ecx, [ebp+var_10] ; jumptable 004158D2 case 25
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, 0
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_41594C
; ---------------------------------------------------------------------------

loc_41590D:				; CODE XREF: sub_41589F+33j
					; DATA XREF: .rdata:off_42C608o
		mov	ecx, [ebp+var_10] ; jumptable 004158D2 case 26
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, 0
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_41594C
; ---------------------------------------------------------------------------

loc_415921:				; CODE XREF: sub_41589F+33j
					; DATA XREF: .rdata:off_42C608o
		mov	eax, [ebp+var_10] ; jumptable 004158D2 case 27
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_41594C
; ---------------------------------------------------------------------------

loc_41592D:				; CODE XREF: sub_41589F+33j
					; DATA XREF: .rdata:off_42C608o
		mov	eax, [ebp+var_10] ; jumptable 004158D2 case 28
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_41594C
; ---------------------------------------------------------------------------

loc_415939:				; CODE XREF: sub_41589F+33j
					; DATA XREF: .rdata:off_42C608o
		mov	eax, [ebp+var_10] ; jumptable 004158D2 case 23
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_41594C
; ---------------------------------------------------------------------------

loc_415945:				; CODE XREF: sub_41589F+2Aj
		mov	eax, 0FFFFFFFFh	; jumptable 004158D2 default case
		jmp	short locret_415951
; ---------------------------------------------------------------------------

loc_41594C:				; CODE XREF: sub_41589F+3Fj
					; sub_41589F+4Cj ...
		mov	eax, 0

locret_415951:				; CODE XREF: sub_41589F+ABj
		leave
		retn
sub_41589F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415953	proc near		; CODE XREF: sub_415E33+550p

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		jmp	loc_415DD3
; ---------------------------------------------------------------------------

loc_415978:				; CODE XREF: sub_415953+488j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_41598B
		add	[ebp+var_10], 1
		jmp	loc_415DD3
; ---------------------------------------------------------------------------

loc_41598B:				; CODE XREF: sub_415953+2Dj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jz	short loc_4159DB
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4159CC
		mov	eax, [ebp+var_C]
		jmp	locret_415E31
; ---------------------------------------------------------------------------

loc_4159CC:				; CODE XREF: sub_415953+6Fj
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_4159DB:				; CODE XREF: sub_415953+3Ej
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_415A2F
		mov	[esp+58h+var_50], 1
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_415A13
		mov	eax, [ebp+var_C]
		jmp	locret_415E31
; ---------------------------------------------------------------------------

loc_415A13:				; CODE XREF: sub_415953+B6j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		add	[ebp+var_10], 2
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_8], eax
		jmp	loc_415DD3
; ---------------------------------------------------------------------------

loc_415A2F:				; CODE XREF: sub_415953+93j
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_8], eax
		mov	eax, [ebp+var_18]
		cmp	eax, [ebp+arg_10]
		jb	short loc_415A61
		mov	[esp+58h+var_50], 52Dh ; int
		mov	[esp+58h+var_54], offset a____Gnupg22__7 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aArgidxArgspecs ; "argidx < argspecs_len"
		call	sub_4276E0

loc_415A61:				; CODE XREF: sub_415953+F0j
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	loc_415AF5
		mov	eax, [ebp+var_14]
		mov	eax, [eax+1Ch]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	eax, 6
		jz	short loc_415AAC
		mov	[esp+58h+var_50], 533h ; int
		mov	[esp+58h+var_54], offset a____Gnupg22__7 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aValuetableArgW ; "valuetable[arg->width_pos-1].vt == VALT"...
		call	sub_4276E0

loc_415AAC:				; CODE XREF: sub_415953+13Bj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+1Ch]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_14]
		mov	[eax+8], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		test	eax, eax
		jns	short loc_415AF5
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	edx, eax
		neg	edx
		mov	eax, [ebp+var_14]
		mov	[eax+8], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	edx, eax
		or	edx, 2
		mov	eax, [ebp+var_14]
		mov	[eax+4], edx

loc_415AF5:				; CODE XREF: sub_415953+11Bj
					; sub_415953+17Fj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_415B6A
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	eax, 6
		jz	short loc_415B38
		mov	[esp+58h+var_50], 53Dh ; int
		mov	[esp+58h+var_54], offset a____Gnupg22__7 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aValuetableArgP ; "valuetable[arg->precision_pos-1].vt	== "...
		call	sub_4276E0

loc_415B38:				; CODE XREF: sub_415953+1C7j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_14]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jns	short loc_415B6A
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+0Ch], 0FFFFFFFFh

loc_415B6A:				; CODE XREF: sub_415953+1ABj
					; sub_415953+20Bj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_415B90
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		cmp	eax, 11h
		jnz	short loc_415B90
		mov	eax, [ebp+arg_18]
		mov	[esp+58h+var_58], eax ;	int
		call	strerror
		mov	[ebp+var_30], eax
		jmp	short loc_415BFA
; ---------------------------------------------------------------------------

loc_415B90:				; CODE XREF: sub_415953+220j
					; sub_415953+22Bj
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+24h]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	ecx, eax
		jz	short loc_415BCD
		mov	[esp+58h+var_50], 547h ; int
		mov	[esp+58h+var_54], offset a____Gnupg22__7 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aArgVtValuetabl ; "arg->vt == valuetable[arg->arg_pos-1].v"...
		call	sub_4276E0

loc_415BCD:				; CODE XREF: sub_415953+25Cj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	edx, [eax+8]
		mov	[ebp+var_30], edx
		mov	edx, [eax+0Ch]
		mov	[ebp+var_2C], edx
		mov	edx, [eax+10h]
		mov	[ebp+var_28], edx
		mov	eax, [eax+14h]
		mov	[ebp+var_24], eax

loc_415BFA:				; CODE XREF: sub_415953+23Bj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		cmp	eax, 12h	; switch 19 cases
		ja	loc_415DC4	; jumptable 00415C10 default case
		mov	eax, ds:off_42C700[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_415C12:				; CODE XREF: sub_415953+2BDj
					; DATA XREF: .rdata:off_42C700o
		mov	[esp+58h+var_50], 54Dh ; jumptable 00415C10 case 0
		mov	[esp+58h+var_54], offset a____Gnupg22__7 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aBug ;	"!\"bug\""
		call	sub_4276E0
		jmp	loc_415DC4	; jumptable 00415C10 default case
; ---------------------------------------------------------------------------

loc_415C33:				; CODE XREF: sub_415953+2BDj
					; DATA XREF: .rdata:off_42C700o
		mov	eax, [ebp+arg_1C] ; jumptable 00415C10 cases 1-5
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_414ABD
		mov	[ebp+var_C], eax
		jmp	loc_415DC4	; jumptable 00415C10 default case
; ---------------------------------------------------------------------------

loc_415C77:				; CODE XREF: sub_415953+2BDj
					; DATA XREF: .rdata:off_42C700o
		mov	eax, [ebp+arg_1C] ; jumptable 00415C10 cases 6-13
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_415150
		mov	[ebp+var_C], eax
		jmp	loc_415DC4	; jumptable 00415C10 default case
; ---------------------------------------------------------------------------

loc_415CBB:				; CODE XREF: sub_415953+2BDj
					; DATA XREF: .rdata:off_42C700o
		mov	eax, [ebp+arg_1C] ; jumptable 00415C10 case 14
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_415585
		mov	[ebp+var_C], eax
		jmp	loc_415DC4	; jumptable 00415C10 default case
; ---------------------------------------------------------------------------

loc_415CFF:				; CODE XREF: sub_415953+2BDj
					; DATA XREF: .rdata:off_42C700o
		mov	eax, [ebp+arg_1C] ; jumptable 00415C10 cases 15,17
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_4155F7
		mov	[ebp+var_C], eax
		jmp	loc_415DC4	; jumptable 00415C10 default case
; ---------------------------------------------------------------------------

loc_415D43:				; CODE XREF: sub_415953+2BDj
					; DATA XREF: .rdata:off_42C700o
		mov	eax, [ebp+arg_1C] ; jumptable 00415C10 case 16
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_415798
		mov	[ebp+var_C], eax
		jmp	short loc_415DC4 ; jumptable 00415C10 default case
; ---------------------------------------------------------------------------

loc_415D84:				; CODE XREF: sub_415953+2BDj
					; DATA XREF: .rdata:off_42C700o
		mov	eax, [ebp+arg_1C] ; jumptable 00415C10 case 18
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_41589F
		mov	[ebp+var_C], eax
		nop

loc_415DC4:				; CODE XREF: sub_415953+2B0j
					; sub_415953+2DBj ...
		cmp	[ebp+var_C], 0	; jumptable 00415C10 default case
		jz	short loc_415DCF
		mov	eax, [ebp+var_C]
		jmp	short locret_415E31
; ---------------------------------------------------------------------------

loc_415DCF:				; CODE XREF: sub_415953+475j
		add	[ebp+var_14], 28h

loc_415DD3:				; CODE XREF: sub_415953+20j
					; sub_415953+33j ...
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_415978
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_415E11
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		jmp	short loc_415E16
; ---------------------------------------------------------------------------

loc_415E11:				; CODE XREF: sub_415953+4A1j
		mov	eax, 0

loc_415E16:				; CODE XREF: sub_415953+4BCj
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_415E2E
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_415E2E:				; CODE XREF: sub_415953+4CAj
		mov	eax, [ebp+var_C]

locret_415E31:				; CODE XREF: sub_415953+74j
					; sub_415953+BBj ...
		leave
		retn
sub_415953	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415E33	proc near		; CODE XREF: sub_411127+32p
					; .text:0041645Fp ...

NumOfElements	= dword	ptr -1E8h
SizeOfElements	= dword	ptr -1E4h
var_1E0		= dword	ptr -1E0h
var_1DC		= dword	ptr -1DCh
var_1D8		= dword	ptr -1D8h
var_1D4		= dword	ptr -1D4h
var_1D0		= dword	ptr -1D0h
var_1CC		= dword	ptr -1CCh
var_1BC		= dword	ptr -1BCh
var_1B4		= dword	ptr -1B4h
var_1B0		= byte ptr -1B0h
var_F0		= dword	ptr -0F0h
var_EC		= dword	ptr -0ECh
var_E8		= byte ptr -0E8h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Memory		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 1E0h
		lea	eax, [ebp+var_E8]
		mov	[ebp+var_EC], eax
		lea	eax, [ebp+var_1B0]
		mov	[ebp+Memory], eax
		mov	[ebp+var_1B4], 0
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_F0]
		mov	[esp+1E8h+var_1DC], eax
		mov	[esp+1E8h+var_1E0], 5
		lea	eax, [ebp+var_EC]
		mov	[esp+1E8h+SizeOfElements], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+1E8h+NumOfElements], eax
		call	sub_413FE9
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_4163AD
		mov	[ebp+var_14], 0
		mov	[ebp+var_1C], 0
		jmp	loc_415F79
; ---------------------------------------------------------------------------

loc_415EB0:				; CODE XREF: sub_415E33+14Fj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_415F05
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, [ebp+var_1C]
		jle	short loc_415F05
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		mov	[ebp+var_1C], eax

loc_415F05:				; CODE XREF: sub_415E33+98j
					; sub_415E33+B5j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		cmp	eax, [ebp+var_1C]
		jle	short loc_415F3D
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		mov	[ebp+var_1C], eax

loc_415F3D:				; CODE XREF: sub_415E33+EDj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		cmp	eax, [ebp+var_1C]
		jle	short loc_415F75
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		mov	[ebp+var_1C], eax

loc_415F75:				; CODE XREF: sub_415E33+125j
		add	[ebp+var_14], 1

loc_415F79:				; CODE XREF: sub_415E33+78j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_415EB0
		cmp	[ebp+var_1C], 0
		jnz	loc_41606D
		mov	[ebp+var_14], 0
		jmp	loc_416059
; ---------------------------------------------------------------------------

loc_415F9E:				; CODE XREF: sub_415E33+22Fj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_415FDB
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		lea	edx, [ecx+eax]
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		mov	[edx+1Ch], eax

loc_415FDB:				; CODE XREF: sub_415E33+186j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_416018
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		lea	edx, [ecx+eax]
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		mov	[edx+20h], eax

loc_416018:				; CODE XREF: sub_415E33+1C3j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_416055
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		lea	edx, [ecx+eax]
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		mov	[edx+18h], eax

loc_416055:				; CODE XREF: sub_415E33+200j
		add	[ebp+var_14], 1

loc_416059:				; CODE XREF: sub_415E33+166j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_415F9E
		jmp	loc_416126
; ---------------------------------------------------------------------------

loc_41606D:				; CODE XREF: sub_415E33+159j
		mov	[ebp+var_14], 0
		jmp	loc_416117
; ---------------------------------------------------------------------------

loc_416079:				; CODE XREF: sub_415E33+2EDj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		test	eax, eax
		jz	loc_416397
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_4160D6
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	loc_416397

loc_4160D6:				; CODE XREF: sub_415E33+281j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_416113
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		test	eax, eax
		jz	loc_416397

loc_416113:				; CODE XREF: sub_415E33+2BEj
		add	[ebp+var_14], 1

loc_416117:				; CODE XREF: sub_415E33+241j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_416079

loc_416126:				; CODE XREF: sub_415E33+235j
		cmp	[ebp+var_1C], 0
		js	loc_416397
		mov	ebx, [ebp+var_1C]
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1BC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1BC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	ebx, eax
		jnb	loc_416397
		mov	eax, [ebp+var_1C]
		cmp	eax, 8
		jbe	short loc_416189
		mov	eax, [ebp+var_1C]
		mov	[esp+1E8h+SizeOfElements], 18h ; SizeOfElements
		mov	[esp+1E8h+NumOfElements], eax ;	NumOfElements
		call	calloc
		mov	[ebp+Memory], eax
		cmp	[ebp+Memory], 0
		jnz	short loc_4161B1
		jmp	loc_4163A4
; ---------------------------------------------------------------------------

loc_416189:				; CODE XREF: sub_415E33+333j
		mov	[ebp+var_18], 0
		jmp	short loc_4161AB
; ---------------------------------------------------------------------------

loc_416192:				; CODE XREF: sub_415E33+37Cj
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	dword ptr [eax], 0
		add	[ebp+var_18], 1

loc_4161AB:				; CODE XREF: sub_415E33+35Dj
		cmp	[ebp+var_18], 7
		jbe	short loc_416192

loc_4161B1:				; CODE XREF: sub_415E33+34Fj
		mov	[ebp+var_14], 0
		jmp	loc_416312
; ---------------------------------------------------------------------------

loc_4161BD:				; CODE XREF: sub_415E33+4E8j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_41623C
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_41638D
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		mov	ecx, eax
		add	ecx, [ebp+Memory]
		mov	ebx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ebx
		mov	eax, [eax+24h]
		mov	[ecx], eax

loc_41623C:				; CODE XREF: sub_415E33+3A5j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_4162A5
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_416390
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	dword ptr [eax], 6

loc_4162A5:				; CODE XREF: sub_415E33+424j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_41630E
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_416393
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	dword ptr [eax], 6

loc_41630E:				; CODE XREF: sub_415E33+48Dj
		add	[ebp+var_14], 1

loc_416312:				; CODE XREF: sub_415E33+385j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_4161BD
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+arg_C]
		mov	[esp+1E8h+var_1E0], edx
		mov	[esp+1E8h+SizeOfElements], eax
		mov	eax, [ebp+Memory]
		mov	[esp+1E8h+NumOfElements], eax
		call	sub_414761
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_416396
		mov	edx, [ebp+var_F0]
		mov	eax, [ebp+var_EC]
		lea	ecx, [ebp+var_1B4]
		mov	[esp+1E8h+var_1CC], ecx
		mov	ecx, [ebp+var_20]
		mov	[esp+1E8h+var_1D0], ecx
		mov	ecx, [ebp+Memory]
		mov	[esp+1E8h+var_1D4], ecx
		mov	[esp+1E8h+var_1D8], edx
		mov	[esp+1E8h+var_1DC], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+1E8h+var_1E0], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+1E8h+SizeOfElements], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+1E8h+NumOfElements], eax
		call	sub_415953
		mov	[ebp+var_10], eax
		jmp	short loc_4163AE
; ---------------------------------------------------------------------------

loc_41638D:				; CODE XREF: sub_415E33+3D8j
		nop
		jmp	short loc_416397
; ---------------------------------------------------------------------------

loc_416390:				; CODE XREF: sub_415E33+457j
		nop
		jmp	short loc_416397
; ---------------------------------------------------------------------------

loc_416393:				; CODE XREF: sub_415E33+4C0j
		nop
		jmp	short loc_416397
; ---------------------------------------------------------------------------

loc_416396:				; CODE XREF: sub_415E33+50Ej
		nop

loc_416397:				; CODE XREF: sub_415E33+260j
					; sub_415E33+29Dj ...
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h

loc_4163A4:				; CODE XREF: sub_415E33+351j
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_4163AE
; ---------------------------------------------------------------------------

loc_4163AD:				; CODE XREF: sub_415E33+64j
		nop

loc_4163AE:				; CODE XREF: sub_415E33+558j
					; sub_415E33+578j
		lea	eax, [ebp+var_1B0]
		cmp	[ebp+Memory], eax
		jz	short loc_4163C4
		mov	eax, [ebp+Memory]
		mov	[esp+1E8h+NumOfElements], eax ;	Memory
		call	free

loc_4163C4:				; CODE XREF: sub_415E33+584j
		mov	edx, [ebp+var_EC]
		lea	eax, [ebp+var_E8]
		cmp	edx, eax
		jz	short loc_4163E2
		mov	eax, [ebp+var_EC]
		mov	[esp+1E8h+NumOfElements], eax ;	Memory
		call	free

loc_4163E2:				; CODE XREF: sub_415E33+59Fj
		mov	eax, [ebp+var_10]
		add	esp, 1E0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_415E33	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4163EF(int, void *, size_t)
sub_4163EF	proc near		; DATA XREF: .text:00416458o
					; .text:0041648Fo ...

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 1 ; Count
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+Size],	edx ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		cmp	eax, 1
		jz	short loc_416428
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41642D
; ---------------------------------------------------------------------------

loc_416428:				; CODE XREF: sub_4163EF+30j
		mov	eax, 0

locret_41642D:				; CODE XREF: sub_4163EF+37j
		leave
		retn
sub_4163EF	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	edx, ds:_iob
		add	edx, 40h
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	dword ptr [esp], offset	sub_4163EF
		call	sub_415E33
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+10h]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	sub_4163EF
		call	sub_415E33
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	sub_4163EF
		call	sub_415E33
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4164CC(int, void *, size_t)
sub_4164CC	proc near		; CODE XREF: sub_416588+6Dp
					; DATA XREF: sub_416588+42o

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_416581
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	edx, eax
		jnb	short loc_41656C
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	ecx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		add	eax, ecx
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		jmp	short loc_416581
; ---------------------------------------------------------------------------

loc_416544:				; CODE XREF: sub_4164CC+B3j
		mov	eax, [ebp+var_C]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+arg_4]
		movzx	edx, byte ptr [edx]
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		add	[ebp+arg_4], 1
		sub	[ebp+arg_8], 1

loc_41656C:				; CODE XREF: sub_4164CC+3Dj
		cmp	[ebp+arg_8], 0
		jz	short loc_416581
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	edx, eax
		jb	short loc_416544

loc_416581:				; CODE XREF: sub_4164CC+25j
					; sub_4164CC+76j ...
		mov	eax, 0
		leave
		retn
sub_4164CC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416588	proc near		; CODE XREF: sub_416641+29p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_18], 0
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_4165AD
		mov	eax, [ebp+arg_0]
		jmp	short loc_4165B2
; ---------------------------------------------------------------------------

loc_4165AD:				; CODE XREF: sub_416588+1Ej
		mov	eax, 0

loc_4165B2:				; CODE XREF: sub_416588+23j
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_34], eax
		mov	[esp+38h+var_38], offset sub_4164CC
		call	sub_415E33
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4165FD
		mov	[esp+38h+var_30], 1 ; size_t
		mov	[esp+38h+var_34], offset byte_42C74C ; void *
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_38], eax ;	int
		call	sub_4164CC
		mov	[ebp+var_C], eax

loc_4165FD:				; CODE XREF: sub_416588+55j
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_41660A
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41663F
; ---------------------------------------------------------------------------

loc_41660A:				; CODE XREF: sub_416588+79j
		cmp	[ebp+arg_4], 0
		jz	short loc_416633
		cmp	[ebp+arg_0], 0
		jz	short loc_416633
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jz	short loc_416633
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_1C]
		cmp	edx, eax
		jb	short loc_416633
		mov	eax, [ebp+var_1C]
		sub	eax, 1
		add	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0

loc_416633:				; CODE XREF: sub_416588+86j
					; sub_416588+8Cj ...
		mov	eax, [ebp+var_18]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]

locret_41663F:				; CODE XREF: sub_416588+80j
		leave
		retn
sub_416588	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416641	proc near		; CODE XREF: sub_404392+320p
					; sub_40DBAB+1BBp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_C]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_416588
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_416641	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_416677(int, void *Src, size_t)
sub_416677	proc near		; CODE XREF: sub_416783+83p
					; DATA XREF: sub_416783+58o

Memory		= dword	ptr -28h
NewSize		= dword	ptr -24h
Size		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Src		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4166A4
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_C]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, 0FFFFFFFFh
		jmp	locret_416781
; ---------------------------------------------------------------------------

loc_4166A4:				; CODE XREF: sub_416677+13j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	loc_416745
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		add	eax, [ebp+arg_8]
		lea	edx, [eax+200h]
		mov	eax, [ebp+var_C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	[esp+28h+NewSize], edx ; NewSize
		mov	[esp+28h+Memory], eax ;	Memory
		call	realloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41673C
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_41670B
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		jmp	short loc_416710
; ---------------------------------------------------------------------------

loc_41670B:				; CODE XREF: sub_416677+87j
		mov	eax, 0Ch

loc_416710:				; CODE XREF: sub_416677+92j
		mov	edx, [ebp+var_C]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	[esp+28h+Size],	edx ; Size
		mov	[esp+28h+NewSize], 0 ; Val
		mov	[esp+28h+Memory], eax ;	Dst
		call	memset
		mov	eax, 0FFFFFFFFh
		jmp	short locret_416781
; ---------------------------------------------------------------------------

loc_41673C:				; CODE XREF: sub_416677+7Aj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		mov	[eax+0Ch], edx

loc_416745:				; CODE XREF: sub_416677+40j
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	ecx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		add	eax, ecx
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+NewSize], edx ; Src
		mov	[esp+28h+Memory], eax ;	Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, 0

locret_416781:				; CODE XREF: sub_416677+28j
					; sub_416677+C3j
		leave
		retn
sub_416677	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416783	proc near		; CODE XREF: .text:00413059p
					; .text:0041308Dp ...

Dst		= dword	ptr -38h
Val		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_1C], 0
		mov	[ebp+var_18], 200h
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		test	eax, eax
		jnz	short loc_4167C6
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh
		jmp	locret_41689A
; ---------------------------------------------------------------------------

loc_4167C6:				; CODE XREF: sub_416783+2Ej
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Size],	eax
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+Val], eax
		mov	[esp+38h+Dst], offset sub_416677
		call	sub_415E33
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41680E
		mov	[esp+38h+Size],	1 ; size_t
		mov	[esp+38h+Val], offset byte_42C74C ; Src
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+Dst], eax ; int
		call	sub_416677
		mov	[ebp+var_C], eax

loc_41680E:				; CODE XREF: sub_416783+6Bj
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	short loc_41682E
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jz	short loc_41682E
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_1C]
		mov	[eax], edx

loc_41682E:				; CODE XREF: sub_416783+8Fj
					; sub_416783+96j
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_416869
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Val], 0 ; Val
		mov	[esp+38h+Dst], eax ; Dst
		call	memset
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41689A
; ---------------------------------------------------------------------------

loc_416869:				; CODE XREF: sub_416783+AFj
		mov	eax, [ebp+var_14]
		test	eax, eax
		jnz	short loc_41688C
		mov	[esp+38h+Size],	6E9h ; int
		mov	[esp+38h+Val], offset a____Gnupg22__7 ;	"../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+38h+Dst], offset aParm_used ; "parm.used"
		call	sub_4276E0

loc_41688C:				; CODE XREF: sub_416783+EBj
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		sub	eax, 1

locret_41689A:				; CODE XREF: sub_416783+3Ej
					; sub_416783+E4j
		leave
		retn
sub_416783	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41689C	proc near		; CODE XREF: sub_41C222+54p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_416783
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41689C	endp

; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_416783
		test	eax, eax
		jns	short loc_416918
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp], eax
		call	strerror
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aEstream_asprin	; "estream_asprintf failed: %s\n"
		call	sub_420960
; ---------------------------------------------------------------------------

loc_416918:				; CODE XREF: .text:004168F5j
		mov	eax, [ebp-10h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41691D	proc near		; CODE XREF: sub_404392+3C1p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	sub_416783
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_416954
		mov	eax, 0
		jmp	short locret_416957
; ---------------------------------------------------------------------------

loc_416954:				; CODE XREF: sub_41691D+2Ej
		mov	eax, [ebp+var_14]

locret_416957:				; CODE XREF: sub_41691D+35j
		leave
		retn
sub_41691D	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41695C	proc near		; CODE XREF: sub_416983+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_41697C
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_416981
; ---------------------------------------------------------------------------

loc_41697C:				; CODE XREF: sub_41695C+7j
		mov	eax, 0

loc_416981:				; CODE XREF: sub_41695C+1Ej
		pop	ebp
		retn
sub_41695C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416983	proc near		; CODE XREF: sub_417769+17p
					; sub_417769+4Bp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_41695C
		leave
		retn
sub_416983	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41699E	proc near		; CODE XREF: sub_4169F8+9p
					; .text:00416B32p

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 0
		call	sub_4277C0
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_430264
		test	eax, eax
		jnz	short loc_4169C1
		mov	eax, [ebp+var_C]
		jmp	short locret_4169F6
; ---------------------------------------------------------------------------

loc_4169C1:				; CODE XREF: sub_41699E+1Cj
		mov	eax, ds:dword_430264
		cmp	eax, 1
		jnz	short loc_4169D2
		mov	eax, ds:dword_430260
		jmp	short locret_4169F6
; ---------------------------------------------------------------------------

loc_4169D2:				; CODE XREF: sub_41699E+2Bj
		mov	eax, ds:dword_430264
		cmp	eax, 2
		jnz	short loc_4169E8
		mov	edx, [ebp+var_C]
		mov	eax, ds:dword_430260
		add	eax, edx
		jmp	short locret_4169F6
; ---------------------------------------------------------------------------

loc_4169E8:				; CODE XREF: sub_41699E+3Cj
		mov	edx, [ebp+var_C]
		mov	eax, ds:dword_430260
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_4169F6:				; CODE XREF: sub_41699E+21j
					; sub_41699E+32j ...
		leave
		retn
sub_41699E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4169F8	proc near		; CODE XREF: sub_404830+4Ap

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		call	sub_41699E
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		test	eax, eax
		jns	short loc_416A18
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0
		jmp	short loc_416A85
; ---------------------------------------------------------------------------

loc_416A18:				; CODE XREF: sub_4169F8+16j
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_58], eax
		call	sub_4277D0
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax]
		mov	eax, [ebp+var_1C]
		mov	ecx, [eax+4]
		mov	eax, [ebp+var_1C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+0Ch]
		mov	esi, [ebp+var_1C]
		mov	esi, [esi+10h]
		lea	edi, [esi+1]
		mov	esi, [ebp+var_1C]
		mov	esi, [esi+14h]
		add	esi, 76Ch
		mov	[esp+58h+var_38], ebx
		mov	[esp+58h+var_3C], ecx
		mov	[esp+58h+var_40], edx
		mov	[esp+58h+var_44], eax
		mov	[esp+58h+var_48], edi
		mov	[esp+58h+var_4C], esi
		mov	[esp+58h+var_50], offset a04d02d02dt02d0 ; "%04d%02d%02dT%02d%02d%02d"
		mov	[esp+58h+var_54], 10h
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_416641

loc_416A85:				; CODE XREF: sub_4169F8+1Ej
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4169F8	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp], 0
		call	sub_4277C0
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp+8], 0FFFFFFFFh
		jz	short loc_416AB0
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_416AC6

loc_416AB0:				; CODE XREF: .text:00416AA6j
		mov	ds:dword_430264, 0
		mov	ds:dword_430260, 0
		jmp	short locret_416B20
; ---------------------------------------------------------------------------

loc_416AC6:				; CODE XREF: .text:00416AAEj
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_416AE0
		mov	ds:dword_430264, 1
		mov	eax, [ebp-0Ch]
		mov	ds:dword_430260, eax
		jmp	short locret_416B20
; ---------------------------------------------------------------------------

loc_416AE0:				; CODE XREF: .text:00416ACAj
		mov	eax, [ebp+8]
		cmp	eax, [ebp-0Ch]
		jle	short loc_416B05
		mov	ds:dword_430264, 2
		mov	eax, [ebp-0Ch]
		mov	edx, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	ds:dword_430260, eax
		jmp	short locret_416B20
; ---------------------------------------------------------------------------

loc_416B05:				; CODE XREF: .text:00416AE6j
		mov	ds:dword_430264, 3
		mov	eax, [ebp+8]
		mov	edx, [ebp-0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	ds:dword_430260, eax

locret_416B20:				; CODE XREF: .text:00416AC4j
					; .text:00416ADEj ...
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_430264
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_41699E
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_416B4C
		mov	dword ptr [esp], offset	aGnupg_get_time	; "gnupg_get_time() failed\n"
		call	sub_420960
; ---------------------------------------------------------------------------

loc_416B4C:				; CODE XREF: .text:00416B3Ej
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 60h
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-4Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-4Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 0Ah
		jnz	short loc_416B97
		mov	eax, [ebp+8]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_416B97
		mov	eax, [ebp+8]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jz	short loc_416BA1

loc_416B97:				; CODE XREF: .text:00416B7Bj
					; .text:00416B88j
		mov	eax, 0
		jmp	loc_416D00
; ---------------------------------------------------------------------------

loc_416BA1:				; CODE XREF: .text:00416B95j
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_416BD2
; ---------------------------------------------------------------------------

loc_416BAA:				; CODE XREF: .text:00416BD6j
		mov	eax, [ebp-0Ch]
		add	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_416BC4
		mov	eax, [ebp-0Ch]
		add	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_416BCE

loc_416BC4:				; CODE XREF: .text:00416BB5j
		mov	eax, 0
		jmp	loc_416D00
; ---------------------------------------------------------------------------

loc_416BCE:				; CODE XREF: .text:00416BC2j
		add	dword ptr [ebp-0Ch], 1

loc_416BD2:				; CODE XREF: .text:00416BA8j
		cmp	dword ptr [ebp-0Ch], 3
		jle	short loc_416BAA
		mov	eax, [ebp+8]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_416C0C
		mov	eax, [ebp+8]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_416C0C
		mov	eax, [ebp+8]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_416C0C
		mov	eax, [ebp+8]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_416C16

loc_416C0C:				; CODE XREF: .text:00416BE3j
					; .text:00416BF0j ...
		mov	eax, 0
		jmp	loc_416D00
; ---------------------------------------------------------------------------

loc_416C16:				; CODE XREF: .text:00416C0Aj
		mov	eax, [ebp+8]
		add	eax, 8
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_416C4A
		mov	eax, [ebp+8]
		add	eax, 8
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_416C4A
		mov	eax, [ebp+8]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_416C4A
		mov	eax, [ebp+8]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_416C54

loc_416C4A:				; CODE XREF: .text:00416C21j
					; .text:00416C2Ej ...
		mov	eax, 0
		jmp	loc_416D00
; ---------------------------------------------------------------------------

loc_416C54:				; CODE XREF: .text:00416C48j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	atoi
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		add	eax, 5
		mov	[esp], eax
		call	atoi
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		add	eax, 8
		mov	[esp], eax
		call	atoi
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-10h], 7B1h
		jle	short loc_416CA5
		cmp	dword ptr [ebp-14h], 0
		jle	short loc_416CA5
		cmp	dword ptr [ebp-14h], 0Ch
		jg	short loc_416CA5
		cmp	dword ptr [ebp-18h], 0
		jle	short loc_416CA5
		cmp	dword ptr [ebp-18h], 1Fh
		jle	short loc_416CAC

loc_416CA5:				; CODE XREF: .text:00416C8Bj
					; .text:00416C91j ...
		mov	eax, 0
		jmp	short loc_416D00
; ---------------------------------------------------------------------------

loc_416CAC:				; CODE XREF: .text:00416CA3j
		lea	eax, [ebp-40h]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 9
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	eax, [ebp-18h]
		mov	[ebp-34h], eax
		mov	eax, [ebp-14h]
		sub	eax, 1
		mov	[ebp-30h], eax
		mov	eax, [ebp-10h]
		sub	eax, 76Ch
		mov	[ebp-2Ch], eax
		mov	dword ptr [ebp-20h], 0FFFFFFFFh
		lea	eax, [ebp-40h]
		mov	[esp], eax
		call	sub_4277E0
		mov	[ebp-1Ch], eax
		cmp	dword ptr [ebp-1Ch], 0FFFFFFFFh
		jnz	short loc_416CFD
		mov	eax, 0
		jmp	short loc_416D00
; ---------------------------------------------------------------------------

loc_416CFD:				; CODE XREF: .text:00416CF4j
		mov	eax, [ebp-1Ch]

loc_416D00:				; CODE XREF: .text:00416B9Cj
					; .text:00416BC9j ...
		add	esp, 60h
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 60h
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_416D23
		mov	eax, 0FFFFFFFFh
		jmp	loc_416FC9
; ---------------------------------------------------------------------------

loc_416D23:				; CODE XREF: .text:00416D17j
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], 0
		jmp	short loc_416D58
; ---------------------------------------------------------------------------

loc_416D32:				; CODE XREF: .text:00416D5Cj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_416D46
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_416D50

loc_416D46:				; CODE XREF: .text:00416D3Aj
		mov	eax, 0FFFFFFFFh
		jmp	loc_416FC9
; ---------------------------------------------------------------------------

loc_416D50:				; CODE XREF: .text:00416D44j
		add	dword ptr [ebp-10h], 1
		add	dword ptr [ebp-0Ch], 1

loc_416D58:				; CODE XREF: .text:00416D30j
		cmp	dword ptr [ebp-10h], 7
		jle	short loc_416D32
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 54h
		jz	short loc_416D72
		mov	eax, 0FFFFFFFFh
		jmp	loc_416FC9
; ---------------------------------------------------------------------------

loc_416D72:				; CODE XREF: .text:00416D66j
		add	dword ptr [ebp-0Ch], 1
		mov	dword ptr [ebp-10h], 9
		jmp	short loc_416DA5
; ---------------------------------------------------------------------------

loc_416D7F:				; CODE XREF: .text:00416DA9j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_416D93
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_416D9D

loc_416D93:				; CODE XREF: .text:00416D87j
		mov	eax, 0FFFFFFFFh
		jmp	loc_416FC9
; ---------------------------------------------------------------------------

loc_416D9D:				; CODE XREF: .text:00416D91j
		add	dword ptr [ebp-10h], 1
		add	dword ptr [ebp-0Ch], 1

loc_416DA5:				; CODE XREF: .text:00416D7Dj
		cmp	dword ptr [ebp-10h], 0Eh
		jle	short loc_416D7F
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_416DF4
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_416DD6
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_416DF4

loc_416DD6:				; CODE XREF: .text:00416DBDj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_416DF4
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ch
		jz	short loc_416DF4
		mov	eax, 0FFFFFFFFh
		jmp	loc_416FC9
; ---------------------------------------------------------------------------

loc_416DF4:				; CODE XREF: .text:00416DB3j
					; .text:00416DD4j ...
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 3E8h
		lea	edx, [eax-0BB80h]
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 64h
		sub	eax, 12C0h
		lea	ecx, [edx+eax]
		mov	eax, [ebp+8]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		add	eax, ecx
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-18h], eax
		mov	eax, [ebp+8]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-1Ch], eax
		mov	eax, [ebp+8]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Ah
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-20h], eax
		mov	eax, [ebp+8]
		add	eax, 0Bh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Ch
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-24h], eax
		mov	eax, [ebp+8]
		add	eax, 0Dh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Eh
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-28h], eax
		cmp	dword ptr [ebp-14h], 7B1h
		jle	short loc_416F6F
		cmp	dword ptr [ebp-18h], 0
		jle	short loc_416F6F
		cmp	dword ptr [ebp-18h], 0Ch
		jg	short loc_416F6F
		cmp	dword ptr [ebp-1Ch], 0
		jle	short loc_416F6F
		cmp	dword ptr [ebp-1Ch], 1Fh
		jg	short loc_416F6F
		cmp	dword ptr [ebp-20h], 17h
		jg	short loc_416F6F
		cmp	dword ptr [ebp-24h], 3Bh
		jg	short loc_416F6F
		cmp	dword ptr [ebp-28h], 3Dh
		jle	short loc_416F76

loc_416F6F:				; CODE XREF: .text:00416F43j
					; .text:00416F49j ...
		mov	eax, 0FFFFFFFFh
		jmp	short loc_416FC9
; ---------------------------------------------------------------------------

loc_416F76:				; CODE XREF: .text:00416F6Dj
		lea	eax, [ebp-4Ch]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 9
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	eax, [ebp-28h]
		mov	[ebp-4Ch], eax
		mov	eax, [ebp-24h]
		mov	[ebp-48h], eax
		mov	eax, [ebp-20h]
		mov	[ebp-44h], eax
		mov	eax, [ebp-1Ch]
		mov	[ebp-40h], eax
		mov	eax, [ebp-18h]
		sub	eax, 1
		mov	[ebp-3Ch], eax
		mov	eax, [ebp-14h]
		sub	eax, 76Ch
		mov	[ebp-38h], eax
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		lea	eax, [ebp-4Ch]
		mov	[esp], eax
		call	sub_425C1E

loc_416FC9:				; CODE XREF: .text:00416D1Ej
					; .text:00416D4Bj ...
		add	esp, 60h
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+0Ch]
		test	eax, eax
		jns	short loc_416FE8
		mov	eax, [ebp+8]
		mov	byte ptr [eax],	0
		jmp	short loc_417055
; ---------------------------------------------------------------------------

loc_416FE8:				; CODE XREF: .text:00416FDEj
		lea	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_4277D0
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		mov	ebx, [eax]
		mov	eax, [ebp-1Ch]
		mov	ecx, [eax+4]
		mov	eax, [ebp-1Ch]
		mov	edx, [eax+8]
		mov	eax, [ebp-1Ch]
		mov	eax, [eax+0Ch]
		mov	esi, [ebp-1Ch]
		mov	esi, [esi+10h]
		lea	edi, [esi+1]
		mov	esi, [ebp-1Ch]
		mov	esi, [esi+14h]
		add	esi, 76Ch
		mov	[esp+20h], ebx
		mov	[esp+1Ch], ecx
		mov	[esp+18h], edx
		mov	[esp+14h], eax
		mov	[esp+10h], edi
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], offset a04d02d02dt02d0 ; "%04d%02d%02dT%02d%02d%02d"
		mov	dword ptr [esp+4], 10h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_416641

loc_417055:				; CODE XREF: .text:00416FE6j
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+0Ch]
		mov	[ebp-4], ax
		movzx	eax, word ptr [ebp-4]
		imul	eax, 15180h
		add	eax, [ebp+8]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+8]
		mov	[ebp-1Ch], eax
		mov	edx, 88888889h
		mov	eax, [ebp-1Ch]
		mul	edx
		mov	eax, edx
		shr	eax, 5
		mov	[ebp+8], eax
		mov	ecx, [ebp+8]
		mov	edx, 88888889h
		mov	eax, ecx
		mul	edx
		mov	eax, edx
		shr	eax, 5
		shl	eax, 2
		mov	edx, eax
		shl	edx, 4
		sub	edx, eax
		mov	eax, ecx
		sub	eax, edx
		mov	[ebp-0Ch], eax
		mov	edx, [ebp+8]
		mov	[ebp-1Ch], edx
		mov	edx, 88888889h
		mov	eax, [ebp-1Ch]
		mul	edx
		mov	eax, edx
		shr	eax, 5
		mov	[ebp+8], eax
		mov	ecx, [ebp+8]
		mov	edx, 0AAAAAAABh
		mov	eax, ecx
		mul	edx
		shr	edx, 4
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		mov	[ebp-1Ch], eax
		mov	edx, 0AAAAAAABh
		mov	eax, [ebp-1Ch]
		mul	edx
		mov	eax, edx
		shr	eax, 4
		mov	[ebp+8], eax
		mov	ecx, [ebp+8]
		mov	edx, 6719F361h
		mov	eax, ecx
		mul	edx
		mov	eax, ecx
		sub	eax, edx
		shr	eax, 1
		add	eax, edx
		shr	eax, 8
		imul	eax, 16Dh
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		mov	[ebp-14h], eax
		mov	ecx, [ebp+8]
		mov	edx, 6719F361h
		mov	eax, ecx
		mul	edx
		mov	eax, ecx
		sub	eax, edx
		shr	eax, 1
		add	eax, edx
		shr	eax, 8
		mov	[ebp+8], eax
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, offset aUyUdUhUm ;	"%uy%ud%uh%um"
		mov	edx, [ebp-0Ch]
		mov	[esp+14h], edx
		mov	edx, [ebp-10h]
		mov	[esp+10h], edx
		mov	edx, [ebp-14h]
		mov	[esp+0Ch], edx
		mov	edx, [ebp-18h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_4302E0
		call	sprintf
		cmp	dword ptr [ebp-18h], 0
		jz	short loc_41718E
		mov	eax, offset dword_4302E0
		jmp	short locret_4171C4
; ---------------------------------------------------------------------------

loc_41718E:				; CODE XREF: .text:00417185j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_4171AD
		mov	dword ptr [esp+4], 79h
		mov	dword ptr [esp], offset	dword_4302E0
		call	strchr
		add	eax, 1
		jmp	short locret_4171C4
; ---------------------------------------------------------------------------

loc_4171AD:				; CODE XREF: .text:00417192j
		mov	dword ptr [esp+4], 64h
		mov	dword ptr [esp], offset	dword_4302E0
		call	strchr
		add	eax, 1

locret_4171C4:				; CODE XREF: .text:0041718Cj
					; .text:004171ABj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		test	eax, eax
		jns	short loc_417206
		mov	eax, offset a???????? ;	"????-??-??"
		mov	edx, [eax]
		mov	ds:dword_4302D0, edx
		mov	edx, [eax+4]
		mov	ds:dword_4302D4, edx
		movzx	edx, word ptr [eax+8]
		mov	ds:word_4302D8,	dx
		movzx	eax, byte ptr [eax+0Ah]
		mov	ds:byte_4302DA,	al
		jmp	short loc_417250
; ---------------------------------------------------------------------------

loc_417206:				; CODE XREF: .text:004171D8j
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_4277D0
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+10h]
		lea	ebx, [eax+1]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+14h]
		lea	ecx, [eax+76Ch]
		mov	eax, offset a04d02d02d ; "%04d-%02d-%02d"
		mov	[esp+10h], edx
		mov	[esp+0Ch], ebx
		mov	[esp+8], ecx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_4302D0
		call	sprintf

loc_417250:				; CODE XREF: .text:00417204j
		mov	eax, offset dword_4302D0
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+8]
		mov	[ebp-20h], eax
		mov	eax, [ebp-20h]
		test	eax, eax
		jns	short loc_4172A3
		mov	eax, offset a?????????????? ; "????-??-?? ??:??:??"
		mov	edx, [eax]
		mov	ds:dword_4302B2, edx
		mov	edx, [eax+4]
		mov	ds:dword_4302B6, edx
		mov	edx, [eax+8]
		mov	ds:dword_4302BA, edx
		mov	edx, [eax+0Ch]
		mov	ds:dword_4302BE, edx
		mov	eax, [eax+10h]
		mov	ds:dword_4302C2, eax
		jmp	short loc_417310
; ---------------------------------------------------------------------------

loc_4172A3:				; CODE XREF: .text:0041726Fj
		lea	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_4277D0
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		mov	esi, [eax]
		mov	eax, [ebp-1Ch]
		mov	ebx, [eax+4]
		mov	eax, [ebp-1Ch]
		mov	ecx, [eax+8]
		mov	eax, [ebp-1Ch]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp-1Ch]
		mov	eax, [eax+10h]
		add	eax, 1
		mov	[ebp-2Ch], eax
		mov	eax, [ebp-1Ch]
		mov	eax, [eax+14h]
		lea	edi, [eax+76Ch]
		mov	eax, offset a04d02d02d02d02 ; "%04d-%02d-%02d %02d:%02d:%02d"
		mov	[esp+1Ch], esi
		mov	[esp+18h], ebx
		mov	[esp+14h], ecx
		mov	[esp+10h], edx
		mov	edx, [ebp-2Ch]
		mov	[esp+0Ch], edx
		mov	[esp+8], edi
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_4302B2
		call	sprintf

loc_417310:				; CODE XREF: .text:004172A1j
		mov	eax, offset dword_4302B2
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		test	eax, eax
		jns	short loc_417361
		mov	eax, offset a???????? ;	"????-??-??"
		mov	edx, [eax]
		mov	ds:dword_430280, edx
		mov	edx, [eax+4]
		mov	ds:dword_430284, edx
		movzx	edx, word ptr [eax+8]
		mov	ds:word_430288,	dx
		movzx	eax, byte ptr [eax+0Ah]
		mov	ds:byte_43028A,	al
		mov	eax, offset dword_430280
		jmp	short locret_41739F
; ---------------------------------------------------------------------------

loc_417361:				; CODE XREF: .text:0041732Ej
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_4277F0
		mov	[ebp-0Ch], eax
		mov	edx, [ebp-0Ch]
		mov	eax, offset aCZ	; "%c %Z"
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 31h
		mov	dword ptr [esp], offset	dword_430280
		call	strftime
		mov	ds:byte_4302B1,	0
		mov	eax, offset dword_430280

locret_41739F:				; CODE XREF: .text:0041735Fj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4173A1	proc near		; CODE XREF: sub_4175CB+8Dp

var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		and	eax, 3
		test	eax, eax
		setz	al
		movzx	eax, al
		mov	[ebp+var_8], eax
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		imul	eax, 64h
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		test	eax, eax
		jnz	short loc_417411
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 7
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		imul	eax, 190h
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		test	eax, eax
		jz	short loc_417411
		mov	[ebp+var_8], 0

loc_417411:				; CODE XREF: sub_4173A1+3Dj
					; sub_4173A1+67j
		cmp	[ebp+var_8], 0
		jz	short loc_41741E
		mov	eax, 16Eh
		jmp	short loc_417423
; ---------------------------------------------------------------------------

loc_41741E:				; CODE XREF: sub_4173A1+74j
		mov	eax, 16Dh

loc_417423:				; CODE XREF: sub_4173A1+7Bj
		add	esp, 10h
		pop	ebx
		pop	ebp
		retn
sub_4173A1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417429	proc near		; CODE XREF: sub_4175CB+105p
					; sub_4175CB+125p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		cmp	[ebp+arg_4], 0Ch
		ja	loc_417500
		mov	eax, [ebp+arg_4]
		mov	edx, 1
		mov	ebx, edx
		mov	ecx, eax
		shl	ebx, cl
		mov	eax, ebx
		mov	edx, eax
		and	edx, 15AAh
		test	edx, edx
		jnz	short loc_417472
		mov	edx, eax
		and	edx, 0A50h
		test	edx, edx
		jnz	loc_4174F9
		and	eax, 4
		test	eax, eax
		jnz	short loc_41747C
		jmp	loc_417500
; ---------------------------------------------------------------------------

loc_417472:				; CODE XREF: sub_417429+2Bj
		mov	eax, 1Fh
		jmp	loc_41751C
; ---------------------------------------------------------------------------

loc_41747C:				; CODE XREF: sub_417429+42j
		mov	eax, [ebp+arg_0]
		and	eax, 3
		test	eax, eax
		setz	al
		movzx	eax, al
		mov	[ebp+var_C], eax
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		imul	eax, 64h
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		test	eax, eax
		jnz	short loc_4174E5
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 7
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		imul	eax, 190h
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		test	eax, eax
		jz	short loc_4174E5
		mov	[ebp+var_C], 0

loc_4174E5:				; CODE XREF: sub_417429+89j
					; sub_417429+B3j
		cmp	[ebp+var_C], 0
		jz	short loc_4174F2
		mov	eax, 1Dh
		jmp	short loc_4174F7
; ---------------------------------------------------------------------------

loc_4174F2:				; CODE XREF: sub_417429+C0j
		mov	eax, 1Ch

loc_4174F7:				; CODE XREF: sub_417429+C7j
		jmp	short loc_41751C
; ---------------------------------------------------------------------------

loc_4174F9:				; CODE XREF: sub_417429+37j
		mov	eax, 1Eh
		jmp	short loc_41751C
; ---------------------------------------------------------------------------

loc_417500:				; CODE XREF: sub_417429+Bj
					; sub_417429+44j
		mov	[esp+28h+var_20], offset aDays_per_month ; "days_per_month"
		mov	[esp+28h+var_24], 191h
		mov	[esp+28h+var_28], offset a____Gnupg22__8 ; "../../gnupg2-2.0.30/common/gettime.c"
		call	sub_420AAC
; ---------------------------------------------------------------------------

loc_41751C:				; CODE XREF: sub_417429+4Ej
					; sub_417429:loc_4174F7j ...
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_417429	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417522	proc near		; CODE XREF: sub_4175CB+76p
					; sub_4175CB+E7p ...

var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		imul	ecx, eax, 16Dh
		mov	eax, [ebp+arg_4]
		lea	edx, [eax-1]
		mov	eax, edx
		shl	eax, 5
		sub	eax, edx
		add	eax, ecx
		add	eax, [ebp+arg_8]
		add	eax, 1A42E4h
		mov	[ebp+var_8], eax
		cmp	[ebp+arg_4], 2
		jg	short loc_417558
		sub	[ebp+arg_0], 1
		jmp	short loc_41757B
; ---------------------------------------------------------------------------

loc_417558:				; CODE XREF: sub_417522+2Ej
		mov	eax, [ebp+arg_4]
		shl	eax, 2
		lea	ecx, [eax+17h]
		mov	edx, 66666667h
		mov	eax, ecx
		imul	edx
		sar	edx, 2
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		sub	[ebp+var_8], eax

loc_41757B:				; CODE XREF: sub_417522+34j
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+3]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 2
		mov	ebx, eax
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		lea	edx, [eax+1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		lea	edx, [eax+3]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 2
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		add	[ebp+var_8], eax
		mov	eax, [ebp+var_8]
		add	esp, 10h
		pop	ebx
		pop	ebp
		retn
sub_417522	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4175CB	proc near		; CODE XREF: .text:00417B70p
					; .text:00417DE4p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_0], 0
		jnz	short loc_4175E1
		mov	eax, 0
		jmp	locret_417767
; ---------------------------------------------------------------------------

loc_4175E1:				; CODE XREF: sub_4175CB+Aj
		cmp	[ebp+arg_0], 1A4450h
		jbe	short loc_4175F3
		cmp	[ebp+arg_0], 2B61CDh
		jbe	short loc_4175FD

loc_4175F3:				; CODE XREF: sub_4175CB+1Dj
		mov	eax, 0
		jmp	locret_417767
; ---------------------------------------------------------------------------

loc_4175FD:				; CODE XREF: sub_4175CB+26j
		mov	eax, [ebp+arg_0]
		sub	eax, 1A42E4h
		mov	[ebp+var_1C], eax
		mov	edx, 0B30F6353h
		mov	eax, [ebp+var_1C]
		mul	edx
		mov	eax, edx
		shr	eax, 8
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		jmp	short loc_41762D
; ---------------------------------------------------------------------------

loc_417629:				; CODE XREF: sub_4175CB+95j
		add	[ebp+var_C], 1

loc_41762D:				; CODE XREF: sub_4175CB+5Cj
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_417522
		mov	edx, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_4173A1
		cmp	[ebp+var_18], eax
		jg	short loc_417629
		mov	ecx, [ebp+var_18]
		mov	edx, 84210843h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 4
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_41769E
; ---------------------------------------------------------------------------

loc_417689:				; CODE XREF: sub_4175CB+10Dj
		add	[ebp+var_10], 1
		cmp	[ebp+var_10], 0Ch
		jle	short loc_41769E
		mov	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_41769E:				; CODE XREF: sub_4175CB+BCj
					; sub_4175CB+C6j
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_417522
		mov	edx, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_417429
		cmp	[ebp+var_18], eax
		jg	short loc_417689
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_417429
		cmp	eax, [ebp+var_14]
		jge	short loc_417705
		mov	[ebp+var_14], 1
		add	[ebp+var_10], 1

loc_417705:				; CODE XREF: sub_4175CB+12Dj
		cmp	[ebp+var_10], 0Ch
		jle	short loc_417716
		mov	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_417716:				; CODE XREF: sub_4175CB+13Ej
		cmp	[ebp+arg_4], 0
		jz	short loc_417724
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[eax], edx

loc_417724:				; CODE XREF: sub_4175CB+14Fj
		cmp	[ebp+arg_8], 0
		jz	short loc_417732
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_417732:				; CODE XREF: sub_4175CB+15Dj
		cmp	[ebp+arg_C], 0
		jz	short loc_417740
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_14]
		mov	[eax], edx

loc_417740:				; CODE XREF: sub_4175CB+16Bj
		mov	[esp+38h+var_30], 1
		mov	[esp+38h+var_34], 1
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_417522
		mov	edx, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1

locret_417767:				; CODE XREF: sub_4175CB+11j
					; sub_4175CB+2Dj
		leave
		retn
sub_4175CB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417769	proc near		; CODE XREF: .text:004178ACp
					; .text:00417C0Fp

var_14		= dword	ptr -14h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41778A
		mov	[esp+14h+var_14], 1Ah
		call	sub_416983
		jmp	locret_417823
; ---------------------------------------------------------------------------

loc_41778A:				; CODE XREF: sub_417769+Ej
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	[ebp+var_4], 0
		jmp	short loc_4177C3
; ---------------------------------------------------------------------------

loc_417799:				; CODE XREF: sub_417769+5Ej
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4177AD
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_4177BB

loc_4177AD:				; CODE XREF: sub_417769+38j
		mov	[esp+14h+var_14], 0A1h
		call	sub_416983
		jmp	short locret_417823
; ---------------------------------------------------------------------------

loc_4177BB:				; CODE XREF: sub_417769+42j
		add	[ebp+var_4], 1
		add	[ebp+var_8], 1

loc_4177C3:				; CODE XREF: sub_417769+2Ej
		cmp	[ebp+var_4], 7
		jle	short loc_417799
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 54h
		jz	short loc_4177E1
		mov	[esp+14h+var_14], 0A1h
		call	sub_416983
		jmp	short locret_417823
; ---------------------------------------------------------------------------

loc_4177E1:				; CODE XREF: sub_417769+68j
		add	[ebp+var_8], 1
		mov	[ebp+var_4], 9
		jmp	short loc_417818
; ---------------------------------------------------------------------------

loc_4177EE:				; CODE XREF: sub_417769+B3j
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_417802
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_417810

loc_417802:				; CODE XREF: sub_417769+8Dj
		mov	[esp+14h+var_14], 0A1h
		call	sub_416983
		jmp	short locret_417823
; ---------------------------------------------------------------------------

loc_417810:				; CODE XREF: sub_417769+97j
		add	[ebp+var_4], 1
		add	[ebp+var_8], 1

loc_417818:				; CODE XREF: sub_417769+83j
		cmp	[ebp+var_4], 0Eh
		jle	short loc_4177EE
		mov	eax, 0

locret_417823:				; CODE XREF: sub_417769+1Cj
					; sub_417769+50j ...
		leave
		retn
sub_417769	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_41783D
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_417853

loc_41783D:				; CODE XREF: .text:00417831j
		mov	dword ptr [esp], offset	aNone ;	"[none]"
		call	sub_420034
		mov	[esp], eax
		call	sub_4209E4
		jmp	short loc_417898
; ---------------------------------------------------------------------------

loc_417853:				; CODE XREF: .text:0041783Bj
		mov	eax, [ebp+8]
		lea	esi, [eax+0Dh]
		mov	eax, [ebp+8]
		lea	ebx, [eax+0Bh]
		mov	eax, [ebp+8]
		lea	ecx, [eax+9]
		mov	eax, [ebp+8]
		lea	edx, [eax+6]
		mov	eax, [ebp+8]
		add	eax, 4
		mov	[esp+18h], esi
		mov	[esp+14h], ebx
		mov	[esp+10h], ecx
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a_4s_2s_2s_2s_2	; "%.4s-%.2s-%.2s %.2s:%.2s:%s"
		call	sub_4209E4

loc_417898:				; CODE XREF: .text:00417851j
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 64h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_417769
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_4178C2
		mov	eax, [ebp-0Ch]
		jmp	loc_417BFC
; ---------------------------------------------------------------------------

loc_4178C2:				; CODE XREF: .text:004178B8j
		cmp	dword ptr [ebp+0Ch], 0
		js	short loc_4178D1
		cmp	dword ptr [ebp+0Ch], 7FFFFFC1h
		jle	short loc_4178E2

loc_4178D1:				; CODE XREF: .text:004178C6j
		mov	dword ptr [esp], 37h
		call	sub_416983
		jmp	loc_417BFC
; ---------------------------------------------------------------------------

loc_4178E2:				; CODE XREF: .text:004178CFj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 3E8h
		lea	edx, [eax-0BB80h]
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 64h
		sub	eax, 12C0h
		lea	ecx, [edx+eax]
		mov	eax, [ebp+8]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		add	eax, ecx
		mov	[ebp-24h], eax
		mov	eax, [ebp+8]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-28h], eax
		mov	eax, [ebp+8]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-2Ch], eax
		mov	eax, [ebp+8]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Ah
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		add	eax, 0Bh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Ch
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		add	eax, 0Dh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Eh
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-18h], eax
		mov	eax, [ebp-24h]
		cmp	eax, 62Eh
		jg	short loc_417A45
		mov	dword ptr [esp], 37h
		call	sub_416983
		jmp	loc_417BFC
; ---------------------------------------------------------------------------

loc_417A45:				; CODE XREF: .text:00417A32j
		mov	eax, [ebp+0Ch]
		add	[ebp-18h], eax
		mov	ecx, [ebp-18h]
		mov	edx, 88888889h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp-14h], eax
		mov	ecx, [ebp-18h]
		mov	edx, 88888889h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		shl	eax, 2
		mov	edx, eax
		shl	edx, 4
		sub	edx, eax
		mov	eax, ecx
		sub	eax, edx
		mov	[ebp-18h], eax
		mov	ecx, [ebp-14h]
		mov	edx, 88888889h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp-10h], eax
		mov	ecx, [ebp-14h]
		mov	edx, 88888889h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		shl	eax, 2
		mov	edx, eax
		shl	edx, 4
		sub	edx, eax
		mov	eax, ecx
		sub	eax, edx
		mov	[ebp-14h], eax
		mov	ecx, [ebp-10h]
		mov	edx, 2AAAAAABh
		mov	eax, ecx
		imul	edx
		sar	edx, 2
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-1Ch], eax
		mov	ecx, [ebp-10h]
		mov	edx, 2AAAAAABh
		mov	eax, ecx
		imul	edx
		sar	edx, 2
		mov	eax, ecx
		sar	eax, 1Fh
		sub	edx, eax
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		mov	[ebp-10h], eax
		mov	ecx, [ebp-2Ch]
		mov	edx, [ebp-28h]
		mov	eax, [ebp-24h]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_417522
		mov	edx, [ebp-1Ch]
		add	eax, edx
		mov	[ebp-20h], eax
		lea	eax, [ebp-2Ch]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-28h]
		mov	[esp+8], eax
		lea	eax, [ebp-24h]
		mov	[esp+4], eax
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_4175CB
		mov	eax, [ebp-24h]
		cmp	eax, 270Fh
		jg	short loc_417BA4
		mov	eax, [ebp-28h]
		cmp	eax, 0Ch
		jg	short loc_417BA4
		mov	eax, [ebp-2Ch]
		cmp	eax, 1Fh
		jg	short loc_417BA4
		mov	eax, [ebp-24h]
		test	eax, eax
		js	short loc_417BA4
		mov	eax, [ebp-28h]
		test	eax, eax
		jle	short loc_417BA4
		mov	eax, [ebp-2Ch]
		test	eax, eax
		jg	short loc_417BB2

loc_417BA4:				; CODE XREF: .text:00417B7Dj
					; .text:00417B85j ...
		mov	dword ptr [esp], 37h
		call	sub_416983
		jmp	short loc_417BFC
; ---------------------------------------------------------------------------

loc_417BB2:				; CODE XREF: .text:00417BA2j
		mov	ecx, [ebp-2Ch]
		mov	edx, [ebp-28h]
		mov	eax, [ebp-24h]
		mov	ebx, [ebp-18h]
		mov	[esp+20h], ebx
		mov	ebx, [ebp-14h]
		mov	[esp+1Ch], ebx
		mov	ebx, [ebp-10h]
		mov	[esp+18h], ebx
		mov	[esp+14h], ecx
		mov	[esp+10h], edx
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset a04d02d02dt02d0 ; "%04d%02d%02dT%02d%02d%02d"
		mov	dword ptr [esp+4], 10h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_416641
		mov	eax, 0

loc_417BFC:				; CODE XREF: .text:004178BDj
					; .text:004178DDj ...
		add	esp, 64h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 54h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_417769
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_417C25
		mov	eax, [ebp-0Ch]
		jmp	loc_417E70
; ---------------------------------------------------------------------------

loc_417C25:				; CODE XREF: .text:00417C1Bj
		cmp	dword ptr [ebp+0Ch], 0
		js	short loc_417C34
		cmp	dword ptr [ebp+0Ch], 37D771h
		jle	short loc_417C45

loc_417C34:				; CODE XREF: .text:00417C29j
		mov	dword ptr [esp], 37h
		call	sub_416983
		jmp	loc_417E70
; ---------------------------------------------------------------------------

loc_417C45:				; CODE XREF: .text:00417C32j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 3E8h
		lea	edx, [eax-0BB80h]
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 64h
		sub	eax, 12C0h
		lea	ecx, [edx+eax]
		mov	eax, [ebp+8]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		add	eax, ecx
		mov	[ebp-20h], eax
		mov	eax, [ebp+8]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-24h], eax
		mov	eax, [ebp+8]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-28h], eax
		mov	eax, [ebp+8]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Ah
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		add	eax, 0Bh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Ch
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		add	eax, 0Dh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Eh
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-18h], eax
		mov	eax, [ebp-20h]
		cmp	eax, 62Eh
		jg	short loc_417DA8
		mov	dword ptr [esp], 37h
		call	sub_416983
		jmp	loc_417E70
; ---------------------------------------------------------------------------

loc_417DA8:				; CODE XREF: .text:00417D95j
		mov	ecx, [ebp-28h]
		mov	edx, [ebp-24h]
		mov	eax, [ebp-20h]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_417522
		mov	edx, [ebp+0Ch]
		add	eax, edx
		mov	[ebp-1Ch], eax
		lea	eax, [ebp-28h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-24h]
		mov	[esp+8], eax
		lea	eax, [ebp-20h]
		mov	[esp+4], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_4175CB
		mov	eax, [ebp-20h]
		cmp	eax, 270Fh
		jg	short loc_417E18
		mov	eax, [ebp-24h]
		cmp	eax, 0Ch
		jg	short loc_417E18
		mov	eax, [ebp-28h]
		cmp	eax, 1Fh
		jg	short loc_417E18
		mov	eax, [ebp-20h]
		test	eax, eax
		js	short loc_417E18
		mov	eax, [ebp-24h]
		test	eax, eax
		jle	short loc_417E18
		mov	eax, [ebp-28h]
		test	eax, eax
		jg	short loc_417E26

loc_417E18:				; CODE XREF: .text:00417DF1j
					; .text:00417DF9j ...
		mov	dword ptr [esp], 37h
		call	sub_416983
		jmp	short loc_417E70
; ---------------------------------------------------------------------------

loc_417E26:				; CODE XREF: .text:00417E16j
		mov	ecx, [ebp-28h]
		mov	edx, [ebp-24h]
		mov	eax, [ebp-20h]
		mov	ebx, [ebp-18h]
		mov	[esp+20h], ebx
		mov	ebx, [ebp-14h]
		mov	[esp+1Ch], ebx
		mov	ebx, [ebp-10h]
		mov	[esp+18h], ebx
		mov	[esp+14h], ecx
		mov	[esp+10h], edx
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset a04d02d02dt02d0 ; "%04d%02d%02dT%02d%02d%02d"
		mov	dword ptr [esp+4], 10h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_416641
		mov	eax, 0

loc_417E70:				; CODE XREF: .text:00417C20j
					; .text:00417C40j ...
		add	esp, 54h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417E78	proc near		; CODE XREF: sub_417E9F+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_417E98
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_417E9D
; ---------------------------------------------------------------------------

loc_417E98:				; CODE XREF: sub_417E78+7j
		mov	eax, 0

loc_417E9D:				; CODE XREF: sub_417E78+1Ej
		pop	ebp
		retn
sub_417E78	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417E9F	proc near		; CODE XREF: sub_417EBA+14p
					; sub_417ED5+Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_417E78
		leave
		retn
sub_417E9F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417EBA	proc near		; CODE XREF: sub_418448+C3p
					; sub_418448+17Ep ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gpg_err_code_from_errno
		mov	[esp+18h+var_18], eax
		call	sub_417E9F
		leave
		retn
sub_417EBA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417ED5	proc near		; CODE XREF: sub_4188FD+73Cp
					; sub_4188FD+78Bp ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_417E9F
		leave
		retn
sub_417ED5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_417EEA(LPCSTR)
sub_417EEA	proc near		; CODE XREF: sub_41B864+CFp

lpLibFileName	= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+lpLibFileName], eax ; lpLibFileName
		mov	eax, ds:LoadLibraryA
		call	eax ; LoadLibraryA
		sub	esp, 4
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_417EEA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_417F08(HMODULE, LPCSTR)
sub_417F08	proc near		; CODE XREF: sub_41B864+EBp

hModule		= dword	ptr -28h
lpProcName	= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_417F46
		cmp	[ebp+arg_4], 0
		jz	short loc_417F46
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lpProcName], eax ; lpProcName
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hModule], eax ; hModule
		mov	eax, ds:GetProcAddress
		call	eax ; GetProcAddress
		sub	esp, 8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_417F41
		mov	eax, 0
		jmp	short locret_417F4B
; ---------------------------------------------------------------------------

loc_417F41:				; CODE XREF: sub_417F08+30j
		mov	eax, [ebp+var_C]
		jmp	short locret_417F4B
; ---------------------------------------------------------------------------

loc_417F46:				; CODE XREF: sub_417F08+Aj
					; sub_417F08+10j
		mov	eax, 0

locret_417F4B:				; CODE XREF: sub_417F08+37j
					; sub_417F08+3Cj
		leave
		retn
sub_417F08	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_417F4D(HANDLE)
sub_417F4D	proc near		; CODE XREF: sub_41B864+104p

hObject		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_417F70
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		jmp	short locret_417F75
; ---------------------------------------------------------------------------

loc_417F70:				; CODE XREF: sub_417F4D+Aj
		mov	eax, 0FFFFFFFFh

locret_417F75:				; CODE XREF: sub_417F4D+21j
		leave
		retn
sub_417F4D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417F77	proc near		; CODE XREF: sub_417FEA+70p
					; sub_4181BA+93p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		jmp	short loc_417FBC
; ---------------------------------------------------------------------------

loc_417F7C:				; CODE XREF: sub_417F77+57j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_417FB4
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_417FA0
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_417FB4

loc_417FA0:				; CODE XREF: sub_417F77+1Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_417FD0
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_417FD0

loc_417FB4:				; CODE XREF: sub_417F77+13j
					; sub_417F77+27j
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_417FBC:				; CODE XREF: sub_417F77+3j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_417FD0
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_417F7C

loc_417FD0:				; CODE XREF: sub_417F77+31j
					; sub_417F77+3Bj ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		pop	ebp
		retn
sub_417F77	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417FEA	proc near		; CODE XREF: sub_4180CF+23p
					; sub_4180CF+6Ap ...

hObject		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		cmp	dword ptr [ebp+arg_0], 0
		jnz	short loc_418019
		mov	[esp+28h+var_20], 0E2h ; int
		mov	[esp+28h+var_24], offset a____Gnupg22__9 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+28h+hObject], offset aFname ; "fname"
		call	sub_4276E0

loc_418019:				; CODE XREF: sub_417FEA+11j
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_418035
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+28h+var_24], eax ;	char
		mov	[esp+28h+hObject], offset aFd_cache_inval ; "fd_cache_invalidate (%s)\n"
		call	sub_4209BA

loc_418035:				; CODE XREF: sub_417FEA+36j
		mov	eax, ds:dword_430300
		mov	[ebp+var_C], eax
		jmp	short loc_4180B2
; ---------------------------------------------------------------------------

loc_41803F:				; CODE XREF: sub_417FEA+CCj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_4180AA
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+hObject], edx
		call	sub_417F77
		test	eax, eax
		jnz	short loc_4180AA
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_418082
		mov	eax, [ebp+var_C]
		add	eax, 8
		mov	[esp+28h+var_24], eax ;	char
		mov	[esp+28h+hObject], offset aDidS	; "		   did (%s)\n"
		call	sub_4209BA

loc_418082:				; CODE XREF: sub_417FEA+80j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+28h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		test	eax, eax
		jnz	short loc_4180A0
		mov	[ebp+var_10], 0FFFFFFFFh

loc_4180A0:				; CODE XREF: sub_417FEA+ADj
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4], 0FFFFFFFFh

loc_4180AA:				; CODE XREF: sub_417FEA+5Ej
					; sub_417FEA+77j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_4180B2:				; CODE XREF: sub_417FEA+53j
		cmp	[ebp+var_C], 0
		jnz	short loc_41803F
		mov	eax, [ebp+var_10]
		leave
		retn
sub_417FEA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4180BD	proc near		; CODE XREF: sub_41A174+2A2p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		mov	eax, [ebp+var_4]
		leave
		retn
sub_4180BD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4180CF(LPCSTR	lpFileName, char *)
sub_4180CF	proc near		; CODE XREF: sub_41831F+122p
					; .text:00419EBDp ...

Str		= dword	ptr -38h
Val		= dword	ptr -34h
dwShareMode	= dword	ptr -30h
lpSecurityAttributes= dword ptr	-2Ch
dwCreationDisposition= dword ptr -28h
dwFlagsAndAttributes= dword ptr	-24h
hTemplateFile	= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
dwDesiredAccess	= dword	ptr -0Ch
lpFileName	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+Val], 2Bh ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_41811C
		mov	eax, [ebp+lpFileName]
		mov	[esp+38h+Str], eax
		call	sub_417FEA
		test	eax, eax
		jz	short loc_418105
		mov	eax, 0FFFFFFFFh
		jmp	locret_4181B8
; ---------------------------------------------------------------------------

loc_418105:				; CODE XREF: sub_4180CF+2Aj
		mov	[ebp+dwDesiredAccess], 0C0000000h
		mov	[ebp+var_10], 3
		mov	[ebp+var_14], 3
		jmp	short loc_418175
; ---------------------------------------------------------------------------

loc_41811C:				; CODE XREF: sub_4180CF+1Bj
		mov	[esp+38h+Val], 77h ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_418160
		mov	eax, [ebp+lpFileName]
		mov	[esp+38h+Str], eax
		call	sub_417FEA
		test	eax, eax
		jz	short loc_418149
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4181B8
; ---------------------------------------------------------------------------

loc_418149:				; CODE XREF: sub_4180CF+71j
		mov	[ebp+dwDesiredAccess], 40000000h
		mov	[ebp+var_10], 2
		mov	[ebp+var_14], 2
		jmp	short loc_418175
; ---------------------------------------------------------------------------

loc_418160:				; CODE XREF: sub_4180CF+62j
		mov	[ebp+dwDesiredAccess], 80000000h
		mov	[ebp+var_10], 3
		mov	[ebp+var_14], 1

loc_418175:				; CODE XREF: sub_4180CF+4Bj
					; sub_4180CF+8Fj
		mov	[esp+38h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+38h+dwFlagsAndAttributes],	80h ; dwFlagsAndAttributes
		mov	eax, [ebp+var_10]
		mov	[esp+38h+dwCreationDisposition], eax ; dwCreationDisposition
		mov	[esp+38h+lpSecurityAttributes],	0 ; lpSecurityAttributes
		mov	eax, [ebp+var_14]
		mov	[esp+38h+dwShareMode], eax ; dwShareMode
		mov	eax, [ebp+dwDesiredAccess]
		mov	[esp+38h+Val], eax ; dwDesiredAccess
		mov	eax, [ebp+lpFileName]
		mov	[esp+38h+Str], eax ; lpFileName
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]

locret_4181B8:				; CODE XREF: sub_4180CF+31j
					; sub_4180CF+78j
		leave
		retn
sub_4180CF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4181BA(char *, HANDLE)
sub_4181BA	proc near		; CODE XREF: sub_418448+297p

hObject		= dword	ptr -38h
Source		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	[ebp+arg_4], 0
		jnz	short loc_4181E3
		mov	[esp+38h+var_30], 174h ; int
		mov	[esp+38h+Source], offset a____Gnupg22__9 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+38h+hObject], offset aFp ;	"fp"
		call	sub_4276E0

loc_4181E3:				; CODE XREF: sub_4181BA+Bj
		cmp	[ebp+arg_0], 0
		jz	short loc_4181F3
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_418228

loc_4181F3:				; CODE XREF: sub_4181BA+2Dj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	loc_418316
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Source], eax ;	char
		mov	[esp+38h+hObject], offset aFd_cache_close ; "fd_cache_close (%d) real\n"
		call	sub_4209BA
		jmp	loc_418316
; ---------------------------------------------------------------------------

loc_418228:				; CODE XREF: sub_4181BA+37j
		mov	eax, ds:dword_430300
		mov	[ebp+var_C], eax
		jmp	short loc_41828C
; ---------------------------------------------------------------------------

loc_418232:				; CODE XREF: sub_4181BA+D6j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_418284
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax
		mov	[esp+38h+hObject], edx
		call	sub_417F77
		test	eax, eax
		jnz	short loc_418284
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	loc_418319
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax ;	char
		mov	[esp+38h+hObject], offset aFd_cache_clo_0 ; "fd_cache_close (%s) used existing slot\"...
		call	sub_4209BA
		jmp	loc_418319
; ---------------------------------------------------------------------------

loc_418284:				; CODE XREF: sub_4181BA+81j
					; sub_4181BA+9Aj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_41828C:				; CODE XREF: sub_4181BA+76j
		cmp	[ebp+var_C], 0
		jnz	short loc_418232
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_4182AE
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax ;	char
		mov	[esp+38h+hObject], offset aFd_cache_clo_1 ; "fd_cache_close (%s) new slot created\n"
		call	sub_4209BA

loc_4182AE:				; CODE XREF: sub_4181BA+DFj
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 0Ch
		mov	[esp+38h+Source], eax
		mov	[esp+38h+hObject], 1
		call	gcry_xcalloc
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax ;	Source
		mov	[esp+38h+hObject], edx ; Dest
		call	strcpy
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	edx, ds:dword_430300
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	ds:dword_430300, eax
		jmp	short loc_41831A
; ---------------------------------------------------------------------------

loc_418316:				; CODE XREF: sub_4181BA+50j
					; sub_4181BA+69j
		nop
		jmp	short loc_41831A
; ---------------------------------------------------------------------------

loc_418319:				; CODE XREF: sub_4181BA+ACj
					; sub_4181BA+C5j
		nop

loc_41831A:				; CODE XREF: sub_4181BA+15Aj
					; sub_4181BA+15Dj
		mov	edi, [ebp+var_4]
		leave
		retn
sub_4181BA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41831F(LPCSTR	lpFileName, char *)
sub_41831F	proc near		; CODE XREF: sub_4199B9+A0p

hFile		= dword	ptr -28h
lDistanceToMove	= dword	ptr -24h
lpDistanceToMoveHigh= dword ptr	-20h
dwMoveMethod	= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
lpFileName	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+lpFileName], 0
		jnz	short loc_418347
		mov	[esp+28h+lpDistanceToMoveHigh],	19Dh ; int
		mov	[esp+28h+lDistanceToMove], offset a____Gnupg22__9 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+28h+hFile], offset	aFname ; "fname"
		call	sub_4276E0

loc_418347:				; CODE XREF: sub_41831F+Aj
		mov	eax, ds:dword_430300
		mov	[ebp+var_C], eax
		jmp	loc_41840E
; ---------------------------------------------------------------------------

loc_418354:				; CODE XREF: sub_41831F+F3j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jz	loc_418406
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+lpFileName]
		mov	[esp+28h+lDistanceToMove], eax
		mov	[esp+28h+hFile], edx
		call	sub_417F77
		test	eax, eax
		jnz	loc_418406
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4], 0FFFFFFFFh
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_4183AF
		mov	eax, [ebp+lpFileName]
		mov	[esp+28h+lDistanceToMove], eax ; char
		mov	[esp+28h+hFile], offset	aFd_cache_openS	; "fd_cache_open (%s) using cached fp\n"
		call	sub_4209BA

loc_4183AF:				; CODE XREF: sub_41831F+7Bj
		mov	[esp+28h+dwMoveMethod],	0 ; dwMoveMethod
		mov	[esp+28h+lpDistanceToMoveHigh],	0 ; lpDistanceToMoveHigh
		mov	[esp+28h+lDistanceToMove], 0 ; lDistanceToMove
		mov	eax, [ebp+var_10]
		mov	[esp+28h+hFile], eax ; hFile
		mov	eax, ds:SetFilePointer
		call	eax ; SetFilePointer
		sub	esp, 10h
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_418401
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+28h+lpDistanceToMoveHigh],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+lDistanceToMove], eax ; char
		mov	[esp+28h+hFile], offset	aRewindFileFail	; "rewind file failed on handle	%p: ec=%d\"...
		call	sub_42091D
		mov	[ebp+var_10], 0FFFFFFFFh

loc_418401:				; CODE XREF: sub_41831F+BBj
		mov	eax, [ebp+var_10]
		jmp	short locret_418446
; ---------------------------------------------------------------------------

loc_418406:				; CODE XREF: sub_41831F+3Ej
					; sub_41831F+5Bj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_41840E:				; CODE XREF: sub_41831F+30j
		cmp	[ebp+var_C], 0
		jnz	loc_418354
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_418434
		mov	eax, [ebp+lpFileName]
		mov	[esp+28h+lDistanceToMove], eax ; char
		mov	[esp+28h+hFile], offset	aFd_cache_ope_0	; "fd_cache_open (%s) not cached\n"
		call	sub_4209BA

loc_418434:				; CODE XREF: sub_41831F+100j
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lDistanceToMove], eax ; char *
		mov	eax, [ebp+lpFileName]
		mov	[esp+28h+hFile], eax ; lpFileName
		call	sub_4180CF

locret_418446:				; CODE XREF: sub_41831F+E5j
		leave
		retn
sub_41831F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_418448(int, int, int,	LPVOID,	int)
sub_418448	proc near		; CODE XREF: sub_4199B9+175p
					; sub_4199B9+19Fp ...

hFile		= dword	ptr -58h
lpBuffer	= dword	ptr -54h
nNumberOfBytesToRead= dword ptr	-50h
lpNumberOfBytesRead= dword ptr -4Ch
lpOverlapped	= dword	ptr -48h
NumberOfBytesWritten= dword ptr	-30h
NumberOfBytesRead= dword ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
nNumberOfBytesToWrite= dword ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	[ebp+var_20], eax
		mov	[ebp+nNumberOfBytesToWrite], 0
		mov	[ebp+var_10], 0
		cmp	[ebp+arg_4], 3
		jnz	loc_41855F
		cmp	[ebp+var_20], 0
		jnz	short loc_41849E
		mov	[esp+58h+nNumberOfBytesToRead],	226h ; int
		mov	[esp+58h+lpBuffer], offset a____Gnupg22__9 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+58h+hFile], offset	aSize ;	"size"
		call	sub_4276E0

loc_41849E:				; CODE XREF: sub_418448+38j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_4184BD
		mov	[ebp+var_10], 0FFFFFFFFh
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		jmp	loc_4186EF
; ---------------------------------------------------------------------------

loc_4184BD:				; CODE XREF: sub_418448+5Ej
		mov	[ebp+nNumberOfBytesToWrite], 0
		mov	[esp+58h+lpOverlapped],	0 ; lpOverlapped
		lea	eax, [ebp+NumberOfBytesRead]
		mov	[esp+58h+lpNumberOfBytesRead], eax ; lpNumberOfBytesRead
		mov	eax, [ebp+var_20]
		mov	[esp+58h+nNumberOfBytesToRead],	eax ; nNumberOfBytesToRead
		mov	eax, [ebp+arg_C]
		mov	[esp+58h+lpBuffer], eax	; lpBuffer
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+hFile], eax ; hFile
		mov	eax, ds:ReadFile
		call	eax ; ReadFile
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_418532
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 6Dh
		jz	short loc_418552
		mov	eax, [ebp+var_24]
		mov	[esp+58h+hFile], eax
		call	sub_417EBA
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_18]
		lea	edx, [eax+14h]
		mov	eax, [ebp+var_24]
		mov	[esp+58h+nNumberOfBytesToRead],	eax
		mov	[esp+58h+lpBuffer], edx	; char
		mov	[esp+58h+hFile], offset	aSReadErrorEcD ; "%s: read error: ec=%d\n"
		call	sub_42091D
		jmp	short loc_418552
; ---------------------------------------------------------------------------

loc_418532:				; CODE XREF: sub_418448+ABj
		mov	eax, [ebp+NumberOfBytesRead]
		test	eax, eax
		jnz	short loc_41854C
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+0Ch], 1
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_418552
; ---------------------------------------------------------------------------

loc_41854C:				; CODE XREF: sub_418448+EFj
		mov	eax, [ebp+NumberOfBytesRead]
		mov	[ebp+nNumberOfBytesToWrite], eax

loc_418552:				; CODE XREF: sub_418448+BBj
					; sub_418448+E8j ...
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+nNumberOfBytesToWrite]
		mov	[eax], edx
		jmp	loc_4186EF
; ---------------------------------------------------------------------------

loc_41855F:				; CODE XREF: sub_418448+2Ej
		cmp	[ebp+arg_4], 4
		jnz	loc_41861B
		cmp	[ebp+var_20], 0
		jz	loc_41860E
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+nNumberOfBytesToWrite], eax

loc_41857F:				; CODE XREF: sub_418448+1B5j
		cmp	[ebp+var_20], 0
		jz	short loc_4185ED
		mov	[esp+58h+lpOverlapped],	0 ; lpOverlapped
		lea	eax, [ebp+NumberOfBytesWritten]
		mov	[esp+58h+lpNumberOfBytesRead], eax ; lpNumberOfBytesWritten
		mov	eax, [ebp+nNumberOfBytesToWrite]
		mov	[esp+58h+nNumberOfBytesToRead],	eax ; nNumberOfBytesToWrite
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpBuffer], eax	; lpBuffer
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+hFile], eax ; hFile
		mov	eax, ds:WriteFile
		call	eax ; WriteFile
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_4185ED
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+hFile], eax
		call	sub_417EBA
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_18]
		lea	edx, [eax+14h]
		mov	eax, [ebp+var_28]
		mov	[esp+58h+nNumberOfBytesToRead],	eax
		mov	[esp+58h+lpBuffer], edx	; char
		mov	[esp+58h+hFile], offset	aSWriteErrorEcD	; "%s: write error: ec=%d\n"
		call	sub_42091D
		jmp	short loc_4185FF
; ---------------------------------------------------------------------------

loc_4185ED:				; CODE XREF: sub_418448+13Bj
					; sub_418448+16Cj
		mov	eax, [ebp+NumberOfBytesWritten]
		add	[ebp+var_14], eax
		mov	eax, [ebp+NumberOfBytesWritten]
		sub	[ebp+nNumberOfBytesToWrite], eax
		cmp	[ebp+nNumberOfBytesToWrite], 0
		jnz	short loc_41857F

loc_4185FF:				; CODE XREF: sub_418448+1A3j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+nNumberOfBytesToWrite], eax

loc_41860E:				; CODE XREF: sub_418448+125j
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+nNumberOfBytesToWrite]
		mov	[eax], edx
		jmp	loc_4186EF
; ---------------------------------------------------------------------------

loc_41861B:				; CODE XREF: sub_418448+11Bj
		cmp	[ebp+arg_4], 1
		jnz	short loc_418644
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+8], 0
		jmp	loc_4186EF
; ---------------------------------------------------------------------------

loc_418644:				; CODE XREF: sub_418448+1D7j
		cmp	[ebp+arg_4], 5
		jnz	short loc_418658
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], offset	aFile_filterFd ; "file_filter(fd)"
		jmp	loc_4186EF
; ---------------------------------------------------------------------------

loc_418658:				; CODE XREF: sub_418448+200j
		cmp	[ebp+arg_4], 2
		jnz	loc_4186EF
		mov	[esp+58h+hFile], 0FFFFFFF6h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		cmp	eax, [ebp+var_1C]
		jz	short loc_4186E4
		mov	[esp+58h+hFile], 0FFFFFFF5h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		cmp	eax, [ebp+var_1C]
		jz	short loc_4186E4
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_4186B4
		mov	eax, [ebp+var_18]
		lea	edx, [eax+14h]
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+nNumberOfBytesToRead],	eax
		mov	[esp+58h+lpBuffer], edx	; char
		mov	[esp+58h+hFile], offset	aSCloseHandleP ; "%s: close handle %p\n"
		call	sub_4209BA

loc_4186B4:				; CODE XREF: sub_418448+24Dj
		mov	eax, [ebp+var_18]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_4186E4
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_4186D0
		mov	eax, [ebp+var_18]
		add	eax, 14h
		jmp	short loc_4186D5
; ---------------------------------------------------------------------------

loc_4186D0:				; CODE XREF: sub_418448+27Ej
		mov	eax, 0

loc_4186D5:				; CODE XREF: sub_418448+286j
		mov	edx, [ebp+var_1C]
		mov	[esp+58h+lpBuffer], edx	; HANDLE
		mov	[esp+58h+hFile], eax ; char *
		call	sub_4181BA

loc_4186E4:				; CODE XREF: sub_418448+22Ej
					; sub_418448+244j ...
		mov	eax, [ebp+var_18]
		mov	[esp+58h+hFile], eax
		call	gcry_free

loc_4186EF:				; CODE XREF: sub_418448+70j
					; sub_418448+112j ...
		mov	eax, [ebp+var_10]
		leave
		retn
sub_418448	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4186F4(int, int, int,	char *,	int)
sub_4186F4	proc near		; CODE XREF: .text:00419D9Ap
					; .text:00419DC4p
					; DATA XREF: ...

s		= dword	ptr -48h
buf		= dword	ptr -44h
len		= dword	ptr -40h
flags		= dword	ptr -3Ch
var_2C		= byte ptr -2Ch
var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		cmp	[ebp+arg_4], 3
		jnz	loc_4187EB
		cmp	[ebp+var_1C], 0
		jnz	short loc_418742
		mov	[esp+48h+len], 2CEh ; int
		mov	[esp+48h+buf], offset a____Gnupg22__9 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+s], offset aSize ; "size"
		call	sub_4276E0

loc_418742:				; CODE XREF: sub_4186F4+30j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_418761
		mov	[ebp+var_10], 0FFFFFFFFh
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		jmp	loc_4188F8
; ---------------------------------------------------------------------------

loc_418761:				; CODE XREF: sub_4186F4+56j
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[esp+48h+flags], 0 ; flags
		mov	[esp+48h+len], edx ; len
		mov	edx, [ebp+arg_C]
		mov	[esp+48h+buf], edx ; buf
		mov	[esp+48h+s], eax ; s
		mov	eax, ds:recv
		call	eax ; recv
		sub	esp, 10h
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jnz	short loc_4187BF
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	dword ptr [ebp+var_24],	eax
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+48h+s], eax
		call	sub_417EBA
		mov	[ebp+var_10], eax
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+48h+buf], eax ; char
		mov	[esp+48h+s], offset aSocketReadErro ; "socket read error: ec=%d\n"
		call	sub_42091D
		jmp	short loc_4187DE
; ---------------------------------------------------------------------------

loc_4187BF:				; CODE XREF: sub_4186F4+9Cj
		cmp	[ebp+var_20], 0
		jnz	short loc_4187D8
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+0Ch], 1
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_4187DE
; ---------------------------------------------------------------------------

loc_4187D8:				; CODE XREF: sub_4186F4+CFj
		mov	eax, [ebp+var_20]
		mov	[ebp+var_C], eax

loc_4187DE:				; CODE XREF: sub_4186F4+C9j
					; sub_4186F4+E2j
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		jmp	loc_4188F8
; ---------------------------------------------------------------------------

loc_4187EB:				; CODE XREF: sub_4186F4+26j
		cmp	[ebp+arg_4], 4
		jnz	loc_418894
		cmp	[ebp+var_1C], 0
		jz	loc_41888A
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax

loc_41880B:				; CODE XREF: sub_4186F4+185j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[esp+48h+flags], 0 ; flags
		mov	[esp+48h+len], edx ; len
		mov	edx, [ebp+var_14]
		mov	[esp+48h+buf], edx ; buf
		mov	[esp+48h+s], eax ; s
		mov	eax, ds:send
		call	eax ; send
		sub	esp, 10h
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0FFFFFFFFh
		jnz	short loc_418869
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	dword ptr [ebp+var_2C],	eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+48h+s], eax
		call	sub_417EBA
		mov	[ebp+var_10], eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+48h+buf], eax ; char
		mov	[esp+48h+s], offset aSocketWriteErr ; "socket write error: ec=%d\n"
		call	sub_42091D
		jmp	short loc_41887B
; ---------------------------------------------------------------------------

loc_418869:				; CODE XREF: sub_4186F4+146j
		mov	eax, [ebp+var_28]
		add	[ebp+var_14], eax
		mov	eax, [ebp+var_28]
		sub	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41880B

loc_41887B:				; CODE XREF: sub_4186F4+173j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax

loc_41888A:				; CODE XREF: sub_4186F4+105j
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		jmp	short loc_4188F8
; ---------------------------------------------------------------------------

loc_418894:				; CODE XREF: sub_4186F4+FBj
		cmp	[ebp+arg_4], 1
		jnz	short loc_4188BA
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+8], 0
		jmp	short loc_4188F8
; ---------------------------------------------------------------------------

loc_4188BA:				; CODE XREF: sub_4186F4+1A4j
		cmp	[ebp+arg_4], 5
		jnz	short loc_4188CB
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], offset	aSock_filter ; "sock_filter"
		jmp	short loc_4188F8
; ---------------------------------------------------------------------------

loc_4188CB:				; CODE XREF: sub_4186F4+1CAj
		cmp	[ebp+arg_4], 2
		jnz	short loc_4188F8
		mov	eax, [ebp+var_18]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_4188ED
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[esp+48h+s], eax ; s
		mov	eax, ds:closesocket
		call	eax ; closesocket
		sub	esp, 4

loc_4188ED:				; CODE XREF: sub_4186F4+1E5j
		mov	eax, [ebp+var_18]
		mov	[esp+48h+s], eax
		call	gcry_free

loc_4188F8:				; CODE XREF: sub_4186F4+68j
					; sub_4186F4+F2j ...
		mov	eax, [ebp+var_10]
		leave
		retn
sub_4186F4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4188FD	proc near		; DATA XREF: .text:0041BDB9o
					; .text:0041BDF2o

Dst		= dword	ptr -48h
Src		= dword	ptr -44h
Size		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= byte ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	dword ptr [ebp+var_2C],	eax
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_30], eax
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_4], 3
		jnz	loc_418EC9
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+var_30]
		mov	[ebp+var_18], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_418958
		mov	[esp+48h+Size],	32Dh ; int
		mov	[esp+48h+Src], offset a____Gnupg22__9 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aSize ; "size"
		call	sub_4276E0

loc_418958:				; CODE XREF: sub_4188FD+3Dj
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	loc_418EA0
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_418EA0
; ---------------------------------------------------------------------------

loc_418972:				; CODE XREF: sub_4188FD+5ADj
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_418E86
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+0Ch]
		cmp	eax, 2
		jnz	short loc_4189AB
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 1
		cmp	[ebp+var_1C], 0
		jnz	loc_418EB2
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_418EB2
; ---------------------------------------------------------------------------

loc_4189AB:				; CODE XREF: sub_4188FD+8Cj
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_418DD0
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	short loc_4189D8
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+18h]
		mov	[ebp+var_10], eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+18h], 0
		jmp	short loc_418A56
; ---------------------------------------------------------------------------

loc_4189D8:				; CODE XREF: sub_4188FD+C4j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_4189F2
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_4189FF

loc_4189F2:				; CODE XREF: sub_4188FD+E3j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41B22E
		jmp	short loc_418A35
; ---------------------------------------------------------------------------

loc_4189FF:				; CODE XREF: sub_4188FD+F3j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_418A35:				; CODE XREF: sub_4188FD+100j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_418A56
		mov	[esp+48h+Dst], offset aBlock_filter1s ;	"block_filter: 1st length byte missing\n"
		call	sub_42091D
		mov	[ebp+var_14], 59h
		jmp	loc_418EBC
; ---------------------------------------------------------------------------

loc_418A56:				; CODE XREF: sub_4188FD+D9j
					; sub_4188FD+13Fj
		cmp	[ebp+var_10], 0BFh
		jg	short loc_418AA0
		mov	edx, [ebp+var_10]
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+0Ch], 2
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_418E86
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 1
		cmp	[ebp+var_1C], 0
		jnz	loc_418EB5
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_418EB5
; ---------------------------------------------------------------------------

loc_418AA0:				; CODE XREF: sub_4188FD+160j
		cmp	[ebp+var_10], 0DFh
		jg	loc_418B8D
		mov	eax, [ebp+var_10]
		sub	eax, 0C0h
		shl	eax, 8
		mov	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_418ADA
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_418AE7

loc_418ADA:				; CODE XREF: sub_4188FD+1CBj
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41B22E
		jmp	short loc_418B1D
; ---------------------------------------------------------------------------

loc_418AE7:				; CODE XREF: sub_4188FD+1DBj
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_418B1D:				; CODE XREF: sub_4188FD+1E8j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_418B3E
		mov	[esp+48h+Dst], offset aBlock_filter2n ;	"block_filter: 2nd length byte missing\n"
		call	sub_42091D
		mov	[ebp+var_14], 59h
		jmp	loc_418EBC
; ---------------------------------------------------------------------------

loc_418B3E:				; CODE XREF: sub_4188FD+227j
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		add	eax, edx
		lea	edx, [eax+0C0h]
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+0Ch], 2
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_418E86
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 1
		cmp	[ebp+var_1C], 0
		jnz	loc_418EB8
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_418EB8
; ---------------------------------------------------------------------------

loc_418B8D:				; CODE XREF: sub_4188FD+1AAj
		cmp	[ebp+var_10], 0FFh
		jnz	loc_418DB0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_418BB4
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_418BC4

loc_418BB4:				; CODE XREF: sub_4188FD+2A5j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41B22E
		shl	eax, 18h
		jmp	short loc_418BFD
; ---------------------------------------------------------------------------

loc_418BC4:				; CODE XREF: sub_4188FD+2B5j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 18h
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_418BFD:				; CODE XREF: sub_4188FD+2C5j
		mov	edx, dword ptr [ebp+var_2C]
		mov	[edx+4], eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_418C23
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_418C33

loc_418C23:				; CODE XREF: sub_4188FD+314j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41B22E
		shl	eax, 10h
		jmp	short loc_418C6C
; ---------------------------------------------------------------------------

loc_418C33:				; CODE XREF: sub_4188FD+324j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 10h
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_418C6C:				; CODE XREF: sub_4188FD+334j
		mov	edx, ebx
		or	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, dword ptr [ebp+var_2C]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_418C96
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_418CA6

loc_418C96:				; CODE XREF: sub_4188FD+387j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41B22E
		shl	eax, 8
		jmp	short loc_418CDF
; ---------------------------------------------------------------------------

loc_418CA6:				; CODE XREF: sub_4188FD+397j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 8
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_418CDF:				; CODE XREF: sub_4188FD+3A7j
		mov	edx, ebx
		or	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_418D03
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_418D10

loc_418D03:				; CODE XREF: sub_4188FD+3F4j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41B22E
		jmp	short loc_418D46
; ---------------------------------------------------------------------------

loc_418D10:				; CODE XREF: sub_4188FD+404j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_418D46:				; CODE XREF: sub_4188FD+411j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_418D67
		mov	[esp+48h+Dst], offset aBlock_filterIn ;	"block_filter: invalid 4 byte length\n"
		call	sub_42091D
		mov	[ebp+var_14], 59h
		jmp	loc_418EBC
; ---------------------------------------------------------------------------

loc_418D67:				; CODE XREF: sub_4188FD+450j
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		or	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+0Ch], 2
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_418E86
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 1
		cmp	[ebp+var_1C], 0
		jnz	loc_418EBB
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_418EBB
; ---------------------------------------------------------------------------

loc_418DB0:				; CODE XREF: sub_4188FD+297j
		mov	eax, [ebp+var_10]
		and	eax, 1Fh
		mov	edx, 1
		mov	ebx, edx
		mov	ecx, eax
		shl	ebx, cl
		mov	eax, ebx
		mov	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		jmp	loc_418E86
; ---------------------------------------------------------------------------

loc_418DD0:				; CODE XREF: sub_4188FD+B6j
		mov	[esp+48h+Size],	offset aBlock_filter ; "block_filter"
		mov	[esp+48h+Src], 386h
		mov	[esp+48h+Dst], offset a____Gnupg22__9 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_420AAC
; ---------------------------------------------------------------------------

loc_418DEC:				; CODE XREF: sub_4188FD+59Dj
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_C]
		cmp	edx, eax
		cmovbe	eax, edx
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_34]
		mov	[esp+48h+Size],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Src], eax ; char
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41B2D7
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_34]
		jge	short loc_418E63
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_418E2E
		mov	[ebp+var_10], 0

loc_418E2E:				; CODE XREF: sub_4188FD+528j
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		add	edx, eax
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_C]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+Size],	eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+48h+Src], eax ; char
		mov	[esp+48h+Dst], offset aBlock_filterPR ;	"block_filter %p: read error (size=%lu,a"...
		call	sub_42091D
		mov	[ebp+var_14], 59h
		jmp	short loc_418E86
; ---------------------------------------------------------------------------

loc_418E63:				; CODE XREF: sub_4188FD+522j
		mov	eax, [ebp+var_10]
		sub	[ebp+var_C], eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		sub	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		add	[ebp+var_18], eax
		mov	eax, [ebp+var_10]
		add	[ebp+var_1C], eax

loc_418E86:				; CODE XREF: sub_4188FD+7Dj
					; sub_4188FD+17Dj ...
		cmp	[ebp+var_14], 0
		jnz	short loc_418EA0
		cmp	[ebp+var_C], 0
		jz	short loc_418EA0
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_418DEC

loc_418EA0:				; CODE XREF: sub_4188FD+63j
					; sub_4188FD+70j ...
		cmp	[ebp+var_14], 0
		jnz	short loc_418EBC
		cmp	[ebp+var_C], 0
		jnz	loc_418972
		jmp	short loc_418EBC
; ---------------------------------------------------------------------------

loc_418EB2:				; CODE XREF: sub_4188FD+9Cj
					; sub_4188FD+A9j
		nop
		jmp	short loc_418EBC
; ---------------------------------------------------------------------------

loc_418EB5:				; CODE XREF: sub_4188FD+191j
					; sub_4188FD+19Ej
		nop
		jmp	short loc_418EBC
; ---------------------------------------------------------------------------

loc_418EB8:				; CODE XREF: sub_4188FD+27Ej
					; sub_4188FD+28Bj
		nop
		jmp	short loc_418EBC
; ---------------------------------------------------------------------------

loc_418EBB:				; CODE XREF: sub_4188FD+4A1j
					; sub_4188FD+4AEj
		nop

loc_418EBC:				; CODE XREF: sub_4188FD+154j
					; sub_4188FD+23Cj ...
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_1C]
		mov	[eax], edx
		jmp	loc_41942F
; ---------------------------------------------------------------------------

loc_418EC9:				; CODE XREF: sub_4188FD+26j
		cmp	[ebp+arg_4], 4
		jnz	loc_419172
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_419156
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+14h]
		add	eax, [ebp+var_C]
		mov	[ebp+var_28], eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+14h]
		cmp	eax, 200h
		jbe	short loc_418F16
		mov	[esp+48h+Size],	3A7h ; int
		mov	[esp+48h+Src], offset a____Gnupg22__9 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aABuflenOp_min_ ;	"a->buflen <= OP_MIN_PARTIAL_CHUNK"
		call	sub_4276E0

loc_418F16:				; CODE XREF: sub_4188FD+5FBj
		cmp	[ebp+var_28], 1FFh
		ja	short loc_418F79
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_418F3D
		mov	[esp+48h+Dst], 200h
		call	gcry_xmalloc
		mov	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+10h], edx

loc_418F3D:				; CODE XREF: sub_4188FD+62Aj
		mov	edx, [ebp+var_30]
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	ecx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+14h]
		add	eax, ecx
		mov	ecx, [ebp+var_C]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+14h]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+14h], edx
		jmp	loc_41942F
; ---------------------------------------------------------------------------

loc_418F79:				; CODE XREF: sub_4188FD+620j
		mov	eax, [ebp+var_30]
		mov	[ebp+var_18], eax

loc_418F7F:				; CODE XREF: sub_4188FD+7ACj
		mov	[ebp+var_20], 400h
		mov	[ebp+var_10], 0Ah
		jmp	short loc_418F96
; ---------------------------------------------------------------------------

loc_418F8F:				; CODE XREF: sub_4188FD+69Fj
		shl	[ebp+var_20], 1
		add	[ebp+var_10], 1

loc_418F96:				; CODE XREF: sub_4188FD+690j
		mov	eax, [ebp+var_20]
		cmp	eax, [ebp+var_28]
		jbe	short loc_418F8F
		mov	eax, [ebp+var_20]
		shr	eax, 1
		mov	[ebp+var_20], eax
		sub	[ebp+var_10], 1
		cmp	[ebp+var_10], 1Fh
		jle	short loc_418FCC
		mov	[esp+48h+Size],	3BFh ; int
		mov	[esp+48h+Src], offset a____Gnupg22__9 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aC0x1f ; "c <= 0x1f"
		call	sub_4276E0

loc_418FCC:				; CODE XREF: sub_4188FD+6B1j
		or	[ebp+var_10], 0E0h
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41B555
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+14h]
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_419051
		cmp	[ebp+var_24], 200h
		jz	short loc_419019
		mov	[esp+48h+Size],	3C4h ; int
		mov	[esp+48h+Src], offset a____Gnupg22__9 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aNOp_min_partia ;	"n == OP_MIN_PARTIAL_CHUNK"
		call	sub_4276E0

loc_419019:				; CODE XREF: sub_4188FD+6FEj
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	edx, [ebp+var_24]
		mov	[esp+48h+Size],	edx
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41B5FA
		test	eax, eax
		jz	short loc_419041
		call	sub_417ED5
		mov	[ebp+var_14], eax

loc_419041:				; CODE XREF: sub_4188FD+73Aj
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+var_24]
		sub	[ebp+var_28], eax

loc_419051:				; CODE XREF: sub_4188FD+6F5j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_20]
		jbe	short loc_419065
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax

loc_419065:				; CODE XREF: sub_4188FD+760j
		cmp	[ebp+var_24], 0
		jz	short loc_419090
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Size],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41B5FA
		test	eax, eax
		jz	short loc_419090
		call	sub_417ED5
		mov	[ebp+var_14], eax

loc_419090:				; CODE XREF: sub_4188FD+76Cj
					; sub_4188FD+789j
		mov	eax, [ebp+var_24]
		add	[ebp+var_18], eax
		mov	eax, [ebp+var_24]
		sub	[ebp+var_28], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4190AF
		cmp	[ebp+var_28], 1FFh
		ja	loc_418F7F

loc_4190AF:				; CODE XREF: sub_4188FD+7A3j
		cmp	[ebp+var_14], 0
		jnz	loc_41942F
		cmp	[ebp+var_28], 0
		jz	loc_41942F
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_4190E9
		mov	[esp+48h+Size],	3D5h ; int
		mov	[esp+48h+Src], offset a____Gnupg22__9 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aABuflen ; "!a->buflen"
		call	sub_4276E0

loc_4190E9:				; CODE XREF: sub_4188FD+7CEj
		cmp	[ebp+var_28], 1FFh
		jbe	short loc_41910E
		mov	[esp+48h+Size],	3D6h ; int
		mov	[esp+48h+Src], offset a____Gnupg22__9 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aNbytesOp_min_p ;	"nbytes	< OP_MIN_PARTIAL_CHUNK"
		call	sub_4276E0

loc_41910E:				; CODE XREF: sub_4188FD+7F3j
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_41912C
		mov	[esp+48h+Dst], 200h
		call	gcry_xmalloc
		mov	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+10h], edx

loc_41912C:				; CODE XREF: sub_4188FD+819j
		mov	edx, [ebp+var_18]
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	ecx, [ebp+var_28]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [ebp+var_28]
		mov	[eax+14h], edx
		jmp	loc_41942F
; ---------------------------------------------------------------------------

loc_419156:				; CODE XREF: sub_4188FD+5DEj
		mov	[esp+48h+Size],	offset aBlock_filter ; "block_filter"
		mov	[esp+48h+Src], 3DFh
		mov	[esp+48h+Dst], offset a____Gnupg22__9 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_420AAC
; ---------------------------------------------------------------------------

loc_419172:				; CODE XREF: sub_4188FD+5D0j
		cmp	[ebp+arg_4], 1
		jnz	loc_4191FF
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_419198
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+48h+Src], eax ; char
		mov	[esp+48h+Dst], offset aInitBlock_filt ;	"init block_filter %p\n"
		call	sub_4209BA

loc_419198:				; CODE XREF: sub_4188FD+886j
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_4191AE
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+8], 0
		jmp	short loc_4191DC
; ---------------------------------------------------------------------------

loc_4191AE:				; CODE XREF: sub_4188FD+8A3j
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax]
		cmp	eax, 1
		jnz	short loc_4191D0
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+4], 0
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+8], edx
		jmp	short loc_4191DC
; ---------------------------------------------------------------------------

loc_4191D0:				; CODE XREF: sub_4188FD+8B9j
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+8], edx

loc_4191DC:				; CODE XREF: sub_4188FD+8AFj
					; sub_4188FD+8D1j
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+10h], 0
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_41942F
; ---------------------------------------------------------------------------

loc_4191FF:				; CODE XREF: sub_4188FD+879j
		cmp	[ebp+arg_4], 5
		jnz	short loc_419213
		mov	eax, [ebp+var_30]
		mov	dword ptr [eax], offset	aBlock_filter_0	; "block_filter"
		jmp	loc_41942F
; ---------------------------------------------------------------------------

loc_419213:				; CODE XREF: sub_4188FD+906j
		cmp	[ebp+arg_4], 2
		jnz	loc_41942F
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	loc_4193F2
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_4193D6
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+14h]
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0BFh
		ja	short loc_419265
		mov	eax, [ebp+var_38]
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41B555
		mov	[ebp+var_14], eax
		jmp	loc_419358
; ---------------------------------------------------------------------------

loc_419265:				; CODE XREF: sub_4188FD+94Cj
		cmp	[ebp+var_38], 20BFh
		ja	short loc_4192BE
		mov	eax, [ebp+var_38]
		sub	eax, 0C0h
		shr	eax, 8
		add	eax, 0C0h
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41B555
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	loc_419358
		mov	eax, [ebp+var_38]
		sub	eax, 0C0h
		and	eax, 0FFh
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41B555
		mov	[ebp+var_14], eax
		jmp	loc_419358
; ---------------------------------------------------------------------------

loc_4192BE:				; CODE XREF: sub_4188FD+96Fj
		mov	[esp+48h+Src], 0FFh
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41B555
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_419358
		mov	eax, [ebp+var_38]
		shr	eax, 18h
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41B555
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_419358
		mov	eax, [ebp+var_38]
		shr	eax, 10h
		and	eax, 0FFh
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41B555
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_419358
		mov	eax, [ebp+var_38]
		shr	eax, 8
		and	eax, 0FFh
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41B555
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_419358
		mov	eax, [ebp+var_38]
		and	eax, 0FFh
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41B555
		mov	[ebp+var_14], eax

loc_419358:				; CODE XREF: sub_4188FD+963j
					; sub_4188FD+997j ...
		cmp	[ebp+var_14], 0
		jnz	short loc_419383
		cmp	[ebp+var_38], 0
		jz	short loc_419383
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	edx, [ebp+var_38]
		mov	[esp+48h+Size],	edx
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41B5FA
		mov	[ebp+var_14], eax

loc_419383:				; CODE XREF: sub_4188FD+A5Fj
					; sub_4188FD+A65j
		cmp	[ebp+var_14], 0
		jz	short loc_4193B2
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+48h+Dst], eax ; int
		call	strerror
		mov	[esp+48h+Src], eax ; char
		mov	[esp+48h+Dst], offset aBlock_filterWr ;	"block_filter: write error: %s\n"
		call	sub_42091D
		call	sub_417ED5
		mov	[ebp+var_14], eax

loc_4193B2:				; CODE XREF: sub_4188FD+A8Aj
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	[esp+48h+Dst], eax
		call	gcry_free
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+10h], 0
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_419408
; ---------------------------------------------------------------------------

loc_4193D6:				; CODE XREF: sub_4188FD+936j
		mov	[esp+48h+Size],	offset aBlock_filter ; "block_filter"
		mov	[esp+48h+Src], 423h
		mov	[esp+48h+Dst], offset a____Gnupg22__9 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_420AAC
; ---------------------------------------------------------------------------

loc_4193F2:				; CODE XREF: sub_4188FD+928j
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_419408
		mov	[esp+48h+Dst], offset aBlock_filterPe ;	"block_filter: pending bytes!\n"
		call	sub_42091D

loc_419408:				; CODE XREF: sub_4188FD+AD7j
					; sub_4188FD+AFDj
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_419424
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+48h+Src], eax ; char
		mov	[esp+48h+Dst], offset aFreeBlock_filt ;	"free block_filter %p\n"
		call	sub_4209BA

loc_419424:				; CODE XREF: sub_4188FD+B12j
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+48h+Dst], eax
		call	gcry_free

loc_41942F:				; CODE XREF: sub_4188FD+5C7j
					; sub_4188FD+677j ...
		mov	eax, [ebp+var_14]
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_4188FD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419438	proc near		; CODE XREF: .text:00419518p
					; sub_41A451+2CBp ...

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	eax, ds:dword_430988
		test	eax, eax
		jnz	loc_4194FA
		jmp	loc_419504
; ---------------------------------------------------------------------------

loc_419453:				; CODE XREF: sub_419438+C6j
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], offset aNone_0 ; "[none]"
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_41949A
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	edx, [ebp+var_1C]
		mov	[esp+48h+var_38], edx
		lea	edx, [ebp+var_20]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], 0
		mov	dword ptr [esp+48h+var_44], 5
		mov	[esp+48h+var_48], eax
		call	ecx

loc_41949A:				; CODE XREF: sub_419438+31j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	edi, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	esi, eax
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+38h]
		mov	eax, [ebp+var_20]
		test	eax, eax
		jz	short loc_4194BC
		mov	eax, [ebp+var_20]
		jmp	short loc_4194C1
; ---------------------------------------------------------------------------

loc_4194BC:				; CODE XREF: sub_419438+7Dj
		mov	eax, offset a?_0 ; "?"

loc_4194C1:				; CODE XREF: sub_419438+82j
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+48h+var_30], edi
		mov	[esp+48h+var_34], esi
		mov	[esp+48h+var_38], ebx
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], ecx
		mov	dword ptr [esp+48h+var_44], edx	; char
		mov	[esp+48h+var_48], offset aIobufChainD_DS ; "iobuf chain: %d.%d `%s' filter_eof=%d s"...
		call	sub_4209BA
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_4194FA:				; CODE XREF: sub_419438+10j
		cmp	[ebp+arg_0], 0
		jnz	loc_419453

loc_419504:				; CODE XREF: sub_419438+16j
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_419438	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_419438
		mov	eax, 0
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419524	proc near		; CODE XREF: .text:0041984Ep
					; .text:0041986Fp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_24], 68h
		mov	[esp+28h+var_28], 1
		call	gcry_xcalloc
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	gcry_xmalloc
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax+34h], edx
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+28h], edx
		mov	eax, ds:dword_430310
		add	eax, 1
		mov	ds:dword_430310, eax
		mov	edx, ds:dword_430310
		mov	eax, [ebp+var_C]
		mov	[eax+54h], edx
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+58h], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+60h], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4Ch], 0
		mov	eax, [ebp+var_C]
		leave
		retn
sub_419524	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4195A1	proc near		; CODE XREF: .text:0040BE8Ap
					; .text:0041980Cp

File		= dword	ptr -38h
Val		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	[ebp+var_14], 0
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_0], 0
		jz	loc_419750
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_419750
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+38h+File],	eax ; File
		call	fclose
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+38h+File],	eax
		call	gcry_free
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_419609
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+File],	offset aIobuf_closeP ; "iobuf_close -> %p\n"
		call	sub_4209BA

loc_419609:				; CODE XREF: sub_4195A1+50j
		mov	eax, 0
		jmp	loc_419763
; ---------------------------------------------------------------------------

loc_419613:				; CODE XREF: sub_4195A1+1B9j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_419655
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+File],	eax
		call	sub_41B0C0
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_419655
		mov	eax, [ebp+var_C]
		mov	[esp+38h+File],	eax
		call	gpg_strerror
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+File],	offset aIobuf_flushFai ; "iobuf_flush failed on	close: %s\n"
		call	sub_42091D

loc_419655:				; CODE XREF: sub_4195A1+83j
					; sub_4195A1+97j
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_419699
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_419670
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		jmp	short loc_419675
; ---------------------------------------------------------------------------

loc_419670:				; CODE XREF: sub_4195A1+C5j
		mov	eax, offset a?_0 ; "?"

loc_419675:				; CODE XREF: sub_4195A1+CDj
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+38h+var_2C], eax
		mov	[esp+38h+Size],	ecx
		mov	[esp+38h+Val], edx ; char
		mov	[esp+38h+File],	offset aIobufD_DCloseS ; "iobuf-%d.%d: close `%s'\n"
		call	sub_4209BA

loc_419699:				; CODE XREF: sub_4195A1+BBj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_4196F9
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ecx, [ebp+var_14]
		mov	[esp+38h+var_28], ecx
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Val], 2
		mov	[esp+38h+File],	eax
		call	ebx
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4196F9
		mov	eax, [ebp+var_C]
		mov	[esp+38h+File],	eax
		call	gpg_strerror
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+File],	offset aIobufctrl_free ; "IOBUFCTRL_FREE failed	on close: %s\n"
		call	sub_42091D

loc_4196F9:				; CODE XREF: sub_4195A1+100j
					; sub_4195A1+13Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+38h+File],	eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		test	eax, eax
		jz	short loc_41973F
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+28h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Val], 0 ; Val
		mov	[esp+38h+File],	eax ; Dst
		call	memset
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+38h+File],	eax
		call	gcry_free

loc_41973F:				; CODE XREF: sub_4195A1+16Ej
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+File],	eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_0], eax

loc_419750:				; CODE XREF: sub_4195A1+19j
					; sub_4195A1+27j
		cmp	[ebp+arg_0], 0
		jz	short loc_419760
		cmp	[ebp+var_C], 0
		jz	loc_419613

loc_419760:				; CODE XREF: sub_4195A1+1B3j
		mov	eax, [ebp+var_C]

loc_419763:				; CODE XREF: sub_4195A1+6Dj
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_4195A1	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	dword ptr [ebp-10h], 0
		cmp	dword ptr [ebp+8], 0
		jz	short loc_4197B3
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_4197B3
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41BC8E
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_4197B3
		mov	eax, [ebp-14h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4197B3
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	gcry_xstrdup
		mov	[ebp-10h], eax

loc_4197B3:				; CODE XREF: .text:0041977Bj
					; .text:00419785j ...
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_419800
; ---------------------------------------------------------------------------

loc_4197BB:				; CODE XREF: .text:00419804j
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_4197F7
		mov	eax, [ebp-0Ch]
		mov	ebx, [eax+40h]
		mov	eax, [ebp-0Ch]
		mov	edx, [eax+50h]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+44h]
		lea	ecx, [ebp-1Ch]
		mov	[esp+10h], ecx
		mov	dword ptr [esp+0Ch], 0
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 6
		mov	[esp], eax
		call	ebx

loc_4197F7:				; CODE XREF: .text:004197C3j
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+50h]
		mov	[ebp-0Ch], eax

loc_419800:				; CODE XREF: .text:004197B9j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4197BB
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4195A1
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_419830
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	remove
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	gcry_free

loc_419830:				; CODE XREF: .text:00419818j
		mov	eax, [ebp-18h]
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2000h
		mov	dword ptr [esp], 3
		call	sub_419524
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	sub_419524
		mov	[ebp-0Ch], eax
		mov	edx, [ebp+8]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+34h]
		mov	ecx, [ebp+0Ch]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp-0Ch]
		mov	edx, [ebp+0Ch]
		mov	[eax+30h], edx
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_430304, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4198AE(char *)
sub_4198AE	proc near		; CODE XREF: sub_419926+30p
					; sub_4199B9+5Cp ...

Str		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_430304
		test	eax, eax
		jz	short loc_41991F
		cmp	[ebp+arg_0], 0
		jz	short loc_41991F
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_41991F
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 26h
		jnz	short loc_41991F
		add	[ebp+arg_0], 2
		mov	[ebp+var_C], 0
		jmp	short loc_4198EB
; ---------------------------------------------------------------------------

loc_4198E7:				; CODE XREF: sub_4198AE+55j
		add	[ebp+var_C], 1

loc_4198EB:				; CODE XREF: sub_4198AE+37j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_419905
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_4198E7

loc_419905:				; CODE XREF: sub_4198AE+48j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41991F
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	atoi
		jmp	short locret_419924
; ---------------------------------------------------------------------------

loc_41991F:				; CODE XREF: sub_4198AE+Dj
					; sub_4198AE+13j ...
		mov	eax, 0FFFFFFFFh

locret_419924:				; CODE XREF: sub_4198AE+6Fj
		leave
		retn
sub_4198AE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_419926(char *)
sub_419926	proc near		; CODE XREF: .text:0040BD91p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_419949
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_419950
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_419950

loc_419949:				; CODE XREF: sub_419926+Aj
		mov	eax, 1
		jmp	short locret_419964
; ---------------------------------------------------------------------------

loc_419950:				; CODE XREF: sub_419926+14j
					; sub_419926+21j
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_4198AE
		cmp	eax, 0FFFFFFFFh
		setnz	al
		movzx	eax, al

locret_419964:				; CODE XREF: sub_419926+28j
		leave
		retn
sub_419926	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0FFFFFFFFh
		jnz	short loc_419982
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_4199B9
		mov	[ebp-0Ch], eax
		jmp	short loc_4199B4
; ---------------------------------------------------------------------------

loc_419982:				; CODE XREF: .text:00419970j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	_dup
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_41999F
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_4199B4
; ---------------------------------------------------------------------------

loc_41999F:				; CODE XREF: .text:00419994j
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_419BA0
		mov	[ebp-0Ch], eax

loc_4199B4:				; CODE XREF: .text:00419980j
					; .text:0041999Dj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4199B9(LPCSTR	lpFileName)
sub_4199B9	proc near		; CODE XREF: .text:0040BDB0p
					; .text:00419978p

nStdHandle	= dword	ptr -58h
Source		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
lpFileName	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	[ebp+var_20], 0
		mov	[ebp+var_10], 0
		cmp	[ebp+lpFileName], 0
		jz	short loc_4199EB
		mov	eax, [ebp+lpFileName]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_419A0F
		mov	eax, [ebp+lpFileName]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_419A0F

loc_4199EB:				; CODE XREF: sub_4199B9+19j
		mov	[esp+58h+nStdHandle], 0FFFFFFF6h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+var_C], eax
		mov	[ebp+lpFileName], offset aStdin_1 ; "[stdin]"
		mov	[ebp+var_10], 1
		jmp	short loc_419A71
; ---------------------------------------------------------------------------

loc_419A0F:				; CODE XREF: sub_4199B9+23j
					; sub_4199B9+30j
		mov	eax, [ebp+lpFileName]
		mov	[esp+58h+nStdHandle], eax ; char *
		call	sub_4198AE
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0FFFFFFFFh
		jz	short loc_419A4B
		mov	[esp+58h+Source], 0
		mov	eax, [ebp+var_14]
		mov	[esp+58h+nStdHandle], eax
		call	sub_41BFE6
		mov	[esp+58h+Source], offset aRb_0 ; "rb"
		mov	[esp+58h+nStdHandle], eax ; int
		call	sub_419BA0
		jmp	loc_419B9B
; ---------------------------------------------------------------------------

loc_419A4B:				; CODE XREF: sub_4199B9+68j
		mov	[esp+58h+Source], offset aRb_0 ; "rb"
		mov	eax, [ebp+lpFileName]
		mov	[esp+58h+nStdHandle], eax ; lpFileName
		call	sub_41831F
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_419A71
		mov	eax, 0
		jmp	loc_419B9B
; ---------------------------------------------------------------------------

loc_419A71:				; CODE XREF: sub_4199B9+54j
					; sub_4199B9+ACj
		mov	[esp+58h+Source], 2000h
		mov	[esp+58h+nStdHandle], 1
		call	sub_419524
		mov	[ebp+var_18], eax
		mov	eax, [ebp+lpFileName]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 18h
		mov	[esp+58h+nStdHandle], eax
		call	gcry_xmalloc
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_10]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_1C]
		lea	edx, [eax+14h]
		mov	eax, [ebp+lpFileName]
		mov	[esp+58h+Source], eax ;	Source
		mov	[esp+58h+nStdHandle], edx ; Dest
		call	strcpy
		cmp	[ebp+var_10], 0
		jnz	short loc_419AF4
		mov	eax, [ebp+lpFileName]
		mov	[esp+58h+nStdHandle], eax
		call	gcry_xstrdup
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+4Ch], edx

loc_419AF4:				; CODE XREF: sub_4199B9+126j
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+40h], offset sub_418448
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_1C]
		mov	[eax+44h], edx
		mov	eax, [ebp+var_18]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_48], eax ;	int
		mov	[esp+58h+var_4C], edx ;	LPVOID
		mov	[esp+58h+var_50], 0 ; int
		mov	[esp+58h+Source], 5 ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+nStdHandle], eax ; int
		call	sub_418448
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_48], eax ;	int
		mov	[esp+58h+var_4C], 0 ; LPVOID
		mov	[esp+58h+var_50], 0 ; int
		mov	[esp+58h+Source], 1 ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+nStdHandle], eax ; int
		call	sub_418448
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_419B98
		mov	eax, [ebp+var_1C]
		mov	eax, [eax]
		mov	ecx, eax
		mov	eax, [ebp+var_18]
		mov	edx, [eax+58h]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+54h]
		mov	[esp+58h+var_48], ecx
		mov	ecx, [ebp+lpFileName]
		mov	[esp+58h+var_4C], ecx
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+Source], eax ;	char
		mov	[esp+58h+nStdHandle], offset aIobufD_DOpenSF ; "iobuf-%d.%d: open `%s' fd=%d\n"
		call	sub_4209BA

loc_419B98:				; CODE XREF: sub_4199B9+1ABj
		mov	eax, [ebp+var_18]

loc_419B9B:				; CODE XREF: sub_4199B9+8Dj
					; sub_4199B9+B3j
		mov	edi, [ebp+var_4]
		leave
		retn
sub_4199B9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_419BA0(int, char *)
sub_419BA0	proc near		; CODE XREF: .text:004199ACp
					; sub_4199B9+88p ...

Str		= dword	ptr -38h
Val		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[esp+38h+Val], 77h ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_419BCA
		mov	eax, 2
		jmp	short loc_419BCF
; ---------------------------------------------------------------------------

loc_419BCA:				; CODE XREF: sub_419BA0+21j
		mov	eax, 1

loc_419BCF:				; CODE XREF: sub_419BA0+28j
		mov	[esp+38h+Val], 2000h
		mov	[esp+38h+Str], eax
		call	sub_419524
		mov	[ebp+var_10], eax
		mov	[esp+38h+Str], 2Ch
		call	gcry_xmalloc
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+10h], 1
		mov	eax, offset aFdD ; "[fd	%d]"
		mov	edx, [ebp+var_14]
		lea	ecx, [edx+14h]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Val], eax ; Format
		mov	[esp+38h+Str], ecx ; Dest
		call	sprintf
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+40h], offset sub_418448
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		mov	[eax+44h], edx
		mov	eax, [ebp+var_10]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_28], eax ;	int
		mov	[esp+38h+var_2C], edx ;	LPVOID
		mov	[esp+38h+var_30], 0 ; int
		mov	[esp+38h+Val], 5 ; int
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax ; int
		call	sub_418448
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_28], eax ;	int
		mov	[esp+38h+var_2C], 0 ; LPVOID
		mov	[esp+38h+var_30], 0 ; int
		mov	[esp+38h+Val], 1 ; int
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax ; int
		call	sub_418448
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_419CBD
		mov	eax, [ebp+var_14]
		lea	ecx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	edx, [eax+58h]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+54h]
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+Str], offset aIobufD_DFdopen ;	"iobuf-%d.%d: fdopen `%s'\n"
		call	sub_4209BA

loc_419CBD:				; CODE XREF: sub_419BA0+F1j
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], 1
		mov	[esp+38h+Val], 3
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax
		call	sub_41A174
		mov	eax, [ebp+var_10]
		leave
		retn
sub_419BA0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	dword ptr [esp+4], 77h
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	strchr
		test	eax, eax
		jz	short loc_419D09
		mov	eax, 2
		jmp	short loc_419D0E
; ---------------------------------------------------------------------------

loc_419D09:				; CODE XREF: .text:00419D00j
		mov	eax, 1

loc_419D0E:				; CODE XREF: .text:00419D07j
		mov	dword ptr [esp+4], 2000h
		mov	[esp], eax
		call	sub_419524
		mov	[ebp-0Ch], eax
		mov	dword ptr [esp], 31h
		call	gcry_xmalloc
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	edx, [ebp+8]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	dword ptr [eax+10h], 1
		mov	eax, offset aSockD ; "[sock %d]"
		mov	edx, [ebp-10h]
		lea	ecx, [edx+14h]
		mov	edx, [ebp+8]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], ecx
		call	sprintf
		mov	eax, [ebp-0Ch]
		mov	dword ptr [eax+40h], offset sub_4186F4
		mov	eax, [ebp-0Ch]
		mov	edx, [ebp-10h]
		mov	[eax+44h], edx
		mov	eax, [ebp-0Ch]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp-14h]
		mov	[esp+10h], eax
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 5
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_4186F4
		lea	eax, [ebp-14h]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_4186F4
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_419DFC
		mov	eax, [ebp-10h]
		lea	ecx, [eax+14h]
		mov	eax, [ebp-0Ch]
		mov	edx, [eax+58h]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+54h]
		mov	[esp+0Ch], ecx
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aIobufD_DSockop	; "iobuf-%d.%d:	sockopen `%s'\n"
		call	sub_4209BA

loc_419DFC:				; CODE XREF: .text:00419DD0j
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], 3
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_41A174
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	dword ptr [ebp-10h], 0
		cmp	dword ptr [ebp+8], 0
		jz	short loc_419E4F
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_419E73
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_419E73

loc_419E4F:				; CODE XREF: .text:00419E36j
		mov	dword ptr [esp], 0FFFFFFF5h
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp+8], offset aStdout_1 ; "[stdout]"
		mov	dword ptr [ebp-10h], 1
		jmp	short loc_419ED5
; ---------------------------------------------------------------------------

loc_419E73:				; CODE XREF: .text:00419E40j
					; .text:00419E4Dj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4198AE
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0FFFFFFFFh
		jz	short loc_419EAF
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_41BFE6
		mov	dword ptr [esp+4], offset aWb_0	; "wb"
		mov	[esp], eax
		call	sub_419BA0
		jmp	loc_41A008
; ---------------------------------------------------------------------------

loc_419EAF:				; CODE XREF: .text:00419E85j
		mov	dword ptr [esp+4], offset aWb_0	; "wb"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4180CF
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_419ED5
		mov	eax, 0
		jmp	loc_41A008
; ---------------------------------------------------------------------------

loc_419ED5:				; CODE XREF: .text:00419E71j
					; .text:00419EC9j
		mov	dword ptr [esp+4], 2000h
		mov	dword ptr [esp], 2
		call	sub_419524
		mov	[ebp-18h], eax
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 18h
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-1Ch]
		mov	edx, [ebp-10h]
		mov	[eax+10h], edx
		mov	eax, [ebp-1Ch]
		lea	edx, [eax+14h]
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	[esp], edx
		call	strcpy
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_419F58
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	gcry_xstrdup
		mov	edx, eax
		mov	eax, [ebp-18h]
		mov	[eax+4Ch], edx

loc_419F58:				; CODE XREF: .text:00419F43j
		mov	eax, [ebp-18h]
		mov	dword ptr [eax+40h], offset sub_418448
		mov	eax, [ebp-18h]
		mov	edx, [ebp-1Ch]
		mov	[eax+44h], edx
		mov	eax, [ebp-18h]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp-20h]
		mov	[esp+10h], eax
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 5
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_418448
		lea	eax, [ebp-20h]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_418448
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_41A005
		mov	eax, [ebp-18h]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_419FDC
		mov	eax, [ebp-18h]
		mov	eax, [eax+5Ch]
		jmp	short loc_419FE1
; ---------------------------------------------------------------------------

loc_419FDC:				; CODE XREF: .text:00419FD2j
		mov	eax, offset a?_0 ; "?"

loc_419FE1:				; CODE XREF: .text:00419FDAj
		mov	edx, [ebp-18h]
		mov	ecx, [edx+58h]
		mov	edx, [ebp-18h]
		mov	edx, [edx+54h]
		mov	[esp+0Ch], eax
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	dword ptr [esp], offset	aIobufD_DCreate	; "iobuf-%d.%d:	create `%s'\n"
		call	sub_4209BA

loc_41A005:				; CODE XREF: .text:00419FC8j
		mov	eax, [ebp-18h]

loc_41A008:				; CODE XREF: .text:00419EAAj
					; .text:00419ED0j
		mov	edi, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_41A024
		mov	eax, 0
		jmp	loc_41A16E
; ---------------------------------------------------------------------------

loc_41A024:				; CODE XREF: .text:0041A018j
		mov	dword ptr [esp+4], offset aRB ;	"r+b"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4180CF
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_41A04A
		mov	eax, 0
		jmp	loc_41A16E
; ---------------------------------------------------------------------------

loc_41A04A:				; CODE XREF: .text:0041A03Ej
		mov	dword ptr [esp+4], 2000h
		mov	dword ptr [esp], 2
		call	sub_419524
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 18h
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-14h]
		lea	edx, [eax+14h]
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	[esp], edx
		call	strcpy
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	gcry_xstrdup
		mov	edx, eax
		mov	eax, [ebp-10h]
		mov	[eax+4Ch], edx
		mov	eax, [ebp-10h]
		mov	dword ptr [eax+40h], offset sub_418448
		mov	eax, [ebp-10h]
		mov	edx, [ebp-14h]
		mov	[eax+44h], edx
		mov	eax, [ebp-10h]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp-18h]
		mov	[esp+10h], eax
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 5
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_418448
		lea	eax, [ebp-18h]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_418448
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_41A16B
		mov	eax, [ebp-10h]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_41A142
		mov	eax, [ebp-10h]
		mov	eax, [eax+5Ch]
		jmp	short loc_41A147
; ---------------------------------------------------------------------------

loc_41A142:				; CODE XREF: .text:0041A138j
		mov	eax, offset a?_0 ; "?"

loc_41A147:				; CODE XREF: .text:0041A140j
		mov	edx, [ebp-10h]
		mov	ecx, [edx+58h]
		mov	edx, [ebp-10h]
		mov	edx, [edx+54h]
		mov	[esp+0Ch], eax
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	dword ptr [esp], offset	aIobufD_DOpenrw	; "iobuf-%d.%d:	openrw `%s'\n"
		call	sub_4209BA

loc_41A16B:				; CODE XREF: .text:0041A12Ej
		mov	eax, [ebp-10h]

loc_41A16E:				; CODE XREF: .text:0041A01Fj
					; .text:0041A045j
		add	esp, 44h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A174	proc near		; CODE XREF: sub_419BA0+13Bp
					; .text:00419E1Ap

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		cmp	[ebp+arg_4], 1
		jnz	loc_41A270
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	loc_41A265
		cmp	[ebp+arg_0], 0
		jz	short loc_41A1AA
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_41A1AA
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+5Ch]
		jmp	short loc_41A1AF
; ---------------------------------------------------------------------------

loc_41A1AA:				; CODE XREF: sub_41A174+22j
					; sub_41A174+2Cj
		mov	ecx, offset a?_0 ; "?"

loc_41A1AF:				; CODE XREF: sub_41A174+34j
		cmp	[ebp+arg_0], 0
		jz	short loc_41A1BD
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		jmp	short loc_41A1C2
; ---------------------------------------------------------------------------

loc_41A1BD:				; CODE XREF: sub_41A174+3Fj
		mov	edx, 0FFFFFFFFh

loc_41A1C2:				; CODE XREF: sub_41A174+47j
		cmp	[ebp+arg_0], 0
		jz	short loc_41A1D0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		jmp	short loc_41A1D5
; ---------------------------------------------------------------------------

loc_41A1D0:				; CODE XREF: sub_41A174+52j
		mov	eax, 0FFFFFFFFh

loc_41A1D5:				; CODE XREF: sub_41A174+5Aj
		mov	ebx, [ebp+arg_8]
		mov	[esp+38h+var_28], ebx
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+var_30], edx
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aIobufD_DIoctlS ; "iobuf-%d.%d: ioctl `%s' keep=%d\n"
		call	sub_4209BA
		jmp	short loc_41A265
; ---------------------------------------------------------------------------

loc_41A1F6:				; CODE XREF: sub_41A174+F5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_41A229
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_418448
		jnz	short loc_41A229
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	[eax+4], edx
		mov	eax, 0
		jmp	loc_41A422
; ---------------------------------------------------------------------------

loc_41A229:				; CODE XREF: sub_41A174+8Aj
					; sub_41A174+97j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_41A25C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_4186F4
		jnz	short loc_41A25C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	[eax+4], edx
		mov	eax, 0
		jmp	loc_41A422
; ---------------------------------------------------------------------------

loc_41A25C:				; CODE XREF: sub_41A174+BDj
					; sub_41A174+CAj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_41A265:				; CODE XREF: sub_41A174+18j
					; sub_41A174+80j
		cmp	[ebp+arg_0], 0
		jnz	short loc_41A1F6
		jmp	loc_41A41D
; ---------------------------------------------------------------------------

loc_41A270:				; CODE XREF: sub_41A174+Bj
		cmp	[ebp+arg_4], 2
		jnz	short loc_41A2E0
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_41A29F
		cmp	dword ptr [ebp+arg_C], 0
		jz	short loc_41A28A
		mov	eax, dword ptr [ebp+arg_C]
		jmp	short loc_41A28F
; ---------------------------------------------------------------------------

loc_41A28A:				; CODE XREF: sub_41A174+10Fj
		mov	eax, offset a?_0 ; "?"

loc_41A28F:				; CODE XREF: sub_41A174+114j
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aIobuf_IoctlSIn ; "iobuf-*.*: ioctl `%s' invalidate\n"
		call	sub_4209BA

loc_41A29F:				; CODE XREF: sub_41A174+109j
		cmp	[ebp+arg_0], 0
		jnz	loc_41A41D
		cmp	[ebp+arg_8], 0
		jnz	loc_41A41D
		cmp	dword ptr [ebp+arg_C], 0
		jz	loc_41A41D
		mov	eax, dword ptr [ebp+arg_C]
		mov	[esp+38h+var_38], eax
		call	sub_417FEA
		test	eax, eax
		jz	short loc_41A2D6
		mov	eax, 0FFFFFFFFh
		jmp	loc_41A422
; ---------------------------------------------------------------------------

loc_41A2D6:				; CODE XREF: sub_41A174+156j
		mov	eax, 0
		jmp	loc_41A422
; ---------------------------------------------------------------------------

loc_41A2E0:				; CODE XREF: sub_41A174+100j
		cmp	[ebp+arg_4], 3
		jnz	loc_41A3CF
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	loc_41A3C7
		cmp	[ebp+arg_0], 0
		jz	short loc_41A30F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_41A30F
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+5Ch]
		jmp	short loc_41A314
; ---------------------------------------------------------------------------

loc_41A30F:				; CODE XREF: sub_41A174+187j
					; sub_41A174+191j
		mov	ecx, offset a?_0 ; "?"

loc_41A314:				; CODE XREF: sub_41A174+199j
		cmp	[ebp+arg_0], 0
		jz	short loc_41A322
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		jmp	short loc_41A327
; ---------------------------------------------------------------------------

loc_41A322:				; CODE XREF: sub_41A174+1A4j
		mov	edx, 0FFFFFFFFh

loc_41A327:				; CODE XREF: sub_41A174+1ACj
		cmp	[ebp+arg_0], 0
		jz	short loc_41A335
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		jmp	short loc_41A33A
; ---------------------------------------------------------------------------

loc_41A335:				; CODE XREF: sub_41A174+1B7j
		mov	eax, 0FFFFFFFFh

loc_41A33A:				; CODE XREF: sub_41A174+1BFj
		mov	ebx, [ebp+arg_8]
		mov	[esp+38h+var_28], ebx
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+var_30], edx
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aIobufD_DIoct_0 ; "iobuf-%d.%d: ioctl `%s' no_cache=%d\n"
		call	sub_4209BA
		jmp	short loc_41A3C7
; ---------------------------------------------------------------------------

loc_41A35B:				; CODE XREF: sub_41A174+257j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_41A38E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_418448
		jnz	short loc_41A38E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	[eax+8], edx
		mov	eax, 0
		jmp	loc_41A422
; ---------------------------------------------------------------------------

loc_41A38E:				; CODE XREF: sub_41A174+1EFj
					; sub_41A174+1FCj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_41A3BE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_4186F4
		jnz	short loc_41A3BE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+arg_8]
		mov	[eax+8], edx
		mov	eax, 0
		jmp	short loc_41A422
; ---------------------------------------------------------------------------

loc_41A3BE:				; CODE XREF: sub_41A174+222j
					; sub_41A174+22Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_41A3C7:				; CODE XREF: sub_41A174+17Dj
					; sub_41A174+1E5j
		cmp	[ebp+arg_0], 0
		jnz	short loc_41A35B
		jmp	short loc_41A41D
; ---------------------------------------------------------------------------

loc_41A3CF:				; CODE XREF: sub_41A174+170j
		cmp	[ebp+arg_4], 4
		jnz	short loc_41A41D
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_41A3FE
		cmp	dword ptr [ebp+arg_C], 0
		jz	short loc_41A3E9
		mov	eax, dword ptr [ebp+arg_C]
		jmp	short loc_41A3EE
; ---------------------------------------------------------------------------

loc_41A3E9:				; CODE XREF: sub_41A174+26Ej
		mov	eax, offset aNull_0 ; "<null>"

loc_41A3EE:				; CODE XREF: sub_41A174+273j
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aIobuf_IoctlSFs ; "iobuf-*.*: ioctl `%s' fsync\n"
		call	sub_4209BA

loc_41A3FE:				; CODE XREF: sub_41A174+268j
		cmp	[ebp+arg_0], 0
		jnz	short loc_41A41D
		cmp	[ebp+arg_8], 0
		jnz	short loc_41A41D
		cmp	dword ptr [ebp+arg_C], 0
		jz	short loc_41A41D
		mov	eax, dword ptr [ebp+arg_C]
		mov	[esp+38h+var_38], eax
		call	sub_4180BD
		jmp	short loc_41A422
; ---------------------------------------------------------------------------

loc_41A41D:				; CODE XREF: sub_41A174+F7j
					; sub_41A174+12Fj ...
		mov	eax, 0FFFFFFFFh

loc_41A422:				; CODE XREF: sub_41A174+B0j
					; sub_41A174+E3j ...
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_41A174	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A428	proc near		; CODE XREF: .text:0041BE00p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_41A451
		leave
		retn
sub_41A428	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A451	proc near		; CODE XREF: sub_41A428+22p

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	[ebp+var_24], 0
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_41A48E
		mov	[esp+48h+var_40], offset aIobuf_push_fil ; "iobuf_push_filter2"
		mov	dword ptr [esp+48h+var_44], 653h
		mov	[esp+48h+var_48], offset a____Gnupg22__9 ; "../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_420AAC
; ---------------------------------------------------------------------------

loc_41A48E:				; CODE XREF: sub_41A451+1Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_41A4B4
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41B0C0
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_41A4B4
		mov	eax, [ebp+var_1C]
		jmp	loc_41A784
; ---------------------------------------------------------------------------

loc_41A4B4:				; CODE XREF: sub_41A451+45j
					; sub_41A451+59j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+58h]
		cmp	eax, 3Fh
		jle	short loc_41A4D5
		mov	[esp+48h+var_48], offset aIOFilterTooDee ; "i/o	filter too deeply nested - corrupte"...
		call	sub_42091D
		mov	eax, 59h
		jmp	loc_41A784
; ---------------------------------------------------------------------------

loc_41A4D5:				; CODE XREF: sub_41A451+6Cj
		mov	[esp+48h+var_48], 68h
		call	gcry_xmalloc
		mov	[ebp+var_20], eax
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_20]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_41A506
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_41A506:				; CODE XREF: sub_41A451+A5j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_41A51E
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_41A51E:				; CODE XREF: sub_41A451+BCj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_41A546
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_41A546:				; CODE XREF: sub_41A451+E8j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_41A554
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_41A554:				; CODE XREF: sub_41A451+FAj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		test	eax, eax
		jz	short loc_41A56E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+48h+var_48], eax
		call	gcry_xstrdup
		jmp	short loc_41A573
; ---------------------------------------------------------------------------

loc_41A56E:				; CODE XREF: sub_41A451+10Bj
		mov	eax, 0

loc_41A573:				; CODE XREF: sub_41A451+11Bj
		mov	edx, [ebp+var_20]
		mov	[edx+4Ch], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+40h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+44h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+48h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+38h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 3
		jnz	short loc_41A5B4
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 2

loc_41A5B4:				; CODE XREF: sub_41A451+158j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_41A5EA
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[esp+48h+var_48], eax
		call	gcry_xmalloc
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[eax+34h], edx
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+2Ch], 0
		jmp	short loc_41A614
; ---------------------------------------------------------------------------

loc_41A5EA:				; CODE XREF: sub_41A451+16Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[esp+48h+var_48], eax
		call	gcry_xmalloc
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+34h], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0

loc_41A614:				; CODE XREF: sub_41A451+197j
		mov	eax, [ebp+var_20]
		mov	ecx, [eax+18h]
		mov	ebx, [eax+1Ch]
		mov	eax, [ebp+var_20]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+arg_0]
		mov	[ecx+18h], eax
		mov	[ecx+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		mov	ecx, [ebp+arg_0]
		mov	[ecx+8], eax
		mov	[ecx+0Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	edx, eax
		and	edx, 0FFFFFFFEh
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_20]
		mov	[eax+50h], edx
		mov	eax, [ebp+var_20]
		mov	edx, [eax+60h]
		mov	eax, [ebp+arg_0]
		mov	[eax+60h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+40h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[eax+44h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_C]
		mov	[eax+48h], edx
		mov	eax, [ebp+var_20]
		mov	eax, [eax+58h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+58h], edx
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp+var_24]
		mov	[esp+48h+var_38], eax
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], 0
		mov	dword ptr [esp+48h+var_44], 5
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_48], eax
		mov	eax, [ebp+arg_4]
		call	eax
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_41A721
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_41A6ED
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		jmp	short loc_41A6F2
; ---------------------------------------------------------------------------

loc_41A6ED:				; CODE XREF: sub_41A451+292j
		mov	eax, offset a?_0 ; "?"

loc_41A6F2:				; CODE XREF: sub_41A451+29Aj
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], ecx
		mov	dword ptr [esp+48h+var_44], edx	; char
		mov	[esp+48h+var_48], offset aIobufD_DPushS	; "iobuf-%d.%d:	push `%s'\n"
		call	sub_4209BA
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_419438

loc_41A721:				; CODE XREF: sub_41A451+288j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_41A781
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ecx, [ebp+var_24]
		mov	[esp+48h+var_38], ecx
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], edx
		mov	dword ptr [esp+48h+var_44], 1
		mov	[esp+48h+var_48], eax
		call	ebx
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_41A781
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aIobufctrl_init ; "IOBUFCTRL_INIT failed: %s\n"
		call	sub_42091D

loc_41A781:				; CODE XREF: sub_41A451+2D8j
					; sub_41A451+313j
		mov	eax, [ebp+var_1C]

loc_41A784:				; CODE XREF: sub_41A451+5Ej
					; sub_41A451+7Fj
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_41A451	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A78C	proc near		; CODE XREF: .text:0041B73Bp
					; .text:0041B7CBp ...

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	[ebp+var_24], 0
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_41A7C9
		mov	[esp+48h+var_40], offset aPop_filter ; "pop_filter"
		mov	[esp+48h+var_44], 6AAh
		mov	[esp+48h+var_48], offset a____Gnupg22__9 ; "../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_420AAC
; ---------------------------------------------------------------------------

loc_41A7C9:				; CODE XREF: sub_41A78C+1Fj
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_41A80D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_41A7E4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		jmp	short loc_41A7E9
; ---------------------------------------------------------------------------

loc_41A7E4:				; CODE XREF: sub_41A78C+4Ej
		mov	eax, offset a?_0 ; "?"

loc_41A7E9:				; CODE XREF: sub_41A78C+56j
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], ecx
		mov	[esp+48h+var_44], edx ;	char
		mov	[esp+48h+var_48], offset aIobufD_DPopS ; "iobuf-%d.%d: pop `%s'\n"
		call	sub_4209BA

loc_41A80D:				; CODE XREF: sub_41A78C+44j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jnz	loc_41A8E7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_41A846
		mov	[esp+48h+var_40], 6B2h ; int
		mov	[esp+48h+var_44], offset a____Gnupg22__9 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+var_48], offset aB ; "b"
		call	sub_4276E0

loc_41A846:				; CODE XREF: sub_41A78C+9Cj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_41A884
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_41A884:				; CODE XREF: sub_41A78C+E8j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_41A89C
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_41A89C:				; CODE XREF: sub_41A78C+FFj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_41A8C4
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_41A8C4:				; CODE XREF: sub_41A78C+12Bj
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_41A8D2
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_41A8D2:				; CODE XREF: sub_41A78C+13Dj
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_41AB1B
; ---------------------------------------------------------------------------

loc_41A8E7:				; CODE XREF: sub_41A78C+89j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], eax
		jmp	short loc_41A914
; ---------------------------------------------------------------------------

loc_41A8EF:				; CODE XREF: sub_41A78C+18Cj
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+40h]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_41A90B
		cmp	[ebp+arg_8], 0
		jz	short loc_41A91A
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+44h]
		cmp	eax, [ebp+arg_8]
		jz	short loc_41A91A

loc_41A90B:				; CODE XREF: sub_41A78C+16Cj
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+50h]
		mov	[ebp+var_1C], eax

loc_41A914:				; CODE XREF: sub_41A78C+161j
		cmp	[ebp+var_1C], 0
		jnz	short loc_41A8EF

loc_41A91A:				; CODE XREF: sub_41A78C+172j
					; sub_41A78C+17Dj
		cmp	[ebp+var_1C], 0
		jnz	short loc_41A92C
		mov	[esp+48h+var_48], offset aPop_filterFilt ; "pop_filter(): filter function not found"...
		call	sub_42098D
; ---------------------------------------------------------------------------

loc_41A92C:				; CODE XREF: sub_41A78C+192j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_41A96D
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	sub_41B0C0
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_41A96D
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aIobuf_flushF_0 ; "iobuf_flush	failed in pop_filter: %s\n"
		call	sub_42091D
		mov	eax, [ebp+var_20]
		jmp	loc_41AB1B
; ---------------------------------------------------------------------------

loc_41A96D:				; CODE XREF: sub_41A78C+1A8j
					; sub_41A78C+1BCj
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_41A9D5
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax+40h]
		mov	eax, [ebp+var_1C]
		mov	edx, [eax+50h]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+44h]
		lea	ecx, [ebp+var_24]
		mov	[esp+48h+var_38], ecx
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], 2
		mov	[esp+48h+var_48], eax
		call	ebx
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_41A9D5
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aIobufctrl_fr_0 ; "IOBUFCTRL_FREE failed: %s\n"
		call	sub_42091D
		mov	eax, [ebp+var_20]
		jmp	loc_41AB1B
; ---------------------------------------------------------------------------

loc_41A9D5:				; CODE XREF: sub_41A78C+1E9j
					; sub_41A78C+224j
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+44h]
		test	eax, eax
		jz	short loc_41AA01
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+48h]
		test	eax, eax
		jz	short loc_41AA01
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+44h]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_1C]
		mov	dword ptr [eax+44h], 0

loc_41AA01:				; CODE XREF: sub_41A78C+251j
					; sub_41A78C+25Bj
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+var_1C]
		jnz	short loc_41AA1F
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_41AA1F
		mov	[esp+48h+var_48], offset aCanTRemoveTheL ; "can't remove the last filter from the c"...
		call	sub_42098D
; ---------------------------------------------------------------------------

loc_41AA1F:				; CODE XREF: sub_41A78C+27Bj
					; sub_41A78C+285j
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+var_1C]
		jnz	loc_41AAF6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_41AA72
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_41AA72:				; CODE XREF: sub_41A78C+2D6j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_41AA8A
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_41AA8A:				; CODE XREF: sub_41A78C+2EDj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_41AAB2
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_41AAB2:				; CODE XREF: sub_41A78C+319j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_41AAC0
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_41AAC0:				; CODE XREF: sub_41A78C+32Bj
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_41AB18
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aIobufD_DPopped ; "iobuf-%d.%d: popped	filter\n"
		call	sub_4209BA
		jmp	short loc_41AB18
; ---------------------------------------------------------------------------

loc_41AAF6:				; CODE XREF: sub_41A78C+299j
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_41AB0C
		mov	[esp+48h+var_48], offset aOhhJeeeTryingT ; "Ohh	jeee, trying to	remove a head filte"...
		call	sub_42098D
; ---------------------------------------------------------------------------

loc_41AB0C:				; CODE XREF: sub_41A78C+372j
		mov	[esp+48h+var_48], offset aOhhJeeeTryin_0 ; "Ohh	jeee, trying to	remove an intermedi"...
		call	sub_42098D
; ---------------------------------------------------------------------------

loc_41AB18:				; CODE XREF: sub_41A78C+346j
					; sub_41A78C+368j
		mov	eax, [ebp+var_20]

loc_41AB1B:				; CODE XREF: sub_41A78C+156j
					; sub_41A78C+1DCj ...
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_41A78C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41AB23	proc near		; CODE XREF: sub_41B22E+73p
					; sub_41B2D7+136p ...

DstBuf		= dword	ptr -58h
ElementSize	= dword	ptr -54h
Count		= dword	ptr -50h
File		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jz	short loc_41AB58
		mov	[esp+58h+Count], 6FAh ;	int
		mov	[esp+58h+ElementSize], offset a____Gnupg22__9 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+58h+DstBuf], offset aAD_startAD_len ; "a->d.start == a->d.len"
		call	sub_4276E0

loc_41AB58:				; CODE XREF: sub_41AB23+17j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 3
		jnz	short loc_41AB6C
		mov	eax, 0FFFFFFFFh
		jmp	loc_41B0B8
; ---------------------------------------------------------------------------

loc_41AB6C:				; CODE XREF: sub_41AB23+3Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+38h]
		test	eax, eax
		jz	loc_41ACB6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jz	loc_41AC79
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_1C], eax
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_41ABD5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_41ABAC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		jmp	short loc_41ABB1
; ---------------------------------------------------------------------------

loc_41ABAC:				; CODE XREF: sub_41AB23+7Fj
		mov	eax, offset a?_0 ; "?"

loc_41ABB1:				; CODE XREF: sub_41AB23+87j
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+58h+File],	eax
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+ElementSize], edx ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DPopSIn ; "iobuf-%d.%d: pop `%s' in underflow\n"
		call	sub_4209BA

loc_41ABD5:				; CODE XREF: sub_41AB23+75j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+58h+DstBuf], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+58h+DstBuf], eax
		call	gcry_free
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_41AC13
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_41AC13:				; CODE XREF: sub_41AB23+E0j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_41AC2B
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_41AC2B:				; CODE XREF: sub_41AB23+F7j
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_41AC53
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_41AC53:				; CODE XREF: sub_41AB23+123j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_41AC61
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_41AC61:				; CODE XREF: sub_41AB23+135j
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+DstBuf], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+DstBuf], eax
		call	sub_419438
		jmp	short loc_41AC83
; ---------------------------------------------------------------------------

loc_41AC79:				; CODE XREF: sub_41AB23+5Fj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+38h], 0

loc_41AC83:				; CODE XREF: sub_41AB23+154j
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_41ACAC
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnderf ; "iobuf-%d.%d: underflow: eof	(due to	fil"...
		call	sub_4209BA

loc_41ACAC:				; CODE XREF: sub_41AB23+167j
		mov	eax, 0FFFFFFFFh
		jmp	loc_41B0B8
; ---------------------------------------------------------------------------

loc_41ACB6:				; CODE XREF: sub_41AB23+51j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		test	eax, eax
		jz	short loc_41ACF3
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_41ACE9
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DError	; "iobuf-%d.%d:	error\n"
		call	sub_4209BA

loc_41ACE9:				; CODE XREF: sub_41AB23+1A4j
		mov	eax, 0FFFFFFFFh
		jmp	loc_41B0B8
; ---------------------------------------------------------------------------

loc_41ACF3:				; CODE XREF: sub_41AB23+19Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_41ADA1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+28h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	ecx, [ebp+var_20]
		mov	[esp+58h+File],	ecx ; File
		mov	[esp+58h+Count], edx ; Count
		mov	[esp+58h+ElementSize], 1 ; ElementSize
		mov	[esp+58h+DstBuf], eax ;	DstBuf
		call	fread
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+28h]
		mov	eax, [ebp+var_2C]
		cmp	edx, eax
		jbe	short loc_41AD5D
		mov	eax, [ebp+var_20]
		mov	[esp+58h+DstBuf], eax ;	File
		call	ferror
		test	eax, eax
		jz	short loc_41AD5D
		call	sub_417ED5
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+3Ch], edx

loc_41AD5D:				; CODE XREF: sub_41AB23+21Cj
					; sub_41AB23+22Bj
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+arg_0]
		mov	[eax+30h], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jz	short loc_41AD97
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_0]
		mov	[edx+2Ch], ecx
		jmp	short loc_41AD9C
; ---------------------------------------------------------------------------

loc_41AD97:				; CODE XREF: sub_41AB23+252j
		mov	eax, 0FFFFFFFFh

loc_41AD9C:				; CODE XREF: sub_41AB23+272j
		jmp	loc_41B0B8
; ---------------------------------------------------------------------------

loc_41ADA1:				; CODE XREF: sub_41AB23+1D8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	loc_41B08A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[ebp+var_2C], eax
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_41ADE8
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+File],	ecx
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnde_0 ; "iobuf-%d.%d: underflow: req=%lu\n"
		call	sub_4209BA

loc_41ADE8:				; CODE XREF: sub_41AB23+29Cj
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ebx, [ebp+var_2C]
		mov	[esp+58h+var_48], ebx
		mov	[esp+58h+File],	ecx
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], 3
		mov	[esp+58h+DstBuf], eax
		call	esi
		mov	[ebp+var_24], eax
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_41AE56
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	ebx, [ebp+var_24]
		mov	[esp+58h+var_48], ebx
		mov	[esp+58h+File],	ecx
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnde_1 ; "iobuf-%d.%d: underflow: got=%lu rc=%d\n"
		call	sub_4209BA

loc_41AE56:				; CODE XREF: sub_41AB23+303j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 1
		jnz	loc_41B00E
		cmp	[ebp+var_24], 0FFFFFFFFh
		jnz	loc_41B00E
		mov	[ebp+var_30], 0
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ecx, [ebp+var_30]
		mov	[esp+58h+var_48], ecx
		mov	[esp+58h+File],	0
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], 2
		mov	[esp+58h+DstBuf], eax
		call	ebx
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_41AECB
		mov	eax, [ebp+var_24]
		mov	[esp+58h+DstBuf], eax
		call	gpg_strerror
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufctrl_fr_0 ; "IOBUFCTRL_FREE failed: %s\n"
		call	sub_42091D

loc_41AECB:				; CODE XREF: sub_41AB23+38Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		test	eax, eax
		jz	short loc_41AEF7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+48h]
		test	eax, eax
		jz	short loc_41AEF7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[esp+58h+DstBuf], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+44h], 0

loc_41AEF7:				; CODE XREF: sub_41AB23+3B0j
					; sub_41AB23+3BAj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+40h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+5Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+44h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+38h], 1
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jnz	loc_41B01F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jz	loc_41B01F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_28], eax
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_41AF6A
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DPopInU ; "iobuf-%d.%d: pop in	underflow (!len)\n"
		call	sub_4209BA

loc_41AF6A:				; CODE XREF: sub_41AB23+425j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+58h+DstBuf], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+58h+DstBuf], eax
		call	gcry_free
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+arg_0]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_41AFA8
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_41AFA8:				; CODE XREF: sub_41AB23+475j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_41AFC0
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_41AFC0:				; CODE XREF: sub_41AB23+48Cj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_41AFE8
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_41AFE8:				; CODE XREF: sub_41AB23+4B8j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_41AFF6
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_41AFF6:				; CODE XREF: sub_41AB23+4CAj
		mov	eax, [ebp+var_28]
		mov	[esp+58h+DstBuf], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+DstBuf], eax
		call	sub_419438
		jmp	short loc_41B01F
; ---------------------------------------------------------------------------

loc_41B00E:				; CODE XREF: sub_41AB23+33Bj
					; sub_41AB23+345j
		cmp	[ebp+var_24], 0
		jz	short loc_41B020
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_24]
		mov	[eax+3Ch], edx
		jmp	short loc_41B020
; ---------------------------------------------------------------------------

loc_41B01F:				; CODE XREF: sub_41AB23+401j
					; sub_41AB23+40Fj ...
		nop

loc_41B020:				; CODE XREF: sub_41AB23+4EFj
					; sub_41AB23+4FAj
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jnz	short loc_41B057
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_41B050
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnde_2 ; "iobuf-%d.%d: underflow: eof\n"
		call	sub_4209BA

loc_41B050:				; CODE XREF: sub_41AB23+50Bj
		mov	eax, 0FFFFFFFFh
		jmp	short loc_41B0B8
; ---------------------------------------------------------------------------

loc_41B057:				; CODE XREF: sub_41AB23+502j
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+arg_0]
		mov	[eax+30h], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_0]
		mov	[edx+2Ch], ecx
		jmp	short loc_41B0B8
; ---------------------------------------------------------------------------

loc_41B08A:				; CODE XREF: sub_41AB23+286j
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_41B0B3
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnde_3 ; "iobuf-%d.%d: underflow: eof	(no filter)"...
		call	sub_4209BA

loc_41B0B3:				; CODE XREF: sub_41AB23+56Ej
		mov	eax, 0FFFFFFFFh

loc_41B0B8:				; CODE XREF: sub_41AB23+44j
					; sub_41AB23+18Ej ...
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_41AB23	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41B0C0	proc near		; CODE XREF: sub_4195A1+8Bp
					; sub_41A451+4Dp ...

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 30h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_41B0DC
		mov	eax, 0
		jmp	loc_41B227
; ---------------------------------------------------------------------------

loc_41B0DC:				; CODE XREF: sub_41B0C0+10j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 3
		jnz	loc_41B177
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		add	eax, 2000h
		mov	[ebp+var_10], eax
		mov	eax, ds:dword_430988
		test	eax, eax
		jz	short loc_41B11E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Src], eax ; char
		mov	[esp+38h+Dst], offset aIncreasingTemp ;	"increasing temp iobuf from %lu	to %lu\n"
		call	sub_4209BA

loc_41B11E:				; CODE XREF: sub_41B0C0+3Fj
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax
		call	gcry_xmalloc
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+38h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		mov	[eax+34h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+28h], edx
		mov	eax, 0
		jmp	loc_41B227
; ---------------------------------------------------------------------------

loc_41B177:				; CODE XREF: sub_41B0C0+24j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jz	short loc_41B18D
		mov	[esp+38h+Dst], offset aFlushOnNonOutp ;	"flush on non-output iobuf\n"
		call	sub_42098D
; ---------------------------------------------------------------------------

loc_41B18D:				; CODE XREF: sub_41B0C0+BFj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jnz	short loc_41B1A3
		mov	[esp+38h+Dst], offset aIobuf_flushNoF ;	"iobuf_flush: no filter\n"
		call	sub_42098D
; ---------------------------------------------------------------------------

loc_41B1A3:				; CODE XREF: sub_41B0C0+D5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ebx, [ebp+var_18]
		mov	[esp+38h+var_28], ebx
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Src], 4 ; char
		mov	[esp+38h+Dst], eax
		call	esi
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41B20B
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+var_18]
		cmp	edx, eax
		jz	short loc_41B20B
		mov	[esp+38h+Dst], offset aIobuf_flushDid ;	"iobuf_flush did not write all!\n"
		call	sub_4208F3
		mov	[ebp+var_C], 3Fh
		jmp	short loc_41B21A
; ---------------------------------------------------------------------------

loc_41B20B:				; CODE XREF: sub_41B0C0+127j
					; sub_41B0C0+134j
		cmp	[ebp+var_C], 0
		jz	short loc_41B21A
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+3Ch], edx

loc_41B21A:				; CODE XREF: sub_41B0C0+149j
					; sub_41B0C0+14Fj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+var_C]

loc_41B227:				; CODE XREF: sub_41B0C0+17j
					; sub_41B0C0+B2j
		add	esp, 30h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_41B0C0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41B22E	proc near		; CODE XREF: sub_4188FD+FBp
					; sub_4188FD+1E3p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [eax+8]
		or	eax, edx
		test	eax, eax
		jz	short loc_41B269
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [eax+8]
		cmp	ebx, edx
		jl	short loc_41B269
		cmp	ebx, edx
		jg	short loc_41B262
		cmp	ecx, eax
		jb	short loc_41B269

loc_41B262:				; CODE XREF: sub_41B22E+2Ej
		mov	eax, 0FFFFFFFFh
		jmp	short loc_41B2D1
; ---------------------------------------------------------------------------

loc_41B269:				; CODE XREF: sub_41B22E+14j
					; sub_41B22E+2Aj ...
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jnb	short loc_41B29B
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		add	edx, eax
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		mov	[ebp+var_C], edx
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+2Ch], edx
		jmp	short loc_41B2B6
; ---------------------------------------------------------------------------

loc_41B29B:				; CODE XREF: sub_41B22E+49j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41AB23
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_41B2B6
		mov	eax, 0FFFFFFFFh
		jmp	short loc_41B2D1
; ---------------------------------------------------------------------------

loc_41B2B6:				; CODE XREF: sub_41B22E+6Bj
					; sub_41B22E+7Fj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_0]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+var_C]

loc_41B2D1:				; CODE XREF: sub_41B22E+39j
					; sub_41B22E+86j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_41B22E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41B2D7	proc near		; CODE XREF: .text:0040BE1Ap
					; sub_4188FD+514p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [eax+8]
		or	eax, edx
		test	eax, eax
		jz	short loc_41B351
		mov	[ebp+var_10], 0
		jmp	short loc_41B33E
; ---------------------------------------------------------------------------

loc_41B2FC:				; CODE XREF: sub_41B2D7+6Dj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_41B22E
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_41B320
		cmp	[ebp+var_10], 0
		jnz	short loc_41B348
		mov	eax, 0FFFFFFFFh
		jmp	loc_41B490
; ---------------------------------------------------------------------------

loc_41B320:				; CODE XREF: sub_41B2D7+37j
		cmp	[ebp+var_C], 0
		jz	short loc_41B330
		mov	eax, [ebp+var_18]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], dl

loc_41B330:				; CODE XREF: sub_41B2D7+4Dj
		cmp	[ebp+var_C], 0
		jz	short loc_41B33A
		add	[ebp+var_C], 1

loc_41B33A:				; CODE XREF: sub_41B2D7+5Dj
		add	[ebp+var_10], 1

loc_41B33E:				; CODE XREF: sub_41B2D7+23j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jb	short loc_41B2FC
		jmp	short loc_41B349
; ---------------------------------------------------------------------------

loc_41B348:				; CODE XREF: sub_41B2D7+3Dj
		nop

loc_41B349:				; CODE XREF: sub_41B2D7+6Fj
		mov	eax, [ebp+var_10]
		jmp	loc_41B490
; ---------------------------------------------------------------------------

loc_41B351:				; CODE XREF: sub_41B2D7+1Aj
		mov	[ebp+var_10], 0

loc_41B358:				; CODE XREF: sub_41B2D7+192j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jnb	loc_41B3FF
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jnb	loc_41B3FF
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+var_14]
		jnb	short loc_41B3AD
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax

loc_41B3AD:				; CODE XREF: sub_41B2D7+C5j
		cmp	[ebp+var_C], 0
		jz	short loc_41B3D9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		add	edx, eax
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+var_14]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy

loc_41B3D9:				; CODE XREF: sub_41B2D7+DAj
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_14]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	[eax+2Ch], edx
		cmp	[ebp+var_C], 0
		jz	short loc_41B3FF
		mov	eax, [ebp+var_14]
		add	[ebp+var_C], eax

loc_41B3FF:				; CODE XREF: sub_41B2D7+87j
					; sub_41B2D7+9Bj ...
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jnb	short loc_41B463
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_41AB23
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_41B44B
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	edx, eax
		sar	edx, 1Fh
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+arg_0]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		cmp	[ebp+var_10], 0
		jz	short loc_41B444
		mov	eax, [ebp+var_10]
		jmp	short loc_41B449
; ---------------------------------------------------------------------------

loc_41B444:				; CODE XREF: sub_41B2D7+166j
		mov	eax, 0FFFFFFFFh

loc_41B449:				; CODE XREF: sub_41B2D7+16Bj
		jmp	short loc_41B490
; ---------------------------------------------------------------------------

loc_41B44B:				; CODE XREF: sub_41B2D7+142j
		cmp	[ebp+var_C], 0
		jz	short loc_41B45F
		mov	eax, [ebp+var_18]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_41B45F:				; CODE XREF: sub_41B2D7+178j
		add	[ebp+var_10], 1

loc_41B463:				; CODE XREF: sub_41B2D7+12Ej
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jb	loc_41B358
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	edx, eax
		sar	edx, 1Fh
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+arg_0]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+var_10]

loc_41B490:				; CODE XREF: sub_41B2D7+44j
					; sub_41B2D7+75j ...
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_41B2D7	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax+38h]
		test	eax, eax
		jz	short loc_41B4B7
		mov	eax, 0FFFFFFFFh
		jmp	locret_41B553
; ---------------------------------------------------------------------------

loc_41B4B7:				; CODE XREF: .text:0041B4ABj
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_41B50F
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41AB23
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_41B4DE
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41B553
; ---------------------------------------------------------------------------

loc_41B4DE:				; CODE XREF: .text:0041B4D5j
		mov	eax, [ebp+8]
		mov	eax, [eax+2Ch]
		cmp	eax, 1
		jz	short loc_41B505
		mov	dword ptr [esp+8], 7FCh
		mov	dword ptr [esp+4], offset a____Gnupg22__9 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	dword ptr [esp], offset	aAD_start1 ; "a->d.start == 1"
		call	sub_4276E0

loc_41B505:				; CODE XREF: .text:0041B4E7j
		mov	eax, [ebp+8]
		mov	dword ptr [eax+2Ch], 0

loc_41B50F:				; CODE XREF: .text:0041B4C5j
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_41B533
; ---------------------------------------------------------------------------

loc_41B518:				; CODE XREF: .text:0041B54Ej
		mov	eax, [ebp+8]
		mov	edx, [eax+34h]
		mov	eax, [ebp-0Ch]
		add	eax, edx
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp+0Ch], 1

loc_41B533:				; CODE XREF: .text:0041B516j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jnb	short loc_41B550
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp-0Ch]
		add	edx, eax
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_41B518

loc_41B550:				; CODE XREF: .text:0041B539j
		mov	eax, [ebp-0Ch]

locret_41B553:				; CODE XREF: .text:0041B4B2j
					; .text:0041B4DCj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41B555	proc near		; CODE XREF: sub_4188FD+6E3p
					; sub_4188FD+95Bp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_41B581
		mov	[esp+28h+var_20], offset aIobuf_writebyt ; "iobuf_writebyte"
		mov	[esp+28h+var_24], 80Eh
		mov	[esp+28h+var_28], offset a____Gnupg22__9 ; "../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_420AAC
; ---------------------------------------------------------------------------

loc_41B581:				; CODE XREF: sub_41B555+Ej
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		cmp	edx, eax
		jnz	short loc_41B5AA
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41B0C0
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41B5AA
		mov	eax, [ebp+var_C]
		jmp	short locret_41B5F8
; ---------------------------------------------------------------------------

loc_41B5AA:				; CODE XREF: sub_41B555+3Aj
					; sub_41B555+4Ej
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		cmp	edx, eax
		jb	short loc_41B5D6
		mov	[esp+28h+var_20], 814h ; int
		mov	[esp+28h+var_24], offset a____Gnupg22__9 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+28h+var_28], offset aAD_lenAD_size	; "a->d.len < a->d.size"
		call	sub_4276E0

loc_41B5D6:				; CODE XREF: sub_41B555+63j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+arg_4]
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+30h], edx
		mov	eax, 0

locret_41B5F8:				; CODE XREF: sub_41B555+53j
		leave
		retn
sub_41B555	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41B5FA	proc near		; CODE XREF: sub_4188FD+733p
					; sub_4188FD+782p ...

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_41B62C
		mov	[esp+28h+Size],	offset aIobuf_write ; "iobuf_write"
		mov	[esp+28h+Src], 821h
		mov	[esp+28h+Dst], offset a____Gnupg22__9 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_420AAC
; ---------------------------------------------------------------------------

loc_41B62C:				; CODE XREF: sub_41B5FA+14j
					; sub_41B5FA+D1j
		cmp	[ebp+arg_8], 0
		jz	short loc_41B6A8
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		cmp	edx, eax
		jnb	short loc_41B6A8
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+28h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jbe	short loc_41B665
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax

loc_41B665:				; CODE XREF: sub_41B5FA+63j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	ecx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		add	eax, ecx
		mov	ecx, [ebp+var_10]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_10]
		sub	[ebp+arg_8], eax
		mov	eax, [ebp+var_10]
		add	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	edx, eax
		add	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax+30h], edx

loc_41B6A8:				; CODE XREF: sub_41B5FA+36j
					; sub_41B5FA+46j
		cmp	[ebp+arg_8], 0
		jz	short loc_41B6C7
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_41B0C0
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_41B6C7
		mov	eax, [ebp+var_14]
		jmp	short locret_41B6D6
; ---------------------------------------------------------------------------

loc_41B6C7:				; CODE XREF: sub_41B5FA+B2j
					; sub_41B5FA+C6j
		cmp	[ebp+arg_8], 0
		jnz	loc_41B62C
		mov	eax, 0

locret_41B6D6:				; CODE XREF: sub_41B5FA+CBj
		leave
		retn
sub_41B5FA	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		jmp	short loc_41B70A
; ---------------------------------------------------------------------------

loc_41B6E0:				; CODE XREF: .text:0041B712j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41B555
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_41B706
		mov	eax, [ebp-0Ch]
		jmp	short locret_41B719
; ---------------------------------------------------------------------------

loc_41B706:				; CODE XREF: .text:0041B6FFj
		add	dword ptr [ebp+0Ch], 1

loc_41B70A:				; CODE XREF: .text:0041B6DEj
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41B6E0
		mov	eax, 0

locret_41B719:				; CODE XREF: .text:0041B704j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		jmp	short loc_41B740
; ---------------------------------------------------------------------------

loc_41B723:				; CODE XREF: .text:0041B748j
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+40h]
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_41A78C

loc_41B740:				; CODE XREF: .text:0041B721j
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_41B723
		mov	eax, [ebp+0Ch]
		mov	edx, [eax+30h]
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+34h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41B5FA
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jbe	short loc_41B788
		mov	eax, [ebp+10h]
		mov	[ebp-0Ch], eax

loc_41B788:				; CODE XREF: .text:0041B780j
		mov	eax, [ebp+8]
		mov	eax, [eax+34h]
		mov	edx, eax
		mov	eax, [ebp+0Ch]
		mov	ecx, [ebp-0Ch]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		jmp	short loc_41B7D0
; ---------------------------------------------------------------------------

loc_41B7B3:				; CODE XREF: .text:0041B7D8j
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41A78C

loc_41B7D0:				; CODE XREF: .text:0041B7B1j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_41B7B3
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0Ch
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		mov	eax, [ebp+10h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-10h]
		mov	edx, [ebp-0Ch]
		or	eax, edx
		test	eax, eax
		jz	short loc_41B80E
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		mov	edx, eax
		or	edx, 1
		mov	eax, [ebp+8]
		mov	[eax+20h], edx
		jmp	short loc_41B81F
; ---------------------------------------------------------------------------

loc_41B80E:				; CODE XREF: .text:0041B7F9j
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		mov	edx, eax
		and	edx, 0FFFFFFFEh
		mov	eax, [ebp+8]
		mov	[eax+20h], edx

loc_41B81F:				; CODE XREF: .text:0041B80Cj
		mov	ecx, [ebp+8]
		mov	eax, [ebp-10h]
		mov	edx, [ebp-0Ch]
		mov	[ecx+8], eax
		mov	[ecx+0Ch], edx
		mov	eax, [ebp+8]
		mov	ecx, [eax+18h]
		mov	ebx, [eax+1Ch]
		mov	eax, [ebp+8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+8]
		mov	[ecx+18h], eax
		mov	[ecx+1Ch], edx
		mov	eax, [ebp+8]
		mov	dword ptr [eax+10h], 0
		mov	dword ptr [eax+14h], 0
		add	esp, 0Ch
		pop	ebx
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41B864	proc near		; CODE XREF: .text:0040BDE1p

File		= dword	ptr -68h
lpFileSizeHigh	= dword	ptr -64h
var_60		= dword	ptr -60h
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= byte ptr -50h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
hFile		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		cmp	[ebp+arg_4], 0
		jz	short loc_41B879
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0

loc_41B879:				; CODE XREF: sub_41B864+Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_41BA24
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+68h+File],	eax ; File
		call	_fileno
		lea	edx, [ebp+var_50]
		mov	[esp+68h+lpFileSizeHigh], edx
		mov	[esp+68h+File],	eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		test	eax, eax
		jnz	short loc_41B8BB
		mov	eax, [ebp+var_38]
		mov	edx, [ebp+var_34]
		jmp	locret_41BA38
; ---------------------------------------------------------------------------

loc_41B8BB:				; CODE XREF: sub_41B864+4Aj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+File],	eax ; int
		call	strerror
		mov	[esp+68h+lpFileSizeHigh], eax ;	char
		mov	[esp+68h+File],	offset aFstatFailedS ; "fstat()	failed:	%s\n"
		call	sub_42091D
		mov	eax, 0
		mov	edx, 0
		jmp	locret_41BA38
; ---------------------------------------------------------------------------

loc_41B8EB:				; CODE XREF: sub_41B864+1C4j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	loc_41BA1B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_418448
		jnz	loc_41BA1B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[ebp+hFile], eax
		mov	eax, ds:dword_430308
		test	eax, eax
		jnz	short loc_41B977
		mov	[esp+68h+lpFileSizeHigh], 0
		mov	[esp+68h+File],	offset aKernel32_dll ; "kernel32.dll"
		call	sub_417EEA
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_41B96D
		mov	[esp+68h+lpFileSizeHigh], offset aGetfilesizeex	; "GetFileSizeEx"
		mov	eax, [ebp+var_18]
		mov	[esp+68h+File],	eax ; HMODULE
		call	sub_417F08
		mov	ds:dword_43030C, eax
		mov	eax, ds:dword_43030C
		test	eax, eax
		jnz	short loc_41B96D
		mov	eax, [ebp+var_18]
		mov	[esp+68h+File],	eax ; HANDLE
		call	sub_417F4D

loc_41B96D:				; CODE XREF: sub_41B864+DBj
					; sub_41B864+FCj
		mov	ds:dword_430308, 1

loc_41B977:				; CODE XREF: sub_41B864+BEj
		mov	eax, ds:dword_43030C
		test	eax, eax
		jz	short loc_41B9CB
		mov	edx, ds:dword_43030C
		lea	eax, [ebp+var_58]
		mov	[esp+68h+lpFileSizeHigh], eax
		mov	eax, [ebp+hFile]
		mov	[esp+68h+File],	eax
		call	edx ; dword_43030C
		sub	esp, 8
		test	eax, eax
		jz	short loc_41B9F6
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	short loc_41B9B0
		mov	eax, [ebp+var_58]
		mov	edx, 0
		jmp	locret_41BA38
; ---------------------------------------------------------------------------

loc_41B9B0:				; CODE XREF: sub_41B864+13Dj
		cmp	[ebp+arg_4], 0
		jz	short loc_41B9BF
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 1

loc_41B9BF:				; CODE XREF: sub_41B864+150j
		mov	eax, 0
		mov	edx, 0
		jmp	short locret_41BA38
; ---------------------------------------------------------------------------

loc_41B9CB:				; CODE XREF: sub_41B864+11Aj
		mov	[esp+68h+lpFileSizeHigh], 0 ; lpFileSizeHigh
		mov	eax, [ebp+hFile]
		mov	[esp+68h+File],	eax ; hFile
		mov	eax, ds:GetFileSize
		call	eax ; GetFileSize
		sub	esp, 8
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jz	short loc_41B9F6
		mov	eax, [ebp+var_1C]
		mov	edx, 0
		jmp	short locret_41BA38
; ---------------------------------------------------------------------------

loc_41B9F6:				; CODE XREF: sub_41B864+136j
					; sub_41B864+186j
		mov	[esp+68h+File],	0 ; DWORD
		call	sub_421C5A
		mov	[esp+68h+var_60], eax
		mov	eax, [ebp+hFile]
		mov	[esp+68h+lpFileSizeHigh], eax ;	char
		mov	[esp+68h+File],	offset aGetfilesizeFor ; "GetFileSize for handle %p failed: %s\n"
		call	sub_42091D
		jmp	short loc_41BA2E
; ---------------------------------------------------------------------------

loc_41BA1B:				; CODE XREF: sub_41B864+8Fj
					; sub_41B864+A0j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_41BA24:				; CODE XREF: sub_41B864+1Dj
		cmp	[ebp+arg_0], 0
		jnz	loc_41B8EB

loc_41BA2E:				; CODE XREF: sub_41B864+1B5j
		mov	eax, 0
		mov	edx, 0

locret_41BA38:				; CODE XREF: sub_41B864+52j
					; sub_41B864+82j ...
		leave
		retn
sub_41B864	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_41BA90
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	[esp], eax
		call	_fileno
		jmp	short locret_41BA9B
; ---------------------------------------------------------------------------

loc_41BA5A:				; CODE XREF: .text:0041BA94j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_41BA87
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_418448
		jnz	short loc_41BA87
		mov	eax, [ebp+8]
		mov	eax, [eax+44h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		jmp	short locret_41BA9B
; ---------------------------------------------------------------------------

loc_41BA87:				; CODE XREF: .text:0041BA62j
					; .text:0041BA6Fj
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		mov	[ebp+8], eax

loc_41BA90:				; CODE XREF: .text:0041BA48j
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_41BA5A
		mov	eax, 0FFFFFFFFh

locret_41BA9B:				; CODE XREF: .text:0041BA58j
					; .text:0041BA85j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		mov	eax, [ebp+8]
		mov	ecx, [eax+18h]
		mov	ebx, [eax+1Ch]
		mov	eax, [ebp+8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, ecx
		adc	edx, ebx
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+0Ch]
		mov	[ebp-20h], eax
		mov	eax, [ebp+10h]
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_41BB75
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	[ebp-10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp-20h]
		mov	edx, [ebp-1Ch]
		mov	[esp+4], eax
		mov	[esp+8], edx
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_4278D0
		test	eax, eax
		jz	short loc_41BB3A
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp], eax
		call	strerror
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aCanTSeekS ; "can't seek: %s\n"
		call	sub_42091D
		mov	eax, 0FFFFFFFFh
		jmp	locret_41BC8C
; ---------------------------------------------------------------------------

loc_41BB3A:				; CODE XREF: .text:0041BB0Dj
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	clearerr
		jmp	loc_41BBE5
; ---------------------------------------------------------------------------

loc_41BB4A:				; CODE XREF: .text:0041BB79j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_41BB6C
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_418448
		jnz	short loc_41BB6C
		mov	eax, [ebp+8]
		mov	eax, [eax+44h]
		mov	[ebp-0Ch], eax
		jmp	short loc_41BB7B
; ---------------------------------------------------------------------------

loc_41BB6C:				; CODE XREF: .text:0041BB52j
					; .text:0041BB5Fj
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		mov	[ebp+8], eax

loc_41BB75:				; CODE XREF: .text:0041BADBj
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_41BB4A

loc_41BB7B:				; CODE XREF: .text:0041BB6Aj
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_41BB8B
		mov	eax, 0FFFFFFFFh
		jmp	locret_41BC8C
; ---------------------------------------------------------------------------

loc_41BB8B:				; CODE XREF: .text:0041BB7Fj
		mov	edx, [ebp-20h]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		mov	eax, ds:SetFilePointer
		call	eax ; SetFilePointer
		sub	esp, 10h
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_41BBE5
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aSetfilepointer	; "SetFilePointer failed on handle %p: ec="...
		call	sub_42091D
		mov	eax, 0FFFFFFFFh
		jmp	locret_41BC8C
; ---------------------------------------------------------------------------

loc_41BBE5:				; CODE XREF: .text:0041BB45j
					; .text:0041BBB7j
		mov	eax, [ebp+8]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+8]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+8]
		mov	dword ptr [eax+10h], 0
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+8]
		mov	dword ptr [eax+8], 0
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		mov	edx, eax
		and	edx, 0FFFFFFFEh
		mov	eax, [ebp+8]
		mov	[eax+20h], edx
		mov	ecx, [ebp+8]
		mov	eax, [ebp-20h]
		mov	edx, [ebp-1Ch]
		mov	[ecx+18h], eax
		mov	[ecx+1Ch], edx
		mov	eax, [ebp+8]
		mov	dword ptr [eax+3Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jz	short loc_41BC7C
		mov	dword ptr [esp], offset	aPop_filterCall	; "pop_filter called in	iobuf_seek - pleas"...
		call	sub_4209BA
		jmp	short loc_41BC7C
; ---------------------------------------------------------------------------

loc_41BC5D:				; CODE XREF: .text:0041BC85j
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41A78C
		jmp	short loc_41BC7D
; ---------------------------------------------------------------------------

loc_41BC7C:				; CODE XREF: .text:0041BC4Dj
					; .text:0041BC5Bj
		nop

loc_41BC7D:				; CODE XREF: .text:0041BC7Aj
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_41BC5D
		mov	eax, 0

locret_41BC8C:				; CODE XREF: .text:0041BB35j
					; .text:0041BB86j ...
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41BC8E	proc near		; CODE XREF: .text:0041978Dp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		test	eax, eax
		jz	short loc_41BCE8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		jmp	short locret_41BCF3
; ---------------------------------------------------------------------------

loc_41BCA6:				; CODE XREF: sub_41BC8E+5Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_41BCDF
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_418448
		jnz	short loc_41BCDF
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_4]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_41BCD8
		mov	eax, [ebp+var_4]
		add	eax, 14h
		jmp	short loc_41BCDD
; ---------------------------------------------------------------------------

loc_41BCD8:				; CODE XREF: sub_41BC8E+40j
		mov	eax, 0

loc_41BCDD:				; CODE XREF: sub_41BC8E+48j
		jmp	short locret_41BCF3
; ---------------------------------------------------------------------------

loc_41BCDF:				; CODE XREF: sub_41BC8E+20j
					; sub_41BC8E+2Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_41BCE8:				; CODE XREF: sub_41BC8E+Ej
		cmp	[ebp+arg_0], 0
		jnz	short loc_41BCA6
		mov	eax, 0

locret_41BCF3:				; CODE XREF: sub_41BC8E+16j
					; sub_41BC8E:loc_41BCDDj
		leave
		retn
sub_41BC8E	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		jmp	short loc_41BD2E
; ---------------------------------------------------------------------------

loc_41BCFD:				; CODE XREF: .text:0041BD32j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_41BD25
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_418448
		jnz	short loc_41BD25
		mov	eax, [ebp+8]
		mov	eax, [eax+44h]
		mov	[ebp-4], eax
		mov	eax, [ebp-4]
		add	eax, 14h
		jmp	short locret_41BD39
; ---------------------------------------------------------------------------

loc_41BD25:				; CODE XREF: .text:0041BD05j
					; .text:0041BD12j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		mov	[ebp+8], eax

loc_41BD2E:				; CODE XREF: .text:0041BCFBj
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_41BCFD
		mov	eax, 0

locret_41BD39:				; CODE XREF: .text:0041BD23j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 20h
		mov	dword ptr [esp], 1
		call	gcry_xcalloc
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 1
		jz	short loc_41BD8A
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 2
		jz	short loc_41BD8A
		mov	dword ptr [esp+8], 98Ch
		mov	dword ptr [esp+4], offset a____Gnupg22__9 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	dword ptr [esp], offset	aAUse1AUse2 ; "a->use == 1 || a->use ==	2"
		call	sub_4276E0
		jmp	short loc_41BD8B
; ---------------------------------------------------------------------------

loc_41BD8A:				; CODE XREF: .text:0041BD60j
					; .text:0041BD6Aj
		nop

loc_41BD8B:				; CODE XREF: .text:0041BD88j
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], edx
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_41BDCE
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 1
		jnz	short loc_41BDB1
		mov	dword ptr [esp], offset	aPop_filterCa_0	; "pop_filter called in	set_partial_block_"...
		call	sub_4209BA

loc_41BDB1:				; CODE XREF: .text:0041BDA3j
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], offset sub_4188FD
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41A78C
		jmp	short locret_41BE05
; ---------------------------------------------------------------------------

loc_41BDCE:				; CODE XREF: .text:0041BD99j
		mov	eax, [ebp-0Ch]
		mov	dword ptr [eax+0Ch], 1
		mov	eax, [ebp-0Ch]
		mov	dword ptr [eax+4], 0
		mov	edx, [ebp+0Ch]
		mov	eax, [ebp-0Ch]
		mov	[eax+18h], edx
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], offset sub_4188FD
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41A428

locret_41BE05:				; CODE XREF: .text:0041BDCCj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		mov	[ebp-14h], eax
		mov	dword ptr [ebp-18h], 0
		mov	eax, [ebp+14h]
		mov	eax, [eax]
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_41BE57
		mov	dword ptr [ebp-14h], 100h
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp+10h]
		mov	edx, [ebp-14h]
		mov	[eax], edx

loc_41BE57:				; CODE XREF: .text:0041BE30j
		sub	dword ptr [ebp-14h], 3
		mov	eax, [ebp-10h]
		mov	[ebp-1Ch], eax
		jmp	loc_41BF6E
; ---------------------------------------------------------------------------

loc_41BE66:				; CODE XREF: .text:0041BFD2j
		mov	eax, [ebp-18h]
		cmp	eax, [ebp-14h]
		jnz	loc_41BF56
		mov	eax, [ebp-14h]
		cmp	eax, [ebp-20h]
		jbe	loc_41BF06

loc_41BE7E:				; CODE XREF: .text:0041BEE8j
		cmp	dword ptr [ebp-0Ch], 0Ah
		jz	short loc_41BEEA
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_41BE9E
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_41BEAB

loc_41BE9E:				; CODE XREF: .text:0041BE8Cj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41B22E
		jmp	short loc_41BEE1
; ---------------------------------------------------------------------------

loc_41BEAB:				; CODE XREF: .text:0041BE9Cj
		mov	eax, [ebp+8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+2Ch], ecx

loc_41BEE1:				; CODE XREF: .text:0041BEA9j
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_41BE7E

loc_41BEEA:				; CODE XREF: .text:0041BE82j
		mov	eax, [ebp-1Ch]
		mov	byte ptr [eax],	0Ah
		add	dword ptr [ebp-1Ch], 1
		add	dword ptr [ebp-18h], 1
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0
		jmp	loc_41BFDB
; ---------------------------------------------------------------------------

loc_41BF06:				; CODE XREF: .text:0041BE78j
		add	dword ptr [ebp-14h], 3
		cmp	dword ptr [ebp-14h], 3FFh
		ja	short loc_41BF1A
		mov	eax, 100h
		jmp	short loc_41BF1F
; ---------------------------------------------------------------------------

loc_41BF1A:				; CODE XREF: .text:0041BF11j
		mov	eax, 400h

loc_41BF1F:				; CODE XREF: .text:0041BF18j
		add	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	gcry_xrealloc
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp+10h]
		mov	edx, [ebp-14h]
		mov	[eax], edx
		sub	dword ptr [ebp-14h], 3
		mov	eax, [ebp-18h]
		mov	edx, [ebp-10h]
		add	eax, edx
		mov	[ebp-1Ch], eax

loc_41BF56:				; CODE XREF: .text:0041BE6Cj
		mov	eax, [ebp-0Ch]
		mov	edx, eax
		mov	eax, [ebp-1Ch]
		mov	[eax], dl
		add	dword ptr [ebp-1Ch], 1
		add	dword ptr [ebp-18h], 1
		cmp	dword ptr [ebp-0Ch], 0Ah
		jz	short loc_41BFDA

loc_41BF6E:				; CODE XREF: .text:0041BE61j
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_41BF88
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_41BF95

loc_41BF88:				; CODE XREF: .text:0041BF76j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41B22E
		jmp	short loc_41BFCB
; ---------------------------------------------------------------------------

loc_41BF95:				; CODE XREF: .text:0041BF86j
		mov	eax, [ebp+8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+2Ch], ecx

loc_41BFCB:				; CODE XREF: .text:0041BF93j
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	loc_41BE66
		jmp	short loc_41BFDB
; ---------------------------------------------------------------------------

loc_41BFDA:				; CODE XREF: .text:0041BF6Cj
		nop

loc_41BFDB:				; CODE XREF: .text:0041BF01j
					; .text:0041BFD8j
		mov	eax, [ebp-1Ch]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-18h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41BFE6	proc near		; CODE XREF: sub_4199B9+78p
					; .text:00419E95p

nStdHandle	= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+arg_0], 0
		jnz	short loc_41C008
		mov	[esp+28h+nStdHandle], 0FFFFFFF6h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+var_C], eax
		jmp	short loc_41C046
; ---------------------------------------------------------------------------

loc_41C008:				; CODE XREF: sub_41BFE6+Aj
		cmp	dword ptr [ebp+arg_0], 1
		jnz	short loc_41C024
		mov	[esp+28h+nStdHandle], 0FFFFFFF5h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+var_C], eax
		jmp	short loc_41C046
; ---------------------------------------------------------------------------

loc_41C024:				; CODE XREF: sub_41BFE6+26j
		cmp	dword ptr [ebp+arg_0], 2
		jnz	short loc_41C040
		mov	[esp+28h+nStdHandle], 0FFFFFFF4h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+var_C], eax
		jmp	short loc_41C046
; ---------------------------------------------------------------------------

loc_41C040:				; CODE XREF: sub_41BFE6+42j
		mov	eax, dword ptr [ebp+arg_0]
		mov	[ebp+var_C], eax

loc_41C046:				; CODE XREF: sub_41BFE6+20j
					; sub_41BFE6+3Cj ...
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_41C06A
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+nStdHandle], offset aGetstdhandleDF ; "GetStdHandle(%d) failed: ec=%d\n"
		call	sub_4209BA

loc_41C06A:				; CODE XREF: sub_41BFE6+64j
		mov	eax, [ebp+var_C]
		mov	dword ptr [ebp+arg_0], eax
		mov	eax, dword ptr [ebp+arg_0]
		leave
		retn
sub_41BFE6	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_41C0F4

loc_41C082:				; CODE XREF: .text:0041C0F0j
					; .text:loc_41C0F2j
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_41C09C
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_41C0B1

loc_41C09C:				; CODE XREF: .text:0041C08Aj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41B22E
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_41C0F2
		jmp	loc_41C194
; ---------------------------------------------------------------------------

loc_41C0B1:				; CODE XREF: .text:0041C09Aj
		mov	eax, [ebp+8]
		mov	edx, [eax+30h]
		mov	eax, [ebp+8]
		mov	eax, [eax+2Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp-14h]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+8]
		mov	edx, [eax+30h]
		mov	eax, [ebp+8]
		mov	[eax+2Ch], edx
		jmp	short loc_41C082
; ---------------------------------------------------------------------------

loc_41C0F2:				; CODE XREF: .text:0041C0AAj
		jmp	short loc_41C082
; ---------------------------------------------------------------------------

loc_41C0F4:				; CODE XREF: .text:0041C080j
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	loc_41C187
; ---------------------------------------------------------------------------

loc_41C0FF:				; CODE XREF: .text:0041C18Bj
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_41C119
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_41C12F

loc_41C119:				; CODE XREF: .text:0041C107j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41B22E
		cmp	eax, 0FFFFFFFFh
		jz	short loc_41C193
		sub	dword ptr [ebp-0Ch], 1
		jmp	short loc_41C187
; ---------------------------------------------------------------------------

loc_41C12F:				; CODE XREF: .text:0041C117j
		mov	eax, [ebp+8]
		mov	edx, [eax+30h]
		mov	eax, [ebp+8]
		mov	eax, [eax+2Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		cmp	eax, [ebp-0Ch]
		jbe	short loc_41C152
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax

loc_41C152:				; CODE XREF: .text:0041C14Aj
		mov	eax, [ebp+8]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp-10h]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+8]
		mov	eax, [eax+2Ch]
		mov	edx, eax
		add	edx, [ebp-10h]
		mov	eax, [ebp+8]
		mov	[eax+2Ch], edx
		mov	eax, [ebp-10h]
		sub	[ebp-0Ch], eax

loc_41C187:				; CODE XREF: .text:0041C0FAj
					; .text:0041C12Dj
		cmp	dword ptr [ebp-0Ch], 0
		jnz	loc_41C0FF
		jmp	short loc_41C194
; ---------------------------------------------------------------------------

loc_41C193:				; CODE XREF: .text:0041C127j
		nop

loc_41C194:				; CODE XREF: .text:0041C0ACj
					; .text:0041C191j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C19C	proc near		; CODE XREF: sub_41C1C3+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_41C1BC
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_41C1C1
; ---------------------------------------------------------------------------

loc_41C1BC:				; CODE XREF: sub_41C19C+7j
		mov	eax, 0

loc_41C1C1:				; CODE XREF: sub_41C19C+1Ej
		pop	ebp
		retn
sub_41C19C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C1C3	proc near		; CODE XREF: sub_41C1EB+Ep
					; sub_41C528+58p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_41C19C
		leave
		retn
sub_41C1C3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C1DE	proc near		; CODE XREF: sub_41C2DE+B3p
					; sub_41C657+591p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_41C1DE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C1EB	proc near		; CODE XREF: sub_41C222+5Dp
					; sub_41C2DE+156p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_41C1C3
		leave
		retn
sub_41C1EB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C200	proc near		; CODE XREF: sub_41C657+3E0p
					; sub_41C657+405p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jns	short loc_41C213
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41C220
; ---------------------------------------------------------------------------

loc_41C213:				; CODE XREF: sub_41C200+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle

locret_41C220:				; CODE XREF: sub_41C200+11j
		leave
		retn
sub_41C200	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C222	proc near		; CODE XREF: sub_41C2DE+78p
					; sub_41C2DE+A5p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_C], 0
		jz	short loc_41C238
		mov	eax, [ebp+arg_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41C244

loc_41C238:				; CODE XREF: sub_41C222+Aj
		mov	[ebp+var_C], 0
		jmp	loc_41C2D9
; ---------------------------------------------------------------------------

loc_41C244:				; CODE XREF: sub_41C222+14j
		cmp	[ebp+arg_10], 0
		jz	short loc_41C251
		mov	eax, offset aPutenv ; "putenv="
		jmp	short loc_41C256
; ---------------------------------------------------------------------------

loc_41C251:				; CODE XREF: sub_41C222+26j
		mov	eax, offset byte_42D2D4

loc_41C256:				; CODE XREF: sub_41C222+2Dj
		mov	edx, [ebp+arg_C]
		mov	[esp+38h+var_28], edx
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+var_2C], edx
		mov	[esp+38h+var_30], eax
		mov	[esp+38h+var_34], offset aOptionSSS ; "OPTION %s%s=%s"
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_41689C
		test	eax, eax
		jns	short loc_41C289
		call	sub_41C1EB
		mov	[ebp+var_C], eax
		jmp	short loc_41C2D9
; ---------------------------------------------------------------------------

loc_41C289:				; CODE XREF: sub_41C222+5Bj
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_1C], 0
		mov	[esp+38h+var_20], 0
		mov	[esp+38h+var_24], 0
		mov	[esp+38h+var_28], 0
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	gcry_free

loc_41C2D9:				; CODE XREF: sub_41C222+1Dj
					; sub_41C222+65j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41C222	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C2DE	proc near		; CODE XREF: sub_41C657+67Dp

var_58		= dword	ptr -58h
VarName		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_24], 0
		jmp	loc_41C3B3
; ---------------------------------------------------------------------------

loc_41C305:				; CODE XREF: sub_41C2DE+EEj
		mov	[esp+58h+var_50], 0 ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+VarName], eax ; VarName
		mov	eax, [ebp+arg_10]
		mov	[esp+58h+var_58], eax ;	int
		call	sub_40D694
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	loc_41C3B2
		mov	eax, [ebp+var_28]
		test	eax, eax
		jz	short loc_41C360
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_48], 0
		mov	edx, [ebp+var_20]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+VarName], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_41C222
		mov	[ebp+var_C], eax
		jmp	short loc_41C3A4
; ---------------------------------------------------------------------------

loc_41C360:				; CODE XREF: sub_41C2DE+53j
		mov	[esp+58h+var_48], 1
		mov	eax, [ebp+var_20]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+VarName], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_41C222
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	sub_41C1DE
		cmp	eax, 0AEh
		jnz	short loc_41C3A4
		mov	[ebp+var_C], 0

loc_41C3A4:				; CODE XREF: sub_41C2DE+80j
					; sub_41C2DE+BDj
		cmp	[ebp+var_C], 0
		jz	short loc_41C3B3
		mov	eax, [ebp+var_C]
		jmp	locret_41C526
; ---------------------------------------------------------------------------

loc_41C3B2:				; CODE XREF: sub_41C2DE+48j
		nop

loc_41C3B3:				; CODE XREF: sub_41C2DE+22j
					; sub_41C2DE+CAj
		lea	eax, [ebp+var_28]
		mov	[esp+58h+VarName], eax
		lea	eax, [ebp+var_24]
		mov	[esp+58h+var_58], eax
		call	sub_40CFD9
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_41C305
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+var_50], eax ;	int
		mov	[esp+58h+VarName], offset aGpg_tty_0 ; "GPG_TTY"
		mov	eax, [ebp+arg_10]
		mov	[esp+58h+var_58], eax ;	int
		call	sub_40D694
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_41C403
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jnz	short loc_41C403
		mov	[ebp+var_14], 0

loc_41C403:				; CODE XREF: sub_41C2DE+115j
					; sub_41C2DE+11Cj
		mov	[esp+58h+VarName], 0
		mov	[esp+58h+var_58], 2
		call	setlocale
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41C43E
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	gcry_strdup
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41C43E
		call	sub_41C1EB
		jmp	locret_41C526
; ---------------------------------------------------------------------------

loc_41C43E:				; CODE XREF: sub_41C2DE+140j
					; sub_41C2DE+154j
		mov	[esp+58h+VarName], offset byte_42D2D4
		mov	[esp+58h+var_58], 2
		call	setlocale
		mov	[ebp+var_18], eax
		cmp	[ebp+arg_8], 0
		jnz	short loc_41C467
		cmp	[ebp+var_14], 0
		jz	short loc_41C49E
		cmp	[ebp+var_18], 0
		jz	short loc_41C49E

loc_41C467:				; CODE XREF: sub_41C2DE+17Bj
		cmp	[ebp+arg_8], 0
		jz	short loc_41C472
		mov	eax, [ebp+arg_8]
		jmp	short loc_41C475
; ---------------------------------------------------------------------------

loc_41C472:				; CODE XREF: sub_41C2DE+18Dj
		mov	eax, [ebp+var_18]

loc_41C475:				; CODE XREF: sub_41C2DE+192j
		mov	[esp+58h+var_48], 0
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], offset aLcCtype ; "lc-ctype"
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+VarName], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_41C222
		mov	[ebp+var_C], eax

loc_41C49E:				; CODE XREF: sub_41C2DE+181j
					; sub_41C2DE+187j
		cmp	[ebp+var_10], 0
		jz	short loc_41C4C2
		mov	eax, [ebp+var_10]
		mov	[esp+58h+VarName], eax
		mov	[esp+58h+var_58], 2
		call	setlocale
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	gcry_free

loc_41C4C2:				; CODE XREF: sub_41C2DE+1C4j
		cmp	[ebp+var_C], 0
		jz	short loc_41C4CD
		mov	eax, [ebp+var_C]
		jmp	short locret_41C526
; ---------------------------------------------------------------------------

loc_41C4CD:				; CODE XREF: sub_41C2DE+1E8j
		cmp	[ebp+arg_C], 0
		jnz	short loc_41C4DF
		cmp	[ebp+var_14], 0
		jz	short loc_41C516
		cmp	[ebp+var_18], 0
		jz	short loc_41C516

loc_41C4DF:				; CODE XREF: sub_41C2DE+1F3j
		cmp	[ebp+arg_C], 0
		jz	short loc_41C4EA
		mov	eax, [ebp+arg_C]
		jmp	short loc_41C4ED
; ---------------------------------------------------------------------------

loc_41C4EA:				; CODE XREF: sub_41C2DE+205j
		mov	eax, [ebp+var_18]

loc_41C4ED:				; CODE XREF: sub_41C2DE+20Aj
		mov	[esp+58h+var_48], 0
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], offset aLcMessages ; "lc-messages"
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+VarName], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_41C222
		mov	[ebp+var_C], eax

loc_41C516:				; CODE XREF: sub_41C2DE+1F9j
					; sub_41C2DE+1FFj
		cmp	[ebp+var_C], 0
		jz	short loc_41C521
		mov	eax, [ebp+var_C]
		jmp	short locret_41C526
; ---------------------------------------------------------------------------

loc_41C521:				; CODE XREF: sub_41C2DE+23Cj
		mov	eax, 0

locret_41C526:				; CODE XREF: sub_41C2DE+CFj
					; sub_41C2DE+15Bj ...
		leave
		retn
sub_41C2DE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C528	proc near		; CODE XREF: sub_41C657+289p

lpMutexAttributes= dword ptr -28h
bInitialOwner	= dword	ptr -24h
lpName		= dword	ptr -20h
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+lpName], offset Name ;	"GnuPG_spawn_agent_sentinel"
		mov	[esp+28h+bInitialOwner], 0 ; bInitialOwner
		mov	[esp+28h+lpMutexAttributes], 0 ; lpMutexAttributes
		mov	eax, ds:CreateMutexA
		call	eax ; CreateMutexA
		sub	esp, 0Ch
		mov	edx, [ebp+arg_0]
		mov	[edx], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41C587
		mov	[esp+28h+lpMutexAttributes], 0FFFFFFFFh	; DWORD
		call	sub_421C5A
		mov	[esp+28h+bInitialOwner], eax ; char
		mov	[esp+28h+lpMutexAttributes], offset aFailedToCrea_0 ; "failed to create	the spawn_agent	mutex:"...
		call	sub_42091D
		mov	[esp+28h+lpMutexAttributes], 1
		call	sub_41C1C3
		jmp	short locret_41C5F7
; ---------------------------------------------------------------------------

loc_41C587:				; CODE XREF: sub_41C528+33j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+bInitialOwner], 1388h ; char
		mov	[esp+28h+lpMutexAttributes], eax ; hHandle
		mov	eax, ds:WaitForSingleObject
		call	eax ; WaitForSingleObject
		sub	esp, 8
		mov	dword ptr [ebp+var_C], eax
		cmp	dword ptr [ebp+var_C], 0
		jnz	short loc_41C5B1
		mov	eax, 0
		jmp	short locret_41C5F7
; ---------------------------------------------------------------------------

loc_41C5B1:				; CODE XREF: sub_41C528+80j
		cmp	dword ptr [ebp+var_C], 102h
		jnz	short loc_41C5C8
		mov	[esp+28h+lpMutexAttributes], offset aErrorWaitingFo ; "error waiting for the spawn_agent mutex"...
		call	sub_4208F3
		jmp	short loc_41C5EB
; ---------------------------------------------------------------------------

loc_41C5C8:				; CODE XREF: sub_41C528+90j
		mov	[esp+28h+lpMutexAttributes], 0FFFFFFFFh	; DWORD
		call	sub_421C5A
		mov	[esp+28h+lpName], eax
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+28h+bInitialOwner], eax ; char
		mov	[esp+28h+lpMutexAttributes], offset aErrorWaiting_0 ; "error waiting for the spawn_agent mutex"...
		call	sub_4208F3

loc_41C5EB:				; CODE XREF: sub_41C528+9Ej
		mov	[esp+28h+lpMutexAttributes], 1
		call	sub_41C1C3

locret_41C5F7:				; CODE XREF: sub_41C528+5Dj
					; sub_41C528+87j
		leave
		retn
sub_41C528	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C5F9	proc near		; CODE XREF: sub_41C657+381p

hMutex		= dword	ptr -18h
var_14		= byte ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jz	short locret_41C655
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+18h+hMutex], eax ;	hMutex
		mov	eax, ds:ReleaseMutex
		call	eax ; ReleaseMutex
		sub	esp, 4
		test	eax, eax
		jnz	short loc_41C63A
		mov	[esp+18h+hMutex], 0FFFFFFFFh ; DWORD
		call	sub_421C5A
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+hMutex], offset aFailedToReleas ; "failed to release the spawn_agent mutex"...
		call	sub_42091D

loc_41C63A:				; CODE XREF: sub_41C5F9+23j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+18h+hMutex], eax ;	hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0

locret_41C655:				; CODE XREF: sub_41C5F9+Dj
		leave
		retn
sub_41C5F9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41C657(int, int, int,	char *Str, int,	int, int, int, int, int, int)
sub_41C657	proc near		; CODE XREF: sub_40D9FF+8Bp

VarName		= dword	ptr -78h
Val		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_4C		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= byte ptr -2Ch
var_28		= byte ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
Str		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch
arg_28		= dword	ptr  30h

		push	ebp
		mov	ebp, esp
		sub	esp, 78h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		lea	eax, [ebp+var_34]
		mov	[esp+78h+VarName], eax
		call	assuan_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41C6A4
		mov	eax, [ebp+var_C]
		mov	[esp+78h+VarName], eax
		call	gpg_strerror
		mov	[esp+78h+Val], eax ; char
		mov	[esp+78h+VarName], offset aErrorAllocat_3 ; "error allocating assuan context: %s\n"
		call	sub_42091D
		mov	eax, [ebp+var_C]
		jmp	locret_41CCFF
; ---------------------------------------------------------------------------

loc_41C6A4:				; CODE XREF: sub_41C657+28j
					; sub_41C657+4C8j ...
		mov	eax, ds:dword_430314
		test	eax, eax
		jnz	short loc_41C6BB
		mov	[esp+78h+VarName], offset aGpg_agent_info ; "GPG_AGENT_INFO"
		call	getenv
		jmp	short loc_41C6C0
; ---------------------------------------------------------------------------

loc_41C6BB:				; CODE XREF: sub_41C657+54j
		mov	eax, 0

loc_41C6C0:				; CODE XREF: sub_41C657+62j
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_41C6D7
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_41CAC4

loc_41C6D7:				; CODE XREF: sub_41C657+70j
		mov	[esp+78h+var_70], 0
		mov	[esp+78h+Val], offset aS_gpgAgent ; "S.gpg-agent"
		mov	eax, [ebp+arg_8]
		mov	[esp+78h+VarName], eax
		call	sub_42141F
		mov	dword ptr [ebp+var_2C],	eax
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_6C], 0
		mov	[esp+78h+var_70], 0
		mov	edx, dword ptr [ebp+var_2C]
		mov	[esp+78h+Val], edx ; char
		mov	[esp+78h+VarName], eax
		call	assuan_socket_connect
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_41CAB4
		cmp	[ebp+arg_1C], 0
		jz	short loc_41C73E
		mov	[esp+78h+VarName], offset aNoRunningGpgAg ; "no	running	gpg-agent - starting one\n"
		call	sub_420034
		mov	[esp+78h+VarName], eax ; char *
		call	sub_4208F3

loc_41C73E:				; CODE XREF: sub_41C657+D1j
		cmp	[ebp+arg_24], 0
		jz	short loc_41C767
		mov	[esp+78h+var_6C], 0
		mov	[esp+78h+var_70], offset aStarting_agent ; "starting_agent ? 0 0"
		mov	[esp+78h+Val], 30h
		mov	eax, [ebp+arg_28]
		mov	[esp+78h+VarName], eax
		mov	eax, [ebp+arg_24]
		call	eax

loc_41C767:				; CODE XREF: sub_41C657+EBj
		mov	[esp+78h+VarName], 0 ; File
		call	fflush
		test	eax, eax
		jz	short loc_41C7D2
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+78h+VarName], eax
		call	gpg_err_code_from_errno
		mov	[esp+78h+VarName], eax
		call	sub_41C1C3
		mov	[ebp+var_30], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+78h+VarName], eax ; int
		call	strerror
		mov	[esp+78h+Val], eax ; char
		mov	[esp+78h+VarName], offset aErrorFlushingP ; "error flushing pending output: %s\n"
		call	sub_42091D
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+78h+VarName], eax
		call	gcry_free
		mov	eax, [ebp+var_34]
		mov	[esp+78h+VarName], eax
		call	assuan_release
		mov	eax, [ebp+var_30]
		jmp	locret_41CCFF
; ---------------------------------------------------------------------------

loc_41C7D2:				; CODE XREF: sub_41C657+11Ej
		cmp	[ebp+Str], 0
		jz	short loc_41C7E2
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41C7F1

loc_41C7E2:				; CODE XREF: sub_41C657+17Fj
		mov	[esp+78h+VarName], 1
		call	sub_40C93A
		mov	[ebp+Str], eax

loc_41C7F1:				; CODE XREF: sub_41C657+189j
		mov	[ebp+var_40], offset aUseStandardSoc ; "--use-standard-socket-p"
		mov	[ebp+var_3C], 0
		lea	eax, [ebp+var_44]
		mov	[esp+78h+var_64], eax ;	int
		mov	[esp+78h+var_68], 0FFFFFFFFh ; int
		mov	[esp+78h+var_6C], 0FFFFFFFFh ; int
		mov	[esp+78h+var_70], 0FFFFFFFFh ; int
		lea	eax, [ebp+var_40]
		mov	[esp+78h+Val], eax ; int
		mov	eax, [ebp+Str]
		mov	[esp+78h+VarName], eax ; lpApplicationName
		call	sub_41DFF0
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41C85D
		mov	eax, [ebp+var_C]
		mov	[esp+78h+VarName], eax
		call	gpg_strerror
		mov	[esp+78h+var_70], eax
		mov	eax, [ebp+Str]
		mov	[esp+78h+Val], eax ; char
		mov	[esp+78h+VarName], offset aStartingSForTe ; "starting `%s' for testing failed: %s\n"
		call	sub_4209BA
		jmp	short loc_41C8A9
; ---------------------------------------------------------------------------

loc_41C85D:				; CODE XREF: sub_41C657+1E0j
		mov	eax, [ebp+var_44]
		lea	edx, [ebp+var_48]
		mov	[esp+78h+var_70], edx
		mov	[esp+78h+Val], eax
		mov	eax, [ebp+Str]
		mov	[esp+78h+VarName], eax
		call	sub_41E25F
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41C8A9
		mov	eax, [ebp+var_48]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_41C8A9
		mov	eax, [ebp+var_C]
		mov	[esp+78h+VarName], eax
		call	gpg_strerror
		mov	[esp+78h+var_70], eax
		mov	eax, [ebp+Str]
		mov	[esp+78h+Val], eax ; char
		mov	[esp+78h+VarName], offset aRunningSForTes ; "running `%s' for testing failed: %s\n"
		call	sub_4209BA

loc_41C8A9:				; CODE XREF: sub_41C657+204j
					; sub_41C657+226j ...
		cmp	[ebp+var_C], 0
		jnz	loc_41C9E2
		mov	eax, [ebp+var_48]
		test	eax, eax
		jnz	loc_41C9E2
		mov	[ebp+var_40], offset aDaemon ; "--daemon"
		mov	[ebp+var_3C], offset aUseStandardS_0 ; "--use-standard-socket"
		mov	[ebp+var_38], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+78h+Val], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+78h+VarName], eax
		call	sub_41C528
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_41C9D2
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_6C], 0
		mov	[esp+78h+var_70], 0
		mov	edx, dword ptr [ebp+var_2C]
		mov	[esp+78h+Val], edx
		mov	[esp+78h+VarName], eax
		call	assuan_socket_connect
		test	eax, eax
		jz	loc_41C9D2
		mov	[esp+78h+var_70], 0
		lea	eax, [ebp+var_40]
		mov	[esp+78h+Val], eax ; int
		mov	eax, [ebp+Str]
		mov	[esp+78h+VarName], eax ; lpApplicationName
		call	sub_41E3EE
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41C963
		mov	eax, [ebp+var_C]
		mov	[esp+78h+VarName], eax
		call	gpg_strerror
		mov	[esp+78h+var_70], eax
		mov	eax, [ebp+Str]
		mov	[esp+78h+Val], eax ; char
		mov	[esp+78h+VarName], offset aFailedToStartA ; "failed to start agent `%s': %s\n"
		call	sub_42091D
		jmp	short loc_41C9D2
; ---------------------------------------------------------------------------

loc_41C963:				; CODE XREF: sub_41C657+2E6j
		cmp	[ebp+arg_1C], 0
		jz	short loc_41C985
		mov	[esp+78h+VarName], offset aWaitingDSecond ; "waiting %d	seconds	for the	agent to com"...
		call	sub_420034
		mov	[esp+78h+Val], 5 ; char
		mov	[esp+78h+VarName], eax ; char *
		call	sub_4208F3

loc_41C985:				; CODE XREF: sub_41C657+310j
		mov	[ebp+var_14], 0
		jmp	short loc_41C9C9
; ---------------------------------------------------------------------------

loc_41C98E:				; CODE XREF: sub_41C657+376j
		mov	[esp+78h+VarName], 1
		call	sub_41CD81
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_6C], 0
		mov	[esp+78h+var_70], 0
		mov	edx, dword ptr [ebp+var_2C]
		mov	[esp+78h+Val], edx
		mov	[esp+78h+VarName], eax
		call	assuan_socket_connect
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41C9D1
		add	[ebp+var_14], 1

loc_41C9C9:				; CODE XREF: sub_41C657+335j
		cmp	[ebp+var_14], 4
		jle	short loc_41C98E
		jmp	short loc_41C9D2
; ---------------------------------------------------------------------------

loc_41C9D1:				; CODE XREF: sub_41C657+36Cj
		nop

loc_41C9D2:				; CODE XREF: sub_41C657+295j
					; sub_41C657+2BFj ...
		lea	eax, [ebp+var_4C]
		mov	[esp+78h+VarName], eax
		call	sub_41C5F9
		jmp	loc_41CAB4
; ---------------------------------------------------------------------------

loc_41C9E2:				; CODE XREF: sub_41C657+256j
					; sub_41C657+261j
		mov	[esp+78h+Val], 2Fh ; Ch
		mov	eax, [ebp+Str]
		mov	[esp+78h+VarName], eax ; Str
		call	strrchr
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_41CA06
		mov	eax, [ebp+Str]
		mov	[ebp+var_18], eax
		jmp	short loc_41CA0A
; ---------------------------------------------------------------------------

loc_41CA06:				; CODE XREF: sub_41C657+3A5j
		add	[ebp+var_18], 1

loc_41CA0A:				; CODE XREF: sub_41C657+3ADj
		mov	eax, [ebp+var_18]
		mov	[ebp+var_40], eax
		mov	[ebp+var_3C], offset aServer ; "--server"
		mov	[ebp+var_38], 0
		mov	[ebp+var_1C], 0
		call	sub_4204E1
		cmp	eax, 0FFFFFFFFh
		jz	short loc_41CA49
		call	sub_4204E1
		mov	[esp+78h+VarName], eax
		call	sub_41C200
		mov	edx, eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+eax*4+var_58], edx
		add	[ebp+var_1C], 1

loc_41CA49:				; CODE XREF: sub_41C657+3D6j
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+78h+VarName], eax ; File
		call	_fileno
		mov	[esp+78h+VarName], eax
		call	sub_41C200
		mov	edx, eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+eax*4+var_58], edx
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		mov	[ebp+eax*4+var_58], 0FFFFFFFFh
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_60], 0
		mov	[esp+78h+var_64], 0
		mov	[esp+78h+var_68], 0
		lea	edx, [ebp+var_58]
		mov	[esp+78h+var_6C], edx
		lea	edx, [ebp+var_40]
		mov	[esp+78h+var_70], edx
		mov	edx, [ebp+Str]
		mov	[esp+78h+Val], edx ; char
		mov	[esp+78h+VarName], eax
		call	assuan_pipe_connect
		mov	[ebp+var_C], eax

loc_41CAB4:				; CODE XREF: sub_41C657+C7j
					; sub_41C657+386j
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+78h+VarName], eax
		call	gcry_free
		jmp	loc_41CC17
; ---------------------------------------------------------------------------

loc_41CAC4:				; CODE XREF: sub_41C657+7Aj
		mov	eax, [ebp+var_20]
		mov	[esp+78h+VarName], eax
		call	gcry_xstrdup
		mov	[ebp+var_20], eax
		mov	[esp+78h+Val], 3Bh ; char
		mov	eax, [ebp+var_20]
		mov	[esp+78h+VarName], eax ; Str
		call	strchr
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41CAF6
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_20]
		jnz	short loc_41CB24

loc_41CAF6:				; CODE XREF: sub_41C657+495j
		mov	[esp+78h+VarName], offset aMalformedGpg_a ; "malformed GPG_AGENT_INFO environment va"...
		call	sub_420034
		mov	[esp+78h+VarName], eax ; char *
		call	sub_42091D
		mov	eax, [ebp+var_20]
		mov	[esp+78h+VarName], eax
		call	gcry_free
		mov	ds:dword_430314, 1
		jmp	loc_41C6A4
; ---------------------------------------------------------------------------

loc_41CB24:				; CODE XREF: sub_41C657+49Dj
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[esp+78h+VarName], eax ; Str
		call	atoi
		mov	[ebp+var_24], eax
		jmp	short loc_41CB42
; ---------------------------------------------------------------------------

loc_41CB3E:				; CODE XREF: sub_41C657+4FDj
		add	[ebp+var_10], 1

loc_41CB42:				; CODE XREF: sub_41C657+4E5j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41CB56
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Bh
		jnz	short loc_41CB3E

loc_41CB56:				; CODE XREF: sub_41C657+4F3j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41CB70
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[esp+78h+VarName], eax ; Str
		call	atoi
		jmp	short loc_41CB75
; ---------------------------------------------------------------------------

loc_41CB70:				; CODE XREF: sub_41C657+507j
		mov	eax, 0

loc_41CB75:				; CODE XREF: sub_41C657+517j
		mov	dword ptr [ebp+var_28],	eax
		cmp	dword ptr [ebp+var_28],	1
		jz	short loc_41CBB3
		mov	[esp+78h+VarName], offset aGpgAgentProtoc ; "gpg-agent protocol	version	%d is not su"...
		call	sub_420034
		mov	edx, dword ptr [ebp+var_28]
		mov	[esp+78h+Val], edx ; char
		mov	[esp+78h+VarName], eax ; char *
		call	sub_42091D
		mov	eax, [ebp+var_20]
		mov	[esp+78h+VarName], eax
		call	gcry_free
		mov	ds:dword_430314, 1
		jmp	loc_41C6A4
; ---------------------------------------------------------------------------

loc_41CBB3:				; CODE XREF: sub_41C657+525j
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_6C], 0
		mov	edx, [ebp+var_24]
		mov	[esp+78h+var_70], edx
		mov	edx, [ebp+var_20]
		mov	[esp+78h+Val], edx ; char
		mov	[esp+78h+VarName], eax
		call	assuan_socket_connect
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_20]
		mov	[esp+78h+VarName], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	[esp+78h+VarName], eax
		call	sub_41C1DE
		cmp	eax, 103h
		jnz	short loc_41CC17
		mov	[esp+78h+VarName], offset aCanTConnectToT ; "can't connect to the agent - trying fal"...
		call	sub_420034
		mov	[esp+78h+VarName], eax ; char *
		call	sub_4208F3
		mov	ds:dword_430314, 1
		jmp	loc_41C6A4
; ---------------------------------------------------------------------------

loc_41CC17:				; CODE XREF: sub_41C657+468j
					; sub_41C657+59Bj
		cmp	[ebp+var_C], 0
		jz	short loc_41CC54
		mov	eax, [ebp+var_C]
		mov	[esp+78h+VarName], eax
		call	gpg_strerror
		mov	[esp+78h+Val], eax ; char
		mov	[esp+78h+VarName], offset aCanTConnectT_0 ; "can't connect to the agent: %s\n"
		call	sub_42091D
		mov	eax, [ebp+var_34]
		mov	[esp+78h+VarName], eax
		call	assuan_release
		mov	[esp+78h+VarName], 4Dh
		call	sub_41C1C3
		jmp	locret_41CCFF
; ---------------------------------------------------------------------------

loc_41CC54:				; CODE XREF: sub_41C657+5C4j
		cmp	[ebp+arg_20], 0
		jz	short loc_41CC66
		mov	[esp+78h+VarName], offset aConnectionToAg ; "connection	to agent established\n"
		call	sub_4209BA

loc_41CC66:				; CODE XREF: sub_41C657+601j
		mov	eax, [ebp+var_34]
		mov	[esp+78h+var_5C], 0
		mov	[esp+78h+var_60], 0
		mov	[esp+78h+var_64], 0
		mov	[esp+78h+var_68], 0
		mov	[esp+78h+var_6C], 0
		mov	[esp+78h+var_70], 0
		mov	[esp+78h+Val], offset aReset ; "RESET"
		mov	[esp+78h+VarName], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41CCDC
		mov	eax, [ebp+var_34]
		mov	edx, [ebp+arg_18]
		mov	[esp+78h+var_68], edx
		mov	edx, [ebp+arg_14]
		mov	[esp+78h+var_6C], edx
		mov	edx, [ebp+arg_10]
		mov	[esp+78h+var_70], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+78h+Val], edx
		mov	[esp+78h+VarName], eax
		call	sub_41C2DE
		mov	[ebp+var_C], eax

loc_41CCDC:				; CODE XREF: sub_41C657+659j
		cmp	[ebp+var_C], 0
		jz	short loc_41CCF2
		mov	eax, [ebp+var_34]
		mov	[esp+78h+VarName], eax
		call	assuan_release
		mov	eax, [ebp+var_C]
		jmp	short locret_41CCFF
; ---------------------------------------------------------------------------

loc_41CCF2:				; CODE XREF: sub_41C657+689j
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, 0

locret_41CCFF:				; CODE XREF: sub_41C657+48j
					; sub_41C657+176j ...
		leave
		retn
sub_41C657	endp

; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_430318
		test	eax, eax
		jnz	short loc_41CD71
		mov	ds:dword_430318, 1
		call	_getpid
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		xor	eax, edx
		mov	[ebp-14h], eax
		mov	dword ptr [esp], 0
		call	sub_4277C0
		mov	edx, eax
		mov	eax, [ebp-10h]
		xor	eax, edx
		mov	[ebp-18h], eax
		lea	eax, [ebp-14h]
		mov	eax, [eax]
		mov	ds:dword_43031C, eax
		mov	eax, offset dword_430320
		lea	edx, [ebp-18h]
		mov	edx, [edx]
		mov	[eax], edx

loc_41CD71:				; CODE XREF: .text:0041CD2Aj
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 8
		mov	eax, offset dword_43031C
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41CD81	proc near		; CODE XREF: sub_41C657+33Ep

dwMilliseconds	= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		imul	eax, 3E8h
		mov	[esp+18h+dwMilliseconds], eax ;	dwMilliseconds
		mov	eax, ds:Sleep
		call	eax ; Sleep
		sub	esp, 4
		leave
		retn
sub_41CD81	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41CD9F	proc near		; CODE XREF: .text:0041CE0Cp

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+arg_0], 0FFFFFFFFh
		jnz	short loc_41CDB2
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41CDEC
; ---------------------------------------------------------------------------

loc_41CDB2:				; CODE XREF: sub_41CD9F+Aj
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	edx, al
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_41CDE9
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aFailedToTransl ; "failed to translate	osfhandle %p\n"
		call	sub_42091D

loc_41CDE9:				; CODE XREF: sub_41CD9F+35j
		mov	eax, [ebp+var_C]

locret_41CDEC:				; CODE XREF: sub_41CD9F+11j
		leave
		retn
sub_41CD9F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+8], 2
		jg	short loc_41CDFF
		mov	eax, [ebp+8]
		jmp	short locret_41CE11
; ---------------------------------------------------------------------------

loc_41CDFF:				; CODE XREF: .text:0041CDF8j
		mov	eax, [ebp+8]
		mov	edx, [ebp+0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_41CD9F

locret_41CE11:				; CODE XREF: .text:0041CDFDj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 184h
		mov	eax, ds:GetCurrentProcessId
		call	eax ; GetCurrentProcessId
		mov	[ebp-1Ch], eax
		lea	eax, [ebp-158h]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	dword ptr [ebp-158h], 0Ch
		mov	dword ptr [ebp-150h], 1
		lea	eax, [ebp-14Ch]
		mov	[esp+4], eax
		mov	dword ptr [esp], 105h
		mov	eax, ds:GetTempPathA
		call	eax ; GetTempPathA
		sub	esp, 8
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-20h], 0
		jz	short loc_41CEB1
		cmp	dword ptr [ebp-20h], 104h
		jg	short loc_41CEB1
		lea	eax, [ebp-14Ch]
		mov	dword ptr [ebp-15Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-15Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 104h
		jbe	short loc_41CEC8

loc_41CEB1:				; CODE XREF: .text:0041CE77j
					; .text:0041CE80j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 2
		mov	eax, 0
		jmp	loc_41D0B6
; ---------------------------------------------------------------------------

loc_41CEC8:				; CODE XREF: .text:0041CEAFj
		lea	eax, [ebp-14Ch]
		mov	dword ptr [ebp-15Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-15Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp-14Ch]
		add	eax, edx
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	dword ptr [eax], 756E675Fh
		mov	word ptr [eax+4], 6770h
		mov	byte ptr [eax+6], 0
		add	dword ptr [ebp-10h], 6
		mov	dword ptr [esp+4], 0
		lea	eax, [ebp-14Ch]
		mov	[esp], eax
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	5Ch
		add	dword ptr [ebp-10h], 1
		mov	eax, [ebp-10h]
		mov	[ebp-24h], eax
		mov	dword ptr [ebp-0Ch], 0
		jmp	loc_41D09A
; ---------------------------------------------------------------------------

loc_41CF49:				; CODE XREF: .text:0041D09Ej
		mov	eax, [ebp-24h]
		mov	[ebp-10h], eax
		mov	eax, ds:GetTickCount
		call	eax ; GetTickCount
		mov	edx, [ebp-1Ch]
		shl	edx, 10h
		xor	eax, edx
		mov	[ebp-14h], eax
		mov	dword ptr [ebp-18h], 0
		jmp	short loc_41CF9A
; ---------------------------------------------------------------------------

loc_41CF6A:				; CODE XREF: .text:0041CF9Ej
		mov	eax, [ebp-14h]
		shr	eax, 1Ch
		cmp	eax, 9
		ja	short loc_41CF80
		mov	eax, [ebp-14h]
		shr	eax, 1Ch
		add	eax, 30h
		jmp	short loc_41CF89
; ---------------------------------------------------------------------------

loc_41CF80:				; CODE XREF: .text:0041CF73j
		mov	eax, [ebp-14h]
		shr	eax, 1Ch
		add	eax, 37h

loc_41CF89:				; CODE XREF: .text:0041CF7Ej
		mov	edx, [ebp-10h]
		mov	[edx], al
		add	dword ptr [ebp-10h], 1
		shl	dword ptr [ebp-14h], 4
		add	dword ptr [ebp-18h], 1

loc_41CF9A:				; CODE XREF: .text:0041CF68j
		cmp	dword ptr [ebp-18h], 7
		jle	short loc_41CF6A
		mov	edx, offset a_tmp_0 ; ".tmp"
		mov	eax, [ebp-10h]
		mov	ecx, [edx]
		mov	[eax], ecx
		movzx	edx, byte ptr [edx+4]
		mov	[eax+4], dl
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 4000100h
		mov	dword ptr [esp+10h], 1
		lea	eax, [ebp-158h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0C0000000h
		lea	eax, [ebp-14Ch]
		mov	[esp], eax
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp-28h], eax
		cmp	dword ptr [ebp-28h], 0FFFFFFFFh
		jz	loc_41D085
		mov	eax, [ebp-28h]
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebp-2Ch], eax
		cmp	dword ptr [ebp-2Ch], 0FFFFFFFFh
		jnz	short loc_41D03A
		mov	eax, [ebp-28h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		jmp	short loc_41D0B6
; ---------------------------------------------------------------------------

loc_41D03A:				; CODE XREF: .text:0041D021j
		mov	dword ptr [esp+4], offset aWB ;	"w+b"
		mov	eax, [ebp-2Ch]
		mov	[esp], eax
		call	_fdopen
		mov	[ebp-30h], eax
		cmp	dword ptr [ebp-30h], 0
		jnz	short loc_41D080
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp-34h], eax
		mov	eax, [ebp-2Ch]
		mov	[esp], eax
		call	_close
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp-34h]
		mov	[eax], edx
		mov	eax, 0
		jmp	short loc_41D0B6
; ---------------------------------------------------------------------------

loc_41D080:				; CODE XREF: .text:0041D054j
		mov	eax, [ebp-30h]
		jmp	short loc_41D0B6
; ---------------------------------------------------------------------------

loc_41D085:				; CODE XREF: .text:0041CFFFj
		mov	dword ptr [esp], 1
		mov	eax, ds:Sleep
		call	eax ; Sleep
		sub	esp, 4
		add	dword ptr [ebp-0Ch], 1

loc_41D09A:				; CODE XREF: .text:0041CF44j
		cmp	dword ptr [ebp-0Ch], 9
		jle	loc_41CF49
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 2
		mov	eax, 0

loc_41D0B6:				; CODE XREF: .text:0041CEC3j
					; .text:0041D038j ...
		mov	edi, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41D0C0(DWORD)
sub_41D0C0	proc near		; CODE XREF: sub_40DAE8+6Bp
					; .text:0041DF19p

dwProcessId	= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_41D0E9
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_10], eax
		mov	dword ptr [esp+18h+var_14], offset aGnupg_allow_se ; "gnupg_allow_set_foregound_window"
		mov	[esp+18h+dwProcessId], offset aSCalledWithInv ;	"%s called with	invalid	pid %lu\n"
		call	sub_4208F3
		jmp	short locret_41D12D
; ---------------------------------------------------------------------------

loc_41D0E9:				; CODE XREF: sub_41D0C0+Aj
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jz	short loc_41D0F4
		mov	eax, [ebp+arg_0]
		jmp	short loc_41D0F9
; ---------------------------------------------------------------------------

loc_41D0F4:				; CODE XREF: sub_41D0C0+2Dj
		mov	eax, 0FFFFFFFFh

loc_41D0F9:				; CODE XREF: sub_41D0C0+32j
		mov	[esp+18h+dwProcessId], eax ; dwProcessId
		mov	eax, ds:AllowSetForegroundWindow
		call	eax ; AllowSetForegroundWindow
		sub	esp, 4
		test	eax, eax
		jnz	short locret_41D12D
		mov	[esp+18h+dwProcessId], 0FFFFFFFFh ; DWORD
		call	sub_421C5A
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+var_10], eax
		mov	dword ptr [esp+18h+var_14], edx	; char
		mov	[esp+18h+dwProcessId], offset aAllowsetforegr ;	"AllowSetForegroundWindow(%lu) failed: %"...
		call	sub_4208F3

locret_41D12D:				; CODE XREF: sub_41D0C0+27j
					; sub_41D0C0+48j
		leave
		retn
sub_41D0C0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-20h], 0
		mov	dword ptr [ebp-10h], 0
		mov	dword ptr [ebp-14h], 0
		mov	eax, ds:GetCurrentProcessId
		call	eax ; GetCurrentProcessId
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp], 400h
		mov	eax, ds:OpenProcess
		call	eax ; OpenProcess
		sub	esp, 0Ch
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jz	loc_41D2A8
		lea	eax, [ebp-20h]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 8
		mov	eax, [ebp-18h]
		mov	[esp], eax
		mov	eax, ds:OpenProcessToken
		call	eax ; OpenProcessToken
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_41D2AB
		mov	eax, [ebp-20h]
		lea	edx, [ebp-24h]
		mov	[esp+10h], edx
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		mov	eax, ds:GetTokenInformation
		call	eax ; GetTokenInformation
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_41D1F3
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		cmp	eax, 7Ah
		jnz	loc_41D2AE

loc_41D1F3:				; CODE XREF: .text:0041D1E1j
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	gcry_malloc
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	loc_41D2B1
		mov	edx, [ebp-24h]
		mov	eax, [ebp-20h]
		lea	ecx, [ebp-24h]
		mov	[esp+10h], ecx
		mov	[esp+0Ch], edx
		mov	edx, [ebp-10h]
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		mov	eax, ds:GetTokenInformation
		call	eax ; GetTokenInformation
		sub	esp, 14h
		test	eax, eax
		jz	short loc_41D2B4
		mov	eax, [ebp-10h]
		mov	eax, [eax]
		mov	[esp], eax
		mov	eax, ds:IsValidSid
		call	eax ; IsValidSid
		sub	esp, 4
		test	eax, eax
		jz	short loc_41D2B7
		mov	eax, [ebp-10h]
		mov	eax, [eax]
		mov	[esp], eax
		mov	eax, ds:GetLengthSid
		call	eax ; GetLengthSid
		sub	esp, 4
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	gcry_malloc
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_41D2BA
		mov	eax, [ebp-10h]
		mov	eax, [eax]
		mov	[esp+8], eax
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		mov	eax, ds:CopySid
		call	eax ; CopySid
		sub	esp, 0Ch
		test	eax, eax
		jz	short loc_41D2BD
		mov	dword ptr [ebp-0Ch], 1
		jmp	short loc_41D2BE
; ---------------------------------------------------------------------------

loc_41D2A8:				; CODE XREF: .text:0041D183j
		nop
		jmp	short loc_41D2BE
; ---------------------------------------------------------------------------

loc_41D2AB:				; CODE XREF: .text:0041D1AAj
		nop
		jmp	short loc_41D2BE
; ---------------------------------------------------------------------------

loc_41D2AE:				; CODE XREF: .text:0041D1EDj
		nop
		jmp	short loc_41D2BE
; ---------------------------------------------------------------------------

loc_41D2B1:				; CODE XREF: .text:0041D205j
		nop
		jmp	short loc_41D2BE
; ---------------------------------------------------------------------------

loc_41D2B4:				; CODE XREF: .text:0041D23Aj
		nop
		jmp	short loc_41D2BE
; ---------------------------------------------------------------------------

loc_41D2B7:				; CODE XREF: .text:0041D250j
		nop
		jmp	short loc_41D2BE
; ---------------------------------------------------------------------------

loc_41D2BA:				; CODE XREF: .text:0041D279j
		nop
		jmp	short loc_41D2BE
; ---------------------------------------------------------------------------

loc_41D2BD:				; CODE XREF: .text:0041D29Dj
		nop

loc_41D2BE:				; CODE XREF: .text:0041D2A6j
					; .text:0041D2A9j ...
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	gcry_free
		mov	eax, [ebp-20h]
		test	eax, eax
		jz	short loc_41D2E0
		mov	eax, [ebp-20h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_41D2E0:				; CODE XREF: .text:0041D2CEj
		cmp	dword ptr [ebp-18h], 0
		jz	short loc_41D2F6
		mov	eax, [ebp-18h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_41D2F6:				; CODE XREF: .text:0041D2E4j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_41D30E
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	gcry_free
		mov	dword ptr [ebp-14h], 0

loc_41D30E:				; CODE XREF: .text:0041D2FAj
		mov	eax, [ebp-14h]
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41D314	proc near		; CODE XREF: sub_40DBAB+214p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short locret_41D362
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx

locret_41D362:				; CODE XREF: sub_41D314+3Dj
		leave
		retn
sub_41D314	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41D364	proc near		; CODE XREF: sub_40DBAB+1FCp

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax
		call	gcry_malloc_secure
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short locret_41D3B2
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx

locret_41D3B2:				; CODE XREF: sub_41D364+3Dj
		leave
		retn
sub_41D364	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41D3B4(int, void *, size_t)
sub_41D3B4	proc near		; CODE XREF: sub_40DB79+26p
					; sub_40DBAB+31Cp ...

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	loc_41D4A1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	loc_41D46B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		add	eax, [ebp+arg_8]
		lea	edx, [eax+400h]
		mov	eax, [ebp+arg_0]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+Src], edx
		mov	[esp+28h+Dst], eax
		call	gcry_realloc
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_41D462
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_41D42E
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		jmp	short loc_41D433
; ---------------------------------------------------------------------------

loc_41D42E:				; CODE XREF: sub_41D3B4+6Dj
		mov	eax, 0Ch

loc_41D433:				; CODE XREF: sub_41D3B4+78j
		mov	edx, [ebp+arg_0]
		mov	[edx+0Ch], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		jmp	short loc_41D45A
; ---------------------------------------------------------------------------

loc_41D44C:				; CODE XREF: sub_41D3B4+AAj
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1

loc_41D45A:				; CODE XREF: sub_41D3B4+96j
		cmp	[ebp+var_10], 0
		jnz	short loc_41D44C
		jmp	short locret_41D4A2
; ---------------------------------------------------------------------------

loc_41D462:				; CODE XREF: sub_41D3B4+60j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		mov	[eax+8], edx

loc_41D46B:				; CODE XREF: sub_41D3B4+26j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		add	eax, edx
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		jmp	short locret_41D4A2
; ---------------------------------------------------------------------------

loc_41D4A1:				; CODE XREF: sub_41D3B4+Ej
		nop

locret_41D4A2:				; CODE XREF: sub_41D3B4+ACj
					; sub_41D3B4+EBj
		leave
		retn
sub_41D3B4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41D3B4
		add	esp, 24h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41D4E6	proc near		; CODE XREF: sub_40DBAB+2C3p
					; sub_40DBAB+332p

var_28		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_41D555
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41D53F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		jmp	short loc_41D521
; ---------------------------------------------------------------------------

loc_41D513:				; CODE XREF: sub_41D4E6+3Fj
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1

loc_41D521:				; CODE XREF: sub_41D4E6+2Bj
		cmp	[ebp+var_10], 0
		jnz	short loc_41D513
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0

loc_41D53F:				; CODE XREF: sub_41D4E6+18j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+0Ch]
		mov	[eax], edx
		mov	eax, 0
		jmp	short locret_41D585
; ---------------------------------------------------------------------------

loc_41D555:				; CODE XREF: sub_41D4E6+Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_41D56E
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx

loc_41D56E:				; CODE XREF: sub_41D4E6+7Cj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0Ch
		mov	eax, [ebp+var_14]

locret_41D585:				; CODE XREF: sub_41D4E6+6Dj
		leave
		retn
sub_41D4E6	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41D588	proc near		; CODE XREF: sub_41D5AF+14p
					; sub_41E25F+185p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_41D5A8
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_41D5AD
; ---------------------------------------------------------------------------

loc_41D5A8:				; CODE XREF: sub_41D588+7j
		mov	eax, 0

loc_41D5AD:				; CODE XREF: sub_41D588+1Ej
		pop	ebp
		retn
sub_41D588	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41D5AF	proc near		; CODE XREF: sub_41D5CA+Ep
					; .text:0041DBA6p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_41D588
		leave
		retn
sub_41D5AF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41D5CA	proc near		; CODE XREF: sub_41D87B+ECp
					; .text:0041DF98p ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_41D5AF
		leave
		retn
sub_41D5CA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41D5DF	proc near		; CODE XREF: .text:0041D614p
					; .text:0041D6C5p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0FFFFFFFFh
		cmp	[ebp+var_4], 0FFFFFFFFh
		jnz	short loc_41D5F9
		mov	[ebp+var_4], 100h

loc_41D5F9:				; CODE XREF: sub_41D5DF+11j
		cmp	[ebp+var_4], 7FFFFFFFh
		jnz	short loc_41D609
		mov	[ebp+var_4], 100h

loc_41D609:				; CODE XREF: sub_41D5DF+21j
		mov	eax, [ebp+var_4]
		leave
		retn
sub_41D5DF	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_41D5DF
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_41D691
		mov	dword ptr [ebp-14h], 0
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_41D687
; ---------------------------------------------------------------------------

loc_41D631:				; CODE XREF: .text:0041D68Dj
		mov	eax, [ebp-14h]
		mov	[ebp-10h], eax
		jmp	short loc_41D658
; ---------------------------------------------------------------------------

loc_41D639:				; CODE XREF: .text:0041D666j
		mov	eax, [ebp-10h]
		shl	eax, 2
		add	eax, [ebp+0Ch]
		mov	eax, [eax]
		cmp	eax, [ebp-0Ch]
		jnz	short loc_41D654
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[ebp-14h], eax
		jmp	short loc_41D668
; ---------------------------------------------------------------------------

loc_41D654:				; CODE XREF: .text:0041D647j
		add	dword ptr [ebp-10h], 1

loc_41D658:				; CODE XREF: .text:0041D637j
		mov	eax, [ebp-10h]
		shl	eax, 2
		add	eax, [ebp+0Ch]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_41D639

loc_41D668:				; CODE XREF: .text:0041D652j
		mov	eax, [ebp-10h]
		shl	eax, 2
		add	eax, [ebp+0Ch]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_41D683
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	_close

loc_41D683:				; CODE XREF: .text:0041D676j
		add	dword ptr [ebp-0Ch], 1

loc_41D687:				; CODE XREF: .text:0041D62Fj
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp-18h]
		jl	short loc_41D631
		jmp	short loc_41D6B0
; ---------------------------------------------------------------------------

loc_41D691:				; CODE XREF: .text:0041D620j
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_41D6A8
; ---------------------------------------------------------------------------

loc_41D699:				; CODE XREF: .text:0041D6AEj
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	_close
		add	dword ptr [ebp-0Ch], 1

loc_41D6A8:				; CODE XREF: .text:0041D697j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp-18h]
		jl	short loc_41D699

loc_41D6B0:				; CODE XREF: .text:0041D68Fj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		call	sub_41D5DF
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-10h], 20h
		mov	dword ptr [esp+4], 4
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	calloc
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_41D6FA
		mov	eax, 0
		jmp	locret_41D7C1
; ---------------------------------------------------------------------------

loc_41D6FA:				; CODE XREF: .text:0041D6EEj
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-14h], 0
		jmp	loc_41D7A3
; ---------------------------------------------------------------------------

loc_41D70D:				; CODE XREF: .text:0041D7A9j
		lea	eax, [ebp-50h]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_41D734
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 9
		jz	short loc_41D79F

loc_41D734:				; CODE XREF: .text:0041D724j
		mov	eax, [ebp-18h]
		add	eax, 1
		cmp	eax, [ebp-10h]
		jb	short loc_41D78D
		cmp	dword ptr [ebp-10h], 0FFh
		ja	short loc_41D74F
		mov	eax, 20h
		jmp	short loc_41D754
; ---------------------------------------------------------------------------

loc_41D74F:				; CODE XREF: .text:0041D746j
		mov	eax, 100h

loc_41D754:				; CODE XREF: .text:0041D74Dj
		add	[ebp-10h], eax
		mov	eax, [ebp-10h]
		shl	eax, 2
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	realloc
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-20h], 0
		jnz	short loc_41D787
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	free
		mov	eax, 0
		jmp	short locret_41D7C1
; ---------------------------------------------------------------------------

loc_41D787:				; CODE XREF: .text:0041D773j
		mov	eax, [ebp-20h]
		mov	[ebp-0Ch], eax

loc_41D78D:				; CODE XREF: .text:0041D73Dj
		mov	eax, [ebp-18h]
		shl	eax, 2
		add	eax, [ebp-0Ch]
		mov	edx, [ebp-14h]
		mov	[eax], edx
		add	dword ptr [ebp-18h], 1

loc_41D79F:				; CODE XREF: .text:0041D732j
		add	dword ptr [ebp-14h], 1

loc_41D7A3:				; CODE XREF: .text:0041D708j
		mov	eax, [ebp-14h]
		cmp	eax, [ebp-1Ch]
		jl	loc_41D70D
		mov	eax, [ebp-18h]
		shl	eax, 2
		add	eax, [ebp-0Ch]
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	eax, [ebp-0Ch]

locret_41D7C1:				; CODE XREF: .text:0041D6F5j
					; .text:0041D785j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41D7C3(int, char *)
sub_41D7C3	proc near		; CODE XREF: sub_41D87B+100p
					; sub_41D87B+130p

Str		= dword	ptr -28h
Control		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41D7EE
		mov	eax, [ebp+var_C]
		mov	word ptr [eax],	2222h
		mov	byte ptr [eax+2], 0
		add	[ebp+var_C], 2
		jmp	loc_41D876
; ---------------------------------------------------------------------------

loc_41D7EE:				; CODE XREF: sub_41D7C3+14j
		mov	[esp+28h+Control], offset Control ; " \t\n\v"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strpbrk
		test	eax, eax
		jz	short loc_41D861
		mov	eax, [ebp+var_C]
		mov	word ptr [eax],	22h
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		jmp	short loc_41D845
; ---------------------------------------------------------------------------

loc_41D819:				; CODE XREF: sub_41D7C3+8Aj
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_41D841
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_41D841:				; CODE XREF: sub_41D7C3+6Dj
		add	[ebp+var_10], 1

loc_41D845:				; CODE XREF: sub_41D7C3+54j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41D819
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	22h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		jmp	short loc_41D876
; ---------------------------------------------------------------------------

loc_41D861:				; CODE XREF: sub_41D7C3+40j
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Control], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_421FFD
		mov	[ebp+var_C], eax

loc_41D876:				; CODE XREF: sub_41D7C3+26j
					; sub_41D7C3+9Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41D7C3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41D87B(char *, int, int)
sub_41D87B	proc near		; CODE XREF: .text:0041DD4Ep
					; sub_41DFF0+69p ...

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_10]
		add	eax, edx
		add	eax, 3
		mov	[ebp+var_10], eax
		jmp	short loc_41D8D6
; ---------------------------------------------------------------------------

loc_41D8C4:				; CODE XREF: sub_41D87B+63j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_41D8D2
		add	[ebp+var_10], 1

loc_41D8D2:				; CODE XREF: sub_41D87B+51j
		add	[ebp+var_14], 1

loc_41D8D6:				; CODE XREF: sub_41D87B+47j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41D8C4
		mov	[ebp+var_C], 0
		jmp	short loc_41D935
; ---------------------------------------------------------------------------

loc_41D8E9:				; CODE XREF: sub_41D87B+CCj
		mov	eax, [ebp+var_14]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_10]
		add	eax, edx
		add	eax, 3
		mov	[ebp+var_10], eax
		jmp	short loc_41D927
; ---------------------------------------------------------------------------

loc_41D915:				; CODE XREF: sub_41D87B+B4j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_41D923
		add	[ebp+var_10], 1

loc_41D923:				; CODE XREF: sub_41D87B+A2j
		add	[ebp+var_14], 1

loc_41D927:				; CODE XREF: sub_41D87B+98j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41D915
		add	[ebp+var_C], 1

loc_41D935:				; CODE XREF: sub_41D87B+6Cj
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_41D8E9
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_malloc
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_41D96E
		call	sub_41D5CA
		jmp	short loc_41D9D3
; ---------------------------------------------------------------------------

loc_41D96E:				; CODE XREF: sub_41D87B+EAj
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_44], eax ;	char *
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_41D7C3
		mov	[ebp+var_18], eax
		mov	[ebp+var_C], 0
		jmp	short loc_41D9B7
; ---------------------------------------------------------------------------

loc_41D98C:				; CODE XREF: sub_41D87B+149j
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	20h
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+48h+var_44], eax ;	char *
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_41D7C3
		mov	[ebp+var_18], eax
		add	[ebp+var_C], 1

loc_41D9B7:				; CODE XREF: sub_41D87B+10Fj
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41D98C
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_1C]
		mov	[eax], edx
		mov	eax, 0

loc_41D9D3:				; CODE XREF: sub_41D87B+F1j
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_41D87B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41D9D9	proc near		; CODE XREF: .text:0041DBB4p
					; .text:0041DD6Dp

hReadPipe	= dword	ptr -48h
hWritePipe	= dword	ptr -44h
lpPipeAttributes= dword	ptr -40h
nSize		= dword	ptr -3Ch
dwDesiredAccess	= dword	ptr -38h
bInheritHandle	= dword	ptr -34h
dwOptions	= dword	ptr -30h
PipeAttributes	= _SECURITY_ATTRIBUTES ptr -20h
TargetHandle	= dword	ptr -14h
hSourceHandle	= dword	ptr -10h
hObject		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 40h
		lea	eax, [ebp+PipeAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+PipeAttributes.nLength], 0Ch
		mov	[ebp+PipeAttributes.bInheritHandle], 0
		mov	[esp+48h+nSize], 0 ; nSize
		lea	eax, [ebp+PipeAttributes]
		mov	[esp+48h+lpPipeAttributes], eax	; lpPipeAttributes
		lea	eax, [ebp+hSourceHandle]
		mov	[esp+48h+hWritePipe], eax ; hWritePipe
		lea	eax, [ebp+hObject]
		mov	[esp+48h+hReadPipe], eax ; hReadPipe
		mov	eax, ds:CreatePipe
		call	eax ; CreatePipe
		sub	esp, 10h
		test	eax, eax
		jnz	short loc_41DA3A
		mov	eax, 0FFFFFFFFh
		jmp	loc_41DAF8
; ---------------------------------------------------------------------------

loc_41DA3A:				; CODE XREF: sub_41D9D9+55j
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	ebx, eax
		mov	esi, [ebp+hSourceHandle]
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp+48h+dwOptions], 2 ; dwOptions
		mov	[esp+48h+bInheritHandle], 1 ; bInheritHandle
		mov	[esp+48h+dwDesiredAccess], 0 ; dwDesiredAccess
		lea	edx, [ebp+TargetHandle]
		mov	[esp+48h+nSize], edx ; lpTargetHandle
		mov	[esp+48h+lpPipeAttributes], ebx	; hTargetProcessHandle
		mov	[esp+48h+hWritePipe], esi ; hSourceHandle
		mov	[esp+48h+hReadPipe], eax ; hSourceProcessHandle
		mov	eax, ds:DuplicateHandle
		call	eax ; DuplicateHandle
		sub	esp, 1Ch
		test	eax, eax
		jnz	short loc_41DAC8
		mov	[esp+48h+hReadPipe], 0FFFFFFFFh	; DWORD
		call	sub_421C5A
		mov	[esp+48h+hWritePipe], eax ; char
		mov	[esp+48h+hReadPipe], offset aDuplicatehandl ; "DuplicateHandle failed: %s\n"
		call	sub_42091D
		mov	eax, [ebp+hObject]
		mov	[esp+48h+hReadPipe], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+hSourceHandle]
		mov	[esp+48h+hReadPipe], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0FFFFFFFFh
		jmp	short loc_41DAF8
; ---------------------------------------------------------------------------

loc_41DAC8:				; CODE XREF: sub_41D9D9+AAj
		mov	eax, [ebp+hSourceHandle]
		mov	[esp+48h+hReadPipe], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+TargetHandle]
		mov	[ebp+hSourceHandle], eax
		mov	eax, [ebp+hObject]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+4]
		mov	eax, [ebp+hSourceHandle]
		mov	[edx], eax
		mov	eax, 0

loc_41DAF8:				; CODE XREF: sub_41D9D9+5Cj
					; sub_41D9D9+EDj
		lea	esp, [ebp-8]
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_41D9D9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41DAFF	proc near		; CODE XREF: sub_41DFF0+B5p
					; sub_41DFF0+D1p ...

lpFileName	= dword	ptr -38h
dwDesiredAccess	= dword	ptr -34h
dwShareMode	= dword	ptr -30h
lpSecurityAttributes= dword ptr	-2Ch
dwCreationDisposition= dword ptr -28h
dwFlagsAndAttributes= dword ptr	-24h
hTemplateFile	= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_0], 0
		jz	short loc_41DB12
		mov	eax, 40000000h
		jmp	short loc_41DB17
; ---------------------------------------------------------------------------

loc_41DB12:				; CODE XREF: sub_41DAFF+Aj
		mov	eax, 80000000h

loc_41DB17:				; CODE XREF: sub_41DAFF+11j
		mov	[esp+38h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+38h+dwFlagsAndAttributes],	0 ; dwFlagsAndAttributes
		mov	[esp+38h+dwCreationDisposition], 3 ; dwCreationDisposition
		mov	[esp+38h+lpSecurityAttributes],	0 ; lpSecurityAttributes
		mov	[esp+38h+dwShareMode], 3 ; dwShareMode
		mov	[esp+38h+dwDesiredAccess], eax ; dwDesiredAccess
		mov	[esp+38h+lpFileName], offset FileName ;	"nul"
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_41DB79
		mov	[esp+38h+lpFileName], 0FFFFFFFFh ; DWORD
		call	sub_421C5A
		mov	[esp+38h+dwDesiredAccess], eax ; char
		mov	[esp+38h+lpFileName], offset aCanTOpenNulS ; "can't open `nul': %s\n"
		call	sub_4209BA

loc_41DB79:				; CODE XREF: sub_41DAFF+5Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41DAFF	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, [ebp+8]
		add	eax, 4
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	dword ptr [esp], 1
		call	sub_41D5AF
		mov	[ebp-0Ch], eax
		lea	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_41D9D9
		test	eax, eax
		jnz	loc_41DC76
		mov	eax, [ebp-14h]
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	edx, [ebp+8]
		mov	[edx], eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_41DC0A
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aFailedToTran_0	; "failed to translate osfhandle %p\n"
		call	sub_42091D
		mov	eax, [ebp-10h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		jmp	short loc_41DC76
; ---------------------------------------------------------------------------

loc_41DC0A:				; CODE XREF: .text:0041DBE3j
		mov	eax, [ebp+8]
		lea	ebx, [eax+4]
		mov	eax, [ebp-10h]
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebx], eax
		mov	eax, [ebp+8]
		add	eax, 4
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_41DC6F
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aFailedToTran_0	; "failed to translate osfhandle %p\n"
		call	sub_42091D
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[esp], eax
		call	_close
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	eax, [ebp-10h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		jmp	short loc_41DC76
; ---------------------------------------------------------------------------

loc_41DC6F:				; CODE XREF: .text:0041DC32j
		mov	dword ptr [ebp-0Ch], 0

loc_41DC76:				; CODE XREF: .text:0041DBBBj
					; .text:0041DC08j ...
		mov	eax, [ebp-0Ch]
		mov	ebx, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0B0h
		mov	dword ptr [ebp-38h], 0
		mov	dword ptr [ebp-34h], 0
		mov	dword ptr [ebp-30h], 0
		mov	dword ptr [ebp-2Ch], 0
		mov	eax, [ebp+20h]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+24h]
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	fflush
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	rewind
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	_fileno
		mov	[esp], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	_fileno
		mov	[esp], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	short loc_41DD09
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_41DD15

loc_41DD09:				; CODE XREF: .text:0041DD01j
		mov	dword ptr [esp], offset	aNoFileDescript	; "no file descriptor for file passed to g"...
		call	sub_420960
; ---------------------------------------------------------------------------

loc_41DD15:				; CODE XREF: .text:0041DD07j
		lea	eax, [ebp-28h]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	dword ptr [ebp-28h], 0Ch
		mov	dword ptr [ebp-20h], 0
		lea	eax, [ebp-80h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41D87B
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_41DD64
		mov	eax, [ebp-14h]
		jmp	loc_41DFE9
; ---------------------------------------------------------------------------

loc_41DD64:				; CODE XREF: .text:0041DD5Aj
		lea	eax, [ebp-88h]
		mov	[esp], eax
		call	sub_41D9D9
		test	eax, eax
		jz	short loc_41DDBD
		mov	dword ptr [esp], 1
		call	sub_41D5AF
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	dword ptr [esp], offset	aErrorCreatingA	; "error creating a pipe: %s\n"
		call	sub_420034
		mov	[esp+4], ebx
		mov	[esp], eax
		call	sub_42091D
		mov	eax, [ebp-80h]
		mov	[esp], eax
		call	gcry_free
		mov	eax, [ebp-14h]
		jmp	loc_41DFE9
; ---------------------------------------------------------------------------

loc_41DDBD:				; CODE XREF: .text:0041DD74j
		lea	eax, [ebp-7Ch]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 11h
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	dword ptr [ebp-7Ch], 44h
		mov	dword ptr [ebp-50h], 101h
		mov	word ptr [ebp-4Ch], 5
		mov	eax, [ebp-0Ch]
		mov	[ebp-44h], eax
		mov	eax, [ebp-10h]
		mov	[ebp-40h], eax
		mov	eax, [ebp-84h]
		mov	[ebp-3Ch], eax
		mov	eax, [ebp+1Ch]
		and	eax, 80h
		test	eax, eax
		jz	short loc_41DE0E
		mov	ebx, 4000008h
		jmp	short loc_41DE13
; ---------------------------------------------------------------------------

loc_41DE0E:				; CODE XREF: .text:0041DE05j
		mov	ebx, 4000000h

loc_41DE13:				; CODE XREF: .text:0041DE0Cj
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp], eax
		mov	eax, ds:GetPriorityClass
		call	eax ; GetPriorityClass
		sub	esp, 4
		or	eax, ebx
		or	eax, 4
		mov	[ebp-18h], eax
		mov	edx, [ebp-18h]
		mov	eax, [ebp-80h]
		lea	ecx, [ebp-38h]
		mov	[esp+24h], ecx
		lea	ecx, [ebp-7Ch]
		mov	[esp+20h], ecx
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+18h], 0
		mov	[esp+14h], edx
		mov	dword ptr [esp+10h], 1
		lea	edx, [ebp-28h]
		mov	[esp+0Ch], edx
		lea	edx, [ebp-28h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		mov	eax, ds:CreateProcessA
		call	eax ; CreateProcessA
		sub	esp, 28h
		test	eax, eax
		jnz	short loc_41DEE3
		mov	dword ptr [esp], 0FFFFFFFFh
		call	sub_421C5A
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aCreateprocessF	; "CreateProcess failed: %s\n"
		call	sub_42091D
		mov	eax, [ebp-80h]
		mov	[esp], eax
		call	gcry_free
		mov	eax, [ebp-88h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp-84h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	dword ptr [esp], 1
		call	sub_41D5AF
		jmp	loc_41DFE9
; ---------------------------------------------------------------------------

loc_41DEE3:				; CODE XREF: .text:0041DE83j
		mov	eax, [ebp-80h]
		mov	[esp], eax
		call	gcry_free
		mov	dword ptr [ebp-80h], 0
		mov	eax, [ebp-84h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+1Ch]
		and	eax, 40h
		test	eax, eax
		jz	short loc_41DF1E
		mov	dword ptr [esp], 0FFFFFFFFh
		call	sub_41D0C0

loc_41DF1E:				; CODE XREF: .text:0041DF10j
		mov	eax, [ebp-34h]
		mov	[esp], eax
		mov	eax, ds:ResumeThread
		call	eax ; ResumeThread
		sub	esp, 4
		mov	eax, [ebp-34h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp-88h]
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebp-1Ch], eax
		cmp	dword ptr [ebp-1Ch], 0FFFFFFFFh
		jnz	short loc_41DF77
		mov	eax, [ebp-88h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aFailedToTran_0	; "failed to translate osfhandle %p\n"
		call	sub_42091D
		jmp	short loc_41DF8F
; ---------------------------------------------------------------------------

loc_41DF77:				; CODE XREF: .text:0041DF5Dj
		mov	dword ptr [esp+4], offset aR_0 ; "r"
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	_fdopen
		mov	edx, [ebp+20h]
		mov	[edx], eax

loc_41DF8F:				; CODE XREF: .text:0041DF75j
		mov	eax, [ebp+20h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41DFDA
		call	sub_41D5CA
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	dword ptr [esp], offset	aCanTFdopenPipe	; "can't fdopen pipe for reading: %s\n"
		call	sub_420034
		mov	[esp+4], ebx
		mov	[esp], eax
		call	sub_42091D
		mov	eax, [ebp-38h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp-14h]
		jmp	short loc_41DFE9
; ---------------------------------------------------------------------------

loc_41DFDA:				; CODE XREF: .text:0041DF96j
		mov	eax, [ebp-38h]
		mov	edx, eax
		mov	eax, [ebp+24h]
		mov	[eax], edx
		mov	eax, 0

loc_41DFE9:				; CODE XREF: .text:0041DD5Fj
					; .text:0041DDB8j ...
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41DFF0(LPCSTR	lpApplicationName, int,	int, int, int, int)
sub_41DFF0	proc near		; CODE XREF: sub_41C657+1D4p

hProcess	= dword	ptr -0B8h
lpCommandLine	= dword	ptr -0B4h
lpProcessAttributes= dword ptr -0B0h
lpThreadAttributes= dword ptr -0ACh
bInheritHandles	= dword	ptr -0A8h
dwCreationFlags	= dword	ptr -0A4h
lpEnvironment	= dword	ptr -0A0h
lpCurrentDirectory= dword ptr -9Ch
lpStartupInfo	= dword	ptr -98h
lpProcessInformation= dword ptr	-94h
hObject		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
StartupInfo	= _STARTUPINFOA	ptr -70h
ProcessInformation= _PROCESS_INFORMATION ptr -2Ch
ProcessAttributes= _SECURITY_ATTRIBUTES	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
lpApplicationName= dword ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0B0h
		mov	[ebp+ProcessInformation.hProcess], 0
		mov	[ebp+ProcessInformation.hThread], 0
		mov	[ebp+ProcessInformation.dwProcessId], 0
		mov	[ebp+ProcessInformation.dwThreadId], 0
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0FFFFFFFFh
		lea	eax, [ebp+ProcessAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+ProcessAttributes.nLength], 0Ch
		mov	[ebp+ProcessAttributes.bInheritHandle],	0
		lea	eax, [ebp+var_74]
		mov	[esp+0B8h+lpProcessAttributes],	eax ; int
		mov	eax, [ebp+arg_4]
		mov	[esp+0B8h+lpCommandLine], eax ;	int
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+0B8h+hProcess], eax ; char	*
		call	sub_41D87B
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41E06F
		mov	eax, [ebp+var_C]
		jmp	loc_41E258
; ---------------------------------------------------------------------------

loc_41E06F:				; CODE XREF: sub_41DFF0+75j
		lea	eax, [ebp+StartupInfo]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 11h
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	[ebp+StartupInfo.cb], 44h
		mov	[ebp+StartupInfo.dwFlags], 101h
		mov	[ebp+StartupInfo.wShowWindow], 5
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jnz	short loc_41E0AC
		mov	[esp+0B8h+hProcess], 0
		call	sub_41DAFF
		jmp	short loc_41E0B1
; ---------------------------------------------------------------------------

loc_41E0AC:				; CODE XREF: sub_41DFF0+ACj
		mov	eax, 0FFFFFFFFh

loc_41E0B1:				; CODE XREF: sub_41DFF0+BAj
		mov	[ebp+hObject], eax
		cmp	[ebp+arg_C], 0FFFFFFFFh
		jnz	short loc_41E0C8
		mov	[esp+0B8h+hProcess], 1
		call	sub_41DAFF
		jmp	short loc_41E0CD
; ---------------------------------------------------------------------------

loc_41E0C8:				; CODE XREF: sub_41DFF0+C8j
		mov	eax, 0FFFFFFFFh

loc_41E0CD:				; CODE XREF: sub_41DFF0+D6j
		mov	[ebp+var_7C], eax
		cmp	[ebp+arg_10], 0FFFFFFFFh
		jnz	short loc_41E0E4
		mov	[esp+0B8h+hProcess], 1
		call	sub_41DAFF
		jmp	short loc_41E0E9
; ---------------------------------------------------------------------------

loc_41E0E4:				; CODE XREF: sub_41DFF0+E4j
		mov	eax, 0FFFFFFFFh

loc_41E0E9:				; CODE XREF: sub_41DFF0+F2j
		mov	[ebp+var_78], eax
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jnz	short loc_41E0F7
		mov	eax, [ebp+hObject]
		jmp	short loc_41E104
; ---------------------------------------------------------------------------

loc_41E0F7:				; CODE XREF: sub_41DFF0+100j
		mov	eax, [ebp+arg_8]
		mov	[esp+0B8h+hProcess], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle

loc_41E104:				; CODE XREF: sub_41DFF0+105j
		mov	[ebp+StartupInfo.hStdInput], eax
		cmp	[ebp+arg_C], 0FFFFFFFFh
		jnz	short loc_41E112
		mov	eax, [ebp+var_7C]
		jmp	short loc_41E11F
; ---------------------------------------------------------------------------

loc_41E112:				; CODE XREF: sub_41DFF0+11Bj
		mov	eax, [ebp+arg_C]
		mov	[esp+0B8h+hProcess], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle

loc_41E11F:				; CODE XREF: sub_41DFF0+120j
		mov	[ebp+StartupInfo.hStdOutput], eax
		cmp	[ebp+arg_10], 0FFFFFFFFh
		jnz	short loc_41E12D
		mov	eax, [ebp+var_78]
		jmp	short loc_41E13A
; ---------------------------------------------------------------------------

loc_41E12D:				; CODE XREF: sub_41DFF0+136j
		mov	eax, [ebp+arg_10]
		mov	[esp+0B8h+hProcess], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle

loc_41E13A:				; CODE XREF: sub_41DFF0+13Bj
		mov	[ebp+StartupInfo.hStdError], eax
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp+0B8h+hProcess], eax ; hProcess
		mov	eax, ds:GetPriorityClass
		call	eax ; GetPriorityClass
		sub	esp, 4
		mov	ecx, eax
		or	ecx, 400000Ch
		mov	eax, [ebp+var_74]
		lea	edx, [ebp+ProcessInformation]
		mov	[esp+0B8h+lpProcessInformation], edx ; lpProcessInformation
		lea	edx, [ebp+StartupInfo]
		mov	[esp+0B8h+lpStartupInfo], edx ;	lpStartupInfo
		mov	[esp+0B8h+lpCurrentDirectory], 0 ; lpCurrentDirectory
		mov	[esp+0B8h+lpEnvironment], 0 ; lpEnvironment
		mov	[esp+0B8h+dwCreationFlags], ecx	; dwCreationFlags
		mov	[esp+0B8h+bInheritHandles], 1 ;	bInheritHandles
		lea	edx, [ebp+ProcessAttributes]
		mov	[esp+0B8h+lpThreadAttributes], edx ; lpThreadAttributes
		lea	edx, [ebp+ProcessAttributes]
		mov	[esp+0B8h+lpProcessAttributes],	edx ; lpProcessAttributes
		mov	[esp+0B8h+lpCommandLine], eax ;	lpCommandLine
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+0B8h+hProcess], eax ; lpApplicationName
		mov	eax, ds:CreateProcessA
		call	eax ; CreateProcessA
		sub	esp, 28h
		test	eax, eax
		jnz	short loc_41E1D9
		mov	[esp+0B8h+hProcess], 0FFFFFFFFh	; DWORD
		call	sub_421C5A
		mov	[esp+0B8h+lpCommandLine], eax ;	char
		mov	[esp+0B8h+hProcess], offset aCreateprocessF ; "CreateProcess failed: %s\n"
		call	sub_42091D
		mov	[esp+0B8h+hProcess], 1
		call	sub_41D5AF
		mov	[ebp+var_C], eax
		jmp	short loc_41E1E0
; ---------------------------------------------------------------------------

loc_41E1D9:				; CODE XREF: sub_41DFF0+1BAj
		mov	[ebp+var_C], 0

loc_41E1E0:				; CODE XREF: sub_41DFF0+1E7j
		mov	eax, [ebp+var_74]
		mov	[esp+0B8h+hProcess], eax
		call	gcry_free
		mov	[ebp+var_10], 0
		jmp	short loc_41E218
; ---------------------------------------------------------------------------

loc_41E1F4:				; CODE XREF: sub_41DFF0+22Cj
		mov	eax, [ebp+var_10]
		mov	eax, [ebp+eax*4+hObject]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_41E214
		mov	eax, [ebp+var_10]
		mov	eax, [ebp+eax*4+hObject]
		mov	[esp+0B8h+hProcess], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_41E214:				; CODE XREF: sub_41DFF0+20Ej
		add	[ebp+var_10], 1

loc_41E218:				; CODE XREF: sub_41DFF0+202j
		cmp	[ebp+var_10], 2
		jle	short loc_41E1F4
		cmp	[ebp+var_C], 0
		jz	short loc_41E229
		mov	eax, [ebp+var_C]
		jmp	short loc_41E258
; ---------------------------------------------------------------------------

loc_41E229:				; CODE XREF: sub_41DFF0+232j
		mov	eax, [ebp+ProcessInformation.hThread]
		mov	[esp+0B8h+hProcess], eax ; hThread
		mov	eax, ds:ResumeThread
		call	eax ; ResumeThread
		sub	esp, 4
		mov	eax, [ebp+ProcessInformation.hThread]
		mov	[esp+0B8h+hProcess], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+ProcessInformation.hProcess]
		mov	edx, eax
		mov	eax, [ebp+arg_14]
		mov	[eax], edx
		mov	eax, 0

loc_41E258:				; CODE XREF: sub_41DFF0+7Aj
					; sub_41DFF0+237j
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41DFF0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E25F	proc near		; CODE XREF: sub_41C657+21Ap

hHandle		= dword	ptr -28h
dwMilliseconds	= dword	ptr -24h
var_20		= dword	ptr -20h
ExitCode	= dword	ptr -18h
var_14		= byte ptr -14h
hProcess	= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= byte ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, dword ptr [ebp+arg_4]
		mov	[ebp+hProcess],	eax
		cmp	[ebp+arg_8], 0
		jz	short loc_41E27B
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0FFFFFFFFh

loc_41E27B:				; CODE XREF: sub_41E25F+11j
		cmp	dword ptr [ebp+arg_4], 0FFFFFFFFh
		jnz	short loc_41E292
		mov	[esp+28h+hHandle], 37h
		call	sub_41D5AF
		jmp	loc_41E3E9
; ---------------------------------------------------------------------------

loc_41E292:				; CODE XREF: sub_41E25F+20j
		mov	[esp+28h+dwMilliseconds], 0FFFFFFFFh ; dwMilliseconds
		mov	eax, [ebp+hProcess]
		mov	[esp+28h+hHandle], eax ; hHandle
		mov	eax, ds:WaitForSingleObject
		call	eax ; WaitForSingleObject
		sub	esp, 8
		mov	dword ptr [ebp+var_14],	eax
		mov	eax, dword ptr [ebp+var_14]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_41E2BE
		test	eax, eax
		jz	short loc_41E2F7
		jmp	loc_41E3B4
; ---------------------------------------------------------------------------

loc_41E2BE:				; CODE XREF: sub_41E25F+54j
		mov	[esp+28h+hHandle], 0FFFFFFFFh ;	DWORD
		call	sub_421C5A
		mov	ebx, eax
		mov	[esp+28h+hHandle], offset aWaitingForProc ; "waiting for process %d to terminate fai"...
		call	sub_420034
		mov	[esp+28h+var_20], ebx
		mov	edx, dword ptr [ebp+arg_4]
		mov	[esp+28h+dwMilliseconds], edx ;	char
		mov	[esp+28h+hHandle], eax ; char *
		call	sub_42091D
		mov	[ebp+var_C], 1
		jmp	loc_41E3D6
; ---------------------------------------------------------------------------

loc_41E2F7:				; CODE XREF: sub_41E25F+58j
		lea	eax, [ebp+ExitCode]
		mov	[esp+28h+dwMilliseconds], eax ;	lpExitCode
		mov	eax, [ebp+hProcess]
		mov	[esp+28h+hHandle], eax ; hProcess
		mov	eax, ds:GetExitCodeProcess
		call	eax ; GetExitCodeProcess
		sub	esp, 8
		test	eax, eax
		jnz	short loc_41E348
		mov	[esp+28h+hHandle], 0FFFFFFFFh ;	DWORD
		call	sub_421C5A
		mov	ebx, eax
		mov	[esp+28h+hHandle], offset aErrorGettingEx ; "error getting exit	code of	process	%d: "...
		call	sub_420034
		mov	[esp+28h+var_20], ebx
		mov	edx, dword ptr [ebp+arg_4]
		mov	[esp+28h+dwMilliseconds], edx ;	char
		mov	[esp+28h+hHandle], eax ; char *
		call	sub_42091D
		mov	[ebp+var_C], 1
		jmp	short loc_41E3A2
; ---------------------------------------------------------------------------

loc_41E348:				; CODE XREF: sub_41E25F+B1j
		mov	eax, [ebp+ExitCode]
		test	eax, eax
		jz	short loc_41E38C
		mov	eax, [ebp+ExitCode]
		mov	ebx, eax
		mov	[esp+28h+hHandle], offset aErrorRunningSE ; "error running `%s': exit status %d\n"
		call	sub_420034
		mov	[esp+28h+var_20], ebx
		mov	edx, dword ptr [ebp+arg_0]
		mov	[esp+28h+dwMilliseconds], edx ;	char
		mov	[esp+28h+hHandle], eax ; char *
		call	sub_42091D
		cmp	[ebp+arg_8], 0
		jz	short loc_41E383
		mov	eax, [ebp+ExitCode]
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_41E383:				; CODE XREF: sub_41E25F+118j
		mov	[ebp+var_C], 1
		jmp	short loc_41E3A2
; ---------------------------------------------------------------------------

loc_41E38C:				; CODE XREF: sub_41E25F+EEj
		cmp	[ebp+arg_8], 0
		jz	short loc_41E39B
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0

loc_41E39B:				; CODE XREF: sub_41E25F+131j
		mov	[ebp+var_C], 0

loc_41E3A2:				; CODE XREF: sub_41E25F+E7j
					; sub_41E25F+12Bj
		mov	eax, [ebp+hProcess]
		mov	[esp+28h+hHandle], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		jmp	short loc_41E3D6
; ---------------------------------------------------------------------------

loc_41E3B4:				; CODE XREF: sub_41E25F+5Aj
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+28h+dwMilliseconds], eax ;	char
		mov	[esp+28h+hHandle], offset aWaitforsingleo ; "WaitForSingleObject returned unexpected"...
		call	sub_42091D
		mov	[ebp+var_C], 1
		nop

loc_41E3D6:				; CODE XREF: sub_41E25F+93j
					; sub_41E25F+153j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+dwMilliseconds], eax
		mov	[esp+28h+hHandle], 0
		call	sub_41D588

loc_41E3E9:				; CODE XREF: sub_41E25F+2Ej
		mov	ebx, [ebp+var_4]
		leave
		retn
sub_41E25F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41E3EE(LPCSTR	lpApplicationName, int)
sub_41E3EE	proc near		; CODE XREF: sub_41C657+2DAp

hProcess	= dword	ptr -0A8h
lpCommandLine	= dword	ptr -0A4h
lpProcessAttributes= dword ptr -0A0h
lpThreadAttributes= dword ptr -9Ch
bInheritHandles	= dword	ptr -98h
dwCreationFlags	= dword	ptr -94h
lpEnvironment	= dword	ptr -90h
lpCurrentDirectory= dword ptr -8Ch
lpStartupInfo	= dword	ptr -88h
lpProcessInformation= dword ptr	-84h
var_74		= dword	ptr -74h
StartupInfo	= _STARTUPINFOA	ptr -70h
ProcessInformation= _PROCESS_INFORMATION ptr -2Ch
ProcessAttributes= _SECURITY_ATTRIBUTES	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
lpApplicationName= dword ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0A0h
		mov	[ebp+ProcessInformation.hProcess], 0
		mov	[ebp+ProcessInformation.hThread], 0
		mov	[ebp+ProcessInformation.dwProcessId], 0
		mov	[ebp+ProcessInformation.dwThreadId], 0
		mov	[esp+0A8h+lpCommandLine], 0
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+0A8h+hProcess], eax
		call	_access
		test	eax, eax
		jz	short loc_41E436
		call	sub_41D5CA
		jmp	loc_41E57C
; ---------------------------------------------------------------------------

loc_41E436:				; CODE XREF: sub_41E3EE+3Cj
		lea	eax, [ebp+ProcessAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+ProcessAttributes.nLength], 0Ch
		mov	[ebp+ProcessAttributes.bInheritHandle],	0
		lea	eax, [ebp+var_74]
		mov	[esp+0A8h+lpProcessAttributes],	eax ; int
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+lpCommandLine], eax ;	int
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+0A8h+hProcess], eax ; char	*
		call	sub_41D87B
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41E485
		mov	eax, [ebp+var_C]
		jmp	loc_41E57C
; ---------------------------------------------------------------------------

loc_41E485:				; CODE XREF: sub_41E3EE+8Dj
		lea	eax, [ebp+StartupInfo]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 11h
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	[ebp+StartupInfo.cb], 44h
		mov	[ebp+StartupInfo.dwFlags], 1
		mov	[ebp+StartupInfo.wShowWindow], 5
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp+0A8h+hProcess], eax ; hProcess
		mov	eax, ds:GetPriorityClass
		call	eax ; GetPriorityClass
		sub	esp, 4
		or	eax, 4000208h
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_74]
		lea	ecx, [ebp+ProcessInformation]
		mov	[esp+0A8h+lpProcessInformation], ecx ; lpProcessInformation
		lea	ecx, [ebp+StartupInfo]
		mov	[esp+0A8h+lpStartupInfo], ecx ;	lpStartupInfo
		mov	[esp+0A8h+lpCurrentDirectory], 0 ; lpCurrentDirectory
		mov	[esp+0A8h+lpEnvironment], 0 ; lpEnvironment
		mov	[esp+0A8h+dwCreationFlags], edx	; dwCreationFlags
		mov	[esp+0A8h+bInheritHandles], 0 ;	bInheritHandles
		lea	edx, [ebp+ProcessAttributes]
		mov	[esp+0A8h+lpThreadAttributes], edx ; lpThreadAttributes
		lea	edx, [ebp+ProcessAttributes]
		mov	[esp+0A8h+lpProcessAttributes],	edx ; lpProcessAttributes
		mov	[esp+0A8h+lpCommandLine], eax ;	lpCommandLine
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+0A8h+hProcess], eax ; lpApplicationName
		mov	eax, ds:CreateProcessA
		call	eax ; CreateProcessA
		sub	esp, 28h
		test	eax, eax
		jnz	short loc_41E555
		mov	[esp+0A8h+hProcess], 0FFFFFFFFh	; DWORD
		call	sub_421C5A
		mov	[esp+0A8h+lpCommandLine], eax ;	char
		mov	[esp+0A8h+hProcess], offset aCreateprocessD ; "CreateProcess(detached) failed: %s\n"
		call	sub_42091D
		mov	eax, [ebp+var_74]
		mov	[esp+0A8h+hProcess], eax
		call	gcry_free
		mov	[esp+0A8h+hProcess], 1
		call	sub_41D5AF
		jmp	short loc_41E57C
; ---------------------------------------------------------------------------

loc_41E555:				; CODE XREF: sub_41E3EE+130j
		mov	eax, [ebp+var_74]
		mov	[esp+0A8h+hProcess], eax
		call	gcry_free
		mov	[ebp+var_74], 0
		mov	eax, [ebp+ProcessInformation.hThread]
		mov	[esp+0A8h+hProcess], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0

loc_41E57C:				; CODE XREF: sub_41E3EE+43j
					; sub_41E3EE+92j ...
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41E3EE	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41E584(char *)
sub_41E584	proc near		; CODE XREF: sub_41F74E+1Dp
					; .text:004200A8p

VarName		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_12		= word ptr -12h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+VarName], offset aLc_all ; "LC_ALL"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41E5B1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41E5B1
		mov	eax, [ebp+var_C]
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E5B1:				; CODE XREF: sub_41E584+19j
					; sub_41E584+23j
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+VarName], eax ; VarName
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41E5D7
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41E5D7
		mov	eax, [ebp+var_C]
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E5D7:				; CODE XREF: sub_41E584+3Fj
					; sub_41E584+49j
		mov	[esp+38h+VarName], offset aLang	; "LANG"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41E5FE
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41E5FE
		mov	eax, [ebp+var_C]
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E5FE:				; CODE XREF: sub_41E584+66j
					; sub_41E584+70j
		mov	eax, ds:GetThreadLocale
		call	eax ; GetThreadLocale
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_12], ax
		movzx	eax, [ebp+var_12]
		and	eax, 3FFh
		mov	[ebp+var_18], eax
		movzx	eax, [ebp+var_12]
		shr	ax, 0Ah
		movzx	eax, ax
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_18], 79h ; switch 122 cases
		ja	loc_41F0C4	; jumptable 0041E640 default case
		mov	eax, [ebp+var_18]
		shl	eax, 2
		add	eax, offset off_42DE18
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41E642:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aAf_za ; jumptable 0041E640	case 54
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E64C:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aSq_al ; jumptable 0041E640	case 28
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E656:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aAm_et ; jumptable 0041E640	case 94
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E660:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		cmp	[ebp+var_1C], 10h ; jumptable 0041E640 case 1
		ja	loc_41E719	; jumptable 0041E677 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_42E000
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41E679:				; CODE XREF: sub_41E584+F3j
					; DATA XREF: .rdata:off_42E000o
		mov	eax, offset aAr_sa ; jumptable 0041E677	case 1
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E683:				; CODE XREF: sub_41E584+F3j
					; DATA XREF: .rdata:off_42E000o
		mov	eax, offset aAr_iq ; jumptable 0041E677	case 2
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E68D:				; CODE XREF: sub_41E584+F3j
					; DATA XREF: .rdata:off_42E000o
		mov	eax, offset aAr_eg ; jumptable 0041E677	case 3
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E697:				; CODE XREF: sub_41E584+F3j
					; DATA XREF: .rdata:off_42E000o
		mov	eax, offset aAr_ly ; jumptable 0041E677	case 4
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E6A1:				; CODE XREF: sub_41E584+F3j
					; DATA XREF: .rdata:off_42E000o
		mov	eax, offset aAr_dz ; jumptable 0041E677	case 5
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E6AB:				; CODE XREF: sub_41E584+F3j
					; DATA XREF: .rdata:off_42E000o
		mov	eax, offset aAr_ma ; jumptable 0041E677	case 6
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E6B5:				; CODE XREF: sub_41E584+F3j
					; DATA XREF: .rdata:off_42E000o
		mov	eax, offset aAr_tn ; jumptable 0041E677	case 7
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E6BF:				; CODE XREF: sub_41E584+F3j
					; DATA XREF: .rdata:off_42E000o
		mov	eax, offset aAr_om ; jumptable 0041E677	case 8
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E6C9:				; CODE XREF: sub_41E584+F3j
					; DATA XREF: .rdata:off_42E000o
		mov	eax, offset aAr_ye ; jumptable 0041E677	case 9
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E6D3:				; CODE XREF: sub_41E584+F3j
					; DATA XREF: .rdata:off_42E000o
		mov	eax, offset aAr_sy ; jumptable 0041E677	case 10
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E6DD:				; CODE XREF: sub_41E584+F3j
					; DATA XREF: .rdata:off_42E000o
		mov	eax, offset aAr_jo ; jumptable 0041E677	case 11
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E6E7:				; CODE XREF: sub_41E584+F3j
					; DATA XREF: .rdata:off_42E000o
		mov	eax, offset aAr_lb ; jumptable 0041E677	case 12
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E6F1:				; CODE XREF: sub_41E584+F3j
					; DATA XREF: .rdata:off_42E000o
		mov	eax, offset aAr_kw ; jumptable 0041E677	case 13
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E6FB:				; CODE XREF: sub_41E584+F3j
					; DATA XREF: .rdata:off_42E000o
		mov	eax, offset aAr_ae ; jumptable 0041E677	case 14
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E705:				; CODE XREF: sub_41E584+F3j
					; DATA XREF: .rdata:off_42E000o
		mov	eax, offset aAr_bh ; jumptable 0041E677	case 15
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E70F:				; CODE XREF: sub_41E584+F3j
					; DATA XREF: .rdata:off_42E000o
		mov	eax, offset aAr_qa ; jumptable 0041E677	case 16
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E719:				; CODE XREF: sub_41E584+E0j
					; sub_41E584+F3j
					; DATA XREF: ...
		mov	eax, offset aAr	; jumptable 0041E677 default case
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E723:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aHy_am ; jumptable 0041E640	case 43
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E72D:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aAs_in ; jumptable 0041E640	case 77
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E737:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, [ebp+var_1C] ; jumptable 0041E640 case 44
		cmp	eax, 1
		jz	short loc_41E746
		cmp	eax, 2
		jz	short loc_41E750
		jmp	short loc_41E75A
; ---------------------------------------------------------------------------

loc_41E746:				; CODE XREF: sub_41E584+1B9j
		mov	eax, offset aAz_az@latin ; "az_AZ@latin"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E750:				; CODE XREF: sub_41E584+1BEj
		mov	eax, offset aAz_az@cyrillic ; "az_AZ@cyrillic"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E75A:				; CODE XREF: sub_41E584+1C0j
		mov	eax, offset aAz	; "az"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E764:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aEu	; jumptable 0041E640 case 45
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E76E:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aBe_by ; jumptable 0041E640	case 35
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E778:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, [ebp+var_1C] ; jumptable 0041E640 case 69
		cmp	eax, 1
		jz	short loc_41E787
		cmp	eax, 2
		jz	short loc_41E791
		jmp	short loc_41E79B
; ---------------------------------------------------------------------------

loc_41E787:				; CODE XREF: sub_41E584+1FAj
		mov	eax, offset aBn_in ; "bn_IN"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E791:				; CODE XREF: sub_41E584+1FFj
		mov	eax, offset aBn_bd ; "bn_BD"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E79B:				; CODE XREF: sub_41E584+201j
		mov	eax, offset aBn	; "bn"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E7A5:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aBg_bg ; jumptable 0041E640	case 2
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E7AF:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aMy_mm ; jumptable 0041E640	case 85
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E7B9:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aKm_kh ; jumptable 0041E640	case 83
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E7C3:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aCa_es ; jumptable 0041E640	case 3
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E7CD:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aChr_us ; jumptable	0041E640 case 92
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E7D7:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		cmp	[ebp+var_1C], 5	; jumptable 0041E640 case 4
		ja	short loc_41E81E ; jumptable 0041E7EA default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_42E044
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41E7EC:				; CODE XREF: sub_41E584+266j
					; DATA XREF: .rdata:off_42E044o
		mov	eax, offset aZh_tw ; jumptable 0041E7EA	case 1
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E7F6:				; CODE XREF: sub_41E584+266j
					; DATA XREF: .rdata:off_42E044o
		mov	eax, offset aZh_cn ; jumptable 0041E7EA	case 2
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E800:				; CODE XREF: sub_41E584+266j
					; DATA XREF: .rdata:off_42E044o
		mov	eax, offset aZh_hk ; jumptable 0041E7EA	case 3
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E80A:				; CODE XREF: sub_41E584+266j
					; DATA XREF: .rdata:off_42E044o
		mov	eax, offset aZh_sg ; jumptable 0041E7EA	case 4
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E814:				; CODE XREF: sub_41E584+266j
					; DATA XREF: .rdata:off_42E044o
		mov	eax, offset aZh_mo ; jumptable 0041E7EA	case 5
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E81E:				; CODE XREF: sub_41E584+257j
					; sub_41E584+266j
					; DATA XREF: ...
		mov	eax, offset aZh	; jumptable 0041E7EA default case
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E828:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, [ebp+var_1C] ; jumptable 0041E640 case 26
		cmp	eax, 2
		jz	short loc_41E844
		cmp	eax, 3
		jz	short loc_41E84E
		cmp	eax, 1
		jnz	short loc_41E858
		mov	eax, offset aHr_hr ; "hr_HR"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E844:				; CODE XREF: sub_41E584+2AAj
		mov	eax, offset aSr_cs ; "sr_CS"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E84E:				; CODE XREF: sub_41E584+2AFj
		mov	eax, offset aSr_cs@cyrillic ; "sr_CS@cyrillic"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E858:				; CODE XREF: sub_41E584+2B4j
		mov	eax, offset aHr	; "hr"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E862:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aCs_cz ; jumptable 0041E640	case 5
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E86C:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aDa_dk ; jumptable 0041E640	case 6
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E876:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aDiv_mv ; jumptable	0041E640 case 101
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E880:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, [ebp+var_1C] ; jumptable 0041E640 case 19
		cmp	eax, 1
		jz	short loc_41E88F
		cmp	eax, 2
		jz	short loc_41E899
		jmp	short loc_41E8A3
; ---------------------------------------------------------------------------

loc_41E88F:				; CODE XREF: sub_41E584+302j
		mov	eax, offset aNl_nl ; "nl_NL"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E899:				; CODE XREF: sub_41E584+307j
		mov	eax, offset aNl_be ; "nl_BE"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E8A3:				; CODE XREF: sub_41E584+309j
		mov	eax, offset aNl	; "nl"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E8AD:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aBin_ng ; jumptable	0041E640 case 102
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E8B7:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		cmp	[ebp+var_1C], 12h ; jumptable 0041E640 case 9
		ja	loc_41E984	; jumptable 0041E8CE default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_42E05C
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41E8D0:				; CODE XREF: sub_41E584+34Aj
					; DATA XREF: .rdata:off_42E05Co
		mov	eax, offset aEn_us ; jumptable 0041E8CE	case 1
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E8DA:				; CODE XREF: sub_41E584+34Aj
					; DATA XREF: .rdata:off_42E05Co
		mov	eax, offset aEn_gb ; jumptable 0041E8CE	case 2
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E8E4:				; CODE XREF: sub_41E584+34Aj
					; DATA XREF: .rdata:off_42E05Co
		mov	eax, offset aEn_au ; jumptable 0041E8CE	case 3
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E8EE:				; CODE XREF: sub_41E584+34Aj
					; DATA XREF: .rdata:off_42E05Co
		mov	eax, offset aEn_ca ; jumptable 0041E8CE	case 4
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E8F8:				; CODE XREF: sub_41E584+34Aj
					; DATA XREF: .rdata:off_42E05Co
		mov	eax, offset aEn_nz ; jumptable 0041E8CE	case 5
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E902:				; CODE XREF: sub_41E584+34Aj
					; DATA XREF: .rdata:off_42E05Co
		mov	eax, offset aEn_ie ; jumptable 0041E8CE	case 6
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E90C:				; CODE XREF: sub_41E584+34Aj
					; DATA XREF: .rdata:off_42E05Co
		mov	eax, offset aEn_za ; jumptable 0041E8CE	case 7
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E916:				; CODE XREF: sub_41E584+34Aj
					; DATA XREF: .rdata:off_42E05Co
		mov	eax, offset aEn_jm ; jumptable 0041E8CE	case 8
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E920:				; CODE XREF: sub_41E584+34Aj
					; DATA XREF: .rdata:off_42E05Co
		mov	eax, offset aEn_gd ; jumptable 0041E8CE	case 9
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E92A:				; CODE XREF: sub_41E584+34Aj
					; DATA XREF: .rdata:off_42E05Co
		mov	eax, offset aEn_bz ; jumptable 0041E8CE	case 10
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E934:				; CODE XREF: sub_41E584+34Aj
					; DATA XREF: .rdata:off_42E05Co
		mov	eax, offset aEn_tt ; jumptable 0041E8CE	case 11
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E93E:				; CODE XREF: sub_41E584+34Aj
					; DATA XREF: .rdata:off_42E05Co
		mov	eax, offset aEn_zw ; jumptable 0041E8CE	case 12
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E948:				; CODE XREF: sub_41E584+34Aj
					; DATA XREF: .rdata:off_42E05Co
		mov	eax, offset aEn_ph ; jumptable 0041E8CE	case 13
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E952:				; CODE XREF: sub_41E584+34Aj
					; DATA XREF: .rdata:off_42E05Co
		mov	eax, offset aEn_id ; jumptable 0041E8CE	case 14
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E95C:				; CODE XREF: sub_41E584+34Aj
					; DATA XREF: .rdata:off_42E05Co
		mov	eax, offset aEn_hk ; jumptable 0041E8CE	case 15
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E966:				; CODE XREF: sub_41E584+34Aj
					; DATA XREF: .rdata:off_42E05Co
		mov	eax, offset aEn_in ; jumptable 0041E8CE	case 16
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E970:				; CODE XREF: sub_41E584+34Aj
					; DATA XREF: .rdata:off_42E05Co
		mov	eax, offset aEn_my ; jumptable 0041E8CE	case 17
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E97A:				; CODE XREF: sub_41E584+34Aj
					; DATA XREF: .rdata:off_42E05Co
		mov	eax, offset aEn_sg ; jumptable 0041E8CE	case 18
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E984:				; CODE XREF: sub_41E584+337j
					; sub_41E584+34Aj
					; DATA XREF: ...
		mov	eax, offset aEn	; jumptable 0041E8CE default case
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E98E:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aEt_ee ; jumptable 0041E640	case 37
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E998:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aFo_fo ; jumptable 0041E640	case 56
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E9A2:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aFa_ir ; jumptable 0041E640	case 41
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E9AC:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aFi_fi ; jumptable 0041E640	case 11
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E9B6:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		cmp	[ebp+var_1C], 0Fh ; jumptable 0041E640 case 12
		ja	loc_41EA65	; jumptable 0041E9CD default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_42E0A8
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41E9CF:				; CODE XREF: sub_41E584+449j
					; DATA XREF: .rdata:off_42E0A8o
		mov	eax, offset aFr_fr ; jumptable 0041E9CD	case 1
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E9D9:				; CODE XREF: sub_41E584+449j
					; DATA XREF: .rdata:off_42E0A8o
		mov	eax, offset aFr_be ; jumptable 0041E9CD	case 2
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E9E3:				; CODE XREF: sub_41E584+449j
					; DATA XREF: .rdata:off_42E0A8o
		mov	eax, offset aFr_ca ; jumptable 0041E9CD	case 3
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E9ED:				; CODE XREF: sub_41E584+449j
					; DATA XREF: .rdata:off_42E0A8o
		mov	eax, offset aFr_ch ; jumptable 0041E9CD	case 4
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41E9F7:				; CODE XREF: sub_41E584+449j
					; DATA XREF: .rdata:off_42E0A8o
		mov	eax, offset aFr_lu ; jumptable 0041E9CD	case 5
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EA01:				; CODE XREF: sub_41E584+449j
					; DATA XREF: .rdata:off_42E0A8o
		mov	eax, offset aFr_mc ; jumptable 0041E9CD	case 6
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EA0B:				; CODE XREF: sub_41E584+449j
					; DATA XREF: .rdata:off_42E0A8o
		mov	eax, offset aFr	; jumptable 0041E9CD case 7
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EA15:				; CODE XREF: sub_41E584+449j
					; DATA XREF: .rdata:off_42E0A8o
		mov	eax, offset aFr_re ; jumptable 0041E9CD	case 8
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EA1F:				; CODE XREF: sub_41E584+449j
					; DATA XREF: .rdata:off_42E0A8o
		mov	eax, offset aFr_cg ; jumptable 0041E9CD	case 9
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EA29:				; CODE XREF: sub_41E584+449j
					; DATA XREF: .rdata:off_42E0A8o
		mov	eax, offset aFr_sn ; jumptable 0041E9CD	case 10
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EA33:				; CODE XREF: sub_41E584+449j
					; DATA XREF: .rdata:off_42E0A8o
		mov	eax, offset aFr_cm ; jumptable 0041E9CD	case 11
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EA3D:				; CODE XREF: sub_41E584+449j
					; DATA XREF: .rdata:off_42E0A8o
		mov	eax, offset aFr_ci ; jumptable 0041E9CD	case 12
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EA47:				; CODE XREF: sub_41E584+449j
					; DATA XREF: .rdata:off_42E0A8o
		mov	eax, offset aFr_ml ; jumptable 0041E9CD	case 13
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EA51:				; CODE XREF: sub_41E584+449j
					; DATA XREF: .rdata:off_42E0A8o
		mov	eax, offset aFr_ma ; jumptable 0041E9CD	case 14
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EA5B:				; CODE XREF: sub_41E584+449j
					; DATA XREF: .rdata:off_42E0A8o
		mov	eax, offset aFr_ht ; jumptable 0041E9CD	case 15
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EA65:				; CODE XREF: sub_41E584+436j
					; sub_41E584+449j
					; DATA XREF: ...
		mov	eax, offset aFr	; jumptable 0041E9CD default case
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EA6F:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aFy_nl ; jumptable 0041E640	case 98
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EA79:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aFul_ng ; jumptable	0041E640 case 103
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EA83:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, [ebp+var_1C] ; jumptable 0041E640 case 60
		cmp	eax, 1
		jz	short loc_41EA92
		cmp	eax, 2
		jz	short loc_41EA9C
		jmp	short loc_41EAA6
; ---------------------------------------------------------------------------

loc_41EA92:				; CODE XREF: sub_41E584+505j
		mov	eax, offset aGd_gb ; "gd_GB"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EA9C:				; CODE XREF: sub_41E584+50Aj
		mov	eax, offset aGa_ie ; "ga_IE"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EAA6:				; CODE XREF: sub_41E584+50Cj
		mov	eax, offset aC	; "C"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EAB0:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aGl_es ; jumptable 0041E640	case 86
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EABA:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aKa_ge ; jumptable 0041E640	case 55
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EAC4:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		cmp	[ebp+var_1C], 5	; jumptable 0041E640 case 7
		ja	short loc_41EB0B ; jumptable 0041EAD7 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_42E0E8
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41EAD9:				; CODE XREF: sub_41E584+553j
					; DATA XREF: .rdata:off_42E0E8o
		mov	eax, offset aDe_de ; jumptable 0041EAD7	case 1
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EAE3:				; CODE XREF: sub_41E584+553j
					; DATA XREF: .rdata:off_42E0E8o
		mov	eax, offset aDe_ch ; jumptable 0041EAD7	case 2
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EAED:				; CODE XREF: sub_41E584+553j
					; DATA XREF: .rdata:off_42E0E8o
		mov	eax, offset aDe_at ; jumptable 0041EAD7	case 3
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EAF7:				; CODE XREF: sub_41E584+553j
					; DATA XREF: .rdata:off_42E0E8o
		mov	eax, offset aDe_lu ; jumptable 0041EAD7	case 4
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EB01:				; CODE XREF: sub_41E584+553j
					; DATA XREF: .rdata:off_42E0E8o
		mov	eax, offset aDe_li ; jumptable 0041EAD7	case 5
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EB0B:				; CODE XREF: sub_41E584+544j
					; sub_41E584+553j
					; DATA XREF: ...
		mov	eax, offset aDe	; jumptable 0041EAD7 default case
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EB15:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aEl_gr ; jumptable 0041E640	case 8
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EB1F:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aGn_py ; jumptable 0041E640	case 116
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EB29:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aGu_in ; jumptable 0041E640	case 71
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EB33:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aHa_ng ; jumptable 0041E640	case 104
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EB3D:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aCpe_us ; jumptable	0041E640 case 117
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EB47:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aHe_il ; jumptable 0041E640	case 13
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EB51:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aHi_in ; jumptable 0041E640	case 57
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EB5B:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aHu_hu ; jumptable 0041E640	case 14
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EB65:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aNic_ng ; jumptable	0041E640 case 105
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EB6F:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aIs_is ; jumptable 0041E640	case 15
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EB79:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aIbo_ng ; jumptable	0041E640 case 112
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EB83:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aId_id ; jumptable 0041E640	case 33
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EB8D:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aIu_ca ; jumptable 0041E640	case 93
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EB97:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, [ebp+var_1C] ; jumptable 0041E640 case 16
		cmp	eax, 1
		jz	short loc_41EBA6
		cmp	eax, 2
		jz	short loc_41EBB0
		jmp	short loc_41EBBA
; ---------------------------------------------------------------------------

loc_41EBA6:				; CODE XREF: sub_41E584+619j
		mov	eax, offset aIt_it ; "it_IT"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EBB0:				; CODE XREF: sub_41E584+61Ej
		mov	eax, offset aIt_ch ; "it_CH"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EBBA:				; CODE XREF: sub_41E584+620j
		mov	eax, offset aIt	; "it"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EBC4:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aJa_jp ; jumptable 0041E640	case 17
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EBCE:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aKn_in ; jumptable 0041E640	case 75
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EBD8:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aKau_ng ; jumptable	0041E640 case 113
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EBE2:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, [ebp+var_1C] ; jumptable 0041E640 case 96
		cmp	eax, 1
		jz	short loc_41EBF1
		cmp	eax, 2
		jz	short loc_41EBFB
		jmp	short loc_41EC05
; ---------------------------------------------------------------------------

loc_41EBF1:				; CODE XREF: sub_41E584+664j
		mov	eax, offset aKs_pk ; "ks_PK"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EBFB:				; CODE XREF: sub_41E584+669j
		mov	eax, offset aKs_in ; "ks_IN"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EC05:				; CODE XREF: sub_41E584+66Bj
		mov	eax, offset aKs	; "ks"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EC0F:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aKk_kz ; jumptable 0041E640	case 63
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EC19:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aKok_in ; jumptable	0041E640 case 87
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EC23:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aKo_kr ; jumptable 0041E640	case 18
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EC2D:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aKy_kg ; jumptable 0041E640	case 64
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EC37:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aLo_la ; jumptable 0041E640	case 84
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EC41:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aLa_va ; jumptable 0041E640	case 118
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EC4B:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aLv_lv ; jumptable 0041E640	case 38
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EC55:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aLt_lt ; jumptable 0041E640	case 39
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EC5F:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aMk_mk ; jumptable 0041E640	case 47
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EC69:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, [ebp+var_1C] ; jumptable 0041E640 case 62
		cmp	eax, 1
		jz	short loc_41EC78
		cmp	eax, 2
		jz	short loc_41EC82
		jmp	short loc_41EC8C
; ---------------------------------------------------------------------------

loc_41EC78:				; CODE XREF: sub_41E584+6EBj
		mov	eax, offset aMs_my ; "ms_MY"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EC82:				; CODE XREF: sub_41E584+6F0j
		mov	eax, offset aMs_bn ; "ms_BN"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EC8C:				; CODE XREF: sub_41E584+6F2j
		mov	eax, offset aMs	; "ms"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EC96:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aMl_in ; jumptable 0041E640	case 76
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41ECA0:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aMt_mt ; jumptable 0041E640	case 58
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41ECAA:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aMni_in ; jumptable	0041E640 case 88
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41ECB4:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aMr_in ; jumptable 0041E640	case 78
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41ECBE:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aMn	; jumptable 0041E640 case 80
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41ECC8:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, [ebp+var_1C] ; jumptable 0041E640 case 97
		cmp	eax, 1
		jz	short loc_41ECD7
		cmp	eax, 2
		jz	short loc_41ECE1
		jmp	short loc_41ECEB
; ---------------------------------------------------------------------------

loc_41ECD7:				; CODE XREF: sub_41E584+74Aj
		mov	eax, offset aNe_np ; "ne_NP"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41ECE1:				; CODE XREF: sub_41E584+74Fj
		mov	eax, offset aNe_in ; "ne_IN"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41ECEB:				; CODE XREF: sub_41E584+751j
		mov	eax, offset aNe	; "ne"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41ECF5:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, [ebp+var_1C] ; jumptable 0041E640 case 20
		cmp	eax, 1
		jz	short loc_41ED04
		cmp	eax, 2
		jz	short loc_41ED0E
		jmp	short loc_41ED18
; ---------------------------------------------------------------------------

loc_41ED04:				; CODE XREF: sub_41E584+777j
		mov	eax, offset aNo_no ; "no_NO"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41ED0E:				; CODE XREF: sub_41E584+77Cj
		mov	eax, offset aNn_no ; "nn_NO"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41ED18:				; CODE XREF: sub_41E584+77Ej
		mov	eax, offset aNo	; "no"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41ED22:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aOr_in ; jumptable 0041E640	case 72
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41ED2C:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aOm_et ; jumptable 0041E640	case 114
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41ED36:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aPap_an ; jumptable	0041E640 case 121
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41ED40:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aPs	; jumptable 0041E640 case 99
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41ED4A:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aPl_pl ; jumptable 0041E640	case 21
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41ED54:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, [ebp+var_1C] ; jumptable 0041E640 case 22
		cmp	eax, 1
		jz	short loc_41ED6B
		cmp	eax, 2
		jnz	short loc_41ED75
		mov	eax, offset aPt_pt ; "pt_PT"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41ED6B:				; CODE XREF: sub_41E584+7D6j
		mov	eax, offset aPt_br ; "pt_BR"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41ED75:				; CODE XREF: sub_41E584+7DBj
		mov	eax, offset aPt	; "pt"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41ED7F:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, [ebp+var_1C] ; jumptable 0041E640 case 70
		cmp	eax, 1
		jnz	short loc_41ED91
		mov	eax, offset aPa_in ; "pa_IN"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41ED91:				; CODE XREF: sub_41E584+801j
		mov	eax, offset aPa	; "pa"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41ED9B:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aRm_ch ; jumptable 0041E640	case 23
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EDA5:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, [ebp+var_1C] ; jumptable 0041E640 case 24
		cmp	eax, 1
		jnz	short loc_41EDB7
		mov	eax, offset aRo_ro ; "ro_RO"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EDB7:				; CODE XREF: sub_41E584+827j
		mov	eax, offset aRo	; "ro"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EDC1:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aRu	; jumptable 0041E640 case 25
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EDCB:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aSe_no ; jumptable 0041E640	case 59
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EDD5:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aSa_in ; jumptable 0041E640	case 79
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EDDF:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, [ebp+var_1C] ; jumptable 0041E640 case 89
		test	eax, eax
		jz	short loc_41EDED
		cmp	eax, 1
		jz	short loc_41EDF7
		jmp	short loc_41EE01
; ---------------------------------------------------------------------------

loc_41EDED:				; CODE XREF: sub_41E584+860j
		mov	eax, offset aSd_in ; "sd_IN"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EDF7:				; CODE XREF: sub_41E584+865j
		mov	eax, offset aSd_pk ; "sd_PK"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EE01:				; CODE XREF: sub_41E584+867j
		mov	eax, offset aSd	; "sd"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EE0B:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aSi_lk ; jumptable 0041E640	case 91
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EE15:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aSk_sk ; jumptable 0041E640	case 27
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EE1F:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aSl_si ; jumptable 0041E640	case 36
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EE29:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aSo_so ; jumptable 0041E640	case 119
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EE33:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aWen_de ; jumptable	0041E640 case 46
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EE3D:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		cmp	[ebp+var_1C], 14h ; jumptable 0041E640 case 10
		ja	loc_41EF1E	; jumptable 0041EE54 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_42E100
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41EE56:				; CODE XREF: sub_41E584+8D0j
					; DATA XREF: .rdata:off_42E100o
		mov	eax, offset aEs_es ; jumptable 0041EE54	case 1
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EE60:				; CODE XREF: sub_41E584+8D0j
					; DATA XREF: .rdata:off_42E100o
		mov	eax, offset aEs_mx ; jumptable 0041EE54	case 2
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EE6A:				; CODE XREF: sub_41E584+8D0j
					; DATA XREF: .rdata:off_42E100o
		mov	eax, offset aEs_es@modern ; jumptable 0041EE54 case 3
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EE74:				; CODE XREF: sub_41E584+8D0j
					; DATA XREF: .rdata:off_42E100o
		mov	eax, offset aEs_gt ; jumptable 0041EE54	case 4
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EE7E:				; CODE XREF: sub_41E584+8D0j
					; DATA XREF: .rdata:off_42E100o
		mov	eax, offset aEs_cr ; jumptable 0041EE54	case 5
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EE88:				; CODE XREF: sub_41E584+8D0j
					; DATA XREF: .rdata:off_42E100o
		mov	eax, offset aEs_pa ; jumptable 0041EE54	case 6
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EE92:				; CODE XREF: sub_41E584+8D0j
					; DATA XREF: .rdata:off_42E100o
		mov	eax, offset aEs_do ; jumptable 0041EE54	case 7
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EE9C:				; CODE XREF: sub_41E584+8D0j
					; DATA XREF: .rdata:off_42E100o
		mov	eax, offset aEs_ve ; jumptable 0041EE54	case 8
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EEA6:				; CODE XREF: sub_41E584+8D0j
					; DATA XREF: .rdata:off_42E100o
		mov	eax, offset aEs_co ; jumptable 0041EE54	case 9
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EEB0:				; CODE XREF: sub_41E584+8D0j
					; DATA XREF: .rdata:off_42E100o
		mov	eax, offset aEs_pe ; jumptable 0041EE54	case 10
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EEBA:				; CODE XREF: sub_41E584+8D0j
					; DATA XREF: .rdata:off_42E100o
		mov	eax, offset aEs_ar ; jumptable 0041EE54	case 11
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EEC4:				; CODE XREF: sub_41E584+8D0j
					; DATA XREF: .rdata:off_42E100o
		mov	eax, offset aEs_ec ; jumptable 0041EE54	case 12
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EECE:				; CODE XREF: sub_41E584+8D0j
					; DATA XREF: .rdata:off_42E100o
		mov	eax, offset aEs_cl ; jumptable 0041EE54	case 13
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EED8:				; CODE XREF: sub_41E584+8D0j
					; DATA XREF: .rdata:off_42E100o
		mov	eax, offset aEs_uy ; jumptable 0041EE54	case 14
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EEE2:				; CODE XREF: sub_41E584+8D0j
					; DATA XREF: .rdata:off_42E100o
		mov	eax, offset aEs_py ; jumptable 0041EE54	case 15
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EEEC:				; CODE XREF: sub_41E584+8D0j
					; DATA XREF: .rdata:off_42E100o
		mov	eax, offset aEs_bo ; jumptable 0041EE54	case 16
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EEF6:				; CODE XREF: sub_41E584+8D0j
					; DATA XREF: .rdata:off_42E100o
		mov	eax, offset aEs_sv ; jumptable 0041EE54	case 17
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EF00:				; CODE XREF: sub_41E584+8D0j
					; DATA XREF: .rdata:off_42E100o
		mov	eax, offset aEs_hn ; jumptable 0041EE54	case 18
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EF0A:				; CODE XREF: sub_41E584+8D0j
					; DATA XREF: .rdata:off_42E100o
		mov	eax, offset aEs_ni ; jumptable 0041EE54	case 19
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EF14:				; CODE XREF: sub_41E584+8D0j
					; DATA XREF: .rdata:off_42E100o
		mov	eax, offset aEs_pr ; jumptable 0041EE54	case 20
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EF1E:				; CODE XREF: sub_41E584+8BDj
					; sub_41E584+8D0j
					; DATA XREF: ...
		mov	eax, offset aEs	; jumptable 0041EE54 default case
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EF28:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aBnt_tz ; jumptable	0041E640 case 48
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EF32:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aSw_ke ; jumptable 0041E640	case 65
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EF3C:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, [ebp+var_1C] ; jumptable 0041E640 case 29
		cmp	eax, 1
		jz	short loc_41EF4B
		cmp	eax, 2
		jz	short loc_41EF55
		jmp	short loc_41EF5F
; ---------------------------------------------------------------------------

loc_41EF4B:				; CODE XREF: sub_41E584+9BEj
		mov	eax, offset aSv_se ; "sv_SE"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EF55:				; CODE XREF: sub_41E584+9C3j
		mov	eax, offset aSv_fi ; "sv_FI"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EF5F:				; CODE XREF: sub_41E584+9C5j
		mov	eax, offset aSv	; "sv"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EF69:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aSyr_tr ; jumptable	0041E640 case 90
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EF73:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aTl_ph ; jumptable 0041E640	case 100
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EF7D:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aTg_tj ; jumptable 0041E640	case 40
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EF87:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, [ebp+var_1C] ; jumptable 0041E640 case 95
		cmp	eax, 1
		jz	short loc_41EF96
		cmp	eax, 2
		jz	short loc_41EFA0
		jmp	short loc_41EFAA
; ---------------------------------------------------------------------------

loc_41EF96:				; CODE XREF: sub_41E584+A09j
		mov	eax, offset aBer_ma@arabic ; "ber_MA@arabic"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EFA0:				; CODE XREF: sub_41E584+A0Ej
		mov	eax, offset aBer_ma@latin ; "ber_MA@latin"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EFAA:				; CODE XREF: sub_41E584+A10j
		mov	eax, offset aBer_ma ; "ber_MA"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EFB4:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aTa	; jumptable 0041E640 case 73
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EFBE:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aTt_ru ; jumptable 0041E640	case 68
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EFC8:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aTe_in ; jumptable 0041E640	case 74
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EFD2:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aTh_th ; jumptable 0041E640	case 30
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EFDC:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aBo_cn ; jumptable 0041E640	case 81
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EFE6:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, [ebp+var_1C] ; jumptable 0041E640 case 115
		test	eax, eax
		jz	short loc_41EFF4
		cmp	eax, 1
		jz	short loc_41EFFE
		jmp	short loc_41F008
; ---------------------------------------------------------------------------

loc_41EFF4:				; CODE XREF: sub_41E584+A67j
		mov	eax, offset aTi_et ; "ti_ET"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41EFFE:				; CODE XREF: sub_41E584+A6Cj
		mov	eax, offset aTi_er ; "ti_ER"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41F008:				; CODE XREF: sub_41E584+A6Ej
		mov	eax, offset aTi	; "ti"
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41F012:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aTs_za ; jumptable 0041E640	case 49
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41F01C:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aTn_bw ; jumptable 0041E640	case 50
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41F026:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aTr_tr ; jumptable 0041E640	case 31
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41F030:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aTk_tm ; jumptable 0041E640	case 66
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41F03A:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aUk_ua ; jumptable 0041E640	case 34
		jmp	locret_41F0C9
; ---------------------------------------------------------------------------

loc_41F044:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, [ebp+var_1C] ; jumptable 0041E640 case 32
		cmp	eax, 1
		jz	short loc_41F053
		cmp	eax, 2
		jz	short loc_41F05A
		jmp	short loc_41F061
; ---------------------------------------------------------------------------

loc_41F053:				; CODE XREF: sub_41E584+AC6j
		mov	eax, offset aUr_pk ; "ur_PK"
		jmp	short locret_41F0C9
; ---------------------------------------------------------------------------

loc_41F05A:				; CODE XREF: sub_41E584+ACBj
		mov	eax, offset aUr_in ; "ur_IN"
		jmp	short locret_41F0C9
; ---------------------------------------------------------------------------

loc_41F061:				; CODE XREF: sub_41E584+ACDj
		mov	eax, offset aUr	; "ur"
		jmp	short locret_41F0C9
; ---------------------------------------------------------------------------

loc_41F068:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, [ebp+var_1C] ; jumptable 0041E640 case 67
		cmp	eax, 1
		jz	short loc_41F077
		cmp	eax, 2
		jz	short loc_41F07E
		jmp	short loc_41F085
; ---------------------------------------------------------------------------

loc_41F077:				; CODE XREF: sub_41E584+AEAj
		mov	eax, offset aUz_uz ; "uz_UZ"
		jmp	short locret_41F0C9
; ---------------------------------------------------------------------------

loc_41F07E:				; CODE XREF: sub_41E584+AEFj
		mov	eax, offset aUz_uz@cyrillic ; "uz_UZ@cyrillic"
		jmp	short locret_41F0C9
; ---------------------------------------------------------------------------

loc_41F085:				; CODE XREF: sub_41E584+AF1j
		mov	eax, offset aUz	; "uz"
		jmp	short locret_41F0C9
; ---------------------------------------------------------------------------

loc_41F08C:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aVen_za ; jumptable	0041E640 case 51
		jmp	short locret_41F0C9
; ---------------------------------------------------------------------------

loc_41F093:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aVi_vn ; jumptable 0041E640	case 42
		jmp	short locret_41F0C9
; ---------------------------------------------------------------------------

loc_41F09A:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aCy_gb ; jumptable 0041E640	case 82
		jmp	short locret_41F0C9
; ---------------------------------------------------------------------------

loc_41F0A1:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aXh_za ; jumptable 0041E640	case 52
		jmp	short locret_41F0C9
; ---------------------------------------------------------------------------

loc_41F0A8:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aSit_cn ; jumptable	0041E640 case 120
		jmp	short locret_41F0C9
; ---------------------------------------------------------------------------

loc_41F0AF:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aYi_il ; jumptable 0041E640	case 61
		jmp	short locret_41F0C9
; ---------------------------------------------------------------------------

loc_41F0B6:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aYo_ng ; jumptable 0041E640	case 106
		jmp	short locret_41F0C9
; ---------------------------------------------------------------------------

loc_41F0BD:				; CODE XREF: sub_41E584+BCj
					; DATA XREF: .rdata:off_42DE18o
		mov	eax, offset aZu_za ; jumptable 0041E640	case 53
		jmp	short locret_41F0C9
; ---------------------------------------------------------------------------

loc_41F0C4:				; CODE XREF: sub_41E584+A9j
					; sub_41E584+BCj
					; DATA XREF: ...
		mov	eax, offset aC	; jumptable 0041E640 default case

locret_41F0C9:				; CODE XREF: sub_41E584+28j
					; sub_41E584+4Ej ...
		leave
		retn
sub_41E584	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41F0CB	proc near		; CODE XREF: sub_41F1AA+1EAp
					; sub_41F1AA+212p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_0]
		and	eax, 0FF00h
		shl	eax, 8
		or	edx, eax
		mov	eax, [ebp+arg_0]
		shr	eax, 8
		and	eax, 0FF00h
		or	edx, eax
		mov	eax, [ebp+arg_0]
		shr	eax, 18h
		or	eax, edx
		pop	ebp
		retn
sub_41F0CB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41F0FA	proc near		; CODE XREF: sub_41FD79+5Fp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	[ebp+var_4], 0
		jmp	short loc_41F143
; ---------------------------------------------------------------------------

loc_41F10F:				; CODE XREF: sub_41F0FA+51j
		shl	[ebp+var_4], 4
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		add	[ebp+var_4], eax
		add	[ebp+var_8], 1
		mov	eax, [ebp+var_4]
		and	eax, 0F0000000h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41F143
		mov	eax, [ebp+var_C]
		shr	eax, 18h
		xor	[ebp+var_4], eax
		mov	eax, [ebp+var_C]
		xor	[ebp+var_4], eax

loc_41F143:				; CODE XREF: sub_41F0FA+13j
					; sub_41F0FA+38j
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41F10F
		mov	eax, [ebp+var_4]
		leave
		retn
sub_41F0FA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41F152	proc near		; CODE XREF: sub_41F74E+243p

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_C], eax
		jmp	short loc_41F197
; ---------------------------------------------------------------------------

loc_41F17E:				; CODE XREF: sub_41F152+49j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_41F197:				; CODE XREF: sub_41F152+2Aj
		cmp	[ebp+var_C], 0
		jnz	short loc_41F17E
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		leave
		retn
sub_41F152	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41F1AA(char *)
sub_41F1AA	proc near		; CODE XREF: sub_41F74E+214p

Filename	= dword	ptr -68h
Mode		= dword	ptr -64h
Count		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= byte ptr -58h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
File		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
DstBuf		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 60h
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	eax, offset aRb	; "rb"
		mov	[esp+68h+Mode],	eax ; Mode
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_41F1E7
		mov	eax, 0
		jmp	loc_41F4DE
; ---------------------------------------------------------------------------

loc_41F1E7:				; CODE XREF: sub_41F1AA+31j
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	_fileno
		lea	edx, [ebp+var_58]
		mov	[esp+68h+Mode],	edx
		mov	[esp+68h+Filename], eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		test	eax, eax
		jnz	short loc_41F230
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[ebp+var_20], eax
		mov	ecx, [ebp+var_20]
		mov	ebx, 0
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	esi, ebx
		xor	esi, edx
		xor	eax, ecx
		or	eax, esi
		test	eax, eax
		jnz	short loc_41F230
		cmp	[ebp+var_20], 1Bh
		ja	short loc_41F245

loc_41F230:				; CODE XREF: sub_41F1AA+5Bj
					; sub_41F1AA+7Ej
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, 0
		jmp	loc_41F4DE
; ---------------------------------------------------------------------------

loc_41F245:				; CODE XREF: sub_41F1AA+84j
		mov	eax, [ebp+var_20]
		add	eax, eax
		cmp	eax, [ebp+var_20]
		jbe	short loc_41F25E
		mov	eax, [ebp+var_20]
		add	eax, eax
		mov	[esp+68h+Filename], eax
		call	gcry_malloc
		jmp	short loc_41F263
; ---------------------------------------------------------------------------

loc_41F25E:				; CODE XREF: sub_41F1AA+A3j
		mov	eax, 0

loc_41F263:				; CODE XREF: sub_41F1AA+B2j
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_41F281
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, 0
		jmp	loc_41F4DE
; ---------------------------------------------------------------------------

loc_41F281:				; CODE XREF: sub_41F1AA+C0j
		mov	eax, [ebp+var_20]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+DstBuf], eax

loc_41F28D:				; CODE XREF: sub_41F1AA+13Fj
		mov	eax, [ebp+DstBuf]
		mov	edx, [ebp+File]
		mov	[esp+68h+var_5C], edx ;	File
		mov	edx, [ebp+var_C]
		mov	[esp+68h+Count], edx ; Count
		mov	[esp+68h+Mode],	1 ; ElementSize
		mov	[esp+68h+Filename], eax	; DstBuf
		call	fread
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_C]
		jnb	short loc_41F2D9
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_41F4DE
; ---------------------------------------------------------------------------

loc_41F2D9:				; CODE XREF: sub_41F1AA+10Dj
		mov	eax, [ebp+var_24]
		add	[ebp+DstBuf], eax
		mov	eax, [ebp+var_24]
		sub	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41F28D
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 950412DEh
		jz	short loc_41F323
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 0DE120495h
		jz	short loc_41F323
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_41F4DE
; ---------------------------------------------------------------------------

loc_41F323:				; CODE XREF: sub_41F1AA+156j
					; sub_41F1AA+162j
		mov	[esp+68h+Mode],	28h
		mov	[esp+68h+Filename], 1
		call	gcry_calloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_41F355
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_41F4DE
; ---------------------------------------------------------------------------

loc_41F355:				; CODE XREF: sub_41F1AA+194j
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_14]
		add	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 950412DEh
		setnz	al
		movzx	edx, al
		mov	eax, [ebp+var_18]
		mov	[eax+8], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41F39B
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[esp+68h+Filename], eax
		call	sub_41F0CB
		jmp	short loc_41F3A1
; ---------------------------------------------------------------------------

loc_41F39B:				; CODE XREF: sub_41F1AA+1DFj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]

loc_41F3A1:				; CODE XREF: sub_41F1AA+1EFj
		test	eax, eax
		jnz	loc_41F4A1
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41F3C3
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	[esp+68h+Filename], eax
		call	sub_41F0CB
		jmp	short loc_41F3C9
; ---------------------------------------------------------------------------

loc_41F3C3:				; CODE XREF: sub_41F1AA+207j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]

loc_41F3C9:				; CODE XREF: sub_41F1AA+217j
		mov	edx, [ebp+var_18]
		mov	[edx+0Ch], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41F3E9
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Filename], eax
		call	sub_41F0CB
		jmp	short loc_41F3EF
; ---------------------------------------------------------------------------

loc_41F3E9:				; CODE XREF: sub_41F1AA+22Dj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]

loc_41F3EF:				; CODE XREF: sub_41F1AA+23Dj
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+18h], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41F414
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]
		mov	[esp+68h+Filename], eax
		call	sub_41F0CB
		jmp	short loc_41F41A
; ---------------------------------------------------------------------------

loc_41F414:				; CODE XREF: sub_41F1AA+258j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]

loc_41F41A:				; CODE XREF: sub_41F1AA+268j
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41F43F
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	[esp+68h+Filename], eax
		call	sub_41F0CB
		jmp	short loc_41F445
; ---------------------------------------------------------------------------

loc_41F43F:				; CODE XREF: sub_41F1AA+283j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]

loc_41F445:				; CODE XREF: sub_41F1AA+293j
		mov	edx, [ebp+var_18]
		mov	[edx+20h], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41F465
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	[esp+68h+Filename], eax
		call	sub_41F0CB
		jmp	short loc_41F46B
; ---------------------------------------------------------------------------

loc_41F465:				; CODE XREF: sub_41F1AA+2A9j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]

loc_41F46B:				; CODE XREF: sub_41F1AA+2B9j
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+24h], edx
		nop
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Mode],	4
		mov	[esp+68h+Filename], eax
		call	gcry_calloc
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_41F4DB
		jmp	short loc_41F4BE
; ---------------------------------------------------------------------------

loc_41F4A1:				; CODE XREF: sub_41F1AA+1F9j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, 0
		jmp	short loc_41F4DE
; ---------------------------------------------------------------------------

loc_41F4BE:				; CODE XREF: sub_41F1AA+2F5j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, 0
		jmp	short loc_41F4DE
; ---------------------------------------------------------------------------

loc_41F4DB:				; CODE XREF: sub_41F1AA+2F3j
		mov	eax, [ebp+var_18]

loc_41F4DE:				; CODE XREF: sub_41F1AA+38j
					; sub_41F1AA+96j ...
		add	esp, 60h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_41F1AA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41F4E5(LPCSTR, int, int)
sub_41F4E5	proc near		; CODE XREF: sub_41F6DC+1Ap

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpMultiByteStr	= dword	ptr -30h
cbMultiByte	= dword	ptr -2Ch
lpWideCharStr	= dword	ptr -28h
cchWideChar	= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+cchWideChar], 0 ; cchWideChar
		mov	[esp+38h+lpWideCharStr], 0 ; lpWideCharStr
		mov	[esp+38h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_41F535
		mov	eax, [ebp+var_C]
		add	eax, 1
		test	eax, eax
		jg	short loc_41F53F

loc_41F535:				; CODE XREF: sub_41F4E5+44j
		mov	eax, 0
		jmp	locret_41F5E5
; ---------------------------------------------------------------------------

loc_41F53F:				; CODE XREF: sub_41F4E5+4Ej
		mov	eax, [ebp+var_C]
		add	eax, 1
		add	eax, eax
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	edx, eax
		shr	edx, 1
		mov	eax, [ebp+var_C]
		add	eax, 1
		cmp	edx, eax
		jz	short loc_41F56F
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0
		jmp	short locret_41F5E5
; ---------------------------------------------------------------------------

loc_41F56F:				; CODE XREF: sub_41F4E5+74j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+CodePage], eax
		call	gcry_malloc
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_41F58A
		mov	eax, 0
		jmp	short locret_41F5E5
; ---------------------------------------------------------------------------

loc_41F58A:				; CODE XREF: sub_41F4E5+9Cj
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[esp+38h+cchWideChar], edx ; cchWideChar
		mov	edx, [ebp+var_14]
		mov	[esp+38h+lpWideCharStr], edx ; lpWideCharStr
		mov	[esp+38h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_41F5DA
		mov	eax, [ebp+var_14]
		mov	[esp+38h+CodePage], eax
		call	gcry_free
		mov	eax, 0
		jmp	short locret_41F5E5
; ---------------------------------------------------------------------------

loc_41F5DA:				; CODE XREF: sub_41F4E5+E1j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_14]

locret_41F5E5:				; CODE XREF: sub_41F4E5+55j
					; sub_41F4E5+88j ...
		leave
		retn
sub_41F4E5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41F5E7(LPCWSTR, int, int)
sub_41F5E7	proc near		; CODE XREF: sub_41F6DC+3Cp

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpWideCharStr	= dword	ptr -30h
cchWideChar	= dword	ptr -2Ch
lpMultiByteStr	= dword	ptr -28h
cbMultiByte	= dword	ptr -24h
lpDefaultChar	= dword	ptr -20h
lpUsedDefaultChar= dword ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	[esp+38h+cbMultiByte], 0 ; cbMultiByte
		mov	[esp+38h+lpMultiByteStr], 0 ; lpMultiByteStr
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0 ;	CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_41F647
		mov	eax, [ebp+var_C]
		add	eax, 1
		test	eax, eax
		jg	short loc_41F651

loc_41F647:				; CODE XREF: sub_41F5E7+54j
		mov	eax, 0
		jmp	locret_41F6DA
; ---------------------------------------------------------------------------

loc_41F651:				; CODE XREF: sub_41F5E7+5Ej
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+38h+CodePage], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41F66F
		mov	eax, 0
		jmp	short locret_41F6DA
; ---------------------------------------------------------------------------

loc_41F66F:				; CODE XREF: sub_41F5E7+7Fj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	edx, [ebp+var_C]
		mov	[esp+38h+cbMultiByte], edx ; cbMultiByte
		mov	edx, [ebp+var_10]
		mov	[esp+38h+lpMultiByteStr], edx ;	lpMultiByteStr
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0 ;	CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_41F6CF
		mov	eax, [ebp+var_10]
		mov	[esp+38h+CodePage], eax
		call	gcry_free
		mov	eax, 0
		jmp	short locret_41F6DA
; ---------------------------------------------------------------------------

loc_41F6CF:				; CODE XREF: sub_41F5E7+D4j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_10]

locret_41F6DA:				; CODE XREF: sub_41F5E7+65j
					; sub_41F5E7+86j ...
		leave
		retn
sub_41F5E7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41F6DC(LPCSTR, int, int)
sub_41F6DC	proc near		; CODE XREF: sub_41FA0E+12Fp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	LPCSTR
		call	sub_41F4E5
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41F72D
		mov	eax, [ebp+var_14]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_20], edx ;	int
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	LPCWSTR
		call	sub_41F5E7
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		jmp	short loc_41F734
; ---------------------------------------------------------------------------

loc_41F72D:				; CODE XREF: sub_41F6DC+26j
		mov	[ebp+var_C], 0

loc_41F734:				; CODE XREF: sub_41F6DC+4Fj
		cmp	[ebp+var_C], 0
		jz	short loc_41F73F
		mov	eax, [ebp+var_14]
		jmp	short loc_41F744
; ---------------------------------------------------------------------------

loc_41F73F:				; CODE XREF: sub_41F6DC+5Cj
		mov	eax, 0

loc_41F744:				; CODE XREF: sub_41F6DC+61j
		mov	edx, [ebp+arg_8]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41F6DC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41F74E(char *, char *)
sub_41F74E	proc near		; CODE XREF: sub_40B92C+16p

Dest		= dword	ptr -48h
Source		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Str		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		mov	[ebp+var_10], 0
		mov	[ebp+Str], 0
		mov	[esp+48h+Dest],	offset aLc_messages ; "LC_MESSAGES"
		call	sub_41E584
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_41F7E0
		mov	eax, [ebp+var_14]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+48h+Dest],	eax
		call	gcry_malloc
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jz	short loc_41F7E0
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	[esp+48h+Source], 5Fh ;	Val
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax ; Str
		call	strchr
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_41F7E0
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	0

loc_41F7E0:				; CODE XREF: sub_41F74E+29j
					; sub_41F74E+5Cj ...
		cmp	[ebp+Str], 0
		jnz	short loc_41F7F0
		mov	eax, 0
		jmp	loc_41F9A1
; ---------------------------------------------------------------------------

loc_41F7F0:				; CODE XREF: sub_41F74E+96j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+Str]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	ebx, eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 12h
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Dest],	eax
		call	gcry_malloc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_41F880
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_41F9A1
; ---------------------------------------------------------------------------

loc_41F880:				; CODE XREF: sub_41F74E+11Bj
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_24], 1
		mov	eax, [ebp+Str]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+Str]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_24], eax
		mov	edx, offset aLc_messages_0 ; "\\LC_MESSAGES\\"
		mov	eax, [ebp+var_24]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		movzx	edx, word ptr [edx+0Ch]
		mov	[eax+0Ch], dx
		add	[ebp+var_24], 0Dh
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_24], eax
		mov	edx, offset a_mo ; ".mo"
		mov	eax, [ebp+var_24]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	[esp+48h+Dest],	eax ; char *
		call	sub_41F1AA
		mov	[ebp+var_10], eax
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax
		call	gcry_free
		mov	eax, [ebp+var_20]
		mov	[esp+48h+Dest],	eax
		call	gcry_free
		mov	eax, ds:dword_430324
		test	eax, eax
		jz	short loc_41F996
		mov	eax, ds:dword_430324
		mov	[esp+48h+Dest],	eax
		call	sub_41F152

loc_41F996:				; CODE XREF: sub_41F74E+239j
		mov	eax, [ebp+var_10]
		mov	ds:dword_430324, eax
		mov	eax, [ebp+arg_4]

loc_41F9A1:				; CODE XREF: sub_41F74E+9Dj
					; sub_41F74E+12Dj
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41F74E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41F9A8(char *, int, int)
sub_41F9A8	proc near		; CODE XREF: sub_41FA0E+35Bp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 1
		setnz	al
		movzx	eax, al
		mov	[ebp+var_C], eax
		jmp	short loc_41FA03
; ---------------------------------------------------------------------------

loc_41F9BD:				; CODE XREF: sub_41F9A8+5Fj
		mov	[esp+28h+Val], 0 ; Val
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		cmp	eax, [ebp+var_10]
		ja	short loc_41F9EA
		mov	eax, offset aErrorInGettext ; "ERROR in	GETTEXT	(bad plural entry)"
		jmp	short locret_41FA0C
; ---------------------------------------------------------------------------

loc_41F9EA:				; CODE XREF: sub_41F9A8+39j
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+arg_4], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_0], eax
		sub	[ebp+var_C], 1

loc_41FA03:				; CODE XREF: sub_41F9A8+13j
		cmp	[ebp+var_C], 0
		jnz	short loc_41F9BD
		mov	eax, [ebp+arg_0]

locret_41FA0C:				; CODE XREF: sub_41F9A8+40j
		leave
		retn
sub_41F9A8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41FA0E	proc near		; CODE XREF: sub_41FD79+158p
					; sub_41FD79+27Dp

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, ds:dword_430328
		test	eax, eax
		jz	short loc_41FA9A
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41FA48
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_41F0CB
		jmp	short loc_41FA59
; ---------------------------------------------------------------------------

loc_41FA48:				; CODE XREF: sub_41FA0E+1Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_41FA59:				; CODE XREF: sub_41FA0E+38j
		add	eax, ebx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41FA82
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+38h+Dst], eax
		call	sub_41F0CB
		jmp	short loc_41FA92
; ---------------------------------------------------------------------------

loc_41FA82:				; CODE XREF: sub_41FA0E+58j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_41FA92:				; CODE XREF: sub_41FA0E+72j
		mov	[ebp+var_14], eax
		jmp	loc_41FD49
; ---------------------------------------------------------------------------

loc_41FA9A:				; CODE XREF: sub_41FA0E+Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_41FC8F
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41FADC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_41F0CB
		jmp	short loc_41FAED
; ---------------------------------------------------------------------------

loc_41FADC:				; CODE XREF: sub_41FA0E+B1j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_41FAED:				; CODE XREF: sub_41FA0E+CCj
		add	eax, ebx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41FB16
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+38h+Dst], eax
		call	sub_41F0CB
		jmp	short loc_41FB26
; ---------------------------------------------------------------------------

loc_41FB16:				; CODE XREF: sub_41FA0E+ECj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_41FB26:				; CODE XREF: sub_41FA0E+106j
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+var_28]
		mov	[esp+38h+Size],	eax ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Src], eax ; int
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dst], eax ; LPCSTR
		call	sub_41F6DC
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_41FB5E
		mov	[ebp+var_10], offset aErrorInGette_0 ; "ERROR in GETTEXT MALLOC"
		mov	[ebp+var_14], 0
		jmp	loc_41FC7F
; ---------------------------------------------------------------------------

loc_41FB5E:				; CODE XREF: sub_41FA0E+13Bj
		mov	eax, [ebp+var_28]
		cmp	eax, [ebp+var_1C]
		ja	loc_41FBF0
		mov	eax, [ebp+var_28]
		cmp	eax, 1
		jbe	short loc_41FBF0
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41FB9D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_41F0CB
		jmp	short loc_41FBAE
; ---------------------------------------------------------------------------

loc_41FB9D:				; CODE XREF: sub_41FA0E+172j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_41FBAE:				; CODE XREF: sub_41FA0E+18Dj
		add	eax, ebx
		mov	[ebp+var_24], eax
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_24]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	edx, eax
		mov	eax, [ebp+var_28]
		mov	[edx], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_14], eax
		jmp	loc_41FC7F
; ---------------------------------------------------------------------------

loc_41FBF0:				; CODE XREF: sub_41FA0E+156j
					; sub_41FA0E+162j
		mov	eax, [ebp+var_28]
		add	eax, 10h
		mov	[esp+38h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41FC71
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	dword ptr [eax], 1
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		jmp	short loc_41FC7F
; ---------------------------------------------------------------------------

loc_41FC71:				; CODE XREF: sub_41FA0E+1F7j
		mov	[ebp+var_10], offset aErrorInGette_0 ; "ERROR in GETTEXT MALLOC"
		mov	[ebp+var_14], 0

loc_41FC7F:				; CODE XREF: sub_41FA0E+14Bj
					; sub_41FA0E+1DDj ...
		mov	eax, [ebp+var_20]
		mov	[esp+38h+Dst], eax
		call	gcry_free
		jmp	loc_41FD49
; ---------------------------------------------------------------------------

loc_41FC8F:				; CODE XREF: sub_41FA0E+9Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		cmp	eax, 1
		jnz	short loc_41FCF5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_C], eax
		jmp	short loc_41FCC2
; ---------------------------------------------------------------------------

loc_41FCAF:				; CODE XREF: sub_41FA0E+2B8j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, [ebp+arg_4]
		jz	short loc_41FCCA
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_41FCC2:				; CODE XREF: sub_41FA0E+29Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_41FCAF
		jmp	short loc_41FCCB
; ---------------------------------------------------------------------------

loc_41FCCA:				; CODE XREF: sub_41FA0E+2AAj
		nop

loc_41FCCB:				; CODE XREF: sub_41FA0E+2BAj
		cmp	[ebp+var_C], 0
		jz	short loc_41FCE5
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		jmp	short loc_41FD49
; ---------------------------------------------------------------------------

loc_41FCE5:				; CODE XREF: sub_41FA0E+2C1j
		mov	[ebp+var_10], offset aErrorInGette_1 ; "ERROR in GETTEXT (overflow space)\n"
		mov	[ebp+var_14], 0
		jmp	short loc_41FD49
; ---------------------------------------------------------------------------

loc_41FCF5:				; CODE XREF: sub_41FA0E+294j
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41FD20
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_41F0CB
		jmp	short loc_41FD31
; ---------------------------------------------------------------------------

loc_41FD20:				; CODE XREF: sub_41FA0E+2F5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_41FD31:				; CODE XREF: sub_41FA0E+310j
		add	eax, ebx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_41FD49:				; CODE XREF: sub_41FA0E+87j
					; sub_41FA0E+27Cj ...
		cmp	[ebp+arg_8], 0
		jz	short loc_41FD70
		cmp	[ebp+var_14], 0
		jz	short loc_41FD70
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+Size],	eax ; int
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Src], eax ; int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax ; char *
		call	sub_41F9A8
		jmp	short loc_41FD73
; ---------------------------------------------------------------------------

loc_41FD70:				; CODE XREF: sub_41FA0E+33Fj
					; sub_41FA0E+345j
		mov	eax, [ebp+var_10]

loc_41FD73:				; CODE XREF: sub_41FA0E+360j
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_41FA0E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41FD79(char *, int, int)
sub_41FD79	proc near		; CODE XREF: sub_420034+1Cp
					; .text:00420073p ...

Str1		= dword	ptr -58h
Str2		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		mov	eax, ds:dword_430324
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	loc_42000B
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		cmp	eax, 2
		jbe	loc_41FF44
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_41FF44
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax
		call	sub_41F0FA
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_18]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_20]
		mov	edx, 0
		div	ecx
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		lea	ecx, [eax-2]
		mov	eax, [ebp+var_20]
		mov	edx, 0
		div	ecx
		mov	eax, edx
		add	eax, 1
		mov	[ebp+var_24], eax
		jmp	loc_41FF03
; ---------------------------------------------------------------------------

loc_41FE13:				; CODE XREF: sub_41FD79+1C5j
		sub	[ebp+var_28], 1
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_28]
		jbe	loc_41FEDB
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41FE4A
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	sub_41F0CB
		jmp	short loc_41FE5A
; ---------------------------------------------------------------------------

loc_41FE4A:				; CODE XREF: sub_41FD79+B5j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_41FE5A:				; CODE XREF: sub_41FD79+CFj
		cmp	eax, [ebp+var_1C]
		jb	short loc_41FEDB
		mov	eax, [ebp+var_18]
		mov	ebx, [eax]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41FE89
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+58h+Str1],	eax
		call	sub_41F0CB
		jmp	short loc_41FE9A
; ---------------------------------------------------------------------------

loc_41FE89:				; CODE XREF: sub_41FD79+F3j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_41FE9A:				; CODE XREF: sub_41FD79+10Ej
		add	eax, ebx
		mov	[esp+58h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41FEDB
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	eax, al
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str1],	eax
		call	sub_41FA0E
		jmp	loc_420025
; ---------------------------------------------------------------------------

loc_41FEDB:				; CODE XREF: sub_41FD79+A7j
					; sub_41FD79+E4j ...
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		sub	eax, [ebp+var_24]
		cmp	eax, [ebp+var_14]
		ja	short loc_41FEFD
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		mov	edx, [ebp+var_24]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+var_14], eax
		jmp	short loc_41FF03
; ---------------------------------------------------------------------------

loc_41FEFD:				; CODE XREF: sub_41FD79+16Ej
		mov	eax, [ebp+var_24]
		add	[ebp+var_14], eax

loc_41FF03:				; CODE XREF: sub_41FD79+95j
					; sub_41FD79+182j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41FF27
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	sub_41F0CB
		jmp	short loc_41FF37
; ---------------------------------------------------------------------------

loc_41FF27:				; CODE XREF: sub_41FD79+192j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]

loc_41FF37:				; CODE XREF: sub_41FD79+1ACj
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	loc_41FE13

loc_41FF44:				; CODE XREF: sub_41FD79+23j
					; sub_41FD79+31j
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_C], eax
		jmp	loc_41FFFD
; ---------------------------------------------------------------------------

loc_41FF59:				; CODE XREF: sub_41FD79+28Aj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		shr	eax, 1
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_18]
		mov	ebx, [eax]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41FF90
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+58h+Str1],	eax
		call	sub_41F0CB
		jmp	short loc_41FFA1
; ---------------------------------------------------------------------------

loc_41FF90:				; CODE XREF: sub_41FD79+1FAj
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_41FFA1:				; CODE XREF: sub_41FD79+215j
		add	eax, ebx
		mov	[esp+58h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jns	short loc_41FFC3
		mov	eax, [ebp+var_28]
		mov	[ebp+var_C], eax
		jmp	short loc_41FFFD
; ---------------------------------------------------------------------------

loc_41FFC3:				; CODE XREF: sub_41FD79+240j
		cmp	[ebp+var_2C], 0
		jle	short loc_41FFD4
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_41FFFD
; ---------------------------------------------------------------------------

loc_41FFD4:				; CODE XREF: sub_41FD79+24Ej
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	eax, al
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str1],	eax
		call	sub_41FA0E
		jmp	short loc_420025
; ---------------------------------------------------------------------------

loc_41FFFD:				; CODE XREF: sub_41FD79+1DBj
					; sub_41FD79+248j ...
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_C]
		jb	loc_41FF59
		jmp	short loc_42000C
; ---------------------------------------------------------------------------

loc_42000B:				; CODE XREF: sub_41FD79+14j
		nop

loc_42000C:				; CODE XREF: sub_41FD79+290j
		cmp	[ebp+arg_4], 0
		jz	short loc_420022
		cmp	[ebp+arg_8], 1
		jnz	short loc_42001D
		mov	eax, [ebp+arg_0]
		jmp	short loc_420020
; ---------------------------------------------------------------------------

loc_42001D:				; CODE XREF: sub_41FD79+29Dj
		mov	eax, [ebp+arg_4]

loc_420020:				; CODE XREF: sub_41FD79+2A2j
		jmp	short loc_420025
; ---------------------------------------------------------------------------

loc_420022:				; CODE XREF: sub_41FD79+297j
		mov	eax, [ebp+arg_0]

loc_420025:				; CODE XREF: sub_41FD79+15Dj
					; sub_41FD79+282j ...
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41FD79	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_420034(char *)
sub_420034	proc near		; CODE XREF: sub_40155D+3Dp
					; sub_40155D+4Ep ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_10], 0 ; int
		mov	[esp+18h+var_14], 0 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_41FD79
		leave
		retn
sub_420034	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_41FD79
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41FD79
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp], offset	aLc_messages ; "LC_MESSAGES"
		call	sub_41E584
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_4200BB
		mov	eax, [ebp-0Ch]
		jmp	short locret_4200C0
; ---------------------------------------------------------------------------

loc_4200BB:				; CODE XREF: .text:004200B4j
		mov	eax, offset byte_42E1D7

locret_4200C0:				; CODE XREF: .text:004200B9j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4200C2	proc near		; CODE XREF: sub_40B949+Dp
					; sub_40B962+Dp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ds:dword_430328, eax
		pop	ebp
		retn
sub_4200C2	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4200D0	proc near		; CODE XREF: sub_4032E3+33Dp
					; sub_4037B4+13p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ds:dword_4303CC
		mov	[ebp+var_4], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_4200EE
		mov	ds:dword_4303CC, 0

loc_4200EE:				; CODE XREF: sub_4200D0+12j
		mov	eax, [ebp+var_4]
		leave
		retn
sub_4200D0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_4303CC
		add	eax, 1
		mov	ds:dword_4303CC, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_420105(char *Filename, int FileHandle)
sub_420105	proc near		; CODE XREF: sub_420364+21p
					; .text:004203A0p

File		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Filename	= dword	ptr  8
FileHandle	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_42014F
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_420145
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_420145
		mov	eax, ds:File
		mov	[esp+28h+File],	eax ; File
		call	fclose

loc_420145:				; CODE XREF: sub_420105+20j
					; sub_420105+31j
		mov	ds:File, 0

loc_42014F:				; CODE XREF: sub_420105+Fj
		cmp	[ebp+Filename],	0
		jz	short loc_420197
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset asc_42E1D8 ; "-"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_420197
		mov	[ebp+Filename],	0
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+28h+File],	eax ; File
		call	_fileno
		mov	[ebp+FileHandle], eax

loc_420197:				; CODE XREF: sub_420105+4Ej
					; sub_420105+76j
		cmp	[ebp+Filename],	0
		jz	short loc_4201ED
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset aSocket ; "socket://"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4201D9
		mov	eax, [ebp+Filename]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4201D9
		mov	eax, 1
		jmp	short loc_4201DE
; ---------------------------------------------------------------------------

loc_4201D9:				; CODE XREF: sub_420105+BEj
					; sub_420105+CBj
		mov	eax, 0

loc_4201DE:				; CODE XREF: sub_420105+D2j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4201F4
		add	[ebp+Filename],	9
		jmp	short loc_4201F4
; ---------------------------------------------------------------------------

loc_4201ED:				; CODE XREF: sub_420105+96j
		mov	[ebp+var_10], 0

loc_4201F4:				; CODE XREF: sub_420105+E0j
					; sub_420105+E6j
		cmp	[ebp+var_10], 0
		jz	short loc_420230
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aSystemDoesNotS ; "system does not support logging to a so"...
		mov	[esp+28h+var_1C], edx ;	File
		mov	[esp+28h+Count], 3Bh ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+File],	eax ; Str
		call	fwrite
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_42028B
; ---------------------------------------------------------------------------

loc_420230:				; CODE XREF: sub_420105+F3j
		cmp	[ebp+Filename],	0
		jz	short loc_42024F
		mov	eax, offset aA_0 ; "a"
		mov	[esp+28h+Size],	eax ; Mode
		mov	eax, [ebp+Filename]
		mov	[esp+28h+File],	eax ; Filename
		call	fopen
		mov	[ebp+var_C], eax
		jmp	short loc_42028B
; ---------------------------------------------------------------------------

loc_42024F:				; CODE XREF: sub_420105+12Fj
		cmp	[ebp+FileHandle], 1
		jnz	short loc_420262
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[ebp+var_C], eax
		jmp	short loc_42028B
; ---------------------------------------------------------------------------

loc_420262:				; CODE XREF: sub_420105+14Ej
		cmp	[ebp+FileHandle], 2
		jnz	short loc_420275
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_42028B
; ---------------------------------------------------------------------------

loc_420275:				; CODE XREF: sub_420105+161j
		mov	[esp+28h+Size],	offset aA_0 ; "a"
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+File],	eax ; FileHandle
		call	_fdopen
		mov	[ebp+var_C], eax

loc_42028B:				; CODE XREF: sub_420105+129j
					; sub_420105+148j ...
		mov	dword_4292F0, 0FFFFFFFFh
		cmp	[ebp+var_C], 0
		jnz	loc_420320
		cmp	[ebp+Filename],	0
		jz	short loc_4202DD
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToOpenLo ; "failed to open log file `%s': %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+Filename]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		jmp	short loc_420313
; ---------------------------------------------------------------------------

loc_4202DD:				; CODE XREF: sub_420105+19Ej
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToFdopen ; "failed to fdopen	file descriptor	%d: %s"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf

loc_420313:				; CODE XREF: sub_420105+1D6j
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_420343
; ---------------------------------------------------------------------------

loc_420320:				; CODE XREF: sub_420105+194j
		mov	[esp+28h+var_1C], 0 ; Size
		mov	[esp+28h+Count], 40h ; Mode
		mov	[esp+28h+Size],	0 ; Buf
		mov	eax, [ebp+var_C]
		mov	[esp+28h+File],	eax ; File
		call	setvbuf

loc_420343:				; CODE XREF: sub_420105+219j
		mov	eax, [ebp+var_C]
		mov	ds:File, eax
		mov	eax, [ebp+var_10]
		mov	ds:dword_4303C4, eax
		mov	ds:dword_4303C8, 0
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_420105	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_420364(char *)
sub_420364	proc near		; CODE XREF: sub_420526+19p

Filename	= dword	ptr -18h
FileHandle	= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_420375
		mov	eax, [ebp+arg_0]
		jmp	short loc_42037A
; ---------------------------------------------------------------------------

loc_420375:				; CODE XREF: sub_420364+Aj
		mov	eax, offset asc_42E1D8 ; "-"

loc_42037A:				; CODE XREF: sub_420364+Fj
		mov	[esp+18h+FileHandle], 0FFFFFFFFh ; FileHandle
		mov	[esp+18h+Filename], eax	; Filename
		call	sub_420105
		leave
		retn
sub_420364	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_420105
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_4303BC, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4203B4(char *, int)
sub_4203B4	proc near		; CODE XREF: sub_4032E3+3Ep

Dest		= dword	ptr -18h
Source		= dword	ptr -14h
Count		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_4203E2
		mov	[esp+18h+Count], 4Fh ; Count
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Source], eax ;	Source
		mov	[esp+18h+Dest],	offset Dest ; Dest
		call	strncpy
		mov	ds:byte_4303AF,	0

loc_4203E2:				; CODE XREF: sub_4203B4+Aj
		mov	eax, [ebp+arg_4]
		and	eax, 1
		mov	ds:dword_4303B4, eax
		mov	eax, [ebp+arg_4]
		and	eax, 2
		mov	ds:dword_4303B0, eax
		mov	eax, [ebp+arg_4]
		and	eax, 4
		mov	ds:dword_4303B8, eax
		mov	eax, [ebp+arg_4]
		and	eax, 100h
		mov	ds:dword_4303C0, eax
		leave
		retn
sub_4203B4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_420484
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0
		mov	eax, ds:dword_4303B4
		test	eax, eax
		jz	short loc_42043C
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 1
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_42043C:				; CODE XREF: .text:0042042Bj
		mov	eax, ds:dword_4303B0
		test	eax, eax
		jz	short loc_420454
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 2
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_420454:				; CODE XREF: .text:00420443j
		mov	eax, ds:dword_4303B8
		test	eax, eax
		jz	short loc_42046C
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 4
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_42046C:				; CODE XREF: .text:0042045Bj
		mov	eax, ds:dword_4303C0
		test	eax, eax
		jz	short loc_420484
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	dh, 1
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_420484:				; CODE XREF: .text:00420419j
					; .text:00420473j
		mov	eax, offset Dest
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_4204BF
		mov	eax, ds:File
		mov	[esp], eax
		call	_fileno
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	short loc_4204BF
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_4204BF
		mov	eax, 1
		jmp	short locret_4204DF
; ---------------------------------------------------------------------------

loc_4204BF:				; CODE XREF: .text:00420498j
					; .text:004204AEj ...
		mov	eax, dword_4292F0
		cmp	eax, 0FFFFFFFFh
		jz	short loc_4204DA
		mov	eax, dword_4292F0
		cmp	eax, [ebp+8]
		jnz	short loc_4204DA
		mov	eax, 1
		jmp	short locret_4204DF
; ---------------------------------------------------------------------------

loc_4204DA:				; CODE XREF: .text:004204C7j
					; .text:004204D1j
		mov	eax, 0

locret_4204DF:				; CODE XREF: .text:004204BDj
					; .text:004204D8j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4204E1	proc near		; CODE XREF: sub_41C657+3CEp
					; sub_41C657+3D8p

File		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_4204FA
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_4204FF
; ---------------------------------------------------------------------------

loc_4204FA:				; CODE XREF: sub_4204E1+Dj
		mov	eax, ds:File

loc_4204FF:				; CODE XREF: sub_4204E1+17j
		mov	[esp+18h+File],	eax ; File
		call	_fileno
		leave
		retn
sub_4204E1	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_42051F
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_420524
; ---------------------------------------------------------------------------

loc_42051F:				; CODE XREF: .text:00420513j
		mov	eax, ds:File

loc_420524:				; CODE XREF: .text:0042051Dj
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_420526(int, char *Format, va_list ArgList)
sub_420526	proc near		; CODE XREF: sub_4208A9+22p
					; sub_4208D2+1Ap ...

var_58		= dword	ptr -58h
File		= dword	ptr -54h
Count		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
Format		= dword	ptr  0Ch
ArgList		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_420569
		mov	[esp+58h+var_58], 0 ; char *
		call	sub_420364
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_420569
		mov	[esp+58h+Count], 1C3h ;	int
		mov	[esp+58h+File],	offset a____Gnupg22_10 ; "../../gnupg2-2.0.30/jnlib/logging.c"
		mov	[esp+58h+var_58], offset aLogstream ; "logstream"
		call	sub_4276E0

loc_420569:				; CODE XREF: sub_420526+10j
					; sub_420526+25j
		mov	eax, ds:dword_4303C8
		test	eax, eax
		jz	short loc_42058D
		cmp	[ebp+arg_0], 1
		jz	short loc_42058D
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_42058D:				; CODE XREF: sub_420526+4Aj
					; sub_420526+50j
		mov	ds:dword_4303C8, 0
		cmp	[ebp+arg_0], 1
		jz	loc_420724
		mov	eax, ds:dword_4303B0
		test	eax, eax
		jz	loc_42063D
		mov	eax, ds:dword_4303C4
		test	eax, eax
		jnz	loc_42063D
		mov	[esp+58h+var_58], 0
		call	sub_4277C0
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_58], eax
		call	sub_4277F0
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	edx, [eax]
		mov	eax, [ebp+var_1C]
		mov	edi, [eax+4]
		mov	eax, [ebp+var_1C]
		mov	esi, [eax+8]
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax+0Ch]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+10h]
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+14h]
		add	eax, 76Ch
		mov	[ebp+var_30], eax
		mov	ecx, offset a04d02d02d02d_0 ; "%04d-%02d-%02d %02d:%02d:%02d "
		mov	eax, ds:File
		mov	[esp+58h+var_3C], edx
		mov	[esp+58h+var_40], edi
		mov	[esp+58h+var_44], esi
		mov	[esp+58h+var_48], ebx
		mov	edx, [ebp+var_2C]
		mov	[esp+58h+var_4C], edx
		mov	edi, [ebp+var_30]
		mov	[esp+58h+Count], edi
		mov	[esp+58h+File],	ecx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_42063D:				; CODE XREF: sub_420526+82j
					; sub_420526+8Fj
		mov	eax, ds:dword_4303B4
		test	eax, eax
		jnz	short loc_42064F
		mov	eax, ds:dword_4303C4
		test	eax, eax
		jz	short loc_420666

loc_42064F:				; CODE XREF: sub_420526+11Ej
		mov	edx, ds:File
		mov	eax, offset Dest
		mov	[esp+58h+File],	edx ; File
		mov	[esp+58h+var_58], eax ;	Str
		call	fputs

loc_420666:				; CODE XREF: sub_420526+127j
		mov	eax, ds:dword_4303B8
		test	eax, eax
		jnz	short loc_420678
		mov	eax, ds:dword_4303C4
		test	eax, eax
		jz	short loc_4206D2

loc_420678:				; CODE XREF: sub_420526+147j
		mov	eax, ds:dword_4303BC
		test	eax, eax
		jz	short loc_4206B1
		mov	eax, ds:dword_4303BC
		call	eax ; dword_4303BC
		mov	ebx, eax
		call	_getpid
		mov	ecx, eax
		mov	edx, offset aU_Lx ; "[%u.%lx]"
		mov	eax, ds:File
		mov	[esp+58h+var_4C], ebx
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_4206D2
; ---------------------------------------------------------------------------

loc_4206B1:				; CODE XREF: sub_420526+159j
		call	_getpid
		mov	ecx, eax
		mov	edx, offset aU	; "[%u]"
		mov	eax, ds:File
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_4206D2:				; CODE XREF: sub_420526+150j
					; sub_420526+189j
		mov	eax, ds:dword_4303B0
		test	eax, eax
		jz	short loc_4206E4
		mov	eax, ds:dword_4303C4
		test	eax, eax
		jz	short loc_4206F9

loc_4206E4:				; CODE XREF: sub_420526+1B3j
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 3Ah ;	Ch
		call	putc

loc_4206F9:				; CODE XREF: sub_420526+1BCj
		cmp	[ebp+Format], 0
		jz	short loc_42070F
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_42070F
		add	[ebp+Format], 1
		jmp	short loc_420724
; ---------------------------------------------------------------------------

loc_42070F:				; CODE XREF: sub_420526+1D7j
					; sub_420526+1E1j
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 20h ;	Ch
		call	putc

loc_420724:				; CODE XREF: sub_420526+75j
					; sub_420526+1E7j
		cmp	[ebp+arg_0], 7	; switch 8 cases
		ja	loc_4207B8	; jumptable 0042073B default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_42E308
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_42073D:				; CODE XREF: sub_420526+215j
					; DATA XREF: .rdata:off_42E308o
		mov	edx, ds:File	; jumptable 0042073B case 5
		mov	eax, offset aFatal ; "Fatal: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 7 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_4207D8
; ---------------------------------------------------------------------------

loc_420766:				; CODE XREF: sub_420526+215j
					; DATA XREF: .rdata:off_42E308o
		mov	edx, ds:File	; jumptable 0042073B case 6
		mov	eax, offset aOhhhhJeeee	; "Ohhhh jeeee:	"
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 0Dh ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_4207D8
; ---------------------------------------------------------------------------

loc_42078F:				; CODE XREF: sub_420526+215j
					; DATA XREF: .rdata:off_42E308o
		mov	edx, ds:File	; jumptable 0042073B case 7
		mov	eax, offset aDbg ; "DBG: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 5 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_4207D8
; ---------------------------------------------------------------------------

loc_4207B8:				; CODE XREF: sub_420526+202j
		mov	edx, offset aUnknownLogLeve ; jumptable	0042073B default case
		mov	eax, ds:File
		mov	ecx, [ebp+arg_0]
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_4207D8
; ---------------------------------------------------------------------------

loc_4207D7:				; CODE XREF: sub_420526+215j
					; DATA XREF: .rdata:off_42E308o
		nop			; jumptable 0042073B cases 0-4

loc_4207D8:				; CODE XREF: sub_420526+23Ej
					; sub_420526+267j ...
		cmp	[ebp+Format], 0
		jz	short loc_420848
		mov	eax, ds:File
		mov	edx, [ebp+ArgList]
		mov	[esp+58h+Count], edx ; ArgList
		mov	edx, [ebp+Format]
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	vfprintf
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42083B
		mov	eax, [ebp+Format]
		mov	[ebp+var_34], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_34]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_42083B
		mov	ds:dword_4303C8, 1
		jmp	short loc_420848
; ---------------------------------------------------------------------------

loc_42083B:				; CODE XREF: sub_420526+2DBj
					; sub_420526+307j
		mov	eax, ds:File
		mov	[esp+58h+var_58], eax ;	File
		call	fflush

loc_420848:				; CODE XREF: sub_420526+2B6j
					; sub_420526+313j
		cmp	[ebp+arg_0], 5
		jnz	short loc_420878
		mov	eax, ds:dword_4303C8
		test	eax, eax
		jz	short loc_42086C
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_42086C:				; CODE XREF: sub_420526+32Fj
		mov	[esp+58h+var_58], 2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_420878:				; CODE XREF: sub_420526+326j
		cmp	[ebp+arg_0], 6
		jnz	short loc_4208A1
		mov	eax, ds:dword_4303C8
		test	eax, eax
		jz	short loc_42089C
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_42089C:				; CODE XREF: sub_420526+35Fj
		call	abort
; ---------------------------------------------------------------------------

loc_4208A1:				; CODE XREF: sub_420526+356j
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_420526	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4208A9(int, char *, char)
sub_4208A9	proc near		; CODE XREF: sub_420AAC+2Ap

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_420526
		leave
		retn
sub_4208A9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4208D2(int, char *, va_list)
sub_4208D2	proc near		; CODE XREF: sub_40BA33+8Fp

var_18		= dword	ptr -18h
Format		= dword	ptr -14h
ArgList		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_420526
		leave
		retn
sub_4208D2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4208F3(char *, char)
sub_4208F3	proc near		; CODE XREF: sub_401BD6+84p
					; sub_401BD6+F2p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 2 ; int
		call	sub_420526
		leave
		retn
sub_4208F3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42091D(char *, char)
sub_42091D	proc near		; CODE XREF: sub_4015D2+53p
					; sub_4016E0+4Cp ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 4 ; int
		call	sub_420526
		mov	eax, ds:dword_4303CC
		cmp	eax, 752Fh
		jg	short locret_42095E
		mov	eax, ds:dword_4303CC
		add	eax, 1
		mov	ds:dword_4303CC, eax

locret_42095E:				; CODE XREF: sub_42091D+32j
		leave
		retn
sub_42091D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl sub_420960(char *, char)
sub_420960	proc near		; CODE XREF: sub_4032E3+8Ep
					; sub_40BAC9+27p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 5 ; int
		call	sub_420526
		call	abort
sub_420960	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl sub_42098D(char *, char)
sub_42098D	proc near		; CODE XREF: sub_41A78C+19Bp
					; sub_41A78C+28Ep ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 6 ; int
		call	sub_420526
		call	abort
sub_42098D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4209BA(char *, char)
sub_4209BA	proc near		; CODE XREF: sub_409888+4A9p
					; sub_40A1A4+3DFp ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 7 ; int
		call	sub_420526
		leave
		retn
sub_4209BA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4209E4(char *, char)
sub_4209E4	proc near		; CODE XREF: sub_402637+286p
					; sub_402637+29Cp ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		cmp	[ebp+arg_0], 0
		setnz	al
		movzx	eax, al
		mov	[esp+28h+ArgList], edx ; ArgList
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+var_28], eax ;	int
		call	sub_420526
		leave
		retn
sub_4209E4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_420A3D
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_420A3D
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_42E328
		call	sub_4209BA

loc_420A3D:				; CODE XREF: .text:00420A1Ej
					; .text:00420A28j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_420A98
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a02x_1 ; "%02X"
		call	sub_4209E4
		sub	dword ptr [ebp+10h], 1
		add	dword ptr [ebp-0Ch], 1
		jmp	short loc_420A89
; ---------------------------------------------------------------------------

loc_420A6C:				; CODE XREF: .text:00420A96j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a02x_2 ; " %02X"
		call	sub_4209E4
		add	dword ptr [ebp-0Ch], 1

loc_420A89:				; CODE XREF: .text:00420A6Aj
		cmp	dword ptr [ebp+10h], 0
		setnz	al
		sub	dword ptr [ebp+10h], 1
		test	al, al
		jnz	short loc_420A6C

loc_420A98:				; CODE XREF: .text:00420A41j
		cmp	dword ptr [ebp+8], 0
		jz	short locret_420AAA
		mov	dword ptr [esp], offset	asc_42E337 ; "\n"
		call	sub_4209E4

locret_420AAA:				; CODE XREF: .text:00420A9Cj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_420AAC	proc near		; CODE XREF: sub_40402A+6Bp
					; sub_40C93A+62Fp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_18], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_1C], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_20], eax	; char
		mov	[esp+28h+var_24], offset a___ThisIsABugS ; "...	this is	a bug (%s:%d:%s)\n"
		mov	[esp+28h+var_28], 6 ; int
		call	sub_4208A9
		call	abort
sub_420AAC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_420AE0(char *)
sub_420AE0	proc near		; CODE XREF: sub_4210BA+356p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+Val], 5Ch ; Val
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_420B23
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		jmp	short loc_420B19
; ---------------------------------------------------------------------------

loc_420B05:				; CODE XREF: sub_420AE0+41j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_420B15
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	5Ch

loc_420B15:				; CODE XREF: sub_420AE0+2Dj
		add	[ebp+var_C], 1

loc_420B19:				; CODE XREF: sub_420AE0+23j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_420B05

loc_420B23:				; CODE XREF: sub_420AE0+1Bj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_420AE0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_420BF9
; ---------------------------------------------------------------------------

loc_420B4C:				; CODE XREF: .text:00420BFDj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jnz	short loc_420BF1
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_420B9E
; ---------------------------------------------------------------------------

loc_420B92:				; CODE XREF: .text:00420BCEj
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_420B9E:				; CODE XREF: .text:00420B90j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_420BD0
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_420B92

loc_420BD0:				; CODE XREF: .text:00420BA2j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_420BDF
		mov	eax, [ebp-18h]
		jmp	short loc_420C08
; ---------------------------------------------------------------------------

loc_420BDF:				; CODE XREF: .text:00420BD8j
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_420BF1:				; CODE XREF: .text:00420B76j
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_420BF9:				; CODE XREF: .text:00420B47j
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_420B4C
		mov	eax, 0

loc_420C08:				; CODE XREF: .text:00420BDDj
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_420CD7
; ---------------------------------------------------------------------------

loc_420C32:				; CODE XREF: .text:00420CDBj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_421CF1
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_421CF1
		cmp	ebx, eax
		jnz	short loc_420CCF
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_420C80
; ---------------------------------------------------------------------------

loc_420C74:				; CODE XREF: .text:00420CACj
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_420C80:				; CODE XREF: .text:00420C72j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_420CAE
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_421CF1
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_421CF1
		cmp	ebx, eax
		jz	short loc_420C74

loc_420CAE:				; CODE XREF: .text:00420C84j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_420CBD
		mov	eax, [ebp-18h]
		jmp	short loc_420CE6
; ---------------------------------------------------------------------------

loc_420CBD:				; CODE XREF: .text:00420CB6j
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_420CCF:				; CODE XREF: .text:00420C58j
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_420CD7:				; CODE XREF: .text:00420C2Dj
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_420C32
		mov	eax, 0

loc_420CE6:				; CODE XREF: .text:00420CBBj
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_420D4B
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_420D0C
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp+8], eax

loc_420D0C:				; CODE XREF: .text:00420CFCj
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		sub	dword ptr [ebp+10h], 1
		jmp	short loc_420D35
; ---------------------------------------------------------------------------

loc_420D1E:				; CODE XREF: .text:00420D43j
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp+10h], 1

loc_420D35:				; CODE XREF: .text:00420D1Cj
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_420D45
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_420D1E

loc_420D45:				; CODE XREF: .text:00420D39j
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0

loc_420D4B:				; CODE XREF: .text:00420CF6j
		mov	eax, [ebp+8]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_420D50	proc near		; CODE XREF: .text:00422E05p
					; .text:00422EC2p

C		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_420D68
; ---------------------------------------------------------------------------

loc_420D64:				; CODE XREF: sub_420D50+37j
		add	[ebp+var_10], 1

loc_420D68:				; CODE XREF: sub_420D50+12j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_420D89
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_420D64

loc_420D89:				; CODE XREF: sub_420D50+20j
		mov	[ebp+var_14], 0
		jmp	short loc_420DC6
; ---------------------------------------------------------------------------

loc_420D92:				; CODE XREF: sub_420D50+89j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_420DB7
		cmp	[ebp+var_14], 0
		jnz	short loc_420DBE
		mov	eax, [ebp+var_C]
		mov	[ebp+var_14], eax
		jmp	short loc_420DBE
; ---------------------------------------------------------------------------

loc_420DB7:				; CODE XREF: sub_420D50+57j
		mov	[ebp+var_14], 0

loc_420DBE:				; CODE XREF: sub_420D50+5Dj
					; sub_420D50+65j
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_420DC6:				; CODE XREF: sub_420D50+40j
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_420D92
		cmp	[ebp+var_14], 0
		jz	short loc_420DE7
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0

loc_420DE7:				; CODE XREF: sub_420D50+8Fj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_420D50	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_420E31
; ---------------------------------------------------------------------------

loc_420E01:				; CODE XREF: .text:00420E39j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_420E26
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_420E2D
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax
		jmp	short loc_420E2D
; ---------------------------------------------------------------------------

loc_420E26:				; CODE XREF: .text:00420E16j
		mov	dword ptr [ebp-10h], 0

loc_420E2D:				; CODE XREF: .text:00420E1Cj
					; .text:00420E24j
		add	dword ptr [ebp-0Ch], 1

loc_420E31:				; CODE XREF: .text:00420DFFj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_420E01
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_420E47
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	0

loc_420E47:				; CODE XREF: .text:00420E3Fj
		mov	eax, [ebp+8]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_420E4C(int, int, char	*)
sub_420E4C	proc near		; CODE XREF: .text:00420EE3p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_420EA1
; ---------------------------------------------------------------------------

loc_420E68:				; CODE XREF: sub_420E4C+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_420E92
		cmp	[ebp+var_10], 0
		jnz	short loc_420E99
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_420E99
; ---------------------------------------------------------------------------

loc_420E92:				; CODE XREF: sub_420E4C+36j
		mov	[ebp+var_10], 0

loc_420E99:				; CODE XREF: sub_420E4C+3Cj
					; sub_420E4C+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_420EA1:				; CODE XREF: sub_420E4C+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_420E68
		cmp	[ebp+var_10], 0
		jz	short loc_420EC3
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_420EC6
; ---------------------------------------------------------------------------

loc_420EC3:				; CODE XREF: sub_420E4C+61j
		mov	eax, [ebp+arg_4]

locret_420EC6:				; CODE XREF: sub_420E4C+75j
		leave
		retn
sub_420E4C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_42E358 ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_420E4C
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_420EEA(int, int, char	*)
sub_420EEA	proc near		; CODE XREF: .text:00420F7Bp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_420F3F
; ---------------------------------------------------------------------------

loc_420F06:				; CODE XREF: sub_420EEA+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_420F30
		cmp	[ebp+var_10], 0
		jnz	short loc_420F37
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_420F37
; ---------------------------------------------------------------------------

loc_420F30:				; CODE XREF: sub_420EEA+36j
		mov	[ebp+var_10], 0

loc_420F37:				; CODE XREF: sub_420EEA+3Cj
					; sub_420EEA+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_420F3F:				; CODE XREF: sub_420EEA+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_420F06
		cmp	[ebp+var_10], 0
		jz	short loc_420F5B
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_420F5E
; ---------------------------------------------------------------------------

loc_420F5B:				; CODE XREF: sub_420EEA+61j
		mov	eax, [ebp+arg_4]

locret_420F5E:				; CODE XREF: sub_420EEA+6Fj
		leave
		retn
sub_420EEA	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_42E358 ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_420EEA
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_420FE9
		mov	dword ptr [esp+4], 5Ch
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_420FE9
		mov	dword ptr [esp+4], 3Ah
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_420FE9
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	gcry_xstrdup
		jmp	short locret_420FF7
; ---------------------------------------------------------------------------

loc_420FE9:				; CODE XREF: .text:00420FA2j
					; .text:00420FBEj ...
		mov	eax, [ebp-0Ch]
		add	eax, 1
		mov	[esp], eax
		call	gcry_xstrdup

locret_420FF7:				; CODE XREF: .text:00420FE7j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_421061
		mov	dword ptr [esp+4], 5Ch
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_421061
		mov	dword ptr [esp+4], 3Ah
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_421061
		mov	dword ptr [esp], offset	a_ ; "."
		call	gcry_xstrdup
		jmp	short locret_4210A6
; ---------------------------------------------------------------------------

loc_421061:				; CODE XREF: .text:00421019j
					; .text:00421035j ...
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp-14h], eax
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	strncpy
		mov	eax, [ebp-10h]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-14h]

locret_4210A6:				; CODE XREF: .text:0042105Fj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4210A8	proc near		; CODE XREF: sub_4210BA+144p
					; sub_4210BA+22Bp

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		mov	eax, [ebp+var_4]
		leave
		retn
sub_4210A8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4210BA	proc near		; CODE XREF: sub_42141F+23p
					; .text:00421472p

VarName		= dword	ptr -0C8h
Val		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
Str		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0C0h
		mov	[ebp+var_14], 1
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_421181
; ---------------------------------------------------------------------------

loc_421107:				; CODE XREF: sub_4210BA+E8j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_10]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		cmp	eax, 1Eh
		jbe	short loc_42117D
		cmp	[ebp+arg_0], 0
		jz	short loc_421166
		mov	[esp+0C8h+var_C0], offset aDo_make_filena ; "do_make_filename"
		mov	[esp+0C8h+Val],	176h
		mov	[esp+0C8h+VarName], offset a____Gnupg22_11 ; "../../gnupg2-2.0.30/jnlib/stringhelp.c"
		call	sub_420AAC
; ---------------------------------------------------------------------------

loc_421166:				; CODE XREF: sub_4210BA+8Ej
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	loc_421415
; ---------------------------------------------------------------------------

loc_42117D:				; CODE XREF: sub_4210BA+88j
		add	[ebp+var_C], 1

loc_421181:				; CODE XREF: sub_4210BA+4Bj
		mov	eax, [ebp+arg_8]
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_A8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		test	eax, eax
		jnz	loc_421107
		add	[ebp+var_10], 1
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Eh
		jnz	loc_421338
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jz	short loc_4211DB
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_421251

loc_4211DB:				; CODE XREF: sub_4210BA+112j
		mov	[esp+0C8h+VarName], offset aHome_0 ; "HOME"
		call	getenv
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_42120C
		mov	[esp+0C8h+Val],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+VarName], eax
		call	sub_4210A8
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_20], eax

loc_42120C:				; CODE XREF: sub_4210BA+134j
		cmp	[ebp+var_20], 0
		jz	loc_421337
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_421337
		mov	eax, [ebp+var_20]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		jmp	loc_421337
; ---------------------------------------------------------------------------

loc_421251:				; CODE XREF: sub_4210BA+11Fj
		cmp	[ebp+arg_0], 0
		jz	short loc_42126A
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+0C8h+VarName], eax
		call	gcry_xstrdup
		mov	[ebp+Str], eax
		jmp	short loc_42128B
; ---------------------------------------------------------------------------

loc_42126A:				; CODE XREF: sub_4210BA+19Bj
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+0C8h+VarName], eax
		call	gcry_strdup
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jnz	short loc_42128B
		mov	eax, 0
		jmp	loc_421415
; ---------------------------------------------------------------------------

loc_42128B:				; CODE XREF: sub_4210BA+1AEj
					; sub_4210BA+1C5j
		mov	[esp+0C8h+Val],	2Fh ; Val
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+VarName], eax	; Str
		call	strchr
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_4212AD
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0

loc_4212AD:				; CODE XREF: sub_4210BA+1EBj
		mov	eax, [ebp+Str]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+VarName], eax
		call	sub_4210A8
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+VarName], eax
		call	gcry_free
		cmp	[ebp+var_20], 0
		jz	short loc_42132E
		mov	eax, [ebp+var_20]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		jmp	short loc_421338
; ---------------------------------------------------------------------------

loc_42132E:				; CODE XREF: sub_4210BA+248j
		mov	[ebp+var_14], 1
		jmp	short loc_421338
; ---------------------------------------------------------------------------

loc_421337:				; CODE XREF: sub_4210BA+156j
					; sub_4210BA+164j ...
		nop

loc_421338:				; CODE XREF: sub_4210BA+101j
					; sub_4210BA+272j ...
		cmp	[ebp+arg_0], 0
		jz	short loc_42134E
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+VarName], eax
		call	gcry_xmalloc
		mov	[ebp+var_1C], eax
		jmp	short loc_421377
; ---------------------------------------------------------------------------

loc_42134E:				; CODE XREF: sub_4210BA+282j
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+VarName], eax
		call	gcry_malloc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_421377
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+VarName], eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_421415
; ---------------------------------------------------------------------------

loc_421377:				; CODE XREF: sub_4210BA+292j
					; sub_4210BA+2A6j
		cmp	[ebp+var_20], 0
		jz	short loc_4213A8
		mov	eax, [ebp+var_14]
		mov	ebx, eax
		add	ebx, [ebp+arg_4]
		mov	eax, [ebp+var_20]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax
		call	sub_421FFD
		mov	[esp+0C8h+Val],	ebx
		mov	[esp+0C8h+VarName], eax
		call	sub_421FFD
		mov	[ebp+var_24], eax
		jmp	short loc_4213BD
; ---------------------------------------------------------------------------

loc_4213A8:				; CODE XREF: sub_4210BA+2C1j
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax
		call	sub_421FFD
		mov	[ebp+var_24], eax

loc_4213BD:				; CODE XREF: sub_4210BA+2ECj
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+VarName], eax
		call	gcry_free
		mov	[ebp+var_C], 0
		jmp	short loc_4213FC
; ---------------------------------------------------------------------------

loc_4213D1:				; CODE XREF: sub_4210BA+34Ej
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		mov	edx, [ebp+var_24]
		mov	word ptr [edx],	2Fh
		mov	edx, [ebp+var_24]
		add	edx, 1
		mov	[esp+0C8h+Val],	eax
		mov	[esp+0C8h+VarName], edx
		call	sub_421FFD
		mov	[ebp+var_24], eax
		add	[ebp+var_C], 1

loc_4213FC:				; CODE XREF: sub_4210BA+315j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		test	eax, eax
		jnz	short loc_4213D1
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax	; char *
		call	sub_420AE0

loc_421415:				; CODE XREF: sub_4210BA+BEj
					; sub_4210BA+1CCj ...
		add	esp, 0C0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4210BA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42141F	proc near		; CODE XREF: sub_402D35+C3p
					; sub_4039ED+55p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], 1
		call	sub_4210BA
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_42141F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_4210BA
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42147F	proc near		; CODE XREF: .text:00425ADAp

C		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		jmp	short loc_4214F4
; ---------------------------------------------------------------------------

loc_421488:				; CODE XREF: sub_42147F+87j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4214EC
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+C], eax ; C
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+C], eax ; C
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_4214EC
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4214D8
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_4214EC

loc_4214D8:				; CODE XREF: sub_42147F+4Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_421508
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_421508

loc_4214EC:				; CODE XREF: sub_42147F+17j
					; sub_42147F+43j ...
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_4214F4:				; CODE XREF: sub_42147F+7j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_421508
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_421488

loc_421508:				; CODE XREF: sub_42147F+61j
					; sub_42147F+6Bj ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_42151C
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_421530

loc_42151C:				; CODE XREF: sub_42147F+91j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_421537
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_421537

loc_421530:				; CODE XREF: sub_42147F+9Bj
		mov	eax, 0
		jmp	short loc_421565
; ---------------------------------------------------------------------------

loc_421537:				; CODE XREF: sub_42147F+A5j
					; sub_42147F+AFj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+C], eax ; C
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+C], eax ; C
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx

loc_421565:				; CODE XREF: sub_42147F+B6j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_42147F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_421599
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_421599
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4215F0
; ---------------------------------------------------------------------------

loc_421599:				; CODE XREF: .text:00421579j
					; .text:00421583j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_4215C1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4215C1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4215F0
; ---------------------------------------------------------------------------

loc_4215C1:				; CODE XREF: .text:004215A1j
					; .text:004215ABj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_4215E9
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_4215E9
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4215F0
; ---------------------------------------------------------------------------

loc_4215E9:				; CODE XREF: .text:004215C9j
					; .text:004215D3j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_42166D
; ---------------------------------------------------------------------------

loc_4215F0:				; CODE XREF: .text:00421597j
					; .text:004215BFj ...
		add	dword ptr [ebp+8], 1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_421619
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_421619
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	[ebp-4], eax
		jmp	short loc_42166A
; ---------------------------------------------------------------------------

loc_421619:				; CODE XREF: .text:004215FCj
					; .text:00421606j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_42163E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_42163E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		add	[ebp-4], eax
		jmp	short loc_42166A
; ---------------------------------------------------------------------------

loc_42163E:				; CODE XREF: .text:00421621j
					; .text:0042162Bj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_421663
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_421663
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		add	[ebp-4], eax
		jmp	short loc_42166A
; ---------------------------------------------------------------------------

loc_421663:				; CODE XREF: .text:00421646j
					; .text:00421650j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_42166D
; ---------------------------------------------------------------------------

loc_42166A:				; CODE XREF: .text:00421617j
					; .text:0042163Cj ...
		mov	eax, [ebp-4]

locret_42166D:				; CODE XREF: .text:004215EEj
					; .text:00421668j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42166F(FILE *, int, int, int,	int)
sub_42166F	proc near		; CODE XREF: sub_421828+29p
					; .text:00421965p

var_28		= dword	ptr -28h
File		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_421819
; ---------------------------------------------------------------------------

loc_421687:				; CODE XREF: sub_42166F+1AEj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_4216D5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_4216D5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_C]
		jz	short loc_4216D5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_10]
		jz	short loc_4216D5
		cmp	[ebp+arg_C], 0
		jnz	short loc_4216C7
		cmp	[ebp+arg_10], 0
		jz	loc_4217F1

loc_4216C7:				; CODE XREF: sub_42166F+4Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_4217F1

loc_4216D5:				; CODE XREF: sub_42166F+20j
					; sub_42166F+2Aj ...
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 5Ch ;	Ch
		call	putc
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_421712
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 6Eh ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_42180D
; ---------------------------------------------------------------------------

loc_421712:				; CODE XREF: sub_42166F+85j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_421738
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 72h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_42180D
; ---------------------------------------------------------------------------

loc_421738:				; CODE XREF: sub_42166F+ABj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_42175E
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 66h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_42180D
; ---------------------------------------------------------------------------

loc_42175E:				; CODE XREF: sub_42166F+D1j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_421784
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 76h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_42180D
; ---------------------------------------------------------------------------

loc_421784:				; CODE XREF: sub_42166F+F7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_4217A7
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 62h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_42180D
; ---------------------------------------------------------------------------

loc_4217A7:				; CODE XREF: sub_42166F+11Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4217CA
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 30h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_42180D
; ---------------------------------------------------------------------------

loc_4217CA:				; CODE XREF: sub_42166F+140j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "x%02x"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+File],	eax ; Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	File
		call	fprintf
		add	[ebp+var_10], 3
		jmp	short loc_42180D
; ---------------------------------------------------------------------------

loc_4217F1:				; CODE XREF: sub_42166F+52j
					; sub_42166F+60j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	putc
		add	[ebp+var_10], 1

loc_42180D:				; CODE XREF: sub_42166F+9Ej
					; sub_42166F+C4j ...
		sub	[ebp+arg_8], 1
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_421819:				; CODE XREF: sub_42166F+13j
		cmp	[ebp+arg_8], 0
		jnz	loc_421687
		mov	eax, [ebp+var_10]
		leave
		retn
sub_42166F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_421828(FILE *, int, int, int)
sub_421828	proc near		; CODE XREF: .text:0040BC12p
					; sub_421858+B7p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_18], 0 ; int
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	FILE *
		call	sub_42166F
		leave
		retn
sub_421828	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_421858(FILE *, int, int, int)
sub_421858	proc near		; CODE XREF: sub_40BC19+21p
					; .text:00421A11p

Str		= dword	ptr -38h
File		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_421881
; ---------------------------------------------------------------------------

loc_42186E:				; CODE XREF: sub_421858+2Fj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_42188B
		add	[ebp+var_C], 1

loc_421881:				; CODE XREF: sub_421858+14j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jb	short loc_42186E
		jmp	short loc_42188C
; ---------------------------------------------------------------------------

loc_42188B:				; CODE XREF: sub_421858+23j
		nop

loc_42188C:				; CODE XREF: sub_421858+31j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jnb	short loc_4218F4
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+File],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax
		call	sub_4255BF
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Str], eax ; Str
		call	fputs
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	short loc_421914
; ---------------------------------------------------------------------------

loc_4218F4:				; CODE XREF: sub_421858+3Aj
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+File],	eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; FILE *
		call	sub_421828

loc_421914:				; CODE XREF: sub_421858+9Aj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_421858	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_42196C
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+14h]
		mov	[esp+10h], eax
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42166F
		jmp	short loc_421971
; ---------------------------------------------------------------------------

loc_42196C:				; CODE XREF: .text:00421925j
		mov	eax, 0

loc_421971:				; CODE XREF: .text:0042196Aj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_4219C2
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_421828
		jmp	short loc_4219C7
; ---------------------------------------------------------------------------

loc_4219C2:				; CODE XREF: .text:00421982j
		mov	eax, 0

loc_4219C7:				; CODE XREF: .text:004219C0j
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_421A18
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_421858
		jmp	short loc_421A1D
; ---------------------------------------------------------------------------

loc_421A18:				; CODE XREF: .text:004219D8j
		mov	eax, 0

loc_421A1D:				; CODE XREF: .text:00421A16j
		add	esp, 24h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_421A23	proc near		; CODE XREF: .text:0040BD32p

Dest		= dword	ptr -38h
Format		= dword	ptr -34h
var_30		= dword	ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_10], 1
		jmp	loc_421ACD
; ---------------------------------------------------------------------------

loc_421A47:				; CODE XREF: sub_421A23+AEj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_421A79
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_421A79
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_8]
		jz	short loc_421A79
		cmp	[ebp+arg_8], 0
		jz	short loc_421AC1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_421AC1

loc_421A79:				; CODE XREF: sub_421A23+2Cj
					; sub_421A23+36j ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_421AB5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_421AB5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jz	short loc_421AB5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jz	short loc_421AB5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jz	short loc_421AB5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_421ABB

loc_421AB5:				; CODE XREF: sub_421A23+5Ej
					; sub_421A23+68j ...
		add	[ebp+var_10], 2
		jmp	short loc_421AC5
; ---------------------------------------------------------------------------

loc_421ABB:				; CODE XREF: sub_421A23+90j
		add	[ebp+var_10], 5
		jmp	short loc_421AC5
; ---------------------------------------------------------------------------

loc_421AC1:				; CODE XREF: sub_421A23+4Aj
					; sub_421A23+54j
		add	[ebp+var_10], 1

loc_421AC5:				; CODE XREF: sub_421A23+96j
					; sub_421A23+9Cj
		sub	[ebp+arg_4], 1
		add	[ebp+var_C], 1

loc_421ACD:				; CODE XREF: sub_421A23+1Fj
		cmp	[ebp+arg_4], 0
		jnz	loc_421A47
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+arg_4], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_14], eax
		jmp	loc_421C0A
; ---------------------------------------------------------------------------

loc_421AFC:				; CODE XREF: sub_421A23+1EBj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_421B36
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_421B36
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_8]
		jz	short loc_421B36
		cmp	[ebp+arg_8], 0
		jz	loc_421BF1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_421BF1

loc_421B36:				; CODE XREF: sub_421A23+E1j
					; sub_421A23+EBj ...
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_421B59
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	6Eh
		add	[ebp+var_14], 1
		jmp	loc_421C02
; ---------------------------------------------------------------------------

loc_421B59:				; CODE XREF: sub_421A23+125j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_421B72
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	72h
		add	[ebp+var_14], 1
		jmp	loc_421C02
; ---------------------------------------------------------------------------

loc_421B72:				; CODE XREF: sub_421A23+13Ej
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_421B88
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	66h
		add	[ebp+var_14], 1
		jmp	short loc_421C02
; ---------------------------------------------------------------------------

loc_421B88:				; CODE XREF: sub_421A23+157j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_421B9E
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	76h
		add	[ebp+var_14], 1
		jmp	short loc_421C02
; ---------------------------------------------------------------------------

loc_421B9E:				; CODE XREF: sub_421A23+16Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_421BB4
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	62h
		add	[ebp+var_14], 1
		jmp	short loc_421C02
; ---------------------------------------------------------------------------

loc_421BB4:				; CODE XREF: sub_421A23+183j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_421BCA
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	30h
		add	[ebp+var_14], 1
		jmp	short loc_421C02
; ---------------------------------------------------------------------------

loc_421BCA:				; CODE XREF: sub_421A23+199j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "x%02x"
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Format], eax ;	Format
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_14], 3
		jmp	short loc_421C02
; ---------------------------------------------------------------------------

loc_421BF1:				; CODE XREF: sub_421A23+FFj
					; sub_421A23+10Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1

loc_421C02:				; CODE XREF: sub_421A23+131j
					; sub_421A23+14Aj ...
		sub	[ebp+arg_4], 1
		add	[ebp+var_C], 1

loc_421C0A:				; CODE XREF: sub_421A23+D4j
		cmp	[ebp+arg_4], 0
		jnz	loc_421AFC
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]
		leave
		retn
sub_421A23	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	dword ptr [ebp-4], 0
		jmp	short loc_421C4B
; ---------------------------------------------------------------------------

loc_421C2E:				; CODE XREF: .text:00421C53j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0C0h
		cmp	eax, 80h
		jz	short loc_421C47
		add	dword ptr [ebp-4], 1

loc_421C47:				; CODE XREF: .text:00421C41j
		add	dword ptr [ebp+8], 1

loc_421C4B:				; CODE XREF: .text:00421C2Cj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_421C2E
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_421C5A(DWORD)
sub_421C5A	proc near		; CODE XREF: sub_40C338+41p
					; sub_41B864+199p ...

dwFlags		= dword	ptr -28h
lpSource	= dword	ptr -24h
dwMessageId	= dword	ptr -20h
dwLanguageId	= dword	ptr -1Ch
lpBuffer	= dword	ptr -18h
nSize		= dword	ptr -14h
Arguments	= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jnz	short loc_421C70
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+arg_0], eax

loc_421C70:				; CODE XREF: sub_421C5A+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Arguments], 0 ; Arguments
		mov	[esp+28h+nSize], 0FFh ;	nSize
		mov	[esp+28h+lpBuffer], offset Buffer ; lpBuffer
		mov	[esp+28h+dwLanguageId],	400h ; dwLanguageId
		mov	[esp+28h+dwMessageId], eax ; dwMessageId
		mov	[esp+28h+lpSource], 0 ;	lpSource
		mov	[esp+28h+dwFlags], 1000h ; dwFlags
		mov	eax, ds:FormatMessageA
		call	eax ; FormatMessageA
		sub	esp, 1Ch
		mov	eax, offset Buffer
		leave
		retn
sub_421C5A	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 40h
		jle	short loc_421CCD
		cmp	dword ptr [ebp+8], 5Ah
		jg	short loc_421CCD
		mov	eax, 1
		jmp	short loc_421CD2
; ---------------------------------------------------------------------------

loc_421CCD:				; CODE XREF: .text:00421CBEj
					; .text:00421CC4j
		mov	eax, 0

loc_421CD2:				; CODE XREF: .text:00421CCBj
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 60h
		jle	short loc_421CEA
		cmp	dword ptr [ebp+8], 7Ah
		jg	short loc_421CEA
		mov	eax, 1
		jmp	short loc_421CEF
; ---------------------------------------------------------------------------

loc_421CEA:				; CODE XREF: .text:00421CDBj
					; .text:00421CE1j
		mov	eax, 0

loc_421CEF:				; CODE XREF: .text:00421CE8j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_421CF1	proc near		; CODE XREF: .text:00420C3Ep
					; .text:00420C51p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 60h
		jle	short loc_421D04
		cmp	[ebp+arg_0], 7Ah
		jg	short loc_421D04
		and	[ebp+arg_0], 0FFFFFFDFh

loc_421D04:				; CODE XREF: sub_421CF1+7j
					; sub_421CF1+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_421CF1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_421D09	proc near		; CODE XREF: .text:00421E0Ep
					; .text:00421E22p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 40h
		jle	short loc_421D1C
		cmp	[ebp+arg_0], 5Ah
		jg	short loc_421D1C
		or	[ebp+arg_0], 20h

loc_421D1C:				; CODE XREF: sub_421D09+7j
					; sub_421D09+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_421D09	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_421D21	proc near		; CODE XREF: sub_42488B+187p
					; sub_42488B+19Ep ...

var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_421D7C
		mov	eax, 0
		jmp	loc_421DD5
; ---------------------------------------------------------------------------

loc_421D3A:				; CODE XREF: sub_421D21+6Ej
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_421D72
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_421CF1
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_421CF1
		cmp	ebx, eax
		jnz	short loc_421D93

loc_421D72:				; CODE XREF: sub_421D21+27j
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1
		jmp	short loc_421D7D
; ---------------------------------------------------------------------------

loc_421D7C:				; CODE XREF: sub_421D21+Dj
		nop

loc_421D7D:				; CODE XREF: sub_421D21+59j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_421D94
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_421D3A
		jmp	short loc_421D94
; ---------------------------------------------------------------------------

loc_421D93:				; CODE XREF: sub_421D21+4Fj
		nop

loc_421D94:				; CODE XREF: sub_421D21+64j
					; sub_421D21+70j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_421DD0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_421CF1
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_421CF1
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_421DD5
; ---------------------------------------------------------------------------

loc_421DD0:				; CODE XREF: sub_421D21+81j
		mov	eax, 0

loc_421DD5:				; CODE XREF: sub_421D21+14j
					; sub_421D21+ADj
		add	esp, 4
		pop	ebx
		pop	ebp
		retn
sub_421D21	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-8], eax
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jz	short loc_421DFB
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_421E02

loc_421DFB:				; CODE XREF: .text:00421DF3j
		mov	eax, 0
		jmp	short locret_421E59
; ---------------------------------------------------------------------------

loc_421E02:				; CODE XREF: .text:00421DF9j
					; .text:00421E49j
		mov	eax, [ebp-4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_421D09
		mov	[ebp-9], al
		mov	eax, [ebp-8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_421D09
		mov	[ebp-0Ah], al
		sub	dword ptr [ebp+10h], 1
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_421E4B
		cmp	byte ptr [ebp-9], 0
		jz	short loc_421E4B
		add	dword ptr [ebp-4], 1
		add	dword ptr [ebp-8], 1
		movzx	eax, byte ptr [ebp-9]
		cmp	al, [ebp-0Ah]
		jz	short loc_421E02

loc_421E4B:				; CODE XREF: .text:00421E32j
					; .text:00421E38j
		movzx	edx, byte ptr [ebp-9]
		movzx	eax, byte ptr [ebp-0Ah]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_421E59:				; CODE XREF: .text:00421E00j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_421E5B	proc near		; CODE XREF: .text:00421FDCp
					; sub_42488B+14Ap

var_18		= dword	ptr -18h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_C]
		jnz	loc_421F0B
		mov	eax, 0
		jmp	loc_421F1A
; ---------------------------------------------------------------------------

loc_421E84:				; CODE XREF: sub_421E5B+B4j
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_421EFF
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_421CF1
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_421CF1
		cmp	ebx, eax
		jz	short loc_421EFF
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_421EF8
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_421CF1
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_421CF1
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_421EFD
; ---------------------------------------------------------------------------

loc_421EF8:				; CODE XREF: sub_421E5B+6Fj
		mov	eax, 0

loc_421EFD:				; CODE XREF: sub_421E5B+9Bj
		jmp	short loc_421F1A
; ---------------------------------------------------------------------------

loc_421EFF:				; CODE XREF: sub_421E5B+37j
					; sub_421E5B+5Fj
		sub	[ebp+arg_8], 1
		add	[ebp+var_8], 1
		add	[ebp+var_C], 1

loc_421F0B:				; CODE XREF: sub_421E5B+19j
		cmp	[ebp+arg_8], 0
		jnz	loc_421E84
		mov	eax, 0

loc_421F1A:				; CODE XREF: sub_421E5B+24j
					; sub_421E5B:loc_421EFDj
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_421E5B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		cmp	eax, [ebp+0Ch]
		jnz	short loc_421F4C
		mov	eax, 0
		jmp	short loc_421F93
; ---------------------------------------------------------------------------

loc_421F32:				; CODE XREF: .text:00421F5Fj
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jnz	short loc_421F63
		add	dword ptr [ebp+8], 1
		add	dword ptr [ebp+0Ch], 1
		jmp	short loc_421F4D
; ---------------------------------------------------------------------------

loc_421F4C:				; CODE XREF: .text:00421F29j
		nop

loc_421F4D:				; CODE XREF: .text:00421F4Aj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_421F64
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_421F32
		jmp	short loc_421F64
; ---------------------------------------------------------------------------

loc_421F63:				; CODE XREF: .text:00421F40j
		nop

loc_421F64:				; CODE XREF: .text:00421F55j
					; .text:00421F61j
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_421F8E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short loc_421F93
; ---------------------------------------------------------------------------

loc_421F8E:				; CODE XREF: .text:00421F72j
		mov	eax, 0

loc_421F93:				; CODE XREF: .text:00421F30j
					; .text:00421F8Cj
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		cmp	dword ptr [ebp+14h], 0
		jnz	short loc_421FA6
		mov	eax, [ebp+8]
		jmp	short locret_421FFB
; ---------------------------------------------------------------------------

loc_421FA6:				; CODE XREF: .text:00421F9Fj
		mov	eax, [ebp+14h]
		cmp	eax, [ebp+0Ch]
		ja	short loc_421FF6
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+14h]
		mov	edx, [ebp+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, [ebp-4]
		mov	[ebp-8], eax
		jmp	short loc_421FEE
; ---------------------------------------------------------------------------

loc_421FC8:				; CODE XREF: .text:00421FF4j
		mov	eax, [ebp+14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-4]
		mov	[esp], eax
		call	sub_421E5B
		test	eax, eax
		jnz	short loc_421FEA
		mov	eax, [ebp-4]
		jmp	short locret_421FFB
; ---------------------------------------------------------------------------

loc_421FEA:				; CODE XREF: .text:00421FE3j
		add	dword ptr [ebp-4], 1

loc_421FEE:				; CODE XREF: .text:00421FC6j
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jbe	short loc_421FC8

loc_421FF6:				; CODE XREF: .text:00421FACj
		mov	eax, 0

locret_421FFB:				; CODE XREF: .text:00421FA4j
					; .text:00421FE8j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_421FFD	proc near		; CODE XREF: sub_402D35+91p
					; .text:00406257p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		jmp	short loc_422015
; ---------------------------------------------------------------------------

loc_422002:				; CODE XREF: sub_421FFD+20j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_422015:				; CODE XREF: sub_421FFD+3j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_422002
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_421FFD	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_422048
		mov	eax, 0
		jmp	locret_4220F3
; ---------------------------------------------------------------------------

loc_422048:				; CODE XREF: .text:0042203Cj
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42205F
		mov	eax, [ebp+0Ch]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4220B8

loc_42205F:				; CODE XREF: .text:00422050j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		mov	[ebp-11h], al
		cmp	byte ptr [ebp-11h], 0
		jnz	short loc_422077
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_4220CD
; ---------------------------------------------------------------------------

loc_422077:				; CODE XREF: .text:0042206Cj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, [ebp-11h]
		jnz	short loc_42208A
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	short loc_4220CD
; ---------------------------------------------------------------------------

loc_42208A:				; CODE XREF: .text:00422080j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42209D
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_4220CD
; ---------------------------------------------------------------------------

loc_42209D:				; CODE XREF: .text:00422092j
		movsx	eax, byte ptr [ebp-11h]
		mov	edx, [ebp-10h]
		add	edx, 1
		mov	[esp+4], eax
		mov	[esp], edx
		call	strchr
		mov	[ebp-0Ch], eax
		jmp	short loc_4220CD
; ---------------------------------------------------------------------------

loc_4220B8:				; CODE XREF: .text:0042205Dj
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	strpbrk
		mov	[ebp-0Ch], eax

loc_4220CD:				; CODE XREF: .text:00422075j
					; .text:00422088j ...
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_4220E7
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp+8]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		jmp	short loc_4220F0
; ---------------------------------------------------------------------------

loc_4220E7:				; CODE XREF: .text:004220D1j
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0

loc_4220F0:				; CODE XREF: .text:004220E5j
		mov	eax, [ebp-10h]

locret_4220F3:				; CODE XREF: .text:00422043j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4220F5	proc near		; CODE XREF: sub_410A66+30p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_8]
		add	[ebp+var_4], eax
		jmp	short loc_422124
; ---------------------------------------------------------------------------

loc_422109:				; CODE XREF: sub_4220F5+33j
		sub	[ebp+var_4], 1
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_4]
		jnz	short loc_422120
		mov	eax, [ebp+var_4]
		jmp	short locret_42212F
; ---------------------------------------------------------------------------

loc_422120:				; CODE XREF: sub_4220F5+24j
		sub	[ebp+arg_8], 1

loc_422124:				; CODE XREF: sub_4220F5+12j
		cmp	[ebp+arg_8], 0
		jnz	short loc_422109
		mov	eax, 0

locret_42212F:				; CODE XREF: sub_4220F5+29j
		leave
		retn
sub_4220F5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_422131(int, char *, int)
sub_422131	proc near		; CODE XREF: .text:00422361p
					; .text:00422383p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_422147
		mov	eax, 0
		jmp	locret_422344
; ---------------------------------------------------------------------------

loc_422147:				; CODE XREF: sub_422131+Aj
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	short loc_42219D
; ---------------------------------------------------------------------------

loc_422156:				; CODE XREF: sub_422131+77j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_422195
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_422195
		cmp	[ebp+arg_4], 0
		jz	short loc_422199
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_422199

loc_422195:				; CODE XREF: sub_422131+30j
					; sub_422131+3Dj
		add	[ebp+var_10], 1

loc_422199:				; CODE XREF: sub_422131+43j
					; sub_422131+62j
		add	[ebp+var_C], 1

loc_42219D:				; CODE XREF: sub_422131+23j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_422156
		cmp	[ebp+arg_8], 0
		jz	short loc_4221C8
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+Str], eax
		call	gcry_xmalloc
		mov	[ebp+var_14], eax
		jmp	short loc_4221EE
; ---------------------------------------------------------------------------

loc_4221C8:				; CODE XREF: sub_422131+7Dj
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+Str], eax
		call	gcry_malloc
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4221EE
		mov	eax, 0
		jmp	locret_422344
; ---------------------------------------------------------------------------

loc_4221EE:				; CODE XREF: sub_422131+95j
					; sub_422131+B1j
		mov	[ebp+var_C], 0
		jmp	loc_42232A
; ---------------------------------------------------------------------------

loc_4221FA:				; CODE XREF: sub_422131+201j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_422230
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	33h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	61h
		add	[ebp+var_C], 1
		jmp	loc_422326
; ---------------------------------------------------------------------------

loc_422230:				; CODE XREF: sub_422131+D1j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_422266
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	32h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	35h
		add	[ebp+var_C], 1
		jmp	loc_422326
; ---------------------------------------------------------------------------

loc_422266:				; CODE XREF: sub_422131+107j
		cmp	[ebp+arg_4], 0
		jz	loc_422314
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	loc_422314
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		sar	al, 4
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_4222C7
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 30h
		jmp	short loc_4222D3
; ---------------------------------------------------------------------------

loc_4222C7:				; CODE XREF: sub_422131+186j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 57h

loc_4222D3:				; CODE XREF: sub_422131+194j
		mov	[edx], al
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_422300
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_42230C
; ---------------------------------------------------------------------------

loc_422300:				; CODE XREF: sub_422131+1BFj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 57h

loc_42230C:				; CODE XREF: sub_422131+1CDj
		mov	[edx], al
		add	[ebp+var_C], 1
		jmp	short loc_422326
; ---------------------------------------------------------------------------

loc_422314:				; CODE XREF: sub_422131+139j
					; sub_422131+159j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		movzx	edx, byte ptr [edx]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_422326:				; CODE XREF: sub_422131+FAj
					; sub_422131+130j ...
		add	[ebp+arg_0], 1

loc_42232A:				; CODE XREF: sub_422131+C4j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4221FA
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]

locret_422344:				; CODE XREF: sub_422131+11j
					; sub_422131+B8j
		leave
		retn
sub_422131	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_422131
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_422131
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42238A	proc near		; CODE XREF: .text:004224D9p
					; sub_4224E6+32p

var_F8		= dword	ptr -0F8h
var_F4		= dword	ptr -0F4h
var_DC		= dword	ptr -0DCh
var_D8		= dword	ptr -0D8h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 0F4h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		mov	[ebp+eax*4+var_D8], edx
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_DC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_DC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_422423
; ---------------------------------------------------------------------------

loc_4223D6:				; CODE XREF: sub_42238A+BAj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		mov	[ebp+var_DC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_DC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		cmp	[ebp+var_C], 2Eh
		jbe	short loc_42241F
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	short loc_42249E
; ---------------------------------------------------------------------------

loc_42241F:				; CODE XREF: sub_42238A+7Fj
		add	[ebp+var_C], 1

loc_422423:				; CODE XREF: sub_42238A+4Aj
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+4]
		mov	[ebp+arg_4], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_D8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		test	eax, eax
		jnz	short loc_4223D6
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[esp+0F8h+var_F8], eax
		call	gcry_malloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_42249B
		mov	eax, [ebp+var_18]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	short loc_42248D
; ---------------------------------------------------------------------------

loc_42246D:				; CODE XREF: sub_42238A+10Fj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		mov	[esp+0F8h+var_F4], eax
		mov	eax, [ebp+var_14]
		mov	[esp+0F8h+var_F8], eax
		call	sub_421FFD
		mov	[ebp+var_14], eax
		add	[ebp+var_C], 1

loc_42248D:				; CODE XREF: sub_42238A+E1j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		test	eax, eax
		jnz	short loc_42246D

loc_42249B:				; CODE XREF: sub_42238A+D2j
		mov	eax, [ebp+var_18]

loc_42249E:				; CODE XREF: sub_42238A+93j
		add	esp, 0F4h
		pop	edi
		pop	ebp
		retn
sub_42238A	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_4224C4
		mov	dword ptr [esp], offset	word_42E392
		call	gcry_strdup
		mov	[ebp-0Ch], eax
		jmp	short loc_4224E1
; ---------------------------------------------------------------------------

loc_4224C4:				; CODE XREF: .text:004224B1j
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42238A
		mov	[ebp-0Ch], eax

loc_4224E1:				; CODE XREF: .text:004224C2j
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4224E6	proc near		; CODE XREF: sub_40C06B+3Fp
					; sub_40C285+1Ep ...

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_422503
		mov	[esp+28h+Str], offset word_42E392
		call	gcry_xstrdup
		mov	[ebp+var_C], eax
		jmp	short loc_422520
; ---------------------------------------------------------------------------

loc_422503:				; CODE XREF: sub_4224E6+Aj
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Size],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_42238A
		mov	[ebp+var_C], eax

loc_422520:				; CODE XREF: sub_4224E6+1Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_422594
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_42255F
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aFatalTooManyAr ; "\nfatal:	too many args for xstrconcat\n"
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 25h ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		jmp	short loc_422588
; ---------------------------------------------------------------------------

loc_42255F:				; CODE XREF: sub_4224E6+4Cj
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aFatalOutOfMemo ; "\nfatal:	out of memory\n"
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 16h ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite

loc_422588:				; CODE XREF: sub_4224E6+77j
		mov	[esp+28h+Str], 2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_422594:				; CODE XREF: sub_4224E6+3Ej
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4224E6	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42259C	proc near		; CODE XREF: .text:00422B5Dp
					; sub_4234E9+1Cp

Code		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 8000h
		test	eax, eax
		jnz	short loc_422629
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+28h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+34h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, eax
		or	dh, 80h
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		test	eax, eax
		jns	short loc_422629
		mov	[esp+28h+Code],	offset aInvalidArgumen ; "invalid argument for arg_parsee\n"
		call	sub_42098D
; ---------------------------------------------------------------------------

loc_422629:				; CODE XREF: sub_42259C+13j
					; sub_42259C+7Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_4228DC
		cmp	dword ptr [ebp+arg_4], 0
		jz	loc_422761
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFAh
		jnz	short loc_422660
		mov	[esp+28h+Code],	offset aArgumentNotExp ; "argument not expected"
		call	sub_420034
		mov	dword ptr [ebp+var_C], eax
		jmp	loc_422739
; ---------------------------------------------------------------------------

loc_422660:				; CODE XREF: sub_42259C+AEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFBh
		jnz	short loc_42267F
		mov	[esp+28h+Code],	offset aReadError ; "read error"
		call	sub_420034
		mov	dword ptr [ebp+var_C], eax
		jmp	loc_422739
; ---------------------------------------------------------------------------

loc_42267F:				; CODE XREF: sub_42259C+CDj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFCh
		jnz	short loc_42269E
		mov	[esp+28h+Code],	offset aKeywordTooLong ; "keyword too long"
		call	sub_420034
		mov	dword ptr [ebp+var_C], eax
		jmp	loc_422739
; ---------------------------------------------------------------------------

loc_42269E:				; CODE XREF: sub_42259C+ECj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_4226BA
		mov	[esp+28h+Code],	offset aMissingArgumen ; "missing argument"
		call	sub_420034
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_422739
; ---------------------------------------------------------------------------

loc_4226BA:				; CODE XREF: sub_42259C+10Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF4h
		jnz	short loc_4226D6
		mov	[esp+28h+Code],	offset aInvalidArgum_0 ; "invalid argument"
		call	sub_420034
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_422739
; ---------------------------------------------------------------------------

loc_4226D6:				; CODE XREF: sub_42259C+127j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF9h
		jnz	short loc_4226F2
		mov	[esp+28h+Code],	offset aInvalidCommand ; "invalid command"
		call	sub_420034
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_422739
; ---------------------------------------------------------------------------

loc_4226F2:				; CODE XREF: sub_42259C+143j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF6h
		jnz	short loc_42270E
		mov	[esp+28h+Code],	offset aInvalidAliasDe ; "invalid alias	definition"
		call	sub_420034
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_422739
; ---------------------------------------------------------------------------

loc_42270E:				; CODE XREF: sub_42259C+15Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF5h
		jnz	short loc_42272A
		mov	[esp+28h+Code],	offset aOutOfCore ; "out of core"
		call	sub_420034
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_422739
; ---------------------------------------------------------------------------

loc_42272A:				; CODE XREF: sub_42259C+17Bj
		mov	[esp+28h+Code],	offset aInvalidOption ;	"invalid option"
		call	sub_420034
		mov	dword ptr [ebp+var_C], eax

loc_422739:				; CODE XREF: sub_42259C+BFj
					; sub_42259C+DEj ...
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	edx, dword ptr [ebp+var_C]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aSUS ; "%s:%u: %s\n"
		call	sub_42091D
		jmp	loc_4228BB
; ---------------------------------------------------------------------------

loc_422761:				; CODE XREF: sub_42259C+9Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_422773
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		jmp	short loc_422778
; ---------------------------------------------------------------------------

loc_422773:				; CODE XREF: sub_42259C+1CDj
		mov	eax, offset a??	; "[??]"

loc_422778:				; CODE XREF: sub_42259C+1D5j
		mov	dword ptr [ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_4227A6
		mov	[esp+28h+Code],	offset aMissingArgum_0 ; "missing argument for option \"%.50s\"\n"
		call	sub_420034
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_42091D
		jmp	loc_4228BB
; ---------------------------------------------------------------------------

loc_4227A6:				; CODE XREF: sub_42259C+1E8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF4h
		jnz	short loc_4227D1
		mov	[esp+28h+Code],	offset aInvalidArgum_1 ; "invalid argument for option \"%.50s\"\n"
		call	sub_420034
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_42091D
		jmp	loc_4228BB
; ---------------------------------------------------------------------------

loc_4227D1:				; CODE XREF: sub_42259C+213j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFAh
		jnz	short loc_4227FC
		mov	[esp+28h+Code],	offset aOption_50sDoes ; "option \"%.50s\" does	not expect an arg"...
		call	sub_420034
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_42091D
		jmp	loc_4228BB
; ---------------------------------------------------------------------------

loc_4227FC:				; CODE XREF: sub_42259C+23Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF9h
		jnz	short loc_422827
		mov	[esp+28h+Code],	offset aInvalidComma_0 ; "invalid command \"%.50s\"\n"
		call	sub_420034
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_42091D
		jmp	loc_4228BB
; ---------------------------------------------------------------------------

loc_422827:				; CODE XREF: sub_42259C+269j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF8h
		jnz	short loc_42284F
		mov	[esp+28h+Code],	offset aOption_50sIsAm ; "option \"%.50s\" is ambiguous\n"
		call	sub_420034
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_42091D
		jmp	short loc_4228BB
; ---------------------------------------------------------------------------

loc_42284F:				; CODE XREF: sub_42259C+294j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF8h
		jnz	short loc_422877
		mov	[esp+28h+Code],	offset aCommand_50sIsA ; "command \"%.50s\" is ambiguous\n"
		call	sub_420034
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_42091D
		jmp	short loc_4228BB
; ---------------------------------------------------------------------------

loc_422877:				; CODE XREF: sub_42259C+2BCj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF5h
		jnz	short loc_4228A0
		mov	[esp+28h+Code],	offset aOutOfCore_0 ; "out of core\n"
		call	sub_420034
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aS_0 ; "%s\n"
		call	sub_42091D
		jmp	short loc_4228BB
; ---------------------------------------------------------------------------

loc_4228A0:				; CODE XREF: sub_42259C+2E4j
		mov	[esp+28h+Code],	offset aInvalidOption_ ; "invalid option \"%.50s\"\n"
		call	sub_420034
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_42091D

loc_4228BB:				; CODE XREF: sub_42259C+1C0j
					; sub_42259C+205j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, 1
		jz	short loc_4228D2
		mov	[esp+28h+Code],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4228D2:				; CODE XREF: sub_42259C+328j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0

loc_4228DC:				; CODE XREF: sub_42259C+95j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		leave
		retn
sub_42259C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4228F2	proc near		; CODE XREF: .text:00422E48p
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_4228F2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4228F7(int, char *)
sub_4228F7	proc near		; CODE XREF: sub_42293D+11Cp
					; .text:00422C9Fp ...

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[ebp+var_C], eax
		jmp	short loc_422930
; ---------------------------------------------------------------------------

loc_422908:				; CODE XREF: sub_4228F7+3Dj
		mov	eax, [ebp+var_C]
		lea	edx, [eax+4]
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str2],	eax ; Str2
		mov	[esp+28h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_422928
		mov	eax, 1
		jmp	short locret_42293B
; ---------------------------------------------------------------------------

loc_422928:				; CODE XREF: sub_4228F7+28j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_422930:				; CODE XREF: sub_4228F7+Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_422908
		mov	eax, 0

locret_42293B:				; CODE XREF: sub_4228F7+2Fj
		leave
		retn
sub_4228F7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42293D(int, FILE *)
sub_42293D	proc near		; CODE XREF: .text:00423149p

File		= dword	ptr -98h
Source		= dword	ptr -94h
var_80		= byte ptr -80h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 98h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		jmp	loc_422AB9
; ---------------------------------------------------------------------------

loc_422960:				; CODE XREF: sub_42293D+180j
		mov	eax, [ebp+arg_4]
		mov	[esp+98h+File],	eax ; File
		call	getc
		mov	[ebp+C], eax
		cmp	[ebp+C], 0Ah
		jnz	short loc_42297D
		mov	[ebp+var_14], 1
		jmp	short loc_422991
; ---------------------------------------------------------------------------

loc_42297D:				; CODE XREF: sub_42293D+35j
		cmp	[ebp+C], 0FFFFFFFFh
		jnz	short loc_422991
		mov	[ebp+C], 0Ah
		mov	[ebp+var_14], 1

loc_422991:				; CODE XREF: sub_42293D+3Ej
					; sub_42293D+44j ...
		mov	eax, [ebp+var_18]
		cmp	eax, 1
		jz	short loc_4229DE
		cmp	eax, 1
		jb	short loc_4229B1
		cmp	eax, 2
		jz	short loc_422A22
		cmp	eax, 3
		jz	loc_422A43
		jmp	loc_422AB9
; ---------------------------------------------------------------------------

loc_4229B1:				; CODE XREF: sub_42293D+5Fj
		mov	eax, [ebp+C]
		cmp	eax, 7Fh
		ja	short loc_4229CE
		mov	eax, [ebp+C]
		mov	[esp+98h+File],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_422AB5

loc_4229CE:				; CODE XREF: sub_42293D+7Aj
		mov	[ebp+var_10], 0
		mov	[ebp+var_18], 1
		jmp	short loc_422991
; ---------------------------------------------------------------------------

loc_4229DE:				; CODE XREF: sub_42293D+5Aj
		mov	eax, [ebp+C]
		mov	[esp+98h+File],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_4229F8
		mov	[ebp+var_18], 3
		jmp	short loc_422991
; ---------------------------------------------------------------------------

loc_4229F8:				; CODE XREF: sub_42293D+B0j
		mov	eax, [ebp+var_10]
		cmp	eax, 62h
		ja	short loc_422A16
		mov	eax, [ebp+C]
		mov	edx, eax
		lea	eax, [ebp+var_80]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_422AB9
; ---------------------------------------------------------------------------

loc_422A16:				; CODE XREF: sub_42293D+C1j
		mov	[ebp+var_18], 2
		jmp	loc_422AB9
; ---------------------------------------------------------------------------

loc_422A22:				; CODE XREF: sub_42293D+64j
		mov	eax, [ebp+C]
		mov	[esp+98h+File],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	loc_422AB8
		mov	[ebp+var_18], 0
		jmp	loc_422991
; ---------------------------------------------------------------------------

loc_422A43:				; CODE XREF: sub_42293D+69j
		lea	eax, [ebp+var_80]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		lea	eax, [ebp+var_80]
		mov	[esp+98h+Source], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+File],	eax ; int
		call	sub_4228F7
		test	eax, eax
		jnz	short loc_422AA9
		mov	eax, [ebp+var_10]
		add	eax, 8
		mov	[esp+98h+File],	eax
		call	gcry_malloc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_422A80
		mov	eax, 1
		jmp	short locret_422AC8
; ---------------------------------------------------------------------------

loc_422A80:				; CODE XREF: sub_42293D+13Aj
		lea	eax, [ebp+var_80]
		mov	edx, [ebp+var_1C]
		add	edx, 4
		mov	[esp+98h+Source], eax ;	Source
		mov	[esp+98h+File],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+34h]
		mov	eax, [ebp+var_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_1C]
		mov	[eax+34h], edx

loc_422AA9:				; CODE XREF: sub_42293D+123j
		mov	[ebp+var_18], 0
		jmp	loc_422991
; ---------------------------------------------------------------------------

loc_422AB5:				; CODE XREF: sub_42293D+8Bj
		nop
		jmp	short loc_422AB9
; ---------------------------------------------------------------------------

loc_422AB8:				; CODE XREF: sub_42293D+F4j
		nop

loc_422AB9:				; CODE XREF: sub_42293D+1Ej
					; sub_42293D+6Fj ...
		cmp	[ebp+var_14], 0
		jz	loc_422960
		mov	eax, 0

locret_422AC8:				; CODE XREF: sub_42293D+141j
		leave
		retn
sub_42293D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_422ACA	proc near		; CODE XREF: .text:00422F90p

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[ebp+var_C], eax
		jmp	short loc_422AF4
; ---------------------------------------------------------------------------

loc_422ADB:				; CODE XREF: sub_422ACA+2Ej
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_422AF4:				; CODE XREF: sub_422ACA+Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_422ADB
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+34h], 0
		leave
		retn
sub_422ACA	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 0C4h
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-20h], 0
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_422B49
		mov	eax, [ebp+18h]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_4234E9
		jmp	loc_423388
; ---------------------------------------------------------------------------

loc_422B49:				; CODE XREF: .text:00422B30j
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_42259C
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	short loc_422B72
; ---------------------------------------------------------------------------

loc_422B71:				; CODE XREF: .text:00422FD9j
					; .text:0042301Ej ...
		nop

loc_422B72:				; CODE XREF: .text:00422B6Fj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	getc
		mov	[ebp-2Ch], eax
		cmp	dword ptr [ebp-2Ch], 0Ah
		jz	short loc_422B90
		cmp	dword ptr [ebp-2Ch], 0FFFFFFFFh
		jnz	loc_422FD5

loc_422B90:				; CODE XREF: .text:00422B84j
		cmp	dword ptr [ebp-2Ch], 0FFFFFFFFh
		jz	short loc_422BA3
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+10h]
		mov	[eax], edx

loc_422BA3:				; CODE XREF: .text:00422B94j
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	loc_42337E
		cmp	dword ptr [ebp-0Ch], 2
		jnz	loc_422D39
		lea	eax, [ebp-9Ch]
		add	eax, [ebp-10h]
		mov	byte ptr [eax],	0
		mov	dword ptr [ebp-10h], 0
		jmp	short loc_422C02
; ---------------------------------------------------------------------------

loc_422BCC:				; CODE XREF: .text:00422C0Fj
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_422BFE
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+4]
		lea	edx, [ebp-9Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcmp
		test	eax, eax
		jz	short loc_422C13

loc_422BFE:				; CODE XREF: .text:00422BDAj
		add	dword ptr [ebp-10h], 1

loc_422C02:				; CODE XREF: .text:00422BCAj
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_422BCC
		jmp	short loc_422C14
; ---------------------------------------------------------------------------

loc_422C13:				; CODE XREF: .text:00422BFCj
		nop

loc_422C14:				; CODE XREF: .text:00422C11j
		mov	eax, [ebp-10h]
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	edx, [eax]
		mov	eax, [ebp+14h]
		mov	[eax+10h], edx
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jz	short loc_422C50
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	loc_423379
; ---------------------------------------------------------------------------

loc_422C50:				; CODE XREF: .text:00422C3Cj
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_422CE6
		mov	dword ptr [esp+4], offset aIgnoreInvalidO ; "ignore-invalid-option"
		lea	eax, [ebp-9Ch]
		mov	[esp], eax
		call	strcmp
		test	eax, eax
		jnz	short loc_422C8F
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	loc_423379
; ---------------------------------------------------------------------------

loc_422C8F:				; CODE XREF: .text:00422C7Bj
		lea	eax, [ebp-9Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_4228F7
		test	eax, eax
		jz	short loc_422CBA
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	loc_423379
; ---------------------------------------------------------------------------

loc_422CBA:				; CODE XREF: .text:00422CA6j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 80h
		test	eax, eax
		jz	short loc_422CD6
		mov	eax, 0FFFFFFF9h
		jmp	short loc_422CDB
; ---------------------------------------------------------------------------

loc_422CD6:				; CODE XREF: .text:00422CCDj
		mov	eax, 0FFFFFFFEh

loc_422CDB:				; CODE XREF: .text:00422CD4j
		mov	edx, [ebp+14h]
		mov	[edx+10h], eax
		jmp	loc_423382
; ---------------------------------------------------------------------------

loc_422CE6:				; CODE XREF: .text:00422C5Dj
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_422D08
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+14h], 0
		jmp	loc_423382
; ---------------------------------------------------------------------------

loc_422D08:				; CODE XREF: .text:00422CF7j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_422D2A
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+14h], 0
		jmp	loc_423382
; ---------------------------------------------------------------------------

loc_422D2A:				; CODE XREF: .text:00422D19j
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_423382
; ---------------------------------------------------------------------------

loc_422D39:				; CODE XREF: .text:00422BB1j
		cmp	dword ptr [ebp-0Ch], 3
		jnz	short loc_422DA7
		cmp	dword ptr [ebp-20h], 0
		jz	short loc_422D54
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_423382
; ---------------------------------------------------------------------------

loc_422D54:				; CODE XREF: .text:00422D43j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_422D76
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+14h], 0
		jmp	loc_423382
; ---------------------------------------------------------------------------

loc_422D76:				; CODE XREF: .text:00422D65j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_422D98
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+14h], 0
		jmp	loc_423382
; ---------------------------------------------------------------------------

loc_422D98:				; CODE XREF: .text:00422D87j
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_423382
; ---------------------------------------------------------------------------

loc_422DA7:				; CODE XREF: .text:00422D3Dj
		cmp	dword ptr [ebp-0Ch], 4
		jnz	loc_422F84
		cmp	dword ptr [ebp-20h], 0
		jz	loc_422E52
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_422DD0
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFAh
		jmp	loc_422F7F
; ---------------------------------------------------------------------------

loc_422DD0:				; CODE XREF: .text:00422DBFj
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	byte ptr [eax],	0
		mov	dword ptr [esp+4], offset asc_42E5BF ; " \t"
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	strpbrk
		mov	[ebp-24h], eax
		cmp	dword ptr [ebp-24h], 0
		jz	short loc_422E0A
		mov	eax, [ebp-24h]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-24h], 1
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	sub_420D50

loc_422E0A:				; CODE XREF: .text:00422DF3j
		cmp	dword ptr [ebp-24h], 0
		jz	short loc_422E1A
		mov	eax, [ebp-24h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_422E34

loc_422E1A:				; CODE XREF: .text:00422E0Ej
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	gcry_free
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFF6h
		jmp	loc_423381
; ---------------------------------------------------------------------------

loc_422E34:				; CODE XREF: .text:00422E18j
		mov	eax, [ebp-24h]
		mov	[esp+8], eax
		mov	eax, [ebp-18h]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_4228F2
		jmp	loc_422F7F
; ---------------------------------------------------------------------------

loc_422E52:				; CODE XREF: .text:00422DB5j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_422E74
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFAh
		jmp	loc_423381
; ---------------------------------------------------------------------------

loc_422E74:				; CODE XREF: .text:00422E63j
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_422EA9
		lea	eax, [ebp-9Ch]
		add	eax, [ebp-10h]
		mov	byte ptr [eax],	0
		lea	eax, [ebp-9Ch]
		mov	[esp], eax
		call	gcry_strdup
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_422EB2
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	short loc_422EB2
; ---------------------------------------------------------------------------

loc_422EA9:				; CODE XREF: .text:00422E78j
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	byte ptr [eax],	0

loc_422EB2:				; CODE XREF: .text:00422E9Bj
					; .text:00422EA7j
		cmp	dword ptr [ebp-18h], 0
		jz	loc_423381
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_420D50
		mov	eax, [ebp-18h]
		mov	[ebp-28h], eax
		mov	eax, [ebp-28h]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_422F45
		add	dword ptr [ebp-28h], 1
		mov	eax, [ebp-28h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_422F45
		mov	eax, [ebp-28h]
		mov	dword ptr [ebp-0ACh], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0ACh]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp-28h]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_422F45
		mov	eax, [ebp-28h]
		mov	dword ptr [ebp-0ACh], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0ACh]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp-28h]
		mov	byte ptr [eax],	0

loc_422F45:				; CODE XREF: .text:00422ED5j
					; .text:00422EE3j ...
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		mov	edx, [ebp-28h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_423C9E
		test	eax, eax
		jnz	loc_423381
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	gcry_free
		jmp	loc_423381
; ---------------------------------------------------------------------------

loc_422F7F:				; CODE XREF: .text:00422DCBj
					; .text:00422E4Dj
		jmp	loc_423381
; ---------------------------------------------------------------------------

loc_422F84:				; CODE XREF: .text:00422DABj
		cmp	dword ptr [ebp-2Ch], 0FFFFFFFFh
		jnz	short loc_422FC2
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_422ACA
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	ferror
		test	eax, eax
		jz	short loc_422FB3
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFBh
		jmp	loc_423382
; ---------------------------------------------------------------------------

loc_422FB3:				; CODE XREF: .text:00422FA2j
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0
		jmp	loc_423382
; ---------------------------------------------------------------------------

loc_422FC2:				; CODE XREF: .text:00422F88j
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [ebp-10h], 0
		jmp	loc_423379
; ---------------------------------------------------------------------------

loc_422FD5:				; CODE XREF: .text:00422B8Aj
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	loc_422B71
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_423002
		mov	eax, [ebp-2Ch]
		cmp	eax, 7Fh
		ja	short loc_423002
		mov	eax, [ebp-2Ch]
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_423379

loc_423002:				; CODE XREF: .text:00422FE3j
					; .text:00422FEBj
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_42301A
		cmp	dword ptr [ebp-2Ch], 23h
		jnz	short loc_42301A
		mov	dword ptr [ebp-0Ch], 1
		jmp	loc_423379
; ---------------------------------------------------------------------------

loc_42301A:				; CODE XREF: .text:00423006j
					; .text:0042300Cj
		cmp	dword ptr [ebp-0Ch], 1
		jz	loc_422B71
		cmp	dword ptr [ebp-0Ch], 2
		jnz	loc_4231E4
		mov	eax, [ebp-2Ch]
		cmp	eax, 7Fh
		ja	loc_4231E4
		mov	eax, [ebp-2Ch]
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	loc_4231E4
		lea	eax, [ebp-9Ch]
		add	eax, [ebp-10h]
		mov	byte ptr [eax],	0
		mov	dword ptr [ebp-10h], 0
		jmp	short loc_42309A
; ---------------------------------------------------------------------------

loc_423064:				; CODE XREF: .text:004230A7j
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_423096
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+4]
		lea	edx, [ebp-9Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcmp
		test	eax, eax
		jz	short loc_4230AB

loc_423096:				; CODE XREF: .text:00423072j
		add	dword ptr [ebp-10h], 1

loc_42309A:				; CODE XREF: .text:00423062j
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_423064
		jmp	short loc_4230AC
; ---------------------------------------------------------------------------

loc_4230AB:				; CODE XREF: .text:00423094j
		nop

loc_4230AC:				; CODE XREF: .text:004230A9j
		mov	eax, [ebp-10h]
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	edx, [eax]
		mov	eax, [ebp+14h]
		mov	[eax+10h], edx
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jz	short loc_4230E2
		mov	dword ptr [ebp-0Ch], 1
		jmp	loc_423379
; ---------------------------------------------------------------------------

loc_4230E2:				; CODE XREF: .text:004230D4j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_4231D8
		mov	dword ptr [esp+4], offset aAlias ; "alias"
		lea	eax, [ebp-9Ch]
		mov	[esp], eax
		call	strcmp
		test	eax, eax
		jnz	short loc_423122
		mov	dword ptr [ebp-20h], 1
		mov	dword ptr [ebp-0Ch], 3
		jmp	loc_423379
; ---------------------------------------------------------------------------

loc_423122:				; CODE XREF: .text:0042310Dj
		mov	dword ptr [esp+4], offset aIgnoreInvalidO ; "ignore-invalid-option"
		lea	eax, [ebp-9Ch]
		mov	[esp], eax
		call	strcmp
		test	eax, eax
		jnz	short loc_423180
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_42293D
		test	eax, eax
		jz	short loc_423161
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	loc_423382
; ---------------------------------------------------------------------------

loc_423161:				; CODE XREF: .text:00423150j
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+10h]
		mov	[eax], edx
		jmp	loc_423379
; ---------------------------------------------------------------------------

loc_423180:				; CODE XREF: .text:0042313Aj
		lea	eax, [ebp-9Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_4228F7
		test	eax, eax
		jz	short loc_4231A5
		mov	dword ptr [ebp-0Ch], 1
		jmp	loc_423379
; ---------------------------------------------------------------------------

loc_4231A5:				; CODE XREF: .text:00423197j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 80h
		test	eax, eax
		jz	short loc_4231C1
		mov	eax, 0FFFFFFF9h
		jmp	short loc_4231C6
; ---------------------------------------------------------------------------

loc_4231C1:				; CODE XREF: .text:004231B8j
		mov	eax, 0FFFFFFFEh

loc_4231C6:				; CODE XREF: .text:004231BFj
		mov	edx, [ebp+14h]
		mov	[edx+10h], eax
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jmp	loc_423379
; ---------------------------------------------------------------------------

loc_4231D8:				; CODE XREF: .text:004230EFj
		mov	dword ptr [ebp-0Ch], 3
		jmp	loc_423379
; ---------------------------------------------------------------------------

loc_4231E4:				; CODE XREF: .text:00423028j
					; .text:00423034j ...
		cmp	dword ptr [ebp-0Ch], 3
		jnz	short loc_42322E
		mov	eax, [ebp-2Ch]
		cmp	eax, 7Fh
		ja	short loc_423207
		mov	eax, [ebp-2Ch]
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_422B71

loc_423207:				; CODE XREF: .text:004231F0j
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-2Ch]
		mov	edx, eax
		lea	eax, [ebp-9Ch]
		add	eax, [ebp-10h]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		mov	dword ptr [ebp-0Ch], 4
		jmp	loc_422B71
; ---------------------------------------------------------------------------

loc_42322E:				; CODE XREF: .text:004231E8j
		cmp	dword ptr [ebp-0Ch], 4
		jnz	loc_42333B
		cmp	dword ptr [ebp-18h], 0
		jz	short loc_4232BD
		mov	eax, [ebp-10h]
		mov	edx, [ebp-1Ch]
		sub	edx, 1
		cmp	eax, edx
		jnb	short loc_42325F
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	edx, [ebp-2Ch]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		jmp	loc_422B71
; ---------------------------------------------------------------------------

loc_42325F:				; CODE XREF: .text:00423249j
		mov	eax, [ebp-1Ch]
		add	eax, 32h
		mov	[ebp-30h], eax
		mov	eax, [ebp-30h]
		mov	[esp+4], eax
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	gcry_realloc
		mov	[ebp-34h], eax
		cmp	dword ptr [ebp-34h], 0
		jz	short loc_4232A3
		mov	eax, [ebp-30h]
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-34h]
		mov	[ebp-18h], eax
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	edx, [ebp-2Ch]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		jmp	loc_422B71
; ---------------------------------------------------------------------------

loc_4232A3:				; CODE XREF: .text:00423281j
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	gcry_free
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	loc_423382
; ---------------------------------------------------------------------------

loc_4232BD:				; CODE XREF: .text:0042323Cj
		mov	eax, [ebp-10h]
		cmp	eax, 62h
		ja	short loc_4232DE
		mov	eax, [ebp-2Ch]
		mov	edx, eax
		lea	eax, [ebp-9Ch]
		add	eax, [ebp-10h]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		jmp	loc_422B71
; ---------------------------------------------------------------------------

loc_4232DE:				; CODE XREF: .text:004232C3j
		mov	dword ptr [ebp-38h], 96h
		mov	eax, [ebp-38h]
		mov	[esp], eax
		call	gcry_malloc
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jz	short loc_42332F
		mov	eax, [ebp-38h]
		mov	[ebp-1Ch], eax
		mov	ecx, [ebp-10h]
		lea	edx, [ebp-9Ch]
		mov	eax, [ebp-18h]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	edx, [ebp-2Ch]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		jmp	loc_422B71
; ---------------------------------------------------------------------------

loc_42332F:				; CODE XREF: .text:004232F7j
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	short loc_423382
; ---------------------------------------------------------------------------

loc_42333B:				; CODE XREF: .text:00423232j
		mov	eax, [ebp-10h]
		cmp	eax, 62h
		jbe	short loc_423359
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFCh
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jmp	loc_422B71
; ---------------------------------------------------------------------------

loc_423359:				; CODE XREF: .text:00423341j
		mov	eax, [ebp-2Ch]
		mov	edx, eax
		lea	eax, [ebp-9Ch]
		add	eax, [ebp-10h]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		mov	dword ptr [ebp-0Ch], 2
		jmp	loc_422B71
; ---------------------------------------------------------------------------

loc_423379:				; CODE XREF: .text:00422C4Bj
					; .text:00422C8Aj ...
		jmp	loc_422B71
; ---------------------------------------------------------------------------

loc_42337E:				; CODE XREF: .text:00422BA7j
		nop
		jmp	short loc_423382
; ---------------------------------------------------------------------------

loc_423381:				; CODE XREF: .text:00422E2Fj
					; .text:00422E6Fj ...
		nop

loc_423382:				; CODE XREF: .text:00422CE1j
					; .text:00422D03j ...
		mov	eax, [ebp+14h]
		mov	eax, [eax+10h]

loc_423388:				; CODE XREF: .text:00422B44j
		add	esp, 0C4h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_423391(int, int, char	*)
sub_423391	proc near		; CODE XREF: sub_4234E9+182p

Str1		= dword	ptr -38h
Str2		= dword	ptr -34h
MaxCount	= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4233AC
		mov	eax, 0FFFFFFFFh
		jmp	loc_4234E3
; ---------------------------------------------------------------------------

loc_4233AC:				; CODE XREF: sub_423391+Fj
		mov	[ebp+var_C], 0
		jmp	short loc_4233F0
; ---------------------------------------------------------------------------

loc_4233B5:				; CODE XREF: sub_423391+6Cj
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_4233EC
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4233EC
		mov	eax, [ebp+var_C]
		jmp	loc_4234E3
; ---------------------------------------------------------------------------

loc_4233EC:				; CODE XREF: sub_423391+32j
					; sub_423391+51j
		add	[ebp+var_C], 1

loc_4233F0:				; CODE XREF: sub_423391+22j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4233B5
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	loc_4234CB
; ---------------------------------------------------------------------------

loc_42342D:				; CODE XREF: sub_423391+147j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	loc_4234C7
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[esp+38h+MaxCount], edx	; MaxCount
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_4234C7
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_4234B3
; ---------------------------------------------------------------------------

loc_423472:				; CODE XREF: sub_423391+12Fj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_4234AF
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[esp+38h+MaxCount], edx	; MaxCount
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_4234AF
		mov	eax, 0FFFFFFFEh
		jmp	short loc_4234E3
; ---------------------------------------------------------------------------

loc_4234AF:				; CODE XREF: sub_423391+EFj
					; sub_423391+115j
		add	[ebp+var_10], 1

loc_4234B3:				; CODE XREF: sub_423391+DFj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_423472
		mov	eax, [ebp+var_C]
		jmp	short loc_4234E3
; ---------------------------------------------------------------------------

loc_4234C7:				; CODE XREF: sub_423391+AAj
					; sub_423391+D4j
		add	[ebp+var_C], 1

loc_4234CB:				; CODE XREF: sub_423391+97j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_42342D
		mov	eax, 0FFFFFFFFh

loc_4234E3:				; CODE XREF: sub_423391+16j
					; sub_423391+56j ...
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_423391	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4234E9	proc near		; CODE XREF: sub_4032E3+329p
					; .text:00422B3Fp

Str		= dword	ptr -38h
Val		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+Count], 0
		mov	[esp+38h+Val], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_42259C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_42354D
		cmp	[ebp+var_10], 0
		jz	short loc_42354D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 10h
		test	eax, eax
		jnz	short loc_42354D
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1

loc_42354D:				; CODE XREF: sub_4234E9+43j
					; sub_4234E9+49j ...
		cmp	[ebp+var_10], 0
		jnz	short loc_423562
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		jmp	loc_423C78
; ---------------------------------------------------------------------------

loc_423562:				; CODE XREF: sub_4234E9+68j
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+28h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_4235B8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 2
		test	eax, eax
		jz	short loc_4235B8
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_423C78
; ---------------------------------------------------------------------------

loc_4235B8:				; CODE XREF: sub_4234E9+92j
					; sub_4234E9+9Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_4235D1
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		jmp	loc_423C78
; ---------------------------------------------------------------------------

loc_4235D1:				; CODE XREF: sub_4234E9+D7j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	loc_423953
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	loc_423953
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+var_18]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42362F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jnz	short loc_42362F
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 1
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_42354D
; ---------------------------------------------------------------------------

loc_42362F:				; CODE XREF: sub_4234E9+11Cj
					; sub_4234E9+129j
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], 3Dh ; Val
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jz	short loc_423654
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	0

loc_423654:				; CODE XREF: sub_4234E9+163j
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Count], eax ; char *
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_423391
		mov	[ebp+var_20], eax
		cmp	[ebp+var_28], 0
		jz	short loc_42367F
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	3Dh

loc_42367F:				; CODE XREF: sub_4234E9+18Ej
		cmp	[ebp+var_20], 0
		jns	short loc_4236B9
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset Str1 ; "help"
		call	strcmp
		test	eax, eax
		jnz	short loc_4236B9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax
		call	sub_423ED4
; ---------------------------------------------------------------------------
		jmp	loc_4237F4
; ---------------------------------------------------------------------------

loc_4236B9:				; CODE XREF: sub_4234E9+19Aj
					; sub_4234E9+1B4j
		cmp	[ebp+var_20], 0
		jns	short loc_4236FB
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aVersion ; "version"
		call	strcmp
		test	eax, eax
		jnz	short loc_4236FB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jnz	loc_4237F4
		call	sub_42443F
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4236FB:				; CODE XREF: sub_4234E9+1D4j
					; sub_4234E9+1EEj
		cmp	[ebp+var_20], 0
		jns	short loc_42373B
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aWarranty	; "warranty"
		call	strcmp
		test	eax, eax
		jnz	short loc_42373B
		mov	[esp+38h+Str], 10h
		call	sub_4246F5
		mov	[esp+38h+Str], eax ; Str
		call	puts
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_42373B:				; CODE XREF: sub_4234E9+216j
					; sub_4234E9+230j
		cmp	[ebp+var_20], 0
		jns	loc_4237F4
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aDumpOptions ; "dump-options"
		call	strcmp
		test	eax, eax
		jnz	loc_4237F4
		mov	[ebp+var_20], 0
		jmp	short loc_4237B0
; ---------------------------------------------------------------------------

loc_42376C:				; CODE XREF: sub_4234E9+2D4j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_4237AC
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jnz	short loc_4237AC
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, offset aS_1 ; "--%s\n"
		mov	[esp+38h+Val], edx
		mov	[esp+38h+Str], eax ; Format
		call	printf

loc_4237AC:				; CODE XREF: sub_4234E9+291j
					; sub_4234E9+2A4j
		add	[ebp+var_20], 1

loc_4237B0:				; CODE XREF: sub_4234E9+281j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_42376C
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aDumpOptionsHel ; "--dump-options\n--help\n--version\n--wa"...
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 2Bh ; Count
		mov	[esp+38h+Val], 1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4237F4:				; CODE XREF: sub_4234E9+1CBj
					; sub_4234E9+1FBj ...
		cmp	[ebp+var_20], 0FFFFFFFEh
		jnz	short loc_423806
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF8h
		jmp	short loc_423835
; ---------------------------------------------------------------------------

loc_423806:				; CODE XREF: sub_4234E9+30Fj
		cmp	[ebp+var_20], 0FFFFFFFFh
		jnz	short loc_423824
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFEh
		mov	eax, [ebp+var_18]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_0]
		mov	[eax+18h], edx
		jmp	short loc_423835
; ---------------------------------------------------------------------------

loc_423824:				; CODE XREF: sub_4234E9+321j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx

loc_423835:				; CODE XREF: sub_4234E9+31Bj
					; sub_4234E9+339j
		cmp	[ebp+var_20], 0
		js	loc_423942
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jz	loc_423923
		cmp	[ebp+var_28], 0
		jz	short loc_423878
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_423881
		mov	[ebp+var_1C], 0
		jmp	short loc_423881
; ---------------------------------------------------------------------------

loc_423878:				; CODE XREF: sub_4234E9+371j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], eax

loc_423881:				; CODE XREF: sub_4234E9+384j
					; sub_4234E9+38Dj
		cmp	[ebp+var_1C], 0
		jnz	short loc_4238A9
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_4238A9
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	loc_423942
; ---------------------------------------------------------------------------

loc_4238A9:				; CODE XREF: sub_4234E9+39Cj
					; sub_4234E9+3AFj
		cmp	[ebp+var_1C], 0
		jnz	short loc_4238BE
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_423941
; ---------------------------------------------------------------------------

loc_4238BE:				; CODE XREF: sub_4234E9+3C4j
		cmp	[ebp+var_28], 0
		jnz	short loc_4238ED
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_4238ED
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_4238ED
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_423942
; ---------------------------------------------------------------------------

loc_4238ED:				; CODE XREF: sub_4234E9+3D9j
					; sub_4234E9+3E3j ...
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_423C9E
		cmp	[ebp+var_28], 0
		jnz	short loc_423941
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_423941
; ---------------------------------------------------------------------------

loc_423923:				; CODE XREF: sub_4234E9+367j
		cmp	[ebp+var_28], 0
		jz	short loc_423935
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0FFFFFFFAh
		jmp	short loc_423942
; ---------------------------------------------------------------------------

loc_423935:				; CODE XREF: sub_4234E9+43Ej
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_423942
; ---------------------------------------------------------------------------

loc_423941:				; CODE XREF: sub_4234E9+3D0j
					; sub_4234E9+42Aj ...
		nop

loc_423942:				; CODE XREF: sub_4234E9+350j
					; sub_4234E9+3BBj ...
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_423C78
; ---------------------------------------------------------------------------

loc_423953:				; CODE XREF: sub_4234E9+F0j
					; sub_4234E9+101j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_42396A
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_423978

loc_42396A:				; CODE XREF: sub_4234E9+472j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	loc_423C30

loc_423978:				; CODE XREF: sub_4234E9+47Fj
		mov	[ebp+var_24], 0
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_423A03
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 20h
		test	eax, eax
		jz	short loc_423A03
		mov	[ebp+var_20], 0
		jmp	short loc_4239F4
; ---------------------------------------------------------------------------

loc_4239B5:				; CODE XREF: sub_4234E9+518j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_4239F0
		mov	eax, [ebp+var_18]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	[esp+38h+Val], edx ; Str2
		mov	[esp+38h+Str], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4239F0
		mov	[ebp+var_24], 1
		jmp	short loc_423A03
; ---------------------------------------------------------------------------

loc_4239F0:				; CODE XREF: sub_4234E9+4DAj
					; sub_4234E9+4FCj
		add	[ebp+var_20], 1

loc_4239F4:				; CODE XREF: sub_4234E9+4CAj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4239B5

loc_423A03:				; CODE XREF: sub_4234E9+4A5j
					; sub_4234E9+4C1j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		add	[ebp+var_18], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_423A49
		mov	[ebp+var_20], 0
		jmp	short loc_423A37
; ---------------------------------------------------------------------------

loc_423A1B:				; CODE XREF: sub_4234E9+55Bj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	edx, eax
		jz	short loc_423A48
		add	[ebp+var_20], 1

loc_423A37:				; CODE XREF: sub_4234E9+530j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_423A1B
		jmp	short loc_423A49
; ---------------------------------------------------------------------------

loc_423A48:				; CODE XREF: sub_4234E9+548j
		nop

loc_423A49:				; CODE XREF: sub_4234E9+527j
					; sub_4234E9+55Dj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_423A81
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 68h
		jz	short loc_423A6C
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Fh
		jnz	short loc_423A81

loc_423A6C:				; CODE XREF: sub_4234E9+577j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax
		call	sub_423ED4
; ---------------------------------------------------------------------------

loc_423A81:				; CODE XREF: sub_4234E9+56Dj
					; sub_4234E9+581j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_423AE5
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 80h
		test	eax, eax
		jz	short loc_423ABD
		mov	eax, 0FFFFFFF9h
		jmp	short loc_423AC2
; ---------------------------------------------------------------------------

loc_423ABD:				; CODE XREF: sub_4234E9+5CBj
		mov	eax, 0FFFFFFFEh

loc_423AC2:				; CODE XREF: sub_4234E9+5D2j
		mov	edx, [ebp+arg_0]
		mov	[edx+10h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		jmp	loc_423C05
; ---------------------------------------------------------------------------

loc_423AE5:				; CODE XREF: sub_4234E9+5B6j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jz	loc_423BEC
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_423B3F
		cmp	[ebp+var_24], 0
		jnz	short loc_423B3F
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_423C9E
		jmp	loc_423BE3
; ---------------------------------------------------------------------------

loc_423B3F:				; CODE XREF: sub_4234E9+61Ej
					; sub_4234E9+624j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_423B6D
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_423B6D
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_423BE3
; ---------------------------------------------------------------------------

loc_423B6D:				; CODE XREF: sub_4234E9+663j
					; sub_4234E9+676j
		cmp	[ebp+var_1C], 0
		jnz	short loc_423B7F
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	short loc_423BE3
; ---------------------------------------------------------------------------

loc_423B7F:				; CODE XREF: sub_4234E9+688j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_423BB5
		mov	eax, [ebp+var_1C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_423BB5
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_423BB5
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_423BE3
; ---------------------------------------------------------------------------

loc_423BB5:				; CODE XREF: sub_4234E9+69Ej
					; sub_4234E9+6ABj ...
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_423C9E
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1

loc_423BE3:				; CODE XREF: sub_4234E9+651j
					; sub_4234E9+682j ...
		mov	[ebp+var_18], offset asc_42E620	; "x"
		jmp	short loc_423C05
; ---------------------------------------------------------------------------

loc_423BEC:				; CODE XREF: sub_4234E9+60Dj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx

loc_423C05:				; CODE XREF: sub_4234E9+5F7j
					; sub_4234E9+701j
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_423C18
		cmp	[ebp+var_24], 0
		jz	short loc_423C77

loc_423C18:				; CODE XREF: sub_4234E9+727j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_423C77
; ---------------------------------------------------------------------------

loc_423C30:				; CODE XREF: sub_4234E9+489j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 4
		test	eax, eax
		jz	short loc_423C68
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_423C78
; ---------------------------------------------------------------------------

loc_423C68:				; CODE XREF: sub_4234E9+752j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 1
		jmp	loc_42354D
; ---------------------------------------------------------------------------

loc_423C77:				; CODE XREF: sub_4234E9+72Dj
					; sub_4234E9+745j
		nop

loc_423C78:				; CODE XREF: sub_4234E9+74j
					; sub_4234E9+CAj ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		leave
		retn
sub_4234E9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_423C9E(int, int, char	*)
sub_423C9E	proc near		; CODE XREF: .text:00422F62p
					; sub_4234E9+421p ...

Str		= dword	ptr -28h
EndPtr		= dword	ptr -24h
Radix		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_423CB5
		mov	eax, 0
		jmp	short loc_423CBA
; ---------------------------------------------------------------------------

loc_423CB5:				; CODE XREF: sub_423C9E+Ej
		mov	eax, 0Ah

loc_423CBA:				; CODE XREF: sub_423C9E+15j
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		and	edx, 7
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jz	short loc_423CE8
		cmp	eax, 4
		jz	loc_423D75
		cmp	eax, 1
		jnz	loc_423E1A

loc_423CE8:				; CODE XREF: sub_423C9E+36j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtol
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 80000000h
		jz	short loc_423D24
		cmp	[ebp+var_10], 7FFFFFFFh
		jnz	short loc_423D46

loc_423D24:				; CODE XREF: sub_423C9E+7Bj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 22h
		jnz	short loc_423D46
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF4h
		mov	eax, 0FFFFFFFFh
		jmp	locret_423E28
; ---------------------------------------------------------------------------

loc_423D46:				; CODE XREF: sub_423C9E+84j
					; sub_423C9E+92j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jnz	short loc_423D5C
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+18h], edx
		jmp	short loc_423D65
; ---------------------------------------------------------------------------

loc_423D5C:				; CODE XREF: sub_423C9E+B1j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+18h], edx

loc_423D65:				; CODE XREF: sub_423C9E+BCj
		mov	eax, 0
		jmp	locret_423E28
; ---------------------------------------------------------------------------

loc_423D6F:				; CODE XREF: sub_423C9E+F7j
		add	[ebp+arg_8], 1
		jmp	short loc_423D76
; ---------------------------------------------------------------------------

loc_423D75:				; CODE XREF: sub_423C9E+3Bj
		nop

loc_423D76:				; CODE XREF: sub_423C9E+D5j
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_423D97
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Str], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_423D6F

loc_423D97:				; CODE XREF: sub_423C9E+E0j
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_423DBC
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF4h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_423E28
; ---------------------------------------------------------------------------

loc_423DBC:				; CODE XREF: sub_423C9E+101j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtoul
		mov	edx, [ebp+arg_0]
		mov	[edx+18h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_423E13
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 22h
		jnz	short loc_423E13
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF4h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_423E28
; ---------------------------------------------------------------------------

loc_423E13:				; CODE XREF: sub_423C9E+154j
					; sub_423C9E+162j
		mov	eax, 0
		jmp	short locret_423E28
; ---------------------------------------------------------------------------

loc_423E1A:				; CODE XREF: sub_423C9E+44j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[eax+18h], edx
		mov	eax, 1

locret_423E28:				; CODE XREF: sub_423C9E+A3j
					; sub_423C9E+CCj ...
		leave
		retn
sub_423C9E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_423E2A	proc near		; CODE XREF: sub_423ED4+8Ep

var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_423ECB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_423ECB
		call	sub_424B97
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_423EB6
		add	[ebp+var_C], 1
		jmp	short loc_423EB6
; ---------------------------------------------------------------------------

loc_423E91:				; CODE XREF: sub_423E2A+9Fj
		cmp	[ebp+var_14], 0
		jz	short loc_423EB0
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0C0h
		cmp	eax, 80h
		jz	short loc_423EB0
		add	[ebp+var_C], 1

loc_423EB0:				; CODE XREF: sub_423E2A+6Bj
					; sub_423E2A+80j
		add	[ebp+var_10], 1
		jmp	short loc_423EB7
; ---------------------------------------------------------------------------

loc_423EB6:				; CODE XREF: sub_423E2A+5Fj
					; sub_423E2A+65j
		nop

loc_423EB7:				; CODE XREF: sub_423E2A+8Aj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_423ECB
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_423E91

loc_423ECB:				; CODE XREF: sub_423E2A+34j
					; sub_423E2A+41j ...
		mov	eax, [ebp+var_C]
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
sub_423E2A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_423ED4	proc near		; CODE XREF: sub_4234E9+1C6p
					; sub_4234E9+593p

Str		= dword	ptr -38h
Size		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		call	sub_42443F
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[esp+38h+Str], 29h
		call	sub_4246F5
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	puts
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_42433C
		mov	[ebp+var_18], 0
		mov	eax, [ebp+var_18]
		mov	[ebp+var_10], eax
		jmp	short loc_423F82
; ---------------------------------------------------------------------------

loc_423F23:				; CODE XREF: sub_423ED4+BBj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_423F7E
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_423F56
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jz	short loc_423F7E

loc_423F56:				; CODE XREF: sub_423ED4+6Dj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_423E2A
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jle	short loc_423F7E
		cmp	[ebp+var_14], 22h
		jg	short loc_423F7E
		mov	eax, [ebp+var_14]
		mov	[ebp+var_18], eax

loc_423F7E:				; CODE XREF: sub_423ED4+5Dj
					; sub_423ED4+80j ...
		add	[ebp+var_10], 1

loc_423F82:				; CODE XREF: sub_423ED4+4Dj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_423F23
		add	[ebp+var_18], 0Ah
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jz	short loc_423FAE
		mov	[esp+38h+Str], offset aOptions ; "Options:"
		call	puts

loc_423FAE:				; CODE XREF: sub_423ED4+CCj
		mov	[ebp+var_10], 0
		jmp	loc_424313
; ---------------------------------------------------------------------------

loc_423FBA:				; CODE XREF: sub_423ED4+44Cj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+38h+Str], eax ; char *
		call	sub_420034
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_423FF2
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jnz	short loc_423FF2
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_42430E

loc_423FF2:				; CODE XREF: sub_423ED4+101j
					; sub_423ED4+10Bj
		cmp	[ebp+var_C], 0
		jz	short loc_42405D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jnz	short loc_42405D
		add	[ebp+var_C], 1
		jmp	short loc_424042
; ---------------------------------------------------------------------------

loc_424008:				; CODE XREF: sub_423ED4+176j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_42402D
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42403E
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	short loc_42403E
; ---------------------------------------------------------------------------

loc_42402D:				; CODE XREF: sub_423ED4+13Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar

loc_42403E:				; CODE XREF: sub_423ED4+149j
					; sub_423ED4+157j
		add	[ebp+var_C], 1

loc_424042:				; CODE XREF: sub_423ED4+132j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_424008
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	loc_42430F
; ---------------------------------------------------------------------------

loc_42405D:				; CODE XREF: sub_423ED4+122j
					; sub_423ED4+12Cj
		mov	[ebp+var_14], 3
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 0FFh
		jg	loc_424111
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, offset aC_0 ; " -%c"
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Str], eax ; Format
		call	printf
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_42413A
		cmp	[ebp+var_C], 0
		jz	loc_42413A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_42413A
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1
		jmp	short loc_4240ED
; ---------------------------------------------------------------------------

loc_4240D4:				; CODE XREF: sub_423ED4+22Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1

loc_4240ED:				; CODE XREF: sub_423ED4+1FEj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_424101
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_4240D4

loc_424101:				; CODE XREF: sub_423ED4+221j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42413A
		add	[ebp+var_C], 1
		jmp	short loc_42413A
; ---------------------------------------------------------------------------

loc_424111:				; CODE XREF: sub_423ED4+1A0j
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset asc_42E630 ; "   "
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 3 ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite

loc_42413A:				; CODE XREF: sub_423ED4+1D0j
					; sub_423ED4+1DAj ...
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	loc_42423D
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 0FFh
		jg	short loc_424173
		mov	eax, 2Ch
		jmp	short loc_424178
; ---------------------------------------------------------------------------

loc_424173:				; CODE XREF: sub_423ED4+296j
		mov	eax, 20h

loc_424178:				; CODE XREF: sub_423ED4+29Dj
		mov	edx, offset aCS	; "%c --%s"
		mov	[esp+38h+Count], ecx
		mov	[esp+38h+Size],	eax
		mov	[esp+38h+Str], edx ; Format
		call	printf
		add	[ebp+var_14], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4241FE
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_4241FE
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_4241DB
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1
		jmp	short loc_4241DB
; ---------------------------------------------------------------------------

loc_4241C0:				; CODE XREF: sub_423ED4+31Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1
		jmp	short loc_4241DC
; ---------------------------------------------------------------------------

loc_4241DB:				; CODE XREF: sub_423ED4+2D8j
					; sub_423ED4+2EAj
		nop

loc_4241DC:				; CODE XREF: sub_423ED4+305j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4241F0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_4241C0

loc_4241F0:				; CODE XREF: sub_423ED4+310j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4241FE
		add	[ebp+var_C], 1

loc_4241FE:				; CODE XREF: sub_423ED4+2C0j
					; sub_423ED4+2CAj ...
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset asc_42E630 ; "   "
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 3 ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		add	[ebp+var_14], 3
		jmp	short loc_42423D
; ---------------------------------------------------------------------------

loc_42422D:				; CODE XREF: sub_423ED4+36Fj
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_42423D:				; CODE XREF: sub_423ED4+274j
					; sub_423ED4+357j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_42422D
		cmp	[ebp+var_C], 0
		jz	loc_424300
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_4242F5
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jle	loc_4242F5
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[ebp+var_14], 0
		jmp	short loc_42428E
; ---------------------------------------------------------------------------

loc_42427E:				; CODE XREF: sub_423ED4+3C0j
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_42428E:				; CODE XREF: sub_423ED4+3A8j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_42427E
		jmp	short loc_4242F5
; ---------------------------------------------------------------------------

loc_424298:				; CODE XREF: sub_423ED4+42Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_4242DE
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4242EF
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[ebp+var_14], 0
		jmp	short loc_4242D4
; ---------------------------------------------------------------------------

loc_4242C4:				; CODE XREF: sub_423ED4+406j
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_4242D4:				; CODE XREF: sub_423ED4+3EEj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_4242C4
		jmp	short loc_4242EF
; ---------------------------------------------------------------------------

loc_4242DE:				; CODE XREF: sub_423ED4+3CCj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar

loc_4242EF:				; CODE XREF: sub_423ED4+3D9j
					; sub_423ED4+408j
		add	[ebp+var_C], 1
		jmp	short loc_4242F6
; ---------------------------------------------------------------------------

loc_4242F5:				; CODE XREF: sub_423ED4+383j
					; sub_423ED4+38Fj ...
		nop

loc_4242F6:				; CODE XREF: sub_423ED4+41Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_424298

loc_424300:				; CODE XREF: sub_423ED4+375j
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	short loc_42430F
; ---------------------------------------------------------------------------

loc_42430E:				; CODE XREF: sub_423ED4+118j
		nop

loc_42430F:				; CODE XREF: sub_423ED4+184j
					; sub_423ED4+438j
		add	[ebp+var_10], 1

loc_424313:				; CODE XREF: sub_423ED4+E1j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_423FBA
		mov	eax, [ebp+arg_4]
		and	eax, 20h
		test	eax, eax
		jz	short loc_42433C
		mov	[esp+38h+Str], offset aASingleDashMay ;	"\n(A single dash may be used instead of"...
		call	puts

loc_42433C:				; CODE XREF: sub_423ED4+3Aj
					; sub_423ED4+45Aj
		mov	[esp+38h+Str], 13h
		call	sub_4246F5
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_424423
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[esp+38h+Size],	offset SubStr ;	"@EMAIL@"
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	strstr
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_42440C
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		cmp	edx, eax
		jz	short loc_4243BC
		mov	eax, ds:_iob
		lea	ecx, [eax+20h]
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+File],	ecx ; File
		mov	[esp+38h+Count], 1 ; Count
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite

loc_4243BC:				; CODE XREF: sub_423ED4+4B5j
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aHttpBugs_gnupg ; "http://bugs.gnupg.org"
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 15h ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		add	[ebp+var_1C], 7
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_424423
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Size],	edx ; File
		mov	[esp+38h+Str], eax ; Str
		call	fputs
		jmp	short loc_424423
; ---------------------------------------------------------------------------

loc_42440C:				; CODE XREF: sub_423ED4+4A7j
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+38h+Size],	eax ; File
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	fputs

loc_424423:				; CODE XREF: sub_423ED4+47Bj
					; sub_423ED4+51Dj ...
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+38h+Str], eax ; File
		call	fflush
		mov	[esp+38h+Str], 0 ; Code
		call	exit
sub_423ED4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42443F	proc near		; CODE XREF: sub_4234E9+201p
					; sub_423ED4+7p

Str		= dword	ptr -28h
File		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, ds:_iob
		lea	ebx, [eax+20h]
		mov	[esp+28h+Str], 0Bh
		call	sub_4246F5
		mov	[esp+28h+File],	ebx ; File
		mov	[esp+28h+Str], eax ; Str
		call	fputs
		mov	[esp+28h+Str], 0Ch
		call	sub_4246F5
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_42448F
		mov	eax, offset aS_2 ; " (%s)"
		mov	edx, [ebp+var_10]
		mov	[esp+28h+File],	edx
		mov	[esp+28h+Str], eax ; Format
		call	printf

loc_42448F:				; CODE XREF: sub_42443F+3Aj
		mov	[esp+28h+Str], 0Dh
		call	sub_4246F5
		mov	edx, offset aSS	; " %s %s\n"
		mov	[esp+28h+var_20], offset aGpg4win2_3_1 ; "(Gpg4win 2.3.1)"
		mov	[esp+28h+File],	eax
		mov	[esp+28h+Str], edx ; Format
		call	printf
		mov	[ebp+var_C], 14h
		jmp	short loc_4244E0
; ---------------------------------------------------------------------------

loc_4244BD:				; CODE XREF: sub_42443F+A5j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_4246F5
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4244DC
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_4244DC:				; CODE XREF: sub_42443F+90j
		add	[ebp+var_C], 1

loc_4244E0:				; CODE XREF: sub_42443F+7Cj
		cmp	[ebp+var_C], 1Dh
		jle	short loc_4244BD
		mov	[esp+28h+Str], 0Eh
		call	sub_4246F5
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_424506
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_424506:				; CODE XREF: sub_42443F+BAj
		mov	[esp+28h+Str], 0Ah
		call	sub_4246F5
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_424526
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_424526:				; CODE XREF: sub_42443F+DAj
		mov	[esp+28h+Str], 0Fh
		call	sub_4246F5
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_424552
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_424552:				; CODE XREF: sub_42443F+FAj
		mov	[esp+28h+Str], 12h
		call	sub_4246F5
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_42457E
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_42457E:				; CODE XREF: sub_42443F+126j
		mov	[ebp+var_C], 1Eh
		jmp	short loc_4245B6
; ---------------------------------------------------------------------------

loc_424587:				; CODE XREF: sub_42443F+17Bj
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_4246F5
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4245B2
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_4245B2:				; CODE XREF: sub_42443F+15Aj
		add	[ebp+var_C], 1

loc_4245B6:				; CODE XREF: sub_42443F+146j
		cmp	[ebp+var_C], 27h
		jle	short loc_424587
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+Str], eax ; File
		call	fflush
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_42443F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4245D2	proc near		; CODE XREF: sub_4032E3+37Cp

File		= dword	ptr -58h
Format		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= dword	ptr -2Ch
Str		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		cmp	[ebp+arg_0], 0
		jnz	short loc_424644
		mov	[esp+58h+File],	0Eh
		call	sub_4246F5
		mov	esi, eax
		mov	[esp+58h+File],	0Dh
		call	sub_4246F5
		mov	ebx, eax
		mov	[esp+58h+File],	0Bh
		call	sub_4246F5
		mov	edx, offset aSSS ; "%s %s; %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+58h+var_48], esi
		mov	[esp+58h+var_4C], ebx
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+Format], edx ;	Format
		mov	[esp+58h+File],	ecx ; File
		call	fprintf
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+58h+File],	eax ; File
		call	fflush
		jmp	loc_4246ED
; ---------------------------------------------------------------------------

loc_424644:				; CODE XREF: sub_4245D2+Dj
		cmp	[ebp+arg_0], 1
		jnz	short loc_4246C7
		mov	[esp+58h+File],	28h
		call	sub_4246F5
		mov	[ebp+Str], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+58h+Format], eax ;	File
		mov	eax, [ebp+Str]
		mov	[esp+58h+File],	eax ; Str
		call	fputs
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4246BB
		mov	eax, [ebp+Str]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_4246BB
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+58h+Format], eax ;	File
		mov	[esp+58h+File],	0Ah ; Ch
		call	putc

loc_4246BB:				; CODE XREF: sub_4245D2+A6j
					; sub_4245D2+CFj
		mov	[esp+58h+File],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4246C7:				; CODE XREF: sub_4245D2+76j
		cmp	[ebp+arg_0], 2
		jnz	short loc_4246ED
		mov	[esp+58h+File],	29h
		call	sub_4246F5
		mov	[esp+58h+File],	eax ; Str
		call	puts
		mov	[esp+58h+File],	0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4246ED:				; CODE XREF: sub_4245D2+6Dj
					; sub_4245D2+F9j
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4245D2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4246F5	proc near		; CODE XREF: sub_4234E9+239p
					; sub_423ED4+1Fp ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_4304E0
		test	eax, eax
		jz	short loc_424714
		mov	edx, ds:dword_4304E0
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx ; dword_4304E0
		jmp	short loc_424719
; ---------------------------------------------------------------------------

loc_424714:				; CODE XREF: sub_4246F5+Dj
		mov	eax, 0

loc_424719:				; CODE XREF: sub_4246F5+1Dj
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_424727
		mov	eax, [ebp+var_C]
		jmp	short locret_42477C
; ---------------------------------------------------------------------------

loc_424727:				; CODE XREF: sub_4246F5+2Bj
		mov	eax, [ebp+arg_0]
		sub	eax, 0Ah	; switch 32 cases
		cmp	eax, 1Fh
		ja	short loc_424779 ; jumptable 00424739 default case
		mov	eax, ds:off_42EA1C[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_42473B:				; CODE XREF: sub_4246F5+44j
					; DATA XREF: .rdata:off_42EA1Co
		mov	[ebp+var_C], offset aLicenseGplv3Gn ; jumptable	00424739 case 10
		jmp	short loc_424779 ; jumptable 00424739 default case
; ---------------------------------------------------------------------------

loc_424744:				; CODE XREF: sub_4246F5+44j
					; DATA XREF: .rdata:off_42EA1Co
		mov	[ebp+var_C], offset aFoo ; jumptable 00424739 case 11
		jmp	short loc_424779 ; jumptable 00424739 default case
; ---------------------------------------------------------------------------

loc_42474D:				; CODE XREF: sub_4246F5+44j
					; DATA XREF: .rdata:off_42EA1Co
		mov	[ebp+var_C], offset a0_0 ; jumptable 00424739 case 13
		jmp	short loc_424779 ; jumptable 00424739 default case
; ---------------------------------------------------------------------------

loc_424756:				; CODE XREF: sub_4246F5+44j
					; DATA XREF: .rdata:off_42EA1Co
		mov	[ebp+var_C], offset aCopyrightC2015 ; jumptable	00424739 case 14
		jmp	short loc_424779 ; jumptable 00424739 default case
; ---------------------------------------------------------------------------

loc_42475F:				; CODE XREF: sub_4246F5+44j
					; DATA XREF: .rdata:off_42EA1Co
		mov	[ebp+var_C], offset aThisIsFreeSoft ; jumptable	00424739 case 15
		jmp	short loc_424779 ; jumptable 00424739 default case
; ---------------------------------------------------------------------------

loc_424768:				; CODE XREF: sub_4246F5+44j
					; DATA XREF: .rdata:off_42EA1Co
		mov	[ebp+var_C], offset aThisIsFreeSo_0 ; jumptable	00424739 case 16
		jmp	short loc_424779 ; jumptable 00424739 default case
; ---------------------------------------------------------------------------

loc_424771:				; CODE XREF: sub_4246F5+44j
					; DATA XREF: .rdata:off_42EA1Co
		mov	[ebp+var_C], offset dword_42EA18 ; jumptable 00424739 cases 40,41
		nop

loc_424779:				; CODE XREF: sub_4246F5+3Bj
					; sub_4246F5+44j ...
		mov	eax, [ebp+var_C] ; jumptable 00424739 default case

locret_42477C:				; CODE XREF: sub_4246F5+30j
		leave
		retn
sub_4246F5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42477E	proc near		; CODE XREF: sub_4032E3+1Ep

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ds:dword_4304E0, eax
		pop	ebp
		retn
sub_42477E	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42478C	proc near		; CODE XREF: sub_42488B+27Bp
					; sub_42488B+2C4p ...

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_424821
		cmp	[ebp+arg_0], 0
		jz	short loc_4247E5
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aUtf8_0 ; "utf-8"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4247E5
		mov	eax, ds:dword_430514
		mov	[ebp+var_1C], eax
		mov	ds:dword_430514, 1
		jmp	short loc_4247F7
; ---------------------------------------------------------------------------

loc_4247E5:				; CODE XREF: sub_42478C+1Bj
					; sub_42478C+43j
		mov	eax, ds:dword_430518
		mov	[ebp+var_1C], eax
		mov	ds:dword_430518, 1

loc_4247F7:				; CODE XREF: sub_42478C+57j
		cmp	[ebp+var_1C], 0
		jnz	short loc_42485F
		mov	[esp+38h+var_38], offset aConversionFrom ; "conversion from `%s' to `%s' not availa"...
		call	sub_420034
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+var_30], edx
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], edx	; char
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_4208F3
		jmp	short loc_42485F
; ---------------------------------------------------------------------------

loc_424821:				; CODE XREF: sub_42478C+15j
		mov	eax, ds:dword_43051C
		test	eax, eax
		jnz	short loc_424855
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+38h+var_38], eax ;	int
		call	strerror
		mov	ebx, eax
		mov	[esp+38h+var_38], offset aIconv_openFail ; "iconv_open failed: %s\n"
		call	sub_420034
		mov	dword ptr [esp+38h+var_34], ebx	; char
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_4208F3

loc_424855:				; CODE XREF: sub_42478C+9Cj
		mov	ds:dword_43051C, 1

loc_42485F:				; CODE XREF: sub_42478C+6Fj
					; sub_42478C+93j
		cmp	[ebp+arg_8], 0
		jz	short loc_424883
		mov	off_4292F4, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_4304E4, 0
		mov	ds:dword_4304E8, 0

loc_424883:				; CODE XREF: sub_42478C+D7j
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_42478C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42488B	proc near		; CODE XREF: sub_40B9A4+10p

Dest		= dword	ptr -38h
Format		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Str2		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	[ebp+arg_0], 0
		jnz	loc_424995
		mov	eax, ds:GetConsoleOutputCP
		call	eax ; GetConsoleOutputCP
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4248B6
		mov	eax, ds:GetACP
		call	eax ; GetACP
		mov	[ebp+var_C], eax

loc_4248B6:				; CODE XREF: sub_42488B+1Fj
		mov	eax, offset aCpU ; "CP%u"
		mov	edx, [ebp+var_C]
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Format], eax ;	Format
		mov	[esp+38h+Dest],	offset byte_4304F4 ; Dest
		call	sprintf
		mov	[ebp+arg_0], offset byte_4304F4
		mov	[ebp+Str2], offset aCp936 ; "CP936"
		jmp	loc_424987
; ---------------------------------------------------------------------------

loc_4248E5:				; CODE XREF: sub_42488B+104j
		mov	eax, [ebp+Str2]
		mov	[esp+38h+Format], eax ;	Str2
		mov	[esp+38h+Dest],	offset byte_4304F4 ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_424913
		mov	eax, [ebp+Str2]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	short loc_42493D
		mov	eax, [ebp+Str2]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42493D

loc_424913:				; CODE XREF: sub_42488B+6Fj
		mov	eax, [ebp+Str2]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	eax, [ebp+Str2]
		mov	[ebp+arg_0], eax
		jmp	short loc_424995
; ---------------------------------------------------------------------------

loc_42493D:				; CODE XREF: sub_42488B+79j
					; sub_42488B+86j
		mov	eax, [ebp+Str2]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp+Str2], eax
		mov	eax, [ebp+Str2]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp+Str2], eax

loc_424987:				; CODE XREF: sub_42488B+55j
		mov	eax, [ebp+Str2]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4248E5

loc_424995:				; CODE XREF: sub_42488B+Bj
					; sub_42488B+B0j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 3
		jbe	short loc_4249FA
		mov	[esp+38h+var_30], 3
		mov	[esp+38h+Format], offset aIso ;	"iso"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_421E5B
		test	eax, eax
		jnz	short loc_4249FA
		add	[ebp+arg_0], 3
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jz	short loc_4249F6
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Fh
		jnz	short loc_4249FA

loc_4249F6:				; CODE XREF: sub_42488B+15Fj
		add	[ebp+arg_0], 1

loc_4249FA:				; CODE XREF: sub_42488B+132j
					; sub_42488B+151j ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_424A60
		mov	[esp+38h+Format], offset a88591	; "8859-1"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_421D21
		test	eax, eax
		jz	short loc_424A60
		mov	[esp+38h+Format], offset a646 ;	"646"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_421D21
		test	eax, eax
		jz	short loc_424A60
		mov	[esp+38h+Format], offset aAscii	; "ASCII"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_421D21
		test	eax, eax
		jz	short loc_424A60
		mov	[esp+38h+Format], offset aAnsi_x3_41968	; "ANSI_X3.4-1968"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_421D21
		test	eax, eax
		jnz	short loc_424A83

loc_424A60:				; CODE XREF: sub_42488B+177j
					; sub_42488B+18Ej ...
		mov	off_4292F4, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_4304E4, 0
		mov	ds:dword_4304E8, 0
		jmp	loc_424B82
; ---------------------------------------------------------------------------

loc_424A83:				; CODE XREF: sub_42488B+1D3j
		mov	[esp+38h+Format], offset aUtf8_1 ; "utf8"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_421D21
		test	eax, eax
		jz	short loc_424AB1
		mov	[esp+38h+Format], offset aUtf8_0 ; "utf-8"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_421D21
		test	eax, eax
		jnz	short loc_424AD4

loc_424AB1:				; CODE XREF: sub_42488B+20Dj
		mov	off_4292F4, offset aUtf8_0 ; "utf-8"
		mov	ds:dword_4304E4, 1
		mov	ds:dword_4304E8, 0
		jmp	loc_424B82
; ---------------------------------------------------------------------------

loc_424AD4:				; CODE XREF: sub_42488B+224j
		mov	[esp+38h+Format], offset aUtf8_0 ; "utf-8"
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Dest],	eax
		call	libiconv_open
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_424B12
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+Format], offset aUtf8_0 ; "utf-8"
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Dest],	eax
		call	sub_42478C
		mov	eax, 0FFFFFFFFh
		jmp	short loc_424B87
; ---------------------------------------------------------------------------

loc_424B12:				; CODE XREF: sub_42488B+263j
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dest],	eax
		call	libiconv_close
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Format], eax
		mov	[esp+38h+Dest],	offset aUtf8_0 ; "utf-8"
		call	libiconv_open
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_424B5B
		mov	[esp+38h+var_30], 0
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Format], eax
		mov	[esp+38h+Dest],	offset aUtf8_0 ; "utf-8"
		call	sub_42478C
		mov	eax, 0FFFFFFFFh
		jmp	short loc_424B87
; ---------------------------------------------------------------------------

loc_424B5B:				; CODE XREF: sub_42488B+2ACj
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dest],	eax
		call	libiconv_close
		mov	eax, [ebp+var_14]
		mov	off_4292F4, eax
		mov	ds:dword_4304E4, 0
		mov	ds:dword_4304E8, 1

loc_424B82:				; CODE XREF: sub_42488B+1F3j
					; sub_42488B+244j
		mov	eax, 0

loc_424B87:				; CODE XREF: sub_42488B+285j
					; sub_42488B+2CEj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_42488B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, off_4292F4
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_424B97	proc near		; CODE XREF: sub_423E2A+43p
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_4304E4
		pop	ebp
		retn
sub_424B97	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_424BA1	proc near		; CODE XREF: sub_424BA1+129p

Dest		= dword	ptr -78h
Source		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_4C		= dword	ptr -4Ch
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_28], 0
		mov	eax, ds:dword_4304E4
		test	eax, eax
		jz	short loc_424BD3
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Dest],	eax
		call	gcry_xstrdup
		mov	[ebp+var_20], eax
		jmp	loc_424DE2
; ---------------------------------------------------------------------------

loc_424BD3:				; CODE XREF: sub_424BA1+1Dj
		mov	eax, ds:dword_4304E8
		test	eax, eax
		jnz	loc_424C89
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_424BFE
; ---------------------------------------------------------------------------

loc_424BE8:				; CODE XREF: sub_424BA1+65j
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_424BFA
		add	[ebp+var_28], 1

loc_424BFA:				; CODE XREF: sub_424BA1+53j
		add	[ebp+var_1C], 1

loc_424BFE:				; CODE XREF: sub_424BA1+45j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_424BE8
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[esp+78h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_424C74
; ---------------------------------------------------------------------------

loc_424C27:				; CODE XREF: sub_424BA1+DBj
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_424C61
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		shr	al, 6
		or	eax, 0FFFFFFC0h
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		and	eax, 3Fh
		or	eax, 0FFFFFF80h
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_424C70
; ---------------------------------------------------------------------------

loc_424C61:				; CODE XREF: sub_424BA1+8Ej
		mov	eax, [ebp+var_1C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_424C70:				; CODE XREF: sub_424BA1+BEj
		add	[ebp+var_1C], 1

loc_424C74:				; CODE XREF: sub_424BA1+84j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_424C27
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		jmp	loc_424DE2
; ---------------------------------------------------------------------------

loc_424C89:				; CODE XREF: sub_424BA1+39j
		mov	eax, off_4292F4
		mov	[esp+78h+Source], eax
		mov	[esp+78h+Dest],	offset aUtf8_0 ; "utf-8"
		call	libiconv_open
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0FFFFFFFFh
		jnz	short loc_424CD4
		mov	eax, off_4292F4
		mov	[esp+78h+var_70], 1
		mov	[esp+78h+Source], eax
		mov	[esp+78h+Dest],	offset aUtf8_0 ; "utf-8"
		call	sub_42478C
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Dest],	eax
		call	sub_424BA1
		jmp	loc_424DE5
; ---------------------------------------------------------------------------

loc_424CD4:				; CODE XREF: sub_424BA1+104j
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_424CF2
; ---------------------------------------------------------------------------

loc_424CDC:				; CODE XREF: sub_424BA1+159j
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_424CEE
		add	[ebp+var_28], 5

loc_424CEE:				; CODE XREF: sub_424BA1+147j
		add	[ebp+var_1C], 1

loc_424CF2:				; CODE XREF: sub_424BA1+139j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_424CDC
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[esp+78h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_40], eax
		lea	eax, [ebp+var_40]
		mov	[esp+78h+var_68], eax
		lea	eax, [ebp+var_38]
		mov	[esp+78h+var_6C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+78h+var_70], eax
		lea	eax, [ebp+var_34]
		mov	[esp+78h+Source], eax
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Dest],	eax
		call	libiconv
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_424DD1
		mov	eax, ds:dword_4304F0
		test	eax, eax
		jnz	short loc_424DB3
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+78h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	esi, off_4292F4
		mov	[esp+78h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_420034
		mov	[esp+78h+var_6C], ebx
		mov	[esp+78h+var_70], offset aUtf8_0 ; "utf-8"
		mov	[esp+78h+Source], esi ;	char
		mov	[esp+78h+Dest],	eax ; char *
		call	sub_4208F3

loc_424DB3:				; CODE XREF: sub_424BA1+1D3j
		mov	ds:dword_4304F0, 1
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Source], eax ;	Source
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Dest],	eax ; Dest
		call	strcpy
		jmp	short loc_424DD7
; ---------------------------------------------------------------------------

loc_424DD1:				; CODE XREF: sub_424BA1+1CAj
		mov	eax, [ebp+var_38]
		mov	byte ptr [eax],	0

loc_424DD7:				; CODE XREF: sub_424BA1+22Ej
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Dest],	eax
		call	libiconv_close

loc_424DE2:				; CODE XREF: sub_424BA1+2Dj
					; sub_424BA1+E3j
		mov	eax, [ebp+var_20]

loc_424DE5:				; CODE XREF: sub_424BA1+12Ej
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_424BA1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_424DED	proc near		; CODE XREF: sub_424DED+797p
					; sub_4255BF+23p

Dest		= dword	ptr -88h
Format		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		add	esp, 0FFFFFF80h
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 0
		mov	[ebp+var_30], 0

loc_424E11:				; CODE XREF: sub_424DED+5EDj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_14]
		mov	[ebp+var_C], eax
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		jmp	loc_4253B3
; ---------------------------------------------------------------------------

loc_424E36:				; CODE XREF: sub_424DED+5CAj
		cmp	[ebp+var_30], 0
		jz	short loc_424E95
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_424E8E
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	short loc_424E5A
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FDh
		jbe	short loc_424E8E

loc_424E5A:				; CODE XREF: sub_424DED+61j
		cmp	[ebp+var_24], 0
		jz	short loc_424E85
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_424E85:				; CODE XREF: sub_424DED+71j
		add	[ebp+var_1C], 4
		jmp	loc_4253AB
; ---------------------------------------------------------------------------

loc_424E8E:				; CODE XREF: sub_424DED+57j
					; sub_424DED+6Bj
		mov	[ebp+var_30], 0

loc_424E95:				; CODE XREF: sub_424DED+4Dj
		cmp	[ebp+var_C], 0
		jnz	loc_4251C8
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	loc_425020
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jz	loc_425000
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_424EF1
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_424EF1
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_8]
		jz	short loc_424EF1
		cmp	[ebp+arg_8], 0
		jz	loc_425000
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_425000

loc_424EF1:				; CODE XREF: sub_424DED+D2j
					; sub_424DED+DCj ...
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_424F05
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_24], 1

loc_424F05:				; CODE XREF: sub_424DED+10Cj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, 0Dh	; switch 14 cases
		ja	loc_424FB6	; jumptable 00424F1E default case
		mov	eax, ds:off_42EC94[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_424F20:				; CODE XREF: sub_424DED+131j
					; DATA XREF: .rdata:off_42EC94o
		add	[ebp+var_1C], 1	; jumptable 00424F1E case 10
		cmp	[ebp+var_24], 0
		jz	loc_424FE7
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	6Eh
		add	[ebp+var_24], 1
		jmp	loc_424FE7
; ---------------------------------------------------------------------------

loc_424F3D:				; CODE XREF: sub_424DED+131j
					; DATA XREF: .rdata:off_42EC94o
		add	[ebp+var_1C], 1	; jumptable 00424F1E case 13
		cmp	[ebp+var_24], 0
		jz	loc_424FEA
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	72h
		add	[ebp+var_24], 1
		jmp	loc_424FEA
; ---------------------------------------------------------------------------

loc_424F5A:				; CODE XREF: sub_424DED+131j
					; DATA XREF: .rdata:off_42EC94o
		add	[ebp+var_1C], 1	; jumptable 00424F1E case 12
		cmp	[ebp+var_24], 0
		jz	loc_424FED
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	66h
		add	[ebp+var_24], 1
		jmp	short loc_424FED
; ---------------------------------------------------------------------------

loc_424F74:				; CODE XREF: sub_424DED+131j
					; DATA XREF: .rdata:off_42EC94o
		add	[ebp+var_1C], 1	; jumptable 00424F1E case 11
		cmp	[ebp+var_24], 0
		jz	short loc_424FF0
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	76h
		add	[ebp+var_24], 1
		jmp	short loc_424FF0
; ---------------------------------------------------------------------------

loc_424F8A:				; CODE XREF: sub_424DED+131j
					; DATA XREF: .rdata:off_42EC94o
		add	[ebp+var_1C], 1	; jumptable 00424F1E case 8
		cmp	[ebp+var_24], 0
		jz	short loc_424FF3
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	62h
		add	[ebp+var_24], 1
		jmp	short loc_424FF3
; ---------------------------------------------------------------------------

loc_424FA0:				; CODE XREF: sub_424DED+131j
					; DATA XREF: .rdata:off_42EC94o
		add	[ebp+var_1C], 1	; jumptable 00424F1E case 0
		cmp	[ebp+var_24], 0
		jz	short loc_424FF6
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	30h
		add	[ebp+var_24], 1
		jmp	short loc_424FF6
; ---------------------------------------------------------------------------

loc_424FB6:				; CODE XREF: sub_424DED+124j
					; sub_424DED+131j
					; DATA XREF: ...
		add	[ebp+var_1C], 3	; jumptable 00424F1E default case
		cmp	[ebp+var_24], 0
		jz	short loc_424FF9
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_2 ; "x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 3
		jmp	short loc_424FF9
; ---------------------------------------------------------------------------

loc_424FE7:				; CODE XREF: sub_424DED+13Bj
					; sub_424DED+14Bj
		nop
		jmp	short loc_424FFA
; ---------------------------------------------------------------------------

loc_424FEA:				; CODE XREF: sub_424DED+158j
					; sub_424DED+168j
		nop
		jmp	short loc_424FFA
; ---------------------------------------------------------------------------

loc_424FED:				; CODE XREF: sub_424DED+175j
					; sub_424DED+185j
		nop
		jmp	short loc_424FFA
; ---------------------------------------------------------------------------

loc_424FF0:				; CODE XREF: sub_424DED+18Fj
					; sub_424DED+19Bj
		nop
		jmp	short loc_424FFA
; ---------------------------------------------------------------------------

loc_424FF3:				; CODE XREF: sub_424DED+1A5j
					; sub_424DED+1B1j
		nop
		jmp	short loc_424FFA
; ---------------------------------------------------------------------------

loc_424FF6:				; CODE XREF: sub_424DED+1BBj
					; sub_424DED+1C7j
		nop
		jmp	short loc_424FFA
; ---------------------------------------------------------------------------

loc_424FF9:				; CODE XREF: sub_424DED+1D1j
					; sub_424DED+1F8j
		nop

loc_424FFA:				; CODE XREF: sub_424DED+1FBj
					; sub_424DED+1FEj ...
		nop
		jmp	loc_4253AB
; ---------------------------------------------------------------------------

loc_425000:				; CODE XREF: sub_424DED+C4j
					; sub_424DED+F0j ...
		cmp	[ebp+var_24], 0
		jz	short loc_425017
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_425017:				; CODE XREF: sub_424DED+217j
		add	[ebp+var_1C], 1
		jmp	loc_4253AB
; ---------------------------------------------------------------------------

loc_425020:				; CODE XREF: sub_424DED+BAj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0E0h
		cmp	eax, 0C0h
		jnz	short loc_425069
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 1
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_4253AB
; ---------------------------------------------------------------------------

loc_425069:				; CODE XREF: sub_424DED+246j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F0h
		cmp	eax, 0E0h
		jnz	short loc_4250B2
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 2
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_4253AB
; ---------------------------------------------------------------------------

loc_4250B2:				; CODE XREF: sub_424DED+28Fj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F8h
		cmp	eax, 0F0h
		jnz	short loc_4250FB
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 7
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 3
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_4253AB
; ---------------------------------------------------------------------------

loc_4250FB:				; CODE XREF: sub_424DED+2D8j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FCh
		cmp	eax, 0F8h
		jnz	short loc_425144
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 4
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_4253AB
; ---------------------------------------------------------------------------

loc_425144:				; CODE XREF: sub_424DED+321j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FEh
		cmp	eax, 0FCh
		jnz	short loc_42518D
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 5
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_4253AB
; ---------------------------------------------------------------------------

loc_42518D:				; CODE XREF: sub_424DED+36Aj
		cmp	[ebp+var_24], 0
		jz	short loc_4251B8
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_4251B8:				; CODE XREF: sub_424DED+3A4j
		add	[ebp+var_1C], 4
		mov	[ebp+var_30], 1
		jmp	loc_4253AB
; ---------------------------------------------------------------------------

loc_4251C8:				; CODE XREF: sub_424DED+ACj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_4251E0
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	loc_42526E

loc_4251E0:				; CODE XREF: sub_424DED+3E3j
		cmp	[ebp+var_24], 0
		jz	short loc_425248
		mov	[ebp+var_10], 0
		jmp	short loc_42521B
; ---------------------------------------------------------------------------

loc_4251EF:				; CODE XREF: sub_424DED+434j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_42521B:				; CODE XREF: sub_424DED+400j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_4251EF
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_425248:				; CODE XREF: sub_424DED+3F7j
		mov	eax, [ebp+var_14]
		add	eax, 1
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_30], 1
		jmp	loc_4253AB
; ---------------------------------------------------------------------------

loc_42526E:				; CODE XREF: sub_424DED+3EDj
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		shl	[ebp+var_28], 6
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3Fh
		or	[ebp+var_28], eax
		sub	[ebp+var_C], 1
		cmp	[ebp+var_C], 0
		jnz	loc_4253AB
		mov	eax, ds:dword_4304E4
		test	eax, eax
		jz	short loc_4252EB
		cmp	[ebp+var_24], 0
		jz	short loc_4252D9
		mov	[ebp+var_10], 0
		jmp	short loc_4252D1
; ---------------------------------------------------------------------------

loc_4252B9:				; CODE XREF: sub_424DED+4EAj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_4252D1:				; CODE XREF: sub_424DED+4CAj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_4252B9

loc_4252D9:				; CODE XREF: sub_424DED+4C1j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	loc_4253AB
; ---------------------------------------------------------------------------

loc_4252EB:				; CODE XREF: sub_424DED+4BBj
		cmp	[ebp+arg_C], 0
		jz	short loc_42532F
		cmp	[ebp+var_24], 0
		jz	short loc_425320
		mov	[ebp+var_10], 0
		jmp	short loc_425318
; ---------------------------------------------------------------------------

loc_425300:				; CODE XREF: sub_424DED+531j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_425318:				; CODE XREF: sub_424DED+511j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_425300

loc_425320:				; CODE XREF: sub_424DED+508j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_4253AB
; ---------------------------------------------------------------------------

loc_42532F:				; CODE XREF: sub_424DED+502j
		cmp	[ebp+var_28], 7Fh
		jbe	short loc_425358
		cmp	[ebp+var_28], 0FFh
		ja	short loc_425358
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_4253AB
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_4253AB
; ---------------------------------------------------------------------------

loc_425358:				; CODE XREF: sub_424DED+546j
					; sub_424DED+54Fj
		cmp	[ebp+var_24], 0
		jz	short loc_42539B
		mov	[ebp+var_10], 0
		jmp	short loc_425393
; ---------------------------------------------------------------------------

loc_425367:				; CODE XREF: sub_424DED+5ACj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_425393:				; CODE XREF: sub_424DED+578j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_425367

loc_42539B:				; CODE XREF: sub_424DED+56Fj
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0

loc_4253AB:				; CODE XREF: sub_424DED+9Cj
					; sub_424DED+20Ej ...
		add	[ebp+var_18], 1
		sub	[ebp+var_2C], 1

loc_4253B3:				; CODE XREF: sub_424DED+44j
		cmp	[ebp+var_2C], 0
		jnz	loc_424E36
		cmp	[ebp+var_20], 0
		jnz	short loc_4253DF
		mov	eax, [ebp+var_1C]
		add	eax, 1
		mov	[esp+88h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax
		jmp	loc_424E11
; ---------------------------------------------------------------------------

loc_4253DF:				; CODE XREF: sub_424DED+5D4j
		cmp	[ebp+arg_C], 0
		jz	loc_4255AF
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, off_4292F4
		mov	[esp+88h+Format], offset aUtf8_0 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	libiconv_open
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0FFFFFFFFh
		jnz	short loc_425453
		mov	eax, off_4292F4
		mov	[esp+88h+var_80], 1
		mov	[esp+88h+Format], offset aUtf8_0 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	sub_42478C
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax
		call	gcry_free
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_4255BF
		jmp	loc_4255B8
; ---------------------------------------------------------------------------

loc_425453:				; CODE XREF: sub_424DED+61Ej
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		sub	eax, 1
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_44], eax
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_50]
		mov	[ebp+var_5C], eax
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_5C]
		mul	edx
		mov	eax, edx
		shr	eax, 2
		cmp	eax, [ebp+var_1C]
		jz	short loc_4254B7
		mov	[esp+88h+var_80], offset aDo_utf8_to_nat ; "do_utf8_to_native"
		mov	[esp+88h+Format], 24Ah
		mov	[esp+88h+Dest],	offset a____Gnupg22_12 ; "../../gnupg2-2.0.30/jnlib/utf8conv.c"
		call	sub_420AAC
; ---------------------------------------------------------------------------

loc_4254B7:				; CODE XREF: sub_424DED+6ACj
		mov	eax, [ebp+var_50]
		mov	[esp+88h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_48]
		mov	[ebp+var_34], eax
		lea	eax, [ebp+var_50]
		mov	[esp+88h+var_78], eax
		lea	eax, [ebp+var_48]
		mov	[esp+88h+var_7C], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+88h+var_80], eax
		lea	eax, [ebp+var_44]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	libiconv
		cmp	eax, 0FFFFFFFFh
		jnz	loc_42558E
		mov	eax, ds:dword_4304EC
		test	eax, eax
		jnz	short loc_425541
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+88h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	esi, off_4292F4
		mov	[esp+88h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_420034
		mov	[esp+88h+var_7C], ebx
		mov	[esp+88h+var_80], esi
		mov	[esp+88h+Format], offset aUtf8_0 ; "utf-8"
		mov	[esp+88h+Dest],	eax ; char *
		call	sub_4208F3

loc_425541:				; CODE XREF: sub_424DED+715j
		mov	ds:dword_4304EC, 1
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax
		call	gcry_free
		mov	[ebp+var_20], 0
		mov	eax, [ebp+var_34]
		mov	[esp+88h+Dest],	eax
		call	gcry_free
		mov	[esp+88h+var_7C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_424DED
		mov	[ebp+var_34], eax
		jmp	short loc_42559F
; ---------------------------------------------------------------------------

loc_42558E:				; CODE XREF: sub_424DED+708j
		mov	eax, [ebp+var_48]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax
		call	gcry_free

loc_42559F:				; CODE XREF: sub_424DED+79Fj
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	libiconv_close
		mov	eax, [ebp+var_34]
		jmp	short loc_4255B8
; ---------------------------------------------------------------------------

loc_4255AF:				; CODE XREF: sub_424DED+5F6j
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]

loc_4255B8:				; CODE XREF: sub_424DED+661j
					; sub_424DED+7C0j
		sub	esp, 0FFFFFF80h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_424DED	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4255BF	proc near		; CODE XREF: .text:00413D57p
					; sub_421858+50p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_4304E8
		mov	[esp+18h+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_424DED
		leave
		retn
sub_4255BF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4255E9	proc near		; CODE XREF: sub_40755B+A2p
					; sub_40ABDF+E0p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	libiconv_open
		leave
		retn
sub_4255E9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425603	proc near		; CODE XREF: sub_40755B+10Dp
					; sub_40ABDF+19Ep

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_10]
		mov	[esp+28h+var_18], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	libiconv
		leave
		retn
sub_425603	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425632	proc near		; CODE XREF: sub_40755B+11Dp
					; sub_40755B+133p ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	libiconv_close
		leave
		retn
sub_425632	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425648	proc near		; CODE XREF: sub_4257A2+14p

var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 10h
		cmp	[ebp+arg_0], 0
		jnz	short loc_425662
		mov	[ebp+var_C], 80000001h
		jmp	loc_425798
; ---------------------------------------------------------------------------

loc_425662:				; CODE XREF: sub_425648+Cj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_classes_r ; "HKEY_CLASSES_ROOT"
		mov	ecx, 12h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_425696
		mov	[ebp+var_C], 80000000h
		jmp	loc_425798
; ---------------------------------------------------------------------------

loc_425696:				; CODE XREF: sub_425648+40j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_current_u ; "HKEY_CURRENT_USER"
		mov	ecx, 12h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4256CA
		mov	[ebp+var_C], 80000001h
		jmp	loc_425798
; ---------------------------------------------------------------------------

loc_4256CA:				; CODE XREF: sub_425648+74j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_local_mac ; "HKEY_LOCAL_MACHINE"
		mov	ecx, 13h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4256FE
		mov	[ebp+var_C], 80000002h
		jmp	loc_425798
; ---------------------------------------------------------------------------

loc_4256FE:				; CODE XREF: sub_425648+A8j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_users	; "HKEY_USERS"
		mov	ecx, 0Bh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_42572F
		mov	[ebp+var_C], 80000003h
		jmp	short loc_425798
; ---------------------------------------------------------------------------

loc_42572F:				; CODE XREF: sub_425648+DCj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_performan ; "HKEY_PERFORMANCE_DATA"
		mov	ecx, 16h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_425760
		mov	[ebp+var_C], 80000004h
		jmp	short loc_425798
; ---------------------------------------------------------------------------

loc_425760:				; CODE XREF: sub_425648+10Dj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_current_c ; "HKEY_CURRENT_CONFIG"
		mov	ecx, 14h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_425791
		mov	[ebp+var_C], 80000005h
		jmp	short loc_425798
; ---------------------------------------------------------------------------

loc_425791:				; CODE XREF: sub_425648+13Ej
		mov	eax, 0
		jmp	short loc_42579B
; ---------------------------------------------------------------------------

loc_425798:				; CODE XREF: sub_425648+15j
					; sub_425648+49j ...
		mov	eax, [ebp+var_C]

loc_42579B:				; CODE XREF: sub_425648+14Ej
		add	esp, 10h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_425648	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4257A2(int, LPCSTR, LPCSTR lpValueName)
sub_4257A2	proc near		; CODE XREF: sub_40C1A5+71p

hKey		= dword	ptr -58h
lpSubKey	= dword	ptr -54h
ulOptions	= dword	ptr -50h
samDesired	= dword	ptr -4Ch
phkResult	= dword	ptr -48h
lpcbData	= dword	ptr -44h
var_2C		= dword	ptr -2Ch
Type		= dword	ptr -24h
cbData		= dword	ptr -20h
nSize		= dword	ptr -1Ch
var_18		= dword	ptr -18h
lpDst		= dword	ptr -14h
var_10		= dword	ptr -10h
lpData		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
lpValueName	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	[ebp+lpData], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+hKey],	eax
		call	sub_425648
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4257CE
		mov	eax, 0
		jmp	loc_425ABE
; ---------------------------------------------------------------------------

loc_4257CE:				; CODE XREF: sub_4257A2+20j
		lea	eax, [ebp+var_18]
		mov	[esp+58h+phkResult], eax ; phkResult
		mov	[esp+58h+samDesired], 20019h ; samDesired
		mov	[esp+58h+ulOptions], 0 ; ulOptions
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+lpSubKey], eax	; lpSubKey
		mov	eax, [ebp+var_10]
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegOpenKeyExA
		call	eax ; RegOpenKeyExA
		sub	esp, 14h
		test	eax, eax
		jz	short loc_42584D
		cmp	[ebp+arg_0], 0
		jz	short loc_425810
		mov	eax, 0
		jmp	loc_425ABE
; ---------------------------------------------------------------------------

loc_425810:				; CODE XREF: sub_4257A2+62j
		lea	eax, [ebp+var_18]
		mov	[esp+58h+phkResult], eax ; phkResult
		mov	[esp+58h+samDesired], 20019h ; samDesired
		mov	[esp+58h+ulOptions], 0 ; ulOptions
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+lpSubKey], eax	; lpSubKey
		mov	[esp+58h+hKey],	80000002h ; hKey
		mov	eax, ds:RegOpenKeyExA
		call	eax ; RegOpenKeyExA
		sub	esp, 14h
		test	eax, eax
		jz	short loc_42584D
		mov	eax, 0
		jmp	loc_425ABE
; ---------------------------------------------------------------------------

loc_42584D:				; CODE XREF: sub_4257A2+5Cj
					; sub_4257A2+9Fj
		mov	[ebp+cbData], 1
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+cbData]
		mov	[esp+58h+lpcbData], edx	; lpcbData
		mov	[esp+58h+phkResult], 0 ; lpData
		mov	[esp+58h+samDesired], 0	; lpType
		mov	[esp+58h+ulOptions], 0 ; lpReserved
		mov	edx, [ebp+lpValueName]
		mov	[esp+58h+lpSubKey], edx	; lpValueName
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegQueryValueExA
		call	eax ; RegQueryValueExA
		sub	esp, 18h
		test	eax, eax
		jnz	loc_425AA1
		mov	eax, [ebp+cbData]
		add	eax, 1
		mov	[ebp+nSize], eax
		mov	eax, [ebp+nSize]
		mov	[esp+58h+hKey],	eax
		call	gcry_malloc
		mov	[ebp+lpData], eax
		cmp	[ebp+lpData], 0
		jz	loc_425AA4
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+nSize]
		mov	[esp+58h+lpcbData], edx	; lpcbData
		mov	edx, [ebp+lpData]
		mov	[esp+58h+phkResult], edx ; lpData
		lea	edx, [ebp+Type]
		mov	[esp+58h+samDesired], edx ; lpType
		mov	[esp+58h+ulOptions], 0 ; lpReserved
		mov	edx, [ebp+lpValueName]
		mov	[esp+58h+lpSubKey], edx	; lpValueName
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegQueryValueExA
		call	eax ; RegQueryValueExA
		sub	esp, 18h
		test	eax, eax
		jz	short loc_425902
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		mov	[ebp+lpData], 0
		jmp	loc_425AAB
; ---------------------------------------------------------------------------

loc_425902:				; CODE XREF: sub_4257A2+147j
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpData]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+Type]
		cmp	eax, 2
		jnz	loc_425AAB
		mov	[esp+58h+lpSubKey], 25h	; Val
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; Str
		call	strchr
		test	eax, eax
		jz	loc_425AAB
		mov	eax, [ebp+nSize]
		add	eax, 3E8h
		mov	[ebp+nSize], eax
		mov	eax, [ebp+nSize]
		add	eax, 1
		mov	[esp+58h+hKey],	eax
		call	gcry_malloc
		mov	[ebp+lpDst], eax
		cmp	[ebp+lpDst], 0
		jz	loc_425AA7
		mov	eax, [ebp+nSize]
		mov	[esp+58h+ulOptions], eax ; nSize
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; lpDst
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; lpSrc
		mov	eax, ds:ExpandEnvironmentStringsA
		call	eax ; ExpandEnvironmentStringsA
		sub	esp, 0Ch
		mov	[ebp+cbData], eax
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	loc_425A1F
		mov	edx, [ebp+cbData]
		mov	eax, [ebp+nSize]
		cmp	edx, eax
		jbe	loc_425A1F
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		mov	eax, [ebp+cbData]
		mov	[ebp+nSize], eax
		mov	eax, [ebp+nSize]
		add	eax, 1
		mov	[esp+58h+hKey],	eax
		call	gcry_malloc
		mov	[ebp+lpDst], eax
		cmp	[ebp+lpDst], 0
		jz	loc_425AAA
		mov	eax, [ebp+nSize]
		mov	[esp+58h+ulOptions], eax ; nSize
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; lpDst
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; lpSrc
		mov	eax, ds:ExpandEnvironmentStringsA
		call	eax ; ExpandEnvironmentStringsA
		sub	esp, 0Ch
		mov	[ebp+cbData], eax
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	short loc_425A00
		mov	edx, [ebp+cbData]
		mov	eax, [ebp+nSize]
		cmp	edx, eax
		jbe	short loc_425A00
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		jmp	loc_425AAB
; ---------------------------------------------------------------------------

loc_425A00:				; CODE XREF: sub_4257A2+242j
					; sub_4257A2+24Cj
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpDst]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		mov	eax, [ebp+lpDst]
		mov	[ebp+lpData], eax
		jmp	loc_425AAB
; ---------------------------------------------------------------------------

loc_425A1F:				; CODE XREF: sub_4257A2+1DCj
					; sub_4257A2+1EAj
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	short loc_425A94
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpDst]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		mov	eax, [ebp+lpDst]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+58h+hKey],	eax
		call	gcry_malloc
		mov	[ebp+lpData], eax
		cmp	[ebp+lpData], 0
		jnz	short loc_425A75
		mov	eax, [ebp+lpDst]
		mov	[ebp+lpData], eax
		jmp	short loc_425AAB
; ---------------------------------------------------------------------------

loc_425A75:				; CODE XREF: sub_4257A2+2C9j
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; Source
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		jmp	short loc_425AAB
; ---------------------------------------------------------------------------

loc_425A94:				; CODE XREF: sub_4257A2+282j
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		jmp	short loc_425AAB
; ---------------------------------------------------------------------------

loc_425AA1:				; CODE XREF: sub_4257A2+EAj
		nop
		jmp	short loc_425AAB
; ---------------------------------------------------------------------------

loc_425AA4:				; CODE XREF: sub_4257A2+10Bj
		nop
		jmp	short loc_425AAB
; ---------------------------------------------------------------------------

loc_425AA7:				; CODE XREF: sub_4257A2+1B0j
		nop
		jmp	short loc_425AAB
; ---------------------------------------------------------------------------

loc_425AAA:				; CODE XREF: sub_4257A2+216j
		nop

loc_425AAB:				; CODE XREF: sub_4257A2+15Bj
					; sub_4257A2+16Fj ...
		mov	eax, [ebp+var_18]
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegCloseKey
		call	eax ; RegCloseKey
		sub	esp, 4
		mov	eax, [ebp+lpData]

loc_425ABE:				; CODE XREF: sub_4257A2+27j
					; sub_4257A2+69j ...
		mov	edi, [ebp+var_4]
		leave
		retn
sub_4257A2	endp

; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		sub	esp, 0A8h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42147F
		test	eax, eax
		jnz	short loc_425AEF
		mov	dword ptr [ebp-0Ch], 1
		jmp	loc_425C19
; ---------------------------------------------------------------------------

loc_425AEF:				; CODE XREF: .text:00425AE1j
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 3
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_425B44
		mov	dword ptr [ebp-0Ch], 0
		jmp	loc_425C19
; ---------------------------------------------------------------------------

loc_425B44:				; CODE XREF: .text:00425B36j
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 3
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_425B96
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_425C09
; ---------------------------------------------------------------------------

loc_425B96:				; CODE XREF: .text:00425B8Bj
		lea	eax, [ebp-7Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		mov	eax, ds:GetFileInformationByHandle
		call	eax ; GetFileInformationByHandle
		sub	esp, 8
		test	eax, eax
		jz	short loc_425BF1
		lea	eax, [ebp-48h]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		mov	eax, ds:GetFileInformationByHandle
		call	eax ; GetFileInformationByHandle
		sub	esp, 8
		test	eax, eax
		jz	short loc_425BF1
		mov	edx, [ebp-60h]
		mov	eax, [ebp-2Ch]
		cmp	edx, eax
		jnz	short loc_425BF1
		mov	edx, [ebp-50h]
		mov	eax, [ebp-1Ch]
		cmp	edx, eax
		jnz	short loc_425BF1
		mov	edx, [ebp-4Ch]
		mov	eax, [ebp-18h]
		cmp	edx, eax
		jnz	short loc_425BF1
		mov	eax, 1
		jmp	short loc_425BF6
; ---------------------------------------------------------------------------

loc_425BF1:				; CODE XREF: .text:00425BAFj
					; .text:00425BCAj ...
		mov	eax, 0

loc_425BF6:				; CODE XREF: .text:00425BEFj
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_425C09:				; CODE XREF: .text:00425B94j
		mov	eax, [ebp-10h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_425C19:				; CODE XREF: .text:00425AEAj
					; .text:00425B3Fj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425C1E	proc near		; CODE XREF: .text:00416FC4p

VarName		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	[esp+38h+VarName], offset aTz ;	"TZ"
		call	getenv
		mov	[ebp+var_C], eax
		mov	[esp+38h+VarName], offset EnvString ; "TZ=UTC"
		call	_putenv
		call	_tzset
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+VarName], eax
		call	sub_4277E0
		mov	[ebp+var_10], eax
		cmp	[ebp+var_C], 0
		jz	short loc_425CD4
		mov	eax, ds:dword_430520
		test	eax, eax
		jnz	short loc_425CBC
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 4
		mov	[esp+38h+VarName], eax ; Size
		call	malloc
		mov	ds:dword_430520, eax
		mov	eax, ds:dword_430520
		test	eax, eax
		jz	short loc_425CBC
		mov	edx, offset aTz_0 ; "TZ="
		mov	eax, ds:dword_430520
		mov	edx, [edx]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		mov	eax, ds:dword_430520
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+VarName], eax ; Dest
		call	strcat

loc_425CBC:				; CODE XREF: sub_425C1E+42j
					; sub_425C1E+7Aj
		mov	eax, ds:dword_430520
		test	eax, eax
		jz	short loc_425CE0
		mov	eax, ds:dword_430520
		mov	[esp+38h+VarName], eax ; EnvString
		call	_putenv
		jmp	short loc_425CE0
; ---------------------------------------------------------------------------

loc_425CD4:				; CODE XREF: sub_425C1E+39j
		mov	[esp+38h+VarName], offset aTz ;	"TZ"
		call	_putenv

loc_425CE0:				; CODE XREF: sub_425C1E+A5j
					; sub_425C1E+B4j
		call	_tzset
		mov	eax, [ebp+var_10]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_425C1E	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_sscan]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_sprint]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_xmalloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_release]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_xrealloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_free]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_canon_len]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_new]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_pk_get_keygrip]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_snew]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_mul]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_cmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_copy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_set]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_release]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_invm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_sub_ui]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_div]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_cmp_ui]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_gcd]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_build]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_xmalloc_secure]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_find_token]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_cadr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_nth_data]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_xcalloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_nth_mpi]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_mod]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_control]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_check_version]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_xstrdup]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_hash_buffer]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_cipher_open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_cipher_get_algo_blklen]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_malloc_secure]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_malloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_create_nonce]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_cipher_setiv]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_cipher_setkey]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_cipher_encrypt]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_cipher_close]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_open]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_write]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_read]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_close]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_cipher_decrypt]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_reset]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_ctl]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_get_algo_dlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_scan]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_add_ui]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_add]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_clear_highbit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_print]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_randomize]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_setkey]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_strdup]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_set_log_handler]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_set_fatalerror_handler]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_set_outofcore_handler]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_realloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gpg_strerror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_err_code_from_syserror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gpg_err_code_from_errno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_transact]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION assuan_new]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_socket_connect]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION assuan_release]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_pipe_connect]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION libiconv_open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION libiconv_close]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION libiconv]
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:00433024o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_425F60
		cmp	eax, 3
		jz	short loc_425F60
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_425F60:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_427150
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_401180+113p
					; DATA XREF: .rdata:off_42ED98o ...

lpLibFileName	= dword	ptr -1Ch
lpProcName	= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		mov	edx, ds:_winmajor
		mov	eax, [esp+1Ch+arg_4]
		cmp	dword ptr [edx], 3
		jbe	short loc_425FD4
		cmp	dword_429308, 2
		jz	short loc_425FB6
		mov	dword_429308, 2

loc_425FB6:				; CODE XREF: TlsCallback_0+1Aj
		cmp	eax, 2
		jz	loc_4260C3
		cmp	eax, 1
		jz	loc_426062

loc_425FC8:				; CODE XREF: TlsCallback_0+EEj
					; TlsCallback_0+13Ej
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_425FD4:				; CODE XREF: TlsCallback_0+11j
		mov	ds:dword_430994, 1
		mov	[esp+1Ch+lpLibFileName], offset	LibFileName ; "mingwm10.dll"
		call	ds:LoadLibraryA
		sub	esp, 4
		test	eax, eax
		mov	ds:hLibModule, eax
		jz	loc_4260F3
		mov	ebx, ds:GetProcAddress
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_rem ; "__mingwthr_remove_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	ds:dword_430990, eax
		mov	eax, ds:hLibModule
		sub	esp, 8
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_key ; "__mingwthr_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	edx, ds:hLibModule
		sub	esp, 8
		test	edx, edx
		mov	ds:dword_43098C, eax
		jz	loc_4260F3
		mov	ecx, ds:dword_430990
		test	ecx, ecx
		jz	short loc_426083
		test	eax, eax
		jz	short loc_426083
		mov	dword_429308, 1
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_426062:				; CODE XREF: TlsCallback_0+32j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+lpProcName], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpLibFileName], eax
		call	sub_427150
		jmp	loc_425FC8
; ---------------------------------------------------------------------------

loc_426083:				; CODE XREF: TlsCallback_0+B6j
					; TlsCallback_0+BAj
		mov	ds:dword_43098C, 0
		mov	ds:dword_430990, 0
		mov	[esp+1Ch+lpLibFileName], edx ; hLibModule
		call	ds:FreeLibrary
		sub	esp, 4

loc_4260A3:				; CODE XREF: TlsCallback_0+177j
		mov	ds:hLibModule, 0
		mov	eax, 1
		mov	dword_429308, 0
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_4260C3:				; CODE XREF: TlsCallback_0+29j
		mov	ebx, offset dword_433030
		cmp	ebx, offset dword_433030
		jz	loc_425FC8

loc_4260D4:				; CODE XREF: TlsCallback_0+155j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_4260DC
		call	eax

loc_4260DC:				; CODE XREF: TlsCallback_0+148j
		add	ebx, 4
		cmp	ebx, offset dword_433030
		jnz	short loc_4260D4
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_4260F3:				; CODE XREF: TlsCallback_0+65j
					; TlsCallback_0+A8j
		mov	ds:dword_43098C, 0
		mov	ds:dword_430990, 0
		jmp	short loc_4260A3
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_426120	proc near		; DATA XREF: .CRT:00433014o
		mov	eax, ds:__lconv_init
		jmp	eax
sub_426120	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_426130	proc near		; CODE XREF: sub_426150+10p
					; sub_426150+36p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_426130	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_426140	proc near		; CODE XREF: sub_401060+59p
					; sub_426150+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_426140	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_426150(_onexit_t)
sub_426150	proc near		; CODE XREF: sub_426210+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_43099C
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_426130
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_14], eax
		jz	loc_4261F0
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_43099C
		mov	[esp+2Ch+Func],	eax
		call	sub_426130
		mov	[esp+2Ch+var_14], eax
		mov	eax, ds:dword_430998
		mov	[esp+2Ch+Func],	eax
		call	sub_426130
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_10], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_426140
		mov	ds:dword_43099C, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_426140
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_430998, eax
		call	_unlock
		add	esp, 28h
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4261F0:				; CODE XREF: sub_426150+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_426150	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_426210(_onexit_t)
sub_426210	proc near		; CODE XREF: sub_40EFA9+20p
					; sub_426E30-27p ...

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_426150
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_426210	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LONG __stdcall TopLevelExceptionFilter(struct	_EXCEPTION_POINTERS *ExceptionInfo)
TopLevelExceptionFilter	proc near	; DATA XREF: sub_401180+11Do

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
ExceptionInfo	= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 24h
		mov	ebx, [esp+2Ch+ExceptionInfo]
		mov	eax, [ebx]
		mov	eax, [eax]
		cmp	eax, 0C0000091h
		ja	short loc_426287
		cmp	eax, 0C000008Dh
		jb	short loc_4262B4

loc_42624B:				; CODE XREF: TopLevelExceptionFilter+6Aj
		mov	esi, 1

loc_426250:				; CODE XREF: TopLevelExceptionFilter+C7j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 8
		call	signal
		cmp	eax, 1
		jz	loc_426380
		test	eax, eax
		jz	short loc_42629C
		mov	[esp+2Ch+var_2C], 8
		call	eax
		mov	eax, 0FFFFFFFFh

loc_42627F:				; CODE XREF: TopLevelExceptionFilter+120j
					; TopLevelExceptionFilter+13Ej	...
		add	esp, 24h
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_426287:				; CODE XREF: TopLevelExceptionFilter+12j
		cmp	eax, 0C0000094h
		jz	short loc_4262F5
		cmp	eax, 0C0000096h
		jz	short loc_4262C2
		cmp	eax, 0C0000093h
		jz	short loc_42624B

loc_42629C:				; CODE XREF: TopLevelExceptionFilter+3Fj
					; TopLevelExceptionFilter+90j ...
		mov	eax, ds:dword_43054C
		test	eax, eax
		jz	loc_426373
		mov	[esp+2Ch+ExceptionInfo], ebx
		add	esp, 24h
		pop	ebx
		pop	esi
		jmp	eax
; ---------------------------------------------------------------------------

loc_4262B4:				; CODE XREF: TopLevelExceptionFilter+19j
		cmp	eax, 0C0000005h
		jz	short loc_426300
		cmp	eax, 0C000001Dh
		jnz	short loc_42629C

loc_4262C2:				; CODE XREF: TopLevelExceptionFilter+63j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 4
		call	signal
		cmp	eax, 1
		jz	short loc_426337
		test	eax, eax
		jz	short loc_42629C
		mov	[esp+2Ch+var_2C], 4
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_4262F5:				; CODE XREF: TopLevelExceptionFilter+5Cj
		xor	esi, esi
		jmp	loc_426250
; ---------------------------------------------------------------------------
		align 10h

loc_426300:				; CODE XREF: TopLevelExceptionFilter+89j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		cmp	eax, 1
		jz	short loc_426355
		test	eax, eax
		jz	loc_42629C
		mov	[esp+2Ch+var_2C], 0Bh
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_426337:				; CODE XREF: TopLevelExceptionFilter+A9j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 4
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_42627F
; ---------------------------------------------------------------------------

loc_426355:				; CODE XREF: TopLevelExceptionFilter+E7j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_42627F
; ---------------------------------------------------------------------------

loc_426373:				; CODE XREF: TopLevelExceptionFilter+73j
		xor	eax, eax
		jmp	loc_42627F
; ---------------------------------------------------------------------------
		align 10h

loc_426380:				; CODE XREF: TopLevelExceptionFilter+37j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 8
		call	signal
		test	esi, esi
		mov	eax, 0FFFFFFFFh
		jz	loc_42627F
		mov	[esp+2Ch+var_10], eax
		call	sub_426DA0
		mov	eax, [esp+2Ch+var_10]
		jmp	loc_42627F
TopLevelExceptionFilter	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 3Ch
		mov	eax, ds:dword_430550
		fld	qword ptr [esp+48h]
		fld	qword ptr [esp+50h]
		fld	qword ptr [esp+58h]
		test	eax, eax
		jz	short loc_426401
		fxch	st(2)
		mov	edx, [esp+40h]
		fstp	qword ptr [esp+18h]
		fstp	qword ptr [esp+20h]
		fstp	qword ptr [esp+28h]
		mov	[esp+10h], edx
		mov	edx, [esp+44h]
		mov	[esp+14h], edx
		lea	edx, [esp+10h]
		mov	[esp], edx
		call	eax ; dword_430550
		jmp	short loc_426407
; ---------------------------------------------------------------------------

loc_426401:				; CODE XREF: .text:004263D6j
		fstp	st
		fstp	st
		fstp	st

loc_426407:				; CODE XREF: .text:004263FFj
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_426410	proc near		; CODE XREF: sub_401060+F7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ds:dword_430550, eax
		jmp	__setusermatherr
sub_426410	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_426420	proc near		; DATA XREF: sub_401060:loc_401150o

File		= dword	ptr -3Ch
Format		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= qword	ptr -2Ch
var_24		= qword	ptr -24h
var_1C		= qword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 3Ch
		mov	edx, offset aUnknownError ; "Unknown error"
		mov	eax, [esp+3Ch+arg_0]
		mov	ecx, [eax]
		sub	ecx, 1
		cmp	ecx, 5
		ja	short loc_42643D
		mov	edx, ds:off_42EEB8[ecx*4]

loc_42643D:				; CODE XREF: sub_426420+14j
		fld	qword ptr [eax+18h]
		fstp	[esp+3Ch+var_1C]
		fld	qword ptr [eax+10h]
		fstp	[esp+3Ch+var_24]
		fld	qword ptr [eax+8]
		fstp	[esp+3Ch+var_2C]
		mov	eax, [eax+4]
		mov	[esp+3Ch+var_34], edx
		mov	[esp+3Ch+Format], offset a_matherrSInSGG ; "_matherr():	%s in %s(%g, %g)  (retval=%"...
		mov	[esp+3Ch+var_30], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+3Ch+File],	eax ; File
		call	fprintf
		xor	eax, eax
		add	esp, 3Ch
		retn
sub_426420	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_426480	proc near		; CODE XREF: sub_401060+75p
		xor	eax, eax
		retn
sub_426480	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_426490(char *Format, char ArgList)
sub_426490	proc near		; CODE XREF: sub_4264F0+1DDp
					; sub_4264F0+204p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aMingwW64Runtim ;	"Mingw-w64 runtime failure:\n"
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_426490	endp

; ---------------------------------------------------------------------------
		jmp	short sub_4264F0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_4264F0(size_t Size)
sub_4264F0	proc near		; CODE XREF: .text:004264E1j
					; sub_426730+B8p ...

lpAddress	= dword	ptr -7Ch
lpBuffer	= dword	ptr -78h
dwLength	= dword	ptr -74h
lpflOldProtect	= dword	ptr -70h
var_64		= dword	ptr -64h
Src		= dword	ptr -60h
var_58		= _MEMORY_BASIC_INFORMATION ptr	-58h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h

		push	ebp
		mov	ebp, ecx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 6Ch
		mov	ecx, ds:dword_43055C
		mov	[esp+7Ch+Src], edx
		test	ecx, ecx
		jle	loc_4266D2
		mov	eax, ds:dword_430558
		xor	esi, esi

loc_426514:				; CODE XREF: sub_4264F0+41j
		mov	edx, [eax+4]
		cmp	ebx, edx
		jb	short loc_426529
		mov	edi, [eax+8]
		add	edx, [edi+8]
		cmp	ebx, edx
		jb	loc_426600

loc_426529:				; CODE XREF: sub_4264F0+29j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jnz	short loc_426514

loc_426533:				; CODE XREF: sub_4264F0+1E4j
		mov	[esp+7Ch+lpAddress], ebx
		call	sub_426AF0
		test	eax, eax
		mov	edi, eax
		jz	loc_4266F9
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_430558
		shl	edx, 2
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		mov	[esp+7Ch+var_64], edx
		call	sub_426BD0
		mov	edx, [esp+7Ch+var_64]
		add	eax, [edi+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+7Ch+Buffer]
		mov	esi, ds:VirtualQuery
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_430558
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+7Ch+var_64]
		jz	loc_4266D9
		mov	eax, [esp+7Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	loc_426681

loc_4265AF:				; CODE XREF: sub_4264F0+194j
					; sub_4264F0+1C6j
		add	ds:dword_43055C, 1

loc_4265B6:				; CODE XREF: sub_4264F0+116j
		lea	eax, [esp+7Ch+var_58]
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	[esp+7Ch+lpAddress], ebx ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_426709
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 4
		jnz	short loc_426608

loc_4265DF:				; CODE XREF: sub_4264F0+11Bj
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy

loc_4265F3:				; CODE XREF: sub_4264F0+162j
					; sub_4264F0+167j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_426600:				; CODE XREF: sub_4264F0+33j
		mov	esi, ds:VirtualQuery
		jmp	short loc_4265B6
; ---------------------------------------------------------------------------

loc_426608:				; CODE XREF: sub_4264F0+EDj
		cmp	eax, 40h
		jz	short loc_4265DF
		mov	eax, [esp+7Ch+var_58.RegionSize]
		lea	edi, [esp+7Ch+flOldProtect]
		mov	esi, ds:VirtualProtect
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 40h
		jz	short loc_4265F3
		cmp	eax, 4
		jz	short loc_4265F3
		mov	eax, [esp+7Ch+flOldProtect]
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], eax	; flNewProtect
		mov	eax, [esp+7Ch+var_58.RegionSize]
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_426681:				; CODE XREF: sub_4264F0+B9j
		cmp	eax, 40h
		jz	loc_4265AF
		mov	eax, [esp+7Ch+Buffer.RegionSize]
		add	edx, ds:dword_430558
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+Buffer.BaseAddress]
		mov	[esp+7Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		test	eax, eax
		jnz	loc_4265AF
		call	ds:GetLastError
		mov	[esp+7Ch+lpAddress], offset aVirtualprotect ; "	 VirtualProtect	failed with code 0x%x"
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_426490
; ---------------------------------------------------------------------------

loc_4266D2:				; CODE XREF: sub_4264F0+17j
		xor	esi, esi
		jmp	loc_426533
; ---------------------------------------------------------------------------

loc_4266D9:				; CODE XREF: sub_4264F0+ACj
		mov	eax, ds:dword_430558
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+dwLength], eax
		mov	eax, [edi+8]
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_426490
; ---------------------------------------------------------------------------

loc_4266F9:				; CODE XREF: sub_4264F0+4Fj
		mov	[esp+7Ch+lpBuffer], ebx	; ArgList
		mov	[esp+7Ch+lpAddress], offset aAddressPHasNoI ; "Address %p has no image-section"
		call	sub_426490
; ---------------------------------------------------------------------------

loc_426709:				; CODE XREF: sub_4264F0+E0j
		mov	[esp+7Ch+dwLength], ebx
		mov	[esp+7Ch+lpBuffer], 1Ch	; ArgList
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		call	sub_426490
sub_4264F0	endp

; ---------------------------------------------------------------------------
		db 0EBh	; 
		db  0Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_426730	proc near		; CODE XREF: sub_401180:loc_401298p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
var_20		= dword	ptr -20h
flOldProtect	= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_430554
		test	eax, eax
		jz	short loc_426750

loc_426742:				; CODE XREF: sub_426730+66j
					; sub_426730+96j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_426750:				; CODE XREF: sub_426730+10j
		mov	ds:dword_430554, 1
		call	sub_426B30
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_4271F0
		mov	ds:dword_43055C, 0
		sub	esp, eax
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_430558, eax
		mov	eax, offset dword_42F1E0
		sub	eax, offset dword_42F1E0
		cmp	eax, 7
		jle	short loc_426742
		cmp	eax, 0Bh
		mov	ebx, offset dword_42F1E0
		jle	loc_426890
		mov	eax, ds:dword_42F1E0
		test	eax, eax
		jnz	short loc_4267C0
		mov	eax, ds:dword_42F1E4
		test	eax, eax
		jz	loc_42687C
		lea	esi, [esi+0]

loc_4267C0:				; CODE XREF: sub_426730+7Dj
					; sub_426730+164j ...
		cmp	ebx, offset dword_42F1E0
		jnb	loc_426742
		mov	esi, 400000h

loc_4267D1:				; CODE XREF: sub_426730+C3j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		lea	edx, [ebp+flOldProtect]
		call	sub_4264F0
		cmp	ebx, offset dword_42F1E0
		jb	short loc_4267D1

loc_4267F5:				; CODE XREF: sub_426730+24Bj
		mov	ecx, ds:dword_43055C
		test	ecx, ecx
		jle	loc_426742
		xor	ebx, ebx
		xor	esi, esi
		mov	edi, ds:VirtualQuery
		jmp	short loc_426822
; ---------------------------------------------------------------------------
		align 10h

loc_426810:				; CODE XREF: sub_426730+FDj
					; sub_426730+14Aj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_43055C
		jge	loc_426742

loc_426822:				; CODE XREF: sub_426730+DDj
		mov	eax, ds:dword_430558
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_426810
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	edi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_4269A2
		lea	eax, [ebp+flOldProtect]
		mov	[esp+58h+lpflOldProtect], eax ;	lpflOldProtect
		mov	eax, ds:dword_430558
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_426810
; ---------------------------------------------------------------------------

loc_42687C:				; CODE XREF: sub_426730+86j
		mov	eax, ds:dword_42F1E8
		test	eax, eax
		jnz	short loc_4268A5
		mov	ebx, offset dword_42F1EC
		lea	esi, [esi+0]

loc_426890:				; CODE XREF: sub_426730+70j
		mov	edi, [ebx]
		test	edi, edi
		jnz	loc_4267C0
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	loc_4267C0

loc_4268A5:				; CODE XREF: sub_426730+153j
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_4269C5
		add	ebx, 0Ch
		cmp	ebx, offset dword_42F1E0
		jnb	loc_426742

loc_4268C0:				; CODE XREF: sub_426730+245j
		movzx	edx, byte ptr [ebx+8]
		mov	eax, 400000h
		mov	ecx, [ebx]
		add	eax, [ebx+4]
		cmp	edx, 10h
		mov	esi, [ecx+400000h]
		jz	short loc_42691A
		cmp	edx, 20h
		jz	short loc_426950
		cmp	edx, 8
		jz	short loc_4268FA
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		mov	[ebp+var_20], 0
		call	sub_426490
; ---------------------------------------------------------------------------

loc_4268FA:				; CODE XREF: sub_426730+1B1j
		movzx	edi, byte ptr [eax]
		test	edi, 80h
		jz	short loc_426925
		or	edi, 0FFFFFF00h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi
		jmp	short loc_426941
; ---------------------------------------------------------------------------

loc_42691A:				; CODE XREF: sub_426730+1A7j
		movzx	edi, word ptr [eax]
		test	edi, 8000h
		jnz	short loc_426980

loc_426925:				; CODE XREF: sub_426730+1D3j
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		cmp	edx, 10h
		mov	[ebp+var_20], esi
		jz	short loc_426993
		cmp	edx, 20h
		jz	short loc_42695F
		cmp	edx, 8
		jnz	short loc_42696C

loc_426941:				; CODE XREF: sub_426730+1E8j
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_20]
		call	sub_4264F0
		jmp	short loc_42696C
; ---------------------------------------------------------------------------

loc_426950:				; CODE XREF: sub_426730+1ACj
		mov	edx, [eax]
		sub	edx, ecx
		sub	edx, 400000h
		add	edx, esi
		mov	[ebp+var_20], edx

loc_42695F:				; CODE XREF: sub_426730+20Aj
		mov	ecx, 4		; Size
		lea	edx, [ebp+var_20]
		call	sub_4264F0

loc_42696C:				; CODE XREF: sub_426730+20Fj
					; sub_426730+21Ej ...
		add	ebx, 0Ch
		cmp	ebx, offset dword_42F1E0
		jb	loc_4268C0
		jmp	loc_4267F5
; ---------------------------------------------------------------------------

loc_426980:				; CODE XREF: sub_426730+1F3j
		or	edi, 0FFFF0000h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi

loc_426993:				; CODE XREF: sub_426730+205j
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_20]
		call	sub_4264F0
		jmp	short loc_42696C
; ---------------------------------------------------------------------------

loc_4269A2:				; CODE XREF: sub_426730+11Bj
		add	ebx, ds:dword_430558
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_426490
; ---------------------------------------------------------------------------

loc_4269C5:				; CODE XREF: sub_426730+17Bj
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_426490
sub_426730	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4269E0	proc near		; CODE XREF: .text:00426A81p
					; sub_426AF0+Ap ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	eax, eax
		cmp	word ptr [edx],	5A4Dh
		jz	short loc_4269F0

locret_4269ED:				; CODE XREF: sub_4269E0+19j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_4269F0:				; CODE XREF: sub_4269E0+Bj
		add	edx, [edx+3Ch]
		cmp	dword ptr [edx], 4550h
		jnz	short locret_4269ED
		xor	eax, eax
		cmp	word ptr [edx+18h], 10Bh
		setz	al
		retn
sub_4269E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_426A10	proc near		; CODE XREF: sub_426AF0+2Bp
					; .text:00426C34p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		xor	eax, eax
		push	ebx
		mov	edx, [esp+8+arg_0]
		mov	ebx, [esp+8+arg_4]
		add	edx, [edx+3Ch]
		movzx	esi, word ptr [edx+6]
		movzx	ecx, word ptr [edx+14h]
		test	esi, esi
		jz	short loc_426A4E
		movzx	ecx, cx
		lea	eax, [edx+ecx+18h]
		xor	edx, edx

loc_426A34:				; CODE XREF: sub_426A10+3Aj
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_426A42
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_426A4E

loc_426A42:				; CODE XREF: sub_426A10+29j
		add	edx, 1
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_426A34
		xor	eax, eax

loc_426A4E:				; CODE XREF: sub_426A10+19j
					; sub_426A10+30j
		pop	ebx
		pop	esi
		retn
sub_426A10	endp

; ---------------------------------------------------------------------------
		jmp	short loc_426A60
; ---------------------------------------------------------------------------
		align 10h

loc_426A60:				; CODE XREF: .text:00426A51j
		push	ebp
		push	edi
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 1Ch
		mov	edi, [esp+30h]
		mov	[esp], edi
		call	strlen
		cmp	eax, 8
		ja	short loc_426AD3
		mov	dword ptr [esp], 400000h
		call	sub_4269E0
		test	eax, eax
		jz	short loc_426AD3
		mov	eax, ds:40003Ch
		movzx	ebp, word ptr [eax+400006h]
		movzx	edx, word ptr [eax+400014h]
		add	eax, 400000h
		test	ebp, ebp
		jz	short loc_426AD3
		movzx	edx, dx
		xor	esi, esi
		lea	ebx, [eax+edx+18h]
		jmp	short loc_426ABB
; ---------------------------------------------------------------------------

loc_426AB1:				; CODE XREF: .text:00426AD1j
		add	esi, 1
		add	ebx, 28h
		cmp	esi, ebp
		jnb	short loc_426AE0

loc_426ABB:				; CODE XREF: .text:00426AAFj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], edi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jnz	short loc_426AB1

loc_426AD3:				; CODE XREF: .text:00426A78j
					; .text:00426A88j ...
		add	esp, 1Ch
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_426AE0:				; CODE XREF: .text:00426AB9j
		add	esp, 1Ch
		xor	ebx, ebx
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_426AF0	proc near		; CODE XREF: sub_4264F0+46p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	[esp+8+var_8], 400000h
		call	sub_4269E0
		mov	edx, eax
		xor	eax, eax
		test	edx, edx
		jz	short loc_426B20
		mov	eax, [esp+8+arg_0]
		mov	[esp+8+var_8], 400000h
		sub	eax, 400000h
		mov	[esp+8+var_4], eax
		call	sub_426A10

loc_426B20:				; CODE XREF: sub_426AF0+15j
		add	esp, 8
		retn
sub_426AF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_426B30	proc near		; CODE XREF: sub_426730+2Ap

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_4269E0
		xor	edx, edx
		test	eax, eax
		jz	short loc_426B51
		mov	eax, ds:40003Ch
		movzx	edx, word ptr [eax+400006h]

loc_426B51:				; CODE XREF: sub_426B30+13j
		mov	eax, edx
		add	esp, 4
		retn
sub_426B30	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 4
		mov	dword ptr [esp], 400000h
		mov	ebx, [esp+10h]
		call	sub_4269E0
		xor	edx, edx
		test	eax, eax
		jz	short loc_426BB9
		mov	eax, ds:40003Ch
		movzx	ecx, word ptr [eax+400006h]
		movzx	esi, word ptr [eax+400014h]
		add	eax, 400000h
		test	ecx, ecx
		jz	short loc_426BB9
		movzx	esi, si
		lea	edx, [eax+esi+18h]
		xor	eax, eax

loc_426BA0:				; CODE XREF: .text:00426BB5j
		test	byte ptr [edx+27h], 20h
		jz	short loc_426BAD
		test	ebx, ebx
		jz	short loc_426BB9
		sub	ebx, 1

loc_426BAD:				; CODE XREF: .text:00426BA4j
		add	eax, 1
		add	edx, 28h
		cmp	eax, ecx
		jb	short loc_426BA0
		xor	edx, edx

loc_426BB9:				; CODE XREF: .text:00426B79j
					; .text:00426B95j ...
		add	esp, 4
		mov	eax, edx
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_426BD0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_426BD0	proc near		; CODE XREF: sub_4264F0+70p
					; .text:00426BC1j

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_4269E0
		xor	edx, edx
		test	eax, eax
		mov	eax, 400000h
		cmovnz	edx, eax
		add	esp, 4
		mov	eax, edx
		retn
sub_426BD0	endp

; ---------------------------------------------------------------------------
		jmp	short loc_426C00
; ---------------------------------------------------------------------------
		align 10h

loc_426C00:				; CODE XREF: .text:00426BF1j
		push	ebx
		xor	ebx, ebx
		sub	esp, 8
		mov	dword ptr [esp], 400000h
		call	sub_4269E0
		test	eax, eax
		jnz	short loc_426C20

loc_426C16:				; CODE XREF: .text:00426C3Bj
		add	esp, 8
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_426C20:				; CODE XREF: .text:00426C14j
		mov	eax, [esp+10h]
		mov	dword ptr [esp], 400000h
		sub	eax, 400000h
		mov	[esp+4], eax
		call	sub_426A10
		test	eax, eax
		jz	short loc_426C16
		mov	ebx, [eax+24h]
		add	esp, 8
		not	ebx
		shr	ebx, 1Fh
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_426C50	proc near		; CODE XREF: sub_426CE0+1Ap

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	edi
		xor	edi, edi
		push	esi
		push	ebx
		sub	esp, 8
		mov	[esp+14h+var_14], 400000h
		mov	ebx, [esp+14h+arg_0]
		call	sub_4269E0
		test	eax, eax
		jz	short loc_426CC1
		mov	eax, ds:40003Ch
		mov	esi, [eax+400080h]
		test	esi, esi
		jz	short loc_426CC1
		mov	[esp+14h+var_10], esi
		mov	[esp+14h+var_14], 400000h
		call	sub_426A10
		test	eax, eax
		jz	short loc_426CC1
		add	esi, 400000h
		jnz	short loc_426CA6
		jmp	short loc_426CC1
; ---------------------------------------------------------------------------
		align 10h

loc_426CA0:				; CODE XREF: sub_426C50+66j
		sub	ebx, 1
		add	esi, 14h

loc_426CA6:				; CODE XREF: sub_426C50+45j
		mov	edx, [esi+4]
		test	edx, edx
		jnz	short loc_426CB4
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_426CD0

loc_426CB4:				; CODE XREF: sub_426C50+5Bj
		test	ebx, ebx
		jg	short loc_426CA0
		mov	edi, [esi+0Ch]
		add	edi, 400000h

loc_426CC1:				; CODE XREF: sub_426C50+1Aj
					; sub_426C50+29j ...
		add	esp, 8
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_426CD0:				; CODE XREF: sub_426C50+62j
		add	esp, 8
		xor	edi, edi
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_426C50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_426CE0	proc near		; CODE XREF: sub_401180+132p

lpModuleName	= dword	ptr -1Ch

		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_430560
		test	eax, eax
		jz	short loc_426CF2

loc_426CED:				; CODE XREF: sub_426CE0+97j
					; sub_426CE0+B5j
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_426CF2:				; CODE XREF: sub_426CE0+Bj
		xor	eax, eax

loc_426CF4:				; CODE XREF: sub_426CE0+82j
		mov	[esp+1Ch+lpModuleName],	eax
		lea	ebx, [eax+1]
		call	sub_426C50
		test	eax, eax
		jz	short loc_426D80
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_426D10
		cmp	dl, 6Dh
		jnz	short loc_426D60

loc_426D10:				; CODE XREF: sub_426CE0+29j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_426D1E
		cmp	dl, 73h
		jnz	short loc_426D60

loc_426D1E:				; CODE XREF: sub_426CE0+37j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_426D2C
		cmp	dl, 76h
		jnz	short loc_426D60

loc_426D2C:				; CODE XREF: sub_426CE0+45j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_426D3A
		cmp	dl, 63h
		jnz	short loc_426D60

loc_426D3A:				; CODE XREF: sub_426CE0+53j
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_426D48
		cmp	dl, 72h
		jnz	short loc_426D60

loc_426D48:				; CODE XREF: sub_426CE0+61j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_426D64
		cmp	dl, 74h
		jz	short loc_426D64
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_426D64
		xchg	ax, ax

loc_426D60:				; CODE XREF: sub_426CE0+2Ej
					; sub_426CE0+3Cj ...
		mov	eax, ebx
		jmp	short loc_426CF4
; ---------------------------------------------------------------------------

loc_426D64:				; CODE XREF: sub_426CE0+6Fj
					; sub_426CE0+74j ...
		mov	[esp+1Ch+lpModuleName],	eax ; lpModuleName
		call	ds:GetModuleHandleA
		sub	esp, 4
		test	eax, eax
		mov	ds:dword_430560, eax
		jnz	loc_426CED
		lea	esi, [esi+0]

loc_426D80:				; CODE XREF: sub_426CE0+21j
		mov	[esp+1Ch+lpModuleName],	offset aMsvcrt_dll ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_430560, eax
		jmp	loc_426CED
sub_426CE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_426DA0	proc near		; CODE XREF: sub_401180:loc_4012D8p
					; TopLevelExceptionFilter+175p
		fninit
		retn
sub_426DA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_426DB0()
sub_426DB0	proc near		; DATA XREF: sub_426E30:loc_426E02o
		sub	esp, 0Ch
		mov	eax, off_429304
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_426DD7
		xchg	ax, ax

loc_426DC0:				; CODE XREF: sub_426DB0+25j
		call	eax
		mov	eax, off_429304
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_429304, edx
		test	eax, eax
		jnz	short loc_426DC0

loc_426DD7:				; CODE XREF: sub_426DB0+Cj
		add	esp, 0Ch
		retn
sub_426DB0	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_426E30

loc_426DE0:				; CODE XREF: sub_426E30+1Aj
		push	ebx
		sub	esp, 18h
		mov	ebx, ds:dword_4280C0
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_426E13

loc_426DEF:				; CODE XREF: sub_426E30-9j
		test	ebx, ebx
		jz	short loc_426E02

loc_426DF3:				; CODE XREF: sub_426E30-30j
		call	ds:dword_4280C0[ebx*4]
		sub	ebx, 1
		lea	esi, [esi+0]
		jnz	short loc_426DF3

loc_426E02:				; CODE XREF: sub_426E30-3Fj
		mov	[esp+1Ch+var_1C], offset sub_426DB0 ; _onexit_t
		call	sub_426210
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_426E13:				; CODE XREF: sub_426E30-43j
		xor	ebx, ebx
		jmp	short loc_426E19
; ---------------------------------------------------------------------------

loc_426E17:				; CODE XREF: sub_426E30-Bj
		mov	ebx, eax

loc_426E19:				; CODE XREF: sub_426E30-1Bj
		lea	eax, [ebx+1]
		mov	edx, ds:dword_4280C0[eax*4]
		test	edx, edx
		jnz	short loc_426E17
		jmp	short loc_426DEF
; END OF FUNCTION CHUNK	FOR sub_426E30
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_426E30	proc near		; CODE XREF: sub_401180+239p
					; sub_4032E3+Ap

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 00426DE0 SIZE 00000049 BYTES

		mov	ecx, ds:dword_430564
		test	ecx, ecx
		jz	short loc_426E40
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_426E40:				; CODE XREF: sub_426E30+8j
		mov	ds:dword_430564, 1
		jmp	short loc_426DE0
sub_426E30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_426E50	proc near		; CODE XREF: .text:004014BDp start+Dp

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
SystemTimeAsFileTime= _FILETIME	ptr -2Ch
PerformanceCount= LARGE_INTEGER	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_429310
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		jz	short loc_426EA0
		not	eax
		mov	dword_429314, eax

loc_426E86:				; CODE XREF: sub_426E50+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_426EA0:				; CODE XREF: sub_426E50+2Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_426F12

loc_426F02:				; CODE XREF: sub_426E50+CCj
		mov	dword_429310, ebp
		mov	dword_429314, eax
		jmp	loc_426E86
; ---------------------------------------------------------------------------

loc_426F12:				; CODE XREF: sub_426E50+B0j
		mov	eax, 44BF19B0h
		mov	ebp, 0BB40E64Fh
		jmp	short loc_426F02
sub_426E50	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_430644, edx
		mov	ds:dword_430860, 0C0000409h
		mov	ds:dword_430864, 1
		mov	ds:dword_430638, eax
		mov	ds:dword_43086C, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_43062C, eax
		mov	eax, dword_429310
		mov	[ebp-10h], eax
		mov	eax, dword_429314
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_42EFE0
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_426FB0	proc near		; CODE XREF: sub_427150+79p
					; sub_427150:loc_4271E2p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_4308DC
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_427005
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		lea	esi, [esi+0]

loc_426FE0:				; CODE XREF: sub_426FB0+53j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_426FFE
		test	esi, esi
		jz	short loc_426FFE
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_426FFE:				; CODE XREF: sub_426FB0+40j
					; sub_426FB0+44j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_426FE0

loc_427005:				; CODE XREF: sub_426FB0+1Fj
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_426FB0	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 1Ch
		mov	eax, ds:dword_4308C0
		mov	[esp+14h], ebx
		xor	ebx, ebx
		mov	[esp+18h], esi
		test	eax, eax
		jnz	short loc_427044

loc_427036:				; CODE XREF: .text:004270ACj
		mov	eax, ebx
		mov	esi, [esp+18h]
		mov	ebx, [esp+14h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_427044:				; CODE XREF: .text:00427034j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		test	eax, eax
		mov	esi, eax
		jz	short loc_4270A7
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	CriticalSection
		mov	[esi], eax
		mov	eax, [esp+24h]
		mov	[esi+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_4308DC
		mov	ds:dword_4308DC, esi
		mov	[esi+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, ebx
		sub	esp, 4
		mov	ebx, [esp+14h]
		mov	esi, [esp+18h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_4270A7:				; CODE XREF: .text:0042705Cj
		mov	ebx, 0FFFFFFFFh
		jmp	short loc_427036
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_4308C0
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_4270C8
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4270C8:				; CODE XREF: .text:004270BFj
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:EnterCriticalSection
		mov	edx, ds:dword_4308DC
		sub	esp, 4
		test	edx, edx
		jz	short loc_4270FF
		mov	eax, [edx]
		cmp	eax, ebx
		jnz	short loc_4270F8
		jmp	short loc_427136
; ---------------------------------------------------------------------------
		align 10h

loc_4270F0:				; CODE XREF: .text:004270FDj
		mov	ecx, [eax]
		cmp	ecx, ebx
		jz	short loc_427116
		mov	edx, eax

loc_4270F8:				; CODE XREF: .text:004270E6j
		mov	eax, [edx+8]
		test	eax, eax
		jnz	short loc_4270F0

loc_4270FF:				; CODE XREF: .text:004270E0j
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_42710F:				; CODE XREF: .text:00427134j
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_427116:				; CODE XREF: .text:004270F4j
		mov	ecx, [eax+8]
		mov	[edx+8], ecx

loc_42711C:				; CODE XREF: .text:00427140j
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_42710F
; ---------------------------------------------------------------------------

loc_427136:				; CODE XREF: .text:004270E8j
		mov	eax, [edx+8]
		mov	ds:dword_4308DC, eax
		mov	eax, edx
		jmp	short loc_42711C
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_427150	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+E9p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_4271A0
		jb	short loc_427170
		cmp	eax, 3
		jz	short loc_4271C0

loc_427163:				; CODE XREF: sub_427150+31j
					; sub_427150+4Dj ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_427170:				; CODE XREF: sub_427150+Cj
		mov	eax, ds:dword_4308C0
		test	eax, eax
		jnz	short loc_4271E2

loc_427179:				; CODE XREF: sub_427150+97j
		mov	eax, ds:dword_4308C0
		cmp	eax, 1
		jnz	short loc_427163
		mov	ds:dword_4308C0, 0
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_427163
; ---------------------------------------------------------------------------
		align 10h

loc_4271A0:				; CODE XREF: sub_427150+Aj
		mov	eax, ds:dword_4308C0
		test	eax, eax
		jz	short loc_4271D0

loc_4271A9:				; CODE XREF: sub_427150+90j
		mov	ds:dword_4308C0, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4271C0:				; CODE XREF: sub_427150+11j
		mov	eax, ds:dword_4308C0
		test	eax, eax
		jz	short loc_427163
		call	sub_426FB0
		jmp	short loc_427163
; ---------------------------------------------------------------------------

loc_4271D0:				; CODE XREF: sub_427150+57j
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_4271A9
; ---------------------------------------------------------------------------

loc_4271E2:				; CODE XREF: sub_427150+27j
		call	sub_426FB0
		jmp	short loc_427179
sub_427150	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4271F0	proc near		; CODE XREF: sub_401180+19p
					; sub_426730+3Cp

arg_0		= byte ptr  4

		push	ecx
		push	eax
		cmp	eax, 1000h
		lea	ecx, [esp+8+arg_0]
		jb	short loc_427212

loc_4271FD:				; CODE XREF: sub_4271F0+20j
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_4271FD

loc_427212:				; CODE XREF: sub_4271F0+Bj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		pop	eax
		pop	ecx
		retn
sub_4271F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_427220	proc near		; CODE XREF: sub_403F46+D9p
					; sub_414ABD+2F2p

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 2Ch
		mov	edx, [esp+2Ch+arg_C]
		mov	[esp+2Ch+var_C], esi
		mov	ecx, [esp+2Ch+arg_8]
		mov	esi, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_10], ebx
		mov	ebx, [esp+2Ch+arg_4]
		test	edx, edx
		mov	[esp+2Ch+var_8], edi
		mov	edi, ecx
		mov	[esp+2Ch+var_4], ebp
		mov	[esp+2Ch+var_24], esi
		jnz	short loc_427288
		cmp	ecx, ebx
		ja	short loc_4272B0
		test	ecx, ecx
		jnz	short loc_427260
		mov	eax, 1
		xor	edx, edx
		div	ecx
		mov	ecx, eax

loc_427260:				; CODE XREF: sub_427220+33j
		mov	eax, ebx
		xor	edx, edx
		div	ecx
		mov	ebx, eax
		mov	eax, esi
		div	ecx
		mov	ecx, ebx
		mov	esi, eax

loc_427270:				; CODE XREF: sub_427220+6Ej
					; sub_427220+80j ...
		mov	eax, esi
		mov	edx, ecx
		mov	ebx, [esp+2Ch+var_10]
		mov	esi, [esp+2Ch+var_C]
		mov	edi, [esp+2Ch+var_8]
		mov	ebp, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_427288:				; CODE XREF: sub_427220+2Bj
		xor	ecx, ecx
		xor	esi, esi
		cmp	edx, ebx
		ja	short loc_427270
		bsr	ebp, edx
		xor	ebp, 1Fh
		jnz	short loc_4272C0
		cmp	edi, [esp+2Ch+var_24]
		jbe	short loc_4272A2
		cmp	edx, ebx
		jnb	short loc_427270

loc_4272A2:				; CODE XREF: sub_427220+7Cj
		xor	ecx, ecx
		mov	esi, 1
		jmp	short loc_427270
; ---------------------------------------------------------------------------
		align 10h

loc_4272B0:				; CODE XREF: sub_427220+2Fj
		mov	eax, esi
		mov	edx, ebx
		div	ecx
		xor	ecx, ecx
		mov	esi, eax
		jmp	short loc_427270
; ---------------------------------------------------------------------------
		align 10h

loc_4272C0:				; CODE XREF: sub_427220+76j
		mov	eax, 20h
		mov	ecx, ebp
		sub	eax, ebp
		mov	esi, edi
		shl	edx, cl
		mov	ecx, eax
		shr	esi, cl
		mov	ecx, ebp
		or	esi, edx
		mov	edx, ebx
		mov	[esp+2Ch+var_20], esi
		mov	esi, [esp+2Ch+var_24]
		shl	edi, cl
		mov	ecx, eax
		shr	edx, cl
		mov	ecx, ebp
		shl	ebx, cl
		mov	ecx, eax
		shr	esi, cl
		or	esi, ebx
		mov	eax, esi
		div	[esp+2Ch+var_20]
		mov	ebx, edx
		mov	esi, eax
		mul	edi
		cmp	ebx, edx
		jb	short loc_42730F
		mov	edi, [esp+2Ch+var_24]
		mov	ecx, ebp
		shl	edi, cl
		cmp	edi, eax
		jnb	short loc_427312
		cmp	ebx, edx
		jnz	short loc_427312

loc_42730F:				; CODE XREF: sub_427220+DDj
		sub	esi, 1

loc_427312:				; CODE XREF: sub_427220+E9j
					; sub_427220+EDj
		xor	ecx, ecx
		jmp	loc_427270
sub_427220	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_427320	proc near		; CODE XREF: sub_414ABD+2C6p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 2Ch
		mov	[esp+2Ch+var_4], ebp
		mov	ebp, [esp+2Ch+arg_C]
		mov	eax, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_10], ebx
		mov	ecx, [esp+2Ch+arg_8]
		mov	ebx, [esp+2Ch+arg_4]
		test	ebp, ebp
		mov	[esp+2Ch+var_C], esi
		mov	esi, eax
		mov	[esp+2Ch+var_8], edi
		mov	edi, ecx
		mov	[esp+2Ch+var_24], eax
		mov	edx, ebx
		jnz	short loc_427370
		cmp	ecx, ebx
		jbe	short loc_427392
		div	ecx

loc_427357:				; CODE XREF: sub_427320+8Bj
		mov	eax, edx
		xor	edx, edx

loc_42735B:				; CODE XREF: sub_427320+70j
					; sub_427320+92j ...
		mov	ebx, [esp+2Ch+var_10]
		mov	esi, [esp+2Ch+var_C]
		mov	edi, [esp+2Ch+var_8]
		mov	ebp, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_427370:				; CODE XREF: sub_427320+2Fj
		cmp	ebp, ebx
		ja	short loc_4273B0
		bsr	eax, ebp
		xor	eax, 1Fh
		mov	[esp+2Ch+var_28], eax
		jnz	short loc_4273B4
		cmp	ecx, esi
		ja	loc_427448

loc_427388:				; CODE XREF: sub_427320+12Aj
		mov	edx, ebx
		sub	esi, ecx
		sbb	edx, ebp
		mov	eax, esi
		jmp	short loc_42735B
; ---------------------------------------------------------------------------

loc_427392:				; CODE XREF: sub_427320+33j
		test	ecx, ecx
		jnz	short loc_4273A1
		mov	eax, 1
		xor	edx, edx
		div	ecx
		mov	ecx, eax

loc_4273A1:				; CODE XREF: sub_427320+74j
		mov	eax, ebx
		xor	edx, edx
		div	ecx
		mov	eax, esi
		div	ecx
		jmp	short loc_427357
; ---------------------------------------------------------------------------
		align 10h

loc_4273B0:				; CODE XREF: sub_427320+52j
		mov	edx, ebx
		jmp	short loc_42735B
; ---------------------------------------------------------------------------

loc_4273B4:				; CODE XREF: sub_427320+5Ej
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		mov	esi, 20h
		mov	eax, ebp
		sub	esi, [esp+2Ch+var_28]
		mov	ebp, edi
		mov	edx, ebx
		shl	eax, cl
		mov	ecx, esi
		shr	ebp, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		or	ebp, eax
		mov	eax, [esp+2Ch+var_24]
		shl	edi, cl
		mov	ecx, esi
		shr	edx, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		mov	[esp+2Ch+var_20], edi
		shl	ebx, cl
		mov	ecx, esi
		shr	eax, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		or	eax, ebx
		mov	ebx, [esp+2Ch+var_24]
		div	ebp
		shl	ebx, cl
		mov	[esp+2Ch+var_24], ebx
		mov	ebx, edx
		mul	edi
		cmp	ebx, edx
		mov	edi, eax
		mov	ecx, edx
		jb	short loc_42743C
		cmp	[esp+2Ch+var_24], eax
		jb	short loc_427438

loc_427413:				; CODE XREF: sub_427320+11Aj
					; sub_427320+126j
		mov	eax, [esp+2Ch+var_24]
		sub	eax, edi
		sbb	ebx, ecx
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		mov	edx, ebx
		shr	eax, cl
		mov	ecx, esi
		shl	edx, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		or	eax, edx
		mov	edx, ebx
		shr	edx, cl
		jmp	loc_42735B
; ---------------------------------------------------------------------------

loc_427438:				; CODE XREF: sub_427320+F1j
		cmp	ebx, edx
		jnz	short loc_427413

loc_42743C:				; CODE XREF: sub_427320+EBj
		mov	ecx, edx
		mov	edi, eax
		sub	edi, [esp+2Ch+var_20]
		sbb	ecx, ebp
		jmp	short loc_427413
; ---------------------------------------------------------------------------

loc_427448:				; CODE XREF: sub_427320+62j
		cmp	ebp, ebx
		jb	loc_427388
		mov	eax, esi
		jmp	loc_42735B
sub_427320	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _fileno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _setmode]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _access]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _read]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _write]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _close]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _dup]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _getpid]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fdopen]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _putenv]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _tzset]
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_4274E0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4274E0	proc near		; CODE XREF: sub_401180+A7p
					; .text:004274D1j

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_4274E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame fpd=222h

sub_427500	proc near		; CODE XREF: sub_4276E0+A6p

Size		= dword	ptr -348h
lpFilename	= dword	ptr -344h
nSize		= dword	ptr -340h
uType		= dword	ptr -33Ch
var_338		= dword	ptr -338h
var_334		= dword	ptr -334h
Filename	= byte ptr -327h
var_323		= dword	ptr -323h
var_31F		= word ptr -31Fh
var_223		= byte ptr -223h
var_222		= word ptr -222h
var_11D		= dword	ptr -11Dh
var_119		= dword	ptr -119h
var_115		= word ptr -115h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 33Ch
		mov	esi, [esp+348h+arg_0]
		lea	ebp, [esp+126h]
		mov	ebx, [esp+348h+arg_4]
		mov	[esp+348h+Size], 2000h ; Size
		call	malloc
		test	esi, esi
		lea	ecx, [esi+208h]
		mov	edi, eax
		mov	eax, ebp
		jnz	short loc_42754C
		jmp	short loc_427554
; ---------------------------------------------------------------------------
		align 10h

loc_427540:				; CODE XREF: sub_427500+52j
		add	esi, 2
		mov	[eax], dl
		add	eax, 1
		cmp	esi, ecx
		jz	short loc_427554

loc_42754C:				; CODE XREF: sub_427500+37j
		movzx	edx, word ptr [esi]
		test	dx, dx
		jnz	short loc_427540

loc_427554:				; CODE XREF: sub_427500+39j
					; sub_427500+4Aj
		lea	esi, [esp+348h+var_11D]
		test	ebx, ebx
		mov	byte ptr [eax],	0
		lea	ecx, [ebx+208h]
		mov	eax, esi
		jnz	short loc_42757C
		jmp	short loc_427584
; ---------------------------------------------------------------------------
		align 10h

loc_427570:				; CODE XREF: sub_427500+82j
		add	ebx, 2
		mov	[eax], dl
		add	eax, 1
		cmp	ebx, ecx
		jz	short loc_427584

loc_42757C:				; CODE XREF: sub_427500+68j
		movzx	edx, word ptr [ebx]
		test	dx, dx
		jnz	short loc_427570

loc_427584:				; CODE XREF: sub_427500+6Aj
					; sub_427500+7Aj
		mov	byte ptr [eax],	0
		cmp	byte ptr [esp+348h+var_11D], 0
		jz	loc_427640
		cmp	byte ptr [esp+348h+var_222], 0
		jz	loc_42766E

loc_4275A3:				; CODE XREF: sub_427500+168j
					; sub_427500+178j
		lea	ebx, [esp+348h+Filename]
		mov	[esp+348h+var_223], 0
		mov	[esp+348h+nSize], 104h ; nSize
		mov	[esp+348h+lpFilename], ebx ; lpFilename
		mov	[esp+348h+Size], 0 ; hModule
		call	ds:GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_427680

loc_4275D3:				; CODE XREF: sub_427500+197j
		mov	eax, [esp+348h+arg_8]
		mov	[esp+348h+var_334], ebp
		mov	[esp+348h+uType], esi
		mov	[esp+348h+nSize], ebx
		mov	[esp+348h+var_338], eax
		mov	[esp+348h+lpFilename], offset aAssertionFaile ;	"Assertion failed!\n\nProgram: %s\nFile:"...
		mov	[esp+348h+Size], edi ; Dest
		call	sprintf
		mov	eax, ds:dword_430544
		test	eax, eax
		jz	loc_4276B9
		mov	[esp+348h+uType], 12012h ; uType
		mov	[esp+348h+nSize], offset Caption ; "MinGW Runtime Assertion"
		mov	[esp+348h+lpFilename], edi ; lpText
		mov	[esp+348h+Size], 0 ; hWnd
		call	ds:MessageBoxA
		sub	esp, 10h
		cmp	eax, 3
		jz	short loc_4276A1
		cmp	eax, 5
		jnz	short loc_42769C
		add	esp, 33Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_427640:				; CODE XREF: sub_427500+8Fj
		cmp	byte ptr [esp+348h+var_222], 0
		mov	[esp+348h+var_11D], 6B6E753Ch
		mov	[esp+348h+var_119], 6E776F6Eh
		mov	[esp+348h+var_115], 3Eh
		jnz	loc_4275A3

loc_42766E:				; CODE XREF: sub_427500+9Dj
		mov	[esp+348h+var_222], 3Fh
		jmp	loc_4275A3
; ---------------------------------------------------------------------------
		align 10h

loc_427680:				; CODE XREF: sub_427500+CDj
		mov	dword ptr [esp+348h+Filename], 6B6E753Ch
		mov	[esp+348h+var_323], 6E776F6Eh
		mov	[esp+348h+var_31F], 3Eh
		jmp	loc_4275D3
; ---------------------------------------------------------------------------

loc_42769C:				; CODE XREF: sub_427500+133j
		call	abort
; ---------------------------------------------------------------------------

loc_4276A1:				; CODE XREF: sub_427500+12Ej
		mov	[esp+348h+Size], 16h
		call	raise
		mov	[esp+348h+Size], 3 ; Code
		call	_exit
; ---------------------------------------------------------------------------

loc_4276B9:				; CODE XREF: sub_427500+101j
		mov	eax, ds:_iob
		mov	[esp+348h+nSize], edi
		mov	[esp+348h+lpFilename], offset aS_3 ; "%s\n"
		add	eax, 40h
		mov	[esp+348h+Size], eax ; File
		call	fprintf
		call	abort
sub_427500	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4276E0(char *, char *, int)
sub_4276E0	proc near		; CODE XREF: sub_4015D2+A5p
					; sub_4015D2+F9p ...

Str		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Memory		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [esp+3Ch+arg_0]
		mov	edx, [esp+3Ch+arg_8]
		mov	esi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+Str], edi ; Str
		mov	[esp+3Ch+var_20], edx
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		mov	[esp+3Ch+Str], esi ; Str
		mov	ebx, eax
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		movzx	ecx, byte ptr [edi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_427746
		xor	ebp, ebp
		lea	esi, [esi+0]

loc_427730:				; CODE XREF: sub_4276E0+62j
		add	edx, 1
		movzx	ecx, cl
		mov	[ebx+ebp*2], cx
		movzx	ecx, byte ptr [edi+edx]
		mov	ebp, edx
		test	cl, cl
		jnz	short loc_427730
		add	edx, edx

loc_427746:				; CODE XREF: sub_4276E0+48j
		mov	word ptr [ebx+edx], 0
		movzx	ecx, byte ptr [esi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_42776D
		xor	edi, edi

loc_427757:				; CODE XREF: sub_4276E0+89j
		add	edx, 1
		movzx	ecx, cl
		mov	[eax+edi*2], cx
		movzx	ecx, byte ptr [esi+edx]
		mov	edi, edx
		test	cl, cl
		jnz	short loc_427757
		add	edx, edx

loc_42776D:				; CODE XREF: sub_4276E0+73j
		mov	word ptr [eax+edx], 0
		mov	edx, [esp+3Ch+var_20]
		mov	[esp+3Ch+var_38], eax
		mov	[esp+3Ch+Memory], eax
		mov	[esp+3Ch+Str], ebx
		mov	[esp+3Ch+var_34], edx
		call	sub_427500
		mov	[esp+3Ch+Str], ebx ; Memory
		call	free
		mov	eax, [esp+3Ch+Memory]
		mov	[esp+3Ch+arg_0], eax ; Memory
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		jmp	free
sub_4276E0	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000005 BYTES: COLLAPSED FUNCTION j__lseeki64]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_4277C0	proc near		; CODE XREF: sub_41699E+Dp
					; .text:00416A9Ap ...
		jmp	sub_427E30
sub_4277C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_4277D0	proc near		; CODE XREF: sub_4169F8+26p
					; .text:00416FEEp ...
		jmp	sub_427E40
sub_4277D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_4277E0	proc near		; CODE XREF: .text:00416CE8p
					; sub_425C1E+2Dp
		jmp	sub_427E50
sub_4277E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_4277F0	proc near		; CODE XREF: .text:00417367p
					; sub_420526+AAp
		jmp	sub_427E60
sub_4277F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_427800(FILE *)
sub_427800	proc near		; CODE XREF: .text:00427D0Bp

File		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 2Ch
		mov	[esp+2Ch+var_C], ebx
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_8], esi
		mov	[esp+2Ch+var_4], edi
		mov	eax, [ebx+0Ch]
		mov	edx, eax
		and	edx, 3
		cmp	edx, 2
		jz	short loc_427840

loc_427820:				; CODE XREF: sub_427800+94j
					; sub_427800+9Cj
		mov	edi, [ebx+8]
		xor	eax, eax

loc_427825:				; CODE XREF: sub_427800+A7j
					; sub_427800+BCj
		mov	[ebx], edi
		mov	esi, [esp+2Ch+var_8]
		mov	dword ptr [ebx+4], 0
		mov	edi, [esp+2Ch+var_4]
		mov	ebx, [esp+2Ch+var_C]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_427840:				; CODE XREF: sub_427800+1Ej
		test	eax, 108h
		mov	edi, [ebx+8]
		jz	short loc_4278A5
		mov	esi, [ebx]
		sub	esi, edi
		mov	eax, esi
		sar	eax, 1Fh
		mov	[esp+2Ch+var_10], eax
		cmp	[esp+2Ch+var_10], 0
		mov	[esp+2Ch+var_14], esi
		jl	short loc_4278A5
		jle	short loc_4278A0

loc_427864:				; CODE XREF: sub_427800+A3j
		mov	[esp+2Ch+File],	ebx ; File
		call	_fileno_0
		mov	[esp+2Ch+var_24], esi
		mov	[esp+2Ch+var_28], edi
		mov	[esp+2Ch+File],	eax
		call	_write_0
		mov	ecx, eax
		mov	edx, eax
		mov	eax, [esp+2Ch+var_10]
		sar	edx, 1Fh
		xor	esi, ecx
		xor	eax, edx
		or	eax, esi
		jnz	short loc_4278B0
		mov	eax, [ebx+0Ch]
		test	al, 80h
		jz	short loc_427820
		and	eax, 0FFFFFFFDh
		mov	[ebx+0Ch], eax
		jmp	short loc_427820
; ---------------------------------------------------------------------------
		align 10h

loc_4278A0:				; CODE XREF: sub_427800+62j
		cmp	esi, 0
		ja	short loc_427864

loc_4278A5:				; CODE XREF: sub_427800+48j
					; sub_427800+60j
		xor	eax, eax
		jmp	loc_427825
; ---------------------------------------------------------------------------
		align 10h

loc_4278B0:				; CODE XREF: sub_427800+8Dj
		or	dword ptr [ebx+0Ch], 20h
		mov	eax, 0FFFFFFFFh
		mov	edi, [ebx+8]
		jmp	loc_427825
sub_427800	endp

; ---------------------------------------------------------------------------
		jmp	short sub_4278D0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4278D0(FILE *, int, int, int)
sub_4278D0	proc near		; CODE XREF: .text:0041BB06p
					; .text:004278C1j

File		= dword	ptr -3Ch
Pos		= dword	ptr -38h
var_24		= qword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 3Ch
		mov	eax, [esp+3Ch+arg_C]
		mov	[esp+3Ch+var_C], esi
		mov	esi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+var_8], edi
		mov	edi, [esp+3Ch+arg_8]
		mov	[esp+3Ch+var_4], ebp
		mov	ebp, [esp+3Ch+arg_0]
		cmp	eax, 1
		mov	[esp+3Ch+var_10], ebx
		jz	short loc_427930
		cmp	eax, 2
		jz	short loc_427955
		test	eax, eax
		jnz	short loc_427980
		mov	dword ptr [esp+3Ch+var_24], esi
		lea	ebx, [esp+3Ch+var_24]
		mov	dword ptr [esp+3Ch+var_24+4], edi

loc_42790D:				; CODE XREF: sub_4278D0+83j
					; sub_4278D0+ADj
		mov	[esp+3Ch+Pos], ebx ; Pos
		mov	[esp+3Ch+File],	ebp ; File
		call	fsetpos

loc_427919:				; CODE XREF: sub_4278D0+79j
					; sub_4278D0+C0j
		mov	ebx, [esp+3Ch+var_10]
		mov	esi, [esp+3Ch+var_C]
		mov	edi, [esp+3Ch+var_8]
		mov	ebp, [esp+3Ch+var_4]
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_427930:				; CODE XREF: sub_4278D0+26j
		lea	ebx, [esp+3Ch+var_24]
		mov	[esp+3Ch+Pos], ebx ; Pos
		mov	[esp+3Ch+File],	ebp ; File
		call	fgetpos
		mov	edx, eax
		mov	eax, 0FFFFFFFFh
		test	edx, edx
		jnz	short loc_427919
		add	dword ptr [esp+3Ch+var_24], esi
		adc	dword ptr [esp+3Ch+var_24+4], edi
		jmp	short loc_42790D
; ---------------------------------------------------------------------------

loc_427955:				; CODE XREF: sub_4278D0+2Bj
		mov	[esp+3Ch+File],	ebp ; File
		lea	ebx, [esp+3Ch+var_24]
		call	fflush
		mov	[esp+3Ch+File],	ebp ; File
		call	_fileno_0
		mov	[esp+3Ch+File],	eax
		call	_filelengthi64
		add	eax, esi
		adc	edx, edi
		mov	dword ptr [esp+3Ch+var_24], eax
		mov	dword ptr [esp+3Ch+var_24+4], edx
		jmp	short loc_42790D
; ---------------------------------------------------------------------------
		align 10h

loc_427980:				; CODE XREF: sub_4278D0+2Fj
		call	_errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short loc_427919
sub_4278D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4279A0(FILE *)
sub_4279A0	proc near		; CODE XREF: .text:00427D74p

File		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 5Ch
		mov	[esp+5Ch+var_10], ebx
		mov	ebx, [esp+5Ch+arg_0]
		mov	[esp+5Ch+var_C], esi
		mov	[esp+5Ch+var_8], edi
		mov	[esp+5Ch+var_4], ebp
		call	_errno
		mov	dword ptr [eax], 0
		mov	[esp+5Ch+File],	ebx ; File
		call	_fileno_0
		mov	[esp+5Ch+var_3C], eax
		mov	eax, [ebx+4]
		test	eax, eax
		js	loc_427B60

loc_4279D9:				; CODE XREF: sub_4279A0+1C7j
		mov	eax, [esp+5Ch+var_3C]
		mov	[esp+5Ch+var_50], 1
		mov	[esp+5Ch+var_58], 0
		mov	[esp+5Ch+var_54], 0
		mov	[esp+5Ch+File],	eax
		call	_lseeki64
		test	edx, edx
		mov	esi, eax
		mov	edi, edx
		js	loc_427B84
		mov	ecx, [ebx+0Ch]
		test	ecx, 108h
		jz	loc_427B34
		mov	eax, [ebx]
		mov	[esp+5Ch+var_34], eax
		mov	eax, [ebx+8]
		mov	edx, [esp+5Ch+var_34]
		sub	edx, eax
		test	cl, 3
		mov	[esp+5Ch+var_28], edx
		jnz	loc_427AC5
		test	cl, 80h
		jz	loc_427C80
		mov	ebp, [esp+5Ch+var_28]

loc_427A41:				; CODE XREF: sub_4279A0+156j
					; sub_4279A0+160j ...
		mov	eax, edi
		or	eax, esi
		jz	loc_427B70
		and	ecx, 1
		jz	loc_427B76
		mov	eax, [ebx+4]
		xor	edx, edx
		xor	ecx, ecx
		mov	[esp+5Ch+var_34], 0
		mov	[esp+5Ch+var_30], 0
		test	eax, eax
		jz	short loc_427AB8
		mov	ecx, [esp+5Ch+var_28]
		mov	edx, [esp+5Ch+var_3C]
		add	ecx, eax
		mov	eax, [esp+5Ch+var_3C]
		sar	edx, 5
		mov	[esp+5Ch+var_28], edx
		and	eax, 1Fh
		lea	eax, [eax+eax*4]
		shl	eax, 3
		mov	[esp+5Ch+var_34], eax
		mov	eax, ds:__pioinfo
		mov	eax, [eax+edx*4]
		mov	edx, [esp+5Ch+var_34]
		cmp	byte ptr [eax+edx+4], 0
		js	loc_427B90

loc_427AA8:				; CODE XREF: sub_4279A0+255j
		mov	[esp+5Ch+var_34], ecx
		mov	edx, ebp
		xor	ecx, ecx
		mov	[esp+5Ch+var_30], 0

loc_427AB8:				; CODE XREF: sub_4279A0+CDj
					; sub_4279A0+26Ej ...
		sub	esi, [esp+5Ch+var_34]
		sbb	edi, [esp+5Ch+var_30]
		jmp	loc_427B7A
; ---------------------------------------------------------------------------

loc_427AC5:				; CODE XREF: sub_4279A0+8Ej
		mov	edx, [esp+5Ch+var_3C]
		mov	ebp, [esp+5Ch+var_3C]
		and	edx, 1Fh
		lea	edx, [edx+edx*4]
		shl	edx, 3
		mov	[esp+5Ch+var_24], edx
		mov	edx, ds:__pioinfo
		sar	ebp, 5
		mov	edx, [edx+ebp*4]
		add	[esp+5Ch+var_24], edx
		mov	edx, [esp+5Ch+var_24]
		mov	ebp, [esp+5Ch+var_28]
		cmp	byte ptr [edx+4], 0
		jns	loc_427A41
		cmp	[esp+5Ch+var_34], eax
		jbe	loc_427A41
		mov	[esp+5Ch+var_24], esi
		mov	esi, ecx
		mov	ecx, [esp+5Ch+var_34]
		mov	[esp+5Ch+var_20], edi

loc_427B14:				; CODE XREF: sub_4279A0+183j
		xor	edx, edx
		cmp	byte ptr [eax],	0Ah
		setz	dl
		add	eax, 1
		add	ebp, edx
		cmp	eax, ecx
		jnz	short loc_427B14
		mov	ecx, esi
		mov	edi, [esp+5Ch+var_20]
		mov	esi, [esp+5Ch+var_24]
		jmp	loc_427A41
; ---------------------------------------------------------------------------

loc_427B34:				; CODE XREF: sub_4279A0+72j
		mov	eax, [ebx+4]
		mov	ecx, esi
		mov	ebx, edi
		mov	edx, eax
		sar	edx, 1Fh
		sub	ecx, eax
		sbb	ebx, edx
		mov	eax, ecx
		mov	edx, ebx

loc_427B48:				; CODE XREF: sub_4279A0+1D4j
					; sub_4279A0+1E2j ...
		mov	ebx, [esp+5Ch+var_10]
		mov	esi, [esp+5Ch+var_C]
		mov	edi, [esp+5Ch+var_8]
		mov	ebp, [esp+5Ch+var_4]
		add	esp, 5Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_427B60:				; CODE XREF: sub_4279A0+33j
		mov	dword ptr [ebx+4], 0
		jmp	loc_4279D9
; ---------------------------------------------------------------------------
		align 10h

loc_427B70:				; CODE XREF: sub_4279A0+A5j
		mov	eax, ebp
		xor	edx, edx
		jmp	short loc_427B48
; ---------------------------------------------------------------------------

loc_427B76:				; CODE XREF: sub_4279A0+AEj
		mov	edx, ebp
		xor	ecx, ecx

loc_427B7A:				; CODE XREF: sub_4279A0+120j
		mov	eax, edx
		mov	edx, ecx
		add	eax, esi
		adc	edx, edi
		jmp	short loc_427B48
; ---------------------------------------------------------------------------

loc_427B84:				; CODE XREF: sub_4279A0+63j
		mov	eax, 0FFFFFFFFh
		mov	edx, 0FFFFFFFFh
		jmp	short loc_427B48
; ---------------------------------------------------------------------------

loc_427B90:				; CODE XREF: sub_4279A0+102j
		mov	eax, [esp+5Ch+var_3C]
		mov	[esp+5Ch+var_40], ecx
		mov	[esp+5Ch+var_50], 2
		mov	[esp+5Ch+var_58], 0
		mov	[esp+5Ch+var_54], 0
		mov	[esp+5Ch+File],	eax
		call	_lseeki64
		mov	ecx, [esp+5Ch+var_40]
		xor	edx, edi
		xor	eax, esi
		or	edx, eax
		jnz	short loc_427C13
		mov	edx, [ebx+8]
		lea	eax, [edx+ecx]
		cmp	edx, eax
		jnb	short loc_427BF1
		mov	[esp+5Ch+var_3C], esi
		mov	esi, eax
		mov	[esp+5Ch+var_38], edi

loc_427BD8:				; CODE XREF: sub_4279A0+247j
		xor	eax, eax
		cmp	byte ptr [edx],	0Ah
		setz	al
		add	edx, 1
		add	ecx, eax
		cmp	edx, esi
		jnz	short loc_427BD8
		mov	esi, [esp+5Ch+var_3C]
		mov	edi, [esp+5Ch+var_38]

loc_427BF1:				; CODE XREF: sub_4279A0+22Cj
		test	byte ptr [ebx+0Dh], 20h
		jz	loc_427AA8
		lea	eax, [ecx+1]
		mov	edx, ebp
		mov	[esp+5Ch+var_34], eax
		xor	ecx, ecx
		mov	[esp+5Ch+var_30], 0
		jmp	loc_427AB8
; ---------------------------------------------------------------------------

loc_427C13:				; CODE XREF: sub_4279A0+222j
		mov	eax, [esp+5Ch+var_3C]
		mov	[esp+5Ch+var_40], ecx
		mov	[esp+5Ch+var_50], 0
		mov	[esp+5Ch+var_58], esi
		mov	[esp+5Ch+var_54], edi
		mov	[esp+5Ch+File],	eax
		call	_lseeki64
		mov	ecx, [esp+5Ch+var_40]
		cmp	ecx, 200h
		ja	short loc_427C51
		mov	eax, [ebx+0Ch]
		mov	edx, 200h
		and	eax, 408h
		cmp	eax, 8
		jz	short loc_427C54

loc_427C51:				; CODE XREF: sub_4279A0+29Dj
		mov	edx, [ebx+18h]

loc_427C54:				; CODE XREF: sub_4279A0+2AFj
		mov	eax, ds:__pioinfo
		mov	ecx, [esp+5Ch+var_28]
		mov	ebx, [esp+5Ch+var_34]
		mov	eax, [eax+ecx*4]
		test	byte ptr [eax+ebx+4], 4
		jnz	short loc_427C9A
		mov	[esp+5Ch+var_34], edx
		xor	ecx, ecx
		mov	edx, ebp
		mov	[esp+5Ch+var_30], 0
		jmp	loc_427AB8
; ---------------------------------------------------------------------------

loc_427C80:				; CODE XREF: sub_4279A0+97j
		call	_errno
		mov	edx, 0FFFFFFFFh
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	loc_427B48
; ---------------------------------------------------------------------------

loc_427C9A:				; CODE XREF: sub_4279A0+2C9j
		lea	eax, [edx+1]
		xor	ecx, ecx
		mov	[esp+5Ch+var_34], eax
		mov	edx, ebp
		mov	[esp+5Ch+var_30], 0
		jmp	loc_427AB8
sub_4279A0	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 2Ch
		mov	[esp+1Ch], ebx
		mov	ebx, [esp+30h]
		mov	[esp+20h], esi
		mov	esi, [esp+3Ch]
		mov	[esp+24h], edi
		mov	edi, [esp+34h]
		mov	[esp+28h], ebp
		mov	ebp, [esp+38h]
		call	_errno
		cmp	esi, 2
		mov	dword ptr [eax], 0
		ja	loc_427D85
		test	ebx, ebx
		jz	loc_427D85
		and	dword ptr [ebx+0Ch], 0FFFFFFEFh
		cmp	esi, 1
		jz	short loc_427D71

loc_427D08:				; CODE XREF: .text:00427D80j
		mov	[esp], ebx
		call	sub_427800
		mov	eax, [ebx+0Ch]
		test	al, 80h
		jnz	short loc_427D60
		and	eax, 409h
		cmp	eax, 9
		jz	short loc_427D68

loc_427D21:				; CODE XREF: .text:00427D66j
					; .text:00427D6Fj
		mov	[esp], ebx
		call	_fileno_0
		mov	[esp+0Ch], esi
		mov	[esp+4], edi
		mov	[esp+8], ebp
		mov	[esp], eax
		call	_lseeki64
		and	eax, edx
		not	eax
		cmp	eax, 1
		sbb	eax, eax

loc_427D46:				; CODE XREF: .text:00427D95j
		mov	ebx, [esp+1Ch]
		mov	esi, [esp+20h]
		mov	edi, [esp+24h]
		mov	ebp, [esp+28h]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_427D60:				; CODE XREF: .text:00427D15j
		and	eax, 0FFFFFFFCh
		mov	[ebx+0Ch], eax
		jmp	short loc_427D21
; ---------------------------------------------------------------------------

loc_427D68:				; CODE XREF: .text:00427D1Fj
		mov	dword ptr [ebx+18h], 200h
		jmp	short loc_427D21
; ---------------------------------------------------------------------------

loc_427D71:				; CODE XREF: .text:00427D06j
		mov	[esp], ebx
		call	sub_4279A0
		add	edi, eax
		adc	ebp, edx
		xor	si, si
		jmp	loc_427D08
; ---------------------------------------------------------------------------

loc_427D85:				; CODE XREF: .text:00427CF1j
					; .text:00427CF9j
		call	_errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short loc_427D46
; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 4
		mov	esi, [esp+10h]
		call	__doserrno
		mov	[eax], esi
		jmp	short loc_427DC1
; ---------------------------------------------------------------------------

loc_427DB4:				; CODE XREF: .text:00427DC8j
		add	ebx, 1
		cmp	ds:dword_42F064[ebx*8],	0FFFFFFFFh
		jz	short loc_427DE0

loc_427DC1:				; CODE XREF: .text:00427DB2j
		cmp	ds:dword_42F060[ebx*8],	esi
		jnz	short loc_427DB4
		call	_errno
		mov	edx, ds:dword_42F064[ebx*8]
		mov	[eax], edx
		add	esp, 4
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_427DE0:				; CODE XREF: .text:00427DBFj
		lea	eax, [esi-13h]
		cmp	eax, 11h
		jbe	short loc_427E15
		sub	esi, 0BCh
		cmp	esi, 0Eh
		jbe	short loc_427E04
		call	_errno
		mov	dword ptr [eax], 16h
		add	esp, 4
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_427E04:				; CODE XREF: .text:00427DF1j
		call	_errno
		mov	dword ptr [eax], 8
		add	esp, 4
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_427E15:				; CODE XREF: .text:00427DE6j
		call	_errno
		mov	dword ptr [eax], 0Dh
		add	esp, 4
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_427E30	proc near		; CODE XREF: sub_4277C0j
		mov	eax, ds:time
		jmp	eax
sub_427E30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_427E40	proc near		; CODE XREF: sub_4277D0j
		mov	eax, ds:gmtime
		jmp	eax
sub_427E40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_427E50	proc near		; CODE XREF: sub_4277E0j
		mov	eax, ds:mktime
		jmp	eax
sub_427E50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_427E60	proc near		; CODE XREF: sub_4277F0j
		mov	eax, ds:localtime
		jmp	eax
sub_427E60	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __getmainargs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __set_app_type]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _cexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _errno]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fread]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ferror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strerror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fopen]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fclose]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION printf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION putchar]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcmp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION remove]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strtoul]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memmove]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION sprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fflush]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fputs]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION putc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcspn]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION getenv]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strrchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION realloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION memset]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fseek]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ftell]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memchr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION atoi]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strftime]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION clearerr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION setlocale]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strpbrk]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION rewind]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION setvbuf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncpy]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION getc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strtol]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strstr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION puts]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcat]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION signal]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __setusermatherr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION raise]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _lseeki64]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _fileno_0]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _write_0]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fsetpos]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fgetpos]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _filelengthi64]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __doserrno]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4280A0	proc near		; DATA XREF: .text:004280C4o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4014F0
		mov	[esp+18h+var_18], offset sub_401540 ; _onexit_t
		call	sub_426210
		leave
		retn
sub_4280A0	endp

; ---------------------------------------------------------------------------
		align 10h
dword_4280C0	dd 0FFFFFFFFh		; DATA XREF: sub_426E30-4Cr
					; sub_426E30:loc_426DF3r ...
		dd offset sub_4280A0
		dd 0
		dd 0FFFFFFFFh
dword_4280D0	dd 4Ch dup(0)		; DATA XREF: .data:off_429304o
		dd 380h	dup(?)
_text		ends

; Section 2. (virtual address 00029000)
; Virtual size			: 0000031C (	796.)
; Section size in file		: 00000400 (   1024.)
; Offset to raw	data for section: 00027600
; Flags	C0600040: Data Readable	Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 429000h
dword_429000	dd 12Ch, 2 dup(0)	; DATA XREF: sub_4032E3:loc_4035FDo
		dd offset a@commands	; "@Commands:\n	"
		dd 70h,	42A051h, 80h, 42A059h, 75h, 42A06Fh, 80h, 42A079h
		dd 1F5h, 42A091h, 80h, 42A098h,	1F6h, 42A0BFh, 80h, 42A0D0h
		dd 1F7h, 42A0E7h, 80h, 42A0F4h,	1FAh, 42A107h, 80h, 42A114h
		dd 1FBh, 42A139h, 80h, 42A144h,	1F8h, 42A169h, 80h, 42A179h
		dd 12Dh, 2 dup(0)
		dd offset a@Options	; "@\nOptions:\n "
		dd 76h,	42A188h, 0
		dd offset aVerbose	; "verbose"
		dd 61h,	42A190h, 0
		dd offset aWriteOutputInA ; "write output in advanced format"
		dd 1F9h, 42A1B8h, 0
		dd offset aWriteOutputInC ; "write output in canonical format"
		dd 50h,	42A1E5h, 2, 42A1F0h, 1FCh, 42A20Eh, 2, 42A21Ch
		dd 1FFh, 42A253h, 0
		dd offset aCertificateToE ; "certificate to export provided on STDIN"
		dd 1FDh, 42A288h, 0
		dd offset aStoreTheCreate ; "store the created key in the appropriat"...
		dd 1FEh, 42A2BFh, 0
		dd offset aForceOverwriti ; "force overwriting"
		dd 200h, 42A2D7h, 0
		dd offset a@		; "@"
		dd 201h, 42A2E8h, 2, 42A179h, 202h, 42A2F0h, 2,	42A2F8h
		dd 203h, 42A327h, 0
		dd offset a@		; "@"
		dd 204h, 42A339h, 2, 42A179h, 4	dup(0)
off_429180	dd offset aRsa_0	; DATA XREF: sub_404830+158o
					; sub_404830+170o ...
					; "rsa"
		dd offset aNedpqu_0	; "nedpqu"
		dd 2, 5
dword_429190	dd 0			; DATA XREF: sub_404830+2CDo
		dd offset aDsa		; "dsa"
		dd offset aPqgyx	; "pqgyx"
		dd 2 dup(4), 0
		dd offset aElg		; "elg"
		dd offset aPgyx		; "pgyx"
		dd 2 dup(3), 0
		dd offset aEcdsa	; "ecdsa"
		dd offset aPabgnqd	; "pabgnqd"
		dd 2 dup(6), 1,	42AC24h, 42AC1Ch, 2 dup(6), 1, 42AC29h
		dd 42AC1Ch, 2 dup(6), 1, 0Ah dup(0)
byte_429220	db 41h			; DATA XREF: sub_40B283+1D6r
					; sub_40B283+201r ...
		db 42h,	43h, 44h
		dd 48474645h, 4C4B4A49h, 504F4E4Dh, 54535251h, 58575655h
		dd 62615A59h, 66656463h, 6A696867h, 6E6D6C6Bh, 7271706Fh
		dd 76757473h, 7A797877h, 33323130h, 37363534h, 2F2B3938h
; LPCSTR off_429260
off_429260	dd offset aShell32_dll	; DATA XREF: sub_40BF91+30r
					; sub_40BF91+90r
					; "shell32.dll"
		dd offset aShfolder_dll	; "shfolder.dll"
		align 20h
off_429280	dd offset Str2		; DATA XREF: sub_40CFD9+46r
					; "GPG_TTY"
off_429284	dd offset aTtyname	; DATA XREF: sub_40CFD9+37r
					; "ttyname"
		dd offset aTerm		; "TERM"
		dd offset aTtytype	; "ttytype"
		dd offset aDisplay	; "DISPLAY"
		dd offset aDisplay_0	; "display"
		dd offset aXauthority	; "XAUTHORITY"
		dd offset aXauthority_0	; "xauthority"
		dd offset aXmodifiers	; "XMODIFIERS"
		align 8
		dd offset aGtk_im_module ; "GTK_IM_MODULE"
		align 10h
		dd offset aQt_im_module	; "QT_IM_MODULE"
		align 8
		dd offset aPinentry_user_ ; "PINENTRY_USER_DATA"
		dd offset aPinentryUserDa ; "pinentry-user-data"
off_4292C0	dd offset sub_40F0BF	; DATA XREF: sub_410D56+8Er
					; .text:004115D1r ...
off_4292C4	dd offset sub_40F13F	; DATA XREF: sub_410D56+98r
					; .text:004115DBr ...
off_4292C8	dd offset sub_40F3C3	; DATA XREF: sub_410D56+A2r
					; .text:004115E5r ...
off_4292CC	dd offset sub_40F648	; DATA XREF: sub_410D56+ACr
					; .text:004115EFr ...
off_4292D0	dd offset sub_40F6E5	; DATA XREF: sub_411413+83r
					; sub_4118BC+7Br ...
off_4292D4	dd offset sub_40F73B	; DATA XREF: sub_411413+8Dr
					; sub_4118BC+85r ...
off_4292D8	dd offset sub_40F790	; DATA XREF: sub_411413+97r
					; sub_4118BC+8Fr ...
off_4292DC	dd offset sub_40F822	; DATA XREF: sub_411413+A1r
					; sub_411413+103r ...
off_4292E0	dd offset sub_40F8F1	; DATA XREF: sub_4119F1+A5r
off_4292E4	dd offset sub_40F958	; DATA XREF: sub_4119F1+AFr
off_4292E8	dd offset sub_40F9AF	; DATA XREF: sub_4119F1+B9r
off_4292EC	dd offset sub_40FA39	; DATA XREF: sub_4119F1+C3r
					; sub_4119F1+F5r
dword_4292F0	dd 0FFFFFFFFh		; DATA XREF: sub_420105:loc_42028Bw
					; .text:loc_4204BFr ...
; char off_4292F4[]
off_4292F4	dd offset aIso88591	; DATA XREF: sub_42478C+D9w
					; sub_42488B:loc_424A60w ...
					; "iso-8859-1"
		dd 0FFh, 2 dup(0FFFFFFFFh)
off_429304	dd offset dword_4280D0	; DATA XREF: sub_426DB0+3r
					; sub_426DB0+12r ...
dword_429308	dd 2			; DATA XREF: TlsCallback_0+13r
					; TlsCallback_0+1Cw ...
dword_42930C	dd 0FFFFFFFFh		; DATA XREF: sub_401060+7Ar
dword_429310	dd 0BB40E64Eh		; DATA XREF: sub_426E50+3r
					; sub_426E50:loc_426F02w ...
dword_429314	dd 44BF19B1h		; DATA XREF: sub_426E50+31w
					; sub_426E50+B8w ...
dword_429318	dd 0			; DATA XREF: sub_4014F0+6r
					; sub_4014F0+42o
		align 1000h
_data		ends

; Section 3. (virtual address 0002A000)
; Virtual size			: 000051E0 (  20960.)
; Section size in file		: 00005200 (  20992.)
; Offset to raw	data for section: 00027A00
; Flags	40600040: Data Readable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment '32byte' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 42A000h
; CHAR ProcName[]
ProcName	db '_set_invalid_parameter_handler',0 ; DATA XREF: sub_401180+137o
		align 10h
; CHAR ModuleName[]
ModuleName	db 'libgcj-12.dll',0    ; DATA XREF: sub_4014F0+Fo
; CHAR a_jv_registercl[]
a_jv_registercl	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_4014F0+28o
		align 4
a@commands	db '@Commands:',0Ah     ; DATA XREF: .data:0042900Co
		db ' ',0
aProtect	db 'protect',0
aProtectAPrivat	db 'protect a private key',0
aUnprotect	db 'unprotect',0
aUnprotectAPriv	db 'unprotect a private key',0
aShadow		db 'shadow',0
aCreateAShadowE	db 'create a shadow entry for a public key',0
aShowShadowInfo	db 'show-shadow-info',0
aReturnTheShado	db 'return the shadow info',0
aShowKeygrip	db 'show-keygrip',0
aShowTheKeygrip	db 'show the "keygrip"',0
aP12Import	db 'p12-import',0
		align 4
aImportAPkcs12E	db 'import a pkcs#12 encoded private key',0
aP12Export	db 'p12-export',0
aExportAPrivate	db 'export a private key pkcs#12 encoded',0
aS2kCalibrati_1	db 's2k-calibration',0
a@		db '@',0                ; DATA XREF: .data:0042912Co
					; .data:0042915Co
a@Options	db '@',0Ah              ; DATA XREF: .data:0042909Co
		db 'Options:',0Ah
		db ' ',0
aVerbose	db 'verbose',0          ; DATA XREF: .data:004290ACo
aArmor		db 'armor',0
		align 4
aWriteOutputInA	db 'write output in advanced format',0 ; DATA XREF: .data:004290BCo
aCanonical	db 'canonical',0
		align 4
aWriteOutputInC	db 'write output in canonical format',0 ; DATA XREF: .data:004290CCo
aPassphrase_0	db 'passphrase',0
aStringUsePassp	db '|STRING|use passphrase STRING',0
aP12Charset	db 'p12-charset',0
		align 4
aNameSetCharset	db '|NAME|set charset for a new PKCS#12 passphrase to NAME',0
aHaveCert	db 'have-cert',0
		align 10h
aCertificateToE	db 'certificate to export provided on STDIN',0 ; DATA XREF: .data:004290FCo
aStore		db 'store',0
		align 10h
aStoreTheCreate	db 'store the created key in the appropriate place',0
					; DATA XREF: .data:0042910Co
aForce		db 'force',0
aForceOverwriti	db 'force overwriting',0 ; DATA XREF: .data:0042911Co
aNoFailOnExist	db 'no-fail-on-exist',0
aHomedir_0	db 'homedir',0
aPrompt		db 'prompt',0
		align 4
aEscstringUseEs	db '|ESCSTRING|use ESCSTRING as prompt in pinentry',0
aEnableStatusMs	db 'enable-status-msg',0
aAgentProgram	db 'agent-program',0
aGpgProtectTool	db 'gpg-protect-tool (GnuPG)',0 ; DATA XREF: sub_40155D:loc_401578o
a2_0_30		db '2.0.30',0           ; DATA XREF: sub_40155D:loc_401581o
aMingw32	db 'MingW32',0          ; DATA XREF: sub_40155D:loc_40158Ao
		align 10h
; char aPleaseReportBu[]
aPleaseReportBu	db 'Please report bugs to <@EMAIL@>.',0Ah,0
					; DATA XREF: sub_40155D:loc_401593o
		align 4
; char aUsageGpgProtec[]
aUsageGpgProtec	db 'Usage: gpg-protect-tool [options] (-h for help)',0Ah,0
					; DATA XREF: sub_40155D:loc_4015A4o
		align 4
; char aSyntaxGpgProte[]
aSyntaxGpgProte	db 'Syntax: gpg-protect-tool [options] [args]',0Ah
					; DATA XREF: sub_40155D:loc_4015B5o
		db 'Secret key maintenance tool',0Ah,0
		align 10h
off_42A410	dd offset loc_4015C6	; DATA XREF: sub_40155D+12o
		dd offset loc_4015A4	; jump table for switch	statement
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_401578
		dd offset loc_4015C6
		dd offset loc_401581
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_40158A
		dd offset loc_4015C6
		dd offset loc_401593
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015C6
		dd offset loc_4015A4
		dd offset loc_4015B5
; char aInvalidSExpres[]
aInvalidSExpres	db 'invalid S-Expression in `%s',27h,' (off=%u): %s',0Ah,0
					; DATA XREF: sub_4015D2+4Co
		align 4
; char a____Gnupg22_0_[]
a____Gnupg22_0_	db '../../gnupg2-2.0.30/agent/protect-tool.c',0 ; DATA XREF: sub_4015D2+96o
					; sub_4015D2+EAo ...
; char aLen[]
aLen		db 'len',0              ; DATA XREF: sub_4015D2+9Eo
					; sub_4015D2+F2o ...
		align 4
; char aInvalidCanonic[]
aInvalidCanonic	db 'invalid canonical S-Expression (off=%u): %s',0Ah,0
					; DATA XREF: sub_4016E0+45o
; char asc_42A541[]
asc_42A541	db '-',0                ; DATA XREF: sub_4017E7+Do
					; sub_402D35+292o ...
; char aErrorReadingSt[]
aErrorReadingSt	db 'error reading `[stdin]',27h,': %s',0Ah,0 ; DATA XREF: sub_4017E7+F3o
; char Mode[]
Mode		db 'rb',0               ; DATA XREF: sub_4017E7:loc_401913o
; char aCanTOpenSS[]
aCanTOpenSS	db 'can',27h,'t open `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_4017E7+165o
; char aCanTStatSS[]
aCanTStatSS	db 'can',27h,'t stat `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_4017E7+1B7o
; char aErrorReadingSS[]
aErrorReadingSS	db 'error reading `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_4017E7+234o
		align 4
; char aProtectingTheK[]
aProtectingTheK	db 'protecting the key failed: %s',0Ah,0 ; DATA XREF: sub_401AB5+7Co
					; sub_402637+3A7o
		align 4
; char aProtectToolBad[]
aProtectToolBad	db '[PROTECT-TOOL:] bad-passphrase',0Ah,0 ; DATA XREF: sub_401BD6+7Do
					; sub_402D35+180o
; char aUnprotectingTh[]
aUnprotectingTh	db 'unprotecting the key failed: %s',0Ah,0 ; DATA XREF: sub_401BD6+98o
		align 4
; char aKeyProtectionD[]
aKeyProtectionD	db 'key protection done at %.4s-%.2s-%.2s %.2s:%.2s:%s',0Ah,0
					; DATA XREF: sub_401BD6+EBo
; char aShadowingTheKe[]
aShadowingTheKe	db 'shadowing the key failed: %s',0Ah,0 ; DATA XREF: sub_401D61+7Bo
; char aResultlen[]
aResultlen	db 'resultlen',0        ; DATA XREF: sub_401D61+C8o
; char aGet_shadow_inf[]
aGet_shadow_inf	db 'get_shadow_info failed: %s',0Ah,0 ; DATA XREF: sub_401EC9+55o
; char aInfolen[]
aInfolen	db 'infolen',0          ; DATA XREF: sub_401EC9+A2o
; char aKeylen[]
aKeylen		db 'keylen',0           ; DATA XREF: sub_40201D+5Co
; char aGcry_sexp_newF[]
aGcry_sexp_newF	db 'gcry_sexp_new failed',0Ah,0 ; DATA XREF: sub_402133+44o
					; sub_402D35+2FFo
; char aCanTCalculateK[]
aCanTCalculateK	db 'can',27h,'t calculate keygrip',0Ah,0 ; DATA XREF: sub_402133+73o
					; sub_402637+249o
; char Format[]
Format		db '%02X',0             ; DATA XREF: sub_402133+A1o
					; sub_402637+27Fo
; char aRsaOopsNPQ[]
aRsaOopsNPQ	db 'RSA oops: n != p * q',0Ah,0 ; DATA XREF: sub_402200+80o
; char aSwappingSecret[]
aSwappingSecret	db 'swapping secret primes',0Ah,0 ; DATA XREF: sub_402200+ACo
; char aRsaOopsEDivide[]
aRsaOopsEDivide	db 'RSA oops: e divides p-1',0Ah,0 ; DATA XREF: sub_402200+183o
; char aRsaOopsEDivi_0[]
aRsaOopsEDivi_0	db 'RSA oops: e divides q-1',0Ah,0 ; DATA XREF: sub_402200+1F3o
		align 4
; char aRsaOopsBadSecr[]
aRsaOopsBadSecr	db 'RSA oops: bad secret exponent',0Ah,0 ; DATA XREF: sub_402200+306o
; char aRsaOopsBadUPar[]
aRsaOopsBadUPar	db 'RSA oops: bad u parameter',0Ah,0 ; DATA XREF: sub_402200+34Eo
; char aRsaSecretKeyCh[]
aRsaSecretKeyCh	db 'RSA secret key check failed',0Ah,0 ; DATA XREF: sub_402200+364o
aCertificate	db 'CERTIFICATE',0      ; DATA XREF: sub_4025B0+Eo
		align 4
; char aErrorWritingAr[]
aErrorWritingAr	db 'error writing armored certificate: %s',0Ah,0 ; DATA XREF: sub_4025B0+79o
aThePassphraseI	db 'The passphrase is ',0 ; DATA XREF: sub_402637+3Bo
		align 4
; char aErrorParsingOr[]
aErrorParsingOr	db 'error parsing or decrypting the PKCS-12 file',0Ah,0
					; DATA XREF: sub_402637+100o
		align 4
; char aInvalidStructu[]
aInvalidStructu	db 'invalid structure of private key',0Ah,0 ; DATA XREF: sub_402637+133o
		align 4
aPrivateKeyRsaN	db '(private-key(rsa(n%m)(e%m)(d%m)(p%m)(q%m)(u%m)))',0
					; DATA XREF: sub_402637+1BEo
		align 10h
; char aFailedToCreate[]
aFailedToCreate	db 'failed to created S-expression from key: %s',0Ah,0
					; DATA XREF: sub_402637+222o
; char aKeygrip[]
aKeygrip	db 'keygrip: ',0        ; DATA XREF: sub_402637:loc_402891o
; char asc_42A887[]
asc_42A887	db 0Ah,0		; DATA XREF: sub_402637+295o
; char aBuflen[]
aBuflen		db 'buflen',0           ; DATA XREF: sub_402637+2DEo
					; sub_402637+333o
aPrivateKey	db 'private-key',0      ; DATA XREF: sub_402ABD+10o
aRsa		db 'rsa',0              ; DATA XREF: sub_402ABD+88o
aNedpqu		db 'nedpqu',0           ; DATA XREF: sub_402ABD:loc_402B71o
; char Str[]
Str		db '01234567890ABCDEF',0 ; DATA XREF: sub_402CDC+1Fo
; char aStrlenFname40[]
aStrlenFname40	db 'strlen(fname) == 40',0 ; DATA XREF: sub_402D35+70o
a_key		db '.key',0             ; DATA XREF: sub_402D35:loc_402DB1o
					; sub_4039ED+20o
aPrivateKeysV1_	db 'private-keys-v1.d',0 ; DATA XREF: sub_402D35+B8o
					; sub_4039ED+4Ao
; char aUnprotectingKe[]
aUnprotectingKe	db 'unprotecting key `%s',27h,' failed: %s',0Ah,0
					; DATA XREF: sub_402D35+1A2o
		align 4
; char aSIsAShadowedPr[]
aSIsAShadowedPr	db '`%s',27h,' is a shadowed private key - can',27h,'t export it',0Ah,0
					; DATA XREF: sub_402D35+1F6o
; char aSIsNotAPrivate[]
aSIsNotAPrivate	db '%s',27h,' is not a private key',0Ah,0 ; DATA XREF: sub_402D35+241o
; char aErrorConvertin[]
aErrorConvertin	db 'error converting key parameters',0Ah,0 ; DATA XREF: sub_402D35+394o
; char aGpgProtectTo_0[]
aGpgProtectTo_0	db 'gpg-protect-tool',0 ; DATA XREF: sub_4032E3+37o
a1_5_0		db '1.5.0',0            ; DATA XREF: sub_4032E3+4Do
					; sub_4032E3+7Bo
; char aSIsTooOldNeedS[]
aSIsTooOldNeedS	db '%s is too old (need %s, have %s)',0Ah,0 ; DATA XREF: sub_4032E3+6Bo
aLibgcrypt	db 'libgcrypt',0        ; DATA XREF: sub_4032E3+83o
; char aPleaseEnterThe[]
aPleaseEnterThe	db 'Please enter the passphrase to unprotect the PKCS#12 object.',0
					; DATA XREF: sub_403806+50o
		align 4
; char aPleaseEnterT_0[]
aPleaseEnterT_0	db 'Please enter the passphrase to protect the new PKCS#12 object.',0
					; DATA XREF: sub_403806+67o
		align 4
; char aPleaseEnterT_1[]
aPleaseEnterT_1	db 'Please enter the passphrase to protect the imported object within'
					; DATA XREF: sub_403806+85o
		db ' the GnuPG system.',0
; char aPleaseEnterT_2[]
aPleaseEnterT_2	db 'Please enter the passphrase or the PIN',0Ah
					; DATA XREF: sub_403806:loc_4038A3o
		db 'needed to complete this operation.',0
; char aPassphrase[]
aPassphrase	db 'Passphrase:',0      ; DATA XREF: sub_403806+B7o
; char aCancelled[]
aCancelled	db 'cancelled',0Ah,0    ; DATA XREF: sub_403806+118o
		align 10h
; char aErrorWhileAski[]
aErrorWhileAski	db 'error while asking for the passphrase: %s',0Ah,0
					; DATA XREF: sub_403806+13Bo
; char aPw[]
aPw		db 'pw',0               ; DATA XREF: sub_403806+176o
aWb		db 'wb',0               ; DATA XREF: sub_4039ED+63o
		align 4
; char aProtectToolSec[]
aProtectToolSec	db '[PROTECT-TOOL:] secretkey-exists',0Ah,0 ; DATA XREF: sub_4039ED+9Fo
		align 4
; char aSecretKeyFileS[]
aSecretKeyFileS	db 'secret key file `%s',27h,' already exists',0Ah,0
					; DATA XREF: sub_4039ED+BBo
					; sub_4039ED+D0o
aWbx		db 'wbx',0              ; DATA XREF: sub_4039ED:loc_403AEEo
; char aCanTCreateSS[]
aCanTCreateSS	db 'can',27h,'t create `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_4039ED+13Ao
; char aErrorWritingSS[]
aErrorWritingSS	db 'error writing `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_4039ED+19Do
; char aErrorClosingSS[]
aErrorClosingSS	db 'error closing `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_4039ED+1FFo
; char aSecretKeyStore[]
aSecretKeyStore	db 'secret key stored as `%s',27h,0Ah,0 ; DATA XREF: sub_4039ED+22Fo
		align 4
; char aProtectToolS_0[]
aProtectToolS_0	db '[PROTECT-TOOL:] secretkey-stored',0Ah,0 ; DATA XREF: sub_4039ED+244o
		align 4
aRsa_0		db 'rsa',0              ; DATA XREF: .data:off_429180o
aNedpqu_0	db 'nedpqu',0           ; DATA XREF: .data:00429184o
aDsa		db 'dsa',0              ; DATA XREF: .data:00429194o
aPqgyx		db 'pqgyx',0            ; DATA XREF: .data:00429198o
aElg		db 'elg',0              ; DATA XREF: .data:004291A8o
aPgyx		db 'pgyx',0             ; DATA XREF: .data:004291ACo
aEcdsa		db 'ecdsa',0            ; DATA XREF: .data:004291BCo
aPabgnqd	db 'pabgnqd',0          ; DATA XREF: .data:004291C0o
aEcdh		db 'ecdh',0
aEcc		db 'ecc',0
aSaltsalt	db 'saltsalt',0         ; DATA XREF: sub_40402A+27o
a123456789abcde	db '123456789abcdef0',0 ; DATA XREF: sub_40402A+3Fo
		align 4
; char a____Gnupg22__0[]
a____Gnupg22__0	db '../../gnupg2-2.0.30/agent/protect.c',0 ; DATA XREF: sub_40402A+64o
					; sub_404392+292o ...
; char aS2kCalibration[]
aS2kCalibration	db 'S2K calibration: %lu -> %lums',0Ah,0 ; DATA XREF: sub_4040A7+35o
		align 4
; char aS2kCalibrati_0[]
aS2kCalibrati_0	db 'S2K calibration: %lu iterations for %lums',0Ah,0
					; DATA XREF: sub_4040A7+E0o
aPrivateKey_0	db 'private-key',0      ; DATA XREF: sub_4041C5:loc_40421Ao
					; sub_404830:loc_4048E1o ...
aOpenpgpS2k3Sha	db 'openpgp-s2k3-sha1-aes-cbc',0 ; DATA XREF: sub_404392+Bo
					; sub_4056C4:loc_405A0Do
a4Hash4Sha120	db ')(4:hash4:sha120:',0 ; DATA XREF: sub_404392+1F2o
; char aPOutbufOutlen[]
aPOutbufOutlen	db 'p - outbuf == outlen',0 ; DATA XREF: sub_404392+29Ao
aLu		db '%lu',0              ; DATA XREF: sub_404392+30Ao
dword_42AD08	dd 0			; DATA XREF: sub_404392+363o
					; sub_404392+380o
a9ProtectedDS4S	db '(9:protected%d:%s((4:sha18:%n_8bytes_%u:%s)%d:%n%*s)%d:%n%*s)',0
					; DATA XREF: sub_404392+3BAo
a12ProtectedAt1	db '(12:protected-at15:',0 ; DATA XREF: sub_404830+14o
aCurve		db 'curve',0            ; DATA XREF: sub_404830+2A6o
a?qd		db '?qd',0              ; DATA XREF: sub_404830+2D8o
; char aDepth1[]
aDepth1		db 'depth == 1',0       ; DATA XREF: sub_404830+3F5o
					; sub_40639D+236o
; char aDepth[]
aDepth		db '!depth',0           ; DATA XREF: sub_404830+441o
asc_42AD7A	db ')',0                ; DATA XREF: sub_404830+4D7o
a21Protected	db '(21:protected-',0   ; DATA XREF: sub_404830:loc_404E12o
; char aPResultResultl[]
aPResultResultl	db 'p - *result == *resultlen',0 ; DATA XREF: sub_404830+712o
a11PrivateKey	db '(11:private-key',0  ; DATA XREF: sub_40519A:loc_405279o
aHash		db 'hash',0             ; DATA XREF: sub_40519A+21Bo
aSha1		db 'sha1',0             ; DATA XREF: sub_40519A+24Bo
					; sub_4056C4:loc_405A92o
; char aS[]
aS		db '*s == ',27h,'(',27h,0 ; DATA XREF: sub_40519A+318o
aProtectedAt	db 'protected-at',0     ; DATA XREF: sub_40519A+37Ao
					; sub_4056C4:loc_40586Do
; char aS1[]
aS1		db 's[-1] == ',27h,')',27h,0 ; DATA XREF: sub_40519A+422o
aProtectedPriva	db 'protected-private-key',0 ; DATA XREF: sub_4056C4:loc_405730o
					; sub_405E15:loc_405E59o
aProtected	db 'protected',0        ; DATA XREF: sub_4056C4:loc_405992o
aShadowedPrivat	db 'shadowed-private-key',0 ; DATA XREF: sub_405E15:loc_405E7Eo
					; sub_40671C:loc_40677Co
aPublicKey	db 'public-key',0       ; DATA XREF: sub_40639D:loc_406466o
aShadowed	db 'shadowed',0         ; DATA XREF: sub_40671C:loc_406869o
aT1V1		db 't1-v1',0            ; DATA XREF: sub_40671C:loc_40690Eo
aCalibrate_s2k_	db 'calibrate_s2k_count_one',0 ; DATA XREF: sub_40402A+54o
		align 10h
dbl_42AE50	dq 100.0		; DATA XREF: sub_4040A7+77r
		align 10h
dword_42AE60	dd 8648862Ah		; DATA XREF: sub_4077C8+199o
					; sub_40913F+133o ...
dword_42AE64	dd 7010DF7h		; DATA XREF: sub_409888+187r
					; sub_40A1A4+135r ...
byte_42AE68	db 1			; DATA XREF: sub_409888+190r
					; sub_40A1A4+13Er ...
dword_42AE69	dd 8648862Ah		; DATA XREF: sub_40913F+35Co
					; sub_40A59B+E8r
dword_42AE6D	dd 7010DF7h		; DATA XREF: sub_40A59B+F0r
byte_42AE71	db 6			; DATA XREF: sub_40A59B+F9r
word_42AE72	dw 862Ah		; DATA XREF: sub_4077C8+70Bo
		dd 0DF78648h, 10A0C01h
		db 1
dword_42AE7D	dd 8648862Ah		; DATA XREF: sub_408758+1E9o
					; sub_40A1A4+1E1r
dword_42AE81	dd 0C010DF7h		; DATA XREF: sub_40A1A4+1E9r
word_42AE85	dw 10Ah			; DATA XREF: sub_40A1A4+1F2r
byte_42AE87	db 2			; DATA XREF: sub_40A1A4+1FDr
dword_42AE88	dd 8648862Ah		; DATA XREF: sub_4077C8+687o
					; sub_40A834+161r
dword_42AE8C	dd 0C010DF7h		; DATA XREF: sub_40A834+169r
word_42AE90	dw 10Ah			; DATA XREF: sub_40A834+172r
byte_42AE92	db 3			; DATA XREF: sub_40A834+17Dr
byte_42AE93	db 2Ah			; DATA XREF: sub_4077C8+6C5o
		dd 0F7864886h, 0A0C010Dh
		db 1, 4
word_42AE9E	dw 862Ah		; DATA XREF: sub_4077C8+29Bo
					; sub_408758+311o
		dd 0DF78648h, 3010C01h
dword_42AEA8	dd 8648862Ah, 0C010DF7h	; DATA XREF: sub_4077C8+245o
		db 1, 6
dword_42AEB2	dd 8648862Ah		; DATA XREF: sub_4077C8+C0Eo
					; sub_40A834+1E6r
dword_42AEB6	dd 9010DF7h		; DATA XREF: sub_40A834+1EEr
word_42AEBA	dw 116h			; DATA XREF: sub_40A834+1F7r
dword_42AEBC	dd 8648862Ah		; DATA XREF: sub_4077C8+93Ao
					; sub_408758+6B7o ...
dword_42AEC0	dd 1010DF7h		; DATA XREF: sub_409D43+22Cr
byte_42AEC4	db 1			; DATA XREF: sub_409D43+235r
dword_42AEC5	dd 0A061C30h		; DATA XREF: sub_40A1A4+248r
dword_42AEC9	dd 8648862Ah		; DATA XREF: sub_40A1A4+250r
dword_42AECD	dd 0C010DF7h		; DATA XREF: sub_40A1A4+259r
dword_42AED1	dd 0E300301h		; DATA XREF: sub_40A1A4+262r
dword_42AED5	dd 0FFFF0804h		; DATA XREF: sub_40A1A4+26Br
dword_42AED9	dd 0FFFFFFFFh		; DATA XREF: sub_40A1A4+274r
dword_42AEDD	dd 202FFFFh		; DATA XREF: sub_40A1A4+27Dr
word_42AEE1	dw 8			; DATA XREF: sub_40A1A4+286r
dword_42AEE3	dd 0A061C30h		; DATA XREF: sub_40A59B+1BFr
dword_42AEE7	dd 8648862Ah		; DATA XREF: sub_40A59B+1C7r
dword_42AEEB	dd 0C010DF7h		; DATA XREF: sub_40A59B+1D0r
dword_42AEEF	dd 0E300601h		; DATA XREF: sub_40A59B+1D9r
dword_42AEF3	dd 0FFFF0804h		; DATA XREF: sub_40A59B+1E2r
dword_42AEF7	dd 0FFFFFFFFh		; DATA XREF: sub_40A59B+1EBr
dword_42AEFB	dd 202FFFFh		; DATA XREF: sub_40A59B+1F4r
word_42AEFF	dw 8			; DATA XREF: sub_40A59B+1FDr
		align 20h
dword_42AF20	dd 21303130h		; DATA XREF: sub_409888+3A6r
dword_42AF24	dd 5060930h		; DATA XREF: sub_409888+3AEr
dword_42AF28	dd 2030E2Bh		; DATA XREF: sub_409888+3B7r
dword_42AF2C	dd 400051Ah		; DATA XREF: sub_409888+3C0r
dword_42AF30	dd 0FFFFFF14h		; DATA XREF: sub_409888+3C9r
dword_42AF34	dd 0FFFFFFFFh		; DATA XREF: sub_409888+3D2r
dword_42AF38	dd 0FFFFFFFFh		; DATA XREF: sub_409888+3DBr
dword_42AF3C	dd 0FFFFFFFFh		; DATA XREF: sub_409888+3E4r
dword_42AF40	dd 0FFFFFFFFh		; DATA XREF: sub_409888+3EDr
dword_42AF44	dd 0FF0804FFh		; DATA XREF: sub_409888+3F6r
dword_42AF48	dd 0FFFFFFFFh		; DATA XREF: sub_409888+3FFr
dword_42AF4C	dd 2FFFFFFh		; DATA XREF: sub_409888+408r
word_42AF50	dw 802h			; DATA XREF: sub_409888+411r
byte_42AF52	db 0			; DATA XREF: sub_409888+41Cr
		align 10h
dword_42AF60	dd 55307C31h, 862A0906h, 0DF78648h, 31140901h, 461E48h
					; DATA XREF: sub_40A1A4+2F1o
					; sub_40A834+26Co
		dd 6E0047h, 500075h, 200047h, 780065h, 6F0070h,	740072h
		dd 640065h, 630020h, 720065h, 690074h, 690066h,	610063h
		dd 650074h, 660020h, 3 dup(660066h), 6233066h, 48862A09h
		dd 10DF786h, 16311509h
		db 4, 14h
; char aPasswordTooLon[]
aPasswordTooLon	db 'password too long',0Ah,0 ; DATA XREF: sub_406E1B+46o
; char aSaltTooShort[]
aSaltTooShort	db 'salt too short',0Ah,0 ; DATA XREF: sub_406E1B+62o
; char aGcry_md_openFa[]
aGcry_md_openFa	db 'gcry_md_open failed: %s',0Ah,0 ; DATA XREF: sub_406E1B+12Fo
					; sub_409888+30Bo
; char aGcry_mpi_scanF[]
aGcry_mpi_scanF	db 'gcry_mpi_scan failed: %s',0Ah,0 ; DATA XREF: sub_406E1B+308o
					; sub_406E1B+393o
; char aGcry_mpi_print[]
aGcry_mpi_print	db 'gcry_mpi_print failed: %s',0Ah,0 ; DATA XREF: sub_406E1B+42Do
		align 4
; char a____Gnupg22__1[]
a____Gnupg22__1	db '../../gnupg2-2.0.30/agent/minip12.c',0 ; DATA XREF: sub_407285+1Ao
					; sub_409D43+405o ...
; char aKeybytes5Keyby[]
aKeybytes5Keyby	db 'keybytes == 5 || keybytes == 24',0 ; DATA XREF: sub_407285+22o
; char aGcry_cipher_se[]
aGcry_cipher_se	db 'gcry_cipher_setkey failed: %s',0Ah,0 ; DATA XREF: sub_407285+A6o
; char aGcry_cipher__0[]
aGcry_cipher__0	db 'gcry_cipher_setiv failed: %s',0Ah,0 ; DATA XREF: sub_407285+130o
; char aGcry_cipher_op[]
aGcry_cipher_op	db 'gcry_cipher_open failed: %s',0Ah,0 ; DATA XREF: sub_4073CF+40o
; char aEnDeCrytionFai[]
aEnDeCrytionFai	db 'en/de-crytion failed: %s',0Ah,0 ; DATA XREF: sub_4073CF+172o
; char aOutOfSecureMem[]
aOutOfSecureMem	db 'out of secure memory while converting passphrase',0Ah,0
					; DATA XREF: sub_40755B+7Co
					; sub_40ABDF+C1o
aUtf8		db 'utf-8',0            ; DATA XREF: sub_40755B+97o
					; sub_40ABDF:loc_40ACB1o
; char aDecryptionFail[]
aDecryptionFail	db 'decryption failed; trying charset `%s',27h,0Ah,0
					; DATA XREF: sub_40755B+146o
aStart		db 'start',0            ; DATA XREF: sub_4077C8:loc_40781Do
					; sub_408758+38o
aBag_encryptedd	db 'bag.encryptedData.version',0 ; DATA XREF: sub_4077C8+C1o
aBag_encrypte_0	db 'bag.encryptedData.data',0 ; DATA XREF: sub_4077C8+14Eo
aBag_encrypte_1	db 'bag.encryptedData.keyinfo',0 ; DATA XREF: sub_4077C8+1C3o
aRc2or3desParam	db 'rc2or3des-params',0 ; DATA XREF: sub_4077C8:loc_407A94o
aRc2or3desCiphe	db 'rc2or3des-ciphertext',0 ; DATA XREF: sub_4077C8+409o
aCramRc2or3desC	db 'cram-rc2or3des-ciphertext',0 ; DATA XREF: sub_4077C8+45Fo
a3des		db '3DES',0             ; DATA XREF: sub_4077C8+4DDo
aRc2		db 'RC2',0              ; DATA XREF: sub_4077C8:loc_407CACo
		align 10h
; char aLuBytesOfSEncr[]
aLuBytesOfSEncr	db '%lu bytes of %s encrypted text',0Ah,0 ; DATA XREF: sub_4077C8+4F4o
; char aErrorAllocatin[]
aErrorAllocatin	db 'error allocating decryption buffer',0Ah,0 ; DATA XREF: sub_4077C8+514o
					; sub_408758+4E9o
aOuter_outer_se	db 'outer.outer.seq',0  ; DATA XREF: sub_4077C8+591o
aCertbag_nextce	db 'certbag.nextcert',0 ; DATA XREF: sub_4077C8+617o
aCertbag_object	db 'certbag.objectidentifier',0 ; DATA XREF: sub_4077C8+635o
aCertbag_before	db 'certbag.before.certheader',0 ; DATA XREF: sub_4077C8:loc_407F04o
; char aSkippingUnsupp[]
aSkippingUnsupp	db 'skipping unsupported crlBag',0Ah,0 ; DATA XREF: sub_4077C8+781o
		align 4
; char aOneKeybagAlrea[]
aOneKeybagAlrea	db 'one keyBag already processed; skipping this one',0Ah,0
					; DATA XREF: sub_4077C8:loc_407F86o
; char aProcessingSimp[]
aProcessingSimp	db 'processing simple keyBag',0Ah,0 ; DATA XREF: sub_4077C8+7F3o
		align 4
; char aErrorAllocat_0[]
aErrorAllocat_0	db 'error allocating result array',0Ah,0 ; DATA XREF: sub_4077C8+A3Co
					; sub_408758+7B9o
aReading_keybag	db 'reading.keybag.key-parameters',0 ; DATA XREF: sub_4077C8+A54o
		align 4
; char aErrorParsingKe[]
aErrorParsingKe	db 'error parsing key parameter: %s',0Ah,0 ; DATA XREF: sub_4077C8+B2Do
					; sub_408758+8AAo
; char aProcessingCert[]
aProcessingCert	db 'processing certBag',0Ah,0 ; DATA XREF: sub_4077C8:loc_408343o
aCertbag_befo_0	db 'certbag.before.octetstring',0 ; DATA XREF: sub_4077C8+C38o
aBag_attributes	db 'bag.attributes',0   ; DATA XREF: sub_4077C8+D0Do
		align 4
; char aEncrypteddataE[]
aEncrypteddataE	db 'encryptedData error at "%s", offset %u',0Ah,0
					; DATA XREF: sub_4077C8+ED3o
; char aPossiblyBadPas[]
aPossiblyBadPas	db 'possibly bad passphrase given',0Ah,0 ; DATA XREF: sub_4077C8+EE5o
aCramData_outer	db 'cram-data.outersegs',0 ; DATA XREF: sub_408758+CEo
aData_outerseqs	db 'data.outerseqs',0   ; DATA XREF: sub_408758:loc_408874o
aData_objectide	db 'data.objectidentifier',0 ; DATA XREF: sub_408758+193o
aShroudedOuters	db 'shrouded,outerseqs',0 ; DATA XREF: sub_408758+213o
a3desParams	db '3des-params',0      ; DATA XREF: sub_408758+33Bo
a3desCiphertext	db '3des-ciphertext',0  ; DATA XREF: sub_408758+478o
		align 4
; char aLuBytesOf3desE[]
aLuBytesOf3desE	db '%lu bytes of 3DES encrypted text',0Ah,0 ; DATA XREF: sub_408758+4C9o
aDecryptedText	db 'decrypted-text',0   ; DATA XREF: sub_408758+575o
aReading_keyPar	db 'reading.key-parameters',0 ; DATA XREF: sub_408758+7D1o
; char aDataErrorAtSOf[]
aDataErrorAtSOf	db 'data error at "%s", offset %u',0Ah,0 ; DATA XREF: sub_408758+9BFo
aPfx		db 'pfx',0              ; DATA XREF: sub_40913F+27o
aPfxversion	db 'pfxVersion',0       ; DATA XREF: sub_40913F+5Bo
aAuthsave	db 'authSave',0         ; DATA XREF: sub_40913F+BBo
aCramBags	db 'cram-bags',0        ; DATA XREF: sub_40913F+1DBo
aBags		db 'bags',0             ; DATA XREF: sub_40913F:loc_409354o
aBagSequence	db 'bag-sequence',0     ; DATA XREF: sub_40913F:loc_4093A4o
aBag_encrypte_2	db 'bag.encryptedData',0 ; DATA XREF: sub_40913F:loc_4094DBo
		align 4
; char aAlreadyGotAnKe[]
aAlreadyGotAnKe	db 'already got an key object, skipping this one',0Ah,0
					; DATA XREF: sub_40913F+45Ao
; char aUnknownBagType[]
aUnknownBagType	db 'unknown bag type - skipped',0Ah,0 ; DATA XREF: sub_40913F:loc_40963Do
; char aErrorAtSOffset[]
aErrorAtSOffset	db 'error at "%s", offset %u',0Ah,0 ; DATA XREF: sub_40913F+608o
; char aObjectTooLarge[]
aObjectTooLarge	db 'object too larger to encode',0Ah,0 ; DATA XREF: sub_4097AE:loc_4097E5o
; char aErrorAllocat_1[]
aErrorAllocat_1	db 'error allocating buffer',0Ah,0 ; DATA XREF: sub_409888+EAo
					; sub_40A1A4+D9o ...
; char aGcry_md_setkey[]
aGcry_md_setkey	db 'gcry_md_setkey failed: %s',0Ah,0 ; DATA XREF: sub_409888+35Eo
; char aLengthMismatch[]
aLengthMismatch	db 'length mismatch: %lu, %lu',0Ah,0 ; DATA XREF: sub_409888+4A2o
					; sub_40A1A4+3D8o ...
; char aErrorFormattin[]
aErrorFormattin	db 'error formatting parameter: %s',0Ah,0 ; DATA XREF: sub_409D43+6Ao
; char aInvalidParamet[]
aInvalidParamet	db 'invalid parameters for p12_build',0Ah,0 ; DATA XREF: sub_409D43+C8o
		align 4
; char aErrorAllocat_2[]
aErrorAllocat_2	db 'error allocating encryption buffer',0Ah,0 ; DATA XREF: sub_409D43+18Fo
; char aOopsErrorForma[]
aOopsErrorForma	db 'oops: error formatting parameter: %s',0Ah,0 ; DATA XREF: sub_409D43+30Co
		align 4
; char aOopsErrorStori[]
aOopsErrorStori	db 'oops: error storing parameter: %s',0Ah,0 ; DATA XREF: sub_409D43+3A8o
; char aNeededPlainlen[]
aNeededPlainlen	db 'needed == plainlen',0 ; DATA XREF: sub_409D43+40Do
; char aStrlenKeyidstr[]
aStrlenKeyidstr	db 'strlen (keyidstr) == 8',0 ; DATA XREF: sub_40A834+3Do
		align 4
; char aCanTConvertPas[]
aCanTConvertPas	db 'can',27h,'t convert passphrase to requested charset `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40ABDF+10Ao
; char aErrorConvert_0[]
aErrorConvert_0	db 'error converting passphrase to requested charset `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40ABDF+1C4o
; char a02x02x02x02x[]
a02x02x02x02x	db '%02x%02x%02x%02x',0 ; DATA XREF: sub_40ABDF+25Do
dword_42B728	dd 4F534900h, 3538382Dh, 312D39h, 2D4F5349h, 39353838h
					; DATA XREF: .rdata:off_42B7C0o
					; .rdata:0042B7C4o ...
		dd 35312Dh, 2D4F5349h, 39353838h, 4900322Dh, 382D4F53h
		dd 2D393538h, 53490033h, 38382D4Fh, 342D3935h, 4F534900h
		dd 3538382Dh, 352D39h, 2D4F5349h, 39353838h, 4900362Dh
		dd 382D4F53h, 2D393538h, 53490037h, 38382D4Fh, 382D3935h
		dd 4F534900h, 3538382Dh, 392D39h, 38494F4Bh, 4900522Dh
		dd 33344D42h, 42490037h, 3035384Dh, 43554500h, 504A2Dh
		dd 35474942h, 2	dup(0)
; char off_42B7C0[]
off_42B7C0	dd offset dword_42B728	; DATA XREF: sub_40755B+2Br
					; sub_40755B+90r ...
		dd offset dword_42B728+1
		dd offset dword_42B728+0Ch
		dd offset dword_42B728+18h
		dd offset dword_42B728+23h
		dd offset dword_42B728+2Eh
		dd offset dword_42B728+39h
		dd offset dword_42B728+44h
		dd offset dword_42B728+4Fh
		dd offset dword_42B728+5Ah
		dd offset dword_42B728+65h
		dd offset dword_42B728+70h
		dd offset dword_42B728+77h
		dd offset dword_42B728+7Eh
		dd offset dword_42B728+85h
		dd offset dword_42B728+8Ch
		dd 8 dup(0)
dword_42B820	dd 0			; DATA XREF: sub_40B283+177r
		dd 864CFBh, 18AD50Dh, 10C99F6h,	393E6E1h, 315AA1Ah, 21933ECh
		dd 29F7F17h, 7A18139h, 727CDC2h, 62B5434h, 6AD18CFh, 43267D8h
		dd 4B42B23h, 5B8B2D5h, 53EFE2Eh, 0FC54E89h, 0F430272h
		dd 0E4F9B84h, 0EC9D77Fh, 0C56A868h, 0CD0E493h, 0DDC7D65h
		dd 0D5A319Eh, 864CFB0h,	8E2834Bh, 9EE1ABDh, 9685646h, 0BF72951h
		dd 0B7165AAh, 0A7DFC5Ch, 0AFBB0A7h, 1F0CD1E9h, 1F8A9D12h
		dd 1E8604E4h, 1E00481Fh, 1C9F3708h, 1C197BF3h, 1D15E205h
		dd 1D93AEFEh, 18AD50D0h, 182B1C2Bh, 192785DDh, 19A1C926h
		dd 1B3EB631h, 1BB8FACAh, 1AB4633Ch, 1A322FC7h, 10C99F60h
		dd 104FD39Bh, 11434A6Dh, 11C50696h, 135A7981h, 13DC357Ah
		dd 12D0AC8Ch, 1256E077h, 17681E59h, 17EE52A2h, 16E2CB54h
		dd 166487AFh, 14FBF8B8h, 147DB443h, 15712DB5h, 15F7614Eh
		dd 3E19A3D2h, 3E9FEF29h, 3F9376DFh, 3F153A24h, 3D8A4533h
		dd 3D0C09C8h, 3C00903Eh, 3C86DCC5h, 39B822EBh, 393E6E10h
		dd 3832F7E6h, 38B4BB1Dh, 3A2BC40Ah, 3AAD88F1h, 3BA11107h
		dd 3B275DFCh, 31DCED5Bh, 315AA1A0h, 30563856h, 30D074ADh
		dd 324F0BBAh, 32C94741h, 33C5DEB7h, 3343924Ch, 367D6C62h
		dd 36FB2099h, 37F7B96Fh, 3771F594h, 35EE8A83h, 3568C678h
		dd 34645F8Eh, 34E21375h, 2115723Bh, 21933EC0h, 209FA736h
		dd 2019EBCDh, 228694DAh, 2200D821h, 230C41D7h, 238A0D2Ch
		dd 26B4F302h, 2632BFF9h, 273E260Fh, 27B86AF4h, 252715E3h
		dd 25A15918h, 24ADC0EEh, 242B8C15h, 2ED03CB2h, 2E567049h
		dd 2F5AE9BFh, 2FDCA544h, 2D43DA53h, 2DC596A8h, 2CC90F5Eh
		dd 2C4F43A5h, 2971BD8Bh, 29F7F170h, 28FB6886h, 287D247Dh
		dd 2AE25B6Ah, 2A641791h, 2B688E67h, 2BEEC29Ch, 7C3347A4h
		dd 7CB50B5Fh, 7DB992A9h, 7D3FDE52h, 7FA0A145h, 7F26EDBEh
		dd 7E2A7448h, 7EAC38B3h, 7B92C69Dh, 7B148A66h, 7A181390h
		dd 7A9E5F6Bh, 7801207Ch, 78876C87h, 798BF571h, 790DB98Ah
		dd 73F6092Dh, 737045D6h, 727CDC20h, 72FA90DBh, 7065EFCCh
		dd 70E3A337h, 71EF3AC1h, 7169763Ah, 74578814h, 74D1C4EFh
		dd 75DD5D19h, 755B11E2h, 77C46EF5h, 7742220Eh, 764EBBF8h
		dd 76C8F703h, 633F964Dh, 63B9DAB6h, 62B54340h, 62330FBBh
		dd 60AC70ACh, 602A3C57h, 6126A5A1h, 61A0E95Ah, 649E1774h
		dd 64185B8Fh, 6514C279h, 65928E82h, 670DF195h, 678BBD6Eh
		dd 66872498h, 66016863h, 6CFAD8C4h, 6C7C943Fh, 6D700DC9h
		dd 6DF64132h, 6F693E25h, 6FEF72DEh, 6EE3EB28h, 6E65A7D3h
		dd 6B5B59FDh, 6BDD1506h, 6AD18CF0h, 6A57C00Bh, 68C8BF1Ch
		dd 684EF3E7h, 69426A11h, 69C426EAh, 422AE476h, 42ACA88Dh
		dd 43A0317Bh, 43267D80h, 41B90297h, 413F4E6Ch, 4033D79Ah
		dd 40B59B61h, 458B654Fh, 450D29B4h, 4401B042h, 4487FCB9h
		dd 461883AEh, 469ECF55h, 479256A3h, 47141A58h, 4DEFAAFFh
		dd 4D69E604h, 4C657FF2h, 4CE33309h, 4E7C4C1Eh, 4EFA00E5h
		dd 4FF69913h, 4F70D5E8h, 4A4E2BC6h, 4AC8673Dh, 4BC4FECBh
		dd 4B42B230h, 49DDCD27h, 495B81DCh, 4857182Ah, 48D154D1h
		dd 5D26359Fh, 5DA07964h, 5CACE092h, 5C2AAC69h, 5EB5D37Eh
		dd 5E339F85h, 5F3F0673h, 5FB94A88h, 5A87B4A6h, 5A01F85Dh
		dd 5B0D61ABh, 5B8B2D50h, 59145247h, 59921EBCh, 589E874Ah
		dd 5818CBB1h, 52E37B16h, 526537EDh, 5369AE1Bh, 53EFE2E0h
		dd 51709DF7h, 51F6D10Ch, 50FA48FAh, 507C0401h, 5542FA2Fh
		dd 55C4B6D4h, 54C82F22h, 544E63D9h, 56D11CCEh, 56575035h
		dd 575BC9C3h, 57DD8538h
aPgp		db 'PGP ',0             ; DATA XREF: sub_40B177+9Fo
; char aBegin[]
aBegin		db '-----BEGIN ',0      ; DATA XREF: sub_40B283+56o
; char asc_42BC31[]
asc_42BC31	db '-----',0Ah,0        ; DATA XREF: sub_40B283+91o
					; sub_40B5A3+31Fo
; char asc_42BC38[]
asc_42BC38	db 0Ah,0		; DATA XREF: sub_40B283+BAo
					; sub_40B283+2AFo ...
		align 4
; char a____Gnupg22__2[]
a____Gnupg22__2	db '../../gnupg2-2.0.30/common/b64enc.c',0 ; DATA XREF: sub_40B283+106o
					; sub_40B5A3+46o
; char aIdx4[]
aIdx4		db 'idx < 4',0          ; DATA XREF: sub_40B283+10Eo
					; sub_40B5A3+4Eo
; char aEnd[]
aEnd		db '-----END ',0        ; DATA XREF: sub_40B5A3+2ECo
		align 10h
; char aGnupg2[]
aGnupg2		db 'gnupg2',0           ; DATA XREF: sub_40B92C+Fo
		align 4
; char aLibgcryptProbl[]
aLibgcryptProbl	db 'libgcrypt problem: %s',0Ah,0 ; DATA XREF: sub_40BAC9+20o
		align 10h
; char aOutOfCoreInSec[]
aOutOfCoreInSec	db 'out of core in secure memory while allocating %lu bytes',0
					; DATA XREF: sub_40BAF5+23o
; char aOutOfCoreWhile[]
aOutOfCoreWhile	db 'out of core while allocating %lu bytes',0
					; DATA XREF: sub_40BAF5:loc_40BB33o
aStdout		db '[stdout]',0         ; DATA XREF: .text:loc_40BBB9o
aStdin		db '[stdin]',0          ; DATA XREF: .text:loc_40BBE5o
asc_42BD10	db '|',0                ; DATA XREF: .text:loc_40BE9Ao
		align 4
; CHAR aShgetfolderpat[]
aShgetfolderpat	db 'SHGetFolderPathA',0 ; DATA XREF: sub_40BF91+50o
aHome		db '\home',0            ; DATA XREF: sub_40C06B+31o
aGnupg		db '\gnupg',0           ; DATA XREF: sub_40C06B+BAo
aCGnupg		db 'c:/gnupg',0         ; DATA XREF: sub_40C06B:loc_40C18Fo
					; sub_40C1A5:loc_40C279o
; char VarName[]
VarName		db 'GNUPGHOME',0        ; DATA XREF: sub_40C1A5:loc_40C1C3o
; CHAR ValueName[]
ValueName	db 'HomeDir',0          ; DATA XREF: sub_40C1A5:loc_40C1FFo
; CHAR aSoftwareGnuGnu[]
aSoftwareGnuGnu	db 'Software\GNU\GnuPG',0 ; DATA XREF: sub_40C1A5+62o
aGpgconf_exe	db '\gpgconf.exe',0     ; DATA XREF: sub_40C285+10o
					; sub_40C93A+597o
		align 10h
; char aRequiredBinary[]
aRequiredBinary	db 'required binary ',27h,'%s',27h,' is not installed',0Ah,0
					; DATA XREF: sub_40C285+44o
aCtl		db 'ctl',0              ; DATA XREF: sub_40C285:loc_40C2D7o
; char aGetmodulefilen[]
aGetmodulefilen	db 'GetModuleFileName failed: %s',0Ah,0 ; DATA XREF: sub_40C338+4Ao
aBin		db 'bin',0              ; DATA XREF: sub_40C338+BBo
		align 10h
; char aBadFilenameSRe[]
aBadFilenameSRe	db 'bad filename `%s',27h,' returned for this process',0Ah,0
					; DATA XREF: sub_40C338+FCo
aCGnupg_0	db 'c:\gnupg',0         ; DATA XREF: sub_40C338:loc_40C459o
aGnu		db '\GNU',0             ; DATA XREF: sub_40C465+99o
aEtcGnupg	db '\etc\gnupg',0       ; DATA XREF: .text:0040C569o
aBin_0		db '\bin',0             ; DATA XREF: sub_40C5EF+28o
aLibGnupg	db '\lib\gnupg',0       ; DATA XREF: .text:0040C665o
aShareGnupg	db '\share\gnupg',0     ; DATA XREF: .text:0040C708o
aShareLocale	db '\share\locale',0    ; DATA XREF: sub_40C78E+1Do
aCWindows	db 'C:\WINDOWS',0       ; DATA XREF: .text:0040C87Bo
aS_dirmngr	db '\S.dirmngr',0       ; DATA XREF: .text:loc_40C89Fo
aGpgAgent_exe	db '\gpg-agent.exe',0   ; DATA XREF: sub_40C93A+36o
aPinentry_exe	db '\pinentry.exe',0    ; DATA XREF: sub_40C93A+CFo
aScdaemon_exe	db '\scdaemon.exe',0    ; DATA XREF: sub_40C93A+168o
aDirmngr_exe	db '\dirmngr.exe',0     ; DATA XREF: sub_40C93A+201o
aGpgProtectTo_1	db '\gpg-protect-tool.exe',0 ; DATA XREF: sub_40C93A+29Ao
aGpgCheckPatter	db '\gpg-check-pattern.exe',0 ; DATA XREF: sub_40C93A+333o
aGpgsm_exe	db '\gpgsm.exe',0       ; DATA XREF: sub_40C93A+3CCo
aGpg2_exe	db '\gpg2.exe',0        ; DATA XREF: sub_40C93A+465o
aGpgConnectAgen	db '\gpg-connect-agent.exe',0 ; DATA XREF: sub_40C93A+4FEo
a____Gnupg22__3	db '../../gnupg2-2.0.30/common/homedir.c',0 ; DATA XREF: sub_40C93A+628o
		align 10h
off_42BF00	dd offset loc_40CF52	; DATA XREF: sub_40C93A+18o
		dd offset loc_40C95B	; jump table for switch	statement
		dd offset loc_40C9F4
		dd offset loc_40CA8D
		dd offset loc_40CB26
		dd offset loc_40CBBF
		dd offset loc_40CC58
		dd offset loc_40CCF1
		dd offset loc_40CD8A
		dd offset loc_40CE23
		dd offset loc_40CEBC
aGnupg_module_n	db 'gnupg_module_name',0 ; DATA XREF: sub_40C93A:loc_40CF52o
aShell32_dll	db 'shell32.dll',0      ; DATA XREF: .data:off_429260o
aShfolder_dll	db 'shfolder.dll',0     ; DATA XREF: .data:00429264o
		align 4
; char Str2[]
Str2		db 'GPG_TTY',0          ; DATA XREF: sub_40D694:loc_40D77Do
					; .data:off_429280o
aTtyname	db 'ttyname',0          ; DATA XREF: .data:off_429284o
aTerm		db 'TERM',0             ; DATA XREF: .data:00429288o
aTtytype	db 'ttytype',0          ; DATA XREF: .data:0042928Co
aDisplay	db 'DISPLAY',0          ; DATA XREF: .data:00429290o
aDisplay_0	db 'display',0          ; DATA XREF: .data:00429294o
aXauthority	db 'XAUTHORITY',0       ; DATA XREF: .data:00429298o
aXauthority_0	db 'xauthority',0       ; DATA XREF: .data:0042929Co
aXmodifiers	db 'XMODIFIERS',0       ; DATA XREF: .data:004292A0o
aGtk_im_module	db 'GTK_IM_MODULE',0    ; DATA XREF: .data:004292A8o
aQt_im_module	db 'QT_IM_MODULE',0     ; DATA XREF: .data:004292B0o
aPinentry_user_	db 'PINENTRY_USER_DATA',0 ; DATA XREF: .data:004292B8o
aPinentryUserDa	db 'pinentry-user-data',0 ; DATA XREF: .data:004292BCo
		align 4
aOptionAllowPin	db 'OPTION allow-pinentry-notify',0 ; DATA XREF: sub_40D9FF+CEo
aPinentry_launc	db 'PINENTRY_LAUNCHED',0 ; DATA XREF: sub_40DAE8+Do
		align 4
; char aIgnoringGpgAge[]
aIgnoringGpgAge	db 'ignoring gpg-agent inquiry `%s',27h,0Ah,0 ; DATA XREF: sub_40DAE8+79o
		align 4
aGetinfoCmd_has	db 'GETINFO cmd_has_option GET_PASSPHRASE repeat',0
					; DATA XREF: sub_40DBAB+7Bo
asc_42C069	db 'X',0                ; DATA XREF: sub_40DBAB:loc_40DCEBo
					; sub_40DBAB:loc_40DCFBo ...
aCheck		db '--check ',0         ; DATA XREF: sub_40DBAB+17Bo
dword_42C074	dd 0			; DATA XREF: sub_40DBAB:loc_40DD2Do
					; sub_40DBAB+30Bo
aGet_passphrase	db 'GET_PASSPHRASE --data %s--repeat=%d -- %s %s %s %s',0
					; DATA XREF: sub_40DBAB+1A2o
aClear_passphra	db 'CLEAR_PASSPHRASE %s',0 ; DATA XREF: .text:0040DF77o
		align 10h
a02x_0		db '%%%02X',0           ; DATA XREF: sub_40DFE4+B6o
		align 4
; char a____Gnupg22__4[]
a____Gnupg22__4	db '../../gnupg2-2.0.30/common/percent.c',0 ; DATA XREF: sub_40E287+5Eo
; char aNNbytes[]
aNNbytes	db 'n == nbytes',0      ; DATA XREF: sub_40E287+66o
		align 4
a____Gnupg22__5	db '../../gnupg2-2.0.30/common/convert.c',0 ; DATA XREF: .text:0040ED9Ao
aHex2str_alloc	db 'hex2str_alloc',0    ; DATA XREF: .text:0040ED8Ao
		align 10h
; char a____Gnupg22__6[]
a____Gnupg22__6	db '../../gnupg2-2.0.30/common/estream.c',0 ; DATA XREF: sub_40F13F+4Do
					; sub_40F13F+1CBo ...
		align 4
; char aMem_cookieMemo[]
aMem_cookieMemo	db 'mem_cookie->memory_size >= mem_cookie->offset',0
					; DATA XREF: sub_40F13F+55o
					; sub_40F13F+1D3o
; char aSizeNleft[]
aSizeNleft	db 'size <= nleft',0    ; DATA XREF: sub_40F13F+20Co
; char aStreamFlags_wr[]
aStreamFlags_wr	db 'stream->flags.writing',0 ; DATA XREF: sub_40FD34+35o
; char aStreamFlags__0[]
aStreamFlags__0	db '!stream->flags.writing',0 ; DATA XREF: sub_40FECD+24o
aR		db 'r',0                ; DATA XREF: .text:00411C68o
					; .text:00411D10o ...
aA		db 'a',0                ; DATA XREF: .text:00411CA3o
					; .text:00411CD8o ...
		align 4
aFatalErrorCrea	db 'fatal: error creating a dummy estream for %d: %s',0Ah,0
					; DATA XREF: .text:00411DD5o
aStdout_0	db '[stdout]',0         ; DATA XREF: .text:00411E72o
aStderr		db '[stderr]',0         ; DATA XREF: .text:loc_411E79o
aStdin_0	db '[stdin]',0          ; DATA XREF: .text:loc_411E80o
a_estream	db '_estream',0         ; DATA XREF: sub_4130A7+BAo
a_tmp		db '.tmp',0             ; DATA XREF: sub_4130A7+165o
a?		db '[?]',0              ; DATA XREF: .text:0041370Eo
aX02x		db 'x%02x',0            ; DATA XREF: sub_41371A+307o
off_42C22C	dd offset loc_413E03	; DATA XREF: sub_413DE8+12r
		dd offset loc_413E12	; jump table for switch	statement
		dd offset loc_413E8A
		dd offset loc_413E8A
		dd offset loc_413E8A
		dd offset loc_413E8A
		dd offset loc_413F02
		dd offset loc_413F02
		dd offset loc_413F02
		dd offset loc_413F02
		dd offset loc_413F02
		dd offset loc_413F02
		dd offset loc_413F02
		dd offset loc_413F02
		dd offset loc_413F3A
		dd offset loc_413F49
		dd offset loc_413F58
		dd offset loc_413F67
		dd offset loc_413F73
off_42C278	dd offset loc_413E7A	; DATA XREF: sub_413DE8+35r
		dd offset loc_413E26	; jump table for switch	statement
		dd offset loc_413E32
		dd offset loc_413E3E
		dd offset loc_413E4A
		dd offset loc_413E56
		dd offset loc_413E62
		dd offset loc_413E6E
off_42C298	dd offset loc_413EF2	; DATA XREF: sub_413DE8+ADr
		dd offset loc_413E9E	; jump table for switch	statement
		dd offset loc_413EAA
		dd offset loc_413EB6
		dd offset loc_413EC2
		dd offset loc_413ECE
		dd offset loc_413EDA
		dd offset loc_413EE6
off_42C2B8	dd offset loc_413FDB	; DATA XREF: sub_413DE8+196r
		dd offset loc_413F87	; jump table for switch	statement
		dd offset loc_413F93
		dd offset loc_413F9F
		dd offset loc_413FAB
		dd offset loc_413FB7
		dd offset loc_413FC3
		dd offset loc_413FCF
off_42C2D8	dd offset loc_41410E	; DATA XREF: sub_413FE9+10Ar
		dd offset loc_41412F	; jump table for switch	statement
		dd offset loc_41412F
		dd offset loc_414114
		dd offset loc_41412F
		dd offset loc_41412F
		dd offset loc_41412F
		dd offset loc_4140FC
		dd offset loc_41412F
		dd offset loc_41412F
		dd offset loc_41412F
		dd offset loc_414108
		dd offset loc_41412F
		dd offset loc_414102
		dd offset loc_41412F
		dd offset loc_41412F
		dd offset loc_41411A
off_42C31C	dd offset loc_41446F	; DATA XREF: sub_413FE9+408r
		dd offset loc_41447C	; jump table for switch	statement
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_4143FA
		dd offset loc_41447C
		dd offset loc_414448
		dd offset loc_41447C
		dd offset loc_414421
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_414462
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_41447C
		dd offset loc_414455
off_42C3D8	dd offset loc_414526, offset loc_414583, offset	loc_414553
					; DATA XREF: sub_413FE9+4B0r
		dd offset loc_414583, offset loc_414502, offset	loc_4144EA ; jump table	for switch statement
		dd offset loc_414514, offset loc_414583, offset	loc_414583
		dd offset loc_414583, offset loc_414583, offset	loc_414583
		dd offset loc_414583, offset loc_414583, offset	loc_414583
		dd offset loc_414583, offset loc_414583, offset	loc_414583
		dd offset loc_414563, offset loc_414583, offset	loc_414583
		dd offset loc_414583, offset loc_414583, offset	loc_4144D2
		dd offset loc_414583, offset loc_414583, offset	loc_414583
		dd offset loc_414583, offset loc_414583, offset	loc_414583
		dd offset loc_414583, offset loc_414583, offset	loc_41451D
		dd offset loc_414583, offset loc_41452F, offset	loc_4144A2
		dd offset loc_4144F6, offset loc_4144DE, offset	loc_41450B
		dd offset loc_414583, offset loc_4144A2, offset	loc_414583
		dd offset loc_414583, offset loc_414583, offset	loc_414573
		dd offset loc_41454A, offset loc_4144AE, offset	loc_414541
		dd offset loc_414583, offset loc_414583, offset	loc_414538
		dd offset loc_414583, offset loc_4144BA, offset	loc_414583
		dd offset loc_414583, offset loc_4144C6
off_42C4B8	dd offset loc_414A1D	; DATA XREF: sub_414761+4Co
		dd offset loc_4147B6	; jump table for switch	statement
		dd offset loc_4147E2
		dd offset loc_41480E
		dd offset loc_414825
		dd offset loc_41483D
		dd offset loc_41486A
		dd offset loc_414894
		dd offset loc_4148A9
		dd offset loc_4148BE
		dd offset loc_4148E8
		dd offset loc_414903
		dd offset loc_414933
		dd offset loc_414948
		dd offset loc_414969
		dd offset loc_414993
		dd offset loc_4149BD
		dd offset loc_4149D5
		dd offset loc_4149F9
		dd offset loc_41497E
		dd offset loc_4147CD
		dd offset loc_4147F9
		dd offset loc_414855
		dd offset loc_41487F
		dd offset loc_4148D3
		dd offset loc_41491E
		dd offset loc_4149AB
		dd offset loc_4149E7
		dd offset loc_414A0B
byte_42C52C	db 27h,	0		; DATA XREF: sub_414ABD+267o
a0123456789abcd	db '0123456789abcdef',0 ; DATA XREF: sub_414ABD+37Eo
a0123456789ab_0	db '0123456789ABCDEF',0 ; DATA XREF: sub_414ABD:loc_414E42o
a0x		db '0x',0               ; DATA XREF: sub_414ABD+550o
a0x_0		db '0X',0               ; DATA XREF: sub_414ABD:loc_415014o
		align 4
off_42C558	dd offset loc_414B1C	; DATA XREF: sub_414ABD+56r
		dd offset loc_414BA4	; jump table for switch	statement
		dd offset loc_414B31
		dd offset loc_414BA4
		dd offset loc_414B44
		dd offset loc_414BA4
		dd offset loc_414B57
		dd offset loc_414BA4
		dd offset loc_414BA4
		dd offset loc_414BA4
		dd offset loc_414BA4
		dd offset loc_414B7D
		dd offset loc_414BA4
		dd offset loc_414B6B
		dd offset loc_414B91
off_42C594	dd offset loc_414BFF	; DATA XREF: sub_414ABD+139r
		dd offset loc_414C86	; jump table for switch	statement
		dd offset loc_414C15
		dd offset loc_414C86
		dd offset loc_414C27
		dd offset loc_414C86
		dd offset loc_414C39
		dd offset loc_414C86
		dd offset loc_414C86
		dd offset loc_414C86
		dd offset loc_414C86
		dd offset loc_414C5F
		dd offset loc_414C4D
		dd offset loc_414C73
off_42C5CC	dd offset loc_415222	; DATA XREF: sub_415150+C9r
		dd offset loc_41522E	; jump table for switch	statement
		dd offset loc_41523A
		dd offset loc_415246
		dd offset loc_415252
		dd offset loc_41525E
		dd offset loc_41526A
		dd offset loc_415276
aNull		db '(null)',0           ; DATA XREF: sub_4155F7+40o
byte_42C5F3	db 30h			; DATA XREF: sub_415798+65r
a123456789abc_0	db '123456789abcdefx',0
		align 4
off_42C608	dd offset loc_4158D4	; DATA XREF: sub_41589F+2Cr
		dd offset loc_4158E0	; jump table for switch	statement
		dd offset loc_415939
		dd offset loc_4158ED
		dd offset loc_4158F9
		dd offset loc_41590D
		dd offset loc_415921
		dd offset loc_41592D
; char a____Gnupg22__7[]
a____Gnupg22__7	db '../../gnupg2-2.0.30/common/estream-printf.c',0
					; DATA XREF: sub_415953+FAo
					; sub_415953+145o ...
; char aArgidxArgspecs[]
aArgidxArgspecs	db 'argidx < argspecs_len',0 ; DATA XREF: sub_415953+102o
		align 4
; char aValuetableArgW[]
aValuetableArgW	db 'valuetable[arg->width_pos-1].vt == VALTYPE_INT',0
					; DATA XREF: sub_415953+14Do
		align 4
; char aValuetableArgP[]
aValuetableArgP	db 'valuetable[arg->precision_pos-1].vt == VALTYPE_INT',0
					; DATA XREF: sub_415953+1D9o
		align 10h
; char aArgVtValuetabl[]
aArgVtValuetabl	db 'arg->vt == valuetable[arg->arg_pos-1].vt',0 ; DATA XREF: sub_415953+26Eo
; char aBug[]
aBug		db '!"bug"',0           ; DATA XREF: sub_415953+2CFo
off_42C700	dd offset loc_415C12	; DATA XREF: sub_415953+2B6r
		dd offset loc_415C33	; jump table for switch	statement
		dd offset loc_415C33
		dd offset loc_415C33
		dd offset loc_415C33
		dd offset loc_415C33
		dd offset loc_415C77
		dd offset loc_415C77
		dd offset loc_415C77
		dd offset loc_415C77
		dd offset loc_415C77
		dd offset loc_415C77
		dd offset loc_415C77
		dd offset loc_415C77
		dd offset loc_415CBB
		dd offset loc_415CFF
		dd offset loc_415D43
		dd offset loc_415CFF
		dd offset loc_415D84
byte_42C74C	db 0			; DATA XREF: sub_416588+5Fo
					; sub_416783+75o
; char aParm_used[]
aParm_used	db 'parm.used',0        ; DATA XREF: sub_416783+FDo
		align 4
aEstream_asprin	db 'estream_asprintf failed: %s',0Ah,0 ; DATA XREF: .text:0041690Co
		align 4
a04d02d02dt02d0	db '%04d%02d%02dT%02d%02d%02d',0 ; DATA XREF: sub_4169F8+72o
					; .text:0041703Ao ...
aGnupg_get_time	db 'gnupg_get_time() failed',0Ah,0 ; DATA XREF: .text:00416B40o
aUyUdUhUm	db '%uy%ud%uh%um',0     ; DATA XREF: .text:00417150o
a????????	db '????-??-??',0       ; DATA XREF: .text:004171DAo
					; .text:00417330o
a04d02d02d	db '%04d-%02d-%02d',0   ; DATA XREF: .text:0041722Fo
a??????????????	db '????-??-?? ??:??:??',0 ; DATA XREF: .text:00417271o
a04d02d02d02d02	db '%04d-%02d-%02d %02d:%02d:%02d',0 ; DATA XREF: .text:004172E0o
aCZ		db '%c %Z',0            ; DATA XREF: .text:00417372o
		align 4
a____Gnupg22__8	db '../../gnupg2-2.0.30/common/gettime.c',0 ; DATA XREF: sub_417429+E7o
aNone		db '[none]',0           ; DATA XREF: .text:loc_41783Do
a_4s_2s_2s_2s_2	db '%.4s-%.2s-%.2s %.2s:%.2s:%s',0 ; DATA XREF: .text:0041788Co
aDays_per_month	db 'days_per_month',0   ; DATA XREF: sub_417429:loc_417500o
		align 4
; char a____Gnupg22__9[]
a____Gnupg22__9	db '../../gnupg2-2.0.30/common/iobuf.c',0 ; DATA XREF: sub_417FEA+1Bo
					; sub_4181BA+15o ...
; char aFname[]
aFname		db 'fname',0            ; DATA XREF: sub_417FEA+23o
					; sub_41831F+1Co
; char aFd_cache_inval[]
aFd_cache_inval	db 'fd_cache_invalidate (%s)',0Ah,0 ; DATA XREF: sub_417FEA+3Fo
; char aDidS[]
aDidS		db '                did (%s)',0Ah,0 ; DATA XREF: sub_417FEA+8Co
; char aFp[]
aFp		db 'fp',0               ; DATA XREF: sub_4181BA+1Do
; char aFd_cache_close[]
aFd_cache_close	db 'fd_cache_close (%d) real',0Ah,0 ; DATA XREF: sub_4181BA+5Do
		align 10h
; char aFd_cache_clo_0[]
aFd_cache_clo_0	db 'fd_cache_close (%s) used existing slot',0Ah,0
					; DATA XREF: sub_4181BA+B9o
; char aFd_cache_clo_1[]
aFd_cache_clo_1	db 'fd_cache_close (%s) new slot created',0Ah,0 ; DATA XREF: sub_4181BA+E8o
		align 10h
; char aFd_cache_openS[]
aFd_cache_openS	db 'fd_cache_open (%s) using cached fp',0Ah,0 ; DATA XREF: sub_41831F+84o
; char aRewindFileFail[]
aRewindFileFail	db 'rewind file failed on handle %p: ec=%d',0Ah,0
					; DATA XREF: sub_41831F+CFo
; char aFd_cache_ope_0[]
aFd_cache_ope_0	db 'fd_cache_open (%s) not cached',0Ah,0 ; DATA XREF: sub_41831F+109o
; char aSize[]
aSize		db 'size',0             ; DATA XREF: sub_418448+4Ao
					; sub_4186F4+42o ...
; char aSReadErrorEcD[]
aSReadErrorEcD	db '%s: read error: ec=%d',0Ah,0 ; DATA XREF: sub_418448+DCo
; char aSWriteErrorEcD[]
aSWriteErrorEcD	db '%s: write error: ec=%d',0Ah,0 ; DATA XREF: sub_418448+197o
aFile_filterFd	db 'file_filter(fd)',0  ; DATA XREF: sub_418448+205o
; char aSCloseHandleP[]
aSCloseHandleP	db '%s: close handle %p',0Ah,0 ; DATA XREF: sub_418448+260o
; char aSocketReadErro[]
aSocketReadErro	db 'socket read error: ec=%d',0Ah,0 ; DATA XREF: sub_4186F4+BDo
; char aSocketWriteErr[]
aSocketWriteErr	db 'socket write error: ec=%d',0Ah,0 ; DATA XREF: sub_4186F4+167o
aSock_filter	db 'sock_filter',0      ; DATA XREF: sub_4186F4+1CFo
		align 4
; char aBlock_filter1s[]
aBlock_filter1s	db 'block_filter: 1st length byte missing',0Ah,0
					; DATA XREF: sub_4188FD+141o
		align 10h
; char aBlock_filter2n[]
aBlock_filter2n	db 'block_filter: 2nd length byte missing',0Ah,0
					; DATA XREF: sub_4188FD+229o
		align 4
; char aBlock_filterIn[]
aBlock_filterIn	db 'block_filter: invalid 4 byte length',0Ah,0 ; DATA XREF: sub_4188FD+452o
		align 10h
; char aBlock_filterPR[]
aBlock_filterPR	db 'block_filter %p: read error (size=%lu,a->size=%lu)',0Ah,0
					; DATA XREF: sub_4188FD+551o
; char aABuflenOp_min_[]
aABuflenOp_min_	db 'a->buflen <= OP_MIN_PARTIAL_CHUNK',0 ; DATA XREF: sub_4188FD+60Do
; char aC0x1f[]
aC0x1f		db 'c <= 0x1f',0        ; DATA XREF: sub_4188FD+6C3o
; char aNOp_min_partia[]
aNOp_min_partia	db 'n == OP_MIN_PARTIAL_CHUNK',0 ; DATA XREF: sub_4188FD+710o
; char aABuflen[]
aABuflen	db '!a->buflen',0       ; DATA XREF: sub_4188FD+7E0o
; char aNbytesOp_min_p[]
aNbytesOp_min_p	db 'nbytes < OP_MIN_PARTIAL_CHUNK',0 ; DATA XREF: sub_4188FD+805o
; char aInitBlock_filt[]
aInitBlock_filt	db 'init block_filter %p',0Ah,0 ; DATA XREF: sub_4188FD+88Fo
aBlock_filter_0	db 'block_filter',0     ; DATA XREF: sub_4188FD+90Bo
		align 4
; char aBlock_filterWr[]
aBlock_filterWr	db 'block_filter: write error: %s',0Ah,0 ; DATA XREF: sub_4188FD+AA1o
; char aBlock_filterPe[]
aBlock_filterPe	db 'block_filter: pending bytes!',0Ah,0 ; DATA XREF: sub_4188FD+AFFo
; char aFreeBlock_filt[]
aFreeBlock_filt	db 'free block_filter %p',0Ah,0 ; DATA XREF: sub_4188FD+B1Bo
aNone_0		db '[none]',0           ; DATA XREF: sub_419438+22o
a?_0		db '?',0                ; DATA XREF: sub_419438:loc_4194BCo
					; sub_4195A1:loc_419670o ...
; char aIobufChainD_DS[]
aIobufChainD_DS	db 'iobuf chain: %d.%d `%s',27h,' filter_eof=%d start=%d len=%d',0Ah,0
					; DATA XREF: sub_419438+ADo
; char aIobuf_closeP[]
aIobuf_closeP	db 'iobuf_close -> %p',0Ah,0 ; DATA XREF: sub_4195A1+5Co
		align 10h
; char aIobuf_flushFai[]
aIobuf_flushFai	db 'iobuf_flush failed on close: %s',0Ah,0 ; DATA XREF: sub_4195A1+A8o
; char aIobufD_DCloseS[]
aIobufD_DCloseS	db 'iobuf-%d.%d: close `%s',27h,0Ah,0 ; DATA XREF: sub_4195A1+ECo
		align 4
; char aIobufctrl_free[]
aIobufctrl_free	db 'IOBUFCTRL_FREE failed on close: %s',0Ah,0 ; DATA XREF: sub_4195A1+14Co
aStdin_1	db '[stdin]',0          ; DATA XREF: sub_4199B9+46o
; char aRb_0[]
aRb_0		db 'rb',0               ; DATA XREF: sub_4199B9+7Do
					; sub_4199B9:loc_419A4Bo
; char aIobufD_DOpenSF[]
aIobufD_DOpenSF	db 'iobuf-%d.%d: open `%s',27h,' fd=%d',0Ah,0 ; DATA XREF: sub_4199B9+1D3o
; char aFdD[]
aFdD		db '[fd %d]',0          ; DATA XREF: sub_419BA0+63o
; char aIobufD_DFdopen[]
aIobufD_DFdopen	db 'iobuf-%d.%d: fdopen `%s',27h,0Ah,0 ; DATA XREF: sub_419BA0+111o
aSockD		db '[sock %d]',0        ; DATA XREF: .text:00419D42o
aIobufD_DSockop	db 'iobuf-%d.%d: sockopen `%s',27h,0Ah,0 ; DATA XREF: .text:00419DF0o
aStdout_1	db '[stdout]',0         ; DATA XREF: .text:00419E63o
aWb_0		db 'wb',0               ; DATA XREF: .text:00419E9Ao
					; .text:loc_419EAFo
aIobufD_DCreate	db 'iobuf-%d.%d: create `%s',27h,0Ah,0 ; DATA XREF: .text:00419FF9o
aRB		db 'r+b',0              ; DATA XREF: .text:loc_41A024o
aIobufD_DOpenrw	db 'iobuf-%d.%d: openrw `%s',27h,0Ah,0 ; DATA XREF: .text:0041A15Fo
		align 4
; char aIobufD_DIoctlS[]
aIobufD_DIoctlS	db 'iobuf-%d.%d: ioctl `%s',27h,' keep=%d',0Ah,0 ; DATA XREF: sub_41A174+74o
		align 4
; char aIobuf_IoctlSIn[]
aIobuf_IoctlSIn	db 'iobuf-*.*: ioctl `%s',27h,' invalidate',0Ah,0
					; DATA XREF: sub_41A174+11Fo
		align 10h
; char aIobufD_DIoct_0[]
aIobufD_DIoct_0	db 'iobuf-%d.%d: ioctl `%s',27h,' no_cache=%d',0Ah,0
					; DATA XREF: sub_41A174+1D9o
aNull_0		db '<null>',0           ; DATA XREF: sub_41A174:loc_41A3E9o
; char aIobuf_IoctlSFs[]
aIobuf_IoctlSFs	db 'iobuf-*.*: ioctl `%s',27h,' fsync',0Ah,0 ; DATA XREF: sub_41A174+27Eo
		align 4
; char aIOFilterTooDee[]
aIOFilterTooDee	db 'i/o filter too deeply nested - corrupted data?',0Ah,0
					; DATA XREF: sub_41A451+6Eo
; char aIobufD_DPushS[]
aIobufD_DPushS	db 'iobuf-%d.%d: push `%s',27h,0Ah,0 ; DATA XREF: sub_41A451+2B9o
; char aIobufctrl_init[]
aIobufctrl_init	db 'IOBUFCTRL_INIT failed: %s',0Ah,0 ; DATA XREF: sub_41A451+324o
; char aIobufD_DPopS[]
aIobufD_DPopS	db 'iobuf-%d.%d: pop `%s',27h,0Ah,0 ; DATA XREF: sub_41A78C+75o
; char aB[]
aB		db 'b',0                ; DATA XREF: sub_41A78C+AEo
; char aPop_filterFilt[]
aPop_filterFilt	db 'pop_filter(): filter function not found',0Ah,0
					; DATA XREF: sub_41A78C+194o
		align 4
; char aIobuf_flushF_0[]
aIobuf_flushF_0	db 'iobuf_flush failed in pop_filter: %s',0Ah,0 ; DATA XREF: sub_41A78C+1CDo
; char aIobufctrl_fr_0[]
aIobufctrl_fr_0	db 'IOBUFCTRL_FREE failed: %s',0Ah,0 ; DATA XREF: sub_41A78C+235o
					; sub_41AB23+39Co
		align 4
; char aCanTRemoveTheL[]
aCanTRemoveTheL	db 'can',27h,'t remove the last filter from the chain',0Ah,0
					; DATA XREF: sub_41A78C+287o
; char aIobufD_DPopped[]
aIobufD_DPopped	db 'iobuf-%d.%d: popped filter',0Ah,0 ; DATA XREF: sub_41A78C+35Co
		align 4
; char aOhhJeeeTryingT[]
aOhhJeeeTryingT	db 'Ohh jeee, trying to remove a head filter',0Ah,0
					; DATA XREF: sub_41A78C+374o
		align 10h
; char aOhhJeeeTryin_0[]
aOhhJeeeTryin_0	db 'Ohh jeee, trying to remove an intermediate filter',0Ah,0
					; DATA XREF: sub_41A78C:loc_41AB0Co
; char aAD_startAD_len[]
aAD_startAD_len	db 'a->d.start == a->d.len',0 ; DATA XREF: sub_41AB23+29o
		align 4
; char aIobufD_DPopSIn[]
aIobufD_DPopSIn	db 'iobuf-%d.%d: pop `%s',27h,' in underflow',0Ah,0
					; DATA XREF: sub_41AB23+A6o
; char aIobufD_DUnderf[]
aIobufD_DUnderf	db 'iobuf-%d.%d: underflow: eof (due to filter eof)',0Ah,0
					; DATA XREF: sub_41AB23+17Do
; char aIobufD_DError[]
aIobufD_DError	db 'iobuf-%d.%d: error',0Ah,0 ; DATA XREF: sub_41AB23+1BAo
		align 4
; char aIobufD_DUnde_0[]
aIobufD_DUnde_0	db 'iobuf-%d.%d: underflow: req=%lu',0Ah,0 ; DATA XREF: sub_41AB23+2B9o
		align 4
; char aIobufD_DUnde_1[]
aIobufD_DUnde_1	db 'iobuf-%d.%d: underflow: got=%lu rc=%d',0Ah,0
					; DATA XREF: sub_41AB23+327o
		align 4
; char aIobufD_DPopInU[]
aIobufD_DPopInU	db 'iobuf-%d.%d: pop in underflow (!len)',0Ah,0 ; DATA XREF: sub_41AB23+43Bo
; char aIobufD_DUnde_2[]
aIobufD_DUnde_2	db 'iobuf-%d.%d: underflow: eof',0Ah,0 ; DATA XREF: sub_41AB23+521o
		align 4
; char aIobufD_DUnde_3[]
aIobufD_DUnde_3	db 'iobuf-%d.%d: underflow: eof (no filter)',0Ah,0
					; DATA XREF: sub_41AB23+584o
		align 4
; char aIncreasingTemp[]
aIncreasingTemp	db 'increasing temp iobuf from %lu to %lu',0Ah,0 ; DATA XREF: sub_41B0C0+52o
; char aFlushOnNonOutp[]
aFlushOnNonOutp	db 'flush on non-output iobuf',0Ah,0 ; DATA XREF: sub_41B0C0+C1o
; char aIobuf_flushNoF[]
aIobuf_flushNoF	db 'iobuf_flush: no filter',0Ah,0 ; DATA XREF: sub_41B0C0+D7o
		align 10h
; char aIobuf_flushDid[]
aIobuf_flushDid	db 'iobuf_flush did not write all!',0Ah,0 ; DATA XREF: sub_41B0C0+136o
aAD_start1	db 'a->d.start == 1',0  ; DATA XREF: .text:0041B4F9o
; char aAD_lenAD_size[]
aAD_lenAD_size	db 'a->d.len < a->d.size',0 ; DATA XREF: sub_41B555+75o
; char aFstatFailedS[]
aFstatFailedS	db 'fstat() failed: %s',0Ah,0 ; DATA XREF: sub_41B864+6Co
; CHAR aKernel32_dll[]
aKernel32_dll	db 'kernel32.dll',0     ; DATA XREF: sub_41B864+C8o
; CHAR aGetfilesizeex[]
aGetfilesizeex	db 'GetFileSizeEx',0    ; DATA XREF: sub_41B864+DDo
; char aGetfilesizeFor[]
aGetfilesizeFor	db 'GetFileSize for handle %p failed: %s',0Ah,0 ; DATA XREF: sub_41B864+1A9o
aCanTSeekS	db 'can',27h,'t seek: %s',0Ah,0 ; DATA XREF: .text:0041BB24o
		align 4
aSetfilepointer	db 'SetFilePointer failed on handle %p: ec=%d',0Ah,0
					; DATA XREF: .text:0041BBCFo
		align 4
aPop_filterCall	db 'pop_filter called in iobuf_seek - please report',0Ah,0
					; DATA XREF: .text:0041BC4Fo
aAUse1AUse2	db 'a->use == 1 || a->use == 2',0 ; DATA XREF: .text:0041BD7Co
aPop_filterCa_0	db 'pop_filter called in set_partial_block_mode - please report',0Ah,0
					; DATA XREF: .text:0041BDA5o
		align 4
; char aGetstdhandleDF[]
aGetstdhandleDF	db 'GetStdHandle(%d) failed: ec=%d',0Ah,0 ; DATA XREF: sub_41BFE6+78o
aIobuf_write	db 'iobuf_write',0      ; DATA XREF: sub_41B5FA+16o
aIobuf_writebyt	db 'iobuf_writebyte',0  ; DATA XREF: sub_41B555+10o
aPop_filter	db 'pop_filter',0       ; DATA XREF: sub_41A78C+21o
aIobuf_push_fil	db 'iobuf_push_filter2',0 ; DATA XREF: sub_41A451+21o
aBlock_filter	db 'block_filter',0     ; DATA XREF: sub_4188FD:loc_418DD0o
					; sub_4188FD:loc_419156o ...
		align 4
aPutenv		db 'putenv=',0          ; DATA XREF: sub_41C222+28o
byte_42D2D4	db 0			; DATA XREF: sub_41C222:loc_41C251o
					; sub_41C2DE:loc_41C43Eo
aOptionSSS	db 'OPTION %s%s=%s',0   ; DATA XREF: sub_41C222+46o
; char aGpg_tty_0[]
aGpg_tty_0	db 'GPG_TTY',0          ; DATA XREF: sub_41C2DE+FBo
aLcCtype	db 'lc-ctype',0         ; DATA XREF: sub_41C2DE+1A3o
aLcMessages	db 'lc-messages',0      ; DATA XREF: sub_41C2DE+21Bo
; CHAR Name[]
Name		db 'GnuPG_spawn_agent_sentinel',0 ; DATA XREF: sub_41C528+6o
; char aFailedToCrea_0[]
aFailedToCrea_0	db 'failed to create the spawn_agent mutex: %s',0Ah,0
					; DATA XREF: sub_41C528+45o
; char aErrorWaitingFo[]
aErrorWaitingFo	db 'error waiting for the spawn_agent mutex: timeout',0Ah,0
					; DATA XREF: sub_41C528+92o
		align 4
; char aErrorWaiting_0[]
aErrorWaiting_0	db 'error waiting for the spawn_agent mutex: (code=%d) %s',0Ah,0
					; DATA XREF: sub_41C528+B7o
		align 4
; char aFailedToReleas[]
aFailedToReleas	db 'failed to release the spawn_agent mutex: %s',0Ah,0
					; DATA XREF: sub_41C5F9+35o
		align 4
; char aErrorAllocat_3[]
aErrorAllocat_3	db 'error allocating assuan context: %s',0Ah,0 ; DATA XREF: sub_41C657+39o
; char aGpg_agent_info[]
aGpg_agent_info	db 'GPG_AGENT_INFO',0   ; DATA XREF: sub_41C657+56o
aS_gpgAgent	db 'S.gpg-agent',0      ; DATA XREF: sub_41C657+88o
; char aNoRunningGpgAg[]
aNoRunningGpgAg	db 'no running gpg-agent - starting one',0Ah,0 ; DATA XREF: sub_41C657+D3o
aStarting_agent	db 'starting_agent ? 0 0',0 ; DATA XREF: sub_41C657+F5o
		align 10h
; char aErrorFlushingP[]
aErrorFlushingP	db 'error flushing pending output: %s',0Ah,0 ; DATA XREF: sub_41C657+151o
aUseStandardSoc	db '--use-standard-socket-p',0 ; DATA XREF: sub_41C657:loc_41C7F1o
		align 4
; char aStartingSForTe[]
aStartingSForTe	db 'starting `%s',27h,' for testing failed: %s',0Ah,0
					; DATA XREF: sub_41C657+1F8o
		align 4
; char aRunningSForTes[]
aRunningSForTes	db 'running `%s',27h,' for testing failed: %s',0Ah,0
					; DATA XREF: sub_41C657+246o
aDaemon		db '--daemon',0         ; DATA XREF: sub_41C657+267o
aUseStandardS_0	db '--use-standard-socket',0 ; DATA XREF: sub_41C657+26Eo
; char aFailedToStartA[]
aFailedToStartA	db 'failed to start agent `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_41C657+2FEo
; char aWaitingDSecond[]
aWaitingDSecond	db 'waiting %d seconds for the agent to come up',0Ah,0
					; DATA XREF: sub_41C657+312o
aServer		db '--server',0         ; DATA XREF: sub_41C657+3B9o
		align 10h
; char aMalformedGpg_a[]
aMalformedGpg_a	db 'malformed GPG_AGENT_INFO environment variable',0Ah,0
					; DATA XREF: sub_41C657:loc_41CAF6o
		align 10h
; char aGpgAgentProtoc[]
aGpgAgentProtoc	db 'gpg-agent protocol version %d is not supported',0Ah,0
					; DATA XREF: sub_41C657+527o
; char aCanTConnectToT[]
aCanTConnectToT	db 'can',27h,'t connect to the agent - trying fall back',0Ah,0
					; DATA XREF: sub_41C657+59Do
		align 10h
; char aCanTConnectT_0[]
aCanTConnectT_0	db 'can',27h,'t connect to the agent: %s',0Ah,0 ; DATA XREF: sub_41C657+5D5o
; char aConnectionToAg[]
aConnectionToAg	db 'connection to agent established',0Ah,0 ; DATA XREF: sub_41C657+603o
aReset		db 'RESET',0            ; DATA XREF: sub_41C657+642o
		align 4
; char aFailedToTransl[]
aFailedToTransl	db 'failed to translate osfhandle %p',0Ah,0 ; DATA XREF: sub_41CD9F+3Eo
a_tmp_0		db '.tmp',0             ; DATA XREF: .text:0041CFA0o
aWB		db 'w+b',0              ; DATA XREF: .text:loc_41D03Ao
		align 4
aGnupg_allow_se	db 'gnupg_allow_set_foregound_window',0 ; DATA XREF: sub_41D0C0+13o
		align 4
; char aSCalledWithInv[]
aSCalledWithInv	db '%s called with invalid pid %lu',0Ah,0 ; DATA XREF: sub_41D0C0+1Bo
; char aAllowsetforegr[]
aAllowsetforegr	db 'AllowSetForegroundWindow(%lu) failed: %s',0Ah,0
					; DATA XREF: sub_41D0C0+61o
		align 4
; char Control[4]
Control		db ' ',9,0Ah,0Bh        ; DATA XREF: sub_41D7C3:loc_41D7EEo
		db 0Ch,	22h, 0
; char aDuplicatehandl[]
aDuplicatehandl	db 'DuplicateHandle failed: %s',0Ah,0 ; DATA XREF: sub_41D9D9+BCo
; CHAR FileName[]
FileName	db 'nul',0              ; DATA XREF: sub_41DAFF+44o
; char aCanTOpenNulS[]
aCanTOpenNulS	db 'can',27h,'t open `nul',27h,': %s',0Ah,0 ; DATA XREF: sub_41DAFF+6Eo
		align 4
aFailedToTran_0	db 'failed to translate osfhandle %p',0Ah,0 ; DATA XREF: .text:0041DBECo
					; .text:0041DC3Bo ...
		align 4
aNoFileDescript	db 'no file descriptor for file passed to gnupg_spawn_process',0Ah,0
					; DATA XREF: .text:loc_41DD09o
aErrorCreatingA	db 'error creating a pipe: %s',0Ah,0 ; DATA XREF: .text:0041DD92o
; char aCreateprocessF[]
aCreateprocessF	db 'CreateProcess failed: %s',0Ah,0 ; DATA XREF: .text:0041DE95o
					; sub_41DFF0+1CCo
aR_0		db 'r',0                ; DATA XREF: .text:loc_41DF77o
		align 4
aCanTFdopenPipe	db 'can',27h,'t fdopen pipe for reading: %s',0Ah,0
					; DATA XREF: .text:0041DFADo
		align 10h
; char aWaitingForProc[]
aWaitingForProc	db 'waiting for process %d to terminate failed: %s',0Ah,0
					; DATA XREF: sub_41E25F+6Do
; char aErrorGettingEx[]
aErrorGettingEx	db 'error getting exit code of process %d: %s',0Ah,0
					; DATA XREF: sub_41E25F+C1o
		align 4
; char aErrorRunningSE[]
aErrorRunningSE	db 'error running `%s',27h,': exit status %d',0Ah,0
					; DATA XREF: sub_41E25F+F5o
; char aWaitforsingleo[]
aWaitforsingleo	db 'WaitForSingleObject returned unexpected code %d for pid %d',0Ah,0
					; DATA XREF: sub_41E25F+163o
; char aCreateprocessD[]
aCreateprocessD	db 'CreateProcess(detached) failed: %s',0Ah,0 ; DATA XREF: sub_41E3EE+142o
; char aLc_all[]
aLc_all		db 'LC_ALL',0           ; DATA XREF: sub_41E584+6o
; char aLang[]
aLang		db 'LANG',0             ; DATA XREF: sub_41E584:loc_41E5D7o
aAf_za		db 'af_ZA',0            ; DATA XREF: sub_41E584:loc_41E642o
aSq_al		db 'sq_AL',0            ; DATA XREF: sub_41E584:loc_41E64Co
aAm_et		db 'am_ET',0            ; DATA XREF: sub_41E584:loc_41E656o
aAr_sa		db 'ar_SA',0            ; DATA XREF: sub_41E584:loc_41E679o
aAr_iq		db 'ar_IQ',0            ; DATA XREF: sub_41E584:loc_41E683o
aAr_eg		db 'ar_EG',0            ; DATA XREF: sub_41E584:loc_41E68Do
aAr_ly		db 'ar_LY',0            ; DATA XREF: sub_41E584:loc_41E697o
aAr_dz		db 'ar_DZ',0            ; DATA XREF: sub_41E584:loc_41E6A1o
aAr_ma		db 'ar_MA',0            ; DATA XREF: sub_41E584:loc_41E6ABo
aAr_tn		db 'ar_TN',0            ; DATA XREF: sub_41E584:loc_41E6B5o
aAr_om		db 'ar_OM',0            ; DATA XREF: sub_41E584:loc_41E6BFo
aAr_ye		db 'ar_YE',0            ; DATA XREF: sub_41E584:loc_41E6C9o
aAr_sy		db 'ar_SY',0            ; DATA XREF: sub_41E584:loc_41E6D3o
aAr_jo		db 'ar_JO',0            ; DATA XREF: sub_41E584:loc_41E6DDo
aAr_lb		db 'ar_LB',0            ; DATA XREF: sub_41E584:loc_41E6E7o
aAr_kw		db 'ar_KW',0            ; DATA XREF: sub_41E584:loc_41E6F1o
aAr_ae		db 'ar_AE',0            ; DATA XREF: sub_41E584:loc_41E6FBo
aAr_bh		db 'ar_BH',0            ; DATA XREF: sub_41E584:loc_41E705o
aAr_qa		db 'ar_QA',0            ; DATA XREF: sub_41E584:loc_41E70Fo
aAr		db 'ar',0               ; DATA XREF: sub_41E584:loc_41E719o
aHy_am		db 'hy_AM',0            ; DATA XREF: sub_41E584:loc_41E723o
aAs_in		db 'as_IN',0            ; DATA XREF: sub_41E584:loc_41E72Do
aAz_az@latin	db 'az_AZ@latin',0      ; DATA XREF: sub_41E584:loc_41E746o
aAz_az@cyrillic	db 'az_AZ@cyrillic',0   ; DATA XREF: sub_41E584:loc_41E750o
aAz		db 'az',0               ; DATA XREF: sub_41E584:loc_41E75Ao
aEu		db 'eu',0               ; DATA XREF: sub_41E584:loc_41E764o
aBe_by		db 'be_BY',0            ; DATA XREF: sub_41E584:loc_41E76Eo
aBn_in		db 'bn_IN',0            ; DATA XREF: sub_41E584:loc_41E787o
aBn_bd		db 'bn_BD',0            ; DATA XREF: sub_41E584:loc_41E791o
aBn		db 'bn',0               ; DATA XREF: sub_41E584:loc_41E79Bo
aBg_bg		db 'bg_BG',0            ; DATA XREF: sub_41E584:loc_41E7A5o
aMy_mm		db 'my_MM',0            ; DATA XREF: sub_41E584:loc_41E7AFo
aKm_kh		db 'km_KH',0            ; DATA XREF: sub_41E584:loc_41E7B9o
aCa_es		db 'ca_ES',0            ; DATA XREF: sub_41E584:loc_41E7C3o
aChr_us		db 'chr_US',0           ; DATA XREF: sub_41E584:loc_41E7CDo
aZh_tw		db 'zh_TW',0            ; DATA XREF: sub_41E584:loc_41E7ECo
aZh_cn		db 'zh_CN',0            ; DATA XREF: sub_41E584:loc_41E7F6o
aZh_hk		db 'zh_HK',0            ; DATA XREF: sub_41E584:loc_41E800o
aZh_sg		db 'zh_SG',0            ; DATA XREF: sub_41E584:loc_41E80Ao
aZh_mo		db 'zh_MO',0            ; DATA XREF: sub_41E584:loc_41E814o
aZh		db 'zh',0               ; DATA XREF: sub_41E584:loc_41E81Eo
aHr_hr		db 'hr_HR',0            ; DATA XREF: sub_41E584+2B6o
aSr_cs		db 'sr_CS',0            ; DATA XREF: sub_41E584:loc_41E844o
aSr_cs@cyrillic	db 'sr_CS@cyrillic',0   ; DATA XREF: sub_41E584:loc_41E84Eo
aHr		db 'hr',0               ; DATA XREF: sub_41E584:loc_41E858o
aCs_cz		db 'cs_CZ',0            ; DATA XREF: sub_41E584:loc_41E862o
aDa_dk		db 'da_DK',0            ; DATA XREF: sub_41E584:loc_41E86Co
aDiv_mv		db 'div_MV',0           ; DATA XREF: sub_41E584:loc_41E876o
aNl_nl		db 'nl_NL',0            ; DATA XREF: sub_41E584:loc_41E88Fo
aNl_be		db 'nl_BE',0            ; DATA XREF: sub_41E584:loc_41E899o
aNl		db 'nl',0               ; DATA XREF: sub_41E584:loc_41E8A3o
aBin_ng		db 'bin_NG',0           ; DATA XREF: sub_41E584:loc_41E8ADo
aEn_us		db 'en_US',0            ; DATA XREF: sub_41E584:loc_41E8D0o
aEn_gb		db 'en_GB',0            ; DATA XREF: sub_41E584:loc_41E8DAo
aEn_au		db 'en_AU',0            ; DATA XREF: sub_41E584:loc_41E8E4o
aEn_ca		db 'en_CA',0            ; DATA XREF: sub_41E584:loc_41E8EEo
aEn_nz		db 'en_NZ',0            ; DATA XREF: sub_41E584:loc_41E8F8o
aEn_ie		db 'en_IE',0            ; DATA XREF: sub_41E584:loc_41E902o
aEn_za		db 'en_ZA',0            ; DATA XREF: sub_41E584:loc_41E90Co
aEn_jm		db 'en_JM',0            ; DATA XREF: sub_41E584:loc_41E916o
aEn_gd		db 'en_GD',0            ; DATA XREF: sub_41E584:loc_41E920o
aEn_bz		db 'en_BZ',0            ; DATA XREF: sub_41E584:loc_41E92Ao
aEn_tt		db 'en_TT',0            ; DATA XREF: sub_41E584:loc_41E934o
aEn_zw		db 'en_ZW',0            ; DATA XREF: sub_41E584:loc_41E93Eo
aEn_ph		db 'en_PH',0            ; DATA XREF: sub_41E584:loc_41E948o
aEn_id		db 'en_ID',0            ; DATA XREF: sub_41E584:loc_41E952o
aEn_hk		db 'en_HK',0            ; DATA XREF: sub_41E584:loc_41E95Co
aEn_in		db 'en_IN',0            ; DATA XREF: sub_41E584:loc_41E966o
aEn_my		db 'en_MY',0            ; DATA XREF: sub_41E584:loc_41E970o
aEn_sg		db 'en_SG',0            ; DATA XREF: sub_41E584:loc_41E97Ao
aEn		db 'en',0               ; DATA XREF: sub_41E584:loc_41E984o
aEt_ee		db 'et_EE',0            ; DATA XREF: sub_41E584:loc_41E98Eo
aFo_fo		db 'fo_FO',0            ; DATA XREF: sub_41E584:loc_41E998o
aFa_ir		db 'fa_IR',0            ; DATA XREF: sub_41E584:loc_41E9A2o
aFi_fi		db 'fi_FI',0            ; DATA XREF: sub_41E584:loc_41E9ACo
aFr_fr		db 'fr_FR',0            ; DATA XREF: sub_41E584:loc_41E9CFo
aFr_be		db 'fr_BE',0            ; DATA XREF: sub_41E584:loc_41E9D9o
aFr_ca		db 'fr_CA',0            ; DATA XREF: sub_41E584:loc_41E9E3o
aFr_ch		db 'fr_CH',0            ; DATA XREF: sub_41E584:loc_41E9EDo
aFr_lu		db 'fr_LU',0            ; DATA XREF: sub_41E584:loc_41E9F7o
aFr_mc		db 'fr_MC',0            ; DATA XREF: sub_41E584:loc_41EA01o
aFr		db 'fr',0               ; DATA XREF: sub_41E584:loc_41EA0Bo
					; sub_41E584:loc_41EA65o
aFr_re		db 'fr_RE',0            ; DATA XREF: sub_41E584:loc_41EA15o
aFr_cg		db 'fr_CG',0            ; DATA XREF: sub_41E584:loc_41EA1Fo
aFr_sn		db 'fr_SN',0            ; DATA XREF: sub_41E584:loc_41EA29o
aFr_cm		db 'fr_CM',0            ; DATA XREF: sub_41E584:loc_41EA33o
aFr_ci		db 'fr_CI',0            ; DATA XREF: sub_41E584:loc_41EA3Do
aFr_ml		db 'fr_ML',0            ; DATA XREF: sub_41E584:loc_41EA47o
aFr_ma		db 'fr_MA',0            ; DATA XREF: sub_41E584:loc_41EA51o
aFr_ht		db 'fr_HT',0            ; DATA XREF: sub_41E584:loc_41EA5Bo
aFy_nl		db 'fy_NL',0            ; DATA XREF: sub_41E584:loc_41EA6Fo
aFul_ng		db 'ful_NG',0           ; DATA XREF: sub_41E584:loc_41EA79o
aGd_gb		db 'gd_GB',0            ; DATA XREF: sub_41E584:loc_41EA92o
aGa_ie		db 'ga_IE',0            ; DATA XREF: sub_41E584:loc_41EA9Co
aC		db 'C',0                ; DATA XREF: sub_41E584:loc_41EAA6o
					; sub_41E584:loc_41F0C4o
aGl_es		db 'gl_ES',0            ; DATA XREF: sub_41E584:loc_41EAB0o
aKa_ge		db 'ka_GE',0            ; DATA XREF: sub_41E584:loc_41EABAo
aDe_de		db 'de_DE',0            ; DATA XREF: sub_41E584:loc_41EAD9o
aDe_ch		db 'de_CH',0            ; DATA XREF: sub_41E584:loc_41EAE3o
aDe_at		db 'de_AT',0            ; DATA XREF: sub_41E584:loc_41EAEDo
aDe_lu		db 'de_LU',0            ; DATA XREF: sub_41E584:loc_41EAF7o
aDe_li		db 'de_LI',0            ; DATA XREF: sub_41E584:loc_41EB01o
aDe		db 'de',0               ; DATA XREF: sub_41E584:loc_41EB0Bo
aEl_gr		db 'el_GR',0            ; DATA XREF: sub_41E584:loc_41EB15o
aGn_py		db 'gn_PY',0            ; DATA XREF: sub_41E584:loc_41EB1Fo
aGu_in		db 'gu_IN',0            ; DATA XREF: sub_41E584:loc_41EB29o
aHa_ng		db 'ha_NG',0            ; DATA XREF: sub_41E584:loc_41EB33o
aCpe_us		db 'cpe_US',0           ; DATA XREF: sub_41E584:loc_41EB3Do
aHe_il		db 'he_IL',0            ; DATA XREF: sub_41E584:loc_41EB47o
aHi_in		db 'hi_IN',0            ; DATA XREF: sub_41E584:loc_41EB51o
aHu_hu		db 'hu_HU',0            ; DATA XREF: sub_41E584:loc_41EB5Bo
aNic_ng		db 'nic_NG',0           ; DATA XREF: sub_41E584:loc_41EB65o
aIs_is		db 'is_IS',0            ; DATA XREF: sub_41E584:loc_41EB6Fo
aIbo_ng		db 'ibo_NG',0           ; DATA XREF: sub_41E584:loc_41EB79o
aId_id		db 'id_ID',0            ; DATA XREF: sub_41E584:loc_41EB83o
aIu_ca		db 'iu_CA',0            ; DATA XREF: sub_41E584:loc_41EB8Do
aIt_it		db 'it_IT',0            ; DATA XREF: sub_41E584:loc_41EBA6o
aIt_ch		db 'it_CH',0            ; DATA XREF: sub_41E584:loc_41EBB0o
aIt		db 'it',0               ; DATA XREF: sub_41E584:loc_41EBBAo
aJa_jp		db 'ja_JP',0            ; DATA XREF: sub_41E584:loc_41EBC4o
aKn_in		db 'kn_IN',0            ; DATA XREF: sub_41E584:loc_41EBCEo
aKau_ng		db 'kau_NG',0           ; DATA XREF: sub_41E584:loc_41EBD8o
aKs_pk		db 'ks_PK',0            ; DATA XREF: sub_41E584:loc_41EBF1o
aKs_in		db 'ks_IN',0            ; DATA XREF: sub_41E584:loc_41EBFBo
aKs		db 'ks',0               ; DATA XREF: sub_41E584:loc_41EC05o
aKk_kz		db 'kk_KZ',0            ; DATA XREF: sub_41E584:loc_41EC0Fo
aKok_in		db 'kok_IN',0           ; DATA XREF: sub_41E584:loc_41EC19o
aKo_kr		db 'ko_KR',0            ; DATA XREF: sub_41E584:loc_41EC23o
aKy_kg		db 'ky_KG',0            ; DATA XREF: sub_41E584:loc_41EC2Do
aLo_la		db 'lo_LA',0            ; DATA XREF: sub_41E584:loc_41EC37o
aLa_va		db 'la_VA',0            ; DATA XREF: sub_41E584:loc_41EC41o
aLv_lv		db 'lv_LV',0            ; DATA XREF: sub_41E584:loc_41EC4Bo
aLt_lt		db 'lt_LT',0            ; DATA XREF: sub_41E584:loc_41EC55o
aMk_mk		db 'mk_MK',0            ; DATA XREF: sub_41E584:loc_41EC5Fo
aMs_my		db 'ms_MY',0            ; DATA XREF: sub_41E584:loc_41EC78o
aMs_bn		db 'ms_BN',0            ; DATA XREF: sub_41E584:loc_41EC82o
aMs		db 'ms',0               ; DATA XREF: sub_41E584:loc_41EC8Co
aMl_in		db 'ml_IN',0            ; DATA XREF: sub_41E584:loc_41EC96o
aMt_mt		db 'mt_MT',0            ; DATA XREF: sub_41E584:loc_41ECA0o
aMni_in		db 'mni_IN',0           ; DATA XREF: sub_41E584:loc_41ECAAo
aMr_in		db 'mr_IN',0            ; DATA XREF: sub_41E584:loc_41ECB4o
aMn		db 'mn',0               ; DATA XREF: sub_41E584:loc_41ECBEo
aNe_np		db 'ne_NP',0            ; DATA XREF: sub_41E584:loc_41ECD7o
aNe_in		db 'ne_IN',0            ; DATA XREF: sub_41E584:loc_41ECE1o
aNe		db 'ne',0               ; DATA XREF: sub_41E584:loc_41ECEBo
aNo_no		db 'no_NO',0            ; DATA XREF: sub_41E584:loc_41ED04o
aNn_no		db 'nn_NO',0            ; DATA XREF: sub_41E584:loc_41ED0Eo
aNo		db 'no',0               ; DATA XREF: sub_41E584:loc_41ED18o
aOr_in		db 'or_IN',0            ; DATA XREF: sub_41E584:loc_41ED22o
aOm_et		db 'om_ET',0            ; DATA XREF: sub_41E584:loc_41ED2Co
aPap_an		db 'pap_AN',0           ; DATA XREF: sub_41E584:loc_41ED36o
aPs		db 'ps',0               ; DATA XREF: sub_41E584:loc_41ED40o
aPl_pl		db 'pl_PL',0            ; DATA XREF: sub_41E584:loc_41ED4Ao
aPt_pt		db 'pt_PT',0            ; DATA XREF: sub_41E584+7DDo
aPt_br		db 'pt_BR',0            ; DATA XREF: sub_41E584:loc_41ED6Bo
aPt		db 'pt',0               ; DATA XREF: sub_41E584:loc_41ED75o
aPa_in		db 'pa_IN',0            ; DATA XREF: sub_41E584+803o
aPa		db 'pa',0               ; DATA XREF: sub_41E584:loc_41ED91o
aRm_ch		db 'rm_CH',0            ; DATA XREF: sub_41E584:loc_41ED9Bo
aRo_ro		db 'ro_RO',0            ; DATA XREF: sub_41E584+829o
aRo		db 'ro',0               ; DATA XREF: sub_41E584:loc_41EDB7o
aRu		db 'ru',0               ; DATA XREF: sub_41E584:loc_41EDC1o
aSe_no		db 'se_NO',0            ; DATA XREF: sub_41E584:loc_41EDCBo
aSa_in		db 'sa_IN',0            ; DATA XREF: sub_41E584:loc_41EDD5o
aSd_in		db 'sd_IN',0            ; DATA XREF: sub_41E584:loc_41EDEDo
aSd_pk		db 'sd_PK',0            ; DATA XREF: sub_41E584:loc_41EDF7o
aSd		db 'sd',0               ; DATA XREF: sub_41E584:loc_41EE01o
aSi_lk		db 'si_LK',0            ; DATA XREF: sub_41E584:loc_41EE0Bo
aSk_sk		db 'sk_SK',0            ; DATA XREF: sub_41E584:loc_41EE15o
aSl_si		db 'sl_SI',0            ; DATA XREF: sub_41E584:loc_41EE1Fo
aSo_so		db 'so_SO',0            ; DATA XREF: sub_41E584:loc_41EE29o
aWen_de		db 'wen_DE',0           ; DATA XREF: sub_41E584:loc_41EE33o
aEs_es		db 'es_ES',0            ; DATA XREF: sub_41E584:loc_41EE56o
aEs_mx		db 'es_MX',0            ; DATA XREF: sub_41E584:loc_41EE60o
aEs_es@modern	db 'es_ES@modern',0     ; DATA XREF: sub_41E584:loc_41EE6Ao
aEs_gt		db 'es_GT',0            ; DATA XREF: sub_41E584:loc_41EE74o
aEs_cr		db 'es_CR',0            ; DATA XREF: sub_41E584:loc_41EE7Eo
aEs_pa		db 'es_PA',0            ; DATA XREF: sub_41E584:loc_41EE88o
aEs_do		db 'es_DO',0            ; DATA XREF: sub_41E584:loc_41EE92o
aEs_ve		db 'es_VE',0            ; DATA XREF: sub_41E584:loc_41EE9Co
aEs_co		db 'es_CO',0            ; DATA XREF: sub_41E584:loc_41EEA6o
aEs_pe		db 'es_PE',0            ; DATA XREF: sub_41E584:loc_41EEB0o
aEs_ar		db 'es_AR',0            ; DATA XREF: sub_41E584:loc_41EEBAo
aEs_ec		db 'es_EC',0            ; DATA XREF: sub_41E584:loc_41EEC4o
aEs_cl		db 'es_CL',0            ; DATA XREF: sub_41E584:loc_41EECEo
aEs_uy		db 'es_UY',0            ; DATA XREF: sub_41E584:loc_41EED8o
aEs_py		db 'es_PY',0            ; DATA XREF: sub_41E584:loc_41EEE2o
aEs_bo		db 'es_BO',0            ; DATA XREF: sub_41E584:loc_41EEECo
aEs_sv		db 'es_SV',0            ; DATA XREF: sub_41E584:loc_41EEF6o
aEs_hn		db 'es_HN',0            ; DATA XREF: sub_41E584:loc_41EF00o
aEs_ni		db 'es_NI',0            ; DATA XREF: sub_41E584:loc_41EF0Ao
aEs_pr		db 'es_PR',0            ; DATA XREF: sub_41E584:loc_41EF14o
aEs		db 'es',0               ; DATA XREF: sub_41E584:loc_41EF1Eo
aBnt_tz		db 'bnt_TZ',0           ; DATA XREF: sub_41E584:loc_41EF28o
aSw_ke		db 'sw_KE',0            ; DATA XREF: sub_41E584:loc_41EF32o
aSv_se		db 'sv_SE',0            ; DATA XREF: sub_41E584:loc_41EF4Bo
aSv_fi		db 'sv_FI',0            ; DATA XREF: sub_41E584:loc_41EF55o
aSv		db 'sv',0               ; DATA XREF: sub_41E584:loc_41EF5Fo
aSyr_tr		db 'syr_TR',0           ; DATA XREF: sub_41E584:loc_41EF69o
aTl_ph		db 'tl_PH',0            ; DATA XREF: sub_41E584:loc_41EF73o
aTg_tj		db 'tg_TJ',0            ; DATA XREF: sub_41E584:loc_41EF7Do
aBer_ma@arabic	db 'ber_MA@arabic',0    ; DATA XREF: sub_41E584:loc_41EF96o
aBer_ma@latin	db 'ber_MA@latin',0     ; DATA XREF: sub_41E584:loc_41EFA0o
aBer_ma		db 'ber_MA',0           ; DATA XREF: sub_41E584:loc_41EFAAo
aTa		db 'ta',0               ; DATA XREF: sub_41E584:loc_41EFB4o
aTt_ru		db 'tt_RU',0            ; DATA XREF: sub_41E584:loc_41EFBEo
aTe_in		db 'te_IN',0            ; DATA XREF: sub_41E584:loc_41EFC8o
aTh_th		db 'th_TH',0            ; DATA XREF: sub_41E584:loc_41EFD2o
aBo_cn		db 'bo_CN',0            ; DATA XREF: sub_41E584:loc_41EFDCo
aTi_et		db 'ti_ET',0            ; DATA XREF: sub_41E584:loc_41EFF4o
aTi_er		db 'ti_ER',0            ; DATA XREF: sub_41E584:loc_41EFFEo
aTi		db 'ti',0               ; DATA XREF: sub_41E584:loc_41F008o
aTs_za		db 'ts_ZA',0            ; DATA XREF: sub_41E584:loc_41F012o
aTn_bw		db 'tn_BW',0            ; DATA XREF: sub_41E584:loc_41F01Co
aTr_tr		db 'tr_TR',0            ; DATA XREF: sub_41E584:loc_41F026o
aTk_tm		db 'tk_TM',0            ; DATA XREF: sub_41E584:loc_41F030o
aUk_ua		db 'uk_UA',0            ; DATA XREF: sub_41E584:loc_41F03Ao
aUr_pk		db 'ur_PK',0            ; DATA XREF: sub_41E584:loc_41F053o
aUr_in		db 'ur_IN',0            ; DATA XREF: sub_41E584:loc_41F05Ao
aUr		db 'ur',0               ; DATA XREF: sub_41E584:loc_41F061o
aUz_uz		db 'uz_UZ',0            ; DATA XREF: sub_41E584:loc_41F077o
aUz_uz@cyrillic	db 'uz_UZ@cyrillic',0   ; DATA XREF: sub_41E584:loc_41F07Eo
aUz		db 'uz',0               ; DATA XREF: sub_41E584:loc_41F085o
aVen_za		db 'ven_ZA',0           ; DATA XREF: sub_41E584:loc_41F08Co
aVi_vn		db 'vi_VN',0            ; DATA XREF: sub_41E584:loc_41F093o
aCy_gb		db 'cy_GB',0            ; DATA XREF: sub_41E584:loc_41F09Ao
aXh_za		db 'xh_ZA',0            ; DATA XREF: sub_41E584:loc_41F0A1o
aSit_cn		db 'sit_CN',0           ; DATA XREF: sub_41E584:loc_41F0A8o
aYi_il		db 'yi_IL',0            ; DATA XREF: sub_41E584:loc_41F0AFo
aYo_ng		db 'yo_NG',0            ; DATA XREF: sub_41E584:loc_41F0B6o
aZu_za		db 'zu_ZA',0            ; DATA XREF: sub_41E584:loc_41F0BDo
		align 4
off_42DE18	dd offset loc_41F0C4, offset loc_41E660, offset	loc_41E7A5
					; DATA XREF: sub_41E584+B5o
		dd offset loc_41E7C3, offset loc_41E7D7, offset	loc_41E862 ; jump table	for switch statement
		dd offset loc_41E86C, offset loc_41EAC4, offset	loc_41EB15
		dd offset loc_41E8B7, offset loc_41EE3D, offset	loc_41E9AC
		dd offset loc_41E9B6, offset loc_41EB47, offset	loc_41EB5B
		dd offset loc_41EB6F, offset loc_41EB97, offset	loc_41EBC4
		dd offset loc_41EC23, offset loc_41E880, offset	loc_41ECF5
		dd offset loc_41ED4A, offset loc_41ED54, offset	loc_41ED9B
		dd offset loc_41EDA5, offset loc_41EDC1, offset	loc_41E828
		dd offset loc_41EE15, offset loc_41E64C, offset	loc_41EF3C
		dd offset loc_41EFD2, offset loc_41F026, offset	loc_41F044
		dd offset loc_41EB83, offset loc_41F03A, offset	loc_41E76E
		dd offset loc_41EE1F, offset loc_41E98E, offset	loc_41EC4B
		dd offset loc_41EC55, offset loc_41EF7D, offset	loc_41E9A2
		dd offset loc_41F093, offset loc_41E723, offset	loc_41E737
		dd offset loc_41E764, offset loc_41EE33, offset	loc_41EC5F
		dd offset loc_41EF28, offset loc_41F012, offset	loc_41F01C
		dd offset loc_41F08C, offset loc_41F0A1, offset	loc_41F0BD
		dd offset loc_41E642, offset loc_41EABA, offset	loc_41E998
		dd offset loc_41EB51, offset loc_41ECA0, offset	loc_41EDCB
		dd offset loc_41EA83, offset loc_41F0AF, offset	loc_41EC69
		dd offset loc_41EC0F, offset loc_41EC2D, offset	loc_41EF32
		dd offset loc_41F030, offset loc_41F068, offset	loc_41EFBE
		dd offset loc_41E778, offset loc_41ED7F, offset	loc_41EB29
		dd offset loc_41ED22, offset loc_41EFB4, offset	loc_41EFC8
		dd offset loc_41EBCE, offset loc_41EC96, offset	loc_41E72D
		dd offset loc_41ECB4, offset loc_41EDD5, offset	loc_41ECBE
		dd offset loc_41EFDC, offset loc_41F09A, offset	loc_41E7B9
		dd offset loc_41EC37, offset loc_41E7AF, offset	loc_41EAB0
		dd offset loc_41EC19, offset loc_41ECAA, offset	loc_41EDDF
		dd offset loc_41EF69, offset loc_41EE0B, offset	loc_41E7CD
		dd offset loc_41EB8D, offset loc_41E656, offset	loc_41EF87
		dd offset loc_41EBE2, offset loc_41ECC8, offset	loc_41EA6F
		dd offset loc_41ED40, offset loc_41EF73, offset	loc_41E876
		dd offset loc_41E8AD, offset loc_41EA79, offset	loc_41EB33
		dd offset loc_41EB65, offset loc_41F0B6, offset	loc_41F0C4
		dd offset loc_41F0C4, offset loc_41F0C4, offset	loc_41F0C4
		dd offset loc_41F0C4, offset loc_41EB79, offset	loc_41EBD8
		dd offset loc_41ED2C, offset loc_41EFE6, offset	loc_41EB1F
		dd offset loc_41EB3D, offset loc_41EC41, offset	loc_41EE29
		dd offset loc_41F0A8, offset loc_41ED36
off_42E000	dd offset loc_41E719	; DATA XREF: sub_41E584+ECo
		dd offset loc_41E679	; jump table for switch	statement
		dd offset loc_41E683
		dd offset loc_41E68D
		dd offset loc_41E697
		dd offset loc_41E6A1
		dd offset loc_41E6AB
		dd offset loc_41E6B5
		dd offset loc_41E6BF
		dd offset loc_41E6C9
		dd offset loc_41E6D3
		dd offset loc_41E6DD
		dd offset loc_41E6E7
		dd offset loc_41E6F1
		dd offset loc_41E6FB
		dd offset loc_41E705
		dd offset loc_41E70F
off_42E044	dd offset loc_41E81E	; DATA XREF: sub_41E584+25Fo
		dd offset loc_41E7EC	; jump table for switch	statement
		dd offset loc_41E7F6
		dd offset loc_41E800
		dd offset loc_41E80A
		dd offset loc_41E814
off_42E05C	dd offset loc_41E984	; DATA XREF: sub_41E584+343o
		dd offset loc_41E8D0	; jump table for switch	statement
		dd offset loc_41E8DA
		dd offset loc_41E8E4
		dd offset loc_41E8EE
		dd offset loc_41E8F8
		dd offset loc_41E902
		dd offset loc_41E90C
		dd offset loc_41E916
		dd offset loc_41E920
		dd offset loc_41E92A
		dd offset loc_41E934
		dd offset loc_41E93E
		dd offset loc_41E948
		dd offset loc_41E952
		dd offset loc_41E95C
		dd offset loc_41E966
		dd offset loc_41E970
		dd offset loc_41E97A
off_42E0A8	dd offset loc_41EA65	; DATA XREF: sub_41E584+442o
		dd offset loc_41E9CF	; jump table for switch	statement
		dd offset loc_41E9D9
		dd offset loc_41E9E3
		dd offset loc_41E9ED
		dd offset loc_41E9F7
		dd offset loc_41EA01
		dd offset loc_41EA0B
		dd offset loc_41EA15
		dd offset loc_41EA1F
		dd offset loc_41EA29
		dd offset loc_41EA33
		dd offset loc_41EA3D
		dd offset loc_41EA47
		dd offset loc_41EA51
		dd offset loc_41EA5B
off_42E0E8	dd offset loc_41EB0B	; DATA XREF: sub_41E584+54Co
		dd offset loc_41EAD9	; jump table for switch	statement
		dd offset loc_41EAE3
		dd offset loc_41EAED
		dd offset loc_41EAF7
		dd offset loc_41EB01
off_42E100	dd offset loc_41EF1E	; DATA XREF: sub_41E584+8C9o
		dd offset loc_41EE56	; jump table for switch	statement
		dd offset loc_41EE60
		dd offset loc_41EE6A
		dd offset loc_41EE74
		dd offset loc_41EE7E
		dd offset loc_41EE88
		dd offset loc_41EE92
		dd offset loc_41EE9C
		dd offset loc_41EEA6
		dd offset loc_41EEB0
		dd offset loc_41EEBA
		dd offset loc_41EEC4
		dd offset loc_41EECE
		dd offset loc_41EED8
		dd offset loc_41EEE2
		dd offset loc_41EEEC
		dd offset loc_41EEF6
		dd offset loc_41EF00
		dd offset loc_41EF0A
		dd offset loc_41EF14
; char aRb[3]
aRb		db 'rb',0               ; DATA XREF: sub_41F1AA+16o
; char aLc_messages[]
aLc_messages	db 'LC_MESSAGES',0      ; DATA XREF: sub_41F74E+16o
					; .text:004200A1o
aLc_messages_0	db '\LC_MESSAGES\',0    ; DATA XREF: sub_41F74E+1AAo
a_mo		db '.mo',0              ; DATA XREF: sub_41F74E+202o
		align 4
aErrorInGettext	db 'ERROR in GETTEXT (bad plural entry)',0 ; DATA XREF: sub_41F9A8+3Bo
aErrorInGette_0	db 'ERROR in GETTEXT MALLOC',0 ; DATA XREF: sub_41FA0E+13Do
					; sub_41FA0E:loc_41FC71o
aErrorInGette_1	db 'ERROR in GETTEXT (overflow space)',0Ah,0
					; DATA XREF: sub_41FA0E:loc_41FCE5o
byte_42E1D7	db 0			; DATA XREF: .text:loc_4200BBo
asc_42E1D8	db '-',0                ; DATA XREF: sub_420105+55o
					; sub_420364:loc_420375o
aSocket		db 'socket://',0        ; DATA XREF: sub_420105+9Do
aSystemDoesNotS	db 'system does not support logging to a socket - using stderr',0Ah,0
					; DATA XREF: sub_420105+FDo
; char aA_0[]
aA_0		db 'a',0                ; DATA XREF: sub_420105+131o
					; sub_420105:loc_420275o
		align 4
; char aFailedToOpenLo[]
aFailedToOpenLo	db 'failed to open log file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_420105+1B1o
		align 4
; char aFailedToFdopen[]
aFailedToFdopen	db 'failed to fdopen file descriptor %d: %s',0Ah,0
					; DATA XREF: sub_420105+1E9o
		align 4
; char a____Gnupg22_10[]
a____Gnupg22_10	db '../../gnupg2-2.0.30/jnlib/logging.c',0 ; DATA XREF: sub_420526+2Fo
; char aLogstream[]
aLogstream	db 'logstream',0        ; DATA XREF: sub_420526+37o
		align 4
; char a04d02d02d02d_0[]
a04d02d02d02d_0	db '%04d-%02d-%02d %02d:%02d:%02d ',0 ; DATA XREF: sub_420526+E3o
; char aU_Lx[]
aU_Lx		db '[%u.%lx]',0         ; DATA XREF: sub_420526+16Bo
; char aU[]
aU		db '[%u]',0             ; DATA XREF: sub_420526+192o
aFatal		db 'Fatal: ',0          ; DATA XREF: sub_420526+21Do
aOhhhhJeeee	db 'Ohhhh jeeee: ',0    ; DATA XREF: sub_420526+246o
aDbg		db 'DBG: ',0            ; DATA XREF: sub_420526+26Fo
; char aUnknownLogLeve[]
aUnknownLogLeve	db '[Unknown log level %d]: ',0 ; DATA XREF: sub_420526:loc_4207B8o
		align 4
off_42E308	dd offset loc_4207D7	; DATA XREF: sub_420526+20Eo
		dd offset loc_4207D7	; jump table for switch	statement
		dd offset loc_4207D7
		dd offset loc_4207D7
		dd offset loc_4207D7
		dd offset loc_42073D
		dd offset loc_420766
		dd offset loc_42078F
dword_42E328	dd 207325h		; DATA XREF: .text:00420A31o
a02x_1		db '%02X',0             ; DATA XREF: .text:00420A56o
a02x_2		db ' %02X',0            ; DATA XREF: .text:00420A79o
asc_42E337	db 0Ah,0		; DATA XREF: .text:00420A9Eo
; char a___ThisIsABugS[]
a___ThisIsABugS	db '... this is a bug (%s:%d:%s)',0Ah,0 ; DATA XREF: sub_420AAC+1Bo
		align 4
asc_42E358	db ' ',9,0Dh,0Ah,0      ; DATA XREF: .text:00420ECEo
					; .text:00420F66o
a_		db '.',0                ; DATA XREF: .text:00421053o
		align 10h
a____Gnupg22_11	db '../../gnupg2-2.0.30/jnlib/stringhelp.c',0 ; DATA XREF: sub_4210BA+A0o
; char aHome_0[]
aHome_0		db 'HOME',0             ; DATA XREF: sub_4210BA:loc_4211DBo
; char aX02x_0[]
aX02x_0		db 'x%02x',0            ; DATA XREF: sub_42166F+164o
					; sub_421A23+1B0o
word_42E392	dw 0			; DATA XREF: .text:004224B3o
					; sub_4224E6+Co
aFatalTooManyAr	db 0Ah			; DATA XREF: sub_4224E6+56o
		db 'fatal: too many args for xstrconcat',0Ah,0
aFatalOutOfMemo	db 0Ah			; DATA XREF: sub_4224E6+81o
		db 'fatal: out of memory',0Ah,0
aDo_make_filena	db 'do_make_filename',0 ; DATA XREF: sub_4210BA+90o
		align 4
; char aInvalidArgumen[]
aInvalidArgumen	db 'invalid argument for arg_parsee',0Ah,0 ; DATA XREF: sub_42259C+81o
; char aArgumentNotExp[]
aArgumentNotExp	db 'argument not expected',0 ; DATA XREF: sub_42259C+B0o
; char aReadError[]
aReadError	db 'read error',0       ; DATA XREF: sub_42259C+CFo
; char aKeywordTooLong[]
aKeywordTooLong	db 'keyword too long',0 ; DATA XREF: sub_42259C+EEo
; char aMissingArgumen[]
aMissingArgumen	db 'missing argument',0 ; DATA XREF: sub_42259C+10Do
; char aInvalidArgum_0[]
aInvalidArgum_0	db 'invalid argument',0 ; DATA XREF: sub_42259C+129o
; char aInvalidCommand[]
aInvalidCommand	db 'invalid command',0  ; DATA XREF: sub_42259C+145o
; char aInvalidAliasDe[]
aInvalidAliasDe	db 'invalid alias definition',0 ; DATA XREF: sub_42259C+161o
; char aOutOfCore[]
aOutOfCore	db 'out of core',0      ; DATA XREF: sub_42259C+17Do
; char aInvalidOption[]
aInvalidOption	db 'invalid option',0   ; DATA XREF: sub_42259C:loc_42272Ao
; char aSUS[]
aSUS		db '%s:%u: %s',0Ah,0    ; DATA XREF: sub_42259C+1B4o
a??		db '[??]',0             ; DATA XREF: sub_42259C:loc_422773o
		align 10h
; char aMissingArgum_0[]
aMissingArgum_0	db 'missing argument for option "%.50s"',0Ah,0 ; DATA XREF: sub_42259C+1EAo
		align 4
; char aInvalidArgum_1[]
aInvalidArgum_1	db 'invalid argument for option "%.50s"',0Ah,0 ; DATA XREF: sub_42259C+215o
		align 10h
; char aOption_50sDoes[]
aOption_50sDoes	db 'option "%.50s" does not expect an argument',0Ah,0
					; DATA XREF: sub_42259C+240o
; char aInvalidComma_0[]
aInvalidComma_0	db 'invalid command "%.50s"',0Ah,0 ; DATA XREF: sub_42259C+26Bo
; char aOption_50sIsAm[]
aOption_50sIsAm	db 'option "%.50s" is ambiguous',0Ah,0 ; DATA XREF: sub_42259C+296o
; char aCommand_50sIsA[]
aCommand_50sIsA	db 'command "%.50s" is ambiguous',0Ah,0 ; DATA XREF: sub_42259C+2BEo
; char aOutOfCore_0[]
aOutOfCore_0	db 'out of core',0Ah,0  ; DATA XREF: sub_42259C+2E6o
; char aS_0[]
aS_0		db '%s',0Ah,0           ; DATA XREF: sub_42259C+2F6o
; char aInvalidOption_[]
aInvalidOption_	db 'invalid option "%.50s"',0Ah,0 ; DATA XREF: sub_42259C:loc_4228A0o
aIgnoreInvalidO	db 'ignore-invalid-option',0 ; DATA XREF: .text:00422C63o
					; .text:loc_423122o
asc_42E5BF	db ' ',9,0              ; DATA XREF: .text:00422DD9o
aAlias		db 'alias',0            ; DATA XREF: .text:004230F5o
; char Str1[]
Str1		db 'help',0             ; DATA XREF: sub_4234E9+1A6o
; char aVersion[]
aVersion	db 'version',0          ; DATA XREF: sub_4234E9+1E0o
; char aWarranty[]
aWarranty	db 'warranty',0         ; DATA XREF: sub_4234E9+222o
; char aDumpOptions[]
aDumpOptions	db 'dump-options',0     ; DATA XREF: sub_4234E9+266o
; char aS_1[]
aS_1		db '--%s',0Ah,0         ; DATA XREF: sub_4234E9+2B2o
		align 4
aDumpOptionsHel	db '--dump-options',0Ah ; DATA XREF: sub_4234E9+2DEo
		db '--help',0Ah
		db '--version',0Ah
		db '--warranty',0Ah,0
asc_42E620	db 'x',0                ; DATA XREF: sub_4234E9:loc_423BE3o
; char aOptions[]
aOptions	db 'Options:',0         ; DATA XREF: sub_423ED4+CEo
; char aC_0[]
aC_0		db ' -%c',0             ; DATA XREF: sub_423ED4+1B1o
asc_42E630	db '   ',0              ; DATA XREF: sub_423ED4+245o
					; sub_423ED4+332o
; char aCS[]
aCS		db '%c --%s',0          ; DATA XREF: sub_423ED4:loc_424178o
; char aASingleDashMay[]
aASingleDashMay	db 0Ah			; DATA XREF: sub_423ED4+45Co
		db '(A single dash may be used instead of the double ones)',0
; char SubStr[]
SubStr		db '@EMAIL@',0          ; DATA XREF: sub_423ED4+48Do
aHttpBugs_gnupg	db 'http://bugs.gnupg.org',0 ; DATA XREF: sub_423ED4+4F0o
; char aS_2[]
aS_2		db ' (%s)',0            ; DATA XREF: sub_42443F+3Co
; char aSS[]
aSS		db ' %s %s',0Ah,0       ; DATA XREF: sub_42443F+5Co
aGpg4win2_3_1	db '(Gpg4win 2.3.1)',0  ; DATA XREF: sub_42443F+61o
; char aSSS[]
aSSS		db '%s %s; %s',0Ah,0    ; DATA XREF: sub_4245D2+37o
		align 4
aLicenseGplv3Gn	db 'License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licens'
					; DATA XREF: sub_4246F5:loc_42473Bo
		db 'es/gpl.html>',0
aFoo		db 'foo',0              ; DATA XREF: sub_4246F5:loc_424744o
a0_0		db '0.0',0              ; DATA XREF: sub_4246F5:loc_42474Do
		align 4
aCopyrightC2015	db 'Copyright (C) 2015 Free Software Foundation, Inc.',0
					; DATA XREF: sub_4246F5:loc_424756o
		align 4
aThisIsFreeSoft	db 'This is free software: you are free to change and redistribute it'
					; DATA XREF: sub_4246F5:loc_42475Fo
		db '.',0Ah
		db 'There is NO WARRANTY, to the extent permitted by law.',0Ah,0
		align 4
aThisIsFreeSo_0	db 'This is free software; you can redistribute it and/or modify',0Ah
					; DATA XREF: sub_4246F5:loc_424768o
		db 'it under the terms of the GNU General Public License as published'
		db ' by',0Ah
		db 'the Free Software Foundation; either version 3 of the License, or'
		db 0Ah
		db '(at your option) any later version.',0Ah
		db 0Ah
		db 'It is distributed in the hope that it will be useful,',0Ah
		db 'but WITHOUT ANY WARRANTY; without even the implied warranty of',0Ah
		db 'MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the',0Ah
		db 'GNU General Public License for more details.',0Ah
		db 0Ah
		db 'You should have received a copy of the GNU General Public License'
		db 0Ah
		db 'along with this software.  If not, see <http://www.gnu.org/licens'
		db 'es/>.',0Ah,0
dword_42EA18	dd 0			; DATA XREF: sub_4246F5:loc_424771o
off_42EA1C	dd offset loc_42473B	; DATA XREF: sub_4246F5+3Dr
		dd offset loc_424744	; jump table for switch	statement
		dd offset loc_424779
		dd offset loc_42474D
		dd offset loc_424756
		dd offset loc_42475F
		dd offset loc_424768
		dd offset loc_424779
		dd offset loc_424779
		dd offset loc_424779
		dd offset loc_424779
		dd offset loc_424779
		dd offset loc_424779
		dd offset loc_424779
		dd offset loc_424779
		dd offset loc_424779
		dd offset loc_424779
		dd offset loc_424779
		dd offset loc_424779
		dd offset loc_424779
		dd offset loc_424779
		dd offset loc_424779
		dd offset loc_424779
		dd offset loc_424779
		dd offset loc_424779
		dd offset loc_424779
		dd offset loc_424779
		dd offset loc_424779
		dd offset loc_424779
		dd offset loc_424779
		dd offset loc_424771
		dd offset loc_424771
aIso88591	db 'iso-8859-1',0       ; DATA XREF: sub_42478C+D9o
					; sub_42488B:loc_424A60o ...
aUtf8_0		db 'utf-8',0            ; DATA XREF: sub_42478C+22o
					; sub_42488B+20Fo ...
		align 10h
; char aConversionFrom[]
aConversionFrom	db 'conversion from `%s',27h,' to `%s',27h,' not available',0Ah,0
					; DATA XREF: sub_42478C+71o
; char aIconv_openFail[]
aIconv_openFail	db 'iconv_open failed: %s',0Ah,0 ; DATA XREF: sub_42478C+B1o
; char aCpU[]
aCpU		db 'CP%u',0             ; DATA XREF: sub_42488B:loc_4248B6o
aCp936		db 'CP936',0            ; DATA XREF: sub_42488B+4Eo
aGbk		db 'GBK',0
aCp1361		db 'CP1361',0
aJohab		db 'JOHAB',0
aCp20127	db 'CP20127',0
aAscii_0	db 'ASCII',0
aCp20866	db 'CP20866',0
aKoi8R		db 'KOI8-R',0
aCp21866	db 'CP21866',0
aKoi8Ru		db 'KOI8-RU',0
aCp28591	db 'CP28591',0
aIso88591_0	db 'ISO-8859-1',0
aCp28592	db 'CP28592',0
aIso88592	db 'ISO-8859-2',0
aCp28593	db 'CP28593',0
aIso88593	db 'ISO-8859-3',0
aCp28594	db 'CP28594',0
aIso88594	db 'ISO-8859-4',0
aCp28595	db 'CP28595',0
aIso88595	db 'ISO-8859-5',0
aCp28596	db 'CP28596',0
aIso88596	db 'ISO-8859-6',0
aCp28597	db 'CP28597',0
aIso88597	db 'ISO-8859-7',0
aCp28598	db 'CP28598',0
aIso88598	db 'ISO-8859-8',0
aCp28599	db 'CP28599',0
aIso88599	db 'ISO-8859-9',0
aCp28605	db 'CP28605',0
aIso885915	db 'ISO-8859-15',0
aCp65001	db 'CP65001',0
aUtf8_2		db 'UTF-8',0
		align 2
aIso		db 'iso',0              ; DATA XREF: sub_42488B+13Co
a88591		db '8859-1',0           ; DATA XREF: sub_42488B+179o
a646		db '646',0              ; DATA XREF: sub_42488B+190o
aAscii		db 'ASCII',0            ; DATA XREF: sub_42488B+1A7o
aAnsi_x3_41968	db 'ANSI_X3.4-1968',0   ; DATA XREF: sub_42488B+1BEo
aUtf8_1		db 'utf8',0             ; DATA XREF: sub_42488B:loc_424A83o
		align 4
; char aConversionFr_0[]
aConversionFr_0	db 'conversion from `%s',27h,' to `%s',27h,' failed: %s',0Ah,0
					; DATA XREF: sub_424BA1+1EEo
					; sub_424DED+730o
; char aX02x_1[]
aX02x_1		db '\x%02x',0           ; DATA XREF: sub_424DED+7Co
					; sub_424DED+3AFo ...
; char aX02x_2[]
aX02x_2		db 'x%02x',0            ; DATA XREF: sub_424DED+1DCo
		align 4
a____Gnupg22_12	db '../../gnupg2-2.0.30/jnlib/utf8conv.c',0 ; DATA XREF: sub_424DED+6BEo
		align 4
off_42EC94	dd offset loc_424FA0	; DATA XREF: sub_424DED+12Ar
		dd offset loc_424FB6	; jump table for switch	statement
		dd offset loc_424FB6
		dd offset loc_424FB6
		dd offset loc_424FB6
		dd offset loc_424FB6
		dd offset loc_424FB6
		dd offset loc_424FB6
		dd offset loc_424F8A
		dd offset loc_424FB6
		dd offset loc_424F20
		dd offset loc_424F74
		dd offset loc_424F5A
		dd offset loc_424F3D
aDo_utf8_to_nat	db 'do_utf8_to_native',0 ; DATA XREF: sub_424DED+6AEo
		align 10h
aHkey_classes_r	db 'HKEY_CLASSES_ROOT',0 ; DATA XREF: sub_425648+1Fo
aHkey_current_u	db 'HKEY_CURRENT_USER',0 ; DATA XREF: sub_425648+53o
aHkey_local_mac	db 'HKEY_LOCAL_MACHINE',0 ; DATA XREF: sub_425648+87o
aHkey_users	db 'HKEY_USERS',0       ; DATA XREF: sub_425648+BBo
aHkey_performan	db 'HKEY_PERFORMANCE_DATA',0 ; DATA XREF: sub_425648+ECo
aHkey_current_c	db 'HKEY_CURRENT_CONFIG',0 ; DATA XREF: sub_425648+11Do
; char aTz[]
aTz		db 'TZ',0               ; DATA XREF: sub_425C1E+7o
					; sub_425C1E:loc_425CD4o
; char EnvString[]
EnvString	db 'TZ=UTC',0           ; DATA XREF: sub_425C1E+16o
aTz_0		db 'TZ=',0              ; DATA XREF: sub_425C1E+7Co
		align 4
; CHAR LibFileName[]
LibFileName	db 'mingwm10.dll',0     ; DATA XREF: TlsCallback_0+4Eo
; CHAR a__mingwthr_rem[]
a__mingwthr_rem	db '__mingwthr_remove_key_dtor',0 ; DATA XREF: TlsCallback_0+71o
; CHAR a__mingwthr_key[]
a__mingwthr_key	db '__mingwthr_key_dtor',0 ; DATA XREF: TlsCallback_0+8Bo
off_42ED98	dd offset TlsCallback_0	; DATA XREF: sub_401180:loc_401273r
aUnknownError	db 'Unknown error',0    ; DATA XREF: sub_426420+3o
		align 4
; char a_matherrSInSGG[]
a_matherrSInSGG	db '_matherr(): %s in %s(%g, %g)  (retval=%g)',0Ah,0
					; DATA XREF: sub_426420+39o
		align 4
aArgumentDomain	db 'Argument domain error (DOMAIN)',0 ; DATA XREF: .rdata:off_42EEB8o
aArgumentSingul	db 'Argument singularity (SIGN)',0 ; DATA XREF: .rdata:0042EEBCo
		align 4
aOverflowRangeE	db 'Overflow range error (OVERFLOW)',0 ; DATA XREF: .rdata:0042EEC0o
aTheResultIsToo	db 'The result is too small to be represented (UNDERFLOW)',0
					; DATA XREF: .rdata:0042EEC4o
		align 4
aTotalLossOfSig	db 'Total loss of significance (TLOSS)',0 ; DATA XREF: .rdata:0042EEC8o
		align 10h
aPartialLossOfS	db 'Partial loss of significance (PLOSS)',0 ; DATA XREF: .rdata:0042EECCo
		align 4
off_42EEB8	dd offset aArgumentDomain ; DATA XREF: sub_426420+16r
					; "Argument domain error (DOMAIN)"
		dd offset aArgumentSingul ; "Argument singularity (SIGN)"
		dd offset aOverflowRangeE ; "Overflow range error (OVERFLOW)"
		dd offset aTheResultIsToo ; "The result	is too small to	be represent"...
		dd offset aTotalLossOfSig ; "Total loss	of significance	(TLOSS)"
		dd offset aPartialLossOfS ; "Partial loss of significance (PLOSS)"
aMingwW64Runtim	db 'Mingw-w64 runtime failure:',0Ah,0 ; DATA XREF: sub_426490+1Do
; char aAddressPHasNoI[]
aAddressPHasNoI	db 'Address %p has no image-section',0 ; DATA XREF: sub_4264F0+20Do
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: sub_4264F0+1F9o
					; sub_4264F0+225o ...
		align 10h
; char aVirtualprotect[]
aVirtualprotect	db '  VirtualProtect failed with code 0x%x',0 ; DATA XREF: sub_4264F0+1D2o
		align 4
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_426730+299o
		align 4
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_426730+1B7o
		align 4
; const	WCHAR aMsvcrt_dll
aMsvcrt_dll:				; DATA XREF: sub_426CE0:loc_426D80o
		unicode	0, <msvcrt.dll>,0
		align 10h
off_42EFE0	dd offset dword_430860	; DATA XREF: .text:00426F78o
		dd offset dword_430580
; char aAssertionFaile[]
aAssertionFaile	db 'Assertion failed!',0Ah ; DATA XREF: sub_427500+EAo
		db 0Ah
		db 'Program: %s',0Ah
		db 'File: %s, Line %u',0Ah
		db 0Ah
		db 'Expression: %s',0
; char aS_3[]
aS_3		db '%s',0Ah,0           ; DATA XREF: sub_427500+1C2o
; CHAR Caption[]
Caption		db 'MinGW Runtime Assertion',0 ; DATA XREF: sub_427500+10Fo
		align 20h
dword_42F060	dd 1			; DATA XREF: .text:loc_427DC1r
dword_42F064	dd 16h			; DATA XREF: .text:00427DB7r
					; .text:00427DCFr
		dd 2 dup(2), 3,	2, 4, 18h, 5, 0Dh, 6, 9, 7, 0Ch, 8, 0Ch
		dd 9, 0Ch, 0Ah,	7, 0Bh,	8, 0Ch,	16h, 0Dh, 16h, 0Fh, 2
		dd 10h,	0Dh, 11h, 2 dup(12h), 2, 21h, 0Dh, 35h,	2, 41h
		dd 0Dh,	43h, 2,	50h, 11h, 52h, 0Dh, 53h, 0Dh, 57h, 16h
		dd 59h,	0Bh, 6Ch, 0Dh, 6Dh, 20h, 70h, 1Ch, 72h,	9, 6, 16h
		dd 80h,	0Ah, 81h, 0Ah, 82h, 9, 83h, 16h, 84h, 0Dh, 91h
		dd 29h,	9Eh, 0Dh, 0A1h,	2, 0A4h, 0Bh, 0A7h, 0Dh, 0B7h
		dd 11h,	0CEh, 2, 0D7h, 0Bh, 718h, 0Ch, 0
		dd 0FFFFFFFFh, 4 dup(0)
dword_42F1E0	dd 0			; DATA XREF: sub_426730+59o
					; sub_426730+5Eo ...
dword_42F1E4	dd 0			; DATA XREF: sub_426730+7Fr
dword_42F1E8	dd 0			; DATA XREF: sub_426730:loc_42687Cr
dword_42F1EC	dd 5 dup(0)		; DATA XREF: sub_426730+155o
		align 1000h
_rdata		ends

; Section 4. (virtual address 00030000)
; Virtual size			: 000009B8 (   2488.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 430000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_430000	dd ?			; DATA XREF: sub_401180+D0w
					; sub_401180+27Dr
dword_430004	dd ?			; DATA XREF: sub_401010+2Ao
					; sub_401180:loc_401344r ...
dword_430008	dd ?			; DATA XREF: sub_401010+18o
					; sub_401180+1DEr ...
dword_43000C	dd ?			; DATA XREF: sub_401010+10o
					; sub_401180+243r ...
dword_430010	dd ?			; DATA XREF: sub_401180+272w
					; sub_401180+28Cr
dword_430014	dd ?			; DATA XREF: sub_401060:loc_401098w
					; sub_401180+26Ar
dword_430018	dd ?			; DATA XREF: sub_401010+8o
					; sub_401010+20w
dword_43001C	dd ?			; DATA XREF: sub_401010+3Aw
dword_430020	dd ?			; DATA XREF: sub_402D35+A1r
					; sub_4032E3+B9w ...
dword_430024	dd ?			; DATA XREF: sub_401AB5:loc_401B42r
					; sub_401BD6:loc_401CCDr ...
dword_430028	dd ?			; DATA XREF: sub_40201D:loc_402085r
					; sub_4032E3:loc_40350Dw
dword_43002C	dd ?			; DATA XREF: sub_402637:loc_402A4Ar
					; sub_4032E3:loc_4035ADw
dword_430030	dd ?			; DATA XREF: sub_402637+41Cr
					; sub_4032E3:loc_4035B9w
dword_430034	dd ?			; DATA XREF: sub_4032E3:loc_4035C5w
					; sub_4039ED:loc_403A98r ...
dword_430038	dd ?			; DATA XREF: sub_402D35:loc_402FB4r
					; sub_4032E3:loc_4035D1w
dword_43003C	dd ?			; DATA XREF: sub_4032E3+2C3w
					; sub_403806+Er ...
dword_430040	dd ?			; DATA XREF: sub_4032E3+2FEw
					; sub_4032E3+3C4r ...
dword_430044	dd ?			; DATA XREF: sub_401BD6+74r
					; sub_402D35+167r ...
; char dword_430048[]
dword_430048	dd ?			; DATA XREF: sub_402D35+4D8r
					; sub_4032E3+2AEw
dword_43004C	dd ?			; DATA XREF: sub_4032E3+24Bw
					; sub_4032E3+387r
dword_430050	dd ?			; DATA XREF: sub_4032E3+C3w
					; sub_4032E3:loc_403664r ...
dword_430054	dd ?			; DATA XREF: sub_404198+6r
					; sub_404198+14w ...
dword_430058	dd ?			; DATA XREF: sub_40BAF5+6r
					; sub_40BAF5+Fw
		align 10h
dword_430060	dd ?			; DATA XREF: sub_40C06B+20r
					; sub_40C1A5+Br ...
dword_430064	dd ?			; DATA XREF: sub_40C338+E4w
					; sub_40C5EF+Er
dword_430068	dd ?			; DATA XREF: sub_40C93A:loc_40C95Br
					; sub_40C93A+88w ...
dword_43006C	dd ?			; DATA XREF: sub_40C93A:loc_40C9F4r
					; sub_40C93A+121w ...
dword_430070	dd ?			; DATA XREF: sub_40C93A:loc_40CA8Dr
					; sub_40C93A+1BAw ...
dword_430074	dd ?			; DATA XREF: sub_40C93A:loc_40CB26r
					; sub_40C93A+253w ...
dword_430078	dd ?			; DATA XREF: sub_40C93A:loc_40CBBFr
					; sub_40C93A+2ECw ...
dword_43007C	dd ?			; DATA XREF: sub_40C93A:loc_40CC58r
					; sub_40C93A+385w ...
dword_430080	dd ?			; DATA XREF: sub_40C93A:loc_40CCF1r
					; sub_40C93A+41Ew ...
dword_430084	dd ?			; DATA XREF: sub_40C93A:loc_40CD8Ar
					; sub_40C93A+4B7w ...
dword_430088	dd ?			; DATA XREF: sub_40C93A:loc_40CE23r
					; sub_40C93A+550w ...
dword_43008C	dd ?			; DATA XREF: sub_40C93A:loc_40CEBCr
					; sub_40C93A+5E9w ...
dword_430090	dd ?			; DATA XREF: .text:0040C83Cr
					; .text:0040C900w ...
dword_430094	dd ?			; DATA XREF: sub_40C78E+8r
					; sub_40C78E+6Fw ...
dword_430098	dd ?			; DATA XREF: .text:0040C6F3r
					; .text:0040C75Aw ...
dword_43009C	dd ?			; DATA XREF: .text:0040C650r
					; .text:0040C6B7w ...
dword_4300A0	dd ?			; DATA XREF: sub_40C5EF+17r
					; sub_40C5EF+3Bw ...
dword_4300A4	dd ?			; DATA XREF: .text:0040C554r
					; .text:0040C5BBw ...
dword_4300A8	dd ?			; DATA XREF: sub_40C465+Br
					; sub_40C465+C1w ...
dword_4300AC	dd ?			; DATA XREF: sub_40C338+8r
					; sub_40C338:loc_40C395w
		align 20h
; CHAR Filename
Filename	db ?			; DATA XREF: sub_40C338+1Do
					; sub_40C338+56w ...
		align 4
		dd 42h dup(?)
dword_4301CC	dd ?			; DATA XREF: sub_40C1A5:loc_40C1E6r
					; sub_40C1A5+A4w ...
; LPCSTR lpPathName
lpPathName	dd ?			; DATA XREF: sub_40C06B+Br
					; sub_40C06B+44w ...
dword_4301D4	dd ?			; DATA XREF: sub_40BF91+6r
					; sub_40BF91+13w
dword_4301D8	dd ?			; DATA XREF: sub_40BF91+63w
					; sub_40BF91+68r ...
		align 10h
dword_4301E0	dd ?			; DATA XREF: sub_40D028+23r
					; sub_40D028+2Cr ...
		align 20h
dword_430200	dd ?			; DATA XREF: sub_40D9FF+9r
					; sub_40D9FF+84o ...
		align 20h
dword_430220	dd ?			; DATA XREF: sub_40D9C2+6w
					; sub_40D9FF+42r
dword_430224	dd ?			; DATA XREF: sub_40D9C2+Ew
					; sub_40D9FF:loc_40DA1Br
; int dword_430228
dword_430228	dd ?			; DATA XREF: sub_40D9C2+16w
					; sub_40D9FF+3Cr
; char *dword_43022C
dword_43022C	dd ?			; DATA XREF: sub_40D9C2+1Ew
					; sub_40D9FF+36r
; int dword_430230
dword_430230	dd ?			; DATA XREF: sub_40D9C2+26w
					; sub_40D9FF+30r
; int dword_430234
dword_430234	dd ?			; DATA XREF: sub_40D9C2+2Ew
					; sub_40D9FF+2Ar
; int dword_430238
dword_430238	dd ?			; DATA XREF: sub_40D9C2+36w
					; sub_40D9FF+24r
		align 10h
dword_430240	dd ?			; DATA XREF: sub_40EE1E+3Fr
					; sub_40EE1E+4Eo ...
dword_430244	dd ?			; DATA XREF: sub_40EE1E+2Ar
					; sub_40EE1E+7Ar ...
dword_430248	dd ?			; DATA XREF: .text:00411B85w
					; .text:00411C53r
dword_43024C	dd ?			; DATA XREF: .text:00411C8Er
dword_430250	dd ?			; DATA XREF: .text:00411CC3r
byte_430254	db ?			; DATA XREF: .text:00411B73o
					; .text:00411B8Fo ...
byte_430255	db ?			; DATA XREF: .text:00411C83r
byte_430256	db ?			; DATA XREF: .text:loc_411CB8r
		align 4
dword_430258	dd ?			; DATA XREF: sub_40EFA9+6r
					; sub_40EFA9+Fw
		align 10h
dword_430260	dd ?			; DATA XREF: sub_41699E+2Dr
					; sub_41699E+41r ...
dword_430264	dd ?			; DATA XREF: sub_41699E+15r
					; sub_41699E:loc_4169C1r ...
		align 20h
dword_430280	dd ?			; DATA XREF: .text:00417337w
					; .text:0041735Ao ...
dword_430284	dd ?			; DATA XREF: .text:00417340w
word_430288	dw ?			; DATA XREF: .text:0041734Aw
byte_43028A	db ?			; DATA XREF: .text:00417355w
		align 4
		dd 9 dup(?)
		db ?
byte_4302B1	db ?			; DATA XREF: .text:00417393w
dword_4302B2	dd ?			; DATA XREF: .text:00417278w
					; .text:00417304o ...
dword_4302B6	dd ?			; DATA XREF: .text:00417281w
dword_4302BA	dd ?			; DATA XREF: .text:0041728Aw
dword_4302BE	dd ?			; DATA XREF: .text:00417293w
dword_4302C2	dd ?			; DATA XREF: .text:0041729Cw
		align 10h
dword_4302D0	dd ?			; DATA XREF: .text:004171E1w
					; .text:00417244o ...
dword_4302D4	dd ?			; DATA XREF: .text:004171EAw
word_4302D8	dw ?			; DATA XREF: .text:004171F4w
byte_4302DA	db ?			; DATA XREF: .text:004171FFw
		align 10h
dword_4302E0	dd 8 dup(?)		; DATA XREF: .text:00417175o
					; .text:00417187o ...
dword_430300	dd ?			; DATA XREF: sub_417FEA:loc_418035r
					; sub_4181BA:loc_418228r ...
dword_430304	dd ?			; DATA XREF: .text:004198A7w
					; sub_4198AE+6r
dword_430308	dd ?			; DATA XREF: sub_41B864+B7r
					; sub_41B864:loc_41B96Dw
dword_43030C	dd ?			; DATA XREF: sub_41B864+F0w
					; sub_41B864+F5r ...
dword_430310	dd ?			; DATA XREF: sub_419524+41r
					; sub_419524+49w ...
dword_430314	dd ?			; DATA XREF: sub_41C657:loc_41C6A4r
					; sub_41C657+4BEw ...
dword_430318	dd ?			; DATA XREF: .text:0041CD23r
					; .text:0041CD2Cw
dword_43031C	dd ?			; DATA XREF: .text:0041CD60w
					; .text:0041CD7Ao
dword_430320	dd ?			; DATA XREF: .text:0041CD65o
dword_430324	dd ?			; DATA XREF: sub_41F74E+232r
					; sub_41F74E+23Br ...
dword_430328	dd ?			; DATA XREF: sub_41FA0E+7r
					; sub_4200C2+6w
		align 20h
; FILE *File
File		dd ?			; DATA XREF: sub_420105+8r
					; sub_420105+19r ...
		align 20h
; char Dest[79]
Dest		db 4Fh dup(?)		; DATA XREF: sub_4203B4+1Bo
					; .text:loc_420484o ...
byte_4303AF	db ?			; DATA XREF: sub_4203B4+27w
dword_4303B0	dd ?			; DATA XREF: sub_4203B4+3Fw
					; .text:loc_42043Cr ...
dword_4303B4	dd ?			; DATA XREF: sub_4203B4+34w
					; .text:00420424r ...
dword_4303B8	dd ?			; DATA XREF: sub_4203B4+4Aw
					; .text:loc_420454r ...
dword_4303BC	dd ?			; DATA XREF: .text:004203ADw
					; sub_420526:loc_420678r ...
dword_4303C0	dd ?			; DATA XREF: sub_4203B4+57w
					; .text:loc_42046Cr
dword_4303C4	dd ?			; DATA XREF: sub_420105+249w
					; sub_420526+88r ...
dword_4303C8	dd ?			; DATA XREF: sub_420105+24Ew
					; sub_420526:loc_420569r ...
dword_4303CC	dd ?			; DATA XREF: sub_4200D0+6r
					; sub_4200D0+14w ...
		align 20h
; CHAR Buffer[256]
Buffer		db 100h	dup(?)		; DATA XREF: sub_421C5A+29o
					; sub_421C5A+56o
dword_4304E0	dd ?			; DATA XREF: sub_4246F5+6r
					; sub_4246F5+Fr ...
dword_4304E4	dd ?			; DATA XREF: sub_42478C+E3w
					; sub_42488B+1DFw ...
dword_4304E8	dd ?			; DATA XREF: sub_42478C+EDw
					; sub_42488B+1E9w ...
dword_4304EC	dd ?			; DATA XREF: sub_424DED+70Er
					; sub_424DED:loc_425541w
dword_4304F0	dd ?			; DATA XREF: sub_424BA1+1CCr
					; sub_424BA1:loc_424DB3w
; char byte_4304F4[32]
byte_4304F4	db 20h dup(?)		; DATA XREF: sub_42488B+3Bo
					; sub_42488B+47o ...
dword_430514	dd ?			; DATA XREF: sub_42478C+45r
					; sub_42478C+4Dw
dword_430518	dd ?			; DATA XREF: sub_42478C:loc_4247E5r
					; sub_42478C+61w
dword_43051C	dd ?			; DATA XREF: sub_42478C:loc_424821r
					; sub_42478C:loc_424855w
; char *dword_430520
dword_430520	dd ?			; DATA XREF: sub_425C1E+3Br
					; sub_425C1E+6Ew ...
dword_430524	dd ?			; DATA XREF: sub_401010+3r
dword_430528	dd ?			; DATA XREF: sub_401010+25r
dword_43052C	dd ?			; DATA XREF: sub_401060+22w
dword_430530	dd ?			; DATA XREF: sub_401060+18w
dword_430534	dd ?			; DATA XREF: sub_401060+Ew
TlsIndex	dd ?			; DATA XREF: .tls:TlsIndex_ptro
; HMODULE hLibModule
hLibModule	dd ?			; DATA XREF: TlsCallback_0+60w
					; TlsCallback_0+83r ...
dword_430540	dd ?			; DATA XREF: sub_401060+2Cw
dword_430544	dd ?			; DATA XREF: sub_401060+3Dr
					; sub_401180+61r ...
dword_430548	dd ?			; DATA XREF: sub_401060+5Er
dword_43054C	dd ?			; DATA XREF: sub_401180+12Dw
					; TopLevelExceptionFilter:loc_42629Cr
dword_430550	dd ?			; DATA XREF: .text:004263C3r
					; sub_426410+4w
dword_430554	dd ?			; DATA XREF: sub_426730+9r
					; sub_426730:loc_426750w
dword_430558	dd ?			; DATA XREF: sub_4264F0+1Dr
					; sub_4264F0+58r ...
dword_43055C	dd ?			; DATA XREF: sub_4264F0+Br
					; sub_4264F0:loc_4265AFw ...
dword_430560	dd ?			; DATA XREF: sub_426CE0+4r
					; sub_426CE0+92w ...
dword_430564	dd ?			; DATA XREF: sub_426E30r
					; sub_426E30:loc_426E40w
		align 20h
dword_430580	dd 2Bh dup(?)		; DATA XREF: .rdata:0042EFE4o
dword_43062C	dd ?			; DATA XREF: .text:00426F5Aw
		dd 2 dup(?)
dword_430638	dd ?			; DATA XREF: .text:00426F46w
		dd 2 dup(?)
dword_430644	dd ?			; DATA XREF: .text:00426F2Cw
		dd 86h dup(?)
dword_430860	dd ?			; DATA XREF: .text:00426F32w
					; .rdata:off_42EFE0o
dword_430864	dd ?			; DATA XREF: .text:00426F3Cw
		dd ?
dword_43086C	dd ?			; DATA XREF: .text:00426F4Bw
		dd 14h dup(?)
dword_4308C0	dd ?			; DATA XREF: .text:00427023r
					; .text:004270B4r ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_426FB0+7o
					; sub_426FB0:loc_427005o ...
dword_4308DC	dd ?			; DATA XREF: sub_426FB0+14r
					; .text:00427078r ...
		dd ?
dword_4308E4	dd ?			; DATA XREF: sub_401180+1A8w
dword_4308E8	dd ?			; DATA XREF: sub_401180+1BFw
dword_4308EC	dd ?			; DATA XREF: sub_401180+1B2w
		dd 5 dup(?)
dword_430904	dd ?			; DATA XREF: sub_401BD6:loc_401C7Fr
					; sub_4032E3:loc_4034ECr ...
		dd 20h dup(?)
dword_430988	dd ?			; DATA XREF: sub_417FEA:loc_418019r
					; sub_417FEA+79r ...
dword_43098C	dd ?			; DATA XREF: TlsCallback_0+A3w
					; TlsCallback_0:loc_426083w ...
dword_430990	dd ?			; DATA XREF: TlsCallback_0+7Ew
					; TlsCallback_0+AEr ...
dword_430994	dd ?			; DATA XREF: TlsCallback_0:loc_425FD4w
dword_430998	dd ?			; DATA XREF: sub_401060+64w
					; sub_426150+3Fr ...
dword_43099C	dd ?			; DATA XREF: sub_401060+69w
					; sub_426150+4r ...
dword_4309A0	dd ?			; DATA XREF: sub_401180+A0o
					; sub_401180+ECw
dword_4309A4	dd ?			; DATA XREF: sub_401180+B3r
					; sub_401180:loc_401243r ...
		align 800h
_bss		ends

;
; Imports from libassuan-0.dll
;
; Section 5. (virtual address 00031000)
; Virtual size			: 00001BB0 (   7088.)
; Section size in file		: 00001C00 (   7168.)
; Offset to raw	data for section: 0002CC00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
		extrn __imp_assuan_new:dword ; DATA XREF: assuan_newr
		extrn __imp_assuan_pipe_connect:dword ;	DATA XREF: assuan_pipe_connectr
		extrn __imp_assuan_release:dword ; DATA	XREF: assuan_releaser
		extrn __imp_assuan_socket_connect:dword	; DATA XREF: assuan_socket_connectr
		extrn __imp_assuan_transact:dword ; DATA XREF: assuan_transactr

;
; Imports from libgcrypt-20.dll
;
		extrn __imp_gcry_calloc:dword ;	DATA XREF: gcry_callocr
		extrn __imp_gcry_check_version:dword ; DATA XREF: gcry_check_versionr
		extrn __imp_gcry_cipher_close:dword ; DATA XREF: gcry_cipher_closer
		extrn __imp_gcry_cipher_decrypt:dword ;	DATA XREF: gcry_cipher_decryptr
		extrn __imp_gcry_cipher_encrypt:dword ;	DATA XREF: gcry_cipher_encryptr
		extrn __imp_gcry_cipher_get_algo_blklen:dword
					; DATA XREF: gcry_cipher_get_algo_blklenr
		extrn __imp_gcry_cipher_open:dword ; DATA XREF:	gcry_cipher_openr
		extrn __imp_gcry_cipher_setiv:dword ; DATA XREF: gcry_cipher_setivr
		extrn __imp_gcry_cipher_setkey:dword ; DATA XREF: gcry_cipher_setkeyr
		extrn __imp_gcry_control:dword ; DATA XREF: gcry_controlr
		extrn __imp_gcry_create_nonce:dword ; DATA XREF: gcry_create_noncer
		extrn __imp_gcry_free:dword ; DATA XREF: gcry_freer
		extrn __imp_gcry_malloc:dword ;	DATA XREF: gcry_mallocr
		extrn __imp_gcry_malloc_secure:dword ; DATA XREF: gcry_malloc_securer
		extrn __imp_gcry_md_close:dword	; DATA XREF: gcry_md_closer
		extrn __imp_gcry_md_ctl:dword ;	DATA XREF: gcry_md_ctlr
		extrn __imp_gcry_md_get_algo_dlen:dword	; DATA XREF: gcry_md_get_algo_dlenr
		extrn __imp_gcry_md_hash_buffer:dword ;	DATA XREF: gcry_md_hash_bufferr
		extrn __imp_gcry_md_open:dword ; DATA XREF: gcry_md_openr
		extrn __imp_gcry_md_read:dword ; DATA XREF: gcry_md_readr
		extrn __imp_gcry_md_reset:dword	; DATA XREF: gcry_md_resetr
		extrn __imp_gcry_md_setkey:dword ; DATA	XREF: gcry_md_setkeyr
		extrn __imp_gcry_md_write:dword	; DATA XREF: gcry_md_writer
		extrn __imp_gcry_mpi_add:dword ; DATA XREF: gcry_mpi_addr
		extrn __imp_gcry_mpi_add_ui:dword ; DATA XREF: gcry_mpi_add_uir
		extrn __imp_gcry_mpi_clear_highbit:dword
					; DATA XREF: gcry_mpi_clear_highbitr
		extrn __imp_gcry_mpi_cmp:dword ; DATA XREF: gcry_mpi_cmpr
		extrn __imp_gcry_mpi_cmp_ui:dword ; DATA XREF: gcry_mpi_cmp_uir
		extrn __imp_gcry_mpi_copy:dword	; DATA XREF: gcry_mpi_copyr
		extrn __imp_gcry_mpi_div:dword ; DATA XREF: gcry_mpi_divr
		extrn __imp_gcry_mpi_gcd:dword ; DATA XREF: gcry_mpi_gcdr
		extrn __imp_gcry_mpi_invm:dword	; DATA XREF: gcry_mpi_invmr
		extrn __imp_gcry_mpi_mod:dword ; DATA XREF: gcry_mpi_modr
		extrn __imp_gcry_mpi_mul:dword ; DATA XREF: gcry_mpi_mulr
		extrn __imp_gcry_mpi_print:dword ; DATA	XREF: gcry_mpi_printr
		extrn __imp_gcry_mpi_release:dword ; DATA XREF:	gcry_mpi_releaser
		extrn __imp_gcry_mpi_scan:dword	; DATA XREF: gcry_mpi_scanr
		extrn __imp_gcry_mpi_set:dword ; DATA XREF: gcry_mpi_setr
		extrn __imp_gcry_mpi_snew:dword	; DATA XREF: gcry_mpi_snewr
		extrn __imp_gcry_mpi_sub_ui:dword ; DATA XREF: gcry_mpi_sub_uir
		extrn __imp_gcry_pk_get_keygrip:dword ;	DATA XREF: gcry_pk_get_keygripr
		extrn __imp_gcry_randomize:dword ; DATA	XREF: gcry_randomizer
		extrn __imp_gcry_realloc:dword ; DATA XREF: gcry_reallocr
		extrn __imp_gcry_set_fatalerror_handler:dword
					; DATA XREF: gcry_set_fatalerror_handlerr
		extrn __imp_gcry_set_log_handler:dword ; DATA XREF: gcry_set_log_handlerr
		extrn __imp_gcry_set_outofcore_handler:dword
					; DATA XREF: gcry_set_outofcore_handlerr
		extrn __imp_gcry_sexp_build:dword ; DATA XREF: gcry_sexp_buildr
		extrn __imp_gcry_sexp_cadr:dword ; DATA	XREF: gcry_sexp_cadrr
		extrn __imp_gcry_sexp_canon_len:dword ;	DATA XREF: gcry_sexp_canon_lenr
		extrn __imp_gcry_sexp_find_token:dword ; DATA XREF: gcry_sexp_find_tokenr
		extrn __imp_gcry_sexp_new:dword	; DATA XREF: gcry_sexp_newr
		extrn __imp_gcry_sexp_nth_data:dword ; DATA XREF: gcry_sexp_nth_datar
		extrn __imp_gcry_sexp_nth_mpi:dword ; DATA XREF: gcry_sexp_nth_mpir
		extrn __imp_gcry_sexp_release:dword ; DATA XREF: gcry_sexp_releaser
		extrn __imp_gcry_sexp_sprint:dword ; DATA XREF:	gcry_sexp_sprintr
		extrn __imp_gcry_sexp_sscan:dword ; DATA XREF: gcry_sexp_sscanr
		extrn __imp_gcry_strdup:dword ;	DATA XREF: gcry_strdupr
		extrn __imp_gcry_xcalloc:dword ; DATA XREF: gcry_xcallocr
		extrn __imp_gcry_xmalloc:dword ; DATA XREF: gcry_xmallocr
		extrn __imp_gcry_xmalloc_secure:dword ;	DATA XREF: gcry_xmalloc_securer
		extrn __imp_gcry_xrealloc:dword	; DATA XREF: gcry_xreallocr
		extrn __imp_gcry_xstrdup:dword ; DATA XREF: gcry_xstrdupr

;
; Imports from libgpg-error-0.dll
;
		extrn __imp_gpg_err_code_from_errno:dword
					; DATA XREF: gpg_err_code_from_errnor
		extrn __imp_gpg_err_code_from_syserror:dword
					; DATA XREF: gpg_err_code_from_syserrorr
		extrn __imp_gpg_strerror:dword ; DATA XREF: gpg_strerrorr

;
; Imports from libiconv-2.dll
;
		extrn __imp_libiconv:dword ; DATA XREF:	libiconvr
		extrn __imp_libiconv_close:dword ; DATA	XREF: libiconv_closer
		extrn __imp_libiconv_open:dword	; DATA XREF: libiconv_openr

;
; Imports from ADVAPI32.dll
;
; BOOL __stdcall CopySid(DWORD nDestinationSidLength, PSID pDestinationSid, PSID pSourceSid)
		extrn CopySid:dword	; CODE XREF: .text:0041D296p
					; DATA XREF: .text:0041D291r
; DWORD	__stdcall GetLengthSid(PSID pSid)
		extrn GetLengthSid:dword ; CODE	XREF: .text:0041D25Fp
					; DATA XREF: .text:0041D25Ar
; BOOL __stdcall GetTokenInformation(HANDLE TokenHandle, TOKEN_INFORMATION_CLASS TokenInformationClass,	LPVOID TokenInformation, DWORD TokenInformationLength, PDWORD ReturnLength)
		extrn GetTokenInformation:dword	; CODE XREF: .text:0041D1DAp
					; .text:0041D233p
					; DATA XREF: ...
; BOOL __stdcall IsValidSid(PSID pSid)
		extrn IsValidSid:dword	; CODE XREF: .text:0041D249p
					; DATA XREF: .text:0041D244r
; BOOL __stdcall OpenProcessToken(HANDLE ProcessHandle,	DWORD DesiredAccess, PHANDLE TokenHandle)
		extrn OpenProcessToken:dword ; CODE XREF: .text:0041D1A3p
					; DATA XREF: .text:0041D19Er
; LSTATUS __stdcall RegCloseKey(HKEY hKey)
		extrn RegCloseKey:dword	; CODE XREF: sub_4257A2+314p
					; DATA XREF: sub_4257A2+30Fr
; LSTATUS __stdcall RegOpenKeyExA(HKEY hKey, LPCSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY	phkResult)
		extrn RegOpenKeyExA:dword ; CODE XREF: sub_4257A2+55p
					; sub_4257A2+98p
					; DATA XREF: ...
; LSTATUS __stdcall RegQueryValueExA(HKEY hKey,	LPCSTR lpValueName, LPDWORD lpReserved,	LPDWORD	lpType,	LPBYTE lpData, LPDWORD lpcbData)
		extrn RegQueryValueExA:dword ; CODE XREF: sub_4257A2+E3p
					; sub_4257A2+140p
					; DATA XREF: ...

;
; Imports from KERNEL32.dll
;
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: sub_40BF67+17p
					; sub_4130A7+1EDp ...
; BOOL __stdcall CreateDirectoryA(LPCSTR lpPathName, LPSECURITY_ATTRIBUTES lpSecurityAttributes)
		extrn CreateDirectoryA:dword ; CODE XREF: sub_40C06B+11Dp
					; sub_4130A7+EDp ...
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
		extrn CreateFileA:dword	; CODE XREF: sub_4130A7+1B6p
					; sub_4180CF+DEp ...
; HANDLE __stdcall CreateMutexA(LPSECURITY_ATTRIBUTES lpMutexAttributes, BOOL bInitialOwner, LPCSTR lpName)
		extrn CreateMutexA:dword ; CODE	XREF: sub_41C528+22p
					; DATA XREF: sub_41C528+1Dr
; BOOL __stdcall CreatePipe(PHANDLE hReadPipe, PHANDLE hWritePipe, LPSECURITY_ATTRIBUTES lpPipeAttributes, DWORD nSize)
		extrn CreatePipe:dword	; CODE XREF: sub_41D9D9+4Ep
					; DATA XREF: sub_41D9D9+49r
; BOOL __stdcall CreateProcessA(LPCSTR lpApplicationName, LPSTR	lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES	lpThreadAttributes, BOOL bInheritHandles, DWORD	dwCreationFlags, LPVOID	lpEnvironment, LPCSTR lpCurrentDirectory, LPSTARTUPINFOA lpStartupInfo,	LPPROCESS_INFORMATION lpProcessInformation)
		extrn CreateProcessA:dword ; CODE XREF:	.text:0041DE7Cp
					; sub_41DFF0+1B3p ...
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_427150+44p
					; DATA XREF: sub_427150+44r
; BOOL __stdcall DuplicateHandle(HANDLE	hSourceProcessHandle, HANDLE hSourceHandle, HANDLE hTargetProcessHandle, LPHANDLE lpTargetHandle, DWORD	dwDesiredAccess, BOOL bInheritHandle, DWORD dwOptions)
		extrn DuplicateHandle:dword ; CODE XREF: sub_41D9D9+A3p
					; DATA XREF: sub_41D9D9+9Er
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_426FB0+Ep
					; .text:00427072p ...
; DWORD	__stdcall ExpandEnvironmentStringsA(LPCSTR lpSrc, LPSTR	lpDst, DWORD nSize)
		extrn ExpandEnvironmentStringsA:dword ;	CODE XREF: sub_4257A2+1CFp
					; sub_4257A2+235p
					; DATA XREF: ...
; DWORD	__stdcall FormatMessageA(DWORD dwFlags,	LPCVOID	lpSource, DWORD	dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments)
		extrn FormatMessageA:dword ; CODE XREF:	sub_421C5A+51p
					; DATA XREF: sub_421C5A+4Cr
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: TlsCallback_0+10Ap
					; DATA XREF: TlsCallback_0+10Ar
; UINT __stdcall GetACP()
		extrn GetACP:dword	; CODE XREF: sub_42488B+26p
					; DATA XREF: sub_42488B+21r
; UINT __stdcall GetConsoleOutputCP()
		extrn GetConsoleOutputCP:dword ; CODE XREF: sub_42488B+16p
					; DATA XREF: sub_42488B+11r
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: sub_403EF6+26p
					; sub_41D9D9+66p ...
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_4130A7+Fp
					; .text:0041CE22p ...
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_426E50+74p
					; DATA XREF: sub_426E50+74r
; BOOL __stdcall GetExitCodeProcess(HANDLE hProcess, LPDWORD lpExitCode)
		extrn GetExitCodeProcess:dword ; CODE XREF: sub_41E25F+AAp
					; DATA XREF: sub_41E25F+A5r
; BOOL __stdcall GetFileInformationByHandle(HANDLE hFile, LPBY_HANDLE_FILE_INFORMATION lpFileInformation)
		extrn GetFileInformationByHandle:dword ; CODE XREF: .text:00425BA8p
					; .text:00425BC3p
					; DATA XREF: ...
; DWORD	__stdcall GetFileSize(HANDLE hFile, LPDWORD lpFileSizeHigh)
		extrn GetFileSize:dword	; CODE XREF: sub_41B864+17Ap
					; DATA XREF: sub_41B864+175r
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_41831F+C2p
					; sub_418448+B2p ...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename,	DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_40C338+31p
					; sub_427500+C2p
					; DATA XREF: ...
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_4014F0+16p
					; sub_426CE0+87p
					; DATA XREF: ...
; DWORD	__stdcall GetPriorityClass(HANDLE hProcess)
		extrn GetPriorityClass:dword ; CODE XREF: .text:0041DE22p
					; sub_41DFF0+15Cp ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_401180+142p
					; sub_4014F0+33p ...
; BOOL __stdcall GetProcessTimes(HANDLE	hProcess, LPFILETIME lpCreationTime, LPFILETIME	lpExitTime, LPFILETIME lpKernelTime, LPFILETIME	lpUserTime)
		extrn GetProcessTimes:dword ; CODE XREF: sub_403EF6+43p
					; DATA XREF: sub_403EF6+3Er
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: sub_401180+2F6p
					; DATA XREF: sub_401180+2F6r
; HANDLE __stdcall GetStdHandle(DWORD nStdHandle)
		extrn GetStdHandle:dword ; CODE	XREF: sub_418448+226p
					; sub_418448+23Cp ...
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_426E50+57p
					; DATA XREF: sub_426E50+57r
; DWORD	__stdcall GetTempPathA(DWORD nBufferLength, LPSTR lpBuffer)
		extrn GetTempPathA:dword ; CODE	XREF: sub_4130A7+2Ap
					; .text:0041CE6Bp
					; DATA XREF: ...
; LCID __stdcall GetThreadLocale()
		extrn GetThreadLocale:dword ; CODE XREF: sub_41E584+7Fp
					; DATA XREF: sub_41E584:loc_41E5FEr
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_4130A7+119p
					; .text:0041CF54p ...
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_427150+87p
					; DATA XREF: sub_427150+87r
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_426FB0+5Cp
					; .text:00427090p ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: sub_40BF04+11p
					; sub_417EEA+11p ...
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: sub_426CE0+A7p
					; DATA XREF: sub_426CE0+A7r
; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
		extrn MultiByteToWideChar:dword	; CODE XREF: sub_41F4E5+38p
					; sub_41F4E5+D5p
					; DATA XREF: ...
; HANDLE __stdcall OpenProcess(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwProcessId)
		extrn OpenProcess:dword	; CODE XREF: .text:0041D177p
					; DATA XREF: .text:0041D172r
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_426E50+8Bp
					; DATA XREF: sub_426E50+8Br
; BOOL __stdcall ReadFile(HANDLE hFile,	LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped)
		extrn ReadFile:dword	; CODE XREF: sub_418448+A4p
					; DATA XREF: sub_418448+9Fr
; BOOL __stdcall ReleaseMutex(HANDLE hMutex)
		extrn ReleaseMutex:dword ; CODE	XREF: sub_41C5F9+1Cp
					; DATA XREF: sub_41C5F9+17r
; DWORD	__stdcall ResumeThread(HANDLE hThread)
		extrn ResumeThread:dword ; CODE	XREF: .text:0041DF29p
					; sub_41DFF0+244p
					; DATA XREF: ...
; DWORD	__stdcall SetFilePointer(HANDLE	hFile, LONG lDistanceToMove, PLONG lpDistanceToMoveHigh, DWORD dwMoveMethod)
		extrn SetFilePointer:dword ; CODE XREF:	sub_41831F+B3p
					; .text:0041BBAFp
					; DATA XREF: ...
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_401180+124p
					; .text:00426F6Fp
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_401180+8Fp
					; sub_4130A7+20Ap ...
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: .text:00426F99p
					; DATA XREF: .text:00426F99r
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_426FB0+35p
					; DATA XREF: sub_426FB0+21r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:00426F7Fp
					; DATA XREF: .text:00426F7Fr
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_4264F0+142p
					; sub_4264F0+184p ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_4264F0+A1p
					; sub_4264F0+D9p ...
; DWORD	__stdcall WaitForSingleObject(HANDLE hHandle, DWORD dwMilliseconds)
		extrn WaitForSingleObject:dword	; CODE XREF: sub_41C528+74p
					; sub_41E25F+46p
					; DATA XREF: ...
; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
		extrn WideCharToMultiByte:dword	; CODE XREF: sub_41F5E7+48p
					; sub_41F5E7+C8p
					; DATA XREF: ...
; BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite,	LPDWORD	lpNumberOfBytesWritten,	LPOVERLAPPED lpOverlapped)
		extrn WriteFile:dword	; CODE XREF: sub_418448+165p
					; DATA XREF: sub_418448+160r

;
; Imports from msvcrt.dll
;
		extrn __imp__access:dword ; DATA XREF: _accessr
		extrn __imp__close:dword ; DATA	XREF: _closer
		extrn __imp__dup:dword	; DATA XREF: _dupr
; FILE *__cdecl	_fdopen(int FileHandle,	const char *Format)
		extrn __imp__fdopen:dword ; DATA XREF: _fdopenr
; int __cdecl _fileno(FILE *File)
		extrn __imp__fileno:dword ; DATA XREF: _filenor
		extrn __imp__getpid:dword ; DATA XREF: _getpidr
		extrn __imp__open:dword	; DATA XREF: _openr
; int __cdecl _putenv(const char *EnvString)
		extrn __imp__putenv:dword ; DATA XREF: _putenvr
		extrn __imp__read:dword	; DATA XREF: _readr
		extrn __imp__setmode:dword ; DATA XREF:	_setmoder
; void __cdecl _tzset()
		extrn __imp__tzset:dword ; DATA	XREF: _tzsetr
		extrn __imp__write:dword ; DATA	XREF: _writer

;
; Imports from msvcrt.dll
;
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
; unsigned __int32 *__cdecl __doserrno()
		extrn __imp___doserrno:dword ; DATA XREF: __doserrnor
		extrn __imp___getmainargs:dword	; DATA XREF: __getmainargsr
		extrn __initenv:dword	; DATA XREF: sub_401180+23Er
		extrn __lconv_init:dword ; DATA	XREF: sub_426120r
		extrn __pioinfo:dword	; DATA XREF: sub_4279A0+F1r
					; sub_4279A0+13Ar ...
		extrn __imp___set_app_type:dword ; DATA	XREF: __set_app_typer
		extrn __imp___setusermatherr:dword ; DATA XREF:	__setusermatherrr
		extrn _acmdln:dword	; DATA XREF: sub_401180+166r
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
		extrn __imp__cexit:dword ; DATA	XREF: _cexitr
; int *__cdecl _errno()
		extrn __imp__errno:dword ; CODE	XREF: sub_4017E7+E3p
					; sub_4017E7+14Ep ...
; void __cdecl __noreturn _exit(int Code)
		extrn __imp__exit:dword	; DATA XREF: _exitr
		extrn __imp__filelengthi64:dword ; DATA	XREF: _filelengthi64r
; int __cdecl _fileno_0(FILE *File)
		extrn __imp__fileno_0:dword ; DATA XREF: _fileno_0r
; int fmode
		extrn _fmode:dword	; DATA XREF: sub_401060+6Er
		extrn _fstati64:dword	; CODE XREF: sub_4017E7+195p
					; sub_41B864+46p ...
		extrn _get_osfhandle:dword ; CODE XREF:	sub_41C200+1Ep
					; .text:0041DCE0p ...
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn _iob:dword	; DATA XREF: sub_4017E7+3Br
					; sub_401AB5:loc_401B99r ...
		extrn __imp__lock:dword	; DATA XREF: _lockr
		extrn __imp__lseeki64:dword ; DATA XREF: _lseeki64r
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_426150+A3p
					; DATA XREF: sub_426150+A3r
		extrn _open_osfhandle:dword ; CODE XREF: sub_4130A7+1D7p
					; sub_41CD9F+2Cp ...
; int __cdecl strnicmp(const char *Str1, const char *Str, size_t MaxCount)
		extrn _strnicmp:dword	; CODE XREF: .text:0040BECFp
					; DATA XREF: .text:0040BECAr
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
		extrn _winmajor:dword	; DATA XREF: TlsCallback_0+4r
		extrn __imp__write_0:dword ; DATA XREF:	_write_0r
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; int __cdecl atoi(const char *Str)
		extrn __imp_atoi:dword	; DATA XREF: atoir
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; void __cdecl clearerr(FILE *File)
		extrn __imp_clearerr:dword ; DATA XREF:	clearerrr
; void __cdecl __noreturn exit(int Code)
		extrn __imp_exit:dword	; DATA XREF: exitr
; int __cdecl fclose(FILE *File)
		extrn __imp_fclose:dword ; DATA	XREF: fcloser
; int __cdecl ferror(FILE *File)
		extrn __imp_ferror:dword ; DATA	XREF: ferrorr
; int __cdecl fflush(FILE *File)
		extrn __imp_fflush:dword ; DATA	XREF: fflushr
; int __cdecl fgetpos(FILE *File, fpos_t *Pos)
		extrn __imp_fgetpos:dword ; DATA XREF: fgetposr
; FILE *__cdecl	fopen(const char *Filename, const char *Mode)
		extrn __imp_fopen:dword	; DATA XREF: fopenr
; int fprintf(FILE *File, const	char *Format, ...)
		extrn __imp_fprintf:dword ; DATA XREF: fprintfr
; int __cdecl fputs(const char *Str, FILE *File)
		extrn __imp_fputs:dword	; DATA XREF: fputsr
; size_t __cdecl fread(void *DstBuf, size_t ElementSize, size_t	Count, FILE *File)
		extrn __imp_fread:dword	; DATA XREF: freadr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; int __cdecl fseek(FILE *File,	__int32	Offset,	int Origin)
		extrn __imp_fseek:dword	; DATA XREF: fseekr
; int __cdecl fsetpos(FILE *File, const	fpos_t *Pos)
		extrn __imp_fsetpos:dword ; DATA XREF: fsetposr
; __int32 __cdecl ftell(FILE *File)
		extrn __imp_ftell:dword	; DATA XREF: ftellr
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; int __cdecl getc(FILE	*File)
		extrn __imp_getc:dword	; DATA XREF: getcr
; char *__cdecl	getenv(const char *VarName)
		extrn __imp_getenv:dword ; DATA	XREF: getenvr
; struct tm *__cdecl static gmtime(const time_t	*Time)
		extrn gmtime:dword	; DATA XREF: sub_427E40r
; int __cdecl isspace(int C)
		extrn isspace:dword	; CODE XREF: .text:0040E650p
					; .text:0040E85Fp ...
; struct tm *__cdecl static localtime(const time_t *Time)
		extrn localtime:dword	; DATA XREF: sub_427E60r
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; void *__cdecl	memchr(const void *Buf,	int Val, size_t	MaxCount)
		extrn __imp_memchr:dword ; DATA	XREF: memchrr
; int __cdecl memcmp(const void	*Buf1, const void *Buf2, size_t	Size)
		extrn __imp_memcmp:dword ; DATA	XREF: memcmpr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; void *__cdecl	memmove(void *Dst, const void *Src, size_t Size)
		extrn __imp_memmove:dword ; DATA XREF: memmover
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn __imp_memset:dword ; DATA	XREF: memsetr
; time_t __cdecl static	mktime(struct tm *Tm)
		extrn mktime:dword	; DATA XREF: sub_427E50r
; int printf(const char	*Format, ...)
		extrn __imp_printf:dword ; DATA	XREF: printfr
; int __cdecl putc(int Ch, FILE	*File)
		extrn __imp_putc:dword	; DATA XREF: putcr
; int __cdecl putchar(int Ch)
		extrn __imp_putchar:dword ; DATA XREF: putcharr
; int __cdecl puts(const char *Str)
		extrn __imp_puts:dword	; DATA XREF: putsr
		extrn __imp_raise:dword	; DATA XREF: raiser
; void *__cdecl	realloc(void *Memory, size_t NewSize)
		extrn __imp_realloc:dword ; DATA XREF: reallocr
; int __cdecl remove(const char	*Filename)
		extrn __imp_remove:dword ; DATA	XREF: remover
; void __cdecl rewind(FILE *File)
		extrn __imp_rewind:dword ; DATA	XREF: rewindr
		extrn __imp_setlocale:dword ; DATA XREF: setlocaler
; int __cdecl setvbuf(FILE *File, char *Buf, int Mode, size_t Size)
		extrn __imp_setvbuf:dword ; DATA XREF: setvbufr
		extrn __imp_signal:dword ; DATA	XREF: signalr
; int sprintf(char *Dest, const	char *Format, ...)
		extrn __imp_sprintf:dword ; DATA XREF: sprintfr
; char *__cdecl	strcat(char *Dest, const char *Source)
		extrn __imp_strcat:dword ; DATA	XREF: strcatr
; char *__cdecl	strchr(const char *Str,	int Val)
		extrn __imp_strchr:dword ; DATA	XREF: strchrr
; int __cdecl strcmp(const char	*Str1, const char *Str2)
		extrn __imp_strcmp:dword ; DATA	XREF: strcmpr
; char *__cdecl	strcpy(char *Dest, const char *Source)
		extrn __imp_strcpy:dword ; DATA	XREF: strcpyr
; size_t __cdecl strcspn(const char *Str, const	char *Control)
		extrn __imp_strcspn:dword ; DATA XREF: strcspnr
; char *__cdecl	strerror(int)
		extrn __imp_strerror:dword ; DATA XREF:	strerrorr
; size_t __cdecl strftime(char *Buf, size_t SizeInBytes, const char *Format, const struct tm *Tm)
		extrn __imp_strftime:dword ; DATA XREF:	strftimer
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; char *__cdecl	strncpy(char *Dest, const char *Source,	size_t Count)
		extrn __imp_strncpy:dword ; DATA XREF: strncpyr
; char *__cdecl	strpbrk(const char *Str, const char *Control)
		extrn __imp_strpbrk:dword ; DATA XREF: strpbrkr
; char *__cdecl	strrchr(const char *Str, int Ch)
		extrn __imp_strrchr:dword ; DATA XREF: strrchrr
; char *__cdecl	strstr(const char *Str,	const char *SubStr)
		extrn __imp_strstr:dword ; DATA	XREF: strstrr
; __int32 __cdecl strtol(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtol:dword ; DATA	XREF: strtolr
; unsigned __int32 __cdecl strtoul(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtoul:dword ; DATA XREF: strtoulr
; time_t __cdecl static	time(time_t *Time)
		extrn time:dword	; DATA XREF: sub_427E30r
; int __cdecl toupper(int C)
		extrn toupper:dword	; CODE XREF: .text:00420B5Dp
					; .text:00420B72p ...
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr

;
; Imports from USER32.dll
;
; BOOL __stdcall AllowSetForegroundWindow(DWORD	dwProcessId)
		extrn AllowSetForegroundWindow:dword ; CODE XREF: sub_41D0C0+41p
					; DATA XREF: sub_41D0C0+3Cr
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn MessageBoxA:dword	; CODE XREF: sub_427500+122p
					; DATA XREF: sub_427500+122r

;
; Imports from WS2_32.dll
;
; int __stdcall	WSAGetLastError()
		extrn WSAGetLastError:dword ; CODE XREF: sub_4186F4+A3p
					; sub_4186F4+14Dp
					; DATA XREF: ...
; int __stdcall	WSAStartup(WORD	wVersionRequested, LPWSADATA lpWSAData)
		extrn WSAStartup:dword	; CODE XREF: sub_40B9A4+2Bp
					; DATA XREF: sub_40B9A4+26r
; int __stdcall	closesocket(SOCKET s)
		extrn closesocket:dword	; CODE XREF: sub_4186F4+1F4p
					; DATA XREF: sub_4186F4+1EFr
; int __stdcall	recv(SOCKET s, char *buf, int len, int flags)
		extrn recv:dword	; CODE XREF: sub_4186F4+90p
					; DATA XREF: sub_4186F4+8Br
; int __stdcall	send(SOCKET s, const char *buf,	int len, int flags)
		extrn send:dword	; CODE XREF: sub_4186F4+13Ap
					; DATA XREF: sub_4186F4+135r


; Section 6. (virtual address 00033000)
; Virtual size			: 00000034 (	 52.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0002E800
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 433000h
dword_433000	dd 0			; DATA XREF: sub_401180+2D8o
		dd offset sub_401010
dword_433008	dd 0			; DATA XREF: sub_401180:loc_401450o
dword_43300C	dd 0			; DATA XREF: sub_401180+316o
		dd offset sub_401060
		dd offset sub_426120
dword_433018	dd 2 dup(0)		; DATA XREF: sub_401180+30Eo
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
		dd offset TlsCallback_1
		dd 0
		align 10h
dword_433030	dd 74h dup(0)		; DATA XREF: TlsCallback_0:loc_4260C3o
					; TlsCallback_0+138o ...
		align 1000h
_CRT		ends

; Section 7. (virtual address 00034000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0002EA00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 434000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end start
