;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	D0B469587A5F0CA7CFFCA9FB6AB9DD99
; Input	CRC32 :	5BD86C8A

; File Name   :	C:\compspace\compare\gpg\dlls\full\gpg-connect-agent.exe
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 000209E4 ( 133604.)
; Section size in file		: 00020A00 ( 133632.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
; [00000002 BYTES: COLLAPSED FUNCTION nullsub_1]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401010	proc near		; DATA XREF: .CRT:0042C004o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch

		sub	esp, 2Ch
		mov	eax, ds:dword_428C60
		mov	[esp+2Ch+var_1C], offset dword_428018
		mov	[esp+2Ch+var_24], offset dword_42800C
		mov	[esp+2Ch+var_28], offset dword_428008
		mov	ds:dword_428018, eax
		mov	eax, ds:dword_428C64
		mov	[esp+2Ch+var_2C], offset dword_428004
		mov	[esp+2Ch+var_20], eax
		call	__getmainargs
		mov	ds:dword_42801C, eax
		add	esp, 2Ch
		retn
sub_401010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401060	proc near		; DATA XREF: .CRT:0042C010o

var_1C		= dword	ptr -1Ch

		sub	esp, 1Ch
		xor	eax, eax
		cmp	word ptr ds:400000h, 5A4Dh
		mov	ds:dword_428C70, 1
		mov	ds:dword_428C6C, 1
		mov	ds:dword_428C68, 1
		mov	ds:dword_428C7C, 1
		jz	short loc_401100

loc_401098:				; CODE XREF: sub_401060+B6j
					; sub_401060+C8j ...
		mov	ds:dword_428014, eax
		mov	eax, ds:dword_428C80
		test	eax, eax
		jz	short loc_4010F0
		mov	[esp+1Ch+var_1C], 2
		call	__set_app_type

loc_4010B2:				; CODE XREF: sub_401060+9Cj
		mov	[esp+1Ch+var_1C], 0FFFFFFFFh
		call	sub_41FAA0
		mov	edx, ds:dword_428C84
		mov	ds:dword_429078, eax
		mov	ds:dword_42907C, eax
		mov	eax, ds:_fmode
		mov	[eax], edx
		call	sub_41FDE0
		cmp	dword_42218C, 1
		jz	short loc_401150
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4010F0:				; CODE XREF: sub_401060+44j
		mov	[esp+1Ch+var_1C], 1
		call	__set_app_type
		jmp	short loc_4010B2
; ---------------------------------------------------------------------------
		align 10h

loc_401100:				; CODE XREF: sub_401060+36j
		mov	edx, ds:40003Ch
		cmp	dword ptr [edx+400000h], 4550h
		lea	ecx, [edx+400000h]
		jnz	short loc_401098
		movzx	edx, word ptr [ecx+18h]
		cmp	dx, 10Bh
		jz	short loc_401162
		cmp	dx, 20Bh
		jnz	loc_401098
		cmp	dword ptr [ecx+84h], 0Eh
		jbe	loc_401098
		mov	edx, [ecx+0F8h]
		xor	eax, eax
		test	edx, edx
		setnz	al
		jmp	loc_401098
; ---------------------------------------------------------------------------
		align 10h

loc_401150:				; CODE XREF: sub_401060+81j
		mov	[esp+1Ch+var_1C], offset sub_41FD80
		call	sub_41FD70
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_401162:				; CODE XREF: sub_401060+C1j
		cmp	dword ptr [ecx+74h], 0Eh
		jbe	loc_401098
		mov	ecx, [ecx+0E8h]
		xor	eax, eax
		test	ecx, ecx
		setnz	al
		jmp	loc_401098
sub_401060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401180	proc near		; CODE XREF: .text:004014C5j start+15j

dwMilliseconds	= dword	ptr -88h
lpProcName	= dword	ptr -84h
Size		= dword	ptr -80h
var_6D		= byte ptr -6Dh
var_6C		= dword	ptr -6Ch
var_5C		= byte ptr -5Ch
var_30		= byte ptr -30h
var_2C		= word ptr -2Ch

		push	ebp
		xor	eax, eax
		mov	ebp, esp
		mov	ecx, 11h
		push	edi
		push	esi
		lea	edx, [ebp+var_5C]
		push	ebx
		mov	edi, edx
		sub	esp, 7Ch
		rep stosd
		mov	al, 30h
		call	sub_420B50
		sub	esp, eax
		lea	eax, [esp+88h+var_6D]
		and	eax, 0FFFFFFF0h
		mov	dword ptr [eax], 0CCCCCCCCh
		mov	dword ptr [eax+4], 0CCCCCCCCh
		mov	dword ptr [eax+8], 0CCCCCCCCh
		mov	dword ptr [eax+0Ch], 0CCCCCCCCh
		mov	dword ptr [eax+10h], 0CCCCCCCCh
		mov	dword ptr [eax+14h], 0CCCCCCCCh
		mov	dword ptr [eax+18h], 0CCCCCCCCh
		mov	dword ptr [eax+1Ch], 0CCCCCCCCh
		and	esp, 0FFFFFFF0h
		mov	eax, ds:dword_428C80
		test	eax, eax
		jnz	loc_401473

loc_4011EE:				; CODE XREF: sub_401180+2FFj
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_401214
; ---------------------------------------------------------------------------
		align 10h

loc_401200:				; CODE XREF: sub_401180+B1j
		cmp	eax, ebx
		jz	loc_401420
		mov	[esp+88h+dwMilliseconds], 3E8h ; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_401214:				; CODE XREF: sub_401180+7Dj
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], ebx
		mov	[esp+88h+dwMilliseconds], offset dword_429080
		call	sub_420E40
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_401200
		mov	eax, ds:dword_429084
		xor	ebx, ebx
		cmp	eax, 1
		jz	loc_401433

loc_401243:				; CODE XREF: sub_401180+2ADj
		mov	eax, ds:dword_429084
		test	eax, eax
		jz	loc_401484
		mov	ds:dword_428000, 1

loc_40125A:				; CODE XREF: sub_401180+322j
		mov	eax, ds:dword_429084
		cmp	eax, 1
		jz	loc_401450

loc_401268:				; CODE XREF: sub_401180+2C7j
					; sub_401180+2EEj
		test	ebx, ebx
		jnz	short loc_401273
		lock xchg ebx, ds:dword_429080

loc_401273:				; CODE XREF: sub_401180+EAj
		mov	eax, ds:off_42764C
		test	eax, eax
		jz	short loc_401298
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], 2
		mov	[esp+88h+dwMilliseconds], 0
		call	eax ; TlsCallback_0
		sub	esp, 0Ch

loc_401298:				; CODE XREF: sub_401180+FAj
		call	sub_420090
		mov	[esp+88h+dwMilliseconds], offset TopLevelExceptionFilter ; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	ds:dword_428C88, eax
		call	sub_420640
		mov	[esp+88h+lpProcName], offset ProcName ;	"_set_invalid_parameter_handler"
		mov	[esp+88h+dwMilliseconds], eax ;	hModule
		call	ds:GetProcAddress
		sub	esp, 8
		test	eax, eax
		jz	short loc_4012D8
		mov	[esp+88h+dwMilliseconds], offset nullsub_1
		call	eax

loc_4012D8:				; CODE XREF: sub_401180+14Dj
		call	sub_420700
		mov	eax, ds:dword_428C80
		test	eax, eax
		jz	short loc_401344
		mov	eax, ds:_acmdln
		xor	ecx, ecx
		mov	eax, [eax]
		jmp	short loc_4012FC
; ---------------------------------------------------------------------------

loc_4012F1:				; CODE XREF: sub_401180+182j
		test	dl, dl
		jz	short loc_401320
		test	cl, cl
		jz	short loc_401315

loc_4012F9:				; CODE XREF: sub_401180+18Fj
		add	eax, 1

loc_4012FC:				; CODE XREF: sub_401180+16Fj
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_4012F1
		mov	ebx, ecx
		xor	ebx, 1
		cmp	dl, 22h
		cmovz	ecx, ebx
		jmp	short loc_4012F9
; ---------------------------------------------------------------------------

loc_401311:				; CODE XREF: sub_401180+19Ej
		test	dl, dl
		jz	short loc_401320

loc_401315:				; CODE XREF: sub_401180+177j
		add	eax, 1
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_401311

loc_401320:				; CODE XREF: sub_401180+173j
					; sub_401180+193j
		movzx	edx, [ebp+var_2C]
		test	[ebp+var_30], 1
		mov	ds:dword_429024, eax
		mov	eax, 0Ah
		mov	ds:dword_42902C, 400000h
		cmovnz	eax, edx
		mov	ds:dword_429028, eax

loc_401344:				; CODE XREF: sub_401180+164j
		mov	edx, ds:dword_428004
		xor	ebx, ebx
		lea	eax, ds:4[edx*4]
		mov	[ebp+var_6C], edx
		mov	[esp+88h+dwMilliseconds], eax ;	Size
		call	malloc
		mov	edi, ds:dword_428008
		mov	[ebp-70h], eax
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jle	short loc_4013AA
		xchg	ax, ax

loc_401370:				; CODE XREF: sub_401180+225j
		mov	eax, [edi+ebx*4]
		mov	[esp+88h+dwMilliseconds], eax ;	Str
		call	strlen
		lea	esi, [eax+1]
		mov	[esp+88h+dwMilliseconds], esi ;	Size
		call	malloc
		mov	edx, [ebp-70h]
		mov	[edx+ebx*4], eax
		mov	edx, [edi+ebx*4]
		add	ebx, 1
		mov	[esp+88h+Size],	esi ; Size
		mov	[esp+88h+dwMilliseconds], eax ;	Dst
		mov	[esp+88h+lpProcName], edx ; Src
		call	memcpy
		cmp	ebx, [ebp+var_6C]
		jnz	short loc_401370
		shl	ebx, 2

loc_4013AA:				; CODE XREF: sub_401180+1ECj
		mov	eax, [ebp-70h]
		mov	dword ptr [eax+ebx], 0
		mov	ds:dword_428008, eax
		call	sub_420790
		mov	eax, ds:__initenv
		mov	edx, ds:dword_42800C
		mov	[eax], edx
		mov	eax, ds:dword_42800C
		mov	[esp+88h+Size],	eax
		mov	eax, ds:dword_428008
		mov	[esp+88h+lpProcName], eax
		mov	eax, ds:dword_428004
		mov	[esp+88h+dwMilliseconds], eax
		call	sub_40377D
		mov	esi, ds:dword_428014
		test	esi, esi
		mov	ds:dword_428010, eax
		jz	loc_4014A7
		mov	ebx, ds:dword_428000
		test	ebx, ebx
		jnz	short loc_401411
		call	_cexit
		mov	eax, ds:dword_428010

loc_401411:				; CODE XREF: sub_401180+285j
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_401420:				; CODE XREF: sub_401180+82j
		mov	eax, ds:dword_429084
		mov	ebx, 1
		cmp	eax, 1
		jnz	loc_401243

loc_401433:				; CODE XREF: sub_401180+BDj
		mov	[esp+88h+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, ds:dword_429084
		cmp	eax, 1
		jnz	loc_401268
		lea	esi, [esi+0]

loc_401450:				; CODE XREF: sub_401180+E2j
		mov	[esp+88h+lpProcName], offset dword_42C008
		mov	[esp+88h+dwMilliseconds], offset dword_42C000
		call	_initterm
		mov	ds:dword_429084, 2
		jmp	loc_401268
; ---------------------------------------------------------------------------

loc_401473:				; CODE XREF: sub_401180+68j
		mov	[esp+88h+dwMilliseconds], edx ;	lpStartupInfo
		call	ds:GetStartupInfoA
		sub	esp, 4
		jmp	loc_4011EE
; ---------------------------------------------------------------------------

loc_401484:				; CODE XREF: sub_401180+CAj
		mov	ds:dword_429084, 1
		mov	[esp+88h+lpProcName], offset dword_42C018
		mov	[esp+88h+dwMilliseconds], offset dword_42C00C
		call	_initterm
		jmp	loc_40125A
; ---------------------------------------------------------------------------

loc_4014A7:				; CODE XREF: sub_401180+277j
		mov	[esp+88h+dwMilliseconds], eax ;	Code
		call	exit
sub_401180	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		mov	ds:dword_428C80, 1
		call	sub_4207B0
		add	esp, 0Ch
		jmp	sub_401180
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public start
start		proc near
		sub	esp, 0Ch
		mov	ds:dword_428C80, 0
		call	sub_4207B0
		add	esp, 0Ch
		jmp	sub_401180
start		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4014F0	proc near		; CODE XREF: sub_4219B0+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_422198
		test	eax, eax
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj-12.dll"
		call	ds:GetModuleHandleA
		mov	edx, 0
		sub	esp, 4
		test	eax, eax
		jz	short loc_40152E
		mov	[esp+18h+lpProcName], offset a_jv_registercl ; "_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	eax ; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		mov	edx, eax

loc_40152E:				; CODE XREF: sub_4014F0+26j
		test	edx, edx
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset dword_422198
		call	edx

locret_40153B:				; CODE XREF: sub_4014F0+Dj
					; sub_4014F0+40j
		leave
		retn
sub_4014F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401540()
sub_401540	proc near		; DATA XREF: sub_4219B0+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401540	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401550	proc near		; CODE XREF: sub_401577+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_401570
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_401575
; ---------------------------------------------------------------------------

loc_401570:				; CODE XREF: sub_401550+7j
		mov	eax, 0

loc_401575:				; CODE XREF: sub_401550+1Ej
		pop	ebp
		retn
sub_401550	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401577	proc near		; CODE XREF: sub_405EA8+94Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_401550
		leave
		retn
sub_401577	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401592	proc near		; CODE XREF: sub_402175+519p
					; sub_406808+B7p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_401592	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40159F	proc near		; CODE XREF: sub_402175+597p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		shr	eax, 18h
		and	eax, 7Fh
		pop	ebp
		retn
sub_40159F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4015AD	proc near		; CODE XREF: sub_40377D+394p
					; sub_40377D+3A5p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jns	short loc_4015C0
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4015CD
; ---------------------------------------------------------------------------

loc_4015C0:				; CODE XREF: sub_4015AD+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle

locret_4015CD:				; CODE XREF: sub_4015AD+11j
		leave
		retn
sub_4015AD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4015CF	proc near		; DATA XREF: sub_40377D+45o

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 29h ; switch 42 cases
		ja	short loc_401654 ; jumptable 004015E8 default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_423278
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4015EA:				; CODE XREF: sub_4015CF+19j
					; DATA XREF: .rdata:off_423278o
		mov	[ebp+var_C], offset aGpgConnectAgen ; jumptable	004015E8 case 11
		jmp	short loc_40165C
; ---------------------------------------------------------------------------

loc_4015F3:				; CODE XREF: sub_4015CF+19j
					; DATA XREF: .rdata:off_423278o
		mov	[ebp+var_C], offset a2_0_30 ; jumptable	004015E8 case 13
		jmp	short loc_40165C
; ---------------------------------------------------------------------------

loc_4015FC:				; CODE XREF: sub_4015CF+19j
					; DATA XREF: .rdata:off_423278o
		mov	[ebp+var_C], offset aMingw32 ; jumptable 004015E8 case 17
		jmp	short loc_40165C
; ---------------------------------------------------------------------------

loc_401605:				; CODE XREF: sub_4015CF+19j
					; DATA XREF: .rdata:off_423278o
		mov	[esp+28h+var_28], offset aPleaseReportBu ; jumptable 004015E8 case 19
		call	sub_419D7C
		mov	[ebp+var_C], eax
		jmp	short loc_40165C
; ---------------------------------------------------------------------------

loc_401616:				; CODE XREF: sub_4015CF+19j
					; DATA XREF: .rdata:off_423278o
		mov	[esp+28h+var_28], offset aUsageGpgConnec ; jumptable 004015E8 cases 1,40
		call	sub_419D7C
		mov	[ebp+var_C], eax
		jmp	short loc_40165C
; ---------------------------------------------------------------------------

loc_401627:				; CODE XREF: sub_4015CF+19j
					; DATA XREF: .rdata:off_423278o
		mov	[esp+28h+var_28], offset aSyntaxGpgConne ; jumptable 004015E8 case 41
		call	sub_419D7C
		mov	[ebp+var_C], eax
		jmp	short loc_40165C
; ---------------------------------------------------------------------------

loc_401638:				; CODE XREF: sub_4015CF+19j
					; DATA XREF: .rdata:off_423278o
		mov	[ebp+var_C], offset aHome ; jumptable 004015E8 case 31
		jmp	short loc_40165C
; ---------------------------------------------------------------------------

loc_401641:				; CODE XREF: sub_4015CF+19j
					; DATA XREF: .rdata:off_423278o
		mov	eax, ds:dword_429048 ; jumptable 004015E8 case 32
		mov	[ebp+var_C], eax
		jmp	short loc_40165C
; ---------------------------------------------------------------------------

loc_40164B:				; CODE XREF: sub_4015CF+19j
					; DATA XREF: .rdata:off_423278o
		mov	[ebp+var_C], offset asc_423276 ; jumptable 004015E8 case 33
		jmp	short loc_40165C
; ---------------------------------------------------------------------------

loc_401654:				; CODE XREF: sub_4015CF+Aj
					; sub_4015CF+19j
					; DATA XREF: ...
		mov	[ebp+var_C], 0	; jumptable 004015E8 default case
		nop

loc_40165C:				; CODE XREF: sub_4015CF+22j
					; sub_4015CF+2Bj ...
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4015CF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401661	proc near		; CODE XREF: sub_402175+13Bp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 64h

loc_40166E:				; CODE XREF: sub_401661+5Dj
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+var_28], eax ;	size_t
		call	sub_406D00
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	_getcwd
		cmp	eax, [ebp+var_10]
		jnz	short loc_40169B
		mov	eax, [ebp+var_10]
		jmp	short locret_4016C0
; ---------------------------------------------------------------------------

loc_40169B:				; CODE XREF: sub_401661+33j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_406E5D
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 22h
		jz	short loc_4016BB
		mov	eax, 0
		jmp	short locret_4016C0
; ---------------------------------------------------------------------------

loc_4016BB:				; CODE XREF: sub_401661+51j
		shl	[ebp+var_C], 1
		jmp	short loc_40166E
; ---------------------------------------------------------------------------

locret_4016C0:				; CODE XREF: sub_401661+38j
					; sub_401661+58j
		leave
		retn
sub_401661	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4016C2	proc near		; CODE XREF: sub_402175+325p

var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_40186E
; ---------------------------------------------------------------------------

loc_4016E1:				; CODE XREF: sub_4016C2+1B4j
		cmp	[ebp+var_10], 0
		jz	loc_401853
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 22h	; switch 87 cases
		cmp	eax, 56h
		ja	loc_4017DE	; jumptable 00401707 default case
		mov	eax, ds:off_423320[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_401709:				; CODE XREF: sub_4016C2+45j
					; DATA XREF: .rdata:off_423320o
		add	[ebp+var_14], 1	; jumptable 00401707 cases 34,39,92,98,102,110,114,116,118
		jmp	loc_40184A
; ---------------------------------------------------------------------------

loc_401712:				; CODE XREF: sub_4016C2+45j
					; DATA XREF: .rdata:off_423320o
		mov	eax, [ebp+var_C] ; jumptable 00401707 case 120
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_401846
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_401846
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_40174E
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jbe	short loc_40178A

loc_40174E:				; CODE XREF: sub_4016C2+7Dj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jbe	short loc_401768
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jbe	short loc_40178A

loc_401768:				; CODE XREF: sub_4016C2+97j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jbe	loc_401846
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		ja	loc_401846

loc_40178A:				; CODE XREF: sub_4016C2+8Aj
					; sub_4016C2+A4j
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_4017A4
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jbe	short loc_4017D8

loc_4017A4:				; CODE XREF: sub_4016C2+D3j
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jbe	short loc_4017BE
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jbe	short loc_4017D8

loc_4017BE:				; CODE XREF: sub_4016C2+EDj
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jbe	short loc_401846
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		ja	short loc_401846

loc_4017D8:				; CODE XREF: sub_4016C2+E0j
					; sub_4016C2+FAj
		add	[ebp+var_14], 1
		jmp	short loc_401846
; ---------------------------------------------------------------------------

loc_4017DE:				; CODE XREF: sub_4016C2+38j
					; sub_4016C2+45j
					; DATA XREF: ...
		mov	eax, [ebp+var_C] ; jumptable 00401707 default case
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_401849
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_401849
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_401849
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 37h
		ja	short loc_401849
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_401849
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 37h
		ja	short loc_401849
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_401849
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 37h
		ja	short loc_401849
		add	[ebp+var_14], 1
		jmp	short loc_401849
; ---------------------------------------------------------------------------

loc_401846:				; CODE XREF: sub_4016C2+5Bj
					; sub_4016C2+6Cj ...
		nop
		jmp	short loc_40184A
; ---------------------------------------------------------------------------

loc_401849:				; CODE XREF: sub_4016C2+127j
					; sub_4016C2+134j ...
		nop

loc_40184A:				; CODE XREF: sub_4016C2+4Bj
					; sub_4016C2+185j
		mov	[ebp+var_10], 0
		jmp	short loc_40186A
; ---------------------------------------------------------------------------

loc_401853:				; CODE XREF: sub_4016C2+23j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_401866
		mov	[ebp+var_10], 1
		jmp	short loc_40186A
; ---------------------------------------------------------------------------

loc_401866:				; CODE XREF: sub_4016C2+199j
		add	[ebp+var_14], 1

loc_40186A:				; CODE XREF: sub_4016C2+18Fj
					; sub_4016C2+1A2j
		add	[ebp+var_C], 1

loc_40186E:				; CODE XREF: sub_4016C2+1Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4016E1
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[esp+38h+var_38], eax ;	size_t
		call	sub_406D00
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_401BAE
; ---------------------------------------------------------------------------

loc_4018A5:				; CODE XREF: sub_4016C2+4F4j
		cmp	[ebp+var_10], 0
		jz	loc_401B88
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 22h	; switch 87 cases
		cmp	eax, 56h
		ja	loc_401AC5	; jumptable 004018CB default case
		mov	eax, ds:off_42347C[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4018CD:				; CODE XREF: sub_4016C2+209j
					; DATA XREF: .rdata:off_42347Co
		mov	eax, [ebp+var_18] ; jumptable 004018CB case 98
		mov	byte ptr [eax],	8
		add	[ebp+var_18], 1
		jmp	loc_401B7F
; ---------------------------------------------------------------------------

loc_4018DC:				; CODE XREF: sub_4016C2+209j
					; DATA XREF: .rdata:off_42347Co
		mov	eax, [ebp+var_18] ; jumptable 004018CB case 116
		mov	byte ptr [eax],	9
		add	[ebp+var_18], 1
		jmp	loc_401B7F
; ---------------------------------------------------------------------------

loc_4018EB:				; CODE XREF: sub_4016C2+209j
					; DATA XREF: .rdata:off_42347Co
		mov	eax, [ebp+var_18] ; jumptable 004018CB case 118
		mov	byte ptr [eax],	0Bh
		add	[ebp+var_18], 1
		jmp	loc_401B7F
; ---------------------------------------------------------------------------

loc_4018FA:				; CODE XREF: sub_4016C2+209j
					; DATA XREF: .rdata:off_42347Co
		mov	eax, [ebp+var_18] ; jumptable 004018CB case 110
		mov	byte ptr [eax],	0Ah
		add	[ebp+var_18], 1
		jmp	loc_401B7F
; ---------------------------------------------------------------------------

loc_401909:				; CODE XREF: sub_4016C2+209j
					; DATA XREF: .rdata:off_42347Co
		mov	eax, [ebp+var_18] ; jumptable 004018CB case 102
		mov	byte ptr [eax],	0Ch
		add	[ebp+var_18], 1
		jmp	loc_401B7F
; ---------------------------------------------------------------------------

loc_401918:				; CODE XREF: sub_4016C2+209j
					; DATA XREF: .rdata:off_42347Co
		mov	eax, [ebp+var_18] ; jumptable 004018CB case 114
		mov	byte ptr [eax],	0Dh
		add	[ebp+var_18], 1
		jmp	loc_401B7F
; ---------------------------------------------------------------------------

loc_401927:				; CODE XREF: sub_4016C2+209j
					; DATA XREF: .rdata:off_42347Co
		mov	eax, [ebp+var_18] ; jumptable 004018CB case 34
		mov	byte ptr [eax],	22h
		add	[ebp+var_18], 1
		jmp	loc_401B7F
; ---------------------------------------------------------------------------

loc_401936:				; CODE XREF: sub_4016C2+209j
					; DATA XREF: .rdata:off_42347Co
		mov	eax, [ebp+var_18] ; jumptable 004018CB case 39
		mov	byte ptr [eax],	27h
		add	[ebp+var_18], 1
		jmp	loc_401B7F
; ---------------------------------------------------------------------------

loc_401945:				; CODE XREF: sub_4016C2+209j
					; DATA XREF: .rdata:off_42347Co
		mov	eax, [ebp+var_18] ; jumptable 004018CB case 92
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_18], 1
		jmp	loc_401B7F
; ---------------------------------------------------------------------------

loc_401954:				; CODE XREF: sub_4016C2+209j
					; DATA XREF: .rdata:off_42347Co
		mov	eax, [ebp+var_C] ; jumptable 004018CB case 120
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_401B7B
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_401B7B
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_401990
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jbe	short loc_4019CC

loc_401990:				; CODE XREF: sub_4016C2+2BFj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jbe	short loc_4019AA
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jbe	short loc_4019CC

loc_4019AA:				; CODE XREF: sub_4016C2+2D9j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jbe	loc_401B7B
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		ja	loc_401B7B

loc_4019CC:				; CODE XREF: sub_4016C2+2CCj
					; sub_4016C2+2E6j
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_4019E6
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jbe	short loc_401A22

loc_4019E6:				; CODE XREF: sub_4016C2+315j
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jbe	short loc_401A00
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jbe	short loc_401A22

loc_401A00:				; CODE XREF: sub_4016C2+32Fj
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jbe	loc_401B7B
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		ja	loc_401B7B

loc_401A22:				; CODE XREF: sub_4016C2+322j
					; sub_4016C2+33Cj
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_401A43
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_401A6F
; ---------------------------------------------------------------------------

loc_401A43:				; CODE XREF: sub_4016C2+36Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_401A5E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_401A6D
; ---------------------------------------------------------------------------

loc_401A5E:				; CODE XREF: sub_4016C2+389j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_401A6D:				; CODE XREF: sub_4016C2+39Aj
		mov	edx, eax

loc_401A6F:				; CODE XREF: sub_4016C2+37Fj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_401A8A
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_401AB1
; ---------------------------------------------------------------------------

loc_401A8A:				; CODE XREF: sub_4016C2+3B8j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_401AA5
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_401AB1
; ---------------------------------------------------------------------------

loc_401AA5:				; CODE XREF: sub_4016C2+3D3j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_401AB1:				; CODE XREF: sub_4016C2+3C6j
					; sub_4016C2+3E1j
		add	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_18], 1
		add	[ebp+var_C], 1
		jmp	loc_401B7B
; ---------------------------------------------------------------------------

loc_401AC5:				; CODE XREF: sub_4016C2+1FCj
					; sub_4016C2+209j
					; DATA XREF: ...
		mov	eax, [ebp+var_C] ; jumptable 004018CB default case
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_401B7E
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_401B7E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	loc_401B7E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 37h
		ja	short loc_401B7E
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_401B7E
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 37h
		ja	short loc_401B7E
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_401B7E
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 37h
		ja	short loc_401B7E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		lea	edx, ds:0[eax*8]
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		add	eax, edx
		lea	edx, ds:0[eax*8]
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		add	eax, edx
		lea	edx, [eax-30h]
		mov	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_18], 1
		add	[ebp+var_C], 2
		jmp	short loc_401B7E
; ---------------------------------------------------------------------------

loc_401B7B:				; CODE XREF: sub_4016C2+29Dj
					; sub_4016C2+2AEj ...
		nop
		jmp	short loc_401B7F
; ---------------------------------------------------------------------------

loc_401B7E:				; CODE XREF: sub_4016C2+40Ej
					; sub_4016C2+41Fj ...
		nop

loc_401B7F:				; CODE XREF: sub_4016C2+215j
					; sub_4016C2+224j ...
		mov	[ebp+var_10], 0
		jmp	short loc_401BAA
; ---------------------------------------------------------------------------

loc_401B88:				; CODE XREF: sub_4016C2+1E7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_401B9B
		mov	[ebp+var_10], 1
		jmp	short loc_401BAA
; ---------------------------------------------------------------------------

loc_401B9B:				; CODE XREF: sub_4016C2+4CEj
		mov	eax, [ebp+var_C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_18], 1

loc_401BAA:				; CODE XREF: sub_4016C2+4C4j
					; sub_4016C2+4D7j
		add	[ebp+var_C], 1

loc_401BAE:				; CODE XREF: sub_4016C2+1DEj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4018A5
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_1C]
		leave
		retn
sub_4016C2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401BC7	proc near		; CODE XREF: sub_402175+37Dp
					; sub_402175+3D5p

var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		jmp	short loc_401C2C
; ---------------------------------------------------------------------------

loc_401BDC:				; CODE XREF: sub_401BC7+6Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_401C0E
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_401C0E
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_401C0E
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1
		jmp	short loc_401C28
; ---------------------------------------------------------------------------

loc_401C0E:				; CODE XREF: sub_401BC7+1Dj
					; sub_401BC7+2Aj ...
		cmp	[ebp+arg_4], 0
		jz	short loc_401C24
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Bh
		jnz	short loc_401C24
		add	[ebp+var_14], 1
		jmp	short loc_401C28
; ---------------------------------------------------------------------------

loc_401C24:				; CODE XREF: sub_401BC7+4Bj
					; sub_401BC7+55j
		add	[ebp+var_14], 1

loc_401C28:				; CODE XREF: sub_401BC7+45j
					; sub_401BC7+5Bj
		add	[ebp+var_C], 1

loc_401C2C:				; CODE XREF: sub_401BC7+13j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_401BDC
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[esp+28h+var_28], eax ;	size_t
		call	sub_406D00
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		jmp	loc_401D57
; ---------------------------------------------------------------------------

loc_401C58:				; CODE XREF: sub_401BC7+198j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_401D28
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_401D28
		mov	eax, [ebp+var_C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_401D28
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_401CA9
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_401CD5
; ---------------------------------------------------------------------------

loc_401CA9:				; CODE XREF: sub_401BC7+CDj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_401CC4
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_401CD3
; ---------------------------------------------------------------------------

loc_401CC4:				; CODE XREF: sub_401BC7+EAj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_401CD3:				; CODE XREF: sub_401BC7+FBj
		mov	edx, eax

loc_401CD5:				; CODE XREF: sub_401BC7+E0j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_401CF0
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_401D17
; ---------------------------------------------------------------------------

loc_401CF0:				; CODE XREF: sub_401BC7+119j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_401D0B
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_401D17
; ---------------------------------------------------------------------------

loc_401D0B:				; CODE XREF: sub_401BC7+134j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_401D17:				; CODE XREF: sub_401BC7+127j
					; sub_401BC7+142j
		add	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		add	[ebp+var_C], 1
		jmp	short loc_401D53
; ---------------------------------------------------------------------------

loc_401D28:				; CODE XREF: sub_401BC7+99j
					; sub_401BC7+AAj ...
		cmp	[ebp+arg_4], 0
		jz	short loc_401D44
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Bh
		jnz	short loc_401D44
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	20h
		add	[ebp+var_10], 1
		jmp	short loc_401D53
; ---------------------------------------------------------------------------

loc_401D44:				; CODE XREF: sub_401BC7+165j
					; sub_401BC7+16Fj
		mov	eax, [ebp+var_C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1

loc_401D53:				; CODE XREF: sub_401BC7+15Fj
					; sub_401BC7+17Bj
		add	[ebp+var_C], 1

loc_401D57:				; CODE XREF: sub_401BC7+8Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_401C58
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_18]
		leave
		retn
sub_401BC7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401D70(char *Source, char *)
sub_401D70	proc near		; CODE XREF: sub_401E48+35p
					; sub_401E84+72p ...

Str1		= dword	ptr -38h
Str2		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
Source		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, ds:dword_428024
		mov	[ebp+var_C], eax
		jmp	short loc_401DA2
; ---------------------------------------------------------------------------

loc_401D81:				; CODE XREF: sub_401D70+36j
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+Source]
		mov	[esp+38h+Str2],	eax ; Str2
		mov	[esp+38h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_401DAA
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_401DA2:				; CODE XREF: sub_401D70+Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_401D81
		jmp	short loc_401DAB
; ---------------------------------------------------------------------------

loc_401DAA:				; CODE XREF: sub_401D70+28j
		nop

loc_401DAB:				; CODE XREF: sub_401D70+38j
		cmp	[ebp+var_C], 0
		jnz	short loc_401E10
		mov	eax, [ebp+Source]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 0Ch
		mov	[esp+38h+Str1],	eax ; size_t
		call	sub_406D00
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+Source]
		mov	[esp+38h+Str2],	eax ; Source
		mov	[esp+38h+Str1],	edx ; Dest
		call	strcpy
		mov	edx, ds:dword_428024
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	ds:dword_428024, eax

loc_401E10:				; CODE XREF: sub_401D70+3Fj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+38h+Str1],	eax ; void *
		call	sub_406E5D
		cmp	[ebp+arg_4], 0
		jz	short loc_401E31
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str1],	eax ; char *
		call	sub_406E03
		jmp	short loc_401E36
; ---------------------------------------------------------------------------

loc_401E31:				; CODE XREF: sub_401D70+B2j
		mov	eax, 0

loc_401E36:				; CODE XREF: sub_401D70+BFj
		mov	edx, [ebp+var_C]
		mov	[edx+4], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_401D70	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401E48(char *, int)
sub_401E48	proc near		; CODE XREF: sub_4031FB+2FAp
					; sub_405EA8+68Ap ...

Source		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_2B		= byte ptr -2Bh
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], offset byte_4235D8
		mov	[esp+48h+var_44], 23h
		lea	eax, [ebp+var_2B]
		mov	[esp+48h+Source], eax
		call	sub_4096F1
		lea	eax, [ebp+var_2B]
		mov	[esp+48h+var_44], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Source], eax ;	Source
		call	sub_401D70
		leave
		retn
sub_401E48	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401E84(char *VarName)
sub_401E84	proc near		; CODE XREF: sub_402175+A1p
					; sub_40284F+1AFp ...

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
VarName		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+VarName]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_401E9B
		mov	eax, offset byte_4235DB
		jmp	short locret_401F1A
; ---------------------------------------------------------------------------

loc_401E9B:				; CODE XREF: sub_401E84+Ej
		mov	eax, ds:dword_428024
		mov	[ebp+var_C], eax
		jmp	short loc_401EC6
; ---------------------------------------------------------------------------

loc_401EA5:				; CODE XREF: sub_401E84+46j
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+VarName]
		mov	[esp+28h+Str2],	eax ; Str2
		mov	[esp+28h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_401ECE
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_401EC6:				; CODE XREF: sub_401E84+1Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_401EA5
		jmp	short loc_401ECF
; ---------------------------------------------------------------------------

loc_401ECE:				; CODE XREF: sub_401E84+38j
		nop

loc_401ECF:				; CODE XREF: sub_401E84+48j
		cmp	[ebp+var_C], 0
		jnz	short loc_401EFD
		mov	eax, [ebp+VarName]
		mov	[esp+28h+Str1],	eax ; VarName
		call	getenv
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_401EFD
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str2],	eax ; char *
		mov	eax, [ebp+VarName]
		mov	[esp+28h+Str1],	eax ; Source
		call	sub_401D70
		jmp	short locret_401F1A
; ---------------------------------------------------------------------------

loc_401EFD:				; CODE XREF: sub_401E84+4Fj
					; sub_401E84+63j
		cmp	[ebp+var_C], 0
		jz	short loc_401F0D
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_401F14

loc_401F0D:				; CODE XREF: sub_401E84+7Dj
		mov	eax, 0
		jmp	short locret_401F1A
; ---------------------------------------------------------------------------

loc_401F14:				; CODE XREF: sub_401E84+87j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]

locret_401F1A:				; CODE XREF: sub_401E84+15j
					; sub_401E84+77j ...
		leave
		retn
sub_401E84	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401F1C(char, char *)
sub_401F1C	proc near		; CODE XREF: sub_402175+684p

Str		= dword	ptr -48h
EndPtr		= dword	ptr -44h
Radix		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_33		= byte ptr -33h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		jmp	short loc_401F28
; ---------------------------------------------------------------------------

loc_401F24:				; CODE XREF: sub_401F1C+14j
					; sub_401F1C+1Ej
		add	[ebp+arg_4], 1

loc_401F28:				; CODE XREF: sub_401F1C+6j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_401F24
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_401F24
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_401F50
		mov	eax, 0
		jmp	locret_402173
; ---------------------------------------------------------------------------

loc_401F50:				; CODE XREF: sub_401F1C+28j
		mov	[esp+48h+Radix], 0 ; Radix
		mov	[esp+48h+EndPtr], 0 ; EndPtr
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str], eax ; Str
		call	strtol
		mov	[ebp+var_C], eax
		jmp	short loc_401F74
; ---------------------------------------------------------------------------

loc_401F70:				; CODE XREF: sub_401F1C+74j
		add	[ebp+arg_4], 1

loc_401F74:				; CODE XREF: sub_401F1C+52j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_401F92
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_401F92
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_401F70

loc_401F92:				; CODE XREF: sub_401F1C+60j
					; sub_401F1C+6Aj
		cmp	dword ptr [ebp+arg_0], 21h
		jnz	loc_402134
		cmp	[ebp+var_C], 0
		setz	al
		movzx	eax, al
		mov	[ebp+var_C], eax
		jmp	loc_402134
; ---------------------------------------------------------------------------

loc_401FAE:				; CODE XREF: sub_401F1C+A1j
					; sub_401F1C+ABj
		add	[ebp+arg_4], 1
		jmp	short loc_401FB5
; ---------------------------------------------------------------------------

loc_401FB4:				; CODE XREF: sub_401F1C+221j
		nop

loc_401FB5:				; CODE XREF: sub_401F1C+96j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_401FAE
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_401FAE
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_402145
		mov	[esp+48h+Radix], 0 ; Radix
		mov	[esp+48h+EndPtr], 0 ; EndPtr
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str], eax ; Str
		call	strtol
		mov	[ebp+var_10], eax
		jmp	short loc_401FFB
; ---------------------------------------------------------------------------

loc_401FF7:				; CODE XREF: sub_401F1C+FBj
		add	[ebp+arg_4], 1

loc_401FFB:				; CODE XREF: sub_401F1C+D9j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_402019
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_402019
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_401FF7

loc_402019:				; CODE XREF: sub_401F1C+E7j
					; sub_401F1C+F1j
		mov	eax, dword ptr [ebp+arg_0]
		cmp	eax, 2Ah
		jz	short loc_40207F
		cmp	eax, 2Ah
		jg	short loc_402046
		cmp	eax, 25h
		jz	loc_4020B1
		cmp	eax, 26h
		jz	loc_4020FD
		cmp	eax, 21h
		jz	loc_4020D1
		jmp	loc_40211A
; ---------------------------------------------------------------------------

loc_402046:				; CODE XREF: sub_401F1C+108j
		cmp	eax, 2Dh
		jz	short loc_402074
		cmp	eax, 2Dh
		jg	short loc_40205A
		cmp	eax, 2Bh
		jz	short loc_402069
		jmp	loc_40211A
; ---------------------------------------------------------------------------

loc_40205A:				; CODE XREF: sub_401F1C+132j
		cmp	eax, 2Fh
		jz	short loc_40208E
		cmp	eax, 7Ch
		jz	short loc_4020E0
		jmp	loc_40211A
; ---------------------------------------------------------------------------

loc_402069:				; CODE XREF: sub_401F1C+137j
		mov	eax, [ebp+var_10]
		add	[ebp+var_C], eax
		jmp	loc_402135
; ---------------------------------------------------------------------------

loc_402074:				; CODE XREF: sub_401F1C+12Dj
		mov	eax, [ebp+var_10]
		sub	[ebp+var_C], eax
		jmp	loc_402135
; ---------------------------------------------------------------------------

loc_40207F:				; CODE XREF: sub_401F1C+103j
		mov	eax, [ebp+var_C]
		imul	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	loc_402135
; ---------------------------------------------------------------------------

loc_40208E:				; CODE XREF: sub_401F1C+141j
		cmp	[ebp+var_10], 0
		jnz	short loc_40209E
		mov	eax, 0
		jmp	locret_402173
; ---------------------------------------------------------------------------

loc_40209E:				; CODE XREF: sub_401F1C+176j
		mov	eax, [ebp+var_C]
		mov	edx, eax
		sar	edx, 1Fh
		idiv	[ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	loc_402135
; ---------------------------------------------------------------------------

loc_4020B1:				; CODE XREF: sub_401F1C+10Dj
		cmp	[ebp+var_10], 0
		jnz	short loc_4020C1
		mov	eax, 0
		jmp	locret_402173
; ---------------------------------------------------------------------------

loc_4020C1:				; CODE XREF: sub_401F1C+199j
		mov	eax, [ebp+var_C]
		mov	edx, eax
		sar	edx, 1Fh
		idiv	[ebp+var_10]
		mov	[ebp+var_C], edx
		jmp	short loc_402135
; ---------------------------------------------------------------------------

loc_4020D1:				; CODE XREF: sub_401F1C+11Fj
		cmp	[ebp+var_10], 0
		setz	al
		movzx	eax, al
		mov	[ebp+var_C], eax
		jmp	short loc_402135
; ---------------------------------------------------------------------------

loc_4020E0:				; CODE XREF: sub_401F1C+146j
		cmp	[ebp+var_C], 0
		jnz	short loc_4020EC
		cmp	[ebp+var_10], 0
		jz	short loc_4020F3

loc_4020EC:				; CODE XREF: sub_401F1C+1C8j
		mov	eax, 1
		jmp	short loc_4020F8
; ---------------------------------------------------------------------------

loc_4020F3:				; CODE XREF: sub_401F1C+1CEj
		mov	eax, 0

loc_4020F8:				; CODE XREF: sub_401F1C+1D5j
		mov	[ebp+var_C], eax
		jmp	short loc_402135
; ---------------------------------------------------------------------------

loc_4020FD:				; CODE XREF: sub_401F1C+116j
		cmp	[ebp+var_C], 0
		jz	short loc_402110
		cmp	[ebp+var_10], 0
		jz	short loc_402110
		mov	eax, 1
		jmp	short loc_402115
; ---------------------------------------------------------------------------

loc_402110:				; CODE XREF: sub_401F1C+1E5j
					; sub_401F1C+1EBj
		mov	eax, 0

loc_402115:				; CODE XREF: sub_401F1C+1F2j
		mov	[ebp+var_C], eax
		jmp	short loc_402135
; ---------------------------------------------------------------------------

loc_40211A:				; CODE XREF: sub_401F1C+125j
					; sub_401F1C+139j ...
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+48h+EndPtr], eax ;	char
		mov	[esp+48h+Str], offset aUnknownArithme ;	"unknown arithmetic operator `%c'\n"
		call	sub_41A665
		mov	eax, 0
		jmp	short locret_402173
; ---------------------------------------------------------------------------

loc_402134:				; CODE XREF: sub_401F1C+7Aj
					; sub_401F1C+8Dj
		nop

loc_402135:				; CODE XREF: sub_401F1C+153j
					; sub_401F1C+15Ej ...
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_401FB4
		jmp	short loc_402146
; ---------------------------------------------------------------------------

loc_402145:				; CODE XREF: sub_401F1C+B5j
		nop

loc_402146:				; CODE XREF: sub_401F1C+227j
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+Radix], offset	aLd ; "%ld"
		mov	[esp+48h+EndPtr], 23h
		lea	eax, [ebp+var_33]
		mov	[esp+48h+Str], eax
		call	sub_4096F1
		lea	eax, [ebp+var_33]
		mov	[esp+48h+Str], eax ; char *
		call	sub_406E03

locret_402173:				; CODE XREF: sub_401F1C+2Fj
					; sub_401F1C+17Dj ...
		leave
		retn
sub_401F1C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402175(char *VarName)
sub_402175	proc near		; CODE XREF: sub_40284F+16Cp
					; sub_402C1C+113p ...

Str1		= dword	ptr -48h
Str2		= dword	ptr -44h
Radix		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
Str		= dword	ptr -1Ch
VarName		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	[ebp+var_28], 0
		mov	eax, ds:dword_428840
		cmp	eax, 32h
		jle	short loc_4021A5
		mov	[esp+48h+Str1],	offset aVariablesNeste ; "variables nested too deeply\n"
		call	sub_41A665
		mov	eax, 0
		jmp	loc_402847
; ---------------------------------------------------------------------------

loc_4021A5:				; CODE XREF: sub_402175+18j
		mov	eax, ds:dword_428840
		add	eax, 1
		mov	ds:dword_428840, eax
		mov	eax, ds:dword_429060
		test	eax, eax
		jz	short loc_4021C8
		mov	eax, [ebp+VarName]
		mov	[esp+48h+Str1],	eax ; char *
		call	sub_402BCF
		jmp	short loc_4021CD
; ---------------------------------------------------------------------------

loc_4021C8:				; CODE XREF: sub_402175+44j
		mov	eax, 0

loc_4021CD:				; CODE XREF: sub_402175+51j
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jz	short loc_4021DC
		mov	eax, [ebp+var_28]
		mov	[ebp+VarName], eax

loc_4021DC:				; CODE XREF: sub_402175+5Fj
		mov	eax, [ebp+VarName]
		mov	[ebp+Str], eax
		jmp	short loc_4021E8
; ---------------------------------------------------------------------------

loc_4021E4:				; CODE XREF: sub_402175+8Fj
		add	[ebp+Str], 1

loc_4021E8:				; CODE XREF: sub_402175+6Dj
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_402206
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_402206
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_4021E4

loc_402206:				; CODE XREF: sub_402175+7Bj
					; sub_402175+85j
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40223E
		mov	eax, [ebp+VarName]
		mov	[esp+48h+Str1],	eax ; VarName
		call	sub_401E84
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jz	short loc_402231
		mov	eax, [ebp+Str]
		mov	[esp+48h+Str1],	eax ; char *
		call	sub_406E03
		jmp	short loc_402236
; ---------------------------------------------------------------------------

loc_402231:				; CODE XREF: sub_402175+ADj
		mov	eax, 0

loc_402236:				; CODE XREF: sub_402175+BAj
		mov	[ebp+var_20], eax
		jmp	loc_40282C
; ---------------------------------------------------------------------------

loc_40223E:				; CODE XREF: sub_402175+99j
		mov	edx, [ebp+Str]
		mov	eax, [ebp+VarName]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, 3
		jnz	loc_402457
		mov	eax, [ebp+VarName]
		mov	edx, eax
		mov	eax, offset aGet ; "get"
		mov	ecx, 3
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	loc_402457
		jmp	short loc_402285
; ---------------------------------------------------------------------------

loc_402281:				; CODE XREF: sub_402175+118j
					; sub_402175+122j
		add	[ebp+Str], 1

loc_402285:				; CODE XREF: sub_402175+10Aj
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_402281
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_402281
		mov	[esp+48h+Str2],	offset Str2 ; "cwd"
		mov	eax, [ebp+Str]
		mov	[esp+48h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4022E8
		call	sub_401661
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	loc_40282B
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+48h+Str1],	eax ; int
		call	strerror
		mov	[esp+48h+Str2],	eax ; char
		mov	[esp+48h+Str1],	offset aGetcwdFailedS ;	"getcwd	failed:	%s\n"
		call	sub_41A665
		jmp	loc_40282B
; ---------------------------------------------------------------------------

loc_4022E8:				; CODE XREF: sub_402175+139j
		mov	[esp+48h+Str2],	offset aHomedir	; "homedir"
		mov	eax, [ebp+Str]
		mov	[esp+48h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40231C
		mov	eax, ds:dword_429048
		mov	[esp+48h+Str2],	0
		mov	[esp+48h+Str1],	eax
		call	sub_41B167
		mov	[ebp+var_20], eax
		jmp	loc_40282B
; ---------------------------------------------------------------------------

loc_40231C:				; CODE XREF: sub_402175+188j
		mov	[esp+48h+Str2],	offset aSysconfdir ; "sysconfdir"
		mov	eax, [ebp+Str]
		mov	[esp+48h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_402348
		call	sub_409FC4
		mov	[esp+48h+Str1],	eax ; char *
		call	sub_406E03
		mov	[ebp+var_20], eax
		jmp	loc_40282B
; ---------------------------------------------------------------------------

loc_402348:				; CODE XREF: sub_402175+1BCj
		mov	[esp+48h+Str2],	offset aBindir ; "bindir"
		mov	eax, [ebp+Str]
		mov	[esp+48h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_402374
		call	sub_40A067
		mov	[esp+48h+Str1],	eax ; char *
		call	sub_406E03
		mov	[ebp+var_20], eax
		jmp	loc_40282B
; ---------------------------------------------------------------------------

loc_402374:				; CODE XREF: sub_402175+1E8j
		mov	[esp+48h+Str2],	offset aLibdir ; "libdir"
		mov	eax, [ebp+Str]
		mov	[esp+48h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4023A0
		call	sub_40A0C0
		mov	[esp+48h+Str1],	eax ; char *
		call	sub_406E03
		mov	[ebp+var_20], eax
		jmp	loc_40282B
; ---------------------------------------------------------------------------

loc_4023A0:				; CODE XREF: sub_402175+214j
		mov	[esp+48h+Str2],	offset aLibexecdir ; "libexecdir"
		mov	eax, [ebp+Str]
		mov	[esp+48h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4023CC
		call	sub_40A0B3
		mov	[esp+48h+Str1],	eax ; char *
		call	sub_406E03
		mov	[ebp+var_20], eax
		jmp	loc_40282B
; ---------------------------------------------------------------------------

loc_4023CC:				; CODE XREF: sub_402175+240j
		mov	[esp+48h+Str2],	offset aDatadir	; "datadir"
		mov	eax, [ebp+Str]
		mov	[esp+48h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4023F8
		call	sub_40A163
		mov	[esp+48h+Str1],	eax ; char *
		call	sub_406E03
		mov	[ebp+var_20], eax
		jmp	loc_40282B
; ---------------------------------------------------------------------------

loc_4023F8:				; CODE XREF: sub_402175+26Cj
		mov	[esp+48h+Str2],	offset aServerpid ; "serverpid"
		mov	eax, [ebp+Str]
		mov	[esp+48h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40242C
		mov	eax, dwProcessId
		mov	[esp+48h+Str2],	eax
		mov	[esp+48h+Str1],	offset byte_4235D8
		call	sub_40A9F0
		mov	[ebp+var_20], eax
		jmp	loc_40282B
; ---------------------------------------------------------------------------

loc_40242C:				; CODE XREF: sub_402175+298j
		mov	eax, [ebp+Str]
		mov	[esp+48h+Str2],	eax ; char
		mov	[esp+48h+Str1],	offset aInvalidArgumen ; "invalid argument `%s' for variable func"...
		call	sub_41A665
		mov	[esp+48h+Str1],	offset aValidAreCwdHom ; "valid	are: cwd, {home,bin,lib,libexec,d"...
		call	sub_41A63B
		mov	[ebp+var_20], 0
		jmp	loc_40282B
; ---------------------------------------------------------------------------

loc_402457:				; CODE XREF: sub_402175+D8j
					; sub_402175+104j
		mov	edx, [ebp+Str]
		mov	eax, [ebp+VarName]
		mov	esi, edx
		sub	esi, eax
		mov	eax, esi
		cmp	eax, 8
		jnz	short loc_4024A7
		mov	eax, [ebp+VarName]
		mov	edx, eax
		mov	eax, offset aUnescape ;	"unescape"
		mov	ecx, 8
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4024A7
		add	[ebp+Str], 1
		mov	eax, [ebp+Str]
		mov	[esp+48h+Str1],	eax
		call	sub_4016C2
		mov	[ebp+var_20], eax
		jmp	loc_40282C
; ---------------------------------------------------------------------------

loc_4024A7:				; CODE XREF: sub_402175+2F1j
					; sub_402175+319j
		mov	edx, [ebp+Str]
		mov	eax, [ebp+VarName]
		mov	esi, edx
		sub	esi, eax
		mov	eax, esi
		cmp	eax, 9
		jnz	short loc_4024FF
		mov	eax, [ebp+VarName]
		mov	edx, eax
		mov	eax, offset aUnpercent ; "unpercent"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4024FF
		add	[ebp+Str], 1
		mov	[esp+48h+Str2],	0
		mov	eax, [ebp+Str]
		mov	[esp+48h+Str1],	eax
		call	sub_401BC7
		mov	[ebp+var_20], eax
		jmp	loc_40282C
; ---------------------------------------------------------------------------

loc_4024FF:				; CODE XREF: sub_402175+341j
					; sub_402175+369j
		mov	edx, [ebp+Str]
		mov	eax, [ebp+VarName]
		mov	esi, edx
		sub	esi, eax
		mov	eax, esi
		cmp	eax, 0Ah
		jnz	short loc_402557
		mov	eax, [ebp+VarName]
		mov	edx, eax
		mov	eax, offset aUnpercent_0 ; "unpercent+"
		mov	ecx, 0Ah
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_402557
		add	[ebp+Str], 1
		mov	[esp+48h+Str2],	1
		mov	eax, [ebp+Str]
		mov	[esp+48h+Str1],	eax
		call	sub_401BC7
		mov	[ebp+var_20], eax
		jmp	loc_40282C
; ---------------------------------------------------------------------------

loc_402557:				; CODE XREF: sub_402175+399j
					; sub_402175+3C1j
		mov	edx, [ebp+Str]
		mov	eax, [ebp+VarName]
		mov	esi, edx
		sub	esi, eax
		mov	eax, esi
		cmp	eax, 7
		jnz	short loc_4025AF
		mov	eax, [ebp+VarName]
		mov	edx, eax
		mov	eax, offset aPercent ; "percent"
		mov	ecx, 7
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4025AF
		add	[ebp+Str], 1
		mov	[esp+48h+Str2],	offset byte_423705 ; char *
		mov	eax, [ebp+Str]
		mov	[esp+48h+Str1],	eax ; int
		call	sub_41C08E
		mov	[ebp+var_20], eax
		jmp	loc_40282C
; ---------------------------------------------------------------------------

loc_4025AF:				; CODE XREF: sub_402175+3F1j
					; sub_402175+419j
		mov	edx, [ebp+Str]
		mov	eax, [ebp+VarName]
		mov	esi, edx
		sub	esi, eax
		mov	eax, esi
		cmp	eax, 8
		jnz	short loc_40262D
		mov	eax, [ebp+VarName]
		mov	edx, eax
		mov	eax, offset aPercent_0 ; "percent+"
		mov	ecx, 8
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40262D
		add	[ebp+Str], 1
		mov	[esp+48h+Str2],	offset byte_423705 ; char *
		mov	eax, [ebp+Str]
		mov	[esp+48h+Str1],	eax ; int
		call	sub_41C08E
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax
		jmp	short loc_40261E
; ---------------------------------------------------------------------------

loc_40260A:				; CODE XREF: sub_402175+4B1j
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_40261A
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	2Bh

loc_40261A:				; CODE XREF: sub_402175+49Dj
		add	[ebp+var_24], 1

loc_40261E:				; CODE XREF: sub_402175+493j
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40260A
		jmp	loc_40282C
; ---------------------------------------------------------------------------

loc_40262D:				; CODE XREF: sub_402175+449j
					; sub_402175+471j
		mov	edx, [ebp+Str]
		mov	eax, [ebp+VarName]
		mov	esi, edx
		sub	esi, eax
		mov	eax, esi
		cmp	eax, 7
		jnz	short loc_4026AB
		mov	eax, [ebp+VarName]
		mov	edx, eax
		mov	eax, offset aErrcode ; "errcode"
		mov	ecx, 7
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4026AB
		add	[ebp+Str], 1
		mov	[esp+48h+Radix], 0 ; Radix
		mov	[esp+48h+Str2],	0 ; EndPtr
		mov	eax, [ebp+Str]
		mov	[esp+48h+Str1],	eax ; Str
		call	strtol
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+48h+Str1],	eax
		call	sub_401592
		mov	[esp+48h+Str2],	eax
		mov	[esp+48h+Str1],	offset byte_4235D8
		call	sub_40A9F0
		mov	[ebp+var_20], eax
		jmp	loc_40282C
; ---------------------------------------------------------------------------

loc_4026AB:				; CODE XREF: sub_402175+4C7j
					; sub_402175+4EFj
		mov	edx, [ebp+Str]
		mov	eax, [ebp+VarName]
		mov	esi, edx
		sub	esi, eax
		mov	eax, esi
		cmp	eax, 9
		jnz	short loc_402729
		mov	eax, [ebp+VarName]
		mov	edx, eax
		mov	eax, offset aErrsource ; "errsource"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_402729
		add	[ebp+Str], 1
		mov	[esp+48h+Radix], 0 ; Radix
		mov	[esp+48h+Str2],	0 ; EndPtr
		mov	eax, [ebp+Str]
		mov	[esp+48h+Str1],	eax ; Str
		call	strtol
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+48h+Str1],	eax
		call	sub_40159F
		mov	[esp+48h+Str2],	eax
		mov	[esp+48h+Str1],	offset byte_4235D8
		call	sub_40A9F0
		mov	[ebp+var_20], eax
		jmp	loc_40282C
; ---------------------------------------------------------------------------

loc_402729:				; CODE XREF: sub_402175+545j
					; sub_402175+56Dj
		mov	edx, [ebp+Str]
		mov	eax, [ebp+VarName]
		mov	esi, edx
		sub	esi, eax
		mov	eax, esi
		cmp	eax, 9
		jnz	short loc_4027B5
		mov	eax, [ebp+VarName]
		mov	edx, eax
		mov	eax, offset aErrstring ; "errstring"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4027B5
		add	[ebp+Str], 1
		mov	[esp+48h+Radix], 0 ; Radix
		mov	[esp+48h+Str2],	0 ; EndPtr
		mov	eax, [ebp+Str]
		mov	[esp+48h+Str1],	eax ; Str
		call	strtol
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+48h+Str1],	eax
		call	gpg_strsource
		mov	ebx, eax
		mov	eax, [ebp+var_2C]
		mov	[esp+48h+Str1],	eax
		call	gpg_strerror
		mov	[esp+48h+Radix], ebx
		mov	[esp+48h+Str2],	eax
		mov	[esp+48h+Str1],	offset aSS ; "%s <%s>"
		call	sub_40A9F0
		mov	[ebp+var_20], eax
		jmp	short loc_40282C
; ---------------------------------------------------------------------------

loc_4027B5:				; CODE XREF: sub_402175+5C3j
					; sub_402175+5EBj
		mov	edx, [ebp+Str]
		mov	eax, [ebp+VarName]
		mov	esi, edx
		sub	esi, eax
		mov	eax, esi
		cmp	eax, 1
		jnz	short loc_402803
		mov	eax, [ebp+VarName]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+48h+Str2],	eax ; Val
		mov	[esp+48h+Str1],	offset Str ; "+-*/%!|&"
		call	strchr
		test	eax, eax
		jz	short loc_402803
		mov	eax, [ebp+Str]
		lea	edx, [eax+1]
		mov	eax, [ebp+VarName]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+48h+Str2],	edx ; char *
		mov	[esp+48h+Str1],	eax ; char
		call	sub_401F1C
		mov	[ebp+var_20], eax
		jmp	short loc_40282C
; ---------------------------------------------------------------------------

loc_402803:				; CODE XREF: sub_402175+64Fj
					; sub_402175+66Cj
		mov	edx, [ebp+Str]
		mov	eax, [ebp+VarName]
		sub	edx, eax
		mov	eax, [ebp+VarName]
		mov	[esp+48h+Radix], eax
		mov	[esp+48h+Str2],	edx ; char
		mov	[esp+48h+Str1],	offset aUnknownVariabl ; "unknown variable function `%.*s'\n"
		call	sub_41A665
		mov	[ebp+var_20], 0
		jmp	short loc_40282C
; ---------------------------------------------------------------------------

loc_40282B:				; CODE XREF: sub_402175+147j
					; sub_402175+16Ej ...
		nop

loc_40282C:				; CODE XREF: sub_402175+C4j
					; sub_402175+32Dj ...
		mov	eax, [ebp+var_28]
		mov	[esp+48h+Str1],	eax ; void *
		call	sub_406E5D
		mov	eax, ds:dword_428840
		sub	eax, 1
		mov	ds:dword_428840, eax
		mov	eax, [ebp+var_20]

loc_402847:				; CODE XREF: sub_402175+2Bj
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_402175	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40284F	proc near		; CODE XREF: sub_402BCF+27p
					; sub_40377D+1069p ...

Str		= dword	ptr -68h
Val		= dword	ptr -64h
Size		= dword	ptr -60h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
Dst		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
Src		= dword	ptr -14h
Source		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 64h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		jmp	loc_402BB8
; ---------------------------------------------------------------------------

loc_40286F:				; CODE XREF: sub_40284F+371j
		mov	[esp+68h+Val], 24h ; Val
		mov	eax, [ebp+var_C]
		mov	[esp+68h+Str], eax ; Str
		call	strchr
		mov	[ebp+Dst], eax
		cmp	[ebp+Dst], 0
		jnz	short loc_402893
		mov	eax, [ebp+var_18]
		jmp	loc_402BC9
; ---------------------------------------------------------------------------

loc_402893:				; CODE XREF: sub_40284F+3Aj
		mov	eax, [ebp+Dst]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	short loc_4028EC
		mov	eax, [ebp+Dst]
		add	eax, 1
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		lea	edx, [eax+1]
		mov	eax, [ebp+Dst]
		add	eax, 1
		mov	[esp+68h+Size],	edx ; Size
		mov	[esp+68h+Val], eax ; Src
		mov	eax, [ebp+Dst]
		mov	[esp+68h+Str], eax ; Dst
		call	memmove
		mov	eax, [ebp+Dst]
		add	eax, 1
		mov	[ebp+var_C], eax
		jmp	loc_402BB8
; ---------------------------------------------------------------------------

loc_4028EC:				; CODE XREF: sub_40284F+4Fj
		mov	eax, [ebp+Dst]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 7Bh
		jnz	short loc_402952
		mov	[ebp+var_20], 0
		mov	eax, [ebp+Dst]
		add	eax, 2
		mov	[ebp+Source], eax
		jmp	short loc_402933
; ---------------------------------------------------------------------------

loc_40290B:				; CODE XREF: sub_40284F+ECj
		mov	eax, [ebp+Source]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Bh
		jnz	short loc_40291B
		add	[ebp+var_20], 1
		jmp	short loc_40292F
; ---------------------------------------------------------------------------

loc_40291B:				; CODE XREF: sub_40284F+C4j
		mov	eax, [ebp+Source]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Dh
		jnz	short loc_40292F
		sub	[ebp+var_20], 1
		cmp	[ebp+var_20], 0
		js	short loc_40293F

loc_40292F:				; CODE XREF: sub_40284F+CAj
					; sub_40284F+D4j
		add	[ebp+Source], 1

loc_402933:				; CODE XREF: sub_40284F+BAj
		mov	eax, [ebp+Source]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40290B
		jmp	short loc_402940
; ---------------------------------------------------------------------------

loc_40293F:				; CODE XREF: sub_40284F+DEj
		nop

loc_402940:				; CODE XREF: sub_40284F+EEj
		mov	eax, [ebp+Source]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_402989
		mov	eax, [ebp+var_18]
		jmp	loc_402BC9
; ---------------------------------------------------------------------------

loc_402952:				; CODE XREF: sub_40284F+A8j
		mov	eax, [ebp+Dst]
		add	eax, 1
		mov	[ebp+Source], eax
		jmp	short loc_402961
; ---------------------------------------------------------------------------

loc_40295D:				; CODE XREF: sub_40284F+138j
		add	[ebp+Source], 1

loc_402961:				; CODE XREF: sub_40284F+10Cj
		mov	eax, [ebp+Source]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_402989
		mov	eax, [ebp+Source]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_402989
		mov	eax, [ebp+Source]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_402989
		mov	eax, [ebp+Source]
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	short loc_40295D

loc_402989:				; CODE XREF: sub_40284F+F9j
					; sub_40284F+11Aj ...
		mov	eax, [ebp+Dst]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 7Bh
		jnz	short loc_4029D9
		mov	eax, [ebp+Source]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Dh
		jnz	short loc_4029D9
		mov	eax, [ebp+Source]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[ebp+var_28], eax
		mov	eax, [ebp+Source]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+Dst]
		add	eax, 2
		mov	[esp+68h+Str], eax ; VarName
		call	sub_402175
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+Src], eax
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+Source]
		mov	[eax], dl
		add	[ebp+Source], 1
		jmp	short loc_402A23
; ---------------------------------------------------------------------------

loc_4029D9:				; CODE XREF: sub_40284F+145j
					; sub_40284F+14Fj
		mov	eax, [ebp+Source]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_402A12
		mov	eax, [ebp+Source]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+Source]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+Dst]
		add	eax, 1
		mov	[esp+68h+Str], eax ; VarName
		call	sub_401E84
		mov	[ebp+Src], eax
		mov	eax, [ebp+var_2C]
		mov	edx, eax
		mov	eax, [ebp+Source]
		mov	[eax], dl
		jmp	short loc_402A23
; ---------------------------------------------------------------------------

loc_402A12:				; CODE XREF: sub_40284F+192j
		mov	eax, [ebp+Dst]
		add	eax, 1
		mov	[esp+68h+Str], eax ; VarName
		call	sub_401E84
		mov	[ebp+Src], eax

loc_402A23:				; CODE XREF: sub_40284F+188j
					; sub_40284F+1C1j
		cmp	[ebp+Src], 0
		jnz	short loc_402A30
		mov	[ebp+Src], offset byte_4235DB

loc_402A30:				; CODE XREF: sub_40284F+1D8j
		mov	eax, [ebp+Src]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_30], eax
		mov	edx, [ebp+Source]
		mov	eax, [ebp+Dst]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+var_30]
		jb	loc_402AE8
		mov	edx, [ebp+Src]
		mov	eax, [ebp+Dst]
		mov	ecx, [ebp+var_30]
		mov	[esp+68h+Size],	ecx ; Size
		mov	[esp+68h+Val], edx ; Src
		mov	[esp+68h+Str], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_30]
		add	[ebp+Dst], eax
		mov	edx, [ebp+Source]
		mov	eax, [ebp+Dst]
		mov	edi, edx
		sub	edi, eax
		mov	eax, edi
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jz	short loc_402ADD
		mov	eax, [ebp+var_34]
		mov	edx, [ebp+Dst]
		add	eax, edx
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		lea	edx, [eax+1]
		mov	eax, [ebp+var_34]
		mov	ecx, [ebp+Dst]
		add	eax, ecx
		mov	[esp+68h+Size],	edx ; Size
		mov	[esp+68h+Val], eax ; Src
		mov	eax, [ebp+Dst]
		mov	[esp+68h+Str], eax ; Dst
		call	memmove

loc_402ADD:				; CODE XREF: sub_40284F+24Aj
		mov	eax, [ebp+Dst]
		mov	[ebp+var_C], eax
		jmp	loc_402BA6
; ---------------------------------------------------------------------------

loc_402AE8:				; CODE XREF: sub_40284F+212j
		cmp	[ebp+var_18], 0
		jz	short loc_402AF3
		mov	eax, [ebp+var_18]
		jmp	short loc_402AF6
; ---------------------------------------------------------------------------

loc_402AF3:				; CODE XREF: sub_40284F+29Dj
		mov	eax, [ebp+arg_0]

loc_402AF6:				; CODE XREF: sub_40284F+2A2j
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_38]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_30]
		add	eax, 1
		mov	[esp+68h+Str], eax ; size_t
		call	sub_406D00
		mov	[ebp+var_3C], eax
		mov	edx, [ebp+Dst]
		mov	eax, [ebp+var_38]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_34], eax
		mov	edx, [ebp+var_38]
		mov	eax, [ebp+var_3C]
		mov	ecx, [ebp+var_34]
		mov	[esp+68h+Size],	ecx ; Size
		mov	[esp+68h+Val], edx ; Src
		mov	[esp+68h+Str], eax ; Dst
		call	memcpy
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_3C]
		add	eax, [ebp+var_34]
		mov	ecx, [ebp+var_30]
		mov	[esp+68h+Size],	ecx ; Size
		mov	[esp+68h+Val], edx ; Src
		mov	[esp+68h+Str], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_30]
		add	[ebp+var_34], eax
		mov	eax, [ebp+Source]
		mov	edx, [ebp+var_34]
		mov	ecx, [ebp+var_3C]
		add	edx, ecx
		mov	[esp+68h+Val], eax ; Source
		mov	[esp+68h+Str], edx ; Dest
		call	strcpy
		mov	eax, [ebp+var_34]
		mov	edx, [ebp+var_3C]
		add	eax, edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Str], eax ; void *
		call	sub_406E5D
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_18], eax

loc_402BA6:				; CODE XREF: sub_40284F+294j
		mov	eax, [ebp+var_1C]
		mov	[esp+68h+Str], eax ; void *
		call	sub_406E5D
		mov	[ebp+var_1C], 0

loc_402BB8:				; CODE XREF: sub_40284F+1Bj
					; sub_40284F+98j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_40286F
		mov	eax, [ebp+var_18]

loc_402BC9:				; CODE XREF: sub_40284F+3Fj
					; sub_40284F+FEj
		add	esp, 64h
		pop	edi
		pop	ebp
		retn
sub_40284F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402BCF(char *)
sub_402BCF	proc near		; CODE XREF: sub_402175+4Cp
					; sub_402C1C+A3p ...

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_402BE0
		mov	eax, [ebp+arg_0]
		jmp	short loc_402BE5
; ---------------------------------------------------------------------------

loc_402BE0:				; CODE XREF: sub_402BCF+Aj
		mov	eax, offset byte_4235DB

loc_402BE5:				; CODE XREF: sub_402BCF+Fj
		mov	[esp+28h+var_28], eax ;	char *
		call	sub_406E03
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_40284F
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_402C0C
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	short loc_402C17
; ---------------------------------------------------------------------------

loc_402C0C:				; CODE XREF: sub_402BCF+33j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_406E5D

loc_402C17:				; CODE XREF: sub_402BCF+3Bj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_402BCF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402C1C	proc near		; CODE XREF: sub_40377D+FD1p
					; sub_40377D+1008p

Dest		= dword	ptr -48h
Source		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
VarName		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	short loc_402C35
; ---------------------------------------------------------------------------

loc_402C31:				; CODE XREF: sub_402C1C+35j
		add	[ebp+var_C], 1

loc_402C35:				; CODE XREF: sub_402C1C+13j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_402C53
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_402C53
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_402C31

loc_402C53:				; CODE XREF: sub_402C1C+21j
					; sub_402C1C+2Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_402C6F
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1
		jmp	short loc_402C6F
; ---------------------------------------------------------------------------

loc_402C69:				; CODE XREF: sub_402C1C+5Cj
					; sub_402C1C+66j
		add	[ebp+var_C], 1
		jmp	short loc_402C70
; ---------------------------------------------------------------------------

loc_402C6F:				; CODE XREF: sub_402C1C+3Fj
					; sub_402C1C+4Bj
		nop

loc_402C70:				; CODE XREF: sub_402C1C+51j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_402C69
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_402C69
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_402CA6
		mov	[esp+48h+Source], 0 ; char *
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Dest],	eax ; Source
		call	sub_401D70
		jmp	loc_402DC1
; ---------------------------------------------------------------------------

loc_402CA6:				; CODE XREF: sub_402C1C+70j
		cmp	[ebp+arg_4], 0
		jz	loc_402D6C
		mov	eax, ds:dword_429060
		test	eax, eax
		jz	short loc_402CC6
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Dest],	eax ; char *
		call	sub_402BCF
		jmp	short loc_402CCB
; ---------------------------------------------------------------------------

loc_402CC6:				; CODE XREF: sub_402C1C+9Bj
		mov	eax, 0

loc_402CCB:				; CODE XREF: sub_402C1C+A8j
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_402CDA
		mov	eax, [ebp+var_14]
		mov	[ebp+var_C], eax

loc_402CDA:				; CODE XREF: sub_402C1C+B6j
		mov	eax, [ebp+var_C]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 5
		mov	[esp+48h+Dest],	eax ; size_t
		call	sub_406D00
		mov	[ebp+VarName], eax
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+VarName]
		mov	dword ptr [eax], 20746567h
		mov	byte ptr [eax+4], 0
		mov	eax, [ebp+VarName]
		add	eax, 4
		mov	[esp+48h+Source], edx ;	Source
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+VarName]
		mov	[esp+48h+Dest],	eax ; VarName
		call	sub_402175
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+VarName]
		mov	[esp+48h+Dest],	eax ; void *
		call	sub_406E5D
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Source], eax ;	char *
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Dest],	eax ; Source
		call	sub_401D70
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Dest],	eax ; void *
		call	sub_406E5D
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Dest],	eax ; void *
		call	sub_406E5D
		jmp	short loc_402DC1
; ---------------------------------------------------------------------------

loc_402D6C:				; CODE XREF: sub_402C1C+8Ej
		mov	eax, ds:dword_429060
		test	eax, eax
		jz	short loc_402D82
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Dest],	eax ; char *
		call	sub_402BCF
		jmp	short loc_402D87
; ---------------------------------------------------------------------------

loc_402D82:				; CODE XREF: sub_402C1C+157j
		mov	eax, 0

loc_402D87:				; CODE XREF: sub_402C1C+164j
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_402DAF
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Source], eax ;	char *
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Dest],	eax ; Source
		call	sub_401D70
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Dest],	eax ; void *
		call	sub_406E5D
		jmp	short loc_402DC1
; ---------------------------------------------------------------------------

loc_402DAF:				; CODE XREF: sub_402C1C+172j
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Source], eax ;	char *
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Dest],	eax ; Source
		call	sub_401D70

loc_402DC1:				; CODE XREF: sub_402C1C+85j
					; sub_402C1C+14Ej ...
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_402C1C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402DC7	proc near		; CODE XREF: sub_40377D+102Dp

Format		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_428024
		mov	[ebp+var_C], eax
		jmp	short loc_402E0A
; ---------------------------------------------------------------------------

loc_402DD7:				; CODE XREF: sub_402DC7+47j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_402E02
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_C]
		lea	ecx, [eax+8]
		mov	eax, offset Format ; "%-20s %s\n"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], ecx
		mov	[esp+28h+Format], eax ;	Format
		call	printf

loc_402E02:				; CODE XREF: sub_402DC7+18j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_402E0A:				; CODE XREF: sub_402DC7+Ej
		cmp	[ebp+var_C], 0
		jnz	short loc_402DD7
		leave
		retn
sub_402DC7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402E12	proc near		; CODE XREF: sub_40377D+10A0p
					; sub_40377D+10D3p ...

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
Str1		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+Str1], eax
		mov	eax, [ebp+Str1]
		mov	[ebp+var_C], eax
		jmp	short loc_402E2B
; ---------------------------------------------------------------------------

loc_402E27:				; CODE XREF: sub_402E12+35j
		add	[ebp+var_C], 1

loc_402E2B:				; CODE XREF: sub_402E12+13j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_402E49
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_402E49
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_402E27

loc_402E49:				; CODE XREF: sub_402E12+21j
					; sub_402E12+2Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_402E65
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1
		jmp	short loc_402E65
; ---------------------------------------------------------------------------

loc_402E5F:				; CODE XREF: sub_402E12+5Cj
					; sub_402E12+66j
		add	[ebp+var_C], 1
		jmp	short loc_402E66
; ---------------------------------------------------------------------------

loc_402E65:				; CODE XREF: sub_402E12+3Fj
					; sub_402E12+4Bj
		nop

loc_402E66:				; CODE XREF: sub_402E12+51j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_402E5F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_402E5F
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 14h
		mov	[esp+38h+Dest],	eax ; size_t
		call	sub_406D00
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, 10h
		mov	[esp+38h+Source], eax ;	Source
		mov	[esp+38h+Dest],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_4]
		mov	[eax+8], edx
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	[eax+0Ch], edx
		mov	[esp+38h+Source], offset asc_423770 ; "*"
		mov	eax, [ebp+Str1]
		mov	[esp+38h+Dest],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_402EF1
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+4], 0
		jmp	short loc_402F04
; ---------------------------------------------------------------------------

loc_402EF1:				; CODE XREF: sub_402E12+D1j
		mov	eax, [ebp+Str1]
		mov	[esp+38h+Dest],	eax ; char *
		call	sub_406E03
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax+4], edx

loc_402F04:				; CODE XREF: sub_402E12+DDj
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax], 0
		mov	eax, off_4220D0
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		mov	off_4220D0, eax
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_402E12	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402F25	proc near		; CODE XREF: sub_40377D+138Dp

Format		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, ds:dword_428020
		mov	[ebp+var_C], eax
		jmp	short loc_402F94
; ---------------------------------------------------------------------------

loc_402F36:				; CODE XREF: sub_402F25+73j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_402F8C
		mov	eax, [ebp+var_C]
		lea	ebx, [eax+10h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_402F68
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_402F61
		mov	eax, 70h
		jmp	short loc_402F66
; ---------------------------------------------------------------------------

loc_402F61:				; CODE XREF: sub_402F25+33j
		mov	eax, 66h

loc_402F66:				; CODE XREF: sub_402F25+3Aj
		jmp	short loc_402F6D
; ---------------------------------------------------------------------------

loc_402F68:				; CODE XREF: sub_402F25+29j
		mov	eax, 76h

loc_402F6D:				; CODE XREF: sub_402F25:loc_402F66j
		mov	edx, [ebp+var_C]
		mov	ecx, [edx+4]
		mov	edx, offset a20sCS ; "%-20s %c %s\n"
		mov	[esp+28h+var_1C], ebx
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+var_24], ecx
		mov	[esp+28h+Format], edx ;	Format
		call	printf

loc_402F8C:				; CODE XREF: sub_402F25+19j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_402F94:				; CODE XREF: sub_402F25+Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_402F36
		mov	eax, ds:dword_428020
		mov	[ebp+var_C], eax
		jmp	short loc_403000
; ---------------------------------------------------------------------------

loc_402FA4:				; CODE XREF: sub_402F25+DFj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_402FF8
		mov	eax, [ebp+var_C]
		lea	ecx, [eax+10h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_402FD6
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_402FCF
		mov	eax, 70h
		jmp	short loc_402FD4
; ---------------------------------------------------------------------------

loc_402FCF:				; CODE XREF: sub_402F25+A1j
		mov	eax, 66h

loc_402FD4:				; CODE XREF: sub_402F25+A8j
		jmp	short loc_402FDB
; ---------------------------------------------------------------------------

loc_402FD6:				; CODE XREF: sub_402F25+97j
		mov	eax, 76h

loc_402FDB:				; CODE XREF: sub_402F25:loc_402FD4j
		mov	edx, offset a20sCS ; "%-20s %c %s\n"
		mov	[esp+28h+var_1C], ecx
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+var_24], offset asc_423770 ; "*"
		mov	[esp+28h+Format], edx ;	Format
		call	printf

loc_402FF8:				; CODE XREF: sub_402F25+87j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_403000:				; CODE XREF: sub_402F25+7Dj
		cmp	[ebp+var_C], 0
		jnz	short loc_402FA4
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_402F25	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40300C	proc near		; CODE XREF: sub_40377D+13B2p

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		jmp	short loc_403043
; ---------------------------------------------------------------------------

loc_403014:				; CODE XREF: sub_40300C+3Ej
		mov	eax, ds:dword_428020
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_428020
		mov	eax, [eax+4]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_406E5D
		mov	eax, ds:dword_428020
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_406E5D
		mov	eax, [ebp+var_C]
		mov	ds:dword_428020, eax

loc_403043:				; CODE XREF: sub_40300C+6j
		mov	eax, ds:dword_428020
		test	eax, eax
		jnz	short loc_403014
		mov	off_4220D0, offset dword_428020
		leave
		retn
sub_40300C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403058	proc near		; CODE XREF: sub_40377D+149Ep
					; sub_40377D+14CCp

Filename	= dword	ptr -38h
Mode		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
File		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_10], eax
		jmp	short loc_403070
; ---------------------------------------------------------------------------

loc_40306C:				; CODE XREF: sub_403058+34j
		add	[ebp+var_10], 1

loc_403070:				; CODE XREF: sub_403058+12j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40308E
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40308E
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_40306C

loc_40308E:				; CODE XREF: sub_403058+20j
					; sub_403058+2Aj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4030AA
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1
		jmp	short loc_4030AA
; ---------------------------------------------------------------------------

loc_4030A4:				; CODE XREF: sub_403058+5Bj
					; sub_403058+65j
		add	[ebp+var_10], 1
		jmp	short loc_4030AB
; ---------------------------------------------------------------------------

loc_4030AA:				; CODE XREF: sub_403058+3Ej
					; sub_403058+4Aj
		nop

loc_4030AB:				; CODE XREF: sub_403058+50j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4030A4
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_4030A4
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4030D8
		mov	[ebp+var_C], offset Mode ; "r"
		jmp	short loc_403116
; ---------------------------------------------------------------------------

loc_4030D8:				; CODE XREF: sub_403058+75j
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_4030E4
; ---------------------------------------------------------------------------

loc_4030E0:				; CODE XREF: sub_403058+A8j
		add	[ebp+var_10], 1

loc_4030E4:				; CODE XREF: sub_403058+86j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_403102
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_403102
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_4030E0

loc_403102:				; CODE XREF: sub_403058+94j
					; sub_403058+9Ej
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_403116
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1

loc_403116:				; CODE XREF: sub_403058+7Ej
					; sub_403058+B2j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Mode],	edx ; Mode
		mov	[esp+38h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_403165
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+38h+Filename], eax	; int
		call	strerror
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Mode],	eax ; char
		mov	[esp+38h+Filename], offset aCanTOpenSInSMo ; "can't open `%s' in \"%s\" mode: %s\n"
		call	sub_41A665
		jmp	locret_4031E5
; ---------------------------------------------------------------------------

loc_403165:				; CODE XREF: sub_403058+D7j
		mov	eax, [ebp+File]
		mov	[esp+38h+Filename], eax	; File
		call	_fileno
		mov	dword ptr [ebp+var_1C],	eax
		mov	eax, ds:dword_429040
		test	eax, eax
		jz	short loc_40319D
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Mode],	eax ; char
		mov	[esp+38h+Filename], offset aFileSOpenedInS ; "file `%s' opened in \"%s\" mode, fd=%d\"...
		call	sub_41A665

loc_40319D:				; CODE XREF: sub_403058+122j
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+38h+Mode],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Filename], eax
		call	assuan_sendfd
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_4031DA
		mov	eax, [ebp+var_20]
		mov	[esp+38h+Filename], eax
		call	gpg_strerror
		mov	[esp+38h+var_30], eax
		mov	eax, dword ptr [ebp+var_1C]
		mov	[esp+38h+Mode],	eax ; char
		mov	[esp+38h+Filename], offset aSendingDescrip ; "sending descriptor %d failed: %s\n"
		call	sub_41A665

loc_4031DA:				; CODE XREF: sub_403058+15Ej
		mov	eax, [ebp+File]
		mov	[esp+38h+Filename], eax	; File
		call	fclose

locret_4031E5:				; CODE XREF: sub_403058+108j
		leave
		retn
sub_403058	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4031E7	proc near		; CODE XREF: sub_40377D+1536p
					; sub_40377D+1564p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], offset aThisCommandHas ; "This command has not yet been implement"...
		call	sub_41A63B
		leave
		retn
sub_4031E7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4031FB	proc near		; CODE XREF: sub_40377D+15C3p
					; sub_40377D+15E6p

Filename	= dword	ptr -58h
Mode		= dword	ptr -54h
dwProcessId	= dword	ptr -50h
lpTargetHandle	= dword	ptr -4Ch
dwDesiredAccess	= dword	ptr -48h
bInheritHandle	= dword	ptr -44h
dwOptions	= dword	ptr -40h
TargetHandle	= dword	ptr -2Ch
hTargetProcessHandle= dword ptr	-28h
hSourceHandle	= dword	ptr -24h
var_20		= byte ptr -20h
File		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, dwProcessId
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_403228
		mov	[esp+58h+Filename], offset aThePidOfTheSer ; "the pid of the server is unknown\n"
		call	sub_41A665
		mov	[esp+58h+Filename], offset aUseCommandServ ; "use command \"/serverpid\" first\n"
		call	sub_41A63B
		jmp	locret_40351A
; ---------------------------------------------------------------------------

loc_403228:				; CODE XREF: sub_4031FB+Ej
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_10], eax
		jmp	short loc_40323A
; ---------------------------------------------------------------------------

loc_403236:				; CODE XREF: sub_4031FB+5Bj
		add	[ebp+var_10], 1

loc_40323A:				; CODE XREF: sub_4031FB+39j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_403258
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_403258
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_403236

loc_403258:				; CODE XREF: sub_4031FB+47j
					; sub_4031FB+51j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_403274
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1
		jmp	short loc_403274
; ---------------------------------------------------------------------------

loc_40326E:				; CODE XREF: sub_4031FB+82j
					; sub_4031FB+8Cj
		add	[ebp+var_10], 1
		jmp	short loc_403275
; ---------------------------------------------------------------------------

loc_403274:				; CODE XREF: sub_4031FB+65j
					; sub_4031FB+71j
		nop

loc_403275:				; CODE XREF: sub_4031FB+77j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40326E
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_40326E
		mov	eax, [ebp+var_10]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_10], eax
		jmp	short loc_40329B
; ---------------------------------------------------------------------------

loc_403297:				; CODE XREF: sub_4031FB+BCj
		add	[ebp+var_10], 1

loc_40329B:				; CODE XREF: sub_4031FB+9Aj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4032B9
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4032B9
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_403297

loc_4032B9:				; CODE XREF: sub_4031FB+A8j
					; sub_4031FB+B2j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4032D5
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1
		jmp	short loc_4032D5
; ---------------------------------------------------------------------------

loc_4032CF:				; CODE XREF: sub_4031FB+E3j
					; sub_4031FB+EDj
		add	[ebp+var_10], 1
		jmp	short loc_4032D6
; ---------------------------------------------------------------------------

loc_4032D5:				; CODE XREF: sub_4031FB+C6j
					; sub_4031FB+D2j
		nop

loc_4032D6:				; CODE XREF: sub_4031FB+D8j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4032CF
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_4032CF
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_403303
		mov	[ebp+var_C], offset Mode ; "r"
		jmp	short loc_403341
; ---------------------------------------------------------------------------

loc_403303:				; CODE XREF: sub_4031FB+FDj
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_40330F
; ---------------------------------------------------------------------------

loc_40330B:				; CODE XREF: sub_4031FB+130j
		add	[ebp+var_10], 1

loc_40330F:				; CODE XREF: sub_4031FB+10Ej
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40332D
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40332D
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_40330B

loc_40332D:				; CODE XREF: sub_4031FB+11Cj
					; sub_4031FB+126j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_403341
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1

loc_403341:				; CODE XREF: sub_4031FB+106j
					; sub_4031FB+13Aj
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Mode],	edx ; Mode
		mov	[esp+58h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_403390
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+58h+Filename], eax	; int
		call	strerror
		mov	[esp+58h+lpTargetHandle], eax
		mov	eax, [ebp+var_C]
		mov	[esp+58h+dwProcessId], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Mode],	eax ; char
		mov	[esp+58h+Filename], offset aCanTOpenSInSMo ; "can't open `%s' in \"%s\" mode: %s\n"
		call	sub_41A665
		jmp	locret_40351A
; ---------------------------------------------------------------------------

loc_403390:				; CODE XREF: sub_4031FB+15Fj
		mov	eax, [ebp+File]
		mov	[esp+58h+Filename], eax	; File
		call	_fileno
		mov	dword ptr [ebp+var_20],	eax
		cmp	dword ptr [ebp+var_20],	0
		js	loc_4034FC
		mov	eax, dword ptr [ebp+var_20]
		cmp	eax, 0FFh
		ja	loc_4034FC
		mov	eax, dword ptr [ebp+var_20]
		mov	ds:dword_428040[eax*8],	1
		mov	eax, dword ptr [ebp+var_20]
		mov	[esp+58h+Filename], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle
		mov	[ebp+hSourceHandle], eax
		mov	eax, dwProcessId
		mov	[esp+58h+dwProcessId], eax ; dwProcessId
		mov	[esp+58h+Mode],	0 ; char
		mov	[esp+58h+Filename], 40h	; dwDesiredAccess
		mov	eax, ds:OpenProcess
		call	eax ; OpenProcess
		sub	esp, 0Ch
		mov	[ebp+hTargetProcessHandle], eax
		cmp	[ebp+hTargetProcessHandle], 0
		jnz	short loc_40341B
		mov	[esp+58h+Filename], offset aFailedToOpenTh ; "failed to	open the server	process\n"
		call	sub_41A665
		mov	eax, dword ptr [ebp+var_20]
		mov	[esp+58h+Filename], eax
		call	_close
		jmp	locret_40351A
; ---------------------------------------------------------------------------

loc_40341B:				; CODE XREF: sub_4031FB+202j
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp+58h+dwOptions], 2 ; dwOptions
		mov	[esp+58h+bInheritHandle], 1 ; bInheritHandle
		mov	[esp+58h+dwDesiredAccess], 0 ; dwDesiredAccess
		lea	edx, [ebp+TargetHandle]
		mov	[esp+58h+lpTargetHandle], edx ;	lpTargetHandle
		mov	edx, [ebp+hTargetProcessHandle]
		mov	[esp+58h+dwProcessId], edx ; hTargetProcessHandle
		mov	edx, [ebp+hSourceHandle]
		mov	[esp+58h+Mode],	edx ; char
		mov	[esp+58h+Filename], eax	; hSourceProcessHandle
		mov	eax, ds:DuplicateHandle
		call	eax ; DuplicateHandle
		sub	esp, 1Ch
		test	eax, eax
		jnz	short loc_40348C
		mov	[esp+58h+Filename], offset aFailedToDuplic ; "failed to	duplicate the handle\n"
		call	sub_41A665
		mov	eax, dword ptr [ebp+var_20]
		mov	[esp+58h+Filename], eax
		call	_close
		mov	eax, [ebp+hTargetProcessHandle]
		mov	[esp+58h+Filename], eax	; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		jmp	locret_40351A
; ---------------------------------------------------------------------------

loc_40348C:				; CODE XREF: sub_4031FB+263j
		mov	eax, [ebp+hTargetProcessHandle]
		mov	[esp+58h+Filename], eax	; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	edx, [ebp+TargetHandle]
		mov	eax, dword ptr [ebp+var_20]
		mov	ds:hObject[eax*8], edx
		mov	eax, ds:dword_429040
		test	eax, eax
		jz	short loc_4034E1
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, ds:hObject[eax*8]
		mov	edx, dword ptr [ebp+var_20]
		mov	[esp+58h+dwDesiredAccess], edx
		mov	[esp+58h+lpTargetHandle], eax
		mov	eax, [ebp+var_C]
		mov	[esp+58h+dwProcessId], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Mode],	eax ; char
		mov	[esp+58h+Filename], offset aFileSOpenedI_0 ; "file `%s' opened in \"%s\" mode, fd=%d "...
		call	sub_41A63B

loc_4034E1:				; CODE XREF: sub_4031FB+2B5j
		mov	eax, dword ptr [ebp+var_20]
		mov	eax, ds:hObject[eax*8]
		mov	[esp+58h+Mode],	eax ; int
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Filename], eax	; char *
		call	sub_401E48
		jmp	short locret_40351A
; ---------------------------------------------------------------------------

loc_4034FC:				; CODE XREF: sub_4031FB+1A7j
					; sub_4031FB+1B5j
		mov	eax, dword ptr [ebp+var_20]
		mov	[esp+58h+Mode],	eax ; char
		mov	[esp+58h+Filename], offset aCanTPutFdDInto ; "can't put fd %d into table\n"
		call	sub_41A665
		mov	eax, dword ptr [ebp+var_20]
		mov	[esp+58h+Filename], eax
		call	_close

locret_40351A:				; CODE XREF: sub_4031FB+28j
					; sub_4031FB+190j ...
		leave
		retn
sub_4031FB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40351C(char *)
sub_40351C	proc near		; CODE XREF: sub_40377D+1645p
					; sub_40377D+1668p

Str		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	atoi
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_40355C
; ---------------------------------------------------------------------------

loc_403539:				; CODE XREF: sub_40351C+48j
		mov	eax, [ebp+var_C]
		mov	eax, ds:dword_428040[eax*8]
		test	eax, eax
		jz	short loc_403558
		mov	eax, [ebp+var_C]
		mov	edx, ds:hObject[eax*8]
		mov	eax, [ebp+var_10]
		cmp	edx, eax
		jz	short loc_403568

loc_403558:				; CODE XREF: sub_40351C+29j
		add	[ebp+var_C], 1

loc_40355C:				; CODE XREF: sub_40351C+1Bj
		mov	eax, [ebp+var_C]
		cmp	eax, 0FFh
		jbe	short loc_403539
		jmp	short loc_403569
; ---------------------------------------------------------------------------

loc_403568:				; CODE XREF: sub_40351C+3Aj
		nop

loc_403569:				; CODE XREF: sub_40351C+4Aj
		mov	eax, [ebp+var_C]
		cmp	eax, 0FFh
		ja	short loc_403581
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		js	short loc_403599
		jmp	short loc_40358F
; ---------------------------------------------------------------------------

loc_403581:				; CODE XREF: sub_40351C+55j
		mov	[esp+28h+Str], offset aGivenFdSystemH ;	"given fd (system handle) has not been o"...
		call	sub_41A665
		jmp	short locret_4035F3
; ---------------------------------------------------------------------------

loc_40358F:				; CODE XREF: sub_40351C+63j
		mov	eax, [ebp+var_10]
		cmp	eax, 0FFh
		jbe	short loc_4035A7

loc_403599:				; CODE XREF: sub_40351C+61j
		mov	[esp+28h+Str], offset aInvalidFd ; "invalid fd\n"
		call	sub_41A665
		jmp	short locret_4035F3
; ---------------------------------------------------------------------------

loc_4035A7:				; CODE XREF: sub_40351C+7Bj
		mov	eax, [ebp+var_10]
		mov	eax, ds:dword_428040[eax*8]
		test	eax, eax
		jnz	short loc_4035C3
		mov	[esp+28h+Str], offset aGivenFdHasNotB ;	"given fd has not been opened\n"
		call	sub_41A665
		jmp	short locret_4035F3
; ---------------------------------------------------------------------------

loc_4035C3:				; CODE XREF: sub_40351C+97j
		mov	eax, [ebp+var_10]
		mov	eax, ds:hObject[eax*8]
		mov	[esp+28h+Str], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax
		call	_close
		mov	eax, [ebp+var_10]
		mov	ds:dword_428040[eax*8],	0

locret_4035F3:				; CODE XREF: sub_40351C+71j
					; sub_40351C+89j ...
		leave
		retn
sub_40351C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4035F5	proc near		; CODE XREF: sub_40377D+168Dp

Format		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		jmp	short loc_40363A
; ---------------------------------------------------------------------------

loc_403604:				; CODE XREF: sub_4035F5+4Dj
		mov	eax, [ebp+var_C]
		mov	eax, ds:dword_428040[eax*8]
		test	eax, eax
		jz	short loc_403636
		mov	eax, [ebp+var_C]
		mov	eax, ds:hObject[eax*8]
		mov	edx, eax
		mov	eax, offset a15dLibcD ;	"%-15d (libc=%d)\n"
		mov	ecx, [ebp+var_C]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+Format], eax ;	Format
		call	printf

loc_403636:				; CODE XREF: sub_4035F5+1Bj
		add	[ebp+var_C], 1

loc_40363A:				; CODE XREF: sub_4035F5+Dj
		mov	eax, [ebp+var_C]
		cmp	eax, 0FFh
		jbe	short loc_403604
		leave
		retn
sub_4035F5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403646(int, void *, size_t)
sub_403646	proc near		; DATA XREF: sub_403672+40o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax ;	size_t
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	void *
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_40AB20
		mov	eax, 0
		leave
		retn
sub_403646	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403672	proc near		; CODE XREF: sub_40377D+16BCp

Str		= dword	ptr -48h
EndPtr		= dword	ptr -44h
Radix		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[esp+48h+EndPtr], 64h ;	size_t
		lea	eax, [ebp+var_20]
		mov	[esp+48h+Str], eax ; int
		call	sub_40AA80
		mov	[esp+48h+var_2C], 0
		mov	[esp+48h+var_30], 0
		mov	[esp+48h+var_34], 0
		mov	[esp+48h+var_38], 0
		lea	eax, [ebp+var_20]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+Radix], offset	sub_403646
		mov	[esp+48h+EndPtr], offset aGetinfoPid ; "GETINFO	pid"
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		mov	[esp+48h+Radix], 1 ; size_t
		mov	[esp+48h+EndPtr], offset byte_4235DB ; void *
		lea	eax, [ebp+var_20]
		mov	[esp+48h+Str], eax ; int
		call	sub_40AB20
		mov	[esp+48h+EndPtr], 0
		lea	eax, [ebp+var_20]
		mov	[esp+48h+Str], eax
		call	sub_40AC52
		mov	[ebp+var_10], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40370D
		cmp	[ebp+var_10], 0
		jnz	short loc_403732

loc_40370D:				; CODE XREF: sub_403672+93j
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str], eax
		call	gpg_strerror
		mov	[esp+48h+Radix], eax
		mov	[esp+48h+EndPtr], offset aGetinfoPid ; "GETINFO	pid"
		mov	[esp+48h+Str], offset aCommandSFailed ;	"command \"%s\"	failed:	%s\n"
		call	sub_41A665
		jmp	short loc_403770
; ---------------------------------------------------------------------------

loc_403732:				; CODE XREF: sub_403672+99j
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Radix], 0Ah ; Radix
		mov	[esp+48h+EndPtr], 0 ; EndPtr
		mov	[esp+48h+Str], eax ; Str
		call	strtoul
		mov	dwProcessId, eax
		mov	eax, ds:dword_429040
		test	eax, eax
		jz	short loc_403770
		mov	eax, dwProcessId
		mov	[esp+48h+EndPtr], eax ;	char
		mov	[esp+48h+Str], offset aServerSPidIsLu ;	"server's PID is %lu\n"
		call	sub_41A63B

loc_403770:				; CODE XREF: sub_403672+BEj
					; sub_403672+E7j
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str], eax ; void *
		call	sub_406E5D
		leave
		retn
sub_403672	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40377D	proc near		; CODE XREF: sub_401180+265p

Code		= dword	ptr -31Ch
Mode		= dword	ptr -318h
MaxCount	= dword	ptr -314h
var_310		= dword	ptr -310h
var_30C		= dword	ptr -30Ch
var_308		= dword	ptr -308h
var_304		= dword	ptr -304h
var_2F0		= dword	ptr -2F0h
var_2E4		= dword	ptr -2E4h
var_2E0		= dword	ptr -2E0h
var_2DC		= dword	ptr -2DCh
var_2D8		= dword	ptr -2D8h
var_2D4		= byte ptr -2D4h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
Buf		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_7C		= dword	ptr -7Ch
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
Str		= dword	ptr -48h
Str1		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
File		= dword	ptr -1Ch
Filename	= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		and	esp, 0FFFFFFF0h
		sub	esp, 310h
		call	sub_420790
		mov	[esp+31Ch+var_38], 0
		mov	[esp+31Ch+Filename], 0
		mov	[esp+31Ch+File], 0
		mov	[esp+31Ch+var_28], 0
		call	sub_406E90
		mov	[esp+31Ch+Code], offset	sub_4015CF
		call	sub_41E4C6
		mov	[esp+31Ch+Mode], 1 ; int
		mov	[esp+31Ch+Code], offset	aGpgConnectAg_0	; "gpg-connect-agent"
		call	sub_41A0FC
		call	sub_40ACF4
		call	sub_40AD6C
		mov	[esp+31Ch+Code], 0
		call	assuan_set_gpg_err_source
		call	sub_409C1D
		mov	ds:dword_429048, eax
		mov	ds:dword_42905C, 1
		lea	eax, [ebp+arg_0]
		mov	[esp+31Ch+var_94], eax
		lea	eax, [ebp+arg_4]
		mov	[esp+31Ch+var_90], eax
		mov	[esp+31Ch+var_8C], 1
		jmp	loc_403962
; ---------------------------------------------------------------------------

loc_403830:				; CODE XREF: sub_40377D+220j
		mov	eax, [esp+31Ch+var_84]
		cmp	eax, 76h
		jz	loc_4038C0
		cmp	eax, 76h
		jg	short loc_40387D
		cmp	eax, 71h
		jz	short loc_4038B1
		cmp	eax, 71h
		jg	short loc_403866
		cmp	eax, 45h
		jz	loc_403915
		cmp	eax, 53h
		jz	loc_403907
		jmp	loc_403956
; ---------------------------------------------------------------------------

loc_403866:				; CODE XREF: sub_40377D+D0j
		cmp	eax, 72h
		jz	loc_403930
		cmp	eax, 73h
		jz	loc_403940
		jmp	loc_403956
; ---------------------------------------------------------------------------

loc_40387D:				; CODE XREF: sub_40377D+C6j
		cmp	eax, 1F6h
		jz	short loc_4038EF
		cmp	eax, 1F6h
		jg	short loc_40389E
		cmp	eax, 1F4h
		jz	short loc_4038D2
		cmp	eax, 1F5h
		jz	short loc_4038E1
		jmp	loc_403956
; ---------------------------------------------------------------------------

loc_40389E:				; CODE XREF: sub_40377D+10Cj
		cmp	eax, 1F7h
		jz	short loc_4038FB
		cmp	eax, 1F8h
		jz	short loc_403921
		jmp	loc_403956
; ---------------------------------------------------------------------------

loc_4038B1:				; CODE XREF: sub_40377D+CBj
		mov	ds:dword_429044, 1
		jmp	loc_403962
; ---------------------------------------------------------------------------

loc_4038C0:				; CODE XREF: sub_40377D+BDj
		mov	eax, ds:dword_429040
		add	eax, 1
		mov	ds:dword_429040, eax
		jmp	loc_403962
; ---------------------------------------------------------------------------

loc_4038D2:				; CODE XREF: sub_40377D+113j
		mov	ds:dword_429040, 0
		jmp	loc_403962
; ---------------------------------------------------------------------------

loc_4038E1:				; CODE XREF: sub_40377D+11Aj
		mov	eax, [esp+31Ch+var_7C]
		mov	ds:dword_429048, eax
		jmp	short loc_403962
; ---------------------------------------------------------------------------

loc_4038EF:				; CODE XREF: sub_40377D+105j
		mov	ds:dword_42904C, 1
		jmp	short loc_403962
; ---------------------------------------------------------------------------

loc_4038FB:				; CODE XREF: sub_40377D+126j
		mov	ds:dword_429050, 1
		jmp	short loc_403962
; ---------------------------------------------------------------------------

loc_403907:				; CODE XREF: sub_40377D+DEj
		mov	eax, [esp+31Ch+var_7C]
		mov	ds:dword_429054, eax
		jmp	short loc_403962
; ---------------------------------------------------------------------------

loc_403915:				; CODE XREF: sub_40377D+D5j
		mov	ds:dword_429058, 1
		jmp	short loc_403962
; ---------------------------------------------------------------------------

loc_403921:				; CODE XREF: sub_40377D+12Dj
		mov	eax, ds:dword_42905C
		and	eax, 0FFFFFFFEh
		mov	ds:dword_42905C, eax
		jmp	short loc_403962
; ---------------------------------------------------------------------------

loc_403930:				; CODE XREF: sub_40377D+ECj
		mov	eax, [esp+31Ch+var_7C]
		mov	[esp+31Ch+Filename], eax
		jmp	short loc_403962
; ---------------------------------------------------------------------------

loc_403940:				; CODE XREF: sub_40377D+F5j
		mov	ds:dword_429060, 1
		mov	ds:dword_429064, 1
		jmp	short loc_403962
; ---------------------------------------------------------------------------

loc_403956:				; CODE XREF: sub_40377D+E4j
					; sub_40377D+FBj ...
		mov	[esp+31Ch+var_88], 2
		nop

loc_403962:				; CODE XREF: sub_40377D+AEj
					; sub_40377D+13Ej ...
		cmp	[esp+31Ch+var_38], 0
		jnz	short loc_4039A3
		mov	[esp+31Ch+var_30C], offset dword_422000	; int
		lea	eax, [esp+31Ch+var_94]
		mov	[esp+31Ch+var_310], eax	; int
		mov	[esp+31Ch+MaxCount], 0 ; int
		mov	[esp+31Ch+Mode], 0 ; int
		mov	[esp+31Ch+Code], 0 ; FILE *
		call	sub_41C84E
		test	eax, eax
		jnz	loc_403830

loc_4039A3:				; CODE XREF: sub_40377D+1EDj
		mov	[esp+31Ch+Code], 0
		call	sub_419E18
		test	eax, eax
		jz	short loc_4039BF
		mov	[esp+31Ch+Code], 2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4039BF:				; CODE XREF: sub_40377D+234j
		mov	eax, ds:_iob
		mov	[esp+31Ch+Code], eax ; File
		call	_fileno
		mov	[esp+31Ch+Code], eax
		call	_isatty
		test	eax, eax
		jz	short loc_4039FB
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+31Ch+Code], eax ; File
		call	_fileno
		mov	[esp+31Ch+Code], eax
		call	_isatty
		test	eax, eax
		jz	short loc_4039FB
		mov	eax, 1
		jmp	short loc_403A00
; ---------------------------------------------------------------------------

loc_4039FB:				; CODE XREF: sub_40377D+259j
					; sub_40377D+275j
		mov	eax, 0

loc_403A00:				; CODE XREF: sub_40377D+27Cj
		mov	[esp+31Ch+var_3C], eax
		mov	eax, ds:dword_429058
		test	eax, eax
		jz	short loc_403A3F
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jnz	short loc_403A50
		mov	[esp+31Ch+Code], offset	aOptionSRequire	; "option \"%s\" requires a program and	op"...
		call	sub_419D7C
		mov	[esp+31Ch+Mode], offset	aExec ;	"--exec"
		mov	[esp+31Ch+Code], eax ; char *
		call	sub_41A665
		mov	[esp+31Ch+Code], 1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_403A3F:				; CODE XREF: sub_40377D+291j
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jz	short loc_403A50
		mov	eax, [ebp+arg_4]
		mov	[esp+31Ch+var_28], eax

loc_403A50:				; CODE XREF: sub_40377D+298j
					; sub_40377D+2C7j
		mov	eax, ds:dword_429058
		test	eax, eax
		jz	short loc_403A86
		mov	eax, ds:dword_429054
		test	eax, eax
		jz	short loc_403A86
		mov	[esp+31Ch+Code], offset	aOptionSIgnored	; "option \"%s\" ignored due to	\"%s\"\n"
		call	sub_419D7C
		mov	[esp+31Ch+MaxCount], offset aExec ; "--exec"
		mov	[esp+31Ch+Mode], offset	aRawSocket ; "--raw-socket"
		mov	[esp+31Ch+Code], eax ; char *
		call	sub_41A63B

loc_403A86:				; CODE XREF: sub_40377D+2DAj
					; sub_40377D+2E3j
		cmp	[esp+31Ch+Filename], 0
		jz	short loc_403AF1
		mov	eax, offset Mode ; "r"
		mov	[esp+31Ch+Mode], eax ; Mode
		mov	eax, [esp+31Ch+Filename]
		mov	[esp+31Ch+Code], eax ; Filename
		call	fopen
		mov	[esp+31Ch+File], eax
		cmp	[esp+31Ch+File], 0
		jnz	short loc_403AF1
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+31Ch+Code], eax ; int
		call	strerror
		mov	[esp+31Ch+MaxCount], eax
		mov	eax, [esp+31Ch+Filename]
		mov	[esp+31Ch+Mode], eax ; char
		mov	[esp+31Ch+Code], offset	aCannotOpenRunF	; "cannot open run file	`%s': %s\n"
		call	sub_41A665
		mov	[esp+31Ch+Code], 1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_403AF1:				; CODE XREF: sub_40377D+311j
					; sub_40377D+33Aj
		mov	eax, ds:dword_429058
		test	eax, eax
		jz	loc_403C26
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+31Ch+Code], eax ; File
		call	_fileno
		mov	[esp+31Ch+Code], eax
		call	sub_4015AD
		mov	[esp+31Ch+var_2E0], eax
		call	sub_41A229
		mov	[esp+31Ch+Code], eax
		call	sub_4015AD
		mov	[esp+31Ch+var_2DC], eax
		mov	[esp+31Ch+var_2D8], 0FFFFFFFFh
		lea	eax, [esp+31Ch+var_98]
		mov	[esp+31Ch+Code], eax
		call	assuan_new
		mov	[esp+31Ch+var_14], eax
		cmp	[esp+31Ch+var_14], 0
		jz	short loc_403B7E
		mov	eax, [esp+31Ch+var_14]
		mov	[esp+31Ch+Code], eax
		call	gpg_strerror
		mov	[esp+31Ch+Mode], eax ; char
		mov	[esp+31Ch+Code], offset	aAssuan_newFail	; "assuan_new failed: %s\n"
		call	sub_41A665
		mov	[esp+31Ch+Code], 1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_403B7E:				; CODE XREF: sub_40377D+3D4j
		mov	eax, ds:dword_42905C
		mov	ebx, eax
		and	ebx, 1
		mov	ecx, [ebp+arg_4]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [esp+31Ch+var_98]
		mov	[esp+31Ch+var_304], ebx
		mov	[esp+31Ch+var_308], 0
		mov	[esp+31Ch+var_30C], 0
		lea	ebx, [esp+31Ch+var_2E0]
		mov	[esp+31Ch+var_310], ebx
		mov	[esp+31Ch+MaxCount], ecx
		mov	[esp+31Ch+Mode], edx
		mov	[esp+31Ch+Code], eax
		call	assuan_pipe_connect
		mov	[esp+31Ch+var_14], eax
		cmp	[esp+31Ch+var_14], 0
		jz	short loc_403BFF
		mov	eax, [esp+31Ch+var_14]
		mov	[esp+31Ch+Code], eax
		call	gpg_strerror
		mov	[esp+31Ch+Mode], eax ; char
		mov	[esp+31Ch+Code], offset	aAssuan_pipe_co	; "assuan_pipe_connect_ext failed: %s\n"
		call	sub_41A665
		mov	[esp+31Ch+Code], 1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_403BFF:				; CODE XREF: sub_40377D+455j
		mov	eax, ds:dword_429040
		test	eax, eax
		jz	loc_403D1F
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+31Ch+Mode], eax ; char
		mov	[esp+31Ch+Code], offset	aServerSStarted	; "server `%s' started\n"
		call	sub_41A63B
		jmp	loc_403D1F
; ---------------------------------------------------------------------------

loc_403C26:				; CODE XREF: sub_40377D+37Bj
		mov	eax, ds:dword_429054
		test	eax, eax
		jz	loc_403D13
		lea	eax, [esp+31Ch+var_98]
		mov	[esp+31Ch+Code], eax
		call	assuan_new
		mov	[esp+31Ch+var_14], eax
		cmp	[esp+31Ch+var_14], 0
		jz	short loc_403C7E
		mov	eax, [esp+31Ch+var_14]
		mov	[esp+31Ch+Code], eax
		call	gpg_strerror
		mov	[esp+31Ch+Mode], eax ; char
		mov	[esp+31Ch+Code], offset	aAssuan_newFail	; "assuan_new failed: %s\n"
		call	sub_41A665
		mov	[esp+31Ch+Code], 1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_403C7E:				; CODE XREF: sub_40377D+4D4j
		mov	eax, ds:dword_42905C
		mov	ecx, eax
		and	ecx, 1
		mov	edx, ds:dword_429054
		mov	eax, [esp+31Ch+var_98]
		mov	[esp+31Ch+var_310], ecx
		mov	[esp+31Ch+MaxCount], 0
		mov	[esp+31Ch+Mode], edx
		mov	[esp+31Ch+Code], eax
		call	assuan_socket_connect
		mov	[esp+31Ch+var_14], eax
		cmp	[esp+31Ch+var_14], 0
		jz	short loc_403CF3
		mov	eax, [esp+31Ch+var_14]
		mov	[esp+31Ch+Code], eax
		call	gpg_strerror
		mov	edx, ds:dword_429054
		mov	[esp+31Ch+MaxCount], eax
		mov	[esp+31Ch+Mode], edx ; char
		mov	[esp+31Ch+Code], offset	aCanTConnectToS	; "can't connect to socket `%s': %s\n"
		call	sub_41A665
		mov	[esp+31Ch+Code], 1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_403CF3:				; CODE XREF: sub_40377D+53Fj
		mov	eax, ds:dword_429040
		test	eax, eax
		jz	short loc_403D1F
		mov	eax, ds:dword_429054
		mov	[esp+31Ch+Mode], eax ; char
		mov	[esp+31Ch+Code], offset	aConnectionToSo	; "connection to socket	`%s' established\n"
		call	sub_41A63B
		jmp	short loc_403D1F
; ---------------------------------------------------------------------------

loc_403D13:				; CODE XREF: sub_40377D+4B0j
		call	sub_406808
		mov	[esp+31Ch+var_98], eax

loc_403D1F:				; CODE XREF: sub_40377D+489j
					; sub_40377D+4A4j ...
		mov	eax, [esp+31Ch+var_98]
		mov	[esp+31Ch+Code], eax
		call	assuan_pending_line
		test	eax, eax
		jz	short loc_403D8E
		mov	eax, [esp+31Ch+var_98]
		lea	edx, [esp+31Ch+var_A4]
		mov	[esp+31Ch+MaxCount], edx
		mov	[esp+31Ch+Mode], 0
		mov	[esp+31Ch+Code], eax
		call	sub_405EA8
		mov	[esp+31Ch+var_14], eax
		cmp	[esp+31Ch+var_14], 0
		jz	short loc_403D8E
		mov	eax, [esp+31Ch+var_14]
		mov	[esp+31Ch+Code], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+31Ch+Code], offset	aReceivingLineF	; "receiving line failed: %s\n"
		call	sub_419D7C
		mov	[esp+31Ch+Mode], ebx ; char
		mov	[esp+31Ch+Code], eax ; char *
		call	sub_41A63B

loc_403D8E:				; CODE XREF: sub_40377D+5B3j
					; sub_40377D+5E6j
		mov	[esp+31Ch+var_24], 0
		jmp	short loc_403DCA
; ---------------------------------------------------------------------------

loc_403D9B:				; CODE XREF: sub_40377D+657j
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2C8h
		mov	dword ptr [eax], 0
		add	[esp+31Ch+var_24], 1

loc_403DCA:				; CODE XREF: sub_40377D+61Cj
		mov	eax, [esp+31Ch+var_24]
		cmp	eax, 13h
		jbe	short loc_403D9B
		mov	[esp+31Ch+var_24], 0FFFFFFFFh
		mov	[esp+31Ch+Buf],	0
		mov	[esp+31Ch+var_A0], 0
		mov	[esp+31Ch+var_20], 1
		jmp	short loc_403E05
; ---------------------------------------------------------------------------

loc_403E04:				; CODE XREF: sub_40377D+22A1j
					; sub_40377D+22AFj ...
		nop

loc_403E05:				; CODE XREF: sub_40377D+685j
		mov	[esp+31Ch+var_2E4], 800h
		cmp	[esp+31Ch+var_24], 13h
		jle	short loc_403E33
		mov	[esp+31Ch+MaxCount], 510h ; int
		mov	[esp+31Ch+Mode], offset	a____Gnupg22_0_	; "../../gnupg2-2.0.30/tools/gpg-connect-a"...
		mov	[esp+31Ch+Code], offset	aLoopidxIntDimL	; "loopidx < (int)DIM (loopstack)"
		call	sub_421040

loc_403E33:				; CODE XREF: sub_40377D+698j
		cmp	[esp+31Ch+var_24], 0
		js	loc_403FCE
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2BCh
		mov	eax, [eax]
		test	eax, eax
		jz	loc_403FCE
		mov	[esp+31Ch+var_20], 0
		mov	eax, [esp+31Ch+Buf]
		mov	[esp+31Ch+Code], eax ; void *
		call	sub_406E5D
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2BCh
		mov	eax, [eax]
		add	eax, 4
		mov	[esp+31Ch+Code], eax ; char *
		call	sub_406E03
		mov	[esp+31Ch+Buf],	eax
		mov	eax, [esp+31Ch+Buf]
		mov	[esp+31Ch+var_2F0], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [esp+31Ch+var_2F0]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+31Ch+var_2C], eax
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2BCh
		mov	eax, [eax]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_403F5D
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2BCh
		mov	eax, [eax]
		mov	ecx, [eax]
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2BCh
		mov	[eax], ecx
		jmp	loc_4041B5
; ---------------------------------------------------------------------------

loc_403F5D:				; CODE XREF: sub_40377D+791j
		mov	eax, [esp+31Ch+Buf]
		mov	edx, eax
		mov	eax, offset aEnd ; "/end"
		mov	ecx, 4
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_403FBC
		mov	eax, [esp+31Ch+Buf]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_403FC8
		mov	eax, [esp+31Ch+Buf]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_403FC8
		mov	eax, [esp+31Ch+Buf]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_403FC8

loc_403FBC:				; CODE XREF: sub_40377D+80Aj
		mov	[esp+31Ch+Code], offset	aEndCommandVani	; "/end	command	vanished\n"
		call	sub_41A6A8
; ---------------------------------------------------------------------------

loc_403FC8:				; CODE XREF: sub_40377D+81Bj
					; sub_40377D+82Cj ...
		nop
		jmp	loc_4041B5
; ---------------------------------------------------------------------------

loc_403FCE:				; CODE XREF: sub_40377D+6BEj
					; sub_40377D+6E9j
		cmp	[esp+31Ch+var_28], 0
		jz	loc_404081
		mov	eax, [esp+31Ch+var_28]
		mov	eax, [eax]
		test	eax, eax
		jz	loc_404081
		cmp	[esp+31Ch+File], 0
		jnz	loc_404081
		mov	[esp+31Ch+var_20], 0
		mov	eax, [esp+31Ch+Buf]
		mov	[esp+31Ch+Code], eax ; void *
		call	sub_406E5D
		mov	eax, [esp+31Ch+var_28]
		mov	eax, [eax]
		mov	[esp+31Ch+Code], eax ; char *
		call	sub_406E03
		mov	[esp+31Ch+Buf],	eax
		add	[esp+31Ch+var_28], 4
		mov	eax, [esp+31Ch+Buf]
		mov	[esp+31Ch+var_2F0], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [esp+31Ch+var_2F0]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+31Ch+var_2C], eax
		mov	edx, [esp+31Ch+var_2C]
		mov	eax, [esp+31Ch+var_2E4]
		cmp	edx, eax
		jb	loc_4041B5
		mov	[esp+31Ch+var_2E4], 0
		jmp	loc_4041B5
; ---------------------------------------------------------------------------

loc_404081:				; CODE XREF: sub_40377D+859j
					; sub_40377D+86Aj ...
		cmp	[esp+31Ch+var_3C], 0
		jz	loc_404136
		cmp	[esp+31Ch+File], 0
		jnz	loc_404136
		mov	[esp+31Ch+var_20], 0
		mov	eax, [esp+31Ch+Buf]
		mov	[esp+31Ch+Code], eax ; void *
		call	sub_406E5D
		mov	[esp+31Ch+Code], offset	asc_423B67 ; ">	"
		call	sub_40B4FF
		mov	[esp+31Ch+Buf],	eax
		mov	eax, [esp+31Ch+Buf]
		mov	[esp+31Ch+var_2F0], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [esp+31Ch+var_2F0]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+31Ch+var_2C], eax
		cmp	[esp+31Ch+var_2C], 1
		jnz	short loc_404119
		mov	eax, [esp+31Ch+Buf]
		movzx	eax, byte ptr [eax]
		cmp	al, 4
		jnz	short loc_404119
		mov	[esp+31Ch+var_2C], 0

loc_404119:				; CODE XREF: sub_40377D+981j
					; sub_40377D+98Fj
		mov	edx, [esp+31Ch+var_2C]
		mov	eax, [esp+31Ch+var_2E4]
		cmp	edx, eax
		jb	loc_4041B5
		mov	[esp+31Ch+var_2E4], 0
		jmp	short loc_4041B5
; ---------------------------------------------------------------------------

loc_404136:				; CODE XREF: sub_40377D+90Cj
					; sub_40377D+91Aj
		cmp	[esp+31Ch+var_20], 0
		jnz	short loc_404170
		mov	eax, [esp+31Ch+Buf]
		mov	[esp+31Ch+Code], eax ; void *
		call	sub_406E5D
		mov	[esp+31Ch+Buf],	0
		mov	[esp+31Ch+var_A0], 0
		mov	[esp+31Ch+var_20], 1

loc_404170:				; CODE XREF: sub_40377D+9C1j
		cmp	[esp+31Ch+File], 0
		jz	short loc_404183
		mov	eax, [esp+31Ch+File]
		jmp	short loc_404188
; ---------------------------------------------------------------------------

loc_404183:				; CODE XREF: sub_40377D+9FBj
		mov	eax, ds:_iob

loc_404188:				; CODE XREF: sub_40377D+A04j
		lea	edx, [esp+31Ch+var_2E4]
		mov	[esp+31Ch+var_310], edx	; int
		lea	edx, [esp+31Ch+var_A0]
		mov	[esp+31Ch+MaxCount], edx ; int
		lea	edx, [esp+31Ch+Buf]
		mov	[esp+31Ch+Mode], edx ; char
		mov	[esp+31Ch+Code], eax ; FILE *
		call	sub_40B7B0
		mov	[esp+31Ch+var_2C], eax

loc_4041B5:				; CODE XREF: sub_40377D+7DBj
					; sub_40377D+84Cj ...
		cmp	[esp+31Ch+var_2C], 0
		jns	short loc_40422B
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+31Ch+Code], eax ; int
		call	strerror
		mov	ebx, eax
		mov	[esp+31Ch+Code], offset	aErrorReadingIn	; "error reading input:	%s\n"
		call	sub_419D7C
		mov	[esp+31Ch+Mode], ebx ; char
		mov	[esp+31Ch+Code], eax ; char *
		call	sub_41A665
		cmp	[esp+31Ch+File], 0
		jz	short loc_40421F
		mov	eax, [esp+31Ch+File]
		mov	[esp+31Ch+Code], eax ; File
		call	fclose
		mov	[esp+31Ch+File], 0
		mov	[esp+31Ch+Code], offset	aStoppingScript	; "stopping script execution\n"
		call	sub_41A665
		jmp	loc_405A67
; ---------------------------------------------------------------------------

loc_40421F:				; CODE XREF: sub_40377D+A75j
		mov	[esp+31Ch+Code], 1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_40422B:				; CODE XREF: sub_40377D+A40j
		cmp	[esp+31Ch+var_2C], 0
		jnz	short loc_40427B
		cmp	[esp+31Ch+File], 0
		jz	loc_405A6C
		mov	eax, [esp+31Ch+File]
		mov	[esp+31Ch+Code], eax ; File
		call	fclose
		mov	[esp+31Ch+File], 0
		mov	eax, ds:dword_429040
		test	eax, eax
		jz	loc_405A5D
		mov	[esp+31Ch+Code], offset	aEndOfScript ; "end of script\n"
		call	sub_41A63B
		jmp	loc_405A5D
; ---------------------------------------------------------------------------

loc_40427B:				; CODE XREF: sub_40377D+AB6j
		mov	eax, [esp+31Ch+var_2E4]
		test	eax, eax
		jnz	short loc_40429C
		mov	[esp+31Ch+Code], offset	aLineTooLongSki	; "line	too long - skipped\n"
		call	sub_419D7C
		mov	[esp+31Ch+Code], eax ; char *
		call	sub_41A665
		jmp	loc_405A67
; ---------------------------------------------------------------------------

loc_40429C:				; CODE XREF: sub_40377D+B04j
		mov	edx, [esp+31Ch+var_2C]
		mov	eax, [esp+31Ch+Buf]
		mov	[esp+31Ch+MaxCount], edx ; MaxCount
		mov	[esp+31Ch+Mode], 0 ; char
		mov	[esp+31Ch+Code], eax ; Buf
		call	memchr
		test	eax, eax
		jz	short loc_4042D6
		mov	[esp+31Ch+Code], offset	aLineShortenedD	; "line	shortened due to embedded Nul char"...
		call	sub_419D7C
		mov	[esp+31Ch+Code], eax ; char *
		call	sub_41A63B

loc_4042D6:				; CODE XREF: sub_40377D+B43j
		mov	eax, [esp+31Ch+Buf]
		mov	edx, [esp+31Ch+var_2C]
		sub	edx, 1
		add	eax, edx
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_404306
		mov	eax, [esp+31Ch+Buf]
		mov	edx, [esp+31Ch+var_2C]
		sub	edx, 1
		add	eax, edx
		mov	byte ptr [eax],	0

loc_404306:				; CODE XREF: sub_40377D+B71j
		mov	eax, ds:dword_429064
		test	eax, eax
		jz	loc_4043BD
		mov	eax, [esp+31Ch+Buf]
		mov	[esp+31Ch+var_30], eax
		jmp	short loc_40432B
; ---------------------------------------------------------------------------

loc_404323:				; CODE XREF: sub_40377D+BBAj
					; sub_40377D+BC8j
		add	[esp+31Ch+var_30], 1

loc_40432B:				; CODE XREF: sub_40377D+BA4j
		mov	eax, [esp+31Ch+var_30]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_404323
		mov	eax, [esp+31Ch+var_30]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_404323
		mov	eax, [esp+31Ch+Buf]
		cmp	[esp+31Ch+var_30], eax
		jz	short loc_4043BD
		mov	eax, [esp+31Ch+Buf]
		mov	[esp+31Ch+var_10], eax
		jmp	short loc_40438A
; ---------------------------------------------------------------------------

loc_404367:				; CODE XREF: sub_40377D+C19j
		mov	eax, [esp+31Ch+var_30]
		movzx	edx, byte ptr [eax]
		mov	eax, [esp+31Ch+var_10]
		mov	[eax], dl
		add	[esp+31Ch+var_10], 1
		add	[esp+31Ch+var_30], 1

loc_40438A:				; CODE XREF: sub_40377D+BE8j
		mov	eax, [esp+31Ch+var_30]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_404367
		mov	eax, [esp+31Ch+var_10]
		mov	byte ptr [eax],	0
		mov	edx, [esp+31Ch+var_10]
		mov	eax, [esp+31Ch+Buf]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[esp+31Ch+var_2C], eax

loc_4043BD:				; CODE XREF: sub_40377D+B90j
					; sub_40377D+BD8j
		mov	eax, [esp+31Ch+var_24]
		add	eax, 1
		test	eax, eax
		js	loc_404673
		mov	eax, [esp+31Ch+var_24]
		add	eax, 1
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2C8h
		mov	eax, [eax]
		test	eax, eax
		jz	loc_404673
		mov	eax, [esp+31Ch+Buf]
		mov	[esp+31Ch+var_2F0], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [esp+31Ch+var_2F0]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 8
		mov	[esp+31Ch+Code], eax ; size_t
		call	sub_406D00
		mov	[esp+31Ch+var_40], eax
		mov	eax, [esp+31Ch+var_40]
		mov	dword ptr [eax], 0
		mov	eax, [esp+31Ch+Buf]
		mov	edx, [esp+31Ch+var_40]
		add	edx, 4
		mov	[esp+31Ch+Mode], eax ; Source
		mov	[esp+31Ch+Code], edx ; Dest
		call	strcpy
		mov	eax, [esp+31Ch+var_24]
		add	eax, 1
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2C0h
		mov	eax, [eax]
		mov	edx, [esp+31Ch+var_40]
		mov	[eax], edx
		mov	eax, [esp+31Ch+var_24]
		add	eax, 1
		mov	ecx, [esp+31Ch+var_40]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2C0h
		mov	[eax], ecx
		mov	eax, [esp+31Ch+Buf]
		mov	edx, eax
		mov	eax, offset aEnd ; "/end"
		mov	ecx, 4
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	loc_40456B
		mov	eax, [esp+31Ch+Buf]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40451D
		mov	eax, [esp+31Ch+Buf]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40451D
		mov	eax, [esp+31Ch+Buf]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_40456B

loc_40451D:				; CODE XREF: sub_40377D+D7Cj
					; sub_40377D+D8Dj
		mov	eax, [esp+31Ch+var_24]
		lea	ecx, [eax+1]
		mov	eax, ecx
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2B8h
		mov	eax, [eax]
		lea	ebx, [eax-1]
		mov	eax, ecx
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2B8h
		mov	[eax], ebx
		jmp	loc_404613
; ---------------------------------------------------------------------------

loc_40456B:				; CODE XREF: sub_40377D+D67j
					; sub_40377D+D9Ej
		mov	eax, [esp+31Ch+Buf]
		mov	edx, eax
		mov	eax, offset aWhile ; "/while"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_404613
		mov	eax, [esp+31Ch+Buf]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4045CA
		mov	eax, [esp+31Ch+Buf]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4045CA
		mov	eax, [esp+31Ch+Buf]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_404613

loc_4045CA:				; CODE XREF: sub_40377D+E29j
					; sub_40377D+E3Aj
		mov	eax, [esp+31Ch+var_24]
		lea	ecx, [eax+1]
		mov	eax, ecx
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2B8h
		mov	eax, [eax]
		lea	ebx, [eax+1]
		mov	eax, ecx
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2B8h
		mov	[eax], ebx

loc_404613:				; CODE XREF: sub_40377D+DE9j
					; sub_40377D+E18j ...
		mov	eax, [esp+31Ch+var_24]
		add	eax, 1
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2B8h
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_405A60
		mov	eax, [esp+31Ch+var_24]
		add	eax, 1
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2C8h
		mov	dword ptr [eax], 0
		add	[esp+31Ch+var_24], 1

loc_404673:				; CODE XREF: sub_40377D+C4Cj
					; sub_40377D+C7Aj
		mov	eax, [esp+31Ch+Buf]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	loc_405850
		mov	eax, [esp+31Ch+Buf]
		add	eax, 1
		mov	[esp+31Ch+Str1], eax
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+var_10], eax
		jmp	short loc_4046AE
; ---------------------------------------------------------------------------

loc_4046A6:				; CODE XREF: sub_40377D+F59j
		add	[esp+31Ch+var_10], 1

loc_4046AE:				; CODE XREF: sub_40377D+F27j
		mov	eax, [esp+31Ch+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4046D8
		mov	eax, [esp+31Ch+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4046D8
		mov	eax, [esp+31Ch+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_4046A6

loc_4046D8:				; CODE XREF: sub_40377D+F3Dj
					; sub_40377D+F4Bj
		mov	eax, [esp+31Ch+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404704
		mov	eax, [esp+31Ch+var_10]
		mov	byte ptr [eax],	0
		add	[esp+31Ch+var_10], 1
		jmp	short loc_404704
; ---------------------------------------------------------------------------

loc_4046FA:				; CODE XREF: sub_40377D+F94j
					; sub_40377D+FA2j
		add	[esp+31Ch+var_10], 1
		jmp	short loc_404705
; ---------------------------------------------------------------------------

loc_404704:				; CODE XREF: sub_40377D+F67j
					; sub_40377D+F7Bj
		nop

loc_404705:				; CODE XREF: sub_40377D+F85j
		mov	eax, [esp+31Ch+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4046FA
		mov	eax, [esp+31Ch+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_4046FA
		mov	[esp+31Ch+Mode], offset	aLet ; "let"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_404758
		mov	[esp+31Ch+Mode], 0
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+Code], eax
		call	sub_402C1C
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_404758:				; CODE XREF: sub_40377D+FBDj
		mov	[esp+31Ch+Mode], offset	aSlet ;	"slet"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40478F
		mov	[esp+31Ch+Mode], 1
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+Code], eax
		call	sub_402C1C
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_40478F:				; CODE XREF: sub_40377D+FF4j
		mov	[esp+31Ch+Mode], offset	aShowvar ; "showvar"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4047B4
		call	sub_402DC7
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_4047B4:				; CODE XREF: sub_40377D+102Bj
		mov	[esp+31Ch+Mode], offset	aDefinq	; "definq"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	loc_40485A
		mov	eax, ds:dword_429060
		test	eax, eax
		jz	short loc_4047ED
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+Code], eax
		call	sub_40284F
		jmp	short loc_4047F2
; ---------------------------------------------------------------------------

loc_4047ED:				; CODE XREF: sub_40377D+105Dj
		mov	eax, 0

loc_4047F2:				; CODE XREF: sub_40377D+106Ej
		mov	[esp+31Ch+Str],	eax
		cmp	[esp+31Ch+Str],	0
		jz	short loc_404836
		mov	[esp+31Ch+MaxCount], 0
		mov	[esp+31Ch+Mode], 1
		mov	eax, [esp+31Ch+Str]
		mov	[esp+31Ch+Code], eax
		call	sub_402E12
		mov	eax, [esp+31Ch+Str]
		mov	[esp+31Ch+Code], eax ; void *
		call	sub_406E5D
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_404836:				; CODE XREF: sub_40377D+1084j
		mov	[esp+31Ch+MaxCount], 0
		mov	[esp+31Ch+Mode], 1
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+Code], eax
		call	sub_402E12
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_40485A:				; CODE XREF: sub_40377D+1050j
		mov	[esp+31Ch+Mode], offset	aDefinqfile ; "definqfile"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	loc_404900
		mov	eax, ds:dword_429060
		test	eax, eax
		jz	short loc_404893
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+Code], eax
		call	sub_40284F
		jmp	short loc_404898
; ---------------------------------------------------------------------------

loc_404893:				; CODE XREF: sub_40377D+1103j
		mov	eax, 0

loc_404898:				; CODE XREF: sub_40377D+1114j
		mov	[esp+31Ch+Str],	eax
		cmp	[esp+31Ch+Str],	0
		jz	short loc_4048DC
		mov	[esp+31Ch+MaxCount], 0
		mov	[esp+31Ch+Mode], 0
		mov	eax, [esp+31Ch+Str]
		mov	[esp+31Ch+Code], eax
		call	sub_402E12
		mov	eax, [esp+31Ch+Str]
		mov	[esp+31Ch+Code], eax ; void *
		call	sub_406E5D
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_4048DC:				; CODE XREF: sub_40377D+112Aj
		mov	[esp+31Ch+MaxCount], 0
		mov	[esp+31Ch+Mode], 0
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+Code], eax
		call	sub_402E12
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_404900:				; CODE XREF: sub_40377D+10F6j
		mov	[esp+31Ch+Mode], offset	aDefinqprog ; "definqprog"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	loc_4049A6
		mov	eax, ds:dword_429060
		test	eax, eax
		jz	short loc_404939
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+Code], eax
		call	sub_40284F
		jmp	short loc_40493E
; ---------------------------------------------------------------------------

loc_404939:				; CODE XREF: sub_40377D+11A9j
		mov	eax, 0

loc_40493E:				; CODE XREF: sub_40377D+11BAj
		mov	[esp+31Ch+Str],	eax
		cmp	[esp+31Ch+Str],	0
		jz	short loc_404982
		mov	[esp+31Ch+MaxCount], 1
		mov	[esp+31Ch+Mode], 0
		mov	eax, [esp+31Ch+Str]
		mov	[esp+31Ch+Code], eax
		call	sub_402E12
		mov	eax, [esp+31Ch+Str]
		mov	[esp+31Ch+Code], eax ; void *
		call	sub_406E5D
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_404982:				; CODE XREF: sub_40377D+11D0j
		mov	[esp+31Ch+MaxCount], 1
		mov	[esp+31Ch+Mode], 0
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+Code], eax
		call	sub_402E12
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_4049A6:				; CODE XREF: sub_40377D+119Cj
		mov	[esp+31Ch+Mode], offset	aDatafile ; "datafile"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	loc_404AEF
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_4049F6
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_4049EC
		mov	eax, ds:File
		mov	[esp+31Ch+Code], eax ; File
		call	fclose

loc_4049EC:				; CODE XREF: sub_40377D+1260j
		mov	ds:File, 0

loc_4049F6:				; CODE XREF: sub_40377D+124Fj
		mov	eax, ds:dword_429060
		test	eax, eax
		jz	short loc_404A10
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+Code], eax
		call	sub_40284F
		jmp	short loc_404A15
; ---------------------------------------------------------------------------

loc_404A10:				; CODE XREF: sub_40377D+1280j
		mov	eax, 0

loc_404A15:				; CODE XREF: sub_40377D+1291j
		mov	[esp+31Ch+Str],	eax
		cmp	[esp+31Ch+Str],	0
		jz	short loc_404A2F
		mov	eax, [esp+31Ch+Str]
		jmp	short loc_404A36
; ---------------------------------------------------------------------------

loc_404A2F:				; CODE XREF: sub_40377D+12A7j
		mov	eax, [esp+31Ch+var_10]

loc_404A36:				; CODE XREF: sub_40377D+12B0j
		mov	[esp+31Ch+var_4C], eax
		cmp	[esp+31Ch+var_4C], 0
		jz	short loc_404A71
		mov	[esp+31Ch+Mode], offset	asc_423C34 ; "-"
		mov	eax, [esp+31Ch+var_4C]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_404A71
		mov	eax, ds:_iob
		add	eax, 20h
		mov	ds:File, eax
		jmp	short loc_404ADB
; ---------------------------------------------------------------------------

loc_404A71:				; CODE XREF: sub_40377D+12C8j
					; sub_40377D+12E3j
		cmp	[esp+31Ch+var_4C], 0
		jz	short loc_404ADB
		mov	eax, [esp+31Ch+var_4C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404ADB
		mov	eax, offset aWb	; "wb"
		mov	[esp+31Ch+Mode], eax ; Mode
		mov	eax, [esp+31Ch+var_4C]
		mov	[esp+31Ch+Code], eax ; Filename
		call	fopen
		mov	ds:File, eax
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_404ADB
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+31Ch+Code], eax ; int
		call	strerror
		mov	[esp+31Ch+MaxCount], eax
		mov	eax, [esp+31Ch+var_4C]
		mov	[esp+31Ch+Mode], eax ; char
		mov	[esp+31Ch+Code], offset	aCanTOpenSS ; "can't open `%s': %s\n"
		call	sub_41A665

loc_404ADB:				; CODE XREF: sub_40377D+12F2j
					; sub_40377D+12FCj ...
		mov	eax, [esp+31Ch+Str]
		mov	[esp+31Ch+Code], eax ; void *
		call	sub_406E5D
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_404AEF:				; CODE XREF: sub_40377D+1242j
		mov	[esp+31Ch+Mode], offset	aShowdef ; "showdef"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_404B14
		call	sub_402F25
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_404B14:				; CODE XREF: sub_40377D+138Bj
		mov	[esp+31Ch+Mode], offset	aCleardef ; "cleardef"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_404B39
		call	sub_40300C
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_404B39:				; CODE XREF: sub_40377D+13B0j
		mov	[esp+31Ch+Mode], offset	aEcho ;	"echo"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_404BBB
		mov	eax, ds:dword_429060
		test	eax, eax
		jz	short loc_404B6E
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+Code], eax
		call	sub_40284F
		jmp	short loc_404B73
; ---------------------------------------------------------------------------

loc_404B6E:				; CODE XREF: sub_40377D+13DEj
		mov	eax, 0

loc_404B73:				; CODE XREF: sub_40377D+13EFj
		mov	[esp+31Ch+Str],	eax
		cmp	[esp+31Ch+Str],	0
		jz	short loc_404BA7
		mov	eax, [esp+31Ch+Str]
		mov	[esp+31Ch+Code], eax ; Str
		call	puts
		mov	eax, [esp+31Ch+Str]
		mov	[esp+31Ch+Code], eax ; void *
		call	sub_406E5D
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_404BA7:				; CODE XREF: sub_40377D+1405j
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+Code], eax ; Str
		call	puts
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_404BBB:				; CODE XREF: sub_40377D+13D5j
		mov	[esp+31Ch+Mode], offset	aSendfd	; "sendfd"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_404C53
		mov	eax, ds:dword_429060
		test	eax, eax
		jz	short loc_404BF0
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+Code], eax
		call	sub_40284F
		jmp	short loc_404BF5
; ---------------------------------------------------------------------------

loc_404BF0:				; CODE XREF: sub_40377D+1460j
		mov	eax, 0

loc_404BF5:				; CODE XREF: sub_40377D+1471j
		mov	[esp+31Ch+Str],	eax
		cmp	[esp+31Ch+Str],	0
		jz	short loc_404C34
		mov	eax, [esp+31Ch+var_98]
		mov	edx, [esp+31Ch+Str]
		mov	[esp+31Ch+Mode], edx
		mov	[esp+31Ch+Code], eax
		call	sub_403058
		mov	eax, [esp+31Ch+Str]
		mov	[esp+31Ch+Code], eax ; void *
		call	sub_406E5D
		jmp	loc_405A67
; ---------------------------------------------------------------------------

loc_404C34:				; CODE XREF: sub_40377D+1487j
		mov	eax, [esp+31Ch+var_98]
		mov	edx, [esp+31Ch+var_10]
		mov	[esp+31Ch+Mode], edx
		mov	[esp+31Ch+Code], eax
		call	sub_403058
		jmp	loc_405A67
; ---------------------------------------------------------------------------

loc_404C53:				; CODE XREF: sub_40377D+1457j
		mov	[esp+31Ch+Mode], offset	aRecvfd	; "recvfd"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_404CEB
		mov	eax, ds:dword_429060
		test	eax, eax
		jz	short loc_404C88
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+Code], eax
		call	sub_40284F
		jmp	short loc_404C8D
; ---------------------------------------------------------------------------

loc_404C88:				; CODE XREF: sub_40377D+14F8j
		mov	eax, 0

loc_404C8D:				; CODE XREF: sub_40377D+1509j
		mov	[esp+31Ch+Str],	eax
		cmp	[esp+31Ch+Str],	0
		jz	short loc_404CCC
		mov	eax, [esp+31Ch+var_98]
		mov	edx, [esp+31Ch+Str]
		mov	[esp+31Ch+Mode], edx
		mov	[esp+31Ch+Code], eax
		call	sub_4031E7
		mov	eax, [esp+31Ch+Str]
		mov	[esp+31Ch+Code], eax ; void *
		call	sub_406E5D
		jmp	loc_405A67
; ---------------------------------------------------------------------------

loc_404CCC:				; CODE XREF: sub_40377D+151Fj
		mov	eax, [esp+31Ch+var_98]
		mov	edx, [esp+31Ch+var_10]
		mov	[esp+31Ch+Mode], edx
		mov	[esp+31Ch+Code], eax
		call	sub_4031E7
		jmp	loc_405A67
; ---------------------------------------------------------------------------

loc_404CEB:				; CODE XREF: sub_40377D+14EFj
		mov	[esp+31Ch+Mode], offset	aOpen ;	"open"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_404D6D
		mov	eax, ds:dword_429060
		test	eax, eax
		jz	short loc_404D20
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+Code], eax
		call	sub_40284F
		jmp	short loc_404D25
; ---------------------------------------------------------------------------

loc_404D20:				; CODE XREF: sub_40377D+1590j
		mov	eax, 0

loc_404D25:				; CODE XREF: sub_40377D+15A1j
		mov	[esp+31Ch+Str],	eax
		cmp	[esp+31Ch+Str],	0
		jz	short loc_404D59
		mov	eax, [esp+31Ch+Str]
		mov	[esp+31Ch+Code], eax
		call	sub_4031FB
		mov	eax, [esp+31Ch+Str]
		mov	[esp+31Ch+Code], eax ; void *
		call	sub_406E5D
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_404D59:				; CODE XREF: sub_40377D+15B7j
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+Code], eax
		call	sub_4031FB
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_404D6D:				; CODE XREF: sub_40377D+1587j
		mov	[esp+31Ch+Mode], offset	aClose ; "close"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_404DEF
		mov	eax, ds:dword_429060
		test	eax, eax
		jz	short loc_404DA2
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+Code], eax
		call	sub_40284F
		jmp	short loc_404DA7
; ---------------------------------------------------------------------------

loc_404DA2:				; CODE XREF: sub_40377D+1612j
		mov	eax, 0

loc_404DA7:				; CODE XREF: sub_40377D+1623j
		mov	[esp+31Ch+Str],	eax
		cmp	[esp+31Ch+Str],	0
		jz	short loc_404DDB
		mov	eax, [esp+31Ch+Str]
		mov	[esp+31Ch+Code], eax ; char *
		call	sub_40351C
		mov	eax, [esp+31Ch+Str]
		mov	[esp+31Ch+Code], eax ; void *
		call	sub_406E5D
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_404DDB:				; CODE XREF: sub_40377D+1639j
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+Code], eax ; char *
		call	sub_40351C
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_404DEF:				; CODE XREF: sub_40377D+1609j
		mov	[esp+31Ch+Mode], offset	aShowopen ; "showopen"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_404E14
		call	sub_4035F5
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_404E14:				; CODE XREF: sub_40377D+168Bj
		mov	[esp+31Ch+Mode], offset	aServerpid ; "serverpid"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_404E43
		mov	eax, [esp+31Ch+var_98]
		mov	[esp+31Ch+Code], eax
		call	sub_403672
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_404E43:				; CODE XREF: sub_40377D+16B0j
		mov	[esp+31Ch+Mode], offset	aHex ; "hex"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_404E6D
		mov	ds:dword_42904C, 1
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_404E6D:				; CODE XREF: sub_40377D+16DFj
		mov	[esp+31Ch+Mode], offset	aNohex ; "nohex"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_404E97
		mov	ds:dword_42904C, 0
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_404E97:				; CODE XREF: sub_40377D+1709j
		mov	[esp+31Ch+Mode], offset	aDecode	; "decode"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_404EC1
		mov	ds:dword_429050, 1
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_404EC1:				; CODE XREF: sub_40377D+1733j
		mov	[esp+31Ch+Mode], offset	aNodecode ; "nodecode"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_404EEB
		mov	ds:dword_429050, 0
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_404EEB:				; CODE XREF: sub_40377D+175Dj
		mov	[esp+31Ch+Mode], offset	aSubst ; "subst"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_404F1F
		mov	ds:dword_429060, 1
		mov	ds:dword_429064, 1
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_404F1F:				; CODE XREF: sub_40377D+1787j
		mov	[esp+31Ch+Mode], offset	aNosubst ; "nosubst"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_404F49
		mov	ds:dword_429060, 0
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_404F49:				; CODE XREF: sub_40377D+17BBj
		mov	[esp+31Ch+Mode], offset	aRun ; "run"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	loc_4050F2
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+var_34], eax
		jmp	short loc_404F80
; ---------------------------------------------------------------------------

loc_404F78:				; CODE XREF: sub_40377D+182Bj
		add	[esp+31Ch+var_34], 1

loc_404F80:				; CODE XREF: sub_40377D+17F9j
		mov	eax, [esp+31Ch+var_34]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404FAA
		mov	eax, [esp+31Ch+var_34]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_404FAA
		mov	eax, [esp+31Ch+var_34]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_404F78

loc_404FAA:				; CODE XREF: sub_40377D+180Fj
					; sub_40377D+181Dj
		mov	eax, [esp+31Ch+var_34]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404FD6
		mov	eax, [esp+31Ch+var_34]
		mov	byte ptr [eax],	0
		add	[esp+31Ch+var_34], 1
		jmp	short loc_404FD6
; ---------------------------------------------------------------------------

loc_404FCC:				; CODE XREF: sub_40377D+1866j
					; sub_40377D+1874j
		add	[esp+31Ch+var_10], 1
		jmp	short loc_404FD7
; ---------------------------------------------------------------------------

loc_404FD6:				; CODE XREF: sub_40377D+1839j
					; sub_40377D+184Dj
		nop

loc_404FD7:				; CODE XREF: sub_40377D+1857j
		mov	eax, [esp+31Ch+var_34]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_404FCC
		mov	eax, [esp+31Ch+var_34]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_404FCC
		mov	eax, [esp+31Ch+var_34]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40503A
		mov	[esp+31Ch+Code], offset	aSyntaxErrorInR	; "syntax error	in run command\n"
		call	sub_41A665
		cmp	[esp+31Ch+File], 0
		jz	loc_405A63
		mov	eax, [esp+31Ch+File]
		mov	[esp+31Ch+Code], eax ; File
		call	fclose
		mov	[esp+31Ch+File], 0
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_40503A:				; CODE XREF: sub_40377D+1882j
		cmp	[esp+31Ch+File], 0
		jz	short loc_40506F
		mov	[esp+31Ch+Code], offset	aCannotNestRunC	; "cannot nest run commands - stop\n"
		call	sub_41A665
		mov	eax, [esp+31Ch+File]
		mov	[esp+31Ch+Code], eax ; File
		call	fclose
		mov	[esp+31Ch+File], 0
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_40506F:				; CODE XREF: sub_40377D+18C5j
		mov	edx, offset Mode ; "r"
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+Mode], edx ; Mode
		mov	[esp+31Ch+Code], eax ; Filename
		call	fopen
		mov	[esp+31Ch+File], eax
		cmp	[esp+31Ch+File], 0
		jnz	short loc_4050C9
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+31Ch+Code], eax ; int
		call	strerror
		mov	[esp+31Ch+MaxCount], eax
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+Mode], eax ; char
		mov	[esp+31Ch+Code], offset	aCannotOpenRunF	; "cannot open run file	`%s': %s\n"
		call	sub_41A665
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_4050C9:				; CODE XREF: sub_40377D+1919j
		mov	eax, ds:dword_429040
		test	eax, eax
		jz	loc_405A63
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+Mode], eax ; char
		mov	[esp+31Ch+Code], offset	aRunningCommand	; "running commands from `%s'\n"
		call	sub_41A63B
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_4050F2:				; CODE XREF: sub_40377D+17E5j
		mov	[esp+31Ch+Mode], offset	aWhile_0 ; "while"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	loc_405289
		mov	eax, [esp+31Ch+var_24]
		add	eax, 2
		cmp	eax, 13h
		jle	short loc_405131
		mov	[esp+31Ch+Code], offset	aBlocksAreNeste	; "blocks are nested too deep\n"
		call	sub_41A665
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_405131:				; CODE XREF: sub_40377D+19A1j
		mov	eax, [esp+31Ch+var_24]
		add	eax, 1
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2C4h
		mov	dword ptr [eax], 0
		mov	eax, [esp+31Ch+var_24]
		lea	ebx, [eax+1]
		mov	eax, [esp+31Ch+var_24]
		add	eax, 1
		lea	ecx, [esp+31Ch+var_2D4]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [ecx+edx]
		lea	ecx, [eax+4]
		mov	eax, ebx
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2C0h
		mov	[eax], ecx
		mov	eax, [esp+31Ch+var_24]
		add	eax, 1
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2BCh
		mov	dword ptr [eax], 0
		mov	eax, [esp+31Ch+var_24]
		add	eax, 1
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2B8h
		mov	dword ptr [eax], 1
		mov	eax, [esp+31Ch+var_24]
		add	eax, 1
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2B4h
		mov	dword ptr [eax], 0
		mov	eax, [esp+31Ch+var_24]
		lea	ebx, [eax+1]
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+Code], eax ; char *
		call	sub_406E03
		mov	ecx, eax
		mov	eax, ebx
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2B0h
		mov	[eax], ecx
		mov	eax, [esp+31Ch+var_24]
		add	eax, 1
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2C8h
		mov	dword ptr [eax], 1
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_405289:				; CODE XREF: sub_40377D+198Ej
		mov	[esp+31Ch+Mode], offset	aIf ; "if"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	loc_405420
		mov	eax, [esp+31Ch+var_24]
		add	eax, 2
		cmp	eax, 13h
		jle	short loc_4052C8
		mov	[esp+31Ch+Code], offset	aBlocksAreNeste	; "blocks are nested too deep\n"
		call	sub_41A665
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_4052C8:				; CODE XREF: sub_40377D+1B38j
		mov	eax, [esp+31Ch+var_24]
		add	eax, 1
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2C4h
		mov	dword ptr [eax], 0
		mov	eax, [esp+31Ch+var_24]
		lea	ebx, [eax+1]
		mov	eax, [esp+31Ch+var_24]
		add	eax, 1
		lea	ecx, [esp+31Ch+var_2D4]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [ecx+edx]
		lea	ecx, [eax+4]
		mov	eax, ebx
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2C0h
		mov	[eax], ecx
		mov	eax, [esp+31Ch+var_24]
		add	eax, 1
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2BCh
		mov	dword ptr [eax], 0
		mov	eax, [esp+31Ch+var_24]
		add	eax, 1
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2B8h
		mov	dword ptr [eax], 1
		mov	eax, [esp+31Ch+var_24]
		add	eax, 1
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2B4h
		mov	dword ptr [eax], 1
		mov	eax, [esp+31Ch+var_24]
		lea	ebx, [eax+1]
		mov	eax, [esp+31Ch+var_10]
		mov	[esp+31Ch+Code], eax ; char *
		call	sub_402BCF
		mov	ecx, eax
		mov	eax, ebx
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2B0h
		mov	[eax], ecx
		mov	eax, [esp+31Ch+var_24]
		add	eax, 1
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2C8h
		mov	dword ptr [eax], 1
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_405420:				; CODE XREF: sub_40377D+1B25j
		mov	[esp+31Ch+Mode], offset	aEnd_0 ; "end"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	loc_4057B5
		cmp	[esp+31Ch+var_24], 0
		jns	short loc_40545A
		mov	[esp+31Ch+Code], offset	aStrayEndComman	; "stray /end command encountered - ignore"...
		call	sub_41A665
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_40545A:				; CODE XREF: sub_40377D+1CCAj
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2B0h
		mov	eax, [eax]
		mov	[esp+31Ch+Code], eax ; char *
		call	sub_406E03
		mov	[esp+31Ch+var_50], eax
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2B4h
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40550F
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2B0h
		mov	eax, [eax]
		mov	[esp+31Ch+Code], eax ; void *
		call	sub_406E5D
		mov	[esp+31Ch+Code], offset	a0 ; "0"
		call	sub_406E03
		mov	ecx, eax
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2B0h
		mov	[eax], ecx

loc_40550F:				; CODE XREF: sub_40377D+1D34j
		mov	eax, [esp+31Ch+var_50]
		mov	[esp+31Ch+Code], eax
		call	sub_40284F
		mov	[esp+31Ch+Str],	eax
		cmp	[esp+31Ch+Str],	0
		jz	short loc_405538
		mov	eax, [esp+31Ch+Str]
		jmp	short loc_40553F
; ---------------------------------------------------------------------------

loc_405538:				; CODE XREF: sub_40377D+1DB0j
		mov	eax, [esp+31Ch+var_50]

loc_40553F:				; CODE XREF: sub_40377D+1DB9j
		mov	[esp+31Ch+var_54], eax
		mov	[esp+31Ch+MaxCount], 0 ; Radix
		mov	[esp+31Ch+Mode], 0 ; EndPtr
		mov	eax, [esp+31Ch+var_54]
		mov	[esp+31Ch+Code], eax ; Str
		call	strtol
		mov	[esp+31Ch+var_58], eax
		mov	eax, [esp+31Ch+Str]
		mov	[esp+31Ch+Code], eax ; void *
		call	sub_406E5D
		mov	eax, [esp+31Ch+var_50]
		mov	[esp+31Ch+Code], eax ; void *
		call	sub_406E5D
		cmp	[esp+31Ch+var_58], 0
		jz	loc_405667
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2C4h
		mov	ecx, [eax]
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2BCh
		mov	[eax], ecx
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_4055E3:				; CODE XREF: sub_40377D+1F10j
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2C4h
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[esp+31Ch+var_5C], eax
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2C4h
		mov	eax, [eax]
		mov	[esp+31Ch+Code], eax ; void *
		call	sub_406E5D
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		lea	edx, [eax-2C4h]
		mov	eax, [esp+31Ch+var_5C]
		mov	[edx], eax
		jmp	short loc_405668
; ---------------------------------------------------------------------------

loc_405667:				; CODE XREF: sub_40377D+1E15j
		nop

loc_405668:				; CODE XREF: sub_40377D+1EE8j
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2C4h
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_4055E3
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2C0h
		mov	dword ptr [eax], 0
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2BCh
		mov	dword ptr [eax], 0
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2B8h
		mov	dword ptr [eax], 0
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2C8h
		mov	dword ptr [eax], 0
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2B4h
		mov	dword ptr [eax], 0
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2B0h
		mov	eax, [eax]
		mov	[esp+31Ch+Code], eax ; void *
		call	sub_406E5D
		mov	eax, [esp+31Ch+var_24]
		shl	eax, 2
		lea	edx, ds:0[eax*8]
		sub	edx, eax
		lea	eax, [esp+31Ch+var_C]
		add	eax, edx
		sub	eax, 2B0h
		mov	dword ptr [eax], 0
		sub	[esp+31Ch+var_24], 1
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_4057B5:				; CODE XREF: sub_40377D+1CBCj
		mov	[esp+31Ch+Mode], offset	aBye ; "bye"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jz	loc_405A6F
		mov	[esp+31Ch+Mode], offset	aSleep ; "sleep"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_405800
		mov	[esp+31Ch+Code], 1
		call	sub_40B9F9
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_405800:				; CODE XREF: sub_40377D+2070j
		mov	[esp+31Ch+Mode], offset	aHelp ;	"help"
		mov	eax, [esp+31Ch+Str1]
		mov	[esp+31Ch+Code], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40582C
		mov	[esp+31Ch+Code], offset	aAvailableComma	; "Available commands:\n/echo ARGS	  "...
		call	puts
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_40582C:				; CODE XREF: sub_40377D+209Cj
		mov	[esp+31Ch+Code], offset	aUnknownCommand	; "unknown command `%s'\n"
		call	sub_419D7C
		mov	edx, [esp+31Ch+Str1]
		mov	[esp+31Ch+Mode], edx ; char
		mov	[esp+31Ch+Code], eax ; char *
		call	sub_41A665
		jmp	loc_405A63
; ---------------------------------------------------------------------------

loc_405850:				; CODE XREF: sub_40377D+F02j
		mov	eax, ds:dword_429040
		test	eax, eax
		jz	short loc_405872
		cmp	[esp+31Ch+File], 0
		jz	short loc_405872
		mov	eax, [esp+31Ch+Buf]
		mov	[esp+31Ch+Code], eax ; Str
		call	puts

loc_405872:				; CODE XREF: sub_40377D+20DAj
					; sub_40377D+20E4j
		mov	eax, ds:dword_429060
		test	eax, eax
		jz	short loc_40588C
		mov	eax, [esp+31Ch+Buf]
		mov	[esp+31Ch+Code], eax
		call	sub_40284F
		jmp	short loc_405891
; ---------------------------------------------------------------------------

loc_40588C:				; CODE XREF: sub_40377D+20FCj
		mov	eax, 0

loc_405891:				; CODE XREF: sub_40377D+210Dj
		mov	[esp+31Ch+Str],	eax
		cmp	[esp+31Ch+Str],	0
		jz	short loc_4058D4
		mov	eax, [esp+31Ch+var_98]
		mov	edx, [esp+31Ch+Str]
		mov	[esp+31Ch+Mode], edx
		mov	[esp+31Ch+Code], eax
		call	assuan_write_line
		mov	[esp+31Ch+var_14], eax
		mov	eax, [esp+31Ch+Str]
		mov	[esp+31Ch+Code], eax ; void *
		call	sub_406E5D
		jmp	short loc_4058F5
; ---------------------------------------------------------------------------

loc_4058D4:				; CODE XREF: sub_40377D+2123j
		mov	edx, [esp+31Ch+Buf]
		mov	eax, [esp+31Ch+var_98]
		mov	[esp+31Ch+Mode], edx
		mov	[esp+31Ch+Code], eax
		call	assuan_write_line
		mov	[esp+31Ch+var_14], eax

loc_4058F5:				; CODE XREF: sub_40377D+2155j
		cmp	[esp+31Ch+var_14], 0
		jz	short loc_40592D
		mov	eax, [esp+31Ch+var_14]
		mov	[esp+31Ch+Code], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+31Ch+Code], offset	aSendingLineFai	; "sending line	failed:	%s\n"
		call	sub_419D7C
		mov	[esp+31Ch+Mode], ebx ; char
		mov	[esp+31Ch+Code], eax ; char *
		call	sub_41A63B
		jmp	loc_405A70
; ---------------------------------------------------------------------------

loc_40592D:				; CODE XREF: sub_40377D+2180j
		mov	eax, [esp+31Ch+Buf]
		movzx	eax, byte ptr [eax]
		cmp	al, 23h
		jz	loc_405A66
		mov	eax, [esp+31Ch+Buf]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_405A66
		mov	eax, [esp+31Ch+Buf]
		mov	[esp+31Ch+MaxCount], 4
		mov	[esp+31Ch+Mode], offset	aHelp_0	; "HELP"
		mov	[esp+31Ch+Code], eax
		call	sub_41BB23
		test	eax, eax
		jnz	short loc_4059AE
		mov	eax, [esp+31Ch+Buf]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4059A7
		mov	eax, [esp+31Ch+Buf]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_4059A7
		mov	eax, [esp+31Ch+Buf]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4059AE

loc_4059A7:				; CODE XREF: sub_40377D+2206j
					; sub_40377D+2217j
		mov	eax, 1
		jmp	short loc_4059B3
; ---------------------------------------------------------------------------

loc_4059AE:				; CODE XREF: sub_40377D+21F5j
					; sub_40377D+2228j
		mov	eax, 0

loc_4059B3:				; CODE XREF: sub_40377D+222Fj
		mov	edx, [esp+31Ch+var_98]
		lea	ecx, [esp+31Ch+var_A4]
		mov	[esp+31Ch+MaxCount], ecx
		mov	[esp+31Ch+Mode], eax
		mov	[esp+31Ch+Code], edx
		call	sub_405EA8
		mov	[esp+31Ch+var_14], eax
		cmp	[esp+31Ch+var_14], 0
		jz	short loc_405A0B
		mov	eax, [esp+31Ch+var_14]
		mov	[esp+31Ch+Code], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+31Ch+Code], offset	aReceivingLineF	; "receiving line failed: %s\n"
		call	sub_419D7C
		mov	[esp+31Ch+Mode], ebx ; char
		mov	[esp+31Ch+Code], eax ; char *
		call	sub_41A63B

loc_405A0B:				; CODE XREF: sub_40377D+2263j
		cmp	[esp+31Ch+var_14], 0
		jnz	short loc_405A24
		mov	eax, [esp+31Ch+var_A4]
		test	eax, eax
		jz	loc_403E04

loc_405A24:				; CODE XREF: sub_40377D+2296j
		cmp	[esp+31Ch+File], 0
		jz	loc_403E04
		mov	[esp+31Ch+Code], offset	aStoppingScript	; "stopping script execution\n"
		call	sub_41A665
		mov	eax, [esp+31Ch+File]
		mov	[esp+31Ch+Code], eax ; File
		call	fclose
		mov	[esp+31Ch+File], 0
		jmp	loc_403E04
; ---------------------------------------------------------------------------

loc_405A5D:				; CODE XREF: sub_40377D+AE7j
					; sub_40377D+AF9j
		nop
		jmp	short loc_405A67
; ---------------------------------------------------------------------------

loc_405A60:				; CODE XREF: sub_40377D+EBEj
		nop
		jmp	short loc_405A67
; ---------------------------------------------------------------------------

loc_405A63:				; CODE XREF: sub_40377D+FD6j
					; sub_40377D+100Dj ...
		nop
		jmp	short loc_405A67
; ---------------------------------------------------------------------------

loc_405A66:				; CODE XREF: sub_40377D+21BCj
					; sub_40377D+21CEj
		nop

loc_405A67:				; CODE XREF: sub_40377D+A9Dj
					; sub_40377D+B1Aj ...
		jmp	loc_403E04
; ---------------------------------------------------------------------------

loc_405A6C:				; CODE XREF: sub_40377D+AC0j
		nop
		jmp	short loc_405A70
; ---------------------------------------------------------------------------

loc_405A6F:				; CODE XREF: sub_40377D+2051j
		nop

loc_405A70:				; CODE XREF: sub_40377D+21ABj
					; sub_40377D+22F0j
		mov	eax, ds:dword_429040
		test	eax, eax
		jz	short loc_405A85
		mov	[esp+31Ch+Code], offset	aClosingConnect	; "closing connection to agent\n"
		call	sub_41A63B

loc_405A85:				; CODE XREF: sub_40377D+22FAj
		mov	eax, 0
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40377D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405A92	proc near		; CODE XREF: sub_405EA8+886p

Str1		= dword	ptr -448h
Str2		= dword	ptr -444h
Count		= dword	ptr -440h
File		= dword	ptr -43Ch
var_42C		= dword	ptr -42Ch
DstBuf		= byte ptr -420h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 444h
		mov	[ebp+var_10], 0
		jmp	short loc_405AA9
; ---------------------------------------------------------------------------

loc_405AA5:				; CODE XREF: sub_405A92+33j
		add	[ebp+arg_4], 1

loc_405AA9:				; CODE XREF: sub_405A92+11j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405ACF
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_405ACF
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_405AA5
		jmp	short loc_405ACF
; ---------------------------------------------------------------------------

loc_405AC9:				; CODE XREF: sub_405A92+46j
					; sub_405A92+50j
		add	[ebp+arg_4], 1
		jmp	short loc_405AD0
; ---------------------------------------------------------------------------

loc_405ACF:				; CODE XREF: sub_405A92+1Fj
					; sub_405A92+29j ...
		nop

loc_405AD0:				; CODE XREF: sub_405A92+3Bj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_405AC9
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_405AC9
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		jmp	short loc_405AF0
; ---------------------------------------------------------------------------

loc_405AEC:				; CODE XREF: sub_405A92+7Aj
		add	[ebp+arg_4], 1

loc_405AF0:				; CODE XREF: sub_405A92+58j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405B0E
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_405B0E
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_405AEC

loc_405B0E:				; CODE XREF: sub_405A92+66j
					; sub_405A92+70j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405B22
		mov	eax, [ebp+arg_4]
		mov	byte ptr [eax],	0
		add	[ebp+arg_4], 1

loc_405B22:				; CODE XREF: sub_405A92+84j
		mov	eax, ds:dword_428020
		mov	[ebp+var_C], eax
		jmp	short loc_405B57
; ---------------------------------------------------------------------------

loc_405B2C:				; CODE XREF: sub_405A92+C9j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_405B4F
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[esp+448h+Str2], edx ; Str2
		mov	[esp+448h+Str1], eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_405B5F

loc_405B4F:				; CODE XREF: sub_405A92+A2j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_405B57:				; CODE XREF: sub_405A92+98j
		cmp	[ebp+var_C], 0
		jnz	short loc_405B2C
		jmp	short loc_405B60
; ---------------------------------------------------------------------------

loc_405B5F:				; CODE XREF: sub_405A92+BBj
		nop

loc_405B60:				; CODE XREF: sub_405A92+CBj
		cmp	[ebp+var_C], 0
		jnz	short loc_405B8B
		mov	eax, ds:dword_428020
		mov	[ebp+var_C], eax
		jmp	short loc_405B82
; ---------------------------------------------------------------------------

loc_405B70:				; CODE XREF: sub_405A92+F4j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_405B8A
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_405B82:				; CODE XREF: sub_405A92+DCj
		cmp	[ebp+var_C], 0
		jnz	short loc_405B70
		jmp	short loc_405B8B
; ---------------------------------------------------------------------------

loc_405B8A:				; CODE XREF: sub_405A92+E6j
		nop

loc_405B8B:				; CODE XREF: sub_405A92+D2j
					; sub_405A92+F6j
		cmp	[ebp+var_C], 0
		jnz	short loc_405BB7
		mov	eax, ds:dword_429040
		test	eax, eax
		jz	short loc_405BAD
		mov	eax, [ebp+var_14]
		mov	[esp+448h+Str2], eax ; char
		mov	[esp+448h+Str1], offset	aNoHandlerForIn	; "no handler for inquiry `%s' found\n"
		call	sub_41A63B

loc_405BAD:				; CODE XREF: sub_405A92+106j
		mov	eax, 0
		jmp	loc_405E9F
; ---------------------------------------------------------------------------

loc_405BB7:				; CODE XREF: sub_405A92+FDj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		test	eax, eax
		jz	loc_405C49
		mov	eax, [ebp+var_C]
		add	eax, 10h
		mov	[esp+448h+Str1], eax ; VarName
		call	sub_402175
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_42C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_42C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+448h+Count], eax
		mov	eax, [ebp+var_18]
		mov	[esp+448h+Str2], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+448h+Str1], eax
		call	assuan_send_data
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_18]
		mov	[esp+448h+Str1], eax ; void *
		call	sub_406E5D
		cmp	[ebp+var_1C], 0
		jz	loc_405DFE
		mov	eax, [ebp+var_1C]
		mov	[esp+448h+Str1], eax
		call	gpg_strerror
		mov	[esp+448h+Str2], eax ; char
		mov	[esp+448h+Str1], offset	aSendingDataBac	; "sending data	back failed: %s\n"
		call	sub_41A665
		jmp	loc_405DFE
; ---------------------------------------------------------------------------

loc_405C49:				; CODE XREF: sub_405A92+12Dj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_405CD0
		mov	eax, [ebp+var_C]
		add	eax, 10h
		mov	[esp+448h+Str2], offset	Mode ; "r"
		mov	[esp+448h+Str1], eax ; Command
		mov	eax, ds:_popen
		call	eax ; _popen
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_405CA4
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+448h+Str1], eax ; int
		call	strerror
		mov	edx, [ebp+var_C]
		add	edx, 10h
		mov	[esp+448h+Count], eax
		mov	[esp+448h+Str2], edx ; char
		mov	[esp+448h+Str1], offset	aErrorExecuting	; "error executing `%s': %s\n"
		call	sub_41A665
		jmp	loc_405D43
; ---------------------------------------------------------------------------

loc_405CA4:				; CODE XREF: sub_405A92+1E0j
		mov	eax, ds:dword_429040
		test	eax, eax
		jz	loc_405D43
		mov	eax, [ebp+var_C]
		add	eax, 10h
		mov	[esp+448h+Count], eax
		mov	eax, [ebp+var_14]
		mov	[esp+448h+Str2], eax ; char
		mov	[esp+448h+Str1], offset	aHandlingInquir	; "handling inquiry `%s' by running `%s'\n"
		call	sub_41A665
		jmp	short loc_405D43
; ---------------------------------------------------------------------------

loc_405CD0:				; CODE XREF: sub_405A92+1BFj
		mov	edx, offset aRb	; "rb"
		mov	eax, [ebp+var_C]
		add	eax, 10h
		mov	[esp+448h+Str2], edx ; Mode
		mov	[esp+448h+Str1], eax ; Filename
		call	fopen
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_405D1D
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+448h+Str1], eax ; int
		call	strerror
		mov	edx, [ebp+var_C]
		add	edx, 10h
		mov	[esp+448h+Count], eax
		mov	[esp+448h+Str2], edx ; char
		mov	[esp+448h+Str1], offset	aErrorOpeningSS	; "error opening `%s': %s\n"
		call	sub_41A665
		jmp	short loc_405D43
; ---------------------------------------------------------------------------

loc_405D1D:				; CODE XREF: sub_405A92+25Cj
		mov	eax, ds:dword_429040
		test	eax, eax
		jz	short loc_405D43
		mov	eax, [ebp+var_C]
		add	eax, 10h
		mov	[esp+448h+Count], eax
		mov	eax, [ebp+var_14]
		mov	[esp+448h+Str2], eax ; char
		mov	[esp+448h+Str1], offset	aHandlingInqu_0	; "handling inquiry `%s' by returning cont"...
		call	sub_41A665

loc_405D43:				; CODE XREF: sub_405A92+20Dj
					; sub_405A92+219j ...
		cmp	[ebp+var_10], 0
		jnz	short loc_405D95
		mov	eax, 0
		jmp	loc_405E9F
; ---------------------------------------------------------------------------

loc_405D53:				; CODE XREF: sub_405A92+330j
		mov	eax, [ebp+var_20]
		mov	[esp+448h+Count], eax
		lea	eax, [ebp+DstBuf]
		mov	[esp+448h+Str2], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+448h+Str1], eax
		call	assuan_send_data
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_405D96
		mov	eax, [ebp+var_1C]
		mov	[esp+448h+Str1], eax
		call	gpg_strerror
		mov	[esp+448h+Str2], eax ; char
		mov	[esp+448h+Str1], offset	aSendingDataBac	; "sending data	back failed: %s\n"
		call	sub_41A665
		jmp	short loc_405DC4
; ---------------------------------------------------------------------------

loc_405D95:				; CODE XREF: sub_405A92+2B5j
		nop

loc_405D96:				; CODE XREF: sub_405A92+2E4j
		lea	eax, [ebp+DstBuf]
		mov	edx, [ebp+var_10]
		mov	[esp+448h+File], edx ; File
		mov	[esp+448h+Count], 400h ; Count
		mov	[esp+448h+Str2], 1 ; ElementSize
		mov	[esp+448h+Str1], eax ; DstBuf
		call	fread
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_405D53

loc_405DC4:				; CODE XREF: sub_405A92+301j
		mov	eax, [ebp+var_10]
		mov	[esp+448h+Str1], eax ; File
		call	ferror
		test	eax, eax
		jz	short loc_405DFE
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+448h+Str1], eax ; int
		call	strerror
		mov	edx, [ebp+var_C]
		add	edx, 10h
		mov	[esp+448h+Count], eax
		mov	[esp+448h+Str2], edx ; char
		mov	[esp+448h+Str1], offset	aErrorReadingFr	; "error reading from `%s': %s\n"
		call	sub_41A665

loc_405DFE:				; CODE XREF: sub_405A92+191j
					; sub_405A92+1B2j ...
		mov	[esp+448h+Count], 0
		mov	[esp+448h+Str2], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+448h+Str1], eax
		call	assuan_send_data
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_405E3D
		mov	eax, [ebp+var_1C]
		mov	[esp+448h+Str1], eax
		call	gpg_strerror
		mov	[esp+448h+Str2], eax ; char
		mov	[esp+448h+Str1], offset	aSendingDataBac	; "sending data	back failed: %s\n"
		call	sub_41A665

loc_405E3D:				; CODE XREF: sub_405A92+38Ej
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_405E9A
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_405E8F
		mov	eax, [ebp+var_10]
		mov	[esp+448h+Str1], eax ; File
		mov	eax, ds:_pclose
		call	eax ; _pclose
		test	eax, eax
		jz	short loc_405E9A
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+448h+Str1], eax ; int
		call	strerror
		mov	edx, [ebp+var_C]
		add	edx, 10h
		mov	[esp+448h+Count], eax
		mov	[esp+448h+Str2], edx ; char
		mov	[esp+448h+Str1], offset	aErrorRunningSS	; "error running `%s': %s\n"
		call	sub_41A665
		jmp	short loc_405E9A
; ---------------------------------------------------------------------------

loc_405E8F:				; CODE XREF: sub_405A92+3BDj
		mov	eax, [ebp+var_10]
		mov	[esp+448h+Str1], eax ; File
		call	fclose

loc_405E9A:				; CODE XREF: sub_405A92+3B3j
					; sub_405A92+3CEj ...
		mov	eax, 1

loc_405E9F:				; CODE XREF: sub_405A92+120j
					; sub_405A92+2BCj
		add	esp, 444h
		pop	edi
		pop	ebp
		retn
sub_405A92	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405EA8	proc near		; CODE XREF: sub_40377D+5D2p
					; sub_40377D+224Fp

Str		= dword	ptr -58h
Size		= dword	ptr -54h
Count		= dword	ptr -50h
File		= dword	ptr -4Ch
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
C		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0

loc_405EBE:				; CODE XREF: sub_405EA8+94j
					; sub_405EA8+9Bj ...
		lea	eax, [ebp+var_40]
		mov	[esp+58h+Count], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+58h+Size],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str], eax
		call	assuan_read_line
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jz	short loc_405EE8
		mov	eax, [ebp+var_30]
		jmp	locret_406806
; ---------------------------------------------------------------------------

loc_405EE8:				; CODE XREF: sub_405EA8+36j
		cmp	[ebp+arg_4], 0
		jnz	short loc_405EF8
		mov	eax, ds:dword_429040
		cmp	eax, 1
		jle	short loc_405F34

loc_405EF8:				; CODE XREF: sub_405EA8+44j
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 23h
		jnz	short loc_405F34
		mov	eax, ds:_iob
		lea	ecx, [eax+20h]
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_3C]
		mov	[esp+58h+File],	ecx ; File
		mov	[esp+58h+Count], 1 ; Count
		mov	[esp+58h+Size],	edx ; Size
		mov	[esp+58h+Str], eax ; Str
		call	fwrite
		mov	[esp+58h+Str], 0Ah ; Ch
		call	putchar

loc_405F34:				; CODE XREF: sub_405EA8+4Ej
					; sub_405EA8+58j
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 23h
		jz	short loc_405EBE
		mov	eax, [ebp+var_40]
		test	eax, eax
		jz	loc_405EBE
		mov	eax, [ebp+var_40]
		test	eax, eax
		jz	loc_4063DF
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 44h
		jnz	loc_4063DF
		mov	eax, [ebp+var_3C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	loc_4063DF
		mov	eax, ds:File
		test	eax, eax
		jz	loc_4060A3
		mov	[ebp+var_1C], 0
		mov	[ebp+var_10], 2
		mov	eax, [ebp+var_3C]
		add	eax, 2
		mov	[ebp+var_18], eax
		jmp	loc_406090
; ---------------------------------------------------------------------------

loc_405F9C:				; CODE XREF: sub_405EA8+1F0j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_406068
		mov	eax, [ebp+var_10]
		add	eax, 2
		mov	edx, eax
		mov	eax, [ebp+var_40]
		cmp	edx, eax
		jnb	loc_406068
		add	[ebp+var_18], 1
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_405FE2
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_40600E
; ---------------------------------------------------------------------------

loc_405FE2:				; CODE XREF: sub_405EA8+125j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_405FFD
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_40600C
; ---------------------------------------------------------------------------

loc_405FFD:				; CODE XREF: sub_405EA8+142j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_40600C:				; CODE XREF: sub_405EA8+153j
		mov	edx, eax

loc_40600E:				; CODE XREF: sub_405EA8+138j
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_40602C
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		jmp	short loc_406059
; ---------------------------------------------------------------------------

loc_40602C:				; CODE XREF: sub_405EA8+171j
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_40604A
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 37h
		jmp	short loc_406059
; ---------------------------------------------------------------------------

loc_40604A:				; CODE XREF: sub_405EA8+18Fj
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 57h

loc_406059:				; CODE XREF: sub_405EA8+182j
					; sub_405EA8+1A0j
		add	eax, edx
		mov	[ebp+var_1C], eax
		add	[ebp+var_18], 1
		add	[ebp+var_10], 1
		jmp	short loc_406074
; ---------------------------------------------------------------------------

loc_406068:				; CODE XREF: sub_405EA8+FCj
					; sub_405EA8+10Fj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_1C], eax

loc_406074:				; CODE XREF: sub_405EA8+1BEj
		mov	eax, ds:File
		mov	[esp+58h+Size],	eax ; File
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Str], eax ; Ch
		call	putc
		add	[ebp+var_10], 1
		add	[ebp+var_18], 1

loc_406090:				; CODE XREF: sub_405EA8+EFj
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_40]
		cmp	edx, eax
		jb	loc_405F9C
		jmp	loc_4063DA
; ---------------------------------------------------------------------------

loc_4060A3:				; CODE XREF: sub_405EA8+D2j
		mov	eax, ds:dword_42904C
		test	eax, eax
		jz	loc_406225
		mov	[ebp+var_C], 2
		jmp	loc_406212
; ---------------------------------------------------------------------------

loc_4060BC:				; CODE XREF: sub_405EA8+372j
		mov	eax, [ebp+var_C]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_C]
		lea	edx, [eax-2]
		mov	eax, offset aD04x ; "D[%04X] "
		mov	[esp+58h+Size],	edx
		mov	[esp+58h+Str], eax ; Format
		call	printf
		mov	[ebp+var_10], 0
		jmp	short loc_406150
; ---------------------------------------------------------------------------

loc_4060E2:				; CODE XREF: sub_405EA8+2ACj
		cmp	[ebp+var_10], 8
		jnz	short loc_4060F4
		mov	[esp+58h+Str], 20h ; Ch
		call	putchar

loc_4060F4:				; CODE XREF: sub_405EA8+23Ej
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_40]
		cmp	edx, eax
		jnb	short loc_40611F
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+var_C]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset a02x ; " %02X"
		mov	[esp+58h+Size],	edx
		mov	[esp+58h+Str], eax ; Format
		call	printf
		jmp	short loc_406148
; ---------------------------------------------------------------------------

loc_40611F:				; CODE XREF: sub_405EA8+254j
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset asc_424408 ; "   "
		mov	[esp+58h+File],	edx ; File
		mov	[esp+58h+Count], 3 ; Count
		mov	[esp+58h+Size],	1 ; Size
		mov	[esp+58h+Str], eax ; Str
		call	fwrite

loc_406148:				; CODE XREF: sub_405EA8+275j
		add	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_406150:				; CODE XREF: sub_405EA8+238j
		cmp	[ebp+var_10], 0Fh
		jle	short loc_4060E2
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset asc_424408 ; "   "
		mov	[esp+58h+File],	edx ; File
		mov	[esp+58h+Count], 3 ; Count
		mov	[esp+58h+Size],	1 ; Size
		mov	[esp+58h+Str], eax ; Str
		call	fwrite
		mov	eax, [ebp+var_34]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	short loc_406200
; ---------------------------------------------------------------------------

loc_40618E:				; CODE XREF: sub_405EA8+35Cj
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+var_C]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+C], eax
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_40]
		cmp	edx, eax
		jb	short loc_4061B7
		mov	[esp+58h+Str], 20h ; Ch
		call	putchar
		jmp	short loc_4061F8
; ---------------------------------------------------------------------------

loc_4061B7:				; CODE XREF: sub_405EA8+2FFj
		cmp	[ebp+C], 7Fh
		ja	short loc_4061EC
		mov	eax, [ebp+C]
		mov	[esp+58h+Str], eax ; C
		mov	eax, ds:isprint
		call	eax ; isprint
		test	eax, eax
		jz	short loc_4061EC
		mov	eax, [ebp+C]
		mov	[esp+58h+Str], eax ; C
		mov	eax, ds:iscntrl
		call	eax ; iscntrl
		test	eax, eax
		jnz	short loc_4061EC
		mov	eax, [ebp+C]
		mov	[esp+58h+Str], eax ; Ch
		call	putchar
		jmp	short loc_4061F8
; ---------------------------------------------------------------------------

loc_4061EC:				; CODE XREF: sub_405EA8+313j
					; sub_405EA8+324j ...
		mov	[esp+58h+Str], 2Eh ; Ch
		call	putchar

loc_4061F8:				; CODE XREF: sub_405EA8+30Dj
					; sub_405EA8+342j
		add	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_406200:				; CODE XREF: sub_405EA8+2E4j
		cmp	[ebp+var_10], 0Fh
		jle	short loc_40618E
		mov	[esp+58h+Str], 0Ah ; Ch
		call	putchar

loc_406212:				; CODE XREF: sub_405EA8+20Fj
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_40]
		cmp	edx, eax
		jb	loc_4060BC
		jmp	loc_4063DA
; ---------------------------------------------------------------------------

loc_406225:				; CODE XREF: sub_405EA8+202j
		mov	eax, ds:dword_429050
		test	eax, eax
		jz	loc_4063A3
		mov	[ebp+var_24], 1
		mov	[ebp+var_28], 0
		mov	[ebp+var_10], 2
		mov	eax, [ebp+var_3C]
		add	eax, 2
		mov	[ebp+var_20], eax
		jmp	loc_406383
; ---------------------------------------------------------------------------

loc_406255:				; CODE XREF: sub_405EA8+4E3j
		cmp	[ebp+var_24], 0
		jz	short loc_40628B
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aD	; "D "
		mov	[esp+58h+File],	edx ; File
		mov	[esp+58h+Count], 2 ; Count
		mov	[esp+58h+Size],	1 ; Size
		mov	[esp+58h+Str], eax ; Str
		call	fwrite
		mov	[ebp+var_24], 0

loc_40628B:				; CODE XREF: sub_405EA8+3B1j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_406357
		mov	eax, [ebp+var_10]
		add	eax, 2
		mov	edx, eax
		mov	eax, [ebp+var_40]
		cmp	edx, eax
		jnb	loc_406357
		add	[ebp+var_20], 1
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_4062D1
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_4062FD
; ---------------------------------------------------------------------------

loc_4062D1:				; CODE XREF: sub_405EA8+414j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_4062EC
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_4062FB
; ---------------------------------------------------------------------------

loc_4062EC:				; CODE XREF: sub_405EA8+431j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_4062FB:				; CODE XREF: sub_405EA8+442j
		mov	edx, eax

loc_4062FD:				; CODE XREF: sub_405EA8+427j
		mov	eax, [ebp+var_20]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_40631B
		mov	eax, [ebp+var_20]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		jmp	short loc_406348
; ---------------------------------------------------------------------------

loc_40631B:				; CODE XREF: sub_405EA8+460j
		mov	eax, [ebp+var_20]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_406339
		mov	eax, [ebp+var_20]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 37h
		jmp	short loc_406348
; ---------------------------------------------------------------------------

loc_406339:				; CODE XREF: sub_405EA8+47Ej
		mov	eax, [ebp+var_20]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 57h

loc_406348:				; CODE XREF: sub_405EA8+471j
					; sub_405EA8+48Fj
		add	eax, edx
		mov	[ebp+var_28], eax
		add	[ebp+var_20], 1
		add	[ebp+var_10], 1
		jmp	short loc_406363
; ---------------------------------------------------------------------------

loc_406357:				; CODE XREF: sub_405EA8+3EBj
					; sub_405EA8+3FEj
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_28], eax

loc_406363:				; CODE XREF: sub_405EA8+4ADj
		cmp	[ebp+var_28], 0Ah
		jnz	short loc_406370
		mov	[ebp+var_24], 1

loc_406370:				; CODE XREF: sub_405EA8+4BFj
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str], eax ; Ch
		call	putchar
		add	[ebp+var_10], 1
		add	[ebp+var_20], 1

loc_406383:				; CODE XREF: sub_405EA8+3A8j
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_40]
		cmp	edx, eax
		jb	loc_406255
		cmp	[ebp+var_28], 0Ah
		setnz	al
		movzx	eax, al
		mov	[ebp+var_14], eax
		jmp	loc_406801
; ---------------------------------------------------------------------------

loc_4063A3:				; CODE XREF: sub_405EA8+384j
		mov	eax, ds:_iob
		lea	ecx, [eax+20h]
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_3C]
		mov	[esp+58h+File],	ecx ; File
		mov	[esp+58h+Count], 1 ; Count
		mov	[esp+58h+Size],	edx ; Size
		mov	[esp+58h+Str], eax ; Str
		call	fwrite
		mov	[esp+58h+Str], 0Ah ; Ch
		call	putchar
		jmp	loc_406801
; ---------------------------------------------------------------------------

loc_4063DA:				; CODE XREF: sub_405EA8+1F6j
					; sub_405EA8+378j
		jmp	loc_406801
; ---------------------------------------------------------------------------

loc_4063DF:				; CODE XREF: sub_405EA8+A6j
					; sub_405EA8+B4j ...
		cmp	[ebp+var_14], 0
		jz	short loc_406412
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_4063FF
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_40640B

loc_4063FF:				; CODE XREF: sub_405EA8+544j
		mov	[esp+58h+Str], 0Ah ; Ch
		call	putchar

loc_40640B:				; CODE XREF: sub_405EA8+555j
		mov	[ebp+var_14], 0

loc_406412:				; CODE XREF: sub_405EA8+53Bj
		mov	eax, [ebp+var_40]
		test	eax, eax
		jz	short loc_406492
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 53h
		jnz	short loc_406492
		mov	eax, [ebp+var_3C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40643D
		mov	eax, [ebp+var_3C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_406492

loc_40643D:				; CODE XREF: sub_405EA8+586j
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_40645B
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	loc_4067FD

loc_40645B:				; CODE XREF: sub_405EA8+59Cj
		mov	eax, ds:_iob
		lea	ecx, [eax+20h]
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_3C]
		mov	[esp+58h+File],	ecx ; File
		mov	[esp+58h+Count], 1 ; Count
		mov	[esp+58h+Size],	edx ; Size
		mov	[esp+58h+Str], eax ; Str
		call	fwrite
		mov	[esp+58h+Str], 0Ah ; Ch
		call	putchar
		jmp	loc_4067FD
; ---------------------------------------------------------------------------

loc_406492:				; CODE XREF: sub_405EA8+56Fj
					; sub_405EA8+579j ...
		mov	eax, [ebp+var_40]
		cmp	eax, 1
		jbe	loc_406541
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 4Fh
		jnz	loc_406541
		mov	eax, [ebp+var_3C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 4Bh
		jnz	loc_406541
		mov	eax, [ebp+var_3C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4064D7
		mov	eax, [ebp+var_3C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_406541

loc_4064D7:				; CODE XREF: sub_405EA8+620j
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_4064F1
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_406523

loc_4064F1:				; CODE XREF: sub_405EA8+636j
		mov	eax, ds:_iob
		lea	ecx, [eax+20h]
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_3C]
		mov	[esp+58h+File],	ecx ; File
		mov	[esp+58h+Count], 1 ; Count
		mov	[esp+58h+Size],	edx ; Size
		mov	[esp+58h+Str], eax ; Str
		call	fwrite
		mov	[esp+58h+Str], 0Ah ; Ch
		call	putchar

loc_406523:				; CODE XREF: sub_405EA8+647j
		mov	[esp+58h+Size],	0 ; int
		mov	[esp+58h+Str], offset a? ; "?"
		call	sub_401E48
		mov	eax, 0
		jmp	locret_406806
; ---------------------------------------------------------------------------

loc_406541:				; CODE XREF: sub_405EA8+5F0j
					; sub_405EA8+5FEj ...
		mov	eax, [ebp+var_40]
		cmp	eax, 2
		jbe	loc_40663B
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 45h
		jnz	loc_40663B
		mov	eax, [ebp+var_3C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 52h
		jnz	loc_40663B
		mov	eax, [ebp+var_3C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 52h
		jnz	loc_40663B
		mov	eax, [ebp+var_3C]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40659B
		mov	eax, [ebp+var_3C]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	loc_40663B

loc_40659B:				; CODE XREF: sub_405EA8+6E0j
		mov	eax, [ebp+var_3C]
		add	eax, 3
		mov	[esp+58h+Count], 0Ah ; Radix
		mov	[esp+58h+Size],	0 ; EndPtr
		mov	[esp+58h+Str], eax ; Str
		call	strtol
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jnz	short loc_4065C9
		mov	[ebp+var_2C], 0FFFFFFFFh

loc_4065C9:				; CODE XREF: sub_405EA8+718j
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Size],	eax ; int
		mov	[esp+58h+Str], offset a? ; "?"
		call	sub_401E48
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_4065F6
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_406628

loc_4065F6:				; CODE XREF: sub_405EA8+73Bj
		mov	eax, ds:_iob
		lea	ecx, [eax+20h]
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_3C]
		mov	[esp+58h+File],	ecx ; File
		mov	[esp+58h+Count], 1 ; Count
		mov	[esp+58h+Size],	edx ; Size
		mov	[esp+58h+Str], eax ; Str
		call	fwrite
		mov	[esp+58h+Str], 0Ah ; Ch
		call	putchar

loc_406628:				; CODE XREF: sub_405EA8+74Cj
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 1
		mov	eax, 0
		jmp	locret_406806
; ---------------------------------------------------------------------------

loc_40663B:				; CODE XREF: sub_405EA8+69Fj
					; sub_405EA8+6ADj ...
		mov	eax, [ebp+var_40]
		cmp	eax, 6
		jbe	loc_406753
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 49h
		jnz	loc_406753
		mov	eax, [ebp+var_3C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 4Eh
		jnz	loc_406753
		mov	eax, [ebp+var_3C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 51h
		jnz	loc_406753
		mov	eax, [ebp+var_3C]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 55h
		jnz	loc_406753
		mov	eax, [ebp+var_3C]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		cmp	al, 49h
		jnz	loc_406753
		mov	eax, [ebp+var_3C]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 52h
		jnz	loc_406753
		mov	eax, [ebp+var_3C]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		cmp	al, 45h
		jnz	loc_406753
		mov	eax, [ebp+var_3C]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4066D5
		mov	eax, [ebp+var_3C]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_406753

loc_4066D5:				; CODE XREF: sub_405EA8+81Ej
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_4066EF
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_406721

loc_4066EF:				; CODE XREF: sub_405EA8+834j
		mov	eax, ds:_iob
		lea	ecx, [eax+20h]
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_3C]
		mov	[esp+58h+File],	ecx ; File
		mov	[esp+58h+Count], 1 ; Count
		mov	[esp+58h+Size],	edx ; Size
		mov	[esp+58h+Str], eax ; Str
		call	fwrite
		mov	[esp+58h+Str], 0Ah ; Ch
		call	putchar

loc_406721:				; CODE XREF: sub_405EA8+845j
		mov	eax, [ebp+var_3C]
		mov	[esp+58h+Size],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str], eax
		call	sub_405A92
		test	eax, eax
		jnz	loc_406801
		mov	[esp+58h+Size],	offset aCancel ; "CANCEL"
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str], eax
		call	assuan_write_line
		jmp	loc_406801
; ---------------------------------------------------------------------------

loc_406753:				; CODE XREF: sub_405EA8+799j
					; sub_405EA8+7A7j ...
		mov	eax, [ebp+var_40]
		cmp	eax, 2
		jbe	loc_4067EF
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		cmp	al, 45h
		jnz	loc_4067EF
		mov	eax, [ebp+var_3C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 4Eh
		jnz	short loc_4067EF
		mov	eax, [ebp+var_3C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 44h
		jnz	short loc_4067EF
		mov	eax, [ebp+var_3C]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4067A1
		mov	eax, [ebp+var_3C]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_4067EF

loc_4067A1:				; CODE XREF: sub_405EA8+8EAj
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_4067BB
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_406800

loc_4067BB:				; CODE XREF: sub_405EA8+900j
		mov	eax, ds:_iob
		lea	ecx, [eax+20h]
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_3C]
		mov	[esp+58h+File],	ecx ; File
		mov	[esp+58h+Count], 1 ; Count
		mov	[esp+58h+Size],	edx ; Size
		mov	[esp+58h+Str], eax ; Str
		call	fwrite
		mov	[esp+58h+Str], 0Ah ; Ch
		call	putchar
		jmp	short loc_406800
; ---------------------------------------------------------------------------

loc_4067EF:				; CODE XREF: sub_405EA8+8B1j
					; sub_405EA8+8BFj ...
		mov	[esp+58h+Str], 104h
		call	sub_401577
		jmp	short locret_406806
; ---------------------------------------------------------------------------

loc_4067FD:				; CODE XREF: sub_405EA8+5ADj
					; sub_405EA8+5E5j
		nop
		jmp	short loc_406801
; ---------------------------------------------------------------------------

loc_406800:				; CODE XREF: sub_405EA8+911j
					; sub_405EA8+945j
		nop

loc_406801:				; CODE XREF: sub_405EA8+4F6j
					; sub_405EA8+52Dj ...
		jmp	loc_405EBE
; ---------------------------------------------------------------------------

locret_406806:				; CODE XREF: sub_405EA8+3Bj
					; sub_405EA8+694j ...
		leave
		retn
sub_405EA8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406808	proc near		; CODE XREF: sub_40377D:loc_403D13p

VarName		= dword	ptr -68h
Val		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
lpApplicationName= dword ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_18		= dword	ptr -18h
Str		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 64h
		mov	[ebp+var_C], 0
		mov	[esp+68h+VarName], offset VarName ; "GPG_AGENT_INFO"
		call	getenv
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jz	short loc_406839
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4069E5

loc_406839:				; CODE XREF: sub_406808+21j
		lea	eax, [ebp+var_30]
		mov	[esp+68h+VarName], eax
		call	assuan_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_406874
		mov	eax, [ebp+var_C]
		mov	[esp+68h+VarName], eax
		call	gpg_strerror
		mov	[esp+68h+Val], eax ; char
		mov	[esp+68h+VarName], offset aAssuan_newFail ; "assuan_new	failed:	%s\n"
		call	sub_41A665
		mov	[esp+68h+VarName], 1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_406874:				; CODE XREF: sub_406808+43j
		mov	eax, ds:dword_429048
		mov	[esp+68h+var_60], 0
		mov	[esp+68h+Val], offset aS_gpgAgent ; "S.gpg-agent"
		mov	[esp+68h+VarName], eax
		call	sub_41B167
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_30]
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_60], 0
		mov	edx, [ebp+var_20]
		mov	[esp+68h+Val], edx ; char
		mov	[esp+68h+VarName], eax
		call	assuan_socket_connect
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+68h+VarName], eax
		call	sub_401592
		cmp	eax, 103h
		jnz	loc_4069D5
		mov	eax, [ebp+var_C]
		mov	[ebp+var_24], eax
		mov	eax, ds:dword_429040
		test	eax, eax
		jz	short loc_4068F2
		mov	[esp+68h+VarName], offset aNoRunningGpgAg ; "no	running	gpg-agent - starting one\n"
		call	sub_419D7C
		mov	[esp+68h+VarName], eax ; char *
		call	sub_41A63B

loc_4068F2:				; CODE XREF: sub_406808+D4j
		mov	[esp+68h+VarName], 1
		call	sub_40A3B2
		mov	[ebp+lpApplicationName], eax
		mov	[ebp+var_3C], offset aDaemon ; "--daemon"
		mov	[ebp+var_38], offset aUseStandardSoc ; "--use-standard-socket"
		mov	[ebp+var_34], 0
		mov	[esp+68h+var_60], 0
		lea	eax, [ebp+var_3C]
		mov	[esp+68h+Val], eax ; int
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+68h+VarName], eax ; lpApplicationName
		call	sub_40CDF2
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40695D
		mov	eax, [ebp+var_C]
		mov	[esp+68h+VarName], eax
		call	gpg_strerror
		mov	[esp+68h+var_60], eax
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+68h+Val], eax ; char
		mov	[esp+68h+VarName], offset aFailedToStartA ; "failed to start agent `%s': %s\n"
		call	sub_41A702
		jmp	short loc_4069C9
; ---------------------------------------------------------------------------

loc_40695D:				; CODE XREF: sub_406808+12Fj
		mov	[esp+68h+VarName], 3
		call	sub_40B9F9
		lea	eax, [ebp+var_30]
		mov	[esp+68h+VarName], eax
		call	assuan_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4069A4
		mov	eax, [ebp+var_C]
		mov	[esp+68h+VarName], eax
		call	gpg_strerror
		mov	[esp+68h+Val], eax ; char
		mov	[esp+68h+VarName], offset aAssuan_newFail ; "assuan_new	failed:	%s\n"
		call	sub_41A665
		mov	[esp+68h+VarName], 1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4069A4:				; CODE XREF: sub_406808+173j
		mov	eax, [ebp+var_30]
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_60], 0
		mov	edx, [ebp+var_20]
		mov	[esp+68h+Val], edx
		mov	[esp+68h+VarName], eax
		call	assuan_socket_connect
		mov	[ebp+var_C], eax

loc_4069C9:				; CODE XREF: sub_406808+153j
		cmp	[ebp+var_C], 0
		jz	short loc_4069D5
		mov	eax, [ebp+var_24]
		mov	[ebp+var_C], eax

loc_4069D5:				; CODE XREF: sub_406808+C1j
					; sub_406808+1C5j
		mov	eax, [ebp+var_20]
		mov	[esp+68h+VarName], eax ; void *
		call	sub_406E5D
		jmp	loc_406B38
; ---------------------------------------------------------------------------

loc_4069E5:				; CODE XREF: sub_406808+2Bj
		mov	eax, [ebp+Str]
		mov	[esp+68h+VarName], eax ; char *
		call	sub_406E03
		mov	[ebp+Str], eax
		mov	[esp+68h+Val], 3Bh ; char
		mov	eax, [ebp+Str]
		mov	[esp+68h+VarName], eax ; Str
		call	strchr
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_406A17
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+Str]
		jnz	short loc_406A42

loc_406A17:				; CODE XREF: sub_406808+205j
		mov	[esp+68h+VarName], offset aMalformedGpg_a ; "malformed GPG_AGENT_INFO environment va"...
		call	sub_419D7C
		mov	[esp+68h+VarName], eax ; char *
		call	sub_41A665
		mov	eax, [ebp+Str]
		mov	[esp+68h+VarName], eax ; void *
		call	sub_406E5D
		mov	[esp+68h+VarName], 1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_406A42:				; CODE XREF: sub_406808+20Dj
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[esp+68h+VarName], eax ; Str
		call	atoi
		mov	[ebp+var_18], eax
		jmp	short loc_406A60
; ---------------------------------------------------------------------------

loc_406A5C:				; CODE XREF: sub_406808+26Aj
		add	[ebp+var_10], 1

loc_406A60:				; CODE XREF: sub_406808+252j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406A74
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Bh
		jnz	short loc_406A5C

loc_406A74:				; CODE XREF: sub_406808+260j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406A8E
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[esp+68h+VarName], eax ; Str
		call	atoi
		jmp	short loc_406A93
; ---------------------------------------------------------------------------

loc_406A8E:				; CODE XREF: sub_406808+274j
		mov	eax, 0

loc_406A93:				; CODE XREF: sub_406808+284j
		mov	dword ptr [ebp+var_1C],	eax
		cmp	dword ptr [ebp+var_1C],	1
		jz	short loc_406ACE
		mov	[esp+68h+VarName], offset aGpgAgentProtoc ; "gpg-agent protocol	version	%d is not su"...
		call	sub_419D7C
		mov	edx, dword ptr [ebp+var_1C]
		mov	[esp+68h+Val], edx ; char
		mov	[esp+68h+VarName], eax ; char *
		call	sub_41A665
		mov	eax, [ebp+Str]
		mov	[esp+68h+VarName], eax ; void *
		call	sub_406E5D
		mov	[esp+68h+VarName], 1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_406ACE:				; CODE XREF: sub_406808+292j
		lea	eax, [ebp+var_30]
		mov	[esp+68h+VarName], eax
		call	assuan_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_406B09
		mov	eax, [ebp+var_C]
		mov	[esp+68h+VarName], eax
		call	gpg_strerror
		mov	[esp+68h+Val], eax ; char
		mov	[esp+68h+VarName], offset aAssuan_newFail ; "assuan_new	failed:	%s\n"
		call	sub_41A665
		mov	[esp+68h+VarName], 1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_406B09:				; CODE XREF: sub_406808+2D8j
		mov	eax, [ebp+var_30]
		mov	[esp+68h+var_5C], 0
		mov	edx, [ebp+var_18]
		mov	[esp+68h+var_60], edx
		mov	edx, [ebp+Str]
		mov	[esp+68h+Val], edx ; char
		mov	[esp+68h+VarName], eax
		call	assuan_socket_connect
		mov	[ebp+var_C], eax
		mov	eax, [ebp+Str]
		mov	[esp+68h+VarName], eax ; void *
		call	sub_406E5D

loc_406B38:				; CODE XREF: sub_406808+1D8j
		cmp	[ebp+var_C], 0
		jz	short loc_406B65
		mov	eax, [ebp+var_C]
		mov	[esp+68h+VarName], eax
		call	gpg_strerror
		mov	[esp+68h+Val], eax ; char
		mov	[esp+68h+VarName], offset aCanTConnectToT ; "can't connect to the agent: %s\n"
		call	sub_41A665
		mov	[esp+68h+VarName], 1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_406B65:				; CODE XREF: sub_406808+334j
		mov	eax, ds:dword_429040
		test	eax, eax
		jz	short loc_406B7A
		mov	[esp+68h+VarName], offset aConnectionToAg ; "connection	to agent established\n"
		call	sub_41A63B

loc_406B7A:				; CODE XREF: sub_406808+364j
		mov	eax, [ebp+var_30]
		mov	[esp+68h+var_4C], 0
		mov	[esp+68h+var_50], 0
		mov	[esp+68h+var_54], 0
		mov	[esp+68h+var_58], 0
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_60], 0
		mov	[esp+68h+Val], offset aReset ; "RESET"
		mov	[esp+68h+VarName], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_406BFF
		mov	eax, [ebp+var_C]
		mov	[esp+68h+VarName], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+68h+VarName], offset aErrorSendingSC ; "error sending %s command: %s\n"
		call	sub_419D7C
		mov	[esp+68h+var_60], ebx
		mov	[esp+68h+Val], offset aReset ; "RESET"
		mov	[esp+68h+VarName], eax ; char *
		call	sub_41A665
		mov	[esp+68h+VarName], 1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_406BFF:				; CODE XREF: sub_406808+3BCj
		call	sub_40D038
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jnz	short loc_406C2E
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+VarName], eax ; int
		call	strerror
		mov	[esp+68h+Val], eax ; char
		mov	[esp+68h+VarName], offset aErrorAllocatin ; "error allocating session environment bl"...
		call	sub_41A6A8
; ---------------------------------------------------------------------------

loc_406C2E:				; CODE XREF: sub_406808+403j
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	[esp+68h+var_58], edx
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_60], 0
		mov	[esp+68h+Val], 0
		mov	[esp+68h+VarName], eax
		call	sub_40DAA2
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+VarName], eax ; void *
		call	sub_40D0B3
		cmp	[ebp+var_C], 0
		jz	short loc_406C9D
		mov	eax, [ebp+var_C]
		mov	[esp+68h+VarName], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+68h+VarName], offset aErrorSendingSt ; "error sending standard options: %s\n"
		call	sub_419D7C
		mov	[esp+68h+Val], ebx ; char
		mov	[esp+68h+VarName], eax ; char *
		call	sub_41A665
		mov	[esp+68h+VarName], 1 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_406C9D:				; CODE XREF: sub_406808+462j
		mov	eax, [ebp+var_30]
		add	esp, 64h
		pop	ebx
		pop	ebp
		retn
sub_406808	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_406CA8	proc near		; CODE XREF: sub_406D00+1Ap
					; sub_406D93+21p ...

var_18		= dword	ptr -18h
var_14		= byte ptr -14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+18h+var_18], eax ;	int
		call	strerror
		mov	ebx, eax
		mov	[esp+18h+var_18], offset aErrorAllocat_0 ; "error allocating enough memory: %s\n"
		call	sub_419D7C
		mov	dword ptr [esp+18h+var_14], ebx	; char
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_41A6A8
sub_406CA8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406CDA(size_t)
sub_406CDA	proc near		; CODE XREF: sub_409833+21p
					; sub_40AA80+28p ...

Size		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Size],	eax ; Size
		call	malloc
		leave
		retn
sub_406CDA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406CED(size_t)
sub_406CED	proc near		; CODE XREF: .text:0040AAF8p

Size		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Size],	eax ; Size
		call	malloc
		leave
		retn
sub_406CED	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406D00(size_t)
sub_406D00	proc near		; CODE XREF: sub_401661+16p
					; sub_4016C2+1C3p ...

Size		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_406D1F
		call	sub_406CA8
; ---------------------------------------------------------------------------

loc_406D1F:				; CODE XREF: sub_406D00+18j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_406D00	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406D24(char *)
sub_406D24	proc near		; CODE XREF: sub_40DAA2+148p
					; sub_41AE02+1B9p ...

Size		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
Dest		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jz	short loc_406D70
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax ;	Source
		mov	eax, [ebp+Dest]
		mov	[esp+38h+Size],	eax ; Dest
		call	strcpy

loc_406D70:				; CODE XREF: sub_406D24+38j
		mov	eax, [ebp+Dest]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_406D24	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406D79(void *, size_t)
sub_406D79	proc near		; CODE XREF: sub_40AB20+54p
					; sub_40B7B0+117p ...

Memory		= dword	ptr -18h
NewSize		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+NewSize], eax ; NewSize
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	realloc
		leave
		retn
sub_406D79	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406D93(void *, size_t)
sub_406D93	proc near		; CODE XREF: sub_40B337+174p
					; .text:0041805Fp

Memory		= dword	ptr -28h
NewSize		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+NewSize], eax ; NewSize
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Memory], eax ;	Memory
		call	realloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_406DB9
		call	sub_406CA8
; ---------------------------------------------------------------------------

loc_406DB9:				; CODE XREF: sub_406D93+1Fj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_406D93	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406DBE(size_t, size_t)
sub_406DBE	proc near		; CODE XREF: sub_40D038+15p
					; sub_40D038+4Dp ...

NumOfElements	= dword	ptr -18h
SizeOfElements	= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+SizeOfElements], eax ;	SizeOfElements
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+NumOfElements], eax ; NumOfElements
		call	calloc
		leave
		retn
sub_406DBE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406DD8(size_t, size_t)
sub_406DD8	proc near		; CODE XREF: sub_4142EA+121p
					; sub_415654+15p ...

NumOfElements	= dword	ptr -28h
SizeOfElements	= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+SizeOfElements], eax ;	SizeOfElements
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+NumOfElements], eax ; NumOfElements
		call	calloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_406DFE
		call	sub_406CA8
; ---------------------------------------------------------------------------

loc_406DFE:				; CODE XREF: sub_406DD8+1Fj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_406DD8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406E03(char *)
sub_406E03	proc near		; CODE XREF: sub_401D70+BAp
					; sub_401F1C+252p ...

Size		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
Dest		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jnz	short loc_406E42
		call	sub_406CA8
; ---------------------------------------------------------------------------

loc_406E42:				; CODE XREF: sub_406E03+38j
		mov	eax, [ebp+Dest]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Size],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+Dest]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_406E03	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406E5D(void *)
sub_406E5D	proc near		; CODE XREF: sub_401661+40p
					; sub_401D70+A9p ...

Memory		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_406E74
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

locret_406E74:				; CODE XREF: sub_406E5D+Aj
		leave
		retn
sub_406E5D	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406E80	proc near		; CODE XREF: .text:00413C36p
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_406E80	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406E85	proc near		; CODE XREF: .text:00413C22p
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_406E85	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406E8A	proc near		; CODE XREF: .text:00413C0Ep
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_406E8A	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406E90	proc near		; CODE XREF: sub_40377D+40p
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_406E90	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406E98	proc near		; CODE XREF: sub_407099+6E9p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 12h	; switch 19 cases
		ja	loc_407097	; jumptable 00406EB1 default case
		mov	eax, ds:off_4245D8[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_406EB3:				; CODE XREF: sub_406E98+19j
					; DATA XREF: .rdata:off_4245D8o
		mov	eax, [ebp+arg_0] ; jumptable 00406EB1 case 0
		mov	dword ptr [eax+24h], 0
		jmp	loc_407097	; jumptable 00406EB1 default case
; ---------------------------------------------------------------------------

loc_406EC2:				; CODE XREF: sub_406E98+19j
					; DATA XREF: .rdata:off_4245D8o
		mov	eax, [ebp+arg_0] ; jumptable 00406EB1 case 1
		mov	eax, [eax+10h]
		cmp	eax, 7		; switch 8 cases
		ja	short loc_406F2A ; jumptable 00406ED4 default case
		mov	eax, ds:off_424624[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_406ED6:				; CODE XREF: sub_406E98+3Cj
					; DATA XREF: .rdata:off_424624o
		mov	eax, [ebp+arg_0] ; jumptable 00406ED4 case 1
		mov	dword ptr [eax+24h], 2
		jmp	short loc_406F35
; ---------------------------------------------------------------------------

loc_406EE2:				; CODE XREF: sub_406E98+3Cj
					; DATA XREF: .rdata:off_424624o
		mov	eax, [ebp+arg_0] ; jumptable 00406ED4 case 2
		mov	dword ptr [eax+24h], 4
		jmp	short loc_406F35
; ---------------------------------------------------------------------------

loc_406EEE:				; CODE XREF: sub_406E98+3Cj
					; DATA XREF: .rdata:off_424624o
		mov	eax, [ebp+arg_0] ; jumptable 00406ED4 case 3
		mov	dword ptr [eax+24h], 8
		jmp	short loc_406F35
; ---------------------------------------------------------------------------

loc_406EFA:				; CODE XREF: sub_406E98+3Cj
					; DATA XREF: .rdata:off_424624o
		mov	eax, [ebp+arg_0] ; jumptable 00406ED4 case 4
		mov	dword ptr [eax+24h], 0Ah
		jmp	short loc_406F35
; ---------------------------------------------------------------------------

loc_406F06:				; CODE XREF: sub_406E98+3Cj
					; DATA XREF: .rdata:off_424624o
		mov	eax, [ebp+arg_0] ; jumptable 00406ED4 case 5
		mov	dword ptr [eax+24h], 0Fh
		jmp	short loc_406F35
; ---------------------------------------------------------------------------

loc_406F12:				; CODE XREF: sub_406E98+3Cj
					; DATA XREF: .rdata:off_424624o
		mov	eax, [ebp+arg_0] ; jumptable 00406ED4 case 6
		mov	dword ptr [eax+24h], 11h
		jmp	short loc_406F35
; ---------------------------------------------------------------------------

loc_406F1E:				; CODE XREF: sub_406E98+3Cj
					; DATA XREF: .rdata:off_424624o
		mov	eax, [ebp+arg_0] ; jumptable 00406ED4 case 7
		mov	dword ptr [eax+24h], 12h
		jmp	short loc_406F35
; ---------------------------------------------------------------------------

loc_406F2A:				; CODE XREF: sub_406E98+33j
					; sub_406E98+3Cj
					; DATA XREF: ...
		mov	eax, [ebp+arg_0] ; jumptable 00406ED4 default case
		mov	dword ptr [eax+24h], 6
		nop

loc_406F35:				; CODE XREF: sub_406E98+48j
					; sub_406E98+54j ...
		jmp	loc_407097	; jumptable 00406EB1 default case
; ---------------------------------------------------------------------------

loc_406F3A:				; CODE XREF: sub_406E98+19j
					; DATA XREF: .rdata:off_4245D8o
		mov	eax, [ebp+arg_0] ; jumptable 00406EB1 cases 2-5
		mov	eax, [eax+10h]
		cmp	eax, 7		; switch 8 cases
		ja	short loc_406FA2 ; jumptable 00406F4C default case
		mov	eax, ds:off_424644[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_406F4E:				; CODE XREF: sub_406E98+B4j
					; DATA XREF: .rdata:off_424644o
		mov	eax, [ebp+arg_0] ; jumptable 00406F4C case 1
		mov	dword ptr [eax+24h], 3
		jmp	short loc_406FAD
; ---------------------------------------------------------------------------

loc_406F5A:				; CODE XREF: sub_406E98+B4j
					; DATA XREF: .rdata:off_424644o
		mov	eax, [ebp+arg_0] ; jumptable 00406F4C case 2
		mov	dword ptr [eax+24h], 5
		jmp	short loc_406FAD
; ---------------------------------------------------------------------------

loc_406F66:				; CODE XREF: sub_406E98+B4j
					; DATA XREF: .rdata:off_424644o
		mov	eax, [ebp+arg_0] ; jumptable 00406F4C case 3
		mov	dword ptr [eax+24h], 9
		jmp	short loc_406FAD
; ---------------------------------------------------------------------------

loc_406F72:				; CODE XREF: sub_406E98+B4j
					; DATA XREF: .rdata:off_424644o
		mov	eax, [ebp+arg_0] ; jumptable 00406F4C case 4
		mov	dword ptr [eax+24h], 0Bh
		jmp	short loc_406FAD
; ---------------------------------------------------------------------------

loc_406F7E:				; CODE XREF: sub_406E98+B4j
					; DATA XREF: .rdata:off_424644o
		mov	eax, [ebp+arg_0] ; jumptable 00406F4C case 5
		mov	dword ptr [eax+24h], 10h
		jmp	short loc_406FAD
; ---------------------------------------------------------------------------

loc_406F8A:				; CODE XREF: sub_406E98+B4j
					; DATA XREF: .rdata:off_424644o
		mov	eax, [ebp+arg_0] ; jumptable 00406F4C case 6
		mov	dword ptr [eax+24h], 11h
		jmp	short loc_406FAD
; ---------------------------------------------------------------------------

loc_406F96:				; CODE XREF: sub_406E98+B4j
					; DATA XREF: .rdata:off_424644o
		mov	eax, [ebp+arg_0] ; jumptable 00406F4C case 7
		mov	dword ptr [eax+24h], 12h
		jmp	short loc_406FAD
; ---------------------------------------------------------------------------

loc_406FA2:				; CODE XREF: sub_406E98+ABj
					; sub_406E98+B4j
					; DATA XREF: ...
		mov	eax, [ebp+arg_0] ; jumptable 00406F4C default case
		mov	dword ptr [eax+24h], 7
		nop

loc_406FAD:				; CODE XREF: sub_406E98+C0j
					; sub_406E98+CCj ...
		jmp	loc_407097	; jumptable 00406EB1 default case
; ---------------------------------------------------------------------------

loc_406FB2:				; CODE XREF: sub_406E98+19j
					; DATA XREF: .rdata:off_4245D8o
		mov	eax, [ebp+arg_0] ; jumptable 00406EB1 cases 6-13
		mov	eax, [eax+10h]
		cmp	eax, 3
		jz	short loc_406FCE
		cmp	eax, 8
		jnz	short loc_406FDA
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0Dh
		jmp	short loc_406FE5
; ---------------------------------------------------------------------------

loc_406FCE:				; CODE XREF: sub_406E98+123j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0Ch
		jmp	short loc_406FE5
; ---------------------------------------------------------------------------

loc_406FDA:				; CODE XREF: sub_406E98+128j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0Ch
		nop

loc_406FE5:				; CODE XREF: sub_406E98+134j
					; sub_406E98+140j
		jmp	loc_407097	; jumptable 00406EB1 default case
; ---------------------------------------------------------------------------

loc_406FEA:				; CODE XREF: sub_406E98+19j
					; DATA XREF: .rdata:off_4245D8o
		mov	eax, [ebp+arg_0] ; jumptable 00406EB1 case 14
		mov	dword ptr [eax+24h], 6
		jmp	loc_407097	; jumptable 00406EB1 default case
; ---------------------------------------------------------------------------

loc_406FF9:				; CODE XREF: sub_406E98+19j
					; DATA XREF: .rdata:off_4245D8o
		mov	eax, [ebp+arg_0] ; jumptable 00406EB1 case 15
		mov	dword ptr [eax+24h], 0Eh
		jmp	loc_407097	; jumptable 00406EB1 default case
; ---------------------------------------------------------------------------

loc_407008:				; CODE XREF: sub_406E98+19j
					; DATA XREF: .rdata:off_4245D8o
		mov	eax, [ebp+arg_0] ; jumptable 00406EB1 case 16
		mov	dword ptr [eax+24h], 13h
		jmp	loc_407097	; jumptable 00406EB1 default case
; ---------------------------------------------------------------------------

loc_407017:				; CODE XREF: sub_406E98+19j
					; DATA XREF: .rdata:off_4245D8o
		mov	eax, [ebp+arg_0] ; jumptable 00406EB1 case 17
		mov	dword ptr [eax+24h], 0Eh
		jmp	short loc_407097 ; jumptable 00406EB1 default case
; ---------------------------------------------------------------------------

loc_407023:				; CODE XREF: sub_406E98+19j
					; DATA XREF: .rdata:off_4245D8o
		mov	eax, [ebp+arg_0] ; jumptable 00406EB1 case 18
		mov	eax, [eax+10h]
		cmp	eax, 7		; switch 8 cases
		ja	short loc_40708B ; jumptable 00407035 default case
		mov	eax, ds:off_424664[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_407037:				; CODE XREF: sub_406E98+19Dj
					; DATA XREF: .rdata:off_424664o
		mov	eax, [ebp+arg_0] ; jumptable 00407035 case 1
		mov	dword ptr [eax+24h], 15h
		jmp	short loc_407096
; ---------------------------------------------------------------------------

loc_407043:				; CODE XREF: sub_406E98+19Dj
					; DATA XREF: .rdata:off_424664o
		mov	eax, [ebp+arg_0] ; jumptable 00407035 case 2
		mov	dword ptr [eax+24h], 16h
		jmp	short loc_407096
; ---------------------------------------------------------------------------

loc_40704F:				; CODE XREF: sub_406E98+19Dj
					; DATA XREF: .rdata:off_424664o
		mov	eax, [ebp+arg_0] ; jumptable 00407035 case 3
		mov	dword ptr [eax+24h], 18h
		jmp	short loc_407096
; ---------------------------------------------------------------------------

loc_40705B:				; CODE XREF: sub_406E98+19Dj
					; DATA XREF: .rdata:off_424664o
		mov	eax, [ebp+arg_0] ; jumptable 00407035 case 4
		mov	dword ptr [eax+24h], 19h
		jmp	short loc_407096
; ---------------------------------------------------------------------------

loc_407067:				; CODE XREF: sub_406E98+19Dj
					; DATA XREF: .rdata:off_424664o
		mov	eax, [ebp+arg_0] ; jumptable 00407035 case 5
		mov	dword ptr [eax+24h], 1Ah
		jmp	short loc_407096
; ---------------------------------------------------------------------------

loc_407073:				; CODE XREF: sub_406E98+19Dj
					; DATA XREF: .rdata:off_424664o
		mov	eax, [ebp+arg_0] ; jumptable 00407035 case 6
		mov	dword ptr [eax+24h], 1Bh
		jmp	short loc_407096
; ---------------------------------------------------------------------------

loc_40707F:				; CODE XREF: sub_406E98+19Dj
					; DATA XREF: .rdata:off_424664o
		mov	eax, [ebp+arg_0] ; jumptable 00407035 case 7
		mov	dword ptr [eax+24h], 1Ch
		jmp	short loc_407096
; ---------------------------------------------------------------------------

loc_40708B:				; CODE XREF: sub_406E98+194j
					; sub_406E98+19Dj
					; DATA XREF: ...
		mov	eax, [ebp+arg_0] ; jumptable 00407035 default case
		mov	dword ptr [eax+24h], 17h
		nop

loc_407096:				; CODE XREF: sub_406E98+1A9j
					; sub_406E98+1B5j ...
		nop

loc_407097:				; CODE XREF: sub_406E98+Cj
					; sub_406E98+25j ...
		pop	ebp		; jumptable 00406EB1 default case
		retn
sub_406E98	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407099	proc near		; CODE XREF: sub_408EE3+58p

NumOfElements	= dword	ptr -68h
SizeOfElements	= dword	ptr -64h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Memory		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+Memory], eax
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_0], 0
		jnz	loc_40779D
		jmp	loc_4077DC
; ---------------------------------------------------------------------------

loc_4070BD:				; CODE XREF: sub_407099+70Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_407793
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_4077C3
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	loc_407796
		mov	[ebp+var_2C], 0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jle	loc_407189
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_407189
		mov	eax, [ebp+var_C]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_2C], eax
		add	[ebp+var_C], 1
		jmp	short loc_40714E
; ---------------------------------------------------------------------------

loc_40712B:				; CODE XREF: sub_407099+C7j
		mov	edx, [ebp+var_2C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_2C], eax
		add	[ebp+var_C], 1

loc_40714E:				; CODE XREF: sub_407099+90j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_407162
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40712B

loc_407162:				; CODE XREF: sub_407099+BDj
		cmp	[ebp+var_2C], 0
		js	loc_4077C6
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	short loc_40717C
		add	[ebp+var_C], 1
		jmp	short loc_407189
; ---------------------------------------------------------------------------

loc_40717C:				; CODE XREF: sub_407099+DBj
		mov	[ebp+var_2C], 0
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_C], eax

loc_407189:				; CODE XREF: sub_407099+67j
					; sub_407099+75j ...
		mov	[ebp+var_18], 0
		jmp	short loc_4071D3
; ---------------------------------------------------------------------------

loc_407192:				; CODE XREF: sub_407099+142j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 20h	; switch 17 cases
		cmp	eax, 10h
		ja	short loc_4071DF ; jumptable 004071AA default case
		mov	eax, ds:off_424684[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4071AC:				; CODE XREF: sub_407099+111j
					; DATA XREF: .rdata:off_424684o
		or	[ebp+var_18], 1	; jumptable 004071AA case 39
		jmp	short loc_4071CF
; ---------------------------------------------------------------------------

loc_4071B2:				; CODE XREF: sub_407099+111j
					; DATA XREF: .rdata:off_424684o
		or	[ebp+var_18], 2	; jumptable 004071AA case 45
		jmp	short loc_4071CF
; ---------------------------------------------------------------------------

loc_4071B8:				; CODE XREF: sub_407099+111j
					; DATA XREF: .rdata:off_424684o
		or	[ebp+var_18], 4	; jumptable 004071AA case 43
		jmp	short loc_4071CF
; ---------------------------------------------------------------------------

loc_4071BE:				; CODE XREF: sub_407099+111j
					; DATA XREF: .rdata:off_424684o
		or	[ebp+var_18], 8	; jumptable 004071AA case 32
		jmp	short loc_4071CF
; ---------------------------------------------------------------------------

loc_4071C4:				; CODE XREF: sub_407099+111j
					; DATA XREF: .rdata:off_424684o
		or	[ebp+var_18], 10h ; jumptable 004071AA case 35
		jmp	short loc_4071CF
; ---------------------------------------------------------------------------

loc_4071CA:				; CODE XREF: sub_407099+111j
					; DATA XREF: .rdata:off_424684o
		or	[ebp+var_18], 20h ; jumptable 004071AA case 48
		nop

loc_4071CF:				; CODE XREF: sub_407099+117j
					; sub_407099+11Dj ...
		add	[ebp+var_C], 1

loc_4071D3:				; CODE XREF: sub_407099+F7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407192
		jmp	short loc_4071E0
; ---------------------------------------------------------------------------

loc_4071DF:				; CODE XREF: sub_407099+108j
					; sub_407099+111j
					; DATA XREF: ...
		nop			; jumptable 004071AA default case

loc_4071E0:				; CODE XREF: sub_407099+144j
		mov	[ebp+var_30], 0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	loc_407293
		mov	[ebp+var_1C], 0FFFFFFFEh
		add	[ebp+var_C], 1
		cmp	[ebp+var_2C], 0
		jz	loc_407319
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jle	loc_407319
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	loc_407319
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_30], eax
		add	[ebp+var_C], 1
		jmp	short loc_40725E
; ---------------------------------------------------------------------------

loc_40723B:				; CODE XREF: sub_407099+1D7j
		mov	edx, [ebp+var_30]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_30], eax
		add	[ebp+var_C], 1

loc_40725E:				; CODE XREF: sub_407099+1A0j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_407272
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40723B

loc_407272:				; CODE XREF: sub_407099+1CDj
		cmp	[ebp+var_30], 0
		jle	loc_4077C9
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	loc_4077CC
		add	[ebp+var_C], 1
		jmp	loc_407319
; ---------------------------------------------------------------------------

loc_407293:				; CODE XREF: sub_407099+156j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_407312
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_407312
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_1C], eax
		add	[ebp+var_C], 1
		jmp	short loc_4072F3
; ---------------------------------------------------------------------------

loc_4072BC:				; CODE XREF: sub_407099+26Cj
		cmp	[ebp+var_1C], 0
		jnz	short loc_4072D0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	loc_4077CF

loc_4072D0:				; CODE XREF: sub_407099+227j
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_1C], eax
		add	[ebp+var_C], 1

loc_4072F3:				; CODE XREF: sub_407099+221j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_407307
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_4072BC

loc_407307:				; CODE XREF: sub_407099+262j
		cmp	[ebp+var_1C], 0
		jns	short loc_407319
		jmp	loc_4077DC
; ---------------------------------------------------------------------------

loc_407312:				; CODE XREF: sub_407099+202j
					; sub_407099+20Cj
		mov	[ebp+var_1C], 0FFFFFFFFh

loc_407319:				; CODE XREF: sub_407099+16Bj
					; sub_407099+179j ...
		mov	[ebp+var_34], 0
		mov	[ebp+var_20], 0FFFFFFFFh
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Eh
		jnz	loc_40748C
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		setz	al
		movzx	eax, al
		mov	[ebp+var_40], eax
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	loc_4073F9
		mov	[ebp+var_20], 0FFFFFFFEh
		add	[ebp+var_C], 1
		cmp	[ebp+var_2C], 0
		jz	loc_40747F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jle	loc_40747F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	loc_40747F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_34], eax
		add	[ebp+var_C], 1
		jmp	short loc_4073C4
; ---------------------------------------------------------------------------

loc_4073A1:				; CODE XREF: sub_407099+33Dj
		mov	edx, [ebp+var_34]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_34], eax
		add	[ebp+var_C], 1

loc_4073C4:				; CODE XREF: sub_407099+306j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4073D8
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_4073A1

loc_4073D8:				; CODE XREF: sub_407099+333j
		cmp	[ebp+var_34], 0
		jle	loc_4077D2
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	loc_4077D5
		add	[ebp+var_C], 1
		jmp	loc_40747F
; ---------------------------------------------------------------------------

loc_4073F9:				; CODE XREF: sub_407099+2BCj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_407478
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_407478
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_20], eax
		add	[ebp+var_C], 1
		jmp	short loc_407459
; ---------------------------------------------------------------------------

loc_407422:				; CODE XREF: sub_407099+3D2j
		cmp	[ebp+var_20], 0
		jnz	short loc_407436
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	loc_4077D8

loc_407436:				; CODE XREF: sub_407099+38Dj
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_20], eax
		add	[ebp+var_C], 1

loc_407459:				; CODE XREF: sub_407099+387j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40746D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_407422

loc_40746D:				; CODE XREF: sub_407099+3C8j
		cmp	[ebp+var_20], 0
		jns	short loc_40747F
		jmp	loc_4077DC
; ---------------------------------------------------------------------------

loc_407478:				; CODE XREF: sub_407099+368j
					; sub_407099+372j
		mov	[ebp+var_20], 0

loc_40747F:				; CODE XREF: sub_407099+2D1j
					; sub_407099+2DFj ...
		cmp	[ebp+var_40], 0
		jz	short loc_40748C
		mov	[ebp+var_20], 0FFFFFFFFh

loc_40748C:				; CODE XREF: sub_407099+296j
					; sub_407099+3EAj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 4Ch	; switch 47 cases
		cmp	eax, 2Eh
		ja	loc_40752C	; jumptable 004074A8 default case
		mov	eax, ds:off_4246C8[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4074AA:				; CODE XREF: sub_407099+40Fj
					; DATA XREF: .rdata:off_4246C8o
		mov	eax, [ebp+var_C] ; jumptable 004074A8 case 104
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 68h
		jnz	short loc_4074C4
		mov	[ebp+var_24], 1
		add	[ebp+var_C], 1
		jmp	short loc_4074CB
; ---------------------------------------------------------------------------

loc_4074C4:				; CODE XREF: sub_407099+41Cj
		mov	[ebp+var_24], 2

loc_4074CB:				; CODE XREF: sub_407099+429j
		add	[ebp+var_C], 1
		jmp	short loc_407534
; ---------------------------------------------------------------------------

loc_4074D1:				; CODE XREF: sub_407099+40Fj
					; DATA XREF: .rdata:off_4246C8o
		mov	eax, [ebp+var_C] ; jumptable 004074A8 case 108
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 6Ch
		jnz	short loc_4074EB
		mov	[ebp+var_24], 4
		add	[ebp+var_C], 1
		jmp	short loc_4074F2
; ---------------------------------------------------------------------------

loc_4074EB:				; CODE XREF: sub_407099+443j
		mov	[ebp+var_24], 3

loc_4074F2:				; CODE XREF: sub_407099+450j
		add	[ebp+var_C], 1
		jmp	short loc_407534
; ---------------------------------------------------------------------------

loc_4074F8:				; CODE XREF: sub_407099+40Fj
					; DATA XREF: .rdata:off_4246C8o
		mov	[ebp+var_24], 5	; jumptable 004074A8 case 106
		add	[ebp+var_C], 1
		jmp	short loc_407534
; ---------------------------------------------------------------------------

loc_407505:				; CODE XREF: sub_407099+40Fj
					; DATA XREF: .rdata:off_4246C8o
		mov	[ebp+var_24], 6	; jumptable 004074A8 case 122
		add	[ebp+var_C], 1
		jmp	short loc_407534
; ---------------------------------------------------------------------------

loc_407512:				; CODE XREF: sub_407099+40Fj
					; DATA XREF: .rdata:off_4246C8o
		mov	[ebp+var_24], 7	; jumptable 004074A8 case 116
		add	[ebp+var_C], 1
		jmp	short loc_407534
; ---------------------------------------------------------------------------

loc_40751F:				; CODE XREF: sub_407099+40Fj
					; DATA XREF: .rdata:off_4246C8o
		mov	[ebp+var_24], 8	; jumptable 004074A8 case 76
		add	[ebp+var_C], 1
		jmp	short loc_407534
; ---------------------------------------------------------------------------

loc_40752C:				; CODE XREF: sub_407099+402j
					; sub_407099+40Fj
					; DATA XREF: ...
		mov	[ebp+var_24], 0	; jumptable 004074A8 default case
		nop

loc_407534:				; CODE XREF: sub_407099+436j
					; sub_407099+45Dj ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 41h	; switch 56 cases
		cmp	eax, 37h
		ja	loc_407633	; jumptable 00407550 default case
		mov	eax, ds:off_424784[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_407552:				; CODE XREF: sub_407099+4B7j
					; DATA XREF: .rdata:off_424784o
		mov	[ebp+var_28], 1	; jumptable 00407550 cases 100,105
		jmp	loc_40763A
; ---------------------------------------------------------------------------

loc_40755E:				; CODE XREF: sub_407099+4B7j
					; DATA XREF: .rdata:off_424784o
		mov	[ebp+var_28], 2	; jumptable 00407550 case 111
		jmp	loc_40763A
; ---------------------------------------------------------------------------

loc_40756A:				; CODE XREF: sub_407099+4B7j
					; DATA XREF: .rdata:off_424784o
		mov	[ebp+var_28], 3	; jumptable 00407550 case 117
		jmp	loc_40763A
; ---------------------------------------------------------------------------

loc_407576:				; CODE XREF: sub_407099+4B7j
					; DATA XREF: .rdata:off_424784o
		mov	[ebp+var_28], 4	; jumptable 00407550 case 120
		jmp	loc_40763A
; ---------------------------------------------------------------------------

loc_407582:				; CODE XREF: sub_407099+4B7j
					; DATA XREF: .rdata:off_424784o
		mov	[ebp+var_28], 5	; jumptable 00407550 case 88
		jmp	loc_40763A
; ---------------------------------------------------------------------------

loc_40758E:				; CODE XREF: sub_407099+4B7j
					; DATA XREF: .rdata:off_424784o
		mov	[ebp+var_28], 6	; jumptable 00407550 case 102
		jmp	loc_40763A
; ---------------------------------------------------------------------------

loc_40759A:				; CODE XREF: sub_407099+4B7j
					; DATA XREF: .rdata:off_424784o
		mov	[ebp+var_28], 7	; jumptable 00407550 case 70
		jmp	loc_40763A
; ---------------------------------------------------------------------------

loc_4075A6:				; CODE XREF: sub_407099+4B7j
					; DATA XREF: .rdata:off_424784o
		mov	[ebp+var_28], 8	; jumptable 00407550 case 101
		jmp	loc_40763A
; ---------------------------------------------------------------------------

loc_4075B2:				; CODE XREF: sub_407099+4B7j
					; DATA XREF: .rdata:off_424784o
		mov	[ebp+var_28], 9	; jumptable 00407550 case 69
		jmp	short loc_40763A
; ---------------------------------------------------------------------------

loc_4075BB:				; CODE XREF: sub_407099+4B7j
					; DATA XREF: .rdata:off_424784o
		mov	[ebp+var_28], 0Ah ; jumptable 00407550 case 103
		jmp	short loc_40763A
; ---------------------------------------------------------------------------

loc_4075C4:				; CODE XREF: sub_407099+4B7j
					; DATA XREF: .rdata:off_424784o
		mov	[ebp+var_28], 0Bh ; jumptable 00407550 case 71
		jmp	short loc_40763A
; ---------------------------------------------------------------------------

loc_4075CD:				; CODE XREF: sub_407099+4B7j
					; DATA XREF: .rdata:off_424784o
		mov	[ebp+var_28], 0Ch ; jumptable 00407550 case 97
		jmp	short loc_40763A
; ---------------------------------------------------------------------------

loc_4075D6:				; CODE XREF: sub_407099+4B7j
					; DATA XREF: .rdata:off_424784o
		mov	[ebp+var_28], 0Dh ; jumptable 00407550 case 65
		jmp	short loc_40763A
; ---------------------------------------------------------------------------

loc_4075DF:				; CODE XREF: sub_407099+4B7j
					; DATA XREF: .rdata:off_424784o
		mov	[ebp+var_28], 0Eh ; jumptable 00407550 case 99
		jmp	short loc_40763A
; ---------------------------------------------------------------------------

loc_4075E8:				; CODE XREF: sub_407099+4B7j
					; DATA XREF: .rdata:off_424784o
		mov	[ebp+var_28], 0Fh ; jumptable 00407550 case 115
		jmp	short loc_40763A
; ---------------------------------------------------------------------------

loc_4075F1:				; CODE XREF: sub_407099+4B7j
					; DATA XREF: .rdata:off_424784o
		mov	[ebp+var_28], 10h ; jumptable 00407550 case 112
		jmp	short loc_40763A
; ---------------------------------------------------------------------------

loc_4075FA:				; CODE XREF: sub_407099+4B7j
					; DATA XREF: .rdata:off_424784o
		mov	[ebp+var_28], 12h ; jumptable 00407550 case 110
		jmp	short loc_40763A
; ---------------------------------------------------------------------------

loc_407603:				; CODE XREF: sub_407099+4B7j
					; DATA XREF: .rdata:off_424784o
		mov	[ebp+var_28], 0Eh ; jumptable 00407550 case 67
		mov	[ebp+var_24], 3
		jmp	short loc_40763A
; ---------------------------------------------------------------------------

loc_407613:				; CODE XREF: sub_407099+4B7j
					; DATA XREF: .rdata:off_424784o
		mov	[ebp+var_28], 0Fh ; jumptable 00407550 case 83
		mov	[ebp+var_24], 3
		jmp	short loc_40763A
; ---------------------------------------------------------------------------

loc_407623:				; CODE XREF: sub_407099+4B7j
					; DATA XREF: .rdata:off_424784o
		mov	[ebp+var_28], 11h ; jumptable 00407550 case 109
		mov	[ebp+var_2C], 0FFFFFFFFh
		jmp	short loc_40763A
; ---------------------------------------------------------------------------

loc_407633:				; CODE XREF: sub_407099+4AAj
					; sub_407099+4B7j
					; DATA XREF: ...
		mov	[ebp+var_28], 0	; jumptable 00407550 default case

loc_40763A:				; CODE XREF: sub_407099+4C0j
					; sub_407099+4CCj ...
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_8]
		jb	loc_40770B
		mov	eax, [ebp+arg_8]
		add	eax, 0Ah
		mov	[ebp+var_44], eax
		mov	eax, [ebp+var_44]
		cmp	eax, [ebp+arg_8]
		jbe	loc_4077DB
		mov	[esp+68h+SizeOfElements], 28h ;	SizeOfElements
		mov	eax, [ebp+var_44]
		mov	[esp+68h+NumOfElements], eax ; NumOfElements
		call	calloc
		mov	[ebp+var_48], eax
		cmp	[ebp+var_48], 0
		jz	loc_4077EB
		mov	[ebp+var_38], 0
		jmp	short loc_4076E2
; ---------------------------------------------------------------------------

loc_407684:				; CODE XREF: sub_407099+64Fj
		mov	edx, [ebp+var_38]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+var_48]
		mov	ecx, [ebp+var_38]
		mov	edx, ecx
		shl	edx, 2
		add	edx, ecx
		shl	edx, 3
		add	edx, [ebp+Memory]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	ecx, [edx+10h]
		mov	[eax+10h], ecx
		mov	ecx, [edx+14h]
		mov	[eax+14h], ecx
		mov	ecx, [edx+18h]
		mov	[eax+18h], ecx
		mov	ecx, [edx+1Ch]
		mov	[eax+1Ch], ecx
		mov	ecx, [edx+20h]
		mov	[eax+20h], ecx
		mov	edx, [edx+24h]
		mov	[eax+24h], edx
		add	[ebp+var_38], 1

loc_4076E2:				; CODE XREF: sub_407099+5E9j
		mov	eax, [ebp+var_38]
		cmp	eax, [ebp+var_14]
		jb	short loc_407684
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		cmp	eax, [ebp+Memory]
		jz	short loc_4076FF
		mov	eax, [ebp+Memory]
		mov	[esp+68h+NumOfElements], eax ; Memory
		call	free

loc_4076FF:				; CODE XREF: sub_407099+659j
		mov	eax, [ebp+var_48]
		mov	[ebp+Memory], eax
		mov	eax, [ebp+var_44]
		mov	[ebp+arg_8], eax

loc_40770B:				; CODE XREF: sub_407099+5A7j
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	[ebp+var_4C], eax
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 2
		mov	edx, eax
		mov	eax, [ebp+var_4C]
		mov	[eax], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_1C]
		mov	[eax+8], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_20]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_24]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_28]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_2C]
		mov	[eax+18h], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_30]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_34]
		mov	[eax+20h], edx
		mov	eax, [ebp+var_4C]
		mov	[esp+68h+NumOfElements], eax
		call	sub_406E98
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_0], eax
		jmp	short loc_407797
; ---------------------------------------------------------------------------

loc_407793:				; CODE XREF: sub_407099+2Cj
		nop
		jmp	short loc_407797
; ---------------------------------------------------------------------------

loc_407796:				; CODE XREF: sub_407099+52j
		nop

loc_407797:				; CODE XREF: sub_407099+6F8j
					; sub_407099+6FBj
		add	[ebp+arg_0], 1
		jmp	short loc_40779E
; ---------------------------------------------------------------------------

loc_40779D:				; CODE XREF: sub_407099+19j
		nop

loc_40779E:				; CODE XREF: sub_407099+702j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4070BD
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+Memory]
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, 0
		jmp	short locret_40780F
; ---------------------------------------------------------------------------

loc_4077C3:				; CODE XREF: sub_407099+44j
		nop
		jmp	short loc_4077DC
; ---------------------------------------------------------------------------

loc_4077C6:				; CODE XREF: sub_407099+CDj
		nop
		jmp	short loc_4077DC
; ---------------------------------------------------------------------------

loc_4077C9:				; CODE XREF: sub_407099+1DDj
		nop
		jmp	short loc_4077DC
; ---------------------------------------------------------------------------

loc_4077CC:				; CODE XREF: sub_407099+1EBj
		nop
		jmp	short loc_4077DC
; ---------------------------------------------------------------------------

loc_4077CF:				; CODE XREF: sub_407099+231j
		nop
		jmp	short loc_4077DC
; ---------------------------------------------------------------------------

loc_4077D2:				; CODE XREF: sub_407099+343j
		nop
		jmp	short loc_4077DC
; ---------------------------------------------------------------------------

loc_4077D5:				; CODE XREF: sub_407099+351j
		nop
		jmp	short loc_4077DC
; ---------------------------------------------------------------------------

loc_4077D8:				; CODE XREF: sub_407099+397j
		nop
		jmp	short loc_4077DC
; ---------------------------------------------------------------------------

loc_4077DB:				; CODE XREF: sub_407099+5BCj
		nop

loc_4077DC:				; CODE XREF: sub_407099+1Fj
					; sub_407099+274j ...
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		jmp	short loc_4077EC
; ---------------------------------------------------------------------------

loc_4077EB:				; CODE XREF: sub_407099+5DCj
		nop

loc_4077EC:				; CODE XREF: sub_407099+750j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		cmp	eax, [ebp+Memory]
		jz	short loc_407801
		mov	eax, [ebp+Memory]
		mov	[esp+68h+NumOfElements], eax ; Memory
		call	free

loc_407801:				; CODE XREF: sub_407099+75Bj
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh

locret_40780F:				; CODE XREF: sub_407099+728j
		leave
		retn
sub_407099	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407811	proc near		; CODE XREF: sub_408EE3+502p

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	[ebp+var_C], 0
		jmp	loc_407AD8
; ---------------------------------------------------------------------------

loc_407824:				; CODE XREF: sub_407811+2CDj
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_0]
		add	eax, 8
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 1Ch ; switch 29 cases
		ja	loc_407ACD	; jumptable 00407864 default case
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	eax, offset off_424864
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_407866:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 1
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		jmp	loc_407AD4
; ---------------------------------------------------------------------------

loc_40787D:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 20
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_407AD4
; ---------------------------------------------------------------------------

loc_407892:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 2
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		jmp	loc_407AD4
; ---------------------------------------------------------------------------

loc_4078A9:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 21
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_407AD4
; ---------------------------------------------------------------------------

loc_4078BE:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 3
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		jmp	loc_407AD4
; ---------------------------------------------------------------------------

loc_4078D5:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 4
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dx
		jmp	loc_407AD4
; ---------------------------------------------------------------------------

loc_4078ED:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 5
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dx
		jmp	loc_407AD4
; ---------------------------------------------------------------------------

loc_407905:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 22
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_407AD4
; ---------------------------------------------------------------------------

loc_40791A:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 6
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_407AD4
; ---------------------------------------------------------------------------

loc_40792F:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 23
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_407AD4
; ---------------------------------------------------------------------------

loc_407944:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 7
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_407AD4
; ---------------------------------------------------------------------------

loc_407959:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 8
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_407AD4
; ---------------------------------------------------------------------------

loc_40796E:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 9
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_407AD4
; ---------------------------------------------------------------------------

loc_407983:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 24
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_407AD4
; ---------------------------------------------------------------------------

loc_407998:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 10
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	loc_407AD4
; ---------------------------------------------------------------------------

loc_4079B3:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 11
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	loc_407AD4
; ---------------------------------------------------------------------------

loc_4079CE:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 25
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_407AD4
; ---------------------------------------------------------------------------

loc_4079E3:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 12
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		fld	qword ptr [eax]
		mov	eax, [ebp+var_10]
		fstp	qword ptr [eax]
		jmp	loc_407AD4
; ---------------------------------------------------------------------------

loc_4079F8:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 13
		lea	edx, [eax+0Ch]
		mov	[ebp+arg_8], edx
		mov	ecx, [eax+8]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ebx, [ebp+var_10]
		mov	[ebx], eax
		mov	[ebx+4], edx
		mov	[ebx+8], ecx
		jmp	loc_407AD4
; ---------------------------------------------------------------------------

loc_407A19:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 14
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_407AD4
; ---------------------------------------------------------------------------

loc_407A2E:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 19
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_407AD4
; ---------------------------------------------------------------------------

loc_407A43:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 15
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_407AD4
; ---------------------------------------------------------------------------

loc_407A5B:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 26
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_407AD4
; ---------------------------------------------------------------------------

loc_407A6D:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 16
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_407AD4
; ---------------------------------------------------------------------------

loc_407A85:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 17
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_407AD4
; ---------------------------------------------------------------------------

loc_407A97:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 27
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_407AD4
; ---------------------------------------------------------------------------

loc_407AA9:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 18
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_407AD4
; ---------------------------------------------------------------------------

loc_407ABB:				; CODE XREF: sub_407811+53j
					; DATA XREF: .rdata:off_424864o
		mov	eax, [ebp+arg_8] ; jumptable 00407864 case 28
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_407AD4
; ---------------------------------------------------------------------------

loc_407ACD:				; CODE XREF: sub_407811+40j
					; sub_407811+53j
					; DATA XREF: ...
		mov	eax, 0FFFFFFFFh	; jumptable 00407864 default case
		jmp	short loc_407AE9
; ---------------------------------------------------------------------------

loc_407AD4:				; CODE XREF: sub_407811+67j
					; sub_407811+7Cj ...
		add	[ebp+var_C], 1

loc_407AD8:				; CODE XREF: sub_407811+Ej
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_4]
		jb	loc_407824
		mov	eax, 0

loc_407AE9:				; CODE XREF: sub_407811+2C1j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_407811	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407AEF	proc near		; CODE XREF: sub_407B6D+4C6p
					; sub_407B6D+5BAp ...

Dst		= dword	ptr -48h
Val		= dword	ptr -44h
Size		= dword	ptr -40h
var_30		= byte ptr -30h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		jmp	short loc_407B60
; ---------------------------------------------------------------------------

loc_407AF7:				; CODE XREF: sub_407AEF+75j
		mov	eax, [ebp+arg_C]
		mov	edx, 20h
		cmp	eax, 20h
		cmova	eax, edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Size],	eax ; Size
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Val], eax ; Val
		lea	eax, [ebp+var_30]
		mov	[esp+48h+Dst], eax ; Dst
		call	memset
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Size],	eax
		lea	eax, [ebp+var_30]
		mov	[esp+48h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Dst], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_407B48
		mov	eax, [ebp+var_10]
		jmp	short locret_407B6B
; ---------------------------------------------------------------------------

loc_407B48:				; CODE XREF: sub_407AEF+52j
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		sub	eax, [ebp+var_C]
		mov	[ebp+arg_C], eax

loc_407B60:				; CODE XREF: sub_407AEF+6j
		cmp	[ebp+arg_C], 0
		jg	short loc_407AF7
		mov	eax, 0

locret_407B6B:				; CODE XREF: sub_407AEF+57j
		leave
		retn
sub_407AEF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407B6D	proc near		; CODE XREF: sub_408A03+317p

var_D8		= dword	ptr -0D8h
var_D4		= dword	ptr -0D4h
var_D0		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A5		= byte ptr -0A5h
var_A4		= byte ptr -0A4h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0D4h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_B8], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_B4], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_B0], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_AC], eax
		mov	[ebp+var_A5], 0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 1
		jnz	loc_407C94
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		sub	eax, 4		; switch 15 cases
		cmp	eax, 0Eh
		ja	loc_407C54	; jumptable 00407BCA default case
		mov	eax, ds:off_424904[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_407BCC:				; CODE XREF: sub_407B6D+5Dj
					; DATA XREF: .rdata:off_424904o
		movzx	eax, word ptr [ebp+var_B8] ; jumptable 00407BCA	case 4
		cwde
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_407C5E
; ---------------------------------------------------------------------------

loc_407BE1:				; CODE XREF: sub_407B6D+5Dj
					; DATA XREF: .rdata:off_424904o
		mov	eax, [ebp+var_B8] ; jumptable 00407BCA case 6
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_407C5E
; ---------------------------------------------------------------------------

loc_407BF4:				; CODE XREF: sub_407B6D+5Dj
					; DATA XREF: .rdata:off_424904o
		mov	eax, [ebp+var_B8] ; jumptable 00407BCA case 8
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_407C5E
; ---------------------------------------------------------------------------

loc_407C07:				; CODE XREF: sub_407B6D+5Dj
					; DATA XREF: .rdata:off_424904o
		mov	eax, [ebp+var_B8] ; jumptable 00407BCA case 10
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_407C5E
; ---------------------------------------------------------------------------

loc_407C1B:				; CODE XREF: sub_407B6D+5Dj
					; DATA XREF: .rdata:off_424904o
		mov	eax, [ebp+var_B8] ; jumptable 00407BCA case 17
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], 0
		jmp	short loc_407C5E
; ---------------------------------------------------------------------------

loc_407C2D:				; CODE XREF: sub_407B6D+5Dj
					; DATA XREF: .rdata:off_424904o
		mov	eax, [ebp+var_B8] ; jumptable 00407BCA case 15
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_407C5E
; ---------------------------------------------------------------------------

loc_407C41:				; CODE XREF: sub_407B6D+5Dj
					; DATA XREF: .rdata:off_424904o
		mov	eax, [ebp+var_B8] ; jumptable 00407BCA case 18
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_407C5E
; ---------------------------------------------------------------------------

loc_407C54:				; CODE XREF: sub_407B6D+50j
					; sub_407B6D+5Dj
					; DATA XREF: ...
		mov	eax, 0FFFFFFFFh	; jumptable 00407BCA default case
		jmp	loc_4081F7
; ---------------------------------------------------------------------------

loc_407C5E:				; CODE XREF: sub_407B6D+72j
					; sub_407B6D+85j ...
		cmp	[ebp+var_24], 0
		jns	short loc_407C83
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_24]
		neg	eax
		adc	edx, 0
		neg	edx
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	[ebp+var_A5], 2Dh
		jmp	loc_407D40
; ---------------------------------------------------------------------------

loc_407C83:				; CODE XREF: sub_407B6D+F5j
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	loc_407D40
; ---------------------------------------------------------------------------

loc_407C94:				; CODE XREF: sub_407B6D+3Ej
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		sub	eax, 5		; switch 14 cases
		cmp	eax, 0Dh
		ja	loc_407D36	; jumptable 00407CAD default case
		mov	eax, ds:off_424940[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_407CAF:				; CODE XREF: sub_407B6D+140j
					; DATA XREF: .rdata:off_424940o
		movzx	eax, word ptr [ebp+var_B8] ; jumptable 00407CAD	case 5
		movzx	eax, ax
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_407D40
; ---------------------------------------------------------------------------

loc_407CC5:				; CODE XREF: sub_407B6D+140j
					; DATA XREF: .rdata:off_424940o
		mov	eax, [ebp+var_B8] ; jumptable 00407CAD case 7
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_407D40
; ---------------------------------------------------------------------------

loc_407CD7:				; CODE XREF: sub_407B6D+140j
					; DATA XREF: .rdata:off_424940o
		mov	eax, [ebp+var_B8] ; jumptable 00407CAD case 9
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_407D40
; ---------------------------------------------------------------------------

loc_407CE9:				; CODE XREF: sub_407B6D+140j
					; DATA XREF: .rdata:off_424940o
		mov	eax, [ebp+var_B8] ; jumptable 00407CAD case 11
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_407D40
; ---------------------------------------------------------------------------

loc_407CFD:				; CODE XREF: sub_407B6D+140j
					; DATA XREF: .rdata:off_424940o
		mov	eax, [ebp+var_B8] ; jumptable 00407CAD case 17
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_407D40
; ---------------------------------------------------------------------------

loc_407D0F:				; CODE XREF: sub_407B6D+140j
					; DATA XREF: .rdata:off_424940o
		mov	eax, [ebp+var_B8] ; jumptable 00407CAD case 16
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_407D40
; ---------------------------------------------------------------------------

loc_407D23:				; CODE XREF: sub_407B6D+140j
					; DATA XREF: .rdata:off_424940o
		mov	eax, [ebp+var_B8] ; jumptable 00407CAD case 18
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_407D40
; ---------------------------------------------------------------------------

loc_407D36:				; CODE XREF: sub_407B6D+133j
					; sub_407B6D+140j
					; DATA XREF: ...
		mov	eax, 0FFFFFFFFh	; jumptable 00407CAD default case
		jmp	loc_4081F7
; ---------------------------------------------------------------------------

loc_407D40:				; CODE XREF: sub_407B6D+111j
					; sub_407B6D+122j ...
		movzx	eax, [ebp+var_A5]
		cmp	al, 2Dh
		jz	short loc_407D75
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 4
		test	eax, eax
		jz	short loc_407D61
		mov	[ebp+var_A5], 2Bh
		jmp	short loc_407D75
; ---------------------------------------------------------------------------

loc_407D61:				; CODE XREF: sub_407B6D+1E9j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 8
		test	eax, eax
		jz	short loc_407D75
		mov	[ebp+var_A5], 20h

loc_407D75:				; CODE XREF: sub_407B6D+1DCj
					; sub_407B6D+1F2j ...
		movzx	eax, [ebp+var_A5]
		test	al, al
		setnz	al
		movzx	eax, al
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+var_A4]
		add	eax, 64h
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	short loc_407DB3
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_407F3F

loc_407DB3:				; CODE XREF: sub_407B6D+236j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 1
		jz	short loc_407DCD
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jnz	loc_407E7F

loc_407DCD:				; CODE XREF: sub_407B6D+24Fj
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	[ebp+var_38], offset byte_4248D8

loc_407DDB:				; CODE XREF: sub_407B6D+307j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 1
		test	al, al
		jz	short loc_407E12
		add	[ebp+var_2C], 1
		cmp	[ebp+var_2C], 3
		jnz	short loc_407E12
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_407E12
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_38]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	[ebp+var_2C], 0

loc_407E12:				; CODE XREF: sub_407B6D+279j
					; sub_407B6D+283j ...
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[esp+0D8h+var_D0], 0Ah
		mov	[esp+0D8h+var_CC], 0
		mov	[esp+0D8h+var_D8], eax
		mov	[esp+0D8h+var_D4], edx
		call	sub_420B80
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[esp+0D8h+var_D0], 0Ah
		mov	[esp+0D8h+var_CC], 0
		mov	[esp+0D8h+var_D8], eax
		mov	[esp+0D8h+var_D4], edx
		call	sub_420CC0
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	loc_407DDB
		jmp	loc_407F3F
; ---------------------------------------------------------------------------

loc_407E7F:				; CODE XREF: sub_407B6D+25Aj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 2
		jnz	short loc_407EE0

loc_407E8A:				; CODE XREF: sub_407B6D+34Ej
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_10]
		and	eax, 7
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		shrd	eax, edx, 3
		shr	edx, 3
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	short loc_407E8A
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_407F3F
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	short loc_407F3F
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	30h
		jmp	short loc_407F3F
; ---------------------------------------------------------------------------

loc_407EE0:				; CODE XREF: sub_407B6D+31Bj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 4
		jnz	short loc_407EF2
		mov	eax, offset a0123456789abcd ; "0123456789abcdef"
		jmp	short loc_407EF7
; ---------------------------------------------------------------------------

loc_407EF2:				; CODE XREF: sub_407B6D+37Cj
		mov	eax, offset a0123456789ab_0 ; "0123456789ABCDEF"

loc_407EF7:				; CODE XREF: sub_407B6D+383j
		mov	[ebp+var_34], eax

loc_407EFA:				; CODE XREF: sub_407B6D+3BFj
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_10]
		and	eax, 0Fh
		add	eax, [ebp+var_34]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		shrd	eax, edx, 4
		shr	edx, 4
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	short loc_407EFA
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_407F3F
		add	[ebp+var_1C], 2

loc_407F3F:				; CODE XREF: sub_407B6D+240j
					; sub_407B6D+30Dj ...
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 20h
		test	eax, eax
		jz	short loc_407F98
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_407F98
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_407F98
		cmp	[ebp+var_3C], 0
		jz	short loc_407F98
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_407F98
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		sub	eax, [ebp+var_3C]
		mov	[ebp+var_18], eax
		jmp	short loc_407FC2
; ---------------------------------------------------------------------------

loc_407F98:				; CODE XREF: sub_407B6D+3ECj
					; sub_407B6D+3F7j ...
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jle	short loc_407FBB
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_407FBB
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		sub	eax, [ebp+var_3C]
		mov	[ebp+var_18], eax
		jmp	short loc_407FC2
; ---------------------------------------------------------------------------

loc_407FBB:				; CODE XREF: sub_407B6D+433j
					; sub_407B6D+43Ej
		mov	[ebp+var_18], 0

loc_407FC2:				; CODE XREF: sub_407B6D+429j
					; sub_407B6D+44Cj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_408049
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_408049
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_408049
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		mov	edx, eax
		sub	edx, [ebp+var_3C]
		mov	eax, [ebp+var_18]
		cmp	edx, eax
		jb	short loc_408049
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		mov	edx, eax
		sub	edx, [ebp+var_3C]
		mov	eax, [ebp+var_18]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	edx, [ebp+arg_1C]
		mov	[esp+0D8h+var_C8], edx
		mov	[esp+0D8h+var_CC], eax
		mov	[esp+0D8h+var_D0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+var_D8], eax
		call	sub_407AEF
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_408049
		mov	eax, [ebp+var_40]
		jmp	loc_4081F7
; ---------------------------------------------------------------------------

loc_408049:				; CODE XREF: sub_407B6D+460j
					; sub_407B6D+46Aj ...
		movzx	eax, [ebp+var_A5]
		test	al, al
		jz	short loc_40808F
		mov	[esp+0D8h+var_D0], 1
		lea	eax, [ebp+var_A5]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_408082
		mov	eax, [ebp+var_40]
		jmp	loc_4081F7
; ---------------------------------------------------------------------------

loc_408082:				; CODE XREF: sub_407B6D+50Bj
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_40808F:				; CODE XREF: sub_407B6D+4E5j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_4080FE
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 4
		jz	short loc_4080B2
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 5
		jnz	short loc_4080FE

loc_4080B2:				; CODE XREF: sub_407B6D+538j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 4
		jnz	short loc_4080C4
		mov	eax, offset a0x	; "0x"
		jmp	short loc_4080C9
; ---------------------------------------------------------------------------

loc_4080C4:				; CODE XREF: sub_407B6D+54Ej
		mov	eax, offset a0x_0 ; "0X"

loc_4080C9:				; CODE XREF: sub_407B6D+555j
		mov	[esp+0D8h+var_D0], 2
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_4080F1
		mov	eax, [ebp+var_40]
		jmp	loc_4081F7
; ---------------------------------------------------------------------------

loc_4080F1:				; CODE XREF: sub_407B6D+57Aj
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_4080FE:				; CODE XREF: sub_407B6D+52Dj
					; sub_407B6D+543j
		cmp	[ebp+var_18], 0
		jz	short loc_40813D
		mov	eax, [ebp+arg_1C]
		mov	[esp+0D8h+var_C8], eax
		mov	eax, [ebp+var_18]
		mov	[esp+0D8h+var_CC], eax
		mov	[esp+0D8h+var_D0], 30h
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+var_D8], eax
		call	sub_407AEF
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_40813D
		mov	eax, [ebp+var_40]
		jmp	loc_4081F7
; ---------------------------------------------------------------------------

loc_40813D:				; CODE XREF: sub_407B6D+595j
					; sub_407B6D+5C6j
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[esp+0D8h+var_D0], eax
		mov	eax, [ebp+var_14]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_408170
		mov	eax, [ebp+var_40]
		jmp	loc_4081F7
; ---------------------------------------------------------------------------

loc_408170:				; CODE XREF: sub_407B6D+5F9j
		mov	eax, [ebp+arg_1C]
		mov	edx, [eax]
		mov	ecx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jz	short loc_4081F2
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_4081F2
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		sub	eax, [ebp+var_18]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_4081F2
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		sub	eax, [ebp+var_18]
		sub	eax, [ebp+var_3C]
		mov	edx, [ebp+arg_1C]
		mov	[esp+0D8h+var_C8], edx
		mov	[esp+0D8h+var_CC], eax
		mov	[esp+0D8h+var_D0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+var_D8], eax
		call	sub_407AEF
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_4081F2
		mov	eax, [ebp+var_40]
		jmp	short loc_4081F7
; ---------------------------------------------------------------------------

loc_4081F2:				; CODE XREF: sub_407B6D+626j
					; sub_407B6D+630j ...
		mov	eax, 0

loc_4081F7:				; CODE XREF: sub_407B6D+ECj
					; sub_407B6D+1CEj ...
		add	esp, 0D4h
		pop	ebx
		pop	ebp
		retn
sub_407B6D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408200	proc near		; CODE XREF: sub_408A03+35Bp

Dest		= dword	ptr -1F8h
Format		= dword	ptr -1F4h
var_1F0		= qword	ptr -1F0h
var_1E8		= dword	ptr -1E8h
var_1D0		= dword	ptr -1D0h
var_1CC		= dword	ptr -1CCh
var_1C8		= qword	ptr -1C8h
var_1C0		= dword	ptr -1C0h
var_1BC		= dword	ptr -1BCh
var_1AF		= byte ptr -1AFh
var_1AE		= byte ptr -1AEh
var_19A		= byte ptr -19Ah
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= qword	ptr -28h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 1F0h
		mov	eax, [ebp+arg_C]
		mov	dword ptr [ebp+var_1C8], eax
		mov	eax, [ebp+arg_10]
		mov	dword ptr [ebp+var_1C8+4], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_1C0], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_1BC], eax
		mov	eax, 0
		mov	edx, 0
		mov	ecx, 0
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	[ebp+var_10], ecx
		mov	[ebp+var_1C], 0
		mov	[ebp+var_1AF], 0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 0Ch
		jz	short loc_408267
		cmp	eax, 0Dh
		jz	short loc_408272
		jmp	short loc_40829B
; ---------------------------------------------------------------------------

loc_408267:				; CODE XREF: sub_408200+5Ej
		fld	[ebp+var_1C8]
		fstp	[ebp+var_28]
		jmp	short loc_4082A5
; ---------------------------------------------------------------------------

loc_408272:				; CODE XREF: sub_408200+63j
		fldz
		fstp	[ebp+var_28]
		mov	eax, dword ptr [ebp+var_1C8]
		mov	edx, dword ptr [ebp+var_1C8+4]
		mov	ecx, [ebp+var_1C0]
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	[ebp+var_10], ecx
		mov	[ebp+var_1C], 1
		jmp	short loc_4082A5
; ---------------------------------------------------------------------------

loc_40829B:				; CODE XREF: sub_408200+65j
		mov	eax, 0FFFFFFFFh
		jmp	loc_40862B
; ---------------------------------------------------------------------------

loc_4082A5:				; CODE XREF: sub_408200+70j
					; sub_408200+99j
		lea	eax, [ebp+var_1AE]
		add	eax, 14h
		mov	[ebp+var_2C], eax
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		sub	eax, 6		; switch 8 cases
		cmp	eax, 7
		ja	short loc_408332 ; jumptable 004082D0 default case
		mov	eax, ds:off_424978[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4082D2:				; CODE XREF: sub_408200+D0j
					; DATA XREF: .rdata:off_424978o
		sub	[ebp+var_2C], 1	; jumptable 004082D0 case 6
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	66h
		jmp	short loc_40833C
; ---------------------------------------------------------------------------

loc_4082DE:				; CODE XREF: sub_408200+D0j
					; DATA XREF: .rdata:off_424978o
		sub	[ebp+var_2C], 1	; jumptable 004082D0 case 7
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	46h
		jmp	short loc_40833C
; ---------------------------------------------------------------------------

loc_4082EA:				; CODE XREF: sub_408200+D0j
					; DATA XREF: .rdata:off_424978o
		sub	[ebp+var_2C], 1	; jumptable 004082D0 case 8
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	65h
		jmp	short loc_40833C
; ---------------------------------------------------------------------------

loc_4082F6:				; CODE XREF: sub_408200+D0j
					; DATA XREF: .rdata:off_424978o
		sub	[ebp+var_2C], 1	; jumptable 004082D0 case 9
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	45h
		jmp	short loc_40833C
; ---------------------------------------------------------------------------

loc_408302:				; CODE XREF: sub_408200+D0j
					; DATA XREF: .rdata:off_424978o
		sub	[ebp+var_2C], 1	; jumptable 004082D0 case 10
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	67h
		jmp	short loc_40833C
; ---------------------------------------------------------------------------

loc_40830E:				; CODE XREF: sub_408200+D0j
					; DATA XREF: .rdata:off_424978o
		sub	[ebp+var_2C], 1	; jumptable 004082D0 case 11
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	47h
		jmp	short loc_40833C
; ---------------------------------------------------------------------------

loc_40831A:				; CODE XREF: sub_408200+D0j
					; DATA XREF: .rdata:off_424978o
		sub	[ebp+var_2C], 1	; jumptable 004082D0 case 12
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	61h
		jmp	short loc_40833C
; ---------------------------------------------------------------------------

loc_408326:				; CODE XREF: sub_408200+D0j
					; DATA XREF: .rdata:off_424978o
		sub	[ebp+var_2C], 1	; jumptable 004082D0 case 13
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	41h
		jmp	short loc_40833C
; ---------------------------------------------------------------------------

loc_408332:				; CODE XREF: sub_408200+C7j
		mov	eax, 0FFFFFFFFh	; jumptable 004082D0 default case
		jmp	loc_40862B
; ---------------------------------------------------------------------------

loc_40833C:				; CODE XREF: sub_408200+DCj
					; sub_408200+E8j ...
		cmp	[ebp+var_1C], 0
		jz	short loc_40834C
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	4Ch

loc_40834C:				; CODE XREF: sub_408200+140j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_4083C5
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		mov	edx, 64h
		cmp	eax, 64h
		cmovg	eax, edx
		mov	[ebp+var_30], eax

loc_40836B:				; CODE XREF: sub_408200+1B9j
		sub	[ebp+var_2C], 1
		mov	ecx, [ebp+var_30]
		mov	edx, 0CCCCCCCDh
		mov	eax, ecx
		mul	edx
		shr	edx, 3
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_2C]
		mov	[eax], dl
		mov	ecx, [ebp+var_30]
		mov	[ebp+var_1CC], ecx
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_1CC]
		mul	edx
		mov	eax, edx
		shr	eax, 3
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	short loc_40836B
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	2Eh

loc_4083C5:				; CODE XREF: sub_408200+155j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_4083DC
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	23h

loc_4083DC:				; CODE XREF: sub_408200+1D0j
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	25h
		cmp	[ebp+var_1C], 0
		jz	short loc_408418
		mov	ebx, [ebp+var_2C]
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	ecx, [ebp+var_10]
		mov	dword ptr [esp+1F8h+var_1F0], eax
		mov	dword ptr [esp+1F8h+var_1F0+4],	edx
		mov	[esp+1F8h+var_1E8], ecx
		mov	[esp+1F8h+Format], ebx ; Format
		lea	eax, [ebp+var_19A]
		mov	[esp+1F8h+Dest], eax ; Dest
		call	sprintf
		jmp	short loc_408434
; ---------------------------------------------------------------------------

loc_408418:				; CODE XREF: sub_408200+1EAj
		mov	eax, [ebp+var_2C]
		fld	[ebp+var_28]
		fstp	[esp+1F8h+var_1F0]
		mov	[esp+1F8h+Format], eax ; Format
		lea	eax, [ebp+var_19A]
		mov	[esp+1F8h+Dest], eax ; Dest
		call	sprintf

loc_408434:				; CODE XREF: sub_408200+216j
		lea	eax, [ebp+var_19A]
		mov	[ebp+var_2C], eax
		lea	eax, [ebp+var_19A]
		mov	[ebp+var_1D0], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1D0]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		add	eax, edx
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_2C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_40848E
		mov	[ebp+var_1AF], 2Dh
		add	[ebp+var_2C], 1
		sub	[ebp+var_30], 1
		jmp	short loc_4084B8
; ---------------------------------------------------------------------------

loc_40848E:				; CODE XREF: sub_408200+27Bj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 4
		test	eax, eax
		jz	short loc_4084A4
		mov	[ebp+var_1AF], 2Bh
		jmp	short loc_4084B8
; ---------------------------------------------------------------------------

loc_4084A4:				; CODE XREF: sub_408200+299j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 8
		test	eax, eax
		jz	short loc_4084B8
		mov	[ebp+var_1AF], 20h

loc_4084B8:				; CODE XREF: sub_408200+28Cj
					; sub_408200+2A2j ...
		movzx	eax, [ebp+var_1AF]
		test	al, al
		setnz	al
		movzx	eax, al
		mov	[ebp+var_38], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_408531
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_408531
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		cmp	eax, [ebp+var_30]
		jbe	short loc_408531
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		sub	eax, [ebp+var_30]
		mov	edx, [ebp+arg_1C]
		mov	[esp+1F8h+var_1E8], edx
		mov	dword ptr [esp+1F8h+var_1F0+4],	eax
		mov	dword ptr [esp+1F8h+var_1F0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+1F8h+Dest], eax
		call	sub_407AEF
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_408531
		mov	eax, [ebp+var_3C]
		jmp	loc_40862B
; ---------------------------------------------------------------------------

loc_408531:				; CODE XREF: sub_408200+2D5j
					; sub_408200+2DFj ...
		movzx	eax, [ebp+var_1AF]
		test	al, al
		jz	short loc_408577
		mov	dword ptr [esp+1F8h+var_1F0], 1
		lea	eax, [ebp+var_1AF]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Dest], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_40856A
		mov	eax, [ebp+var_3C]
		jmp	loc_40862B
; ---------------------------------------------------------------------------

loc_40856A:				; CODE XREF: sub_408200+360j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_408577:				; CODE XREF: sub_408200+33Aj
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_2C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	dword ptr [esp+1F8h+var_1F0], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Dest], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_4085AA
		mov	eax, [ebp+var_3C]
		jmp	loc_40862B
; ---------------------------------------------------------------------------

loc_4085AA:				; CODE XREF: sub_408200+3A0j
		mov	eax, [ebp+arg_1C]
		mov	edx, [eax]
		mov	ecx, [ebp+var_34]
		mov	eax, [ebp+var_2C]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jz	short loc_408626
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_408626
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		cmp	eax, [ebp+var_30]
		jbe	short loc_408626
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		sub	eax, [ebp+var_30]
		mov	edx, [ebp+arg_1C]
		mov	[esp+1F8h+var_1E8], edx
		mov	dword ptr [esp+1F8h+var_1F0+4],	eax
		mov	dword ptr [esp+1F8h+var_1F0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+1F8h+Dest], eax
		call	sub_407AEF
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_408626
		mov	eax, [ebp+var_3C]
		jmp	short loc_40862B
; ---------------------------------------------------------------------------

loc_408626:				; CODE XREF: sub_408200+3CDj
					; sub_408200+3D7j ...
		mov	eax, 0

loc_40862B:				; CODE XREF: sub_408200+A0j
					; sub_408200+137j ...
		add	esp, 1F0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_408200	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408635	proc near		; CODE XREF: sub_408A03+39Fp

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 6
		jz	short loc_408665
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4086A5
; ---------------------------------------------------------------------------

loc_408665:				; CODE XREF: sub_408635+27j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_D], al
		mov	[esp+38h+var_30], 1
		lea	eax, [ebp+var_D]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_408693
		mov	eax, [ebp+var_C]
		jmp	short locret_4086A5
; ---------------------------------------------------------------------------

loc_408693:				; CODE XREF: sub_408635+57j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, 0

locret_4086A5:				; CODE XREF: sub_408635+2Ej
					; sub_408635+5Cj
		leave
		retn
sub_408635	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4086A7	proc near		; CODE XREF: sub_408A03+3E3p

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 0Eh
		jz	short loc_4086DB
		mov	eax, 0FFFFFFFFh
		jmp	loc_408842
; ---------------------------------------------------------------------------

loc_4086DB:				; CODE XREF: sub_4086A7+28j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4086EE
		mov	[ebp+var_10], offset aNull ; "(null)"

loc_4086EE:				; CODE XREF: sub_4086A7+3Ej
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		js	short loc_408726
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		jmp	short loc_40870F
; ---------------------------------------------------------------------------

loc_408707:				; CODE XREF: sub_4086A7+7Bj
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1

loc_40870F:				; CODE XREF: sub_4086A7+5Ej
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_C]
		jbe	short loc_408748
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_408707
		jmp	short loc_408748
; ---------------------------------------------------------------------------

loc_408726:				; CODE XREF: sub_4086A7+4Fj
		mov	eax, [ebp+var_10]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax

loc_408748:				; CODE XREF: sub_4086A7+71j
					; sub_4086A7+7Dj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_4087A9
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_4087A9
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		jbe	short loc_4087A9
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_C]
		mov	edx, [ebp+arg_1C]
		mov	[esp+58h+var_48], edx
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_407AEF
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_4087A9
		mov	eax, [ebp+var_18]
		jmp	loc_408842
; ---------------------------------------------------------------------------

loc_4087A9:				; CODE XREF: sub_4086A7+ACj
					; sub_4086A7+B6j ...
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_4087D0
		mov	eax, [ebp+var_18]
		jmp	short loc_408842
; ---------------------------------------------------------------------------

loc_4087D0:				; CODE XREF: sub_4086A7+122j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jz	short loc_40883D
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_40883D
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		jbe	short loc_40883D
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_C]
		mov	edx, [ebp+arg_1C]
		mov	[esp+58h+var_48], edx
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_407AEF
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_40883D
		mov	eax, [ebp+var_18]
		jmp	short loc_408842
; ---------------------------------------------------------------------------

loc_40883D:				; CODE XREF: sub_4086A7+143j
					; sub_4086A7+14Dj ...
		mov	eax, 0

loc_408842:				; CODE XREF: sub_4086A7+2Fj
					; sub_4086A7+FDj ...
		add	esp, 54h
		pop	edi
		pop	ebp
		retn
sub_4086A7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408848	proc near		; CODE XREF: sub_408A03+427p

var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_7C		= byte ptr -7Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0A4h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_98], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_94], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_90], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_8C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 13h
		jz	short loc_40888B
		mov	eax, 0FFFFFFFFh
		jmp	loc_408946
; ---------------------------------------------------------------------------

loc_40888B:				; CODE XREF: sub_408848+37j
		mov	eax, [ebp+var_98]
		mov	[ebp+var_C], eax
		lea	eax, [ebp+var_7C]
		add	eax, 64h
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_10], eax

loc_4088A3:				; CODE XREF: sub_408848+7Ej
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		and	eax, 0Fh
		movzx	edx, ds:byte_42499F[eax]
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		mov	eax, [ebp+var_C]
		shr	eax, 4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4088A3
		jmp	short loc_4088D4
; ---------------------------------------------------------------------------

loc_4088CA:				; CODE XREF: sub_408848+9Bj
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	30h

loc_4088D4:				; CODE XREF: sub_408848+80j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, 7
		jbe	short loc_4088CA
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	78h
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	30h
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	[esp+0A8h+var_A0], eax
		mov	eax, [ebp+var_10]
		mov	[esp+0A8h+var_A4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+var_A8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_408929
		mov	eax, [ebp+var_18]
		jmp	short loc_408946
; ---------------------------------------------------------------------------

loc_408929:				; CODE XREF: sub_408848+DAj
		mov	eax, [ebp+arg_1C]
		mov	edx, [eax]
		mov	ecx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, 0

loc_408946:				; CODE XREF: sub_408848+3Ej
					; sub_408848+DFj
		add	esp, 0A4h
		pop	ebx
		pop	ebp
		retn
sub_408848	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40894F	proc near		; CODE XREF: sub_408A03+468p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		sub	eax, 15h	; switch 8 cases
		cmp	eax, 7
		ja	short loc_4089F5 ; jumptable 00408982 default case
		mov	eax, ds:off_4249B4[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_408984:				; CODE XREF: sub_40894F+33j
					; DATA XREF: .rdata:off_4249B4o
		mov	eax, [ebp+var_10] ; jumptable 00408982 case 21
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], dl
		jmp	short loc_4089FC
; ---------------------------------------------------------------------------

loc_408990:				; CODE XREF: sub_40894F+33j
					; DATA XREF: .rdata:off_4249B4o
		mov	eax, [ebp+var_10] ; jumptable 00408982 case 22
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], dx
		jmp	short loc_4089FC
; ---------------------------------------------------------------------------

loc_40899D:				; CODE XREF: sub_40894F+33j
					; DATA XREF: .rdata:off_4249B4o
		mov	eax, [ebp+var_10] ; jumptable 00408982 case 24
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_4089FC
; ---------------------------------------------------------------------------

loc_4089A9:				; CODE XREF: sub_40894F+33j
					; DATA XREF: .rdata:off_4249B4o
		mov	ecx, [ebp+var_10] ; jumptable 00408982 case 25
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, 0
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_4089FC
; ---------------------------------------------------------------------------

loc_4089BD:				; CODE XREF: sub_40894F+33j
					; DATA XREF: .rdata:off_4249B4o
		mov	ecx, [ebp+var_10] ; jumptable 00408982 case 26
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, 0
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_4089FC
; ---------------------------------------------------------------------------

loc_4089D1:				; CODE XREF: sub_40894F+33j
					; DATA XREF: .rdata:off_4249B4o
		mov	eax, [ebp+var_10] ; jumptable 00408982 case 27
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_4089FC
; ---------------------------------------------------------------------------

loc_4089DD:				; CODE XREF: sub_40894F+33j
					; DATA XREF: .rdata:off_4249B4o
		mov	eax, [ebp+var_10] ; jumptable 00408982 case 28
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_4089FC
; ---------------------------------------------------------------------------

loc_4089E9:				; CODE XREF: sub_40894F+33j
					; DATA XREF: .rdata:off_4249B4o
		mov	eax, [ebp+var_10] ; jumptable 00408982 case 23
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_4089FC
; ---------------------------------------------------------------------------

loc_4089F5:				; CODE XREF: sub_40894F+2Aj
		mov	eax, 0FFFFFFFFh	; jumptable 00408982 default case
		jmp	short locret_408A01
; ---------------------------------------------------------------------------

loc_4089FC:				; CODE XREF: sub_40894F+3Fj
					; sub_40894F+4Cj ...
		mov	eax, 0

locret_408A01:				; CODE XREF: sub_40894F+ABj
		leave
		retn
sub_40894F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408A03	proc near		; CODE XREF: sub_408EE3+550p

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		jmp	loc_408E83
; ---------------------------------------------------------------------------

loc_408A28:				; CODE XREF: sub_408A03+488j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_408A3B
		add	[ebp+var_10], 1
		jmp	loc_408E83
; ---------------------------------------------------------------------------

loc_408A3B:				; CODE XREF: sub_408A03+2Dj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jz	short loc_408A8B
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_408A7C
		mov	eax, [ebp+var_C]
		jmp	locret_408EE1
; ---------------------------------------------------------------------------

loc_408A7C:				; CODE XREF: sub_408A03+6Fj
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_408A8B:				; CODE XREF: sub_408A03+3Ej
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_408ADF
		mov	[esp+58h+var_50], 1
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_408AC3
		mov	eax, [ebp+var_C]
		jmp	locret_408EE1
; ---------------------------------------------------------------------------

loc_408AC3:				; CODE XREF: sub_408A03+B6j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		add	[ebp+var_10], 2
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_8], eax
		jmp	loc_408E83
; ---------------------------------------------------------------------------

loc_408ADF:				; CODE XREF: sub_408A03+93j
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_8], eax
		mov	eax, [ebp+var_18]
		cmp	eax, [ebp+arg_10]
		jb	short loc_408B11
		mov	[esp+58h+var_50], 52Dh ; int
		mov	[esp+58h+var_54], offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aArgidxArgspecs ; "argidx < argspecs_len"
		call	sub_421040

loc_408B11:				; CODE XREF: sub_408A03+F0j
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	loc_408BA5
		mov	eax, [ebp+var_14]
		mov	eax, [eax+1Ch]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	eax, 6
		jz	short loc_408B5C
		mov	[esp+58h+var_50], 533h ; int
		mov	[esp+58h+var_54], offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aValuetableArgW ; "valuetable[arg->width_pos-1].vt == VALT"...
		call	sub_421040

loc_408B5C:				; CODE XREF: sub_408A03+13Bj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+1Ch]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_14]
		mov	[eax+8], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		test	eax, eax
		jns	short loc_408BA5
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	edx, eax
		neg	edx
		mov	eax, [ebp+var_14]
		mov	[eax+8], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	edx, eax
		or	edx, 2
		mov	eax, [ebp+var_14]
		mov	[eax+4], edx

loc_408BA5:				; CODE XREF: sub_408A03+11Bj
					; sub_408A03+17Fj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_408C1A
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	eax, 6
		jz	short loc_408BE8
		mov	[esp+58h+var_50], 53Dh ; int
		mov	[esp+58h+var_54], offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aValuetableArgP ; "valuetable[arg->precision_pos-1].vt	== "...
		call	sub_421040

loc_408BE8:				; CODE XREF: sub_408A03+1C7j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_14]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jns	short loc_408C1A
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+0Ch], 0FFFFFFFFh

loc_408C1A:				; CODE XREF: sub_408A03+1ABj
					; sub_408A03+20Bj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_408C40
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		cmp	eax, 11h
		jnz	short loc_408C40
		mov	eax, [ebp+arg_18]
		mov	[esp+58h+var_58], eax ;	int
		call	strerror
		mov	[ebp+var_30], eax
		jmp	short loc_408CAA
; ---------------------------------------------------------------------------

loc_408C40:				; CODE XREF: sub_408A03+220j
					; sub_408A03+22Bj
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+24h]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	ecx, eax
		jz	short loc_408C7D
		mov	[esp+58h+var_50], 547h ; int
		mov	[esp+58h+var_54], offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aArgVtValuetabl ; "arg->vt == valuetable[arg->arg_pos-1].v"...
		call	sub_421040

loc_408C7D:				; CODE XREF: sub_408A03+25Cj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	edx, [eax+8]
		mov	[ebp+var_30], edx
		mov	edx, [eax+0Ch]
		mov	[ebp+var_2C], edx
		mov	edx, [eax+10h]
		mov	[ebp+var_28], edx
		mov	eax, [eax+14h]
		mov	[ebp+var_24], eax

loc_408CAA:				; CODE XREF: sub_408A03+23Bj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		cmp	eax, 12h	; switch 19 cases
		ja	loc_408E74	; jumptable 00408CC0 default case
		mov	eax, ds:off_424AAC[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_408CC2:				; CODE XREF: sub_408A03+2BDj
					; DATA XREF: .rdata:off_424AACo
		mov	[esp+58h+var_50], 54Dh ; jumptable 00408CC0 case 0
		mov	[esp+58h+var_54], offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aBug ;	"!\"bug\""
		call	sub_421040
		jmp	loc_408E74	; jumptable 00408CC0 default case
; ---------------------------------------------------------------------------

loc_408CE3:				; CODE XREF: sub_408A03+2BDj
					; DATA XREF: .rdata:off_424AACo
		mov	eax, [ebp+arg_1C] ; jumptable 00408CC0 cases 1-5
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_407B6D
		mov	[ebp+var_C], eax
		jmp	loc_408E74	; jumptable 00408CC0 default case
; ---------------------------------------------------------------------------

loc_408D27:				; CODE XREF: sub_408A03+2BDj
					; DATA XREF: .rdata:off_424AACo
		mov	eax, [ebp+arg_1C] ; jumptable 00408CC0 cases 6-13
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_408200
		mov	[ebp+var_C], eax
		jmp	loc_408E74	; jumptable 00408CC0 default case
; ---------------------------------------------------------------------------

loc_408D6B:				; CODE XREF: sub_408A03+2BDj
					; DATA XREF: .rdata:off_424AACo
		mov	eax, [ebp+arg_1C] ; jumptable 00408CC0 case 14
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_408635
		mov	[ebp+var_C], eax
		jmp	loc_408E74	; jumptable 00408CC0 default case
; ---------------------------------------------------------------------------

loc_408DAF:				; CODE XREF: sub_408A03+2BDj
					; DATA XREF: .rdata:off_424AACo
		mov	eax, [ebp+arg_1C] ; jumptable 00408CC0 cases 15,17
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_4086A7
		mov	[ebp+var_C], eax
		jmp	loc_408E74	; jumptable 00408CC0 default case
; ---------------------------------------------------------------------------

loc_408DF3:				; CODE XREF: sub_408A03+2BDj
					; DATA XREF: .rdata:off_424AACo
		mov	eax, [ebp+arg_1C] ; jumptable 00408CC0 case 16
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_408848
		mov	[ebp+var_C], eax
		jmp	short loc_408E74 ; jumptable 00408CC0 default case
; ---------------------------------------------------------------------------

loc_408E34:				; CODE XREF: sub_408A03+2BDj
					; DATA XREF: .rdata:off_424AACo
		mov	eax, [ebp+arg_1C] ; jumptable 00408CC0 case 18
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_40894F
		mov	[ebp+var_C], eax
		nop

loc_408E74:				; CODE XREF: sub_408A03+2B0j
					; sub_408A03+2DBj ...
		cmp	[ebp+var_C], 0	; jumptable 00408CC0 default case
		jz	short loc_408E7F
		mov	eax, [ebp+var_C]
		jmp	short locret_408EE1
; ---------------------------------------------------------------------------

loc_408E7F:				; CODE XREF: sub_408A03+475j
		add	[ebp+var_14], 28h

loc_408E83:				; CODE XREF: sub_408A03+20j
					; sub_408A03+33j ...
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_408A28
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_408EC1
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		jmp	short loc_408EC6
; ---------------------------------------------------------------------------

loc_408EC1:				; CODE XREF: sub_408A03+4A1j
		mov	eax, 0

loc_408EC6:				; CODE XREF: sub_408A03+4BCj
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_408EDE
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_408EDE:				; CODE XREF: sub_408A03+4CAj
		mov	eax, [ebp+var_C]

locret_408EE1:				; CODE XREF: sub_408A03+74j
					; sub_408A03+BBj ...
		leave
		retn
sub_408A03	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408EE3	proc near		; CODE XREF: .text:0040950Fp
					; .text:00409546p ...

NumOfElements	= dword	ptr -1E8h
SizeOfElements	= dword	ptr -1E4h
var_1E0		= dword	ptr -1E0h
var_1DC		= dword	ptr -1DCh
var_1D8		= dword	ptr -1D8h
var_1D4		= dword	ptr -1D4h
var_1D0		= dword	ptr -1D0h
var_1CC		= dword	ptr -1CCh
var_1BC		= dword	ptr -1BCh
var_1B4		= dword	ptr -1B4h
var_1B0		= byte ptr -1B0h
var_F0		= dword	ptr -0F0h
var_EC		= dword	ptr -0ECh
var_E8		= byte ptr -0E8h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Memory		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 1E0h
		lea	eax, [ebp+var_E8]
		mov	[ebp+var_EC], eax
		lea	eax, [ebp+var_1B0]
		mov	[ebp+Memory], eax
		mov	[ebp+var_1B4], 0
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_F0]
		mov	[esp+1E8h+var_1DC], eax
		mov	[esp+1E8h+var_1E0], 5
		lea	eax, [ebp+var_EC]
		mov	[esp+1E8h+SizeOfElements], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+1E8h+NumOfElements], eax
		call	sub_407099
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_40945D
		mov	[ebp+var_14], 0
		mov	[ebp+var_1C], 0
		jmp	loc_409029
; ---------------------------------------------------------------------------

loc_408F60:				; CODE XREF: sub_408EE3+14Fj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_408FB5
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, [ebp+var_1C]
		jle	short loc_408FB5
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		mov	[ebp+var_1C], eax

loc_408FB5:				; CODE XREF: sub_408EE3+98j
					; sub_408EE3+B5j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		cmp	eax, [ebp+var_1C]
		jle	short loc_408FED
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		mov	[ebp+var_1C], eax

loc_408FED:				; CODE XREF: sub_408EE3+EDj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		cmp	eax, [ebp+var_1C]
		jle	short loc_409025
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		mov	[ebp+var_1C], eax

loc_409025:				; CODE XREF: sub_408EE3+125j
		add	[ebp+var_14], 1

loc_409029:				; CODE XREF: sub_408EE3+78j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_408F60
		cmp	[ebp+var_1C], 0
		jnz	loc_40911D
		mov	[ebp+var_14], 0
		jmp	loc_409109
; ---------------------------------------------------------------------------

loc_40904E:				; CODE XREF: sub_408EE3+22Fj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_40908B
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		lea	edx, [ecx+eax]
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		mov	[edx+1Ch], eax

loc_40908B:				; CODE XREF: sub_408EE3+186j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_4090C8
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		lea	edx, [ecx+eax]
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		mov	[edx+20h], eax

loc_4090C8:				; CODE XREF: sub_408EE3+1C3j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_409105
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		lea	edx, [ecx+eax]
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		mov	[edx+18h], eax

loc_409105:				; CODE XREF: sub_408EE3+200j
		add	[ebp+var_14], 1

loc_409109:				; CODE XREF: sub_408EE3+166j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_40904E
		jmp	loc_4091D6
; ---------------------------------------------------------------------------

loc_40911D:				; CODE XREF: sub_408EE3+159j
		mov	[ebp+var_14], 0
		jmp	loc_4091C7
; ---------------------------------------------------------------------------

loc_409129:				; CODE XREF: sub_408EE3+2EDj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		test	eax, eax
		jz	loc_409447
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_409186
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	loc_409447

loc_409186:				; CODE XREF: sub_408EE3+281j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_4091C3
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		test	eax, eax
		jz	loc_409447

loc_4091C3:				; CODE XREF: sub_408EE3+2BEj
		add	[ebp+var_14], 1

loc_4091C7:				; CODE XREF: sub_408EE3+241j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_409129

loc_4091D6:				; CODE XREF: sub_408EE3+235j
		cmp	[ebp+var_1C], 0
		js	loc_409447
		mov	ebx, [ebp+var_1C]
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1BC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1BC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	ebx, eax
		jnb	loc_409447
		mov	eax, [ebp+var_1C]
		cmp	eax, 8
		jbe	short loc_409239
		mov	eax, [ebp+var_1C]
		mov	[esp+1E8h+SizeOfElements], 18h ; SizeOfElements
		mov	[esp+1E8h+NumOfElements], eax ;	NumOfElements
		call	calloc
		mov	[ebp+Memory], eax
		cmp	[ebp+Memory], 0
		jnz	short loc_409261
		jmp	loc_409454
; ---------------------------------------------------------------------------

loc_409239:				; CODE XREF: sub_408EE3+333j
		mov	[ebp+var_18], 0
		jmp	short loc_40925B
; ---------------------------------------------------------------------------

loc_409242:				; CODE XREF: sub_408EE3+37Cj
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	dword ptr [eax], 0
		add	[ebp+var_18], 1

loc_40925B:				; CODE XREF: sub_408EE3+35Dj
		cmp	[ebp+var_18], 7
		jbe	short loc_409242

loc_409261:				; CODE XREF: sub_408EE3+34Fj
		mov	[ebp+var_14], 0
		jmp	loc_4093C2
; ---------------------------------------------------------------------------

loc_40926D:				; CODE XREF: sub_408EE3+4E8j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_4092EC
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_40943D
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		mov	ecx, eax
		add	ecx, [ebp+Memory]
		mov	ebx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ebx
		mov	eax, [eax+24h]
		mov	[ecx], eax

loc_4092EC:				; CODE XREF: sub_408EE3+3A5j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_409355
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_409440
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	dword ptr [eax], 6

loc_409355:				; CODE XREF: sub_408EE3+424j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_4093BE
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_409443
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	dword ptr [eax], 6

loc_4093BE:				; CODE XREF: sub_408EE3+48Dj
		add	[ebp+var_14], 1

loc_4093C2:				; CODE XREF: sub_408EE3+385j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_40926D
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+arg_C]
		mov	[esp+1E8h+var_1E0], edx
		mov	[esp+1E8h+SizeOfElements], eax
		mov	eax, [ebp+Memory]
		mov	[esp+1E8h+NumOfElements], eax
		call	sub_407811
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_409446
		mov	edx, [ebp+var_F0]
		mov	eax, [ebp+var_EC]
		lea	ecx, [ebp+var_1B4]
		mov	[esp+1E8h+var_1CC], ecx
		mov	ecx, [ebp+var_20]
		mov	[esp+1E8h+var_1D0], ecx
		mov	ecx, [ebp+Memory]
		mov	[esp+1E8h+var_1D4], ecx
		mov	[esp+1E8h+var_1D8], edx
		mov	[esp+1E8h+var_1DC], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+1E8h+var_1E0], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+1E8h+SizeOfElements], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+1E8h+NumOfElements], eax
		call	sub_408A03
		mov	[ebp+var_10], eax
		jmp	short loc_40945E
; ---------------------------------------------------------------------------

loc_40943D:				; CODE XREF: sub_408EE3+3D8j
		nop
		jmp	short loc_409447
; ---------------------------------------------------------------------------

loc_409440:				; CODE XREF: sub_408EE3+457j
		nop
		jmp	short loc_409447
; ---------------------------------------------------------------------------

loc_409443:				; CODE XREF: sub_408EE3+4C0j
		nop
		jmp	short loc_409447
; ---------------------------------------------------------------------------

loc_409446:				; CODE XREF: sub_408EE3+50Ej
		nop

loc_409447:				; CODE XREF: sub_408EE3+260j
					; sub_408EE3+29Dj ...
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h

loc_409454:				; CODE XREF: sub_408EE3+351j
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_40945E
; ---------------------------------------------------------------------------

loc_40945D:				; CODE XREF: sub_408EE3+64j
		nop

loc_40945E:				; CODE XREF: sub_408EE3+558j
					; sub_408EE3+578j
		lea	eax, [ebp+var_1B0]
		cmp	[ebp+Memory], eax
		jz	short loc_409474
		mov	eax, [ebp+Memory]
		mov	[esp+1E8h+NumOfElements], eax ;	Memory
		call	free

loc_409474:				; CODE XREF: sub_408EE3+584j
		mov	edx, [ebp+var_EC]
		lea	eax, [ebp+var_E8]
		cmp	edx, eax
		jz	short loc_409492
		mov	eax, [ebp+var_EC]
		mov	[esp+1E8h+NumOfElements], eax ;	Memory
		call	free

loc_409492:				; CODE XREF: sub_408EE3+59Fj
		mov	eax, [ebp+var_10]
		add	esp, 1E0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_408EE3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40949F(int, void *, size_t)
sub_40949F	proc near		; DATA XREF: .text:00409508o
					; .text:0040953Fo ...

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 1 ; Count
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+Size],	edx ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		cmp	eax, 1
		jz	short loc_4094D8
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4094DD
; ---------------------------------------------------------------------------

loc_4094D8:				; CODE XREF: sub_40949F+30j
		mov	eax, 0

locret_4094DD:				; CODE XREF: sub_40949F+37j
		leave
		retn
sub_40949F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	edx, ds:_iob
		add	edx, 40h
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	dword ptr [esp], offset	sub_40949F
		call	sub_408EE3
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+10h]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	sub_40949F
		call	sub_408EE3
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	sub_40949F
		call	sub_408EE3
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40957C(int, void *, size_t)
sub_40957C	proc near		; CODE XREF: sub_409638+6Dp
					; DATA XREF: sub_409638+42o

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_409631
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	edx, eax
		jnb	short loc_40961C
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	ecx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		add	eax, ecx
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		jmp	short loc_409631
; ---------------------------------------------------------------------------

loc_4095F4:				; CODE XREF: sub_40957C+B3j
		mov	eax, [ebp+var_C]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+arg_4]
		movzx	edx, byte ptr [edx]
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		add	[ebp+arg_4], 1
		sub	[ebp+arg_8], 1

loc_40961C:				; CODE XREF: sub_40957C+3Dj
		cmp	[ebp+arg_8], 0
		jz	short loc_409631
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	edx, eax
		jb	short loc_4095F4

loc_409631:				; CODE XREF: sub_40957C+25j
					; sub_40957C+76j ...
		mov	eax, 0
		leave
		retn
sub_40957C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409638	proc near		; CODE XREF: sub_4096F1+29p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_18], 0
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_40965D
		mov	eax, [ebp+arg_0]
		jmp	short loc_409662
; ---------------------------------------------------------------------------

loc_40965D:				; CODE XREF: sub_409638+1Ej
		mov	eax, 0

loc_409662:				; CODE XREF: sub_409638+23j
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_34], eax
		mov	[esp+38h+var_38], offset sub_40957C
		call	sub_408EE3
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4096AD
		mov	[esp+38h+var_30], 1 ; size_t
		mov	[esp+38h+var_34], offset byte_424AF8 ; void *
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_38], eax ;	int
		call	sub_40957C
		mov	[ebp+var_C], eax

loc_4096AD:				; CODE XREF: sub_409638+55j
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_4096BA
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4096EF
; ---------------------------------------------------------------------------

loc_4096BA:				; CODE XREF: sub_409638+79j
		cmp	[ebp+arg_4], 0
		jz	short loc_4096E3
		cmp	[ebp+arg_0], 0
		jz	short loc_4096E3
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jz	short loc_4096E3
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_1C]
		cmp	edx, eax
		jb	short loc_4096E3
		mov	eax, [ebp+var_1C]
		sub	eax, 1
		add	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0

loc_4096E3:				; CODE XREF: sub_409638+86j
					; sub_409638+8Cj ...
		mov	eax, [ebp+var_18]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]

locret_4096EF:				; CODE XREF: sub_409638+80j
		leave
		retn
sub_409638	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4096F1	proc near		; CODE XREF: sub_401E48+23p
					; sub_401F1C+247p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_C]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_409638
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4096F1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409727(int, void *Src, size_t)
sub_409727	proc near		; CODE XREF: sub_409833+83p
					; DATA XREF: sub_409833+58o

Memory		= dword	ptr -28h
NewSize		= dword	ptr -24h
Size		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Src		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_409754
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_C]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, 0FFFFFFFFh
		jmp	locret_409831
; ---------------------------------------------------------------------------

loc_409754:				; CODE XREF: sub_409727+13j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	loc_4097F5
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		add	eax, [ebp+arg_8]
		lea	edx, [eax+200h]
		mov	eax, [ebp+var_C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	[esp+28h+NewSize], edx ; NewSize
		mov	[esp+28h+Memory], eax ;	Memory
		call	realloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4097EC
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4097BB
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		jmp	short loc_4097C0
; ---------------------------------------------------------------------------

loc_4097BB:				; CODE XREF: sub_409727+87j
		mov	eax, 0Ch

loc_4097C0:				; CODE XREF: sub_409727+92j
		mov	edx, [ebp+var_C]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	[esp+28h+Size],	edx ; Size
		mov	[esp+28h+NewSize], 0 ; Val
		mov	[esp+28h+Memory], eax ;	Dst
		call	memset
		mov	eax, 0FFFFFFFFh
		jmp	short locret_409831
; ---------------------------------------------------------------------------

loc_4097EC:				; CODE XREF: sub_409727+7Aj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		mov	[eax+0Ch], edx

loc_4097F5:				; CODE XREF: sub_409727+40j
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	ecx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		add	eax, ecx
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+NewSize], edx ; Src
		mov	[esp+28h+Memory], eax ;	Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, 0

locret_409831:				; CODE XREF: sub_409727+28j
					; sub_409727+C3j
		leave
		retn
sub_409727	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409833	proc near		; CODE XREF: sub_40994C+22p
					; sub_40A9F0+22p ...

Dst		= dword	ptr -38h
Val		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_1C], 0
		mov	[ebp+var_18], 200h
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dst], eax ; size_t
		call	sub_406CDA
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		test	eax, eax
		jnz	short loc_409876
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh
		jmp	locret_40994A
; ---------------------------------------------------------------------------

loc_409876:				; CODE XREF: sub_409833+2Ej
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Size],	eax
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+Val], eax
		mov	[esp+38h+Dst], offset sub_409727
		call	sub_408EE3
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4098BE
		mov	[esp+38h+Size],	1 ; size_t
		mov	[esp+38h+Val], offset byte_424AF8 ; Src
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+Dst], eax ; int
		call	sub_409727
		mov	[ebp+var_C], eax

loc_4098BE:				; CODE XREF: sub_409833+6Bj
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	short loc_4098DE
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jz	short loc_4098DE
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_1C]
		mov	[eax], edx

loc_4098DE:				; CODE XREF: sub_409833+8Fj
					; sub_409833+96j
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_409919
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Val], 0 ; Val
		mov	[esp+38h+Dst], eax ; Dst
		call	memset
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax ; void *
		call	sub_406E5D
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40994A
; ---------------------------------------------------------------------------

loc_409919:				; CODE XREF: sub_409833+AFj
		mov	eax, [ebp+var_14]
		test	eax, eax
		jnz	short loc_40993C
		mov	[esp+38h+Size],	6E9h ; int
		mov	[esp+38h+Val], offset a____Gnupg22__0 ;	"../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+38h+Dst], offset aParm_used ; "parm.used"
		call	sub_421040

loc_40993C:				; CODE XREF: sub_409833+EBj
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		sub	eax, 1

locret_40994A:				; CODE XREF: sub_409833+3Ej
					; sub_409833+E4j
		leave
		retn
sub_409833	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40994C	proc near		; CODE XREF: sub_40D9E6+54p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_409833
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40994C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40997C(LPCSTR)
sub_40997C	proc near		; CODE XREF: sub_409A09+42p

lpLibFileName	= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+lpLibFileName], eax ; lpLibFileName
		mov	eax, ds:LoadLibraryA
		call	eax ; LoadLibraryA
		sub	esp, 4
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40997C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40999A(HMODULE, LPCSTR)
sub_40999A	proc near		; CODE XREF: sub_409A09+5Ep

hModule		= dword	ptr -28h
lpProcName	= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_4099D8
		cmp	[ebp+arg_4], 0
		jz	short loc_4099D8
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lpProcName], eax ; lpProcName
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hModule], eax ; hModule
		mov	eax, ds:GetProcAddress
		call	eax ; GetProcAddress
		sub	esp, 8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4099D3
		mov	eax, 0
		jmp	short locret_4099DD
; ---------------------------------------------------------------------------

loc_4099D3:				; CODE XREF: sub_40999A+30j
		mov	eax, [ebp+var_C]
		jmp	short locret_4099DD
; ---------------------------------------------------------------------------

loc_4099D8:				; CODE XREF: sub_40999A+Aj
					; sub_40999A+10j
		mov	eax, 0

locret_4099DD:				; CODE XREF: sub_40999A+37j
					; sub_40999A+3Cj
		leave
		retn
sub_40999A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4099DF(HANDLE)
sub_4099DF	proc near		; CODE XREF: sub_409A09+77p

hObject		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_409A02
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		jmp	short locret_409A07
; ---------------------------------------------------------------------------

loc_409A02:				; CODE XREF: sub_4099DF+Aj
		mov	eax, 0FFFFFFFFh

locret_409A07:				; CODE XREF: sub_4099DF+21j
		leave
		retn
sub_4099DF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409A09	proc near		; CODE XREF: sub_409AE3+77p
					; sub_409EDD+5Ap ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, ds:dword_4289D4
		test	eax, eax
		jnz	loc_409AA4
		mov	ds:dword_4289D4, 1
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		jmp	short loc_409A90
; ---------------------------------------------------------------------------

loc_409A36:				; CODE XREF: sub_409A09+99j
		mov	eax, [ebp+var_10]
		mov	eax, off_4220E0[eax*4]
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax ;	LPCSTR
		call	sub_40997C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_409A8C
		mov	[esp+38h+var_34], offset aShgetfolderpat ; "SHGetFolderPathA"
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax ;	HMODULE
		call	sub_40999A
		mov	ds:dword_4289D8, eax
		mov	eax, ds:dword_4289D8
		test	eax, eax
		jnz	short loc_409A8C
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax ;	HANDLE
		call	sub_4099DF
		mov	[ebp+var_C], 0

loc_409A8C:				; CODE XREF: sub_409A09+4Ej
					; sub_409A09+6Fj
		add	[ebp+var_10], 1

loc_409A90:				; CODE XREF: sub_409A09+2Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_409AA4
		mov	eax, [ebp+var_10]
		mov	eax, off_4220E0[eax*4]
		test	eax, eax
		jnz	short loc_409A36

loc_409AA4:				; CODE XREF: sub_409A09+Dj
					; sub_409A09+8Bj
		mov	eax, ds:dword_4289D8
		test	eax, eax
		jz	short loc_409ADC
		mov	edx, ds:dword_4289D8
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	edx ; dword_4289D8
		sub	esp, 14h
		jmp	short locret_409AE1
; ---------------------------------------------------------------------------

loc_409ADC:				; CODE XREF: sub_409A09+A2j
		mov	eax, 0FFFFFFFFh

locret_409AE1:				; CODE XREF: sub_409A09+D1j
		leave
		retn
sub_409A09	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409AE3	proc near		; CODE XREF: sub_409C1D+14p
					; sub_409C1D+B2p

lpPathName	= dword	ptr -148h
lpSecurityAttributes= dword ptr	-144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_11C		= dword	ptr -11Ch
var_114		= byte ptr -114h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:lpPathName
		test	eax, eax
		jnz	loc_409C11
		call	sub_409DB0
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_428860
		test	eax, eax
		jz	short loc_409B31
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+lpSecurityAttributes], offset	aHome_0	; "\\home"
		mov	eax, [ebp+var_C]
		mov	[esp+148h+lpPathName], eax
		call	sub_41C22E
		mov	ds:lpPathName, eax
		jmp	loc_409C11
; ---------------------------------------------------------------------------

loc_409B31:				; CODE XREF: sub_409AE3+27j
		lea	eax, [ebp+var_114]
		mov	[esp+148h+var_138], eax
		mov	[esp+148h+var_13C], 0
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+lpSecurityAttributes], 801Ah
		mov	[esp+148h+lpPathName], 0
		call	sub_409A09
		test	eax, eax
		js	loc_409C07
		lea	eax, [ebp+var_114]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 7
		mov	[esp+148h+lpPathName], eax ; size_t
		call	sub_406D00
		mov	[ebp+var_10], eax
		mov	ebx, offset aGnupg ; "\\gnupg"
		lea	eax, [ebp+var_114]
		mov	[esp+148h+lpSecurityAttributes], eax
		mov	eax, [ebp+var_10]
		mov	[esp+148h+lpPathName], eax
		call	sub_41BD45
		mov	edx, [ebx]
		mov	[eax], edx
		movzx	edx, word ptr [ebx+4]
		mov	[eax+4], dx
		movzx	edx, byte ptr [ebx+6]
		mov	[eax+6], dl
		mov	eax, [ebp+var_10]
		mov	ds:lpPathName, eax
		mov	eax, ds:lpPathName
		mov	[esp+148h+lpSecurityAttributes], 0
		mov	[esp+148h+lpPathName], eax
		call	_access
		test	eax, eax
		jz	short loc_409C11
		mov	eax, ds:lpPathName
		mov	[esp+148h+lpSecurityAttributes], 0 ; lpSecurityAttributes
		mov	[esp+148h+lpPathName], eax ; lpPathName
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8
		jmp	short loc_409C11
; ---------------------------------------------------------------------------

loc_409C07:				; CODE XREF: sub_409AE3+7Ej
		mov	ds:lpPathName, offset aCGnupg ;	"c:/gnupg"

loc_409C11:				; CODE XREF: sub_409AE3+12j
					; sub_409AE3+49j ...
		mov	eax, ds:lpPathName
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_409AE3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409C1D	proc near		; CODE XREF: sub_40377D+7Bp

VarName		= dword	ptr -28h
var_24		= dword	ptr -24h
lpValueName	= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_409DB0
		mov	eax, ds:dword_428860
		test	eax, eax
		jz	short loc_409C3B
		call	sub_409AE3
		jmp	locret_409CFB
; ---------------------------------------------------------------------------

loc_409C3B:				; CODE XREF: sub_409C1D+12j
		mov	[esp+28h+VarName], offset aGnupghome ; "GNUPGHOME"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_409C5E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_409CE1

loc_409C5E:				; CODE XREF: sub_409C1D+31j
		mov	eax, ds:dword_4289CC
		test	eax, eax
		jnz	short loc_409CD9
		cmp	[ebp+var_C], 0
		jz	short loc_409C77
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_409CC6

loc_409C77:				; CODE XREF: sub_409C1D+4Ej
		mov	[esp+28h+lpValueName], offset ValueName	; "HomeDir"
		mov	[esp+28h+var_24], offset aSoftwareGnuGnu ; "Software\\GNU\\GnuPG"
		mov	[esp+28h+VarName], 0 ; int
		call	sub_41E62E
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_409CB8
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_409CB8
		mov	eax, [ebp+var_10]
		mov	[esp+28h+VarName], eax ; void *
		call	sub_406E5D
		mov	[ebp+var_10], 0

loc_409CB8:				; CODE XREF: sub_409C1D+7Dj
					; sub_409C1D+87j
		cmp	[ebp+var_10], 0
		jz	short loc_409CC6
		mov	eax, [ebp+var_10]
		mov	ds:dword_4289CC, eax

loc_409CC6:				; CODE XREF: sub_409C1D+58j
					; sub_409C1D+9Fj
		mov	eax, ds:dword_4289CC
		test	eax, eax
		jnz	short loc_409CD9
		call	sub_409AE3
		mov	ds:dword_4289CC, eax

loc_409CD9:				; CODE XREF: sub_409C1D+48j
					; sub_409C1D+B0j
		mov	eax, ds:dword_4289CC
		mov	[ebp+var_C], eax

loc_409CE1:				; CODE XREF: sub_409C1D+3Bj
		cmp	[ebp+var_C], 0
		jz	short loc_409CF1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_409CF8

loc_409CF1:				; CODE XREF: sub_409C1D+C8j
		mov	[ebp+var_C], offset aCGnupg ; "c:/gnupg"

loc_409CF8:				; CODE XREF: sub_409C1D+D2j
		mov	eax, [ebp+var_C]

locret_409CFB:				; CODE XREF: sub_409C1D+19j
		leave
		retn
sub_409C1D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409CFD	proc near		; CODE XREF: sub_409DB0+91p

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	[esp+38h+var_30], 0
		mov	dword ptr [esp+38h+var_34], offset aGpgconf_exe	; "\\gpgconf.exe"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_41C22E
		mov	[ebp+var_C], eax
		mov	dword ptr [esp+38h+var_34], 0
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	_access
		test	eax, eax
		jz	short loc_409D4F
		mov	eax, [ebp+var_C]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aRequiredBinary ; "required binary '%s' is not installed\n"
		call	sub_41A665
		jmp	short loc_409D9E
; ---------------------------------------------------------------------------

loc_409D4F:				; CODE XREF: sub_409CFD+3Bj
		mov	ebx, offset aCtl ; "ctl"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 3
		add	eax, [ebp+var_C]
		mov	edx, [ebx]
		mov	[eax], edx
		mov	dword ptr [esp+38h+var_34], 0
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	_access
		test	eax, eax
		jnz	short loc_409D9E
		mov	ds:dword_428860, 1

loc_409D9E:				; CODE XREF: sub_409CFD+50j
					; sub_409CFD+95j
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax ;	void *
		call	sub_406E5D
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_409CFD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409DB0	proc near		; CODE XREF: sub_409AE3+18p
					; sub_409C1D+6p ...

hModule		= dword	ptr -28h
lpFilename	= dword	ptr -24h
nSize		= dword	ptr -20h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, ds:dword_4288AC
		test	eax, eax
		jnz	loc_409EBF
		mov	[esp+28h+nSize], 104h ;	nSize
		mov	[esp+28h+lpFilename], offset Filename ;	lpFilename
		mov	[esp+28h+hModule], 0 ; hModule
		mov	eax, ds:GetModuleFileNameA
		call	eax ; GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_409E0D
		mov	[esp+28h+hModule], 0 ; DWORD
		call	sub_41B9A2
		mov	[esp+28h+lpFilename], eax ; char
		mov	[esp+28h+hModule], offset aGetmodulefilen ; "GetModuleFileName failed: %s\n"
		call	sub_41A702
		mov	ds:Filename, 0

loc_409E0D:				; CODE XREF: sub_409DB0+38j
		mov	ds:dword_4288AC, 1
		mov	[esp+28h+lpFilename], 5Ch ; Ch
		mov	[esp+28h+hModule], offset Filename ; Str
		call	strrchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_409E9E
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	[esp+28h+hModule], offset Filename
		call	sub_409CFD
		mov	[esp+28h+lpFilename], 5Ch ; Ch
		mov	[esp+28h+hModule], offset Filename ; Str
		call	strrchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_409E9E
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	edx, eax
		mov	eax, offset aBin ; "bin"
		mov	ecx, 4
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_409E9E
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	ds:dword_428864, 1

loc_409E9E:				; CODE XREF: sub_409DB0+82j
					; sub_409DB0+B1j ...
		cmp	[ebp+var_C], 0
		jnz	short loc_409EBF
		mov	[esp+28h+lpFilename], offset Filename ;	char
		mov	[esp+28h+hModule], offset aBadFilenameSRe ; "bad filename `%s' returned for this pro"...
		call	sub_41A702
		mov	ds:Filename, 0

loc_409EBF:				; CODE XREF: sub_409DB0+Fj
					; sub_409DB0+F2j
		movzx	eax, ds:Filename
		test	al, al
		jz	short loc_409ED1
		mov	eax, offset Filename
		jmp	short loc_409ED6
; ---------------------------------------------------------------------------

loc_409ED1:				; CODE XREF: sub_409DB0+118j
		mov	eax, offset aCGnupg_0 ;	"c:\\gnupg"

loc_409ED6:				; CODE XREF: sub_409DB0+11Fj
		lea	esp, [ebp-8]
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_409DB0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409EDD	proc near		; CODE XREF: sub_409FC4+15p

var_148		= dword	ptr -148h
var_144		= dword	ptr -144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_11C		= dword	ptr -11Ch
var_114		= byte ptr -114h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:dword_4288A8
		test	eax, eax
		jnz	loc_409FB5
		call	sub_409DB0
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_428860
		test	eax, eax
		jz	short loc_409F0E
		mov	eax, [ebp+var_C]
		jmp	loc_409FBA
; ---------------------------------------------------------------------------

loc_409F0E:				; CODE XREF: sub_409EDD+27j
		lea	eax, [ebp+var_114]
		mov	[esp+148h+var_138], eax
		mov	[esp+148h+var_13C], 0
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+var_144], 23h
		mov	[esp+148h+var_148], 0
		call	sub_409A09
		test	eax, eax
		js	short loc_409FA5
		lea	eax, [ebp+var_114]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 5
		mov	[esp+148h+var_148], eax	; size_t
		call	sub_406D00
		mov	[ebp+var_10], eax
		mov	ebx, offset aGnu ; "\\GNU"
		lea	eax, [ebp+var_114]
		mov	[esp+148h+var_144], eax
		mov	eax, [ebp+var_10]
		mov	[esp+148h+var_148], eax
		call	sub_41BD45
		mov	edx, [ebx]
		mov	[eax], edx
		movzx	edx, byte ptr [ebx+4]
		mov	[eax+4], dl
		mov	eax, [ebp+var_10]
		mov	ds:dword_4288A8, eax
		jmp	short loc_409FB5
; ---------------------------------------------------------------------------

loc_409FA5:				; CODE XREF: sub_409EDD+61j
		mov	eax, [ebp+var_C]
		mov	[esp+148h+var_148], eax	; char *
		call	sub_406E03
		mov	ds:dword_4288A8, eax

loc_409FB5:				; CODE XREF: sub_409EDD+12j
					; sub_409EDD+C6j
		mov	eax, ds:dword_4288A8

loc_409FBA:				; CODE XREF: sub_409EDD+2Cj
		add	esp, 140h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_409EDD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409FC4	proc near		; CODE XREF: sub_402175+1BEp

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_4288A4
		test	eax, eax
		jnz	loc_40A05B
		call	sub_409EDD
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aEtcGnupg ; "\\etc\\gnupg"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax ; size_t
		call	sub_406D00
		mov	ds:dword_4288A4, eax
		mov	eax, ds:dword_4288A4
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_41BD45
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40A05B:				; CODE XREF: sub_409FC4+Fj
		mov	eax, ds:dword_4288A4
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_409FC4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A067	proc near		; CODE XREF: sub_402175+1EAp
					; sub_40A0B3+6p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_409DB0
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_428864
		test	eax, eax
		jz	short loc_40A0AE
		mov	eax, ds:dword_4288A0
		test	eax, eax
		jnz	short loc_40A0A7
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], offset aBin_0	; "\\bin"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_41C22E
		mov	ds:dword_4288A0, eax

loc_40A0A7:				; CODE XREF: sub_40A067+1Ej
		mov	eax, ds:dword_4288A0
		jmp	short locret_40A0B1
; ---------------------------------------------------------------------------

loc_40A0AE:				; CODE XREF: sub_40A067+15j
		mov	eax, [ebp+var_C]

locret_40A0B1:				; CODE XREF: sub_40A067+45j
		leave
		retn
sub_40A067	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A0B3	proc near		; CODE XREF: sub_402175+242p
					; sub_40A3B2+160p ...
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		call	sub_40A067
		leave
		retn
sub_40A0B3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A0C0	proc near		; CODE XREF: sub_402175+216p

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_42889C
		test	eax, eax
		jnz	loc_40A157
		call	sub_409DB0
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aLibGnupg ; "\\lib\\gnupg"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax ; size_t
		call	sub_406D00
		mov	ds:dword_42889C, eax
		mov	eax, ds:dword_42889C
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_41BD45
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40A157:				; CODE XREF: sub_40A0C0+Fj
		mov	eax, ds:dword_42889C
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40A0C0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A163	proc near		; CODE XREF: sub_402175+26Ep

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_428898
		test	eax, eax
		jnz	loc_40A1FA
		call	sub_409DB0
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aShareGnupg ; "\\share\\gnupg"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax ; size_t
		call	sub_406D00
		mov	ds:dword_428898, eax
		mov	eax, ds:dword_428898
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_41BD45
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40A1FA:				; CODE XREF: sub_40A163+Fj
		mov	eax, ds:dword_428898
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40A163	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A206	proc near		; CODE XREF: sub_40ACF4+6p

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_428894
		test	eax, eax
		jnz	loc_40A29D
		call	sub_409DB0
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aShareLocale ; "\\share\\locale"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax ; size_t
		call	sub_406D00
		mov	ds:dword_428894, eax
		mov	eax, ds:dword_428894
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_41BD45
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40A29D:				; CODE XREF: sub_40A206+Fj
		mov	eax, ds:dword_428894
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40A206	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:dword_428890
		test	eax, eax
		jnz	loc_40A3A3
		lea	eax, [ebp-110h]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 24h
		mov	dword ptr [esp], 0
		call	sub_409A09
		test	eax, eax
		jns	short loc_40A317
		mov	edx, offset aCWindows ;	"C:\\WINDOWS"
		lea	eax, [ebp-110h]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	ecx, word ptr [edx+8]
		mov	[eax+8], cx
		movzx	edx, byte ptr [edx+0Ah]
		mov	[eax+0Ah], dl

loc_40A317:				; CODE XREF: .text:0040A2F1j
		mov	dword ptr [ebp-0Ch], offset aS_dirmngr ; "\\S.dirmngr"
		lea	eax, [ebp-110h]
		mov	dword ptr [ebp-11Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-11Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-11Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-11Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	sub_406D00
		mov	ds:dword_428890, eax
		mov	eax, ds:dword_428890
		lea	edx, [ebp-110h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_41BD45
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_40A3A3:				; CODE XREF: .text:0040A2BBj
		mov	eax, ds:dword_428890
		add	esp, 140h
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A3B2	proc near		; CODE XREF: sub_406808+F1p
					; .text:0040DFADp

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		cmp	[ebp+arg_0], 0Ah ; switch 11 cases
		ja	loc_40A9CA	; jumptable 0040A3D1 default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_424CF0
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40A3D3:				; CODE XREF: sub_40A3B2+1Fj
					; DATA XREF: .rdata:off_424CF0o
		mov	eax, ds:dword_428868 ; jumptable 0040A3D1 case 1
		test	eax, eax
		jnz	loc_40A462
		call	sub_40A067
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aGpgAgent_exe ; "\\gpg-agent.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax ; size_t
		call	sub_406D00
		mov	ds:dword_428868, eax
		mov	eax, ds:dword_428868
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_41BD45
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40A462:				; CODE XREF: sub_40A3B2+28j
		mov	eax, ds:dword_428868
		jmp	loc_40A9E6
; ---------------------------------------------------------------------------

loc_40A46C:				; CODE XREF: sub_40A3B2+1Fj
					; DATA XREF: .rdata:off_424CF0o
		mov	eax, ds:dword_42886C ; jumptable 0040A3D1 case 2
		test	eax, eax
		jnz	loc_40A4FB
		call	sub_40A067
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aPinentry_exe ; "\\pinentry.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax ; size_t
		call	sub_406D00
		mov	ds:dword_42886C, eax
		mov	eax, ds:dword_42886C
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_41BD45
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40A4FB:				; CODE XREF: sub_40A3B2+C1j
		mov	eax, ds:dword_42886C
		jmp	loc_40A9E6
; ---------------------------------------------------------------------------

loc_40A505:				; CODE XREF: sub_40A3B2+1Fj
					; DATA XREF: .rdata:off_424CF0o
		mov	eax, ds:dword_428870 ; jumptable 0040A3D1 case 3
		test	eax, eax
		jnz	loc_40A594
		call	sub_40A0B3
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aScdaemon_exe ; "\\scdaemon.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax ; size_t
		call	sub_406D00
		mov	ds:dword_428870, eax
		mov	eax, ds:dword_428870
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_41BD45
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40A594:				; CODE XREF: sub_40A3B2+15Aj
		mov	eax, ds:dword_428870
		jmp	loc_40A9E6
; ---------------------------------------------------------------------------

loc_40A59E:				; CODE XREF: sub_40A3B2+1Fj
					; DATA XREF: .rdata:off_424CF0o
		mov	eax, ds:dword_428874 ; jumptable 0040A3D1 case 4
		test	eax, eax
		jnz	loc_40A62D
		call	sub_40A067
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aDirmngr_exe ; "\\dirmngr.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax ; size_t
		call	sub_406D00
		mov	ds:dword_428874, eax
		mov	eax, ds:dword_428874
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_41BD45
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40A62D:				; CODE XREF: sub_40A3B2+1F3j
		mov	eax, ds:dword_428874
		jmp	loc_40A9E6
; ---------------------------------------------------------------------------

loc_40A637:				; CODE XREF: sub_40A3B2+1Fj
					; DATA XREF: .rdata:off_424CF0o
		mov	eax, ds:dword_428878 ; jumptable 0040A3D1 case 5
		test	eax, eax
		jnz	loc_40A6C6
		call	sub_40A0B3
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aGpgProtectTool ; "\\gpg-protect-tool.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax ; size_t
		call	sub_406D00
		mov	ds:dword_428878, eax
		mov	eax, ds:dword_428878
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_41BD45
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40A6C6:				; CODE XREF: sub_40A3B2+28Cj
		mov	eax, ds:dword_428878
		jmp	loc_40A9E6
; ---------------------------------------------------------------------------

loc_40A6D0:				; CODE XREF: sub_40A3B2+1Fj
					; DATA XREF: .rdata:off_424CF0o
		mov	eax, ds:dword_42887C ; jumptable 0040A3D1 case 6
		test	eax, eax
		jnz	loc_40A75F
		call	sub_40A0B3
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aGpgCheckPatter ; "\\gpg-check-pattern.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax ; size_t
		call	sub_406D00
		mov	ds:dword_42887C, eax
		mov	eax, ds:dword_42887C
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_41BD45
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40A75F:				; CODE XREF: sub_40A3B2+325j
		mov	eax, ds:dword_42887C
		jmp	loc_40A9E6
; ---------------------------------------------------------------------------

loc_40A769:				; CODE XREF: sub_40A3B2+1Fj
					; DATA XREF: .rdata:off_424CF0o
		mov	eax, ds:dword_428880 ; jumptable 0040A3D1 case 7
		test	eax, eax
		jnz	loc_40A7F8
		call	sub_40A067
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aGpgsm_exe	; "\\gpgsm.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax ; size_t
		call	sub_406D00
		mov	ds:dword_428880, eax
		mov	eax, ds:dword_428880
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_41BD45
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40A7F8:				; CODE XREF: sub_40A3B2+3BEj
		mov	eax, ds:dword_428880
		jmp	loc_40A9E6
; ---------------------------------------------------------------------------

loc_40A802:				; CODE XREF: sub_40A3B2+1Fj
					; DATA XREF: .rdata:off_424CF0o
		mov	eax, ds:dword_428884 ; jumptable 0040A3D1 case 8
		test	eax, eax
		jnz	loc_40A891
		call	sub_40A067
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aGpg2_exe ; "\\gpg2.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax ; size_t
		call	sub_406D00
		mov	ds:dword_428884, eax
		mov	eax, ds:dword_428884
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_41BD45
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40A891:				; CODE XREF: sub_40A3B2+457j
		mov	eax, ds:dword_428884
		jmp	loc_40A9E6
; ---------------------------------------------------------------------------

loc_40A89B:				; CODE XREF: sub_40A3B2+1Fj
					; DATA XREF: .rdata:off_424CF0o
		mov	eax, ds:dword_428888 ; jumptable 0040A3D1 case 9
		test	eax, eax
		jnz	loc_40A92A
		call	sub_40A067
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aGpgConnectAg_1 ; "\\gpg-connect-agent.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax ; size_t
		call	sub_406D00
		mov	ds:dword_428888, eax
		mov	eax, ds:dword_428888
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_41BD45
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40A92A:				; CODE XREF: sub_40A3B2+4F0j
		mov	eax, ds:dword_428888
		jmp	loc_40A9E6
; ---------------------------------------------------------------------------

loc_40A934:				; CODE XREF: sub_40A3B2+1Fj
					; DATA XREF: .rdata:off_424CF0o
		mov	eax, ds:dword_42888C ; jumptable 0040A3D1 case 10
		test	eax, eax
		jnz	loc_40A9C3
		call	sub_40A067
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aGpgconf_exe ; "\\gpgconf.exe"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax ; size_t
		call	sub_406D00
		mov	ds:dword_42888C, eax
		mov	eax, ds:dword_42888C
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_41BD45
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40A9C3:				; CODE XREF: sub_40A3B2+589j
		mov	eax, ds:dword_42888C
		jmp	short loc_40A9E6
; ---------------------------------------------------------------------------

loc_40A9CA:				; CODE XREF: sub_40A3B2+Cj
					; sub_40A3B2+1Fj
					; DATA XREF: ...
		mov	[esp+38h+var_30], offset aGnupg_module_n ; jumptable 0040A3D1 default case
		mov	[esp+38h+Source], 229h
		mov	[esp+38h+Dest],	offset a____Gnupg22__1 ; "../../gnupg2-2.0.30/common/homedir.c"
		call	sub_41A7F4
; ---------------------------------------------------------------------------

loc_40A9E6:				; CODE XREF: sub_40A3B2+B5j
					; sub_40A3B2+14Ej ...
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40A3B2	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A9F0	proc near		; CODE XREF: sub_402175+2AAp
					; sub_402175+529p ...

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_409833
		test	eax, eax
		jns	short loc_40AA3C
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	int
		call	strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aEstream_asprin ; "estream_asprintf failed: %s\n"
		call	sub_41A6A8
; ---------------------------------------------------------------------------

loc_40AA3C:				; CODE XREF: sub_40A9F0+29j
		mov	eax, [ebp+var_10]
		leave
		retn
sub_40A9F0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_409833
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jns	short loc_40AA78
		mov	eax, 0
		jmp	short locret_40AA7B
; ---------------------------------------------------------------------------

loc_40AA78:				; CODE XREF: .text:0040AA6Fj
		mov	eax, [ebp-14h]

locret_40AA7B:				; CODE XREF: .text:0040AA76j
		leave
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40AA80(int, size_t)
sub_40AA80	proc near		; CODE XREF: sub_403672+14p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax ;	size_t
		call	sub_406CDA
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short locret_40AACE
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx

locret_40AACE:				; CODE XREF: sub_40AA80+3Dj
		leave
		retn
sub_40AA80	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0
		mov	edx, [ebp+0Ch]
		mov	eax, [ebp+8]
		mov	[eax+4], edx
		mov	eax, [ebp+8]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_406CED
		mov	edx, eax
		mov	eax, [ebp+8]
		mov	[eax+8], edx
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short locret_40AB1E
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx

locret_40AB1E:				; CODE XREF: .text:0040AB0Dj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40AB20(int, void *, size_t)
sub_40AB20	proc near		; CODE XREF: sub_403646+20p
					; sub_403672+74p ...

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	loc_40AC0D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	loc_40ABD7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		add	eax, [ebp+arg_8]
		lea	edx, [eax+400h]
		mov	eax, [ebp+arg_0]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+Src], edx ; size_t
		mov	[esp+28h+Dst], eax ; void *
		call	sub_406D79
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40ABCE
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40AB9A
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		jmp	short loc_40AB9F
; ---------------------------------------------------------------------------

loc_40AB9A:				; CODE XREF: sub_40AB20+6Dj
		mov	eax, 0Ch

loc_40AB9F:				; CODE XREF: sub_40AB20+78j
		mov	edx, [ebp+arg_0]
		mov	[edx+0Ch], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		jmp	short loc_40ABC6
; ---------------------------------------------------------------------------

loc_40ABB8:				; CODE XREF: sub_40AB20+AAj
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1

loc_40ABC6:				; CODE XREF: sub_40AB20+96j
		cmp	[ebp+var_10], 0
		jnz	short loc_40ABB8
		jmp	short locret_40AC0E
; ---------------------------------------------------------------------------

loc_40ABCE:				; CODE XREF: sub_40AB20+60j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		mov	[eax+8], edx

loc_40ABD7:				; CODE XREF: sub_40AB20+26j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		add	eax, edx
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		jmp	short locret_40AC0E
; ---------------------------------------------------------------------------

loc_40AC0D:				; CODE XREF: sub_40AB20+Ej
		nop

locret_40AC0E:				; CODE XREF: sub_40AB20+ACj
					; sub_40AB20+EBj
		leave
		retn
sub_40AB20	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40AB20
		add	esp, 24h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40AC52	proc near		; CODE XREF: sub_403672+87p

var_28		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_40ACC1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40ACAB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		jmp	short loc_40AC8D
; ---------------------------------------------------------------------------

loc_40AC7F:				; CODE XREF: sub_40AC52+3Fj
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1

loc_40AC8D:				; CODE XREF: sub_40AC52+2Bj
		cmp	[ebp+var_10], 0
		jnz	short loc_40AC7F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_406E5D
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0

loc_40ACAB:				; CODE XREF: sub_40AC52+18j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+0Ch]
		mov	[eax], edx
		mov	eax, 0
		jmp	short locret_40ACF1
; ---------------------------------------------------------------------------

loc_40ACC1:				; CODE XREF: sub_40AC52+Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_40ACDA
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx

loc_40ACDA:				; CODE XREF: sub_40AC52+7Cj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0Ch
		mov	eax, [ebp+var_14]

locret_40ACF1:				; CODE XREF: sub_40AC52+6Dj
		leave
		retn
sub_40AC52	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40ACF4	proc near		; CODE XREF: sub_40377D+65p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_40A206
		mov	[esp+18h+var_14], eax ;	char *
		mov	[esp+18h+var_18], offset aGnupg2 ; "gnupg2"
		call	sub_419496
		leave
		retn
sub_40ACF4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40AD11	proc near		; CODE XREF: .text:0040AD44p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 1
		call	sub_419E0A
		mov	eax, 0
		leave
		retn
sub_40AD11	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40AD2A	proc near		; CODE XREF: .text:0040AD60p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 0
		call	sub_419E0A
		leave
		retn
sub_40AD2A	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_40AD11
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_419D7C
		mov	[ebp-10h], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_40AD2A
		mov	eax, [ebp-10h]
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40AD6C	proc near		; CODE XREF: sub_40377D+6Ap

wVersionRequested= word	ptr -1A8h
lpWSAData	= dword	ptr -1A4h
WSAData		= WSAData ptr -198h

		push	ebp
		mov	ebp, esp
		sub	esp, 1A8h
		mov	dword ptr [esp+1A8h+wVersionRequested],	0
		call	sub_41EA4F
		lea	eax, [ebp+WSAData]
		mov	[esp+1A8h+lpWSAData], eax ; lpWSAData
		mov	dword ptr [esp+1A8h+wVersionRequested],	202h ; wVersionRequested
		mov	eax, ds:WSAStartup
		call	eax ; WSAStartup
		sub	esp, 8
		call	sub_410B1C
		leave
		retn
sub_40AD6C	endp

; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_428A10
		test	eax, eax
		jz	short loc_40ADB7
		mov	eax, ds:dword_428A10
		jmp	short loc_40ADBC
; ---------------------------------------------------------------------------

loc_40ADB7:				; CODE XREF: .text:0040ADAEj
		mov	eax, offset aDevTty ; "/dev/tty"

loc_40ADBC:				; CODE XREF: .text:0040ADB5j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40ADBE	proc near		; CODE XREF: sub_40AF6D+1Dp
					; .text:0040B0A4p ...

lpFileName	= dword	ptr -38h
dwDesiredAccess	= dword	ptr -34h
dwShareMode	= dword	ptr -30h
lpSecurityAttributes= dword ptr	-2Ch
dwCreationDisposition= dword ptr -28h
dwFlagsAndAttributes= dword ptr	-24h
hTemplateFile	= dword	ptr -20h
SecurityAttributes= _SECURITY_ATTRIBUTES ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, ds:dword_4289E8
		test	eax, eax
		jnz	loc_40AF27
		lea	eax, [ebp+SecurityAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+SecurityAttributes.nLength], 0Ch
		mov	[ebp+SecurityAttributes.bInheritHandle], 1
		mov	[esp+38h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+38h+dwFlagsAndAttributes],	0 ; dwFlagsAndAttributes
		mov	[esp+38h+dwCreationDisposition], 3 ; dwCreationDisposition
		lea	eax, [ebp+SecurityAttributes]
		mov	[esp+38h+lpSecurityAttributes],	eax ; lpSecurityAttributes
		mov	[esp+38h+dwShareMode], 3 ; dwShareMode
		mov	[esp+38h+dwDesiredAccess], 0C0000000h ;	dwDesiredAccess
		mov	[esp+38h+lpFileName], offset FileName ;	"CONOUT$"
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	ds:hConsoleOutput, eax
		mov	eax, ds:hConsoleOutput
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40AE5C
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+38h+dwDesiredAccess], eax ; char
		mov	[esp+38h+lpFileName], offset aOpenConoutFail ; "open(CONOUT$) failed: rc=%d"
		call	sub_41A6A8
; ---------------------------------------------------------------------------

loc_40AE5C:				; CODE XREF: sub_40ADBE+85j
		lea	eax, [ebp+SecurityAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+SecurityAttributes.nLength], 0Ch
		mov	[ebp+SecurityAttributes.bInheritHandle], 1
		mov	[esp+38h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+38h+dwFlagsAndAttributes],	0 ; dwFlagsAndAttributes
		mov	[esp+38h+dwCreationDisposition], 3 ; dwCreationDisposition
		lea	eax, [ebp+SecurityAttributes]
		mov	[esp+38h+lpSecurityAttributes],	eax ; lpSecurityAttributes
		mov	[esp+38h+dwShareMode], 3 ; dwShareMode
		mov	[esp+38h+dwDesiredAccess], 0C0000000h ;	dwDesiredAccess
		mov	[esp+38h+lpFileName], offset aConin ; "CONIN$"
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	ds:hConsoleHandle, eax
		mov	eax, ds:hConsoleHandle
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40AEE7
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+38h+dwDesiredAccess], eax ; char
		mov	[esp+38h+lpFileName], offset aOpenConinFaile ; "open(CONIN$) failed: rc=%d"
		call	sub_41A6A8
; ---------------------------------------------------------------------------

loc_40AEE7:				; CODE XREF: sub_40ADBE+110j
		mov	eax, ds:hConsoleHandle
		mov	[esp+38h+dwDesiredAccess], 7 ; dwMode
		mov	[esp+38h+lpFileName], eax ; hConsoleHandle
		mov	eax, ds:SetConsoleMode
		call	eax ; SetConsoleMode
		sub	esp, 8
		mov	eax, ds:hConsoleOutput
		mov	[esp+38h+dwDesiredAccess], 3 ; dwMode
		mov	[esp+38h+lpFileName], eax ; hConsoleHandle
		mov	eax, ds:SetConsoleMode
		call	eax ; SetConsoleMode
		sub	esp, 8
		mov	ds:dword_4289E8, 1
		jmp	short locret_40AF28
; ---------------------------------------------------------------------------

loc_40AF27:				; CODE XREF: sub_40ADBE+Dj
		nop

locret_40AF28:				; CODE XREF: sub_40ADBE+167j
		leave
		retn
sub_40ADBE	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ds:dword_4289F0
		mov	[ebp-4], eax
		cmp	dword ptr [ebp+8], 0FFFFFFFFh
		jz	short loc_40AF46
		mov	eax, [ebp+8]
		mov	ds:dword_4289F0, eax

loc_40AF46:				; CODE XREF: .text:0040AF3Cj
		mov	eax, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ds:dword_4289F4
		mov	[ebp-4], eax
		cmp	dword ptr [ebp+8], 0
		setnz	al
		movzx	eax, al
		mov	ds:dword_4289F4, eax
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40AF6D	proc near		; CODE XREF: sub_40B175+52p
					; sub_40B175+6Ap ...

hConsoleOutput	= dword	ptr -38h
lpBuffer	= dword	ptr -34h
nNumberOfCharsToWrite= dword ptr -30h
lpNumberOfCharsWritten=	dword ptr -2Ch
lpReserved	= dword	ptr -28h
NumberOfCharsWritten= dword ptr	-18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= byte ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, ds:dword_4289F4
		test	eax, eax
		jnz	loc_40B055
		mov	eax, ds:dword_4289E8
		test	eax, eax
		jnz	short loc_40AF8F
		call	sub_40ADBE

loc_40AF8F:				; CODE XREF: sub_40AF6D+1Bj
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_10]
		mov	[esp+38h+nNumberOfCharsToWrite], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+38h+lpBuffer], eax	; char
		lea	eax, [ebp+var_14]
		mov	[esp+38h+hConsoleOutput], eax
		call	sub_409833
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		test	eax, eax
		jnz	short loc_40AFCD
		mov	[esp+38h+hConsoleOutput], offset aVasprintfFaile ; "vasprintf()	failed\n"
		call	sub_41A6D5
; ---------------------------------------------------------------------------

loc_40AFCD:				; CODE XREF: sub_40AF6D+52j
		mov	ecx, [ebp+var_C]
		mov	edx, [ebp+var_14]
		mov	eax, ds:hConsoleOutput
		mov	[esp+38h+lpReserved], 0	; lpReserved
		lea	ebx, [ebp+NumberOfCharsWritten]
		mov	[esp+38h+lpNumberOfCharsWritten], ebx ;	lpNumberOfCharsWritten
		mov	[esp+38h+nNumberOfCharsToWrite], ecx ; nNumberOfCharsToWrite
		mov	[esp+38h+lpBuffer], edx	; lpBuffer
		mov	[esp+38h+hConsoleOutput], eax ;	hConsoleOutput
		mov	eax, ds:WriteConsoleA
		call	eax ; WriteConsoleA
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_40B017
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+38h+lpBuffer], eax	; char
		mov	[esp+38h+hConsoleOutput], offset aWriteconsoleFa ; "WriteConsole failed: rc=%d"
		call	sub_41A6A8
; ---------------------------------------------------------------------------

loc_40B017:				; CODE XREF: sub_40AF6D+91j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+NumberOfCharsWritten]
		cmp	edx, eax
		jz	short loc_40B03B
		mov	eax, [ebp+NumberOfCharsWritten]
		mov	[esp+38h+nNumberOfCharsToWrite], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+lpBuffer], eax	; char
		mov	[esp+38h+hConsoleOutput], offset aWriteconsole_0 ; "WriteConsole failed: %d != %d\n"
		call	sub_41A6A8
; ---------------------------------------------------------------------------

loc_40B03B:				; CODE XREF: sub_40AF6D+B2j
		mov	eax, ds:dword_4289EC
		add	eax, [ebp+var_C]
		mov	ds:dword_4289EC, eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+hConsoleOutput], eax ;	void *
		call	sub_406E5D
		jmp	short loc_40B056
; ---------------------------------------------------------------------------

loc_40B055:				; CODE XREF: sub_40AF6D+Ej
		nop

loc_40B056:				; CODE XREF: sub_40AF6D+E6j
		mov	ebx, [ebp+var_4]
		leave
		retn
sub_40AF6D	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_40B08E
		lea	edx, [ebp+10h]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	vfprintf
		jmp	loc_40B170
; ---------------------------------------------------------------------------

loc_40B08E:				; CODE XREF: .text:0040B066j
		mov	eax, ds:dword_4289F4
		test	eax, eax
		jnz	loc_40B16F
		mov	eax, ds:dword_4289E8
		test	eax, eax
		jnz	short loc_40B0A9
		call	sub_40ADBE

loc_40B0A9:				; CODE XREF: .text:0040B0A2j
		lea	edx, [ebp+10h]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	dword ptr [ebp-14h], 0
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		lea	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_409833
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-14h]
		test	eax, eax
		jnz	short loc_40B0E7
		mov	dword ptr [esp], offset	aVasprintfFaile	; "vasprintf() failed\n"
		call	sub_41A6D5
; ---------------------------------------------------------------------------

loc_40B0E7:				; CODE XREF: .text:0040B0D9j
		mov	ecx, [ebp-0Ch]
		mov	edx, [ebp-14h]
		mov	eax, ds:hConsoleOutput
		mov	dword ptr [esp+10h], 0
		lea	ebx, [ebp-18h]
		mov	[esp+0Ch], ebx
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		mov	eax, ds:WriteConsoleA
		call	eax ; WriteConsoleA
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_40B131
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aWriteconsoleFa	; "WriteConsole	failed:	rc=%d"
		call	sub_41A6A8
; ---------------------------------------------------------------------------

loc_40B131:				; CODE XREF: .text:0040B118j
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp-18h]
		cmp	edx, eax
		jz	short loc_40B155
		mov	eax, [ebp-18h]
		mov	[esp+8], eax
		mov	eax, [ebp-0Ch]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aWriteconsole_0	; "WriteConsole	failed:	%d != %d\n"
		call	sub_41A6A8
; ---------------------------------------------------------------------------

loc_40B155:				; CODE XREF: .text:0040B139j
		mov	eax, ds:dword_4289EC
		add	eax, [ebp-0Ch]
		mov	ds:dword_4289EC, eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_406E5D
		jmp	short loc_40B170
; ---------------------------------------------------------------------------

loc_40B16F:				; CODE XREF: .text:0040B095j
		nop

loc_40B170:				; CODE XREF: .text:0040B089j
					; .text:0040B16Dj
		mov	ebx, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B175	proc near		; CODE XREF: sub_40B231+D6p

C		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_4289F4
		test	eax, eax
		jnz	loc_40B22E
		mov	eax, ds:dword_4289E8
		test	eax, eax
		jnz	loc_40B222
		call	sub_40ADBE
		jmp	loc_40B222
; ---------------------------------------------------------------------------

loc_40B19F:				; CODE XREF: sub_40B175+B1j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+C], eax ; C
		mov	eax, ds:iscntrl
		call	eax ; iscntrl
		test	eax, eax
		jz	short loc_40B201
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_40B1CE
		mov	[esp+18h+C], offset aN ; "\\n"
		call	sub_40AF6D
		jmp	short loc_40B21A
; ---------------------------------------------------------------------------

loc_40B1CE:				; CODE XREF: sub_40B175+49j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40B1E6
		mov	[esp+18h+C], offset a0_0 ; "\\0"
		call	sub_40AF6D
		jmp	short loc_40B21A
; ---------------------------------------------------------------------------

loc_40B1E6:				; CODE XREF: sub_40B175+61j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+var_14], eax
		mov	[esp+18h+C], offset aX02x ; "\\x%02x"
		call	sub_40AF6D
		jmp	short loc_40B21A
; ---------------------------------------------------------------------------

loc_40B201:				; CODE XREF: sub_40B175+3Fj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+var_14], eax
		mov	[esp+18h+C], offset aC ; "%c"
		call	sub_40AF6D

loc_40B21A:				; CODE XREF: sub_40B175+57j
					; sub_40B175+6Fj ...
		sub	[ebp+arg_4], 1
		add	[ebp+arg_0], 1

loc_40B222:				; CODE XREF: sub_40B175+1Aj
					; sub_40B175+25j
		cmp	[ebp+arg_4], 0
		jnz	loc_40B19F
		jmp	short locret_40B22F
; ---------------------------------------------------------------------------

loc_40B22E:				; CODE XREF: sub_40B175+Dj
		nop

locret_40B22F:				; CODE XREF: sub_40B175+B7j
		leave
		retn
sub_40B175	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B231	proc near		; CODE XREF: .text:0040B330p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, ds:dword_4289F4
		test	eax, eax
		jnz	loc_40B30E
		mov	[ebp+var_C], 0
		jmp	short loc_40B261
; ---------------------------------------------------------------------------

loc_40B24E:				; CODE XREF: sub_40B231+36j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_40B26B
		add	[ebp+var_C], 1

loc_40B261:				; CODE XREF: sub_40B231+1Bj
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_4]
		jb	short loc_40B24E
		jmp	short loc_40B26C
; ---------------------------------------------------------------------------

loc_40B26B:				; CODE XREF: sub_40B231+2Aj
		nop

loc_40B26C:				; CODE XREF: sub_40B231+38j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_4]
		jnb	short loc_40B2E6
		mov	[esp+38h+var_30], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_41F783
		mov	[ebp+var_10], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_40B2C6
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, [ebp+arg_8]
		jbe	short loc_40B2C6
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_10]
		add	eax, edx
		mov	byte ptr [eax],	0

loc_40B2C6:				; CODE XREF: sub_40B231+64j
					; sub_40B231+88j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	[esp+38h+var_38], offset aS ; "%s"
		call	sub_40AF6D
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax ;	void *
		call	sub_406E5D
		jmp	short loc_40B30F
; ---------------------------------------------------------------------------

loc_40B2E6:				; CODE XREF: sub_40B231+41j
		cmp	[ebp+arg_8], 0
		jz	short loc_40B2FA
		mov	eax, [ebp+arg_4]
		cmp	eax, [ebp+arg_8]
		jbe	short loc_40B2FA
		mov	eax, [ebp+arg_8]
		mov	[ebp+arg_4], eax

loc_40B2FA:				; CODE XREF: sub_40B231+B9j
					; sub_40B231+C1j
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_40B175
		jmp	short loc_40B30F
; ---------------------------------------------------------------------------

loc_40B30E:				; CODE XREF: sub_40B231+Ej
		nop

loc_40B30F:				; CODE XREF: sub_40B231+B3j
					; sub_40B231+DBj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_40B231	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40B231
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B337	proc near		; CODE XREF: sub_40B4FF+12Fp
					; .text:0040B6B7p

Code		= dword	ptr -48h
dwMode		= dword	ptr -44h
nNumberOfCharsToRead= dword ptr	-40h
lpNumberOfCharsRead= dword ptr -3Ch
pInputControl	= dword	ptr -38h
NumberOfCharsRead= dword ptr -20h
Buffer		= byte ptr -19h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
C		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, ds:dword_4289F0
		test	eax, eax
		jz	short loc_40B35E
		mov	[esp+48h+Code],	offset aSorryWeAreInBa ; "Sorry, we are	in batchmode - can't get "...
		call	sub_41A665
		mov	[esp+48h+Code],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_40B35E:				; CODE XREF: sub_40B337+Dj
		mov	eax, ds:dword_4289F4
		test	eax, eax
		jz	short loc_40B37F
		mov	[esp+48h+Code],	offset aSorryNoTermina ; "Sorry, no terminal at	all requested -	c"...
		call	sub_41A665
		mov	[esp+48h+Code],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_40B37F:				; CODE XREF: sub_40B337+2Ej
		mov	eax, ds:dword_4289E8
		test	eax, eax
		jnz	short loc_40B38D
		call	sub_40ADBE

loc_40B38D:				; CODE XREF: sub_40B337+4Fj
		mov	ds:dword_4289EC, 0
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+dwMode], eax
		mov	[esp+48h+Code],	offset aS ; "%s"
		call	sub_40AF6D
		mov	[ebp+var_14], 32h
		mov	[esp+48h+Code],	32h ; size_t
		call	sub_406D00
		mov	[ebp+var_C], eax
		mov	[ebp+var_18], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_40B3E7
		mov	eax, ds:hConsoleHandle
		mov	[esp+48h+dwMode], 3 ; dwMode
		mov	[esp+48h+Code],	eax ; hConsoleHandle
		mov	eax, ds:SetConsoleMode
		call	eax ; SetConsoleMode
		sub	esp, 8

loc_40B3E7:				; CODE XREF: sub_40B337+94j
					; sub_40B337+18Bj ...
		mov	eax, ds:hConsoleHandle
		mov	[esp+48h+pInputControl], 0 ; pInputControl
		lea	edx, [ebp+NumberOfCharsRead]
		mov	[esp+48h+lpNumberOfCharsRead], edx ; lpNumberOfCharsRead
		mov	[esp+48h+nNumberOfCharsToRead],	1 ; nNumberOfCharsToRead
		lea	edx, [ebp+Buffer]
		mov	[esp+48h+dwMode], edx ;	lpBuffer
		mov	[esp+48h+Code],	eax ; hConsoleInput
		mov	eax, ds:ReadConsoleA
		call	eax ; ReadConsoleA
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_40B432
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+48h+dwMode], eax ;	char
		mov	[esp+48h+Code],	offset aReadconsoleFai ; "ReadConsole failed: rc=%d"
		call	sub_41A6A8
; ---------------------------------------------------------------------------

loc_40B432:				; CODE XREF: sub_40B337+E2j
		mov	eax, [ebp+NumberOfCharsRead]
		test	eax, eax
		jz	loc_40B4C7
		movzx	eax, [ebp+Buffer]
		cmp	al, 0Ah
		jz	loc_40B4D0
		cmp	[ebp+arg_4], 0
		jnz	short loc_40B45C
		mov	eax, ds:dword_4289EC
		add	eax, 1
		mov	ds:dword_4289EC, eax

loc_40B45C:				; CODE XREF: sub_40B337+116j
		movzx	eax, [ebp+Buffer]
		movzx	eax, al
		mov	[ebp+C], eax
		cmp	[ebp+C], 9
		jnz	short loc_40B475
		mov	[ebp+C], 20h
		jmp	short loc_40B48F
; ---------------------------------------------------------------------------

loc_40B475:				; CODE XREF: sub_40B337+133j
		cmp	[ebp+C], 0A0h
		jg	short loc_40B48F
		mov	eax, [ebp+C]
		mov	[esp+48h+Code],	eax ; C
		mov	eax, ds:iscntrl
		call	eax ; iscntrl
		test	eax, eax
		jnz	short loc_40B4CA

loc_40B48F:				; CODE XREF: sub_40B337+13Cj
					; sub_40B337+145j
		mov	eax, [ebp+var_14]
		sub	eax, 1
		cmp	eax, [ebp+var_18]
		jg	short loc_40B4B3
		add	[ebp+var_14], 32h
		mov	eax, [ebp+var_14]
		mov	[esp+48h+dwMode], eax ;	size_t
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Code],	eax ; void *
		call	sub_406D93
		mov	[ebp+var_C], eax

loc_40B4B3:				; CODE XREF: sub_40B337+161j
		mov	eax, [ebp+var_18]
		add	eax, [ebp+var_C]
		mov	edx, [ebp+C]
		mov	[eax], dl
		add	[ebp+var_18], 1
		jmp	loc_40B3E7
; ---------------------------------------------------------------------------

loc_40B4C7:				; CODE XREF: sub_40B337+100j
		nop
		jmp	short loc_40B4CB
; ---------------------------------------------------------------------------

loc_40B4CA:				; CODE XREF: sub_40B337+156j
		nop

loc_40B4CB:				; CODE XREF: sub_40B337+191j
		jmp	loc_40B3E7
; ---------------------------------------------------------------------------

loc_40B4D0:				; CODE XREF: sub_40B337+10Cj
		nop
		cmp	[ebp+arg_4], 0
		jz	short loc_40B4F1
		mov	eax, ds:hConsoleHandle
		mov	[esp+48h+dwMode], 7 ; dwMode
		mov	[esp+48h+Code],	eax ; hConsoleHandle
		mov	eax, ds:SetConsoleMode
		call	eax ; SetConsoleMode
		sub	esp, 8

loc_40B4F1:				; CODE XREF: sub_40B337+19Ej
		mov	eax, [ebp+var_18]
		add	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40B337	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B4FF	proc near		; CODE XREF: sub_40377D+941p
					; .text:0040B68Bp ...

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, ds:dword_4289F0
		test	eax, eax
		jnz	loc_40B620
		mov	eax, ds:dword_4289F4
		test	eax, eax
		jnz	loc_40B620
		mov	eax, ds:dword_428A08
		test	eax, eax
		jz	loc_40B620
		mov	eax, ds:dword_428A0C
		test	eax, eax
		jz	loc_40B620
		mov	eax, ds:dword_4289E8
		test	eax, eax
		jnz	short loc_40B548
		call	sub_40ADBE

loc_40B548:				; CODE XREF: sub_40B4FF+42j
		mov	ds:dword_4289EC, 0
		mov	edx, ds:dword_428A08
		cmp	[ebp+arg_0], 0
		jz	short loc_40B563
		mov	eax, [ebp+arg_0]
		jmp	short loc_40B568
; ---------------------------------------------------------------------------

loc_40B563:				; CODE XREF: sub_40B4FF+5Dj
		mov	eax, offset byte_424EA5

loc_40B568:				; CODE XREF: sub_40B4FF+62j
		mov	[esp+38h+Dest],	eax
		call	edx ; dword_428A08
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40B59A
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		jmp	short loc_40B59F
; ---------------------------------------------------------------------------

loc_40B59A:				; CODE XREF: sub_40B4FF+75j
		mov	eax, 2

loc_40B59F:				; CODE XREF: sub_40B4FF+99j
		mov	[esp+38h+Dest],	eax ; size_t
		call	sub_406D00
		mov	[ebp+var_10], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40B60C
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Source], eax ;	Source
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dest],	eax
		call	sub_41AA98
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 2
		jbe	short loc_40B5FF
		mov	edx, ds:dword_428A0C
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Dest],	eax
		call	edx ; dword_428A0C

loc_40B5FF:				; CODE XREF: sub_40B4FF+F0j
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Dest],	eax ; Memory
		call	free
		jmp	short loc_40B61B
; ---------------------------------------------------------------------------

loc_40B60C:				; CODE XREF: sub_40B4FF+AFj
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	4
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	byte ptr [eax],	0

loc_40B61B:				; CODE XREF: sub_40B4FF+10Bj
		mov	eax, [ebp+var_10]
		jmp	short loc_40B633
; ---------------------------------------------------------------------------

loc_40B620:				; CODE XREF: sub_40B4FF+Ej
					; sub_40B4FF+1Bj ...
		mov	[esp+38h+Source], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_40B337

loc_40B633:				; CODE XREF: sub_40B4FF+11Fj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_40B4FF	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_409833
		test	eax, eax
		jns	short loc_40B685
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp], eax
		call	strerror
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aEstream_vaspri	; "estream_vasprintf failed: %s\n"
		call	sub_41A6A8
; ---------------------------------------------------------------------------

loc_40B685:				; CODE XREF: .text:0040B662j
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_40B4FF
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_406E5D
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40B337
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B6BE	proc near		; CODE XREF: .text:0040B73Ap

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_4289F4
		test	eax, eax
		jnz	short loc_40B720
		mov	eax, ds:dword_4289E8
		test	eax, eax
		jnz	short loc_40B6DB
		call	sub_40ADBE

loc_40B6DB:				; CODE XREF: sub_40B6BE+16j
		mov	eax, ds:dword_4289F0
		test	eax, eax
		jz	short loc_40B6EE
		mov	ds:dword_4289EC, 0

loc_40B6EE:				; CODE XREF: sub_40B6BE+24j
		mov	eax, ds:dword_4289EC
		test	eax, eax
		jz	short loc_40B723
		mov	eax, ds:dword_4289EC
		mov	[esp+18h+var_10], offset byte_424EA5
		mov	[esp+18h+var_14], eax
		mov	[esp+18h+var_18], offset aS_0 ;	"\r%*s\r"
		call	sub_40AF6D
		mov	ds:dword_4289EC, 0
		jmp	short locret_40B724
; ---------------------------------------------------------------------------

loc_40B720:				; CODE XREF: sub_40B6BE+Dj
		nop
		jmp	short locret_40B724
; ---------------------------------------------------------------------------

loc_40B723:				; CODE XREF: sub_40B6BE+37j
		nop

locret_40B724:				; CODE XREF: sub_40B6BE+60j
					; sub_40B6BE+63j
		leave
		retn
sub_40B6BE	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40B4FF
		mov	[ebp-0Ch], eax
		call	sub_40B6BE
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_41365B
		mov	[ebp-10h], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_406E5D
		mov	eax, [ebp-10h]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_428A04, eax
		mov	eax, [ebp+0Ch]
		mov	ds:dword_4289F8, eax
		mov	eax, [ebp+10h]
		mov	ds:dword_4289FC, eax
		mov	eax, [ebp+14h]
		mov	ds:dword_428A00, eax
		mov	eax, [ebp+18h]
		mov	ds:dword_428A08, eax
		mov	eax, [ebp+1Ch]
		mov	ds:dword_428A0C, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, ds:dword_428A00
		test	eax, eax
		jz	short locret_40B7AD
		mov	eax, ds:dword_428A00
		call	eax ; dword_428A00

locret_40B7AD:				; CODE XREF: .text:0040B7A4j
		leave
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40B7B0(FILE *, int, int, int)
sub_40B7B0	proc near		; CODE XREF: sub_40377D+A2Cp

File		= dword	ptr -38h
var_34		= dword	ptr -34h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		cmp	[ebp+arg_C], 0
		jz	short loc_40B7DA
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		jmp	short loc_40B7DF
; ---------------------------------------------------------------------------

loc_40B7DA:				; CODE XREF: sub_40B7B0+21j
		mov	eax, 0

loc_40B7DF:				; CODE XREF: sub_40B7B0+28j
		mov	[ebp+var_20], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40B835
		mov	[ebp+var_14], 100h
		mov	eax, [ebp+var_14]
		mov	[esp+38h+File],	eax ; size_t
		call	sub_406CDA
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		cmp	[ebp+var_10], 0
		jnz	short loc_40B82D
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_C], 0
		jz	short loc_40B823
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0

loc_40B823:				; CODE XREF: sub_40B7B0+68j
		mov	eax, 0FFFFFFFFh
		jmp	locret_40B97A
; ---------------------------------------------------------------------------

loc_40B82D:				; CODE XREF: sub_40B7B0+59j
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_14]
		mov	[eax], edx

loc_40B835:				; CODE XREF: sub_40B7B0+36j
		sub	[ebp+var_14], 3
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], eax
		jmp	loc_40B953
; ---------------------------------------------------------------------------

loc_40B844:				; CODE XREF: sub_40B7B0+1B5j
		mov	eax, [ebp+var_18]
		cmp	eax, [ebp+var_14]
		jnz	loc_40B93B
		cmp	[ebp+var_20], 0
		jz	short loc_40B89E
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_20]
		jbe	short loc_40B89E

loc_40B85E:				; CODE XREF: sub_40B7B0+C6j
		cmp	[ebp+var_C], 0Ah
		jz	short loc_40B878
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+File],	eax ; File
		call	getc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_40B85E

loc_40B878:				; CODE XREF: sub_40B7B0+B2j
		mov	eax, [ebp+var_1C]
		mov	byte ptr [eax],	0Ah
		add	[ebp+var_1C], 1
		add	[ebp+var_18], 1
		cmp	[ebp+arg_C], 0
		jz	loc_40B96D
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		jmp	loc_40B96D
; ---------------------------------------------------------------------------

loc_40B89E:				; CODE XREF: sub_40B7B0+A4j
					; sub_40B7B0+ACj
		add	[ebp+var_14], 3
		cmp	[ebp+var_14], 3FFh
		ja	short loc_40B8B2
		mov	eax, 100h
		jmp	short loc_40B8B7
; ---------------------------------------------------------------------------

loc_40B8B2:				; CODE XREF: sub_40B7B0+F9j
		mov	eax, 400h

loc_40B8B7:				; CODE XREF: sub_40B7B0+100j
		add	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_34], eax ;	size_t
		mov	eax, [ebp+var_10]
		mov	[esp+38h+File],	eax ; void *
		call	sub_406D79
		mov	edx, [ebp+arg_4]
		mov	[edx], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40B91C
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+File],	eax ; void *
		call	sub_406E5D
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_C], 0
		jz	short loc_40B909
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0

loc_40B909:				; CODE XREF: sub_40B7B0+14Ej
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_24]
		mov	[eax], edx
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40B97A
; ---------------------------------------------------------------------------

loc_40B91C:				; CODE XREF: sub_40B7B0+128j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		sub	[ebp+var_14], 3
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_10]
		add	eax, edx
		mov	[ebp+var_1C], eax

loc_40B93B:				; CODE XREF: sub_40B7B0+9Aj
		mov	eax, [ebp+var_C]
		mov	edx, eax
		mov	eax, [ebp+var_1C]
		mov	[eax], dl
		add	[ebp+var_1C], 1
		add	[ebp+var_18], 1
		cmp	[ebp+var_C], 0Ah
		jz	short loc_40B970

loc_40B953:				; CODE XREF: sub_40B7B0+8Fj
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+File],	eax ; File
		call	getc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	loc_40B844
		jmp	short loc_40B971
; ---------------------------------------------------------------------------

loc_40B96D:				; CODE XREF: sub_40B7B0+DAj
					; sub_40B7B0+E9j
		nop
		jmp	short loc_40B971
; ---------------------------------------------------------------------------

loc_40B970:				; CODE XREF: sub_40B7B0+1A1j
		nop

loc_40B971:				; CODE XREF: sub_40B7B0+1BBj
					; sub_40B7B0+1BEj
		mov	eax, [ebp+var_1C]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_18]

locret_40B97A:				; CODE XREF: sub_40B7B0+78j
					; sub_40B7B0+16Aj
		leave
		retn
sub_40B7B0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_428A14
		test	eax, eax
		jnz	short loc_40B9E9
		mov	ds:dword_428A14, 1
		call	_getpid
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		xor	eax, edx
		mov	[ebp-14h], eax
		mov	dword ptr [esp], 0
		call	sub_421110
		mov	edx, eax
		mov	eax, [ebp-10h]
		xor	eax, edx
		mov	[ebp-18h], eax
		lea	eax, [ebp-14h]
		mov	eax, [eax]
		mov	ds:dword_428A18, eax
		mov	eax, offset dword_428A1C
		lea	edx, [ebp-18h]
		mov	edx, [edx]
		mov	[eax], edx

loc_40B9E9:				; CODE XREF: .text:0040B9A2j
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 8
		mov	eax, offset dword_428A18
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B9F9	proc near		; CODE XREF: sub_40377D+2079p
					; sub_406808+15Cp ...

dwMilliseconds	= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		imul	eax, 3E8h
		mov	[esp+18h+dwMilliseconds], eax ;	dwMilliseconds
		mov	eax, ds:Sleep
		call	eax ; Sleep
		sub	esp, 4
		leave
		retn
sub_40B9F9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BA17	proc near		; CODE XREF: .text:0040BA84p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+arg_0], 0FFFFFFFFh
		jnz	short loc_40BA2A
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40BA64
; ---------------------------------------------------------------------------

loc_40BA2A:				; CODE XREF: sub_40BA17+Aj
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	edx, al
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_40BA61
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aFailedToTransl ; "failed to translate	osfhandle %p\n"
		call	sub_41A665

loc_40BA61:				; CODE XREF: sub_40BA17+35j
		mov	eax, [ebp+var_C]

locret_40BA64:				; CODE XREF: sub_40BA17+11j
		leave
		retn
sub_40BA17	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+8], 2
		jg	short loc_40BA77
		mov	eax, [ebp+8]
		jmp	short locret_40BA89
; ---------------------------------------------------------------------------

loc_40BA77:				; CODE XREF: .text:0040BA70j
		mov	eax, [ebp+8]
		mov	edx, [ebp+0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_40BA17

locret_40BA89:				; CODE XREF: .text:0040BA75j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 184h
		mov	eax, ds:GetCurrentProcessId
		call	eax ; GetCurrentProcessId
		mov	[ebp-1Ch], eax
		lea	eax, [ebp-158h]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	dword ptr [ebp-158h], 0Ch
		mov	dword ptr [ebp-150h], 1
		lea	eax, [ebp-14Ch]
		mov	[esp+4], eax
		mov	dword ptr [esp], 105h
		mov	eax, ds:GetTempPathA
		call	eax ; GetTempPathA
		sub	esp, 8
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-20h], 0
		jz	short loc_40BB29
		cmp	dword ptr [ebp-20h], 104h
		jg	short loc_40BB29
		lea	eax, [ebp-14Ch]
		mov	dword ptr [ebp-15Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-15Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 104h
		jbe	short loc_40BB40

loc_40BB29:				; CODE XREF: .text:0040BAEFj
					; .text:0040BAF8j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 2
		mov	eax, 0
		jmp	loc_40BD2E
; ---------------------------------------------------------------------------

loc_40BB40:				; CODE XREF: .text:0040BB27j
		lea	eax, [ebp-14Ch]
		mov	dword ptr [ebp-15Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-15Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp-14Ch]
		add	eax, edx
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	dword ptr [eax], 756E675Fh
		mov	word ptr [eax+4], 6770h
		mov	byte ptr [eax+6], 0
		add	dword ptr [ebp-10h], 6
		mov	dword ptr [esp+4], 0
		lea	eax, [ebp-14Ch]
		mov	[esp], eax
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	5Ch
		add	dword ptr [ebp-10h], 1
		mov	eax, [ebp-10h]
		mov	[ebp-24h], eax
		mov	dword ptr [ebp-0Ch], 0
		jmp	loc_40BD12
; ---------------------------------------------------------------------------

loc_40BBC1:				; CODE XREF: .text:0040BD16j
		mov	eax, [ebp-24h]
		mov	[ebp-10h], eax
		mov	eax, ds:GetTickCount
		call	eax ; GetTickCount
		mov	edx, [ebp-1Ch]
		shl	edx, 10h
		xor	eax, edx
		mov	[ebp-14h], eax
		mov	dword ptr [ebp-18h], 0
		jmp	short loc_40BC12
; ---------------------------------------------------------------------------

loc_40BBE2:				; CODE XREF: .text:0040BC16j
		mov	eax, [ebp-14h]
		shr	eax, 1Ch
		cmp	eax, 9
		ja	short loc_40BBF8
		mov	eax, [ebp-14h]
		shr	eax, 1Ch
		add	eax, 30h
		jmp	short loc_40BC01
; ---------------------------------------------------------------------------

loc_40BBF8:				; CODE XREF: .text:0040BBEBj
		mov	eax, [ebp-14h]
		shr	eax, 1Ch
		add	eax, 37h

loc_40BC01:				; CODE XREF: .text:0040BBF6j
		mov	edx, [ebp-10h]
		mov	[edx], al
		add	dword ptr [ebp-10h], 1
		shl	dword ptr [ebp-14h], 4
		add	dword ptr [ebp-18h], 1

loc_40BC12:				; CODE XREF: .text:0040BBE0j
		cmp	dword ptr [ebp-18h], 7
		jle	short loc_40BBE2
		mov	edx, offset a_tmp ; ".tmp"
		mov	eax, [ebp-10h]
		mov	ecx, [edx]
		mov	[eax], ecx
		movzx	edx, byte ptr [edx+4]
		mov	[eax+4], dl
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 4000100h
		mov	dword ptr [esp+10h], 1
		lea	eax, [ebp-158h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0C0000000h
		lea	eax, [ebp-14Ch]
		mov	[esp], eax
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp-28h], eax
		cmp	dword ptr [ebp-28h], 0FFFFFFFFh
		jz	loc_40BCFD
		mov	eax, [ebp-28h]
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebp-2Ch], eax
		cmp	dword ptr [ebp-2Ch], 0FFFFFFFFh
		jnz	short loc_40BCB2
		mov	eax, [ebp-28h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		jmp	short loc_40BD2E
; ---------------------------------------------------------------------------

loc_40BCB2:				; CODE XREF: .text:0040BC99j
		mov	dword ptr [esp+4], offset aWB ;	"w+b"
		mov	eax, [ebp-2Ch]
		mov	[esp], eax
		call	_fdopen
		mov	[ebp-30h], eax
		cmp	dword ptr [ebp-30h], 0
		jnz	short loc_40BCF8
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp-34h], eax
		mov	eax, [ebp-2Ch]
		mov	[esp], eax
		call	_close
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp-34h]
		mov	[eax], edx
		mov	eax, 0
		jmp	short loc_40BD2E
; ---------------------------------------------------------------------------

loc_40BCF8:				; CODE XREF: .text:0040BCCCj
		mov	eax, [ebp-30h]
		jmp	short loc_40BD2E
; ---------------------------------------------------------------------------

loc_40BCFD:				; CODE XREF: .text:0040BC77j
		mov	dword ptr [esp], 1
		mov	eax, ds:Sleep
		call	eax ; Sleep
		sub	esp, 4
		add	dword ptr [ebp-0Ch], 1

loc_40BD12:				; CODE XREF: .text:0040BBBCj
		cmp	dword ptr [ebp-0Ch], 9
		jle	loc_40BBC1
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 2
		mov	eax, 0

loc_40BD2E:				; CODE XREF: .text:0040BB3Bj
					; .text:0040BCB0j ...
		mov	edi, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40BD38(DWORD)
sub_40BD38	proc near		; CODE XREF: .text:0040C91Dp

dwProcessId	= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_40BD61
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_10], eax
		mov	dword ptr [esp+18h+var_14], offset aGnupg_allow_se ; "gnupg_allow_set_foregound_window"
		mov	[esp+18h+dwProcessId], offset aSCalledWithInv ;	"%s called with	invalid	pid %lu\n"
		call	sub_41A63B
		jmp	short locret_40BDA5
; ---------------------------------------------------------------------------

loc_40BD61:				; CODE XREF: sub_40BD38+Aj
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jz	short loc_40BD6C
		mov	eax, [ebp+arg_0]
		jmp	short loc_40BD71
; ---------------------------------------------------------------------------

loc_40BD6C:				; CODE XREF: sub_40BD38+2Dj
		mov	eax, 0FFFFFFFFh

loc_40BD71:				; CODE XREF: sub_40BD38+32j
		mov	[esp+18h+dwProcessId], eax ; dwProcessId
		mov	eax, ds:AllowSetForegroundWindow
		call	eax ; AllowSetForegroundWindow
		sub	esp, 4
		test	eax, eax
		jnz	short locret_40BDA5
		mov	[esp+18h+dwProcessId], 0FFFFFFFFh ; DWORD
		call	sub_41B9A2
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+var_10], eax
		mov	dword ptr [esp+18h+var_14], edx	; char
		mov	[esp+18h+dwProcessId], offset aAllowsetforegr ;	"AllowSetForegroundWindow(%lu) failed: %"...
		call	sub_41A63B

locret_40BDA5:				; CODE XREF: sub_40BD38+27j
					; sub_40BD38+48j
		leave
		retn
sub_40BD38	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-20h], 0
		mov	dword ptr [ebp-10h], 0
		mov	dword ptr [ebp-14h], 0
		mov	eax, ds:GetCurrentProcessId
		call	eax ; GetCurrentProcessId
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp], 400h
		mov	eax, ds:OpenProcess
		call	eax ; OpenProcess
		sub	esp, 0Ch
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jz	loc_40BF20
		lea	eax, [ebp-20h]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 8
		mov	eax, [ebp-18h]
		mov	[esp], eax
		mov	eax, ds:OpenProcessToken
		call	eax ; OpenProcessToken
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_40BF23
		mov	eax, [ebp-20h]
		lea	edx, [ebp-24h]
		mov	[esp+10h], edx
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		mov	eax, ds:GetTokenInformation
		call	eax ; GetTokenInformation
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_40BE6B
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		cmp	eax, 7Ah
		jnz	loc_40BF26

loc_40BE6B:				; CODE XREF: .text:0040BE59j
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	sub_406CDA
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	loc_40BF29
		mov	edx, [ebp-24h]
		mov	eax, [ebp-20h]
		lea	ecx, [ebp-24h]
		mov	[esp+10h], ecx
		mov	[esp+0Ch], edx
		mov	edx, [ebp-10h]
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		mov	eax, ds:GetTokenInformation
		call	eax ; GetTokenInformation
		sub	esp, 14h
		test	eax, eax
		jz	short loc_40BF2C
		mov	eax, [ebp-10h]
		mov	eax, [eax]
		mov	[esp], eax
		mov	eax, ds:IsValidSid
		call	eax ; IsValidSid
		sub	esp, 4
		test	eax, eax
		jz	short loc_40BF2F
		mov	eax, [ebp-10h]
		mov	eax, [eax]
		mov	[esp], eax
		mov	eax, ds:GetLengthSid
		call	eax ; GetLengthSid
		sub	esp, 4
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_406CDA
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_40BF32
		mov	eax, [ebp-10h]
		mov	eax, [eax]
		mov	[esp+8], eax
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		mov	eax, ds:CopySid
		call	eax ; CopySid
		sub	esp, 0Ch
		test	eax, eax
		jz	short loc_40BF35
		mov	dword ptr [ebp-0Ch], 1
		jmp	short loc_40BF36
; ---------------------------------------------------------------------------

loc_40BF20:				; CODE XREF: .text:0040BDFBj
		nop
		jmp	short loc_40BF36
; ---------------------------------------------------------------------------

loc_40BF23:				; CODE XREF: .text:0040BE22j
		nop
		jmp	short loc_40BF36
; ---------------------------------------------------------------------------

loc_40BF26:				; CODE XREF: .text:0040BE65j
		nop
		jmp	short loc_40BF36
; ---------------------------------------------------------------------------

loc_40BF29:				; CODE XREF: .text:0040BE7Dj
		nop
		jmp	short loc_40BF36
; ---------------------------------------------------------------------------

loc_40BF2C:				; CODE XREF: .text:0040BEB2j
		nop
		jmp	short loc_40BF36
; ---------------------------------------------------------------------------

loc_40BF2F:				; CODE XREF: .text:0040BEC8j
		nop
		jmp	short loc_40BF36
; ---------------------------------------------------------------------------

loc_40BF32:				; CODE XREF: .text:0040BEF1j
		nop
		jmp	short loc_40BF36
; ---------------------------------------------------------------------------

loc_40BF35:				; CODE XREF: .text:0040BF15j
		nop

loc_40BF36:				; CODE XREF: .text:0040BF1Ej
					; .text:0040BF21j ...
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_406E5D
		mov	eax, [ebp-20h]
		test	eax, eax
		jz	short loc_40BF58
		mov	eax, [ebp-20h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_40BF58:				; CODE XREF: .text:0040BF46j
		cmp	dword ptr [ebp-18h], 0
		jz	short loc_40BF6E
		mov	eax, [ebp-18h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_40BF6E:				; CODE XREF: .text:0040BF5Cj
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40BF86
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_406E5D
		mov	dword ptr [ebp-14h], 0

loc_40BF86:				; CODE XREF: .text:0040BF72j
		mov	eax, [ebp-14h]
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BF8C	proc near		; CODE XREF: sub_40BFB3+14p
					; sub_40CC63+185p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_40BFAC
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_40BFB1
; ---------------------------------------------------------------------------

loc_40BFAC:				; CODE XREF: sub_40BF8C+7j
		mov	eax, 0

loc_40BFB1:				; CODE XREF: sub_40BF8C+1Ej
		pop	ebp
		retn
sub_40BF8C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BFB3	proc near		; CODE XREF: sub_40BFCE+Ep
					; .text:0040C5AAp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_40BF8C
		leave
		retn
sub_40BFB3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BFCE	proc near		; CODE XREF: sub_40C27F+ECp
					; .text:0040C99Cp ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_40BFB3
		leave
		retn
sub_40BFCE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BFE3	proc near		; CODE XREF: .text:0040C018p
					; .text:0040C0C9p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0FFFFFFFFh
		cmp	[ebp+var_4], 0FFFFFFFFh
		jnz	short loc_40BFFD
		mov	[ebp+var_4], 100h

loc_40BFFD:				; CODE XREF: sub_40BFE3+11j
		cmp	[ebp+var_4], 7FFFFFFFh
		jnz	short loc_40C00D
		mov	[ebp+var_4], 100h

loc_40C00D:				; CODE XREF: sub_40BFE3+21j
		mov	eax, [ebp+var_4]
		leave
		retn
sub_40BFE3	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_40BFE3
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_40C095
		mov	dword ptr [ebp-14h], 0
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_40C08B
; ---------------------------------------------------------------------------

loc_40C035:				; CODE XREF: .text:0040C091j
		mov	eax, [ebp-14h]
		mov	[ebp-10h], eax
		jmp	short loc_40C05C
; ---------------------------------------------------------------------------

loc_40C03D:				; CODE XREF: .text:0040C06Aj
		mov	eax, [ebp-10h]
		shl	eax, 2
		add	eax, [ebp+0Ch]
		mov	eax, [eax]
		cmp	eax, [ebp-0Ch]
		jnz	short loc_40C058
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[ebp-14h], eax
		jmp	short loc_40C06C
; ---------------------------------------------------------------------------

loc_40C058:				; CODE XREF: .text:0040C04Bj
		add	dword ptr [ebp-10h], 1

loc_40C05C:				; CODE XREF: .text:0040C03Bj
		mov	eax, [ebp-10h]
		shl	eax, 2
		add	eax, [ebp+0Ch]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40C03D

loc_40C06C:				; CODE XREF: .text:0040C056j
		mov	eax, [ebp-10h]
		shl	eax, 2
		add	eax, [ebp+0Ch]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40C087
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	_close

loc_40C087:				; CODE XREF: .text:0040C07Aj
		add	dword ptr [ebp-0Ch], 1

loc_40C08B:				; CODE XREF: .text:0040C033j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp-18h]
		jl	short loc_40C035
		jmp	short loc_40C0B4
; ---------------------------------------------------------------------------

loc_40C095:				; CODE XREF: .text:0040C024j
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_40C0AC
; ---------------------------------------------------------------------------

loc_40C09D:				; CODE XREF: .text:0040C0B2j
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	_close
		add	dword ptr [ebp-0Ch], 1

loc_40C0AC:				; CODE XREF: .text:0040C09Bj
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp-18h]
		jl	short loc_40C09D

loc_40C0B4:				; CODE XREF: .text:0040C093j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		call	sub_40BFE3
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-10h], 20h
		mov	dword ptr [esp+4], 4
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	calloc
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40C0FE
		mov	eax, 0
		jmp	locret_40C1C5
; ---------------------------------------------------------------------------

loc_40C0FE:				; CODE XREF: .text:0040C0F2j
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-14h], 0
		jmp	loc_40C1A7
; ---------------------------------------------------------------------------

loc_40C111:				; CODE XREF: .text:0040C1ADj
		lea	eax, [ebp-50h]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40C138
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 9
		jz	short loc_40C1A3

loc_40C138:				; CODE XREF: .text:0040C128j
		mov	eax, [ebp-18h]
		add	eax, 1
		cmp	eax, [ebp-10h]
		jb	short loc_40C191
		cmp	dword ptr [ebp-10h], 0FFh
		ja	short loc_40C153
		mov	eax, 20h
		jmp	short loc_40C158
; ---------------------------------------------------------------------------

loc_40C153:				; CODE XREF: .text:0040C14Aj
		mov	eax, 100h

loc_40C158:				; CODE XREF: .text:0040C151j
		add	[ebp-10h], eax
		mov	eax, [ebp-10h]
		shl	eax, 2
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	realloc
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-20h], 0
		jnz	short loc_40C18B
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	free
		mov	eax, 0
		jmp	short locret_40C1C5
; ---------------------------------------------------------------------------

loc_40C18B:				; CODE XREF: .text:0040C177j
		mov	eax, [ebp-20h]
		mov	[ebp-0Ch], eax

loc_40C191:				; CODE XREF: .text:0040C141j
		mov	eax, [ebp-18h]
		shl	eax, 2
		add	eax, [ebp-0Ch]
		mov	edx, [ebp-14h]
		mov	[eax], edx
		add	dword ptr [ebp-18h], 1

loc_40C1A3:				; CODE XREF: .text:0040C136j
		add	dword ptr [ebp-14h], 1

loc_40C1A7:				; CODE XREF: .text:0040C10Cj
		mov	eax, [ebp-14h]
		cmp	eax, [ebp-1Ch]
		jl	loc_40C111
		mov	eax, [ebp-18h]
		shl	eax, 2
		add	eax, [ebp-0Ch]
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	eax, [ebp-0Ch]

locret_40C1C5:				; CODE XREF: .text:0040C0F9j
					; .text:0040C189j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40C1C7(int, char *)
sub_40C1C7	proc near		; CODE XREF: sub_40C27F+100p
					; sub_40C27F+130p

Str		= dword	ptr -28h
Control		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40C1F2
		mov	eax, [ebp+var_C]
		mov	word ptr [eax],	2222h
		mov	byte ptr [eax+2], 0
		add	[ebp+var_C], 2
		jmp	loc_40C27A
; ---------------------------------------------------------------------------

loc_40C1F2:				; CODE XREF: sub_40C1C7+14j
		mov	[esp+28h+Control], offset Control ; " \t\n\v"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strpbrk
		test	eax, eax
		jz	short loc_40C265
		mov	eax, [ebp+var_C]
		mov	word ptr [eax],	22h
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		jmp	short loc_40C249
; ---------------------------------------------------------------------------

loc_40C21D:				; CODE XREF: sub_40C1C7+8Aj
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_40C245
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_40C245:				; CODE XREF: sub_40C1C7+6Dj
		add	[ebp+var_10], 1

loc_40C249:				; CODE XREF: sub_40C1C7+54j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40C21D
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	22h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		jmp	short loc_40C27A
; ---------------------------------------------------------------------------

loc_40C265:				; CODE XREF: sub_40C1C7+40j
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Control], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_41BD45
		mov	[ebp+var_C], eax

loc_40C27A:				; CODE XREF: sub_40C1C7+26j
					; sub_40C1C7+9Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40C1C7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40C27F(char *, int, int)
sub_40C27F	proc near		; CODE XREF: .text:0040C752p
					; sub_40C9F4+69p ...

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_10]
		add	eax, edx
		add	eax, 3
		mov	[ebp+var_10], eax
		jmp	short loc_40C2DA
; ---------------------------------------------------------------------------

loc_40C2C8:				; CODE XREF: sub_40C27F+63j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_40C2D6
		add	[ebp+var_10], 1

loc_40C2D6:				; CODE XREF: sub_40C27F+51j
		add	[ebp+var_14], 1

loc_40C2DA:				; CODE XREF: sub_40C27F+47j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40C2C8
		mov	[ebp+var_C], 0
		jmp	short loc_40C339
; ---------------------------------------------------------------------------

loc_40C2ED:				; CODE XREF: sub_40C27F+CCj
		mov	eax, [ebp+var_14]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_10]
		add	eax, edx
		add	eax, 3
		mov	[ebp+var_10], eax
		jmp	short loc_40C32B
; ---------------------------------------------------------------------------

loc_40C319:				; CODE XREF: sub_40C27F+B4j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_40C327
		add	[ebp+var_10], 1

loc_40C327:				; CODE XREF: sub_40C27F+A2j
		add	[ebp+var_14], 1

loc_40C32B:				; CODE XREF: sub_40C27F+98j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40C319
		add	[ebp+var_C], 1

loc_40C339:				; CODE XREF: sub_40C27F+6Cj
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40C2ED
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax ;	size_t
		call	sub_406CDA
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_40C372
		call	sub_40BFCE
		jmp	short loc_40C3D7
; ---------------------------------------------------------------------------

loc_40C372:				; CODE XREF: sub_40C27F+EAj
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_44], eax ;	char *
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_40C1C7
		mov	[ebp+var_18], eax
		mov	[ebp+var_C], 0
		jmp	short loc_40C3BB
; ---------------------------------------------------------------------------

loc_40C390:				; CODE XREF: sub_40C27F+149j
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	20h
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+48h+var_44], eax ;	char *
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_40C1C7
		mov	[ebp+var_18], eax
		add	[ebp+var_C], 1

loc_40C3BB:				; CODE XREF: sub_40C27F+10Fj
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40C390
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_1C]
		mov	[eax], edx
		mov	eax, 0

loc_40C3D7:				; CODE XREF: sub_40C27F+F1j
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_40C27F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C3DD	proc near		; CODE XREF: .text:0040C5B8p
					; .text:0040C771p

hReadPipe	= dword	ptr -48h
hWritePipe	= dword	ptr -44h
lpPipeAttributes= dword	ptr -40h
nSize		= dword	ptr -3Ch
dwDesiredAccess	= dword	ptr -38h
bInheritHandle	= dword	ptr -34h
dwOptions	= dword	ptr -30h
PipeAttributes	= _SECURITY_ATTRIBUTES ptr -20h
TargetHandle	= dword	ptr -14h
hSourceHandle	= dword	ptr -10h
hObject		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 40h
		lea	eax, [ebp+PipeAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+PipeAttributes.nLength], 0Ch
		mov	[ebp+PipeAttributes.bInheritHandle], 0
		mov	[esp+48h+nSize], 0 ; nSize
		lea	eax, [ebp+PipeAttributes]
		mov	[esp+48h+lpPipeAttributes], eax	; lpPipeAttributes
		lea	eax, [ebp+hSourceHandle]
		mov	[esp+48h+hWritePipe], eax ; hWritePipe
		lea	eax, [ebp+hObject]
		mov	[esp+48h+hReadPipe], eax ; hReadPipe
		mov	eax, ds:CreatePipe
		call	eax ; CreatePipe
		sub	esp, 10h
		test	eax, eax
		jnz	short loc_40C43E
		mov	eax, 0FFFFFFFFh
		jmp	loc_40C4FC
; ---------------------------------------------------------------------------

loc_40C43E:				; CODE XREF: sub_40C3DD+55j
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	ebx, eax
		mov	esi, [ebp+hSourceHandle]
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp+48h+dwOptions], 2 ; dwOptions
		mov	[esp+48h+bInheritHandle], 1 ; bInheritHandle
		mov	[esp+48h+dwDesiredAccess], 0 ; dwDesiredAccess
		lea	edx, [ebp+TargetHandle]
		mov	[esp+48h+nSize], edx ; lpTargetHandle
		mov	[esp+48h+lpPipeAttributes], ebx	; hTargetProcessHandle
		mov	[esp+48h+hWritePipe], esi ; hSourceHandle
		mov	[esp+48h+hReadPipe], eax ; hSourceProcessHandle
		mov	eax, ds:DuplicateHandle
		call	eax ; DuplicateHandle
		sub	esp, 1Ch
		test	eax, eax
		jnz	short loc_40C4CC
		mov	[esp+48h+hReadPipe], 0FFFFFFFFh	; DWORD
		call	sub_41B9A2
		mov	[esp+48h+hWritePipe], eax ; char
		mov	[esp+48h+hReadPipe], offset aDuplicatehandl ; "DuplicateHandle failed: %s\n"
		call	sub_41A665
		mov	eax, [ebp+hObject]
		mov	[esp+48h+hReadPipe], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+hSourceHandle]
		mov	[esp+48h+hReadPipe], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0FFFFFFFFh
		jmp	short loc_40C4FC
; ---------------------------------------------------------------------------

loc_40C4CC:				; CODE XREF: sub_40C3DD+AAj
		mov	eax, [ebp+hSourceHandle]
		mov	[esp+48h+hReadPipe], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+TargetHandle]
		mov	[ebp+hSourceHandle], eax
		mov	eax, [ebp+hObject]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+4]
		mov	eax, [ebp+hSourceHandle]
		mov	[edx], eax
		mov	eax, 0

loc_40C4FC:				; CODE XREF: sub_40C3DD+5Cj
					; sub_40C3DD+EDj
		lea	esp, [ebp-8]
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_40C3DD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C503	proc near		; CODE XREF: sub_40C9F4+B5p
					; sub_40C9F4+D1p ...

lpFileName	= dword	ptr -38h
dwDesiredAccess	= dword	ptr -34h
dwShareMode	= dword	ptr -30h
lpSecurityAttributes= dword ptr	-2Ch
dwCreationDisposition= dword ptr -28h
dwFlagsAndAttributes= dword ptr	-24h
hTemplateFile	= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_0], 0
		jz	short loc_40C516
		mov	eax, 40000000h
		jmp	short loc_40C51B
; ---------------------------------------------------------------------------

loc_40C516:				; CODE XREF: sub_40C503+Aj
		mov	eax, 80000000h

loc_40C51B:				; CODE XREF: sub_40C503+11j
		mov	[esp+38h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+38h+dwFlagsAndAttributes],	0 ; dwFlagsAndAttributes
		mov	[esp+38h+dwCreationDisposition], 3 ; dwCreationDisposition
		mov	[esp+38h+lpSecurityAttributes],	0 ; lpSecurityAttributes
		mov	[esp+38h+dwShareMode], 3 ; dwShareMode
		mov	[esp+38h+dwDesiredAccess], eax ; dwDesiredAccess
		mov	[esp+38h+lpFileName], offset aNul ; "nul"
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_40C57D
		mov	[esp+38h+lpFileName], 0FFFFFFFFh ; DWORD
		call	sub_41B9A2
		mov	[esp+38h+dwDesiredAccess], eax ; char
		mov	[esp+38h+lpFileName], offset aCanTOpenNulS ; "can't open `nul': %s\n"
		call	sub_41A702

loc_40C57D:				; CODE XREF: sub_40C503+5Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40C503	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, [ebp+8]
		add	eax, 4
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	dword ptr [esp], 1
		call	sub_40BFB3
		mov	[ebp-0Ch], eax
		lea	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_40C3DD
		test	eax, eax
		jnz	loc_40C67A
		mov	eax, [ebp-14h]
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	edx, [ebp+8]
		mov	[edx], eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40C60E
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aFailedToTran_0	; "failed to translate osfhandle %p\n"
		call	sub_41A665
		mov	eax, [ebp-10h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		jmp	short loc_40C67A
; ---------------------------------------------------------------------------

loc_40C60E:				; CODE XREF: .text:0040C5E7j
		mov	eax, [ebp+8]
		lea	ebx, [eax+4]
		mov	eax, [ebp-10h]
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebx], eax
		mov	eax, [ebp+8]
		add	eax, 4
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40C673
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aFailedToTran_0	; "failed to translate osfhandle %p\n"
		call	sub_41A665
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[esp], eax
		call	_close
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	eax, [ebp-10h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		jmp	short loc_40C67A
; ---------------------------------------------------------------------------

loc_40C673:				; CODE XREF: .text:0040C636j
		mov	dword ptr [ebp-0Ch], 0

loc_40C67A:				; CODE XREF: .text:0040C5BFj
					; .text:0040C60Cj ...
		mov	eax, [ebp-0Ch]
		mov	ebx, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0B0h
		mov	dword ptr [ebp-38h], 0
		mov	dword ptr [ebp-34h], 0
		mov	dword ptr [ebp-30h], 0
		mov	dword ptr [ebp-2Ch], 0
		mov	eax, [ebp+20h]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+24h]
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	fflush
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	rewind
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	_fileno
		mov	[esp], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	_fileno
		mov	[esp], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	short loc_40C70D
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_40C719

loc_40C70D:				; CODE XREF: .text:0040C705j
		mov	dword ptr [esp], offset	aNoFileDescript	; "no file descriptor for file passed to g"...
		call	sub_41A6A8
; ---------------------------------------------------------------------------

loc_40C719:				; CODE XREF: .text:0040C70Bj
		lea	eax, [ebp-28h]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	dword ptr [ebp-28h], 0Ch
		mov	dword ptr [ebp-20h], 0
		lea	eax, [ebp-80h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40C27F
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_40C768
		mov	eax, [ebp-14h]
		jmp	loc_40C9ED
; ---------------------------------------------------------------------------

loc_40C768:				; CODE XREF: .text:0040C75Ej
		lea	eax, [ebp-88h]
		mov	[esp], eax
		call	sub_40C3DD
		test	eax, eax
		jz	short loc_40C7C1
		mov	dword ptr [esp], 1
		call	sub_40BFB3
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	dword ptr [esp], offset	aErrorCreatingA	; "error creating a pipe: %s\n"
		call	sub_419D7C
		mov	[esp+4], ebx
		mov	[esp], eax
		call	sub_41A665
		mov	eax, [ebp-80h]
		mov	[esp], eax
		call	sub_406E5D
		mov	eax, [ebp-14h]
		jmp	loc_40C9ED
; ---------------------------------------------------------------------------

loc_40C7C1:				; CODE XREF: .text:0040C778j
		lea	eax, [ebp-7Ch]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 11h
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	dword ptr [ebp-7Ch], 44h
		mov	dword ptr [ebp-50h], 101h
		mov	word ptr [ebp-4Ch], 5
		mov	eax, [ebp-0Ch]
		mov	[ebp-44h], eax
		mov	eax, [ebp-10h]
		mov	[ebp-40h], eax
		mov	eax, [ebp-84h]
		mov	[ebp-3Ch], eax
		mov	eax, [ebp+1Ch]
		and	eax, 80h
		test	eax, eax
		jz	short loc_40C812
		mov	ebx, 4000008h
		jmp	short loc_40C817
; ---------------------------------------------------------------------------

loc_40C812:				; CODE XREF: .text:0040C809j
		mov	ebx, 4000000h

loc_40C817:				; CODE XREF: .text:0040C810j
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp], eax
		mov	eax, ds:GetPriorityClass
		call	eax ; GetPriorityClass
		sub	esp, 4
		or	eax, ebx
		or	eax, 4
		mov	[ebp-18h], eax
		mov	edx, [ebp-18h]
		mov	eax, [ebp-80h]
		lea	ecx, [ebp-38h]
		mov	[esp+24h], ecx
		lea	ecx, [ebp-7Ch]
		mov	[esp+20h], ecx
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+18h], 0
		mov	[esp+14h], edx
		mov	dword ptr [esp+10h], 1
		lea	edx, [ebp-28h]
		mov	[esp+0Ch], edx
		lea	edx, [ebp-28h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		mov	eax, ds:CreateProcessA
		call	eax ; CreateProcessA
		sub	esp, 28h
		test	eax, eax
		jnz	short loc_40C8E7
		mov	dword ptr [esp], 0FFFFFFFFh
		call	sub_41B9A2
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aCreateprocessF	; "CreateProcess failed: %s\n"
		call	sub_41A665
		mov	eax, [ebp-80h]
		mov	[esp], eax
		call	sub_406E5D
		mov	eax, [ebp-88h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp-84h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	dword ptr [esp], 1
		call	sub_40BFB3
		jmp	loc_40C9ED
; ---------------------------------------------------------------------------

loc_40C8E7:				; CODE XREF: .text:0040C887j
		mov	eax, [ebp-80h]
		mov	[esp], eax
		call	sub_406E5D
		mov	dword ptr [ebp-80h], 0
		mov	eax, [ebp-84h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+1Ch]
		and	eax, 40h
		test	eax, eax
		jz	short loc_40C922
		mov	dword ptr [esp], 0FFFFFFFFh
		call	sub_40BD38

loc_40C922:				; CODE XREF: .text:0040C914j
		mov	eax, [ebp-34h]
		mov	[esp], eax
		mov	eax, ds:ResumeThread
		call	eax ; ResumeThread
		sub	esp, 4
		mov	eax, [ebp-34h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp-88h]
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebp-1Ch], eax
		cmp	dword ptr [ebp-1Ch], 0FFFFFFFFh
		jnz	short loc_40C97B
		mov	eax, [ebp-88h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aFailedToTran_0	; "failed to translate osfhandle %p\n"
		call	sub_41A665
		jmp	short loc_40C993
; ---------------------------------------------------------------------------

loc_40C97B:				; CODE XREF: .text:0040C961j
		mov	dword ptr [esp+4], offset aR_0 ; "r"
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	_fdopen
		mov	edx, [ebp+20h]
		mov	[edx], eax

loc_40C993:				; CODE XREF: .text:0040C979j
		mov	eax, [ebp+20h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40C9DE
		call	sub_40BFCE
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	dword ptr [esp], offset	aCanTFdopenPipe	; "can't fdopen pipe for reading: %s\n"
		call	sub_419D7C
		mov	[esp+4], ebx
		mov	[esp], eax
		call	sub_41A665
		mov	eax, [ebp-38h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp-14h]
		jmp	short loc_40C9ED
; ---------------------------------------------------------------------------

loc_40C9DE:				; CODE XREF: .text:0040C99Aj
		mov	eax, [ebp-38h]
		mov	edx, eax
		mov	eax, [ebp+24h]
		mov	[eax], edx
		mov	eax, 0

loc_40C9ED:				; CODE XREF: .text:0040C763j
					; .text:0040C7BCj ...
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40C9F4(LPCSTR	lpApplicationName, int,	int, int, int, int)
sub_40C9F4	proc near		; CODE XREF: .text:0040DFEFp

hProcess	= dword	ptr -0B8h
lpCommandLine	= dword	ptr -0B4h
lpProcessAttributes= dword ptr -0B0h
lpThreadAttributes= dword ptr -0ACh
bInheritHandles	= dword	ptr -0A8h
dwCreationFlags	= dword	ptr -0A4h
lpEnvironment	= dword	ptr -0A0h
lpCurrentDirectory= dword ptr -9Ch
lpStartupInfo	= dword	ptr -98h
lpProcessInformation= dword ptr	-94h
hObject		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
StartupInfo	= _STARTUPINFOA	ptr -70h
ProcessInformation= _PROCESS_INFORMATION ptr -2Ch
ProcessAttributes= _SECURITY_ATTRIBUTES	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
lpApplicationName= dword ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0B0h
		mov	[ebp+ProcessInformation.hProcess], 0
		mov	[ebp+ProcessInformation.hThread], 0
		mov	[ebp+ProcessInformation.dwProcessId], 0
		mov	[ebp+ProcessInformation.dwThreadId], 0
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0FFFFFFFFh
		lea	eax, [ebp+ProcessAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+ProcessAttributes.nLength], 0Ch
		mov	[ebp+ProcessAttributes.bInheritHandle],	0
		lea	eax, [ebp+var_74]
		mov	[esp+0B8h+lpProcessAttributes],	eax ; int
		mov	eax, [ebp+arg_4]
		mov	[esp+0B8h+lpCommandLine], eax ;	int
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+0B8h+hProcess], eax ; char	*
		call	sub_40C27F
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40CA73
		mov	eax, [ebp+var_C]
		jmp	loc_40CC5C
; ---------------------------------------------------------------------------

loc_40CA73:				; CODE XREF: sub_40C9F4+75j
		lea	eax, [ebp+StartupInfo]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 11h
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	[ebp+StartupInfo.cb], 44h
		mov	[ebp+StartupInfo.dwFlags], 101h
		mov	[ebp+StartupInfo.wShowWindow], 5
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jnz	short loc_40CAB0
		mov	[esp+0B8h+hProcess], 0
		call	sub_40C503
		jmp	short loc_40CAB5
; ---------------------------------------------------------------------------

loc_40CAB0:				; CODE XREF: sub_40C9F4+ACj
		mov	eax, 0FFFFFFFFh

loc_40CAB5:				; CODE XREF: sub_40C9F4+BAj
		mov	[ebp+hObject], eax
		cmp	[ebp+arg_C], 0FFFFFFFFh
		jnz	short loc_40CACC
		mov	[esp+0B8h+hProcess], 1
		call	sub_40C503
		jmp	short loc_40CAD1
; ---------------------------------------------------------------------------

loc_40CACC:				; CODE XREF: sub_40C9F4+C8j
		mov	eax, 0FFFFFFFFh

loc_40CAD1:				; CODE XREF: sub_40C9F4+D6j
		mov	[ebp+var_7C], eax
		cmp	[ebp+arg_10], 0FFFFFFFFh
		jnz	short loc_40CAE8
		mov	[esp+0B8h+hProcess], 1
		call	sub_40C503
		jmp	short loc_40CAED
; ---------------------------------------------------------------------------

loc_40CAE8:				; CODE XREF: sub_40C9F4+E4j
		mov	eax, 0FFFFFFFFh

loc_40CAED:				; CODE XREF: sub_40C9F4+F2j
		mov	[ebp+var_78], eax
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jnz	short loc_40CAFB
		mov	eax, [ebp+hObject]
		jmp	short loc_40CB08
; ---------------------------------------------------------------------------

loc_40CAFB:				; CODE XREF: sub_40C9F4+100j
		mov	eax, [ebp+arg_8]
		mov	[esp+0B8h+hProcess], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle

loc_40CB08:				; CODE XREF: sub_40C9F4+105j
		mov	[ebp+StartupInfo.hStdInput], eax
		cmp	[ebp+arg_C], 0FFFFFFFFh
		jnz	short loc_40CB16
		mov	eax, [ebp+var_7C]
		jmp	short loc_40CB23
; ---------------------------------------------------------------------------

loc_40CB16:				; CODE XREF: sub_40C9F4+11Bj
		mov	eax, [ebp+arg_C]
		mov	[esp+0B8h+hProcess], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle

loc_40CB23:				; CODE XREF: sub_40C9F4+120j
		mov	[ebp+StartupInfo.hStdOutput], eax
		cmp	[ebp+arg_10], 0FFFFFFFFh
		jnz	short loc_40CB31
		mov	eax, [ebp+var_78]
		jmp	short loc_40CB3E
; ---------------------------------------------------------------------------

loc_40CB31:				; CODE XREF: sub_40C9F4+136j
		mov	eax, [ebp+arg_10]
		mov	[esp+0B8h+hProcess], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle

loc_40CB3E:				; CODE XREF: sub_40C9F4+13Bj
		mov	[ebp+StartupInfo.hStdError], eax
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp+0B8h+hProcess], eax ; hProcess
		mov	eax, ds:GetPriorityClass
		call	eax ; GetPriorityClass
		sub	esp, 4
		mov	ecx, eax
		or	ecx, 400000Ch
		mov	eax, [ebp+var_74]
		lea	edx, [ebp+ProcessInformation]
		mov	[esp+0B8h+lpProcessInformation], edx ; lpProcessInformation
		lea	edx, [ebp+StartupInfo]
		mov	[esp+0B8h+lpStartupInfo], edx ;	lpStartupInfo
		mov	[esp+0B8h+lpCurrentDirectory], 0 ; lpCurrentDirectory
		mov	[esp+0B8h+lpEnvironment], 0 ; lpEnvironment
		mov	[esp+0B8h+dwCreationFlags], ecx	; dwCreationFlags
		mov	[esp+0B8h+bInheritHandles], 1 ;	bInheritHandles
		lea	edx, [ebp+ProcessAttributes]
		mov	[esp+0B8h+lpThreadAttributes], edx ; lpThreadAttributes
		lea	edx, [ebp+ProcessAttributes]
		mov	[esp+0B8h+lpProcessAttributes],	edx ; lpProcessAttributes
		mov	[esp+0B8h+lpCommandLine], eax ;	lpCommandLine
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+0B8h+hProcess], eax ; lpApplicationName
		mov	eax, ds:CreateProcessA
		call	eax ; CreateProcessA
		sub	esp, 28h
		test	eax, eax
		jnz	short loc_40CBDD
		mov	[esp+0B8h+hProcess], 0FFFFFFFFh	; DWORD
		call	sub_41B9A2
		mov	[esp+0B8h+lpCommandLine], eax ;	char
		mov	[esp+0B8h+hProcess], offset aCreateprocessF ; "CreateProcess failed: %s\n"
		call	sub_41A665
		mov	[esp+0B8h+hProcess], 1
		call	sub_40BFB3
		mov	[ebp+var_C], eax
		jmp	short loc_40CBE4
; ---------------------------------------------------------------------------

loc_40CBDD:				; CODE XREF: sub_40C9F4+1BAj
		mov	[ebp+var_C], 0

loc_40CBE4:				; CODE XREF: sub_40C9F4+1E7j
		mov	eax, [ebp+var_74]
		mov	[esp+0B8h+hProcess], eax ; void	*
		call	sub_406E5D
		mov	[ebp+var_10], 0
		jmp	short loc_40CC1C
; ---------------------------------------------------------------------------

loc_40CBF8:				; CODE XREF: sub_40C9F4+22Cj
		mov	eax, [ebp+var_10]
		mov	eax, [ebp+eax*4+hObject]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40CC18
		mov	eax, [ebp+var_10]
		mov	eax, [ebp+eax*4+hObject]
		mov	[esp+0B8h+hProcess], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_40CC18:				; CODE XREF: sub_40C9F4+20Ej
		add	[ebp+var_10], 1

loc_40CC1C:				; CODE XREF: sub_40C9F4+202j
		cmp	[ebp+var_10], 2
		jle	short loc_40CBF8
		cmp	[ebp+var_C], 0
		jz	short loc_40CC2D
		mov	eax, [ebp+var_C]
		jmp	short loc_40CC5C
; ---------------------------------------------------------------------------

loc_40CC2D:				; CODE XREF: sub_40C9F4+232j
		mov	eax, [ebp+ProcessInformation.hThread]
		mov	[esp+0B8h+hProcess], eax ; hThread
		mov	eax, ds:ResumeThread
		call	eax ; ResumeThread
		sub	esp, 4
		mov	eax, [ebp+ProcessInformation.hThread]
		mov	[esp+0B8h+hProcess], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+ProcessInformation.hProcess]
		mov	edx, eax
		mov	eax, [ebp+arg_14]
		mov	[eax], edx
		mov	eax, 0

loc_40CC5C:				; CODE XREF: sub_40C9F4+7Aj
					; sub_40C9F4+237j
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40C9F4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CC63	proc near		; CODE XREF: .text:0040E035p

hHandle		= dword	ptr -28h
dwMilliseconds	= dword	ptr -24h
var_20		= dword	ptr -20h
ExitCode	= dword	ptr -18h
var_14		= byte ptr -14h
hProcess	= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= byte ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, dword ptr [ebp+arg_4]
		mov	[ebp+hProcess],	eax
		cmp	[ebp+arg_8], 0
		jz	short loc_40CC7F
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0FFFFFFFFh

loc_40CC7F:				; CODE XREF: sub_40CC63+11j
		cmp	dword ptr [ebp+arg_4], 0FFFFFFFFh
		jnz	short loc_40CC96
		mov	[esp+28h+hHandle], 37h
		call	sub_40BFB3
		jmp	loc_40CDED
; ---------------------------------------------------------------------------

loc_40CC96:				; CODE XREF: sub_40CC63+20j
		mov	[esp+28h+dwMilliseconds], 0FFFFFFFFh ; dwMilliseconds
		mov	eax, [ebp+hProcess]
		mov	[esp+28h+hHandle], eax ; hHandle
		mov	eax, ds:WaitForSingleObject
		call	eax ; WaitForSingleObject
		sub	esp, 8
		mov	dword ptr [ebp+var_14],	eax
		mov	eax, dword ptr [ebp+var_14]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40CCC2
		test	eax, eax
		jz	short loc_40CCFB
		jmp	loc_40CDB8
; ---------------------------------------------------------------------------

loc_40CCC2:				; CODE XREF: sub_40CC63+54j
		mov	[esp+28h+hHandle], 0FFFFFFFFh ;	DWORD
		call	sub_41B9A2
		mov	ebx, eax
		mov	[esp+28h+hHandle], offset aWaitingForProc ; "waiting for process %d to terminate fai"...
		call	sub_419D7C
		mov	[esp+28h+var_20], ebx
		mov	edx, dword ptr [ebp+arg_4]
		mov	[esp+28h+dwMilliseconds], edx ;	char
		mov	[esp+28h+hHandle], eax ; char *
		call	sub_41A665
		mov	[ebp+var_C], 1
		jmp	loc_40CDDA
; ---------------------------------------------------------------------------

loc_40CCFB:				; CODE XREF: sub_40CC63+58j
		lea	eax, [ebp+ExitCode]
		mov	[esp+28h+dwMilliseconds], eax ;	lpExitCode
		mov	eax, [ebp+hProcess]
		mov	[esp+28h+hHandle], eax ; hProcess
		mov	eax, ds:GetExitCodeProcess
		call	eax ; GetExitCodeProcess
		sub	esp, 8
		test	eax, eax
		jnz	short loc_40CD4C
		mov	[esp+28h+hHandle], 0FFFFFFFFh ;	DWORD
		call	sub_41B9A2
		mov	ebx, eax
		mov	[esp+28h+hHandle], offset aErrorGettingEx ; "error getting exit	code of	process	%d: "...
		call	sub_419D7C
		mov	[esp+28h+var_20], ebx
		mov	edx, dword ptr [ebp+arg_4]
		mov	[esp+28h+dwMilliseconds], edx ;	char
		mov	[esp+28h+hHandle], eax ; char *
		call	sub_41A665
		mov	[ebp+var_C], 1
		jmp	short loc_40CDA6
; ---------------------------------------------------------------------------

loc_40CD4C:				; CODE XREF: sub_40CC63+B1j
		mov	eax, [ebp+ExitCode]
		test	eax, eax
		jz	short loc_40CD90
		mov	eax, [ebp+ExitCode]
		mov	ebx, eax
		mov	[esp+28h+hHandle], offset aErrorRunningSE ; "error running `%s': exit status %d\n"
		call	sub_419D7C
		mov	[esp+28h+var_20], ebx
		mov	edx, dword ptr [ebp+arg_0]
		mov	[esp+28h+dwMilliseconds], edx ;	char
		mov	[esp+28h+hHandle], eax ; char *
		call	sub_41A665
		cmp	[ebp+arg_8], 0
		jz	short loc_40CD87
		mov	eax, [ebp+ExitCode]
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_40CD87:				; CODE XREF: sub_40CC63+118j
		mov	[ebp+var_C], 1
		jmp	short loc_40CDA6
; ---------------------------------------------------------------------------

loc_40CD90:				; CODE XREF: sub_40CC63+EEj
		cmp	[ebp+arg_8], 0
		jz	short loc_40CD9F
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0

loc_40CD9F:				; CODE XREF: sub_40CC63+131j
		mov	[ebp+var_C], 0

loc_40CDA6:				; CODE XREF: sub_40CC63+E7j
					; sub_40CC63+12Bj
		mov	eax, [ebp+hProcess]
		mov	[esp+28h+hHandle], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		jmp	short loc_40CDDA
; ---------------------------------------------------------------------------

loc_40CDB8:				; CODE XREF: sub_40CC63+5Aj
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+28h+dwMilliseconds], eax ;	char
		mov	[esp+28h+hHandle], offset aWaitforsingleo ; "WaitForSingleObject returned unexpected"...
		call	sub_41A665
		mov	[ebp+var_C], 1
		nop

loc_40CDDA:				; CODE XREF: sub_40CC63+93j
					; sub_40CC63+153j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+dwMilliseconds], eax
		mov	[esp+28h+hHandle], 0
		call	sub_40BF8C

loc_40CDED:				; CODE XREF: sub_40CC63+2Ej
		mov	ebx, [ebp+var_4]
		leave
		retn
sub_40CC63	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40CDF2(LPCSTR	lpApplicationName, int)
sub_40CDF2	proc near		; CODE XREF: sub_406808+123p
					; .text:0040E0F5p

hProcess	= dword	ptr -0A8h
lpCommandLine	= dword	ptr -0A4h
lpProcessAttributes= dword ptr -0A0h
lpThreadAttributes= dword ptr -9Ch
bInheritHandles	= dword	ptr -98h
dwCreationFlags	= dword	ptr -94h
lpEnvironment	= dword	ptr -90h
lpCurrentDirectory= dword ptr -8Ch
lpStartupInfo	= dword	ptr -88h
lpProcessInformation= dword ptr	-84h
var_74		= dword	ptr -74h
StartupInfo	= _STARTUPINFOA	ptr -70h
ProcessInformation= _PROCESS_INFORMATION ptr -2Ch
ProcessAttributes= _SECURITY_ATTRIBUTES	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
lpApplicationName= dword ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0A0h
		mov	[ebp+ProcessInformation.hProcess], 0
		mov	[ebp+ProcessInformation.hThread], 0
		mov	[ebp+ProcessInformation.dwProcessId], 0
		mov	[ebp+ProcessInformation.dwThreadId], 0
		mov	[esp+0A8h+lpCommandLine], 0
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+0A8h+hProcess], eax
		call	_access
		test	eax, eax
		jz	short loc_40CE3A
		call	sub_40BFCE
		jmp	loc_40CF80
; ---------------------------------------------------------------------------

loc_40CE3A:				; CODE XREF: sub_40CDF2+3Cj
		lea	eax, [ebp+ProcessAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+ProcessAttributes.nLength], 0Ch
		mov	[ebp+ProcessAttributes.bInheritHandle],	0
		lea	eax, [ebp+var_74]
		mov	[esp+0A8h+lpProcessAttributes],	eax ; int
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+lpCommandLine], eax ;	int
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+0A8h+hProcess], eax ; char	*
		call	sub_40C27F
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40CE89
		mov	eax, [ebp+var_C]
		jmp	loc_40CF80
; ---------------------------------------------------------------------------

loc_40CE89:				; CODE XREF: sub_40CDF2+8Dj
		lea	eax, [ebp+StartupInfo]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 11h
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	[ebp+StartupInfo.cb], 44h
		mov	[ebp+StartupInfo.dwFlags], 1
		mov	[ebp+StartupInfo.wShowWindow], 5
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp+0A8h+hProcess], eax ; hProcess
		mov	eax, ds:GetPriorityClass
		call	eax ; GetPriorityClass
		sub	esp, 4
		or	eax, 4000208h
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_74]
		lea	ecx, [ebp+ProcessInformation]
		mov	[esp+0A8h+lpProcessInformation], ecx ; lpProcessInformation
		lea	ecx, [ebp+StartupInfo]
		mov	[esp+0A8h+lpStartupInfo], ecx ;	lpStartupInfo
		mov	[esp+0A8h+lpCurrentDirectory], 0 ; lpCurrentDirectory
		mov	[esp+0A8h+lpEnvironment], 0 ; lpEnvironment
		mov	[esp+0A8h+dwCreationFlags], edx	; dwCreationFlags
		mov	[esp+0A8h+bInheritHandles], 0 ;	bInheritHandles
		lea	edx, [ebp+ProcessAttributes]
		mov	[esp+0A8h+lpThreadAttributes], edx ; lpThreadAttributes
		lea	edx, [ebp+ProcessAttributes]
		mov	[esp+0A8h+lpProcessAttributes],	edx ; lpProcessAttributes
		mov	[esp+0A8h+lpCommandLine], eax ;	lpCommandLine
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+0A8h+hProcess], eax ; lpApplicationName
		mov	eax, ds:CreateProcessA
		call	eax ; CreateProcessA
		sub	esp, 28h
		test	eax, eax
		jnz	short loc_40CF59
		mov	[esp+0A8h+hProcess], 0FFFFFFFFh	; DWORD
		call	sub_41B9A2
		mov	[esp+0A8h+lpCommandLine], eax ;	char
		mov	[esp+0A8h+hProcess], offset aCreateprocessD ; "CreateProcess(detached) failed: %s\n"
		call	sub_41A665
		mov	eax, [ebp+var_74]
		mov	[esp+0A8h+hProcess], eax ; void	*
		call	sub_406E5D
		mov	[esp+0A8h+hProcess], 1
		call	sub_40BFB3
		jmp	short loc_40CF80
; ---------------------------------------------------------------------------

loc_40CF59:				; CODE XREF: sub_40CDF2+130j
		mov	eax, [ebp+var_74]
		mov	[esp+0A8h+hProcess], eax ; void	*
		call	sub_406E5D
		mov	[ebp+var_74], 0
		mov	eax, [ebp+ProcessInformation.hThread]
		mov	[esp+0A8h+hProcess], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0

loc_40CF80:				; CODE XREF: sub_40CDF2+43j
					; sub_40CDF2+92j ...
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40CDF2	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CF88	proc near		; CODE XREF: sub_40CFAF+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_40CFA8
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_40CFAD
; ---------------------------------------------------------------------------

loc_40CFA8:				; CODE XREF: sub_40CF88+7j
		mov	eax, 0

loc_40CFAD:				; CODE XREF: sub_40CF88+1Ej
		pop	ebp
		retn
sub_40CF88	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CFAF	proc near		; CODE XREF: sub_40CFCA+Ep
					; .text:0040D4E7p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_40CF88
		leave
		retn
sub_40CFAF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CFCA	proc near		; CODE XREF: sub_40D1E0+1BFp
					; sub_40D1E0+24Bp

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_40CFAF
		leave
		retn
sub_40CFCA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CFDF	proc near		; CODE XREF: sub_40D6A4+107p
					; sub_40D6A4+117p
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_40CFDF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CFE9	proc near		; CODE XREF: sub_40DAA2+E2p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		js	short loc_40D005
		mov	eax, [ebp+var_4]
		cmp	eax, 7
		jbe	short loc_40D00C

loc_40D005:				; CODE XREF: sub_40CFE9+12j
		mov	eax, 0
		jmp	short locret_40D036
; ---------------------------------------------------------------------------

loc_40D00C:				; CODE XREF: sub_40CFE9+1Aj
		mov	eax, [ebp+var_4]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		cmp	[ebp+arg_4], 0
		jz	short loc_40D02C
		mov	eax, [ebp+var_4]
		mov	edx, off_422104[eax*8]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx

loc_40D02C:				; CODE XREF: sub_40CFE9+32j
		mov	eax, [ebp+var_4]
		mov	eax, off_422100[eax*8]

locret_40D036:				; CODE XREF: sub_40CFE9+21j
		leave
		retn
sub_40CFE9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D038	proc near		; CODE XREF: sub_406808:loc_406BFFp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_24], 0Ch ;	size_t
		mov	[esp+28h+var_28], 1 ; size_t
		call	sub_406DBE
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40D0AE
		mov	eax, ds:dword_428A20
		test	eax, eax
		jz	short loc_40D06B
		mov	eax, ds:dword_428A20
		jmp	short loc_40D070
; ---------------------------------------------------------------------------

loc_40D06B:				; CODE XREF: sub_40D038+2Aj
		mov	eax, 8

loc_40D070:				; CODE XREF: sub_40D038+31j
		mov	edx, [ebp+var_C]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+var_24], 4 ; size_t
		mov	[esp+28h+var_28], eax ;	size_t
		call	sub_406DBE
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_40D0AE
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_406E5D
		mov	[ebp+var_C], 0

loc_40D0AE:				; CODE XREF: sub_40D038+21j
					; sub_40D038+62j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40D038	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D0B3(void *)
sub_40D0B3	proc near		; CODE XREF: sub_406808+459p

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	loc_40D150
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 8
		jbe	short loc_40D0EF
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 3Ah
		ja	short loc_40D0EF
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, ds:dword_428A20
		cmp	edx, eax
		jbe	short loc_40D0EF
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	ds:dword_428A20, eax

loc_40D0EF:				; CODE XREF: sub_40D0B3+18j
					; sub_40D0B3+22j ...
		mov	[ebp+var_C], 0
		jmp	short loc_40D128
; ---------------------------------------------------------------------------

loc_40D0F8:				; CODE XREF: sub_40D0B3+80j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40D124
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_406E5D

loc_40D124:				; CODE XREF: sub_40D0B3+57j
		add	[ebp+var_C], 1

loc_40D128:				; CODE XREF: sub_40D0B3+43j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	short loc_40D0F8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_406E5D
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_406E5D
		jmp	short locret_40D151
; ---------------------------------------------------------------------------

loc_40D150:				; CODE XREF: sub_40D0B3+Aj
		nop

locret_40D151:				; CODE XREF: sub_40D0B3+9Bj
		leave
		retn
sub_40D0B3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D153(int, char *)
sub_40D153	proc near		; CODE XREF: .text:0040D52Dp
					; .text:0040D5A0p

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		jmp	short loc_40D1CC
; ---------------------------------------------------------------------------

loc_40D162:				; CODE XREF: sub_40D153+84j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40D1C8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str2],	eax ; Str2
		mov	[esp+28h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40D1C8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+28h+Str1],	eax ; void *
		call	sub_406E5D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	dword ptr [eax], 0

loc_40D1C8:				; CODE XREF: sub_40D153+21j
					; sub_40D153+47j
		add	[ebp+var_C], 1

loc_40D1CC:				; CODE XREF: sub_40D153+Dj
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	short loc_40D162
		mov	eax, 0
		leave
		retn
sub_40D153	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D1E0(int, char *, size_t, int, int)
sub_40D1E0	proc near		; CODE XREF: .text:0040D561p
					; .text:0040D5E6p ...

Str1		= dword	ptr -48h
Str2		= dword	ptr -44h
MaxCount	= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
Size		= dword	ptr -18h
Src		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	[ebp+var_10], 0FFFFFFFFh
		cmp	[ebp+arg_C], 0
		jz	short loc_40D1FC
		mov	eax, [ebp+arg_C]
		mov	[ebp+Src], eax
		jmp	short loc_40D208
; ---------------------------------------------------------------------------

loc_40D1FC:				; CODE XREF: sub_40D1E0+12j
		mov	eax, [ebp+arg_8]
		add	eax, 1
		add	eax, [ebp+arg_4]
		mov	[ebp+Src], eax

loc_40D208:				; CODE XREF: sub_40D1E0+1Aj
		mov	eax, [ebp+Src]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+Size], eax
		mov	[ebp+var_C], 0
		jmp	loc_40D34A
; ---------------------------------------------------------------------------

loc_40D236:				; CODE XREF: sub_40D1E0+175j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40D255
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	loc_40D346
; ---------------------------------------------------------------------------

loc_40D255:				; CODE XREF: sub_40D1E0+68j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+MaxCount], eax	; MaxCount
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str2],	eax ; Str2
		mov	[esp+48h+Str1],	edx ; Str1
		call	strncmp
		test	eax, eax
		jnz	loc_40D346
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		add	eax, 8
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, [ebp+arg_8]
		jnz	loc_40D346
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, [ebp+Size]
		jnz	short loc_40D340
		mov	edx, [ebp+Src]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [ebp+var_C]
		shl	ecx, 2
		add	eax, ecx
		mov	eax, [eax]
		mov	eax, [eax]
		mov	ecx, [ebp+Size]
		mov	[esp+48h+MaxCount], ecx	; Size
		mov	[esp+48h+Str2],	edx ; Src
		mov	[esp+48h+Str1],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		cmp	[ebp+arg_10], 0
		setnz	dl
		movzx	edx, dl
		mov	[eax+4], edx
		mov	eax, 0
		jmp	loc_40D4C4
; ---------------------------------------------------------------------------

loc_40D340:				; CODE XREF: sub_40D1E0+10Fj
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax

loc_40D346:				; CODE XREF: sub_40D1E0+70j
					; sub_40D1E0+A0j ...
		add	[ebp+var_C], 1

loc_40D34A:				; CODE XREF: sub_40D1E0+51j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	loc_40D236
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	loc_40D40F
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	edx, eax
		jnz	loc_40D3FD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		add	eax, 0Ah
		mov	[ebp+var_1C], eax
		mov	[esp+48h+Str2],	4 ; size_t
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Str1],	eax ; size_t
		call	sub_406DBE
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_40D3A9
		call	sub_40CFCA
		jmp	loc_40D4C4
; ---------------------------------------------------------------------------

loc_40D3A9:				; CODE XREF: sub_40D1E0+1BDj
		mov	[ebp+var_C], 0
		jmp	short loc_40D3D1
; ---------------------------------------------------------------------------

loc_40D3B2:				; CODE XREF: sub_40D1E0+1FCj
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+var_20]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+8]
		mov	ecx, [ebp+var_C]
		shl	ecx, 2
		add	edx, ecx
		mov	edx, [edx]
		mov	[eax], edx
		add	[ebp+var_C], 1

loc_40D3D1:				; CODE XREF: sub_40D1E0+1D0j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	short loc_40D3B2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+48h+Str1],	eax ; void *
		call	sub_406E5D
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_20]
		mov	[eax+8], edx

loc_40D3FD:				; CODE XREF: sub_40D1E0+192j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[ebp+var_10], eax
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+4], edx

loc_40D40F:				; CODE XREF: sub_40D1E0+17Fj
		mov	eax, [ebp+Size]
		mov	edx, [ebp+arg_8]
		add	eax, edx
		add	eax, 0Dh
		mov	[esp+48h+Str1],	eax ; size_t
		call	sub_406CDA
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_40D435
		call	sub_40CFCA
		jmp	loc_40D4C4
; ---------------------------------------------------------------------------

loc_40D435:				; CODE XREF: sub_40D1E0+249j
		cmp	[ebp+arg_10], 0
		setnz	al
		movzx	edx, al
		mov	eax, [ebp+var_24]
		mov	[eax+4], edx
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_24]
		add	eax, 8
		mov	ecx, [ebp+arg_8]
		mov	[esp+48h+MaxCount], ecx	; Size
		mov	[esp+48h+Str2],	edx ; Src
		mov	[esp+48h+Str1],	eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+arg_8]
		add	eax, edx
		mov	byte ptr [eax+8], 0
		mov	eax, [ebp+var_24]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_8]
		add	eax, 1
		add	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], edx
		mov	eax, [ebp+var_24]
		mov	eax, [eax]
		mov	edx, [ebp+Src]
		mov	[esp+48h+Str2],	edx ; Source
		mov	[esp+48h+Str1],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_10]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+48h+Str1],	eax ; void *
		call	sub_406E5D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_10]
		shl	edx, 2
		add	edx, eax
		mov	eax, [ebp+var_24]
		mov	[edx], eax
		mov	eax, 0

loc_40D4C4:				; CODE XREF: sub_40D1E0+15Bj
					; sub_40D1E0+1C4j ...
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_40D1E0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_40D4E0
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40D4EE

loc_40D4E0:				; CODE XREF: .text:0040D4D4j
		mov	dword ptr [esp], 37h
		call	sub_40CFAF
		jmp	short locret_40D566
; ---------------------------------------------------------------------------

loc_40D4EE:				; CODE XREF: .text:0040D4DEj
		mov	dword ptr [esp+4], 3Dh
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	strchr
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+0Ch]
		jnz	short loc_40D51A
		mov	dword ptr [esp], 37h
		call	sub_40CFAF
		jmp	short locret_40D566
; ---------------------------------------------------------------------------

loc_40D51A:				; CODE XREF: .text:0040D50Aj
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40D534
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40D153
		jmp	short locret_40D566
; ---------------------------------------------------------------------------

loc_40D534:				; CODE XREF: .text:0040D51Ej
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40D1E0

locret_40D566:				; CODE XREF: .text:0040D4ECj
					; .text:0040D518j ...
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_40D57F
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40D58D

loc_40D57F:				; CODE XREF: .text:0040D573j
		mov	dword ptr [esp], 37h
		call	sub_40CFAF
		jmp	short loc_40D5EB
; ---------------------------------------------------------------------------

loc_40D58D:				; CODE XREF: .text:0040D57Dj
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_40D5A7
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40D153
		jmp	short loc_40D5EB
; ---------------------------------------------------------------------------

loc_40D5A7:				; CODE XREF: .text:0040D591j
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	dword ptr [esp+10h], 0
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40D1E0

loc_40D5EB:				; CODE XREF: .text:0040D58Bj
					; .text:0040D5A5j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_40D60D
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_40D60D
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40D617

loc_40D60D:				; CODE XREF: .text:0040D5FBj
					; .text:0040D601j
		mov	eax, 0
		jmp	locret_40D6A2
; ---------------------------------------------------------------------------

loc_40D617:				; CODE XREF: .text:0040D60Bj
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_40D690
; ---------------------------------------------------------------------------

loc_40D620:				; CODE XREF: .text:0040D69Bj
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		mov	edx, [ebp-0Ch]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40D68C
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		mov	edx, [ebp-0Ch]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		lea	edx, [eax+8]
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	[esp], edx
		call	strcmp
		test	eax, eax
		jnz	short loc_40D68C
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		mov	edx, [ebp-0Ch]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_40D685
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		mov	edx, [ebp-0Ch]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	eax, [eax]
		jmp	short loc_40D68A
; ---------------------------------------------------------------------------

loc_40D685:				; CODE XREF: .text:0040D66Fj
		mov	eax, 0

loc_40D68A:				; CODE XREF: .text:0040D683j
		jmp	short locret_40D6A2
; ---------------------------------------------------------------------------

loc_40D68C:				; CODE XREF: .text:0040D632j
					; .text:0040D658j
		add	dword ptr [ebp-0Ch], 1

loc_40D690:				; CODE XREF: .text:0040D61Ej
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	short loc_40D620
		mov	eax, 0

locret_40D6A2:				; CODE XREF: .text:0040D612j
					; .text:loc_40D68Aj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D6A4(int, char *VarName, int)
sub_40D6A4	proc near		; CODE XREF: sub_40DAA2+3Cp
					; sub_40DAA2+109p

Str1		= dword	ptr -48h
Str2		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
VarName		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		cmp	[ebp+arg_8], 0
		jz	short loc_40D6BA
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0

loc_40D6BA:				; CODE XREF: sub_40D6A4+Bj
		cmp	[ebp+arg_0], 0
		jz	short loc_40D6D0
		cmp	[ebp+VarName], 0
		jz	short loc_40D6D0
		mov	eax, [ebp+VarName]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40D6DA

loc_40D6D0:				; CODE XREF: sub_40D6A4+1Aj
					; sub_40D6A4+20j
		mov	eax, 0
		jmp	loc_40D8A8
; ---------------------------------------------------------------------------

loc_40D6DA:				; CODE XREF: sub_40D6A4+2Aj
		mov	[ebp+var_C], 0
		jmp	short loc_40D75E
; ---------------------------------------------------------------------------

loc_40D6E3:				; CODE XREF: sub_40D6A4+C5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40D75A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		lea	edx, [eax+8]
		mov	eax, [ebp+VarName]
		mov	[esp+48h+Str2],	eax ; Str2
		mov	[esp+48h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40D75A
		cmp	[ebp+arg_8], 0
		jz	short loc_40D743
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40D743
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 1

loc_40D743:				; CODE XREF: sub_40D6A4+7Dj
					; sub_40D6A4+94j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	eax, [eax]
		jmp	loc_40D8A8
; ---------------------------------------------------------------------------

loc_40D75A:				; CODE XREF: sub_40D6A4+51j
					; sub_40D6A4+77j
		add	[ebp+var_C], 1

loc_40D75E:				; CODE XREF: sub_40D6A4+3Dj
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	loc_40D6E3
		mov	eax, [ebp+VarName]
		mov	[esp+48h+Str1],	eax ; VarName
		call	getenv
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40D78D
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40D7C3

loc_40D78D:				; CODE XREF: sub_40D6A4+DDj
		mov	[esp+48h+Str2],	offset aGpg_tty	; "GPG_TTY"
		mov	eax, [ebp+VarName]
		mov	[esp+48h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40D7C3
		mov	[esp+48h+Str1],	0
		call	sub_40CFDF
		test	eax, eax
		jz	short loc_40D7C3
		mov	[esp+48h+Str1],	0
		call	sub_40CFDF
		mov	[ebp+var_10], eax

loc_40D7C3:				; CODE XREF: sub_40D6A4+E7j
					; sub_40D6A4+FEj ...
		cmp	[ebp+var_10], 0
		jz	loc_40D8A3
		mov	eax, [ebp+VarName]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	[esp+48h+var_38], 1 ; int
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_3C], eax ;	int
		mov	[esp+48h+var_40], edx ;	size_t
		mov	eax, [ebp+VarName]
		mov	[esp+48h+Str2],	eax ; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str1],	eax ; int
		call	sub_40D1E0
		mov	[ebp+var_C], 0
		jmp	short loc_40D892
; ---------------------------------------------------------------------------

loc_40D81A:				; CODE XREF: sub_40D6A4+1F9j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40D88E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		lea	edx, [eax+8]
		mov	eax, [ebp+VarName]
		mov	[esp+48h+Str2],	eax ; Str2
		mov	[esp+48h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40D88E
		cmp	[ebp+arg_8], 0
		jz	short loc_40D87A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40D87A
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 1

loc_40D87A:				; CODE XREF: sub_40D6A4+1B4j
					; sub_40D6A4+1CBj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	eax, [eax]
		jmp	short loc_40D8A8
; ---------------------------------------------------------------------------

loc_40D88E:				; CODE XREF: sub_40D6A4+188j
					; sub_40D6A4+1AEj
		add	[ebp+var_C], 1

loc_40D892:				; CODE XREF: sub_40D6A4+174j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	loc_40D81A

loc_40D8A3:				; CODE XREF: sub_40D6A4+123j
		mov	eax, 0

loc_40D8A8:				; CODE XREF: sub_40D6A4+31j
					; sub_40D6A4+B1j ...
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_40D6A4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[ebp-4], eax
		cmp	dword ptr [ebp+8], 0
		jz	short loc_40D8C8
		cmp	dword ptr [ebp-4], 0
		jns	short loc_40D947

loc_40D8C8:				; CODE XREF: .text:0040D8C0j
		mov	eax, 0
		jmp	locret_40D95E
; ---------------------------------------------------------------------------

loc_40D8D2:				; CODE XREF: .text:0040D953j
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		mov	edx, [ebp-4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40D941
		mov	eax, [ebp-4]
		lea	edx, [eax+1]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_40D90F
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		mov	edx, [ebp-4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	edx, [eax+4]
		mov	eax, [ebp+14h]
		mov	[eax], edx

loc_40D90F:				; CODE XREF: .text:0040D8F5j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_40D92C
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		mov	edx, [ebp-4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	edx, [eax]
		mov	eax, [ebp+10h]
		mov	[eax], edx

loc_40D92C:				; CODE XREF: .text:0040D913j
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		mov	edx, [ebp-4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		add	eax, 8
		jmp	short locret_40D95E
; ---------------------------------------------------------------------------

loc_40D941:				; CODE XREF: .text:0040D8E4j
		add	dword ptr [ebp-4], 1
		jmp	short loc_40D948
; ---------------------------------------------------------------------------

loc_40D947:				; CODE XREF: .text:0040D8C6j
		nop

loc_40D948:				; CODE XREF: .text:0040D945j
		mov	edx, [ebp-4]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	loc_40D8D2
		mov	eax, 0

locret_40D95E:				; CODE XREF: .text:0040D8CDj
					; .text:0040D93Fj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D960	proc near		; CODE XREF: sub_40D987+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_40D980
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_40D985
; ---------------------------------------------------------------------------

loc_40D980:				; CODE XREF: sub_40D960+7j
		mov	eax, 0

loc_40D985:				; CODE XREF: sub_40D960+1Ej
		pop	ebp
		retn
sub_40D960	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D987	proc near		; CODE XREF: sub_40D9AF+Ep
					; sub_40DCEC+58p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_40D960
		leave
		retn
sub_40D987	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D9A2	proc near		; CODE XREF: sub_40DAA2+B3p
					; .text:0040E3ACp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_40D9A2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D9AF	proc near		; CODE XREF: sub_40D9E6+5Dp
					; sub_40DAA2+156p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_40D987
		leave
		retn
sub_40D9AF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D9C4	proc near		; CODE XREF: .text:0040E1FBp
					; .text:0040E220p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jns	short loc_40D9D7
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40D9E4
; ---------------------------------------------------------------------------

loc_40D9D7:				; CODE XREF: sub_40D9C4+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle

locret_40D9E4:				; CODE XREF: sub_40D9C4+11j
		leave
		retn
sub_40D9C4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D9E6	proc near		; CODE XREF: sub_40DAA2+78p
					; sub_40DAA2+A5p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_C], 0
		jz	short loc_40D9FC
		mov	eax, [ebp+arg_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40DA08

loc_40D9FC:				; CODE XREF: sub_40D9E6+Aj
		mov	[ebp+var_C], 0
		jmp	loc_40DA9D
; ---------------------------------------------------------------------------

loc_40DA08:				; CODE XREF: sub_40D9E6+14j
		cmp	[ebp+arg_10], 0
		jz	short loc_40DA15
		mov	eax, offset aPutenv ; "putenv="
		jmp	short loc_40DA1A
; ---------------------------------------------------------------------------

loc_40DA15:				; CODE XREF: sub_40D9E6+26j
		mov	eax, offset byte_4251DC

loc_40DA1A:				; CODE XREF: sub_40D9E6+2Dj
		mov	edx, [ebp+arg_C]
		mov	[esp+38h+var_28], edx
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+var_2C], edx
		mov	[esp+38h+var_30], eax
		mov	[esp+38h+var_34], offset aOptionSSS ; "OPTION %s%s=%s"
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_40994C
		test	eax, eax
		jns	short loc_40DA4D
		call	sub_40D9AF
		mov	[ebp+var_C], eax
		jmp	short loc_40DA9D
; ---------------------------------------------------------------------------

loc_40DA4D:				; CODE XREF: sub_40D9E6+5Bj
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_1C], 0
		mov	[esp+38h+var_20], 0
		mov	[esp+38h+var_24], 0
		mov	[esp+38h+var_28], 0
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_transact
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax ;	void *
		call	sub_406E5D

loc_40DA9D:				; CODE XREF: sub_40D9E6+1Dj
					; sub_40D9E6+65j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40D9E6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40DAA2	proc near		; CODE XREF: sub_406808+44Bp
					; .text:0040E498p

var_58		= dword	ptr -58h
VarName		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_24], 0
		jmp	loc_40DB77
; ---------------------------------------------------------------------------

loc_40DAC9:				; CODE XREF: sub_40DAA2+EEj
		mov	[esp+58h+var_50], 0 ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+VarName], eax ; VarName
		mov	eax, [ebp+arg_10]
		mov	[esp+58h+var_58], eax ;	int
		call	sub_40D6A4
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	loc_40DB76
		mov	eax, [ebp+var_28]
		test	eax, eax
		jz	short loc_40DB24
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_48], 0
		mov	edx, [ebp+var_20]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+VarName], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_40D9E6
		mov	[ebp+var_C], eax
		jmp	short loc_40DB68
; ---------------------------------------------------------------------------

loc_40DB24:				; CODE XREF: sub_40DAA2+53j
		mov	[esp+58h+var_48], 1
		mov	eax, [ebp+var_20]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+VarName], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_40D9E6
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	sub_40D9A2
		cmp	eax, 0AEh
		jnz	short loc_40DB68
		mov	[ebp+var_C], 0

loc_40DB68:				; CODE XREF: sub_40DAA2+80j
					; sub_40DAA2+BDj
		cmp	[ebp+var_C], 0
		jz	short loc_40DB77
		mov	eax, [ebp+var_C]
		jmp	locret_40DCEA
; ---------------------------------------------------------------------------

loc_40DB76:				; CODE XREF: sub_40DAA2+48j
		nop

loc_40DB77:				; CODE XREF: sub_40DAA2+22j
					; sub_40DAA2+CAj
		lea	eax, [ebp+var_28]
		mov	[esp+58h+VarName], eax
		lea	eax, [ebp+var_24]
		mov	[esp+58h+var_58], eax
		call	sub_40CFE9
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_40DAC9
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+var_50], eax ;	int
		mov	[esp+58h+VarName], offset aGpg_tty_0 ; "GPG_TTY"
		mov	eax, [ebp+arg_10]
		mov	[esp+58h+var_58], eax ;	int
		call	sub_40D6A4
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_40DBC7
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jnz	short loc_40DBC7
		mov	[ebp+var_14], 0

loc_40DBC7:				; CODE XREF: sub_40DAA2+115j
					; sub_40DAA2+11Cj
		mov	[esp+58h+VarName], 0
		mov	[esp+58h+var_58], 2
		call	setlocale
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40DC02
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax ;	char *
		call	sub_406D24
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40DC02
		call	sub_40D9AF
		jmp	locret_40DCEA
; ---------------------------------------------------------------------------

loc_40DC02:				; CODE XREF: sub_40DAA2+140j
					; sub_40DAA2+154j
		mov	[esp+58h+VarName], offset byte_4251DC
		mov	[esp+58h+var_58], 2
		call	setlocale
		mov	[ebp+var_18], eax
		cmp	[ebp+arg_8], 0
		jnz	short loc_40DC2B
		cmp	[ebp+var_14], 0
		jz	short loc_40DC62
		cmp	[ebp+var_18], 0
		jz	short loc_40DC62

loc_40DC2B:				; CODE XREF: sub_40DAA2+17Bj
		cmp	[ebp+arg_8], 0
		jz	short loc_40DC36
		mov	eax, [ebp+arg_8]
		jmp	short loc_40DC39
; ---------------------------------------------------------------------------

loc_40DC36:				; CODE XREF: sub_40DAA2+18Dj
		mov	eax, [ebp+var_18]

loc_40DC39:				; CODE XREF: sub_40DAA2+192j
		mov	[esp+58h+var_48], 0
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], offset aLcCtype ; "lc-ctype"
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+VarName], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_40D9E6
		mov	[ebp+var_C], eax

loc_40DC62:				; CODE XREF: sub_40DAA2+181j
					; sub_40DAA2+187j
		cmp	[ebp+var_10], 0
		jz	short loc_40DC86
		mov	eax, [ebp+var_10]
		mov	[esp+58h+VarName], eax
		mov	[esp+58h+var_58], 2
		call	setlocale
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax ;	void *
		call	sub_406E5D

loc_40DC86:				; CODE XREF: sub_40DAA2+1C4j
		cmp	[ebp+var_C], 0
		jz	short loc_40DC91
		mov	eax, [ebp+var_C]
		jmp	short locret_40DCEA
; ---------------------------------------------------------------------------

loc_40DC91:				; CODE XREF: sub_40DAA2+1E8j
		cmp	[ebp+arg_C], 0
		jnz	short loc_40DCA3
		cmp	[ebp+var_14], 0
		jz	short loc_40DCDA
		cmp	[ebp+var_18], 0
		jz	short loc_40DCDA

loc_40DCA3:				; CODE XREF: sub_40DAA2+1F3j
		cmp	[ebp+arg_C], 0
		jz	short loc_40DCAE
		mov	eax, [ebp+arg_C]
		jmp	short loc_40DCB1
; ---------------------------------------------------------------------------

loc_40DCAE:				; CODE XREF: sub_40DAA2+205j
		mov	eax, [ebp+var_18]

loc_40DCB1:				; CODE XREF: sub_40DAA2+20Aj
		mov	[esp+58h+var_48], 0
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], offset aLcMessages ; "lc-messages"
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+VarName], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_40D9E6
		mov	[ebp+var_C], eax

loc_40DCDA:				; CODE XREF: sub_40DAA2+1F9j
					; sub_40DAA2+1FFj
		cmp	[ebp+var_C], 0
		jz	short loc_40DCE5
		mov	eax, [ebp+var_C]
		jmp	short locret_40DCEA
; ---------------------------------------------------------------------------

loc_40DCE5:				; CODE XREF: sub_40DAA2+23Cj
		mov	eax, 0

locret_40DCEA:				; CODE XREF: sub_40DAA2+CFj
					; sub_40DAA2+15Bj ...
		leave
		retn
sub_40DAA2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40DCEC	proc near		; CODE XREF: .text:0040E0A4p

lpMutexAttributes= dword ptr -28h
bInitialOwner	= dword	ptr -24h
lpName		= dword	ptr -20h
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+lpName], offset Name ;	"GnuPG_spawn_agent_sentinel"
		mov	[esp+28h+bInitialOwner], 0 ; bInitialOwner
		mov	[esp+28h+lpMutexAttributes], 0 ; lpMutexAttributes
		mov	eax, ds:CreateMutexA
		call	eax ; CreateMutexA
		sub	esp, 0Ch
		mov	edx, [ebp+arg_0]
		mov	[edx], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40DD4B
		mov	[esp+28h+lpMutexAttributes], 0FFFFFFFFh	; DWORD
		call	sub_41B9A2
		mov	[esp+28h+bInitialOwner], eax ; char
		mov	[esp+28h+lpMutexAttributes], offset aFailedToCreate ; "failed to create	the spawn_agent	mutex:"...
		call	sub_41A665
		mov	[esp+28h+lpMutexAttributes], 1
		call	sub_40D987
		jmp	short locret_40DDBB
; ---------------------------------------------------------------------------

loc_40DD4B:				; CODE XREF: sub_40DCEC+33j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+bInitialOwner], 1388h ; char
		mov	[esp+28h+lpMutexAttributes], eax ; hHandle
		mov	eax, ds:WaitForSingleObject
		call	eax ; WaitForSingleObject
		sub	esp, 8
		mov	dword ptr [ebp+var_C], eax
		cmp	dword ptr [ebp+var_C], 0
		jnz	short loc_40DD75
		mov	eax, 0
		jmp	short locret_40DDBB
; ---------------------------------------------------------------------------

loc_40DD75:				; CODE XREF: sub_40DCEC+80j
		cmp	dword ptr [ebp+var_C], 102h
		jnz	short loc_40DD8C
		mov	[esp+28h+lpMutexAttributes], offset aErrorWaitingFo ; "error waiting for the spawn_agent mutex"...
		call	sub_41A63B
		jmp	short loc_40DDAF
; ---------------------------------------------------------------------------

loc_40DD8C:				; CODE XREF: sub_40DCEC+90j
		mov	[esp+28h+lpMutexAttributes], 0FFFFFFFFh	; DWORD
		call	sub_41B9A2
		mov	[esp+28h+lpName], eax
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+28h+bInitialOwner], eax ; char
		mov	[esp+28h+lpMutexAttributes], offset aErrorWaiting_0 ; "error waiting for the spawn_agent mutex"...
		call	sub_41A63B

loc_40DDAF:				; CODE XREF: sub_40DCEC+9Ej
		mov	[esp+28h+lpMutexAttributes], 1
		call	sub_40D987

locret_40DDBB:				; CODE XREF: sub_40DCEC+5Dj
					; sub_40DCEC+87j
		leave
		retn
sub_40DCEC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40DDBD	proc near		; CODE XREF: .text:0040E19Cp

hMutex		= dword	ptr -18h
var_14		= byte ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jz	short locret_40DE19
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+18h+hMutex], eax ;	hMutex
		mov	eax, ds:ReleaseMutex
		call	eax ; ReleaseMutex
		sub	esp, 4
		test	eax, eax
		jnz	short loc_40DDFE
		mov	[esp+18h+hMutex], 0FFFFFFFFh ; DWORD
		call	sub_41B9A2
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+hMutex], offset aFailedToReleas ; "failed to release the spawn_agent mutex"...
		call	sub_41A665

loc_40DDFE:				; CODE XREF: sub_40DDBD+23j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+18h+hMutex], eax ;	hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0

locret_40DE19:				; CODE XREF: sub_40DDBD+Dj
		leave
		retn
sub_40DDBD	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 78h
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0
		lea	eax, [ebp-34h]
		mov	[esp], eax
		call	assuan_new
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40DE68
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	gpg_strerror
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aErrorAllocat_1	; "error allocating assuan context: %s\n"
		call	sub_41A665
		mov	eax, [ebp-0Ch]
		jmp	locret_40E4C3
; ---------------------------------------------------------------------------

loc_40DE68:				; CODE XREF: .text:0040DE43j
					; .text:0040E2E3j ...
		mov	eax, ds:dword_428A24
		test	eax, eax
		jnz	short loc_40DE7F
		mov	dword ptr [esp], offset	aGpg_agent_in_0	; "GPG_AGENT_INFO"
		call	getenv
		jmp	short loc_40DE84
; ---------------------------------------------------------------------------

loc_40DE7F:				; CODE XREF: .text:0040DE6Fj
		mov	eax, 0

loc_40DE84:				; CODE XREF: .text:0040DE7Dj
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-20h], 0
		jz	short loc_40DE9B
		mov	eax, [ebp-20h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_40E288

loc_40DE9B:				; CODE XREF: .text:0040DE8Bj
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], offset aS_gpgAgent_0	; "S.gpg-agent"
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_41B167
		mov	[ebp-2Ch], eax
		mov	eax, [ebp-34h]
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	edx, [ebp-2Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	assuan_socket_connect
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	loc_40E278
		cmp	dword ptr [ebp+24h], 0
		jz	short loc_40DF02
		mov	dword ptr [esp], offset	aNoRunningGpg_0	; "no running gpg-agent	- starting one\n"
		call	sub_419D7C
		mov	[esp], eax
		call	sub_41A63B

loc_40DF02:				; CODE XREF: .text:0040DEECj
		cmp	dword ptr [ebp+2Ch], 0
		jz	short loc_40DF2B
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], offset aStarting_agent ; "starting_agent ? 0	0"
		mov	dword ptr [esp+4], 30h
		mov	eax, [ebp+30h]
		mov	[esp], eax
		mov	eax, [ebp+2Ch]
		call	eax

loc_40DF2B:				; CODE XREF: .text:0040DF06j
		mov	dword ptr [esp], 0
		call	fflush
		test	eax, eax
		jz	short loc_40DF96
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp], eax
		call	gpg_err_code_from_errno
		mov	[esp], eax
		call	sub_40D987
		mov	[ebp-30h], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp], eax
		call	strerror
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aErrorFlushingP	; "error flushing pending output: %s\n"
		call	sub_41A665
		mov	eax, [ebp-2Ch]
		mov	[esp], eax
		call	sub_406E5D
		mov	eax, [ebp-34h]
		mov	[esp], eax
		call	assuan_release
		mov	eax, [ebp-30h]
		jmp	locret_40E4C3
; ---------------------------------------------------------------------------

loc_40DF96:				; CODE XREF: .text:0040DF39j
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_40DFA6
		mov	eax, [ebp+14h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40DFB5

loc_40DFA6:				; CODE XREF: .text:0040DF9Aj
		mov	dword ptr [esp], 1
		call	sub_40A3B2
		mov	[ebp+14h], eax

loc_40DFB5:				; CODE XREF: .text:0040DFA4j
		mov	dword ptr [ebp-40h], offset aUseStandardS_0 ; "--use-standard-socket-p"
		mov	dword ptr [ebp-3Ch], 0
		lea	eax, [ebp-44h]
		mov	[esp+14h], eax
		mov	dword ptr [esp+10h], 0FFFFFFFFh
		mov	dword ptr [esp+0Ch], 0FFFFFFFFh
		mov	dword ptr [esp+8], 0FFFFFFFFh
		lea	eax, [ebp-40h]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_40C9F4
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40E021
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	gpg_strerror
		mov	[esp+8], eax
		mov	eax, [ebp+14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aStartingSForTe	; "starting `%s' for testing failed: %s\n"
		call	sub_41A702
		jmp	short loc_40E06D
; ---------------------------------------------------------------------------

loc_40E021:				; CODE XREF: .text:0040DFFBj
		mov	eax, [ebp-44h]
		lea	edx, [ebp-48h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_40CC63
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40E06D
		mov	eax, [ebp-48h]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40E06D
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	gpg_strerror
		mov	[esp+8], eax
		mov	eax, [ebp+14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aRunningSForTes	; "running `%s' for testing failed: %s\n"
		call	sub_41A702

loc_40E06D:				; CODE XREF: .text:0040E01Fj
					; .text:0040E041j ...
		cmp	dword ptr [ebp-0Ch], 0
		jnz	loc_40E1A6
		mov	eax, [ebp-48h]
		test	eax, eax
		jnz	loc_40E1A6
		mov	dword ptr [ebp-40h], offset aDaemon_0 ;	"--daemon"
		mov	dword ptr [ebp-3Ch], offset aUseStandardS_1 ; "--use-standard-socket"
		mov	dword ptr [ebp-38h], 0
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		lea	eax, [ebp-4Ch]
		mov	[esp], eax
		call	sub_40DCEC
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	loc_40E196
		mov	eax, [ebp-34h]
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	edx, [ebp-2Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	assuan_socket_connect
		test	eax, eax
		jz	loc_40E196
		mov	dword ptr [esp+8], 0
		lea	eax, [ebp-40h]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_40CDF2
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40E127
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	gpg_strerror
		mov	[esp+8], eax
		mov	eax, [ebp+14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aFailedToStar_0	; "failed to start agent `%s': %s\n"
		call	sub_41A665
		jmp	short loc_40E196
; ---------------------------------------------------------------------------

loc_40E127:				; CODE XREF: .text:0040E101j
		cmp	dword ptr [ebp+24h], 0
		jz	short loc_40E149
		mov	dword ptr [esp], offset	aWaitingDSecond	; "waiting %d seconds for the agent to com"...
		call	sub_419D7C
		mov	dword ptr [esp+4], 5
		mov	[esp], eax
		call	sub_41A63B

loc_40E149:				; CODE XREF: .text:0040E12Bj
		mov	dword ptr [ebp-14h], 0
		jmp	short loc_40E18D
; ---------------------------------------------------------------------------

loc_40E152:				; CODE XREF: .text:0040E191j
		mov	dword ptr [esp], 1
		call	sub_40B9F9
		mov	eax, [ebp-34h]
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	edx, [ebp-2Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	assuan_socket_connect
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40E195
		add	dword ptr [ebp-14h], 1

loc_40E18D:				; CODE XREF: .text:0040E150j
		cmp	dword ptr [ebp-14h], 4
		jle	short loc_40E152
		jmp	short loc_40E196
; ---------------------------------------------------------------------------

loc_40E195:				; CODE XREF: .text:0040E187j
		nop

loc_40E196:				; CODE XREF: .text:0040E0B0j
					; .text:0040E0DAj ...
		lea	eax, [ebp-4Ch]
		mov	[esp], eax
		call	sub_40DDBD
		jmp	loc_40E278
; ---------------------------------------------------------------------------

loc_40E1A6:				; CODE XREF: .text:0040E071j
					; .text:0040E07Cj
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_40E1CA
		mov	eax, [ebp+14h]
		mov	[ebp-18h], eax
		jmp	short loc_40E1CE
; ---------------------------------------------------------------------------

loc_40E1CA:				; CODE XREF: .text:0040E1C0j
		add	dword ptr [ebp-18h], 1

loc_40E1CE:				; CODE XREF: .text:0040E1C8j
		mov	eax, [ebp-18h]
		mov	[ebp-40h], eax
		mov	dword ptr [ebp-3Ch], offset aServer ; "--server"
		mov	dword ptr [ebp-38h], 0
		mov	dword ptr [ebp-1Ch], 0
		call	sub_41A229
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40E20D
		call	sub_41A229
		mov	[esp], eax
		call	sub_40D9C4
		mov	edx, eax
		mov	eax, [ebp-1Ch]
		mov	[ebp+eax*4-58h], edx
		add	dword ptr [ebp-1Ch], 1

loc_40E20D:				; CODE XREF: .text:0040E1F1j
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp], eax
		call	_fileno
		mov	[esp], eax
		call	sub_40D9C4
		mov	edx, eax
		mov	eax, [ebp-1Ch]
		mov	[ebp+eax*4-58h], edx
		add	dword ptr [ebp-1Ch], 1
		mov	eax, [ebp-1Ch]
		mov	dword ptr [ebp+eax*4-58h], 0FFFFFFFFh
		mov	eax, [ebp-34h]
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 0
		lea	edx, [ebp-58h]
		mov	[esp+0Ch], edx
		lea	edx, [ebp-40h]
		mov	[esp+8], edx
		mov	edx, [ebp+14h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	assuan_pipe_connect
		mov	[ebp-0Ch], eax

loc_40E278:				; CODE XREF: .text:0040DEE2j
					; .text:0040E1A1j
		mov	eax, [ebp-2Ch]
		mov	[esp], eax
		call	sub_406E5D
		jmp	loc_40E3DB
; ---------------------------------------------------------------------------

loc_40E288:				; CODE XREF: .text:0040DE95j
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_406E03
		mov	[ebp-20h], eax
		mov	dword ptr [esp+4], 3Bh
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	strchr
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_40E2BA
		mov	eax, [ebp-10h]
		cmp	eax, [ebp-20h]
		jnz	short loc_40E2E8

loc_40E2BA:				; CODE XREF: .text:0040E2B0j
		mov	dword ptr [esp], offset	aMalformedGpg_0	; "malformed GPG_AGENT_INFO environment	va"...
		call	sub_419D7C
		mov	[esp], eax
		call	sub_41A665
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_406E5D
		mov	ds:dword_428A24, 1
		jmp	loc_40DE68
; ---------------------------------------------------------------------------

loc_40E2E8:				; CODE XREF: .text:0040E2B8j
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-10h], 1
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	atoi
		mov	[ebp-24h], eax
		jmp	short loc_40E306
; ---------------------------------------------------------------------------

loc_40E302:				; CODE XREF: .text:0040E318j
		add	dword ptr [ebp-10h], 1

loc_40E306:				; CODE XREF: .text:0040E300j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40E31A
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Bh
		jnz	short loc_40E302

loc_40E31A:				; CODE XREF: .text:0040E30Ej
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40E334
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[esp], eax
		call	atoi
		jmp	short loc_40E339
; ---------------------------------------------------------------------------

loc_40E334:				; CODE XREF: .text:0040E322j
		mov	eax, 0

loc_40E339:				; CODE XREF: .text:0040E332j
		mov	[ebp-28h], eax
		cmp	dword ptr [ebp-28h], 1
		jz	short loc_40E377
		mov	dword ptr [esp], offset	aGpgAgentProt_0	; "gpg-agent protocol version %d is not	su"...
		call	sub_419D7C
		mov	edx, [ebp-28h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_41A665
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_406E5D
		mov	ds:dword_428A24, 1
		jmp	loc_40DE68
; ---------------------------------------------------------------------------

loc_40E377:				; CODE XREF: .text:0040E340j
		mov	eax, [ebp-34h]
		mov	dword ptr [esp+0Ch], 0
		mov	edx, [ebp-24h]
		mov	[esp+8], edx
		mov	edx, [ebp-20h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	assuan_socket_connect
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_406E5D
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_40D9A2
		cmp	eax, 103h
		jnz	short loc_40E3DB
		mov	dword ptr [esp], offset	aCanTConnectT_0	; "can't connect to the agent - trying fal"...
		call	sub_419D7C
		mov	[esp], eax
		call	sub_41A63B
		mov	ds:dword_428A24, 1
		jmp	loc_40DE68
; ---------------------------------------------------------------------------

loc_40E3DB:				; CODE XREF: .text:0040E283j
					; .text:0040E3B6j
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40E418
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	gpg_strerror
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aCanTConnectT_1	; "can't connect to the agent: %s\n"
		call	sub_41A665
		mov	eax, [ebp-34h]
		mov	[esp], eax
		call	assuan_release
		mov	dword ptr [esp], 4Dh
		call	sub_40D987
		jmp	locret_40E4C3
; ---------------------------------------------------------------------------

loc_40E418:				; CODE XREF: .text:0040E3DFj
		cmp	dword ptr [ebp+28h], 0
		jz	short loc_40E42A
		mov	dword ptr [esp], offset	aConnectionTo_0	; "connection to agent established\n"
		call	sub_41A702

loc_40E42A:				; CODE XREF: .text:0040E41Cj
		mov	eax, [ebp-34h]
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], offset aReset_0 ; "RESET"
		mov	[esp], eax
		call	assuan_transact
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40E4A0
		mov	eax, [ebp-34h]
		mov	edx, [ebp+20h]
		mov	[esp+10h], edx
		mov	edx, [ebp+1Ch]
		mov	[esp+0Ch], edx
		mov	edx, [ebp+18h]
		mov	[esp+8], edx
		mov	edx, [ebp+0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_40DAA2
		mov	[ebp-0Ch], eax

loc_40E4A0:				; CODE XREF: .text:0040E474j
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40E4B6
		mov	eax, [ebp-34h]
		mov	[esp], eax
		call	assuan_release
		mov	eax, [ebp-0Ch]
		jmp	short locret_40E4C3
; ---------------------------------------------------------------------------

loc_40E4B6:				; CODE XREF: .text:0040E4A4j
		mov	edx, [ebp-34h]
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	eax, 0

locret_40E4C3:				; CODE XREF: .text:0040DE63j
					; .text:0040DF91j ...
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E4C8	proc near		; CODE XREF: sub_40E53A+32p
					; sub_40E53A+82p ...
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_40E4C8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E4CD	proc near		; CODE XREF: .text:004118A5p
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_40E4CD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40E4D7(size_t)
sub_40E4D7	proc near		; CODE XREF: sub_40E4F4+12p
					; sub_40E53A+Dp ...

Size		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_40E4E7
		add	[ebp+arg_0], 1

loc_40E4E7:				; CODE XREF: sub_40E4D7+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Size],	eax ; Size
		call	malloc
		leave
		retn
sub_40E4D7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40E4F4(void *, size_t)
sub_40E4F4	proc near		; CODE XREF: .text:004122F7p
					; .text:00412523p
					; DATA XREF: ...

Memory		= dword	ptr -18h
NewSize		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_40E50D
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+Memory], eax ;	size_t
		call	sub_40E4D7
		jmp	short locret_40E51F
; ---------------------------------------------------------------------------

loc_40E50D:				; CODE XREF: sub_40E4F4+Aj
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+NewSize], eax ; NewSize
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	realloc

locret_40E51F:				; CODE XREF: sub_40E4F4+17j
		leave
		retn
sub_40E4F4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40E521(void *)
sub_40E521	proc near		; CODE XREF: sub_40E5CD+5Ap
					; sub_40ED64+29p ...

Memory		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_40E538
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

locret_40E538:				; CODE XREF: sub_40E521+Aj
		leave
		retn
sub_40E521	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E53A	proc near		; CODE XREF: sub_40F918+E7p

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 0Ch ;	size_t
		call	sub_40E4D7
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40E55E
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_40E5C8
; ---------------------------------------------------------------------------

loc_40E55E:				; CODE XREF: sub_40E53A+19j
		cmp	[ebp+arg_4], 0
		jnz	short loc_40E571
		mov	eax, ds:dword_428A2C
		mov	[esp+28h+var_28], eax
		call	sub_40E4C8

loc_40E571:				; CODE XREF: sub_40E53A+28j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_0]
		mov	[eax], edx
		mov	edx, ds:dword_428A28
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+8], offset dword_428A28
		mov	eax, ds:dword_428A28
		test	eax, eax
		jz	short loc_40E5A6
		mov	eax, ds:dword_428A28
		mov	edx, [ebp+var_10]
		add	edx, 4
		mov	[eax+8], edx

loc_40E5A6:				; CODE XREF: sub_40E53A+5Cj
		mov	eax, [ebp+var_10]
		mov	ds:dword_428A28, eax
		cmp	[ebp+arg_4], 0
		jnz	short loc_40E5C1
		mov	eax, ds:dword_428A2C
		mov	[esp+28h+var_28], eax
		call	sub_40E4C8

loc_40E5C1:				; CODE XREF: sub_40E53A+78j
		mov	[ebp+var_C], 0

loc_40E5C8:				; CODE XREF: sub_40E53A+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40E53A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E5CD	proc near		; CODE XREF: sub_40FA3F+20p

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 0
		jnz	short loc_40E5E6
		mov	eax, ds:dword_428A2C
		mov	[esp+28h+var_28], eax
		call	sub_40E4C8

loc_40E5E6:				; CODE XREF: sub_40E5CD+Aj
		mov	eax, ds:dword_428A28
		mov	[ebp+var_C], eax
		jmp	short loc_40E637
; ---------------------------------------------------------------------------

loc_40E5F0:				; CODE XREF: sub_40E5CD+6Ej
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_40E62E
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		mov	edx, [edx+4]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40E621
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		mov	edx, [edx+8]
		mov	[eax+8], edx

loc_40E621:				; CODE XREF: sub_40E5CD+43j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40E521
		jmp	short loc_40E63D
; ---------------------------------------------------------------------------

loc_40E62E:				; CODE XREF: sub_40E5CD+2Bj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[ebp+var_C], eax

loc_40E637:				; CODE XREF: sub_40E5CD+21j
		cmp	[ebp+var_C], 0
		jnz	short loc_40E5F0

loc_40E63D:				; CODE XREF: sub_40E5CD+5Fj
		cmp	[ebp+arg_4], 0
		jnz	short locret_40E650
		mov	eax, ds:dword_428A2C
		mov	[esp+28h+var_28], eax
		call	sub_40E4C8

locret_40E650:				; CODE XREF: sub_40E5CD+74j
		leave
		retn
sub_40E5CD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E652	proc near		; CODE XREF: sub_411A6A+4Bp

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, ds:dword_428A2C
		mov	[esp+28h+var_28], eax
		call	sub_40E4C8
		mov	eax, ds:dword_428A28
		mov	[ebp+var_C], eax
		jmp	short loc_40E68F
; ---------------------------------------------------------------------------

loc_40E676:				; CODE XREF: sub_40E652+41j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+arg_0]
		call	eax
		or	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[ebp+var_C], eax

loc_40E68F:				; CODE XREF: sub_40E652+22j
		cmp	[ebp+var_C], 0
		jnz	short loc_40E676
		mov	eax, ds:dword_428A2C
		mov	[esp+28h+var_28], eax
		call	sub_40E4C8
		mov	eax, [ebp+var_10]
		leave
		retn
sub_40E652	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40E6A7()
sub_40E6A7	proc near		; DATA XREF: sub_40E6C5+19o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 0
		call	sub_411A6A
		leave
		retn
sub_40E6A7	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E6C5	proc near		; CODE XREF: sub_410B1C+6p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_428A40
		test	eax, eax
		jnz	short loc_40E6EA
		mov	ds:dword_428A40, 1
		mov	[esp+18h+var_18], offset sub_40E6A7 ; _onexit_t
		call	sub_41FB70

loc_40E6EA:				; CODE XREF: sub_40E6C5+Dj
		mov	eax, 0
		leave
		retn
sub_40E6C5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E6F1	proc near		; CODE XREF: sub_410472+69p
					; .text:00410CC6p ...

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 0
		jnz	short loc_40E720
		cmp	[ebp+arg_8], 0
		jnz	short loc_40E709
		cmp	[ebp+arg_C], 0
		jz	short loc_40E720

loc_40E709:				; CODE XREF: sub_40E6F1+10j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_40E7D9
; ---------------------------------------------------------------------------

loc_40E720:				; CODE XREF: sub_40E6F1+Aj
					; sub_40E6F1+16j
		mov	[esp+28h+var_28], 28h ;	size_t
		call	sub_40E4D7
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40E741
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_40E7D6
; ---------------------------------------------------------------------------

loc_40E741:				; CODE XREF: sub_40E6F1+42j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_20]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	[eax+8], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_24]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_10]
		mov	[eax+18h], edx
		cmp	[ebp+arg_14], 0
		setnz	dl
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		and	ecx, 1
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFFEh
		or	edx, ecx
		mov	[eax+1Ch], dl
		cmp	[ebp+arg_18], 0
		jz	short loc_40E7A6
		mov	eax, [ebp+arg_18]
		jmp	short loc_40E7AB
; ---------------------------------------------------------------------------

loc_40E7A6:				; CODE XREF: sub_40E6F1+AEj
		mov	eax, offset sub_40E4F4

loc_40E7AB:				; CODE XREF: sub_40E6F1+B3j
		mov	edx, [ebp+var_10]
		mov	[edx+20h], eax
		cmp	[ebp+arg_1C], 0
		jz	short loc_40E7BC
		mov	eax, [ebp+arg_1C]
		jmp	short loc_40E7C1
; ---------------------------------------------------------------------------

loc_40E7BC:				; CODE XREF: sub_40E6F1+C4j
		mov	eax, offset sub_40E521

loc_40E7C1:				; CODE XREF: sub_40E6F1+C9j
		mov	edx, [ebp+var_10]
		mov	[edx+24h], eax
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_40E7D6:				; CODE XREF: sub_40E6F1+4Bj
		mov	eax, [ebp+var_C]

locret_40E7D9:				; CODE XREF: sub_40E6F1+2Aj
		leave
		retn
sub_40E6F1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40E7DB(int, void *, size_t)
sub_40E7DB	proc near		; DATA XREF: .data:off_422140o

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+arg_8]
		jnb	short loc_40E813
		mov	eax, [ebp+var_C]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+arg_8], eax

loc_40E813:				; CODE XREF: sub_40E7DB+21j
		cmp	[ebp+arg_8], 0
		jz	short loc_40E850
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		add	edx, eax
		mov	eax, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+10h], edx

loc_40E850:				; CODE XREF: sub_40E7DB+3Cj
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		leave
		retn
sub_40E7DB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40E85B(int, void *, size_t)
sub_40E85B	proc near		; DATA XREF: .data:off_422144o

Dst		= dword	ptr -48h
Src		= dword	ptr -44h
Size		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+arg_8], 0
		jnz	short loc_40E878
		mov	eax, 0
		jmp	loc_40EAD9
; ---------------------------------------------------------------------------

loc_40E878:				; CODE XREF: sub_40E85B+11j
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		and	eax, 8
		test	eax, eax
		jz	short loc_40E890
		mov	eax, [ebp+var_10]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	[eax+10h], edx

loc_40E890:				; CODE XREF: sub_40E85B+27j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	edx, eax
		jnb	short loc_40E8BC
		mov	[esp+48h+Size],	283h ; int
		mov	[esp+48h+Src], offset a____Gnupg22__2 ;	"../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+48h+Dst], offset aMem_cookieMemo ;	"mem_cookie->memory_size >= mem_cookie->"...
		call	sub_421040

loc_40E8BC:				; CODE XREF: sub_40E85B+43j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 1
		test	al, al
		jnz	short loc_40E8ED
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_14]
		jbe	short loc_40E8ED
		mov	eax, [ebp+var_14]
		mov	[ebp+arg_8], eax

loc_40E8ED:				; CODE XREF: sub_40E85B+82j
					; sub_40E85B+8Aj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_14]
		jbe	loc_40EA73
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_40E90B
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		jmp	short loc_40E922
; ---------------------------------------------------------------------------

loc_40E90B:				; CODE XREF: sub_40E85B+A6j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_14]
		mov	ecx, [ebp+arg_8]
		mov	ebx, ecx
		sub	ebx, edx
		mov	edx, ebx
		add	eax, edx
		mov	[ebp+var_C], eax

loc_40E922:				; CODE XREF: sub_40E85B+AEj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	eax, [ebp+var_C]
		jbe	short loc_40E944
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	loc_40EAD9
; ---------------------------------------------------------------------------

loc_40E944:				; CODE XREF: sub_40E85B+D0j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	short loc_40E9A5
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		add	eax, [ebp+var_C]
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	eax, [ebp+var_C]
		jbe	short loc_40E97F
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	loc_40EAD9
; ---------------------------------------------------------------------------

loc_40E97F:				; CODE XREF: sub_40E85B+10Bj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_C]
		mov	edx, 0
		div	[ebp+var_2C]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_C]
		imul	eax, edx
		mov	[ebp+var_C], eax

loc_40E9A5:				; CODE XREF: sub_40E85B+F1j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_40E9D1
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_C]
		jnb	short loc_40E9D1
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Ch
		mov	eax, 0FFFFFFFFh
		jmp	loc_40EAD9
; ---------------------------------------------------------------------------

loc_40E9D1:				; CODE XREF: sub_40E85B+152j
					; sub_40E85B+15Dj
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		mov	[esp+48h+Src], edx
		mov	[esp+48h+Dst], eax
		call	ecx
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_40E9FC
		mov	eax, 0FFFFFFFFh
		jmp	loc_40EAD9
; ---------------------------------------------------------------------------

loc_40E9FC:				; CODE XREF: sub_40E85B+195j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	edx, eax
		jnb	short loc_40EA3A
		mov	[esp+48h+Size],	2B6h ; int
		mov	[esp+48h+Src], offset a____Gnupg22__2 ;	"../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+48h+Dst], offset aMem_cookieMemo ;	"mem_cookie->memory_size >= mem_cookie->"...
		call	sub_421040

loc_40EA3A:				; CODE XREF: sub_40E85B+1C1j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_14]
		jbe	short loc_40EA73
		mov	[esp+48h+Size],	2B9h ; int
		mov	[esp+48h+Src], offset a____Gnupg22__2 ;	"../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+48h+Dst], offset aSizeNleft ; "size <= nleft"
		call	sub_421040

loc_40EA73:				; CODE XREF: sub_40E85B+98j
					; sub_40E85B+1FAj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		add	eax, edx
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+14h]
		cmp	edx, eax
		jbe	short loc_40EABF
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_10]
		mov	[eax+14h], edx

loc_40EABF:				; CODE XREF: sub_40E85B+251j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_10]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]

loc_40EAD9:				; CODE XREF: sub_40E85B+18j
					; sub_40E85B+E4j ...
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_40E85B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EADF	proc near		; DATA XREF: .data:off_422148o

Dst		= dword	ptr -48h
Val		= dword	ptr -44h
Size		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_8]
		cmp	eax, 1
		jz	short loc_40EB0C
		cmp	eax, 2
		jz	short loc_40EB35
		test	eax, eax
		jnz	short loc_40EB5E
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_40EB75
; ---------------------------------------------------------------------------

loc_40EB0C:				; CODE XREF: sub_40EADF+12j
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+10h]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_14]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_40EB75
; ---------------------------------------------------------------------------

loc_40EB35:				; CODE XREF: sub_40EADF+17j
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+14h]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_14]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_40EB75
; ---------------------------------------------------------------------------

loc_40EB5E:				; CODE XREF: sub_40EADF+1Bj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_40ECFA
; ---------------------------------------------------------------------------

loc_40EB75:				; CODE XREF: sub_40EADF+2Bj
					; sub_40EADF+54j ...
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jg	loc_40EC8A
		cmp	edx, [ebp+var_C]
		jl	short loc_40EB97
		cmp	eax, [ebp+var_10]
		jnb	loc_40EC8A

loc_40EB97:				; CODE XREF: sub_40EADF+ADj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 1
		test	al, al
		jnz	short loc_40EBBC
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Ch
		mov	eax, 0FFFFFFFFh
		jmp	locret_40ECFA
; ---------------------------------------------------------------------------

loc_40EBBC:				; CODE XREF: sub_40EADF+C4j
		mov	eax, [ebp+var_14]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		add	eax, edx
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jg	short loc_40EBFB
		cmp	edx, [ebp+var_C]
		jl	short loc_40EBE4
		cmp	eax, [ebp+var_10]
		jnb	short loc_40EBFB

loc_40EBE4:				; CODE XREF: sub_40EADF+FEj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_40ECFA
; ---------------------------------------------------------------------------

loc_40EBFB:				; CODE XREF: sub_40EADF+F9j
					; sub_40EADF+103j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_18]
		mov	edx, 0
		div	[ebp+var_2C]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_18]
		imul	eax, edx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_40EC4D
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_18]
		jnb	short loc_40EC4D
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Ch
		mov	eax, 0FFFFFFFFh
		jmp	locret_40ECFA
; ---------------------------------------------------------------------------

loc_40EC4D:				; CODE XREF: sub_40EADF+14Aj
					; sub_40EADF+155j
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_18]
		mov	[esp+48h+Val], edx
		mov	[esp+48h+Dst], eax
		call	ecx
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_40EC78
		mov	eax, 0FFFFFFFFh
		jmp	locret_40ECFA
; ---------------------------------------------------------------------------

loc_40EC78:				; CODE XREF: sub_40EADF+18Dj
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_1C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_18]
		mov	[eax+8], edx

loc_40EC8A:				; CODE XREF: sub_40EADF+A4j
					; sub_40EADF+B2j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jg	short loc_40ECDE
		cmp	edx, [ebp+var_C]
		jl	short loc_40ECA4
		cmp	eax, [ebp+var_10]
		jnb	short loc_40ECDE

loc_40ECA4:				; CODE XREF: sub_40EADF+1BEj
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_14]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		add	eax, edx
		mov	edx, ecx
		mov	[esp+48h+Size],	edx ; Size
		mov	[esp+48h+Val], 0 ; Val
		mov	[esp+48h+Dst], eax ; Dst
		call	memset
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	[eax+14h], edx

loc_40ECDE:				; CODE XREF: sub_40EADF+1B9j
					; sub_40EADF+1C3j
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	[eax+10h], edx
		mov	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	eax, 0

locret_40ECFA:				; CODE XREF: sub_40EADF+91j
					; sub_40EADF+D8j ...
		leave
		retn
sub_40EADF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40ECFC	proc near		; DATA XREF: sub_410D54+109o

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+arg_4], 1
		jnz	short loc_40ED4B
		mov	eax, [ebp+var_10]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [eax+10h]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+10h], 0
		mov	[ebp+var_C], 0
		jmp	short loc_40ED5F
; ---------------------------------------------------------------------------

loc_40ED4B:				; CODE XREF: sub_40ECFC+10j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	[ebp+var_C], 0FFFFFFFFh

loc_40ED5F:				; CODE XREF: sub_40ECFC+4Dj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40ECFC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40ED64	proc near		; CODE XREF: sub_410472+33Fp
					; .text:00410D4Dp ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_40ED92
		mov	eax, [ebp+var_C]
		mov	edx, [eax+24h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+28h+var_28], eax
		call	edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40E521

loc_40ED92:				; CODE XREF: sub_40ED64+10j
		mov	eax, 0
		leave
		retn
sub_40ED64	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40ED99	proc near		; CODE XREF: sub_410FD8+55p
					; .text:00412A4Fp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 8 ; size_t
		call	sub_40E4D7
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40EDBD
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_40EDFC
; ---------------------------------------------------------------------------

loc_40EDBD:				; CODE XREF: sub_40ED99+19j
		mov	eax, [ebp+arg_8]
		and	eax, 8000h
		test	eax, eax
		jz	short loc_40EDDC
		mov	[esp+28h+var_24], 8000h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	_setmode

loc_40EDDC:				; CODE XREF: sub_40ED99+2Ej
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_40EDFC:				; CODE XREF: sub_40ED99+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40ED99	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EE01	proc near		; DATA XREF: .data:off_422150o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40EE20
		mov	[ebp+var_C], 0
		jmp	short loc_40EE52
; ---------------------------------------------------------------------------

loc_40EE20:				; CODE XREF: sub_40EE01+14j
					; sub_40EE01+4Fj
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	_read
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_40EE52
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_40EE20

loc_40EE52:				; CODE XREF: sub_40EE01+1Dj
					; sub_40EE01+41j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40EE01	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EE57	proc near		; DATA XREF: .data:off_422154o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40EE75
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		jmp	short loc_40EEA7
; ---------------------------------------------------------------------------

loc_40EE75:				; CODE XREF: sub_40EE57+14j
					; sub_40EE57+4Ej
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	_write
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_40EEA7
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_40EE75

loc_40EEA7:				; CODE XREF: sub_40EE57+1Cj
					; sub_40EE57+40j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40EE57	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EEAC	proc near		; DATA XREF: .data:off_422158o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40EED9
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Dh
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_40EF35
; ---------------------------------------------------------------------------

loc_40EED9:				; CODE XREF: sub_40EEAC+15j
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	ecx, [ecx]
		mov	ebx, [ebp+arg_8]
		mov	[esp+28h+var_1C], ebx
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_28], ecx
		call	j__lseeki64
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_14]
		mov	edx, eax
		xor	edx, 0FFFFFFFFh
		mov	eax, [ebp+var_18]
		xor	eax, 0FFFFFFFFh
		or	eax, edx
		test	eax, eax
		jnz	short loc_40EF20
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_40EF35
; ---------------------------------------------------------------------------

loc_40EF20:				; CODE XREF: sub_40EEAC+69j
		mov	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	[ebp+var_C], 0

loc_40EF35:				; CODE XREF: sub_40EEAC+2Bj
					; sub_40EEAC+72j
		mov	eax, [ebp+var_C]
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_40EEAC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EF3E	proc near		; CODE XREF: .text:00410C3Ep
					; sub_410FD8+DAp ...

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40EF91
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40EF63
		mov	[ebp+var_C], 0
		jmp	short loc_40EF84
; ---------------------------------------------------------------------------

loc_40EF63:				; CODE XREF: sub_40EF3E+1Aj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_40EF7C
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		call	_close
		jmp	short loc_40EF81
; ---------------------------------------------------------------------------

loc_40EF7C:				; CODE XREF: sub_40EF3E+2Dj
		mov	eax, 0

loc_40EF81:				; CODE XREF: sub_40EF3E+3Cj
		mov	[ebp+var_C], eax

loc_40EF84:				; CODE XREF: sub_40EF3E+23j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40E521
		jmp	short loc_40EF98
; ---------------------------------------------------------------------------

loc_40EF91:				; CODE XREF: sub_40EF3E+10j
		mov	[ebp+var_C], 0

loc_40EF98:				; CODE XREF: sub_40EF3E+51j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40EF3E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40EF9D(int, FILE *, int, int)
sub_40EF9D	proc near		; CODE XREF: sub_41110D+67p

File		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+File],	8 ; size_t
		call	sub_40E4D7
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40EFC1
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_40F008
; ---------------------------------------------------------------------------

loc_40EFC1:				; CODE XREF: sub_40EF9D+19j
		mov	eax, [ebp+arg_8]
		and	eax, 8000h
		test	eax, eax
		jz	short loc_40EFE8
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+File],	eax ; File
		call	_fileno
		mov	[esp+28h+var_24], 8000h
		mov	[esp+28h+File],	eax
		call	_setmode

loc_40EFE8:				; CODE XREF: sub_40EF9D+2Ej
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_40F008:				; CODE XREF: sub_40EF9D+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40EF9D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40F00D(int, void *, size_t)
sub_40F00D	proc near		; DATA XREF: .data:off_422160o

DstBuf		= dword	ptr -28h
ElementSize	= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40F04A
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Count], eax ; Count
		mov	[esp+28h+ElementSize], 1 ; ElementSize
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+DstBuf], eax ;	DstBuf
		call	fread
		mov	[ebp+var_C], eax
		jmp	short loc_40F051
; ---------------------------------------------------------------------------

loc_40F04A:				; CODE XREF: sub_40F00D+13j
		mov	[ebp+var_C], 0

loc_40F051:				; CODE XREF: sub_40F00D+3Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_40F06F
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+DstBuf], eax ;	File
		call	ferror
		test	eax, eax
		jz	short loc_40F06F
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40F072
; ---------------------------------------------------------------------------

loc_40F06F:				; CODE XREF: sub_40F00D+48j
					; sub_40F00D+59j
		mov	eax, [ebp+var_C]

locret_40F072:				; CODE XREF: sub_40F00D+60j
		leave
		retn
sub_40F00D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40F074(int, void *, size_t)
sub_40F074	proc near		; DATA XREF: .data:off_422164o

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40F0B1
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Count], eax ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		mov	[ebp+var_C], eax
		jmp	short loc_40F0B7
; ---------------------------------------------------------------------------

loc_40F0B1:				; CODE XREF: sub_40F074+13j
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax

loc_40F0B7:				; CODE XREF: sub_40F074+3Bj
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jz	short loc_40F0C6
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40F0C9
; ---------------------------------------------------------------------------

loc_40F0C6:				; CODE XREF: sub_40F074+49j
		mov	eax, [ebp+var_C]

locret_40F0C9:				; CODE XREF: sub_40F074+50j
		leave
		retn
sub_40F074	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F0CB	proc near		; DATA XREF: .data:off_422168o

File		= dword	ptr -28h
Offset		= dword	ptr -24h
Origin		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40F0F4
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Dh
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40F153
; ---------------------------------------------------------------------------

loc_40F0F4:				; CODE XREF: sub_40F0CB+13j
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Origin], ecx ;	Origin
		mov	[esp+28h+Offset], edx ;	Offset
		mov	[esp+28h+File],	eax ; File
		call	fseek
		test	eax, eax
		jz	short loc_40F121
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40F153
; ---------------------------------------------------------------------------

loc_40F121:				; CODE XREF: sub_40F0CB+4Dj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		call	ftell
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_40F13E
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40F153
; ---------------------------------------------------------------------------

loc_40F13E:				; CODE XREF: sub_40F0CB+6Aj
		mov	eax, [ebp+var_10]
		mov	edx, eax
		sar	edx, 1Fh
		mov	ecx, [ebp+arg_4]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	eax, 0

locret_40F153:				; CODE XREF: sub_40F0CB+27j
					; sub_40F0CB+54j ...
		leave
		retn
sub_40F0CB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F155	proc near		; CODE XREF: sub_41110D+101p
					; DATA XREF: .data:off_42216Co

File		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40F1B4
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40F1A0
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		call	fflush
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_40F196
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		call	fclose
		jmp	short loc_40F19B
; ---------------------------------------------------------------------------

loc_40F196:				; CODE XREF: sub_40F155+30j
		mov	eax, 0

loc_40F19B:				; CODE XREF: sub_40F155+3Fj
		mov	[ebp+var_C], eax
		jmp	short loc_40F1A7
; ---------------------------------------------------------------------------

loc_40F1A0:				; CODE XREF: sub_40F155+19j
		mov	[ebp+var_C], 0

loc_40F1A7:				; CODE XREF: sub_40F155+49j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+File],	eax ; void *
		call	sub_40E521
		jmp	short loc_40F1BB
; ---------------------------------------------------------------------------

loc_40F1B4:				; CODE XREF: sub_40F155+10j
		mov	[ebp+var_C], 0

loc_40F1BB:				; CODE XREF: sub_40F155+5Dj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40F155	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F1C0	proc near		; CODE XREF: .text:00410B84p
					; .text:0041163Dp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0FFFFFFFFh
		mov	[esp+28h+var_28], 8 ; size_t
		call	sub_40E4D7
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40F1F2
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_40F25F
; ---------------------------------------------------------------------------

loc_40F1F2:				; CODE XREF: sub_40F1C0+27j
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_20], 180h
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_28], eax
		call	_open
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_40F21E
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_40F25F
; ---------------------------------------------------------------------------

loc_40F21E:				; CODE XREF: sub_40F1C0+53j
		mov	eax, [ebp+arg_C]
		and	eax, 8000h
		test	eax, eax
		jz	short loc_40F23D
		mov	[esp+28h+var_24], 8000h
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	_setmode

loc_40F23D:				; CODE XREF: sub_40F1C0+68j
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_40F25F:				; CODE XREF: sub_40F1C0+30j
					; sub_40F1C0+5Cj
		cmp	[ebp+var_C], 0
		jz	short loc_40F270
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40E521

loc_40F270:				; CODE XREF: sub_40F1C0+A3j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40F1C0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F275	proc near		; CODE XREF: .text:00410B57p
					; .text:00410C6Dp ...

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	eax, 72h
		jz	short loc_40F295
		cmp	eax, 77h
		jz	short loc_40F2A5
		cmp	eax, 61h
		jz	short loc_40F2B5
		jmp	short loc_40F2C5
; ---------------------------------------------------------------------------

loc_40F295:				; CODE XREF: sub_40F275+12j
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	short loc_40F2D9
; ---------------------------------------------------------------------------

loc_40F2A5:				; CODE XREF: sub_40F275+17j
		mov	[ebp+var_C], 1
		mov	[ebp+var_10], 300h
		jmp	short loc_40F2D9
; ---------------------------------------------------------------------------

loc_40F2B5:				; CODE XREF: sub_40F275+1Cj
		mov	[ebp+var_C], 1
		mov	[ebp+var_10], 108h
		jmp	short loc_40F2D9
; ---------------------------------------------------------------------------

loc_40F2C5:				; CODE XREF: sub_40F275+1Ej
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40F333
; ---------------------------------------------------------------------------

loc_40F2D9:				; CODE XREF: sub_40F275+2Ej
					; sub_40F275+3Ej ...
		add	[ebp+arg_0], 1
		jmp	short loc_40F317
; ---------------------------------------------------------------------------

loc_40F2DF:				; CODE XREF: sub_40F275+AAj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	eax, 62h
		jz	short loc_40F300
		cmp	eax, 78h
		jz	short loc_40F309
		cmp	eax, 2Bh
		jnz	short loc_40F312
		mov	[ebp+var_C], 2
		jmp	short loc_40F313
; ---------------------------------------------------------------------------

loc_40F300:				; CODE XREF: sub_40F275+76j
		or	[ebp+var_10], 8000h
		jmp	short loc_40F313
; ---------------------------------------------------------------------------

loc_40F309:				; CODE XREF: sub_40F275+7Bj
		or	[ebp+var_10], 400h
		jmp	short loc_40F313
; ---------------------------------------------------------------------------

loc_40F312:				; CODE XREF: sub_40F275+80j
		nop

loc_40F313:				; CODE XREF: sub_40F275+89j
					; sub_40F275+92j ...
		add	[ebp+arg_0], 1

loc_40F317:				; CODE XREF: sub_40F275+68j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40F2DF
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, 0

locret_40F333:				; CODE XREF: sub_40F275+62j
		leave
		retn
sub_40F275	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F335	proc near		; CODE XREF: sub_40FB50+2Fp
					; sub_410388+4Bp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+230h]
		test	eax, eax
		jnz	short loc_40F36A
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 28h
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_40F3C6
; ---------------------------------------------------------------------------

loc_40F36A:				; CODE XREF: sub_40F335+1Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+230h]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_40F3B9
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_40F3C6
; ---------------------------------------------------------------------------

loc_40F3B9:				; CODE XREF: sub_40F335+72j
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0

loc_40F3C6:				; CODE XREF: sub_40F335+33j
					; sub_40F335+82j
		cmp	[ebp+var_10], 0
		jz	short loc_40F3E4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl
		jmp	short loc_40F400
; ---------------------------------------------------------------------------

loc_40F3E4:				; CODE XREF: sub_40F335+95j
		cmp	[ebp+var_C], 0
		jnz	short loc_40F400
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 2
		mov	[eax+24Ch], dl

loc_40F400:				; CODE XREF: sub_40F335+ADj
					; sub_40F335+B3j
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_10]
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_40F335	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F450	proc near		; CODE XREF: sub_40F814+7Cp
					; sub_40FC67+35p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 30h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+234h]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_40F491
		mov	[esp+38h+var_30], 4F3h ; int
		mov	[esp+38h+var_34], offset a____Gnupg22__2 ; "../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+38h+var_38], offset aStreamFlags_wr ; "stream->flags.writing"
		call	sub_421040

loc_40F491:				; CODE XREF: sub_40F450+23j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_40F5BC
		cmp	[ebp+var_18], 0
		jnz	short loc_40F4B1
		mov	[ebp+var_C], 28h
		jmp	loc_40F5C3
; ---------------------------------------------------------------------------

loc_40F4B1:				; CODE XREF: sub_40F450+53j
		mov	[ebp+var_14], 0
		mov	[ebp+var_C], 0
		jmp	short loc_40F51D
; ---------------------------------------------------------------------------

loc_40F4C1:				; CODE XREF: sub_40F450+DEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	ecx, eax
		sub	ecx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+38h+var_30], ecx
		mov	[esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+var_18]
		call	eax
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jnz	short loc_40F50B
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_40F511
; ---------------------------------------------------------------------------

loc_40F50B:				; CODE XREF: sub_40F450+A9j
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_10], eax

loc_40F511:				; CODE XREF: sub_40F450+B9j
		mov	eax, [ebp+var_10]
		add	[ebp+var_14], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40F532

loc_40F51D:				; CODE XREF: sub_40F450+6Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		sub	eax, [ebp+var_14]
		test	eax, eax
		jle	short loc_40F533
		cmp	[ebp+var_C], 0
		jz	short loc_40F4C1
		jmp	short loc_40F533
; ---------------------------------------------------------------------------

loc_40F532:				; CODE XREF: sub_40F450+CBj
		nop

loc_40F533:				; CODE XREF: sub_40F450+D8j
					; sub_40F450+E0j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_14]
		jnz	short loc_40F5C3
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+var_18]
		call	eax
		jmp	short loc_40F5C3
; ---------------------------------------------------------------------------

loc_40F5BC:				; CODE XREF: sub_40F450+49j
		mov	[ebp+var_C], 0

loc_40F5C3:				; CODE XREF: sub_40F450+5Cj
					; sub_40F450+FDj ...
		cmp	[ebp+var_C], 0
		jz	short loc_40F5DF
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl

loc_40F5DF:				; CODE XREF: sub_40F450+177j
		mov	eax, [ebp+var_C]
		add	esp, 30h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_40F450	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F5E9	proc near		; CODE XREF: sub_40FE5A+116p
					; sub_410940+33p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40F619
		mov	[esp+18h+var_10], 536h ; int
		mov	[esp+18h+var_14], offset a____Gnupg22__2 ; "../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+18h+var_18], offset aStreamFlags__0 ; "!stream->flags.writing"
		call	sub_421040

loc_40F619:				; CODE XREF: sub_40F5E9+12j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		leave
		retn
sub_40F5E9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F639	proc near		; CODE XREF: sub_40F918+D5p
					; .text:00411695p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_4]
		mov	[eax+214h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+218h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+228h], 0
		mov	dword ptr [eax+22Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_C]
		mov	[eax+230h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_10]
		mov	[eax+234h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_14]
		mov	[eax+238h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+23Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_18]
		mov	[eax+240h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+244h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_8]
		mov	[eax+248h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFEFh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+254h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+258h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+25Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFEh
		mov	[eax+24Ch], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+24Ch], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFFDh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFF3h
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFFEh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+220h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFDFh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+arg_1C]
		and	eax, 1
		test	al, al
		jnz	short loc_40F7F6
		mov	eax, [ebp+arg_1C]
		and	eax, 2
		test	eax, eax
		jz	short loc_40F805

loc_40F7F6:				; CODE XREF: sub_40F639+1B1j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		or	edx, 1
		mov	[eax+20h], dl
		jmp	short loc_40F812
; ---------------------------------------------------------------------------

loc_40F805:				; CODE XREF: sub_40F639+1BBj
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_40F812:				; CODE XREF: sub_40F639+1CAj
		pop	ebp
		retn
sub_40F639	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F814	proc near		; CODE XREF: sub_40F918+112p
					; sub_40FA3F+2Bp ...

File		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+25Ch]
		test	eax, eax
		jz	short loc_40F866
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+25Ch]
		mov	[esp+28h+File],	eax ; File
		call	fclose
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+25Ch], 0
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_40F866:				; CODE XREF: sub_40F814+14j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+240h]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40F8AA
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax
		call	sub_40F450
		mov	[ebp+var_18], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40F8AA
		cmp	[ebp+var_18], 0
		jz	short loc_40F8AA
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_40F8AA:				; CODE XREF: sub_40F814+74j
					; sub_40F814+88j ...
		cmp	[ebp+var_14], 0
		jz	short loc_40F8D9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+File],	eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40F8D9
		cmp	[ebp+var_18], 0
		jz	short loc_40F8D9
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_40F8D9:				; CODE XREF: sub_40F814+9Aj
					; sub_40F814+B7j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	[esp+28h+File],	eax ; void *
		call	sub_40E521
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+220h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFDFh
		mov	[eax+250h], dl
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40F814	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F918	proc near		; CODE XREF: sub_410472+C8p
					; .text:00410BE8p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[esp+38h+var_38], 28h ;	size_t
		call	sub_40E4D7
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40F94D
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_40FA18
; ---------------------------------------------------------------------------

loc_40F94D:				; CODE XREF: sub_40F918+27j
		mov	[esp+38h+var_38], 260h ; size_t
		call	sub_40E4D7
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40F96E
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_40FA18
; ---------------------------------------------------------------------------

loc_40F96E:				; CODE XREF: sub_40F918+48j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+4], 200h
		mov	eax, [ebp+var_14]
		lea	edx, [eax+200h]
		mov	eax, [ebp+var_10]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+18h], 10h
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		mov	[eax+24h], edx
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+38h+var_38], eax
		call	sub_40E4C8
		mov	eax, [ebp+arg_1C]
		mov	[esp+38h+var_1C], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+var_24], eax
		mov	eax, [ebp+arg_18]
		mov	[esp+38h+var_20], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_40F639
		mov	eax, [ebp+arg_20]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_40E53A
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40FA17
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_40FA18
; ---------------------------------------------------------------------------

loc_40FA17:				; CODE XREF: sub_40F918+F3j
		nop

loc_40FA18:				; CODE XREF: sub_40F918+30j
					; sub_40F918+51j ...
		cmp	[ebp+var_C], 0
		jz	short loc_40FA3A
		cmp	[ebp+var_10], 0
		jz	short loc_40FA3A
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_40F814
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax ;	void *
		call	sub_40E521

loc_40FA3A:				; CODE XREF: sub_40F918+104j
					; sub_40F918+10Aj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40F918	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40FA3F(void *, int)
sub_40FA3F	proc near		; CODE XREF: sub_410472+32Bp
					; .text:004116C5p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_0], 0
		jz	short loc_40FA8B
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40E5CD
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40F814
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40E521
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40E521

loc_40FA8B:				; CODE XREF: sub_40FA3F+11j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40FA3F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40FA90	proc near		; CODE XREF: sub_40FC67+DFp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+230h]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	short loc_40FB03
; ---------------------------------------------------------------------------

loc_40FAB7:				; CODE XREF: sub_40FA90+79j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_40FAF7
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_40FB0E
; ---------------------------------------------------------------------------

loc_40FAF7:				; CODE XREF: sub_40FA90+5Cj
		cmp	[ebp+var_18], 0
		jz	short loc_40FB0D
		mov	eax, [ebp+var_18]
		add	[ebp+var_C], eax

loc_40FB03:				; CODE XREF: sub_40FA90+25j
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jnz	short loc_40FAB7
		jmp	short loc_40FB0E
; ---------------------------------------------------------------------------

loc_40FB0D:				; CODE XREF: sub_40FA90+6Bj
		nop

loc_40FB0E:				; CODE XREF: sub_40FA90+65j
					; sub_40FA90+7Bj
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+var_C]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_40FA90	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40FB50	proc near		; CODE XREF: sub_40FC39+21p
					; sub_40FC67+141p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		jmp	loc_40FC17
; ---------------------------------------------------------------------------

loc_40FB69:				; CODE XREF: sub_40FB50+D3j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_40FB9B
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_40F335
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40FB9B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	loc_40FC2B

loc_40FB9B:				; CODE XREF: sub_40FB50+27j
					; sub_40FB50+3Bj
		cmp	[ebp+var_14], 0
		jnz	short loc_40FC17
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+var_18]
		jbe	short loc_40FBD3
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_40FBD3:				; CODE XREF: sub_40FB50+7Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		add	eax, edx
		mov	edx, ecx
		mov	ecx, [ebp+var_C]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_C]
		add	[ebp+var_10], eax

loc_40FC17:				; CODE XREF: sub_40FB50+14j
					; sub_40FB50+4Fj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_10]
		jz	short loc_40FC2C
		cmp	[ebp+var_14], 0
		jz	loc_40FB69
		jmp	short loc_40FC2C
; ---------------------------------------------------------------------------

loc_40FC2B:				; CODE XREF: sub_40FB50+45j
		nop

loc_40FC2C:				; CODE XREF: sub_40FB50+CDj
					; sub_40FB50+D9j
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		leave
		retn
sub_40FB50	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40FC39	proc near		; CODE XREF: sub_40FC67+110p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40FB50
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40FC39	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40FC67	proc near		; CODE XREF: sub_411CA7+22p
					; sub_411EB1+3Bp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40FCEE
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40F450
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_40FDB2
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl
		jmp	short loc_40FCEE
; ---------------------------------------------------------------------------

loc_40FCBD:				; CODE XREF: sub_40FC67+97j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+14h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		sub	eax, 1
		add	eax, ecx
		movzx	eax, byte ptr [eax]
		mov	[edx], al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_0]
		mov	[eax+1Ch], edx
		add	[ebp+var_C], 1

loc_40FCEE:				; CODE XREF: sub_40FC67+2Dj
					; sub_40FC67+54j
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jz	short loc_40FD00
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_40FCBD

loc_40FD00:				; CODE XREF: sub_40FC67+8Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+244h]
		cmp	eax, 4
		jz	short loc_40FD1F
		cmp	eax, 40h
		jz	short loc_40FD50
		test	eax, eax
		jz	short loc_40FD81
		jmp	loc_40FDB3
; ---------------------------------------------------------------------------

loc_40FD1F:				; CODE XREF: sub_40FC67+A8j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40FA90
		mov	[ebp+var_10], eax
		jmp	short loc_40FDB3
; ---------------------------------------------------------------------------

loc_40FD50:				; CODE XREF: sub_40FC67+ADj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40FC39
		mov	[ebp+var_10], eax
		jmp	short loc_40FDB3
; ---------------------------------------------------------------------------

loc_40FD81:				; CODE XREF: sub_40FC67+B1j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40FB50
		mov	[ebp+var_10], eax
		jmp	short loc_40FDB3
; ---------------------------------------------------------------------------

loc_40FDB2:				; CODE XREF: sub_40FC67+41j
		nop

loc_40FDB3:				; CODE XREF: sub_40FC67+B3j
					; sub_40FC67+E7j ...
		cmp	[ebp+arg_C], 0
		jz	short loc_40FDC6
		mov	eax, [ebp+var_18]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_40FDC6:				; CODE XREF: sub_40FC67+150j
		mov	eax, [ebp+var_10]
		leave
		retn
sub_40FC67	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40FDCB(int, void *, size_t, int)
sub_40FDCB	proc near		; CODE XREF: .text:00411E85p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jbe	short loc_40FDF4
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_8], eax

loc_40FDF4:				; CODE XREF: sub_40FDCB+21j
		cmp	[ebp+arg_8], 0
		jz	short loc_40FE49
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		add	eax, edx
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_0]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+24Ch], dl
		jmp	short loc_40FE4A
; ---------------------------------------------------------------------------

loc_40FE49:				; CODE XREF: sub_40FDCB+2Dj
		nop

loc_40FE4A:				; CODE XREF: sub_40FDCB+7Cj
		cmp	[ebp+arg_C], 0
		jz	short locret_40FE58
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+arg_8]
		mov	[eax], edx

locret_40FE58:				; CODE XREF: sub_40FDCB+83j
		leave
		retn
sub_40FDCB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40FE5A	proc near		; CODE XREF: sub_410248+58p
					; sub_410472+270p ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_40], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+238h]
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_40FE9D
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 28h
		mov	[ebp+var_1C], 0FFFFFFFFh
		jmp	loc_40FFBA
; ---------------------------------------------------------------------------

loc_40FE9D:				; CODE XREF: sub_40FE5A+28j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40FED0
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_40F450
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_40FFB9
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_40FED0:				; CODE XREF: sub_40FE5A+4Fj
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[ebp+var_30], eax
		mov	[ebp+var_2C], edx
		cmp	[ebp+arg_C], 1
		jnz	short loc_40FF2F
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+8]
		mov	ebx, 0
		mov	esi, eax
		mov	edi, edx
		sub	esi, ecx
		sbb	edi, ebx
		mov	ecx, esi
		mov	ebx, edi
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[ebp+var_30], eax
		mov	[ebp+var_2C], edx
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+1Ch]
		mov	ebx, 0
		sub	eax, ecx
		sbb	edx, ebx
		mov	[ebp+var_30], eax
		mov	[ebp+var_2C], edx

loc_40FF2F:				; CODE XREF: sub_40FE5A+86j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	edx, [ebp+arg_C]
		mov	[esp+58h+var_50], edx
		lea	edx, [ebp+var_30]
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+var_20]
		call	eax
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0FFFFFFFFh
		jnz	short loc_40FF63
		mov	[ebp+var_1C], 0FFFFFFFFh
		jmp	short loc_40FFBA
; ---------------------------------------------------------------------------

loc_40FF63:				; CODE XREF: sub_40FE5A+FEj
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_40F5E9
		cmp	[ebp+arg_10], 0
		jz	short loc_40FF89
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	ecx, [ebp+arg_10]
		mov	[ecx], eax
		mov	[ecx+4], edx

loc_40FF89:				; CODE XREF: sub_40FE5A+11Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+24Ch], dl
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+24h]
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	[ecx+228h], eax
		mov	[ecx+22Ch], edx
		jmp	short loc_40FFBA
; ---------------------------------------------------------------------------

loc_40FFB9:				; CODE XREF: sub_40FE5A+63j
		nop

loc_40FFBA:				; CODE XREF: sub_40FE5A+3Ej
					; sub_40FE5A+107j ...
		cmp	[ebp+var_1C], 0
		jz	short loc_40FFD6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl

loc_40FFD6:				; CODE XREF: sub_40FE5A+164j
		mov	eax, [ebp+var_1C]
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40FE5A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40FFE1	proc near		; CODE XREF: sub_410182+79p
					; sub_410248+B6p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+234h]
		mov	[ebp+var_14], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_410010
		cmp	[ebp+var_14], 0
		jnz	short loc_410010
		mov	[ebp+var_10], 28h
		jmp	loc_4100A6
; ---------------------------------------------------------------------------

loc_410010:				; CODE XREF: sub_40FFE1+1Bj
					; sub_40FFE1+21j
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	short loc_410066
; ---------------------------------------------------------------------------

loc_410020:				; CODE XREF: sub_40FFE1+8Bj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_410060
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_41006E
; ---------------------------------------------------------------------------

loc_410060:				; CODE XREF: sub_40FFE1+74j
		mov	eax, [ebp+var_18]
		add	[ebp+var_C], eax

loc_410066:				; CODE XREF: sub_40FFE1+3Dj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jnz	short loc_410020

loc_41006E:				; CODE XREF: sub_40FFE1+7Dj
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+var_C]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_C]
		mov	[eax], edx

loc_4100A6:				; CODE XREF: sub_40FFE1+2Aj
		mov	eax, [ebp+var_10]
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_40FFE1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4100B0	proc near		; CODE XREF: sub_410182+ACp
					; sub_410248+100p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		jmp	loc_410163
; ---------------------------------------------------------------------------

loc_4100C9:				; CODE XREF: sub_4100B0+BFj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnz	short loc_4100E7
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_40F450
		mov	[ebp+var_14], eax

loc_4100E7:				; CODE XREF: sub_4100B0+27j
		cmp	[ebp+var_14], 0
		jnz	short loc_410163
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+var_18]
		jbe	short loc_41011F
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_41011F:				; CODE XREF: sub_4100B0+67j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		lea	ecx, [edx+eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	eax, edx
		mov	edx, ecx
		mov	ecx, [ebp+var_C]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_C]
		add	[ebp+var_10], eax

loc_410163:				; CODE XREF: sub_4100B0+14j
					; sub_4100B0+3Bj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_10]
		jz	short loc_410175
		cmp	[ebp+var_14], 0
		jz	loc_4100C9

loc_410175:				; CODE XREF: sub_4100B0+B9j
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		leave
		retn
sub_4100B0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410182	proc near		; CODE XREF: sub_410248+DBp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+var_24], 0Ah
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_41BE3D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_410203
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40F450
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_410203
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_4]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40FFE1
		mov	[ebp+var_C], eax

loc_410203:				; CODE XREF: sub_410182+3Cj
					; sub_410182+50j
		cmp	[ebp+var_C], 0
		jnz	short loc_410236
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_14]
		add	eax, [ebp+arg_4]
		lea	edx, [ebp+var_18]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4100B0
		mov	[ebp+var_C], eax

loc_410236:				; CODE XREF: sub_410182+85j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		add	edx, eax
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		leave
		retn
sub_410182	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410248	proc near		; CODE XREF: sub_4107EB+2Ep
					; .text:00410ED5p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_4102C7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+238h]
		test	eax, eax
		jz	short loc_4102C7
		mov	[esp+38h+var_28], 0
		mov	[esp+38h+var_2C], 1
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_30], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_40FE5A
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4102C7
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 1Dh
		jnz	loc_410352
		mov	[ebp+var_C], 0

loc_4102C7:				; CODE XREF: sub_410248+20j
					; sub_410248+30j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+244h]
		cmp	eax, 4
		jz	short loc_4102E3
		cmp	eax, 40h
		jz	short loc_410308
		test	eax, eax
		jz	short loc_41032D
		jmp	short loc_410353
; ---------------------------------------------------------------------------

loc_4102E3:				; CODE XREF: sub_410248+8Ej
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_40FFE1
		mov	[ebp+var_C], eax
		jmp	short loc_410353
; ---------------------------------------------------------------------------

loc_410308:				; CODE XREF: sub_410248+93j
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_410182
		mov	[ebp+var_C], eax
		jmp	short loc_410353
; ---------------------------------------------------------------------------

loc_41032D:				; CODE XREF: sub_410248+97j
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_4100B0
		mov	[ebp+var_C], eax
		jmp	short loc_410353
; ---------------------------------------------------------------------------

loc_410352:				; CODE XREF: sub_410248+72j
		nop

loc_410353:				; CODE XREF: sub_410248+99j
					; sub_410248+BEj ...
		cmp	[ebp+arg_C], 0
		jz	short loc_410361
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_410361:				; CODE XREF: sub_410248+10Fj
		mov	eax, [ebp+var_10]
		test	eax, eax
		jz	short loc_410383
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_410383
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		or	edx, 1
		mov	[eax+20h], dl

loc_410383:				; CODE XREF: sub_410248+11Ej
					; sub_410248+12Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_410248	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410388	proc near		; CODE XREF: sub_410472+10Ep

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4103BD
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40F450
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41041B
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_4103BD:				; CODE XREF: sub_410388+12j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_4103E1
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40F335
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41041E

loc_4103E1:				; CODE XREF: sub_410388+43j
		cmp	[ebp+arg_4], 0
		jz	short loc_4103F9
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], edx

loc_4103F9:				; CODE XREF: sub_410388+5Dj
		cmp	[ebp+arg_8], 0
		jz	short loc_410412
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		sub	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_410412:				; CODE XREF: sub_410388+75j
		mov	[ebp+var_C], 0
		jmp	short loc_41041F
; ---------------------------------------------------------------------------

loc_41041B:				; CODE XREF: sub_410388+26j
		nop
		jmp	short loc_41041F
; ---------------------------------------------------------------------------

loc_41041E:				; CODE XREF: sub_410388+57j
		nop

loc_41041F:				; CODE XREF: sub_410388+91j
					; sub_410388+94j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_410388	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410424	proc near		; CODE XREF: sub_410472+1BBp
					; sub_410472+207p

var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jbe	short loc_410455
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_41046D
; ---------------------------------------------------------------------------

loc_410455:				; CODE XREF: sub_410424+19j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	[ebp+var_C], 0

loc_41046D:				; CODE XREF: sub_410424+2Fj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_410424	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410472	proc near		; CODE XREF: .text:004122A3p

Buf		= dword	ptr -68h
Val		= dword	ptr -64h
MaxCount	= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	[ebp+var_14], 0
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		lea	eax, [ebp+var_24]
		mov	[esp+68h+var_44], 0
		mov	[esp+68h+var_48], 2
		mov	[esp+68h+var_4C], offset sub_40E521
		mov	[esp+68h+var_50], offset sub_40E4F4
		mov	[esp+68h+var_54], 1
		mov	[esp+68h+var_58], 200h
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+MaxCount], 0
		mov	[esp+68h+Val], 0
		mov	[esp+68h+Buf], eax
		call	sub_40E6F1
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_41077B
		mov	eax, [ebp+var_24]
		mov	[esp+68h+var_48], 0
		mov	[esp+68h+var_4C], 2
		mov	edx, off_422140
		mov	[esp+68h+var_5C], edx
		mov	edx, off_422144
		mov	[esp+68h+var_58], edx
		mov	edx, off_422148
		mov	[esp+68h+var_54], edx
		mov	edx, off_42214C
		mov	[esp+68h+var_50], edx
		mov	[esp+68h+MaxCount], 0FFFFFFFFh
		mov	[esp+68h+Val], eax
		lea	eax, [ebp+var_20]
		mov	[esp+68h+Buf], eax
		call	sub_40F918
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_41077E
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	short loc_41055C
; ---------------------------------------------------------------------------

loc_41055B:				; CODE XREF: sub_410472+210j
		nop

loc_41055C:				; CODE XREF: sub_410472+E7j
		cmp	[ebp+arg_4], 0
		jz	short loc_41056C
		cmp	[ebp+var_C], 1
		jz	loc_41068A

loc_41056C:				; CODE XREF: sub_410472+EEj
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+MaxCount], eax
		lea	eax, [ebp+var_28]
		mov	[esp+68h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Buf], eax
		call	sub_410388
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_41068B
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jz	loc_41068B
		mov	eax, [ebp+var_C]
		lea	edx, [eax-1]
		mov	eax, [ebp+var_2C]
		cmp	edx, eax
		jnb	short loc_4105B3
		mov	eax, [ebp+var_C]
		sub	eax, 1
		mov	[ebp+var_2C], eax

loc_4105B3:				; CODE XREF: sub_410472+136j
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	[esp+68h+MaxCount], edx	; MaxCount
		mov	[esp+68h+Val], 0Ah ; Val
		mov	[esp+68h+Buf], eax ; Buf
		call	memchr
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_410634
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_28]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+MaxCount], ecx
		mov	[esp+68h+Val], edx
		mov	[esp+68h+Buf], eax
		call	sub_411F16
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_41067E
		mov	eax, [ebp+var_2C]
		sub	[ebp+var_C], eax
		mov	eax, [ebp+var_2C]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Buf], eax
		call	sub_410424
		jmp	short loc_41068B
; ---------------------------------------------------------------------------

loc_410634:				; CODE XREF: sub_410472+162j
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+MaxCount], ecx
		mov	[esp+68h+Val], edx
		mov	[esp+68h+Buf], eax
		call	sub_411F16
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_41067E
		mov	eax, [ebp+var_2C]
		sub	[ebp+var_C], eax
		mov	eax, [ebp+var_2C]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Buf], eax
		call	sub_410424

loc_41067E:				; CODE XREF: sub_410472+1A0j
					; sub_410472+1ECj
		cmp	[ebp+var_18], 0
		jz	loc_41055B
		jmp	short loc_41068B
; ---------------------------------------------------------------------------

loc_41068A:				; CODE XREF: sub_410472+F4j
		nop

loc_41068B:				; CODE XREF: sub_410472+11Aj
					; sub_410472+125j ...
		cmp	[ebp+var_18], 0
		jnz	loc_410781
		cmp	[ebp+arg_4], 1
		jbe	short loc_4106BC
		cmp	[ebp+var_10], 0
		jnz	short loc_4106BC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 2
		mov	[eax+24Ch], dl
		jmp	loc_410788
; ---------------------------------------------------------------------------

loc_4106BC:				; CODE XREF: sub_410472+227j
					; sub_410472+22Dj
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_58], 0
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+Val], 0
		mov	[esp+68h+MaxCount], 0
		mov	[esp+68h+Buf], eax
		call	sub_40FE5A
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_410784
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41071D
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[esp+68h+Buf], eax ; size_t
		call	sub_40E4D7
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_410725
		mov	[ebp+var_18], 0FFFFFFFFh
		jmp	short loc_410788
; ---------------------------------------------------------------------------

loc_41071D:				; CODE XREF: sub_410472+289j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_410725:				; CODE XREF: sub_410472+2A0j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_5C], 0
		mov	ecx, [ebp+var_10]
		mov	[esp+68h+MaxCount], ecx
		mov	[esp+68h+Val], edx
		mov	[esp+68h+Buf], eax
		call	sub_411EB1
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_410787
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		add	eax, edx
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41076B
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_41076B:				; CODE XREF: sub_410472+2EFj
		cmp	[ebp+arg_C], 0
		jz	short loc_410788
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_410788
; ---------------------------------------------------------------------------

loc_41077B:				; CODE XREF: sub_410472+75j
		nop
		jmp	short loc_410788
; ---------------------------------------------------------------------------

loc_41077E:				; CODE XREF: sub_410472+D4j
		nop
		jmp	short loc_410788
; ---------------------------------------------------------------------------

loc_410781:				; CODE XREF: sub_410472+21Dj
		nop
		jmp	short loc_410788
; ---------------------------------------------------------------------------

loc_410784:				; CODE XREF: sub_410472+27Cj
		nop
		jmp	short loc_410788
; ---------------------------------------------------------------------------

loc_410787:				; CODE XREF: sub_410472+2DBj
		nop

loc_410788:				; CODE XREF: sub_410472+245j
					; sub_410472+2A9j ...
		mov	eax, [ebp+var_20]
		test	eax, eax
		jz	short loc_4107A4
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Val], 0 ; int
		mov	[esp+68h+Buf], eax ; void *
		call	sub_40FA3F
		jmp	short loc_4107B6
; ---------------------------------------------------------------------------

loc_4107A4:				; CODE XREF: sub_410472+31Bj
		mov	eax, [ebp+var_24]
		test	eax, eax
		jz	short loc_4107B6
		mov	eax, [ebp+var_24]
		mov	[esp+68h+Buf], eax
		call	sub_40ED64

loc_4107B6:				; CODE XREF: sub_410472+330j
					; sub_410472+337j
		cmp	[ebp+var_18], 0
		jz	short loc_4107E6
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4107D0
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Buf], eax ; void *
		call	sub_40E521

loc_4107D0:				; CODE XREF: sub_410472+351j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl

loc_4107E6:				; CODE XREF: sub_410472+348j
		mov	eax, [ebp+var_18]
		leave
		retn
sub_410472	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4107EB	proc near		; DATA XREF: sub_410843+2Bo

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_4]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_410248
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_C]
		mov	edx, [edx+24h]
		mov	ecx, [edx+258h]
		mov	edx, [ebp+var_14]
		add	edx, ecx
		mov	[eax+258h], edx
		mov	eax, [ebp+var_10]
		leave
		retn
sub_4107EB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410843	proc near		; CODE XREF: .text:00412677p
					; .text:004126ACp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+258h], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], offset sub_4107EB
		call	sub_408EE3
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41088A
		mov	eax, 0FFFFFFFFh
		jmp	short locret_410896
; ---------------------------------------------------------------------------

loc_41088A:				; CODE XREF: sub_410843+3Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+258h]

locret_410896:				; CODE XREF: sub_410843+45j
		leave
		retn
sub_410843	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410898	proc near		; CODE XREF: sub_410940+4Ep
					; .text:00410F4Bp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jz	short loc_4108C5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		cmp	[ebp+arg_4], 0
		setnz	dl
		mov	ecx, edx
		and	ecx, 1
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFEh
		or	edx, ecx
		mov	[eax+24Ch], dl

loc_4108C5:				; CODE XREF: sub_410898+7j
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jz	short loc_4108F0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		cmp	[ebp+arg_8], 0
		setnz	dl
		and	edx, 1
		lea	ecx, [edx+edx]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		or	edx, ecx
		mov	[eax+24Ch], dl

loc_4108F0:				; CODE XREF: sub_410898+31j
		pop	ebp
		retn
sub_410898	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4108F2	proc near		; CODE XREF: sub_411909+1Cp
					; sub_41196D+1Cp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_41091D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+24Ch]
		and	eax, 1
		movzx	eax, al
		mov	[ebp+var_4], eax
		jmp	short loc_41093B
; ---------------------------------------------------------------------------

loc_41091D:				; CODE XREF: sub_4108F2+11j
		cmp	[ebp+arg_8], 0
		jz	short loc_41093B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+24Ch]
		shr	al, 1
		and	eax, 1
		movzx	eax, al
		mov	[ebp+var_4], eax

loc_41093B:				; CODE XREF: sub_4108F2+29j
					; sub_4108F2+2Fj
		mov	eax, [ebp+var_4]
		leave
		retn
sub_4108F2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_410940(int, int, int,	size_t)
sub_410940	proc near		; CODE XREF: .text:0041157Dp
					; .text:00412B49p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_41096D
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40F450
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_410978
		jmp	loc_410A60
; ---------------------------------------------------------------------------

loc_41096D:				; CODE XREF: sub_410940+12j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40F5E9

loc_410978:				; CODE XREF: sub_410940+26j
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_410898
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		and	eax, 1
		test	al, al
		jz	short loc_4109D3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFFEh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40E521
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0

loc_4109D3:				; CODE XREF: sub_410940+65j
		cmp	[ebp+arg_8], 4
		jnz	short loc_4109E5
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 0
		jmp	short loc_410A4A
; ---------------------------------------------------------------------------

loc_4109E5:				; CODE XREF: sub_410940+97j
		cmp	[ebp+arg_4], 0
		jz	short loc_4109F3
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		jmp	short loc_410A1D
; ---------------------------------------------------------------------------

loc_4109F3:				; CODE XREF: sub_410940+A9j
		cmp	[ebp+arg_C], 0
		jnz	short loc_410A00
		mov	[ebp+arg_C], 200h

loc_410A00:				; CODE XREF: sub_410940+B7j
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_28], eax ;	size_t
		call	sub_40E4D7
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_410A1D
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_410A60
; ---------------------------------------------------------------------------

loc_410A1D:				; CODE XREF: sub_410940+B1j
					; sub_410940+D2j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_C]
		mov	[eax+4], edx
		cmp	[ebp+arg_4], 0
		jnz	short loc_410A4A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		or	edx, 1
		mov	[eax+250h], dl

loc_410A4A:				; CODE XREF: sub_410940+A3j
					; sub_410940+F2j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_8]
		mov	[eax+244h], edx
		mov	[ebp+var_C], 0

loc_410A60:				; CODE XREF: sub_410940+28j
					; sub_410940+DBj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_410940	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410A65	proc near		; CODE XREF: .text:00411BBBp
					; .text:00411C0Ap

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jl	short loc_410ABD
		cmp	edx, [ebp+var_C]
		jg	short loc_410AAD
		cmp	eax, [ebp+var_10]
		jbe	short loc_410ABD

loc_410AAD:				; CODE XREF: sub_410A65+41j
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		jmp	short loc_410ACE
; ---------------------------------------------------------------------------

loc_410ABD:				; CODE XREF: sub_410A65+3Cj
					; sub_410A65+46j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, 0
		sub	[ebp+var_10], eax
		sbb	[ebp+var_C], edx

loc_410ACE:				; CODE XREF: sub_410A65+56j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_410A65	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410ADA	proc near		; CODE XREF: .text:00412C0Fp
					; .text:00412C59p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_8], 0
		jz	short loc_410AF4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [eax+218h]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_410AF4:				; CODE XREF: sub_410ADA+7j
		cmp	[ebp+arg_4], 0
		jz	short loc_410B09
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_4]
		mov	[eax+218h], edx

loc_410B09:				; CODE XREF: sub_410ADA+1Ej
		pop	ebp
		retn
sub_410ADA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410B0B	proc near		; CODE XREF: sub_411861+Cp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+248h]
		pop	ebp
		retn
sub_410B0B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410B1C	proc near		; CODE XREF: sub_40AD6C+30p

var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_40E6C5
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_410B1C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-0Ch], 0
		lea	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_40F275
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_410C1F
		mov	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		lea	eax, [ebp-20h]
		mov	[esp+4], eax
		lea	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_40F1C0
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_410C22
		mov	dword ptr [ebp-0Ch], 1
		mov	ecx, [ebp-14h]
		mov	edx, [ebp-20h]
		mov	eax, [ebp-1Ch]
		mov	dword ptr [esp+20h], 0
		mov	[esp+1Ch], ecx
		mov	ecx, off_422150
		mov	[esp+0Ch], ecx
		mov	ecx, off_422154
		mov	[esp+10h], ecx
		mov	ecx, off_422158
		mov	[esp+14h], ecx
		mov	ecx, off_42215C
		mov	[esp+18h], ecx
		mov	[esp+8], edx
		mov	[esp+4], eax
		lea	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_40F918
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_410C25
		mov	eax, [ebp-18h]
		test	eax, eax
		jz	short loc_410C26
		cmp	dword ptr [ebp+8], 0
		jz	short loc_410C26
		mov	eax, [ebp-18h]
		mov	dword ptr [esp+8], 1
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_412C77
		jmp	short loc_410C26
; ---------------------------------------------------------------------------

loc_410C1F:				; CODE XREF: .text:00410B63j
		nop
		jmp	short loc_410C26
; ---------------------------------------------------------------------------

loc_410C22:				; CODE XREF: .text:00410B90j
		nop
		jmp	short loc_410C26
; ---------------------------------------------------------------------------

loc_410C25:				; CODE XREF: .text:00410BF4j
		nop

loc_410C26:				; CODE XREF: .text:00410BFBj
					; .text:00410C01j ...
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_410C40
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_410C40
		mov	edx, off_42215C
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	edx ; sub_40EF3E

loc_410C40:				; CODE XREF: .text:00410C2Aj
					; .text:00410C30j
		mov	eax, [ebp-18h]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-0Ch], 0
		lea	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp+20h]
		mov	[esp], eax
		call	sub_40F275
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_410D31
		mov	edx, [ebp-14h]
		lea	eax, [ebp-1Ch]
		mov	dword ptr [esp+24h], 0
		mov	[esp+20h], edx
		mov	edx, [ebp+1Ch]
		mov	[esp+1Ch], edx
		mov	edx, [ebp+18h]
		mov	[esp+18h], edx
		mov	edx, [ebp+14h]
		mov	[esp+14h], edx
		mov	dword ptr [esp+10h], 200h
		mov	edx, [ebp+10h]
		mov	[esp+0Ch], edx
		mov	edx, [ebp+0Ch]
		mov	[esp+8], edx
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_40E6F1
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_410D34
		mov	dword ptr [ebp-0Ch], 1
		mov	edx, [ebp-14h]
		mov	eax, [ebp-1Ch]
		mov	dword ptr [esp+20h], 0
		mov	[esp+1Ch], edx
		mov	edx, off_422140
		mov	[esp+0Ch], edx
		mov	edx, off_422144
		mov	[esp+10h], edx
		mov	edx, off_422148
		mov	[esp+14h], edx
		mov	edx, off_42214C
		mov	[esp+18h], edx
		mov	dword ptr [esp+8], 0FFFFFFFFh
		mov	[esp+4], eax
		lea	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_40F918
		mov	[ebp-10h], eax
		jmp	short loc_410D35
; ---------------------------------------------------------------------------

loc_410D31:				; CODE XREF: .text:00410C79j
		nop
		jmp	short loc_410D35
; ---------------------------------------------------------------------------

loc_410D34:				; CODE XREF: .text:00410CD2j
		nop

loc_410D35:				; CODE XREF: .text:00410D2Fj
					; .text:00410D32j
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_410D4F
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_410D4F
		mov	edx, off_42214C
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	edx ; sub_40ED64

loc_410D4F:				; CODE XREF: .text:00410D39j
					; .text:00410D3Fj
		mov	eax, [ebp-18h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410D54	proc near		; CODE XREF: .text:00410E93p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		lea	eax, [ebp+var_C]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	sub_40F275
		test	eax, eax
		jz	short loc_410D88
		mov	eax, 0
		jmp	locret_410E6A
; ---------------------------------------------------------------------------

loc_410D88:				; CODE XREF: sub_410D54+28j
		mov	eax, [ebp+var_C]
		or	eax, 2
		mov	[ebp+var_C], eax
		mov	edx, [ebp+var_C]
		lea	eax, [ebp+var_14]
		mov	ecx, [ebp+arg_0]
		mov	[esp+48h+var_24], ecx
		mov	[esp+48h+var_28], edx
		mov	[esp+48h+var_2C], offset sub_40E521
		mov	[esp+48h+var_30], offset sub_40E4F4
		mov	[esp+48h+var_34], 1
		mov	[esp+48h+var_38], 200h
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+var_44], 0
		mov	[esp+48h+var_48], eax
		call	sub_40E6F1
		test	eax, eax
		jz	short loc_410DED
		mov	eax, 0
		jmp	short locret_410E6A
; ---------------------------------------------------------------------------

loc_410DED:				; CODE XREF: sub_410D54+90j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_28], 0
		mov	[esp+48h+var_2C], edx
		mov	edx, off_422140
		mov	[esp+48h+var_3C], edx
		mov	edx, off_422144
		mov	[esp+48h+var_38], edx
		mov	edx, off_422148
		mov	[esp+48h+var_34], edx
		mov	edx, off_42214C
		mov	[esp+48h+var_30], edx
		mov	[esp+48h+var_40], 0FFFFFFFFh
		mov	[esp+48h+var_44], eax
		lea	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	sub_40F918
		test	eax, eax
		jz	short loc_410E50
		mov	edx, off_42214C
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	edx ; sub_40ED64

loc_410E50:				; CODE XREF: sub_410D54+ECj
		mov	eax, [ebp+var_10]
		test	eax, eax
		jz	short loc_410E67
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+23Ch], offset sub_40ECFC

loc_410E67:				; CODE XREF: sub_410D54+101j
		mov	eax, [ebp+var_10]

locret_410E6A:				; CODE XREF: sub_410D54+2Fj
					; sub_410D54+97j
		leave
		retn
sub_410D54	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_410E86
		mov	eax, [ebp+8]
		cmp	eax, [ebp+14h]
		jnb	short loc_410E86
		mov	eax, [ebp+14h]
		mov	[ebp+8], eax

loc_410E86:				; CODE XREF: .text:00410E76j
					; .text:00410E7Ej
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_410D54
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	loc_410F50
		cmp	dword ptr [ebp+10h], 0
		jz	loc_410F50
		cmp	dword ptr [ebp+14h], 0
		jz	loc_410F50
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp+14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_410248
		test	eax, eax
		jz	short loc_410F0A
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_411746
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp-10h]
		mov	[eax], edx
		jmp	short loc_410F50
; ---------------------------------------------------------------------------

loc_410F0A:				; CODE XREF: .text:00410EDCj
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_40FE5A
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_410898

loc_410F50:				; CODE XREF: .text:00410E9Fj
					; .text:00410EA9j ...
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-10h], 0
		lea	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_40F275
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_410FD2
		mov	eax, [ebp-10h]
		mov	dword ptr [esp+20h], 0
		mov	[esp+1Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+14h]
		mov	[esp+10h], eax
		mov	eax, [ebp+18h]
		mov	[esp+14h], eax
		mov	eax, [ebp+1Ch]
		mov	[esp+18h], eax
		mov	dword ptr [esp+8], 0FFFFFFFFh
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_40F918
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jmp	short loc_410FD3
; ---------------------------------------------------------------------------

loc_410FD2:				; CODE XREF: .text:00410F82j
		nop

loc_410FD3:				; CODE XREF: .text:00410FD0j
		mov	eax, [ebp-14h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410FD8	proc near		; CODE XREF: .text:004110DCp
					; .text:00411106p ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_14]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		call	sub_40F275
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_411096
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_54], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	sub_40ED99
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_411099
		mov	[ebp+var_C], 1
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_1C]
		mov	ecx, [ebp+arg_C]
		mov	[esp+58h+var_38], ecx
		mov	[esp+58h+var_3C], edx
		mov	edx, off_422150
		mov	[esp+58h+var_4C], edx
		mov	edx, off_422154
		mov	[esp+58h+var_48], edx
		mov	edx, off_422158
		mov	[esp+58h+var_44], edx
		mov	edx, off_42215C
		mov	[esp+58h+var_40], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+var_54], eax
		lea	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	sub_40F918
		mov	[ebp+var_10], eax
		jmp	short loc_41109A
; ---------------------------------------------------------------------------

loc_411096:				; CODE XREF: sub_410FD8+34j
		nop
		jmp	short loc_41109A
; ---------------------------------------------------------------------------

loc_411099:				; CODE XREF: sub_410FD8+61j
		nop

loc_41109A:				; CODE XREF: sub_410FD8+BCj
					; sub_410FD8+BFj
		cmp	[ebp+var_10], 0
		jz	short loc_4110B4
		cmp	[ebp+var_C], 0
		jz	short loc_4110B4
		mov	edx, off_42215C
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	edx ; sub_40EF3E

loc_4110B4:				; CODE XREF: sub_410FD8+C6j
					; sub_410FD8+CCj
		mov	eax, [ebp+var_18]
		leave
		retn
sub_410FD8	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_410FD8
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_410FD8
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41110D(FILE *, int, int, int)
sub_41110D	proc near		; CODE XREF: .text:0041123Cp
					; .text:00411266p ...

File		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 54h
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_14]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+File],	eax
		call	sub_40F275
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_4111F2
		cmp	[ebp+arg_0], 0
		jz	short loc_411159
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+File],	eax ; File
		call	fflush

loc_411159:				; CODE XREF: sub_41110D+3Fj
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx ;	int
		mov	[esp+58h+var_50], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_54], eax ;	FILE *
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+File],	eax ; int
		call	sub_40EF9D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4111F5
		mov	[ebp+var_C], 1
		mov	ebx, [ebp+var_14]
		cmp	[ebp+arg_0], 0
		jz	short loc_41119F
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+File],	eax ; File
		call	_fileno
		jmp	short loc_4111A4
; ---------------------------------------------------------------------------

loc_41119F:				; CODE XREF: sub_41110D+83j
		mov	eax, 0FFFFFFFFh

loc_4111A4:				; CODE XREF: sub_41110D+90j
		mov	edx, [ebp+var_1C]
		mov	ecx, [ebp+arg_C]
		mov	[esp+58h+var_38], ecx
		mov	[esp+58h+var_3C], ebx
		mov	ecx, off_422160
		mov	[esp+58h+var_4C], ecx
		mov	ecx, off_422164
		mov	[esp+58h+var_48], ecx
		mov	ecx, off_422168
		mov	[esp+58h+var_44], ecx
		mov	ecx, off_42216C
		mov	[esp+58h+var_40], ecx
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+var_54], edx
		lea	eax, [ebp+var_18]
		mov	[esp+58h+File],	eax
		call	sub_40F918
		mov	[ebp+var_10], eax
		jmp	short loc_4111F6
; ---------------------------------------------------------------------------

loc_4111F2:				; CODE XREF: sub_41110D+35j
		nop
		jmp	short loc_4111F6
; ---------------------------------------------------------------------------

loc_4111F5:				; CODE XREF: sub_41110D+73j
		nop

loc_4111F6:				; CODE XREF: sub_41110D+E3j
					; sub_41110D+E6j
		cmp	[ebp+var_10], 0
		jz	short loc_411210
		cmp	[ebp+var_C], 0
		jz	short loc_411210
		mov	edx, off_42216C
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+File],	eax
		call	edx ; sub_40F155

loc_411210:				; CODE XREF: sub_41110D+EDj
					; sub_41110D+F3j
		mov	eax, [ebp+var_18]
		add	esp, 54h
		pop	ebx
		pop	ebp
		retn
sub_41110D	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41110D
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41110D
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, ds:dword_428A2C
		mov	[esp], eax
		call	sub_40E4C8
		cmp	dword ptr [ebp+8], 0
		js	short loc_4112B3
		cmp	dword ptr [ebp+8], 2
		jg	short loc_4112B3
		mov	eax, [ebp+8]
		add	eax, offset byte_428A3C
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4112B3
		mov	eax, [ebp+8]
		mov	edx, [ebp+0Ch]
		mov	ds:dword_428A30[eax*4],	edx
		mov	eax, [ebp+8]
		add	eax, offset byte_428A3C
		mov	byte ptr [eax],	1

loc_4112B3:				; CODE XREF: .text:00411284j
					; .text:0041128Aj ...
		mov	eax, ds:dword_428A2C
		mov	[esp], eax
		call	sub_40E4C8
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		mov	ecx, [ebp+8]
		mov	edx, 55555556h
		mov	eax, ecx
		imul	edx
		mov	eax, ecx
		sar	eax, 1Fh
		sub	edx, eax
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		mov	[ebp+8], eax
		mov	eax, ds:dword_428A2C
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, ds:dword_428A28
		mov	[ebp-0Ch], eax
		jmp	short loc_41134E
; ---------------------------------------------------------------------------

loc_411308:				; CODE XREF: .text:00411352j
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		and	eax, 2
		test	al, al
		jz	short loc_411345
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		shr	al, 2
		and	eax, 3
		movzx	eax, al
		cmp	eax, [ebp+8]
		jnz	short loc_411345
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		jmp	short loc_411354
; ---------------------------------------------------------------------------

loc_411345:				; CODE XREF: .text:0041131Cj
					; .text:00411339j
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+4]
		mov	[ebp-0Ch], eax

loc_41134E:				; CODE XREF: .text:00411306j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_411308

loc_411354:				; CODE XREF: .text:00411343j
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_4115B8
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_411399
		movzx	eax, ds:byte_428A3C
		test	al, al
		jz	short loc_411399
		mov	eax, ds:dword_428A30
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aR_1 ; "r"
		mov	[esp], eax
		call	sub_410FD8
		mov	[ebp-10h], eax
		jmp	short loc_411407
; ---------------------------------------------------------------------------

loc_411399:				; CODE XREF: .text:00411362j
					; .text:0041136Dj
		cmp	dword ptr [ebp+8], 1
		jnz	short loc_4113D4
		movzx	eax, ds:byte_428A3D
		test	al, al
		jz	short loc_4113D4
		mov	eax, ds:dword_428A34
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aA ; "a"
		mov	[esp], eax
		call	sub_410FD8
		mov	[ebp-10h], eax
		jmp	short loc_411407
; ---------------------------------------------------------------------------

loc_4113D4:				; CODE XREF: .text:0041139Dj
					; .text:004113A8j
		movzx	eax, ds:byte_428A3E
		test	al, al
		jz	short loc_411407
		mov	eax, ds:dword_428A38
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aA ; "a"
		mov	[esp], eax
		call	sub_410FD8
		mov	[ebp-10h], eax

loc_411407:				; CODE XREF: .text:00411397j
					; .text:004113D2j ...
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_41149F
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_411441
		mov	eax, ds:_iob
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aR_1 ; "r"
		mov	[esp], eax
		call	sub_41110D
		mov	[ebp-10h], eax
		jmp	short loc_41149F
; ---------------------------------------------------------------------------

loc_411441:				; CODE XREF: .text:00411415j
		cmp	dword ptr [ebp+8], 1
		jnz	short loc_411474
		mov	eax, ds:_iob
		add	eax, 20h
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aA ; "a"
		mov	[esp], eax
		call	sub_41110D
		mov	[ebp-10h], eax
		jmp	short loc_41149F
; ---------------------------------------------------------------------------

loc_411474:				; CODE XREF: .text:00411445j
		mov	eax, ds:_iob
		add	eax, 40h
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aA ; "a"
		mov	[esp], eax
		call	sub_41110D
		mov	[ebp-10h], eax

loc_41149F:				; CODE XREF: .text:0041140Bj
					; .text:0041143Fj ...
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_41151B
		cmp	dword ptr [ebp+8], 0
		jz	short loc_4114B2
		mov	eax, offset aA	; "a"
		jmp	short loc_4114B7
; ---------------------------------------------------------------------------

loc_4114B2:				; CODE XREF: .text:004114A9j
		mov	eax, offset aR_1 ; "r"

loc_4114B7:				; CODE XREF: .text:004114B0j
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_41110D
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_41151B
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp], eax
		call	strerror
		mov	edx, offset aFatalErrorCrea ; "fatal: error creating a dummy estream f"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	[esp], ecx
		call	fprintf
		call	abort
; ---------------------------------------------------------------------------

loc_41151B:				; CODE XREF: .text:004114A3j
					; .text:004114DEj
		mov	eax, [ebp-10h]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		or	edx, 2
		mov	[eax+250h], dl
		mov	eax, [ebp-10h]
		mov	eax, [eax+24h]
		mov	edx, [ebp+8]
		and	edx, 3
		and	edx, 3
		lea	ecx, ds:0[edx*4]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFF3h
		or	edx, ecx
		mov	[eax+250h], dl
		cmp	dword ptr [ebp+8], 2
		jnz	short loc_411582
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 40h
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_410940

loc_411582:				; CODE XREF: .text:0041155Dj
		cmp	dword ptr [ebp+8], 0
		jz	short loc_41159C
		cmp	dword ptr [ebp+8], 1
		jnz	short loc_411595
		mov	eax, offset aStdout ; "[stdout]"
		jmp	short loc_41159A
; ---------------------------------------------------------------------------

loc_411595:				; CODE XREF: .text:0041158Cj
		mov	eax, offset aStderr ; "[stderr]"

loc_41159A:				; CODE XREF: .text:00411593j
		jmp	short loc_4115A1
; ---------------------------------------------------------------------------

loc_41159C:				; CODE XREF: .text:00411586j
		mov	eax, offset aStdin ; "[stdin]"

loc_4115A1:				; CODE XREF: .text:loc_41159Aj
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_412C77

loc_4115B8:				; CODE XREF: .text:00411358j
		mov	eax, ds:dword_428A2C
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp-10h]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		cmp	dword ptr [ebp+8], 0
		jz	loc_41170F
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_40F814
		lea	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_40F275
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_41169C
		mov	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		lea	eax, [ebp-1Ch]
		mov	[esp+4], eax
		lea	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_40F1C0
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_41169F
		mov	dword ptr [ebp-10h], 1
		mov	ecx, [ebp-14h]
		mov	edx, [ebp-1Ch]
		mov	eax, [ebp-18h]
		mov	[esp+1Ch], ecx
		mov	ecx, off_422150
		mov	[esp+0Ch], ecx
		mov	ecx, off_422154
		mov	[esp+10h], ecx
		mov	ecx, off_422158
		mov	[esp+14h], ecx
		mov	ecx, off_42215C
		mov	[esp+18h], ecx
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_40F639
		jmp	short loc_4116A0
; ---------------------------------------------------------------------------

loc_41169C:				; CODE XREF: .text:00411620j
		nop
		jmp	short loc_4116A0
; ---------------------------------------------------------------------------

loc_41169F:				; CODE XREF: .text:00411649j
		nop

loc_4116A0:				; CODE XREF: .text:0041169Aj
					; .text:0041169Dj
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_4116D3
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_4116B7
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_40EF3E

loc_4116B7:				; CODE XREF: .text:004116AAj
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_40FA3F
		mov	dword ptr [ebp+10h], 0
		jmp	short loc_411741
; ---------------------------------------------------------------------------

loc_4116D3:				; CODE XREF: .text:004116A4j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_4116F9
		cmp	dword ptr [ebp+8], 0
		jz	short loc_4116F9
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_412C77

loc_4116F9:				; CODE XREF: .text:004116D7j
					; .text:004116DDj
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		jmp	short loc_411741
; ---------------------------------------------------------------------------

loc_41170F:				; CODE XREF: .text:004115D4j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_40F814
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_40FA3F
		mov	dword ptr [ebp+10h], 0

loc_411741:				; CODE XREF: .text:004116D1j
					; .text:0041170Dj
		mov	eax, [ebp+10h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_411746(void *)
sub_411746	proc near		; CODE XREF: .text:00410EF0p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_24], 0 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40FA3F
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_411746	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+0Ch], 0
		jz	loc_41181E
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+23Ch]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_4117AE
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 28h
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jmp	loc_41183A
; ---------------------------------------------------------------------------

loc_4117AE:				; CODE XREF: .text:00411793j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4117DD
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40F450
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_411836
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_4117DD:				; CODE XREF: .text:004117BAj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		lea	edx, [ebp-14h]
		mov	[esp+0Ch], edx
		mov	edx, [ebp+0Ch]
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		mov	eax, [ebp-10h]
		call	eax
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_411839
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_41181E
		mov	edx, [ebp-14h]
		mov	eax, [ebp+10h]
		mov	[eax], edx

loc_41181E:				; CODE XREF: .text:00411771j
					; .text:00411814j
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40FA3F
		mov	[ebp-0Ch], eax
		jmp	short loc_41183A
; ---------------------------------------------------------------------------

loc_411836:				; CODE XREF: .text:004117CEj
		nop
		jmp	short loc_41183A
; ---------------------------------------------------------------------------

loc_411839:				; CODE XREF: .text:0041180Ej
		nop

loc_41183A:				; CODE XREF: .text:004117A9j
					; .text:00411834j ...
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_41185C
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_41185C
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[esp], eax
		call	sub_40E521
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0

loc_41185C:				; CODE XREF: .text:0041183Ej
					; .text:00411844j
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411861	proc near		; CODE XREF: .text:004118E8p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		mov	[esp+4+var_4], eax
		call	sub_410B0B
		leave
		retn
sub_411861	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4CD
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_411861
		mov	[ebp-4], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411909	proc near		; CODE XREF: .text:0041194Cp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	[esp+0Ch+var_4], 1
		mov	[esp+0Ch+var_8], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_4108F2
		leave
		retn
sub_411909	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_411909
		mov	[ebp-4], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41196D	proc near		; CODE XREF: .text:004119B0p
					; sub_412E36+3B4p ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	[esp+0Ch+var_4], 0
		mov	[esp+0Ch+var_8], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_4108F2
		leave
		retn
sub_41196D	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41196D
		mov	[ebp-4], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4119D1	proc near		; CODE XREF: .text:00411A14p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	[esp+0Ch+var_4], 0
		mov	[esp+0Ch+var_8], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_410898
		leave
		retn
sub_4119D1	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4119D1
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411A2F	proc near		; CODE XREF: sub_411A6A+26p
					; DATA XREF: sub_411A6A:loc_411AAEo

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_411A53
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40F450
		mov	[ebp+var_C], eax
		jmp	short loc_411A65
; ---------------------------------------------------------------------------

loc_411A53:				; CODE XREF: sub_411A2F+12j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40F5E9
		mov	[ebp+var_C], 0

loc_411A65:				; CODE XREF: sub_411A2F+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_411A2F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411A6A	proc near		; CODE XREF: sub_40E6A7+Dp

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_411AAE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_40E4C8
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_411A2F
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_40E4C8
		jmp	short loc_411ABD
; ---------------------------------------------------------------------------

loc_411AAE:				; CODE XREF: sub_411A6A+Aj
		mov	[esp+28h+var_28], offset sub_411A2F
		call	sub_40E652
		mov	[ebp+var_C], eax

loc_411ABD:				; CODE XREF: sub_411A6A+42j
		cmp	[ebp+var_C], 0
		jz	short loc_411ACA
		mov	eax, 0FFFFFFFFh
		jmp	short locret_411ACF
; ---------------------------------------------------------------------------

loc_411ACA:				; CODE XREF: sub_411A6A+57j
		mov	eax, 0

locret_411ACF:				; CODE XREF: sub_411A6A+5Ej
		leave
		retn
sub_411A6A	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp+0Ch]
		mov	edx, eax
		sar	edx, 1Fh
		mov	dword ptr [esp+10h], 0
		mov	ecx, [ebp+10h]
		mov	[esp+0Ch], ecx
		mov	[esp+4], eax
		mov	[esp+8], edx
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40FE5A
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+0Ch]
		mov	[ebp-20h], eax
		mov	eax, [ebp+10h]
		mov	[ebp-1Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	dword ptr [esp+10h], 0
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp-20h]
		mov	edx, [ebp-1Ch]
		mov	[esp+4], eax
		mov	[esp+8], edx
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40FE5A
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_410A65
		mov	[ebp-4], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [ebp-8], 0FFFFFFFFh
		mov	dword ptr [ebp-4], 0FFFFFFFFh
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_410A65
		mov	[ebp-8], eax
		mov	[ebp-4], edx
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp-8]
		mov	edx, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40FE5A
		mov	dword ptr [esp+8], 0FFFFFFFFh
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_410898
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411CA7	proc near		; CODE XREF: .text:00411D98p
					; .text:0041210Bp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_D]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], 1
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40FC67
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_411CE7
		mov	eax, [ebp+var_14]
		test	eax, eax
		jz	short loc_411CE7
		movzx	eax, [ebp+var_D]
		movzx	eax, al
		jmp	short locret_411CEC
; ---------------------------------------------------------------------------

loc_411CE7:				; CODE XREF: sub_411CA7+2Ej
					; sub_411CA7+35j
		mov	eax, 0FFFFFFFFh

locret_411CEC:				; CODE XREF: sub_411CA7+3Ej
		leave
		retn
sub_411CA7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411CEE	proc near		; CODE XREF: .text:00411E28p
					; sub_412E36+BBp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_D], al
		lea	eax, [ebp+var_D]
		mov	[esp+28h+var_1C], 0
		mov	[esp+28h+var_20], 1
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_410248
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_411D2A
		mov	eax, [ebp+arg_0]
		jmp	short locret_411D2F
; ---------------------------------------------------------------------------

loc_411D2A:				; CODE XREF: sub_411CEE+35j
		mov	eax, 0FFFFFFFFh

locret_411D2F:				; CODE XREF: sub_411CEE+3Aj
		leave
		retn
sub_411CEE	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_411D92
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_411D92
		mov	eax, [ebp+8]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_411D92
		mov	eax, [ebp+8]
		mov	ecx, [eax]
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+0Ch], ecx
		jmp	short loc_411D9D
; ---------------------------------------------------------------------------

loc_411D92:				; CODE XREF: .text:00411D57j
					; .text:00411D67j ...
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_411CA7

loc_411D9D:				; CODE XREF: .text:00411D90j
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_411E1B
		mov	eax, [ebp+0Ch]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_411E1B
		cmp	dword ptr [ebp+8], 0Ah
		jz	short loc_411E1B
		mov	eax, [ebp+0Ch]
		mov	ecx, [eax]
		mov	eax, [ebp+0Ch]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		mov	ecx, [ebp+8]
		mov	[eax], cl
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+0Ch]
		mov	[edx+0Ch], ecx
		jmp	short loc_411E2D
; ---------------------------------------------------------------------------

loc_411E1B:				; CODE XREF: .text:00411DDFj
					; .text:00411DEFj ...
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_411CEE

loc_411E2D:				; CODE XREF: .text:00411E19j
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-9], al
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		lea	eax, [ebp-9]
		lea	edx, [ebp-10h]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_40FDCB
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp-10h]
		test	eax, eax
		jz	short loc_411EAA
		mov	eax, [ebp+8]
		jmp	short locret_411EAF
; ---------------------------------------------------------------------------

loc_411EAA:				; CODE XREF: .text:00411EA3j
		mov	eax, 0FFFFFFFFh

locret_411EAF:				; CODE XREF: .text:00411EA8j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411EB1	proc near		; CODE XREF: sub_410472+2CFp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jz	short loc_411F0A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_40E4C8
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40FC67
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_40E4C8
		jmp	short loc_411F11
; ---------------------------------------------------------------------------

loc_411F0A:				; CODE XREF: sub_411EB1+Aj
		mov	[ebp+var_C], 0

loc_411F11:				; CODE XREF: sub_411EB1+57j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_411EB1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411F16	proc near		; CODE XREF: sub_410472+194p
					; sub_410472+1E0p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jz	short loc_411F6F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_40E4C8
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_410248
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_40E4C8
		jmp	short loc_411F76
; ---------------------------------------------------------------------------

loc_411F6F:				; CODE XREF: sub_411F16+Aj
		mov	[ebp+var_C], 0

loc_411F76:				; CODE XREF: sub_411F16+57j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_411F16	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		test	eax, eax
		jz	short loc_411FE8
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		lea	edx, [ebp-10h]
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_40FC67
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp-10h]
		mov	edx, 0
		div	dword ptr [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	short loc_411FEF
; ---------------------------------------------------------------------------

loc_411FE8:				; CODE XREF: .text:00411F8Aj
		mov	dword ptr [ebp-0Ch], 0

loc_411FEF:				; CODE XREF: .text:00411FE6j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		test	eax, eax
		jz	short loc_412061
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		lea	edx, [ebp-10h]
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_410248
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp-10h]
		mov	edx, 0
		div	dword ptr [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	short loc_412068
; ---------------------------------------------------------------------------

loc_412061:				; CODE XREF: .text:00412003j
		mov	dword ptr [ebp-0Ch], 0

loc_412068:				; CODE XREF: .text:0041205Fj
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_412089
		mov	eax, 0
		jmp	locret_41216B
; ---------------------------------------------------------------------------

loc_412089:				; CODE XREF: .text:0041207Dj
		mov	dword ptr [ebp-10h], 0FFFFFFFFh
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		jmp	short loc_4120B8
; ---------------------------------------------------------------------------

loc_4120A6:				; CODE XREF: .text:0041211Dj
		mov	eax, [ebp-10h]
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp+0Ch], 1

loc_4120B8:				; CODE XREF: .text:004120A4j
		cmp	dword ptr [ebp+0Ch], 1
		jle	short loc_41211F
		mov	eax, [ebp+10h]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_412105
		mov	eax, [ebp+10h]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+10h]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_412105
		mov	eax, [ebp+10h]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_412105
		mov	eax, [ebp+10h]
		mov	ecx, [eax]
		mov	eax, [ebp+10h]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+10h]
		mov	[edx+0Ch], ecx
		jmp	short loc_412110
; ---------------------------------------------------------------------------

loc_412105:				; CODE XREF: .text:004120CAj
					; .text:004120DAj ...
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_411CA7

loc_412110:				; CODE XREF: .text:00412103j
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jz	short loc_41211F
		cmp	dword ptr [ebp-10h], 0Ah
		jnz	short loc_4120A6

loc_41211F:				; CODE XREF: .text:004120BCj
					; .text:00412117j
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_412148
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_412148
		mov	eax, 0
		jmp	short locret_41216B
; ---------------------------------------------------------------------------

loc_412148:				; CODE XREF: .text:00412137j
					; .text:0041213Fj
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jz	short loc_412162
		cmp	dword ptr [ebp+0Ch], 1
		jle	short loc_412162
		mov	eax, [ebp-10h]
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1

loc_412162:				; CODE XREF: .text:0041214Cj
					; .text:00412152j
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+8]

locret_41216B:				; CODE XREF: .text:00412084j
					; .text:00412146j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp-0Ch], eax
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_410248
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_4121C7
		mov	eax, 0FFFFFFFFh
		jmp	short loc_4121CC
; ---------------------------------------------------------------------------

loc_4121C7:				; CODE XREF: .text:004121BEj
		mov	eax, 0

loc_4121CC:				; CODE XREF: .text:004121C5j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4121D2	proc near		; CODE XREF: .text:004134B2p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+38h+var_38], eax
		call	sub_40E4C8
		mov	[esp+38h+var_2C], 0
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	sub_410248
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+38h+var_38], eax
		call	sub_40E4C8
		cmp	[ebp+var_10], 0
		jz	short loc_412254
		mov	eax, 0FFFFFFFFh
		jmp	short loc_412259
; ---------------------------------------------------------------------------

loc_412254:				; CODE XREF: sub_4121D2+79j
		mov	eax, 0

loc_412259:				; CODE XREF: sub_4121D2+80j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_4121D2	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-18h], 0
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		lea	eax, [ebp-14h]
		lea	edx, [ebp-18h]
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_410472
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		cmp	dword ptr [ebp-0Ch], 0
		jnz	loc_41237B
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		test	eax, eax
		jz	loc_412367
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	edx, [ebp-18h]
		add	edx, 1
		cmp	eax, edx
		jnb	short loc_412320
		mov	eax, [ebp-18h]
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_40E4F4
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_41230E
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jmp	short loc_412320
; ---------------------------------------------------------------------------

loc_41230E:				; CODE XREF: .text:00412303j
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, [ebp-10h]
		jz	short loc_412320
		mov	edx, [ebp-10h]
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_412320:				; CODE XREF: .text:004122E3j
					; .text:0041230Cj ...
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_41235A
		mov	eax, [ebp-18h]
		lea	ecx, [eax+1]
		mov	eax, [ebp-14h]
		mov	edx, eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp+0Ch]
		mov	edx, [eax]
		mov	eax, [ebp-18h]
		cmp	edx, eax
		jz	short loc_41235A
		mov	edx, [ebp-18h]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx

loc_41235A:				; CODE XREF: .text:00412324j
					; .text:00412350j
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_40E521
		jmp	short loc_41237C
; ---------------------------------------------------------------------------

loc_412367:				; CODE XREF: .text:004122D0j
		mov	eax, [ebp-14h]
		mov	edx, eax
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	edx, [ebp-18h]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx
		jmp	short loc_41237C
; ---------------------------------------------------------------------------

loc_41237B:				; CODE XREF: .text:004122C3j
		nop

loc_41237C:				; CODE XREF: .text:00412365j
					; .text:00412379j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_412387
		mov	eax, [ebp-18h]
		jmp	short locret_41238A
; ---------------------------------------------------------------------------

loc_412387:				; CODE XREF: .text:00412380j
		mov	eax, [ebp-0Ch]

locret_41238A:				; CODE XREF: .text:00412385j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		mov	[ebp-14h], eax
		mov	dword ptr [ebp-18h], 0
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_4123B6
		mov	eax, [ebp+14h]
		mov	eax, [eax]
		jmp	short loc_4123BB
; ---------------------------------------------------------------------------

loc_4123B6:				; CODE XREF: .text:004123ADj
		mov	eax, 0

loc_4123BB:				; CODE XREF: .text:004123B4j
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_412411
		mov	dword ptr [ebp-14h], 100h
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_40E4D7
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp-10h]
		mov	[eax], edx
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_412409
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 0
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_4123FF
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0

loc_4123FF:				; CODE XREF: .text:004123F4j
		mov	eax, 0FFFFFFFFh
		jmp	locret_412648
; ---------------------------------------------------------------------------

loc_412409:				; CODE XREF: .text:004123E5j
		mov	eax, [ebp+10h]
		mov	edx, [ebp-14h]
		mov	[eax], edx

loc_412411:				; CODE XREF: .text:004123C2j
		cmp	dword ptr [ebp-14h], 3
		ja	short loc_41242E
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_412648
; ---------------------------------------------------------------------------

loc_41242E:				; CODE XREF: .text:00412415j
		sub	dword ptr [ebp-14h], 3
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp-10h]
		mov	[ebp-1Ch], eax
		jmp	loc_4125C6
; ---------------------------------------------------------------------------

loc_412451:				; CODE XREF: .text:0041261Fj
		mov	eax, [ebp-18h]
		cmp	eax, [ebp-14h]
		jnz	loc_4125AE
		cmp	dword ptr [ebp-20h], 0
		jz	loc_4124FA
		mov	eax, [ebp-14h]
		cmp	eax, [ebp-20h]
		jbe	loc_4124FA

loc_412473:				; CODE XREF: .text:004124D2j
		cmp	dword ptr [ebp-0Ch], 0Ah
		jz	short loc_4124D4
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_4124C0
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_4124C0
		mov	eax, [ebp+8]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_4124C0
		mov	eax, [ebp+8]
		mov	ecx, [eax]
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+0Ch], ecx
		jmp	short loc_4124CB
; ---------------------------------------------------------------------------

loc_4124C0:				; CODE XREF: .text:00412485j
					; .text:00412495j ...
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_411CA7

loc_4124CB:				; CODE XREF: .text:004124BEj
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_412473

loc_4124D4:				; CODE XREF: .text:00412477j
		mov	eax, [ebp-1Ch]
		mov	byte ptr [eax],	0Ah
		add	dword ptr [ebp-1Ch], 1
		add	dword ptr [ebp-18h], 1
		cmp	dword ptr [ebp+14h], 0
		jz	loc_412627
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0
		jmp	loc_412627
; ---------------------------------------------------------------------------

loc_4124FA:				; CODE XREF: .text:00412461j
					; .text:0041246Dj
		add	dword ptr [ebp-14h], 3
		cmp	dword ptr [ebp-14h], 3FFh
		ja	short loc_41250E
		mov	eax, 100h
		jmp	short loc_412513
; ---------------------------------------------------------------------------

loc_41250E:				; CODE XREF: .text:00412505j
		mov	eax, 400h

loc_412513:				; CODE XREF: .text:0041250Cj
		add	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_40E4F4
		mov	edx, [ebp+0Ch]
		mov	[edx], eax
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41258F
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp-24h], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_40E521
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 0
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_412565
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0

loc_412565:				; CODE XREF: .text:0041255Aj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp-24h]
		mov	[eax], edx
		mov	eax, 0FFFFFFFFh
		jmp	locret_412648
; ---------------------------------------------------------------------------

loc_41258F:				; CODE XREF: .text:00412534j
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp+10h]
		mov	edx, [ebp-14h]
		mov	[eax], edx
		sub	dword ptr [ebp-14h], 3
		mov	eax, [ebp-18h]
		mov	edx, [ebp-10h]
		add	eax, edx
		mov	[ebp-1Ch], eax

loc_4125AE:				; CODE XREF: .text:00412457j
		mov	eax, [ebp-0Ch]
		mov	edx, eax
		mov	eax, [ebp-1Ch]
		mov	[eax], dl
		add	dword ptr [ebp-1Ch], 1
		add	dword ptr [ebp-18h], 1
		cmp	dword ptr [ebp-0Ch], 0Ah
		jz	short loc_41262A

loc_4125C6:				; CODE XREF: .text:0041244Cj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_41260D
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_41260D
		mov	eax, [ebp+8]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_41260D
		mov	eax, [ebp+8]
		mov	ecx, [eax]
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+0Ch], ecx
		jmp	short loc_412618
; ---------------------------------------------------------------------------

loc_41260D:				; CODE XREF: .text:004125D2j
					; .text:004125E2j ...
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_411CA7

loc_412618:				; CODE XREF: .text:0041260Bj
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	loc_412451
		jmp	short loc_41262B
; ---------------------------------------------------------------------------

loc_412627:				; CODE XREF: .text:004124E6j
					; .text:004124F5j
		nop
		jmp	short loc_41262B
; ---------------------------------------------------------------------------

loc_41262A:				; CODE XREF: .text:004125C4j
		nop

loc_41262B:				; CODE XREF: .text:00412625j
					; .text:00412628j
		mov	eax, [ebp-1Ch]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp-18h]

locret_412648:				; CODE XREF: .text:00412404j
					; .text:00412429j ...
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40E521
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_410843
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_410843
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4126CD	proc near		; CODE XREF: sub_412E36+31Ap

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_410843
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4126CD	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+10h]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_410843
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_409833
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jns	short loc_41278A
		mov	eax, 0
		jmp	short locret_41278D
; ---------------------------------------------------------------------------

loc_41278A:				; CODE XREF: .text:00412781j
		mov	eax, [ebp-14h]

locret_41278D:				; CODE XREF: .text:00412788j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_409833
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jns	short loc_4127BE
		mov	eax, 0
		jmp	short locret_4127C1
; ---------------------------------------------------------------------------

loc_4127BE:				; CODE XREF: .text:004127B5j
		mov	eax, [ebp-10h]

locret_4127C1:				; CODE XREF: .text:004127BCj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4127C3	proc near		; CODE XREF: .text:00412A19p

nBufferLength	= dword	ptr -178h
lpBuffer	= dword	ptr -174h
dwShareMode	= dword	ptr -170h
lpSecurityAttributes= dword ptr	-16Ch
dwCreationDisposition= dword ptr -168h
dwFlagsAndAttributes= dword ptr	-164h
hTemplateFile	= dword	ptr -160h
var_14C		= dword	ptr -14Ch
Buffer		= byte ptr -146h
var_2C		= dword	ptr -2Ch
hObject		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 174h
		mov	eax, ds:GetCurrentProcessId
		call	eax ; GetCurrentProcessId
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+Buffer]
		mov	[esp+178h+lpBuffer], eax ; lpBuffer
		mov	[esp+178h+nBufferLength], 105h ; nBufferLength
		mov	eax, ds:GetTempPathA
		call	eax ; GetTempPathA
		sub	esp, 8
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_412833
		cmp	[ebp+var_20], 104h
		jg	short loc_412833
		lea	eax, [ebp+Buffer]
		mov	[ebp+var_14C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 104h
		jbe	short loc_41284A

loc_412833:				; CODE XREF: sub_4127C3+36j
					; sub_4127C3+3Fj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 2
		mov	eax, 0FFFFFFFFh
		jmp	loc_4129F2
; ---------------------------------------------------------------------------

loc_41284A:				; CODE XREF: sub_4127C3+6Ej
		lea	eax, [ebp+Buffer]
		mov	[ebp+var_14C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp+Buffer]
		add	eax, edx
		mov	[ebp+var_10], eax
		mov	edx, offset a_estream ;	"_estream"
		mov	eax, [ebp+var_10]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	edx, byte ptr [edx+8]
		mov	[eax+8], dl
		add	[ebp+var_10], 8
		mov	[esp+178h+lpBuffer], 0 ; lpSecurityAttributes
		lea	eax, [ebp+Buffer]
		mov	[esp+178h+nBufferLength], eax ;	lpPathName
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[ebp+var_24], eax
		mov	[ebp+var_C], 0
		jmp	loc_4129D6
; ---------------------------------------------------------------------------

loc_4128D1:				; CODE XREF: sub_4127C3+217j
		mov	eax, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	eax, ds:GetTickCount
		call	eax ; GetTickCount
		mov	edx, [ebp+var_1C]
		shl	edx, 10h
		xor	eax, edx
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		jmp	short loc_412922
; ---------------------------------------------------------------------------

loc_4128F2:				; CODE XREF: sub_4127C3+163j
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		cmp	eax, 9
		ja	short loc_412908
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		add	eax, 30h
		jmp	short loc_412911
; ---------------------------------------------------------------------------

loc_412908:				; CODE XREF: sub_4127C3+138j
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		add	eax, 37h

loc_412911:				; CODE XREF: sub_4127C3+143j
		mov	edx, [ebp+var_10]
		mov	[edx], al
		add	[ebp+var_10], 1
		shl	[ebp+var_14], 4
		add	[ebp+var_18], 1

loc_412922:				; CODE XREF: sub_4127C3+12Dj
		cmp	[ebp+var_18], 7
		jle	short loc_4128F2
		mov	edx, offset a_tmp_0 ; ".tmp"
		mov	eax, [ebp+var_10]
		mov	ecx, [edx]
		mov	[eax], ecx
		movzx	edx, byte ptr [edx+4]
		mov	[eax+4], dl
		mov	[esp+178h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+178h+dwFlagsAndAttributes], 4000100h ; dwFlagsAndAttributes
		mov	[esp+178h+dwCreationDisposition], 1 ; dwCreationDisposition
		mov	[esp+178h+lpSecurityAttributes], 0 ; lpSecurityAttributes
		mov	[esp+178h+dwShareMode],	0 ; dwShareMode
		mov	[esp+178h+lpBuffer], 0C0000000h	; dwDesiredAccess
		lea	eax, [ebp+Buffer]
		mov	[esp+178h+nBufferLength], eax ;	lpFileName
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0FFFFFFFFh
		jz	short loc_4129C1
		mov	eax, [ebp+hObject]
		mov	[esp+178h+lpBuffer], 0
		mov	[esp+178h+nBufferLength], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0FFFFFFFFh
		jnz	short loc_4129BC
		mov	eax, [ebp+hObject]
		mov	[esp+178h+nBufferLength], eax ;	hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0FFFFFFFFh
		jmp	short loc_4129F2
; ---------------------------------------------------------------------------

loc_4129BC:				; CODE XREF: sub_4127C3+1E0j
		mov	eax, [ebp+var_2C]
		jmp	short loc_4129F2
; ---------------------------------------------------------------------------

loc_4129C1:				; CODE XREF: sub_4127C3+1C2j
		mov	[esp+178h+nBufferLength], 1 ; dwMilliseconds
		mov	eax, ds:Sleep
		call	eax ; Sleep
		sub	esp, 4
		add	[ebp+var_C], 1

loc_4129D6:				; CODE XREF: sub_4127C3+109j
		cmp	[ebp+var_C], 9
		jle	loc_4128D1
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 2
		mov	eax, 0FFFFFFFFh

loc_4129F2:				; CODE XREF: sub_4127C3+82j
					; sub_4127C3+1F7j ...
		mov	edi, [ebp+var_4]
		leave
		retn
sub_4127C3	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-14h], 302h
		mov	dword ptr [ebp-20h], 0
		call	sub_4127C3
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jnz	short loc_412A33
		mov	dword ptr [ebp-10h], 0FFFFFFFFh
		jmp	loc_412ABA
; ---------------------------------------------------------------------------

loc_412A33:				; CODE XREF: .text:00412A25j
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp-14h]
		mov	[esp+8], eax
		mov	eax, [ebp-18h]
		mov	[esp+4], eax
		lea	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_40ED99
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_412AB9
		mov	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-20h]
		mov	dword ptr [esp+20h], 0
		mov	edx, [ebp-14h]
		mov	[esp+1Ch], edx
		mov	edx, off_422150
		mov	[esp+0Ch], edx
		mov	edx, off_422154
		mov	[esp+10h], edx
		mov	edx, off_422158
		mov	[esp+14h], edx
		mov	edx, off_42215C
		mov	[esp+18h], edx
		mov	edx, [ebp-18h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		lea	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_40F918
		mov	[ebp-10h], eax
		jmp	short loc_412ABA
; ---------------------------------------------------------------------------

loc_412AB9:				; CODE XREF: .text:00412A5Bj
		nop

loc_412ABA:				; CODE XREF: .text:00412A2Ej
					; .text:00412AB7j
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_412AEB
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_412AD3
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_40EF3E
		jmp	short loc_412AE4
; ---------------------------------------------------------------------------

loc_412AD3:				; CODE XREF: .text:00412AC4j
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jz	short loc_412AE4
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	_close

loc_412AE4:				; CODE XREF: .text:00412AD1j
					; .text:00412AD7j
		mov	dword ptr [ebp-1Ch], 0

loc_412AEB:				; CODE XREF: .text:00412ABEj
		mov	eax, [ebp-1Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_412B08
		cmp	dword ptr [ebp+10h], 40h
		jz	short loc_412B08
		cmp	dword ptr [ebp+10h], 4
		jnz	short loc_412B67

loc_412B08:				; CODE XREF: .text:00412AFAj
					; .text:00412B00j
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_412B1A
		cmp	dword ptr [ebp+14h], 0
		jnz	short loc_412B1A
		cmp	dword ptr [ebp+10h], 4
		jnz	short loc_412B67

loc_412B1A:				; CODE XREF: .text:00412B0Cj
					; .text:00412B12j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_410940
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		jmp	short loc_412B7B
; ---------------------------------------------------------------------------

loc_412B67:				; CODE XREF: .text:00412B06j
					; .text:00412B18j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh

loc_412B7B:				; CODE XREF: .text:00412B65j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_412BA7
		mov	eax, 0
		jmp	short loc_412BAC
; ---------------------------------------------------------------------------

loc_412BA7:				; CODE XREF: .text:00412B9Ej
		mov	eax, 4

loc_412BAC:				; CODE XREF: .text:00412BA5j
		mov	dword ptr [esp+0Ch], 200h
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_410940
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_410ADA
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		lea	eax, [ebp-4]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_410ADA
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_412C77(int, char *, int)
sub_412C77	proc near		; CODE XREF: .text:00410C18p
					; .text:004115B3p ...

Dest		= dword	ptr -28h
Source		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		test	eax, eax
		jz	short loc_412CC7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		and	eax, 20h
		test	al, al
		jnz	short loc_412CC7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	[esp+28h+Dest],	eax ; void *
		call	sub_40E521
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+220h], 0

loc_412CC7:				; CODE XREF: sub_412C77+16j
					; sub_412C77+2Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		test	eax, eax
		jnz	loc_412D73
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Bh
		jz	short loc_412CEE
		mov	[ebp+arg_8], 0
		jmp	short loc_412CFB
; ---------------------------------------------------------------------------

loc_412CEE:				; CODE XREF: sub_412C77+6Cj
		cmp	[ebp+arg_8], 0
		setnz	al
		movzx	eax, al
		mov	[ebp+arg_8], eax

loc_412CFB:				; CODE XREF: sub_412C77+75j
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+24h]
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_8]
		add	eax, edx
		add	eax, 1
		mov	[esp+28h+Dest],	eax ; size_t
		call	sub_40E4D7
		mov	[ebx+220h], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_412D74
		cmp	[ebp+arg_8], 0
		jz	short loc_412D51
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	byte ptr [eax],	5Ch

loc_412D51:				; CODE XREF: sub_412C77+C9j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [eax+220h]
		mov	eax, [ebp+arg_8]
		add	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Source], eax ;	Source
		mov	[esp+28h+Dest],	edx ; Dest
		call	strcpy
		jmp	short loc_412D74
; ---------------------------------------------------------------------------

loc_412D73:				; CODE XREF: sub_412C77+5Ej
		nop

loc_412D74:				; CODE XREF: sub_412C77+C3j
					; sub_412C77+FAj
		add	esp, 20h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_412C77	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short locret_412DC9
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_412C77
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8

locret_412DC9:				; CODE XREF: .text:00412D85j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	[ebp-4], eax
		cmp	dword ptr [ebp-4], 0
		jz	short loc_412E10
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		or	edx, 20h
		mov	[eax+250h], dl

loc_412E10:				; CODE XREF: .text:00412DF8j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		cmp	dword ptr [ebp-4], 0
		jnz	short loc_412E31
		mov	dword ptr [ebp-4], offset a?_0 ; "[?]"

loc_412E31:				; CODE XREF: .text:00412E28j
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_412E36(int, int, int,	char *,	int)
sub_412E36	proc near		; CODE XREF: .text:004134F7p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+Str], eax
		call	sub_40E4C8
		jmp	loc_4131CC
; ---------------------------------------------------------------------------

loc_412E62:				; CODE XREF: sub_412E36+39Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_412EAA
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_412EAA
		cmp	[ebp+arg_C], 0
		jz	loc_41315B
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jnz	short loc_412EAA
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_41315B

loc_412EAA:				; CODE XREF: sub_412E36+34j
					; sub_412E36+3Ej ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_412EE3
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_412EE3
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	5Ch
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_412EF6
; ---------------------------------------------------------------------------

loc_412EE3:				; CODE XREF: sub_412E36+80j
					; sub_412E36+90j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 5Ch
		call	sub_411CEE

loc_412EF6:				; CODE XREF: sub_412E36+ABj
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_412F59
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_412F3D
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_412F3D
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	6Eh
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_412F50
; ---------------------------------------------------------------------------

loc_412F3D:				; CODE XREF: sub_412E36+DAj
					; sub_412E36+EAj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 6Eh
		call	sub_411CEE

loc_412F50:				; CODE XREF: sub_412E36+105j
		add	[ebp+var_10], 1
		jmp	loc_4131C0
; ---------------------------------------------------------------------------

loc_412F59:				; CODE XREF: sub_412E36+CCj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_412FB8
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_412F9C
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_412F9C
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	72h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_412FAF
; ---------------------------------------------------------------------------

loc_412F9C:				; CODE XREF: sub_412E36+139j
					; sub_412E36+149j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 72h
		call	sub_411CEE

loc_412FAF:				; CODE XREF: sub_412E36+164j
		add	[ebp+var_10], 1
		jmp	loc_4131C0
; ---------------------------------------------------------------------------

loc_412FB8:				; CODE XREF: sub_412E36+12Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_413017
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_412FFB
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_412FFB
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	66h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_41300E
; ---------------------------------------------------------------------------

loc_412FFB:				; CODE XREF: sub_412E36+198j
					; sub_412E36+1A8j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 66h
		call	sub_411CEE

loc_41300E:				; CODE XREF: sub_412E36+1C3j
		add	[ebp+var_10], 1
		jmp	loc_4131C0
; ---------------------------------------------------------------------------

loc_413017:				; CODE XREF: sub_412E36+18Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_413076
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_41305A
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_41305A
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	76h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_41306D
; ---------------------------------------------------------------------------

loc_41305A:				; CODE XREF: sub_412E36+1F7j
					; sub_412E36+207j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 76h
		call	sub_411CEE

loc_41306D:				; CODE XREF: sub_412E36+222j
		add	[ebp+var_10], 1
		jmp	loc_4131C0
; ---------------------------------------------------------------------------

loc_413076:				; CODE XREF: sub_412E36+1E9j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_4130D5
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4130B9
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_4130B9
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	62h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_4130CC
; ---------------------------------------------------------------------------

loc_4130B9:				; CODE XREF: sub_412E36+256j
					; sub_412E36+266j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 62h
		call	sub_411CEE

loc_4130CC:				; CODE XREF: sub_412E36+281j
		add	[ebp+var_10], 1
		jmp	loc_4131C0
; ---------------------------------------------------------------------------

loc_4130D5:				; CODE XREF: sub_412E36+248j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_413134
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_413118
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_413118
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	30h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_41312B
; ---------------------------------------------------------------------------

loc_413118:				; CODE XREF: sub_412E36+2B5j
					; sub_412E36+2C5j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 30h
		call	sub_411CEE

loc_41312B:				; CODE XREF: sub_412E36+2E0j
		add	[ebp+var_10], 1
		jmp	loc_4131C0
; ---------------------------------------------------------------------------

loc_413134:				; CODE XREF: sub_412E36+2A7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "x%02x"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_4126CD
		add	[ebp+var_10], 3
		jmp	short loc_4131C0
; ---------------------------------------------------------------------------

loc_41315B:				; CODE XREF: sub_412E36+44j
					; sub_412E36+6Ej
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4131A4
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_4131A4
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_4131A4
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+var_C]
		movzx	edx, byte ptr [edx]
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_4131BC
; ---------------------------------------------------------------------------

loc_4131A4:				; CODE XREF: sub_412E36+331j
					; sub_412E36+341j ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Val], edx
		mov	[esp+28h+Str], eax
		call	sub_411CEE

loc_4131BC:				; CODE XREF: sub_412E36+36Cj
		add	[ebp+var_10], 1

loc_4131C0:				; CODE XREF: sub_412E36+11Ej
					; sub_412E36+17Dj ...
		sub	[ebp+arg_8], 1
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_4131CC:				; CODE XREF: sub_412E36+27j
		cmp	[ebp+arg_8], 0
		jnz	loc_412E62
		cmp	[ebp+arg_10], 0
		jz	short loc_4131E4
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_4131E4:				; CODE XREF: sub_412E36+3A4j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_41196D
		test	eax, eax
		jz	short loc_4131FA
		mov	eax, 0FFFFFFFFh
		jmp	short loc_4131FF
; ---------------------------------------------------------------------------

loc_4131FA:				; CODE XREF: sub_412E36+3BBj
		mov	eax, 0

loc_4131FF:				; CODE XREF: sub_412E36+3C2j
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+Str], eax
		call	sub_40E4C8
		mov	eax, [ebp+var_14]
		leave
		retn
sub_412E36	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_413238
		mov	eax, 0
		jmp	locret_413404
; ---------------------------------------------------------------------------

loc_413238:				; CODE XREF: .text:0041322Cj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	loc_4133B7
; ---------------------------------------------------------------------------

loc_413257:				; CODE XREF: .text:004133BBj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4132BE
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_4132BE
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		shr	dl, 4
		movzx	edx, dl
		and	edx, 0Fh
		cmp	edx, 9
		jg	short loc_4132A5
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		shr	dl, 4
		add	edx, 30h
		jmp	short loc_4132B1
; ---------------------------------------------------------------------------

loc_4132A5:				; CODE XREF: .text:00413295j
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		shr	dl, 4
		add	edx, 37h

loc_4132B1:				; CODE XREF: .text:004132A3j
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx
		jmp	short loc_413307
; ---------------------------------------------------------------------------

loc_4132BE:				; CODE XREF: .text:00413263j
					; .text:00413273j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_4132E6
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_4132F8
; ---------------------------------------------------------------------------

loc_4132E6:				; CODE XREF: .text:004132D0j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 37h

loc_4132F8:				; CODE XREF: .text:004132E4j
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_411CEE

loc_413307:				; CODE XREF: .text:004132BCj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_41336B
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_41336B
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		and	edx, 0Fh
		cmp	edx, 9
		jg	short loc_413352
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		and	edx, 0Fh
		add	edx, 30h
		jmp	short loc_41335E
; ---------------------------------------------------------------------------

loc_413352:				; CODE XREF: .text:00413342j
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		and	edx, 0Fh
		add	edx, 37h

loc_41335E:				; CODE XREF: .text:00413350j
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx
		jmp	short loc_4133AB
; ---------------------------------------------------------------------------

loc_41336B:				; CODE XREF: .text:00413313j
					; .text:00413323j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_41338D
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_41339C
; ---------------------------------------------------------------------------

loc_41338D:				; CODE XREF: .text:0041337Aj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 37h

loc_41339C:				; CODE XREF: .text:0041338Bj
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_411CEE

loc_4133AB:				; CODE XREF: .text:00413369j
		add	dword ptr [ebp-10h], 2
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp+10h], 1

loc_4133B7:				; CODE XREF: .text:00413252j
		cmp	dword ptr [ebp+10h], 0
		jnz	loc_413257
		cmp	dword ptr [ebp+18h], 0
		jz	short loc_4133CF
		mov	eax, [ebp+18h]
		mov	edx, [ebp-10h]
		mov	[eax], edx

loc_4133CF:				; CODE XREF: .text:004133C5j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41196D
		test	eax, eax
		jz	short loc_4133E5
		mov	eax, 0FFFFFFFFh
		jmp	short loc_4133EA
; ---------------------------------------------------------------------------

loc_4133E5:				; CODE XREF: .text:004133DCj
		mov	eax, 0

loc_4133EA:				; CODE XREF: .text:004133E3j
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40E4C8
		mov	eax, [ebp-14h]

locret_413404:				; CODE XREF: .text:00413233j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_41342F
; ---------------------------------------------------------------------------

loc_41341C:				; CODE XREF: .text:00413435j
		mov	eax, [ebp-0Ch]
		mov	edx, [ebp-10h]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_413439
		add	dword ptr [ebp-0Ch], 1

loc_41342F:				; CODE XREF: .text:0041341Aj
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jb	short loc_41341C
		jmp	short loc_41343A
; ---------------------------------------------------------------------------

loc_413439:				; CODE XREF: .text:00413429j
		nop

loc_41343A:				; CODE XREF: .text:00413437j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jnb	loc_4134D5
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_413457
		mov	eax, [ebp+14h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		jmp	short loc_41345C
; ---------------------------------------------------------------------------

loc_413457:				; CODE XREF: .text:0041344Aj
		mov	eax, 0

loc_41345C:				; CODE XREF: .text:00413455j
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_41F783
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp+18h], 0
		jz	short loc_4134A5
		mov	eax, [ebp-18h]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+18h]
		mov	[eax], edx

loc_4134A5:				; CODE XREF: .text:0041347Fj
		mov	eax, [ebp-18h]
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_4121D2
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_406E5D
		cmp	dword ptr [ebp-1Ch], 0FFFFFFFFh
		jz	short loc_4134D0
		mov	eax, [ebp-0Ch]
		jmp	short loc_4134D3
; ---------------------------------------------------------------------------

loc_4134D0:				; CODE XREF: .text:004134C9j
		mov	eax, [ebp-1Ch]

loc_4134D3:				; CODE XREF: .text:004134CEj
		jmp	short loc_4134FC
; ---------------------------------------------------------------------------

loc_4134D5:				; CODE XREF: .text:00413440j
		mov	eax, [ebp-10h]
		mov	edx, [ebp+18h]
		mov	[esp+10h], edx
		mov	edx, [ebp+14h]
		mov	[esp+0Ch], edx
		mov	edx, [ebp+10h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_412E36

loc_4134FC:				; CODE XREF: .text:loc_4134D3j
		add	esp, 54h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_413504(char *, int)
sub_413504	proc near		; CODE XREF: sub_41365B+14p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Str1		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+Str], offset aYes ; "yes"
		call	sub_419D7C
		mov	[ebp+Str1], eax
		mov	[esp+28h+Str], offset aYy ; "yY"
		call	sub_419D7C
		mov	[ebp+var_10], eax
		mov	[esp+28h+Str], offset aNo ; "no"
		call	sub_419D7C
		mov	[ebp+var_14], eax
		mov	[esp+28h+Str], offset aNn ; "nN"
		call	sub_419D7C
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax ; char *
		mov	eax, [ebp+Str1]
		mov	[esp+28h+Str], eax ; Str1
		call	sub_413F38
		test	eax, eax
		jz	short loc_413566
		mov	eax, 1
		jmp	locret_413659
; ---------------------------------------------------------------------------

loc_413566:				; CODE XREF: sub_413504+56j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4135A3
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_4135A3
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4135A3
		mov	eax, 1
		jmp	locret_413659
; ---------------------------------------------------------------------------

loc_4135A3:				; CODE XREF: sub_413504+6Aj
					; sub_413504+86j ...
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax ; char *
		mov	eax, [ebp+var_14]
		mov	[esp+28h+Str], eax ; Str1
		call	sub_413F38
		test	eax, eax
		jz	short loc_4135C3
		mov	eax, 0
		jmp	locret_413659
; ---------------------------------------------------------------------------

loc_4135C3:				; CODE XREF: sub_413504+B3j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4135FD
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+var_18]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_4135FD
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4135FD
		mov	eax, 0
		jmp	short locret_413659
; ---------------------------------------------------------------------------

loc_4135FD:				; CODE XREF: sub_413504+C7j
					; sub_413504+E3j ...
		mov	[esp+28h+Val], offset aYes ; "yes"
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_41BA69
		test	eax, eax
		jnz	short loc_41361B
		mov	eax, 1
		jmp	short locret_413659
; ---------------------------------------------------------------------------

loc_41361B:				; CODE XREF: sub_413504+10Ej
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_413656
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	[esp+28h+Str], offset aYy ; "yY"
		call	strchr
		test	eax, eax
		jz	short loc_413656
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_413656
		mov	eax, 1
		jmp	short locret_413659
; ---------------------------------------------------------------------------

loc_413656:				; CODE XREF: sub_413504+11Fj
					; sub_413504+13Cj ...
		mov	eax, [ebp+arg_4]

locret_413659:				; CODE XREF: sub_413504+5Dj
					; sub_413504+9Aj ...
		leave
		retn
sub_413504	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41365B(char *)
sub_41365B	proc near		; CODE XREF: .text:0040B745p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_14], 0 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_413504
		leave
		retn
sub_41365B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	dword ptr [esp], offset	aYes ; "yes"
		call	sub_419D7C
		mov	[ebp-0Ch], eax
		mov	dword ptr [esp], offset	aNo ; "no"
		call	sub_419D7C
		mov	[ebp-10h], eax
		mov	dword ptr [esp], offset	aQuit ;	"quit"
		call	sub_419D7C
		mov	[ebp-14h], eax
		mov	dword ptr [esp], offset	aYy ; "yY"
		call	sub_419D7C
		mov	[ebp-18h], eax
		mov	dword ptr [esp], offset	aNn ; "nN"
		call	sub_419D7C
		mov	[ebp-1Ch], eax
		mov	dword ptr [esp], offset	aQq ; "qQ"
		call	sub_419D7C
		mov	[ebp-20h], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_413F38
		test	eax, eax
		jz	short loc_4136F6
		mov	eax, 0
		jmp	locret_4138A7
; ---------------------------------------------------------------------------

loc_4136F6:				; CODE XREF: .text:004136EAj
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_413F38
		test	eax, eax
		jz	short loc_413716
		mov	eax, 1
		jmp	locret_4138A7
; ---------------------------------------------------------------------------

loc_413716:				; CODE XREF: .text:0041370Aj
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_413F38
		test	eax, eax
		jz	short loc_413736
		mov	eax, 0FFFFFFFFh
		jmp	locret_4138A7
; ---------------------------------------------------------------------------

loc_413736:				; CODE XREF: .text:0041372Aj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_413773
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+4], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	strchr
		test	eax, eax
		jz	short loc_413773
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_413773
		mov	eax, 0
		jmp	locret_4138A7
; ---------------------------------------------------------------------------

loc_413773:				; CODE XREF: .text:0041373Ej
					; .text:0041375Aj ...
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4137B0
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+4], eax
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	strchr
		test	eax, eax
		jz	short loc_4137B0
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4137B0
		mov	eax, 1
		jmp	locret_4138A7
; ---------------------------------------------------------------------------

loc_4137B0:				; CODE XREF: .text:0041377Bj
					; .text:00413797j ...
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4137ED
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+4], eax
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	strchr
		test	eax, eax
		jz	short loc_4137ED
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4137ED
		mov	eax, 0FFFFFFFFh
		jmp	locret_4138A7
; ---------------------------------------------------------------------------

loc_4137ED:				; CODE XREF: .text:004137B8j
					; .text:004137D4j ...
		mov	dword ptr [esp+4], offset aYes ; "yes"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41BA69
		test	eax, eax
		jnz	short loc_41380E
		mov	eax, 1
		jmp	locret_4138A7
; ---------------------------------------------------------------------------

loc_41380E:				; CODE XREF: .text:00413802j
		mov	dword ptr [esp+4], offset aQuit	; "quit"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41BA69
		test	eax, eax
		jnz	short loc_41382C
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4138A7
; ---------------------------------------------------------------------------

loc_41382C:				; CODE XREF: .text:00413823j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_413867
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aYy ; "yY"
		call	strchr
		test	eax, eax
		jz	short loc_413867
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_413867
		mov	eax, 1
		jmp	short locret_4138A7
; ---------------------------------------------------------------------------

loc_413867:				; CODE XREF: .text:00413834j
					; .text:00413851j ...
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4138A2
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aQq ; "qQ"
		call	strchr
		test	eax, eax
		jz	short loc_4138A2
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4138A2
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4138A7
; ---------------------------------------------------------------------------

loc_4138A2:				; CODE XREF: .text:0041386Fj
					; .text:0041388Cj ...
		mov	eax, 0

locret_4138A7:				; CODE XREF: .text:004136F1j
					; .text:00413711j ...
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp], offset	aOkayOkay ; "okay|okay"
		call	sub_419D7C
		mov	[ebp-0Ch], eax
		mov	dword ptr [esp], offset	aCancelCancel ;	"cancel|cancel"
		call	sub_419D7C
		mov	[ebp-10h], eax
		mov	dword ptr [esp], offset	aOo ; "oO"
		call	sub_419D7C
		mov	[ebp-14h], eax
		mov	dword ptr [esp], offset	aCc ; "cC"
		call	sub_419D7C
		mov	[ebp-18h], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_413F38
		test	eax, eax
		jz	short loc_41390B
		mov	eax, 1
		jmp	locret_413A7E
; ---------------------------------------------------------------------------

loc_41390B:				; CODE XREF: .text:004138FFj
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_413F38
		test	eax, eax
		jz	short loc_41392B
		mov	eax, 0
		jmp	locret_413A7E
; ---------------------------------------------------------------------------

loc_41392B:				; CODE XREF: .text:0041391Fj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_413968
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	strchr
		test	eax, eax
		jz	short loc_413968
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_413968
		mov	eax, 1
		jmp	locret_413A7E
; ---------------------------------------------------------------------------

loc_413968:				; CODE XREF: .text:00413933j
					; .text:0041394Fj ...
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4139A5
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+4], eax
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	strchr
		test	eax, eax
		jz	short loc_4139A5
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4139A5
		mov	eax, 0
		jmp	locret_413A7E
; ---------------------------------------------------------------------------

loc_4139A5:				; CODE XREF: .text:00413970j
					; .text:0041398Cj ...
		mov	dword ptr [esp+4], offset aOkay	; "okay"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41BA69
		test	eax, eax
		jnz	short loc_4139C6
		mov	eax, 1
		jmp	locret_413A7E
; ---------------------------------------------------------------------------

loc_4139C6:				; CODE XREF: .text:004139BAj
		mov	dword ptr [esp+4], offset aOk ;	"ok"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41BA69
		test	eax, eax
		jnz	short loc_4139E7
		mov	eax, 1
		jmp	locret_413A7E
; ---------------------------------------------------------------------------

loc_4139E7:				; CODE XREF: .text:004139DBj
		mov	dword ptr [esp+4], offset aCancel_0 ; "cancel"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41BA69
		test	eax, eax
		jnz	short loc_413A05
		mov	eax, 0
		jmp	short locret_413A7E
; ---------------------------------------------------------------------------

loc_413A05:				; CODE XREF: .text:004139FCj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_413A40
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aOo ; "oO"
		call	strchr
		test	eax, eax
		jz	short loc_413A40
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_413A40
		mov	eax, 1
		jmp	short locret_413A7E
; ---------------------------------------------------------------------------

loc_413A40:				; CODE XREF: .text:00413A0Dj
					; .text:00413A2Aj ...
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_413A7B
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aCc ; "cC"
		call	strchr
		test	eax, eax
		jz	short loc_413A7B
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_413A7B
		mov	eax, 0
		jmp	short locret_413A7E
; ---------------------------------------------------------------------------

loc_413A7B:				; CODE XREF: .text:00413A48j
					; .text:00413A65j ...
		mov	eax, [ebp+0Ch]

locret_413A7E:				; CODE XREF: .text:00413906j
					; .text:00413926j ...
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413A80	proc near		; CODE XREF: sub_413AA7+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_413AA0
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_413AA5
; ---------------------------------------------------------------------------

loc_413AA0:				; CODE XREF: sub_413A80+7j
		mov	eax, 0

loc_413AA5:				; CODE XREF: sub_413A80+1Ej
		pop	ebp
		retn
sub_413A80	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413AA7	proc near		; CODE XREF: sub_413AC2+Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_413A80
		leave
		retn
sub_413AA7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413AC2	proc near		; CODE XREF: .text:00413E62p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_413AA7
		leave
		retn
sub_413AC2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_413AD7(int, int, char	*, va_list)
sub_413AD7	proc near		; DATA XREF: .text:00413C07o

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		cmp	eax, 1Eh
		jz	short loc_413B26
		cmp	eax, 1Eh
		jg	short loc_413AFA
		cmp	eax, 0Ah
		jz	short loc_413B14
		cmp	eax, 14h
		jz	short loc_413B1D
		test	eax, eax
		jz	short loc_413B0B
		jmp	short loc_413B4A
; ---------------------------------------------------------------------------

loc_413AFA:				; CODE XREF: sub_413AD7+11j
		cmp	eax, 32h
		jz	short loc_413B38
		cmp	eax, 64h
		jz	short loc_413B41
		cmp	eax, 28h
		jz	short loc_413B2F
		jmp	short loc_413B4A
; ---------------------------------------------------------------------------

loc_413B0B:				; CODE XREF: sub_413AD7+1Fj
		mov	[ebp+arg_4], 1
		jmp	short loc_413B52
; ---------------------------------------------------------------------------

loc_413B14:				; CODE XREF: sub_413AD7+16j
		mov	[ebp+arg_4], 2
		jmp	short loc_413B52
; ---------------------------------------------------------------------------

loc_413B1D:				; CODE XREF: sub_413AD7+1Bj
		mov	[ebp+arg_4], 3
		jmp	short loc_413B52
; ---------------------------------------------------------------------------

loc_413B26:				; CODE XREF: sub_413AD7+Cj
		mov	[ebp+arg_4], 4
		jmp	short loc_413B52
; ---------------------------------------------------------------------------

loc_413B2F:				; CODE XREF: sub_413AD7+30j
		mov	[ebp+arg_4], 5
		jmp	short loc_413B52
; ---------------------------------------------------------------------------

loc_413B38:				; CODE XREF: sub_413AD7+26j
		mov	[ebp+arg_4], 6
		jmp	short loc_413B52
; ---------------------------------------------------------------------------

loc_413B41:				; CODE XREF: sub_413AD7+2Bj
		mov	[ebp+arg_4], 7
		jmp	short loc_413B52
; ---------------------------------------------------------------------------

loc_413B4A:				; CODE XREF: sub_413AD7+21j
					; sub_413AD7+32j
		mov	[ebp+arg_4], 4
		nop

loc_413B52:				; CODE XREF: sub_413AD7+3Bj
					; sub_413AD7+44j ...
		mov	eax, [ebp+arg_C]
		mov	[esp+18h+var_10], eax ;	va_list
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_14], eax ;	char *
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_41A61A
		leave
		retn
sub_413AD7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_413B6D	proc near		; DATA XREF: .text:00413C1Bo

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_8], 0
		jnz	short loc_413B86
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax
		call	gpg_strerror
		jmp	short loc_413B89
; ---------------------------------------------------------------------------

loc_413B86:				; CODE XREF: sub_413B6D+Aj
		mov	eax, [ebp+arg_8]

loc_413B89:				; CODE XREF: sub_413B6D+17j
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aLibgcryptProbl ; "libgcrypt problem: %s\n"
		call	sub_41A6A8
sub_413B6D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413B99	proc near		; DATA XREF: .text:00413C2Fo

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_428A44
		test	eax, eax
		jnz	short loc_413BF2
		mov	ds:dword_428A44, 1
		mov	eax, [ebp+arg_8]
		and	eax, 1
		test	al, al
		jz	short loc_413BD7
		mov	[esp+18h+var_18], offset aOutOfCoreInSec ; "out	of core	in secure memory while allo"...
		call	sub_419D7C
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+18h+var_14], edx	; char
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_41A6A8
; ---------------------------------------------------------------------------

loc_413BD7:				; CODE XREF: sub_413B99+21j
		mov	[esp+18h+var_18], offset aOutOfCoreWhile ; "out	of core	while allocating %lu bytes"
		call	sub_419D7C
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+18h+var_14], edx	; char
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_41A6A8
; ---------------------------------------------------------------------------

loc_413BF2:				; CODE XREF: sub_413B99+Dj
		mov	eax, 0
		leave
		retn
sub_413B99	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp], offset	sub_413AD7
		call	sub_406E8A
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp], offset	sub_413B6D
		call	sub_406E85
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp], offset	sub_413B99
		call	sub_406E80
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_413C5D
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_413C64
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_413C64

loc_413C5D:				; CODE XREF: .text:00413C44j
		mov	eax, offset aStdout_0 ;	"[stdout]"
		jmp	short loc_413C67
; ---------------------------------------------------------------------------

loc_413C64:				; CODE XREF: .text:00413C4Ej
					; .text:00413C5Bj
		mov	eax, [ebp+8]

loc_413C67:				; CODE XREF: .text:00413C62j
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_413C89
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_413C90
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_413C90

loc_413C89:				; CODE XREF: .text:00413C70j
		mov	eax, offset aStdin_0 ; "[stdin]"
		jmp	short loc_413C93
; ---------------------------------------------------------------------------

loc_413C90:				; CODE XREF: .text:00413C7Aj
					; .text:00413C87j
		mov	eax, [ebp+8]

loc_413C93:				; CODE XREF: .text:00413C8Ej
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41B570
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413CBD	proc near		; CODE XREF: .text:00413D07p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_C]
		mov	[esp+18h+var_C], eax ; int
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	FILE *
		call	sub_41B5A0
		leave
		retn
sub_413CBD	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_413CBD
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	loc_413DB0
; ---------------------------------------------------------------------------

loc_413D1F:				; CODE XREF: .text:00413DB4j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_413D47
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_413D59
; ---------------------------------------------------------------------------

loc_413D47:				; CODE XREF: .text:00413D31j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 37h

loc_413D59:				; CODE XREF: .text:00413D45j
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	putc
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_413D8A
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_413D99
; ---------------------------------------------------------------------------

loc_413D8A:				; CODE XREF: .text:00413D77j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 37h

loc_413D99:				; CODE XREF: .text:00413D88j
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	putc
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp+10h], 1

loc_413DB0:				; CODE XREF: .text:00413D1Aj
		cmp	dword ptr [ebp+10h], 0
		jnz	loc_413D1F
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41B76B
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	dword ptr [ebp-10h], 0
		mov	dword ptr [ebp-34h], 3
		mov	byte ptr [ebp-30h], 42h
		mov	byte ptr [ebp-2Fh], 5Ah
		mov	byte ptr [ebp-2Eh], 68h
		mov	byte ptr [ebp-2Dh], 0
		mov	dword ptr [ebp-2Ch], 3
		mov	byte ptr [ebp-28h], 1Fh
		mov	byte ptr [ebp-27h], 8Bh
		mov	byte ptr [ebp-26h], 8
		mov	byte ptr [ebp-25h], 0
		mov	dword ptr [ebp-24h], 4
		mov	byte ptr [ebp-20h], 50h
		mov	byte ptr [ebp-1Fh], 4Bh
		mov	byte ptr [ebp-1Eh], 3
		mov	byte ptr [ebp-1Dh], 4
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_415A56
		test	eax, eax
		jnz	short loc_413E44
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_413E4E

loc_413E44:				; CODE XREF: .text:00413E3Cj
		mov	eax, 0
		jmp	locret_413F36
; ---------------------------------------------------------------------------

loc_413E4E:				; CODE XREF: .text:00413E42j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_415AE9
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jnz	short loc_413E78
		call	sub_413AC2
		mov	edx, eax
		mov	eax, [ebp+0Ch]
		mov	[eax], edx
		mov	eax, 0
		jmp	locret_413F36
; ---------------------------------------------------------------------------

loc_413E78:				; CODE XREF: .text:00413E60j
		lea	eax, [ebp-1Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_417994
		test	edx, edx
		jg	short loc_413EA9
		test	edx, edx
		js	short loc_413E97
		cmp	eax, 3
		ja	short loc_413EA9

loc_413E97:				; CODE XREF: .text:00413E90j
		mov	eax, [ebp-1Ch]
		test	eax, eax
		jnz	short loc_413EA9
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0
		jmp	short loc_413F28
; ---------------------------------------------------------------------------

loc_413EA9:				; CODE XREF: .text:00413E8Cj
					; .text:00413E95j ...
		mov	dword ptr [esp+8], 4
		lea	eax, [ebp-18h]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_417407
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_413ED5
		mov	eax, [ebp-14h]
		mov	edx, [eax+3Ch]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx
		jmp	short loc_413F28
; ---------------------------------------------------------------------------

loc_413ED5:				; CODE XREF: .text:00413EC6j
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_413F20
; ---------------------------------------------------------------------------

loc_413EDE:				; CODE XREF: .text:00413F26j
		mov	eax, [ebp-0Ch]
		mov	eax, [ebp+eax*8-34h]
		lea	edx, [ebp-34h]
		mov	ecx, [ebp-0Ch]
		shl	ecx, 3
		add	edx, ecx
		add	edx, 4
		mov	[esp+8], eax
		mov	[esp+4], edx
		lea	eax, [ebp-18h]
		mov	[esp], eax
		call	memcmp
		test	eax, eax
		jnz	short loc_413F1C
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0
		mov	dword ptr [ebp-10h], 1
		jmp	short loc_413F28
; ---------------------------------------------------------------------------

loc_413F1C:				; CODE XREF: .text:00413F08j
		add	dword ptr [ebp-0Ch], 1

loc_413F20:				; CODE XREF: .text:00413EDCj
		mov	eax, [ebp-0Ch]
		cmp	eax, 2
		jbe	short loc_413EDE

loc_413F28:				; CODE XREF: .text:00413EA7j
					; .text:00413ED3j ...
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_4156D1
		mov	eax, [ebp-10h]

locret_413F36:				; CODE XREF: .text:00413E49j
					; .text:00413E73j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_413F38(char *Str1, char *)
sub_413F38	proc near		; CODE XREF: sub_413504+4Fp
					; sub_413504+ACp ...

Str		= dword	ptr -28h
Control		= dword	ptr -24h
MaxCount	= dword	ptr -20h
var_C		= dword	ptr -0Ch
Str1		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h

loc_413F3E:				; CODE XREF: sub_413F38+64j
		mov	[esp+28h+Control], offset asc_425708 ; "|"
		mov	eax, [ebp+Str1]
		mov	[esp+28h+Str], eax ; Str
		call	strcspn
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_413FA0
		mov	eax, [ebp+var_C]
		mov	[esp+28h+MaxCount], eax	; MaxCount
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Control], eax ; Str
		mov	eax, [ebp+Str1]
		mov	[esp+28h+Str], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_413F80
		mov	eax, 1
		jmp	short locret_413FA6
; ---------------------------------------------------------------------------

loc_413F80:				; CODE XREF: sub_413F38+3Fj
		mov	eax, [ebp+var_C]
		add	[ebp+Str1], eax
		mov	eax, [ebp+Str1]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_413F94
		add	[ebp+Str1], 1

loc_413F94:				; CODE XREF: sub_413F38+56j
		mov	eax, [ebp+Str1]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_413F3E
		jmp	short loc_413FA1
; ---------------------------------------------------------------------------

loc_413FA0:				; CODE XREF: sub_413F38+20j
		nop

loc_413FA1:				; CODE XREF: sub_413F38+66j
		mov	eax, 0

locret_413FA6:				; CODE XREF: sub_413F38+46j
		leave
		retn
sub_413F38	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413FA8	proc near		; CODE XREF: sub_413FCF+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_413FC8
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_413FCD
; ---------------------------------------------------------------------------

loc_413FC8:				; CODE XREF: sub_413FA8+7j
		mov	eax, 0

loc_413FCD:				; CODE XREF: sub_413FA8+1Ej
		pop	ebp
		retn
sub_413FA8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413FCF	proc near		; CODE XREF: sub_413FEA+14p
					; sub_414005+Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_413FA8
		leave
		retn
sub_413FCF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413FEA	proc near		; CODE XREF: sub_414578+C3p
					; sub_414578+17Ep ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gpg_err_code_from_errno
		mov	[esp+18h+var_18], eax
		call	sub_413FCF
		leave
		retn
sub_413FEA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414005	proc near		; CODE XREF: sub_414A2D+73Cp
					; sub_414A2D+78Bp ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_413FCF
		leave
		retn
sub_414005	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41401A(LPCSTR)
sub_41401A	proc near		; CODE XREF: sub_417994+CFp

lpLibFileName	= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+lpLibFileName], eax ; lpLibFileName
		mov	eax, ds:LoadLibraryA
		call	eax ; LoadLibraryA
		sub	esp, 4
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41401A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_414038(HMODULE, LPCSTR)
sub_414038	proc near		; CODE XREF: sub_417994+EBp

hModule		= dword	ptr -28h
lpProcName	= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_414076
		cmp	[ebp+arg_4], 0
		jz	short loc_414076
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lpProcName], eax ; lpProcName
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hModule], eax ; hModule
		mov	eax, ds:GetProcAddress
		call	eax ; GetProcAddress
		sub	esp, 8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_414071
		mov	eax, 0
		jmp	short locret_41407B
; ---------------------------------------------------------------------------

loc_414071:				; CODE XREF: sub_414038+30j
		mov	eax, [ebp+var_C]
		jmp	short locret_41407B
; ---------------------------------------------------------------------------

loc_414076:				; CODE XREF: sub_414038+Aj
					; sub_414038+10j
		mov	eax, 0

locret_41407B:				; CODE XREF: sub_414038+37j
					; sub_414038+3Cj
		leave
		retn
sub_414038	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41407D(HANDLE)
sub_41407D	proc near		; CODE XREF: sub_417994+104p

hObject		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_4140A0
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		jmp	short locret_4140A5
; ---------------------------------------------------------------------------

loc_4140A0:				; CODE XREF: sub_41407D+Aj
		mov	eax, 0FFFFFFFFh

locret_4140A5:				; CODE XREF: sub_41407D+21j
		leave
		retn
sub_41407D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4140A7	proc near		; CODE XREF: sub_41411A+70p
					; sub_4142EA+93p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		jmp	short loc_4140EC
; ---------------------------------------------------------------------------

loc_4140AC:				; CODE XREF: sub_4140A7+57j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4140E4
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4140D0
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_4140E4

loc_4140D0:				; CODE XREF: sub_4140A7+1Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_414100
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_414100

loc_4140E4:				; CODE XREF: sub_4140A7+13j
					; sub_4140A7+27j
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_4140EC:				; CODE XREF: sub_4140A7+3j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_414100
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4140AC

loc_414100:				; CODE XREF: sub_4140A7+31j
					; sub_4140A7+3Bj ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		pop	ebp
		retn
sub_4140A7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41411A	proc near		; CODE XREF: sub_4141FF+23p
					; sub_4141FF+6Ap ...

hObject		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		cmp	dword ptr [ebp+arg_0], 0
		jnz	short loc_414149
		mov	[esp+28h+var_20], 0E2h ; int
		mov	[esp+28h+var_24], offset a____Gnupg22__3 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+28h+hObject], offset aFname ; "fname"
		call	sub_421040

loc_414149:				; CODE XREF: sub_41411A+11j
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_414165
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+28h+var_24], eax ;	char
		mov	[esp+28h+hObject], offset aFd_cache_inval ; "fd_cache_invalidate (%s)\n"
		call	sub_41A702

loc_414165:				; CODE XREF: sub_41411A+36j
		mov	eax, ds:dword_428A48
		mov	[ebp+var_C], eax
		jmp	short loc_4141E2
; ---------------------------------------------------------------------------

loc_41416F:				; CODE XREF: sub_41411A+CCj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_4141DA
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+hObject], edx
		call	sub_4140A7
		test	eax, eax
		jnz	short loc_4141DA
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_4141B2
		mov	eax, [ebp+var_C]
		add	eax, 8
		mov	[esp+28h+var_24], eax ;	char
		mov	[esp+28h+hObject], offset aDidS	; "		   did (%s)\n"
		call	sub_41A702

loc_4141B2:				; CODE XREF: sub_41411A+80j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+28h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		test	eax, eax
		jnz	short loc_4141D0
		mov	[ebp+var_10], 0FFFFFFFFh

loc_4141D0:				; CODE XREF: sub_41411A+ADj
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4], 0FFFFFFFFh

loc_4141DA:				; CODE XREF: sub_41411A+5Ej
					; sub_41411A+77j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_4141E2:				; CODE XREF: sub_41411A+53j
		cmp	[ebp+var_C], 0
		jnz	short loc_41416F
		mov	eax, [ebp+var_10]
		leave
		retn
sub_41411A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4141ED	proc near		; CODE XREF: sub_4162A4+2A2p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		mov	eax, [ebp+var_4]
		leave
		retn
sub_4141ED	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4141FF(LPCSTR	lpFileName, char *)
sub_4141FF	proc near		; CODE XREF: sub_41444F+122p
					; .text:00415FEDp ...

Str		= dword	ptr -38h
Val		= dword	ptr -34h
dwShareMode	= dword	ptr -30h
lpSecurityAttributes= dword ptr	-2Ch
dwCreationDisposition= dword ptr -28h
dwFlagsAndAttributes= dword ptr	-24h
hTemplateFile	= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
dwDesiredAccess	= dword	ptr -0Ch
lpFileName	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+Val], 2Bh ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_41424C
		mov	eax, [ebp+lpFileName]
		mov	[esp+38h+Str], eax
		call	sub_41411A
		test	eax, eax
		jz	short loc_414235
		mov	eax, 0FFFFFFFFh
		jmp	locret_4142E8
; ---------------------------------------------------------------------------

loc_414235:				; CODE XREF: sub_4141FF+2Aj
		mov	[ebp+dwDesiredAccess], 0C0000000h
		mov	[ebp+var_10], 3
		mov	[ebp+var_14], 3
		jmp	short loc_4142A5
; ---------------------------------------------------------------------------

loc_41424C:				; CODE XREF: sub_4141FF+1Bj
		mov	[esp+38h+Val], 77h ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_414290
		mov	eax, [ebp+lpFileName]
		mov	[esp+38h+Str], eax
		call	sub_41411A
		test	eax, eax
		jz	short loc_414279
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4142E8
; ---------------------------------------------------------------------------

loc_414279:				; CODE XREF: sub_4141FF+71j
		mov	[ebp+dwDesiredAccess], 40000000h
		mov	[ebp+var_10], 2
		mov	[ebp+var_14], 2
		jmp	short loc_4142A5
; ---------------------------------------------------------------------------

loc_414290:				; CODE XREF: sub_4141FF+62j
		mov	[ebp+dwDesiredAccess], 80000000h
		mov	[ebp+var_10], 3
		mov	[ebp+var_14], 1

loc_4142A5:				; CODE XREF: sub_4141FF+4Bj
					; sub_4141FF+8Fj
		mov	[esp+38h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+38h+dwFlagsAndAttributes],	80h ; dwFlagsAndAttributes
		mov	eax, [ebp+var_10]
		mov	[esp+38h+dwCreationDisposition], eax ; dwCreationDisposition
		mov	[esp+38h+lpSecurityAttributes],	0 ; lpSecurityAttributes
		mov	eax, [ebp+var_14]
		mov	[esp+38h+dwShareMode], eax ; dwShareMode
		mov	eax, [ebp+dwDesiredAccess]
		mov	[esp+38h+Val], eax ; dwDesiredAccess
		mov	eax, [ebp+lpFileName]
		mov	[esp+38h+Str], eax ; lpFileName
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]

locret_4142E8:				; CODE XREF: sub_4141FF+31j
					; sub_4141FF+78j
		leave
		retn
sub_4141FF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4142EA(char *, HANDLE)
sub_4142EA	proc near		; CODE XREF: sub_414578+297p

hObject		= dword	ptr -38h
Source		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	[ebp+arg_4], 0
		jnz	short loc_414313
		mov	[esp+38h+var_30], 174h ; int
		mov	[esp+38h+Source], offset a____Gnupg22__3 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+38h+hObject], offset aFp ;	"fp"
		call	sub_421040

loc_414313:				; CODE XREF: sub_4142EA+Bj
		cmp	[ebp+arg_0], 0
		jz	short loc_414323
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_414358

loc_414323:				; CODE XREF: sub_4142EA+2Dj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	loc_414446
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Source], eax ;	char
		mov	[esp+38h+hObject], offset aFd_cache_close ; "fd_cache_close (%d) real\n"
		call	sub_41A702
		jmp	loc_414446
; ---------------------------------------------------------------------------

loc_414358:				; CODE XREF: sub_4142EA+37j
		mov	eax, ds:dword_428A48
		mov	[ebp+var_C], eax
		jmp	short loc_4143BC
; ---------------------------------------------------------------------------

loc_414362:				; CODE XREF: sub_4142EA+D6j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_4143B4
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax
		mov	[esp+38h+hObject], edx
		call	sub_4140A7
		test	eax, eax
		jnz	short loc_4143B4
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	loc_414449
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax ;	char
		mov	[esp+38h+hObject], offset aFd_cache_clo_0 ; "fd_cache_close (%s) used existing slot\"...
		call	sub_41A702
		jmp	loc_414449
; ---------------------------------------------------------------------------

loc_4143B4:				; CODE XREF: sub_4142EA+81j
					; sub_4142EA+9Aj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_4143BC:				; CODE XREF: sub_4142EA+76j
		cmp	[ebp+var_C], 0
		jnz	short loc_414362
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_4143DE
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax ;	char
		mov	[esp+38h+hObject], offset aFd_cache_clo_1 ; "fd_cache_close (%s) new slot created\n"
		call	sub_41A702

loc_4143DE:				; CODE XREF: sub_4142EA+DFj
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 0Ch
		mov	[esp+38h+Source], eax ;	size_t
		mov	[esp+38h+hObject], 1 ; size_t
		call	sub_406DD8
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax ;	Source
		mov	[esp+38h+hObject], edx ; Dest
		call	strcpy
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	edx, ds:dword_428A48
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	ds:dword_428A48, eax
		jmp	short loc_41444A
; ---------------------------------------------------------------------------

loc_414446:				; CODE XREF: sub_4142EA+50j
					; sub_4142EA+69j
		nop
		jmp	short loc_41444A
; ---------------------------------------------------------------------------

loc_414449:				; CODE XREF: sub_4142EA+ACj
					; sub_4142EA+C5j
		nop

loc_41444A:				; CODE XREF: sub_4142EA+15Aj
					; sub_4142EA+15Dj
		mov	edi, [ebp+var_4]
		leave
		retn
sub_4142EA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41444F(LPCSTR	lpFileName, char *)
sub_41444F	proc near		; CODE XREF: sub_415AE9+A0p

hFile		= dword	ptr -28h
lDistanceToMove	= dword	ptr -24h
lpDistanceToMoveHigh= dword ptr	-20h
dwMoveMethod	= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
lpFileName	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+lpFileName], 0
		jnz	short loc_414477
		mov	[esp+28h+lpDistanceToMoveHigh],	19Dh ; int
		mov	[esp+28h+lDistanceToMove], offset a____Gnupg22__3 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+28h+hFile], offset	aFname ; "fname"
		call	sub_421040

loc_414477:				; CODE XREF: sub_41444F+Aj
		mov	eax, ds:dword_428A48
		mov	[ebp+var_C], eax
		jmp	loc_41453E
; ---------------------------------------------------------------------------

loc_414484:				; CODE XREF: sub_41444F+F3j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jz	loc_414536
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+lpFileName]
		mov	[esp+28h+lDistanceToMove], eax
		mov	[esp+28h+hFile], edx
		call	sub_4140A7
		test	eax, eax
		jnz	loc_414536
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4], 0FFFFFFFFh
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_4144DF
		mov	eax, [ebp+lpFileName]
		mov	[esp+28h+lDistanceToMove], eax ; char
		mov	[esp+28h+hFile], offset	aFd_cache_openS	; "fd_cache_open (%s) using cached fp\n"
		call	sub_41A702

loc_4144DF:				; CODE XREF: sub_41444F+7Bj
		mov	[esp+28h+dwMoveMethod],	0 ; dwMoveMethod
		mov	[esp+28h+lpDistanceToMoveHigh],	0 ; lpDistanceToMoveHigh
		mov	[esp+28h+lDistanceToMove], 0 ; lDistanceToMove
		mov	eax, [ebp+var_10]
		mov	[esp+28h+hFile], eax ; hFile
		mov	eax, ds:SetFilePointer
		call	eax ; SetFilePointer
		sub	esp, 10h
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_414531
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+28h+lpDistanceToMoveHigh],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+lDistanceToMove], eax ; char
		mov	[esp+28h+hFile], offset	aRewindFileFail	; "rewind file failed on handle	%p: ec=%d\"...
		call	sub_41A665
		mov	[ebp+var_10], 0FFFFFFFFh

loc_414531:				; CODE XREF: sub_41444F+BBj
		mov	eax, [ebp+var_10]
		jmp	short locret_414576
; ---------------------------------------------------------------------------

loc_414536:				; CODE XREF: sub_41444F+3Ej
					; sub_41444F+5Bj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_41453E:				; CODE XREF: sub_41444F+30j
		cmp	[ebp+var_C], 0
		jnz	loc_414484
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_414564
		mov	eax, [ebp+lpFileName]
		mov	[esp+28h+lDistanceToMove], eax ; char
		mov	[esp+28h+hFile], offset	aFd_cache_ope_0	; "fd_cache_open (%s) not cached\n"
		call	sub_41A702

loc_414564:				; CODE XREF: sub_41444F+100j
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lDistanceToMove], eax ; char *
		mov	eax, [ebp+lpFileName]
		mov	[esp+28h+hFile], eax ; lpFileName
		call	sub_4141FF

locret_414576:				; CODE XREF: sub_41444F+E5j
		leave
		retn
sub_41444F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_414578(int, int, int,	LPVOID,	int)
sub_414578	proc near		; CODE XREF: sub_415AE9+175p
					; sub_415AE9+19Fp ...

hFile		= dword	ptr -58h
lpBuffer	= dword	ptr -54h
nNumberOfBytesToRead= dword ptr	-50h
lpNumberOfBytesRead= dword ptr -4Ch
lpOverlapped	= dword	ptr -48h
NumberOfBytesWritten= dword ptr	-30h
NumberOfBytesRead= dword ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
nNumberOfBytesToWrite= dword ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	[ebp+var_20], eax
		mov	[ebp+nNumberOfBytesToWrite], 0
		mov	[ebp+var_10], 0
		cmp	[ebp+arg_4], 3
		jnz	loc_41468F
		cmp	[ebp+var_20], 0
		jnz	short loc_4145CE
		mov	[esp+58h+nNumberOfBytesToRead],	226h ; int
		mov	[esp+58h+lpBuffer], offset a____Gnupg22__3 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+58h+hFile], offset	aSize ;	"size"
		call	sub_421040

loc_4145CE:				; CODE XREF: sub_414578+38j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_4145ED
		mov	[ebp+var_10], 0FFFFFFFFh
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		jmp	loc_41481F
; ---------------------------------------------------------------------------

loc_4145ED:				; CODE XREF: sub_414578+5Ej
		mov	[ebp+nNumberOfBytesToWrite], 0
		mov	[esp+58h+lpOverlapped],	0 ; lpOverlapped
		lea	eax, [ebp+NumberOfBytesRead]
		mov	[esp+58h+lpNumberOfBytesRead], eax ; lpNumberOfBytesRead
		mov	eax, [ebp+var_20]
		mov	[esp+58h+nNumberOfBytesToRead],	eax ; nNumberOfBytesToRead
		mov	eax, [ebp+arg_C]
		mov	[esp+58h+lpBuffer], eax	; lpBuffer
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+hFile], eax ; hFile
		mov	eax, ds:ReadFile
		call	eax ; ReadFile
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_414662
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 6Dh
		jz	short loc_414682
		mov	eax, [ebp+var_24]
		mov	[esp+58h+hFile], eax
		call	sub_413FEA
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_18]
		lea	edx, [eax+14h]
		mov	eax, [ebp+var_24]
		mov	[esp+58h+nNumberOfBytesToRead],	eax
		mov	[esp+58h+lpBuffer], edx	; char
		mov	[esp+58h+hFile], offset	aSReadErrorEcD ; "%s: read error: ec=%d\n"
		call	sub_41A665
		jmp	short loc_414682
; ---------------------------------------------------------------------------

loc_414662:				; CODE XREF: sub_414578+ABj
		mov	eax, [ebp+NumberOfBytesRead]
		test	eax, eax
		jnz	short loc_41467C
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+0Ch], 1
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_414682
; ---------------------------------------------------------------------------

loc_41467C:				; CODE XREF: sub_414578+EFj
		mov	eax, [ebp+NumberOfBytesRead]
		mov	[ebp+nNumberOfBytesToWrite], eax

loc_414682:				; CODE XREF: sub_414578+BBj
					; sub_414578+E8j ...
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+nNumberOfBytesToWrite]
		mov	[eax], edx
		jmp	loc_41481F
; ---------------------------------------------------------------------------

loc_41468F:				; CODE XREF: sub_414578+2Ej
		cmp	[ebp+arg_4], 4
		jnz	loc_41474B
		cmp	[ebp+var_20], 0
		jz	loc_41473E
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+nNumberOfBytesToWrite], eax

loc_4146AF:				; CODE XREF: sub_414578+1B5j
		cmp	[ebp+var_20], 0
		jz	short loc_41471D
		mov	[esp+58h+lpOverlapped],	0 ; lpOverlapped
		lea	eax, [ebp+NumberOfBytesWritten]
		mov	[esp+58h+lpNumberOfBytesRead], eax ; lpNumberOfBytesWritten
		mov	eax, [ebp+nNumberOfBytesToWrite]
		mov	[esp+58h+nNumberOfBytesToRead],	eax ; nNumberOfBytesToWrite
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpBuffer], eax	; lpBuffer
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+hFile], eax ; hFile
		mov	eax, ds:WriteFile
		call	eax ; WriteFile
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_41471D
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+hFile], eax
		call	sub_413FEA
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_18]
		lea	edx, [eax+14h]
		mov	eax, [ebp+var_28]
		mov	[esp+58h+nNumberOfBytesToRead],	eax
		mov	[esp+58h+lpBuffer], edx	; char
		mov	[esp+58h+hFile], offset	aSWriteErrorEcD	; "%s: write error: ec=%d\n"
		call	sub_41A665
		jmp	short loc_41472F
; ---------------------------------------------------------------------------

loc_41471D:				; CODE XREF: sub_414578+13Bj
					; sub_414578+16Cj
		mov	eax, [ebp+NumberOfBytesWritten]
		add	[ebp+var_14], eax
		mov	eax, [ebp+NumberOfBytesWritten]
		sub	[ebp+nNumberOfBytesToWrite], eax
		cmp	[ebp+nNumberOfBytesToWrite], 0
		jnz	short loc_4146AF

loc_41472F:				; CODE XREF: sub_414578+1A3j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+nNumberOfBytesToWrite], eax

loc_41473E:				; CODE XREF: sub_414578+125j
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+nNumberOfBytesToWrite]
		mov	[eax], edx
		jmp	loc_41481F
; ---------------------------------------------------------------------------

loc_41474B:				; CODE XREF: sub_414578+11Bj
		cmp	[ebp+arg_4], 1
		jnz	short loc_414774
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+8], 0
		jmp	loc_41481F
; ---------------------------------------------------------------------------

loc_414774:				; CODE XREF: sub_414578+1D7j
		cmp	[ebp+arg_4], 5
		jnz	short loc_414788
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], offset	aFile_filterFd ; "file_filter(fd)"
		jmp	loc_41481F
; ---------------------------------------------------------------------------

loc_414788:				; CODE XREF: sub_414578+200j
		cmp	[ebp+arg_4], 2
		jnz	loc_41481F
		mov	[esp+58h+hFile], 0FFFFFFF6h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		cmp	eax, [ebp+var_1C]
		jz	short loc_414814
		mov	[esp+58h+hFile], 0FFFFFFF5h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		cmp	eax, [ebp+var_1C]
		jz	short loc_414814
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_4147E4
		mov	eax, [ebp+var_18]
		lea	edx, [eax+14h]
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+nNumberOfBytesToRead],	eax
		mov	[esp+58h+lpBuffer], edx	; char
		mov	[esp+58h+hFile], offset	aSCloseHandleP ; "%s: close handle %p\n"
		call	sub_41A702

loc_4147E4:				; CODE XREF: sub_414578+24Dj
		mov	eax, [ebp+var_18]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_414814
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_414800
		mov	eax, [ebp+var_18]
		add	eax, 14h
		jmp	short loc_414805
; ---------------------------------------------------------------------------

loc_414800:				; CODE XREF: sub_414578+27Ej
		mov	eax, 0

loc_414805:				; CODE XREF: sub_414578+286j
		mov	edx, [ebp+var_1C]
		mov	[esp+58h+lpBuffer], edx	; HANDLE
		mov	[esp+58h+hFile], eax ; char *
		call	sub_4142EA

loc_414814:				; CODE XREF: sub_414578+22Ej
					; sub_414578+244j ...
		mov	eax, [ebp+var_18]
		mov	[esp+58h+hFile], eax ; void *
		call	sub_406E5D

loc_41481F:				; CODE XREF: sub_414578+70j
					; sub_414578+112j ...
		mov	eax, [ebp+var_10]
		leave
		retn
sub_414578	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_414824(int, int, int,	char *,	int)
sub_414824	proc near		; CODE XREF: .text:00415ECAp
					; .text:00415EF4p
					; DATA XREF: ...

s		= dword	ptr -48h
buf		= dword	ptr -44h
len		= dword	ptr -40h
flags		= dword	ptr -3Ch
var_2C		= byte ptr -2Ch
var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		cmp	[ebp+arg_4], 3
		jnz	loc_41491B
		cmp	[ebp+var_1C], 0
		jnz	short loc_414872
		mov	[esp+48h+len], 2CEh ; int
		mov	[esp+48h+buf], offset a____Gnupg22__3 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+s], offset aSize ; "size"
		call	sub_421040

loc_414872:				; CODE XREF: sub_414824+30j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_414891
		mov	[ebp+var_10], 0FFFFFFFFh
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		jmp	loc_414A28
; ---------------------------------------------------------------------------

loc_414891:				; CODE XREF: sub_414824+56j
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[esp+48h+flags], 0 ; flags
		mov	[esp+48h+len], edx ; len
		mov	edx, [ebp+arg_C]
		mov	[esp+48h+buf], edx ; buf
		mov	[esp+48h+s], eax ; s
		mov	eax, ds:recv
		call	eax ; recv
		sub	esp, 10h
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jnz	short loc_4148EF
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	dword ptr [ebp+var_24],	eax
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+48h+s], eax
		call	sub_413FEA
		mov	[ebp+var_10], eax
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+48h+buf], eax ; char
		mov	[esp+48h+s], offset aSocketReadErro ; "socket read error: ec=%d\n"
		call	sub_41A665
		jmp	short loc_41490E
; ---------------------------------------------------------------------------

loc_4148EF:				; CODE XREF: sub_414824+9Cj
		cmp	[ebp+var_20], 0
		jnz	short loc_414908
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+0Ch], 1
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_41490E
; ---------------------------------------------------------------------------

loc_414908:				; CODE XREF: sub_414824+CFj
		mov	eax, [ebp+var_20]
		mov	[ebp+var_C], eax

loc_41490E:				; CODE XREF: sub_414824+C9j
					; sub_414824+E2j
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		jmp	loc_414A28
; ---------------------------------------------------------------------------

loc_41491B:				; CODE XREF: sub_414824+26j
		cmp	[ebp+arg_4], 4
		jnz	loc_4149C4
		cmp	[ebp+var_1C], 0
		jz	loc_4149BA
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax

loc_41493B:				; CODE XREF: sub_414824+185j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[esp+48h+flags], 0 ; flags
		mov	[esp+48h+len], edx ; len
		mov	edx, [ebp+var_14]
		mov	[esp+48h+buf], edx ; buf
		mov	[esp+48h+s], eax ; s
		mov	eax, ds:send
		call	eax ; send
		sub	esp, 10h
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0FFFFFFFFh
		jnz	short loc_414999
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	dword ptr [ebp+var_2C],	eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+48h+s], eax
		call	sub_413FEA
		mov	[ebp+var_10], eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+48h+buf], eax ; char
		mov	[esp+48h+s], offset aSocketWriteErr ; "socket write error: ec=%d\n"
		call	sub_41A665
		jmp	short loc_4149AB
; ---------------------------------------------------------------------------

loc_414999:				; CODE XREF: sub_414824+146j
		mov	eax, [ebp+var_28]
		add	[ebp+var_14], eax
		mov	eax, [ebp+var_28]
		sub	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41493B

loc_4149AB:				; CODE XREF: sub_414824+173j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax

loc_4149BA:				; CODE XREF: sub_414824+105j
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		jmp	short loc_414A28
; ---------------------------------------------------------------------------

loc_4149C4:				; CODE XREF: sub_414824+FBj
		cmp	[ebp+arg_4], 1
		jnz	short loc_4149EA
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+8], 0
		jmp	short loc_414A28
; ---------------------------------------------------------------------------

loc_4149EA:				; CODE XREF: sub_414824+1A4j
		cmp	[ebp+arg_4], 5
		jnz	short loc_4149FB
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], offset	aSock_filter ; "sock_filter"
		jmp	short loc_414A28
; ---------------------------------------------------------------------------

loc_4149FB:				; CODE XREF: sub_414824+1CAj
		cmp	[ebp+arg_4], 2
		jnz	short loc_414A28
		mov	eax, [ebp+var_18]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_414A1D
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[esp+48h+s], eax ; s
		mov	eax, ds:closesocket
		call	eax ; closesocket
		sub	esp, 4

loc_414A1D:				; CODE XREF: sub_414824+1E5j
		mov	eax, [ebp+var_18]
		mov	[esp+48h+s], eax ; void	*
		call	sub_406E5D

loc_414A28:				; CODE XREF: sub_414824+68j
					; sub_414824+F2j ...
		mov	eax, [ebp+var_10]
		leave
		retn
sub_414824	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414A2D	proc near		; DATA XREF: .text:00417EE9o
					; .text:00417F22o

Dst		= dword	ptr -48h
Src		= dword	ptr -44h
Size		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_30], eax
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_4], 3
		jnz	loc_414FF9
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+var_30]
		mov	[ebp+var_18], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_414A88
		mov	[esp+48h+Size],	32Dh ; int
		mov	[esp+48h+Src], offset a____Gnupg22__3 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aSize ; "size"
		call	sub_421040

loc_414A88:				; CODE XREF: sub_414A2D+3Dj
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	loc_414FD0
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_414FD0
; ---------------------------------------------------------------------------

loc_414AA2:				; CODE XREF: sub_414A2D+5ADj
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_414FB6
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+0Ch]
		cmp	eax, 2
		jnz	short loc_414ADB
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 1
		cmp	[ebp+var_1C], 0
		jnz	loc_414FE2
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_414FE2
; ---------------------------------------------------------------------------

loc_414ADB:				; CODE XREF: sub_414A2D+8Cj
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_414F00
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	short loc_414B08
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+18h]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+18h], 0
		jmp	short loc_414B86
; ---------------------------------------------------------------------------

loc_414B08:				; CODE XREF: sub_414A2D+C4j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_414B22
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_414B2F

loc_414B22:				; CODE XREF: sub_414A2D+E3j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41735E
		jmp	short loc_414B65
; ---------------------------------------------------------------------------

loc_414B2F:				; CODE XREF: sub_414A2D+F3j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_414B65:				; CODE XREF: sub_414A2D+100j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_414B86
		mov	[esp+48h+Dst], offset aBlock_filter1s ;	"block_filter: 1st length byte missing\n"
		call	sub_41A665
		mov	[ebp+var_14], 59h
		jmp	loc_414FEC
; ---------------------------------------------------------------------------

loc_414B86:				; CODE XREF: sub_414A2D+D9j
					; sub_414A2D+13Fj
		cmp	[ebp+var_10], 0BFh
		jg	short loc_414BD0
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+0Ch], 2
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_414FB6
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 1
		cmp	[ebp+var_1C], 0
		jnz	loc_414FE5
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_414FE5
; ---------------------------------------------------------------------------

loc_414BD0:				; CODE XREF: sub_414A2D+160j
		cmp	[ebp+var_10], 0DFh
		jg	loc_414CBD
		mov	eax, [ebp+var_10]
		sub	eax, 0C0h
		shl	eax, 8
		mov	edx, eax
		mov	eax, [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_414C0A
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_414C17

loc_414C0A:				; CODE XREF: sub_414A2D+1CBj
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41735E
		jmp	short loc_414C4D
; ---------------------------------------------------------------------------

loc_414C17:				; CODE XREF: sub_414A2D+1DBj
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_414C4D:				; CODE XREF: sub_414A2D+1E8j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_414C6E
		mov	[esp+48h+Dst], offset aBlock_filter2n ;	"block_filter: 2nd length byte missing\n"
		call	sub_41A665
		mov	[ebp+var_14], 59h
		jmp	loc_414FEC
; ---------------------------------------------------------------------------

loc_414C6E:				; CODE XREF: sub_414A2D+227j
		mov	eax, [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		add	eax, edx
		lea	edx, [eax+0C0h]
		mov	eax, [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+0Ch], 2
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_414FB6
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 1
		cmp	[ebp+var_1C], 0
		jnz	loc_414FE8
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_414FE8
; ---------------------------------------------------------------------------

loc_414CBD:				; CODE XREF: sub_414A2D+1AAj
		cmp	[ebp+var_10], 0FFh
		jnz	loc_414EE0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_414CE4
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_414CF4

loc_414CE4:				; CODE XREF: sub_414A2D+2A5j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41735E
		shl	eax, 18h
		jmp	short loc_414D2D
; ---------------------------------------------------------------------------

loc_414CF4:				; CODE XREF: sub_414A2D+2B5j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 18h
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_414D2D:				; CODE XREF: sub_414A2D+2C5j
		mov	edx, [ebp+var_2C]
		mov	[edx+4], eax
		mov	eax, [ebp+var_2C]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_414D53
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_414D63

loc_414D53:				; CODE XREF: sub_414A2D+314j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41735E
		shl	eax, 10h
		jmp	short loc_414D9C
; ---------------------------------------------------------------------------

loc_414D63:				; CODE XREF: sub_414A2D+324j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 10h
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_414D9C:				; CODE XREF: sub_414A2D+334j
		mov	edx, ebx
		or	edx, eax
		mov	eax, [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_2C]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_414DC6
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_414DD6

loc_414DC6:				; CODE XREF: sub_414A2D+387j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41735E
		shl	eax, 8
		jmp	short loc_414E0F
; ---------------------------------------------------------------------------

loc_414DD6:				; CODE XREF: sub_414A2D+397j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 8
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_414E0F:				; CODE XREF: sub_414A2D+3A7j
		mov	edx, ebx
		or	edx, eax
		mov	eax, [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_414E33
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_414E40

loc_414E33:				; CODE XREF: sub_414A2D+3F4j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41735E
		jmp	short loc_414E76
; ---------------------------------------------------------------------------

loc_414E40:				; CODE XREF: sub_414A2D+404j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_414E76:				; CODE XREF: sub_414A2D+411j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_414E97
		mov	[esp+48h+Dst], offset aBlock_filterIn ;	"block_filter: invalid 4 byte length\n"
		call	sub_41A665
		mov	[ebp+var_14], 59h
		jmp	loc_414FEC
; ---------------------------------------------------------------------------

loc_414E97:				; CODE XREF: sub_414A2D+450j
		mov	eax, [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		or	edx, eax
		mov	eax, [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+0Ch], 2
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_414FB6
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 1
		cmp	[ebp+var_1C], 0
		jnz	loc_414FEB
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_414FEB
; ---------------------------------------------------------------------------

loc_414EE0:				; CODE XREF: sub_414A2D+297j
		mov	eax, [ebp+var_10]
		and	eax, 1Fh
		mov	edx, 1
		mov	ebx, edx
		mov	ecx, eax
		shl	ebx, cl
		mov	eax, ebx
		mov	edx, eax
		mov	eax, [ebp+var_2C]
		mov	[eax+4], edx
		jmp	loc_414FB6
; ---------------------------------------------------------------------------

loc_414F00:				; CODE XREF: sub_414A2D+B6j
		mov	[esp+48h+Size],	offset aBlock_filter ; "block_filter"
		mov	[esp+48h+Src], 386h
		mov	[esp+48h+Dst], offset a____Gnupg22__3 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_41A7F4
; ---------------------------------------------------------------------------

loc_414F1C:				; CODE XREF: sub_414A2D+59Dj
		mov	eax, [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_C]
		cmp	edx, eax
		cmovbe	eax, edx
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_34]
		mov	[esp+48h+Size],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Src], eax ; char
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_417407
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_34]
		jge	short loc_414F93
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_414F5E
		mov	[ebp+var_10], 0

loc_414F5E:				; CODE XREF: sub_414A2D+528j
		mov	eax, [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		add	edx, eax
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_C]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+Size],	eax
		mov	eax, [ebp+var_2C]
		mov	[esp+48h+Src], eax ; char
		mov	[esp+48h+Dst], offset aBlock_filterPR ;	"block_filter %p: read error (size=%lu,a"...
		call	sub_41A665
		mov	[ebp+var_14], 59h
		jmp	short loc_414FB6
; ---------------------------------------------------------------------------

loc_414F93:				; CODE XREF: sub_414A2D+522j
		mov	eax, [ebp+var_10]
		sub	[ebp+var_C], eax
		mov	eax, [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		sub	edx, eax
		mov	eax, [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		add	[ebp+var_18], eax
		mov	eax, [ebp+var_10]
		add	[ebp+var_1C], eax

loc_414FB6:				; CODE XREF: sub_414A2D+7Dj
					; sub_414A2D+17Dj ...
		cmp	[ebp+var_14], 0
		jnz	short loc_414FD0
		cmp	[ebp+var_C], 0
		jz	short loc_414FD0
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_414F1C

loc_414FD0:				; CODE XREF: sub_414A2D+63j
					; sub_414A2D+70j ...
		cmp	[ebp+var_14], 0
		jnz	short loc_414FEC
		cmp	[ebp+var_C], 0
		jnz	loc_414AA2
		jmp	short loc_414FEC
; ---------------------------------------------------------------------------

loc_414FE2:				; CODE XREF: sub_414A2D+9Cj
					; sub_414A2D+A9j
		nop
		jmp	short loc_414FEC
; ---------------------------------------------------------------------------

loc_414FE5:				; CODE XREF: sub_414A2D+191j
					; sub_414A2D+19Ej
		nop
		jmp	short loc_414FEC
; ---------------------------------------------------------------------------

loc_414FE8:				; CODE XREF: sub_414A2D+27Ej
					; sub_414A2D+28Bj
		nop
		jmp	short loc_414FEC
; ---------------------------------------------------------------------------

loc_414FEB:				; CODE XREF: sub_414A2D+4A1j
					; sub_414A2D+4AEj
		nop

loc_414FEC:				; CODE XREF: sub_414A2D+154j
					; sub_414A2D+23Cj ...
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_1C]
		mov	[eax], edx
		jmp	loc_41555F
; ---------------------------------------------------------------------------

loc_414FF9:				; CODE XREF: sub_414A2D+26j
		cmp	[ebp+arg_4], 4
		jnz	loc_4152A2
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_415286
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+14h]
		add	eax, [ebp+var_C]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+14h]
		cmp	eax, 200h
		jbe	short loc_415046
		mov	[esp+48h+Size],	3A7h ; int
		mov	[esp+48h+Src], offset a____Gnupg22__3 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aABuflenOp_min_ ;	"a->buflen <= OP_MIN_PARTIAL_CHUNK"
		call	sub_421040

loc_415046:				; CODE XREF: sub_414A2D+5FBj
		cmp	[ebp+var_28], 1FFh
		ja	short loc_4150A9
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_41506D
		mov	[esp+48h+Dst], 200h ; size_t
		call	sub_406D00
		mov	edx, eax
		mov	eax, [ebp+var_2C]
		mov	[eax+10h], edx

loc_41506D:				; CODE XREF: sub_414A2D+62Aj
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	ecx, eax
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+14h]
		add	eax, ecx
		mov	ecx, [ebp+var_C]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+14h]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+var_2C]
		mov	[eax+14h], edx
		jmp	loc_41555F
; ---------------------------------------------------------------------------

loc_4150A9:				; CODE XREF: sub_414A2D+620j
		mov	eax, [ebp+var_30]
		mov	[ebp+var_18], eax

loc_4150AF:				; CODE XREF: sub_414A2D+7ACj
		mov	[ebp+var_20], 400h
		mov	[ebp+var_10], 0Ah
		jmp	short loc_4150C6
; ---------------------------------------------------------------------------

loc_4150BF:				; CODE XREF: sub_414A2D+69Fj
		shl	[ebp+var_20], 1
		add	[ebp+var_10], 1

loc_4150C6:				; CODE XREF: sub_414A2D+690j
		mov	eax, [ebp+var_20]
		cmp	eax, [ebp+var_28]
		jbe	short loc_4150BF
		mov	eax, [ebp+var_20]
		shr	eax, 1
		mov	[ebp+var_20], eax
		sub	[ebp+var_10], 1
		cmp	[ebp+var_10], 1Fh
		jle	short loc_4150FC
		mov	[esp+48h+Size],	3BFh ; int
		mov	[esp+48h+Src], offset a____Gnupg22__3 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aC0x1f ; "c <= 0x1f"
		call	sub_421040

loc_4150FC:				; CODE XREF: sub_414A2D+6B1j
		or	[ebp+var_10], 0E0h
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_417685
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+14h]
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_415181
		cmp	[ebp+var_24], 200h
		jz	short loc_415149
		mov	[esp+48h+Size],	3C4h ; int
		mov	[esp+48h+Src], offset a____Gnupg22__3 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aNOp_min_partia ;	"n == OP_MIN_PARTIAL_CHUNK"
		call	sub_421040

loc_415149:				; CODE XREF: sub_414A2D+6FEj
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	edx, [ebp+var_24]
		mov	[esp+48h+Size],	edx
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41772A
		test	eax, eax
		jz	short loc_415171
		call	sub_414005
		mov	[ebp+var_14], eax

loc_415171:				; CODE XREF: sub_414A2D+73Aj
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+var_24]
		sub	[ebp+var_28], eax

loc_415181:				; CODE XREF: sub_414A2D+6F5j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_20]
		jbe	short loc_415195
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax

loc_415195:				; CODE XREF: sub_414A2D+760j
		cmp	[ebp+var_24], 0
		jz	short loc_4151C0
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Size],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41772A
		test	eax, eax
		jz	short loc_4151C0
		call	sub_414005
		mov	[ebp+var_14], eax

loc_4151C0:				; CODE XREF: sub_414A2D+76Cj
					; sub_414A2D+789j
		mov	eax, [ebp+var_24]
		add	[ebp+var_18], eax
		mov	eax, [ebp+var_24]
		sub	[ebp+var_28], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4151DF
		cmp	[ebp+var_28], 1FFh
		ja	loc_4150AF

loc_4151DF:				; CODE XREF: sub_414A2D+7A3j
		cmp	[ebp+var_14], 0
		jnz	loc_41555F
		cmp	[ebp+var_28], 0
		jz	loc_41555F
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_415219
		mov	[esp+48h+Size],	3D5h ; int
		mov	[esp+48h+Src], offset a____Gnupg22__3 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aABuflen ; "!a->buflen"
		call	sub_421040

loc_415219:				; CODE XREF: sub_414A2D+7CEj
		cmp	[ebp+var_28], 1FFh
		jbe	short loc_41523E
		mov	[esp+48h+Size],	3D6h ; int
		mov	[esp+48h+Src], offset a____Gnupg22__3 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aNbytesOp_min_p ;	"nbytes	< OP_MIN_PARTIAL_CHUNK"
		call	sub_421040

loc_41523E:				; CODE XREF: sub_414A2D+7F3j
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_41525C
		mov	[esp+48h+Dst], 200h ; size_t
		call	sub_406D00
		mov	edx, eax
		mov	eax, [ebp+var_2C]
		mov	[eax+10h], edx

loc_41525C:				; CODE XREF: sub_414A2D+819j
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	ecx, [ebp+var_28]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_2C]
		mov	edx, [ebp+var_28]
		mov	[eax+14h], edx
		jmp	loc_41555F
; ---------------------------------------------------------------------------

loc_415286:				; CODE XREF: sub_414A2D+5DEj
		mov	[esp+48h+Size],	offset aBlock_filter ; "block_filter"
		mov	[esp+48h+Src], 3DFh
		mov	[esp+48h+Dst], offset a____Gnupg22__3 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_41A7F4
; ---------------------------------------------------------------------------

loc_4152A2:				; CODE XREF: sub_414A2D+5D0j
		cmp	[ebp+arg_4], 1
		jnz	loc_41532F
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_4152C8
		mov	eax, [ebp+var_2C]
		mov	[esp+48h+Src], eax ; char
		mov	[esp+48h+Dst], offset aInitBlock_filt ;	"init block_filter %p\n"
		call	sub_41A702

loc_4152C8:				; CODE XREF: sub_414A2D+886j
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_4152DE
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+8], 0
		jmp	short loc_41530C
; ---------------------------------------------------------------------------

loc_4152DE:				; CODE XREF: sub_414A2D+8A3j
		mov	eax, [ebp+var_2C]
		mov	eax, [eax]
		cmp	eax, 1
		jnz	short loc_415300
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_2C]
		mov	[eax+8], edx
		jmp	short loc_41530C
; ---------------------------------------------------------------------------

loc_415300:				; CODE XREF: sub_414A2D+8B9j
		mov	eax, [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_2C]
		mov	[eax+8], edx

loc_41530C:				; CODE XREF: sub_414A2D+8AFj
					; sub_414A2D+8D1j
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_41555F
; ---------------------------------------------------------------------------

loc_41532F:				; CODE XREF: sub_414A2D+879j
		cmp	[ebp+arg_4], 5
		jnz	short loc_415343
		mov	eax, [ebp+var_30]
		mov	dword ptr [eax], offset	aBlock_filter_0	; "block_filter"
		jmp	loc_41555F
; ---------------------------------------------------------------------------

loc_415343:				; CODE XREF: sub_414A2D+906j
		cmp	[ebp+arg_4], 2
		jnz	loc_41555F
		mov	eax, [ebp+var_2C]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	loc_415522
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_415506
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+14h]
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0BFh
		ja	short loc_415395
		mov	eax, [ebp+var_38]
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_417685
		mov	[ebp+var_14], eax
		jmp	loc_415488
; ---------------------------------------------------------------------------

loc_415395:				; CODE XREF: sub_414A2D+94Cj
		cmp	[ebp+var_38], 20BFh
		ja	short loc_4153EE
		mov	eax, [ebp+var_38]
		sub	eax, 0C0h
		shr	eax, 8
		add	eax, 0C0h
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_417685
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	loc_415488
		mov	eax, [ebp+var_38]
		sub	eax, 0C0h
		and	eax, 0FFh
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_417685
		mov	[ebp+var_14], eax
		jmp	loc_415488
; ---------------------------------------------------------------------------

loc_4153EE:				; CODE XREF: sub_414A2D+96Fj
		mov	[esp+48h+Src], 0FFh
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_417685
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_415488
		mov	eax, [ebp+var_38]
		shr	eax, 18h
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_417685
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_415488
		mov	eax, [ebp+var_38]
		shr	eax, 10h
		and	eax, 0FFh
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_417685
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_415488
		mov	eax, [ebp+var_38]
		shr	eax, 8
		and	eax, 0FFh
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_417685
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_415488
		mov	eax, [ebp+var_38]
		and	eax, 0FFh
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_417685
		mov	[ebp+var_14], eax

loc_415488:				; CODE XREF: sub_414A2D+963j
					; sub_414A2D+997j ...
		cmp	[ebp+var_14], 0
		jnz	short loc_4154B3
		cmp	[ebp+var_38], 0
		jz	short loc_4154B3
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	edx, [ebp+var_38]
		mov	[esp+48h+Size],	edx
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_41772A
		mov	[ebp+var_14], eax

loc_4154B3:				; CODE XREF: sub_414A2D+A5Fj
					; sub_414A2D+A65j
		cmp	[ebp+var_14], 0
		jz	short loc_4154E2
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+48h+Dst], eax ; int
		call	strerror
		mov	[esp+48h+Src], eax ; char
		mov	[esp+48h+Dst], offset aBlock_filterWr ;	"block_filter: write error: %s\n"
		call	sub_41A665
		call	sub_414005
		mov	[ebp+var_14], eax

loc_4154E2:				; CODE XREF: sub_414A2D+A8Aj
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	[esp+48h+Dst], eax ; void *
		call	sub_406E5D
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+var_2C]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_415538
; ---------------------------------------------------------------------------

loc_415506:				; CODE XREF: sub_414A2D+936j
		mov	[esp+48h+Size],	offset aBlock_filter ; "block_filter"
		mov	[esp+48h+Src], 423h
		mov	[esp+48h+Dst], offset a____Gnupg22__3 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_41A7F4
; ---------------------------------------------------------------------------

loc_415522:				; CODE XREF: sub_414A2D+928j
		mov	eax, [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_415538
		mov	[esp+48h+Dst], offset aBlock_filterPe ;	"block_filter: pending bytes!\n"
		call	sub_41A665

loc_415538:				; CODE XREF: sub_414A2D+AD7j
					; sub_414A2D+AFDj
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_415554
		mov	eax, [ebp+var_2C]
		mov	[esp+48h+Src], eax ; char
		mov	[esp+48h+Dst], offset aFreeBlock_filt ;	"free block_filter %p\n"
		call	sub_41A702

loc_415554:				; CODE XREF: sub_414A2D+B12j
		mov	eax, [ebp+var_2C]
		mov	[esp+48h+Dst], eax ; void *
		call	sub_406E5D

loc_41555F:				; CODE XREF: sub_414A2D+5C7j
					; sub_414A2D+677j ...
		mov	eax, [ebp+var_14]
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_414A2D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415568	proc near		; CODE XREF: .text:00415648p
					; sub_416581+2CBp ...

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	eax, ds:dword_429068
		test	eax, eax
		jnz	loc_41562A
		jmp	loc_415634
; ---------------------------------------------------------------------------

loc_415583:				; CODE XREF: sub_415568+C6j
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], offset aNone ; "[none]"
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_4155CA
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	edx, [ebp+var_1C]
		mov	[esp+48h+var_38], edx
		lea	edx, [ebp+var_20]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], 0
		mov	dword ptr [esp+48h+var_44], 5
		mov	[esp+48h+var_48], eax
		call	ecx

loc_4155CA:				; CODE XREF: sub_415568+31j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	edi, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	esi, eax
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+38h]
		mov	eax, [ebp+var_20]
		test	eax, eax
		jz	short loc_4155EC
		mov	eax, [ebp+var_20]
		jmp	short loc_4155F1
; ---------------------------------------------------------------------------

loc_4155EC:				; CODE XREF: sub_415568+7Dj
		mov	eax, offset a?_1 ; "?"

loc_4155F1:				; CODE XREF: sub_415568+82j
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+48h+var_30], edi
		mov	[esp+48h+var_34], esi
		mov	[esp+48h+var_38], ebx
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], ecx
		mov	dword ptr [esp+48h+var_44], edx	; char
		mov	[esp+48h+var_48], offset aIobufChainD_DS ; "iobuf chain: %d.%d `%s' filter_eof=%d s"...
		call	sub_41A702
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_41562A:				; CODE XREF: sub_415568+10j
		cmp	[ebp+arg_0], 0
		jnz	loc_415583

loc_415634:				; CODE XREF: sub_415568+16j
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_415568	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_415568
		mov	eax, 0
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_415654(int, size_t)
sub_415654	proc near		; CODE XREF: .text:0041597Ep
					; .text:0041599Fp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_24], 68h ;	size_t
		mov	[esp+28h+var_28], 1 ; size_t
		call	sub_406DD8
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax ;	size_t
		call	sub_406D00
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax+34h], edx
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+28h], edx
		mov	eax, ds:dword_428A58
		add	eax, 1
		mov	ds:dword_428A58, eax
		mov	edx, ds:dword_428A58
		mov	eax, [ebp+var_C]
		mov	[eax+54h], edx
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+58h], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+60h], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4Ch], 0
		mov	eax, [ebp+var_C]
		leave
		retn
sub_415654	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4156D1(void *)
sub_4156D1	proc near		; CODE XREF: .text:00413F2Ep
					; .text:0041593Cp

File		= dword	ptr -38h
Val		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	[ebp+var_14], 0
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_0], 0
		jz	loc_415880
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_415880
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+38h+File],	eax ; File
		call	fclose
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+38h+File],	eax ; void *
		call	sub_406E5D
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_415739
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+File],	offset aIobuf_closeP ; "iobuf_close -> %p\n"
		call	sub_41A702

loc_415739:				; CODE XREF: sub_4156D1+50j
		mov	eax, 0
		jmp	loc_415893
; ---------------------------------------------------------------------------

loc_415743:				; CODE XREF: sub_4156D1+1B9j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_415785
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+File],	eax
		call	sub_4171F0
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_415785
		mov	eax, [ebp+var_C]
		mov	[esp+38h+File],	eax
		call	gpg_strerror
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+File],	offset aIobuf_flushFai ; "iobuf_flush failed on	close: %s\n"
		call	sub_41A665

loc_415785:				; CODE XREF: sub_4156D1+83j
					; sub_4156D1+97j
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_4157C9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_4157A0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		jmp	short loc_4157A5
; ---------------------------------------------------------------------------

loc_4157A0:				; CODE XREF: sub_4156D1+C5j
		mov	eax, offset a?_1 ; "?"

loc_4157A5:				; CODE XREF: sub_4156D1+CDj
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+38h+var_2C], eax
		mov	[esp+38h+Size],	ecx
		mov	[esp+38h+Val], edx ; char
		mov	[esp+38h+File],	offset aIobufD_DCloseS ; "iobuf-%d.%d: close `%s'\n"
		call	sub_41A702

loc_4157C9:				; CODE XREF: sub_4156D1+BBj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_415829
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ecx, [ebp+var_14]
		mov	[esp+38h+var_28], ecx
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Val], 2
		mov	[esp+38h+File],	eax
		call	ebx
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_415829
		mov	eax, [ebp+var_C]
		mov	[esp+38h+File],	eax
		call	gpg_strerror
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+File],	offset aIobufctrl_free ; "IOBUFCTRL_FREE failed	on close: %s\n"
		call	sub_41A665

loc_415829:				; CODE XREF: sub_4156D1+100j
					; sub_4156D1+13Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+38h+File],	eax ; void *
		call	sub_406E5D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		test	eax, eax
		jz	short loc_41586F
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+28h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Val], 0 ; Val
		mov	[esp+38h+File],	eax ; Dst
		call	memset
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+38h+File],	eax ; void *
		call	sub_406E5D

loc_41586F:				; CODE XREF: sub_4156D1+16Ej
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+File],	eax ; void *
		call	sub_406E5D
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_0], eax

loc_415880:				; CODE XREF: sub_4156D1+19j
					; sub_4156D1+27j
		cmp	[ebp+arg_0], 0
		jz	short loc_415890
		cmp	[ebp+var_C], 0
		jz	loc_415743

loc_415890:				; CODE XREF: sub_4156D1+1B3j
		mov	eax, [ebp+var_C]

loc_415893:				; CODE XREF: sub_4156D1+6Dj
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_4156D1	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	dword ptr [ebp-10h], 0
		cmp	dword ptr [ebp+8], 0
		jz	short loc_4158E3
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_4158E3
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_417DBE
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_4158E3
		mov	eax, [ebp-14h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4158E3
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_406E03
		mov	[ebp-10h], eax

loc_4158E3:				; CODE XREF: .text:004158ABj
					; .text:004158B5j ...
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_415930
; ---------------------------------------------------------------------------

loc_4158EB:				; CODE XREF: .text:00415934j
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_415927
		mov	eax, [ebp-0Ch]
		mov	ebx, [eax+40h]
		mov	eax, [ebp-0Ch]
		mov	edx, [eax+50h]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+44h]
		lea	ecx, [ebp-1Ch]
		mov	[esp+10h], ecx
		mov	dword ptr [esp+0Ch], 0
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 6
		mov	[esp], eax
		call	ebx

loc_415927:				; CODE XREF: .text:004158F3j
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+50h]
		mov	[ebp-0Ch], eax

loc_415930:				; CODE XREF: .text:004158E9j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4158EB
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4156D1
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_415960
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	remove
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_406E5D

loc_415960:				; CODE XREF: .text:00415948j
		mov	eax, [ebp-18h]
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2000h
		mov	dword ptr [esp], 3
		call	sub_415654
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	sub_415654
		mov	[ebp-0Ch], eax
		mov	edx, [ebp+8]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+34h]
		mov	ecx, [ebp+0Ch]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp-0Ch]
		mov	edx, [ebp+0Ch]
		mov	[eax+30h], edx
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_428A4C, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4159DE(char *)
sub_4159DE	proc near		; CODE XREF: sub_415A56+30p
					; sub_415AE9+5Cp ...

Str		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_428A4C
		test	eax, eax
		jz	short loc_415A4F
		cmp	[ebp+arg_0], 0
		jz	short loc_415A4F
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_415A4F
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 26h
		jnz	short loc_415A4F
		add	[ebp+arg_0], 2
		mov	[ebp+var_C], 0
		jmp	short loc_415A1B
; ---------------------------------------------------------------------------

loc_415A17:				; CODE XREF: sub_4159DE+55j
		add	[ebp+var_C], 1

loc_415A1B:				; CODE XREF: sub_4159DE+37j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_415A35
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_415A17

loc_415A35:				; CODE XREF: sub_4159DE+48j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_415A4F
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	atoi
		jmp	short locret_415A54
; ---------------------------------------------------------------------------

loc_415A4F:				; CODE XREF: sub_4159DE+Dj
					; sub_4159DE+13j ...
		mov	eax, 0FFFFFFFFh

locret_415A54:				; CODE XREF: sub_4159DE+6Fj
		leave
		retn
sub_4159DE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_415A56(char *)
sub_415A56	proc near		; CODE XREF: .text:00413E35p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_415A79
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_415A80
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_415A80

loc_415A79:				; CODE XREF: sub_415A56+Aj
		mov	eax, 1
		jmp	short locret_415A94
; ---------------------------------------------------------------------------

loc_415A80:				; CODE XREF: sub_415A56+14j
					; sub_415A56+21j
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_4159DE
		cmp	eax, 0FFFFFFFFh
		setnz	al
		movzx	eax, al

locret_415A94:				; CODE XREF: sub_415A56+28j
		leave
		retn
sub_415A56	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0FFFFFFFFh
		jnz	short loc_415AB2
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_415AE9
		mov	[ebp-0Ch], eax
		jmp	short loc_415AE4
; ---------------------------------------------------------------------------

loc_415AB2:				; CODE XREF: .text:00415AA0j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	_dup
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_415ACF
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_415AE4
; ---------------------------------------------------------------------------

loc_415ACF:				; CODE XREF: .text:00415AC4j
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_415CD0
		mov	[ebp-0Ch], eax

loc_415AE4:				; CODE XREF: .text:00415AB0j
					; .text:00415ACDj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_415AE9(LPCSTR	lpFileName)
sub_415AE9	proc near		; CODE XREF: .text:00413E54p
					; .text:00415AA8p

nStdHandle	= dword	ptr -58h
Source		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
lpFileName	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	[ebp+var_20], 0
		mov	[ebp+var_10], 0
		cmp	[ebp+lpFileName], 0
		jz	short loc_415B1B
		mov	eax, [ebp+lpFileName]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_415B3F
		mov	eax, [ebp+lpFileName]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_415B3F

loc_415B1B:				; CODE XREF: sub_415AE9+19j
		mov	[esp+58h+nStdHandle], 0FFFFFFF6h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+var_C], eax
		mov	[ebp+lpFileName], offset aStdin_1 ; "[stdin]"
		mov	[ebp+var_10], 1
		jmp	short loc_415BA1
; ---------------------------------------------------------------------------

loc_415B3F:				; CODE XREF: sub_415AE9+23j
					; sub_415AE9+30j
		mov	eax, [ebp+lpFileName]
		mov	[esp+58h+nStdHandle], eax ; char *
		call	sub_4159DE
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0FFFFFFFFh
		jz	short loc_415B7B
		mov	[esp+58h+Source], 0
		mov	eax, [ebp+var_14]
		mov	[esp+58h+nStdHandle], eax
		call	sub_418116
		mov	[esp+58h+Source], offset aRb_0 ; "rb"
		mov	[esp+58h+nStdHandle], eax ; int
		call	sub_415CD0
		jmp	loc_415CCB
; ---------------------------------------------------------------------------

loc_415B7B:				; CODE XREF: sub_415AE9+68j
		mov	[esp+58h+Source], offset aRb_0 ; "rb"
		mov	eax, [ebp+lpFileName]
		mov	[esp+58h+nStdHandle], eax ; lpFileName
		call	sub_41444F
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_415BA1
		mov	eax, 0
		jmp	loc_415CCB
; ---------------------------------------------------------------------------

loc_415BA1:				; CODE XREF: sub_415AE9+54j
					; sub_415AE9+ACj
		mov	[esp+58h+Source], 2000h	; size_t
		mov	[esp+58h+nStdHandle], 1	; int
		call	sub_415654
		mov	[ebp+var_18], eax
		mov	eax, [ebp+lpFileName]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 18h
		mov	[esp+58h+nStdHandle], eax ; size_t
		call	sub_406D00
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_10]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_1C]
		lea	edx, [eax+14h]
		mov	eax, [ebp+lpFileName]
		mov	[esp+58h+Source], eax ;	Source
		mov	[esp+58h+nStdHandle], edx ; Dest
		call	strcpy
		cmp	[ebp+var_10], 0
		jnz	short loc_415C24
		mov	eax, [ebp+lpFileName]
		mov	[esp+58h+nStdHandle], eax ; char *
		call	sub_406E03
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+4Ch], edx

loc_415C24:				; CODE XREF: sub_415AE9+126j
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+40h], offset sub_414578
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_1C]
		mov	[eax+44h], edx
		mov	eax, [ebp+var_18]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_48], eax ;	int
		mov	[esp+58h+var_4C], edx ;	LPVOID
		mov	[esp+58h+var_50], 0 ; int
		mov	[esp+58h+Source], 5 ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+nStdHandle], eax ; int
		call	sub_414578
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_48], eax ;	int
		mov	[esp+58h+var_4C], 0 ; LPVOID
		mov	[esp+58h+var_50], 0 ; int
		mov	[esp+58h+Source], 1 ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+nStdHandle], eax ; int
		call	sub_414578
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_415CC8
		mov	eax, [ebp+var_1C]
		mov	eax, [eax]
		mov	ecx, eax
		mov	eax, [ebp+var_18]
		mov	edx, [eax+58h]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+54h]
		mov	[esp+58h+var_48], ecx
		mov	ecx, [ebp+lpFileName]
		mov	[esp+58h+var_4C], ecx
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+Source], eax ;	char
		mov	[esp+58h+nStdHandle], offset aIobufD_DOpenSF ; "iobuf-%d.%d: open `%s' fd=%d\n"
		call	sub_41A702

loc_415CC8:				; CODE XREF: sub_415AE9+1ABj
		mov	eax, [ebp+var_18]

loc_415CCB:				; CODE XREF: sub_415AE9+8Dj
					; sub_415AE9+B3j
		mov	edi, [ebp+var_4]
		leave
		retn
sub_415AE9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_415CD0(int, char *)
sub_415CD0	proc near		; CODE XREF: .text:00415ADCp
					; sub_415AE9+88p ...

Str		= dword	ptr -38h
Val		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[esp+38h+Val], 77h ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_415CFA
		mov	eax, 2
		jmp	short loc_415CFF
; ---------------------------------------------------------------------------

loc_415CFA:				; CODE XREF: sub_415CD0+21j
		mov	eax, 1

loc_415CFF:				; CODE XREF: sub_415CD0+28j
		mov	[esp+38h+Val], 2000h ; size_t
		mov	[esp+38h+Str], eax ; int
		call	sub_415654
		mov	[ebp+var_10], eax
		mov	[esp+38h+Str], 2Ch ; size_t
		call	sub_406D00
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+10h], 1
		mov	eax, offset aFdD ; "[fd	%d]"
		mov	edx, [ebp+var_14]
		lea	ecx, [edx+14h]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Val], eax ; Format
		mov	[esp+38h+Str], ecx ; Dest
		call	sprintf
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+40h], offset sub_414578
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		mov	[eax+44h], edx
		mov	eax, [ebp+var_10]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_28], eax ;	int
		mov	[esp+38h+var_2C], edx ;	LPVOID
		mov	[esp+38h+var_30], 0 ; int
		mov	[esp+38h+Val], 5 ; int
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax ; int
		call	sub_414578
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_28], eax ;	int
		mov	[esp+38h+var_2C], 0 ; LPVOID
		mov	[esp+38h+var_30], 0 ; int
		mov	[esp+38h+Val], 1 ; int
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax ; int
		call	sub_414578
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_415DED
		mov	eax, [ebp+var_14]
		lea	ecx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	edx, [eax+58h]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+54h]
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+Str], offset aIobufD_DFdopen ;	"iobuf-%d.%d: fdopen `%s'\n"
		call	sub_41A702

loc_415DED:				; CODE XREF: sub_415CD0+F1j
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], 1
		mov	[esp+38h+Val], 3
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax
		call	sub_4162A4
		mov	eax, [ebp+var_10]
		leave
		retn
sub_415CD0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	dword ptr [esp+4], 77h
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	strchr
		test	eax, eax
		jz	short loc_415E39
		mov	eax, 2
		jmp	short loc_415E3E
; ---------------------------------------------------------------------------

loc_415E39:				; CODE XREF: .text:00415E30j
		mov	eax, 1

loc_415E3E:				; CODE XREF: .text:00415E37j
		mov	dword ptr [esp+4], 2000h
		mov	[esp], eax
		call	sub_415654
		mov	[ebp-0Ch], eax
		mov	dword ptr [esp], 31h
		call	sub_406D00
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	edx, [ebp+8]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	dword ptr [eax+10h], 1
		mov	eax, offset aSockD ; "[sock %d]"
		mov	edx, [ebp-10h]
		lea	ecx, [edx+14h]
		mov	edx, [ebp+8]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], ecx
		call	sprintf
		mov	eax, [ebp-0Ch]
		mov	dword ptr [eax+40h], offset sub_414824
		mov	eax, [ebp-0Ch]
		mov	edx, [ebp-10h]
		mov	[eax+44h], edx
		mov	eax, [ebp-0Ch]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp-14h]
		mov	[esp+10h], eax
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 5
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_414824
		lea	eax, [ebp-14h]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_414824
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_415F2C
		mov	eax, [ebp-10h]
		lea	ecx, [eax+14h]
		mov	eax, [ebp-0Ch]
		mov	edx, [eax+58h]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+54h]
		mov	[esp+0Ch], ecx
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aIobufD_DSockop	; "iobuf-%d.%d:	sockopen `%s'\n"
		call	sub_41A702

loc_415F2C:				; CODE XREF: .text:00415F00j
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], 3
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_4162A4
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	dword ptr [ebp-10h], 0
		cmp	dword ptr [ebp+8], 0
		jz	short loc_415F7F
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_415FA3
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_415FA3

loc_415F7F:				; CODE XREF: .text:00415F66j
		mov	dword ptr [esp], 0FFFFFFF5h
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp+8], offset aStdout_1 ; "[stdout]"
		mov	dword ptr [ebp-10h], 1
		jmp	short loc_416005
; ---------------------------------------------------------------------------

loc_415FA3:				; CODE XREF: .text:00415F70j
					; .text:00415F7Dj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4159DE
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0FFFFFFFFh
		jz	short loc_415FDF
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_418116
		mov	dword ptr [esp+4], offset aWb_0	; "wb"
		mov	[esp], eax
		call	sub_415CD0
		jmp	loc_416138
; ---------------------------------------------------------------------------

loc_415FDF:				; CODE XREF: .text:00415FB5j
		mov	dword ptr [esp+4], offset aWb_0	; "wb"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4141FF
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_416005
		mov	eax, 0
		jmp	loc_416138
; ---------------------------------------------------------------------------

loc_416005:				; CODE XREF: .text:00415FA1j
					; .text:00415FF9j
		mov	dword ptr [esp+4], 2000h
		mov	dword ptr [esp], 2
		call	sub_415654
		mov	[ebp-18h], eax
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 18h
		mov	[esp], eax
		call	sub_406D00
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-1Ch]
		mov	edx, [ebp-10h]
		mov	[eax+10h], edx
		mov	eax, [ebp-1Ch]
		lea	edx, [eax+14h]
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	[esp], edx
		call	strcpy
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_416088
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406E03
		mov	edx, eax
		mov	eax, [ebp-18h]
		mov	[eax+4Ch], edx

loc_416088:				; CODE XREF: .text:00416073j
		mov	eax, [ebp-18h]
		mov	dword ptr [eax+40h], offset sub_414578
		mov	eax, [ebp-18h]
		mov	edx, [ebp-1Ch]
		mov	[eax+44h], edx
		mov	eax, [ebp-18h]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp-20h]
		mov	[esp+10h], eax
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 5
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_414578
		lea	eax, [ebp-20h]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_414578
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_416135
		mov	eax, [ebp-18h]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_41610C
		mov	eax, [ebp-18h]
		mov	eax, [eax+5Ch]
		jmp	short loc_416111
; ---------------------------------------------------------------------------

loc_41610C:				; CODE XREF: .text:00416102j
		mov	eax, offset a?_1 ; "?"

loc_416111:				; CODE XREF: .text:0041610Aj
		mov	edx, [ebp-18h]
		mov	ecx, [edx+58h]
		mov	edx, [ebp-18h]
		mov	edx, [edx+54h]
		mov	[esp+0Ch], eax
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	dword ptr [esp], offset	aIobufD_DCreate	; "iobuf-%d.%d:	create `%s'\n"
		call	sub_41A702

loc_416135:				; CODE XREF: .text:004160F8j
		mov	eax, [ebp-18h]

loc_416138:				; CODE XREF: .text:00415FDAj
					; .text:00416000j
		mov	edi, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_416154
		mov	eax, 0
		jmp	loc_41629E
; ---------------------------------------------------------------------------

loc_416154:				; CODE XREF: .text:00416148j
		mov	dword ptr [esp+4], offset aRB ;	"r+b"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4141FF
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_41617A
		mov	eax, 0
		jmp	loc_41629E
; ---------------------------------------------------------------------------

loc_41617A:				; CODE XREF: .text:0041616Ej
		mov	dword ptr [esp+4], 2000h
		mov	dword ptr [esp], 2
		call	sub_415654
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 18h
		mov	[esp], eax
		call	sub_406D00
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-14h]
		lea	edx, [eax+14h]
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	[esp], edx
		call	strcpy
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406E03
		mov	edx, eax
		mov	eax, [ebp-10h]
		mov	[eax+4Ch], edx
		mov	eax, [ebp-10h]
		mov	dword ptr [eax+40h], offset sub_414578
		mov	eax, [ebp-10h]
		mov	edx, [ebp-14h]
		mov	[eax+44h], edx
		mov	eax, [ebp-10h]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp-18h]
		mov	[esp+10h], eax
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 5
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_414578
		lea	eax, [ebp-18h]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_414578
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_41629B
		mov	eax, [ebp-10h]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_416272
		mov	eax, [ebp-10h]
		mov	eax, [eax+5Ch]
		jmp	short loc_416277
; ---------------------------------------------------------------------------

loc_416272:				; CODE XREF: .text:00416268j
		mov	eax, offset a?_1 ; "?"

loc_416277:				; CODE XREF: .text:00416270j
		mov	edx, [ebp-10h]
		mov	ecx, [edx+58h]
		mov	edx, [ebp-10h]
		mov	edx, [edx+54h]
		mov	[esp+0Ch], eax
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	dword ptr [esp], offset	aIobufD_DOpenrw	; "iobuf-%d.%d:	openrw `%s'\n"
		call	sub_41A702

loc_41629B:				; CODE XREF: .text:0041625Ej
		mov	eax, [ebp-10h]

loc_41629E:				; CODE XREF: .text:0041614Fj
					; .text:00416175j
		add	esp, 44h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4162A4	proc near		; CODE XREF: sub_415CD0+13Bp
					; .text:00415F4Ap

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		cmp	[ebp+arg_4], 1
		jnz	loc_4163A0
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	loc_416395
		cmp	[ebp+arg_0], 0
		jz	short loc_4162DA
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_4162DA
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+5Ch]
		jmp	short loc_4162DF
; ---------------------------------------------------------------------------

loc_4162DA:				; CODE XREF: sub_4162A4+22j
					; sub_4162A4+2Cj
		mov	ecx, offset a?_1 ; "?"

loc_4162DF:				; CODE XREF: sub_4162A4+34j
		cmp	[ebp+arg_0], 0
		jz	short loc_4162ED
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		jmp	short loc_4162F2
; ---------------------------------------------------------------------------

loc_4162ED:				; CODE XREF: sub_4162A4+3Fj
		mov	edx, 0FFFFFFFFh

loc_4162F2:				; CODE XREF: sub_4162A4+47j
		cmp	[ebp+arg_0], 0
		jz	short loc_416300
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		jmp	short loc_416305
; ---------------------------------------------------------------------------

loc_416300:				; CODE XREF: sub_4162A4+52j
		mov	eax, 0FFFFFFFFh

loc_416305:				; CODE XREF: sub_4162A4+5Aj
		mov	ebx, [ebp+arg_8]
		mov	[esp+38h+var_28], ebx
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+var_30], edx
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aIobufD_DIoctlS ; "iobuf-%d.%d: ioctl `%s' keep=%d\n"
		call	sub_41A702
		jmp	short loc_416395
; ---------------------------------------------------------------------------

loc_416326:				; CODE XREF: sub_4162A4+F5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_416359
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_414578
		jnz	short loc_416359
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	[eax+4], edx
		mov	eax, 0
		jmp	loc_416552
; ---------------------------------------------------------------------------

loc_416359:				; CODE XREF: sub_4162A4+8Aj
					; sub_4162A4+97j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_41638C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_414824
		jnz	short loc_41638C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	[eax+4], edx
		mov	eax, 0
		jmp	loc_416552
; ---------------------------------------------------------------------------

loc_41638C:				; CODE XREF: sub_4162A4+BDj
					; sub_4162A4+CAj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_416395:				; CODE XREF: sub_4162A4+18j
					; sub_4162A4+80j
		cmp	[ebp+arg_0], 0
		jnz	short loc_416326
		jmp	loc_41654D
; ---------------------------------------------------------------------------

loc_4163A0:				; CODE XREF: sub_4162A4+Bj
		cmp	[ebp+arg_4], 2
		jnz	short loc_416410
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_4163CF
		cmp	dword ptr [ebp+arg_C], 0
		jz	short loc_4163BA
		mov	eax, dword ptr [ebp+arg_C]
		jmp	short loc_4163BF
; ---------------------------------------------------------------------------

loc_4163BA:				; CODE XREF: sub_4162A4+10Fj
		mov	eax, offset a?_1 ; "?"

loc_4163BF:				; CODE XREF: sub_4162A4+114j
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aIobuf_IoctlSIn ; "iobuf-*.*: ioctl `%s' invalidate\n"
		call	sub_41A702

loc_4163CF:				; CODE XREF: sub_4162A4+109j
		cmp	[ebp+arg_0], 0
		jnz	loc_41654D
		cmp	[ebp+arg_8], 0
		jnz	loc_41654D
		cmp	dword ptr [ebp+arg_C], 0
		jz	loc_41654D
		mov	eax, dword ptr [ebp+arg_C]
		mov	[esp+38h+var_38], eax
		call	sub_41411A
		test	eax, eax
		jz	short loc_416406
		mov	eax, 0FFFFFFFFh
		jmp	loc_416552
; ---------------------------------------------------------------------------

loc_416406:				; CODE XREF: sub_4162A4+156j
		mov	eax, 0
		jmp	loc_416552
; ---------------------------------------------------------------------------

loc_416410:				; CODE XREF: sub_4162A4+100j
		cmp	[ebp+arg_4], 3
		jnz	loc_4164FF
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	loc_4164F7
		cmp	[ebp+arg_0], 0
		jz	short loc_41643F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_41643F
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+5Ch]
		jmp	short loc_416444
; ---------------------------------------------------------------------------

loc_41643F:				; CODE XREF: sub_4162A4+187j
					; sub_4162A4+191j
		mov	ecx, offset a?_1 ; "?"

loc_416444:				; CODE XREF: sub_4162A4+199j
		cmp	[ebp+arg_0], 0
		jz	short loc_416452
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		jmp	short loc_416457
; ---------------------------------------------------------------------------

loc_416452:				; CODE XREF: sub_4162A4+1A4j
		mov	edx, 0FFFFFFFFh

loc_416457:				; CODE XREF: sub_4162A4+1ACj
		cmp	[ebp+arg_0], 0
		jz	short loc_416465
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		jmp	short loc_41646A
; ---------------------------------------------------------------------------

loc_416465:				; CODE XREF: sub_4162A4+1B7j
		mov	eax, 0FFFFFFFFh

loc_41646A:				; CODE XREF: sub_4162A4+1BFj
		mov	ebx, [ebp+arg_8]
		mov	[esp+38h+var_28], ebx
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+var_30], edx
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aIobufD_DIoct_0 ; "iobuf-%d.%d: ioctl `%s' no_cache=%d\n"
		call	sub_41A702
		jmp	short loc_4164F7
; ---------------------------------------------------------------------------

loc_41648B:				; CODE XREF: sub_4162A4+257j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_4164BE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_414578
		jnz	short loc_4164BE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	[eax+8], edx
		mov	eax, 0
		jmp	loc_416552
; ---------------------------------------------------------------------------

loc_4164BE:				; CODE XREF: sub_4162A4+1EFj
					; sub_4162A4+1FCj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_4164EE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_414824
		jnz	short loc_4164EE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+arg_8]
		mov	[eax+8], edx
		mov	eax, 0
		jmp	short loc_416552
; ---------------------------------------------------------------------------

loc_4164EE:				; CODE XREF: sub_4162A4+222j
					; sub_4162A4+22Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_4164F7:				; CODE XREF: sub_4162A4+17Dj
					; sub_4162A4+1E5j
		cmp	[ebp+arg_0], 0
		jnz	short loc_41648B
		jmp	short loc_41654D
; ---------------------------------------------------------------------------

loc_4164FF:				; CODE XREF: sub_4162A4+170j
		cmp	[ebp+arg_4], 4
		jnz	short loc_41654D
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_41652E
		cmp	dword ptr [ebp+arg_C], 0
		jz	short loc_416519
		mov	eax, dword ptr [ebp+arg_C]
		jmp	short loc_41651E
; ---------------------------------------------------------------------------

loc_416519:				; CODE XREF: sub_4162A4+26Ej
		mov	eax, offset aNull_0 ; "<null>"

loc_41651E:				; CODE XREF: sub_4162A4+273j
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aIobuf_IoctlSFs ; "iobuf-*.*: ioctl `%s' fsync\n"
		call	sub_41A702

loc_41652E:				; CODE XREF: sub_4162A4+268j
		cmp	[ebp+arg_0], 0
		jnz	short loc_41654D
		cmp	[ebp+arg_8], 0
		jnz	short loc_41654D
		cmp	dword ptr [ebp+arg_C], 0
		jz	short loc_41654D
		mov	eax, dword ptr [ebp+arg_C]
		mov	[esp+38h+var_38], eax
		call	sub_4141ED
		jmp	short loc_416552
; ---------------------------------------------------------------------------

loc_41654D:				; CODE XREF: sub_4162A4+F7j
					; sub_4162A4+12Fj ...
		mov	eax, 0FFFFFFFFh

loc_416552:				; CODE XREF: sub_4162A4+B0j
					; sub_4162A4+E3j ...
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_4162A4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416558	proc near		; CODE XREF: .text:00417F30p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_416581
		leave
		retn
sub_416558	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416581	proc near		; CODE XREF: sub_416558+22p

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	[ebp+var_24], 0
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_4165BE
		mov	[esp+48h+var_40], offset aIobuf_push_fil ; "iobuf_push_filter2"
		mov	dword ptr [esp+48h+var_44], 653h
		mov	[esp+48h+var_48], offset a____Gnupg22__3 ; "../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_41A7F4
; ---------------------------------------------------------------------------

loc_4165BE:				; CODE XREF: sub_416581+1Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_4165E4
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_4171F0
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_4165E4
		mov	eax, [ebp+var_1C]
		jmp	loc_4168B4
; ---------------------------------------------------------------------------

loc_4165E4:				; CODE XREF: sub_416581+45j
					; sub_416581+59j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+58h]
		cmp	eax, 3Fh
		jle	short loc_416605
		mov	[esp+48h+var_48], offset aIOFilterTooDee ; "i/o	filter too deeply nested - corrupte"...
		call	sub_41A665
		mov	eax, 59h
		jmp	loc_4168B4
; ---------------------------------------------------------------------------

loc_416605:				; CODE XREF: sub_416581+6Cj
		mov	[esp+48h+var_48], 68h ;	size_t
		call	sub_406D00
		mov	[ebp+var_20], eax
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_20]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_416636
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_416636:				; CODE XREF: sub_416581+A5j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_41664E
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_41664E:				; CODE XREF: sub_416581+BCj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_416676
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_416676:				; CODE XREF: sub_416581+E8j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_416684
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_416684:				; CODE XREF: sub_416581+FAj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		test	eax, eax
		jz	short loc_41669E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_406E03
		jmp	short loc_4166A3
; ---------------------------------------------------------------------------

loc_41669E:				; CODE XREF: sub_416581+10Bj
		mov	eax, 0

loc_4166A3:				; CODE XREF: sub_416581+11Bj
		mov	edx, [ebp+var_20]
		mov	[edx+4Ch], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+40h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+44h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+48h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+38h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 3
		jnz	short loc_4166E4
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 2

loc_4166E4:				; CODE XREF: sub_416581+158j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_41671A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[esp+48h+var_48], eax ;	size_t
		call	sub_406D00
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[eax+34h], edx
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+2Ch], 0
		jmp	short loc_416744
; ---------------------------------------------------------------------------

loc_41671A:				; CODE XREF: sub_416581+16Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[esp+48h+var_48], eax ;	size_t
		call	sub_406D00
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+34h], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0

loc_416744:				; CODE XREF: sub_416581+197j
		mov	eax, [ebp+var_20]
		mov	ecx, [eax+18h]
		mov	ebx, [eax+1Ch]
		mov	eax, [ebp+var_20]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+arg_0]
		mov	[ecx+18h], eax
		mov	[ecx+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		mov	ecx, [ebp+arg_0]
		mov	[ecx+8], eax
		mov	[ecx+0Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	edx, eax
		and	edx, 0FFFFFFFEh
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_20]
		mov	[eax+50h], edx
		mov	eax, [ebp+var_20]
		mov	edx, [eax+60h]
		mov	eax, [ebp+arg_0]
		mov	[eax+60h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+40h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[eax+44h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_C]
		mov	[eax+48h], edx
		mov	eax, [ebp+var_20]
		mov	eax, [eax+58h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+58h], edx
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp+var_24]
		mov	[esp+48h+var_38], eax
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], 0
		mov	dword ptr [esp+48h+var_44], 5
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_48], eax
		mov	eax, [ebp+arg_4]
		call	eax
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_416851
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_41681D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		jmp	short loc_416822
; ---------------------------------------------------------------------------

loc_41681D:				; CODE XREF: sub_416581+292j
		mov	eax, offset a?_1 ; "?"

loc_416822:				; CODE XREF: sub_416581+29Aj
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], ecx
		mov	dword ptr [esp+48h+var_44], edx	; char
		mov	[esp+48h+var_48], offset aIobufD_DPushS	; "iobuf-%d.%d:	push `%s'\n"
		call	sub_41A702
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_415568

loc_416851:				; CODE XREF: sub_416581+288j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_4168B1
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ecx, [ebp+var_24]
		mov	[esp+48h+var_38], ecx
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], edx
		mov	dword ptr [esp+48h+var_44], 1
		mov	[esp+48h+var_48], eax
		call	ebx
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_4168B1
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aIobufctrl_init ; "IOBUFCTRL_INIT failed: %s\n"
		call	sub_41A665

loc_4168B1:				; CODE XREF: sub_416581+2D8j
					; sub_416581+313j
		mov	eax, [ebp+var_1C]

loc_4168B4:				; CODE XREF: sub_416581+5Ej
					; sub_416581+7Fj
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_416581	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4168BC	proc near		; CODE XREF: .text:0041786Bp
					; .text:004178FBp ...

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	[ebp+var_24], 0
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_4168F9
		mov	[esp+48h+var_40], offset aPop_filter ; "pop_filter"
		mov	[esp+48h+var_44], 6AAh
		mov	[esp+48h+var_48], offset a____Gnupg22__3 ; "../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_41A7F4
; ---------------------------------------------------------------------------

loc_4168F9:				; CODE XREF: sub_4168BC+1Fj
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_41693D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_416914
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		jmp	short loc_416919
; ---------------------------------------------------------------------------

loc_416914:				; CODE XREF: sub_4168BC+4Ej
		mov	eax, offset a?_1 ; "?"

loc_416919:				; CODE XREF: sub_4168BC+56j
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], ecx
		mov	[esp+48h+var_44], edx ;	char
		mov	[esp+48h+var_48], offset aIobufD_DPopS ; "iobuf-%d.%d: pop `%s'\n"
		call	sub_41A702

loc_41693D:				; CODE XREF: sub_4168BC+44j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jnz	loc_416A17
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_416976
		mov	[esp+48h+var_40], 6B2h ; int
		mov	[esp+48h+var_44], offset a____Gnupg22__3 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+var_48], offset aB ; "b"
		call	sub_421040

loc_416976:				; CODE XREF: sub_4168BC+9Cj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+48h+var_48], eax ;	void *
		call	sub_406E5D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+48h+var_48], eax ;	void *
		call	sub_406E5D
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_4169B4
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_4169B4:				; CODE XREF: sub_4168BC+E8j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_4169CC
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_4169CC:				; CODE XREF: sub_4168BC+FFj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_4169F4
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_4169F4:				; CODE XREF: sub_4168BC+12Bj
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_416A02
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_416A02:				; CODE XREF: sub_4168BC+13Dj
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax ;	void *
		call	sub_406E5D
		mov	eax, 0
		jmp	loc_416C4B
; ---------------------------------------------------------------------------

loc_416A17:				; CODE XREF: sub_4168BC+89j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], eax
		jmp	short loc_416A44
; ---------------------------------------------------------------------------

loc_416A1F:				; CODE XREF: sub_4168BC+18Cj
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+40h]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_416A3B
		cmp	[ebp+arg_8], 0
		jz	short loc_416A4A
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+44h]
		cmp	eax, [ebp+arg_8]
		jz	short loc_416A4A

loc_416A3B:				; CODE XREF: sub_4168BC+16Cj
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+50h]
		mov	[ebp+var_1C], eax

loc_416A44:				; CODE XREF: sub_4168BC+161j
		cmp	[ebp+var_1C], 0
		jnz	short loc_416A1F

loc_416A4A:				; CODE XREF: sub_4168BC+172j
					; sub_4168BC+17Dj
		cmp	[ebp+var_1C], 0
		jnz	short loc_416A5C
		mov	[esp+48h+var_48], offset aPop_filterFilt ; "pop_filter(): filter function not found"...
		call	sub_41A6D5
; ---------------------------------------------------------------------------

loc_416A5C:				; CODE XREF: sub_4168BC+192j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_416A9D
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	sub_4171F0
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_416A9D
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aIobuf_flushF_0 ; "iobuf_flush	failed in pop_filter: %s\n"
		call	sub_41A665
		mov	eax, [ebp+var_20]
		jmp	loc_416C4B
; ---------------------------------------------------------------------------

loc_416A9D:				; CODE XREF: sub_4168BC+1A8j
					; sub_4168BC+1BCj
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_416B05
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax+40h]
		mov	eax, [ebp+var_1C]
		mov	edx, [eax+50h]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+44h]
		lea	ecx, [ebp+var_24]
		mov	[esp+48h+var_38], ecx
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], 2
		mov	[esp+48h+var_48], eax
		call	ebx
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_416B05
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aIobufctrl_fr_0 ; "IOBUFCTRL_FREE failed: %s\n"
		call	sub_41A665
		mov	eax, [ebp+var_20]
		jmp	loc_416C4B
; ---------------------------------------------------------------------------

loc_416B05:				; CODE XREF: sub_4168BC+1E9j
					; sub_4168BC+224j
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+44h]
		test	eax, eax
		jz	short loc_416B31
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+48h]
		test	eax, eax
		jz	short loc_416B31
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+44h]
		mov	[esp+48h+var_48], eax ;	void *
		call	sub_406E5D
		mov	eax, [ebp+var_1C]
		mov	dword ptr [eax+44h], 0

loc_416B31:				; CODE XREF: sub_4168BC+251j
					; sub_4168BC+25Bj
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+var_1C]
		jnz	short loc_416B4F
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_416B4F
		mov	[esp+48h+var_48], offset aCanTRemoveTheL ; "can't remove the last filter from the c"...
		call	sub_41A6D5
; ---------------------------------------------------------------------------

loc_416B4F:				; CODE XREF: sub_4168BC+27Bj
					; sub_4168BC+285j
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+var_1C]
		jnz	loc_416C26
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+48h+var_48], eax ;	void *
		call	sub_406E5D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+48h+var_48], eax ;	void *
		call	sub_406E5D
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_416BA2
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_416BA2:				; CODE XREF: sub_4168BC+2D6j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_416BBA
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_416BBA:				; CODE XREF: sub_4168BC+2EDj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_416BE2
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_416BE2:				; CODE XREF: sub_4168BC+319j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_416BF0
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_416BF0:				; CODE XREF: sub_4168BC+32Bj
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax ;	void *
		call	sub_406E5D
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_416C48
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aIobufD_DPopped ; "iobuf-%d.%d: popped	filter\n"
		call	sub_41A702
		jmp	short loc_416C48
; ---------------------------------------------------------------------------

loc_416C26:				; CODE XREF: sub_4168BC+299j
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_416C3C
		mov	[esp+48h+var_48], offset aOhhJeeeTryingT ; "Ohh	jeee, trying to	remove a head filte"...
		call	sub_41A6D5
; ---------------------------------------------------------------------------

loc_416C3C:				; CODE XREF: sub_4168BC+372j
		mov	[esp+48h+var_48], offset aOhhJeeeTryin_0 ; "Ohh	jeee, trying to	remove an intermedi"...
		call	sub_41A6D5
; ---------------------------------------------------------------------------

loc_416C48:				; CODE XREF: sub_4168BC+346j
					; sub_4168BC+368j
		mov	eax, [ebp+var_20]

loc_416C4B:				; CODE XREF: sub_4168BC+156j
					; sub_4168BC+1DCj ...
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4168BC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416C53	proc near		; CODE XREF: sub_41735E+73p
					; sub_417407+136p ...

DstBuf		= dword	ptr -58h
ElementSize	= dword	ptr -54h
Count		= dword	ptr -50h
File		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jz	short loc_416C88
		mov	[esp+58h+Count], 6FAh ;	int
		mov	[esp+58h+ElementSize], offset a____Gnupg22__3 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+58h+DstBuf], offset aAD_startAD_len ; "a->d.start == a->d.len"
		call	sub_421040

loc_416C88:				; CODE XREF: sub_416C53+17j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 3
		jnz	short loc_416C9C
		mov	eax, 0FFFFFFFFh
		jmp	loc_4171E8
; ---------------------------------------------------------------------------

loc_416C9C:				; CODE XREF: sub_416C53+3Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+38h]
		test	eax, eax
		jz	loc_416DE6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jz	loc_416DA9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_1C], eax
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_416D05
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_416CDC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		jmp	short loc_416CE1
; ---------------------------------------------------------------------------

loc_416CDC:				; CODE XREF: sub_416C53+7Fj
		mov	eax, offset a?_1 ; "?"

loc_416CE1:				; CODE XREF: sub_416C53+87j
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+58h+File],	eax
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+ElementSize], edx ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DPopSIn ; "iobuf-%d.%d: pop `%s' in underflow\n"
		call	sub_41A702

loc_416D05:				; CODE XREF: sub_416C53+75j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+58h+DstBuf], eax ;	void *
		call	sub_406E5D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+58h+DstBuf], eax ;	void *
		call	sub_406E5D
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_416D43
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_416D43:				; CODE XREF: sub_416C53+E0j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_416D5B
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_416D5B:				; CODE XREF: sub_416C53+F7j
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_416D83
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_416D83:				; CODE XREF: sub_416C53+123j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_416D91
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_416D91:				; CODE XREF: sub_416C53+135j
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+DstBuf], eax ;	void *
		call	sub_406E5D
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+DstBuf], eax
		call	sub_415568
		jmp	short loc_416DB3
; ---------------------------------------------------------------------------

loc_416DA9:				; CODE XREF: sub_416C53+5Fj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+38h], 0

loc_416DB3:				; CODE XREF: sub_416C53+154j
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_416DDC
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnderf ; "iobuf-%d.%d: underflow: eof	(due to	fil"...
		call	sub_41A702

loc_416DDC:				; CODE XREF: sub_416C53+167j
		mov	eax, 0FFFFFFFFh
		jmp	loc_4171E8
; ---------------------------------------------------------------------------

loc_416DE6:				; CODE XREF: sub_416C53+51j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		test	eax, eax
		jz	short loc_416E23
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_416E19
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DError	; "iobuf-%d.%d:	error\n"
		call	sub_41A702

loc_416E19:				; CODE XREF: sub_416C53+1A4j
		mov	eax, 0FFFFFFFFh
		jmp	loc_4171E8
; ---------------------------------------------------------------------------

loc_416E23:				; CODE XREF: sub_416C53+19Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_416ED1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+28h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	ecx, [ebp+var_20]
		mov	[esp+58h+File],	ecx ; File
		mov	[esp+58h+Count], edx ; Count
		mov	[esp+58h+ElementSize], 1 ; ElementSize
		mov	[esp+58h+DstBuf], eax ;	DstBuf
		call	fread
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+28h]
		mov	eax, [ebp+var_2C]
		cmp	edx, eax
		jbe	short loc_416E8D
		mov	eax, [ebp+var_20]
		mov	[esp+58h+DstBuf], eax ;	File
		call	ferror
		test	eax, eax
		jz	short loc_416E8D
		call	sub_414005
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+3Ch], edx

loc_416E8D:				; CODE XREF: sub_416C53+21Cj
					; sub_416C53+22Bj
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+arg_0]
		mov	[eax+30h], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jz	short loc_416EC7
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_0]
		mov	[edx+2Ch], ecx
		jmp	short loc_416ECC
; ---------------------------------------------------------------------------

loc_416EC7:				; CODE XREF: sub_416C53+252j
		mov	eax, 0FFFFFFFFh

loc_416ECC:				; CODE XREF: sub_416C53+272j
		jmp	loc_4171E8
; ---------------------------------------------------------------------------

loc_416ED1:				; CODE XREF: sub_416C53+1D8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	loc_4171BA
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[ebp+var_2C], eax
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_416F18
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+File],	ecx
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnde_0 ; "iobuf-%d.%d: underflow: req=%lu\n"
		call	sub_41A702

loc_416F18:				; CODE XREF: sub_416C53+29Cj
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ebx, [ebp+var_2C]
		mov	[esp+58h+var_48], ebx
		mov	[esp+58h+File],	ecx
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], 3
		mov	[esp+58h+DstBuf], eax
		call	esi
		mov	[ebp+var_24], eax
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_416F86
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	ebx, [ebp+var_24]
		mov	[esp+58h+var_48], ebx
		mov	[esp+58h+File],	ecx
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnde_1 ; "iobuf-%d.%d: underflow: got=%lu rc=%d\n"
		call	sub_41A702

loc_416F86:				; CODE XREF: sub_416C53+303j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 1
		jnz	loc_41713E
		cmp	[ebp+var_24], 0FFFFFFFFh
		jnz	loc_41713E
		mov	[ebp+var_30], 0
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ecx, [ebp+var_30]
		mov	[esp+58h+var_48], ecx
		mov	[esp+58h+File],	0
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], 2
		mov	[esp+58h+DstBuf], eax
		call	ebx
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_416FFB
		mov	eax, [ebp+var_24]
		mov	[esp+58h+DstBuf], eax
		call	gpg_strerror
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufctrl_fr_0 ; "IOBUFCTRL_FREE failed: %s\n"
		call	sub_41A665

loc_416FFB:				; CODE XREF: sub_416C53+38Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		test	eax, eax
		jz	short loc_417027
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+48h]
		test	eax, eax
		jz	short loc_417027
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[esp+58h+DstBuf], eax ;	void *
		call	sub_406E5D
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+44h], 0

loc_417027:				; CODE XREF: sub_416C53+3B0j
					; sub_416C53+3BAj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+40h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+5Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+44h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+38h], 1
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jnz	loc_41714F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jz	loc_41714F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_28], eax
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_41709A
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DPopInU ; "iobuf-%d.%d: pop in	underflow (!len)\n"
		call	sub_41A702

loc_41709A:				; CODE XREF: sub_416C53+425j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+58h+DstBuf], eax ;	void *
		call	sub_406E5D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+58h+DstBuf], eax ;	void *
		call	sub_406E5D
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+arg_0]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_4170D8
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_4170D8:				; CODE XREF: sub_416C53+475j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_4170F0
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_4170F0:				; CODE XREF: sub_416C53+48Cj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_417118
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_417118:				; CODE XREF: sub_416C53+4B8j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_417126
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_417126:				; CODE XREF: sub_416C53+4CAj
		mov	eax, [ebp+var_28]
		mov	[esp+58h+DstBuf], eax ;	void *
		call	sub_406E5D
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+DstBuf], eax
		call	sub_415568
		jmp	short loc_41714F
; ---------------------------------------------------------------------------

loc_41713E:				; CODE XREF: sub_416C53+33Bj
					; sub_416C53+345j
		cmp	[ebp+var_24], 0
		jz	short loc_417150
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_24]
		mov	[eax+3Ch], edx
		jmp	short loc_417150
; ---------------------------------------------------------------------------

loc_41714F:				; CODE XREF: sub_416C53+401j
					; sub_416C53+40Fj ...
		nop

loc_417150:				; CODE XREF: sub_416C53+4EFj
					; sub_416C53+4FAj
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jnz	short loc_417187
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_417180
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnde_2 ; "iobuf-%d.%d: underflow: eof\n"
		call	sub_41A702

loc_417180:				; CODE XREF: sub_416C53+50Bj
		mov	eax, 0FFFFFFFFh
		jmp	short loc_4171E8
; ---------------------------------------------------------------------------

loc_417187:				; CODE XREF: sub_416C53+502j
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+arg_0]
		mov	[eax+30h], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_0]
		mov	[edx+2Ch], ecx
		jmp	short loc_4171E8
; ---------------------------------------------------------------------------

loc_4171BA:				; CODE XREF: sub_416C53+286j
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_4171E3
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnde_3 ; "iobuf-%d.%d: underflow: eof	(no filter)"...
		call	sub_41A702

loc_4171E3:				; CODE XREF: sub_416C53+56Ej
		mov	eax, 0FFFFFFFFh

loc_4171E8:				; CODE XREF: sub_416C53+44j
					; sub_416C53+18Ej ...
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_416C53	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4171F0	proc near		; CODE XREF: sub_4156D1+8Bp
					; sub_416581+4Dp ...

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 30h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_41720C
		mov	eax, 0
		jmp	loc_417357
; ---------------------------------------------------------------------------

loc_41720C:				; CODE XREF: sub_4171F0+10j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 3
		jnz	loc_4172A7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		add	eax, 2000h
		mov	[ebp+var_10], eax
		mov	eax, ds:dword_429068
		test	eax, eax
		jz	short loc_41724E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Src], eax ; char
		mov	[esp+38h+Dst], offset aIncreasingTemp ;	"increasing temp iobuf from %lu	to %lu\n"
		call	sub_41A702

loc_41724E:				; CODE XREF: sub_4171F0+3Fj
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax ; size_t
		call	sub_406D00
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+38h+Dst], eax ; void *
		call	sub_406E5D
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		mov	[eax+34h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+28h], edx
		mov	eax, 0
		jmp	loc_417357
; ---------------------------------------------------------------------------

loc_4172A7:				; CODE XREF: sub_4171F0+24j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jz	short loc_4172BD
		mov	[esp+38h+Dst], offset aFlushOnNonOutp ;	"flush on non-output iobuf\n"
		call	sub_41A6D5
; ---------------------------------------------------------------------------

loc_4172BD:				; CODE XREF: sub_4171F0+BFj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jnz	short loc_4172D3
		mov	[esp+38h+Dst], offset aIobuf_flushNoF ;	"iobuf_flush: no filter\n"
		call	sub_41A6D5
; ---------------------------------------------------------------------------

loc_4172D3:				; CODE XREF: sub_4171F0+D5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ebx, [ebp+var_18]
		mov	[esp+38h+var_28], ebx
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Src], 4 ; char
		mov	[esp+38h+Dst], eax
		call	esi
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41733B
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+var_18]
		cmp	edx, eax
		jz	short loc_41733B
		mov	[esp+38h+Dst], offset aIobuf_flushDid ;	"iobuf_flush did not write all!\n"
		call	sub_41A63B
		mov	[ebp+var_C], 3Fh
		jmp	short loc_41734A
; ---------------------------------------------------------------------------

loc_41733B:				; CODE XREF: sub_4171F0+127j
					; sub_4171F0+134j
		cmp	[ebp+var_C], 0
		jz	short loc_41734A
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+3Ch], edx

loc_41734A:				; CODE XREF: sub_4171F0+149j
					; sub_4171F0+14Fj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+var_C]

loc_417357:				; CODE XREF: sub_4171F0+17j
					; sub_4171F0+B2j
		add	esp, 30h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_4171F0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41735E	proc near		; CODE XREF: sub_414A2D+FBp
					; sub_414A2D+1E3p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [eax+8]
		or	eax, edx
		test	eax, eax
		jz	short loc_417399
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [eax+8]
		cmp	ebx, edx
		jl	short loc_417399
		cmp	ebx, edx
		jg	short loc_417392
		cmp	ecx, eax
		jb	short loc_417399

loc_417392:				; CODE XREF: sub_41735E+2Ej
		mov	eax, 0FFFFFFFFh
		jmp	short loc_417401
; ---------------------------------------------------------------------------

loc_417399:				; CODE XREF: sub_41735E+14j
					; sub_41735E+2Aj ...
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jnb	short loc_4173CB
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		add	edx, eax
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		mov	[ebp+var_C], edx
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+2Ch], edx
		jmp	short loc_4173E6
; ---------------------------------------------------------------------------

loc_4173CB:				; CODE XREF: sub_41735E+49j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_416C53
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_4173E6
		mov	eax, 0FFFFFFFFh
		jmp	short loc_417401
; ---------------------------------------------------------------------------

loc_4173E6:				; CODE XREF: sub_41735E+6Bj
					; sub_41735E+7Fj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_0]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+var_C]

loc_417401:				; CODE XREF: sub_41735E+39j
					; sub_41735E+86j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_41735E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417407	proc near		; CODE XREF: .text:00413EBEp
					; sub_414A2D+514p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [eax+8]
		or	eax, edx
		test	eax, eax
		jz	short loc_417481
		mov	[ebp+var_10], 0
		jmp	short loc_41746E
; ---------------------------------------------------------------------------

loc_41742C:				; CODE XREF: sub_417407+6Dj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_41735E
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_417450
		cmp	[ebp+var_10], 0
		jnz	short loc_417478
		mov	eax, 0FFFFFFFFh
		jmp	loc_4175C0
; ---------------------------------------------------------------------------

loc_417450:				; CODE XREF: sub_417407+37j
		cmp	[ebp+var_C], 0
		jz	short loc_417460
		mov	eax, [ebp+var_18]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], dl

loc_417460:				; CODE XREF: sub_417407+4Dj
		cmp	[ebp+var_C], 0
		jz	short loc_41746A
		add	[ebp+var_C], 1

loc_41746A:				; CODE XREF: sub_417407+5Dj
		add	[ebp+var_10], 1

loc_41746E:				; CODE XREF: sub_417407+23j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jb	short loc_41742C
		jmp	short loc_417479
; ---------------------------------------------------------------------------

loc_417478:				; CODE XREF: sub_417407+3Dj
		nop

loc_417479:				; CODE XREF: sub_417407+6Fj
		mov	eax, [ebp+var_10]
		jmp	loc_4175C0
; ---------------------------------------------------------------------------

loc_417481:				; CODE XREF: sub_417407+1Aj
		mov	[ebp+var_10], 0

loc_417488:				; CODE XREF: sub_417407+192j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jnb	loc_41752F
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jnb	loc_41752F
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+var_14]
		jnb	short loc_4174DD
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax

loc_4174DD:				; CODE XREF: sub_417407+C5j
		cmp	[ebp+var_C], 0
		jz	short loc_417509
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		add	edx, eax
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+var_14]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy

loc_417509:				; CODE XREF: sub_417407+DAj
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_14]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	[eax+2Ch], edx
		cmp	[ebp+var_C], 0
		jz	short loc_41752F
		mov	eax, [ebp+var_14]
		add	[ebp+var_C], eax

loc_41752F:				; CODE XREF: sub_417407+87j
					; sub_417407+9Bj ...
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jnb	short loc_417593
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_416C53
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_41757B
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	edx, eax
		sar	edx, 1Fh
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+arg_0]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		cmp	[ebp+var_10], 0
		jz	short loc_417574
		mov	eax, [ebp+var_10]
		jmp	short loc_417579
; ---------------------------------------------------------------------------

loc_417574:				; CODE XREF: sub_417407+166j
		mov	eax, 0FFFFFFFFh

loc_417579:				; CODE XREF: sub_417407+16Bj
		jmp	short loc_4175C0
; ---------------------------------------------------------------------------

loc_41757B:				; CODE XREF: sub_417407+142j
		cmp	[ebp+var_C], 0
		jz	short loc_41758F
		mov	eax, [ebp+var_18]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_41758F:				; CODE XREF: sub_417407+178j
		add	[ebp+var_10], 1

loc_417593:				; CODE XREF: sub_417407+12Ej
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jb	loc_417488
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	edx, eax
		sar	edx, 1Fh
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+arg_0]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+var_10]

loc_4175C0:				; CODE XREF: sub_417407+44j
					; sub_417407+75j ...
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_417407	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax+38h]
		test	eax, eax
		jz	short loc_4175E7
		mov	eax, 0FFFFFFFFh
		jmp	locret_417683
; ---------------------------------------------------------------------------

loc_4175E7:				; CODE XREF: .text:004175DBj
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_41763F
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_416C53
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_41760E
		mov	eax, 0FFFFFFFFh
		jmp	short locret_417683
; ---------------------------------------------------------------------------

loc_41760E:				; CODE XREF: .text:00417605j
		mov	eax, [ebp+8]
		mov	eax, [eax+2Ch]
		cmp	eax, 1
		jz	short loc_417635
		mov	dword ptr [esp+8], 7FCh
		mov	dword ptr [esp+4], offset a____Gnupg22__3 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	dword ptr [esp], offset	aAD_start1 ; "a->d.start == 1"
		call	sub_421040

loc_417635:				; CODE XREF: .text:00417617j
		mov	eax, [ebp+8]
		mov	dword ptr [eax+2Ch], 0

loc_41763F:				; CODE XREF: .text:004175F5j
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_417663
; ---------------------------------------------------------------------------

loc_417648:				; CODE XREF: .text:0041767Ej
		mov	eax, [ebp+8]
		mov	edx, [eax+34h]
		mov	eax, [ebp-0Ch]
		add	eax, edx
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp+0Ch], 1

loc_417663:				; CODE XREF: .text:00417646j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jnb	short loc_417680
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp-0Ch]
		add	edx, eax
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_417648

loc_417680:				; CODE XREF: .text:00417669j
		mov	eax, [ebp-0Ch]

locret_417683:				; CODE XREF: .text:004175E2j
					; .text:0041760Cj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417685	proc near		; CODE XREF: sub_414A2D+6E3p
					; sub_414A2D+95Bp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_4176B1
		mov	[esp+28h+var_20], offset aIobuf_writebyt ; "iobuf_writebyte"
		mov	[esp+28h+var_24], 80Eh
		mov	[esp+28h+var_28], offset a____Gnupg22__3 ; "../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_41A7F4
; ---------------------------------------------------------------------------

loc_4176B1:				; CODE XREF: sub_417685+Ej
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		cmp	edx, eax
		jnz	short loc_4176DA
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4171F0
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4176DA
		mov	eax, [ebp+var_C]
		jmp	short locret_417728
; ---------------------------------------------------------------------------

loc_4176DA:				; CODE XREF: sub_417685+3Aj
					; sub_417685+4Ej
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		cmp	edx, eax
		jb	short loc_417706
		mov	[esp+28h+var_20], 814h ; int
		mov	[esp+28h+var_24], offset a____Gnupg22__3 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+28h+var_28], offset aAD_lenAD_size	; "a->d.len < a->d.size"
		call	sub_421040

loc_417706:				; CODE XREF: sub_417685+63j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+arg_4]
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+30h], edx
		mov	eax, 0

locret_417728:				; CODE XREF: sub_417685+53j
		leave
		retn
sub_417685	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41772A	proc near		; CODE XREF: sub_414A2D+733p
					; sub_414A2D+782p ...

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_41775C
		mov	[esp+28h+Size],	offset aIobuf_write ; "iobuf_write"
		mov	[esp+28h+Src], 821h
		mov	[esp+28h+Dst], offset a____Gnupg22__3 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_41A7F4
; ---------------------------------------------------------------------------

loc_41775C:				; CODE XREF: sub_41772A+14j
					; sub_41772A+D1j
		cmp	[ebp+arg_8], 0
		jz	short loc_4177D8
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		cmp	edx, eax
		jnb	short loc_4177D8
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+28h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jbe	short loc_417795
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax

loc_417795:				; CODE XREF: sub_41772A+63j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	ecx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		add	eax, ecx
		mov	ecx, [ebp+var_10]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_10]
		sub	[ebp+arg_8], eax
		mov	eax, [ebp+var_10]
		add	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	edx, eax
		add	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax+30h], edx

loc_4177D8:				; CODE XREF: sub_41772A+36j
					; sub_41772A+46j
		cmp	[ebp+arg_8], 0
		jz	short loc_4177F7
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_4171F0
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_4177F7
		mov	eax, [ebp+var_14]
		jmp	short locret_417806
; ---------------------------------------------------------------------------

loc_4177F7:				; CODE XREF: sub_41772A+B2j
					; sub_41772A+C6j
		cmp	[ebp+arg_8], 0
		jnz	loc_41775C
		mov	eax, 0

locret_417806:				; CODE XREF: sub_41772A+CBj
		leave
		retn
sub_41772A	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		jmp	short loc_41783A
; ---------------------------------------------------------------------------

loc_417810:				; CODE XREF: .text:00417842j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_417685
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_417836
		mov	eax, [ebp-0Ch]
		jmp	short locret_417849
; ---------------------------------------------------------------------------

loc_417836:				; CODE XREF: .text:0041782Fj
		add	dword ptr [ebp+0Ch], 1

loc_41783A:				; CODE XREF: .text:0041780Ej
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_417810
		mov	eax, 0

locret_417849:				; CODE XREF: .text:00417834j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		jmp	short loc_417870
; ---------------------------------------------------------------------------

loc_417853:				; CODE XREF: .text:00417878j
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+40h]
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_4168BC

loc_417870:				; CODE XREF: .text:00417851j
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_417853
		mov	eax, [ebp+0Ch]
		mov	edx, [eax+30h]
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+34h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41772A
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jbe	short loc_4178B8
		mov	eax, [ebp+10h]
		mov	[ebp-0Ch], eax

loc_4178B8:				; CODE XREF: .text:004178B0j
		mov	eax, [ebp+8]
		mov	eax, [eax+34h]
		mov	edx, eax
		mov	eax, [ebp+0Ch]
		mov	ecx, [ebp-0Ch]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		jmp	short loc_417900
; ---------------------------------------------------------------------------

loc_4178E3:				; CODE XREF: .text:00417908j
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4168BC

loc_417900:				; CODE XREF: .text:004178E1j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_4178E3
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0Ch
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		mov	eax, [ebp+10h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-10h]
		mov	edx, [ebp-0Ch]
		or	eax, edx
		test	eax, eax
		jz	short loc_41793E
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		mov	edx, eax
		or	edx, 1
		mov	eax, [ebp+8]
		mov	[eax+20h], edx
		jmp	short loc_41794F
; ---------------------------------------------------------------------------

loc_41793E:				; CODE XREF: .text:00417929j
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		mov	edx, eax
		and	edx, 0FFFFFFFEh
		mov	eax, [ebp+8]
		mov	[eax+20h], edx

loc_41794F:				; CODE XREF: .text:0041793Cj
		mov	ecx, [ebp+8]
		mov	eax, [ebp-10h]
		mov	edx, [ebp-0Ch]
		mov	[ecx+8], eax
		mov	[ecx+0Ch], edx
		mov	eax, [ebp+8]
		mov	ecx, [eax+18h]
		mov	ebx, [eax+1Ch]
		mov	eax, [ebp+8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+8]
		mov	[ecx+18h], eax
		mov	[ecx+1Ch], edx
		mov	eax, [ebp+8]
		mov	dword ptr [eax+10h], 0
		mov	dword ptr [eax+14h], 0
		add	esp, 0Ch
		pop	ebx
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417994	proc near		; CODE XREF: .text:00413E85p

File		= dword	ptr -68h
lpFileSizeHigh	= dword	ptr -64h
var_60		= dword	ptr -60h
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= byte ptr -50h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
hFile		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		cmp	[ebp+arg_4], 0
		jz	short loc_4179A9
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0

loc_4179A9:				; CODE XREF: sub_417994+Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_417B54
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+68h+File],	eax ; File
		call	_fileno
		lea	edx, [ebp+var_50]
		mov	[esp+68h+lpFileSizeHigh], edx
		mov	[esp+68h+File],	eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		test	eax, eax
		jnz	short loc_4179EB
		mov	eax, [ebp+var_38]
		mov	edx, [ebp+var_34]
		jmp	locret_417B68
; ---------------------------------------------------------------------------

loc_4179EB:				; CODE XREF: sub_417994+4Aj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+File],	eax ; int
		call	strerror
		mov	[esp+68h+lpFileSizeHigh], eax ;	char
		mov	[esp+68h+File],	offset aFstatFailedS ; "fstat()	failed:	%s\n"
		call	sub_41A665
		mov	eax, 0
		mov	edx, 0
		jmp	locret_417B68
; ---------------------------------------------------------------------------

loc_417A1B:				; CODE XREF: sub_417994+1C4j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	loc_417B4B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_414578
		jnz	loc_417B4B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[ebp+hFile], eax
		mov	eax, ds:dword_428A50
		test	eax, eax
		jnz	short loc_417AA7
		mov	[esp+68h+lpFileSizeHigh], 0
		mov	[esp+68h+File],	offset aKernel32_dll ; "kernel32.dll"
		call	sub_41401A
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_417A9D
		mov	[esp+68h+lpFileSizeHigh], offset aGetfilesizeex	; "GetFileSizeEx"
		mov	eax, [ebp+var_18]
		mov	[esp+68h+File],	eax ; HMODULE
		call	sub_414038
		mov	ds:dword_428A54, eax
		mov	eax, ds:dword_428A54
		test	eax, eax
		jnz	short loc_417A9D
		mov	eax, [ebp+var_18]
		mov	[esp+68h+File],	eax ; HANDLE
		call	sub_41407D

loc_417A9D:				; CODE XREF: sub_417994+DBj
					; sub_417994+FCj
		mov	ds:dword_428A50, 1

loc_417AA7:				; CODE XREF: sub_417994+BEj
		mov	eax, ds:dword_428A54
		test	eax, eax
		jz	short loc_417AFB
		mov	edx, ds:dword_428A54
		lea	eax, [ebp+var_58]
		mov	[esp+68h+lpFileSizeHigh], eax
		mov	eax, [ebp+hFile]
		mov	[esp+68h+File],	eax
		call	edx ; dword_428A54
		sub	esp, 8
		test	eax, eax
		jz	short loc_417B26
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	short loc_417AE0
		mov	eax, [ebp+var_58]
		mov	edx, 0
		jmp	locret_417B68
; ---------------------------------------------------------------------------

loc_417AE0:				; CODE XREF: sub_417994+13Dj
		cmp	[ebp+arg_4], 0
		jz	short loc_417AEF
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 1

loc_417AEF:				; CODE XREF: sub_417994+150j
		mov	eax, 0
		mov	edx, 0
		jmp	short locret_417B68
; ---------------------------------------------------------------------------

loc_417AFB:				; CODE XREF: sub_417994+11Aj
		mov	[esp+68h+lpFileSizeHigh], 0 ; lpFileSizeHigh
		mov	eax, [ebp+hFile]
		mov	[esp+68h+File],	eax ; hFile
		mov	eax, ds:GetFileSize
		call	eax ; GetFileSize
		sub	esp, 8
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jz	short loc_417B26
		mov	eax, [ebp+var_1C]
		mov	edx, 0
		jmp	short locret_417B68
; ---------------------------------------------------------------------------

loc_417B26:				; CODE XREF: sub_417994+136j
					; sub_417994+186j
		mov	[esp+68h+File],	0 ; DWORD
		call	sub_41B9A2
		mov	[esp+68h+var_60], eax
		mov	eax, [ebp+hFile]
		mov	[esp+68h+lpFileSizeHigh], eax ;	char
		mov	[esp+68h+File],	offset aGetfilesizeFor ; "GetFileSize for handle %p failed: %s\n"
		call	sub_41A665
		jmp	short loc_417B5E
; ---------------------------------------------------------------------------

loc_417B4B:				; CODE XREF: sub_417994+8Fj
					; sub_417994+A0j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_417B54:				; CODE XREF: sub_417994+1Dj
		cmp	[ebp+arg_0], 0
		jnz	loc_417A1B

loc_417B5E:				; CODE XREF: sub_417994+1B5j
		mov	eax, 0
		mov	edx, 0

locret_417B68:				; CODE XREF: sub_417994+52j
					; sub_417994+82j ...
		leave
		retn
sub_417994	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_417BC0
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	[esp], eax
		call	_fileno
		jmp	short locret_417BCB
; ---------------------------------------------------------------------------

loc_417B8A:				; CODE XREF: .text:00417BC4j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_417BB7
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_414578
		jnz	short loc_417BB7
		mov	eax, [ebp+8]
		mov	eax, [eax+44h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		jmp	short locret_417BCB
; ---------------------------------------------------------------------------

loc_417BB7:				; CODE XREF: .text:00417B92j
					; .text:00417B9Fj
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		mov	[ebp+8], eax

loc_417BC0:				; CODE XREF: .text:00417B78j
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_417B8A
		mov	eax, 0FFFFFFFFh

locret_417BCB:				; CODE XREF: .text:00417B88j
					; .text:00417BB5j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		mov	eax, [ebp+8]
		mov	ecx, [eax+18h]
		mov	ebx, [eax+1Ch]
		mov	eax, [ebp+8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, ecx
		adc	edx, ebx
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+0Ch]
		mov	[ebp-20h], eax
		mov	eax, [ebp+10h]
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_417CA5
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	[ebp-10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp-20h]
		mov	edx, [ebp-1Ch]
		mov	[esp+4], eax
		mov	[esp+8], edx
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_421200
		test	eax, eax
		jz	short loc_417C6A
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp], eax
		call	strerror
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aCanTSeekS ; "can't seek: %s\n"
		call	sub_41A665
		mov	eax, 0FFFFFFFFh
		jmp	locret_417DBC
; ---------------------------------------------------------------------------

loc_417C6A:				; CODE XREF: .text:00417C3Dj
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	clearerr
		jmp	loc_417D15
; ---------------------------------------------------------------------------

loc_417C7A:				; CODE XREF: .text:00417CA9j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_417C9C
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_414578
		jnz	short loc_417C9C
		mov	eax, [ebp+8]
		mov	eax, [eax+44h]
		mov	[ebp-0Ch], eax
		jmp	short loc_417CAB
; ---------------------------------------------------------------------------

loc_417C9C:				; CODE XREF: .text:00417C82j
					; .text:00417C8Fj
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		mov	[ebp+8], eax

loc_417CA5:				; CODE XREF: .text:00417C0Bj
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_417C7A

loc_417CAB:				; CODE XREF: .text:00417C9Aj
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_417CBB
		mov	eax, 0FFFFFFFFh
		jmp	locret_417DBC
; ---------------------------------------------------------------------------

loc_417CBB:				; CODE XREF: .text:00417CAFj
		mov	edx, [ebp-20h]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		mov	eax, ds:SetFilePointer
		call	eax ; SetFilePointer
		sub	esp, 10h
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_417D15
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aSetfilepointer	; "SetFilePointer failed on handle %p: ec="...
		call	sub_41A665
		mov	eax, 0FFFFFFFFh
		jmp	locret_417DBC
; ---------------------------------------------------------------------------

loc_417D15:				; CODE XREF: .text:00417C75j
					; .text:00417CE7j
		mov	eax, [ebp+8]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+8]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+8]
		mov	dword ptr [eax+10h], 0
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+8]
		mov	dword ptr [eax+8], 0
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		mov	edx, eax
		and	edx, 0FFFFFFFEh
		mov	eax, [ebp+8]
		mov	[eax+20h], edx
		mov	ecx, [ebp+8]
		mov	eax, [ebp-20h]
		mov	edx, [ebp-1Ch]
		mov	[ecx+18h], eax
		mov	[ecx+1Ch], edx
		mov	eax, [ebp+8]
		mov	dword ptr [eax+3Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jz	short loc_417DAC
		mov	dword ptr [esp], offset	aPop_filterCall	; "pop_filter called in	iobuf_seek - pleas"...
		call	sub_41A702
		jmp	short loc_417DAC
; ---------------------------------------------------------------------------

loc_417D8D:				; CODE XREF: .text:00417DB5j
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4168BC
		jmp	short loc_417DAD
; ---------------------------------------------------------------------------

loc_417DAC:				; CODE XREF: .text:00417D7Dj
					; .text:00417D8Bj
		nop

loc_417DAD:				; CODE XREF: .text:00417DAAj
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_417D8D
		mov	eax, 0

locret_417DBC:				; CODE XREF: .text:00417C65j
					; .text:00417CB6j ...
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_417DBE	proc near		; CODE XREF: .text:004158BDp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		test	eax, eax
		jz	short loc_417E18
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		jmp	short locret_417E23
; ---------------------------------------------------------------------------

loc_417DD6:				; CODE XREF: sub_417DBE+5Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_417E0F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_414578
		jnz	short loc_417E0F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_4]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_417E08
		mov	eax, [ebp+var_4]
		add	eax, 14h
		jmp	short loc_417E0D
; ---------------------------------------------------------------------------

loc_417E08:				; CODE XREF: sub_417DBE+40j
		mov	eax, 0

loc_417E0D:				; CODE XREF: sub_417DBE+48j
		jmp	short locret_417E23
; ---------------------------------------------------------------------------

loc_417E0F:				; CODE XREF: sub_417DBE+20j
					; sub_417DBE+2Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_417E18:				; CODE XREF: sub_417DBE+Ej
		cmp	[ebp+arg_0], 0
		jnz	short loc_417DD6
		mov	eax, 0

locret_417E23:				; CODE XREF: sub_417DBE+16j
					; sub_417DBE:loc_417E0Dj
		leave
		retn
sub_417DBE	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		jmp	short loc_417E5E
; ---------------------------------------------------------------------------

loc_417E2D:				; CODE XREF: .text:00417E62j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_417E55
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_414578
		jnz	short loc_417E55
		mov	eax, [ebp+8]
		mov	eax, [eax+44h]
		mov	[ebp-4], eax
		mov	eax, [ebp-4]
		add	eax, 14h
		jmp	short locret_417E69
; ---------------------------------------------------------------------------

loc_417E55:				; CODE XREF: .text:00417E35j
					; .text:00417E42j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		mov	[ebp+8], eax

loc_417E5E:				; CODE XREF: .text:00417E2Bj
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_417E2D
		mov	eax, 0

locret_417E69:				; CODE XREF: .text:00417E53j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 20h
		mov	dword ptr [esp], 1
		call	sub_406DD8
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 1
		jz	short loc_417EBA
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 2
		jz	short loc_417EBA
		mov	dword ptr [esp+8], 98Ch
		mov	dword ptr [esp+4], offset a____Gnupg22__3 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	dword ptr [esp], offset	aAUse1AUse2 ; "a->use == 1 || a->use ==	2"
		call	sub_421040
		jmp	short loc_417EBB
; ---------------------------------------------------------------------------

loc_417EBA:				; CODE XREF: .text:00417E90j
					; .text:00417E9Aj
		nop

loc_417EBB:				; CODE XREF: .text:00417EB8j
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], edx
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_417EFE
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 1
		jnz	short loc_417EE1
		mov	dword ptr [esp], offset	aPop_filterCa_0	; "pop_filter called in	set_partial_block_"...
		call	sub_41A702

loc_417EE1:				; CODE XREF: .text:00417ED3j
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], offset sub_414A2D
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4168BC
		jmp	short locret_417F35
; ---------------------------------------------------------------------------

loc_417EFE:				; CODE XREF: .text:00417EC9j
		mov	eax, [ebp-0Ch]
		mov	dword ptr [eax+0Ch], 1
		mov	eax, [ebp-0Ch]
		mov	dword ptr [eax+4], 0
		mov	edx, [ebp+0Ch]
		mov	eax, [ebp-0Ch]
		mov	[eax+18h], edx
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], offset sub_414A2D
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_416558

locret_417F35:				; CODE XREF: .text:00417EFCj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		mov	[ebp-14h], eax
		mov	dword ptr [ebp-18h], 0
		mov	eax, [ebp+14h]
		mov	eax, [eax]
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_417F87
		mov	dword ptr [ebp-14h], 100h
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_406D00
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp+10h]
		mov	edx, [ebp-14h]
		mov	[eax], edx

loc_417F87:				; CODE XREF: .text:00417F60j
		sub	dword ptr [ebp-14h], 3
		mov	eax, [ebp-10h]
		mov	[ebp-1Ch], eax
		jmp	loc_41809E
; ---------------------------------------------------------------------------

loc_417F96:				; CODE XREF: .text:00418102j
		mov	eax, [ebp-18h]
		cmp	eax, [ebp-14h]
		jnz	loc_418086
		mov	eax, [ebp-14h]
		cmp	eax, [ebp-20h]
		jbe	loc_418036

loc_417FAE:				; CODE XREF: .text:00418018j
		cmp	dword ptr [ebp-0Ch], 0Ah
		jz	short loc_41801A
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_417FCE
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_417FDB

loc_417FCE:				; CODE XREF: .text:00417FBCj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41735E
		jmp	short loc_418011
; ---------------------------------------------------------------------------

loc_417FDB:				; CODE XREF: .text:00417FCCj
		mov	eax, [ebp+8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+2Ch], ecx

loc_418011:				; CODE XREF: .text:00417FD9j
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_417FAE

loc_41801A:				; CODE XREF: .text:00417FB2j
		mov	eax, [ebp-1Ch]
		mov	byte ptr [eax],	0Ah
		add	dword ptr [ebp-1Ch], 1
		add	dword ptr [ebp-18h], 1
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0
		jmp	loc_41810B
; ---------------------------------------------------------------------------

loc_418036:				; CODE XREF: .text:00417FA8j
		add	dword ptr [ebp-14h], 3
		cmp	dword ptr [ebp-14h], 3FFh
		ja	short loc_41804A
		mov	eax, 100h
		jmp	short loc_41804F
; ---------------------------------------------------------------------------

loc_41804A:				; CODE XREF: .text:00418041j
		mov	eax, 400h

loc_41804F:				; CODE XREF: .text:00418048j
		add	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_406D93
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp+10h]
		mov	edx, [ebp-14h]
		mov	[eax], edx
		sub	dword ptr [ebp-14h], 3
		mov	eax, [ebp-18h]
		mov	edx, [ebp-10h]
		add	eax, edx
		mov	[ebp-1Ch], eax

loc_418086:				; CODE XREF: .text:00417F9Cj
		mov	eax, [ebp-0Ch]
		mov	edx, eax
		mov	eax, [ebp-1Ch]
		mov	[eax], dl
		add	dword ptr [ebp-1Ch], 1
		add	dword ptr [ebp-18h], 1
		cmp	dword ptr [ebp-0Ch], 0Ah
		jz	short loc_41810A

loc_41809E:				; CODE XREF: .text:00417F91j
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_4180B8
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_4180C5

loc_4180B8:				; CODE XREF: .text:004180A6j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41735E
		jmp	short loc_4180FB
; ---------------------------------------------------------------------------

loc_4180C5:				; CODE XREF: .text:004180B6j
		mov	eax, [ebp+8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+2Ch], ecx

loc_4180FB:				; CODE XREF: .text:004180C3j
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	loc_417F96
		jmp	short loc_41810B
; ---------------------------------------------------------------------------

loc_41810A:				; CODE XREF: .text:0041809Cj
		nop

loc_41810B:				; CODE XREF: .text:00418031j
					; .text:00418108j
		mov	eax, [ebp-1Ch]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-18h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_418116	proc near		; CODE XREF: sub_415AE9+78p
					; .text:00415FC5p

nStdHandle	= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+arg_0], 0
		jnz	short loc_418138
		mov	[esp+28h+nStdHandle], 0FFFFFFF6h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+var_C], eax
		jmp	short loc_418176
; ---------------------------------------------------------------------------

loc_418138:				; CODE XREF: sub_418116+Aj
		cmp	dword ptr [ebp+arg_0], 1
		jnz	short loc_418154
		mov	[esp+28h+nStdHandle], 0FFFFFFF5h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+var_C], eax
		jmp	short loc_418176
; ---------------------------------------------------------------------------

loc_418154:				; CODE XREF: sub_418116+26j
		cmp	dword ptr [ebp+arg_0], 2
		jnz	short loc_418170
		mov	[esp+28h+nStdHandle], 0FFFFFFF4h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+var_C], eax
		jmp	short loc_418176
; ---------------------------------------------------------------------------

loc_418170:				; CODE XREF: sub_418116+42j
		mov	eax, dword ptr [ebp+arg_0]
		mov	[ebp+var_C], eax

loc_418176:				; CODE XREF: sub_418116+20j
					; sub_418116+3Cj ...
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_41819A
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+nStdHandle], offset aGetstdhandleDF ; "GetStdHandle(%d) failed: ec=%d\n"
		call	sub_41A702

loc_41819A:				; CODE XREF: sub_418116+64j
		mov	eax, [ebp+var_C]
		mov	dword ptr [ebp+arg_0], eax
		mov	eax, dword ptr [ebp+arg_0]
		leave
		retn
sub_418116	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_418224

loc_4181B2:				; CODE XREF: .text:00418220j
					; .text:loc_418222j
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_4181CC
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_4181E1

loc_4181CC:				; CODE XREF: .text:004181BAj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41735E
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_418222
		jmp	loc_4182C4
; ---------------------------------------------------------------------------

loc_4181E1:				; CODE XREF: .text:004181CAj
		mov	eax, [ebp+8]
		mov	edx, [eax+30h]
		mov	eax, [ebp+8]
		mov	eax, [eax+2Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp-14h]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+8]
		mov	edx, [eax+30h]
		mov	eax, [ebp+8]
		mov	[eax+2Ch], edx
		jmp	short loc_4181B2
; ---------------------------------------------------------------------------

loc_418222:				; CODE XREF: .text:004181DAj
		jmp	short loc_4181B2
; ---------------------------------------------------------------------------

loc_418224:				; CODE XREF: .text:004181B0j
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	loc_4182B7
; ---------------------------------------------------------------------------

loc_41822F:				; CODE XREF: .text:004182BBj
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_418249
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_41825F

loc_418249:				; CODE XREF: .text:00418237j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41735E
		cmp	eax, 0FFFFFFFFh
		jz	short loc_4182C3
		sub	dword ptr [ebp-0Ch], 1
		jmp	short loc_4182B7
; ---------------------------------------------------------------------------

loc_41825F:				; CODE XREF: .text:00418247j
		mov	eax, [ebp+8]
		mov	edx, [eax+30h]
		mov	eax, [ebp+8]
		mov	eax, [eax+2Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		cmp	eax, [ebp-0Ch]
		jbe	short loc_418282
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax

loc_418282:				; CODE XREF: .text:0041827Aj
		mov	eax, [ebp+8]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp-10h]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+8]
		mov	eax, [eax+2Ch]
		mov	edx, eax
		add	edx, [ebp-10h]
		mov	eax, [ebp+8]
		mov	[eax+2Ch], edx
		mov	eax, [ebp-10h]
		sub	[ebp-0Ch], eax

loc_4182B7:				; CODE XREF: .text:0041822Aj
					; .text:0041825Dj
		cmp	dword ptr [ebp-0Ch], 0
		jnz	loc_41822F
		jmp	short loc_4182C4
; ---------------------------------------------------------------------------

loc_4182C3:				; CODE XREF: .text:00418257j
		nop

loc_4182C4:				; CODE XREF: .text:004181DCj
					; .text:004182C1j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4182CC(char *)
sub_4182CC	proc near		; CODE XREF: sub_419496+1Dp
					; .text:00419DF0p

VarName		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_12		= word ptr -12h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+VarName], offset aLc_all ; "LC_ALL"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4182F9
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4182F9
		mov	eax, [ebp+var_C]
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4182F9:				; CODE XREF: sub_4182CC+19j
					; sub_4182CC+23j
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+VarName], eax ; VarName
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41831F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41831F
		mov	eax, [ebp+var_C]
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41831F:				; CODE XREF: sub_4182CC+3Fj
					; sub_4182CC+49j
		mov	[esp+38h+VarName], offset aLang	; "LANG"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_418346
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_418346
		mov	eax, [ebp+var_C]
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418346:				; CODE XREF: sub_4182CC+66j
					; sub_4182CC+70j
		mov	eax, ds:GetThreadLocale
		call	eax ; GetThreadLocale
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_12], ax
		movzx	eax, [ebp+var_12]
		and	eax, 3FFh
		mov	[ebp+var_18], eax
		movzx	eax, [ebp+var_12]
		shr	ax, 0Ah
		movzx	eax, ax
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_18], 79h ; switch 122 cases
		ja	loc_418E0C	; jumptable 00418388 default case
		mov	eax, [ebp+var_18]
		shl	eax, 2
		add	eax, offset off_4266DC
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41838A:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aAf_za ; jumptable 00418388	case 54
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418394:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aSq_al ; jumptable 00418388	case 28
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41839E:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aAm_et ; jumptable 00418388	case 94
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4183A8:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		cmp	[ebp+var_1C], 10h ; jumptable 00418388 case 1
		ja	loc_418461	; jumptable 004183BF default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_4268C4
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4183C1:				; CODE XREF: sub_4182CC+F3j
					; DATA XREF: .rdata:off_4268C4o
		mov	eax, offset aAr_sa ; jumptable 004183BF	case 1
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4183CB:				; CODE XREF: sub_4182CC+F3j
					; DATA XREF: .rdata:off_4268C4o
		mov	eax, offset aAr_iq ; jumptable 004183BF	case 2
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4183D5:				; CODE XREF: sub_4182CC+F3j
					; DATA XREF: .rdata:off_4268C4o
		mov	eax, offset aAr_eg ; jumptable 004183BF	case 3
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4183DF:				; CODE XREF: sub_4182CC+F3j
					; DATA XREF: .rdata:off_4268C4o
		mov	eax, offset aAr_ly ; jumptable 004183BF	case 4
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4183E9:				; CODE XREF: sub_4182CC+F3j
					; DATA XREF: .rdata:off_4268C4o
		mov	eax, offset aAr_dz ; jumptable 004183BF	case 5
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4183F3:				; CODE XREF: sub_4182CC+F3j
					; DATA XREF: .rdata:off_4268C4o
		mov	eax, offset aAr_ma ; jumptable 004183BF	case 6
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4183FD:				; CODE XREF: sub_4182CC+F3j
					; DATA XREF: .rdata:off_4268C4o
		mov	eax, offset aAr_tn ; jumptable 004183BF	case 7
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418407:				; CODE XREF: sub_4182CC+F3j
					; DATA XREF: .rdata:off_4268C4o
		mov	eax, offset aAr_om ; jumptable 004183BF	case 8
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418411:				; CODE XREF: sub_4182CC+F3j
					; DATA XREF: .rdata:off_4268C4o
		mov	eax, offset aAr_ye ; jumptable 004183BF	case 9
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41841B:				; CODE XREF: sub_4182CC+F3j
					; DATA XREF: .rdata:off_4268C4o
		mov	eax, offset aAr_sy ; jumptable 004183BF	case 10
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418425:				; CODE XREF: sub_4182CC+F3j
					; DATA XREF: .rdata:off_4268C4o
		mov	eax, offset aAr_jo ; jumptable 004183BF	case 11
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41842F:				; CODE XREF: sub_4182CC+F3j
					; DATA XREF: .rdata:off_4268C4o
		mov	eax, offset aAr_lb ; jumptable 004183BF	case 12
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418439:				; CODE XREF: sub_4182CC+F3j
					; DATA XREF: .rdata:off_4268C4o
		mov	eax, offset aAr_kw ; jumptable 004183BF	case 13
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418443:				; CODE XREF: sub_4182CC+F3j
					; DATA XREF: .rdata:off_4268C4o
		mov	eax, offset aAr_ae ; jumptable 004183BF	case 14
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41844D:				; CODE XREF: sub_4182CC+F3j
					; DATA XREF: .rdata:off_4268C4o
		mov	eax, offset aAr_bh ; jumptable 004183BF	case 15
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418457:				; CODE XREF: sub_4182CC+F3j
					; DATA XREF: .rdata:off_4268C4o
		mov	eax, offset aAr_qa ; jumptable 004183BF	case 16
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418461:				; CODE XREF: sub_4182CC+E0j
					; sub_4182CC+F3j
					; DATA XREF: ...
		mov	eax, offset aAr	; jumptable 004183BF default case
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41846B:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aHy_am ; jumptable 00418388	case 43
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418475:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aAs_in ; jumptable 00418388	case 77
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41847F:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, [ebp+var_1C] ; jumptable 00418388 case 44
		cmp	eax, 1
		jz	short loc_41848E
		cmp	eax, 2
		jz	short loc_418498
		jmp	short loc_4184A2
; ---------------------------------------------------------------------------

loc_41848E:				; CODE XREF: sub_4182CC+1B9j
		mov	eax, offset aAz_az@latin ; "az_AZ@latin"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418498:				; CODE XREF: sub_4182CC+1BEj
		mov	eax, offset aAz_az@cyrillic ; "az_AZ@cyrillic"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4184A2:				; CODE XREF: sub_4182CC+1C0j
		mov	eax, offset aAz	; "az"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4184AC:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aEu	; jumptable 00418388 case 45
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4184B6:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aBe_by ; jumptable 00418388	case 35
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4184C0:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, [ebp+var_1C] ; jumptable 00418388 case 69
		cmp	eax, 1
		jz	short loc_4184CF
		cmp	eax, 2
		jz	short loc_4184D9
		jmp	short loc_4184E3
; ---------------------------------------------------------------------------

loc_4184CF:				; CODE XREF: sub_4182CC+1FAj
		mov	eax, offset aBn_in ; "bn_IN"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4184D9:				; CODE XREF: sub_4182CC+1FFj
		mov	eax, offset aBn_bd ; "bn_BD"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4184E3:				; CODE XREF: sub_4182CC+201j
		mov	eax, offset aBn	; "bn"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4184ED:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aBg_bg ; jumptable 00418388	case 2
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4184F7:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aMy_mm ; jumptable 00418388	case 85
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418501:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aKm_kh ; jumptable 00418388	case 83
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41850B:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aCa_es ; jumptable 00418388	case 3
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418515:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aChr_us ; jumptable	00418388 case 92
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41851F:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		cmp	[ebp+var_1C], 5	; jumptable 00418388 case 4
		ja	short loc_418566 ; jumptable 00418532 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_426908
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_418534:				; CODE XREF: sub_4182CC+266j
					; DATA XREF: .rdata:off_426908o
		mov	eax, offset aZh_tw ; jumptable 00418532	case 1
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41853E:				; CODE XREF: sub_4182CC+266j
					; DATA XREF: .rdata:off_426908o
		mov	eax, offset aZh_cn ; jumptable 00418532	case 2
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418548:				; CODE XREF: sub_4182CC+266j
					; DATA XREF: .rdata:off_426908o
		mov	eax, offset aZh_hk ; jumptable 00418532	case 3
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418552:				; CODE XREF: sub_4182CC+266j
					; DATA XREF: .rdata:off_426908o
		mov	eax, offset aZh_sg ; jumptable 00418532	case 4
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41855C:				; CODE XREF: sub_4182CC+266j
					; DATA XREF: .rdata:off_426908o
		mov	eax, offset aZh_mo ; jumptable 00418532	case 5
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418566:				; CODE XREF: sub_4182CC+257j
					; sub_4182CC+266j
					; DATA XREF: ...
		mov	eax, offset aZh	; jumptable 00418532 default case
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418570:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, [ebp+var_1C] ; jumptable 00418388 case 26
		cmp	eax, 2
		jz	short loc_41858C
		cmp	eax, 3
		jz	short loc_418596
		cmp	eax, 1
		jnz	short loc_4185A0
		mov	eax, offset aHr_hr ; "hr_HR"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41858C:				; CODE XREF: sub_4182CC+2AAj
		mov	eax, offset aSr_cs ; "sr_CS"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418596:				; CODE XREF: sub_4182CC+2AFj
		mov	eax, offset aSr_cs@cyrillic ; "sr_CS@cyrillic"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4185A0:				; CODE XREF: sub_4182CC+2B4j
		mov	eax, offset aHr	; "hr"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4185AA:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aCs_cz ; jumptable 00418388	case 5
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4185B4:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aDa_dk ; jumptable 00418388	case 6
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4185BE:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aDiv_mv ; jumptable	00418388 case 101
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4185C8:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, [ebp+var_1C] ; jumptable 00418388 case 19
		cmp	eax, 1
		jz	short loc_4185D7
		cmp	eax, 2
		jz	short loc_4185E1
		jmp	short loc_4185EB
; ---------------------------------------------------------------------------

loc_4185D7:				; CODE XREF: sub_4182CC+302j
		mov	eax, offset aNl_nl ; "nl_NL"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4185E1:				; CODE XREF: sub_4182CC+307j
		mov	eax, offset aNl_be ; "nl_BE"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4185EB:				; CODE XREF: sub_4182CC+309j
		mov	eax, offset aNl	; "nl"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4185F5:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aBin_ng ; jumptable	00418388 case 102
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4185FF:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		cmp	[ebp+var_1C], 12h ; jumptable 00418388 case 9
		ja	loc_4186CC	; jumptable 00418616 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_426920
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_418618:				; CODE XREF: sub_4182CC+34Aj
					; DATA XREF: .rdata:off_426920o
		mov	eax, offset aEn_us ; jumptable 00418616	case 1
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418622:				; CODE XREF: sub_4182CC+34Aj
					; DATA XREF: .rdata:off_426920o
		mov	eax, offset aEn_gb ; jumptable 00418616	case 2
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41862C:				; CODE XREF: sub_4182CC+34Aj
					; DATA XREF: .rdata:off_426920o
		mov	eax, offset aEn_au ; jumptable 00418616	case 3
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418636:				; CODE XREF: sub_4182CC+34Aj
					; DATA XREF: .rdata:off_426920o
		mov	eax, offset aEn_ca ; jumptable 00418616	case 4
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418640:				; CODE XREF: sub_4182CC+34Aj
					; DATA XREF: .rdata:off_426920o
		mov	eax, offset aEn_nz ; jumptable 00418616	case 5
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41864A:				; CODE XREF: sub_4182CC+34Aj
					; DATA XREF: .rdata:off_426920o
		mov	eax, offset aEn_ie ; jumptable 00418616	case 6
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418654:				; CODE XREF: sub_4182CC+34Aj
					; DATA XREF: .rdata:off_426920o
		mov	eax, offset aEn_za ; jumptable 00418616	case 7
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41865E:				; CODE XREF: sub_4182CC+34Aj
					; DATA XREF: .rdata:off_426920o
		mov	eax, offset aEn_jm ; jumptable 00418616	case 8
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418668:				; CODE XREF: sub_4182CC+34Aj
					; DATA XREF: .rdata:off_426920o
		mov	eax, offset aEn_gd ; jumptable 00418616	case 9
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418672:				; CODE XREF: sub_4182CC+34Aj
					; DATA XREF: .rdata:off_426920o
		mov	eax, offset aEn_bz ; jumptable 00418616	case 10
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41867C:				; CODE XREF: sub_4182CC+34Aj
					; DATA XREF: .rdata:off_426920o
		mov	eax, offset aEn_tt ; jumptable 00418616	case 11
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418686:				; CODE XREF: sub_4182CC+34Aj
					; DATA XREF: .rdata:off_426920o
		mov	eax, offset aEn_zw ; jumptable 00418616	case 12
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418690:				; CODE XREF: sub_4182CC+34Aj
					; DATA XREF: .rdata:off_426920o
		mov	eax, offset aEn_ph ; jumptable 00418616	case 13
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41869A:				; CODE XREF: sub_4182CC+34Aj
					; DATA XREF: .rdata:off_426920o
		mov	eax, offset aEn_id ; jumptable 00418616	case 14
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4186A4:				; CODE XREF: sub_4182CC+34Aj
					; DATA XREF: .rdata:off_426920o
		mov	eax, offset aEn_hk ; jumptable 00418616	case 15
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4186AE:				; CODE XREF: sub_4182CC+34Aj
					; DATA XREF: .rdata:off_426920o
		mov	eax, offset aEn_in ; jumptable 00418616	case 16
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4186B8:				; CODE XREF: sub_4182CC+34Aj
					; DATA XREF: .rdata:off_426920o
		mov	eax, offset aEn_my ; jumptable 00418616	case 17
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4186C2:				; CODE XREF: sub_4182CC+34Aj
					; DATA XREF: .rdata:off_426920o
		mov	eax, offset aEn_sg ; jumptable 00418616	case 18
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4186CC:				; CODE XREF: sub_4182CC+337j
					; sub_4182CC+34Aj
					; DATA XREF: ...
		mov	eax, offset aEn	; jumptable 00418616 default case
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4186D6:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aEt_ee ; jumptable 00418388	case 37
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4186E0:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aFo_fo ; jumptable 00418388	case 56
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4186EA:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aFa_ir ; jumptable 00418388	case 41
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4186F4:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aFi_fi ; jumptable 00418388	case 11
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4186FE:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		cmp	[ebp+var_1C], 0Fh ; jumptable 00418388 case 12
		ja	loc_4187AD	; jumptable 00418715 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_42696C
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_418717:				; CODE XREF: sub_4182CC+449j
					; DATA XREF: .rdata:off_42696Co
		mov	eax, offset aFr_fr ; jumptable 00418715	case 1
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418721:				; CODE XREF: sub_4182CC+449j
					; DATA XREF: .rdata:off_42696Co
		mov	eax, offset aFr_be ; jumptable 00418715	case 2
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41872B:				; CODE XREF: sub_4182CC+449j
					; DATA XREF: .rdata:off_42696Co
		mov	eax, offset aFr_ca ; jumptable 00418715	case 3
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418735:				; CODE XREF: sub_4182CC+449j
					; DATA XREF: .rdata:off_42696Co
		mov	eax, offset aFr_ch ; jumptable 00418715	case 4
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41873F:				; CODE XREF: sub_4182CC+449j
					; DATA XREF: .rdata:off_42696Co
		mov	eax, offset aFr_lu ; jumptable 00418715	case 5
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418749:				; CODE XREF: sub_4182CC+449j
					; DATA XREF: .rdata:off_42696Co
		mov	eax, offset aFr_mc ; jumptable 00418715	case 6
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418753:				; CODE XREF: sub_4182CC+449j
					; DATA XREF: .rdata:off_42696Co
		mov	eax, offset aFr	; jumptable 00418715 case 7
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41875D:				; CODE XREF: sub_4182CC+449j
					; DATA XREF: .rdata:off_42696Co
		mov	eax, offset aFr_re ; jumptable 00418715	case 8
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418767:				; CODE XREF: sub_4182CC+449j
					; DATA XREF: .rdata:off_42696Co
		mov	eax, offset aFr_cg ; jumptable 00418715	case 9
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418771:				; CODE XREF: sub_4182CC+449j
					; DATA XREF: .rdata:off_42696Co
		mov	eax, offset aFr_sn ; jumptable 00418715	case 10
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41877B:				; CODE XREF: sub_4182CC+449j
					; DATA XREF: .rdata:off_42696Co
		mov	eax, offset aFr_cm ; jumptable 00418715	case 11
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418785:				; CODE XREF: sub_4182CC+449j
					; DATA XREF: .rdata:off_42696Co
		mov	eax, offset aFr_ci ; jumptable 00418715	case 12
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41878F:				; CODE XREF: sub_4182CC+449j
					; DATA XREF: .rdata:off_42696Co
		mov	eax, offset aFr_ml ; jumptable 00418715	case 13
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418799:				; CODE XREF: sub_4182CC+449j
					; DATA XREF: .rdata:off_42696Co
		mov	eax, offset aFr_ma ; jumptable 00418715	case 14
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4187A3:				; CODE XREF: sub_4182CC+449j
					; DATA XREF: .rdata:off_42696Co
		mov	eax, offset aFr_ht ; jumptable 00418715	case 15
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4187AD:				; CODE XREF: sub_4182CC+436j
					; sub_4182CC+449j
					; DATA XREF: ...
		mov	eax, offset aFr	; jumptable 00418715 default case
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4187B7:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aFy_nl ; jumptable 00418388	case 98
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4187C1:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aFul_ng ; jumptable	00418388 case 103
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4187CB:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, [ebp+var_1C] ; jumptable 00418388 case 60
		cmp	eax, 1
		jz	short loc_4187DA
		cmp	eax, 2
		jz	short loc_4187E4
		jmp	short loc_4187EE
; ---------------------------------------------------------------------------

loc_4187DA:				; CODE XREF: sub_4182CC+505j
		mov	eax, offset aGd_gb ; "gd_GB"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4187E4:				; CODE XREF: sub_4182CC+50Aj
		mov	eax, offset aGa_ie ; "ga_IE"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4187EE:				; CODE XREF: sub_4182CC+50Cj
		mov	eax, offset aC_0 ; "C"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4187F8:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aGl_es ; jumptable 00418388	case 86
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418802:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aKa_ge ; jumptable 00418388	case 55
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41880C:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		cmp	[ebp+var_1C], 5	; jumptable 00418388 case 7
		ja	short loc_418853 ; jumptable 0041881F default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_4269AC
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_418821:				; CODE XREF: sub_4182CC+553j
					; DATA XREF: .rdata:off_4269ACo
		mov	eax, offset aDe_de ; jumptable 0041881F	case 1
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41882B:				; CODE XREF: sub_4182CC+553j
					; DATA XREF: .rdata:off_4269ACo
		mov	eax, offset aDe_ch ; jumptable 0041881F	case 2
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418835:				; CODE XREF: sub_4182CC+553j
					; DATA XREF: .rdata:off_4269ACo
		mov	eax, offset aDe_at ; jumptable 0041881F	case 3
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41883F:				; CODE XREF: sub_4182CC+553j
					; DATA XREF: .rdata:off_4269ACo
		mov	eax, offset aDe_lu ; jumptable 0041881F	case 4
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418849:				; CODE XREF: sub_4182CC+553j
					; DATA XREF: .rdata:off_4269ACo
		mov	eax, offset aDe_li ; jumptable 0041881F	case 5
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418853:				; CODE XREF: sub_4182CC+544j
					; sub_4182CC+553j
					; DATA XREF: ...
		mov	eax, offset aDe	; jumptable 0041881F default case
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41885D:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aEl_gr ; jumptable 00418388	case 8
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418867:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aGn_py ; jumptable 00418388	case 116
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418871:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aGu_in ; jumptable 00418388	case 71
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41887B:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aHa_ng ; jumptable 00418388	case 104
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418885:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aCpe_us ; jumptable	00418388 case 117
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41888F:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aHe_il ; jumptable 00418388	case 13
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418899:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aHi_in ; jumptable 00418388	case 57
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4188A3:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aHu_hu ; jumptable 00418388	case 14
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4188AD:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aNic_ng ; jumptable	00418388 case 105
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4188B7:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aIs_is ; jumptable 00418388	case 15
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4188C1:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aIbo_ng ; jumptable	00418388 case 112
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4188CB:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aId_id ; jumptable 00418388	case 33
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4188D5:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aIu_ca ; jumptable 00418388	case 93
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4188DF:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, [ebp+var_1C] ; jumptable 00418388 case 16
		cmp	eax, 1
		jz	short loc_4188EE
		cmp	eax, 2
		jz	short loc_4188F8
		jmp	short loc_418902
; ---------------------------------------------------------------------------

loc_4188EE:				; CODE XREF: sub_4182CC+619j
		mov	eax, offset aIt_it ; "it_IT"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4188F8:				; CODE XREF: sub_4182CC+61Ej
		mov	eax, offset aIt_ch ; "it_CH"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418902:				; CODE XREF: sub_4182CC+620j
		mov	eax, offset aIt	; "it"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41890C:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aJa_jp ; jumptable 00418388	case 17
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418916:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aKn_in ; jumptable 00418388	case 75
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418920:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aKau_ng ; jumptable	00418388 case 113
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41892A:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, [ebp+var_1C] ; jumptable 00418388 case 96
		cmp	eax, 1
		jz	short loc_418939
		cmp	eax, 2
		jz	short loc_418943
		jmp	short loc_41894D
; ---------------------------------------------------------------------------

loc_418939:				; CODE XREF: sub_4182CC+664j
		mov	eax, offset aKs_pk ; "ks_PK"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418943:				; CODE XREF: sub_4182CC+669j
		mov	eax, offset aKs_in ; "ks_IN"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41894D:				; CODE XREF: sub_4182CC+66Bj
		mov	eax, offset aKs	; "ks"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418957:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aKk_kz ; jumptable 00418388	case 63
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418961:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aKok_in ; jumptable	00418388 case 87
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41896B:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aKo_kr ; jumptable 00418388	case 18
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418975:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aKy_kg ; jumptable 00418388	case 64
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41897F:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aLo_la ; jumptable 00418388	case 84
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418989:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aLa_va ; jumptable 00418388	case 118
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418993:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aLv_lv ; jumptable 00418388	case 38
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_41899D:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aLt_lt ; jumptable 00418388	case 39
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4189A7:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aMk_mk ; jumptable 00418388	case 47
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4189B1:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, [ebp+var_1C] ; jumptable 00418388 case 62
		cmp	eax, 1
		jz	short loc_4189C0
		cmp	eax, 2
		jz	short loc_4189CA
		jmp	short loc_4189D4
; ---------------------------------------------------------------------------

loc_4189C0:				; CODE XREF: sub_4182CC+6EBj
		mov	eax, offset aMs_my ; "ms_MY"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4189CA:				; CODE XREF: sub_4182CC+6F0j
		mov	eax, offset aMs_bn ; "ms_BN"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4189D4:				; CODE XREF: sub_4182CC+6F2j
		mov	eax, offset aMs	; "ms"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4189DE:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aMl_in ; jumptable 00418388	case 76
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4189E8:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aMt_mt ; jumptable 00418388	case 58
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4189F2:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aMni_in ; jumptable	00418388 case 88
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_4189FC:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aMr_in ; jumptable 00418388	case 78
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418A06:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aMn	; jumptable 00418388 case 80
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418A10:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, [ebp+var_1C] ; jumptable 00418388 case 97
		cmp	eax, 1
		jz	short loc_418A1F
		cmp	eax, 2
		jz	short loc_418A29
		jmp	short loc_418A33
; ---------------------------------------------------------------------------

loc_418A1F:				; CODE XREF: sub_4182CC+74Aj
		mov	eax, offset aNe_np ; "ne_NP"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418A29:				; CODE XREF: sub_4182CC+74Fj
		mov	eax, offset aNe_in ; "ne_IN"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418A33:				; CODE XREF: sub_4182CC+751j
		mov	eax, offset aNe	; "ne"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418A3D:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, [ebp+var_1C] ; jumptable 00418388 case 20
		cmp	eax, 1
		jz	short loc_418A4C
		cmp	eax, 2
		jz	short loc_418A56
		jmp	short loc_418A60
; ---------------------------------------------------------------------------

loc_418A4C:				; CODE XREF: sub_4182CC+777j
		mov	eax, offset aNo_no ; "no_NO"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418A56:				; CODE XREF: sub_4182CC+77Cj
		mov	eax, offset aNn_no ; "nn_NO"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418A60:				; CODE XREF: sub_4182CC+77Ej
		mov	eax, offset aNo_0 ; "no"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418A6A:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aOr_in ; jumptable 00418388	case 72
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418A74:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aOm_et ; jumptable 00418388	case 114
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418A7E:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aPap_an ; jumptable	00418388 case 121
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418A88:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aPs	; jumptable 00418388 case 99
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418A92:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aPl_pl ; jumptable 00418388	case 21
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418A9C:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, [ebp+var_1C] ; jumptable 00418388 case 22
		cmp	eax, 1
		jz	short loc_418AB3
		cmp	eax, 2
		jnz	short loc_418ABD
		mov	eax, offset aPt_pt ; "pt_PT"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418AB3:				; CODE XREF: sub_4182CC+7D6j
		mov	eax, offset aPt_br ; "pt_BR"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418ABD:				; CODE XREF: sub_4182CC+7DBj
		mov	eax, offset aPt	; "pt"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418AC7:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, [ebp+var_1C] ; jumptable 00418388 case 70
		cmp	eax, 1
		jnz	short loc_418AD9
		mov	eax, offset aPa_in ; "pa_IN"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418AD9:				; CODE XREF: sub_4182CC+801j
		mov	eax, offset aPa	; "pa"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418AE3:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aRm_ch ; jumptable 00418388	case 23
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418AED:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, [ebp+var_1C] ; jumptable 00418388 case 24
		cmp	eax, 1
		jnz	short loc_418AFF
		mov	eax, offset aRo_ro ; "ro_RO"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418AFF:				; CODE XREF: sub_4182CC+827j
		mov	eax, offset aRo	; "ro"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418B09:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aRu	; jumptable 00418388 case 25
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418B13:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aSe_no ; jumptable 00418388	case 59
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418B1D:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aSa_in ; jumptable 00418388	case 79
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418B27:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, [ebp+var_1C] ; jumptable 00418388 case 89
		test	eax, eax
		jz	short loc_418B35
		cmp	eax, 1
		jz	short loc_418B3F
		jmp	short loc_418B49
; ---------------------------------------------------------------------------

loc_418B35:				; CODE XREF: sub_4182CC+860j
		mov	eax, offset aSd_in ; "sd_IN"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418B3F:				; CODE XREF: sub_4182CC+865j
		mov	eax, offset aSd_pk ; "sd_PK"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418B49:				; CODE XREF: sub_4182CC+867j
		mov	eax, offset aSd	; "sd"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418B53:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aSi_lk ; jumptable 00418388	case 91
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418B5D:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aSk_sk ; jumptable 00418388	case 27
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418B67:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aSl_si ; jumptable 00418388	case 36
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418B71:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aSo_so ; jumptable 00418388	case 119
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418B7B:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aWen_de ; jumptable	00418388 case 46
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418B85:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		cmp	[ebp+var_1C], 14h ; jumptable 00418388 case 10
		ja	loc_418C66	; jumptable 00418B9C default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_4269C4
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_418B9E:				; CODE XREF: sub_4182CC+8D0j
					; DATA XREF: .rdata:off_4269C4o
		mov	eax, offset aEs_es ; jumptable 00418B9C	case 1
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418BA8:				; CODE XREF: sub_4182CC+8D0j
					; DATA XREF: .rdata:off_4269C4o
		mov	eax, offset aEs_mx ; jumptable 00418B9C	case 2
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418BB2:				; CODE XREF: sub_4182CC+8D0j
					; DATA XREF: .rdata:off_4269C4o
		mov	eax, offset aEs_es@modern ; jumptable 00418B9C case 3
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418BBC:				; CODE XREF: sub_4182CC+8D0j
					; DATA XREF: .rdata:off_4269C4o
		mov	eax, offset aEs_gt ; jumptable 00418B9C	case 4
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418BC6:				; CODE XREF: sub_4182CC+8D0j
					; DATA XREF: .rdata:off_4269C4o
		mov	eax, offset aEs_cr ; jumptable 00418B9C	case 5
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418BD0:				; CODE XREF: sub_4182CC+8D0j
					; DATA XREF: .rdata:off_4269C4o
		mov	eax, offset aEs_pa ; jumptable 00418B9C	case 6
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418BDA:				; CODE XREF: sub_4182CC+8D0j
					; DATA XREF: .rdata:off_4269C4o
		mov	eax, offset aEs_do ; jumptable 00418B9C	case 7
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418BE4:				; CODE XREF: sub_4182CC+8D0j
					; DATA XREF: .rdata:off_4269C4o
		mov	eax, offset aEs_ve ; jumptable 00418B9C	case 8
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418BEE:				; CODE XREF: sub_4182CC+8D0j
					; DATA XREF: .rdata:off_4269C4o
		mov	eax, offset aEs_co ; jumptable 00418B9C	case 9
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418BF8:				; CODE XREF: sub_4182CC+8D0j
					; DATA XREF: .rdata:off_4269C4o
		mov	eax, offset aEs_pe ; jumptable 00418B9C	case 10
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418C02:				; CODE XREF: sub_4182CC+8D0j
					; DATA XREF: .rdata:off_4269C4o
		mov	eax, offset aEs_ar ; jumptable 00418B9C	case 11
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418C0C:				; CODE XREF: sub_4182CC+8D0j
					; DATA XREF: .rdata:off_4269C4o
		mov	eax, offset aEs_ec ; jumptable 00418B9C	case 12
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418C16:				; CODE XREF: sub_4182CC+8D0j
					; DATA XREF: .rdata:off_4269C4o
		mov	eax, offset aEs_cl ; jumptable 00418B9C	case 13
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418C20:				; CODE XREF: sub_4182CC+8D0j
					; DATA XREF: .rdata:off_4269C4o
		mov	eax, offset aEs_uy ; jumptable 00418B9C	case 14
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418C2A:				; CODE XREF: sub_4182CC+8D0j
					; DATA XREF: .rdata:off_4269C4o
		mov	eax, offset aEs_py ; jumptable 00418B9C	case 15
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418C34:				; CODE XREF: sub_4182CC+8D0j
					; DATA XREF: .rdata:off_4269C4o
		mov	eax, offset aEs_bo ; jumptable 00418B9C	case 16
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418C3E:				; CODE XREF: sub_4182CC+8D0j
					; DATA XREF: .rdata:off_4269C4o
		mov	eax, offset aEs_sv ; jumptable 00418B9C	case 17
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418C48:				; CODE XREF: sub_4182CC+8D0j
					; DATA XREF: .rdata:off_4269C4o
		mov	eax, offset aEs_hn ; jumptable 00418B9C	case 18
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418C52:				; CODE XREF: sub_4182CC+8D0j
					; DATA XREF: .rdata:off_4269C4o
		mov	eax, offset aEs_ni ; jumptable 00418B9C	case 19
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418C5C:				; CODE XREF: sub_4182CC+8D0j
					; DATA XREF: .rdata:off_4269C4o
		mov	eax, offset aEs_pr ; jumptable 00418B9C	case 20
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418C66:				; CODE XREF: sub_4182CC+8BDj
					; sub_4182CC+8D0j
					; DATA XREF: ...
		mov	eax, offset aEs	; jumptable 00418B9C default case
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418C70:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aBnt_tz ; jumptable	00418388 case 48
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418C7A:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aSw_ke ; jumptable 00418388	case 65
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418C84:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, [ebp+var_1C] ; jumptable 00418388 case 29
		cmp	eax, 1
		jz	short loc_418C93
		cmp	eax, 2
		jz	short loc_418C9D
		jmp	short loc_418CA7
; ---------------------------------------------------------------------------

loc_418C93:				; CODE XREF: sub_4182CC+9BEj
		mov	eax, offset aSv_se ; "sv_SE"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418C9D:				; CODE XREF: sub_4182CC+9C3j
		mov	eax, offset aSv_fi ; "sv_FI"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418CA7:				; CODE XREF: sub_4182CC+9C5j
		mov	eax, offset aSv	; "sv"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418CB1:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aSyr_tr ; jumptable	00418388 case 90
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418CBB:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aTl_ph ; jumptable 00418388	case 100
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418CC5:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aTg_tj ; jumptable 00418388	case 40
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418CCF:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, [ebp+var_1C] ; jumptable 00418388 case 95
		cmp	eax, 1
		jz	short loc_418CDE
		cmp	eax, 2
		jz	short loc_418CE8
		jmp	short loc_418CF2
; ---------------------------------------------------------------------------

loc_418CDE:				; CODE XREF: sub_4182CC+A09j
		mov	eax, offset aBer_ma@arabic ; "ber_MA@arabic"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418CE8:				; CODE XREF: sub_4182CC+A0Ej
		mov	eax, offset aBer_ma@latin ; "ber_MA@latin"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418CF2:				; CODE XREF: sub_4182CC+A10j
		mov	eax, offset aBer_ma ; "ber_MA"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418CFC:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aTa	; jumptable 00418388 case 73
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418D06:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aTt_ru ; jumptable 00418388	case 68
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418D10:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aTe_in ; jumptable 00418388	case 74
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418D1A:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aTh_th ; jumptable 00418388	case 30
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418D24:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aBo_cn ; jumptable 00418388	case 81
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418D2E:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, [ebp+var_1C] ; jumptable 00418388 case 115
		test	eax, eax
		jz	short loc_418D3C
		cmp	eax, 1
		jz	short loc_418D46
		jmp	short loc_418D50
; ---------------------------------------------------------------------------

loc_418D3C:				; CODE XREF: sub_4182CC+A67j
		mov	eax, offset aTi_et ; "ti_ET"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418D46:				; CODE XREF: sub_4182CC+A6Cj
		mov	eax, offset aTi_er ; "ti_ER"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418D50:				; CODE XREF: sub_4182CC+A6Ej
		mov	eax, offset aTi	; "ti"
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418D5A:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aTs_za ; jumptable 00418388	case 49
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418D64:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aTn_bw ; jumptable 00418388	case 50
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418D6E:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aTr_tr ; jumptable 00418388	case 31
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418D78:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aTk_tm ; jumptable 00418388	case 66
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418D82:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aUk_ua ; jumptable 00418388	case 34
		jmp	locret_418E11
; ---------------------------------------------------------------------------

loc_418D8C:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, [ebp+var_1C] ; jumptable 00418388 case 32
		cmp	eax, 1
		jz	short loc_418D9B
		cmp	eax, 2
		jz	short loc_418DA2
		jmp	short loc_418DA9
; ---------------------------------------------------------------------------

loc_418D9B:				; CODE XREF: sub_4182CC+AC6j
		mov	eax, offset aUr_pk ; "ur_PK"
		jmp	short locret_418E11
; ---------------------------------------------------------------------------

loc_418DA2:				; CODE XREF: sub_4182CC+ACBj
		mov	eax, offset aUr_in ; "ur_IN"
		jmp	short locret_418E11
; ---------------------------------------------------------------------------

loc_418DA9:				; CODE XREF: sub_4182CC+ACDj
		mov	eax, offset aUr	; "ur"
		jmp	short locret_418E11
; ---------------------------------------------------------------------------

loc_418DB0:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, [ebp+var_1C] ; jumptable 00418388 case 67
		cmp	eax, 1
		jz	short loc_418DBF
		cmp	eax, 2
		jz	short loc_418DC6
		jmp	short loc_418DCD
; ---------------------------------------------------------------------------

loc_418DBF:				; CODE XREF: sub_4182CC+AEAj
		mov	eax, offset aUz_uz ; "uz_UZ"
		jmp	short locret_418E11
; ---------------------------------------------------------------------------

loc_418DC6:				; CODE XREF: sub_4182CC+AEFj
		mov	eax, offset aUz_uz@cyrillic ; "uz_UZ@cyrillic"
		jmp	short locret_418E11
; ---------------------------------------------------------------------------

loc_418DCD:				; CODE XREF: sub_4182CC+AF1j
		mov	eax, offset aUz	; "uz"
		jmp	short locret_418E11
; ---------------------------------------------------------------------------

loc_418DD4:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aVen_za ; jumptable	00418388 case 51
		jmp	short locret_418E11
; ---------------------------------------------------------------------------

loc_418DDB:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aVi_vn ; jumptable 00418388	case 42
		jmp	short locret_418E11
; ---------------------------------------------------------------------------

loc_418DE2:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aCy_gb ; jumptable 00418388	case 82
		jmp	short locret_418E11
; ---------------------------------------------------------------------------

loc_418DE9:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aXh_za ; jumptable 00418388	case 52
		jmp	short locret_418E11
; ---------------------------------------------------------------------------

loc_418DF0:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aSit_cn ; jumptable	00418388 case 120
		jmp	short locret_418E11
; ---------------------------------------------------------------------------

loc_418DF7:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aYi_il ; jumptable 00418388	case 61
		jmp	short locret_418E11
; ---------------------------------------------------------------------------

loc_418DFE:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aYo_ng ; jumptable 00418388	case 106
		jmp	short locret_418E11
; ---------------------------------------------------------------------------

loc_418E05:				; CODE XREF: sub_4182CC+BCj
					; DATA XREF: .rdata:off_4266DCo
		mov	eax, offset aZu_za ; jumptable 00418388	case 53
		jmp	short locret_418E11
; ---------------------------------------------------------------------------

loc_418E0C:				; CODE XREF: sub_4182CC+A9j
					; sub_4182CC+BCj
					; DATA XREF: ...
		mov	eax, offset aC_0 ; jumptable 00418388 default case

locret_418E11:				; CODE XREF: sub_4182CC+28j
					; sub_4182CC+4Ej ...
		leave
		retn
sub_4182CC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_418E13	proc near		; CODE XREF: sub_418EF2+1EAp
					; sub_418EF2+212p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_0]
		and	eax, 0FF00h
		shl	eax, 8
		or	edx, eax
		mov	eax, [ebp+arg_0]
		shr	eax, 8
		and	eax, 0FF00h
		or	edx, eax
		mov	eax, [ebp+arg_0]
		shr	eax, 18h
		or	eax, edx
		pop	ebp
		retn
sub_418E13	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_418E42	proc near		; CODE XREF: sub_419AC1+5Fp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	[ebp+var_4], 0
		jmp	short loc_418E8B
; ---------------------------------------------------------------------------

loc_418E57:				; CODE XREF: sub_418E42+51j
		shl	[ebp+var_4], 4
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		add	[ebp+var_4], eax
		add	[ebp+var_8], 1
		mov	eax, [ebp+var_4]
		and	eax, 0F0000000h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_418E8B
		mov	eax, [ebp+var_C]
		shr	eax, 18h
		xor	[ebp+var_4], eax
		mov	eax, [ebp+var_C]
		xor	[ebp+var_4], eax

loc_418E8B:				; CODE XREF: sub_418E42+13j
					; sub_418E42+38j
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_418E57
		mov	eax, [ebp+var_4]
		leave
		retn
sub_418E42	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_418E9A(void *)
sub_418E9A	proc near		; CODE XREF: sub_419496+243p

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_406E5D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_406E5D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_C], eax
		jmp	short loc_418EDF
; ---------------------------------------------------------------------------

loc_418EC6:				; CODE XREF: sub_418E9A+49j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_406E5D
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_418EDF:				; CODE XREF: sub_418E9A+2Aj
		cmp	[ebp+var_C], 0
		jnz	short loc_418EC6
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_406E5D
		leave
		retn
sub_418E9A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_418EF2(char *)
sub_418EF2	proc near		; CODE XREF: sub_419496+214p

Filename	= dword	ptr -68h
Mode		= dword	ptr -64h
Count		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= byte ptr -58h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
File		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
DstBuf		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 60h
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	eax, offset aRb_1 ; "rb"
		mov	[esp+68h+Mode],	eax ; Mode
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_418F2F
		mov	eax, 0
		jmp	loc_419226
; ---------------------------------------------------------------------------

loc_418F2F:				; CODE XREF: sub_418EF2+31j
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	_fileno
		lea	edx, [ebp+var_58]
		mov	[esp+68h+Mode],	edx
		mov	[esp+68h+Filename], eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		test	eax, eax
		jnz	short loc_418F78
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[ebp+var_20], eax
		mov	ecx, [ebp+var_20]
		mov	ebx, 0
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	esi, ebx
		xor	esi, edx
		xor	eax, ecx
		or	eax, esi
		test	eax, eax
		jnz	short loc_418F78
		cmp	[ebp+var_20], 1Bh
		ja	short loc_418F8D

loc_418F78:				; CODE XREF: sub_418EF2+5Bj
					; sub_418EF2+7Ej
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, 0
		jmp	loc_419226
; ---------------------------------------------------------------------------

loc_418F8D:				; CODE XREF: sub_418EF2+84j
		mov	eax, [ebp+var_20]
		add	eax, eax
		cmp	eax, [ebp+var_20]
		jbe	short loc_418FA6
		mov	eax, [ebp+var_20]
		add	eax, eax
		mov	[esp+68h+Filename], eax	; size_t
		call	sub_406CDA
		jmp	short loc_418FAB
; ---------------------------------------------------------------------------

loc_418FA6:				; CODE XREF: sub_418EF2+A3j
		mov	eax, 0

loc_418FAB:				; CODE XREF: sub_418EF2+B2j
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_418FC9
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, 0
		jmp	loc_419226
; ---------------------------------------------------------------------------

loc_418FC9:				; CODE XREF: sub_418EF2+C0j
		mov	eax, [ebp+var_20]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+DstBuf], eax

loc_418FD5:				; CODE XREF: sub_418EF2+13Fj
		mov	eax, [ebp+DstBuf]
		mov	edx, [ebp+File]
		mov	[esp+68h+var_5C], edx ;	File
		mov	edx, [ebp+var_C]
		mov	[esp+68h+Count], edx ; Count
		mov	[esp+68h+Mode],	1 ; ElementSize
		mov	[esp+68h+Filename], eax	; DstBuf
		call	fread
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_C]
		jnb	short loc_419021
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_406E5D
		mov	eax, 0
		jmp	loc_419226
; ---------------------------------------------------------------------------

loc_419021:				; CODE XREF: sub_418EF2+10Dj
		mov	eax, [ebp+var_24]
		add	[ebp+DstBuf], eax
		mov	eax, [ebp+var_24]
		sub	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_418FD5
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 950412DEh
		jz	short loc_41906B
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 0DE120495h
		jz	short loc_41906B
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_406E5D
		mov	eax, 0
		jmp	loc_419226
; ---------------------------------------------------------------------------

loc_41906B:				; CODE XREF: sub_418EF2+156j
					; sub_418EF2+162j
		mov	[esp+68h+Mode],	28h ; size_t
		mov	[esp+68h+Filename], 1 ;	size_t
		call	sub_406DBE
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_41909D
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_406E5D
		mov	eax, 0
		jmp	loc_419226
; ---------------------------------------------------------------------------

loc_41909D:				; CODE XREF: sub_418EF2+194j
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_14]
		add	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 950412DEh
		setnz	al
		movzx	edx, al
		mov	eax, [ebp+var_18]
		mov	[eax+8], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4190E3
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[esp+68h+Filename], eax
		call	sub_418E13
		jmp	short loc_4190E9
; ---------------------------------------------------------------------------

loc_4190E3:				; CODE XREF: sub_418EF2+1DFj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]

loc_4190E9:				; CODE XREF: sub_418EF2+1EFj
		test	eax, eax
		jnz	loc_4191E9
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41910B
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	[esp+68h+Filename], eax
		call	sub_418E13
		jmp	short loc_419111
; ---------------------------------------------------------------------------

loc_41910B:				; CODE XREF: sub_418EF2+207j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]

loc_419111:				; CODE XREF: sub_418EF2+217j
		mov	edx, [ebp+var_18]
		mov	[edx+0Ch], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_419131
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Filename], eax
		call	sub_418E13
		jmp	short loc_419137
; ---------------------------------------------------------------------------

loc_419131:				; CODE XREF: sub_418EF2+22Dj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]

loc_419137:				; CODE XREF: sub_418EF2+23Dj
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+18h], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41915C
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]
		mov	[esp+68h+Filename], eax
		call	sub_418E13
		jmp	short loc_419162
; ---------------------------------------------------------------------------

loc_41915C:				; CODE XREF: sub_418EF2+258j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]

loc_419162:				; CODE XREF: sub_418EF2+268j
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_419187
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	[esp+68h+Filename], eax
		call	sub_418E13
		jmp	short loc_41918D
; ---------------------------------------------------------------------------

loc_419187:				; CODE XREF: sub_418EF2+283j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]

loc_41918D:				; CODE XREF: sub_418EF2+293j
		mov	edx, [ebp+var_18]
		mov	[edx+20h], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4191AD
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	[esp+68h+Filename], eax
		call	sub_418E13
		jmp	short loc_4191B3
; ---------------------------------------------------------------------------

loc_4191AD:				; CODE XREF: sub_418EF2+2A9j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]

loc_4191B3:				; CODE XREF: sub_418EF2+2B9j
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+24h], edx
		nop
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Mode],	4 ; size_t
		mov	[esp+68h+Filename], eax	; size_t
		call	sub_406DBE
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_419223
		jmp	short loc_419206
; ---------------------------------------------------------------------------

loc_4191E9:				; CODE XREF: sub_418EF2+1F9j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_406E5D
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_406E5D
		mov	eax, 0
		jmp	short loc_419226
; ---------------------------------------------------------------------------

loc_419206:				; CODE XREF: sub_418EF2+2F5j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_406E5D
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_406E5D
		mov	eax, 0
		jmp	short loc_419226
; ---------------------------------------------------------------------------

loc_419223:				; CODE XREF: sub_418EF2+2F3j
		mov	eax, [ebp+var_18]

loc_419226:				; CODE XREF: sub_418EF2+38j
					; sub_418EF2+96j ...
		add	esp, 60h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_418EF2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41922D(LPCSTR, int, int)
sub_41922D	proc near		; CODE XREF: sub_419424+1Ap

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpMultiByteStr	= dword	ptr -30h
cbMultiByte	= dword	ptr -2Ch
lpWideCharStr	= dword	ptr -28h
cchWideChar	= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+cchWideChar], 0 ; cchWideChar
		mov	[esp+38h+lpWideCharStr], 0 ; lpWideCharStr
		mov	[esp+38h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_41927D
		mov	eax, [ebp+var_C]
		add	eax, 1
		test	eax, eax
		jg	short loc_419287

loc_41927D:				; CODE XREF: sub_41922D+44j
		mov	eax, 0
		jmp	locret_41932D
; ---------------------------------------------------------------------------

loc_419287:				; CODE XREF: sub_41922D+4Ej
		mov	eax, [ebp+var_C]
		add	eax, 1
		add	eax, eax
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	edx, eax
		shr	edx, 1
		mov	eax, [ebp+var_C]
		add	eax, 1
		cmp	edx, eax
		jz	short loc_4192B7
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0
		jmp	short locret_41932D
; ---------------------------------------------------------------------------

loc_4192B7:				; CODE XREF: sub_41922D+74j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+CodePage], eax	; size_t
		call	sub_406CDA
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4192D2
		mov	eax, 0
		jmp	short locret_41932D
; ---------------------------------------------------------------------------

loc_4192D2:				; CODE XREF: sub_41922D+9Cj
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[esp+38h+cchWideChar], edx ; cchWideChar
		mov	edx, [ebp+var_14]
		mov	[esp+38h+lpWideCharStr], edx ; lpWideCharStr
		mov	[esp+38h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_419322
		mov	eax, [ebp+var_14]
		mov	[esp+38h+CodePage], eax	; void *
		call	sub_406E5D
		mov	eax, 0
		jmp	short locret_41932D
; ---------------------------------------------------------------------------

loc_419322:				; CODE XREF: sub_41922D+E1j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_14]

locret_41932D:				; CODE XREF: sub_41922D+55j
					; sub_41922D+88j ...
		leave
		retn
sub_41922D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41932F(LPCWSTR, int, int)
sub_41932F	proc near		; CODE XREF: sub_419424+3Cp

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpWideCharStr	= dword	ptr -30h
cchWideChar	= dword	ptr -2Ch
lpMultiByteStr	= dword	ptr -28h
cbMultiByte	= dword	ptr -24h
lpDefaultChar	= dword	ptr -20h
lpUsedDefaultChar= dword ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	[esp+38h+cbMultiByte], 0 ; cbMultiByte
		mov	[esp+38h+lpMultiByteStr], 0 ; lpMultiByteStr
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0 ;	CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_41938F
		mov	eax, [ebp+var_C]
		add	eax, 1
		test	eax, eax
		jg	short loc_419399

loc_41938F:				; CODE XREF: sub_41932F+54j
		mov	eax, 0
		jmp	locret_419422
; ---------------------------------------------------------------------------

loc_419399:				; CODE XREF: sub_41932F+5Ej
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+38h+CodePage], eax	; size_t
		call	sub_406CDA
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4193B7
		mov	eax, 0
		jmp	short locret_419422
; ---------------------------------------------------------------------------

loc_4193B7:				; CODE XREF: sub_41932F+7Fj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	edx, [ebp+var_C]
		mov	[esp+38h+cbMultiByte], edx ; cbMultiByte
		mov	edx, [ebp+var_10]
		mov	[esp+38h+lpMultiByteStr], edx ;	lpMultiByteStr
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0 ;	CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_419417
		mov	eax, [ebp+var_10]
		mov	[esp+38h+CodePage], eax	; void *
		call	sub_406E5D
		mov	eax, 0
		jmp	short locret_419422
; ---------------------------------------------------------------------------

loc_419417:				; CODE XREF: sub_41932F+D4j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_10]

locret_419422:				; CODE XREF: sub_41932F+65j
					; sub_41932F+86j ...
		leave
		retn
sub_41932F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_419424(LPCSTR, int, int)
sub_419424	proc near		; CODE XREF: sub_419756+12Fp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	LPCSTR
		call	sub_41922D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_419475
		mov	eax, [ebp+var_14]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_20], edx ;	int
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	LPCWSTR
		call	sub_41932F
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_406E5D
		jmp	short loc_41947C
; ---------------------------------------------------------------------------

loc_419475:				; CODE XREF: sub_419424+26j
		mov	[ebp+var_C], 0

loc_41947C:				; CODE XREF: sub_419424+4Fj
		cmp	[ebp+var_C], 0
		jz	short loc_419487
		mov	eax, [ebp+var_14]
		jmp	short loc_41948C
; ---------------------------------------------------------------------------

loc_419487:				; CODE XREF: sub_419424+5Cj
		mov	eax, 0

loc_41948C:				; CODE XREF: sub_419424+61j
		mov	edx, [ebp+arg_8]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_419424	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_419496(char *, char *)
sub_419496	proc near		; CODE XREF: sub_40ACF4+16p

Dest		= dword	ptr -48h
Source		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Str		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		mov	[ebp+var_10], 0
		mov	[ebp+Str], 0
		mov	[esp+48h+Dest],	offset aLc_messages ; "LC_MESSAGES"
		call	sub_4182CC
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_419528
		mov	eax, [ebp+var_14]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+48h+Dest],	eax ; size_t
		call	sub_406CDA
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jz	short loc_419528
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	[esp+48h+Source], 5Fh ;	Val
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax ; Str
		call	strchr
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_419528
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	0

loc_419528:				; CODE XREF: sub_419496+29j
					; sub_419496+5Cj ...
		cmp	[ebp+Str], 0
		jnz	short loc_419538
		mov	eax, 0
		jmp	loc_4196E9
; ---------------------------------------------------------------------------

loc_419538:				; CODE XREF: sub_419496+96j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+Str]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	ebx, eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 12h
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Dest],	eax ; size_t
		call	sub_406CDA
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_4195C8
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax ; void *
		call	sub_406E5D
		mov	eax, 0
		jmp	loc_4196E9
; ---------------------------------------------------------------------------

loc_4195C8:				; CODE XREF: sub_419496+11Bj
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_24], 1
		mov	eax, [ebp+Str]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+Str]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_24], eax
		mov	edx, offset aLc_messages_0 ; "\\LC_MESSAGES\\"
		mov	eax, [ebp+var_24]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		movzx	edx, word ptr [edx+0Ch]
		mov	[eax+0Ch], dx
		add	[ebp+var_24], 0Dh
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_24], eax
		mov	edx, offset a_mo ; ".mo"
		mov	eax, [ebp+var_24]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	[esp+48h+Dest],	eax ; char *
		call	sub_418EF2
		mov	[ebp+var_10], eax
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax ; void *
		call	sub_406E5D
		mov	eax, [ebp+var_20]
		mov	[esp+48h+Dest],	eax ; void *
		call	sub_406E5D
		mov	eax, ds:dword_428A5C
		test	eax, eax
		jz	short loc_4196DE
		mov	eax, ds:dword_428A5C
		mov	[esp+48h+Dest],	eax ; void *
		call	sub_418E9A

loc_4196DE:				; CODE XREF: sub_419496+239j
		mov	eax, [ebp+var_10]
		mov	ds:dword_428A5C, eax
		mov	eax, [ebp+arg_4]

loc_4196E9:				; CODE XREF: sub_419496+9Dj
					; sub_419496+12Dj
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_419496	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4196F0(char *, int, int)
sub_4196F0	proc near		; CODE XREF: sub_419756+35Bp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 1
		setnz	al
		movzx	eax, al
		mov	[ebp+var_C], eax
		jmp	short loc_41974B
; ---------------------------------------------------------------------------

loc_419705:				; CODE XREF: sub_4196F0+5Fj
		mov	[esp+28h+Val], 0 ; Val
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		cmp	eax, [ebp+var_10]
		ja	short loc_419732
		mov	eax, offset aErrorInGettext ; "ERROR in	GETTEXT	(bad plural entry)"
		jmp	short locret_419754
; ---------------------------------------------------------------------------

loc_419732:				; CODE XREF: sub_4196F0+39j
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+arg_4], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_0], eax
		sub	[ebp+var_C], 1

loc_41974B:				; CODE XREF: sub_4196F0+13j
		cmp	[ebp+var_C], 0
		jnz	short loc_419705
		mov	eax, [ebp+arg_0]

locret_419754:				; CODE XREF: sub_4196F0+40j
		leave
		retn
sub_4196F0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419756	proc near		; CODE XREF: sub_419AC1+158p
					; sub_419AC1+27Dp

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, ds:dword_428A60
		test	eax, eax
		jz	short loc_4197E2
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_419790
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_418E13
		jmp	short loc_4197A1
; ---------------------------------------------------------------------------

loc_419790:				; CODE XREF: sub_419756+1Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_4197A1:				; CODE XREF: sub_419756+38j
		add	eax, ebx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4197CA
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+38h+Dst], eax
		call	sub_418E13
		jmp	short loc_4197DA
; ---------------------------------------------------------------------------

loc_4197CA:				; CODE XREF: sub_419756+58j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_4197DA:				; CODE XREF: sub_419756+72j
		mov	[ebp+var_14], eax
		jmp	loc_419A91
; ---------------------------------------------------------------------------

loc_4197E2:				; CODE XREF: sub_419756+Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_4199D7
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_419824
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_418E13
		jmp	short loc_419835
; ---------------------------------------------------------------------------

loc_419824:				; CODE XREF: sub_419756+B1j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_419835:				; CODE XREF: sub_419756+CCj
		add	eax, ebx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41985E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+38h+Dst], eax
		call	sub_418E13
		jmp	short loc_41986E
; ---------------------------------------------------------------------------

loc_41985E:				; CODE XREF: sub_419756+ECj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_41986E:				; CODE XREF: sub_419756+106j
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+var_28]
		mov	[esp+38h+Size],	eax ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Src], eax ; int
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dst], eax ; LPCSTR
		call	sub_419424
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_4198A6
		mov	[ebp+var_10], offset aErrorInGette_0 ; "ERROR in GETTEXT MALLOC"
		mov	[ebp+var_14], 0
		jmp	loc_4199C7
; ---------------------------------------------------------------------------

loc_4198A6:				; CODE XREF: sub_419756+13Bj
		mov	eax, [ebp+var_28]
		cmp	eax, [ebp+var_1C]
		ja	loc_419938
		mov	eax, [ebp+var_28]
		cmp	eax, 1
		jbe	short loc_419938
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4198E5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_418E13
		jmp	short loc_4198F6
; ---------------------------------------------------------------------------

loc_4198E5:				; CODE XREF: sub_419756+172j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_4198F6:				; CODE XREF: sub_419756+18Dj
		add	eax, ebx
		mov	[ebp+var_24], eax
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_24]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	edx, eax
		mov	eax, [ebp+var_28]
		mov	[edx], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_14], eax
		jmp	loc_4199C7
; ---------------------------------------------------------------------------

loc_419938:				; CODE XREF: sub_419756+156j
					; sub_419756+162j
		mov	eax, [ebp+var_28]
		add	eax, 10h
		mov	[esp+38h+Dst], eax ; size_t
		call	sub_406CDA
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4199B9
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	dword ptr [eax], 1
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		jmp	short loc_4199C7
; ---------------------------------------------------------------------------

loc_4199B9:				; CODE XREF: sub_419756+1F7j
		mov	[ebp+var_10], offset aErrorInGette_0 ; "ERROR in GETTEXT MALLOC"
		mov	[ebp+var_14], 0

loc_4199C7:				; CODE XREF: sub_419756+14Bj
					; sub_419756+1DDj ...
		mov	eax, [ebp+var_20]
		mov	[esp+38h+Dst], eax ; void *
		call	sub_406E5D
		jmp	loc_419A91
; ---------------------------------------------------------------------------

loc_4199D7:				; CODE XREF: sub_419756+9Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		cmp	eax, 1
		jnz	short loc_419A3D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_C], eax
		jmp	short loc_419A0A
; ---------------------------------------------------------------------------

loc_4199F7:				; CODE XREF: sub_419756+2B8j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, [ebp+arg_4]
		jz	short loc_419A12
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_419A0A:				; CODE XREF: sub_419756+29Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_4199F7
		jmp	short loc_419A13
; ---------------------------------------------------------------------------

loc_419A12:				; CODE XREF: sub_419756+2AAj
		nop

loc_419A13:				; CODE XREF: sub_419756+2BAj
		cmp	[ebp+var_C], 0
		jz	short loc_419A2D
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		jmp	short loc_419A91
; ---------------------------------------------------------------------------

loc_419A2D:				; CODE XREF: sub_419756+2C1j
		mov	[ebp+var_10], offset aErrorInGette_1 ; "ERROR in GETTEXT (overflow space)\n"
		mov	[ebp+var_14], 0
		jmp	short loc_419A91
; ---------------------------------------------------------------------------

loc_419A3D:				; CODE XREF: sub_419756+294j
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_419A68
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_418E13
		jmp	short loc_419A79
; ---------------------------------------------------------------------------

loc_419A68:				; CODE XREF: sub_419756+2F5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_419A79:				; CODE XREF: sub_419756+310j
		add	eax, ebx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_419A91:				; CODE XREF: sub_419756+87j
					; sub_419756+27Cj ...
		cmp	[ebp+arg_8], 0
		jz	short loc_419AB8
		cmp	[ebp+var_14], 0
		jz	short loc_419AB8
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+Size],	eax ; int
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Src], eax ; int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax ; char *
		call	sub_4196F0
		jmp	short loc_419ABB
; ---------------------------------------------------------------------------

loc_419AB8:				; CODE XREF: sub_419756+33Fj
					; sub_419756+345j
		mov	eax, [ebp+var_10]

loc_419ABB:				; CODE XREF: sub_419756+360j
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_419756	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_419AC1(char *, int, int)
sub_419AC1	proc near		; CODE XREF: sub_419D7C+1Cp
					; .text:00419DBBp ...

Str1		= dword	ptr -58h
Str2		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		mov	eax, ds:dword_428A5C
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	loc_419D53
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		cmp	eax, 2
		jbe	loc_419C8C
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_419C8C
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax
		call	sub_418E42
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_18]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_20]
		mov	edx, 0
		div	ecx
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		lea	ecx, [eax-2]
		mov	eax, [ebp+var_20]
		mov	edx, 0
		div	ecx
		mov	eax, edx
		add	eax, 1
		mov	[ebp+var_24], eax
		jmp	loc_419C4B
; ---------------------------------------------------------------------------

loc_419B5B:				; CODE XREF: sub_419AC1+1C5j
		sub	[ebp+var_28], 1
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_28]
		jbe	loc_419C23
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_419B92
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	sub_418E13
		jmp	short loc_419BA2
; ---------------------------------------------------------------------------

loc_419B92:				; CODE XREF: sub_419AC1+B5j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_419BA2:				; CODE XREF: sub_419AC1+CFj
		cmp	eax, [ebp+var_1C]
		jb	short loc_419C23
		mov	eax, [ebp+var_18]
		mov	ebx, [eax]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_419BD1
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+58h+Str1],	eax
		call	sub_418E13
		jmp	short loc_419BE2
; ---------------------------------------------------------------------------

loc_419BD1:				; CODE XREF: sub_419AC1+F3j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_419BE2:				; CODE XREF: sub_419AC1+10Ej
		add	eax, ebx
		mov	[esp+58h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_419C23
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	eax, al
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str1],	eax
		call	sub_419756
		jmp	loc_419D6D
; ---------------------------------------------------------------------------

loc_419C23:				; CODE XREF: sub_419AC1+A7j
					; sub_419AC1+E4j ...
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		sub	eax, [ebp+var_24]
		cmp	eax, [ebp+var_14]
		ja	short loc_419C45
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		mov	edx, [ebp+var_24]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+var_14], eax
		jmp	short loc_419C4B
; ---------------------------------------------------------------------------

loc_419C45:				; CODE XREF: sub_419AC1+16Ej
		mov	eax, [ebp+var_24]
		add	[ebp+var_14], eax

loc_419C4B:				; CODE XREF: sub_419AC1+95j
					; sub_419AC1+182j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_419C6F
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	sub_418E13
		jmp	short loc_419C7F
; ---------------------------------------------------------------------------

loc_419C6F:				; CODE XREF: sub_419AC1+192j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]

loc_419C7F:				; CODE XREF: sub_419AC1+1ACj
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	loc_419B5B

loc_419C8C:				; CODE XREF: sub_419AC1+23j
					; sub_419AC1+31j
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_C], eax
		jmp	loc_419D45
; ---------------------------------------------------------------------------

loc_419CA1:				; CODE XREF: sub_419AC1+28Aj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		shr	eax, 1
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_18]
		mov	ebx, [eax]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_419CD8
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+58h+Str1],	eax
		call	sub_418E13
		jmp	short loc_419CE9
; ---------------------------------------------------------------------------

loc_419CD8:				; CODE XREF: sub_419AC1+1FAj
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_419CE9:				; CODE XREF: sub_419AC1+215j
		add	eax, ebx
		mov	[esp+58h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jns	short loc_419D0B
		mov	eax, [ebp+var_28]
		mov	[ebp+var_C], eax
		jmp	short loc_419D45
; ---------------------------------------------------------------------------

loc_419D0B:				; CODE XREF: sub_419AC1+240j
		cmp	[ebp+var_2C], 0
		jle	short loc_419D1C
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_419D45
; ---------------------------------------------------------------------------

loc_419D1C:				; CODE XREF: sub_419AC1+24Ej
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	eax, al
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str1],	eax
		call	sub_419756
		jmp	short loc_419D6D
; ---------------------------------------------------------------------------

loc_419D45:				; CODE XREF: sub_419AC1+1DBj
					; sub_419AC1+248j ...
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_C]
		jb	loc_419CA1
		jmp	short loc_419D54
; ---------------------------------------------------------------------------

loc_419D53:				; CODE XREF: sub_419AC1+14j
		nop

loc_419D54:				; CODE XREF: sub_419AC1+290j
		cmp	[ebp+arg_4], 0
		jz	short loc_419D6A
		cmp	[ebp+arg_8], 1
		jnz	short loc_419D65
		mov	eax, [ebp+arg_0]
		jmp	short loc_419D68
; ---------------------------------------------------------------------------

loc_419D65:				; CODE XREF: sub_419AC1+29Dj
		mov	eax, [ebp+arg_4]

loc_419D68:				; CODE XREF: sub_419AC1+2A2j
		jmp	short loc_419D6D
; ---------------------------------------------------------------------------

loc_419D6A:				; CODE XREF: sub_419AC1+297j
		mov	eax, [ebp+arg_0]

loc_419D6D:				; CODE XREF: sub_419AC1+15Dj
					; sub_419AC1+282j ...
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_419AC1	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_419D7C(char *)
sub_419D7C	proc near		; CODE XREF: sub_4015CF+3Dp
					; sub_4015CF+4Ep ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_10], 0 ; int
		mov	[esp+18h+var_14], 0 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_419AC1
		leave
		retn
sub_419D7C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_419AC1
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_419AC1
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp], offset	aLc_messages ; "LC_MESSAGES"
		call	sub_4182CC
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_419E03
		mov	eax, [ebp-0Ch]
		jmp	short locret_419E08
; ---------------------------------------------------------------------------

loc_419E03:				; CODE XREF: .text:00419DFCj
		mov	eax, offset byte_426A9B

locret_419E08:				; CODE XREF: .text:00419E01j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419E0A	proc near		; CODE XREF: sub_40AD11+Dp
					; sub_40AD2A+Dp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ds:dword_428A60, eax
		pop	ebp
		retn
sub_419E0A	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419E18	proc near		; CODE XREF: sub_40377D+22Dp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ds:dword_428B0C
		mov	[ebp+var_4], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_419E36
		mov	ds:dword_428B0C, 0

loc_419E36:				; CODE XREF: sub_419E18+12j
		mov	eax, [ebp+var_4]
		leave
		retn
sub_419E18	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_428B0C
		add	eax, 1
		mov	ds:dword_428B0C, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_419E4D(char *Filename, int FileHandle)
sub_419E4D	proc near		; CODE XREF: sub_41A0AC+21p
					; .text:0041A0E8p

File		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Filename	= dword	ptr  8
FileHandle	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, ds:dword_428A80
		test	eax, eax
		jz	short loc_419E97
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, ds:dword_428A80
		cmp	edx, eax
		jz	short loc_419E8D
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:dword_428A80
		cmp	edx, eax
		jz	short loc_419E8D
		mov	eax, ds:dword_428A80
		mov	[esp+28h+File],	eax ; File
		call	fclose

loc_419E8D:				; CODE XREF: sub_419E4D+20j
					; sub_419E4D+31j
		mov	ds:dword_428A80, 0

loc_419E97:				; CODE XREF: sub_419E4D+Fj
		cmp	[ebp+Filename],	0
		jz	short loc_419EDF
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset asc_426A9C ; "-"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_419EDF
		mov	[ebp+Filename],	0
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+28h+File],	eax ; File
		call	_fileno
		mov	[ebp+FileHandle], eax

loc_419EDF:				; CODE XREF: sub_419E4D+4Ej
					; sub_419E4D+76j
		cmp	[ebp+Filename],	0
		jz	short loc_419F35
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset aSocket ; "socket://"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_419F21
		mov	eax, [ebp+Filename]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_419F21
		mov	eax, 1
		jmp	short loc_419F26
; ---------------------------------------------------------------------------

loc_419F21:				; CODE XREF: sub_419E4D+BEj
					; sub_419E4D+CBj
		mov	eax, 0

loc_419F26:				; CODE XREF: sub_419E4D+D2j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_419F3C
		add	[ebp+Filename],	9
		jmp	short loc_419F3C
; ---------------------------------------------------------------------------

loc_419F35:				; CODE XREF: sub_419E4D+96j
		mov	[ebp+var_10], 0

loc_419F3C:				; CODE XREF: sub_419E4D+E0j
					; sub_419E4D+E6j
		cmp	[ebp+var_10], 0
		jz	short loc_419F78
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aSystemDoesNotS ; "system does not support logging to a so"...
		mov	[esp+28h+var_1C], edx ;	File
		mov	[esp+28h+Count], 3Bh ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+File],	eax ; Str
		call	fwrite
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_419FD3
; ---------------------------------------------------------------------------

loc_419F78:				; CODE XREF: sub_419E4D+F3j
		cmp	[ebp+Filename],	0
		jz	short loc_419F97
		mov	eax, offset aA_0 ; "a"
		mov	[esp+28h+Size],	eax ; Mode
		mov	eax, [ebp+Filename]
		mov	[esp+28h+File],	eax ; Filename
		call	fopen
		mov	[ebp+var_C], eax
		jmp	short loc_419FD3
; ---------------------------------------------------------------------------

loc_419F97:				; CODE XREF: sub_419E4D+12Fj
		cmp	[ebp+FileHandle], 1
		jnz	short loc_419FAA
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[ebp+var_C], eax
		jmp	short loc_419FD3
; ---------------------------------------------------------------------------

loc_419FAA:				; CODE XREF: sub_419E4D+14Ej
		cmp	[ebp+FileHandle], 2
		jnz	short loc_419FBD
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_419FD3
; ---------------------------------------------------------------------------

loc_419FBD:				; CODE XREF: sub_419E4D+161j
		mov	[esp+28h+Size],	offset aA_0 ; "a"
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+File],	eax ; FileHandle
		call	_fdopen
		mov	[ebp+var_C], eax

loc_419FD3:				; CODE XREF: sub_419E4D+129j
					; sub_419E4D+148j ...
		mov	dword_422170, 0FFFFFFFFh
		cmp	[ebp+var_C], 0
		jnz	loc_41A068
		cmp	[ebp+Filename],	0
		jz	short loc_41A025
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToOpenLo ; "failed to open log file `%s': %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+Filename]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		jmp	short loc_41A05B
; ---------------------------------------------------------------------------

loc_41A025:				; CODE XREF: sub_419E4D+19Ej
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToFdopen ; "failed to fdopen	file descriptor	%d: %s"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf

loc_41A05B:				; CODE XREF: sub_419E4D+1D6j
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_41A08B
; ---------------------------------------------------------------------------

loc_41A068:				; CODE XREF: sub_419E4D+194j
		mov	[esp+28h+var_1C], 0 ; Size
		mov	[esp+28h+Count], 40h ; Mode
		mov	[esp+28h+Size],	0 ; Buf
		mov	eax, [ebp+var_C]
		mov	[esp+28h+File],	eax ; File
		call	setvbuf

loc_41A08B:				; CODE XREF: sub_419E4D+219j
		mov	eax, [ebp+var_C]
		mov	ds:dword_428A80, eax
		mov	eax, [ebp+var_10]
		mov	ds:dword_428B04, eax
		mov	ds:dword_428B08, 0
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_419E4D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41A0AC(char *)
sub_41A0AC	proc near		; CODE XREF: sub_41A26E+19p

Filename	= dword	ptr -18h
FileHandle	= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_41A0BD
		mov	eax, [ebp+arg_0]
		jmp	short loc_41A0C2
; ---------------------------------------------------------------------------

loc_41A0BD:				; CODE XREF: sub_41A0AC+Aj
		mov	eax, offset asc_426A9C ; "-"

loc_41A0C2:				; CODE XREF: sub_41A0AC+Fj
		mov	[esp+18h+FileHandle], 0FFFFFFFFh ; FileHandle
		mov	[esp+18h+Filename], eax	; Filename
		call	sub_419E4D
		leave
		retn
sub_41A0AC	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_419E4D
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_428AFC, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41A0FC(char *, int)
sub_41A0FC	proc near		; CODE XREF: sub_40377D+60p

Dest		= dword	ptr -18h
Source		= dword	ptr -14h
Count		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_41A12A
		mov	[esp+18h+Count], 4Fh ; Count
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Source], eax ;	Source
		mov	[esp+18h+Dest],	offset Dest ; Dest
		call	strncpy
		mov	ds:byte_428AEF,	0

loc_41A12A:				; CODE XREF: sub_41A0FC+Aj
		mov	eax, [ebp+arg_4]
		and	eax, 1
		mov	ds:dword_428AF4, eax
		mov	eax, [ebp+arg_4]
		and	eax, 2
		mov	ds:dword_428AF0, eax
		mov	eax, [ebp+arg_4]
		and	eax, 4
		mov	ds:dword_428AF8, eax
		mov	eax, [ebp+arg_4]
		and	eax, 100h
		mov	ds:dword_428B00, eax
		leave
		retn
sub_41A0FC	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_41A1CC
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0
		mov	eax, ds:dword_428AF4
		test	eax, eax
		jz	short loc_41A184
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 1
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_41A184:				; CODE XREF: .text:0041A173j
		mov	eax, ds:dword_428AF0
		test	eax, eax
		jz	short loc_41A19C
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 2
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_41A19C:				; CODE XREF: .text:0041A18Bj
		mov	eax, ds:dword_428AF8
		test	eax, eax
		jz	short loc_41A1B4
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 4
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_41A1B4:				; CODE XREF: .text:0041A1A3j
		mov	eax, ds:dword_428B00
		test	eax, eax
		jz	short loc_41A1CC
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	dh, 1
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_41A1CC:				; CODE XREF: .text:0041A161j
					; .text:0041A1BBj
		mov	eax, offset Dest
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_428A80
		test	eax, eax
		jz	short loc_41A207
		mov	eax, ds:dword_428A80
		mov	[esp], eax
		call	_fileno
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	short loc_41A207
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_41A207
		mov	eax, 1
		jmp	short locret_41A227
; ---------------------------------------------------------------------------

loc_41A207:				; CODE XREF: .text:0041A1E0j
					; .text:0041A1F6j ...
		mov	eax, dword_422170
		cmp	eax, 0FFFFFFFFh
		jz	short loc_41A222
		mov	eax, dword_422170
		cmp	eax, [ebp+8]
		jnz	short loc_41A222
		mov	eax, 1
		jmp	short locret_41A227
; ---------------------------------------------------------------------------

loc_41A222:				; CODE XREF: .text:0041A20Fj
					; .text:0041A219j
		mov	eax, 0

locret_41A227:				; CODE XREF: .text:0041A205j
					; .text:0041A220j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A229	proc near		; CODE XREF: sub_40377D+39Dp
					; .text:0040E1E9p ...

File		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_428A80
		test	eax, eax
		jnz	short loc_41A242
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_41A247
; ---------------------------------------------------------------------------

loc_41A242:				; CODE XREF: sub_41A229+Dj
		mov	eax, ds:dword_428A80

loc_41A247:				; CODE XREF: sub_41A229+17j
		mov	[esp+18h+File],	eax ; File
		call	_fileno
		leave
		retn
sub_41A229	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_428A80
		test	eax, eax
		jnz	short loc_41A267
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_41A26C
; ---------------------------------------------------------------------------

loc_41A267:				; CODE XREF: .text:0041A25Bj
		mov	eax, ds:dword_428A80

loc_41A26C:				; CODE XREF: .text:0041A265j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41A26E(int, char *Format, va_list ArgList)
sub_41A26E	proc near		; CODE XREF: sub_41A5F1+22p
					; sub_41A61A+1Ap ...

var_58		= dword	ptr -58h
File		= dword	ptr -54h
Count		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
Format		= dword	ptr  0Ch
ArgList		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_428A80
		test	eax, eax
		jnz	short loc_41A2B1
		mov	[esp+58h+var_58], 0 ; char *
		call	sub_41A0AC
		mov	eax, ds:dword_428A80
		test	eax, eax
		jnz	short loc_41A2B1
		mov	[esp+58h+Count], 1C3h ;	int
		mov	[esp+58h+File],	offset a____Gnupg22__4 ; "../../gnupg2-2.0.30/jnlib/logging.c"
		mov	[esp+58h+var_58], offset aLogstream ; "logstream"
		call	sub_421040

loc_41A2B1:				; CODE XREF: sub_41A26E+10j
					; sub_41A26E+25j
		mov	eax, ds:dword_428B08
		test	eax, eax
		jz	short loc_41A2D5
		cmp	[ebp+arg_0], 1
		jz	short loc_41A2D5
		mov	eax, ds:dword_428A80
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_41A2D5:				; CODE XREF: sub_41A26E+4Aj
					; sub_41A26E+50j
		mov	ds:dword_428B08, 0
		cmp	[ebp+arg_0], 1
		jz	loc_41A46C
		mov	eax, ds:dword_428AF0
		test	eax, eax
		jz	loc_41A385
		mov	eax, ds:dword_428B04
		test	eax, eax
		jnz	loc_41A385
		mov	[esp+58h+var_58], 0
		call	sub_421110
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_58], eax
		call	sub_421760
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	edx, [eax]
		mov	eax, [ebp+var_1C]
		mov	edi, [eax+4]
		mov	eax, [ebp+var_1C]
		mov	esi, [eax+8]
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax+0Ch]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+10h]
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+14h]
		add	eax, 76Ch
		mov	[ebp+var_30], eax
		mov	ecx, offset a04d02d02d02d02 ; "%04d-%02d-%02d %02d:%02d:%02d "
		mov	eax, ds:dword_428A80
		mov	[esp+58h+var_3C], edx
		mov	[esp+58h+var_40], edi
		mov	[esp+58h+var_44], esi
		mov	[esp+58h+var_48], ebx
		mov	edx, [ebp+var_2C]
		mov	[esp+58h+var_4C], edx
		mov	edi, [ebp+var_30]
		mov	[esp+58h+Count], edi
		mov	[esp+58h+File],	ecx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_41A385:				; CODE XREF: sub_41A26E+82j
					; sub_41A26E+8Fj
		mov	eax, ds:dword_428AF4
		test	eax, eax
		jnz	short loc_41A397
		mov	eax, ds:dword_428B04
		test	eax, eax
		jz	short loc_41A3AE

loc_41A397:				; CODE XREF: sub_41A26E+11Ej
		mov	edx, ds:dword_428A80
		mov	eax, offset Dest
		mov	[esp+58h+File],	edx ; File
		mov	[esp+58h+var_58], eax ;	Str
		call	fputs

loc_41A3AE:				; CODE XREF: sub_41A26E+127j
		mov	eax, ds:dword_428AF8
		test	eax, eax
		jnz	short loc_41A3C0
		mov	eax, ds:dword_428B04
		test	eax, eax
		jz	short loc_41A41A

loc_41A3C0:				; CODE XREF: sub_41A26E+147j
		mov	eax, ds:dword_428AFC
		test	eax, eax
		jz	short loc_41A3F9
		mov	eax, ds:dword_428AFC
		call	eax ; dword_428AFC
		mov	ebx, eax
		call	_getpid
		mov	ecx, eax
		mov	edx, offset aU_Lx ; "[%u.%lx]"
		mov	eax, ds:dword_428A80
		mov	[esp+58h+var_4C], ebx
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_41A41A
; ---------------------------------------------------------------------------

loc_41A3F9:				; CODE XREF: sub_41A26E+159j
		call	_getpid
		mov	ecx, eax
		mov	edx, offset aU	; "[%u]"
		mov	eax, ds:dword_428A80
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_41A41A:				; CODE XREF: sub_41A26E+150j
					; sub_41A26E+189j
		mov	eax, ds:dword_428AF0
		test	eax, eax
		jz	short loc_41A42C
		mov	eax, ds:dword_428B04
		test	eax, eax
		jz	short loc_41A441

loc_41A42C:				; CODE XREF: sub_41A26E+1B3j
		mov	eax, ds:dword_428A80
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 3Ah ;	Ch
		call	putc

loc_41A441:				; CODE XREF: sub_41A26E+1BCj
		cmp	[ebp+Format], 0
		jz	short loc_41A457
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_41A457
		add	[ebp+Format], 1
		jmp	short loc_41A46C
; ---------------------------------------------------------------------------

loc_41A457:				; CODE XREF: sub_41A26E+1D7j
					; sub_41A26E+1E1j
		mov	eax, ds:dword_428A80
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 20h ;	Ch
		call	putc

loc_41A46C:				; CODE XREF: sub_41A26E+75j
					; sub_41A26E+1E7j
		cmp	[ebp+arg_0], 7	; switch 8 cases
		ja	loc_41A500	; jumptable 0041A483 default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_426BCC
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41A485:				; CODE XREF: sub_41A26E+215j
					; DATA XREF: .rdata:off_426BCCo
		mov	edx, ds:dword_428A80 ; jumptable 0041A483 case 5
		mov	eax, offset aFatal ; "Fatal: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 7 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_41A520
; ---------------------------------------------------------------------------

loc_41A4AE:				; CODE XREF: sub_41A26E+215j
					; DATA XREF: .rdata:off_426BCCo
		mov	edx, ds:dword_428A80 ; jumptable 0041A483 case 6
		mov	eax, offset aOhhhhJeeee	; "Ohhhh jeeee:	"
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 0Dh ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_41A520
; ---------------------------------------------------------------------------

loc_41A4D7:				; CODE XREF: sub_41A26E+215j
					; DATA XREF: .rdata:off_426BCCo
		mov	edx, ds:dword_428A80 ; jumptable 0041A483 case 7
		mov	eax, offset aDbg ; "DBG: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 5 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_41A520
; ---------------------------------------------------------------------------

loc_41A500:				; CODE XREF: sub_41A26E+202j
		mov	edx, offset aUnknownLogLeve ; jumptable	0041A483 default case
		mov	eax, ds:dword_428A80
		mov	ecx, [ebp+arg_0]
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_41A520
; ---------------------------------------------------------------------------

loc_41A51F:				; CODE XREF: sub_41A26E+215j
					; DATA XREF: .rdata:off_426BCCo
		nop			; jumptable 0041A483 cases 0-4

loc_41A520:				; CODE XREF: sub_41A26E+23Ej
					; sub_41A26E+267j ...
		cmp	[ebp+Format], 0
		jz	short loc_41A590
		mov	eax, ds:dword_428A80
		mov	edx, [ebp+ArgList]
		mov	[esp+58h+Count], edx ; ArgList
		mov	edx, [ebp+Format]
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	vfprintf
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41A583
		mov	eax, [ebp+Format]
		mov	[ebp+var_34], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_34]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_41A583
		mov	ds:dword_428B08, 1
		jmp	short loc_41A590
; ---------------------------------------------------------------------------

loc_41A583:				; CODE XREF: sub_41A26E+2DBj
					; sub_41A26E+307j
		mov	eax, ds:dword_428A80
		mov	[esp+58h+var_58], eax ;	File
		call	fflush

loc_41A590:				; CODE XREF: sub_41A26E+2B6j
					; sub_41A26E+313j
		cmp	[ebp+arg_0], 5
		jnz	short loc_41A5C0
		mov	eax, ds:dword_428B08
		test	eax, eax
		jz	short loc_41A5B4
		mov	eax, ds:dword_428A80
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_41A5B4:				; CODE XREF: sub_41A26E+32Fj
		mov	[esp+58h+var_58], 2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_41A5C0:				; CODE XREF: sub_41A26E+326j
		cmp	[ebp+arg_0], 6
		jnz	short loc_41A5E9
		mov	eax, ds:dword_428B08
		test	eax, eax
		jz	short loc_41A5E4
		mov	eax, ds:dword_428A80
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_41A5E4:				; CODE XREF: sub_41A26E+35Fj
		call	abort
; ---------------------------------------------------------------------------

loc_41A5E9:				; CODE XREF: sub_41A26E+356j
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_41A26E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41A5F1(int, char *, char)
sub_41A5F1	proc near		; CODE XREF: sub_41A7F4+2Ap

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_41A26E
		leave
		retn
sub_41A5F1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41A61A(int, char *, va_list)
sub_41A61A	proc near		; CODE XREF: sub_413AD7+8Fp

var_18		= dword	ptr -18h
Format		= dword	ptr -14h
ArgList		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_41A26E
		leave
		retn
sub_41A61A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41A63B(char *, char)
sub_41A63B	proc near		; CODE XREF: sub_402175+2D1p
					; sub_4031E7+Dp ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 2 ; int
		call	sub_41A26E
		leave
		retn
sub_41A63B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41A665(char *, char)
sub_41A665	proc near		; CODE XREF: sub_401F1C+20Cp
					; sub_402175+21p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 4 ; int
		call	sub_41A26E
		mov	eax, ds:dword_428B0C
		cmp	eax, 752Fh
		jg	short locret_41A6A6
		mov	eax, ds:dword_428B0C
		add	eax, 1
		mov	ds:dword_428B0C, eax

locret_41A6A6:				; CODE XREF: sub_41A665+32j
		leave
		retn
sub_41A665	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl sub_41A6A8(char *, char)
sub_41A6A8	proc near		; CODE XREF: sub_40377D+846p
					; sub_406808+421p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 5 ; int
		call	sub_41A26E
		call	abort
sub_41A6A8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl sub_41A6D5(char *, char)
sub_41A6D5	proc near		; CODE XREF: sub_40AF6D+5Bp
					; .text:0040B0E2p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 6 ; int
		call	sub_41A26E
		call	abort
sub_41A6D5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41A702(char *, char)
sub_41A702	proc near		; CODE XREF: sub_406808+14Ep
					; sub_409DB0+51p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 7 ; int
		call	sub_41A26E
		leave
		retn
sub_41A702	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41A72C(char *, char)
sub_41A72C	proc near		; CODE XREF: .text:0041A7A5p
					; .text:0041A7C8p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		cmp	[ebp+arg_0], 0
		setnz	al
		movzx	eax, al
		mov	[esp+28h+ArgList], edx ; ArgList
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+var_28], eax ;	int
		call	sub_41A26E
		leave
		retn
sub_41A72C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_41A785
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41A785
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_426BEC
		call	sub_41A702

loc_41A785:				; CODE XREF: .text:0041A766j
					; .text:0041A770j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_41A7E0
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a02x_0 ; "%02X"
		call	sub_41A72C
		sub	dword ptr [ebp+10h], 1
		add	dword ptr [ebp-0Ch], 1
		jmp	short loc_41A7D1
; ---------------------------------------------------------------------------

loc_41A7B4:				; CODE XREF: .text:0041A7DEj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a02x_1 ; " %02X"
		call	sub_41A72C
		add	dword ptr [ebp-0Ch], 1

loc_41A7D1:				; CODE XREF: .text:0041A7B2j
		cmp	dword ptr [ebp+10h], 0
		setnz	al
		sub	dword ptr [ebp+10h], 1
		test	al, al
		jnz	short loc_41A7B4

loc_41A7E0:				; CODE XREF: .text:0041A789j
		cmp	dword ptr [ebp+8], 0
		jz	short locret_41A7F2
		mov	dword ptr [esp], offset	asc_426BFB ; "\n"
		call	sub_41A72C

locret_41A7F2:				; CODE XREF: .text:0041A7E4j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_41A7F4	proc near		; CODE XREF: sub_40A3B2+62Fp
					; sub_414A2D+4EAp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_18], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_1C], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_20], eax	; char
		mov	[esp+28h+var_24], offset a___ThisIsABugS ; "...	this is	a bug (%s:%d:%s)\n"
		mov	[esp+28h+var_28], 6 ; int
		call	sub_41A5F1
		call	abort
sub_41A7F4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41A828(char *)
sub_41A828	proc near		; CODE XREF: sub_41AE02+356p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+Val], 5Ch ; Val
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_41A86B
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		jmp	short loc_41A861
; ---------------------------------------------------------------------------

loc_41A84D:				; CODE XREF: sub_41A828+41j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_41A85D
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	5Ch

loc_41A85D:				; CODE XREF: sub_41A828+2Dj
		add	[ebp+var_C], 1

loc_41A861:				; CODE XREF: sub_41A828+23j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41A84D

loc_41A86B:				; CODE XREF: sub_41A828+1Bj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_41A828	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_41A941
; ---------------------------------------------------------------------------

loc_41A894:				; CODE XREF: .text:0041A945j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jnz	short loc_41A939
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_41A8E6
; ---------------------------------------------------------------------------

loc_41A8DA:				; CODE XREF: .text:0041A916j
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_41A8E6:				; CODE XREF: .text:0041A8D8j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_41A918
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_41A8DA

loc_41A918:				; CODE XREF: .text:0041A8EAj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41A927
		mov	eax, [ebp-18h]
		jmp	short loc_41A950
; ---------------------------------------------------------------------------

loc_41A927:				; CODE XREF: .text:0041A920j
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_41A939:				; CODE XREF: .text:0041A8BEj
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_41A941:				; CODE XREF: .text:0041A88Fj
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_41A894
		mov	eax, 0

loc_41A950:				; CODE XREF: .text:0041A925j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_41AA1F
; ---------------------------------------------------------------------------

loc_41A97A:				; CODE XREF: .text:0041AA23j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_41BA39
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_41BA39
		cmp	ebx, eax
		jnz	short loc_41AA17
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_41A9C8
; ---------------------------------------------------------------------------

loc_41A9BC:				; CODE XREF: .text:0041A9F4j
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_41A9C8:				; CODE XREF: .text:0041A9BAj
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_41A9F6
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_41BA39
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_41BA39
		cmp	ebx, eax
		jz	short loc_41A9BC

loc_41A9F6:				; CODE XREF: .text:0041A9CCj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41AA05
		mov	eax, [ebp-18h]
		jmp	short loc_41AA2E
; ---------------------------------------------------------------------------

loc_41AA05:				; CODE XREF: .text:0041A9FEj
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_41AA17:				; CODE XREF: .text:0041A9A0j
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_41AA1F:				; CODE XREF: .text:0041A975j
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_41A97A
		mov	eax, 0

loc_41AA2E:				; CODE XREF: .text:0041AA03j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_41AA93
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_41AA54
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_406D00
		mov	[ebp+8], eax

loc_41AA54:				; CODE XREF: .text:0041AA44j
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		sub	dword ptr [ebp+10h], 1
		jmp	short loc_41AA7D
; ---------------------------------------------------------------------------

loc_41AA66:				; CODE XREF: .text:0041AA8Bj
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp+10h], 1

loc_41AA7D:				; CODE XREF: .text:0041AA64j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_41AA8D
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41AA66

loc_41AA8D:				; CODE XREF: .text:0041AA81j
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0

loc_41AA93:				; CODE XREF: .text:0041AA3Ej
		mov	eax, [ebp+8]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41AA98	proc near		; CODE XREF: sub_40B4FF+C9p
					; sub_41C84E+2FFp ...

C		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_41AAB0
; ---------------------------------------------------------------------------

loc_41AAAC:				; CODE XREF: sub_41AA98+37j
		add	[ebp+var_10], 1

loc_41AAB0:				; CODE XREF: sub_41AA98+12j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41AAD1
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_41AAAC

loc_41AAD1:				; CODE XREF: sub_41AA98+20j
		mov	[ebp+var_14], 0
		jmp	short loc_41AB0E
; ---------------------------------------------------------------------------

loc_41AADA:				; CODE XREF: sub_41AA98+89j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_41AAFF
		cmp	[ebp+var_14], 0
		jnz	short loc_41AB06
		mov	eax, [ebp+var_C]
		mov	[ebp+var_14], eax
		jmp	short loc_41AB06
; ---------------------------------------------------------------------------

loc_41AAFF:				; CODE XREF: sub_41AA98+57j
		mov	[ebp+var_14], 0

loc_41AB06:				; CODE XREF: sub_41AA98+5Dj
					; sub_41AA98+65j
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_41AB0E:				; CODE XREF: sub_41AA98+40j
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41AADA
		cmp	[ebp+var_14], 0
		jz	short loc_41AB2F
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0

loc_41AB2F:				; CODE XREF: sub_41AA98+8Fj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_41AA98	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_41AB79
; ---------------------------------------------------------------------------

loc_41AB49:				; CODE XREF: .text:0041AB81j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_41AB6E
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_41AB75
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax
		jmp	short loc_41AB75
; ---------------------------------------------------------------------------

loc_41AB6E:				; CODE XREF: .text:0041AB5Ej
		mov	dword ptr [ebp-10h], 0

loc_41AB75:				; CODE XREF: .text:0041AB64j
					; .text:0041AB6Cj
		add	dword ptr [ebp-0Ch], 1

loc_41AB79:				; CODE XREF: .text:0041AB47j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41AB49
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_41AB8F
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	0

loc_41AB8F:				; CODE XREF: .text:0041AB87j
		mov	eax, [ebp+8]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41AB94(int, int, char	*)
sub_41AB94	proc near		; CODE XREF: .text:0041AC2Bp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_41ABE9
; ---------------------------------------------------------------------------

loc_41ABB0:				; CODE XREF: sub_41AB94+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_41ABDA
		cmp	[ebp+var_10], 0
		jnz	short loc_41ABE1
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_41ABE1
; ---------------------------------------------------------------------------

loc_41ABDA:				; CODE XREF: sub_41AB94+36j
		mov	[ebp+var_10], 0

loc_41ABE1:				; CODE XREF: sub_41AB94+3Cj
					; sub_41AB94+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_41ABE9:				; CODE XREF: sub_41AB94+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_41ABB0
		cmp	[ebp+var_10], 0
		jz	short loc_41AC0B
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_41AC0E
; ---------------------------------------------------------------------------

loc_41AC0B:				; CODE XREF: sub_41AB94+61j
		mov	eax, [ebp+arg_4]

locret_41AC0E:				; CODE XREF: sub_41AB94+75j
		leave
		retn
sub_41AB94	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_426C1C ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41AB94
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41AC32(int, int, char	*)
sub_41AC32	proc near		; CODE XREF: .text:0041ACC3p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_41AC87
; ---------------------------------------------------------------------------

loc_41AC4E:				; CODE XREF: sub_41AC32+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_41AC78
		cmp	[ebp+var_10], 0
		jnz	short loc_41AC7F
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_41AC7F
; ---------------------------------------------------------------------------

loc_41AC78:				; CODE XREF: sub_41AC32+36j
		mov	[ebp+var_10], 0

loc_41AC7F:				; CODE XREF: sub_41AC32+3Cj
					; sub_41AC32+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_41AC87:				; CODE XREF: sub_41AC32+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_41AC4E
		cmp	[ebp+var_10], 0
		jz	short loc_41ACA3
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_41ACA6
; ---------------------------------------------------------------------------

loc_41ACA3:				; CODE XREF: sub_41AC32+61j
		mov	eax, [ebp+arg_4]

locret_41ACA6:				; CODE XREF: sub_41AC32+6Fj
		leave
		retn
sub_41AC32	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_426C1C ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41AC32
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_41AD31
		mov	dword ptr [esp+4], 5Ch
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_41AD31
		mov	dword ptr [esp+4], 3Ah
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_41AD31
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406E03
		jmp	short locret_41AD3F
; ---------------------------------------------------------------------------

loc_41AD31:				; CODE XREF: .text:0041ACEAj
					; .text:0041AD06j ...
		mov	eax, [ebp-0Ch]
		add	eax, 1
		mov	[esp], eax
		call	sub_406E03

locret_41AD3F:				; CODE XREF: .text:0041AD2Fj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_41ADA9
		mov	dword ptr [esp+4], 5Ch
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_41ADA9
		mov	dword ptr [esp+4], 3Ah
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_41ADA9
		mov	dword ptr [esp], offset	a_ ; "."
		call	sub_406E03
		jmp	short locret_41ADEE
; ---------------------------------------------------------------------------

loc_41ADA9:				; CODE XREF: .text:0041AD61j
					; .text:0041AD7Dj ...
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[esp], eax
		call	sub_406D00
		mov	[ebp-14h], eax
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	strncpy
		mov	eax, [ebp-10h]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-14h]

locret_41ADEE:				; CODE XREF: .text:0041ADA7j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41ADF0	proc near		; CODE XREF: sub_41AE02+144p
					; sub_41AE02+22Bp

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		mov	eax, [ebp+var_4]
		leave
		retn
sub_41ADF0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41AE02	proc near		; CODE XREF: sub_41B167+23p
					; .text:0041B1BAp

VarName		= dword	ptr -0C8h
Val		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
Str		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0C0h
		mov	[ebp+var_14], 1
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_41AEC9
; ---------------------------------------------------------------------------

loc_41AE4F:				; CODE XREF: sub_41AE02+E8j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_10]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		cmp	eax, 1Eh
		jbe	short loc_41AEC5
		cmp	[ebp+arg_0], 0
		jz	short loc_41AEAE
		mov	[esp+0C8h+var_C0], offset aDo_make_filena ; "do_make_filename"
		mov	[esp+0C8h+Val],	176h
		mov	[esp+0C8h+VarName], offset a____Gnupg22__5 ; "../../gnupg2-2.0.30/jnlib/stringhelp.c"
		call	sub_41A7F4
; ---------------------------------------------------------------------------

loc_41AEAE:				; CODE XREF: sub_41AE02+8Ej
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	loc_41B15D
; ---------------------------------------------------------------------------

loc_41AEC5:				; CODE XREF: sub_41AE02+88j
		add	[ebp+var_C], 1

loc_41AEC9:				; CODE XREF: sub_41AE02+4Bj
		mov	eax, [ebp+arg_8]
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_A8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		test	eax, eax
		jnz	loc_41AE4F
		add	[ebp+var_10], 1
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Eh
		jnz	loc_41B080
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jz	short loc_41AF23
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41AF99

loc_41AF23:				; CODE XREF: sub_41AE02+112j
		mov	[esp+0C8h+VarName], offset aHome_1 ; "HOME"
		call	getenv
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_41AF54
		mov	[esp+0C8h+Val],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+VarName], eax
		call	sub_41ADF0
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_20], eax

loc_41AF54:				; CODE XREF: sub_41AE02+134j
		cmp	[ebp+var_20], 0
		jz	loc_41B07F
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_41B07F
		mov	eax, [ebp+var_20]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		jmp	loc_41B07F
; ---------------------------------------------------------------------------

loc_41AF99:				; CODE XREF: sub_41AE02+11Fj
		cmp	[ebp+arg_0], 0
		jz	short loc_41AFB2
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+0C8h+VarName], eax	; char *
		call	sub_406E03
		mov	[ebp+Str], eax
		jmp	short loc_41AFD3
; ---------------------------------------------------------------------------

loc_41AFB2:				; CODE XREF: sub_41AE02+19Bj
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+0C8h+VarName], eax	; char *
		call	sub_406D24
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jnz	short loc_41AFD3
		mov	eax, 0
		jmp	loc_41B15D
; ---------------------------------------------------------------------------

loc_41AFD3:				; CODE XREF: sub_41AE02+1AEj
					; sub_41AE02+1C5j
		mov	[esp+0C8h+Val],	2Fh ; Val
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+VarName], eax	; Str
		call	strchr
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_41AFF5
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0

loc_41AFF5:				; CODE XREF: sub_41AE02+1EBj
		mov	eax, [ebp+Str]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+VarName], eax
		call	sub_41ADF0
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+VarName], eax	; void *
		call	sub_406E5D
		cmp	[ebp+var_20], 0
		jz	short loc_41B076
		mov	eax, [ebp+var_20]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		jmp	short loc_41B080
; ---------------------------------------------------------------------------

loc_41B076:				; CODE XREF: sub_41AE02+248j
		mov	[ebp+var_14], 1
		jmp	short loc_41B080
; ---------------------------------------------------------------------------

loc_41B07F:				; CODE XREF: sub_41AE02+156j
					; sub_41AE02+164j ...
		nop

loc_41B080:				; CODE XREF: sub_41AE02+101j
					; sub_41AE02+272j ...
		cmp	[ebp+arg_0], 0
		jz	short loc_41B096
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+VarName], eax	; size_t
		call	sub_406D00
		mov	[ebp+var_1C], eax
		jmp	short loc_41B0BF
; ---------------------------------------------------------------------------

loc_41B096:				; CODE XREF: sub_41AE02+282j
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+VarName], eax	; size_t
		call	sub_406CDA
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_41B0BF
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+VarName], eax	; void *
		call	sub_406E5D
		mov	eax, 0
		jmp	loc_41B15D
; ---------------------------------------------------------------------------

loc_41B0BF:				; CODE XREF: sub_41AE02+292j
					; sub_41AE02+2A6j
		cmp	[ebp+var_20], 0
		jz	short loc_41B0F0
		mov	eax, [ebp+var_14]
		mov	ebx, eax
		add	ebx, [ebp+arg_4]
		mov	eax, [ebp+var_20]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax
		call	sub_41BD45
		mov	[esp+0C8h+Val],	ebx
		mov	[esp+0C8h+VarName], eax
		call	sub_41BD45
		mov	[ebp+var_24], eax
		jmp	short loc_41B105
; ---------------------------------------------------------------------------

loc_41B0F0:				; CODE XREF: sub_41AE02+2C1j
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax
		call	sub_41BD45
		mov	[ebp+var_24], eax

loc_41B105:				; CODE XREF: sub_41AE02+2ECj
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+VarName], eax	; void *
		call	sub_406E5D
		mov	[ebp+var_C], 0
		jmp	short loc_41B144
; ---------------------------------------------------------------------------

loc_41B119:				; CODE XREF: sub_41AE02+34Ej
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		mov	edx, [ebp+var_24]
		mov	word ptr [edx],	2Fh
		mov	edx, [ebp+var_24]
		add	edx, 1
		mov	[esp+0C8h+Val],	eax
		mov	[esp+0C8h+VarName], edx
		call	sub_41BD45
		mov	[ebp+var_24], eax
		add	[ebp+var_C], 1

loc_41B144:				; CODE XREF: sub_41AE02+315j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		test	eax, eax
		jnz	short loc_41B119
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax	; char *
		call	sub_41A828

loc_41B15D:				; CODE XREF: sub_41AE02+BEj
					; sub_41AE02+1CCj ...
		add	esp, 0C0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41AE02	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41B167	proc near		; CODE XREF: sub_402175+19Ap
					; sub_406808+84p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], 1
		call	sub_41AE02
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41B167	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_41AE02
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		jmp	short loc_41B23C
; ---------------------------------------------------------------------------

loc_41B1D0:				; CODE XREF: .text:0041B24Ej
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_41B234
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_41B234
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_41B220
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_41B234

loc_41B220:				; CODE XREF: .text:0041B214j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_41B250
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_41B250

loc_41B234:				; CODE XREF: .text:0041B1DEj
					; .text:0041B20Aj ...
		add	dword ptr [ebp+8], 1
		add	dword ptr [ebp+0Ch], 1

loc_41B23C:				; CODE XREF: .text:0041B1CEj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41B250
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41B1D0

loc_41B250:				; CODE XREF: .text:0041B228j
					; .text:0041B232j ...
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_41B264
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_41B278

loc_41B264:				; CODE XREF: .text:0041B258j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_41B27F
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_41B27F

loc_41B278:				; CODE XREF: .text:0041B262j
		mov	eax, 0
		jmp	short loc_41B2AD
; ---------------------------------------------------------------------------

loc_41B27F:				; CODE XREF: .text:0041B26Cj
					; .text:0041B276j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx

loc_41B2AD:				; CODE XREF: .text:0041B27Dj
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41B2E1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41B2E1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_41B338
; ---------------------------------------------------------------------------

loc_41B2E1:				; CODE XREF: .text:0041B2C1j
					; .text:0041B2CBj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41B309
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41B309
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_41B338
; ---------------------------------------------------------------------------

loc_41B309:				; CODE XREF: .text:0041B2E9j
					; .text:0041B2F3j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_41B331
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_41B331
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_41B338
; ---------------------------------------------------------------------------

loc_41B331:				; CODE XREF: .text:0041B311j
					; .text:0041B31Bj
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41B3B5
; ---------------------------------------------------------------------------

loc_41B338:				; CODE XREF: .text:0041B2DFj
					; .text:0041B307j ...
		add	dword ptr [ebp+8], 1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41B361
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41B361
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	[ebp-4], eax
		jmp	short loc_41B3B2
; ---------------------------------------------------------------------------

loc_41B361:				; CODE XREF: .text:0041B344j
					; .text:0041B34Ej
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41B386
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41B386
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		add	[ebp-4], eax
		jmp	short loc_41B3B2
; ---------------------------------------------------------------------------

loc_41B386:				; CODE XREF: .text:0041B369j
					; .text:0041B373j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_41B3AB
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_41B3AB
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		add	[ebp-4], eax
		jmp	short loc_41B3B2
; ---------------------------------------------------------------------------

loc_41B3AB:				; CODE XREF: .text:0041B38Ej
					; .text:0041B398j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41B3B5
; ---------------------------------------------------------------------------

loc_41B3B2:				; CODE XREF: .text:0041B35Fj
					; .text:0041B384j ...
		mov	eax, [ebp-4]

locret_41B3B5:				; CODE XREF: .text:0041B336j
					; .text:0041B3B0j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41B3B7(FILE *, int, int, int,	int)
sub_41B3B7	proc near		; CODE XREF: sub_41B570+29p
					; .text:0041B6ADp

var_28		= dword	ptr -28h
File		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_41B561
; ---------------------------------------------------------------------------

loc_41B3CF:				; CODE XREF: sub_41B3B7+1AEj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_41B41D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_41B41D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_C]
		jz	short loc_41B41D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_10]
		jz	short loc_41B41D
		cmp	[ebp+arg_C], 0
		jnz	short loc_41B40F
		cmp	[ebp+arg_10], 0
		jz	loc_41B539

loc_41B40F:				; CODE XREF: sub_41B3B7+4Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_41B539

loc_41B41D:				; CODE XREF: sub_41B3B7+20j
					; sub_41B3B7+2Aj ...
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 5Ch ;	Ch
		call	putc
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_41B45A
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 6Eh ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_41B555
; ---------------------------------------------------------------------------

loc_41B45A:				; CODE XREF: sub_41B3B7+85j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_41B480
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 72h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_41B555
; ---------------------------------------------------------------------------

loc_41B480:				; CODE XREF: sub_41B3B7+ABj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_41B4A6
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 66h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_41B555
; ---------------------------------------------------------------------------

loc_41B4A6:				; CODE XREF: sub_41B3B7+D1j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_41B4CC
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 76h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_41B555
; ---------------------------------------------------------------------------

loc_41B4CC:				; CODE XREF: sub_41B3B7+F7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_41B4EF
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 62h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_41B555
; ---------------------------------------------------------------------------

loc_41B4EF:				; CODE XREF: sub_41B3B7+11Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41B512
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 30h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_41B555
; ---------------------------------------------------------------------------

loc_41B512:				; CODE XREF: sub_41B3B7+140j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "x%02x"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+File],	eax ; Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	File
		call	fprintf
		add	[ebp+var_10], 3
		jmp	short loc_41B555
; ---------------------------------------------------------------------------

loc_41B539:				; CODE XREF: sub_41B3B7+52j
					; sub_41B3B7+60j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	putc
		add	[ebp+var_10], 1

loc_41B555:				; CODE XREF: sub_41B3B7+9Ej
					; sub_41B3B7+C4j ...
		sub	[ebp+arg_8], 1
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_41B561:				; CODE XREF: sub_41B3B7+13j
		cmp	[ebp+arg_8], 0
		jnz	loc_41B3CF
		mov	eax, [ebp+var_10]
		leave
		retn
sub_41B3B7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41B570(FILE *, int, int, int)
sub_41B570	proc near		; CODE XREF: .text:00413CB6p
					; sub_41B5A0+B7p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_18], 0 ; int
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	FILE *
		call	sub_41B3B7
		leave
		retn
sub_41B570	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41B5A0(FILE *, int, int, int)
sub_41B5A0	proc near		; CODE XREF: sub_413CBD+21p
					; .text:0041B759p

Str		= dword	ptr -38h
File		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_41B5C9
; ---------------------------------------------------------------------------

loc_41B5B6:				; CODE XREF: sub_41B5A0+2Fj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_41B5D3
		add	[ebp+var_C], 1

loc_41B5C9:				; CODE XREF: sub_41B5A0+14j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jb	short loc_41B5B6
		jmp	short loc_41B5D4
; ---------------------------------------------------------------------------

loc_41B5D3:				; CODE XREF: sub_41B5A0+23j
		nop

loc_41B5D4:				; CODE XREF: sub_41B5A0+31j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jnb	short loc_41B63C
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+File],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax
		call	sub_41F783
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Str], eax ; Str
		call	fputs
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax ; void *
		call	sub_406E5D
		mov	eax, [ebp+var_C]
		jmp	short loc_41B65C
; ---------------------------------------------------------------------------

loc_41B63C:				; CODE XREF: sub_41B5A0+3Aj
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+File],	eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; FILE *
		call	sub_41B570

loc_41B65C:				; CODE XREF: sub_41B5A0+9Aj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_41B5A0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_41B6B4
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+14h]
		mov	[esp+10h], eax
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41B3B7
		jmp	short loc_41B6B9
; ---------------------------------------------------------------------------

loc_41B6B4:				; CODE XREF: .text:0041B66Dj
		mov	eax, 0

loc_41B6B9:				; CODE XREF: .text:0041B6B2j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_41B70A
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41B570
		jmp	short loc_41B70F
; ---------------------------------------------------------------------------

loc_41B70A:				; CODE XREF: .text:0041B6CAj
		mov	eax, 0

loc_41B70F:				; CODE XREF: .text:0041B708j
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_41B760
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41B5A0
		jmp	short loc_41B765
; ---------------------------------------------------------------------------

loc_41B760:				; CODE XREF: .text:0041B720j
		mov	eax, 0

loc_41B765:				; CODE XREF: .text:0041B75Ej
		add	esp, 24h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41B76B	proc near		; CODE XREF: .text:00413DD6p

Dest		= dword	ptr -38h
Format		= dword	ptr -34h
var_30		= dword	ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_10], 1
		jmp	loc_41B815
; ---------------------------------------------------------------------------

loc_41B78F:				; CODE XREF: sub_41B76B+AEj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_41B7C1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_41B7C1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_8]
		jz	short loc_41B7C1
		cmp	[ebp+arg_8], 0
		jz	short loc_41B809
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_41B809

loc_41B7C1:				; CODE XREF: sub_41B76B+2Cj
					; sub_41B76B+36j ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_41B7FD
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_41B7FD
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jz	short loc_41B7FD
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jz	short loc_41B7FD
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jz	short loc_41B7FD
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41B803

loc_41B7FD:				; CODE XREF: sub_41B76B+5Ej
					; sub_41B76B+68j ...
		add	[ebp+var_10], 2
		jmp	short loc_41B80D
; ---------------------------------------------------------------------------

loc_41B803:				; CODE XREF: sub_41B76B+90j
		add	[ebp+var_10], 5
		jmp	short loc_41B80D
; ---------------------------------------------------------------------------

loc_41B809:				; CODE XREF: sub_41B76B+4Aj
					; sub_41B76B+54j
		add	[ebp+var_10], 1

loc_41B80D:				; CODE XREF: sub_41B76B+96j
					; sub_41B76B+9Cj
		sub	[ebp+arg_4], 1
		add	[ebp+var_C], 1

loc_41B815:				; CODE XREF: sub_41B76B+1Fj
		cmp	[ebp+arg_4], 0
		jnz	loc_41B78F
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+arg_4], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dest],	eax ; size_t
		call	sub_406D00
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_14], eax
		jmp	loc_41B952
; ---------------------------------------------------------------------------

loc_41B844:				; CODE XREF: sub_41B76B+1EBj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_41B87E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_41B87E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_8]
		jz	short loc_41B87E
		cmp	[ebp+arg_8], 0
		jz	loc_41B939
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_41B939

loc_41B87E:				; CODE XREF: sub_41B76B+E1j
					; sub_41B76B+EBj ...
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_41B8A1
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	6Eh
		add	[ebp+var_14], 1
		jmp	loc_41B94A
; ---------------------------------------------------------------------------

loc_41B8A1:				; CODE XREF: sub_41B76B+125j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_41B8BA
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	72h
		add	[ebp+var_14], 1
		jmp	loc_41B94A
; ---------------------------------------------------------------------------

loc_41B8BA:				; CODE XREF: sub_41B76B+13Ej
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_41B8D0
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	66h
		add	[ebp+var_14], 1
		jmp	short loc_41B94A
; ---------------------------------------------------------------------------

loc_41B8D0:				; CODE XREF: sub_41B76B+157j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_41B8E6
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	76h
		add	[ebp+var_14], 1
		jmp	short loc_41B94A
; ---------------------------------------------------------------------------

loc_41B8E6:				; CODE XREF: sub_41B76B+16Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_41B8FC
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	62h
		add	[ebp+var_14], 1
		jmp	short loc_41B94A
; ---------------------------------------------------------------------------

loc_41B8FC:				; CODE XREF: sub_41B76B+183j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41B912
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	30h
		add	[ebp+var_14], 1
		jmp	short loc_41B94A
; ---------------------------------------------------------------------------

loc_41B912:				; CODE XREF: sub_41B76B+199j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "x%02x"
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Format], eax ;	Format
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_14], 3
		jmp	short loc_41B94A
; ---------------------------------------------------------------------------

loc_41B939:				; CODE XREF: sub_41B76B+FFj
					; sub_41B76B+10Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1

loc_41B94A:				; CODE XREF: sub_41B76B+131j
					; sub_41B76B+14Aj ...
		sub	[ebp+arg_4], 1
		add	[ebp+var_C], 1

loc_41B952:				; CODE XREF: sub_41B76B+D4j
		cmp	[ebp+arg_4], 0
		jnz	loc_41B844
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]
		leave
		retn
sub_41B76B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	dword ptr [ebp-4], 0
		jmp	short loc_41B993
; ---------------------------------------------------------------------------

loc_41B976:				; CODE XREF: .text:0041B99Bj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0C0h
		cmp	eax, 80h
		jz	short loc_41B98F
		add	dword ptr [ebp-4], 1

loc_41B98F:				; CODE XREF: .text:0041B989j
		add	dword ptr [ebp+8], 1

loc_41B993:				; CODE XREF: .text:0041B974j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41B976
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41B9A2(DWORD)
sub_41B9A2	proc near		; CODE XREF: sub_409DB0+41p
					; sub_40BD38+51p ...

dwFlags		= dword	ptr -28h
lpSource	= dword	ptr -24h
dwMessageId	= dword	ptr -20h
dwLanguageId	= dword	ptr -1Ch
lpBuffer	= dword	ptr -18h
nSize		= dword	ptr -14h
Arguments	= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jnz	short loc_41B9B8
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+arg_0], eax

loc_41B9B8:				; CODE XREF: sub_41B9A2+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Arguments], 0 ; Arguments
		mov	[esp+28h+nSize], 0FFh ;	nSize
		mov	[esp+28h+lpBuffer], offset Buffer ; lpBuffer
		mov	[esp+28h+dwLanguageId],	400h ; dwLanguageId
		mov	[esp+28h+dwMessageId], eax ; dwMessageId
		mov	[esp+28h+lpSource], 0 ;	lpSource
		mov	[esp+28h+dwFlags], 1000h ; dwFlags
		mov	eax, ds:FormatMessageA
		call	eax ; FormatMessageA
		sub	esp, 1Ch
		mov	eax, offset Buffer
		leave
		retn
sub_41B9A2	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 40h
		jle	short loc_41BA15
		cmp	dword ptr [ebp+8], 5Ah
		jg	short loc_41BA15
		mov	eax, 1
		jmp	short loc_41BA1A
; ---------------------------------------------------------------------------

loc_41BA15:				; CODE XREF: .text:0041BA06j
					; .text:0041BA0Cj
		mov	eax, 0

loc_41BA1A:				; CODE XREF: .text:0041BA13j
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 60h
		jle	short loc_41BA32
		cmp	dword ptr [ebp+8], 7Ah
		jg	short loc_41BA32
		mov	eax, 1
		jmp	short loc_41BA37
; ---------------------------------------------------------------------------

loc_41BA32:				; CODE XREF: .text:0041BA23j
					; .text:0041BA29j
		mov	eax, 0

loc_41BA37:				; CODE XREF: .text:0041BA30j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41BA39	proc near		; CODE XREF: .text:0041A986p
					; .text:0041A999p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 60h
		jle	short loc_41BA4C
		cmp	[ebp+arg_0], 7Ah
		jg	short loc_41BA4C
		and	[ebp+arg_0], 0FFFFFFDFh

loc_41BA4C:				; CODE XREF: sub_41BA39+7j
					; sub_41BA39+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_41BA39	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41BA51	proc near		; CODE XREF: sub_41BB23+33p
					; sub_41BB23+47p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 40h
		jle	short loc_41BA64
		cmp	[ebp+arg_0], 5Ah
		jg	short loc_41BA64
		or	[ebp+arg_0], 20h

loc_41BA64:				; CODE XREF: sub_41BA51+7j
					; sub_41BA51+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_41BA51	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41BA69	proc near		; CODE XREF: sub_413504+107p
					; .text:004137FBp ...

var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_41BAC4
		mov	eax, 0
		jmp	loc_41BB1D
; ---------------------------------------------------------------------------

loc_41BA82:				; CODE XREF: sub_41BA69+6Ej
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_41BABA
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_41BA39
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_41BA39
		cmp	ebx, eax
		jnz	short loc_41BADB

loc_41BABA:				; CODE XREF: sub_41BA69+27j
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1
		jmp	short loc_41BAC5
; ---------------------------------------------------------------------------

loc_41BAC4:				; CODE XREF: sub_41BA69+Dj
		nop

loc_41BAC5:				; CODE XREF: sub_41BA69+59j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41BADC
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41BA82
		jmp	short loc_41BADC
; ---------------------------------------------------------------------------

loc_41BADB:				; CODE XREF: sub_41BA69+4Fj
		nop

loc_41BADC:				; CODE XREF: sub_41BA69+64j
					; sub_41BA69+70j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_41BB18
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_41BA39
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_41BA39
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_41BB1D
; ---------------------------------------------------------------------------

loc_41BB18:				; CODE XREF: sub_41BA69+81j
		mov	eax, 0

loc_41BB1D:				; CODE XREF: sub_41BA69+14j
					; sub_41BA69+ADj
		add	esp, 4
		pop	ebx
		pop	ebp
		retn
sub_41BA69	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41BB23	proc near		; CODE XREF: sub_40377D+21EEp

var_14		= dword	ptr -14h
var_A		= byte ptr -0Ah
var_9		= byte ptr -9
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+var_4]
		cmp	eax, [ebp+var_8]
		jz	short loc_41BB43
		cmp	[ebp+arg_8], 0
		jnz	short loc_41BB4A

loc_41BB43:				; CODE XREF: sub_41BB23+18j
		mov	eax, 0
		jmp	short locret_41BBA1
; ---------------------------------------------------------------------------

loc_41BB4A:				; CODE XREF: sub_41BB23+1Ej
					; sub_41BB23+6Ej
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+14h+var_14], eax
		call	sub_41BA51
		mov	[ebp+var_9], al
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+14h+var_14], eax
		call	sub_41BA51
		mov	[ebp+var_A], al
		sub	[ebp+arg_8], 1
		cmp	[ebp+arg_8], 0
		jz	short loc_41BB93
		cmp	[ebp+var_9], 0
		jz	short loc_41BB93
		add	[ebp+var_4], 1
		add	[ebp+var_8], 1
		movzx	eax, [ebp+var_9]
		cmp	al, [ebp+var_A]
		jz	short loc_41BB4A

loc_41BB93:				; CODE XREF: sub_41BB23+57j
					; sub_41BB23+5Dj
		movzx	edx, [ebp+var_9]
		movzx	eax, [ebp+var_A]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_41BBA1:				; CODE XREF: sub_41BB23+25j
		leave
		retn
sub_41BB23	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41BBA3	proc near		; CODE XREF: .text:0041BD24p
					; sub_41EA4F+14Ap

var_18		= dword	ptr -18h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_C]
		jnz	loc_41BC53
		mov	eax, 0
		jmp	loc_41BC62
; ---------------------------------------------------------------------------

loc_41BBCC:				; CODE XREF: sub_41BBA3+B4j
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_41BC47
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_41BA39
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_41BA39
		cmp	ebx, eax
		jz	short loc_41BC47
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_41BC40
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_41BA39
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_41BA39
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_41BC45
; ---------------------------------------------------------------------------

loc_41BC40:				; CODE XREF: sub_41BBA3+6Fj
		mov	eax, 0

loc_41BC45:				; CODE XREF: sub_41BBA3+9Bj
		jmp	short loc_41BC62
; ---------------------------------------------------------------------------

loc_41BC47:				; CODE XREF: sub_41BBA3+37j
					; sub_41BBA3+5Fj
		sub	[ebp+arg_8], 1
		add	[ebp+var_8], 1
		add	[ebp+var_C], 1

loc_41BC53:				; CODE XREF: sub_41BBA3+19j
		cmp	[ebp+arg_8], 0
		jnz	loc_41BBCC
		mov	eax, 0

loc_41BC62:				; CODE XREF: sub_41BBA3+24j
					; sub_41BBA3:loc_41BC45j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_41BBA3	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		cmp	eax, [ebp+0Ch]
		jnz	short loc_41BC94
		mov	eax, 0
		jmp	short loc_41BCDB
; ---------------------------------------------------------------------------

loc_41BC7A:				; CODE XREF: .text:0041BCA7j
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jnz	short loc_41BCAB
		add	dword ptr [ebp+8], 1
		add	dword ptr [ebp+0Ch], 1
		jmp	short loc_41BC95
; ---------------------------------------------------------------------------

loc_41BC94:				; CODE XREF: .text:0041BC71j
		nop

loc_41BC95:				; CODE XREF: .text:0041BC92j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41BCAC
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41BC7A
		jmp	short loc_41BCAC
; ---------------------------------------------------------------------------

loc_41BCAB:				; CODE XREF: .text:0041BC88j
		nop

loc_41BCAC:				; CODE XREF: .text:0041BC9Dj
					; .text:0041BCA9j
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_41BCD6
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short loc_41BCDB
; ---------------------------------------------------------------------------

loc_41BCD6:				; CODE XREF: .text:0041BCBAj
		mov	eax, 0

loc_41BCDB:				; CODE XREF: .text:0041BC78j
					; .text:0041BCD4j
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		cmp	dword ptr [ebp+14h], 0
		jnz	short loc_41BCEE
		mov	eax, [ebp+8]
		jmp	short locret_41BD43
; ---------------------------------------------------------------------------

loc_41BCEE:				; CODE XREF: .text:0041BCE7j
		mov	eax, [ebp+14h]
		cmp	eax, [ebp+0Ch]
		ja	short loc_41BD3E
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+14h]
		mov	edx, [ebp+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, [ebp-4]
		mov	[ebp-8], eax
		jmp	short loc_41BD36
; ---------------------------------------------------------------------------

loc_41BD10:				; CODE XREF: .text:0041BD3Cj
		mov	eax, [ebp+14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-4]
		mov	[esp], eax
		call	sub_41BBA3
		test	eax, eax
		jnz	short loc_41BD32
		mov	eax, [ebp-4]
		jmp	short locret_41BD43
; ---------------------------------------------------------------------------

loc_41BD32:				; CODE XREF: .text:0041BD2Bj
		add	dword ptr [ebp-4], 1

loc_41BD36:				; CODE XREF: .text:0041BD0Ej
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jbe	short loc_41BD10

loc_41BD3E:				; CODE XREF: .text:0041BCF4j
		mov	eax, 0

locret_41BD43:				; CODE XREF: .text:0041BCECj
					; .text:0041BD30j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41BD45	proc near		; CODE XREF: sub_409AE3+CFp
					; sub_409EDD+AEp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		jmp	short loc_41BD5D
; ---------------------------------------------------------------------------

loc_41BD4A:				; CODE XREF: sub_41BD45+20j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_41BD5D:				; CODE XREF: sub_41BD45+3j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41BD4A
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_41BD45	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_41BD90
		mov	eax, 0
		jmp	locret_41BE3B
; ---------------------------------------------------------------------------

loc_41BD90:				; CODE XREF: .text:0041BD84j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41BDA7
		mov	eax, [ebp+0Ch]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41BE00

loc_41BDA7:				; CODE XREF: .text:0041BD98j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		mov	[ebp-11h], al
		cmp	byte ptr [ebp-11h], 0
		jnz	short loc_41BDBF
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_41BE15
; ---------------------------------------------------------------------------

loc_41BDBF:				; CODE XREF: .text:0041BDB4j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, [ebp-11h]
		jnz	short loc_41BDD2
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	short loc_41BE15
; ---------------------------------------------------------------------------

loc_41BDD2:				; CODE XREF: .text:0041BDC8j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41BDE5
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_41BE15
; ---------------------------------------------------------------------------

loc_41BDE5:				; CODE XREF: .text:0041BDDAj
		movsx	eax, byte ptr [ebp-11h]
		mov	edx, [ebp-10h]
		add	edx, 1
		mov	[esp+4], eax
		mov	[esp], edx
		call	strchr
		mov	[ebp-0Ch], eax
		jmp	short loc_41BE15
; ---------------------------------------------------------------------------

loc_41BE00:				; CODE XREF: .text:0041BDA5j
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	strpbrk
		mov	[ebp-0Ch], eax

loc_41BE15:				; CODE XREF: .text:0041BDBDj
					; .text:0041BDD0j ...
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_41BE2F
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp+8]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		jmp	short loc_41BE38
; ---------------------------------------------------------------------------

loc_41BE2F:				; CODE XREF: .text:0041BE19j
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0

loc_41BE38:				; CODE XREF: .text:0041BE2Dj
		mov	eax, [ebp-10h]

locret_41BE3B:				; CODE XREF: .text:0041BD8Bj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41BE3D	proc near		; CODE XREF: sub_410182+30p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_8]
		add	[ebp+var_4], eax
		jmp	short loc_41BE6C
; ---------------------------------------------------------------------------

loc_41BE51:				; CODE XREF: sub_41BE3D+33j
		sub	[ebp+var_4], 1
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_4]
		jnz	short loc_41BE68
		mov	eax, [ebp+var_4]
		jmp	short locret_41BE77
; ---------------------------------------------------------------------------

loc_41BE68:				; CODE XREF: sub_41BE3D+24j
		sub	[ebp+arg_8], 1

loc_41BE6C:				; CODE XREF: sub_41BE3D+12j
		cmp	[ebp+arg_8], 0
		jnz	short loc_41BE51
		mov	eax, 0

locret_41BE77:				; CODE XREF: sub_41BE3D+29j
		leave
		retn
sub_41BE3D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41BE79(int, char *, int)
sub_41BE79	proc near		; CODE XREF: sub_41C08E+1Bp
					; .text:0041C0CBp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_41BE8F
		mov	eax, 0
		jmp	locret_41C08C
; ---------------------------------------------------------------------------

loc_41BE8F:				; CODE XREF: sub_41BE79+Aj
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	short loc_41BEE5
; ---------------------------------------------------------------------------

loc_41BE9E:				; CODE XREF: sub_41BE79+77j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_41BEDD
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_41BEDD
		cmp	[ebp+arg_4], 0
		jz	short loc_41BEE1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_41BEE1

loc_41BEDD:				; CODE XREF: sub_41BE79+30j
					; sub_41BE79+3Dj
		add	[ebp+var_10], 1

loc_41BEE1:				; CODE XREF: sub_41BE79+43j
					; sub_41BE79+62j
		add	[ebp+var_C], 1

loc_41BEE5:				; CODE XREF: sub_41BE79+23j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41BE9E
		cmp	[ebp+arg_8], 0
		jz	short loc_41BF10
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+Str], eax ; size_t
		call	sub_406D00
		mov	[ebp+var_14], eax
		jmp	short loc_41BF36
; ---------------------------------------------------------------------------

loc_41BF10:				; CODE XREF: sub_41BE79+7Dj
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+Str], eax ; size_t
		call	sub_406CDA
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_41BF36
		mov	eax, 0
		jmp	locret_41C08C
; ---------------------------------------------------------------------------

loc_41BF36:				; CODE XREF: sub_41BE79+95j
					; sub_41BE79+B1j
		mov	[ebp+var_C], 0
		jmp	loc_41C072
; ---------------------------------------------------------------------------

loc_41BF42:				; CODE XREF: sub_41BE79+201j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_41BF78
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	33h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	61h
		add	[ebp+var_C], 1
		jmp	loc_41C06E
; ---------------------------------------------------------------------------

loc_41BF78:				; CODE XREF: sub_41BE79+D1j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_41BFAE
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	32h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	35h
		add	[ebp+var_C], 1
		jmp	loc_41C06E
; ---------------------------------------------------------------------------

loc_41BFAE:				; CODE XREF: sub_41BE79+107j
		cmp	[ebp+arg_4], 0
		jz	loc_41C05C
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	loc_41C05C
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		sar	al, 4
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_41C00F
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 30h
		jmp	short loc_41C01B
; ---------------------------------------------------------------------------

loc_41C00F:				; CODE XREF: sub_41BE79+186j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 57h

loc_41C01B:				; CODE XREF: sub_41BE79+194j
		mov	[edx], al
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_41C048
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_41C054
; ---------------------------------------------------------------------------

loc_41C048:				; CODE XREF: sub_41BE79+1BFj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 57h

loc_41C054:				; CODE XREF: sub_41BE79+1CDj
		mov	[edx], al
		add	[ebp+var_C], 1
		jmp	short loc_41C06E
; ---------------------------------------------------------------------------

loc_41C05C:				; CODE XREF: sub_41BE79+139j
					; sub_41BE79+159j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		movzx	edx, byte ptr [edx]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_41C06E:				; CODE XREF: sub_41BE79+FAj
					; sub_41BE79+130j ...
		add	[ebp+arg_0], 1

loc_41C072:				; CODE XREF: sub_41BE79+C4j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_41BF42
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]

locret_41C08C:				; CODE XREF: sub_41BE79+11j
					; sub_41BE79+B8j
		leave
		retn
sub_41BE79	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41C08E(int, char *)
sub_41C08E	proc near		; CODE XREF: sub_402175+42Dp
					; sub_402175+485p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_10], 1 ; int
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_41BE79
		leave
		retn
sub_41C08E	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41BE79
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C0D2	proc near		; CODE XREF: .text:0041C221p
					; sub_41C22E+32p

var_F8		= dword	ptr -0F8h
var_F4		= dword	ptr -0F4h
var_DC		= dword	ptr -0DCh
var_D8		= dword	ptr -0D8h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 0F4h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		mov	[ebp+eax*4+var_D8], edx
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_DC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_DC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_41C16B
; ---------------------------------------------------------------------------

loc_41C11E:				; CODE XREF: sub_41C0D2+BAj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		mov	[ebp+var_DC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_DC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		cmp	[ebp+var_C], 2Eh
		jbe	short loc_41C167
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	short loc_41C1E6
; ---------------------------------------------------------------------------

loc_41C167:				; CODE XREF: sub_41C0D2+7Fj
		add	[ebp+var_C], 1

loc_41C16B:				; CODE XREF: sub_41C0D2+4Aj
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+4]
		mov	[ebp+arg_4], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_D8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		test	eax, eax
		jnz	short loc_41C11E
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[esp+0F8h+var_F8], eax ; size_t
		call	sub_406CDA
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_41C1E3
		mov	eax, [ebp+var_18]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	short loc_41C1D5
; ---------------------------------------------------------------------------

loc_41C1B5:				; CODE XREF: sub_41C0D2+10Fj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		mov	[esp+0F8h+var_F4], eax
		mov	eax, [ebp+var_14]
		mov	[esp+0F8h+var_F8], eax
		call	sub_41BD45
		mov	[ebp+var_14], eax
		add	[ebp+var_C], 1

loc_41C1D5:				; CODE XREF: sub_41C0D2+E1j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		test	eax, eax
		jnz	short loc_41C1B5

loc_41C1E3:				; CODE XREF: sub_41C0D2+D2j
		mov	eax, [ebp+var_18]

loc_41C1E6:				; CODE XREF: sub_41C0D2+93j
		add	esp, 0F4h
		pop	edi
		pop	ebp
		retn
sub_41C0D2	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_41C20C
		mov	dword ptr [esp], offset	word_426C56
		call	sub_406D24
		mov	[ebp-0Ch], eax
		jmp	short loc_41C229
; ---------------------------------------------------------------------------

loc_41C20C:				; CODE XREF: .text:0041C1F9j
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41C0D2
		mov	[ebp-0Ch], eax

loc_41C229:				; CODE XREF: .text:0041C20Aj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C22E	proc near		; CODE XREF: sub_409AE3+3Fp
					; sub_409CFD+1Ep ...

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_41C24B
		mov	[esp+28h+Str], offset word_426C56 ; char *
		call	sub_406E03
		mov	[ebp+var_C], eax
		jmp	short loc_41C268
; ---------------------------------------------------------------------------

loc_41C24B:				; CODE XREF: sub_41C22E+Aj
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Size],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_41C0D2
		mov	[ebp+var_C], eax

loc_41C268:				; CODE XREF: sub_41C22E+1Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_41C2DC
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_41C2A7
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aFatalTooManyAr ; "\nfatal:	too many args for xstrconcat\n"
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 25h ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		jmp	short loc_41C2D0
; ---------------------------------------------------------------------------

loc_41C2A7:				; CODE XREF: sub_41C22E+4Cj
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aFatalOutOfMemo ; "\nfatal:	out of memory\n"
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 16h ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite

loc_41C2D0:				; CODE XREF: sub_41C22E+77j
		mov	[esp+28h+Str], 2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_41C2DC:				; CODE XREF: sub_41C22E+3Ej
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41C22E	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C2E4	proc near		; CODE XREF: sub_41C84E+57p
					; sub_41D231+1Cp

Code		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 8000h
		test	eax, eax
		jnz	short loc_41C371
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+28h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+34h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, eax
		or	dh, 80h
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		test	eax, eax
		jns	short loc_41C371
		mov	[esp+28h+Code],	offset aInvalidArgum_0 ; "invalid argument for arg_parsee\n"
		call	sub_41A6D5
; ---------------------------------------------------------------------------

loc_41C371:				; CODE XREF: sub_41C2E4+13j
					; sub_41C2E4+7Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_41C624
		cmp	dword ptr [ebp+arg_4], 0
		jz	loc_41C4A9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFAh
		jnz	short loc_41C3A8
		mov	[esp+28h+Code],	offset aArgumentNotExp ; "argument not expected"
		call	sub_419D7C
		mov	dword ptr [ebp+var_C], eax
		jmp	loc_41C481
; ---------------------------------------------------------------------------

loc_41C3A8:				; CODE XREF: sub_41C2E4+AEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFBh
		jnz	short loc_41C3C7
		mov	[esp+28h+Code],	offset aReadError ; "read error"
		call	sub_419D7C
		mov	dword ptr [ebp+var_C], eax
		jmp	loc_41C481
; ---------------------------------------------------------------------------

loc_41C3C7:				; CODE XREF: sub_41C2E4+CDj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFCh
		jnz	short loc_41C3E6
		mov	[esp+28h+Code],	offset aKeywordTooLong ; "keyword too long"
		call	sub_419D7C
		mov	dword ptr [ebp+var_C], eax
		jmp	loc_41C481
; ---------------------------------------------------------------------------

loc_41C3E6:				; CODE XREF: sub_41C2E4+ECj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_41C402
		mov	[esp+28h+Code],	offset aMissingArgumen ; "missing argument"
		call	sub_419D7C
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_41C481
; ---------------------------------------------------------------------------

loc_41C402:				; CODE XREF: sub_41C2E4+10Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF4h
		jnz	short loc_41C41E
		mov	[esp+28h+Code],	offset aInvalidArgum_1 ; "invalid argument"
		call	sub_419D7C
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_41C481
; ---------------------------------------------------------------------------

loc_41C41E:				; CODE XREF: sub_41C2E4+127j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF9h
		jnz	short loc_41C43A
		mov	[esp+28h+Code],	offset aInvalidCommand ; "invalid command"
		call	sub_419D7C
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_41C481
; ---------------------------------------------------------------------------

loc_41C43A:				; CODE XREF: sub_41C2E4+143j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF6h
		jnz	short loc_41C456
		mov	[esp+28h+Code],	offset aInvalidAliasDe ; "invalid alias	definition"
		call	sub_419D7C
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_41C481
; ---------------------------------------------------------------------------

loc_41C456:				; CODE XREF: sub_41C2E4+15Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF5h
		jnz	short loc_41C472
		mov	[esp+28h+Code],	offset aOutOfCore ; "out of core"
		call	sub_419D7C
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_41C481
; ---------------------------------------------------------------------------

loc_41C472:				; CODE XREF: sub_41C2E4+17Bj
		mov	[esp+28h+Code],	offset aInvalidOption ;	"invalid option"
		call	sub_419D7C
		mov	dword ptr [ebp+var_C], eax

loc_41C481:				; CODE XREF: sub_41C2E4+BFj
					; sub_41C2E4+DEj ...
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	edx, dword ptr [ebp+var_C]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aSUS ; "%s:%u: %s\n"
		call	sub_41A665
		jmp	loc_41C603
; ---------------------------------------------------------------------------

loc_41C4A9:				; CODE XREF: sub_41C2E4+9Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_41C4BB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		jmp	short loc_41C4C0
; ---------------------------------------------------------------------------

loc_41C4BB:				; CODE XREF: sub_41C2E4+1CDj
		mov	eax, offset a??	; "[??]"

loc_41C4C0:				; CODE XREF: sub_41C2E4+1D5j
		mov	dword ptr [ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_41C4EE
		mov	[esp+28h+Code],	offset aMissingArgum_0 ; "missing argument for option \"%.50s\"\n"
		call	sub_419D7C
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_41A665
		jmp	loc_41C603
; ---------------------------------------------------------------------------

loc_41C4EE:				; CODE XREF: sub_41C2E4+1E8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF4h
		jnz	short loc_41C519
		mov	[esp+28h+Code],	offset aInvalidArgum_2 ; "invalid argument for option \"%.50s\"\n"
		call	sub_419D7C
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_41A665
		jmp	loc_41C603
; ---------------------------------------------------------------------------

loc_41C519:				; CODE XREF: sub_41C2E4+213j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFAh
		jnz	short loc_41C544
		mov	[esp+28h+Code],	offset aOption_50sDoes ; "option \"%.50s\" does	not expect an arg"...
		call	sub_419D7C
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_41A665
		jmp	loc_41C603
; ---------------------------------------------------------------------------

loc_41C544:				; CODE XREF: sub_41C2E4+23Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF9h
		jnz	short loc_41C56F
		mov	[esp+28h+Code],	offset aInvalidComma_0 ; "invalid command \"%.50s\"\n"
		call	sub_419D7C
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_41A665
		jmp	loc_41C603
; ---------------------------------------------------------------------------

loc_41C56F:				; CODE XREF: sub_41C2E4+269j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF8h
		jnz	short loc_41C597
		mov	[esp+28h+Code],	offset aOption_50sIsAm ; "option \"%.50s\" is ambiguous\n"
		call	sub_419D7C
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_41A665
		jmp	short loc_41C603
; ---------------------------------------------------------------------------

loc_41C597:				; CODE XREF: sub_41C2E4+294j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF8h
		jnz	short loc_41C5BF
		mov	[esp+28h+Code],	offset aCommand_50sIsA ; "command \"%.50s\" is ambiguous\n"
		call	sub_419D7C
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_41A665
		jmp	short loc_41C603
; ---------------------------------------------------------------------------

loc_41C5BF:				; CODE XREF: sub_41C2E4+2BCj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF5h
		jnz	short loc_41C5E8
		mov	[esp+28h+Code],	offset aOutOfCore_0 ; "out of core\n"
		call	sub_419D7C
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aS_1 ; "%s\n"
		call	sub_41A665
		jmp	short loc_41C603
; ---------------------------------------------------------------------------

loc_41C5E8:				; CODE XREF: sub_41C2E4+2E4j
		mov	[esp+28h+Code],	offset aInvalidOption_ ; "invalid option \"%.50s\"\n"
		call	sub_419D7C
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_41A665

loc_41C603:				; CODE XREF: sub_41C2E4+1C0j
					; sub_41C2E4+205j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, 1
		jz	short loc_41C61A
		mov	[esp+28h+Code],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_41C61A:				; CODE XREF: sub_41C2E4+328j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0

loc_41C624:				; CODE XREF: sub_41C2E4+95j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		leave
		retn
sub_41C2E4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C63A	proc near		; CODE XREF: sub_41C84E+342p
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_41C63A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41C63F(int, char *)
sub_41C63F	proc near		; CODE XREF: sub_41C685+11Cp
					; sub_41C84E+199p ...

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[ebp+var_C], eax
		jmp	short loc_41C678
; ---------------------------------------------------------------------------

loc_41C650:				; CODE XREF: sub_41C63F+3Dj
		mov	eax, [ebp+var_C]
		lea	edx, [eax+4]
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str2],	eax ; Str2
		mov	[esp+28h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41C670
		mov	eax, 1
		jmp	short locret_41C683
; ---------------------------------------------------------------------------

loc_41C670:				; CODE XREF: sub_41C63F+28j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_41C678:				; CODE XREF: sub_41C63F+Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_41C650
		mov	eax, 0

locret_41C683:				; CODE XREF: sub_41C63F+2Fj
		leave
		retn
sub_41C63F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41C685(int, FILE *)
sub_41C685	proc near		; CODE XREF: sub_41C84E+643p

File		= dword	ptr -98h
Source		= dword	ptr -94h
var_80		= byte ptr -80h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 98h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		jmp	loc_41C801
; ---------------------------------------------------------------------------

loc_41C6A8:				; CODE XREF: sub_41C685+180j
		mov	eax, [ebp+arg_4]
		mov	[esp+98h+File],	eax ; File
		call	getc
		mov	[ebp+C], eax
		cmp	[ebp+C], 0Ah
		jnz	short loc_41C6C5
		mov	[ebp+var_14], 1
		jmp	short loc_41C6D9
; ---------------------------------------------------------------------------

loc_41C6C5:				; CODE XREF: sub_41C685+35j
		cmp	[ebp+C], 0FFFFFFFFh
		jnz	short loc_41C6D9
		mov	[ebp+C], 0Ah
		mov	[ebp+var_14], 1

loc_41C6D9:				; CODE XREF: sub_41C685+3Ej
					; sub_41C685+44j ...
		mov	eax, [ebp+var_18]
		cmp	eax, 1
		jz	short loc_41C726
		cmp	eax, 1
		jb	short loc_41C6F9
		cmp	eax, 2
		jz	short loc_41C76A
		cmp	eax, 3
		jz	loc_41C78B
		jmp	loc_41C801
; ---------------------------------------------------------------------------

loc_41C6F9:				; CODE XREF: sub_41C685+5Fj
		mov	eax, [ebp+C]
		cmp	eax, 7Fh
		ja	short loc_41C716
		mov	eax, [ebp+C]
		mov	[esp+98h+File],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_41C7FD

loc_41C716:				; CODE XREF: sub_41C685+7Aj
		mov	[ebp+var_10], 0
		mov	[ebp+var_18], 1
		jmp	short loc_41C6D9
; ---------------------------------------------------------------------------

loc_41C726:				; CODE XREF: sub_41C685+5Aj
		mov	eax, [ebp+C]
		mov	[esp+98h+File],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_41C740
		mov	[ebp+var_18], 3
		jmp	short loc_41C6D9
; ---------------------------------------------------------------------------

loc_41C740:				; CODE XREF: sub_41C685+B0j
		mov	eax, [ebp+var_10]
		cmp	eax, 62h
		ja	short loc_41C75E
		mov	eax, [ebp+C]
		mov	edx, eax
		lea	eax, [ebp+var_80]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_41C801
; ---------------------------------------------------------------------------

loc_41C75E:				; CODE XREF: sub_41C685+C1j
		mov	[ebp+var_18], 2
		jmp	loc_41C801
; ---------------------------------------------------------------------------

loc_41C76A:				; CODE XREF: sub_41C685+64j
		mov	eax, [ebp+C]
		mov	[esp+98h+File],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	loc_41C800
		mov	[ebp+var_18], 0
		jmp	loc_41C6D9
; ---------------------------------------------------------------------------

loc_41C78B:				; CODE XREF: sub_41C685+69j
		lea	eax, [ebp+var_80]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		lea	eax, [ebp+var_80]
		mov	[esp+98h+Source], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+File],	eax ; int
		call	sub_41C63F
		test	eax, eax
		jnz	short loc_41C7F1
		mov	eax, [ebp+var_10]
		add	eax, 8
		mov	[esp+98h+File],	eax ; size_t
		call	sub_406CDA
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_41C7C8
		mov	eax, 1
		jmp	short locret_41C810
; ---------------------------------------------------------------------------

loc_41C7C8:				; CODE XREF: sub_41C685+13Aj
		lea	eax, [ebp+var_80]
		mov	edx, [ebp+var_1C]
		add	edx, 4
		mov	[esp+98h+Source], eax ;	Source
		mov	[esp+98h+File],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+34h]
		mov	eax, [ebp+var_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_1C]
		mov	[eax+34h], edx

loc_41C7F1:				; CODE XREF: sub_41C685+123j
		mov	[ebp+var_18], 0
		jmp	loc_41C6D9
; ---------------------------------------------------------------------------

loc_41C7FD:				; CODE XREF: sub_41C685+8Bj
		nop
		jmp	short loc_41C801
; ---------------------------------------------------------------------------

loc_41C800:				; CODE XREF: sub_41C685+F4j
		nop

loc_41C801:				; CODE XREF: sub_41C685+1Ej
					; sub_41C685+6Fj ...
		cmp	[ebp+var_14], 0
		jz	loc_41C6A8
		mov	eax, 0

locret_41C810:				; CODE XREF: sub_41C685+141j
		leave
		retn
sub_41C685	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C812	proc near		; CODE XREF: sub_41C84E+48Ap

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[ebp+var_C], eax
		jmp	short loc_41C83C
; ---------------------------------------------------------------------------

loc_41C823:				; CODE XREF: sub_41C812+2Ej
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_406E5D
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_41C83C:				; CODE XREF: sub_41C812+Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_41C823
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+34h], 0
		leave
		retn
sub_41C812	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41C84E(FILE *, int, int, int,	int)
sub_41C84E	proc near		; CODE XREF: sub_40377D+219p

File		= dword	ptr -0C8h
Str2		= dword	ptr -0C4h
Size		= dword	ptr -0C0h
var_AC		= dword	ptr -0ACh
Str1		= byte ptr -9Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
Str		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 0C4h
		mov	[ebp+var_14], 0
		mov	[ebp+Str], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 0
		cmp	[ebp+arg_0], 0
		jnz	short loc_41C891
		mov	eax, [ebp+arg_10]
		mov	[esp+0C8h+Str2], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax
		call	sub_41D231
		jmp	loc_41D0D0
; ---------------------------------------------------------------------------

loc_41C891:				; CODE XREF: sub_41C84E+2Aj
		mov	eax, [ebp+arg_8]
		mov	[esp+0C8h+Size], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Str2], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax
		call	sub_41C2E4
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	short loc_41C8BA
; ---------------------------------------------------------------------------

loc_41C8B9:				; CODE XREF: sub_41C84E+4D3j
					; sub_41C84E+518j ...
		nop

loc_41C8BA:				; CODE XREF: sub_41C84E+69j
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+File], eax ; File
		call	getc
		mov	[ebp+C], eax
		cmp	[ebp+C], 0Ah
		jz	short loc_41C8D8
		cmp	[ebp+C], 0FFFFFFFFh
		jnz	loc_41CD1D

loc_41C8D8:				; CODE XREF: sub_41C84E+7Ej
		cmp	[ebp+C], 0FFFFFFFFh
		jz	short loc_41C8EB
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_41C8EB:				; CODE XREF: sub_41C84E+8Ej
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	loc_41D0C6
		cmp	[ebp+var_C], 2
		jnz	loc_41CA81
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	[ebp+var_10], 0
		jmp	short loc_41C94A
; ---------------------------------------------------------------------------

loc_41C914:				; CODE XREF: sub_41C84E+109j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_41C946
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+4]
		lea	edx, [ebp+Str1]
		mov	[esp+0C8h+Str2], edx ; Str2
		mov	[esp+0C8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_41C95B

loc_41C946:				; CODE XREF: sub_41C84E+D4j
		add	[ebp+var_10], 1

loc_41C94A:				; CODE XREF: sub_41C84E+C4j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41C914
		jmp	short loc_41C95C
; ---------------------------------------------------------------------------

loc_41C95B:				; CODE XREF: sub_41C84E+F6j
		nop

loc_41C95C:				; CODE XREF: sub_41C84E+10Bj
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	edx, [eax]
		mov	eax, [ebp+arg_C]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jz	short loc_41C998
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	loc_41D0C1
; ---------------------------------------------------------------------------

loc_41C998:				; CODE XREF: sub_41C84E+136j
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_41CA2E
		mov	[esp+0C8h+Str2], offset	aIgnoreInvalidO	; "ignore-invalid-option"
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41C9D7
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	loc_41D0C1
; ---------------------------------------------------------------------------

loc_41C9D7:				; CODE XREF: sub_41C84E+175j
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+Str2], eax ; char *
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax ; int
		call	sub_41C63F
		test	eax, eax
		jz	short loc_41CA02
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	loc_41D0C1
; ---------------------------------------------------------------------------

loc_41CA02:				; CODE XREF: sub_41C84E+1A0j
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 80h
		test	eax, eax
		jz	short loc_41CA1E
		mov	eax, 0FFFFFFF9h
		jmp	short loc_41CA23
; ---------------------------------------------------------------------------

loc_41CA1E:				; CODE XREF: sub_41C84E+1C7j
		mov	eax, 0FFFFFFFEh

loc_41CA23:				; CODE XREF: sub_41C84E+1CEj
		mov	edx, [ebp+arg_C]
		mov	[edx+10h], eax
		jmp	loc_41D0CA
; ---------------------------------------------------------------------------

loc_41CA2E:				; CODE XREF: sub_41C84E+157j
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_41CA50
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_41D0CA
; ---------------------------------------------------------------------------

loc_41CA50:				; CODE XREF: sub_41C84E+1F1j
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_41CA72
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_41D0CA
; ---------------------------------------------------------------------------

loc_41CA72:				; CODE XREF: sub_41C84E+213j
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_41D0CA
; ---------------------------------------------------------------------------

loc_41CA81:				; CODE XREF: sub_41C84E+ABj
		cmp	[ebp+var_C], 3
		jnz	short loc_41CAEF
		cmp	[ebp+var_20], 0
		jz	short loc_41CA9C
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_41D0CA
; ---------------------------------------------------------------------------

loc_41CA9C:				; CODE XREF: sub_41C84E+23Dj
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_41CABE
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_41D0CA
; ---------------------------------------------------------------------------

loc_41CABE:				; CODE XREF: sub_41C84E+25Fj
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_41CAE0
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_41D0CA
; ---------------------------------------------------------------------------

loc_41CAE0:				; CODE XREF: sub_41C84E+281j
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_41D0CA
; ---------------------------------------------------------------------------

loc_41CAEF:				; CODE XREF: sub_41C84E+237j
		cmp	[ebp+var_C], 4
		jnz	loc_41CCCC
		cmp	[ebp+var_20], 0
		jz	loc_41CB9A
		cmp	[ebp+Str], 0
		jnz	short loc_41CB18
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFAh
		jmp	loc_41CCC7
; ---------------------------------------------------------------------------

loc_41CB18:				; CODE XREF: sub_41C84E+2B9j
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	byte ptr [eax],	0
		mov	[esp+0C8h+Str2], offset	asc_426E83 ; " \t"
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax ; Str
		call	strpbrk
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_41CB52
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_24]
		mov	[esp+0C8h+File], eax
		call	sub_41AA98

loc_41CB52:				; CODE XREF: sub_41C84E+2EDj
		cmp	[ebp+var_24], 0
		jz	short loc_41CB62
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41CB7C

loc_41CB62:				; CODE XREF: sub_41C84E+308j
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax ; void *
		call	sub_406E5D
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFF6h
		jmp	loc_41D0C9
; ---------------------------------------------------------------------------

loc_41CB7C:				; CODE XREF: sub_41C84E+312j
		mov	eax, [ebp+var_24]
		mov	[esp+0C8h+Size], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+Str2], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax
		call	sub_41C63A
		jmp	loc_41CCC7
; ---------------------------------------------------------------------------

loc_41CB9A:				; CODE XREF: sub_41C84E+2AFj
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_41CBBC
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFAh
		jmp	loc_41D0C9
; ---------------------------------------------------------------------------

loc_41CBBC:				; CODE XREF: sub_41C84E+35Dj
		cmp	[ebp+Str], 0
		jnz	short loc_41CBF1
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+File], eax ; char *
		call	sub_406D24
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jnz	short loc_41CBFA
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	short loc_41CBFA
; ---------------------------------------------------------------------------

loc_41CBF1:				; CODE XREF: sub_41C84E+372j
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	byte ptr [eax],	0

loc_41CBFA:				; CODE XREF: sub_41C84E+395j
					; sub_41C84E+3A1j
		cmp	[ebp+Str], 0
		jz	loc_41D0C9
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax
		call	sub_41AA98
		mov	eax, [ebp+Str]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_41CC8D
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41CC8D
		mov	eax, [ebp+var_28]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_41CC8D
		mov	eax, [ebp+var_28]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+var_28]
		mov	byte ptr [eax],	0

loc_41CC8D:				; CODE XREF: sub_41C84E+3CFj
					; sub_41C84E+3DDj ...
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_28]
		mov	[esp+0C8h+Size], edx ; char *
		mov	[esp+0C8h+Str2], eax ; int
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax ; int
		call	sub_41D9E6
		test	eax, eax
		jnz	loc_41D0C9
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax ; void *
		call	sub_406E5D
		jmp	loc_41D0C9
; ---------------------------------------------------------------------------

loc_41CCC7:				; CODE XREF: sub_41C84E+2C5j
					; sub_41C84E+347j
		jmp	loc_41D0C9
; ---------------------------------------------------------------------------

loc_41CCCC:				; CODE XREF: sub_41C84E+2A5j
		cmp	[ebp+C], 0FFFFFFFFh
		jnz	short loc_41CD0A
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax
		call	sub_41C812
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+File], eax ; File
		call	ferror
		test	eax, eax
		jz	short loc_41CCFB
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFBh
		jmp	loc_41D0CA
; ---------------------------------------------------------------------------

loc_41CCFB:				; CODE XREF: sub_41C84E+49Cj
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0
		jmp	loc_41D0CA
; ---------------------------------------------------------------------------

loc_41CD0A:				; CODE XREF: sub_41C84E+482j
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	loc_41D0C1
; ---------------------------------------------------------------------------

loc_41CD1D:				; CODE XREF: sub_41C84E+84j
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	loc_41C8B9
		cmp	[ebp+var_C], 0
		jnz	short loc_41CD4A
		mov	eax, [ebp+C]
		cmp	eax, 7Fh
		ja	short loc_41CD4A
		mov	eax, [ebp+C]
		mov	[esp+0C8h+File], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_41D0C1

loc_41CD4A:				; CODE XREF: sub_41C84E+4DDj
					; sub_41C84E+4E5j
		cmp	[ebp+var_C], 0
		jnz	short loc_41CD62
		cmp	[ebp+C], 23h
		jnz	short loc_41CD62
		mov	[ebp+var_C], 1
		jmp	loc_41D0C1
; ---------------------------------------------------------------------------

loc_41CD62:				; CODE XREF: sub_41C84E+500j
					; sub_41C84E+506j
		cmp	[ebp+var_C], 1
		jz	loc_41C8B9
		cmp	[ebp+var_C], 2
		jnz	loc_41CF2C
		mov	eax, [ebp+C]
		cmp	eax, 7Fh
		ja	loc_41CF2C
		mov	eax, [ebp+C]
		mov	[esp+0C8h+File], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	loc_41CF2C
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	[ebp+var_10], 0
		jmp	short loc_41CDE2
; ---------------------------------------------------------------------------

loc_41CDAC:				; CODE XREF: sub_41C84E+5A1j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_41CDDE
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+4]
		lea	edx, [ebp+Str1]
		mov	[esp+0C8h+Str2], edx ; Str2
		mov	[esp+0C8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_41CDF3

loc_41CDDE:				; CODE XREF: sub_41C84E+56Cj
		add	[ebp+var_10], 1

loc_41CDE2:				; CODE XREF: sub_41C84E+55Cj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41CDAC
		jmp	short loc_41CDF4
; ---------------------------------------------------------------------------

loc_41CDF3:				; CODE XREF: sub_41C84E+58Ej
		nop

loc_41CDF4:				; CODE XREF: sub_41C84E+5A3j
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	edx, [eax]
		mov	eax, [ebp+arg_C]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jz	short loc_41CE2A
		mov	[ebp+var_C], 1
		jmp	loc_41D0C1
; ---------------------------------------------------------------------------

loc_41CE2A:				; CODE XREF: sub_41C84E+5CEj
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_41CF20
		mov	[esp+0C8h+Str2], offset	aAlias ; "alias"
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41CE6A
		mov	[ebp+var_20], 1
		mov	[ebp+var_C], 3
		jmp	loc_41D0C1
; ---------------------------------------------------------------------------

loc_41CE6A:				; CODE XREF: sub_41C84E+607j
		mov	[esp+0C8h+Str2], offset	aIgnoreInvalidO	; "ignore-invalid-option"
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41CEC8
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+Str2], eax ; FILE *
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax ; int
		call	sub_41C685
		test	eax, eax
		jz	short loc_41CEA9
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	loc_41D0CA
; ---------------------------------------------------------------------------

loc_41CEA9:				; CODE XREF: sub_41C84E+64Aj
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		jmp	loc_41D0C1
; ---------------------------------------------------------------------------

loc_41CEC8:				; CODE XREF: sub_41C84E+634j
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+Str2], eax ; char *
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax ; int
		call	sub_41C63F
		test	eax, eax
		jz	short loc_41CEED
		mov	[ebp+var_C], 1
		jmp	loc_41D0C1
; ---------------------------------------------------------------------------

loc_41CEED:				; CODE XREF: sub_41C84E+691j
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 80h
		test	eax, eax
		jz	short loc_41CF09
		mov	eax, 0FFFFFFF9h
		jmp	short loc_41CF0E
; ---------------------------------------------------------------------------

loc_41CF09:				; CODE XREF: sub_41C84E+6B2j
		mov	eax, 0FFFFFFFEh

loc_41CF0E:				; CODE XREF: sub_41C84E+6B9j
		mov	edx, [ebp+arg_C]
		mov	[edx+10h], eax
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_41D0C1
; ---------------------------------------------------------------------------

loc_41CF20:				; CODE XREF: sub_41C84E+5E9j
		mov	[ebp+var_C], 3
		jmp	loc_41D0C1
; ---------------------------------------------------------------------------

loc_41CF2C:				; CODE XREF: sub_41C84E+522j
					; sub_41C84E+52Ej ...
		cmp	[ebp+var_C], 3
		jnz	short loc_41CF76
		mov	eax, [ebp+C]
		cmp	eax, 7Fh
		ja	short loc_41CF4F
		mov	eax, [ebp+C]
		mov	[esp+0C8h+File], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_41C8B9

loc_41CF4F:				; CODE XREF: sub_41C84E+6EAj
		mov	[ebp+var_10], 0
		mov	eax, [ebp+C]
		mov	edx, eax
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		mov	[ebp+var_C], 4
		jmp	loc_41C8B9
; ---------------------------------------------------------------------------

loc_41CF76:				; CODE XREF: sub_41C84E+6E2j
		cmp	[ebp+var_C], 4
		jnz	loc_41D083
		cmp	[ebp+Str], 0
		jz	short loc_41D005
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_1C]
		sub	edx, 1
		cmp	eax, edx
		jnb	short loc_41CFA7
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	edx, [ebp+C]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_41C8B9
; ---------------------------------------------------------------------------

loc_41CFA7:				; CODE XREF: sub_41C84E+743j
		mov	eax, [ebp+var_1C]
		add	eax, 32h
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		mov	[esp+0C8h+Str2], eax ; size_t
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax ; void *
		call	sub_406D79
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jz	short loc_41CFEB
		mov	eax, [ebp+var_30]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_34]
		mov	[ebp+Str], eax
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	edx, [ebp+C]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_41C8B9
; ---------------------------------------------------------------------------

loc_41CFEB:				; CODE XREF: sub_41C84E+77Bj
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax ; void *
		call	sub_406E5D
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	loc_41D0CA
; ---------------------------------------------------------------------------

loc_41D005:				; CODE XREF: sub_41C84E+736j
		mov	eax, [ebp+var_10]
		cmp	eax, 62h
		ja	short loc_41D026
		mov	eax, [ebp+C]
		mov	edx, eax
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_41C8B9
; ---------------------------------------------------------------------------

loc_41D026:				; CODE XREF: sub_41C84E+7BDj
		mov	[ebp+var_38], 96h
		mov	eax, [ebp+var_38]
		mov	[esp+0C8h+File], eax ; size_t
		call	sub_406CDA
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jz	short loc_41D077
		mov	eax, [ebp+var_38]
		mov	[ebp+var_1C], eax
		mov	ecx, [ebp+var_10]
		lea	edx, [ebp+Str1]
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+Size], ecx ; Size
		mov	[esp+0C8h+Str2], edx ; Src
		mov	[esp+0C8h+File], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	edx, [ebp+C]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_41C8B9
; ---------------------------------------------------------------------------

loc_41D077:				; CODE XREF: sub_41C84E+7F1j
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	short loc_41D0CA
; ---------------------------------------------------------------------------

loc_41D083:				; CODE XREF: sub_41C84E+72Cj
		mov	eax, [ebp+var_10]
		cmp	eax, 62h
		jbe	short loc_41D0A1
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFCh
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_41C8B9
; ---------------------------------------------------------------------------

loc_41D0A1:				; CODE XREF: sub_41C84E+83Bj
		mov	eax, [ebp+C]
		mov	edx, eax
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		mov	[ebp+var_C], 2
		jmp	loc_41C8B9
; ---------------------------------------------------------------------------

loc_41D0C1:				; CODE XREF: sub_41C84E+145j
					; sub_41C84E+184j ...
		jmp	loc_41C8B9
; ---------------------------------------------------------------------------

loc_41D0C6:				; CODE XREF: sub_41C84E+A1j
		nop
		jmp	short loc_41D0CA
; ---------------------------------------------------------------------------

loc_41D0C9:				; CODE XREF: sub_41C84E+329j
					; sub_41C84E+369j ...
		nop

loc_41D0CA:				; CODE XREF: sub_41C84E+1DBj
					; sub_41C84E+1FDj ...
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+10h]

loc_41D0D0:				; CODE XREF: sub_41C84E+3Ej
		add	esp, 0C4h
		pop	edi
		pop	ebp
		retn
sub_41C84E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41D0D9(int, int, char	*)
sub_41D0D9	proc near		; CODE XREF: sub_41D231+182p

Str1		= dword	ptr -38h
Str2		= dword	ptr -34h
MaxCount	= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41D0F4
		mov	eax, 0FFFFFFFFh
		jmp	loc_41D22B
; ---------------------------------------------------------------------------

loc_41D0F4:				; CODE XREF: sub_41D0D9+Fj
		mov	[ebp+var_C], 0
		jmp	short loc_41D138
; ---------------------------------------------------------------------------

loc_41D0FD:				; CODE XREF: sub_41D0D9+6Cj
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_41D134
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41D134
		mov	eax, [ebp+var_C]
		jmp	loc_41D22B
; ---------------------------------------------------------------------------

loc_41D134:				; CODE XREF: sub_41D0D9+32j
					; sub_41D0D9+51j
		add	[ebp+var_C], 1

loc_41D138:				; CODE XREF: sub_41D0D9+22j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41D0FD
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	loc_41D213
; ---------------------------------------------------------------------------

loc_41D175:				; CODE XREF: sub_41D0D9+147j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	loc_41D20F
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[esp+38h+MaxCount], edx	; MaxCount
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_41D20F
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_41D1FB
; ---------------------------------------------------------------------------

loc_41D1BA:				; CODE XREF: sub_41D0D9+12Fj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_41D1F7
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[esp+38h+MaxCount], edx	; MaxCount
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_41D1F7
		mov	eax, 0FFFFFFFEh
		jmp	short loc_41D22B
; ---------------------------------------------------------------------------

loc_41D1F7:				; CODE XREF: sub_41D0D9+EFj
					; sub_41D0D9+115j
		add	[ebp+var_10], 1

loc_41D1FB:				; CODE XREF: sub_41D0D9+DFj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41D1BA
		mov	eax, [ebp+var_C]
		jmp	short loc_41D22B
; ---------------------------------------------------------------------------

loc_41D20F:				; CODE XREF: sub_41D0D9+AAj
					; sub_41D0D9+D4j
		add	[ebp+var_C], 1

loc_41D213:				; CODE XREF: sub_41D0D9+97j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_41D175
		mov	eax, 0FFFFFFFFh

loc_41D22B:				; CODE XREF: sub_41D0D9+16j
					; sub_41D0D9+56j ...
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_41D0D9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41D231	proc near		; CODE XREF: sub_41C84E+39p

Str		= dword	ptr -38h
Val		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+Count], 0
		mov	[esp+38h+Val], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_41C2E4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41D295
		cmp	[ebp+var_10], 0
		jz	short loc_41D295
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 10h
		test	eax, eax
		jnz	short loc_41D295
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1

loc_41D295:				; CODE XREF: sub_41D231+43j
					; sub_41D231+49j ...
		cmp	[ebp+var_10], 0
		jnz	short loc_41D2AA
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		jmp	loc_41D9C0
; ---------------------------------------------------------------------------

loc_41D2AA:				; CODE XREF: sub_41D231+68j
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+28h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_41D300
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 2
		test	eax, eax
		jz	short loc_41D300
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_41D9C0
; ---------------------------------------------------------------------------

loc_41D300:				; CODE XREF: sub_41D231+92j
					; sub_41D231+9Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_41D319
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		jmp	loc_41D9C0
; ---------------------------------------------------------------------------

loc_41D319:				; CODE XREF: sub_41D231+D7j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	loc_41D69B
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	loc_41D69B
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+var_18]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41D377
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jnz	short loc_41D377
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 1
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_41D295
; ---------------------------------------------------------------------------

loc_41D377:				; CODE XREF: sub_41D231+11Cj
					; sub_41D231+129j
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], 3Dh ; Val
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jz	short loc_41D39C
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	0

loc_41D39C:				; CODE XREF: sub_41D231+163j
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Count], eax ; char *
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_41D0D9
		mov	[ebp+var_20], eax
		cmp	[ebp+var_28], 0
		jz	short loc_41D3C7
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	3Dh

loc_41D3C7:				; CODE XREF: sub_41D231+18Ej
		cmp	[ebp+var_20], 0
		jns	short loc_41D401
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset Str1 ; "help"
		call	strcmp
		test	eax, eax
		jnz	short loc_41D401
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax
		call	sub_41DC1C
; ---------------------------------------------------------------------------
		jmp	loc_41D53C
; ---------------------------------------------------------------------------

loc_41D401:				; CODE XREF: sub_41D231+19Aj
					; sub_41D231+1B4j
		cmp	[ebp+var_20], 0
		jns	short loc_41D443
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aVersion ; "version"
		call	strcmp
		test	eax, eax
		jnz	short loc_41D443
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jnz	loc_41D53C
		call	sub_41E187
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_41D443:				; CODE XREF: sub_41D231+1D4j
					; sub_41D231+1EEj
		cmp	[ebp+var_20], 0
		jns	short loc_41D483
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aWarranty	; "warranty"
		call	strcmp
		test	eax, eax
		jnz	short loc_41D483
		mov	[esp+38h+Str], 10h
		call	sub_41E43D
		mov	[esp+38h+Str], eax ; Str
		call	puts
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_41D483:				; CODE XREF: sub_41D231+216j
					; sub_41D231+230j
		cmp	[ebp+var_20], 0
		jns	loc_41D53C
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aDumpOptions ; "dump-options"
		call	strcmp
		test	eax, eax
		jnz	loc_41D53C
		mov	[ebp+var_20], 0
		jmp	short loc_41D4F8
; ---------------------------------------------------------------------------

loc_41D4B4:				; CODE XREF: sub_41D231+2D4j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_41D4F4
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jnz	short loc_41D4F4
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, offset aS_2 ; "--%s\n"
		mov	[esp+38h+Val], edx
		mov	[esp+38h+Str], eax ; Format
		call	printf

loc_41D4F4:				; CODE XREF: sub_41D231+291j
					; sub_41D231+2A4j
		add	[ebp+var_20], 1

loc_41D4F8:				; CODE XREF: sub_41D231+281j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41D4B4
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aDumpOptionsHel ; "--dump-options\n--help\n--version\n--wa"...
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 2Bh ; Count
		mov	[esp+38h+Val], 1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_41D53C:				; CODE XREF: sub_41D231+1CBj
					; sub_41D231+1FBj ...
		cmp	[ebp+var_20], 0FFFFFFFEh
		jnz	short loc_41D54E
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF8h
		jmp	short loc_41D57D
; ---------------------------------------------------------------------------

loc_41D54E:				; CODE XREF: sub_41D231+30Fj
		cmp	[ebp+var_20], 0FFFFFFFFh
		jnz	short loc_41D56C
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFEh
		mov	eax, [ebp+var_18]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_0]
		mov	[eax+18h], edx
		jmp	short loc_41D57D
; ---------------------------------------------------------------------------

loc_41D56C:				; CODE XREF: sub_41D231+321j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx

loc_41D57D:				; CODE XREF: sub_41D231+31Bj
					; sub_41D231+339j
		cmp	[ebp+var_20], 0
		js	loc_41D68A
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jz	loc_41D66B
		cmp	[ebp+var_28], 0
		jz	short loc_41D5C0
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41D5C9
		mov	[ebp+var_1C], 0
		jmp	short loc_41D5C9
; ---------------------------------------------------------------------------

loc_41D5C0:				; CODE XREF: sub_41D231+371j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], eax

loc_41D5C9:				; CODE XREF: sub_41D231+384j
					; sub_41D231+38Dj
		cmp	[ebp+var_1C], 0
		jnz	short loc_41D5F1
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_41D5F1
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	loc_41D68A
; ---------------------------------------------------------------------------

loc_41D5F1:				; CODE XREF: sub_41D231+39Cj
					; sub_41D231+3AFj
		cmp	[ebp+var_1C], 0
		jnz	short loc_41D606
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_41D689
; ---------------------------------------------------------------------------

loc_41D606:				; CODE XREF: sub_41D231+3C4j
		cmp	[ebp+var_28], 0
		jnz	short loc_41D635
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_41D635
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_41D635
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_41D68A
; ---------------------------------------------------------------------------

loc_41D635:				; CODE XREF: sub_41D231+3D9j
					; sub_41D231+3E3j ...
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_41D9E6
		cmp	[ebp+var_28], 0
		jnz	short loc_41D689
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_41D689
; ---------------------------------------------------------------------------

loc_41D66B:				; CODE XREF: sub_41D231+367j
		cmp	[ebp+var_28], 0
		jz	short loc_41D67D
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0FFFFFFFAh
		jmp	short loc_41D68A
; ---------------------------------------------------------------------------

loc_41D67D:				; CODE XREF: sub_41D231+43Ej
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_41D68A
; ---------------------------------------------------------------------------

loc_41D689:				; CODE XREF: sub_41D231+3D0j
					; sub_41D231+42Aj ...
		nop

loc_41D68A:				; CODE XREF: sub_41D231+350j
					; sub_41D231+3BBj ...
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_41D9C0
; ---------------------------------------------------------------------------

loc_41D69B:				; CODE XREF: sub_41D231+F0j
					; sub_41D231+101j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_41D6B2
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41D6C0

loc_41D6B2:				; CODE XREF: sub_41D231+472j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	loc_41D978

loc_41D6C0:				; CODE XREF: sub_41D231+47Fj
		mov	[ebp+var_24], 0
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_41D74B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 20h
		test	eax, eax
		jz	short loc_41D74B
		mov	[ebp+var_20], 0
		jmp	short loc_41D73C
; ---------------------------------------------------------------------------

loc_41D6FD:				; CODE XREF: sub_41D231+518j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_41D738
		mov	eax, [ebp+var_18]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	[esp+38h+Val], edx ; Str2
		mov	[esp+38h+Str], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41D738
		mov	[ebp+var_24], 1
		jmp	short loc_41D74B
; ---------------------------------------------------------------------------

loc_41D738:				; CODE XREF: sub_41D231+4DAj
					; sub_41D231+4FCj
		add	[ebp+var_20], 1

loc_41D73C:				; CODE XREF: sub_41D231+4CAj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41D6FD

loc_41D74B:				; CODE XREF: sub_41D231+4A5j
					; sub_41D231+4C1j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		add	[ebp+var_18], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_41D791
		mov	[ebp+var_20], 0
		jmp	short loc_41D77F
; ---------------------------------------------------------------------------

loc_41D763:				; CODE XREF: sub_41D231+55Bj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	edx, eax
		jz	short loc_41D790
		add	[ebp+var_20], 1

loc_41D77F:				; CODE XREF: sub_41D231+530j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41D763
		jmp	short loc_41D791
; ---------------------------------------------------------------------------

loc_41D790:				; CODE XREF: sub_41D231+548j
		nop

loc_41D791:				; CODE XREF: sub_41D231+527j
					; sub_41D231+55Dj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41D7C9
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 68h
		jz	short loc_41D7B4
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Fh
		jnz	short loc_41D7C9

loc_41D7B4:				; CODE XREF: sub_41D231+577j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax
		call	sub_41DC1C
; ---------------------------------------------------------------------------

loc_41D7C9:				; CODE XREF: sub_41D231+56Dj
					; sub_41D231+581j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41D82D
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 80h
		test	eax, eax
		jz	short loc_41D805
		mov	eax, 0FFFFFFF9h
		jmp	short loc_41D80A
; ---------------------------------------------------------------------------

loc_41D805:				; CODE XREF: sub_41D231+5CBj
		mov	eax, 0FFFFFFFEh

loc_41D80A:				; CODE XREF: sub_41D231+5D2j
		mov	edx, [ebp+arg_0]
		mov	[edx+10h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		jmp	loc_41D94D
; ---------------------------------------------------------------------------

loc_41D82D:				; CODE XREF: sub_41D231+5B6j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jz	loc_41D934
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41D887
		cmp	[ebp+var_24], 0
		jnz	short loc_41D887
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_41D9E6
		jmp	loc_41D92B
; ---------------------------------------------------------------------------

loc_41D887:				; CODE XREF: sub_41D231+61Ej
					; sub_41D231+624j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_41D8B5
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_41D8B5
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_41D92B
; ---------------------------------------------------------------------------

loc_41D8B5:				; CODE XREF: sub_41D231+663j
					; sub_41D231+676j
		cmp	[ebp+var_1C], 0
		jnz	short loc_41D8C7
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	short loc_41D92B
; ---------------------------------------------------------------------------

loc_41D8C7:				; CODE XREF: sub_41D231+688j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_41D8FD
		mov	eax, [ebp+var_1C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41D8FD
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_41D8FD
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_41D92B
; ---------------------------------------------------------------------------

loc_41D8FD:				; CODE XREF: sub_41D231+69Ej
					; sub_41D231+6ABj ...
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_41D9E6
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1

loc_41D92B:				; CODE XREF: sub_41D231+651j
					; sub_41D231+682j ...
		mov	[ebp+var_18], offset asc_426EE4	; "x"
		jmp	short loc_41D94D
; ---------------------------------------------------------------------------

loc_41D934:				; CODE XREF: sub_41D231+60Dj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx

loc_41D94D:				; CODE XREF: sub_41D231+5F7j
					; sub_41D231+701j
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41D960
		cmp	[ebp+var_24], 0
		jz	short loc_41D9BF

loc_41D960:				; CODE XREF: sub_41D231+727j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_41D9BF
; ---------------------------------------------------------------------------

loc_41D978:				; CODE XREF: sub_41D231+489j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 4
		test	eax, eax
		jz	short loc_41D9B0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_41D9C0
; ---------------------------------------------------------------------------

loc_41D9B0:				; CODE XREF: sub_41D231+752j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 1
		jmp	loc_41D295
; ---------------------------------------------------------------------------

loc_41D9BF:				; CODE XREF: sub_41D231+72Dj
					; sub_41D231+745j
		nop

loc_41D9C0:				; CODE XREF: sub_41D231+74j
					; sub_41D231+CAj ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		leave
		retn
sub_41D231	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41D9E6(int, int, char	*)
sub_41D9E6	proc near		; CODE XREF: sub_41C84E+45Cp
					; sub_41D231+421p ...

Str		= dword	ptr -28h
EndPtr		= dword	ptr -24h
Radix		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_41D9FD
		mov	eax, 0
		jmp	short loc_41DA02
; ---------------------------------------------------------------------------

loc_41D9FD:				; CODE XREF: sub_41D9E6+Ej
		mov	eax, 0Ah

loc_41DA02:				; CODE XREF: sub_41D9E6+15j
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		and	edx, 7
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jz	short loc_41DA30
		cmp	eax, 4
		jz	loc_41DABD
		cmp	eax, 1
		jnz	loc_41DB62

loc_41DA30:				; CODE XREF: sub_41D9E6+36j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtol
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 80000000h
		jz	short loc_41DA6C
		cmp	[ebp+var_10], 7FFFFFFFh
		jnz	short loc_41DA8E

loc_41DA6C:				; CODE XREF: sub_41D9E6+7Bj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 22h
		jnz	short loc_41DA8E
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF4h
		mov	eax, 0FFFFFFFFh
		jmp	locret_41DB70
; ---------------------------------------------------------------------------

loc_41DA8E:				; CODE XREF: sub_41D9E6+84j
					; sub_41D9E6+92j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jnz	short loc_41DAA4
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+18h], edx
		jmp	short loc_41DAAD
; ---------------------------------------------------------------------------

loc_41DAA4:				; CODE XREF: sub_41D9E6+B1j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+18h], edx

loc_41DAAD:				; CODE XREF: sub_41D9E6+BCj
		mov	eax, 0
		jmp	locret_41DB70
; ---------------------------------------------------------------------------

loc_41DAB7:				; CODE XREF: sub_41D9E6+F7j
		add	[ebp+arg_8], 1
		jmp	short loc_41DABE
; ---------------------------------------------------------------------------

loc_41DABD:				; CODE XREF: sub_41D9E6+3Bj
		nop

loc_41DABE:				; CODE XREF: sub_41D9E6+D5j
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_41DADF
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Str], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_41DAB7

loc_41DADF:				; CODE XREF: sub_41D9E6+E0j
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_41DB04
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF4h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41DB70
; ---------------------------------------------------------------------------

loc_41DB04:				; CODE XREF: sub_41D9E6+101j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtoul
		mov	edx, [ebp+arg_0]
		mov	[edx+18h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_41DB5B
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 22h
		jnz	short loc_41DB5B
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF4h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41DB70
; ---------------------------------------------------------------------------

loc_41DB5B:				; CODE XREF: sub_41D9E6+154j
					; sub_41D9E6+162j
		mov	eax, 0
		jmp	short locret_41DB70
; ---------------------------------------------------------------------------

loc_41DB62:				; CODE XREF: sub_41D9E6+44j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[eax+18h], edx
		mov	eax, 1

locret_41DB70:				; CODE XREF: sub_41D9E6+A3j
					; sub_41D9E6+CCj ...
		leave
		retn
sub_41D9E6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41DB72	proc near		; CODE XREF: sub_41DC1C+8Ep

var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_41DC13
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_41DC13
		call	sub_41ED5B
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_41DBFE
		add	[ebp+var_C], 1
		jmp	short loc_41DBFE
; ---------------------------------------------------------------------------

loc_41DBD9:				; CODE XREF: sub_41DB72+9Fj
		cmp	[ebp+var_14], 0
		jz	short loc_41DBF8
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0C0h
		cmp	eax, 80h
		jz	short loc_41DBF8
		add	[ebp+var_C], 1

loc_41DBF8:				; CODE XREF: sub_41DB72+6Bj
					; sub_41DB72+80j
		add	[ebp+var_10], 1
		jmp	short loc_41DBFF
; ---------------------------------------------------------------------------

loc_41DBFE:				; CODE XREF: sub_41DB72+5Fj
					; sub_41DB72+65j
		nop

loc_41DBFF:				; CODE XREF: sub_41DB72+8Aj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41DC13
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_41DBD9

loc_41DC13:				; CODE XREF: sub_41DB72+34j
					; sub_41DB72+41j ...
		mov	eax, [ebp+var_C]
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
sub_41DB72	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_41DC1C	proc near		; CODE XREF: sub_41D231+1C6p
					; sub_41D231+593p

Str		= dword	ptr -38h
Size		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		call	sub_41E187
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[esp+38h+Str], 29h
		call	sub_41E43D
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	puts
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_41E084
		mov	[ebp+var_18], 0
		mov	eax, [ebp+var_18]
		mov	[ebp+var_10], eax
		jmp	short loc_41DCCA
; ---------------------------------------------------------------------------

loc_41DC6B:				; CODE XREF: sub_41DC1C+BBj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_41DCC6
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_41DC9E
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jz	short loc_41DCC6

loc_41DC9E:				; CODE XREF: sub_41DC1C+6Dj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_41DB72
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jle	short loc_41DCC6
		cmp	[ebp+var_14], 22h
		jg	short loc_41DCC6
		mov	eax, [ebp+var_14]
		mov	[ebp+var_18], eax

loc_41DCC6:				; CODE XREF: sub_41DC1C+5Dj
					; sub_41DC1C+80j ...
		add	[ebp+var_10], 1

loc_41DCCA:				; CODE XREF: sub_41DC1C+4Dj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41DC6B
		add	[ebp+var_18], 0Ah
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jz	short loc_41DCF6
		mov	[esp+38h+Str], offset aOptions ; "Options:"
		call	puts

loc_41DCF6:				; CODE XREF: sub_41DC1C+CCj
		mov	[ebp+var_10], 0
		jmp	loc_41E05B
; ---------------------------------------------------------------------------

loc_41DD02:				; CODE XREF: sub_41DC1C+44Cj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+38h+Str], eax ; char *
		call	sub_419D7C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41DD3A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jnz	short loc_41DD3A
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_41E056

loc_41DD3A:				; CODE XREF: sub_41DC1C+101j
					; sub_41DC1C+10Bj
		cmp	[ebp+var_C], 0
		jz	short loc_41DDA5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jnz	short loc_41DDA5
		add	[ebp+var_C], 1
		jmp	short loc_41DD8A
; ---------------------------------------------------------------------------

loc_41DD50:				; CODE XREF: sub_41DC1C+176j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_41DD75
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41DD86
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	short loc_41DD86
; ---------------------------------------------------------------------------

loc_41DD75:				; CODE XREF: sub_41DC1C+13Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar

loc_41DD86:				; CODE XREF: sub_41DC1C+149j
					; sub_41DC1C+157j
		add	[ebp+var_C], 1

loc_41DD8A:				; CODE XREF: sub_41DC1C+132j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41DD50
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	loc_41E057
; ---------------------------------------------------------------------------

loc_41DDA5:				; CODE XREF: sub_41DC1C+122j
					; sub_41DC1C+12Cj
		mov	[ebp+var_14], 3
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 0FFh
		jg	loc_41DE59
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, offset aC_1 ; " -%c"
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Str], eax ; Format
		call	printf
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_41DE82
		cmp	[ebp+var_C], 0
		jz	loc_41DE82
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_41DE82
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1
		jmp	short loc_41DE35
; ---------------------------------------------------------------------------

loc_41DE1C:				; CODE XREF: sub_41DC1C+22Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1

loc_41DE35:				; CODE XREF: sub_41DC1C+1FEj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41DE49
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_41DE1C

loc_41DE49:				; CODE XREF: sub_41DC1C+221j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41DE82
		add	[ebp+var_C], 1
		jmp	short loc_41DE82
; ---------------------------------------------------------------------------

loc_41DE59:				; CODE XREF: sub_41DC1C+1A0j
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset asc_426EF4 ; "   "
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 3 ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite

loc_41DE82:				; CODE XREF: sub_41DC1C+1D0j
					; sub_41DC1C+1DAj ...
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	loc_41DF85
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 0FFh
		jg	short loc_41DEBB
		mov	eax, 2Ch
		jmp	short loc_41DEC0
; ---------------------------------------------------------------------------

loc_41DEBB:				; CODE XREF: sub_41DC1C+296j
		mov	eax, 20h

loc_41DEC0:				; CODE XREF: sub_41DC1C+29Dj
		mov	edx, offset aCS	; "%c --%s"
		mov	[esp+38h+Count], ecx
		mov	[esp+38h+Size],	eax
		mov	[esp+38h+Str], edx ; Format
		call	printf
		add	[ebp+var_14], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41DF46
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_41DF46
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_41DF23
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1
		jmp	short loc_41DF23
; ---------------------------------------------------------------------------

loc_41DF08:				; CODE XREF: sub_41DC1C+31Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1
		jmp	short loc_41DF24
; ---------------------------------------------------------------------------

loc_41DF23:				; CODE XREF: sub_41DC1C+2D8j
					; sub_41DC1C+2EAj
		nop

loc_41DF24:				; CODE XREF: sub_41DC1C+305j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41DF38
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_41DF08

loc_41DF38:				; CODE XREF: sub_41DC1C+310j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41DF46
		add	[ebp+var_C], 1

loc_41DF46:				; CODE XREF: sub_41DC1C+2C0j
					; sub_41DC1C+2CAj ...
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset asc_426EF4 ; "   "
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 3 ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		add	[ebp+var_14], 3
		jmp	short loc_41DF85
; ---------------------------------------------------------------------------

loc_41DF75:				; CODE XREF: sub_41DC1C+36Fj
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_41DF85:				; CODE XREF: sub_41DC1C+274j
					; sub_41DC1C+357j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_41DF75
		cmp	[ebp+var_C], 0
		jz	loc_41E048
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_41E03D
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jle	loc_41E03D
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[ebp+var_14], 0
		jmp	short loc_41DFD6
; ---------------------------------------------------------------------------

loc_41DFC6:				; CODE XREF: sub_41DC1C+3C0j
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_41DFD6:				; CODE XREF: sub_41DC1C+3A8j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_41DFC6
		jmp	short loc_41E03D
; ---------------------------------------------------------------------------

loc_41DFE0:				; CODE XREF: sub_41DC1C+42Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_41E026
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41E037
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[ebp+var_14], 0
		jmp	short loc_41E01C
; ---------------------------------------------------------------------------

loc_41E00C:				; CODE XREF: sub_41DC1C+406j
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_41E01C:				; CODE XREF: sub_41DC1C+3EEj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_41E00C
		jmp	short loc_41E037
; ---------------------------------------------------------------------------

loc_41E026:				; CODE XREF: sub_41DC1C+3CCj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar

loc_41E037:				; CODE XREF: sub_41DC1C+3D9j
					; sub_41DC1C+408j
		add	[ebp+var_C], 1
		jmp	short loc_41E03E
; ---------------------------------------------------------------------------

loc_41E03D:				; CODE XREF: sub_41DC1C+383j
					; sub_41DC1C+38Fj ...
		nop

loc_41E03E:				; CODE XREF: sub_41DC1C+41Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41DFE0

loc_41E048:				; CODE XREF: sub_41DC1C+375j
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	short loc_41E057
; ---------------------------------------------------------------------------

loc_41E056:				; CODE XREF: sub_41DC1C+118j
		nop

loc_41E057:				; CODE XREF: sub_41DC1C+184j
					; sub_41DC1C+438j
		add	[ebp+var_10], 1

loc_41E05B:				; CODE XREF: sub_41DC1C+E1j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_41DD02
		mov	eax, [ebp+arg_4]
		and	eax, 20h
		test	eax, eax
		jz	short loc_41E084
		mov	[esp+38h+Str], offset aASingleDashMay ;	"\n(A single dash may be used instead of"...
		call	puts

loc_41E084:				; CODE XREF: sub_41DC1C+3Aj
					; sub_41DC1C+45Aj
		mov	[esp+38h+Str], 13h
		call	sub_41E43D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_41E16B
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[esp+38h+Size],	offset SubStr ;	"@EMAIL@"
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	strstr
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_41E154
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		cmp	edx, eax
		jz	short loc_41E104
		mov	eax, ds:_iob
		lea	ecx, [eax+20h]
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+File],	ecx ; File
		mov	[esp+38h+Count], 1 ; Count
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite

loc_41E104:				; CODE XREF: sub_41DC1C+4B5j
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aHttpBugs_gnupg ; "http://bugs.gnupg.org"
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 15h ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		add	[ebp+var_1C], 7
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41E16B
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Size],	edx ; File
		mov	[esp+38h+Str], eax ; Str
		call	fputs
		jmp	short loc_41E16B
; ---------------------------------------------------------------------------

loc_41E154:				; CODE XREF: sub_41DC1C+4A7j
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+38h+Size],	eax ; File
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	fputs

loc_41E16B:				; CODE XREF: sub_41DC1C+47Bj
					; sub_41DC1C+51Dj ...
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+38h+Str], eax ; File
		call	fflush
		mov	[esp+38h+Str], 0 ; Code
		call	exit
sub_41DC1C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E187	proc near		; CODE XREF: sub_41D231+201p
					; sub_41DC1C+7p

Str		= dword	ptr -28h
File		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, ds:_iob
		lea	ebx, [eax+20h]
		mov	[esp+28h+Str], 0Bh
		call	sub_41E43D
		mov	[esp+28h+File],	ebx ; File
		mov	[esp+28h+Str], eax ; Str
		call	fputs
		mov	[esp+28h+Str], 0Ch
		call	sub_41E43D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41E1D7
		mov	eax, offset aS_3 ; " (%s)"
		mov	edx, [ebp+var_10]
		mov	[esp+28h+File],	edx
		mov	[esp+28h+Str], eax ; Format
		call	printf

loc_41E1D7:				; CODE XREF: sub_41E187+3Aj
		mov	[esp+28h+Str], 0Dh
		call	sub_41E43D
		mov	edx, offset aSS_0 ; " %s %s\n"
		mov	[esp+28h+var_20], offset aGpg4win2_3_1 ; "(Gpg4win 2.3.1)"
		mov	[esp+28h+File],	eax
		mov	[esp+28h+Str], edx ; Format
		call	printf
		mov	[ebp+var_C], 14h
		jmp	short loc_41E228
; ---------------------------------------------------------------------------

loc_41E205:				; CODE XREF: sub_41E187+A5j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_41E43D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41E224
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_41E224:				; CODE XREF: sub_41E187+90j
		add	[ebp+var_C], 1

loc_41E228:				; CODE XREF: sub_41E187+7Cj
		cmp	[ebp+var_C], 1Dh
		jle	short loc_41E205
		mov	[esp+28h+Str], 0Eh
		call	sub_41E43D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41E24E
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_41E24E:				; CODE XREF: sub_41E187+BAj
		mov	[esp+28h+Str], 0Ah
		call	sub_41E43D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41E26E
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_41E26E:				; CODE XREF: sub_41E187+DAj
		mov	[esp+28h+Str], 0Fh
		call	sub_41E43D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41E29A
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_41E29A:				; CODE XREF: sub_41E187+FAj
		mov	[esp+28h+Str], 12h
		call	sub_41E43D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41E2C6
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_41E2C6:				; CODE XREF: sub_41E187+126j
		mov	[ebp+var_C], 1Eh
		jmp	short loc_41E2FE
; ---------------------------------------------------------------------------

loc_41E2CF:				; CODE XREF: sub_41E187+17Bj
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_41E43D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41E2FA
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_41E2FA:				; CODE XREF: sub_41E187+15Aj
		add	[ebp+var_C], 1

loc_41E2FE:				; CODE XREF: sub_41E187+146j
		cmp	[ebp+var_C], 27h
		jle	short loc_41E2CF
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+Str], eax ; File
		call	fflush
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_41E187	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_41E38C
		mov	dword ptr [esp], 0Eh
		call	sub_41E43D
		mov	esi, eax
		mov	dword ptr [esp], 0Dh
		call	sub_41E43D
		mov	ebx, eax
		mov	dword ptr [esp], 0Bh
		call	sub_41E43D
		mov	edx, offset aSSS ; "%s %s; %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+10h], esi
		mov	[esp+0Ch], ebx
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	[esp], ecx
		call	fprintf
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp], eax
		call	fflush
		jmp	loc_41E435
; ---------------------------------------------------------------------------

loc_41E38C:				; CODE XREF: .text:0041E327j
		cmp	dword ptr [ebp+8], 1
		jnz	short loc_41E40F
		mov	dword ptr [esp], 28h
		call	sub_41E43D
		mov	[ebp-1Ch], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+4], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	fputs
		mov	eax, [ebp-1Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41E403
		mov	eax, [ebp-1Ch]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp-1Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_41E403
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+4], eax
		mov	dword ptr [esp], 0Ah
		call	putc

loc_41E403:				; CODE XREF: .text:0041E3C0j
					; .text:0041E3E9j
		mov	dword ptr [esp], 2
		call	exit
; ---------------------------------------------------------------------------

loc_41E40F:				; CODE XREF: .text:0041E390j
		cmp	dword ptr [ebp+8], 2
		jnz	short loc_41E435
		mov	dword ptr [esp], 29h
		call	sub_41E43D
		mov	[esp], eax
		call	puts
		mov	dword ptr [esp], 0
		call	exit
; ---------------------------------------------------------------------------

loc_41E435:				; CODE XREF: .text:0041E387j
					; .text:0041E413j
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E43D	proc near		; CODE XREF: sub_41D231+239p
					; sub_41DC1C+1Fp ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_428C20
		test	eax, eax
		jz	short loc_41E45C
		mov	edx, ds:dword_428C20
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx ; dword_428C20
		jmp	short loc_41E461
; ---------------------------------------------------------------------------

loc_41E45C:				; CODE XREF: sub_41E43D+Dj
		mov	eax, 0

loc_41E461:				; CODE XREF: sub_41E43D+1Dj
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41E46F
		mov	eax, [ebp+var_C]
		jmp	short locret_41E4C4
; ---------------------------------------------------------------------------

loc_41E46F:				; CODE XREF: sub_41E43D+2Bj
		mov	eax, [ebp+arg_0]
		sub	eax, 0Ah	; switch 32 cases
		cmp	eax, 1Fh
		ja	short loc_41E4C1 ; jumptable 0041E481 default case
		mov	eax, ds:off_4272E0[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41E483:				; CODE XREF: sub_41E43D+44j
					; DATA XREF: .rdata:off_4272E0o
		mov	[ebp+var_C], offset aLicenseGplv3Gn ; jumptable	0041E481 case 10
		jmp	short loc_41E4C1 ; jumptable 0041E481 default case
; ---------------------------------------------------------------------------

loc_41E48C:				; CODE XREF: sub_41E43D+44j
					; DATA XREF: .rdata:off_4272E0o
		mov	[ebp+var_C], offset aFoo ; jumptable 0041E481 case 11
		jmp	short loc_41E4C1 ; jumptable 0041E481 default case
; ---------------------------------------------------------------------------

loc_41E495:				; CODE XREF: sub_41E43D+44j
					; DATA XREF: .rdata:off_4272E0o
		mov	[ebp+var_C], offset a0_0_0 ; jumptable 0041E481	case 13
		jmp	short loc_41E4C1 ; jumptable 0041E481 default case
; ---------------------------------------------------------------------------

loc_41E49E:				; CODE XREF: sub_41E43D+44j
					; DATA XREF: .rdata:off_4272E0o
		mov	[ebp+var_C], offset aCopyrightC2015 ; jumptable	0041E481 case 14
		jmp	short loc_41E4C1 ; jumptable 0041E481 default case
; ---------------------------------------------------------------------------

loc_41E4A7:				; CODE XREF: sub_41E43D+44j
					; DATA XREF: .rdata:off_4272E0o
		mov	[ebp+var_C], offset aThisIsFreeSoft ; jumptable	0041E481 case 15
		jmp	short loc_41E4C1 ; jumptable 0041E481 default case
; ---------------------------------------------------------------------------

loc_41E4B0:				; CODE XREF: sub_41E43D+44j
					; DATA XREF: .rdata:off_4272E0o
		mov	[ebp+var_C], offset aThisIsFreeSo_0 ; jumptable	0041E481 case 16
		jmp	short loc_41E4C1 ; jumptable 0041E481 default case
; ---------------------------------------------------------------------------

loc_41E4B9:				; CODE XREF: sub_41E43D+44j
					; DATA XREF: .rdata:off_4272E0o
		mov	[ebp+var_C], offset dword_4272DC ; jumptable 0041E481 cases 40,41
		nop

loc_41E4C1:				; CODE XREF: sub_41E43D+3Bj
					; sub_41E43D+44j ...
		mov	eax, [ebp+var_C] ; jumptable 0041E481 default case

locret_41E4C4:				; CODE XREF: sub_41E43D+30j
		leave
		retn
sub_41E43D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E4C6	proc near		; CODE XREF: sub_40377D+4Cp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ds:dword_428C20, eax
		pop	ebp
		retn
sub_41E4C6	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E4D4	proc near		; CODE XREF: sub_41E62E+14p

var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 10h
		cmp	[ebp+arg_0], 0
		jnz	short loc_41E4EE
		mov	[ebp+var_C], 80000001h
		jmp	loc_41E624
; ---------------------------------------------------------------------------

loc_41E4EE:				; CODE XREF: sub_41E4D4+Cj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_classes_r ; "HKEY_CLASSES_ROOT"
		mov	ecx, 12h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_41E522
		mov	[ebp+var_C], 80000000h
		jmp	loc_41E624
; ---------------------------------------------------------------------------

loc_41E522:				; CODE XREF: sub_41E4D4+40j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_current_u ; "HKEY_CURRENT_USER"
		mov	ecx, 12h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_41E556
		mov	[ebp+var_C], 80000001h
		jmp	loc_41E624
; ---------------------------------------------------------------------------

loc_41E556:				; CODE XREF: sub_41E4D4+74j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_local_mac ; "HKEY_LOCAL_MACHINE"
		mov	ecx, 13h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_41E58A
		mov	[ebp+var_C], 80000002h
		jmp	loc_41E624
; ---------------------------------------------------------------------------

loc_41E58A:				; CODE XREF: sub_41E4D4+A8j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_users	; "HKEY_USERS"
		mov	ecx, 0Bh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_41E5BB
		mov	[ebp+var_C], 80000003h
		jmp	short loc_41E624
; ---------------------------------------------------------------------------

loc_41E5BB:				; CODE XREF: sub_41E4D4+DCj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_performan ; "HKEY_PERFORMANCE_DATA"
		mov	ecx, 16h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_41E5EC
		mov	[ebp+var_C], 80000004h
		jmp	short loc_41E624
; ---------------------------------------------------------------------------

loc_41E5EC:				; CODE XREF: sub_41E4D4+10Dj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_current_c ; "HKEY_CURRENT_CONFIG"
		mov	ecx, 14h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_41E61D
		mov	[ebp+var_C], 80000005h
		jmp	short loc_41E624
; ---------------------------------------------------------------------------

loc_41E61D:				; CODE XREF: sub_41E4D4+13Ej
		mov	eax, 0
		jmp	short loc_41E627
; ---------------------------------------------------------------------------

loc_41E624:				; CODE XREF: sub_41E4D4+15j
					; sub_41E4D4+49j ...
		mov	eax, [ebp+var_C]

loc_41E627:				; CODE XREF: sub_41E4D4+14Ej
		add	esp, 10h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_41E4D4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41E62E(int, LPCSTR, LPCSTR lpValueName)
sub_41E62E	proc near		; CODE XREF: sub_409C1D+71p

hKey		= dword	ptr -58h
lpSubKey	= dword	ptr -54h
ulOptions	= dword	ptr -50h
samDesired	= dword	ptr -4Ch
phkResult	= dword	ptr -48h
lpcbData	= dword	ptr -44h
var_2C		= dword	ptr -2Ch
Type		= dword	ptr -24h
cbData		= dword	ptr -20h
nSize		= dword	ptr -1Ch
var_18		= dword	ptr -18h
lpDst		= dword	ptr -14h
var_10		= dword	ptr -10h
lpData		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
lpValueName	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	[ebp+lpData], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+hKey],	eax
		call	sub_41E4D4
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41E65A
		mov	eax, 0
		jmp	loc_41E94A
; ---------------------------------------------------------------------------

loc_41E65A:				; CODE XREF: sub_41E62E+20j
		lea	eax, [ebp+var_18]
		mov	[esp+58h+phkResult], eax ; phkResult
		mov	[esp+58h+samDesired], 20019h ; samDesired
		mov	[esp+58h+ulOptions], 0 ; ulOptions
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+lpSubKey], eax	; lpSubKey
		mov	eax, [ebp+var_10]
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegOpenKeyExA
		call	eax ; RegOpenKeyExA
		sub	esp, 14h
		test	eax, eax
		jz	short loc_41E6D9
		cmp	[ebp+arg_0], 0
		jz	short loc_41E69C
		mov	eax, 0
		jmp	loc_41E94A
; ---------------------------------------------------------------------------

loc_41E69C:				; CODE XREF: sub_41E62E+62j
		lea	eax, [ebp+var_18]
		mov	[esp+58h+phkResult], eax ; phkResult
		mov	[esp+58h+samDesired], 20019h ; samDesired
		mov	[esp+58h+ulOptions], 0 ; ulOptions
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+lpSubKey], eax	; lpSubKey
		mov	[esp+58h+hKey],	80000002h ; hKey
		mov	eax, ds:RegOpenKeyExA
		call	eax ; RegOpenKeyExA
		sub	esp, 14h
		test	eax, eax
		jz	short loc_41E6D9
		mov	eax, 0
		jmp	loc_41E94A
; ---------------------------------------------------------------------------

loc_41E6D9:				; CODE XREF: sub_41E62E+5Cj
					; sub_41E62E+9Fj
		mov	[ebp+cbData], 1
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+cbData]
		mov	[esp+58h+lpcbData], edx	; lpcbData
		mov	[esp+58h+phkResult], 0 ; lpData
		mov	[esp+58h+samDesired], 0	; lpType
		mov	[esp+58h+ulOptions], 0 ; lpReserved
		mov	edx, [ebp+lpValueName]
		mov	[esp+58h+lpSubKey], edx	; lpValueName
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegQueryValueExA
		call	eax ; RegQueryValueExA
		sub	esp, 18h
		test	eax, eax
		jnz	loc_41E92D
		mov	eax, [ebp+cbData]
		add	eax, 1
		mov	[ebp+nSize], eax
		mov	eax, [ebp+nSize]
		mov	[esp+58h+hKey],	eax ; size_t
		call	sub_406CDA
		mov	[ebp+lpData], eax
		cmp	[ebp+lpData], 0
		jz	loc_41E930
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+nSize]
		mov	[esp+58h+lpcbData], edx	; lpcbData
		mov	edx, [ebp+lpData]
		mov	[esp+58h+phkResult], edx ; lpData
		lea	edx, [ebp+Type]
		mov	[esp+58h+samDesired], edx ; lpType
		mov	[esp+58h+ulOptions], 0 ; lpReserved
		mov	edx, [ebp+lpValueName]
		mov	[esp+58h+lpSubKey], edx	; lpValueName
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegQueryValueExA
		call	eax ; RegQueryValueExA
		sub	esp, 18h
		test	eax, eax
		jz	short loc_41E78E
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; void *
		call	sub_406E5D
		mov	[ebp+lpData], 0
		jmp	loc_41E937
; ---------------------------------------------------------------------------

loc_41E78E:				; CODE XREF: sub_41E62E+147j
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpData]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+Type]
		cmp	eax, 2
		jnz	loc_41E937
		mov	[esp+58h+lpSubKey], 25h	; Val
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; Str
		call	strchr
		test	eax, eax
		jz	loc_41E937
		mov	eax, [ebp+nSize]
		add	eax, 3E8h
		mov	[ebp+nSize], eax
		mov	eax, [ebp+nSize]
		add	eax, 1
		mov	[esp+58h+hKey],	eax ; size_t
		call	sub_406CDA
		mov	[ebp+lpDst], eax
		cmp	[ebp+lpDst], 0
		jz	loc_41E933
		mov	eax, [ebp+nSize]
		mov	[esp+58h+ulOptions], eax ; nSize
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; lpDst
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; lpSrc
		mov	eax, ds:ExpandEnvironmentStringsA
		call	eax ; ExpandEnvironmentStringsA
		sub	esp, 0Ch
		mov	[ebp+cbData], eax
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	loc_41E8AB
		mov	edx, [ebp+cbData]
		mov	eax, [ebp+nSize]
		cmp	edx, eax
		jbe	loc_41E8AB
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax ; void *
		call	sub_406E5D
		mov	eax, [ebp+cbData]
		mov	[ebp+nSize], eax
		mov	eax, [ebp+nSize]
		add	eax, 1
		mov	[esp+58h+hKey],	eax ; size_t
		call	sub_406CDA
		mov	[ebp+lpDst], eax
		cmp	[ebp+lpDst], 0
		jz	loc_41E936
		mov	eax, [ebp+nSize]
		mov	[esp+58h+ulOptions], eax ; nSize
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; lpDst
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; lpSrc
		mov	eax, ds:ExpandEnvironmentStringsA
		call	eax ; ExpandEnvironmentStringsA
		sub	esp, 0Ch
		mov	[ebp+cbData], eax
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	short loc_41E88C
		mov	edx, [ebp+cbData]
		mov	eax, [ebp+nSize]
		cmp	edx, eax
		jbe	short loc_41E88C
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax ; void *
		call	sub_406E5D
		jmp	loc_41E937
; ---------------------------------------------------------------------------

loc_41E88C:				; CODE XREF: sub_41E62E+242j
					; sub_41E62E+24Cj
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpDst]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; void *
		call	sub_406E5D
		mov	eax, [ebp+lpDst]
		mov	[ebp+lpData], eax
		jmp	loc_41E937
; ---------------------------------------------------------------------------

loc_41E8AB:				; CODE XREF: sub_41E62E+1DCj
					; sub_41E62E+1EAj
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	short loc_41E920
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpDst]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; void *
		call	sub_406E5D
		mov	eax, [ebp+lpDst]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+58h+hKey],	eax ; size_t
		call	sub_406CDA
		mov	[ebp+lpData], eax
		cmp	[ebp+lpData], 0
		jnz	short loc_41E901
		mov	eax, [ebp+lpDst]
		mov	[ebp+lpData], eax
		jmp	short loc_41E937
; ---------------------------------------------------------------------------

loc_41E901:				; CODE XREF: sub_41E62E+2C9j
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; Source
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax ; void *
		call	sub_406E5D
		jmp	short loc_41E937
; ---------------------------------------------------------------------------

loc_41E920:				; CODE XREF: sub_41E62E+282j
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax ; void *
		call	sub_406E5D
		jmp	short loc_41E937
; ---------------------------------------------------------------------------

loc_41E92D:				; CODE XREF: sub_41E62E+EAj
		nop
		jmp	short loc_41E937
; ---------------------------------------------------------------------------

loc_41E930:				; CODE XREF: sub_41E62E+10Bj
		nop
		jmp	short loc_41E937
; ---------------------------------------------------------------------------

loc_41E933:				; CODE XREF: sub_41E62E+1B0j
		nop
		jmp	short loc_41E937
; ---------------------------------------------------------------------------

loc_41E936:				; CODE XREF: sub_41E62E+216j
		nop

loc_41E937:				; CODE XREF: sub_41E62E+15Bj
					; sub_41E62E+16Fj ...
		mov	eax, [ebp+var_18]
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegCloseKey
		call	eax ; RegCloseKey
		sub	esp, 4
		mov	eax, [ebp+lpData]

loc_41E94A:				; CODE XREF: sub_41E62E+27j
					; sub_41E62E+69j ...
		mov	edi, [ebp+var_4]
		leave
		retn
sub_41E62E	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E950	proc near		; CODE XREF: sub_41EA4F+27Bp
					; sub_41EA4F+2C4p ...

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_41E9E5
		cmp	[ebp+arg_0], 0
		jz	short loc_41E9A9
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aUtf8 ; "utf-8"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_41E9A9
		mov	eax, ds:dword_428C54
		mov	[ebp+var_1C], eax
		mov	ds:dword_428C54, 1
		jmp	short loc_41E9BB
; ---------------------------------------------------------------------------

loc_41E9A9:				; CODE XREF: sub_41E950+1Bj
					; sub_41E950+43j
		mov	eax, ds:dword_428C58
		mov	[ebp+var_1C], eax
		mov	ds:dword_428C58, 1

loc_41E9BB:				; CODE XREF: sub_41E950+57j
		cmp	[ebp+var_1C], 0
		jnz	short loc_41EA23
		mov	[esp+38h+var_38], offset aConversionFrom ; "conversion from `%s' to `%s' not availa"...
		call	sub_419D7C
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+var_30], edx
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], edx	; char
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_41A63B
		jmp	short loc_41EA23
; ---------------------------------------------------------------------------

loc_41E9E5:				; CODE XREF: sub_41E950+15j
		mov	eax, ds:dword_428C5C
		test	eax, eax
		jnz	short loc_41EA19
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+38h+var_38], eax ;	int
		call	strerror
		mov	ebx, eax
		mov	[esp+38h+var_38], offset aIconv_openFail ; "iconv_open failed: %s\n"
		call	sub_419D7C
		mov	dword ptr [esp+38h+var_34], ebx	; char
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_41A63B

loc_41EA19:				; CODE XREF: sub_41E950+9Cj
		mov	ds:dword_428C5C, 1

loc_41EA23:				; CODE XREF: sub_41E950+6Fj
					; sub_41E950+93j
		cmp	[ebp+arg_8], 0
		jz	short loc_41EA47
		mov	off_422174, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_428C24, 0
		mov	ds:dword_428C28, 0

loc_41EA47:				; CODE XREF: sub_41E950+D7j
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_41E950	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41EA4F	proc near		; CODE XREF: sub_40AD6C+10p

Dest		= dword	ptr -38h
Format		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Str2		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	[ebp+arg_0], 0
		jnz	loc_41EB59
		mov	eax, ds:GetConsoleOutputCP
		call	eax ; GetConsoleOutputCP
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41EA7A
		mov	eax, ds:GetACP
		call	eax ; GetACP
		mov	[ebp+var_C], eax

loc_41EA7A:				; CODE XREF: sub_41EA4F+1Fj
		mov	eax, offset aCpU ; "CP%u"
		mov	edx, [ebp+var_C]
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Format], eax ;	Format
		mov	[esp+38h+Dest],	offset byte_428C34 ; Dest
		call	sprintf
		mov	[ebp+arg_0], offset byte_428C34
		mov	[ebp+Str2], offset aCp936 ; "CP936"
		jmp	loc_41EB4B
; ---------------------------------------------------------------------------

loc_41EAA9:				; CODE XREF: sub_41EA4F+104j
		mov	eax, [ebp+Str2]
		mov	[esp+38h+Format], eax ;	Str2
		mov	[esp+38h+Dest],	offset byte_428C34 ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_41EAD7
		mov	eax, [ebp+Str2]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	short loc_41EB01
		mov	eax, [ebp+Str2]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41EB01

loc_41EAD7:				; CODE XREF: sub_41EA4F+6Fj
		mov	eax, [ebp+Str2]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	eax, [ebp+Str2]
		mov	[ebp+arg_0], eax
		jmp	short loc_41EB59
; ---------------------------------------------------------------------------

loc_41EB01:				; CODE XREF: sub_41EA4F+79j
					; sub_41EA4F+86j
		mov	eax, [ebp+Str2]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp+Str2], eax
		mov	eax, [ebp+Str2]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp+Str2], eax

loc_41EB4B:				; CODE XREF: sub_41EA4F+55j
		mov	eax, [ebp+Str2]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_41EAA9

loc_41EB59:				; CODE XREF: sub_41EA4F+Bj
					; sub_41EA4F+B0j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 3
		jbe	short loc_41EBBE
		mov	[esp+38h+var_30], 3
		mov	[esp+38h+Format], offset aIso ;	"iso"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_41BBA3
		test	eax, eax
		jnz	short loc_41EBBE
		add	[ebp+arg_0], 3
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jz	short loc_41EBBA
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Fh
		jnz	short loc_41EBBE

loc_41EBBA:				; CODE XREF: sub_41EA4F+15Fj
		add	[ebp+arg_0], 1

loc_41EBBE:				; CODE XREF: sub_41EA4F+132j
					; sub_41EA4F+151j ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41EC24
		mov	[esp+38h+Format], offset a88591	; "8859-1"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_41BA69
		test	eax, eax
		jz	short loc_41EC24
		mov	[esp+38h+Format], offset a646 ;	"646"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_41BA69
		test	eax, eax
		jz	short loc_41EC24
		mov	[esp+38h+Format], offset aAscii	; "ASCII"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_41BA69
		test	eax, eax
		jz	short loc_41EC24
		mov	[esp+38h+Format], offset aAnsi_x3_41968	; "ANSI_X3.4-1968"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_41BA69
		test	eax, eax
		jnz	short loc_41EC47

loc_41EC24:				; CODE XREF: sub_41EA4F+177j
					; sub_41EA4F+18Ej ...
		mov	off_422174, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_428C24, 0
		mov	ds:dword_428C28, 0
		jmp	loc_41ED46
; ---------------------------------------------------------------------------

loc_41EC47:				; CODE XREF: sub_41EA4F+1D3j
		mov	[esp+38h+Format], offset aUtf8_0 ; "utf8"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_41BA69
		test	eax, eax
		jz	short loc_41EC75
		mov	[esp+38h+Format], offset aUtf8 ; "utf-8"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_41BA69
		test	eax, eax
		jnz	short loc_41EC98

loc_41EC75:				; CODE XREF: sub_41EA4F+20Dj
		mov	off_422174, offset aUtf8 ; "utf-8"
		mov	ds:dword_428C24, 1
		mov	ds:dword_428C28, 0
		jmp	loc_41ED46
; ---------------------------------------------------------------------------

loc_41EC98:				; CODE XREF: sub_41EA4F+224j
		mov	[esp+38h+Format], offset aUtf8 ; "utf-8"
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Dest],	eax
		call	libiconv_open
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_41ECD6
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+Format], offset aUtf8 ; "utf-8"
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Dest],	eax
		call	sub_41E950
		mov	eax, 0FFFFFFFFh
		jmp	short loc_41ED4B
; ---------------------------------------------------------------------------

loc_41ECD6:				; CODE XREF: sub_41EA4F+263j
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dest],	eax
		call	libiconv_close
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Format], eax
		mov	[esp+38h+Dest],	offset aUtf8 ; "utf-8"
		call	libiconv_open
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_41ED1F
		mov	[esp+38h+var_30], 0
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Format], eax
		mov	[esp+38h+Dest],	offset aUtf8 ; "utf-8"
		call	sub_41E950
		mov	eax, 0FFFFFFFFh
		jmp	short loc_41ED4B
; ---------------------------------------------------------------------------

loc_41ED1F:				; CODE XREF: sub_41EA4F+2ACj
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dest],	eax
		call	libiconv_close
		mov	eax, [ebp+var_14]
		mov	off_422174, eax
		mov	ds:dword_428C24, 0
		mov	ds:dword_428C28, 1

loc_41ED46:				; CODE XREF: sub_41EA4F+1F3j
					; sub_41EA4F+244j
		mov	eax, 0

loc_41ED4B:				; CODE XREF: sub_41EA4F+285j
					; sub_41EA4F+2CEj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_41EA4F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, off_422174
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41ED5B	proc near		; CODE XREF: sub_41DB72+43p
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_428C24
		pop	ebp
		retn
sub_41ED5B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41ED65(char *)
sub_41ED65	proc near		; CODE XREF: sub_41ED65+129p

Dest		= dword	ptr -78h
Source		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_4C		= dword	ptr -4Ch
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_28], 0
		mov	eax, ds:dword_428C24
		test	eax, eax
		jz	short loc_41ED97
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Dest],	eax ; char *
		call	sub_406E03
		mov	[ebp+var_20], eax
		jmp	loc_41EFA6
; ---------------------------------------------------------------------------

loc_41ED97:				; CODE XREF: sub_41ED65+1Dj
		mov	eax, ds:dword_428C28
		test	eax, eax
		jnz	loc_41EE4D
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_41EDC2
; ---------------------------------------------------------------------------

loc_41EDAC:				; CODE XREF: sub_41ED65+65j
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_41EDBE
		add	[ebp+var_28], 1

loc_41EDBE:				; CODE XREF: sub_41ED65+53j
		add	[ebp+var_1C], 1

loc_41EDC2:				; CODE XREF: sub_41ED65+45j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41EDAC
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[esp+78h+Dest],	eax ; size_t
		call	sub_406D00
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_41EE38
; ---------------------------------------------------------------------------

loc_41EDEB:				; CODE XREF: sub_41ED65+DBj
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_41EE25
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		shr	al, 6
		or	eax, 0FFFFFFC0h
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		and	eax, 3Fh
		or	eax, 0FFFFFF80h
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_41EE34
; ---------------------------------------------------------------------------

loc_41EE25:				; CODE XREF: sub_41ED65+8Ej
		mov	eax, [ebp+var_1C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_41EE34:				; CODE XREF: sub_41ED65+BEj
		add	[ebp+var_1C], 1

loc_41EE38:				; CODE XREF: sub_41ED65+84j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41EDEB
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		jmp	loc_41EFA6
; ---------------------------------------------------------------------------

loc_41EE4D:				; CODE XREF: sub_41ED65+39j
		mov	eax, off_422174
		mov	[esp+78h+Source], eax
		mov	[esp+78h+Dest],	offset aUtf8 ; "utf-8"
		call	libiconv_open
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0FFFFFFFFh
		jnz	short loc_41EE98
		mov	eax, off_422174
		mov	[esp+78h+var_70], 1
		mov	[esp+78h+Source], eax
		mov	[esp+78h+Dest],	offset aUtf8 ; "utf-8"
		call	sub_41E950
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Dest],	eax ; char *
		call	sub_41ED65
		jmp	loc_41EFA9
; ---------------------------------------------------------------------------

loc_41EE98:				; CODE XREF: sub_41ED65+104j
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_41EEB6
; ---------------------------------------------------------------------------

loc_41EEA0:				; CODE XREF: sub_41ED65+159j
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_41EEB2
		add	[ebp+var_28], 5

loc_41EEB2:				; CODE XREF: sub_41ED65+147j
		add	[ebp+var_1C], 1

loc_41EEB6:				; CODE XREF: sub_41ED65+139j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41EEA0
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[esp+78h+Dest],	eax ; size_t
		call	sub_406D00
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_40], eax
		lea	eax, [ebp+var_40]
		mov	[esp+78h+var_68], eax
		lea	eax, [ebp+var_38]
		mov	[esp+78h+var_6C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+78h+var_70], eax
		lea	eax, [ebp+var_34]
		mov	[esp+78h+Source], eax
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Dest],	eax
		call	libiconv
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_41EF95
		mov	eax, ds:dword_428C30
		test	eax, eax
		jnz	short loc_41EF77
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+78h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	esi, off_422174
		mov	[esp+78h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_419D7C
		mov	[esp+78h+var_6C], ebx
		mov	[esp+78h+var_70], offset aUtf8 ; "utf-8"
		mov	[esp+78h+Source], esi ;	char
		mov	[esp+78h+Dest],	eax ; char *
		call	sub_41A63B

loc_41EF77:				; CODE XREF: sub_41ED65+1D3j
		mov	ds:dword_428C30, 1
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Source], eax ;	Source
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Dest],	eax ; Dest
		call	strcpy
		jmp	short loc_41EF9B
; ---------------------------------------------------------------------------

loc_41EF95:				; CODE XREF: sub_41ED65+1CAj
		mov	eax, [ebp+var_38]
		mov	byte ptr [eax],	0

loc_41EF9B:				; CODE XREF: sub_41ED65+22Ej
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Dest],	eax
		call	libiconv_close

loc_41EFA6:				; CODE XREF: sub_41ED65+2Dj
					; sub_41ED65+E3j
		mov	eax, [ebp+var_20]

loc_41EFA9:				; CODE XREF: sub_41ED65+12Ej
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_41ED65	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41EFB1	proc near		; CODE XREF: sub_41EFB1+797p
					; sub_41F783+23p

Dest		= dword	ptr -88h
Format		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		add	esp, 0FFFFFF80h
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 0
		mov	[ebp+var_30], 0

loc_41EFD5:				; CODE XREF: sub_41EFB1+5EDj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_14]
		mov	[ebp+var_C], eax
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		jmp	loc_41F577
; ---------------------------------------------------------------------------

loc_41EFFA:				; CODE XREF: sub_41EFB1+5CAj
		cmp	[ebp+var_30], 0
		jz	short loc_41F059
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_41F052
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	short loc_41F01E
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FDh
		jbe	short loc_41F052

loc_41F01E:				; CODE XREF: sub_41EFB1+61j
		cmp	[ebp+var_24], 0
		jz	short loc_41F049
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_2 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_41F049:				; CODE XREF: sub_41EFB1+71j
		add	[ebp+var_1C], 4
		jmp	loc_41F56F
; ---------------------------------------------------------------------------

loc_41F052:				; CODE XREF: sub_41EFB1+57j
					; sub_41EFB1+6Bj
		mov	[ebp+var_30], 0

loc_41F059:				; CODE XREF: sub_41EFB1+4Dj
		cmp	[ebp+var_C], 0
		jnz	loc_41F38C
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	loc_41F1E4
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jz	loc_41F1C4
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_41F0B5
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_41F0B5
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_8]
		jz	short loc_41F0B5
		cmp	[ebp+arg_8], 0
		jz	loc_41F1C4
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_41F1C4

loc_41F0B5:				; CODE XREF: sub_41EFB1+D2j
					; sub_41EFB1+DCj ...
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_41F0C9
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_24], 1

loc_41F0C9:				; CODE XREF: sub_41EFB1+10Cj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, 0Dh	; switch 14 cases
		ja	loc_41F17A	; jumptable 0041F0E2 default case
		mov	eax, ds:off_4275C4[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41F0E4:				; CODE XREF: sub_41EFB1+131j
					; DATA XREF: .rdata:off_4275C4o
		add	[ebp+var_1C], 1	; jumptable 0041F0E2 case 10
		cmp	[ebp+var_24], 0
		jz	loc_41F1AB
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	6Eh
		add	[ebp+var_24], 1
		jmp	loc_41F1AB
; ---------------------------------------------------------------------------

loc_41F101:				; CODE XREF: sub_41EFB1+131j
					; DATA XREF: .rdata:off_4275C4o
		add	[ebp+var_1C], 1	; jumptable 0041F0E2 case 13
		cmp	[ebp+var_24], 0
		jz	loc_41F1AE
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	72h
		add	[ebp+var_24], 1
		jmp	loc_41F1AE
; ---------------------------------------------------------------------------

loc_41F11E:				; CODE XREF: sub_41EFB1+131j
					; DATA XREF: .rdata:off_4275C4o
		add	[ebp+var_1C], 1	; jumptable 0041F0E2 case 12
		cmp	[ebp+var_24], 0
		jz	loc_41F1B1
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	66h
		add	[ebp+var_24], 1
		jmp	short loc_41F1B1
; ---------------------------------------------------------------------------

loc_41F138:				; CODE XREF: sub_41EFB1+131j
					; DATA XREF: .rdata:off_4275C4o
		add	[ebp+var_1C], 1	; jumptable 0041F0E2 case 11
		cmp	[ebp+var_24], 0
		jz	short loc_41F1B4
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	76h
		add	[ebp+var_24], 1
		jmp	short loc_41F1B4
; ---------------------------------------------------------------------------

loc_41F14E:				; CODE XREF: sub_41EFB1+131j
					; DATA XREF: .rdata:off_4275C4o
		add	[ebp+var_1C], 1	; jumptable 0041F0E2 case 8
		cmp	[ebp+var_24], 0
		jz	short loc_41F1B7
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	62h
		add	[ebp+var_24], 1
		jmp	short loc_41F1B7
; ---------------------------------------------------------------------------

loc_41F164:				; CODE XREF: sub_41EFB1+131j
					; DATA XREF: .rdata:off_4275C4o
		add	[ebp+var_1C], 1	; jumptable 0041F0E2 case 0
		cmp	[ebp+var_24], 0
		jz	short loc_41F1BA
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	30h
		add	[ebp+var_24], 1
		jmp	short loc_41F1BA
; ---------------------------------------------------------------------------

loc_41F17A:				; CODE XREF: sub_41EFB1+124j
					; sub_41EFB1+131j
					; DATA XREF: ...
		add	[ebp+var_1C], 3	; jumptable 0041F0E2 default case
		cmp	[ebp+var_24], 0
		jz	short loc_41F1BD
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_3 ; "x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 3
		jmp	short loc_41F1BD
; ---------------------------------------------------------------------------

loc_41F1AB:				; CODE XREF: sub_41EFB1+13Bj
					; sub_41EFB1+14Bj
		nop
		jmp	short loc_41F1BE
; ---------------------------------------------------------------------------

loc_41F1AE:				; CODE XREF: sub_41EFB1+158j
					; sub_41EFB1+168j
		nop
		jmp	short loc_41F1BE
; ---------------------------------------------------------------------------

loc_41F1B1:				; CODE XREF: sub_41EFB1+175j
					; sub_41EFB1+185j
		nop
		jmp	short loc_41F1BE
; ---------------------------------------------------------------------------

loc_41F1B4:				; CODE XREF: sub_41EFB1+18Fj
					; sub_41EFB1+19Bj
		nop
		jmp	short loc_41F1BE
; ---------------------------------------------------------------------------

loc_41F1B7:				; CODE XREF: sub_41EFB1+1A5j
					; sub_41EFB1+1B1j
		nop
		jmp	short loc_41F1BE
; ---------------------------------------------------------------------------

loc_41F1BA:				; CODE XREF: sub_41EFB1+1BBj
					; sub_41EFB1+1C7j
		nop
		jmp	short loc_41F1BE
; ---------------------------------------------------------------------------

loc_41F1BD:				; CODE XREF: sub_41EFB1+1D1j
					; sub_41EFB1+1F8j
		nop

loc_41F1BE:				; CODE XREF: sub_41EFB1+1FBj
					; sub_41EFB1+1FEj ...
		nop
		jmp	loc_41F56F
; ---------------------------------------------------------------------------

loc_41F1C4:				; CODE XREF: sub_41EFB1+C4j
					; sub_41EFB1+F0j ...
		cmp	[ebp+var_24], 0
		jz	short loc_41F1DB
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_41F1DB:				; CODE XREF: sub_41EFB1+217j
		add	[ebp+var_1C], 1
		jmp	loc_41F56F
; ---------------------------------------------------------------------------

loc_41F1E4:				; CODE XREF: sub_41EFB1+BAj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0E0h
		cmp	eax, 0C0h
		jnz	short loc_41F22D
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 1
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_41F56F
; ---------------------------------------------------------------------------

loc_41F22D:				; CODE XREF: sub_41EFB1+246j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F0h
		cmp	eax, 0E0h
		jnz	short loc_41F276
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 2
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_41F56F
; ---------------------------------------------------------------------------

loc_41F276:				; CODE XREF: sub_41EFB1+28Fj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F8h
		cmp	eax, 0F0h
		jnz	short loc_41F2BF
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 7
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 3
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_41F56F
; ---------------------------------------------------------------------------

loc_41F2BF:				; CODE XREF: sub_41EFB1+2D8j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FCh
		cmp	eax, 0F8h
		jnz	short loc_41F308
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 4
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_41F56F
; ---------------------------------------------------------------------------

loc_41F308:				; CODE XREF: sub_41EFB1+321j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FEh
		cmp	eax, 0FCh
		jnz	short loc_41F351
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 5
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_41F56F
; ---------------------------------------------------------------------------

loc_41F351:				; CODE XREF: sub_41EFB1+36Aj
		cmp	[ebp+var_24], 0
		jz	short loc_41F37C
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_2 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_41F37C:				; CODE XREF: sub_41EFB1+3A4j
		add	[ebp+var_1C], 4
		mov	[ebp+var_30], 1
		jmp	loc_41F56F
; ---------------------------------------------------------------------------

loc_41F38C:				; CODE XREF: sub_41EFB1+ACj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_41F3A4
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	loc_41F432

loc_41F3A4:				; CODE XREF: sub_41EFB1+3E3j
		cmp	[ebp+var_24], 0
		jz	short loc_41F40C
		mov	[ebp+var_10], 0
		jmp	short loc_41F3DF
; ---------------------------------------------------------------------------

loc_41F3B3:				; CODE XREF: sub_41EFB1+434j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_2 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_41F3DF:				; CODE XREF: sub_41EFB1+400j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_41F3B3
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_2 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_41F40C:				; CODE XREF: sub_41EFB1+3F7j
		mov	eax, [ebp+var_14]
		add	eax, 1
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_30], 1
		jmp	loc_41F56F
; ---------------------------------------------------------------------------

loc_41F432:				; CODE XREF: sub_41EFB1+3EDj
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		shl	[ebp+var_28], 6
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3Fh
		or	[ebp+var_28], eax
		sub	[ebp+var_C], 1
		cmp	[ebp+var_C], 0
		jnz	loc_41F56F
		mov	eax, ds:dword_428C24
		test	eax, eax
		jz	short loc_41F4AF
		cmp	[ebp+var_24], 0
		jz	short loc_41F49D
		mov	[ebp+var_10], 0
		jmp	short loc_41F495
; ---------------------------------------------------------------------------

loc_41F47D:				; CODE XREF: sub_41EFB1+4EAj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_41F495:				; CODE XREF: sub_41EFB1+4CAj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_41F47D

loc_41F49D:				; CODE XREF: sub_41EFB1+4C1j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	loc_41F56F
; ---------------------------------------------------------------------------

loc_41F4AF:				; CODE XREF: sub_41EFB1+4BBj
		cmp	[ebp+arg_C], 0
		jz	short loc_41F4F3
		cmp	[ebp+var_24], 0
		jz	short loc_41F4E4
		mov	[ebp+var_10], 0
		jmp	short loc_41F4DC
; ---------------------------------------------------------------------------

loc_41F4C4:				; CODE XREF: sub_41EFB1+531j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_41F4DC:				; CODE XREF: sub_41EFB1+511j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_41F4C4

loc_41F4E4:				; CODE XREF: sub_41EFB1+508j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_41F56F
; ---------------------------------------------------------------------------

loc_41F4F3:				; CODE XREF: sub_41EFB1+502j
		cmp	[ebp+var_28], 7Fh
		jbe	short loc_41F51C
		cmp	[ebp+var_28], 0FFh
		ja	short loc_41F51C
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_41F56F
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_41F56F
; ---------------------------------------------------------------------------

loc_41F51C:				; CODE XREF: sub_41EFB1+546j
					; sub_41EFB1+54Fj
		cmp	[ebp+var_24], 0
		jz	short loc_41F55F
		mov	[ebp+var_10], 0
		jmp	short loc_41F557
; ---------------------------------------------------------------------------

loc_41F52B:				; CODE XREF: sub_41EFB1+5ACj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_2 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_41F557:				; CODE XREF: sub_41EFB1+578j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_41F52B

loc_41F55F:				; CODE XREF: sub_41EFB1+56Fj
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0

loc_41F56F:				; CODE XREF: sub_41EFB1+9Cj
					; sub_41EFB1+20Ej ...
		add	[ebp+var_18], 1
		sub	[ebp+var_2C], 1

loc_41F577:				; CODE XREF: sub_41EFB1+44j
		cmp	[ebp+var_2C], 0
		jnz	loc_41EFFA
		cmp	[ebp+var_20], 0
		jnz	short loc_41F5A3
		mov	eax, [ebp+var_1C]
		add	eax, 1
		mov	[esp+88h+Dest],	eax ; size_t
		call	sub_406D00
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax
		jmp	loc_41EFD5
; ---------------------------------------------------------------------------

loc_41F5A3:				; CODE XREF: sub_41EFB1+5D4j
		cmp	[ebp+arg_C], 0
		jz	loc_41F773
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, off_422174
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	libiconv_open
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0FFFFFFFFh
		jnz	short loc_41F617
		mov	eax, off_422174
		mov	[esp+88h+var_80], 1
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	sub_41E950
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_406E5D
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_41F783
		jmp	loc_41F77C
; ---------------------------------------------------------------------------

loc_41F617:				; CODE XREF: sub_41EFB1+61Ej
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		sub	eax, 1
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_44], eax
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_50]
		mov	[ebp+var_5C], eax
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_5C]
		mul	edx
		mov	eax, edx
		shr	eax, 2
		cmp	eax, [ebp+var_1C]
		jz	short loc_41F67B
		mov	[esp+88h+var_80], offset aDo_utf8_to_nat ; "do_utf8_to_native"
		mov	[esp+88h+Format], 24Ah
		mov	[esp+88h+Dest],	offset a____Gnupg22__6 ; "../../gnupg2-2.0.30/jnlib/utf8conv.c"
		call	sub_41A7F4
; ---------------------------------------------------------------------------

loc_41F67B:				; CODE XREF: sub_41EFB1+6ACj
		mov	eax, [ebp+var_50]
		mov	[esp+88h+Dest],	eax ; size_t
		call	sub_406D00
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_48]
		mov	[ebp+var_34], eax
		lea	eax, [ebp+var_50]
		mov	[esp+88h+var_78], eax
		lea	eax, [ebp+var_48]
		mov	[esp+88h+var_7C], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+88h+var_80], eax
		lea	eax, [ebp+var_44]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	libiconv
		cmp	eax, 0FFFFFFFFh
		jnz	loc_41F752
		mov	eax, ds:dword_428C2C
		test	eax, eax
		jnz	short loc_41F705
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+88h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	esi, off_422174
		mov	[esp+88h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_419D7C
		mov	[esp+88h+var_7C], ebx
		mov	[esp+88h+var_80], esi
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax ; char *
		call	sub_41A63B

loc_41F705:				; CODE XREF: sub_41EFB1+715j
		mov	ds:dword_428C2C, 1
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_406E5D
		mov	[ebp+var_20], 0
		mov	eax, [ebp+var_34]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_406E5D
		mov	[esp+88h+var_7C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_41EFB1
		mov	[ebp+var_34], eax
		jmp	short loc_41F763
; ---------------------------------------------------------------------------

loc_41F752:				; CODE XREF: sub_41EFB1+708j
		mov	eax, [ebp+var_48]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_406E5D

loc_41F763:				; CODE XREF: sub_41EFB1+79Fj
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	libiconv_close
		mov	eax, [ebp+var_34]
		jmp	short loc_41F77C
; ---------------------------------------------------------------------------

loc_41F773:				; CODE XREF: sub_41EFB1+5F6j
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]

loc_41F77C:				; CODE XREF: sub_41EFB1+661j
					; sub_41EFB1+7C0j
		sub	esp, 0FFFFFF80h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_41EFB1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41F783	proc near		; CODE XREF: sub_40B231+58p
					; .text:00413473p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_428C28
		mov	[esp+18h+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_41EFB1
		leave
		retn
sub_41F783	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv_open
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+18h]
		mov	[esp+10h], eax
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv_close
		leave
		retn
; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_sendfd]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_transact]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_gpg_err_source]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_new]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_pipe_connect]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_socket_connect]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_pending_line]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_write_line]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_send_data]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_read_line]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_release]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_strsource]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_strerror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_err_code_from_syserror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_err_code_from_errno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION libiconv_open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION libiconv_close]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION libiconv]
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:0042C024o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_41F8C0
		cmp	eax, 3
		jz	short loc_41F8C0
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_41F8C0:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_420AB0
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_401180+113p
					; DATA XREF: .rdata:off_42764Co ...

lpLibFileName	= dword	ptr -1Ch
lpProcName	= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		mov	edx, ds:_winmajor
		mov	eax, [esp+1Ch+arg_4]
		cmp	dword ptr [edx], 3
		jbe	short loc_41F934
		cmp	dword_422188, 2
		jz	short loc_41F916
		mov	dword_422188, 2

loc_41F916:				; CODE XREF: TlsCallback_0+1Aj
		cmp	eax, 2
		jz	loc_41FA23
		cmp	eax, 1
		jz	loc_41F9C2

loc_41F928:				; CODE XREF: TlsCallback_0+EEj
					; TlsCallback_0+13Ej
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_41F934:				; CODE XREF: TlsCallback_0+11j
		mov	ds:dword_429074, 1
		mov	[esp+1Ch+lpLibFileName], offset	LibFileName ; "mingwm10.dll"
		call	ds:LoadLibraryA
		sub	esp, 4
		test	eax, eax
		mov	ds:hLibModule, eax
		jz	loc_41FA53
		mov	ebx, ds:GetProcAddress
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_rem ; "__mingwthr_remove_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	ds:dword_429070, eax
		mov	eax, ds:hLibModule
		sub	esp, 8
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_key ; "__mingwthr_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	edx, ds:hLibModule
		sub	esp, 8
		test	edx, edx
		mov	ds:dword_42906C, eax
		jz	loc_41FA53
		mov	ecx, ds:dword_429070
		test	ecx, ecx
		jz	short loc_41F9E3
		test	eax, eax
		jz	short loc_41F9E3
		mov	dword_422188, 1
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_41F9C2:				; CODE XREF: TlsCallback_0+32j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+lpProcName], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpLibFileName], eax
		call	sub_420AB0
		jmp	loc_41F928
; ---------------------------------------------------------------------------

loc_41F9E3:				; CODE XREF: TlsCallback_0+B6j
					; TlsCallback_0+BAj
		mov	ds:dword_42906C, 0
		mov	ds:dword_429070, 0
		mov	[esp+1Ch+lpLibFileName], edx ; hLibModule
		call	ds:FreeLibrary
		sub	esp, 4

loc_41FA03:				; CODE XREF: TlsCallback_0+177j
		mov	ds:hLibModule, 0
		mov	eax, 1
		mov	dword_422188, 0
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_41FA23:				; CODE XREF: TlsCallback_0+29j
		mov	ebx, offset dword_42C030
		cmp	ebx, offset dword_42C030
		jz	loc_41F928

loc_41FA34:				; CODE XREF: TlsCallback_0+155j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_41FA3C
		call	eax

loc_41FA3C:				; CODE XREF: TlsCallback_0+148j
		add	ebx, 4
		cmp	ebx, offset dword_42C030
		jnz	short loc_41FA34
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_41FA53:				; CODE XREF: TlsCallback_0+65j
					; TlsCallback_0+A8j
		mov	ds:dword_42906C, 0
		mov	ds:dword_429070, 0
		jmp	short loc_41FA03
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41FA80	proc near		; DATA XREF: .CRT:0042C014o
		mov	eax, ds:__lconv_init
		jmp	eax
sub_41FA80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41FA90	proc near		; CODE XREF: sub_41FAB0+10p
					; sub_41FAB0+36p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_41FA90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41FAA0	proc near		; CODE XREF: sub_401060+59p
					; sub_41FAB0+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_41FAA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_41FAB0(_onexit_t)
sub_41FAB0	proc near		; CODE XREF: sub_41FB70+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_42907C
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_41FA90
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_14], eax
		jz	loc_41FB50
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_42907C
		mov	[esp+2Ch+Func],	eax
		call	sub_41FA90
		mov	[esp+2Ch+var_14], eax
		mov	eax, ds:dword_429078
		mov	[esp+2Ch+Func],	eax
		call	sub_41FA90
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_10], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_41FAA0
		mov	ds:dword_42907C, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_41FAA0
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_429078, eax
		call	_unlock
		add	esp, 28h
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_41FB50:				; CODE XREF: sub_41FAB0+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_41FAB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_41FB70(_onexit_t)
sub_41FB70	proc near		; CODE XREF: sub_40E6C5+20p
					; sub_420790-27p ...

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_41FAB0
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_41FB70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LONG __stdcall TopLevelExceptionFilter(struct	_EXCEPTION_POINTERS *ExceptionInfo)
TopLevelExceptionFilter	proc near	; DATA XREF: sub_401180+11Do

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
ExceptionInfo	= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 24h
		mov	ebx, [esp+2Ch+ExceptionInfo]
		mov	eax, [ebx]
		mov	eax, [eax]
		cmp	eax, 0C0000091h
		ja	short loc_41FBE7
		cmp	eax, 0C000008Dh
		jb	short loc_41FC14

loc_41FBAB:				; CODE XREF: TopLevelExceptionFilter+6Aj
		mov	esi, 1

loc_41FBB0:				; CODE XREF: TopLevelExceptionFilter+C7j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 8
		call	signal
		cmp	eax, 1
		jz	loc_41FCE0
		test	eax, eax
		jz	short loc_41FBFC
		mov	[esp+2Ch+var_2C], 8
		call	eax
		mov	eax, 0FFFFFFFFh

loc_41FBDF:				; CODE XREF: TopLevelExceptionFilter+120j
					; TopLevelExceptionFilter+13Ej	...
		add	esp, 24h
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_41FBE7:				; CODE XREF: TopLevelExceptionFilter+12j
		cmp	eax, 0C0000094h
		jz	short loc_41FC55
		cmp	eax, 0C0000096h
		jz	short loc_41FC22
		cmp	eax, 0C0000093h
		jz	short loc_41FBAB

loc_41FBFC:				; CODE XREF: TopLevelExceptionFilter+3Fj
					; TopLevelExceptionFilter+90j ...
		mov	eax, ds:dword_428C88
		test	eax, eax
		jz	loc_41FCD3
		mov	[esp+2Ch+ExceptionInfo], ebx
		add	esp, 24h
		pop	ebx
		pop	esi
		jmp	eax
; ---------------------------------------------------------------------------

loc_41FC14:				; CODE XREF: TopLevelExceptionFilter+19j
		cmp	eax, 0C0000005h
		jz	short loc_41FC60
		cmp	eax, 0C000001Dh
		jnz	short loc_41FBFC

loc_41FC22:				; CODE XREF: TopLevelExceptionFilter+63j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 4
		call	signal
		cmp	eax, 1
		jz	short loc_41FC97
		test	eax, eax
		jz	short loc_41FBFC
		mov	[esp+2Ch+var_2C], 4
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_41FC55:				; CODE XREF: TopLevelExceptionFilter+5Cj
		xor	esi, esi
		jmp	loc_41FBB0
; ---------------------------------------------------------------------------
		align 10h

loc_41FC60:				; CODE XREF: TopLevelExceptionFilter+89j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		cmp	eax, 1
		jz	short loc_41FCB5
		test	eax, eax
		jz	loc_41FBFC
		mov	[esp+2Ch+var_2C], 0Bh
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_41FC97:				; CODE XREF: TopLevelExceptionFilter+A9j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 4
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_41FBDF
; ---------------------------------------------------------------------------

loc_41FCB5:				; CODE XREF: TopLevelExceptionFilter+E7j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_41FBDF
; ---------------------------------------------------------------------------

loc_41FCD3:				; CODE XREF: TopLevelExceptionFilter+73j
		xor	eax, eax
		jmp	loc_41FBDF
; ---------------------------------------------------------------------------
		align 10h

loc_41FCE0:				; CODE XREF: TopLevelExceptionFilter+37j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 8
		call	signal
		test	esi, esi
		mov	eax, 0FFFFFFFFh
		jz	loc_41FBDF
		mov	[esp+2Ch+var_10], eax
		call	sub_420700
		mov	eax, [esp+2Ch+var_10]
		jmp	loc_41FBDF
TopLevelExceptionFilter	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 3Ch
		mov	eax, ds:dword_428C8C
		fld	qword ptr [esp+48h]
		fld	qword ptr [esp+50h]
		fld	qword ptr [esp+58h]
		test	eax, eax
		jz	short loc_41FD61
		fxch	st(2)
		mov	edx, [esp+40h]
		fstp	qword ptr [esp+18h]
		fstp	qword ptr [esp+20h]
		fstp	qword ptr [esp+28h]
		mov	[esp+10h], edx
		mov	edx, [esp+44h]
		mov	[esp+14h], edx
		lea	edx, [esp+10h]
		mov	[esp], edx
		call	eax ; dword_428C8C
		jmp	short loc_41FD67
; ---------------------------------------------------------------------------

loc_41FD61:				; CODE XREF: .text:0041FD36j
		fstp	st
		fstp	st
		fstp	st

loc_41FD67:				; CODE XREF: .text:0041FD5Fj
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41FD70	proc near		; CODE XREF: sub_401060+F7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ds:dword_428C8C, eax
		jmp	__setusermatherr
sub_41FD70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41FD80	proc near		; DATA XREF: sub_401060:loc_401150o

File		= dword	ptr -3Ch
Format		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= qword	ptr -2Ch
var_24		= qword	ptr -24h
var_1C		= qword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 3Ch
		mov	edx, offset aUnknownError ; "Unknown error"
		mov	eax, [esp+3Ch+arg_0]
		mov	ecx, [eax]
		sub	ecx, 1
		cmp	ecx, 5
		ja	short loc_41FD9D
		mov	edx, ds:off_42776C[ecx*4]

loc_41FD9D:				; CODE XREF: sub_41FD80+14j
		fld	qword ptr [eax+18h]
		fstp	[esp+3Ch+var_1C]
		fld	qword ptr [eax+10h]
		fstp	[esp+3Ch+var_24]
		fld	qword ptr [eax+8]
		fstp	[esp+3Ch+var_2C]
		mov	eax, [eax+4]
		mov	[esp+3Ch+var_34], edx
		mov	[esp+3Ch+Format], offset a_matherrSInSGG ; "_matherr():	%s in %s(%g, %g)  (retval=%"...
		mov	[esp+3Ch+var_30], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+3Ch+File],	eax ; File
		call	fprintf
		xor	eax, eax
		add	esp, 3Ch
		retn
sub_41FD80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_41FDE0	proc near		; CODE XREF: sub_401060+75p
		xor	eax, eax
		retn
sub_41FDE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_41FDF0(char *Format, char ArgList)
sub_41FDF0	proc near		; CODE XREF: sub_41FE50+1DDp
					; sub_41FE50+204p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aMingwW64Runtim ;	"Mingw-w64 runtime failure:\n"
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_41FDF0	endp

; ---------------------------------------------------------------------------
		jmp	short sub_41FE50
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_41FE50(size_t Size)
sub_41FE50	proc near		; CODE XREF: .text:0041FE41j
					; sub_420090+B8p ...

lpAddress	= dword	ptr -7Ch
lpBuffer	= dword	ptr -78h
dwLength	= dword	ptr -74h
lpflOldProtect	= dword	ptr -70h
var_64		= dword	ptr -64h
Src		= dword	ptr -60h
var_58		= _MEMORY_BASIC_INFORMATION ptr	-58h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h

		push	ebp
		mov	ebp, ecx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 6Ch
		mov	ecx, ds:dword_428C98
		mov	[esp+7Ch+Src], edx
		test	ecx, ecx
		jle	loc_420032
		mov	eax, ds:dword_428C94
		xor	esi, esi

loc_41FE74:				; CODE XREF: sub_41FE50+41j
		mov	edx, [eax+4]
		cmp	ebx, edx
		jb	short loc_41FE89
		mov	edi, [eax+8]
		add	edx, [edi+8]
		cmp	ebx, edx
		jb	loc_41FF60

loc_41FE89:				; CODE XREF: sub_41FE50+29j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jnz	short loc_41FE74

loc_41FE93:				; CODE XREF: sub_41FE50+1E4j
		mov	[esp+7Ch+lpAddress], ebx
		call	sub_420450
		test	eax, eax
		mov	edi, eax
		jz	loc_420059
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_428C94
		shl	edx, 2
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		mov	[esp+7Ch+var_64], edx
		call	sub_420530
		mov	edx, [esp+7Ch+var_64]
		add	eax, [edi+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+7Ch+Buffer]
		mov	esi, ds:VirtualQuery
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_428C94
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+7Ch+var_64]
		jz	loc_420039
		mov	eax, [esp+7Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	loc_41FFE1

loc_41FF0F:				; CODE XREF: sub_41FE50+194j
					; sub_41FE50+1C6j
		add	ds:dword_428C98, 1

loc_41FF16:				; CODE XREF: sub_41FE50+116j
		lea	eax, [esp+7Ch+var_58]
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	[esp+7Ch+lpAddress], ebx ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_420069
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 4
		jnz	short loc_41FF68

loc_41FF3F:				; CODE XREF: sub_41FE50+11Bj
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy

loc_41FF53:				; CODE XREF: sub_41FE50+162j
					; sub_41FE50+167j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_41FF60:				; CODE XREF: sub_41FE50+33j
		mov	esi, ds:VirtualQuery
		jmp	short loc_41FF16
; ---------------------------------------------------------------------------

loc_41FF68:				; CODE XREF: sub_41FE50+EDj
		cmp	eax, 40h
		jz	short loc_41FF3F
		mov	eax, [esp+7Ch+var_58.RegionSize]
		lea	edi, [esp+7Ch+flOldProtect]
		mov	esi, ds:VirtualProtect
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 40h
		jz	short loc_41FF53
		cmp	eax, 4
		jz	short loc_41FF53
		mov	eax, [esp+7Ch+flOldProtect]
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], eax	; flNewProtect
		mov	eax, [esp+7Ch+var_58.RegionSize]
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_41FFE1:				; CODE XREF: sub_41FE50+B9j
		cmp	eax, 40h
		jz	loc_41FF0F
		mov	eax, [esp+7Ch+Buffer.RegionSize]
		add	edx, ds:dword_428C94
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+Buffer.BaseAddress]
		mov	[esp+7Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		test	eax, eax
		jnz	loc_41FF0F
		call	ds:GetLastError
		mov	[esp+7Ch+lpAddress], offset aVirtualprotect ; "	 VirtualProtect	failed with code 0x%x"
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_41FDF0
; ---------------------------------------------------------------------------

loc_420032:				; CODE XREF: sub_41FE50+17j
		xor	esi, esi
		jmp	loc_41FE93
; ---------------------------------------------------------------------------

loc_420039:				; CODE XREF: sub_41FE50+ACj
		mov	eax, ds:dword_428C94
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+dwLength], eax
		mov	eax, [edi+8]
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_41FDF0
; ---------------------------------------------------------------------------

loc_420059:				; CODE XREF: sub_41FE50+4Fj
		mov	[esp+7Ch+lpBuffer], ebx	; ArgList
		mov	[esp+7Ch+lpAddress], offset aAddressPHasNoI ; "Address %p has no image-section"
		call	sub_41FDF0
; ---------------------------------------------------------------------------

loc_420069:				; CODE XREF: sub_41FE50+E0j
		mov	[esp+7Ch+dwLength], ebx
		mov	[esp+7Ch+lpBuffer], 1Ch	; ArgList
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		call	sub_41FDF0
sub_41FE50	endp

; ---------------------------------------------------------------------------
		db 0EBh	; 
		db  0Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_420090	proc near		; CODE XREF: sub_401180:loc_401298p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
var_20		= dword	ptr -20h
flOldProtect	= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_428C90
		test	eax, eax
		jz	short loc_4200B0

loc_4200A2:				; CODE XREF: sub_420090+66j
					; sub_420090+96j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4200B0:				; CODE XREF: sub_420090+10j
		mov	ds:dword_428C90, 1
		call	sub_420490
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_420B50
		mov	ds:dword_428C98, 0
		sub	esp, eax
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_428C94, eax
		mov	eax, offset dword_427A80
		sub	eax, offset dword_427A80
		cmp	eax, 7
		jle	short loc_4200A2
		cmp	eax, 0Bh
		mov	ebx, offset dword_427A80
		jle	loc_4201F0
		mov	eax, ds:dword_427A80
		test	eax, eax
		jnz	short loc_420120
		mov	eax, ds:dword_427A84
		test	eax, eax
		jz	loc_4201DC
		lea	esi, [esi+0]

loc_420120:				; CODE XREF: sub_420090+7Dj
					; sub_420090+164j ...
		cmp	ebx, offset dword_427A80
		jnb	loc_4200A2
		mov	esi, 400000h

loc_420131:				; CODE XREF: sub_420090+C3j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		lea	edx, [ebp+flOldProtect]
		call	sub_41FE50
		cmp	ebx, offset dword_427A80
		jb	short loc_420131

loc_420155:				; CODE XREF: sub_420090+24Bj
		mov	ecx, ds:dword_428C98
		test	ecx, ecx
		jle	loc_4200A2
		xor	ebx, ebx
		xor	esi, esi
		mov	edi, ds:VirtualQuery
		jmp	short loc_420182
; ---------------------------------------------------------------------------
		align 10h

loc_420170:				; CODE XREF: sub_420090+FDj
					; sub_420090+14Aj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_428C98
		jge	loc_4200A2

loc_420182:				; CODE XREF: sub_420090+DDj
		mov	eax, ds:dword_428C94
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_420170
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	edi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_420302
		lea	eax, [ebp+flOldProtect]
		mov	[esp+58h+lpflOldProtect], eax ;	lpflOldProtect
		mov	eax, ds:dword_428C94
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_420170
; ---------------------------------------------------------------------------

loc_4201DC:				; CODE XREF: sub_420090+86j
		mov	eax, ds:dword_427A88
		test	eax, eax
		jnz	short loc_420205
		mov	ebx, offset dword_427A8C
		lea	esi, [esi+0]

loc_4201F0:				; CODE XREF: sub_420090+70j
		mov	edi, [ebx]
		test	edi, edi
		jnz	loc_420120
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	loc_420120

loc_420205:				; CODE XREF: sub_420090+153j
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_420325
		add	ebx, 0Ch
		cmp	ebx, offset dword_427A80
		jnb	loc_4200A2

loc_420220:				; CODE XREF: sub_420090+245j
		movzx	edx, byte ptr [ebx+8]
		mov	eax, 400000h
		mov	ecx, [ebx]
		add	eax, [ebx+4]
		cmp	edx, 10h
		mov	esi, [ecx+400000h]
		jz	short loc_42027A
		cmp	edx, 20h
		jz	short loc_4202B0
		cmp	edx, 8
		jz	short loc_42025A
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		mov	[ebp+var_20], 0
		call	sub_41FDF0
; ---------------------------------------------------------------------------

loc_42025A:				; CODE XREF: sub_420090+1B1j
		movzx	edi, byte ptr [eax]
		test	edi, 80h
		jz	short loc_420285
		or	edi, 0FFFFFF00h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi
		jmp	short loc_4202A1
; ---------------------------------------------------------------------------

loc_42027A:				; CODE XREF: sub_420090+1A7j
		movzx	edi, word ptr [eax]
		test	edi, 8000h
		jnz	short loc_4202E0

loc_420285:				; CODE XREF: sub_420090+1D3j
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		cmp	edx, 10h
		mov	[ebp+var_20], esi
		jz	short loc_4202F3
		cmp	edx, 20h
		jz	short loc_4202BF
		cmp	edx, 8
		jnz	short loc_4202CC

loc_4202A1:				; CODE XREF: sub_420090+1E8j
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_20]
		call	sub_41FE50
		jmp	short loc_4202CC
; ---------------------------------------------------------------------------

loc_4202B0:				; CODE XREF: sub_420090+1ACj
		mov	edx, [eax]
		sub	edx, ecx
		sub	edx, 400000h
		add	edx, esi
		mov	[ebp+var_20], edx

loc_4202BF:				; CODE XREF: sub_420090+20Aj
		mov	ecx, 4		; Size
		lea	edx, [ebp+var_20]
		call	sub_41FE50

loc_4202CC:				; CODE XREF: sub_420090+20Fj
					; sub_420090+21Ej ...
		add	ebx, 0Ch
		cmp	ebx, offset dword_427A80
		jb	loc_420220
		jmp	loc_420155
; ---------------------------------------------------------------------------

loc_4202E0:				; CODE XREF: sub_420090+1F3j
		or	edi, 0FFFF0000h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi

loc_4202F3:				; CODE XREF: sub_420090+205j
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_20]
		call	sub_41FE50
		jmp	short loc_4202CC
; ---------------------------------------------------------------------------

loc_420302:				; CODE XREF: sub_420090+11Bj
		add	ebx, ds:dword_428C94
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_41FDF0
; ---------------------------------------------------------------------------

loc_420325:				; CODE XREF: sub_420090+17Bj
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_41FDF0
sub_420090	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_420340	proc near		; CODE XREF: .text:004203E1p
					; sub_420450+Ap ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	eax, eax
		cmp	word ptr [edx],	5A4Dh
		jz	short loc_420350

locret_42034D:				; CODE XREF: sub_420340+19j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_420350:				; CODE XREF: sub_420340+Bj
		add	edx, [edx+3Ch]
		cmp	dword ptr [edx], 4550h
		jnz	short locret_42034D
		xor	eax, eax
		cmp	word ptr [edx+18h], 10Bh
		setz	al
		retn
sub_420340	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_420370	proc near		; CODE XREF: sub_420450+2Bp
					; .text:00420594p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		xor	eax, eax
		push	ebx
		mov	edx, [esp+8+arg_0]
		mov	ebx, [esp+8+arg_4]
		add	edx, [edx+3Ch]
		movzx	esi, word ptr [edx+6]
		movzx	ecx, word ptr [edx+14h]
		test	esi, esi
		jz	short loc_4203AE
		movzx	ecx, cx
		lea	eax, [edx+ecx+18h]
		xor	edx, edx

loc_420394:				; CODE XREF: sub_420370+3Aj
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_4203A2
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_4203AE

loc_4203A2:				; CODE XREF: sub_420370+29j
		add	edx, 1
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_420394
		xor	eax, eax

loc_4203AE:				; CODE XREF: sub_420370+19j
					; sub_420370+30j
		pop	ebx
		pop	esi
		retn
sub_420370	endp

; ---------------------------------------------------------------------------
		jmp	short loc_4203C0
; ---------------------------------------------------------------------------
		align 10h

loc_4203C0:				; CODE XREF: .text:004203B1j
		push	ebp
		push	edi
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 1Ch
		mov	edi, [esp+30h]
		mov	[esp], edi
		call	strlen
		cmp	eax, 8
		ja	short loc_420433
		mov	dword ptr [esp], 400000h
		call	sub_420340
		test	eax, eax
		jz	short loc_420433
		mov	eax, ds:40003Ch
		movzx	ebp, word ptr [eax+400006h]
		movzx	edx, word ptr [eax+400014h]
		add	eax, 400000h
		test	ebp, ebp
		jz	short loc_420433
		movzx	edx, dx
		xor	esi, esi
		lea	ebx, [eax+edx+18h]
		jmp	short loc_42041B
; ---------------------------------------------------------------------------

loc_420411:				; CODE XREF: .text:00420431j
		add	esi, 1
		add	ebx, 28h
		cmp	esi, ebp
		jnb	short loc_420440

loc_42041B:				; CODE XREF: .text:0042040Fj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], edi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jnz	short loc_420411

loc_420433:				; CODE XREF: .text:004203D8j
					; .text:004203E8j ...
		add	esp, 1Ch
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_420440:				; CODE XREF: .text:00420419j
		add	esp, 1Ch
		xor	ebx, ebx
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_420450	proc near		; CODE XREF: sub_41FE50+46p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	[esp+8+var_8], 400000h
		call	sub_420340
		mov	edx, eax
		xor	eax, eax
		test	edx, edx
		jz	short loc_420480
		mov	eax, [esp+8+arg_0]
		mov	[esp+8+var_8], 400000h
		sub	eax, 400000h
		mov	[esp+8+var_4], eax
		call	sub_420370

loc_420480:				; CODE XREF: sub_420450+15j
		add	esp, 8
		retn
sub_420450	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_420490	proc near		; CODE XREF: sub_420090+2Ap

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_420340
		xor	edx, edx
		test	eax, eax
		jz	short loc_4204B1
		mov	eax, ds:40003Ch
		movzx	edx, word ptr [eax+400006h]

loc_4204B1:				; CODE XREF: sub_420490+13j
		mov	eax, edx
		add	esp, 4
		retn
sub_420490	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 4
		mov	dword ptr [esp], 400000h
		mov	ebx, [esp+10h]
		call	sub_420340
		xor	edx, edx
		test	eax, eax
		jz	short loc_420519
		mov	eax, ds:40003Ch
		movzx	ecx, word ptr [eax+400006h]
		movzx	esi, word ptr [eax+400014h]
		add	eax, 400000h
		test	ecx, ecx
		jz	short loc_420519
		movzx	esi, si
		lea	edx, [eax+esi+18h]
		xor	eax, eax

loc_420500:				; CODE XREF: .text:00420515j
		test	byte ptr [edx+27h], 20h
		jz	short loc_42050D
		test	ebx, ebx
		jz	short loc_420519
		sub	ebx, 1

loc_42050D:				; CODE XREF: .text:00420504j
		add	eax, 1
		add	edx, 28h
		cmp	eax, ecx
		jb	short loc_420500
		xor	edx, edx

loc_420519:				; CODE XREF: .text:004204D9j
					; .text:004204F5j ...
		add	esp, 4
		mov	eax, edx
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_420530
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_420530	proc near		; CODE XREF: sub_41FE50+70p
					; .text:00420521j

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_420340
		xor	edx, edx
		test	eax, eax
		mov	eax, 400000h
		cmovnz	edx, eax
		add	esp, 4
		mov	eax, edx
		retn
sub_420530	endp

; ---------------------------------------------------------------------------
		jmp	short loc_420560
; ---------------------------------------------------------------------------
		align 10h

loc_420560:				; CODE XREF: .text:00420551j
		push	ebx
		xor	ebx, ebx
		sub	esp, 8
		mov	dword ptr [esp], 400000h
		call	sub_420340
		test	eax, eax
		jnz	short loc_420580

loc_420576:				; CODE XREF: .text:0042059Bj
		add	esp, 8
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_420580:				; CODE XREF: .text:00420574j
		mov	eax, [esp+10h]
		mov	dword ptr [esp], 400000h
		sub	eax, 400000h
		mov	[esp+4], eax
		call	sub_420370
		test	eax, eax
		jz	short loc_420576
		mov	ebx, [eax+24h]
		add	esp, 8
		not	ebx
		shr	ebx, 1Fh
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4205B0	proc near		; CODE XREF: sub_420640+1Ap

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	edi
		xor	edi, edi
		push	esi
		push	ebx
		sub	esp, 8
		mov	[esp+14h+var_14], 400000h
		mov	ebx, [esp+14h+arg_0]
		call	sub_420340
		test	eax, eax
		jz	short loc_420621
		mov	eax, ds:40003Ch
		mov	esi, [eax+400080h]
		test	esi, esi
		jz	short loc_420621
		mov	[esp+14h+var_10], esi
		mov	[esp+14h+var_14], 400000h
		call	sub_420370
		test	eax, eax
		jz	short loc_420621
		add	esi, 400000h
		jnz	short loc_420606
		jmp	short loc_420621
; ---------------------------------------------------------------------------
		align 10h

loc_420600:				; CODE XREF: sub_4205B0+66j
		sub	ebx, 1
		add	esi, 14h

loc_420606:				; CODE XREF: sub_4205B0+45j
		mov	edx, [esi+4]
		test	edx, edx
		jnz	short loc_420614
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_420630

loc_420614:				; CODE XREF: sub_4205B0+5Bj
		test	ebx, ebx
		jg	short loc_420600
		mov	edi, [esi+0Ch]
		add	edi, 400000h

loc_420621:				; CODE XREF: sub_4205B0+1Aj
					; sub_4205B0+29j ...
		add	esp, 8
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_420630:				; CODE XREF: sub_4205B0+62j
		add	esp, 8
		xor	edi, edi
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_4205B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_420640	proc near		; CODE XREF: sub_401180+132p

lpModuleName	= dword	ptr -1Ch

		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_428C9C
		test	eax, eax
		jz	short loc_420652

loc_42064D:				; CODE XREF: sub_420640+97j
					; sub_420640+B5j
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_420652:				; CODE XREF: sub_420640+Bj
		xor	eax, eax

loc_420654:				; CODE XREF: sub_420640+82j
		mov	[esp+1Ch+lpModuleName],	eax
		lea	ebx, [eax+1]
		call	sub_4205B0
		test	eax, eax
		jz	short loc_4206E0
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_420670
		cmp	dl, 6Dh
		jnz	short loc_4206C0

loc_420670:				; CODE XREF: sub_420640+29j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_42067E
		cmp	dl, 73h
		jnz	short loc_4206C0

loc_42067E:				; CODE XREF: sub_420640+37j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_42068C
		cmp	dl, 76h
		jnz	short loc_4206C0

loc_42068C:				; CODE XREF: sub_420640+45j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_42069A
		cmp	dl, 63h
		jnz	short loc_4206C0

loc_42069A:				; CODE XREF: sub_420640+53j
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_4206A8
		cmp	dl, 72h
		jnz	short loc_4206C0

loc_4206A8:				; CODE XREF: sub_420640+61j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_4206C4
		cmp	dl, 74h
		jz	short loc_4206C4
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_4206C4
		xchg	ax, ax

loc_4206C0:				; CODE XREF: sub_420640+2Ej
					; sub_420640+3Cj ...
		mov	eax, ebx
		jmp	short loc_420654
; ---------------------------------------------------------------------------

loc_4206C4:				; CODE XREF: sub_420640+6Fj
					; sub_420640+74j ...
		mov	[esp+1Ch+lpModuleName],	eax ; lpModuleName
		call	ds:GetModuleHandleA
		sub	esp, 4
		test	eax, eax
		mov	ds:dword_428C9C, eax
		jnz	loc_42064D
		lea	esi, [esi+0]

loc_4206E0:				; CODE XREF: sub_420640+21j
		mov	[esp+1Ch+lpModuleName],	offset aMsvcrt_dll ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_428C9C, eax
		jmp	loc_42064D
sub_420640	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_420700	proc near		; CODE XREF: sub_401180:loc_4012D8p
					; TopLevelExceptionFilter+175p
		fninit
		retn
sub_420700	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_420710()
sub_420710	proc near		; DATA XREF: sub_420790:loc_420762o
		sub	esp, 0Ch
		mov	eax, off_422184
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_420737
		xchg	ax, ax

loc_420720:				; CODE XREF: sub_420710+25j
		call	eax
		mov	eax, off_422184
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_422184, edx
		test	eax, eax
		jnz	short loc_420720

loc_420737:				; CODE XREF: sub_420710+Cj
		add	esp, 0Ch
		retn
sub_420710	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_420790

loc_420740:				; CODE XREF: sub_420790+1Aj
		push	ebx
		sub	esp, 18h
		mov	ebx, ds:dword_4219D0
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_420773

loc_42074F:				; CODE XREF: sub_420790-9j
		test	ebx, ebx
		jz	short loc_420762

loc_420753:				; CODE XREF: sub_420790-30j
		call	ds:dword_4219D0[ebx*4]
		sub	ebx, 1
		lea	esi, [esi+0]
		jnz	short loc_420753

loc_420762:				; CODE XREF: sub_420790-3Fj
		mov	[esp+1Ch+var_1C], offset sub_420710 ; _onexit_t
		call	sub_41FB70
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_420773:				; CODE XREF: sub_420790-43j
		xor	ebx, ebx
		jmp	short loc_420779
; ---------------------------------------------------------------------------

loc_420777:				; CODE XREF: sub_420790-Bj
		mov	ebx, eax

loc_420779:				; CODE XREF: sub_420790-1Bj
		lea	eax, [ebx+1]
		mov	edx, ds:dword_4219D0[eax*4]
		test	edx, edx
		jnz	short loc_420777
		jmp	short loc_42074F
; END OF FUNCTION CHUNK	FOR sub_420790
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_420790	proc near		; CODE XREF: sub_401180+239p
					; sub_40377D+Fp

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 00420740 SIZE 00000049 BYTES

		mov	ecx, ds:dword_428CA0
		test	ecx, ecx
		jz	short loc_4207A0
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_4207A0:				; CODE XREF: sub_420790+8j
		mov	ds:dword_428CA0, 1
		jmp	short loc_420740
sub_420790	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4207B0	proc near		; CODE XREF: .text:004014BDp start+Dp

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
SystemTimeAsFileTime= _FILETIME	ptr -2Ch
PerformanceCount= LARGE_INTEGER	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_422190
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		jz	short loc_420800
		not	eax
		mov	dword_422194, eax

loc_4207E6:				; CODE XREF: sub_4207B0+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_420800:				; CODE XREF: sub_4207B0+2Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_420872

loc_420862:				; CODE XREF: sub_4207B0+CCj
		mov	dword_422190, ebp
		mov	dword_422194, eax
		jmp	loc_4207E6
; ---------------------------------------------------------------------------

loc_420872:				; CODE XREF: sub_4207B0+B0j
		mov	eax, 44BF19B0h
		mov	ebp, 0BB40E64Fh
		jmp	short loc_420862
sub_4207B0	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_428D84, edx
		mov	ds:dword_428FA0, 0C0000409h
		mov	ds:dword_428FA4, 1
		mov	ds:dword_428D78, eax
		mov	ds:dword_428FAC, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_428D6C, eax
		mov	eax, dword_422190
		mov	[ebp-10h], eax
		mov	eax, dword_422194
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_427894
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_420910	proc near		; CODE XREF: sub_420AB0+79p
					; sub_420AB0:loc_420B42p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_42901C
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_420965
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		lea	esi, [esi+0]

loc_420940:				; CODE XREF: sub_420910+53j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_42095E
		test	esi, esi
		jz	short loc_42095E
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_42095E:				; CODE XREF: sub_420910+40j
					; sub_420910+44j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_420940

loc_420965:				; CODE XREF: sub_420910+1Fj
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_420910	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 1Ch
		mov	eax, ds:dword_429000
		mov	[esp+14h], ebx
		xor	ebx, ebx
		mov	[esp+18h], esi
		test	eax, eax
		jnz	short loc_4209A4

loc_420996:				; CODE XREF: .text:00420A0Cj
		mov	eax, ebx
		mov	esi, [esp+18h]
		mov	ebx, [esp+14h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_4209A4:				; CODE XREF: .text:00420994j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		test	eax, eax
		mov	esi, eax
		jz	short loc_420A07
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	CriticalSection
		mov	[esi], eax
		mov	eax, [esp+24h]
		mov	[esi+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_42901C
		mov	ds:dword_42901C, esi
		mov	[esi+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, ebx
		sub	esp, 4
		mov	ebx, [esp+14h]
		mov	esi, [esp+18h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_420A07:				; CODE XREF: .text:004209BCj
		mov	ebx, 0FFFFFFFFh
		jmp	short loc_420996
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_429000
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_420A28
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_420A28:				; CODE XREF: .text:00420A1Fj
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:EnterCriticalSection
		mov	edx, ds:dword_42901C
		sub	esp, 4
		test	edx, edx
		jz	short loc_420A5F
		mov	eax, [edx]
		cmp	eax, ebx
		jnz	short loc_420A58
		jmp	short loc_420A96
; ---------------------------------------------------------------------------
		align 10h

loc_420A50:				; CODE XREF: .text:00420A5Dj
		mov	ecx, [eax]
		cmp	ecx, ebx
		jz	short loc_420A76
		mov	edx, eax

loc_420A58:				; CODE XREF: .text:00420A46j
		mov	eax, [edx+8]
		test	eax, eax
		jnz	short loc_420A50

loc_420A5F:				; CODE XREF: .text:00420A40j
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_420A6F:				; CODE XREF: .text:00420A94j
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_420A76:				; CODE XREF: .text:00420A54j
		mov	ecx, [eax+8]
		mov	[edx+8], ecx

loc_420A7C:				; CODE XREF: .text:00420AA0j
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_420A6F
; ---------------------------------------------------------------------------

loc_420A96:				; CODE XREF: .text:00420A48j
		mov	eax, [edx+8]
		mov	ds:dword_42901C, eax
		mov	eax, edx
		jmp	short loc_420A7C
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_420AB0	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+E9p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_420B00
		jb	short loc_420AD0
		cmp	eax, 3
		jz	short loc_420B20

loc_420AC3:				; CODE XREF: sub_420AB0+31j
					; sub_420AB0+4Dj ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_420AD0:				; CODE XREF: sub_420AB0+Cj
		mov	eax, ds:dword_429000
		test	eax, eax
		jnz	short loc_420B42

loc_420AD9:				; CODE XREF: sub_420AB0+97j
		mov	eax, ds:dword_429000
		cmp	eax, 1
		jnz	short loc_420AC3
		mov	ds:dword_429000, 0
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_420AC3
; ---------------------------------------------------------------------------
		align 10h

loc_420B00:				; CODE XREF: sub_420AB0+Aj
		mov	eax, ds:dword_429000
		test	eax, eax
		jz	short loc_420B30

loc_420B09:				; CODE XREF: sub_420AB0+90j
		mov	ds:dword_429000, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_420B20:				; CODE XREF: sub_420AB0+11j
		mov	eax, ds:dword_429000
		test	eax, eax
		jz	short loc_420AC3
		call	sub_420910
		jmp	short loc_420AC3
; ---------------------------------------------------------------------------

loc_420B30:				; CODE XREF: sub_420AB0+57j
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_420B09
; ---------------------------------------------------------------------------

loc_420B42:				; CODE XREF: sub_420AB0+27j
		call	sub_420910
		jmp	short loc_420AD9
sub_420AB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_420B50	proc near		; CODE XREF: sub_401180+19p
					; sub_420090+3Cp

arg_0		= byte ptr  4

		push	ecx
		push	eax
		cmp	eax, 1000h
		lea	ecx, [esp+8+arg_0]
		jb	short loc_420B72

loc_420B5D:				; CODE XREF: sub_420B50+20j
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_420B5D

loc_420B72:				; CODE XREF: sub_420B50+Bj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		pop	eax
		pop	ecx
		retn
sub_420B50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_420B80	proc near		; CODE XREF: sub_407B6D+2C6p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 2Ch
		mov	[esp+2Ch+var_4], ebp
		mov	ebp, [esp+2Ch+arg_C]
		mov	eax, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_10], ebx
		mov	ecx, [esp+2Ch+arg_8]
		mov	ebx, [esp+2Ch+arg_4]
		test	ebp, ebp
		mov	[esp+2Ch+var_C], esi
		mov	esi, eax
		mov	[esp+2Ch+var_8], edi
		mov	edi, ecx
		mov	[esp+2Ch+var_24], eax
		mov	edx, ebx
		jnz	short loc_420BD0
		cmp	ecx, ebx
		jbe	short loc_420BF2
		div	ecx

loc_420BB7:				; CODE XREF: sub_420B80+8Bj
		mov	eax, edx
		xor	edx, edx

loc_420BBB:				; CODE XREF: sub_420B80+70j
					; sub_420B80+92j ...
		mov	ebx, [esp+2Ch+var_10]
		mov	esi, [esp+2Ch+var_C]
		mov	edi, [esp+2Ch+var_8]
		mov	ebp, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_420BD0:				; CODE XREF: sub_420B80+2Fj
		cmp	ebp, ebx
		ja	short loc_420C10
		bsr	eax, ebp
		xor	eax, 1Fh
		mov	[esp+2Ch+var_28], eax
		jnz	short loc_420C14
		cmp	ecx, esi
		ja	loc_420CA8

loc_420BE8:				; CODE XREF: sub_420B80+12Aj
		mov	edx, ebx
		sub	esi, ecx
		sbb	edx, ebp
		mov	eax, esi
		jmp	short loc_420BBB
; ---------------------------------------------------------------------------

loc_420BF2:				; CODE XREF: sub_420B80+33j
		test	ecx, ecx
		jnz	short loc_420C01
		mov	eax, 1
		xor	edx, edx
		div	ecx
		mov	ecx, eax

loc_420C01:				; CODE XREF: sub_420B80+74j
		mov	eax, ebx
		xor	edx, edx
		div	ecx
		mov	eax, esi
		div	ecx
		jmp	short loc_420BB7
; ---------------------------------------------------------------------------
		align 10h

loc_420C10:				; CODE XREF: sub_420B80+52j
		mov	edx, ebx
		jmp	short loc_420BBB
; ---------------------------------------------------------------------------

loc_420C14:				; CODE XREF: sub_420B80+5Ej
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		mov	esi, 20h
		mov	eax, ebp
		sub	esi, [esp+2Ch+var_28]
		mov	ebp, edi
		mov	edx, ebx
		shl	eax, cl
		mov	ecx, esi
		shr	ebp, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		or	ebp, eax
		mov	eax, [esp+2Ch+var_24]
		shl	edi, cl
		mov	ecx, esi
		shr	edx, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		mov	[esp+2Ch+var_20], edi
		shl	ebx, cl
		mov	ecx, esi
		shr	eax, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		or	eax, ebx
		mov	ebx, [esp+2Ch+var_24]
		div	ebp
		shl	ebx, cl
		mov	[esp+2Ch+var_24], ebx
		mov	ebx, edx
		mul	edi
		cmp	ebx, edx
		mov	edi, eax
		mov	ecx, edx
		jb	short loc_420C9C
		cmp	[esp+2Ch+var_24], eax
		jb	short loc_420C98

loc_420C73:				; CODE XREF: sub_420B80+11Aj
					; sub_420B80+126j
		mov	eax, [esp+2Ch+var_24]
		sub	eax, edi
		sbb	ebx, ecx
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		mov	edx, ebx
		shr	eax, cl
		mov	ecx, esi
		shl	edx, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		or	eax, edx
		mov	edx, ebx
		shr	edx, cl
		jmp	loc_420BBB
; ---------------------------------------------------------------------------

loc_420C98:				; CODE XREF: sub_420B80+F1j
		cmp	ebx, edx
		jnz	short loc_420C73

loc_420C9C:				; CODE XREF: sub_420B80+EBj
		mov	ecx, edx
		mov	edi, eax
		sub	edi, [esp+2Ch+var_20]
		sbb	ecx, ebp
		jmp	short loc_420C73
; ---------------------------------------------------------------------------

loc_420CA8:				; CODE XREF: sub_420B80+62j
		cmp	ebp, ebx
		jb	loc_420BE8
		mov	eax, esi
		jmp	loc_420BBB
sub_420B80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_420CC0	proc near		; CODE XREF: sub_407B6D+2F2p

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 2Ch
		mov	edx, [esp+2Ch+arg_C]
		mov	[esp+2Ch+var_C], esi
		mov	ecx, [esp+2Ch+arg_8]
		mov	esi, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_10], ebx
		mov	ebx, [esp+2Ch+arg_4]
		test	edx, edx
		mov	[esp+2Ch+var_8], edi
		mov	edi, ecx
		mov	[esp+2Ch+var_4], ebp
		mov	[esp+2Ch+var_24], esi
		jnz	short loc_420D28
		cmp	ecx, ebx
		ja	short loc_420D50
		test	ecx, ecx
		jnz	short loc_420D00
		mov	eax, 1
		xor	edx, edx
		div	ecx
		mov	ecx, eax

loc_420D00:				; CODE XREF: sub_420CC0+33j
		mov	eax, ebx
		xor	edx, edx
		div	ecx
		mov	ebx, eax
		mov	eax, esi
		div	ecx
		mov	ecx, ebx
		mov	esi, eax

loc_420D10:				; CODE XREF: sub_420CC0+6Ej
					; sub_420CC0+80j ...
		mov	eax, esi
		mov	edx, ecx
		mov	ebx, [esp+2Ch+var_10]
		mov	esi, [esp+2Ch+var_C]
		mov	edi, [esp+2Ch+var_8]
		mov	ebp, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_420D28:				; CODE XREF: sub_420CC0+2Bj
		xor	ecx, ecx
		xor	esi, esi
		cmp	edx, ebx
		ja	short loc_420D10
		bsr	ebp, edx
		xor	ebp, 1Fh
		jnz	short loc_420D60
		cmp	edi, [esp+2Ch+var_24]
		jbe	short loc_420D42
		cmp	edx, ebx
		jnb	short loc_420D10

loc_420D42:				; CODE XREF: sub_420CC0+7Cj
		xor	ecx, ecx
		mov	esi, 1
		jmp	short loc_420D10
; ---------------------------------------------------------------------------
		align 10h

loc_420D50:				; CODE XREF: sub_420CC0+2Fj
		mov	eax, esi
		mov	edx, ebx
		div	ecx
		xor	ecx, ecx
		mov	esi, eax
		jmp	short loc_420D10
; ---------------------------------------------------------------------------
		align 10h

loc_420D60:				; CODE XREF: sub_420CC0+76j
		mov	eax, 20h
		mov	ecx, ebp
		sub	eax, ebp
		mov	esi, edi
		shl	edx, cl
		mov	ecx, eax
		shr	esi, cl
		mov	ecx, ebp
		or	esi, edx
		mov	edx, ebx
		mov	[esp+2Ch+var_20], esi
		mov	esi, [esp+2Ch+var_24]
		shl	edi, cl
		mov	ecx, eax
		shr	edx, cl
		mov	ecx, ebp
		shl	ebx, cl
		mov	ecx, eax
		shr	esi, cl
		or	esi, ebx
		mov	eax, esi
		div	[esp+2Ch+var_20]
		mov	ebx, edx
		mov	esi, eax
		mul	edi
		cmp	ebx, edx
		jb	short loc_420DAF
		mov	edi, [esp+2Ch+var_24]
		mov	ecx, ebp
		shl	edi, cl
		cmp	edi, eax
		jnb	short loc_420DB2
		cmp	ebx, edx
		jnz	short loc_420DB2

loc_420DAF:				; CODE XREF: sub_420CC0+DDj
		sub	esi, 1

loc_420DB2:				; CODE XREF: sub_420CC0+E9j
					; sub_420CC0+EDj
		xor	ecx, ecx
		jmp	loc_420D10
sub_420CC0	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _getcwd]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fileno]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _close]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _isatty]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _access]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _getpid]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _fdopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _setmode]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _read]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _write]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _dup]
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_420E40
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_420E40	proc near		; CODE XREF: sub_401180+A7p
					; .text:00420E31j

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_420E40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame fpd=222h

sub_420E60	proc near		; CODE XREF: sub_421040+A6p

Size		= dword	ptr -348h
lpFilename	= dword	ptr -344h
nSize		= dword	ptr -340h
uType		= dword	ptr -33Ch
var_338		= dword	ptr -338h
var_334		= dword	ptr -334h
Filename	= byte ptr -327h
var_323		= dword	ptr -323h
var_31F		= word ptr -31Fh
var_223		= byte ptr -223h
var_222		= word ptr -222h
var_11D		= dword	ptr -11Dh
var_119		= dword	ptr -119h
var_115		= word ptr -115h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 33Ch
		mov	esi, [esp+348h+arg_0]
		lea	ebp, [esp+126h]
		mov	ebx, [esp+348h+arg_4]
		mov	[esp+348h+Size], 2000h ; Size
		call	malloc
		test	esi, esi
		lea	ecx, [esi+208h]
		mov	edi, eax
		mov	eax, ebp
		jnz	short loc_420EAC
		jmp	short loc_420EB4
; ---------------------------------------------------------------------------
		align 10h

loc_420EA0:				; CODE XREF: sub_420E60+52j
		add	esi, 2
		mov	[eax], dl
		add	eax, 1
		cmp	esi, ecx
		jz	short loc_420EB4

loc_420EAC:				; CODE XREF: sub_420E60+37j
		movzx	edx, word ptr [esi]
		test	dx, dx
		jnz	short loc_420EA0

loc_420EB4:				; CODE XREF: sub_420E60+39j
					; sub_420E60+4Aj
		lea	esi, [esp+348h+var_11D]
		test	ebx, ebx
		mov	byte ptr [eax],	0
		lea	ecx, [ebx+208h]
		mov	eax, esi
		jnz	short loc_420EDC
		jmp	short loc_420EE4
; ---------------------------------------------------------------------------
		align 10h

loc_420ED0:				; CODE XREF: sub_420E60+82j
		add	ebx, 2
		mov	[eax], dl
		add	eax, 1
		cmp	ebx, ecx
		jz	short loc_420EE4

loc_420EDC:				; CODE XREF: sub_420E60+68j
		movzx	edx, word ptr [ebx]
		test	dx, dx
		jnz	short loc_420ED0

loc_420EE4:				; CODE XREF: sub_420E60+6Aj
					; sub_420E60+7Aj
		mov	byte ptr [eax],	0
		cmp	byte ptr [esp+348h+var_11D], 0
		jz	loc_420FA0
		cmp	byte ptr [esp+348h+var_222], 0
		jz	loc_420FCE

loc_420F03:				; CODE XREF: sub_420E60+168j
					; sub_420E60+178j
		lea	ebx, [esp+348h+Filename]
		mov	[esp+348h+var_223], 0
		mov	[esp+348h+nSize], 104h ; nSize
		mov	[esp+348h+lpFilename], ebx ; lpFilename
		mov	[esp+348h+Size], 0 ; hModule
		call	ds:GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_420FE0

loc_420F33:				; CODE XREF: sub_420E60+197j
		mov	eax, [esp+348h+arg_8]
		mov	[esp+348h+var_334], ebp
		mov	[esp+348h+uType], esi
		mov	[esp+348h+nSize], ebx
		mov	[esp+348h+var_338], eax
		mov	[esp+348h+lpFilename], offset aAssertionFaile ;	"Assertion failed!\n\nProgram: %s\nFile:"...
		mov	[esp+348h+Size], edi ; Dest
		call	sprintf
		mov	eax, ds:dword_428C80
		test	eax, eax
		jz	loc_421019
		mov	[esp+348h+uType], 12012h ; uType
		mov	[esp+348h+nSize], offset Caption ; "MinGW Runtime Assertion"
		mov	[esp+348h+lpFilename], edi ; lpText
		mov	[esp+348h+Size], 0 ; hWnd
		call	ds:MessageBoxA
		sub	esp, 10h
		cmp	eax, 3
		jz	short loc_421001
		cmp	eax, 5
		jnz	short loc_420FFC
		add	esp, 33Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_420FA0:				; CODE XREF: sub_420E60+8Fj
		cmp	byte ptr [esp+348h+var_222], 0
		mov	[esp+348h+var_11D], 6B6E753Ch
		mov	[esp+348h+var_119], 6E776F6Eh
		mov	[esp+348h+var_115], 3Eh
		jnz	loc_420F03

loc_420FCE:				; CODE XREF: sub_420E60+9Dj
		mov	[esp+348h+var_222], 3Fh
		jmp	loc_420F03
; ---------------------------------------------------------------------------
		align 10h

loc_420FE0:				; CODE XREF: sub_420E60+CDj
		mov	dword ptr [esp+348h+Filename], 6B6E753Ch
		mov	[esp+348h+var_323], 6E776F6Eh
		mov	[esp+348h+var_31F], 3Eh
		jmp	loc_420F33
; ---------------------------------------------------------------------------

loc_420FFC:				; CODE XREF: sub_420E60+133j
		call	abort
; ---------------------------------------------------------------------------

loc_421001:				; CODE XREF: sub_420E60+12Ej
		mov	[esp+348h+Size], 16h
		call	raise
		mov	[esp+348h+Size], 3 ; Code
		call	_exit
; ---------------------------------------------------------------------------

loc_421019:				; CODE XREF: sub_420E60+101j
		mov	eax, ds:_iob
		mov	[esp+348h+nSize], edi
		mov	[esp+348h+lpFilename], offset aS_4 ; "%s\n"
		add	eax, 40h
		mov	[esp+348h+Size], eax ; File
		call	fprintf
		call	abort
sub_420E60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_421040(char *, char *, int)
sub_421040	proc near		; CODE XREF: sub_40377D+6B1p
					; sub_408A03+109p ...

Str		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Memory		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [esp+3Ch+arg_0]
		mov	edx, [esp+3Ch+arg_8]
		mov	esi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+Str], edi ; Str
		mov	[esp+3Ch+var_20], edx
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		mov	[esp+3Ch+Str], esi ; Str
		mov	ebx, eax
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		movzx	ecx, byte ptr [edi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_4210A6
		xor	ebp, ebp
		lea	esi, [esi+0]

loc_421090:				; CODE XREF: sub_421040+62j
		add	edx, 1
		movzx	ecx, cl
		mov	[ebx+ebp*2], cx
		movzx	ecx, byte ptr [edi+edx]
		mov	ebp, edx
		test	cl, cl
		jnz	short loc_421090
		add	edx, edx

loc_4210A6:				; CODE XREF: sub_421040+48j
		mov	word ptr [ebx+edx], 0
		movzx	ecx, byte ptr [esi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_4210CD
		xor	edi, edi

loc_4210B7:				; CODE XREF: sub_421040+89j
		add	edx, 1
		movzx	ecx, cl
		mov	[eax+edi*2], cx
		movzx	ecx, byte ptr [esi+edx]
		mov	edi, edx
		test	cl, cl
		jnz	short loc_4210B7
		add	edx, edx

loc_4210CD:				; CODE XREF: sub_421040+73j
		mov	word ptr [eax+edx], 0
		mov	edx, [esp+3Ch+var_20]
		mov	[esp+3Ch+var_38], eax
		mov	[esp+3Ch+Memory], eax
		mov	[esp+3Ch+Str], ebx
		mov	[esp+3Ch+var_34], edx
		call	sub_420E60
		mov	[esp+3Ch+Str], ebx ; Memory
		call	free
		mov	eax, [esp+3Ch+Memory]
		mov	[esp+3Ch+arg_0], eax ; Memory
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		jmp	free
sub_421040	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_421110	proc near		; CODE XREF: .text:0040B9C4p
					; sub_41A26E+9Cp
		jmp	sub_421770
sub_421110	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000005 BYTES: COLLAPSED FUNCTION j__lseeki64]
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_421130(FILE *)
sub_421130	proc near		; CODE XREF: .text:0042163Bp

File		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 2Ch
		mov	[esp+2Ch+var_C], ebx
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_8], esi
		mov	[esp+2Ch+var_4], edi
		mov	eax, [ebx+0Ch]
		mov	edx, eax
		and	edx, 3
		cmp	edx, 2
		jz	short loc_421170

loc_421150:				; CODE XREF: sub_421130+94j
					; sub_421130+9Cj
		mov	edi, [ebx+8]
		xor	eax, eax

loc_421155:				; CODE XREF: sub_421130+A7j
					; sub_421130+BCj
		mov	[ebx], edi
		mov	esi, [esp+2Ch+var_8]
		mov	dword ptr [ebx+4], 0
		mov	edi, [esp+2Ch+var_4]
		mov	ebx, [esp+2Ch+var_C]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_421170:				; CODE XREF: sub_421130+1Ej
		test	eax, 108h
		mov	edi, [ebx+8]
		jz	short loc_4211D5
		mov	esi, [ebx]
		sub	esi, edi
		mov	eax, esi
		sar	eax, 1Fh
		mov	[esp+2Ch+var_10], eax
		cmp	[esp+2Ch+var_10], 0
		mov	[esp+2Ch+var_14], esi
		jl	short loc_4211D5
		jle	short loc_4211D0

loc_421194:				; CODE XREF: sub_421130+A3j
		mov	[esp+2Ch+File],	ebx ; File
		call	_fileno_0
		mov	[esp+2Ch+var_24], esi
		mov	[esp+2Ch+var_28], edi
		mov	[esp+2Ch+File],	eax
		call	_write_0
		mov	ecx, eax
		mov	edx, eax
		mov	eax, [esp+2Ch+var_10]
		sar	edx, 1Fh
		xor	esi, ecx
		xor	eax, edx
		or	eax, esi
		jnz	short loc_4211E0
		mov	eax, [ebx+0Ch]
		test	al, 80h
		jz	short loc_421150
		and	eax, 0FFFFFFFDh
		mov	[ebx+0Ch], eax
		jmp	short loc_421150
; ---------------------------------------------------------------------------
		align 10h

loc_4211D0:				; CODE XREF: sub_421130+62j
		cmp	esi, 0
		ja	short loc_421194

loc_4211D5:				; CODE XREF: sub_421130+48j
					; sub_421130+60j
		xor	eax, eax
		jmp	loc_421155
; ---------------------------------------------------------------------------
		align 10h

loc_4211E0:				; CODE XREF: sub_421130+8Dj
		or	dword ptr [ebx+0Ch], 20h
		mov	eax, 0FFFFFFFFh
		mov	edi, [ebx+8]
		jmp	loc_421155
sub_421130	endp

; ---------------------------------------------------------------------------
		jmp	short sub_421200
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_421200(FILE *, int, int, int)
sub_421200	proc near		; CODE XREF: .text:00417C36p
					; .text:004211F1j

File		= dword	ptr -3Ch
Pos		= dword	ptr -38h
var_24		= qword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 3Ch
		mov	eax, [esp+3Ch+arg_C]
		mov	[esp+3Ch+var_C], esi
		mov	esi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+var_8], edi
		mov	edi, [esp+3Ch+arg_8]
		mov	[esp+3Ch+var_4], ebp
		mov	ebp, [esp+3Ch+arg_0]
		cmp	eax, 1
		mov	[esp+3Ch+var_10], ebx
		jz	short loc_421260
		cmp	eax, 2
		jz	short loc_421285
		test	eax, eax
		jnz	short loc_4212B0
		mov	dword ptr [esp+3Ch+var_24], esi
		lea	ebx, [esp+3Ch+var_24]
		mov	dword ptr [esp+3Ch+var_24+4], edi

loc_42123D:				; CODE XREF: sub_421200+83j
					; sub_421200+ADj
		mov	[esp+3Ch+Pos], ebx ; Pos
		mov	[esp+3Ch+File],	ebp ; File
		call	fsetpos

loc_421249:				; CODE XREF: sub_421200+79j
					; sub_421200+C0j
		mov	ebx, [esp+3Ch+var_10]
		mov	esi, [esp+3Ch+var_C]
		mov	edi, [esp+3Ch+var_8]
		mov	ebp, [esp+3Ch+var_4]
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_421260:				; CODE XREF: sub_421200+26j
		lea	ebx, [esp+3Ch+var_24]
		mov	[esp+3Ch+Pos], ebx ; Pos
		mov	[esp+3Ch+File],	ebp ; File
		call	fgetpos
		mov	edx, eax
		mov	eax, 0FFFFFFFFh
		test	edx, edx
		jnz	short loc_421249
		add	dword ptr [esp+3Ch+var_24], esi
		adc	dword ptr [esp+3Ch+var_24+4], edi
		jmp	short loc_42123D
; ---------------------------------------------------------------------------

loc_421285:				; CODE XREF: sub_421200+2Bj
		mov	[esp+3Ch+File],	ebp ; File
		lea	ebx, [esp+3Ch+var_24]
		call	fflush
		mov	[esp+3Ch+File],	ebp ; File
		call	_fileno_0
		mov	[esp+3Ch+File],	eax
		call	_filelengthi64
		add	eax, esi
		adc	edx, edi
		mov	dword ptr [esp+3Ch+var_24], eax
		mov	dword ptr [esp+3Ch+var_24+4], edx
		jmp	short loc_42123D
; ---------------------------------------------------------------------------
		align 10h

loc_4212B0:				; CODE XREF: sub_421200+2Fj
		call	_errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short loc_421249
sub_421200	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4212D0(FILE *)
sub_4212D0	proc near		; CODE XREF: .text:004216A4p

File		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 5Ch
		mov	[esp+5Ch+var_10], ebx
		mov	ebx, [esp+5Ch+arg_0]
		mov	[esp+5Ch+var_C], esi
		mov	[esp+5Ch+var_8], edi
		mov	[esp+5Ch+var_4], ebp
		call	_errno
		mov	dword ptr [eax], 0
		mov	[esp+5Ch+File],	ebx ; File
		call	_fileno_0
		mov	[esp+5Ch+var_3C], eax
		mov	eax, [ebx+4]
		test	eax, eax
		js	loc_421490

loc_421309:				; CODE XREF: sub_4212D0+1C7j
		mov	eax, [esp+5Ch+var_3C]
		mov	[esp+5Ch+var_50], 1
		mov	[esp+5Ch+var_58], 0
		mov	[esp+5Ch+var_54], 0
		mov	[esp+5Ch+File],	eax
		call	_lseeki64
		test	edx, edx
		mov	esi, eax
		mov	edi, edx
		js	loc_4214B4
		mov	ecx, [ebx+0Ch]
		test	ecx, 108h
		jz	loc_421464
		mov	eax, [ebx]
		mov	[esp+5Ch+var_34], eax
		mov	eax, [ebx+8]
		mov	edx, [esp+5Ch+var_34]
		sub	edx, eax
		test	cl, 3
		mov	[esp+5Ch+var_28], edx
		jnz	loc_4213F5
		test	cl, 80h
		jz	loc_4215B0
		mov	ebp, [esp+5Ch+var_28]

loc_421371:				; CODE XREF: sub_4212D0+156j
					; sub_4212D0+160j ...
		mov	eax, edi
		or	eax, esi
		jz	loc_4214A0
		and	ecx, 1
		jz	loc_4214A6
		mov	eax, [ebx+4]
		xor	edx, edx
		xor	ecx, ecx
		mov	[esp+5Ch+var_34], 0
		mov	[esp+5Ch+var_30], 0
		test	eax, eax
		jz	short loc_4213E8
		mov	ecx, [esp+5Ch+var_28]
		mov	edx, [esp+5Ch+var_3C]
		add	ecx, eax
		mov	eax, [esp+5Ch+var_3C]
		sar	edx, 5
		mov	[esp+5Ch+var_28], edx
		and	eax, 1Fh
		lea	eax, [eax+eax*4]
		shl	eax, 3
		mov	[esp+5Ch+var_34], eax
		mov	eax, ds:__pioinfo
		mov	eax, [eax+edx*4]
		mov	edx, [esp+5Ch+var_34]
		cmp	byte ptr [eax+edx+4], 0
		js	loc_4214C0

loc_4213D8:				; CODE XREF: sub_4212D0+255j
		mov	[esp+5Ch+var_34], ecx
		mov	edx, ebp
		xor	ecx, ecx
		mov	[esp+5Ch+var_30], 0

loc_4213E8:				; CODE XREF: sub_4212D0+CDj
					; sub_4212D0+26Ej ...
		sub	esi, [esp+5Ch+var_34]
		sbb	edi, [esp+5Ch+var_30]
		jmp	loc_4214AA
; ---------------------------------------------------------------------------

loc_4213F5:				; CODE XREF: sub_4212D0+8Ej
		mov	edx, [esp+5Ch+var_3C]
		mov	ebp, [esp+5Ch+var_3C]
		and	edx, 1Fh
		lea	edx, [edx+edx*4]
		shl	edx, 3
		mov	[esp+5Ch+var_24], edx
		mov	edx, ds:__pioinfo
		sar	ebp, 5
		mov	edx, [edx+ebp*4]
		add	[esp+5Ch+var_24], edx
		mov	edx, [esp+5Ch+var_24]
		mov	ebp, [esp+5Ch+var_28]
		cmp	byte ptr [edx+4], 0
		jns	loc_421371
		cmp	[esp+5Ch+var_34], eax
		jbe	loc_421371
		mov	[esp+5Ch+var_24], esi
		mov	esi, ecx
		mov	ecx, [esp+5Ch+var_34]
		mov	[esp+5Ch+var_20], edi

loc_421444:				; CODE XREF: sub_4212D0+183j
		xor	edx, edx
		cmp	byte ptr [eax],	0Ah
		setz	dl
		add	eax, 1
		add	ebp, edx
		cmp	eax, ecx
		jnz	short loc_421444
		mov	ecx, esi
		mov	edi, [esp+5Ch+var_20]
		mov	esi, [esp+5Ch+var_24]
		jmp	loc_421371
; ---------------------------------------------------------------------------

loc_421464:				; CODE XREF: sub_4212D0+72j
		mov	eax, [ebx+4]
		mov	ecx, esi
		mov	ebx, edi
		mov	edx, eax
		sar	edx, 1Fh
		sub	ecx, eax
		sbb	ebx, edx
		mov	eax, ecx
		mov	edx, ebx

loc_421478:				; CODE XREF: sub_4212D0+1D4j
					; sub_4212D0+1E2j ...
		mov	ebx, [esp+5Ch+var_10]
		mov	esi, [esp+5Ch+var_C]
		mov	edi, [esp+5Ch+var_8]
		mov	ebp, [esp+5Ch+var_4]
		add	esp, 5Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_421490:				; CODE XREF: sub_4212D0+33j
		mov	dword ptr [ebx+4], 0
		jmp	loc_421309
; ---------------------------------------------------------------------------
		align 10h

loc_4214A0:				; CODE XREF: sub_4212D0+A5j
		mov	eax, ebp
		xor	edx, edx
		jmp	short loc_421478
; ---------------------------------------------------------------------------

loc_4214A6:				; CODE XREF: sub_4212D0+AEj
		mov	edx, ebp
		xor	ecx, ecx

loc_4214AA:				; CODE XREF: sub_4212D0+120j
		mov	eax, edx
		mov	edx, ecx
		add	eax, esi
		adc	edx, edi
		jmp	short loc_421478
; ---------------------------------------------------------------------------

loc_4214B4:				; CODE XREF: sub_4212D0+63j
		mov	eax, 0FFFFFFFFh
		mov	edx, 0FFFFFFFFh
		jmp	short loc_421478
; ---------------------------------------------------------------------------

loc_4214C0:				; CODE XREF: sub_4212D0+102j
		mov	eax, [esp+5Ch+var_3C]
		mov	[esp+5Ch+var_40], ecx
		mov	[esp+5Ch+var_50], 2
		mov	[esp+5Ch+var_58], 0
		mov	[esp+5Ch+var_54], 0
		mov	[esp+5Ch+File],	eax
		call	_lseeki64
		mov	ecx, [esp+5Ch+var_40]
		xor	edx, edi
		xor	eax, esi
		or	edx, eax
		jnz	short loc_421543
		mov	edx, [ebx+8]
		lea	eax, [edx+ecx]
		cmp	edx, eax
		jnb	short loc_421521
		mov	[esp+5Ch+var_3C], esi
		mov	esi, eax
		mov	[esp+5Ch+var_38], edi

loc_421508:				; CODE XREF: sub_4212D0+247j
		xor	eax, eax
		cmp	byte ptr [edx],	0Ah
		setz	al
		add	edx, 1
		add	ecx, eax
		cmp	edx, esi
		jnz	short loc_421508
		mov	esi, [esp+5Ch+var_3C]
		mov	edi, [esp+5Ch+var_38]

loc_421521:				; CODE XREF: sub_4212D0+22Cj
		test	byte ptr [ebx+0Dh], 20h
		jz	loc_4213D8
		lea	eax, [ecx+1]
		mov	edx, ebp
		mov	[esp+5Ch+var_34], eax
		xor	ecx, ecx
		mov	[esp+5Ch+var_30], 0
		jmp	loc_4213E8
; ---------------------------------------------------------------------------

loc_421543:				; CODE XREF: sub_4212D0+222j
		mov	eax, [esp+5Ch+var_3C]
		mov	[esp+5Ch+var_40], ecx
		mov	[esp+5Ch+var_50], 0
		mov	[esp+5Ch+var_58], esi
		mov	[esp+5Ch+var_54], edi
		mov	[esp+5Ch+File],	eax
		call	_lseeki64
		mov	ecx, [esp+5Ch+var_40]
		cmp	ecx, 200h
		ja	short loc_421581
		mov	eax, [ebx+0Ch]
		mov	edx, 200h
		and	eax, 408h
		cmp	eax, 8
		jz	short loc_421584

loc_421581:				; CODE XREF: sub_4212D0+29Dj
		mov	edx, [ebx+18h]

loc_421584:				; CODE XREF: sub_4212D0+2AFj
		mov	eax, ds:__pioinfo
		mov	ecx, [esp+5Ch+var_28]
		mov	ebx, [esp+5Ch+var_34]
		mov	eax, [eax+ecx*4]
		test	byte ptr [eax+ebx+4], 4
		jnz	short loc_4215CA
		mov	[esp+5Ch+var_34], edx
		xor	ecx, ecx
		mov	edx, ebp
		mov	[esp+5Ch+var_30], 0
		jmp	loc_4213E8
; ---------------------------------------------------------------------------

loc_4215B0:				; CODE XREF: sub_4212D0+97j
		call	_errno
		mov	edx, 0FFFFFFFFh
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	loc_421478
; ---------------------------------------------------------------------------

loc_4215CA:				; CODE XREF: sub_4212D0+2C9j
		lea	eax, [edx+1]
		xor	ecx, ecx
		mov	[esp+5Ch+var_34], eax
		mov	edx, ebp
		mov	[esp+5Ch+var_30], 0
		jmp	loc_4213E8
sub_4212D0	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 2Ch
		mov	[esp+1Ch], ebx
		mov	ebx, [esp+30h]
		mov	[esp+20h], esi
		mov	esi, [esp+3Ch]
		mov	[esp+24h], edi
		mov	edi, [esp+34h]
		mov	[esp+28h], ebp
		mov	ebp, [esp+38h]
		call	_errno
		cmp	esi, 2
		mov	dword ptr [eax], 0
		ja	loc_4216B5
		test	ebx, ebx
		jz	loc_4216B5
		and	dword ptr [ebx+0Ch], 0FFFFFFEFh
		cmp	esi, 1
		jz	short loc_4216A1

loc_421638:				; CODE XREF: .text:004216B0j
		mov	[esp], ebx
		call	sub_421130
		mov	eax, [ebx+0Ch]
		test	al, 80h
		jnz	short loc_421690
		and	eax, 409h
		cmp	eax, 9
		jz	short loc_421698

loc_421651:				; CODE XREF: .text:00421696j
					; .text:0042169Fj
		mov	[esp], ebx
		call	_fileno_0
		mov	[esp+0Ch], esi
		mov	[esp+4], edi
		mov	[esp+8], ebp
		mov	[esp], eax
		call	_lseeki64
		and	eax, edx
		not	eax
		cmp	eax, 1
		sbb	eax, eax

loc_421676:				; CODE XREF: .text:004216C5j
		mov	ebx, [esp+1Ch]
		mov	esi, [esp+20h]
		mov	edi, [esp+24h]
		mov	ebp, [esp+28h]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_421690:				; CODE XREF: .text:00421645j
		and	eax, 0FFFFFFFCh
		mov	[ebx+0Ch], eax
		jmp	short loc_421651
; ---------------------------------------------------------------------------

loc_421698:				; CODE XREF: .text:0042164Fj
		mov	dword ptr [ebx+18h], 200h
		jmp	short loc_421651
; ---------------------------------------------------------------------------

loc_4216A1:				; CODE XREF: .text:00421636j
		mov	[esp], ebx
		call	sub_4212D0
		add	edi, eax
		adc	ebp, edx
		xor	si, si
		jmp	loc_421638
; ---------------------------------------------------------------------------

loc_4216B5:				; CODE XREF: .text:00421621j
					; .text:00421629j
		call	_errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short loc_421676
; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 4
		mov	esi, [esp+10h]
		call	__doserrno
		mov	[eax], esi
		jmp	short loc_4216F1
; ---------------------------------------------------------------------------

loc_4216E4:				; CODE XREF: .text:004216F8j
		add	ebx, 1
		cmp	ds:dword_427904[ebx*8],	0FFFFFFFFh
		jz	short loc_421710

loc_4216F1:				; CODE XREF: .text:004216E2j
		cmp	ds:dword_427900[ebx*8],	esi
		jnz	short loc_4216E4
		call	_errno
		mov	edx, ds:dword_427904[ebx*8]
		mov	[eax], edx
		add	esp, 4
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_421710:				; CODE XREF: .text:004216EFj
		lea	eax, [esi-13h]
		cmp	eax, 11h
		jbe	short loc_421745
		sub	esi, 0BCh
		cmp	esi, 0Eh
		jbe	short loc_421734
		call	_errno
		mov	dword ptr [eax], 16h
		add	esp, 4
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_421734:				; CODE XREF: .text:00421721j
		call	_errno
		mov	dword ptr [eax], 8
		add	esp, 4
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_421745:				; CODE XREF: .text:00421716j
		call	_errno
		mov	dword ptr [eax], 0Dh
		add	esp, 4
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_421760	proc near		; CODE XREF: sub_41A26E+AAp
		jmp	sub_421780
sub_421760	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_421770	proc near		; CODE XREF: sub_421110j
		mov	eax, ds:time
		jmp	eax
sub_421770	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_421780	proc near		; CODE XREF: sub_421760j
		mov	eax, ds:localtime
		jmp	eax
sub_421780	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __getmainargs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __set_app_type]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _cexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _errno]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcmp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcpy]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION getenv]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strtol]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strerror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memmove]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION printf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fclose]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION atoi]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strtoul]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memchr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION puts]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fread]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ferror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION putchar]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION putc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION realloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memset]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION sprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strrchr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION getc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strpbrk]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fflush]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION rewind]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION setlocale]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fseek]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ftell]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcmp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcspn]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION remove]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION clearerr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION setvbuf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncpy]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fputs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strstr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION signal]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __setusermatherr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION raise]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _lseeki64]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _fileno_0]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _write_0]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fsetpos]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fgetpos]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _filelengthi64]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __doserrno]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4219B0	proc near		; DATA XREF: .text:004219D4o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4014F0
		mov	[esp+18h+var_18], offset sub_401540 ; _onexit_t
		call	sub_41FB70
		leave
		retn
sub_4219B0	endp

; ---------------------------------------------------------------------------
		align 10h
dword_4219D0	dd 0FFFFFFFFh		; DATA XREF: sub_420790-4Cr
					; sub_420790:loc_420753r ...
		dd offset sub_4219B0
		dd 0
		dd 0FFFFFFFFh
dword_4219E0	dd 8 dup(0)		; DATA XREF: .data:off_422184o
		dd 180h	dup(?)
_text		ends

; Section 2. (virtual address 00022000)
; Virtual size			: 0000019C (	412.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00020E00
; Flags	C0600040: Data Readable	Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 422000h
dword_422000	dd 12Dh, 2 dup(0)	; DATA XREF: sub_40377D+1EFo
		dd offset a@Options	; "@\nOptions:\n "
		dd 76h,	423051h, 0
		dd offset aVerbose	; "verbose"
		dd 71h,	423059h, 0
		dd offset aQuiet	; "quiet"
		dd 1F6h, 42305Fh, 0
		dd offset aPrintDataOutHe ; "print data	out hex	encoded"
		dd 1F7h, 42307Eh, 0
		dd offset aDecodeReceived ; "decode received data lines"
		dd 53h,	4230A0h, 2, 4230ACh, 45h, 4230D0h, 0
		dd offset aRunTheAssuanSe ; "run the Assuan server given on the	comm"...
		dd 1F8h, 423108h, 0
		dd offset aDoNotUseExtend ; "do	not use	extended connect mode"
		dd 72h,	423139h, 2, 423140h, 73h, 423168h, 0
		dd offset aRunSubstOnStar ; "run /subst	on startup"
		dd 1F4h, 423184h, 0
		dd offset a@		; "@"
		dd 1F5h, 423191h, 2, 42318Fh, 4	dup(0)
off_4220D0	dd offset dword_428020	; DATA XREF: sub_402E12+FBr
					; sub_402E12+108w ...
; DWORD	dwProcessId
dwProcessId	dd 0FFFFFFFFh		; DATA XREF: sub_402175+29Ar
					; sub_4031FB+6r ...
		align 10h
; LPCSTR off_4220E0
off_4220E0	dd offset aShell32_dll	; DATA XREF: sub_409A09+30r
					; sub_409A09+90r
					; "shell32.dll"
		dd offset aShfolder_dll	; "shfolder.dll"
		align 20h
off_422100	dd offset aGpg_tty	; DATA XREF: sub_40CFE9+46r
					; "GPG_TTY"
off_422104	dd offset aTtyname	; DATA XREF: sub_40CFE9+37r
					; "ttyname"
		dd offset aTerm		; "TERM"
		dd offset aTtytype	; "ttytype"
		dd offset aDisplay	; "DISPLAY"
		dd offset aDisplay_0	; "display"
		dd offset aXauthority	; "XAUTHORITY"
		dd offset aXauthority_0	; "xauthority"
		dd offset aXmodifiers	; "XMODIFIERS"
		align 8
		dd offset aGtk_im_module ; "GTK_IM_MODULE"
		align 10h
		dd offset aQt_im_module	; "QT_IM_MODULE"
		align 8
		dd offset aPinentry_user_ ; "PINENTRY_USER_DATA"
		dd offset aPinentryUserDa ; "pinentry-user-data"
off_422140	dd offset sub_40E7DB	; DATA XREF: sub_410472+8Er
					; .text:00410CEDr ...
off_422144	dd offset sub_40E85B	; DATA XREF: sub_410472+98r
					; .text:00410CF7r ...
off_422148	dd offset sub_40EADF	; DATA XREF: sub_410472+A2r
					; .text:00410D01r ...
off_42214C	dd offset sub_40ED64	; DATA XREF: sub_410472+ACr
					; .text:00410D0Br ...
off_422150	dd offset sub_40EE01	; DATA XREF: .text:00410BB2r
					; sub_410FD8+7Br ...
off_422154	dd offset sub_40EE57	; DATA XREF: .text:00410BBCr
					; sub_410FD8+85r ...
off_422158	dd offset sub_40EEAC	; DATA XREF: .text:00410BC6r
					; sub_410FD8+8Fr ...
off_42215C	dd offset sub_40EF3E	; DATA XREF: .text:00410BD0r
					; .text:00410C32r ...
off_422160	dd offset sub_40F00D	; DATA XREF: sub_41110D+A5r
off_422164	dd offset sub_40F074	; DATA XREF: sub_41110D+AFr
off_422168	dd offset sub_40F0CB	; DATA XREF: sub_41110D+B9r
off_42216C	dd offset sub_40F155	; DATA XREF: sub_41110D+C3r
					; sub_41110D+F5r
dword_422170	dd 0FFFFFFFFh		; DATA XREF: sub_419E4D:loc_419FD3w
					; .text:loc_41A207r ...
; char off_422174[]
off_422174	dd offset aIso88591	; DATA XREF: sub_41E950+D9w
					; sub_41EA4F:loc_41EC24w ...
					; "iso-8859-1"
		dd 0FFh, 2 dup(0FFFFFFFFh)
off_422184	dd offset dword_4219E0	; DATA XREF: sub_420710+3r
					; sub_420710+12r ...
dword_422188	dd 2			; DATA XREF: TlsCallback_0+13r
					; TlsCallback_0+1Cw ...
dword_42218C	dd 0FFFFFFFFh		; DATA XREF: sub_401060+7Ar
dword_422190	dd 0BB40E64Eh		; DATA XREF: sub_4207B0+3r
					; sub_4207B0:loc_420862w ...
dword_422194	dd 44BF19B1h		; DATA XREF: sub_4207B0+31w
					; sub_4207B0+B8w ...
dword_422198	dd 0			; DATA XREF: sub_4014F0+6r
					; sub_4014F0+42o
		align 1000h
_data		ends

; Section 3. (virtual address 00023000)
; Virtual size			: 00004A80 (  19072.)
; Section size in file		: 00004C00 (  19456.)
; Offset to raw	data for section: 00021000
; Flags	40600040: Data Readable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment '32byte' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 423000h
; CHAR ProcName[]
ProcName	db '_set_invalid_parameter_handler',0 ; DATA XREF: sub_401180+137o
		align 10h
; CHAR ModuleName[]
ModuleName	db 'libgcj-12.dll',0    ; DATA XREF: sub_4014F0+Fo
; CHAR a_jv_registercl[]
a_jv_registercl	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_4014F0+28o
		align 4
a@Options	db '@',0Ah              ; DATA XREF: .data:0042200Co
		db 'Options:',0Ah
		db ' ',0
aVerbose	db 'verbose',0          ; DATA XREF: .data:0042201Co
aQuiet		db 'quiet',0            ; DATA XREF: .data:0042202Co
; char aHex[4]
aHex		db 'hex',0              ; DATA XREF: sub_40377D:loc_404E43o
aPrintDataOutHe	db 'print data out hex encoded',0 ; DATA XREF: .data:0042203Co
; char aDecode[]
aDecode		db 'decode',0           ; DATA XREF: sub_40377D:loc_404E97o
aDecodeReceived	db 'decode received data lines',0 ; DATA XREF: .data:0042204Co
aRawSocket_0	db 'raw-socket',0
		align 4
aNameConnectToA	db '|NAME|connect to Assuan socket NAME',0
aExec_0		db 'exec',0
		align 4
aRunTheAssuanSe	db 'run the Assuan server given on the command line',0
					; DATA XREF: .data:0042206Co
aNoExtConnect	db 'no-ext-connect',0
		align 4
aDoNotUseExtend	db 'do not use extended connect mode',0 ; DATA XREF: .data:0042207Co
; char aRun[4]
aRun		db 'run',0              ; DATA XREF: sub_40377D:loc_404F49o
		align 10h
aFileRunCommand	db '|FILE|run commands from FILE on startup',0
; char aSubst[]
aSubst		db 'subst',0            ; DATA XREF: sub_40377D:loc_404EEBo
aRunSubstOnStar	db 'run /subst on startup',0 ; DATA XREF: .data:0042209Co
aNoVerbose	db 'no-verbose',0
a@		db '@',0                ; DATA XREF: .data:004220ACo
; char aHomedir[]
aHomedir	db 'homedir',0          ; DATA XREF: sub_402175:loc_4022E8o
aGpgConnectAgen	db 'gpg-connect-agent (GnuPG)',0 ; DATA XREF: sub_4015CF:loc_4015EAo
a2_0_30		db '2.0.30',0           ; DATA XREF: sub_4015CF:loc_4015F3o
aMingw32	db 'MingW32',0          ; DATA XREF: sub_4015CF:loc_4015FCo
		align 4
; char aPleaseReportBu[]
aPleaseReportBu	db 'Please report bugs to <@EMAIL@>.',0Ah,0
					; DATA XREF: sub_4015CF:loc_401605o
		align 4
; char aUsageGpgConnec[]
aUsageGpgConnec	db 'Usage: gpg-connect-agent [options] (-h for help)',0
					; DATA XREF: sub_4015CF:loc_401616o
		align 4
; char aSyntaxGpgConne[]
aSyntaxGpgConne	db 'Syntax: gpg-connect-agent [options]',0Ah
					; DATA XREF: sub_4015CF:loc_401627o
		db 'Connect to a running agent and send commands',0Ah,0
aHome		db 0Ah			; DATA XREF: sub_4015CF:loc_401638o
		db 'Home: ',0
asc_423276	db 0Ah,0		; DATA XREF: sub_4015CF:loc_40164Bo
off_423278	dd offset loc_401654	; DATA XREF: sub_4015CF+12o
		dd offset loc_401616	; jump table for switch	statement
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_4015EA
		dd offset loc_401654
		dd offset loc_4015F3
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_4015FC
		dd offset loc_401654
		dd offset loc_401605
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401638
		dd offset loc_401641
		dd offset loc_40164B
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401654
		dd offset loc_401616
		dd offset loc_401627
off_423320	dd offset loc_401709, offset loc_4017DE, offset	loc_4017DE
					; DATA XREF: sub_4016C2+3Er
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_401709 ; jump table	for switch statement
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_401709, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_401709, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_401709
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_401709, offset	loc_4017DE
		dd offset loc_4017DE, offset loc_4017DE, offset	loc_401709
		dd offset loc_4017DE, offset loc_401709, offset	loc_4017DE
		dd offset loc_401709, offset loc_4017DE, offset	loc_401712
off_42347C	dd offset loc_401927, offset loc_401AC5, offset	loc_401AC5
					; DATA XREF: sub_4016C2+202r
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401936 ; jump table	for switch statement
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_401945, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_4018CD, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401909
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_4018FA, offset	loc_401AC5
		dd offset loc_401AC5, offset loc_401AC5, offset	loc_401918
		dd offset loc_401AC5, offset loc_4018DC, offset	loc_401AC5
		dd offset loc_4018EB, offset loc_401AC5, offset	loc_401954
byte_4235D8	db 25h,	64h, 0		; DATA XREF: sub_401E48+Do
					; sub_402175+2A3o ...
byte_4235DB	db 0			; DATA XREF: sub_401E84+10o
					; sub_40284F+1DAo ...
; char aUnknownArithme[]
aUnknownArithme	db 'unknown arithmetic operator `%c',27h,0Ah,0 ; DATA XREF: sub_401F1C+205o
aLd		db '%ld',0              ; DATA XREF: sub_401F1C+231o
; char aVariablesNeste[]
aVariablesNeste	db 'variables nested too deeply',0Ah,0 ; DATA XREF: sub_402175+1Ao
aGet		db 'get',0              ; DATA XREF: sub_402175+E3o
; char Str2[]
Str2		db 'cwd',0              ; DATA XREF: sub_402175+124o
; char aGetcwdFailedS[]
aGetcwdFailedS	db 'getcwd failed: %s',0Ah,0 ; DATA XREF: sub_402175+162o
; char aSysconfdir[]
aSysconfdir	db 'sysconfdir',0       ; DATA XREF: sub_402175:loc_40231Co
; char aBindir[]
aBindir		db 'bindir',0           ; DATA XREF: sub_402175:loc_402348o
; char aLibdir[]
aLibdir		db 'libdir',0           ; DATA XREF: sub_402175:loc_402374o
; char aLibexecdir[]
aLibexecdir	db 'libexecdir',0       ; DATA XREF: sub_402175:loc_4023A0o
; char aDatadir[]
aDatadir	db 'datadir',0          ; DATA XREF: sub_402175:loc_4023CCo
; char aServerpid[]
aServerpid	db 'serverpid',0        ; DATA XREF: sub_402175:loc_4023F8o
					; sub_40377D:loc_404E14o
; char aInvalidArgumen[]
aInvalidArgumen	db 'invalid argument `%s',27h,' for variable function `get',27h,0Ah,0
					; DATA XREF: sub_402175+2BEo
		align 4
; char aValidAreCwdHom[]
aValidAreCwdHom	db 'valid are: cwd, {home,bin,lib,libexec,data}dir, serverpid',0Ah,0
					; DATA XREF: sub_402175+2CAo
aUnescape	db 'unescape',0         ; DATA XREF: sub_402175+2F8o
aUnpercent	db 'unpercent',0        ; DATA XREF: sub_402175+348o
aUnpercent_0	db 'unpercent+',0       ; DATA XREF: sub_402175+3A0o
aPercent	db 'percent',0          ; DATA XREF: sub_402175+3F8o
; char byte_423705[]
byte_423705	db 2Bh,	9, 0Dh		; DATA XREF: sub_402175+41Fo
					; sub_402175+477o
		dd 0B0C0Ah
aPercent_0	db 'percent+',0         ; DATA XREF: sub_402175+450o
aErrcode	db 'errcode',0          ; DATA XREF: sub_402175+4CEo
aErrsource	db 'errsource',0        ; DATA XREF: sub_402175+54Co
aErrstring	db 'errstring',0        ; DATA XREF: sub_402175+5CAo
aSS		db '%s <%s>',0          ; DATA XREF: sub_402175+62Fo
; char Str[]
Str		db '+-*/%!|&',0         ; DATA XREF: sub_402175+65Eo
		align 4
; char aUnknownVariabl[]
aUnknownVariabl	db 'unknown variable function `%.*s',27h,0Ah,0 ; DATA XREF: sub_402175+6A1o
; char Format[]
Format		db '%-20s %s',0Ah,0     ; DATA XREF: sub_402DC7+26o
; char asc_423770[]
asc_423770	db '*',0                ; DATA XREF: sub_402E12+BCo
					; sub_402F25+C3o
; char a20sCS[]
a20sCS		db '%-20s %c %s',0Ah,0  ; DATA XREF: sub_402F25+4Eo
					; sub_402F25:loc_402FDBo
; char Mode[]
Mode		db 'r',0                ; DATA XREF: sub_403058+77o
					; sub_4031FB+FFo ...
		align 4
; char aCanTOpenSInSMo[]
aCanTOpenSInSMo	db 'can',27h,'t open `%s',27h,' in "%s" mode: %s',0Ah,0
					; DATA XREF: sub_403058+FCo
					; sub_4031FB+184o
		align 4
; char aFileSOpenedInS[]
aFileSOpenedInS	db 'file `%s',27h,' opened in "%s" mode, fd=%d',0Ah,0
					; DATA XREF: sub_403058+139o
		align 10h
; char aSendingDescrip[]
aSendingDescrip	db 'sending descriptor %d failed: %s',0Ah,0 ; DATA XREF: sub_403058+176o
		align 4
; char aThisCommandHas[]
aThisCommandHas	db 'This command has not yet been implemented',0Ah,0
					; DATA XREF: sub_4031E7+6o
		align 10h
; char aThePidOfTheSer[]
aThePidOfTheSer	db 'the pid of the server is unknown',0Ah,0 ; DATA XREF: sub_4031FB+10o
		align 4
; char aUseCommandServ[]
aUseCommandServ	db 'use command "/serverpid" first',0Ah,0 ; DATA XREF: sub_4031FB+1Co
; char aFailedToOpenTh[]
aFailedToOpenTh	db 'failed to open the server process',0Ah,0 ; DATA XREF: sub_4031FB+204o
		align 4
; char aFailedToDuplic[]
aFailedToDuplic	db 'failed to duplicate the handle',0Ah,0 ; DATA XREF: sub_4031FB+265o
; char aFileSOpenedI_0[]
aFileSOpenedI_0	db 'file `%s',27h,' opened in "%s" mode, fd=%d  (libc=%d)',0Ah,0
					; DATA XREF: sub_4031FB+2DAo
; char aCanTPutFdDInto[]
aCanTPutFdDInto	db 'can',27h,'t put fd %d into table',0Ah,0 ; DATA XREF: sub_4031FB+308o
		align 4
; char aGivenFdSystemH[]
aGivenFdSystemH	db 'given fd (system handle) has not been opened',0Ah,0
					; DATA XREF: sub_40351C:loc_403581o
; char aInvalidFd[]
aInvalidFd	db 'invalid fd',0Ah,0   ; DATA XREF: sub_40351C:loc_403599o
; char aGivenFdHasNotB[]
aGivenFdHasNotB	db 'given fd has not been opened',0Ah,0 ; DATA XREF: sub_40351C+99o
; char a15dLibcD[]
a15dLibcD	db '%-15d (libc=%d)',0Ah,0 ; DATA XREF: sub_4035F5+29o
aGetinfoPid	db 'GETINFO pid',0      ; DATA XREF: sub_403672+48o
					; sub_403672+AAo
; char aCommandSFailed[]
aCommandSFailed	db 'command "%s" failed: %s',0Ah,0 ; DATA XREF: sub_403672+B2o
; char aServerSPidIsLu[]
aServerSPidIsLu	db 'server',27h,'s PID is %lu',0Ah,0 ; DATA XREF: sub_403672+F2o
; char aGpgConnectAg_0[]
aGpgConnectAg_0	db 'gpg-connect-agent',0 ; DATA XREF: sub_40377D+59o
		align 10h
; char aOptionSRequire[]
aOptionSRequire	db 'option "%s" requires a program and optional arguments',0Ah,0
					; DATA XREF: sub_40377D+29Ao
aExec		db '--exec',0           ; DATA XREF: sub_40377D+2A6o
					; sub_40377D+2F1o
		align 10h
; char aOptionSIgnored[]
aOptionSIgnored	db 'option "%s" ignored due to "%s"',0Ah,0 ; DATA XREF: sub_40377D+2E5o
aRawSocket	db '--raw-socket',0     ; DATA XREF: sub_40377D+2F9o
		align 10h
; char aCannotOpenRunF[]
aCannotOpenRunF	db 'cannot open run file `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_40377D+35Co
					; sub_40377D+193Bo
; char aAssuan_newFail[]
aAssuan_newFail	db 'assuan_new failed: %s',0Ah,0 ; DATA XREF: sub_40377D+3E9o
					; sub_40377D+4E9o ...
		align 4
; char aAssuan_pipe_co[]
aAssuan_pipe_co	db 'assuan_pipe_connect_ext failed: %s',0Ah,0 ; DATA XREF: sub_40377D+46Ao
; char aServerSStarted[]
aServerSStarted	db 'server `%s',27h,' started',0Ah,0 ; DATA XREF: sub_40377D+498o
		align 4
; char aCanTConnectToS[]
aCanTConnectToS	db 'can',27h,'t connect to socket `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40377D+55Eo
		align 4
; char aConnectionToSo[]
aConnectionToSo	db 'connection to socket `%s',27h,' established',0Ah,0
					; DATA XREF: sub_40377D+588o
; char aReceivingLineF[]
aReceivingLineF	db 'receiving line failed: %s',0Ah,0 ; DATA XREF: sub_40377D+5F9o
					; sub_40377D+2276o
		align 4
; char a____Gnupg22_0_[]
a____Gnupg22_0_	db '../../gnupg2-2.0.30/tools/gpg-connect-agent.c',0
					; DATA XREF: sub_40377D+6A2o
		align 4
; char aLoopidxIntDimL[]
aLoopidxIntDimL	db 'loopidx < (int)DIM (loopstack)',0 ; DATA XREF: sub_40377D+6AAo
aEnd		db '/end',0             ; DATA XREF: sub_40377D+7E9o
					; sub_40377D+D46o
; char aEndCommandVani[]
aEndCommandVani	db '/end command vanished',0Ah,0 ; DATA XREF: sub_40377D:loc_403FBCo
asc_423B67	db '> ',0               ; DATA XREF: sub_40377D+93Ao
; char aErrorReadingIn[]
aErrorReadingIn	db 'error reading input: %s',0Ah,0 ; DATA XREF: sub_40377D+A55o
; char aStoppingScript[]
aStoppingScript	db 'stopping script execution',0Ah,0 ; DATA XREF: sub_40377D+A91o
					; sub_40377D+22B5o
; char aEndOfScript[]
aEndOfScript	db 'end of script',0Ah,0 ; DATA XREF: sub_40377D+AEDo
; char aLineTooLongSki[]
aLineTooLongSki	db 'line too long - skipped',0Ah,0 ; DATA XREF: sub_40377D+B06o
		align 4
; char aLineShortenedD[]
aLineShortenedD	db 'line shortened due to embedded Nul character',0Ah,0
					; DATA XREF: sub_40377D+B45o
aWhile		db '/while',0           ; DATA XREF: sub_40377D+DF7o
; char aLet[]
aLet		db 'let',0              ; DATA XREF: sub_40377D+FA4o
; char aSlet[]
aSlet		db 'slet',0             ; DATA XREF: sub_40377D:loc_404758o
; char aShowvar[]
aShowvar	db 'showvar',0          ; DATA XREF: sub_40377D:loc_40478Fo
; char aDefinq[]
aDefinq		db 'definq',0           ; DATA XREF: sub_40377D:loc_4047B4o
; char aDefinqfile[]
aDefinqfile	db 'definqfile',0       ; DATA XREF: sub_40377D:loc_40485Ao
; char aDefinqprog[]
aDefinqprog	db 'definqprog',0       ; DATA XREF: sub_40377D:loc_404900o
; char aDatafile[]
aDatafile	db 'datafile',0         ; DATA XREF: sub_40377D:loc_4049A6o
; char asc_423C34[]
asc_423C34	db '-',0                ; DATA XREF: sub_40377D+12CAo
; char aWb[]
aWb		db 'wb',0               ; DATA XREF: sub_40377D+130Co
; char aCanTOpenSS[]
aCanTOpenSS	db 'can',27h,'t open `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_40377D+1352o
; char aShowdef[]
aShowdef	db 'showdef',0          ; DATA XREF: sub_40377D:loc_404AEFo
; char aCleardef[]
aCleardef	db 'cleardef',0         ; DATA XREF: sub_40377D:loc_404B14o
; char aEcho[]
aEcho		db 'echo',0             ; DATA XREF: sub_40377D:loc_404B39o
; char aSendfd[]
aSendfd		db 'sendfd',0           ; DATA XREF: sub_40377D:loc_404BBBo
; char aRecvfd[]
aRecvfd		db 'recvfd',0           ; DATA XREF: sub_40377D:loc_404C53o
; char aOpen[]
aOpen		db 'open',0             ; DATA XREF: sub_40377D:loc_404CEBo
; char aClose[]
aClose		db 'close',0            ; DATA XREF: sub_40377D:loc_404D6Do
; char aShowopen[]
aShowopen	db 'showopen',0         ; DATA XREF: sub_40377D:loc_404DEFo
; char aNohex[]
aNohex		db 'nohex',0            ; DATA XREF: sub_40377D:loc_404E6Do
; char aNodecode[]
aNodecode	db 'nodecode',0         ; DATA XREF: sub_40377D:loc_404EC1o
; char aNosubst[]
aNosubst	db 'nosubst',0          ; DATA XREF: sub_40377D:loc_404F1Fo
; char aSyntaxErrorInR[]
aSyntaxErrorInR	db 'syntax error in run command',0Ah,0 ; DATA XREF: sub_40377D+1884o
		align 4
; char aCannotNestRunC[]
aCannotNestRunC	db 'cannot nest run commands - stop',0Ah,0 ; DATA XREF: sub_40377D+18C7o
; char aRunningCommand[]
aRunningCommand	db 'running commands from `%s',27h,0Ah,0 ; DATA XREF: sub_40377D+1964o
; char aWhile_0[]
aWhile_0	db 'while',0            ; DATA XREF: sub_40377D:loc_4050F2o
; char aBlocksAreNeste[]
aBlocksAreNeste	db 'blocks are nested too deep',0Ah,0 ; DATA XREF: sub_40377D+19A3o
					; sub_40377D+1B3Ao
; char aIf[]
aIf		db 'if',0               ; DATA XREF: sub_40377D:loc_405289o
; char aEnd_0[]
aEnd_0		db 'end',0              ; DATA XREF: sub_40377D:loc_405420o
		align 4
; char aStrayEndComman[]
aStrayEndComman	db 'stray /end command encountered - ignored',0Ah,0
					; DATA XREF: sub_40377D+1CCCo
; char a0[]
a0		db '0',0                ; DATA XREF: sub_40377D+1D61o
; char aBye[]
aBye		db 'bye',0              ; DATA XREF: sub_40377D:loc_4057B5o
; char aSleep[]
aSleep		db 'sleep',0            ; DATA XREF: sub_40377D+2057o
; char aHelp[]
aHelp		db 'help',0             ; DATA XREF: sub_40377D:loc_405800o
		align 10h
; char aAvailableComma[]
aAvailableComma	db 'Available commands:',0Ah ; DATA XREF: sub_40377D+209Eo
		db '/echo ARGS             Echo ARGS.',0Ah
		db '/let  NAME VALUE       Set variable NAME to VALUE.',0Ah
		db '/showvar               Show all variables.',0Ah
		db '/definq NAME VAR       Use content of VAR for inquiries with NAME'
		db '.',0Ah
		db '/definqfile NAME FILE  Use content of FILE for inquiries with NAM'
		db 'E.',0Ah
		db '/definqprog NAME PGM   Run PGM for inquiries with NAME.',0Ah
		db '/datafile [NAME]       Write all D line content to file NAME.',0Ah
		db '/showdef               Print all definitions.',0Ah
		db '/cleardef              Delete all definitions.',0Ah
		db '/sendfd FILE MODE      Open FILE and pass descriptor to server.',0Ah
		db '/recvfd                Receive FD from server and print.',0Ah
		db '/open VAR FILE MODE    Open FILE and assign the file descriptor t'
		db 'o VAR.',0Ah
		db '/close FD              Close file with descriptor FD.',0Ah
		db '/showopen              Show descriptors of all open files.',0Ah
		db '/serverpid             Retrieve the pid of the server.',0Ah
		db '/[no]hex               Enable hex dumping of received data lines.'
		db 0Ah
		db '/[no]decode            Enable decoding of received data lines.',0Ah
		db '/[no]subst             Enable variable substitution.',0Ah
		db '/run FILE              Run commands from FILE.',0Ah
		db '/if VAR                Begin conditional block controlled by VAR.'
		db 0Ah
		db '/while VAR             Begin loop controlled by VAR.',0Ah
		db '/end                   End loop or condition',0Ah
		db '/bye                   Terminate gpg-connect-agent.',0Ah
		db '/help                  Print this help.',0
; char aUnknownCommand[]
aUnknownCommand	db 'unknown command `%s',27h,0Ah,0 ; DATA XREF: sub_40377D:loc_40582Co
; char aSendingLineFai[]
aSendingLineFai	db 'sending line failed: %s',0Ah,0 ; DATA XREF: sub_40377D+2193o
aHelp_0		db 'HELP',0             ; DATA XREF: sub_40377D+21E3o
; char aClosingConnect[]
aClosingConnect	db 'closing connection to agent',0Ah,0 ; DATA XREF: sub_40377D+22FCo
		align 10h
; char aNoHandlerForIn[]
aNoHandlerForIn	db 'no handler for inquiry `%s',27h,' found',0Ah,0
					; DATA XREF: sub_405A92+10Fo
; char aSendingDataBac[]
aSendingDataBac	db 'sending data back failed: %s',0Ah,0 ; DATA XREF: sub_405A92+1A6o
					; sub_405A92+2F5o ...
; char aErrorExecuting[]
aErrorExecuting	db 'error executing `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_405A92+201o
		align 4
; char aHandlingInquir[]
aHandlingInquir	db 'handling inquiry `%s',27h,' by running `%s',27h,0Ah,0
					; DATA XREF: sub_405A92+230o
; char aRb[]
aRb		db 'rb',0               ; DATA XREF: sub_405A92:loc_405CD0o
; char aErrorOpeningSS[]
aErrorOpeningSS	db 'error opening `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_405A92+27Do
		align 10h
; char aHandlingInqu_0[]
aHandlingInqu_0	db 'handling inquiry `%s',27h,' by returning content of `%s',27h,0Ah,0
					; DATA XREF: sub_405A92+2A5o
; char aErrorReadingFr[]
aErrorReadingFr	db 'error reading from `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_405A92+360o
; char aErrorRunningSS[]
aErrorRunningSS	db 'error running `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_405A92+3EFo
; char aD04x[]
aD04x		db 'D[%04X] ',0         ; DATA XREF: sub_405EA8+220o
; char a02x[]
a02x		db ' %02X',0            ; DATA XREF: sub_405EA8+264o
asc_424408	db '   ',0              ; DATA XREF: sub_405EA8+27Fo
					; sub_405EA8+2B6o
aD		db 'D ',0               ; DATA XREF: sub_405EA8+3BBo
; char a_[]
a?		db '?',0                ; DATA XREF: sub_405EA8+683o
					; sub_405EA8+728o
aCancel		db 'CANCEL',0           ; DATA XREF: sub_405EA8+893o
; char VarName[]
VarName		db 'GPG_AGENT_INFO',0   ; DATA XREF: sub_406808+Eo
aS_gpgAgent	db 'S.gpg-agent',0      ; DATA XREF: sub_406808+79o
		align 4
; char aNoRunningGpgAg[]
aNoRunningGpgAg	db 'no running gpg-agent - starting one',0Ah,0 ; DATA XREF: sub_406808+D6o
aDaemon		db '--daemon',0         ; DATA XREF: sub_406808+F9o
aUseStandardSoc	db '--use-standard-socket',0 ; DATA XREF: sub_406808+100o
; char aFailedToStartA[]
aFailedToStartA	db 'failed to start agent `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_406808+147o
; char aMalformedGpg_a[]
aMalformedGpg_a	db 'malformed GPG_AGENT_INFO environment variable',0Ah,0
					; DATA XREF: sub_406808:loc_406A17o
		align 4
; char aGpgAgentProtoc[]
aGpgAgentProtoc	db 'gpg-agent protocol version %d is not supported',0Ah,0
					; DATA XREF: sub_406808+294o
; char aCanTConnectToT[]
aCanTConnectToT	db 'can',27h,'t connect to the agent: %s',0Ah,0 ; DATA XREF: sub_406808+345o
; char aConnectionToAg[]
aConnectionToAg	db 'connection to agent established',0Ah,0 ; DATA XREF: sub_406808+366o
aReset		db 'RESET',0            ; DATA XREF: sub_406808+3A5o
					; sub_406808+3DBo
; char aErrorSendingSC[]
aErrorSendingSC	db 'error sending %s command: %s',0Ah,0 ; DATA XREF: sub_406808+3CBo
		align 10h
; char aErrorAllocatin[]
aErrorAllocatin	db 'error allocating session environment block: %s',0Ah,0
					; DATA XREF: sub_406808+41Ao
; char aErrorSendingSt[]
aErrorSendingSt	db 'error sending standard options: %s',0Ah,0 ; DATA XREF: sub_406808+471o
; char aErrorAllocat_0[]
aErrorAllocat_0	db 'error allocating enough memory: %s',0Ah,0 ; DATA XREF: sub_406CA8+1Ao
off_4245D8	dd offset loc_406EB3	; DATA XREF: sub_406E98+12r
		dd offset loc_406EC2	; jump table for switch	statement
		dd offset loc_406F3A
		dd offset loc_406F3A
		dd offset loc_406F3A
		dd offset loc_406F3A
		dd offset loc_406FB2
		dd offset loc_406FB2
		dd offset loc_406FB2
		dd offset loc_406FB2
		dd offset loc_406FB2
		dd offset loc_406FB2
		dd offset loc_406FB2
		dd offset loc_406FB2
		dd offset loc_406FEA
		dd offset loc_406FF9
		dd offset loc_407008
		dd offset loc_407017
		dd offset loc_407023
off_424624	dd offset loc_406F2A	; DATA XREF: sub_406E98+35r
		dd offset loc_406ED6	; jump table for switch	statement
		dd offset loc_406EE2
		dd offset loc_406EEE
		dd offset loc_406EFA
		dd offset loc_406F06
		dd offset loc_406F12
		dd offset loc_406F1E
off_424644	dd offset loc_406FA2	; DATA XREF: sub_406E98+ADr
		dd offset loc_406F4E	; jump table for switch	statement
		dd offset loc_406F5A
		dd offset loc_406F66
		dd offset loc_406F72
		dd offset loc_406F7E
		dd offset loc_406F8A
		dd offset loc_406F96
off_424664	dd offset loc_40708B	; DATA XREF: sub_406E98+196r
		dd offset loc_407037	; jump table for switch	statement
		dd offset loc_407043
		dd offset loc_40704F
		dd offset loc_40705B
		dd offset loc_407067
		dd offset loc_407073
		dd offset loc_40707F
off_424684	dd offset loc_4071BE	; DATA XREF: sub_407099+10Ar
		dd offset loc_4071DF	; jump table for switch	statement
		dd offset loc_4071DF
		dd offset loc_4071C4
		dd offset loc_4071DF
		dd offset loc_4071DF
		dd offset loc_4071DF
		dd offset loc_4071AC
		dd offset loc_4071DF
		dd offset loc_4071DF
		dd offset loc_4071DF
		dd offset loc_4071B8
		dd offset loc_4071DF
		dd offset loc_4071B2
		dd offset loc_4071DF
		dd offset loc_4071DF
		dd offset loc_4071CA
off_4246C8	dd offset loc_40751F	; DATA XREF: sub_407099+408r
		dd offset loc_40752C	; jump table for switch	statement
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_4074AA
		dd offset loc_40752C
		dd offset loc_4074F8
		dd offset loc_40752C
		dd offset loc_4074D1
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_407512
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_40752C
		dd offset loc_407505
off_424784	dd offset loc_4075D6, offset loc_407633, offset	loc_407603
					; DATA XREF: sub_407099+4B0r
		dd offset loc_407633, offset loc_4075B2, offset	loc_40759A ; jump table	for switch statement
		dd offset loc_4075C4, offset loc_407633, offset	loc_407633
		dd offset loc_407633, offset loc_407633, offset	loc_407633
		dd offset loc_407633, offset loc_407633, offset	loc_407633
		dd offset loc_407633, offset loc_407633, offset	loc_407633
		dd offset loc_407613, offset loc_407633, offset	loc_407633
		dd offset loc_407633, offset loc_407633, offset	loc_407582
		dd offset loc_407633, offset loc_407633, offset	loc_407633
		dd offset loc_407633, offset loc_407633, offset	loc_407633
		dd offset loc_407633, offset loc_407633, offset	loc_4075CD
		dd offset loc_407633, offset loc_4075DF, offset	loc_407552
		dd offset loc_4075A6, offset loc_40758E, offset	loc_4075BB
		dd offset loc_407633, offset loc_407552, offset	loc_407633
		dd offset loc_407633, offset loc_407633, offset	loc_407623
		dd offset loc_4075FA, offset loc_40755E, offset	loc_4075F1
		dd offset loc_407633, offset loc_407633, offset	loc_4075E8
		dd offset loc_407633, offset loc_40756A, offset	loc_407633
		dd offset loc_407633, offset loc_407576
off_424864	dd offset loc_407ACD	; DATA XREF: sub_407811+4Co
		dd offset loc_407866	; jump table for switch	statement
		dd offset loc_407892
		dd offset loc_4078BE
		dd offset loc_4078D5
		dd offset loc_4078ED
		dd offset loc_40791A
		dd offset loc_407944
		dd offset loc_407959
		dd offset loc_40796E
		dd offset loc_407998
		dd offset loc_4079B3
		dd offset loc_4079E3
		dd offset loc_4079F8
		dd offset loc_407A19
		dd offset loc_407A43
		dd offset loc_407A6D
		dd offset loc_407A85
		dd offset loc_407AA9
		dd offset loc_407A2E
		dd offset loc_40787D
		dd offset loc_4078A9
		dd offset loc_407905
		dd offset loc_40792F
		dd offset loc_407983
		dd offset loc_4079CE
		dd offset loc_407A5B
		dd offset loc_407A97
		dd offset loc_407ABB
byte_4248D8	db 27h,	0		; DATA XREF: sub_407B6D+267o
a0123456789abcd	db '0123456789abcdef',0 ; DATA XREF: sub_407B6D+37Eo
a0123456789ab_0	db '0123456789ABCDEF',0 ; DATA XREF: sub_407B6D:loc_407EF2o
a0x		db '0x',0               ; DATA XREF: sub_407B6D+550o
a0x_0		db '0X',0               ; DATA XREF: sub_407B6D:loc_4080C4o
		align 4
off_424904	dd offset loc_407BCC	; DATA XREF: sub_407B6D+56r
		dd offset loc_407C54	; jump table for switch	statement
		dd offset loc_407BE1
		dd offset loc_407C54
		dd offset loc_407BF4
		dd offset loc_407C54
		dd offset loc_407C07
		dd offset loc_407C54
		dd offset loc_407C54
		dd offset loc_407C54
		dd offset loc_407C54
		dd offset loc_407C2D
		dd offset loc_407C54
		dd offset loc_407C1B
		dd offset loc_407C41
off_424940	dd offset loc_407CAF	; DATA XREF: sub_407B6D+139r
		dd offset loc_407D36	; jump table for switch	statement
		dd offset loc_407CC5
		dd offset loc_407D36
		dd offset loc_407CD7
		dd offset loc_407D36
		dd offset loc_407CE9
		dd offset loc_407D36
		dd offset loc_407D36
		dd offset loc_407D36
		dd offset loc_407D36
		dd offset loc_407D0F
		dd offset loc_407CFD
		dd offset loc_407D23
off_424978	dd offset loc_4082D2	; DATA XREF: sub_408200+C9r
		dd offset loc_4082DE	; jump table for switch	statement
		dd offset loc_4082EA
		dd offset loc_4082F6
		dd offset loc_408302
		dd offset loc_40830E
		dd offset loc_40831A
		dd offset loc_408326
aNull		db '(null)',0           ; DATA XREF: sub_4086A7+40o
byte_42499F	db 30h			; DATA XREF: sub_408848+65r
a123456789abcde	db '123456789abcdefx',0
		align 4
off_4249B4	dd offset loc_408984	; DATA XREF: sub_40894F+2Cr
		dd offset loc_408990	; jump table for switch	statement
		dd offset loc_4089E9
		dd offset loc_40899D
		dd offset loc_4089A9
		dd offset loc_4089BD
		dd offset loc_4089D1
		dd offset loc_4089DD
; char a____Gnupg22__0[]
a____Gnupg22__0	db '../../gnupg2-2.0.30/common/estream-printf.c',0
					; DATA XREF: sub_408A03+FAo
					; sub_408A03+145o ...
; char aArgidxArgspecs[]
aArgidxArgspecs	db 'argidx < argspecs_len',0 ; DATA XREF: sub_408A03+102o
		align 4
; char aValuetableArgW[]
aValuetableArgW	db 'valuetable[arg->width_pos-1].vt == VALTYPE_INT',0
					; DATA XREF: sub_408A03+14Do
		align 4
; char aValuetableArgP[]
aValuetableArgP	db 'valuetable[arg->precision_pos-1].vt == VALTYPE_INT',0
					; DATA XREF: sub_408A03+1D9o
		align 4
; char aArgVtValuetabl[]
aArgVtValuetabl	db 'arg->vt == valuetable[arg->arg_pos-1].vt',0 ; DATA XREF: sub_408A03+26Eo
; char aBug[]
aBug		db '!"bug"',0           ; DATA XREF: sub_408A03+2CFo
off_424AAC	dd offset loc_408CC2	; DATA XREF: sub_408A03+2B6r
		dd offset loc_408CE3	; jump table for switch	statement
		dd offset loc_408CE3
		dd offset loc_408CE3
		dd offset loc_408CE3
		dd offset loc_408CE3
		dd offset loc_408D27
		dd offset loc_408D27
		dd offset loc_408D27
		dd offset loc_408D27
		dd offset loc_408D27
		dd offset loc_408D27
		dd offset loc_408D27
		dd offset loc_408D27
		dd offset loc_408D6B
		dd offset loc_408DAF
		dd offset loc_408DF3
		dd offset loc_408DAF
		dd offset loc_408E34
byte_424AF8	db 0			; DATA XREF: sub_409638+5Fo
					; sub_409833+75o
; char aParm_used[]
aParm_used	db 'parm.used',0        ; DATA XREF: sub_409833+FDo
		align 4
; CHAR aShgetfolderpat[]
aShgetfolderpat	db 'SHGetFolderPathA',0 ; DATA XREF: sub_409A09+50o
aHome_0		db '\home',0            ; DATA XREF: sub_409AE3+31o
aGnupg		db '\gnupg',0           ; DATA XREF: sub_409AE3+BAo
aCGnupg		db 'c:/gnupg',0         ; DATA XREF: sub_409AE3:loc_409C07o
					; sub_409C1D:loc_409CF1o
; char aGnupghome[]
aGnupghome	db 'GNUPGHOME',0        ; DATA XREF: sub_409C1D:loc_409C3Bo
; CHAR ValueName[]
ValueName	db 'HomeDir',0          ; DATA XREF: sub_409C1D:loc_409C77o
; CHAR aSoftwareGnuGnu[]
aSoftwareGnuGnu	db 'Software\GNU\GnuPG',0 ; DATA XREF: sub_409C1D+62o
aGpgconf_exe	db '\gpgconf.exe',0     ; DATA XREF: sub_409CFD+10o
					; sub_40A3B2+597o
		align 10h
; char aRequiredBinary[]
aRequiredBinary	db 'required binary ',27h,'%s',27h,' is not installed',0Ah,0
					; DATA XREF: sub_409CFD+44o
aCtl		db 'ctl',0              ; DATA XREF: sub_409CFD:loc_409D4Fo
; char aGetmodulefilen[]
aGetmodulefilen	db 'GetModuleFileName failed: %s',0Ah,0 ; DATA XREF: sub_409DB0+4Ao
aBin		db 'bin',0              ; DATA XREF: sub_409DB0+BBo
		align 10h
; char aBadFilenameSRe[]
aBadFilenameSRe	db 'bad filename `%s',27h,' returned for this process',0Ah,0
					; DATA XREF: sub_409DB0+FCo
aCGnupg_0	db 'c:\gnupg',0         ; DATA XREF: sub_409DB0:loc_409ED1o
aGnu		db '\GNU',0             ; DATA XREF: sub_409EDD+99o
aEtcGnupg	db '\etc\gnupg',0       ; DATA XREF: sub_409FC4+1Do
aBin_0		db '\bin',0             ; DATA XREF: sub_40A067+28o
aLibGnupg	db '\lib\gnupg',0       ; DATA XREF: sub_40A0C0+1Do
aShareGnupg	db '\share\gnupg',0     ; DATA XREF: sub_40A163+1Do
aShareLocale	db '\share\locale',0    ; DATA XREF: sub_40A206+1Do
aCWindows	db 'C:\WINDOWS',0       ; DATA XREF: .text:0040A2F3o
aS_dirmngr	db '\S.dirmngr',0       ; DATA XREF: .text:loc_40A317o
aGpgAgent_exe	db '\gpg-agent.exe',0   ; DATA XREF: sub_40A3B2+36o
aPinentry_exe	db '\pinentry.exe',0    ; DATA XREF: sub_40A3B2+CFo
aScdaemon_exe	db '\scdaemon.exe',0    ; DATA XREF: sub_40A3B2+168o
aDirmngr_exe	db '\dirmngr.exe',0     ; DATA XREF: sub_40A3B2+201o
aGpgProtectTool	db '\gpg-protect-tool.exe',0 ; DATA XREF: sub_40A3B2+29Ao
aGpgCheckPatter	db '\gpg-check-pattern.exe',0 ; DATA XREF: sub_40A3B2+333o
aGpgsm_exe	db '\gpgsm.exe',0       ; DATA XREF: sub_40A3B2+3CCo
aGpg2_exe	db '\gpg2.exe',0        ; DATA XREF: sub_40A3B2+465o
aGpgConnectAg_1	db '\gpg-connect-agent.exe',0 ; DATA XREF: sub_40A3B2+4FEo
a____Gnupg22__1	db '../../gnupg2-2.0.30/common/homedir.c',0 ; DATA XREF: sub_40A3B2+628o
		align 10h
off_424CF0	dd offset loc_40A9CA	; DATA XREF: sub_40A3B2+18o
		dd offset loc_40A3D3	; jump table for switch	statement
		dd offset loc_40A46C
		dd offset loc_40A505
		dd offset loc_40A59E
		dd offset loc_40A637
		dd offset loc_40A6D0
		dd offset loc_40A769
		dd offset loc_40A802
		dd offset loc_40A89B
		dd offset loc_40A934
aGnupg_module_n	db 'gnupg_module_name',0 ; DATA XREF: sub_40A3B2:loc_40A9CAo
aShell32_dll	db 'shell32.dll',0      ; DATA XREF: .data:off_4220E0o
aShfolder_dll	db 'shfolder.dll',0     ; DATA XREF: .data:004220E4o
		align 4
; char aEstream_asprin[]
aEstream_asprin	db 'estream_asprintf failed: %s',0Ah,0 ; DATA XREF: sub_40A9F0+40o
		align 4
; char aGnupg2[]
aGnupg2		db 'gnupg2',0           ; DATA XREF: sub_40ACF4+Fo
		align 10h
aDevTty		db '/dev/tty',0         ; DATA XREF: .text:loc_40ADB7o
; CHAR FileName[]
FileName	db 'CONOUT$',0          ; DATA XREF: sub_40ADBE+67o
; char aOpenConoutFail[]
aOpenConoutFail	db 'open(CONOUT$) failed: rc=%d',0 ; DATA XREF: sub_40ADBE+92o
; CHAR aConin[]
aConin		db 'CONIN$',0           ; DATA XREF: sub_40ADBE+F2o
; char aOpenConinFaile[]
aOpenConinFaile	db 'open(CONIN$) failed: rc=%d',0 ; DATA XREF: sub_40ADBE+11Do
; char aVasprintfFaile[]
aVasprintfFaile	db 'vasprintf() failed',0Ah,0 ; DATA XREF: sub_40AF6D+54o
					; .text:0040B0DBo
; char aWriteconsoleFa[]
aWriteconsoleFa	db 'WriteConsole failed: rc=%d',0 ; DATA XREF: sub_40AF6D+9Eo
					; .text:0040B125o
		align 10h
; char aWriteconsole_0[]
aWriteconsole_0	db 'WriteConsole failed: %d != %d',0Ah,0 ; DATA XREF: sub_40AF6D+C2o
					; .text:0040B149o
aN		db '\n',0               ; DATA XREF: sub_40B175+4Bo
a0_0		db '\0',0               ; DATA XREF: sub_40B175+63o
aX02x		db '\x%02x',0           ; DATA XREF: sub_40B175+7Eo
aC		db '%c',0               ; DATA XREF: sub_40B175+99o
aS		db '%s',0               ; DATA XREF: sub_40B231+9Co
					; sub_40B337+67o
		align 4
; char aSorryWeAreInBa[]
aSorryWeAreInBa	db 'Sorry, we are in batchmode - can',27h,'t get input',0Ah,0
					; DATA XREF: sub_40B337+Fo
		align 4
; char aSorryNoTermina[]
aSorryNoTermina	db 'Sorry, no terminal at all requested - can',27h,'t get input',0Ah,0
					; DATA XREF: sub_40B337+30o
; char aReadconsoleFai[]
aReadconsoleFai	db 'ReadConsole failed: rc=%d',0 ; DATA XREF: sub_40B337+EFo
byte_424EA5	db 0			; DATA XREF: sub_40B4FF:loc_40B563o
					; sub_40B6BE+3Eo
aEstream_vaspri	db 'estream_vasprintf failed: %s',0Ah,0 ; DATA XREF: .text:0040B679o
aS_0		db 0Dh,'%*s',0Dh,0      ; DATA XREF: sub_40B6BE+4Ao
		align 4
; char aFailedToTransl[]
aFailedToTransl	db 'failed to translate osfhandle %p',0Ah,0 ; DATA XREF: sub_40BA17+3Eo
a_tmp		db '.tmp',0             ; DATA XREF: .text:0040BC18o
aWB		db 'w+b',0              ; DATA XREF: .text:loc_40BCB2o
		align 4
aGnupg_allow_se	db 'gnupg_allow_set_foregound_window',0 ; DATA XREF: sub_40BD38+13o
		align 4
; char aSCalledWithInv[]
aSCalledWithInv	db '%s called with invalid pid %lu',0Ah,0 ; DATA XREF: sub_40BD38+1Bo
; char aAllowsetforegr[]
aAllowsetforegr	db 'AllowSetForegroundWindow(%lu) failed: %s',0Ah,0
					; DATA XREF: sub_40BD38+61o
		align 4
; char Control[4]
Control		db ' ',9,0Ah,0Bh        ; DATA XREF: sub_40C1C7:loc_40C1F2o
		db 0Ch,	22h, 0
; char aDuplicatehandl[]
aDuplicatehandl	db 'DuplicateHandle failed: %s',0Ah,0 ; DATA XREF: sub_40C3DD+BCo
; CHAR aNul[]
aNul		db 'nul',0              ; DATA XREF: sub_40C503+44o
; char aCanTOpenNulS[]
aCanTOpenNulS	db 'can',27h,'t open `nul',27h,': %s',0Ah,0 ; DATA XREF: sub_40C503+6Eo
		align 4
aFailedToTran_0	db 'failed to translate osfhandle %p',0Ah,0 ; DATA XREF: .text:0040C5F0o
					; .text:0040C63Fo ...
		align 4
aNoFileDescript	db 'no file descriptor for file passed to gnupg_spawn_process',0Ah,0
					; DATA XREF: .text:loc_40C70Do
aErrorCreatingA	db 'error creating a pipe: %s',0Ah,0 ; DATA XREF: .text:0040C796o
; char aCreateprocessF[]
aCreateprocessF	db 'CreateProcess failed: %s',0Ah,0 ; DATA XREF: .text:0040C899o
					; sub_40C9F4+1CCo
aR_0		db 'r',0                ; DATA XREF: .text:loc_40C97Bo
		align 10h
aCanTFdopenPipe	db 'can',27h,'t fdopen pipe for reading: %s',0Ah,0
					; DATA XREF: .text:0040C9B1o
		align 4
; char aWaitingForProc[]
aWaitingForProc	db 'waiting for process %d to terminate failed: %s',0Ah,0
					; DATA XREF: sub_40CC63+6Do
; char aErrorGettingEx[]
aErrorGettingEx	db 'error getting exit code of process %d: %s',0Ah,0
					; DATA XREF: sub_40CC63+C1o
		align 10h
; char aErrorRunningSE[]
aErrorRunningSE	db 'error running `%s',27h,': exit status %d',0Ah,0
					; DATA XREF: sub_40CC63+F5o
; char aWaitforsingleo[]
aWaitforsingleo	db 'WaitForSingleObject returned unexpected code %d for pid %d',0Ah,0
					; DATA XREF: sub_40CC63+163o
; char aCreateprocessD[]
aCreateprocessD	db 'CreateProcess(detached) failed: %s',0Ah,0 ; DATA XREF: sub_40CDF2+142o
; char aGpg_tty[]
aGpg_tty	db 'GPG_TTY',0          ; DATA XREF: sub_40D6A4:loc_40D78Do
					; .data:off_422100o
aTtyname	db 'ttyname',0          ; DATA XREF: .data:off_422104o
aTerm		db 'TERM',0             ; DATA XREF: .data:00422108o
aTtytype	db 'ttytype',0          ; DATA XREF: .data:0042210Co
aDisplay	db 'DISPLAY',0          ; DATA XREF: .data:00422110o
aDisplay_0	db 'display',0          ; DATA XREF: .data:00422114o
aXauthority	db 'XAUTHORITY',0       ; DATA XREF: .data:00422118o
aXauthority_0	db 'xauthority',0       ; DATA XREF: .data:0042211Co
aXmodifiers	db 'XMODIFIERS',0       ; DATA XREF: .data:00422120o
aGtk_im_module	db 'GTK_IM_MODULE',0    ; DATA XREF: .data:00422128o
aQt_im_module	db 'QT_IM_MODULE',0     ; DATA XREF: .data:00422130o
aPinentry_user_	db 'PINENTRY_USER_DATA',0 ; DATA XREF: .data:00422138o
aPinentryUserDa	db 'pinentry-user-data',0 ; DATA XREF: .data:0042213Co
		align 4
aPutenv		db 'putenv=',0          ; DATA XREF: sub_40D9E6+28o
byte_4251DC	db 0			; DATA XREF: sub_40D9E6:loc_40DA15o
					; sub_40DAA2:loc_40DC02o
aOptionSSS	db 'OPTION %s%s=%s',0   ; DATA XREF: sub_40D9E6+46o
; char aGpg_tty_0[]
aGpg_tty_0	db 'GPG_TTY',0          ; DATA XREF: sub_40DAA2+FBo
aLcCtype	db 'lc-ctype',0         ; DATA XREF: sub_40DAA2+1A3o
aLcMessages	db 'lc-messages',0      ; DATA XREF: sub_40DAA2+21Bo
; CHAR Name[]
Name		db 'GnuPG_spawn_agent_sentinel',0 ; DATA XREF: sub_40DCEC+6o
; char aFailedToCreate[]
aFailedToCreate	db 'failed to create the spawn_agent mutex: %s',0Ah,0
					; DATA XREF: sub_40DCEC+45o
; char aErrorWaitingFo[]
aErrorWaitingFo	db 'error waiting for the spawn_agent mutex: timeout',0Ah,0
					; DATA XREF: sub_40DCEC+92o
		align 4
; char aErrorWaiting_0[]
aErrorWaiting_0	db 'error waiting for the spawn_agent mutex: (code=%d) %s',0Ah,0
					; DATA XREF: sub_40DCEC+B7o
		align 4
; char aFailedToReleas[]
aFailedToReleas	db 'failed to release the spawn_agent mutex: %s',0Ah,0
					; DATA XREF: sub_40DDBD+35o
		align 4
aErrorAllocat_1	db 'error allocating assuan context: %s',0Ah,0 ; DATA XREF: .text:0040DE54o
aGpg_agent_in_0	db 'GPG_AGENT_INFO',0   ; DATA XREF: .text:0040DE71o
aS_gpgAgent_0	db 'S.gpg-agent',0      ; DATA XREF: .text:0040DEA3o
aNoRunningGpg_0	db 'no running gpg-agent - starting one',0Ah,0 ; DATA XREF: .text:0040DEEEo
aStarting_agent	db 'starting_agent ? 0 0',0 ; DATA XREF: .text:0040DF10o
		align 4
aErrorFlushingP	db 'error flushing pending output: %s',0Ah,0 ; DATA XREF: .text:0040DF6Co
aUseStandardS_0	db '--use-standard-socket-p',0 ; DATA XREF: .text:loc_40DFB5o
		align 4
aStartingSForTe	db 'starting `%s',27h,' for testing failed: %s',0Ah,0
					; DATA XREF: .text:0040E013o
		align 4
aRunningSForTes	db 'running `%s',27h,' for testing failed: %s',0Ah,0
					; DATA XREF: .text:0040E061o
aDaemon_0	db '--daemon',0         ; DATA XREF: .text:0040E082o
aUseStandardS_1	db '--use-standard-socket',0 ; DATA XREF: .text:0040E089o
aFailedToStar_0	db 'failed to start agent `%s',27h,': %s',0Ah,0 ; DATA XREF: .text:0040E119o
aWaitingDSecond	db 'waiting %d seconds for the agent to come up',0Ah,0
					; DATA XREF: .text:0040E12Do
aServer		db '--server',0         ; DATA XREF: .text:0040E1D4o
		align 4
aMalformedGpg_0	db 'malformed GPG_AGENT_INFO environment variable',0Ah,0
					; DATA XREF: .text:loc_40E2BAo
		align 4
aGpgAgentProt_0	db 'gpg-agent protocol version %d is not supported',0Ah,0
					; DATA XREF: .text:0040E342o
aCanTConnectT_0	db 'can',27h,'t connect to the agent - trying fall back',0Ah,0
					; DATA XREF: .text:0040E3B8o
		align 4
aCanTConnectT_1	db 'can',27h,'t connect to the agent: %s',0Ah,0 ; DATA XREF: .text:0040E3F0o
aConnectionTo_0	db 'connection to agent established',0Ah,0 ; DATA XREF: .text:0040E41Eo
aReset_0	db 'RESET',0            ; DATA XREF: .text:0040E45Do
		align 10h
; char a____Gnupg22__2[]
a____Gnupg22__2	db '../../gnupg2-2.0.30/common/estream.c',0 ; DATA XREF: sub_40E85B+4Do
					; sub_40E85B+1CBo ...
		align 4
; char aMem_cookieMemo[]
aMem_cookieMemo	db 'mem_cookie->memory_size >= mem_cookie->offset',0
					; DATA XREF: sub_40E85B+55o
					; sub_40E85B+1D3o
; char aSizeNleft[]
aSizeNleft	db 'size <= nleft',0    ; DATA XREF: sub_40E85B+20Co
; char aStreamFlags_wr[]
aStreamFlags_wr	db 'stream->flags.writing',0 ; DATA XREF: sub_40F450+35o
; char aStreamFlags__0[]
aStreamFlags__0	db '!stream->flags.writing',0 ; DATA XREF: sub_40F5E9+24o
aR_1		db 'r',0                ; DATA XREF: .text:00411384o
					; .text:0041142Co ...
aA		db 'a',0                ; DATA XREF: .text:004113BFo
					; .text:004113F4o ...
		align 4
aFatalErrorCrea	db 'fatal: error creating a dummy estream for %d: %s',0Ah,0
					; DATA XREF: .text:004114F1o
aStdout		db '[stdout]',0         ; DATA XREF: .text:0041158Eo
aStderr		db '[stderr]',0         ; DATA XREF: .text:loc_411595o
aStdin		db '[stdin]',0          ; DATA XREF: .text:loc_41159Co
a_estream	db '_estream',0         ; DATA XREF: sub_4127C3+BAo
a_tmp_0		db '.tmp',0             ; DATA XREF: sub_4127C3+165o
a?_0		db '[?]',0              ; DATA XREF: .text:00412E2Ao
aX02x_0		db 'x%02x',0            ; DATA XREF: sub_412E36+307o
; char aYes[]
aYes		db 'yes',0              ; DATA XREF: sub_413504+6o
					; sub_413504:loc_4135FDo ...
; char aYy[]
aYy		db 'yY',0               ; DATA XREF: sub_413504+15o
					; sub_413504+12Eo ...
; char aNo[]
aNo		db 'no',0               ; DATA XREF: sub_413504+24o
					; .text:0041368Bo
; char aNn[]
aNn		db 'nN',0               ; DATA XREF: sub_413504+33o
					; .text:004136B8o
aQuit		db 'quit',0             ; DATA XREF: .text:0041369Ao
					; .text:loc_41380Eo
aQq		db 'qQ',0               ; DATA XREF: .text:004136C7o
					; .text:0041387Eo
aOkayOkay	db 'okay|okay',0        ; DATA XREF: .text:004138AFo
aCancelCancel	db 'cancel|cancel',0    ; DATA XREF: .text:004138BEo
aOo		db 'oO',0               ; DATA XREF: .text:004138CDo
					; .text:00413A1Co
aCc		db 'cC',0               ; DATA XREF: .text:004138DCo
					; .text:00413A57o
aOkay		db 'okay',0             ; DATA XREF: .text:loc_4139A5o
aOk		db 'ok',0               ; DATA XREF: .text:loc_4139C6o
aCancel_0	db 'cancel',0           ; DATA XREF: .text:loc_4139E7o
		align 10h
; char aLibgcryptProbl[]
aLibgcryptProbl	db 'libgcrypt problem: %s',0Ah,0 ; DATA XREF: sub_413B6D+20o
		align 4
; char aOutOfCoreInSec[]
aOutOfCoreInSec	db 'out of core in secure memory while allocating %lu bytes',0
					; DATA XREF: sub_413B99+23o
; char aOutOfCoreWhile[]
aOutOfCoreWhile	db 'out of core while allocating %lu bytes',0
					; DATA XREF: sub_413B99:loc_413BD7o
aStdout_0	db '[stdout]',0         ; DATA XREF: .text:loc_413C5Do
aStdin_0	db '[stdin]',0          ; DATA XREF: .text:loc_413C89o
; char asc_425708[]
asc_425708	db '|',0                ; DATA XREF: sub_413F38:loc_413F3Eo
		align 4
; char a____Gnupg22__3[]
a____Gnupg22__3	db '../../gnupg2-2.0.30/common/iobuf.c',0 ; DATA XREF: sub_41411A+1Bo
					; sub_4142EA+15o ...
; char aFname[]
aFname		db 'fname',0            ; DATA XREF: sub_41411A+23o
					; sub_41444F+1Co
; char aFd_cache_inval[]
aFd_cache_inval	db 'fd_cache_invalidate (%s)',0Ah,0 ; DATA XREF: sub_41411A+3Fo
; char aDidS[]
aDidS		db '                did (%s)',0Ah,0 ; DATA XREF: sub_41411A+8Co
; char aFp[]
aFp		db 'fp',0               ; DATA XREF: sub_4142EA+1Do
; char aFd_cache_close[]
aFd_cache_close	db 'fd_cache_close (%d) real',0Ah,0 ; DATA XREF: sub_4142EA+5Do
		align 4
; char aFd_cache_clo_0[]
aFd_cache_clo_0	db 'fd_cache_close (%s) used existing slot',0Ah,0
					; DATA XREF: sub_4142EA+B9o
; char aFd_cache_clo_1[]
aFd_cache_clo_1	db 'fd_cache_close (%s) new slot created',0Ah,0 ; DATA XREF: sub_4142EA+E8o
		align 4
; char aFd_cache_openS[]
aFd_cache_openS	db 'fd_cache_open (%s) using cached fp',0Ah,0 ; DATA XREF: sub_41444F+84o
; char aRewindFileFail[]
aRewindFileFail	db 'rewind file failed on handle %p: ec=%d',0Ah,0
					; DATA XREF: sub_41444F+CFo
; char aFd_cache_ope_0[]
aFd_cache_ope_0	db 'fd_cache_open (%s) not cached',0Ah,0 ; DATA XREF: sub_41444F+109o
; char aSize[]
aSize		db 'size',0             ; DATA XREF: sub_414578+4Ao
					; sub_414824+42o ...
; char aSReadErrorEcD[]
aSReadErrorEcD	db '%s: read error: ec=%d',0Ah,0 ; DATA XREF: sub_414578+DCo
; char aSWriteErrorEcD[]
aSWriteErrorEcD	db '%s: write error: ec=%d',0Ah,0 ; DATA XREF: sub_414578+197o
aFile_filterFd	db 'file_filter(fd)',0  ; DATA XREF: sub_414578+205o
; char aSCloseHandleP[]
aSCloseHandleP	db '%s: close handle %p',0Ah,0 ; DATA XREF: sub_414578+260o
; char aSocketReadErro[]
aSocketReadErro	db 'socket read error: ec=%d',0Ah,0 ; DATA XREF: sub_414824+BDo
; char aSocketWriteErr[]
aSocketWriteErr	db 'socket write error: ec=%d',0Ah,0 ; DATA XREF: sub_414824+167o
aSock_filter	db 'sock_filter',0      ; DATA XREF: sub_414824+1CFo
		align 10h
; char aBlock_filter1s[]
aBlock_filter1s	db 'block_filter: 1st length byte missing',0Ah,0
					; DATA XREF: sub_414A2D+141o
		align 4
; char aBlock_filter2n[]
aBlock_filter2n	db 'block_filter: 2nd length byte missing',0Ah,0
					; DATA XREF: sub_414A2D+229o
		align 10h
; char aBlock_filterIn[]
aBlock_filterIn	db 'block_filter: invalid 4 byte length',0Ah,0 ; DATA XREF: sub_414A2D+452o
		align 4
; char aBlock_filterPR[]
aBlock_filterPR	db 'block_filter %p: read error (size=%lu,a->size=%lu)',0Ah,0
					; DATA XREF: sub_414A2D+551o
; char aABuflenOp_min_[]
aABuflenOp_min_	db 'a->buflen <= OP_MIN_PARTIAL_CHUNK',0 ; DATA XREF: sub_414A2D+60Do
; char aC0x1f[]
aC0x1f		db 'c <= 0x1f',0        ; DATA XREF: sub_414A2D+6C3o
; char aNOp_min_partia[]
aNOp_min_partia	db 'n == OP_MIN_PARTIAL_CHUNK',0 ; DATA XREF: sub_414A2D+710o
; char aABuflen[]
aABuflen	db '!a->buflen',0       ; DATA XREF: sub_414A2D+7E0o
; char aNbytesOp_min_p[]
aNbytesOp_min_p	db 'nbytes < OP_MIN_PARTIAL_CHUNK',0 ; DATA XREF: sub_414A2D+805o
; char aInitBlock_filt[]
aInitBlock_filt	db 'init block_filter %p',0Ah,0 ; DATA XREF: sub_414A2D+88Fo
aBlock_filter_0	db 'block_filter',0     ; DATA XREF: sub_414A2D+90Bo
		align 10h
; char aBlock_filterWr[]
aBlock_filterWr	db 'block_filter: write error: %s',0Ah,0 ; DATA XREF: sub_414A2D+AA1o
; char aBlock_filterPe[]
aBlock_filterPe	db 'block_filter: pending bytes!',0Ah,0 ; DATA XREF: sub_414A2D+AFFo
; char aFreeBlock_filt[]
aFreeBlock_filt	db 'free block_filter %p',0Ah,0 ; DATA XREF: sub_414A2D+B1Bo
aNone		db '[none]',0           ; DATA XREF: sub_415568+22o
a?_1		db '?',0                ; DATA XREF: sub_415568:loc_4155ECo
					; sub_4156D1:loc_4157A0o ...
; char aIobufChainD_DS[]
aIobufChainD_DS	db 'iobuf chain: %d.%d `%s',27h,' filter_eof=%d start=%d len=%d',0Ah,0
					; DATA XREF: sub_415568+ADo
; char aIobuf_closeP[]
aIobuf_closeP	db 'iobuf_close -> %p',0Ah,0 ; DATA XREF: sub_4156D1+5Co
		align 4
; char aIobuf_flushFai[]
aIobuf_flushFai	db 'iobuf_flush failed on close: %s',0Ah,0 ; DATA XREF: sub_4156D1+A8o
; char aIobufD_DCloseS[]
aIobufD_DCloseS	db 'iobuf-%d.%d: close `%s',27h,0Ah,0 ; DATA XREF: sub_4156D1+ECo
		align 4
; char aIobufctrl_free[]
aIobufctrl_free	db 'IOBUFCTRL_FREE failed on close: %s',0Ah,0 ; DATA XREF: sub_4156D1+14Co
aStdin_1	db '[stdin]',0          ; DATA XREF: sub_415AE9+46o
; char aRb_0[]
aRb_0		db 'rb',0               ; DATA XREF: sub_415AE9+7Do
					; sub_415AE9:loc_415B7Bo
; char aIobufD_DOpenSF[]
aIobufD_DOpenSF	db 'iobuf-%d.%d: open `%s',27h,' fd=%d',0Ah,0 ; DATA XREF: sub_415AE9+1D3o
; char aFdD[]
aFdD		db '[fd %d]',0          ; DATA XREF: sub_415CD0+63o
; char aIobufD_DFdopen[]
aIobufD_DFdopen	db 'iobuf-%d.%d: fdopen `%s',27h,0Ah,0 ; DATA XREF: sub_415CD0+111o
aSockD		db '[sock %d]',0        ; DATA XREF: .text:00415E72o
aIobufD_DSockop	db 'iobuf-%d.%d: sockopen `%s',27h,0Ah,0 ; DATA XREF: .text:00415F20o
aStdout_1	db '[stdout]',0         ; DATA XREF: .text:00415F93o
aWb_0		db 'wb',0               ; DATA XREF: .text:00415FCAo
					; .text:loc_415FDFo
aIobufD_DCreate	db 'iobuf-%d.%d: create `%s',27h,0Ah,0 ; DATA XREF: .text:00416129o
aRB		db 'r+b',0              ; DATA XREF: .text:loc_416154o
aIobufD_DOpenrw	db 'iobuf-%d.%d: openrw `%s',27h,0Ah,0 ; DATA XREF: .text:0041628Fo
		align 10h
; char aIobufD_DIoctlS[]
aIobufD_DIoctlS	db 'iobuf-%d.%d: ioctl `%s',27h,' keep=%d',0Ah,0 ; DATA XREF: sub_4162A4+74o
		align 4
; char aIobuf_IoctlSIn[]
aIobuf_IoctlSIn	db 'iobuf-*.*: ioctl `%s',27h,' invalidate',0Ah,0
					; DATA XREF: sub_4162A4+11Fo
		align 4
; char aIobufD_DIoct_0[]
aIobufD_DIoct_0	db 'iobuf-%d.%d: ioctl `%s',27h,' no_cache=%d',0Ah,0
					; DATA XREF: sub_4162A4+1D9o
aNull_0		db '<null>',0           ; DATA XREF: sub_4162A4:loc_416519o
; char aIobuf_IoctlSFs[]
aIobuf_IoctlSFs	db 'iobuf-*.*: ioctl `%s',27h,' fsync',0Ah,0 ; DATA XREF: sub_4162A4+27Eo
		align 4
; char aIOFilterTooDee[]
aIOFilterTooDee	db 'i/o filter too deeply nested - corrupted data?',0Ah,0
					; DATA XREF: sub_416581+6Eo
; char aIobufD_DPushS[]
aIobufD_DPushS	db 'iobuf-%d.%d: push `%s',27h,0Ah,0 ; DATA XREF: sub_416581+2B9o
; char aIobufctrl_init[]
aIobufctrl_init	db 'IOBUFCTRL_INIT failed: %s',0Ah,0 ; DATA XREF: sub_416581+324o
; char aIobufD_DPopS[]
aIobufD_DPopS	db 'iobuf-%d.%d: pop `%s',27h,0Ah,0 ; DATA XREF: sub_4168BC+75o
; char aB[]
aB		db 'b',0                ; DATA XREF: sub_4168BC+AEo
; char aPop_filterFilt[]
aPop_filterFilt	db 'pop_filter(): filter function not found',0Ah,0
					; DATA XREF: sub_4168BC+194o
		align 4
; char aIobuf_flushF_0[]
aIobuf_flushF_0	db 'iobuf_flush failed in pop_filter: %s',0Ah,0 ; DATA XREF: sub_4168BC+1CDo
; char aIobufctrl_fr_0[]
aIobufctrl_fr_0	db 'IOBUFCTRL_FREE failed: %s',0Ah,0 ; DATA XREF: sub_4168BC+235o
					; sub_416C53+39Co
		align 10h
; char aCanTRemoveTheL[]
aCanTRemoveTheL	db 'can',27h,'t remove the last filter from the chain',0Ah,0
					; DATA XREF: sub_4168BC+287o
; char aIobufD_DPopped[]
aIobufD_DPopped	db 'iobuf-%d.%d: popped filter',0Ah,0 ; DATA XREF: sub_4168BC+35Co
		align 4
; char aOhhJeeeTryingT[]
aOhhJeeeTryingT	db 'Ohh jeee, trying to remove a head filter',0Ah,0
					; DATA XREF: sub_4168BC+374o
		align 4
; char aOhhJeeeTryin_0[]
aOhhJeeeTryin_0	db 'Ohh jeee, trying to remove an intermediate filter',0Ah,0
					; DATA XREF: sub_4168BC:loc_416C3Co
; char aAD_startAD_len[]
aAD_startAD_len	db 'a->d.start == a->d.len',0 ; DATA XREF: sub_416C53+29o
		align 4
; char aIobufD_DPopSIn[]
aIobufD_DPopSIn	db 'iobuf-%d.%d: pop `%s',27h,' in underflow',0Ah,0
					; DATA XREF: sub_416C53+A6o
; char aIobufD_DUnderf[]
aIobufD_DUnderf	db 'iobuf-%d.%d: underflow: eof (due to filter eof)',0Ah,0
					; DATA XREF: sub_416C53+17Do
; char aIobufD_DError[]
aIobufD_DError	db 'iobuf-%d.%d: error',0Ah,0 ; DATA XREF: sub_416C53+1BAo
		align 10h
; char aIobufD_DUnde_0[]
aIobufD_DUnde_0	db 'iobuf-%d.%d: underflow: req=%lu',0Ah,0 ; DATA XREF: sub_416C53+2B9o
		align 4
; char aIobufD_DUnde_1[]
aIobufD_DUnde_1	db 'iobuf-%d.%d: underflow: got=%lu rc=%d',0Ah,0
					; DATA XREF: sub_416C53+327o
		align 4
; char aIobufD_DPopInU[]
aIobufD_DPopInU	db 'iobuf-%d.%d: pop in underflow (!len)',0Ah,0 ; DATA XREF: sub_416C53+43Bo
; char aIobufD_DUnde_2[]
aIobufD_DUnde_2	db 'iobuf-%d.%d: underflow: eof',0Ah,0 ; DATA XREF: sub_416C53+521o
		align 10h
; char aIobufD_DUnde_3[]
aIobufD_DUnde_3	db 'iobuf-%d.%d: underflow: eof (no filter)',0Ah,0
					; DATA XREF: sub_416C53+584o
		align 4
; char aIncreasingTemp[]
aIncreasingTemp	db 'increasing temp iobuf from %lu to %lu',0Ah,0 ; DATA XREF: sub_4171F0+52o
; char aFlushOnNonOutp[]
aFlushOnNonOutp	db 'flush on non-output iobuf',0Ah,0 ; DATA XREF: sub_4171F0+C1o
; char aIobuf_flushNoF[]
aIobuf_flushNoF	db 'iobuf_flush: no filter',0Ah,0 ; DATA XREF: sub_4171F0+D7o
		align 4
; char aIobuf_flushDid[]
aIobuf_flushDid	db 'iobuf_flush did not write all!',0Ah,0 ; DATA XREF: sub_4171F0+136o
aAD_start1	db 'a->d.start == 1',0  ; DATA XREF: .text:00417629o
; char aAD_lenAD_size[]
aAD_lenAD_size	db 'a->d.len < a->d.size',0 ; DATA XREF: sub_417685+75o
; char aFstatFailedS[]
aFstatFailedS	db 'fstat() failed: %s',0Ah,0 ; DATA XREF: sub_417994+6Co
; CHAR aKernel32_dll[]
aKernel32_dll	db 'kernel32.dll',0     ; DATA XREF: sub_417994+C8o
; CHAR aGetfilesizeex[]
aGetfilesizeex	db 'GetFileSizeEx',0    ; DATA XREF: sub_417994+DDo
; char aGetfilesizeFor[]
aGetfilesizeFor	db 'GetFileSize for handle %p failed: %s',0Ah,0 ; DATA XREF: sub_417994+1A9o
aCanTSeekS	db 'can',27h,'t seek: %s',0Ah,0 ; DATA XREF: .text:00417C54o
		align 4
aSetfilepointer	db 'SetFilePointer failed on handle %p: ec=%d',0Ah,0
					; DATA XREF: .text:00417CFFo
		align 10h
aPop_filterCall	db 'pop_filter called in iobuf_seek - please report',0Ah,0
					; DATA XREF: .text:00417D7Fo
aAUse1AUse2	db 'a->use == 1 || a->use == 2',0 ; DATA XREF: .text:00417EACo
aPop_filterCa_0	db 'pop_filter called in set_partial_block_mode - please report',0Ah,0
					; DATA XREF: .text:00417ED5o
		align 4
; char aGetstdhandleDF[]
aGetstdhandleDF	db 'GetStdHandle(%d) failed: ec=%d',0Ah,0 ; DATA XREF: sub_418116+78o
aIobuf_write	db 'iobuf_write',0      ; DATA XREF: sub_41772A+16o
aIobuf_writebyt	db 'iobuf_writebyte',0  ; DATA XREF: sub_417685+10o
aPop_filter	db 'pop_filter',0       ; DATA XREF: sub_4168BC+21o
aIobuf_push_fil	db 'iobuf_push_filter2',0 ; DATA XREF: sub_416581+21o
aBlock_filter	db 'block_filter',0     ; DATA XREF: sub_414A2D:loc_414F00o
					; sub_414A2D:loc_415286o ...
		align 4
; char aLc_all[]
aLc_all		db 'LC_ALL',0           ; DATA XREF: sub_4182CC+6o
; char aLang[]
aLang		db 'LANG',0             ; DATA XREF: sub_4182CC:loc_41831Fo
aAf_za		db 'af_ZA',0            ; DATA XREF: sub_4182CC:loc_41838Ao
aSq_al		db 'sq_AL',0            ; DATA XREF: sub_4182CC:loc_418394o
aAm_et		db 'am_ET',0            ; DATA XREF: sub_4182CC:loc_41839Eo
aAr_sa		db 'ar_SA',0            ; DATA XREF: sub_4182CC:loc_4183C1o
aAr_iq		db 'ar_IQ',0            ; DATA XREF: sub_4182CC:loc_4183CBo
aAr_eg		db 'ar_EG',0            ; DATA XREF: sub_4182CC:loc_4183D5o
aAr_ly		db 'ar_LY',0            ; DATA XREF: sub_4182CC:loc_4183DFo
aAr_dz		db 'ar_DZ',0            ; DATA XREF: sub_4182CC:loc_4183E9o
aAr_ma		db 'ar_MA',0            ; DATA XREF: sub_4182CC:loc_4183F3o
aAr_tn		db 'ar_TN',0            ; DATA XREF: sub_4182CC:loc_4183FDo
aAr_om		db 'ar_OM',0            ; DATA XREF: sub_4182CC:loc_418407o
aAr_ye		db 'ar_YE',0            ; DATA XREF: sub_4182CC:loc_418411o
aAr_sy		db 'ar_SY',0            ; DATA XREF: sub_4182CC:loc_41841Bo
aAr_jo		db 'ar_JO',0            ; DATA XREF: sub_4182CC:loc_418425o
aAr_lb		db 'ar_LB',0            ; DATA XREF: sub_4182CC:loc_41842Fo
aAr_kw		db 'ar_KW',0            ; DATA XREF: sub_4182CC:loc_418439o
aAr_ae		db 'ar_AE',0            ; DATA XREF: sub_4182CC:loc_418443o
aAr_bh		db 'ar_BH',0            ; DATA XREF: sub_4182CC:loc_41844Do
aAr_qa		db 'ar_QA',0            ; DATA XREF: sub_4182CC:loc_418457o
aAr		db 'ar',0               ; DATA XREF: sub_4182CC:loc_418461o
aHy_am		db 'hy_AM',0            ; DATA XREF: sub_4182CC:loc_41846Bo
aAs_in		db 'as_IN',0            ; DATA XREF: sub_4182CC:loc_418475o
aAz_az@latin	db 'az_AZ@latin',0      ; DATA XREF: sub_4182CC:loc_41848Eo
aAz_az@cyrillic	db 'az_AZ@cyrillic',0   ; DATA XREF: sub_4182CC:loc_418498o
aAz		db 'az',0               ; DATA XREF: sub_4182CC:loc_4184A2o
aEu		db 'eu',0               ; DATA XREF: sub_4182CC:loc_4184ACo
aBe_by		db 'be_BY',0            ; DATA XREF: sub_4182CC:loc_4184B6o
aBn_in		db 'bn_IN',0            ; DATA XREF: sub_4182CC:loc_4184CFo
aBn_bd		db 'bn_BD',0            ; DATA XREF: sub_4182CC:loc_4184D9o
aBn		db 'bn',0               ; DATA XREF: sub_4182CC:loc_4184E3o
aBg_bg		db 'bg_BG',0            ; DATA XREF: sub_4182CC:loc_4184EDo
aMy_mm		db 'my_MM',0            ; DATA XREF: sub_4182CC:loc_4184F7o
aKm_kh		db 'km_KH',0            ; DATA XREF: sub_4182CC:loc_418501o
aCa_es		db 'ca_ES',0            ; DATA XREF: sub_4182CC:loc_41850Bo
aChr_us		db 'chr_US',0           ; DATA XREF: sub_4182CC:loc_418515o
aZh_tw		db 'zh_TW',0            ; DATA XREF: sub_4182CC:loc_418534o
aZh_cn		db 'zh_CN',0            ; DATA XREF: sub_4182CC:loc_41853Eo
aZh_hk		db 'zh_HK',0            ; DATA XREF: sub_4182CC:loc_418548o
aZh_sg		db 'zh_SG',0            ; DATA XREF: sub_4182CC:loc_418552o
aZh_mo		db 'zh_MO',0            ; DATA XREF: sub_4182CC:loc_41855Co
aZh		db 'zh',0               ; DATA XREF: sub_4182CC:loc_418566o
aHr_hr		db 'hr_HR',0            ; DATA XREF: sub_4182CC+2B6o
aSr_cs		db 'sr_CS',0            ; DATA XREF: sub_4182CC:loc_41858Co
aSr_cs@cyrillic	db 'sr_CS@cyrillic',0   ; DATA XREF: sub_4182CC:loc_418596o
aHr		db 'hr',0               ; DATA XREF: sub_4182CC:loc_4185A0o
aCs_cz		db 'cs_CZ',0            ; DATA XREF: sub_4182CC:loc_4185AAo
aDa_dk		db 'da_DK',0            ; DATA XREF: sub_4182CC:loc_4185B4o
aDiv_mv		db 'div_MV',0           ; DATA XREF: sub_4182CC:loc_4185BEo
aNl_nl		db 'nl_NL',0            ; DATA XREF: sub_4182CC:loc_4185D7o
aNl_be		db 'nl_BE',0            ; DATA XREF: sub_4182CC:loc_4185E1o
aNl		db 'nl',0               ; DATA XREF: sub_4182CC:loc_4185EBo
aBin_ng		db 'bin_NG',0           ; DATA XREF: sub_4182CC:loc_4185F5o
aEn_us		db 'en_US',0            ; DATA XREF: sub_4182CC:loc_418618o
aEn_gb		db 'en_GB',0            ; DATA XREF: sub_4182CC:loc_418622o
aEn_au		db 'en_AU',0            ; DATA XREF: sub_4182CC:loc_41862Co
aEn_ca		db 'en_CA',0            ; DATA XREF: sub_4182CC:loc_418636o
aEn_nz		db 'en_NZ',0            ; DATA XREF: sub_4182CC:loc_418640o
aEn_ie		db 'en_IE',0            ; DATA XREF: sub_4182CC:loc_41864Ao
aEn_za		db 'en_ZA',0            ; DATA XREF: sub_4182CC:loc_418654o
aEn_jm		db 'en_JM',0            ; DATA XREF: sub_4182CC:loc_41865Eo
aEn_gd		db 'en_GD',0            ; DATA XREF: sub_4182CC:loc_418668o
aEn_bz		db 'en_BZ',0            ; DATA XREF: sub_4182CC:loc_418672o
aEn_tt		db 'en_TT',0            ; DATA XREF: sub_4182CC:loc_41867Co
aEn_zw		db 'en_ZW',0            ; DATA XREF: sub_4182CC:loc_418686o
aEn_ph		db 'en_PH',0            ; DATA XREF: sub_4182CC:loc_418690o
aEn_id		db 'en_ID',0            ; DATA XREF: sub_4182CC:loc_41869Ao
aEn_hk		db 'en_HK',0            ; DATA XREF: sub_4182CC:loc_4186A4o
aEn_in		db 'en_IN',0            ; DATA XREF: sub_4182CC:loc_4186AEo
aEn_my		db 'en_MY',0            ; DATA XREF: sub_4182CC:loc_4186B8o
aEn_sg		db 'en_SG',0            ; DATA XREF: sub_4182CC:loc_4186C2o
aEn		db 'en',0               ; DATA XREF: sub_4182CC:loc_4186CCo
aEt_ee		db 'et_EE',0            ; DATA XREF: sub_4182CC:loc_4186D6o
aFo_fo		db 'fo_FO',0            ; DATA XREF: sub_4182CC:loc_4186E0o
aFa_ir		db 'fa_IR',0            ; DATA XREF: sub_4182CC:loc_4186EAo
aFi_fi		db 'fi_FI',0            ; DATA XREF: sub_4182CC:loc_4186F4o
aFr_fr		db 'fr_FR',0            ; DATA XREF: sub_4182CC:loc_418717o
aFr_be		db 'fr_BE',0            ; DATA XREF: sub_4182CC:loc_418721o
aFr_ca		db 'fr_CA',0            ; DATA XREF: sub_4182CC:loc_41872Bo
aFr_ch		db 'fr_CH',0            ; DATA XREF: sub_4182CC:loc_418735o
aFr_lu		db 'fr_LU',0            ; DATA XREF: sub_4182CC:loc_41873Fo
aFr_mc		db 'fr_MC',0            ; DATA XREF: sub_4182CC:loc_418749o
aFr		db 'fr',0               ; DATA XREF: sub_4182CC:loc_418753o
					; sub_4182CC:loc_4187ADo
aFr_re		db 'fr_RE',0            ; DATA XREF: sub_4182CC:loc_41875Do
aFr_cg		db 'fr_CG',0            ; DATA XREF: sub_4182CC:loc_418767o
aFr_sn		db 'fr_SN',0            ; DATA XREF: sub_4182CC:loc_418771o
aFr_cm		db 'fr_CM',0            ; DATA XREF: sub_4182CC:loc_41877Bo
aFr_ci		db 'fr_CI',0            ; DATA XREF: sub_4182CC:loc_418785o
aFr_ml		db 'fr_ML',0            ; DATA XREF: sub_4182CC:loc_41878Fo
aFr_ma		db 'fr_MA',0            ; DATA XREF: sub_4182CC:loc_418799o
aFr_ht		db 'fr_HT',0            ; DATA XREF: sub_4182CC:loc_4187A3o
aFy_nl		db 'fy_NL',0            ; DATA XREF: sub_4182CC:loc_4187B7o
aFul_ng		db 'ful_NG',0           ; DATA XREF: sub_4182CC:loc_4187C1o
aGd_gb		db 'gd_GB',0            ; DATA XREF: sub_4182CC:loc_4187DAo
aGa_ie		db 'ga_IE',0            ; DATA XREF: sub_4182CC:loc_4187E4o
aC_0		db 'C',0                ; DATA XREF: sub_4182CC:loc_4187EEo
					; sub_4182CC:loc_418E0Co
aGl_es		db 'gl_ES',0            ; DATA XREF: sub_4182CC:loc_4187F8o
aKa_ge		db 'ka_GE',0            ; DATA XREF: sub_4182CC:loc_418802o
aDe_de		db 'de_DE',0            ; DATA XREF: sub_4182CC:loc_418821o
aDe_ch		db 'de_CH',0            ; DATA XREF: sub_4182CC:loc_41882Bo
aDe_at		db 'de_AT',0            ; DATA XREF: sub_4182CC:loc_418835o
aDe_lu		db 'de_LU',0            ; DATA XREF: sub_4182CC:loc_41883Fo
aDe_li		db 'de_LI',0            ; DATA XREF: sub_4182CC:loc_418849o
aDe		db 'de',0               ; DATA XREF: sub_4182CC:loc_418853o
aEl_gr		db 'el_GR',0            ; DATA XREF: sub_4182CC:loc_41885Do
aGn_py		db 'gn_PY',0            ; DATA XREF: sub_4182CC:loc_418867o
aGu_in		db 'gu_IN',0            ; DATA XREF: sub_4182CC:loc_418871o
aHa_ng		db 'ha_NG',0            ; DATA XREF: sub_4182CC:loc_41887Bo
aCpe_us		db 'cpe_US',0           ; DATA XREF: sub_4182CC:loc_418885o
aHe_il		db 'he_IL',0            ; DATA XREF: sub_4182CC:loc_41888Fo
aHi_in		db 'hi_IN',0            ; DATA XREF: sub_4182CC:loc_418899o
aHu_hu		db 'hu_HU',0            ; DATA XREF: sub_4182CC:loc_4188A3o
aNic_ng		db 'nic_NG',0           ; DATA XREF: sub_4182CC:loc_4188ADo
aIs_is		db 'is_IS',0            ; DATA XREF: sub_4182CC:loc_4188B7o
aIbo_ng		db 'ibo_NG',0           ; DATA XREF: sub_4182CC:loc_4188C1o
aId_id		db 'id_ID',0            ; DATA XREF: sub_4182CC:loc_4188CBo
aIu_ca		db 'iu_CA',0            ; DATA XREF: sub_4182CC:loc_4188D5o
aIt_it		db 'it_IT',0            ; DATA XREF: sub_4182CC:loc_4188EEo
aIt_ch		db 'it_CH',0            ; DATA XREF: sub_4182CC:loc_4188F8o
aIt		db 'it',0               ; DATA XREF: sub_4182CC:loc_418902o
aJa_jp		db 'ja_JP',0            ; DATA XREF: sub_4182CC:loc_41890Co
aKn_in		db 'kn_IN',0            ; DATA XREF: sub_4182CC:loc_418916o
aKau_ng		db 'kau_NG',0           ; DATA XREF: sub_4182CC:loc_418920o
aKs_pk		db 'ks_PK',0            ; DATA XREF: sub_4182CC:loc_418939o
aKs_in		db 'ks_IN',0            ; DATA XREF: sub_4182CC:loc_418943o
aKs		db 'ks',0               ; DATA XREF: sub_4182CC:loc_41894Do
aKk_kz		db 'kk_KZ',0            ; DATA XREF: sub_4182CC:loc_418957o
aKok_in		db 'kok_IN',0           ; DATA XREF: sub_4182CC:loc_418961o
aKo_kr		db 'ko_KR',0            ; DATA XREF: sub_4182CC:loc_41896Bo
aKy_kg		db 'ky_KG',0            ; DATA XREF: sub_4182CC:loc_418975o
aLo_la		db 'lo_LA',0            ; DATA XREF: sub_4182CC:loc_41897Fo
aLa_va		db 'la_VA',0            ; DATA XREF: sub_4182CC:loc_418989o
aLv_lv		db 'lv_LV',0            ; DATA XREF: sub_4182CC:loc_418993o
aLt_lt		db 'lt_LT',0            ; DATA XREF: sub_4182CC:loc_41899Do
aMk_mk		db 'mk_MK',0            ; DATA XREF: sub_4182CC:loc_4189A7o
aMs_my		db 'ms_MY',0            ; DATA XREF: sub_4182CC:loc_4189C0o
aMs_bn		db 'ms_BN',0            ; DATA XREF: sub_4182CC:loc_4189CAo
aMs		db 'ms',0               ; DATA XREF: sub_4182CC:loc_4189D4o
aMl_in		db 'ml_IN',0            ; DATA XREF: sub_4182CC:loc_4189DEo
aMt_mt		db 'mt_MT',0            ; DATA XREF: sub_4182CC:loc_4189E8o
aMni_in		db 'mni_IN',0           ; DATA XREF: sub_4182CC:loc_4189F2o
aMr_in		db 'mr_IN',0            ; DATA XREF: sub_4182CC:loc_4189FCo
aMn		db 'mn',0               ; DATA XREF: sub_4182CC:loc_418A06o
aNe_np		db 'ne_NP',0            ; DATA XREF: sub_4182CC:loc_418A1Fo
aNe_in		db 'ne_IN',0            ; DATA XREF: sub_4182CC:loc_418A29o
aNe		db 'ne',0               ; DATA XREF: sub_4182CC:loc_418A33o
aNo_no		db 'no_NO',0            ; DATA XREF: sub_4182CC:loc_418A4Co
aNn_no		db 'nn_NO',0            ; DATA XREF: sub_4182CC:loc_418A56o
aNo_0		db 'no',0               ; DATA XREF: sub_4182CC:loc_418A60o
aOr_in		db 'or_IN',0            ; DATA XREF: sub_4182CC:loc_418A6Ao
aOm_et		db 'om_ET',0            ; DATA XREF: sub_4182CC:loc_418A74o
aPap_an		db 'pap_AN',0           ; DATA XREF: sub_4182CC:loc_418A7Eo
aPs		db 'ps',0               ; DATA XREF: sub_4182CC:loc_418A88o
aPl_pl		db 'pl_PL',0            ; DATA XREF: sub_4182CC:loc_418A92o
aPt_pt		db 'pt_PT',0            ; DATA XREF: sub_4182CC+7DDo
aPt_br		db 'pt_BR',0            ; DATA XREF: sub_4182CC:loc_418AB3o
aPt		db 'pt',0               ; DATA XREF: sub_4182CC:loc_418ABDo
aPa_in		db 'pa_IN',0            ; DATA XREF: sub_4182CC+803o
aPa		db 'pa',0               ; DATA XREF: sub_4182CC:loc_418AD9o
aRm_ch		db 'rm_CH',0            ; DATA XREF: sub_4182CC:loc_418AE3o
aRo_ro		db 'ro_RO',0            ; DATA XREF: sub_4182CC+829o
aRo		db 'ro',0               ; DATA XREF: sub_4182CC:loc_418AFFo
aRu		db 'ru',0               ; DATA XREF: sub_4182CC:loc_418B09o
aSe_no		db 'se_NO',0            ; DATA XREF: sub_4182CC:loc_418B13o
aSa_in		db 'sa_IN',0            ; DATA XREF: sub_4182CC:loc_418B1Do
aSd_in		db 'sd_IN',0            ; DATA XREF: sub_4182CC:loc_418B35o
aSd_pk		db 'sd_PK',0            ; DATA XREF: sub_4182CC:loc_418B3Fo
aSd		db 'sd',0               ; DATA XREF: sub_4182CC:loc_418B49o
aSi_lk		db 'si_LK',0            ; DATA XREF: sub_4182CC:loc_418B53o
aSk_sk		db 'sk_SK',0            ; DATA XREF: sub_4182CC:loc_418B5Do
aSl_si		db 'sl_SI',0            ; DATA XREF: sub_4182CC:loc_418B67o
aSo_so		db 'so_SO',0            ; DATA XREF: sub_4182CC:loc_418B71o
aWen_de		db 'wen_DE',0           ; DATA XREF: sub_4182CC:loc_418B7Bo
aEs_es		db 'es_ES',0            ; DATA XREF: sub_4182CC:loc_418B9Eo
aEs_mx		db 'es_MX',0            ; DATA XREF: sub_4182CC:loc_418BA8o
aEs_es@modern	db 'es_ES@modern',0     ; DATA XREF: sub_4182CC:loc_418BB2o
aEs_gt		db 'es_GT',0            ; DATA XREF: sub_4182CC:loc_418BBCo
aEs_cr		db 'es_CR',0            ; DATA XREF: sub_4182CC:loc_418BC6o
aEs_pa		db 'es_PA',0            ; DATA XREF: sub_4182CC:loc_418BD0o
aEs_do		db 'es_DO',0            ; DATA XREF: sub_4182CC:loc_418BDAo
aEs_ve		db 'es_VE',0            ; DATA XREF: sub_4182CC:loc_418BE4o
aEs_co		db 'es_CO',0            ; DATA XREF: sub_4182CC:loc_418BEEo
aEs_pe		db 'es_PE',0            ; DATA XREF: sub_4182CC:loc_418BF8o
aEs_ar		db 'es_AR',0            ; DATA XREF: sub_4182CC:loc_418C02o
aEs_ec		db 'es_EC',0            ; DATA XREF: sub_4182CC:loc_418C0Co
aEs_cl		db 'es_CL',0            ; DATA XREF: sub_4182CC:loc_418C16o
aEs_uy		db 'es_UY',0            ; DATA XREF: sub_4182CC:loc_418C20o
aEs_py		db 'es_PY',0            ; DATA XREF: sub_4182CC:loc_418C2Ao
aEs_bo		db 'es_BO',0            ; DATA XREF: sub_4182CC:loc_418C34o
aEs_sv		db 'es_SV',0            ; DATA XREF: sub_4182CC:loc_418C3Eo
aEs_hn		db 'es_HN',0            ; DATA XREF: sub_4182CC:loc_418C48o
aEs_ni		db 'es_NI',0            ; DATA XREF: sub_4182CC:loc_418C52o
aEs_pr		db 'es_PR',0            ; DATA XREF: sub_4182CC:loc_418C5Co
aEs		db 'es',0               ; DATA XREF: sub_4182CC:loc_418C66o
aBnt_tz		db 'bnt_TZ',0           ; DATA XREF: sub_4182CC:loc_418C70o
aSw_ke		db 'sw_KE',0            ; DATA XREF: sub_4182CC:loc_418C7Ao
aSv_se		db 'sv_SE',0            ; DATA XREF: sub_4182CC:loc_418C93o
aSv_fi		db 'sv_FI',0            ; DATA XREF: sub_4182CC:loc_418C9Do
aSv		db 'sv',0               ; DATA XREF: sub_4182CC:loc_418CA7o
aSyr_tr		db 'syr_TR',0           ; DATA XREF: sub_4182CC:loc_418CB1o
aTl_ph		db 'tl_PH',0            ; DATA XREF: sub_4182CC:loc_418CBBo
aTg_tj		db 'tg_TJ',0            ; DATA XREF: sub_4182CC:loc_418CC5o
aBer_ma@arabic	db 'ber_MA@arabic',0    ; DATA XREF: sub_4182CC:loc_418CDEo
aBer_ma@latin	db 'ber_MA@latin',0     ; DATA XREF: sub_4182CC:loc_418CE8o
aBer_ma		db 'ber_MA',0           ; DATA XREF: sub_4182CC:loc_418CF2o
aTa		db 'ta',0               ; DATA XREF: sub_4182CC:loc_418CFCo
aTt_ru		db 'tt_RU',0            ; DATA XREF: sub_4182CC:loc_418D06o
aTe_in		db 'te_IN',0            ; DATA XREF: sub_4182CC:loc_418D10o
aTh_th		db 'th_TH',0            ; DATA XREF: sub_4182CC:loc_418D1Ao
aBo_cn		db 'bo_CN',0            ; DATA XREF: sub_4182CC:loc_418D24o
aTi_et		db 'ti_ET',0            ; DATA XREF: sub_4182CC:loc_418D3Co
aTi_er		db 'ti_ER',0            ; DATA XREF: sub_4182CC:loc_418D46o
aTi		db 'ti',0               ; DATA XREF: sub_4182CC:loc_418D50o
aTs_za		db 'ts_ZA',0            ; DATA XREF: sub_4182CC:loc_418D5Ao
aTn_bw		db 'tn_BW',0            ; DATA XREF: sub_4182CC:loc_418D64o
aTr_tr		db 'tr_TR',0            ; DATA XREF: sub_4182CC:loc_418D6Eo
aTk_tm		db 'tk_TM',0            ; DATA XREF: sub_4182CC:loc_418D78o
aUk_ua		db 'uk_UA',0            ; DATA XREF: sub_4182CC:loc_418D82o
aUr_pk		db 'ur_PK',0            ; DATA XREF: sub_4182CC:loc_418D9Bo
aUr_in		db 'ur_IN',0            ; DATA XREF: sub_4182CC:loc_418DA2o
aUr		db 'ur',0               ; DATA XREF: sub_4182CC:loc_418DA9o
aUz_uz		db 'uz_UZ',0            ; DATA XREF: sub_4182CC:loc_418DBFo
aUz_uz@cyrillic	db 'uz_UZ@cyrillic',0   ; DATA XREF: sub_4182CC:loc_418DC6o
aUz		db 'uz',0               ; DATA XREF: sub_4182CC:loc_418DCDo
aVen_za		db 'ven_ZA',0           ; DATA XREF: sub_4182CC:loc_418DD4o
aVi_vn		db 'vi_VN',0            ; DATA XREF: sub_4182CC:loc_418DDBo
aCy_gb		db 'cy_GB',0            ; DATA XREF: sub_4182CC:loc_418DE2o
aXh_za		db 'xh_ZA',0            ; DATA XREF: sub_4182CC:loc_418DE9o
aSit_cn		db 'sit_CN',0           ; DATA XREF: sub_4182CC:loc_418DF0o
aYi_il		db 'yi_IL',0            ; DATA XREF: sub_4182CC:loc_418DF7o
aYo_ng		db 'yo_NG',0            ; DATA XREF: sub_4182CC:loc_418DFEo
aZu_za		db 'zu_ZA',0            ; DATA XREF: sub_4182CC:loc_418E05o
		align 4
off_4266DC	dd offset loc_418E0C, offset loc_4183A8, offset	loc_4184ED
					; DATA XREF: sub_4182CC+B5o
		dd offset loc_41850B, offset loc_41851F, offset	loc_4185AA ; jump table	for switch statement
		dd offset loc_4185B4, offset loc_41880C, offset	loc_41885D
		dd offset loc_4185FF, offset loc_418B85, offset	loc_4186F4
		dd offset loc_4186FE, offset loc_41888F, offset	loc_4188A3
		dd offset loc_4188B7, offset loc_4188DF, offset	loc_41890C
		dd offset loc_41896B, offset loc_4185C8, offset	loc_418A3D
		dd offset loc_418A92, offset loc_418A9C, offset	loc_418AE3
		dd offset loc_418AED, offset loc_418B09, offset	loc_418570
		dd offset loc_418B5D, offset loc_418394, offset	loc_418C84
		dd offset loc_418D1A, offset loc_418D6E, offset	loc_418D8C
		dd offset loc_4188CB, offset loc_418D82, offset	loc_4184B6
		dd offset loc_418B67, offset loc_4186D6, offset	loc_418993
		dd offset loc_41899D, offset loc_418CC5, offset	loc_4186EA
		dd offset loc_418DDB, offset loc_41846B, offset	loc_41847F
		dd offset loc_4184AC, offset loc_418B7B, offset	loc_4189A7
		dd offset loc_418C70, offset loc_418D5A, offset	loc_418D64
		dd offset loc_418DD4, offset loc_418DE9, offset	loc_418E05
		dd offset loc_41838A, offset loc_418802, offset	loc_4186E0
		dd offset loc_418899, offset loc_4189E8, offset	loc_418B13
		dd offset loc_4187CB, offset loc_418DF7, offset	loc_4189B1
		dd offset loc_418957, offset loc_418975, offset	loc_418C7A
		dd offset loc_418D78, offset loc_418DB0, offset	loc_418D06
		dd offset loc_4184C0, offset loc_418AC7, offset	loc_418871
		dd offset loc_418A6A, offset loc_418CFC, offset	loc_418D10
		dd offset loc_418916, offset loc_4189DE, offset	loc_418475
		dd offset loc_4189FC, offset loc_418B1D, offset	loc_418A06
		dd offset loc_418D24, offset loc_418DE2, offset	loc_418501
		dd offset loc_41897F, offset loc_4184F7, offset	loc_4187F8
		dd offset loc_418961, offset loc_4189F2, offset	loc_418B27
		dd offset loc_418CB1, offset loc_418B53, offset	loc_418515
		dd offset loc_4188D5, offset loc_41839E, offset	loc_418CCF
		dd offset loc_41892A, offset loc_418A10, offset	loc_4187B7
		dd offset loc_418A88, offset loc_418CBB, offset	loc_4185BE
		dd offset loc_4185F5, offset loc_4187C1, offset	loc_41887B
		dd offset loc_4188AD, offset loc_418DFE, offset	loc_418E0C
		dd offset loc_418E0C, offset loc_418E0C, offset	loc_418E0C
		dd offset loc_418E0C, offset loc_4188C1, offset	loc_418920
		dd offset loc_418A74, offset loc_418D2E, offset	loc_418867
		dd offset loc_418885, offset loc_418989, offset	loc_418B71
		dd offset loc_418DF0, offset loc_418A7E
off_4268C4	dd offset loc_418461	; DATA XREF: sub_4182CC+ECo
		dd offset loc_4183C1	; jump table for switch	statement
		dd offset loc_4183CB
		dd offset loc_4183D5
		dd offset loc_4183DF
		dd offset loc_4183E9
		dd offset loc_4183F3
		dd offset loc_4183FD
		dd offset loc_418407
		dd offset loc_418411
		dd offset loc_41841B
		dd offset loc_418425
		dd offset loc_41842F
		dd offset loc_418439
		dd offset loc_418443
		dd offset loc_41844D
		dd offset loc_418457
off_426908	dd offset loc_418566	; DATA XREF: sub_4182CC+25Fo
		dd offset loc_418534	; jump table for switch	statement
		dd offset loc_41853E
		dd offset loc_418548
		dd offset loc_418552
		dd offset loc_41855C
off_426920	dd offset loc_4186CC	; DATA XREF: sub_4182CC+343o
		dd offset loc_418618	; jump table for switch	statement
		dd offset loc_418622
		dd offset loc_41862C
		dd offset loc_418636
		dd offset loc_418640
		dd offset loc_41864A
		dd offset loc_418654
		dd offset loc_41865E
		dd offset loc_418668
		dd offset loc_418672
		dd offset loc_41867C
		dd offset loc_418686
		dd offset loc_418690
		dd offset loc_41869A
		dd offset loc_4186A4
		dd offset loc_4186AE
		dd offset loc_4186B8
		dd offset loc_4186C2
off_42696C	dd offset loc_4187AD	; DATA XREF: sub_4182CC+442o
		dd offset loc_418717	; jump table for switch	statement
		dd offset loc_418721
		dd offset loc_41872B
		dd offset loc_418735
		dd offset loc_41873F
		dd offset loc_418749
		dd offset loc_418753
		dd offset loc_41875D
		dd offset loc_418767
		dd offset loc_418771
		dd offset loc_41877B
		dd offset loc_418785
		dd offset loc_41878F
		dd offset loc_418799
		dd offset loc_4187A3
off_4269AC	dd offset loc_418853	; DATA XREF: sub_4182CC+54Co
		dd offset loc_418821	; jump table for switch	statement
		dd offset loc_41882B
		dd offset loc_418835
		dd offset loc_41883F
		dd offset loc_418849
off_4269C4	dd offset loc_418C66	; DATA XREF: sub_4182CC+8C9o
		dd offset loc_418B9E	; jump table for switch	statement
		dd offset loc_418BA8
		dd offset loc_418BB2
		dd offset loc_418BBC
		dd offset loc_418BC6
		dd offset loc_418BD0
		dd offset loc_418BDA
		dd offset loc_418BE4
		dd offset loc_418BEE
		dd offset loc_418BF8
		dd offset loc_418C02
		dd offset loc_418C0C
		dd offset loc_418C16
		dd offset loc_418C20
		dd offset loc_418C2A
		dd offset loc_418C34
		dd offset loc_418C3E
		dd offset loc_418C48
		dd offset loc_418C52
		dd offset loc_418C5C
; char aRb_1[3]
aRb_1		db 'rb',0               ; DATA XREF: sub_418EF2+16o
; char aLc_messages[]
aLc_messages	db 'LC_MESSAGES',0      ; DATA XREF: sub_419496+16o
					; .text:00419DE9o
aLc_messages_0	db '\LC_MESSAGES\',0    ; DATA XREF: sub_419496+1AAo
a_mo		db '.mo',0              ; DATA XREF: sub_419496+202o
		align 4
aErrorInGettext	db 'ERROR in GETTEXT (bad plural entry)',0 ; DATA XREF: sub_4196F0+3Bo
aErrorInGette_0	db 'ERROR in GETTEXT MALLOC',0 ; DATA XREF: sub_419756+13Do
					; sub_419756:loc_4199B9o
aErrorInGette_1	db 'ERROR in GETTEXT (overflow space)',0Ah,0
					; DATA XREF: sub_419756:loc_419A2Do
byte_426A9B	db 0			; DATA XREF: .text:loc_419E03o
asc_426A9C	db '-',0                ; DATA XREF: sub_419E4D+55o
					; sub_41A0AC:loc_41A0BDo
aSocket		db 'socket://',0        ; DATA XREF: sub_419E4D+9Do
aSystemDoesNotS	db 'system does not support logging to a socket - using stderr',0Ah,0
					; DATA XREF: sub_419E4D+FDo
; char aA_0[]
aA_0		db 'a',0                ; DATA XREF: sub_419E4D+131o
					; sub_419E4D:loc_419FBDo
		align 4
; char aFailedToOpenLo[]
aFailedToOpenLo	db 'failed to open log file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_419E4D+1B1o
		align 4
; char aFailedToFdopen[]
aFailedToFdopen	db 'failed to fdopen file descriptor %d: %s',0Ah,0
					; DATA XREF: sub_419E4D+1E9o
		align 4
; char a____Gnupg22__4[]
a____Gnupg22__4	db '../../gnupg2-2.0.30/jnlib/logging.c',0 ; DATA XREF: sub_41A26E+2Fo
; char aLogstream[]
aLogstream	db 'logstream',0        ; DATA XREF: sub_41A26E+37o
		align 4
; char a04d02d02d02d02[]
a04d02d02d02d02	db '%04d-%02d-%02d %02d:%02d:%02d ',0 ; DATA XREF: sub_41A26E+E3o
; char aU_Lx[]
aU_Lx		db '[%u.%lx]',0         ; DATA XREF: sub_41A26E+16Bo
; char aU[]
aU		db '[%u]',0             ; DATA XREF: sub_41A26E+192o
aFatal		db 'Fatal: ',0          ; DATA XREF: sub_41A26E+21Do
aOhhhhJeeee	db 'Ohhhh jeeee: ',0    ; DATA XREF: sub_41A26E+246o
aDbg		db 'DBG: ',0            ; DATA XREF: sub_41A26E+26Fo
; char aUnknownLogLeve[]
aUnknownLogLeve	db '[Unknown log level %d]: ',0 ; DATA XREF: sub_41A26E:loc_41A500o
		align 4
off_426BCC	dd offset loc_41A51F	; DATA XREF: sub_41A26E+20Eo
		dd offset loc_41A51F	; jump table for switch	statement
		dd offset loc_41A51F
		dd offset loc_41A51F
		dd offset loc_41A51F
		dd offset loc_41A485
		dd offset loc_41A4AE
		dd offset loc_41A4D7
dword_426BEC	dd 207325h		; DATA XREF: .text:0041A779o
a02x_0		db '%02X',0             ; DATA XREF: .text:0041A79Eo
a02x_1		db ' %02X',0            ; DATA XREF: .text:0041A7C1o
asc_426BFB	db 0Ah,0		; DATA XREF: .text:0041A7E6o
; char a___ThisIsABugS[]
a___ThisIsABugS	db '... this is a bug (%s:%d:%s)',0Ah,0 ; DATA XREF: sub_41A7F4+1Bo
		align 4
asc_426C1C	db ' ',9,0Dh,0Ah,0      ; DATA XREF: .text:0041AC16o
					; .text:0041ACAEo
a_		db '.',0                ; DATA XREF: .text:0041AD9Bo
		align 4
a____Gnupg22__5	db '../../gnupg2-2.0.30/jnlib/stringhelp.c',0 ; DATA XREF: sub_41AE02+A0o
; char aHome_1[]
aHome_1		db 'HOME',0             ; DATA XREF: sub_41AE02:loc_41AF23o
; char aX02x_1[]
aX02x_1		db 'x%02x',0            ; DATA XREF: sub_41B3B7+164o
					; sub_41B76B+1B0o
; char word_426C56[]
word_426C56	dw 0			; DATA XREF: .text:0041C1FBo
					; sub_41C22E+Co
aFatalTooManyAr	db 0Ah			; DATA XREF: sub_41C22E+56o
		db 'fatal: too many args for xstrconcat',0Ah,0
aFatalOutOfMemo	db 0Ah			; DATA XREF: sub_41C22E+81o
		db 'fatal: out of memory',0Ah,0
aDo_make_filena	db 'do_make_filename',0 ; DATA XREF: sub_41AE02+90o
		align 4
; char aInvalidArgum_0[]
aInvalidArgum_0	db 'invalid argument for arg_parsee',0Ah,0 ; DATA XREF: sub_41C2E4+81o
; char aArgumentNotExp[]
aArgumentNotExp	db 'argument not expected',0 ; DATA XREF: sub_41C2E4+B0o
; char aReadError[]
aReadError	db 'read error',0       ; DATA XREF: sub_41C2E4+CFo
; char aKeywordTooLong[]
aKeywordTooLong	db 'keyword too long',0 ; DATA XREF: sub_41C2E4+EEo
; char aMissingArgumen[]
aMissingArgumen	db 'missing argument',0 ; DATA XREF: sub_41C2E4+10Do
; char aInvalidArgum_1[]
aInvalidArgum_1	db 'invalid argument',0 ; DATA XREF: sub_41C2E4+129o
; char aInvalidCommand[]
aInvalidCommand	db 'invalid command',0  ; DATA XREF: sub_41C2E4+145o
; char aInvalidAliasDe[]
aInvalidAliasDe	db 'invalid alias definition',0 ; DATA XREF: sub_41C2E4+161o
; char aOutOfCore[]
aOutOfCore	db 'out of core',0      ; DATA XREF: sub_41C2E4+17Do
; char aInvalidOption[]
aInvalidOption	db 'invalid option',0   ; DATA XREF: sub_41C2E4:loc_41C472o
; char aSUS[]
aSUS		db '%s:%u: %s',0Ah,0    ; DATA XREF: sub_41C2E4+1B4o
a??		db '[??]',0             ; DATA XREF: sub_41C2E4:loc_41C4BBo
		align 4
; char aMissingArgum_0[]
aMissingArgum_0	db 'missing argument for option "%.50s"',0Ah,0 ; DATA XREF: sub_41C2E4+1EAo
		align 4
; char aInvalidArgum_2[]
aInvalidArgum_2	db 'invalid argument for option "%.50s"',0Ah,0 ; DATA XREF: sub_41C2E4+215o
		align 4
; char aOption_50sDoes[]
aOption_50sDoes	db 'option "%.50s" does not expect an argument',0Ah,0
					; DATA XREF: sub_41C2E4+240o
; char aInvalidComma_0[]
aInvalidComma_0	db 'invalid command "%.50s"',0Ah,0 ; DATA XREF: sub_41C2E4+26Bo
; char aOption_50sIsAm[]
aOption_50sIsAm	db 'option "%.50s" is ambiguous',0Ah,0 ; DATA XREF: sub_41C2E4+296o
; char aCommand_50sIsA[]
aCommand_50sIsA	db 'command "%.50s" is ambiguous',0Ah,0 ; DATA XREF: sub_41C2E4+2BEo
; char aOutOfCore_0[]
aOutOfCore_0	db 'out of core',0Ah,0  ; DATA XREF: sub_41C2E4+2E6o
; char aS_1[]
aS_1		db '%s',0Ah,0           ; DATA XREF: sub_41C2E4+2F6o
; char aInvalidOption_[]
aInvalidOption_	db 'invalid option "%.50s"',0Ah,0 ; DATA XREF: sub_41C2E4:loc_41C5E8o
; char aIgnoreInvalidO[]
aIgnoreInvalidO	db 'ignore-invalid-option',0 ; DATA XREF: sub_41C84E+15Do
					; sub_41C84E:loc_41CE6Ao
; char asc_426E83[]
asc_426E83	db ' ',9,0              ; DATA XREF: sub_41C84E+2D3o
; char aAlias[]
aAlias		db 'alias',0            ; DATA XREF: sub_41C84E+5EFo
; char Str1[]
Str1		db 'help',0             ; DATA XREF: sub_41D231+1A6o
; char aVersion[]
aVersion	db 'version',0          ; DATA XREF: sub_41D231+1E0o
; char aWarranty[]
aWarranty	db 'warranty',0         ; DATA XREF: sub_41D231+222o
; char aDumpOptions[]
aDumpOptions	db 'dump-options',0     ; DATA XREF: sub_41D231+266o
; char aS_2[]
aS_2		db '--%s',0Ah,0         ; DATA XREF: sub_41D231+2B2o
		align 4
aDumpOptionsHel	db '--dump-options',0Ah ; DATA XREF: sub_41D231+2DEo
		db '--help',0Ah
		db '--version',0Ah
		db '--warranty',0Ah,0
asc_426EE4	db 'x',0                ; DATA XREF: sub_41D231:loc_41D92Bo
; char aOptions[]
aOptions	db 'Options:',0         ; DATA XREF: sub_41DC1C+CEo
; char aC_1[]
aC_1		db ' -%c',0             ; DATA XREF: sub_41DC1C+1B1o
asc_426EF4	db '   ',0              ; DATA XREF: sub_41DC1C+245o
					; sub_41DC1C+332o
; char aCS[]
aCS		db '%c --%s',0          ; DATA XREF: sub_41DC1C:loc_41DEC0o
; char aASingleDashMay[]
aASingleDashMay	db 0Ah			; DATA XREF: sub_41DC1C+45Co
		db '(A single dash may be used instead of the double ones)',0
; char SubStr[]
SubStr		db '@EMAIL@',0          ; DATA XREF: sub_41DC1C+48Do
aHttpBugs_gnupg	db 'http://bugs.gnupg.org',0 ; DATA XREF: sub_41DC1C+4F0o
; char aS_3[]
aS_3		db ' (%s)',0            ; DATA XREF: sub_41E187+3Co
; char aSS_0[]
aSS_0		db ' %s %s',0Ah,0       ; DATA XREF: sub_41E187+5Co
aGpg4win2_3_1	db '(Gpg4win 2.3.1)',0  ; DATA XREF: sub_41E187+61o
aSSS		db '%s %s; %s',0Ah,0    ; DATA XREF: .text:0041E351o
		align 10h
aLicenseGplv3Gn	db 'License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licens'
					; DATA XREF: sub_41E43D:loc_41E483o
		db 'es/gpl.html>',0
aFoo		db 'foo',0              ; DATA XREF: sub_41E43D:loc_41E48Co
a0_0_0		db '0.0',0              ; DATA XREF: sub_41E43D:loc_41E495o
		align 4
aCopyrightC2015	db 'Copyright (C) 2015 Free Software Foundation, Inc.',0
					; DATA XREF: sub_41E43D:loc_41E49Eo
		align 4
aThisIsFreeSoft	db 'This is free software: you are free to change and redistribute it'
					; DATA XREF: sub_41E43D:loc_41E4A7o
		db '.',0Ah
		db 'There is NO WARRANTY, to the extent permitted by law.',0Ah,0
		align 4
aThisIsFreeSo_0	db 'This is free software; you can redistribute it and/or modify',0Ah
					; DATA XREF: sub_41E43D:loc_41E4B0o
		db 'it under the terms of the GNU General Public License as published'
		db ' by',0Ah
		db 'the Free Software Foundation; either version 3 of the License, or'
		db 0Ah
		db '(at your option) any later version.',0Ah
		db 0Ah
		db 'It is distributed in the hope that it will be useful,',0Ah
		db 'but WITHOUT ANY WARRANTY; without even the implied warranty of',0Ah
		db 'MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the',0Ah
		db 'GNU General Public License for more details.',0Ah
		db 0Ah
		db 'You should have received a copy of the GNU General Public License'
		db 0Ah
		db 'along with this software.  If not, see <http://www.gnu.org/licens'
		db 'es/>.',0Ah,0
dword_4272DC	dd 0			; DATA XREF: sub_41E43D:loc_41E4B9o
off_4272E0	dd offset loc_41E483	; DATA XREF: sub_41E43D+3Dr
		dd offset loc_41E48C	; jump table for switch	statement
		dd offset loc_41E4C1
		dd offset loc_41E495
		dd offset loc_41E49E
		dd offset loc_41E4A7
		dd offset loc_41E4B0
		dd offset loc_41E4C1
		dd offset loc_41E4C1
		dd offset loc_41E4C1
		dd offset loc_41E4C1
		dd offset loc_41E4C1
		dd offset loc_41E4C1
		dd offset loc_41E4C1
		dd offset loc_41E4C1
		dd offset loc_41E4C1
		dd offset loc_41E4C1
		dd offset loc_41E4C1
		dd offset loc_41E4C1
		dd offset loc_41E4C1
		dd offset loc_41E4C1
		dd offset loc_41E4C1
		dd offset loc_41E4C1
		dd offset loc_41E4C1
		dd offset loc_41E4C1
		dd offset loc_41E4C1
		dd offset loc_41E4C1
		dd offset loc_41E4C1
		dd offset loc_41E4C1
		dd offset loc_41E4C1
		dd offset loc_41E4B9
		dd offset loc_41E4B9
aHkey_classes_r	db 'HKEY_CLASSES_ROOT',0 ; DATA XREF: sub_41E4D4+1Fo
aHkey_current_u	db 'HKEY_CURRENT_USER',0 ; DATA XREF: sub_41E4D4+53o
aHkey_local_mac	db 'HKEY_LOCAL_MACHINE',0 ; DATA XREF: sub_41E4D4+87o
aHkey_users	db 'HKEY_USERS',0       ; DATA XREF: sub_41E4D4+BBo
aHkey_performan	db 'HKEY_PERFORMANCE_DATA',0 ; DATA XREF: sub_41E4D4+ECo
aHkey_current_c	db 'HKEY_CURRENT_CONFIG',0 ; DATA XREF: sub_41E4D4+11Do
aIso88591	db 'iso-8859-1',0       ; DATA XREF: sub_41E950+D9o
					; sub_41EA4F:loc_41EC24o ...
aUtf8		db 'utf-8',0            ; DATA XREF: sub_41E950+22o
					; sub_41EA4F+20Fo ...
		align 10h
; char aConversionFrom[]
aConversionFrom	db 'conversion from `%s',27h,' to `%s',27h,' not available',0Ah,0
					; DATA XREF: sub_41E950+71o
; char aIconv_openFail[]
aIconv_openFail	db 'iconv_open failed: %s',0Ah,0 ; DATA XREF: sub_41E950+B1o
; char aCpU[]
aCpU		db 'CP%u',0             ; DATA XREF: sub_41EA4F:loc_41EA7Ao
aCp936		db 'CP936',0            ; DATA XREF: sub_41EA4F+4Eo
aGbk		db 'GBK',0
aCp1361		db 'CP1361',0
aJohab		db 'JOHAB',0
aCp20127	db 'CP20127',0
aAscii_0	db 'ASCII',0
aCp20866	db 'CP20866',0
aKoi8R		db 'KOI8-R',0
aCp21866	db 'CP21866',0
aKoi8Ru		db 'KOI8-RU',0
aCp28591	db 'CP28591',0
aIso88591_0	db 'ISO-8859-1',0
aCp28592	db 'CP28592',0
aIso88592	db 'ISO-8859-2',0
aCp28593	db 'CP28593',0
aIso88593	db 'ISO-8859-3',0
aCp28594	db 'CP28594',0
aIso88594	db 'ISO-8859-4',0
aCp28595	db 'CP28595',0
aIso88595	db 'ISO-8859-5',0
aCp28596	db 'CP28596',0
aIso88596	db 'ISO-8859-6',0
aCp28597	db 'CP28597',0
aIso88597	db 'ISO-8859-7',0
aCp28598	db 'CP28598',0
aIso88598	db 'ISO-8859-8',0
aCp28599	db 'CP28599',0
aIso88599	db 'ISO-8859-9',0
aCp28605	db 'CP28605',0
aIso885915	db 'ISO-8859-15',0
aCp65001	db 'CP65001',0
aUtf8_1		db 'UTF-8',0
		align 2
aIso		db 'iso',0              ; DATA XREF: sub_41EA4F+13Co
a88591		db '8859-1',0           ; DATA XREF: sub_41EA4F+179o
a646		db '646',0              ; DATA XREF: sub_41EA4F+190o
aAscii		db 'ASCII',0            ; DATA XREF: sub_41EA4F+1A7o
aAnsi_x3_41968	db 'ANSI_X3.4-1968',0   ; DATA XREF: sub_41EA4F+1BEo
aUtf8_0		db 'utf8',0             ; DATA XREF: sub_41EA4F:loc_41EC47o
		align 4
; char aConversionFr_0[]
aConversionFr_0	db 'conversion from `%s',27h,' to `%s',27h,' failed: %s',0Ah,0
					; DATA XREF: sub_41ED65+1EEo
					; sub_41EFB1+730o
; char aX02x_2[]
aX02x_2		db '\x%02x',0           ; DATA XREF: sub_41EFB1+7Co
					; sub_41EFB1+3AFo ...
; char aX02x_3[]
aX02x_3		db 'x%02x',0            ; DATA XREF: sub_41EFB1+1DCo
		align 4
a____Gnupg22__6	db '../../gnupg2-2.0.30/jnlib/utf8conv.c',0 ; DATA XREF: sub_41EFB1+6BEo
		align 4
off_4275C4	dd offset loc_41F164	; DATA XREF: sub_41EFB1+12Ar
		dd offset loc_41F17A	; jump table for switch	statement
		dd offset loc_41F17A
		dd offset loc_41F17A
		dd offset loc_41F17A
		dd offset loc_41F17A
		dd offset loc_41F17A
		dd offset loc_41F17A
		dd offset loc_41F14E
		dd offset loc_41F17A
		dd offset loc_41F0E4
		dd offset loc_41F138
		dd offset loc_41F11E
		dd offset loc_41F101
aDo_utf8_to_nat	db 'do_utf8_to_native',0 ; DATA XREF: sub_41EFB1+6AEo
		align 10h
; CHAR LibFileName[]
LibFileName	db 'mingwm10.dll',0     ; DATA XREF: TlsCallback_0+4Eo
; CHAR a__mingwthr_rem[]
a__mingwthr_rem	db '__mingwthr_remove_key_dtor',0 ; DATA XREF: TlsCallback_0+71o
; CHAR a__mingwthr_key[]
a__mingwthr_key	db '__mingwthr_key_dtor',0 ; DATA XREF: TlsCallback_0+8Bo
off_42764C	dd offset TlsCallback_0	; DATA XREF: sub_401180:loc_401273r
aUnknownError	db 'Unknown error',0    ; DATA XREF: sub_41FD80+3o
		align 10h
; char a_matherrSInSGG[]
a_matherrSInSGG	db '_matherr(): %s in %s(%g, %g)  (retval=%g)',0Ah,0
					; DATA XREF: sub_41FD80+39o
		align 4
aArgumentDomain	db 'Argument domain error (DOMAIN)',0 ; DATA XREF: .rdata:off_42776Co
aArgumentSingul	db 'Argument singularity (SIGN)',0 ; DATA XREF: .rdata:00427770o
		align 4
aOverflowRangeE	db 'Overflow range error (OVERFLOW)',0 ; DATA XREF: .rdata:00427774o
aTheResultIsToo	db 'The result is too small to be represented (UNDERFLOW)',0
					; DATA XREF: .rdata:00427778o
		align 10h
aTotalLossOfSig	db 'Total loss of significance (TLOSS)',0 ; DATA XREF: .rdata:0042777Co
		align 4
aPartialLossOfS	db 'Partial loss of significance (PLOSS)',0 ; DATA XREF: .rdata:00427780o
		align 4
off_42776C	dd offset aArgumentDomain ; DATA XREF: sub_41FD80+16r
					; "Argument domain error (DOMAIN)"
		dd offset aArgumentSingul ; "Argument singularity (SIGN)"
		dd offset aOverflowRangeE ; "Overflow range error (OVERFLOW)"
		dd offset aTheResultIsToo ; "The result	is too small to	be represent"...
		dd offset aTotalLossOfSig ; "Total loss	of significance	(TLOSS)"
		dd offset aPartialLossOfS ; "Partial loss of significance (PLOSS)"
aMingwW64Runtim	db 'Mingw-w64 runtime failure:',0Ah,0 ; DATA XREF: sub_41FDF0+1Do
; char aAddressPHasNoI[]
aAddressPHasNoI	db 'Address %p has no image-section',0 ; DATA XREF: sub_41FE50+20Do
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: sub_41FE50+1F9o
					; sub_41FE50+225o ...
		align 4
; char aVirtualprotect[]
aVirtualprotect	db '  VirtualProtect failed with code 0x%x',0 ; DATA XREF: sub_41FE50+1D2o
		align 4
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_420090+299o
		align 10h
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_420090+1B7o
		align 4
; const	WCHAR aMsvcrt_dll
aMsvcrt_dll:				; DATA XREF: sub_420640:loc_4206E0o
		unicode	0, <msvcrt.dll>,0
		align 4
off_427894	dd offset dword_428FA0	; DATA XREF: .text:004208D8o
		dd offset dword_428CC0
; char aAssertionFaile[]
aAssertionFaile	db 'Assertion failed!',0Ah ; DATA XREF: sub_420E60+EAo
		db 0Ah
		db 'Program: %s',0Ah
		db 'File: %s, Line %u',0Ah
		db 0Ah
		db 'Expression: %s',0
; char aS_4[]
aS_4		db '%s',0Ah,0           ; DATA XREF: sub_420E60+1C2o
; CHAR Caption[]
Caption		db 'MinGW Runtime Assertion',0 ; DATA XREF: sub_420E60+10Fo
		align 10h
dword_427900	dd 1			; DATA XREF: .text:loc_4216F1r
dword_427904	dd 16h			; DATA XREF: .text:004216E7r
					; .text:004216FFr
		dd 2 dup(2), 3,	2, 4, 18h, 5, 0Dh, 6, 9, 7, 0Ch, 8, 0Ch
		dd 9, 0Ch, 0Ah,	7, 0Bh,	8, 0Ch,	16h, 0Dh, 16h, 0Fh, 2
		dd 10h,	0Dh, 11h, 2 dup(12h), 2, 21h, 0Dh, 35h,	2, 41h
		dd 0Dh,	43h, 2,	50h, 11h, 52h, 0Dh, 53h, 0Dh, 57h, 16h
		dd 59h,	0Bh, 6Ch, 0Dh, 6Dh, 20h, 70h, 1Ch, 72h,	9, 6, 16h
		dd 80h,	0Ah, 81h, 0Ah, 82h, 9, 83h, 16h, 84h, 0Dh, 91h
		dd 29h,	9Eh, 0Dh, 0A1h,	2, 0A4h, 0Bh, 0A7h, 0Dh, 0B7h
		dd 11h,	0CEh, 2, 0D7h, 0Bh, 718h, 0Ch, 0
		dd 0FFFFFFFFh, 4 dup(0)
dword_427A80	dd 0			; DATA XREF: sub_420090+59o
					; sub_420090+5Eo ...
dword_427A84	dd 0			; DATA XREF: sub_420090+7Fr
dword_427A88	dd 0			; DATA XREF: sub_420090:loc_4201DCr
dword_427A8C	dd 5Dh dup(0)		; DATA XREF: sub_420090+155o
		align 800h
_rdata		ends

; Section 4. (virtual address 00028000)
; Virtual size			: 00001098 (   4248.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 428000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_428000	dd ?			; DATA XREF: sub_401180+D0w
					; sub_401180+27Dr
dword_428004	dd ?			; DATA XREF: sub_401010+2Ao
					; sub_401180:loc_401344r ...
dword_428008	dd ?			; DATA XREF: sub_401010+18o
					; sub_401180+1DEr ...
dword_42800C	dd ?			; DATA XREF: sub_401010+10o
					; sub_401180+243r ...
dword_428010	dd ?			; DATA XREF: sub_401180+272w
					; sub_401180+28Cr
dword_428014	dd ?			; DATA XREF: sub_401060:loc_401098w
					; sub_401180+26Ar
dword_428018	dd ?			; DATA XREF: sub_401010+8o
					; sub_401010+20w
dword_42801C	dd ?			; DATA XREF: sub_401010+3Aw
; void *dword_428020
dword_428020	dd ?			; DATA XREF: sub_402F25+7r
					; sub_402F25+75r ...
dword_428024	dd ?			; DATA XREF: sub_401D70+7r
					; sub_401D70+8Dr ...
; FILE *File
File		dd ?			; DATA XREF: sub_40377D+1248r
					; sub_40377D+1259r ...
		align 20h
dword_428040	dd ?			; DATA XREF: sub_4031FB+1BEw
					; sub_40351C+20r ...
; HANDLE hObject
hObject		dd ?			; DATA XREF: sub_4031FB+2A7w
					; sub_4031FB+2BAr ...
		dd 1FEh	dup(?)
dword_428840	dd ?			; DATA XREF: sub_402175+10r
					; sub_402175:loc_4021A5r ...
		align 20h
dword_428860	dd ?			; DATA XREF: sub_409AE3+20r
					; sub_409C1D+Br ...
dword_428864	dd ?			; DATA XREF: sub_409DB0+E4w
					; sub_40A067+Er
dword_428868	dd ?			; DATA XREF: sub_40A3B2:loc_40A3D3r
					; sub_40A3B2+88w ...
dword_42886C	dd ?			; DATA XREF: sub_40A3B2:loc_40A46Cr
					; sub_40A3B2+121w ...
dword_428870	dd ?			; DATA XREF: sub_40A3B2:loc_40A505r
					; sub_40A3B2+1BAw ...
dword_428874	dd ?			; DATA XREF: sub_40A3B2:loc_40A59Er
					; sub_40A3B2+253w ...
dword_428878	dd ?			; DATA XREF: sub_40A3B2:loc_40A637r
					; sub_40A3B2+2ECw ...
dword_42887C	dd ?			; DATA XREF: sub_40A3B2:loc_40A6D0r
					; sub_40A3B2+385w ...
dword_428880	dd ?			; DATA XREF: sub_40A3B2:loc_40A769r
					; sub_40A3B2+41Ew ...
dword_428884	dd ?			; DATA XREF: sub_40A3B2:loc_40A802r
					; sub_40A3B2+4B7w ...
dword_428888	dd ?			; DATA XREF: sub_40A3B2:loc_40A89Br
					; sub_40A3B2+550w ...
dword_42888C	dd ?			; DATA XREF: sub_40A3B2:loc_40A934r
					; sub_40A3B2+5E9w ...
dword_428890	dd ?			; DATA XREF: .text:0040A2B4r
					; .text:0040A378w ...
dword_428894	dd ?			; DATA XREF: sub_40A206+8r
					; sub_40A206+6Fw ...
dword_428898	dd ?			; DATA XREF: sub_40A163+8r
					; sub_40A163+6Fw ...
dword_42889C	dd ?			; DATA XREF: sub_40A0C0+8r
					; sub_40A0C0+6Fw ...
dword_4288A0	dd ?			; DATA XREF: sub_40A067+17r
					; sub_40A067+3Bw ...
dword_4288A4	dd ?			; DATA XREF: sub_409FC4+8r
					; sub_409FC4+6Fw ...
dword_4288A8	dd ?			; DATA XREF: sub_409EDD+Br
					; sub_409EDD+C1w ...
dword_4288AC	dd ?			; DATA XREF: sub_409DB0+8r
					; sub_409DB0:loc_409E0Dw
		align 20h
; CHAR Filename
Filename	db ?			; DATA XREF: sub_409DB0+1Do
					; sub_409DB0+56w ...
		align 4
		dd 42h dup(?)
dword_4289CC	dd ?			; DATA XREF: sub_409C1D:loc_409C5Er
					; sub_409C1D+A4w ...
; LPCSTR lpPathName
lpPathName	dd ?			; DATA XREF: sub_409AE3+Br
					; sub_409AE3+44w ...
dword_4289D4	dd ?			; DATA XREF: sub_409A09+6r
					; sub_409A09+13w
dword_4289D8	dd ?			; DATA XREF: sub_409A09+63w
					; sub_409A09+68r ...
		align 10h
; HANDLE hConsoleHandle
hConsoleHandle	dd ?			; DATA XREF: sub_40ADBE+103w
					; sub_40ADBE+108r ...
; HANDLE hConsoleOutput
hConsoleOutput	dd ?			; DATA XREF: sub_40ADBE+78w
					; sub_40ADBE+7Dr ...
dword_4289E8	dd ?			; DATA XREF: sub_40ADBE+6r
					; sub_40ADBE+15Dw ...
dword_4289EC	dd ?			; DATA XREF: sub_40AF6D:loc_40B03Br
					; sub_40AF6D+D6w ...
dword_4289F0	dd ?			; DATA XREF: .text:0040AF30r
					; .text:0040AF41w ...
dword_4289F4	dd ?			; DATA XREF: .text:0040AF51r
					; .text:0040AF63w ...
dword_4289F8	dd ?			; DATA XREF: .text:0040B76Bw
dword_4289FC	dd ?			; DATA XREF: .text:0040B773w
dword_428A00	dd ?			; DATA XREF: .text:0040B77Bw
					; .text:0040B79Dr ...
dword_428A04	dd ?			; DATA XREF: .text:0040B763w
dword_428A08	dd ?			; DATA XREF: sub_40B4FF+21r
					; sub_40B4FF+53r ...
dword_428A0C	dd ?			; DATA XREF: sub_40B4FF+2Er
					; sub_40B4FF+F2r ...
dword_428A10	dd ?			; DATA XREF: .text:0040ADA7r
					; .text:0040ADB0r
dword_428A14	dd ?			; DATA XREF: .text:0040B99Br
					; .text:0040B9A4w
dword_428A18	dd ?			; DATA XREF: .text:0040B9D8w
					; .text:0040B9F2o
dword_428A1C	dd ?			; DATA XREF: .text:0040B9DDo
dword_428A20	dd ?			; DATA XREF: sub_40D038+23r
					; sub_40D038+2Cr ...
dword_428A24	dd ?			; DATA XREF: .text:loc_40DE68r
					; .text:0040E2D9w ...
dword_428A28	dd ?			; DATA XREF: sub_40E53A+3Fr
					; sub_40E53A+4Eo ...
dword_428A2C	dd ?			; DATA XREF: sub_40E53A+2Ar
					; sub_40E53A+7Ar ...
dword_428A30	dd ?			; DATA XREF: .text:004112A1w
					; .text:0041136Fr
dword_428A34	dd ?			; DATA XREF: .text:004113AAr
dword_428A38	dd ?			; DATA XREF: .text:004113DFr
byte_428A3C	db ?			; DATA XREF: .text:0041128Fo
					; .text:004112ABo ...
byte_428A3D	db ?			; DATA XREF: .text:0041139Fr
byte_428A3E	db ?			; DATA XREF: .text:loc_4113D4r
		align 10h
dword_428A40	dd ?			; DATA XREF: sub_40E6C5+6r
					; sub_40E6C5+Fw
dword_428A44	dd ?			; DATA XREF: sub_413B99+6r
					; sub_413B99+Fw
dword_428A48	dd ?			; DATA XREF: sub_41411A:loc_414165r
					; sub_4142EA:loc_414358r ...
dword_428A4C	dd ?			; DATA XREF: .text:004159D7w
					; sub_4159DE+6r
dword_428A50	dd ?			; DATA XREF: sub_417994+B7r
					; sub_417994:loc_417A9Dw
dword_428A54	dd ?			; DATA XREF: sub_417994+F0w
					; sub_417994+F5r ...
dword_428A58	dd ?			; DATA XREF: sub_415654+41r
					; sub_415654+49w ...
; void *dword_428A5C
dword_428A5C	dd ?			; DATA XREF: sub_419496+232r
					; sub_419496+23Br ...
dword_428A60	dd ?			; DATA XREF: sub_419756+7r
					; sub_419E0A+6w
		align 20h
; FILE *dword_428A80
dword_428A80	dd ?			; DATA XREF: sub_419E4D+8r
					; sub_419E4D+19r ...
		align 20h
; char Dest[79]
Dest		db 4Fh dup(?)		; DATA XREF: sub_41A0FC+1Bo
					; .text:loc_41A1CCo ...
byte_428AEF	db ?			; DATA XREF: sub_41A0FC+27w
dword_428AF0	dd ?			; DATA XREF: sub_41A0FC+3Fw
					; .text:loc_41A184r ...
dword_428AF4	dd ?			; DATA XREF: sub_41A0FC+34w
					; .text:0041A16Cr ...
dword_428AF8	dd ?			; DATA XREF: sub_41A0FC+4Aw
					; .text:loc_41A19Cr ...
dword_428AFC	dd ?			; DATA XREF: .text:0041A0F5w
					; sub_41A26E:loc_41A3C0r ...
dword_428B00	dd ?			; DATA XREF: sub_41A0FC+57w
					; .text:loc_41A1B4r
dword_428B04	dd ?			; DATA XREF: sub_419E4D+249w
					; sub_41A26E+88r ...
dword_428B08	dd ?			; DATA XREF: sub_419E4D+24Ew
					; sub_41A26E:loc_41A2B1r ...
dword_428B0C	dd ?			; DATA XREF: sub_419E18+6r
					; sub_419E18+14w ...
		align 20h
; CHAR Buffer[256]
Buffer		db 100h	dup(?)		; DATA XREF: sub_41B9A2+29o
					; sub_41B9A2+56o
dword_428C20	dd ?			; DATA XREF: sub_41E43D+6r
					; sub_41E43D+Fr ...
dword_428C24	dd ?			; DATA XREF: sub_41E950+E3w
					; sub_41EA4F+1DFw ...
dword_428C28	dd ?			; DATA XREF: sub_41E950+EDw
					; sub_41EA4F+1E9w ...
dword_428C2C	dd ?			; DATA XREF: sub_41EFB1+70Er
					; sub_41EFB1:loc_41F705w
dword_428C30	dd ?			; DATA XREF: sub_41ED65+1CCr
					; sub_41ED65:loc_41EF77w
; char byte_428C34[32]
byte_428C34	db 20h dup(?)		; DATA XREF: sub_41EA4F+3Bo
					; sub_41EA4F+47o ...
dword_428C54	dd ?			; DATA XREF: sub_41E950+45r
					; sub_41E950+4Dw
dword_428C58	dd ?			; DATA XREF: sub_41E950:loc_41E9A9r
					; sub_41E950+61w
dword_428C5C	dd ?			; DATA XREF: sub_41E950:loc_41E9E5r
					; sub_41E950:loc_41EA19w
dword_428C60	dd ?			; DATA XREF: sub_401010+3r
dword_428C64	dd ?			; DATA XREF: sub_401010+25r
dword_428C68	dd ?			; DATA XREF: sub_401060+22w
dword_428C6C	dd ?			; DATA XREF: sub_401060+18w
dword_428C70	dd ?			; DATA XREF: sub_401060+Ew
TlsIndex	dd ?			; DATA XREF: .tls:TlsIndex_ptro
; HMODULE hLibModule
hLibModule	dd ?			; DATA XREF: TlsCallback_0+60w
					; TlsCallback_0+83r ...
dword_428C7C	dd ?			; DATA XREF: sub_401060+2Cw
dword_428C80	dd ?			; DATA XREF: sub_401060+3Dr
					; sub_401180+61r ...
dword_428C84	dd ?			; DATA XREF: sub_401060+5Er
dword_428C88	dd ?			; DATA XREF: sub_401180+12Dw
					; TopLevelExceptionFilter:loc_41FBFCr
dword_428C8C	dd ?			; DATA XREF: .text:0041FD23r
					; sub_41FD70+4w
dword_428C90	dd ?			; DATA XREF: sub_420090+9r
					; sub_420090:loc_4200B0w
dword_428C94	dd ?			; DATA XREF: sub_41FE50+1Dr
					; sub_41FE50+58r ...
dword_428C98	dd ?			; DATA XREF: sub_41FE50+Br
					; sub_41FE50:loc_41FF0Fw ...
dword_428C9C	dd ?			; DATA XREF: sub_420640+4r
					; sub_420640+92w ...
dword_428CA0	dd ?			; DATA XREF: sub_420790r
					; sub_420790:loc_4207A0w
		align 20h
dword_428CC0	dd 2Bh dup(?)		; DATA XREF: .rdata:00427898o
dword_428D6C	dd ?			; DATA XREF: .text:004208BAw
		dd 2 dup(?)
dword_428D78	dd ?			; DATA XREF: .text:004208A6w
		dd 2 dup(?)
dword_428D84	dd ?			; DATA XREF: .text:0042088Cw
		dd 86h dup(?)
dword_428FA0	dd ?			; DATA XREF: .text:00420892w
					; .rdata:off_427894o
dword_428FA4	dd ?			; DATA XREF: .text:0042089Cw
		dd ?
dword_428FAC	dd ?			; DATA XREF: .text:004208ABw
		align 80h
dword_429000	dd ?			; DATA XREF: .text:00420983r
					; .text:00420A14r ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_420910+7o
					; sub_420910:loc_420965o ...
dword_42901C	dd ?			; DATA XREF: sub_420910+14r
					; .text:004209D8r ...
		dd ?
dword_429024	dd ?			; DATA XREF: sub_401180+1A8w
dword_429028	dd ?			; DATA XREF: sub_401180+1BFw
dword_42902C	dd ?			; DATA XREF: sub_401180+1B2w
		align 20h
dword_429040	dd ?			; DATA XREF: sub_403058+11Br
					; sub_4031FB+2AEr ...
dword_429044	dd ?			; DATA XREF: sub_40377D:loc_4038B1w
dword_429048	dd ?			; DATA XREF: sub_4015CF:loc_401641r
					; sub_402175+18Ar ...
dword_42904C	dd ?			; DATA XREF: sub_40377D:loc_4038EFw
					; sub_40377D+16E1w ...
dword_429050	dd ?			; DATA XREF: sub_40377D:loc_4038FBw
					; sub_40377D+1735w ...
; char dword_429054[]
dword_429054	dd ?			; DATA XREF: sub_40377D+191w
					; sub_40377D+2DCr ...
dword_429058	dd ?			; DATA XREF: sub_40377D:loc_403915w
					; sub_40377D+28Ar ...
dword_42905C	dd ?			; DATA XREF: sub_40377D+85w
					; sub_40377D:loc_403921r ...
dword_429060	dd ?			; DATA XREF: sub_402175+3Dr
					; sub_402C1C+94r ...
dword_429064	dd ?			; DATA XREF: sub_40377D+1CDw
					; sub_40377D:loc_404306r ...
dword_429068	dd ?			; DATA XREF: sub_41411A:loc_414149r
					; sub_41411A+79r ...
dword_42906C	dd ?			; DATA XREF: TlsCallback_0+A3w
					; TlsCallback_0:loc_41F9E3w ...
dword_429070	dd ?			; DATA XREF: TlsCallback_0+7Ew
					; TlsCallback_0+AEr ...
dword_429074	dd ?			; DATA XREF: TlsCallback_0:loc_41F934w
dword_429078	dd ?			; DATA XREF: sub_401060+64w
					; sub_41FAB0+3Fr ...
dword_42907C	dd ?			; DATA XREF: sub_401060+69w
					; sub_41FAB0+4r ...
dword_429080	dd ?			; DATA XREF: sub_401180+A0o
					; sub_401180+ECw
dword_429084	dd ?			; DATA XREF: sub_401180+B3r
					; sub_401180:loc_401243r ...
		align 1000h
_bss		ends

;
; Imports from libassuan-0.dll
;
; Section 5. (virtual address 0002A000)
; Virtual size			: 000014C4 (   5316.)
; Section size in file		: 00001600 (   5632.)
; Offset to raw	data for section: 00025C00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
		extrn __imp_assuan_new:dword ; DATA XREF: assuan_newr
		extrn __imp_assuan_pending_line:dword ;	DATA XREF: assuan_pending_liner
		extrn __imp_assuan_pipe_connect:dword ;	DATA XREF: assuan_pipe_connectr
		extrn __imp_assuan_read_line:dword ; DATA XREF:	assuan_read_liner
		extrn __imp_assuan_release:dword ; DATA	XREF: assuan_releaser
		extrn __imp_assuan_send_data:dword ; DATA XREF:	assuan_send_datar
		extrn __imp_assuan_sendfd:dword	; DATA XREF: assuan_sendfdr
		extrn __imp_assuan_set_gpg_err_source:dword
					; DATA XREF: assuan_set_gpg_err_sourcer
		extrn __imp_assuan_socket_connect:dword	; DATA XREF: assuan_socket_connectr
		extrn __imp_assuan_transact:dword ; DATA XREF: assuan_transactr
		extrn __imp_assuan_write_line:dword ; DATA XREF: assuan_write_liner

;
; Imports from libgpg-error-0.dll
;
		extrn __imp_gpg_err_code_from_errno:dword
					; DATA XREF: gpg_err_code_from_errnor
		extrn __imp_gpg_err_code_from_syserror:dword
					; DATA XREF: gpg_err_code_from_syserrorr
		extrn __imp_gpg_strerror:dword ; DATA XREF: gpg_strerrorr
		extrn __imp_gpg_strsource:dword	; DATA XREF: gpg_strsourcer

;
; Imports from libiconv-2.dll
;
		extrn __imp_libiconv:dword ; DATA XREF:	libiconvr
		extrn __imp_libiconv_close:dword ; DATA	XREF: libiconv_closer
		extrn __imp_libiconv_open:dword	; DATA XREF: libiconv_openr

;
; Imports from ADVAPI32.dll
;
; BOOL __stdcall CopySid(DWORD nDestinationSidLength, PSID pDestinationSid, PSID pSourceSid)
		extrn CopySid:dword	; CODE XREF: .text:0040BF0Ep
					; DATA XREF: .text:0040BF09r
; DWORD	__stdcall GetLengthSid(PSID pSid)
		extrn GetLengthSid:dword ; CODE	XREF: .text:0040BED7p
					; DATA XREF: .text:0040BED2r
; BOOL __stdcall GetTokenInformation(HANDLE TokenHandle, TOKEN_INFORMATION_CLASS TokenInformationClass,	LPVOID TokenInformation, DWORD TokenInformationLength, PDWORD ReturnLength)
		extrn GetTokenInformation:dword	; CODE XREF: .text:0040BE52p
					; .text:0040BEABp
					; DATA XREF: ...
; BOOL __stdcall IsValidSid(PSID pSid)
		extrn IsValidSid:dword	; CODE XREF: .text:0040BEC1p
					; DATA XREF: .text:0040BEBCr
; BOOL __stdcall OpenProcessToken(HANDLE ProcessHandle,	DWORD DesiredAccess, PHANDLE TokenHandle)
		extrn OpenProcessToken:dword ; CODE XREF: .text:0040BE1Bp
					; DATA XREF: .text:0040BE16r
; LSTATUS __stdcall RegCloseKey(HKEY hKey)
		extrn RegCloseKey:dword	; CODE XREF: sub_41E62E+314p
					; DATA XREF: sub_41E62E+30Fr
; LSTATUS __stdcall RegOpenKeyExA(HKEY hKey, LPCSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY	phkResult)
		extrn RegOpenKeyExA:dword ; CODE XREF: sub_41E62E+55p
					; sub_41E62E+98p
					; DATA XREF: ...
; LSTATUS __stdcall RegQueryValueExA(HKEY hKey,	LPCSTR lpValueName, LPDWORD lpReserved,	LPDWORD	lpType,	LPBYTE lpData, LPDWORD lpcbData)
		extrn RegQueryValueExA:dword ; CODE XREF: sub_41E62E+E3p
					; sub_41E62E+140p
					; DATA XREF: ...

;
; Imports from KERNEL32.dll
;
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: sub_4031FB+287p
					; sub_4031FB+29Cp ...
; BOOL __stdcall CreateDirectoryA(LPCSTR lpPathName, LPSECURITY_ATTRIBUTES lpSecurityAttributes)
		extrn CreateDirectoryA:dword ; CODE XREF: sub_409AE3+11Dp
					; .text:0040BBA0p ...
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
		extrn CreateFileA:dword	; CODE XREF: sub_40ADBE+73p
					; sub_40ADBE+FEp ...
; HANDLE __stdcall CreateMutexA(LPSECURITY_ATTRIBUTES lpMutexAttributes, BOOL bInitialOwner, LPCSTR lpName)
		extrn CreateMutexA:dword ; CODE	XREF: sub_40DCEC+22p
					; DATA XREF: sub_40DCEC+1Dr
; BOOL __stdcall CreatePipe(PHANDLE hReadPipe, PHANDLE hWritePipe, LPSECURITY_ATTRIBUTES lpPipeAttributes, DWORD nSize)
		extrn CreatePipe:dword	; CODE XREF: sub_40C3DD+4Ep
					; DATA XREF: sub_40C3DD+49r
; BOOL __stdcall CreateProcessA(LPCSTR lpApplicationName, LPSTR	lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES	lpThreadAttributes, BOOL bInheritHandles, DWORD	dwCreationFlags, LPVOID	lpEnvironment, LPCSTR lpCurrentDirectory, LPSTARTUPINFOA lpStartupInfo,	LPPROCESS_INFORMATION lpProcessInformation)
		extrn CreateProcessA:dword ; CODE XREF:	.text:0040C880p
					; sub_40C9F4+1B3p ...
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_420AB0+44p
					; DATA XREF: sub_420AB0+44r
; BOOL __stdcall DuplicateHandle(HANDLE	hSourceProcessHandle, HANDLE hSourceHandle, HANDLE hTargetProcessHandle, LPHANDLE lpTargetHandle, DWORD	dwDesiredAccess, BOOL bInheritHandle, DWORD dwOptions)
		extrn DuplicateHandle:dword ; CODE XREF: sub_4031FB+25Cp
					; sub_40C3DD+A3p
					; DATA XREF: ...
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_420910+Ep
					; .text:004209D2p ...
; DWORD	__stdcall ExpandEnvironmentStringsA(LPCSTR lpSrc, LPSTR	lpDst, DWORD nSize)
		extrn ExpandEnvironmentStringsA:dword ;	CODE XREF: sub_41E62E+1CFp
					; sub_41E62E+235p
					; DATA XREF: ...
; DWORD	__stdcall FormatMessageA(DWORD dwFlags,	LPCVOID	lpSource, DWORD	dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments)
		extrn FormatMessageA:dword ; CODE XREF:	sub_41B9A2+51p
					; DATA XREF: sub_41B9A2+4Cr
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: TlsCallback_0+10Ap
					; DATA XREF: TlsCallback_0+10Ar
; UINT __stdcall GetACP()
		extrn GetACP:dword	; CODE XREF: sub_41EA4F+26p
					; DATA XREF: sub_41EA4F+21r
; UINT __stdcall GetConsoleOutputCP()
		extrn GetConsoleOutputCP:dword ; CODE XREF: sub_41EA4F+16p
					; DATA XREF: sub_41EA4F+11r
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: sub_4031FB+225p
					; sub_40C3DD+66p ...
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: .text:0040BA9Ap
					; .text:0040BDD5p ...
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_4207B0+74p
					; DATA XREF: sub_4207B0+74r
; BOOL __stdcall GetExitCodeProcess(HANDLE hProcess, LPDWORD lpExitCode)
		extrn GetExitCodeProcess:dword ; CODE XREF: sub_40CC63+AAp
					; DATA XREF: sub_40CC63+A5r
; DWORD	__stdcall GetFileSize(HANDLE hFile, LPDWORD lpFileSizeHigh)
		extrn GetFileSize:dword	; CODE XREF: sub_417994+17Ap
					; DATA XREF: sub_417994+175r
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_40ADBE+8Cp
					; sub_40ADBE+117p ...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename,	DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_409DB0+31p
					; sub_420E60+C2p
					; DATA XREF: ...
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_4014F0+16p
					; sub_420640+87p
					; DATA XREF: ...
; DWORD	__stdcall GetPriorityClass(HANDLE hProcess)
		extrn GetPriorityClass:dword ; CODE XREF: .text:0040C826p
					; sub_40C9F4+15Cp ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_401180+142p
					; sub_4014F0+33p ...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: sub_401180+2F6p
					; DATA XREF: sub_401180+2F6r
; HANDLE __stdcall GetStdHandle(DWORD nStdHandle)
		extrn GetStdHandle:dword ; CODE	XREF: sub_414578+226p
					; sub_414578+23Cp ...
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_4207B0+57p
					; DATA XREF: sub_4207B0+57r
; DWORD	__stdcall GetTempPathA(DWORD nBufferLength, LPSTR lpBuffer)
		extrn GetTempPathA:dword ; CODE	XREF: .text:0040BAE3p
					; sub_4127C3+2Ap
					; DATA XREF: ...
; LCID __stdcall GetThreadLocale()
		extrn GetThreadLocale:dword ; CODE XREF: sub_4182CC+7Fp
					; DATA XREF: sub_4182CC:loc_418346r
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: .text:0040BBCCp
					; sub_4127C3+119p ...
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_420AB0+87p
					; DATA XREF: sub_420AB0+87r
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_420910+5Cp
					; .text:004209F0p ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: sub_40997C+11p
					; sub_41401A+11p ...
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: sub_420640+A7p
					; DATA XREF: sub_420640+A7r
; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
		extrn MultiByteToWideChar:dword	; CODE XREF: sub_41922D+38p
					; sub_41922D+D5p
					; DATA XREF: ...
; HANDLE __stdcall OpenProcess(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwProcessId)
		extrn OpenProcess:dword	; CODE XREF: sub_4031FB+1F6p
					; .text:0040BDEFp
					; DATA XREF: ...
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_4207B0+8Bp
					; DATA XREF: sub_4207B0+8Br
; BOOL __stdcall ReadConsoleA(HANDLE hConsoleInput, LPVOID lpBuffer, DWORD nNumberOfCharsToRead, LPDWORD lpNumberOfCharsRead, PCONSOLE_READCONSOLE_CONTROL pInputControl)
		extrn ReadConsoleA:dword ; CODE	XREF: sub_40B337+DBp
					; DATA XREF: sub_40B337+D6r
; BOOL __stdcall ReadFile(HANDLE hFile,	LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped)
		extrn ReadFile:dword	; CODE XREF: sub_414578+A4p
					; DATA XREF: sub_414578+9Fr
; BOOL __stdcall ReleaseMutex(HANDLE hMutex)
		extrn ReleaseMutex:dword ; CODE	XREF: sub_40DDBD+1Cp
					; DATA XREF: sub_40DDBD+17r
; DWORD	__stdcall ResumeThread(HANDLE hThread)
		extrn ResumeThread:dword ; CODE	XREF: .text:0040C92Dp
					; sub_40C9F4+244p
					; DATA XREF: ...
; BOOL __stdcall SetConsoleMode(HANDLE hConsoleHandle, DWORD dwMode)
		extrn SetConsoleMode:dword ; CODE XREF:	sub_40ADBE+13Ep
					; sub_40ADBE+158p ...
; DWORD	__stdcall SetFilePointer(HANDLE	hFile, LONG lDistanceToMove, PLONG lpDistanceToMoveHigh, DWORD dwMoveMethod)
		extrn SetFilePointer:dword ; CODE XREF:	sub_41444F+B3p
					; .text:00417CDFp
					; DATA XREF: ...
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_401180+124p
					; .text:004208CFp
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_401180+8Fp
					; sub_40B9F9+17p ...
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: .text:004208F9p
					; DATA XREF: .text:004208F9r
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_420910+35p
					; DATA XREF: sub_420910+21r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:004208DFp
					; DATA XREF: .text:004208DFr
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_41FE50+142p
					; sub_41FE50+184p ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_41FE50+A1p
					; sub_41FE50+D9p ...
; DWORD	__stdcall WaitForSingleObject(HANDLE hHandle, DWORD dwMilliseconds)
		extrn WaitForSingleObject:dword	; CODE XREF: sub_40CC63+46p
					; sub_40DCEC+74p
					; DATA XREF: ...
; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
		extrn WideCharToMultiByte:dword	; CODE XREF: sub_41932F+48p
					; sub_41932F+C8p
					; DATA XREF: ...
; BOOL __stdcall WriteConsoleA(HANDLE hConsoleOutput, const void *lpBuffer, DWORD nNumberOfCharsToWrite, LPDWORD lpNumberOfCharsWritten, LPVOID	lpReserved)
		extrn WriteConsoleA:dword ; CODE XREF: sub_40AF6D+8Ap
					; .text:0040B111p
					; DATA XREF: ...
; BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite,	LPDWORD	lpNumberOfBytesWritten,	LPOVERLAPPED lpOverlapped)
		extrn WriteFile:dword	; CODE XREF: sub_414578+165p
					; DATA XREF: sub_414578+160r

;
; Imports from msvcrt.dll
;
		extrn __imp__access:dword ; DATA XREF: _accessr
		extrn __imp__close:dword ; DATA	XREF: _closer
		extrn __imp__dup:dword	; DATA XREF: _dupr
; FILE *__cdecl	_fdopen(int FileHandle,	const char *Format)
		extrn __imp__fdopen:dword ; DATA XREF: _fdopenr
; int __cdecl _fileno(FILE *File)
		extrn __imp__fileno:dword ; DATA XREF: _filenor
		extrn __imp__getcwd:dword ; DATA XREF: _getcwdr
		extrn __imp__getpid:dword ; DATA XREF: _getpidr
		extrn __imp__isatty:dword ; DATA XREF: _isattyr
		extrn __imp__open:dword	; DATA XREF: _openr
		extrn __imp__read:dword	; DATA XREF: _readr
		extrn __imp__setmode:dword ; DATA XREF:	_setmoder
		extrn __imp__write:dword ; DATA	XREF: _writer

;
; Imports from msvcrt.dll
;
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
; unsigned __int32 *__cdecl __doserrno()
		extrn __imp___doserrno:dword ; DATA XREF: __doserrnor
		extrn __imp___getmainargs:dword	; DATA XREF: __getmainargsr
		extrn __initenv:dword	; DATA XREF: sub_401180+23Er
		extrn __lconv_init:dword ; DATA	XREF: sub_41FA80r
		extrn __pioinfo:dword	; DATA XREF: sub_4212D0+F1r
					; sub_4212D0+13Ar ...
		extrn __imp___set_app_type:dword ; DATA	XREF: __set_app_typer
		extrn __imp___setusermatherr:dword ; DATA XREF:	__setusermatherrr
		extrn _acmdln:dword	; DATA XREF: sub_401180+166r
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
		extrn __imp__cexit:dword ; DATA	XREF: _cexitr
; int *__cdecl _errno()
		extrn __imp__errno:dword ; CODE	XREF: sub_401661+4Ap
					; sub_402175+152p ...
; void __cdecl __noreturn _exit(int Code)
		extrn __imp__exit:dword	; DATA XREF: _exitr
		extrn __imp__filelengthi64:dword ; DATA	XREF: _filelengthi64r
; int __cdecl _fileno_0(FILE *File)
		extrn __imp__fileno_0:dword ; DATA XREF: _fileno_0r
; int fmode
		extrn _fmode:dword	; DATA XREF: sub_401060+6Er
		extrn _fstati64:dword	; CODE XREF: .text:0040C123p
					; sub_417994+46p ...
		extrn _get_osfhandle:dword ; CODE XREF:	sub_4015AD+1Ep
					; sub_4031FB+1D4p ...
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
; FILE *iob
		extrn _iob:dword	; DATA XREF: sub_40377D:loc_4039BFr
					; sub_40377D+25Br ...
		extrn __imp__lock:dword	; DATA XREF: _lockr
		extrn __imp__lseeki64:dword ; DATA XREF: _lseeki64r
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_41FAB0+A3p
					; DATA XREF: sub_41FAB0+A3r
		extrn _open_osfhandle:dword ; CODE XREF: sub_40BA17+2Cp
					; .text:0040BC90p ...
; int __cdecl pclose(FILE *File)
		extrn _pclose:dword	; CODE XREF: sub_405A92+3CAp
					; DATA XREF: sub_405A92+3C5r
; FILE *__cdecl	popen(const char *Command, const char *Mode)
		extrn _popen:dword	; CODE XREF: sub_405A92+1D7p
					; DATA XREF: sub_405A92+1D2r
; int __cdecl strnicmp(const char *Str1, const char *Str, size_t MaxCount)
		extrn _strnicmp:dword	; CODE XREF: sub_413F38+3Bp
					; DATA XREF: sub_413F38+36r
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
		extrn _winmajor:dword	; DATA XREF: TlsCallback_0+4r
		extrn __imp__write_0:dword ; DATA XREF:	_write_0r
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; int __cdecl atoi(const char *Str)
		extrn __imp_atoi:dword	; DATA XREF: atoir
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; void __cdecl clearerr(FILE *File)
		extrn __imp_clearerr:dword ; DATA XREF:	clearerrr
; void __cdecl __noreturn exit(int Code)
		extrn __imp_exit:dword	; DATA XREF: exitr
; int __cdecl fclose(FILE *File)
		extrn __imp_fclose:dword ; DATA	XREF: fcloser
; int __cdecl ferror(FILE *File)
		extrn __imp_ferror:dword ; DATA	XREF: ferrorr
; int __cdecl fflush(FILE *File)
		extrn __imp_fflush:dword ; DATA	XREF: fflushr
; int __cdecl fgetpos(FILE *File, fpos_t *Pos)
		extrn __imp_fgetpos:dword ; DATA XREF: fgetposr
; FILE *__cdecl	fopen(const char *Filename, const char *Mode)
		extrn __imp_fopen:dword	; DATA XREF: fopenr
; int fprintf(FILE *File, const	char *Format, ...)
		extrn __imp_fprintf:dword ; DATA XREF: fprintfr
; int __cdecl fputs(const char *Str, FILE *File)
		extrn __imp_fputs:dword	; DATA XREF: fputsr
; size_t __cdecl fread(void *DstBuf, size_t ElementSize, size_t	Count, FILE *File)
		extrn __imp_fread:dword	; DATA XREF: freadr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; int __cdecl fseek(FILE *File,	__int32	Offset,	int Origin)
		extrn __imp_fseek:dword	; DATA XREF: fseekr
; int __cdecl fsetpos(FILE *File, const	fpos_t *Pos)
		extrn __imp_fsetpos:dword ; DATA XREF: fsetposr
; __int32 __cdecl ftell(FILE *File)
		extrn __imp_ftell:dword	; DATA XREF: ftellr
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; int __cdecl getc(FILE	*File)
		extrn __imp_getc:dword	; DATA XREF: getcr
; char *__cdecl	getenv(const char *VarName)
		extrn __imp_getenv:dword ; DATA	XREF: getenvr
; int __cdecl iscntrl(int C)
		extrn iscntrl:dword	; CODE XREF: sub_405EA8+331p
					; sub_40B175+3Bp ...
; int __cdecl isprint(int C)
		extrn isprint:dword	; CODE XREF: sub_405EA8+320p
					; DATA XREF: sub_405EA8+31Br
; int __cdecl isspace(int C)
		extrn isspace:dword	; CODE XREF: sub_41AA98+33p
					; sub_41AA98+53p ...
; struct tm *__cdecl static localtime(const time_t *Time)
		extrn localtime:dword	; DATA XREF: sub_421780r
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; void *__cdecl	memchr(const void *Buf,	int Val, size_t	MaxCount)
		extrn __imp_memchr:dword ; DATA	XREF: memchrr
; int __cdecl memcmp(const void	*Buf1, const void *Buf2, size_t	Size)
		extrn __imp_memcmp:dword ; DATA	XREF: memcmpr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; void *__cdecl	memmove(void *Dst, const void *Src, size_t Size)
		extrn __imp_memmove:dword ; DATA XREF: memmover
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn __imp_memset:dword ; DATA	XREF: memsetr
; int printf(const char	*Format, ...)
		extrn __imp_printf:dword ; DATA	XREF: printfr
; int __cdecl putc(int Ch, FILE	*File)
		extrn __imp_putc:dword	; DATA XREF: putcr
; int __cdecl putchar(int Ch)
		extrn __imp_putchar:dword ; DATA XREF: putcharr
; int __cdecl puts(const char *Str)
		extrn __imp_puts:dword	; DATA XREF: putsr
		extrn __imp_raise:dword	; DATA XREF: raiser
; void *__cdecl	realloc(void *Memory, size_t NewSize)
		extrn __imp_realloc:dword ; DATA XREF: reallocr
; int __cdecl remove(const char	*Filename)
		extrn __imp_remove:dword ; DATA	XREF: remover
; void __cdecl rewind(FILE *File)
		extrn __imp_rewind:dword ; DATA	XREF: rewindr
		extrn __imp_setlocale:dword ; DATA XREF: setlocaler
; int __cdecl setvbuf(FILE *File, char *Buf, int Mode, size_t Size)
		extrn __imp_setvbuf:dword ; DATA XREF: setvbufr
		extrn __imp_signal:dword ; DATA	XREF: signalr
; int sprintf(char *Dest, const	char *Format, ...)
		extrn __imp_sprintf:dword ; DATA XREF: sprintfr
; char *__cdecl	strchr(const char *Str,	int Val)
		extrn __imp_strchr:dword ; DATA	XREF: strchrr
; int __cdecl strcmp(const char	*Str1, const char *Str2)
		extrn __imp_strcmp:dword ; DATA	XREF: strcmpr
; char *__cdecl	strcpy(char *Dest, const char *Source)
		extrn __imp_strcpy:dword ; DATA	XREF: strcpyr
; size_t __cdecl strcspn(const char *Str, const	char *Control)
		extrn __imp_strcspn:dword ; DATA XREF: strcspnr
; char *__cdecl	strerror(int)
		extrn __imp_strerror:dword ; DATA XREF:	strerrorr
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; char *__cdecl	strncpy(char *Dest, const char *Source,	size_t Count)
		extrn __imp_strncpy:dword ; DATA XREF: strncpyr
; char *__cdecl	strpbrk(const char *Str, const char *Control)
		extrn __imp_strpbrk:dword ; DATA XREF: strpbrkr
; char *__cdecl	strrchr(const char *Str, int Ch)
		extrn __imp_strrchr:dword ; DATA XREF: strrchrr
; char *__cdecl	strstr(const char *Str,	const char *SubStr)
		extrn __imp_strstr:dword ; DATA	XREF: strstrr
; __int32 __cdecl strtol(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtol:dword ; DATA	XREF: strtolr
; unsigned __int32 __cdecl strtoul(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtoul:dword ; DATA XREF: strtoulr
; time_t __cdecl static	time(time_t *Time)
		extrn time:dword	; DATA XREF: sub_421770r
; int __cdecl toupper(int C)
		extrn toupper:dword	; CODE XREF: .text:0041A8A5p
					; .text:0041A8BAp ...
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr

;
; Imports from USER32.dll
;
; BOOL __stdcall AllowSetForegroundWindow(DWORD	dwProcessId)
		extrn AllowSetForegroundWindow:dword ; CODE XREF: sub_40BD38+41p
					; DATA XREF: sub_40BD38+3Cr
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn MessageBoxA:dword	; CODE XREF: sub_420E60+122p
					; DATA XREF: sub_420E60+122r

;
; Imports from WS2_32.dll
;
; int __stdcall	WSAGetLastError()
		extrn WSAGetLastError:dword ; CODE XREF: sub_414824+A3p
					; sub_414824+14Dp
					; DATA XREF: ...
; int __stdcall	WSAStartup(WORD	wVersionRequested, LPWSADATA lpWSAData)
		extrn WSAStartup:dword	; CODE XREF: sub_40AD6C+2Bp
					; DATA XREF: sub_40AD6C+26r
; int __stdcall	closesocket(SOCKET s)
		extrn closesocket:dword	; CODE XREF: sub_414824+1F4p
					; DATA XREF: sub_414824+1EFr
; int __stdcall	recv(SOCKET s, char *buf, int len, int flags)
		extrn recv:dword	; CODE XREF: sub_414824+90p
					; DATA XREF: sub_414824+8Br
; int __stdcall	send(SOCKET s, const char *buf,	int len, int flags)
		extrn send:dword	; CODE XREF: sub_414824+13Ap
					; DATA XREF: sub_414824+135r


; Section 6. (virtual address 0002C000)
; Virtual size			: 00000034 (	 52.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00027200
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 42C000h
dword_42C000	dd 0			; DATA XREF: sub_401180+2D8o
		dd offset sub_401010
dword_42C008	dd 0			; DATA XREF: sub_401180:loc_401450o
dword_42C00C	dd 0			; DATA XREF: sub_401180+316o
		dd offset sub_401060
		dd offset sub_41FA80
dword_42C018	dd 2 dup(0)		; DATA XREF: sub_401180+30Eo
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
		dd offset TlsCallback_1
		dd 0
		align 10h
dword_42C030	dd 74h dup(0)		; DATA XREF: TlsCallback_0:loc_41FA23o
					; TlsCallback_0+138o ...
		align 1000h
_CRT		ends

; Section 7. (virtual address 0002D000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00027400
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 42D000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end start
