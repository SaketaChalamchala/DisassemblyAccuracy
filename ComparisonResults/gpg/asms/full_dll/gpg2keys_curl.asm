;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	2745736BE6510DEDE2C0D395B6E8BDAF
; Input	CRC32 :	2A1627D6

; File Name   :	C:\compspace\compare\gpg\dlls\full\gpg2keys_curl.exe
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00009B54 (  39764.)
; Section size in file		: 00009C00 (  39936.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
; [00000002 BYTES: COLLAPSED FUNCTION nullsub_1]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401010	proc near		; DATA XREF: .CRT:00410004o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch

		sub	esp, 2Ch
		mov	eax, ds:dword_40E3E4
		mov	[esp+2Ch+var_1C], offset dword_40E018
		mov	[esp+2Ch+var_24], offset dword_40E00C
		mov	[esp+2Ch+var_28], offset dword_40E008
		mov	ds:dword_40E018, eax
		mov	eax, ds:dword_40E3E8
		mov	[esp+2Ch+var_2C], offset dword_40E004
		mov	[esp+2Ch+var_20], eax
		call	__getmainargs
		mov	ds:dword_40E01C, eax
		add	esp, 2Ch
		retn
sub_401010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401060	proc near		; DATA XREF: .CRT:00410010o

var_1C		= dword	ptr -1Ch

		sub	esp, 1Ch
		xor	eax, eax
		cmp	word ptr ds:400000h, 5A4Dh
		mov	ds:dword_40E3F4, 1
		mov	ds:dword_40E3F0, 1
		mov	ds:dword_40E3EC, 1
		mov	ds:dword_40E400, 1
		jz	short loc_401100

loc_401098:				; CODE XREF: sub_401060+B6j
					; sub_401060+C8j ...
		mov	ds:dword_40E014, eax
		mov	eax, ds:dword_40E404
		test	eax, eax
		jz	short loc_4010F0
		mov	[esp+1Ch+var_1C], 2
		call	__set_app_type

loc_4010B2:				; CODE XREF: sub_401060+9Cj
		mov	[esp+1Ch+var_1C], 0FFFFFFFFh
		call	sub_408A90
		mov	edx, ds:dword_40E408
		mov	ds:dword_40E7BC, eax
		mov	ds:dword_40E7C0, eax
		mov	eax, ds:_fmode
		mov	[eax], edx
		call	sub_408DD0
		cmp	dword_40B01C, 1
		jz	short loc_401150
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4010F0:				; CODE XREF: sub_401060+44j
		mov	[esp+1Ch+var_1C], 1
		call	__set_app_type
		jmp	short loc_4010B2
; ---------------------------------------------------------------------------
		align 10h

loc_401100:				; CODE XREF: sub_401060+36j
		mov	edx, ds:40003Ch
		cmp	dword ptr [edx+400000h], 4550h
		lea	ecx, [edx+400000h]
		jnz	short loc_401098
		movzx	edx, word ptr [ecx+18h]
		cmp	dx, 10Bh
		jz	short loc_401162
		cmp	dx, 20Bh
		jnz	loc_401098
		cmp	dword ptr [ecx+84h], 0Eh
		jbe	loc_401098
		mov	edx, [ecx+0F8h]
		xor	eax, eax
		test	edx, edx
		setnz	al
		jmp	loc_401098
; ---------------------------------------------------------------------------
		align 10h

loc_401150:				; CODE XREF: sub_401060+81j
		mov	[esp+1Ch+var_1C], offset sub_408D70
		call	sub_408D60
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_401162:				; CODE XREF: sub_401060+C1j
		cmp	dword ptr [ecx+74h], 0Eh
		jbe	loc_401098
		mov	ecx, [ecx+0E8h]
		xor	eax, eax
		test	ecx, ecx
		setnz	al
		jmp	loc_401098
sub_401060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401180	proc near		; CODE XREF: .text:004014C5j start+15j

dwMilliseconds	= dword	ptr -88h
lpProcName	= dword	ptr -84h
Size		= dword	ptr -80h
var_6D		= byte ptr -6Dh
var_6C		= dword	ptr -6Ch
var_5C		= byte ptr -5Ch
var_30		= byte ptr -30h
var_2C		= word ptr -2Ch

		push	ebp
		xor	eax, eax
		mov	ebp, esp
		mov	ecx, 11h
		push	edi
		push	esi
		lea	edx, [ebp+var_5C]
		push	ebx
		mov	edi, edx
		sub	esp, 7Ch
		rep stosd
		mov	al, 30h
		call	sub_409B40
		sub	esp, eax
		lea	eax, [esp+88h+var_6D]
		and	eax, 0FFFFFFF0h
		mov	dword ptr [eax], 0CCCCCCCCh
		mov	dword ptr [eax+4], 0CCCCCCCCh
		mov	dword ptr [eax+8], 0CCCCCCCCh
		mov	dword ptr [eax+0Ch], 0CCCCCCCCh
		mov	dword ptr [eax+10h], 0CCCCCCCCh
		mov	dword ptr [eax+14h], 0CCCCCCCCh
		mov	dword ptr [eax+18h], 0CCCCCCCCh
		mov	dword ptr [eax+1Ch], 0CCCCCCCCh
		and	esp, 0FFFFFFF0h
		mov	eax, ds:dword_40E404
		test	eax, eax
		jnz	loc_401473

loc_4011EE:				; CODE XREF: sub_401180+2FFj
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_401214
; ---------------------------------------------------------------------------
		align 10h

loc_401200:				; CODE XREF: sub_401180+B1j
		cmp	eax, ebx
		jz	loc_401420
		mov	[esp+88h+dwMilliseconds], 3E8h ; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_401214:				; CODE XREF: sub_401180+7Dj
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], ebx
		mov	[esp+88h+dwMilliseconds], offset dword_40E7C4
		call	sub_409BB0
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_401200
		mov	eax, ds:dword_40E7C8
		xor	ebx, ebx
		cmp	eax, 1
		jz	loc_401433

loc_401243:				; CODE XREF: sub_401180+2ADj
		mov	eax, ds:dword_40E7C8
		test	eax, eax
		jz	loc_401484
		mov	ds:dword_40E000, 1

loc_40125A:				; CODE XREF: sub_401180+322j
		mov	eax, ds:dword_40E7C8
		cmp	eax, 1
		jz	loc_401450

loc_401268:				; CODE XREF: sub_401180+2C7j
					; sub_401180+2EEj
		test	ebx, ebx
		jnz	short loc_401273
		lock xchg ebx, ds:dword_40E7C4

loc_401273:				; CODE XREF: sub_401180+EAj
		mov	eax, ds:off_40D48C
		test	eax, eax
		jz	short loc_401298
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], 2
		mov	[esp+88h+dwMilliseconds], 0
		call	eax ; TlsCallback_0
		sub	esp, 0Ch

loc_401298:				; CODE XREF: sub_401180+FAj
		call	sub_409080
		mov	[esp+88h+dwMilliseconds], offset TopLevelExceptionFilter ; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	ds:dword_40E40C, eax
		call	sub_409630
		mov	[esp+88h+lpProcName], offset ProcName ;	"_set_invalid_parameter_handler"
		mov	[esp+88h+dwMilliseconds], eax ;	hModule
		call	ds:GetProcAddress
		sub	esp, 8
		test	eax, eax
		jz	short loc_4012D8
		mov	[esp+88h+dwMilliseconds], offset nullsub_1
		call	eax

loc_4012D8:				; CODE XREF: sub_401180+14Dj
		call	sub_4096F0
		mov	eax, ds:dword_40E404
		test	eax, eax
		jz	short loc_401344
		mov	eax, ds:_acmdln
		xor	ecx, ecx
		mov	eax, [eax]
		jmp	short loc_4012FC
; ---------------------------------------------------------------------------

loc_4012F1:				; CODE XREF: sub_401180+182j
		test	dl, dl
		jz	short loc_401320
		test	cl, cl
		jz	short loc_401315

loc_4012F9:				; CODE XREF: sub_401180+18Fj
		add	eax, 1

loc_4012FC:				; CODE XREF: sub_401180+16Fj
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_4012F1
		mov	ebx, ecx
		xor	ebx, 1
		cmp	dl, 22h
		cmovz	ecx, ebx
		jmp	short loc_4012F9
; ---------------------------------------------------------------------------

loc_401311:				; CODE XREF: sub_401180+19Ej
		test	dl, dl
		jz	short loc_401320

loc_401315:				; CODE XREF: sub_401180+177j
		add	eax, 1
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_401311

loc_401320:				; CODE XREF: sub_401180+173j
					; sub_401180+193j
		movzx	edx, [ebp+var_2C]
		test	[ebp+var_30], 1
		mov	ds:dword_40E7A4, eax
		mov	eax, 0Ah
		mov	ds:dword_40E7AC, 400000h
		cmovnz	eax, edx
		mov	ds:dword_40E7A8, eax

loc_401344:				; CODE XREF: sub_401180+164j
		mov	edx, ds:dword_40E004
		xor	ebx, ebx
		lea	eax, ds:4[edx*4]
		mov	[ebp+var_6C], edx
		mov	[esp+88h+dwMilliseconds], eax ;	Size
		call	malloc
		mov	edi, ds:dword_40E008
		mov	[ebp-70h], eax
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jle	short loc_4013AA
		xchg	ax, ax

loc_401370:				; CODE XREF: sub_401180+225j
		mov	eax, [edi+ebx*4]
		mov	[esp+88h+dwMilliseconds], eax ;	Str
		call	strlen
		lea	esi, [eax+1]
		mov	[esp+88h+dwMilliseconds], esi ;	Size
		call	malloc
		mov	edx, [ebp-70h]
		mov	[edx+ebx*4], eax
		mov	edx, [edi+ebx*4]
		add	ebx, 1
		mov	[esp+88h+Size],	esi ; Size
		mov	[esp+88h+dwMilliseconds], eax ;	Dst
		mov	[esp+88h+lpProcName], edx ; Src
		call	memcpy
		cmp	ebx, [ebp+var_6C]
		jnz	short loc_401370
		shl	ebx, 2

loc_4013AA:				; CODE XREF: sub_401180+1ECj
		mov	eax, [ebp-70h]
		mov	dword ptr [eax+ebx], 0
		mov	ds:dword_40E008, eax
		call	sub_409780
		mov	eax, ds:__initenv
		mov	edx, ds:dword_40E00C
		mov	[eax], edx
		mov	eax, ds:dword_40E00C
		mov	[esp+88h+Size],	eax
		mov	eax, ds:dword_40E008
		mov	[esp+88h+lpProcName], eax
		mov	eax, ds:dword_40E004
		mov	[esp+88h+dwMilliseconds], eax
		call	sub_401920
		mov	esi, ds:dword_40E014
		test	esi, esi
		mov	ds:dword_40E010, eax
		jz	loc_4014A7
		mov	ebx, ds:dword_40E000
		test	ebx, ebx
		jnz	short loc_401411
		call	_cexit
		mov	eax, ds:dword_40E010

loc_401411:				; CODE XREF: sub_401180+285j
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_401420:				; CODE XREF: sub_401180+82j
		mov	eax, ds:dword_40E7C8
		mov	ebx, 1
		cmp	eax, 1
		jnz	loc_401243

loc_401433:				; CODE XREF: sub_401180+BDj
		mov	[esp+88h+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, ds:dword_40E7C8
		cmp	eax, 1
		jnz	loc_401268
		lea	esi, [esi+0]

loc_401450:				; CODE XREF: sub_401180+E2j
		mov	[esp+88h+lpProcName], offset dword_410008
		mov	[esp+88h+dwMilliseconds], offset dword_410000
		call	_initterm
		mov	ds:dword_40E7C8, 2
		jmp	loc_401268
; ---------------------------------------------------------------------------

loc_401473:				; CODE XREF: sub_401180+68j
		mov	[esp+88h+dwMilliseconds], edx ;	lpStartupInfo
		call	ds:GetStartupInfoA
		sub	esp, 4
		jmp	loc_4011EE
; ---------------------------------------------------------------------------

loc_401484:				; CODE XREF: sub_401180+CAj
		mov	ds:dword_40E7C8, 1
		mov	[esp+88h+lpProcName], offset dword_410018
		mov	[esp+88h+dwMilliseconds], offset dword_41000C
		call	_initterm
		jmp	loc_40125A
; ---------------------------------------------------------------------------

loc_4014A7:				; CODE XREF: sub_401180+277j
		mov	[esp+88h+dwMilliseconds], eax ;	Code
		call	exit
sub_401180	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		mov	ds:dword_40E404, 1
		call	sub_4097A0
		add	esp, 0Ch
		jmp	sub_401180
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public start
start		proc near
		sub	esp, 0Ch
		mov	ds:dword_40E404, 0
		call	sub_4097A0
		add	esp, 0Ch
		jmp	sub_401180
start		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4014F0	proc near		; CODE XREF: sub_40AB20+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_40B044
		test	eax, eax
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj-12.dll"
		call	ds:GetModuleHandleA
		mov	edx, 0
		sub	esp, 4
		test	eax, eax
		jz	short loc_40152E
		mov	[esp+18h+lpProcName], offset a_jv_registercl ; "_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	eax ; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		mov	edx, eax

loc_40152E:				; CODE XREF: sub_4014F0+26j
		test	edx, edx
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset dword_40B044
		call	edx

locret_40153B:				; CODE XREF: sub_4014F0+Dj
					; sub_4014F0+40j
		leave
		retn
sub_4014F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401540()
sub_401540	proc near		; DATA XREF: sub_40AB20+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401540	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4015C8	proc near		; CODE XREF: sub_401920+C3Fp

File		= dword	ptr -698h
Format		= dword	ptr -694h
var_690		= dword	ptr -690h
var_68C		= dword	ptr -68Ch
var_688		= dword	ptr -688h
var_684		= dword	ptr -684h
var_680		= dword	ptr -680h
var_674		= byte ptr -674h
var_65C		= dword	ptr -65Ch
Dest		= byte ptr -657h
var_12C		= byte ptr -12Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 68Ch
		lea	eax, [ebp+var_674]
		mov	edx, eax
		mov	ecx, 0
		mov	eax, 1Ch
		mov	ebx, eax
		and	ebx, 0FFFFFFFCh
		mov	eax, 0

loc_4015F0:				; CODE XREF: sub_4015C8+30j
		mov	[edx+eax], ecx
		add	eax, 4
		cmp	eax, ebx
		jb	short loc_4015F0
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset a0x	; "0x"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_401628
		add	[ebp+arg_0], 2

loc_401628:				; CODE XREF: sub_4015C8+5Aj
		mov	edx, offset Format ; "KEY 0x%s BEGIN\n"
		mov	eax, ds:File
		mov	ecx, [ebp+arg_0]
		mov	[esp+698h+var_690], ecx
		mov	[esp+698h+Format], edx ; Format
		mov	[esp+698h+File], eax ; File
		call	fprintf
		mov	eax, ds:dword_40E030
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_40165B
		mov	eax, ds:dword_40E030
		mov	ecx, [eax+14h]
		jmp	short loc_401660
; ---------------------------------------------------------------------------

loc_40165B:				; CODE XREF: sub_4015C8+87j
		mov	ecx, offset asc_40C057 ; "/"

loc_401660:				; CODE XREF: sub_4015C8+91j
		mov	eax, ds:dword_40E030
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_401676
		mov	eax, ds:dword_40E030
		mov	edx, [eax+8]
		jmp	short loc_40167B
; ---------------------------------------------------------------------------

loc_401676:				; CODE XREF: sub_4015C8+A2j
		mov	edx, offset Src

loc_40167B:				; CODE XREF: sub_4015C8+ACj
		mov	eax, ds:dword_40E030
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40168E
		mov	eax, offset asc_40C05A ; ":"
		jmp	short loc_401693
; ---------------------------------------------------------------------------

loc_40168E:				; CODE XREF: sub_4015C8+BDj
		mov	eax, offset Src

loc_401693:				; CODE XREF: sub_4015C8+C4j
		mov	ebx, ds:dword_40E030
		mov	edi, [ebx+4]
		mov	ebx, ds:dword_40E030
		mov	esi, [ebx+0Ch]
		mov	ebx, offset aSSSSS ; "%s://%s%s%s%s"
		mov	[esp+698h+var_680], ecx
		mov	[esp+698h+var_684], edx
		mov	[esp+698h+var_688], eax
		mov	[esp+698h+var_68C], edi
		mov	[esp+698h+var_690], esi
		mov	[esp+698h+Format], ebx ; Format
		lea	eax, [ebp+Dest]
		mov	[esp+698h+File], eax ; Dest
		call	sprintf
		mov	[ebp+var_1C], 2712h
		mov	edx, [ebp+var_1C]
		mov	eax, ds:dword_40E02C
		lea	ecx, [ebp+Dest]
		mov	[esp+698h+var_690], ecx
		mov	[esp+698h+Format], edx
		mov	[esp+698h+File], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		mov	[ebp+var_20], 4E2Bh
		mov	edx, [ebp+var_20]
		mov	eax, ds:dword_40E02C
		mov	[esp+698h+var_690], offset sub_403281
		mov	[esp+698h+Format], edx
		mov	[esp+698h+File], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		mov	eax, ds:File
		mov	[ebp+var_65C], eax
		mov	[ebp+var_24], 2711h
		mov	edx, [ebp+var_24]
		mov	eax, ds:dword_40E02C
		lea	ecx, [ebp+var_674]
		mov	[esp+698h+var_690], ecx
		mov	[esp+698h+Format], edx
		mov	[esp+698h+File], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		mov	[ebp+var_28], 271Ah
		mov	edx, [ebp+var_28]
		mov	eax, ds:dword_40E02C
		lea	ecx, [ebp+var_12C]
		mov	[esp+698h+var_690], ecx
		mov	[esp+698h+Format], edx
		mov	[esp+698h+File], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		mov	eax, ds:dword_40E02C
		mov	[esp+698h+File], eax
		mov	eax, ds:curl_easy_perform
		call	eax ; curl_easy_perform
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jz	short loc_4017F2
		mov	eax, ds:dword_40E030
		mov	ecx, [eax+0Ch]
		mov	edx, offset aGpgkeysSFetchE ; "gpgkeys:	%s fetch error %d: %s\n"
		mov	eax, ds:dword_40E028
		lea	ebx, [ebp+var_12C]
		mov	[esp+698h+var_688], ebx
		mov	ebx, [ebp+var_2C]
		mov	[esp+698h+var_68C], ebx
		mov	[esp+698h+var_690], ecx
		mov	[esp+698h+Format], edx ; Format
		mov	[esp+698h+File], eax ; File
		call	fprintf
		mov	eax, [ebp+var_2C]
		mov	[esp+698h+File], eax
		call	sub_4030AD
		mov	ecx, offset aKey0xSFailedD ; "\nKEY 0x%s FAILED	%d\n"
		mov	edx, ds:File
		mov	[esp+698h+var_68C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+698h+var_690], eax
		mov	[esp+698h+Format], ecx ; Format
		mov	[esp+698h+File], edx ; File
		call	fprintf
		jmp	loc_401872
; ---------------------------------------------------------------------------

loc_4017F2:				; CODE XREF: sub_4015C8+1C3j
		lea	eax, [ebp+var_674]
		mov	[esp+698h+File], eax
		call	sub_40345D
		movzx	eax, [ebp+var_674]
		and	eax, 4
		test	al, al
		jnz	short loc_401855
		mov	edx, offset aGpgkeysNoKeyDa ; "gpgkeys:	no key data found for %s\n"
		mov	eax, ds:dword_40E028
		lea	ecx, [ebp+Dest]
		mov	[esp+698h+var_690], ecx
		mov	[esp+698h+Format], edx ; Format
		mov	[esp+698h+File], eax ; File
		call	fprintf
		mov	edx, offset aKey0xSFailedD ; "\nKEY 0x%s FAILED	%d\n"
		mov	eax, ds:File
		mov	[esp+698h+var_68C], 6
		mov	ecx, [ebp+arg_0]
		mov	[esp+698h+var_690], ecx
		mov	[esp+698h+Format], edx ; Format
		mov	[esp+698h+File], eax ; File
		call	fprintf
		jmp	short loc_401872
; ---------------------------------------------------------------------------

loc_401855:				; CODE XREF: sub_4015C8+244j
		mov	edx, offset aKey0xSEnd ; "\nKEY	0x%s END\n"
		mov	eax, ds:File
		mov	ecx, [ebp+arg_0]
		mov	[esp+698h+var_690], ecx
		mov	[esp+698h+Format], edx ; Format
		mov	[esp+698h+File], eax ; File
		call	fprintf

loc_401872:				; CODE XREF: sub_4015C8+225j
					; sub_4015C8+28Bj
		mov	eax, [ebp+var_2C]
		mov	[esp+698h+File], eax
		call	sub_4030AD
		add	esp, 68Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4015C8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401888(FILE *)
sub_401888	proc near		; CODE XREF: sub_401920+108p
					; sub_401920+130p

Str		= dword	ptr -18h
Size		= dword	ptr -14h
Count		= dword	ptr -10h
File		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, offset aHHelpHelp ; "-h, --help\thelp\n"
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 10h ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		mov	eax, offset aVMachineReadab ; "-V\t\tmachine readable version\n"
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 1Dh ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		mov	eax, offset aVersionHumanRe ; "--version\thuman	readable version\n"
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 21h ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		mov	eax, offset aOOutputToThisF ; "-o\t\toutput to this file\n"
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Count], 18h ; Count
		mov	[esp+18h+Size],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		leave
		retn
sub_401888	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401920	proc near		; CODE XREF: sub_401180+265p

Format		= dword	ptr -58Ch
Mode		= dword	ptr -588h
MaxCount	= dword	ptr -584h
File		= dword	ptr -580h
var_570		= dword	ptr -570h
Str1		= byte ptr -565h
var_465		= byte ptr -465h
Src		= byte ptr -464h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
Memory		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		and	esp, 0FFFFFFF0h
		sub	esp, 580h
		call	sub_409780
		mov	[esp+58Ch+var_10], 1
		mov	[esp+58Ch+var_18], 0
		mov	[esp+58Ch+var_1C], 5
		mov	[esp+58Ch+Memory], 0
		mov	[esp+58Ch+var_24], 0
		mov	eax, ds:_iob
		add	eax, 40h
		mov	ds:dword_40E028, eax
		cmp	[ebp+arg_0], 1
		jle	short loc_4019E2
		mov	eax, [ebp+arg_4]
		add	eax, 4
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, offset aVersion ; "--version"
		mov	ecx, 0Ah
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4019E2
		mov	eax, offset aGpgkeys_curlGn ; "gpgkeys_curl (GnuPG) %s\n"
		mov	[esp+58Ch+Mode], offset	a2_0_30	; "2.0.30"
		mov	[esp+58Ch+Format], eax ; Format
		call	printf
		mov	eax, ds:curl_version
		call	eax ; curl_version
		mov	edx, offset aUsesS ; "Uses: %s\n"
		mov	[esp+58Ch+Mode], eax
		mov	[esp+58Ch+Format], edx ; Format
		call	printf
		mov	eax, 0
		jmp	loc_402607
; ---------------------------------------------------------------------------

loc_4019E2:				; CODE XREF: sub_401920+5Cj
					; sub_401920+89j
		cmp	[ebp+arg_0], 1
		jle	loc_401AF8
		mov	eax, [ebp+arg_4]
		add	eax, 4
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, offset aHelp ; "--help"
		mov	ecx, 7
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	loc_401AF8
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+58Ch+Format], eax ; FILE *
		call	sub_401888
		mov	eax, 0
		jmp	loc_402607
; ---------------------------------------------------------------------------

loc_401A37:				; CODE XREF: sub_401920+201j
		mov	eax, [esp+58Ch+var_30]
		cmp	eax, 56h
		jz	short loc_401A5F
		cmp	eax, 6Fh
		jz	short loc_401A93
		mov	eax, ds:dword_40E028
		mov	[esp+58Ch+Format], eax ; FILE *
		call	sub_401888
		mov	eax, 0
		jmp	loc_402607
; ---------------------------------------------------------------------------

loc_401A5F:				; CODE XREF: sub_401920+121j
		mov	eax, offset aDS	; "%d\n%s\n"
		mov	edx, ds:_iob
		add	edx, 20h
		mov	[esp+58Ch+File], offset	a2_0_30	; "2.0.30"
		mov	[esp+58Ch+MaxCount], 1
		mov	[esp+58Ch+Mode], eax ; Format
		mov	[esp+58Ch+Format], edx ; File
		call	fprintf
		mov	eax, 0
		jmp	loc_402607
; ---------------------------------------------------------------------------

loc_401A93:				; CODE XREF: sub_401920+126j
		mov	edx, offset Mode ; "wb"
		mov	eax, ds:Filename
		mov	[esp+58Ch+Mode], edx ; Mode
		mov	[esp+58Ch+Format], eax ; Filename
		call	fopen
		mov	ds:File, eax
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_401AF7
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+58Ch+Format], eax ; int
		call	strerror
		mov	ebx, ds:Filename
		mov	ecx, offset aGpgkeysCannotO ; "gpgkeys:	Cannot open output file	`%s': "...
		mov	edx, ds:dword_40E028
		mov	[esp+58Ch+File], eax
		mov	[esp+58Ch+MaxCount], ebx
		mov	[esp+58Ch+Mode], ecx ; Format
		mov	[esp+58Ch+Format], edx ; File
		call	fprintf
		mov	eax, 1
		jmp	loc_402607
; ---------------------------------------------------------------------------

loc_401AF7:				; CODE XREF: sub_401920+195j
		nop

loc_401AF8:				; CODE XREF: sub_401920+C6j
					; sub_401920+F7j
		mov	[esp+58Ch+MaxCount], offset aHvo ; "hVo:"
		mov	eax, [ebp+arg_4]
		mov	[esp+58Ch+Mode], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58Ch+Format], eax
		call	sub_40A630
		mov	[esp+58Ch+var_30], eax
		cmp	[esp+58Ch+var_30], 0FFFFFFFFh
		jnz	loc_401A37
		mov	eax, dword_40B024
		cmp	[ebp+arg_0], eax
		jle	short loc_401BA5
		mov	edx, offset aR	; "r"
		mov	eax, dword_40B024
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+58Ch+Mode], edx ; Mode
		mov	[esp+58Ch+Format], eax ; Filename
		call	fopen
		mov	ds:dword_40E020, eax
		mov	eax, ds:dword_40E020
		test	eax, eax
		jnz	short loc_401BA5
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+58Ch+Format], eax ; int
		call	strerror
		mov	edx, dword_40B024
		shl	edx, 2
		add	edx, [ebp+arg_4]
		mov	ebx, [edx]
		mov	ecx, offset aGpgkeysCanno_0 ; "gpgkeys:	Cannot open input file `%s': %"...
		mov	edx, ds:dword_40E028
		mov	[esp+58Ch+File], eax
		mov	[esp+58Ch+MaxCount], ebx
		mov	[esp+58Ch+Mode], ecx ; Format
		mov	[esp+58Ch+Format], edx ; File
		call	fprintf
		mov	eax, 1
		jmp	loc_402607
; ---------------------------------------------------------------------------

loc_401BA5:				; CODE XREF: sub_401920+20Fj
					; sub_401920+23Bj
		mov	eax, ds:dword_40E020
		test	eax, eax
		jnz	short loc_401BB8
		mov	eax, ds:_iob
		mov	ds:dword_40E020, eax

loc_401BB8:				; CODE XREF: sub_401920+28Cj
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_401BCE
		mov	eax, ds:_iob
		add	eax, 20h
		mov	ds:File, eax

loc_401BCE:				; CODE XREF: sub_401920+29Fj
		call	sub_4026D0
		mov	ds:dword_40E030, eax
		mov	eax, ds:dword_40E030
		test	eax, eax
		jnz	loc_401E1E
		mov	eax, 5
		jmp	loc_402607
; ---------------------------------------------------------------------------

loc_401BEF:				; CODE XREF: sub_401920+527j
		movzx	eax, [esp+58Ch+Src]
		cmp	al, 0Ah
		jz	loc_401E4F
		mov	eax, ds:dword_40E030
		mov	[esp+58Ch+Mode], eax ; int
		lea	eax, [esp+58Ch+Src]
		mov	[esp+58Ch+Format], eax ; char *
		call	sub_4027DD
		mov	[esp+58Ch+var_34], eax
		cmp	[esp+58Ch+var_34], 0
		jle	short loc_401C3B
		mov	eax, [esp+58Ch+var_34]
		mov	[esp+58Ch+var_10], eax
		jmp	loc_40256B
; ---------------------------------------------------------------------------

loc_401C3B:				; CODE XREF: sub_401920+306j
		cmp	[esp+58Ch+var_34], 0
		jz	loc_401E21
		mov	edx, offset aOption256s	; "OPTION %256s\n"
		lea	eax, [esp+58Ch+Src]
		lea	ecx, [esp+58Ch+Str1]
		mov	[esp+58Ch+MaxCount], ecx
		mov	[esp+58Ch+Mode], edx ; Format
		mov	[esp+58Ch+Format], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	loc_401E25
		mov	[esp+58Ch+var_28], 0
		lea	eax, [esp+58Ch+Str1]
		mov	[esp+58Ch+var_2C], eax
		mov	[esp+58Ch+var_465], 0
		mov	[esp+58Ch+MaxCount], 3 ; MaxCount
		mov	[esp+58Ch+Mode], offset	Str ; "no-"
		lea	eax, [esp+58Ch+Str1]
		mov	[esp+58Ch+Format], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_401CCB
		mov	[esp+58Ch+var_28], 1
		lea	eax, [esp+58Ch+Str1]
		add	eax, 3
		mov	[esp+58Ch+var_2C], eax

loc_401CCB:				; CODE XREF: sub_401920+390j
		mov	[esp+58Ch+MaxCount], 0Ah ; MaxCount
		mov	[esp+58Ch+Mode], offset	aHttpProxy ; "http-proxy"
		mov	eax, [esp+58Ch+var_2C]
		mov	[esp+58Ch+Format], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	loc_401D98
		cmp	[esp+58Ch+var_28], 0
		jz	short loc_401D25
		mov	eax, [esp+58Ch+Memory]
		mov	[esp+58Ch+Format], eax ; Memory
		call	free
		mov	[esp+58Ch+Format], offset Src ;	Src
		call	_strdup
		mov	[esp+58Ch+Memory], eax
		jmp	loc_401E24
; ---------------------------------------------------------------------------

loc_401D25:				; CODE XREF: sub_401920+3DCj
		mov	eax, [esp+58Ch+var_2C]
		add	eax, 0Ah
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	loc_401E24
		mov	eax, [esp+58Ch+var_2C]
		add	eax, 0Bh
		mov	[esp+58Ch+var_570], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [esp+58Ch+var_570]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 7Fh
		ja	loc_401E24
		mov	eax, [esp+58Ch+Memory]
		mov	[esp+58Ch+Format], eax ; Memory
		call	free
		mov	eax, [esp+58Ch+var_2C]
		add	eax, 0Bh
		mov	[esp+58Ch+Format], eax ; Src
		call	_strdup
		mov	[esp+58Ch+Memory], eax
		jmp	loc_401E24
; ---------------------------------------------------------------------------

loc_401D98:				; CODE XREF: sub_401920+3CEj
		mov	[esp+58Ch+MaxCount], 10h ; MaxCount
		mov	[esp+58Ch+Mode], offset	aFollowRedirect	; "follow-redirects"
		mov	eax, [esp+58Ch+var_2C]
		mov	[esp+58Ch+Format], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_401E24
		cmp	[esp+58Ch+var_28], 0
		jz	short loc_401DD4
		mov	[esp+58Ch+var_1C], 0
		jmp	short loc_401E24
; ---------------------------------------------------------------------------

loc_401DD4:				; CODE XREF: sub_401920+4A5j
		mov	eax, [esp+58Ch+var_2C]
		add	eax, 10h
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_401E00
		mov	eax, [esp+58Ch+var_2C]
		add	eax, 11h
		mov	[esp+58Ch+Format], eax ; Str
		call	atoi
		mov	[esp+58Ch+var_1C], eax
		jmp	short loc_401E24
; ---------------------------------------------------------------------------

loc_401E00:				; CODE XREF: sub_401920+4C3j
		mov	eax, [esp+58Ch+var_2C]
		add	eax, 10h
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_401E24
		mov	[esp+58Ch+var_1C], 0FFFFFFFFh
		jmp	short loc_401E24
; ---------------------------------------------------------------------------

loc_401E1E:				; CODE XREF: sub_401920+2BFj
		nop
		jmp	short loc_401E25
; ---------------------------------------------------------------------------

loc_401E21:				; CODE XREF: sub_401920+323j
		nop
		jmp	short loc_401E25
; ---------------------------------------------------------------------------

loc_401E24:				; CODE XREF: sub_401920+400j
					; sub_401920+414j ...
		nop

loc_401E25:				; CODE XREF: sub_401920+34Cj
					; sub_401920+4FFj ...
		mov	eax, ds:dword_40E020
		mov	[esp+58Ch+MaxCount], eax ; File
		mov	[esp+58Ch+Mode], 408h ;	MaxCount
		lea	eax, [esp+58Ch+Src]
		mov	[esp+58Ch+Format], eax ; Buf
		call	fgets
		test	eax, eax
		jnz	loc_401BEF
		jmp	short loc_401E50
; ---------------------------------------------------------------------------

loc_401E4F:				; CODE XREF: sub_401920+2D9j
		nop

loc_401E50:				; CODE XREF: sub_401920+52Dj
		mov	eax, ds:dword_40E030
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_401E93
		mov	edx, ds:dword_40E028
		mov	eax, offset aGpgkeysNoSchem ; "gpgkeys:	no scheme supplied!\n"
		mov	[esp+58Ch+File], edx ; File
		mov	[esp+58Ch+MaxCount], 1Dh ; Count
		mov	[esp+58Ch+Mode], 1 ; Size
		mov	[esp+58Ch+Format], eax ; Str
		call	fwrite
		mov	[esp+58Ch+var_10], 7Fh
		jmp	loc_40256B
; ---------------------------------------------------------------------------

loc_401E93:				; CODE XREF: sub_401920+53Aj
		mov	eax, ds:dword_40E030
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_401ECB
		mov	edx, ds:dword_40E028
		mov	eax, offset aGpgkeysNoKeyse ; "gpgkeys:	no keyserver host provided\n"
		mov	[esp+58Ch+File], edx ; File
		mov	[esp+58Ch+MaxCount], 24h ; Count
		mov	[esp+58Ch+Mode], 1 ; Size
		mov	[esp+58Ch+Format], eax ; Str
		call	fwrite
		jmp	loc_40256B
; ---------------------------------------------------------------------------

loc_401ECB:				; CODE XREF: sub_401920+57Dj
		mov	eax, ds:dword_40E030
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_401F12
		call	sub_402692
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_401F12
		mov	edx, ds:dword_40E028
		mov	eax, offset aGpgkeysUnableT ; "gpgkeys:	unable to register timeout han"...
		mov	[esp+58Ch+File], edx ; File
		mov	[esp+58Ch+MaxCount], 2Ch ; Count
		mov	[esp+58Ch+Mode], 1 ; Size
		mov	[esp+58Ch+Format], eax ; Str
		call	fwrite
		mov	eax, 1
		jmp	loc_402607
; ---------------------------------------------------------------------------

loc_401F12:				; CODE XREF: sub_401920+5B5j
					; sub_401920+5BFj
		mov	[esp+58Ch+Format], 3
		mov	eax, ds:curl_global_init
		call	eax ; curl_global_init
		mov	eax, ds:curl_easy_init
		call	eax ; curl_easy_init
		mov	ds:dword_40E02C, eax
		mov	eax, ds:dword_40E02C
		test	eax, eax
		jnz	short loc_401F6C
		mov	edx, ds:dword_40E028
		mov	eax, offset aGpgkeysUnabl_0 ; "gpgkeys:	unable to initialize curl\n"
		mov	[esp+58Ch+File], edx ; File
		mov	[esp+58Ch+MaxCount], 23h ; Count
		mov	[esp+58Ch+Mode], 1 ; Size
		mov	[esp+58Ch+Format], eax ; Str
		call	fwrite
		mov	[esp+58Ch+var_10], 1
		jmp	loc_40256B
; ---------------------------------------------------------------------------

loc_401F6C:				; CODE XREF: sub_401920+613j
		mov	[esp+58Ch+Format], 3
		mov	eax, ds:curl_version_info
		call	eax ; curl_version_info
		mov	[esp+58Ch+var_38], eax
		mov	[esp+58Ch+var_14], 0
		jmp	short loc_401FC8
; ---------------------------------------------------------------------------

loc_401F8E:				; CODE XREF: sub_401920+6C2j
		mov	eax, ds:dword_40E030
		mov	edx, [eax+0Ch]
		mov	eax, [esp+58Ch+var_38]
		mov	eax, [eax+20h]
		mov	ecx, [esp+58Ch+var_14]
		shl	ecx, 2
		add	eax, ecx
		mov	eax, [eax]
		mov	[esp+58Ch+Mode], edx ; Str2
		mov	[esp+58Ch+Format], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jz	short loc_401FE6
		add	[esp+58Ch+var_14], 1

loc_401FC8:				; CODE XREF: sub_401920+66Cj
		mov	eax, [esp+58Ch+var_38]
		mov	eax, [eax+20h]
		mov	edx, [esp+58Ch+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_401F8E
		jmp	short loc_401FE7
; ---------------------------------------------------------------------------

loc_401FE6:				; CODE XREF: sub_401920+69Ej
		nop

loc_401FE7:				; CODE XREF: sub_401920+6C4j
		mov	eax, [esp+58Ch+var_38]
		mov	eax, [eax+20h]
		mov	edx, [esp+58Ch+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_402035
		mov	eax, ds:dword_40E030
		mov	ecx, [eax+0Ch]
		mov	edx, offset aGpgkeysProtoco ; "gpgkeys:	protocol `%s' not supported\n"
		mov	eax, ds:dword_40E028
		mov	[esp+58Ch+MaxCount], ecx
		mov	[esp+58Ch+Mode], edx ; Format
		mov	[esp+58Ch+Format], eax ; File
		call	fprintf
		mov	[esp+58Ch+var_10], 7Fh
		jmp	loc_40256B
; ---------------------------------------------------------------------------

loc_402035:				; CODE XREF: sub_401920+6E1j
		cmp	[esp+58Ch+var_1C], 0
		jz	short loc_4020A6
		mov	[esp+58Ch+var_3C], 34h
		mov	edx, [esp+58Ch+var_3C]
		mov	eax, ds:dword_40E02C
		mov	[esp+58Ch+MaxCount], 1
		mov	[esp+58Ch+Mode], edx
		mov	[esp+58Ch+Format], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		cmp	[esp+58Ch+var_1C], 0
		jle	short loc_4020A6
		mov	[esp+58Ch+var_40], 44h
		mov	edx, [esp+58Ch+var_40]
		mov	eax, ds:dword_40E02C
		mov	ecx, [esp+58Ch+var_1C]
		mov	[esp+58Ch+MaxCount], ecx
		mov	[esp+58Ch+Mode], edx
		mov	[esp+58Ch+Format], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt

loc_4020A6:				; CODE XREF: sub_401920+71Dj
					; sub_401920+754j
		mov	eax, ds:dword_40E030
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_4020E3
		mov	[esp+58Ch+var_44], 2715h
		mov	eax, ds:dword_40E030
		mov	ecx, [eax+10h]
		mov	edx, [esp+58Ch+var_44]
		mov	eax, ds:dword_40E02C
		mov	[esp+58Ch+MaxCount], ecx
		mov	[esp+58Ch+Mode], edx
		mov	[esp+58Ch+Format], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt

loc_4020E3:				; CODE XREF: sub_401920+790j
		mov	eax, ds:dword_40E030
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_40216D
		mov	eax, ds:curl_version
		call	eax ; curl_version
		mov	ecx, offset aGpgkeysCurlVer ; "gpgkeys:	curl version = %s\n"
		mov	edx, ds:dword_40E028
		mov	[esp+58Ch+MaxCount], eax
		mov	[esp+58Ch+Mode], ecx ; Format
		mov	[esp+58Ch+Format], edx ; File
		call	fprintf
		mov	[esp+58Ch+var_48], 2735h
		mov	ecx, ds:dword_40E028
		mov	edx, [esp+58Ch+var_48]
		mov	eax, ds:dword_40E02C
		mov	[esp+58Ch+MaxCount], ecx
		mov	[esp+58Ch+Mode], edx
		mov	[esp+58Ch+Format], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		mov	[esp+58Ch+var_4C], 29h
		mov	edx, [esp+58Ch+var_4C]
		mov	eax, ds:dword_40E02C
		mov	[esp+58Ch+MaxCount], 1
		mov	[esp+58Ch+Mode], edx
		mov	[esp+58Ch+Format], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt

loc_40216D:				; CODE XREF: sub_401920+7CDj
		mov	[esp+58Ch+var_50], 40h
		mov	eax, ds:dword_40E030
		movzx	eax, byte ptr [eax+1Ch]
		shr	al, 3
		and	eax, 1
		movzx	ecx, al
		mov	edx, [esp+58Ch+var_50]
		mov	eax, ds:dword_40E02C
		mov	[esp+58Ch+MaxCount], ecx
		mov	[esp+58Ch+Mode], edx
		mov	[esp+58Ch+Format], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		mov	eax, ds:dword_40E030
		mov	eax, [eax+2Ch]
		test	eax, eax
		jz	short loc_4021E5
		mov	[esp+58Ch+var_54], 2751h
		mov	eax, ds:dword_40E030
		mov	ecx, [eax+2Ch]
		mov	edx, [esp+58Ch+var_54]
		mov	eax, ds:dword_40E02C
		mov	[esp+58Ch+MaxCount], ecx
		mov	[esp+58Ch+Mode], edx
		mov	[esp+58Ch+Format], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt

loc_4021E5:				; CODE XREF: sub_401920+892j
		mov	[esp+58Ch+Mode], offset	aPragmaNoCache ; "Pragma: no-cache"
		mov	eax, [esp+58Ch+var_24]
		mov	[esp+58Ch+Format], eax
		mov	eax, ds:curl_slist_append
		call	eax ; curl_slist_append
		mov	[esp+58Ch+var_24], eax
		cmp	[esp+58Ch+var_24], 0
		jz	short loc_40222F
		mov	[esp+58Ch+Mode], offset	aCacheControlNo	; "Cache-Control: no-cache"
		mov	eax, [esp+58Ch+var_24]
		mov	[esp+58Ch+Format], eax
		mov	eax, ds:curl_slist_append
		call	eax ; curl_slist_append
		mov	[esp+58Ch+var_24], eax

loc_40222F:				; CODE XREF: sub_401920+8EDj
		cmp	[esp+58Ch+var_24], 0
		jnz	short loc_402270
		mov	edx, ds:dword_40E028
		mov	eax, offset aGpgkeysOutOfMe ; "gpgkeys:	out of memory when building HT"...
		mov	[esp+58Ch+File], edx ; File
		mov	[esp+58Ch+MaxCount], 32h ; Count
		mov	[esp+58Ch+Mode], 1 ; Size
		mov	[esp+58Ch+Format], eax ; Str
		call	fwrite
		mov	[esp+58Ch+var_10], 5
		jmp	loc_40256B
; ---------------------------------------------------------------------------

loc_402270:				; CODE XREF: sub_401920+917j
		mov	[esp+58Ch+var_58], 2727h
		mov	edx, [esp+58Ch+var_58]
		mov	eax, ds:dword_40E02C
		mov	ecx, [esp+58Ch+var_24]
		mov	[esp+58Ch+MaxCount], ecx
		mov	[esp+58Ch+Mode], edx
		mov	[esp+58Ch+Format], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt
		cmp	[esp+58Ch+Memory], 0
		jz	short loc_4022DA
		mov	[esp+58Ch+var_5C], 2714h
		mov	edx, [esp+58Ch+var_5C]
		mov	eax, ds:dword_40E02C
		mov	ecx, [esp+58Ch+Memory]
		mov	[esp+58Ch+MaxCount], ecx
		mov	[esp+58Ch+Mode], edx
		mov	[esp+58Ch+Format], eax
		mov	eax, ds:curl_easy_setopt
		call	eax ; curl_easy_setopt

loc_4022DA:				; CODE XREF: sub_401920+988j
		mov	eax, ds:dword_40E030
		mov	eax, [eax]
		cmp	eax, 1
		jnz	loc_4023DA
		jmp	short loc_4022ED
; ---------------------------------------------------------------------------

loc_4022EC:				; CODE XREF: sub_401920+A1Dj
					; sub_401920+AA8j
		nop

loc_4022ED:				; CODE XREF: sub_401920+9CAj
		mov	eax, ds:dword_40E020
		mov	[esp+58Ch+MaxCount], eax ; File
		mov	[esp+58Ch+Mode], 408h ;	MaxCount
		lea	eax, [esp+58Ch+Src]
		mov	[esp+58Ch+Format], eax ; Buf
		call	fgets
		test	eax, eax
		jz	loc_4023CD
		movzx	eax, [esp+58Ch+Src]
		cmp	al, 0Ah
		jz	loc_4023CE
		movzx	eax, [esp+58Ch+Src]
		test	al, al
		jz	loc_4023CE
		cmp	[esp+58Ch+var_18], 0
		jnz	short loc_4022EC
		lea	eax, [esp+58Ch+Src]
		mov	[esp+58Ch+Format], eax ; Src
		call	_strdup
		mov	[esp+58Ch+var_18], eax
		cmp	[esp+58Ch+var_18], 0
		jnz	short loc_402396
		mov	edx, ds:dword_40E028
		mov	eax, offset aGpgkeysOutOf_0 ; "gpgkeys:	out of memory while building k"...
		mov	[esp+58Ch+File], edx ; File
		mov	[esp+58Ch+MaxCount], 2Fh ; Count
		mov	[esp+58Ch+Mode], 1 ; Size
		mov	[esp+58Ch+Format], eax ; Str
		call	fwrite
		mov	[esp+58Ch+var_10], 5
		jmp	loc_40256B
; ---------------------------------------------------------------------------

loc_402396:				; CODE XREF: sub_401920+A3Dj
		lea	eax, [esp+58Ch+Src]
		mov	[esp+58Ch+var_570], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [esp+58Ch+var_570]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [esp+58Ch+var_18]
		mov	byte ptr [eax],	0
		jmp	loc_4022EC
; ---------------------------------------------------------------------------

loc_4023CD:				; CODE XREF: sub_401920+9EFj
		nop

loc_4023CE:				; CODE XREF: sub_401920+9FFj
					; sub_401920+A0Fj
		cmp	[esp+58Ch+var_18], 0
		jz	short loc_402406
		jmp	short loc_402432
; ---------------------------------------------------------------------------

loc_4023DA:				; CODE XREF: sub_401920+9C4j
		mov	edx, ds:dword_40E028
		mov	eax, offset aGpgkeysThisKey ; "gpgkeys:	this keyserver type only suppo"...
		mov	[esp+58Ch+File], edx ; File
		mov	[esp+58Ch+MaxCount], 39h ; Count
		mov	[esp+58Ch+Mode], 1 ; Size
		mov	[esp+58Ch+Format], eax ; Str
		call	fwrite
		jmp	loc_40256B
; ---------------------------------------------------------------------------

loc_402406:				; CODE XREF: sub_401920+AB6j
		mov	edx, ds:dword_40E028
		mov	eax, offset aGpgkeysInvalid ; "gpgkeys:	invalid	keyserver instructions"...
		mov	[esp+58Ch+File], edx ; File
		mov	[esp+58Ch+MaxCount], 28h ; Count
		mov	[esp+58Ch+Mode], 1 ; Size
		mov	[esp+58Ch+Format], eax ; Str
		call	fwrite
		jmp	loc_40256B
; ---------------------------------------------------------------------------

loc_402432:				; CODE XREF: sub_401920+AB8j
		mov	edx, offset aVersionD ;	"VERSION %d\n"
		mov	eax, ds:File
		mov	[esp+58Ch+MaxCount], 1
		mov	[esp+58Ch+Mode], edx ; Format
		mov	[esp+58Ch+Format], eax ; File
		call	fprintf
		mov	edx, offset aProgramS ;	"PROGRAM %s\n\n"
		mov	eax, ds:File
		mov	[esp+58Ch+MaxCount], offset a2_0_30 ; "2.0.30"
		mov	[esp+58Ch+Mode], edx ; Format
		mov	[esp+58Ch+Format], eax ; File
		call	fprintf
		mov	eax, ds:dword_40E030
		mov	eax, [eax+20h]
		test	eax, eax
		jz	loc_402545
		mov	eax, ds:dword_40E030
		mov	ecx, [eax+0Ch]
		mov	edx, offset aSchemeS ; "Scheme:\t\t%s\n"
		mov	eax, ds:dword_40E028
		mov	[esp+58Ch+MaxCount], ecx
		mov	[esp+58Ch+Mode], edx ; Format
		mov	[esp+58Ch+Format], eax ; File
		call	fprintf
		mov	eax, ds:dword_40E030
		mov	ecx, [eax+4]
		mov	edx, offset aHostS ; "Host:\t\t%s\n"
		mov	eax, ds:dword_40E028
		mov	[esp+58Ch+MaxCount], ecx
		mov	[esp+58Ch+Mode], edx ; Format
		mov	[esp+58Ch+Format], eax ; File
		call	fprintf
		mov	eax, ds:dword_40E030
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4024F0
		mov	eax, ds:dword_40E030
		mov	ecx, [eax+8]
		mov	edx, offset aPortS ; "Port:\t\t%s\n"
		mov	eax, ds:dword_40E028
		mov	[esp+58Ch+MaxCount], ecx
		mov	[esp+58Ch+Mode], edx ; Format
		mov	[esp+58Ch+Format], eax ; File
		call	fprintf

loc_4024F0:				; CODE XREF: sub_401920+BACj
		mov	eax, ds:dword_40E030
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_40251E
		mov	eax, ds:dword_40E030
		mov	ecx, [eax+14h]
		mov	edx, offset aPathS ; "Path:\t\t%s\n"
		mov	eax, ds:dword_40E028
		mov	[esp+58Ch+MaxCount], ecx
		mov	[esp+58Ch+Mode], edx ; Format
		mov	[esp+58Ch+Format], eax ; File
		call	fprintf

loc_40251E:				; CODE XREF: sub_401920+BDAj
		mov	edx, ds:dword_40E028
		mov	eax, offset aCommandGet	; "Command:\tGET\n"
		mov	[esp+58Ch+File], edx ; File
		mov	[esp+58Ch+MaxCount], 0Dh ; Count
		mov	[esp+58Ch+Mode], 1 ; Size
		mov	[esp+58Ch+Format], eax ; Str
		call	fwrite

loc_402545:				; CODE XREF: sub_401920+B58j
		mov	eax, ds:dword_40E030
		mov	eax, [eax+28h]
		mov	[esp+58Ch+Format], eax
		call	sub_402688
		mov	eax, [esp+58Ch+var_18]
		mov	[esp+58Ch+Format], eax
		call	sub_4015C8
		mov	[esp+58Ch+var_10], eax

loc_40256B:				; CODE XREF: sub_401920+316j
					; sub_401920+56Ej ...
		mov	eax, [esp+58Ch+var_18]
		mov	[esp+58Ch+Format], eax ; Memory
		call	free
		mov	edx, ds:dword_40E020
		mov	eax, ds:_iob
		cmp	edx, eax
		jz	short loc_402596
		mov	eax, ds:dword_40E020
		mov	[esp+58Ch+Format], eax ; File
		call	fclose

loc_402596:				; CODE XREF: sub_401920+C67j
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_4025B4
		mov	eax, ds:File
		mov	[esp+58Ch+Format], eax ; File
		call	fclose

loc_4025B4:				; CODE XREF: sub_401920+C85j
		mov	eax, ds:dword_40E030
		mov	[esp+58Ch+Format], eax ; void *
		call	sub_402762
		mov	eax, [esp+58Ch+var_24]
		mov	[esp+58Ch+Format], eax
		mov	eax, ds:curl_slist_free_all
		call	eax ; curl_slist_free_all
		mov	eax, ds:dword_40E02C
		test	eax, eax
		jz	short loc_4025EA
		mov	eax, ds:dword_40E02C
		mov	[esp+58Ch+Format], eax
		mov	eax, ds:curl_easy_cleanup
		call	eax ; curl_easy_cleanup

loc_4025EA:				; CODE XREF: sub_401920+CB9j
		mov	eax, [esp+58Ch+Memory]
		mov	[esp+58Ch+Format], eax ; Memory
		call	free
		mov	eax, ds:curl_global_cleanup
		call	eax ; curl_global_cleanup
		mov	eax, [esp+58Ch+var_10]

loc_402607:				; CODE XREF: sub_401920+BDj
					; sub_401920+112j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_401920	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402688	proc near		; CODE XREF: sub_401920+C30p
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_402688	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402692	proc near		; CODE XREF: sub_401920+5B7p
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_402692	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_40E040
		test	eax, eax
		jnz	short locret_4026CE
		mov	dword ptr [esp+4], offset dword_40E060
		mov	dword ptr [esp], 202h
		mov	eax, ds:WSAStartup
		call	eax ; WSAStartup
		sub	esp, 8
		mov	ds:dword_40E040, 1

locret_4026CE:				; CODE XREF: .text:004026A9j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4026D0	proc near		; CODE XREF: sub_401920:loc_401BCEp

NumOfElements	= dword	ptr -28h
SizeOfElements	= dword	ptr -24h
Memory		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+SizeOfElements], 30h ;	SizeOfElements
		mov	[esp+28h+NumOfElements], 1 ; NumOfElements
		call	calloc
		mov	[ebp+Memory], eax
		cmp	[ebp+Memory], 0
		jz	short loc_40275D
		mov	eax, [ebp+Memory]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+Memory]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 2
		mov	[eax+1Ch], dl
		mov	eax, [ebp+Memory]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 4
		mov	[eax+1Ch], dl
		mov	eax, [ebp+Memory]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 8
		mov	[eax+1Ch], dl
		mov	eax, [ebp+Memory]
		mov	dword ptr [eax+28h], 78h
		mov	[esp+28h+NumOfElements], offset	asc_40C43C ; "/"
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+Memory]
		mov	[eax+14h], edx
		mov	eax, [ebp+Memory]
		mov	eax, [eax+14h]
		test	eax, eax
		jnz	short loc_40275D
		mov	eax, [ebp+Memory]
		mov	[esp+28h+NumOfElements], eax ; Memory
		call	free
		mov	[ebp+Memory], 0

loc_40275D:				; CODE XREF: sub_4026D0+21j
					; sub_4026D0+79j
		mov	eax, [ebp+Memory]
		leave
		retn
sub_4026D0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402762(void *)
sub_402762	proc near		; CODE XREF: sub_401920+C9Cp

Memory		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_4027DB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

locret_4027DB:				; CODE XREF: sub_402762+Aj
		leave
		retn
sub_402762	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4027DD(char *, int)
sub_4027DD	proc near		; CODE XREF: sub_401920+2F2p

Src		= dword	ptr -0A28h
Format		= dword	ptr -0A24h
MaxCount	= dword	ptr -0A20h
var_A11		= byte ptr -0A11h
var_911		= byte ptr -911h
var_910		= byte ptr -910h
var_510		= byte ptr -510h
var_50F		= byte ptr -50Fh
var_10F		= byte ptr -10Fh
var_10E		= byte ptr -10Eh
var_8E		= byte ptr -8Eh
var_8D		= byte ptr -8Dh
var_79		= byte ptr -79h
var_78		= byte ptr -78h
var_6E		= byte ptr -6Eh
var_6D		= byte ptr -6Dh
var_1D		= byte ptr -1Dh
Str1		= byte ptr -1Ch
var_15		= byte ptr -15h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0A28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 23h
		jnz	short loc_4027FA
		mov	eax, 0
		jmp	locret_402EE6
; ---------------------------------------------------------------------------

loc_4027FA:				; CODE XREF: sub_4027DD+11j
		mov	edx, offset aCommand7s ; "COMMAND %7s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+Str1]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	loc_4028BA
		mov	[ebp+var_15], 0
		mov	[esp+0A28h+Format], offset Str2	; "get"
		lea	eax, [ebp+Str1]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_402846
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 1
		jmp	short loc_4028B0
; ---------------------------------------------------------------------------

loc_402846:				; CODE XREF: sub_4027DD+5Cj
		mov	[esp+0A28h+Format], offset aGetname ; "getname"
		lea	eax, [ebp+Str1]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_40286A
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 2
		jmp	short loc_4028B0
; ---------------------------------------------------------------------------

loc_40286A:				; CODE XREF: sub_4027DD+80j
		mov	[esp+0A28h+Format], offset aSend ; "send"
		lea	eax, [ebp+Str1]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_40288E
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 3
		jmp	short loc_4028B0
; ---------------------------------------------------------------------------

loc_40288E:				; CODE XREF: sub_4027DD+A4j
		mov	[esp+0A28h+Format], offset aSearch ; "search"
		lea	eax, [ebp+Str1]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_4028B0
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 4

loc_4028B0:				; CODE XREF: sub_4027DD+67j
					; sub_4027DD+8Bj ...
		mov	eax, 0
		jmp	locret_402EE6
; ---------------------------------------------------------------------------

loc_4028BA:				; CODE XREF: sub_4027DD+3Bj
		mov	edx, offset aHost80s ; "HOST %80s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_6D]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_40291D
		mov	[ebp+var_1D], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_6D]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_402913
		mov	eax, 5
		jmp	locret_402EE6
; ---------------------------------------------------------------------------

loc_402913:				; CODE XREF: sub_4027DD+12Aj
		mov	eax, 0
		jmp	locret_402EE6
; ---------------------------------------------------------------------------

loc_40291D:				; CODE XREF: sub_4027DD+FBj
		mov	edx, offset aPort10s ; "PORT %10s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_78]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_402980
		mov	[ebp+var_6E], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_78]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_402976
		mov	eax, 5
		jmp	locret_402EE6
; ---------------------------------------------------------------------------

loc_402976:				; CODE XREF: sub_4027DD+18Dj
		mov	eax, 0
		jmp	locret_402EE6
; ---------------------------------------------------------------------------

loc_402980:				; CODE XREF: sub_4027DD+15Ej
		mov	edx, offset aScheme20s ; "SCHEME %20s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_8D]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_4029E9
		mov	[ebp+var_79], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+0Ch]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_8D]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_4029DF
		mov	eax, 5
		jmp	locret_402EE6
; ---------------------------------------------------------------------------

loc_4029DF:				; CODE XREF: sub_4027DD+1F6j
		mov	eax, 0
		jmp	locret_402EE6
; ---------------------------------------------------------------------------

loc_4029E9:				; CODE XREF: sub_4027DD+1C4j
		mov	edx, offset aAuth128s ;	"AUTH %128s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_10E]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_402A55
		mov	[ebp+var_8E], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+10h]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_10E]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_402A4B
		mov	eax, 5
		jmp	locret_402EE6
; ---------------------------------------------------------------------------

loc_402A4B:				; CODE XREF: sub_4027DD+262j
		mov	eax, 0
		jmp	locret_402EE6
; ---------------------------------------------------------------------------

loc_402A55:				; CODE XREF: sub_4027DD+22Dj
		mov	edx, offset aPath1024s ; "PATH %1024s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_50F]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_402AC1
		mov	[ebp+var_10F], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_50F]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		test	eax, eax
		jnz	short loc_402AB7
		mov	eax, 5
		jmp	locret_402EE6
; ---------------------------------------------------------------------------

loc_402AB7:				; CODE XREF: sub_4027DD+2CEj
		mov	eax, 0
		jmp	locret_402EE6
; ---------------------------------------------------------------------------

loc_402AC1:				; CODE XREF: sub_4027DD+299j
		mov	edx, offset aOpaque1024s ; "OPAQUE %1024s\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_910]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_402B2D
		mov	[ebp+var_510], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+18h]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		lea	eax, [ebp+var_910]
		mov	[esp+0A28h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+18h], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+18h]
		test	eax, eax
		jnz	short loc_402B23
		mov	eax, 5
		jmp	locret_402EE6
; ---------------------------------------------------------------------------

loc_402B23:				; CODE XREF: sub_4027DD+33Aj
		mov	eax, 0
		jmp	locret_402EE6
; ---------------------------------------------------------------------------

loc_402B2D:				; CODE XREF: sub_4027DD+305j
		mov	edx, offset aVersionD_0	; "VERSION %d\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_14]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	short loc_402B69
		mov	eax, [ebp+var_14]
		cmp	eax, 1
		jz	short loc_402B5F
		mov	eax, 3
		jmp	locret_402EE6
; ---------------------------------------------------------------------------

loc_402B5F:				; CODE XREF: sub_4027DD+376j
		mov	eax, 0
		jmp	locret_402EE6
; ---------------------------------------------------------------------------

loc_402B69:				; CODE XREF: sub_4027DD+36Ej
		mov	edx, offset aOption256 ; "OPTION %256[^\n]\n"
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_A11]
		mov	[esp+0A28h+MaxCount], ecx
		mov	[esp+0A28h+Format], edx	; Format
		mov	[esp+0A28h+Src], eax ; Src
		call	sscanf
		cmp	eax, 1
		jnz	loc_402EE1
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_A11]
		mov	[ebp+var_10], eax
		mov	[ebp+var_911], 0
		mov	[esp+0A28h+MaxCount], 3	; MaxCount
		mov	[esp+0A28h+Format], offset aNo_0 ; "no-"
		lea	eax, [ebp+var_A11]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_402BDE
		mov	[ebp+var_C], 1
		lea	eax, [ebp+var_A11]
		add	eax, 3
		mov	[ebp+var_10], eax

loc_402BDE:				; CODE XREF: sub_4027DD+3ECj
		mov	[esp+0A28h+MaxCount], 7	; MaxCount
		mov	[esp+0A28h+Format], offset aVerbose ; "verbose"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_402C50
		cmp	[ebp+var_C], 0
		jz	short loc_402C14
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+20h], 0
		jmp	loc_402EE1
; ---------------------------------------------------------------------------

loc_402C14:				; CODE XREF: sub_4027DD+426j
		mov	eax, [ebp+var_10]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_402C3C
		mov	eax, [ebp+var_10]
		add	eax, 8
		mov	[esp+0A28h+Src], eax ; Str
		call	atoi
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+20h], edx
		jmp	loc_402EE1
; ---------------------------------------------------------------------------

loc_402C3C:				; CODE XREF: sub_4027DD+442j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_4]
		mov	[eax+20h], edx
		jmp	loc_402EE1
; ---------------------------------------------------------------------------

loc_402C50:				; CODE XREF: sub_4027DD+420j
		mov	[esp+0A28h+Format], offset aIncludeDisable ; "include-disabled"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_402C93
		cmp	[ebp+var_C], 0
		jz	short loc_402C81
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFFEh
		mov	[eax+1Ch], dl
		jmp	loc_402EE1
; ---------------------------------------------------------------------------

loc_402C81:				; CODE XREF: sub_4027DD+490j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 1
		mov	[eax+1Ch], dl
		jmp	loc_402EE1
; ---------------------------------------------------------------------------

loc_402C93:				; CODE XREF: sub_4027DD+48Aj
		mov	[esp+0A28h+Format], offset aIncludeRevoked ; "include-revoked"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_402CD6
		cmp	[ebp+var_C], 0
		jz	short loc_402CC4
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+1Ch], dl
		jmp	loc_402EE1
; ---------------------------------------------------------------------------

loc_402CC4:				; CODE XREF: sub_4027DD+4D3j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 2
		mov	[eax+1Ch], dl
		jmp	loc_402EE1
; ---------------------------------------------------------------------------

loc_402CD6:				; CODE XREF: sub_4027DD+4CDj
		mov	[esp+0A28h+Format], offset aIncludeSubkeys ; "include-subkeys"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_402D19
		cmp	[ebp+var_C], 0
		jz	short loc_402D07
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFFBh
		mov	[eax+1Ch], dl
		jmp	loc_402EE1
; ---------------------------------------------------------------------------

loc_402D07:				; CODE XREF: sub_4027DD+516j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 4
		mov	[eax+1Ch], dl
		jmp	loc_402EE1
; ---------------------------------------------------------------------------

loc_402D19:				; CODE XREF: sub_4027DD+510j
		mov	[esp+0A28h+Format], offset aCheckCert ;	"check-cert"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_402D5C
		cmp	[ebp+var_C], 0
		jz	short loc_402D4A
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFF7h
		mov	[eax+1Ch], dl
		jmp	loc_402EE1
; ---------------------------------------------------------------------------

loc_402D4A:				; CODE XREF: sub_4027DD+559j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax+1Ch]
		or	edx, 8
		mov	[eax+1Ch], dl
		jmp	loc_402EE1
; ---------------------------------------------------------------------------

loc_402D5C:				; CODE XREF: sub_4027DD+553j
		mov	[esp+0A28h+MaxCount], 5	; MaxCount
		mov	[esp+0A28h+Format], offset aDebug ; "debug"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_402DDA
		cmp	[ebp+var_C], 0
		jz	short loc_402D92
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+24h], 0
		jmp	loc_402EE1
; ---------------------------------------------------------------------------

loc_402D92:				; CODE XREF: sub_4027DD+5A4j
		mov	eax, [ebp+var_10]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_402DBA
		mov	eax, [ebp+var_10]
		add	eax, 6
		mov	[esp+0A28h+Src], eax ; Str
		call	atoi
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+24h], edx
		jmp	loc_402EE1
; ---------------------------------------------------------------------------

loc_402DBA:				; CODE XREF: sub_4027DD+5C0j
		mov	eax, [ebp+var_10]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_402EE1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+24h], 1
		jmp	loc_402EE1
; ---------------------------------------------------------------------------

loc_402DDA:				; CODE XREF: sub_4027DD+59Ej
		mov	[esp+0A28h+MaxCount], 7	; MaxCount
		mov	[esp+0A28h+Format], offset aTimeout ; "timeout"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_402E58
		cmp	[ebp+var_C], 0
		jz	short loc_402E10
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+28h], 0
		jmp	loc_402EE1
; ---------------------------------------------------------------------------

loc_402E10:				; CODE XREF: sub_4027DD+622j
		mov	eax, [ebp+var_10]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_402E38
		mov	eax, [ebp+var_10]
		add	eax, 8
		mov	[esp+0A28h+Src], eax ; Str
		call	atoi
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+28h], edx
		jmp	loc_402EE1
; ---------------------------------------------------------------------------

loc_402E38:				; CODE XREF: sub_4027DD+63Ej
		mov	eax, [ebp+var_10]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_402EE1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+28h], 78h
		jmp	loc_402EE1
; ---------------------------------------------------------------------------

loc_402E58:				; CODE XREF: sub_4027DD+61Cj
		mov	[esp+0A28h+MaxCount], 0Ch ; MaxCount
		mov	[esp+0A28h+Format], offset aCaCertFile ; "ca-cert-file"
		mov	eax, [ebp+var_10]
		mov	[esp+0A28h+Src], eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_402EE1
		cmp	[ebp+var_C], 0
		jz	short loc_402E99
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+2Ch]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax+2Ch], 0
		jmp	short loc_402EE1
; ---------------------------------------------------------------------------

loc_402E99:				; CODE XREF: sub_4027DD+6A0j
		mov	eax, [ebp+var_10]
		add	eax, 0Ch
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_402EE1
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+2Ch]
		mov	[esp+0A28h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+var_10]
		add	eax, 0Dh
		mov	[esp+0A28h+Format], 0
		mov	[esp+0A28h+Src], eax
		call	sub_404313
		mov	edx, [ebp+arg_4]
		mov	[edx+2Ch], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+2Ch]
		test	eax, eax
		jnz	short loc_402EE1
		mov	eax, 5
		jmp	short locret_402EE6
; ---------------------------------------------------------------------------

loc_402EE1:				; CODE XREF: sub_4027DD+3ADj
					; sub_4027DD+432j ...
		mov	eax, 0FFFFFFFFh

locret_402EE6:				; CODE XREF: sub_4027DD+18j
					; sub_4027DD+D8j ...
		leave
		retn
sub_4027DD	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 4 ; switch 5	cases
		ja	short loc_402F23 ; jumptable 00402EFE default case
		mov	eax, [ebp+8]
		shl	eax, 2
		add	eax, offset off_40C550
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_402F00:				; CODE XREF: .text:00402EFEj
					; DATA XREF: .rdata:off_40C550o
		mov	eax, offset aUnknown ; jumptable 00402EFE case 0
		jmp	short loc_402F28
; ---------------------------------------------------------------------------

loc_402F07:				; CODE XREF: .text:00402EFEj
					; DATA XREF: .rdata:off_40C550o
		mov	eax, offset aGet_0 ; jumptable 00402EFE	case 1
		jmp	short loc_402F28
; ---------------------------------------------------------------------------

loc_402F0E:				; CODE XREF: .text:00402EFEj
					; DATA XREF: .rdata:off_40C550o
		mov	eax, offset aGetname_0 ; jumptable 00402EFE case 2
		jmp	short loc_402F28
; ---------------------------------------------------------------------------

loc_402F15:				; CODE XREF: .text:00402EFEj
					; DATA XREF: .rdata:off_40C550o
		mov	eax, offset aSend_0 ; jumptable	00402EFE case 3
		jmp	short loc_402F28
; ---------------------------------------------------------------------------

loc_402F1C:				; CODE XREF: .text:00402EFEj
					; DATA XREF: .rdata:off_40C550o
		mov	eax, offset aSearch_0 ;	jumptable 00402EFE case	4
		jmp	short loc_402F28
; ---------------------------------------------------------------------------

loc_402F23:				; CODE XREF: .text:00402EEFj
		mov	eax, offset a?	; jumptable 00402EFE default case

loc_402F28:				; CODE XREF: .text:00402F05j
					; .text:00402F0Cj ...
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		jmp	short loc_402F58
; ---------------------------------------------------------------------------

loc_402F32:				; CODE XREF: .text:00402F60j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_402F54
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	fputc

loc_402F54:				; CODE XREF: .text:00402F3Aj
		add	dword ptr [ebp+0Ch], 1

loc_402F58:				; CODE XREF: .text:00402F30j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_402F32
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	eax, [eax]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 2Ah	; switch 23 cases
		cmp	eax, 16h
		ja	loc_4030A2	; jumptable 00402F89 default case
		mov	eax, ds:off_40C57C[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_402F8B:				; CODE XREF: .text:00402F89j
					; DATA XREF: .rdata:off_40C57Co
		mov	eax, [ebp+8]	; jumptable 00402F89 case 42
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	eax, 0
		jmp	loc_4030A7
; ---------------------------------------------------------------------------

loc_402FA2:				; CODE XREF: .text:00402F89j
					; DATA XREF: .rdata:off_40C57Co
		mov	eax, [ebp+8]	; jumptable 00402F89 case 61
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	eax, 1
		jmp	loc_4030A7
; ---------------------------------------------------------------------------

loc_402FB9:				; CODE XREF: .text:00402F89j
					; DATA XREF: .rdata:off_40C57Co
		mov	eax, [ebp+8]	; jumptable 00402F89 case 60
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	eax, 2
		jmp	loc_4030A7
; ---------------------------------------------------------------------------

loc_402FD0:				; CODE XREF: .text:00402F89j
					; DATA XREF: .rdata:off_40C57Co
		mov	eax, [ebp+8]	; jumptable 00402F89 case 64
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	eax, 3
		jmp	loc_4030A7
; ---------------------------------------------------------------------------

loc_402FE7:				; CODE XREF: .text:00402F89j
					; DATA XREF: .rdata:off_40C57Co
		mov	eax, [ebp+8]	; jumptable 00402F89 case 48
		mov	eax, [eax]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 78h
		jnz	loc_4030A2	; jumptable 00402F89 default case
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 0Ah
		jnz	short loc_40304E
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	dword ptr [esp+4], offset aAbcdefabcdef12 ; "abcdefABCDEF1234567890x"
		mov	[esp], eax
		call	strspn
		cmp	eax, 0Ah
		jnz	short loc_40304E
		mov	eax, [ebp+8]
		mov	eax, [eax]
		lea	edx, [eax+2]
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	eax, 5
		jmp	short loc_4030A7
; ---------------------------------------------------------------------------

loc_40304E:				; CODE XREF: .text:0040301Ej
					; .text:00403038j
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 12h
		jnz	short loc_4030A2 ; jumptable 00402F89 default case
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	dword ptr [esp+4], offset aAbcdefabcdef12 ; "abcdefABCDEF1234567890x"
		mov	[esp], eax
		call	strspn
		cmp	eax, 12h
		jnz	short loc_4030A2 ; jumptable 00402F89 default case
		mov	eax, [ebp+8]
		mov	eax, [eax]
		lea	edx, [eax+2]
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	eax, 4
		jmp	short loc_4030A7
; ---------------------------------------------------------------------------

loc_4030A2:				; CODE XREF: .text:00402F7Cj
					; .text:00402F89j ...
		mov	eax, 0		; jumptable 00402F89 default case

loc_4030A7:				; CODE XREF: .text:00402F9Dj
					; .text:00402FB4j ...
		add	esp, 24h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4030AD	proc near		; CODE XREF: sub_4015C8+1FEp
					; sub_4015C8+2B0p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		cmp	eax, 1
		jz	short loc_4030D0
		cmp	eax, 1
		jb	short loc_4030C9
		cmp	eax, 7
		jz	short loc_4030D7
		cmp	eax, 13h
		jz	short loc_4030DE
		jmp	short loc_4030E5
; ---------------------------------------------------------------------------

loc_4030C9:				; CODE XREF: sub_4030AD+Ej
		mov	eax, 0
		jmp	short loc_4030EA
; ---------------------------------------------------------------------------

loc_4030D0:				; CODE XREF: sub_4030AD+9j
		mov	eax, 7Fh
		jmp	short loc_4030EA
; ---------------------------------------------------------------------------

loc_4030D7:				; CODE XREF: sub_4030AD+13j
		mov	eax, 9
		jmp	short loc_4030EA
; ---------------------------------------------------------------------------

loc_4030DE:				; CODE XREF: sub_4030AD+18j
		mov	eax, 6
		jmp	short loc_4030EA
; ---------------------------------------------------------------------------

loc_4030E5:				; CODE XREF: sub_4030AD+1Aj
		mov	eax, 1

loc_4030EA:				; CODE XREF: sub_4030AD+21j
					; sub_4030AD+28j ...
		pop	ebp
		retn
sub_4030AD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4030EC	proc near		; CODE XREF: sub_403281+ACp

var_28		= dword	ptr -28h
File		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	loc_403273
; ---------------------------------------------------------------------------

loc_403104:				; CODE XREF: sub_4030EC+57j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		mov	ecx, [ebp+arg_0]
		add	edx, ecx
		movzx	ecx, byte ptr [edx]
		mov	edx, [ebp+var_10]
		mov	[edx+eax+8], cl
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		add	[ebp+var_C], 1
		jmp	short loc_403132
; ---------------------------------------------------------------------------

loc_403131:				; CODE XREF: sub_4030EC+18Dj
		nop

loc_403132:				; CODE XREF: sub_4030EC+43j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		cmp	eax, 2
		jg	short loc_403145
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_4]
		jb	short loc_403104

loc_403145:				; CODE XREF: sub_4030EC+4Fj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		cmp	eax, 3
		jnz	loc_403273
		mov	eax, [ebp+var_10]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+8]
		shr	al, 2
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, ds:byte_40C5D8[eax]
		movsx	eax, al
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	fputc
		mov	eax, [ebp+var_10]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+8]
		movzx	eax, al
		shl	eax, 4
		mov	ecx, eax
		and	ecx, 30h
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+9]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		or	eax, ecx
		and	eax, 3Fh
		movzx	eax, ds:byte_40C5D8[eax]
		movsx	eax, al
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	fputc
		mov	eax, [ebp+var_10]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+9]
		movzx	eax, al
		shl	eax, 2
		mov	ecx, eax
		and	ecx, 3Ch
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+0Ah]
		shr	al, 6
		movzx	eax, al
		and	eax, 3
		or	eax, ecx
		and	eax, 3Fh
		movzx	eax, ds:byte_40C5D8[eax]
		movsx	eax, al
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	fputc
		mov	eax, [ebp+var_10]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+0Ah]
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, ds:byte_40C5D8[eax]
		movsx	eax, al
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	fputc
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		lea	edx, [eax+4]
		mov	eax, [ebp+var_10]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	eax, 45h
		jle	short loc_403269
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 0Ah ;	Ch
		call	fputc
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+10h], 0

loc_403269:				; CODE XREF: sub_4030EC+15Bj
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+4], 0

loc_403273:				; CODE XREF: sub_4030EC+13j
					; sub_4030EC+62j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_4]
		jb	loc_403131
		leave
		retn
sub_4030EC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403281	proc near		; DATA XREF: sub_4015C8+13Eo

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		and	eax, 1
		test	al, al
		jnz	short loc_403308
		mov	eax, [ebp+arg_4]
		imul	eax, [ebp+arg_8]
		test	eax, eax
		jnz	short loc_4032B5
		mov	eax, 0
		jmp	locret_40345B
; ---------------------------------------------------------------------------

loc_4032B5:				; CODE XREF: sub_403281+28j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_4032F3
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		or	edx, 8
		mov	[eax], dl
		mov	eax, [ebp+var_10]
		mov	edx, [eax+18h]
		mov	eax, offset aBeginPgpPublic ; "-----BEGIN PGP PUBLIC KEY BLOCK-----\n\"...
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 26h ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		jmp	short loc_4032FD
; ---------------------------------------------------------------------------

loc_4032F3:				; CODE XREF: sub_403281+3Cj
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+14h], offset aBeginPgpPubl_0 ; "-----BEGIN PGP PUBLIC KEY BLOCK-----"

loc_4032FD:				; CODE XREF: sub_403281+70j
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		or	edx, 1
		mov	[eax], dl

loc_403308:				; CODE XREF: sub_403281+1Dj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		and	eax, 8
		test	al, al
		jz	short loc_403337
		mov	eax, [ebp+arg_4]
		imul	eax, [ebp+arg_8]
		mov	edx, [ebp+arg_C]
		mov	[esp+28h+Count], edx
		mov	[esp+28h+Size],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_4030EC
		jmp	loc_403454
; ---------------------------------------------------------------------------

loc_403337:				; CODE XREF: sub_403281+92j
		mov	[ebp+var_C], 0
		jmp	loc_403437
; ---------------------------------------------------------------------------

loc_403343:				; CODE XREF: sub_403281+1CDj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	eax, edx
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		add	eax, ecx
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jnz	loc_4033ED
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_10]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_10]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4033F7
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		and	eax, 2
		test	al, al
		jz	short loc_4033A5
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		or	edx, 4
		mov	[eax], dl
		jmp	short loc_4033F7
; ---------------------------------------------------------------------------

loc_4033A5:				; CODE XREF: sub_403281+115j
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		or	edx, 2
		mov	[eax], dl
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+14h], offset aEndPgpPublicKe ; "-----END	PGP PUBLIC KEY BLOCK-----"
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_10]
		mov	edx, [eax+18h]
		mov	eax, offset aBeginPgpPubl_0 ; "-----BEGIN PGP PUBLIC KEY BLOCK-----"
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 24h ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		jmp	short loc_403433
; ---------------------------------------------------------------------------

loc_4033ED:				; CODE XREF: sub_403281+E0j
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+0Ch], 0

loc_4033F7:				; CODE XREF: sub_403281+108j
					; sub_403281+122j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		and	eax, 2
		test	al, al
		jz	short loc_403433
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_403433
		mov	eax, [ebp+var_10]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+var_14]
		add	eax, ecx
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Size],	edx ; File
		mov	[esp+28h+Str], eax ; Ch
		call	fputc

loc_403433:				; CODE XREF: sub_403281+16Aj
					; sub_403281+181j ...
		add	[ebp+var_C], 1

loc_403437:				; CODE XREF: sub_403281+BDj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		and	eax, 4
		test	al, al
		jnz	short loc_403454
		mov	eax, [ebp+arg_4]
		imul	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		ja	loc_403343

loc_403454:				; CODE XREF: sub_403281+B1j
					; sub_403281+1C1j
		mov	eax, [ebp+arg_4]
		imul	eax, [ebp+arg_8]

locret_40345B:				; CODE XREF: sub_403281+2Fj
		leave
		retn
sub_403281	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40345D	proc near		; CODE XREF: sub_4015C8+233p

Str		= dword	ptr -18h
File		= dword	ptr -14h
Count		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 8
		test	al, al
		jz	locret_4035FE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	eax, 2
		jnz	loc_403539
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+8]
		shr	al, 2
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, ds:byte_40C5D8[eax]
		movsx	eax, al
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Str], eax ; Ch
		call	fputc
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+8]
		movzx	eax, al
		shl	eax, 4
		mov	ecx, eax
		and	ecx, 30h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+9]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		or	eax, ecx
		and	eax, 3Fh
		movzx	eax, ds:byte_40C5D8[eax]
		movsx	eax, al
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Str], eax ; Ch
		call	fputc
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+9]
		movzx	eax, al
		shl	eax, 2
		and	eax, 3Ch
		movzx	eax, ds:byte_40C5D8[eax]
		movsx	eax, al
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Str], eax ; Ch
		call	fputc
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[esp+18h+File],	eax ; File
		mov	[esp+18h+Str], 3Dh ; Ch
		call	fputc
		jmp	loc_4035CC
; ---------------------------------------------------------------------------

loc_403539:				; CODE XREF: sub_40345D+20j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	eax, 1
		jnz	loc_4035CC
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+8]
		shr	al, 2
		movzx	eax, al
		and	eax, 3Fh
		movzx	eax, ds:byte_40C5D8[eax]
		movsx	eax, al
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Str], eax ; Ch
		call	fputc
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+8]
		movzx	eax, al
		shl	eax, 4
		and	eax, 30h
		movzx	eax, ds:byte_40C5D8[eax]
		movsx	eax, al
		mov	[esp+18h+File],	edx ; File
		mov	[esp+18h+Str], eax ; Ch
		call	fputc
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[esp+18h+File],	eax ; File
		mov	[esp+18h+Str], 3Dh ; Ch
		call	fputc
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		mov	[esp+18h+File],	eax ; File
		mov	[esp+18h+Str], 3Dh ; Ch
		call	fputc

loc_4035CC:				; CODE XREF: sub_40345D+D7j
					; sub_40345D+E5j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, offset aEndPgpPublic_0 ; "\n-----END PGP PUBLIC KEY BLOCK-----"
		mov	[esp+18h+var_C], edx ; File
		mov	[esp+18h+Count], 23h ; Count
		mov	[esp+18h+File],	1 ; Size
		mov	[esp+18h+Str], eax ; Str
		call	fwrite
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		or	edx, 4
		mov	[eax], dl

locret_4035FE:				; CODE XREF: sub_40345D+11j
		leave
		retn
sub_40345D	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40362E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40362E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_403685
; ---------------------------------------------------------------------------

loc_40362E:				; CODE XREF: .text:0040360Ej
					; .text:00403618j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_403656
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_403656
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_403685
; ---------------------------------------------------------------------------

loc_403656:				; CODE XREF: .text:00403636j
					; .text:00403640j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_40367E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_40367E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_403685
; ---------------------------------------------------------------------------

loc_40367E:				; CODE XREF: .text:0040365Ej
					; .text:00403668j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_403702
; ---------------------------------------------------------------------------

loc_403685:				; CODE XREF: .text:0040362Cj
					; .text:00403654j ...
		add	dword ptr [ebp+8], 1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4036AE
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4036AE
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	[ebp-4], eax
		jmp	short loc_4036FF
; ---------------------------------------------------------------------------

loc_4036AE:				; CODE XREF: .text:00403691j
					; .text:0040369Bj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_4036D3
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4036D3
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		add	[ebp-4], eax
		jmp	short loc_4036FF
; ---------------------------------------------------------------------------

loc_4036D3:				; CODE XREF: .text:004036B6j
					; .text:004036C0j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_4036F8
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_4036F8
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		add	[ebp-4], eax
		jmp	short loc_4036FF
; ---------------------------------------------------------------------------

loc_4036F8:				; CODE XREF: .text:004036DBj
					; .text:004036E5j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_403702
; ---------------------------------------------------------------------------

loc_4036FF:				; CODE XREF: .text:004036ACj
					; .text:004036D1j ...
		mov	eax, [ebp-4]

locret_403702:				; CODE XREF: .text:00403683j
					; .text:004036FDj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403704	proc near		; CODE XREF: .text:00403751p
					; .text:00403764p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 60h
		jle	short loc_403717
		cmp	[ebp+arg_0], 7Ah
		jg	short loc_403717
		and	[ebp+arg_0], 0FFFFFFDFh

loc_403717:				; CODE XREF: sub_403704+7j
					; sub_403704+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_403704	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 4
		mov	eax, [ebp+8]
		cmp	eax, [ebp+0Ch]
		jnz	short loc_403777
		mov	eax, 0
		jmp	loc_4037D0
; ---------------------------------------------------------------------------

loc_403735:				; CODE XREF: .text:0040378Aj
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_40376D
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp], eax
		call	sub_403704
		mov	ebx, eax
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp], eax
		call	sub_403704
		cmp	ebx, eax
		jnz	short loc_40378E

loc_40376D:				; CODE XREF: .text:00403743j
		add	dword ptr [ebp+8], 1
		add	dword ptr [ebp+0Ch], 1
		jmp	short loc_403778
; ---------------------------------------------------------------------------

loc_403777:				; CODE XREF: .text:00403729j
		nop

loc_403778:				; CODE XREF: .text:00403775j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40378F
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_403735
		jmp	short loc_40378F
; ---------------------------------------------------------------------------

loc_40378E:				; CODE XREF: .text:0040376Bj
		nop

loc_40378F:				; CODE XREF: .text:00403780j
					; .text:0040378Cj
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4037CB
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp], eax
		call	sub_403704
		mov	ebx, eax
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp], eax
		call	sub_403704
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_4037D0
; ---------------------------------------------------------------------------

loc_4037CB:				; CODE XREF: .text:0040379Dj
		mov	eax, 0

loc_4037D0:				; CODE XREF: .text:00403730j
					; .text:004037C9j
		add	esp, 4
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_4037D8	proc near		; CODE XREF: sub_40382C+1Ap
					; .text:004038E0p ...

File		= dword	ptr -18h
Format		= dword	ptr -14h
var_10		= dword	ptr -10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+18h+File],	eax ; int
		call	strerror
		mov	edx, offset aErrorAllocatin ; "error allocating	enough memory: %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+18h+var_10], eax
		mov	[esp+18h+Format], edx ;	Format
		mov	[esp+18h+File],	ecx ; File
		call	fprintf
		mov	[esp+18h+File],	2 ; Code
		call	exit
sub_4037D8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403819(size_t)
sub_403819	proc near		; CODE XREF: sub_403F7E+29Ap
					; sub_404FF5+A5p ...

Size		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Size],	eax ; Size
		call	malloc
		leave
		retn
sub_403819	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40382C(size_t)
sub_40382C	proc near		; CODE XREF: .text:00403BC8p
					; .text:00403F3Dp ...

Size		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40384B
		call	sub_4037D8
; ---------------------------------------------------------------------------

loc_40384B:				; CODE XREF: sub_40382C+18j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40382C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403850(char *)
sub_403850	proc near		; CODE XREF: sub_403F7E+1B9p
					; .text:0040537Ep

Size		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
Dest		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jz	short loc_40389C
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax ;	Source
		mov	eax, [ebp+Dest]
		mov	[esp+38h+Size],	eax ; Dest
		call	strcpy

loc_40389C:				; CODE XREF: sub_403850+38j
		mov	eax, [ebp+Dest]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_403850	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	realloc
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	realloc
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4038E5
		call	sub_4037D8
; ---------------------------------------------------------------------------

loc_4038E5:				; CODE XREF: .text:004038DEj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4038EA(size_t, size_t)
sub_4038EA	proc near		; CODE XREF: sub_407952+188p
					; sub_407952+2DEp

NumOfElements	= dword	ptr -18h
SizeOfElements	= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+SizeOfElements], eax ;	SizeOfElements
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+NumOfElements], eax ; NumOfElements
		call	calloc
		leave
		retn
sub_4038EA	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	calloc
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40392A
		call	sub_4037D8
; ---------------------------------------------------------------------------

loc_40392A:				; CODE XREF: .text:00403923j
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40392F(char *)
sub_40392F	proc near		; CODE XREF: .text:00403EA6p
					; .text:00403EB6p ...

Size		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
Dest		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jnz	short loc_40396E
		call	sub_4037D8
; ---------------------------------------------------------------------------

loc_40396E:				; CODE XREF: sub_40392F+38j
		mov	eax, [ebp+Dest]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Size],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+Dest]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_40392F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403989(void *)
sub_403989	proc near		; CODE XREF: sub_403F7E+23Fp
					; sub_403F7E+2AEp ...

Memory		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_4039A0
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

locret_4039A0:				; CODE XREF: sub_403989+Aj
		leave
		retn
sub_403989	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4039A4(char *)
sub_4039A4	proc near		; CODE XREF: sub_403F7E+356p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+Val], 5Ch ; Val
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_4039E7
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		jmp	short loc_4039DD
; ---------------------------------------------------------------------------

loc_4039C9:				; CODE XREF: sub_4039A4+41j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4039D9
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	5Ch

loc_4039D9:				; CODE XREF: sub_4039A4+2Dj
		add	[ebp+var_C], 1

loc_4039DD:				; CODE XREF: sub_4039A4+23j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4039C9

loc_4039E7:				; CODE XREF: sub_4039A4+1Bj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_4039A4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_403ABD
; ---------------------------------------------------------------------------

loc_403A10:				; CODE XREF: .text:00403AC1j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jnz	short loc_403AB5
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_403A62
; ---------------------------------------------------------------------------

loc_403A56:				; CODE XREF: .text:00403A92j
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_403A62:				; CODE XREF: .text:00403A54j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_403A94
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_403A56

loc_403A94:				; CODE XREF: .text:00403A66j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_403AA3
		mov	eax, [ebp-18h]
		jmp	short loc_403ACC
; ---------------------------------------------------------------------------

loc_403AA3:				; CODE XREF: .text:00403A9Cj
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_403AB5:				; CODE XREF: .text:00403A3Aj
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_403ABD:				; CODE XREF: .text:00403A0Bj
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_403A10
		mov	eax, 0

loc_403ACC:				; CODE XREF: .text:00403AA1j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_403B9B
; ---------------------------------------------------------------------------

loc_403AF6:				; CODE XREF: .text:00403B9Fj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_404BB5
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_404BB5
		cmp	ebx, eax
		jnz	short loc_403B93
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_403B44
; ---------------------------------------------------------------------------

loc_403B38:				; CODE XREF: .text:00403B70j
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_403B44:				; CODE XREF: .text:00403B36j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_403B72
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_404BB5
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_404BB5
		cmp	ebx, eax
		jz	short loc_403B38

loc_403B72:				; CODE XREF: .text:00403B48j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_403B81
		mov	eax, [ebp-18h]
		jmp	short loc_403BAA
; ---------------------------------------------------------------------------

loc_403B81:				; CODE XREF: .text:00403B7Aj
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_403B93:				; CODE XREF: .text:00403B1Cj
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_403B9B:				; CODE XREF: .text:00403AF1j
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_403AF6
		mov	eax, 0

loc_403BAA:				; CODE XREF: .text:00403B7Fj
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_403C0F
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_403BD0
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_40382C
		mov	[ebp+8], eax

loc_403BD0:				; CODE XREF: .text:00403BC0j
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		sub	dword ptr [ebp+10h], 1
		jmp	short loc_403BF9
; ---------------------------------------------------------------------------

loc_403BE2:				; CODE XREF: .text:00403C07j
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp+10h], 1

loc_403BF9:				; CODE XREF: .text:00403BE0j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_403C09
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_403BE2

loc_403C09:				; CODE XREF: .text:00403BFDj
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0

loc_403C0F:				; CODE XREF: .text:00403BBAj
		mov	eax, [ebp+8]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax
		jmp	short loc_403C2C
; ---------------------------------------------------------------------------

loc_403C28:				; CODE XREF: .text:00403C4Bj
		add	dword ptr [ebp-10h], 1

loc_403C2C:				; CODE XREF: .text:00403C26j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_403C4D
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_403C28

loc_403C4D:				; CODE XREF: .text:00403C34j
		mov	dword ptr [ebp-14h], 0
		jmp	short loc_403C8A
; ---------------------------------------------------------------------------

loc_403C56:				; CODE XREF: .text:00403C9Dj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_403C7B
		cmp	dword ptr [ebp-14h], 0
		jnz	short loc_403C82
		mov	eax, [ebp-0Ch]
		mov	[ebp-14h], eax
		jmp	short loc_403C82
; ---------------------------------------------------------------------------

loc_403C7B:				; CODE XREF: .text:00403C6Bj
		mov	dword ptr [ebp-14h], 0

loc_403C82:				; CODE XREF: .text:00403C71j
					; .text:00403C79j
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1

loc_403C8A:				; CODE XREF: .text:00403C54j
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_403C56
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_403CAB
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	0

loc_403CAB:				; CODE XREF: .text:00403CA3j
		mov	eax, [ebp+8]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_403CF5
; ---------------------------------------------------------------------------

loc_403CC5:				; CODE XREF: .text:00403CFDj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_403CEA
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_403CF1
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax
		jmp	short loc_403CF1
; ---------------------------------------------------------------------------

loc_403CEA:				; CODE XREF: .text:00403CDAj
		mov	dword ptr [ebp-10h], 0

loc_403CF1:				; CODE XREF: .text:00403CE0j
					; .text:00403CE8j
		add	dword ptr [ebp-0Ch], 1

loc_403CF5:				; CODE XREF: .text:00403CC3j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_403CC5
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_403D0B
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	0

loc_403D0B:				; CODE XREF: .text:00403D03j
		mov	eax, [ebp+8]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403D10(int, int, char	*)
sub_403D10	proc near		; CODE XREF: .text:00403DA7p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_403D65
; ---------------------------------------------------------------------------

loc_403D2C:				; CODE XREF: sub_403D10+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_403D56
		cmp	[ebp+var_10], 0
		jnz	short loc_403D5D
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_403D5D
; ---------------------------------------------------------------------------

loc_403D56:				; CODE XREF: sub_403D10+36j
		mov	[ebp+var_10], 0

loc_403D5D:				; CODE XREF: sub_403D10+3Cj
					; sub_403D10+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_403D65:				; CODE XREF: sub_403D10+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_403D2C
		cmp	[ebp+var_10], 0
		jz	short loc_403D87
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_403D8A
; ---------------------------------------------------------------------------

loc_403D87:				; CODE XREF: sub_403D10+61j
		mov	eax, [ebp+arg_4]

locret_403D8A:				; CODE XREF: sub_403D10+75j
		leave
		retn
sub_403D10	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_40C6D8 ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_403D10
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403DAE(int, int, char	*)
sub_403DAE	proc near		; CODE XREF: .text:00403E3Fp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_403E03
; ---------------------------------------------------------------------------

loc_403DCA:				; CODE XREF: sub_403DAE+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_403DF4
		cmp	[ebp+var_10], 0
		jnz	short loc_403DFB
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_403DFB
; ---------------------------------------------------------------------------

loc_403DF4:				; CODE XREF: sub_403DAE+36j
		mov	[ebp+var_10], 0

loc_403DFB:				; CODE XREF: sub_403DAE+3Cj
					; sub_403DAE+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_403E03:				; CODE XREF: sub_403DAE+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_403DCA
		cmp	[ebp+var_10], 0
		jz	short loc_403E1F
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_403E22
; ---------------------------------------------------------------------------

loc_403E1F:				; CODE XREF: sub_403DAE+61j
		mov	eax, [ebp+arg_4]

locret_403E22:				; CODE XREF: sub_403DAE+6Fj
		leave
		retn
sub_403DAE	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_40C6D8 ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_403DAE
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_403EAD
		mov	dword ptr [esp+4], 5Ch
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_403EAD
		mov	dword ptr [esp+4], 3Ah
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_403EAD
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40392F
		jmp	short locret_403EBB
; ---------------------------------------------------------------------------

loc_403EAD:				; CODE XREF: .text:00403E66j
					; .text:00403E82j ...
		mov	eax, [ebp-0Ch]
		add	eax, 1
		mov	[esp], eax
		call	sub_40392F

locret_403EBB:				; CODE XREF: .text:00403EABj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_403F25
		mov	dword ptr [esp+4], 5Ch
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_403F25
		mov	dword ptr [esp+4], 3Ah
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_403F25
		mov	dword ptr [esp], offset	a_ ; "."
		call	sub_40392F
		jmp	short locret_403F6A
; ---------------------------------------------------------------------------

loc_403F25:				; CODE XREF: .text:00403EDDj
					; .text:00403EF9j ...
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[esp], eax
		call	sub_40382C
		mov	[ebp-14h], eax
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	strncpy
		mov	eax, [ebp-10h]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-14h]

locret_403F6A:				; CODE XREF: .text:00403F23j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403F6C	proc near		; CODE XREF: sub_403F7E+144p
					; sub_403F7E+22Bp

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		mov	eax, [ebp+var_4]
		leave
		retn
sub_403F6C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403F7E	proc near		; CODE XREF: .text:00404306p
					; sub_404313+23p

VarName		= dword	ptr -0C8h
Val		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
Str		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0C0h
		mov	[ebp+var_14], 1
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_404045
; ---------------------------------------------------------------------------

loc_403FCB:				; CODE XREF: sub_403F7E+E8j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_10]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		cmp	eax, 1Eh
		jbe	short loc_404041
		cmp	[ebp+arg_0], 0
		jz	short loc_40402A
		mov	[esp+0C8h+var_C0], offset aDo_make_filena ; "do_make_filename"
		mov	[esp+0C8h+Val],	176h
		mov	[esp+0C8h+VarName], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/jnlib/stringhelp.c"
		call	sub_405E3C
; ---------------------------------------------------------------------------

loc_40402A:				; CODE XREF: sub_403F7E+8Ej
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	loc_4042D9
; ---------------------------------------------------------------------------

loc_404041:				; CODE XREF: sub_403F7E+88j
		add	[ebp+var_C], 1

loc_404045:				; CODE XREF: sub_403F7E+4Bj
		mov	eax, [ebp+arg_8]
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_A8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		test	eax, eax
		jnz	loc_403FCB
		add	[ebp+var_10], 1
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Eh
		jnz	loc_4041FC
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jz	short loc_40409F
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_404115

loc_40409F:				; CODE XREF: sub_403F7E+112j
		mov	[esp+0C8h+VarName], offset VarName ; "HOME"
		call	getenv
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_4040D0
		mov	[esp+0C8h+Val],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+VarName], eax
		call	sub_403F6C
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_20], eax

loc_4040D0:				; CODE XREF: sub_403F7E+134j
		cmp	[ebp+var_20], 0
		jz	loc_4041FB
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_4041FB
		mov	eax, [ebp+var_20]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		jmp	loc_4041FB
; ---------------------------------------------------------------------------

loc_404115:				; CODE XREF: sub_403F7E+11Fj
		cmp	[ebp+arg_0], 0
		jz	short loc_40412E
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+0C8h+VarName], eax	; char *
		call	sub_40392F
		mov	[ebp+Str], eax
		jmp	short loc_40414F
; ---------------------------------------------------------------------------

loc_40412E:				; CODE XREF: sub_403F7E+19Bj
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+0C8h+VarName], eax	; char *
		call	sub_403850
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jnz	short loc_40414F
		mov	eax, 0
		jmp	loc_4042D9
; ---------------------------------------------------------------------------

loc_40414F:				; CODE XREF: sub_403F7E+1AEj
					; sub_403F7E+1C5j
		mov	[esp+0C8h+Val],	2Fh ; Val
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+VarName], eax	; Str
		call	strchr
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_404171
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0

loc_404171:				; CODE XREF: sub_403F7E+1EBj
		mov	eax, [ebp+Str]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+VarName], eax
		call	sub_403F6C
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+VarName], eax	; void *
		call	sub_403989
		cmp	[ebp+var_20], 0
		jz	short loc_4041F2
		mov	eax, [ebp+var_20]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		jmp	short loc_4041FC
; ---------------------------------------------------------------------------

loc_4041F2:				; CODE XREF: sub_403F7E+248j
		mov	[ebp+var_14], 1
		jmp	short loc_4041FC
; ---------------------------------------------------------------------------

loc_4041FB:				; CODE XREF: sub_403F7E+156j
					; sub_403F7E+164j ...
		nop

loc_4041FC:				; CODE XREF: sub_403F7E+101j
					; sub_403F7E+272j ...
		cmp	[ebp+arg_0], 0
		jz	short loc_404212
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+VarName], eax	; size_t
		call	sub_40382C
		mov	[ebp+var_1C], eax
		jmp	short loc_40423B
; ---------------------------------------------------------------------------

loc_404212:				; CODE XREF: sub_403F7E+282j
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+VarName], eax	; size_t
		call	sub_403819
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_40423B
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+VarName], eax	; void *
		call	sub_403989
		mov	eax, 0
		jmp	loc_4042D9
; ---------------------------------------------------------------------------

loc_40423B:				; CODE XREF: sub_403F7E+292j
					; sub_403F7E+2A6j
		cmp	[ebp+var_20], 0
		jz	short loc_40426C
		mov	eax, [ebp+var_14]
		mov	ebx, eax
		add	ebx, [ebp+arg_4]
		mov	eax, [ebp+var_20]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax
		call	sub_404EC1
		mov	[esp+0C8h+Val],	ebx
		mov	[esp+0C8h+VarName], eax
		call	sub_404EC1
		mov	[ebp+var_24], eax
		jmp	short loc_404281
; ---------------------------------------------------------------------------

loc_40426C:				; CODE XREF: sub_403F7E+2C1j
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax
		call	sub_404EC1
		mov	[ebp+var_24], eax

loc_404281:				; CODE XREF: sub_403F7E+2ECj
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+VarName], eax	; void *
		call	sub_403989
		mov	[ebp+var_C], 0
		jmp	short loc_4042C0
; ---------------------------------------------------------------------------

loc_404295:				; CODE XREF: sub_403F7E+34Ej
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		mov	edx, [ebp+var_24]
		mov	word ptr [edx],	2Fh
		mov	edx, [ebp+var_24]
		add	edx, 1
		mov	[esp+0C8h+Val],	eax
		mov	[esp+0C8h+VarName], edx
		call	sub_404EC1
		mov	[ebp+var_24], eax
		add	[ebp+var_C], 1

loc_4042C0:				; CODE XREF: sub_403F7E+315j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		test	eax, eax
		jnz	short loc_404295
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax	; char *
		call	sub_4039A4

loc_4042D9:				; CODE XREF: sub_403F7E+BEj
					; sub_403F7E+1CCj ...
		add	esp, 0C0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_403F7E	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 1
		call	sub_403F7E
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404313	proc near		; CODE XREF: sub_4027DD+6E8p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], 0
		call	sub_403F7E
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_404313	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		jmp	short loc_4043B8
; ---------------------------------------------------------------------------

loc_40434C:				; CODE XREF: .text:004043CAj
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4043B0
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_4043B0
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_40439C
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_4043B0

loc_40439C:				; CODE XREF: .text:00404390j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_4043CC
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4043CC

loc_4043B0:				; CODE XREF: .text:0040435Aj
					; .text:00404386j ...
		add	dword ptr [ebp+8], 1
		add	dword ptr [ebp+0Ch], 1

loc_4043B8:				; CODE XREF: .text:0040434Aj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4043CC
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40434C

loc_4043CC:				; CODE XREF: .text:004043A4j
					; .text:004043AEj ...
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4043E0
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_4043F4

loc_4043E0:				; CODE XREF: .text:004043D4j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_4043FB
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4043FB

loc_4043F4:				; CODE XREF: .text:004043DEj
		mov	eax, 0
		jmp	short loc_404429
; ---------------------------------------------------------------------------

loc_4043FB:				; CODE XREF: .text:004043E8j
					; .text:004043F2j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx

loc_404429:				; CODE XREF: .text:004043F9j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40445D
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40445D
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4044B4
; ---------------------------------------------------------------------------

loc_40445D:				; CODE XREF: .text:0040443Dj
					; .text:00404447j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_404485
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_404485
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4044B4
; ---------------------------------------------------------------------------

loc_404485:				; CODE XREF: .text:00404465j
					; .text:0040446Fj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_4044AD
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_4044AD
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4044B4
; ---------------------------------------------------------------------------

loc_4044AD:				; CODE XREF: .text:0040448Dj
					; .text:00404497j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_404531
; ---------------------------------------------------------------------------

loc_4044B4:				; CODE XREF: .text:0040445Bj
					; .text:00404483j ...
		add	dword ptr [ebp+8], 1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4044DD
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4044DD
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	[ebp-4], eax
		jmp	short loc_40452E
; ---------------------------------------------------------------------------

loc_4044DD:				; CODE XREF: .text:004044C0j
					; .text:004044CAj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_404502
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_404502
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		add	[ebp-4], eax
		jmp	short loc_40452E
; ---------------------------------------------------------------------------

loc_404502:				; CODE XREF: .text:004044E5j
					; .text:004044EFj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_404527
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_404527
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		add	[ebp-4], eax
		jmp	short loc_40452E
; ---------------------------------------------------------------------------

loc_404527:				; CODE XREF: .text:0040450Aj
					; .text:00404514j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_404531
; ---------------------------------------------------------------------------

loc_40452E:				; CODE XREF: .text:004044DBj
					; .text:00404500j ...
		mov	eax, [ebp-4]

locret_404531:				; CODE XREF: .text:004044B2j
					; .text:0040452Cj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404533(FILE *, int, int, int,	int)
sub_404533	proc near		; CODE XREF: sub_4046EC+29p
					; .text:00404829p

var_28		= dword	ptr -28h
File		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_4046DD
; ---------------------------------------------------------------------------

loc_40454B:				; CODE XREF: sub_404533+1AEj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_404599
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_404599
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_C]
		jz	short loc_404599
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_10]
		jz	short loc_404599
		cmp	[ebp+arg_C], 0
		jnz	short loc_40458B
		cmp	[ebp+arg_10], 0
		jz	loc_4046B5

loc_40458B:				; CODE XREF: sub_404533+4Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_4046B5

loc_404599:				; CODE XREF: sub_404533+20j
					; sub_404533+2Aj ...
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 5Ch ;	Ch
		call	putc
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_4045D6
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 6Eh ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_4046D1
; ---------------------------------------------------------------------------

loc_4045D6:				; CODE XREF: sub_404533+85j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_4045FC
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 72h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_4046D1
; ---------------------------------------------------------------------------

loc_4045FC:				; CODE XREF: sub_404533+ABj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_404622
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 66h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_4046D1
; ---------------------------------------------------------------------------

loc_404622:				; CODE XREF: sub_404533+D1j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_404648
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 76h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_4046D1
; ---------------------------------------------------------------------------

loc_404648:				; CODE XREF: sub_404533+F7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_40466B
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 62h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_4046D1
; ---------------------------------------------------------------------------

loc_40466B:				; CODE XREF: sub_404533+11Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40468E
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 30h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_4046D1
; ---------------------------------------------------------------------------

loc_40468E:				; CODE XREF: sub_404533+140j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x ; "x%02x"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+File],	eax ; Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	File
		call	fprintf
		add	[ebp+var_10], 3
		jmp	short loc_4046D1
; ---------------------------------------------------------------------------

loc_4046B5:				; CODE XREF: sub_404533+52j
					; sub_404533+60j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	putc
		add	[ebp+var_10], 1

loc_4046D1:				; CODE XREF: sub_404533+9Ej
					; sub_404533+C4j ...
		sub	[ebp+arg_8], 1
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_4046DD:				; CODE XREF: sub_404533+13j
		cmp	[ebp+arg_8], 0
		jnz	loc_40454B
		mov	eax, [ebp+var_10]
		leave
		retn
sub_404533	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4046EC(FILE *, int, int, int)
sub_4046EC	proc near		; CODE XREF: sub_40471C+B7p
					; .text:0040487Fp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_18], 0 ; int
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	FILE *
		call	sub_404533
		leave
		retn
sub_4046EC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40471C(FILE *, int, int, int)
sub_40471C	proc near		; CODE XREF: .text:004048D5p

Str		= dword	ptr -38h
File		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_404745
; ---------------------------------------------------------------------------

loc_404732:				; CODE XREF: sub_40471C+2Fj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_40474F
		add	[ebp+var_C], 1

loc_404745:				; CODE XREF: sub_40471C+14j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jb	short loc_404732
		jmp	short loc_404750
; ---------------------------------------------------------------------------

loc_40474F:				; CODE XREF: sub_40471C+23j
		nop

loc_404750:				; CODE XREF: sub_40471C+31j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jnb	short loc_4047B8
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+File],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax
		call	sub_406CA3
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Str], eax ; Str
		call	fputs
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax ; void *
		call	sub_403989
		mov	eax, [ebp+var_C]
		jmp	short loc_4047D8
; ---------------------------------------------------------------------------

loc_4047B8:				; CODE XREF: sub_40471C+3Aj
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+File],	eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; FILE *
		call	sub_4046EC

loc_4047D8:				; CODE XREF: sub_40471C+9Aj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_40471C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_404830
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+14h]
		mov	[esp+10h], eax
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_404533
		jmp	short loc_404835
; ---------------------------------------------------------------------------

loc_404830:				; CODE XREF: .text:004047E9j
		mov	eax, 0

loc_404835:				; CODE XREF: .text:0040482Ej
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_404886
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4046EC
		jmp	short loc_40488B
; ---------------------------------------------------------------------------

loc_404886:				; CODE XREF: .text:00404846j
		mov	eax, 0

loc_40488B:				; CODE XREF: .text:00404884j
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_4048DC
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40471C
		jmp	short loc_4048E1
; ---------------------------------------------------------------------------

loc_4048DC:				; CODE XREF: .text:0040489Cj
		mov	eax, 0

loc_4048E1:				; CODE XREF: .text:004048DAj
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-18h], eax
		mov	eax, [ebp-0Ch]
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-10h], 1
		jmp	loc_404991
; ---------------------------------------------------------------------------

loc_40490B:				; CODE XREF: .text:00404995j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_40493D
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_40493D
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+10h]
		jz	short loc_40493D
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_404985
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_404985

loc_40493D:				; CODE XREF: .text:00404913j
					; .text:0040491Dj ...
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_404979
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_404979
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jz	short loc_404979
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jz	short loc_404979
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jz	short loc_404979
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40497F

loc_404979:				; CODE XREF: .text:00404945j
					; .text:0040494Fj ...
		add	dword ptr [ebp-10h], 2
		jmp	short loc_404989
; ---------------------------------------------------------------------------

loc_40497F:				; CODE XREF: .text:00404977j
		add	dword ptr [ebp-10h], 5
		jmp	short loc_404989
; ---------------------------------------------------------------------------

loc_404985:				; CODE XREF: .text:00404931j
					; .text:0040493Bj
		add	dword ptr [ebp-10h], 1

loc_404989:				; CODE XREF: .text:0040497Dj
					; .text:00404983j
		sub	dword ptr [ebp+0Ch], 1
		add	dword ptr [ebp-0Ch], 1

loc_404991:				; CODE XREF: .text:00404906j
		cmp	dword ptr [ebp+0Ch], 0
		jnz	loc_40490B
		mov	eax, [ebp-1Ch]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-18h]
		mov	[ebp+0Ch], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_40382C
		mov	[ebp-20h], eax
		mov	eax, [ebp-20h]
		mov	[ebp-14h], eax
		jmp	loc_404ACE
; ---------------------------------------------------------------------------

loc_4049C0:				; CODE XREF: .text:00404AD2j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_4049FA
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_4049FA
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+10h]
		jz	short loc_4049FA
		cmp	dword ptr [ebp+10h], 0
		jz	loc_404AB5
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_404AB5

loc_4049FA:				; CODE XREF: .text:004049C8j
					; .text:004049D2j ...
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	5Ch
		add	dword ptr [ebp-14h], 1
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_404A1D
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	6Eh
		add	dword ptr [ebp-14h], 1
		jmp	loc_404AC6
; ---------------------------------------------------------------------------

loc_404A1D:				; CODE XREF: .text:00404A0Cj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_404A36
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	72h
		add	dword ptr [ebp-14h], 1
		jmp	loc_404AC6
; ---------------------------------------------------------------------------

loc_404A36:				; CODE XREF: .text:00404A25j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_404A4C
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	66h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_404AC6
; ---------------------------------------------------------------------------

loc_404A4C:				; CODE XREF: .text:00404A3Ej
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_404A62
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	76h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_404AC6
; ---------------------------------------------------------------------------

loc_404A62:				; CODE XREF: .text:00404A54j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_404A78
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	62h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_404AC6
; ---------------------------------------------------------------------------

loc_404A78:				; CODE XREF: .text:00404A6Aj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_404A8E
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	30h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_404AC6
; ---------------------------------------------------------------------------

loc_404A8E:				; CODE XREF: .text:00404A80j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x ; "x%02x"
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sprintf
		add	dword ptr [ebp-14h], 3
		jmp	short loc_404AC6
; ---------------------------------------------------------------------------

loc_404AB5:				; CODE XREF: .text:004049E6j
					; .text:004049F4j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp-14h]
		mov	[eax], dl
		add	dword ptr [ebp-14h], 1

loc_404AC6:				; CODE XREF: .text:00404A18j
					; .text:00404A31j ...
		sub	dword ptr [ebp+0Ch], 1
		add	dword ptr [ebp-0Ch], 1

loc_404ACE:				; CODE XREF: .text:004049BBj
		cmp	dword ptr [ebp+0Ch], 0
		jnz	loc_4049C0
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-20h]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	dword ptr [ebp-4], 0
		jmp	short loc_404B0F
; ---------------------------------------------------------------------------

loc_404AF2:				; CODE XREF: .text:00404B17j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0C0h
		cmp	eax, 80h
		jz	short loc_404B0B
		add	dword ptr [ebp-4], 1

loc_404B0B:				; CODE XREF: .text:00404B05j
		add	dword ptr [ebp+8], 1

loc_404B0F:				; CODE XREF: .text:00404AF0j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_404AF2
		mov	eax, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0FFFFFFFFh
		jnz	short loc_404B34
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+8], eax

loc_404B34:				; CODE XREF: .text:00404B28j
		mov	eax, [ebp+8]
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 0FFh
		mov	dword ptr [esp+10h], offset dword_40E200
		mov	dword ptr [esp+0Ch], 400h
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp], 1000h
		mov	eax, ds:FormatMessageA
		call	eax ; FormatMessageA
		sub	esp, 1Ch
		mov	eax, offset dword_40E200
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 40h
		jle	short loc_404B91
		cmp	dword ptr [ebp+8], 5Ah
		jg	short loc_404B91
		mov	eax, 1
		jmp	short loc_404B96
; ---------------------------------------------------------------------------

loc_404B91:				; CODE XREF: .text:00404B82j
					; .text:00404B88j
		mov	eax, 0

loc_404B96:				; CODE XREF: .text:00404B8Fj
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 60h
		jle	short loc_404BAE
		cmp	dword ptr [ebp+8], 7Ah
		jg	short loc_404BAE
		mov	eax, 1
		jmp	short loc_404BB3
; ---------------------------------------------------------------------------

loc_404BAE:				; CODE XREF: .text:00404B9Fj
					; .text:00404BA5j
		mov	eax, 0

loc_404BB3:				; CODE XREF: .text:00404BACj
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404BB5	proc near		; CODE XREF: .text:00403B02p
					; .text:00403B15p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 60h
		jle	short loc_404BC8
		cmp	[ebp+arg_0], 7Ah
		jg	short loc_404BC8
		and	[ebp+arg_0], 0FFFFFFDFh

loc_404BC8:				; CODE XREF: sub_404BB5+7j
					; sub_404BB5+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_404BB5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404BCD	proc near		; CODE XREF: .text:00404CD2p
					; .text:00404CE6p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 40h
		jle	short loc_404BE0
		cmp	[ebp+arg_0], 5Ah
		jg	short loc_404BE0
		or	[ebp+arg_0], 20h

loc_404BE0:				; CODE XREF: sub_404BCD+7j
					; sub_404BCD+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_404BCD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404BE5	proc near		; CODE XREF: .text:004060F6p
					; .text:0040610Dp ...

var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_404C40
		mov	eax, 0
		jmp	loc_404C99
; ---------------------------------------------------------------------------

loc_404BFE:				; CODE XREF: sub_404BE5+6Ej
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_404C36
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_404BB5
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_404BB5
		cmp	ebx, eax
		jnz	short loc_404C57

loc_404C36:				; CODE XREF: sub_404BE5+27j
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1
		jmp	short loc_404C41
; ---------------------------------------------------------------------------

loc_404C40:				; CODE XREF: sub_404BE5+Dj
		nop

loc_404C41:				; CODE XREF: sub_404BE5+59j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404C58
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_404BFE
		jmp	short loc_404C58
; ---------------------------------------------------------------------------

loc_404C57:				; CODE XREF: sub_404BE5+4Fj
		nop

loc_404C58:				; CODE XREF: sub_404BE5+64j
					; sub_404BE5+70j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_404C94
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_404BB5
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_404BB5
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_404C99
; ---------------------------------------------------------------------------

loc_404C94:				; CODE XREF: sub_404BE5+81j
		mov	eax, 0

loc_404C99:				; CODE XREF: sub_404BE5+14j
					; sub_404BE5+ADj
		add	esp, 4
		pop	ebx
		pop	ebp
		retn
sub_404BE5	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-8], eax
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jz	short loc_404CBF
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_404CC6

loc_404CBF:				; CODE XREF: .text:00404CB7j
		mov	eax, 0
		jmp	short locret_404D1D
; ---------------------------------------------------------------------------

loc_404CC6:				; CODE XREF: .text:00404CBDj
					; .text:00404D0Dj
		mov	eax, [ebp-4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_404BCD
		mov	[ebp-9], al
		mov	eax, [ebp-8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_404BCD
		mov	[ebp-0Ah], al
		sub	dword ptr [ebp+10h], 1
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_404D0F
		cmp	byte ptr [ebp-9], 0
		jz	short loc_404D0F
		add	dword ptr [ebp-4], 1
		add	dword ptr [ebp-8], 1
		movzx	eax, byte ptr [ebp-9]
		cmp	al, [ebp-0Ah]
		jz	short loc_404CC6

loc_404D0F:				; CODE XREF: .text:00404CF6j
					; .text:00404CFCj
		movzx	edx, byte ptr [ebp-9]
		movzx	eax, byte ptr [ebp-0Ah]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_404D1D:				; CODE XREF: .text:00404CC4j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404D1F	proc near		; CODE XREF: .text:00404EA0p
					; .text:004060B9p

var_18		= dword	ptr -18h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_C]
		jnz	loc_404DCF
		mov	eax, 0
		jmp	loc_404DDE
; ---------------------------------------------------------------------------

loc_404D48:				; CODE XREF: sub_404D1F+B4j
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_404DC3
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_404BB5
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_404BB5
		cmp	ebx, eax
		jz	short loc_404DC3
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_404DBC
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_404BB5
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_404BB5
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_404DC1
; ---------------------------------------------------------------------------

loc_404DBC:				; CODE XREF: sub_404D1F+6Fj
		mov	eax, 0

loc_404DC1:				; CODE XREF: sub_404D1F+9Bj
		jmp	short loc_404DDE
; ---------------------------------------------------------------------------

loc_404DC3:				; CODE XREF: sub_404D1F+37j
					; sub_404D1F+5Fj
		sub	[ebp+arg_8], 1
		add	[ebp+var_8], 1
		add	[ebp+var_C], 1

loc_404DCF:				; CODE XREF: sub_404D1F+19j
		cmp	[ebp+arg_8], 0
		jnz	loc_404D48
		mov	eax, 0

loc_404DDE:				; CODE XREF: sub_404D1F+24j
					; sub_404D1F:loc_404DC1j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_404D1F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		cmp	eax, [ebp+0Ch]
		jnz	short loc_404E10
		mov	eax, 0
		jmp	short loc_404E57
; ---------------------------------------------------------------------------

loc_404DF6:				; CODE XREF: .text:00404E23j
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jnz	short loc_404E27
		add	dword ptr [ebp+8], 1
		add	dword ptr [ebp+0Ch], 1
		jmp	short loc_404E11
; ---------------------------------------------------------------------------

loc_404E10:				; CODE XREF: .text:00404DEDj
		nop

loc_404E11:				; CODE XREF: .text:00404E0Ej
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404E28
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_404DF6
		jmp	short loc_404E28
; ---------------------------------------------------------------------------

loc_404E27:				; CODE XREF: .text:00404E04j
		nop

loc_404E28:				; CODE XREF: .text:00404E19j
					; .text:00404E25j
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_404E52
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short loc_404E57
; ---------------------------------------------------------------------------

loc_404E52:				; CODE XREF: .text:00404E36j
		mov	eax, 0

loc_404E57:				; CODE XREF: .text:00404DF4j
					; .text:00404E50j
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		cmp	dword ptr [ebp+14h], 0
		jnz	short loc_404E6A
		mov	eax, [ebp+8]
		jmp	short locret_404EBF
; ---------------------------------------------------------------------------

loc_404E6A:				; CODE XREF: .text:00404E63j
		mov	eax, [ebp+14h]
		cmp	eax, [ebp+0Ch]
		ja	short loc_404EBA
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+14h]
		mov	edx, [ebp+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, [ebp-4]
		mov	[ebp-8], eax
		jmp	short loc_404EB2
; ---------------------------------------------------------------------------

loc_404E8C:				; CODE XREF: .text:00404EB8j
		mov	eax, [ebp+14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-4]
		mov	[esp], eax
		call	sub_404D1F
		test	eax, eax
		jnz	short loc_404EAE
		mov	eax, [ebp-4]
		jmp	short locret_404EBF
; ---------------------------------------------------------------------------

loc_404EAE:				; CODE XREF: .text:00404EA7j
		add	dword ptr [ebp-4], 1

loc_404EB2:				; CODE XREF: .text:00404E8Aj
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jbe	short loc_404E8C

loc_404EBA:				; CODE XREF: .text:00404E70j
		mov	eax, 0

locret_404EBF:				; CODE XREF: .text:00404E68j
					; .text:00404EACj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404EC1	proc near		; CODE XREF: sub_403F7E+2D8p
					; sub_403F7E+2E4p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		jmp	short loc_404ED9
; ---------------------------------------------------------------------------

loc_404EC6:				; CODE XREF: sub_404EC1+20j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_404ED9:				; CODE XREF: sub_404EC1+3j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_404EC6
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_404EC1	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_404F0C
		mov	eax, 0
		jmp	locret_404FB7
; ---------------------------------------------------------------------------

loc_404F0C:				; CODE XREF: .text:00404F00j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404F23
		mov	eax, [ebp+0Ch]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_404F7C

loc_404F23:				; CODE XREF: .text:00404F14j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		mov	[ebp-11h], al
		cmp	byte ptr [ebp-11h], 0
		jnz	short loc_404F3B
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_404F91
; ---------------------------------------------------------------------------

loc_404F3B:				; CODE XREF: .text:00404F30j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, [ebp-11h]
		jnz	short loc_404F4E
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	short loc_404F91
; ---------------------------------------------------------------------------

loc_404F4E:				; CODE XREF: .text:00404F44j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_404F61
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_404F91
; ---------------------------------------------------------------------------

loc_404F61:				; CODE XREF: .text:00404F56j
		movsx	eax, byte ptr [ebp-11h]
		mov	edx, [ebp-10h]
		add	edx, 1
		mov	[esp+4], eax
		mov	[esp], edx
		call	strchr
		mov	[ebp-0Ch], eax
		jmp	short loc_404F91
; ---------------------------------------------------------------------------

loc_404F7C:				; CODE XREF: .text:00404F21j
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	strpbrk
		mov	[ebp-0Ch], eax

loc_404F91:				; CODE XREF: .text:00404F39j
					; .text:00404F4Cj ...
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_404FAB
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp+8]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		jmp	short loc_404FB4
; ---------------------------------------------------------------------------

loc_404FAB:				; CODE XREF: .text:00404F95j
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0

loc_404FB4:				; CODE XREF: .text:00404FA9j
		mov	eax, [ebp-10h]

locret_404FB7:				; CODE XREF: .text:00404F07j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+10h]
		add	[ebp-4], eax
		jmp	short loc_404FE8
; ---------------------------------------------------------------------------

loc_404FCD:				; CODE XREF: .text:00404FECj
		sub	dword ptr [ebp-4], 1
		mov	eax, [ebp-4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+0Ch]
		jnz	short loc_404FE4
		mov	eax, [ebp-4]
		jmp	short locret_404FF3
; ---------------------------------------------------------------------------

loc_404FE4:				; CODE XREF: .text:00404FDDj
		sub	dword ptr [ebp+10h], 1

loc_404FE8:				; CODE XREF: .text:00404FCBj
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_404FCD
		mov	eax, 0

locret_404FF3:				; CODE XREF: .text:00404FE2j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404FF5(int, char *, int)
sub_404FF5	proc near		; CODE XREF: .text:00405225p
					; .text:00405247p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_40500B
		mov	eax, 0
		jmp	locret_405208
; ---------------------------------------------------------------------------

loc_40500B:				; CODE XREF: sub_404FF5+Aj
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	short loc_405061
; ---------------------------------------------------------------------------

loc_40501A:				; CODE XREF: sub_404FF5+77j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_405059
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_405059
		cmp	[ebp+arg_4], 0
		jz	short loc_40505D
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_40505D

loc_405059:				; CODE XREF: sub_404FF5+30j
					; sub_404FF5+3Dj
		add	[ebp+var_10], 1

loc_40505D:				; CODE XREF: sub_404FF5+43j
					; sub_404FF5+62j
		add	[ebp+var_C], 1

loc_405061:				; CODE XREF: sub_404FF5+23j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40501A
		cmp	[ebp+arg_8], 0
		jz	short loc_40508C
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+Str], eax ; size_t
		call	sub_40382C
		mov	[ebp+var_14], eax
		jmp	short loc_4050B2
; ---------------------------------------------------------------------------

loc_40508C:				; CODE XREF: sub_404FF5+7Dj
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+Str], eax ; size_t
		call	sub_403819
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4050B2
		mov	eax, 0
		jmp	locret_405208
; ---------------------------------------------------------------------------

loc_4050B2:				; CODE XREF: sub_404FF5+95j
					; sub_404FF5+B1j
		mov	[ebp+var_C], 0
		jmp	loc_4051EE
; ---------------------------------------------------------------------------

loc_4050BE:				; CODE XREF: sub_404FF5+201j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_4050F4
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	33h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	61h
		add	[ebp+var_C], 1
		jmp	loc_4051EA
; ---------------------------------------------------------------------------

loc_4050F4:				; CODE XREF: sub_404FF5+D1j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_40512A
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	32h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	35h
		add	[ebp+var_C], 1
		jmp	loc_4051EA
; ---------------------------------------------------------------------------

loc_40512A:				; CODE XREF: sub_404FF5+107j
		cmp	[ebp+arg_4], 0
		jz	loc_4051D8
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	loc_4051D8
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		sar	al, 4
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_40518B
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 30h
		jmp	short loc_405197
; ---------------------------------------------------------------------------

loc_40518B:				; CODE XREF: sub_404FF5+186j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 57h

loc_405197:				; CODE XREF: sub_404FF5+194j
		mov	[edx], al
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_4051C4
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_4051D0
; ---------------------------------------------------------------------------

loc_4051C4:				; CODE XREF: sub_404FF5+1BFj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 57h

loc_4051D0:				; CODE XREF: sub_404FF5+1CDj
		mov	[edx], al
		add	[ebp+var_C], 1
		jmp	short loc_4051EA
; ---------------------------------------------------------------------------

loc_4051D8:				; CODE XREF: sub_404FF5+139j
					; sub_404FF5+159j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		movzx	edx, byte ptr [edx]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_4051EA:				; CODE XREF: sub_404FF5+FAj
					; sub_404FF5+130j ...
		add	[ebp+arg_0], 1

loc_4051EE:				; CODE XREF: sub_404FF5+C4j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4050BE
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]

locret_405208:				; CODE XREF: sub_404FF5+11j
					; sub_404FF5+B8j
		leave
		retn
sub_404FF5	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_404FF5
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_404FF5
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40524E	proc near		; CODE XREF: .text:0040539Dp
					; .text:004053DCp

var_F8		= dword	ptr -0F8h
var_F4		= dword	ptr -0F4h
var_DC		= dword	ptr -0DCh
var_D8		= dword	ptr -0D8h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 0F4h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		mov	[ebp+eax*4+var_D8], edx
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_DC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_DC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_4052E7
; ---------------------------------------------------------------------------

loc_40529A:				; CODE XREF: sub_40524E+BAj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		mov	[ebp+var_DC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_DC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		cmp	[ebp+var_C], 2Eh
		jbe	short loc_4052E3
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	short loc_405362
; ---------------------------------------------------------------------------

loc_4052E3:				; CODE XREF: sub_40524E+7Fj
		add	[ebp+var_C], 1

loc_4052E7:				; CODE XREF: sub_40524E+4Aj
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+4]
		mov	[ebp+arg_4], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_D8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		test	eax, eax
		jnz	short loc_40529A
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[esp+0F8h+var_F8], eax ; size_t
		call	sub_403819
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_40535F
		mov	eax, [ebp+var_18]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	short loc_405351
; ---------------------------------------------------------------------------

loc_405331:				; CODE XREF: sub_40524E+10Fj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		mov	[esp+0F8h+var_F4], eax
		mov	eax, [ebp+var_14]
		mov	[esp+0F8h+var_F8], eax
		call	sub_404EC1
		mov	[ebp+var_14], eax
		add	[ebp+var_C], 1

loc_405351:				; CODE XREF: sub_40524E+E1j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		test	eax, eax
		jnz	short loc_405331

loc_40535F:				; CODE XREF: sub_40524E+D2j
		mov	eax, [ebp+var_18]

loc_405362:				; CODE XREF: sub_40524E+93j
		add	esp, 0F4h
		pop	edi
		pop	ebp
		retn
sub_40524E	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_405388
		mov	dword ptr [esp], offset	word_40C712
		call	sub_403850
		mov	[ebp-0Ch], eax
		jmp	short loc_4053A5
; ---------------------------------------------------------------------------

loc_405388:				; CODE XREF: .text:00405375j
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40524E
		mov	[ebp-0Ch], eax

loc_4053A5:				; CODE XREF: .text:00405386j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_4053C7
		mov	dword ptr [esp], offset	word_40C712
		call	sub_40392F
		mov	[ebp-0Ch], eax
		jmp	short loc_4053E4
; ---------------------------------------------------------------------------

loc_4053C7:				; CODE XREF: .text:004053B4j
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40524E
		mov	[ebp-0Ch], eax

loc_4053E4:				; CODE XREF: .text:004053C5j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_405458
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_405423
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aFatalTooManyAr ; "\nfatal:	too many args for xstrconcat\n"
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 25h
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	fwrite
		jmp	short loc_40544C
; ---------------------------------------------------------------------------

loc_405423:				; CODE XREF: .text:004053F6j
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aFatalOutOfMemo ; "\nfatal:	out of memory\n"
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 16h
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	fwrite

loc_40544C:				; CODE XREF: .text:00405421j
		mov	dword ptr [esp], 2
		call	exit
; ---------------------------------------------------------------------------

loc_405458:				; CODE XREF: .text:004053E8j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ds:dword_40E38C
		mov	[ebp-4], eax
		cmp	dword ptr [ebp+8], 0
		jz	short loc_40547E
		mov	ds:dword_40E38C, 0

loc_40547E:				; CODE XREF: .text:00405472j
		mov	eax, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_40E38C
		add	eax, 1
		mov	ds:dword_40E38C, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405495(char *Filename, int FileHandle)
sub_405495	proc near		; CODE XREF: sub_4056F4+21p
					; .text:00405730p

File		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Filename	= dword	ptr  8
FileHandle	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, ds:dword_40E300
		test	eax, eax
		jz	short loc_4054DF
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, ds:dword_40E300
		cmp	edx, eax
		jz	short loc_4054D5
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:dword_40E300
		cmp	edx, eax
		jz	short loc_4054D5
		mov	eax, ds:dword_40E300
		mov	[esp+28h+File],	eax ; File
		call	fclose

loc_4054D5:				; CODE XREF: sub_405495+20j
					; sub_405495+31j
		mov	ds:dword_40E300, 0

loc_4054DF:				; CODE XREF: sub_405495+Fj
		cmp	[ebp+Filename],	0
		jz	short loc_405527
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset asc_40C764 ; "-"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_405527
		mov	[ebp+Filename],	0
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+28h+File],	eax ; File
		call	_fileno
		mov	[ebp+FileHandle], eax

loc_405527:				; CODE XREF: sub_405495+4Ej
					; sub_405495+76j
		cmp	[ebp+Filename],	0
		jz	short loc_40557D
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset aSocket ; "socket://"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_405569
		mov	eax, [ebp+Filename]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405569
		mov	eax, 1
		jmp	short loc_40556E
; ---------------------------------------------------------------------------

loc_405569:				; CODE XREF: sub_405495+BEj
					; sub_405495+CBj
		mov	eax, 0

loc_40556E:				; CODE XREF: sub_405495+D2j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_405584
		add	[ebp+Filename],	9
		jmp	short loc_405584
; ---------------------------------------------------------------------------

loc_40557D:				; CODE XREF: sub_405495+96j
		mov	[ebp+var_10], 0

loc_405584:				; CODE XREF: sub_405495+E0j
					; sub_405495+E6j
		cmp	[ebp+var_10], 0
		jz	short loc_4055C0
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aSystemDoesNotS ; "system does not support logging to a so"...
		mov	[esp+28h+var_1C], edx ;	File
		mov	[esp+28h+Count], 3Bh ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+File],	eax ; Str
		call	fwrite
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_40561B
; ---------------------------------------------------------------------------

loc_4055C0:				; CODE XREF: sub_405495+F3j
		cmp	[ebp+Filename],	0
		jz	short loc_4055DF
		mov	eax, offset aA	; "a"
		mov	[esp+28h+Size],	eax ; Mode
		mov	eax, [ebp+Filename]
		mov	[esp+28h+File],	eax ; Filename
		call	fopen
		mov	[ebp+var_C], eax
		jmp	short loc_40561B
; ---------------------------------------------------------------------------

loc_4055DF:				; CODE XREF: sub_405495+12Fj
		cmp	[ebp+FileHandle], 1
		jnz	short loc_4055F2
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[ebp+var_C], eax
		jmp	short loc_40561B
; ---------------------------------------------------------------------------

loc_4055F2:				; CODE XREF: sub_405495+14Ej
		cmp	[ebp+FileHandle], 2
		jnz	short loc_405605
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_40561B
; ---------------------------------------------------------------------------

loc_405605:				; CODE XREF: sub_405495+161j
		mov	[esp+28h+Size],	offset aA ; "a"
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+File],	eax ; FileHandle
		call	_fdopen
		mov	[ebp+var_C], eax

loc_40561B:				; CODE XREF: sub_405495+129j
					; sub_405495+148j ...
		mov	dword_40B000, 0FFFFFFFFh
		cmp	[ebp+var_C], 0
		jnz	loc_4056B0
		cmp	[ebp+Filename],	0
		jz	short loc_40566D
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToOpenLo ; "failed to open log file `%s': %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+Filename]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		jmp	short loc_4056A3
; ---------------------------------------------------------------------------

loc_40566D:				; CODE XREF: sub_405495+19Ej
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToFdopen ; "failed to fdopen	file descriptor	%d: %s"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf

loc_4056A3:				; CODE XREF: sub_405495+1D6j
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_4056D3
; ---------------------------------------------------------------------------

loc_4056B0:				; CODE XREF: sub_405495+194j
		mov	[esp+28h+var_1C], 0 ; Size
		mov	[esp+28h+Count], 40h ; Mode
		mov	[esp+28h+Size],	0 ; Buf
		mov	eax, [ebp+var_C]
		mov	[esp+28h+File],	eax ; File
		call	setvbuf

loc_4056D3:				; CODE XREF: sub_405495+219j
		mov	eax, [ebp+var_C]
		mov	ds:dword_40E300, eax
		mov	eax, [ebp+var_10]
		mov	ds:dword_40E384, eax
		mov	ds:dword_40E388, 0
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_405495	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4056F4(char *)
sub_4056F4	proc near		; CODE XREF: sub_4058B6+19p

Filename	= dword	ptr -18h
FileHandle	= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_405705
		mov	eax, [ebp+arg_0]
		jmp	short loc_40570A
; ---------------------------------------------------------------------------

loc_405705:				; CODE XREF: sub_4056F4+Aj
		mov	eax, offset asc_40C764 ; "-"

loc_40570A:				; CODE XREF: sub_4056F4+Fj
		mov	[esp+18h+FileHandle], 0FFFFFFFFh ; FileHandle
		mov	[esp+18h+Filename], eax	; Filename
		call	sub_405495
		leave
		retn
sub_4056F4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_405495
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_40E37C, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_405772
		mov	dword ptr [esp+8], 4Fh
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	byte_40E320
		call	strncpy
		mov	ds:byte_40E36F,	0

loc_405772:				; CODE XREF: .text:0040574Ej
		mov	eax, [ebp+0Ch]
		and	eax, 1
		mov	ds:dword_40E374, eax
		mov	eax, [ebp+0Ch]
		and	eax, 2
		mov	ds:dword_40E370, eax
		mov	eax, [ebp+0Ch]
		and	eax, 4
		mov	ds:dword_40E378, eax
		mov	eax, [ebp+0Ch]
		and	eax, 100h
		mov	ds:dword_40E380, eax
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_405814
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0
		mov	eax, ds:dword_40E374
		test	eax, eax
		jz	short loc_4057CC
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 1
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_4057CC:				; CODE XREF: .text:004057BBj
		mov	eax, ds:dword_40E370
		test	eax, eax
		jz	short loc_4057E4
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 2
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_4057E4:				; CODE XREF: .text:004057D3j
		mov	eax, ds:dword_40E378
		test	eax, eax
		jz	short loc_4057FC
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 4
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_4057FC:				; CODE XREF: .text:004057EBj
		mov	eax, ds:dword_40E380
		test	eax, eax
		jz	short loc_405814
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	dh, 1
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_405814:				; CODE XREF: .text:004057A9j
					; .text:00405803j
		mov	eax, offset byte_40E320
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_40E300
		test	eax, eax
		jz	short loc_40584F
		mov	eax, ds:dword_40E300
		mov	[esp], eax
		call	_fileno
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	short loc_40584F
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_40584F
		mov	eax, 1
		jmp	short locret_40586F
; ---------------------------------------------------------------------------

loc_40584F:				; CODE XREF: .text:00405828j
					; .text:0040583Ej ...
		mov	eax, dword_40B000
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40586A
		mov	eax, dword_40B000
		cmp	eax, [ebp+8]
		jnz	short loc_40586A
		mov	eax, 1
		jmp	short locret_40586F
; ---------------------------------------------------------------------------

loc_40586A:				; CODE XREF: .text:00405857j
					; .text:00405861j
		mov	eax, 0

locret_40586F:				; CODE XREF: .text:0040584Dj
					; .text:00405868j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_40E300
		test	eax, eax
		jnz	short loc_40588A
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_40588F
; ---------------------------------------------------------------------------

loc_40588A:				; CODE XREF: .text:0040587Ej
		mov	eax, ds:dword_40E300

loc_40588F:				; CODE XREF: .text:00405888j
		mov	[esp], eax
		call	_fileno
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_40E300
		test	eax, eax
		jnz	short loc_4058AF
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_4058B4
; ---------------------------------------------------------------------------

loc_4058AF:				; CODE XREF: .text:004058A3j
		mov	eax, ds:dword_40E300

loc_4058B4:				; CODE XREF: .text:004058ADj
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4058B6(int, char *Format, va_list ArgList)
sub_4058B6	proc near		; CODE XREF: sub_405C39+22p
					; .text:00405C7Cp ...

var_58		= dword	ptr -58h
File		= dword	ptr -54h
Count		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
Format		= dword	ptr  0Ch
ArgList		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_40E300
		test	eax, eax
		jnz	short loc_4058F9
		mov	[esp+58h+var_58], 0 ; char *
		call	sub_4056F4
		mov	eax, ds:dword_40E300
		test	eax, eax
		jnz	short loc_4058F9
		mov	[esp+58h+Count], 1C3h ;	int
		mov	[esp+58h+File],	offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/jnlib/logging.c"
		mov	[esp+58h+var_58], offset aLogstream ; "logstream"
		call	sub_40A8A0

loc_4058F9:				; CODE XREF: sub_4058B6+10j
					; sub_4058B6+25j
		mov	eax, ds:dword_40E388
		test	eax, eax
		jz	short loc_40591D
		cmp	[ebp+arg_0], 1
		jz	short loc_40591D
		mov	eax, ds:dword_40E300
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_40591D:				; CODE XREF: sub_4058B6+4Aj
					; sub_4058B6+50j
		mov	ds:dword_40E388, 0
		cmp	[ebp+arg_0], 1
		jz	loc_405AB4
		mov	eax, ds:dword_40E370
		test	eax, eax
		jz	loc_4059CD
		mov	eax, ds:dword_40E384
		test	eax, eax
		jnz	loc_4059CD
		mov	[esp+58h+var_58], 0
		call	sub_40A970
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_58], eax
		call	sub_40A980
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	edx, [eax]
		mov	eax, [ebp+var_1C]
		mov	edi, [eax+4]
		mov	eax, [ebp+var_1C]
		mov	esi, [eax+8]
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax+0Ch]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+10h]
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+14h]
		add	eax, 76Ch
		mov	[ebp+var_30], eax
		mov	ecx, offset a04d02d02d02d02 ; "%04d-%02d-%02d %02d:%02d:%02d "
		mov	eax, ds:dword_40E300
		mov	[esp+58h+var_3C], edx
		mov	[esp+58h+var_40], edi
		mov	[esp+58h+var_44], esi
		mov	[esp+58h+var_48], ebx
		mov	edx, [ebp+var_2C]
		mov	[esp+58h+var_4C], edx
		mov	edi, [ebp+var_30]
		mov	[esp+58h+Count], edi
		mov	[esp+58h+File],	ecx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_4059CD:				; CODE XREF: sub_4058B6+82j
					; sub_4058B6+8Fj
		mov	eax, ds:dword_40E374
		test	eax, eax
		jnz	short loc_4059DF
		mov	eax, ds:dword_40E384
		test	eax, eax
		jz	short loc_4059F6

loc_4059DF:				; CODE XREF: sub_4058B6+11Ej
		mov	edx, ds:dword_40E300
		mov	eax, offset byte_40E320
		mov	[esp+58h+File],	edx ; File
		mov	[esp+58h+var_58], eax ;	Str
		call	fputs

loc_4059F6:				; CODE XREF: sub_4058B6+127j
		mov	eax, ds:dword_40E378
		test	eax, eax
		jnz	short loc_405A08
		mov	eax, ds:dword_40E384
		test	eax, eax
		jz	short loc_405A62

loc_405A08:				; CODE XREF: sub_4058B6+147j
		mov	eax, ds:dword_40E37C
		test	eax, eax
		jz	short loc_405A41
		mov	eax, ds:dword_40E37C
		call	eax ; dword_40E37C
		mov	ebx, eax
		call	_getpid
		mov	ecx, eax
		mov	edx, offset aU_Lx ; "[%u.%lx]"
		mov	eax, ds:dword_40E300
		mov	[esp+58h+var_4C], ebx
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_405A62
; ---------------------------------------------------------------------------

loc_405A41:				; CODE XREF: sub_4058B6+159j
		call	_getpid
		mov	ecx, eax
		mov	edx, offset aU	; "[%u]"
		mov	eax, ds:dword_40E300
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_405A62:				; CODE XREF: sub_4058B6+150j
					; sub_4058B6+189j
		mov	eax, ds:dword_40E370
		test	eax, eax
		jz	short loc_405A74
		mov	eax, ds:dword_40E384
		test	eax, eax
		jz	short loc_405A89

loc_405A74:				; CODE XREF: sub_4058B6+1B3j
		mov	eax, ds:dword_40E300
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 3Ah ;	Ch
		call	putc

loc_405A89:				; CODE XREF: sub_4058B6+1BCj
		cmp	[ebp+Format], 0
		jz	short loc_405A9F
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_405A9F
		add	[ebp+Format], 1
		jmp	short loc_405AB4
; ---------------------------------------------------------------------------

loc_405A9F:				; CODE XREF: sub_4058B6+1D7j
					; sub_4058B6+1E1j
		mov	eax, ds:dword_40E300
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 20h ;	Ch
		call	putc

loc_405AB4:				; CODE XREF: sub_4058B6+75j
					; sub_4058B6+1E7j
		cmp	[ebp+arg_0], 7	; switch 8 cases
		ja	loc_405B48	; jumptable 00405ACB default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_40C894
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_405ACD:				; CODE XREF: sub_4058B6+215j
					; DATA XREF: .rdata:off_40C894o
		mov	edx, ds:dword_40E300 ; jumptable 00405ACB case 5
		mov	eax, offset aFatal ; "Fatal: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 7 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_405B68
; ---------------------------------------------------------------------------

loc_405AF6:				; CODE XREF: sub_4058B6+215j
					; DATA XREF: .rdata:off_40C894o
		mov	edx, ds:dword_40E300 ; jumptable 00405ACB case 6
		mov	eax, offset aOhhhhJeeee	; "Ohhhh jeeee:	"
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 0Dh ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_405B68
; ---------------------------------------------------------------------------

loc_405B1F:				; CODE XREF: sub_4058B6+215j
					; DATA XREF: .rdata:off_40C894o
		mov	edx, ds:dword_40E300 ; jumptable 00405ACB case 7
		mov	eax, offset aDbg ; "DBG: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 5 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_405B68
; ---------------------------------------------------------------------------

loc_405B48:				; CODE XREF: sub_4058B6+202j
		mov	edx, offset aUnknownLogLeve ; jumptable	00405ACB default case
		mov	eax, ds:dword_40E300
		mov	ecx, [ebp+arg_0]
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_405B68
; ---------------------------------------------------------------------------

loc_405B67:				; CODE XREF: sub_4058B6+215j
					; DATA XREF: .rdata:off_40C894o
		nop			; jumptable 00405ACB cases 0-4

loc_405B68:				; CODE XREF: sub_4058B6+23Ej
					; sub_4058B6+267j ...
		cmp	[ebp+Format], 0
		jz	short loc_405BD8
		mov	eax, ds:dword_40E300
		mov	edx, [ebp+ArgList]
		mov	[esp+58h+Count], edx ; ArgList
		mov	edx, [ebp+Format]
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	vfprintf
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405BCB
		mov	eax, [ebp+Format]
		mov	[ebp+var_34], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_34]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_405BCB
		mov	ds:dword_40E388, 1
		jmp	short loc_405BD8
; ---------------------------------------------------------------------------

loc_405BCB:				; CODE XREF: sub_4058B6+2DBj
					; sub_4058B6+307j
		mov	eax, ds:dword_40E300
		mov	[esp+58h+var_58], eax ;	File
		call	fflush

loc_405BD8:				; CODE XREF: sub_4058B6+2B6j
					; sub_4058B6+313j
		cmp	[ebp+arg_0], 5
		jnz	short loc_405C08
		mov	eax, ds:dword_40E388
		test	eax, eax
		jz	short loc_405BFC
		mov	eax, ds:dword_40E300
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_405BFC:				; CODE XREF: sub_4058B6+32Fj
		mov	[esp+58h+var_58], 2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_405C08:				; CODE XREF: sub_4058B6+326j
		cmp	[ebp+arg_0], 6
		jnz	short loc_405C31
		mov	eax, ds:dword_40E388
		test	eax, eax
		jz	short loc_405C2C
		mov	eax, ds:dword_40E300
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_405C2C:				; CODE XREF: sub_4058B6+35Fj
		call	abort
; ---------------------------------------------------------------------------

loc_405C31:				; CODE XREF: sub_4058B6+356j
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4058B6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405C39(int, char *, char)
sub_405C39	proc near		; CODE XREF: sub_405E3C+2Ap

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_4058B6
		leave
		retn
sub_405C39	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4058B6
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405C83(char *, char)
sub_405C83	proc near		; CODE XREF: sub_405E70+8Ep
					; sub_405E70+C4p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 2 ; int
		call	sub_4058B6
		leave
		retn
sub_405C83	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 4
		call	sub_4058B6
		mov	eax, ds:dword_40E38C
		cmp	eax, 752Fh
		jg	short locret_405CEE
		mov	eax, ds:dword_40E38C
		add	eax, 1
		mov	ds:dword_40E38C, eax

locret_405CEE:				; CODE XREF: .text:00405CDFj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 5
		call	sub_4058B6
		call	abort
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 6
		call	sub_4058B6
		call	abort

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405D4A(char *, char)
sub_405D4A	proc near		; CODE XREF: .text:00405DC8p

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 7 ; int
		call	sub_4058B6
		leave
		retn
sub_405D4A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405D74(char *, char)
sub_405D74	proc near		; CODE XREF: .text:00405DEDp
					; .text:00405E10p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		cmp	[ebp+arg_0], 0
		setnz	al
		movzx	eax, al
		mov	[esp+28h+ArgList], edx ; ArgList
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+var_28], eax ;	int
		call	sub_4058B6
		leave
		retn
sub_405D74	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_405DCD
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405DCD
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_40C8B4
		call	sub_405D4A

loc_405DCD:				; CODE XREF: .text:00405DAEj
					; .text:00405DB8j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_405E28
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a02x ; "%02X"
		call	sub_405D74
		sub	dword ptr [ebp+10h], 1
		add	dword ptr [ebp-0Ch], 1
		jmp	short loc_405E19
; ---------------------------------------------------------------------------

loc_405DFC:				; CODE XREF: .text:00405E26j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a02x_0 ; " %02X"
		call	sub_405D74
		add	dword ptr [ebp-0Ch], 1

loc_405E19:				; CODE XREF: .text:00405DFAj
		cmp	dword ptr [ebp+10h], 0
		setnz	al
		sub	dword ptr [ebp+10h], 1
		test	al, al
		jnz	short loc_405DFC

loc_405E28:				; CODE XREF: .text:00405DD1j
		cmp	dword ptr [ebp+8], 0
		jz	short locret_405E3A
		mov	dword ptr [esp], offset	asc_40C8C3 ; "\n"
		call	sub_405D74

locret_405E3A:				; CODE XREF: .text:00405E2Cj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_405E3C	proc near		; CODE XREF: sub_403F7E+A7p
					; sub_4064D1+6C5p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_18], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_1C], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_20], eax	; char
		mov	[esp+28h+var_24], offset a___ThisIsABugS ; "...	this is	a bug (%s:%d:%s)\n"
		mov	[esp+28h+var_28], 6 ; int
		call	sub_405C39
		call	abort
sub_405E3C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405E70	proc near		; CODE XREF: .text:004061EAp
					; .text:00406233p ...

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_405F05
		cmp	[ebp+arg_0], 0
		jz	short loc_405EC9
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aUtf8 ; "utf-8"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_405EC9
		mov	eax, ds:dword_40E3D0
		mov	[ebp+var_1C], eax
		mov	ds:dword_40E3D0, 1
		jmp	short loc_405EDB
; ---------------------------------------------------------------------------

loc_405EC9:				; CODE XREF: sub_405E70+1Bj
					; sub_405E70+43j
		mov	eax, ds:dword_40E3D4
		mov	[ebp+var_1C], eax
		mov	ds:dword_40E3D4, 1

loc_405EDB:				; CODE XREF: sub_405E70+57j
		cmp	[ebp+var_1C], 0
		jnz	short loc_405F43
		mov	[esp+38h+var_38], offset aConversionFrom ; "conversion from `%s' to `%s' not availa"...
		call	sub_4087DC
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+var_30], edx
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], edx	; char
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_405C83
		jmp	short loc_405F43
; ---------------------------------------------------------------------------

loc_405F05:				; CODE XREF: sub_405E70+15j
		mov	eax, ds:dword_40E3D8
		test	eax, eax
		jnz	short loc_405F39
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+38h+var_38], eax ;	int
		call	strerror
		mov	ebx, eax
		mov	[esp+38h+var_38], offset aIconv_openFail ; "iconv_open failed: %s\n"
		call	sub_4087DC
		mov	dword ptr [esp+38h+var_34], ebx	; char
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_405C83

loc_405F39:				; CODE XREF: sub_405E70+9Cj
		mov	ds:dword_40E3D8, 1

loc_405F43:				; CODE XREF: sub_405E70+6Fj
					; sub_405E70+93j
		cmp	[ebp+arg_8], 0
		jz	short loc_405F67
		mov	off_40B004, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_40E3A0, 0
		mov	ds:dword_40E3A4, 0

loc_405F67:				; CODE XREF: sub_405E70+D7j
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_405E70	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+8], 0
		jnz	loc_406079
		mov	eax, ds:GetConsoleOutputCP
		call	eax ; GetConsoleOutputCP
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_405F9A
		mov	eax, ds:GetACP
		call	eax ; GetACP
		mov	[ebp-0Ch], eax

loc_405F9A:				; CODE XREF: .text:00405F8Ej
		mov	eax, offset aCpU ; "CP%u"
		mov	edx, [ebp-0Ch]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_40E3B0
		call	sprintf
		mov	dword ptr [ebp+8], offset dword_40E3B0
		mov	dword ptr [ebp-10h], offset aCp936 ; "CP936"
		jmp	loc_40606B
; ---------------------------------------------------------------------------

loc_405FC9:				; CODE XREF: .text:00406073j
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_40E3B0
		call	strcmp
		test	eax, eax
		jz	short loc_405FF7
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	short loc_406021
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_406021

loc_405FF7:				; CODE XREF: .text:00405FDEj
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	eax, [ebp-10h]
		mov	[ebp+8], eax
		jmp	short loc_406079
; ---------------------------------------------------------------------------

loc_406021:				; CODE XREF: .text:00405FE8j
					; .text:00405FF5j
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp-10h], eax

loc_40606B:				; CODE XREF: .text:00405FC4j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_405FC9

loc_406079:				; CODE XREF: .text:00405F7Aj
					; .text:0040601Fj
		mov	eax, [ebp+8]
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 3
		jbe	short loc_4060DE
		mov	dword ptr [esp+8], 3
		mov	dword ptr [esp+4], offset aIso ; "iso"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_404D1F
		test	eax, eax
		jnz	short loc_4060DE
		add	dword ptr [ebp+8], 3
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jz	short loc_4060DA
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Fh
		jnz	short loc_4060DE

loc_4060DA:				; CODE XREF: .text:004060CEj
		add	dword ptr [ebp+8], 1

loc_4060DE:				; CODE XREF: .text:004060A1j
					; .text:004060C0j ...
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406144
		mov	dword ptr [esp+4], offset a88591 ; "8859-1"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_404BE5
		test	eax, eax
		jz	short loc_406144
		mov	dword ptr [esp+4], offset a646 ; "646"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_404BE5
		test	eax, eax
		jz	short loc_406144
		mov	dword ptr [esp+4], offset aAscii ; "ASCII"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_404BE5
		test	eax, eax
		jz	short loc_406144
		mov	dword ptr [esp+4], offset aAnsi_x3_41968 ; "ANSI_X3.4-1968"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_404BE5
		test	eax, eax
		jnz	short loc_406167

loc_406144:				; CODE XREF: .text:004060E6j
					; .text:004060FDj ...
		mov	off_40B004, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_40E3A0, 0
		mov	ds:dword_40E3A4, 0
		jmp	loc_406266
; ---------------------------------------------------------------------------

loc_406167:				; CODE XREF: .text:00406142j
		mov	dword ptr [esp+4], offset aUtf8_0 ; "utf8"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_404BE5
		test	eax, eax
		jz	short loc_406195
		mov	dword ptr [esp+4], offset aUtf8	; "utf-8"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_404BE5
		test	eax, eax
		jnz	short loc_4061B8

loc_406195:				; CODE XREF: .text:0040617Cj
		mov	off_40B004, offset aUtf8 ; "utf-8"
		mov	ds:dword_40E3A0, 1
		mov	ds:dword_40E3A4, 0
		jmp	loc_406266
; ---------------------------------------------------------------------------

loc_4061B8:				; CODE XREF: .text:00406193j
		mov	dword ptr [esp+4], offset aUtf8	; "utf-8"
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	libiconv_open
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jnz	short loc_4061F6
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], offset aUtf8	; "utf-8"
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_405E70
		mov	eax, 0FFFFFFFFh
		jmp	short loc_40626B
; ---------------------------------------------------------------------------

loc_4061F6:				; CODE XREF: .text:004061D2j
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	libiconv_close
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aUtf8 ;	"utf-8"
		call	libiconv_open
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jnz	short loc_40623F
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aUtf8 ;	"utf-8"
		call	sub_405E70
		mov	eax, 0FFFFFFFFh
		jmp	short loc_40626B
; ---------------------------------------------------------------------------

loc_40623F:				; CODE XREF: .text:0040621Bj
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	libiconv_close
		mov	eax, [ebp-14h]
		mov	off_40B004, eax
		mov	ds:dword_40E3A0, 0
		mov	ds:dword_40E3A4, 1

loc_406266:				; CODE XREF: .text:00406162j
					; .text:004061B3j
		mov	eax, 0

loc_40626B:				; CODE XREF: .text:004061F4j
					; .text:0040623Dj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, off_40B004
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_40E3A0
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406285(char *)
sub_406285	proc near		; CODE XREF: sub_406285+129p

Dest		= dword	ptr -78h
Source		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_4C		= dword	ptr -4Ch
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_28], 0
		mov	eax, ds:dword_40E3A0
		test	eax, eax
		jz	short loc_4062B7
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Dest],	eax ; char *
		call	sub_40392F
		mov	[ebp+var_20], eax
		jmp	loc_4064C6
; ---------------------------------------------------------------------------

loc_4062B7:				; CODE XREF: sub_406285+1Dj
		mov	eax, ds:dword_40E3A4
		test	eax, eax
		jnz	loc_40636D
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_4062E2
; ---------------------------------------------------------------------------

loc_4062CC:				; CODE XREF: sub_406285+65j
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_4062DE
		add	[ebp+var_28], 1

loc_4062DE:				; CODE XREF: sub_406285+53j
		add	[ebp+var_1C], 1

loc_4062E2:				; CODE XREF: sub_406285+45j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4062CC
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[esp+78h+Dest],	eax ; size_t
		call	sub_40382C
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_406358
; ---------------------------------------------------------------------------

loc_40630B:				; CODE XREF: sub_406285+DBj
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_406345
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		shr	al, 6
		or	eax, 0FFFFFFC0h
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		and	eax, 3Fh
		or	eax, 0FFFFFF80h
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_406354
; ---------------------------------------------------------------------------

loc_406345:				; CODE XREF: sub_406285+8Ej
		mov	eax, [ebp+var_1C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_406354:				; CODE XREF: sub_406285+BEj
		add	[ebp+var_1C], 1

loc_406358:				; CODE XREF: sub_406285+84j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40630B
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		jmp	loc_4064C6
; ---------------------------------------------------------------------------

loc_40636D:				; CODE XREF: sub_406285+39j
		mov	eax, off_40B004
		mov	[esp+78h+Source], eax
		mov	[esp+78h+Dest],	offset aUtf8 ; "utf-8"
		call	libiconv_open
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0FFFFFFFFh
		jnz	short loc_4063B8
		mov	eax, off_40B004
		mov	[esp+78h+var_70], 1
		mov	[esp+78h+Source], eax
		mov	[esp+78h+Dest],	offset aUtf8 ; "utf-8"
		call	sub_405E70
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Dest],	eax ; char *
		call	sub_406285
		jmp	loc_4064C9
; ---------------------------------------------------------------------------

loc_4063B8:				; CODE XREF: sub_406285+104j
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_4063D6
; ---------------------------------------------------------------------------

loc_4063C0:				; CODE XREF: sub_406285+159j
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_4063D2
		add	[ebp+var_28], 5

loc_4063D2:				; CODE XREF: sub_406285+147j
		add	[ebp+var_1C], 1

loc_4063D6:				; CODE XREF: sub_406285+139j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4063C0
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[esp+78h+Dest],	eax ; size_t
		call	sub_40382C
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_40], eax
		lea	eax, [ebp+var_40]
		mov	[esp+78h+var_68], eax
		lea	eax, [ebp+var_38]
		mov	[esp+78h+var_6C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+78h+var_70], eax
		lea	eax, [ebp+var_34]
		mov	[esp+78h+Source], eax
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Dest],	eax
		call	libiconv
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_4064B5
		mov	eax, ds:dword_40E3AC
		test	eax, eax
		jnz	short loc_406497
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+78h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	esi, off_40B004
		mov	[esp+78h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_4087DC
		mov	[esp+78h+var_6C], ebx
		mov	[esp+78h+var_70], offset aUtf8 ; "utf-8"
		mov	[esp+78h+Source], esi ;	char
		mov	[esp+78h+Dest],	eax ; char *
		call	sub_405C83

loc_406497:				; CODE XREF: sub_406285+1D3j
		mov	ds:dword_40E3AC, 1
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Source], eax ;	Source
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Dest],	eax ; Dest
		call	strcpy
		jmp	short loc_4064BB
; ---------------------------------------------------------------------------

loc_4064B5:				; CODE XREF: sub_406285+1CAj
		mov	eax, [ebp+var_38]
		mov	byte ptr [eax],	0

loc_4064BB:				; CODE XREF: sub_406285+22Ej
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Dest],	eax
		call	libiconv_close

loc_4064C6:				; CODE XREF: sub_406285+2Dj
					; sub_406285+E3j
		mov	eax, [ebp+var_20]

loc_4064C9:				; CODE XREF: sub_406285+12Ej
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_406285	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4064D1	proc near		; CODE XREF: sub_4064D1+797p
					; sub_406CA3+23p

Dest		= dword	ptr -88h
Format		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		add	esp, 0FFFFFF80h
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 0
		mov	[ebp+var_30], 0

loc_4064F5:				; CODE XREF: sub_4064D1+5EDj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_14]
		mov	[ebp+var_C], eax
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		jmp	loc_406A97
; ---------------------------------------------------------------------------

loc_40651A:				; CODE XREF: sub_4064D1+5CAj
		cmp	[ebp+var_30], 0
		jz	short loc_406579
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_406572
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	short loc_40653E
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FDh
		jbe	short loc_406572

loc_40653E:				; CODE XREF: sub_4064D1+61j
		cmp	[ebp+var_24], 0
		jz	short loc_406569
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_406569:				; CODE XREF: sub_4064D1+71j
		add	[ebp+var_1C], 4
		jmp	loc_406A8F
; ---------------------------------------------------------------------------

loc_406572:				; CODE XREF: sub_4064D1+57j
					; sub_4064D1+6Bj
		mov	[ebp+var_30], 0

loc_406579:				; CODE XREF: sub_4064D1+4Dj
		cmp	[ebp+var_C], 0
		jnz	loc_4068AC
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	loc_406704
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jz	loc_4066E4
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_4065D5
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_4065D5
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_8]
		jz	short loc_4065D5
		cmp	[ebp+arg_8], 0
		jz	loc_4066E4
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_4066E4

loc_4065D5:				; CODE XREF: sub_4064D1+D2j
					; sub_4064D1+DCj ...
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_4065E9
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_24], 1

loc_4065E9:				; CODE XREF: sub_4064D1+10Cj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, 0Dh	; switch 14 cases
		ja	loc_40669A	; jumptable 00406602 default case
		mov	eax, ds:off_40CADC[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_406604:				; CODE XREF: sub_4064D1+131j
					; DATA XREF: .rdata:off_40CADCo
		add	[ebp+var_1C], 1	; jumptable 00406602 case 10
		cmp	[ebp+var_24], 0
		jz	loc_4066CB
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	6Eh
		add	[ebp+var_24], 1
		jmp	loc_4066CB
; ---------------------------------------------------------------------------

loc_406621:				; CODE XREF: sub_4064D1+131j
					; DATA XREF: .rdata:off_40CADCo
		add	[ebp+var_1C], 1	; jumptable 00406602 case 13
		cmp	[ebp+var_24], 0
		jz	loc_4066CE
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	72h
		add	[ebp+var_24], 1
		jmp	loc_4066CE
; ---------------------------------------------------------------------------

loc_40663E:				; CODE XREF: sub_4064D1+131j
					; DATA XREF: .rdata:off_40CADCo
		add	[ebp+var_1C], 1	; jumptable 00406602 case 12
		cmp	[ebp+var_24], 0
		jz	loc_4066D1
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	66h
		add	[ebp+var_24], 1
		jmp	short loc_4066D1
; ---------------------------------------------------------------------------

loc_406658:				; CODE XREF: sub_4064D1+131j
					; DATA XREF: .rdata:off_40CADCo
		add	[ebp+var_1C], 1	; jumptable 00406602 case 11
		cmp	[ebp+var_24], 0
		jz	short loc_4066D4
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	76h
		add	[ebp+var_24], 1
		jmp	short loc_4066D4
; ---------------------------------------------------------------------------

loc_40666E:				; CODE XREF: sub_4064D1+131j
					; DATA XREF: .rdata:off_40CADCo
		add	[ebp+var_1C], 1	; jumptable 00406602 case 8
		cmp	[ebp+var_24], 0
		jz	short loc_4066D7
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	62h
		add	[ebp+var_24], 1
		jmp	short loc_4066D7
; ---------------------------------------------------------------------------

loc_406684:				; CODE XREF: sub_4064D1+131j
					; DATA XREF: .rdata:off_40CADCo
		add	[ebp+var_1C], 1	; jumptable 00406602 case 0
		cmp	[ebp+var_24], 0
		jz	short loc_4066DA
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	30h
		add	[ebp+var_24], 1
		jmp	short loc_4066DA
; ---------------------------------------------------------------------------

loc_40669A:				; CODE XREF: sub_4064D1+124j
					; sub_4064D1+131j
					; DATA XREF: ...
		add	[ebp+var_1C], 3	; jumptable 00406602 default case
		cmp	[ebp+var_24], 0
		jz	short loc_4066DD
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 3
		jmp	short loc_4066DD
; ---------------------------------------------------------------------------

loc_4066CB:				; CODE XREF: sub_4064D1+13Bj
					; sub_4064D1+14Bj
		nop
		jmp	short loc_4066DE
; ---------------------------------------------------------------------------

loc_4066CE:				; CODE XREF: sub_4064D1+158j
					; sub_4064D1+168j
		nop
		jmp	short loc_4066DE
; ---------------------------------------------------------------------------

loc_4066D1:				; CODE XREF: sub_4064D1+175j
					; sub_4064D1+185j
		nop
		jmp	short loc_4066DE
; ---------------------------------------------------------------------------

loc_4066D4:				; CODE XREF: sub_4064D1+18Fj
					; sub_4064D1+19Bj
		nop
		jmp	short loc_4066DE
; ---------------------------------------------------------------------------

loc_4066D7:				; CODE XREF: sub_4064D1+1A5j
					; sub_4064D1+1B1j
		nop
		jmp	short loc_4066DE
; ---------------------------------------------------------------------------

loc_4066DA:				; CODE XREF: sub_4064D1+1BBj
					; sub_4064D1+1C7j
		nop
		jmp	short loc_4066DE
; ---------------------------------------------------------------------------

loc_4066DD:				; CODE XREF: sub_4064D1+1D1j
					; sub_4064D1+1F8j
		nop

loc_4066DE:				; CODE XREF: sub_4064D1+1FBj
					; sub_4064D1+1FEj ...
		nop
		jmp	loc_406A8F
; ---------------------------------------------------------------------------

loc_4066E4:				; CODE XREF: sub_4064D1+C4j
					; sub_4064D1+F0j ...
		cmp	[ebp+var_24], 0
		jz	short loc_4066FB
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_4066FB:				; CODE XREF: sub_4064D1+217j
		add	[ebp+var_1C], 1
		jmp	loc_406A8F
; ---------------------------------------------------------------------------

loc_406704:				; CODE XREF: sub_4064D1+BAj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0E0h
		cmp	eax, 0C0h
		jnz	short loc_40674D
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 1
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_406A8F
; ---------------------------------------------------------------------------

loc_40674D:				; CODE XREF: sub_4064D1+246j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F0h
		cmp	eax, 0E0h
		jnz	short loc_406796
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 2
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_406A8F
; ---------------------------------------------------------------------------

loc_406796:				; CODE XREF: sub_4064D1+28Fj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F8h
		cmp	eax, 0F0h
		jnz	short loc_4067DF
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 7
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 3
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_406A8F
; ---------------------------------------------------------------------------

loc_4067DF:				; CODE XREF: sub_4064D1+2D8j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FCh
		cmp	eax, 0F8h
		jnz	short loc_406828
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 4
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_406A8F
; ---------------------------------------------------------------------------

loc_406828:				; CODE XREF: sub_4064D1+321j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FEh
		cmp	eax, 0FCh
		jnz	short loc_406871
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 5
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_406A8F
; ---------------------------------------------------------------------------

loc_406871:				; CODE XREF: sub_4064D1+36Aj
		cmp	[ebp+var_24], 0
		jz	short loc_40689C
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_40689C:				; CODE XREF: sub_4064D1+3A4j
		add	[ebp+var_1C], 4
		mov	[ebp+var_30], 1
		jmp	loc_406A8F
; ---------------------------------------------------------------------------

loc_4068AC:				; CODE XREF: sub_4064D1+ACj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_4068C4
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	loc_406952

loc_4068C4:				; CODE XREF: sub_4064D1+3E3j
		cmp	[ebp+var_24], 0
		jz	short loc_40692C
		mov	[ebp+var_10], 0
		jmp	short loc_4068FF
; ---------------------------------------------------------------------------

loc_4068D3:				; CODE XREF: sub_4064D1+434j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_4068FF:				; CODE XREF: sub_4064D1+400j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_4068D3
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_40692C:				; CODE XREF: sub_4064D1+3F7j
		mov	eax, [ebp+var_14]
		add	eax, 1
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_30], 1
		jmp	loc_406A8F
; ---------------------------------------------------------------------------

loc_406952:				; CODE XREF: sub_4064D1+3EDj
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		shl	[ebp+var_28], 6
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3Fh
		or	[ebp+var_28], eax
		sub	[ebp+var_C], 1
		cmp	[ebp+var_C], 0
		jnz	loc_406A8F
		mov	eax, ds:dword_40E3A0
		test	eax, eax
		jz	short loc_4069CF
		cmp	[ebp+var_24], 0
		jz	short loc_4069BD
		mov	[ebp+var_10], 0
		jmp	short loc_4069B5
; ---------------------------------------------------------------------------

loc_40699D:				; CODE XREF: sub_4064D1+4EAj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_4069B5:				; CODE XREF: sub_4064D1+4CAj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_40699D

loc_4069BD:				; CODE XREF: sub_4064D1+4C1j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	loc_406A8F
; ---------------------------------------------------------------------------

loc_4069CF:				; CODE XREF: sub_4064D1+4BBj
		cmp	[ebp+arg_C], 0
		jz	short loc_406A13
		cmp	[ebp+var_24], 0
		jz	short loc_406A04
		mov	[ebp+var_10], 0
		jmp	short loc_4069FC
; ---------------------------------------------------------------------------

loc_4069E4:				; CODE XREF: sub_4064D1+531j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_4069FC:				; CODE XREF: sub_4064D1+511j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_4069E4

loc_406A04:				; CODE XREF: sub_4064D1+508j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_406A8F
; ---------------------------------------------------------------------------

loc_406A13:				; CODE XREF: sub_4064D1+502j
		cmp	[ebp+var_28], 7Fh
		jbe	short loc_406A3C
		cmp	[ebp+var_28], 0FFh
		ja	short loc_406A3C
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_406A8F
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_406A8F
; ---------------------------------------------------------------------------

loc_406A3C:				; CODE XREF: sub_4064D1+546j
					; sub_4064D1+54Fj
		cmp	[ebp+var_24], 0
		jz	short loc_406A7F
		mov	[ebp+var_10], 0
		jmp	short loc_406A77
; ---------------------------------------------------------------------------

loc_406A4B:				; CODE XREF: sub_4064D1+5ACj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_406A77:				; CODE XREF: sub_4064D1+578j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_406A4B

loc_406A7F:				; CODE XREF: sub_4064D1+56Fj
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0

loc_406A8F:				; CODE XREF: sub_4064D1+9Cj
					; sub_4064D1+20Ej ...
		add	[ebp+var_18], 1
		sub	[ebp+var_2C], 1

loc_406A97:				; CODE XREF: sub_4064D1+44j
		cmp	[ebp+var_2C], 0
		jnz	loc_40651A
		cmp	[ebp+var_20], 0
		jnz	short loc_406AC3
		mov	eax, [ebp+var_1C]
		add	eax, 1
		mov	[esp+88h+Dest],	eax ; size_t
		call	sub_40382C
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax
		jmp	loc_4064F5
; ---------------------------------------------------------------------------

loc_406AC3:				; CODE XREF: sub_4064D1+5D4j
		cmp	[ebp+arg_C], 0
		jz	loc_406C93
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, off_40B004
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	libiconv_open
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0FFFFFFFFh
		jnz	short loc_406B37
		mov	eax, off_40B004
		mov	[esp+88h+var_80], 1
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	sub_405E70
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_403989
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_406CA3
		jmp	loc_406C9C
; ---------------------------------------------------------------------------

loc_406B37:				; CODE XREF: sub_4064D1+61Ej
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		sub	eax, 1
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_44], eax
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_50]
		mov	[ebp+var_5C], eax
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_5C]
		mul	edx
		mov	eax, edx
		shr	eax, 2
		cmp	eax, [ebp+var_1C]
		jz	short loc_406B9B
		mov	[esp+88h+var_80], offset aDo_utf8_to_nat ; "do_utf8_to_native"
		mov	[esp+88h+Format], 24Ah
		mov	[esp+88h+Dest],	offset a____Gnupg22__1 ; "../../gnupg2-2.0.30/jnlib/utf8conv.c"
		call	sub_405E3C
; ---------------------------------------------------------------------------

loc_406B9B:				; CODE XREF: sub_4064D1+6ACj
		mov	eax, [ebp+var_50]
		mov	[esp+88h+Dest],	eax ; size_t
		call	sub_40382C
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_48]
		mov	[ebp+var_34], eax
		lea	eax, [ebp+var_50]
		mov	[esp+88h+var_78], eax
		lea	eax, [ebp+var_48]
		mov	[esp+88h+var_7C], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+88h+var_80], eax
		lea	eax, [ebp+var_44]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	libiconv
		cmp	eax, 0FFFFFFFFh
		jnz	loc_406C72
		mov	eax, ds:dword_40E3A8
		test	eax, eax
		jnz	short loc_406C25
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+88h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	esi, off_40B004
		mov	[esp+88h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_4087DC
		mov	[esp+88h+var_7C], ebx
		mov	[esp+88h+var_80], esi
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax ; char *
		call	sub_405C83

loc_406C25:				; CODE XREF: sub_4064D1+715j
		mov	ds:dword_40E3A8, 1
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_403989
		mov	[ebp+var_20], 0
		mov	eax, [ebp+var_34]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_403989
		mov	[esp+88h+var_7C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_4064D1
		mov	[ebp+var_34], eax
		jmp	short loc_406C83
; ---------------------------------------------------------------------------

loc_406C72:				; CODE XREF: sub_4064D1+708j
		mov	eax, [ebp+var_48]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_403989

loc_406C83:				; CODE XREF: sub_4064D1+79Fj
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	libiconv_close
		mov	eax, [ebp+var_34]
		jmp	short loc_406C9C
; ---------------------------------------------------------------------------

loc_406C93:				; CODE XREF: sub_4064D1+5F6j
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]

loc_406C9C:				; CODE XREF: sub_4064D1+661j
					; sub_4064D1+7C0j
		sub	esp, 0FFFFFF80h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_4064D1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406CA3	proc near		; CODE XREF: sub_40471C+50p
					; sub_4064D1+65Cp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_40E3A4
		mov	[esp+18h+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_4064D1
		leave
		retn
sub_406CA3	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv_open
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+18h]
		mov	[esp+10h], eax
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv_close
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406D2C(char *)
sub_406D2C	proc near		; CODE XREF: .text:00407F13p
					; .text:00408850p

VarName		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_12		= word ptr -12h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+VarName], offset aLc_all ; "LC_ALL"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_406D59
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406D59
		mov	eax, [ebp+var_C]
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406D59:				; CODE XREF: sub_406D2C+19j
					; sub_406D2C+23j
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+VarName], eax ; VarName
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_406D7F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406D7F
		mov	eax, [ebp+var_C]
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406D7F:				; CODE XREF: sub_406D2C+3Fj
					; sub_406D2C+49j
		mov	[esp+38h+VarName], offset aLang	; "LANG"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_406DA6
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406DA6
		mov	eax, [ebp+var_C]
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406DA6:				; CODE XREF: sub_406D2C+66j
					; sub_406D2C+70j
		mov	eax, ds:GetThreadLocale
		call	eax ; GetThreadLocale
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_12], ax
		movzx	eax, [ebp+var_12]
		and	eax, 3FFh
		mov	[ebp+var_18], eax
		movzx	eax, [ebp+var_12]
		shr	ax, 0Ah
		movzx	eax, ax
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_18], 79h ; switch 122 cases
		ja	loc_40786C	; jumptable 00406DE8 default case
		mov	eax, [ebp+var_18]
		shl	eax, 2
		add	eax, offset off_40D090
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_406DEA:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aAf_za ; jumptable 00406DE8	case 54
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406DF4:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aSq_al ; jumptable 00406DE8	case 28
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406DFE:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aAm_et ; jumptable 00406DE8	case 94
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406E08:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		cmp	[ebp+var_1C], 10h ; jumptable 00406DE8 case 1
		ja	loc_406EC1	; jumptable 00406E1F default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_40D278
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_406E21:				; CODE XREF: sub_406D2C+F3j
					; DATA XREF: .rdata:off_40D278o
		mov	eax, offset aAr_sa ; jumptable 00406E1F	case 1
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406E2B:				; CODE XREF: sub_406D2C+F3j
					; DATA XREF: .rdata:off_40D278o
		mov	eax, offset aAr_iq ; jumptable 00406E1F	case 2
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406E35:				; CODE XREF: sub_406D2C+F3j
					; DATA XREF: .rdata:off_40D278o
		mov	eax, offset aAr_eg ; jumptable 00406E1F	case 3
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406E3F:				; CODE XREF: sub_406D2C+F3j
					; DATA XREF: .rdata:off_40D278o
		mov	eax, offset aAr_ly ; jumptable 00406E1F	case 4
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406E49:				; CODE XREF: sub_406D2C+F3j
					; DATA XREF: .rdata:off_40D278o
		mov	eax, offset aAr_dz ; jumptable 00406E1F	case 5
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406E53:				; CODE XREF: sub_406D2C+F3j
					; DATA XREF: .rdata:off_40D278o
		mov	eax, offset aAr_ma ; jumptable 00406E1F	case 6
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406E5D:				; CODE XREF: sub_406D2C+F3j
					; DATA XREF: .rdata:off_40D278o
		mov	eax, offset aAr_tn ; jumptable 00406E1F	case 7
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406E67:				; CODE XREF: sub_406D2C+F3j
					; DATA XREF: .rdata:off_40D278o
		mov	eax, offset aAr_om ; jumptable 00406E1F	case 8
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406E71:				; CODE XREF: sub_406D2C+F3j
					; DATA XREF: .rdata:off_40D278o
		mov	eax, offset aAr_ye ; jumptable 00406E1F	case 9
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406E7B:				; CODE XREF: sub_406D2C+F3j
					; DATA XREF: .rdata:off_40D278o
		mov	eax, offset aAr_sy ; jumptable 00406E1F	case 10
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406E85:				; CODE XREF: sub_406D2C+F3j
					; DATA XREF: .rdata:off_40D278o
		mov	eax, offset aAr_jo ; jumptable 00406E1F	case 11
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406E8F:				; CODE XREF: sub_406D2C+F3j
					; DATA XREF: .rdata:off_40D278o
		mov	eax, offset aAr_lb ; jumptable 00406E1F	case 12
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406E99:				; CODE XREF: sub_406D2C+F3j
					; DATA XREF: .rdata:off_40D278o
		mov	eax, offset aAr_kw ; jumptable 00406E1F	case 13
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406EA3:				; CODE XREF: sub_406D2C+F3j
					; DATA XREF: .rdata:off_40D278o
		mov	eax, offset aAr_ae ; jumptable 00406E1F	case 14
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406EAD:				; CODE XREF: sub_406D2C+F3j
					; DATA XREF: .rdata:off_40D278o
		mov	eax, offset aAr_bh ; jumptable 00406E1F	case 15
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406EB7:				; CODE XREF: sub_406D2C+F3j
					; DATA XREF: .rdata:off_40D278o
		mov	eax, offset aAr_qa ; jumptable 00406E1F	case 16
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406EC1:				; CODE XREF: sub_406D2C+E0j
					; sub_406D2C+F3j
					; DATA XREF: ...
		mov	eax, offset aAr	; jumptable 00406E1F default case
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406ECB:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aHy_am ; jumptable 00406DE8	case 43
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406ED5:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aAs_in ; jumptable 00406DE8	case 77
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406EDF:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, [ebp+var_1C] ; jumptable 00406DE8 case 44
		cmp	eax, 1
		jz	short loc_406EEE
		cmp	eax, 2
		jz	short loc_406EF8
		jmp	short loc_406F02
; ---------------------------------------------------------------------------

loc_406EEE:				; CODE XREF: sub_406D2C+1B9j
		mov	eax, offset aAz_az@latin ; "az_AZ@latin"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406EF8:				; CODE XREF: sub_406D2C+1BEj
		mov	eax, offset aAz_az@cyrillic ; "az_AZ@cyrillic"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406F02:				; CODE XREF: sub_406D2C+1C0j
		mov	eax, offset aAz	; "az"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406F0C:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aEu	; jumptable 00406DE8 case 45
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406F16:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aBe_by ; jumptable 00406DE8	case 35
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406F20:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, [ebp+var_1C] ; jumptable 00406DE8 case 69
		cmp	eax, 1
		jz	short loc_406F2F
		cmp	eax, 2
		jz	short loc_406F39
		jmp	short loc_406F43
; ---------------------------------------------------------------------------

loc_406F2F:				; CODE XREF: sub_406D2C+1FAj
		mov	eax, offset aBn_in ; "bn_IN"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406F39:				; CODE XREF: sub_406D2C+1FFj
		mov	eax, offset aBn_bd ; "bn_BD"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406F43:				; CODE XREF: sub_406D2C+201j
		mov	eax, offset aBn	; "bn"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406F4D:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aBg_bg ; jumptable 00406DE8	case 2
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406F57:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aMy_mm ; jumptable 00406DE8	case 85
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406F61:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aKm_kh ; jumptable 00406DE8	case 83
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406F6B:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aCa_es ; jumptable 00406DE8	case 3
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406F75:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aChr_us ; jumptable	00406DE8 case 92
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406F7F:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		cmp	[ebp+var_1C], 5	; jumptable 00406DE8 case 4
		ja	short loc_406FC6 ; jumptable 00406F92 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_40D2BC
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_406F94:				; CODE XREF: sub_406D2C+266j
					; DATA XREF: .rdata:off_40D2BCo
		mov	eax, offset aZh_tw ; jumptable 00406F92	case 1
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406F9E:				; CODE XREF: sub_406D2C+266j
					; DATA XREF: .rdata:off_40D2BCo
		mov	eax, offset aZh_cn ; jumptable 00406F92	case 2
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406FA8:				; CODE XREF: sub_406D2C+266j
					; DATA XREF: .rdata:off_40D2BCo
		mov	eax, offset aZh_hk ; jumptable 00406F92	case 3
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406FB2:				; CODE XREF: sub_406D2C+266j
					; DATA XREF: .rdata:off_40D2BCo
		mov	eax, offset aZh_sg ; jumptable 00406F92	case 4
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406FBC:				; CODE XREF: sub_406D2C+266j
					; DATA XREF: .rdata:off_40D2BCo
		mov	eax, offset aZh_mo ; jumptable 00406F92	case 5
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406FC6:				; CODE XREF: sub_406D2C+257j
					; sub_406D2C+266j
					; DATA XREF: ...
		mov	eax, offset aZh	; jumptable 00406F92 default case
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406FD0:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, [ebp+var_1C] ; jumptable 00406DE8 case 26
		cmp	eax, 2
		jz	short loc_406FEC
		cmp	eax, 3
		jz	short loc_406FF6
		cmp	eax, 1
		jnz	short loc_407000
		mov	eax, offset aHr_hr ; "hr_HR"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406FEC:				; CODE XREF: sub_406D2C+2AAj
		mov	eax, offset aSr_cs ; "sr_CS"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_406FF6:				; CODE XREF: sub_406D2C+2AFj
		mov	eax, offset aSr_cs@cyrillic ; "sr_CS@cyrillic"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407000:				; CODE XREF: sub_406D2C+2B4j
		mov	eax, offset aHr	; "hr"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40700A:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aCs_cz ; jumptable 00406DE8	case 5
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407014:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aDa_dk ; jumptable 00406DE8	case 6
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40701E:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aDiv_mv ; jumptable	00406DE8 case 101
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407028:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, [ebp+var_1C] ; jumptable 00406DE8 case 19
		cmp	eax, 1
		jz	short loc_407037
		cmp	eax, 2
		jz	short loc_407041
		jmp	short loc_40704B
; ---------------------------------------------------------------------------

loc_407037:				; CODE XREF: sub_406D2C+302j
		mov	eax, offset aNl_nl ; "nl_NL"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407041:				; CODE XREF: sub_406D2C+307j
		mov	eax, offset aNl_be ; "nl_BE"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40704B:				; CODE XREF: sub_406D2C+309j
		mov	eax, offset aNl	; "nl"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407055:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aBin_ng ; jumptable	00406DE8 case 102
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40705F:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		cmp	[ebp+var_1C], 12h ; jumptable 00406DE8 case 9
		ja	loc_40712C	; jumptable 00407076 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_40D2D4
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_407078:				; CODE XREF: sub_406D2C+34Aj
					; DATA XREF: .rdata:off_40D2D4o
		mov	eax, offset aEn_us ; jumptable 00407076	case 1
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407082:				; CODE XREF: sub_406D2C+34Aj
					; DATA XREF: .rdata:off_40D2D4o
		mov	eax, offset aEn_gb ; jumptable 00407076	case 2
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40708C:				; CODE XREF: sub_406D2C+34Aj
					; DATA XREF: .rdata:off_40D2D4o
		mov	eax, offset aEn_au ; jumptable 00407076	case 3
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407096:				; CODE XREF: sub_406D2C+34Aj
					; DATA XREF: .rdata:off_40D2D4o
		mov	eax, offset aEn_ca ; jumptable 00407076	case 4
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4070A0:				; CODE XREF: sub_406D2C+34Aj
					; DATA XREF: .rdata:off_40D2D4o
		mov	eax, offset aEn_nz ; jumptable 00407076	case 5
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4070AA:				; CODE XREF: sub_406D2C+34Aj
					; DATA XREF: .rdata:off_40D2D4o
		mov	eax, offset aEn_ie ; jumptable 00407076	case 6
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4070B4:				; CODE XREF: sub_406D2C+34Aj
					; DATA XREF: .rdata:off_40D2D4o
		mov	eax, offset aEn_za ; jumptable 00407076	case 7
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4070BE:				; CODE XREF: sub_406D2C+34Aj
					; DATA XREF: .rdata:off_40D2D4o
		mov	eax, offset aEn_jm ; jumptable 00407076	case 8
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4070C8:				; CODE XREF: sub_406D2C+34Aj
					; DATA XREF: .rdata:off_40D2D4o
		mov	eax, offset aEn_gd ; jumptable 00407076	case 9
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4070D2:				; CODE XREF: sub_406D2C+34Aj
					; DATA XREF: .rdata:off_40D2D4o
		mov	eax, offset aEn_bz ; jumptable 00407076	case 10
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4070DC:				; CODE XREF: sub_406D2C+34Aj
					; DATA XREF: .rdata:off_40D2D4o
		mov	eax, offset aEn_tt ; jumptable 00407076	case 11
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4070E6:				; CODE XREF: sub_406D2C+34Aj
					; DATA XREF: .rdata:off_40D2D4o
		mov	eax, offset aEn_zw ; jumptable 00407076	case 12
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4070F0:				; CODE XREF: sub_406D2C+34Aj
					; DATA XREF: .rdata:off_40D2D4o
		mov	eax, offset aEn_ph ; jumptable 00407076	case 13
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4070FA:				; CODE XREF: sub_406D2C+34Aj
					; DATA XREF: .rdata:off_40D2D4o
		mov	eax, offset aEn_id ; jumptable 00407076	case 14
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407104:				; CODE XREF: sub_406D2C+34Aj
					; DATA XREF: .rdata:off_40D2D4o
		mov	eax, offset aEn_hk ; jumptable 00407076	case 15
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40710E:				; CODE XREF: sub_406D2C+34Aj
					; DATA XREF: .rdata:off_40D2D4o
		mov	eax, offset aEn_in ; jumptable 00407076	case 16
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407118:				; CODE XREF: sub_406D2C+34Aj
					; DATA XREF: .rdata:off_40D2D4o
		mov	eax, offset aEn_my ; jumptable 00407076	case 17
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407122:				; CODE XREF: sub_406D2C+34Aj
					; DATA XREF: .rdata:off_40D2D4o
		mov	eax, offset aEn_sg ; jumptable 00407076	case 18
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40712C:				; CODE XREF: sub_406D2C+337j
					; sub_406D2C+34Aj
					; DATA XREF: ...
		mov	eax, offset aEn	; jumptable 00407076 default case
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407136:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aEt_ee ; jumptable 00406DE8	case 37
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407140:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aFo_fo ; jumptable 00406DE8	case 56
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40714A:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aFa_ir ; jumptable 00406DE8	case 41
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407154:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aFi_fi ; jumptable 00406DE8	case 11
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40715E:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		cmp	[ebp+var_1C], 0Fh ; jumptable 00406DE8 case 12
		ja	loc_40720D	; jumptable 00407175 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_40D320
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_407177:				; CODE XREF: sub_406D2C+449j
					; DATA XREF: .rdata:off_40D320o
		mov	eax, offset aFr_fr ; jumptable 00407175	case 1
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407181:				; CODE XREF: sub_406D2C+449j
					; DATA XREF: .rdata:off_40D320o
		mov	eax, offset aFr_be ; jumptable 00407175	case 2
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40718B:				; CODE XREF: sub_406D2C+449j
					; DATA XREF: .rdata:off_40D320o
		mov	eax, offset aFr_ca ; jumptable 00407175	case 3
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407195:				; CODE XREF: sub_406D2C+449j
					; DATA XREF: .rdata:off_40D320o
		mov	eax, offset aFr_ch ; jumptable 00407175	case 4
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40719F:				; CODE XREF: sub_406D2C+449j
					; DATA XREF: .rdata:off_40D320o
		mov	eax, offset aFr_lu ; jumptable 00407175	case 5
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4071A9:				; CODE XREF: sub_406D2C+449j
					; DATA XREF: .rdata:off_40D320o
		mov	eax, offset aFr_mc ; jumptable 00407175	case 6
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4071B3:				; CODE XREF: sub_406D2C+449j
					; DATA XREF: .rdata:off_40D320o
		mov	eax, offset aFr	; jumptable 00407175 case 7
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4071BD:				; CODE XREF: sub_406D2C+449j
					; DATA XREF: .rdata:off_40D320o
		mov	eax, offset aFr_re ; jumptable 00407175	case 8
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4071C7:				; CODE XREF: sub_406D2C+449j
					; DATA XREF: .rdata:off_40D320o
		mov	eax, offset aFr_cg ; jumptable 00407175	case 9
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4071D1:				; CODE XREF: sub_406D2C+449j
					; DATA XREF: .rdata:off_40D320o
		mov	eax, offset aFr_sn ; jumptable 00407175	case 10
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4071DB:				; CODE XREF: sub_406D2C+449j
					; DATA XREF: .rdata:off_40D320o
		mov	eax, offset aFr_cm ; jumptable 00407175	case 11
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4071E5:				; CODE XREF: sub_406D2C+449j
					; DATA XREF: .rdata:off_40D320o
		mov	eax, offset aFr_ci ; jumptable 00407175	case 12
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4071EF:				; CODE XREF: sub_406D2C+449j
					; DATA XREF: .rdata:off_40D320o
		mov	eax, offset aFr_ml ; jumptable 00407175	case 13
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4071F9:				; CODE XREF: sub_406D2C+449j
					; DATA XREF: .rdata:off_40D320o
		mov	eax, offset aFr_ma ; jumptable 00407175	case 14
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407203:				; CODE XREF: sub_406D2C+449j
					; DATA XREF: .rdata:off_40D320o
		mov	eax, offset aFr_ht ; jumptable 00407175	case 15
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40720D:				; CODE XREF: sub_406D2C+436j
					; sub_406D2C+449j
					; DATA XREF: ...
		mov	eax, offset aFr	; jumptable 00407175 default case
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407217:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aFy_nl ; jumptable 00406DE8	case 98
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407221:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aFul_ng ; jumptable	00406DE8 case 103
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40722B:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, [ebp+var_1C] ; jumptable 00406DE8 case 60
		cmp	eax, 1
		jz	short loc_40723A
		cmp	eax, 2
		jz	short loc_407244
		jmp	short loc_40724E
; ---------------------------------------------------------------------------

loc_40723A:				; CODE XREF: sub_406D2C+505j
		mov	eax, offset aGd_gb ; "gd_GB"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407244:				; CODE XREF: sub_406D2C+50Aj
		mov	eax, offset aGa_ie ; "ga_IE"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40724E:				; CODE XREF: sub_406D2C+50Cj
		mov	eax, offset aC	; "C"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407258:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aGl_es ; jumptable 00406DE8	case 86
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407262:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aKa_ge ; jumptable 00406DE8	case 55
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40726C:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		cmp	[ebp+var_1C], 5	; jumptable 00406DE8 case 7
		ja	short loc_4072B3 ; jumptable 0040727F default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_40D360
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_407281:				; CODE XREF: sub_406D2C+553j
					; DATA XREF: .rdata:off_40D360o
		mov	eax, offset aDe_de ; jumptable 0040727F	case 1
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40728B:				; CODE XREF: sub_406D2C+553j
					; DATA XREF: .rdata:off_40D360o
		mov	eax, offset aDe_ch ; jumptable 0040727F	case 2
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407295:				; CODE XREF: sub_406D2C+553j
					; DATA XREF: .rdata:off_40D360o
		mov	eax, offset aDe_at ; jumptable 0040727F	case 3
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40729F:				; CODE XREF: sub_406D2C+553j
					; DATA XREF: .rdata:off_40D360o
		mov	eax, offset aDe_lu ; jumptable 0040727F	case 4
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4072A9:				; CODE XREF: sub_406D2C+553j
					; DATA XREF: .rdata:off_40D360o
		mov	eax, offset aDe_li ; jumptable 0040727F	case 5
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4072B3:				; CODE XREF: sub_406D2C+544j
					; sub_406D2C+553j
					; DATA XREF: ...
		mov	eax, offset aDe	; jumptable 0040727F default case
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4072BD:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aEl_gr ; jumptable 00406DE8	case 8
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4072C7:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aGn_py ; jumptable 00406DE8	case 116
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4072D1:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aGu_in ; jumptable 00406DE8	case 71
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4072DB:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aHa_ng ; jumptable 00406DE8	case 104
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4072E5:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aCpe_us ; jumptable	00406DE8 case 117
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4072EF:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aHe_il ; jumptable 00406DE8	case 13
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4072F9:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aHi_in ; jumptable 00406DE8	case 57
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407303:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aHu_hu ; jumptable 00406DE8	case 14
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40730D:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aNic_ng ; jumptable	00406DE8 case 105
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407317:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aIs_is ; jumptable 00406DE8	case 15
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407321:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aIbo_ng ; jumptable	00406DE8 case 112
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40732B:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aId_id ; jumptable 00406DE8	case 33
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407335:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aIu_ca ; jumptable 00406DE8	case 93
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40733F:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, [ebp+var_1C] ; jumptable 00406DE8 case 16
		cmp	eax, 1
		jz	short loc_40734E
		cmp	eax, 2
		jz	short loc_407358
		jmp	short loc_407362
; ---------------------------------------------------------------------------

loc_40734E:				; CODE XREF: sub_406D2C+619j
		mov	eax, offset aIt_it ; "it_IT"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407358:				; CODE XREF: sub_406D2C+61Ej
		mov	eax, offset aIt_ch ; "it_CH"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407362:				; CODE XREF: sub_406D2C+620j
		mov	eax, offset aIt	; "it"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40736C:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aJa_jp ; jumptable 00406DE8	case 17
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407376:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aKn_in ; jumptable 00406DE8	case 75
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407380:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aKau_ng ; jumptable	00406DE8 case 113
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40738A:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, [ebp+var_1C] ; jumptable 00406DE8 case 96
		cmp	eax, 1
		jz	short loc_407399
		cmp	eax, 2
		jz	short loc_4073A3
		jmp	short loc_4073AD
; ---------------------------------------------------------------------------

loc_407399:				; CODE XREF: sub_406D2C+664j
		mov	eax, offset aKs_pk ; "ks_PK"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4073A3:				; CODE XREF: sub_406D2C+669j
		mov	eax, offset aKs_in ; "ks_IN"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4073AD:				; CODE XREF: sub_406D2C+66Bj
		mov	eax, offset aKs	; "ks"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4073B7:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aKk_kz ; jumptable 00406DE8	case 63
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4073C1:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aKok_in ; jumptable	00406DE8 case 87
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4073CB:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aKo_kr ; jumptable 00406DE8	case 18
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4073D5:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aKy_kg ; jumptable 00406DE8	case 64
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4073DF:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aLo_la ; jumptable 00406DE8	case 84
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4073E9:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aLa_va ; jumptable 00406DE8	case 118
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4073F3:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aLv_lv ; jumptable 00406DE8	case 38
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4073FD:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aLt_lt ; jumptable 00406DE8	case 39
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407407:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aMk_mk ; jumptable 00406DE8	case 47
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407411:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, [ebp+var_1C] ; jumptable 00406DE8 case 62
		cmp	eax, 1
		jz	short loc_407420
		cmp	eax, 2
		jz	short loc_40742A
		jmp	short loc_407434
; ---------------------------------------------------------------------------

loc_407420:				; CODE XREF: sub_406D2C+6EBj
		mov	eax, offset aMs_my ; "ms_MY"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40742A:				; CODE XREF: sub_406D2C+6F0j
		mov	eax, offset aMs_bn ; "ms_BN"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407434:				; CODE XREF: sub_406D2C+6F2j
		mov	eax, offset aMs	; "ms"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40743E:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aMl_in ; jumptable 00406DE8	case 76
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407448:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aMt_mt ; jumptable 00406DE8	case 58
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407452:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aMni_in ; jumptable	00406DE8 case 88
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40745C:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aMr_in ; jumptable 00406DE8	case 78
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407466:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aMn	; jumptable 00406DE8 case 80
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407470:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, [ebp+var_1C] ; jumptable 00406DE8 case 97
		cmp	eax, 1
		jz	short loc_40747F
		cmp	eax, 2
		jz	short loc_407489
		jmp	short loc_407493
; ---------------------------------------------------------------------------

loc_40747F:				; CODE XREF: sub_406D2C+74Aj
		mov	eax, offset aNe_np ; "ne_NP"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407489:				; CODE XREF: sub_406D2C+74Fj
		mov	eax, offset aNe_in ; "ne_IN"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407493:				; CODE XREF: sub_406D2C+751j
		mov	eax, offset aNe	; "ne"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40749D:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, [ebp+var_1C] ; jumptable 00406DE8 case 20
		cmp	eax, 1
		jz	short loc_4074AC
		cmp	eax, 2
		jz	short loc_4074B6
		jmp	short loc_4074C0
; ---------------------------------------------------------------------------

loc_4074AC:				; CODE XREF: sub_406D2C+777j
		mov	eax, offset aNo_no ; "no_NO"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4074B6:				; CODE XREF: sub_406D2C+77Cj
		mov	eax, offset aNn_no ; "nn_NO"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4074C0:				; CODE XREF: sub_406D2C+77Ej
		mov	eax, offset aNo_1 ; "no"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4074CA:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aOr_in ; jumptable 00406DE8	case 72
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4074D4:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aOm_et ; jumptable 00406DE8	case 114
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4074DE:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aPap_an ; jumptable	00406DE8 case 121
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4074E8:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aPs	; jumptable 00406DE8 case 99
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4074F2:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aPl_pl ; jumptable 00406DE8	case 21
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4074FC:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, [ebp+var_1C] ; jumptable 00406DE8 case 22
		cmp	eax, 1
		jz	short loc_407513
		cmp	eax, 2
		jnz	short loc_40751D
		mov	eax, offset aPt_pt ; "pt_PT"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407513:				; CODE XREF: sub_406D2C+7D6j
		mov	eax, offset aPt_br ; "pt_BR"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40751D:				; CODE XREF: sub_406D2C+7DBj
		mov	eax, offset aPt	; "pt"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407527:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, [ebp+var_1C] ; jumptable 00406DE8 case 70
		cmp	eax, 1
		jnz	short loc_407539
		mov	eax, offset aPa_in ; "pa_IN"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407539:				; CODE XREF: sub_406D2C+801j
		mov	eax, offset aPa	; "pa"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407543:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aRm_ch ; jumptable 00406DE8	case 23
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40754D:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, [ebp+var_1C] ; jumptable 00406DE8 case 24
		cmp	eax, 1
		jnz	short loc_40755F
		mov	eax, offset aRo_ro ; "ro_RO"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40755F:				; CODE XREF: sub_406D2C+827j
		mov	eax, offset aRo	; "ro"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407569:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aRu	; jumptable 00406DE8 case 25
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407573:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aSe_no ; jumptable 00406DE8	case 59
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40757D:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aSa_in ; jumptable 00406DE8	case 79
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407587:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, [ebp+var_1C] ; jumptable 00406DE8 case 89
		test	eax, eax
		jz	short loc_407595
		cmp	eax, 1
		jz	short loc_40759F
		jmp	short loc_4075A9
; ---------------------------------------------------------------------------

loc_407595:				; CODE XREF: sub_406D2C+860j
		mov	eax, offset aSd_in ; "sd_IN"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40759F:				; CODE XREF: sub_406D2C+865j
		mov	eax, offset aSd_pk ; "sd_PK"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4075A9:				; CODE XREF: sub_406D2C+867j
		mov	eax, offset aSd	; "sd"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4075B3:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aSi_lk ; jumptable 00406DE8	case 91
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4075BD:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aSk_sk ; jumptable 00406DE8	case 27
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4075C7:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aSl_si ; jumptable 00406DE8	case 36
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4075D1:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aSo_so ; jumptable 00406DE8	case 119
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4075DB:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aWen_de ; jumptable	00406DE8 case 46
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4075E5:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		cmp	[ebp+var_1C], 14h ; jumptable 00406DE8 case 10
		ja	loc_4076C6	; jumptable 004075FC default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_40D378
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4075FE:				; CODE XREF: sub_406D2C+8D0j
					; DATA XREF: .rdata:off_40D378o
		mov	eax, offset aEs_es ; jumptable 004075FC	case 1
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407608:				; CODE XREF: sub_406D2C+8D0j
					; DATA XREF: .rdata:off_40D378o
		mov	eax, offset aEs_mx ; jumptable 004075FC	case 2
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407612:				; CODE XREF: sub_406D2C+8D0j
					; DATA XREF: .rdata:off_40D378o
		mov	eax, offset aEs_es@modern ; jumptable 004075FC case 3
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40761C:				; CODE XREF: sub_406D2C+8D0j
					; DATA XREF: .rdata:off_40D378o
		mov	eax, offset aEs_gt ; jumptable 004075FC	case 4
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407626:				; CODE XREF: sub_406D2C+8D0j
					; DATA XREF: .rdata:off_40D378o
		mov	eax, offset aEs_cr ; jumptable 004075FC	case 5
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407630:				; CODE XREF: sub_406D2C+8D0j
					; DATA XREF: .rdata:off_40D378o
		mov	eax, offset aEs_pa ; jumptable 004075FC	case 6
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40763A:				; CODE XREF: sub_406D2C+8D0j
					; DATA XREF: .rdata:off_40D378o
		mov	eax, offset aEs_do ; jumptable 004075FC	case 7
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407644:				; CODE XREF: sub_406D2C+8D0j
					; DATA XREF: .rdata:off_40D378o
		mov	eax, offset aEs_ve ; jumptable 004075FC	case 8
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40764E:				; CODE XREF: sub_406D2C+8D0j
					; DATA XREF: .rdata:off_40D378o
		mov	eax, offset aEs_co ; jumptable 004075FC	case 9
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407658:				; CODE XREF: sub_406D2C+8D0j
					; DATA XREF: .rdata:off_40D378o
		mov	eax, offset aEs_pe ; jumptable 004075FC	case 10
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407662:				; CODE XREF: sub_406D2C+8D0j
					; DATA XREF: .rdata:off_40D378o
		mov	eax, offset aEs_ar ; jumptable 004075FC	case 11
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40766C:				; CODE XREF: sub_406D2C+8D0j
					; DATA XREF: .rdata:off_40D378o
		mov	eax, offset aEs_ec ; jumptable 004075FC	case 12
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407676:				; CODE XREF: sub_406D2C+8D0j
					; DATA XREF: .rdata:off_40D378o
		mov	eax, offset aEs_cl ; jumptable 004075FC	case 13
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407680:				; CODE XREF: sub_406D2C+8D0j
					; DATA XREF: .rdata:off_40D378o
		mov	eax, offset aEs_uy ; jumptable 004075FC	case 14
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40768A:				; CODE XREF: sub_406D2C+8D0j
					; DATA XREF: .rdata:off_40D378o
		mov	eax, offset aEs_py ; jumptable 004075FC	case 15
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407694:				; CODE XREF: sub_406D2C+8D0j
					; DATA XREF: .rdata:off_40D378o
		mov	eax, offset aEs_bo ; jumptable 004075FC	case 16
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40769E:				; CODE XREF: sub_406D2C+8D0j
					; DATA XREF: .rdata:off_40D378o
		mov	eax, offset aEs_sv ; jumptable 004075FC	case 17
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4076A8:				; CODE XREF: sub_406D2C+8D0j
					; DATA XREF: .rdata:off_40D378o
		mov	eax, offset aEs_hn ; jumptable 004075FC	case 18
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4076B2:				; CODE XREF: sub_406D2C+8D0j
					; DATA XREF: .rdata:off_40D378o
		mov	eax, offset aEs_ni ; jumptable 004075FC	case 19
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4076BC:				; CODE XREF: sub_406D2C+8D0j
					; DATA XREF: .rdata:off_40D378o
		mov	eax, offset aEs_pr ; jumptable 004075FC	case 20
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4076C6:				; CODE XREF: sub_406D2C+8BDj
					; sub_406D2C+8D0j
					; DATA XREF: ...
		mov	eax, offset aEs	; jumptable 004075FC default case
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4076D0:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aBnt_tz ; jumptable	00406DE8 case 48
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4076DA:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aSw_ke ; jumptable 00406DE8	case 65
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4076E4:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, [ebp+var_1C] ; jumptable 00406DE8 case 29
		cmp	eax, 1
		jz	short loc_4076F3
		cmp	eax, 2
		jz	short loc_4076FD
		jmp	short loc_407707
; ---------------------------------------------------------------------------

loc_4076F3:				; CODE XREF: sub_406D2C+9BEj
		mov	eax, offset aSv_se ; "sv_SE"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4076FD:				; CODE XREF: sub_406D2C+9C3j
		mov	eax, offset aSv_fi ; "sv_FI"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407707:				; CODE XREF: sub_406D2C+9C5j
		mov	eax, offset aSv	; "sv"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407711:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aSyr_tr ; jumptable	00406DE8 case 90
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40771B:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aTl_ph ; jumptable 00406DE8	case 100
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407725:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aTg_tj ; jumptable 00406DE8	case 40
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40772F:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, [ebp+var_1C] ; jumptable 00406DE8 case 95
		cmp	eax, 1
		jz	short loc_40773E
		cmp	eax, 2
		jz	short loc_407748
		jmp	short loc_407752
; ---------------------------------------------------------------------------

loc_40773E:				; CODE XREF: sub_406D2C+A09j
		mov	eax, offset aBer_ma@arabic ; "ber_MA@arabic"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407748:				; CODE XREF: sub_406D2C+A0Ej
		mov	eax, offset aBer_ma@latin ; "ber_MA@latin"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407752:				; CODE XREF: sub_406D2C+A10j
		mov	eax, offset aBer_ma ; "ber_MA"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40775C:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aTa	; jumptable 00406DE8 case 73
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407766:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aTt_ru ; jumptable 00406DE8	case 68
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407770:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aTe_in ; jumptable 00406DE8	case 74
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40777A:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aTh_th ; jumptable 00406DE8	case 30
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_407784:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aBo_cn ; jumptable 00406DE8	case 81
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_40778E:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, [ebp+var_1C] ; jumptable 00406DE8 case 115
		test	eax, eax
		jz	short loc_40779C
		cmp	eax, 1
		jz	short loc_4077A6
		jmp	short loc_4077B0
; ---------------------------------------------------------------------------

loc_40779C:				; CODE XREF: sub_406D2C+A67j
		mov	eax, offset aTi_et ; "ti_ET"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4077A6:				; CODE XREF: sub_406D2C+A6Cj
		mov	eax, offset aTi_er ; "ti_ER"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4077B0:				; CODE XREF: sub_406D2C+A6Ej
		mov	eax, offset aTi	; "ti"
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4077BA:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aTs_za ; jumptable 00406DE8	case 49
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4077C4:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aTn_bw ; jumptable 00406DE8	case 50
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4077CE:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aTr_tr ; jumptable 00406DE8	case 31
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4077D8:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aTk_tm ; jumptable 00406DE8	case 66
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4077E2:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aUk_ua ; jumptable 00406DE8	case 34
		jmp	locret_407871
; ---------------------------------------------------------------------------

loc_4077EC:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, [ebp+var_1C] ; jumptable 00406DE8 case 32
		cmp	eax, 1
		jz	short loc_4077FB
		cmp	eax, 2
		jz	short loc_407802
		jmp	short loc_407809
; ---------------------------------------------------------------------------

loc_4077FB:				; CODE XREF: sub_406D2C+AC6j
		mov	eax, offset aUr_pk ; "ur_PK"
		jmp	short locret_407871
; ---------------------------------------------------------------------------

loc_407802:				; CODE XREF: sub_406D2C+ACBj
		mov	eax, offset aUr_in ; "ur_IN"
		jmp	short locret_407871
; ---------------------------------------------------------------------------

loc_407809:				; CODE XREF: sub_406D2C+ACDj
		mov	eax, offset aUr	; "ur"
		jmp	short locret_407871
; ---------------------------------------------------------------------------

loc_407810:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, [ebp+var_1C] ; jumptable 00406DE8 case 67
		cmp	eax, 1
		jz	short loc_40781F
		cmp	eax, 2
		jz	short loc_407826
		jmp	short loc_40782D
; ---------------------------------------------------------------------------

loc_40781F:				; CODE XREF: sub_406D2C+AEAj
		mov	eax, offset aUz_uz ; "uz_UZ"
		jmp	short locret_407871
; ---------------------------------------------------------------------------

loc_407826:				; CODE XREF: sub_406D2C+AEFj
		mov	eax, offset aUz_uz@cyrillic ; "uz_UZ@cyrillic"
		jmp	short locret_407871
; ---------------------------------------------------------------------------

loc_40782D:				; CODE XREF: sub_406D2C+AF1j
		mov	eax, offset aUz	; "uz"
		jmp	short locret_407871
; ---------------------------------------------------------------------------

loc_407834:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aVen_za ; jumptable	00406DE8 case 51
		jmp	short locret_407871
; ---------------------------------------------------------------------------

loc_40783B:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aVi_vn ; jumptable 00406DE8	case 42
		jmp	short locret_407871
; ---------------------------------------------------------------------------

loc_407842:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aCy_gb ; jumptable 00406DE8	case 82
		jmp	short locret_407871
; ---------------------------------------------------------------------------

loc_407849:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aXh_za ; jumptable 00406DE8	case 52
		jmp	short locret_407871
; ---------------------------------------------------------------------------

loc_407850:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aSit_cn ; jumptable	00406DE8 case 120
		jmp	short locret_407871
; ---------------------------------------------------------------------------

loc_407857:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aYi_il ; jumptable 00406DE8	case 61
		jmp	short locret_407871
; ---------------------------------------------------------------------------

loc_40785E:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aYo_ng ; jumptable 00406DE8	case 106
		jmp	short locret_407871
; ---------------------------------------------------------------------------

loc_407865:				; CODE XREF: sub_406D2C+BCj
					; DATA XREF: .rdata:off_40D090o
		mov	eax, offset aZu_za ; jumptable 00406DE8	case 53
		jmp	short locret_407871
; ---------------------------------------------------------------------------

loc_40786C:				; CODE XREF: sub_406D2C+A9j
					; sub_406D2C+BCj
					; DATA XREF: ...
		mov	eax, offset aC	; jumptable 00406DE8 default case

locret_407871:				; CODE XREF: sub_406D2C+28j
					; sub_406D2C+4Ej ...
		leave
		retn
sub_406D2C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407873	proc near		; CODE XREF: sub_407952+1EAp
					; sub_407952+212p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_0]
		and	eax, 0FF00h
		shl	eax, 8
		or	edx, eax
		mov	eax, [ebp+arg_0]
		shr	eax, 8
		and	eax, 0FF00h
		or	edx, eax
		mov	eax, [ebp+arg_0]
		shr	eax, 18h
		or	eax, edx
		pop	ebp
		retn
sub_407873	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4078A2	proc near		; CODE XREF: sub_408521+5Fp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	[ebp+var_4], 0
		jmp	short loc_4078EB
; ---------------------------------------------------------------------------

loc_4078B7:				; CODE XREF: sub_4078A2+51j
		shl	[ebp+var_4], 4
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		add	[ebp+var_4], eax
		add	[ebp+var_8], 1
		mov	eax, [ebp+var_4]
		and	eax, 0F0000000h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4078EB
		mov	eax, [ebp+var_C]
		shr	eax, 18h
		xor	[ebp+var_4], eax
		mov	eax, [ebp+var_C]
		xor	[ebp+var_4], eax

loc_4078EB:				; CODE XREF: sub_4078A2+13j
					; sub_4078A2+38j
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4078B7
		mov	eax, [ebp+var_4]
		leave
		retn
sub_4078A2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4078FA(void *)
sub_4078FA	proc near		; CODE XREF: .text:00408139p

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_403989
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_403989
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_C], eax
		jmp	short loc_40793F
; ---------------------------------------------------------------------------

loc_407926:				; CODE XREF: sub_4078FA+49j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_403989
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_40793F:				; CODE XREF: sub_4078FA+2Aj
		cmp	[ebp+var_C], 0
		jnz	short loc_407926
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_403989
		leave
		retn
sub_4078FA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407952(char *)
sub_407952	proc near		; CODE XREF: .text:0040810Ap

Filename	= dword	ptr -68h
Mode		= dword	ptr -64h
Count		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= byte ptr -58h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
File		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
DstBuf		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 60h
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	eax, offset aRb	; "rb"
		mov	[esp+68h+Mode],	eax ; Mode
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_40798F
		mov	eax, 0
		jmp	loc_407C86
; ---------------------------------------------------------------------------

loc_40798F:				; CODE XREF: sub_407952+31j
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	_fileno
		lea	edx, [ebp+var_58]
		mov	[esp+68h+Mode],	edx
		mov	[esp+68h+Filename], eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		test	eax, eax
		jnz	short loc_4079D8
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[ebp+var_20], eax
		mov	ecx, [ebp+var_20]
		mov	ebx, 0
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	esi, ebx
		xor	esi, edx
		xor	eax, ecx
		or	eax, esi
		test	eax, eax
		jnz	short loc_4079D8
		cmp	[ebp+var_20], 1Bh
		ja	short loc_4079ED

loc_4079D8:				; CODE XREF: sub_407952+5Bj
					; sub_407952+7Ej
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, 0
		jmp	loc_407C86
; ---------------------------------------------------------------------------

loc_4079ED:				; CODE XREF: sub_407952+84j
		mov	eax, [ebp+var_20]
		add	eax, eax
		cmp	eax, [ebp+var_20]
		jbe	short loc_407A06
		mov	eax, [ebp+var_20]
		add	eax, eax
		mov	[esp+68h+Filename], eax	; size_t
		call	sub_403819
		jmp	short loc_407A0B
; ---------------------------------------------------------------------------

loc_407A06:				; CODE XREF: sub_407952+A3j
		mov	eax, 0

loc_407A0B:				; CODE XREF: sub_407952+B2j
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_407A29
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, 0
		jmp	loc_407C86
; ---------------------------------------------------------------------------

loc_407A29:				; CODE XREF: sub_407952+C0j
		mov	eax, [ebp+var_20]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+DstBuf], eax

loc_407A35:				; CODE XREF: sub_407952+13Fj
		mov	eax, [ebp+DstBuf]
		mov	edx, [ebp+File]
		mov	[esp+68h+var_5C], edx ;	File
		mov	edx, [ebp+var_C]
		mov	[esp+68h+Count], edx ; Count
		mov	[esp+68h+Mode],	1 ; ElementSize
		mov	[esp+68h+Filename], eax	; DstBuf
		call	fread
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_C]
		jnb	short loc_407A81
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_403989
		mov	eax, 0
		jmp	loc_407C86
; ---------------------------------------------------------------------------

loc_407A81:				; CODE XREF: sub_407952+10Dj
		mov	eax, [ebp+var_24]
		add	[ebp+DstBuf], eax
		mov	eax, [ebp+var_24]
		sub	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_407A35
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 950412DEh
		jz	short loc_407ACB
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 0DE120495h
		jz	short loc_407ACB
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_403989
		mov	eax, 0
		jmp	loc_407C86
; ---------------------------------------------------------------------------

loc_407ACB:				; CODE XREF: sub_407952+156j
					; sub_407952+162j
		mov	[esp+68h+Mode],	28h ; size_t
		mov	[esp+68h+Filename], 1 ;	size_t
		call	sub_4038EA
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_407AFD
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_403989
		mov	eax, 0
		jmp	loc_407C86
; ---------------------------------------------------------------------------

loc_407AFD:				; CODE XREF: sub_407952+194j
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_14]
		add	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 950412DEh
		setnz	al
		movzx	edx, al
		mov	eax, [ebp+var_18]
		mov	[eax+8], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_407B43
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[esp+68h+Filename], eax
		call	sub_407873
		jmp	short loc_407B49
; ---------------------------------------------------------------------------

loc_407B43:				; CODE XREF: sub_407952+1DFj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]

loc_407B49:				; CODE XREF: sub_407952+1EFj
		test	eax, eax
		jnz	loc_407C49
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_407B6B
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	[esp+68h+Filename], eax
		call	sub_407873
		jmp	short loc_407B71
; ---------------------------------------------------------------------------

loc_407B6B:				; CODE XREF: sub_407952+207j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]

loc_407B71:				; CODE XREF: sub_407952+217j
		mov	edx, [ebp+var_18]
		mov	[edx+0Ch], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_407B91
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Filename], eax
		call	sub_407873
		jmp	short loc_407B97
; ---------------------------------------------------------------------------

loc_407B91:				; CODE XREF: sub_407952+22Dj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]

loc_407B97:				; CODE XREF: sub_407952+23Dj
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+18h], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_407BBC
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]
		mov	[esp+68h+Filename], eax
		call	sub_407873
		jmp	short loc_407BC2
; ---------------------------------------------------------------------------

loc_407BBC:				; CODE XREF: sub_407952+258j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]

loc_407BC2:				; CODE XREF: sub_407952+268j
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_407BE7
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	[esp+68h+Filename], eax
		call	sub_407873
		jmp	short loc_407BED
; ---------------------------------------------------------------------------

loc_407BE7:				; CODE XREF: sub_407952+283j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]

loc_407BED:				; CODE XREF: sub_407952+293j
		mov	edx, [ebp+var_18]
		mov	[edx+20h], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_407C0D
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	[esp+68h+Filename], eax
		call	sub_407873
		jmp	short loc_407C13
; ---------------------------------------------------------------------------

loc_407C0D:				; CODE XREF: sub_407952+2A9j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]

loc_407C13:				; CODE XREF: sub_407952+2B9j
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+24h], edx
		nop
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Mode],	4 ; size_t
		mov	[esp+68h+Filename], eax	; size_t
		call	sub_4038EA
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_407C83
		jmp	short loc_407C66
; ---------------------------------------------------------------------------

loc_407C49:				; CODE XREF: sub_407952+1F9j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_403989
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_403989
		mov	eax, 0
		jmp	short loc_407C86
; ---------------------------------------------------------------------------

loc_407C66:				; CODE XREF: sub_407952+2F5j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_403989
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_403989
		mov	eax, 0
		jmp	short loc_407C86
; ---------------------------------------------------------------------------

loc_407C83:				; CODE XREF: sub_407952+2F3j
		mov	eax, [ebp+var_18]

loc_407C86:				; CODE XREF: sub_407952+38j
					; sub_407952+96j ...
		add	esp, 60h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_407952	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407C8D(LPCSTR, int, int)
sub_407C8D	proc near		; CODE XREF: sub_407E84+1Ap

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpMultiByteStr	= dword	ptr -30h
cbMultiByte	= dword	ptr -2Ch
lpWideCharStr	= dword	ptr -28h
cchWideChar	= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+cchWideChar], 0 ; cchWideChar
		mov	[esp+38h+lpWideCharStr], 0 ; lpWideCharStr
		mov	[esp+38h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_407CDD
		mov	eax, [ebp+var_C]
		add	eax, 1
		test	eax, eax
		jg	short loc_407CE7

loc_407CDD:				; CODE XREF: sub_407C8D+44j
		mov	eax, 0
		jmp	locret_407D8D
; ---------------------------------------------------------------------------

loc_407CE7:				; CODE XREF: sub_407C8D+4Ej
		mov	eax, [ebp+var_C]
		add	eax, 1
		add	eax, eax
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	edx, eax
		shr	edx, 1
		mov	eax, [ebp+var_C]
		add	eax, 1
		cmp	edx, eax
		jz	short loc_407D17
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0
		jmp	short locret_407D8D
; ---------------------------------------------------------------------------

loc_407D17:				; CODE XREF: sub_407C8D+74j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+CodePage], eax	; size_t
		call	sub_403819
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_407D32
		mov	eax, 0
		jmp	short locret_407D8D
; ---------------------------------------------------------------------------

loc_407D32:				; CODE XREF: sub_407C8D+9Cj
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[esp+38h+cchWideChar], edx ; cchWideChar
		mov	edx, [ebp+var_14]
		mov	[esp+38h+lpWideCharStr], edx ; lpWideCharStr
		mov	[esp+38h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_407D82
		mov	eax, [ebp+var_14]
		mov	[esp+38h+CodePage], eax	; void *
		call	sub_403989
		mov	eax, 0
		jmp	short locret_407D8D
; ---------------------------------------------------------------------------

loc_407D82:				; CODE XREF: sub_407C8D+E1j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_14]

locret_407D8D:				; CODE XREF: sub_407C8D+55j
					; sub_407C8D+88j ...
		leave
		retn
sub_407C8D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407D8F(LPCWSTR, int, int)
sub_407D8F	proc near		; CODE XREF: sub_407E84+3Cp

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpWideCharStr	= dword	ptr -30h
cchWideChar	= dword	ptr -2Ch
lpMultiByteStr	= dword	ptr -28h
cbMultiByte	= dword	ptr -24h
lpDefaultChar	= dword	ptr -20h
lpUsedDefaultChar= dword ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	[esp+38h+cbMultiByte], 0 ; cbMultiByte
		mov	[esp+38h+lpMultiByteStr], 0 ; lpMultiByteStr
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0 ;	CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_407DEF
		mov	eax, [ebp+var_C]
		add	eax, 1
		test	eax, eax
		jg	short loc_407DF9

loc_407DEF:				; CODE XREF: sub_407D8F+54j
		mov	eax, 0
		jmp	locret_407E82
; ---------------------------------------------------------------------------

loc_407DF9:				; CODE XREF: sub_407D8F+5Ej
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+38h+CodePage], eax	; size_t
		call	sub_403819
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_407E17
		mov	eax, 0
		jmp	short locret_407E82
; ---------------------------------------------------------------------------

loc_407E17:				; CODE XREF: sub_407D8F+7Fj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	edx, [ebp+var_C]
		mov	[esp+38h+cbMultiByte], edx ; cbMultiByte
		mov	edx, [ebp+var_10]
		mov	[esp+38h+lpMultiByteStr], edx ;	lpMultiByteStr
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0 ;	CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_407E77
		mov	eax, [ebp+var_10]
		mov	[esp+38h+CodePage], eax	; void *
		call	sub_403989
		mov	eax, 0
		jmp	short locret_407E82
; ---------------------------------------------------------------------------

loc_407E77:				; CODE XREF: sub_407D8F+D4j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_10]

locret_407E82:				; CODE XREF: sub_407D8F+65j
					; sub_407D8F+86j ...
		leave
		retn
sub_407D8F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407E84(LPCSTR, int, int)
sub_407E84	proc near		; CODE XREF: sub_4081B6+12Fp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	LPCSTR
		call	sub_407C8D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_407ED5
		mov	eax, [ebp+var_14]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_20], edx ;	int
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	LPCWSTR
		call	sub_407D8F
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_403989
		jmp	short loc_407EDC
; ---------------------------------------------------------------------------

loc_407ED5:				; CODE XREF: sub_407E84+26j
		mov	[ebp+var_C], 0

loc_407EDC:				; CODE XREF: sub_407E84+4Fj
		cmp	[ebp+var_C], 0
		jz	short loc_407EE7
		mov	eax, [ebp+var_14]
		jmp	short loc_407EEC
; ---------------------------------------------------------------------------

loc_407EE7:				; CODE XREF: sub_407E84+5Cj
		mov	eax, 0

loc_407EEC:				; CODE XREF: sub_407E84+61j
		mov	edx, [ebp+arg_8]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_407E84	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		mov	dword ptr [ebp-10h], 0
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [esp], offset	aLc_messages ; "LC_MESSAGES"
		call	sub_406D2C
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_407F88
		mov	eax, [ebp-14h]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp], eax
		call	sub_403819
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_407F88
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	strcpy
		mov	dword ptr [esp+4], 5Fh
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	strchr
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jz	short loc_407F88
		mov	eax, [ebp-18h]
		mov	byte ptr [eax],	0

loc_407F88:				; CODE XREF: .text:00407F1Fj
					; .text:00407F52j ...
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_407F98
		mov	eax, 0
		jmp	loc_408149
; ---------------------------------------------------------------------------

loc_407F98:				; CODE XREF: .text:00407F8Cj
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	ebx, eax
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 12h
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_403819
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-20h], 0
		jnz	short loc_408028
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_403989
		mov	eax, 0
		jmp	loc_408149
; ---------------------------------------------------------------------------

loc_408028:				; CODE XREF: .text:00408011j
		mov	eax, [ebp-20h]
		mov	[ebp-24h], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	strcpy
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp-24h], eax
		mov	eax, [ebp-24h]
		mov	byte ptr [eax],	5Ch
		add	dword ptr [ebp-24h], 1
		mov	eax, [ebp-0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	strcpy
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp-24h], eax
		mov	edx, offset aLc_messages_0 ; "\\LC_MESSAGES\\"
		mov	eax, [ebp-24h]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		movzx	edx, word ptr [edx+0Ch]
		mov	[eax+0Ch], dx
		add	dword ptr [ebp-24h], 0Dh
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	strcpy
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp-24h], eax
		mov	edx, offset a_mo ; ".mo"
		mov	eax, [ebp-24h]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_407952
		mov	[ebp-10h], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_403989
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_403989
		mov	eax, ds:dword_40E3DC
		test	eax, eax
		jz	short loc_40813E
		mov	eax, ds:dword_40E3DC
		mov	[esp], eax
		call	sub_4078FA

loc_40813E:				; CODE XREF: .text:0040812Fj
		mov	eax, [ebp-10h]
		mov	ds:dword_40E3DC, eax
		mov	eax, [ebp+0Ch]

loc_408149:				; CODE XREF: .text:00407F93j
					; .text:00408023j
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408150(char *, int, int)
sub_408150	proc near		; CODE XREF: sub_4081B6+35Bp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 1
		setnz	al
		movzx	eax, al
		mov	[ebp+var_C], eax
		jmp	short loc_4081AB
; ---------------------------------------------------------------------------

loc_408165:				; CODE XREF: sub_408150+5Fj
		mov	[esp+28h+Val], 0 ; Val
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		cmp	eax, [ebp+var_10]
		ja	short loc_408192
		mov	eax, offset aErrorInGettext ; "ERROR in	GETTEXT	(bad plural entry)"
		jmp	short locret_4081B4
; ---------------------------------------------------------------------------

loc_408192:				; CODE XREF: sub_408150+39j
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+arg_4], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_0], eax
		sub	[ebp+var_C], 1

loc_4081AB:				; CODE XREF: sub_408150+13j
		cmp	[ebp+var_C], 0
		jnz	short loc_408165
		mov	eax, [ebp+arg_0]

locret_4081B4:				; CODE XREF: sub_408150+40j
		leave
		retn
sub_408150	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4081B6	proc near		; CODE XREF: sub_408521+158p
					; sub_408521+27Dp

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, ds:dword_40E3E0
		test	eax, eax
		jz	short loc_408242
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4081F0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_407873
		jmp	short loc_408201
; ---------------------------------------------------------------------------

loc_4081F0:				; CODE XREF: sub_4081B6+1Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_408201:				; CODE XREF: sub_4081B6+38j
		add	eax, ebx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40822A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+38h+Dst], eax
		call	sub_407873
		jmp	short loc_40823A
; ---------------------------------------------------------------------------

loc_40822A:				; CODE XREF: sub_4081B6+58j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_40823A:				; CODE XREF: sub_4081B6+72j
		mov	[ebp+var_14], eax
		jmp	loc_4084F1
; ---------------------------------------------------------------------------

loc_408242:				; CODE XREF: sub_4081B6+Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_408437
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_408284
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_407873
		jmp	short loc_408295
; ---------------------------------------------------------------------------

loc_408284:				; CODE XREF: sub_4081B6+B1j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_408295:				; CODE XREF: sub_4081B6+CCj
		add	eax, ebx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4082BE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+38h+Dst], eax
		call	sub_407873
		jmp	short loc_4082CE
; ---------------------------------------------------------------------------

loc_4082BE:				; CODE XREF: sub_4081B6+ECj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_4082CE:				; CODE XREF: sub_4081B6+106j
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+var_28]
		mov	[esp+38h+Size],	eax ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Src], eax ; int
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dst], eax ; LPCSTR
		call	sub_407E84
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_408306
		mov	[ebp+var_10], offset aErrorInGette_0 ; "ERROR in GETTEXT MALLOC"
		mov	[ebp+var_14], 0
		jmp	loc_408427
; ---------------------------------------------------------------------------

loc_408306:				; CODE XREF: sub_4081B6+13Bj
		mov	eax, [ebp+var_28]
		cmp	eax, [ebp+var_1C]
		ja	loc_408398
		mov	eax, [ebp+var_28]
		cmp	eax, 1
		jbe	short loc_408398
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_408345
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_407873
		jmp	short loc_408356
; ---------------------------------------------------------------------------

loc_408345:				; CODE XREF: sub_4081B6+172j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_408356:				; CODE XREF: sub_4081B6+18Dj
		add	eax, ebx
		mov	[ebp+var_24], eax
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_24]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	edx, eax
		mov	eax, [ebp+var_28]
		mov	[edx], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_14], eax
		jmp	loc_408427
; ---------------------------------------------------------------------------

loc_408398:				; CODE XREF: sub_4081B6+156j
					; sub_4081B6+162j
		mov	eax, [ebp+var_28]
		add	eax, 10h
		mov	[esp+38h+Dst], eax ; size_t
		call	sub_403819
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_408419
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	dword ptr [eax], 1
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		jmp	short loc_408427
; ---------------------------------------------------------------------------

loc_408419:				; CODE XREF: sub_4081B6+1F7j
		mov	[ebp+var_10], offset aErrorInGette_0 ; "ERROR in GETTEXT MALLOC"
		mov	[ebp+var_14], 0

loc_408427:				; CODE XREF: sub_4081B6+14Bj
					; sub_4081B6+1DDj ...
		mov	eax, [ebp+var_20]
		mov	[esp+38h+Dst], eax ; void *
		call	sub_403989
		jmp	loc_4084F1
; ---------------------------------------------------------------------------

loc_408437:				; CODE XREF: sub_4081B6+9Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		cmp	eax, 1
		jnz	short loc_40849D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_C], eax
		jmp	short loc_40846A
; ---------------------------------------------------------------------------

loc_408457:				; CODE XREF: sub_4081B6+2B8j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, [ebp+arg_4]
		jz	short loc_408472
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_40846A:				; CODE XREF: sub_4081B6+29Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_408457
		jmp	short loc_408473
; ---------------------------------------------------------------------------

loc_408472:				; CODE XREF: sub_4081B6+2AAj
		nop

loc_408473:				; CODE XREF: sub_4081B6+2BAj
		cmp	[ebp+var_C], 0
		jz	short loc_40848D
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		jmp	short loc_4084F1
; ---------------------------------------------------------------------------

loc_40848D:				; CODE XREF: sub_4081B6+2C1j
		mov	[ebp+var_10], offset aErrorInGette_1 ; "ERROR in GETTEXT (overflow space)\n"
		mov	[ebp+var_14], 0
		jmp	short loc_4084F1
; ---------------------------------------------------------------------------

loc_40849D:				; CODE XREF: sub_4081B6+294j
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4084C8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_407873
		jmp	short loc_4084D9
; ---------------------------------------------------------------------------

loc_4084C8:				; CODE XREF: sub_4081B6+2F5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_4084D9:				; CODE XREF: sub_4081B6+310j
		add	eax, ebx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_4084F1:				; CODE XREF: sub_4081B6+87j
					; sub_4081B6+27Cj ...
		cmp	[ebp+arg_8], 0
		jz	short loc_408518
		cmp	[ebp+var_14], 0
		jz	short loc_408518
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+Size],	eax ; int
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Src], eax ; int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax ; char *
		call	sub_408150
		jmp	short loc_40851B
; ---------------------------------------------------------------------------

loc_408518:				; CODE XREF: sub_4081B6+33Fj
					; sub_4081B6+345j
		mov	eax, [ebp+var_10]

loc_40851B:				; CODE XREF: sub_4081B6+360j
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_4081B6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408521(char *, int, int)
sub_408521	proc near		; CODE XREF: sub_4087DC+1Cp
					; .text:0040881Bp ...

Str1		= dword	ptr -58h
Str2		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		mov	eax, ds:dword_40E3DC
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	loc_4087B3
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		cmp	eax, 2
		jbe	loc_4086EC
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_4086EC
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax
		call	sub_4078A2
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_18]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_20]
		mov	edx, 0
		div	ecx
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		lea	ecx, [eax-2]
		mov	eax, [ebp+var_20]
		mov	edx, 0
		div	ecx
		mov	eax, edx
		add	eax, 1
		mov	[ebp+var_24], eax
		jmp	loc_4086AB
; ---------------------------------------------------------------------------

loc_4085BB:				; CODE XREF: sub_408521+1C5j
		sub	[ebp+var_28], 1
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_28]
		jbe	loc_408683
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4085F2
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	sub_407873
		jmp	short loc_408602
; ---------------------------------------------------------------------------

loc_4085F2:				; CODE XREF: sub_408521+B5j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_408602:				; CODE XREF: sub_408521+CFj
		cmp	eax, [ebp+var_1C]
		jb	short loc_408683
		mov	eax, [ebp+var_18]
		mov	ebx, [eax]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_408631
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+58h+Str1],	eax
		call	sub_407873
		jmp	short loc_408642
; ---------------------------------------------------------------------------

loc_408631:				; CODE XREF: sub_408521+F3j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_408642:				; CODE XREF: sub_408521+10Ej
		add	eax, ebx
		mov	[esp+58h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_408683
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	eax, al
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str1],	eax
		call	sub_4081B6
		jmp	loc_4087CD
; ---------------------------------------------------------------------------

loc_408683:				; CODE XREF: sub_408521+A7j
					; sub_408521+E4j ...
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		sub	eax, [ebp+var_24]
		cmp	eax, [ebp+var_14]
		ja	short loc_4086A5
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		mov	edx, [ebp+var_24]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+var_14], eax
		jmp	short loc_4086AB
; ---------------------------------------------------------------------------

loc_4086A5:				; CODE XREF: sub_408521+16Ej
		mov	eax, [ebp+var_24]
		add	[ebp+var_14], eax

loc_4086AB:				; CODE XREF: sub_408521+95j
					; sub_408521+182j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4086CF
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	sub_407873
		jmp	short loc_4086DF
; ---------------------------------------------------------------------------

loc_4086CF:				; CODE XREF: sub_408521+192j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]

loc_4086DF:				; CODE XREF: sub_408521+1ACj
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	loc_4085BB

loc_4086EC:				; CODE XREF: sub_408521+23j
					; sub_408521+31j
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_C], eax
		jmp	loc_4087A5
; ---------------------------------------------------------------------------

loc_408701:				; CODE XREF: sub_408521+28Aj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		shr	eax, 1
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_18]
		mov	ebx, [eax]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_408738
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+58h+Str1],	eax
		call	sub_407873
		jmp	short loc_408749
; ---------------------------------------------------------------------------

loc_408738:				; CODE XREF: sub_408521+1FAj
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_408749:				; CODE XREF: sub_408521+215j
		add	eax, ebx
		mov	[esp+58h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jns	short loc_40876B
		mov	eax, [ebp+var_28]
		mov	[ebp+var_C], eax
		jmp	short loc_4087A5
; ---------------------------------------------------------------------------

loc_40876B:				; CODE XREF: sub_408521+240j
		cmp	[ebp+var_2C], 0
		jle	short loc_40877C
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_4087A5
; ---------------------------------------------------------------------------

loc_40877C:				; CODE XREF: sub_408521+24Ej
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	eax, al
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str1],	eax
		call	sub_4081B6
		jmp	short loc_4087CD
; ---------------------------------------------------------------------------

loc_4087A5:				; CODE XREF: sub_408521+1DBj
					; sub_408521+248j ...
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_C]
		jb	loc_408701
		jmp	short loc_4087B4
; ---------------------------------------------------------------------------

loc_4087B3:				; CODE XREF: sub_408521+14j
		nop

loc_4087B4:				; CODE XREF: sub_408521+290j
		cmp	[ebp+arg_4], 0
		jz	short loc_4087CA
		cmp	[ebp+arg_8], 1
		jnz	short loc_4087C5
		mov	eax, [ebp+arg_0]
		jmp	short loc_4087C8
; ---------------------------------------------------------------------------

loc_4087C5:				; CODE XREF: sub_408521+29Dj
		mov	eax, [ebp+arg_4]

loc_4087C8:				; CODE XREF: sub_408521+2A2j
		jmp	short loc_4087CD
; ---------------------------------------------------------------------------

loc_4087CA:				; CODE XREF: sub_408521+297j
		mov	eax, [ebp+arg_0]

loc_4087CD:				; CODE XREF: sub_408521+15Dj
					; sub_408521+282j ...
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_408521	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4087DC(char *)
sub_4087DC	proc near		; CODE XREF: sub_405E70+78p
					; sub_405E70+B8p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_10], 0 ; int
		mov	[esp+18h+var_14], 0 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_408521
		leave
		retn
sub_4087DC	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_408521
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408521
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp], offset	aLc_messages ; "LC_MESSAGES"
		call	sub_406D2C
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_408863
		mov	eax, [ebp-0Ch]
		jmp	short locret_408868
; ---------------------------------------------------------------------------

loc_408863:				; CODE XREF: .text:0040885Cj
		mov	eax, offset byte_40D44F

locret_408868:				; CODE XREF: .text:00408861j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_40E3E0, eax
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION libiconv_open]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION libiconv_close]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION libiconv]
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:00410024o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_4088B0
		cmp	eax, 3
		jz	short loc_4088B0
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_4088B0:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_409AA0
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_401180+113p
					; DATA XREF: .rdata:off_40D48Co ...

lpLibFileName	= dword	ptr -1Ch
lpProcName	= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		mov	edx, ds:_winmajor
		mov	eax, [esp+1Ch+arg_4]
		cmp	dword ptr [edx], 3
		jbe	short loc_408924
		cmp	dword_40B018, 2
		jz	short loc_408906
		mov	dword_40B018, 2

loc_408906:				; CODE XREF: TlsCallback_0+1Aj
		cmp	eax, 2
		jz	loc_408A13
		cmp	eax, 1
		jz	loc_4089B2

loc_408918:				; CODE XREF: TlsCallback_0+EEj
					; TlsCallback_0+13Ej
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_408924:				; CODE XREF: TlsCallback_0+11j
		mov	ds:dword_40E7B8, 1
		mov	[esp+1Ch+lpLibFileName], offset	LibFileName ; "mingwm10.dll"
		call	ds:LoadLibraryA
		sub	esp, 4
		test	eax, eax
		mov	ds:hLibModule, eax
		jz	loc_408A43
		mov	ebx, ds:GetProcAddress
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_rem ; "__mingwthr_remove_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	ds:dword_40E7B4, eax
		mov	eax, ds:hLibModule
		sub	esp, 8
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_key ; "__mingwthr_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	edx, ds:hLibModule
		sub	esp, 8
		test	edx, edx
		mov	ds:dword_40E7B0, eax
		jz	loc_408A43
		mov	ecx, ds:dword_40E7B4
		test	ecx, ecx
		jz	short loc_4089D3
		test	eax, eax
		jz	short loc_4089D3
		mov	dword_40B018, 1
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_4089B2:				; CODE XREF: TlsCallback_0+32j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+lpProcName], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpLibFileName], eax
		call	sub_409AA0
		jmp	loc_408918
; ---------------------------------------------------------------------------

loc_4089D3:				; CODE XREF: TlsCallback_0+B6j
					; TlsCallback_0+BAj
		mov	ds:dword_40E7B0, 0
		mov	ds:dword_40E7B4, 0
		mov	[esp+1Ch+lpLibFileName], edx ; hLibModule
		call	ds:FreeLibrary
		sub	esp, 4

loc_4089F3:				; CODE XREF: TlsCallback_0+177j
		mov	ds:hLibModule, 0
		mov	eax, 1
		mov	dword_40B018, 0
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_408A13:				; CODE XREF: TlsCallback_0+29j
		mov	ebx, offset dword_410030
		cmp	ebx, offset dword_410030
		jz	loc_408918

loc_408A24:				; CODE XREF: TlsCallback_0+155j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_408A2C
		call	eax

loc_408A2C:				; CODE XREF: TlsCallback_0+148j
		add	ebx, 4
		cmp	ebx, offset dword_410030
		jnz	short loc_408A24
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_408A43:				; CODE XREF: TlsCallback_0+65j
					; TlsCallback_0+A8j
		mov	ds:dword_40E7B0, 0
		mov	ds:dword_40E7B4, 0
		jmp	short loc_4089F3
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_408A70	proc near		; DATA XREF: .CRT:00410014o
		mov	eax, ds:__lconv_init
		jmp	eax
sub_408A70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_408A80	proc near		; CODE XREF: sub_408AA0+10p
					; sub_408AA0+36p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_408A80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_408A90	proc near		; CODE XREF: sub_401060+59p
					; sub_408AA0+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_408A90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_408AA0(_onexit_t)
sub_408AA0	proc near		; CODE XREF: sub_408B60+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_40E7C0
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_408A80
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_14], eax
		jz	loc_408B40
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_40E7C0
		mov	[esp+2Ch+Func],	eax
		call	sub_408A80
		mov	[esp+2Ch+var_14], eax
		mov	eax, ds:dword_40E7BC
		mov	[esp+2Ch+Func],	eax
		call	sub_408A80
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_10], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_408A90
		mov	ds:dword_40E7C0, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_408A90
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_40E7BC, eax
		call	_unlock
		add	esp, 28h
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_408B40:				; CODE XREF: sub_408AA0+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_408AA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_408B60(_onexit_t)
sub_408B60	proc near		; CODE XREF: sub_409780-27p
					; sub_40AB20+12p

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_408AA0
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_408B60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LONG __stdcall TopLevelExceptionFilter(struct	_EXCEPTION_POINTERS *ExceptionInfo)
TopLevelExceptionFilter	proc near	; DATA XREF: sub_401180+11Do

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
ExceptionInfo	= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 24h
		mov	ebx, [esp+2Ch+ExceptionInfo]
		mov	eax, [ebx]
		mov	eax, [eax]
		cmp	eax, 0C0000091h
		ja	short loc_408BD7
		cmp	eax, 0C000008Dh
		jb	short loc_408C04

loc_408B9B:				; CODE XREF: TopLevelExceptionFilter+6Aj
		mov	esi, 1

loc_408BA0:				; CODE XREF: TopLevelExceptionFilter+C7j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 8
		call	signal
		cmp	eax, 1
		jz	loc_408CD0
		test	eax, eax
		jz	short loc_408BEC
		mov	[esp+2Ch+var_2C], 8
		call	eax
		mov	eax, 0FFFFFFFFh

loc_408BCF:				; CODE XREF: TopLevelExceptionFilter+120j
					; TopLevelExceptionFilter+13Ej	...
		add	esp, 24h
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_408BD7:				; CODE XREF: TopLevelExceptionFilter+12j
		cmp	eax, 0C0000094h
		jz	short loc_408C45
		cmp	eax, 0C0000096h
		jz	short loc_408C12
		cmp	eax, 0C0000093h
		jz	short loc_408B9B

loc_408BEC:				; CODE XREF: TopLevelExceptionFilter+3Fj
					; TopLevelExceptionFilter+90j ...
		mov	eax, ds:dword_40E40C
		test	eax, eax
		jz	loc_408CC3
		mov	[esp+2Ch+ExceptionInfo], ebx
		add	esp, 24h
		pop	ebx
		pop	esi
		jmp	eax
; ---------------------------------------------------------------------------

loc_408C04:				; CODE XREF: TopLevelExceptionFilter+19j
		cmp	eax, 0C0000005h
		jz	short loc_408C50
		cmp	eax, 0C000001Dh
		jnz	short loc_408BEC

loc_408C12:				; CODE XREF: TopLevelExceptionFilter+63j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 4
		call	signal
		cmp	eax, 1
		jz	short loc_408C87
		test	eax, eax
		jz	short loc_408BEC
		mov	[esp+2Ch+var_2C], 4
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_408C45:				; CODE XREF: TopLevelExceptionFilter+5Cj
		xor	esi, esi
		jmp	loc_408BA0
; ---------------------------------------------------------------------------
		align 10h

loc_408C50:				; CODE XREF: TopLevelExceptionFilter+89j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		cmp	eax, 1
		jz	short loc_408CA5
		test	eax, eax
		jz	loc_408BEC
		mov	[esp+2Ch+var_2C], 0Bh
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_408C87:				; CODE XREF: TopLevelExceptionFilter+A9j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 4
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_408BCF
; ---------------------------------------------------------------------------

loc_408CA5:				; CODE XREF: TopLevelExceptionFilter+E7j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_408BCF
; ---------------------------------------------------------------------------

loc_408CC3:				; CODE XREF: TopLevelExceptionFilter+73j
		xor	eax, eax
		jmp	loc_408BCF
; ---------------------------------------------------------------------------
		align 10h

loc_408CD0:				; CODE XREF: TopLevelExceptionFilter+37j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 8
		call	signal
		test	esi, esi
		mov	eax, 0FFFFFFFFh
		jz	loc_408BCF
		mov	[esp+2Ch+var_10], eax
		call	sub_4096F0
		mov	eax, [esp+2Ch+var_10]
		jmp	loc_408BCF
TopLevelExceptionFilter	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 3Ch
		mov	eax, ds:dword_40E410
		fld	qword ptr [esp+48h]
		fld	qword ptr [esp+50h]
		fld	qword ptr [esp+58h]
		test	eax, eax
		jz	short loc_408D51
		fxch	st(2)
		mov	edx, [esp+40h]
		fstp	qword ptr [esp+18h]
		fstp	qword ptr [esp+20h]
		fstp	qword ptr [esp+28h]
		mov	[esp+10h], edx
		mov	edx, [esp+44h]
		mov	[esp+14h], edx
		lea	edx, [esp+10h]
		mov	[esp], edx
		call	eax ; dword_40E410
		jmp	short loc_408D57
; ---------------------------------------------------------------------------

loc_408D51:				; CODE XREF: .text:00408D26j
		fstp	st
		fstp	st
		fstp	st

loc_408D57:				; CODE XREF: .text:00408D4Fj
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_408D60	proc near		; CODE XREF: sub_401060+F7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ds:dword_40E410, eax
		jmp	__setusermatherr
sub_408D60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_408D70	proc near		; DATA XREF: sub_401060:loc_401150o

File		= dword	ptr -3Ch
Format		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= qword	ptr -2Ch
var_24		= qword	ptr -24h
var_1C		= qword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 3Ch
		mov	edx, offset aUnknownError ; "Unknown error"
		mov	eax, [esp+3Ch+arg_0]
		mov	ecx, [eax]
		sub	ecx, 1
		cmp	ecx, 5
		ja	short loc_408D8D
		mov	edx, ds:off_40D5AC[ecx*4]

loc_408D8D:				; CODE XREF: sub_408D70+14j
		fld	qword ptr [eax+18h]
		fstp	[esp+3Ch+var_1C]
		fld	qword ptr [eax+10h]
		fstp	[esp+3Ch+var_24]
		fld	qword ptr [eax+8]
		fstp	[esp+3Ch+var_2C]
		mov	eax, [eax+4]
		mov	[esp+3Ch+var_34], edx
		mov	[esp+3Ch+Format], offset a_matherrSInSGG ; "_matherr():	%s in %s(%g, %g)  (retval=%"...
		mov	[esp+3Ch+var_30], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+3Ch+File],	eax ; File
		call	fprintf
		xor	eax, eax
		add	esp, 3Ch
		retn
sub_408D70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_408DD0	proc near		; CODE XREF: sub_401060+75p
		xor	eax, eax
		retn
sub_408DD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_408DE0(char *Format, char ArgList)
sub_408DE0	proc near		; CODE XREF: sub_408E40+1DDp
					; sub_408E40+204p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aMingwW64Runtim ;	"Mingw-w64 runtime failure:\n"
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_408DE0	endp

; ---------------------------------------------------------------------------
		jmp	short sub_408E40
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_408E40(size_t Size)
sub_408E40	proc near		; CODE XREF: .text:00408E31j
					; sub_409080+B8p ...

lpAddress	= dword	ptr -7Ch
lpBuffer	= dword	ptr -78h
dwLength	= dword	ptr -74h
lpflOldProtect	= dword	ptr -70h
var_64		= dword	ptr -64h
Src		= dword	ptr -60h
var_58		= _MEMORY_BASIC_INFORMATION ptr	-58h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h

		push	ebp
		mov	ebp, ecx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 6Ch
		mov	ecx, ds:dword_40E41C
		mov	[esp+7Ch+Src], edx
		test	ecx, ecx
		jle	loc_409022
		mov	eax, ds:dword_40E418
		xor	esi, esi

loc_408E64:				; CODE XREF: sub_408E40+41j
		mov	edx, [eax+4]
		cmp	ebx, edx
		jb	short loc_408E79
		mov	edi, [eax+8]
		add	edx, [edi+8]
		cmp	ebx, edx
		jb	loc_408F50

loc_408E79:				; CODE XREF: sub_408E40+29j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jnz	short loc_408E64

loc_408E83:				; CODE XREF: sub_408E40+1E4j
		mov	[esp+7Ch+lpAddress], ebx
		call	sub_409440
		test	eax, eax
		mov	edi, eax
		jz	loc_409049
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_40E418
		shl	edx, 2
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		mov	[esp+7Ch+var_64], edx
		call	sub_409520
		mov	edx, [esp+7Ch+var_64]
		add	eax, [edi+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+7Ch+Buffer]
		mov	esi, ds:VirtualQuery
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_40E418
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+7Ch+var_64]
		jz	loc_409029
		mov	eax, [esp+7Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	loc_408FD1

loc_408EFF:				; CODE XREF: sub_408E40+194j
					; sub_408E40+1C6j
		add	ds:dword_40E41C, 1

loc_408F06:				; CODE XREF: sub_408E40+116j
		lea	eax, [esp+7Ch+var_58]
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	[esp+7Ch+lpAddress], ebx ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_409059
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 4
		jnz	short loc_408F58

loc_408F2F:				; CODE XREF: sub_408E40+11Bj
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy

loc_408F43:				; CODE XREF: sub_408E40+162j
					; sub_408E40+167j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_408F50:				; CODE XREF: sub_408E40+33j
		mov	esi, ds:VirtualQuery
		jmp	short loc_408F06
; ---------------------------------------------------------------------------

loc_408F58:				; CODE XREF: sub_408E40+EDj
		cmp	eax, 40h
		jz	short loc_408F2F
		mov	eax, [esp+7Ch+var_58.RegionSize]
		lea	edi, [esp+7Ch+flOldProtect]
		mov	esi, ds:VirtualProtect
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 40h
		jz	short loc_408F43
		cmp	eax, 4
		jz	short loc_408F43
		mov	eax, [esp+7Ch+flOldProtect]
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], eax	; flNewProtect
		mov	eax, [esp+7Ch+var_58.RegionSize]
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_408FD1:				; CODE XREF: sub_408E40+B9j
		cmp	eax, 40h
		jz	loc_408EFF
		mov	eax, [esp+7Ch+Buffer.RegionSize]
		add	edx, ds:dword_40E418
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+Buffer.BaseAddress]
		mov	[esp+7Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		test	eax, eax
		jnz	loc_408EFF
		call	ds:GetLastError
		mov	[esp+7Ch+lpAddress], offset aVirtualprotect ; "	 VirtualProtect	failed with code 0x%x"
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_408DE0
; ---------------------------------------------------------------------------

loc_409022:				; CODE XREF: sub_408E40+17j
		xor	esi, esi
		jmp	loc_408E83
; ---------------------------------------------------------------------------

loc_409029:				; CODE XREF: sub_408E40+ACj
		mov	eax, ds:dword_40E418
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+dwLength], eax
		mov	eax, [edi+8]
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_408DE0
; ---------------------------------------------------------------------------

loc_409049:				; CODE XREF: sub_408E40+4Fj
		mov	[esp+7Ch+lpBuffer], ebx	; ArgList
		mov	[esp+7Ch+lpAddress], offset aAddressPHasNoI ; "Address %p has no image-section"
		call	sub_408DE0
; ---------------------------------------------------------------------------

loc_409059:				; CODE XREF: sub_408E40+E0j
		mov	[esp+7Ch+dwLength], ebx
		mov	[esp+7Ch+lpBuffer], 1Ch	; ArgList
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		call	sub_408DE0
sub_408E40	endp

; ---------------------------------------------------------------------------
		db 0EBh	; 
		db  0Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409080	proc near		; CODE XREF: sub_401180:loc_401298p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
var_20		= dword	ptr -20h
flOldProtect	= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_40E414
		test	eax, eax
		jz	short loc_4090A0

loc_409092:				; CODE XREF: sub_409080+66j
					; sub_409080+96j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4090A0:				; CODE XREF: sub_409080+10j
		mov	ds:dword_40E414, 1
		call	sub_409480
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_409B40
		mov	ds:dword_40E41C, 0
		sub	esp, eax
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_40E418, eax
		mov	eax, offset dword_40D840
		sub	eax, offset dword_40D840
		cmp	eax, 7
		jle	short loc_409092
		cmp	eax, 0Bh
		mov	ebx, offset dword_40D840
		jle	loc_4091E0
		mov	eax, ds:dword_40D840
		test	eax, eax
		jnz	short loc_409110
		mov	eax, ds:dword_40D844
		test	eax, eax
		jz	loc_4091CC
		lea	esi, [esi+0]

loc_409110:				; CODE XREF: sub_409080+7Dj
					; sub_409080+164j ...
		cmp	ebx, offset dword_40D840
		jnb	loc_409092
		mov	esi, 400000h

loc_409121:				; CODE XREF: sub_409080+C3j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		lea	edx, [ebp+flOldProtect]
		call	sub_408E40
		cmp	ebx, offset dword_40D840
		jb	short loc_409121

loc_409145:				; CODE XREF: sub_409080+24Bj
		mov	ecx, ds:dword_40E41C
		test	ecx, ecx
		jle	loc_409092
		xor	ebx, ebx
		xor	esi, esi
		mov	edi, ds:VirtualQuery
		jmp	short loc_409172
; ---------------------------------------------------------------------------
		align 10h

loc_409160:				; CODE XREF: sub_409080+FDj
					; sub_409080+14Aj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_40E41C
		jge	loc_409092

loc_409172:				; CODE XREF: sub_409080+DDj
		mov	eax, ds:dword_40E418
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_409160
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	edi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_4092F2
		lea	eax, [ebp+flOldProtect]
		mov	[esp+58h+lpflOldProtect], eax ;	lpflOldProtect
		mov	eax, ds:dword_40E418
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_409160
; ---------------------------------------------------------------------------

loc_4091CC:				; CODE XREF: sub_409080+86j
		mov	eax, ds:dword_40D848
		test	eax, eax
		jnz	short loc_4091F5
		mov	ebx, offset dword_40D84C
		lea	esi, [esi+0]

loc_4091E0:				; CODE XREF: sub_409080+70j
		mov	edi, [ebx]
		test	edi, edi
		jnz	loc_409110
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	loc_409110

loc_4091F5:				; CODE XREF: sub_409080+153j
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_409315
		add	ebx, 0Ch
		cmp	ebx, offset dword_40D840
		jnb	loc_409092

loc_409210:				; CODE XREF: sub_409080+245j
		movzx	edx, byte ptr [ebx+8]
		mov	eax, 400000h
		mov	ecx, [ebx]
		add	eax, [ebx+4]
		cmp	edx, 10h
		mov	esi, [ecx+400000h]
		jz	short loc_40926A
		cmp	edx, 20h
		jz	short loc_4092A0
		cmp	edx, 8
		jz	short loc_40924A
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		mov	[ebp+var_20], 0
		call	sub_408DE0
; ---------------------------------------------------------------------------

loc_40924A:				; CODE XREF: sub_409080+1B1j
		movzx	edi, byte ptr [eax]
		test	edi, 80h
		jz	short loc_409275
		or	edi, 0FFFFFF00h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi
		jmp	short loc_409291
; ---------------------------------------------------------------------------

loc_40926A:				; CODE XREF: sub_409080+1A7j
		movzx	edi, word ptr [eax]
		test	edi, 8000h
		jnz	short loc_4092D0

loc_409275:				; CODE XREF: sub_409080+1D3j
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		cmp	edx, 10h
		mov	[ebp+var_20], esi
		jz	short loc_4092E3
		cmp	edx, 20h
		jz	short loc_4092AF
		cmp	edx, 8
		jnz	short loc_4092BC

loc_409291:				; CODE XREF: sub_409080+1E8j
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_20]
		call	sub_408E40
		jmp	short loc_4092BC
; ---------------------------------------------------------------------------

loc_4092A0:				; CODE XREF: sub_409080+1ACj
		mov	edx, [eax]
		sub	edx, ecx
		sub	edx, 400000h
		add	edx, esi
		mov	[ebp+var_20], edx

loc_4092AF:				; CODE XREF: sub_409080+20Aj
		mov	ecx, 4		; Size
		lea	edx, [ebp+var_20]
		call	sub_408E40

loc_4092BC:				; CODE XREF: sub_409080+20Fj
					; sub_409080+21Ej ...
		add	ebx, 0Ch
		cmp	ebx, offset dword_40D840
		jb	loc_409210
		jmp	loc_409145
; ---------------------------------------------------------------------------

loc_4092D0:				; CODE XREF: sub_409080+1F3j
		or	edi, 0FFFF0000h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi

loc_4092E3:				; CODE XREF: sub_409080+205j
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_20]
		call	sub_408E40
		jmp	short loc_4092BC
; ---------------------------------------------------------------------------

loc_4092F2:				; CODE XREF: sub_409080+11Bj
		add	ebx, ds:dword_40E418
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_408DE0
; ---------------------------------------------------------------------------

loc_409315:				; CODE XREF: sub_409080+17Bj
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_408DE0
sub_409080	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409330	proc near		; CODE XREF: .text:004093D1p
					; sub_409440+Ap ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	eax, eax
		cmp	word ptr [edx],	5A4Dh
		jz	short loc_409340

locret_40933D:				; CODE XREF: sub_409330+19j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_409340:				; CODE XREF: sub_409330+Bj
		add	edx, [edx+3Ch]
		cmp	dword ptr [edx], 4550h
		jnz	short locret_40933D
		xor	eax, eax
		cmp	word ptr [edx+18h], 10Bh
		setz	al
		retn
sub_409330	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409360	proc near		; CODE XREF: sub_409440+2Bp
					; .text:00409584p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		xor	eax, eax
		push	ebx
		mov	edx, [esp+8+arg_0]
		mov	ebx, [esp+8+arg_4]
		add	edx, [edx+3Ch]
		movzx	esi, word ptr [edx+6]
		movzx	ecx, word ptr [edx+14h]
		test	esi, esi
		jz	short loc_40939E
		movzx	ecx, cx
		lea	eax, [edx+ecx+18h]
		xor	edx, edx

loc_409384:				; CODE XREF: sub_409360+3Aj
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_409392
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_40939E

loc_409392:				; CODE XREF: sub_409360+29j
		add	edx, 1
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_409384
		xor	eax, eax

loc_40939E:				; CODE XREF: sub_409360+19j
					; sub_409360+30j
		pop	ebx
		pop	esi
		retn
sub_409360	endp

; ---------------------------------------------------------------------------
		jmp	short loc_4093B0
; ---------------------------------------------------------------------------
		align 10h

loc_4093B0:				; CODE XREF: .text:004093A1j
		push	ebp
		push	edi
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 1Ch
		mov	edi, [esp+30h]
		mov	[esp], edi
		call	strlen
		cmp	eax, 8
		ja	short loc_409423
		mov	dword ptr [esp], 400000h
		call	sub_409330
		test	eax, eax
		jz	short loc_409423
		mov	eax, ds:40003Ch
		movzx	ebp, word ptr [eax+400006h]
		movzx	edx, word ptr [eax+400014h]
		add	eax, 400000h
		test	ebp, ebp
		jz	short loc_409423
		movzx	edx, dx
		xor	esi, esi
		lea	ebx, [eax+edx+18h]
		jmp	short loc_40940B
; ---------------------------------------------------------------------------

loc_409401:				; CODE XREF: .text:00409421j
		add	esi, 1
		add	ebx, 28h
		cmp	esi, ebp
		jnb	short loc_409430

loc_40940B:				; CODE XREF: .text:004093FFj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], edi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jnz	short loc_409401

loc_409423:				; CODE XREF: .text:004093C8j
					; .text:004093D8j ...
		add	esp, 1Ch
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_409430:				; CODE XREF: .text:00409409j
		add	esp, 1Ch
		xor	ebx, ebx
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409440	proc near		; CODE XREF: sub_408E40+46p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	[esp+8+var_8], 400000h
		call	sub_409330
		mov	edx, eax
		xor	eax, eax
		test	edx, edx
		jz	short loc_409470
		mov	eax, [esp+8+arg_0]
		mov	[esp+8+var_8], 400000h
		sub	eax, 400000h
		mov	[esp+8+var_4], eax
		call	sub_409360

loc_409470:				; CODE XREF: sub_409440+15j
		add	esp, 8
		retn
sub_409440	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409480	proc near		; CODE XREF: sub_409080+2Ap

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_409330
		xor	edx, edx
		test	eax, eax
		jz	short loc_4094A1
		mov	eax, ds:40003Ch
		movzx	edx, word ptr [eax+400006h]

loc_4094A1:				; CODE XREF: sub_409480+13j
		mov	eax, edx
		add	esp, 4
		retn
sub_409480	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 4
		mov	dword ptr [esp], 400000h
		mov	ebx, [esp+10h]
		call	sub_409330
		xor	edx, edx
		test	eax, eax
		jz	short loc_409509
		mov	eax, ds:40003Ch
		movzx	ecx, word ptr [eax+400006h]
		movzx	esi, word ptr [eax+400014h]
		add	eax, 400000h
		test	ecx, ecx
		jz	short loc_409509
		movzx	esi, si
		lea	edx, [eax+esi+18h]
		xor	eax, eax

loc_4094F0:				; CODE XREF: .text:00409505j
		test	byte ptr [edx+27h], 20h
		jz	short loc_4094FD
		test	ebx, ebx
		jz	short loc_409509
		sub	ebx, 1

loc_4094FD:				; CODE XREF: .text:004094F4j
		add	eax, 1
		add	edx, 28h
		cmp	eax, ecx
		jb	short loc_4094F0
		xor	edx, edx

loc_409509:				; CODE XREF: .text:004094C9j
					; .text:004094E5j ...
		add	esp, 4
		mov	eax, edx
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_409520
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409520	proc near		; CODE XREF: sub_408E40+70p
					; .text:00409511j

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_409330
		xor	edx, edx
		test	eax, eax
		mov	eax, 400000h
		cmovnz	edx, eax
		add	esp, 4
		mov	eax, edx
		retn
sub_409520	endp

; ---------------------------------------------------------------------------
		jmp	short loc_409550
; ---------------------------------------------------------------------------
		align 10h

loc_409550:				; CODE XREF: .text:00409541j
		push	ebx
		xor	ebx, ebx
		sub	esp, 8
		mov	dword ptr [esp], 400000h
		call	sub_409330
		test	eax, eax
		jnz	short loc_409570

loc_409566:				; CODE XREF: .text:0040958Bj
		add	esp, 8
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_409570:				; CODE XREF: .text:00409564j
		mov	eax, [esp+10h]
		mov	dword ptr [esp], 400000h
		sub	eax, 400000h
		mov	[esp+4], eax
		call	sub_409360
		test	eax, eax
		jz	short loc_409566
		mov	ebx, [eax+24h]
		add	esp, 8
		not	ebx
		shr	ebx, 1Fh
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4095A0	proc near		; CODE XREF: sub_409630+1Ap

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	edi
		xor	edi, edi
		push	esi
		push	ebx
		sub	esp, 8
		mov	[esp+14h+var_14], 400000h
		mov	ebx, [esp+14h+arg_0]
		call	sub_409330
		test	eax, eax
		jz	short loc_409611
		mov	eax, ds:40003Ch
		mov	esi, [eax+400080h]
		test	esi, esi
		jz	short loc_409611
		mov	[esp+14h+var_10], esi
		mov	[esp+14h+var_14], 400000h
		call	sub_409360
		test	eax, eax
		jz	short loc_409611
		add	esi, 400000h
		jnz	short loc_4095F6
		jmp	short loc_409611
; ---------------------------------------------------------------------------
		align 10h

loc_4095F0:				; CODE XREF: sub_4095A0+66j
		sub	ebx, 1
		add	esi, 14h

loc_4095F6:				; CODE XREF: sub_4095A0+45j
		mov	edx, [esi+4]
		test	edx, edx
		jnz	short loc_409604
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_409620

loc_409604:				; CODE XREF: sub_4095A0+5Bj
		test	ebx, ebx
		jg	short loc_4095F0
		mov	edi, [esi+0Ch]
		add	edi, 400000h

loc_409611:				; CODE XREF: sub_4095A0+1Aj
					; sub_4095A0+29j ...
		add	esp, 8
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_409620:				; CODE XREF: sub_4095A0+62j
		add	esp, 8
		xor	edi, edi
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_4095A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409630	proc near		; CODE XREF: sub_401180+132p

lpModuleName	= dword	ptr -1Ch

		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_40E420
		test	eax, eax
		jz	short loc_409642

loc_40963D:				; CODE XREF: sub_409630+97j
					; sub_409630+B5j
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_409642:				; CODE XREF: sub_409630+Bj
		xor	eax, eax

loc_409644:				; CODE XREF: sub_409630+82j
		mov	[esp+1Ch+lpModuleName],	eax
		lea	ebx, [eax+1]
		call	sub_4095A0
		test	eax, eax
		jz	short loc_4096D0
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_409660
		cmp	dl, 6Dh
		jnz	short loc_4096B0

loc_409660:				; CODE XREF: sub_409630+29j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_40966E
		cmp	dl, 73h
		jnz	short loc_4096B0

loc_40966E:				; CODE XREF: sub_409630+37j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_40967C
		cmp	dl, 76h
		jnz	short loc_4096B0

loc_40967C:				; CODE XREF: sub_409630+45j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_40968A
		cmp	dl, 63h
		jnz	short loc_4096B0

loc_40968A:				; CODE XREF: sub_409630+53j
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_409698
		cmp	dl, 72h
		jnz	short loc_4096B0

loc_409698:				; CODE XREF: sub_409630+61j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_4096B4
		cmp	dl, 74h
		jz	short loc_4096B4
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_4096B4
		xchg	ax, ax

loc_4096B0:				; CODE XREF: sub_409630+2Ej
					; sub_409630+3Cj ...
		mov	eax, ebx
		jmp	short loc_409644
; ---------------------------------------------------------------------------

loc_4096B4:				; CODE XREF: sub_409630+6Fj
					; sub_409630+74j ...
		mov	[esp+1Ch+lpModuleName],	eax ; lpModuleName
		call	ds:GetModuleHandleA
		sub	esp, 4
		test	eax, eax
		mov	ds:dword_40E420, eax
		jnz	loc_40963D
		lea	esi, [esi+0]

loc_4096D0:				; CODE XREF: sub_409630+21j
		mov	[esp+1Ch+lpModuleName],	offset aMsvcrt_dll ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_40E420, eax
		jmp	loc_40963D
sub_409630	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4096F0	proc near		; CODE XREF: sub_401180:loc_4012D8p
					; TopLevelExceptionFilter+175p
		fninit
		retn
sub_4096F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_409700()
sub_409700	proc near		; DATA XREF: sub_409780:loc_409752o
		sub	esp, 0Ch
		mov	eax, off_40B014
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_409727
		xchg	ax, ax

loc_409710:				; CODE XREF: sub_409700+25j
		call	eax
		mov	eax, off_40B014
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_40B014, edx
		test	eax, eax
		jnz	short loc_409710

loc_409727:				; CODE XREF: sub_409700+Cj
		add	esp, 0Ch
		retn
sub_409700	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_409780

loc_409730:				; CODE XREF: sub_409780+1Aj
		push	ebx
		sub	esp, 18h
		mov	ebx, ds:dword_40AB40
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_409763

loc_40973F:				; CODE XREF: sub_409780-9j
		test	ebx, ebx
		jz	short loc_409752

loc_409743:				; CODE XREF: sub_409780-30j
		call	ds:dword_40AB40[ebx*4]
		sub	ebx, 1
		lea	esi, [esi+0]
		jnz	short loc_409743

loc_409752:				; CODE XREF: sub_409780-3Fj
		mov	[esp+1Ch+var_1C], offset sub_409700 ; _onexit_t
		call	sub_408B60
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_409763:				; CODE XREF: sub_409780-43j
		xor	ebx, ebx
		jmp	short loc_409769
; ---------------------------------------------------------------------------

loc_409767:				; CODE XREF: sub_409780-Bj
		mov	ebx, eax

loc_409769:				; CODE XREF: sub_409780-1Bj
		lea	eax, [ebx+1]
		mov	edx, ds:dword_40AB40[eax*4]
		test	edx, edx
		jnz	short loc_409767
		jmp	short loc_40973F
; END OF FUNCTION CHUNK	FOR sub_409780
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409780	proc near		; CODE XREF: sub_401180+239p
					; sub_401920+Fp

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 00409730 SIZE 00000049 BYTES

		mov	ecx, ds:dword_40E424
		test	ecx, ecx
		jz	short loc_409790
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_409790:				; CODE XREF: sub_409780+8j
		mov	ds:dword_40E424, 1
		jmp	short loc_409730
sub_409780	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4097A0	proc near		; CODE XREF: .text:004014BDp start+Dp

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
SystemTimeAsFileTime= _FILETIME	ptr -2Ch
PerformanceCount= LARGE_INTEGER	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_40B03C
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		jz	short loc_4097F0
		not	eax
		mov	dword_40B040, eax

loc_4097D6:				; CODE XREF: sub_4097A0+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4097F0:				; CODE XREF: sub_4097A0+2Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_409862

loc_409852:				; CODE XREF: sub_4097A0+CCj
		mov	dword_40B03C, ebp
		mov	dword_40B040, eax
		jmp	loc_4097D6
; ---------------------------------------------------------------------------

loc_409862:				; CODE XREF: sub_4097A0+B0j
		mov	eax, 44BF19B0h
		mov	ebp, 0BB40E64Fh
		jmp	short loc_409852
sub_4097A0	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_40E504, edx
		mov	ds:dword_40E720, 0C0000409h
		mov	ds:dword_40E724, 1
		mov	ds:dword_40E4F8, eax
		mov	ds:dword_40E72C, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_40E4EC, eax
		mov	eax, dword_40B03C
		mov	[ebp-10h], eax
		mov	eax, dword_40B040
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_40D6D4
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409900	proc near		; CODE XREF: sub_409AA0+79p
					; sub_409AA0:loc_409B32p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_40E79C
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_409955
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		lea	esi, [esi+0]

loc_409930:				; CODE XREF: sub_409900+53j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_40994E
		test	esi, esi
		jz	short loc_40994E
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_40994E:				; CODE XREF: sub_409900+40j
					; sub_409900+44j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_409930

loc_409955:				; CODE XREF: sub_409900+1Fj
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_409900	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 1Ch
		mov	eax, ds:dword_40E780
		mov	[esp+14h], ebx
		xor	ebx, ebx
		mov	[esp+18h], esi
		test	eax, eax
		jnz	short loc_409994

loc_409986:				; CODE XREF: .text:004099FCj
		mov	eax, ebx
		mov	esi, [esp+18h]
		mov	ebx, [esp+14h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_409994:				; CODE XREF: .text:00409984j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		test	eax, eax
		mov	esi, eax
		jz	short loc_4099F7
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	CriticalSection
		mov	[esi], eax
		mov	eax, [esp+24h]
		mov	[esi+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_40E79C
		mov	ds:dword_40E79C, esi
		mov	[esi+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, ebx
		sub	esp, 4
		mov	ebx, [esp+14h]
		mov	esi, [esp+18h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_4099F7:				; CODE XREF: .text:004099ACj
		mov	ebx, 0FFFFFFFFh
		jmp	short loc_409986
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_40E780
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_409A18
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_409A18:				; CODE XREF: .text:00409A0Fj
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:EnterCriticalSection
		mov	edx, ds:dword_40E79C
		sub	esp, 4
		test	edx, edx
		jz	short loc_409A4F
		mov	eax, [edx]
		cmp	eax, ebx
		jnz	short loc_409A48
		jmp	short loc_409A86
; ---------------------------------------------------------------------------
		align 10h

loc_409A40:				; CODE XREF: .text:00409A4Dj
		mov	ecx, [eax]
		cmp	ecx, ebx
		jz	short loc_409A66
		mov	edx, eax

loc_409A48:				; CODE XREF: .text:00409A36j
		mov	eax, [edx+8]
		test	eax, eax
		jnz	short loc_409A40

loc_409A4F:				; CODE XREF: .text:00409A30j
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_409A5F:				; CODE XREF: .text:00409A84j
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_409A66:				; CODE XREF: .text:00409A44j
		mov	ecx, [eax+8]
		mov	[edx+8], ecx

loc_409A6C:				; CODE XREF: .text:00409A90j
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_409A5F
; ---------------------------------------------------------------------------

loc_409A86:				; CODE XREF: .text:00409A38j
		mov	eax, [edx+8]
		mov	ds:dword_40E79C, eax
		mov	eax, edx
		jmp	short loc_409A6C
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409AA0	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+E9p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_409AF0
		jb	short loc_409AC0
		cmp	eax, 3
		jz	short loc_409B10

loc_409AB3:				; CODE XREF: sub_409AA0+31j
					; sub_409AA0+4Dj ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_409AC0:				; CODE XREF: sub_409AA0+Cj
		mov	eax, ds:dword_40E780
		test	eax, eax
		jnz	short loc_409B32

loc_409AC9:				; CODE XREF: sub_409AA0+97j
		mov	eax, ds:dword_40E780
		cmp	eax, 1
		jnz	short loc_409AB3
		mov	ds:dword_40E780, 0
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_409AB3
; ---------------------------------------------------------------------------
		align 10h

loc_409AF0:				; CODE XREF: sub_409AA0+Aj
		mov	eax, ds:dword_40E780
		test	eax, eax
		jz	short loc_409B20

loc_409AF9:				; CODE XREF: sub_409AA0+90j
		mov	ds:dword_40E780, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_409B10:				; CODE XREF: sub_409AA0+11j
		mov	eax, ds:dword_40E780
		test	eax, eax
		jz	short loc_409AB3
		call	sub_409900
		jmp	short loc_409AB3
; ---------------------------------------------------------------------------

loc_409B20:				; CODE XREF: sub_409AA0+57j
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_409AF9
; ---------------------------------------------------------------------------

loc_409B32:				; CODE XREF: sub_409AA0+27j
		call	sub_409900
		jmp	short loc_409AC9
sub_409AA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409B40	proc near		; CODE XREF: sub_401180+19p
					; sub_409080+3Cp

arg_0		= byte ptr  4

		push	ecx
		push	eax
		cmp	eax, 1000h
		lea	ecx, [esp+8+arg_0]
		jb	short loc_409B62

loc_409B4D:				; CODE XREF: sub_409B40+20j
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_409B4D

loc_409B62:				; CODE XREF: sub_409B40+Bj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		pop	eax
		pop	ecx
		retn
sub_409B40	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _strdup]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fileno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fdopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _getpid]
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_409BB0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409BB0	proc near		; CODE XREF: sub_401180+A7p
					; .text:00409BA1j

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_409BB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409BD0	proc near		; CODE XREF: sub_40A050+EDp
					; sub_40A050+2EFp

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4

		push	ebp
		push	edi
		mov	edi, eax
		push	esi
		mov	esi, ecx
		push	ebx
		sub	esp, 14h
		mov	[esp+24h+var_20], edx
		sub	edx, eax
		mov	eax, esi
		sub	eax, [esp+24h+var_20]
		mov	[esp+24h+var_18], edx
		mov	ecx, [esp+24h+arg_0]
		mov	[esp+24h+var_1C], eax
		mov	eax, edx
		sar	edx, 1Fh
		idiv	[esp+24h+var_1C]
		mov	eax, [esp+24h+var_1C]
		test	edx, edx
		mov	ebx, edx
		jnz	short loc_409C0C
		jmp	short loc_409C7D
; ---------------------------------------------------------------------------

loc_409C08:				; CODE XREF: sub_409BD0+45j
		mov	eax, ebx
		mov	ebx, edx

loc_409C0C:				; CODE XREF: sub_409BD0+34j
		mov	edx, eax
		sar	edx, 1Fh
		idiv	ebx
		test	edx, edx
		jnz	short loc_409C08

loc_409C17:				; CODE XREF: sub_409BD0+B1j
		mov	eax, esi
		sub	eax, edi
		mov	edx, eax
		sar	edx, 1Fh
		idiv	ebx
		test	ebx, ebx
		mov	[esp+24h+var_24], eax
		jle	short loc_409C75
		mov	ebp, [esp+24h+var_20]
		add	ebx, ebp
		mov	[esp+24h+var_14], ebx

loc_409C33:				; CODE XREF: sub_409BD0+A3j
		mov	eax, [esp+24h+var_24]
		test	eax, eax
		jle	short loc_409C6C
		mov	edi, [ecx+ebp*4]
		mov	eax, ebp
		xor	edx, edx
		jmp	short loc_409C45
; ---------------------------------------------------------------------------

loc_409C43:				; CODE XREF: sub_409BD0+9Aj
		mov	edi, esi

loc_409C45:				; CODE XREF: sub_409BD0+71j
		mov	esi, [esp+24h+var_1C]
		mov	ebx, eax
		sub	ebx, [esp+24h+var_18]
		add	esi, eax
		cmp	[esp+24h+var_20], eax
		mov	eax, ebx
		cmovg	eax, esi
		add	edx, 1
		lea	ebx, [ecx+eax*4]
		mov	esi, [ebx]
		cmp	edx, [esp+24h+var_24]
		mov	[ebx], edi
		mov	[ecx+ebp*4], esi
		jnz	short loc_409C43

loc_409C6C:				; CODE XREF: sub_409BD0+68j
		add	ebp, 1
		cmp	ebp, [esp+24h+var_14]
		jnz	short loc_409C33

loc_409C75:				; CODE XREF: sub_409BD0+57j
		add	esp, 14h
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_409C7D:				; CODE XREF: sub_409BD0+36j
		mov	ebx, [esp+24h+var_1C]
		jmp	short loc_409C17
sub_409BD0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_409C90(char *, char)
sub_409C90	proc near		; CODE XREF: sub_409D00+152p
					; sub_409D00+1E8p ...

File		= dword	ptr -1Ch
Format		= dword	ptr -18h
ArgList		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:__argv
		mov	ebx, [esp+1Ch+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[esp+1Ch+Format], offset aS ; "%s: "
		mov	[esp+1Ch+ArgList], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fprintf
		test	ebx, ebx
		jz	short loc_409CDD
		lea	eax, [esp+1Ch+arg_4]
		mov	[esp+1Ch+ArgList], eax ; ArgList
		mov	eax, ds:_iob
		mov	[esp+1Ch+Format], ebx ;	Format
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	vfprintf

loc_409CDD:				; CODE XREF: sub_409C90+2Fj
		mov	eax, ds:_iob
		mov	[esp+1Ch+File],	0Ah ; Ch
		add	eax, 40h
		mov	[esp+1Ch+Format], eax ;	File
		call	fputc
		add	esp, 18h
		pop	ebx
		retn
sub_409C90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409D00	proc near		; CODE XREF: sub_40A050+220p
					; sub_40A050+5BBp

Str		= dword	ptr -5Ch
Val		= dword	ptr -58h
MaxCount	= dword	ptr -54h
var_44		= dword	ptr -44h
Str1		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	[esp+5Ch+var_24], edx
		mov	edx, off_40B038
		mov	[esp+5Ch+var_38], ecx
		mov	ecx, dword_40B024
		mov	[esp+5Ch+Val], 3Dh ; Val
		mov	[esp+5Ch+var_20], eax
		mov	[esp+5Ch+Str], edx ; Str
		mov	[esp+5Ch+var_2C], ecx
		add	ecx, 1
		mov	[esp+5Ch+Str1],	edx
		mov	[esp+5Ch+var_28], ecx
		mov	dword_40B024, ecx
		call	strchr
		test	eax, eax
		mov	[esp+5Ch+var_34], eax
		jz	loc_409F20
		mov	ebp, eax
		add	eax, 1
		sub	ebp, [esp+5Ch+Str1]
		mov	[esp+5Ch+var_34], eax

loc_409D5D:				; CODE XREF: sub_409D00+22Ej
		mov	ecx, [esp+5Ch+var_38]
		mov	esi, [ecx]
		test	esi, esi
		jz	loc_409F3E
		mov	ebx, ecx
		xor	edi, edi
		add	ebx, 10h
		mov	[esp+5Ch+var_44], ecx
		mov	[esp+5Ch+var_3C], 0FFFFFFFFh
		mov	[esp+5Ch+var_30], 0
		jmp	short loc_409DB8
; ---------------------------------------------------------------------------

loc_409D88:				; CODE XREF: sub_409D00+F2j
		mov	eax, [esp+5Ch+var_3C]
		mov	ecx, [esp+5Ch+var_44]
		shl	eax, 4
		add	eax, [esp+5Ch+var_38]
		mov	edx, [eax+4]
		cmp	[ecx+4], edx
		jz	short loc_409E00

loc_409D9F:				; CODE XREF: sub_409D00+106j
		mov	[esp+5Ch+var_30], 1

loc_409DA7:				; CODE XREF: sub_409D00+CEj
					; sub_409D00+EBj ...
		mov	[esp+5Ch+var_44], ebx
		add	ebx, 10h
		add	edi, 1
		mov	esi, [ebx-10h]
		test	esi, esi
		jz	short loc_409E20

loc_409DB8:				; CODE XREF: sub_409D00+86j
		mov	edx, [esp+5Ch+Str1]
		mov	[esp+5Ch+MaxCount], ebp	; MaxCount
		mov	[esp+5Ch+Val], esi ; Str2
		mov	[esp+5Ch+Str], edx ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_409DA7
		mov	[esp+5Ch+Str], esi ; Str
		call	strlen
		cmp	eax, ebp
		jz	loc_409E70
		cmp	ebp, 1
		jnz	short loc_409DED
		mov	esi, [esp+5Ch+arg_4]
		test	esi, esi
		jnz	short loc_409DA7

loc_409DED:				; CODE XREF: sub_409D00+E3j
		cmp	[esp+5Ch+var_3C], 0FFFFFFFFh
		jnz	short loc_409D88
		mov	[esp+5Ch+var_3C], edi
		jmp	short loc_409DA7
; ---------------------------------------------------------------------------
		align 10h

loc_409E00:				; CODE XREF: sub_409D00+9Dj
		mov	edx, [eax+8]
		cmp	[ecx+8], edx
		jnz	short loc_409D9F
		mov	edx, [eax+0Ch]
		mov	eax, 1
		cmp	[ecx+0Ch], edx
		cmovz	eax, [esp+5Ch+var_30]
		mov	[esp+5Ch+var_30], eax
		jmp	short loc_409DA7
; ---------------------------------------------------------------------------
		align 10h

loc_409E20:				; CODE XREF: sub_409D00+B6j
		mov	ebx, [esp+5Ch+var_30]
		test	ebx, ebx
		jz	loc_409F33
		mov	ecx, dword_40B028
		test	ecx, ecx
		jz	short loc_409E57
		mov	edx, [esp+5Ch+var_24]
		cmp	byte ptr [edx],	3Ah
		jz	short loc_409E57
		mov	ecx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Val], ebp ; char
		mov	[esp+5Ch+Str], offset aAmbiguousOptio ;	"ambiguous option -- %.*s"
		mov	[esp+5Ch+MaxCount], ecx
		call	sub_409C90

loc_409E57:				; CODE XREF: sub_409D00+134j
					; sub_409D00+13Dj ...
		mov	dword_40B020, 0
		mov	eax, 3Fh

loc_409E66:				; CODE XREF: sub_409D00+1BDj
					; sub_409D00+2EAj ...
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_409E70:				; CODE XREF: sub_409D00+DAj
		mov	[esp+5Ch+var_3C], edi

loc_409E74:				; CODE XREF: sub_409D00+238j
		mov	ebx, [esp+5Ch+var_3C]
		mov	edx, [esp+5Ch+var_34]
		shl	ebx, 4
		add	ebx, [esp+5Ch+var_38]
		test	edx, edx
		setnz	dl
		mov	eax, [ebx+4]
		jnz	short loc_409EBF

loc_409E8D:				; CODE XREF: sub_409D00+1C1j
		lea	ecx, [eax-1]
		cmp	ecx, 1
		jbe	loc_409F7E

loc_409E99:				; CODE XREF: sub_409D00+28Fj
					; sub_409D00+29Dj ...
		mov	edx, [esp+5Ch+arg_0]
		test	edx, edx
		jz	short loc_409EAB
		mov	ecx, [esp+5Ch+var_3C]
		mov	edx, [esp+5Ch+arg_0]
		mov	[edx], ecx

loc_409EAB:				; CODE XREF: sub_409D00+19Fj
		mov	eax, [ebx+8]
		test	eax, eax
		jz	loc_409FE7
		mov	edx, [ebx+0Ch]
		mov	[eax], edx
		xor	eax, eax
		jmp	short loc_409E66
; ---------------------------------------------------------------------------

loc_409EBF:				; CODE XREF: sub_409D00+18Bj
		test	eax, eax
		jnz	short loc_409E8D
		mov	eax, dword_40B028
		test	eax, eax
		jz	short loc_409EED
		mov	edx, [esp+5Ch+var_24]
		cmp	byte ptr [edx],	3Ah
		jz	short loc_409EED
		mov	ecx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Val], ebp ; char
		mov	[esp+5Ch+Str], offset aOptionDoesnTTa ;	"option	doesn't take an argument -- %.*s"
		mov	[esp+5Ch+MaxCount], ecx
		call	sub_409C90

loc_409EED:				; CODE XREF: sub_409D00+1CAj
					; sub_409D00+1D3j
		mov	eax, [ebx+8]
		test	eax, eax
		jz	loc_409FEF
		mov	dword_40B020, 0

loc_409F02:				; CODE XREF: sub_409D00+2E2j
					; sub_409D00+2F7j
		mov	edx, [esp+5Ch+var_24]
		xor	eax, eax
		cmp	byte ptr [edx],	3Ah
		setnz	al
		add	esp, 4Ch
		pop	ebx
		lea	eax, [eax+eax*4+3Ah]
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_409F20:				; CODE XREF: sub_409D00+4Aj
		mov	edx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Str], edx ; Str
		call	strlen
		mov	ebp, eax
		jmp	loc_409D5D
; ---------------------------------------------------------------------------

loc_409F33:				; CODE XREF: sub_409D00+126j
		cmp	[esp+5Ch+var_3C], 0FFFFFFFFh
		jnz	loc_409E74

loc_409F3E:				; CODE XREF: sub_409D00+65j
		mov	ebx, [esp+5Ch+arg_4]
		test	ebx, ebx
		jnz	loc_40A026
		mov	ecx, dword_40B028
		test	ecx, ecx
		jz	loc_409E57
		mov	edx, [esp+5Ch+var_24]
		cmp	byte ptr [edx],	3Ah
		jz	loc_409E57
		mov	ecx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Str], offset aUnknownOptionS ;	"unknown option	-- %s"
		mov	[esp+5Ch+Val], ecx ; char
		call	sub_409C90
		jmp	loc_409E57
; ---------------------------------------------------------------------------

loc_409F7E:				; CODE XREF: sub_409D00+193j
		test	dl, dl
		jz	short loc_409FFC
		mov	ecx, [esp+5Ch+var_34]
		cmp	eax, 1
		mov	ds:Filename, ecx
		jnz	loc_409E99

loc_409F95:				; CODE XREF: sub_409D00+321j
		mov	ebp, ds:Filename
		test	ebp, ebp
		jnz	loc_409E99
		mov	edi, dword_40B028
		test	edi, edi
		jz	short loc_409FCA
		mov	edx, [esp+5Ch+var_24]
		cmp	byte ptr [edx],	3Ah
		jz	short loc_409FCA
		mov	ecx, [esp+5Ch+Str1]
		mov	[esp+5Ch+Str], offset aOptionRequires ;	"option	requires an argument --	%s"
		mov	[esp+5Ch+Val], ecx ; char
		call	sub_409C90

loc_409FCA:				; CODE XREF: sub_409D00+2ABj
					; sub_409D00+2B4j
		mov	esi, [ebx+8]
		test	esi, esi
		jz	short loc_40A03A
		mov	dword_40B020, 0

loc_409FDB:				; CODE XREF: sub_409D00+342j
		sub	dword_40B024, 1
		jmp	loc_409F02
; ---------------------------------------------------------------------------

loc_409FE7:				; CODE XREF: sub_409D00+1B0j
		mov	eax, [ebx+0Ch]
		jmp	loc_409E66
; ---------------------------------------------------------------------------

loc_409FEF:				; CODE XREF: sub_409D00+1F2j
		mov	eax, [ebx+0Ch]
		mov	dword_40B020, eax
		jmp	loc_409F02
; ---------------------------------------------------------------------------

loc_409FFC:				; CODE XREF: sub_409D00+280j
		cmp	eax, 1
		jnz	loc_409E99
		mov	edx, [esp+5Ch+var_28]
		mov	ecx, [esp+5Ch+var_20]
		mov	eax, [ecx+edx*4]
		mov	ds:Filename, eax
		mov	eax, [esp+5Ch+var_2C]
		add	eax, 2
		mov	dword_40B024, eax
		jmp	loc_409F95
; ---------------------------------------------------------------------------

loc_40A026:				; CODE XREF: sub_409D00+244j
		mov	ecx, [esp+5Ch+var_2C]
		mov	eax, 0FFFFFFFFh
		mov	dword_40B024, ecx
		jmp	loc_409E66
; ---------------------------------------------------------------------------

loc_40A03A:				; CODE XREF: sub_409D00+2CFj
		mov	eax, [ebx+0Ch]
		mov	dword_40B020, eax
		jmp	short loc_409FDB
sub_409D00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A050	proc near		; CODE XREF: sub_40A630+24j
					; .text:0040A686j ...

Str		= dword	ptr -4Ch
Val		= dword	ptr -48h
var_30		= dword	ptr -30h
var_2C		= byte ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		test	ecx, ecx
		mov	[esp+4Ch+var_24], eax
		mov	edi, [esp+4Ch+arg_8]
		mov	[esp+4Ch+var_28], edx
		mov	[esp+4Ch+var_20], ecx
		jz	loc_40A382
		mov	ecx, dword_40B024
		test	ecx, ecx
		jz	loc_40A2D0

loc_40A07D:				; CODE XREF: sub_40A050+294j
		cmp	dword_40B02C, 0FFFFFFFFh
		jz	loc_40A290
		mov	edx, ds:dword_40E7DC
		xor	eax, eax
		test	edx, edx
		jnz	loc_40A290
		mov	ecx, [esp+4Ch+var_20]
		movzx	edx, byte ptr [ecx]
		cmp	dl, 2Dh
		jz	loc_40A2BE

loc_40A0AA:				; CODE XREF: sub_40A050+268j
		mov	ebp, dword_40B02C
		test	ebp, ebp
		jnz	loc_40A2F0
		cmp	dl, 2Bh
		jz	loc_40A4A7

loc_40A0C1:				; CODE XREF: sub_40A050+276j
					; sub_40A050+2A6j ...
		test	eax, eax
		mov	ds:Filename, 0
		jz	loc_40A16C
		mov	dword_40B030, 0FFFFFFFFh
		mov	dword_40B034, 0FFFFFFFFh
		jmp	short loc_40A168
; ---------------------------------------------------------------------------
		align 10h

loc_40A0F0:				; CODE XREF: sub_40A050+159j
					; sub_40A050+18Ej
		test	edi, 2
		mov	off_40B038, offset byte_40D6F5
		jnz	loc_40A391
		test	edi, 1
		jz	loc_40A382
		mov	ebx, dword_40B034
		cmp	ebx, 0FFFFFFFFh
		jz	loc_40A306
		mov	esi, dword_40B030
		xor	eax, eax
		cmp	esi, 0FFFFFFFFh
		jz	short loc_40A15F
		mov	edx, [esp+4Ch+var_28]
		mov	eax, ebx
		mov	ecx, ebp
		sub	ebx, esi
		mov	[esp+4Ch+Str], edx
		mov	edx, esi
		call	sub_409BD0
		mov	edx, dword_40B024
		mov	eax, ds:dword_40E7DC
		mov	dword_40B030, 0FFFFFFFFh
		add	ebx, edx
		mov	dword_40B034, ebx

loc_40A15F:				; CODE XREF: sub_40A050+DCj
					; sub_40A050+2BEj
		add	edx, 1
		mov	dword_40B024, edx

loc_40A168:				; CODE XREF: sub_40A050+97j
		test	eax, eax
		jnz	short loc_40A17D

loc_40A16C:				; CODE XREF: sub_40A050+7Dj
		mov	ebx, off_40B038
		movzx	ecx, byte ptr [ebx]
		test	cl, cl
		jnz	loc_40A207

loc_40A17D:				; CODE XREF: sub_40A050+11Aj
		mov	ebp, dword_40B024
		cmp	ebp, [esp+4Ch+var_24]
		mov	ds:dword_40E7DC, 0
		mov	edx, ebp
		jge	loc_40A313
		mov	ecx, [esp+4Ch+var_28]
		mov	ebx, [ecx+ebp*4]
		cmp	byte ptr [ebx],	2Dh
		mov	off_40B038, ebx
		jnz	loc_40A0F0
		movzx	ecx, byte ptr [ebx+1]
		test	cl, cl
		jnz	short loc_40A1E4
		mov	eax, [esp+4Ch+var_20]
		mov	[esp+4Ch+Val], 2Dh ; Val
		mov	[esp+4Ch+var_2C], cl
		mov	[esp+4Ch+var_30], ebp
		mov	[esp+4Ch+Str], eax ; Str
		call	strchr
		mov	edx, [esp+4Ch+var_30]
		movzx	ecx, [esp+4Ch+var_2C]
		test	eax, eax
		jz	loc_40A0F0

loc_40A1E4:				; CODE XREF: sub_40A050+165j
		cmp	dword_40B034, 0FFFFFFFFh
		mov	eax, ebx
		jz	short loc_40A1FC
		cmp	dword_40B030, 0FFFFFFFFh
		jz	loc_40A563

loc_40A1FC:				; CODE XREF: sub_40A050+19Dj
					; sub_40A050+519j
		test	cl, cl
		jnz	loc_40A4F4
		movzx	ecx, byte ptr [ebx]

loc_40A207:				; CODE XREF: sub_40A050+127j
					; sub_40A050+4B0j ...
		mov	esi, [esp+4Ch+arg_0]
		test	esi, esi
		jz	loc_40A3C9
		mov	eax, dword_40B024
		mov	edx, [esp+4Ch+var_28]
		cmp	ebx, [edx+eax*4]
		jz	loc_40A3C9
		cmp	cl, 2Dh
		jz	loc_40A553
		and	edi, 4
		jz	loc_40A3C9
		xor	eax, eax
		cmp	cl, 3Ah
		jz	short loc_40A259
		movsx	ecx, cl
		mov	[esp+4Ch+Val], ecx ; Val
		mov	ecx, [esp+4Ch+var_20]
		mov	[esp+4Ch+Str], ecx ; Str
		call	strchr
		test	eax, eax
		setnz	al
		movzx	eax, al

loc_40A259:				; CODE XREF: sub_40A050+1ECj
					; sub_40A050+50Ej
		mov	[esp+4Ch+Val], eax
		mov	eax, [esp+4Ch+arg_4]
		mov	ecx, [esp+4Ch+arg_0]
		mov	edx, [esp+4Ch+var_20]
		mov	[esp+4Ch+Str], eax
		mov	eax, [esp+4Ch+var_28]
		call	sub_409D00
		cmp	eax, 0FFFFFFFFh
		mov	esi, eax
		jz	loc_40A3C0

loc_40A280:				; CODE XREF: sub_40A050+5C2j
		mov	off_40B038, offset byte_40D6F5
		jmp	loc_40A387
; ---------------------------------------------------------------------------
		align 10h

loc_40A290:				; CODE XREF: sub_40A050+34j
					; sub_40A050+44j
		mov	[esp+4Ch+Str], offset aPosixly_correc ;	"POSIXLY_CORRECT"
		call	getenv
		mov	ecx, [esp+4Ch+var_20]
		movzx	edx, byte ptr [ecx]
		test	eax, eax
		setnz	al
		movzx	eax, al
		cmp	dl, 2Dh
		mov	dword_40B02C, eax
		mov	eax, ds:dword_40E7DC
		jnz	loc_40A0AA

loc_40A2BE:				; CODE XREF: sub_40A050+54j
		or	edi, 2
		add	[esp+4Ch+var_20], 1
		jmp	loc_40A0C1
; ---------------------------------------------------------------------------
		align 10h

loc_40A2D0:				; CODE XREF: sub_40A050+27j
		mov	ds:dword_40E7DC, 1
		mov	dword_40B024, 1
		jmp	loc_40A07D
; ---------------------------------------------------------------------------
		align 10h

loc_40A2F0:				; CODE XREF: sub_40A050+62j
		and	edi, 0FFFFFFFEh
		cmp	dl, 2Bh
		jnz	loc_40A0C1
		add	[esp+4Ch+var_20], 1
		jmp	loc_40A0C1
; ---------------------------------------------------------------------------

loc_40A306:				; CODE XREF: sub_40A050+CBj
		mov	dword_40B034, ebp
		xor	eax, eax
		jmp	loc_40A15F
; ---------------------------------------------------------------------------

loc_40A313:				; CODE XREF: sub_40A050+143j
		mov	ebx, dword_40B030
		mov	off_40B038, offset byte_40D6F5
		cmp	ebx, 0FFFFFFFFh
		jz	loc_40A3AF
		mov	edx, [esp+4Ch+var_28]
		mov	ecx, ebp
		mov	esi, dword_40B034
		mov	[esp+4Ch+Str], edx

loc_40A33B:				; CODE XREF: sub_40A050+4EFj
		mov	eax, esi
		mov	edx, ebx
		call	sub_409BD0
		sub	esi, ebx
		add	dword_40B024, esi

loc_40A34C:				; CODE XREF: sub_40A050+367j
					; sub_40A050+36Ej ...
		mov	esi, 0FFFFFFFFh
		mov	dword_40B030, 0FFFFFFFFh
		mov	eax, esi
		mov	dword_40B034, 0FFFFFFFFh
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40A36F:				; CODE XREF: sub_40A050+3A9j
		cmp	esi, 2Dh
		jnz	loc_40A4B4
		cmp	byte ptr [ebx+1], 0
		jnz	loc_40A4C1

loc_40A382:				; CODE XREF: sub_40A050+19j
					; sub_40A050+BCj
		mov	esi, 0FFFFFFFFh

loc_40A387:				; CODE XREF: sub_40A050+23Aj
					; sub_40A050+3CDj ...
		add	esp, 3Ch
		mov	eax, esi
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40A391:				; CODE XREF: sub_40A050+B0j
		add	ebp, 1
		mov	esi, 1
		mov	ds:Filename, ebx
		mov	eax, esi
		mov	dword_40B024, ebp
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40A3AF:				; CODE XREF: sub_40A050+2D6j
		mov	eax, dword_40B034
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40A34C
		mov	dword_40B024, eax
		jmp	short loc_40A34C
; ---------------------------------------------------------------------------

loc_40A3C0:				; CODE XREF: sub_40A050+22Aj
		mov	ebx, off_40B038
		movzx	ecx, byte ptr [ebx]

loc_40A3C9:				; CODE XREF: sub_40A050+1BDj
					; sub_40A050+1CFj ...
		movsx	esi, cl
		lea	edi, [ebx+1]
		cmp	esi, 3Ah
		mov	off_40B038, edi
		jz	loc_40A4B4
		cmp	esi, 2Dh
		jz	loc_40A544

loc_40A3E7:				; CODE XREF: sub_40A050+4FEj
		mov	ecx, [esp+4Ch+var_20]
		mov	[esp+4Ch+Val], esi ; Val
		mov	[esp+4Ch+Str], ecx ; Str
		call	strchr
		test	eax, eax
		jz	loc_40A36F
		cmp	esi, 57h
		movzx	edx, byte ptr [eax+1]
		jnz	short loc_40A410
		mov	ecx, [esp+4Ch+arg_0]
		test	ecx, ecx
		jnz	short loc_40A42F

loc_40A410:				; CODE XREF: sub_40A050+3B6j
					; sub_40A050+3E2j
		cmp	dl, 3Ah
		jz	loc_40A56E
		cmp	byte ptr [ebx+1], 0
		jnz	loc_40A387

loc_40A423:				; CODE XREF: sub_40A050+53Ej
		add	dword_40B024, 1
		jmp	loc_40A387
; ---------------------------------------------------------------------------

loc_40A42F:				; CODE XREF: sub_40A050+3BEj
		cmp	dl, 3Bh
		jnz	short loc_40A410
		cmp	byte ptr [ebx+1], 0
		jnz	loc_40A5F0
		mov	eax, dword_40B024
		add	eax, 1
		cmp	[esp+4Ch+var_24], eax
		mov	dword_40B024, eax
		jg	loc_40A5E4
		mov	ebp, dword_40B028
		mov	off_40B038, offset byte_40D6F5
		test	ebp, ebp
		jz	short loc_40A486
		mov	ecx, [esp+4Ch+var_20]
		cmp	byte ptr [ecx],	3Ah
		jz	short loc_40A486
		mov	[esp+4Ch+Val], 57h ; char
		mov	[esp+4Ch+Str], offset aOptionRequir_0 ;	"option	requires an argument --	%c"
		call	sub_409C90

loc_40A486:				; CODE XREF: sub_40A050+417j
					; sub_40A050+420j
		mov	dword_40B020, 57h

loc_40A490:				; CODE XREF: sub_40A050+58Fj
		mov	ecx, [esp+4Ch+var_20]
		xor	eax, eax
		cmp	byte ptr [ecx],	3Ah
		setnz	al
		mov	esi, eax
		lea	esi, [esi+esi*4+3Ah]
		jmp	loc_40A387
; ---------------------------------------------------------------------------

loc_40A4A7:				; CODE XREF: sub_40A050+6Bj
		and	edi, 0FFFFFFFEh
		add	[esp+4Ch+var_20], 1
		jmp	loc_40A0C1
; ---------------------------------------------------------------------------

loc_40A4B4:				; CODE XREF: sub_40A050+322j
					; sub_40A050+388j
		cmp	byte ptr [ebx+1], 0
		jnz	short loc_40A4C1
		add	dword_40B024, 1

loc_40A4C1:				; CODE XREF: sub_40A050+32Cj
					; sub_40A050+468j ...
		mov	ebx, dword_40B028
		test	ebx, ebx
		jz	short loc_40A4E4
		mov	ecx, [esp+4Ch+var_20]
		cmp	byte ptr [ecx],	3Ah
		jz	short loc_40A4E4
		mov	[esp+4Ch+Val], esi ; char
		mov	[esp+4Ch+Str], offset aUnknownOptionC ;	"unknown option	-- %c"
		call	sub_409C90

loc_40A4E4:				; CODE XREF: sub_40A050+479j
					; sub_40A050+482j
		mov	dword_40B020, esi
		mov	esi, 3Fh
		jmp	loc_40A387
; ---------------------------------------------------------------------------

loc_40A4F4:				; CODE XREF: sub_40A050+1AEj
		add	ebx, 1
		cmp	cl, 2Dh
		mov	off_40B038, ebx
		jnz	loc_40A207
		cmp	byte ptr [eax+2], 0
		jnz	loc_40A207
		mov	ebx, dword_40B030
		lea	ecx, [ebp+1]
		mov	dword_40B024, ecx
		mov	off_40B038, offset byte_40D6F5
		cmp	ebx, 0FFFFFFFFh
		jz	loc_40A34C
		mov	edx, [esp+4Ch+var_28]
		mov	esi, dword_40B034
		mov	[esp+4Ch+Str], edx
		jmp	loc_40A33B
; ---------------------------------------------------------------------------

loc_40A544:				; CODE XREF: sub_40A050+391j
		cmp	byte ptr [ebx+1], 0
		jnz	loc_40A4C1
		jmp	loc_40A3E7
; ---------------------------------------------------------------------------

loc_40A553:				; CODE XREF: sub_40A050+1D8j
		add	ebx, 1
		xor	eax, eax
		mov	off_40B038, ebx
		jmp	loc_40A259
; ---------------------------------------------------------------------------

loc_40A563:				; CODE XREF: sub_40A050+1A6j
		mov	dword_40B030, ebp
		jmp	loc_40A1FC
; ---------------------------------------------------------------------------

loc_40A56E:				; CODE XREF: sub_40A050+3C3j
		mov	ds:Filename, 0
		cmp	byte ptr [ebx+1], 0
		jz	short loc_40A593
		mov	ds:Filename, edi

loc_40A584:				; CODE XREF: sub_40A050+547j
					; sub_40A050+5D3j
		mov	off_40B038, offset byte_40D6F5
		jmp	loc_40A423
; ---------------------------------------------------------------------------

loc_40A593:				; CODE XREF: sub_40A050+52Cj
		cmp	byte ptr [eax+2], 3Ah
		jz	short loc_40A584
		mov	eax, dword_40B024
		add	eax, 1
		cmp	[esp+4Ch+var_24], eax
		mov	dword_40B024, eax
		jg	short loc_40A617
		mov	edi, dword_40B028
		mov	off_40B038, offset byte_40D6F5
		test	edi, edi
		jz	short loc_40A5D9
		mov	ecx, [esp+4Ch+var_20]
		cmp	byte ptr [ecx],	3Ah
		jz	short loc_40A5D9
		mov	[esp+4Ch+Val], esi ; char
		mov	[esp+4Ch+Str], offset aOptionRequir_0 ;	"option	requires an argument --	%c"
		call	sub_409C90

loc_40A5D9:				; CODE XREF: sub_40A050+56Ej
					; sub_40A050+577j
		mov	dword_40B020, esi
		jmp	loc_40A490
; ---------------------------------------------------------------------------

loc_40A5E4:				; CODE XREF: sub_40A050+3FFj
		mov	edx, [esp+4Ch+var_28]
		mov	eax, [edx+eax*4]
		mov	off_40B038, eax

loc_40A5F0:				; CODE XREF: sub_40A050+3E8j
		mov	ecx, [esp+4Ch+arg_4]
		mov	edx, [esp+4Ch+var_20]
		mov	eax, [esp+4Ch+var_28]
		mov	[esp+4Ch+Val], 0
		mov	[esp+4Ch+Str], ecx
		mov	ecx, [esp+4Ch+arg_0]
		call	sub_409D00
		mov	esi, eax
		jmp	loc_40A280
; ---------------------------------------------------------------------------

loc_40A617:				; CODE XREF: sub_40A050+55Aj
		mov	edx, [esp+4Ch+var_28]
		mov	eax, [edx+eax*4]
		mov	ds:Filename, eax
		jmp	loc_40A584
sub_40A050	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A630	proc near		; CODE XREF: sub_401920+1EDp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_8]
		mov	[esp+arg_4], 0
		mov	[esp+arg_8], 0
		mov	[esp+arg_0], 0
		jmp	sub_40A050
sub_40A630	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		mov	ebx, [esp+18h]
		mov	edx, [esp+0Ch]
		mov	eax, [esp+8]
		mov	ecx, [esp+10h]
		mov	[esp+0Ch], ebx
		mov	ebx, [esp+14h]
		mov	dword ptr [esp+10h], 1
		mov	[esp+8], ebx
		pop	ebx
		jmp	sub_40A050
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		mov	ebx, [esp+18h]
		mov	edx, [esp+0Ch]
		mov	eax, [esp+8]
		mov	ecx, [esp+10h]
		mov	[esp+0Ch], ebx
		mov	ebx, [esp+14h]
		mov	dword ptr [esp+10h], 5
		mov	[esp+8], ebx
		pop	ebx
		jmp	sub_40A050
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame fpd=222h

sub_40A6C0	proc near		; CODE XREF: sub_40A8A0+A6p

Size		= dword	ptr -348h
lpFilename	= dword	ptr -344h
nSize		= dword	ptr -340h
uType		= dword	ptr -33Ch
var_338		= dword	ptr -338h
var_334		= dword	ptr -334h
Filename	= byte ptr -327h
var_323		= dword	ptr -323h
var_31F		= word ptr -31Fh
var_223		= byte ptr -223h
var_222		= word ptr -222h
var_11D		= dword	ptr -11Dh
var_119		= dword	ptr -119h
var_115		= word ptr -115h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 33Ch
		mov	esi, [esp+348h+arg_0]
		lea	ebp, [esp+126h]
		mov	ebx, [esp+348h+arg_4]
		mov	[esp+348h+Size], 2000h ; Size
		call	malloc
		test	esi, esi
		lea	ecx, [esi+208h]
		mov	edi, eax
		mov	eax, ebp
		jnz	short loc_40A70C
		jmp	short loc_40A714
; ---------------------------------------------------------------------------
		align 10h

loc_40A700:				; CODE XREF: sub_40A6C0+52j
		add	esi, 2
		mov	[eax], dl
		add	eax, 1
		cmp	esi, ecx
		jz	short loc_40A714

loc_40A70C:				; CODE XREF: sub_40A6C0+37j
		movzx	edx, word ptr [esi]
		test	dx, dx
		jnz	short loc_40A700

loc_40A714:				; CODE XREF: sub_40A6C0+39j
					; sub_40A6C0+4Aj
		lea	esi, [esp+348h+var_11D]
		test	ebx, ebx
		mov	byte ptr [eax],	0
		lea	ecx, [ebx+208h]
		mov	eax, esi
		jnz	short loc_40A73C
		jmp	short loc_40A744
; ---------------------------------------------------------------------------
		align 10h

loc_40A730:				; CODE XREF: sub_40A6C0+82j
		add	ebx, 2
		mov	[eax], dl
		add	eax, 1
		cmp	ebx, ecx
		jz	short loc_40A744

loc_40A73C:				; CODE XREF: sub_40A6C0+68j
		movzx	edx, word ptr [ebx]
		test	dx, dx
		jnz	short loc_40A730

loc_40A744:				; CODE XREF: sub_40A6C0+6Aj
					; sub_40A6C0+7Aj
		mov	byte ptr [eax],	0
		cmp	byte ptr [esp+348h+var_11D], 0
		jz	loc_40A800
		cmp	byte ptr [esp+348h+var_222], 0
		jz	loc_40A82E

loc_40A763:				; CODE XREF: sub_40A6C0+168j
					; sub_40A6C0+178j
		lea	ebx, [esp+348h+Filename]
		mov	[esp+348h+var_223], 0
		mov	[esp+348h+nSize], 104h ; nSize
		mov	[esp+348h+lpFilename], ebx ; lpFilename
		mov	[esp+348h+Size], 0 ; hModule
		call	ds:GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_40A840

loc_40A793:				; CODE XREF: sub_40A6C0+197j
		mov	eax, [esp+348h+arg_8]
		mov	[esp+348h+var_334], ebp
		mov	[esp+348h+uType], esi
		mov	[esp+348h+nSize], ebx
		mov	[esp+348h+var_338], eax
		mov	[esp+348h+lpFilename], offset aAssertionFaile ;	"Assertion failed!\n\nProgram: %s\nFile:"...
		mov	[esp+348h+Size], edi ; Dest
		call	sprintf
		mov	eax, ds:dword_40E404
		test	eax, eax
		jz	loc_40A879
		mov	[esp+348h+uType], 12012h ; uType
		mov	[esp+348h+nSize], offset Caption ; "MinGW Runtime Assertion"
		mov	[esp+348h+lpFilename], edi ; lpText
		mov	[esp+348h+Size], 0 ; hWnd
		call	ds:MessageBoxA
		sub	esp, 10h
		cmp	eax, 3
		jz	short loc_40A861
		cmp	eax, 5
		jnz	short loc_40A85C
		add	esp, 33Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_40A800:				; CODE XREF: sub_40A6C0+8Fj
		cmp	byte ptr [esp+348h+var_222], 0
		mov	[esp+348h+var_11D], 6B6E753Ch
		mov	[esp+348h+var_119], 6E776F6Eh
		mov	[esp+348h+var_115], 3Eh
		jnz	loc_40A763

loc_40A82E:				; CODE XREF: sub_40A6C0+9Dj
		mov	[esp+348h+var_222], 3Fh
		jmp	loc_40A763
; ---------------------------------------------------------------------------
		align 10h

loc_40A840:				; CODE XREF: sub_40A6C0+CDj
		mov	dword ptr [esp+348h+Filename], 6B6E753Ch
		mov	[esp+348h+var_323], 6E776F6Eh
		mov	[esp+348h+var_31F], 3Eh
		jmp	loc_40A793
; ---------------------------------------------------------------------------

loc_40A85C:				; CODE XREF: sub_40A6C0+133j
		call	abort
; ---------------------------------------------------------------------------

loc_40A861:				; CODE XREF: sub_40A6C0+12Ej
		mov	[esp+348h+Size], 16h
		call	raise
		mov	[esp+348h+Size], 3 ; Code
		call	_exit
; ---------------------------------------------------------------------------

loc_40A879:				; CODE XREF: sub_40A6C0+101j
		mov	eax, ds:_iob
		mov	[esp+348h+nSize], edi
		mov	[esp+348h+lpFilename], offset aS_0 ; "%s\n"
		add	eax, 40h
		mov	[esp+348h+Size], eax ; File
		call	fprintf
		call	abort
sub_40A6C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_40A8A0(char *, char *, int)
sub_40A8A0	proc near		; CODE XREF: sub_4058B6+3Ep

Str		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Memory		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [esp+3Ch+arg_0]
		mov	edx, [esp+3Ch+arg_8]
		mov	esi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+Str], edi ; Str
		mov	[esp+3Ch+var_20], edx
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		mov	[esp+3Ch+Str], esi ; Str
		mov	ebx, eax
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		movzx	ecx, byte ptr [edi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_40A906
		xor	ebp, ebp
		lea	esi, [esi+0]

loc_40A8F0:				; CODE XREF: sub_40A8A0+62j
		add	edx, 1
		movzx	ecx, cl
		mov	[ebx+ebp*2], cx
		movzx	ecx, byte ptr [edi+edx]
		mov	ebp, edx
		test	cl, cl
		jnz	short loc_40A8F0
		add	edx, edx

loc_40A906:				; CODE XREF: sub_40A8A0+48j
		mov	word ptr [ebx+edx], 0
		movzx	ecx, byte ptr [esi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_40A92D
		xor	edi, edi

loc_40A917:				; CODE XREF: sub_40A8A0+89j
		add	edx, 1
		movzx	ecx, cl
		mov	[eax+edi*2], cx
		movzx	ecx, byte ptr [esi+edx]
		mov	edi, edx
		test	cl, cl
		jnz	short loc_40A917
		add	edx, edx

loc_40A92D:				; CODE XREF: sub_40A8A0+73j
		mov	word ptr [eax+edx], 0
		mov	edx, [esp+3Ch+var_20]
		mov	[esp+3Ch+var_38], eax
		mov	[esp+3Ch+Memory], eax
		mov	[esp+3Ch+Str], ebx
		mov	[esp+3Ch+var_34], edx
		call	sub_40A6C0
		mov	[esp+3Ch+Str], ebx ; Memory
		call	free
		mov	eax, [esp+3Ch+Memory]
		mov	[esp+3Ch+arg_0], eax ; Memory
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		jmp	free
sub_40A8A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40A970	proc near		; CODE XREF: sub_4058B6+9Cp
		jmp	sub_40A990
sub_40A970	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_40A980	proc near		; CODE XREF: sub_4058B6+AAp
		jmp	sub_40A9A0
sub_40A980	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A990	proc near		; CODE XREF: sub_40A970j
		mov	eax, ds:time
		jmp	eax
sub_40A990	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_40A9A0	proc near		; CODE XREF: sub_40A980j
		mov	eax, ds:localtime
		jmp	eax
sub_40A9A0	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __getmainargs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __set_app_type]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _cexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION sprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION printf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fopen]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strerror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION sscanf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION atoi]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fgets]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fclose]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fputc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strspn]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcpy]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION realloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strrchr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncpy]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION getenv]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION putc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fputs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strpbrk]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION setvbuf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fflush]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcmp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fread]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION signal]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __setusermatherr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION raise]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _exit]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40AB20	proc near		; DATA XREF: .text:0040AB44o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4014F0
		mov	[esp+18h+var_18], offset sub_401540 ; _onexit_t
		call	sub_408B60
		leave
		retn
sub_40AB20	endp

; ---------------------------------------------------------------------------
		align 10h
dword_40AB40	dd 0FFFFFFFFh		; DATA XREF: sub_409780-4Cr
					; sub_409780:loc_409743r ...
		dd offset sub_40AB20
		dd 0
		dd 0FFFFFFFFh
dword_40AB50	dd 2Ch dup(0)		; DATA XREF: .data:off_40B014o
		dd 100h	dup(?)
_text		ends

; Section 2. (virtual address 0000B000)
; Virtual size			: 00000048 (	 72.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0000A000
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
		;org 40B000h
dword_40B000	dd 0FFFFFFFFh		; DATA XREF: sub_405495:loc_40561Bw
					; .text:loc_40584Fr ...
; char off_40B004[]
off_40B004	dd offset aIso88591	; DATA XREF: sub_405E70+D9w
					; .text:loc_406144w ...
					; "iso-8859-1"
		dd 0FFh, 2 dup(0FFFFFFFFh)
off_40B014	dd offset dword_40AB50	; DATA XREF: sub_409700+3r
					; sub_409700+12r ...
dword_40B018	dd 2			; DATA XREF: TlsCallback_0+13r
					; TlsCallback_0+1Cw ...
dword_40B01C	dd 0FFFFFFFFh		; DATA XREF: sub_401060+7Ar
dword_40B020	dd 3Fh			; DATA XREF: sub_409D00:loc_409E57w
					; sub_409D00+1F8w ...
dword_40B024	dd 1			; DATA XREF: sub_401920+207r
					; sub_401920+216r ...
dword_40B028	dd 1			; DATA XREF: sub_409D00+12Cr
					; sub_409D00+1C3r ...
dword_40B02C	dd 0FFFFFFFFh		; DATA XREF: sub_40A050:loc_40A07Dr
					; sub_40A050:loc_40A0AAr ...
dword_40B030	dd 0FFFFFFFFh		; DATA XREF: sub_40A050+83w
					; sub_40A050+D1r ...
dword_40B034	dd 0FFFFFFFFh		; DATA XREF: sub_40A050+8Dw
					; sub_40A050+C2r ...
; char *off_40B038
off_40B038	dd offset byte_40D6F5	; DATA XREF: sub_409D00+Br
					; sub_40A050+A6w ...
dword_40B03C	dd 0BB40E64Eh		; DATA XREF: sub_4097A0+3r
					; sub_4097A0:loc_409852w ...
dword_40B040	dd 44BF19B1h		; DATA XREF: sub_4097A0+31w
					; sub_4097A0+B8w ...
dword_40B044	dd 0			; DATA XREF: sub_4014F0+6r
					; sub_4014F0+42o
		align 1000h
_data		ends

; Section 3. (virtual address 0000C000)
; Virtual size			: 00001840 (   6208.)
; Section size in file		: 00001A00 (   6656.)
; Offset to raw	data for section: 0000A200
; Flags	40600040: Data Readable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment '32byte' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 40C000h
; CHAR ProcName[]
ProcName	db '_set_invalid_parameter_handler',0 ; DATA XREF: sub_401180+137o
		align 10h
; CHAR ModuleName[]
ModuleName	db 'libgcj-12.dll',0    ; DATA XREF: sub_4014F0+Fo
; CHAR a_jv_registercl[]
a_jv_registercl	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_4014F0+28o
		align 4
a0x		db '0x',0               ; DATA XREF: sub_4015C8+39o
; char Format[]
Format		db 'KEY 0x%s BEGIN',0Ah,0 ; DATA XREF: sub_4015C8:loc_401628o
asc_40C057	db '/',0                ; DATA XREF: sub_4015C8:loc_40165Bo
; char Src
Src		db 0			; DATA XREF: sub_4015C8:loc_401676o
					; sub_4015C8:loc_40168Eo ...
asc_40C05A	db ':',0                ; DATA XREF: sub_4015C8+BFo
; char aSSSSS[]
aSSSSS		db '%s://%s%s%s%s',0    ; DATA XREF: sub_4015C8+DDo
		align 4
; char aGpgkeysSFetchE[]
aGpgkeysSFetchE	db 'gpgkeys: %s fetch error %d: %s',0Ah,0 ; DATA XREF: sub_4015C8+1CDo
; char aKey0xSFailedD[]
aKey0xSFailedD	db 0Ah			; DATA XREF: sub_4015C8+203o
					; sub_4015C8+266o
		db 'KEY 0x%s FAILED %d',0Ah,0
		align 4
; char aGpgkeysNoKeyDa[]
aGpgkeysNoKeyDa	db 'gpgkeys: no key data found for %s',0Ah,0 ; DATA XREF: sub_4015C8+246o
; char aKey0xSEnd[]
aKey0xSEnd	db 0Ah			; DATA XREF: sub_4015C8:loc_401855o
		db 'KEY 0x%s END',0Ah,0
aHHelpHelp	db '-h, --help',9,'help',0Ah,0 ; DATA XREF: sub_401888+6o
aVMachineReadab	db '-V',9,9,'machine readable version',0Ah,0 ; DATA XREF: sub_401888+2Ao
		align 4
aVersionHumanRe	db '--version',9,'human readable version',0Ah,0 ; DATA XREF: sub_401888+4Eo
aOOutputToThisF	db '-o',9,9,'output to this file',0Ah,0 ; DATA XREF: sub_401888+72o
aVersion	db '--version',0        ; DATA XREF: sub_401920+68o
; char aGpgkeys_curlGn[]
aGpgkeys_curlGn	db 'gpgkeys_curl (GnuPG) %s',0Ah,0 ; DATA XREF: sub_401920+8Bo
a2_0_30		db '2.0.30',0           ; DATA XREF: sub_401920+90o
					; sub_401920+14Do ...
; char aUsesS[]
aUsesS		db 'Uses: %s',0Ah,0     ; DATA XREF: sub_401920+A7o
aHelp		db '--help',0           ; DATA XREF: sub_401920+D6o
; char aDS[]
aDS		db '%d',0Ah             ; DATA XREF: sub_401920:loc_401A5Fo
		db '%s',0Ah,0
; char Mode[]
Mode		db 'wb',0               ; DATA XREF: sub_401920:loc_401A93o
; char aGpgkeysCannotO[]
aGpgkeysCannotO	db 'gpgkeys: Cannot open output file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_401920+1AEo
aHvo		db 'hVo:',0             ; DATA XREF: sub_401920:loc_401AF8o
; char aR[]
aR		db 'r',0                ; DATA XREF: sub_401920+211o
		align 4
; char aGpgkeysCanno_0[]
aGpgkeysCanno_0	db 'gpgkeys: Cannot open input file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_401920+25Co
; char aOption256s[]
aOption256s	db 'OPTION %256s',0Ah,0 ; DATA XREF: sub_401920+329o
; char Str[]
Str		db 'no-',0              ; DATA XREF: sub_401920+378o
; char aHttpProxy[]
aHttpProxy	db 'http-proxy',0       ; DATA XREF: sub_401920+3B3o
; char aFollowRedirect[]
aFollowRedirect	db 'follow-redirects',0 ; DATA XREF: sub_401920+480o
aGpgkeysNoSchem	db 'gpgkeys: no scheme supplied!',0Ah,0 ; DATA XREF: sub_401920+542o
		align 4
aGpgkeysNoKeyse	db 'gpgkeys: no keyserver host provided',0Ah,0 ; DATA XREF: sub_401920+585o
		align 4
aGpgkeysUnableT	db 'gpgkeys: unable to register timeout handler',0Ah,0
					; DATA XREF: sub_401920+5C7o
		align 4
aGpgkeysUnabl_0	db 'gpgkeys: unable to initialize curl',0Ah,0 ; DATA XREF: sub_401920+61Bo
; char aGpgkeysProtoco[]
aGpgkeysProtoco	db 'gpgkeys: protocol `%s',27h,' not supported',0Ah,0
					; DATA XREF: sub_401920+6EBo
; char aGpgkeysCurlVer[]
aGpgkeysCurlVer	db 'gpgkeys: curl version = %s',0Ah,0 ; DATA XREF: sub_401920+7D6o
aPragmaNoCache	db 'Pragma: no-cache',0 ; DATA XREF: sub_401920:loc_4021E5o
aCacheControlNo	db 'Cache-Control: no-cache',0 ; DATA XREF: sub_401920+8EFo
		align 4
aGpgkeysOutOfMe	db 'gpgkeys: out of memory when building HTTP headers',0Ah,0
					; DATA XREF: sub_401920+91Fo
		align 10h
aGpgkeysOutOf_0	db 'gpgkeys: out of memory while building key list',0Ah,0
					; DATA XREF: sub_401920+A45o
aGpgkeysThisKey	db 'gpgkeys: this keyserver type only supports key retrieval',0Ah,0
					; DATA XREF: sub_401920+AC0o
		align 4
aGpgkeysInvalid	db 'gpgkeys: invalid keyserver instructions',0Ah,0
					; DATA XREF: sub_401920+AECo
; char aVersionD[]
aVersionD	db 'VERSION %d',0Ah,0   ; DATA XREF: sub_401920:loc_402432o
; char aProgramS[]
aProgramS	db 'PROGRAM %s',0Ah     ; DATA XREF: sub_401920+B30o
		db 0Ah,0
; char aSchemeS[]
aSchemeS	db 'Scheme:',9,9,'%s',0Ah,0 ; DATA XREF: sub_401920+B66o
; char aHostS[]
aHostS		db 'Host:',9,9,'%s',0Ah,0 ; DATA XREF: sub_401920+B88o
; char aPortS[]
aPortS		db 'Port:',9,9,'%s',0Ah,0 ; DATA XREF: sub_401920+BB6o
; char aPathS[]
aPathS		db 'Path:',9,9,'%s',0Ah,0 ; DATA XREF: sub_401920+BE4o
aCommandGet	db 'Command:',9,'GET',0Ah,0 ; DATA XREF: sub_401920+C04o
		align 4
; char asc_40C43C[]
asc_40C43C	db '/',0                ; DATA XREF: sub_4026D0+5Do
; char aCommand7s[]
aCommand7s	db 'COMMAND %7s',0Ah,0  ; DATA XREF: sub_4027DD:loc_4027FAo
; char Str2[]
Str2		db 'get',0              ; DATA XREF: sub_4027DD+45o
; char aGetname[]
aGetname	db 'getname',0          ; DATA XREF: sub_4027DD:loc_402846o
; char aSend[]
aSend		db 'send',0             ; DATA XREF: sub_4027DD:loc_40286Ao
; char aSearch[]
aSearch		db 'search',0           ; DATA XREF: sub_4027DD:loc_40288Eo
; char aHost80s[]
aHost80s	db 'HOST %80s',0Ah,0    ; DATA XREF: sub_4027DD:loc_4028BAo
; char aPort10s[]
aPort10s	db 'PORT %10s',0Ah,0    ; DATA XREF: sub_4027DD:loc_40291Do
; char aScheme20s[]
aScheme20s	db 'SCHEME %20s',0Ah,0  ; DATA XREF: sub_4027DD:loc_402980o
; char aAuth128s[]
aAuth128s	db 'AUTH %128s',0Ah,0   ; DATA XREF: sub_4027DD:loc_4029E9o
; char aPath1024s[]
aPath1024s	db 'PATH %1024s',0Ah,0  ; DATA XREF: sub_4027DD:loc_402A55o
; char aOpaque1024s[]
aOpaque1024s	db 'OPAQUE %1024s',0Ah,0 ; DATA XREF: sub_4027DD:loc_402AC1o
; char aVersionD_0[]
aVersionD_0	db 'VERSION %d',0Ah,0   ; DATA XREF: sub_4027DD:loc_402B2Do
; char aOption256[]
aOption256	db 'OPTION %256[^',0Ah  ; DATA XREF: sub_4027DD:loc_402B69o
		db ']',0Ah,0
; char aNo_0[]
aNo_0		db 'no-',0              ; DATA XREF: sub_4027DD+3D2o
; char aVerbose[]
aVerbose	db 'verbose',0          ; DATA XREF: sub_4027DD+409o
; char aIncludeDisable[]
aIncludeDisable	db 'include-disabled',0 ; DATA XREF: sub_4027DD:loc_402C50o
; char aIncludeRevoked[]
aIncludeRevoked	db 'include-revoked',0  ; DATA XREF: sub_4027DD:loc_402C93o
; char aIncludeSubkeys[]
aIncludeSubkeys	db 'include-subkeys',0  ; DATA XREF: sub_4027DD:loc_402CD6o
; char aCheckCert[]
aCheckCert	db 'check-cert',0       ; DATA XREF: sub_4027DD:loc_402D19o
; char aDebug[]
aDebug		db 'debug',0            ; DATA XREF: sub_4027DD+587o
; char aTimeout[]
aTimeout	db 'timeout',0          ; DATA XREF: sub_4027DD+605o
; char aCaCertFile[]
aCaCertFile	db 'ca-cert-file',0     ; DATA XREF: sub_4027DD+683o
aUnknown	db 'UNKNOWN',0          ; DATA XREF: .text:loc_402F00o
aGet_0		db 'GET',0              ; DATA XREF: .text:loc_402F07o
aGetname_0	db 'GETNAME',0          ; DATA XREF: .text:loc_402F0Eo
aSend_0		db 'SEND',0             ; DATA XREF: .text:loc_402F15o
aSearch_0	db 'SEARCH',0           ; DATA XREF: .text:loc_402F1Co
a?		db '?',0                ; DATA XREF: .text:loc_402F23o
off_40C550	dd offset loc_402F00	; DATA XREF: .text:00402EF7o
		dd offset loc_402F07	; jump table for switch	statement
		dd offset loc_402F0E
		dd offset loc_402F15
		dd offset loc_402F1C
aAbcdefabcdef12	db 'abcdefABCDEF1234567890x',0 ; DATA XREF: .text:00403025o
					; .text:00403079o
off_40C57C	dd offset loc_402F8B	; DATA XREF: .text:00402F82r
		dd offset loc_4030A2	; jump table for switch	statement
		dd offset loc_4030A2
		dd offset loc_4030A2
		dd offset loc_4030A2
		dd offset loc_4030A2
		dd offset loc_402FE7
		dd offset loc_4030A2
		dd offset loc_4030A2
		dd offset loc_4030A2
		dd offset loc_4030A2
		dd offset loc_4030A2
		dd offset loc_4030A2
		dd offset loc_4030A2
		dd offset loc_4030A2
		dd offset loc_4030A2
		dd offset loc_4030A2
		dd offset loc_4030A2
		dd offset loc_402FB9
		dd offset loc_402FA2
		dd offset loc_4030A2
		dd offset loc_4030A2
		dd offset loc_402FD0
byte_40C5D8	db 41h			; DATA XREF: sub_4030EC+7Er
					; sub_4030EC+C1r ...
aBcdefghijklmno	db 'BCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',0
		align 4
aBeginPgpPublic	db '-----BEGIN PGP PUBLIC KEY BLOCK-----',0Ah ; DATA XREF: sub_403281+4Fo
		db 0Ah,0
		align 4
aBeginPgpPubl_0	db '-----BEGIN PGP PUBLIC KEY BLOCK-----',0 ; DATA XREF: sub_403281+75o
					; sub_403281+149o
		align 4
aEndPgpPublicKe	db '-----END PGP PUBLIC KEY BLOCK-----',0 ; DATA XREF: sub_403281+132o
		align 10h
aEndPgpPublic_0	db 0Ah			; DATA XREF: sub_40345D+175o
		db '-----END PGP PUBLIC KEY BLOCK-----',0
; char aErrorAllocatin[]
aErrorAllocatin	db 'error allocating enough memory: %s',0Ah,0 ; DATA XREF: sub_4037D8+17o
asc_40C6D8	db ' ',9,0Dh,0Ah,0      ; DATA XREF: .text:00403D92o
					; .text:00403E2Ao
a_		db '.',0                ; DATA XREF: .text:00403F17o
		align 10h
a____Gnupg22_0_	db '../../gnupg2-2.0.30/jnlib/stringhelp.c',0 ; DATA XREF: sub_403F7E+A0o
; char VarName[]
VarName		db 'HOME',0             ; DATA XREF: sub_403F7E:loc_40409Fo
; char aX02x[]
aX02x		db 'x%02x',0            ; DATA XREF: sub_404533+164o
					; .text:00404A97o
word_40C712	dw 0			; DATA XREF: .text:00405377o
					; .text:004053B6o
aFatalTooManyAr	db 0Ah			; DATA XREF: .text:00405400o
		db 'fatal: too many args for xstrconcat',0Ah,0
aFatalOutOfMemo	db 0Ah			; DATA XREF: .text:0040542Bo
		db 'fatal: out of memory',0Ah,0
aDo_make_filena	db 'do_make_filename',0 ; DATA XREF: sub_403F7E+90o
		align 4
asc_40C764	db '-',0                ; DATA XREF: sub_405495+55o
					; sub_4056F4:loc_405705o
aSocket		db 'socket://',0        ; DATA XREF: sub_405495+9Do
aSystemDoesNotS	db 'system does not support logging to a socket - using stderr',0Ah,0
					; DATA XREF: sub_405495+FDo
; char aA[]
aA		db 'a',0                ; DATA XREF: sub_405495+131o
					; sub_405495:loc_405605o
		align 10h
; char aFailedToOpenLo[]
aFailedToOpenLo	db 'failed to open log file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_405495+1B1o
		align 4
; char aFailedToFdopen[]
aFailedToFdopen	db 'failed to fdopen file descriptor %d: %s',0Ah,0
					; DATA XREF: sub_405495+1E9o
		align 10h
; char a____Gnupg22__0[]
a____Gnupg22__0	db '../../gnupg2-2.0.30/jnlib/logging.c',0 ; DATA XREF: sub_4058B6+2Fo
; char aLogstream[]
aLogstream	db 'logstream',0        ; DATA XREF: sub_4058B6+37o
		align 10h
; char a04d02d02d02d02[]
a04d02d02d02d02	db '%04d-%02d-%02d %02d:%02d:%02d ',0 ; DATA XREF: sub_4058B6+E3o
; char aU_Lx[]
aU_Lx		db '[%u.%lx]',0         ; DATA XREF: sub_4058B6+16Bo
; char aU[]
aU		db '[%u]',0             ; DATA XREF: sub_4058B6+192o
aFatal		db 'Fatal: ',0          ; DATA XREF: sub_4058B6+21Do
aOhhhhJeeee	db 'Ohhhh jeeee: ',0    ; DATA XREF: sub_4058B6+246o
aDbg		db 'DBG: ',0            ; DATA XREF: sub_4058B6+26Fo
; char aUnknownLogLeve[]
aUnknownLogLeve	db '[Unknown log level %d]: ',0 ; DATA XREF: sub_4058B6:loc_405B48o
		align 4
off_40C894	dd offset loc_405B67	; DATA XREF: sub_4058B6+20Eo
		dd offset loc_405B67	; jump table for switch	statement
		dd offset loc_405B67
		dd offset loc_405B67
		dd offset loc_405B67
		dd offset loc_405ACD
		dd offset loc_405AF6
		dd offset loc_405B1F
dword_40C8B4	dd 207325h		; DATA XREF: .text:00405DC1o
a02x		db '%02X',0             ; DATA XREF: .text:00405DE6o
a02x_0		db ' %02X',0            ; DATA XREF: .text:00405E09o
asc_40C8C3	db 0Ah,0		; DATA XREF: .text:00405E2Eo
; char a___ThisIsABugS[]
a___ThisIsABugS	db '... this is a bug (%s:%d:%s)',0Ah,0 ; DATA XREF: sub_405E3C+1Bo
		align 4
aIso88591	db 'iso-8859-1',0       ; DATA XREF: sub_405E70+D9o
					; .text:loc_406144o ...
aUtf8		db 'utf-8',0            ; DATA XREF: sub_405E70+22o
					; .text:0040617Eo ...
		align 4
; char aConversionFrom[]
aConversionFrom	db 'conversion from `%s',27h,' to `%s',27h,' not available',0Ah,0
					; DATA XREF: sub_405E70+71o
; char aIconv_openFail[]
aIconv_openFail	db 'iconv_open failed: %s',0Ah,0 ; DATA XREF: sub_405E70+B1o
aCpU		db 'CP%u',0             ; DATA XREF: .text:loc_405F9Ao
aCp936		db 'CP936',0            ; DATA XREF: .text:00405FBDo
aGbk		db 'GBK',0
aCp1361		db 'CP1361',0
aJohab		db 'JOHAB',0
aCp20127	db 'CP20127',0
aAscii_0	db 'ASCII',0
aCp20866	db 'CP20866',0
aKoi8R		db 'KOI8-R',0
aCp21866	db 'CP21866',0
aKoi8Ru		db 'KOI8-RU',0
aCp28591	db 'CP28591',0
aIso88591_0	db 'ISO-8859-1',0
aCp28592	db 'CP28592',0
aIso88592	db 'ISO-8859-2',0
aCp28593	db 'CP28593',0
aIso88593	db 'ISO-8859-3',0
aCp28594	db 'CP28594',0
aIso88594	db 'ISO-8859-4',0
aCp28595	db 'CP28595',0
aIso88595	db 'ISO-8859-5',0
aCp28596	db 'CP28596',0
aIso88596	db 'ISO-8859-6',0
aCp28597	db 'CP28597',0
aIso88597	db 'ISO-8859-7',0
aCp28598	db 'CP28598',0
aIso88598	db 'ISO-8859-8',0
aCp28599	db 'CP28599',0
aIso88599	db 'ISO-8859-9',0
aCp28605	db 'CP28605',0
aIso885915	db 'ISO-8859-15',0
aCp65001	db 'CP65001',0
aUtf8_1		db 'UTF-8',0
		align 2
aIso		db 'iso',0              ; DATA XREF: .text:004060ABo
a88591		db '8859-1',0           ; DATA XREF: .text:004060E8o
a646		db '646',0              ; DATA XREF: .text:004060FFo
aAscii		db 'ASCII',0            ; DATA XREF: .text:00406116o
aAnsi_x3_41968	db 'ANSI_X3.4-1968',0   ; DATA XREF: .text:0040612Do
aUtf8_0		db 'utf8',0             ; DATA XREF: .text:loc_406167o
		align 4
; char aConversionFr_0[]
aConversionFr_0	db 'conversion from `%s',27h,' to `%s',27h,' failed: %s',0Ah,0
					; DATA XREF: sub_406285+1EEo
					; sub_4064D1+730o
; char aX02x_0[]
aX02x_0		db '\x%02x',0           ; DATA XREF: sub_4064D1+7Co
					; sub_4064D1+3AFo ...
; char aX02x_1[]
aX02x_1		db 'x%02x',0            ; DATA XREF: sub_4064D1+1DCo
		align 4
a____Gnupg22__1	db '../../gnupg2-2.0.30/jnlib/utf8conv.c',0 ; DATA XREF: sub_4064D1+6BEo
		align 4
off_40CADC	dd offset loc_406684	; DATA XREF: sub_4064D1+12Ar
		dd offset loc_40669A	; jump table for switch	statement
		dd offset loc_40669A
		dd offset loc_40669A
		dd offset loc_40669A
		dd offset loc_40669A
		dd offset loc_40669A
		dd offset loc_40669A
		dd offset loc_40666E
		dd offset loc_40669A
		dd offset loc_406604
		dd offset loc_406658
		dd offset loc_40663E
		dd offset loc_406621
aDo_utf8_to_nat	db 'do_utf8_to_native',0 ; DATA XREF: sub_4064D1+6AEo
		align 4
; char aLc_all[]
aLc_all		db 'LC_ALL',0           ; DATA XREF: sub_406D2C+6o
; char aLang[]
aLang		db 'LANG',0             ; DATA XREF: sub_406D2C:loc_406D7Fo
aAf_za		db 'af_ZA',0            ; DATA XREF: sub_406D2C:loc_406DEAo
aSq_al		db 'sq_AL',0            ; DATA XREF: sub_406D2C:loc_406DF4o
aAm_et		db 'am_ET',0            ; DATA XREF: sub_406D2C:loc_406DFEo
aAr_sa		db 'ar_SA',0            ; DATA XREF: sub_406D2C:loc_406E21o
aAr_iq		db 'ar_IQ',0            ; DATA XREF: sub_406D2C:loc_406E2Bo
aAr_eg		db 'ar_EG',0            ; DATA XREF: sub_406D2C:loc_406E35o
aAr_ly		db 'ar_LY',0            ; DATA XREF: sub_406D2C:loc_406E3Fo
aAr_dz		db 'ar_DZ',0            ; DATA XREF: sub_406D2C:loc_406E49o
aAr_ma		db 'ar_MA',0            ; DATA XREF: sub_406D2C:loc_406E53o
aAr_tn		db 'ar_TN',0            ; DATA XREF: sub_406D2C:loc_406E5Do
aAr_om		db 'ar_OM',0            ; DATA XREF: sub_406D2C:loc_406E67o
aAr_ye		db 'ar_YE',0            ; DATA XREF: sub_406D2C:loc_406E71o
aAr_sy		db 'ar_SY',0            ; DATA XREF: sub_406D2C:loc_406E7Bo
aAr_jo		db 'ar_JO',0            ; DATA XREF: sub_406D2C:loc_406E85o
aAr_lb		db 'ar_LB',0            ; DATA XREF: sub_406D2C:loc_406E8Fo
aAr_kw		db 'ar_KW',0            ; DATA XREF: sub_406D2C:loc_406E99o
aAr_ae		db 'ar_AE',0            ; DATA XREF: sub_406D2C:loc_406EA3o
aAr_bh		db 'ar_BH',0            ; DATA XREF: sub_406D2C:loc_406EADo
aAr_qa		db 'ar_QA',0            ; DATA XREF: sub_406D2C:loc_406EB7o
aAr		db 'ar',0               ; DATA XREF: sub_406D2C:loc_406EC1o
aHy_am		db 'hy_AM',0            ; DATA XREF: sub_406D2C:loc_406ECBo
aAs_in		db 'as_IN',0            ; DATA XREF: sub_406D2C:loc_406ED5o
aAz_az@latin	db 'az_AZ@latin',0      ; DATA XREF: sub_406D2C:loc_406EEEo
aAz_az@cyrillic	db 'az_AZ@cyrillic',0   ; DATA XREF: sub_406D2C:loc_406EF8o
aAz		db 'az',0               ; DATA XREF: sub_406D2C:loc_406F02o
aEu		db 'eu',0               ; DATA XREF: sub_406D2C:loc_406F0Co
aBe_by		db 'be_BY',0            ; DATA XREF: sub_406D2C:loc_406F16o
aBn_in		db 'bn_IN',0            ; DATA XREF: sub_406D2C:loc_406F2Fo
aBn_bd		db 'bn_BD',0            ; DATA XREF: sub_406D2C:loc_406F39o
aBn		db 'bn',0               ; DATA XREF: sub_406D2C:loc_406F43o
aBg_bg		db 'bg_BG',0            ; DATA XREF: sub_406D2C:loc_406F4Do
aMy_mm		db 'my_MM',0            ; DATA XREF: sub_406D2C:loc_406F57o
aKm_kh		db 'km_KH',0            ; DATA XREF: sub_406D2C:loc_406F61o
aCa_es		db 'ca_ES',0            ; DATA XREF: sub_406D2C:loc_406F6Bo
aChr_us		db 'chr_US',0           ; DATA XREF: sub_406D2C:loc_406F75o
aZh_tw		db 'zh_TW',0            ; DATA XREF: sub_406D2C:loc_406F94o
aZh_cn		db 'zh_CN',0            ; DATA XREF: sub_406D2C:loc_406F9Eo
aZh_hk		db 'zh_HK',0            ; DATA XREF: sub_406D2C:loc_406FA8o
aZh_sg		db 'zh_SG',0            ; DATA XREF: sub_406D2C:loc_406FB2o
aZh_mo		db 'zh_MO',0            ; DATA XREF: sub_406D2C:loc_406FBCo
aZh		db 'zh',0               ; DATA XREF: sub_406D2C:loc_406FC6o
aHr_hr		db 'hr_HR',0            ; DATA XREF: sub_406D2C+2B6o
aSr_cs		db 'sr_CS',0            ; DATA XREF: sub_406D2C:loc_406FECo
aSr_cs@cyrillic	db 'sr_CS@cyrillic',0   ; DATA XREF: sub_406D2C:loc_406FF6o
aHr		db 'hr',0               ; DATA XREF: sub_406D2C:loc_407000o
aCs_cz		db 'cs_CZ',0            ; DATA XREF: sub_406D2C:loc_40700Ao
aDa_dk		db 'da_DK',0            ; DATA XREF: sub_406D2C:loc_407014o
aDiv_mv		db 'div_MV',0           ; DATA XREF: sub_406D2C:loc_40701Eo
aNl_nl		db 'nl_NL',0            ; DATA XREF: sub_406D2C:loc_407037o
aNl_be		db 'nl_BE',0            ; DATA XREF: sub_406D2C:loc_407041o
aNl		db 'nl',0               ; DATA XREF: sub_406D2C:loc_40704Bo
aBin_ng		db 'bin_NG',0           ; DATA XREF: sub_406D2C:loc_407055o
aEn_us		db 'en_US',0            ; DATA XREF: sub_406D2C:loc_407078o
aEn_gb		db 'en_GB',0            ; DATA XREF: sub_406D2C:loc_407082o
aEn_au		db 'en_AU',0            ; DATA XREF: sub_406D2C:loc_40708Co
aEn_ca		db 'en_CA',0            ; DATA XREF: sub_406D2C:loc_407096o
aEn_nz		db 'en_NZ',0            ; DATA XREF: sub_406D2C:loc_4070A0o
aEn_ie		db 'en_IE',0            ; DATA XREF: sub_406D2C:loc_4070AAo
aEn_za		db 'en_ZA',0            ; DATA XREF: sub_406D2C:loc_4070B4o
aEn_jm		db 'en_JM',0            ; DATA XREF: sub_406D2C:loc_4070BEo
aEn_gd		db 'en_GD',0            ; DATA XREF: sub_406D2C:loc_4070C8o
aEn_bz		db 'en_BZ',0            ; DATA XREF: sub_406D2C:loc_4070D2o
aEn_tt		db 'en_TT',0            ; DATA XREF: sub_406D2C:loc_4070DCo
aEn_zw		db 'en_ZW',0            ; DATA XREF: sub_406D2C:loc_4070E6o
aEn_ph		db 'en_PH',0            ; DATA XREF: sub_406D2C:loc_4070F0o
aEn_id		db 'en_ID',0            ; DATA XREF: sub_406D2C:loc_4070FAo
aEn_hk		db 'en_HK',0            ; DATA XREF: sub_406D2C:loc_407104o
aEn_in		db 'en_IN',0            ; DATA XREF: sub_406D2C:loc_40710Eo
aEn_my		db 'en_MY',0            ; DATA XREF: sub_406D2C:loc_407118o
aEn_sg		db 'en_SG',0            ; DATA XREF: sub_406D2C:loc_407122o
aEn		db 'en',0               ; DATA XREF: sub_406D2C:loc_40712Co
aEt_ee		db 'et_EE',0            ; DATA XREF: sub_406D2C:loc_407136o
aFo_fo		db 'fo_FO',0            ; DATA XREF: sub_406D2C:loc_407140o
aFa_ir		db 'fa_IR',0            ; DATA XREF: sub_406D2C:loc_40714Ao
aFi_fi		db 'fi_FI',0            ; DATA XREF: sub_406D2C:loc_407154o
aFr_fr		db 'fr_FR',0            ; DATA XREF: sub_406D2C:loc_407177o
aFr_be		db 'fr_BE',0            ; DATA XREF: sub_406D2C:loc_407181o
aFr_ca		db 'fr_CA',0            ; DATA XREF: sub_406D2C:loc_40718Bo
aFr_ch		db 'fr_CH',0            ; DATA XREF: sub_406D2C:loc_407195o
aFr_lu		db 'fr_LU',0            ; DATA XREF: sub_406D2C:loc_40719Fo
aFr_mc		db 'fr_MC',0            ; DATA XREF: sub_406D2C:loc_4071A9o
aFr		db 'fr',0               ; DATA XREF: sub_406D2C:loc_4071B3o
					; sub_406D2C:loc_40720Do
aFr_re		db 'fr_RE',0            ; DATA XREF: sub_406D2C:loc_4071BDo
aFr_cg		db 'fr_CG',0            ; DATA XREF: sub_406D2C:loc_4071C7o
aFr_sn		db 'fr_SN',0            ; DATA XREF: sub_406D2C:loc_4071D1o
aFr_cm		db 'fr_CM',0            ; DATA XREF: sub_406D2C:loc_4071DBo
aFr_ci		db 'fr_CI',0            ; DATA XREF: sub_406D2C:loc_4071E5o
aFr_ml		db 'fr_ML',0            ; DATA XREF: sub_406D2C:loc_4071EFo
aFr_ma		db 'fr_MA',0            ; DATA XREF: sub_406D2C:loc_4071F9o
aFr_ht		db 'fr_HT',0            ; DATA XREF: sub_406D2C:loc_407203o
aFy_nl		db 'fy_NL',0            ; DATA XREF: sub_406D2C:loc_407217o
aFul_ng		db 'ful_NG',0           ; DATA XREF: sub_406D2C:loc_407221o
aGd_gb		db 'gd_GB',0            ; DATA XREF: sub_406D2C:loc_40723Ao
aGa_ie		db 'ga_IE',0            ; DATA XREF: sub_406D2C:loc_407244o
aC		db 'C',0                ; DATA XREF: sub_406D2C:loc_40724Eo
					; sub_406D2C:loc_40786Co
aGl_es		db 'gl_ES',0            ; DATA XREF: sub_406D2C:loc_407258o
aKa_ge		db 'ka_GE',0            ; DATA XREF: sub_406D2C:loc_407262o
aDe_de		db 'de_DE',0            ; DATA XREF: sub_406D2C:loc_407281o
aDe_ch		db 'de_CH',0            ; DATA XREF: sub_406D2C:loc_40728Bo
aDe_at		db 'de_AT',0            ; DATA XREF: sub_406D2C:loc_407295o
aDe_lu		db 'de_LU',0            ; DATA XREF: sub_406D2C:loc_40729Fo
aDe_li		db 'de_LI',0            ; DATA XREF: sub_406D2C:loc_4072A9o
aDe		db 'de',0               ; DATA XREF: sub_406D2C:loc_4072B3o
aEl_gr		db 'el_GR',0            ; DATA XREF: sub_406D2C:loc_4072BDo
aGn_py		db 'gn_PY',0            ; DATA XREF: sub_406D2C:loc_4072C7o
aGu_in		db 'gu_IN',0            ; DATA XREF: sub_406D2C:loc_4072D1o
aHa_ng		db 'ha_NG',0            ; DATA XREF: sub_406D2C:loc_4072DBo
aCpe_us		db 'cpe_US',0           ; DATA XREF: sub_406D2C:loc_4072E5o
aHe_il		db 'he_IL',0            ; DATA XREF: sub_406D2C:loc_4072EFo
aHi_in		db 'hi_IN',0            ; DATA XREF: sub_406D2C:loc_4072F9o
aHu_hu		db 'hu_HU',0            ; DATA XREF: sub_406D2C:loc_407303o
aNic_ng		db 'nic_NG',0           ; DATA XREF: sub_406D2C:loc_40730Do
aIs_is		db 'is_IS',0            ; DATA XREF: sub_406D2C:loc_407317o
aIbo_ng		db 'ibo_NG',0           ; DATA XREF: sub_406D2C:loc_407321o
aId_id		db 'id_ID',0            ; DATA XREF: sub_406D2C:loc_40732Bo
aIu_ca		db 'iu_CA',0            ; DATA XREF: sub_406D2C:loc_407335o
aIt_it		db 'it_IT',0            ; DATA XREF: sub_406D2C:loc_40734Eo
aIt_ch		db 'it_CH',0            ; DATA XREF: sub_406D2C:loc_407358o
aIt		db 'it',0               ; DATA XREF: sub_406D2C:loc_407362o
aJa_jp		db 'ja_JP',0            ; DATA XREF: sub_406D2C:loc_40736Co
aKn_in		db 'kn_IN',0            ; DATA XREF: sub_406D2C:loc_407376o
aKau_ng		db 'kau_NG',0           ; DATA XREF: sub_406D2C:loc_407380o
aKs_pk		db 'ks_PK',0            ; DATA XREF: sub_406D2C:loc_407399o
aKs_in		db 'ks_IN',0            ; DATA XREF: sub_406D2C:loc_4073A3o
aKs		db 'ks',0               ; DATA XREF: sub_406D2C:loc_4073ADo
aKk_kz		db 'kk_KZ',0            ; DATA XREF: sub_406D2C:loc_4073B7o
aKok_in		db 'kok_IN',0           ; DATA XREF: sub_406D2C:loc_4073C1o
aKo_kr		db 'ko_KR',0            ; DATA XREF: sub_406D2C:loc_4073CBo
aKy_kg		db 'ky_KG',0            ; DATA XREF: sub_406D2C:loc_4073D5o
aLo_la		db 'lo_LA',0            ; DATA XREF: sub_406D2C:loc_4073DFo
aLa_va		db 'la_VA',0            ; DATA XREF: sub_406D2C:loc_4073E9o
aLv_lv		db 'lv_LV',0            ; DATA XREF: sub_406D2C:loc_4073F3o
aLt_lt		db 'lt_LT',0            ; DATA XREF: sub_406D2C:loc_4073FDo
aMk_mk		db 'mk_MK',0            ; DATA XREF: sub_406D2C:loc_407407o
aMs_my		db 'ms_MY',0            ; DATA XREF: sub_406D2C:loc_407420o
aMs_bn		db 'ms_BN',0            ; DATA XREF: sub_406D2C:loc_40742Ao
aMs		db 'ms',0               ; DATA XREF: sub_406D2C:loc_407434o
aMl_in		db 'ml_IN',0            ; DATA XREF: sub_406D2C:loc_40743Eo
aMt_mt		db 'mt_MT',0            ; DATA XREF: sub_406D2C:loc_407448o
aMni_in		db 'mni_IN',0           ; DATA XREF: sub_406D2C:loc_407452o
aMr_in		db 'mr_IN',0            ; DATA XREF: sub_406D2C:loc_40745Co
aMn		db 'mn',0               ; DATA XREF: sub_406D2C:loc_407466o
aNe_np		db 'ne_NP',0            ; DATA XREF: sub_406D2C:loc_40747Fo
aNe_in		db 'ne_IN',0            ; DATA XREF: sub_406D2C:loc_407489o
aNe		db 'ne',0               ; DATA XREF: sub_406D2C:loc_407493o
aNo_no		db 'no_NO',0            ; DATA XREF: sub_406D2C:loc_4074ACo
aNn_no		db 'nn_NO',0            ; DATA XREF: sub_406D2C:loc_4074B6o
aNo_1		db 'no',0               ; DATA XREF: sub_406D2C:loc_4074C0o
aOr_in		db 'or_IN',0            ; DATA XREF: sub_406D2C:loc_4074CAo
aOm_et		db 'om_ET',0            ; DATA XREF: sub_406D2C:loc_4074D4o
aPap_an		db 'pap_AN',0           ; DATA XREF: sub_406D2C:loc_4074DEo
aPs		db 'ps',0               ; DATA XREF: sub_406D2C:loc_4074E8o
aPl_pl		db 'pl_PL',0            ; DATA XREF: sub_406D2C:loc_4074F2o
aPt_pt		db 'pt_PT',0            ; DATA XREF: sub_406D2C+7DDo
aPt_br		db 'pt_BR',0            ; DATA XREF: sub_406D2C:loc_407513o
aPt		db 'pt',0               ; DATA XREF: sub_406D2C:loc_40751Do
aPa_in		db 'pa_IN',0            ; DATA XREF: sub_406D2C+803o
aPa		db 'pa',0               ; DATA XREF: sub_406D2C:loc_407539o
aRm_ch		db 'rm_CH',0            ; DATA XREF: sub_406D2C:loc_407543o
aRo_ro		db 'ro_RO',0            ; DATA XREF: sub_406D2C+829o
aRo		db 'ro',0               ; DATA XREF: sub_406D2C:loc_40755Fo
aRu		db 'ru',0               ; DATA XREF: sub_406D2C:loc_407569o
aSe_no		db 'se_NO',0            ; DATA XREF: sub_406D2C:loc_407573o
aSa_in		db 'sa_IN',0            ; DATA XREF: sub_406D2C:loc_40757Do
aSd_in		db 'sd_IN',0            ; DATA XREF: sub_406D2C:loc_407595o
aSd_pk		db 'sd_PK',0            ; DATA XREF: sub_406D2C:loc_40759Fo
aSd		db 'sd',0               ; DATA XREF: sub_406D2C:loc_4075A9o
aSi_lk		db 'si_LK',0            ; DATA XREF: sub_406D2C:loc_4075B3o
aSk_sk		db 'sk_SK',0            ; DATA XREF: sub_406D2C:loc_4075BDo
aSl_si		db 'sl_SI',0            ; DATA XREF: sub_406D2C:loc_4075C7o
aSo_so		db 'so_SO',0            ; DATA XREF: sub_406D2C:loc_4075D1o
aWen_de		db 'wen_DE',0           ; DATA XREF: sub_406D2C:loc_4075DBo
aEs_es		db 'es_ES',0            ; DATA XREF: sub_406D2C:loc_4075FEo
aEs_mx		db 'es_MX',0            ; DATA XREF: sub_406D2C:loc_407608o
aEs_es@modern	db 'es_ES@modern',0     ; DATA XREF: sub_406D2C:loc_407612o
aEs_gt		db 'es_GT',0            ; DATA XREF: sub_406D2C:loc_40761Co
aEs_cr		db 'es_CR',0            ; DATA XREF: sub_406D2C:loc_407626o
aEs_pa		db 'es_PA',0            ; DATA XREF: sub_406D2C:loc_407630o
aEs_do		db 'es_DO',0            ; DATA XREF: sub_406D2C:loc_40763Ao
aEs_ve		db 'es_VE',0            ; DATA XREF: sub_406D2C:loc_407644o
aEs_co		db 'es_CO',0            ; DATA XREF: sub_406D2C:loc_40764Eo
aEs_pe		db 'es_PE',0            ; DATA XREF: sub_406D2C:loc_407658o
aEs_ar		db 'es_AR',0            ; DATA XREF: sub_406D2C:loc_407662o
aEs_ec		db 'es_EC',0            ; DATA XREF: sub_406D2C:loc_40766Co
aEs_cl		db 'es_CL',0            ; DATA XREF: sub_406D2C:loc_407676o
aEs_uy		db 'es_UY',0            ; DATA XREF: sub_406D2C:loc_407680o
aEs_py		db 'es_PY',0            ; DATA XREF: sub_406D2C:loc_40768Ao
aEs_bo		db 'es_BO',0            ; DATA XREF: sub_406D2C:loc_407694o
aEs_sv		db 'es_SV',0            ; DATA XREF: sub_406D2C:loc_40769Eo
aEs_hn		db 'es_HN',0            ; DATA XREF: sub_406D2C:loc_4076A8o
aEs_ni		db 'es_NI',0            ; DATA XREF: sub_406D2C:loc_4076B2o
aEs_pr		db 'es_PR',0            ; DATA XREF: sub_406D2C:loc_4076BCo
aEs		db 'es',0               ; DATA XREF: sub_406D2C:loc_4076C6o
aBnt_tz		db 'bnt_TZ',0           ; DATA XREF: sub_406D2C:loc_4076D0o
aSw_ke		db 'sw_KE',0            ; DATA XREF: sub_406D2C:loc_4076DAo
aSv_se		db 'sv_SE',0            ; DATA XREF: sub_406D2C:loc_4076F3o
aSv_fi		db 'sv_FI',0            ; DATA XREF: sub_406D2C:loc_4076FDo
aSv		db 'sv',0               ; DATA XREF: sub_406D2C:loc_407707o
aSyr_tr		db 'syr_TR',0           ; DATA XREF: sub_406D2C:loc_407711o
aTl_ph		db 'tl_PH',0            ; DATA XREF: sub_406D2C:loc_40771Bo
aTg_tj		db 'tg_TJ',0            ; DATA XREF: sub_406D2C:loc_407725o
aBer_ma@arabic	db 'ber_MA@arabic',0    ; DATA XREF: sub_406D2C:loc_40773Eo
aBer_ma@latin	db 'ber_MA@latin',0     ; DATA XREF: sub_406D2C:loc_407748o
aBer_ma		db 'ber_MA',0           ; DATA XREF: sub_406D2C:loc_407752o
aTa		db 'ta',0               ; DATA XREF: sub_406D2C:loc_40775Co
aTt_ru		db 'tt_RU',0            ; DATA XREF: sub_406D2C:loc_407766o
aTe_in		db 'te_IN',0            ; DATA XREF: sub_406D2C:loc_407770o
aTh_th		db 'th_TH',0            ; DATA XREF: sub_406D2C:loc_40777Ao
aBo_cn		db 'bo_CN',0            ; DATA XREF: sub_406D2C:loc_407784o
aTi_et		db 'ti_ET',0            ; DATA XREF: sub_406D2C:loc_40779Co
aTi_er		db 'ti_ER',0            ; DATA XREF: sub_406D2C:loc_4077A6o
aTi		db 'ti',0               ; DATA XREF: sub_406D2C:loc_4077B0o
aTs_za		db 'ts_ZA',0            ; DATA XREF: sub_406D2C:loc_4077BAo
aTn_bw		db 'tn_BW',0            ; DATA XREF: sub_406D2C:loc_4077C4o
aTr_tr		db 'tr_TR',0            ; DATA XREF: sub_406D2C:loc_4077CEo
aTk_tm		db 'tk_TM',0            ; DATA XREF: sub_406D2C:loc_4077D8o
aUk_ua		db 'uk_UA',0            ; DATA XREF: sub_406D2C:loc_4077E2o
aUr_pk		db 'ur_PK',0            ; DATA XREF: sub_406D2C:loc_4077FBo
aUr_in		db 'ur_IN',0            ; DATA XREF: sub_406D2C:loc_407802o
aUr		db 'ur',0               ; DATA XREF: sub_406D2C:loc_407809o
aUz_uz		db 'uz_UZ',0            ; DATA XREF: sub_406D2C:loc_40781Fo
aUz_uz@cyrillic	db 'uz_UZ@cyrillic',0   ; DATA XREF: sub_406D2C:loc_407826o
aUz		db 'uz',0               ; DATA XREF: sub_406D2C:loc_40782Do
aVen_za		db 'ven_ZA',0           ; DATA XREF: sub_406D2C:loc_407834o
aVi_vn		db 'vi_VN',0            ; DATA XREF: sub_406D2C:loc_40783Bo
aCy_gb		db 'cy_GB',0            ; DATA XREF: sub_406D2C:loc_407842o
aXh_za		db 'xh_ZA',0            ; DATA XREF: sub_406D2C:loc_407849o
aSit_cn		db 'sit_CN',0           ; DATA XREF: sub_406D2C:loc_407850o
aYi_il		db 'yi_IL',0            ; DATA XREF: sub_406D2C:loc_407857o
aYo_ng		db 'yo_NG',0            ; DATA XREF: sub_406D2C:loc_40785Eo
aZu_za		db 'zu_ZA',0            ; DATA XREF: sub_406D2C:loc_407865o
		align 10h
off_40D090	dd offset loc_40786C, offset loc_406E08, offset	loc_406F4D
					; DATA XREF: sub_406D2C+B5o
		dd offset loc_406F6B, offset loc_406F7F, offset	loc_40700A ; jump table	for switch statement
		dd offset loc_407014, offset loc_40726C, offset	loc_4072BD
		dd offset loc_40705F, offset loc_4075E5, offset	loc_407154
		dd offset loc_40715E, offset loc_4072EF, offset	loc_407303
		dd offset loc_407317, offset loc_40733F, offset	loc_40736C
		dd offset loc_4073CB, offset loc_407028, offset	loc_40749D
		dd offset loc_4074F2, offset loc_4074FC, offset	loc_407543
		dd offset loc_40754D, offset loc_407569, offset	loc_406FD0
		dd offset loc_4075BD, offset loc_406DF4, offset	loc_4076E4
		dd offset loc_40777A, offset loc_4077CE, offset	loc_4077EC
		dd offset loc_40732B, offset loc_4077E2, offset	loc_406F16
		dd offset loc_4075C7, offset loc_407136, offset	loc_4073F3
		dd offset loc_4073FD, offset loc_407725, offset	loc_40714A
		dd offset loc_40783B, offset loc_406ECB, offset	loc_406EDF
		dd offset loc_406F0C, offset loc_4075DB, offset	loc_407407
		dd offset loc_4076D0, offset loc_4077BA, offset	loc_4077C4
		dd offset loc_407834, offset loc_407849, offset	loc_407865
		dd offset loc_406DEA, offset loc_407262, offset	loc_407140
		dd offset loc_4072F9, offset loc_407448, offset	loc_407573
		dd offset loc_40722B, offset loc_407857, offset	loc_407411
		dd offset loc_4073B7, offset loc_4073D5, offset	loc_4076DA
		dd offset loc_4077D8, offset loc_407810, offset	loc_407766
		dd offset loc_406F20, offset loc_407527, offset	loc_4072D1
		dd offset loc_4074CA, offset loc_40775C, offset	loc_407770
		dd offset loc_407376, offset loc_40743E, offset	loc_406ED5
		dd offset loc_40745C, offset loc_40757D, offset	loc_407466
		dd offset loc_407784, offset loc_407842, offset	loc_406F61
		dd offset loc_4073DF, offset loc_406F57, offset	loc_407258
		dd offset loc_4073C1, offset loc_407452, offset	loc_407587
		dd offset loc_407711, offset loc_4075B3, offset	loc_406F75
		dd offset loc_407335, offset loc_406DFE, offset	loc_40772F
		dd offset loc_40738A, offset loc_407470, offset	loc_407217
		dd offset loc_4074E8, offset loc_40771B, offset	loc_40701E
		dd offset loc_407055, offset loc_407221, offset	loc_4072DB
		dd offset loc_40730D, offset loc_40785E, offset	loc_40786C
		dd offset loc_40786C, offset loc_40786C, offset	loc_40786C
		dd offset loc_40786C, offset loc_407321, offset	loc_407380
		dd offset loc_4074D4, offset loc_40778E, offset	loc_4072C7
		dd offset loc_4072E5, offset loc_4073E9, offset	loc_4075D1
		dd offset loc_407850, offset loc_4074DE
off_40D278	dd offset loc_406EC1	; DATA XREF: sub_406D2C+ECo
		dd offset loc_406E21	; jump table for switch	statement
		dd offset loc_406E2B
		dd offset loc_406E35
		dd offset loc_406E3F
		dd offset loc_406E49
		dd offset loc_406E53
		dd offset loc_406E5D
		dd offset loc_406E67
		dd offset loc_406E71
		dd offset loc_406E7B
		dd offset loc_406E85
		dd offset loc_406E8F
		dd offset loc_406E99
		dd offset loc_406EA3
		dd offset loc_406EAD
		dd offset loc_406EB7
off_40D2BC	dd offset loc_406FC6	; DATA XREF: sub_406D2C+25Fo
		dd offset loc_406F94	; jump table for switch	statement
		dd offset loc_406F9E
		dd offset loc_406FA8
		dd offset loc_406FB2
		dd offset loc_406FBC
off_40D2D4	dd offset loc_40712C	; DATA XREF: sub_406D2C+343o
		dd offset loc_407078	; jump table for switch	statement
		dd offset loc_407082
		dd offset loc_40708C
		dd offset loc_407096
		dd offset loc_4070A0
		dd offset loc_4070AA
		dd offset loc_4070B4
		dd offset loc_4070BE
		dd offset loc_4070C8
		dd offset loc_4070D2
		dd offset loc_4070DC
		dd offset loc_4070E6
		dd offset loc_4070F0
		dd offset loc_4070FA
		dd offset loc_407104
		dd offset loc_40710E
		dd offset loc_407118
		dd offset loc_407122
off_40D320	dd offset loc_40720D	; DATA XREF: sub_406D2C+442o
		dd offset loc_407177	; jump table for switch	statement
		dd offset loc_407181
		dd offset loc_40718B
		dd offset loc_407195
		dd offset loc_40719F
		dd offset loc_4071A9
		dd offset loc_4071B3
		dd offset loc_4071BD
		dd offset loc_4071C7
		dd offset loc_4071D1
		dd offset loc_4071DB
		dd offset loc_4071E5
		dd offset loc_4071EF
		dd offset loc_4071F9
		dd offset loc_407203
off_40D360	dd offset loc_4072B3	; DATA XREF: sub_406D2C+54Co
		dd offset loc_407281	; jump table for switch	statement
		dd offset loc_40728B
		dd offset loc_407295
		dd offset loc_40729F
		dd offset loc_4072A9
off_40D378	dd offset loc_4076C6	; DATA XREF: sub_406D2C+8C9o
		dd offset loc_4075FE	; jump table for switch	statement
		dd offset loc_407608
		dd offset loc_407612
		dd offset loc_40761C
		dd offset loc_407626
		dd offset loc_407630
		dd offset loc_40763A
		dd offset loc_407644
		dd offset loc_40764E
		dd offset loc_407658
		dd offset loc_407662
		dd offset loc_40766C
		dd offset loc_407676
		dd offset loc_407680
		dd offset loc_40768A
		dd offset loc_407694
		dd offset loc_40769E
		dd offset loc_4076A8
		dd offset loc_4076B2
		dd offset loc_4076BC
; char aRb[3]
aRb		db 'rb',0               ; DATA XREF: sub_407952+16o
aLc_messages	db 'LC_MESSAGES',0      ; DATA XREF: .text:00407F0Co
					; .text:00408849o
aLc_messages_0	db '\LC_MESSAGES\',0    ; DATA XREF: .text:004080A0o
a_mo		db '.mo',0              ; DATA XREF: .text:004080F8o
		align 10h
aErrorInGettext	db 'ERROR in GETTEXT (bad plural entry)',0 ; DATA XREF: sub_408150+3Bo
aErrorInGette_0	db 'ERROR in GETTEXT MALLOC',0 ; DATA XREF: sub_4081B6+13Do
					; sub_4081B6:loc_408419o
aErrorInGette_1	db 'ERROR in GETTEXT (overflow space)',0Ah,0
					; DATA XREF: sub_4081B6:loc_40848Do
byte_40D44F	db 0			; DATA XREF: .text:loc_408863o
; CHAR LibFileName[]
LibFileName	db 'mingwm10.dll',0     ; DATA XREF: TlsCallback_0+4Eo
; CHAR a__mingwthr_rem[]
a__mingwthr_rem	db '__mingwthr_remove_key_dtor',0 ; DATA XREF: TlsCallback_0+71o
; CHAR a__mingwthr_key[]
a__mingwthr_key	db '__mingwthr_key_dtor',0 ; DATA XREF: TlsCallback_0+8Bo
off_40D48C	dd offset TlsCallback_0	; DATA XREF: sub_401180:loc_401273r
aUnknownError	db 'Unknown error',0    ; DATA XREF: sub_408D70+3o
		align 10h
; char a_matherrSInSGG[]
a_matherrSInSGG	db '_matherr(): %s in %s(%g, %g)  (retval=%g)',0Ah,0
					; DATA XREF: sub_408D70+39o
		align 4
aArgumentDomain	db 'Argument domain error (DOMAIN)',0 ; DATA XREF: .rdata:off_40D5ACo
aArgumentSingul	db 'Argument singularity (SIGN)',0 ; DATA XREF: .rdata:0040D5B0o
		align 4
aOverflowRangeE	db 'Overflow range error (OVERFLOW)',0 ; DATA XREF: .rdata:0040D5B4o
aTheResultIsToo	db 'The result is too small to be represented (UNDERFLOW)',0
					; DATA XREF: .rdata:0040D5B8o
		align 10h
aTotalLossOfSig	db 'Total loss of significance (TLOSS)',0 ; DATA XREF: .rdata:0040D5BCo
		align 4
aPartialLossOfS	db 'Partial loss of significance (PLOSS)',0 ; DATA XREF: .rdata:0040D5C0o
		align 4
off_40D5AC	dd offset aArgumentDomain ; DATA XREF: sub_408D70+16r
					; "Argument domain error (DOMAIN)"
		dd offset aArgumentSingul ; "Argument singularity (SIGN)"
		dd offset aOverflowRangeE ; "Overflow range error (OVERFLOW)"
		dd offset aTheResultIsToo ; "The result	is too small to	be represent"...
		dd offset aTotalLossOfSig ; "Total loss	of significance	(TLOSS)"
		dd offset aPartialLossOfS ; "Partial loss of significance (PLOSS)"
aMingwW64Runtim	db 'Mingw-w64 runtime failure:',0Ah,0 ; DATA XREF: sub_408DE0+1Do
; char aAddressPHasNoI[]
aAddressPHasNoI	db 'Address %p has no image-section',0 ; DATA XREF: sub_408E40+20Do
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: sub_408E40+1F9o
					; sub_408E40+225o ...
		align 4
; char aVirtualprotect[]
aVirtualprotect	db '  VirtualProtect failed with code 0x%x',0 ; DATA XREF: sub_408E40+1D2o
		align 4
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_409080+299o
		align 10h
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_409080+1B7o
		align 4
; const	WCHAR aMsvcrt_dll
aMsvcrt_dll:				; DATA XREF: sub_409630:loc_4096D0o
		unicode	0, <msvcrt.dll>,0
		align 4
off_40D6D4	dd offset dword_40E720	; DATA XREF: .text:004098C8o
		dd offset dword_40E440
		align 10h
; char aS[]
aS		db '%s: ',0             ; DATA XREF: sub_409C90+11o
; char aPosixly_correc[]
aPosixly_correc	db 'POSIXLY_CORRECT',0  ; DATA XREF: sub_40A050:loc_40A290o
byte_40D6F5	db 0			; DATA XREF: sub_40A050+A6o
					; sub_40A050:loc_40A280o ...
; char aUnknownOptionC[]
aUnknownOptionC	db 'unknown option -- %c',0 ; DATA XREF: sub_40A050+488o
		align 20h
; char aOptionRequir_0[]
aOptionRequir_0	db 'option requires an argument -- %c',0 ; DATA XREF: sub_40A050+42Ao
					; sub_40A050+57Do
; char aAmbiguousOptio[]
aAmbiguousOptio	db 'ambiguous option -- %.*s',0 ; DATA XREF: sub_409D00+147o
		align 10h
; char aOptionDoesnTTa[]
aOptionDoesnTTa	db 'option doesn',27h,'t take an argument -- %.*s',0
					; DATA XREF: sub_409D00+1DDo
		align 20h
; char aOptionRequires[]
aOptionRequires	db 'option requires an argument -- %s',0 ; DATA XREF: sub_409D00+2BAo
; char aUnknownOptionS[]
aUnknownOptionS	db 'unknown option -- %s',0 ; DATA XREF: sub_409D00+269o
		align 10h
; char aAssertionFaile[]
aAssertionFaile	db 'Assertion failed!',0Ah ; DATA XREF: sub_40A6C0+EAo
		db 0Ah
		db 'Program: %s',0Ah
		db 'File: %s, Line %u',0Ah
		db 0Ah
		db 'Expression: %s',0
; char aS_0[]
aS_0		db '%s',0Ah,0           ; DATA XREF: sub_40A6C0+1C2o
; CHAR Caption[]
Caption		db 'MinGW Runtime Assertion',0 ; DATA XREF: sub_40A6C0+10Fo
		align 10h
dword_40D840	dd 0			; DATA XREF: sub_409080+59o
					; sub_409080+5Eo ...
dword_40D844	dd 0			; DATA XREF: sub_409080+7Fr
dword_40D848	dd 0			; DATA XREF: sub_409080:loc_4091CCr
dword_40D84C	dd 6Dh dup(0)		; DATA XREF: sub_409080+155o
		align 800h
_rdata		ends

; Section 4. (virtual address 0000E000)
; Virtual size			: 000007E4 (   2020.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 40E000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_40E000	dd ?			; DATA XREF: sub_401180+D0w
					; sub_401180+27Dr
dword_40E004	dd ?			; DATA XREF: sub_401010+2Ao
					; sub_401180:loc_401344r ...
dword_40E008	dd ?			; DATA XREF: sub_401010+18o
					; sub_401180+1DEr ...
dword_40E00C	dd ?			; DATA XREF: sub_401010+10o
					; sub_401180+243r ...
dword_40E010	dd ?			; DATA XREF: sub_401180+272w
					; sub_401180+28Cr
dword_40E014	dd ?			; DATA XREF: sub_401060:loc_401098w
					; sub_401180+26Ar
dword_40E018	dd ?			; DATA XREF: sub_401010+8o
					; sub_401010+20w
dword_40E01C	dd ?			; DATA XREF: sub_401010+3Aw
; FILE *dword_40E020
dword_40E020	dd ?			; DATA XREF: sub_401920+22Fw
					; sub_401920+234r ...
; FILE *File
File		dd ?			; DATA XREF: sub_4015C8+65r
					; sub_4015C8+154r ...
; FILE *dword_40E028
dword_40E028	dd ?			; DATA XREF: sub_4015C8+1D2r
					; sub_4015C8+24Br ...
dword_40E02C	dd ?			; DATA XREF: sub_4015C8+112r
					; sub_4015C8+139r ...
; void *dword_40E030
dword_40E030	dd ?			; DATA XREF: sub_4015C8+7Dr
					; sub_4015C8+89r ...
		align 10h
dword_40E040	dd ?			; DATA XREF: .text:004026A2r
					; .text:004026C4w
		align 20h
dword_40E060	dd 68h dup(?)		; DATA XREF: .text:004026ABo
dword_40E200	dd 40h dup(?)		; DATA XREF: .text:00404B47o
					; .text:00404B74o
; FILE *dword_40E300
dword_40E300	dd ?			; DATA XREF: sub_405495+8r
					; sub_405495+19r ...
		align 20h
; char byte_40E320[79]
byte_40E320	db 4Fh dup(?)		; DATA XREF: .text:0040575Fo
					; .text:loc_405814o ...
byte_40E36F	db ?			; DATA XREF: .text:0040576Bw
dword_40E370	dd ?			; DATA XREF: .text:00405783w
					; .text:loc_4057CCr ...
dword_40E374	dd ?			; DATA XREF: .text:00405778w
					; .text:004057B4r ...
dword_40E378	dd ?			; DATA XREF: .text:0040578Ew
					; .text:loc_4057E4r ...
dword_40E37C	dd ?			; DATA XREF: .text:0040573Dw
					; sub_4058B6:loc_405A08r ...
dword_40E380	dd ?			; DATA XREF: .text:0040579Bw
					; .text:loc_4057FCr
dword_40E384	dd ?			; DATA XREF: sub_405495+249w
					; sub_4058B6+88r ...
dword_40E388	dd ?			; DATA XREF: sub_405495+24Ew
					; sub_4058B6:loc_4058F9r ...
dword_40E38C	dd ?			; DATA XREF: .text:00405466r
					; .text:00405474w ...
		align 20h
dword_40E3A0	dd ?			; DATA XREF: sub_405E70+E3w
					; .text:0040614Ew ...
dword_40E3A4	dd ?			; DATA XREF: sub_405E70+EDw
					; .text:00406158w ...
dword_40E3A8	dd ?			; DATA XREF: sub_4064D1+70Er
					; sub_4064D1:loc_406C25w
dword_40E3AC	dd ?			; DATA XREF: sub_406285+1CCr
					; sub_406285:loc_406497w
dword_40E3B0	dd 8 dup(?)		; DATA XREF: .text:00405FAAo
					; .text:00405FB6o ...
dword_40E3D0	dd ?			; DATA XREF: sub_405E70+45r
					; sub_405E70+4Dw
dword_40E3D4	dd ?			; DATA XREF: sub_405E70:loc_405EC9r
					; sub_405E70+61w
dword_40E3D8	dd ?			; DATA XREF: sub_405E70:loc_405F05r
					; sub_405E70:loc_405F39w
dword_40E3DC	dd ?			; DATA XREF: .text:00408128r
					; .text:00408131r ...
dword_40E3E0	dd ?			; DATA XREF: sub_4081B6+7r
					; .text:00408870w
dword_40E3E4	dd ?			; DATA XREF: sub_401010+3r
dword_40E3E8	dd ?			; DATA XREF: sub_401010+25r
dword_40E3EC	dd ?			; DATA XREF: sub_401060+22w
dword_40E3F0	dd ?			; DATA XREF: sub_401060+18w
dword_40E3F4	dd ?			; DATA XREF: sub_401060+Ew
TlsIndex	dd ?			; DATA XREF: .tls:TlsIndex_ptro
; HMODULE hLibModule
hLibModule	dd ?			; DATA XREF: TlsCallback_0+60w
					; TlsCallback_0+83r ...
dword_40E400	dd ?			; DATA XREF: sub_401060+2Cw
dword_40E404	dd ?			; DATA XREF: sub_401060+3Dr
					; sub_401180+61r ...
dword_40E408	dd ?			; DATA XREF: sub_401060+5Er
dword_40E40C	dd ?			; DATA XREF: sub_401180+12Dw
					; TopLevelExceptionFilter:loc_408BECr
dword_40E410	dd ?			; DATA XREF: .text:00408D13r
					; sub_408D60+4w
dword_40E414	dd ?			; DATA XREF: sub_409080+9r
					; sub_409080:loc_4090A0w
dword_40E418	dd ?			; DATA XREF: sub_408E40+1Dr
					; sub_408E40+58r ...
dword_40E41C	dd ?			; DATA XREF: sub_408E40+Br
					; sub_408E40:loc_408EFFw ...
dword_40E420	dd ?			; DATA XREF: sub_409630+4r
					; sub_409630+92w ...
dword_40E424	dd ?			; DATA XREF: sub_409780r
					; sub_409780:loc_409790w
		align 20h
dword_40E440	dd 2Bh dup(?)		; DATA XREF: .rdata:0040D6D8o
dword_40E4EC	dd ?			; DATA XREF: .text:004098AAw
		dd 2 dup(?)
dword_40E4F8	dd ?			; DATA XREF: .text:00409896w
		dd 2 dup(?)
dword_40E504	dd ?			; DATA XREF: .text:0040987Cw
		dd 86h dup(?)
dword_40E720	dd ?			; DATA XREF: .text:00409882w
					; .rdata:off_40D6D4o
dword_40E724	dd ?			; DATA XREF: .text:0040988Cw
		dd ?
dword_40E72C	dd ?			; DATA XREF: .text:0040989Bw
		align 80h
dword_40E780	dd ?			; DATA XREF: .text:00409973r
					; .text:00409A04r ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_409900+7o
					; sub_409900:loc_409955o ...
dword_40E79C	dd ?			; DATA XREF: sub_409900+14r
					; .text:004099C8r ...
		dd ?
dword_40E7A4	dd ?			; DATA XREF: sub_401180+1A8w
dword_40E7A8	dd ?			; DATA XREF: sub_401180+1BFw
dword_40E7AC	dd ?			; DATA XREF: sub_401180+1B2w
dword_40E7B0	dd ?			; DATA XREF: TlsCallback_0+A3w
					; TlsCallback_0:loc_4089D3w ...
dword_40E7B4	dd ?			; DATA XREF: TlsCallback_0+7Ew
					; TlsCallback_0+AEr ...
dword_40E7B8	dd ?			; DATA XREF: TlsCallback_0:loc_408924w
dword_40E7BC	dd ?			; DATA XREF: sub_401060+64w
					; sub_408AA0+3Fr ...
dword_40E7C0	dd ?			; DATA XREF: sub_401060+69w
					; sub_408AA0+4r ...
dword_40E7C4	dd ?			; DATA XREF: sub_401180+A0o
					; sub_401180+ECw
dword_40E7C8	dd ?			; DATA XREF: sub_401180+B3r
					; sub_401180:loc_401243r ...
		dd 4 dup(?)
dword_40E7DC	dd ?			; DATA XREF: sub_40A050+3Ar
					; sub_40A050+F8r ...
; char *Filename
Filename	dd ?			; DATA XREF: sub_401920+178r
					; sub_401920+1A8r ...
		align 1000h
_bss		ends

;
; Imports from libcurl-4.dll
;
; Section 5. (virtual address 0000F000)
; Virtual size			: 00000CA8 (   3240.)
; Section size in file		: 00000E00 (   3584.)
; Offset to raw	data for section: 0000BC00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
		extrn curl_easy_cleanup:dword ;	CODE XREF: sub_401920+CC8p
					; DATA XREF: sub_401920+CC3r
		extrn curl_easy_init:dword ; CODE XREF:	sub_401920+605p
					; DATA XREF: sub_401920+600r
		extrn curl_easy_perform:dword ;	CODE XREF: sub_4015C8+1BAp
					; DATA XREF: sub_4015C8+1B5r
		extrn curl_easy_setopt:dword ; CODE XREF: sub_4015C8+12Dp
					; sub_4015C8+152p ...
		extrn curl_global_cleanup:dword	; CODE XREF: sub_401920+CDEp
					; DATA XREF: sub_401920+CD9r
		extrn curl_global_init:dword ; CODE XREF: sub_401920+5FEp
					; DATA XREF: sub_401920+5F9r
		extrn curl_slist_append:dword ;	CODE XREF: sub_401920+8DCp
					; sub_401920+906p
					; DATA XREF: ...
		extrn curl_slist_free_all:dword	; CODE XREF: sub_401920+CB0p
					; DATA XREF: sub_401920+CABr
		extrn curl_version:dword ; CODE	XREF: sub_401920+A5p
					; sub_401920+7D4p
					; DATA XREF: ...
		extrn curl_version_info:dword ;	CODE XREF: sub_401920+658p
					; DATA XREF: sub_401920+653r

;
; Imports from libiconv-2.dll
;
		extrn __imp_libiconv:dword ; DATA XREF:	libiconvr
		extrn __imp_libiconv_close:dword ; DATA	XREF: libiconv_closer
		extrn __imp_libiconv_open:dword	; DATA XREF: libiconv_openr

;
; Imports from KERNEL32.dll
;
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_409AA0+44p
					; DATA XREF: sub_409AA0+44r
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_409900+Ep
					; .text:004099C2p ...
; DWORD	__stdcall FormatMessageA(DWORD dwFlags,	LPCVOID	lpSource, DWORD	dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments)
		extrn FormatMessageA:dword ; CODE XREF:	.text:00404B6Fp
					; DATA XREF: .text:00404B6Ar
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: TlsCallback_0+10Ap
					; DATA XREF: TlsCallback_0+10Ar
; UINT __stdcall GetACP()
		extrn GetACP:dword	; CODE XREF: .text:00405F95p
					; DATA XREF: .text:00405F90r
; UINT __stdcall GetConsoleOutputCP()
		extrn GetConsoleOutputCP:dword ; CODE XREF: .text:00405F85p
					; DATA XREF: .text:00405F80r
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: .text:004098D8p
					; DATA XREF: .text:004098D8r
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_4097A0+6Cp
					; DATA XREF: sub_4097A0+6Cr
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_4097A0+74p
					; DATA XREF: sub_4097A0+74r
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: .text:00404B2Fp
					; sub_408E40+1CCp ...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename,	DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_40A6C0+C2p
					; DATA XREF: sub_40A6C0+C2r
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_4014F0+16p
					; sub_409630+87p
					; DATA XREF: ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_401180+142p
					; sub_4014F0+33p ...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: sub_401180+2F6p
					; DATA XREF: sub_401180+2F6r
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_4097A0+57p
					; DATA XREF: sub_4097A0+57r
; LCID __stdcall GetThreadLocale()
		extrn GetThreadLocale:dword ; CODE XREF: sub_406D2C+7Fp
					; DATA XREF: sub_406D2C:loc_406DA6r
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_4097A0+7Cp
					; DATA XREF: sub_4097A0+7Cr
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_409AA0+87p
					; DATA XREF: sub_409AA0+87r
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_409900+5Cp
					; .text:004099E0p ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: TlsCallback_0+55p
					; DATA XREF: TlsCallback_0+55r
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: sub_409630+A7p
					; DATA XREF: sub_409630+A7r
; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
		extrn MultiByteToWideChar:dword	; CODE XREF: sub_407C8D+38p
					; sub_407C8D+D5p
					; DATA XREF: ...
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_4097A0+8Bp
					; DATA XREF: sub_4097A0+8Br
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_401180+124p
					; .text:004098BFp
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_401180+8Fp
					; DATA XREF: sub_401180+74r
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: .text:004098E9p
					; DATA XREF: .text:004098E9r
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_409900+35p
					; DATA XREF: sub_409900+21r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:004098CFp
					; DATA XREF: .text:004098CFr
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_408E40+142p
					; sub_408E40+184p ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_408E40+A1p
					; sub_408E40+D9p ...
; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
		extrn WideCharToMultiByte:dword	; CODE XREF: sub_407D8F+48p
					; sub_407D8F+C8p
					; DATA XREF: ...

;
; Imports from msvcrt.dll
;
; FILE *__cdecl	_fdopen(int FileHandle,	const char *Format)
		extrn __imp__fdopen:dword ; DATA XREF: _fdopenr
; int __cdecl _fileno(FILE *File)
		extrn __imp__fileno:dword ; DATA XREF: _filenor
		extrn __imp__getpid:dword ; DATA XREF: _getpidr
; char *__cdecl	_strdup(const char *Src)
		extrn __imp__strdup:dword ; DATA XREF: _strdupr

;
; Imports from msvcrt.dll
;
; char **_argv
		extrn __argv:dword	; DATA XREF: sub_409C90+4r
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
		extrn __imp___getmainargs:dword	; DATA XREF: __getmainargsr
		extrn __initenv:dword	; DATA XREF: sub_401180+23Er
		extrn __lconv_init:dword ; DATA	XREF: sub_408A70r
		extrn __imp___set_app_type:dword ; DATA	XREF: __set_app_typer
		extrn __imp___setusermatherr:dword ; DATA XREF:	__setusermatherrr
		extrn _acmdln:dword	; DATA XREF: sub_401180+166r
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
		extrn __imp__cexit:dword ; DATA	XREF: _cexitr
; int *__cdecl errno()
		extrn _errno:dword	; CODE XREF: sub_401920+19Cp
					; sub_401920+242p ...
; void __cdecl __noreturn _exit(int Code)
		extrn __imp__exit:dword	; DATA XREF: _exitr
; int fmode
		extrn _fmode:dword	; DATA XREF: sub_401060+6Er
		extrn _fstati64:dword	; CODE XREF: sub_407952+57p
					; DATA XREF: sub_407952+52r
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn _iob:dword	; DATA XREF: sub_401920+4Br
					; sub_401920+FDr ...
		extrn __imp__lock:dword	; DATA XREF: _lockr
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_408AA0+A3p
					; DATA XREF: sub_408AA0+A3r
; int __cdecl stricmp(const char *Str1,	const char *Str2)
		extrn _stricmp:dword	; CODE XREF: sub_401920+69Ap
					; sub_4027DD+58p ...
; int __cdecl strnicmp(const char *Str1, const char *Str, size_t MaxCount)
		extrn _strnicmp:dword	; CODE XREF: sub_401920+38Cp
					; sub_401920+3CAp ...
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
		extrn _winmajor:dword	; DATA XREF: TlsCallback_0+4r
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; int __cdecl atoi(const char *Str)
		extrn __imp_atoi:dword	; DATA XREF: atoir
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; void __cdecl __noreturn exit(int Code)
		extrn __imp_exit:dword	; DATA XREF: exitr
; int __cdecl fclose(FILE *File)
		extrn __imp_fclose:dword ; DATA	XREF: fcloser
; int __cdecl fflush(FILE *File)
		extrn __imp_fflush:dword ; DATA	XREF: fflushr
; char *__cdecl	fgets(char *Buf, int MaxCount, FILE *File)
		extrn __imp_fgets:dword	; DATA XREF: fgetsr
; FILE *__cdecl	fopen(const char *Filename, const char *Mode)
		extrn __imp_fopen:dword	; DATA XREF: fopenr
; int fprintf(FILE *File, const	char *Format, ...)
		extrn __imp_fprintf:dword ; DATA XREF: fprintfr
; int __cdecl fputc(int	Ch, FILE *File)
		extrn __imp_fputc:dword	; DATA XREF: fputcr
; int __cdecl fputs(const char *Str, FILE *File)
		extrn __imp_fputs:dword	; DATA XREF: fputsr
; size_t __cdecl fread(void *DstBuf, size_t ElementSize, size_t	Count, FILE *File)
		extrn __imp_fread:dword	; DATA XREF: freadr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; char *__cdecl	getenv(const char *VarName)
		extrn __imp_getenv:dword ; DATA	XREF: getenvr
; int __cdecl isspace(int C)
		extrn isspace:dword	; CODE XREF: .text:00403C47p
					; .text:00403C67p ...
; struct tm *__cdecl static localtime(const time_t *Time)
		extrn localtime:dword	; DATA XREF: sub_40A9A0r
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; int printf(const char	*Format, ...)
		extrn __imp_printf:dword ; DATA	XREF: printfr
; int __cdecl putc(int Ch, FILE	*File)
		extrn __imp_putc:dword	; DATA XREF: putcr
		extrn __imp_raise:dword	; DATA XREF: raiser
; void *__cdecl	realloc(void *Memory, size_t NewSize)
		extrn __imp_realloc:dword ; DATA XREF: reallocr
; int __cdecl setvbuf(FILE *File, char *Buf, int Mode, size_t Size)
		extrn __imp_setvbuf:dword ; DATA XREF: setvbufr
		extrn __imp_signal:dword ; DATA	XREF: signalr
; int sprintf(char *Dest, const	char *Format, ...)
		extrn __imp_sprintf:dword ; DATA XREF: sprintfr
; int sscanf(const char	*Src, const char *Format, ...)
		extrn __imp_sscanf:dword ; DATA	XREF: sscanfr
; char *__cdecl	strchr(const char *Str,	int Val)
		extrn __imp_strchr:dword ; DATA	XREF: strchrr
; int __cdecl strcmp(const char	*Str1, const char *Str2)
		extrn __imp_strcmp:dword ; DATA	XREF: strcmpr
; char *__cdecl	strcpy(char *Dest, const char *Source)
		extrn __imp_strcpy:dword ; DATA	XREF: strcpyr
; char *__cdecl	strerror(int)
		extrn __imp_strerror:dword ; DATA XREF:	strerrorr
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; char *__cdecl	strncpy(char *Dest, const char *Source,	size_t Count)
		extrn __imp_strncpy:dword ; DATA XREF: strncpyr
; char *__cdecl	strpbrk(const char *Str, const char *Control)
		extrn __imp_strpbrk:dword ; DATA XREF: strpbrkr
; char *__cdecl	strrchr(const char *Str, int Ch)
		extrn __imp_strrchr:dword ; DATA XREF: strrchrr
; size_t __cdecl strspn(const char *Str, const char *Control)
		extrn __imp_strspn:dword ; DATA	XREF: strspnr
; time_t __cdecl static	time(time_t *Time)
		extrn time:dword	; DATA XREF: sub_40A990r
; int __cdecl toupper(int C)
		extrn toupper:dword	; CODE XREF: .text:00403A21p
					; .text:00403A36p ...
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr

;
; Imports from USER32.dll
;
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn MessageBoxA:dword	; CODE XREF: sub_40A6C0+122p
					; DATA XREF: sub_40A6C0+122r

;
; Imports from WS2_32.dll
;
; int __stdcall	WSAStartup(WORD	wVersionRequested, LPWSADATA lpWSAData)
		extrn WSAStartup:dword	; CODE XREF: .text:004026BFp
					; DATA XREF: .text:004026BAr


; Section 6. (virtual address 00010000)
; Virtual size			: 00000034 (	 52.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0000CA00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 410000h
dword_410000	dd 0			; DATA XREF: sub_401180+2D8o
		dd offset sub_401010
dword_410008	dd 0			; DATA XREF: sub_401180:loc_401450o
dword_41000C	dd 0			; DATA XREF: sub_401180+316o
		dd offset sub_401060
		dd offset sub_408A70
dword_410018	dd 2 dup(0)		; DATA XREF: sub_401180+30Eo
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
		dd offset TlsCallback_1
		dd 0
		align 10h
dword_410030	dd 74h dup(0)		; DATA XREF: TlsCallback_0:loc_408A13o
					; TlsCallback_0+138o ...
		align 1000h
_CRT		ends

; Section 7. (virtual address 00011000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0000CC00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 411000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end start
