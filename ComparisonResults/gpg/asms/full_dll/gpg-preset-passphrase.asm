;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	FA0E2D598F25063768449224A953AC7A
; Input	CRC32 :	5B0D4735

; File Name   :	C:\compspace\compare\gpg\dlls\full\gpg-preset-passphrase.exe
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00014544 (  83268.)
; Section size in file		: 00014600 (  83456.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
; [00000002 BYTES: COLLAPSED FUNCTION nullsub_1]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401010	proc near		; DATA XREF: .CRT:0041C004o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch

		sub	esp, 2Ch
		mov	eax, ds:dword_41A3FC
		mov	[esp+2Ch+var_1C], offset dword_41A018
		mov	[esp+2Ch+var_24], offset dword_41A00C
		mov	[esp+2Ch+var_28], offset dword_41A008
		mov	ds:dword_41A018, eax
		mov	eax, ds:dword_41A400
		mov	[esp+2Ch+var_2C], offset dword_41A004
		mov	[esp+2Ch+var_20], eax
		call	__getmainargs
		mov	ds:dword_41A01C, eax
		add	esp, 2Ch
		retn
sub_401010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401060	proc near		; DATA XREF: .CRT:0041C010o

var_1C		= dword	ptr -1Ch

		sub	esp, 1Ch
		xor	eax, eax
		cmp	word ptr ds:400000h, 5A4Dh
		mov	ds:dword_41A40C, 1
		mov	ds:dword_41A408, 1
		mov	ds:dword_41A404, 1
		mov	ds:dword_41A418, 1
		jz	short loc_401100

loc_401098:				; CODE XREF: sub_401060+B6j
					; sub_401060+C8j ...
		mov	ds:dword_41A014, eax
		mov	eax, ds:dword_41A41C
		test	eax, eax
		jz	short loc_4010F0
		mov	[esp+1Ch+var_1C], 2
		call	__set_app_type

loc_4010B2:				; CODE XREF: sub_401060+9Cj
		mov	[esp+1Ch+var_1C], 0FFFFFFFFh
		call	sub_413CA0
		mov	edx, ds:dword_41A420
		mov	ds:dword_41A854, eax
		mov	ds:dword_41A858, eax
		mov	eax, ds:_fmode
		mov	[eax], edx
		call	sub_413FE0
		cmp	dword_4160D8, 1
		jz	short loc_401150
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4010F0:				; CODE XREF: sub_401060+44j
		mov	[esp+1Ch+var_1C], 1
		call	__set_app_type
		jmp	short loc_4010B2
; ---------------------------------------------------------------------------
		align 10h

loc_401100:				; CODE XREF: sub_401060+36j
		mov	edx, ds:40003Ch
		cmp	dword ptr [edx+400000h], 4550h
		lea	ecx, [edx+400000h]
		jnz	short loc_401098
		movzx	edx, word ptr [ecx+18h]
		cmp	dx, 10Bh
		jz	short loc_401162
		cmp	dx, 20Bh
		jnz	loc_401098
		cmp	dword ptr [ecx+84h], 0Eh
		jbe	loc_401098
		mov	edx, [ecx+0F8h]
		xor	eax, eax
		test	edx, edx
		setnz	al
		jmp	loc_401098
; ---------------------------------------------------------------------------
		align 10h

loc_401150:				; CODE XREF: sub_401060+81j
		mov	[esp+1Ch+var_1C], offset sub_413F80
		call	sub_413F70
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_401162:				; CODE XREF: sub_401060+C1j
		cmp	dword ptr [ecx+74h], 0Eh
		jbe	loc_401098
		mov	ecx, [ecx+0E8h]
		xor	eax, eax
		test	ecx, ecx
		setnz	al
		jmp	loc_401098
sub_401060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_401180	proc near		; CODE XREF: .text:004014C5j start+15j

dwMilliseconds	= dword	ptr -88h
lpProcName	= dword	ptr -84h
Size		= dword	ptr -80h
var_6D		= byte ptr -6Dh
var_6C		= dword	ptr -6Ch
var_5C		= byte ptr -5Ch
var_30		= byte ptr -30h
var_2C		= word ptr -2Ch

		push	ebp
		xor	eax, eax
		mov	ebp, esp
		mov	ecx, 11h
		push	edi
		push	esi
		lea	edx, [ebp+var_5C]
		push	ebx
		mov	edi, edx
		sub	esp, 7Ch
		rep stosd
		mov	al, 30h
		call	sub_414D50
		sub	esp, eax
		lea	eax, [esp+88h+var_6D]
		and	eax, 0FFFFFFF0h
		mov	dword ptr [eax], 0CCCCCCCCh
		mov	dword ptr [eax+4], 0CCCCCCCCh
		mov	dword ptr [eax+8], 0CCCCCCCCh
		mov	dword ptr [eax+0Ch], 0CCCCCCCCh
		mov	dword ptr [eax+10h], 0CCCCCCCCh
		mov	dword ptr [eax+14h], 0CCCCCCCCh
		mov	dword ptr [eax+18h], 0CCCCCCCCh
		mov	dword ptr [eax+1Ch], 0CCCCCCCCh
		and	esp, 0FFFFFFF0h
		mov	eax, ds:dword_41A41C
		test	eax, eax
		jnz	loc_401473

loc_4011EE:				; CODE XREF: sub_401180+2FFj
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_401214
; ---------------------------------------------------------------------------
		align 10h

loc_401200:				; CODE XREF: sub_401180+B1j
		cmp	eax, ebx
		jz	loc_401420
		mov	[esp+88h+dwMilliseconds], 3E8h ; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_401214:				; CODE XREF: sub_401180+7Dj
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], ebx
		mov	[esp+88h+dwMilliseconds], offset dword_41A85C
		call	sub_415030
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_401200
		mov	eax, ds:dword_41A860
		xor	ebx, ebx
		cmp	eax, 1
		jz	loc_401433

loc_401243:				; CODE XREF: sub_401180+2ADj
		mov	eax, ds:dword_41A860
		test	eax, eax
		jz	loc_401484
		mov	ds:dword_41A000, 1

loc_40125A:				; CODE XREF: sub_401180+322j
		mov	eax, ds:dword_41A860
		cmp	eax, 1
		jz	loc_401450

loc_401268:				; CODE XREF: sub_401180+2C7j
					; sub_401180+2EEj
		test	ebx, ebx
		jnz	short loc_401273
		lock xchg ebx, ds:dword_41A85C

loc_401273:				; CODE XREF: sub_401180+EAj
		mov	eax, ds:off_419314
		test	eax, eax
		jz	short loc_401298
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], 2
		mov	[esp+88h+dwMilliseconds], 0
		call	eax ; TlsCallback_0
		sub	esp, 0Ch

loc_401298:				; CODE XREF: sub_401180+FAj
		call	sub_414290
		mov	[esp+88h+dwMilliseconds], offset TopLevelExceptionFilter ; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	ds:dword_41A424, eax
		call	sub_414840
		mov	[esp+88h+lpProcName], offset ProcName ;	"_set_invalid_parameter_handler"
		mov	[esp+88h+dwMilliseconds], eax ;	hModule
		call	ds:GetProcAddress
		sub	esp, 8
		test	eax, eax
		jz	short loc_4012D8
		mov	[esp+88h+dwMilliseconds], offset nullsub_1
		call	eax

loc_4012D8:				; CODE XREF: sub_401180+14Dj
		call	sub_414900
		mov	eax, ds:dword_41A41C
		test	eax, eax
		jz	short loc_401344
		mov	eax, ds:_acmdln
		xor	ecx, ecx
		mov	eax, [eax]
		jmp	short loc_4012FC
; ---------------------------------------------------------------------------

loc_4012F1:				; CODE XREF: sub_401180+182j
		test	dl, dl
		jz	short loc_401320
		test	cl, cl
		jz	short loc_401315

loc_4012F9:				; CODE XREF: sub_401180+18Fj
		add	eax, 1

loc_4012FC:				; CODE XREF: sub_401180+16Fj
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_4012F1
		mov	ebx, ecx
		xor	ebx, 1
		cmp	dl, 22h
		cmovz	ecx, ebx
		jmp	short loc_4012F9
; ---------------------------------------------------------------------------

loc_401311:				; CODE XREF: sub_401180+19Ej
		test	dl, dl
		jz	short loc_401320

loc_401315:				; CODE XREF: sub_401180+177j
		add	eax, 1
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_401311

loc_401320:				; CODE XREF: sub_401180+173j
					; sub_401180+193j
		movzx	edx, [ebp+var_2C]
		test	[ebp+var_30], 1
		mov	ds:dword_41A7A4, eax
		mov	eax, 0Ah
		mov	ds:dword_41A7AC, 400000h
		cmovnz	eax, edx
		mov	ds:dword_41A7A8, eax

loc_401344:				; CODE XREF: sub_401180+164j
		mov	edx, ds:dword_41A004
		xor	ebx, ebx
		lea	eax, ds:4[edx*4]
		mov	[ebp+var_6C], edx
		mov	[esp+88h+dwMilliseconds], eax ;	Size
		call	malloc
		mov	edi, ds:dword_41A008
		mov	[ebp-70h], eax
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jle	short loc_4013AA
		xchg	ax, ax

loc_401370:				; CODE XREF: sub_401180+225j
		mov	eax, [edi+ebx*4]
		mov	[esp+88h+dwMilliseconds], eax ;	Str
		call	strlen
		lea	esi, [eax+1]
		mov	[esp+88h+dwMilliseconds], esi ;	Size
		call	malloc
		mov	edx, [ebp-70h]
		mov	[edx+ebx*4], eax
		mov	edx, [edi+ebx*4]
		add	ebx, 1
		mov	[esp+88h+Size],	esi ; Size
		mov	[esp+88h+dwMilliseconds], eax ;	Dst
		mov	[esp+88h+lpProcName], edx ; Src
		call	memcpy
		cmp	ebx, [ebp+var_6C]
		jnz	short loc_401370
		shl	ebx, 2

loc_4013AA:				; CODE XREF: sub_401180+1ECj
		mov	eax, [ebp-70h]
		mov	dword ptr [eax+ebx], 0
		mov	ds:dword_41A008, eax
		call	sub_414990
		mov	eax, ds:__initenv
		mov	edx, ds:dword_41A00C
		mov	[eax], edx
		mov	eax, ds:dword_41A00C
		mov	[esp+88h+Size],	eax
		mov	eax, ds:dword_41A008
		mov	[esp+88h+lpProcName], eax
		mov	eax, ds:dword_41A004
		mov	[esp+88h+dwMilliseconds], eax
		call	sub_4019CB
; ---------------------------------------------------------------------------
		mov	esi, ds:dword_41A014
		test	esi, esi
		mov	ds:dword_41A010, eax
		jz	loc_4014A7
		mov	ebx, ds:dword_41A000
		test	ebx, ebx
		jnz	short loc_401411
		call	_cexit
		mov	eax, ds:dword_41A010

loc_401411:				; CODE XREF: sub_401180+285j
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_401420:				; CODE XREF: sub_401180+82j
		mov	eax, ds:dword_41A860
		mov	ebx, 1
		cmp	eax, 1
		jnz	loc_401243

loc_401433:				; CODE XREF: sub_401180+BDj
		mov	[esp+88h+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, ds:dword_41A860
		cmp	eax, 1
		jnz	loc_401268
		lea	esi, [esi+0]

loc_401450:				; CODE XREF: sub_401180+E2j
		mov	[esp+88h+lpProcName], offset dword_41C008
		mov	[esp+88h+dwMilliseconds], offset dword_41C000
		call	_initterm
		mov	ds:dword_41A860, 2
		jmp	loc_401268
; ---------------------------------------------------------------------------

loc_401473:				; CODE XREF: sub_401180+68j
		mov	[esp+88h+dwMilliseconds], edx ;	lpStartupInfo
		call	ds:GetStartupInfoA
		sub	esp, 4
		jmp	loc_4011EE
; ---------------------------------------------------------------------------

loc_401484:				; CODE XREF: sub_401180+CAj
		mov	ds:dword_41A860, 1
		mov	[esp+88h+lpProcName], offset dword_41C018
		mov	[esp+88h+dwMilliseconds], offset dword_41C00C
		call	_initterm
		jmp	loc_40125A
; ---------------------------------------------------------------------------

loc_4014A7:				; CODE XREF: sub_401180+277j
		mov	[esp+88h+dwMilliseconds], eax ;	Code
		call	exit
sub_401180	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		mov	ds:dword_41A41C, 1
		call	sub_4149B0
		add	esp, 0Ch
		jmp	sub_401180
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

		public start
start		proc near
		sub	esp, 0Ch
		mov	ds:dword_41A41C, 0
		call	sub_4149B0
		add	esp, 0Ch
		jmp	sub_401180
start		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4014F0	proc near		; CODE XREF: sub_415510+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_4160E4
		test	eax, eax
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj-12.dll"
		call	ds:GetModuleHandleA
		mov	edx, 0
		sub	esp, 4
		test	eax, eax
		jz	short loc_40152E
		mov	[esp+18h+lpProcName], offset a_jv_registercl ; "_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	eax ; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		mov	edx, eax

loc_40152E:				; CODE XREF: sub_4014F0+26j
		test	edx, edx
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset dword_4160E4
		call	edx

locret_40153B:				; CODE XREF: sub_4014F0+Dj
					; sub_4014F0+40j
		leave
		retn
sub_4014F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401540()
sub_401540	proc near		; DATA XREF: sub_415510+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401540	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401550	proc near		; CODE XREF: sub_401577+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_401570
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_401575
; ---------------------------------------------------------------------------

loc_401570:				; CODE XREF: sub_401550+7j
		mov	eax, 0

loc_401575:				; CODE XREF: sub_401550+1Ej
		pop	ebp
		retn
sub_401550	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401577	proc near		; CODE XREF: sub_401592+14p
					; sub_4015AD+Ep ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 4
		call	sub_401550
		leave
		retn
sub_401577	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401592	proc near		; CODE XREF: sub_401637+29p
					; sub_401637+37p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gpg_err_code_from_errno
		mov	[esp+18h+var_18], eax
		call	sub_401577
		leave
		retn
sub_401592	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4015AD	proc near		; CODE XREF: sub_401637:loc_40169Fp
					; sub_4016C2+3Ep ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_401577
		leave
		retn
sub_4015AD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4015C2	proc near		; DATA XREF: sub_4019CB+1Eo

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 29h ; switch 42 cases
		ja	short loc_40162B ; jumptable 004015DB default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_41719C
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4015DD:				; CODE XREF: sub_4015C2+19j
					; DATA XREF: .rdata:off_41719Co
		mov	[ebp+var_C], offset aGpgPresetPassp ; jumptable	004015DB case 11
		jmp	short loc_401632
; ---------------------------------------------------------------------------

loc_4015E6:				; CODE XREF: sub_4015C2+19j
					; DATA XREF: .rdata:off_41719Co
		mov	[ebp+var_C], offset a2_0_30 ; jumptable	004015DB case 13
		jmp	short loc_401632
; ---------------------------------------------------------------------------

loc_4015EF:				; CODE XREF: sub_4015C2+19j
					; DATA XREF: .rdata:off_41719Co
		mov	[ebp+var_C], offset aMingw32 ; jumptable 004015DB case 17
		jmp	short loc_401632
; ---------------------------------------------------------------------------

loc_4015F8:				; CODE XREF: sub_4015C2+19j
					; DATA XREF: .rdata:off_41719Co
		mov	[esp+28h+var_28], offset aPleaseReportBu ; jumptable 004015DB case 19
		call	sub_40DCF4
		mov	[ebp+var_C], eax
		jmp	short loc_401632
; ---------------------------------------------------------------------------

loc_401609:				; CODE XREF: sub_4015C2+19j
					; DATA XREF: .rdata:off_41719Co
		mov	[esp+28h+var_28], offset aUsageGpgPreset ; jumptable 004015DB cases 1,40
		call	sub_40DCF4
		mov	[ebp+var_C], eax
		jmp	short loc_401632
; ---------------------------------------------------------------------------

loc_40161A:				; CODE XREF: sub_4015C2+19j
					; DATA XREF: .rdata:off_41719Co
		mov	[esp+28h+var_28], offset aSyntaxGpgPrese ; jumptable 004015DB case 41
		call	sub_40DCF4
		mov	[ebp+var_C], eax
		jmp	short loc_401632
; ---------------------------------------------------------------------------

loc_40162B:				; CODE XREF: sub_4015C2+Aj
					; sub_4015C2+19j
					; DATA XREF: ...
		mov	[ebp+var_C], 0	; jumptable 004015DB default case

loc_401632:				; CODE XREF: sub_4015C2+22j
					; sub_4015C2+2Bj ...
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4015C2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401637	proc near		; CODE XREF: sub_4016C2+20Dp
					; sub_401952+41p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 8	; switch 9 cases
		ja	short loc_4016B4 ; jumptable 00401650 default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_417244
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_401652:				; CODE XREF: sub_401637+19j
					; DATA XREF: .rdata:off_417244o
		mov	eax, 0		; jumptable 00401650 case 0
		jmp	short locret_4016C0
; ---------------------------------------------------------------------------

loc_401659:				; CODE XREF: sub_401637+19j
					; DATA XREF: .rdata:off_417244o
		mov	[esp+18h+var_18], 0Ch ;	jumptable 00401650 case	1
		call	sub_401592
		jmp	short locret_4016C0
; ---------------------------------------------------------------------------

loc_401667:				; CODE XREF: sub_401637+19j
					; DATA XREF: .rdata:off_417244o
		mov	[esp+18h+var_18], 5 ; jumptable	00401650 case 2
		call	sub_401592
		jmp	short locret_4016C0
; ---------------------------------------------------------------------------

loc_401675:				; CODE XREF: sub_401637+19j
					; DATA XREF: .rdata:off_417244o
		mov	[esp+18h+var_18], 0A8h ; jumptable 00401650 case 3
		call	sub_401577
		jmp	short locret_4016C0
; ---------------------------------------------------------------------------

loc_401683:				; CODE XREF: sub_401637+19j
					; DATA XREF: .rdata:off_417244o
		mov	[esp+18h+var_18], 4Ch ;	jumptable 00401650 case	4
		call	sub_401577
		jmp	short locret_4016C0
; ---------------------------------------------------------------------------

loc_401691:				; CODE XREF: sub_401637+19j
					; DATA XREF: .rdata:off_417244o
		mov	[esp+18h+var_18], 4Dh ;	jumptable 00401650 case	5
		call	sub_401577
		jmp	short locret_4016C0
; ---------------------------------------------------------------------------

loc_40169F:				; CODE XREF: sub_401637+19j
					; DATA XREF: .rdata:off_417244o
		call	sub_4015AD	; jumptable 00401650 case 6
		jmp	short locret_4016C0
; ---------------------------------------------------------------------------

loc_4016A6:				; CODE XREF: sub_401637+19j
					; DATA XREF: .rdata:off_417244o
		mov	[esp+18h+var_18], 55h ;	jumptable 00401650 case	8
		call	sub_401577
		jmp	short locret_4016C0
; ---------------------------------------------------------------------------

loc_4016B4:				; CODE XREF: sub_401637+Aj
					; sub_401637+19j
					; DATA XREF: ...
		mov	[esp+18h+var_18], 1 ; jumptable	00401650 default case
		call	sub_401577

locret_4016C0:				; CODE XREF: sub_401637+20j
					; sub_401637+2Ej ...
		leave
		retn
sub_401637	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4016C2	proc near		; CODE XREF: sub_4019CB+172p

Str		= dword	ptr -248h
Val		= dword	ptr -244h
var_240		= dword	ptr -240h
var_23C		= dword	ptr -23Ch
var_22C		= dword	ptr -22Ch
var_224		= byte ptr -224h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 244h
		mov	eax, ds:dword_41A024
		test	eax, eax
		jnz	loc_401777
		mov	[esp+248h+var_240], 1F3h
		lea	eax, [ebp+var_224]
		mov	[esp+248h+Val],	eax
		mov	[esp+248h+Str],	0
		call	_read
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jns	short loc_401722
		call	sub_4015AD
		mov	[esp+248h+Str],	eax
		call	gpg_strerror
		mov	[esp+248h+Val],	eax ; char
		mov	[esp+248h+Str],	offset aReadingPassphr ; "reading passphrase failed: %s\n"
		call	sub_40E5DD
		jmp	loc_401949
; ---------------------------------------------------------------------------

loc_401722:				; CODE XREF: sub_4016C2+3Cj
		lea	eax, [ebp+var_224]
		add	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	[esp+248h+Val],	0Ah ; Val
		lea	eax, [ebp+var_224]
		mov	[esp+248h+Str],	eax ; Str
		call	strchr
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		test	eax, eax
		jz	short loc_401777
		mov	edx, [ebp+var_30]
		lea	eax, [ebp+var_224]
		cmp	edx, eax
		jbe	short loc_401771
		mov	eax, [ebp+var_30]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_401771
		mov	eax, [ebp+var_30]
		sub	eax, 1
		mov	[ebp+var_30], eax

loc_401771:				; CODE XREF: sub_4016C2+97j
					; sub_4016C2+A4j
		mov	eax, [ebp+var_30]
		mov	byte ptr [eax],	0

loc_401777:				; CODE XREF: sub_4016C2+11j
					; sub_4016C2+8Aj
		mov	eax, ds:dword_41A024
		test	eax, eax
		jnz	short loc_401788
		lea	eax, [ebp+var_224]
		jmp	short loc_40178D
; ---------------------------------------------------------------------------

loc_401788:				; CODE XREF: sub_4016C2+BCj
		mov	eax, ds:dword_41A024

loc_40178D:				; CODE XREF: sub_4016C2+C4j
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_22C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_22C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+248h+var_240], 0
		mov	[esp+248h+Val],	eax
		mov	eax, [ebp+var_28]
		mov	[esp+248h+Str],	eax
		call	sub_403218
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jnz	short loc_4017F7
		call	sub_4015AD
		mov	[esp+248h+Str],	eax
		call	gpg_strerror
		mov	[esp+248h+Val],	eax ; char
		mov	[esp+248h+Str],	offset aCanNotEscapeSt ; "can not escape string: %s\n"
		call	sub_40E5DD
		jmp	loc_401949
; ---------------------------------------------------------------------------

loc_4017F7:				; CODE XREF: sub_4016C2+111j
		mov	eax, [ebp+var_2C]
		mov	[esp+248h+var_23C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+248h+var_240], eax
		mov	[esp+248h+Val],	offset aPreset_passphr ; "PRESET_PASSPHRASE %s -1 %s\n"
		lea	eax, [ebp+var_30]
		mov	[esp+248h+Str],	eax
		call	sub_4060B4
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_22C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_22C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_401859
; ---------------------------------------------------------------------------

loc_40184B:				; CODE XREF: sub_4016C2+19Bj
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1

loc_401859:				; CODE XREF: sub_4016C2+187j
		cmp	[ebp+var_10], 0
		jnz	short loc_40184B
		mov	eax, [ebp+var_2C]
		mov	[esp+248h+Str],	eax
		call	gcry_free
		cmp	[ebp+var_24], 0
		jns	short loc_401892
		call	sub_4015AD
		mov	[esp+248h+Str],	eax
		call	gpg_strerror
		mov	[esp+248h+Val],	eax ; char
		mov	[esp+248h+Str],	offset aCachingPassphr ; "caching passphrase failed: %s\n"
		call	sub_40E5DD
		jmp	loc_401949
; ---------------------------------------------------------------------------

loc_401892:				; CODE XREF: sub_4016C2+1ACj
		mov	eax, ds:dword_41A024
		test	eax, eax
		jnz	short loc_4018C1
		lea	eax, [ebp+var_224]
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 1F4h
		jmp	short loc_4018BB
; ---------------------------------------------------------------------------

loc_4018AD:				; CODE XREF: sub_4016C2+1FDj
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		add	[ebp+var_14], 1
		sub	[ebp+var_18], 1

loc_4018BB:				; CODE XREF: sub_4016C2+1E9j
		cmp	[ebp+var_18], 0
		jnz	short loc_4018AD

loc_4018C1:				; CODE XREF: sub_4016C2+1D7j
		mov	eax, [ebp+var_30]
		mov	[esp+248h+Str],	eax ; char *
		call	sub_402B7E
		mov	[esp+248h+Str],	eax
		call	sub_401637
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_4018FA
		mov	eax, [ebp+var_24]
		mov	[esp+248h+Str],	eax
		call	gpg_strerror
		mov	[esp+248h+Val],	eax ; char
		mov	[esp+248h+Str],	offset aCachingPassphr ; "caching passphrase failed: %s\n"
		call	sub_40E5DD
		jmp	short loc_401949
; ---------------------------------------------------------------------------

loc_4018FA:				; CODE XREF: sub_4016C2+219j
		mov	eax, [ebp+var_30]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_30]
		mov	[ebp+var_22C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_22C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_20], eax
		jmp	short loc_401938
; ---------------------------------------------------------------------------

loc_40192A:				; CODE XREF: sub_4016C2+27Aj
		mov	eax, [ebp+var_1C]
		mov	byte ptr [eax],	0
		add	[ebp+var_1C], 1
		sub	[ebp+var_20], 1

loc_401938:				; CODE XREF: sub_4016C2+266j
		cmp	[ebp+var_20], 0
		jnz	short loc_40192A
		mov	eax, [ebp+var_30]
		mov	[esp+248h+Str],	eax
		call	gcry_free

loc_401949:				; CODE XREF: sub_4016C2+5Bj
					; sub_4016C2+130j ...
		add	esp, 244h
		pop	edi
		pop	ebp
		retn
sub_4016C2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401952	proc near		; CODE XREF: sub_4019CB+187p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_20], eax
		mov	dword ptr [esp+28h+var_24], offset aClear_passphra ; "CLEAR_PASSPHRASE %s\n"
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_4060B4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_401985
		call	sub_4015AD
		mov	[ebp+var_C], eax
		jmp	short loc_40199B
; ---------------------------------------------------------------------------

loc_401985:				; CODE XREF: sub_401952+27j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	char *
		call	sub_402B7E
		mov	[esp+28h+var_28], eax
		call	sub_401637
		mov	[ebp+var_C], eax

loc_40199B:				; CODE XREF: sub_401952+31j
		cmp	[ebp+var_C], 0
		jz	short loc_4019BE
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aClearingPassph ; "clearing passphrase	failed:	%s\n"
		call	sub_40E5DD
		jmp	short locret_4019C9
; ---------------------------------------------------------------------------

loc_4019BE:				; CODE XREF: sub_401952+4Dj
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gcry_free

locret_4019C9:				; CODE XREF: sub_401952+6Aj
		leave
		retn
sub_401952	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_4019CB	proc near		; CODE XREF: sub_401180+265p

var_80		= dword	ptr -80h
Code		= dword	ptr -60h
var_5C		= byte ptr -5Ch
var_58		= dword	ptr -58h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_2C		= dword	ptr -2Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF0h
		sub	esp, 60h
		call	sub_414990
		mov	[esp+60h+var_4], 0
		mov	[esp+60h+var_8], 0
		mov	[esp+60h+Code],	offset sub_4015C2
		call	sub_410982
		mov	dword ptr [esp+60h+var_5C], 1 ;	int
		mov	[esp+60h+Code],	offset aGpgPresetPas_0 ; "gpg-preset-passphrase"
		call	sub_40E074
		call	sub_4060E4
		call	sub_40615C
		call	sub_406435
		mov	ds:dword_41A020, eax
		lea	eax, [ebp+arg_0]
		mov	[esp+60h+var_44], eax
		lea	eax, [ebp+arg_4]
		mov	[esp+60h+var_40], eax
		mov	[esp+60h+var_3C], 1
		jmp	short loc_401A9F
; ---------------------------------------------------------------------------

loc_401A35:				; CODE XREF: sub_4019CB+EAj
		mov	eax, [esp+60h+var_34]
		cmp	eax, 66h
		jz	short loc_401A81
		cmp	eax, 66h
		jg	short loc_401A4F
		cmp	eax, 50h
		jz	short loc_401A8B
		cmp	eax, 63h
		jz	short loc_401A77
		jmp	short loc_401A96
; ---------------------------------------------------------------------------

loc_401A4F:				; CODE XREF: sub_4019CB+76j
		cmp	eax, 76h
		jz	short loc_401A5D
		cmp	eax, 1F5h
		jz	short loc_401A6C
		jmp	short loc_401A96
; ---------------------------------------------------------------------------

loc_401A5D:				; CODE XREF: sub_4019CB+87j
		mov	eax, ds:dword_41A7C4
		add	eax, 1
		mov	ds:dword_41A7C4, eax
		jmp	short loc_401A9F
; ---------------------------------------------------------------------------

loc_401A6C:				; CODE XREF: sub_4019CB+8Ej
		mov	eax, [esp+60h+var_2C]
		mov	ds:dword_41A020, eax
		jmp	short loc_401A9F
; ---------------------------------------------------------------------------

loc_401A77:				; CODE XREF: sub_4019CB+80j
		mov	[esp+60h+var_4], 63h
		jmp	short loc_401A9F
; ---------------------------------------------------------------------------

loc_401A81:				; CODE XREF: sub_4019CB+71j
		mov	[esp+60h+var_4], 66h
		jmp	short loc_401A9F
; ---------------------------------------------------------------------------

loc_401A8B:				; CODE XREF: sub_4019CB+7Bj
		mov	eax, [esp+60h+var_2C]
		mov	ds:dword_41A024, eax
		jmp	short loc_401A9F
; ---------------------------------------------------------------------------

loc_401A96:				; CODE XREF: sub_4019CB+82j
					; sub_4019CB+90j
		mov	[esp+60h+var_38], 2
		nop

loc_401A9F:				; CODE XREF: sub_4019CB+68j
					; sub_4019CB+9Fj ...
		mov	dword ptr [esp+60h+var_5C], offset dword_416000
		lea	eax, [esp+60h+var_44]
		mov	[esp+60h+Code],	eax
		call	sub_40F6ED
		test	eax, eax
		jnz	loc_401A35
		mov	[esp+60h+Code],	0
		call	sub_40DD90
		test	eax, eax
		jz	short loc_401AD7
		mov	[esp+60h+Code],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_401AD7:				; CODE XREF: sub_4019CB+FEj
		mov	eax, [ebp+arg_0]
		cmp	eax, 1
		jnz	short loc_401AEA
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+60h+var_8], eax
		jmp	short loc_401AF6
; ---------------------------------------------------------------------------

loc_401AEA:				; CODE XREF: sub_4019CB+112j
		mov	[esp+60h+Code],	1
		call	sub_4107D6

loc_401AF6:				; CODE XREF: sub_4019CB+11Dj
		mov	eax, ds:dword_41A020
		mov	[esp+60h+var_58], 0
		mov	dword ptr [esp+60h+var_5C], offset aS_gpgAgent ; "S.gpg-agent"
		mov	[esp+60h+Code],	eax
		call	sub_4112CF
		mov	[esp+60h+var_C], eax
		mov	eax, [esp+60h+var_C]
		mov	[esp+60h+Code],	eax
		call	sub_4024FA
		mov	eax, [esp+60h+var_C]
		mov	[esp+60h+Code],	eax
		call	gcry_free
		cmp	[esp+60h+var_4], 63h
		jnz	short loc_401B44
		mov	eax, [esp+60h+var_8]
		mov	[esp+60h+Code],	eax
		call	sub_4016C2
		jmp	short loc_401B65
; ---------------------------------------------------------------------------

loc_401B44:				; CODE XREF: sub_4019CB+169j
		cmp	[esp+60h+var_4], 66h
		jnz	short loc_401B59
		mov	eax, [esp+60h+var_8]
		mov	[esp+60h+Code],	eax
		call	sub_401952
		jmp	short loc_401B65
; ---------------------------------------------------------------------------

loc_401B59:				; CODE XREF: sub_4019CB+17Ej
		mov	[esp+60h+Code],	offset aOneOfTheOption ; "one of the options --preset or --forget"...
		call	sub_40E5DD

loc_401B65:				; CODE XREF: sub_4019CB+177j
					; sub_4019CB+18Cj
		mov	[esp+60h+Code],	0
		call	$+5
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_401B9B
		mov	[esp+80h+var_80], 0
		call	sub_40DD90
		test	eax, eax
		jz	short loc_401B94
		mov	eax, 2
		jmp	short loc_401B99
; ---------------------------------------------------------------------------

loc_401B94:				; CODE XREF: sub_4019CB+1C0j
		mov	eax, 0

loc_401B99:				; CODE XREF: sub_4019CB+1C7j
		jmp	short loc_401B9E
; ---------------------------------------------------------------------------

loc_401B9B:				; CODE XREF: sub_4019CB+1B0j
		mov	eax, [ebp+arg_0]

loc_401B9E:				; CODE XREF: sub_4019CB:loc_401B99j
		mov	[ebp+arg_0], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+80h+var_80], eax ;	Code
		call	exit
sub_4019CB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401BAC	proc near		; CODE XREF: sub_401D24+88p
					; sub_401D24+97p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		jmp	short loc_401BC4
; ---------------------------------------------------------------------------

loc_401BB1:				; CODE XREF: sub_401BAC+20j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_401BC4:				; CODE XREF: sub_401BAC+3j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_401BB1
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_401BAC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401BD9(SOCKET, char *, int)
sub_401BD9	proc near		; CODE XREF: sub_401D24+F7p
					; .text:00402780p ...

s		= dword	ptr -28h
buf		= dword	ptr -24h
len		= dword	ptr -20h
flags		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		jmp	short loc_401C61
; ---------------------------------------------------------------------------

loc_401BE7:				; CODE XREF: sub_401BD9+8Cj
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+flags], 0 ; flags
		mov	[esp+28h+len], edx ; len
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+buf], edx ; buf
		mov	[esp+28h+s], eax ; s
		mov	eax, ds:send
		call	eax ; send
		sub	esp, 10h
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jns	short loc_401C55
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 4
		jnz	short loc_401C2D
		mov	[ebp+var_10], 0
		jmp	short loc_401C55
; ---------------------------------------------------------------------------

loc_401C2D:				; CODE XREF: sub_401BD9+49j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+28h+s], eax ; int
		call	strerror
		mov	[esp+28h+buf], eax ; char
		mov	[esp+28h+s], offset aWriteFailedS ; "write failed: %s\n"
		call	sub_40E5DD
		mov	eax, 2
		jmp	short locret_401C6C
; ---------------------------------------------------------------------------

loc_401C55:				; CODE XREF: sub_401BD9+3Bj
					; sub_401BD9+52j
		mov	eax, [ebp+var_10]
		sub	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		add	[ebp+arg_4], eax

loc_401C61:				; CODE XREF: sub_401BD9+Cj
		cmp	[ebp+var_C], 0
		jnz	short loc_401BE7
		mov	eax, 0

locret_401C6C:				; CODE XREF: sub_401BD9+7Aj
		leave
		retn
sub_401BD9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401C6E(SOCKET, char *, int)
sub_401C6E	proc near		; CODE XREF: sub_401D24+12Dp
					; sub_40210E+2A7p ...

s		= dword	ptr -28h
buf		= dword	ptr -24h
len		= dword	ptr -20h
flags		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	loc_401D12
; ---------------------------------------------------------------------------

loc_401C86:				; CODE XREF: sub_401C6E+A8j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+flags], 0 ; flags
		mov	[esp+28h+len], edx ; len
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+buf], edx ; buf
		mov	[esp+28h+s], eax ; s
		mov	eax, ds:recv
		call	eax ; recv
		sub	esp, 10h
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jns	short loc_401CCA
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_401D11
		mov	eax, 0FFFFFFFEh
		jmp	short locret_401D22
; ---------------------------------------------------------------------------

loc_401CCA:				; CODE XREF: sub_401C6E+45j
		cmp	[ebp+var_18], 0
		jnz	short loc_401CD7
		mov	eax, 0FFFFFFFDh
		jmp	short locret_401D22
; ---------------------------------------------------------------------------

loc_401CD7:				; CODE XREF: sub_401C6E+60j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_18]
		sub	[ebp+var_C], eax
		mov	eax, [ebp+var_18]
		add	[ebp+arg_4], eax
		mov	eax, [ebp+var_18]
		add	[ebp+var_14], eax
		jmp	short loc_401CF9
; ---------------------------------------------------------------------------

loc_401CF1:				; CODE XREF: sub_401C6E+99j
		sub	[ebp+var_18], 1
		add	[ebp+var_10], 1

loc_401CF9:				; CODE XREF: sub_401C6E+81j
		cmp	[ebp+var_18], 0
		jz	short loc_401D09
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_401CF1

loc_401D09:				; CODE XREF: sub_401C6E+8Fj
		cmp	[ebp+var_18], 0
		jnz	short loc_401D1E
		jmp	short loc_401D12
; ---------------------------------------------------------------------------

loc_401D11:				; CODE XREF: sub_401C6E+53j
		nop

loc_401D12:				; CODE XREF: sub_401C6E+13j
					; sub_401C6E+A1j
		cmp	[ebp+var_C], 0
		jnz	loc_401C86
		jmp	short loc_401D1F
; ---------------------------------------------------------------------------

loc_401D1E:				; CODE XREF: sub_401C6E+9Fj
		nop

loc_401D1F:				; CODE XREF: sub_401C6E+AEj
		mov	eax, [ebp+var_14]

locret_401D22:				; CODE XREF: sub_401C6E+5Aj
					; sub_401C6E+67j
		leave
		retn
sub_401C6E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401D24(SOCKET, int, int)
sub_401D24	proc near		; CODE XREF: sub_401EB5+5Bp
					; sub_401EB5+A5p ...

var_108		= dword	ptr -108h
var_104		= dword	ptr -104h
var_100		= dword	ptr -100h
var_EC		= dword	ptr -0ECh
var_DC		= byte ptr -0DCh
var_DB		= byte ptr -0DBh
var_DA		= byte ptr -0DAh
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 100h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_EC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_EC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_EC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_EC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 0Ah
		mov	[esp+108h+var_108], eax
		call	gcry_malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_401D99
		mov	eax, 1
		jmp	loc_401EAB
; ---------------------------------------------------------------------------

loc_401D99:				; CODE XREF: sub_401D24+69j
		mov	ebx, offset asc_417382 ; "\n"
		mov	[esp+108h+var_104], offset aOption ; "OPTION "
		mov	eax, [ebp+var_C]
		mov	[esp+108h+var_108], eax
		call	sub_401BAC
		mov	edx, [ebp+arg_4]
		mov	[esp+108h+var_104], edx
		mov	[esp+108h+var_108], eax
		call	sub_401BAC
		mov	[esp+108h+var_104], offset asc_41738C ;	"="
		mov	[esp+108h+var_108], eax
		call	sub_401BAC
		mov	edx, [ebp+arg_8]
		mov	[esp+108h+var_104], edx
		mov	[esp+108h+var_108], eax
		call	sub_401BAC
		movzx	edx, word ptr [ebx]
		mov	[eax], dx
		mov	eax, [ebp+var_C]
		mov	[ebp+var_EC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_EC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+108h+var_100], eax	; int
		mov	eax, [ebp+var_C]
		mov	[esp+108h+var_104], eax	; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+108h+var_108], eax	; SOCKET
		call	sub_401BD9
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+108h+var_108], eax
		call	gcry_free
		cmp	[ebp+var_10], 0
		jz	short loc_401E39
		mov	eax, [ebp+var_10]
		jmp	short loc_401EAB
; ---------------------------------------------------------------------------

loc_401E39:				; CODE XREF: sub_401D24+10Ej
		mov	[esp+108h+var_100], 0C7h ; int
		lea	eax, [ebp+var_DC]
		mov	[esp+108h+var_104], eax	; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+108h+var_108], eax	; SOCKET
		call	sub_401C6E
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jns	short loc_401E66
		mov	eax, [ebp+var_14]
		neg	eax
		jmp	short loc_401EAB
; ---------------------------------------------------------------------------

loc_401E66:				; CODE XREF: sub_401D24+139j
		cmp	[ebp+var_14], 2
		jg	short loc_401E73
		mov	eax, 3
		jmp	short loc_401EAB
; ---------------------------------------------------------------------------

loc_401E73:				; CODE XREF: sub_401D24+146j
		movzx	eax, [ebp+var_DC]
		cmp	al, 4Fh
		jnz	short loc_401EA6
		movzx	eax, [ebp+var_DB]
		cmp	al, 4Bh
		jnz	short loc_401EA6
		movzx	eax, [ebp+var_DA]
		cmp	al, 20h
		jz	short loc_401E9F
		movzx	eax, [ebp+var_DA]
		cmp	al, 0Ah
		jnz	short loc_401EA6

loc_401E9F:				; CODE XREF: sub_401D24+16Ej
		mov	eax, 0
		jmp	short loc_401EAB
; ---------------------------------------------------------------------------

loc_401EA6:				; CODE XREF: sub_401D24+158j
					; sub_401D24+163j ...
		mov	eax, 4

loc_401EAB:				; CODE XREF: sub_401D24+70j
					; sub_401D24+113j ...
		add	esp, 100h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_401D24	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401EB5(SOCKET)
sub_401EB5	proc near		; CODE XREF: sub_40210E+305p

VarName		= dword	ptr -58h
Source		= dword	ptr -54h
var_50		= dword	ptr -50h
var_3C		= dword	ptr -3Ch
Dest		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_C], 0
		mov	[esp+58h+VarName], offset VarName ; "DISPLAY"
		call	getenv
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_401F26
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax ;	int
		mov	[esp+58h+Source], offset aDisplay_0 ; "display"
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+VarName], eax ; SOCKET
		call	sub_401D24
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_401F26
		mov	eax, [ebp+var_C]
		jmp	loc_402108
; ---------------------------------------------------------------------------

loc_401F26:				; CODE XREF: sub_401EB5+44j
					; sub_401EB5+67j
		mov	[esp+58h+VarName], offset aGpg_tty ; "GPG_TTY"
		call	getenv
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_401F70
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_401F70
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_50], eax ;	int
		mov	[esp+58h+Source], offset aTtyname ; "ttyname"
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+VarName], eax ; SOCKET
		call	sub_401D24
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_401F70
		mov	eax, [ebp+var_C]
		jmp	loc_402108
; ---------------------------------------------------------------------------

loc_401F70:				; CODE XREF: sub_401EB5+84j
					; sub_401EB5+8Ej ...
		mov	[esp+58h+VarName], offset aTerm	; "TERM"
		call	getenv
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_18], 0
		jz	short loc_401FB6
		cmp	[ebp+var_1C], 0
		jz	short loc_401FB6
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_50], eax ;	int
		mov	[esp+58h+Source], offset aTtytype ; "ttytype"
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+VarName], eax ; SOCKET
		call	sub_401D24
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_401FB6
		mov	eax, [ebp+var_C]
		jmp	loc_402108
; ---------------------------------------------------------------------------

loc_401FB6:				; CODE XREF: sub_401EB5+CEj
					; sub_401EB5+D4j ...
		mov	[ebp+var_10], 0
		mov	[ebp+var_28], 0
		mov	[esp+58h+Source], 0
		mov	[esp+58h+VarName], 2
		call	setlocale
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_402036
		mov	eax, [ebp+var_10]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+58h+VarName], eax
		call	gcry_malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jnz	short loc_40201E
		mov	eax, 1
		jmp	loc_402108
; ---------------------------------------------------------------------------

loc_40201E:				; CODE XREF: sub_401EB5+15Dj
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Source], eax ;	Source
		mov	eax, [ebp+Dest]
		mov	[esp+58h+VarName], eax ; Dest
		call	strcpy
		mov	eax, [ebp+Dest]
		mov	[ebp+var_10], eax

loc_402036:				; CODE XREF: sub_401EB5+12Aj
		mov	[esp+58h+Source], offset byte_4173BB
		mov	[esp+58h+VarName], 2
		call	setlocale
		mov	[ebp+var_28], eax
		cmp	[ebp+var_18], 0
		jz	short loc_402076
		cmp	[ebp+var_28], 0
		jz	short loc_402076
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_50], eax ;	int
		mov	[esp+58h+Source], offset aLcCtype ; "lc-ctype"
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+VarName], eax ; SOCKET
		call	sub_401D24
		mov	[ebp+var_C], eax

loc_402076:				; CODE XREF: sub_401EB5+19Cj
					; sub_401EB5+1A2j
		cmp	[ebp+var_10], 0
		jz	short loc_40209A
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Source], eax
		mov	[esp+58h+VarName], 2
		call	setlocale
		mov	eax, [ebp+var_10]
		mov	[esp+58h+VarName], eax
		call	gcry_free

loc_40209A:				; CODE XREF: sub_401EB5+1C5j
		cmp	[ebp+var_C], 0
		jz	short loc_4020A5
		mov	eax, [ebp+var_C]
		jmp	short loc_402108
; ---------------------------------------------------------------------------

loc_4020A5:				; CODE XREF: sub_401EB5+1E9j
		mov	[esp+58h+VarName], offset aXauthority ;	"XAUTHORITY"
		call	getenv
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_4020D4
		mov	eax, [ebp+var_20]
		mov	[esp+58h+var_50], eax ;	int
		mov	[esp+58h+Source], offset aXauthority_0 ; "xauthority"
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+VarName], eax ; SOCKET
		call	sub_401D24

loc_4020D4:				; CODE XREF: sub_401EB5+203j
		mov	[esp+58h+VarName], offset aPinentry_user_ ; "PINENTRY_USER_DATA"
		call	getenv
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_402103
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_50], eax ;	int
		mov	[esp+58h+Source], offset aPinentryUserDa ; "pinentry-user-data"
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+VarName], eax ; SOCKET
		call	sub_401D24

loc_402103:				; CODE XREF: sub_401EB5+232j
		mov	eax, 0

loc_402108:				; CODE XREF: sub_401EB5+6Cj
					; sub_401EB5+B6j ...
		add	esp, 54h
		pop	edi
		pop	ebp
		retn
sub_401EB5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40210E	proc near		; CODE XREF: .text:004025B3p
					; sub_402B7E+17p

VarName		= dword	ptr -188h
Source		= dword	ptr -184h
var_180		= dword	ptr -180h
var_16C		= dword	ptr -16Ch
var_15C		= byte ptr -15Ch
var_15B		= byte ptr -15Bh
var_15A		= byte ptr -15Ah
var_94		= dword	ptr -94h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
s		= dword	ptr -18h
var_14		= byte ptr -14h
Dest		= dword	ptr -10h
Str		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 180h
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	[esp+188h+VarName], offset aGpg_agent_info ; "GPG_AGENT_INFO"
		call	getenv
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jz	short loc_402141
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_402149

loc_402141:				; CODE XREF: sub_40210E+27j
		mov	eax, ds:dword_41A028
		mov	[ebp+Str], eax

loc_402149:				; CODE XREF: sub_40210E+31j
		cmp	[ebp+Str], 0
		jz	short loc_402159
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40216F

loc_402159:				; CODE XREF: sub_40210E+3Fj
		mov	[esp+188h+VarName], offset aGpgAgentIsNotA ; "gpg-agent	is not available in this sess"...
		call	sub_40E5DD
		mov	eax, 5
		jmp	loc_40244A
; ---------------------------------------------------------------------------

loc_40216F:				; CODE XREF: sub_40210E+49j
		mov	eax, [ebp+Str]
		mov	[ebp+var_16C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_16C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+188h+VarName], eax
		call	gcry_malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jnz	short loc_4021B2
		mov	eax, 1
		jmp	loc_40244A
; ---------------------------------------------------------------------------

loc_4021B2:				; CODE XREF: sub_40210E+98j
		mov	eax, [ebp+Str]
		mov	[esp+188h+Source], eax ; Source
		mov	eax, [ebp+Dest]
		mov	[esp+188h+VarName], eax	; Dest
		call	strcpy
		mov	eax, [ebp+Dest]
		mov	[ebp+Str], eax
		mov	[esp+188h+Source], 3Bh ; char
		mov	eax, [ebp+Str]
		mov	[esp+188h+VarName], eax	; Str
		call	strchr
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jz	short loc_402202
		mov	eax, [ebp+Dest]
		cmp	eax, [ebp+Str]
		jz	short loc_402202
		mov	edx, [ebp+Dest]
		mov	eax, [ebp+Str]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		cmp	eax, 65h
		jbe	short loc_402218

loc_402202:				; CODE XREF: sub_40210E+D6j
					; sub_40210E+DEj
		mov	[esp+188h+VarName], offset aMalformedGpg_a ; "malformed	GPG_AGENT_INFO environment va"...
		call	sub_40E5DD
		mov	eax, 5
		jmp	loc_40244A
; ---------------------------------------------------------------------------

loc_402218:				; CODE XREF: sub_40210E+F2j
		mov	eax, [ebp+Dest]
		mov	byte ptr [eax],	0
		add	[ebp+Dest], 1
		jmp	short loc_402228
; ---------------------------------------------------------------------------

loc_402224:				; CODE XREF: sub_40210E+12Cj
		add	[ebp+Dest], 1

loc_402228:				; CODE XREF: sub_40210E+114j
		mov	eax, [ebp+Dest]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40223C
		mov	eax, [ebp+Dest]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Bh
		jnz	short loc_402224

loc_40223C:				; CODE XREF: sub_40210E+122j
		mov	eax, [ebp+Dest]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_402256
		mov	eax, [ebp+Dest]
		add	eax, 1
		mov	[esp+188h+VarName], eax	; Str
		call	atoi
		jmp	short loc_40225B
; ---------------------------------------------------------------------------

loc_402256:				; CODE XREF: sub_40210E+136j
		mov	eax, 0

loc_40225B:				; CODE XREF: sub_40210E+146j
		mov	dword ptr [ebp+var_14],	eax
		cmp	dword ptr [ebp+var_14],	1
		jz	short loc_402281
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+188h+Source], eax ; char
		mov	[esp+188h+VarName], offset aGpgAgentProtoc ; "gpg-agent	protocol version %d is not su"...
		call	sub_40E5DD
		mov	eax, 3
		jmp	loc_40244A
; ---------------------------------------------------------------------------

loc_402281:				; CODE XREF: sub_40210E+154j
		mov	[esp+188h+var_180], 0
		mov	[esp+188h+Source], 1
		mov	[esp+188h+VarName], 1
		call	sub_4125BA
		mov	[ebp+s], eax
		cmp	[ebp+s], 0FFFFFFFFh
		jnz	short loc_4022D1
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+188h+VarName], eax	; int
		call	strerror
		mov	[esp+188h+Source], eax ; char
		mov	[esp+188h+VarName], offset aCanTCreateSock ; "can't create socket: %s\n"
		call	sub_40E5DD
		mov	eax, 6
		jmp	loc_40244A
; ---------------------------------------------------------------------------

loc_4022D1:				; CODE XREF: sub_40210E+196j
		lea	eax, [ebp+var_94]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 1Ch
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	word ptr [ebp+var_94], 1
		mov	eax, [ebp+Str]
		mov	[esp+188h+Source], eax ; Source
		lea	eax, [ebp+var_94]
		add	eax, 8
		mov	[esp+188h+VarName], eax	; Dest
		call	strcpy
		lea	eax, [ebp+var_94]
		add	eax, 8
		mov	[ebp+var_16C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_16C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 8
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+188h+var_180], eax
		lea	eax, [ebp+var_94]
		mov	[esp+188h+Source], eax ; int
		mov	eax, [ebp+s]
		mov	[esp+188h+VarName], eax	; s
		call	sub_4125F3
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jnz	short loc_40239D
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+188h+VarName], eax	; int
		call	strerror
		mov	[esp+188h+var_180], eax
		mov	eax, [ebp+Str]
		mov	[esp+188h+Source], eax ; char
		mov	[esp+188h+VarName], offset aCanTConnectToS ; "can't connect to `%s': %s\n"
		call	sub_40E5DD
		mov	eax, [ebp+s]
		mov	[esp+188h+VarName], eax
		call	_close
		mov	eax, 2
		jmp	loc_40244A
; ---------------------------------------------------------------------------

loc_40239D:				; CODE XREF: sub_40210E+250j
		mov	[esp+188h+var_180], 0C8h ; int
		lea	eax, [ebp+var_15C]
		mov	[esp+188h+Source], eax ; char
		mov	eax, [ebp+s]
		mov	[esp+188h+VarName], eax	; SOCKET
		call	sub_401C6E
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 2
		jle	short loc_4023EF
		movzx	eax, [ebp+var_15C]
		cmp	al, 4Fh
		jnz	short loc_4023EF
		movzx	eax, [ebp+var_15B]
		cmp	al, 4Bh
		jnz	short loc_4023EF
		movzx	eax, [ebp+var_15A]
		cmp	al, 0Ah
		jz	short loc_40240D
		movzx	eax, [ebp+var_15A]
		cmp	al, 20h
		jz	short loc_40240D

loc_4023EF:				; CODE XREF: sub_40210E+2B3j
					; sub_40210E+2BEj ...
		mov	[esp+188h+VarName], offset aCommunicationP ; "communication problem with gpg-agent\n"
		call	sub_40E5DD
		mov	eax, [ebp+s]
		mov	[esp+188h+VarName], eax
		call	_close
		mov	eax, 3
		jmp	short loc_40244A
; ---------------------------------------------------------------------------

loc_40240D:				; CODE XREF: sub_40210E+2D4j
					; sub_40210E+2DFj
		mov	eax, [ebp+s]
		mov	[esp+188h+VarName], eax	; SOCKET
		call	sub_401EB5
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_40243D
		mov	[esp+188h+VarName], offset aProblemSetting ; "problem setting the gpg-agent options\n"
		call	sub_40E5DD
		mov	eax, [ebp+s]
		mov	[esp+188h+VarName], eax
		call	_close
		mov	eax, [ebp+var_20]
		jmp	short loc_40244A
; ---------------------------------------------------------------------------

loc_40243D:				; CODE XREF: sub_40210E+311j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+s]
		mov	[eax], edx
		mov	eax, 0

loc_40244A:				; CODE XREF: sub_40210E+5Cj
					; sub_40210E+9Fj ...
		add	esp, 180h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40210E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402454	proc near		; CODE XREF: .text:004026F2p
					; .text:00402711p ...

Dest		= dword	ptr -28h
Format		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_4024E4
; ---------------------------------------------------------------------------

loc_40246F:				; CODE XREF: sub_402454+9Bj
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_402489
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Bh
		jnz	short loc_4024B3

loc_402489:				; CODE XREF: sub_402454+26j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset Format ; "%%%02X"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+Format], eax ;	Format
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_10], 3
		jmp	short loc_4024E0
; ---------------------------------------------------------------------------

loc_4024B3:				; CODE XREF: sub_402454+33j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_4024CC
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	2Bh
		add	[ebp+var_10], 1
		jmp	short loc_4024E0
; ---------------------------------------------------------------------------

loc_4024CC:				; CODE XREF: sub_402454+6Aj
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1

loc_4024E0:				; CODE XREF: sub_402454+5Dj
					; sub_402454+76j
		add	[ebp+var_C], 1

loc_4024E4:				; CODE XREF: sub_402454+19j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_40246F
		mov	eax, [ebp+var_10]
		leave
		retn
sub_402454	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4024FA	proc near		; CODE XREF: sub_4019CB+153p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 20h
		mov	eax, ds:dword_41A028
		mov	[esp+28h+var_28], eax
		call	gcry_free
		cmp	[ebp+arg_0], 0
		jz	short loc_40257A
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 5
		mov	[esp+28h+var_28], eax
		call	gcry_malloc
		mov	ds:dword_41A028, eax
		mov	eax, ds:dword_41A028
		test	eax, eax
		jnz	short loc_402554
		mov	eax, 1
		jmp	short loc_402589
; ---------------------------------------------------------------------------

loc_402554:				; CODE XREF: sub_4024FA+51j
		mov	ebx, offset a01	; ";0;1"
		mov	eax, ds:dword_41A028
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	sub_401BAC
		mov	edx, [ebx]
		mov	[eax], edx
		movzx	edx, byte ptr [ebx+4]
		mov	[eax+4], dl
		jmp	short loc_402584
; ---------------------------------------------------------------------------

loc_40257A:				; CODE XREF: sub_4024FA+19j
		mov	ds:dword_41A028, 0

loc_402584:				; CODE XREF: sub_4024FA+7Ej
		mov	eax, 0

loc_402589:				; CODE XREF: sub_4024FA+58j
		add	esp, 20h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4024FA	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [ebp-10h], 0
		lea	eax, [ebp-2Ch]
		mov	[esp], eax
		call	sub_40210E
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jnz	loc_402A86
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_4025D2
		mov	dword ptr [ebp+8], offset asc_41752B ; "X"

loc_4025D2:				; CODE XREF: .text:004025C9j
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_4025DF
		mov	dword ptr [ebp+0Ch], offset asc_41752B ; "X"

loc_4025DF:				; CODE XREF: .text:004025D6j
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_4025EC
		mov	dword ptr [ebp+10h], offset asc_41752B ; "X"

loc_4025EC:				; CODE XREF: .text:004025E3j
		cmp	dword ptr [ebp+14h], 0
		jnz	short loc_4025F9
		mov	dword ptr [ebp+14h], offset asc_41752B ; "X"

loc_4025F9:				; CODE XREF: .text:004025F0j
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-3Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-3Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-3Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-3Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	ebx, eax
		mov	eax, [ebp+10h]
		mov	dword ptr [ebp-3Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-3Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	ebx, eax
		mov	eax, [ebp+14h]
		mov	dword ptr [ebp-3Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-3Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		lea	edx, [ebx+eax]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		add	eax, 1Fh
		mov	[esp], eax
		call	gcry_malloc
		mov	[ebp-24h], eax
		cmp	dword ptr [ebp-24h], 0
		jnz	short loc_4026A2
		mov	dword ptr [ebp-18h], 1
		jmp	loc_402A8A
; ---------------------------------------------------------------------------

loc_4026A2:				; CODE XREF: .text:00402694j
		mov	edx, offset aGet_passphrase ; "GET_PASSPHRASE "
		mov	eax, [ebp-24h]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	edx, [edx+0Ch]
		mov	[eax+0Ch], edx
		mov	eax, [ebp-24h]
		add	eax, 0Fh
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp+18h], 0
		jz	short loc_4026E5
		mov	dword ptr [esp+4], offset aCheck ; "--check "
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_401BAC
		mov	[ebp-14h], eax

loc_4026E5:				; CODE XREF: .text:004026CDj
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_402454
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	20h
		add	dword ptr [ebp-14h], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_402454
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	20h
		add	dword ptr [ebp-14h], 1
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_402454
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	20h
		add	dword ptr [ebp-14h], 1
		mov	eax, [ebp+14h]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_402454
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	0Ah
		add	dword ptr [ebp-14h], 1
		mov	edx, [ebp-14h]
		mov	eax, [ebp-24h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp-2Ch]
		mov	[esp+8], edx
		mov	edx, [ebp-24h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_401BD9
		mov	[ebp-18h], eax
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	gcry_free
		cmp	dword ptr [ebp-18h], 0
		jnz	loc_402A89
		mov	dword ptr [esp], 1F4h
		call	gcry_malloc_secure
		mov	[ebp-10h], eax
		mov	eax, [ebp-2Ch]
		mov	dword ptr [esp+8], 1F3h
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_401C6E
		mov	[ebp-28h], eax
		cmp	dword ptr [ebp-28h], 0
		jns	short loc_4027DC
		mov	eax, [ebp-28h]
		neg	eax
		mov	[ebp-18h], eax
		jmp	loc_402A8A
; ---------------------------------------------------------------------------

loc_4027DC:				; CODE XREF: .text:004027CDj
		cmp	dword ptr [ebp-28h], 2
		jg	short loc_4027EE
		mov	dword ptr [ebp-18h], 3
		jmp	loc_402A8A
; ---------------------------------------------------------------------------

loc_4027EE:				; CODE XREF: .text:004027E0j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 4Fh
		jnz	loc_40296E
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 4Bh
		jnz	loc_40296E
		mov	eax, [ebp-10h]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	loc_40296E
		mov	dword ptr [ebp-20h], 0
		mov	dword ptr [ebp-1Ch], 3
		jmp	loc_4028EF
; ---------------------------------------------------------------------------

loc_402831:				; CODE XREF: .text:0040290Fj
					; .text:0040292Dj ...
		mov	eax, [ebp-20h]
		mov	edx, [ebp-10h]
		lea	ecx, [edx+eax]
		mov	eax, [ebp-1Ch]
		add	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40285D
		mov	eax, [ebp-1Ch]
		add	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_402892
; ---------------------------------------------------------------------------

loc_40285D:				; CODE XREF: .text:00402845j
		mov	eax, [ebp-1Ch]
		add	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_40287E
		mov	eax, [ebp-1Ch]
		add	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_402890
; ---------------------------------------------------------------------------

loc_40287E:				; CODE XREF: .text:00402868j
		mov	eax, [ebp-1Ch]
		add	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_402890:				; CODE XREF: .text:0040287Cj
		mov	edx, eax

loc_402892:				; CODE XREF: .text:0040285Bj
		mov	eax, [ebp-1Ch]
		add	eax, 1
		add	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4028B3
		mov	eax, [ebp-1Ch]
		add	eax, 1
		add	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_4028E3
; ---------------------------------------------------------------------------

loc_4028B3:				; CODE XREF: .text:004028A0j
		mov	eax, [ebp-1Ch]
		add	eax, 1
		add	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4028D4
		mov	eax, [ebp-1Ch]
		add	eax, 1
		add	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_4028E3
; ---------------------------------------------------------------------------

loc_4028D4:				; CODE XREF: .text:004028C1j
		mov	eax, [ebp-1Ch]
		add	eax, 1
		add	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_4028E3:				; CODE XREF: .text:004028B1j
					; .text:004028D2j
		add	eax, edx
		mov	[ecx], al
		add	dword ptr [ebp-20h], 1
		add	dword ptr [ebp-1Ch], 2

loc_4028EF:				; CODE XREF: .text:0040282Cj
		mov	eax, [ebp-1Ch]
		cmp	eax, [ebp-28h]
		jge	short loc_402951
		mov	eax, [ebp-1Ch]
		add	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_402915
		mov	eax, [ebp-1Ch]
		add	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	loc_402831

loc_402915:				; CODE XREF: .text:00402902j
		mov	eax, [ebp-1Ch]
		add	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_402933
		mov	eax, [ebp-1Ch]
		add	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	loc_402831

loc_402933:				; CODE XREF: .text:00402920j
		mov	eax, [ebp-1Ch]
		add	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_402951
		mov	eax, [ebp-1Ch]
		add	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	loc_402831

loc_402951:				; CODE XREF: .text:004028F5j
					; .text:0040293Ej
		mov	eax, [ebp-20h]
		mov	edx, [ebp-10h]
		add	eax, edx
		mov	byte ptr [eax],	0
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], 0
		jmp	loc_402A8A
; ---------------------------------------------------------------------------

loc_40296E:				; CODE XREF: .text:004027F6j
					; .text:00402807j ...
		cmp	dword ptr [ebp-28h], 7
		jle	short loc_4029AD
		mov	dword ptr [esp+8], 7
		mov	dword ptr [esp+4], offset aErr111 ; "ERR 111"
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	memcmp
		test	eax, eax
		jnz	short loc_4029AD
		mov	eax, [ebp-10h]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4029FA
		mov	eax, [ebp-10h]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_4029FA

loc_4029AD:				; CODE XREF: .text:00402972j
					; .text:00402991j
		cmp	dword ptr [ebp-28h], 4
		jle	short loc_402A11
		mov	dword ptr [esp+8], 4
		mov	dword ptr [esp+4], offset aErr ; "ERR "
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	memcmp
		test	eax, eax
		jnz	short loc_402A11
		mov	eax, [ebp-10h]
		add	eax, 4
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	strtoul
		and	eax, 0FFFFh
		cmp	eax, 63h
		jnz	short loc_402A11

loc_4029FA:				; CODE XREF: .text:0040299Ej
					; .text:004029ABj
		mov	dword ptr [esp], offset	aCanceledByUser	; "canceled by user\n"
		call	sub_40E5B3
		mov	eax, [ebp+1Ch]
		mov	dword ptr [eax], 0
		jmp	short loc_402A8A
; ---------------------------------------------------------------------------

loc_402A11:				; CODE XREF: .text:004029B1j
					; .text:004029D0j ...
		cmp	dword ptr [ebp-28h], 4
		jle	short loc_402A71
		mov	dword ptr [esp+8], 4
		mov	dword ptr [esp+4], offset aErr ; "ERR "
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	memcmp
		test	eax, eax
		jnz	short loc_402A71
		mov	eax, [ebp-10h]
		add	eax, 4
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	strtoul
		and	eax, 0FFFFh
		cmp	eax, 55h
		jnz	short loc_402A67
		mov	dword ptr [ebp-18h], 8
		jmp	short loc_402A6F
; ---------------------------------------------------------------------------

loc_402A67:				; CODE XREF: .text:00402A5Cj
		mov	dword ptr [ebp-18h], 7
		nop

loc_402A6F:				; CODE XREF: .text:00402A65j
		jmp	short loc_402A8A
; ---------------------------------------------------------------------------

loc_402A71:				; CODE XREF: .text:00402A15j
					; .text:00402A34j
		mov	dword ptr [esp], offset	aProblemWithThe	; "problem with	the agent\n"
		call	sub_40E5DD
		mov	dword ptr [ebp-18h], 4
		jmp	short loc_402A8A
; ---------------------------------------------------------------------------

loc_402A86:				; CODE XREF: .text:004025BFj
		nop
		jmp	short loc_402A8A
; ---------------------------------------------------------------------------

loc_402A89:				; CODE XREF: .text:00402797j
		nop

loc_402A8A:				; CODE XREF: .text:0040269Dj
					; .text:004027D7j ...
		cmp	dword ptr [ebp+1Ch], 0
		jz	short loc_402A98
		mov	eax, [ebp+1Ch]
		mov	edx, [ebp-18h]
		mov	[eax], edx

loc_402A98:				; CODE XREF: .text:00402A8Ej
		mov	eax, [ebp-2Ch]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_402AAB
		mov	eax, [ebp-2Ch]
		mov	[esp], eax
		call	_close

loc_402AAB:				; CODE XREF: .text:00402A9Ej
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_402ABC
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	gcry_free

loc_402ABC:				; CODE XREF: .text:00402AAFj
		mov	eax, [ebp-0Ch]
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 224h
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-20Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-20Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		cmp	eax, 1C2h
		jbe	short loc_402B09
		mov	eax, 3
		jmp	short loc_402B75
; ---------------------------------------------------------------------------

loc_402B09:				; CODE XREF: .text:00402B00j
		mov	edx, offset aClear_passph_0 ; "CLEAR_PASSPHRASE	"
		lea	eax, [ebp-200h]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		movzx	edx, word ptr [edx+10h]
		mov	[eax+10h], dx
		lea	eax, [ebp-200h]
		add	eax, 11h
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_402454
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0Ah
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-0Ch], 1
		lea	eax, [ebp-200h]
		mov	[esp], eax
		call	sub_402B7E

loc_402B75:				; CODE XREF: .text:00402B07j
		add	esp, 224h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402B7E(char *)
sub_402B7E	proc near		; CODE XREF: sub_4016C2+205p
					; sub_401952+39p ...

Buf1		= dword	ptr -228h
Buf2		= dword	ptr -224h
Size		= dword	ptr -220h
var_20C		= dword	ptr -20Ch
var_208		= byte ptr -208h
var_207		= byte ptr -207h
var_201		= byte ptr -201h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 224h
		mov	[ebp+var_14], 0FFFFFFFFh
		lea	eax, [ebp+var_14]
		mov	[esp+228h+Buf1], eax
		call	sub_40210E
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_402D02
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_20C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_20C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_14]
		mov	[esp+228h+Size], edx ; int
		mov	edx, [ebp+arg_0]
		mov	[esp+228h+Buf2], edx ; char *
		mov	[esp+228h+Buf1], eax ; SOCKET
		call	sub_401BD9
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_402D05
		mov	eax, [ebp+var_14]
		mov	[esp+228h+Size], 1F3h ;	int
		lea	edx, [ebp+var_208]
		mov	[esp+228h+Buf2], edx ; char *
		mov	[esp+228h+Buf1], eax ; SOCKET
		call	sub_401C6E
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jns	short loc_402C22
		mov	eax, [ebp+var_10]
		neg	eax
		mov	[ebp+var_C], eax
		jmp	loc_402D06
; ---------------------------------------------------------------------------

loc_402C22:				; CODE XREF: sub_402B7E+95j
		cmp	[ebp+var_10], 2
		jg	short loc_402C34
		mov	[ebp+var_C], 3
		jmp	loc_402D06
; ---------------------------------------------------------------------------

loc_402C34:				; CODE XREF: sub_402B7E+A8j
		movzx	eax, [ebp+var_208]
		cmp	al, 4Fh
		jnz	short loc_402C4E
		movzx	eax, [ebp+var_207]
		cmp	al, 4Bh
		jz	loc_402D06

loc_402C4E:				; CODE XREF: sub_402B7E+BFj
		cmp	[ebp+var_10], 7
		jle	short loc_402C8C
		mov	[esp+228h+Size], 7 ; Size
		mov	[esp+228h+Buf2], offset	aErr111	; "ERR 111"
		lea	eax, [ebp+var_208]
		mov	[esp+228h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_402C8C
		movzx	eax, [ebp+var_201]
		cmp	al, 20h
		jz	short loc_402CDF
		movzx	eax, [ebp+var_201]
		cmp	al, 0Ah
		jz	short loc_402CDF

loc_402C8C:				; CODE XREF: sub_402B7E+D4j
					; sub_402B7E+F6j
		cmp	[ebp+var_10], 4
		jle	short loc_402CED
		mov	[esp+228h+Size], 4 ; Size
		mov	[esp+228h+Buf2], offset	aErr ; "ERR "
		lea	eax, [ebp+var_208]
		mov	[esp+228h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_402CED
		lea	eax, [ebp+var_208]
		add	eax, 4
		mov	[esp+228h+Size], 0 ; Radix
		mov	[esp+228h+Buf2], 0 ; char
		mov	[esp+228h+Buf1], eax ; Str
		call	strtoul
		and	eax, 0FFFFh
		cmp	eax, 63h
		jnz	short loc_402CED

loc_402CDF:				; CODE XREF: sub_402B7E+101j
					; sub_402B7E+10Cj
		mov	[esp+228h+Buf1], offset	aCanceledByUser	; "canceled by user\n"
		call	sub_40E5B3
		jmp	short loc_402D06
; ---------------------------------------------------------------------------

loc_402CED:				; CODE XREF: sub_402B7E+112j
					; sub_402B7E+134j ...
		mov	[esp+228h+Buf1], offset	aProblemWithThe	; "problem with	the agent\n"
		call	sub_40E5DD
		mov	[ebp+var_C], 4
		jmp	short loc_402D06
; ---------------------------------------------------------------------------

loc_402D02:				; CODE XREF: sub_402B7E+23j
		nop
		jmp	short loc_402D06
; ---------------------------------------------------------------------------

loc_402D05:				; CODE XREF: sub_402B7E+6Bj
		nop

loc_402D06:				; CODE XREF: sub_402B7E+9Fj
					; sub_402B7E+B1j ...
		mov	eax, [ebp+var_14]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_402D19
		mov	eax, [ebp+var_14]
		mov	[esp+228h+Buf1], eax
		call	_close

loc_402D19:				; CODE XREF: sub_402B7E+18Ej
		mov	eax, [ebp+var_C]
		add	esp, 224h
		pop	edi
		pop	ebp
		retn
sub_402B7E	endp

; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		mov	dword ptr [ebp-0Ch], 0
		jmp	loc_402E73
; ---------------------------------------------------------------------------

loc_402D40:				; CODE XREF: .text:00402E79j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_402D54
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_402D7C

loc_402D54:				; CODE XREF: .text:00402D48j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_402D68
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_402D7C

loc_402D68:				; CODE XREF: .text:00402D5Cj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_402DCA
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_402DCA

loc_402D7C:				; CODE XREF: .text:00402D52j
					; .text:00402D66j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_402D96
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_402DD4

loc_402D96:				; CODE XREF: .text:00402D87j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_402DB0
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_402DD4

loc_402DB0:				; CODE XREF: .text:00402DA1j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_402DCA
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	short loc_402DD4

loc_402DCA:				; CODE XREF: .text:00402D70j
					; .text:00402D7Aj ...
		mov	eax, 0FFFFFFFFh
		jmp	locret_402EDA
; ---------------------------------------------------------------------------

loc_402DD4:				; CODE XREF: .text:00402D94j
					; .text:00402DAEj ...
		mov	eax, [ebp-0Ch]
		mov	ecx, eax
		add	ecx, [ebp+0Ch]
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_402DF9
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_402E25
; ---------------------------------------------------------------------------

loc_402DF9:				; CODE XREF: .text:00402DE4j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_402E14
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_402E23
; ---------------------------------------------------------------------------

loc_402E14:				; CODE XREF: .text:00402E01j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_402E23:				; CODE XREF: .text:00402E12j
		mov	edx, eax

loc_402E25:				; CODE XREF: .text:00402DF7j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_402E40
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_402E67
; ---------------------------------------------------------------------------

loc_402E40:				; CODE XREF: .text:00402E30j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_402E5B
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_402E67
; ---------------------------------------------------------------------------

loc_402E5B:				; CODE XREF: .text:00402E4Bj
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_402E67:				; CODE XREF: .text:00402E3Ej
					; .text:00402E59j
		add	eax, edx
		mov	[ecx], al
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 2

loc_402E73:				; CODE XREF: .text:00402D3Bj
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jb	loc_402D40
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_402EB1
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_402EAA
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_402EB1

loc_402EAA:				; CODE XREF: .text:00402E91j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_402EDA
; ---------------------------------------------------------------------------

loc_402EB1:				; CODE XREF: .text:00402E87j
					; .text:00402EA8j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jz	short loc_402EC0
		mov	eax, 0FFFFFFFFh
		jmp	short locret_402EDA
; ---------------------------------------------------------------------------

loc_402EC0:				; CODE XREF: .text:00402EB7j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_402ECE
		add	dword ptr [ebp-10h], 1

loc_402ECE:				; CODE XREF: .text:00402EC8j
		mov	edx, [ebp-10h]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_402EDA:				; CODE XREF: .text:00402DCFj
					; .text:00402EAFj ...
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-0Ch], 0
		jmp	loc_403071
; ---------------------------------------------------------------------------

loc_402EFB:				; CODE XREF: .text:00403077j
		cmp	dword ptr [ebp-0Ch], 1
		jnz	short loc_402F18
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_402F18
		mov	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_402F3E
; ---------------------------------------------------------------------------

loc_402F18:				; CODE XREF: .text:00402EFFj
					; .text:00402F09j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_402F2E
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_402F2E
		add	dword ptr [ebp-10h], 1
		jmp	short loc_402F3E
; ---------------------------------------------------------------------------

loc_402F2E:				; CODE XREF: .text:00402F1Cj
					; .text:00402F26j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_402F3E
		mov	eax, 0FFFFFFFFh
		jmp	locret_4030E9
; ---------------------------------------------------------------------------

loc_402F3E:				; CODE XREF: .text:00402F16j
					; .text:00402F2Cj ...
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_402F52
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_402F7A

loc_402F52:				; CODE XREF: .text:00402F46j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_402F66
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_402F7A

loc_402F66:				; CODE XREF: .text:00402F5Aj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_402FC8
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_402FC8

loc_402F7A:				; CODE XREF: .text:00402F50j
					; .text:00402F64j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_402F94
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_402FD2

loc_402F94:				; CODE XREF: .text:00402F85j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_402FAE
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_402FD2

loc_402FAE:				; CODE XREF: .text:00402F9Fj
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_402FC8
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	short loc_402FD2

loc_402FC8:				; CODE XREF: .text:00402F6Ej
					; .text:00402F78j ...
		mov	eax, 0FFFFFFFFh
		jmp	locret_4030E9
; ---------------------------------------------------------------------------

loc_402FD2:				; CODE XREF: .text:00402F92j
					; .text:00402FACj ...
		mov	eax, [ebp-0Ch]
		mov	ecx, eax
		add	ecx, [ebp+0Ch]
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_402FF7
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_403023
; ---------------------------------------------------------------------------

loc_402FF7:				; CODE XREF: .text:00402FE2j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_403012
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_403021
; ---------------------------------------------------------------------------

loc_403012:				; CODE XREF: .text:00402FFFj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_403021:				; CODE XREF: .text:00403010j
		mov	edx, eax

loc_403023:				; CODE XREF: .text:00402FF5j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40303E
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_403065
; ---------------------------------------------------------------------------

loc_40303E:				; CODE XREF: .text:0040302Ej
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_403059
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_403065
; ---------------------------------------------------------------------------

loc_403059:				; CODE XREF: .text:00403049j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_403065:				; CODE XREF: .text:0040303Cj
					; .text:00403057j
		add	eax, edx
		mov	[ecx], al
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 2

loc_403071:				; CODE XREF: .text:00402EF6j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jb	loc_402EFB
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_40308E
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4030E9
; ---------------------------------------------------------------------------

loc_40308E:				; CODE XREF: .text:00403085j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4030C0
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_4030B9
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_4030C0

loc_4030B9:				; CODE XREF: .text:004030A0j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4030E9
; ---------------------------------------------------------------------------

loc_4030C0:				; CODE XREF: .text:00403096j
					; .text:004030B7j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jz	short loc_4030CF
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4030E9
; ---------------------------------------------------------------------------

loc_4030CF:				; CODE XREF: .text:004030C6j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4030DD
		add	dword ptr [ebp-10h], 1

loc_4030DD:				; CODE XREF: .text:004030D7j
		mov	edx, [ebp-10h]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_4030E9:				; CODE XREF: .text:00402F39j
					; .text:00402FCDj ...
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4030EB	proc near		; CODE XREF: sub_403218+22p
					; .text:00403263p

var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jnz	short loc_403167
		cmp	[ebp+arg_C], 0
		jz	short loc_403104
		mov	eax, 3
		jmp	short loc_403109
; ---------------------------------------------------------------------------

loc_403104:				; CODE XREF: sub_4030EB+10j
		mov	eax, 2

loc_403109:				; CODE XREF: sub_4030EB+17j
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		imul	eax, [ebp+arg_4]
		add	eax, 1
		mov	[ebp+var_18], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_403149
		mov	eax, [ebp+var_18]
		sub	eax, 1
		mov	edx, 0
		div	[ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jz	short loc_403149
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0
		jmp	locret_403216
; ---------------------------------------------------------------------------

loc_403149:				; CODE XREF: sub_4030EB+32j
					; sub_4030EB+45j
		mov	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	gcry_malloc
		mov	[ebp+arg_8], eax
		cmp	[ebp+arg_8], 0
		jnz	short loc_403167
		mov	eax, 0
		jmp	locret_403216
; ---------------------------------------------------------------------------

loc_403167:				; CODE XREF: sub_4030EB+Aj
					; sub_4030EB+70j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		jmp	loc_403203
; ---------------------------------------------------------------------------

loc_403178:				; CODE XREF: sub_4030EB+11Cj
		cmp	[ebp+arg_C], 0
		jz	short loc_403190
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_0]
		jz	short loc_403190
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	3Ah
		add	[ebp+var_10], 1

loc_403190:				; CODE XREF: sub_4030EB+91j
					; sub_4030EB+99j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_4031B2
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 30h
		jmp	short loc_4031BE
; ---------------------------------------------------------------------------

loc_4031B2:				; CODE XREF: sub_4030EB+B7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 37h

loc_4031BE:				; CODE XREF: sub_4030EB+C5j
		mov	edx, [ebp+var_10]
		mov	[edx], al
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_4031E6
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_4031F2
; ---------------------------------------------------------------------------

loc_4031E6:				; CODE XREF: sub_4030EB+EBj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 37h

loc_4031F2:				; CODE XREF: sub_4030EB+F9j
		mov	edx, [ebp+var_10]
		mov	[edx], al
		add	[ebp+var_10], 1
		sub	[ebp+arg_4], 1
		add	[ebp+var_C], 1

loc_403203:				; CODE XREF: sub_4030EB+88j
		cmp	[ebp+arg_4], 0
		jnz	loc_403178
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_8]

locret_403216:				; CODE XREF: sub_4030EB+59j
					; sub_4030EB+77j
		leave
		retn
sub_4030EB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403218	proc near		; CODE XREF: sub_4016C2+105p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_4030EB
		leave
		retn
sub_403218	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 1
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4030EB
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40326A	proc near		; CODE XREF: .text:0040354Ep
					; .text:004035D5p

C		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_18], 0
		cmp	[ebp+arg_C], 0
		jz	short loc_40328C
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0

loc_40328C:				; CODE XREF: sub_40326A+17j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_4032A3
; ---------------------------------------------------------------------------

loc_40329B:				; CODE XREF: sub_40326A+8Dj
					; sub_40326A+A7j ...
		add	[ebp+var_C], 2
		add	[ebp+var_14], 1

loc_4032A3:				; CODE XREF: sub_40326A+2Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4032B7
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_4032DF

loc_4032B7:				; CODE XREF: sub_40326A+41j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_4032CB
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_4032DF

loc_4032CB:				; CODE XREF: sub_40326A+55j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_403331
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_403331

loc_4032DF:				; CODE XREF: sub_40326A+4Bj
					; sub_40326A+5Fj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4032F9
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40329B

loc_4032F9:				; CODE XREF: sub_40326A+80j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_403313
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_40329B

loc_403313:				; CODE XREF: sub_40326A+9Aj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_403331
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	loc_40329B

loc_403331:				; CODE XREF: sub_40326A+69j
					; sub_40326A+73j ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_403366
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_40335C
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_403366

loc_40335C:				; CODE XREF: sub_40326A+D9j
		mov	eax, 0
		jmp	locret_403529
; ---------------------------------------------------------------------------

loc_403366:				; CODE XREF: sub_40326A+CFj
					; sub_40326A+F0j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_0]
		jz	short loc_403388
		mov	eax, [ebp+var_C]
		sub	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jnz	short loc_403388
		mov	eax, [ebp+var_C]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	short loc_40338F

loc_403388:				; CODE XREF: sub_40326A+102j
					; sub_40326A+10Fj
		mov	eax, 1
		jmp	short loc_403394
; ---------------------------------------------------------------------------

loc_40338F:				; CODE XREF: sub_40326A+11Cj
		mov	eax, 0

loc_403394:				; CODE XREF: sub_40326A+123j
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_4033A1
		add	[ebp+var_14], 1

loc_4033A1:				; CODE XREF: sub_40326A+131j
		cmp	[ebp+arg_4], 0
		jz	loc_403513
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_8]
		jbe	short loc_4033BD
		mov	eax, 0
		jmp	locret_403529
; ---------------------------------------------------------------------------

loc_4033BD:				; CODE XREF: sub_40326A+147j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_40346E
; ---------------------------------------------------------------------------

loc_4033CF:				; CODE XREF: sub_40326A+258j
					; sub_40326A+276j ...
		mov	eax, [ebp+var_10]
		mov	ecx, eax
		add	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4033F4
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_403420
; ---------------------------------------------------------------------------

loc_4033F4:				; CODE XREF: sub_40326A+175j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_40340F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_40341E
; ---------------------------------------------------------------------------

loc_40340F:				; CODE XREF: sub_40326A+192j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_40341E:				; CODE XREF: sub_40326A+1A3j
		mov	edx, eax

loc_403420:				; CODE XREF: sub_40326A+188j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40343B
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_403462
; ---------------------------------------------------------------------------

loc_40343B:				; CODE XREF: sub_40326A+1C1j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_403456
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_403462
; ---------------------------------------------------------------------------

loc_403456:				; CODE XREF: sub_40326A+1DCj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_403462:				; CODE XREF: sub_40326A+1CFj
					; sub_40326A+1EAj
		add	eax, edx
		mov	[ecx], al
		add	[ebp+var_10], 1
		add	[ebp+var_C], 2

loc_40346E:				; CODE XREF: sub_40326A+160j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_403482
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_4034AA

loc_403482:				; CODE XREF: sub_40326A+20Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_403496
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_4034AA

loc_403496:				; CODE XREF: sub_40326A+220j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_403504
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_403504

loc_4034AA:				; CODE XREF: sub_40326A+216j
					; sub_40326A+22Aj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4034C8
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	loc_4033CF

loc_4034C8:				; CODE XREF: sub_40326A+24Bj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_4034E6
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	loc_4033CF

loc_4034E6:				; CODE XREF: sub_40326A+269j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_403504
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	loc_4033CF

loc_403504:				; CODE XREF: sub_40326A+234j
					; sub_40326A+23Ej ...
		cmp	[ebp+var_18], 0
		jz	short loc_403513
		mov	eax, [ebp+var_10]
		add	eax, [ebp+arg_4]
		mov	byte ptr [eax],	0

loc_403513:				; CODE XREF: sub_40326A+13Bj
					; sub_40326A+29Ej
		cmp	[ebp+arg_C], 0
		jz	short loc_403526
		mov	eax, [ebp+var_14]
		sub	eax, 1
		mov	edx, eax
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_403526:				; CODE XREF: sub_40326A+2ADj
		mov	eax, [ebp+var_C]

locret_403529:				; CODE XREF: sub_40326A+F7j
					; sub_40326A+14Ej
		leave
		retn
sub_40326A	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40326A
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40357F
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_40356B
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0

loc_40356B:				; CODE XREF: .text:00403560j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	short locret_4035FD
; ---------------------------------------------------------------------------

loc_40357F:				; CODE XREF: .text:0040355Aj
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_403598
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+0Ch]
		mov	[eax], edx

loc_403598:				; CODE XREF: .text:00403583j
		mov	eax, [ebp-14h]
		add	eax, 1
		mov	[esp], eax
		call	gcry_malloc
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_4035B6
		mov	eax, 0
		jmp	short locret_4035FD
; ---------------------------------------------------------------------------

loc_4035B6:				; CODE XREF: .text:004035ADj
		mov	eax, [ebp-14h]
		add	eax, 1
		mov	dword ptr [esp+0Ch], 0
		mov	[esp+8], eax
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40326A
		test	eax, eax
		jnz	short loc_4035FA
		mov	dword ptr [esp+8], offset aHex2str_alloc ; "hex2str_alloc"
		mov	dword ptr [esp+4], 0F4h
		mov	dword ptr [esp], offset	a____Gnupg22_0_	; "../../gnupg2-2.0.30/common/convert.c"
		call	sub_40E76C
; ---------------------------------------------------------------------------

loc_4035FA:				; CODE XREF: .text:004035DCj
		mov	eax, [ebp-10h]

locret_4035FD:				; CODE XREF: .text:0040357Dj
					; .text:004035B4j
		leave
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403600	proc near		; CODE XREF: sub_403801+6E9p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 12h	; switch 19 cases
		ja	loc_4037FF	; jumptable 00403619 default case
		mov	eax, ds:off_4175C4[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40361B:				; CODE XREF: sub_403600+19j
					; DATA XREF: .rdata:off_4175C4o
		mov	eax, [ebp+arg_0] ; jumptable 00403619 case 0
		mov	dword ptr [eax+24h], 0
		jmp	loc_4037FF	; jumptable 00403619 default case
; ---------------------------------------------------------------------------

loc_40362A:				; CODE XREF: sub_403600+19j
					; DATA XREF: .rdata:off_4175C4o
		mov	eax, [ebp+arg_0] ; jumptable 00403619 case 1
		mov	eax, [eax+10h]
		cmp	eax, 7		; switch 8 cases
		ja	short loc_403692 ; jumptable 0040363C default case
		mov	eax, ds:off_417610[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40363E:				; CODE XREF: sub_403600+3Cj
					; DATA XREF: .rdata:off_417610o
		mov	eax, [ebp+arg_0] ; jumptable 0040363C case 1
		mov	dword ptr [eax+24h], 2
		jmp	short loc_40369D
; ---------------------------------------------------------------------------

loc_40364A:				; CODE XREF: sub_403600+3Cj
					; DATA XREF: .rdata:off_417610o
		mov	eax, [ebp+arg_0] ; jumptable 0040363C case 2
		mov	dword ptr [eax+24h], 4
		jmp	short loc_40369D
; ---------------------------------------------------------------------------

loc_403656:				; CODE XREF: sub_403600+3Cj
					; DATA XREF: .rdata:off_417610o
		mov	eax, [ebp+arg_0] ; jumptable 0040363C case 3
		mov	dword ptr [eax+24h], 8
		jmp	short loc_40369D
; ---------------------------------------------------------------------------

loc_403662:				; CODE XREF: sub_403600+3Cj
					; DATA XREF: .rdata:off_417610o
		mov	eax, [ebp+arg_0] ; jumptable 0040363C case 4
		mov	dword ptr [eax+24h], 0Ah
		jmp	short loc_40369D
; ---------------------------------------------------------------------------

loc_40366E:				; CODE XREF: sub_403600+3Cj
					; DATA XREF: .rdata:off_417610o
		mov	eax, [ebp+arg_0] ; jumptable 0040363C case 5
		mov	dword ptr [eax+24h], 0Fh
		jmp	short loc_40369D
; ---------------------------------------------------------------------------

loc_40367A:				; CODE XREF: sub_403600+3Cj
					; DATA XREF: .rdata:off_417610o
		mov	eax, [ebp+arg_0] ; jumptable 0040363C case 6
		mov	dword ptr [eax+24h], 11h
		jmp	short loc_40369D
; ---------------------------------------------------------------------------

loc_403686:				; CODE XREF: sub_403600+3Cj
					; DATA XREF: .rdata:off_417610o
		mov	eax, [ebp+arg_0] ; jumptable 0040363C case 7
		mov	dword ptr [eax+24h], 12h
		jmp	short loc_40369D
; ---------------------------------------------------------------------------

loc_403692:				; CODE XREF: sub_403600+33j
					; sub_403600+3Cj
					; DATA XREF: ...
		mov	eax, [ebp+arg_0] ; jumptable 0040363C default case
		mov	dword ptr [eax+24h], 6
		nop

loc_40369D:				; CODE XREF: sub_403600+48j
					; sub_403600+54j ...
		jmp	loc_4037FF	; jumptable 00403619 default case
; ---------------------------------------------------------------------------

loc_4036A2:				; CODE XREF: sub_403600+19j
					; DATA XREF: .rdata:off_4175C4o
		mov	eax, [ebp+arg_0] ; jumptable 00403619 cases 2-5
		mov	eax, [eax+10h]
		cmp	eax, 7		; switch 8 cases
		ja	short loc_40370A ; jumptable 004036B4 default case
		mov	eax, ds:off_417630[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4036B6:				; CODE XREF: sub_403600+B4j
					; DATA XREF: .rdata:off_417630o
		mov	eax, [ebp+arg_0] ; jumptable 004036B4 case 1
		mov	dword ptr [eax+24h], 3
		jmp	short loc_403715
; ---------------------------------------------------------------------------

loc_4036C2:				; CODE XREF: sub_403600+B4j
					; DATA XREF: .rdata:off_417630o
		mov	eax, [ebp+arg_0] ; jumptable 004036B4 case 2
		mov	dword ptr [eax+24h], 5
		jmp	short loc_403715
; ---------------------------------------------------------------------------

loc_4036CE:				; CODE XREF: sub_403600+B4j
					; DATA XREF: .rdata:off_417630o
		mov	eax, [ebp+arg_0] ; jumptable 004036B4 case 3
		mov	dword ptr [eax+24h], 9
		jmp	short loc_403715
; ---------------------------------------------------------------------------

loc_4036DA:				; CODE XREF: sub_403600+B4j
					; DATA XREF: .rdata:off_417630o
		mov	eax, [ebp+arg_0] ; jumptable 004036B4 case 4
		mov	dword ptr [eax+24h], 0Bh
		jmp	short loc_403715
; ---------------------------------------------------------------------------

loc_4036E6:				; CODE XREF: sub_403600+B4j
					; DATA XREF: .rdata:off_417630o
		mov	eax, [ebp+arg_0] ; jumptable 004036B4 case 5
		mov	dword ptr [eax+24h], 10h
		jmp	short loc_403715
; ---------------------------------------------------------------------------

loc_4036F2:				; CODE XREF: sub_403600+B4j
					; DATA XREF: .rdata:off_417630o
		mov	eax, [ebp+arg_0] ; jumptable 004036B4 case 6
		mov	dword ptr [eax+24h], 11h
		jmp	short loc_403715
; ---------------------------------------------------------------------------

loc_4036FE:				; CODE XREF: sub_403600+B4j
					; DATA XREF: .rdata:off_417630o
		mov	eax, [ebp+arg_0] ; jumptable 004036B4 case 7
		mov	dword ptr [eax+24h], 12h
		jmp	short loc_403715
; ---------------------------------------------------------------------------

loc_40370A:				; CODE XREF: sub_403600+ABj
					; sub_403600+B4j
					; DATA XREF: ...
		mov	eax, [ebp+arg_0] ; jumptable 004036B4 default case
		mov	dword ptr [eax+24h], 7
		nop

loc_403715:				; CODE XREF: sub_403600+C0j
					; sub_403600+CCj ...
		jmp	loc_4037FF	; jumptable 00403619 default case
; ---------------------------------------------------------------------------

loc_40371A:				; CODE XREF: sub_403600+19j
					; DATA XREF: .rdata:off_4175C4o
		mov	eax, [ebp+arg_0] ; jumptable 00403619 cases 6-13
		mov	eax, [eax+10h]
		cmp	eax, 3
		jz	short loc_403736
		cmp	eax, 8
		jnz	short loc_403742
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0Dh
		jmp	short loc_40374D
; ---------------------------------------------------------------------------

loc_403736:				; CODE XREF: sub_403600+123j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0Ch
		jmp	short loc_40374D
; ---------------------------------------------------------------------------

loc_403742:				; CODE XREF: sub_403600+128j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0Ch
		nop

loc_40374D:				; CODE XREF: sub_403600+134j
					; sub_403600+140j
		jmp	loc_4037FF	; jumptable 00403619 default case
; ---------------------------------------------------------------------------

loc_403752:				; CODE XREF: sub_403600+19j
					; DATA XREF: .rdata:off_4175C4o
		mov	eax, [ebp+arg_0] ; jumptable 00403619 case 14
		mov	dword ptr [eax+24h], 6
		jmp	loc_4037FF	; jumptable 00403619 default case
; ---------------------------------------------------------------------------

loc_403761:				; CODE XREF: sub_403600+19j
					; DATA XREF: .rdata:off_4175C4o
		mov	eax, [ebp+arg_0] ; jumptable 00403619 case 15
		mov	dword ptr [eax+24h], 0Eh
		jmp	loc_4037FF	; jumptable 00403619 default case
; ---------------------------------------------------------------------------

loc_403770:				; CODE XREF: sub_403600+19j
					; DATA XREF: .rdata:off_4175C4o
		mov	eax, [ebp+arg_0] ; jumptable 00403619 case 16
		mov	dword ptr [eax+24h], 13h
		jmp	loc_4037FF	; jumptable 00403619 default case
; ---------------------------------------------------------------------------

loc_40377F:				; CODE XREF: sub_403600+19j
					; DATA XREF: .rdata:off_4175C4o
		mov	eax, [ebp+arg_0] ; jumptable 00403619 case 17
		mov	dword ptr [eax+24h], 0Eh
		jmp	short loc_4037FF ; jumptable 00403619 default case
; ---------------------------------------------------------------------------

loc_40378B:				; CODE XREF: sub_403600+19j
					; DATA XREF: .rdata:off_4175C4o
		mov	eax, [ebp+arg_0] ; jumptable 00403619 case 18
		mov	eax, [eax+10h]
		cmp	eax, 7		; switch 8 cases
		ja	short loc_4037F3 ; jumptable 0040379D default case
		mov	eax, ds:off_417650[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40379F:				; CODE XREF: sub_403600+19Dj
					; DATA XREF: .rdata:off_417650o
		mov	eax, [ebp+arg_0] ; jumptable 0040379D case 1
		mov	dword ptr [eax+24h], 15h
		jmp	short loc_4037FE
; ---------------------------------------------------------------------------

loc_4037AB:				; CODE XREF: sub_403600+19Dj
					; DATA XREF: .rdata:off_417650o
		mov	eax, [ebp+arg_0] ; jumptable 0040379D case 2
		mov	dword ptr [eax+24h], 16h
		jmp	short loc_4037FE
; ---------------------------------------------------------------------------

loc_4037B7:				; CODE XREF: sub_403600+19Dj
					; DATA XREF: .rdata:off_417650o
		mov	eax, [ebp+arg_0] ; jumptable 0040379D case 3
		mov	dword ptr [eax+24h], 18h
		jmp	short loc_4037FE
; ---------------------------------------------------------------------------

loc_4037C3:				; CODE XREF: sub_403600+19Dj
					; DATA XREF: .rdata:off_417650o
		mov	eax, [ebp+arg_0] ; jumptable 0040379D case 4
		mov	dword ptr [eax+24h], 19h
		jmp	short loc_4037FE
; ---------------------------------------------------------------------------

loc_4037CF:				; CODE XREF: sub_403600+19Dj
					; DATA XREF: .rdata:off_417650o
		mov	eax, [ebp+arg_0] ; jumptable 0040379D case 5
		mov	dword ptr [eax+24h], 1Ah
		jmp	short loc_4037FE
; ---------------------------------------------------------------------------

loc_4037DB:				; CODE XREF: sub_403600+19Dj
					; DATA XREF: .rdata:off_417650o
		mov	eax, [ebp+arg_0] ; jumptable 0040379D case 6
		mov	dword ptr [eax+24h], 1Bh
		jmp	short loc_4037FE
; ---------------------------------------------------------------------------

loc_4037E7:				; CODE XREF: sub_403600+19Dj
					; DATA XREF: .rdata:off_417650o
		mov	eax, [ebp+arg_0] ; jumptable 0040379D case 7
		mov	dword ptr [eax+24h], 1Ch
		jmp	short loc_4037FE
; ---------------------------------------------------------------------------

loc_4037F3:				; CODE XREF: sub_403600+194j
					; sub_403600+19Dj
					; DATA XREF: ...
		mov	eax, [ebp+arg_0] ; jumptable 0040379D default case
		mov	dword ptr [eax+24h], 17h
		nop

loc_4037FE:				; CODE XREF: sub_403600+1A9j
					; sub_403600+1B5j ...
		nop

loc_4037FF:				; CODE XREF: sub_403600+Cj
					; sub_403600+25j ...
		pop	ebp		; jumptable 00403619 default case
		retn
sub_403600	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403801	proc near		; CODE XREF: sub_40564B+58p

NumOfElements	= dword	ptr -68h
SizeOfElements	= dword	ptr -64h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Memory		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+Memory], eax
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_0], 0
		jnz	loc_403F05
		jmp	loc_403F44
; ---------------------------------------------------------------------------

loc_403825:				; CODE XREF: sub_403801+70Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_403EFB
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_403F2B
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	loc_403EFE
		mov	[ebp+var_2C], 0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jle	loc_4038F1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4038F1
		mov	eax, [ebp+var_C]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_2C], eax
		add	[ebp+var_C], 1
		jmp	short loc_4038B6
; ---------------------------------------------------------------------------

loc_403893:				; CODE XREF: sub_403801+C7j
		mov	edx, [ebp+var_2C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_2C], eax
		add	[ebp+var_C], 1

loc_4038B6:				; CODE XREF: sub_403801+90j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4038CA
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_403893

loc_4038CA:				; CODE XREF: sub_403801+BDj
		cmp	[ebp+var_2C], 0
		js	loc_403F2E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	short loc_4038E4
		add	[ebp+var_C], 1
		jmp	short loc_4038F1
; ---------------------------------------------------------------------------

loc_4038E4:				; CODE XREF: sub_403801+DBj
		mov	[ebp+var_2C], 0
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_C], eax

loc_4038F1:				; CODE XREF: sub_403801+67j
					; sub_403801+75j ...
		mov	[ebp+var_18], 0
		jmp	short loc_40393B
; ---------------------------------------------------------------------------

loc_4038FA:				; CODE XREF: sub_403801+142j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 20h	; switch 17 cases
		cmp	eax, 10h
		ja	short loc_403947 ; jumptable 00403912 default case
		mov	eax, ds:off_417670[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_403914:				; CODE XREF: sub_403801+111j
					; DATA XREF: .rdata:off_417670o
		or	[ebp+var_18], 1	; jumptable 00403912 case 39
		jmp	short loc_403937
; ---------------------------------------------------------------------------

loc_40391A:				; CODE XREF: sub_403801+111j
					; DATA XREF: .rdata:off_417670o
		or	[ebp+var_18], 2	; jumptable 00403912 case 45
		jmp	short loc_403937
; ---------------------------------------------------------------------------

loc_403920:				; CODE XREF: sub_403801+111j
					; DATA XREF: .rdata:off_417670o
		or	[ebp+var_18], 4	; jumptable 00403912 case 43
		jmp	short loc_403937
; ---------------------------------------------------------------------------

loc_403926:				; CODE XREF: sub_403801+111j
					; DATA XREF: .rdata:off_417670o
		or	[ebp+var_18], 8	; jumptable 00403912 case 32
		jmp	short loc_403937
; ---------------------------------------------------------------------------

loc_40392C:				; CODE XREF: sub_403801+111j
					; DATA XREF: .rdata:off_417670o
		or	[ebp+var_18], 10h ; jumptable 00403912 case 35
		jmp	short loc_403937
; ---------------------------------------------------------------------------

loc_403932:				; CODE XREF: sub_403801+111j
					; DATA XREF: .rdata:off_417670o
		or	[ebp+var_18], 20h ; jumptable 00403912 case 48
		nop

loc_403937:				; CODE XREF: sub_403801+117j
					; sub_403801+11Dj ...
		add	[ebp+var_C], 1

loc_40393B:				; CODE XREF: sub_403801+F7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4038FA
		jmp	short loc_403948
; ---------------------------------------------------------------------------

loc_403947:				; CODE XREF: sub_403801+108j
					; sub_403801+111j
					; DATA XREF: ...
		nop			; jumptable 00403912 default case

loc_403948:				; CODE XREF: sub_403801+144j
		mov	[ebp+var_30], 0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	loc_4039FB
		mov	[ebp+var_1C], 0FFFFFFFEh
		add	[ebp+var_C], 1
		cmp	[ebp+var_2C], 0
		jz	loc_403A81
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jle	loc_403A81
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	loc_403A81
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_30], eax
		add	[ebp+var_C], 1
		jmp	short loc_4039C6
; ---------------------------------------------------------------------------

loc_4039A3:				; CODE XREF: sub_403801+1D7j
		mov	edx, [ebp+var_30]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_30], eax
		add	[ebp+var_C], 1

loc_4039C6:				; CODE XREF: sub_403801+1A0j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4039DA
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_4039A3

loc_4039DA:				; CODE XREF: sub_403801+1CDj
		cmp	[ebp+var_30], 0
		jle	loc_403F31
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	loc_403F34
		add	[ebp+var_C], 1
		jmp	loc_403A81
; ---------------------------------------------------------------------------

loc_4039FB:				; CODE XREF: sub_403801+156j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_403A7A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_403A7A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_1C], eax
		add	[ebp+var_C], 1
		jmp	short loc_403A5B
; ---------------------------------------------------------------------------

loc_403A24:				; CODE XREF: sub_403801+26Cj
		cmp	[ebp+var_1C], 0
		jnz	short loc_403A38
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	loc_403F37

loc_403A38:				; CODE XREF: sub_403801+227j
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_1C], eax
		add	[ebp+var_C], 1

loc_403A5B:				; CODE XREF: sub_403801+221j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_403A6F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_403A24

loc_403A6F:				; CODE XREF: sub_403801+262j
		cmp	[ebp+var_1C], 0
		jns	short loc_403A81
		jmp	loc_403F44
; ---------------------------------------------------------------------------

loc_403A7A:				; CODE XREF: sub_403801+202j
					; sub_403801+20Cj
		mov	[ebp+var_1C], 0FFFFFFFFh

loc_403A81:				; CODE XREF: sub_403801+16Bj
					; sub_403801+179j ...
		mov	[ebp+var_34], 0
		mov	[ebp+var_20], 0FFFFFFFFh
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Eh
		jnz	loc_403BF4
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		setz	al
		movzx	eax, al
		mov	[ebp+var_40], eax
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	loc_403B61
		mov	[ebp+var_20], 0FFFFFFFEh
		add	[ebp+var_C], 1
		cmp	[ebp+var_2C], 0
		jz	loc_403BE7
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jle	loc_403BE7
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	loc_403BE7
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_34], eax
		add	[ebp+var_C], 1
		jmp	short loc_403B2C
; ---------------------------------------------------------------------------

loc_403B09:				; CODE XREF: sub_403801+33Dj
		mov	edx, [ebp+var_34]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_34], eax
		add	[ebp+var_C], 1

loc_403B2C:				; CODE XREF: sub_403801+306j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_403B40
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_403B09

loc_403B40:				; CODE XREF: sub_403801+333j
		cmp	[ebp+var_34], 0
		jle	loc_403F3A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	loc_403F3D
		add	[ebp+var_C], 1
		jmp	loc_403BE7
; ---------------------------------------------------------------------------

loc_403B61:				; CODE XREF: sub_403801+2BCj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_403BE0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_403BE0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_20], eax
		add	[ebp+var_C], 1
		jmp	short loc_403BC1
; ---------------------------------------------------------------------------

loc_403B8A:				; CODE XREF: sub_403801+3D2j
		cmp	[ebp+var_20], 0
		jnz	short loc_403B9E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	loc_403F40

loc_403B9E:				; CODE XREF: sub_403801+38Dj
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_20], eax
		add	[ebp+var_C], 1

loc_403BC1:				; CODE XREF: sub_403801+387j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_403BD5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_403B8A

loc_403BD5:				; CODE XREF: sub_403801+3C8j
		cmp	[ebp+var_20], 0
		jns	short loc_403BE7
		jmp	loc_403F44
; ---------------------------------------------------------------------------

loc_403BE0:				; CODE XREF: sub_403801+368j
					; sub_403801+372j
		mov	[ebp+var_20], 0

loc_403BE7:				; CODE XREF: sub_403801+2D1j
					; sub_403801+2DFj ...
		cmp	[ebp+var_40], 0
		jz	short loc_403BF4
		mov	[ebp+var_20], 0FFFFFFFFh

loc_403BF4:				; CODE XREF: sub_403801+296j
					; sub_403801+3EAj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 4Ch	; switch 47 cases
		cmp	eax, 2Eh
		ja	loc_403C94	; jumptable 00403C10 default case
		mov	eax, ds:off_4176B4[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_403C12:				; CODE XREF: sub_403801+40Fj
					; DATA XREF: .rdata:off_4176B4o
		mov	eax, [ebp+var_C] ; jumptable 00403C10 case 104
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 68h
		jnz	short loc_403C2C
		mov	[ebp+var_24], 1
		add	[ebp+var_C], 1
		jmp	short loc_403C33
; ---------------------------------------------------------------------------

loc_403C2C:				; CODE XREF: sub_403801+41Cj
		mov	[ebp+var_24], 2

loc_403C33:				; CODE XREF: sub_403801+429j
		add	[ebp+var_C], 1
		jmp	short loc_403C9C
; ---------------------------------------------------------------------------

loc_403C39:				; CODE XREF: sub_403801+40Fj
					; DATA XREF: .rdata:off_4176B4o
		mov	eax, [ebp+var_C] ; jumptable 00403C10 case 108
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 6Ch
		jnz	short loc_403C53
		mov	[ebp+var_24], 4
		add	[ebp+var_C], 1
		jmp	short loc_403C5A
; ---------------------------------------------------------------------------

loc_403C53:				; CODE XREF: sub_403801+443j
		mov	[ebp+var_24], 3

loc_403C5A:				; CODE XREF: sub_403801+450j
		add	[ebp+var_C], 1
		jmp	short loc_403C9C
; ---------------------------------------------------------------------------

loc_403C60:				; CODE XREF: sub_403801+40Fj
					; DATA XREF: .rdata:off_4176B4o
		mov	[ebp+var_24], 5	; jumptable 00403C10 case 106
		add	[ebp+var_C], 1
		jmp	short loc_403C9C
; ---------------------------------------------------------------------------

loc_403C6D:				; CODE XREF: sub_403801+40Fj
					; DATA XREF: .rdata:off_4176B4o
		mov	[ebp+var_24], 6	; jumptable 00403C10 case 122
		add	[ebp+var_C], 1
		jmp	short loc_403C9C
; ---------------------------------------------------------------------------

loc_403C7A:				; CODE XREF: sub_403801+40Fj
					; DATA XREF: .rdata:off_4176B4o
		mov	[ebp+var_24], 7	; jumptable 00403C10 case 116
		add	[ebp+var_C], 1
		jmp	short loc_403C9C
; ---------------------------------------------------------------------------

loc_403C87:				; CODE XREF: sub_403801+40Fj
					; DATA XREF: .rdata:off_4176B4o
		mov	[ebp+var_24], 8	; jumptable 00403C10 case 76
		add	[ebp+var_C], 1
		jmp	short loc_403C9C
; ---------------------------------------------------------------------------

loc_403C94:				; CODE XREF: sub_403801+402j
					; sub_403801+40Fj
					; DATA XREF: ...
		mov	[ebp+var_24], 0	; jumptable 00403C10 default case
		nop

loc_403C9C:				; CODE XREF: sub_403801+436j
					; sub_403801+45Dj ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 41h	; switch 56 cases
		cmp	eax, 37h
		ja	loc_403D9B	; jumptable 00403CB8 default case
		mov	eax, ds:off_417770[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_403CBA:				; CODE XREF: sub_403801+4B7j
					; DATA XREF: .rdata:off_417770o
		mov	[ebp+var_28], 1	; jumptable 00403CB8 cases 100,105
		jmp	loc_403DA2
; ---------------------------------------------------------------------------

loc_403CC6:				; CODE XREF: sub_403801+4B7j
					; DATA XREF: .rdata:off_417770o
		mov	[ebp+var_28], 2	; jumptable 00403CB8 case 111
		jmp	loc_403DA2
; ---------------------------------------------------------------------------

loc_403CD2:				; CODE XREF: sub_403801+4B7j
					; DATA XREF: .rdata:off_417770o
		mov	[ebp+var_28], 3	; jumptable 00403CB8 case 117
		jmp	loc_403DA2
; ---------------------------------------------------------------------------

loc_403CDE:				; CODE XREF: sub_403801+4B7j
					; DATA XREF: .rdata:off_417770o
		mov	[ebp+var_28], 4	; jumptable 00403CB8 case 120
		jmp	loc_403DA2
; ---------------------------------------------------------------------------

loc_403CEA:				; CODE XREF: sub_403801+4B7j
					; DATA XREF: .rdata:off_417770o
		mov	[ebp+var_28], 5	; jumptable 00403CB8 case 88
		jmp	loc_403DA2
; ---------------------------------------------------------------------------

loc_403CF6:				; CODE XREF: sub_403801+4B7j
					; DATA XREF: .rdata:off_417770o
		mov	[ebp+var_28], 6	; jumptable 00403CB8 case 102
		jmp	loc_403DA2
; ---------------------------------------------------------------------------

loc_403D02:				; CODE XREF: sub_403801+4B7j
					; DATA XREF: .rdata:off_417770o
		mov	[ebp+var_28], 7	; jumptable 00403CB8 case 70
		jmp	loc_403DA2
; ---------------------------------------------------------------------------

loc_403D0E:				; CODE XREF: sub_403801+4B7j
					; DATA XREF: .rdata:off_417770o
		mov	[ebp+var_28], 8	; jumptable 00403CB8 case 101
		jmp	loc_403DA2
; ---------------------------------------------------------------------------

loc_403D1A:				; CODE XREF: sub_403801+4B7j
					; DATA XREF: .rdata:off_417770o
		mov	[ebp+var_28], 9	; jumptable 00403CB8 case 69
		jmp	short loc_403DA2
; ---------------------------------------------------------------------------

loc_403D23:				; CODE XREF: sub_403801+4B7j
					; DATA XREF: .rdata:off_417770o
		mov	[ebp+var_28], 0Ah ; jumptable 00403CB8 case 103
		jmp	short loc_403DA2
; ---------------------------------------------------------------------------

loc_403D2C:				; CODE XREF: sub_403801+4B7j
					; DATA XREF: .rdata:off_417770o
		mov	[ebp+var_28], 0Bh ; jumptable 00403CB8 case 71
		jmp	short loc_403DA2
; ---------------------------------------------------------------------------

loc_403D35:				; CODE XREF: sub_403801+4B7j
					; DATA XREF: .rdata:off_417770o
		mov	[ebp+var_28], 0Ch ; jumptable 00403CB8 case 97
		jmp	short loc_403DA2
; ---------------------------------------------------------------------------

loc_403D3E:				; CODE XREF: sub_403801+4B7j
					; DATA XREF: .rdata:off_417770o
		mov	[ebp+var_28], 0Dh ; jumptable 00403CB8 case 65
		jmp	short loc_403DA2
; ---------------------------------------------------------------------------

loc_403D47:				; CODE XREF: sub_403801+4B7j
					; DATA XREF: .rdata:off_417770o
		mov	[ebp+var_28], 0Eh ; jumptable 00403CB8 case 99
		jmp	short loc_403DA2
; ---------------------------------------------------------------------------

loc_403D50:				; CODE XREF: sub_403801+4B7j
					; DATA XREF: .rdata:off_417770o
		mov	[ebp+var_28], 0Fh ; jumptable 00403CB8 case 115
		jmp	short loc_403DA2
; ---------------------------------------------------------------------------

loc_403D59:				; CODE XREF: sub_403801+4B7j
					; DATA XREF: .rdata:off_417770o
		mov	[ebp+var_28], 10h ; jumptable 00403CB8 case 112
		jmp	short loc_403DA2
; ---------------------------------------------------------------------------

loc_403D62:				; CODE XREF: sub_403801+4B7j
					; DATA XREF: .rdata:off_417770o
		mov	[ebp+var_28], 12h ; jumptable 00403CB8 case 110
		jmp	short loc_403DA2
; ---------------------------------------------------------------------------

loc_403D6B:				; CODE XREF: sub_403801+4B7j
					; DATA XREF: .rdata:off_417770o
		mov	[ebp+var_28], 0Eh ; jumptable 00403CB8 case 67
		mov	[ebp+var_24], 3
		jmp	short loc_403DA2
; ---------------------------------------------------------------------------

loc_403D7B:				; CODE XREF: sub_403801+4B7j
					; DATA XREF: .rdata:off_417770o
		mov	[ebp+var_28], 0Fh ; jumptable 00403CB8 case 83
		mov	[ebp+var_24], 3
		jmp	short loc_403DA2
; ---------------------------------------------------------------------------

loc_403D8B:				; CODE XREF: sub_403801+4B7j
					; DATA XREF: .rdata:off_417770o
		mov	[ebp+var_28], 11h ; jumptable 00403CB8 case 109
		mov	[ebp+var_2C], 0FFFFFFFFh
		jmp	short loc_403DA2
; ---------------------------------------------------------------------------

loc_403D9B:				; CODE XREF: sub_403801+4AAj
					; sub_403801+4B7j
					; DATA XREF: ...
		mov	[ebp+var_28], 0	; jumptable 00403CB8 default case

loc_403DA2:				; CODE XREF: sub_403801+4C0j
					; sub_403801+4CCj ...
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_8]
		jb	loc_403E73
		mov	eax, [ebp+arg_8]
		add	eax, 0Ah
		mov	[ebp+var_44], eax
		mov	eax, [ebp+var_44]
		cmp	eax, [ebp+arg_8]
		jbe	loc_403F43
		mov	[esp+68h+SizeOfElements], 28h ;	SizeOfElements
		mov	eax, [ebp+var_44]
		mov	[esp+68h+NumOfElements], eax ; NumOfElements
		call	calloc
		mov	[ebp+var_48], eax
		cmp	[ebp+var_48], 0
		jz	loc_403F53
		mov	[ebp+var_38], 0
		jmp	short loc_403E4A
; ---------------------------------------------------------------------------

loc_403DEC:				; CODE XREF: sub_403801+64Fj
		mov	edx, [ebp+var_38]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+var_48]
		mov	ecx, [ebp+var_38]
		mov	edx, ecx
		shl	edx, 2
		add	edx, ecx
		shl	edx, 3
		add	edx, [ebp+Memory]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	ecx, [edx+10h]
		mov	[eax+10h], ecx
		mov	ecx, [edx+14h]
		mov	[eax+14h], ecx
		mov	ecx, [edx+18h]
		mov	[eax+18h], ecx
		mov	ecx, [edx+1Ch]
		mov	[eax+1Ch], ecx
		mov	ecx, [edx+20h]
		mov	[eax+20h], ecx
		mov	edx, [edx+24h]
		mov	[eax+24h], edx
		add	[ebp+var_38], 1

loc_403E4A:				; CODE XREF: sub_403801+5E9j
		mov	eax, [ebp+var_38]
		cmp	eax, [ebp+var_14]
		jb	short loc_403DEC
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		cmp	eax, [ebp+Memory]
		jz	short loc_403E67
		mov	eax, [ebp+Memory]
		mov	[esp+68h+NumOfElements], eax ; Memory
		call	free

loc_403E67:				; CODE XREF: sub_403801+659j
		mov	eax, [ebp+var_48]
		mov	[ebp+Memory], eax
		mov	eax, [ebp+var_44]
		mov	[ebp+arg_8], eax

loc_403E73:				; CODE XREF: sub_403801+5A7j
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	[ebp+var_4C], eax
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 2
		mov	edx, eax
		mov	eax, [ebp+var_4C]
		mov	[eax], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_1C]
		mov	[eax+8], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_20]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_24]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_28]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_2C]
		mov	[eax+18h], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_30]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_34]
		mov	[eax+20h], edx
		mov	eax, [ebp+var_4C]
		mov	[esp+68h+NumOfElements], eax
		call	sub_403600
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_0], eax
		jmp	short loc_403EFF
; ---------------------------------------------------------------------------

loc_403EFB:				; CODE XREF: sub_403801+2Cj
		nop
		jmp	short loc_403EFF
; ---------------------------------------------------------------------------

loc_403EFE:				; CODE XREF: sub_403801+52j
		nop

loc_403EFF:				; CODE XREF: sub_403801+6F8j
					; sub_403801+6FBj
		add	[ebp+arg_0], 1
		jmp	short loc_403F06
; ---------------------------------------------------------------------------

loc_403F05:				; CODE XREF: sub_403801+19j
		nop

loc_403F06:				; CODE XREF: sub_403801+702j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_403825
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+Memory]
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, 0
		jmp	short locret_403F77
; ---------------------------------------------------------------------------

loc_403F2B:				; CODE XREF: sub_403801+44j
		nop
		jmp	short loc_403F44
; ---------------------------------------------------------------------------

loc_403F2E:				; CODE XREF: sub_403801+CDj
		nop
		jmp	short loc_403F44
; ---------------------------------------------------------------------------

loc_403F31:				; CODE XREF: sub_403801+1DDj
		nop
		jmp	short loc_403F44
; ---------------------------------------------------------------------------

loc_403F34:				; CODE XREF: sub_403801+1EBj
		nop
		jmp	short loc_403F44
; ---------------------------------------------------------------------------

loc_403F37:				; CODE XREF: sub_403801+231j
		nop
		jmp	short loc_403F44
; ---------------------------------------------------------------------------

loc_403F3A:				; CODE XREF: sub_403801+343j
		nop
		jmp	short loc_403F44
; ---------------------------------------------------------------------------

loc_403F3D:				; CODE XREF: sub_403801+351j
		nop
		jmp	short loc_403F44
; ---------------------------------------------------------------------------

loc_403F40:				; CODE XREF: sub_403801+397j
		nop
		jmp	short loc_403F44
; ---------------------------------------------------------------------------

loc_403F43:				; CODE XREF: sub_403801+5BCj
		nop

loc_403F44:				; CODE XREF: sub_403801+1Fj
					; sub_403801+274j ...
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		jmp	short loc_403F54
; ---------------------------------------------------------------------------

loc_403F53:				; CODE XREF: sub_403801+5DCj
		nop

loc_403F54:				; CODE XREF: sub_403801+750j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		cmp	eax, [ebp+Memory]
		jz	short loc_403F69
		mov	eax, [ebp+Memory]
		mov	[esp+68h+NumOfElements], eax ; Memory
		call	free

loc_403F69:				; CODE XREF: sub_403801+75Bj
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh

locret_403F77:				; CODE XREF: sub_403801+728j
		leave
		retn
sub_403801	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403F79	proc near		; CODE XREF: sub_40564B+502p

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	[ebp+var_C], 0
		jmp	loc_404240
; ---------------------------------------------------------------------------

loc_403F8C:				; CODE XREF: sub_403F79+2CDj
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_0]
		add	eax, 8
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 1Ch ; switch 29 cases
		ja	loc_404235	; jumptable 00403FCC default case
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	eax, offset off_417850
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_403FCE:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 1
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		jmp	loc_40423C
; ---------------------------------------------------------------------------

loc_403FE5:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 20
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40423C
; ---------------------------------------------------------------------------

loc_403FFA:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 2
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		jmp	loc_40423C
; ---------------------------------------------------------------------------

loc_404011:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 21
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40423C
; ---------------------------------------------------------------------------

loc_404026:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 3
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		jmp	loc_40423C
; ---------------------------------------------------------------------------

loc_40403D:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 4
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dx
		jmp	loc_40423C
; ---------------------------------------------------------------------------

loc_404055:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 5
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dx
		jmp	loc_40423C
; ---------------------------------------------------------------------------

loc_40406D:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 22
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40423C
; ---------------------------------------------------------------------------

loc_404082:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 6
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40423C
; ---------------------------------------------------------------------------

loc_404097:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 23
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40423C
; ---------------------------------------------------------------------------

loc_4040AC:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 7
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40423C
; ---------------------------------------------------------------------------

loc_4040C1:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 8
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40423C
; ---------------------------------------------------------------------------

loc_4040D6:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 9
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40423C
; ---------------------------------------------------------------------------

loc_4040EB:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 24
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40423C
; ---------------------------------------------------------------------------

loc_404100:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 10
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	loc_40423C
; ---------------------------------------------------------------------------

loc_40411B:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 11
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	loc_40423C
; ---------------------------------------------------------------------------

loc_404136:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 25
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40423C
; ---------------------------------------------------------------------------

loc_40414B:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 12
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		fld	qword ptr [eax]
		mov	eax, [ebp+var_10]
		fstp	qword ptr [eax]
		jmp	loc_40423C
; ---------------------------------------------------------------------------

loc_404160:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 13
		lea	edx, [eax+0Ch]
		mov	[ebp+arg_8], edx
		mov	ecx, [eax+8]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ebx, [ebp+var_10]
		mov	[ebx], eax
		mov	[ebx+4], edx
		mov	[ebx+8], ecx
		jmp	loc_40423C
; ---------------------------------------------------------------------------

loc_404181:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 14
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40423C
; ---------------------------------------------------------------------------

loc_404196:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 19
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40423C
; ---------------------------------------------------------------------------

loc_4041AB:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 15
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_40423C
; ---------------------------------------------------------------------------

loc_4041C3:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 26
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_40423C
; ---------------------------------------------------------------------------

loc_4041D5:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 16
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_40423C
; ---------------------------------------------------------------------------

loc_4041ED:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 17
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_40423C
; ---------------------------------------------------------------------------

loc_4041FF:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 27
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_40423C
; ---------------------------------------------------------------------------

loc_404211:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 18
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_40423C
; ---------------------------------------------------------------------------

loc_404223:				; CODE XREF: sub_403F79+53j
					; DATA XREF: .rdata:off_417850o
		mov	eax, [ebp+arg_8] ; jumptable 00403FCC case 28
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_40423C
; ---------------------------------------------------------------------------

loc_404235:				; CODE XREF: sub_403F79+40j
					; sub_403F79+53j
					; DATA XREF: ...
		mov	eax, 0FFFFFFFFh	; jumptable 00403FCC default case
		jmp	short loc_404251
; ---------------------------------------------------------------------------

loc_40423C:				; CODE XREF: sub_403F79+67j
					; sub_403F79+7Cj ...
		add	[ebp+var_C], 1

loc_404240:				; CODE XREF: sub_403F79+Ej
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_4]
		jb	loc_403F8C
		mov	eax, 0

loc_404251:				; CODE XREF: sub_403F79+2C1j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_403F79	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404257	proc near		; CODE XREF: sub_4042D5+4C6p
					; sub_4042D5+5BAp ...

Dst		= dword	ptr -48h
Val		= dword	ptr -44h
Size		= dword	ptr -40h
var_30		= byte ptr -30h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		jmp	short loc_4042C8
; ---------------------------------------------------------------------------

loc_40425F:				; CODE XREF: sub_404257+75j
		mov	eax, [ebp+arg_C]
		mov	edx, 20h
		cmp	eax, 20h
		cmova	eax, edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Size],	eax ; Size
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Val], eax ; Val
		lea	eax, [ebp+var_30]
		mov	[esp+48h+Dst], eax ; Dst
		call	memset
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Size],	eax
		lea	eax, [ebp+var_30]
		mov	[esp+48h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Dst], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4042B0
		mov	eax, [ebp+var_10]
		jmp	short locret_4042D3
; ---------------------------------------------------------------------------

loc_4042B0:				; CODE XREF: sub_404257+52j
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		sub	eax, [ebp+var_C]
		mov	[ebp+arg_C], eax

loc_4042C8:				; CODE XREF: sub_404257+6j
		cmp	[ebp+arg_C], 0
		jg	short loc_40425F
		mov	eax, 0

locret_4042D3:				; CODE XREF: sub_404257+57j
		leave
		retn
sub_404257	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4042D5	proc near		; CODE XREF: sub_40516B+317p

var_D8		= dword	ptr -0D8h
var_D4		= dword	ptr -0D4h
var_D0		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A5		= byte ptr -0A5h
var_A4		= byte ptr -0A4h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0D4h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_B8], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_B4], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_B0], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_AC], eax
		mov	[ebp+var_A5], 0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 1
		jnz	loc_4043FC
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		sub	eax, 4		; switch 15 cases
		cmp	eax, 0Eh
		ja	loc_4043BC	; jumptable 00404332 default case
		mov	eax, ds:off_4178F0[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_404334:				; CODE XREF: sub_4042D5+5Dj
					; DATA XREF: .rdata:off_4178F0o
		movzx	eax, word ptr [ebp+var_B8] ; jumptable 00404332	case 4
		cwde
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_4043C6
; ---------------------------------------------------------------------------

loc_404349:				; CODE XREF: sub_4042D5+5Dj
					; DATA XREF: .rdata:off_4178F0o
		mov	eax, [ebp+var_B8] ; jumptable 00404332 case 6
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_4043C6
; ---------------------------------------------------------------------------

loc_40435C:				; CODE XREF: sub_4042D5+5Dj
					; DATA XREF: .rdata:off_4178F0o
		mov	eax, [ebp+var_B8] ; jumptable 00404332 case 8
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_4043C6
; ---------------------------------------------------------------------------

loc_40436F:				; CODE XREF: sub_4042D5+5Dj
					; DATA XREF: .rdata:off_4178F0o
		mov	eax, [ebp+var_B8] ; jumptable 00404332 case 10
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_4043C6
; ---------------------------------------------------------------------------

loc_404383:				; CODE XREF: sub_4042D5+5Dj
					; DATA XREF: .rdata:off_4178F0o
		mov	eax, [ebp+var_B8] ; jumptable 00404332 case 17
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], 0
		jmp	short loc_4043C6
; ---------------------------------------------------------------------------

loc_404395:				; CODE XREF: sub_4042D5+5Dj
					; DATA XREF: .rdata:off_4178F0o
		mov	eax, [ebp+var_B8] ; jumptable 00404332 case 15
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_4043C6
; ---------------------------------------------------------------------------

loc_4043A9:				; CODE XREF: sub_4042D5+5Dj
					; DATA XREF: .rdata:off_4178F0o
		mov	eax, [ebp+var_B8] ; jumptable 00404332 case 18
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_4043C6
; ---------------------------------------------------------------------------

loc_4043BC:				; CODE XREF: sub_4042D5+50j
					; sub_4042D5+5Dj
					; DATA XREF: ...
		mov	eax, 0FFFFFFFFh	; jumptable 00404332 default case
		jmp	loc_40495F
; ---------------------------------------------------------------------------

loc_4043C6:				; CODE XREF: sub_4042D5+72j
					; sub_4042D5+85j ...
		cmp	[ebp+var_24], 0
		jns	short loc_4043EB
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_24]
		neg	eax
		adc	edx, 0
		neg	edx
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	[ebp+var_A5], 2Dh
		jmp	loc_4044A8
; ---------------------------------------------------------------------------

loc_4043EB:				; CODE XREF: sub_4042D5+F5j
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	loc_4044A8
; ---------------------------------------------------------------------------

loc_4043FC:				; CODE XREF: sub_4042D5+3Ej
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		sub	eax, 5		; switch 14 cases
		cmp	eax, 0Dh
		ja	loc_40449E	; jumptable 00404415 default case
		mov	eax, ds:off_41792C[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_404417:				; CODE XREF: sub_4042D5+140j
					; DATA XREF: .rdata:off_41792Co
		movzx	eax, word ptr [ebp+var_B8] ; jumptable 00404415	case 5
		movzx	eax, ax
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_4044A8
; ---------------------------------------------------------------------------

loc_40442D:				; CODE XREF: sub_4042D5+140j
					; DATA XREF: .rdata:off_41792Co
		mov	eax, [ebp+var_B8] ; jumptable 00404415 case 7
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_4044A8
; ---------------------------------------------------------------------------

loc_40443F:				; CODE XREF: sub_4042D5+140j
					; DATA XREF: .rdata:off_41792Co
		mov	eax, [ebp+var_B8] ; jumptable 00404415 case 9
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_4044A8
; ---------------------------------------------------------------------------

loc_404451:				; CODE XREF: sub_4042D5+140j
					; DATA XREF: .rdata:off_41792Co
		mov	eax, [ebp+var_B8] ; jumptable 00404415 case 11
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_4044A8
; ---------------------------------------------------------------------------

loc_404465:				; CODE XREF: sub_4042D5+140j
					; DATA XREF: .rdata:off_41792Co
		mov	eax, [ebp+var_B8] ; jumptable 00404415 case 17
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_4044A8
; ---------------------------------------------------------------------------

loc_404477:				; CODE XREF: sub_4042D5+140j
					; DATA XREF: .rdata:off_41792Co
		mov	eax, [ebp+var_B8] ; jumptable 00404415 case 16
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_4044A8
; ---------------------------------------------------------------------------

loc_40448B:				; CODE XREF: sub_4042D5+140j
					; DATA XREF: .rdata:off_41792Co
		mov	eax, [ebp+var_B8] ; jumptable 00404415 case 18
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_4044A8
; ---------------------------------------------------------------------------

loc_40449E:				; CODE XREF: sub_4042D5+133j
					; sub_4042D5+140j
					; DATA XREF: ...
		mov	eax, 0FFFFFFFFh	; jumptable 00404415 default case
		jmp	loc_40495F
; ---------------------------------------------------------------------------

loc_4044A8:				; CODE XREF: sub_4042D5+111j
					; sub_4042D5+122j ...
		movzx	eax, [ebp+var_A5]
		cmp	al, 2Dh
		jz	short loc_4044DD
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 4
		test	eax, eax
		jz	short loc_4044C9
		mov	[ebp+var_A5], 2Bh
		jmp	short loc_4044DD
; ---------------------------------------------------------------------------

loc_4044C9:				; CODE XREF: sub_4042D5+1E9j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 8
		test	eax, eax
		jz	short loc_4044DD
		mov	[ebp+var_A5], 20h

loc_4044DD:				; CODE XREF: sub_4042D5+1DCj
					; sub_4042D5+1F2j ...
		movzx	eax, [ebp+var_A5]
		test	al, al
		setnz	al
		movzx	eax, al
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+var_A4]
		add	eax, 64h
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	short loc_40451B
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_4046A7

loc_40451B:				; CODE XREF: sub_4042D5+236j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 1
		jz	short loc_404535
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jnz	loc_4045E7

loc_404535:				; CODE XREF: sub_4042D5+24Fj
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	[ebp+var_38], offset byte_4178C4

loc_404543:				; CODE XREF: sub_4042D5+307j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 1
		test	al, al
		jz	short loc_40457A
		add	[ebp+var_2C], 1
		cmp	[ebp+var_2C], 3
		jnz	short loc_40457A
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40457A
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_38]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	[ebp+var_2C], 0

loc_40457A:				; CODE XREF: sub_4042D5+279j
					; sub_4042D5+283j ...
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[esp+0D8h+var_D0], 0Ah
		mov	[esp+0D8h+var_CC], 0
		mov	[esp+0D8h+var_D8], eax
		mov	[esp+0D8h+var_D4], edx
		call	sub_414D80
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[esp+0D8h+var_D0], 0Ah
		mov	[esp+0D8h+var_CC], 0
		mov	[esp+0D8h+var_D8], eax
		mov	[esp+0D8h+var_D4], edx
		call	sub_414EC0
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	loc_404543
		jmp	loc_4046A7
; ---------------------------------------------------------------------------

loc_4045E7:				; CODE XREF: sub_4042D5+25Aj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 2
		jnz	short loc_404648

loc_4045F2:				; CODE XREF: sub_4042D5+34Ej
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_10]
		and	eax, 7
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		shrd	eax, edx, 3
		shr	edx, 3
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	short loc_4045F2
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_4046A7
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	short loc_4046A7
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	30h
		jmp	short loc_4046A7
; ---------------------------------------------------------------------------

loc_404648:				; CODE XREF: sub_4042D5+31Bj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 4
		jnz	short loc_40465A
		mov	eax, offset a0123456789abcd ; "0123456789abcdef"
		jmp	short loc_40465F
; ---------------------------------------------------------------------------

loc_40465A:				; CODE XREF: sub_4042D5+37Cj
		mov	eax, offset a0123456789ab_0 ; "0123456789ABCDEF"

loc_40465F:				; CODE XREF: sub_4042D5+383j
		mov	[ebp+var_34], eax

loc_404662:				; CODE XREF: sub_4042D5+3BFj
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_10]
		and	eax, 0Fh
		add	eax, [ebp+var_34]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		shrd	eax, edx, 4
		shr	edx, 4
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	short loc_404662
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_4046A7
		add	[ebp+var_1C], 2

loc_4046A7:				; CODE XREF: sub_4042D5+240j
					; sub_4042D5+30Dj ...
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 20h
		test	eax, eax
		jz	short loc_404700
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_404700
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_404700
		cmp	[ebp+var_3C], 0
		jz	short loc_404700
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_404700
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		sub	eax, [ebp+var_3C]
		mov	[ebp+var_18], eax
		jmp	short loc_40472A
; ---------------------------------------------------------------------------

loc_404700:				; CODE XREF: sub_4042D5+3ECj
					; sub_4042D5+3F7j ...
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jle	short loc_404723
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_404723
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		sub	eax, [ebp+var_3C]
		mov	[ebp+var_18], eax
		jmp	short loc_40472A
; ---------------------------------------------------------------------------

loc_404723:				; CODE XREF: sub_4042D5+433j
					; sub_4042D5+43Ej
		mov	[ebp+var_18], 0

loc_40472A:				; CODE XREF: sub_4042D5+429j
					; sub_4042D5+44Cj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_4047B1
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_4047B1
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_4047B1
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		mov	edx, eax
		sub	edx, [ebp+var_3C]
		mov	eax, [ebp+var_18]
		cmp	edx, eax
		jb	short loc_4047B1
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		mov	edx, eax
		sub	edx, [ebp+var_3C]
		mov	eax, [ebp+var_18]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	edx, [ebp+arg_1C]
		mov	[esp+0D8h+var_C8], edx
		mov	[esp+0D8h+var_CC], eax
		mov	[esp+0D8h+var_D0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+var_D8], eax
		call	sub_404257
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_4047B1
		mov	eax, [ebp+var_40]
		jmp	loc_40495F
; ---------------------------------------------------------------------------

loc_4047B1:				; CODE XREF: sub_4042D5+460j
					; sub_4042D5+46Aj ...
		movzx	eax, [ebp+var_A5]
		test	al, al
		jz	short loc_4047F7
		mov	[esp+0D8h+var_D0], 1
		lea	eax, [ebp+var_A5]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_4047EA
		mov	eax, [ebp+var_40]
		jmp	loc_40495F
; ---------------------------------------------------------------------------

loc_4047EA:				; CODE XREF: sub_4042D5+50Bj
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_4047F7:				; CODE XREF: sub_4042D5+4E5j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_404866
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 4
		jz	short loc_40481A
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 5
		jnz	short loc_404866

loc_40481A:				; CODE XREF: sub_4042D5+538j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 4
		jnz	short loc_40482C
		mov	eax, offset a0x	; "0x"
		jmp	short loc_404831
; ---------------------------------------------------------------------------

loc_40482C:				; CODE XREF: sub_4042D5+54Ej
		mov	eax, offset a0x_0 ; "0X"

loc_404831:				; CODE XREF: sub_4042D5+555j
		mov	[esp+0D8h+var_D0], 2
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_404859
		mov	eax, [ebp+var_40]
		jmp	loc_40495F
; ---------------------------------------------------------------------------

loc_404859:				; CODE XREF: sub_4042D5+57Aj
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_404866:				; CODE XREF: sub_4042D5+52Dj
					; sub_4042D5+543j
		cmp	[ebp+var_18], 0
		jz	short loc_4048A5
		mov	eax, [ebp+arg_1C]
		mov	[esp+0D8h+var_C8], eax
		mov	eax, [ebp+var_18]
		mov	[esp+0D8h+var_CC], eax
		mov	[esp+0D8h+var_D0], 30h
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+var_D8], eax
		call	sub_404257
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_4048A5
		mov	eax, [ebp+var_40]
		jmp	loc_40495F
; ---------------------------------------------------------------------------

loc_4048A5:				; CODE XREF: sub_4042D5+595j
					; sub_4042D5+5C6j
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[esp+0D8h+var_D0], eax
		mov	eax, [ebp+var_14]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_4048D8
		mov	eax, [ebp+var_40]
		jmp	loc_40495F
; ---------------------------------------------------------------------------

loc_4048D8:				; CODE XREF: sub_4042D5+5F9j
		mov	eax, [ebp+arg_1C]
		mov	edx, [eax]
		mov	ecx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jz	short loc_40495A
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_40495A
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		sub	eax, [ebp+var_18]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_40495A
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		sub	eax, [ebp+var_18]
		sub	eax, [ebp+var_3C]
		mov	edx, [ebp+arg_1C]
		mov	[esp+0D8h+var_C8], edx
		mov	[esp+0D8h+var_CC], eax
		mov	[esp+0D8h+var_D0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+var_D8], eax
		call	sub_404257
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_40495A
		mov	eax, [ebp+var_40]
		jmp	short loc_40495F
; ---------------------------------------------------------------------------

loc_40495A:				; CODE XREF: sub_4042D5+626j
					; sub_4042D5+630j ...
		mov	eax, 0

loc_40495F:				; CODE XREF: sub_4042D5+ECj
					; sub_4042D5+1CEj ...
		add	esp, 0D4h
		pop	ebx
		pop	ebp
		retn
sub_4042D5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404968	proc near		; CODE XREF: sub_40516B+35Bp

Dest		= dword	ptr -1F8h
Format		= dword	ptr -1F4h
var_1F0		= qword	ptr -1F0h
var_1E8		= dword	ptr -1E8h
var_1D0		= dword	ptr -1D0h
var_1CC		= dword	ptr -1CCh
var_1C8		= qword	ptr -1C8h
var_1C0		= dword	ptr -1C0h
var_1BC		= dword	ptr -1BCh
var_1AF		= byte ptr -1AFh
var_1AE		= byte ptr -1AEh
var_19A		= byte ptr -19Ah
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= qword	ptr -28h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 1F0h
		mov	eax, [ebp+arg_C]
		mov	dword ptr [ebp+var_1C8], eax
		mov	eax, [ebp+arg_10]
		mov	dword ptr [ebp+var_1C8+4], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_1C0], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_1BC], eax
		mov	eax, 0
		mov	edx, 0
		mov	ecx, 0
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	[ebp+var_10], ecx
		mov	[ebp+var_1C], 0
		mov	[ebp+var_1AF], 0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 0Ch
		jz	short loc_4049CF
		cmp	eax, 0Dh
		jz	short loc_4049DA
		jmp	short loc_404A03
; ---------------------------------------------------------------------------

loc_4049CF:				; CODE XREF: sub_404968+5Ej
		fld	[ebp+var_1C8]
		fstp	[ebp+var_28]
		jmp	short loc_404A0D
; ---------------------------------------------------------------------------

loc_4049DA:				; CODE XREF: sub_404968+63j
		fldz
		fstp	[ebp+var_28]
		mov	eax, dword ptr [ebp+var_1C8]
		mov	edx, dword ptr [ebp+var_1C8+4]
		mov	ecx, [ebp+var_1C0]
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	[ebp+var_10], ecx
		mov	[ebp+var_1C], 1
		jmp	short loc_404A0D
; ---------------------------------------------------------------------------

loc_404A03:				; CODE XREF: sub_404968+65j
		mov	eax, 0FFFFFFFFh
		jmp	loc_404D93
; ---------------------------------------------------------------------------

loc_404A0D:				; CODE XREF: sub_404968+70j
					; sub_404968+99j
		lea	eax, [ebp+var_1AE]
		add	eax, 14h
		mov	[ebp+var_2C], eax
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		sub	eax, 6		; switch 8 cases
		cmp	eax, 7
		ja	short loc_404A9A ; jumptable 00404A38 default case
		mov	eax, ds:off_417964[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_404A3A:				; CODE XREF: sub_404968+D0j
					; DATA XREF: .rdata:off_417964o
		sub	[ebp+var_2C], 1	; jumptable 00404A38 case 6
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	66h
		jmp	short loc_404AA4
; ---------------------------------------------------------------------------

loc_404A46:				; CODE XREF: sub_404968+D0j
					; DATA XREF: .rdata:off_417964o
		sub	[ebp+var_2C], 1	; jumptable 00404A38 case 7
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	46h
		jmp	short loc_404AA4
; ---------------------------------------------------------------------------

loc_404A52:				; CODE XREF: sub_404968+D0j
					; DATA XREF: .rdata:off_417964o
		sub	[ebp+var_2C], 1	; jumptable 00404A38 case 8
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	65h
		jmp	short loc_404AA4
; ---------------------------------------------------------------------------

loc_404A5E:				; CODE XREF: sub_404968+D0j
					; DATA XREF: .rdata:off_417964o
		sub	[ebp+var_2C], 1	; jumptable 00404A38 case 9
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	45h
		jmp	short loc_404AA4
; ---------------------------------------------------------------------------

loc_404A6A:				; CODE XREF: sub_404968+D0j
					; DATA XREF: .rdata:off_417964o
		sub	[ebp+var_2C], 1	; jumptable 00404A38 case 10
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	67h
		jmp	short loc_404AA4
; ---------------------------------------------------------------------------

loc_404A76:				; CODE XREF: sub_404968+D0j
					; DATA XREF: .rdata:off_417964o
		sub	[ebp+var_2C], 1	; jumptable 00404A38 case 11
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	47h
		jmp	short loc_404AA4
; ---------------------------------------------------------------------------

loc_404A82:				; CODE XREF: sub_404968+D0j
					; DATA XREF: .rdata:off_417964o
		sub	[ebp+var_2C], 1	; jumptable 00404A38 case 12
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	61h
		jmp	short loc_404AA4
; ---------------------------------------------------------------------------

loc_404A8E:				; CODE XREF: sub_404968+D0j
					; DATA XREF: .rdata:off_417964o
		sub	[ebp+var_2C], 1	; jumptable 00404A38 case 13
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	41h
		jmp	short loc_404AA4
; ---------------------------------------------------------------------------

loc_404A9A:				; CODE XREF: sub_404968+C7j
		mov	eax, 0FFFFFFFFh	; jumptable 00404A38 default case
		jmp	loc_404D93
; ---------------------------------------------------------------------------

loc_404AA4:				; CODE XREF: sub_404968+DCj
					; sub_404968+E8j ...
		cmp	[ebp+var_1C], 0
		jz	short loc_404AB4
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	4Ch

loc_404AB4:				; CODE XREF: sub_404968+140j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_404B2D
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		mov	edx, 64h
		cmp	eax, 64h
		cmovg	eax, edx
		mov	[ebp+var_30], eax

loc_404AD3:				; CODE XREF: sub_404968+1B9j
		sub	[ebp+var_2C], 1
		mov	ecx, [ebp+var_30]
		mov	edx, 0CCCCCCCDh
		mov	eax, ecx
		mul	edx
		shr	edx, 3
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_2C]
		mov	[eax], dl
		mov	ecx, [ebp+var_30]
		mov	[ebp+var_1CC], ecx
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_1CC]
		mul	edx
		mov	eax, edx
		shr	eax, 3
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	short loc_404AD3
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	2Eh

loc_404B2D:				; CODE XREF: sub_404968+155j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_404B44
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	23h

loc_404B44:				; CODE XREF: sub_404968+1D0j
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	25h
		cmp	[ebp+var_1C], 0
		jz	short loc_404B80
		mov	ebx, [ebp+var_2C]
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	ecx, [ebp+var_10]
		mov	dword ptr [esp+1F8h+var_1F0], eax
		mov	dword ptr [esp+1F8h+var_1F0+4],	edx
		mov	[esp+1F8h+var_1E8], ecx
		mov	[esp+1F8h+Format], ebx ; Format
		lea	eax, [ebp+var_19A]
		mov	[esp+1F8h+Dest], eax ; Dest
		call	sprintf
		jmp	short loc_404B9C
; ---------------------------------------------------------------------------

loc_404B80:				; CODE XREF: sub_404968+1EAj
		mov	eax, [ebp+var_2C]
		fld	[ebp+var_28]
		fstp	[esp+1F8h+var_1F0]
		mov	[esp+1F8h+Format], eax ; Format
		lea	eax, [ebp+var_19A]
		mov	[esp+1F8h+Dest], eax ; Dest
		call	sprintf

loc_404B9C:				; CODE XREF: sub_404968+216j
		lea	eax, [ebp+var_19A]
		mov	[ebp+var_2C], eax
		lea	eax, [ebp+var_19A]
		mov	[ebp+var_1D0], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1D0]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		add	eax, edx
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_2C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_404BF6
		mov	[ebp+var_1AF], 2Dh
		add	[ebp+var_2C], 1
		sub	[ebp+var_30], 1
		jmp	short loc_404C20
; ---------------------------------------------------------------------------

loc_404BF6:				; CODE XREF: sub_404968+27Bj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 4
		test	eax, eax
		jz	short loc_404C0C
		mov	[ebp+var_1AF], 2Bh
		jmp	short loc_404C20
; ---------------------------------------------------------------------------

loc_404C0C:				; CODE XREF: sub_404968+299j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 8
		test	eax, eax
		jz	short loc_404C20
		mov	[ebp+var_1AF], 20h

loc_404C20:				; CODE XREF: sub_404968+28Cj
					; sub_404968+2A2j ...
		movzx	eax, [ebp+var_1AF]
		test	al, al
		setnz	al
		movzx	eax, al
		mov	[ebp+var_38], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_404C99
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_404C99
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		cmp	eax, [ebp+var_30]
		jbe	short loc_404C99
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		sub	eax, [ebp+var_30]
		mov	edx, [ebp+arg_1C]
		mov	[esp+1F8h+var_1E8], edx
		mov	dword ptr [esp+1F8h+var_1F0+4],	eax
		mov	dword ptr [esp+1F8h+var_1F0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+1F8h+Dest], eax
		call	sub_404257
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_404C99
		mov	eax, [ebp+var_3C]
		jmp	loc_404D93
; ---------------------------------------------------------------------------

loc_404C99:				; CODE XREF: sub_404968+2D5j
					; sub_404968+2DFj ...
		movzx	eax, [ebp+var_1AF]
		test	al, al
		jz	short loc_404CDF
		mov	dword ptr [esp+1F8h+var_1F0], 1
		lea	eax, [ebp+var_1AF]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Dest], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_404CD2
		mov	eax, [ebp+var_3C]
		jmp	loc_404D93
; ---------------------------------------------------------------------------

loc_404CD2:				; CODE XREF: sub_404968+360j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_404CDF:				; CODE XREF: sub_404968+33Aj
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_2C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	dword ptr [esp+1F8h+var_1F0], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Dest], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_404D12
		mov	eax, [ebp+var_3C]
		jmp	loc_404D93
; ---------------------------------------------------------------------------

loc_404D12:				; CODE XREF: sub_404968+3A0j
		mov	eax, [ebp+arg_1C]
		mov	edx, [eax]
		mov	ecx, [ebp+var_34]
		mov	eax, [ebp+var_2C]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jz	short loc_404D8E
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_404D8E
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		cmp	eax, [ebp+var_30]
		jbe	short loc_404D8E
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		sub	eax, [ebp+var_30]
		mov	edx, [ebp+arg_1C]
		mov	[esp+1F8h+var_1E8], edx
		mov	dword ptr [esp+1F8h+var_1F0+4],	eax
		mov	dword ptr [esp+1F8h+var_1F0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+1F8h+Dest], eax
		call	sub_404257
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_404D8E
		mov	eax, [ebp+var_3C]
		jmp	short loc_404D93
; ---------------------------------------------------------------------------

loc_404D8E:				; CODE XREF: sub_404968+3CDj
					; sub_404968+3D7j ...
		mov	eax, 0

loc_404D93:				; CODE XREF: sub_404968+A0j
					; sub_404968+137j ...
		add	esp, 1F0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_404968	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404D9D	proc near		; CODE XREF: sub_40516B+39Fp

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 6
		jz	short loc_404DCD
		mov	eax, 0FFFFFFFFh
		jmp	short locret_404E0D
; ---------------------------------------------------------------------------

loc_404DCD:				; CODE XREF: sub_404D9D+27j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_D], al
		mov	[esp+38h+var_30], 1
		lea	eax, [ebp+var_D]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_404DFB
		mov	eax, [ebp+var_C]
		jmp	short locret_404E0D
; ---------------------------------------------------------------------------

loc_404DFB:				; CODE XREF: sub_404D9D+57j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, 0

locret_404E0D:				; CODE XREF: sub_404D9D+2Ej
					; sub_404D9D+5Cj
		leave
		retn
sub_404D9D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404E0F	proc near		; CODE XREF: sub_40516B+3E3p

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 0Eh
		jz	short loc_404E43
		mov	eax, 0FFFFFFFFh
		jmp	loc_404FAA
; ---------------------------------------------------------------------------

loc_404E43:				; CODE XREF: sub_404E0F+28j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_404E56
		mov	[ebp+var_10], offset aNull ; "(null)"

loc_404E56:				; CODE XREF: sub_404E0F+3Ej
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		js	short loc_404E8E
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		jmp	short loc_404E77
; ---------------------------------------------------------------------------

loc_404E6F:				; CODE XREF: sub_404E0F+7Bj
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1

loc_404E77:				; CODE XREF: sub_404E0F+5Ej
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_C]
		jbe	short loc_404EB0
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_404E6F
		jmp	short loc_404EB0
; ---------------------------------------------------------------------------

loc_404E8E:				; CODE XREF: sub_404E0F+4Fj
		mov	eax, [ebp+var_10]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax

loc_404EB0:				; CODE XREF: sub_404E0F+71j
					; sub_404E0F+7Dj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_404F11
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_404F11
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		jbe	short loc_404F11
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_C]
		mov	edx, [ebp+arg_1C]
		mov	[esp+58h+var_48], edx
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_404257
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_404F11
		mov	eax, [ebp+var_18]
		jmp	loc_404FAA
; ---------------------------------------------------------------------------

loc_404F11:				; CODE XREF: sub_404E0F+ACj
					; sub_404E0F+B6j ...
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_404F38
		mov	eax, [ebp+var_18]
		jmp	short loc_404FAA
; ---------------------------------------------------------------------------

loc_404F38:				; CODE XREF: sub_404E0F+122j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jz	short loc_404FA5
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_404FA5
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		jbe	short loc_404FA5
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_C]
		mov	edx, [ebp+arg_1C]
		mov	[esp+58h+var_48], edx
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_404257
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_404FA5
		mov	eax, [ebp+var_18]
		jmp	short loc_404FAA
; ---------------------------------------------------------------------------

loc_404FA5:				; CODE XREF: sub_404E0F+143j
					; sub_404E0F+14Dj ...
		mov	eax, 0

loc_404FAA:				; CODE XREF: sub_404E0F+2Fj
					; sub_404E0F+FDj ...
		add	esp, 54h
		pop	edi
		pop	ebp
		retn
sub_404E0F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404FB0	proc near		; CODE XREF: sub_40516B+427p

var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_7C		= byte ptr -7Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0A4h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_98], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_94], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_90], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_8C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 13h
		jz	short loc_404FF3
		mov	eax, 0FFFFFFFFh
		jmp	loc_4050AE
; ---------------------------------------------------------------------------

loc_404FF3:				; CODE XREF: sub_404FB0+37j
		mov	eax, [ebp+var_98]
		mov	[ebp+var_C], eax
		lea	eax, [ebp+var_7C]
		add	eax, 64h
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_10], eax

loc_40500B:				; CODE XREF: sub_404FB0+7Ej
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		and	eax, 0Fh
		movzx	edx, ds:byte_41798B[eax]
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		mov	eax, [ebp+var_C]
		shr	eax, 4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40500B
		jmp	short loc_40503C
; ---------------------------------------------------------------------------

loc_405032:				; CODE XREF: sub_404FB0+9Bj
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	30h

loc_40503C:				; CODE XREF: sub_404FB0+80j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, 7
		jbe	short loc_405032
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	78h
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	30h
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	[esp+0A8h+var_A0], eax
		mov	eax, [ebp+var_10]
		mov	[esp+0A8h+var_A4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+var_A8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_405091
		mov	eax, [ebp+var_18]
		jmp	short loc_4050AE
; ---------------------------------------------------------------------------

loc_405091:				; CODE XREF: sub_404FB0+DAj
		mov	eax, [ebp+arg_1C]
		mov	edx, [eax]
		mov	ecx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, 0

loc_4050AE:				; CODE XREF: sub_404FB0+3Ej
					; sub_404FB0+DFj
		add	esp, 0A4h
		pop	ebx
		pop	ebp
		retn
sub_404FB0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4050B7	proc near		; CODE XREF: sub_40516B+468p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		sub	eax, 15h	; switch 8 cases
		cmp	eax, 7
		ja	short loc_40515D ; jumptable 004050EA default case
		mov	eax, ds:off_4179A0[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4050EC:				; CODE XREF: sub_4050B7+33j
					; DATA XREF: .rdata:off_4179A0o
		mov	eax, [ebp+var_10] ; jumptable 004050EA case 21
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], dl
		jmp	short loc_405164
; ---------------------------------------------------------------------------

loc_4050F8:				; CODE XREF: sub_4050B7+33j
					; DATA XREF: .rdata:off_4179A0o
		mov	eax, [ebp+var_10] ; jumptable 004050EA case 22
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], dx
		jmp	short loc_405164
; ---------------------------------------------------------------------------

loc_405105:				; CODE XREF: sub_4050B7+33j
					; DATA XREF: .rdata:off_4179A0o
		mov	eax, [ebp+var_10] ; jumptable 004050EA case 24
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_405164
; ---------------------------------------------------------------------------

loc_405111:				; CODE XREF: sub_4050B7+33j
					; DATA XREF: .rdata:off_4179A0o
		mov	ecx, [ebp+var_10] ; jumptable 004050EA case 25
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, 0
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_405164
; ---------------------------------------------------------------------------

loc_405125:				; CODE XREF: sub_4050B7+33j
					; DATA XREF: .rdata:off_4179A0o
		mov	ecx, [ebp+var_10] ; jumptable 004050EA case 26
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, 0
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_405164
; ---------------------------------------------------------------------------

loc_405139:				; CODE XREF: sub_4050B7+33j
					; DATA XREF: .rdata:off_4179A0o
		mov	eax, [ebp+var_10] ; jumptable 004050EA case 27
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_405164
; ---------------------------------------------------------------------------

loc_405145:				; CODE XREF: sub_4050B7+33j
					; DATA XREF: .rdata:off_4179A0o
		mov	eax, [ebp+var_10] ; jumptable 004050EA case 28
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_405164
; ---------------------------------------------------------------------------

loc_405151:				; CODE XREF: sub_4050B7+33j
					; DATA XREF: .rdata:off_4179A0o
		mov	eax, [ebp+var_10] ; jumptable 004050EA case 23
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_405164
; ---------------------------------------------------------------------------

loc_40515D:				; CODE XREF: sub_4050B7+2Aj
		mov	eax, 0FFFFFFFFh	; jumptable 004050EA default case
		jmp	short locret_405169
; ---------------------------------------------------------------------------

loc_405164:				; CODE XREF: sub_4050B7+3Fj
					; sub_4050B7+4Cj ...
		mov	eax, 0

locret_405169:				; CODE XREF: sub_4050B7+ABj
		leave
		retn
sub_4050B7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40516B	proc near		; CODE XREF: sub_40564B+550p

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		jmp	loc_4055EB
; ---------------------------------------------------------------------------

loc_405190:				; CODE XREF: sub_40516B+488j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_4051A3
		add	[ebp+var_10], 1
		jmp	loc_4055EB
; ---------------------------------------------------------------------------

loc_4051A3:				; CODE XREF: sub_40516B+2Dj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jz	short loc_4051F3
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4051E4
		mov	eax, [ebp+var_C]
		jmp	locret_405649
; ---------------------------------------------------------------------------

loc_4051E4:				; CODE XREF: sub_40516B+6Fj
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_4051F3:				; CODE XREF: sub_40516B+3Ej
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_405247
		mov	[esp+58h+var_50], 1
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40522B
		mov	eax, [ebp+var_C]
		jmp	locret_405649
; ---------------------------------------------------------------------------

loc_40522B:				; CODE XREF: sub_40516B+B6j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		add	[ebp+var_10], 2
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_8], eax
		jmp	loc_4055EB
; ---------------------------------------------------------------------------

loc_405247:				; CODE XREF: sub_40516B+93j
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_8], eax
		mov	eax, [ebp+var_18]
		cmp	eax, [ebp+arg_10]
		jb	short loc_405279
		mov	[esp+58h+var_50], 52Dh ; int
		mov	[esp+58h+var_54], offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aArgidxArgspecs ; "argidx < argspecs_len"
		call	sub_415230

loc_405279:				; CODE XREF: sub_40516B+F0j
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	loc_40530D
		mov	eax, [ebp+var_14]
		mov	eax, [eax+1Ch]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	eax, 6
		jz	short loc_4052C4
		mov	[esp+58h+var_50], 533h ; int
		mov	[esp+58h+var_54], offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aValuetableArgW ; "valuetable[arg->width_pos-1].vt == VALT"...
		call	sub_415230

loc_4052C4:				; CODE XREF: sub_40516B+13Bj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+1Ch]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_14]
		mov	[eax+8], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		test	eax, eax
		jns	short loc_40530D
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	edx, eax
		neg	edx
		mov	eax, [ebp+var_14]
		mov	[eax+8], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	edx, eax
		or	edx, 2
		mov	eax, [ebp+var_14]
		mov	[eax+4], edx

loc_40530D:				; CODE XREF: sub_40516B+11Bj
					; sub_40516B+17Fj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_405382
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	eax, 6
		jz	short loc_405350
		mov	[esp+58h+var_50], 53Dh ; int
		mov	[esp+58h+var_54], offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aValuetableArgP ; "valuetable[arg->precision_pos-1].vt	== "...
		call	sub_415230

loc_405350:				; CODE XREF: sub_40516B+1C7j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_14]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jns	short loc_405382
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+0Ch], 0FFFFFFFFh

loc_405382:				; CODE XREF: sub_40516B+1ABj
					; sub_40516B+20Bj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_4053A8
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		cmp	eax, 11h
		jnz	short loc_4053A8
		mov	eax, [ebp+arg_18]
		mov	[esp+58h+var_58], eax ;	int
		call	strerror
		mov	[ebp+var_30], eax
		jmp	short loc_405412
; ---------------------------------------------------------------------------

loc_4053A8:				; CODE XREF: sub_40516B+220j
					; sub_40516B+22Bj
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+24h]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	ecx, eax
		jz	short loc_4053E5
		mov	[esp+58h+var_50], 547h ; int
		mov	[esp+58h+var_54], offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aArgVtValuetabl ; "arg->vt == valuetable[arg->arg_pos-1].v"...
		call	sub_415230

loc_4053E5:				; CODE XREF: sub_40516B+25Cj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	edx, [eax+8]
		mov	[ebp+var_30], edx
		mov	edx, [eax+0Ch]
		mov	[ebp+var_2C], edx
		mov	edx, [eax+10h]
		mov	[ebp+var_28], edx
		mov	eax, [eax+14h]
		mov	[ebp+var_24], eax

loc_405412:				; CODE XREF: sub_40516B+23Bj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		cmp	eax, 12h	; switch 19 cases
		ja	loc_4055DC	; jumptable 00405428 default case
		mov	eax, ds:off_417A98[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40542A:				; CODE XREF: sub_40516B+2BDj
					; DATA XREF: .rdata:off_417A98o
		mov	[esp+58h+var_50], 54Dh ; jumptable 00405428 case 0
		mov	[esp+58h+var_54], offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aBug ;	"!\"bug\""
		call	sub_415230
		jmp	loc_4055DC	; jumptable 00405428 default case
; ---------------------------------------------------------------------------

loc_40544B:				; CODE XREF: sub_40516B+2BDj
					; DATA XREF: .rdata:off_417A98o
		mov	eax, [ebp+arg_1C] ; jumptable 00405428 cases 1-5
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_4042D5
		mov	[ebp+var_C], eax
		jmp	loc_4055DC	; jumptable 00405428 default case
; ---------------------------------------------------------------------------

loc_40548F:				; CODE XREF: sub_40516B+2BDj
					; DATA XREF: .rdata:off_417A98o
		mov	eax, [ebp+arg_1C] ; jumptable 00405428 cases 6-13
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_404968
		mov	[ebp+var_C], eax
		jmp	loc_4055DC	; jumptable 00405428 default case
; ---------------------------------------------------------------------------

loc_4054D3:				; CODE XREF: sub_40516B+2BDj
					; DATA XREF: .rdata:off_417A98o
		mov	eax, [ebp+arg_1C] ; jumptable 00405428 case 14
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_404D9D
		mov	[ebp+var_C], eax
		jmp	loc_4055DC	; jumptable 00405428 default case
; ---------------------------------------------------------------------------

loc_405517:				; CODE XREF: sub_40516B+2BDj
					; DATA XREF: .rdata:off_417A98o
		mov	eax, [ebp+arg_1C] ; jumptable 00405428 cases 15,17
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_404E0F
		mov	[ebp+var_C], eax
		jmp	loc_4055DC	; jumptable 00405428 default case
; ---------------------------------------------------------------------------

loc_40555B:				; CODE XREF: sub_40516B+2BDj
					; DATA XREF: .rdata:off_417A98o
		mov	eax, [ebp+arg_1C] ; jumptable 00405428 case 16
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_404FB0
		mov	[ebp+var_C], eax
		jmp	short loc_4055DC ; jumptable 00405428 default case
; ---------------------------------------------------------------------------

loc_40559C:				; CODE XREF: sub_40516B+2BDj
					; DATA XREF: .rdata:off_417A98o
		mov	eax, [ebp+arg_1C] ; jumptable 00405428 case 18
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_4050B7
		mov	[ebp+var_C], eax
		nop

loc_4055DC:				; CODE XREF: sub_40516B+2B0j
					; sub_40516B+2DBj ...
		cmp	[ebp+var_C], 0	; jumptable 00405428 default case
		jz	short loc_4055E7
		mov	eax, [ebp+var_C]
		jmp	short locret_405649
; ---------------------------------------------------------------------------

loc_4055E7:				; CODE XREF: sub_40516B+475j
		add	[ebp+var_14], 28h

loc_4055EB:				; CODE XREF: sub_40516B+20j
					; sub_40516B+33j ...
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_405190
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_405629
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		jmp	short loc_40562E
; ---------------------------------------------------------------------------

loc_405629:				; CODE XREF: sub_40516B+4A1j
		mov	eax, 0

loc_40562E:				; CODE XREF: sub_40516B+4BCj
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_405646
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_405646:				; CODE XREF: sub_40516B+4CAj
		mov	eax, [ebp+var_C]

locret_405649:				; CODE XREF: sub_40516B+74j
					; sub_40516B+BBj ...
		leave
		retn
sub_40516B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40564B	proc near		; CODE XREF: .text:00405C77p
					; .text:00405CAEp ...

NumOfElements	= dword	ptr -1E8h
SizeOfElements	= dword	ptr -1E4h
var_1E0		= dword	ptr -1E0h
var_1DC		= dword	ptr -1DCh
var_1D8		= dword	ptr -1D8h
var_1D4		= dword	ptr -1D4h
var_1D0		= dword	ptr -1D0h
var_1CC		= dword	ptr -1CCh
var_1BC		= dword	ptr -1BCh
var_1B4		= dword	ptr -1B4h
var_1B0		= byte ptr -1B0h
var_F0		= dword	ptr -0F0h
var_EC		= dword	ptr -0ECh
var_E8		= byte ptr -0E8h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Memory		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 1E0h
		lea	eax, [ebp+var_E8]
		mov	[ebp+var_EC], eax
		lea	eax, [ebp+var_1B0]
		mov	[ebp+Memory], eax
		mov	[ebp+var_1B4], 0
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_F0]
		mov	[esp+1E8h+var_1DC], eax
		mov	[esp+1E8h+var_1E0], 5
		lea	eax, [ebp+var_EC]
		mov	[esp+1E8h+SizeOfElements], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+1E8h+NumOfElements], eax
		call	sub_403801
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_405BC5
		mov	[ebp+var_14], 0
		mov	[ebp+var_1C], 0
		jmp	loc_405791
; ---------------------------------------------------------------------------

loc_4056C8:				; CODE XREF: sub_40564B+14Fj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40571D
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, [ebp+var_1C]
		jle	short loc_40571D
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		mov	[ebp+var_1C], eax

loc_40571D:				; CODE XREF: sub_40564B+98j
					; sub_40564B+B5j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		cmp	eax, [ebp+var_1C]
		jle	short loc_405755
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		mov	[ebp+var_1C], eax

loc_405755:				; CODE XREF: sub_40564B+EDj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		cmp	eax, [ebp+var_1C]
		jle	short loc_40578D
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		mov	[ebp+var_1C], eax

loc_40578D:				; CODE XREF: sub_40564B+125j
		add	[ebp+var_14], 1

loc_405791:				; CODE XREF: sub_40564B+78j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_4056C8
		cmp	[ebp+var_1C], 0
		jnz	loc_405885
		mov	[ebp+var_14], 0
		jmp	loc_405871
; ---------------------------------------------------------------------------

loc_4057B6:				; CODE XREF: sub_40564B+22Fj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_4057F3
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		lea	edx, [ecx+eax]
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		mov	[edx+1Ch], eax

loc_4057F3:				; CODE XREF: sub_40564B+186j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_405830
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		lea	edx, [ecx+eax]
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		mov	[edx+20h], eax

loc_405830:				; CODE XREF: sub_40564B+1C3j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40586D
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		lea	edx, [ecx+eax]
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		mov	[edx+18h], eax

loc_40586D:				; CODE XREF: sub_40564B+200j
		add	[ebp+var_14], 1

loc_405871:				; CODE XREF: sub_40564B+166j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_4057B6
		jmp	loc_40593E
; ---------------------------------------------------------------------------

loc_405885:				; CODE XREF: sub_40564B+159j
		mov	[ebp+var_14], 0
		jmp	loc_40592F
; ---------------------------------------------------------------------------

loc_405891:				; CODE XREF: sub_40564B+2EDj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		test	eax, eax
		jz	loc_405BAF
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_4058EE
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	loc_405BAF

loc_4058EE:				; CODE XREF: sub_40564B+281j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_40592B
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		test	eax, eax
		jz	loc_405BAF

loc_40592B:				; CODE XREF: sub_40564B+2BEj
		add	[ebp+var_14], 1

loc_40592F:				; CODE XREF: sub_40564B+241j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_405891

loc_40593E:				; CODE XREF: sub_40564B+235j
		cmp	[ebp+var_1C], 0
		js	loc_405BAF
		mov	ebx, [ebp+var_1C]
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1BC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1BC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	ebx, eax
		jnb	loc_405BAF
		mov	eax, [ebp+var_1C]
		cmp	eax, 8
		jbe	short loc_4059A1
		mov	eax, [ebp+var_1C]
		mov	[esp+1E8h+SizeOfElements], 18h ; SizeOfElements
		mov	[esp+1E8h+NumOfElements], eax ;	NumOfElements
		call	calloc
		mov	[ebp+Memory], eax
		cmp	[ebp+Memory], 0
		jnz	short loc_4059C9
		jmp	loc_405BBC
; ---------------------------------------------------------------------------

loc_4059A1:				; CODE XREF: sub_40564B+333j
		mov	[ebp+var_18], 0
		jmp	short loc_4059C3
; ---------------------------------------------------------------------------

loc_4059AA:				; CODE XREF: sub_40564B+37Cj
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	dword ptr [eax], 0
		add	[ebp+var_18], 1

loc_4059C3:				; CODE XREF: sub_40564B+35Dj
		cmp	[ebp+var_18], 7
		jbe	short loc_4059AA

loc_4059C9:				; CODE XREF: sub_40564B+34Fj
		mov	[ebp+var_14], 0
		jmp	loc_405B2A
; ---------------------------------------------------------------------------

loc_4059D5:				; CODE XREF: sub_40564B+4E8j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_405A54
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_405BA5
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		mov	ecx, eax
		add	ecx, [ebp+Memory]
		mov	ebx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ebx
		mov	eax, [eax+24h]
		mov	[ecx], eax

loc_405A54:				; CODE XREF: sub_40564B+3A5j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_405ABD
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_405BA8
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	dword ptr [eax], 6

loc_405ABD:				; CODE XREF: sub_40564B+424j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_405B26
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_405BAB
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	dword ptr [eax], 6

loc_405B26:				; CODE XREF: sub_40564B+48Dj
		add	[ebp+var_14], 1

loc_405B2A:				; CODE XREF: sub_40564B+385j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_4059D5
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+arg_C]
		mov	[esp+1E8h+var_1E0], edx
		mov	[esp+1E8h+SizeOfElements], eax
		mov	eax, [ebp+Memory]
		mov	[esp+1E8h+NumOfElements], eax
		call	sub_403F79
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_405BAE
		mov	edx, [ebp+var_F0]
		mov	eax, [ebp+var_EC]
		lea	ecx, [ebp+var_1B4]
		mov	[esp+1E8h+var_1CC], ecx
		mov	ecx, [ebp+var_20]
		mov	[esp+1E8h+var_1D0], ecx
		mov	ecx, [ebp+Memory]
		mov	[esp+1E8h+var_1D4], ecx
		mov	[esp+1E8h+var_1D8], edx
		mov	[esp+1E8h+var_1DC], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+1E8h+var_1E0], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+1E8h+SizeOfElements], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+1E8h+NumOfElements], eax
		call	sub_40516B
		mov	[ebp+var_10], eax
		jmp	short loc_405BC6
; ---------------------------------------------------------------------------

loc_405BA5:				; CODE XREF: sub_40564B+3D8j
		nop
		jmp	short loc_405BAF
; ---------------------------------------------------------------------------

loc_405BA8:				; CODE XREF: sub_40564B+457j
		nop
		jmp	short loc_405BAF
; ---------------------------------------------------------------------------

loc_405BAB:				; CODE XREF: sub_40564B+4C0j
		nop
		jmp	short loc_405BAF
; ---------------------------------------------------------------------------

loc_405BAE:				; CODE XREF: sub_40564B+50Ej
		nop

loc_405BAF:				; CODE XREF: sub_40564B+260j
					; sub_40564B+29Dj ...
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h

loc_405BBC:				; CODE XREF: sub_40564B+351j
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_405BC6
; ---------------------------------------------------------------------------

loc_405BC5:				; CODE XREF: sub_40564B+64j
		nop

loc_405BC6:				; CODE XREF: sub_40564B+558j
					; sub_40564B+578j
		lea	eax, [ebp+var_1B0]
		cmp	[ebp+Memory], eax
		jz	short loc_405BDC
		mov	eax, [ebp+Memory]
		mov	[esp+1E8h+NumOfElements], eax ;	Memory
		call	free

loc_405BDC:				; CODE XREF: sub_40564B+584j
		mov	edx, [ebp+var_EC]
		lea	eax, [ebp+var_E8]
		cmp	edx, eax
		jz	short loc_405BFA
		mov	eax, [ebp+var_EC]
		mov	[esp+1E8h+NumOfElements], eax ;	Memory
		call	free

loc_405BFA:				; CODE XREF: sub_40564B+59Fj
		mov	eax, [ebp+var_10]
		add	esp, 1E0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40564B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405C07(int, void *, size_t)
sub_405C07	proc near		; DATA XREF: .text:00405C70o
					; .text:00405CA7o ...

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 1 ; Count
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+Size],	edx ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		cmp	eax, 1
		jz	short loc_405C40
		mov	eax, 0FFFFFFFFh
		jmp	short locret_405C45
; ---------------------------------------------------------------------------

loc_405C40:				; CODE XREF: sub_405C07+30j
		mov	eax, 0

locret_405C45:				; CODE XREF: sub_405C07+37j
		leave
		retn
sub_405C07	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	edx, ds:_iob
		add	edx, 40h
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	dword ptr [esp], offset	sub_405C07
		call	sub_40564B
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+10h]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	sub_405C07
		call	sub_40564B
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	sub_405C07
		call	sub_40564B
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405CE4(int, void *, size_t)
sub_405CE4	proc near		; CODE XREF: sub_405DA0+6Dp
					; DATA XREF: sub_405DA0+42o

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_405D99
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	edx, eax
		jnb	short loc_405D84
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	ecx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		add	eax, ecx
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		jmp	short loc_405D99
; ---------------------------------------------------------------------------

loc_405D5C:				; CODE XREF: sub_405CE4+B3j
		mov	eax, [ebp+var_C]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+arg_4]
		movzx	edx, byte ptr [edx]
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		add	[ebp+arg_4], 1
		sub	[ebp+arg_8], 1

loc_405D84:				; CODE XREF: sub_405CE4+3Dj
		cmp	[ebp+arg_8], 0
		jz	short loc_405D99
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	edx, eax
		jb	short loc_405D5C

loc_405D99:				; CODE XREF: sub_405CE4+25j
					; sub_405CE4+76j ...
		mov	eax, 0
		leave
		retn
sub_405CE4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405DA0	proc near		; CODE XREF: .text:00405E82p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_18], 0
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_405DC5
		mov	eax, [ebp+arg_0]
		jmp	short loc_405DCA
; ---------------------------------------------------------------------------

loc_405DC5:				; CODE XREF: sub_405DA0+1Ej
		mov	eax, 0

loc_405DCA:				; CODE XREF: sub_405DA0+23j
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_34], eax
		mov	[esp+38h+var_38], offset sub_405CE4
		call	sub_40564B
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_405E15
		mov	[esp+38h+var_30], 1 ; size_t
		mov	[esp+38h+var_34], offset byte_417AE4 ; void *
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_38], eax ;	int
		call	sub_405CE4
		mov	[ebp+var_C], eax

loc_405E15:				; CODE XREF: sub_405DA0+55j
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_405E22
		mov	eax, 0FFFFFFFFh
		jmp	short locret_405E57
; ---------------------------------------------------------------------------

loc_405E22:				; CODE XREF: sub_405DA0+79j
		cmp	[ebp+arg_4], 0
		jz	short loc_405E4B
		cmp	[ebp+arg_0], 0
		jz	short loc_405E4B
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jz	short loc_405E4B
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_1C]
		cmp	edx, eax
		jb	short loc_405E4B
		mov	eax, [ebp+var_1C]
		sub	eax, 1
		add	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0

loc_405E4B:				; CODE XREF: sub_405DA0+86j
					; sub_405DA0+8Cj ...
		mov	eax, [ebp+var_18]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]

locret_405E57:				; CODE XREF: sub_405DA0+80j
		leave
		retn
sub_405DA0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+14h]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_405DA0
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405E8F(int, void *Src, size_t)
sub_405E8F	proc near		; CODE XREF: sub_405F9B+83p
					; DATA XREF: sub_405F9B+58o

Memory		= dword	ptr -28h
NewSize		= dword	ptr -24h
Size		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Src		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_405EBC
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	edx, [ebp+var_C]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, 0FFFFFFFFh
		jmp	locret_405F99
; ---------------------------------------------------------------------------

loc_405EBC:				; CODE XREF: sub_405E8F+13j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	loc_405F5D
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		add	eax, [ebp+arg_8]
		lea	edx, [eax+200h]
		mov	eax, [ebp+var_C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	[esp+28h+NewSize], edx ; NewSize
		mov	[esp+28h+Memory], eax ;	Memory
		call	realloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_405F54
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_405F23
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		jmp	short loc_405F28
; ---------------------------------------------------------------------------

loc_405F23:				; CODE XREF: sub_405E8F+87j
		mov	eax, 0Ch

loc_405F28:				; CODE XREF: sub_405E8F+92j
		mov	edx, [ebp+var_C]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	[esp+28h+Size],	edx ; Size
		mov	[esp+28h+NewSize], 0 ; Val
		mov	[esp+28h+Memory], eax ;	Dst
		call	memset
		mov	eax, 0FFFFFFFFh
		jmp	short locret_405F99
; ---------------------------------------------------------------------------

loc_405F54:				; CODE XREF: sub_405E8F+7Aj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		mov	[eax+0Ch], edx

loc_405F5D:				; CODE XREF: sub_405E8F+40j
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	ecx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		add	eax, ecx
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+NewSize], edx ; Src
		mov	[esp+28h+Memory], eax ;	Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, 0

locret_405F99:				; CODE XREF: sub_405E8F+28j
					; sub_405E8F+C3j
		leave
		retn
sub_405E8F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405F9B	proc near		; CODE XREF: sub_4060B4+22p
					; .text:0040B4B5p ...

Dst		= dword	ptr -38h
Val		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_1C], 0
		mov	[ebp+var_18], 200h
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		test	eax, eax
		jnz	short loc_405FDE
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh
		jmp	locret_4060B2
; ---------------------------------------------------------------------------

loc_405FDE:				; CODE XREF: sub_405F9B+2Ej
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Size],	eax
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+Val], eax
		mov	[esp+38h+Dst], offset sub_405E8F
		call	sub_40564B
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_406026
		mov	[esp+38h+Size],	1 ; size_t
		mov	[esp+38h+Val], offset byte_417AE4 ; Src
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+Dst], eax ; int
		call	sub_405E8F
		mov	[ebp+var_C], eax

loc_406026:				; CODE XREF: sub_405F9B+6Bj
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	short loc_406046
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jz	short loc_406046
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	edx, [ebp+var_1C]
		mov	[eax], edx

loc_406046:				; CODE XREF: sub_405F9B+8Fj
					; sub_405F9B+96j
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_406081
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Val], 0 ; Val
		mov	[esp+38h+Dst], eax ; Dst
		call	memset
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4060B2
; ---------------------------------------------------------------------------

loc_406081:				; CODE XREF: sub_405F9B+AFj
		mov	eax, [ebp+var_14]
		test	eax, eax
		jnz	short loc_4060A4
		mov	[esp+38h+Size],	6E9h ; int
		mov	[esp+38h+Val], offset a____Gnupg22__0 ;	"../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+38h+Dst], offset aParm_used ; "parm.used"
		call	sub_415230

loc_4060A4:				; CODE XREF: sub_405F9B+EBj
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		sub	eax, 1

locret_4060B2:				; CODE XREF: sub_405F9B+3Ej
					; sub_405F9B+E4j
		leave
		retn
sub_405F9B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4060B4	proc near		; CODE XREF: sub_4016C2+151p
					; sub_401952+1Bp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_405F9B
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4060B4	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4060E4	proc near		; CODE XREF: sub_4019CB+3Ep

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_406A1E
		mov	[esp+18h+var_14], eax ;	char *
		mov	[esp+18h+var_18], offset aGnupg2 ; "gnupg2"
		call	sub_40D40E
		leave
		retn
sub_4060E4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406101	proc near		; CODE XREF: .text:00406134p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 1
		call	sub_40DD82
		mov	eax, 0
		leave
		retn
sub_406101	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40611A	proc near		; CODE XREF: .text:00406150p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 0
		call	sub_40DD82
		leave
		retn
sub_40611A	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_406101
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40DCF4
		mov	[ebp-10h], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_40611A
		mov	eax, [ebp-10h]
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40615C	proc near		; CODE XREF: sub_4019CB+43p

wVersionRequested= word	ptr -1A8h
lpWSAData	= dword	ptr -1A4h
WSAData		= WSAData ptr -198h

		push	ebp
		mov	ebp, esp
		sub	esp, 1A8h
		mov	dword ptr [esp+1A8h+wVersionRequested],	0
		call	sub_4127EF
		lea	eax, [ebp+WSAData]
		mov	[esp+1A8h+lpWSAData], eax ; lpWSAData
		mov	dword ptr [esp+1A8h+wVersionRequested],	202h ; wVersionRequested
		mov	eax, ds:WSAStartup
		call	eax ; WSAStartup
		sub	esp, 8
		call	sub_40985C
		leave
		retn
sub_40615C	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406194(LPCSTR)
sub_406194	proc near		; CODE XREF: sub_406221+42p

lpLibFileName	= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+lpLibFileName], eax ; lpLibFileName
		mov	eax, ds:LoadLibraryA
		call	eax ; LoadLibraryA
		sub	esp, 4
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_406194	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4061B2(HMODULE, LPCSTR)
sub_4061B2	proc near		; CODE XREF: sub_406221+5Ep

hModule		= dword	ptr -28h
lpProcName	= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_4061F0
		cmp	[ebp+arg_4], 0
		jz	short loc_4061F0
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lpProcName], eax ; lpProcName
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hModule], eax ; hModule
		mov	eax, ds:GetProcAddress
		call	eax ; GetProcAddress
		sub	esp, 8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4061EB
		mov	eax, 0
		jmp	short locret_4061F5
; ---------------------------------------------------------------------------

loc_4061EB:				; CODE XREF: sub_4061B2+30j
		mov	eax, [ebp+var_C]
		jmp	short locret_4061F5
; ---------------------------------------------------------------------------

loc_4061F0:				; CODE XREF: sub_4061B2+Aj
					; sub_4061B2+10j
		mov	eax, 0

locret_4061F5:				; CODE XREF: sub_4061B2+37j
					; sub_4061B2+3Cj
		leave
		retn
sub_4061B2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4061F7(HANDLE)
sub_4061F7	proc near		; CODE XREF: sub_406221+77p

hObject		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_40621A
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		jmp	short locret_40621F
; ---------------------------------------------------------------------------

loc_40621A:				; CODE XREF: sub_4061F7+Aj
		mov	eax, 0FFFFFFFFh

locret_40621F:				; CODE XREF: sub_4061F7+21j
		leave
		retn
sub_4061F7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406221	proc near		; CODE XREF: sub_4062FB+77p
					; sub_4066F5+5Ap ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, ds:dword_41A1B4
		test	eax, eax
		jnz	loc_4062BC
		mov	ds:dword_41A1B4, 1
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		jmp	short loc_4062A8
; ---------------------------------------------------------------------------

loc_40624E:				; CODE XREF: sub_406221+99j
		mov	eax, [ebp+var_10]
		mov	eax, off_416080[eax*4]
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax ;	LPCSTR
		call	sub_406194
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4062A4
		mov	[esp+38h+var_34], offset aShgetfolderpat ; "SHGetFolderPathA"
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax ;	HMODULE
		call	sub_4061B2
		mov	ds:dword_41A1B8, eax
		mov	eax, ds:dword_41A1B8
		test	eax, eax
		jnz	short loc_4062A4
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax ;	HANDLE
		call	sub_4061F7
		mov	[ebp+var_C], 0

loc_4062A4:				; CODE XREF: sub_406221+4Ej
					; sub_406221+6Fj
		add	[ebp+var_10], 1

loc_4062A8:				; CODE XREF: sub_406221+2Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_4062BC
		mov	eax, [ebp+var_10]
		mov	eax, off_416080[eax*4]
		test	eax, eax
		jnz	short loc_40624E

loc_4062BC:				; CODE XREF: sub_406221+Dj
					; sub_406221+8Bj
		mov	eax, ds:dword_41A1B8
		test	eax, eax
		jz	short loc_4062F4
		mov	edx, ds:dword_41A1B8
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	edx ; dword_41A1B8
		sub	esp, 14h
		jmp	short locret_4062F9
; ---------------------------------------------------------------------------

loc_4062F4:				; CODE XREF: sub_406221+A2j
		mov	eax, 0FFFFFFFFh

locret_4062F9:				; CODE XREF: sub_406221+D1j
		leave
		retn
sub_406221	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4062FB	proc near		; CODE XREF: sub_406435+14p
					; sub_406435+B2p

lpPathName	= dword	ptr -148h
lpSecurityAttributes= dword ptr	-144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_11C		= dword	ptr -11Ch
var_114		= byte ptr -114h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:lpPathName
		test	eax, eax
		jnz	loc_406429
		call	sub_4065C8
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_41A040
		test	eax, eax
		jz	short loc_406349
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+lpSecurityAttributes], offset	aHome ;	"\\home"
		mov	eax, [ebp+var_C]
		mov	[esp+148h+lpPathName], eax
		call	sub_412396
		mov	ds:lpPathName, eax
		jmp	loc_406429
; ---------------------------------------------------------------------------

loc_406349:				; CODE XREF: sub_4062FB+27j
		lea	eax, [ebp+var_114]
		mov	[esp+148h+var_138], eax
		mov	[esp+148h+var_13C], 0
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+lpSecurityAttributes], 801Ah
		mov	[esp+148h+lpPathName], 0
		call	sub_406221
		test	eax, eax
		js	loc_40641F
		lea	eax, [ebp+var_114]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 7
		mov	[esp+148h+lpPathName], eax
		call	gcry_xmalloc
		mov	[ebp+var_10], eax
		mov	ebx, offset aGnupg ; "\\gnupg"
		lea	eax, [ebp+var_114]
		mov	[esp+148h+lpSecurityAttributes], eax
		mov	eax, [ebp+var_10]
		mov	[esp+148h+lpPathName], eax
		call	sub_411EAD
		mov	edx, [ebx]
		mov	[eax], edx
		movzx	edx, word ptr [ebx+4]
		mov	[eax+4], dx
		movzx	edx, byte ptr [ebx+6]
		mov	[eax+6], dl
		mov	eax, [ebp+var_10]
		mov	ds:lpPathName, eax
		mov	eax, ds:lpPathName
		mov	[esp+148h+lpSecurityAttributes], 0
		mov	[esp+148h+lpPathName], eax
		call	_access
		test	eax, eax
		jz	short loc_406429
		mov	eax, ds:lpPathName
		mov	[esp+148h+lpSecurityAttributes], 0 ; lpSecurityAttributes
		mov	[esp+148h+lpPathName], eax ; lpPathName
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8
		jmp	short loc_406429
; ---------------------------------------------------------------------------

loc_40641F:				; CODE XREF: sub_4062FB+7Ej
		mov	ds:lpPathName, offset aCGnupg ;	"c:/gnupg"

loc_406429:				; CODE XREF: sub_4062FB+12j
					; sub_4062FB+49j ...
		mov	eax, ds:lpPathName
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4062FB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406435	proc near		; CODE XREF: sub_4019CB+48p

VarName		= dword	ptr -28h
var_24		= dword	ptr -24h
lpValueName	= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_4065C8
		mov	eax, ds:dword_41A040
		test	eax, eax
		jz	short loc_406453
		call	sub_4062FB
		jmp	locret_406513
; ---------------------------------------------------------------------------

loc_406453:				; CODE XREF: sub_406435+12j
		mov	[esp+28h+VarName], offset aGnupghome ; "GNUPGHOME"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_406476
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4064F9

loc_406476:				; CODE XREF: sub_406435+31j
		mov	eax, ds:dword_41A1AC
		test	eax, eax
		jnz	short loc_4064F1
		cmp	[ebp+var_C], 0
		jz	short loc_40648F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4064DE

loc_40648F:				; CODE XREF: sub_406435+4Ej
		mov	[esp+28h+lpValueName], offset ValueName	; "HomeDir"
		mov	[esp+28h+var_24], offset aSoftwareGnuGnu ; "Software\\GNU\\GnuPG"
		mov	[esp+28h+VarName], 0 ; int
		call	sub_413706
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4064D0
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4064D0
		mov	eax, [ebp+var_10]
		mov	[esp+28h+VarName], eax
		call	gcry_free
		mov	[ebp+var_10], 0

loc_4064D0:				; CODE XREF: sub_406435+7Dj
					; sub_406435+87j
		cmp	[ebp+var_10], 0
		jz	short loc_4064DE
		mov	eax, [ebp+var_10]
		mov	ds:dword_41A1AC, eax

loc_4064DE:				; CODE XREF: sub_406435+58j
					; sub_406435+9Fj
		mov	eax, ds:dword_41A1AC
		test	eax, eax
		jnz	short loc_4064F1
		call	sub_4062FB
		mov	ds:dword_41A1AC, eax

loc_4064F1:				; CODE XREF: sub_406435+48j
					; sub_406435+B0j
		mov	eax, ds:dword_41A1AC
		mov	[ebp+var_C], eax

loc_4064F9:				; CODE XREF: sub_406435+3Bj
		cmp	[ebp+var_C], 0
		jz	short loc_406509
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_406510

loc_406509:				; CODE XREF: sub_406435+C8j
		mov	[ebp+var_C], offset aCGnupg ; "c:/gnupg"

loc_406510:				; CODE XREF: sub_406435+D2j
		mov	eax, [ebp+var_C]

locret_406513:				; CODE XREF: sub_406435+19j
		leave
		retn
sub_406435	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406515	proc near		; CODE XREF: sub_4065C8+91p

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	[esp+38h+var_30], 0
		mov	dword ptr [esp+38h+var_34], offset aGpgconf_exe	; "\\gpgconf.exe"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_412396
		mov	dword ptr [ebp+var_C], eax
		mov	dword ptr [esp+38h+var_34], 0
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	_access
		test	eax, eax
		jz	short loc_406567
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aRequiredBinary ; "required binary '%s' is not installed\n"
		call	sub_40E5DD
		jmp	short loc_4065B6
; ---------------------------------------------------------------------------

loc_406567:				; CODE XREF: sub_406515+3Bj
		mov	ebx, offset aCtl ; "ctl"
		mov	eax, dword ptr [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 3
		add	eax, dword ptr [ebp+var_C]
		mov	edx, [ebx]
		mov	[eax], edx
		mov	dword ptr [esp+38h+var_34], 0
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	_access
		test	eax, eax
		jnz	short loc_4065B6
		mov	ds:dword_41A040, 1

loc_4065B6:				; CODE XREF: sub_406515+50j
					; sub_406515+95j
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_406515	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4065C8	proc near		; CODE XREF: sub_4062FB+18p
					; sub_406435+6p ...

hModule		= dword	ptr -28h
lpFilename	= dword	ptr -24h
nSize		= dword	ptr -20h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, ds:dword_41A08C
		test	eax, eax
		jnz	loc_4066D7
		mov	[esp+28h+nSize], 104h ;	nSize
		mov	[esp+28h+lpFilename], offset Str ; lpFilename
		mov	[esp+28h+hModule], 0 ; hModule
		mov	eax, ds:GetModuleFileNameA
		call	eax ; GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_406625
		mov	[esp+28h+hModule], 0 ; DWORD
		call	sub_411B0A
		mov	[esp+28h+lpFilename], eax ; char
		mov	[esp+28h+hModule], offset aGetmodulefilen ; "GetModuleFileName failed: %s\n"
		call	sub_40E67A
		mov	ds:Str,	0

loc_406625:				; CODE XREF: sub_4065C8+38j
		mov	ds:dword_41A08C, 1
		mov	[esp+28h+lpFilename], 5Ch ; Ch
		mov	[esp+28h+hModule], offset Str ;	Str
		call	strrchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4066B6
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	[esp+28h+hModule], offset Str
		call	sub_406515
		mov	[esp+28h+lpFilename], 5Ch ; Ch
		mov	[esp+28h+hModule], offset Str ;	Str
		call	strrchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4066B6
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	edx, eax
		mov	eax, offset aBin ; "bin"
		mov	ecx, 4
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4066B6
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	ds:dword_41A044, 1

loc_4066B6:				; CODE XREF: sub_4065C8+82j
					; sub_4065C8+B1j ...
		cmp	[ebp+var_C], 0
		jnz	short loc_4066D7
		mov	[esp+28h+lpFilename], offset Str ; char
		mov	[esp+28h+hModule], offset aBadFilenameSRe ; "bad filename `%s' returned for this pro"...
		call	sub_40E67A
		mov	ds:Str,	0

loc_4066D7:				; CODE XREF: sub_4065C8+Fj
					; sub_4065C8+F2j
		movzx	eax, ds:Str
		test	al, al
		jz	short loc_4066E9
		mov	eax, offset Str
		jmp	short loc_4066EE
; ---------------------------------------------------------------------------

loc_4066E9:				; CODE XREF: sub_4065C8+118j
		mov	eax, offset aCGnupg_0 ;	"c:\\gnupg"

loc_4066EE:				; CODE XREF: sub_4065C8+11Fj
		lea	esp, [ebp-8]
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4065C8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4066F5	proc near		; CODE XREF: .text:004067F1p

var_148		= dword	ptr -148h
var_144		= dword	ptr -144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_11C		= dword	ptr -11Ch
var_114		= byte ptr -114h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:dword_41A088
		test	eax, eax
		jnz	loc_4067CD
		call	sub_4065C8
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_41A040
		test	eax, eax
		jz	short loc_406726
		mov	eax, [ebp+var_C]
		jmp	loc_4067D2
; ---------------------------------------------------------------------------

loc_406726:				; CODE XREF: sub_4066F5+27j
		lea	eax, [ebp+var_114]
		mov	[esp+148h+var_138], eax
		mov	[esp+148h+var_13C], 0
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+var_144], 23h
		mov	[esp+148h+var_148], 0
		call	sub_406221
		test	eax, eax
		js	short loc_4067BD
		lea	eax, [ebp+var_114]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 5
		mov	[esp+148h+var_148], eax
		call	gcry_xmalloc
		mov	[ebp+var_10], eax
		mov	ebx, offset aGnu ; "\\GNU"
		lea	eax, [ebp+var_114]
		mov	[esp+148h+var_144], eax
		mov	eax, [ebp+var_10]
		mov	[esp+148h+var_148], eax
		call	sub_411EAD
		mov	edx, [ebx]
		mov	[eax], edx
		movzx	edx, byte ptr [ebx+4]
		mov	[eax+4], dl
		mov	eax, [ebp+var_10]
		mov	ds:dword_41A088, eax
		jmp	short loc_4067CD
; ---------------------------------------------------------------------------

loc_4067BD:				; CODE XREF: sub_4066F5+61j
		mov	eax, [ebp+var_C]
		mov	[esp+148h+var_148], eax
		call	gcry_xstrdup
		mov	ds:dword_41A088, eax

loc_4067CD:				; CODE XREF: sub_4066F5+12j
					; sub_4066F5+C6j
		mov	eax, ds:dword_41A088

loc_4067D2:				; CODE XREF: sub_4066F5+2Cj
		add	esp, 140h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4066F5	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_41A084
		test	eax, eax
		jnz	loc_406873
		call	sub_4066F5
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aEtcGnupg ;	"\\etc\\gnupg"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_41A084, eax
		mov	eax, ds:dword_41A084
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_411EAD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_406873:				; CODE XREF: .text:004067EBj
		mov	eax, ds:dword_41A084
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40687F	proc near		; CODE XREF: sub_4068CB+6p
					; .text:00406BF8p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_4065C8
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_41A044
		test	eax, eax
		jz	short loc_4068C6
		mov	eax, ds:dword_41A080
		test	eax, eax
		jnz	short loc_4068BF
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], offset aBin_0	; "\\bin"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_412396
		mov	ds:dword_41A080, eax

loc_4068BF:				; CODE XREF: sub_40687F+1Ej
		mov	eax, ds:dword_41A080
		jmp	short locret_4068C9
; ---------------------------------------------------------------------------

loc_4068C6:				; CODE XREF: sub_40687F+15j
		mov	eax, [ebp+var_C]

locret_4068C9:				; CODE XREF: sub_40687F+45j
		leave
		retn
sub_40687F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4068CB	proc near		; CODE XREF: .text:00406D2Ap
					; .text:00406E5Cp ...
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		call	sub_40687F
		leave
		retn
sub_4068CB	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_41A07C
		test	eax, eax
		jnz	loc_40696F
		call	sub_4065C8
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aLibGnupg ;	"\\lib\\gnupg"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_41A07C, eax
		mov	eax, ds:dword_41A07C
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_411EAD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_40696F:				; CODE XREF: .text:004068E7j
		mov	eax, ds:dword_41A07C
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_41A078
		test	eax, eax
		jnz	loc_406A12
		call	sub_4065C8
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aShareGnupg	; "\\share\\gnupg"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_41A078, eax
		mov	eax, ds:dword_41A078
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_411EAD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_406A12:				; CODE XREF: .text:0040698Aj
		mov	eax, ds:dword_41A078
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406A1E	proc near		; CODE XREF: sub_4060E4+6p

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_41A074
		test	eax, eax
		jnz	loc_406AB5
		call	sub_4065C8
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aShareLocale ; "\\share\\locale"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_41A074, eax
		mov	eax, ds:dword_41A074
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_411EAD
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_406AB5:				; CODE XREF: sub_406A1E+Fj
		mov	eax, ds:dword_41A074
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_406A1E	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:dword_41A070
		test	eax, eax
		jnz	loc_406BBB
		lea	eax, [ebp-110h]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 24h
		mov	dword ptr [esp], 0
		call	sub_406221
		test	eax, eax
		jns	short loc_406B2F
		mov	edx, offset aCWindows ;	"C:\\WINDOWS"
		lea	eax, [ebp-110h]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	ecx, word ptr [edx+8]
		mov	[eax+8], cx
		movzx	edx, byte ptr [edx+0Ah]
		mov	[eax+0Ah], dl

loc_406B2F:				; CODE XREF: .text:00406B09j
		mov	dword ptr [ebp-0Ch], offset aS_dirmngr ; "\\S.dirmngr"
		lea	eax, [ebp-110h]
		mov	dword ptr [ebp-11Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-11Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-11Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-11Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_41A070, eax
		mov	eax, ds:dword_41A070
		lea	edx, [ebp-110h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_411EAD
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_406BBB:				; CODE XREF: .text:00406AD3j
		mov	eax, ds:dword_41A070
		add	esp, 140h
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		cmp	dword ptr [ebp+8], 0Ah ; switch	11 cases
		ja	loc_4071E2	; jumptable 00406BE9 default case
		mov	eax, [ebp+8]
		shl	eax, 2
		add	eax, offset off_417CE4
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_406BEB:				; CODE XREF: .text:00406BE9j
					; DATA XREF: .rdata:off_417CE4o
		mov	eax, ds:dword_41A048 ; jumptable 00406BE9 case 1
		test	eax, eax
		jnz	loc_406C7A
		call	sub_40687F
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aGpgAgent_exe ; "\\gpg-agent.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_41A048, eax
		mov	eax, ds:dword_41A048
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_411EAD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_406C7A:				; CODE XREF: .text:00406BF2j
		mov	eax, ds:dword_41A048
		jmp	loc_4071FE
; ---------------------------------------------------------------------------

loc_406C84:				; CODE XREF: .text:00406BE9j
					; DATA XREF: .rdata:off_417CE4o
		mov	eax, ds:dword_41A04C ; jumptable 00406BE9 case 2
		test	eax, eax
		jnz	loc_406D13
		call	sub_40687F
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aPinentry_exe ; "\\pinentry.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_41A04C, eax
		mov	eax, ds:dword_41A04C
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_411EAD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_406D13:				; CODE XREF: .text:00406C8Bj
		mov	eax, ds:dword_41A04C
		jmp	loc_4071FE
; ---------------------------------------------------------------------------

loc_406D1D:				; CODE XREF: .text:00406BE9j
					; DATA XREF: .rdata:off_417CE4o
		mov	eax, ds:dword_41A050 ; jumptable 00406BE9 case 3
		test	eax, eax
		jnz	loc_406DAC
		call	sub_4068CB
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aScdaemon_exe ; "\\scdaemon.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_41A050, eax
		mov	eax, ds:dword_41A050
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_411EAD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_406DAC:				; CODE XREF: .text:00406D24j
		mov	eax, ds:dword_41A050
		jmp	loc_4071FE
; ---------------------------------------------------------------------------

loc_406DB6:				; CODE XREF: .text:00406BE9j
					; DATA XREF: .rdata:off_417CE4o
		mov	eax, ds:dword_41A054 ; jumptable 00406BE9 case 4
		test	eax, eax
		jnz	loc_406E45
		call	sub_40687F
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aDirmngr_exe ; "\\dirmngr.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_41A054, eax
		mov	eax, ds:dword_41A054
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_411EAD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_406E45:				; CODE XREF: .text:00406DBDj
		mov	eax, ds:dword_41A054
		jmp	loc_4071FE
; ---------------------------------------------------------------------------

loc_406E4F:				; CODE XREF: .text:00406BE9j
					; DATA XREF: .rdata:off_417CE4o
		mov	eax, ds:dword_41A058 ; jumptable 00406BE9 case 5
		test	eax, eax
		jnz	loc_406EDE
		call	sub_4068CB
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aGpgProtectTool ; "\\gpg-protect-tool.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_41A058, eax
		mov	eax, ds:dword_41A058
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_411EAD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_406EDE:				; CODE XREF: .text:00406E56j
		mov	eax, ds:dword_41A058
		jmp	loc_4071FE
; ---------------------------------------------------------------------------

loc_406EE8:				; CODE XREF: .text:00406BE9j
					; DATA XREF: .rdata:off_417CE4o
		mov	eax, ds:dword_41A05C ; jumptable 00406BE9 case 6
		test	eax, eax
		jnz	loc_406F77
		call	sub_4068CB
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aGpgCheckPatter ; "\\gpg-check-pattern.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_41A05C, eax
		mov	eax, ds:dword_41A05C
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_411EAD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_406F77:				; CODE XREF: .text:00406EEFj
		mov	eax, ds:dword_41A05C
		jmp	loc_4071FE
; ---------------------------------------------------------------------------

loc_406F81:				; CODE XREF: .text:00406BE9j
					; DATA XREF: .rdata:off_417CE4o
		mov	eax, ds:dword_41A060 ; jumptable 00406BE9 case 7
		test	eax, eax
		jnz	loc_407010
		call	sub_40687F
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aGpgsm_exe ; "\\gpgsm.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_41A060, eax
		mov	eax, ds:dword_41A060
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_411EAD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_407010:				; CODE XREF: .text:00406F88j
		mov	eax, ds:dword_41A060
		jmp	loc_4071FE
; ---------------------------------------------------------------------------

loc_40701A:				; CODE XREF: .text:00406BE9j
					; DATA XREF: .rdata:off_417CE4o
		mov	eax, ds:dword_41A064 ; jumptable 00406BE9 case 8
		test	eax, eax
		jnz	loc_4070A9
		call	sub_40687F
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aGpg2_exe ;	"\\gpg2.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_41A064, eax
		mov	eax, ds:dword_41A064
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_411EAD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_4070A9:				; CODE XREF: .text:00407021j
		mov	eax, ds:dword_41A064
		jmp	loc_4071FE
; ---------------------------------------------------------------------------

loc_4070B3:				; CODE XREF: .text:00406BE9j
					; DATA XREF: .rdata:off_417CE4o
		mov	eax, ds:dword_41A068 ; jumptable 00406BE9 case 9
		test	eax, eax
		jnz	loc_407142
		call	sub_40687F
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aGpgConnectAgen ; "\\gpg-connect-agent.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_41A068, eax
		mov	eax, ds:dword_41A068
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_411EAD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_407142:				; CODE XREF: .text:004070BAj
		mov	eax, ds:dword_41A068
		jmp	loc_4071FE
; ---------------------------------------------------------------------------

loc_40714C:				; CODE XREF: .text:00406BE9j
					; DATA XREF: .rdata:off_417CE4o
		mov	eax, ds:dword_41A06C ; jumptable 00406BE9 case 10
		test	eax, eax
		jnz	loc_4071DB
		call	sub_40687F
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aGpgconf_exe ; "\\gpgconf.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_41A06C, eax
		mov	eax, ds:dword_41A06C
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_411EAD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_4071DB:				; CODE XREF: .text:00407153j
		mov	eax, ds:dword_41A06C
		jmp	short loc_4071FE
; ---------------------------------------------------------------------------

loc_4071E2:				; CODE XREF: .text:00406BD6j
					; .text:00406BE9j
					; DATA XREF: ...
		mov	dword ptr [esp+8], offset aGnupg_module_n ; jumptable 00406BE9 default case
		mov	dword ptr [esp+4], 229h
		mov	dword ptr [esp], offset	a____Gnupg22__1	; "../../gnupg2-2.0.30/common/homedir.c"
		call	sub_40E76C
; ---------------------------------------------------------------------------

loc_4071FE:				; CODE XREF: .text:00406C7Fj
					; .text:00406D18j ...
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407208	proc near		; CODE XREF: sub_40727A+32p
					; sub_40727A+82p ...
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_407208	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40720D	proc near		; CODE XREF: .text:0040A5E5p
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_40720D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407217(size_t)
sub_407217	proc near		; CODE XREF: sub_407234+12p
					; sub_40727A+Dp ...

Size		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_407227
		add	[ebp+arg_0], 1

loc_407227:				; CODE XREF: sub_407217+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Size],	eax ; Size
		call	malloc
		leave
		retn
sub_407217	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407234(void *, size_t)
sub_407234	proc near		; CODE XREF: .text:0040B037p
					; .text:0040B263p
					; DATA XREF: ...

Memory		= dword	ptr -18h
NewSize		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_40724D
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+Memory], eax ;	size_t
		call	sub_407217
		jmp	short locret_40725F
; ---------------------------------------------------------------------------

loc_40724D:				; CODE XREF: sub_407234+Aj
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+NewSize], eax ; NewSize
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	realloc

locret_40725F:				; CODE XREF: sub_407234+17j
		leave
		retn
sub_407234	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407261(void *)
sub_407261	proc near		; CODE XREF: sub_40730D+5Ap
					; sub_407AA4+29p ...

Memory		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_407278
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

locret_407278:				; CODE XREF: sub_407261+Aj
		leave
		retn
sub_407261	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40727A	proc near		; CODE XREF: sub_408658+E7p

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 0Ch ;	size_t
		call	sub_407217
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40729E
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_407308
; ---------------------------------------------------------------------------

loc_40729E:				; CODE XREF: sub_40727A+19j
		cmp	[ebp+arg_4], 0
		jnz	short loc_4072B1
		mov	eax, ds:dword_41A1C4
		mov	[esp+28h+var_28], eax
		call	sub_407208

loc_4072B1:				; CODE XREF: sub_40727A+28j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_0]
		mov	[eax], edx
		mov	edx, ds:dword_41A1C0
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+8], offset dword_41A1C0
		mov	eax, ds:dword_41A1C0
		test	eax, eax
		jz	short loc_4072E6
		mov	eax, ds:dword_41A1C0
		mov	edx, [ebp+var_10]
		add	edx, 4
		mov	[eax+8], edx

loc_4072E6:				; CODE XREF: sub_40727A+5Cj
		mov	eax, [ebp+var_10]
		mov	ds:dword_41A1C0, eax
		cmp	[ebp+arg_4], 0
		jnz	short loc_407301
		mov	eax, ds:dword_41A1C4
		mov	[esp+28h+var_28], eax
		call	sub_407208

loc_407301:				; CODE XREF: sub_40727A+78j
		mov	[ebp+var_C], 0

loc_407308:				; CODE XREF: sub_40727A+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40727A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40730D	proc near		; CODE XREF: sub_40877F+20p

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 0
		jnz	short loc_407326
		mov	eax, ds:dword_41A1C4
		mov	[esp+28h+var_28], eax
		call	sub_407208

loc_407326:				; CODE XREF: sub_40730D+Aj
		mov	eax, ds:dword_41A1C0
		mov	[ebp+var_C], eax
		jmp	short loc_407377
; ---------------------------------------------------------------------------

loc_407330:				; CODE XREF: sub_40730D+6Ej
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_40736E
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		mov	edx, [edx+4]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_407361
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		mov	edx, [edx+8]
		mov	[eax+8], edx

loc_407361:				; CODE XREF: sub_40730D+43j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_407261
		jmp	short loc_40737D
; ---------------------------------------------------------------------------

loc_40736E:				; CODE XREF: sub_40730D+2Bj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[ebp+var_C], eax

loc_407377:				; CODE XREF: sub_40730D+21j
		cmp	[ebp+var_C], 0
		jnz	short loc_407330

loc_40737D:				; CODE XREF: sub_40730D+5Fj
		cmp	[ebp+arg_4], 0
		jnz	short locret_407390
		mov	eax, ds:dword_41A1C4
		mov	[esp+28h+var_28], eax
		call	sub_407208

locret_407390:				; CODE XREF: sub_40730D+74j
		leave
		retn
sub_40730D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407392	proc near		; CODE XREF: sub_40A7AA+4Bp

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, ds:dword_41A1C4
		mov	[esp+28h+var_28], eax
		call	sub_407208
		mov	eax, ds:dword_41A1C0
		mov	[ebp+var_C], eax
		jmp	short loc_4073CF
; ---------------------------------------------------------------------------

loc_4073B6:				; CODE XREF: sub_407392+41j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+arg_0]
		call	eax
		or	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[ebp+var_C], eax

loc_4073CF:				; CODE XREF: sub_407392+22j
		cmp	[ebp+var_C], 0
		jnz	short loc_4073B6
		mov	eax, ds:dword_41A1C4
		mov	[esp+28h+var_28], eax
		call	sub_407208
		mov	eax, [ebp+var_10]
		leave
		retn
sub_407392	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4073E7()
sub_4073E7	proc near		; DATA XREF: sub_407405+19o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 0
		call	sub_40A7AA
		leave
		retn
sub_4073E7	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407405	proc near		; CODE XREF: sub_40985C+6p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_41A1D8
		test	eax, eax
		jnz	short loc_40742A
		mov	ds:dword_41A1D8, 1
		mov	[esp+18h+var_18], offset sub_4073E7 ; _onexit_t
		call	sub_413D70

loc_40742A:				; CODE XREF: sub_407405+Dj
		mov	eax, 0
		leave
		retn
sub_407405	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407431	proc near		; CODE XREF: sub_4091B2+69p
					; .text:00409A06p ...

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 0
		jnz	short loc_407460
		cmp	[ebp+arg_8], 0
		jnz	short loc_407449
		cmp	[ebp+arg_C], 0
		jz	short loc_407460

loc_407449:				; CODE XREF: sub_407431+10j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_407519
; ---------------------------------------------------------------------------

loc_407460:				; CODE XREF: sub_407431+Aj
					; sub_407431+16j
		mov	[esp+28h+var_28], 28h ;	size_t
		call	sub_407217
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_407481
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_407516
; ---------------------------------------------------------------------------

loc_407481:				; CODE XREF: sub_407431+42j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_20]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	[eax+8], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_24]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_10]
		mov	[eax+18h], edx
		cmp	[ebp+arg_14], 0
		setnz	dl
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		and	ecx, 1
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFFEh
		or	edx, ecx
		mov	[eax+1Ch], dl
		cmp	[ebp+arg_18], 0
		jz	short loc_4074E6
		mov	eax, [ebp+arg_18]
		jmp	short loc_4074EB
; ---------------------------------------------------------------------------

loc_4074E6:				; CODE XREF: sub_407431+AEj
		mov	eax, offset sub_407234

loc_4074EB:				; CODE XREF: sub_407431+B3j
		mov	edx, [ebp+var_10]
		mov	[edx+20h], eax
		cmp	[ebp+arg_1C], 0
		jz	short loc_4074FC
		mov	eax, [ebp+arg_1C]
		jmp	short loc_407501
; ---------------------------------------------------------------------------

loc_4074FC:				; CODE XREF: sub_407431+C4j
		mov	eax, offset sub_407261

loc_407501:				; CODE XREF: sub_407431+C9j
		mov	edx, [ebp+var_10]
		mov	[edx+24h], eax
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_407516:				; CODE XREF: sub_407431+4Bj
		mov	eax, [ebp+var_C]

locret_407519:				; CODE XREF: sub_407431+2Aj
		leave
		retn
sub_407431	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40751B(int, void *, size_t)
sub_40751B	proc near		; DATA XREF: .data:off_41608Co

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+arg_8]
		jnb	short loc_407553
		mov	eax, [ebp+var_C]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+arg_8], eax

loc_407553:				; CODE XREF: sub_40751B+21j
		cmp	[ebp+arg_8], 0
		jz	short loc_407590
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		add	edx, eax
		mov	eax, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+10h], edx

loc_407590:				; CODE XREF: sub_40751B+3Cj
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		leave
		retn
sub_40751B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40759B(int, void *, size_t)
sub_40759B	proc near		; DATA XREF: .data:off_416090o

Dst		= dword	ptr -48h
Src		= dword	ptr -44h
Size		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+arg_8], 0
		jnz	short loc_4075B8
		mov	eax, 0
		jmp	loc_407819
; ---------------------------------------------------------------------------

loc_4075B8:				; CODE XREF: sub_40759B+11j
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		and	eax, 8
		test	eax, eax
		jz	short loc_4075D0
		mov	eax, [ebp+var_10]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	[eax+10h], edx

loc_4075D0:				; CODE XREF: sub_40759B+27j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	edx, eax
		jnb	short loc_4075FC
		mov	[esp+48h+Size],	283h ; int
		mov	[esp+48h+Src], offset a____Gnupg22__2 ;	"../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+48h+Dst], offset aMem_cookieMemo ;	"mem_cookie->memory_size >= mem_cookie->"...
		call	sub_415230

loc_4075FC:				; CODE XREF: sub_40759B+43j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 1
		test	al, al
		jnz	short loc_40762D
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_14]
		jbe	short loc_40762D
		mov	eax, [ebp+var_14]
		mov	[ebp+arg_8], eax

loc_40762D:				; CODE XREF: sub_40759B+82j
					; sub_40759B+8Aj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_14]
		jbe	loc_4077B3
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_40764B
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		jmp	short loc_407662
; ---------------------------------------------------------------------------

loc_40764B:				; CODE XREF: sub_40759B+A6j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_14]
		mov	ecx, [ebp+arg_8]
		mov	ebx, ecx
		sub	ebx, edx
		mov	edx, ebx
		add	eax, edx
		mov	[ebp+var_C], eax

loc_407662:				; CODE XREF: sub_40759B+AEj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	eax, [ebp+var_C]
		jbe	short loc_407684
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	loc_407819
; ---------------------------------------------------------------------------

loc_407684:				; CODE XREF: sub_40759B+D0j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	short loc_4076E5
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		add	eax, [ebp+var_C]
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	eax, [ebp+var_C]
		jbe	short loc_4076BF
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	loc_407819
; ---------------------------------------------------------------------------

loc_4076BF:				; CODE XREF: sub_40759B+10Bj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_C]
		mov	edx, 0
		div	[ebp+var_2C]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_C]
		imul	eax, edx
		mov	[ebp+var_C], eax

loc_4076E5:				; CODE XREF: sub_40759B+F1j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_407711
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_C]
		jnb	short loc_407711
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 1Ch
		mov	eax, 0FFFFFFFFh
		jmp	loc_407819
; ---------------------------------------------------------------------------

loc_407711:				; CODE XREF: sub_40759B+152j
					; sub_40759B+15Dj
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		mov	[esp+48h+Src], edx
		mov	[esp+48h+Dst], eax
		call	ecx
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_40773C
		mov	eax, 0FFFFFFFFh
		jmp	loc_407819
; ---------------------------------------------------------------------------

loc_40773C:				; CODE XREF: sub_40759B+195j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	edx, eax
		jnb	short loc_40777A
		mov	[esp+48h+Size],	2B6h ; int
		mov	[esp+48h+Src], offset a____Gnupg22__2 ;	"../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+48h+Dst], offset aMem_cookieMemo ;	"mem_cookie->memory_size >= mem_cookie->"...
		call	sub_415230

loc_40777A:				; CODE XREF: sub_40759B+1C1j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_14]
		jbe	short loc_4077B3
		mov	[esp+48h+Size],	2B9h ; int
		mov	[esp+48h+Src], offset a____Gnupg22__2 ;	"../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+48h+Dst], offset aSizeNleft ; "size <= nleft"
		call	sub_415230

loc_4077B3:				; CODE XREF: sub_40759B+98j
					; sub_40759B+1FAj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		add	eax, edx
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+14h]
		cmp	edx, eax
		jbe	short loc_4077FF
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_10]
		mov	[eax+14h], edx

loc_4077FF:				; CODE XREF: sub_40759B+251j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_10]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]

loc_407819:				; CODE XREF: sub_40759B+18j
					; sub_40759B+E4j ...
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_40759B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40781F	proc near		; DATA XREF: .data:off_416094o

Dst		= dword	ptr -48h
Val		= dword	ptr -44h
Size		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_8]
		cmp	eax, 1
		jz	short loc_40784C
		cmp	eax, 2
		jz	short loc_407875
		test	eax, eax
		jnz	short loc_40789E
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_4078B5
; ---------------------------------------------------------------------------

loc_40784C:				; CODE XREF: sub_40781F+12j
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+10h]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_14]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_4078B5
; ---------------------------------------------------------------------------

loc_407875:				; CODE XREF: sub_40781F+17j
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+14h]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_14]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_4078B5
; ---------------------------------------------------------------------------

loc_40789E:				; CODE XREF: sub_40781F+1Bj
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_407A3A
; ---------------------------------------------------------------------------

loc_4078B5:				; CODE XREF: sub_40781F+2Bj
					; sub_40781F+54j ...
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jg	loc_4079CA
		cmp	edx, [ebp+var_C]
		jl	short loc_4078D7
		cmp	eax, [ebp+var_10]
		jnb	loc_4079CA

loc_4078D7:				; CODE XREF: sub_40781F+ADj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 1
		test	al, al
		jnz	short loc_4078FC
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 1Ch
		mov	eax, 0FFFFFFFFh
		jmp	locret_407A3A
; ---------------------------------------------------------------------------

loc_4078FC:				; CODE XREF: sub_40781F+C4j
		mov	eax, [ebp+var_14]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		add	eax, edx
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jg	short loc_40793B
		cmp	edx, [ebp+var_C]
		jl	short loc_407924
		cmp	eax, [ebp+var_10]
		jnb	short loc_40793B

loc_407924:				; CODE XREF: sub_40781F+FEj
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_407A3A
; ---------------------------------------------------------------------------

loc_40793B:				; CODE XREF: sub_40781F+F9j
					; sub_40781F+103j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_18]
		mov	edx, 0
		div	[ebp+var_2C]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_18]
		imul	eax, edx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_40798D
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_18]
		jnb	short loc_40798D
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 1Ch
		mov	eax, 0FFFFFFFFh
		jmp	locret_407A3A
; ---------------------------------------------------------------------------

loc_40798D:				; CODE XREF: sub_40781F+14Aj
					; sub_40781F+155j
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_18]
		mov	[esp+48h+Val], edx
		mov	[esp+48h+Dst], eax
		call	ecx
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_4079B8
		mov	eax, 0FFFFFFFFh
		jmp	locret_407A3A
; ---------------------------------------------------------------------------

loc_4079B8:				; CODE XREF: sub_40781F+18Dj
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_1C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_18]
		mov	[eax+8], edx

loc_4079CA:				; CODE XREF: sub_40781F+A4j
					; sub_40781F+B2j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jg	short loc_407A1E
		cmp	edx, [ebp+var_C]
		jl	short loc_4079E4
		cmp	eax, [ebp+var_10]
		jnb	short loc_407A1E

loc_4079E4:				; CODE XREF: sub_40781F+1BEj
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_14]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		add	eax, edx
		mov	edx, ecx
		mov	[esp+48h+Size],	edx ; Size
		mov	[esp+48h+Val], 0 ; Val
		mov	[esp+48h+Dst], eax ; Dst
		call	memset
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	[eax+14h], edx

loc_407A1E:				; CODE XREF: sub_40781F+1B9j
					; sub_40781F+1C3j
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	[eax+10h], edx
		mov	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	eax, 0

locret_407A3A:				; CODE XREF: sub_40781F+91j
					; sub_40781F+D8j ...
		leave
		retn
sub_40781F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407A3C	proc near		; DATA XREF: sub_409A94+109o

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+arg_4], 1
		jnz	short loc_407A8B
		mov	eax, [ebp+var_10]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [eax+10h]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+10h], 0
		mov	[ebp+var_C], 0
		jmp	short loc_407A9F
; ---------------------------------------------------------------------------

loc_407A8B:				; CODE XREF: sub_407A3C+10j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	[ebp+var_C], 0FFFFFFFFh

loc_407A9F:				; CODE XREF: sub_407A3C+4Dj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_407A3C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407AA4	proc near		; CODE XREF: sub_4091B2+33Fp
					; .text:00409A8Dp ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_407AD2
		mov	eax, [ebp+var_C]
		mov	edx, [eax+24h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+28h+var_28], eax
		call	edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_407261

loc_407AD2:				; CODE XREF: sub_407AA4+10j
		mov	eax, 0
		leave
		retn
sub_407AA4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407AD9	proc near		; CODE XREF: sub_409D18+55p
					; .text:0040B78Fp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 8 ; size_t
		call	sub_407217
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_407AFD
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_407B3C
; ---------------------------------------------------------------------------

loc_407AFD:				; CODE XREF: sub_407AD9+19j
		mov	eax, [ebp+arg_8]
		and	eax, 8000h
		test	eax, eax
		jz	short loc_407B1C
		mov	[esp+28h+var_24], 8000h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	_setmode

loc_407B1C:				; CODE XREF: sub_407AD9+2Ej
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_407B3C:				; CODE XREF: sub_407AD9+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_407AD9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407B41	proc near		; DATA XREF: .data:off_41609Co

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_407B60
		mov	[ebp+var_C], 0
		jmp	short loc_407B92
; ---------------------------------------------------------------------------

loc_407B60:				; CODE XREF: sub_407B41+14j
					; sub_407B41+4Fj
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	_read
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_407B92
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_407B60

loc_407B92:				; CODE XREF: sub_407B41+1Dj
					; sub_407B41+41j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_407B41	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407B97	proc near		; DATA XREF: .data:off_4160A0o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_407BB5
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		jmp	short loc_407BE7
; ---------------------------------------------------------------------------

loc_407BB5:				; CODE XREF: sub_407B97+14j
					; sub_407B97+4Ej
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	_write
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_407BE7
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_407BB5

loc_407BE7:				; CODE XREF: sub_407B97+1Cj
					; sub_407B97+40j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_407B97	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407BEC	proc near		; DATA XREF: .data:off_4160A4o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_407C19
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 1Dh
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_407C75
; ---------------------------------------------------------------------------

loc_407C19:				; CODE XREF: sub_407BEC+15j
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	ecx, [ecx]
		mov	ebx, [ebp+arg_8]
		mov	[esp+28h+var_1C], ebx
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_28], ecx
		call	j__lseeki64
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_14]
		mov	edx, eax
		xor	edx, 0FFFFFFFFh
		mov	eax, [ebp+var_18]
		xor	eax, 0FFFFFFFFh
		or	eax, edx
		test	eax, eax
		jnz	short loc_407C60
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_407C75
; ---------------------------------------------------------------------------

loc_407C60:				; CODE XREF: sub_407BEC+69j
		mov	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	[ebp+var_C], 0

loc_407C75:				; CODE XREF: sub_407BEC+2Bj
					; sub_407BEC+72j
		mov	eax, [ebp+var_C]
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_407BEC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407C7E	proc near		; CODE XREF: .text:0040997Ep
					; sub_409D18+DAp ...

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_407CD1
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_407CA3
		mov	[ebp+var_C], 0
		jmp	short loc_407CC4
; ---------------------------------------------------------------------------

loc_407CA3:				; CODE XREF: sub_407C7E+1Aj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_407CBC
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		call	_close
		jmp	short loc_407CC1
; ---------------------------------------------------------------------------

loc_407CBC:				; CODE XREF: sub_407C7E+2Dj
		mov	eax, 0

loc_407CC1:				; CODE XREF: sub_407C7E+3Cj
		mov	[ebp+var_C], eax

loc_407CC4:				; CODE XREF: sub_407C7E+23j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_407261
		jmp	short loc_407CD8
; ---------------------------------------------------------------------------

loc_407CD1:				; CODE XREF: sub_407C7E+10j
		mov	[ebp+var_C], 0

loc_407CD8:				; CODE XREF: sub_407C7E+51j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_407C7E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407CDD(int, FILE *, int, int)
sub_407CDD	proc near		; CODE XREF: sub_409E4D+67p

File		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+File],	8 ; size_t
		call	sub_407217
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_407D01
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_407D48
; ---------------------------------------------------------------------------

loc_407D01:				; CODE XREF: sub_407CDD+19j
		mov	eax, [ebp+arg_8]
		and	eax, 8000h
		test	eax, eax
		jz	short loc_407D28
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+File],	eax ; File
		call	_fileno
		mov	[esp+28h+var_24], 8000h
		mov	[esp+28h+File],	eax
		call	_setmode

loc_407D28:				; CODE XREF: sub_407CDD+2Ej
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_407D48:				; CODE XREF: sub_407CDD+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_407CDD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407D4D(int, void *, size_t)
sub_407D4D	proc near		; DATA XREF: .data:off_4160ACo

DstBuf		= dword	ptr -28h
ElementSize	= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_407D8A
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Count], eax ; Count
		mov	[esp+28h+ElementSize], 1 ; ElementSize
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+DstBuf], eax ;	DstBuf
		call	fread
		mov	[ebp+var_C], eax
		jmp	short loc_407D91
; ---------------------------------------------------------------------------

loc_407D8A:				; CODE XREF: sub_407D4D+13j
		mov	[ebp+var_C], 0

loc_407D91:				; CODE XREF: sub_407D4D+3Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_407DAF
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+DstBuf], eax ;	File
		call	ferror
		test	eax, eax
		jz	short loc_407DAF
		mov	eax, 0FFFFFFFFh
		jmp	short locret_407DB2
; ---------------------------------------------------------------------------

loc_407DAF:				; CODE XREF: sub_407D4D+48j
					; sub_407D4D+59j
		mov	eax, [ebp+var_C]

locret_407DB2:				; CODE XREF: sub_407D4D+60j
		leave
		retn
sub_407D4D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407DB4(int, void *, size_t)
sub_407DB4	proc near		; DATA XREF: .data:off_4160B0o

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_407DF1
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Count], eax ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		mov	[ebp+var_C], eax
		jmp	short loc_407DF7
; ---------------------------------------------------------------------------

loc_407DF1:				; CODE XREF: sub_407DB4+13j
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax

loc_407DF7:				; CODE XREF: sub_407DB4+3Bj
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jz	short loc_407E06
		mov	eax, 0FFFFFFFFh
		jmp	short locret_407E09
; ---------------------------------------------------------------------------

loc_407E06:				; CODE XREF: sub_407DB4+49j
		mov	eax, [ebp+var_C]

locret_407E09:				; CODE XREF: sub_407DB4+50j
		leave
		retn
sub_407DB4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407E0B	proc near		; DATA XREF: .data:off_4160B4o

File		= dword	ptr -28h
Offset		= dword	ptr -24h
Origin		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_407E34
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 1Dh
		mov	eax, 0FFFFFFFFh
		jmp	short locret_407E93
; ---------------------------------------------------------------------------

loc_407E34:				; CODE XREF: sub_407E0B+13j
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Origin], ecx ;	Origin
		mov	[esp+28h+Offset], edx ;	Offset
		mov	[esp+28h+File],	eax ; File
		call	fseek
		test	eax, eax
		jz	short loc_407E61
		mov	eax, 0FFFFFFFFh
		jmp	short locret_407E93
; ---------------------------------------------------------------------------

loc_407E61:				; CODE XREF: sub_407E0B+4Dj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		call	ftell
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_407E7E
		mov	eax, 0FFFFFFFFh
		jmp	short locret_407E93
; ---------------------------------------------------------------------------

loc_407E7E:				; CODE XREF: sub_407E0B+6Aj
		mov	eax, [ebp+var_10]
		mov	edx, eax
		sar	edx, 1Fh
		mov	ecx, [ebp+arg_4]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	eax, 0

locret_407E93:				; CODE XREF: sub_407E0B+27j
					; sub_407E0B+54j ...
		leave
		retn
sub_407E0B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407E95	proc near		; CODE XREF: sub_409E4D+101p
					; DATA XREF: .data:off_4160B8o

File		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_407EF4
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_407EE0
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		call	fflush
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_407ED6
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		call	fclose
		jmp	short loc_407EDB
; ---------------------------------------------------------------------------

loc_407ED6:				; CODE XREF: sub_407E95+30j
		mov	eax, 0

loc_407EDB:				; CODE XREF: sub_407E95+3Fj
		mov	[ebp+var_C], eax
		jmp	short loc_407EE7
; ---------------------------------------------------------------------------

loc_407EE0:				; CODE XREF: sub_407E95+19j
		mov	[ebp+var_C], 0

loc_407EE7:				; CODE XREF: sub_407E95+49j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+File],	eax ; void *
		call	sub_407261
		jmp	short loc_407EFB
; ---------------------------------------------------------------------------

loc_407EF4:				; CODE XREF: sub_407E95+10j
		mov	[ebp+var_C], 0

loc_407EFB:				; CODE XREF: sub_407E95+5Dj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_407E95	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407F00	proc near		; CODE XREF: .text:004098C4p
					; .text:0040A37Dp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0FFFFFFFFh
		mov	[esp+28h+var_28], 8 ; size_t
		call	sub_407217
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_407F32
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_407F9F
; ---------------------------------------------------------------------------

loc_407F32:				; CODE XREF: sub_407F00+27j
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_20], 180h
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_28], eax
		call	_open
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_407F5E
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_407F9F
; ---------------------------------------------------------------------------

loc_407F5E:				; CODE XREF: sub_407F00+53j
		mov	eax, [ebp+arg_C]
		and	eax, 8000h
		test	eax, eax
		jz	short loc_407F7D
		mov	[esp+28h+var_24], 8000h
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	_setmode

loc_407F7D:				; CODE XREF: sub_407F00+68j
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_407F9F:				; CODE XREF: sub_407F00+30j
					; sub_407F00+5Cj
		cmp	[ebp+var_C], 0
		jz	short loc_407FB0
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_407261

loc_407FB0:				; CODE XREF: sub_407F00+A3j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_407F00	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407FB5	proc near		; CODE XREF: .text:00409897p
					; .text:004099ADp ...

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	eax, 72h
		jz	short loc_407FD5
		cmp	eax, 77h
		jz	short loc_407FE5
		cmp	eax, 61h
		jz	short loc_407FF5
		jmp	short loc_408005
; ---------------------------------------------------------------------------

loc_407FD5:				; CODE XREF: sub_407FB5+12j
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	short loc_408019
; ---------------------------------------------------------------------------

loc_407FE5:				; CODE XREF: sub_407FB5+17j
		mov	[ebp+var_C], 1
		mov	[ebp+var_10], 300h
		jmp	short loc_408019
; ---------------------------------------------------------------------------

loc_407FF5:				; CODE XREF: sub_407FB5+1Cj
		mov	[ebp+var_C], 1
		mov	[ebp+var_10], 108h
		jmp	short loc_408019
; ---------------------------------------------------------------------------

loc_408005:				; CODE XREF: sub_407FB5+1Ej
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_408073
; ---------------------------------------------------------------------------

loc_408019:				; CODE XREF: sub_407FB5+2Ej
					; sub_407FB5+3Ej ...
		add	[ebp+arg_0], 1
		jmp	short loc_408057
; ---------------------------------------------------------------------------

loc_40801F:				; CODE XREF: sub_407FB5+AAj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	eax, 62h
		jz	short loc_408040
		cmp	eax, 78h
		jz	short loc_408049
		cmp	eax, 2Bh
		jnz	short loc_408052
		mov	[ebp+var_C], 2
		jmp	short loc_408053
; ---------------------------------------------------------------------------

loc_408040:				; CODE XREF: sub_407FB5+76j
		or	[ebp+var_10], 8000h
		jmp	short loc_408053
; ---------------------------------------------------------------------------

loc_408049:				; CODE XREF: sub_407FB5+7Bj
		or	[ebp+var_10], 400h
		jmp	short loc_408053
; ---------------------------------------------------------------------------

loc_408052:				; CODE XREF: sub_407FB5+80j
		nop

loc_408053:				; CODE XREF: sub_407FB5+89j
					; sub_407FB5+92j ...
		add	[ebp+arg_0], 1

loc_408057:				; CODE XREF: sub_407FB5+68j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40801F
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, 0

locret_408073:				; CODE XREF: sub_407FB5+62j
		leave
		retn
sub_407FB5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408075	proc near		; CODE XREF: sub_408890+2Fp
					; sub_4090C8+4Bp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+230h]
		test	eax, eax
		jnz	short loc_4080AA
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 28h
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_408106
; ---------------------------------------------------------------------------

loc_4080AA:				; CODE XREF: sub_408075+1Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+230h]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_4080F9
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_408106
; ---------------------------------------------------------------------------

loc_4080F9:				; CODE XREF: sub_408075+72j
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0

loc_408106:				; CODE XREF: sub_408075+33j
					; sub_408075+82j
		cmp	[ebp+var_10], 0
		jz	short loc_408124
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl
		jmp	short loc_408140
; ---------------------------------------------------------------------------

loc_408124:				; CODE XREF: sub_408075+95j
		cmp	[ebp+var_C], 0
		jnz	short loc_408140
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 2
		mov	[eax+24Ch], dl

loc_408140:				; CODE XREF: sub_408075+ADj
					; sub_408075+B3j
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_10]
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_408075	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408190	proc near		; CODE XREF: sub_408554+7Cp
					; sub_4089A7+35p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 30h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+234h]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_4081D1
		mov	[esp+38h+var_30], 4F3h ; int
		mov	[esp+38h+var_34], offset a____Gnupg22__2 ; "../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+38h+var_38], offset aStreamFlags_wr ; "stream->flags.writing"
		call	sub_415230

loc_4081D1:				; CODE XREF: sub_408190+23j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_4082FC
		cmp	[ebp+var_18], 0
		jnz	short loc_4081F1
		mov	[ebp+var_C], 28h
		jmp	loc_408303
; ---------------------------------------------------------------------------

loc_4081F1:				; CODE XREF: sub_408190+53j
		mov	[ebp+var_14], 0
		mov	[ebp+var_C], 0
		jmp	short loc_40825D
; ---------------------------------------------------------------------------

loc_408201:				; CODE XREF: sub_408190+DEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	ecx, eax
		sub	ecx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+38h+var_30], ecx
		mov	[esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+var_18]
		call	eax
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jnz	short loc_40824B
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_408251
; ---------------------------------------------------------------------------

loc_40824B:				; CODE XREF: sub_408190+A9j
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_10], eax

loc_408251:				; CODE XREF: sub_408190+B9j
		mov	eax, [ebp+var_10]
		add	[ebp+var_14], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_408272

loc_40825D:				; CODE XREF: sub_408190+6Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		sub	eax, [ebp+var_14]
		test	eax, eax
		jle	short loc_408273
		cmp	[ebp+var_C], 0
		jz	short loc_408201
		jmp	short loc_408273
; ---------------------------------------------------------------------------

loc_408272:				; CODE XREF: sub_408190+CBj
		nop

loc_408273:				; CODE XREF: sub_408190+D8j
					; sub_408190+E0j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_14]
		jnz	short loc_408303
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+var_18]
		call	eax
		jmp	short loc_408303
; ---------------------------------------------------------------------------

loc_4082FC:				; CODE XREF: sub_408190+49j
		mov	[ebp+var_C], 0

loc_408303:				; CODE XREF: sub_408190+5Cj
					; sub_408190+FDj ...
		cmp	[ebp+var_C], 0
		jz	short loc_40831F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl

loc_40831F:				; CODE XREF: sub_408190+177j
		mov	eax, [ebp+var_C]
		add	esp, 30h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_408190	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408329	proc near		; CODE XREF: sub_408B9A+116p
					; sub_409680+33p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_408359
		mov	[esp+18h+var_10], 536h ; int
		mov	[esp+18h+var_14], offset a____Gnupg22__2 ; "../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+18h+var_18], offset aStreamFlags__0 ; "!stream->flags.writing"
		call	sub_415230

loc_408359:				; CODE XREF: sub_408329+12j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		leave
		retn
sub_408329	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408379	proc near		; CODE XREF: sub_408658+D5p
					; .text:0040A3D5p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_4]
		mov	[eax+214h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+218h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+228h], 0
		mov	dword ptr [eax+22Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_C]
		mov	[eax+230h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_10]
		mov	[eax+234h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_14]
		mov	[eax+238h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+23Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_18]
		mov	[eax+240h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+244h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_8]
		mov	[eax+248h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFEFh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+254h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+258h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+25Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFEh
		mov	[eax+24Ch], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+24Ch], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFFDh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFF3h
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFFEh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+220h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFDFh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+arg_1C]
		and	eax, 1
		test	al, al
		jnz	short loc_408536
		mov	eax, [ebp+arg_1C]
		and	eax, 2
		test	eax, eax
		jz	short loc_408545

loc_408536:				; CODE XREF: sub_408379+1B1j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		or	edx, 1
		mov	[eax+20h], dl
		jmp	short loc_408552
; ---------------------------------------------------------------------------

loc_408545:				; CODE XREF: sub_408379+1BBj
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_408552:				; CODE XREF: sub_408379+1CAj
		pop	ebp
		retn
sub_408379	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408554	proc near		; CODE XREF: sub_408658+112p
					; sub_40877F+2Bp ...

File		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+25Ch]
		test	eax, eax
		jz	short loc_4085A6
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+25Ch]
		mov	[esp+28h+File],	eax ; File
		call	fclose
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+25Ch], 0
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_4085A6:				; CODE XREF: sub_408554+14j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+240h]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4085EA
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax
		call	sub_408190
		mov	[ebp+var_18], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4085EA
		cmp	[ebp+var_18], 0
		jz	short loc_4085EA
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_4085EA:				; CODE XREF: sub_408554+74j
					; sub_408554+88j ...
		cmp	[ebp+var_14], 0
		jz	short loc_408619
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+File],	eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_408619
		cmp	[ebp+var_18], 0
		jz	short loc_408619
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_408619:				; CODE XREF: sub_408554+9Aj
					; sub_408554+B7j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	[esp+28h+File],	eax ; void *
		call	sub_407261
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+220h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFDFh
		mov	[eax+250h], dl
		mov	eax, [ebp+var_C]
		leave
		retn
sub_408554	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408658	proc near		; CODE XREF: sub_4091B2+C8p
					; .text:00409928p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[esp+38h+var_38], 28h ;	size_t
		call	sub_407217
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40868D
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_408758
; ---------------------------------------------------------------------------

loc_40868D:				; CODE XREF: sub_408658+27j
		mov	[esp+38h+var_38], 260h ; size_t
		call	sub_407217
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4086AE
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_408758
; ---------------------------------------------------------------------------

loc_4086AE:				; CODE XREF: sub_408658+48j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+4], 200h
		mov	eax, [ebp+var_14]
		lea	edx, [eax+200h]
		mov	eax, [ebp+var_10]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+18h], 10h
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		mov	[eax+24h], edx
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+38h+var_38], eax
		call	sub_407208
		mov	eax, [ebp+arg_1C]
		mov	[esp+38h+var_1C], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+var_24], eax
		mov	eax, [ebp+arg_18]
		mov	[esp+38h+var_20], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_408379
		mov	eax, [ebp+arg_20]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_40727A
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_408757
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_408758
; ---------------------------------------------------------------------------

loc_408757:				; CODE XREF: sub_408658+F3j
		nop

loc_408758:				; CODE XREF: sub_408658+30j
					; sub_408658+51j ...
		cmp	[ebp+var_C], 0
		jz	short loc_40877A
		cmp	[ebp+var_10], 0
		jz	short loc_40877A
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_408554
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax ;	void *
		call	sub_407261

loc_40877A:				; CODE XREF: sub_408658+104j
					; sub_408658+10Aj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_408658	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40877F(void *, int)
sub_40877F	proc near		; CODE XREF: sub_4091B2+32Bp
					; .text:0040A405p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_0], 0
		jz	short loc_4087CB
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40730D
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_408554
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_407261
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_407261

loc_4087CB:				; CODE XREF: sub_40877F+11j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40877F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4087D0	proc near		; CODE XREF: sub_4089A7+DFp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+230h]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	short loc_408843
; ---------------------------------------------------------------------------

loc_4087F7:				; CODE XREF: sub_4087D0+79j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_408837
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_40884E
; ---------------------------------------------------------------------------

loc_408837:				; CODE XREF: sub_4087D0+5Cj
		cmp	[ebp+var_18], 0
		jz	short loc_40884D
		mov	eax, [ebp+var_18]
		add	[ebp+var_C], eax

loc_408843:				; CODE XREF: sub_4087D0+25j
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jnz	short loc_4087F7
		jmp	short loc_40884E
; ---------------------------------------------------------------------------

loc_40884D:				; CODE XREF: sub_4087D0+6Bj
		nop

loc_40884E:				; CODE XREF: sub_4087D0+65j
					; sub_4087D0+7Bj
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+var_C]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_4087D0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408890	proc near		; CODE XREF: sub_408979+21p
					; sub_4089A7+141p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		jmp	loc_408957
; ---------------------------------------------------------------------------

loc_4088A9:				; CODE XREF: sub_408890+D3j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_4088DB
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_408075
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4088DB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	loc_40896B

loc_4088DB:				; CODE XREF: sub_408890+27j
					; sub_408890+3Bj
		cmp	[ebp+var_14], 0
		jnz	short loc_408957
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+var_18]
		jbe	short loc_408913
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_408913:				; CODE XREF: sub_408890+7Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		add	eax, edx
		mov	edx, ecx
		mov	ecx, [ebp+var_C]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_C]
		add	[ebp+var_10], eax

loc_408957:				; CODE XREF: sub_408890+14j
					; sub_408890+4Fj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_10]
		jz	short loc_40896C
		cmp	[ebp+var_14], 0
		jz	loc_4088A9
		jmp	short loc_40896C
; ---------------------------------------------------------------------------

loc_40896B:				; CODE XREF: sub_408890+45j
		nop

loc_40896C:				; CODE XREF: sub_408890+CDj
					; sub_408890+D9j
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		leave
		retn
sub_408890	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408979	proc near		; CODE XREF: sub_4089A7+110p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_408890
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_408979	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4089A7	proc near		; CODE XREF: sub_40A9E7+22p
					; sub_40ABF1+3Bp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_408A2E
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_408190
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_408AF2
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl
		jmp	short loc_408A2E
; ---------------------------------------------------------------------------

loc_4089FD:				; CODE XREF: sub_4089A7+97j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+14h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		sub	eax, 1
		add	eax, ecx
		movzx	eax, byte ptr [eax]
		mov	[edx], al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_0]
		mov	[eax+1Ch], edx
		add	[ebp+var_C], 1

loc_408A2E:				; CODE XREF: sub_4089A7+2Dj
					; sub_4089A7+54j
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jz	short loc_408A40
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_4089FD

loc_408A40:				; CODE XREF: sub_4089A7+8Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+244h]
		cmp	eax, 4
		jz	short loc_408A5F
		cmp	eax, 40h
		jz	short loc_408A90
		test	eax, eax
		jz	short loc_408AC1
		jmp	loc_408AF3
; ---------------------------------------------------------------------------

loc_408A5F:				; CODE XREF: sub_4089A7+A8j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4087D0
		mov	[ebp+var_10], eax
		jmp	short loc_408AF3
; ---------------------------------------------------------------------------

loc_408A90:				; CODE XREF: sub_4089A7+ADj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_408979
		mov	[ebp+var_10], eax
		jmp	short loc_408AF3
; ---------------------------------------------------------------------------

loc_408AC1:				; CODE XREF: sub_4089A7+B1j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_408890
		mov	[ebp+var_10], eax
		jmp	short loc_408AF3
; ---------------------------------------------------------------------------

loc_408AF2:				; CODE XREF: sub_4089A7+41j
		nop

loc_408AF3:				; CODE XREF: sub_4089A7+B3j
					; sub_4089A7+E7j ...
		cmp	[ebp+arg_C], 0
		jz	short loc_408B06
		mov	eax, [ebp+var_18]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_408B06:				; CODE XREF: sub_4089A7+150j
		mov	eax, [ebp+var_10]
		leave
		retn
sub_4089A7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408B0B(int, void *, size_t, int)
sub_408B0B	proc near		; CODE XREF: .text:0040ABC5p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jbe	short loc_408B34
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_8], eax

loc_408B34:				; CODE XREF: sub_408B0B+21j
		cmp	[ebp+arg_8], 0
		jz	short loc_408B89
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		add	eax, edx
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_0]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+24Ch], dl
		jmp	short loc_408B8A
; ---------------------------------------------------------------------------

loc_408B89:				; CODE XREF: sub_408B0B+2Dj
		nop

loc_408B8A:				; CODE XREF: sub_408B0B+7Cj
		cmp	[ebp+arg_C], 0
		jz	short locret_408B98
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+arg_8]
		mov	[eax], edx

locret_408B98:				; CODE XREF: sub_408B0B+83j
		leave
		retn
sub_408B0B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408B9A	proc near		; CODE XREF: sub_408F88+58p
					; sub_4091B2+270p ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_40], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+238h]
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_408BDD
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 28h
		mov	[ebp+var_1C], 0FFFFFFFFh
		jmp	loc_408CFA
; ---------------------------------------------------------------------------

loc_408BDD:				; CODE XREF: sub_408B9A+28j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_408C10
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_408190
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_408CF9
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_408C10:				; CODE XREF: sub_408B9A+4Fj
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[ebp+var_30], eax
		mov	[ebp+var_2C], edx
		cmp	[ebp+arg_C], 1
		jnz	short loc_408C6F
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+8]
		mov	ebx, 0
		mov	esi, eax
		mov	edi, edx
		sub	esi, ecx
		sbb	edi, ebx
		mov	ecx, esi
		mov	ebx, edi
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[ebp+var_30], eax
		mov	[ebp+var_2C], edx
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+1Ch]
		mov	ebx, 0
		sub	eax, ecx
		sbb	edx, ebx
		mov	[ebp+var_30], eax
		mov	[ebp+var_2C], edx

loc_408C6F:				; CODE XREF: sub_408B9A+86j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	edx, [ebp+arg_C]
		mov	[esp+58h+var_50], edx
		lea	edx, [ebp+var_30]
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+var_20]
		call	eax
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0FFFFFFFFh
		jnz	short loc_408CA3
		mov	[ebp+var_1C], 0FFFFFFFFh
		jmp	short loc_408CFA
; ---------------------------------------------------------------------------

loc_408CA3:				; CODE XREF: sub_408B9A+FEj
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_408329
		cmp	[ebp+arg_10], 0
		jz	short loc_408CC9
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	ecx, [ebp+arg_10]
		mov	[ecx], eax
		mov	[ecx+4], edx

loc_408CC9:				; CODE XREF: sub_408B9A+11Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+24Ch], dl
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+24h]
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	[ecx+228h], eax
		mov	[ecx+22Ch], edx
		jmp	short loc_408CFA
; ---------------------------------------------------------------------------

loc_408CF9:				; CODE XREF: sub_408B9A+63j
		nop

loc_408CFA:				; CODE XREF: sub_408B9A+3Ej
					; sub_408B9A+107j ...
		cmp	[ebp+var_1C], 0
		jz	short loc_408D16
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl

loc_408D16:				; CODE XREF: sub_408B9A+164j
		mov	eax, [ebp+var_1C]
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_408B9A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408D21	proc near		; CODE XREF: sub_408EC2+79p
					; sub_408F88+B6p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+234h]
		mov	[ebp+var_14], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_408D50
		cmp	[ebp+var_14], 0
		jnz	short loc_408D50
		mov	[ebp+var_10], 28h
		jmp	loc_408DE6
; ---------------------------------------------------------------------------

loc_408D50:				; CODE XREF: sub_408D21+1Bj
					; sub_408D21+21j
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	short loc_408DA6
; ---------------------------------------------------------------------------

loc_408D60:				; CODE XREF: sub_408D21+8Bj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_408DA0
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_408DAE
; ---------------------------------------------------------------------------

loc_408DA0:				; CODE XREF: sub_408D21+74j
		mov	eax, [ebp+var_18]
		add	[ebp+var_C], eax

loc_408DA6:				; CODE XREF: sub_408D21+3Dj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jnz	short loc_408D60

loc_408DAE:				; CODE XREF: sub_408D21+7Dj
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+var_C]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_C]
		mov	[eax], edx

loc_408DE6:				; CODE XREF: sub_408D21+2Aj
		mov	eax, [ebp+var_10]
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_408D21	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408DF0	proc near		; CODE XREF: sub_408EC2+ACp
					; sub_408F88+100p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		jmp	loc_408EA3
; ---------------------------------------------------------------------------

loc_408E09:				; CODE XREF: sub_408DF0+BFj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnz	short loc_408E27
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_408190
		mov	[ebp+var_14], eax

loc_408E27:				; CODE XREF: sub_408DF0+27j
		cmp	[ebp+var_14], 0
		jnz	short loc_408EA3
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+var_18]
		jbe	short loc_408E5F
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_408E5F:				; CODE XREF: sub_408DF0+67j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		lea	ecx, [edx+eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	eax, edx
		mov	edx, ecx
		mov	ecx, [ebp+var_C]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_C]
		add	[ebp+var_10], eax

loc_408EA3:				; CODE XREF: sub_408DF0+14j
					; sub_408DF0+3Bj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_10]
		jz	short loc_408EB5
		cmp	[ebp+var_14], 0
		jz	loc_408E09

loc_408EB5:				; CODE XREF: sub_408DF0+B9j
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		leave
		retn
sub_408DF0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408EC2	proc near		; CODE XREF: sub_408F88+DBp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+var_24], 0Ah
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_411FA5
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_408F43
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_408190
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_408F43
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_4]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_408D21
		mov	[ebp+var_C], eax

loc_408F43:				; CODE XREF: sub_408EC2+3Cj
					; sub_408EC2+50j
		cmp	[ebp+var_C], 0
		jnz	short loc_408F76
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_14]
		add	eax, [ebp+arg_4]
		lea	edx, [ebp+var_18]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_408DF0
		mov	[ebp+var_C], eax

loc_408F76:				; CODE XREF: sub_408EC2+85j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		add	edx, eax
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		leave
		retn
sub_408EC2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408F88	proc near		; CODE XREF: sub_40952B+2Ep
					; .text:00409C15p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_409007
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+238h]
		test	eax, eax
		jz	short loc_409007
		mov	[esp+38h+var_28], 0
		mov	[esp+38h+var_2C], 1
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_30], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_408B9A
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_409007
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 1Dh
		jnz	loc_409092
		mov	[ebp+var_C], 0

loc_409007:				; CODE XREF: sub_408F88+20j
					; sub_408F88+30j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+244h]
		cmp	eax, 4
		jz	short loc_409023
		cmp	eax, 40h
		jz	short loc_409048
		test	eax, eax
		jz	short loc_40906D
		jmp	short loc_409093
; ---------------------------------------------------------------------------

loc_409023:				; CODE XREF: sub_408F88+8Ej
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_408D21
		mov	[ebp+var_C], eax
		jmp	short loc_409093
; ---------------------------------------------------------------------------

loc_409048:				; CODE XREF: sub_408F88+93j
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_408EC2
		mov	[ebp+var_C], eax
		jmp	short loc_409093
; ---------------------------------------------------------------------------

loc_40906D:				; CODE XREF: sub_408F88+97j
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_408DF0
		mov	[ebp+var_C], eax
		jmp	short loc_409093
; ---------------------------------------------------------------------------

loc_409092:				; CODE XREF: sub_408F88+72j
		nop

loc_409093:				; CODE XREF: sub_408F88+99j
					; sub_408F88+BEj ...
		cmp	[ebp+arg_C], 0
		jz	short loc_4090A1
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_4090A1:				; CODE XREF: sub_408F88+10Fj
		mov	eax, [ebp+var_10]
		test	eax, eax
		jz	short loc_4090C3
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_4090C3
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		or	edx, 1
		mov	[eax+20h], dl

loc_4090C3:				; CODE XREF: sub_408F88+11Ej
					; sub_408F88+12Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_408F88	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4090C8	proc near		; CODE XREF: sub_4091B2+10Ep

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4090FD
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_408190
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40915B
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_4090FD:				; CODE XREF: sub_4090C8+12j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_409121
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_408075
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40915E

loc_409121:				; CODE XREF: sub_4090C8+43j
		cmp	[ebp+arg_4], 0
		jz	short loc_409139
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], edx

loc_409139:				; CODE XREF: sub_4090C8+5Dj
		cmp	[ebp+arg_8], 0
		jz	short loc_409152
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		sub	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_409152:				; CODE XREF: sub_4090C8+75j
		mov	[ebp+var_C], 0
		jmp	short loc_40915F
; ---------------------------------------------------------------------------

loc_40915B:				; CODE XREF: sub_4090C8+26j
		nop
		jmp	short loc_40915F
; ---------------------------------------------------------------------------

loc_40915E:				; CODE XREF: sub_4090C8+57j
		nop

loc_40915F:				; CODE XREF: sub_4090C8+91j
					; sub_4090C8+94j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4090C8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409164	proc near		; CODE XREF: sub_4091B2+1BBp
					; sub_4091B2+207p

var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jbe	short loc_409195
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_4091AD
; ---------------------------------------------------------------------------

loc_409195:				; CODE XREF: sub_409164+19j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	[ebp+var_C], 0

loc_4091AD:				; CODE XREF: sub_409164+2Fj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_409164	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4091B2	proc near		; CODE XREF: .text:0040AFE3p

Buf		= dword	ptr -68h
Val		= dword	ptr -64h
MaxCount	= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	[ebp+var_14], 0
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		lea	eax, [ebp+var_24]
		mov	[esp+68h+var_44], 0
		mov	[esp+68h+var_48], 2
		mov	[esp+68h+var_4C], offset sub_407261
		mov	[esp+68h+var_50], offset sub_407234
		mov	[esp+68h+var_54], 1
		mov	[esp+68h+var_58], 200h
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+MaxCount], 0
		mov	[esp+68h+Val], 0
		mov	[esp+68h+Buf], eax
		call	sub_407431
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_4094BB
		mov	eax, [ebp+var_24]
		mov	[esp+68h+var_48], 0
		mov	[esp+68h+var_4C], 2
		mov	edx, off_41608C
		mov	[esp+68h+var_5C], edx
		mov	edx, off_416090
		mov	[esp+68h+var_58], edx
		mov	edx, off_416094
		mov	[esp+68h+var_54], edx
		mov	edx, off_416098
		mov	[esp+68h+var_50], edx
		mov	[esp+68h+MaxCount], 0FFFFFFFFh
		mov	[esp+68h+Val], eax
		lea	eax, [ebp+var_20]
		mov	[esp+68h+Buf], eax
		call	sub_408658
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_4094BE
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	short loc_40929C
; ---------------------------------------------------------------------------

loc_40929B:				; CODE XREF: sub_4091B2+210j
		nop

loc_40929C:				; CODE XREF: sub_4091B2+E7j
		cmp	[ebp+arg_4], 0
		jz	short loc_4092AC
		cmp	[ebp+var_C], 1
		jz	loc_4093CA

loc_4092AC:				; CODE XREF: sub_4091B2+EEj
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+MaxCount], eax
		lea	eax, [ebp+var_28]
		mov	[esp+68h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Buf], eax
		call	sub_4090C8
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_4093CB
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jz	loc_4093CB
		mov	eax, [ebp+var_C]
		lea	edx, [eax-1]
		mov	eax, [ebp+var_2C]
		cmp	edx, eax
		jnb	short loc_4092F3
		mov	eax, [ebp+var_C]
		sub	eax, 1
		mov	[ebp+var_2C], eax

loc_4092F3:				; CODE XREF: sub_4091B2+136j
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	[esp+68h+MaxCount], edx	; MaxCount
		mov	[esp+68h+Val], 0Ah ; Val
		mov	[esp+68h+Buf], eax ; Buf
		call	memchr
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_409374
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_28]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+MaxCount], ecx
		mov	[esp+68h+Val], edx
		mov	[esp+68h+Buf], eax
		call	sub_40AC56
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_4093BE
		mov	eax, [ebp+var_2C]
		sub	[ebp+var_C], eax
		mov	eax, [ebp+var_2C]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Buf], eax
		call	sub_409164
		jmp	short loc_4093CB
; ---------------------------------------------------------------------------

loc_409374:				; CODE XREF: sub_4091B2+162j
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+MaxCount], ecx
		mov	[esp+68h+Val], edx
		mov	[esp+68h+Buf], eax
		call	sub_40AC56
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_4093BE
		mov	eax, [ebp+var_2C]
		sub	[ebp+var_C], eax
		mov	eax, [ebp+var_2C]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Buf], eax
		call	sub_409164

loc_4093BE:				; CODE XREF: sub_4091B2+1A0j
					; sub_4091B2+1ECj
		cmp	[ebp+var_18], 0
		jz	loc_40929B
		jmp	short loc_4093CB
; ---------------------------------------------------------------------------

loc_4093CA:				; CODE XREF: sub_4091B2+F4j
		nop

loc_4093CB:				; CODE XREF: sub_4091B2+11Aj
					; sub_4091B2+125j ...
		cmp	[ebp+var_18], 0
		jnz	loc_4094C1
		cmp	[ebp+arg_4], 1
		jbe	short loc_4093FC
		cmp	[ebp+var_10], 0
		jnz	short loc_4093FC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 2
		mov	[eax+24Ch], dl
		jmp	loc_4094C8
; ---------------------------------------------------------------------------

loc_4093FC:				; CODE XREF: sub_4091B2+227j
					; sub_4091B2+22Dj
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_58], 0
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+Val], 0
		mov	[esp+68h+MaxCount], 0
		mov	[esp+68h+Buf], eax
		call	sub_408B9A
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_4094C4
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40945D
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[esp+68h+Buf], eax ; size_t
		call	sub_407217
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_409465
		mov	[ebp+var_18], 0FFFFFFFFh
		jmp	short loc_4094C8
; ---------------------------------------------------------------------------

loc_40945D:				; CODE XREF: sub_4091B2+289j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_409465:				; CODE XREF: sub_4091B2+2A0j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_5C], 0
		mov	ecx, [ebp+var_10]
		mov	[esp+68h+MaxCount], ecx
		mov	[esp+68h+Val], edx
		mov	[esp+68h+Buf], eax
		call	sub_40ABF1
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_4094C7
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		add	eax, edx
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4094AB
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_4094AB:				; CODE XREF: sub_4091B2+2EFj
		cmp	[ebp+arg_C], 0
		jz	short loc_4094C8
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_4094C8
; ---------------------------------------------------------------------------

loc_4094BB:				; CODE XREF: sub_4091B2+75j
		nop
		jmp	short loc_4094C8
; ---------------------------------------------------------------------------

loc_4094BE:				; CODE XREF: sub_4091B2+D4j
		nop
		jmp	short loc_4094C8
; ---------------------------------------------------------------------------

loc_4094C1:				; CODE XREF: sub_4091B2+21Dj
		nop
		jmp	short loc_4094C8
; ---------------------------------------------------------------------------

loc_4094C4:				; CODE XREF: sub_4091B2+27Cj
		nop
		jmp	short loc_4094C8
; ---------------------------------------------------------------------------

loc_4094C7:				; CODE XREF: sub_4091B2+2DBj
		nop

loc_4094C8:				; CODE XREF: sub_4091B2+245j
					; sub_4091B2+2A9j ...
		mov	eax, [ebp+var_20]
		test	eax, eax
		jz	short loc_4094E4
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Val], 0 ; int
		mov	[esp+68h+Buf], eax ; void *
		call	sub_40877F
		jmp	short loc_4094F6
; ---------------------------------------------------------------------------

loc_4094E4:				; CODE XREF: sub_4091B2+31Bj
		mov	eax, [ebp+var_24]
		test	eax, eax
		jz	short loc_4094F6
		mov	eax, [ebp+var_24]
		mov	[esp+68h+Buf], eax
		call	sub_407AA4

loc_4094F6:				; CODE XREF: sub_4091B2+330j
					; sub_4091B2+337j
		cmp	[ebp+var_18], 0
		jz	short loc_409526
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_409510
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Buf], eax ; void *
		call	sub_407261

loc_409510:				; CODE XREF: sub_4091B2+351j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl

loc_409526:				; CODE XREF: sub_4091B2+348j
		mov	eax, [ebp+var_18]
		leave
		retn
sub_4091B2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40952B	proc near		; DATA XREF: sub_409583+2Bo

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_4]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_408F88
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_C]
		mov	edx, [edx+24h]
		mov	ecx, [edx+258h]
		mov	edx, [ebp+var_14]
		add	edx, ecx
		mov	[eax+258h], edx
		mov	eax, [ebp+var_10]
		leave
		retn
sub_40952B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409583	proc near		; CODE XREF: .text:0040B3B7p
					; .text:0040B3ECp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+258h], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], offset sub_40952B
		call	sub_40564B
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4095CA
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4095D6
; ---------------------------------------------------------------------------

loc_4095CA:				; CODE XREF: sub_409583+3Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+258h]

locret_4095D6:				; CODE XREF: sub_409583+45j
		leave
		retn
sub_409583	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4095D8	proc near		; CODE XREF: sub_409680+4Ep
					; .text:00409C8Bp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jz	short loc_409605
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		cmp	[ebp+arg_4], 0
		setnz	dl
		mov	ecx, edx
		and	ecx, 1
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFEh
		or	edx, ecx
		mov	[eax+24Ch], dl

loc_409605:				; CODE XREF: sub_4095D8+7j
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jz	short loc_409630
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		cmp	[ebp+arg_8], 0
		setnz	dl
		and	edx, 1
		lea	ecx, [edx+edx]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		or	edx, ecx
		mov	[eax+24Ch], dl

loc_409630:				; CODE XREF: sub_4095D8+31j
		pop	ebp
		retn
sub_4095D8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409632	proc near		; CODE XREF: sub_40A649+1Cp
					; sub_40A6AD+1Cp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_40965D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+24Ch]
		and	eax, 1
		movzx	eax, al
		mov	[ebp+var_4], eax
		jmp	short loc_40967B
; ---------------------------------------------------------------------------

loc_40965D:				; CODE XREF: sub_409632+11j
		cmp	[ebp+arg_8], 0
		jz	short loc_40967B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+24Ch]
		shr	al, 1
		and	eax, 1
		movzx	eax, al
		mov	[ebp+var_4], eax

loc_40967B:				; CODE XREF: sub_409632+29j
					; sub_409632+2Fj
		mov	eax, [ebp+var_4]
		leave
		retn
sub_409632	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409680(int, int, int,	size_t)
sub_409680	proc near		; CODE XREF: .text:0040A2BDp
					; .text:0040B889p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4096AD
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_408190
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4096B8
		jmp	loc_4097A0
; ---------------------------------------------------------------------------

loc_4096AD:				; CODE XREF: sub_409680+12j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_408329

loc_4096B8:				; CODE XREF: sub_409680+26j
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4095D8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		and	eax, 1
		test	al, al
		jz	short loc_409713
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFFEh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_407261
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0

loc_409713:				; CODE XREF: sub_409680+65j
		cmp	[ebp+arg_8], 4
		jnz	short loc_409725
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 0
		jmp	short loc_40978A
; ---------------------------------------------------------------------------

loc_409725:				; CODE XREF: sub_409680+97j
		cmp	[ebp+arg_4], 0
		jz	short loc_409733
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		jmp	short loc_40975D
; ---------------------------------------------------------------------------

loc_409733:				; CODE XREF: sub_409680+A9j
		cmp	[ebp+arg_C], 0
		jnz	short loc_409740
		mov	[ebp+arg_C], 200h

loc_409740:				; CODE XREF: sub_409680+B7j
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_28], eax ;	size_t
		call	sub_407217
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40975D
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_4097A0
; ---------------------------------------------------------------------------

loc_40975D:				; CODE XREF: sub_409680+B1j
					; sub_409680+D2j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_C]
		mov	[eax+4], edx
		cmp	[ebp+arg_4], 0
		jnz	short loc_40978A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		or	edx, 1
		mov	[eax+250h], dl

loc_40978A:				; CODE XREF: sub_409680+A3j
					; sub_409680+F2j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_8]
		mov	[eax+244h], edx
		mov	[ebp+var_C], 0

loc_4097A0:				; CODE XREF: sub_409680+28j
					; sub_409680+DBj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_409680	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4097A5	proc near		; CODE XREF: .text:0040A8FBp
					; .text:0040A94Ap

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jl	short loc_4097FD
		cmp	edx, [ebp+var_C]
		jg	short loc_4097ED
		cmp	eax, [ebp+var_10]
		jbe	short loc_4097FD

loc_4097ED:				; CODE XREF: sub_4097A5+41j
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		jmp	short loc_40980E
; ---------------------------------------------------------------------------

loc_4097FD:				; CODE XREF: sub_4097A5+3Cj
					; sub_4097A5+46j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, 0
		sub	[ebp+var_10], eax
		sbb	[ebp+var_C], edx

loc_40980E:				; CODE XREF: sub_4097A5+56j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_4097A5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40981A	proc near		; CODE XREF: .text:0040B94Fp
					; .text:0040B999p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_8], 0
		jz	short loc_409834
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [eax+218h]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_409834:				; CODE XREF: sub_40981A+7j
		cmp	[ebp+arg_4], 0
		jz	short loc_409849
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_4]
		mov	[eax+218h], edx

loc_409849:				; CODE XREF: sub_40981A+1Ej
		pop	ebp
		retn
sub_40981A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40984B	proc near		; CODE XREF: sub_40A5A1+Cp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+248h]
		pop	ebp
		retn
sub_40984B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40985C	proc near		; CODE XREF: sub_40615C+30p

var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_407405
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40985C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-0Ch], 0
		lea	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_407FB5
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_40995F
		mov	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		lea	eax, [ebp-20h]
		mov	[esp+4], eax
		lea	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_407F00
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_409962
		mov	dword ptr [ebp-0Ch], 1
		mov	ecx, [ebp-14h]
		mov	edx, [ebp-20h]
		mov	eax, [ebp-1Ch]
		mov	dword ptr [esp+20h], 0
		mov	[esp+1Ch], ecx
		mov	ecx, off_41609C
		mov	[esp+0Ch], ecx
		mov	ecx, off_4160A0
		mov	[esp+10h], ecx
		mov	ecx, off_4160A4
		mov	[esp+14h], ecx
		mov	ecx, off_4160A8
		mov	[esp+18h], ecx
		mov	[esp+8], edx
		mov	[esp+4], eax
		lea	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_408658
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_409965
		mov	eax, [ebp-18h]
		test	eax, eax
		jz	short loc_409966
		cmp	dword ptr [ebp+8], 0
		jz	short loc_409966
		mov	eax, [ebp-18h]
		mov	dword ptr [esp+8], 1
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_40B9B7
		jmp	short loc_409966
; ---------------------------------------------------------------------------

loc_40995F:				; CODE XREF: .text:004098A3j
		nop
		jmp	short loc_409966
; ---------------------------------------------------------------------------

loc_409962:				; CODE XREF: .text:004098D0j
		nop
		jmp	short loc_409966
; ---------------------------------------------------------------------------

loc_409965:				; CODE XREF: .text:00409934j
		nop

loc_409966:				; CODE XREF: .text:0040993Bj
					; .text:00409941j ...
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_409980
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_409980
		mov	edx, off_4160A8
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	edx ; sub_407C7E

loc_409980:				; CODE XREF: .text:0040996Aj
					; .text:00409970j
		mov	eax, [ebp-18h]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-0Ch], 0
		lea	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp+20h]
		mov	[esp], eax
		call	sub_407FB5
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_409A71
		mov	edx, [ebp-14h]
		lea	eax, [ebp-1Ch]
		mov	dword ptr [esp+24h], 0
		mov	[esp+20h], edx
		mov	edx, [ebp+1Ch]
		mov	[esp+1Ch], edx
		mov	edx, [ebp+18h]
		mov	[esp+18h], edx
		mov	edx, [ebp+14h]
		mov	[esp+14h], edx
		mov	dword ptr [esp+10h], 200h
		mov	edx, [ebp+10h]
		mov	[esp+0Ch], edx
		mov	edx, [ebp+0Ch]
		mov	[esp+8], edx
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_407431
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_409A74
		mov	dword ptr [ebp-0Ch], 1
		mov	edx, [ebp-14h]
		mov	eax, [ebp-1Ch]
		mov	dword ptr [esp+20h], 0
		mov	[esp+1Ch], edx
		mov	edx, off_41608C
		mov	[esp+0Ch], edx
		mov	edx, off_416090
		mov	[esp+10h], edx
		mov	edx, off_416094
		mov	[esp+14h], edx
		mov	edx, off_416098
		mov	[esp+18h], edx
		mov	dword ptr [esp+8], 0FFFFFFFFh
		mov	[esp+4], eax
		lea	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_408658
		mov	[ebp-10h], eax
		jmp	short loc_409A75
; ---------------------------------------------------------------------------

loc_409A71:				; CODE XREF: .text:004099B9j
		nop
		jmp	short loc_409A75
; ---------------------------------------------------------------------------

loc_409A74:				; CODE XREF: .text:00409A12j
		nop

loc_409A75:				; CODE XREF: .text:00409A6Fj
					; .text:00409A72j
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_409A8F
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_409A8F
		mov	edx, off_416098
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	edx ; sub_407AA4

loc_409A8F:				; CODE XREF: .text:00409A79j
					; .text:00409A7Fj
		mov	eax, [ebp-18h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409A94	proc near		; CODE XREF: .text:00409BD3p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		lea	eax, [ebp+var_C]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	sub_407FB5
		test	eax, eax
		jz	short loc_409AC8
		mov	eax, 0
		jmp	locret_409BAA
; ---------------------------------------------------------------------------

loc_409AC8:				; CODE XREF: sub_409A94+28j
		mov	eax, [ebp+var_C]
		or	eax, 2
		mov	[ebp+var_C], eax
		mov	edx, [ebp+var_C]
		lea	eax, [ebp+var_14]
		mov	ecx, [ebp+arg_0]
		mov	[esp+48h+var_24], ecx
		mov	[esp+48h+var_28], edx
		mov	[esp+48h+var_2C], offset sub_407261
		mov	[esp+48h+var_30], offset sub_407234
		mov	[esp+48h+var_34], 1
		mov	[esp+48h+var_38], 200h
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+var_44], 0
		mov	[esp+48h+var_48], eax
		call	sub_407431
		test	eax, eax
		jz	short loc_409B2D
		mov	eax, 0
		jmp	short locret_409BAA
; ---------------------------------------------------------------------------

loc_409B2D:				; CODE XREF: sub_409A94+90j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_28], 0
		mov	[esp+48h+var_2C], edx
		mov	edx, off_41608C
		mov	[esp+48h+var_3C], edx
		mov	edx, off_416090
		mov	[esp+48h+var_38], edx
		mov	edx, off_416094
		mov	[esp+48h+var_34], edx
		mov	edx, off_416098
		mov	[esp+48h+var_30], edx
		mov	[esp+48h+var_40], 0FFFFFFFFh
		mov	[esp+48h+var_44], eax
		lea	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	sub_408658
		test	eax, eax
		jz	short loc_409B90
		mov	edx, off_416098
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	edx ; sub_407AA4

loc_409B90:				; CODE XREF: sub_409A94+ECj
		mov	eax, [ebp+var_10]
		test	eax, eax
		jz	short loc_409BA7
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+23Ch], offset sub_407A3C

loc_409BA7:				; CODE XREF: sub_409A94+101j
		mov	eax, [ebp+var_10]

locret_409BAA:				; CODE XREF: sub_409A94+2Fj
					; sub_409A94+97j
		leave
		retn
sub_409A94	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_409BC6
		mov	eax, [ebp+8]
		cmp	eax, [ebp+14h]
		jnb	short loc_409BC6
		mov	eax, [ebp+14h]
		mov	[ebp+8], eax

loc_409BC6:				; CODE XREF: .text:00409BB6j
					; .text:00409BBEj
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409A94
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	loc_409C90
		cmp	dword ptr [ebp+10h], 0
		jz	loc_409C90
		cmp	dword ptr [ebp+14h], 0
		jz	loc_409C90
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp+14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_408F88
		test	eax, eax
		jz	short loc_409C4A
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_40A486
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	edx, [ebp-10h]
		mov	[eax], edx
		jmp	short loc_409C90
; ---------------------------------------------------------------------------

loc_409C4A:				; CODE XREF: .text:00409C1Cj
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_408B9A
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_4095D8

loc_409C90:				; CODE XREF: .text:00409BDFj
					; .text:00409BE9j ...
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-10h], 0
		lea	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_407FB5
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_409D12
		mov	eax, [ebp-10h]
		mov	dword ptr [esp+20h], 0
		mov	[esp+1Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+14h]
		mov	[esp+10h], eax
		mov	eax, [ebp+18h]
		mov	[esp+14h], eax
		mov	eax, [ebp+1Ch]
		mov	[esp+18h], eax
		mov	dword ptr [esp+8], 0FFFFFFFFh
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_408658
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jmp	short loc_409D13
; ---------------------------------------------------------------------------

loc_409D12:				; CODE XREF: .text:00409CC2j
		nop

loc_409D13:				; CODE XREF: .text:00409D10j
		mov	eax, [ebp-14h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409D18	proc near		; CODE XREF: .text:00409E1Cp
					; .text:00409E46p ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_14]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		call	sub_407FB5
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_409DD6
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_54], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	sub_407AD9
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_409DD9
		mov	[ebp+var_C], 1
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_1C]
		mov	ecx, [ebp+arg_C]
		mov	[esp+58h+var_38], ecx
		mov	[esp+58h+var_3C], edx
		mov	edx, off_41609C
		mov	[esp+58h+var_4C], edx
		mov	edx, off_4160A0
		mov	[esp+58h+var_48], edx
		mov	edx, off_4160A4
		mov	[esp+58h+var_44], edx
		mov	edx, off_4160A8
		mov	[esp+58h+var_40], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+var_54], eax
		lea	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	sub_408658
		mov	[ebp+var_10], eax
		jmp	short loc_409DDA
; ---------------------------------------------------------------------------

loc_409DD6:				; CODE XREF: sub_409D18+34j
		nop
		jmp	short loc_409DDA
; ---------------------------------------------------------------------------

loc_409DD9:				; CODE XREF: sub_409D18+61j
		nop

loc_409DDA:				; CODE XREF: sub_409D18+BCj
					; sub_409D18+BFj
		cmp	[ebp+var_10], 0
		jz	short loc_409DF4
		cmp	[ebp+var_C], 0
		jz	short loc_409DF4
		mov	edx, off_4160A8
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	edx ; sub_407C7E

loc_409DF4:				; CODE XREF: sub_409D18+C6j
					; sub_409D18+CCj
		mov	eax, [ebp+var_18]
		leave
		retn
sub_409D18	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409D18
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409D18
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409E4D(FILE *, int, int, int)
sub_409E4D	proc near		; CODE XREF: .text:00409F7Cp
					; .text:00409FA6p ...

File		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 54h
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_14]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+File],	eax
		call	sub_407FB5
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_409F32
		cmp	[ebp+arg_0], 0
		jz	short loc_409E99
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+File],	eax ; File
		call	fflush

loc_409E99:				; CODE XREF: sub_409E4D+3Fj
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx ;	int
		mov	[esp+58h+var_50], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_54], eax ;	FILE *
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+File],	eax ; int
		call	sub_407CDD
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_409F35
		mov	[ebp+var_C], 1
		mov	ebx, [ebp+var_14]
		cmp	[ebp+arg_0], 0
		jz	short loc_409EDF
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+File],	eax ; File
		call	_fileno
		jmp	short loc_409EE4
; ---------------------------------------------------------------------------

loc_409EDF:				; CODE XREF: sub_409E4D+83j
		mov	eax, 0FFFFFFFFh

loc_409EE4:				; CODE XREF: sub_409E4D+90j
		mov	edx, [ebp+var_1C]
		mov	ecx, [ebp+arg_C]
		mov	[esp+58h+var_38], ecx
		mov	[esp+58h+var_3C], ebx
		mov	ecx, off_4160AC
		mov	[esp+58h+var_4C], ecx
		mov	ecx, off_4160B0
		mov	[esp+58h+var_48], ecx
		mov	ecx, off_4160B4
		mov	[esp+58h+var_44], ecx
		mov	ecx, off_4160B8
		mov	[esp+58h+var_40], ecx
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+var_54], edx
		lea	eax, [ebp+var_18]
		mov	[esp+58h+File],	eax
		call	sub_408658
		mov	[ebp+var_10], eax
		jmp	short loc_409F36
; ---------------------------------------------------------------------------

loc_409F32:				; CODE XREF: sub_409E4D+35j
		nop
		jmp	short loc_409F36
; ---------------------------------------------------------------------------

loc_409F35:				; CODE XREF: sub_409E4D+73j
		nop

loc_409F36:				; CODE XREF: sub_409E4D+E3j
					; sub_409E4D+E6j
		cmp	[ebp+var_10], 0
		jz	short loc_409F50
		cmp	[ebp+var_C], 0
		jz	short loc_409F50
		mov	edx, off_4160B8
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+File],	eax
		call	edx ; sub_407E95

loc_409F50:				; CODE XREF: sub_409E4D+EDj
					; sub_409E4D+F3j
		mov	eax, [ebp+var_18]
		add	esp, 54h
		pop	ebx
		pop	ebp
		retn
sub_409E4D	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409E4D
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409E4D
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, ds:dword_41A1C4
		mov	[esp], eax
		call	sub_407208
		cmp	dword ptr [ebp+8], 0
		js	short loc_409FF3
		cmp	dword ptr [ebp+8], 2
		jg	short loc_409FF3
		mov	eax, [ebp+8]
		add	eax, offset byte_41A1D4
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_409FF3
		mov	eax, [ebp+8]
		mov	edx, [ebp+0Ch]
		mov	ds:dword_41A1C8[eax*4],	edx
		mov	eax, [ebp+8]
		add	eax, offset byte_41A1D4
		mov	byte ptr [eax],	1

loc_409FF3:				; CODE XREF: .text:00409FC4j
					; .text:00409FCAj ...
		mov	eax, ds:dword_41A1C4
		mov	[esp], eax
		call	sub_407208
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		mov	ecx, [ebp+8]
		mov	edx, 55555556h
		mov	eax, ecx
		imul	edx
		mov	eax, ecx
		sar	eax, 1Fh
		sub	edx, eax
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		mov	[ebp+8], eax
		mov	eax, ds:dword_41A1C4
		mov	[esp], eax
		call	sub_407208
		mov	eax, ds:dword_41A1C0
		mov	[ebp-0Ch], eax
		jmp	short loc_40A08E
; ---------------------------------------------------------------------------

loc_40A048:				; CODE XREF: .text:0040A092j
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		and	eax, 2
		test	al, al
		jz	short loc_40A085
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		shr	al, 2
		and	eax, 3
		movzx	eax, al
		cmp	eax, [ebp+8]
		jnz	short loc_40A085
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		jmp	short loc_40A094
; ---------------------------------------------------------------------------

loc_40A085:				; CODE XREF: .text:0040A05Cj
					; .text:0040A079j
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+4]
		mov	[ebp-0Ch], eax

loc_40A08E:				; CODE XREF: .text:0040A046j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40A048

loc_40A094:				; CODE XREF: .text:0040A083j
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_40A2F8
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_40A0D9
		movzx	eax, ds:byte_41A1D4
		test	al, al
		jz	short loc_40A0D9
		mov	eax, ds:dword_41A1C8
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aR ; "r"
		mov	[esp], eax
		call	sub_409D18
		mov	[ebp-10h], eax
		jmp	short loc_40A147
; ---------------------------------------------------------------------------

loc_40A0D9:				; CODE XREF: .text:0040A0A2j
					; .text:0040A0ADj
		cmp	dword ptr [ebp+8], 1
		jnz	short loc_40A114
		movzx	eax, ds:byte_41A1D5
		test	al, al
		jz	short loc_40A114
		mov	eax, ds:dword_41A1CC
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aA ; "a"
		mov	[esp], eax
		call	sub_409D18
		mov	[ebp-10h], eax
		jmp	short loc_40A147
; ---------------------------------------------------------------------------

loc_40A114:				; CODE XREF: .text:0040A0DDj
					; .text:0040A0E8j
		movzx	eax, ds:byte_41A1D6
		test	al, al
		jz	short loc_40A147
		mov	eax, ds:dword_41A1D0
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aA ; "a"
		mov	[esp], eax
		call	sub_409D18
		mov	[ebp-10h], eax

loc_40A147:				; CODE XREF: .text:0040A0D7j
					; .text:0040A112j ...
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_40A1DF
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_40A181
		mov	eax, ds:_iob
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aR ; "r"
		mov	[esp], eax
		call	sub_409E4D
		mov	[ebp-10h], eax
		jmp	short loc_40A1DF
; ---------------------------------------------------------------------------

loc_40A181:				; CODE XREF: .text:0040A155j
		cmp	dword ptr [ebp+8], 1
		jnz	short loc_40A1B4
		mov	eax, ds:_iob
		add	eax, 20h
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aA ; "a"
		mov	[esp], eax
		call	sub_409E4D
		mov	[ebp-10h], eax
		jmp	short loc_40A1DF
; ---------------------------------------------------------------------------

loc_40A1B4:				; CODE XREF: .text:0040A185j
		mov	eax, ds:_iob
		add	eax, 40h
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aA ; "a"
		mov	[esp], eax
		call	sub_409E4D
		mov	[ebp-10h], eax

loc_40A1DF:				; CODE XREF: .text:0040A14Bj
					; .text:0040A17Fj ...
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40A25B
		cmp	dword ptr [ebp+8], 0
		jz	short loc_40A1F2
		mov	eax, offset aA	; "a"
		jmp	short loc_40A1F7
; ---------------------------------------------------------------------------

loc_40A1F2:				; CODE XREF: .text:0040A1E9j
		mov	eax, offset aR	; "r"

loc_40A1F7:				; CODE XREF: .text:0040A1F0j
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_409E4D
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40A25B
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp], eax
		call	strerror
		mov	edx, offset aFatalErrorCrea ; "fatal: error creating a dummy estream f"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	[esp], ecx
		call	fprintf
		call	abort
; ---------------------------------------------------------------------------

loc_40A25B:				; CODE XREF: .text:0040A1E3j
					; .text:0040A21Ej
		mov	eax, [ebp-10h]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		or	edx, 2
		mov	[eax+250h], dl
		mov	eax, [ebp-10h]
		mov	eax, [eax+24h]
		mov	edx, [ebp+8]
		and	edx, 3
		and	edx, 3
		lea	ecx, ds:0[edx*4]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFF3h
		or	edx, ecx
		mov	[eax+250h], dl
		cmp	dword ptr [ebp+8], 2
		jnz	short loc_40A2C2
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 40h
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_409680

loc_40A2C2:				; CODE XREF: .text:0040A29Dj
		cmp	dword ptr [ebp+8], 0
		jz	short loc_40A2DC
		cmp	dword ptr [ebp+8], 1
		jnz	short loc_40A2D5
		mov	eax, offset aStdout ; "[stdout]"
		jmp	short loc_40A2DA
; ---------------------------------------------------------------------------

loc_40A2D5:				; CODE XREF: .text:0040A2CCj
		mov	eax, offset aStderr ; "[stderr]"

loc_40A2DA:				; CODE XREF: .text:0040A2D3j
		jmp	short loc_40A2E1
; ---------------------------------------------------------------------------

loc_40A2DC:				; CODE XREF: .text:0040A2C6j
		mov	eax, offset aStdin ; "[stdin]"

loc_40A2E1:				; CODE XREF: .text:loc_40A2DAj
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_40B9B7

loc_40A2F8:				; CODE XREF: .text:0040A098j
		mov	eax, ds:dword_41A1C4
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp-10h]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		cmp	dword ptr [ebp+8], 0
		jz	loc_40A44F
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_408554
		lea	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_407FB5
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40A3DC
		mov	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		lea	eax, [ebp-1Ch]
		mov	[esp+4], eax
		lea	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_407F00
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40A3DF
		mov	dword ptr [ebp-10h], 1
		mov	ecx, [ebp-14h]
		mov	edx, [ebp-1Ch]
		mov	eax, [ebp-18h]
		mov	[esp+1Ch], ecx
		mov	ecx, off_41609C
		mov	[esp+0Ch], ecx
		mov	ecx, off_4160A0
		mov	[esp+10h], ecx
		mov	ecx, off_4160A4
		mov	[esp+14h], ecx
		mov	ecx, off_4160A8
		mov	[esp+18h], ecx
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_408379
		jmp	short loc_40A3E0
; ---------------------------------------------------------------------------

loc_40A3DC:				; CODE XREF: .text:0040A360j
		nop
		jmp	short loc_40A3E0
; ---------------------------------------------------------------------------

loc_40A3DF:				; CODE XREF: .text:0040A389j
		nop

loc_40A3E0:				; CODE XREF: .text:0040A3DAj
					; .text:0040A3DDj
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40A413
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_40A3F7
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_407C7E

loc_40A3F7:				; CODE XREF: .text:0040A3EAj
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_40877F
		mov	dword ptr [ebp+10h], 0
		jmp	short loc_40A481
; ---------------------------------------------------------------------------

loc_40A413:				; CODE XREF: .text:0040A3E4j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_40A439
		cmp	dword ptr [ebp+8], 0
		jz	short loc_40A439
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_40B9B7

loc_40A439:				; CODE XREF: .text:0040A417j
					; .text:0040A41Dj
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		jmp	short loc_40A481
; ---------------------------------------------------------------------------

loc_40A44F:				; CODE XREF: .text:0040A314j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_408554
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_40877F
		mov	dword ptr [ebp+10h], 0

loc_40A481:				; CODE XREF: .text:0040A411j
					; .text:0040A44Dj
		mov	eax, [ebp+10h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40A486(void *)
sub_40A486	proc near		; CODE XREF: .text:00409C30p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_24], 0 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40877F
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40A486	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+0Ch], 0
		jz	loc_40A55E
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+23Ch]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40A4EE
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 28h
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jmp	loc_40A57A
; ---------------------------------------------------------------------------

loc_40A4EE:				; CODE XREF: .text:0040A4D3j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40A51D
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408190
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40A576
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_40A51D:				; CODE XREF: .text:0040A4FAj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		lea	edx, [ebp-14h]
		mov	[esp+0Ch], edx
		mov	edx, [ebp+0Ch]
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		mov	eax, [ebp-10h]
		call	eax
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40A579
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_40A55E
		mov	edx, [ebp-14h]
		mov	eax, [ebp+10h]
		mov	[eax], edx

loc_40A55E:				; CODE XREF: .text:0040A4B1j
					; .text:0040A554j
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40877F
		mov	[ebp-0Ch], eax
		jmp	short loc_40A57A
; ---------------------------------------------------------------------------

loc_40A576:				; CODE XREF: .text:0040A50Ej
		nop
		jmp	short loc_40A57A
; ---------------------------------------------------------------------------

loc_40A579:				; CODE XREF: .text:0040A54Ej
		nop

loc_40A57A:				; CODE XREF: .text:0040A4E9j
					; .text:0040A574j ...
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40A59C
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_40A59C
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[esp], eax
		call	sub_407261
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0

loc_40A59C:				; CODE XREF: .text:0040A57Ej
					; .text:0040A584j
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A5A1	proc near		; CODE XREF: .text:0040A628p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		mov	[esp+4+var_4], eax
		call	sub_40984B
		leave
		retn
sub_40A5A1	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_40720D
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40A5A1
		mov	[ebp-4], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A649	proc near		; CODE XREF: .text:0040A68Cp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	[esp+0Ch+var_4], 1
		mov	[esp+0Ch+var_8], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_409632
		leave
		retn
sub_40A649	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40A649
		mov	[ebp-4], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A6AD	proc near		; CODE XREF: .text:0040A6F0p
					; sub_40BB76+3B4p ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	[esp+0Ch+var_4], 0
		mov	[esp+0Ch+var_8], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_409632
		leave
		retn
sub_40A6AD	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40A6AD
		mov	[ebp-4], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A711	proc near		; CODE XREF: .text:0040A754p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	[esp+0Ch+var_4], 0
		mov	[esp+0Ch+var_8], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_4095D8
		leave
		retn
sub_40A711	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40A711
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A76F	proc near		; CODE XREF: sub_40A7AA+26p
					; DATA XREF: sub_40A7AA:loc_40A7EEo

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40A793
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_408190
		mov	[ebp+var_C], eax
		jmp	short loc_40A7A5
; ---------------------------------------------------------------------------

loc_40A793:				; CODE XREF: sub_40A76F+12j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_408329
		mov	[ebp+var_C], 0

loc_40A7A5:				; CODE XREF: sub_40A76F+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40A76F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A7AA	proc near		; CODE XREF: sub_4073E7+Dp

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_40A7EE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_407208
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40A76F
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_407208
		jmp	short loc_40A7FD
; ---------------------------------------------------------------------------

loc_40A7EE:				; CODE XREF: sub_40A7AA+Aj
		mov	[esp+28h+var_28], offset sub_40A76F
		call	sub_407392
		mov	[ebp+var_C], eax

loc_40A7FD:				; CODE XREF: sub_40A7AA+42j
		cmp	[ebp+var_C], 0
		jz	short loc_40A80A
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40A80F
; ---------------------------------------------------------------------------

loc_40A80A:				; CODE XREF: sub_40A7AA+57j
		mov	eax, 0

locret_40A80F:				; CODE XREF: sub_40A7AA+5Ej
		leave
		retn
sub_40A7AA	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp+0Ch]
		mov	edx, eax
		sar	edx, 1Fh
		mov	dword ptr [esp+10h], 0
		mov	ecx, [ebp+10h]
		mov	[esp+0Ch], ecx
		mov	[esp+4], eax
		mov	[esp+8], edx
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408B9A
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+0Ch]
		mov	[ebp-20h], eax
		mov	eax, [ebp+10h]
		mov	[ebp-1Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	dword ptr [esp+10h], 0
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp-20h]
		mov	edx, [ebp-1Ch]
		mov	[esp+4], eax
		mov	[esp+8], edx
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408B9A
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4097A5
		mov	[ebp-4], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [ebp-8], 0FFFFFFFFh
		mov	dword ptr [ebp-4], 0FFFFFFFFh
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4097A5
		mov	[ebp-8], eax
		mov	[ebp-4], edx
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp-8]
		mov	edx, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408B9A
		mov	dword ptr [esp+8], 0FFFFFFFFh
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4095D8
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A9E7	proc near		; CODE XREF: .text:0040AAD8p
					; .text:0040AE4Bp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_D]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], 1
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4089A7
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40AA27
		mov	eax, [ebp+var_14]
		test	eax, eax
		jz	short loc_40AA27
		movzx	eax, [ebp+var_D]
		movzx	eax, al
		jmp	short locret_40AA2C
; ---------------------------------------------------------------------------

loc_40AA27:				; CODE XREF: sub_40A9E7+2Ej
					; sub_40A9E7+35j
		mov	eax, 0FFFFFFFFh

locret_40AA2C:				; CODE XREF: sub_40A9E7+3Ej
		leave
		retn
sub_40A9E7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40AA2E	proc near		; CODE XREF: .text:0040AB68p
					; sub_40BB76+BBp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_D], al
		lea	eax, [ebp+var_D]
		mov	[esp+28h+var_1C], 0
		mov	[esp+28h+var_20], 1
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_408F88
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40AA6A
		mov	eax, [ebp+arg_0]
		jmp	short locret_40AA6F
; ---------------------------------------------------------------------------

loc_40AA6A:				; CODE XREF: sub_40AA2E+35j
		mov	eax, 0FFFFFFFFh

locret_40AA6F:				; CODE XREF: sub_40AA2E+3Aj
		leave
		retn
sub_40AA2E	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_40AAD2
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_40AAD2
		mov	eax, [ebp+8]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_40AAD2
		mov	eax, [ebp+8]
		mov	ecx, [eax]
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+0Ch], ecx
		jmp	short loc_40AADD
; ---------------------------------------------------------------------------

loc_40AAD2:				; CODE XREF: .text:0040AA97j
					; .text:0040AAA7j ...
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40A9E7

loc_40AADD:				; CODE XREF: .text:0040AAD0j
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40AB5B
		mov	eax, [ebp+0Ch]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_40AB5B
		cmp	dword ptr [ebp+8], 0Ah
		jz	short loc_40AB5B
		mov	eax, [ebp+0Ch]
		mov	ecx, [eax]
		mov	eax, [ebp+0Ch]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		mov	ecx, [ebp+8]
		mov	[eax], cl
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+0Ch]
		mov	[edx+0Ch], ecx
		jmp	short loc_40AB6D
; ---------------------------------------------------------------------------

loc_40AB5B:				; CODE XREF: .text:0040AB1Fj
					; .text:0040AB2Fj ...
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40AA2E

loc_40AB6D:				; CODE XREF: .text:0040AB59j
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-9], al
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		lea	eax, [ebp-9]
		lea	edx, [ebp-10h]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_408B0B
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp-10h]
		test	eax, eax
		jz	short loc_40ABEA
		mov	eax, [ebp+8]
		jmp	short locret_40ABEF
; ---------------------------------------------------------------------------

loc_40ABEA:				; CODE XREF: .text:0040ABE3j
		mov	eax, 0FFFFFFFFh

locret_40ABEF:				; CODE XREF: .text:0040ABE8j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40ABF1	proc near		; CODE XREF: sub_4091B2+2CFp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jz	short loc_40AC4A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_407208
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4089A7
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_407208
		jmp	short loc_40AC51
; ---------------------------------------------------------------------------

loc_40AC4A:				; CODE XREF: sub_40ABF1+Aj
		mov	[ebp+var_C], 0

loc_40AC51:				; CODE XREF: sub_40ABF1+57j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40ABF1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40AC56	proc near		; CODE XREF: sub_4091B2+194p
					; sub_4091B2+1E0p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jz	short loc_40ACAF
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_407208
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_408F88
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_407208
		jmp	short loc_40ACB6
; ---------------------------------------------------------------------------

loc_40ACAF:				; CODE XREF: sub_40AC56+Aj
		mov	[ebp+var_C], 0

loc_40ACB6:				; CODE XREF: sub_40AC56+57j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40AC56	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		test	eax, eax
		jz	short loc_40AD28
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		lea	edx, [ebp-10h]
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_4089A7
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp-10h]
		mov	edx, 0
		div	dword ptr [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	short loc_40AD2F
; ---------------------------------------------------------------------------

loc_40AD28:				; CODE XREF: .text:0040ACCAj
		mov	dword ptr [ebp-0Ch], 0

loc_40AD2F:				; CODE XREF: .text:0040AD26j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		test	eax, eax
		jz	short loc_40ADA1
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		lea	edx, [ebp-10h]
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_408F88
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp-10h]
		mov	edx, 0
		div	dword ptr [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	short loc_40ADA8
; ---------------------------------------------------------------------------

loc_40ADA1:				; CODE XREF: .text:0040AD43j
		mov	dword ptr [ebp-0Ch], 0

loc_40ADA8:				; CODE XREF: .text:0040AD9Fj
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_40ADC9
		mov	eax, 0
		jmp	locret_40AEAB
; ---------------------------------------------------------------------------

loc_40ADC9:				; CODE XREF: .text:0040ADBDj
		mov	dword ptr [ebp-10h], 0FFFFFFFFh
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		jmp	short loc_40ADF8
; ---------------------------------------------------------------------------

loc_40ADE6:				; CODE XREF: .text:0040AE5Dj
		mov	eax, [ebp-10h]
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp+0Ch], 1

loc_40ADF8:				; CODE XREF: .text:0040ADE4j
		cmp	dword ptr [ebp+0Ch], 1
		jle	short loc_40AE5F
		mov	eax, [ebp+10h]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_40AE45
		mov	eax, [ebp+10h]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+10h]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_40AE45
		mov	eax, [ebp+10h]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_40AE45
		mov	eax, [ebp+10h]
		mov	ecx, [eax]
		mov	eax, [ebp+10h]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+10h]
		mov	[edx+0Ch], ecx
		jmp	short loc_40AE50
; ---------------------------------------------------------------------------

loc_40AE45:				; CODE XREF: .text:0040AE0Aj
					; .text:0040AE1Aj ...
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_40A9E7

loc_40AE50:				; CODE XREF: .text:0040AE43j
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jz	short loc_40AE5F
		cmp	dword ptr [ebp-10h], 0Ah
		jnz	short loc_40ADE6

loc_40AE5F:				; CODE XREF: .text:0040ADFCj
					; .text:0040AE57j
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_40AE88
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_40AE88
		mov	eax, 0
		jmp	short locret_40AEAB
; ---------------------------------------------------------------------------

loc_40AE88:				; CODE XREF: .text:0040AE77j
					; .text:0040AE7Fj
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jz	short loc_40AEA2
		cmp	dword ptr [ebp+0Ch], 1
		jle	short loc_40AEA2
		mov	eax, [ebp-10h]
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1

loc_40AEA2:				; CODE XREF: .text:0040AE8Cj
					; .text:0040AE92j
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+8]

locret_40AEAB:				; CODE XREF: .text:0040ADC4j
					; .text:0040AE86j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp-0Ch], eax
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_408F88
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_40AF07
		mov	eax, 0FFFFFFFFh
		jmp	short loc_40AF0C
; ---------------------------------------------------------------------------

loc_40AF07:				; CODE XREF: .text:0040AEFEj
		mov	eax, 0

loc_40AF0C:				; CODE XREF: .text:0040AF05j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40AF12	proc near		; CODE XREF: .text:0040C1F2p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+38h+var_38], eax
		call	sub_407208
		mov	[esp+38h+var_2C], 0
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	sub_408F88
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+38h+var_38], eax
		call	sub_407208
		cmp	[ebp+var_10], 0
		jz	short loc_40AF94
		mov	eax, 0FFFFFFFFh
		jmp	short loc_40AF99
; ---------------------------------------------------------------------------

loc_40AF94:				; CODE XREF: sub_40AF12+79j
		mov	eax, 0

loc_40AF99:				; CODE XREF: sub_40AF12+80j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_40AF12	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-18h], 0
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		lea	eax, [ebp-14h]
		lea	edx, [ebp-18h]
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4091B2
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		cmp	dword ptr [ebp-0Ch], 0
		jnz	loc_40B0BB
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		test	eax, eax
		jz	loc_40B0A7
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	edx, [ebp-18h]
		add	edx, 1
		cmp	eax, edx
		jnb	short loc_40B060
		mov	eax, [ebp-18h]
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_407234
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40B04E
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jmp	short loc_40B060
; ---------------------------------------------------------------------------

loc_40B04E:				; CODE XREF: .text:0040B043j
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, [ebp-10h]
		jz	short loc_40B060
		mov	edx, [ebp-10h]
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_40B060:				; CODE XREF: .text:0040B023j
					; .text:0040B04Cj ...
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40B09A
		mov	eax, [ebp-18h]
		lea	ecx, [eax+1]
		mov	eax, [ebp-14h]
		mov	edx, eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp+0Ch]
		mov	edx, [eax]
		mov	eax, [ebp-18h]
		cmp	edx, eax
		jz	short loc_40B09A
		mov	edx, [ebp-18h]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx

loc_40B09A:				; CODE XREF: .text:0040B064j
					; .text:0040B090j
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_407261
		jmp	short loc_40B0BC
; ---------------------------------------------------------------------------

loc_40B0A7:				; CODE XREF: .text:0040B010j
		mov	eax, [ebp-14h]
		mov	edx, eax
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	edx, [ebp-18h]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx
		jmp	short loc_40B0BC
; ---------------------------------------------------------------------------

loc_40B0BB:				; CODE XREF: .text:0040B003j
		nop

loc_40B0BC:				; CODE XREF: .text:0040B0A5j
					; .text:0040B0B9j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40B0C7
		mov	eax, [ebp-18h]
		jmp	short locret_40B0CA
; ---------------------------------------------------------------------------

loc_40B0C7:				; CODE XREF: .text:0040B0C0j
		mov	eax, [ebp-0Ch]

locret_40B0CA:				; CODE XREF: .text:0040B0C5j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		mov	[ebp-14h], eax
		mov	dword ptr [ebp-18h], 0
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_40B0F6
		mov	eax, [ebp+14h]
		mov	eax, [eax]
		jmp	short loc_40B0FB
; ---------------------------------------------------------------------------

loc_40B0F6:				; CODE XREF: .text:0040B0EDj
		mov	eax, 0

loc_40B0FB:				; CODE XREF: .text:0040B0F4j
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40B151
		mov	dword ptr [ebp-14h], 100h
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_407217
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp-10h]
		mov	[eax], edx
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40B149
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 0
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_40B13F
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0

loc_40B13F:				; CODE XREF: .text:0040B134j
		mov	eax, 0FFFFFFFFh
		jmp	locret_40B388
; ---------------------------------------------------------------------------

loc_40B149:				; CODE XREF: .text:0040B125j
		mov	eax, [ebp+10h]
		mov	edx, [ebp-14h]
		mov	[eax], edx

loc_40B151:				; CODE XREF: .text:0040B102j
		cmp	dword ptr [ebp-14h], 3
		ja	short loc_40B16E
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_40B388
; ---------------------------------------------------------------------------

loc_40B16E:				; CODE XREF: .text:0040B155j
		sub	dword ptr [ebp-14h], 3
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp-10h]
		mov	[ebp-1Ch], eax
		jmp	loc_40B306
; ---------------------------------------------------------------------------

loc_40B191:				; CODE XREF: .text:0040B35Fj
		mov	eax, [ebp-18h]
		cmp	eax, [ebp-14h]
		jnz	loc_40B2EE
		cmp	dword ptr [ebp-20h], 0
		jz	loc_40B23A
		mov	eax, [ebp-14h]
		cmp	eax, [ebp-20h]
		jbe	loc_40B23A

loc_40B1B3:				; CODE XREF: .text:0040B212j
		cmp	dword ptr [ebp-0Ch], 0Ah
		jz	short loc_40B214
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_40B200
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_40B200
		mov	eax, [ebp+8]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_40B200
		mov	eax, [ebp+8]
		mov	ecx, [eax]
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+0Ch], ecx
		jmp	short loc_40B20B
; ---------------------------------------------------------------------------

loc_40B200:				; CODE XREF: .text:0040B1C5j
					; .text:0040B1D5j ...
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40A9E7

loc_40B20B:				; CODE XREF: .text:0040B1FEj
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_40B1B3

loc_40B214:				; CODE XREF: .text:0040B1B7j
		mov	eax, [ebp-1Ch]
		mov	byte ptr [eax],	0Ah
		add	dword ptr [ebp-1Ch], 1
		add	dword ptr [ebp-18h], 1
		cmp	dword ptr [ebp+14h], 0
		jz	loc_40B367
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0
		jmp	loc_40B367
; ---------------------------------------------------------------------------

loc_40B23A:				; CODE XREF: .text:0040B1A1j
					; .text:0040B1ADj
		add	dword ptr [ebp-14h], 3
		cmp	dword ptr [ebp-14h], 3FFh
		ja	short loc_40B24E
		mov	eax, 100h
		jmp	short loc_40B253
; ---------------------------------------------------------------------------

loc_40B24E:				; CODE XREF: .text:0040B245j
		mov	eax, 400h

loc_40B253:				; CODE XREF: .text:0040B24Cj
		add	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_407234
		mov	edx, [ebp+0Ch]
		mov	[edx], eax
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40B2CF
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[ebp-24h], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_407261
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 0
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_40B2A5
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0

loc_40B2A5:				; CODE XREF: .text:0040B29Aj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	edx, [ebp-24h]
		mov	[eax], edx
		mov	eax, 0FFFFFFFFh
		jmp	locret_40B388
; ---------------------------------------------------------------------------

loc_40B2CF:				; CODE XREF: .text:0040B274j
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp+10h]
		mov	edx, [ebp-14h]
		mov	[eax], edx
		sub	dword ptr [ebp-14h], 3
		mov	eax, [ebp-18h]
		mov	edx, [ebp-10h]
		add	eax, edx
		mov	[ebp-1Ch], eax

loc_40B2EE:				; CODE XREF: .text:0040B197j
		mov	eax, [ebp-0Ch]
		mov	edx, eax
		mov	eax, [ebp-1Ch]
		mov	[eax], dl
		add	dword ptr [ebp-1Ch], 1
		add	dword ptr [ebp-18h], 1
		cmp	dword ptr [ebp-0Ch], 0Ah
		jz	short loc_40B36A

loc_40B306:				; CODE XREF: .text:0040B18Cj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_40B34D
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_40B34D
		mov	eax, [ebp+8]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_40B34D
		mov	eax, [ebp+8]
		mov	ecx, [eax]
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+0Ch], ecx
		jmp	short loc_40B358
; ---------------------------------------------------------------------------

loc_40B34D:				; CODE XREF: .text:0040B312j
					; .text:0040B322j ...
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40A9E7

loc_40B358:				; CODE XREF: .text:0040B34Bj
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	loc_40B191
		jmp	short loc_40B36B
; ---------------------------------------------------------------------------

loc_40B367:				; CODE XREF: .text:0040B226j
					; .text:0040B235j
		nop
		jmp	short loc_40B36B
; ---------------------------------------------------------------------------

loc_40B36A:				; CODE XREF: .text:0040B304j
		nop

loc_40B36B:				; CODE XREF: .text:0040B365j
					; .text:0040B368j
		mov	eax, [ebp-1Ch]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp-18h]

locret_40B388:				; CODE XREF: .text:0040B144j
					; .text:0040B169j ...
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407261
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409583
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409583
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B40D	proc near		; CODE XREF: sub_40BB76+31Ap

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_409583
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40B40D	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+10h]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409583
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_405F9B
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jns	short loc_40B4CA
		mov	eax, 0
		jmp	short locret_40B4CD
; ---------------------------------------------------------------------------

loc_40B4CA:				; CODE XREF: .text:0040B4C1j
		mov	eax, [ebp-14h]

locret_40B4CD:				; CODE XREF: .text:0040B4C8j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_405F9B
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jns	short loc_40B4FE
		mov	eax, 0
		jmp	short locret_40B501
; ---------------------------------------------------------------------------

loc_40B4FE:				; CODE XREF: .text:0040B4F5j
		mov	eax, [ebp-10h]

locret_40B501:				; CODE XREF: .text:0040B4FCj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B503	proc near		; CODE XREF: .text:0040B759p

nBufferLength	= dword	ptr -178h
lpBuffer	= dword	ptr -174h
dwShareMode	= dword	ptr -170h
lpSecurityAttributes= dword ptr	-16Ch
dwCreationDisposition= dword ptr -168h
dwFlagsAndAttributes= dword ptr	-164h
hTemplateFile	= dword	ptr -160h
var_14C		= dword	ptr -14Ch
Buffer		= byte ptr -146h
var_2C		= dword	ptr -2Ch
hObject		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 174h
		mov	eax, ds:GetCurrentProcessId
		call	eax ; GetCurrentProcessId
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+Buffer]
		mov	[esp+178h+lpBuffer], eax ; lpBuffer
		mov	[esp+178h+nBufferLength], 105h ; nBufferLength
		mov	eax, ds:GetTempPathA
		call	eax ; GetTempPathA
		sub	esp, 8
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_40B573
		cmp	[ebp+var_20], 104h
		jg	short loc_40B573
		lea	eax, [ebp+Buffer]
		mov	[ebp+var_14C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 104h
		jbe	short loc_40B58A

loc_40B573:				; CODE XREF: sub_40B503+36j
					; sub_40B503+3Fj
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 2
		mov	eax, 0FFFFFFFFh
		jmp	loc_40B732
; ---------------------------------------------------------------------------

loc_40B58A:				; CODE XREF: sub_40B503+6Ej
		lea	eax, [ebp+Buffer]
		mov	[ebp+var_14C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp+Buffer]
		add	eax, edx
		mov	[ebp+var_10], eax
		mov	edx, offset a_estream ;	"_estream"
		mov	eax, [ebp+var_10]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	edx, byte ptr [edx+8]
		mov	[eax+8], dl
		add	[ebp+var_10], 8
		mov	[esp+178h+lpBuffer], 0 ; lpSecurityAttributes
		lea	eax, [ebp+Buffer]
		mov	[esp+178h+nBufferLength], eax ;	lpPathName
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[ebp+var_24], eax
		mov	[ebp+var_C], 0
		jmp	loc_40B716
; ---------------------------------------------------------------------------

loc_40B611:				; CODE XREF: sub_40B503+217j
		mov	eax, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	eax, ds:GetTickCount
		call	eax ; GetTickCount
		mov	edx, [ebp+var_1C]
		shl	edx, 10h
		xor	eax, edx
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		jmp	short loc_40B662
; ---------------------------------------------------------------------------

loc_40B632:				; CODE XREF: sub_40B503+163j
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		cmp	eax, 9
		ja	short loc_40B648
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		add	eax, 30h
		jmp	short loc_40B651
; ---------------------------------------------------------------------------

loc_40B648:				; CODE XREF: sub_40B503+138j
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		add	eax, 37h

loc_40B651:				; CODE XREF: sub_40B503+143j
		mov	edx, [ebp+var_10]
		mov	[edx], al
		add	[ebp+var_10], 1
		shl	[ebp+var_14], 4
		add	[ebp+var_18], 1

loc_40B662:				; CODE XREF: sub_40B503+12Dj
		cmp	[ebp+var_18], 7
		jle	short loc_40B632
		mov	edx, offset a_tmp ; ".tmp"
		mov	eax, [ebp+var_10]
		mov	ecx, [edx]
		mov	[eax], ecx
		movzx	edx, byte ptr [edx+4]
		mov	[eax+4], dl
		mov	[esp+178h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+178h+dwFlagsAndAttributes], 4000100h ; dwFlagsAndAttributes
		mov	[esp+178h+dwCreationDisposition], 1 ; dwCreationDisposition
		mov	[esp+178h+lpSecurityAttributes], 0 ; lpSecurityAttributes
		mov	[esp+178h+dwShareMode],	0 ; dwShareMode
		mov	[esp+178h+lpBuffer], 0C0000000h	; dwDesiredAccess
		lea	eax, [ebp+Buffer]
		mov	[esp+178h+nBufferLength], eax ;	lpFileName
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0FFFFFFFFh
		jz	short loc_40B701
		mov	eax, [ebp+hObject]
		mov	[esp+178h+lpBuffer], 0
		mov	[esp+178h+nBufferLength], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0FFFFFFFFh
		jnz	short loc_40B6FC
		mov	eax, [ebp+hObject]
		mov	[esp+178h+nBufferLength], eax ;	hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0FFFFFFFFh
		jmp	short loc_40B732
; ---------------------------------------------------------------------------

loc_40B6FC:				; CODE XREF: sub_40B503+1E0j
		mov	eax, [ebp+var_2C]
		jmp	short loc_40B732
; ---------------------------------------------------------------------------

loc_40B701:				; CODE XREF: sub_40B503+1C2j
		mov	[esp+178h+nBufferLength], 1 ; dwMilliseconds
		mov	eax, ds:Sleep
		call	eax ; Sleep
		sub	esp, 4
		add	[ebp+var_C], 1

loc_40B716:				; CODE XREF: sub_40B503+109j
		cmp	[ebp+var_C], 9
		jle	loc_40B611
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 2
		mov	eax, 0FFFFFFFFh

loc_40B732:				; CODE XREF: sub_40B503+82j
					; sub_40B503+1F7j ...
		mov	edi, [ebp+var_4]
		leave
		retn
sub_40B503	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-14h], 302h
		mov	dword ptr [ebp-20h], 0
		call	sub_40B503
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jnz	short loc_40B773
		mov	dword ptr [ebp-10h], 0FFFFFFFFh
		jmp	loc_40B7FA
; ---------------------------------------------------------------------------

loc_40B773:				; CODE XREF: .text:0040B765j
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp-14h]
		mov	[esp+8], eax
		mov	eax, [ebp-18h]
		mov	[esp+4], eax
		lea	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_407AD9
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40B7F9
		mov	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-20h]
		mov	dword ptr [esp+20h], 0
		mov	edx, [ebp-14h]
		mov	[esp+1Ch], edx
		mov	edx, off_41609C
		mov	[esp+0Ch], edx
		mov	edx, off_4160A0
		mov	[esp+10h], edx
		mov	edx, off_4160A4
		mov	[esp+14h], edx
		mov	edx, off_4160A8
		mov	[esp+18h], edx
		mov	edx, [ebp-18h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		lea	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_408658
		mov	[ebp-10h], eax
		jmp	short loc_40B7FA
; ---------------------------------------------------------------------------

loc_40B7F9:				; CODE XREF: .text:0040B79Bj
		nop

loc_40B7FA:				; CODE XREF: .text:0040B76Ej
					; .text:0040B7F7j
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_40B82B
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40B813
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_407C7E
		jmp	short loc_40B824
; ---------------------------------------------------------------------------

loc_40B813:				; CODE XREF: .text:0040B804j
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jz	short loc_40B824
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	_close

loc_40B824:				; CODE XREF: .text:0040B811j
					; .text:0040B817j
		mov	dword ptr [ebp-1Ch], 0

loc_40B82B:				; CODE XREF: .text:0040B7FEj
		mov	eax, [ebp-1Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_40B848
		cmp	dword ptr [ebp+10h], 40h
		jz	short loc_40B848
		cmp	dword ptr [ebp+10h], 4
		jnz	short loc_40B8A7

loc_40B848:				; CODE XREF: .text:0040B83Aj
					; .text:0040B840j
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_40B85A
		cmp	dword ptr [ebp+14h], 0
		jnz	short loc_40B85A
		cmp	dword ptr [ebp+10h], 4
		jnz	short loc_40B8A7

loc_40B85A:				; CODE XREF: .text:0040B84Cj
					; .text:0040B852j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409680
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		jmp	short loc_40B8BB
; ---------------------------------------------------------------------------

loc_40B8A7:				; CODE XREF: .text:0040B846j
					; .text:0040B858j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh

loc_40B8BB:				; CODE XREF: .text:0040B8A5j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_40B8E7
		mov	eax, 0
		jmp	short loc_40B8EC
; ---------------------------------------------------------------------------

loc_40B8E7:				; CODE XREF: .text:0040B8DEj
		mov	eax, 4

loc_40B8EC:				; CODE XREF: .text:0040B8E5j
		mov	dword ptr [esp+0Ch], 200h
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409680
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40981A
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		lea	eax, [ebp-4]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40981A
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40B9B7(int, char *, int)
sub_40B9B7	proc near		; CODE XREF: .text:00409958p
					; .text:0040A2F3p ...

Dest		= dword	ptr -28h
Source		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		test	eax, eax
		jz	short loc_40BA07
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		and	eax, 20h
		test	al, al
		jnz	short loc_40BA07
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	[esp+28h+Dest],	eax ; void *
		call	sub_407261
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+220h], 0

loc_40BA07:				; CODE XREF: sub_40B9B7+16j
					; sub_40B9B7+2Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		test	eax, eax
		jnz	loc_40BAB3
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Bh
		jz	short loc_40BA2E
		mov	[ebp+arg_8], 0
		jmp	short loc_40BA3B
; ---------------------------------------------------------------------------

loc_40BA2E:				; CODE XREF: sub_40B9B7+6Cj
		cmp	[ebp+arg_8], 0
		setnz	al
		movzx	eax, al
		mov	[ebp+arg_8], eax

loc_40BA3B:				; CODE XREF: sub_40B9B7+75j
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+24h]
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_8]
		add	eax, edx
		add	eax, 1
		mov	[esp+28h+Dest],	eax ; size_t
		call	sub_407217
		mov	[ebx+220h], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_40BAB4
		cmp	[ebp+arg_8], 0
		jz	short loc_40BA91
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	byte ptr [eax],	5Ch

loc_40BA91:				; CODE XREF: sub_40B9B7+C9j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [eax+220h]
		mov	eax, [ebp+arg_8]
		add	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Source], eax ;	Source
		mov	[esp+28h+Dest],	edx ; Dest
		call	strcpy
		jmp	short loc_40BAB4
; ---------------------------------------------------------------------------

loc_40BAB3:				; CODE XREF: sub_40B9B7+5Ej
		nop

loc_40BAB4:				; CODE XREF: sub_40B9B7+C3j
					; sub_40B9B7+FAj
		add	esp, 20h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40B9B7	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short locret_40BB09
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40B9B7
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208

locret_40BB09:				; CODE XREF: .text:0040BAC5j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	[ebp-4], eax
		cmp	dword ptr [ebp-4], 0
		jz	short loc_40BB50
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		or	edx, 20h
		mov	[eax+250h], dl

loc_40BB50:				; CODE XREF: .text:0040BB38j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		cmp	dword ptr [ebp-4], 0
		jnz	short loc_40BB71
		mov	dword ptr [ebp-4], offset a? ; "[?]"

loc_40BB71:				; CODE XREF: .text:0040BB68j
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40BB76(int, int, int,	char *,	int)
sub_40BB76	proc near		; CODE XREF: .text:0040C237p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+Str], eax
		call	sub_407208
		jmp	loc_40BF0C
; ---------------------------------------------------------------------------

loc_40BBA2:				; CODE XREF: sub_40BB76+39Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_40BBEA
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_40BBEA
		cmp	[ebp+arg_C], 0
		jz	loc_40BE9B
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jnz	short loc_40BBEA
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_40BE9B

loc_40BBEA:				; CODE XREF: sub_40BB76+34j
					; sub_40BB76+3Ej ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40BC23
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_40BC23
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	5Ch
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_40BC36
; ---------------------------------------------------------------------------

loc_40BC23:				; CODE XREF: sub_40BB76+80j
					; sub_40BB76+90j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 5Ch
		call	sub_40AA2E

loc_40BC36:				; CODE XREF: sub_40BB76+ABj
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_40BC99
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40BC7D
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_40BC7D
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	6Eh
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_40BC90
; ---------------------------------------------------------------------------

loc_40BC7D:				; CODE XREF: sub_40BB76+DAj
					; sub_40BB76+EAj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 6Eh
		call	sub_40AA2E

loc_40BC90:				; CODE XREF: sub_40BB76+105j
		add	[ebp+var_10], 1
		jmp	loc_40BF00
; ---------------------------------------------------------------------------

loc_40BC99:				; CODE XREF: sub_40BB76+CCj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_40BCF8
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40BCDC
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_40BCDC
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	72h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_40BCEF
; ---------------------------------------------------------------------------

loc_40BCDC:				; CODE XREF: sub_40BB76+139j
					; sub_40BB76+149j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 72h
		call	sub_40AA2E

loc_40BCEF:				; CODE XREF: sub_40BB76+164j
		add	[ebp+var_10], 1
		jmp	loc_40BF00
; ---------------------------------------------------------------------------

loc_40BCF8:				; CODE XREF: sub_40BB76+12Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_40BD57
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40BD3B
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_40BD3B
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	66h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_40BD4E
; ---------------------------------------------------------------------------

loc_40BD3B:				; CODE XREF: sub_40BB76+198j
					; sub_40BB76+1A8j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 66h
		call	sub_40AA2E

loc_40BD4E:				; CODE XREF: sub_40BB76+1C3j
		add	[ebp+var_10], 1
		jmp	loc_40BF00
; ---------------------------------------------------------------------------

loc_40BD57:				; CODE XREF: sub_40BB76+18Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_40BDB6
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40BD9A
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_40BD9A
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	76h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_40BDAD
; ---------------------------------------------------------------------------

loc_40BD9A:				; CODE XREF: sub_40BB76+1F7j
					; sub_40BB76+207j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 76h
		call	sub_40AA2E

loc_40BDAD:				; CODE XREF: sub_40BB76+222j
		add	[ebp+var_10], 1
		jmp	loc_40BF00
; ---------------------------------------------------------------------------

loc_40BDB6:				; CODE XREF: sub_40BB76+1E9j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_40BE15
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40BDF9
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_40BDF9
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	62h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_40BE0C
; ---------------------------------------------------------------------------

loc_40BDF9:				; CODE XREF: sub_40BB76+256j
					; sub_40BB76+266j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 62h
		call	sub_40AA2E

loc_40BE0C:				; CODE XREF: sub_40BB76+281j
		add	[ebp+var_10], 1
		jmp	loc_40BF00
; ---------------------------------------------------------------------------

loc_40BE15:				; CODE XREF: sub_40BB76+248j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40BE74
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40BE58
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_40BE58
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	30h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_40BE6B
; ---------------------------------------------------------------------------

loc_40BE58:				; CODE XREF: sub_40BB76+2B5j
					; sub_40BB76+2C5j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 30h
		call	sub_40AA2E

loc_40BE6B:				; CODE XREF: sub_40BB76+2E0j
		add	[ebp+var_10], 1
		jmp	loc_40BF00
; ---------------------------------------------------------------------------

loc_40BE74:				; CODE XREF: sub_40BB76+2A7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x ; "x%02x"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_40B40D
		add	[ebp+var_10], 3
		jmp	short loc_40BF00
; ---------------------------------------------------------------------------

loc_40BE9B:				; CODE XREF: sub_40BB76+44j
					; sub_40BB76+6Ej
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40BEE4
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_40BEE4
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_40BEE4
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+var_C]
		movzx	edx, byte ptr [edx]
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_40BEFC
; ---------------------------------------------------------------------------

loc_40BEE4:				; CODE XREF: sub_40BB76+331j
					; sub_40BB76+341j ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Val], edx
		mov	[esp+28h+Str], eax
		call	sub_40AA2E

loc_40BEFC:				; CODE XREF: sub_40BB76+36Cj
		add	[ebp+var_10], 1

loc_40BF00:				; CODE XREF: sub_40BB76+11Ej
					; sub_40BB76+17Dj ...
		sub	[ebp+arg_8], 1
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_40BF0C:				; CODE XREF: sub_40BB76+27j
		cmp	[ebp+arg_8], 0
		jnz	loc_40BBA2
		cmp	[ebp+arg_10], 0
		jz	short loc_40BF24
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_40BF24:				; CODE XREF: sub_40BB76+3A4j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_40A6AD
		test	eax, eax
		jz	short loc_40BF3A
		mov	eax, 0FFFFFFFFh
		jmp	short loc_40BF3F
; ---------------------------------------------------------------------------

loc_40BF3A:				; CODE XREF: sub_40BB76+3BBj
		mov	eax, 0

loc_40BF3F:				; CODE XREF: sub_40BB76+3C2j
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+Str], eax
		call	sub_407208
		mov	eax, [ebp+var_14]
		leave
		retn
sub_40BB76	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_40BF78
		mov	eax, 0
		jmp	locret_40C144
; ---------------------------------------------------------------------------

loc_40BF78:				; CODE XREF: .text:0040BF6Cj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	loc_40C0F7
; ---------------------------------------------------------------------------

loc_40BF97:				; CODE XREF: .text:0040C0FBj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40BFFE
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_40BFFE
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		shr	dl, 4
		movzx	edx, dl
		and	edx, 0Fh
		cmp	edx, 9
		jg	short loc_40BFE5
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		shr	dl, 4
		add	edx, 30h
		jmp	short loc_40BFF1
; ---------------------------------------------------------------------------

loc_40BFE5:				; CODE XREF: .text:0040BFD5j
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		shr	dl, 4
		add	edx, 37h

loc_40BFF1:				; CODE XREF: .text:0040BFE3j
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx
		jmp	short loc_40C047
; ---------------------------------------------------------------------------

loc_40BFFE:				; CODE XREF: .text:0040BFA3j
					; .text:0040BFB3j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_40C026
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_40C038
; ---------------------------------------------------------------------------

loc_40C026:				; CODE XREF: .text:0040C010j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 37h

loc_40C038:				; CODE XREF: .text:0040C024j
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_40AA2E

loc_40C047:				; CODE XREF: .text:0040BFFCj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40C0AB
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_40C0AB
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		and	edx, 0Fh
		cmp	edx, 9
		jg	short loc_40C092
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		and	edx, 0Fh
		add	edx, 30h
		jmp	short loc_40C09E
; ---------------------------------------------------------------------------

loc_40C092:				; CODE XREF: .text:0040C082j
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		and	edx, 0Fh
		add	edx, 37h

loc_40C09E:				; CODE XREF: .text:0040C090j
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx
		jmp	short loc_40C0EB
; ---------------------------------------------------------------------------

loc_40C0AB:				; CODE XREF: .text:0040C053j
					; .text:0040C063j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_40C0CD
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_40C0DC
; ---------------------------------------------------------------------------

loc_40C0CD:				; CODE XREF: .text:0040C0BAj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 37h

loc_40C0DC:				; CODE XREF: .text:0040C0CBj
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_40AA2E

loc_40C0EB:				; CODE XREF: .text:0040C0A9j
		add	dword ptr [ebp-10h], 2
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp+10h], 1

loc_40C0F7:				; CODE XREF: .text:0040BF92j
		cmp	dword ptr [ebp+10h], 0
		jnz	loc_40BF97
		cmp	dword ptr [ebp+18h], 0
		jz	short loc_40C10F
		mov	eax, [ebp+18h]
		mov	edx, [ebp-10h]
		mov	[eax], edx

loc_40C10F:				; CODE XREF: .text:0040C105j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40A6AD
		test	eax, eax
		jz	short loc_40C125
		mov	eax, 0FFFFFFFFh
		jmp	short loc_40C12A
; ---------------------------------------------------------------------------

loc_40C125:				; CODE XREF: .text:0040C11Cj
		mov	eax, 0

loc_40C12A:				; CODE XREF: .text:0040C123j
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_407208
		mov	eax, [ebp-14h]

locret_40C144:				; CODE XREF: .text:0040BF73j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_40C16F
; ---------------------------------------------------------------------------

loc_40C15C:				; CODE XREF: .text:0040C175j
		mov	eax, [ebp-0Ch]
		mov	edx, [ebp-10h]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_40C179
		add	dword ptr [ebp-0Ch], 1

loc_40C16F:				; CODE XREF: .text:0040C15Aj
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jb	short loc_40C15C
		jmp	short loc_40C17A
; ---------------------------------------------------------------------------

loc_40C179:				; CODE XREF: .text:0040C169j
		nop

loc_40C17A:				; CODE XREF: .text:0040C177j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jnb	loc_40C215
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_40C197
		mov	eax, [ebp+14h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		jmp	short loc_40C19C
; ---------------------------------------------------------------------------

loc_40C197:				; CODE XREF: .text:0040C18Aj
		mov	eax, 0

loc_40C19C:				; CODE XREF: .text:0040C195j
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_413523
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp+18h], 0
		jz	short loc_40C1E5
		mov	eax, [ebp-18h]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+18h]
		mov	[eax], edx

loc_40C1E5:				; CODE XREF: .text:0040C1BFj
		mov	eax, [ebp-18h]
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_40AF12
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	gcry_free
		cmp	dword ptr [ebp-1Ch], 0FFFFFFFFh
		jz	short loc_40C210
		mov	eax, [ebp-0Ch]
		jmp	short loc_40C213
; ---------------------------------------------------------------------------

loc_40C210:				; CODE XREF: .text:0040C209j
		mov	eax, [ebp-1Ch]

loc_40C213:				; CODE XREF: .text:0040C20Ej
		jmp	short loc_40C23C
; ---------------------------------------------------------------------------

loc_40C215:				; CODE XREF: .text:0040C180j
		mov	eax, [ebp-10h]
		mov	edx, [ebp+18h]
		mov	[esp+10h], edx
		mov	edx, [ebp+14h]
		mov	[esp+0Ch], edx
		mov	edx, [ebp+10h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40BB76

loc_40C23C:				; CODE XREF: .text:loc_40C213j
		add	esp, 54h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40C244(char *)
sub_40C244	proc near		; CODE XREF: sub_40D40E+1Dp
					; .text:0040DD68p

VarName		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_12		= word ptr -12h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+VarName], offset aLc_all ; "LC_ALL"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40C271
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40C271
		mov	eax, [ebp+var_C]
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C271:				; CODE XREF: sub_40C244+19j
					; sub_40C244+23j
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+VarName], eax ; VarName
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40C297
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40C297
		mov	eax, [ebp+var_C]
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C297:				; CODE XREF: sub_40C244+3Fj
					; sub_40C244+49j
		mov	[esp+38h+VarName], offset aLang	; "LANG"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40C2BE
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40C2BE
		mov	eax, [ebp+var_C]
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C2BE:				; CODE XREF: sub_40C244+66j
					; sub_40C244+70j
		mov	eax, ds:GetThreadLocale
		call	eax ; GetThreadLocale
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_12], ax
		movzx	eax, [ebp+var_12]
		and	eax, 3FFh
		mov	[ebp+var_18], eax
		movzx	eax, [ebp+var_12]
		shr	ax, 0Ah
		movzx	eax, ax
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_18], 79h ; switch 122 cases
		ja	loc_40CD84	; jumptable 0040C300 default case
		mov	eax, [ebp+var_18]
		shl	eax, 2
		add	eax, offset off_4183A0
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40C302:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aAf_za ; jumptable 0040C300	case 54
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C30C:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aSq_al ; jumptable 0040C300	case 28
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C316:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aAm_et ; jumptable 0040C300	case 94
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C320:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		cmp	[ebp+var_1C], 10h ; jumptable 0040C300 case 1
		ja	loc_40C3D9	; jumptable 0040C337 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_418588
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40C339:				; CODE XREF: sub_40C244+F3j
					; DATA XREF: .rdata:off_418588o
		mov	eax, offset aAr_sa ; jumptable 0040C337	case 1
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C343:				; CODE XREF: sub_40C244+F3j
					; DATA XREF: .rdata:off_418588o
		mov	eax, offset aAr_iq ; jumptable 0040C337	case 2
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C34D:				; CODE XREF: sub_40C244+F3j
					; DATA XREF: .rdata:off_418588o
		mov	eax, offset aAr_eg ; jumptable 0040C337	case 3
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C357:				; CODE XREF: sub_40C244+F3j
					; DATA XREF: .rdata:off_418588o
		mov	eax, offset aAr_ly ; jumptable 0040C337	case 4
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C361:				; CODE XREF: sub_40C244+F3j
					; DATA XREF: .rdata:off_418588o
		mov	eax, offset aAr_dz ; jumptable 0040C337	case 5
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C36B:				; CODE XREF: sub_40C244+F3j
					; DATA XREF: .rdata:off_418588o
		mov	eax, offset aAr_ma ; jumptable 0040C337	case 6
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C375:				; CODE XREF: sub_40C244+F3j
					; DATA XREF: .rdata:off_418588o
		mov	eax, offset aAr_tn ; jumptable 0040C337	case 7
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C37F:				; CODE XREF: sub_40C244+F3j
					; DATA XREF: .rdata:off_418588o
		mov	eax, offset aAr_om ; jumptable 0040C337	case 8
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C389:				; CODE XREF: sub_40C244+F3j
					; DATA XREF: .rdata:off_418588o
		mov	eax, offset aAr_ye ; jumptable 0040C337	case 9
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C393:				; CODE XREF: sub_40C244+F3j
					; DATA XREF: .rdata:off_418588o
		mov	eax, offset aAr_sy ; jumptable 0040C337	case 10
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C39D:				; CODE XREF: sub_40C244+F3j
					; DATA XREF: .rdata:off_418588o
		mov	eax, offset aAr_jo ; jumptable 0040C337	case 11
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C3A7:				; CODE XREF: sub_40C244+F3j
					; DATA XREF: .rdata:off_418588o
		mov	eax, offset aAr_lb ; jumptable 0040C337	case 12
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C3B1:				; CODE XREF: sub_40C244+F3j
					; DATA XREF: .rdata:off_418588o
		mov	eax, offset aAr_kw ; jumptable 0040C337	case 13
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C3BB:				; CODE XREF: sub_40C244+F3j
					; DATA XREF: .rdata:off_418588o
		mov	eax, offset aAr_ae ; jumptable 0040C337	case 14
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C3C5:				; CODE XREF: sub_40C244+F3j
					; DATA XREF: .rdata:off_418588o
		mov	eax, offset aAr_bh ; jumptable 0040C337	case 15
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C3CF:				; CODE XREF: sub_40C244+F3j
					; DATA XREF: .rdata:off_418588o
		mov	eax, offset aAr_qa ; jumptable 0040C337	case 16
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C3D9:				; CODE XREF: sub_40C244+E0j
					; sub_40C244+F3j
					; DATA XREF: ...
		mov	eax, offset aAr	; jumptable 0040C337 default case
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C3E3:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aHy_am ; jumptable 0040C300	case 43
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C3ED:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aAs_in ; jumptable 0040C300	case 77
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C3F7:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, [ebp+var_1C] ; jumptable 0040C300 case 44
		cmp	eax, 1
		jz	short loc_40C406
		cmp	eax, 2
		jz	short loc_40C410
		jmp	short loc_40C41A
; ---------------------------------------------------------------------------

loc_40C406:				; CODE XREF: sub_40C244+1B9j
		mov	eax, offset aAz_az@latin ; "az_AZ@latin"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C410:				; CODE XREF: sub_40C244+1BEj
		mov	eax, offset aAz_az@cyrillic ; "az_AZ@cyrillic"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C41A:				; CODE XREF: sub_40C244+1C0j
		mov	eax, offset aAz	; "az"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C424:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aEu	; jumptable 0040C300 case 45
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C42E:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aBe_by ; jumptable 0040C300	case 35
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C438:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, [ebp+var_1C] ; jumptable 0040C300 case 69
		cmp	eax, 1
		jz	short loc_40C447
		cmp	eax, 2
		jz	short loc_40C451
		jmp	short loc_40C45B
; ---------------------------------------------------------------------------

loc_40C447:				; CODE XREF: sub_40C244+1FAj
		mov	eax, offset aBn_in ; "bn_IN"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C451:				; CODE XREF: sub_40C244+1FFj
		mov	eax, offset aBn_bd ; "bn_BD"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C45B:				; CODE XREF: sub_40C244+201j
		mov	eax, offset aBn	; "bn"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C465:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aBg_bg ; jumptable 0040C300	case 2
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C46F:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aMy_mm ; jumptable 0040C300	case 85
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C479:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aKm_kh ; jumptable 0040C300	case 83
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C483:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aCa_es ; jumptable 0040C300	case 3
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C48D:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aChr_us ; jumptable	0040C300 case 92
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C497:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		cmp	[ebp+var_1C], 5	; jumptable 0040C300 case 4
		ja	short loc_40C4DE ; jumptable 0040C4AA default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_4185CC
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40C4AC:				; CODE XREF: sub_40C244+266j
					; DATA XREF: .rdata:off_4185CCo
		mov	eax, offset aZh_tw ; jumptable 0040C4AA	case 1
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C4B6:				; CODE XREF: sub_40C244+266j
					; DATA XREF: .rdata:off_4185CCo
		mov	eax, offset aZh_cn ; jumptable 0040C4AA	case 2
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C4C0:				; CODE XREF: sub_40C244+266j
					; DATA XREF: .rdata:off_4185CCo
		mov	eax, offset aZh_hk ; jumptable 0040C4AA	case 3
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C4CA:				; CODE XREF: sub_40C244+266j
					; DATA XREF: .rdata:off_4185CCo
		mov	eax, offset aZh_sg ; jumptable 0040C4AA	case 4
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C4D4:				; CODE XREF: sub_40C244+266j
					; DATA XREF: .rdata:off_4185CCo
		mov	eax, offset aZh_mo ; jumptable 0040C4AA	case 5
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C4DE:				; CODE XREF: sub_40C244+257j
					; sub_40C244+266j
					; DATA XREF: ...
		mov	eax, offset aZh	; jumptable 0040C4AA default case
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C4E8:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, [ebp+var_1C] ; jumptable 0040C300 case 26
		cmp	eax, 2
		jz	short loc_40C504
		cmp	eax, 3
		jz	short loc_40C50E
		cmp	eax, 1
		jnz	short loc_40C518
		mov	eax, offset aHr_hr ; "hr_HR"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C504:				; CODE XREF: sub_40C244+2AAj
		mov	eax, offset aSr_cs ; "sr_CS"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C50E:				; CODE XREF: sub_40C244+2AFj
		mov	eax, offset aSr_cs@cyrillic ; "sr_CS@cyrillic"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C518:				; CODE XREF: sub_40C244+2B4j
		mov	eax, offset aHr	; "hr"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C522:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aCs_cz ; jumptable 0040C300	case 5
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C52C:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aDa_dk ; jumptable 0040C300	case 6
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C536:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aDiv_mv ; jumptable	0040C300 case 101
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C540:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, [ebp+var_1C] ; jumptable 0040C300 case 19
		cmp	eax, 1
		jz	short loc_40C54F
		cmp	eax, 2
		jz	short loc_40C559
		jmp	short loc_40C563
; ---------------------------------------------------------------------------

loc_40C54F:				; CODE XREF: sub_40C244+302j
		mov	eax, offset aNl_nl ; "nl_NL"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C559:				; CODE XREF: sub_40C244+307j
		mov	eax, offset aNl_be ; "nl_BE"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C563:				; CODE XREF: sub_40C244+309j
		mov	eax, offset aNl	; "nl"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C56D:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aBin_ng ; jumptable	0040C300 case 102
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C577:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		cmp	[ebp+var_1C], 12h ; jumptable 0040C300 case 9
		ja	loc_40C644	; jumptable 0040C58E default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_4185E4
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40C590:				; CODE XREF: sub_40C244+34Aj
					; DATA XREF: .rdata:off_4185E4o
		mov	eax, offset aEn_us ; jumptable 0040C58E	case 1
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C59A:				; CODE XREF: sub_40C244+34Aj
					; DATA XREF: .rdata:off_4185E4o
		mov	eax, offset aEn_gb ; jumptable 0040C58E	case 2
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C5A4:				; CODE XREF: sub_40C244+34Aj
					; DATA XREF: .rdata:off_4185E4o
		mov	eax, offset aEn_au ; jumptable 0040C58E	case 3
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C5AE:				; CODE XREF: sub_40C244+34Aj
					; DATA XREF: .rdata:off_4185E4o
		mov	eax, offset aEn_ca ; jumptable 0040C58E	case 4
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C5B8:				; CODE XREF: sub_40C244+34Aj
					; DATA XREF: .rdata:off_4185E4o
		mov	eax, offset aEn_nz ; jumptable 0040C58E	case 5
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C5C2:				; CODE XREF: sub_40C244+34Aj
					; DATA XREF: .rdata:off_4185E4o
		mov	eax, offset aEn_ie ; jumptable 0040C58E	case 6
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C5CC:				; CODE XREF: sub_40C244+34Aj
					; DATA XREF: .rdata:off_4185E4o
		mov	eax, offset aEn_za ; jumptable 0040C58E	case 7
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C5D6:				; CODE XREF: sub_40C244+34Aj
					; DATA XREF: .rdata:off_4185E4o
		mov	eax, offset aEn_jm ; jumptable 0040C58E	case 8
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C5E0:				; CODE XREF: sub_40C244+34Aj
					; DATA XREF: .rdata:off_4185E4o
		mov	eax, offset aEn_gd ; jumptable 0040C58E	case 9
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C5EA:				; CODE XREF: sub_40C244+34Aj
					; DATA XREF: .rdata:off_4185E4o
		mov	eax, offset aEn_bz ; jumptable 0040C58E	case 10
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C5F4:				; CODE XREF: sub_40C244+34Aj
					; DATA XREF: .rdata:off_4185E4o
		mov	eax, offset aEn_tt ; jumptable 0040C58E	case 11
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C5FE:				; CODE XREF: sub_40C244+34Aj
					; DATA XREF: .rdata:off_4185E4o
		mov	eax, offset aEn_zw ; jumptable 0040C58E	case 12
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C608:				; CODE XREF: sub_40C244+34Aj
					; DATA XREF: .rdata:off_4185E4o
		mov	eax, offset aEn_ph ; jumptable 0040C58E	case 13
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C612:				; CODE XREF: sub_40C244+34Aj
					; DATA XREF: .rdata:off_4185E4o
		mov	eax, offset aEn_id ; jumptable 0040C58E	case 14
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C61C:				; CODE XREF: sub_40C244+34Aj
					; DATA XREF: .rdata:off_4185E4o
		mov	eax, offset aEn_hk ; jumptable 0040C58E	case 15
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C626:				; CODE XREF: sub_40C244+34Aj
					; DATA XREF: .rdata:off_4185E4o
		mov	eax, offset aEn_in ; jumptable 0040C58E	case 16
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C630:				; CODE XREF: sub_40C244+34Aj
					; DATA XREF: .rdata:off_4185E4o
		mov	eax, offset aEn_my ; jumptable 0040C58E	case 17
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C63A:				; CODE XREF: sub_40C244+34Aj
					; DATA XREF: .rdata:off_4185E4o
		mov	eax, offset aEn_sg ; jumptable 0040C58E	case 18
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C644:				; CODE XREF: sub_40C244+337j
					; sub_40C244+34Aj
					; DATA XREF: ...
		mov	eax, offset aEn	; jumptable 0040C58E default case
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C64E:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aEt_ee ; jumptable 0040C300	case 37
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C658:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aFo_fo ; jumptable 0040C300	case 56
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C662:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aFa_ir ; jumptable 0040C300	case 41
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C66C:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aFi_fi ; jumptable 0040C300	case 11
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C676:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		cmp	[ebp+var_1C], 0Fh ; jumptable 0040C300 case 12
		ja	loc_40C725	; jumptable 0040C68D default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_418630
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40C68F:				; CODE XREF: sub_40C244+449j
					; DATA XREF: .rdata:off_418630o
		mov	eax, offset aFr_fr ; jumptable 0040C68D	case 1
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C699:				; CODE XREF: sub_40C244+449j
					; DATA XREF: .rdata:off_418630o
		mov	eax, offset aFr_be ; jumptable 0040C68D	case 2
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C6A3:				; CODE XREF: sub_40C244+449j
					; DATA XREF: .rdata:off_418630o
		mov	eax, offset aFr_ca ; jumptable 0040C68D	case 3
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C6AD:				; CODE XREF: sub_40C244+449j
					; DATA XREF: .rdata:off_418630o
		mov	eax, offset aFr_ch ; jumptable 0040C68D	case 4
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C6B7:				; CODE XREF: sub_40C244+449j
					; DATA XREF: .rdata:off_418630o
		mov	eax, offset aFr_lu ; jumptable 0040C68D	case 5
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C6C1:				; CODE XREF: sub_40C244+449j
					; DATA XREF: .rdata:off_418630o
		mov	eax, offset aFr_mc ; jumptable 0040C68D	case 6
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C6CB:				; CODE XREF: sub_40C244+449j
					; DATA XREF: .rdata:off_418630o
		mov	eax, offset aFr	; jumptable 0040C68D case 7
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C6D5:				; CODE XREF: sub_40C244+449j
					; DATA XREF: .rdata:off_418630o
		mov	eax, offset aFr_re ; jumptable 0040C68D	case 8
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C6DF:				; CODE XREF: sub_40C244+449j
					; DATA XREF: .rdata:off_418630o
		mov	eax, offset aFr_cg ; jumptable 0040C68D	case 9
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C6E9:				; CODE XREF: sub_40C244+449j
					; DATA XREF: .rdata:off_418630o
		mov	eax, offset aFr_sn ; jumptable 0040C68D	case 10
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C6F3:				; CODE XREF: sub_40C244+449j
					; DATA XREF: .rdata:off_418630o
		mov	eax, offset aFr_cm ; jumptable 0040C68D	case 11
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C6FD:				; CODE XREF: sub_40C244+449j
					; DATA XREF: .rdata:off_418630o
		mov	eax, offset aFr_ci ; jumptable 0040C68D	case 12
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C707:				; CODE XREF: sub_40C244+449j
					; DATA XREF: .rdata:off_418630o
		mov	eax, offset aFr_ml ; jumptable 0040C68D	case 13
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C711:				; CODE XREF: sub_40C244+449j
					; DATA XREF: .rdata:off_418630o
		mov	eax, offset aFr_ma ; jumptable 0040C68D	case 14
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C71B:				; CODE XREF: sub_40C244+449j
					; DATA XREF: .rdata:off_418630o
		mov	eax, offset aFr_ht ; jumptable 0040C68D	case 15
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C725:				; CODE XREF: sub_40C244+436j
					; sub_40C244+449j
					; DATA XREF: ...
		mov	eax, offset aFr	; jumptable 0040C68D default case
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C72F:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aFy_nl ; jumptable 0040C300	case 98
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C739:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aFul_ng ; jumptable	0040C300 case 103
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C743:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, [ebp+var_1C] ; jumptable 0040C300 case 60
		cmp	eax, 1
		jz	short loc_40C752
		cmp	eax, 2
		jz	short loc_40C75C
		jmp	short loc_40C766
; ---------------------------------------------------------------------------

loc_40C752:				; CODE XREF: sub_40C244+505j
		mov	eax, offset aGd_gb ; "gd_GB"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C75C:				; CODE XREF: sub_40C244+50Aj
		mov	eax, offset aGa_ie ; "ga_IE"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C766:				; CODE XREF: sub_40C244+50Cj
		mov	eax, offset aC	; "C"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C770:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aGl_es ; jumptable 0040C300	case 86
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C77A:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aKa_ge ; jumptable 0040C300	case 55
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C784:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		cmp	[ebp+var_1C], 5	; jumptable 0040C300 case 7
		ja	short loc_40C7CB ; jumptable 0040C797 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_418670
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40C799:				; CODE XREF: sub_40C244+553j
					; DATA XREF: .rdata:off_418670o
		mov	eax, offset aDe_de ; jumptable 0040C797	case 1
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C7A3:				; CODE XREF: sub_40C244+553j
					; DATA XREF: .rdata:off_418670o
		mov	eax, offset aDe_ch ; jumptable 0040C797	case 2
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C7AD:				; CODE XREF: sub_40C244+553j
					; DATA XREF: .rdata:off_418670o
		mov	eax, offset aDe_at ; jumptable 0040C797	case 3
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C7B7:				; CODE XREF: sub_40C244+553j
					; DATA XREF: .rdata:off_418670o
		mov	eax, offset aDe_lu ; jumptable 0040C797	case 4
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C7C1:				; CODE XREF: sub_40C244+553j
					; DATA XREF: .rdata:off_418670o
		mov	eax, offset aDe_li ; jumptable 0040C797	case 5
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C7CB:				; CODE XREF: sub_40C244+544j
					; sub_40C244+553j
					; DATA XREF: ...
		mov	eax, offset aDe	; jumptable 0040C797 default case
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C7D5:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aEl_gr ; jumptable 0040C300	case 8
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C7DF:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aGn_py ; jumptable 0040C300	case 116
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C7E9:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aGu_in ; jumptable 0040C300	case 71
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C7F3:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aHa_ng ; jumptable 0040C300	case 104
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C7FD:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aCpe_us ; jumptable	0040C300 case 117
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C807:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aHe_il ; jumptable 0040C300	case 13
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C811:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aHi_in ; jumptable 0040C300	case 57
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C81B:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aHu_hu ; jumptable 0040C300	case 14
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C825:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aNic_ng ; jumptable	0040C300 case 105
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C82F:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aIs_is ; jumptable 0040C300	case 15
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C839:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aIbo_ng ; jumptable	0040C300 case 112
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C843:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aId_id ; jumptable 0040C300	case 33
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C84D:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aIu_ca ; jumptable 0040C300	case 93
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C857:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, [ebp+var_1C] ; jumptable 0040C300 case 16
		cmp	eax, 1
		jz	short loc_40C866
		cmp	eax, 2
		jz	short loc_40C870
		jmp	short loc_40C87A
; ---------------------------------------------------------------------------

loc_40C866:				; CODE XREF: sub_40C244+619j
		mov	eax, offset aIt_it ; "it_IT"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C870:				; CODE XREF: sub_40C244+61Ej
		mov	eax, offset aIt_ch ; "it_CH"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C87A:				; CODE XREF: sub_40C244+620j
		mov	eax, offset aIt	; "it"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C884:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aJa_jp ; jumptable 0040C300	case 17
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C88E:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aKn_in ; jumptable 0040C300	case 75
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C898:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aKau_ng ; jumptable	0040C300 case 113
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C8A2:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, [ebp+var_1C] ; jumptable 0040C300 case 96
		cmp	eax, 1
		jz	short loc_40C8B1
		cmp	eax, 2
		jz	short loc_40C8BB
		jmp	short loc_40C8C5
; ---------------------------------------------------------------------------

loc_40C8B1:				; CODE XREF: sub_40C244+664j
		mov	eax, offset aKs_pk ; "ks_PK"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C8BB:				; CODE XREF: sub_40C244+669j
		mov	eax, offset aKs_in ; "ks_IN"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C8C5:				; CODE XREF: sub_40C244+66Bj
		mov	eax, offset aKs	; "ks"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C8CF:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aKk_kz ; jumptable 0040C300	case 63
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C8D9:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aKok_in ; jumptable	0040C300 case 87
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C8E3:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aKo_kr ; jumptable 0040C300	case 18
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C8ED:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aKy_kg ; jumptable 0040C300	case 64
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C8F7:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aLo_la ; jumptable 0040C300	case 84
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C901:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aLa_va ; jumptable 0040C300	case 118
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C90B:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aLv_lv ; jumptable 0040C300	case 38
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C915:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aLt_lt ; jumptable 0040C300	case 39
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C91F:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aMk_mk ; jumptable 0040C300	case 47
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C929:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, [ebp+var_1C] ; jumptable 0040C300 case 62
		cmp	eax, 1
		jz	short loc_40C938
		cmp	eax, 2
		jz	short loc_40C942
		jmp	short loc_40C94C
; ---------------------------------------------------------------------------

loc_40C938:				; CODE XREF: sub_40C244+6EBj
		mov	eax, offset aMs_my ; "ms_MY"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C942:				; CODE XREF: sub_40C244+6F0j
		mov	eax, offset aMs_bn ; "ms_BN"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C94C:				; CODE XREF: sub_40C244+6F2j
		mov	eax, offset aMs	; "ms"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C956:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aMl_in ; jumptable 0040C300	case 76
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C960:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aMt_mt ; jumptable 0040C300	case 58
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C96A:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aMni_in ; jumptable	0040C300 case 88
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C974:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aMr_in ; jumptable 0040C300	case 78
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C97E:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aMn	; jumptable 0040C300 case 80
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C988:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, [ebp+var_1C] ; jumptable 0040C300 case 97
		cmp	eax, 1
		jz	short loc_40C997
		cmp	eax, 2
		jz	short loc_40C9A1
		jmp	short loc_40C9AB
; ---------------------------------------------------------------------------

loc_40C997:				; CODE XREF: sub_40C244+74Aj
		mov	eax, offset aNe_np ; "ne_NP"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C9A1:				; CODE XREF: sub_40C244+74Fj
		mov	eax, offset aNe_in ; "ne_IN"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C9AB:				; CODE XREF: sub_40C244+751j
		mov	eax, offset aNe	; "ne"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C9B5:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, [ebp+var_1C] ; jumptable 0040C300 case 20
		cmp	eax, 1
		jz	short loc_40C9C4
		cmp	eax, 2
		jz	short loc_40C9CE
		jmp	short loc_40C9D8
; ---------------------------------------------------------------------------

loc_40C9C4:				; CODE XREF: sub_40C244+777j
		mov	eax, offset aNo_no ; "no_NO"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C9CE:				; CODE XREF: sub_40C244+77Cj
		mov	eax, offset aNn_no ; "nn_NO"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C9D8:				; CODE XREF: sub_40C244+77Ej
		mov	eax, offset aNo	; "no"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C9E2:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aOr_in ; jumptable 0040C300	case 72
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C9EC:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aOm_et ; jumptable 0040C300	case 114
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40C9F6:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aPap_an ; jumptable	0040C300 case 121
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CA00:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aPs	; jumptable 0040C300 case 99
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CA0A:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aPl_pl ; jumptable 0040C300	case 21
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CA14:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, [ebp+var_1C] ; jumptable 0040C300 case 22
		cmp	eax, 1
		jz	short loc_40CA2B
		cmp	eax, 2
		jnz	short loc_40CA35
		mov	eax, offset aPt_pt ; "pt_PT"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CA2B:				; CODE XREF: sub_40C244+7D6j
		mov	eax, offset aPt_br ; "pt_BR"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CA35:				; CODE XREF: sub_40C244+7DBj
		mov	eax, offset aPt	; "pt"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CA3F:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, [ebp+var_1C] ; jumptable 0040C300 case 70
		cmp	eax, 1
		jnz	short loc_40CA51
		mov	eax, offset aPa_in ; "pa_IN"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CA51:				; CODE XREF: sub_40C244+801j
		mov	eax, offset aPa	; "pa"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CA5B:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aRm_ch ; jumptable 0040C300	case 23
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CA65:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, [ebp+var_1C] ; jumptable 0040C300 case 24
		cmp	eax, 1
		jnz	short loc_40CA77
		mov	eax, offset aRo_ro ; "ro_RO"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CA77:				; CODE XREF: sub_40C244+827j
		mov	eax, offset aRo	; "ro"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CA81:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aRu	; jumptable 0040C300 case 25
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CA8B:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aSe_no ; jumptable 0040C300	case 59
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CA95:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aSa_in ; jumptable 0040C300	case 79
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CA9F:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, [ebp+var_1C] ; jumptable 0040C300 case 89
		test	eax, eax
		jz	short loc_40CAAD
		cmp	eax, 1
		jz	short loc_40CAB7
		jmp	short loc_40CAC1
; ---------------------------------------------------------------------------

loc_40CAAD:				; CODE XREF: sub_40C244+860j
		mov	eax, offset aSd_in ; "sd_IN"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CAB7:				; CODE XREF: sub_40C244+865j
		mov	eax, offset aSd_pk ; "sd_PK"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CAC1:				; CODE XREF: sub_40C244+867j
		mov	eax, offset aSd	; "sd"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CACB:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aSi_lk ; jumptable 0040C300	case 91
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CAD5:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aSk_sk ; jumptable 0040C300	case 27
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CADF:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aSl_si ; jumptable 0040C300	case 36
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CAE9:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aSo_so ; jumptable 0040C300	case 119
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CAF3:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aWen_de ; jumptable	0040C300 case 46
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CAFD:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		cmp	[ebp+var_1C], 14h ; jumptable 0040C300 case 10
		ja	loc_40CBDE	; jumptable 0040CB14 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_418688
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40CB16:				; CODE XREF: sub_40C244+8D0j
					; DATA XREF: .rdata:off_418688o
		mov	eax, offset aEs_es ; jumptable 0040CB14	case 1
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CB20:				; CODE XREF: sub_40C244+8D0j
					; DATA XREF: .rdata:off_418688o
		mov	eax, offset aEs_mx ; jumptable 0040CB14	case 2
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CB2A:				; CODE XREF: sub_40C244+8D0j
					; DATA XREF: .rdata:off_418688o
		mov	eax, offset aEs_es@modern ; jumptable 0040CB14 case 3
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CB34:				; CODE XREF: sub_40C244+8D0j
					; DATA XREF: .rdata:off_418688o
		mov	eax, offset aEs_gt ; jumptable 0040CB14	case 4
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CB3E:				; CODE XREF: sub_40C244+8D0j
					; DATA XREF: .rdata:off_418688o
		mov	eax, offset aEs_cr ; jumptable 0040CB14	case 5
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CB48:				; CODE XREF: sub_40C244+8D0j
					; DATA XREF: .rdata:off_418688o
		mov	eax, offset aEs_pa ; jumptable 0040CB14	case 6
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CB52:				; CODE XREF: sub_40C244+8D0j
					; DATA XREF: .rdata:off_418688o
		mov	eax, offset aEs_do ; jumptable 0040CB14	case 7
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CB5C:				; CODE XREF: sub_40C244+8D0j
					; DATA XREF: .rdata:off_418688o
		mov	eax, offset aEs_ve ; jumptable 0040CB14	case 8
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CB66:				; CODE XREF: sub_40C244+8D0j
					; DATA XREF: .rdata:off_418688o
		mov	eax, offset aEs_co ; jumptable 0040CB14	case 9
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CB70:				; CODE XREF: sub_40C244+8D0j
					; DATA XREF: .rdata:off_418688o
		mov	eax, offset aEs_pe ; jumptable 0040CB14	case 10
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CB7A:				; CODE XREF: sub_40C244+8D0j
					; DATA XREF: .rdata:off_418688o
		mov	eax, offset aEs_ar ; jumptable 0040CB14	case 11
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CB84:				; CODE XREF: sub_40C244+8D0j
					; DATA XREF: .rdata:off_418688o
		mov	eax, offset aEs_ec ; jumptable 0040CB14	case 12
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CB8E:				; CODE XREF: sub_40C244+8D0j
					; DATA XREF: .rdata:off_418688o
		mov	eax, offset aEs_cl ; jumptable 0040CB14	case 13
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CB98:				; CODE XREF: sub_40C244+8D0j
					; DATA XREF: .rdata:off_418688o
		mov	eax, offset aEs_uy ; jumptable 0040CB14	case 14
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CBA2:				; CODE XREF: sub_40C244+8D0j
					; DATA XREF: .rdata:off_418688o
		mov	eax, offset aEs_py ; jumptable 0040CB14	case 15
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CBAC:				; CODE XREF: sub_40C244+8D0j
					; DATA XREF: .rdata:off_418688o
		mov	eax, offset aEs_bo ; jumptable 0040CB14	case 16
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CBB6:				; CODE XREF: sub_40C244+8D0j
					; DATA XREF: .rdata:off_418688o
		mov	eax, offset aEs_sv ; jumptable 0040CB14	case 17
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CBC0:				; CODE XREF: sub_40C244+8D0j
					; DATA XREF: .rdata:off_418688o
		mov	eax, offset aEs_hn ; jumptable 0040CB14	case 18
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CBCA:				; CODE XREF: sub_40C244+8D0j
					; DATA XREF: .rdata:off_418688o
		mov	eax, offset aEs_ni ; jumptable 0040CB14	case 19
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CBD4:				; CODE XREF: sub_40C244+8D0j
					; DATA XREF: .rdata:off_418688o
		mov	eax, offset aEs_pr ; jumptable 0040CB14	case 20
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CBDE:				; CODE XREF: sub_40C244+8BDj
					; sub_40C244+8D0j
					; DATA XREF: ...
		mov	eax, offset aEs	; jumptable 0040CB14 default case
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CBE8:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aBnt_tz ; jumptable	0040C300 case 48
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CBF2:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aSw_ke ; jumptable 0040C300	case 65
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CBFC:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, [ebp+var_1C] ; jumptable 0040C300 case 29
		cmp	eax, 1
		jz	short loc_40CC0B
		cmp	eax, 2
		jz	short loc_40CC15
		jmp	short loc_40CC1F
; ---------------------------------------------------------------------------

loc_40CC0B:				; CODE XREF: sub_40C244+9BEj
		mov	eax, offset aSv_se ; "sv_SE"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CC15:				; CODE XREF: sub_40C244+9C3j
		mov	eax, offset aSv_fi ; "sv_FI"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CC1F:				; CODE XREF: sub_40C244+9C5j
		mov	eax, offset aSv	; "sv"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CC29:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aSyr_tr ; jumptable	0040C300 case 90
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CC33:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aTl_ph ; jumptable 0040C300	case 100
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CC3D:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aTg_tj ; jumptable 0040C300	case 40
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CC47:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, [ebp+var_1C] ; jumptable 0040C300 case 95
		cmp	eax, 1
		jz	short loc_40CC56
		cmp	eax, 2
		jz	short loc_40CC60
		jmp	short loc_40CC6A
; ---------------------------------------------------------------------------

loc_40CC56:				; CODE XREF: sub_40C244+A09j
		mov	eax, offset aBer_ma@arabic ; "ber_MA@arabic"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CC60:				; CODE XREF: sub_40C244+A0Ej
		mov	eax, offset aBer_ma@latin ; "ber_MA@latin"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CC6A:				; CODE XREF: sub_40C244+A10j
		mov	eax, offset aBer_ma ; "ber_MA"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CC74:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aTa	; jumptable 0040C300 case 73
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CC7E:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aTt_ru ; jumptable 0040C300	case 68
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CC88:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aTe_in ; jumptable 0040C300	case 74
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CC92:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aTh_th ; jumptable 0040C300	case 30
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CC9C:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aBo_cn ; jumptable 0040C300	case 81
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CCA6:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, [ebp+var_1C] ; jumptable 0040C300 case 115
		test	eax, eax
		jz	short loc_40CCB4
		cmp	eax, 1
		jz	short loc_40CCBE
		jmp	short loc_40CCC8
; ---------------------------------------------------------------------------

loc_40CCB4:				; CODE XREF: sub_40C244+A67j
		mov	eax, offset aTi_et ; "ti_ET"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CCBE:				; CODE XREF: sub_40C244+A6Cj
		mov	eax, offset aTi_er ; "ti_ER"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CCC8:				; CODE XREF: sub_40C244+A6Ej
		mov	eax, offset aTi	; "ti"
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CCD2:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aTs_za ; jumptable 0040C300	case 49
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CCDC:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aTn_bw ; jumptable 0040C300	case 50
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CCE6:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aTr_tr ; jumptable 0040C300	case 31
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CCF0:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aTk_tm ; jumptable 0040C300	case 66
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CCFA:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aUk_ua ; jumptable 0040C300	case 34
		jmp	locret_40CD89
; ---------------------------------------------------------------------------

loc_40CD04:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, [ebp+var_1C] ; jumptable 0040C300 case 32
		cmp	eax, 1
		jz	short loc_40CD13
		cmp	eax, 2
		jz	short loc_40CD1A
		jmp	short loc_40CD21
; ---------------------------------------------------------------------------

loc_40CD13:				; CODE XREF: sub_40C244+AC6j
		mov	eax, offset aUr_pk ; "ur_PK"
		jmp	short locret_40CD89
; ---------------------------------------------------------------------------

loc_40CD1A:				; CODE XREF: sub_40C244+ACBj
		mov	eax, offset aUr_in ; "ur_IN"
		jmp	short locret_40CD89
; ---------------------------------------------------------------------------

loc_40CD21:				; CODE XREF: sub_40C244+ACDj
		mov	eax, offset aUr	; "ur"
		jmp	short locret_40CD89
; ---------------------------------------------------------------------------

loc_40CD28:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, [ebp+var_1C] ; jumptable 0040C300 case 67
		cmp	eax, 1
		jz	short loc_40CD37
		cmp	eax, 2
		jz	short loc_40CD3E
		jmp	short loc_40CD45
; ---------------------------------------------------------------------------

loc_40CD37:				; CODE XREF: sub_40C244+AEAj
		mov	eax, offset aUz_uz ; "uz_UZ"
		jmp	short locret_40CD89
; ---------------------------------------------------------------------------

loc_40CD3E:				; CODE XREF: sub_40C244+AEFj
		mov	eax, offset aUz_uz@cyrillic ; "uz_UZ@cyrillic"
		jmp	short locret_40CD89
; ---------------------------------------------------------------------------

loc_40CD45:				; CODE XREF: sub_40C244+AF1j
		mov	eax, offset aUz	; "uz"
		jmp	short locret_40CD89
; ---------------------------------------------------------------------------

loc_40CD4C:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aVen_za ; jumptable	0040C300 case 51
		jmp	short locret_40CD89
; ---------------------------------------------------------------------------

loc_40CD53:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aVi_vn ; jumptable 0040C300	case 42
		jmp	short locret_40CD89
; ---------------------------------------------------------------------------

loc_40CD5A:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aCy_gb ; jumptable 0040C300	case 82
		jmp	short locret_40CD89
; ---------------------------------------------------------------------------

loc_40CD61:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aXh_za ; jumptable 0040C300	case 52
		jmp	short locret_40CD89
; ---------------------------------------------------------------------------

loc_40CD68:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aSit_cn ; jumptable	0040C300 case 120
		jmp	short locret_40CD89
; ---------------------------------------------------------------------------

loc_40CD6F:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aYi_il ; jumptable 0040C300	case 61
		jmp	short locret_40CD89
; ---------------------------------------------------------------------------

loc_40CD76:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aYo_ng ; jumptable 0040C300	case 106
		jmp	short locret_40CD89
; ---------------------------------------------------------------------------

loc_40CD7D:				; CODE XREF: sub_40C244+BCj
					; DATA XREF: .rdata:off_4183A0o
		mov	eax, offset aZu_za ; jumptable 0040C300	case 53
		jmp	short locret_40CD89
; ---------------------------------------------------------------------------

loc_40CD84:				; CODE XREF: sub_40C244+A9j
					; sub_40C244+BCj
					; DATA XREF: ...
		mov	eax, offset aC	; jumptable 0040C300 default case

locret_40CD89:				; CODE XREF: sub_40C244+28j
					; sub_40C244+4Ej ...
		leave
		retn
sub_40C244	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CD8B	proc near		; CODE XREF: sub_40CE6A+1EAp
					; sub_40CE6A+212p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_0]
		and	eax, 0FF00h
		shl	eax, 8
		or	edx, eax
		mov	eax, [ebp+arg_0]
		shr	eax, 8
		and	eax, 0FF00h
		or	edx, eax
		mov	eax, [ebp+arg_0]
		shr	eax, 18h
		or	eax, edx
		pop	ebp
		retn
sub_40CD8B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CDBA	proc near		; CODE XREF: sub_40DA39+5Fp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	[ebp+var_4], 0
		jmp	short loc_40CE03
; ---------------------------------------------------------------------------

loc_40CDCF:				; CODE XREF: sub_40CDBA+51j
		shl	[ebp+var_4], 4
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		add	[ebp+var_4], eax
		add	[ebp+var_8], 1
		mov	eax, [ebp+var_4]
		and	eax, 0F0000000h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40CE03
		mov	eax, [ebp+var_C]
		shr	eax, 18h
		xor	[ebp+var_4], eax
		mov	eax, [ebp+var_C]
		xor	[ebp+var_4], eax

loc_40CE03:				; CODE XREF: sub_40CDBA+13j
					; sub_40CDBA+38j
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40CDCF
		mov	eax, [ebp+var_4]
		leave
		retn
sub_40CDBA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CE12	proc near		; CODE XREF: sub_40D40E+243p

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_C], eax
		jmp	short loc_40CE57
; ---------------------------------------------------------------------------

loc_40CE3E:				; CODE XREF: sub_40CE12+49j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_40CE57:				; CODE XREF: sub_40CE12+2Aj
		cmp	[ebp+var_C], 0
		jnz	short loc_40CE3E
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		leave
		retn
sub_40CE12	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40CE6A(char *)
sub_40CE6A	proc near		; CODE XREF: sub_40D40E+214p

Filename	= dword	ptr -68h
Mode		= dword	ptr -64h
Count		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= byte ptr -58h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
File		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
DstBuf		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 60h
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	eax, offset Mode ; "rb"
		mov	[esp+68h+Mode],	eax ; Mode
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_40CEA7
		mov	eax, 0
		jmp	loc_40D19E
; ---------------------------------------------------------------------------

loc_40CEA7:				; CODE XREF: sub_40CE6A+31j
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	_fileno
		lea	edx, [ebp+var_58]
		mov	[esp+68h+Mode],	edx
		mov	[esp+68h+Filename], eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		test	eax, eax
		jnz	short loc_40CEF0
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[ebp+var_20], eax
		mov	ecx, [ebp+var_20]
		mov	ebx, 0
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	esi, ebx
		xor	esi, edx
		xor	eax, ecx
		or	eax, esi
		test	eax, eax
		jnz	short loc_40CEF0
		cmp	[ebp+var_20], 1Bh
		ja	short loc_40CF05

loc_40CEF0:				; CODE XREF: sub_40CE6A+5Bj
					; sub_40CE6A+7Ej
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, 0
		jmp	loc_40D19E
; ---------------------------------------------------------------------------

loc_40CF05:				; CODE XREF: sub_40CE6A+84j
		mov	eax, [ebp+var_20]
		add	eax, eax
		cmp	eax, [ebp+var_20]
		jbe	short loc_40CF1E
		mov	eax, [ebp+var_20]
		add	eax, eax
		mov	[esp+68h+Filename], eax
		call	gcry_malloc
		jmp	short loc_40CF23
; ---------------------------------------------------------------------------

loc_40CF1E:				; CODE XREF: sub_40CE6A+A3j
		mov	eax, 0

loc_40CF23:				; CODE XREF: sub_40CE6A+B2j
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40CF41
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, 0
		jmp	loc_40D19E
; ---------------------------------------------------------------------------

loc_40CF41:				; CODE XREF: sub_40CE6A+C0j
		mov	eax, [ebp+var_20]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+DstBuf], eax

loc_40CF4D:				; CODE XREF: sub_40CE6A+13Fj
		mov	eax, [ebp+DstBuf]
		mov	edx, [ebp+File]
		mov	[esp+68h+var_5C], edx ;	File
		mov	edx, [ebp+var_C]
		mov	[esp+68h+Count], edx ; Count
		mov	[esp+68h+Mode],	1 ; ElementSize
		mov	[esp+68h+Filename], eax	; DstBuf
		call	fread
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_C]
		jnb	short loc_40CF99
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_40D19E
; ---------------------------------------------------------------------------

loc_40CF99:				; CODE XREF: sub_40CE6A+10Dj
		mov	eax, [ebp+var_24]
		add	[ebp+DstBuf], eax
		mov	eax, [ebp+var_24]
		sub	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40CF4D
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 950412DEh
		jz	short loc_40CFE3
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 0DE120495h
		jz	short loc_40CFE3
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_40D19E
; ---------------------------------------------------------------------------

loc_40CFE3:				; CODE XREF: sub_40CE6A+156j
					; sub_40CE6A+162j
		mov	[esp+68h+Mode],	28h
		mov	[esp+68h+Filename], 1
		call	gcry_calloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_40D015
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_40D19E
; ---------------------------------------------------------------------------

loc_40D015:				; CODE XREF: sub_40CE6A+194j
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_14]
		add	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 950412DEh
		setnz	al
		movzx	edx, al
		mov	eax, [ebp+var_18]
		mov	[eax+8], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40D05B
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[esp+68h+Filename], eax
		call	sub_40CD8B
		jmp	short loc_40D061
; ---------------------------------------------------------------------------

loc_40D05B:				; CODE XREF: sub_40CE6A+1DFj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]

loc_40D061:				; CODE XREF: sub_40CE6A+1EFj
		test	eax, eax
		jnz	loc_40D161
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40D083
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	[esp+68h+Filename], eax
		call	sub_40CD8B
		jmp	short loc_40D089
; ---------------------------------------------------------------------------

loc_40D083:				; CODE XREF: sub_40CE6A+207j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]

loc_40D089:				; CODE XREF: sub_40CE6A+217j
		mov	edx, [ebp+var_18]
		mov	[edx+0Ch], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40D0A9
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Filename], eax
		call	sub_40CD8B
		jmp	short loc_40D0AF
; ---------------------------------------------------------------------------

loc_40D0A9:				; CODE XREF: sub_40CE6A+22Dj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]

loc_40D0AF:				; CODE XREF: sub_40CE6A+23Dj
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+18h], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40D0D4
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]
		mov	[esp+68h+Filename], eax
		call	sub_40CD8B
		jmp	short loc_40D0DA
; ---------------------------------------------------------------------------

loc_40D0D4:				; CODE XREF: sub_40CE6A+258j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]

loc_40D0DA:				; CODE XREF: sub_40CE6A+268j
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40D0FF
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	[esp+68h+Filename], eax
		call	sub_40CD8B
		jmp	short loc_40D105
; ---------------------------------------------------------------------------

loc_40D0FF:				; CODE XREF: sub_40CE6A+283j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]

loc_40D105:				; CODE XREF: sub_40CE6A+293j
		mov	edx, [ebp+var_18]
		mov	[edx+20h], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40D125
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	[esp+68h+Filename], eax
		call	sub_40CD8B
		jmp	short loc_40D12B
; ---------------------------------------------------------------------------

loc_40D125:				; CODE XREF: sub_40CE6A+2A9j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]

loc_40D12B:				; CODE XREF: sub_40CE6A+2B9j
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+24h], edx
		nop
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Mode],	4
		mov	[esp+68h+Filename], eax
		call	gcry_calloc
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_40D19B
		jmp	short loc_40D17E
; ---------------------------------------------------------------------------

loc_40D161:				; CODE XREF: sub_40CE6A+1F9j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, 0
		jmp	short loc_40D19E
; ---------------------------------------------------------------------------

loc_40D17E:				; CODE XREF: sub_40CE6A+2F5j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, 0
		jmp	short loc_40D19E
; ---------------------------------------------------------------------------

loc_40D19B:				; CODE XREF: sub_40CE6A+2F3j
		mov	eax, [ebp+var_18]

loc_40D19E:				; CODE XREF: sub_40CE6A+38j
					; sub_40CE6A+96j ...
		add	esp, 60h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_40CE6A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D1A5(LPCSTR, int, int)
sub_40D1A5	proc near		; CODE XREF: sub_40D39C+1Ap

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpMultiByteStr	= dword	ptr -30h
cbMultiByte	= dword	ptr -2Ch
lpWideCharStr	= dword	ptr -28h
cchWideChar	= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+cchWideChar], 0 ; cchWideChar
		mov	[esp+38h+lpWideCharStr], 0 ; lpWideCharStr
		mov	[esp+38h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_40D1F5
		mov	eax, [ebp+var_C]
		add	eax, 1
		test	eax, eax
		jg	short loc_40D1FF

loc_40D1F5:				; CODE XREF: sub_40D1A5+44j
		mov	eax, 0
		jmp	locret_40D2A5
; ---------------------------------------------------------------------------

loc_40D1FF:				; CODE XREF: sub_40D1A5+4Ej
		mov	eax, [ebp+var_C]
		add	eax, 1
		add	eax, eax
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	edx, eax
		shr	edx, 1
		mov	eax, [ebp+var_C]
		add	eax, 1
		cmp	edx, eax
		jz	short loc_40D22F
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0
		jmp	short locret_40D2A5
; ---------------------------------------------------------------------------

loc_40D22F:				; CODE XREF: sub_40D1A5+74j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+CodePage], eax
		call	gcry_malloc
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40D24A
		mov	eax, 0
		jmp	short locret_40D2A5
; ---------------------------------------------------------------------------

loc_40D24A:				; CODE XREF: sub_40D1A5+9Cj
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[esp+38h+cchWideChar], edx ; cchWideChar
		mov	edx, [ebp+var_14]
		mov	[esp+38h+lpWideCharStr], edx ; lpWideCharStr
		mov	[esp+38h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_40D29A
		mov	eax, [ebp+var_14]
		mov	[esp+38h+CodePage], eax
		call	gcry_free
		mov	eax, 0
		jmp	short locret_40D2A5
; ---------------------------------------------------------------------------

loc_40D29A:				; CODE XREF: sub_40D1A5+E1j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_14]

locret_40D2A5:				; CODE XREF: sub_40D1A5+55j
					; sub_40D1A5+88j ...
		leave
		retn
sub_40D1A5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D2A7(LPCWSTR, int, int)
sub_40D2A7	proc near		; CODE XREF: sub_40D39C+3Cp

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpWideCharStr	= dword	ptr -30h
cchWideChar	= dword	ptr -2Ch
lpMultiByteStr	= dword	ptr -28h
cbMultiByte	= dword	ptr -24h
lpDefaultChar	= dword	ptr -20h
lpUsedDefaultChar= dword ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	[esp+38h+cbMultiByte], 0 ; cbMultiByte
		mov	[esp+38h+lpMultiByteStr], 0 ; lpMultiByteStr
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0 ;	CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_40D307
		mov	eax, [ebp+var_C]
		add	eax, 1
		test	eax, eax
		jg	short loc_40D311

loc_40D307:				; CODE XREF: sub_40D2A7+54j
		mov	eax, 0
		jmp	locret_40D39A
; ---------------------------------------------------------------------------

loc_40D311:				; CODE XREF: sub_40D2A7+5Ej
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+38h+CodePage], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40D32F
		mov	eax, 0
		jmp	short locret_40D39A
; ---------------------------------------------------------------------------

loc_40D32F:				; CODE XREF: sub_40D2A7+7Fj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	edx, [ebp+var_C]
		mov	[esp+38h+cbMultiByte], edx ; cbMultiByte
		mov	edx, [ebp+var_10]
		mov	[esp+38h+lpMultiByteStr], edx ;	lpMultiByteStr
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0 ;	CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_40D38F
		mov	eax, [ebp+var_10]
		mov	[esp+38h+CodePage], eax
		call	gcry_free
		mov	eax, 0
		jmp	short locret_40D39A
; ---------------------------------------------------------------------------

loc_40D38F:				; CODE XREF: sub_40D2A7+D4j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_10]

locret_40D39A:				; CODE XREF: sub_40D2A7+65j
					; sub_40D2A7+86j ...
		leave
		retn
sub_40D2A7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D39C(LPCSTR, int, int)
sub_40D39C	proc near		; CODE XREF: sub_40D6CE+12Fp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	LPCSTR
		call	sub_40D1A5
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40D3ED
		mov	eax, [ebp+var_14]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_20], edx ;	int
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	LPCWSTR
		call	sub_40D2A7
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		jmp	short loc_40D3F4
; ---------------------------------------------------------------------------

loc_40D3ED:				; CODE XREF: sub_40D39C+26j
		mov	[ebp+var_C], 0

loc_40D3F4:				; CODE XREF: sub_40D39C+4Fj
		cmp	[ebp+var_C], 0
		jz	short loc_40D3FF
		mov	eax, [ebp+var_14]
		jmp	short loc_40D404
; ---------------------------------------------------------------------------

loc_40D3FF:				; CODE XREF: sub_40D39C+5Cj
		mov	eax, 0

loc_40D404:				; CODE XREF: sub_40D39C+61j
		mov	edx, [ebp+arg_8]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40D39C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D40E(char *, char *)
sub_40D40E	proc near		; CODE XREF: sub_4060E4+16p

Dest		= dword	ptr -48h
Source		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Str		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		mov	[ebp+var_10], 0
		mov	[ebp+Str], 0
		mov	[esp+48h+Dest],	offset aLc_messages ; "LC_MESSAGES"
		call	sub_40C244
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_40D4A0
		mov	eax, [ebp+var_14]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+48h+Dest],	eax
		call	gcry_malloc
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jz	short loc_40D4A0
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	[esp+48h+Source], 5Fh ;	Val
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax ; Str
		call	strchr
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_40D4A0
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	0

loc_40D4A0:				; CODE XREF: sub_40D40E+29j
					; sub_40D40E+5Cj ...
		cmp	[ebp+Str], 0
		jnz	short loc_40D4B0
		mov	eax, 0
		jmp	loc_40D661
; ---------------------------------------------------------------------------

loc_40D4B0:				; CODE XREF: sub_40D40E+96j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+Str]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	ebx, eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 12h
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Dest],	eax
		call	gcry_malloc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_40D540
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_40D661
; ---------------------------------------------------------------------------

loc_40D540:				; CODE XREF: sub_40D40E+11Bj
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_24], 1
		mov	eax, [ebp+Str]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+Str]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_24], eax
		mov	edx, offset aLc_messages_0 ; "\\LC_MESSAGES\\"
		mov	eax, [ebp+var_24]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		movzx	edx, word ptr [edx+0Ch]
		mov	[eax+0Ch], dx
		add	[ebp+var_24], 0Dh
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_24], eax
		mov	edx, offset a_mo ; ".mo"
		mov	eax, [ebp+var_24]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	[esp+48h+Dest],	eax ; char *
		call	sub_40CE6A
		mov	[ebp+var_10], eax
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax
		call	gcry_free
		mov	eax, [ebp+var_20]
		mov	[esp+48h+Dest],	eax
		call	gcry_free
		mov	eax, ds:dword_41A1DC
		test	eax, eax
		jz	short loc_40D656
		mov	eax, ds:dword_41A1DC
		mov	[esp+48h+Dest],	eax
		call	sub_40CE12

loc_40D656:				; CODE XREF: sub_40D40E+239j
		mov	eax, [ebp+var_10]
		mov	ds:dword_41A1DC, eax
		mov	eax, [ebp+arg_4]

loc_40D661:				; CODE XREF: sub_40D40E+9Dj
					; sub_40D40E+12Dj
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40D40E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D668(char *, int, int)
sub_40D668	proc near		; CODE XREF: sub_40D6CE+35Bp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 1
		setnz	al
		movzx	eax, al
		mov	[ebp+var_C], eax
		jmp	short loc_40D6C3
; ---------------------------------------------------------------------------

loc_40D67D:				; CODE XREF: sub_40D668+5Fj
		mov	[esp+28h+Val], 0 ; Val
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		cmp	eax, [ebp+var_10]
		ja	short loc_40D6AA
		mov	eax, offset aErrorInGettext ; "ERROR in	GETTEXT	(bad plural entry)"
		jmp	short locret_40D6CC
; ---------------------------------------------------------------------------

loc_40D6AA:				; CODE XREF: sub_40D668+39j
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+arg_4], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_0], eax
		sub	[ebp+var_C], 1

loc_40D6C3:				; CODE XREF: sub_40D668+13j
		cmp	[ebp+var_C], 0
		jnz	short loc_40D67D
		mov	eax, [ebp+arg_0]

locret_40D6CC:				; CODE XREF: sub_40D668+40j
		leave
		retn
sub_40D668	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D6CE	proc near		; CODE XREF: sub_40DA39+158p
					; sub_40DA39+27Dp

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, ds:dword_41A1E0
		test	eax, eax
		jz	short loc_40D75A
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40D708
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_40CD8B
		jmp	short loc_40D719
; ---------------------------------------------------------------------------

loc_40D708:				; CODE XREF: sub_40D6CE+1Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_40D719:				; CODE XREF: sub_40D6CE+38j
		add	eax, ebx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40D742
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+38h+Dst], eax
		call	sub_40CD8B
		jmp	short loc_40D752
; ---------------------------------------------------------------------------

loc_40D742:				; CODE XREF: sub_40D6CE+58j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_40D752:				; CODE XREF: sub_40D6CE+72j
		mov	[ebp+var_14], eax
		jmp	loc_40DA09
; ---------------------------------------------------------------------------

loc_40D75A:				; CODE XREF: sub_40D6CE+Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_40D94F
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40D79C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_40CD8B
		jmp	short loc_40D7AD
; ---------------------------------------------------------------------------

loc_40D79C:				; CODE XREF: sub_40D6CE+B1j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_40D7AD:				; CODE XREF: sub_40D6CE+CCj
		add	eax, ebx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40D7D6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+38h+Dst], eax
		call	sub_40CD8B
		jmp	short loc_40D7E6
; ---------------------------------------------------------------------------

loc_40D7D6:				; CODE XREF: sub_40D6CE+ECj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_40D7E6:				; CODE XREF: sub_40D6CE+106j
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+var_28]
		mov	[esp+38h+Size],	eax ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Src], eax ; int
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dst], eax ; LPCSTR
		call	sub_40D39C
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_40D81E
		mov	[ebp+var_10], offset aErrorInGette_0 ; "ERROR in GETTEXT MALLOC"
		mov	[ebp+var_14], 0
		jmp	loc_40D93F
; ---------------------------------------------------------------------------

loc_40D81E:				; CODE XREF: sub_40D6CE+13Bj
		mov	eax, [ebp+var_28]
		cmp	eax, [ebp+var_1C]
		ja	loc_40D8B0
		mov	eax, [ebp+var_28]
		cmp	eax, 1
		jbe	short loc_40D8B0
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40D85D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_40CD8B
		jmp	short loc_40D86E
; ---------------------------------------------------------------------------

loc_40D85D:				; CODE XREF: sub_40D6CE+172j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_40D86E:				; CODE XREF: sub_40D6CE+18Dj
		add	eax, ebx
		mov	[ebp+var_24], eax
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_24]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	edx, eax
		mov	eax, [ebp+var_28]
		mov	[edx], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_14], eax
		jmp	loc_40D93F
; ---------------------------------------------------------------------------

loc_40D8B0:				; CODE XREF: sub_40D6CE+156j
					; sub_40D6CE+162j
		mov	eax, [ebp+var_28]
		add	eax, 10h
		mov	[esp+38h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40D931
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	dword ptr [eax], 1
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		jmp	short loc_40D93F
; ---------------------------------------------------------------------------

loc_40D931:				; CODE XREF: sub_40D6CE+1F7j
		mov	[ebp+var_10], offset aErrorInGette_0 ; "ERROR in GETTEXT MALLOC"
		mov	[ebp+var_14], 0

loc_40D93F:				; CODE XREF: sub_40D6CE+14Bj
					; sub_40D6CE+1DDj ...
		mov	eax, [ebp+var_20]
		mov	[esp+38h+Dst], eax
		call	gcry_free
		jmp	loc_40DA09
; ---------------------------------------------------------------------------

loc_40D94F:				; CODE XREF: sub_40D6CE+9Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		cmp	eax, 1
		jnz	short loc_40D9B5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_C], eax
		jmp	short loc_40D982
; ---------------------------------------------------------------------------

loc_40D96F:				; CODE XREF: sub_40D6CE+2B8j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, [ebp+arg_4]
		jz	short loc_40D98A
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_40D982:				; CODE XREF: sub_40D6CE+29Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_40D96F
		jmp	short loc_40D98B
; ---------------------------------------------------------------------------

loc_40D98A:				; CODE XREF: sub_40D6CE+2AAj
		nop

loc_40D98B:				; CODE XREF: sub_40D6CE+2BAj
		cmp	[ebp+var_C], 0
		jz	short loc_40D9A5
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		jmp	short loc_40DA09
; ---------------------------------------------------------------------------

loc_40D9A5:				; CODE XREF: sub_40D6CE+2C1j
		mov	[ebp+var_10], offset aErrorInGette_1 ; "ERROR in GETTEXT (overflow space)\n"
		mov	[ebp+var_14], 0
		jmp	short loc_40DA09
; ---------------------------------------------------------------------------

loc_40D9B5:				; CODE XREF: sub_40D6CE+294j
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40D9E0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_40CD8B
		jmp	short loc_40D9F1
; ---------------------------------------------------------------------------

loc_40D9E0:				; CODE XREF: sub_40D6CE+2F5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_40D9F1:				; CODE XREF: sub_40D6CE+310j
		add	eax, ebx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_40DA09:				; CODE XREF: sub_40D6CE+87j
					; sub_40D6CE+27Cj ...
		cmp	[ebp+arg_8], 0
		jz	short loc_40DA30
		cmp	[ebp+var_14], 0
		jz	short loc_40DA30
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+Size],	eax ; int
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Src], eax ; int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax ; char *
		call	sub_40D668
		jmp	short loc_40DA33
; ---------------------------------------------------------------------------

loc_40DA30:				; CODE XREF: sub_40D6CE+33Fj
					; sub_40D6CE+345j
		mov	eax, [ebp+var_10]

loc_40DA33:				; CODE XREF: sub_40D6CE+360j
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_40D6CE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40DA39(char *, int, int)
sub_40DA39	proc near		; CODE XREF: sub_40DCF4+1Cp
					; .text:0040DD33p ...

Str1		= dword	ptr -58h
Str2		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		mov	eax, ds:dword_41A1DC
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	loc_40DCCB
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		cmp	eax, 2
		jbe	loc_40DC04
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_40DC04
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax
		call	sub_40CDBA
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_18]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_20]
		mov	edx, 0
		div	ecx
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		lea	ecx, [eax-2]
		mov	eax, [ebp+var_20]
		mov	edx, 0
		div	ecx
		mov	eax, edx
		add	eax, 1
		mov	[ebp+var_24], eax
		jmp	loc_40DBC3
; ---------------------------------------------------------------------------

loc_40DAD3:				; CODE XREF: sub_40DA39+1C5j
		sub	[ebp+var_28], 1
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_28]
		jbe	loc_40DB9B
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40DB0A
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	sub_40CD8B
		jmp	short loc_40DB1A
; ---------------------------------------------------------------------------

loc_40DB0A:				; CODE XREF: sub_40DA39+B5j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_40DB1A:				; CODE XREF: sub_40DA39+CFj
		cmp	eax, [ebp+var_1C]
		jb	short loc_40DB9B
		mov	eax, [ebp+var_18]
		mov	ebx, [eax]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40DB49
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+58h+Str1],	eax
		call	sub_40CD8B
		jmp	short loc_40DB5A
; ---------------------------------------------------------------------------

loc_40DB49:				; CODE XREF: sub_40DA39+F3j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_40DB5A:				; CODE XREF: sub_40DA39+10Ej
		add	eax, ebx
		mov	[esp+58h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40DB9B
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	eax, al
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str1],	eax
		call	sub_40D6CE
		jmp	loc_40DCE5
; ---------------------------------------------------------------------------

loc_40DB9B:				; CODE XREF: sub_40DA39+A7j
					; sub_40DA39+E4j ...
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		sub	eax, [ebp+var_24]
		cmp	eax, [ebp+var_14]
		ja	short loc_40DBBD
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		mov	edx, [ebp+var_24]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+var_14], eax
		jmp	short loc_40DBC3
; ---------------------------------------------------------------------------

loc_40DBBD:				; CODE XREF: sub_40DA39+16Ej
		mov	eax, [ebp+var_24]
		add	[ebp+var_14], eax

loc_40DBC3:				; CODE XREF: sub_40DA39+95j
					; sub_40DA39+182j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40DBE7
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	sub_40CD8B
		jmp	short loc_40DBF7
; ---------------------------------------------------------------------------

loc_40DBE7:				; CODE XREF: sub_40DA39+192j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]

loc_40DBF7:				; CODE XREF: sub_40DA39+1ACj
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	loc_40DAD3

loc_40DC04:				; CODE XREF: sub_40DA39+23j
					; sub_40DA39+31j
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_C], eax
		jmp	loc_40DCBD
; ---------------------------------------------------------------------------

loc_40DC19:				; CODE XREF: sub_40DA39+28Aj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		shr	eax, 1
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_18]
		mov	ebx, [eax]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40DC50
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+58h+Str1],	eax
		call	sub_40CD8B
		jmp	short loc_40DC61
; ---------------------------------------------------------------------------

loc_40DC50:				; CODE XREF: sub_40DA39+1FAj
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_40DC61:				; CODE XREF: sub_40DA39+215j
		add	eax, ebx
		mov	[esp+58h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jns	short loc_40DC83
		mov	eax, [ebp+var_28]
		mov	[ebp+var_C], eax
		jmp	short loc_40DCBD
; ---------------------------------------------------------------------------

loc_40DC83:				; CODE XREF: sub_40DA39+240j
		cmp	[ebp+var_2C], 0
		jle	short loc_40DC94
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_40DCBD
; ---------------------------------------------------------------------------

loc_40DC94:				; CODE XREF: sub_40DA39+24Ej
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	eax, al
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str1],	eax
		call	sub_40D6CE
		jmp	short loc_40DCE5
; ---------------------------------------------------------------------------

loc_40DCBD:				; CODE XREF: sub_40DA39+1DBj
					; sub_40DA39+248j ...
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_C]
		jb	loc_40DC19
		jmp	short loc_40DCCC
; ---------------------------------------------------------------------------

loc_40DCCB:				; CODE XREF: sub_40DA39+14j
		nop

loc_40DCCC:				; CODE XREF: sub_40DA39+290j
		cmp	[ebp+arg_4], 0
		jz	short loc_40DCE2
		cmp	[ebp+arg_8], 1
		jnz	short loc_40DCDD
		mov	eax, [ebp+arg_0]
		jmp	short loc_40DCE0
; ---------------------------------------------------------------------------

loc_40DCDD:				; CODE XREF: sub_40DA39+29Dj
		mov	eax, [ebp+arg_4]

loc_40DCE0:				; CODE XREF: sub_40DA39+2A2j
		jmp	short loc_40DCE5
; ---------------------------------------------------------------------------

loc_40DCE2:				; CODE XREF: sub_40DA39+297j
		mov	eax, [ebp+arg_0]

loc_40DCE5:				; CODE XREF: sub_40DA39+15Dj
					; sub_40DA39+282j ...
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40DA39	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40DCF4(char *)
sub_40DCF4	proc near		; CODE XREF: sub_4015C2+3Dp
					; sub_4015C2+4Ep ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_10], 0 ; int
		mov	[esp+18h+var_14], 0 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_40DA39
		leave
		retn
sub_40DCF4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_40DA39
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40DA39
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp], offset	aLc_messages ; "LC_MESSAGES"
		call	sub_40C244
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40DD7B
		mov	eax, [ebp-0Ch]
		jmp	short locret_40DD80
; ---------------------------------------------------------------------------

loc_40DD7B:				; CODE XREF: .text:0040DD74j
		mov	eax, offset byte_41875F

locret_40DD80:				; CODE XREF: .text:0040DD79j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40DD82	proc near		; CODE XREF: sub_406101+Dp
					; sub_40611A+Dp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ds:dword_41A1E0, eax
		pop	ebp
		retn
sub_40DD82	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40DD90	proc near		; CODE XREF: sub_4019CB+F7p
					; sub_4019CB+1B9p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ds:dword_41A28C
		mov	[ebp+var_4], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_40DDAE
		mov	ds:dword_41A28C, 0

loc_40DDAE:				; CODE XREF: sub_40DD90+12j
		mov	eax, [ebp+var_4]
		leave
		retn
sub_40DD90	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_41A28C
		add	eax, 1
		mov	ds:dword_41A28C, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40DDC5(char *Filename, int FileHandle)
sub_40DDC5	proc near		; CODE XREF: sub_40E024+21p
					; .text:0040E060p

File		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Filename	= dword	ptr  8
FileHandle	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_40DE0F
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_40DE05
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_40DE05
		mov	eax, ds:File
		mov	[esp+28h+File],	eax ; File
		call	fclose

loc_40DE05:				; CODE XREF: sub_40DDC5+20j
					; sub_40DDC5+31j
		mov	ds:File, 0

loc_40DE0F:				; CODE XREF: sub_40DDC5+Fj
		cmp	[ebp+Filename],	0
		jz	short loc_40DE57
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset asc_418760 ; "-"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40DE57
		mov	[ebp+Filename],	0
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+28h+File],	eax ; File
		call	_fileno
		mov	[ebp+FileHandle], eax

loc_40DE57:				; CODE XREF: sub_40DDC5+4Ej
					; sub_40DDC5+76j
		cmp	[ebp+Filename],	0
		jz	short loc_40DEAD
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset aSocket ; "socket://"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40DE99
		mov	eax, [ebp+Filename]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40DE99
		mov	eax, 1
		jmp	short loc_40DE9E
; ---------------------------------------------------------------------------

loc_40DE99:				; CODE XREF: sub_40DDC5+BEj
					; sub_40DDC5+CBj
		mov	eax, 0

loc_40DE9E:				; CODE XREF: sub_40DDC5+D2j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40DEB4
		add	[ebp+Filename],	9
		jmp	short loc_40DEB4
; ---------------------------------------------------------------------------

loc_40DEAD:				; CODE XREF: sub_40DDC5+96j
		mov	[ebp+var_10], 0

loc_40DEB4:				; CODE XREF: sub_40DDC5+E0j
					; sub_40DDC5+E6j
		cmp	[ebp+var_10], 0
		jz	short loc_40DEF0
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aSystemDoesNotS ; "system does not support logging to a so"...
		mov	[esp+28h+var_1C], edx ;	File
		mov	[esp+28h+Count], 3Bh ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+File],	eax ; Str
		call	fwrite
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_40DF4B
; ---------------------------------------------------------------------------

loc_40DEF0:				; CODE XREF: sub_40DDC5+F3j
		cmp	[ebp+Filename],	0
		jz	short loc_40DF0F
		mov	eax, offset aA_0 ; "a"
		mov	[esp+28h+Size],	eax ; Mode
		mov	eax, [ebp+Filename]
		mov	[esp+28h+File],	eax ; Filename
		call	fopen
		mov	[ebp+var_C], eax
		jmp	short loc_40DF4B
; ---------------------------------------------------------------------------

loc_40DF0F:				; CODE XREF: sub_40DDC5+12Fj
		cmp	[ebp+FileHandle], 1
		jnz	short loc_40DF22
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[ebp+var_C], eax
		jmp	short loc_40DF4B
; ---------------------------------------------------------------------------

loc_40DF22:				; CODE XREF: sub_40DDC5+14Ej
		cmp	[ebp+FileHandle], 2
		jnz	short loc_40DF35
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_40DF4B
; ---------------------------------------------------------------------------

loc_40DF35:				; CODE XREF: sub_40DDC5+161j
		mov	[esp+28h+Size],	offset aA_0 ; "a"
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+File],	eax ; FileHandle
		call	_fdopen
		mov	[ebp+var_C], eax

loc_40DF4B:				; CODE XREF: sub_40DDC5+129j
					; sub_40DDC5+148j ...
		mov	dword_4160BC, 0FFFFFFFFh
		cmp	[ebp+var_C], 0
		jnz	loc_40DFE0
		cmp	[ebp+Filename],	0
		jz	short loc_40DF9D
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToOpenLo ; "failed to open log file `%s': %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+Filename]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		jmp	short loc_40DFD3
; ---------------------------------------------------------------------------

loc_40DF9D:				; CODE XREF: sub_40DDC5+19Ej
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToFdopen ; "failed to fdopen	file descriptor	%d: %s"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf

loc_40DFD3:				; CODE XREF: sub_40DDC5+1D6j
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_40E003
; ---------------------------------------------------------------------------

loc_40DFE0:				; CODE XREF: sub_40DDC5+194j
		mov	[esp+28h+var_1C], 0 ; Size
		mov	[esp+28h+Count], 40h ; Mode
		mov	[esp+28h+Size],	0 ; Buf
		mov	eax, [ebp+var_C]
		mov	[esp+28h+File],	eax ; File
		call	setvbuf

loc_40E003:				; CODE XREF: sub_40DDC5+219j
		mov	eax, [ebp+var_C]
		mov	ds:File, eax
		mov	eax, [ebp+var_10]
		mov	ds:dword_41A284, eax
		mov	ds:dword_41A288, 0
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40DDC5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40E024(char *)
sub_40E024	proc near		; CODE XREF: sub_40E1E6+19p

Filename	= dword	ptr -18h
FileHandle	= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_40E035
		mov	eax, [ebp+arg_0]
		jmp	short loc_40E03A
; ---------------------------------------------------------------------------

loc_40E035:				; CODE XREF: sub_40E024+Aj
		mov	eax, offset asc_418760 ; "-"

loc_40E03A:				; CODE XREF: sub_40E024+Fj
		mov	[esp+18h+FileHandle], 0FFFFFFFFh ; FileHandle
		mov	[esp+18h+Filename], eax	; Filename
		call	sub_40DDC5
		leave
		retn
sub_40E024	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_40DDC5
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_41A27C, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40E074(char *, int)
sub_40E074	proc near		; CODE XREF: sub_4019CB+39p

Dest		= dword	ptr -18h
Source		= dword	ptr -14h
Count		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_40E0A2
		mov	[esp+18h+Count], 4Fh ; Count
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Source], eax ;	Source
		mov	[esp+18h+Dest],	offset Dest ; Dest
		call	strncpy
		mov	ds:byte_41A26F,	0

loc_40E0A2:				; CODE XREF: sub_40E074+Aj
		mov	eax, [ebp+arg_4]
		and	eax, 1
		mov	ds:dword_41A274, eax
		mov	eax, [ebp+arg_4]
		and	eax, 2
		mov	ds:dword_41A270, eax
		mov	eax, [ebp+arg_4]
		and	eax, 4
		mov	ds:dword_41A278, eax
		mov	eax, [ebp+arg_4]
		and	eax, 100h
		mov	ds:dword_41A280, eax
		leave
		retn
sub_40E074	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_40E144
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0
		mov	eax, ds:dword_41A274
		test	eax, eax
		jz	short loc_40E0FC
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 1
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_40E0FC:				; CODE XREF: .text:0040E0EBj
		mov	eax, ds:dword_41A270
		test	eax, eax
		jz	short loc_40E114
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 2
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_40E114:				; CODE XREF: .text:0040E103j
		mov	eax, ds:dword_41A278
		test	eax, eax
		jz	short loc_40E12C
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 4
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_40E12C:				; CODE XREF: .text:0040E11Bj
		mov	eax, ds:dword_41A280
		test	eax, eax
		jz	short loc_40E144
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	dh, 1
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_40E144:				; CODE XREF: .text:0040E0D9j
					; .text:0040E133j
		mov	eax, offset Dest
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_40E17F
		mov	eax, ds:File
		mov	[esp], eax
		call	_fileno
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	short loc_40E17F
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_40E17F
		mov	eax, 1
		jmp	short locret_40E19F
; ---------------------------------------------------------------------------

loc_40E17F:				; CODE XREF: .text:0040E158j
					; .text:0040E16Ej ...
		mov	eax, dword_4160BC
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40E19A
		mov	eax, dword_4160BC
		cmp	eax, [ebp+8]
		jnz	short loc_40E19A
		mov	eax, 1
		jmp	short locret_40E19F
; ---------------------------------------------------------------------------

loc_40E19A:				; CODE XREF: .text:0040E187j
					; .text:0040E191j
		mov	eax, 0

locret_40E19F:				; CODE XREF: .text:0040E17Dj
					; .text:0040E198j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_40E1BA
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_40E1BF
; ---------------------------------------------------------------------------

loc_40E1BA:				; CODE XREF: .text:0040E1AEj
		mov	eax, ds:File

loc_40E1BF:				; CODE XREF: .text:0040E1B8j
		mov	[esp], eax
		call	_fileno
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_40E1DF
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_40E1E4
; ---------------------------------------------------------------------------

loc_40E1DF:				; CODE XREF: .text:0040E1D3j
		mov	eax, ds:File

loc_40E1E4:				; CODE XREF: .text:0040E1DDj
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40E1E6(int, char *Format, va_list ArgList)
sub_40E1E6	proc near		; CODE XREF: sub_40E569+22p
					; .text:0040E5ACp ...

var_58		= dword	ptr -58h
File		= dword	ptr -54h
Count		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
Format		= dword	ptr  0Ch
ArgList		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_40E229
		mov	[esp+58h+var_58], 0 ; char *
		call	sub_40E024
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_40E229
		mov	[esp+58h+Count], 1C3h ;	int
		mov	[esp+58h+File],	offset a____Gnupg22__3 ; "../../gnupg2-2.0.30/jnlib/logging.c"
		mov	[esp+58h+var_58], offset aLogstream ; "logstream"
		call	sub_415230

loc_40E229:				; CODE XREF: sub_40E1E6+10j
					; sub_40E1E6+25j
		mov	eax, ds:dword_41A288
		test	eax, eax
		jz	short loc_40E24D
		cmp	[ebp+arg_0], 1
		jz	short loc_40E24D
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_40E24D:				; CODE XREF: sub_40E1E6+4Aj
					; sub_40E1E6+50j
		mov	ds:dword_41A288, 0
		cmp	[ebp+arg_0], 1
		jz	loc_40E3E4
		mov	eax, ds:dword_41A270
		test	eax, eax
		jz	loc_40E2FD
		mov	eax, ds:dword_41A284
		test	eax, eax
		jnz	loc_40E2FD
		mov	[esp+58h+var_58], 0
		call	sub_415310
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_58], eax
		call	sub_415320
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	edx, [eax]
		mov	eax, [ebp+var_1C]
		mov	edi, [eax+4]
		mov	eax, [ebp+var_1C]
		mov	esi, [eax+8]
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax+0Ch]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+10h]
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+14h]
		add	eax, 76Ch
		mov	[ebp+var_30], eax
		mov	ecx, offset a04d02d02d02d02 ; "%04d-%02d-%02d %02d:%02d:%02d "
		mov	eax, ds:File
		mov	[esp+58h+var_3C], edx
		mov	[esp+58h+var_40], edi
		mov	[esp+58h+var_44], esi
		mov	[esp+58h+var_48], ebx
		mov	edx, [ebp+var_2C]
		mov	[esp+58h+var_4C], edx
		mov	edi, [ebp+var_30]
		mov	[esp+58h+Count], edi
		mov	[esp+58h+File],	ecx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_40E2FD:				; CODE XREF: sub_40E1E6+82j
					; sub_40E1E6+8Fj
		mov	eax, ds:dword_41A274
		test	eax, eax
		jnz	short loc_40E30F
		mov	eax, ds:dword_41A284
		test	eax, eax
		jz	short loc_40E326

loc_40E30F:				; CODE XREF: sub_40E1E6+11Ej
		mov	edx, ds:File
		mov	eax, offset Dest
		mov	[esp+58h+File],	edx ; File
		mov	[esp+58h+var_58], eax ;	Str
		call	fputs

loc_40E326:				; CODE XREF: sub_40E1E6+127j
		mov	eax, ds:dword_41A278
		test	eax, eax
		jnz	short loc_40E338
		mov	eax, ds:dword_41A284
		test	eax, eax
		jz	short loc_40E392

loc_40E338:				; CODE XREF: sub_40E1E6+147j
		mov	eax, ds:dword_41A27C
		test	eax, eax
		jz	short loc_40E371
		mov	eax, ds:dword_41A27C
		call	eax ; dword_41A27C
		mov	ebx, eax
		call	_getpid
		mov	ecx, eax
		mov	edx, offset aU_Lx ; "[%u.%lx]"
		mov	eax, ds:File
		mov	[esp+58h+var_4C], ebx
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_40E392
; ---------------------------------------------------------------------------

loc_40E371:				; CODE XREF: sub_40E1E6+159j
		call	_getpid
		mov	ecx, eax
		mov	edx, offset aU	; "[%u]"
		mov	eax, ds:File
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_40E392:				; CODE XREF: sub_40E1E6+150j
					; sub_40E1E6+189j
		mov	eax, ds:dword_41A270
		test	eax, eax
		jz	short loc_40E3A4
		mov	eax, ds:dword_41A284
		test	eax, eax
		jz	short loc_40E3B9

loc_40E3A4:				; CODE XREF: sub_40E1E6+1B3j
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 3Ah ;	Ch
		call	putc

loc_40E3B9:				; CODE XREF: sub_40E1E6+1BCj
		cmp	[ebp+Format], 0
		jz	short loc_40E3CF
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_40E3CF
		add	[ebp+Format], 1
		jmp	short loc_40E3E4
; ---------------------------------------------------------------------------

loc_40E3CF:				; CODE XREF: sub_40E1E6+1D7j
					; sub_40E1E6+1E1j
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 20h ;	Ch
		call	putc

loc_40E3E4:				; CODE XREF: sub_40E1E6+75j
					; sub_40E1E6+1E7j
		cmp	[ebp+arg_0], 7	; switch 8 cases
		ja	loc_40E478	; jumptable 0040E3FB default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_418890
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40E3FD:				; CODE XREF: sub_40E1E6+215j
					; DATA XREF: .rdata:off_418890o
		mov	edx, ds:File	; jumptable 0040E3FB case 5
		mov	eax, offset aFatal ; "Fatal: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 7 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_40E498
; ---------------------------------------------------------------------------

loc_40E426:				; CODE XREF: sub_40E1E6+215j
					; DATA XREF: .rdata:off_418890o
		mov	edx, ds:File	; jumptable 0040E3FB case 6
		mov	eax, offset aOhhhhJeeee	; "Ohhhh jeeee:	"
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 0Dh ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_40E498
; ---------------------------------------------------------------------------

loc_40E44F:				; CODE XREF: sub_40E1E6+215j
					; DATA XREF: .rdata:off_418890o
		mov	edx, ds:File	; jumptable 0040E3FB case 7
		mov	eax, offset aDbg ; "DBG: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 5 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_40E498
; ---------------------------------------------------------------------------

loc_40E478:				; CODE XREF: sub_40E1E6+202j
		mov	edx, offset aUnknownLogLeve ; jumptable	0040E3FB default case
		mov	eax, ds:File
		mov	ecx, [ebp+arg_0]
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_40E498
; ---------------------------------------------------------------------------

loc_40E497:				; CODE XREF: sub_40E1E6+215j
					; DATA XREF: .rdata:off_418890o
		nop			; jumptable 0040E3FB cases 0-4

loc_40E498:				; CODE XREF: sub_40E1E6+23Ej
					; sub_40E1E6+267j ...
		cmp	[ebp+Format], 0
		jz	short loc_40E508
		mov	eax, ds:File
		mov	edx, [ebp+ArgList]
		mov	[esp+58h+Count], edx ; ArgList
		mov	edx, [ebp+Format]
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	vfprintf
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40E4FB
		mov	eax, [ebp+Format]
		mov	[ebp+var_34], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_34]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_40E4FB
		mov	ds:dword_41A288, 1
		jmp	short loc_40E508
; ---------------------------------------------------------------------------

loc_40E4FB:				; CODE XREF: sub_40E1E6+2DBj
					; sub_40E1E6+307j
		mov	eax, ds:File
		mov	[esp+58h+var_58], eax ;	File
		call	fflush

loc_40E508:				; CODE XREF: sub_40E1E6+2B6j
					; sub_40E1E6+313j
		cmp	[ebp+arg_0], 5
		jnz	short loc_40E538
		mov	eax, ds:dword_41A288
		test	eax, eax
		jz	short loc_40E52C
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_40E52C:				; CODE XREF: sub_40E1E6+32Fj
		mov	[esp+58h+var_58], 2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_40E538:				; CODE XREF: sub_40E1E6+326j
		cmp	[ebp+arg_0], 6
		jnz	short loc_40E561
		mov	eax, ds:dword_41A288
		test	eax, eax
		jz	short loc_40E55C
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_40E55C:				; CODE XREF: sub_40E1E6+35Fj
		call	abort
; ---------------------------------------------------------------------------

loc_40E561:				; CODE XREF: sub_40E1E6+356j
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40E1E6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40E569(int, char *, char)
sub_40E569	proc near		; CODE XREF: sub_40E76C+2Ap

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_40E1E6
		leave
		retn
sub_40E569	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40E1E6
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40E5B3(char *, char)
sub_40E5B3	proc near		; CODE XREF: .text:00402A01p
					; sub_402B7E+168p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 2 ; int
		call	sub_40E1E6
		leave
		retn
sub_40E5B3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40E5DD(char *, char)
sub_40E5DD	proc near		; CODE XREF: sub_4016C2+56p
					; sub_4016C2+12Bp ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 4 ; int
		call	sub_40E1E6
		mov	eax, ds:dword_41A28C
		cmp	eax, 752Fh
		jg	short locret_40E61E
		mov	eax, ds:dword_41A28C
		add	eax, 1
		mov	ds:dword_41A28C, eax

locret_40E61E:				; CODE XREF: sub_40E5DD+32j
		leave
		retn
sub_40E5DD	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 5
		call	sub_40E1E6
		call	abort

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl sub_40E64D(char *, char)
sub_40E64D	proc near		; CODE XREF: sub_40E7A0+88p

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 6 ; int
		call	sub_40E1E6
		call	abort
sub_40E64D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40E67A(char *, char)
sub_40E67A	proc near		; CODE XREF: sub_4065C8+51p
					; sub_4065C8+103p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 7 ; int
		call	sub_40E1E6
		leave
		retn
sub_40E67A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40E6A4(char *, char)
sub_40E6A4	proc near		; CODE XREF: .text:0040E71Dp
					; .text:0040E740p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		cmp	[ebp+arg_0], 0
		setnz	al
		movzx	eax, al
		mov	[esp+28h+ArgList], edx ; ArgList
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+var_28], eax ;	int
		call	sub_40E1E6
		leave
		retn
sub_40E6A4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_40E6FD
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40E6FD
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_4188B0
		call	sub_40E67A

loc_40E6FD:				; CODE XREF: .text:0040E6DEj
					; .text:0040E6E8j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_40E758
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a02x_0 ; "%02X"
		call	sub_40E6A4
		sub	dword ptr [ebp+10h], 1
		add	dword ptr [ebp-0Ch], 1
		jmp	short loc_40E749
; ---------------------------------------------------------------------------

loc_40E72C:				; CODE XREF: .text:0040E756j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a02x_1 ; " %02X"
		call	sub_40E6A4
		add	dword ptr [ebp-0Ch], 1

loc_40E749:				; CODE XREF: .text:0040E72Aj
		cmp	dword ptr [ebp+10h], 0
		setnz	al
		sub	dword ptr [ebp+10h], 1
		test	al, al
		jnz	short loc_40E72C

loc_40E758:				; CODE XREF: .text:0040E701j
		cmp	dword ptr [ebp+8], 0
		jz	short locret_40E76A
		mov	dword ptr [esp], offset	asc_4188BF ; "\n"
		call	sub_40E6A4

locret_40E76A:				; CODE XREF: .text:0040E75Cj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_40E76C	proc near		; CODE XREF: .text:004035F5p
					; .text:004071F9p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_18], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_1C], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_20], eax	; char
		mov	[esp+28h+var_24], offset a___ThisIsABugS ; "...	this is	a bug (%s:%d:%s)\n"
		mov	[esp+28h+var_28], 6 ; int
		call	sub_40E569
		call	abort
sub_40E76C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E7A0	proc near		; CODE XREF: .text:0040ED61p
					; sub_40F6ED+1Cp

Code		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 8000h
		test	eax, eax
		jnz	short loc_40E82D
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+28h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+34h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, eax
		or	dh, 80h
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		test	eax, eax
		jns	short loc_40E82D
		mov	[esp+28h+Code],	offset aInvalidArgumen ; "invalid argument for arg_parsee\n"
		call	sub_40E64D
; ---------------------------------------------------------------------------

loc_40E82D:				; CODE XREF: sub_40E7A0+13j
					; sub_40E7A0+7Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_40EAE0
		cmp	dword ptr [ebp+arg_4], 0
		jz	loc_40E965
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFAh
		jnz	short loc_40E864
		mov	[esp+28h+Code],	offset aArgumentNotExp ; "argument not expected"
		call	sub_40DCF4
		mov	dword ptr [ebp+var_C], eax
		jmp	loc_40E93D
; ---------------------------------------------------------------------------

loc_40E864:				; CODE XREF: sub_40E7A0+AEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFBh
		jnz	short loc_40E883
		mov	[esp+28h+Code],	offset aReadError ; "read error"
		call	sub_40DCF4
		mov	dword ptr [ebp+var_C], eax
		jmp	loc_40E93D
; ---------------------------------------------------------------------------

loc_40E883:				; CODE XREF: sub_40E7A0+CDj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFCh
		jnz	short loc_40E8A2
		mov	[esp+28h+Code],	offset aKeywordTooLong ; "keyword too long"
		call	sub_40DCF4
		mov	dword ptr [ebp+var_C], eax
		jmp	loc_40E93D
; ---------------------------------------------------------------------------

loc_40E8A2:				; CODE XREF: sub_40E7A0+ECj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_40E8BE
		mov	[esp+28h+Code],	offset aMissingArgumen ; "missing argument"
		call	sub_40DCF4
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_40E93D
; ---------------------------------------------------------------------------

loc_40E8BE:				; CODE XREF: sub_40E7A0+10Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF4h
		jnz	short loc_40E8DA
		mov	[esp+28h+Code],	offset aInvalidArgum_0 ; "invalid argument"
		call	sub_40DCF4
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_40E93D
; ---------------------------------------------------------------------------

loc_40E8DA:				; CODE XREF: sub_40E7A0+127j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF9h
		jnz	short loc_40E8F6
		mov	[esp+28h+Code],	offset aInvalidCommand ; "invalid command"
		call	sub_40DCF4
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_40E93D
; ---------------------------------------------------------------------------

loc_40E8F6:				; CODE XREF: sub_40E7A0+143j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF6h
		jnz	short loc_40E912
		mov	[esp+28h+Code],	offset aInvalidAliasDe ; "invalid alias	definition"
		call	sub_40DCF4
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_40E93D
; ---------------------------------------------------------------------------

loc_40E912:				; CODE XREF: sub_40E7A0+15Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF5h
		jnz	short loc_40E92E
		mov	[esp+28h+Code],	offset aOutOfCore ; "out of core"
		call	sub_40DCF4
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_40E93D
; ---------------------------------------------------------------------------

loc_40E92E:				; CODE XREF: sub_40E7A0+17Bj
		mov	[esp+28h+Code],	offset aInvalidOption ;	"invalid option"
		call	sub_40DCF4
		mov	dword ptr [ebp+var_C], eax

loc_40E93D:				; CODE XREF: sub_40E7A0+BFj
					; sub_40E7A0+DEj ...
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	edx, dword ptr [ebp+var_C]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aSUS ; "%s:%u: %s\n"
		call	sub_40E5DD
		jmp	loc_40EABF
; ---------------------------------------------------------------------------

loc_40E965:				; CODE XREF: sub_40E7A0+9Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_40E977
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		jmp	short loc_40E97C
; ---------------------------------------------------------------------------

loc_40E977:				; CODE XREF: sub_40E7A0+1CDj
		mov	eax, offset a??	; "[??]"

loc_40E97C:				; CODE XREF: sub_40E7A0+1D5j
		mov	dword ptr [ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_40E9AA
		mov	[esp+28h+Code],	offset aMissingArgum_0 ; "missing argument for option \"%.50s\"\n"
		call	sub_40DCF4
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_40E5DD
		jmp	loc_40EABF
; ---------------------------------------------------------------------------

loc_40E9AA:				; CODE XREF: sub_40E7A0+1E8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF4h
		jnz	short loc_40E9D5
		mov	[esp+28h+Code],	offset aInvalidArgum_1 ; "invalid argument for option \"%.50s\"\n"
		call	sub_40DCF4
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_40E5DD
		jmp	loc_40EABF
; ---------------------------------------------------------------------------

loc_40E9D5:				; CODE XREF: sub_40E7A0+213j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFAh
		jnz	short loc_40EA00
		mov	[esp+28h+Code],	offset aOption_50sDoes ; "option \"%.50s\" does	not expect an arg"...
		call	sub_40DCF4
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_40E5DD
		jmp	loc_40EABF
; ---------------------------------------------------------------------------

loc_40EA00:				; CODE XREF: sub_40E7A0+23Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF9h
		jnz	short loc_40EA2B
		mov	[esp+28h+Code],	offset aInvalidComma_0 ; "invalid command \"%.50s\"\n"
		call	sub_40DCF4
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_40E5DD
		jmp	loc_40EABF
; ---------------------------------------------------------------------------

loc_40EA2B:				; CODE XREF: sub_40E7A0+269j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF8h
		jnz	short loc_40EA53
		mov	[esp+28h+Code],	offset aOption_50sIsAm ; "option \"%.50s\" is ambiguous\n"
		call	sub_40DCF4
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_40E5DD
		jmp	short loc_40EABF
; ---------------------------------------------------------------------------

loc_40EA53:				; CODE XREF: sub_40E7A0+294j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF8h
		jnz	short loc_40EA7B
		mov	[esp+28h+Code],	offset aCommand_50sIsA ; "command \"%.50s\" is ambiguous\n"
		call	sub_40DCF4
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_40E5DD
		jmp	short loc_40EABF
; ---------------------------------------------------------------------------

loc_40EA7B:				; CODE XREF: sub_40E7A0+2BCj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF5h
		jnz	short loc_40EAA4
		mov	[esp+28h+Code],	offset aOutOfCore_0 ; "out of core\n"
		call	sub_40DCF4
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aS ; "%s\n"
		call	sub_40E5DD
		jmp	short loc_40EABF
; ---------------------------------------------------------------------------

loc_40EAA4:				; CODE XREF: sub_40E7A0+2E4j
		mov	[esp+28h+Code],	offset aInvalidOption_ ; "invalid option \"%.50s\"\n"
		call	sub_40DCF4
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_40E5DD

loc_40EABF:				; CODE XREF: sub_40E7A0+1C0j
					; sub_40E7A0+205j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, 1
		jz	short loc_40EAD6
		mov	[esp+28h+Code],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_40EAD6:				; CODE XREF: sub_40E7A0+328j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0

loc_40EAE0:				; CODE XREF: sub_40E7A0+95j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		leave
		retn
sub_40E7A0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EAF6	proc near		; CODE XREF: .text:0040F04Cp
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_40EAF6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40EAFB(int, char *)
sub_40EAFB	proc near		; CODE XREF: sub_40EB41+11Cp
					; .text:0040EEA3p ...

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[ebp+var_C], eax
		jmp	short loc_40EB34
; ---------------------------------------------------------------------------

loc_40EB0C:				; CODE XREF: sub_40EAFB+3Dj
		mov	eax, [ebp+var_C]
		lea	edx, [eax+4]
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str2],	eax ; Str2
		mov	[esp+28h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40EB2C
		mov	eax, 1
		jmp	short locret_40EB3F
; ---------------------------------------------------------------------------

loc_40EB2C:				; CODE XREF: sub_40EAFB+28j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_40EB34:				; CODE XREF: sub_40EAFB+Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_40EB0C
		mov	eax, 0

locret_40EB3F:				; CODE XREF: sub_40EAFB+2Fj
		leave
		retn
sub_40EAFB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40EB41(int, FILE *)
sub_40EB41	proc near		; CODE XREF: .text:0040F34Dp

File		= dword	ptr -98h
Source		= dword	ptr -94h
var_80		= byte ptr -80h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 98h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		jmp	loc_40ECBD
; ---------------------------------------------------------------------------

loc_40EB64:				; CODE XREF: sub_40EB41+180j
		mov	eax, [ebp+arg_4]
		mov	[esp+98h+File],	eax ; File
		call	getc
		mov	[ebp+C], eax
		cmp	[ebp+C], 0Ah
		jnz	short loc_40EB81
		mov	[ebp+var_14], 1
		jmp	short loc_40EB95
; ---------------------------------------------------------------------------

loc_40EB81:				; CODE XREF: sub_40EB41+35j
		cmp	[ebp+C], 0FFFFFFFFh
		jnz	short loc_40EB95
		mov	[ebp+C], 0Ah
		mov	[ebp+var_14], 1

loc_40EB95:				; CODE XREF: sub_40EB41+3Ej
					; sub_40EB41+44j ...
		mov	eax, [ebp+var_18]
		cmp	eax, 1
		jz	short loc_40EBE2
		cmp	eax, 1
		jb	short loc_40EBB5
		cmp	eax, 2
		jz	short loc_40EC26
		cmp	eax, 3
		jz	loc_40EC47
		jmp	loc_40ECBD
; ---------------------------------------------------------------------------

loc_40EBB5:				; CODE XREF: sub_40EB41+5Fj
		mov	eax, [ebp+C]
		cmp	eax, 7Fh
		ja	short loc_40EBD2
		mov	eax, [ebp+C]
		mov	[esp+98h+File],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_40ECB9

loc_40EBD2:				; CODE XREF: sub_40EB41+7Aj
		mov	[ebp+var_10], 0
		mov	[ebp+var_18], 1
		jmp	short loc_40EB95
; ---------------------------------------------------------------------------

loc_40EBE2:				; CODE XREF: sub_40EB41+5Aj
		mov	eax, [ebp+C]
		mov	[esp+98h+File],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_40EBFC
		mov	[ebp+var_18], 3
		jmp	short loc_40EB95
; ---------------------------------------------------------------------------

loc_40EBFC:				; CODE XREF: sub_40EB41+B0j
		mov	eax, [ebp+var_10]
		cmp	eax, 62h
		ja	short loc_40EC1A
		mov	eax, [ebp+C]
		mov	edx, eax
		lea	eax, [ebp+var_80]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_40ECBD
; ---------------------------------------------------------------------------

loc_40EC1A:				; CODE XREF: sub_40EB41+C1j
		mov	[ebp+var_18], 2
		jmp	loc_40ECBD
; ---------------------------------------------------------------------------

loc_40EC26:				; CODE XREF: sub_40EB41+64j
		mov	eax, [ebp+C]
		mov	[esp+98h+File],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	loc_40ECBC
		mov	[ebp+var_18], 0
		jmp	loc_40EB95
; ---------------------------------------------------------------------------

loc_40EC47:				; CODE XREF: sub_40EB41+69j
		lea	eax, [ebp+var_80]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		lea	eax, [ebp+var_80]
		mov	[esp+98h+Source], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+File],	eax ; int
		call	sub_40EAFB
		test	eax, eax
		jnz	short loc_40ECAD
		mov	eax, [ebp+var_10]
		add	eax, 8
		mov	[esp+98h+File],	eax
		call	gcry_malloc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_40EC84
		mov	eax, 1
		jmp	short locret_40ECCC
; ---------------------------------------------------------------------------

loc_40EC84:				; CODE XREF: sub_40EB41+13Aj
		lea	eax, [ebp+var_80]
		mov	edx, [ebp+var_1C]
		add	edx, 4
		mov	[esp+98h+Source], eax ;	Source
		mov	[esp+98h+File],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+34h]
		mov	eax, [ebp+var_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_1C]
		mov	[eax+34h], edx

loc_40ECAD:				; CODE XREF: sub_40EB41+123j
		mov	[ebp+var_18], 0
		jmp	loc_40EB95
; ---------------------------------------------------------------------------

loc_40ECB9:				; CODE XREF: sub_40EB41+8Bj
		nop
		jmp	short loc_40ECBD
; ---------------------------------------------------------------------------

loc_40ECBC:				; CODE XREF: sub_40EB41+F4j
		nop

loc_40ECBD:				; CODE XREF: sub_40EB41+1Ej
					; sub_40EB41+6Fj ...
		cmp	[ebp+var_14], 0
		jz	loc_40EB64
		mov	eax, 0

locret_40ECCC:				; CODE XREF: sub_40EB41+141j
		leave
		retn
sub_40EB41	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40ECCE	proc near		; CODE XREF: .text:0040F194p

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[ebp+var_C], eax
		jmp	short loc_40ECF8
; ---------------------------------------------------------------------------

loc_40ECDF:				; CODE XREF: sub_40ECCE+2Ej
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_40ECF8:				; CODE XREF: sub_40ECCE+Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_40ECDF
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+34h], 0
		leave
		retn
sub_40ECCE	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 0C4h
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-20h], 0
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_40ED4D
		mov	eax, [ebp+18h]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_40F6ED
		jmp	loc_40F58C
; ---------------------------------------------------------------------------

loc_40ED4D:				; CODE XREF: .text:0040ED34j
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_40E7A0
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	short loc_40ED76
; ---------------------------------------------------------------------------

loc_40ED75:				; CODE XREF: .text:0040F1DDj
					; .text:0040F222j ...
		nop

loc_40ED76:				; CODE XREF: .text:0040ED73j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	getc
		mov	[ebp-2Ch], eax
		cmp	dword ptr [ebp-2Ch], 0Ah
		jz	short loc_40ED94
		cmp	dword ptr [ebp-2Ch], 0FFFFFFFFh
		jnz	loc_40F1D9

loc_40ED94:				; CODE XREF: .text:0040ED88j
		cmp	dword ptr [ebp-2Ch], 0FFFFFFFFh
		jz	short loc_40EDA7
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+10h]
		mov	[eax], edx

loc_40EDA7:				; CODE XREF: .text:0040ED98j
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	loc_40F582
		cmp	dword ptr [ebp-0Ch], 2
		jnz	loc_40EF3D
		lea	eax, [ebp-9Ch]
		add	eax, [ebp-10h]
		mov	byte ptr [eax],	0
		mov	dword ptr [ebp-10h], 0
		jmp	short loc_40EE06
; ---------------------------------------------------------------------------

loc_40EDD0:				; CODE XREF: .text:0040EE13j
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40EE02
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+4]
		lea	edx, [ebp-9Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcmp
		test	eax, eax
		jz	short loc_40EE17

loc_40EE02:				; CODE XREF: .text:0040EDDEj
		add	dword ptr [ebp-10h], 1

loc_40EE06:				; CODE XREF: .text:0040EDCEj
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40EDD0
		jmp	short loc_40EE18
; ---------------------------------------------------------------------------

loc_40EE17:				; CODE XREF: .text:0040EE00j
		nop

loc_40EE18:				; CODE XREF: .text:0040EE15j
		mov	eax, [ebp-10h]
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	edx, [eax]
		mov	eax, [ebp+14h]
		mov	[eax+10h], edx
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jz	short loc_40EE54
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	loc_40F57D
; ---------------------------------------------------------------------------

loc_40EE54:				; CODE XREF: .text:0040EE40j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_40EEEA
		mov	dword ptr [esp+4], offset aIgnoreInvalidO ; "ignore-invalid-option"
		lea	eax, [ebp-9Ch]
		mov	[esp], eax
		call	strcmp
		test	eax, eax
		jnz	short loc_40EE93
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	loc_40F57D
; ---------------------------------------------------------------------------

loc_40EE93:				; CODE XREF: .text:0040EE7Fj
		lea	eax, [ebp-9Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_40EAFB
		test	eax, eax
		jz	short loc_40EEBE
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	loc_40F57D
; ---------------------------------------------------------------------------

loc_40EEBE:				; CODE XREF: .text:0040EEAAj
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 80h
		test	eax, eax
		jz	short loc_40EEDA
		mov	eax, 0FFFFFFF9h
		jmp	short loc_40EEDF
; ---------------------------------------------------------------------------

loc_40EEDA:				; CODE XREF: .text:0040EED1j
		mov	eax, 0FFFFFFFEh

loc_40EEDF:				; CODE XREF: .text:0040EED8j
		mov	edx, [ebp+14h]
		mov	[edx+10h], eax
		jmp	loc_40F586
; ---------------------------------------------------------------------------

loc_40EEEA:				; CODE XREF: .text:0040EE61j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_40EF0C
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+14h], 0
		jmp	loc_40F586
; ---------------------------------------------------------------------------

loc_40EF0C:				; CODE XREF: .text:0040EEFBj
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_40EF2E
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+14h], 0
		jmp	loc_40F586
; ---------------------------------------------------------------------------

loc_40EF2E:				; CODE XREF: .text:0040EF1Dj
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_40F586
; ---------------------------------------------------------------------------

loc_40EF3D:				; CODE XREF: .text:0040EDB5j
		cmp	dword ptr [ebp-0Ch], 3
		jnz	short loc_40EFAB
		cmp	dword ptr [ebp-20h], 0
		jz	short loc_40EF58
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_40F586
; ---------------------------------------------------------------------------

loc_40EF58:				; CODE XREF: .text:0040EF47j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_40EF7A
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+14h], 0
		jmp	loc_40F586
; ---------------------------------------------------------------------------

loc_40EF7A:				; CODE XREF: .text:0040EF69j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_40EF9C
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+14h], 0
		jmp	loc_40F586
; ---------------------------------------------------------------------------

loc_40EF9C:				; CODE XREF: .text:0040EF8Bj
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_40F586
; ---------------------------------------------------------------------------

loc_40EFAB:				; CODE XREF: .text:0040EF41j
		cmp	dword ptr [ebp-0Ch], 4
		jnz	loc_40F188
		cmp	dword ptr [ebp-20h], 0
		jz	loc_40F056
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_40EFD4
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFAh
		jmp	loc_40F183
; ---------------------------------------------------------------------------

loc_40EFD4:				; CODE XREF: .text:0040EFC3j
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	byte ptr [eax],	0
		mov	dword ptr [esp+4], offset asc_418ABB ; " \t"
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	strpbrk
		mov	[ebp-24h], eax
		cmp	dword ptr [ebp-24h], 0
		jz	short loc_40F00E
		mov	eax, [ebp-24h]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-24h], 1
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	sub_410C00

loc_40F00E:				; CODE XREF: .text:0040EFF7j
		cmp	dword ptr [ebp-24h], 0
		jz	short loc_40F01E
		mov	eax, [ebp-24h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40F038

loc_40F01E:				; CODE XREF: .text:0040F012j
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	gcry_free
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFF6h
		jmp	loc_40F585
; ---------------------------------------------------------------------------

loc_40F038:				; CODE XREF: .text:0040F01Cj
		mov	eax, [ebp-24h]
		mov	[esp+8], eax
		mov	eax, [ebp-18h]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_40EAF6
		jmp	loc_40F183
; ---------------------------------------------------------------------------

loc_40F056:				; CODE XREF: .text:0040EFB9j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_40F078
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFAh
		jmp	loc_40F585
; ---------------------------------------------------------------------------

loc_40F078:				; CODE XREF: .text:0040F067j
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_40F0AD
		lea	eax, [ebp-9Ch]
		add	eax, [ebp-10h]
		mov	byte ptr [eax],	0
		lea	eax, [ebp-9Ch]
		mov	[esp], eax
		call	gcry_strdup
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_40F0B6
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	short loc_40F0B6
; ---------------------------------------------------------------------------

loc_40F0AD:				; CODE XREF: .text:0040F07Cj
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	byte ptr [eax],	0

loc_40F0B6:				; CODE XREF: .text:0040F09Fj
					; .text:0040F0ABj
		cmp	dword ptr [ebp-18h], 0
		jz	loc_40F585
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_410C00
		mov	eax, [ebp-18h]
		mov	[ebp-28h], eax
		mov	eax, [ebp-28h]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_40F149
		add	dword ptr [ebp-28h], 1
		mov	eax, [ebp-28h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40F149
		mov	eax, [ebp-28h]
		mov	dword ptr [ebp-0ACh], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0ACh]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp-28h]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_40F149
		mov	eax, [ebp-28h]
		mov	dword ptr [ebp-0ACh], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0ACh]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp-28h]
		mov	byte ptr [eax],	0

loc_40F149:				; CODE XREF: .text:0040F0D9j
					; .text:0040F0E7j ...
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		mov	edx, [ebp-28h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_40FEA2
		test	eax, eax
		jnz	loc_40F585
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	gcry_free
		jmp	loc_40F585
; ---------------------------------------------------------------------------

loc_40F183:				; CODE XREF: .text:0040EFCFj
					; .text:0040F051j
		jmp	loc_40F585
; ---------------------------------------------------------------------------

loc_40F188:				; CODE XREF: .text:0040EFAFj
		cmp	dword ptr [ebp-2Ch], 0FFFFFFFFh
		jnz	short loc_40F1C6
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_40ECCE
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	ferror
		test	eax, eax
		jz	short loc_40F1B7
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFBh
		jmp	loc_40F586
; ---------------------------------------------------------------------------

loc_40F1B7:				; CODE XREF: .text:0040F1A6j
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0
		jmp	loc_40F586
; ---------------------------------------------------------------------------

loc_40F1C6:				; CODE XREF: .text:0040F18Cj
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [ebp-10h], 0
		jmp	loc_40F57D
; ---------------------------------------------------------------------------

loc_40F1D9:				; CODE XREF: .text:0040ED8Ej
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	loc_40ED75
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40F206
		mov	eax, [ebp-2Ch]
		cmp	eax, 7Fh
		ja	short loc_40F206
		mov	eax, [ebp-2Ch]
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_40F57D

loc_40F206:				; CODE XREF: .text:0040F1E7j
					; .text:0040F1EFj
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40F21E
		cmp	dword ptr [ebp-2Ch], 23h
		jnz	short loc_40F21E
		mov	dword ptr [ebp-0Ch], 1
		jmp	loc_40F57D
; ---------------------------------------------------------------------------

loc_40F21E:				; CODE XREF: .text:0040F20Aj
					; .text:0040F210j
		cmp	dword ptr [ebp-0Ch], 1
		jz	loc_40ED75
		cmp	dword ptr [ebp-0Ch], 2
		jnz	loc_40F3E8
		mov	eax, [ebp-2Ch]
		cmp	eax, 7Fh
		ja	loc_40F3E8
		mov	eax, [ebp-2Ch]
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	loc_40F3E8
		lea	eax, [ebp-9Ch]
		add	eax, [ebp-10h]
		mov	byte ptr [eax],	0
		mov	dword ptr [ebp-10h], 0
		jmp	short loc_40F29E
; ---------------------------------------------------------------------------

loc_40F268:				; CODE XREF: .text:0040F2ABj
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40F29A
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+4]
		lea	edx, [ebp-9Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcmp
		test	eax, eax
		jz	short loc_40F2AF

loc_40F29A:				; CODE XREF: .text:0040F276j
		add	dword ptr [ebp-10h], 1

loc_40F29E:				; CODE XREF: .text:0040F266j
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40F268
		jmp	short loc_40F2B0
; ---------------------------------------------------------------------------

loc_40F2AF:				; CODE XREF: .text:0040F298j
		nop

loc_40F2B0:				; CODE XREF: .text:0040F2ADj
		mov	eax, [ebp-10h]
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	edx, [eax]
		mov	eax, [ebp+14h]
		mov	[eax+10h], edx
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jz	short loc_40F2E6
		mov	dword ptr [ebp-0Ch], 1
		jmp	loc_40F57D
; ---------------------------------------------------------------------------

loc_40F2E6:				; CODE XREF: .text:0040F2D8j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_40F3DC
		mov	dword ptr [esp+4], offset aAlias ; "alias"
		lea	eax, [ebp-9Ch]
		mov	[esp], eax
		call	strcmp
		test	eax, eax
		jnz	short loc_40F326
		mov	dword ptr [ebp-20h], 1
		mov	dword ptr [ebp-0Ch], 3
		jmp	loc_40F57D
; ---------------------------------------------------------------------------

loc_40F326:				; CODE XREF: .text:0040F311j
		mov	dword ptr [esp+4], offset aIgnoreInvalidO ; "ignore-invalid-option"
		lea	eax, [ebp-9Ch]
		mov	[esp], eax
		call	strcmp
		test	eax, eax
		jnz	short loc_40F384
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_40EB41
		test	eax, eax
		jz	short loc_40F365
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	loc_40F586
; ---------------------------------------------------------------------------

loc_40F365:				; CODE XREF: .text:0040F354j
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+10h]
		mov	[eax], edx
		jmp	loc_40F57D
; ---------------------------------------------------------------------------

loc_40F384:				; CODE XREF: .text:0040F33Ej
		lea	eax, [ebp-9Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_40EAFB
		test	eax, eax
		jz	short loc_40F3A9
		mov	dword ptr [ebp-0Ch], 1
		jmp	loc_40F57D
; ---------------------------------------------------------------------------

loc_40F3A9:				; CODE XREF: .text:0040F39Bj
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 80h
		test	eax, eax
		jz	short loc_40F3C5
		mov	eax, 0FFFFFFF9h
		jmp	short loc_40F3CA
; ---------------------------------------------------------------------------

loc_40F3C5:				; CODE XREF: .text:0040F3BCj
		mov	eax, 0FFFFFFFEh

loc_40F3CA:				; CODE XREF: .text:0040F3C3j
		mov	edx, [ebp+14h]
		mov	[edx+10h], eax
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jmp	loc_40F57D
; ---------------------------------------------------------------------------

loc_40F3DC:				; CODE XREF: .text:0040F2F3j
		mov	dword ptr [ebp-0Ch], 3
		jmp	loc_40F57D
; ---------------------------------------------------------------------------

loc_40F3E8:				; CODE XREF: .text:0040F22Cj
					; .text:0040F238j ...
		cmp	dword ptr [ebp-0Ch], 3
		jnz	short loc_40F432
		mov	eax, [ebp-2Ch]
		cmp	eax, 7Fh
		ja	short loc_40F40B
		mov	eax, [ebp-2Ch]
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_40ED75

loc_40F40B:				; CODE XREF: .text:0040F3F4j
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-2Ch]
		mov	edx, eax
		lea	eax, [ebp-9Ch]
		add	eax, [ebp-10h]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		mov	dword ptr [ebp-0Ch], 4
		jmp	loc_40ED75
; ---------------------------------------------------------------------------

loc_40F432:				; CODE XREF: .text:0040F3ECj
		cmp	dword ptr [ebp-0Ch], 4
		jnz	loc_40F53F
		cmp	dword ptr [ebp-18h], 0
		jz	short loc_40F4C1
		mov	eax, [ebp-10h]
		mov	edx, [ebp-1Ch]
		sub	edx, 1
		cmp	eax, edx
		jnb	short loc_40F463
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	edx, [ebp-2Ch]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		jmp	loc_40ED75
; ---------------------------------------------------------------------------

loc_40F463:				; CODE XREF: .text:0040F44Dj
		mov	eax, [ebp-1Ch]
		add	eax, 32h
		mov	[ebp-30h], eax
		mov	eax, [ebp-30h]
		mov	[esp+4], eax
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	gcry_realloc
		mov	[ebp-34h], eax
		cmp	dword ptr [ebp-34h], 0
		jz	short loc_40F4A7
		mov	eax, [ebp-30h]
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-34h]
		mov	[ebp-18h], eax
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	edx, [ebp-2Ch]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		jmp	loc_40ED75
; ---------------------------------------------------------------------------

loc_40F4A7:				; CODE XREF: .text:0040F485j
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	gcry_free
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	loc_40F586
; ---------------------------------------------------------------------------

loc_40F4C1:				; CODE XREF: .text:0040F440j
		mov	eax, [ebp-10h]
		cmp	eax, 62h
		ja	short loc_40F4E2
		mov	eax, [ebp-2Ch]
		mov	edx, eax
		lea	eax, [ebp-9Ch]
		add	eax, [ebp-10h]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		jmp	loc_40ED75
; ---------------------------------------------------------------------------

loc_40F4E2:				; CODE XREF: .text:0040F4C7j
		mov	dword ptr [ebp-38h], 96h
		mov	eax, [ebp-38h]
		mov	[esp], eax
		call	gcry_malloc
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jz	short loc_40F533
		mov	eax, [ebp-38h]
		mov	[ebp-1Ch], eax
		mov	ecx, [ebp-10h]
		lea	edx, [ebp-9Ch]
		mov	eax, [ebp-18h]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	edx, [ebp-2Ch]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		jmp	loc_40ED75
; ---------------------------------------------------------------------------

loc_40F533:				; CODE XREF: .text:0040F4FBj
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	short loc_40F586
; ---------------------------------------------------------------------------

loc_40F53F:				; CODE XREF: .text:0040F436j
		mov	eax, [ebp-10h]
		cmp	eax, 62h
		jbe	short loc_40F55D
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFCh
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jmp	loc_40ED75
; ---------------------------------------------------------------------------

loc_40F55D:				; CODE XREF: .text:0040F545j
		mov	eax, [ebp-2Ch]
		mov	edx, eax
		lea	eax, [ebp-9Ch]
		add	eax, [ebp-10h]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		mov	dword ptr [ebp-0Ch], 2
		jmp	loc_40ED75
; ---------------------------------------------------------------------------

loc_40F57D:				; CODE XREF: .text:0040EE4Fj
					; .text:0040EE8Ej ...
		jmp	loc_40ED75
; ---------------------------------------------------------------------------

loc_40F582:				; CODE XREF: .text:0040EDABj
		nop
		jmp	short loc_40F586
; ---------------------------------------------------------------------------

loc_40F585:				; CODE XREF: .text:0040F033j
					; .text:0040F073j ...
		nop

loc_40F586:				; CODE XREF: .text:0040EEE5j
					; .text:0040EF07j ...
		mov	eax, [ebp+14h]
		mov	eax, [eax+10h]

loc_40F58C:				; CODE XREF: .text:0040ED48j
		add	esp, 0C4h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40F595(int, int, char	*)
sub_40F595	proc near		; CODE XREF: sub_40F6ED+182p

Str1		= dword	ptr -38h
Str2		= dword	ptr -34h
MaxCount	= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40F5B0
		mov	eax, 0FFFFFFFFh
		jmp	loc_40F6E7
; ---------------------------------------------------------------------------

loc_40F5B0:				; CODE XREF: sub_40F595+Fj
		mov	[ebp+var_C], 0
		jmp	short loc_40F5F4
; ---------------------------------------------------------------------------

loc_40F5B9:				; CODE XREF: sub_40F595+6Cj
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40F5F0
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40F5F0
		mov	eax, [ebp+var_C]
		jmp	loc_40F6E7
; ---------------------------------------------------------------------------

loc_40F5F0:				; CODE XREF: sub_40F595+32j
					; sub_40F595+51j
		add	[ebp+var_C], 1

loc_40F5F4:				; CODE XREF: sub_40F595+22j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40F5B9
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	loc_40F6CF
; ---------------------------------------------------------------------------

loc_40F631:				; CODE XREF: sub_40F595+147j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	loc_40F6CB
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[esp+38h+MaxCount], edx	; MaxCount
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_40F6CB
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_40F6B7
; ---------------------------------------------------------------------------

loc_40F676:				; CODE XREF: sub_40F595+12Fj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40F6B3
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[esp+38h+MaxCount], edx	; MaxCount
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_40F6B3
		mov	eax, 0FFFFFFFEh
		jmp	short loc_40F6E7
; ---------------------------------------------------------------------------

loc_40F6B3:				; CODE XREF: sub_40F595+EFj
					; sub_40F595+115j
		add	[ebp+var_10], 1

loc_40F6B7:				; CODE XREF: sub_40F595+DFj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40F676
		mov	eax, [ebp+var_C]
		jmp	short loc_40F6E7
; ---------------------------------------------------------------------------

loc_40F6CB:				; CODE XREF: sub_40F595+AAj
					; sub_40F595+D4j
		add	[ebp+var_C], 1

loc_40F6CF:				; CODE XREF: sub_40F595+97j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_40F631
		mov	eax, 0FFFFFFFFh

loc_40F6E7:				; CODE XREF: sub_40F595+16j
					; sub_40F595+56j ...
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_40F595	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F6ED	proc near		; CODE XREF: sub_4019CB+E3p
					; .text:0040ED43p

Str		= dword	ptr -38h
Val		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+Count], 0
		mov	[esp+38h+Val], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_40E7A0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40F751
		cmp	[ebp+var_10], 0
		jz	short loc_40F751
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 10h
		test	eax, eax
		jnz	short loc_40F751
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1

loc_40F751:				; CODE XREF: sub_40F6ED+43j
					; sub_40F6ED+49j ...
		cmp	[ebp+var_10], 0
		jnz	short loc_40F766
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		jmp	loc_40FE7C
; ---------------------------------------------------------------------------

loc_40F766:				; CODE XREF: sub_40F6ED+68j
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+28h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_40F7BC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 2
		test	eax, eax
		jz	short loc_40F7BC
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_40FE7C
; ---------------------------------------------------------------------------

loc_40F7BC:				; CODE XREF: sub_40F6ED+92j
					; sub_40F6ED+9Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_40F7D5
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		jmp	loc_40FE7C
; ---------------------------------------------------------------------------

loc_40F7D5:				; CODE XREF: sub_40F6ED+D7j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	loc_40FB57
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	loc_40FB57
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+var_18]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40F833
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jnz	short loc_40F833
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 1
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_40F751
; ---------------------------------------------------------------------------

loc_40F833:				; CODE XREF: sub_40F6ED+11Cj
					; sub_40F6ED+129j
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], 3Dh ; Val
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jz	short loc_40F858
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	0

loc_40F858:				; CODE XREF: sub_40F6ED+163j
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Count], eax ; char *
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_40F595
		mov	[ebp+var_20], eax
		cmp	[ebp+var_28], 0
		jz	short loc_40F883
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	3Dh

loc_40F883:				; CODE XREF: sub_40F6ED+18Ej
		cmp	[ebp+var_20], 0
		jns	short loc_40F8BD
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset Str1 ; "help"
		call	strcmp
		test	eax, eax
		jnz	short loc_40F8BD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax
		call	sub_4100D8
; ---------------------------------------------------------------------------
		jmp	loc_40F9F8
; ---------------------------------------------------------------------------

loc_40F8BD:				; CODE XREF: sub_40F6ED+19Aj
					; sub_40F6ED+1B4j
		cmp	[ebp+var_20], 0
		jns	short loc_40F8FF
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aVersion ; "version"
		call	strcmp
		test	eax, eax
		jnz	short loc_40F8FF
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jnz	loc_40F9F8
		call	sub_410643
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_40F8FF:				; CODE XREF: sub_40F6ED+1D4j
					; sub_40F6ED+1EEj
		cmp	[ebp+var_20], 0
		jns	short loc_40F93F
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aWarranty	; "warranty"
		call	strcmp
		test	eax, eax
		jnz	short loc_40F93F
		mov	[esp+38h+Str], 10h
		call	sub_4108F9
		mov	[esp+38h+Str], eax ; Str
		call	puts
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_40F93F:				; CODE XREF: sub_40F6ED+216j
					; sub_40F6ED+230j
		cmp	[ebp+var_20], 0
		jns	loc_40F9F8
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aDumpOptions ; "dump-options"
		call	strcmp
		test	eax, eax
		jnz	loc_40F9F8
		mov	[ebp+var_20], 0
		jmp	short loc_40F9B4
; ---------------------------------------------------------------------------

loc_40F970:				; CODE XREF: sub_40F6ED+2D4j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40F9B0
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jnz	short loc_40F9B0
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, offset aS_0 ; "--%s\n"
		mov	[esp+38h+Val], edx
		mov	[esp+38h+Str], eax ; Format
		call	printf

loc_40F9B0:				; CODE XREF: sub_40F6ED+291j
					; sub_40F6ED+2A4j
		add	[ebp+var_20], 1

loc_40F9B4:				; CODE XREF: sub_40F6ED+281j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40F970
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aDumpOptionsHel ; "--dump-options\n--help\n--version\n--wa"...
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 2Bh ; Count
		mov	[esp+38h+Val], 1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_40F9F8:				; CODE XREF: sub_40F6ED+1CBj
					; sub_40F6ED+1FBj ...
		cmp	[ebp+var_20], 0FFFFFFFEh
		jnz	short loc_40FA0A
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF8h
		jmp	short loc_40FA39
; ---------------------------------------------------------------------------

loc_40FA0A:				; CODE XREF: sub_40F6ED+30Fj
		cmp	[ebp+var_20], 0FFFFFFFFh
		jnz	short loc_40FA28
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFEh
		mov	eax, [ebp+var_18]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_0]
		mov	[eax+18h], edx
		jmp	short loc_40FA39
; ---------------------------------------------------------------------------

loc_40FA28:				; CODE XREF: sub_40F6ED+321j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx

loc_40FA39:				; CODE XREF: sub_40F6ED+31Bj
					; sub_40F6ED+339j
		cmp	[ebp+var_20], 0
		js	loc_40FB46
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jz	loc_40FB27
		cmp	[ebp+var_28], 0
		jz	short loc_40FA7C
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40FA85
		mov	[ebp+var_1C], 0
		jmp	short loc_40FA85
; ---------------------------------------------------------------------------

loc_40FA7C:				; CODE XREF: sub_40F6ED+371j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], eax

loc_40FA85:				; CODE XREF: sub_40F6ED+384j
					; sub_40F6ED+38Dj
		cmp	[ebp+var_1C], 0
		jnz	short loc_40FAAD
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_40FAAD
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	loc_40FB46
; ---------------------------------------------------------------------------

loc_40FAAD:				; CODE XREF: sub_40F6ED+39Cj
					; sub_40F6ED+3AFj
		cmp	[ebp+var_1C], 0
		jnz	short loc_40FAC2
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_40FB45
; ---------------------------------------------------------------------------

loc_40FAC2:				; CODE XREF: sub_40F6ED+3C4j
		cmp	[ebp+var_28], 0
		jnz	short loc_40FAF1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_40FAF1
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_40FAF1
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_40FB46
; ---------------------------------------------------------------------------

loc_40FAF1:				; CODE XREF: sub_40F6ED+3D9j
					; sub_40F6ED+3E3j ...
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_40FEA2
		cmp	[ebp+var_28], 0
		jnz	short loc_40FB45
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_40FB45
; ---------------------------------------------------------------------------

loc_40FB27:				; CODE XREF: sub_40F6ED+367j
		cmp	[ebp+var_28], 0
		jz	short loc_40FB39
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0FFFFFFFAh
		jmp	short loc_40FB46
; ---------------------------------------------------------------------------

loc_40FB39:				; CODE XREF: sub_40F6ED+43Ej
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_40FB46
; ---------------------------------------------------------------------------

loc_40FB45:				; CODE XREF: sub_40F6ED+3D0j
					; sub_40F6ED+42Aj ...
		nop

loc_40FB46:				; CODE XREF: sub_40F6ED+350j
					; sub_40F6ED+3BBj ...
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_40FE7C
; ---------------------------------------------------------------------------

loc_40FB57:				; CODE XREF: sub_40F6ED+F0j
					; sub_40F6ED+101j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_40FB6E
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40FB7C

loc_40FB6E:				; CODE XREF: sub_40F6ED+472j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	loc_40FE34

loc_40FB7C:				; CODE XREF: sub_40F6ED+47Fj
		mov	[ebp+var_24], 0
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_40FC07
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 20h
		test	eax, eax
		jz	short loc_40FC07
		mov	[ebp+var_20], 0
		jmp	short loc_40FBF8
; ---------------------------------------------------------------------------

loc_40FBB9:				; CODE XREF: sub_40F6ED+518j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40FBF4
		mov	eax, [ebp+var_18]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	[esp+38h+Val], edx ; Str2
		mov	[esp+38h+Str], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40FBF4
		mov	[ebp+var_24], 1
		jmp	short loc_40FC07
; ---------------------------------------------------------------------------

loc_40FBF4:				; CODE XREF: sub_40F6ED+4DAj
					; sub_40F6ED+4FCj
		add	[ebp+var_20], 1

loc_40FBF8:				; CODE XREF: sub_40F6ED+4CAj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40FBB9

loc_40FC07:				; CODE XREF: sub_40F6ED+4A5j
					; sub_40F6ED+4C1j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		add	[ebp+var_18], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_40FC4D
		mov	[ebp+var_20], 0
		jmp	short loc_40FC3B
; ---------------------------------------------------------------------------

loc_40FC1F:				; CODE XREF: sub_40F6ED+55Bj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	edx, eax
		jz	short loc_40FC4C
		add	[ebp+var_20], 1

loc_40FC3B:				; CODE XREF: sub_40F6ED+530j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40FC1F
		jmp	short loc_40FC4D
; ---------------------------------------------------------------------------

loc_40FC4C:				; CODE XREF: sub_40F6ED+548j
		nop

loc_40FC4D:				; CODE XREF: sub_40F6ED+527j
					; sub_40F6ED+55Dj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40FC85
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 68h
		jz	short loc_40FC70
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Fh
		jnz	short loc_40FC85

loc_40FC70:				; CODE XREF: sub_40F6ED+577j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax
		call	sub_4100D8
; ---------------------------------------------------------------------------

loc_40FC85:				; CODE XREF: sub_40F6ED+56Dj
					; sub_40F6ED+581j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40FCE9
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 80h
		test	eax, eax
		jz	short loc_40FCC1
		mov	eax, 0FFFFFFF9h
		jmp	short loc_40FCC6
; ---------------------------------------------------------------------------

loc_40FCC1:				; CODE XREF: sub_40F6ED+5CBj
		mov	eax, 0FFFFFFFEh

loc_40FCC6:				; CODE XREF: sub_40F6ED+5D2j
		mov	edx, [ebp+arg_0]
		mov	[edx+10h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		jmp	loc_40FE09
; ---------------------------------------------------------------------------

loc_40FCE9:				; CODE XREF: sub_40F6ED+5B6j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jz	loc_40FDF0
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40FD43
		cmp	[ebp+var_24], 0
		jnz	short loc_40FD43
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_40FEA2
		jmp	loc_40FDE7
; ---------------------------------------------------------------------------

loc_40FD43:				; CODE XREF: sub_40F6ED+61Ej
					; sub_40F6ED+624j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_40FD71
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_40FD71
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_40FDE7
; ---------------------------------------------------------------------------

loc_40FD71:				; CODE XREF: sub_40F6ED+663j
					; sub_40F6ED+676j
		cmp	[ebp+var_1C], 0
		jnz	short loc_40FD83
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	short loc_40FDE7
; ---------------------------------------------------------------------------

loc_40FD83:				; CODE XREF: sub_40F6ED+688j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_40FDB9
		mov	eax, [ebp+var_1C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40FDB9
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_40FDB9
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_40FDE7
; ---------------------------------------------------------------------------

loc_40FDB9:				; CODE XREF: sub_40F6ED+69Ej
					; sub_40F6ED+6ABj ...
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_40FEA2
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1

loc_40FDE7:				; CODE XREF: sub_40F6ED+651j
					; sub_40F6ED+682j ...
		mov	[ebp+var_18], offset asc_418B1C	; "x"
		jmp	short loc_40FE09
; ---------------------------------------------------------------------------

loc_40FDF0:				; CODE XREF: sub_40F6ED+60Dj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx

loc_40FE09:				; CODE XREF: sub_40F6ED+5F7j
					; sub_40F6ED+701j
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40FE1C
		cmp	[ebp+var_24], 0
		jz	short loc_40FE7B

loc_40FE1C:				; CODE XREF: sub_40F6ED+727j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_40FE7B
; ---------------------------------------------------------------------------

loc_40FE34:				; CODE XREF: sub_40F6ED+489j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 4
		test	eax, eax
		jz	short loc_40FE6C
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_40FE7C
; ---------------------------------------------------------------------------

loc_40FE6C:				; CODE XREF: sub_40F6ED+752j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 1
		jmp	loc_40F751
; ---------------------------------------------------------------------------

loc_40FE7B:				; CODE XREF: sub_40F6ED+72Dj
					; sub_40F6ED+745j
		nop

loc_40FE7C:				; CODE XREF: sub_40F6ED+74j
					; sub_40F6ED+CAj ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		leave
		retn
sub_40F6ED	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40FEA2(int, int, char	*)
sub_40FEA2	proc near		; CODE XREF: .text:0040F166p
					; sub_40F6ED+421p ...

Str		= dword	ptr -28h
EndPtr		= dword	ptr -24h
Radix		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_40FEB9
		mov	eax, 0
		jmp	short loc_40FEBE
; ---------------------------------------------------------------------------

loc_40FEB9:				; CODE XREF: sub_40FEA2+Ej
		mov	eax, 0Ah

loc_40FEBE:				; CODE XREF: sub_40FEA2+15j
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		and	edx, 7
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jz	short loc_40FEEC
		cmp	eax, 4
		jz	loc_40FF79
		cmp	eax, 1
		jnz	loc_41001E

loc_40FEEC:				; CODE XREF: sub_40FEA2+36j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtol
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 80000000h
		jz	short loc_40FF28
		cmp	[ebp+var_10], 7FFFFFFFh
		jnz	short loc_40FF4A

loc_40FF28:				; CODE XREF: sub_40FEA2+7Bj
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 22h
		jnz	short loc_40FF4A
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF4h
		mov	eax, 0FFFFFFFFh
		jmp	locret_41002C
; ---------------------------------------------------------------------------

loc_40FF4A:				; CODE XREF: sub_40FEA2+84j
					; sub_40FEA2+92j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jnz	short loc_40FF60
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+18h], edx
		jmp	short loc_40FF69
; ---------------------------------------------------------------------------

loc_40FF60:				; CODE XREF: sub_40FEA2+B1j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+18h], edx

loc_40FF69:				; CODE XREF: sub_40FEA2+BCj
		mov	eax, 0
		jmp	locret_41002C
; ---------------------------------------------------------------------------

loc_40FF73:				; CODE XREF: sub_40FEA2+F7j
		add	[ebp+arg_8], 1
		jmp	short loc_40FF7A
; ---------------------------------------------------------------------------

loc_40FF79:				; CODE XREF: sub_40FEA2+3Bj
		nop

loc_40FF7A:				; CODE XREF: sub_40FEA2+D5j
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_40FF9B
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Str], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_40FF73

loc_40FF9B:				; CODE XREF: sub_40FEA2+E0j
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_40FFC0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF4h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41002C
; ---------------------------------------------------------------------------

loc_40FFC0:				; CODE XREF: sub_40FEA2+101j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtoul
		mov	edx, [ebp+arg_0]
		mov	[edx+18h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_410017
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 22h
		jnz	short loc_410017
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF4h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41002C
; ---------------------------------------------------------------------------

loc_410017:				; CODE XREF: sub_40FEA2+154j
					; sub_40FEA2+162j
		mov	eax, 0
		jmp	short locret_41002C
; ---------------------------------------------------------------------------

loc_41001E:				; CODE XREF: sub_40FEA2+44j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[eax+18h], edx
		mov	eax, 1

locret_41002C:				; CODE XREF: sub_40FEA2+A3j
					; sub_40FEA2+CCj ...
		leave
		retn
sub_40FEA2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41002E	proc near		; CODE XREF: sub_4100D8+8Ep

var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_4100CF
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_4100CF
		call	sub_412AFB
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_4100BA
		add	[ebp+var_C], 1
		jmp	short loc_4100BA
; ---------------------------------------------------------------------------

loc_410095:				; CODE XREF: sub_41002E+9Fj
		cmp	[ebp+var_14], 0
		jz	short loc_4100B4
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0C0h
		cmp	eax, 80h
		jz	short loc_4100B4
		add	[ebp+var_C], 1

loc_4100B4:				; CODE XREF: sub_41002E+6Bj
					; sub_41002E+80j
		add	[ebp+var_10], 1
		jmp	short loc_4100BB
; ---------------------------------------------------------------------------

loc_4100BA:				; CODE XREF: sub_41002E+5Fj
					; sub_41002E+65j
		nop

loc_4100BB:				; CODE XREF: sub_41002E+8Aj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4100CF
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_410095

loc_4100CF:				; CODE XREF: sub_41002E+34j
					; sub_41002E+41j ...
		mov	eax, [ebp+var_C]
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
sub_41002E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_4100D8	proc near		; CODE XREF: sub_40F6ED+1C6p
					; sub_40F6ED+593p

Str		= dword	ptr -38h
Size		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		call	sub_410643
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[esp+38h+Str], 29h
		call	sub_4108F9
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	puts
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_410540
		mov	[ebp+var_18], 0
		mov	eax, [ebp+var_18]
		mov	[ebp+var_10], eax
		jmp	short loc_410186
; ---------------------------------------------------------------------------

loc_410127:				; CODE XREF: sub_4100D8+BBj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_410182
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_41015A
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jz	short loc_410182

loc_41015A:				; CODE XREF: sub_4100D8+6Dj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_41002E
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jle	short loc_410182
		cmp	[ebp+var_14], 22h
		jg	short loc_410182
		mov	eax, [ebp+var_14]
		mov	[ebp+var_18], eax

loc_410182:				; CODE XREF: sub_4100D8+5Dj
					; sub_4100D8+80j ...
		add	[ebp+var_10], 1

loc_410186:				; CODE XREF: sub_4100D8+4Dj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_410127
		add	[ebp+var_18], 0Ah
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jz	short loc_4101B2
		mov	[esp+38h+Str], offset aOptions ; "Options:"
		call	puts

loc_4101B2:				; CODE XREF: sub_4100D8+CCj
		mov	[ebp+var_10], 0
		jmp	loc_410517
; ---------------------------------------------------------------------------

loc_4101BE:				; CODE XREF: sub_4100D8+44Cj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+38h+Str], eax ; char *
		call	sub_40DCF4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4101F6
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jnz	short loc_4101F6
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_410512

loc_4101F6:				; CODE XREF: sub_4100D8+101j
					; sub_4100D8+10Bj
		cmp	[ebp+var_C], 0
		jz	short loc_410261
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jnz	short loc_410261
		add	[ebp+var_C], 1
		jmp	short loc_410246
; ---------------------------------------------------------------------------

loc_41020C:				; CODE XREF: sub_4100D8+176j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_410231
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_410242
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	short loc_410242
; ---------------------------------------------------------------------------

loc_410231:				; CODE XREF: sub_4100D8+13Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar

loc_410242:				; CODE XREF: sub_4100D8+149j
					; sub_4100D8+157j
		add	[ebp+var_C], 1

loc_410246:				; CODE XREF: sub_4100D8+132j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41020C
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	loc_410513
; ---------------------------------------------------------------------------

loc_410261:				; CODE XREF: sub_4100D8+122j
					; sub_4100D8+12Cj
		mov	[ebp+var_14], 3
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 0FFh
		jg	loc_410315
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, offset aC_0 ; " -%c"
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Str], eax ; Format
		call	printf
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_41033E
		cmp	[ebp+var_C], 0
		jz	loc_41033E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_41033E
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1
		jmp	short loc_4102F1
; ---------------------------------------------------------------------------

loc_4102D8:				; CODE XREF: sub_4100D8+22Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1

loc_4102F1:				; CODE XREF: sub_4100D8+1FEj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_410305
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_4102D8

loc_410305:				; CODE XREF: sub_4100D8+221j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41033E
		add	[ebp+var_C], 1
		jmp	short loc_41033E
; ---------------------------------------------------------------------------

loc_410315:				; CODE XREF: sub_4100D8+1A0j
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset asc_418B2C ; "   "
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 3 ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite

loc_41033E:				; CODE XREF: sub_4100D8+1D0j
					; sub_4100D8+1DAj ...
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	loc_410441
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 0FFh
		jg	short loc_410377
		mov	eax, 2Ch
		jmp	short loc_41037C
; ---------------------------------------------------------------------------

loc_410377:				; CODE XREF: sub_4100D8+296j
		mov	eax, 20h

loc_41037C:				; CODE XREF: sub_4100D8+29Dj
		mov	edx, offset aCS	; "%c --%s"
		mov	[esp+38h+Count], ecx
		mov	[esp+38h+Size],	eax
		mov	[esp+38h+Str], edx ; Format
		call	printf
		add	[ebp+var_14], eax
		cmp	[ebp+var_C], 0
		jz	short loc_410402
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_410402
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_4103DF
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1
		jmp	short loc_4103DF
; ---------------------------------------------------------------------------

loc_4103C4:				; CODE XREF: sub_4100D8+31Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1
		jmp	short loc_4103E0
; ---------------------------------------------------------------------------

loc_4103DF:				; CODE XREF: sub_4100D8+2D8j
					; sub_4100D8+2EAj
		nop

loc_4103E0:				; CODE XREF: sub_4100D8+305j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4103F4
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_4103C4

loc_4103F4:				; CODE XREF: sub_4100D8+310j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_410402
		add	[ebp+var_C], 1

loc_410402:				; CODE XREF: sub_4100D8+2C0j
					; sub_4100D8+2CAj ...
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset asc_418B2C ; "   "
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 3 ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		add	[ebp+var_14], 3
		jmp	short loc_410441
; ---------------------------------------------------------------------------

loc_410431:				; CODE XREF: sub_4100D8+36Fj
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_410441:				; CODE XREF: sub_4100D8+274j
					; sub_4100D8+357j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_410431
		cmp	[ebp+var_C], 0
		jz	loc_410504
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_4104F9
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jle	loc_4104F9
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[ebp+var_14], 0
		jmp	short loc_410492
; ---------------------------------------------------------------------------

loc_410482:				; CODE XREF: sub_4100D8+3C0j
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_410492:				; CODE XREF: sub_4100D8+3A8j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_410482
		jmp	short loc_4104F9
; ---------------------------------------------------------------------------

loc_41049C:				; CODE XREF: sub_4100D8+42Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_4104E2
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4104F3
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[ebp+var_14], 0
		jmp	short loc_4104D8
; ---------------------------------------------------------------------------

loc_4104C8:				; CODE XREF: sub_4100D8+406j
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_4104D8:				; CODE XREF: sub_4100D8+3EEj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_4104C8
		jmp	short loc_4104F3
; ---------------------------------------------------------------------------

loc_4104E2:				; CODE XREF: sub_4100D8+3CCj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar

loc_4104F3:				; CODE XREF: sub_4100D8+3D9j
					; sub_4100D8+408j
		add	[ebp+var_C], 1
		jmp	short loc_4104FA
; ---------------------------------------------------------------------------

loc_4104F9:				; CODE XREF: sub_4100D8+383j
					; sub_4100D8+38Fj ...
		nop

loc_4104FA:				; CODE XREF: sub_4100D8+41Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41049C

loc_410504:				; CODE XREF: sub_4100D8+375j
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	short loc_410513
; ---------------------------------------------------------------------------

loc_410512:				; CODE XREF: sub_4100D8+118j
		nop

loc_410513:				; CODE XREF: sub_4100D8+184j
					; sub_4100D8+438j
		add	[ebp+var_10], 1

loc_410517:				; CODE XREF: sub_4100D8+E1j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_4101BE
		mov	eax, [ebp+arg_4]
		and	eax, 20h
		test	eax, eax
		jz	short loc_410540
		mov	[esp+38h+Str], offset aASingleDashMay ;	"\n(A single dash may be used instead of"...
		call	puts

loc_410540:				; CODE XREF: sub_4100D8+3Aj
					; sub_4100D8+45Aj
		mov	[esp+38h+Str], 13h
		call	sub_4108F9
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_410627
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[esp+38h+Size],	offset SubStr ;	"@EMAIL@"
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	strstr
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_410610
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		cmp	edx, eax
		jz	short loc_4105C0
		mov	eax, ds:_iob
		lea	ecx, [eax+20h]
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+File],	ecx ; File
		mov	[esp+38h+Count], 1 ; Count
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite

loc_4105C0:				; CODE XREF: sub_4100D8+4B5j
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aHttpBugs_gnupg ; "http://bugs.gnupg.org"
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 15h ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		add	[ebp+var_1C], 7
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_410627
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Size],	edx ; File
		mov	[esp+38h+Str], eax ; Str
		call	fputs
		jmp	short loc_410627
; ---------------------------------------------------------------------------

loc_410610:				; CODE XREF: sub_4100D8+4A7j
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+38h+Size],	eax ; File
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	fputs

loc_410627:				; CODE XREF: sub_4100D8+47Bj
					; sub_4100D8+51Dj ...
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+38h+Str], eax ; File
		call	fflush
		mov	[esp+38h+Str], 0 ; Code
		call	exit
sub_4100D8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410643	proc near		; CODE XREF: sub_40F6ED+201p
					; sub_4100D8+7p

Str		= dword	ptr -28h
File		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, ds:_iob
		lea	ebx, [eax+20h]
		mov	[esp+28h+Str], 0Bh
		call	sub_4108F9
		mov	[esp+28h+File],	ebx ; File
		mov	[esp+28h+Str], eax ; Str
		call	fputs
		mov	[esp+28h+Str], 0Ch
		call	sub_4108F9
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_410693
		mov	eax, offset aS_1 ; " (%s)"
		mov	edx, [ebp+var_10]
		mov	[esp+28h+File],	edx
		mov	[esp+28h+Str], eax ; Format
		call	printf

loc_410693:				; CODE XREF: sub_410643+3Aj
		mov	[esp+28h+Str], 0Dh
		call	sub_4108F9
		mov	edx, offset aSS	; " %s %s\n"
		mov	[esp+28h+var_20], offset aGpg4win2_3_1 ; "(Gpg4win 2.3.1)"
		mov	[esp+28h+File],	eax
		mov	[esp+28h+Str], edx ; Format
		call	printf
		mov	[ebp+var_C], 14h
		jmp	short loc_4106E4
; ---------------------------------------------------------------------------

loc_4106C1:				; CODE XREF: sub_410643+A5j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_4108F9
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4106E0
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_4106E0:				; CODE XREF: sub_410643+90j
		add	[ebp+var_C], 1

loc_4106E4:				; CODE XREF: sub_410643+7Cj
		cmp	[ebp+var_C], 1Dh
		jle	short loc_4106C1
		mov	[esp+28h+Str], 0Eh
		call	sub_4108F9
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41070A
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_41070A:				; CODE XREF: sub_410643+BAj
		mov	[esp+28h+Str], 0Ah
		call	sub_4108F9
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41072A
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_41072A:				; CODE XREF: sub_410643+DAj
		mov	[esp+28h+Str], 0Fh
		call	sub_4108F9
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_410756
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_410756:				; CODE XREF: sub_410643+FAj
		mov	[esp+28h+Str], 12h
		call	sub_4108F9
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_410782
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_410782:				; CODE XREF: sub_410643+126j
		mov	[ebp+var_C], 1Eh
		jmp	short loc_4107BA
; ---------------------------------------------------------------------------

loc_41078B:				; CODE XREF: sub_410643+17Bj
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_4108F9
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4107B6
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_4107B6:				; CODE XREF: sub_410643+15Aj
		add	[ebp+var_C], 1

loc_4107BA:				; CODE XREF: sub_410643+146j
		cmp	[ebp+var_C], 27h
		jle	short loc_41078B
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+Str], eax ; File
		call	fflush
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_410643	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4107D6	proc near		; CODE XREF: sub_4019CB+126p

File		= dword	ptr -58h
Format		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= dword	ptr -2Ch
Str		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		cmp	[ebp+arg_0], 0
		jnz	short loc_410848
		mov	[esp+58h+File],	0Eh
		call	sub_4108F9
		mov	esi, eax
		mov	[esp+58h+File],	0Dh
		call	sub_4108F9
		mov	ebx, eax
		mov	[esp+58h+File],	0Bh
		call	sub_4108F9
		mov	edx, offset aSSS ; "%s %s; %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+58h+var_48], esi
		mov	[esp+58h+var_4C], ebx
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+Format], edx ;	Format
		mov	[esp+58h+File],	ecx ; File
		call	fprintf
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+58h+File],	eax ; File
		call	fflush
		jmp	loc_4108F1
; ---------------------------------------------------------------------------

loc_410848:				; CODE XREF: sub_4107D6+Dj
		cmp	[ebp+arg_0], 1
		jnz	short loc_4108CB
		mov	[esp+58h+File],	28h
		call	sub_4108F9
		mov	[ebp+Str], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+58h+Format], eax ;	File
		mov	eax, [ebp+Str]
		mov	[esp+58h+File],	eax ; Str
		call	fputs
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4108BF
		mov	eax, [ebp+Str]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_4108BF
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+58h+Format], eax ;	File
		mov	[esp+58h+File],	0Ah ; Ch
		call	putc

loc_4108BF:				; CODE XREF: sub_4107D6+A6j
					; sub_4107D6+CFj
		mov	[esp+58h+File],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4108CB:				; CODE XREF: sub_4107D6+76j
		cmp	[ebp+arg_0], 2
		jnz	short loc_4108F1
		mov	[esp+58h+File],	29h
		call	sub_4108F9
		mov	[esp+58h+File],	eax ; Str
		call	puts
		mov	[esp+58h+File],	0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4108F1:				; CODE XREF: sub_4107D6+6Dj
					; sub_4107D6+F9j
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4107D6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4108F9	proc near		; CODE XREF: sub_40F6ED+239p
					; sub_4100D8+1Fp ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_41A2A0
		test	eax, eax
		jz	short loc_410918
		mov	edx, ds:dword_41A2A0
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx ; dword_41A2A0
		jmp	short loc_41091D
; ---------------------------------------------------------------------------

loc_410918:				; CODE XREF: sub_4108F9+Dj
		mov	eax, 0

loc_41091D:				; CODE XREF: sub_4108F9+1Dj
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41092B
		mov	eax, [ebp+var_C]
		jmp	short locret_410980
; ---------------------------------------------------------------------------

loc_41092B:				; CODE XREF: sub_4108F9+2Bj
		mov	eax, [ebp+arg_0]
		sub	eax, 0Ah	; switch 32 cases
		cmp	eax, 1Fh
		ja	short loc_41097D ; jumptable 0041093D default case
		mov	eax, ds:off_418F18[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41093F:				; CODE XREF: sub_4108F9+44j
					; DATA XREF: .rdata:off_418F18o
		mov	[ebp+var_C], offset aLicenseGplv3Gn ; jumptable	0041093D case 10
		jmp	short loc_41097D ; jumptable 0041093D default case
; ---------------------------------------------------------------------------

loc_410948:				; CODE XREF: sub_4108F9+44j
					; DATA XREF: .rdata:off_418F18o
		mov	[ebp+var_C], offset aFoo ; jumptable 0041093D case 11
		jmp	short loc_41097D ; jumptable 0041093D default case
; ---------------------------------------------------------------------------

loc_410951:				; CODE XREF: sub_4108F9+44j
					; DATA XREF: .rdata:off_418F18o
		mov	[ebp+var_C], offset a0_0 ; jumptable 0041093D case 13
		jmp	short loc_41097D ; jumptable 0041093D default case
; ---------------------------------------------------------------------------

loc_41095A:				; CODE XREF: sub_4108F9+44j
					; DATA XREF: .rdata:off_418F18o
		mov	[ebp+var_C], offset aCopyrightC2015 ; jumptable	0041093D case 14
		jmp	short loc_41097D ; jumptable 0041093D default case
; ---------------------------------------------------------------------------

loc_410963:				; CODE XREF: sub_4108F9+44j
					; DATA XREF: .rdata:off_418F18o
		mov	[ebp+var_C], offset aThisIsFreeSoft ; jumptable	0041093D case 15
		jmp	short loc_41097D ; jumptable 0041093D default case
; ---------------------------------------------------------------------------

loc_41096C:				; CODE XREF: sub_4108F9+44j
					; DATA XREF: .rdata:off_418F18o
		mov	[ebp+var_C], offset aThisIsFreeSo_0 ; jumptable	0041093D case 16
		jmp	short loc_41097D ; jumptable 0041093D default case
; ---------------------------------------------------------------------------

loc_410975:				; CODE XREF: sub_4108F9+44j
					; DATA XREF: .rdata:off_418F18o
		mov	[ebp+var_C], offset dword_418F14 ; jumptable 0041093D cases 40,41
		nop

loc_41097D:				; CODE XREF: sub_4108F9+3Bj
					; sub_4108F9+44j ...
		mov	eax, [ebp+var_C] ; jumptable 0041093D default case

locret_410980:				; CODE XREF: sub_4108F9+30j
		leave
		retn
sub_4108F9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410982	proc near		; CODE XREF: sub_4019CB+25p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ds:dword_41A2A0, eax
		pop	ebp
		retn
sub_410982	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_410990(char *)
sub_410990	proc near		; CODE XREF: sub_410F6A+356p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+Val], 5Ch ; Val
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_4109D3
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		jmp	short loc_4109C9
; ---------------------------------------------------------------------------

loc_4109B5:				; CODE XREF: sub_410990+41j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4109C5
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	5Ch

loc_4109C5:				; CODE XREF: sub_410990+2Dj
		add	[ebp+var_C], 1

loc_4109C9:				; CODE XREF: sub_410990+23j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4109B5

loc_4109D3:				; CODE XREF: sub_410990+1Bj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_410990	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_410AA9
; ---------------------------------------------------------------------------

loc_4109FC:				; CODE XREF: .text:00410AADj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jnz	short loc_410AA1
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_410A4E
; ---------------------------------------------------------------------------

loc_410A42:				; CODE XREF: .text:00410A7Ej
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_410A4E:				; CODE XREF: .text:00410A40j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_410A80
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_410A42

loc_410A80:				; CODE XREF: .text:00410A52j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_410A8F
		mov	eax, [ebp-18h]
		jmp	short loc_410AB8
; ---------------------------------------------------------------------------

loc_410A8F:				; CODE XREF: .text:00410A88j
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_410AA1:				; CODE XREF: .text:00410A26j
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_410AA9:				; CODE XREF: .text:004109F7j
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_4109FC
		mov	eax, 0

loc_410AB8:				; CODE XREF: .text:00410A8Dj
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_410B87
; ---------------------------------------------------------------------------

loc_410AE2:				; CODE XREF: .text:00410B8Bj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_411BA1
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_411BA1
		cmp	ebx, eax
		jnz	short loc_410B7F
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_410B30
; ---------------------------------------------------------------------------

loc_410B24:				; CODE XREF: .text:00410B5Cj
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_410B30:				; CODE XREF: .text:00410B22j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_410B5E
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_411BA1
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_411BA1
		cmp	ebx, eax
		jz	short loc_410B24

loc_410B5E:				; CODE XREF: .text:00410B34j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_410B6D
		mov	eax, [ebp-18h]
		jmp	short loc_410B96
; ---------------------------------------------------------------------------

loc_410B6D:				; CODE XREF: .text:00410B66j
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_410B7F:				; CODE XREF: .text:00410B08j
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_410B87:				; CODE XREF: .text:00410ADDj
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_410AE2
		mov	eax, 0

loc_410B96:				; CODE XREF: .text:00410B6Bj
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_410BFB
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_410BBC
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp+8], eax

loc_410BBC:				; CODE XREF: .text:00410BACj
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		sub	dword ptr [ebp+10h], 1
		jmp	short loc_410BE5
; ---------------------------------------------------------------------------

loc_410BCE:				; CODE XREF: .text:00410BF3j
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp+10h], 1

loc_410BE5:				; CODE XREF: .text:00410BCCj
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_410BF5
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_410BCE

loc_410BF5:				; CODE XREF: .text:00410BE9j
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0

loc_410BFB:				; CODE XREF: .text:00410BA6j
		mov	eax, [ebp+8]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410C00	proc near		; CODE XREF: .text:0040F009p
					; .text:0040F0C6p

C		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_410C18
; ---------------------------------------------------------------------------

loc_410C14:				; CODE XREF: sub_410C00+37j
		add	[ebp+var_10], 1

loc_410C18:				; CODE XREF: sub_410C00+12j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_410C39
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_410C14

loc_410C39:				; CODE XREF: sub_410C00+20j
		mov	[ebp+var_14], 0
		jmp	short loc_410C76
; ---------------------------------------------------------------------------

loc_410C42:				; CODE XREF: sub_410C00+89j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_410C67
		cmp	[ebp+var_14], 0
		jnz	short loc_410C6E
		mov	eax, [ebp+var_C]
		mov	[ebp+var_14], eax
		jmp	short loc_410C6E
; ---------------------------------------------------------------------------

loc_410C67:				; CODE XREF: sub_410C00+57j
		mov	[ebp+var_14], 0

loc_410C6E:				; CODE XREF: sub_410C00+5Dj
					; sub_410C00+65j
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_410C76:				; CODE XREF: sub_410C00+40j
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_410C42
		cmp	[ebp+var_14], 0
		jz	short loc_410C97
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0

loc_410C97:				; CODE XREF: sub_410C00+8Fj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_410C00	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_410CE1
; ---------------------------------------------------------------------------

loc_410CB1:				; CODE XREF: .text:00410CE9j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_410CD6
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_410CDD
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax
		jmp	short loc_410CDD
; ---------------------------------------------------------------------------

loc_410CD6:				; CODE XREF: .text:00410CC6j
		mov	dword ptr [ebp-10h], 0

loc_410CDD:				; CODE XREF: .text:00410CCCj
					; .text:00410CD4j
		add	dword ptr [ebp-0Ch], 1

loc_410CE1:				; CODE XREF: .text:00410CAFj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_410CB1
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_410CF7
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	0

loc_410CF7:				; CODE XREF: .text:00410CEFj
		mov	eax, [ebp+8]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_410CFC(int, int, char	*)
sub_410CFC	proc near		; CODE XREF: .text:00410D93p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_410D51
; ---------------------------------------------------------------------------

loc_410D18:				; CODE XREF: sub_410CFC+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_410D42
		cmp	[ebp+var_10], 0
		jnz	short loc_410D49
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_410D49
; ---------------------------------------------------------------------------

loc_410D42:				; CODE XREF: sub_410CFC+36j
		mov	[ebp+var_10], 0

loc_410D49:				; CODE XREF: sub_410CFC+3Cj
					; sub_410CFC+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_410D51:				; CODE XREF: sub_410CFC+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_410D18
		cmp	[ebp+var_10], 0
		jz	short loc_410D73
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_410D76
; ---------------------------------------------------------------------------

loc_410D73:				; CODE XREF: sub_410CFC+61j
		mov	eax, [ebp+arg_4]

locret_410D76:				; CODE XREF: sub_410CFC+75j
		leave
		retn
sub_410CFC	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_418F98 ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_410CFC
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_410D9A(int, int, char	*)
sub_410D9A	proc near		; CODE XREF: .text:00410E2Bp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_410DEF
; ---------------------------------------------------------------------------

loc_410DB6:				; CODE XREF: sub_410D9A+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_410DE0
		cmp	[ebp+var_10], 0
		jnz	short loc_410DE7
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_410DE7
; ---------------------------------------------------------------------------

loc_410DE0:				; CODE XREF: sub_410D9A+36j
		mov	[ebp+var_10], 0

loc_410DE7:				; CODE XREF: sub_410D9A+3Cj
					; sub_410D9A+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_410DEF:				; CODE XREF: sub_410D9A+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_410DB6
		cmp	[ebp+var_10], 0
		jz	short loc_410E0B
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_410E0E
; ---------------------------------------------------------------------------

loc_410E0B:				; CODE XREF: sub_410D9A+61j
		mov	eax, [ebp+arg_4]

locret_410E0E:				; CODE XREF: sub_410D9A+6Fj
		leave
		retn
sub_410D9A	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_418F98 ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_410D9A
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_410E99
		mov	dword ptr [esp+4], 5Ch
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_410E99
		mov	dword ptr [esp+4], 3Ah
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_410E99
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	gcry_xstrdup
		jmp	short locret_410EA7
; ---------------------------------------------------------------------------

loc_410E99:				; CODE XREF: .text:00410E52j
					; .text:00410E6Ej ...
		mov	eax, [ebp-0Ch]
		add	eax, 1
		mov	[esp], eax
		call	gcry_xstrdup

locret_410EA7:				; CODE XREF: .text:00410E97j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_410F11
		mov	dword ptr [esp+4], 5Ch
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_410F11
		mov	dword ptr [esp+4], 3Ah
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_410F11
		mov	dword ptr [esp], offset	a_ ; "."
		call	gcry_xstrdup
		jmp	short locret_410F56
; ---------------------------------------------------------------------------

loc_410F11:				; CODE XREF: .text:00410EC9j
					; .text:00410EE5j ...
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp-14h], eax
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	strncpy
		mov	eax, [ebp-10h]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-14h]

locret_410F56:				; CODE XREF: .text:00410F0Fj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410F58	proc near		; CODE XREF: sub_410F6A+144p
					; sub_410F6A+22Bp

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		mov	eax, [ebp+var_4]
		leave
		retn
sub_410F58	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410F6A	proc near		; CODE XREF: sub_4112CF+23p
					; .text:00411322p

VarName		= dword	ptr -0C8h
Val		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
Str		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0C0h
		mov	[ebp+var_14], 1
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_411031
; ---------------------------------------------------------------------------

loc_410FB7:				; CODE XREF: sub_410F6A+E8j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_10]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		cmp	eax, 1Eh
		jbe	short loc_41102D
		cmp	[ebp+arg_0], 0
		jz	short loc_411016
		mov	[esp+0C8h+var_C0], offset aDo_make_filena ; "do_make_filename"
		mov	[esp+0C8h+Val],	176h
		mov	[esp+0C8h+VarName], offset a____Gnupg22__4 ; "../../gnupg2-2.0.30/jnlib/stringhelp.c"
		call	sub_40E76C
; ---------------------------------------------------------------------------

loc_411016:				; CODE XREF: sub_410F6A+8Ej
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	loc_4112C5
; ---------------------------------------------------------------------------

loc_41102D:				; CODE XREF: sub_410F6A+88j
		add	[ebp+var_C], 1

loc_411031:				; CODE XREF: sub_410F6A+4Bj
		mov	eax, [ebp+arg_8]
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_A8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		test	eax, eax
		jnz	loc_410FB7
		add	[ebp+var_10], 1
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Eh
		jnz	loc_4111E8
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jz	short loc_41108B
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_411101

loc_41108B:				; CODE XREF: sub_410F6A+112j
		mov	[esp+0C8h+VarName], offset aHome_0 ; "HOME"
		call	getenv
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_4110BC
		mov	[esp+0C8h+Val],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+VarName], eax
		call	sub_410F58
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_20], eax

loc_4110BC:				; CODE XREF: sub_410F6A+134j
		cmp	[ebp+var_20], 0
		jz	loc_4111E7
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_4111E7
		mov	eax, [ebp+var_20]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		jmp	loc_4111E7
; ---------------------------------------------------------------------------

loc_411101:				; CODE XREF: sub_410F6A+11Fj
		cmp	[ebp+arg_0], 0
		jz	short loc_41111A
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+0C8h+VarName], eax
		call	gcry_xstrdup
		mov	[ebp+Str], eax
		jmp	short loc_41113B
; ---------------------------------------------------------------------------

loc_41111A:				; CODE XREF: sub_410F6A+19Bj
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+0C8h+VarName], eax
		call	gcry_strdup
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jnz	short loc_41113B
		mov	eax, 0
		jmp	loc_4112C5
; ---------------------------------------------------------------------------

loc_41113B:				; CODE XREF: sub_410F6A+1AEj
					; sub_410F6A+1C5j
		mov	[esp+0C8h+Val],	2Fh ; Val
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+VarName], eax	; Str
		call	strchr
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_41115D
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0

loc_41115D:				; CODE XREF: sub_410F6A+1EBj
		mov	eax, [ebp+Str]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+VarName], eax
		call	sub_410F58
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+VarName], eax
		call	gcry_free
		cmp	[ebp+var_20], 0
		jz	short loc_4111DE
		mov	eax, [ebp+var_20]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		jmp	short loc_4111E8
; ---------------------------------------------------------------------------

loc_4111DE:				; CODE XREF: sub_410F6A+248j
		mov	[ebp+var_14], 1
		jmp	short loc_4111E8
; ---------------------------------------------------------------------------

loc_4111E7:				; CODE XREF: sub_410F6A+156j
					; sub_410F6A+164j ...
		nop

loc_4111E8:				; CODE XREF: sub_410F6A+101j
					; sub_410F6A+272j ...
		cmp	[ebp+arg_0], 0
		jz	short loc_4111FE
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+VarName], eax
		call	gcry_xmalloc
		mov	[ebp+var_1C], eax
		jmp	short loc_411227
; ---------------------------------------------------------------------------

loc_4111FE:				; CODE XREF: sub_410F6A+282j
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+VarName], eax
		call	gcry_malloc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_411227
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+VarName], eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_4112C5
; ---------------------------------------------------------------------------

loc_411227:				; CODE XREF: sub_410F6A+292j
					; sub_410F6A+2A6j
		cmp	[ebp+var_20], 0
		jz	short loc_411258
		mov	eax, [ebp+var_14]
		mov	ebx, eax
		add	ebx, [ebp+arg_4]
		mov	eax, [ebp+var_20]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax
		call	sub_411EAD
		mov	[esp+0C8h+Val],	ebx
		mov	[esp+0C8h+VarName], eax
		call	sub_411EAD
		mov	[ebp+var_24], eax
		jmp	short loc_41126D
; ---------------------------------------------------------------------------

loc_411258:				; CODE XREF: sub_410F6A+2C1j
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax
		call	sub_411EAD
		mov	[ebp+var_24], eax

loc_41126D:				; CODE XREF: sub_410F6A+2ECj
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+VarName], eax
		call	gcry_free
		mov	[ebp+var_C], 0
		jmp	short loc_4112AC
; ---------------------------------------------------------------------------

loc_411281:				; CODE XREF: sub_410F6A+34Ej
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		mov	edx, [ebp+var_24]
		mov	word ptr [edx],	2Fh
		mov	edx, [ebp+var_24]
		add	edx, 1
		mov	[esp+0C8h+Val],	eax
		mov	[esp+0C8h+VarName], edx
		call	sub_411EAD
		mov	[ebp+var_24], eax
		add	[ebp+var_C], 1

loc_4112AC:				; CODE XREF: sub_410F6A+315j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		test	eax, eax
		jnz	short loc_411281
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax	; char *
		call	sub_410990

loc_4112C5:				; CODE XREF: sub_410F6A+BEj
					; sub_410F6A+1CCj ...
		add	esp, 0C0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_410F6A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4112CF	proc near		; CODE XREF: sub_4019CB+143p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], 1
		call	sub_410F6A
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4112CF	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_410F6A
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		jmp	short loc_4113A4
; ---------------------------------------------------------------------------

loc_411338:				; CODE XREF: .text:004113B6j
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_41139C
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_41139C
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_411388
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_41139C

loc_411388:				; CODE XREF: .text:0041137Cj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_4113B8
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4113B8

loc_41139C:				; CODE XREF: .text:00411346j
					; .text:00411372j ...
		add	dword ptr [ebp+8], 1
		add	dword ptr [ebp+0Ch], 1

loc_4113A4:				; CODE XREF: .text:00411336j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4113B8
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_411338

loc_4113B8:				; CODE XREF: .text:00411390j
					; .text:0041139Aj ...
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4113CC
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_4113E0

loc_4113CC:				; CODE XREF: .text:004113C0j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_4113E7
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4113E7

loc_4113E0:				; CODE XREF: .text:004113CAj
		mov	eax, 0
		jmp	short loc_411415
; ---------------------------------------------------------------------------

loc_4113E7:				; CODE XREF: .text:004113D4j
					; .text:004113DEj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx

loc_411415:				; CODE XREF: .text:004113E5j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_411449
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_411449
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4114A0
; ---------------------------------------------------------------------------

loc_411449:				; CODE XREF: .text:00411429j
					; .text:00411433j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_411471
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_411471
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4114A0
; ---------------------------------------------------------------------------

loc_411471:				; CODE XREF: .text:00411451j
					; .text:0041145Bj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_411499
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_411499
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4114A0
; ---------------------------------------------------------------------------

loc_411499:				; CODE XREF: .text:00411479j
					; .text:00411483j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41151D
; ---------------------------------------------------------------------------

loc_4114A0:				; CODE XREF: .text:00411447j
					; .text:0041146Fj ...
		add	dword ptr [ebp+8], 1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4114C9
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4114C9
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	[ebp-4], eax
		jmp	short loc_41151A
; ---------------------------------------------------------------------------

loc_4114C9:				; CODE XREF: .text:004114ACj
					; .text:004114B6j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_4114EE
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4114EE
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		add	[ebp-4], eax
		jmp	short loc_41151A
; ---------------------------------------------------------------------------

loc_4114EE:				; CODE XREF: .text:004114D1j
					; .text:004114DBj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_411513
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_411513
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		add	[ebp-4], eax
		jmp	short loc_41151A
; ---------------------------------------------------------------------------

loc_411513:				; CODE XREF: .text:004114F6j
					; .text:00411500j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41151D
; ---------------------------------------------------------------------------

loc_41151A:				; CODE XREF: .text:004114C7j
					; .text:004114ECj ...
		mov	eax, [ebp-4]

locret_41151D:				; CODE XREF: .text:0041149Ej
					; .text:00411518j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41151F(FILE *, int, int, int,	int)
sub_41151F	proc near		; CODE XREF: sub_4116D8+29p
					; .text:00411815p

var_28		= dword	ptr -28h
File		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_4116C9
; ---------------------------------------------------------------------------

loc_411537:				; CODE XREF: sub_41151F+1AEj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_411585
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_411585
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_C]
		jz	short loc_411585
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_10]
		jz	short loc_411585
		cmp	[ebp+arg_C], 0
		jnz	short loc_411577
		cmp	[ebp+arg_10], 0
		jz	loc_4116A1

loc_411577:				; CODE XREF: sub_41151F+4Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_4116A1

loc_411585:				; CODE XREF: sub_41151F+20j
					; sub_41151F+2Aj ...
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 5Ch ;	Ch
		call	putc
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_4115C2
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 6Eh ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_4116BD
; ---------------------------------------------------------------------------

loc_4115C2:				; CODE XREF: sub_41151F+85j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_4115E8
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 72h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_4116BD
; ---------------------------------------------------------------------------

loc_4115E8:				; CODE XREF: sub_41151F+ABj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_41160E
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 66h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_4116BD
; ---------------------------------------------------------------------------

loc_41160E:				; CODE XREF: sub_41151F+D1j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_411634
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 76h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_4116BD
; ---------------------------------------------------------------------------

loc_411634:				; CODE XREF: sub_41151F+F7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_411657
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 62h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_4116BD
; ---------------------------------------------------------------------------

loc_411657:				; CODE XREF: sub_41151F+11Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41167A
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 30h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_4116BD
; ---------------------------------------------------------------------------

loc_41167A:				; CODE XREF: sub_41151F+140j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "x%02x"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+File],	eax ; Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	File
		call	fprintf
		add	[ebp+var_10], 3
		jmp	short loc_4116BD
; ---------------------------------------------------------------------------

loc_4116A1:				; CODE XREF: sub_41151F+52j
					; sub_41151F+60j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	putc
		add	[ebp+var_10], 1

loc_4116BD:				; CODE XREF: sub_41151F+9Ej
					; sub_41151F+C4j ...
		sub	[ebp+arg_8], 1
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_4116C9:				; CODE XREF: sub_41151F+13j
		cmp	[ebp+arg_8], 0
		jnz	loc_411537
		mov	eax, [ebp+var_10]
		leave
		retn
sub_41151F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4116D8(FILE *, int, int, int)
sub_4116D8	proc near		; CODE XREF: sub_411708+B7p
					; .text:0041186Bp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_18], 0 ; int
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	FILE *
		call	sub_41151F
		leave
		retn
sub_4116D8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_411708(FILE *, int, int, int)
sub_411708	proc near		; CODE XREF: .text:004118C1p

Str		= dword	ptr -38h
File		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_411731
; ---------------------------------------------------------------------------

loc_41171E:				; CODE XREF: sub_411708+2Fj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_41173B
		add	[ebp+var_C], 1

loc_411731:				; CODE XREF: sub_411708+14j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jb	short loc_41171E
		jmp	short loc_41173C
; ---------------------------------------------------------------------------

loc_41173B:				; CODE XREF: sub_411708+23j
		nop

loc_41173C:				; CODE XREF: sub_411708+31j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jnb	short loc_4117A4
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+File],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax
		call	sub_413523
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Str], eax ; Str
		call	fputs
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	short loc_4117C4
; ---------------------------------------------------------------------------

loc_4117A4:				; CODE XREF: sub_411708+3Aj
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+File],	eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; FILE *
		call	sub_4116D8

loc_4117C4:				; CODE XREF: sub_411708+9Aj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_411708	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_41181C
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+14h]
		mov	[esp+10h], eax
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41151F
		jmp	short loc_411821
; ---------------------------------------------------------------------------

loc_41181C:				; CODE XREF: .text:004117D5j
		mov	eax, 0

loc_411821:				; CODE XREF: .text:0041181Aj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_411872
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4116D8
		jmp	short loc_411877
; ---------------------------------------------------------------------------

loc_411872:				; CODE XREF: .text:00411832j
		mov	eax, 0

loc_411877:				; CODE XREF: .text:00411870j
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_4118C8
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_411708
		jmp	short loc_4118CD
; ---------------------------------------------------------------------------

loc_4118C8:				; CODE XREF: .text:00411888j
		mov	eax, 0

loc_4118CD:				; CODE XREF: .text:004118C6j
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-18h], eax
		mov	eax, [ebp-0Ch]
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-10h], 1
		jmp	loc_41197D
; ---------------------------------------------------------------------------

loc_4118F7:				; CODE XREF: .text:00411981j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_411929
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_411929
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+10h]
		jz	short loc_411929
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_411971
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_411971

loc_411929:				; CODE XREF: .text:004118FFj
					; .text:00411909j ...
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_411965
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_411965
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jz	short loc_411965
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jz	short loc_411965
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jz	short loc_411965
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41196B

loc_411965:				; CODE XREF: .text:00411931j
					; .text:0041193Bj ...
		add	dword ptr [ebp-10h], 2
		jmp	short loc_411975
; ---------------------------------------------------------------------------

loc_41196B:				; CODE XREF: .text:00411963j
		add	dword ptr [ebp-10h], 5
		jmp	short loc_411975
; ---------------------------------------------------------------------------

loc_411971:				; CODE XREF: .text:0041191Dj
					; .text:00411927j
		add	dword ptr [ebp-10h], 1

loc_411975:				; CODE XREF: .text:00411969j
					; .text:0041196Fj
		sub	dword ptr [ebp+0Ch], 1
		add	dword ptr [ebp-0Ch], 1

loc_41197D:				; CODE XREF: .text:004118F2j
		cmp	dword ptr [ebp+0Ch], 0
		jnz	loc_4118F7
		mov	eax, [ebp-1Ch]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-18h]
		mov	[ebp+0Ch], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp-20h], eax
		mov	eax, [ebp-20h]
		mov	[ebp-14h], eax
		jmp	loc_411ABA
; ---------------------------------------------------------------------------

loc_4119AC:				; CODE XREF: .text:00411ABEj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_4119E6
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_4119E6
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+10h]
		jz	short loc_4119E6
		cmp	dword ptr [ebp+10h], 0
		jz	loc_411AA1
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_411AA1

loc_4119E6:				; CODE XREF: .text:004119B4j
					; .text:004119BEj ...
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	5Ch
		add	dword ptr [ebp-14h], 1
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_411A09
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	6Eh
		add	dword ptr [ebp-14h], 1
		jmp	loc_411AB2
; ---------------------------------------------------------------------------

loc_411A09:				; CODE XREF: .text:004119F8j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_411A22
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	72h
		add	dword ptr [ebp-14h], 1
		jmp	loc_411AB2
; ---------------------------------------------------------------------------

loc_411A22:				; CODE XREF: .text:00411A11j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_411A38
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	66h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_411AB2
; ---------------------------------------------------------------------------

loc_411A38:				; CODE XREF: .text:00411A2Aj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_411A4E
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	76h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_411AB2
; ---------------------------------------------------------------------------

loc_411A4E:				; CODE XREF: .text:00411A40j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_411A64
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	62h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_411AB2
; ---------------------------------------------------------------------------

loc_411A64:				; CODE XREF: .text:00411A56j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_411A7A
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	30h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_411AB2
; ---------------------------------------------------------------------------

loc_411A7A:				; CODE XREF: .text:00411A6Cj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "x%02x"
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sprintf
		add	dword ptr [ebp-14h], 3
		jmp	short loc_411AB2
; ---------------------------------------------------------------------------

loc_411AA1:				; CODE XREF: .text:004119D2j
					; .text:004119E0j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp-14h]
		mov	[eax], dl
		add	dword ptr [ebp-14h], 1

loc_411AB2:				; CODE XREF: .text:00411A04j
					; .text:00411A1Dj ...
		sub	dword ptr [ebp+0Ch], 1
		add	dword ptr [ebp-0Ch], 1

loc_411ABA:				; CODE XREF: .text:004119A7j
		cmp	dword ptr [ebp+0Ch], 0
		jnz	loc_4119AC
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-20h]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	dword ptr [ebp-4], 0
		jmp	short loc_411AFB
; ---------------------------------------------------------------------------

loc_411ADE:				; CODE XREF: .text:00411B03j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0C0h
		cmp	eax, 80h
		jz	short loc_411AF7
		add	dword ptr [ebp-4], 1

loc_411AF7:				; CODE XREF: .text:00411AF1j
		add	dword ptr [ebp+8], 1

loc_411AFB:				; CODE XREF: .text:00411ADCj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_411ADE
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_411B0A(DWORD)
sub_411B0A	proc near		; CODE XREF: sub_4065C8+41p

dwFlags		= dword	ptr -28h
lpSource	= dword	ptr -24h
dwMessageId	= dword	ptr -20h
dwLanguageId	= dword	ptr -1Ch
lpBuffer	= dword	ptr -18h
nSize		= dword	ptr -14h
Arguments	= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jnz	short loc_411B20
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+arg_0], eax

loc_411B20:				; CODE XREF: sub_411B0A+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Arguments], 0 ; Arguments
		mov	[esp+28h+nSize], 0FFh ;	nSize
		mov	[esp+28h+lpBuffer], offset Buffer ; lpBuffer
		mov	[esp+28h+dwLanguageId],	400h ; dwLanguageId
		mov	[esp+28h+dwMessageId], eax ; dwMessageId
		mov	[esp+28h+lpSource], 0 ;	lpSource
		mov	[esp+28h+dwFlags], 1000h ; dwFlags
		mov	eax, ds:FormatMessageA
		call	eax ; FormatMessageA
		sub	esp, 1Ch
		mov	eax, offset Buffer
		leave
		retn
sub_411B0A	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 40h
		jle	short loc_411B7D
		cmp	dword ptr [ebp+8], 5Ah
		jg	short loc_411B7D
		mov	eax, 1
		jmp	short loc_411B82
; ---------------------------------------------------------------------------

loc_411B7D:				; CODE XREF: .text:00411B6Ej
					; .text:00411B74j
		mov	eax, 0

loc_411B82:				; CODE XREF: .text:00411B7Bj
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 60h
		jle	short loc_411B9A
		cmp	dword ptr [ebp+8], 7Ah
		jg	short loc_411B9A
		mov	eax, 1
		jmp	short loc_411B9F
; ---------------------------------------------------------------------------

loc_411B9A:				; CODE XREF: .text:00411B8Bj
					; .text:00411B91j
		mov	eax, 0

loc_411B9F:				; CODE XREF: .text:00411B98j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411BA1	proc near		; CODE XREF: .text:00410AEEp
					; .text:00410B01p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 60h
		jle	short loc_411BB4
		cmp	[ebp+arg_0], 7Ah
		jg	short loc_411BB4
		and	[ebp+arg_0], 0FFFFFFDFh

loc_411BB4:				; CODE XREF: sub_411BA1+7j
					; sub_411BA1+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_411BA1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411BB9	proc near		; CODE XREF: .text:00411CBEp
					; .text:00411CD2p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 40h
		jle	short loc_411BCC
		cmp	[ebp+arg_0], 5Ah
		jg	short loc_411BCC
		or	[ebp+arg_0], 20h

loc_411BCC:				; CODE XREF: sub_411BB9+7j
					; sub_411BB9+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_411BB9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411BD1	proc near		; CODE XREF: sub_4127EF+187p
					; sub_4127EF+19Ep ...

var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_411C2C
		mov	eax, 0
		jmp	loc_411C85
; ---------------------------------------------------------------------------

loc_411BEA:				; CODE XREF: sub_411BD1+6Ej
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_411C22
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_411BA1
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_411BA1
		cmp	ebx, eax
		jnz	short loc_411C43

loc_411C22:				; CODE XREF: sub_411BD1+27j
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1
		jmp	short loc_411C2D
; ---------------------------------------------------------------------------

loc_411C2C:				; CODE XREF: sub_411BD1+Dj
		nop

loc_411C2D:				; CODE XREF: sub_411BD1+59j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_411C44
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_411BEA
		jmp	short loc_411C44
; ---------------------------------------------------------------------------

loc_411C43:				; CODE XREF: sub_411BD1+4Fj
		nop

loc_411C44:				; CODE XREF: sub_411BD1+64j
					; sub_411BD1+70j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_411C80
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_411BA1
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_411BA1
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_411C85
; ---------------------------------------------------------------------------

loc_411C80:				; CODE XREF: sub_411BD1+81j
		mov	eax, 0

loc_411C85:				; CODE XREF: sub_411BD1+14j
					; sub_411BD1+ADj
		add	esp, 4
		pop	ebx
		pop	ebp
		retn
sub_411BD1	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-8], eax
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jz	short loc_411CAB
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_411CB2

loc_411CAB:				; CODE XREF: .text:00411CA3j
		mov	eax, 0
		jmp	short locret_411D09
; ---------------------------------------------------------------------------

loc_411CB2:				; CODE XREF: .text:00411CA9j
					; .text:00411CF9j
		mov	eax, [ebp-4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_411BB9
		mov	[ebp-9], al
		mov	eax, [ebp-8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_411BB9
		mov	[ebp-0Ah], al
		sub	dword ptr [ebp+10h], 1
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_411CFB
		cmp	byte ptr [ebp-9], 0
		jz	short loc_411CFB
		add	dword ptr [ebp-4], 1
		add	dword ptr [ebp-8], 1
		movzx	eax, byte ptr [ebp-9]
		cmp	al, [ebp-0Ah]
		jz	short loc_411CB2

loc_411CFB:				; CODE XREF: .text:00411CE2j
					; .text:00411CE8j
		movzx	edx, byte ptr [ebp-9]
		movzx	eax, byte ptr [ebp-0Ah]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_411D09:				; CODE XREF: .text:00411CB0j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411D0B	proc near		; CODE XREF: .text:00411E8Cp
					; sub_4127EF+14Ap

var_18		= dword	ptr -18h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_C]
		jnz	loc_411DBB
		mov	eax, 0
		jmp	loc_411DCA
; ---------------------------------------------------------------------------

loc_411D34:				; CODE XREF: sub_411D0B+B4j
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_411DAF
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_411BA1
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_411BA1
		cmp	ebx, eax
		jz	short loc_411DAF
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_411DA8
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_411BA1
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_411BA1
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_411DAD
; ---------------------------------------------------------------------------

loc_411DA8:				; CODE XREF: sub_411D0B+6Fj
		mov	eax, 0

loc_411DAD:				; CODE XREF: sub_411D0B+9Bj
		jmp	short loc_411DCA
; ---------------------------------------------------------------------------

loc_411DAF:				; CODE XREF: sub_411D0B+37j
					; sub_411D0B+5Fj
		sub	[ebp+arg_8], 1
		add	[ebp+var_8], 1
		add	[ebp+var_C], 1

loc_411DBB:				; CODE XREF: sub_411D0B+19j
		cmp	[ebp+arg_8], 0
		jnz	loc_411D34
		mov	eax, 0

loc_411DCA:				; CODE XREF: sub_411D0B+24j
					; sub_411D0B:loc_411DADj
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_411D0B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		cmp	eax, [ebp+0Ch]
		jnz	short loc_411DFC
		mov	eax, 0
		jmp	short loc_411E43
; ---------------------------------------------------------------------------

loc_411DE2:				; CODE XREF: .text:00411E0Fj
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jnz	short loc_411E13
		add	dword ptr [ebp+8], 1
		add	dword ptr [ebp+0Ch], 1
		jmp	short loc_411DFD
; ---------------------------------------------------------------------------

loc_411DFC:				; CODE XREF: .text:00411DD9j
		nop

loc_411DFD:				; CODE XREF: .text:00411DFAj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_411E14
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_411DE2
		jmp	short loc_411E14
; ---------------------------------------------------------------------------

loc_411E13:				; CODE XREF: .text:00411DF0j
		nop

loc_411E14:				; CODE XREF: .text:00411E05j
					; .text:00411E11j
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_411E3E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short loc_411E43
; ---------------------------------------------------------------------------

loc_411E3E:				; CODE XREF: .text:00411E22j
		mov	eax, 0

loc_411E43:				; CODE XREF: .text:00411DE0j
					; .text:00411E3Cj
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		cmp	dword ptr [ebp+14h], 0
		jnz	short loc_411E56
		mov	eax, [ebp+8]
		jmp	short locret_411EAB
; ---------------------------------------------------------------------------

loc_411E56:				; CODE XREF: .text:00411E4Fj
		mov	eax, [ebp+14h]
		cmp	eax, [ebp+0Ch]
		ja	short loc_411EA6
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+14h]
		mov	edx, [ebp+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, [ebp-4]
		mov	[ebp-8], eax
		jmp	short loc_411E9E
; ---------------------------------------------------------------------------

loc_411E78:				; CODE XREF: .text:00411EA4j
		mov	eax, [ebp+14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-4]
		mov	[esp], eax
		call	sub_411D0B
		test	eax, eax
		jnz	short loc_411E9A
		mov	eax, [ebp-4]
		jmp	short locret_411EAB
; ---------------------------------------------------------------------------

loc_411E9A:				; CODE XREF: .text:00411E93j
		add	dword ptr [ebp-4], 1

loc_411E9E:				; CODE XREF: .text:00411E76j
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jbe	short loc_411E78

loc_411EA6:				; CODE XREF: .text:00411E5Cj
		mov	eax, 0

locret_411EAB:				; CODE XREF: .text:00411E54j
					; .text:00411E98j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411EAD	proc near		; CODE XREF: sub_4062FB+CFp
					; sub_4066F5+AEp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		jmp	short loc_411EC5
; ---------------------------------------------------------------------------

loc_411EB2:				; CODE XREF: sub_411EAD+20j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_411EC5:				; CODE XREF: sub_411EAD+3j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_411EB2
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_411EAD	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_411EF8
		mov	eax, 0
		jmp	locret_411FA3
; ---------------------------------------------------------------------------

loc_411EF8:				; CODE XREF: .text:00411EECj
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_411F0F
		mov	eax, [ebp+0Ch]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_411F68

loc_411F0F:				; CODE XREF: .text:00411F00j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		mov	[ebp-11h], al
		cmp	byte ptr [ebp-11h], 0
		jnz	short loc_411F27
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_411F7D
; ---------------------------------------------------------------------------

loc_411F27:				; CODE XREF: .text:00411F1Cj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, [ebp-11h]
		jnz	short loc_411F3A
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	short loc_411F7D
; ---------------------------------------------------------------------------

loc_411F3A:				; CODE XREF: .text:00411F30j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_411F4D
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_411F7D
; ---------------------------------------------------------------------------

loc_411F4D:				; CODE XREF: .text:00411F42j
		movsx	eax, byte ptr [ebp-11h]
		mov	edx, [ebp-10h]
		add	edx, 1
		mov	[esp+4], eax
		mov	[esp], edx
		call	strchr
		mov	[ebp-0Ch], eax
		jmp	short loc_411F7D
; ---------------------------------------------------------------------------

loc_411F68:				; CODE XREF: .text:00411F0Dj
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	strpbrk
		mov	[ebp-0Ch], eax

loc_411F7D:				; CODE XREF: .text:00411F25j
					; .text:00411F38j ...
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_411F97
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp+8]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		jmp	short loc_411FA0
; ---------------------------------------------------------------------------

loc_411F97:				; CODE XREF: .text:00411F81j
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0

loc_411FA0:				; CODE XREF: .text:00411F95j
		mov	eax, [ebp-10h]

locret_411FA3:				; CODE XREF: .text:00411EF3j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411FA5	proc near		; CODE XREF: sub_408EC2+30p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_8]
		add	[ebp+var_4], eax
		jmp	short loc_411FD4
; ---------------------------------------------------------------------------

loc_411FB9:				; CODE XREF: sub_411FA5+33j
		sub	[ebp+var_4], 1
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_4]
		jnz	short loc_411FD0
		mov	eax, [ebp+var_4]
		jmp	short locret_411FDF
; ---------------------------------------------------------------------------

loc_411FD0:				; CODE XREF: sub_411FA5+24j
		sub	[ebp+arg_8], 1

loc_411FD4:				; CODE XREF: sub_411FA5+12j
		cmp	[ebp+arg_8], 0
		jnz	short loc_411FB9
		mov	eax, 0

locret_411FDF:				; CODE XREF: sub_411FA5+29j
		leave
		retn
sub_411FA5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_411FE1(int, char *, int)
sub_411FE1	proc near		; CODE XREF: .text:00412211p
					; .text:00412233p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_411FF7
		mov	eax, 0
		jmp	locret_4121F4
; ---------------------------------------------------------------------------

loc_411FF7:				; CODE XREF: sub_411FE1+Aj
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	short loc_41204D
; ---------------------------------------------------------------------------

loc_412006:				; CODE XREF: sub_411FE1+77j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_412045
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_412045
		cmp	[ebp+arg_4], 0
		jz	short loc_412049
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_412049

loc_412045:				; CODE XREF: sub_411FE1+30j
					; sub_411FE1+3Dj
		add	[ebp+var_10], 1

loc_412049:				; CODE XREF: sub_411FE1+43j
					; sub_411FE1+62j
		add	[ebp+var_C], 1

loc_41204D:				; CODE XREF: sub_411FE1+23j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_412006
		cmp	[ebp+arg_8], 0
		jz	short loc_412078
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+Str], eax
		call	gcry_xmalloc
		mov	[ebp+var_14], eax
		jmp	short loc_41209E
; ---------------------------------------------------------------------------

loc_412078:				; CODE XREF: sub_411FE1+7Dj
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+Str], eax
		call	gcry_malloc
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_41209E
		mov	eax, 0
		jmp	locret_4121F4
; ---------------------------------------------------------------------------

loc_41209E:				; CODE XREF: sub_411FE1+95j
					; sub_411FE1+B1j
		mov	[ebp+var_C], 0
		jmp	loc_4121DA
; ---------------------------------------------------------------------------

loc_4120AA:				; CODE XREF: sub_411FE1+201j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_4120E0
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	33h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	61h
		add	[ebp+var_C], 1
		jmp	loc_4121D6
; ---------------------------------------------------------------------------

loc_4120E0:				; CODE XREF: sub_411FE1+D1j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_412116
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	32h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	35h
		add	[ebp+var_C], 1
		jmp	loc_4121D6
; ---------------------------------------------------------------------------

loc_412116:				; CODE XREF: sub_411FE1+107j
		cmp	[ebp+arg_4], 0
		jz	loc_4121C4
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	loc_4121C4
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		sar	al, 4
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_412177
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 30h
		jmp	short loc_412183
; ---------------------------------------------------------------------------

loc_412177:				; CODE XREF: sub_411FE1+186j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 57h

loc_412183:				; CODE XREF: sub_411FE1+194j
		mov	[edx], al
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_4121B0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_4121BC
; ---------------------------------------------------------------------------

loc_4121B0:				; CODE XREF: sub_411FE1+1BFj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 57h

loc_4121BC:				; CODE XREF: sub_411FE1+1CDj
		mov	[edx], al
		add	[ebp+var_C], 1
		jmp	short loc_4121D6
; ---------------------------------------------------------------------------

loc_4121C4:				; CODE XREF: sub_411FE1+139j
					; sub_411FE1+159j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		movzx	edx, byte ptr [edx]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_4121D6:				; CODE XREF: sub_411FE1+FAj
					; sub_411FE1+130j ...
		add	[ebp+arg_0], 1

loc_4121DA:				; CODE XREF: sub_411FE1+C4j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4120AA
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]

locret_4121F4:				; CODE XREF: sub_411FE1+11j
					; sub_411FE1+B8j
		leave
		retn
sub_411FE1	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_411FE1
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_411FE1
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41223A	proc near		; CODE XREF: .text:00412389p
					; sub_412396+32p

var_F8		= dword	ptr -0F8h
var_F4		= dword	ptr -0F4h
var_DC		= dword	ptr -0DCh
var_D8		= dword	ptr -0D8h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 0F4h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		mov	[ebp+eax*4+var_D8], edx
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_DC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_DC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_4122D3
; ---------------------------------------------------------------------------

loc_412286:				; CODE XREF: sub_41223A+BAj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		mov	[ebp+var_DC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_DC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		cmp	[ebp+var_C], 2Eh
		jbe	short loc_4122CF
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	short loc_41234E
; ---------------------------------------------------------------------------

loc_4122CF:				; CODE XREF: sub_41223A+7Fj
		add	[ebp+var_C], 1

loc_4122D3:				; CODE XREF: sub_41223A+4Aj
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+4]
		mov	[ebp+arg_4], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_D8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		test	eax, eax
		jnz	short loc_412286
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[esp+0F8h+var_F8], eax
		call	gcry_malloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_41234B
		mov	eax, [ebp+var_18]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	short loc_41233D
; ---------------------------------------------------------------------------

loc_41231D:				; CODE XREF: sub_41223A+10Fj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		mov	[esp+0F8h+var_F4], eax
		mov	eax, [ebp+var_14]
		mov	[esp+0F8h+var_F8], eax
		call	sub_411EAD
		mov	[ebp+var_14], eax
		add	[ebp+var_C], 1

loc_41233D:				; CODE XREF: sub_41223A+E1j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		test	eax, eax
		jnz	short loc_41231D

loc_41234B:				; CODE XREF: sub_41223A+D2j
		mov	eax, [ebp+var_18]

loc_41234E:				; CODE XREF: sub_41223A+93j
		add	esp, 0F4h
		pop	edi
		pop	ebp
		retn
sub_41223A	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_412374
		mov	dword ptr [esp], offset	word_418FD2
		call	gcry_strdup
		mov	[ebp-0Ch], eax
		jmp	short loc_412391
; ---------------------------------------------------------------------------

loc_412374:				; CODE XREF: .text:00412361j
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41223A
		mov	[ebp-0Ch], eax

loc_412391:				; CODE XREF: .text:00412372j
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_412396	proc near		; CODE XREF: sub_4062FB+3Fp
					; sub_406515+1Ep ...

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_4123B3
		mov	[esp+28h+Str], offset word_418FD2
		call	gcry_xstrdup
		mov	[ebp+var_C], eax
		jmp	short loc_4123D0
; ---------------------------------------------------------------------------

loc_4123B3:				; CODE XREF: sub_412396+Aj
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Size],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_41223A
		mov	[ebp+var_C], eax

loc_4123D0:				; CODE XREF: sub_412396+1Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_412444
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_41240F
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aFatalTooManyAr ; "\nfatal:	too many args for xstrconcat\n"
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 25h ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		jmp	short loc_412438
; ---------------------------------------------------------------------------

loc_41240F:				; CODE XREF: sub_412396+4Cj
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aFatalOutOfMemo ; "\nfatal:	out of memory\n"
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 16h ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite

loc_412438:				; CODE XREF: sub_412396+77j
		mov	[esp+28h+Str], 2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_412444:				; CODE XREF: sub_412396+3Ej
		mov	eax, [ebp+var_C]
		leave
		retn
sub_412396	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41244C(char *, int, int)
sub_41244C	proc near		; CODE XREF: sub_4125F3+23p

Filename	= dword	ptr -68h
Mode		= dword	ptr -64h
Count		= dword	ptr -60h
File		= dword	ptr -5Ch
DstBuf		= byte ptr -4Ah
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	eax, offset aRb	; "rb"
		mov	[esp+68h+Mode],	eax ; Mode
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_412479
		mov	eax, 0FFFFFFFFh
		jmp	locret_412578
; ---------------------------------------------------------------------------

loc_412479:				; CODE XREF: sub_41244C+21j
		lea	eax, [ebp+DstBuf]
		mov	edx, [ebp+var_14]
		mov	[esp+68h+File],	edx ; File
		mov	[esp+68h+Count], 31h ; Count
		mov	[esp+68h+Mode],	1 ; ElementSize
		mov	[esp+68h+Filename], eax	; DstBuf
		call	fread
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		cmp	[ebp+var_10], 0
		jnz	short loc_4124C6
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 2
		mov	eax, 0FFFFFFFFh
		jmp	locret_412578
; ---------------------------------------------------------------------------

loc_4124C6:				; CODE XREF: sub_41244C+61j
		lea	eax, [ebp+DstBuf]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		lea	eax, [ebp+DstBuf]
		mov	[esp+68h+Filename], eax	; Str
		call	atoi
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jle	short loc_4124EC
		cmp	[ebp+var_18], 0FFFFh
		jle	short loc_412500

loc_4124EC:				; CODE XREF: sub_41244C+95j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_412578
; ---------------------------------------------------------------------------

loc_412500:				; CODE XREF: sub_41244C+9Ej
		mov	eax, [ebp+var_18]
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], dx
		lea	eax, [ebp+DstBuf]
		mov	[ebp+var_C], eax
		jmp	short loc_41251B
; ---------------------------------------------------------------------------

loc_412513:				; CODE XREF: sub_41244C+DDj
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1

loc_41251B:				; CODE XREF: sub_41244C+C5j
		cmp	[ebp+var_10], 0
		jz	short loc_41252B
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_412513

loc_41252B:				; CODE XREF: sub_41244C+D3j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_41253B
		cmp	[ebp+var_10], 11h
		jz	short loc_41254F

loc_41253B:				; CODE XREF: sub_41244C+E7j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_412578
; ---------------------------------------------------------------------------

loc_41254F:				; CODE XREF: sub_41244C+EDj
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	edx, [edx+0Ch]
		mov	[eax+0Ch], edx
		mov	eax, 0

locret_412578:				; CODE XREF: sub_41244C+28j
					; sub_41244C+75j ...
		leave
		retn
sub_41244C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[esp], eax
		mov	eax, ds:closesocket
		call	eax ; closesocket
		sub	esp, 4
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_4125B5
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		cmp	eax, 2736h
		jnz	short loc_4125B5
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	_close
		mov	[ebp-0Ch], eax

loc_4125B5:				; CODE XREF: .text:00412597j
					; .text:004125A5j
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4125BA	proc near		; CODE XREF: sub_40210E+18Ap

var_18		= dword	ptr -18h
type		= dword	ptr -14h
protocol	= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 1
		jz	short loc_4125CC
		cmp	[ebp+arg_0], 1
		jnz	short loc_4125D3

loc_4125CC:				; CODE XREF: sub_4125BA+Aj
		mov	[ebp+arg_0], 2

loc_4125D3:				; CODE XREF: sub_4125BA+10j
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+protocol], eax	; protocol
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+type],	eax ; type
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	af
		mov	eax, ds:socket
		call	eax ; socket
		sub	esp, 0Ch
		leave
		retn
sub_4125BA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4125F3(SOCKET	s, int)
sub_4125F3	proc near		; CODE XREF: sub_40210E+244p

hostshort	= word ptr -48h
name		= dword	ptr -44h
namelen		= dword	ptr -40h
flags		= dword	ptr -3Ch
buf		= byte ptr -32h
var_22		= dword	ptr -22h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
s		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		lea	edx, [eax+8]
		lea	eax, [ebp+buf]
		mov	[esp+48h+namelen], eax ; int
		lea	eax, [ebp+var_22]
		mov	[esp+48h+name],	eax ; int
		mov	dword ptr [esp+48h+hostshort], edx ; char *
		call	sub_41244C
		test	eax, eax
		jz	short loc_412629
		mov	eax, 0FFFFFFFFh
		jmp	locret_4126EE
; ---------------------------------------------------------------------------

loc_412629:				; CODE XREF: sub_4125F3+2Aj
		mov	word ptr [ebp+var_22+2], 2
		movzx	eax, word ptr [ebp+var_22]
		movzx	eax, ax
		mov	dword ptr [esp+48h+hostshort], eax ; hostshort
		mov	eax, ds:htons
		call	eax ; htons
		sub	esp, 4
		mov	[ebp-1Eh], ax
		mov	dword ptr [esp+48h+hostshort], 7F000001h ; hostlong
		mov	eax, ds:htonl
		call	eax ; htonl
		sub	esp, 4
		mov	[ebp-1Ch], eax
		movzx	edx, word ptr [ebp+var_22+2]
		mov	eax, [ebp+var_10]
		mov	[eax], dx
		movzx	edx, word ptr [ebp-1Eh]
		mov	eax, [ebp+var_10]
		mov	[eax+2], dx
		mov	edx, [ebp-1Ch]
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		mov	eax, [ebp+s]
		mov	[esp+48h+namelen], 10h ; namelen
		lea	edx, [ebp+var_22+2]
		mov	[esp+48h+name],	edx ; name
		mov	dword ptr [esp+48h+hostshort], eax ; s
		mov	eax, ds:connect
		call	eax ; connect
		sub	esp, 0Ch
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4126EB
		mov	eax, [ebp+s]
		mov	[esp+48h+flags], 0 ; flags
		mov	[esp+48h+namelen], 10h ; len
		lea	edx, [ebp+buf]
		mov	[esp+48h+name],	edx ; buf
		mov	dword ptr [esp+48h+hostshort], eax ; s
		mov	eax, ds:send
		call	eax ; send
		sub	esp, 10h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_4126EB
		cmp	[ebp+var_C], 10h
		jz	short loc_4126EB
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 5
		mov	[ebp+var_C], 0FFFFFFFFh

loc_4126EB:				; CODE XREF: sub_4125F3+ACj
					; sub_4125F3+DCj ...
		mov	eax, [ebp+var_C]

locret_4126EE:				; CODE XREF: sub_4125F3+31j
		leave
		retn
sub_4125F3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4126F0	proc near		; CODE XREF: sub_4127EF+27Bp
					; sub_4127EF+2C4p ...

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_412785
		cmp	[ebp+arg_0], 0
		jz	short loc_412749
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aUtf8 ; "utf-8"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_412749
		mov	eax, ds:dword_41A3F0
		mov	[ebp+var_1C], eax
		mov	ds:dword_41A3F0, 1
		jmp	short loc_41275B
; ---------------------------------------------------------------------------

loc_412749:				; CODE XREF: sub_4126F0+1Bj
					; sub_4126F0+43j
		mov	eax, ds:dword_41A3F4
		mov	[ebp+var_1C], eax
		mov	ds:dword_41A3F4, 1

loc_41275B:				; CODE XREF: sub_4126F0+57j
		cmp	[ebp+var_1C], 0
		jnz	short loc_4127C3
		mov	[esp+38h+var_38], offset aConversionFrom ; "conversion from `%s' to `%s' not availa"...
		call	sub_40DCF4
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+var_30], edx
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], edx	; char
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_40E5B3
		jmp	short loc_4127C3
; ---------------------------------------------------------------------------

loc_412785:				; CODE XREF: sub_4126F0+15j
		mov	eax, ds:dword_41A3F8
		test	eax, eax
		jnz	short loc_4127B9
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+38h+var_38], eax ;	int
		call	strerror
		mov	ebx, eax
		mov	[esp+38h+var_38], offset aIconv_openFail ; "iconv_open failed: %s\n"
		call	sub_40DCF4
		mov	dword ptr [esp+38h+var_34], ebx	; char
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_40E5B3

loc_4127B9:				; CODE XREF: sub_4126F0+9Cj
		mov	ds:dword_41A3F8, 1

loc_4127C3:				; CODE XREF: sub_4126F0+6Fj
					; sub_4126F0+93j
		cmp	[ebp+arg_8], 0
		jz	short loc_4127E7
		mov	off_4160C0, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_41A3C0, 0
		mov	ds:dword_41A3C4, 0

loc_4127E7:				; CODE XREF: sub_4126F0+D7j
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4126F0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4127EF	proc near		; CODE XREF: sub_40615C+10p

Dest		= dword	ptr -38h
Format		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Str2		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	[ebp+arg_0], 0
		jnz	loc_4128F9
		mov	eax, ds:GetConsoleOutputCP
		call	eax ; GetConsoleOutputCP
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41281A
		mov	eax, ds:GetACP
		call	eax ; GetACP
		mov	[ebp+var_C], eax

loc_41281A:				; CODE XREF: sub_4127EF+1Fj
		mov	eax, offset aCpU ; "CP%u"
		mov	edx, [ebp+var_C]
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Format], eax ;	Format
		mov	[esp+38h+Dest],	offset byte_41A3D0 ; Dest
		call	sprintf
		mov	[ebp+arg_0], offset byte_41A3D0
		mov	[ebp+Str2], offset aCp936 ; "CP936"
		jmp	loc_4128EB
; ---------------------------------------------------------------------------

loc_412849:				; CODE XREF: sub_4127EF+104j
		mov	eax, [ebp+Str2]
		mov	[esp+38h+Format], eax ;	Str2
		mov	[esp+38h+Dest],	offset byte_41A3D0 ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_412877
		mov	eax, [ebp+Str2]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	short loc_4128A1
		mov	eax, [ebp+Str2]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4128A1

loc_412877:				; CODE XREF: sub_4127EF+6Fj
		mov	eax, [ebp+Str2]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	eax, [ebp+Str2]
		mov	[ebp+arg_0], eax
		jmp	short loc_4128F9
; ---------------------------------------------------------------------------

loc_4128A1:				; CODE XREF: sub_4127EF+79j
					; sub_4127EF+86j
		mov	eax, [ebp+Str2]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp+Str2], eax
		mov	eax, [ebp+Str2]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp+Str2], eax

loc_4128EB:				; CODE XREF: sub_4127EF+55j
		mov	eax, [ebp+Str2]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_412849

loc_4128F9:				; CODE XREF: sub_4127EF+Bj
					; sub_4127EF+B0j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 3
		jbe	short loc_41295E
		mov	[esp+38h+var_30], 3
		mov	[esp+38h+Format], offset aIso ;	"iso"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_411D0B
		test	eax, eax
		jnz	short loc_41295E
		add	[ebp+arg_0], 3
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jz	short loc_41295A
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Fh
		jnz	short loc_41295E

loc_41295A:				; CODE XREF: sub_4127EF+15Fj
		add	[ebp+arg_0], 1

loc_41295E:				; CODE XREF: sub_4127EF+132j
					; sub_4127EF+151j ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4129C4
		mov	[esp+38h+Format], offset a88591	; "8859-1"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_411BD1
		test	eax, eax
		jz	short loc_4129C4
		mov	[esp+38h+Format], offset a646 ;	"646"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_411BD1
		test	eax, eax
		jz	short loc_4129C4
		mov	[esp+38h+Format], offset aAscii	; "ASCII"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_411BD1
		test	eax, eax
		jz	short loc_4129C4
		mov	[esp+38h+Format], offset aAnsi_x3_41968	; "ANSI_X3.4-1968"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_411BD1
		test	eax, eax
		jnz	short loc_4129E7

loc_4129C4:				; CODE XREF: sub_4127EF+177j
					; sub_4127EF+18Ej ...
		mov	off_4160C0, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_41A3C0, 0
		mov	ds:dword_41A3C4, 0
		jmp	loc_412AE6
; ---------------------------------------------------------------------------

loc_4129E7:				; CODE XREF: sub_4127EF+1D3j
		mov	[esp+38h+Format], offset aUtf8_0 ; "utf8"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_411BD1
		test	eax, eax
		jz	short loc_412A15
		mov	[esp+38h+Format], offset aUtf8 ; "utf-8"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_411BD1
		test	eax, eax
		jnz	short loc_412A38

loc_412A15:				; CODE XREF: sub_4127EF+20Dj
		mov	off_4160C0, offset aUtf8 ; "utf-8"
		mov	ds:dword_41A3C0, 1
		mov	ds:dword_41A3C4, 0
		jmp	loc_412AE6
; ---------------------------------------------------------------------------

loc_412A38:				; CODE XREF: sub_4127EF+224j
		mov	[esp+38h+Format], offset aUtf8 ; "utf-8"
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Dest],	eax
		call	libiconv_open
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_412A76
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+Format], offset aUtf8 ; "utf-8"
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Dest],	eax
		call	sub_4126F0
		mov	eax, 0FFFFFFFFh
		jmp	short loc_412AEB
; ---------------------------------------------------------------------------

loc_412A76:				; CODE XREF: sub_4127EF+263j
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dest],	eax
		call	libiconv_close
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Format], eax
		mov	[esp+38h+Dest],	offset aUtf8 ; "utf-8"
		call	libiconv_open
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_412ABF
		mov	[esp+38h+var_30], 0
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Format], eax
		mov	[esp+38h+Dest],	offset aUtf8 ; "utf-8"
		call	sub_4126F0
		mov	eax, 0FFFFFFFFh
		jmp	short loc_412AEB
; ---------------------------------------------------------------------------

loc_412ABF:				; CODE XREF: sub_4127EF+2ACj
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dest],	eax
		call	libiconv_close
		mov	eax, [ebp+var_14]
		mov	off_4160C0, eax
		mov	ds:dword_41A3C0, 0
		mov	ds:dword_41A3C4, 1

loc_412AE6:				; CODE XREF: sub_4127EF+1F3j
					; sub_4127EF+244j
		mov	eax, 0

loc_412AEB:				; CODE XREF: sub_4127EF+285j
					; sub_4127EF+2CEj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_4127EF	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, off_4160C0
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_412AFB	proc near		; CODE XREF: sub_41002E+43p
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_41A3C0
		pop	ebp
		retn
sub_412AFB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_412B05	proc near		; CODE XREF: sub_412B05+129p

Dest		= dword	ptr -78h
Source		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_4C		= dword	ptr -4Ch
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_28], 0
		mov	eax, ds:dword_41A3C0
		test	eax, eax
		jz	short loc_412B37
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Dest],	eax
		call	gcry_xstrdup
		mov	[ebp+var_20], eax
		jmp	loc_412D46
; ---------------------------------------------------------------------------

loc_412B37:				; CODE XREF: sub_412B05+1Dj
		mov	eax, ds:dword_41A3C4
		test	eax, eax
		jnz	loc_412BED
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_412B62
; ---------------------------------------------------------------------------

loc_412B4C:				; CODE XREF: sub_412B05+65j
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_412B5E
		add	[ebp+var_28], 1

loc_412B5E:				; CODE XREF: sub_412B05+53j
		add	[ebp+var_1C], 1

loc_412B62:				; CODE XREF: sub_412B05+45j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_412B4C
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[esp+78h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_412BD8
; ---------------------------------------------------------------------------

loc_412B8B:				; CODE XREF: sub_412B05+DBj
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_412BC5
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		shr	al, 6
		or	eax, 0FFFFFFC0h
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		and	eax, 3Fh
		or	eax, 0FFFFFF80h
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_412BD4
; ---------------------------------------------------------------------------

loc_412BC5:				; CODE XREF: sub_412B05+8Ej
		mov	eax, [ebp+var_1C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_412BD4:				; CODE XREF: sub_412B05+BEj
		add	[ebp+var_1C], 1

loc_412BD8:				; CODE XREF: sub_412B05+84j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_412B8B
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		jmp	loc_412D46
; ---------------------------------------------------------------------------

loc_412BED:				; CODE XREF: sub_412B05+39j
		mov	eax, off_4160C0
		mov	[esp+78h+Source], eax
		mov	[esp+78h+Dest],	offset aUtf8 ; "utf-8"
		call	libiconv_open
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0FFFFFFFFh
		jnz	short loc_412C38
		mov	eax, off_4160C0
		mov	[esp+78h+var_70], 1
		mov	[esp+78h+Source], eax
		mov	[esp+78h+Dest],	offset aUtf8 ; "utf-8"
		call	sub_4126F0
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Dest],	eax
		call	sub_412B05
		jmp	loc_412D49
; ---------------------------------------------------------------------------

loc_412C38:				; CODE XREF: sub_412B05+104j
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_412C56
; ---------------------------------------------------------------------------

loc_412C40:				; CODE XREF: sub_412B05+159j
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_412C52
		add	[ebp+var_28], 5

loc_412C52:				; CODE XREF: sub_412B05+147j
		add	[ebp+var_1C], 1

loc_412C56:				; CODE XREF: sub_412B05+139j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_412C40
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[esp+78h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_40], eax
		lea	eax, [ebp+var_40]
		mov	[esp+78h+var_68], eax
		lea	eax, [ebp+var_38]
		mov	[esp+78h+var_6C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+78h+var_70], eax
		lea	eax, [ebp+var_34]
		mov	[esp+78h+Source], eax
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Dest],	eax
		call	libiconv
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_412D35
		mov	eax, ds:dword_41A3CC
		test	eax, eax
		jnz	short loc_412D17
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+78h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	esi, off_4160C0
		mov	[esp+78h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_40DCF4
		mov	[esp+78h+var_6C], ebx
		mov	[esp+78h+var_70], offset aUtf8 ; "utf-8"
		mov	[esp+78h+Source], esi ;	char
		mov	[esp+78h+Dest],	eax ; char *
		call	sub_40E5B3

loc_412D17:				; CODE XREF: sub_412B05+1D3j
		mov	ds:dword_41A3CC, 1
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Source], eax ;	Source
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Dest],	eax ; Dest
		call	strcpy
		jmp	short loc_412D3B
; ---------------------------------------------------------------------------

loc_412D35:				; CODE XREF: sub_412B05+1CAj
		mov	eax, [ebp+var_38]
		mov	byte ptr [eax],	0

loc_412D3B:				; CODE XREF: sub_412B05+22Ej
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Dest],	eax
		call	libiconv_close

loc_412D46:				; CODE XREF: sub_412B05+2Dj
					; sub_412B05+E3j
		mov	eax, [ebp+var_20]

loc_412D49:				; CODE XREF: sub_412B05+12Ej
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_412B05	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_412D51	proc near		; CODE XREF: sub_412D51+797p
					; sub_413523+23p

Dest		= dword	ptr -88h
Format		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		add	esp, 0FFFFFF80h
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 0
		mov	[ebp+var_30], 0

loc_412D75:				; CODE XREF: sub_412D51+5EDj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_14]
		mov	[ebp+var_C], eax
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		jmp	loc_413317
; ---------------------------------------------------------------------------

loc_412D9A:				; CODE XREF: sub_412D51+5CAj
		cmp	[ebp+var_30], 0
		jz	short loc_412DF9
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_412DF2
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	short loc_412DBE
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FDh
		jbe	short loc_412DF2

loc_412DBE:				; CODE XREF: sub_412D51+61j
		cmp	[ebp+var_24], 0
		jz	short loc_412DE9
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_412DE9:				; CODE XREF: sub_412D51+71j
		add	[ebp+var_1C], 4
		jmp	loc_41330F
; ---------------------------------------------------------------------------

loc_412DF2:				; CODE XREF: sub_412D51+57j
					; sub_412D51+6Bj
		mov	[ebp+var_30], 0

loc_412DF9:				; CODE XREF: sub_412D51+4Dj
		cmp	[ebp+var_C], 0
		jnz	loc_41312C
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	loc_412F84
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jz	loc_412F64
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_412E55
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_412E55
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_8]
		jz	short loc_412E55
		cmp	[ebp+arg_8], 0
		jz	loc_412F64
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_412F64

loc_412E55:				; CODE XREF: sub_412D51+D2j
					; sub_412D51+DCj ...
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_412E69
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_24], 1

loc_412E69:				; CODE XREF: sub_412D51+10Cj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, 0Dh	; switch 14 cases
		ja	loc_412F1A	; jumptable 00412E82 default case
		mov	eax, ds:off_419220[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_412E84:				; CODE XREF: sub_412D51+131j
					; DATA XREF: .rdata:off_419220o
		add	[ebp+var_1C], 1	; jumptable 00412E82 case 10
		cmp	[ebp+var_24], 0
		jz	loc_412F4B
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	6Eh
		add	[ebp+var_24], 1
		jmp	loc_412F4B
; ---------------------------------------------------------------------------

loc_412EA1:				; CODE XREF: sub_412D51+131j
					; DATA XREF: .rdata:off_419220o
		add	[ebp+var_1C], 1	; jumptable 00412E82 case 13
		cmp	[ebp+var_24], 0
		jz	loc_412F4E
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	72h
		add	[ebp+var_24], 1
		jmp	loc_412F4E
; ---------------------------------------------------------------------------

loc_412EBE:				; CODE XREF: sub_412D51+131j
					; DATA XREF: .rdata:off_419220o
		add	[ebp+var_1C], 1	; jumptable 00412E82 case 12
		cmp	[ebp+var_24], 0
		jz	loc_412F51
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	66h
		add	[ebp+var_24], 1
		jmp	short loc_412F51
; ---------------------------------------------------------------------------

loc_412ED8:				; CODE XREF: sub_412D51+131j
					; DATA XREF: .rdata:off_419220o
		add	[ebp+var_1C], 1	; jumptable 00412E82 case 11
		cmp	[ebp+var_24], 0
		jz	short loc_412F54
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	76h
		add	[ebp+var_24], 1
		jmp	short loc_412F54
; ---------------------------------------------------------------------------

loc_412EEE:				; CODE XREF: sub_412D51+131j
					; DATA XREF: .rdata:off_419220o
		add	[ebp+var_1C], 1	; jumptable 00412E82 case 8
		cmp	[ebp+var_24], 0
		jz	short loc_412F57
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	62h
		add	[ebp+var_24], 1
		jmp	short loc_412F57
; ---------------------------------------------------------------------------

loc_412F04:				; CODE XREF: sub_412D51+131j
					; DATA XREF: .rdata:off_419220o
		add	[ebp+var_1C], 1	; jumptable 00412E82 case 0
		cmp	[ebp+var_24], 0
		jz	short loc_412F5A
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	30h
		add	[ebp+var_24], 1
		jmp	short loc_412F5A
; ---------------------------------------------------------------------------

loc_412F1A:				; CODE XREF: sub_412D51+124j
					; sub_412D51+131j
					; DATA XREF: ...
		add	[ebp+var_1C], 3	; jumptable 00412E82 default case
		cmp	[ebp+var_24], 0
		jz	short loc_412F5D
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_2 ; "x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 3
		jmp	short loc_412F5D
; ---------------------------------------------------------------------------

loc_412F4B:				; CODE XREF: sub_412D51+13Bj
					; sub_412D51+14Bj
		nop
		jmp	short loc_412F5E
; ---------------------------------------------------------------------------

loc_412F4E:				; CODE XREF: sub_412D51+158j
					; sub_412D51+168j
		nop
		jmp	short loc_412F5E
; ---------------------------------------------------------------------------

loc_412F51:				; CODE XREF: sub_412D51+175j
					; sub_412D51+185j
		nop
		jmp	short loc_412F5E
; ---------------------------------------------------------------------------

loc_412F54:				; CODE XREF: sub_412D51+18Fj
					; sub_412D51+19Bj
		nop
		jmp	short loc_412F5E
; ---------------------------------------------------------------------------

loc_412F57:				; CODE XREF: sub_412D51+1A5j
					; sub_412D51+1B1j
		nop
		jmp	short loc_412F5E
; ---------------------------------------------------------------------------

loc_412F5A:				; CODE XREF: sub_412D51+1BBj
					; sub_412D51+1C7j
		nop
		jmp	short loc_412F5E
; ---------------------------------------------------------------------------

loc_412F5D:				; CODE XREF: sub_412D51+1D1j
					; sub_412D51+1F8j
		nop

loc_412F5E:				; CODE XREF: sub_412D51+1FBj
					; sub_412D51+1FEj ...
		nop
		jmp	loc_41330F
; ---------------------------------------------------------------------------

loc_412F64:				; CODE XREF: sub_412D51+C4j
					; sub_412D51+F0j ...
		cmp	[ebp+var_24], 0
		jz	short loc_412F7B
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_412F7B:				; CODE XREF: sub_412D51+217j
		add	[ebp+var_1C], 1
		jmp	loc_41330F
; ---------------------------------------------------------------------------

loc_412F84:				; CODE XREF: sub_412D51+BAj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0E0h
		cmp	eax, 0C0h
		jnz	short loc_412FCD
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 1
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_41330F
; ---------------------------------------------------------------------------

loc_412FCD:				; CODE XREF: sub_412D51+246j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F0h
		cmp	eax, 0E0h
		jnz	short loc_413016
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 2
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_41330F
; ---------------------------------------------------------------------------

loc_413016:				; CODE XREF: sub_412D51+28Fj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F8h
		cmp	eax, 0F0h
		jnz	short loc_41305F
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 7
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 3
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_41330F
; ---------------------------------------------------------------------------

loc_41305F:				; CODE XREF: sub_412D51+2D8j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FCh
		cmp	eax, 0F8h
		jnz	short loc_4130A8
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 4
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_41330F
; ---------------------------------------------------------------------------

loc_4130A8:				; CODE XREF: sub_412D51+321j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FEh
		cmp	eax, 0FCh
		jnz	short loc_4130F1
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 5
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_41330F
; ---------------------------------------------------------------------------

loc_4130F1:				; CODE XREF: sub_412D51+36Aj
		cmp	[ebp+var_24], 0
		jz	short loc_41311C
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_41311C:				; CODE XREF: sub_412D51+3A4j
		add	[ebp+var_1C], 4
		mov	[ebp+var_30], 1
		jmp	loc_41330F
; ---------------------------------------------------------------------------

loc_41312C:				; CODE XREF: sub_412D51+ACj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_413144
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	loc_4131D2

loc_413144:				; CODE XREF: sub_412D51+3E3j
		cmp	[ebp+var_24], 0
		jz	short loc_4131AC
		mov	[ebp+var_10], 0
		jmp	short loc_41317F
; ---------------------------------------------------------------------------

loc_413153:				; CODE XREF: sub_412D51+434j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_41317F:				; CODE XREF: sub_412D51+400j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_413153
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_4131AC:				; CODE XREF: sub_412D51+3F7j
		mov	eax, [ebp+var_14]
		add	eax, 1
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_30], 1
		jmp	loc_41330F
; ---------------------------------------------------------------------------

loc_4131D2:				; CODE XREF: sub_412D51+3EDj
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		shl	[ebp+var_28], 6
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3Fh
		or	[ebp+var_28], eax
		sub	[ebp+var_C], 1
		cmp	[ebp+var_C], 0
		jnz	loc_41330F
		mov	eax, ds:dword_41A3C0
		test	eax, eax
		jz	short loc_41324F
		cmp	[ebp+var_24], 0
		jz	short loc_41323D
		mov	[ebp+var_10], 0
		jmp	short loc_413235
; ---------------------------------------------------------------------------

loc_41321D:				; CODE XREF: sub_412D51+4EAj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_413235:				; CODE XREF: sub_412D51+4CAj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_41321D

loc_41323D:				; CODE XREF: sub_412D51+4C1j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	loc_41330F
; ---------------------------------------------------------------------------

loc_41324F:				; CODE XREF: sub_412D51+4BBj
		cmp	[ebp+arg_C], 0
		jz	short loc_413293
		cmp	[ebp+var_24], 0
		jz	short loc_413284
		mov	[ebp+var_10], 0
		jmp	short loc_41327C
; ---------------------------------------------------------------------------

loc_413264:				; CODE XREF: sub_412D51+531j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_41327C:				; CODE XREF: sub_412D51+511j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_413264

loc_413284:				; CODE XREF: sub_412D51+508j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_41330F
; ---------------------------------------------------------------------------

loc_413293:				; CODE XREF: sub_412D51+502j
		cmp	[ebp+var_28], 7Fh
		jbe	short loc_4132BC
		cmp	[ebp+var_28], 0FFh
		ja	short loc_4132BC
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_41330F
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_41330F
; ---------------------------------------------------------------------------

loc_4132BC:				; CODE XREF: sub_412D51+546j
					; sub_412D51+54Fj
		cmp	[ebp+var_24], 0
		jz	short loc_4132FF
		mov	[ebp+var_10], 0
		jmp	short loc_4132F7
; ---------------------------------------------------------------------------

loc_4132CB:				; CODE XREF: sub_412D51+5ACj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_4132F7:				; CODE XREF: sub_412D51+578j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_4132CB

loc_4132FF:				; CODE XREF: sub_412D51+56Fj
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0

loc_41330F:				; CODE XREF: sub_412D51+9Cj
					; sub_412D51+20Ej ...
		add	[ebp+var_18], 1
		sub	[ebp+var_2C], 1

loc_413317:				; CODE XREF: sub_412D51+44j
		cmp	[ebp+var_2C], 0
		jnz	loc_412D9A
		cmp	[ebp+var_20], 0
		jnz	short loc_413343
		mov	eax, [ebp+var_1C]
		add	eax, 1
		mov	[esp+88h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax
		jmp	loc_412D75
; ---------------------------------------------------------------------------

loc_413343:				; CODE XREF: sub_412D51+5D4j
		cmp	[ebp+arg_C], 0
		jz	loc_413513
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, off_4160C0
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	libiconv_open
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0FFFFFFFFh
		jnz	short loc_4133B7
		mov	eax, off_4160C0
		mov	[esp+88h+var_80], 1
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	sub_4126F0
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax
		call	gcry_free
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_413523
		jmp	loc_41351C
; ---------------------------------------------------------------------------

loc_4133B7:				; CODE XREF: sub_412D51+61Ej
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		sub	eax, 1
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_44], eax
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_50]
		mov	[ebp+var_5C], eax
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_5C]
		mul	edx
		mov	eax, edx
		shr	eax, 2
		cmp	eax, [ebp+var_1C]
		jz	short loc_41341B
		mov	[esp+88h+var_80], offset aDo_utf8_to_nat ; "do_utf8_to_native"
		mov	[esp+88h+Format], 24Ah
		mov	[esp+88h+Dest],	offset a____Gnupg22__5 ; "../../gnupg2-2.0.30/jnlib/utf8conv.c"
		call	sub_40E76C
; ---------------------------------------------------------------------------

loc_41341B:				; CODE XREF: sub_412D51+6ACj
		mov	eax, [ebp+var_50]
		mov	[esp+88h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_48]
		mov	[ebp+var_34], eax
		lea	eax, [ebp+var_50]
		mov	[esp+88h+var_78], eax
		lea	eax, [ebp+var_48]
		mov	[esp+88h+var_7C], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+88h+var_80], eax
		lea	eax, [ebp+var_44]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	libiconv
		cmp	eax, 0FFFFFFFFh
		jnz	loc_4134F2
		mov	eax, ds:dword_41A3C8
		test	eax, eax
		jnz	short loc_4134A5
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+88h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	esi, off_4160C0
		mov	[esp+88h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_40DCF4
		mov	[esp+88h+var_7C], ebx
		mov	[esp+88h+var_80], esi
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax ; char *
		call	sub_40E5B3

loc_4134A5:				; CODE XREF: sub_412D51+715j
		mov	ds:dword_41A3C8, 1
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax
		call	gcry_free
		mov	[ebp+var_20], 0
		mov	eax, [ebp+var_34]
		mov	[esp+88h+Dest],	eax
		call	gcry_free
		mov	[esp+88h+var_7C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_412D51
		mov	[ebp+var_34], eax
		jmp	short loc_413503
; ---------------------------------------------------------------------------

loc_4134F2:				; CODE XREF: sub_412D51+708j
		mov	eax, [ebp+var_48]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax
		call	gcry_free

loc_413503:				; CODE XREF: sub_412D51+79Fj
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	libiconv_close
		mov	eax, [ebp+var_34]
		jmp	short loc_41351C
; ---------------------------------------------------------------------------

loc_413513:				; CODE XREF: sub_412D51+5F6j
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]

loc_41351C:				; CODE XREF: sub_412D51+661j
					; sub_412D51+7C0j
		sub	esp, 0FFFFFF80h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_412D51	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413523	proc near		; CODE XREF: .text:0040C1B3p
					; sub_411708+50p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_41A3C4
		mov	[esp+18h+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_412D51
		leave
		retn
sub_413523	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv_open
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+18h]
		mov	[esp+10h], eax
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv_close
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4135AC	proc near		; CODE XREF: sub_413706+14p

var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 10h
		cmp	[ebp+arg_0], 0
		jnz	short loc_4135C6
		mov	[ebp+var_C], 80000001h
		jmp	loc_4136FC
; ---------------------------------------------------------------------------

loc_4135C6:				; CODE XREF: sub_4135AC+Cj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_classes_r ; "HKEY_CLASSES_ROOT"
		mov	ecx, 12h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4135FA
		mov	[ebp+var_C], 80000000h
		jmp	loc_4136FC
; ---------------------------------------------------------------------------

loc_4135FA:				; CODE XREF: sub_4135AC+40j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_current_u ; "HKEY_CURRENT_USER"
		mov	ecx, 12h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_41362E
		mov	[ebp+var_C], 80000001h
		jmp	loc_4136FC
; ---------------------------------------------------------------------------

loc_41362E:				; CODE XREF: sub_4135AC+74j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_local_mac ; "HKEY_LOCAL_MACHINE"
		mov	ecx, 13h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_413662
		mov	[ebp+var_C], 80000002h
		jmp	loc_4136FC
; ---------------------------------------------------------------------------

loc_413662:				; CODE XREF: sub_4135AC+A8j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_users	; "HKEY_USERS"
		mov	ecx, 0Bh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_413693
		mov	[ebp+var_C], 80000003h
		jmp	short loc_4136FC
; ---------------------------------------------------------------------------

loc_413693:				; CODE XREF: sub_4135AC+DCj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_performan ; "HKEY_PERFORMANCE_DATA"
		mov	ecx, 16h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4136C4
		mov	[ebp+var_C], 80000004h
		jmp	short loc_4136FC
; ---------------------------------------------------------------------------

loc_4136C4:				; CODE XREF: sub_4135AC+10Dj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_current_c ; "HKEY_CURRENT_CONFIG"
		mov	ecx, 14h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4136F5
		mov	[ebp+var_C], 80000005h
		jmp	short loc_4136FC
; ---------------------------------------------------------------------------

loc_4136F5:				; CODE XREF: sub_4135AC+13Ej
		mov	eax, 0
		jmp	short loc_4136FF
; ---------------------------------------------------------------------------

loc_4136FC:				; CODE XREF: sub_4135AC+15j
					; sub_4135AC+49j ...
		mov	eax, [ebp+var_C]

loc_4136FF:				; CODE XREF: sub_4135AC+14Ej
		add	esp, 10h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4135AC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_413706(int, LPCSTR, LPCSTR lpValueName)
sub_413706	proc near		; CODE XREF: sub_406435+71p

hKey		= dword	ptr -58h
lpSubKey	= dword	ptr -54h
ulOptions	= dword	ptr -50h
samDesired	= dword	ptr -4Ch
phkResult	= dword	ptr -48h
lpcbData	= dword	ptr -44h
var_2C		= dword	ptr -2Ch
Type		= dword	ptr -24h
cbData		= dword	ptr -20h
nSize		= dword	ptr -1Ch
var_18		= dword	ptr -18h
lpDst		= dword	ptr -14h
var_10		= dword	ptr -10h
lpData		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
lpValueName	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	[ebp+lpData], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+hKey],	eax
		call	sub_4135AC
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_413732
		mov	eax, 0
		jmp	loc_413A22
; ---------------------------------------------------------------------------

loc_413732:				; CODE XREF: sub_413706+20j
		lea	eax, [ebp+var_18]
		mov	[esp+58h+phkResult], eax ; phkResult
		mov	[esp+58h+samDesired], 20019h ; samDesired
		mov	[esp+58h+ulOptions], 0 ; ulOptions
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+lpSubKey], eax	; lpSubKey
		mov	eax, [ebp+var_10]
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegOpenKeyExA
		call	eax ; RegOpenKeyExA
		sub	esp, 14h
		test	eax, eax
		jz	short loc_4137B1
		cmp	[ebp+arg_0], 0
		jz	short loc_413774
		mov	eax, 0
		jmp	loc_413A22
; ---------------------------------------------------------------------------

loc_413774:				; CODE XREF: sub_413706+62j
		lea	eax, [ebp+var_18]
		mov	[esp+58h+phkResult], eax ; phkResult
		mov	[esp+58h+samDesired], 20019h ; samDesired
		mov	[esp+58h+ulOptions], 0 ; ulOptions
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+lpSubKey], eax	; lpSubKey
		mov	[esp+58h+hKey],	80000002h ; hKey
		mov	eax, ds:RegOpenKeyExA
		call	eax ; RegOpenKeyExA
		sub	esp, 14h
		test	eax, eax
		jz	short loc_4137B1
		mov	eax, 0
		jmp	loc_413A22
; ---------------------------------------------------------------------------

loc_4137B1:				; CODE XREF: sub_413706+5Cj
					; sub_413706+9Fj
		mov	[ebp+cbData], 1
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+cbData]
		mov	[esp+58h+lpcbData], edx	; lpcbData
		mov	[esp+58h+phkResult], 0 ; lpData
		mov	[esp+58h+samDesired], 0	; lpType
		mov	[esp+58h+ulOptions], 0 ; lpReserved
		mov	edx, [ebp+lpValueName]
		mov	[esp+58h+lpSubKey], edx	; lpValueName
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegQueryValueExA
		call	eax ; RegQueryValueExA
		sub	esp, 18h
		test	eax, eax
		jnz	loc_413A05
		mov	eax, [ebp+cbData]
		add	eax, 1
		mov	[ebp+nSize], eax
		mov	eax, [ebp+nSize]
		mov	[esp+58h+hKey],	eax
		call	gcry_malloc
		mov	[ebp+lpData], eax
		cmp	[ebp+lpData], 0
		jz	loc_413A08
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+nSize]
		mov	[esp+58h+lpcbData], edx	; lpcbData
		mov	edx, [ebp+lpData]
		mov	[esp+58h+phkResult], edx ; lpData
		lea	edx, [ebp+Type]
		mov	[esp+58h+samDesired], edx ; lpType
		mov	[esp+58h+ulOptions], 0 ; lpReserved
		mov	edx, [ebp+lpValueName]
		mov	[esp+58h+lpSubKey], edx	; lpValueName
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegQueryValueExA
		call	eax ; RegQueryValueExA
		sub	esp, 18h
		test	eax, eax
		jz	short loc_413866
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		mov	[ebp+lpData], 0
		jmp	loc_413A0F
; ---------------------------------------------------------------------------

loc_413866:				; CODE XREF: sub_413706+147j
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpData]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+Type]
		cmp	eax, 2
		jnz	loc_413A0F
		mov	[esp+58h+lpSubKey], 25h	; Val
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; Str
		call	strchr
		test	eax, eax
		jz	loc_413A0F
		mov	eax, [ebp+nSize]
		add	eax, 3E8h
		mov	[ebp+nSize], eax
		mov	eax, [ebp+nSize]
		add	eax, 1
		mov	[esp+58h+hKey],	eax
		call	gcry_malloc
		mov	[ebp+lpDst], eax
		cmp	[ebp+lpDst], 0
		jz	loc_413A0B
		mov	eax, [ebp+nSize]
		mov	[esp+58h+ulOptions], eax ; nSize
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; lpDst
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; lpSrc
		mov	eax, ds:ExpandEnvironmentStringsA
		call	eax ; ExpandEnvironmentStringsA
		sub	esp, 0Ch
		mov	[ebp+cbData], eax
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	loc_413983
		mov	edx, [ebp+cbData]
		mov	eax, [ebp+nSize]
		cmp	edx, eax
		jbe	loc_413983
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		mov	eax, [ebp+cbData]
		mov	[ebp+nSize], eax
		mov	eax, [ebp+nSize]
		add	eax, 1
		mov	[esp+58h+hKey],	eax
		call	gcry_malloc
		mov	[ebp+lpDst], eax
		cmp	[ebp+lpDst], 0
		jz	loc_413A0E
		mov	eax, [ebp+nSize]
		mov	[esp+58h+ulOptions], eax ; nSize
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; lpDst
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; lpSrc
		mov	eax, ds:ExpandEnvironmentStringsA
		call	eax ; ExpandEnvironmentStringsA
		sub	esp, 0Ch
		mov	[ebp+cbData], eax
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	short loc_413964
		mov	edx, [ebp+cbData]
		mov	eax, [ebp+nSize]
		cmp	edx, eax
		jbe	short loc_413964
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		jmp	loc_413A0F
; ---------------------------------------------------------------------------

loc_413964:				; CODE XREF: sub_413706+242j
					; sub_413706+24Cj
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpDst]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		mov	eax, [ebp+lpDst]
		mov	[ebp+lpData], eax
		jmp	loc_413A0F
; ---------------------------------------------------------------------------

loc_413983:				; CODE XREF: sub_413706+1DCj
					; sub_413706+1EAj
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	short loc_4139F8
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpDst]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		mov	eax, [ebp+lpDst]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+58h+hKey],	eax
		call	gcry_malloc
		mov	[ebp+lpData], eax
		cmp	[ebp+lpData], 0
		jnz	short loc_4139D9
		mov	eax, [ebp+lpDst]
		mov	[ebp+lpData], eax
		jmp	short loc_413A0F
; ---------------------------------------------------------------------------

loc_4139D9:				; CODE XREF: sub_413706+2C9j
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; Source
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		jmp	short loc_413A0F
; ---------------------------------------------------------------------------

loc_4139F8:				; CODE XREF: sub_413706+282j
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		jmp	short loc_413A0F
; ---------------------------------------------------------------------------

loc_413A05:				; CODE XREF: sub_413706+EAj
		nop
		jmp	short loc_413A0F
; ---------------------------------------------------------------------------

loc_413A08:				; CODE XREF: sub_413706+10Bj
		nop
		jmp	short loc_413A0F
; ---------------------------------------------------------------------------

loc_413A0B:				; CODE XREF: sub_413706+1B0j
		nop
		jmp	short loc_413A0F
; ---------------------------------------------------------------------------

loc_413A0E:				; CODE XREF: sub_413706+216j
		nop

loc_413A0F:				; CODE XREF: sub_413706+15Bj
					; sub_413706+16Fj ...
		mov	eax, [ebp+var_18]
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegCloseKey
		call	eax ; RegCloseKey
		sub	esp, 4
		mov	eax, [ebp+lpData]

loc_413A22:				; CODE XREF: sub_413706+27j
					; sub_413706+69j ...
		mov	edi, [ebp+var_4]
		leave
		retn
sub_413706	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_free]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_malloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_malloc_secure]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_xmalloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_xstrdup]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_strdup]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_realloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_err_code_from_errno]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gpg_err_code_from_syserror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_strerror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION libiconv_open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION libiconv_close]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION libiconv]
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:0041C024o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_413AC0
		cmp	eax, 3
		jz	short loc_413AC0
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_413AC0:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_414CB0
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_401180+113p
					; DATA XREF: .rdata:off_419314o ...

lpLibFileName	= dword	ptr -1Ch
lpProcName	= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		mov	edx, ds:_winmajor
		mov	eax, [esp+1Ch+arg_4]
		cmp	dword ptr [edx], 3
		jbe	short loc_413B34
		cmp	dword_4160D4, 2
		jz	short loc_413B16
		mov	dword_4160D4, 2

loc_413B16:				; CODE XREF: TlsCallback_0+1Aj
		cmp	eax, 2
		jz	loc_413C23
		cmp	eax, 1
		jz	loc_413BC2

loc_413B28:				; CODE XREF: TlsCallback_0+EEj
					; TlsCallback_0+13Ej
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_413B34:				; CODE XREF: TlsCallback_0+11j
		mov	ds:dword_41A850, 1
		mov	[esp+1Ch+lpLibFileName], offset	LibFileName ; "mingwm10.dll"
		call	ds:LoadLibraryA
		sub	esp, 4
		test	eax, eax
		mov	ds:hLibModule, eax
		jz	loc_413C53
		mov	ebx, ds:GetProcAddress
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_rem ; "__mingwthr_remove_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	ds:dword_41A84C, eax
		mov	eax, ds:hLibModule
		sub	esp, 8
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_key ; "__mingwthr_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	edx, ds:hLibModule
		sub	esp, 8
		test	edx, edx
		mov	ds:dword_41A848, eax
		jz	loc_413C53
		mov	ecx, ds:dword_41A84C
		test	ecx, ecx
		jz	short loc_413BE3
		test	eax, eax
		jz	short loc_413BE3
		mov	dword_4160D4, 1
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_413BC2:				; CODE XREF: TlsCallback_0+32j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+lpProcName], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpLibFileName], eax
		call	sub_414CB0
		jmp	loc_413B28
; ---------------------------------------------------------------------------

loc_413BE3:				; CODE XREF: TlsCallback_0+B6j
					; TlsCallback_0+BAj
		mov	ds:dword_41A848, 0
		mov	ds:dword_41A84C, 0
		mov	[esp+1Ch+lpLibFileName], edx ; hLibModule
		call	ds:FreeLibrary
		sub	esp, 4

loc_413C03:				; CODE XREF: TlsCallback_0+177j
		mov	ds:hLibModule, 0
		mov	eax, 1
		mov	dword_4160D4, 0
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_413C23:				; CODE XREF: TlsCallback_0+29j
		mov	ebx, offset dword_41C030
		cmp	ebx, offset dword_41C030
		jz	loc_413B28

loc_413C34:				; CODE XREF: TlsCallback_0+155j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_413C3C
		call	eax

loc_413C3C:				; CODE XREF: TlsCallback_0+148j
		add	ebx, 4
		cmp	ebx, offset dword_41C030
		jnz	short loc_413C34
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_413C53:				; CODE XREF: TlsCallback_0+65j
					; TlsCallback_0+A8j
		mov	ds:dword_41A848, 0
		mov	ds:dword_41A84C, 0
		jmp	short loc_413C03
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_413C80	proc near		; DATA XREF: .CRT:0041C014o
		mov	eax, ds:__lconv_init
		jmp	eax
sub_413C80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_413C90	proc near		; CODE XREF: sub_413CB0+10p
					; sub_413CB0+36p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_413C90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_413CA0	proc near		; CODE XREF: sub_401060+59p
					; sub_413CB0+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_413CA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_413CB0(_onexit_t)
sub_413CB0	proc near		; CODE XREF: sub_413D70+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_41A858
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_413C90
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_14], eax
		jz	loc_413D50
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_41A858
		mov	[esp+2Ch+Func],	eax
		call	sub_413C90
		mov	[esp+2Ch+var_14], eax
		mov	eax, ds:dword_41A854
		mov	[esp+2Ch+Func],	eax
		call	sub_413C90
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_10], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_413CA0
		mov	ds:dword_41A858, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_413CA0
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_41A854, eax
		call	_unlock
		add	esp, 28h
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_413D50:				; CODE XREF: sub_413CB0+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_413CB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_413D70(_onexit_t)
sub_413D70	proc near		; CODE XREF: sub_407405+20p
					; sub_414990-27p ...

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_413CB0
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_413D70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LONG __stdcall TopLevelExceptionFilter(struct	_EXCEPTION_POINTERS *ExceptionInfo)
TopLevelExceptionFilter	proc near	; DATA XREF: sub_401180+11Do

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
ExceptionInfo	= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 24h
		mov	ebx, [esp+2Ch+ExceptionInfo]
		mov	eax, [ebx]
		mov	eax, [eax]
		cmp	eax, 0C0000091h
		ja	short loc_413DE7
		cmp	eax, 0C000008Dh
		jb	short loc_413E14

loc_413DAB:				; CODE XREF: TopLevelExceptionFilter+6Aj
		mov	esi, 1

loc_413DB0:				; CODE XREF: TopLevelExceptionFilter+C7j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 8
		call	signal
		cmp	eax, 1
		jz	loc_413EE0
		test	eax, eax
		jz	short loc_413DFC
		mov	[esp+2Ch+var_2C], 8
		call	eax
		mov	eax, 0FFFFFFFFh

loc_413DDF:				; CODE XREF: TopLevelExceptionFilter+120j
					; TopLevelExceptionFilter+13Ej	...
		add	esp, 24h
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_413DE7:				; CODE XREF: TopLevelExceptionFilter+12j
		cmp	eax, 0C0000094h
		jz	short loc_413E55
		cmp	eax, 0C0000096h
		jz	short loc_413E22
		cmp	eax, 0C0000093h
		jz	short loc_413DAB

loc_413DFC:				; CODE XREF: TopLevelExceptionFilter+3Fj
					; TopLevelExceptionFilter+90j ...
		mov	eax, ds:dword_41A424
		test	eax, eax
		jz	loc_413ED3
		mov	[esp+2Ch+ExceptionInfo], ebx
		add	esp, 24h
		pop	ebx
		pop	esi
		jmp	eax
; ---------------------------------------------------------------------------

loc_413E14:				; CODE XREF: TopLevelExceptionFilter+19j
		cmp	eax, 0C0000005h
		jz	short loc_413E60
		cmp	eax, 0C000001Dh
		jnz	short loc_413DFC

loc_413E22:				; CODE XREF: TopLevelExceptionFilter+63j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 4
		call	signal
		cmp	eax, 1
		jz	short loc_413E97
		test	eax, eax
		jz	short loc_413DFC
		mov	[esp+2Ch+var_2C], 4
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_413E55:				; CODE XREF: TopLevelExceptionFilter+5Cj
		xor	esi, esi
		jmp	loc_413DB0
; ---------------------------------------------------------------------------
		align 10h

loc_413E60:				; CODE XREF: TopLevelExceptionFilter+89j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		cmp	eax, 1
		jz	short loc_413EB5
		test	eax, eax
		jz	loc_413DFC
		mov	[esp+2Ch+var_2C], 0Bh
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_413E97:				; CODE XREF: TopLevelExceptionFilter+A9j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 4
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_413DDF
; ---------------------------------------------------------------------------

loc_413EB5:				; CODE XREF: TopLevelExceptionFilter+E7j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_413DDF
; ---------------------------------------------------------------------------

loc_413ED3:				; CODE XREF: TopLevelExceptionFilter+73j
		xor	eax, eax
		jmp	loc_413DDF
; ---------------------------------------------------------------------------
		align 10h

loc_413EE0:				; CODE XREF: TopLevelExceptionFilter+37j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 8
		call	signal
		test	esi, esi
		mov	eax, 0FFFFFFFFh
		jz	loc_413DDF
		mov	[esp+2Ch+var_10], eax
		call	sub_414900
		mov	eax, [esp+2Ch+var_10]
		jmp	loc_413DDF
TopLevelExceptionFilter	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 3Ch
		mov	eax, ds:dword_41A428
		fld	qword ptr [esp+48h]
		fld	qword ptr [esp+50h]
		fld	qword ptr [esp+58h]
		test	eax, eax
		jz	short loc_413F61
		fxch	st(2)
		mov	edx, [esp+40h]
		fstp	qword ptr [esp+18h]
		fstp	qword ptr [esp+20h]
		fstp	qword ptr [esp+28h]
		mov	[esp+10h], edx
		mov	edx, [esp+44h]
		mov	[esp+14h], edx
		lea	edx, [esp+10h]
		mov	[esp], edx
		call	eax ; dword_41A428
		jmp	short loc_413F67
; ---------------------------------------------------------------------------

loc_413F61:				; CODE XREF: .text:00413F36j
		fstp	st
		fstp	st
		fstp	st

loc_413F67:				; CODE XREF: .text:00413F5Fj
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_413F70	proc near		; CODE XREF: sub_401060+F7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ds:dword_41A428, eax
		jmp	__setusermatherr
sub_413F70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_413F80	proc near		; DATA XREF: sub_401060:loc_401150o

File		= dword	ptr -3Ch
Format		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= qword	ptr -2Ch
var_24		= qword	ptr -24h
var_1C		= qword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 3Ch
		mov	edx, offset aUnknownError ; "Unknown error"
		mov	eax, [esp+3Ch+arg_0]
		mov	ecx, [eax]
		sub	ecx, 1
		cmp	ecx, 5
		ja	short loc_413F9D
		mov	edx, ds:off_419434[ecx*4]

loc_413F9D:				; CODE XREF: sub_413F80+14j
		fld	qword ptr [eax+18h]
		fstp	[esp+3Ch+var_1C]
		fld	qword ptr [eax+10h]
		fstp	[esp+3Ch+var_24]
		fld	qword ptr [eax+8]
		fstp	[esp+3Ch+var_2C]
		mov	eax, [eax+4]
		mov	[esp+3Ch+var_34], edx
		mov	[esp+3Ch+Format], offset a_matherrSInSGG ; "_matherr():	%s in %s(%g, %g)  (retval=%"...
		mov	[esp+3Ch+var_30], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+3Ch+File],	eax ; File
		call	fprintf
		xor	eax, eax
		add	esp, 3Ch
		retn
sub_413F80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_413FE0	proc near		; CODE XREF: sub_401060+75p
		xor	eax, eax
		retn
sub_413FE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_413FF0(char *Format, char ArgList)
sub_413FF0	proc near		; CODE XREF: sub_414050+1DDp
					; sub_414050+204p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aMingwW64Runtim ;	"Mingw-w64 runtime failure:\n"
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_413FF0	endp

; ---------------------------------------------------------------------------
		jmp	short sub_414050
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_414050(size_t Size)
sub_414050	proc near		; CODE XREF: .text:00414041j
					; sub_414290+B8p ...

lpAddress	= dword	ptr -7Ch
lpBuffer	= dword	ptr -78h
dwLength	= dword	ptr -74h
lpflOldProtect	= dword	ptr -70h
var_64		= dword	ptr -64h
Src		= dword	ptr -60h
var_58		= _MEMORY_BASIC_INFORMATION ptr	-58h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h

		push	ebp
		mov	ebp, ecx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 6Ch
		mov	ecx, ds:dword_41A434
		mov	[esp+7Ch+Src], edx
		test	ecx, ecx
		jle	loc_414232
		mov	eax, ds:dword_41A430
		xor	esi, esi

loc_414074:				; CODE XREF: sub_414050+41j
		mov	edx, [eax+4]
		cmp	ebx, edx
		jb	short loc_414089
		mov	edi, [eax+8]
		add	edx, [edi+8]
		cmp	ebx, edx
		jb	loc_414160

loc_414089:				; CODE XREF: sub_414050+29j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jnz	short loc_414074

loc_414093:				; CODE XREF: sub_414050+1E4j
		mov	[esp+7Ch+lpAddress], ebx
		call	sub_414650
		test	eax, eax
		mov	edi, eax
		jz	loc_414259
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_41A430
		shl	edx, 2
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		mov	[esp+7Ch+var_64], edx
		call	sub_414730
		mov	edx, [esp+7Ch+var_64]
		add	eax, [edi+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+7Ch+Buffer]
		mov	esi, ds:VirtualQuery
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_41A430
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+7Ch+var_64]
		jz	loc_414239
		mov	eax, [esp+7Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	loc_4141E1

loc_41410F:				; CODE XREF: sub_414050+194j
					; sub_414050+1C6j
		add	ds:dword_41A434, 1

loc_414116:				; CODE XREF: sub_414050+116j
		lea	eax, [esp+7Ch+var_58]
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	[esp+7Ch+lpAddress], ebx ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_414269
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 4
		jnz	short loc_414168

loc_41413F:				; CODE XREF: sub_414050+11Bj
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy

loc_414153:				; CODE XREF: sub_414050+162j
					; sub_414050+167j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_414160:				; CODE XREF: sub_414050+33j
		mov	esi, ds:VirtualQuery
		jmp	short loc_414116
; ---------------------------------------------------------------------------

loc_414168:				; CODE XREF: sub_414050+EDj
		cmp	eax, 40h
		jz	short loc_41413F
		mov	eax, [esp+7Ch+var_58.RegionSize]
		lea	edi, [esp+7Ch+flOldProtect]
		mov	esi, ds:VirtualProtect
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 40h
		jz	short loc_414153
		cmp	eax, 4
		jz	short loc_414153
		mov	eax, [esp+7Ch+flOldProtect]
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], eax	; flNewProtect
		mov	eax, [esp+7Ch+var_58.RegionSize]
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4141E1:				; CODE XREF: sub_414050+B9j
		cmp	eax, 40h
		jz	loc_41410F
		mov	eax, [esp+7Ch+Buffer.RegionSize]
		add	edx, ds:dword_41A430
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+Buffer.BaseAddress]
		mov	[esp+7Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		test	eax, eax
		jnz	loc_41410F
		call	ds:GetLastError
		mov	[esp+7Ch+lpAddress], offset aVirtualprotect ; "	 VirtualProtect	failed with code 0x%x"
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_413FF0
; ---------------------------------------------------------------------------

loc_414232:				; CODE XREF: sub_414050+17j
		xor	esi, esi
		jmp	loc_414093
; ---------------------------------------------------------------------------

loc_414239:				; CODE XREF: sub_414050+ACj
		mov	eax, ds:dword_41A430
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+dwLength], eax
		mov	eax, [edi+8]
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_413FF0
; ---------------------------------------------------------------------------

loc_414259:				; CODE XREF: sub_414050+4Fj
		mov	[esp+7Ch+lpBuffer], ebx	; ArgList
		mov	[esp+7Ch+lpAddress], offset aAddressPHasNoI ; "Address %p has no image-section"
		call	sub_413FF0
; ---------------------------------------------------------------------------

loc_414269:				; CODE XREF: sub_414050+E0j
		mov	[esp+7Ch+dwLength], ebx
		mov	[esp+7Ch+lpBuffer], 1Ch	; ArgList
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		call	sub_413FF0
sub_414050	endp

; ---------------------------------------------------------------------------
		db 0EBh	; 
		db  0Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414290	proc near		; CODE XREF: sub_401180:loc_401298p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
var_20		= dword	ptr -20h
flOldProtect	= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_41A42C
		test	eax, eax
		jz	short loc_4142B0

loc_4142A2:				; CODE XREF: sub_414290+66j
					; sub_414290+96j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4142B0:				; CODE XREF: sub_414290+10j
		mov	ds:dword_41A42C, 1
		call	sub_414690
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_414D50
		mov	ds:dword_41A434, 0
		sub	esp, eax
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_41A430, eax
		mov	eax, offset dword_4195C4
		sub	eax, offset dword_4195C4
		cmp	eax, 7
		jle	short loc_4142A2
		cmp	eax, 0Bh
		mov	ebx, offset dword_4195C4
		jle	loc_4143F0
		mov	eax, ds:dword_4195C4
		test	eax, eax
		jnz	short loc_414320
		mov	eax, ds:dword_4195C8
		test	eax, eax
		jz	loc_4143DC
		lea	esi, [esi+0]

loc_414320:				; CODE XREF: sub_414290+7Dj
					; sub_414290+164j ...
		cmp	ebx, offset dword_4195C4
		jnb	loc_4142A2
		mov	esi, 400000h

loc_414331:				; CODE XREF: sub_414290+C3j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		lea	edx, [ebp+flOldProtect]
		call	sub_414050
		cmp	ebx, offset dword_4195C4
		jb	short loc_414331

loc_414355:				; CODE XREF: sub_414290+24Bj
		mov	ecx, ds:dword_41A434
		test	ecx, ecx
		jle	loc_4142A2
		xor	ebx, ebx
		xor	esi, esi
		mov	edi, ds:VirtualQuery
		jmp	short loc_414382
; ---------------------------------------------------------------------------
		align 10h

loc_414370:				; CODE XREF: sub_414290+FDj
					; sub_414290+14Aj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_41A434
		jge	loc_4142A2

loc_414382:				; CODE XREF: sub_414290+DDj
		mov	eax, ds:dword_41A430
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_414370
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	edi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_414502
		lea	eax, [ebp+flOldProtect]
		mov	[esp+58h+lpflOldProtect], eax ;	lpflOldProtect
		mov	eax, ds:dword_41A430
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_414370
; ---------------------------------------------------------------------------

loc_4143DC:				; CODE XREF: sub_414290+86j
		mov	eax, ds:dword_4195CC
		test	eax, eax
		jnz	short loc_414405
		mov	ebx, offset dword_4195D0
		lea	esi, [esi+0]

loc_4143F0:				; CODE XREF: sub_414290+70j
		mov	edi, [ebx]
		test	edi, edi
		jnz	loc_414320
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	loc_414320

loc_414405:				; CODE XREF: sub_414290+153j
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_414525
		add	ebx, 0Ch
		cmp	ebx, offset dword_4195C4
		jnb	loc_4142A2

loc_414420:				; CODE XREF: sub_414290+245j
		movzx	edx, byte ptr [ebx+8]
		mov	eax, 400000h
		mov	ecx, [ebx]
		add	eax, [ebx+4]
		cmp	edx, 10h
		mov	esi, [ecx+400000h]
		jz	short loc_41447A
		cmp	edx, 20h
		jz	short loc_4144B0
		cmp	edx, 8
		jz	short loc_41445A
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		mov	[ebp+var_20], 0
		call	sub_413FF0
; ---------------------------------------------------------------------------

loc_41445A:				; CODE XREF: sub_414290+1B1j
		movzx	edi, byte ptr [eax]
		test	edi, 80h
		jz	short loc_414485
		or	edi, 0FFFFFF00h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi
		jmp	short loc_4144A1
; ---------------------------------------------------------------------------

loc_41447A:				; CODE XREF: sub_414290+1A7j
		movzx	edi, word ptr [eax]
		test	edi, 8000h
		jnz	short loc_4144E0

loc_414485:				; CODE XREF: sub_414290+1D3j
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		cmp	edx, 10h
		mov	[ebp+var_20], esi
		jz	short loc_4144F3
		cmp	edx, 20h
		jz	short loc_4144BF
		cmp	edx, 8
		jnz	short loc_4144CC

loc_4144A1:				; CODE XREF: sub_414290+1E8j
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_20]
		call	sub_414050
		jmp	short loc_4144CC
; ---------------------------------------------------------------------------

loc_4144B0:				; CODE XREF: sub_414290+1ACj
		mov	edx, [eax]
		sub	edx, ecx
		sub	edx, 400000h
		add	edx, esi
		mov	[ebp+var_20], edx

loc_4144BF:				; CODE XREF: sub_414290+20Aj
		mov	ecx, 4		; Size
		lea	edx, [ebp+var_20]
		call	sub_414050

loc_4144CC:				; CODE XREF: sub_414290+20Fj
					; sub_414290+21Ej ...
		add	ebx, 0Ch
		cmp	ebx, offset dword_4195C4
		jb	loc_414420
		jmp	loc_414355
; ---------------------------------------------------------------------------

loc_4144E0:				; CODE XREF: sub_414290+1F3j
		or	edi, 0FFFF0000h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi

loc_4144F3:				; CODE XREF: sub_414290+205j
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_20]
		call	sub_414050
		jmp	short loc_4144CC
; ---------------------------------------------------------------------------

loc_414502:				; CODE XREF: sub_414290+11Bj
		add	ebx, ds:dword_41A430
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_413FF0
; ---------------------------------------------------------------------------

loc_414525:				; CODE XREF: sub_414290+17Bj
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_413FF0
sub_414290	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_414540	proc near		; CODE XREF: .text:004145E1p
					; sub_414650+Ap ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	eax, eax
		cmp	word ptr [edx],	5A4Dh
		jz	short loc_414550

locret_41454D:				; CODE XREF: sub_414540+19j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_414550:				; CODE XREF: sub_414540+Bj
		add	edx, [edx+3Ch]
		cmp	dword ptr [edx], 4550h
		jnz	short locret_41454D
		xor	eax, eax
		cmp	word ptr [edx+18h], 10Bh
		setz	al
		retn
sub_414540	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_414570	proc near		; CODE XREF: sub_414650+2Bp
					; .text:00414794p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		xor	eax, eax
		push	ebx
		mov	edx, [esp+8+arg_0]
		mov	ebx, [esp+8+arg_4]
		add	edx, [edx+3Ch]
		movzx	esi, word ptr [edx+6]
		movzx	ecx, word ptr [edx+14h]
		test	esi, esi
		jz	short loc_4145AE
		movzx	ecx, cx
		lea	eax, [edx+ecx+18h]
		xor	edx, edx

loc_414594:				; CODE XREF: sub_414570+3Aj
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_4145A2
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_4145AE

loc_4145A2:				; CODE XREF: sub_414570+29j
		add	edx, 1
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_414594
		xor	eax, eax

loc_4145AE:				; CODE XREF: sub_414570+19j
					; sub_414570+30j
		pop	ebx
		pop	esi
		retn
sub_414570	endp

; ---------------------------------------------------------------------------
		jmp	short loc_4145C0
; ---------------------------------------------------------------------------
		align 10h

loc_4145C0:				; CODE XREF: .text:004145B1j
		push	ebp
		push	edi
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 1Ch
		mov	edi, [esp+30h]
		mov	[esp], edi
		call	strlen
		cmp	eax, 8
		ja	short loc_414633
		mov	dword ptr [esp], 400000h
		call	sub_414540
		test	eax, eax
		jz	short loc_414633
		mov	eax, ds:40003Ch
		movzx	ebp, word ptr [eax+400006h]
		movzx	edx, word ptr [eax+400014h]
		add	eax, 400000h
		test	ebp, ebp
		jz	short loc_414633
		movzx	edx, dx
		xor	esi, esi
		lea	ebx, [eax+edx+18h]
		jmp	short loc_41461B
; ---------------------------------------------------------------------------

loc_414611:				; CODE XREF: .text:00414631j
		add	esi, 1
		add	ebx, 28h
		cmp	esi, ebp
		jnb	short loc_414640

loc_41461B:				; CODE XREF: .text:0041460Fj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], edi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jnz	short loc_414611

loc_414633:				; CODE XREF: .text:004145D8j
					; .text:004145E8j ...
		add	esp, 1Ch
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_414640:				; CODE XREF: .text:00414619j
		add	esp, 1Ch
		xor	ebx, ebx
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_414650	proc near		; CODE XREF: sub_414050+46p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	[esp+8+var_8], 400000h
		call	sub_414540
		mov	edx, eax
		xor	eax, eax
		test	edx, edx
		jz	short loc_414680
		mov	eax, [esp+8+arg_0]
		mov	[esp+8+var_8], 400000h
		sub	eax, 400000h
		mov	[esp+8+var_4], eax
		call	sub_414570

loc_414680:				; CODE XREF: sub_414650+15j
		add	esp, 8
		retn
sub_414650	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_414690	proc near		; CODE XREF: sub_414290+2Ap

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_414540
		xor	edx, edx
		test	eax, eax
		jz	short loc_4146B1
		mov	eax, ds:40003Ch
		movzx	edx, word ptr [eax+400006h]

loc_4146B1:				; CODE XREF: sub_414690+13j
		mov	eax, edx
		add	esp, 4
		retn
sub_414690	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 4
		mov	dword ptr [esp], 400000h
		mov	ebx, [esp+10h]
		call	sub_414540
		xor	edx, edx
		test	eax, eax
		jz	short loc_414719
		mov	eax, ds:40003Ch
		movzx	ecx, word ptr [eax+400006h]
		movzx	esi, word ptr [eax+400014h]
		add	eax, 400000h
		test	ecx, ecx
		jz	short loc_414719
		movzx	esi, si
		lea	edx, [eax+esi+18h]
		xor	eax, eax

loc_414700:				; CODE XREF: .text:00414715j
		test	byte ptr [edx+27h], 20h
		jz	short loc_41470D
		test	ebx, ebx
		jz	short loc_414719
		sub	ebx, 1

loc_41470D:				; CODE XREF: .text:00414704j
		add	eax, 1
		add	edx, 28h
		cmp	eax, ecx
		jb	short loc_414700
		xor	edx, edx

loc_414719:				; CODE XREF: .text:004146D9j
					; .text:004146F5j ...
		add	esp, 4
		mov	eax, edx
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_414730
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_414730	proc near		; CODE XREF: sub_414050+70p
					; .text:00414721j

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_414540
		xor	edx, edx
		test	eax, eax
		mov	eax, 400000h
		cmovnz	edx, eax
		add	esp, 4
		mov	eax, edx
		retn
sub_414730	endp

; ---------------------------------------------------------------------------
		jmp	short loc_414760
; ---------------------------------------------------------------------------
		align 10h

loc_414760:				; CODE XREF: .text:00414751j
		push	ebx
		xor	ebx, ebx
		sub	esp, 8
		mov	dword ptr [esp], 400000h
		call	sub_414540
		test	eax, eax
		jnz	short loc_414780

loc_414776:				; CODE XREF: .text:0041479Bj
		add	esp, 8
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_414780:				; CODE XREF: .text:00414774j
		mov	eax, [esp+10h]
		mov	dword ptr [esp], 400000h
		sub	eax, 400000h
		mov	[esp+4], eax
		call	sub_414570
		test	eax, eax
		jz	short loc_414776
		mov	ebx, [eax+24h]
		add	esp, 8
		not	ebx
		shr	ebx, 1Fh
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4147B0	proc near		; CODE XREF: sub_414840+1Ap

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	edi
		xor	edi, edi
		push	esi
		push	ebx
		sub	esp, 8
		mov	[esp+14h+var_14], 400000h
		mov	ebx, [esp+14h+arg_0]
		call	sub_414540
		test	eax, eax
		jz	short loc_414821
		mov	eax, ds:40003Ch
		mov	esi, [eax+400080h]
		test	esi, esi
		jz	short loc_414821
		mov	[esp+14h+var_10], esi
		mov	[esp+14h+var_14], 400000h
		call	sub_414570
		test	eax, eax
		jz	short loc_414821
		add	esi, 400000h
		jnz	short loc_414806
		jmp	short loc_414821
; ---------------------------------------------------------------------------
		align 10h

loc_414800:				; CODE XREF: sub_4147B0+66j
		sub	ebx, 1
		add	esi, 14h

loc_414806:				; CODE XREF: sub_4147B0+45j
		mov	edx, [esi+4]
		test	edx, edx
		jnz	short loc_414814
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_414830

loc_414814:				; CODE XREF: sub_4147B0+5Bj
		test	ebx, ebx
		jg	short loc_414800
		mov	edi, [esi+0Ch]
		add	edi, 400000h

loc_414821:				; CODE XREF: sub_4147B0+1Aj
					; sub_4147B0+29j ...
		add	esp, 8
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_414830:				; CODE XREF: sub_4147B0+62j
		add	esp, 8
		xor	edi, edi
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_4147B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_414840	proc near		; CODE XREF: sub_401180+132p

lpModuleName	= dword	ptr -1Ch

		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_41A438
		test	eax, eax
		jz	short loc_414852

loc_41484D:				; CODE XREF: sub_414840+97j
					; sub_414840+B5j
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_414852:				; CODE XREF: sub_414840+Bj
		xor	eax, eax

loc_414854:				; CODE XREF: sub_414840+82j
		mov	[esp+1Ch+lpModuleName],	eax
		lea	ebx, [eax+1]
		call	sub_4147B0
		test	eax, eax
		jz	short loc_4148E0
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_414870
		cmp	dl, 6Dh
		jnz	short loc_4148C0

loc_414870:				; CODE XREF: sub_414840+29j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_41487E
		cmp	dl, 73h
		jnz	short loc_4148C0

loc_41487E:				; CODE XREF: sub_414840+37j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_41488C
		cmp	dl, 76h
		jnz	short loc_4148C0

loc_41488C:				; CODE XREF: sub_414840+45j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_41489A
		cmp	dl, 63h
		jnz	short loc_4148C0

loc_41489A:				; CODE XREF: sub_414840+53j
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_4148A8
		cmp	dl, 72h
		jnz	short loc_4148C0

loc_4148A8:				; CODE XREF: sub_414840+61j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_4148C4
		cmp	dl, 74h
		jz	short loc_4148C4
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_4148C4
		xchg	ax, ax

loc_4148C0:				; CODE XREF: sub_414840+2Ej
					; sub_414840+3Cj ...
		mov	eax, ebx
		jmp	short loc_414854
; ---------------------------------------------------------------------------

loc_4148C4:				; CODE XREF: sub_414840+6Fj
					; sub_414840+74j ...
		mov	[esp+1Ch+lpModuleName],	eax ; lpModuleName
		call	ds:GetModuleHandleA
		sub	esp, 4
		test	eax, eax
		mov	ds:dword_41A438, eax
		jnz	loc_41484D
		lea	esi, [esi+0]

loc_4148E0:				; CODE XREF: sub_414840+21j
		mov	[esp+1Ch+lpModuleName],	offset aMsvcrt_dll ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_41A438, eax
		jmp	loc_41484D
sub_414840	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_414900	proc near		; CODE XREF: sub_401180:loc_4012D8p
					; TopLevelExceptionFilter+175p
		fninit
		retn
sub_414900	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_414910()
sub_414910	proc near		; DATA XREF: sub_414990:loc_414962o
		sub	esp, 0Ch
		mov	eax, off_4160D0
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_414937
		xchg	ax, ax

loc_414920:				; CODE XREF: sub_414910+25j
		call	eax
		mov	eax, off_4160D0
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_4160D0, edx
		test	eax, eax
		jnz	short loc_414920

loc_414937:				; CODE XREF: sub_414910+Cj
		add	esp, 0Ch
		retn
sub_414910	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_414990

loc_414940:				; CODE XREF: sub_414990+1Aj
		push	ebx
		sub	esp, 18h
		mov	ebx, ds:dword_415530
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_414973

loc_41494F:				; CODE XREF: sub_414990-9j
		test	ebx, ebx
		jz	short loc_414962

loc_414953:				; CODE XREF: sub_414990-30j
		call	ds:dword_415530[ebx*4]
		sub	ebx, 1
		lea	esi, [esi+0]
		jnz	short loc_414953

loc_414962:				; CODE XREF: sub_414990-3Fj
		mov	[esp+1Ch+var_1C], offset sub_414910 ; _onexit_t
		call	sub_413D70
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_414973:				; CODE XREF: sub_414990-43j
		xor	ebx, ebx
		jmp	short loc_414979
; ---------------------------------------------------------------------------

loc_414977:				; CODE XREF: sub_414990-Bj
		mov	ebx, eax

loc_414979:				; CODE XREF: sub_414990-1Bj
		lea	eax, [ebx+1]
		mov	edx, ds:dword_415530[eax*4]
		test	edx, edx
		jnz	short loc_414977
		jmp	short loc_41494F
; END OF FUNCTION CHUNK	FOR sub_414990
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_414990	proc near		; CODE XREF: sub_401180+239p
					; sub_4019CB+9p

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 00414940 SIZE 00000049 BYTES

		mov	ecx, ds:dword_41A43C
		test	ecx, ecx
		jz	short loc_4149A0
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_4149A0:				; CODE XREF: sub_414990+8j
		mov	ds:dword_41A43C, 1
		jmp	short loc_414940
sub_414990	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4149B0	proc near		; CODE XREF: .text:004014BDp start+Dp

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
SystemTimeAsFileTime= _FILETIME	ptr -2Ch
PerformanceCount= LARGE_INTEGER	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_4160DC
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		jz	short loc_414A00
		not	eax
		mov	dword_4160E0, eax

loc_4149E6:				; CODE XREF: sub_4149B0+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_414A00:				; CODE XREF: sub_4149B0+2Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_414A72

loc_414A62:				; CODE XREF: sub_4149B0+CCj
		mov	dword_4160DC, ebp
		mov	dword_4160E0, eax
		jmp	loc_4149E6
; ---------------------------------------------------------------------------

loc_414A72:				; CODE XREF: sub_4149B0+B0j
		mov	eax, 44BF19B0h
		mov	ebp, 0BB40E64Fh
		jmp	short loc_414A62
sub_4149B0	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_41A504, edx
		mov	ds:dword_41A720, 0C0000409h
		mov	ds:dword_41A724, 1
		mov	ds:dword_41A4F8, eax
		mov	ds:dword_41A72C, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_41A4EC, eax
		mov	eax, dword_4160DC
		mov	[ebp-10h], eax
		mov	eax, dword_4160E0
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_41955C
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_414B10	proc near		; CODE XREF: sub_414CB0+79p
					; sub_414CB0:loc_414D42p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_41A79C
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_414B65
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		lea	esi, [esi+0]

loc_414B40:				; CODE XREF: sub_414B10+53j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_414B5E
		test	esi, esi
		jz	short loc_414B5E
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_414B5E:				; CODE XREF: sub_414B10+40j
					; sub_414B10+44j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_414B40

loc_414B65:				; CODE XREF: sub_414B10+1Fj
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_414B10	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 1Ch
		mov	eax, ds:dword_41A780
		mov	[esp+14h], ebx
		xor	ebx, ebx
		mov	[esp+18h], esi
		test	eax, eax
		jnz	short loc_414BA4

loc_414B96:				; CODE XREF: .text:00414C0Cj
		mov	eax, ebx
		mov	esi, [esp+18h]
		mov	ebx, [esp+14h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_414BA4:				; CODE XREF: .text:00414B94j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		test	eax, eax
		mov	esi, eax
		jz	short loc_414C07
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	CriticalSection
		mov	[esi], eax
		mov	eax, [esp+24h]
		mov	[esi+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_41A79C
		mov	ds:dword_41A79C, esi
		mov	[esi+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, ebx
		sub	esp, 4
		mov	ebx, [esp+14h]
		mov	esi, [esp+18h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_414C07:				; CODE XREF: .text:00414BBCj
		mov	ebx, 0FFFFFFFFh
		jmp	short loc_414B96
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_41A780
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_414C28
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_414C28:				; CODE XREF: .text:00414C1Fj
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:EnterCriticalSection
		mov	edx, ds:dword_41A79C
		sub	esp, 4
		test	edx, edx
		jz	short loc_414C5F
		mov	eax, [edx]
		cmp	eax, ebx
		jnz	short loc_414C58
		jmp	short loc_414C96
; ---------------------------------------------------------------------------
		align 10h

loc_414C50:				; CODE XREF: .text:00414C5Dj
		mov	ecx, [eax]
		cmp	ecx, ebx
		jz	short loc_414C76
		mov	edx, eax

loc_414C58:				; CODE XREF: .text:00414C46j
		mov	eax, [edx+8]
		test	eax, eax
		jnz	short loc_414C50

loc_414C5F:				; CODE XREF: .text:00414C40j
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_414C6F:				; CODE XREF: .text:00414C94j
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_414C76:				; CODE XREF: .text:00414C54j
		mov	ecx, [eax+8]
		mov	[edx+8], ecx

loc_414C7C:				; CODE XREF: .text:00414CA0j
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_414C6F
; ---------------------------------------------------------------------------

loc_414C96:				; CODE XREF: .text:00414C48j
		mov	eax, [edx+8]
		mov	ds:dword_41A79C, eax
		mov	eax, edx
		jmp	short loc_414C7C
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_414CB0	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+E9p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_414D00
		jb	short loc_414CD0
		cmp	eax, 3
		jz	short loc_414D20

loc_414CC3:				; CODE XREF: sub_414CB0+31j
					; sub_414CB0+4Dj ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_414CD0:				; CODE XREF: sub_414CB0+Cj
		mov	eax, ds:dword_41A780
		test	eax, eax
		jnz	short loc_414D42

loc_414CD9:				; CODE XREF: sub_414CB0+97j
		mov	eax, ds:dword_41A780
		cmp	eax, 1
		jnz	short loc_414CC3
		mov	ds:dword_41A780, 0
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_414CC3
; ---------------------------------------------------------------------------
		align 10h

loc_414D00:				; CODE XREF: sub_414CB0+Aj
		mov	eax, ds:dword_41A780
		test	eax, eax
		jz	short loc_414D30

loc_414D09:				; CODE XREF: sub_414CB0+90j
		mov	ds:dword_41A780, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_414D20:				; CODE XREF: sub_414CB0+11j
		mov	eax, ds:dword_41A780
		test	eax, eax
		jz	short loc_414CC3
		call	sub_414B10
		jmp	short loc_414CC3
; ---------------------------------------------------------------------------

loc_414D30:				; CODE XREF: sub_414CB0+57j
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_414D09
; ---------------------------------------------------------------------------

loc_414D42:				; CODE XREF: sub_414CB0+27j
		call	sub_414B10
		jmp	short loc_414CD9
sub_414CB0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_414D50	proc near		; CODE XREF: sub_401180+19p
					; sub_414290+3Cp

arg_0		= byte ptr  4

		push	ecx
		push	eax
		cmp	eax, 1000h
		lea	ecx, [esp+8+arg_0]
		jb	short loc_414D72

loc_414D5D:				; CODE XREF: sub_414D50+20j
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_414D5D

loc_414D72:				; CODE XREF: sub_414D50+Bj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		pop	eax
		pop	ecx
		retn
sub_414D50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_414D80	proc near		; CODE XREF: sub_4042D5+2C6p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 2Ch
		mov	[esp+2Ch+var_4], ebp
		mov	ebp, [esp+2Ch+arg_C]
		mov	eax, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_10], ebx
		mov	ecx, [esp+2Ch+arg_8]
		mov	ebx, [esp+2Ch+arg_4]
		test	ebp, ebp
		mov	[esp+2Ch+var_C], esi
		mov	esi, eax
		mov	[esp+2Ch+var_8], edi
		mov	edi, ecx
		mov	[esp+2Ch+var_24], eax
		mov	edx, ebx
		jnz	short loc_414DD0
		cmp	ecx, ebx
		jbe	short loc_414DF2
		div	ecx

loc_414DB7:				; CODE XREF: sub_414D80+8Bj
		mov	eax, edx
		xor	edx, edx

loc_414DBB:				; CODE XREF: sub_414D80+70j
					; sub_414D80+92j ...
		mov	ebx, [esp+2Ch+var_10]
		mov	esi, [esp+2Ch+var_C]
		mov	edi, [esp+2Ch+var_8]
		mov	ebp, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_414DD0:				; CODE XREF: sub_414D80+2Fj
		cmp	ebp, ebx
		ja	short loc_414E10
		bsr	eax, ebp
		xor	eax, 1Fh
		mov	[esp+2Ch+var_28], eax
		jnz	short loc_414E14
		cmp	ecx, esi
		ja	loc_414EA8

loc_414DE8:				; CODE XREF: sub_414D80+12Aj
		mov	edx, ebx
		sub	esi, ecx
		sbb	edx, ebp
		mov	eax, esi
		jmp	short loc_414DBB
; ---------------------------------------------------------------------------

loc_414DF2:				; CODE XREF: sub_414D80+33j
		test	ecx, ecx
		jnz	short loc_414E01
		mov	eax, 1
		xor	edx, edx
		div	ecx
		mov	ecx, eax

loc_414E01:				; CODE XREF: sub_414D80+74j
		mov	eax, ebx
		xor	edx, edx
		div	ecx
		mov	eax, esi
		div	ecx
		jmp	short loc_414DB7
; ---------------------------------------------------------------------------
		align 10h

loc_414E10:				; CODE XREF: sub_414D80+52j
		mov	edx, ebx
		jmp	short loc_414DBB
; ---------------------------------------------------------------------------

loc_414E14:				; CODE XREF: sub_414D80+5Ej
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		mov	esi, 20h
		mov	eax, ebp
		sub	esi, [esp+2Ch+var_28]
		mov	ebp, edi
		mov	edx, ebx
		shl	eax, cl
		mov	ecx, esi
		shr	ebp, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		or	ebp, eax
		mov	eax, [esp+2Ch+var_24]
		shl	edi, cl
		mov	ecx, esi
		shr	edx, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		mov	[esp+2Ch+var_20], edi
		shl	ebx, cl
		mov	ecx, esi
		shr	eax, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		or	eax, ebx
		mov	ebx, [esp+2Ch+var_24]
		div	ebp
		shl	ebx, cl
		mov	[esp+2Ch+var_24], ebx
		mov	ebx, edx
		mul	edi
		cmp	ebx, edx
		mov	edi, eax
		mov	ecx, edx
		jb	short loc_414E9C
		cmp	[esp+2Ch+var_24], eax
		jb	short loc_414E98

loc_414E73:				; CODE XREF: sub_414D80+11Aj
					; sub_414D80+126j
		mov	eax, [esp+2Ch+var_24]
		sub	eax, edi
		sbb	ebx, ecx
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		mov	edx, ebx
		shr	eax, cl
		mov	ecx, esi
		shl	edx, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		or	eax, edx
		mov	edx, ebx
		shr	edx, cl
		jmp	loc_414DBB
; ---------------------------------------------------------------------------

loc_414E98:				; CODE XREF: sub_414D80+F1j
		cmp	ebx, edx
		jnz	short loc_414E73

loc_414E9C:				; CODE XREF: sub_414D80+EBj
		mov	ecx, edx
		mov	edi, eax
		sub	edi, [esp+2Ch+var_20]
		sbb	ecx, ebp
		jmp	short loc_414E73
; ---------------------------------------------------------------------------

loc_414EA8:				; CODE XREF: sub_414D80+62j
		cmp	ebp, ebx
		jb	loc_414DE8
		mov	eax, esi
		jmp	loc_414DBB
sub_414D80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_414EC0	proc near		; CODE XREF: sub_4042D5+2F2p

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 2Ch
		mov	edx, [esp+2Ch+arg_C]
		mov	[esp+2Ch+var_C], esi
		mov	ecx, [esp+2Ch+arg_8]
		mov	esi, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_10], ebx
		mov	ebx, [esp+2Ch+arg_4]
		test	edx, edx
		mov	[esp+2Ch+var_8], edi
		mov	edi, ecx
		mov	[esp+2Ch+var_4], ebp
		mov	[esp+2Ch+var_24], esi
		jnz	short loc_414F28
		cmp	ecx, ebx
		ja	short loc_414F50
		test	ecx, ecx
		jnz	short loc_414F00
		mov	eax, 1
		xor	edx, edx
		div	ecx
		mov	ecx, eax

loc_414F00:				; CODE XREF: sub_414EC0+33j
		mov	eax, ebx
		xor	edx, edx
		div	ecx
		mov	ebx, eax
		mov	eax, esi
		div	ecx
		mov	ecx, ebx
		mov	esi, eax

loc_414F10:				; CODE XREF: sub_414EC0+6Ej
					; sub_414EC0+80j ...
		mov	eax, esi
		mov	edx, ecx
		mov	ebx, [esp+2Ch+var_10]
		mov	esi, [esp+2Ch+var_C]
		mov	edi, [esp+2Ch+var_8]
		mov	ebp, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_414F28:				; CODE XREF: sub_414EC0+2Bj
		xor	ecx, ecx
		xor	esi, esi
		cmp	edx, ebx
		ja	short loc_414F10
		bsr	ebp, edx
		xor	ebp, 1Fh
		jnz	short loc_414F60
		cmp	edi, [esp+2Ch+var_24]
		jbe	short loc_414F42
		cmp	edx, ebx
		jnb	short loc_414F10

loc_414F42:				; CODE XREF: sub_414EC0+7Cj
		xor	ecx, ecx
		mov	esi, 1
		jmp	short loc_414F10
; ---------------------------------------------------------------------------
		align 10h

loc_414F50:				; CODE XREF: sub_414EC0+2Fj
		mov	eax, esi
		mov	edx, ebx
		div	ecx
		xor	ecx, ecx
		mov	esi, eax
		jmp	short loc_414F10
; ---------------------------------------------------------------------------
		align 10h

loc_414F60:				; CODE XREF: sub_414EC0+76j
		mov	eax, 20h
		mov	ecx, ebp
		sub	eax, ebp
		mov	esi, edi
		shl	edx, cl
		mov	ecx, eax
		shr	esi, cl
		mov	ecx, ebp
		or	esi, edx
		mov	edx, ebx
		mov	[esp+2Ch+var_20], esi
		mov	esi, [esp+2Ch+var_24]
		shl	edi, cl
		mov	ecx, eax
		shr	edx, cl
		mov	ecx, ebp
		shl	ebx, cl
		mov	ecx, eax
		shr	esi, cl
		or	esi, ebx
		mov	eax, esi
		div	[esp+2Ch+var_20]
		mov	ebx, edx
		mov	esi, eax
		mul	edi
		cmp	ebx, edx
		jb	short loc_414FAF
		mov	edi, [esp+2Ch+var_24]
		mov	ecx, ebp
		shl	edi, cl
		cmp	edi, eax
		jnb	short loc_414FB2
		cmp	ebx, edx
		jnz	short loc_414FB2

loc_414FAF:				; CODE XREF: sub_414EC0+DDj
		sub	esi, 1

loc_414FB2:				; CODE XREF: sub_414EC0+E9j
					; sub_414EC0+EDj
		xor	ecx, ecx
		jmp	loc_414F10
sub_414EC0	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _read]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _close]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _access]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _setmode]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _write]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fileno]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fdopen]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _getpid]
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_415030
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_415030	proc near		; CODE XREF: sub_401180+A7p
					; .text:00415021j

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_415030	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame fpd=222h

sub_415050	proc near		; CODE XREF: sub_415230+A6p

Size		= dword	ptr -348h
lpFilename	= dword	ptr -344h
nSize		= dword	ptr -340h
uType		= dword	ptr -33Ch
var_338		= dword	ptr -338h
var_334		= dword	ptr -334h
Filename	= byte ptr -327h
var_323		= dword	ptr -323h
var_31F		= word ptr -31Fh
var_223		= byte ptr -223h
var_222		= word ptr -222h
var_11D		= dword	ptr -11Dh
var_119		= dword	ptr -119h
var_115		= word ptr -115h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 33Ch
		mov	esi, [esp+348h+arg_0]
		lea	ebp, [esp+126h]
		mov	ebx, [esp+348h+arg_4]
		mov	[esp+348h+Size], 2000h ; Size
		call	malloc
		test	esi, esi
		lea	ecx, [esi+208h]
		mov	edi, eax
		mov	eax, ebp
		jnz	short loc_41509C
		jmp	short loc_4150A4
; ---------------------------------------------------------------------------
		align 10h

loc_415090:				; CODE XREF: sub_415050+52j
		add	esi, 2
		mov	[eax], dl
		add	eax, 1
		cmp	esi, ecx
		jz	short loc_4150A4

loc_41509C:				; CODE XREF: sub_415050+37j
		movzx	edx, word ptr [esi]
		test	dx, dx
		jnz	short loc_415090

loc_4150A4:				; CODE XREF: sub_415050+39j
					; sub_415050+4Aj
		lea	esi, [esp+348h+var_11D]
		test	ebx, ebx
		mov	byte ptr [eax],	0
		lea	ecx, [ebx+208h]
		mov	eax, esi
		jnz	short loc_4150CC
		jmp	short loc_4150D4
; ---------------------------------------------------------------------------
		align 10h

loc_4150C0:				; CODE XREF: sub_415050+82j
		add	ebx, 2
		mov	[eax], dl
		add	eax, 1
		cmp	ebx, ecx
		jz	short loc_4150D4

loc_4150CC:				; CODE XREF: sub_415050+68j
		movzx	edx, word ptr [ebx]
		test	dx, dx
		jnz	short loc_4150C0

loc_4150D4:				; CODE XREF: sub_415050+6Aj
					; sub_415050+7Aj
		mov	byte ptr [eax],	0
		cmp	byte ptr [esp+348h+var_11D], 0
		jz	loc_415190
		cmp	byte ptr [esp+348h+var_222], 0
		jz	loc_4151BE

loc_4150F3:				; CODE XREF: sub_415050+168j
					; sub_415050+178j
		lea	ebx, [esp+348h+Filename]
		mov	[esp+348h+var_223], 0
		mov	[esp+348h+nSize], 104h ; nSize
		mov	[esp+348h+lpFilename], ebx ; lpFilename
		mov	[esp+348h+Size], 0 ; hModule
		call	ds:GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_4151D0

loc_415123:				; CODE XREF: sub_415050+197j
		mov	eax, [esp+348h+arg_8]
		mov	[esp+348h+var_334], ebp
		mov	[esp+348h+uType], esi
		mov	[esp+348h+nSize], ebx
		mov	[esp+348h+var_338], eax
		mov	[esp+348h+lpFilename], offset aAssertionFaile ;	"Assertion failed!\n\nProgram: %s\nFile:"...
		mov	[esp+348h+Size], edi ; Dest
		call	sprintf
		mov	eax, ds:dword_41A41C
		test	eax, eax
		jz	loc_415209
		mov	[esp+348h+uType], 12012h ; uType
		mov	[esp+348h+nSize], offset Caption ; "MinGW Runtime Assertion"
		mov	[esp+348h+lpFilename], edi ; lpText
		mov	[esp+348h+Size], 0 ; hWnd
		call	ds:MessageBoxA
		sub	esp, 10h
		cmp	eax, 3
		jz	short loc_4151F1
		cmp	eax, 5
		jnz	short loc_4151EC
		add	esp, 33Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_415190:				; CODE XREF: sub_415050+8Fj
		cmp	byte ptr [esp+348h+var_222], 0
		mov	[esp+348h+var_11D], 6B6E753Ch
		mov	[esp+348h+var_119], 6E776F6Eh
		mov	[esp+348h+var_115], 3Eh
		jnz	loc_4150F3

loc_4151BE:				; CODE XREF: sub_415050+9Dj
		mov	[esp+348h+var_222], 3Fh
		jmp	loc_4150F3
; ---------------------------------------------------------------------------
		align 10h

loc_4151D0:				; CODE XREF: sub_415050+CDj
		mov	dword ptr [esp+348h+Filename], 6B6E753Ch
		mov	[esp+348h+var_323], 6E776F6Eh
		mov	[esp+348h+var_31F], 3Eh
		jmp	loc_415123
; ---------------------------------------------------------------------------

loc_4151EC:				; CODE XREF: sub_415050+133j
		call	abort
; ---------------------------------------------------------------------------

loc_4151F1:				; CODE XREF: sub_415050+12Ej
		mov	[esp+348h+Size], 16h
		call	raise
		mov	[esp+348h+Size], 3 ; Code
		call	_exit
; ---------------------------------------------------------------------------

loc_415209:				; CODE XREF: sub_415050+101j
		mov	eax, ds:_iob
		mov	[esp+348h+nSize], edi
		mov	[esp+348h+lpFilename], offset aS_2 ; "%s\n"
		add	eax, 40h
		mov	[esp+348h+Size], eax ; File
		call	fprintf
		call	abort
sub_415050	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_415230(char *, char *, int)
sub_415230	proc near		; CODE XREF: sub_40516B+109p
					; sub_40516B+154p ...

Str		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Memory		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [esp+3Ch+arg_0]
		mov	edx, [esp+3Ch+arg_8]
		mov	esi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+Str], edi ; Str
		mov	[esp+3Ch+var_20], edx
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		mov	[esp+3Ch+Str], esi ; Str
		mov	ebx, eax
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		movzx	ecx, byte ptr [edi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_415296
		xor	ebp, ebp
		lea	esi, [esi+0]

loc_415280:				; CODE XREF: sub_415230+62j
		add	edx, 1
		movzx	ecx, cl
		mov	[ebx+ebp*2], cx
		movzx	ecx, byte ptr [edi+edx]
		mov	ebp, edx
		test	cl, cl
		jnz	short loc_415280
		add	edx, edx

loc_415296:				; CODE XREF: sub_415230+48j
		mov	word ptr [ebx+edx], 0
		movzx	ecx, byte ptr [esi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_4152BD
		xor	edi, edi

loc_4152A7:				; CODE XREF: sub_415230+89j
		add	edx, 1
		movzx	ecx, cl
		mov	[eax+edi*2], cx
		movzx	ecx, byte ptr [esi+edx]
		mov	edi, edx
		test	cl, cl
		jnz	short loc_4152A7
		add	edx, edx

loc_4152BD:				; CODE XREF: sub_415230+73j
		mov	word ptr [eax+edx], 0
		mov	edx, [esp+3Ch+var_20]
		mov	[esp+3Ch+var_38], eax
		mov	[esp+3Ch+Memory], eax
		mov	[esp+3Ch+Str], ebx
		mov	[esp+3Ch+var_34], edx
		call	sub_415050
		mov	[esp+3Ch+Str], ebx ; Memory
		call	free
		mov	eax, [esp+3Ch+Memory]
		mov	[esp+3Ch+arg_0], eax ; Memory
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		jmp	free
sub_415230	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000005 BYTES: COLLAPSED FUNCTION j__lseeki64]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_415310	proc near		; CODE XREF: sub_40E1E6+9Cp
		jmp	sub_415330
sub_415310	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_415320	proc near		; CODE XREF: sub_40E1E6+AAp
		jmp	sub_415340
sub_415320	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_415330	proc near		; CODE XREF: sub_415310j
		mov	eax, ds:time
		jmp	eax
sub_415330	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_415340	proc near		; CODE XREF: sub_415320j
		mov	eax, ds:localtime
		jmp	eax
sub_415340	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __getmainargs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __set_app_type]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _cexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strerror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION getenv]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION setlocale]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcpy]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION atoi]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION sprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcmp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strtoul]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memset]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION realloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strrchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fread]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ferror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fseek]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ftell]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fflush]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fclose]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memchr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fopen]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcmp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION setvbuf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strncpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION putc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fputs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION getc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strpbrk]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION printf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strtol]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION putchar]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strstr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION puts]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION signal]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __setusermatherr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION raise]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _lseeki64]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415510	proc near		; DATA XREF: .text:00415534o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4014F0
		mov	[esp+18h+var_18], offset sub_401540 ; _onexit_t
		call	sub_413D70
		leave
		retn
sub_415510	endp

; ---------------------------------------------------------------------------
		align 10h
dword_415530	dd 0FFFFFFFFh		; DATA XREF: sub_414990-4Cr
					; sub_414990:loc_414953r ...
		dd offset sub_415510
		dd 0
		dd 0FFFFFFFFh
dword_415540	dd 30h dup(0)		; DATA XREF: .data:off_4160D0o
		dd 280h	dup(?)
_text		ends

; Section 2. (virtual address 00016000)
; Virtual size			: 000000E8 (	232.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00014A00
; Flags	C0600040: Data Readable	Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 416000h
dword_416000	dd 12Dh, 2 dup(0)	; DATA XREF: sub_4019CB:loc_401A9Fo
		dd offset a@options	; "@Options:\n "
		dd 76h,	417050h, 0
		dd offset aVerbose	; "verbose"
		dd 50h,	417058h, 2, 417063h, 63h, 417081h, 100h, 417088h
		dd 66h,	41709Ah, 100h, 4170A1h,	1F5h, 4170B3h, 2, 4170BBh
		dd 8 dup(0)
; LPCSTR off_416080
off_416080	dd offset aShell32_dll	; DATA XREF: sub_406221+30r
					; sub_406221+90r
					; "shell32.dll"
		dd offset aShfolder_dll	; "shfolder.dll"
		dd 0
off_41608C	dd offset sub_40751B	; DATA XREF: sub_4091B2+8Er
					; .text:00409A2Dr ...
off_416090	dd offset sub_40759B	; DATA XREF: sub_4091B2+98r
					; .text:00409A37r ...
off_416094	dd offset sub_40781F	; DATA XREF: sub_4091B2+A2r
					; .text:00409A41r ...
off_416098	dd offset sub_407AA4	; DATA XREF: sub_4091B2+ACr
					; .text:00409A4Br ...
off_41609C	dd offset sub_407B41	; DATA XREF: .text:004098F2r
					; sub_409D18+7Br ...
off_4160A0	dd offset sub_407B97	; DATA XREF: .text:004098FCr
					; sub_409D18+85r ...
off_4160A4	dd offset sub_407BEC	; DATA XREF: .text:00409906r
					; sub_409D18+8Fr ...
off_4160A8	dd offset sub_407C7E	; DATA XREF: .text:00409910r
					; .text:00409972r ...
off_4160AC	dd offset sub_407D4D	; DATA XREF: sub_409E4D+A5r
off_4160B0	dd offset sub_407DB4	; DATA XREF: sub_409E4D+AFr
off_4160B4	dd offset sub_407E0B	; DATA XREF: sub_409E4D+B9r
off_4160B8	dd offset sub_407E95	; DATA XREF: sub_409E4D+C3r
					; sub_409E4D+F5r
dword_4160BC	dd 0FFFFFFFFh		; DATA XREF: sub_40DDC5:loc_40DF4Bw
					; .text:loc_40E17Fr ...
; char off_4160C0[]
off_4160C0	dd offset aIso88591	; DATA XREF: sub_4126F0+D9w
					; sub_4127EF:loc_4129C4w ...
					; "iso-8859-1"
		dd 0FFh, 2 dup(0FFFFFFFFh)
off_4160D0	dd offset dword_415540	; DATA XREF: sub_414910+3r
					; sub_414910+12r ...
dword_4160D4	dd 2			; DATA XREF: TlsCallback_0+13r
					; TlsCallback_0+1Cw ...
dword_4160D8	dd 0FFFFFFFFh		; DATA XREF: sub_401060+7Ar
dword_4160DC	dd 0BB40E64Eh		; DATA XREF: sub_4149B0+3r
					; sub_4149B0:loc_414A62w ...
dword_4160E0	dd 44BF19B1h		; DATA XREF: sub_4149B0+31w
					; sub_4149B0+B8w ...
dword_4160E4	dd 0			; DATA XREF: sub_4014F0+6r
					; sub_4014F0+42o
		align 1000h
_data		ends

; Section 3. (virtual address 00017000)
; Virtual size			: 000025C4 (   9668.)
; Section size in file		: 00002600 (   9728.)
; Offset to raw	data for section: 00014C00
; Flags	40300040: Data Readable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 417000h
; CHAR ProcName[]
ProcName	db '_set_invalid_parameter_handler',0 ; DATA XREF: sub_401180+137o
		align 10h
; CHAR ModuleName[]
ModuleName	db 'libgcj-12.dll',0    ; DATA XREF: sub_4014F0+Fo
; CHAR a_jv_registercl[]
a_jv_registercl	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_4014F0+28o
		align 4
a@options	db '@Options:',0Ah      ; DATA XREF: .data:0041600Co
		db ' ',0
aVerbose	db 'verbose',0          ; DATA XREF: .data:0041601Co
aPassphrase	db 'passphrase',0
aStringUsePassp	db '|STRING|use passphrase STRING',0
aPreset		db 'preset',0
aPresetPassphra	db 'preset passphrase',0
aForget		db 'forget',0
aForgetPassphra	db 'forget passphrase',0
aHomedir_0	db 'homedir',0
a@		db '@',0
aGpgPresetPassp	db 'gpg-preset-passphrase (GnuPG)',0 ; DATA XREF: sub_4015C2:loc_4015DDo
a2_0_30		db '2.0.30',0           ; DATA XREF: sub_4015C2:loc_4015E6o
aMingw32	db 'MingW32',0          ; DATA XREF: sub_4015C2:loc_4015EFo
		align 4
; char aPleaseReportBu[]
aPleaseReportBu	db 'Please report bugs to <@EMAIL@>.',0Ah,0
					; DATA XREF: sub_4015C2:loc_4015F8o
		align 10h
; char aUsageGpgPreset[]
aUsageGpgPreset	db 'Usage: gpg-preset-passphrase [options] KEYGRIP (-h for help)',0Ah,0
					; DATA XREF: sub_4015C2:loc_401609o
		align 10h
; char aSyntaxGpgPrese[]
aSyntaxGpgPrese	db 'Syntax: gpg-preset-passphrase [options] KEYGRIP',0Ah
					; DATA XREF: sub_4015C2:loc_40161Ao
		db 'Password cache maintenance',0Ah,0
off_41719C	dd offset loc_40162B	; DATA XREF: sub_4015C2+12o
		dd offset loc_401609	; jump table for switch	statement
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_4015DD
		dd offset loc_40162B
		dd offset loc_4015E6
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_4015EF
		dd offset loc_40162B
		dd offset loc_4015F8
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_40162B
		dd offset loc_401609
		dd offset loc_40161A
off_417244	dd offset loc_401652	; DATA XREF: sub_401637+12o
		dd offset loc_401659	; jump table for switch	statement
		dd offset loc_401667
		dd offset loc_401675
		dd offset loc_401683
		dd offset loc_401691
		dd offset loc_40169F
		dd offset loc_4016B4
		dd offset loc_4016A6
; char aReadingPassphr[]
aReadingPassphr	db 'reading passphrase failed: %s',0Ah,0 ; DATA XREF: sub_4016C2+4Fo
; char aCanNotEscapeSt[]
aCanNotEscapeSt	db 'can not escape string: %s',0Ah,0 ; DATA XREF: sub_4016C2+124o
aPreset_passphr	db 'PRESET_PASSPHRASE %s -1 %s',0Ah,0 ; DATA XREF: sub_4016C2+143o
		align 10h
; char aCachingPassphr[]
aCachingPassphr	db 'caching passphrase failed: %s',0Ah,0 ; DATA XREF: sub_4016C2+1BFo
					; sub_4016C2+22Ao
aClear_passphra	db 'CLEAR_PASSPHRASE %s',0Ah,0 ; DATA XREF: sub_401952+Do
; char aClearingPassph[]
aClearingPassph	db 'clearing passphrase failed: %s',0Ah,0 ; DATA XREF: sub_401952+5Eo
; char aGpgPresetPas_0[]
aGpgPresetPas_0	db 'gpg-preset-passphrase',0 ; DATA XREF: sub_4019CB+32o
aS_gpgAgent	db 'S.gpg-agent',0      ; DATA XREF: sub_4019CB+138o
		align 4
; char aOneOfTheOption[]
aOneOfTheOption	db 'one of the options --preset or --forget must be given',0Ah,0
					; DATA XREF: sub_4019CB:loc_401B59o
		align 10h
; char aWriteFailedS[]
aWriteFailedS	db 'write failed: %s',0Ah,0 ; DATA XREF: sub_401BD9+69o
asc_417382	db 0Ah,0		; DATA XREF: sub_401D24:loc_401D99o
aOption		db 'OPTION ',0          ; DATA XREF: sub_401D24+7Ao
asc_41738C	db '=',0                ; DATA XREF: sub_401D24+9Co
; char VarName[]
VarName		db 'DISPLAY',0          ; DATA XREF: sub_401EB5+31o
aDisplay_0	db 'display',0          ; DATA XREF: sub_401EB5+4Do
; char aGpg_tty[]
aGpg_tty	db 'GPG_TTY',0          ; DATA XREF: sub_401EB5:loc_401F26o
aTtyname	db 'ttyname',0          ; DATA XREF: sub_401EB5+97o
; char aTerm[]
aTerm		db 'TERM',0             ; DATA XREF: sub_401EB5:loc_401F70o
aTtytype	db 'ttytype',0          ; DATA XREF: sub_401EB5+DDo
byte_4173BB	db 0			; DATA XREF: sub_401EB5:loc_402036o
aLcCtype	db 'lc-ctype',0         ; DATA XREF: sub_401EB5+1ABo
; char aXauthority[]
aXauthority	db 'XAUTHORITY',0       ; DATA XREF: sub_401EB5:loc_4020A5o
aXauthority_0	db 'xauthority',0       ; DATA XREF: sub_401EB5+20Co
; char aPinentry_user_[]
aPinentry_user_	db 'PINENTRY_USER_DATA',0 ; DATA XREF: sub_401EB5:loc_4020D4o
aPinentryUserDa	db 'pinentry-user-data',0 ; DATA XREF: sub_401EB5+23Bo
; char aGpg_agent_info[]
aGpg_agent_info	db 'GPG_AGENT_INFO',0   ; DATA XREF: sub_40210E+14o
; char aGpgAgentIsNotA[]
aGpgAgentIsNotA	db 'gpg-agent is not available in this session',0Ah,0
					; DATA XREF: sub_40210E:loc_402159o
; char aMalformedGpg_a[]
aMalformedGpg_a	db 'malformed GPG_AGENT_INFO environment variable',0Ah,0
					; DATA XREF: sub_40210E:loc_402202o
		align 4
; char aGpgAgentProtoc[]
aGpgAgentProtoc	db 'gpg-agent protocol version %d is not supported',0Ah,0
					; DATA XREF: sub_40210E+15Do
; char aCanTCreateSock[]
aCanTCreateSock	db 'can',27h,'t create socket: %s',0Ah,0 ; DATA XREF: sub_40210E+1ADo
; char aCanTConnectToS[]
aCanTConnectToS	db 'can',27h,'t connect to `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40210E+26Eo
; char aCommunicationP[]
aCommunicationP	db 'communication problem with gpg-agent',0Ah,0
					; DATA XREF: sub_40210E:loc_4023EFo
		align 4
; char aProblemSetting[]
aProblemSetting	db 'problem setting the gpg-agent options',0Ah,0
					; DATA XREF: sub_40210E+313o
; char Format[]
Format		db '%%%02X',0           ; DATA XREF: sub_402454+41o
a01		db ';0;1',0             ; DATA XREF: sub_4024FA:loc_402554o
asc_41752B	db 'X',0                ; DATA XREF: .text:004025CBo
					; .text:004025D8o ...
aGet_passphrase	db 'GET_PASSPHRASE ',0  ; DATA XREF: .text:loc_4026A2o
aCheck		db '--check ',0         ; DATA XREF: .text:004026CFo
aErr111		db 'ERR 111',0          ; DATA XREF: .text:0040297Co
					; sub_402B7E+DEo
aErr		db 'ERR ',0             ; DATA XREF: .text:004029BBo
					; .text:00402A1Fo ...
; char aCanceledByUser[]
aCanceledByUser	db 'canceled by user',0Ah,0 ; DATA XREF: .text:loc_4029FAo
					; sub_402B7E:loc_402CDFo
; char aProblemWithThe[]
aProblemWithThe	db 'problem with the agent',0Ah,0 ; DATA XREF: .text:loc_402A71o
					; sub_402B7E:loc_402CEDo
aClear_passph_0	db 'CLEAR_PASSPHRASE ',0 ; DATA XREF: .text:loc_402B09o
		align 10h
a____Gnupg22_0_	db '../../gnupg2-2.0.30/common/convert.c',0 ; DATA XREF: .text:004035EEo
aHex2str_alloc	db 'hex2str_alloc',0    ; DATA XREF: .text:004035DEo
		align 4
off_4175C4	dd offset loc_40361B	; DATA XREF: sub_403600+12r
		dd offset loc_40362A	; jump table for switch	statement
		dd offset loc_4036A2
		dd offset loc_4036A2
		dd offset loc_4036A2
		dd offset loc_4036A2
		dd offset loc_40371A
		dd offset loc_40371A
		dd offset loc_40371A
		dd offset loc_40371A
		dd offset loc_40371A
		dd offset loc_40371A
		dd offset loc_40371A
		dd offset loc_40371A
		dd offset loc_403752
		dd offset loc_403761
		dd offset loc_403770
		dd offset loc_40377F
		dd offset loc_40378B
off_417610	dd offset loc_403692	; DATA XREF: sub_403600+35r
		dd offset loc_40363E	; jump table for switch	statement
		dd offset loc_40364A
		dd offset loc_403656
		dd offset loc_403662
		dd offset loc_40366E
		dd offset loc_40367A
		dd offset loc_403686
off_417630	dd offset loc_40370A	; DATA XREF: sub_403600+ADr
		dd offset loc_4036B6	; jump table for switch	statement
		dd offset loc_4036C2
		dd offset loc_4036CE
		dd offset loc_4036DA
		dd offset loc_4036E6
		dd offset loc_4036F2
		dd offset loc_4036FE
off_417650	dd offset loc_4037F3	; DATA XREF: sub_403600+196r
		dd offset loc_40379F	; jump table for switch	statement
		dd offset loc_4037AB
		dd offset loc_4037B7
		dd offset loc_4037C3
		dd offset loc_4037CF
		dd offset loc_4037DB
		dd offset loc_4037E7
off_417670	dd offset loc_403926	; DATA XREF: sub_403801+10Ar
		dd offset loc_403947	; jump table for switch	statement
		dd offset loc_403947
		dd offset loc_40392C
		dd offset loc_403947
		dd offset loc_403947
		dd offset loc_403947
		dd offset loc_403914
		dd offset loc_403947
		dd offset loc_403947
		dd offset loc_403947
		dd offset loc_403920
		dd offset loc_403947
		dd offset loc_40391A
		dd offset loc_403947
		dd offset loc_403947
		dd offset loc_403932
off_4176B4	dd offset loc_403C87	; DATA XREF: sub_403801+408r
		dd offset loc_403C94	; jump table for switch	statement
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C12
		dd offset loc_403C94
		dd offset loc_403C60
		dd offset loc_403C94
		dd offset loc_403C39
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C7A
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C94
		dd offset loc_403C6D
off_417770	dd offset loc_403D3E, offset loc_403D9B, offset	loc_403D6B
					; DATA XREF: sub_403801+4B0r
		dd offset loc_403D9B, offset loc_403D1A, offset	loc_403D02 ; jump table	for switch statement
		dd offset loc_403D2C, offset loc_403D9B, offset	loc_403D9B
		dd offset loc_403D9B, offset loc_403D9B, offset	loc_403D9B
		dd offset loc_403D9B, offset loc_403D9B, offset	loc_403D9B
		dd offset loc_403D9B, offset loc_403D9B, offset	loc_403D9B
		dd offset loc_403D7B, offset loc_403D9B, offset	loc_403D9B
		dd offset loc_403D9B, offset loc_403D9B, offset	loc_403CEA
		dd offset loc_403D9B, offset loc_403D9B, offset	loc_403D9B
		dd offset loc_403D9B, offset loc_403D9B, offset	loc_403D9B
		dd offset loc_403D9B, offset loc_403D9B, offset	loc_403D35
		dd offset loc_403D9B, offset loc_403D47, offset	loc_403CBA
		dd offset loc_403D0E, offset loc_403CF6, offset	loc_403D23
		dd offset loc_403D9B, offset loc_403CBA, offset	loc_403D9B
		dd offset loc_403D9B, offset loc_403D9B, offset	loc_403D8B
		dd offset loc_403D62, offset loc_403CC6, offset	loc_403D59
		dd offset loc_403D9B, offset loc_403D9B, offset	loc_403D50
		dd offset loc_403D9B, offset loc_403CD2, offset	loc_403D9B
		dd offset loc_403D9B, offset loc_403CDE
off_417850	dd offset loc_404235	; DATA XREF: sub_403F79+4Co
		dd offset loc_403FCE	; jump table for switch	statement
		dd offset loc_403FFA
		dd offset loc_404026
		dd offset loc_40403D
		dd offset loc_404055
		dd offset loc_404082
		dd offset loc_4040AC
		dd offset loc_4040C1
		dd offset loc_4040D6
		dd offset loc_404100
		dd offset loc_40411B
		dd offset loc_40414B
		dd offset loc_404160
		dd offset loc_404181
		dd offset loc_4041AB
		dd offset loc_4041D5
		dd offset loc_4041ED
		dd offset loc_404211
		dd offset loc_404196
		dd offset loc_403FE5
		dd offset loc_404011
		dd offset loc_40406D
		dd offset loc_404097
		dd offset loc_4040EB
		dd offset loc_404136
		dd offset loc_4041C3
		dd offset loc_4041FF
		dd offset loc_404223
byte_4178C4	db 27h,	0		; DATA XREF: sub_4042D5+267o
a0123456789abcd	db '0123456789abcdef',0 ; DATA XREF: sub_4042D5+37Eo
a0123456789ab_0	db '0123456789ABCDEF',0 ; DATA XREF: sub_4042D5:loc_40465Ao
a0x		db '0x',0               ; DATA XREF: sub_4042D5+550o
a0x_0		db '0X',0               ; DATA XREF: sub_4042D5:loc_40482Co
		align 10h
off_4178F0	dd offset loc_404334	; DATA XREF: sub_4042D5+56r
		dd offset loc_4043BC	; jump table for switch	statement
		dd offset loc_404349
		dd offset loc_4043BC
		dd offset loc_40435C
		dd offset loc_4043BC
		dd offset loc_40436F
		dd offset loc_4043BC
		dd offset loc_4043BC
		dd offset loc_4043BC
		dd offset loc_4043BC
		dd offset loc_404395
		dd offset loc_4043BC
		dd offset loc_404383
		dd offset loc_4043A9
off_41792C	dd offset loc_404417	; DATA XREF: sub_4042D5+139r
		dd offset loc_40449E	; jump table for switch	statement
		dd offset loc_40442D
		dd offset loc_40449E
		dd offset loc_40443F
		dd offset loc_40449E
		dd offset loc_404451
		dd offset loc_40449E
		dd offset loc_40449E
		dd offset loc_40449E
		dd offset loc_40449E
		dd offset loc_404477
		dd offset loc_404465
		dd offset loc_40448B
off_417964	dd offset loc_404A3A	; DATA XREF: sub_404968+C9r
		dd offset loc_404A46	; jump table for switch	statement
		dd offset loc_404A52
		dd offset loc_404A5E
		dd offset loc_404A6A
		dd offset loc_404A76
		dd offset loc_404A82
		dd offset loc_404A8E
aNull		db '(null)',0           ; DATA XREF: sub_404E0F+40o
byte_41798B	db 30h			; DATA XREF: sub_404FB0+65r
a123456789abcde	db '123456789abcdefx',0
		align 10h
off_4179A0	dd offset loc_4050EC	; DATA XREF: sub_4050B7+2Cr
		dd offset loc_4050F8	; jump table for switch	statement
		dd offset loc_405151
		dd offset loc_405105
		dd offset loc_405111
		dd offset loc_405125
		dd offset loc_405139
		dd offset loc_405145
; char a____Gnupg22__0[]
a____Gnupg22__0	db '../../gnupg2-2.0.30/common/estream-printf.c',0
					; DATA XREF: sub_40516B+FAo
					; sub_40516B+145o ...
; char aArgidxArgspecs[]
aArgidxArgspecs	db 'argidx < argspecs_len',0 ; DATA XREF: sub_40516B+102o
		align 4
; char aValuetableArgW[]
aValuetableArgW	db 'valuetable[arg->width_pos-1].vt == VALTYPE_INT',0
					; DATA XREF: sub_40516B+14Do
		align 4
; char aValuetableArgP[]
aValuetableArgP	db 'valuetable[arg->precision_pos-1].vt == VALTYPE_INT',0
					; DATA XREF: sub_40516B+1D9o
		align 4
; char aArgVtValuetabl[]
aArgVtValuetabl	db 'arg->vt == valuetable[arg->arg_pos-1].vt',0 ; DATA XREF: sub_40516B+26Eo
; char aBug[]
aBug		db '!"bug"',0           ; DATA XREF: sub_40516B+2CFo
off_417A98	dd offset loc_40542A	; DATA XREF: sub_40516B+2B6r
		dd offset loc_40544B	; jump table for switch	statement
		dd offset loc_40544B
		dd offset loc_40544B
		dd offset loc_40544B
		dd offset loc_40544B
		dd offset loc_40548F
		dd offset loc_40548F
		dd offset loc_40548F
		dd offset loc_40548F
		dd offset loc_40548F
		dd offset loc_40548F
		dd offset loc_40548F
		dd offset loc_40548F
		dd offset loc_4054D3
		dd offset loc_405517
		dd offset loc_40555B
		dd offset loc_405517
		dd offset loc_40559C
byte_417AE4	db 0			; DATA XREF: sub_405DA0+5Fo
					; sub_405F9B+75o
; char aParm_used[]
aParm_used	db 'parm.used',0        ; DATA XREF: sub_405F9B+FDo
		align 10h
; char aGnupg2[]
aGnupg2		db 'gnupg2',0           ; DATA XREF: sub_4060E4+Fo
		align 4
; CHAR aShgetfolderpat[]
aShgetfolderpat	db 'SHGetFolderPathA',0 ; DATA XREF: sub_406221+50o
aHome		db '\home',0            ; DATA XREF: sub_4062FB+31o
aGnupg		db '\gnupg',0           ; DATA XREF: sub_4062FB+BAo
aCGnupg		db 'c:/gnupg',0         ; DATA XREF: sub_4062FB:loc_40641Fo
					; sub_406435:loc_406509o
; char aGnupghome[]
aGnupghome	db 'GNUPGHOME',0        ; DATA XREF: sub_406435:loc_406453o
; CHAR ValueName[]
ValueName	db 'HomeDir',0          ; DATA XREF: sub_406435:loc_40648Fo
; CHAR aSoftwareGnuGnu[]
aSoftwareGnuGnu	db 'Software\GNU\GnuPG',0 ; DATA XREF: sub_406435+62o
aGpgconf_exe	db '\gpgconf.exe',0     ; DATA XREF: sub_406515+10o
					; .text:00407161o
		align 4
; char aRequiredBinary[]
aRequiredBinary	db 'required binary ',27h,'%s',27h,' is not installed',0Ah,0
					; DATA XREF: sub_406515+44o
aCtl		db 'ctl',0              ; DATA XREF: sub_406515:loc_406567o
; char aGetmodulefilen[]
aGetmodulefilen	db 'GetModuleFileName failed: %s',0Ah,0 ; DATA XREF: sub_4065C8+4Ao
aBin		db 'bin',0              ; DATA XREF: sub_4065C8+BBo
		align 4
; char aBadFilenameSRe[]
aBadFilenameSRe	db 'bad filename `%s',27h,' returned for this process',0Ah,0
					; DATA XREF: sub_4065C8+FCo
aCGnupg_0	db 'c:\gnupg',0         ; DATA XREF: sub_4065C8:loc_4066E9o
aGnu		db '\GNU',0             ; DATA XREF: sub_4066F5+99o
aEtcGnupg	db '\etc\gnupg',0       ; DATA XREF: .text:004067F9o
aBin_0		db '\bin',0             ; DATA XREF: sub_40687F+28o
aLibGnupg	db '\lib\gnupg',0       ; DATA XREF: .text:004068F5o
aShareGnupg	db '\share\gnupg',0     ; DATA XREF: .text:00406998o
aShareLocale	db '\share\locale',0    ; DATA XREF: sub_406A1E+1Do
aCWindows	db 'C:\WINDOWS',0       ; DATA XREF: .text:00406B0Bo
aS_dirmngr	db '\S.dirmngr',0       ; DATA XREF: .text:loc_406B2Fo
aGpgAgent_exe	db '\gpg-agent.exe',0   ; DATA XREF: .text:00406C00o
aPinentry_exe	db '\pinentry.exe',0    ; DATA XREF: .text:00406C99o
aScdaemon_exe	db '\scdaemon.exe',0    ; DATA XREF: .text:00406D32o
aDirmngr_exe	db '\dirmngr.exe',0     ; DATA XREF: .text:00406DCBo
aGpgProtectTool	db '\gpg-protect-tool.exe',0 ; DATA XREF: .text:00406E64o
aGpgCheckPatter	db '\gpg-check-pattern.exe',0 ; DATA XREF: .text:00406EFDo
aGpgsm_exe	db '\gpgsm.exe',0       ; DATA XREF: .text:00406F96o
aGpg2_exe	db '\gpg2.exe',0        ; DATA XREF: .text:0040702Fo
aGpgConnectAgen	db '\gpg-connect-agent.exe',0 ; DATA XREF: .text:004070C8o
a____Gnupg22__1	db '../../gnupg2-2.0.30/common/homedir.c',0 ; DATA XREF: .text:004071F2o
		align 4
off_417CE4	dd offset loc_4071E2	; DATA XREF: .text:00406BE2o
		dd offset loc_406BEB	; jump table for switch	statement
		dd offset loc_406C84
		dd offset loc_406D1D
		dd offset loc_406DB6
		dd offset loc_406E4F
		dd offset loc_406EE8
		dd offset loc_406F81
		dd offset loc_40701A
		dd offset loc_4070B3
		dd offset loc_40714C
aGnupg_module_n	db 'gnupg_module_name',0 ; DATA XREF: .text:loc_4071E2o
aShell32_dll	db 'shell32.dll',0      ; DATA XREF: .data:off_416080o
aShfolder_dll	db 'shfolder.dll',0     ; DATA XREF: .data:00416084o
		align 4
; char a____Gnupg22__2[]
a____Gnupg22__2	db '../../gnupg2-2.0.30/common/estream.c',0 ; DATA XREF: sub_40759B+4Do
					; sub_40759B+1CBo ...
		align 4
; char aMem_cookieMemo[]
aMem_cookieMemo	db 'mem_cookie->memory_size >= mem_cookie->offset',0
					; DATA XREF: sub_40759B+55o
					; sub_40759B+1D3o
; char aSizeNleft[]
aSizeNleft	db 'size <= nleft',0    ; DATA XREF: sub_40759B+20Co
; char aStreamFlags_wr[]
aStreamFlags_wr	db 'stream->flags.writing',0 ; DATA XREF: sub_408190+35o
; char aStreamFlags__0[]
aStreamFlags__0	db '!stream->flags.writing',0 ; DATA XREF: sub_408329+24o
aR		db 'r',0                ; DATA XREF: .text:0040A0C4o
					; .text:0040A16Co ...
aA		db 'a',0                ; DATA XREF: .text:0040A0FFo
					; .text:0040A134o ...
		align 4
aFatalErrorCrea	db 'fatal: error creating a dummy estream for %d: %s',0Ah,0
					; DATA XREF: .text:0040A231o
aStdout		db '[stdout]',0         ; DATA XREF: .text:0040A2CEo
aStderr		db '[stderr]',0         ; DATA XREF: .text:loc_40A2D5o
aStdin		db '[stdin]',0          ; DATA XREF: .text:loc_40A2DCo
a_estream	db '_estream',0         ; DATA XREF: sub_40B503+BAo
a_tmp		db '.tmp',0             ; DATA XREF: sub_40B503+165o
a?		db '[?]',0              ; DATA XREF: .text:0040BB6Ao
aX02x		db 'x%02x',0            ; DATA XREF: sub_40BB76+307o
; char aLc_all[]
aLc_all		db 'LC_ALL',0           ; DATA XREF: sub_40C244+6o
; char aLang[]
aLang		db 'LANG',0             ; DATA XREF: sub_40C244:loc_40C297o
aAf_za		db 'af_ZA',0            ; DATA XREF: sub_40C244:loc_40C302o
aSq_al		db 'sq_AL',0            ; DATA XREF: sub_40C244:loc_40C30Co
aAm_et		db 'am_ET',0            ; DATA XREF: sub_40C244:loc_40C316o
aAr_sa		db 'ar_SA',0            ; DATA XREF: sub_40C244:loc_40C339o
aAr_iq		db 'ar_IQ',0            ; DATA XREF: sub_40C244:loc_40C343o
aAr_eg		db 'ar_EG',0            ; DATA XREF: sub_40C244:loc_40C34Do
aAr_ly		db 'ar_LY',0            ; DATA XREF: sub_40C244:loc_40C357o
aAr_dz		db 'ar_DZ',0            ; DATA XREF: sub_40C244:loc_40C361o
aAr_ma		db 'ar_MA',0            ; DATA XREF: sub_40C244:loc_40C36Bo
aAr_tn		db 'ar_TN',0            ; DATA XREF: sub_40C244:loc_40C375o
aAr_om		db 'ar_OM',0            ; DATA XREF: sub_40C244:loc_40C37Fo
aAr_ye		db 'ar_YE',0            ; DATA XREF: sub_40C244:loc_40C389o
aAr_sy		db 'ar_SY',0            ; DATA XREF: sub_40C244:loc_40C393o
aAr_jo		db 'ar_JO',0            ; DATA XREF: sub_40C244:loc_40C39Do
aAr_lb		db 'ar_LB',0            ; DATA XREF: sub_40C244:loc_40C3A7o
aAr_kw		db 'ar_KW',0            ; DATA XREF: sub_40C244:loc_40C3B1o
aAr_ae		db 'ar_AE',0            ; DATA XREF: sub_40C244:loc_40C3BBo
aAr_bh		db 'ar_BH',0            ; DATA XREF: sub_40C244:loc_40C3C5o
aAr_qa		db 'ar_QA',0            ; DATA XREF: sub_40C244:loc_40C3CFo
aAr		db 'ar',0               ; DATA XREF: sub_40C244:loc_40C3D9o
aHy_am		db 'hy_AM',0            ; DATA XREF: sub_40C244:loc_40C3E3o
aAs_in		db 'as_IN',0            ; DATA XREF: sub_40C244:loc_40C3EDo
aAz_az@latin	db 'az_AZ@latin',0      ; DATA XREF: sub_40C244:loc_40C406o
aAz_az@cyrillic	db 'az_AZ@cyrillic',0   ; DATA XREF: sub_40C244:loc_40C410o
aAz		db 'az',0               ; DATA XREF: sub_40C244:loc_40C41Ao
aEu		db 'eu',0               ; DATA XREF: sub_40C244:loc_40C424o
aBe_by		db 'be_BY',0            ; DATA XREF: sub_40C244:loc_40C42Eo
aBn_in		db 'bn_IN',0            ; DATA XREF: sub_40C244:loc_40C447o
aBn_bd		db 'bn_BD',0            ; DATA XREF: sub_40C244:loc_40C451o
aBn		db 'bn',0               ; DATA XREF: sub_40C244:loc_40C45Bo
aBg_bg		db 'bg_BG',0            ; DATA XREF: sub_40C244:loc_40C465o
aMy_mm		db 'my_MM',0            ; DATA XREF: sub_40C244:loc_40C46Fo
aKm_kh		db 'km_KH',0            ; DATA XREF: sub_40C244:loc_40C479o
aCa_es		db 'ca_ES',0            ; DATA XREF: sub_40C244:loc_40C483o
aChr_us		db 'chr_US',0           ; DATA XREF: sub_40C244:loc_40C48Do
aZh_tw		db 'zh_TW',0            ; DATA XREF: sub_40C244:loc_40C4ACo
aZh_cn		db 'zh_CN',0            ; DATA XREF: sub_40C244:loc_40C4B6o
aZh_hk		db 'zh_HK',0            ; DATA XREF: sub_40C244:loc_40C4C0o
aZh_sg		db 'zh_SG',0            ; DATA XREF: sub_40C244:loc_40C4CAo
aZh_mo		db 'zh_MO',0            ; DATA XREF: sub_40C244:loc_40C4D4o
aZh		db 'zh',0               ; DATA XREF: sub_40C244:loc_40C4DEo
aHr_hr		db 'hr_HR',0            ; DATA XREF: sub_40C244+2B6o
aSr_cs		db 'sr_CS',0            ; DATA XREF: sub_40C244:loc_40C504o
aSr_cs@cyrillic	db 'sr_CS@cyrillic',0   ; DATA XREF: sub_40C244:loc_40C50Eo
aHr		db 'hr',0               ; DATA XREF: sub_40C244:loc_40C518o
aCs_cz		db 'cs_CZ',0            ; DATA XREF: sub_40C244:loc_40C522o
aDa_dk		db 'da_DK',0            ; DATA XREF: sub_40C244:loc_40C52Co
aDiv_mv		db 'div_MV',0           ; DATA XREF: sub_40C244:loc_40C536o
aNl_nl		db 'nl_NL',0            ; DATA XREF: sub_40C244:loc_40C54Fo
aNl_be		db 'nl_BE',0            ; DATA XREF: sub_40C244:loc_40C559o
aNl		db 'nl',0               ; DATA XREF: sub_40C244:loc_40C563o
aBin_ng		db 'bin_NG',0           ; DATA XREF: sub_40C244:loc_40C56Do
aEn_us		db 'en_US',0            ; DATA XREF: sub_40C244:loc_40C590o
aEn_gb		db 'en_GB',0            ; DATA XREF: sub_40C244:loc_40C59Ao
aEn_au		db 'en_AU',0            ; DATA XREF: sub_40C244:loc_40C5A4o
aEn_ca		db 'en_CA',0            ; DATA XREF: sub_40C244:loc_40C5AEo
aEn_nz		db 'en_NZ',0            ; DATA XREF: sub_40C244:loc_40C5B8o
aEn_ie		db 'en_IE',0            ; DATA XREF: sub_40C244:loc_40C5C2o
aEn_za		db 'en_ZA',0            ; DATA XREF: sub_40C244:loc_40C5CCo
aEn_jm		db 'en_JM',0            ; DATA XREF: sub_40C244:loc_40C5D6o
aEn_gd		db 'en_GD',0            ; DATA XREF: sub_40C244:loc_40C5E0o
aEn_bz		db 'en_BZ',0            ; DATA XREF: sub_40C244:loc_40C5EAo
aEn_tt		db 'en_TT',0            ; DATA XREF: sub_40C244:loc_40C5F4o
aEn_zw		db 'en_ZW',0            ; DATA XREF: sub_40C244:loc_40C5FEo
aEn_ph		db 'en_PH',0            ; DATA XREF: sub_40C244:loc_40C608o
aEn_id		db 'en_ID',0            ; DATA XREF: sub_40C244:loc_40C612o
aEn_hk		db 'en_HK',0            ; DATA XREF: sub_40C244:loc_40C61Co
aEn_in		db 'en_IN',0            ; DATA XREF: sub_40C244:loc_40C626o
aEn_my		db 'en_MY',0            ; DATA XREF: sub_40C244:loc_40C630o
aEn_sg		db 'en_SG',0            ; DATA XREF: sub_40C244:loc_40C63Ao
aEn		db 'en',0               ; DATA XREF: sub_40C244:loc_40C644o
aEt_ee		db 'et_EE',0            ; DATA XREF: sub_40C244:loc_40C64Eo
aFo_fo		db 'fo_FO',0            ; DATA XREF: sub_40C244:loc_40C658o
aFa_ir		db 'fa_IR',0            ; DATA XREF: sub_40C244:loc_40C662o
aFi_fi		db 'fi_FI',0            ; DATA XREF: sub_40C244:loc_40C66Co
aFr_fr		db 'fr_FR',0            ; DATA XREF: sub_40C244:loc_40C68Fo
aFr_be		db 'fr_BE',0            ; DATA XREF: sub_40C244:loc_40C699o
aFr_ca		db 'fr_CA',0            ; DATA XREF: sub_40C244:loc_40C6A3o
aFr_ch		db 'fr_CH',0            ; DATA XREF: sub_40C244:loc_40C6ADo
aFr_lu		db 'fr_LU',0            ; DATA XREF: sub_40C244:loc_40C6B7o
aFr_mc		db 'fr_MC',0            ; DATA XREF: sub_40C244:loc_40C6C1o
aFr		db 'fr',0               ; DATA XREF: sub_40C244:loc_40C6CBo
					; sub_40C244:loc_40C725o
aFr_re		db 'fr_RE',0            ; DATA XREF: sub_40C244:loc_40C6D5o
aFr_cg		db 'fr_CG',0            ; DATA XREF: sub_40C244:loc_40C6DFo
aFr_sn		db 'fr_SN',0            ; DATA XREF: sub_40C244:loc_40C6E9o
aFr_cm		db 'fr_CM',0            ; DATA XREF: sub_40C244:loc_40C6F3o
aFr_ci		db 'fr_CI',0            ; DATA XREF: sub_40C244:loc_40C6FDo
aFr_ml		db 'fr_ML',0            ; DATA XREF: sub_40C244:loc_40C707o
aFr_ma		db 'fr_MA',0            ; DATA XREF: sub_40C244:loc_40C711o
aFr_ht		db 'fr_HT',0            ; DATA XREF: sub_40C244:loc_40C71Bo
aFy_nl		db 'fy_NL',0            ; DATA XREF: sub_40C244:loc_40C72Fo
aFul_ng		db 'ful_NG',0           ; DATA XREF: sub_40C244:loc_40C739o
aGd_gb		db 'gd_GB',0            ; DATA XREF: sub_40C244:loc_40C752o
aGa_ie		db 'ga_IE',0            ; DATA XREF: sub_40C244:loc_40C75Co
aC		db 'C',0                ; DATA XREF: sub_40C244:loc_40C766o
					; sub_40C244:loc_40CD84o
aGl_es		db 'gl_ES',0            ; DATA XREF: sub_40C244:loc_40C770o
aKa_ge		db 'ka_GE',0            ; DATA XREF: sub_40C244:loc_40C77Ao
aDe_de		db 'de_DE',0            ; DATA XREF: sub_40C244:loc_40C799o
aDe_ch		db 'de_CH',0            ; DATA XREF: sub_40C244:loc_40C7A3o
aDe_at		db 'de_AT',0            ; DATA XREF: sub_40C244:loc_40C7ADo
aDe_lu		db 'de_LU',0            ; DATA XREF: sub_40C244:loc_40C7B7o
aDe_li		db 'de_LI',0            ; DATA XREF: sub_40C244:loc_40C7C1o
aDe		db 'de',0               ; DATA XREF: sub_40C244:loc_40C7CBo
aEl_gr		db 'el_GR',0            ; DATA XREF: sub_40C244:loc_40C7D5o
aGn_py		db 'gn_PY',0            ; DATA XREF: sub_40C244:loc_40C7DFo
aGu_in		db 'gu_IN',0            ; DATA XREF: sub_40C244:loc_40C7E9o
aHa_ng		db 'ha_NG',0            ; DATA XREF: sub_40C244:loc_40C7F3o
aCpe_us		db 'cpe_US',0           ; DATA XREF: sub_40C244:loc_40C7FDo
aHe_il		db 'he_IL',0            ; DATA XREF: sub_40C244:loc_40C807o
aHi_in		db 'hi_IN',0            ; DATA XREF: sub_40C244:loc_40C811o
aHu_hu		db 'hu_HU',0            ; DATA XREF: sub_40C244:loc_40C81Bo
aNic_ng		db 'nic_NG',0           ; DATA XREF: sub_40C244:loc_40C825o
aIs_is		db 'is_IS',0            ; DATA XREF: sub_40C244:loc_40C82Fo
aIbo_ng		db 'ibo_NG',0           ; DATA XREF: sub_40C244:loc_40C839o
aId_id		db 'id_ID',0            ; DATA XREF: sub_40C244:loc_40C843o
aIu_ca		db 'iu_CA',0            ; DATA XREF: sub_40C244:loc_40C84Do
aIt_it		db 'it_IT',0            ; DATA XREF: sub_40C244:loc_40C866o
aIt_ch		db 'it_CH',0            ; DATA XREF: sub_40C244:loc_40C870o
aIt		db 'it',0               ; DATA XREF: sub_40C244:loc_40C87Ao
aJa_jp		db 'ja_JP',0            ; DATA XREF: sub_40C244:loc_40C884o
aKn_in		db 'kn_IN',0            ; DATA XREF: sub_40C244:loc_40C88Eo
aKau_ng		db 'kau_NG',0           ; DATA XREF: sub_40C244:loc_40C898o
aKs_pk		db 'ks_PK',0            ; DATA XREF: sub_40C244:loc_40C8B1o
aKs_in		db 'ks_IN',0            ; DATA XREF: sub_40C244:loc_40C8BBo
aKs		db 'ks',0               ; DATA XREF: sub_40C244:loc_40C8C5o
aKk_kz		db 'kk_KZ',0            ; DATA XREF: sub_40C244:loc_40C8CFo
aKok_in		db 'kok_IN',0           ; DATA XREF: sub_40C244:loc_40C8D9o
aKo_kr		db 'ko_KR',0            ; DATA XREF: sub_40C244:loc_40C8E3o
aKy_kg		db 'ky_KG',0            ; DATA XREF: sub_40C244:loc_40C8EDo
aLo_la		db 'lo_LA',0            ; DATA XREF: sub_40C244:loc_40C8F7o
aLa_va		db 'la_VA',0            ; DATA XREF: sub_40C244:loc_40C901o
aLv_lv		db 'lv_LV',0            ; DATA XREF: sub_40C244:loc_40C90Bo
aLt_lt		db 'lt_LT',0            ; DATA XREF: sub_40C244:loc_40C915o
aMk_mk		db 'mk_MK',0            ; DATA XREF: sub_40C244:loc_40C91Fo
aMs_my		db 'ms_MY',0            ; DATA XREF: sub_40C244:loc_40C938o
aMs_bn		db 'ms_BN',0            ; DATA XREF: sub_40C244:loc_40C942o
aMs		db 'ms',0               ; DATA XREF: sub_40C244:loc_40C94Co
aMl_in		db 'ml_IN',0            ; DATA XREF: sub_40C244:loc_40C956o
aMt_mt		db 'mt_MT',0            ; DATA XREF: sub_40C244:loc_40C960o
aMni_in		db 'mni_IN',0           ; DATA XREF: sub_40C244:loc_40C96Ao
aMr_in		db 'mr_IN',0            ; DATA XREF: sub_40C244:loc_40C974o
aMn		db 'mn',0               ; DATA XREF: sub_40C244:loc_40C97Eo
aNe_np		db 'ne_NP',0            ; DATA XREF: sub_40C244:loc_40C997o
aNe_in		db 'ne_IN',0            ; DATA XREF: sub_40C244:loc_40C9A1o
aNe		db 'ne',0               ; DATA XREF: sub_40C244:loc_40C9ABo
aNo_no		db 'no_NO',0            ; DATA XREF: sub_40C244:loc_40C9C4o
aNn_no		db 'nn_NO',0            ; DATA XREF: sub_40C244:loc_40C9CEo
aNo		db 'no',0               ; DATA XREF: sub_40C244:loc_40C9D8o
aOr_in		db 'or_IN',0            ; DATA XREF: sub_40C244:loc_40C9E2o
aOm_et		db 'om_ET',0            ; DATA XREF: sub_40C244:loc_40C9ECo
aPap_an		db 'pap_AN',0           ; DATA XREF: sub_40C244:loc_40C9F6o
aPs		db 'ps',0               ; DATA XREF: sub_40C244:loc_40CA00o
aPl_pl		db 'pl_PL',0            ; DATA XREF: sub_40C244:loc_40CA0Ao
aPt_pt		db 'pt_PT',0            ; DATA XREF: sub_40C244+7DDo
aPt_br		db 'pt_BR',0            ; DATA XREF: sub_40C244:loc_40CA2Bo
aPt		db 'pt',0               ; DATA XREF: sub_40C244:loc_40CA35o
aPa_in		db 'pa_IN',0            ; DATA XREF: sub_40C244+803o
aPa		db 'pa',0               ; DATA XREF: sub_40C244:loc_40CA51o
aRm_ch		db 'rm_CH',0            ; DATA XREF: sub_40C244:loc_40CA5Bo
aRo_ro		db 'ro_RO',0            ; DATA XREF: sub_40C244+829o
aRo		db 'ro',0               ; DATA XREF: sub_40C244:loc_40CA77o
aRu		db 'ru',0               ; DATA XREF: sub_40C244:loc_40CA81o
aSe_no		db 'se_NO',0            ; DATA XREF: sub_40C244:loc_40CA8Bo
aSa_in		db 'sa_IN',0            ; DATA XREF: sub_40C244:loc_40CA95o
aSd_in		db 'sd_IN',0            ; DATA XREF: sub_40C244:loc_40CAADo
aSd_pk		db 'sd_PK',0            ; DATA XREF: sub_40C244:loc_40CAB7o
aSd		db 'sd',0               ; DATA XREF: sub_40C244:loc_40CAC1o
aSi_lk		db 'si_LK',0            ; DATA XREF: sub_40C244:loc_40CACBo
aSk_sk		db 'sk_SK',0            ; DATA XREF: sub_40C244:loc_40CAD5o
aSl_si		db 'sl_SI',0            ; DATA XREF: sub_40C244:loc_40CADFo
aSo_so		db 'so_SO',0            ; DATA XREF: sub_40C244:loc_40CAE9o
aWen_de		db 'wen_DE',0           ; DATA XREF: sub_40C244:loc_40CAF3o
aEs_es		db 'es_ES',0            ; DATA XREF: sub_40C244:loc_40CB16o
aEs_mx		db 'es_MX',0            ; DATA XREF: sub_40C244:loc_40CB20o
aEs_es@modern	db 'es_ES@modern',0     ; DATA XREF: sub_40C244:loc_40CB2Ao
aEs_gt		db 'es_GT',0            ; DATA XREF: sub_40C244:loc_40CB34o
aEs_cr		db 'es_CR',0            ; DATA XREF: sub_40C244:loc_40CB3Eo
aEs_pa		db 'es_PA',0            ; DATA XREF: sub_40C244:loc_40CB48o
aEs_do		db 'es_DO',0            ; DATA XREF: sub_40C244:loc_40CB52o
aEs_ve		db 'es_VE',0            ; DATA XREF: sub_40C244:loc_40CB5Co
aEs_co		db 'es_CO',0            ; DATA XREF: sub_40C244:loc_40CB66o
aEs_pe		db 'es_PE',0            ; DATA XREF: sub_40C244:loc_40CB70o
aEs_ar		db 'es_AR',0            ; DATA XREF: sub_40C244:loc_40CB7Ao
aEs_ec		db 'es_EC',0            ; DATA XREF: sub_40C244:loc_40CB84o
aEs_cl		db 'es_CL',0            ; DATA XREF: sub_40C244:loc_40CB8Eo
aEs_uy		db 'es_UY',0            ; DATA XREF: sub_40C244:loc_40CB98o
aEs_py		db 'es_PY',0            ; DATA XREF: sub_40C244:loc_40CBA2o
aEs_bo		db 'es_BO',0            ; DATA XREF: sub_40C244:loc_40CBACo
aEs_sv		db 'es_SV',0            ; DATA XREF: sub_40C244:loc_40CBB6o
aEs_hn		db 'es_HN',0            ; DATA XREF: sub_40C244:loc_40CBC0o
aEs_ni		db 'es_NI',0            ; DATA XREF: sub_40C244:loc_40CBCAo
aEs_pr		db 'es_PR',0            ; DATA XREF: sub_40C244:loc_40CBD4o
aEs		db 'es',0               ; DATA XREF: sub_40C244:loc_40CBDEo
aBnt_tz		db 'bnt_TZ',0           ; DATA XREF: sub_40C244:loc_40CBE8o
aSw_ke		db 'sw_KE',0            ; DATA XREF: sub_40C244:loc_40CBF2o
aSv_se		db 'sv_SE',0            ; DATA XREF: sub_40C244:loc_40CC0Bo
aSv_fi		db 'sv_FI',0            ; DATA XREF: sub_40C244:loc_40CC15o
aSv		db 'sv',0               ; DATA XREF: sub_40C244:loc_40CC1Fo
aSyr_tr		db 'syr_TR',0           ; DATA XREF: sub_40C244:loc_40CC29o
aTl_ph		db 'tl_PH',0            ; DATA XREF: sub_40C244:loc_40CC33o
aTg_tj		db 'tg_TJ',0            ; DATA XREF: sub_40C244:loc_40CC3Do
aBer_ma@arabic	db 'ber_MA@arabic',0    ; DATA XREF: sub_40C244:loc_40CC56o
aBer_ma@latin	db 'ber_MA@latin',0     ; DATA XREF: sub_40C244:loc_40CC60o
aBer_ma		db 'ber_MA',0           ; DATA XREF: sub_40C244:loc_40CC6Ao
aTa		db 'ta',0               ; DATA XREF: sub_40C244:loc_40CC74o
aTt_ru		db 'tt_RU',0            ; DATA XREF: sub_40C244:loc_40CC7Eo
aTe_in		db 'te_IN',0            ; DATA XREF: sub_40C244:loc_40CC88o
aTh_th		db 'th_TH',0            ; DATA XREF: sub_40C244:loc_40CC92o
aBo_cn		db 'bo_CN',0            ; DATA XREF: sub_40C244:loc_40CC9Co
aTi_et		db 'ti_ET',0            ; DATA XREF: sub_40C244:loc_40CCB4o
aTi_er		db 'ti_ER',0            ; DATA XREF: sub_40C244:loc_40CCBEo
aTi		db 'ti',0               ; DATA XREF: sub_40C244:loc_40CCC8o
aTs_za		db 'ts_ZA',0            ; DATA XREF: sub_40C244:loc_40CCD2o
aTn_bw		db 'tn_BW',0            ; DATA XREF: sub_40C244:loc_40CCDCo
aTr_tr		db 'tr_TR',0            ; DATA XREF: sub_40C244:loc_40CCE6o
aTk_tm		db 'tk_TM',0            ; DATA XREF: sub_40C244:loc_40CCF0o
aUk_ua		db 'uk_UA',0            ; DATA XREF: sub_40C244:loc_40CCFAo
aUr_pk		db 'ur_PK',0            ; DATA XREF: sub_40C244:loc_40CD13o
aUr_in		db 'ur_IN',0            ; DATA XREF: sub_40C244:loc_40CD1Ao
aUr		db 'ur',0               ; DATA XREF: sub_40C244:loc_40CD21o
aUz_uz		db 'uz_UZ',0            ; DATA XREF: sub_40C244:loc_40CD37o
aUz_uz@cyrillic	db 'uz_UZ@cyrillic',0   ; DATA XREF: sub_40C244:loc_40CD3Eo
aUz		db 'uz',0               ; DATA XREF: sub_40C244:loc_40CD45o
aVen_za		db 'ven_ZA',0           ; DATA XREF: sub_40C244:loc_40CD4Co
aVi_vn		db 'vi_VN',0            ; DATA XREF: sub_40C244:loc_40CD53o
aCy_gb		db 'cy_GB',0            ; DATA XREF: sub_40C244:loc_40CD5Ao
aXh_za		db 'xh_ZA',0            ; DATA XREF: sub_40C244:loc_40CD61o
aSit_cn		db 'sit_CN',0           ; DATA XREF: sub_40C244:loc_40CD68o
aYi_il		db 'yi_IL',0            ; DATA XREF: sub_40C244:loc_40CD6Fo
aYo_ng		db 'yo_NG',0            ; DATA XREF: sub_40C244:loc_40CD76o
aZu_za		db 'zu_ZA',0            ; DATA XREF: sub_40C244:loc_40CD7Do
		align 10h
off_4183A0	dd offset loc_40CD84, offset loc_40C320, offset	loc_40C465
					; DATA XREF: sub_40C244+B5o
		dd offset loc_40C483, offset loc_40C497, offset	loc_40C522 ; jump table	for switch statement
		dd offset loc_40C52C, offset loc_40C784, offset	loc_40C7D5
		dd offset loc_40C577, offset loc_40CAFD, offset	loc_40C66C
		dd offset loc_40C676, offset loc_40C807, offset	loc_40C81B
		dd offset loc_40C82F, offset loc_40C857, offset	loc_40C884
		dd offset loc_40C8E3, offset loc_40C540, offset	loc_40C9B5
		dd offset loc_40CA0A, offset loc_40CA14, offset	loc_40CA5B
		dd offset loc_40CA65, offset loc_40CA81, offset	loc_40C4E8
		dd offset loc_40CAD5, offset loc_40C30C, offset	loc_40CBFC
		dd offset loc_40CC92, offset loc_40CCE6, offset	loc_40CD04
		dd offset loc_40C843, offset loc_40CCFA, offset	loc_40C42E
		dd offset loc_40CADF, offset loc_40C64E, offset	loc_40C90B
		dd offset loc_40C915, offset loc_40CC3D, offset	loc_40C662
		dd offset loc_40CD53, offset loc_40C3E3, offset	loc_40C3F7
		dd offset loc_40C424, offset loc_40CAF3, offset	loc_40C91F
		dd offset loc_40CBE8, offset loc_40CCD2, offset	loc_40CCDC
		dd offset loc_40CD4C, offset loc_40CD61, offset	loc_40CD7D
		dd offset loc_40C302, offset loc_40C77A, offset	loc_40C658
		dd offset loc_40C811, offset loc_40C960, offset	loc_40CA8B
		dd offset loc_40C743, offset loc_40CD6F, offset	loc_40C929
		dd offset loc_40C8CF, offset loc_40C8ED, offset	loc_40CBF2
		dd offset loc_40CCF0, offset loc_40CD28, offset	loc_40CC7E
		dd offset loc_40C438, offset loc_40CA3F, offset	loc_40C7E9
		dd offset loc_40C9E2, offset loc_40CC74, offset	loc_40CC88
		dd offset loc_40C88E, offset loc_40C956, offset	loc_40C3ED
		dd offset loc_40C974, offset loc_40CA95, offset	loc_40C97E
		dd offset loc_40CC9C, offset loc_40CD5A, offset	loc_40C479
		dd offset loc_40C8F7, offset loc_40C46F, offset	loc_40C770
		dd offset loc_40C8D9, offset loc_40C96A, offset	loc_40CA9F
		dd offset loc_40CC29, offset loc_40CACB, offset	loc_40C48D
		dd offset loc_40C84D, offset loc_40C316, offset	loc_40CC47
		dd offset loc_40C8A2, offset loc_40C988, offset	loc_40C72F
		dd offset loc_40CA00, offset loc_40CC33, offset	loc_40C536
		dd offset loc_40C56D, offset loc_40C739, offset	loc_40C7F3
		dd offset loc_40C825, offset loc_40CD76, offset	loc_40CD84
		dd offset loc_40CD84, offset loc_40CD84, offset	loc_40CD84
		dd offset loc_40CD84, offset loc_40C839, offset	loc_40C898
		dd offset loc_40C9EC, offset loc_40CCA6, offset	loc_40C7DF
		dd offset loc_40C7FD, offset loc_40C901, offset	loc_40CAE9
		dd offset loc_40CD68, offset loc_40C9F6
off_418588	dd offset loc_40C3D9	; DATA XREF: sub_40C244+ECo
		dd offset loc_40C339	; jump table for switch	statement
		dd offset loc_40C343
		dd offset loc_40C34D
		dd offset loc_40C357
		dd offset loc_40C361
		dd offset loc_40C36B
		dd offset loc_40C375
		dd offset loc_40C37F
		dd offset loc_40C389
		dd offset loc_40C393
		dd offset loc_40C39D
		dd offset loc_40C3A7
		dd offset loc_40C3B1
		dd offset loc_40C3BB
		dd offset loc_40C3C5
		dd offset loc_40C3CF
off_4185CC	dd offset loc_40C4DE	; DATA XREF: sub_40C244+25Fo
		dd offset loc_40C4AC	; jump table for switch	statement
		dd offset loc_40C4B6
		dd offset loc_40C4C0
		dd offset loc_40C4CA
		dd offset loc_40C4D4
off_4185E4	dd offset loc_40C644	; DATA XREF: sub_40C244+343o
		dd offset loc_40C590	; jump table for switch	statement
		dd offset loc_40C59A
		dd offset loc_40C5A4
		dd offset loc_40C5AE
		dd offset loc_40C5B8
		dd offset loc_40C5C2
		dd offset loc_40C5CC
		dd offset loc_40C5D6
		dd offset loc_40C5E0
		dd offset loc_40C5EA
		dd offset loc_40C5F4
		dd offset loc_40C5FE
		dd offset loc_40C608
		dd offset loc_40C612
		dd offset loc_40C61C
		dd offset loc_40C626
		dd offset loc_40C630
		dd offset loc_40C63A
off_418630	dd offset loc_40C725	; DATA XREF: sub_40C244+442o
		dd offset loc_40C68F	; jump table for switch	statement
		dd offset loc_40C699
		dd offset loc_40C6A3
		dd offset loc_40C6AD
		dd offset loc_40C6B7
		dd offset loc_40C6C1
		dd offset loc_40C6CB
		dd offset loc_40C6D5
		dd offset loc_40C6DF
		dd offset loc_40C6E9
		dd offset loc_40C6F3
		dd offset loc_40C6FD
		dd offset loc_40C707
		dd offset loc_40C711
		dd offset loc_40C71B
off_418670	dd offset loc_40C7CB	; DATA XREF: sub_40C244+54Co
		dd offset loc_40C799	; jump table for switch	statement
		dd offset loc_40C7A3
		dd offset loc_40C7AD
		dd offset loc_40C7B7
		dd offset loc_40C7C1
off_418688	dd offset loc_40CBDE	; DATA XREF: sub_40C244+8C9o
		dd offset loc_40CB16	; jump table for switch	statement
		dd offset loc_40CB20
		dd offset loc_40CB2A
		dd offset loc_40CB34
		dd offset loc_40CB3E
		dd offset loc_40CB48
		dd offset loc_40CB52
		dd offset loc_40CB5C
		dd offset loc_40CB66
		dd offset loc_40CB70
		dd offset loc_40CB7A
		dd offset loc_40CB84
		dd offset loc_40CB8E
		dd offset loc_40CB98
		dd offset loc_40CBA2
		dd offset loc_40CBAC
		dd offset loc_40CBB6
		dd offset loc_40CBC0
		dd offset loc_40CBCA
		dd offset loc_40CBD4
; char Mode[3]
Mode		db 'rb',0               ; DATA XREF: sub_40CE6A+16o
; char aLc_messages[]
aLc_messages	db 'LC_MESSAGES',0      ; DATA XREF: sub_40D40E+16o
					; .text:0040DD61o
aLc_messages_0	db '\LC_MESSAGES\',0    ; DATA XREF: sub_40D40E+1AAo
a_mo		db '.mo',0              ; DATA XREF: sub_40D40E+202o
		align 10h
aErrorInGettext	db 'ERROR in GETTEXT (bad plural entry)',0 ; DATA XREF: sub_40D668+3Bo
aErrorInGette_0	db 'ERROR in GETTEXT MALLOC',0 ; DATA XREF: sub_40D6CE+13Do
					; sub_40D6CE:loc_40D931o
aErrorInGette_1	db 'ERROR in GETTEXT (overflow space)',0Ah,0
					; DATA XREF: sub_40D6CE:loc_40D9A5o
byte_41875F	db 0			; DATA XREF: .text:loc_40DD7Bo
asc_418760	db '-',0                ; DATA XREF: sub_40DDC5+55o
					; sub_40E024:loc_40E035o
aSocket		db 'socket://',0        ; DATA XREF: sub_40DDC5+9Do
aSystemDoesNotS	db 'system does not support logging to a socket - using stderr',0Ah,0
					; DATA XREF: sub_40DDC5+FDo
; char aA_0[]
aA_0		db 'a',0                ; DATA XREF: sub_40DDC5+131o
					; sub_40DDC5:loc_40DF35o
		align 4
; char aFailedToOpenLo[]
aFailedToOpenLo	db 'failed to open log file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40DDC5+1B1o
		align 10h
; char aFailedToFdopen[]
aFailedToFdopen	db 'failed to fdopen file descriptor %d: %s',0Ah,0
					; DATA XREF: sub_40DDC5+1E9o
		align 4
; char a____Gnupg22__3[]
a____Gnupg22__3	db '../../gnupg2-2.0.30/jnlib/logging.c',0 ; DATA XREF: sub_40E1E6+2Fo
; char aLogstream[]
aLogstream	db 'logstream',0        ; DATA XREF: sub_40E1E6+37o
		align 4
; char a04d02d02d02d02[]
a04d02d02d02d02	db '%04d-%02d-%02d %02d:%02d:%02d ',0 ; DATA XREF: sub_40E1E6+E3o
; char aU_Lx[]
aU_Lx		db '[%u.%lx]',0         ; DATA XREF: sub_40E1E6+16Bo
; char aU[]
aU		db '[%u]',0             ; DATA XREF: sub_40E1E6+192o
aFatal		db 'Fatal: ',0          ; DATA XREF: sub_40E1E6+21Do
aOhhhhJeeee	db 'Ohhhh jeeee: ',0    ; DATA XREF: sub_40E1E6+246o
aDbg		db 'DBG: ',0            ; DATA XREF: sub_40E1E6+26Fo
; char aUnknownLogLeve[]
aUnknownLogLeve	db '[Unknown log level %d]: ',0 ; DATA XREF: sub_40E1E6:loc_40E478o
		align 10h
off_418890	dd offset loc_40E497	; DATA XREF: sub_40E1E6+20Eo
		dd offset loc_40E497	; jump table for switch	statement
		dd offset loc_40E497
		dd offset loc_40E497
		dd offset loc_40E497
		dd offset loc_40E3FD
		dd offset loc_40E426
		dd offset loc_40E44F
dword_4188B0	dd 207325h		; DATA XREF: .text:0040E6F1o
a02x_0		db '%02X',0             ; DATA XREF: .text:0040E716o
a02x_1		db ' %02X',0            ; DATA XREF: .text:0040E739o
asc_4188BF	db 0Ah,0		; DATA XREF: .text:0040E75Eo
; char a___ThisIsABugS[]
a___ThisIsABugS	db '... this is a bug (%s:%d:%s)',0Ah,0 ; DATA XREF: sub_40E76C+1Bo
		align 10h
; char aInvalidArgumen[]
aInvalidArgumen	db 'invalid argument for arg_parsee',0Ah,0 ; DATA XREF: sub_40E7A0+81o
; char aArgumentNotExp[]
aArgumentNotExp	db 'argument not expected',0 ; DATA XREF: sub_40E7A0+B0o
; char aReadError[]
aReadError	db 'read error',0       ; DATA XREF: sub_40E7A0+CFo
; char aKeywordTooLong[]
aKeywordTooLong	db 'keyword too long',0 ; DATA XREF: sub_40E7A0+EEo
; char aMissingArgumen[]
aMissingArgumen	db 'missing argument',0 ; DATA XREF: sub_40E7A0+10Do
; char aInvalidArgum_0[]
aInvalidArgum_0	db 'invalid argument',0 ; DATA XREF: sub_40E7A0+129o
; char aInvalidCommand[]
aInvalidCommand	db 'invalid command',0  ; DATA XREF: sub_40E7A0+145o
; char aInvalidAliasDe[]
aInvalidAliasDe	db 'invalid alias definition',0 ; DATA XREF: sub_40E7A0+161o
; char aOutOfCore[]
aOutOfCore	db 'out of core',0      ; DATA XREF: sub_40E7A0+17Do
; char aInvalidOption[]
aInvalidOption	db 'invalid option',0   ; DATA XREF: sub_40E7A0:loc_40E92Eo
; char aSUS[]
aSUS		db '%s:%u: %s',0Ah,0    ; DATA XREF: sub_40E7A0+1B4o
a??		db '[??]',0             ; DATA XREF: sub_40E7A0:loc_40E977o
		align 4
; char aMissingArgum_0[]
aMissingArgum_0	db 'missing argument for option "%.50s"',0Ah,0 ; DATA XREF: sub_40E7A0+1EAo
		align 4
; char aInvalidArgum_1[]
aInvalidArgum_1	db 'invalid argument for option "%.50s"',0Ah,0 ; DATA XREF: sub_40E7A0+215o
		align 4
; char aOption_50sDoes[]
aOption_50sDoes	db 'option "%.50s" does not expect an argument',0Ah,0
					; DATA XREF: sub_40E7A0+240o
; char aInvalidComma_0[]
aInvalidComma_0	db 'invalid command "%.50s"',0Ah,0 ; DATA XREF: sub_40E7A0+26Bo
; char aOption_50sIsAm[]
aOption_50sIsAm	db 'option "%.50s" is ambiguous',0Ah,0 ; DATA XREF: sub_40E7A0+296o
; char aCommand_50sIsA[]
aCommand_50sIsA	db 'command "%.50s" is ambiguous',0Ah,0 ; DATA XREF: sub_40E7A0+2BEo
; char aOutOfCore_0[]
aOutOfCore_0	db 'out of core',0Ah,0  ; DATA XREF: sub_40E7A0+2E6o
; char aS[]
aS		db '%s',0Ah,0           ; DATA XREF: sub_40E7A0+2F6o
; char aInvalidOption_[]
aInvalidOption_	db 'invalid option "%.50s"',0Ah,0 ; DATA XREF: sub_40E7A0:loc_40EAA4o
aIgnoreInvalidO	db 'ignore-invalid-option',0 ; DATA XREF: .text:0040EE67o
					; .text:loc_40F326o
asc_418ABB	db ' ',9,0              ; DATA XREF: .text:0040EFDDo
aAlias		db 'alias',0            ; DATA XREF: .text:0040F2F9o
; char Str1[]
Str1		db 'help',0             ; DATA XREF: sub_40F6ED+1A6o
; char aVersion[]
aVersion	db 'version',0          ; DATA XREF: sub_40F6ED+1E0o
; char aWarranty[]
aWarranty	db 'warranty',0         ; DATA XREF: sub_40F6ED+222o
; char aDumpOptions[]
aDumpOptions	db 'dump-options',0     ; DATA XREF: sub_40F6ED+266o
; char aS_0[]
aS_0		db '--%s',0Ah,0         ; DATA XREF: sub_40F6ED+2B2o
		align 10h
aDumpOptionsHel	db '--dump-options',0Ah ; DATA XREF: sub_40F6ED+2DEo
		db '--help',0Ah
		db '--version',0Ah
		db '--warranty',0Ah,0
asc_418B1C	db 'x',0                ; DATA XREF: sub_40F6ED:loc_40FDE7o
; char aOptions[]
aOptions	db 'Options:',0         ; DATA XREF: sub_4100D8+CEo
; char aC_0[]
aC_0		db ' -%c',0             ; DATA XREF: sub_4100D8+1B1o
asc_418B2C	db '   ',0              ; DATA XREF: sub_4100D8+245o
					; sub_4100D8+332o
; char aCS[]
aCS		db '%c --%s',0          ; DATA XREF: sub_4100D8:loc_41037Co
; char aASingleDashMay[]
aASingleDashMay	db 0Ah			; DATA XREF: sub_4100D8+45Co
		db '(A single dash may be used instead of the double ones)',0
; char SubStr[]
SubStr		db '@EMAIL@',0          ; DATA XREF: sub_4100D8+48Do
aHttpBugs_gnupg	db 'http://bugs.gnupg.org',0 ; DATA XREF: sub_4100D8+4F0o
; char aS_1[]
aS_1		db ' (%s)',0            ; DATA XREF: sub_410643+3Co
; char aSS[]
aSS		db ' %s %s',0Ah,0       ; DATA XREF: sub_410643+5Co
aGpg4win2_3_1	db '(Gpg4win 2.3.1)',0  ; DATA XREF: sub_410643+61o
; char aSSS[]
aSSS		db '%s %s; %s',0Ah,0    ; DATA XREF: sub_4107D6+37o
		align 4
aLicenseGplv3Gn	db 'License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licens'
					; DATA XREF: sub_4108F9:loc_41093Fo
		db 'es/gpl.html>',0
aFoo		db 'foo',0              ; DATA XREF: sub_4108F9:loc_410948o
a0_0		db '0.0',0              ; DATA XREF: sub_4108F9:loc_410951o
		align 10h
aCopyrightC2015	db 'Copyright (C) 2015 Free Software Foundation, Inc.',0
					; DATA XREF: sub_4108F9:loc_41095Ao
		align 4
aThisIsFreeSoft	db 'This is free software: you are free to change and redistribute it'
					; DATA XREF: sub_4108F9:loc_410963o
		db '.',0Ah
		db 'There is NO WARRANTY, to the extent permitted by law.',0Ah,0
		align 10h
aThisIsFreeSo_0	db 'This is free software; you can redistribute it and/or modify',0Ah
					; DATA XREF: sub_4108F9:loc_41096Co
		db 'it under the terms of the GNU General Public License as published'
		db ' by',0Ah
		db 'the Free Software Foundation; either version 3 of the License, or'
		db 0Ah
		db '(at your option) any later version.',0Ah
		db 0Ah
		db 'It is distributed in the hope that it will be useful,',0Ah
		db 'but WITHOUT ANY WARRANTY; without even the implied warranty of',0Ah
		db 'MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the',0Ah
		db 'GNU General Public License for more details.',0Ah
		db 0Ah
		db 'You should have received a copy of the GNU General Public License'
		db 0Ah
		db 'along with this software.  If not, see <http://www.gnu.org/licens'
		db 'es/>.',0Ah,0
dword_418F14	dd 0			; DATA XREF: sub_4108F9:loc_410975o
off_418F18	dd offset loc_41093F	; DATA XREF: sub_4108F9+3Dr
		dd offset loc_410948	; jump table for switch	statement
		dd offset loc_41097D
		dd offset loc_410951
		dd offset loc_41095A
		dd offset loc_410963
		dd offset loc_41096C
		dd offset loc_41097D
		dd offset loc_41097D
		dd offset loc_41097D
		dd offset loc_41097D
		dd offset loc_41097D
		dd offset loc_41097D
		dd offset loc_41097D
		dd offset loc_41097D
		dd offset loc_41097D
		dd offset loc_41097D
		dd offset loc_41097D
		dd offset loc_41097D
		dd offset loc_41097D
		dd offset loc_41097D
		dd offset loc_41097D
		dd offset loc_41097D
		dd offset loc_41097D
		dd offset loc_41097D
		dd offset loc_41097D
		dd offset loc_41097D
		dd offset loc_41097D
		dd offset loc_41097D
		dd offset loc_41097D
		dd offset loc_410975
		dd offset loc_410975
asc_418F98	db ' ',9,0Dh,0Ah,0      ; DATA XREF: .text:00410D7Eo
					; .text:00410E16o
a_		db '.',0                ; DATA XREF: .text:00410F03o
		align 10h
a____Gnupg22__4	db '../../gnupg2-2.0.30/jnlib/stringhelp.c',0 ; DATA XREF: sub_410F6A+A0o
; char aHome_0[]
aHome_0		db 'HOME',0             ; DATA XREF: sub_410F6A:loc_41108Bo
; char aX02x_0[]
aX02x_0		db 'x%02x',0            ; DATA XREF: sub_41151F+164o
					; .text:00411A83o
word_418FD2	dw 0			; DATA XREF: .text:00412363o
					; sub_412396+Co
aFatalTooManyAr	db 0Ah			; DATA XREF: sub_412396+56o
		db 'fatal: too many args for xstrconcat',0Ah,0
aFatalOutOfMemo	db 0Ah			; DATA XREF: sub_412396+81o
		db 'fatal: out of memory',0Ah,0
aDo_make_filena	db 'do_make_filename',0 ; DATA XREF: sub_410F6A+90o
		align 4
; char aRb[]
aRb		db 'rb',0               ; DATA XREF: sub_41244C+6o
		align 4
aIso88591	db 'iso-8859-1',0       ; DATA XREF: sub_4126F0+D9o
					; sub_4127EF:loc_4129C4o ...
aUtf8		db 'utf-8',0            ; DATA XREF: sub_4126F0+22o
					; sub_4127EF+20Fo ...
		align 4
; char aConversionFrom[]
aConversionFrom	db 'conversion from `%s',27h,' to `%s',27h,' not available',0Ah,0
					; DATA XREF: sub_4126F0+71o
; char aIconv_openFail[]
aIconv_openFail	db 'iconv_open failed: %s',0Ah,0 ; DATA XREF: sub_4126F0+B1o
; char aCpU[]
aCpU		db 'CP%u',0             ; DATA XREF: sub_4127EF:loc_41281Ao
aCp936		db 'CP936',0            ; DATA XREF: sub_4127EF+4Eo
aGbk		db 'GBK',0
aCp1361		db 'CP1361',0
aJohab		db 'JOHAB',0
aCp20127	db 'CP20127',0
aAscii_0	db 'ASCII',0
aCp20866	db 'CP20866',0
aKoi8R		db 'KOI8-R',0
aCp21866	db 'CP21866',0
aKoi8Ru		db 'KOI8-RU',0
aCp28591	db 'CP28591',0
aIso88591_0	db 'ISO-8859-1',0
aCp28592	db 'CP28592',0
aIso88592	db 'ISO-8859-2',0
aCp28593	db 'CP28593',0
aIso88593	db 'ISO-8859-3',0
aCp28594	db 'CP28594',0
aIso88594	db 'ISO-8859-4',0
aCp28595	db 'CP28595',0
aIso88595	db 'ISO-8859-5',0
aCp28596	db 'CP28596',0
aIso88596	db 'ISO-8859-6',0
aCp28597	db 'CP28597',0
aIso88597	db 'ISO-8859-7',0
aCp28598	db 'CP28598',0
aIso88598	db 'ISO-8859-8',0
aCp28599	db 'CP28599',0
aIso88599	db 'ISO-8859-9',0
aCp28605	db 'CP28605',0
aIso885915	db 'ISO-8859-15',0
aCp65001	db 'CP65001',0
aUtf8_1		db 'UTF-8',0
		align 2
aIso		db 'iso',0              ; DATA XREF: sub_4127EF+13Co
a88591		db '8859-1',0           ; DATA XREF: sub_4127EF+179o
a646		db '646',0              ; DATA XREF: sub_4127EF+190o
aAscii		db 'ASCII',0            ; DATA XREF: sub_4127EF+1A7o
aAnsi_x3_41968	db 'ANSI_X3.4-1968',0   ; DATA XREF: sub_4127EF+1BEo
aUtf8_0		db 'utf8',0             ; DATA XREF: sub_4127EF:loc_4129E7o
		align 10h
; char aConversionFr_0[]
aConversionFr_0	db 'conversion from `%s',27h,' to `%s',27h,' failed: %s',0Ah,0
					; DATA XREF: sub_412B05+1EEo
					; sub_412D51+730o
; char aX02x_1[]
aX02x_1		db '\x%02x',0           ; DATA XREF: sub_412D51+7Co
					; sub_412D51+3AFo ...
; char aX02x_2[]
aX02x_2		db 'x%02x',0            ; DATA XREF: sub_412D51+1DCo
		align 4
a____Gnupg22__5	db '../../gnupg2-2.0.30/jnlib/utf8conv.c',0 ; DATA XREF: sub_412D51+6BEo
		align 10h
off_419220	dd offset loc_412F04	; DATA XREF: sub_412D51+12Ar
		dd offset loc_412F1A	; jump table for switch	statement
		dd offset loc_412F1A
		dd offset loc_412F1A
		dd offset loc_412F1A
		dd offset loc_412F1A
		dd offset loc_412F1A
		dd offset loc_412F1A
		dd offset loc_412EEE
		dd offset loc_412F1A
		dd offset loc_412E84
		dd offset loc_412ED8
		dd offset loc_412EBE
		dd offset loc_412EA1
aDo_utf8_to_nat	db 'do_utf8_to_native',0 ; DATA XREF: sub_412D51+6AEo
		align 4
aHkey_classes_r	db 'HKEY_CLASSES_ROOT',0 ; DATA XREF: sub_4135AC+1Fo
aHkey_current_u	db 'HKEY_CURRENT_USER',0 ; DATA XREF: sub_4135AC+53o
aHkey_local_mac	db 'HKEY_LOCAL_MACHINE',0 ; DATA XREF: sub_4135AC+87o
aHkey_users	db 'HKEY_USERS',0       ; DATA XREF: sub_4135AC+BBo
aHkey_performan	db 'HKEY_PERFORMANCE_DATA',0 ; DATA XREF: sub_4135AC+ECo
aHkey_current_c	db 'HKEY_CURRENT_CONFIG',0 ; DATA XREF: sub_4135AC+11Do
; CHAR LibFileName[]
LibFileName	db 'mingwm10.dll',0     ; DATA XREF: TlsCallback_0+4Eo
; CHAR a__mingwthr_rem[]
a__mingwthr_rem	db '__mingwthr_remove_key_dtor',0 ; DATA XREF: TlsCallback_0+71o
; CHAR a__mingwthr_key[]
a__mingwthr_key	db '__mingwthr_key_dtor',0 ; DATA XREF: TlsCallback_0+8Bo
off_419314	dd offset TlsCallback_0	; DATA XREF: sub_401180:loc_401273r
aUnknownError	db 'Unknown error',0    ; DATA XREF: sub_413F80+3o
		align 4
; char a_matherrSInSGG[]
a_matherrSInSGG	db '_matherr(): %s in %s(%g, %g)  (retval=%g)',0Ah,0
					; DATA XREF: sub_413F80+39o
		align 4
aArgumentDomain	db 'Argument domain error (DOMAIN)',0 ; DATA XREF: .rdata:off_419434o
aArgumentSingul	db 'Argument singularity (SIGN)',0 ; DATA XREF: .rdata:00419438o
		align 10h
aOverflowRangeE	db 'Overflow range error (OVERFLOW)',0 ; DATA XREF: .rdata:0041943Co
aTheResultIsToo	db 'The result is too small to be represented (UNDERFLOW)',0
					; DATA XREF: .rdata:00419440o
		align 4
aTotalLossOfSig	db 'Total loss of significance (TLOSS)',0 ; DATA XREF: .rdata:00419444o
		align 4
aPartialLossOfS	db 'Partial loss of significance (PLOSS)',0 ; DATA XREF: .rdata:00419448o
		align 4
off_419434	dd offset aArgumentDomain ; DATA XREF: sub_413F80+16r
					; "Argument domain error (DOMAIN)"
		dd offset aArgumentSingul ; "Argument singularity (SIGN)"
		dd offset aOverflowRangeE ; "Overflow range error (OVERFLOW)"
		dd offset aTheResultIsToo ; "The result	is too small to	be represent"...
		dd offset aTotalLossOfSig ; "Total loss	of significance	(TLOSS)"
		dd offset aPartialLossOfS ; "Partial loss of significance (PLOSS)"
aMingwW64Runtim	db 'Mingw-w64 runtime failure:',0Ah,0 ; DATA XREF: sub_413FF0+1Do
; char aAddressPHasNoI[]
aAddressPHasNoI	db 'Address %p has no image-section',0 ; DATA XREF: sub_414050+20Do
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: sub_414050+1F9o
					; sub_414050+225o ...
		align 4
; char aVirtualprotect[]
aVirtualprotect	db '  VirtualProtect failed with code 0x%x',0 ; DATA XREF: sub_414050+1D2o
		align 4
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_414290+299o
		align 4
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_414290+1B7o
		align 4
; const	WCHAR aMsvcrt_dll
aMsvcrt_dll:				; DATA XREF: sub_414840:loc_4148E0o
		unicode	0, <msvcrt.dll>,0
		align 4
off_41955C	dd offset dword_41A720	; DATA XREF: .text:00414AD8o
		dd offset dword_41A440
; char aAssertionFaile[]
aAssertionFaile	db 'Assertion failed!',0Ah ; DATA XREF: sub_415050+EAo
		db 0Ah
		db 'Program: %s',0Ah
		db 'File: %s, Line %u',0Ah
		db 0Ah
		db 'Expression: %s',0
; char aS_2[]
aS_2		db '%s',0Ah,0           ; DATA XREF: sub_415050+1C2o
; CHAR Caption[]
Caption		db 'MinGW Runtime Assertion',0 ; DATA XREF: sub_415050+10Fo
		align 4
dword_4195C4	dd 0			; DATA XREF: sub_414290+59o
					; sub_414290+5Eo ...
dword_4195C8	dd 0			; DATA XREF: sub_414290+7Fr
dword_4195CC	dd 0			; DATA XREF: sub_414290:loc_4143DCr
dword_4195D0	dd 0Ch dup(0)		; DATA XREF: sub_414290+155o
		align 1000h
_rdata		ends

; Section 4. (virtual address 0001A000)
; Virtual size			: 00000874 (   2164.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 41A000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_41A000	dd ?			; DATA XREF: sub_401180+D0w
					; sub_401180+27Dr
dword_41A004	dd ?			; DATA XREF: sub_401010+2Ao
					; sub_401180:loc_401344r ...
dword_41A008	dd ?			; DATA XREF: sub_401010+18o
					; sub_401180+1DEr ...
dword_41A00C	dd ?			; DATA XREF: sub_401010+10o
					; sub_401180+243r ...
dword_41A010	dd ?			; DATA XREF: sub_401180+272w
					; sub_401180+28Cr
dword_41A014	dd ?			; DATA XREF: sub_401060:loc_401098w
					; sub_401180+26Ar
dword_41A018	dd ?			; DATA XREF: sub_401010+8o
					; sub_401010+20w
dword_41A01C	dd ?			; DATA XREF: sub_401010+3Aw
dword_41A020	dd ?			; DATA XREF: sub_4019CB+4Dw
					; sub_4019CB+A5w ...
dword_41A024	dd ?			; DATA XREF: sub_4016C2+Ar
					; sub_4016C2:loc_401777r ...
dword_41A028	dd ?			; DATA XREF: sub_40210E:loc_402141r
					; sub_4024FA+8r ...
		align 20h
dword_41A040	dd ?			; DATA XREF: sub_4062FB+20r
					; sub_406435+Br ...
dword_41A044	dd ?			; DATA XREF: sub_4065C8+E4w
					; sub_40687F+Er
dword_41A048	dd ?			; DATA XREF: .text:loc_406BEBr
					; .text:00406C52w ...
dword_41A04C	dd ?			; DATA XREF: .text:loc_406C84r
					; .text:00406CEBw ...
dword_41A050	dd ?			; DATA XREF: .text:loc_406D1Dr
					; .text:00406D84w ...
dword_41A054	dd ?			; DATA XREF: .text:loc_406DB6r
					; .text:00406E1Dw ...
dword_41A058	dd ?			; DATA XREF: .text:loc_406E4Fr
					; .text:00406EB6w ...
dword_41A05C	dd ?			; DATA XREF: .text:loc_406EE8r
					; .text:00406F4Fw ...
dword_41A060	dd ?			; DATA XREF: .text:loc_406F81r
					; .text:00406FE8w ...
dword_41A064	dd ?			; DATA XREF: .text:loc_40701Ar
					; .text:00407081w ...
dword_41A068	dd ?			; DATA XREF: .text:loc_4070B3r
					; .text:0040711Aw ...
dword_41A06C	dd ?			; DATA XREF: .text:loc_40714Cr
					; .text:004071B3w ...
dword_41A070	dd ?			; DATA XREF: .text:00406ACCr
					; .text:00406B90w ...
dword_41A074	dd ?			; DATA XREF: sub_406A1E+8r
					; sub_406A1E+6Fw ...
dword_41A078	dd ?			; DATA XREF: .text:00406983r
					; .text:004069EAw ...
dword_41A07C	dd ?			; DATA XREF: .text:004068E0r
					; .text:00406947w ...
dword_41A080	dd ?			; DATA XREF: sub_40687F+17r
					; sub_40687F+3Bw ...
dword_41A084	dd ?			; DATA XREF: .text:004067E4r
					; .text:0040684Bw ...
dword_41A088	dd ?			; DATA XREF: sub_4066F5+Br
					; sub_4066F5+C1w ...
dword_41A08C	dd ?			; DATA XREF: sub_4065C8+8r
					; sub_4065C8:loc_406625w
		align 20h
; CHAR Str
Str		db ?			; DATA XREF: sub_4065C8+1Do
					; sub_4065C8+56w ...
		align 4
		dd 42h dup(?)
dword_41A1AC	dd ?			; DATA XREF: sub_406435:loc_406476r
					; sub_406435+A4w ...
; LPCSTR lpPathName
lpPathName	dd ?			; DATA XREF: sub_4062FB+Br
					; sub_4062FB+44w ...
dword_41A1B4	dd ?			; DATA XREF: sub_406221+6r
					; sub_406221+13w
dword_41A1B8	dd ?			; DATA XREF: sub_406221+63w
					; sub_406221+68r ...
		align 10h
dword_41A1C0	dd ?			; DATA XREF: sub_40727A+3Fr
					; sub_40727A+4Eo ...
dword_41A1C4	dd ?			; DATA XREF: sub_40727A+2Ar
					; sub_40727A+7Ar ...
dword_41A1C8	dd ?			; DATA XREF: .text:00409FE1w
					; .text:0040A0AFr
dword_41A1CC	dd ?			; DATA XREF: .text:0040A0EAr
dword_41A1D0	dd ?			; DATA XREF: .text:0040A11Fr
byte_41A1D4	db ?			; DATA XREF: .text:00409FCFo
					; .text:00409FEBo ...
byte_41A1D5	db ?			; DATA XREF: .text:0040A0DFr
byte_41A1D6	db ?			; DATA XREF: .text:loc_40A114r
		align 4
dword_41A1D8	dd ?			; DATA XREF: sub_407405+6r
					; sub_407405+Fw
dword_41A1DC	dd ?			; DATA XREF: sub_40D40E+232r
					; sub_40D40E+23Br ...
dword_41A1E0	dd ?			; DATA XREF: sub_40D6CE+7r
					; sub_40DD82+6w
		align 20h
; FILE *File
File		dd ?			; DATA XREF: sub_40DDC5+8r
					; sub_40DDC5+19r ...
		align 20h
; char Dest[79]
Dest		db 4Fh dup(?)		; DATA XREF: sub_40E074+1Bo
					; .text:loc_40E144o ...
byte_41A26F	db ?			; DATA XREF: sub_40E074+27w
dword_41A270	dd ?			; DATA XREF: sub_40E074+3Fw
					; .text:loc_40E0FCr ...
dword_41A274	dd ?			; DATA XREF: sub_40E074+34w
					; .text:0040E0E4r ...
dword_41A278	dd ?			; DATA XREF: sub_40E074+4Aw
					; .text:loc_40E114r ...
dword_41A27C	dd ?			; DATA XREF: .text:0040E06Dw
					; sub_40E1E6:loc_40E338r ...
dword_41A280	dd ?			; DATA XREF: sub_40E074+57w
					; .text:loc_40E12Cr
dword_41A284	dd ?			; DATA XREF: sub_40DDC5+249w
					; sub_40E1E6+88r ...
dword_41A288	dd ?			; DATA XREF: sub_40DDC5+24Ew
					; sub_40E1E6:loc_40E229r ...
dword_41A28C	dd ?			; DATA XREF: sub_40DD90+6r
					; sub_40DD90+14w ...
		align 20h
dword_41A2A0	dd ?			; DATA XREF: sub_4108F9+6r
					; sub_4108F9+Fr ...
		align 20h
; CHAR Buffer[256]
Buffer		db 100h	dup(?)		; DATA XREF: sub_411B0A+29o
					; sub_411B0A+56o
dword_41A3C0	dd ?			; DATA XREF: sub_4126F0+E3w
					; sub_4127EF+1DFw ...
dword_41A3C4	dd ?			; DATA XREF: sub_4126F0+EDw
					; sub_4127EF+1E9w ...
dword_41A3C8	dd ?			; DATA XREF: sub_412D51+70Er
					; sub_412D51:loc_4134A5w
dword_41A3CC	dd ?			; DATA XREF: sub_412B05+1CCr
					; sub_412B05:loc_412D17w
; char byte_41A3D0[32]
byte_41A3D0	db 20h dup(?)		; DATA XREF: sub_4127EF+3Bo
					; sub_4127EF+47o ...
dword_41A3F0	dd ?			; DATA XREF: sub_4126F0+45r
					; sub_4126F0+4Dw
dword_41A3F4	dd ?			; DATA XREF: sub_4126F0:loc_412749r
					; sub_4126F0+61w
dword_41A3F8	dd ?			; DATA XREF: sub_4126F0:loc_412785r
					; sub_4126F0:loc_4127B9w
dword_41A3FC	dd ?			; DATA XREF: sub_401010+3r
dword_41A400	dd ?			; DATA XREF: sub_401010+25r
dword_41A404	dd ?			; DATA XREF: sub_401060+22w
dword_41A408	dd ?			; DATA XREF: sub_401060+18w
dword_41A40C	dd ?			; DATA XREF: sub_401060+Ew
TlsIndex	dd ?			; DATA XREF: .tls:TlsIndex_ptro
; HMODULE hLibModule
hLibModule	dd ?			; DATA XREF: TlsCallback_0+60w
					; TlsCallback_0+83r ...
dword_41A418	dd ?			; DATA XREF: sub_401060+2Cw
dword_41A41C	dd ?			; DATA XREF: sub_401060+3Dr
					; sub_401180+61r ...
dword_41A420	dd ?			; DATA XREF: sub_401060+5Er
dword_41A424	dd ?			; DATA XREF: sub_401180+12Dw
					; TopLevelExceptionFilter:loc_413DFCr
dword_41A428	dd ?			; DATA XREF: .text:00413F23r
					; sub_413F70+4w
dword_41A42C	dd ?			; DATA XREF: sub_414290+9r
					; sub_414290:loc_4142B0w
dword_41A430	dd ?			; DATA XREF: sub_414050+1Dr
					; sub_414050+58r ...
dword_41A434	dd ?			; DATA XREF: sub_414050+Br
					; sub_414050:loc_41410Fw ...
dword_41A438	dd ?			; DATA XREF: sub_414840+4r
					; sub_414840+92w ...
dword_41A43C	dd ?			; DATA XREF: sub_414990r
					; sub_414990:loc_4149A0w
dword_41A440	dd 2Bh dup(?)		; DATA XREF: .rdata:00419560o
dword_41A4EC	dd ?			; DATA XREF: .text:00414ABAw
		dd 2 dup(?)
dword_41A4F8	dd ?			; DATA XREF: .text:00414AA6w
		dd 2 dup(?)
dword_41A504	dd ?			; DATA XREF: .text:00414A8Cw
		dd 86h dup(?)
dword_41A720	dd ?			; DATA XREF: .text:00414A92w
					; .rdata:off_41955Co
dword_41A724	dd ?			; DATA XREF: .text:00414A9Cw
		dd ?
dword_41A72C	dd ?			; DATA XREF: .text:00414AABw
		align 80h
dword_41A780	dd ?			; DATA XREF: .text:00414B83r
					; .text:00414C14r ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_414B10+7o
					; sub_414B10:loc_414B65o ...
dword_41A79C	dd ?			; DATA XREF: sub_414B10+14r
					; .text:00414BD8r ...
		dd ?
dword_41A7A4	dd ?			; DATA XREF: sub_401180+1A8w
dword_41A7A8	dd ?			; DATA XREF: sub_401180+1BFw
dword_41A7AC	dd ?			; DATA XREF: sub_401180+1B2w
		dd 5 dup(?)
dword_41A7C4	dd ?			; DATA XREF: sub_4019CB:loc_401A5Dr
					; sub_4019CB+9Aw
		dd 20h dup(?)
dword_41A848	dd ?			; DATA XREF: TlsCallback_0+A3w
					; TlsCallback_0:loc_413BE3w ...
dword_41A84C	dd ?			; DATA XREF: TlsCallback_0+7Ew
					; TlsCallback_0+AEr ...
dword_41A850	dd ?			; DATA XREF: TlsCallback_0:loc_413B34w
dword_41A854	dd ?			; DATA XREF: sub_401060+64w
					; sub_413CB0+3Fr ...
dword_41A858	dd ?			; DATA XREF: sub_401060+69w
					; sub_413CB0+4r ...
dword_41A85C	dd ?			; DATA XREF: sub_401180+A0o
					; sub_401180+ECw
dword_41A860	dd ?			; DATA XREF: sub_401180+B3r
					; sub_401180:loc_401243r ...
		align 800h
_bss		ends

;
; Imports from libgcrypt-20.dll
;
; Section 5. (virtual address 0001B000)
; Virtual size			: 00000FDC (   4060.)
; Section size in file		: 00001000 (   4096.)
; Offset to raw	data for section: 00017200
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
		extrn __imp_gcry_calloc:dword ;	DATA XREF: gcry_callocr
		extrn __imp_gcry_free:dword ; DATA XREF: gcry_freer
		extrn __imp_gcry_malloc:dword ;	DATA XREF: gcry_mallocr
		extrn __imp_gcry_malloc_secure:dword ; DATA XREF: gcry_malloc_securer
		extrn __imp_gcry_realloc:dword ; DATA XREF: gcry_reallocr
		extrn __imp_gcry_strdup:dword ;	DATA XREF: gcry_strdupr
		extrn __imp_gcry_xmalloc:dword ; DATA XREF: gcry_xmallocr
		extrn __imp_gcry_xstrdup:dword ; DATA XREF: gcry_xstrdupr

;
; Imports from libgpg-error-0.dll
;
		extrn __imp_gpg_err_code_from_errno:dword
					; DATA XREF: gpg_err_code_from_errnor
		extrn __imp_gpg_err_code_from_syserror:dword
					; DATA XREF: gpg_err_code_from_syserrorr
		extrn __imp_gpg_strerror:dword ; DATA XREF: gpg_strerrorr

;
; Imports from libiconv-2.dll
;
		extrn __imp_libiconv:dword ; DATA XREF:	libiconvr
		extrn __imp_libiconv_close:dword ; DATA	XREF: libiconv_closer
		extrn __imp_libiconv_open:dword	; DATA XREF: libiconv_openr

;
; Imports from ADVAPI32.dll
;
; LSTATUS __stdcall RegCloseKey(HKEY hKey)
		extrn RegCloseKey:dword	; CODE XREF: sub_413706+314p
					; DATA XREF: sub_413706+30Fr
; LSTATUS __stdcall RegOpenKeyExA(HKEY hKey, LPCSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY	phkResult)
		extrn RegOpenKeyExA:dword ; CODE XREF: sub_413706+55p
					; sub_413706+98p
					; DATA XREF: ...
; LSTATUS __stdcall RegQueryValueExA(HKEY hKey,	LPCSTR lpValueName, LPDWORD lpReserved,	LPDWORD	lpType,	LPBYTE lpData, LPDWORD lpcbData)
		extrn RegQueryValueExA:dword ; CODE XREF: sub_413706+E3p
					; sub_413706+140p
					; DATA XREF: ...

;
; Imports from KERNEL32.dll
;
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: sub_4061F7+17p
					; sub_40B503+1EDp
					; DATA XREF: ...
; BOOL __stdcall CreateDirectoryA(LPCSTR lpPathName, LPSECURITY_ATTRIBUTES lpSecurityAttributes)
		extrn CreateDirectoryA:dword ; CODE XREF: sub_4062FB+11Dp
					; sub_40B503+EDp
					; DATA XREF: ...
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
		extrn CreateFileA:dword	; CODE XREF: sub_40B503+1B6p
					; DATA XREF: sub_40B503+1B1r
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_414CB0+44p
					; DATA XREF: sub_414CB0+44r
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_414B10+Ep
					; .text:00414BD2p ...
; DWORD	__stdcall ExpandEnvironmentStringsA(LPCSTR lpSrc, LPSTR	lpDst, DWORD nSize)
		extrn ExpandEnvironmentStringsA:dword ;	CODE XREF: sub_413706+1CFp
					; sub_413706+235p
					; DATA XREF: ...
; DWORD	__stdcall FormatMessageA(DWORD dwFlags,	LPCVOID	lpSource, DWORD	dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments)
		extrn FormatMessageA:dword ; CODE XREF:	sub_411B0A+51p
					; DATA XREF: sub_411B0A+4Cr
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: TlsCallback_0+10Ap
					; DATA XREF: TlsCallback_0+10Ar
; UINT __stdcall GetACP()
		extrn GetACP:dword	; CODE XREF: sub_4127EF+26p
					; DATA XREF: sub_4127EF+21r
; UINT __stdcall GetConsoleOutputCP()
		extrn GetConsoleOutputCP:dword ; CODE XREF: sub_4127EF+16p
					; DATA XREF: sub_4127EF+11r
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: .text:00414AE8p
					; DATA XREF: .text:00414AE8r
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_40B503+Fp
					; sub_4149B0+6Cp
					; DATA XREF: ...
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_4149B0+74p
					; DATA XREF: sub_4149B0+74r
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_411B0A+11p
					; sub_414050+1CCp ...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename,	DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_4065C8+31p
					; sub_415050+C2p
					; DATA XREF: ...
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_4014F0+16p
					; sub_414840+87p
					; DATA XREF: ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_401180+142p
					; sub_4014F0+33p ...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: sub_401180+2F6p
					; DATA XREF: sub_401180+2F6r
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_4149B0+57p
					; DATA XREF: sub_4149B0+57r
; DWORD	__stdcall GetTempPathA(DWORD nBufferLength, LPSTR lpBuffer)
		extrn GetTempPathA:dword ; CODE	XREF: sub_40B503+2Ap
					; DATA XREF: sub_40B503+25r
; LCID __stdcall GetThreadLocale()
		extrn GetThreadLocale:dword ; CODE XREF: sub_40C244+7Fp
					; DATA XREF: sub_40C244:loc_40C2BEr
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_40B503+119p
					; sub_4149B0+7Cp
					; DATA XREF: ...
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_414CB0+87p
					; DATA XREF: sub_414CB0+87r
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_414B10+5Cp
					; .text:00414BF0p ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: sub_406194+11p
					; TlsCallback_0+55p
					; DATA XREF: ...
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: sub_414840+A7p
					; DATA XREF: sub_414840+A7r
; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
		extrn MultiByteToWideChar:dword	; CODE XREF: sub_40D1A5+38p
					; sub_40D1A5+D5p
					; DATA XREF: ...
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_4149B0+8Bp
					; DATA XREF: sub_4149B0+8Br
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_401180+124p
					; .text:00414ACFp
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_401180+8Fp
					; sub_40B503+20Ap
					; DATA XREF: ...
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: .text:00414AF9p
					; DATA XREF: .text:00414AF9r
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_414B10+35p
					; DATA XREF: sub_414B10+21r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:00414ADFp
					; DATA XREF: .text:00414ADFr
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_414050+142p
					; sub_414050+184p ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_414050+A1p
					; sub_414050+D9p ...
; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
		extrn WideCharToMultiByte:dword	; CODE XREF: sub_40D2A7+48p
					; sub_40D2A7+C8p
					; DATA XREF: ...

;
; Imports from msvcrt.dll
;
		extrn __imp__access:dword ; DATA XREF: _accessr
		extrn __imp__close:dword ; DATA	XREF: _closer
; FILE *__cdecl	_fdopen(int FileHandle,	const char *Format)
		extrn __imp__fdopen:dword ; DATA XREF: _fdopenr
; int __cdecl _fileno(FILE *File)
		extrn __imp__fileno:dword ; DATA XREF: _filenor
		extrn __imp__getpid:dword ; DATA XREF: _getpidr
		extrn __imp__open:dword	; DATA XREF: _openr
		extrn __imp__read:dword	; DATA XREF: _readr
		extrn __imp__setmode:dword ; DATA XREF:	_setmoder
		extrn __imp__write:dword ; DATA	XREF: _writer

;
; Imports from msvcrt.dll
;
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
		extrn __imp___getmainargs:dword	; DATA XREF: __getmainargsr
		extrn __initenv:dword	; DATA XREF: sub_401180+23Er
		extrn __lconv_init:dword ; DATA	XREF: sub_413C80r
		extrn __imp___set_app_type:dword ; DATA	XREF: __set_app_typer
		extrn __imp___setusermatherr:dword ; DATA XREF:	__setusermatherrr
		extrn _acmdln:dword	; DATA XREF: sub_401180+166r
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
		extrn __imp__cexit:dword ; DATA	XREF: _cexitr
; int *__cdecl errno()
		extrn _errno:dword	; CODE XREF: sub_401BD9+42p
					; sub_401BD9+59p ...
; void __cdecl __noreturn _exit(int Code)
		extrn __imp__exit:dword	; DATA XREF: _exitr
; int fmode
		extrn _fmode:dword	; DATA XREF: sub_401060+6Er
		extrn _fstati64:dword	; CODE XREF: sub_40CE6A+57p
					; DATA XREF: sub_40CE6A+52r
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn _iob:dword	; DATA XREF: .text:00405C58r
					; .text:0040A157r ...
		extrn __imp__lock:dword	; DATA XREF: _lockr
		extrn __imp__lseeki64:dword ; DATA XREF: _lseeki64r
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_413CB0+A3p
					; DATA XREF: sub_413CB0+A3r
		extrn _open_osfhandle:dword ; CODE XREF: sub_40B503+1D7p
					; DATA XREF: sub_40B503+1D2r
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
		extrn _winmajor:dword	; DATA XREF: TlsCallback_0+4r
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; int __cdecl atoi(const char *Str)
		extrn __imp_atoi:dword	; DATA XREF: atoir
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; void __cdecl __noreturn exit(int Code)
		extrn __imp_exit:dword	; DATA XREF: exitr
; int __cdecl fclose(FILE *File)
		extrn __imp_fclose:dword ; DATA	XREF: fcloser
; int __cdecl ferror(FILE *File)
		extrn __imp_ferror:dword ; DATA	XREF: ferrorr
; int __cdecl fflush(FILE *File)
		extrn __imp_fflush:dword ; DATA	XREF: fflushr
; FILE *__cdecl	fopen(const char *Filename, const char *Mode)
		extrn __imp_fopen:dword	; DATA XREF: fopenr
; int fprintf(FILE *File, const	char *Format, ...)
		extrn __imp_fprintf:dword ; DATA XREF: fprintfr
; int __cdecl fputs(const char *Str, FILE *File)
		extrn __imp_fputs:dword	; DATA XREF: fputsr
; size_t __cdecl fread(void *DstBuf, size_t ElementSize, size_t	Count, FILE *File)
		extrn __imp_fread:dword	; DATA XREF: freadr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; int __cdecl fseek(FILE *File,	__int32	Offset,	int Origin)
		extrn __imp_fseek:dword	; DATA XREF: fseekr
; __int32 __cdecl ftell(FILE *File)
		extrn __imp_ftell:dword	; DATA XREF: ftellr
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; int __cdecl getc(FILE	*File)
		extrn __imp_getc:dword	; DATA XREF: getcr
; char *__cdecl	getenv(const char *VarName)
		extrn __imp_getenv:dword ; DATA	XREF: getenvr
; int __cdecl isspace(int C)
		extrn isspace:dword	; CODE XREF: .text:00402EA4p
					; .text:004030B3p ...
; struct tm *__cdecl static localtime(const time_t *Time)
		extrn localtime:dword	; DATA XREF: sub_415340r
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; void *__cdecl	memchr(const void *Buf,	int Val, size_t	MaxCount)
		extrn __imp_memchr:dword ; DATA	XREF: memchrr
; int __cdecl memcmp(const void	*Buf1, const void *Buf2, size_t	Size)
		extrn __imp_memcmp:dword ; DATA	XREF: memcmpr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn __imp_memset:dword ; DATA	XREF: memsetr
; int printf(const char	*Format, ...)
		extrn __imp_printf:dword ; DATA	XREF: printfr
; int __cdecl putc(int Ch, FILE	*File)
		extrn __imp_putc:dword	; DATA XREF: putcr
; int __cdecl putchar(int Ch)
		extrn __imp_putchar:dword ; DATA XREF: putcharr
; int __cdecl puts(const char *Str)
		extrn __imp_puts:dword	; DATA XREF: putsr
		extrn __imp_raise:dword	; DATA XREF: raiser
; void *__cdecl	realloc(void *Memory, size_t NewSize)
		extrn __imp_realloc:dword ; DATA XREF: reallocr
		extrn __imp_setlocale:dword ; DATA XREF: setlocaler
; int __cdecl setvbuf(FILE *File, char *Buf, int Mode, size_t Size)
		extrn __imp_setvbuf:dword ; DATA XREF: setvbufr
		extrn __imp_signal:dword ; DATA	XREF: signalr
; int sprintf(char *Dest, const	char *Format, ...)
		extrn __imp_sprintf:dword ; DATA XREF: sprintfr
; char *__cdecl	strchr(const char *Str,	int Val)
		extrn __imp_strchr:dword ; DATA	XREF: strchrr
; int __cdecl strcmp(const char	*Str1, const char *Str2)
		extrn __imp_strcmp:dword ; DATA	XREF: strcmpr
; char *__cdecl	strcpy(char *Dest, const char *Source)
		extrn __imp_strcpy:dword ; DATA	XREF: strcpyr
; char *__cdecl	strerror(int)
		extrn __imp_strerror:dword ; DATA XREF:	strerrorr
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; char *__cdecl	strncpy(char *Dest, const char *Source,	size_t Count)
		extrn __imp_strncpy:dword ; DATA XREF: strncpyr
; char *__cdecl	strpbrk(const char *Str, const char *Control)
		extrn __imp_strpbrk:dword ; DATA XREF: strpbrkr
; char *__cdecl	strrchr(const char *Str, int Ch)
		extrn __imp_strrchr:dword ; DATA XREF: strrchrr
; char *__cdecl	strstr(const char *Str,	const char *SubStr)
		extrn __imp_strstr:dword ; DATA	XREF: strstrr
; __int32 __cdecl strtol(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtol:dword ; DATA	XREF: strtolr
; unsigned __int32 __cdecl strtoul(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtoul:dword ; DATA XREF: strtoulr
; time_t __cdecl static	time(time_t *Time)
		extrn time:dword	; DATA XREF: sub_415330r
; int __cdecl toupper(int C)
		extrn toupper:dword	; CODE XREF: .text:00410A0Dp
					; .text:00410A22p ...
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr

;
; Imports from USER32.dll
;
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn MessageBoxA:dword	; CODE XREF: sub_415050+122p
					; DATA XREF: sub_415050+122r

;
; Imports from WS2_32.dll
;
; int __stdcall	WSAGetLastError()
		extrn WSAGetLastError:dword ; CODE XREF: .text:0041259Ep
					; DATA XREF: .text:00412599r
; int __stdcall	WSAStartup(WORD	wVersionRequested, LPWSADATA lpWSAData)
		extrn WSAStartup:dword	; CODE XREF: sub_40615C+2Bp
					; DATA XREF: sub_40615C+26r
; int __stdcall	closesocket(SOCKET s)
		extrn closesocket:dword	; CODE XREF: .text:0041258Bp
					; DATA XREF: .text:00412586r
; int __stdcall	connect(SOCKET s, const	struct sockaddr	*name, int namelen)
		extrn connect:dword	; CODE XREF: sub_4125F3+A0p
					; DATA XREF: sub_4125F3+9Br
; u_long __stdcall htonl(u_long	hostlong)
		extrn htonl:dword	; CODE XREF: sub_4125F3+60p
					; DATA XREF: sub_4125F3+5Br
; u_short __stdcall htons(u_short hostshort)
		extrn htons:dword	; CODE XREF: sub_4125F3+4Bp
					; DATA XREF: sub_4125F3+46r
; int __stdcall	recv(SOCKET s, char *buf, int len, int flags)
		extrn recv:dword	; CODE XREF: sub_401C6E+39p
					; DATA XREF: sub_401C6E+34r
; int __stdcall	send(SOCKET s, const char *buf,	int len, int flags)
		extrn send:dword	; CODE XREF: sub_401BD9+2Fp
					; sub_4125F3+D0p
					; DATA XREF: ...
; SOCKET __stdcall socket(int af, int type, int	protocol)
		extrn socket:dword	; CODE XREF: sub_4125BA+32p
					; DATA XREF: sub_4125BA+2Dr


; Section 6. (virtual address 0001C000)
; Virtual size			: 00000034 (	 52.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00018200
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 41C000h
dword_41C000	dd 0			; DATA XREF: sub_401180+2D8o
		dd offset sub_401010
dword_41C008	dd 0			; DATA XREF: sub_401180:loc_401450o
dword_41C00C	dd 0			; DATA XREF: sub_401180+316o
		dd offset sub_401060
		dd offset sub_413C80
dword_41C018	dd 2 dup(0)		; DATA XREF: sub_401180+30Eo
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
		dd offset TlsCallback_1
		dd 0
		align 10h
dword_41C030	dd 74h dup(0)		; DATA XREF: TlsCallback_0:loc_413C23o
					; TlsCallback_0+138o ...
		align 1000h
_CRT		ends

; Section 7. (virtual address 0001D000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00018400
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 41D000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end start
