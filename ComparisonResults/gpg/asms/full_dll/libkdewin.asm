;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	6EBEA25A0E1FF725F5712AE487794B1A
; Input	CRC32 :	3B50EF9A

; File Name   :	C:\compspace\compare\gpg\dlls\full\libkdewin.dll
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	679C0000
; Section 1. (virtual address 00001000)
; Virtual size			: 00006924 (  26916.)
; Section size in file		: 00006A00 (  27136.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 679C1000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


sub_679C1000	proc near		; DATA XREF: .CRT:679CD00Co

Size		= dword	ptr -1Ch

		push	ebx
		sub	esp, 18h
		mov	[esp+1Ch+Size],	80h ; Size
		call	malloc
		mov	ebx, eax
		mov	[esp+1Ch+Size],	eax
		call	sub_679C6990
		test	ebx, ebx
		mov	ds:dword_679CA4C4, eax
		mov	ds:dword_679CA4C0, eax
		mov	eax, 1
		jz	short loc_679C1035
		mov	dword ptr [ebx], 0
		xor	al, al

loc_679C1035:				; CODE XREF: sub_679C1000+2Bj
		add	esp, 18h
		pop	ebx
		retn
sub_679C1000	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_679C1040	proc near		; CODE XREF: sub_679C1260+DAp
					; sub_679C1260+128p ...

dwMilliseconds	= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		push	ebx
		sub	esp, 14h
		mov	edx, [esp+1Ch+arg_4]
		test	edx, edx
		jnz	short loc_679C10C6
		mov	edx, ds:dword_679CA000
		xor	eax, eax
		test	edx, edx
		jle	short loc_679C10BE
		sub	edx, 1
		mov	ebx, ds:Sleep
		mov	ds:dword_679CA000, edx
		jmp	short loc_679C107C
; ---------------------------------------------------------------------------
		align 10h

loc_679C1070:				; CODE XREF: sub_679C1040+5Dj
		mov	[esp+1Ch+dwMilliseconds], 3E8h ; dwMilliseconds
		call	ebx ; Sleep
		sub	esp, 4

loc_679C107C:				; CODE XREF: sub_679C1040+28j
		mov	[esp+1Ch+var_14], 0
		mov	[esp+1Ch+var_18], 1
		mov	[esp+1Ch+dwMilliseconds], offset dword_679CA4C8
		call	sub_679C7760
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_679C1070
		mov	eax, ds:dword_679CA4CC
		cmp	eax, 2
		jz	loc_679C1170
		mov	[esp+1Ch+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, 1

loc_679C10BE:				; CODE XREF: sub_679C1040+17j
					; sub_679C1040+8Ej
		add	esp, 14h
		pop	ebx
		pop	esi
		retn	0Ch
; ---------------------------------------------------------------------------

loc_679C10C6:				; CODE XREF: sub_679C1040+Bj
		cmp	edx, 1
		mov	eax, 1
		jnz	short loc_679C10BE
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_679C10F5
; ---------------------------------------------------------------------------

loc_679C10E1:				; CODE XREF: sub_679C1040+D2j
		cmp	eax, ebx
		jz	loc_679C1238
		mov	[esp+1Ch+dwMilliseconds], 3E8h ; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_679C10F5:				; CODE XREF: sub_679C1040+9Fj
		mov	[esp+1Ch+var_14], 0
		mov	[esp+1Ch+var_18], ebx
		mov	[esp+1Ch+dwMilliseconds], offset dword_679CA4C8
		call	sub_679C7760
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_679C10E1
		xor	ebx, ebx

loc_679C1116:				; CODE XREF: sub_679C1040+1FDj
		mov	eax, ds:dword_679CA4CC
		test	eax, eax
		jz	loc_679C11F7
		mov	[esp+1Ch+dwMilliseconds], 1Fh
		call	_amsg_exit

loc_679C112F:				; CODE XREF: sub_679C1040+1F3j
		test	ebx, ebx
		jz	loc_679C1242

loc_679C1137:				; CODE XREF: sub_679C1040+219j
		mov	eax, ds:off_679C9A00
		test	eax, eax
		jz	short loc_679C115C
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], 2
		mov	[esp+1Ch+var_14], edx
		mov	edx, [esp+1Ch+arg_0]
		mov	[esp+1Ch+dwMilliseconds], edx
		call	eax ; TlsCallback_0
		sub	esp, 0Ch

loc_679C115C:				; CODE XREF: sub_679C1040+FEj
		add	ds:dword_679CA000, 1
		mov	eax, 1
		add	esp, 14h
		pop	ebx
		pop	esi
		retn	0Ch
; ---------------------------------------------------------------------------

loc_679C1170:				; CODE XREF: sub_679C1040+67j
		mov	eax, ds:dword_679CA4C4
		mov	[esp+1Ch+dwMilliseconds], eax
		call	sub_679C6980
		test	eax, eax
		mov	ebx, eax
		jz	short loc_679C11C9
		mov	eax, ds:dword_679CA4C0
		mov	[esp+1Ch+dwMilliseconds], eax
		call	sub_679C6980
		mov	esi, eax

loc_679C1192:				; CODE XREF: sub_679C1040+15Dj
		sub	esi, 4
		cmp	ebx, esi
		ja	short loc_679C11A8

loc_679C1199:				; CODE XREF: sub_679C1040+166j
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_679C1192
		sub	esi, 4
		call	eax
		cmp	ebx, esi
		jbe	short loc_679C1199

loc_679C11A8:				; CODE XREF: sub_679C1040+157j
		mov	[esp+1Ch+dwMilliseconds], ebx ;	Memory
		nop
		lea	esi, [esi+0]
		call	free
		mov	ds:dword_679CA4C0, 0
		mov	ds:dword_679CA4C4, 0

loc_679C11C9:				; CODE XREF: sub_679C1040+141j
		mov	ds:dword_679CA4CC, 0
		mov	[esp+1Ch+var_18], 0
		mov	[esp+1Ch+dwMilliseconds], offset dword_679CA4C8
		call	sub_679C7790
		mov	eax, 1
		sub	esp, 8
		add	esp, 14h
		pop	ebx
		pop	esi
		retn	0Ch
; ---------------------------------------------------------------------------

loc_679C11F7:				; CODE XREF: sub_679C1040+DDj
		mov	ds:dword_679CA4CC, 1
		mov	[esp+1Ch+var_18], offset dword_679CD010
		mov	[esp+1Ch+dwMilliseconds], offset dword_679CD008
		call	_initterm
		mov	[esp+1Ch+var_18], offset dword_679CD004
		mov	[esp+1Ch+dwMilliseconds], offset dword_679CD000
		call	_initterm
		mov	ds:dword_679CA4CC, 2
		jmp	loc_679C112F
; ---------------------------------------------------------------------------

loc_679C1238:				; CODE XREF: sub_679C1040+A3j
		mov	ebx, 1
		jmp	loc_679C1116
; ---------------------------------------------------------------------------

loc_679C1242:				; CODE XREF: sub_679C1040+F1j
		mov	[esp+1Ch+var_18], 0
		mov	[esp+1Ch+dwMilliseconds], offset dword_679CA4C8
		call	sub_679C7790
		sub	esp, 8
		jmp	loc_679C1137
sub_679C1040	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_679C1260	proc near		; CODE XREF: DllEntryPoint+1Ep

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 2Ch
		test	edx, edx
		mov	[esp+2Ch+var_10], ebx
		mov	ebx, eax
		mov	[esp+2Ch+var_C], esi
		mov	esi, edx
		mov	[esp+2Ch+var_4], ebp
		mov	ebp, ecx
		mov	[esp+2Ch+var_8], edi
		mov	dword_679C8040,	edx
		jnz	short loc_679C12E0
		mov	eax, ds:dword_679CA000
		test	eax, eax
		jz	loc_679C13B7
		call	sub_679C6B50

loc_679C1295:				; CODE XREF: sub_679C1260+90j
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], esi
		mov	[esp+2Ch+var_2C], ebx
		call	sub_679C6E80
		sub	esp, 0Ch
		cmp	esi, 3
		mov	edi, eax
		jz	loc_679C13A0
		test	esi, esi
		jz	loc_679C13A0

loc_679C12BB:				; CODE XREF: sub_679C1260+B2j
					; sub_679C1260+F9j ...
		mov	eax, edi
		mov	ebx, [esp+2Ch+var_10]
		mov	dword_679C8040,	0FFFFFFFFh
		mov	esi, [esp+2Ch+var_C]
		mov	edi, [esp+2Ch+var_8]
		mov	ebp, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C12E0:				; CODE XREF: sub_679C1260+21j
		lea	eax, [edx-1]
		cmp	eax, 1
		jbe	short loc_679C1360

loc_679C12E8:				; CODE XREF: sub_679C1260+134j
		call	sub_679C6B50
		cmp	esi, 1
		jnz	short loc_679C1295
		call	sub_679C6E60
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], ebx
		call	sub_679C6E80
		sub	esp, 0Ch
		test	eax, eax
		mov	edi, eax
		jnz	short loc_679C12BB
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], ebx
		call	sub_679C6E80
		sub	esp, 0Ch
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], ebx
		call	sub_679C1040
		sub	esp, 0Ch
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], ebx
		call	sub_679C6E90
		sub	esp, 0Ch
		jmp	loc_679C12BB
; ---------------------------------------------------------------------------
		align 10h

loc_679C1360:				; CODE XREF: sub_679C1260+86j
		mov	[esp+2Ch+var_24], ecx
		mov	[esp+2Ch+var_28], edx
		mov	[esp+2Ch+var_2C], ebx
		call	sub_679C6E90
		sub	esp, 0Ch
		test	eax, eax
		mov	edi, eax
		jz	loc_679C12BB
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], esi
		mov	[esp+2Ch+var_2C], ebx
		call	sub_679C1040
		sub	esp, 0Ch
		test	eax, eax
		mov	edi, eax
		jnz	loc_679C12E8
		jmp	loc_679C12BB
; ---------------------------------------------------------------------------
		align 10h

loc_679C13A0:				; CODE XREF: sub_679C1260+4Dj
					; sub_679C1260+55j
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], esi
		mov	[esp+2Ch+var_2C], ebx
		call	sub_679C1040
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_679C13C0

loc_679C13B7:				; CODE XREF: sub_679C1260+2Aj
		xor	edi, edi
		jmp	loc_679C12BB
; ---------------------------------------------------------------------------
		align 10h

loc_679C13C0:				; CODE XREF: sub_679C1260+155j
		test	edi, edi
		jz	loc_679C12BB
		mov	[esp+2Ch+var_24], ebp
		mov	[esp+2Ch+var_28], esi
		mov	[esp+2Ch+var_2C], ebx
		call	sub_679C6E90
		sub	esp, 0Ch
		mov	edi, eax
		jmp	loc_679C12BB
sub_679C1260	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; BOOL __stdcall DllEntryPoint(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved)
		public DllEntryPoint
DllEntryPoint	proc near

var_10		= dword	ptr -10h
hinstDLL	= dword	ptr  4
fdwReason	= dword	ptr  8
lpReserved	= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	edx, [esp+1Ch+fdwReason]
		mov	ds:dword_679CA024, 0
		cmp	edx, 1
		jz	short loc_679C1420

loc_679C1406:				; CODE XREF: DllEntryPoint+3Dj
		mov	ecx, [esp+1Ch+lpReserved]
		mov	eax, [esp+1Ch+hinstDLL]
		call	sub_679C1260
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_679C1420:				; CODE XREF: DllEntryPoint+14j
		mov	[esp+1Ch+var_10], edx
		call	sub_679C6F30
		mov	edx, [esp+1Ch+var_10]
		jmp	short loc_679C1406
DllEntryPoint	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_679C1430	proc near		; CODE XREF: sub_679C78F0+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_679C8058
		test	eax, eax
		jz	short locret_679C147B
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj_s.dll"
		call	ds:GetModuleHandleA
		mov	edx, eax
		sub	esp, 4
		test	edx, edx
		mov	eax, 0
		jz	short loc_679C146E
		mov	[esp+18h+lpProcName], offset ProcName ;	"_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	edx ; hModule
		call	ds:GetProcAddress
		sub	esp, 8

loc_679C146E:				; CODE XREF: sub_679C1430+28j
		test	eax, eax
		jz	short locret_679C147B
		mov	[esp+18h+lpModuleName],	offset dword_679C8058
		call	eax

locret_679C147B:			; CODE XREF: sub_679C1430+Dj
					; sub_679C1430+40j
		leave
		retn
sub_679C1430	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_679C1480()
sub_679C1480	proc near		; DATA XREF: sub_679C78F0+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_679C1480	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  42. kde_inet_ntop

; =============== S U B	R O U T	I N E =======================================


; int __cdecl kde_inet_ntop(int, int, char *, int)
		public kde_inet_ntop
kde_inet_ntop	proc near		; CODE XREF: inet_ntop+6j

Dest		= dword	ptr -0ACh
Format		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
Source		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7A		= byte ptr -7Ah
var_79		= byte ptr -79h
var_78		= byte ptr -78h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= byte ptr -2Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0ACh
		mov	eax, [esp+0ACh+arg_0]
		mov	[esp+0ACh+var_C], esi
		mov	esi, [esp+0ACh+arg_4]
		mov	[esp+0ACh+var_8], edi
		mov	edi, [esp+0ACh+arg_8]
		mov	[esp+0ACh+var_10], ebx
		cmp	eax, 2
		mov	[esp+0ACh+var_4], ebp
		jz	loc_679C1821
		cmp	eax, 17h
		jz	short loc_679C1508
		call	ds:_errno
		mov	dword ptr [eax], 6Ah

loc_679C14E1:				; CODE XREF: kde_inet_ntop+A95j
		xor	edi, edi

loc_679C14E3:				; CODE XREF: kde_inet_ntop+38Cj
					; kde_inet_ntop+3DCj ...
		mov	eax, edi
		mov	ebx, [esp+0ACh+var_10]
		mov	esi, [esp+0ACh+var_C]
		mov	edi, [esp+0ACh+var_8]
		mov	ebp, [esp+0ACh+var_4]
		add	esp, 0ACh
		retn
; ---------------------------------------------------------------------------

loc_679C1508:				; CODE XREF: kde_inet_ntop+43j
		lea	edx, [esp+0ACh+var_4C]
		xor	eax, eax

loc_679C150E:				; CODE XREF: kde_inet_ntop+8Bj
		mov	dword ptr [edx+eax], 0
		add	eax, 4
		cmp	eax, 20h
		jb	short loc_679C150E
		movzx	eax, byte ptr [esi]
		mov	edx, [esp+0ACh+var_4C]
		shl	eax, 8
		or	eax, edx
		mov	[esp+0ACh+Source], eax
		movzx	eax, byte ptr [esi+1]
		or	[esp+0ACh+Source], eax
		mov	eax, [esp+0ACh+Source]
		mov	[esp+0ACh+var_4C], eax
		movzx	eax, byte ptr [esi+2]
		movzx	edx, byte ptr [esi+3]
		shl	eax, 8
		or	eax, [esp+0ACh+var_48]
		or	edx, eax
		mov	[esp+0ACh+var_48], edx
		movzx	eax, byte ptr [esi+4]
		movzx	edx, byte ptr [esi+5]
		shl	eax, 8
		or	eax, [esp+0ACh+var_44]
		or	eax, edx
		mov	[esp+0ACh+var_44], eax
		movzx	eax, byte ptr [esi+6]
		movzx	edx, byte ptr [esi+7]
		shl	eax, 8
		or	eax, [esp+0ACh+var_40]
		or	eax, edx
		mov	[esp+0ACh+var_40], eax
		movzx	eax, byte ptr [esi+8]
		movzx	edx, byte ptr [esi+9]
		shl	eax, 8
		or	eax, [esp+0ACh+var_3C]
		or	edx, eax
		mov	[esp+0ACh+var_3C], edx
		movzx	eax, byte ptr [esi+0Ah]
		movzx	edx, byte ptr [esi+0Bh]
		shl	eax, 8
		or	eax, [esp+0ACh+var_38]
		or	edx, eax
		mov	[esp+0ACh+var_38], edx
		lea	edx, [esi+0Ch]
		mov	[esp+0ACh+var_80], edx
		movzx	eax, byte ptr [esi+0Ch]
		movzx	edx, byte ptr [esi+0Dh]
		shl	eax, 8
		or	eax, [esp+0ACh+var_34]
		or	edx, eax
		mov	[esp+0ACh+var_34], edx
		movzx	eax, byte ptr [esi+0Eh]
		movzx	edx, byte ptr [esi+0Fh]
		shl	eax, 8
		or	eax, [esp+0ACh+var_30]
		or	edx, eax
		mov	[esp+0ACh+var_84], edx
		mov	eax, [esp+0ACh+var_48]
		cmp	[esp+0ACh+Source], 1
		mov	[esp+0ACh+var_30], edx
		sbb	ebx, ebx
		cmp	[esp+0ACh+Source], 1
		not	ebx
		sbb	ecx, ecx
		and	ecx, 1
		test	eax, eax
		jz	loc_679C1940
		cmp	ebx, 0FFFFFFFFh
		jz	loc_679C1B10
		mov	edx, ecx
		mov	ebx, 0FFFFFFFFh
		xor	eax, eax
		lea	esi, [esi+0]

loc_679C1610:				; CODE XREF: kde_inet_ntop+4C5j
					; kde_inet_ntop+689j ...
		mov	ebp, [esp+0ACh+var_44]
		test	ebp, ebp
		jz	loc_679C1900
		cmp	ebx, 0FFFFFFFFh
		jz	loc_679C1AE6
		cmp	eax, 0FFFFFFFFh
		mov	ebp, edx
		jz	short loc_679C1639
		cmp	edx, ecx
		mov	eax, 0FFFFFFFFh
		jg	short loc_679C1639
		mov	edx, ecx
		xor	ebx, ebx

loc_679C1639:				; CODE XREF: kde_inet_ntop+19Aj
					; kde_inet_ntop+1A3j ...
		mov	ecx, [esp+0ACh+var_40]
		test	ecx, ecx
		jz	loc_679C1920

loc_679C1645:				; CODE XREF: kde_inet_ntop+48Aj
		cmp	eax, 0FFFFFFFFh
		jz	loc_679C1AC3
		cmp	ebx, 0FFFFFFFFh
		mov	ecx, ebp
		jz	short loc_679C1664
		cmp	ebp, edx
		jg	short loc_679C165F
		mov	ecx, ebp
		mov	eax, ebx
		mov	ebp, edx

loc_679C165F:				; CODE XREF: kde_inet_ntop+1C7j
		mov	ebx, 0FFFFFFFFh

loc_679C1664:				; CODE XREF: kde_inet_ntop+1C3j
					; kde_inet_ntop+4A4j ...
		mov	edx, [esp+0ACh+var_3C]
		test	edx, edx
		jz	loc_679C18E0
		cmp	ebx, 0FFFFFFFFh
		jz	loc_679C1AA0
		cmp	eax, 0FFFFFFFFh
		mov	edx, ecx
		jz	short loc_679C168F
		cmp	ecx, ebp
		jg	short loc_679C168A
		mov	edx, ecx
		mov	ebx, eax
		mov	ecx, ebp

loc_679C168A:				; CODE XREF: kde_inet_ntop+1F2j
		mov	eax, 0FFFFFFFFh

loc_679C168F:				; CODE XREF: kde_inet_ntop+1EEj
					; kde_inet_ntop+464j ...
		mov	ebp, [esp+0ACh+var_38]
		test	ebp, ebp
		jz	loc_679C18C0
		cmp	eax, 0FFFFFFFFh
		jz	loc_679C1C70
		cmp	ebx, 0FFFFFFFFh
		mov	ebp, edx
		jz	short loc_679C16BD
		cmp	edx, ecx
		lea	esi, [esi+0]
		jg	short loc_679C16B8
		mov	ebp, edx
		mov	eax, ebx
		mov	edx, ecx

loc_679C16B8:				; CODE XREF: kde_inet_ntop+220j
		mov	ebx, 0FFFFFFFFh

loc_679C16BD:				; CODE XREF: kde_inet_ntop+219j
					; kde_inet_ntop+444j ...
		mov	ecx, [esp+0ACh+var_34]
		test	ecx, ecx
		jz	loc_679C18A5
		cmp	ebx, 0FFFFFFFFh
		jz	loc_679C1C48
		cmp	eax, 0FFFFFFFFh
		mov	ecx, ebp
		jz	short loc_679C16E8
		cmp	ebp, edx
		jg	short loc_679C16E3
		mov	ecx, ebp
		mov	ebx, eax
		mov	ebp, edx

loc_679C16E3:				; CODE XREF: kde_inet_ntop+24Bj
		mov	eax, 0FFFFFFFFh

loc_679C16E8:				; CODE XREF: kde_inet_ntop+247j
					; kde_inet_ntop+429j ...
		mov	edx, [esp+0ACh+var_84]
		test	edx, edx
		jnz	loc_679C1885
		cmp	eax, 0FFFFFFFFh
		jz	loc_679C1A90
		add	ecx, 1

loc_679C1700:				; CODE XREF: kde_inet_ntop+60Aj
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_679C170D
		cmp	ecx, ebp
		jg	short loc_679C170D
		mov	eax, ebx
		mov	ecx, ebp

loc_679C170D:				; CODE XREF: kde_inet_ntop+273j
					; kde_inet_ntop+277j
		mov	ebp, ecx
		mov	ebx, eax

loc_679C1711:				; CODE XREF: kde_inet_ntop+405j
					; kde_inet_ntop+410j ...
		cmp	ebp, 1
		jle	loc_679C1B3C
		cmp	ebx, 0FFFFFFFFh
		jz	loc_679C1B3C
		test	ebx, ebx
		jz	loc_679C1960
		cmp	ebp, 5
		xchg	ax, ax
		jz	loc_679C1D50
		mov	eax, [esp+0ACh+Source]
		lea	edx, [esp+0ACh+var_7A]
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+Source], edx
		mov	[esp+0ACh+Dest], edx ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		add	eax, [esp+0ACh+Source]
		cmp	ebx, 1
		jnz	loc_679C1DC0
		test	ebp, ebp
		jle	loc_679C1DC0
		mov	byte ptr [eax],	3Ah
		add	eax, 1

loc_679C1771:				; CODE XREF: kde_inet_ntop+957j
		lea	esi, [ebx+ebp]
		cmp	esi, 2
		jle	loc_679C1DED
		cmp	ebx, 2
		jz	loc_679C209B

loc_679C1786:				; CODE XREF: kde_inet_ntop+982j
					; kde_inet_ntop+C11j
		cmp	esi, 3
		jle	loc_679C1E18
		cmp	ebx, 3
		jz	loc_679C20A6

loc_679C1798:				; CODE XREF: kde_inet_ntop+9ADj
					; kde_inet_ntop+C1Cj
		cmp	esi, 4
		nop
		lea	esi, [esi+0]
		jle	loc_679C1E43
		cmp	ebx, 4
		jz	loc_679C2085

loc_679C17AF:				; CODE XREF: kde_inet_ntop+9D8j
					; kde_inet_ntop+BFBj
		cmp	esi, 5
		jle	loc_679C1E6E
		cmp	ebx, 5
		nop
		lea	esi, [esi+0]
		jz	loc_679C2090

loc_679C17C6:				; CODE XREF: kde_inet_ntop+A03j
					; kde_inet_ntop+C06j
		cmp	esi, 6
		jle	loc_679C1E99
		cmp	ebx, 6
		jz	loc_679C2079

loc_679C17D8:				; CODE XREF: kde_inet_ntop+A2Bj
					; kde_inet_ntop+BF0j
		cmp	esi, 7
		nop
		lea	esi, [esi+0]
		jle	loc_679C1A5D
		cmp	ebx, 7
		jz	loc_679C20B1
		nop

loc_679C17F0:				; CODE XREF: kde_inet_ntop+5C7j
					; kde_inet_ntop+5EEj ...
		cmp	esi, 8
		jz	loc_679C1A83

loc_679C17F9:				; CODE XREF: kde_inet_ntop+5F9j
					; kde_inet_ntop+7B3j ...
		mov	byte ptr [eax],	0
		add	eax, 1
		sub	eax, [esp+0ACh+Source]
		cmp	[esp+0ACh+arg_C], eax
		jb	short loc_679C1871
		mov	eax, [esp+0ACh+Source]
		mov	[esp+0ACh+Dest], edi ; Dest
		mov	[esp+0ACh+Format], eax ; Source
		call	strcpy
		jmp	loc_679C14E3
; ---------------------------------------------------------------------------

loc_679C1821:				; CODE XREF: kde_inet_ntop+3Aj
		movzx	eax, byte ptr [esi+3]
		lea	ebx, [esp+0ACh+var_2C]
		mov	[esp+0ACh+var_98], eax
		movzx	eax, byte ptr [esi+2]
		mov	[esp+0ACh+var_9C], eax
		movzx	eax, byte ptr [esi+1]
		mov	[esp+0ACh+var_A0], eax
		movzx	eax, byte ptr [esi]
		mov	[esp+0ACh+Format], offset aU_U_U_U ; "%u.%u.%u.%u"
		mov	[esp+0ACh+Dest], ebx ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		cmp	[esp+0ACh+arg_C], eax
		jbe	short loc_679C1871
		mov	[esp+0ACh+Format], ebx ; Source
		mov	[esp+0ACh+Dest], edi ; Dest
		call	strcpy
		jmp	loc_679C14E3
; ---------------------------------------------------------------------------

loc_679C1871:				; CODE XREF: kde_inet_ntop+37Aj
					; kde_inet_ntop+3CEj ...
		call	ds:_errno
		xor	edi, edi
		mov	dword ptr [eax], 1Ch
		nop
		jmp	loc_679C14E3
; ---------------------------------------------------------------------------

loc_679C1885:				; CODE XREF: kde_inet_ntop+25Ej
		cmp	eax, 0FFFFFFFFh
		jz	loc_679C1B33
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_679C189B
		cmp	ecx, ebp
		jle	loc_679C1711

loc_679C189B:				; CODE XREF: kde_inet_ntop+401j
		mov	ebx, eax
		mov	ebp, ecx
		nop
		jmp	loc_679C1711
; ---------------------------------------------------------------------------

loc_679C18A5:				; CODE XREF: kde_inet_ntop+233j
		cmp	ebx, 0FFFFFFFFh
		jz	loc_679C1C80
		lea	ecx, [ebp+1]
		mov	ebp, ebx
		mov	ebx, eax
		mov	eax, ebp
		mov	ebp, edx
		jmp	loc_679C16E8
; ---------------------------------------------------------------------------
		align 10h

loc_679C18C0:				; CODE XREF: kde_inet_ntop+205j
		cmp	eax, 0FFFFFFFFh
		jz	loc_679C1AB0
		lea	ebp, [edx+1]
		mov	edx, eax
		mov	eax, ebx
		mov	ebx, edx
		mov	edx, ecx
		jmp	loc_679C16BD
; ---------------------------------------------------------------------------
		align 10h

loc_679C18E0:				; CODE XREF: kde_inet_ntop+1DAj
		cmp	ebx, 0FFFFFFFFh
		jz	loc_679C1AF6
		lea	edx, [ecx+1]
		mov	ecx, ebx
		mov	ebx, eax
		mov	eax, ecx
		mov	ecx, ebp
		jmp	loc_679C168F
; ---------------------------------------------------------------------------
		align 10h

loc_679C1900:				; CODE XREF: kde_inet_ntop+186j
		cmp	ebx, 0FFFFFFFFh
		jz	loc_679C1AD3
		lea	ebp, [edx+1]
		mov	edx, ebx
		mov	ebx, eax
		mov	eax, edx
		mov	edx, ecx
		mov	ecx, [esp+0ACh+var_40]
		test	ecx, ecx
		jnz	loc_679C1645

loc_679C1920:				; CODE XREF: kde_inet_ntop+1AFj
		cmp	eax, 0FFFFFFFFh
		jz	loc_679C1B20
		lea	ecx, [ebp+1]
		mov	ebp, eax
		mov	eax, ebx
		mov	ebx, ebp
		mov	ebp, edx
		jmp	loc_679C1664
; ---------------------------------------------------------------------------
		align 10h

loc_679C1940:				; CODE XREF: kde_inet_ntop+164j
		cmp	ebx, 0FFFFFFFFh
		jz	loc_679C1C58
		lea	edx, [ecx+1]
		xor	ebx, ebx
		mov	eax, 0FFFFFFFFh
		xor	ecx, ecx
		jmp	loc_679C1610
; ---------------------------------------------------------------------------
		align 10h

loc_679C1960:				; CODE XREF: kde_inet_ntop+295j
		cmp	ebp, 5
		jz	loc_679C1CC0
		test	ebp, ebp
		jle	loc_679C1C93
		lea	edx, [esp+0ACh+var_7A]
		mov	[esp+0ACh+var_7A], 3Ah
		lea	eax, [esp+0ACh+var_79]
		mov	[esp+0ACh+Source], edx

loc_679C1982:				; CODE XREF: kde_inet_ntop+827j
		cmp	ebp, 2
		jg	short loc_679C19A8
		mov	byte ptr [eax],	3Ah
		lea	ebx, [eax+1]
		mov	eax, [esp+0ACh+var_44]
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+Dest], ebx ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		lea	eax, [ebx+eax]

loc_679C19A8:				; CODE XREF: kde_inet_ntop+4F5j
		cmp	ebp, 3
		jg	short loc_679C19CE
		mov	byte ptr [eax],	3Ah
		lea	ebx, [eax+1]
		mov	eax, [esp+0ACh+var_40]
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+Dest], ebx ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		lea	eax, [ebx+eax]

loc_679C19CE:				; CODE XREF: kde_inet_ntop+51Bj
		cmp	ebp, 4
		jg	short loc_679C19F4
		mov	byte ptr [eax],	3Ah
		lea	ebx, [eax+1]
		mov	eax, [esp+0ACh+var_3C]
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+Dest], ebx ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		lea	eax, [ebx+eax]

loc_679C19F4:				; CODE XREF: kde_inet_ntop+541j
		cmp	ebp, 5
		jg	short loc_679C1A1A
		mov	byte ptr [eax],	3Ah
		lea	ebx, [eax+1]
		mov	eax, [esp+0ACh+var_38]
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+Dest], ebx ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		lea	eax, [ebx+eax]

loc_679C1A1A:				; CODE XREF: kde_inet_ntop+567j
		cmp	ebp, 6
		jg	short loc_679C1A52
		cmp	ebp, 6
		mov	byte ptr [eax],	3Ah
		lea	ebx, [eax+1]
		jz	loc_679C1ECB
		cmp	ebp, 7
		jz	loc_679C1EC0

loc_679C1A37:				; CODE XREF: kde_inet_ntop+A35j
		mov	eax, [esp+0ACh+var_34]
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+Dest], ebx ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		lea	eax, [ebx+eax]

loc_679C1A52:				; CODE XREF: kde_inet_ntop+58Dj
		cmp	ebp, 7
		mov	esi, ebp
		jg	loc_679C17F0

loc_679C1A5D:				; CODE XREF: kde_inet_ntop+350j
		mov	byte ptr [eax],	3Ah
		lea	ebx, [eax+1]
		mov	eax, [esp+0ACh+var_30]
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+Dest], ebx ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		lea	eax, [ebx+eax]
		jmp	loc_679C17F0
; ---------------------------------------------------------------------------

loc_679C1A83:				; CODE XREF: kde_inet_ntop+363j
		mov	byte ptr [eax],	3Ah
		add	eax, 1
		jmp	loc_679C17F9
; ---------------------------------------------------------------------------
		align 10h

loc_679C1A90:				; CODE XREF: kde_inet_ntop+267j
		mov	eax, 7
		mov	ecx, 1
		jmp	loc_679C1700
; ---------------------------------------------------------------------------
		align 10h

loc_679C1AA0:				; CODE XREF: kde_inet_ntop+1E3j
		mov	edx, ecx
		mov	ebx, eax
		mov	ecx, ebp
		mov	eax, 0FFFFFFFFh
		jmp	loc_679C168F
; ---------------------------------------------------------------------------

loc_679C1AB0:				; CODE XREF: kde_inet_ntop+433j
		mov	eax, ebx
		mov	edx, ecx
		mov	ebx, 5
		mov	ebp, 1
		jmp	loc_679C16BD
; ---------------------------------------------------------------------------

loc_679C1AC3:				; CODE XREF: kde_inet_ntop+1B8j
		mov	ecx, ebp
		mov	eax, ebx
		mov	ebp, edx
		mov	ebx, 0FFFFFFFFh
		jmp	loc_679C1664
; ---------------------------------------------------------------------------

loc_679C1AD3:				; CODE XREF: kde_inet_ntop+473j
		mov	ebx, eax
		mov	edx, ecx
		mov	eax, 2
		mov	ebp, 1
		jmp	loc_679C1639
; ---------------------------------------------------------------------------

loc_679C1AE6:				; CODE XREF: kde_inet_ntop+18Fj
		mov	ebp, edx
		mov	ebx, eax
		mov	edx, ecx
		mov	eax, 0FFFFFFFFh
		jmp	loc_679C1639
; ---------------------------------------------------------------------------

loc_679C1AF6:				; CODE XREF: kde_inet_ntop+453j
		mov	ebx, eax
		mov	ecx, ebp
		mov	eax, 4
		mov	edx, 1
		jmp	loc_679C168F
; ---------------------------------------------------------------------------
		align 10h

loc_679C1B10:				; CODE XREF: kde_inet_ntop+16Dj
		mov	edx, ecx
		mov	eax, 0FFFFFFFFh
		xor	ecx, ecx
		jmp	loc_679C1610
; ---------------------------------------------------------------------------
		align 10h

loc_679C1B20:				; CODE XREF: kde_inet_ntop+493j
		mov	eax, ebx
		mov	ebp, edx
		mov	ebx, 3
		mov	ecx, 1
		jmp	loc_679C1664
; ---------------------------------------------------------------------------

loc_679C1B33:				; CODE XREF: kde_inet_ntop+3F8j
		cmp	ebx, 0FFFFFFFFh
		jnz	loc_679C1711

loc_679C1B3C:				; CODE XREF: kde_inet_ntop+284j
					; kde_inet_ntop+28Dj
		mov	eax, [esp+0ACh+Source]
		lea	edx, [esp+0ACh+var_7A]
		mov	[esp+0ACh+Source], edx
		mov	[esp+0ACh+Dest], edx ; Dest
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		mov	ebx, [esp+0ACh+Source]
		add	ebx, eax
		mov	byte ptr [ebx],	3Ah
		mov	eax, [esp+0ACh+var_48]
		add	ebx, 1
		mov	[esp+0ACh+Dest], ebx ; Dest
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		add	ebx, eax
		mov	byte ptr [ebx],	3Ah
		mov	eax, [esp+0ACh+var_44]
		add	ebx, 1
		mov	[esp+0ACh+Dest], ebx ; Dest
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		add	ebx, eax
		mov	byte ptr [ebx],	3Ah
		mov	eax, [esp+0ACh+var_40]
		add	ebx, 1
		mov	[esp+0ACh+Dest], ebx ; Dest
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		add	ebx, eax
		mov	byte ptr [ebx],	3Ah
		mov	eax, [esp+0ACh+var_3C]
		add	ebx, 1
		mov	[esp+0ACh+Dest], ebx ; Dest
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		add	ebx, eax
		mov	byte ptr [ebx],	3Ah
		mov	eax, [esp+0ACh+var_38]
		add	ebx, 1
		mov	[esp+0ACh+Dest], ebx ; Dest
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		add	ebx, eax
		mov	byte ptr [ebx],	3Ah
		mov	eax, [esp+0ACh+var_34]
		add	ebx, 1
		mov	[esp+0ACh+Dest], ebx ; Dest
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		add	ebx, eax
		mov	byte ptr [ebx],	3Ah
		mov	eax, [esp+0ACh+var_30]
		add	ebx, 1
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+Dest], ebx ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		lea	eax, [ebx+eax]
		jmp	loc_679C17F9
; ---------------------------------------------------------------------------

loc_679C1C48:				; CODE XREF: kde_inet_ntop+23Cj
		mov	ecx, ebp
		mov	ebx, eax
		mov	ebp, edx
		mov	eax, 0FFFFFFFFh
		jmp	loc_679C16E8
; ---------------------------------------------------------------------------

loc_679C1C58:				; CODE XREF: kde_inet_ntop+4B3j
		mov	eax, 0FFFFFFFFh
		mov	ebx, 1
		mov	edx, 1
		xor	ecx, ecx
		jmp	loc_679C1610
; ---------------------------------------------------------------------------
		align 10h

loc_679C1C70:				; CODE XREF: kde_inet_ntop+20Ej
		mov	ebp, edx
		mov	eax, ebx
		mov	edx, ecx
		mov	ebx, 0FFFFFFFFh
		jmp	loc_679C16BD
; ---------------------------------------------------------------------------

loc_679C1C80:				; CODE XREF: kde_inet_ntop+418j
		mov	ebx, eax
		mov	ebp, edx
		mov	eax, 6
		mov	ecx, 1
		jmp	loc_679C16E8
; ---------------------------------------------------------------------------

loc_679C1C93:				; CODE XREF: kde_inet_ntop+4DBj
		mov	eax, [esp+0ACh+Source]
		lea	edx, [esp+0ACh+var_7A]
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+Source], edx
		mov	[esp+0ACh+Dest], edx ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		add	eax, [esp+0ACh+Source]
		jmp	loc_679C1982
; ---------------------------------------------------------------------------
		align 10h

loc_679C1CC0:				; CODE XREF: kde_inet_ntop+4D3j
		mov	eax, [esp+0ACh+var_38]
		lea	ebx, [esp+0ACh+var_78]
		mov	[esp+0ACh+Dest], ebx ; Dest
		mov	[esp+0ACh+var_7A], 3Ah
		mov	[esp+0ACh+var_79], 3Ah
		mov	[esp+0ACh+var_A4], eax
		mov	[esp+0ACh+Format], offset Format ; "%x"
		call	sprintf
		add	ebx, eax
		mov	byte ptr [ebx],	3Ah
		add	ebx, 1
		cmp	[esp+0ACh+var_38], 0FFFFh
		lea	eax, [esp+0ACh+var_7A]
		mov	[esp+0ACh+Source], eax
		jz	loc_679C1ECB
		mov	eax, [esp+0ACh+var_34]
		mov	[esp+0ACh+Dest], ebx ; Dest
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		add	ebx, eax
		mov	byte ptr [ebx],	3Ah
		mov	eax, [esp+0ACh+var_30]
		add	ebx, 1
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+Dest], ebx ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		lea	edx, [esp+0ACh+var_7A]
		mov	[esp+0ACh+Source], edx
		lea	eax, [ebx+eax]
		jmp	loc_679C17F9
; ---------------------------------------------------------------------------
		align 10h

loc_679C1D50:				; CODE XREF: kde_inet_ntop+2A0j
		mov	eax, [esp+0ACh+Source]
		lea	edx, [esp+0ACh+var_7A]
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+Source], edx
		mov	[esp+0ACh+Dest], edx ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		add	eax, [esp+0ACh+Source]
		cmp	ebx, 1
		jnz	loc_679C1F70
		mov	byte ptr [eax],	3Ah
		add	eax, 1

loc_679C1D83:				; CODE XREF: kde_inet_ntop+BA8j
					; kde_inet_ntop+BB1j
		mov	byte ptr [eax],	3Ah
		lea	esi, [eax+1]
		mov	eax, [esp+0ACh+var_34]
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+Dest], esi ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		lea	eax, [esi+eax]

loc_679C1DA4:				; CODE XREF: kde_inet_ntop+BBAj
		cmp	ebx, 2
		jle	loc_679C1F43
		cmp	ebx, 7
		jz	loc_679C20BC

loc_679C1DB6:				; CODE XREF: kde_inet_ntop+BC6j
		lea	esi, [ebx+5]
		jmp	loc_679C17F0
; ---------------------------------------------------------------------------
		align 10h

loc_679C1DC0:				; CODE XREF: kde_inet_ntop+2CDj
					; kde_inet_ntop+2D5j
		mov	byte ptr [eax],	3Ah
		lea	esi, [eax+1]
		mov	eax, [esp+0ACh+var_48]
		mov	[esp+0ACh+Dest], esi ; Dest
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		cmp	ebx, 2
		lea	eax, [esi+eax]
		lea	esi, [ebx+ebp]
		jle	loc_679C1771

loc_679C1DED:				; CODE XREF: kde_inet_ntop+2E7j
		mov	byte ptr [eax],	3Ah
		lea	ebp, [eax+1]
		mov	eax, [esp+0ACh+var_44]
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+Dest], ebp ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		cmp	ebx, 3
		lea	eax, [ebp+eax+0]
		jle	loc_679C1786

loc_679C1E18:				; CODE XREF: kde_inet_ntop+2F9j
		mov	byte ptr [eax],	3Ah
		lea	ebp, [eax+1]
		mov	eax, [esp+0ACh+var_40]
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+Dest], ebp ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		cmp	ebx, 4
		lea	eax, [ebp+eax+0]
		jle	loc_679C1798

loc_679C1E43:				; CODE XREF: kde_inet_ntop+310j
		mov	byte ptr [eax],	3Ah
		lea	ebp, [eax+1]
		mov	eax, [esp+0ACh+var_3C]
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+Dest], ebp ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		cmp	ebx, 5
		lea	eax, [ebp+eax+0]
		jle	loc_679C17AF

loc_679C1E6E:				; CODE XREF: kde_inet_ntop+322j
		mov	byte ptr [eax],	3Ah
		lea	ebp, [eax+1]
		mov	eax, [esp+0ACh+var_38]
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+Dest], ebp ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		cmp	ebx, 7
		lea	eax, [ebp+eax+0]
		jnz	loc_679C17C6

loc_679C1E99:				; CODE XREF: kde_inet_ntop+339j
		mov	byte ptr [eax],	3Ah
		lea	ebp, [eax+1]
		mov	eax, [esp+0ACh+var_34]
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+Dest], ebp ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		lea	eax, [ebp+eax+0]
		jmp	loc_679C17D8
; ---------------------------------------------------------------------------

loc_679C1EC0:				; CODE XREF: kde_inet_ntop+5A1j
		cmp	[esp+0ACh+var_30], 1
		jz	loc_679C1A37

loc_679C1ECB:				; CODE XREF: kde_inet_ntop+598j
					; kde_inet_ntop+86Ej
		mov	edx, [esp+0ACh+var_80]
		movzx	eax, byte ptr [edx+3]
		mov	[esp+0ACh+var_98], eax
		movzx	eax, byte ptr [edx+2]
		mov	[esp+0ACh+var_9C], eax
		movzx	eax, byte ptr [edx+1]
		mov	[esp+0ACh+var_A0], eax
		movzx	eax, byte ptr [esi+0Ch]
		lea	esi, [esp+0ACh+var_2C]
		mov	[esp+0ACh+Format], offset aU_U_U_U ; "%u.%u.%u.%u"
		mov	[esp+0ACh+Dest], esi ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		mov	edx, [esp+0ACh+Source]
		sub	edx, ebx
		add	edx, 2Eh
		cmp	edx, eax
		jbe	loc_679C1871
		mov	[esp+0ACh+Format], esi ; Source
		mov	[esp+0ACh+Dest], ebx ; Dest
		call	strcpy
		test	ebx, ebx
		jz	loc_679C14E1
		mov	[esp+0ACh+Dest], ebx ; Str
		mov	esi, ebp
		call	strlen
		lea	eax, [ebx+eax]
		jmp	loc_679C17F0
; ---------------------------------------------------------------------------

loc_679C1F3D:				; CODE XREF: kde_inet_ntop+BD0j
		mov	byte ptr [eax],	3Ah
		add	eax, 1

loc_679C1F43:				; CODE XREF: kde_inet_ntop+917j
		mov	byte ptr [eax],	3Ah
		lea	esi, [eax+1]
		mov	eax, [esp+0ACh+var_30]
		mov	[esp+0ACh+Dest], esi ; Dest
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		lea	eax, [esi+eax]
		lea	esi, [ebx+5]
		jmp	loc_679C17F0
; ---------------------------------------------------------------------------
		align 10h

loc_679C1F70:				; CODE XREF: kde_inet_ntop+8E7j
		mov	byte ptr [eax],	3Ah
		lea	esi, [eax+1]
		mov	eax, [esp+0ACh+var_48]
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+Dest], esi ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		cmp	ebx, 2
		lea	eax, [esi+eax]
		jle	loc_679C205B
		mov	byte ptr [eax],	3Ah
		lea	esi, [eax+1]
		mov	eax, [esp+0ACh+var_44]
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+Dest], esi ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		cmp	ebx, 3
		lea	eax, [esi+eax]
		jle	loc_679C2066
		mov	byte ptr [eax],	3Ah
		lea	esi, [eax+1]
		mov	eax, [esp+0ACh+var_40]
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+Dest], esi ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		cmp	ebx, 4
		lea	eax, [esi+eax]
		jle	loc_679C206B
		mov	byte ptr [eax],	3Ah
		lea	esi, [eax+1]
		mov	eax, [esp+0ACh+var_3C]
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+Dest], esi ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		cmp	ebx, 5
		lea	eax, [esi+eax]
		jle	short loc_679C2072
		mov	byte ptr [eax],	3Ah
		lea	esi, [eax+1]
		mov	eax, [esp+0ACh+var_38]
		mov	[esp+0ACh+Format], offset Format ; "%x"
		mov	[esp+0ACh+Dest], esi ; Dest
		mov	[esp+0ACh+var_A4], eax
		call	sprintf
		cmp	ebx, 7
		lea	eax, [esi+eax]
		jz	loc_679C1D83

loc_679C203E:				; CODE XREF: kde_inet_ntop+BE5j
		cmp	ebx, 1
		jz	loc_679C1D83
		cmp	ebx, 6
		jnz	loc_679C1DA4

loc_679C2050:				; CODE XREF: kde_inet_ntop+BD9j
					; kde_inet_ntop+BE0j ...
		mov	byte ptr [eax],	3Ah
		add	eax, 1
		jmp	loc_679C1DB6
; ---------------------------------------------------------------------------

loc_679C205B:				; CODE XREF: kde_inet_ntop+B04j
		nop
		lea	esi, [esi+0]
		jz	loc_679C1F3D

loc_679C2066:				; CODE XREF: kde_inet_ntop+B2Ej
		cmp	ebx, 3
		jz	short loc_679C2050

loc_679C206B:				; CODE XREF: kde_inet_ntop+B58j
		cmp	ebx, 4
		xchg	ax, ax
		jz	short loc_679C2050

loc_679C2072:				; CODE XREF: kde_inet_ntop+B82j
		cmp	ebx, 5
		jnz	short loc_679C203E
		jmp	short loc_679C2050
; ---------------------------------------------------------------------------

loc_679C2079:				; CODE XREF: kde_inet_ntop+342j
		mov	byte ptr [eax],	3Ah
		add	eax, 1
		nop
		jmp	loc_679C17D8
; ---------------------------------------------------------------------------

loc_679C2085:				; CODE XREF: kde_inet_ntop+319j
		mov	byte ptr [eax],	3Ah
		add	eax, 1
		jmp	loc_679C17AF
; ---------------------------------------------------------------------------

loc_679C2090:				; CODE XREF: kde_inet_ntop+330j
		mov	byte ptr [eax],	3Ah
		add	eax, 1
		jmp	loc_679C17C6
; ---------------------------------------------------------------------------

loc_679C209B:				; CODE XREF: kde_inet_ntop+2F0j
		mov	byte ptr [eax],	3Ah
		add	eax, 1
		jmp	loc_679C1786
; ---------------------------------------------------------------------------

loc_679C20A6:				; CODE XREF: kde_inet_ntop+302j
		mov	byte ptr [eax],	3Ah
		add	eax, 1
		jmp	loc_679C1798
; ---------------------------------------------------------------------------

loc_679C20B1:				; CODE XREF: kde_inet_ntop+359j
		mov	byte ptr [eax],	3Ah
		add	eax, 1
		jmp	loc_679C17F0
; ---------------------------------------------------------------------------

loc_679C20BC:				; CODE XREF: kde_inet_ntop+920j
		mov	byte ptr [eax],	3Ah
		mov	esi, 0Ch
		add	eax, 1
		jmp	loc_679C17F0
kde_inet_ntop	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  43. kde_inet_pton

; =============== S U B	R O U T	I N E =======================================


		public kde_inet_pton
kde_inet_pton	proc near		; CODE XREF: inet_pton+6j

Str		= dword	ptr -7Ch
Val		= dword	ptr -78h
var_60		= dword	ptr -60h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	eax, [esp+7Ch+arg_0]
		mov	ebx, [esp+7Ch+arg_4]
		cmp	eax, 2
		jz	short loc_679C2110
		cmp	eax, 17h
		jz	loc_679C21C0
		call	ds:_errno
		mov	dword ptr [eax], 6Ah
		mov	eax, 0FFFFFFFFh

loc_679C2104:				; CODE XREF: kde_inet_pton+255j
					; kde_inet_pton+300j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C2110:				; CODE XREF: kde_inet_pton+18j
		mov	byte ptr [esp+7Ch+var_20], 0
		lea	ebp, [esp+7Ch+var_20]
		xor	edi, edi
		mov	[esp+7Ch+var_48], 0
		jmp	short loc_679C2160
; ---------------------------------------------------------------------------

loc_679C2125:				; CODE XREF: kde_inet_pton+ACj
		test	edi, edi
		movzx	edx, byte ptr [ebp+0]
		jz	short loc_679C2131
		test	dl, dl
		jz	short loc_679C21B0

loc_679C2131:				; CODE XREF: kde_inet_pton+5Bj
		movzx	edx, dl
		lea	edx, [edx+edx*4]
		add	edx, edx
		sub	edx, offset Str	; "0123456789"
		add	eax, edx
		cmp	eax, 0FFh
		ja	short loc_679C21B0
		test	edi, edi
		mov	[ebp+0], al
		jnz	short loc_679C215B
		add	[esp+7Ch+var_48], 1
		cmp	[esp+7Ch+var_48], 4
		jg	short loc_679C21B0

loc_679C215B:				; CODE XREF: kde_inet_pton+7Dj
		mov	edi, 1

loc_679C2160:				; CODE XREF: kde_inet_pton+53j
		movsx	esi, byte ptr [ebx]
		add	ebx, 1
		test	esi, esi
		jz	short loc_679C21A5

loc_679C216A:				; CODE XREF: kde_inet_pton+D3j
		mov	[esp+7Ch+Val], esi ; Val
		mov	[esp+7Ch+Str], offset Str ; "0123456789"
		call	strchr
		test	eax, eax
		jnz	short loc_679C2125
		test	edi, edi
		jz	short loc_679C21B0
		cmp	esi, 2Eh
		jnz	short loc_679C21B0
		cmp	[esp+7Ch+var_48], 4
		lea	esi, [esi+0]
		jz	short loc_679C21B0
		add	ebp, 1
		xor	edi, edi
		mov	byte ptr [ebp+0], 0
		movsx	esi, byte ptr [ebx]
		add	ebx, 1
		test	esi, esi
		jnz	short loc_679C216A

loc_679C21A5:				; CODE XREF: kde_inet_pton+98j
		cmp	[esp+7Ch+var_48], 3
		jg	loc_679C23BE

loc_679C21B0:				; CODE XREF: kde_inet_pton+5Fj
					; kde_inet_pton+76j ...
		xor	eax, eax

loc_679C21B2:				; CODE XREF: kde_inet_pton+2D2j
					; kde_inet_pton+311j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C21C0:				; CODE XREF: kde_inet_pton+1Dj
		lea	eax, [esp+7Ch+var_20]
		mov	[esp+7Ch+var_30], 0
		mov	[esp+7Ch+var_2C], 0
		mov	[esp+7Ch+var_28], 0
		mov	[esp+7Ch+var_24], 0
		mov	[esp+7Ch+var_60], eax
		movzx	eax, byte ptr [ebx]
		cmp	al, 3Ah
		jz	loc_679C2394

loc_679C21F3:				; CODE XREF: kde_inet_pton+2CAj
		movsx	esi, al
		xor	edi, edi
		lea	edx, [esp+7Ch+var_30]
		test	esi, esi
		mov	ebp, ebx
		mov	[esp+7Ch+var_40], ebx
		mov	ebx, edx
		mov	[esp+7Ch+var_48], 0
		mov	[esp+7Ch+var_44], 0
		jz	short loc_679C226A

loc_679C2218:				; CODE XREF: kde_inet_pton+198j
		mov	[esp+7Ch+Val], esi ; Val
		add	ebp, 1
		mov	[esp+7Ch+Str], offset a0123456789abcd ;	"0123456789abcdef"
		call	strchr
		mov	edx, offset a0123456789abcd ; "0123456789abcdef"
		test	eax, eax
		jz	loc_679C2330

loc_679C2238:				; CODE XREF: kde_inet_pton+3DEj
		add	edi, 1
		cmp	edi, 4
		jg	loc_679C21B0
		mov	ecx, [esp+7Ch+var_48]
		sub	eax, edx
		mov	edx, ebx
		mov	ebx, [esp+7Ch+var_44]
		shl	ecx, 4
		or	eax, ecx
		mov	[esp+7Ch+var_48], eax

loc_679C2259:				; CODE XREF: kde_inet_pton+2BFj
					; kde_inet_pton+2E9j
		movzx	eax, byte ptr [ebp+0]
		mov	[esp+7Ch+var_44], ebx
		mov	ebx, edx
		movsx	esi, al
		test	esi, esi
		jnz	short loc_679C2218

loc_679C226A:				; CODE XREF: kde_inet_pton+146j
		test	edi, edi
		mov	esi, ebx
		jz	short loc_679C228E
		lea	esi, [ebx+2]
		cmp	[esp+7Ch+var_60], esi
		jb	loc_679C21B0
		mov	eax, [esp+7Ch+var_48]
		shr	eax, 8
		mov	[ebx], al
		movzx	eax, byte ptr [esp+7Ch+var_48]
		mov	[ebx+1], al

loc_679C228E:				; CODE XREF: kde_inet_pton+19Ej
					; kde_inet_pton+3F6j
		mov	eax, [esp+7Ch+var_44]
		test	eax, eax
		jz	loc_679C23D5
		cmp	[esp+7Ch+var_60], esi
		jz	loc_679C21B0
		mov	eax, esi
		sub	eax, [esp+7Ch+var_44]
		test	eax, eax
		jle	short loc_679C22D5
		mov	ebx, [esp+7Ch+var_44]
		lea	edx, [esp+7Ch+var_30]
		add	eax, [esp+7Ch+var_44]
		lea	esi, [esi+0]

loc_679C22C0:				; CODE XREF: kde_inet_pton+203j
		movzx	ecx, byte ptr [eax-1]
		mov	[edx+0Fh], cl
		sub	edx, 1
		mov	byte ptr [eax-1], 0
		sub	eax, 1
		cmp	eax, ebx
		jnz	short loc_679C22C0

loc_679C22D5:				; CODE XREF: kde_inet_pton+1DCj
					; kde_inet_pton+309j
		mov	edi, [esp+7Ch+arg_8]
		lea	esi, [esp+7Ch+var_30]
		mov	eax, 10h
		test	edi, 1
		jnz	loc_679C24D5

loc_679C22F1:				; CODE XREF: kde_inet_pton+408j
		test	edi, 2
		jnz	loc_679C24CB

loc_679C22FD:				; CODE XREF: kde_inet_pton+400j
		mov	ecx, eax
		xor	edx, edx
		shr	ecx, 2
		test	al, 2
		rep movsd
		jz	short loc_679C2315
		movzx	edx, word ptr [esi]
		mov	[edi], dx
		mov	edx, 2

loc_679C2315:				; CODE XREF: kde_inet_pton+238j
		test	al, 1
		jz	short loc_679C2320
		movzx	eax, byte ptr [esi+edx]
		mov	[edi+edx], al

loc_679C2320:				; CODE XREF: kde_inet_pton+247j
		mov	eax, 1
		jmp	loc_679C2104
; ---------------------------------------------------------------------------
		align 10h

loc_679C2330:				; CODE XREF: kde_inet_pton+162j
		mov	[esp+7Ch+Val], esi ; Val
		mov	[esp+7Ch+Str], offset a0123456789ab_0 ;	"0123456789ABCDEF"
		call	strchr
		test	eax, eax
		jnz	loc_679C24A9
		cmp	esi, 3Ah
		jnz	loc_679C23E6
		test	edi, edi
		jz	short loc_679C23A7
		cmp	byte ptr [ebp+0], 0
		jz	loc_679C21B0
		lea	edx, [ebx+2]
		cmp	[esp+7Ch+var_60], edx
		jb	loc_679C21B0
		mov	eax, [esp+7Ch+var_48]
		xor	edi, edi
		shr	eax, 8
		mov	[ebx], al
		movzx	eax, byte ptr [esp+7Ch+var_48]
		mov	[ebx+1], al
		mov	ebx, [esp+7Ch+var_44]
		mov	[esp+7Ch+var_40], ebp
		mov	[esp+7Ch+var_48], 0
		jmp	loc_679C2259
; ---------------------------------------------------------------------------

loc_679C2394:				; CODE XREF: kde_inet_pton+11Dj
		add	ebx, 1
		cmp	byte ptr [ebx],	3Ah
		jz	loc_679C21F3
		xor	eax, eax
		jmp	loc_679C21B2
; ---------------------------------------------------------------------------

loc_679C23A7:				; CODE XREF: kde_inet_pton+283j
		mov	edx, [esp+7Ch+var_44]
		test	edx, edx
		jnz	loc_679C21B0
		mov	[esp+7Ch+var_40], ebp
		mov	edx, ebx
		jmp	loc_679C2259
; ---------------------------------------------------------------------------

loc_679C23BE:				; CODE XREF: kde_inet_pton+DAj
		mov	eax, [esp+7Ch+var_20]
		mov	edx, [esp+7Ch+arg_8]
		mov	[edx], eax
		mov	eax, 1
		jmp	loc_679C2104
; ---------------------------------------------------------------------------

loc_679C23D5:				; CODE XREF: kde_inet_pton+1C4j
		cmp	[esp+7Ch+var_60], esi
		jz	loc_679C22D5
		xor	eax, eax
		jmp	loc_679C21B2
; ---------------------------------------------------------------------------

loc_679C23E6:				; CODE XREF: kde_inet_pton+27Bj
		cmp	esi, 2Eh
		mov	edx, ebx
		mov	ebx, [esp+7Ch+var_40]
		jnz	loc_679C21B0
		lea	esi, [edx+4]
		cmp	[esp+7Ch+var_60], esi
		jb	loc_679C21B0
		mov	byte ptr [esp+7Ch+var_20], 0
		lea	ebp, [esp+7Ch+var_20]
		xor	ecx, ecx
		xor	edi, edi
		mov	[esp+7Ch+var_48], edx
		jmp	short loc_679C2456
; ---------------------------------------------------------------------------

loc_679C2415:				; CODE XREF: kde_inet_pton+3B2j
		test	edi, edi
		movzx	edx, byte ptr [ebp+0]
		jz	short loc_679C2425
		test	dl, dl
		jz	loc_679C21B0

loc_679C2425:				; CODE XREF: kde_inet_pton+34Bj
		movzx	edx, dl
		imul	edx, 0Ah
		sub	edx, offset Str	; "0123456789"
		add	eax, edx
		cmp	eax, 0FFh
		ja	loc_679C21B0
		test	edi, edi
		mov	[ebp+0], al
		jnz	short loc_679C2451
		add	ecx, 1
		cmp	ecx, 4
		jg	loc_679C21B0

loc_679C2451:				; CODE XREF: kde_inet_pton+373j
		mov	edi, 1

loc_679C2456:				; CODE XREF: kde_inet_pton+343j
					; kde_inet_pton+3D7j
		movsx	edx, byte ptr [ebx]
		add	ebx, 1
		test	edx, edx
		jz	short loc_679C24B3
		mov	[esp+7Ch+Val], edx ; Val
		mov	[esp+7Ch+Str], offset Str ; "0123456789"
		mov	[esp+7Ch+var_4C], edx
		mov	[esp+7Ch+var_50], ecx
		call	strchr
		mov	edx, [esp+7Ch+var_4C]
		mov	ecx, [esp+7Ch+var_50]
		test	eax, eax
		jnz	short loc_679C2415
		test	edi, edi
		jz	loc_679C21B0
		cmp	edx, 2Eh
		jnz	loc_679C21B0
		cmp	ecx, 4
		jz	loc_679C21B0
		add	ebp, 1
		xor	edi, edi
		mov	byte ptr [ebp+0], 0
		jmp	short loc_679C2456
; ---------------------------------------------------------------------------

loc_679C24A9:				; CODE XREF: kde_inet_pton+272j
		mov	edx, offset a0123456789ab_0 ; "0123456789ABCDEF"
		jmp	loc_679C2238
; ---------------------------------------------------------------------------

loc_679C24B3:				; CODE XREF: kde_inet_pton+38Ej
		cmp	ecx, 3
		mov	edx, [esp+7Ch+var_48]
		jle	loc_679C21B0
		mov	eax, [esp+7Ch+var_20]
		mov	[edx], eax
		jmp	loc_679C228E
; ---------------------------------------------------------------------------

loc_679C24CB:				; CODE XREF: kde_inet_pton+227j
		movsw
		sub	eax, 2
		jmp	loc_679C22FD
; ---------------------------------------------------------------------------

loc_679C24D5:				; CODE XREF: kde_inet_pton+21Bj
		movsb
		mov	al, 0Fh
		jmp	loc_679C22F1
kde_inet_pton	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   2. _set_errno

; =============== S U B	R O U T	I N E =======================================


		public _set_errno
_set_errno	proc near		; CODE XREF: munmap+14Ap mmap+13Cp ...

arg_0		= dword	ptr  4

		sub	esp, 0Ch
		call	ds:_errno
		mov	edx, [esp+0Ch+arg_0]
		mov	[eax], edx
		xor	eax, eax
		add	esp, 0Ch
		retn
_set_errno	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  15. fsync

; =============== S U B	R O U T	I N E =======================================


		public fsync
fsync		proc near

hFile		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		test	eax, eax
		jns	short loc_679C2514

loc_679C250B:				; CODE XREF: fsync+20j	fsync+36j
		mov	eax, 0FFFFFFFFh

loc_679C2510:				; CODE XREF: fsync+34j
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_679C2514:				; CODE XREF: fsync+9j
		mov	[esp+1Ch+hFile], eax
		call	ds:_get_osfhandle
		cmp	eax, 0FFFFFFFFh
		jz	short loc_679C250B
		mov	[esp+1Ch+hFile], eax ; hFile
		call	ds:FlushFileBuffers
		mov	edx, eax
		sub	esp, 4
		xor	eax, eax
		test	edx, edx
		jnz	short loc_679C2510
		jmp	short loc_679C250B
fsync		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  40. kde_getenv

; =============== S U B	R O U T	I N E =======================================


; int __cdecl kde_getenv(LPCSTR)
		public kde_getenv
kde_getenv	proc near

lpName		= dword	ptr -3Ch
lpBuffer	= dword	ptr -38h
nSize		= dword	ptr -34h
Buffer		= byte ptr -1Dh
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 3Ch
		mov	[esp+3Ch+var_10], ebx
		mov	ebx, [esp+3Ch+arg_0]
		mov	[esp+3Ch+var_C], esi
		mov	[esp+3Ch+var_8], edi
		mov	[esp+3Ch+var_4], ebp
		test	ebx, ebx
		jnz	short loc_679C2573

loc_679C255B:				; CODE XREF: kde_getenv+53j
		xor	esi, esi

loc_679C255D:				; CODE XREF: kde_getenv+74j
					; kde_getenv+80j
		mov	eax, esi
		mov	ebx, [esp+3Ch+var_10]
		mov	esi, [esp+3Ch+var_C]
		mov	edi, [esp+3Ch+var_8]
		mov	ebp, [esp+3Ch+var_4]
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------

loc_679C2573:				; CODE XREF: kde_getenv+19j
		lea	eax, [esp+3Ch+Buffer]
		mov	edi, ds:GetEnvironmentVariableA
		mov	[esp+3Ch+nSize], 0 ; nSize
		mov	[esp+3Ch+lpBuffer], eax	; lpBuffer
		mov	[esp+3Ch+lpName], ebx ;	lpName
		call	edi ; GetEnvironmentVariableA
		sub	esp, 0Ch
		test	eax, eax
		jz	short loc_679C255B
		lea	ebp, [eax+1]
		mov	[esp+3Ch+lpName], ebp ;	Size
		call	malloc
		mov	[esp+3Ch+nSize], ebp ; nSize
		mov	[esp+3Ch+lpName], ebx ;	lpName
		mov	esi, eax
		mov	[esp+3Ch+lpBuffer], eax	; lpBuffer
		call	edi ; GetEnvironmentVariableA
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_679C255D
		mov	[esp+3Ch+lpName], esi ;	Memory
		xor	esi, esi
		call	free
		jmp	short loc_679C255D
kde_getenv	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  21. getgrnam

; =============== S U B	R O U T	I N E =======================================


		public getgrnam
getgrnam	proc near
		mov	eax, offset off_679C8000
		retn
getgrnam	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  20. getgrgid

; =============== S U B	R O U T	I N E =======================================


		public getgrgid
getgrgid	proc near
		mov	eax, offset off_679C8000
		retn
getgrgid	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  19. getgrent

; =============== S U B	R O U T	I N E =======================================


		public getgrent
getgrent	proc near
		mov	eax, offset off_679C8000
		retn
getgrent	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  77. setgrent

; =============== S U B	R O U T	I N E =======================================


		public setgrent
setgrent	proc near
		rep retn
setgrent	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   9. endgrent

; =============== S U B	R O U T	I N E =======================================


		public endgrent
endgrent	proc near
		rep retn
endgrent	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  38. inet_ntop

; =============== S U B	R O U T	I N E =======================================


		public inet_ntop
inet_ntop	proc near
		sub	esp, 0Ch
		add	esp, 0Ch
		jmp	kde_inet_ntop
inet_ntop	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  39. inet_pton

; =============== S U B	R O U T	I N E =======================================


		public inet_pton
inet_pton	proc near
		sub	esp, 0Ch
		add	esp, 0Ch
		jmp	kde_inet_pton
inet_pton	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  37. inet_aton

; =============== S U B	R O U T	I N E =======================================


; int __cdecl inet_aton(char *,	int)
		public inet_aton
inet_aton	proc near

cp		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	[esp+1Ch+var_4], edi
		mov	edi, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_C], ebx
		mov	ebx, [esp+1Ch+arg_4]
		mov	[esp+1Ch+var_8], esi
		mov	[esp+1Ch+cp], edi ; cp
		call	ds:inet_addr
		sub	esp, 4
		cmp	eax, 0FFFFFFFFh
		jz	short loc_679C2680
		mov	[ebx], eax
		mov	eax, 1

loc_679C266F:				; CODE XREF: inet_aton+56j
		mov	ebx, [esp+1Ch+var_C]
		mov	esi, [esp+1Ch+var_8]
		mov	edi, [esp+1Ch+var_4]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C2680:				; CODE XREF: inet_aton+26j
		mov	ecx, 10h
		mov	esi, offset a255_255_255_25 ; "255.255.255.255"
		repe cmpsb
		setnbe	cl
		setb	dl
		xor	eax, eax
		cmp	cl, dl
		jnz	short loc_679C266F
		mov	dword ptr [ebx], 0FFFFFFFFh
		mov	al, 1
		mov	ebx, [esp+1Ch+var_C]
		mov	esi, [esp+1Ch+var_8]
		mov	edi, [esp+1Ch+var_4]
		add	esp, 1Ch
		retn
inet_aton	endp

; Exported entry  45. kdewin32_fix_flags

; =============== S U B	R O U T	I N E =======================================


		public kdewin32_fix_flags
kdewin32_fix_flags proc	near

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	ax, 0C000h
		jnz	short locret_679C26BD
		or	ah, 80h

locret_679C26BD:			; CODE XREF: kdewin32_fix_flags+8j
		rep retn
kdewin32_fix_flags endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  50. kdewin32_mkdir

; =============== S U B	R O U T	I N E =======================================


		public kdewin32_mkdir
kdewin32_mkdir	proc near
		sub	esp, 0Ch
		add	esp, 0Ch
		jmp	_mkdir
kdewin32_mkdir	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  52. kdewin32_rename

; =============== S U B	R O U T	I N E =======================================


; int __cdecl kdewin32_rename(char *OldFilename, char *NewFilename)
		public kdewin32_rename
kdewin32_rename	proc near

Filename	= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
OldFilename	= dword	ptr  4
NewFilename	= dword	ptr  8

		sub	esp, 1Ch
		mov	[esp+1Ch+var_8], ebx
		mov	ebx, [esp+1Ch+NewFilename]
		mov	[esp+1Ch+var_4], esi
		mov	esi, [esp+1Ch+OldFilename]
		mov	[esp+1Ch+var_18], 0
		mov	[esp+1Ch+Filename], ebx
		call	_access
		test	eax, eax
		jz	short loc_679C2710

loc_679C26F7:				; CODE XREF: kdewin32_rename+4Aj
		mov	[esp+1Ch+NewFilename], ebx ; NewFilename
		mov	ebx, [esp+1Ch+var_8]
		mov	[esp+1Ch+OldFilename], esi ; OldFilename
		mov	esi, [esp+1Ch+var_4]
		add	esp, 1Ch
		jmp	rename
; ---------------------------------------------------------------------------
		align 10h

loc_679C2710:				; CODE XREF: kdewin32_rename+25j
		mov	[esp+1Ch+Filename], ebx	; Filename
		call	remove
		test	eax, eax
		jz	short loc_679C26F7
		mov	eax, 0FFFFFFFFh
		mov	ebx, [esp+1Ch+var_8]
		mov	esi, [esp+1Ch+var_4]
		add	esp, 1Ch
		retn
kdewin32_rename	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  46. kdewin32_fix_mode_string

; =============== S U B	R O U T	I N E =======================================


; int __cdecl kdewin32_fix_mode_string(char *Dest, char	*)
		public kdewin32_fix_mode_string
kdewin32_fix_mode_string proc near

Str		= dword	ptr -1Ch
Source		= dword	ptr -18h
Count		= dword	ptr -14h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
Dest		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	[esp+1Ch+var_8], ebx
		mov	ebx, [esp+1Ch+arg_4]
		mov	[esp+1Ch+var_4], esi
		mov	esi, [esp+1Ch+Dest]
		cmp	byte ptr [ebx],	0
		jz	short loc_679C2755
		mov	[esp+1Ch+Str], ebx ; Str
		call	strlen
		cmp	eax, 3
		jbe	short loc_679C2766

loc_679C2755:				; CODE XREF: kdewin32_fix_mode_string+16j
		mov	eax, 1

loc_679C275A:				; CODE XREF: kdewin32_fix_mode_string+72j
					; kdewin32_fix_mode_string+9Ej
		mov	ebx, [esp+1Ch+var_8]
		mov	esi, [esp+1Ch+var_4]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_679C2766:				; CODE XREF: kdewin32_fix_mode_string+23j
		mov	[esp+1Ch+Count], 3 ; Count
		mov	[esp+1Ch+Source], ebx ;	Source
		mov	[esp+1Ch+Str], esi ; Dest
		call	strncpy
		movzx	eax, byte ptr [esi]
		cmp	al, 62h
		jz	short loc_679C27A4
		movzx	edx, byte ptr [esi+1]
		cmp	dl, 62h
		jz	short loc_679C27A4
		cmp	al, 74h
		jz	short loc_679C27A4
		cmp	dl, 74h
		jz	short loc_679C27A4
		cmp	dl, 2Bh
		jz	short loc_679C27C0
		mov	byte ptr [esi+1], 62h
		xor	eax, eax
		mov	byte ptr [esi+2], 0
		jmp	short loc_679C275A
; ---------------------------------------------------------------------------

loc_679C27A4:				; CODE XREF: kdewin32_fix_mode_string+4Fj
					; kdewin32_fix_mode_string+58j	...
		mov	[esp+1Ch+Str], ebx ; Str
		call	strlen
		mov	byte ptr [esi+eax], 0
		xor	eax, eax
		mov	ebx, [esp+1Ch+var_8]
		mov	esi, [esp+1Ch+var_4]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C27C0:				; CODE XREF: kdewin32_fix_mode_string+66j
		mov	byte ptr [esi+1], 62h
		xor	eax, eax
		mov	byte ptr [esi+2], 2Bh
		mov	byte ptr [esi+3], 0
		jmp	short loc_679C275A
kdewin32_fix_mode_string endp

; Exported entry  51. kdewin32_open

; =============== S U B	R O U T	I N E =======================================


		public kdewin32_open
kdewin32_open	proc near

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= word ptr  0Ch

		sub	esp, 1Ch
		xor	edx, edx
		mov	eax, [esp+1Ch+arg_4]
		test	ah, 1
		jnz	short loc_679C2800

loc_679C27DE:				; CODE XREF: kdewin32_open+35j
		test	ax, 0C000h
		jnz	short loc_679C27E7
		or	ah, 80h

loc_679C27E7:				; CODE XREF: kdewin32_open+12j
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	_open
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C2800:				; CODE XREF: kdewin32_open+Cj
		movzx	edx, [esp+1Ch+arg_8]
		jmp	short loc_679C27DE
kdewin32_open	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   7. customize_file_name

; =============== S U B	R O U T	I N E =======================================


; int __cdecl customize_file_name(char *)
		public customize_file_name
customize_file_name proc near

Str		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	[esp+1Ch+var_8], ebx
		mov	ebx, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_4], esi
		mov	[esp+1Ch+Str], ebx ; Str
		call	strlen
		mov	esi, eax
		lea	eax, [eax-2]
		cmp	eax, 1
		ja	short loc_679C2875
		cmp	byte ptr [ebx+1], 3Ah
		jnz	short loc_679C2875
		movsx	eax, byte ptr [ebx]
		mov	[esp+1Ch+Str], eax ; C
		call	ds:isalpha
		test	eax, eax
		jz	short loc_679C2875
		cmp	esi, 3
		jz	short loc_679C287A
		mov	[esp+1Ch+Str], 4 ; Size
		call	malloc
		movzx	edx, byte ptr [ebx]
		mov	[eax], dl
		mov	byte ptr [eax+1], 3Ah
		mov	byte ptr [eax+2], 5Ch
		mov	byte ptr [eax+3], 0
		mov	ebx, [esp+1Ch+var_8]
		mov	esi, [esp+1Ch+var_4]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_679C2875:				; CODE XREF: customize_file_name+1Fj
					; customize_file_name+25j ...
		cmp	esi, 1
		jg	short loc_679C2888

loc_679C287A:				; CODE XREF: customize_file_name+3Aj
					; customize_file_name+83j
		xor	eax, eax

loc_679C287C:				; CODE XREF: customize_file_name+96j
		mov	ebx, [esp+1Ch+var_8]
		mov	esi, [esp+1Ch+var_4]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_679C2888:				; CODE XREF: customize_file_name+68j
		movzx	eax, byte ptr [ebx+esi-1]
		cmp	al, 2Fh
		jz	short loc_679C2895
		cmp	al, 5Ch
		jnz	short loc_679C287A

loc_679C2895:				; CODE XREF: customize_file_name+7Fj
		mov	[esp+1Ch+var_18], esi ;	int
		mov	[esp+1Ch+Str], ebx ; char *
		call	strndup
		mov	byte ptr [eax+esi-1], 0
		jmp	short loc_679C287C
customize_file_name endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  54. kdewin32_stat

; =============== S U B	R O U T	I N E =======================================


; int __cdecl kdewin32_stat(char *, int)
		public kdewin32_stat
kdewin32_stat	proc near

Str		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 5Ch
		mov	[esp+5Ch+var_C], esi
		mov	esi, [esp+5Ch+arg_0]
		mov	[esp+5Ch+var_10], ebx
		mov	ebx, [esp+5Ch+arg_4]
		mov	[esp+5Ch+var_4], ebp
		mov	[esp+5Ch+var_8], edi
		mov	[esp+5Ch+Str], esi ; Str
		call	strlen
		mov	ebp, eax
		lea	eax, [eax-2]
		cmp	eax, 1
		ja	short loc_679C28F7
		cmp	byte ptr [esi+1], 3Ah
		jnz	short loc_679C28F7
		movsx	eax, byte ptr [esi]
		mov	[esp+5Ch+Str], eax ; C
		call	ds:isalpha
		test	eax, eax
		jnz	loc_679C2988

loc_679C28F7:				; CODE XREF: kdewin32_stat+2Bj
					; kdewin32_stat+31j
		cmp	ebp, 1
		jg	loc_679C29C0

loc_679C2900:				; CODE XREF: kdewin32_stat+DBj
					; kdewin32_stat+11Bj
		mov	eax, esi
		xor	ebp, ebp

loc_679C2904:				; CODE XREF: kdewin32_stat+104j
					; kdewin32_stat+148j
		lea	edx, [esp+5Ch+var_40]
		mov	[esp+5Ch+var_58], edx
		mov	[esp+5Ch+Str], eax
		call	ds:_stat
		cmp	eax, 0FFFFFFFFh
		mov	esi, eax
		jz	loc_679C29E4
		mov	eax, [esp+5Ch+var_40]
		mov	[ebx], eax
		mov	eax, [esp+5Ch+var_3C]
		mov	[ebx+4], eax
		mov	eax, [esp+5Ch+var_38]
		mov	[ebx+8], eax
		mov	eax, [esp+5Ch+var_34]
		mov	[ebx+0Ch], eax
		mov	eax, [esp+5Ch+var_30]
		mov	[ebx+10h], eax
		mov	eax, [esp+5Ch+var_2C]
		mov	[ebx+14h], eax
		mov	eax, [esp+5Ch+var_28]
		mov	[ebx+18h], eax
		mov	eax, [esp+5Ch+var_24]
		mov	[ebx+1Ch], eax
		mov	eax, [esp+5Ch+var_20]
		mov	[ebx+20h], eax

loc_679C295E:				; CODE XREF: kdewin32_stat+13Fj
		mov	[esp+5Ch+Str], ebp ; Memory
		call	free
		mov	eax, esi
		mov	word ptr [ebx+0Ah], 0FFFEh
		mov	word ptr [ebx+0Ch], 0FFFEh
		mov	ebx, [esp+5Ch+var_10]
		mov	esi, [esp+5Ch+var_C]
		mov	edi, [esp+5Ch+var_8]
		mov	ebp, [esp+5Ch+var_4]
		add	esp, 5Ch
		retn
; ---------------------------------------------------------------------------

loc_679C2988:				; CODE XREF: kdewin32_stat+41j
		cmp	ebp, 3
		jz	loc_679C2900
		mov	[esp+5Ch+Str], 4 ; Size
		call	malloc
		movzx	edx, byte ptr [esi]
		mov	byte ptr [eax+1], 3Ah
		mov	[eax], dl
		mov	byte ptr [eax+2], 5Ch
		mov	byte ptr [eax+3], 0

loc_679C29AE:				; CODE XREF: kdewin32_stat+132j
		test	eax, eax
		jz	short loc_679C29F4
		mov	ebp, eax
		jmp	loc_679C2904
; ---------------------------------------------------------------------------
		align 10h

loc_679C29C0:				; CODE XREF: kdewin32_stat+4Aj
		movzx	eax, byte ptr [esi+ebp-1]
		cmp	al, 2Fh
		jz	short loc_679C29D1
		cmp	al, 5Ch
		jnz	loc_679C2900

loc_679C29D1:				; CODE XREF: kdewin32_stat+117j
		mov	[esp+5Ch+var_58], ebp ;	int
		mov	[esp+5Ch+Str], esi ; char *
		call	strndup
		mov	byte ptr [eax+ebp-1], 0
		jmp	short loc_679C29AE
; ---------------------------------------------------------------------------

loc_679C29E4:				; CODE XREF: kdewin32_stat+6Aj
		mov	ecx, 9
		xor	eax, eax
		mov	edi, ebx
		rep stosd
		jmp	loc_679C295E
; ---------------------------------------------------------------------------

loc_679C29F4:				; CODE XREF: kdewin32_stat+100j
		xor	ebp, ebp
		mov	eax, esi
		jmp	loc_679C2904
kdewin32_stat	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  48. kdewin32_freopen

; =============== S U B	R O U T	I N E =======================================


; int __cdecl kdewin32_freopen(char *Filename, char *, FILE *File)
		public kdewin32_freopen
kdewin32_freopen proc near

Str		= dword	ptr -2Ch
Source		= dword	ptr -28h
Count		= dword	ptr -24h
Dest		= byte ptr -10h
var_F		= byte ptr -0Fh
var_E		= byte ptr -0Eh
var_D		= byte ptr -0Dh
var_8		= dword	ptr -8
var_4		= dword	ptr -4
Filename	= dword	ptr  4
arg_4		= dword	ptr  8
File		= dword	ptr  0Ch

		sub	esp, 2Ch
		mov	[esp+2Ch+var_8], ebx
		mov	ebx, [esp+2Ch+arg_4]
		mov	[esp+2Ch+var_4], esi
		cmp	byte ptr [ebx],	0
		jz	short loc_679C2A21
		mov	[esp+2Ch+Str], ebx ; Str
		call	strlen
		cmp	eax, 3
		jbe	short loc_679C2A30

loc_679C2A21:				; CODE XREF: kdewin32_freopen+12j
		xor	eax, eax
		mov	ebx, [esp+2Ch+var_8]
		mov	esi, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C2A30:				; CODE XREF: kdewin32_freopen+1Fj
		lea	esi, [esp+2Ch+Dest]
		mov	[esp+2Ch+Count], 3 ; Count
		mov	[esp+2Ch+Source], ebx ;	Source
		mov	[esp+2Ch+Str], esi ; Dest
		call	strncpy
		movzx	eax, [esp+2Ch+Dest]
		cmp	al, 62h
		jz	short loc_679C2A97
		movzx	edx, [esp+2Ch+var_F]
		cmp	dl, 62h
		jz	short loc_679C2A97
		cmp	al, 74h
		jz	short loc_679C2A97
		cmp	dl, 74h
		jz	short loc_679C2A97
		cmp	dl, 2Bh
		jz	short loc_679C2AA6
		mov	[esp+2Ch+var_F], 62h
		mov	[esp+2Ch+var_E], 0

loc_679C2A73:				; CODE XREF: kdewin32_freopen+A4j
					; kdewin32_freopen+B5j
		mov	eax, [esp+2Ch+File]
		mov	[esp+2Ch+Source], esi ;	Mode
		mov	[esp+2Ch+Count], eax ; File
		mov	eax, [esp+2Ch+Filename]
		mov	[esp+2Ch+Str], eax ; Filename
		call	freopen
		mov	ebx, [esp+2Ch+var_8]
		mov	esi, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_679C2A97:				; CODE XREF: kdewin32_freopen+4Fj
					; kdewin32_freopen+59j	...
		mov	[esp+2Ch+Str], ebx ; Str
		call	strlen
		mov	[esp+eax+2Ch+Dest], 0
		jmp	short loc_679C2A73
; ---------------------------------------------------------------------------

loc_679C2AA6:				; CODE XREF: kdewin32_freopen+67j
		mov	[esp+2Ch+var_F], 62h
		mov	[esp+2Ch+var_E], 2Bh
		mov	[esp+2Ch+var_D], 0
		jmp	short loc_679C2A73
kdewin32_freopen endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  44. kdewin32_fdopen

; =============== S U B	R O U T	I N E =======================================


; int __cdecl kdewin32_fdopen(int FileHandle, char *)
		public kdewin32_fdopen
kdewin32_fdopen	proc near

Str		= dword	ptr -2Ch
Source		= dword	ptr -28h
Count		= dword	ptr -24h
Dest		= byte ptr -10h
var_F		= byte ptr -0Fh
var_E		= byte ptr -0Eh
var_D		= byte ptr -0Dh
var_8		= dword	ptr -8
var_4		= dword	ptr -4
FileHandle	= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 2Ch
		mov	[esp+2Ch+var_8], ebx
		mov	ebx, [esp+2Ch+arg_4]
		mov	[esp+2Ch+var_4], esi
		cmp	byte ptr [ebx],	0
		jz	short loc_679C2AE1
		mov	[esp+2Ch+Str], ebx ; Str
		call	strlen
		cmp	eax, 3
		jbe	short loc_679C2AF0

loc_679C2AE1:				; CODE XREF: kdewin32_fdopen+12j
		xor	eax, eax
		mov	ebx, [esp+2Ch+var_8]
		mov	esi, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C2AF0:				; CODE XREF: kdewin32_fdopen+1Fj
		lea	esi, [esp+2Ch+Dest]
		mov	[esp+2Ch+Count], 3 ; Count
		mov	[esp+2Ch+Source], ebx ;	Source
		mov	[esp+2Ch+Str], esi ; Dest
		call	strncpy
		movzx	eax, [esp+2Ch+Dest]
		cmp	al, 62h
		jz	short loc_679C2B50
		movzx	edx, [esp+2Ch+var_F]
		cmp	dl, 62h
		jz	short loc_679C2B50
		cmp	al, 74h
		jz	short loc_679C2B50
		cmp	dl, 74h
		jz	short loc_679C2B50
		cmp	dl, 2Bh
		jz	short loc_679C2B60
		mov	[esp+2Ch+var_F], 62h
		mov	[esp+2Ch+var_E], 0

loc_679C2B33:				; CODE XREF: kdewin32_fdopen+9Dj
					; kdewin32_fdopen+AFj
		mov	eax, [esp+2Ch+FileHandle]
		mov	[esp+2Ch+Source], esi ;	Format
		mov	[esp+2Ch+Str], eax ; FileHandle
		call	_fdopen
		mov	ebx, [esp+2Ch+var_8]
		mov	esi, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C2B50:				; CODE XREF: kdewin32_fdopen+4Fj
					; kdewin32_fdopen+59j ...
		mov	[esp+2Ch+Str], ebx ; Str
		call	strlen
		mov	[esp+eax+2Ch+Dest], 0
		jmp	short loc_679C2B33
; ---------------------------------------------------------------------------
		align 10h

loc_679C2B60:				; CODE XREF: kdewin32_fdopen+67j
		mov	[esp+2Ch+var_F], 62h
		mov	[esp+2Ch+var_E], 2Bh
		mov	[esp+2Ch+var_D], 0
		jmp	short loc_679C2B33
kdewin32_fdopen	endp

; ---------------------------------------------------------------------------
		jmp	short kdewin32_fopen
; ---------------------------------------------------------------------------
		align 10h
; Exported entry  47. kdewin32_fopen

; =============== S U B	R O U T	I N E =======================================


; int __cdecl kdewin32_fopen(char *Filename, char *)
		public kdewin32_fopen
kdewin32_fopen	proc near		; CODE XREF: .text:679C2B71j

Str		= dword	ptr -2Ch
Source		= dword	ptr -28h
Count		= dword	ptr -24h
Dest		= byte ptr -10h
var_F		= byte ptr -0Fh
var_E		= byte ptr -0Eh
var_D		= byte ptr -0Dh
var_8		= dword	ptr -8
var_4		= dword	ptr -4
Filename	= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 2Ch
		mov	[esp+2Ch+var_8], ebx
		mov	ebx, [esp+2Ch+arg_4]
		mov	[esp+2Ch+var_4], esi
		cmp	byte ptr [ebx],	0
		jz	short loc_679C2BA1
		mov	[esp+2Ch+Str], ebx ; Str
		call	strlen
		cmp	eax, 3
		jbe	short loc_679C2BB0

loc_679C2BA1:				; CODE XREF: kdewin32_fopen+12j
		xor	eax, eax
		mov	ebx, [esp+2Ch+var_8]
		mov	esi, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C2BB0:				; CODE XREF: kdewin32_fopen+1Fj
		lea	esi, [esp+2Ch+Dest]
		mov	[esp+2Ch+Count], 3 ; Count
		mov	[esp+2Ch+Source], ebx ;	Source
		mov	[esp+2Ch+Str], esi ; Dest
		call	strncpy
		movzx	eax, [esp+2Ch+Dest]
		cmp	al, 62h
		jz	short loc_679C2C10
		movzx	edx, [esp+2Ch+var_F]
		cmp	dl, 62h
		jz	short loc_679C2C10
		cmp	al, 74h
		jz	short loc_679C2C10
		cmp	dl, 74h
		jz	short loc_679C2C10
		cmp	dl, 2Bh
		jz	short loc_679C2C20
		mov	[esp+2Ch+var_F], 62h
		mov	[esp+2Ch+var_E], 0

loc_679C2BF3:				; CODE XREF: kdewin32_fopen+9Dj
					; kdewin32_fopen+AFj
		mov	eax, [esp+2Ch+Filename]
		mov	[esp+2Ch+Source], esi ;	Mode
		mov	[esp+2Ch+Str], eax ; Filename
		call	fopen
		mov	ebx, [esp+2Ch+var_8]
		mov	esi, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C2C10:				; CODE XREF: kdewin32_fopen+4Fj
					; kdewin32_fopen+59j ...
		mov	[esp+2Ch+Str], ebx ; Str
		call	strlen
		mov	[esp+eax+2Ch+Dest], 0
		jmp	short loc_679C2BF3
; ---------------------------------------------------------------------------
		align 10h

loc_679C2C20:				; CODE XREF: kdewin32_fopen+67j
		mov	[esp+2Ch+var_F], 62h
		mov	[esp+2Ch+var_E], 2Bh
		mov	[esp+2Ch+var_D], 0
		jmp	short loc_679C2BF3
kdewin32_fopen	endp

; ---------------------------------------------------------------------------
		jmp	short kdewin32_lstat
; ---------------------------------------------------------------------------
		align 10h
; Exported entry  49. kdewin32_lstat

; =============== S U B	R O U T	I N E =======================================


; int __cdecl kdewin32_lstat(char *, int)
		public kdewin32_lstat
kdewin32_lstat	proc near		; CODE XREF: .text:679C2C31j

Str		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 5Ch
		mov	[esp+5Ch+var_C], esi
		mov	esi, [esp+5Ch+arg_0]
		mov	[esp+5Ch+var_10], ebx
		mov	ebx, [esp+5Ch+arg_4]
		mov	[esp+5Ch+var_4], ebp
		mov	[esp+5Ch+var_8], edi
		mov	[esp+5Ch+Str], esi ; Str
		call	strlen
		mov	ebp, eax
		lea	eax, [eax-2]
		cmp	eax, 1
		ja	short loc_679C2C87
		cmp	byte ptr [esi+1], 3Ah
		jnz	short loc_679C2C87
		movsx	eax, byte ptr [esi]
		mov	[esp+5Ch+Str], eax ; C
		call	ds:isalpha
		test	eax, eax
		jnz	loc_679C2D18

loc_679C2C87:				; CODE XREF: kdewin32_lstat+2Bj
					; kdewin32_lstat+31j
		cmp	ebp, 1
		jg	loc_679C2D50

loc_679C2C90:				; CODE XREF: kdewin32_lstat+DBj
					; kdewin32_lstat+11Bj
		mov	eax, esi
		xor	ebp, ebp

loc_679C2C94:				; CODE XREF: kdewin32_lstat+104j
					; kdewin32_lstat+148j
		lea	edx, [esp+5Ch+var_40]
		mov	[esp+5Ch+var_58], edx
		mov	[esp+5Ch+Str], eax
		call	ds:_stat
		cmp	eax, 0FFFFFFFFh
		mov	esi, eax
		jz	loc_679C2D74
		mov	eax, [esp+5Ch+var_40]
		mov	[ebx], eax
		mov	eax, [esp+5Ch+var_3C]
		mov	[ebx+4], eax
		mov	eax, [esp+5Ch+var_38]
		mov	[ebx+8], eax
		mov	eax, [esp+5Ch+var_34]
		mov	[ebx+0Ch], eax
		mov	eax, [esp+5Ch+var_30]
		mov	[ebx+10h], eax
		mov	eax, [esp+5Ch+var_2C]
		mov	[ebx+14h], eax
		mov	eax, [esp+5Ch+var_28]
		mov	[ebx+18h], eax
		mov	eax, [esp+5Ch+var_24]
		mov	[ebx+1Ch], eax
		mov	eax, [esp+5Ch+var_20]
		mov	[ebx+20h], eax

loc_679C2CEE:				; CODE XREF: kdewin32_lstat+13Fj
		mov	[esp+5Ch+Str], ebp ; Memory
		call	free
		mov	eax, esi
		mov	word ptr [ebx+0Ah], 0FFFEh
		mov	word ptr [ebx+0Ch], 0FFFEh
		mov	ebx, [esp+5Ch+var_10]
		mov	esi, [esp+5Ch+var_C]
		mov	edi, [esp+5Ch+var_8]
		mov	ebp, [esp+5Ch+var_4]
		add	esp, 5Ch
		retn
; ---------------------------------------------------------------------------

loc_679C2D18:				; CODE XREF: kdewin32_lstat+41j
		cmp	ebp, 3
		jz	loc_679C2C90
		mov	[esp+5Ch+Str], 4 ; Size
		call	malloc
		movzx	edx, byte ptr [esi]
		mov	byte ptr [eax+1], 3Ah
		mov	[eax], dl
		mov	byte ptr [eax+2], 5Ch
		mov	byte ptr [eax+3], 0

loc_679C2D3E:				; CODE XREF: kdewin32_lstat+132j
		test	eax, eax
		jz	short loc_679C2D84
		mov	ebp, eax
		jmp	loc_679C2C94
; ---------------------------------------------------------------------------
		align 10h

loc_679C2D50:				; CODE XREF: kdewin32_lstat+4Aj
		movzx	eax, byte ptr [esi+ebp-1]
		cmp	al, 2Fh
		jz	short loc_679C2D61
		cmp	al, 5Ch
		jnz	loc_679C2C90

loc_679C2D61:				; CODE XREF: kdewin32_lstat+117j
		mov	[esp+5Ch+var_58], ebp ;	int
		mov	[esp+5Ch+Str], esi ; char *
		call	strndup
		mov	byte ptr [eax+ebp-1], 0
		jmp	short loc_679C2D3E
; ---------------------------------------------------------------------------

loc_679C2D74:				; CODE XREF: kdewin32_lstat+6Aj
		mov	ecx, 9
		xor	eax, eax
		mov	edi, ebx
		rep stosd
		jmp	loc_679C2CEE
; ---------------------------------------------------------------------------

loc_679C2D84:				; CODE XREF: kdewin32_lstat+100j
		xor	ebp, ebp
		mov	eax, esi
		jmp	loc_679C2C94
kdewin32_lstat	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  63. munmap

; =============== S U B	R O U T	I N E =======================================


		public munmap
munmap		proc near

lpBaseAddress	= dword	ptr -1Ch
arg_0		= dword	ptr  4

		push	edi
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 10h
		mov	edx, ds:dword_679CA008
		mov	ecx, [esp+1Ch+arg_0]
		test	edx, edx
		jle	short loc_679C2DD6
		mov	edi, ds:Memory
		mov	esi, 0Ch
		mov	eax, [edi+8]
		cmp	eax, ecx
		jnz	short loc_679C2DCF
		jmp	loc_679C2EE6
; ---------------------------------------------------------------------------
		align 10h

loc_679C2DC0:				; CODE XREF: munmap+44j
		cmp	[edi+esi+8], ecx
		lea	eax, [esi+0Ch]
		jz	loc_679C2EA2
		mov	esi, eax

loc_679C2DCF:				; CODE XREF: munmap+26j
		add	ebx, 1
		cmp	ebx, edx
		jl	short loc_679C2DC0

loc_679C2DD6:				; CODE XREF: munmap+14j
		cmp	ebx, edx
		jz	loc_679C2ED3
		mov	eax, ds:Memory
		lea	esi, [ebx+ebx*2]
		add	ebx, 1
		shl	esi, 2
		mov	eax, [eax+esi+8]

loc_679C2DF0:				; CODE XREF: munmap+117j munmap+15Dj
		mov	[esp+1Ch+lpBaseAddress], eax ; lpBaseAddress
		call	ds:UnmapViewOfFile
		mov	eax, ds:Memory
		mov	edi, ds:CloseHandle
		mov	eax, [eax+esi+4]
		sub	esp, 4
		mov	[esp+1Ch+lpBaseAddress], eax ; hObject
		call	edi ; CloseHandle
		mov	eax, ds:Memory
		mov	eax, [eax+esi]
		sub	esp, 4
		mov	[esp+1Ch+lpBaseAddress], eax ; hObject
		call	edi ; CloseHandle
		sub	esp, 4
		mov	[esp+1Ch+lpBaseAddress], offset	CriticalSection	; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_679CA008
		sub	esp, 4
		cmp	eax, ebx
		jle	short loc_679C2E7D
		lea	esi, [ebx+ebx*2]
		lea	ecx, [ebx+ebx*2-3]
		shl	esi, 2
		shl	ecx, 2
		lea	esi, [esi+0]

loc_679C2E50:				; CODE XREF: munmap+EBj
		mov	edx, ds:Memory
		add	ebx, 1
		lea	eax, [edx+ecx]
		add	edx, esi
		mov	edi, [edx]
		add	esi, 0Ch
		add	ecx, 0Ch
		mov	[eax], edi
		mov	edi, [edx+4]
		mov	[eax+4], edi
		mov	edx, [edx+8]
		mov	[eax+8], edx
		mov	eax, ds:dword_679CA008
		cmp	eax, ebx
		jg	short loc_679C2E50

loc_679C2E7D:				; CODE XREF: munmap+AAj
		sub	eax, 1
		test	eax, eax
		mov	ds:dword_679CA008, eax
		jz	short loc_679C2EB0

loc_679C2E89:				; CODE XREF: munmap+141j
		mov	[esp+1Ch+lpBaseAddress], offset	CriticalSection	; lpCriticalSection
		call	ds:LeaveCriticalSection
		xor	eax, eax
		sub	esp, 4

loc_679C2E9B:				; CODE XREF: munmap+154j
		add	esp, 10h
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_679C2EA2:				; CODE XREF: munmap+37j
		add	ebx, 1
		mov	eax, ecx
		jmp	loc_679C2DF0
; ---------------------------------------------------------------------------
		align 10h

loc_679C2EB0:				; CODE XREF: munmap+F7j
		mov	eax, ds:Memory
		mov	[esp+1Ch+lpBaseAddress], eax ; Memory
		call	free
		mov	ds:Memory, 0
		mov	dword_679C8010,	0
		jmp	short loc_679C2E89
; ---------------------------------------------------------------------------

loc_679C2ED3:				; CODE XREF: munmap+48j
		mov	[esp+1Ch+lpBaseAddress], 16h
		call	_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	short loc_679C2E9B
; ---------------------------------------------------------------------------

loc_679C2EE6:				; CODE XREF: munmap+28j
		mov	ebx, 1
		xor	esi, esi
		jmp	loc_679C2DF0
munmap		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  62. mmap

; =============== S U B	R O U T	I N E =======================================


; int __cdecl mmap(int,	DWORD dwMaximumSizeLow,	int, int, HANDLE hSourceHandle,	DWORD dwFileOffsetLow)
		public mmap
mmap		proc near

hObject		= dword	ptr -5Ch
lpdwFlags	= dword	ptr -58h
hTargetProcessHandle= dword ptr	-54h
lpTargetHandle	= dword	ptr -50h
dwDesiredAccess	= dword	ptr -4Ch
bInheritHandle	= dword	ptr -48h
dwOptions	= dword	ptr -44h
var_30		= dword	ptr -30h
TargetHandle	= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
dwFlags		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
dwMaximumSizeLow= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
hSourceHandle	= dword	ptr  14h
dwFileOffsetLow	= dword	ptr  18h

		sub	esp, 5Ch
		cmp	dword_679C8010,	0FFFFFFFFh
		mov	[esp+5Ch+var_C], esi
		mov	esi, [esp+5Ch+hSourceHandle]
		mov	[esp+5Ch+var_8], edi
		mov	edi, [esp+5Ch+arg_8]
		mov	[esp+5Ch+var_10], ebx
		mov	[esp+5Ch+var_4], ebp
		jz	loc_679C3180

loc_679C2F28:				; CODE XREF: mmap+29Aj
		test	edi, 1
		jz	loc_679C2FF0
		test	edi, 2
		jz	loc_679C3020
		and	edi, 4
		mov	ebp, 2
		cmp	edi, 1
		sbb	ebx, ebx
		and	ebx, 0FFFFFFC4h
		add	ebx, 40h

loc_679C2F53:				; CODE XREF: mmap+100j	mmap+115j ...
		cmp	[esp+5Ch+arg_C], 10h
		jz	loc_679C3048
		cmp	esi, 0FFFFFFFFh
		jz	loc_679C3168
		lea	eax, [esp+5Ch+dwFlags]
		mov	[esp+5Ch+lpdwFlags], eax ; lpdwFlags
		mov	[esp+5Ch+hObject], esi ; hObject
		call	ds:GetHandleInformation
		sub	esp, 8
		test	eax, eax
		jz	loc_679C3140

loc_679C2F83:				; CODE XREF: mmap+25Dj
		mov	edi, ds:GetCurrentProcess
		call	edi ; GetCurrentProcess
		mov	[esp+5Ch+var_30], eax
		call	edi ; GetCurrentProcess
		mov	edx, [esp+5Ch+var_30]
		lea	ecx, [esp+5Ch+TargetHandle]
		mov	[esp+5Ch+dwOptions], 2 ; dwOptions
		mov	[esp+5Ch+bInheritHandle], 0 ; bInheritHandle
		mov	[esp+5Ch+dwDesiredAccess], 0 ; dwDesiredAccess
		mov	[esp+5Ch+lpTargetHandle], ecx ;	lpTargetHandle
		mov	[esp+5Ch+hTargetProcessHandle],	edx ; hTargetProcessHandle
		mov	[esp+5Ch+lpdwFlags], esi ; hSourceHandle
		mov	[esp+5Ch+hObject], eax ; hSourceProcessHandle
		call	ds:DuplicateHandle
		sub	esp, 1Ch
		test	eax, eax
		jnz	loc_679C3060

loc_679C2FD1:				; CODE XREF: mmap+249j	mmap+263j
		mov	eax, 0FFFFFFFFh

loc_679C2FD6:				; CODE XREF: mmap+146j	mmap+159j ...
		mov	ebx, [esp+5Ch+var_10]
		mov	esi, [esp+5Ch+var_C]
		mov	edi, [esp+5Ch+var_8]
		mov	ebp, [esp+5Ch+var_4]
		add	esp, 5Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C2FF0:				; CODE XREF: mmap+2Ej
		test	edi, 2
		mov	ebx, 8
		mov	ebp, 1
		jnz	loc_679C2F53
		and	edi, 4
		jz	short loc_679C3035

loc_679C300B:				; CODE XREF: mmap+133j
		mov	ebx, 20h
		mov	ebp, 20h
		jmp	loc_679C2F53
; ---------------------------------------------------------------------------
		align 10h

loc_679C3020:				; CODE XREF: mmap+3Aj
		and	edi, 4
		mov	ebx, 2
		mov	ebp, 4
		jz	loc_679C2F53
		jmp	short loc_679C300B
; ---------------------------------------------------------------------------

loc_679C3035:				; CODE XREF: mmap+109j	mmap+2CCj
		mov	[esp+5Ch+hObject], 16h
		call	_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	short loc_679C2FD6
; ---------------------------------------------------------------------------

loc_679C3048:				; CODE XREF: mmap+58j
		mov	[esp+5Ch+hObject], 28h
		call	_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	loc_679C2FD6
; ---------------------------------------------------------------------------
		align 10h

loc_679C3060:				; CODE XREF: mmap+CBj
		mov	eax, [esp+5Ch+dwMaximumSizeLow]
		mov	[esp+5Ch+bInheritHandle], 0 ; lpName
		mov	[esp+5Ch+lpTargetHandle], 0 ; dwMaximumSizeHigh
		mov	[esp+5Ch+hTargetProcessHandle],	ebx ; flProtect
		mov	[esp+5Ch+dwDesiredAccess], eax ; dwMaximumSizeLow
		mov	eax, [esp+5Ch+TargetHandle]
		mov	[esp+5Ch+lpdwFlags], 0 ; lpFileMappingAttributes
		mov	[esp+5Ch+hObject], eax ; hFile
		call	ds:CreateFileMappingW
		sub	esp, 18h
		test	eax, eax
		mov	[esp+5Ch+var_28], eax
		jz	loc_679C3213
		mov	edx, [esp+5Ch+dwFileOffsetLow]
		mov	[esp+5Ch+dwDesiredAccess], 0 ; dwNumberOfBytesToMap
		mov	[esp+5Ch+hTargetProcessHandle],	0 ; dwFileOffsetHigh
		mov	[esp+5Ch+lpdwFlags], ebp ; dwDesiredAccess
		mov	[esp+5Ch+lpTargetHandle], edx ;	dwFileOffsetLow
		mov	[esp+5Ch+hObject], eax ; hFileMappingObject
		call	ds:MapViewOfFile
		sub	esp, 14h
		test	eax, eax
		mov	[esp+5Ch+var_24], eax
		jz	loc_679C31A0
		mov	[esp+5Ch+hObject], offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, ds:Memory
		sub	esp, 4
		test	eax, eax
		jz	loc_679C3239

loc_679C30F1:				; CODE XREF: mmap+35Cj
		mov	edx, ds:dword_679CA008
		cmp	edx, dword_679C8010
		jz	loc_679C31E8

loc_679C3103:				; CODE XREF: mmap+30Ej
		lea	edx, [edx+edx*2]
		lea	eax, [eax+edx*4]
		mov	edx, [esp+5Ch+TargetHandle]
		mov	[eax], edx
		mov	edx, [esp+5Ch+var_28]
		mov	[eax+4], edx
		mov	edx, [esp+5Ch+var_24]
		mov	[eax+8], edx
		add	ds:dword_679CA008, 1
		mov	[esp+5Ch+hObject], offset CriticalSection ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		mov	eax, [esp+5Ch+var_24]
		jmp	loc_679C2FD6
; ---------------------------------------------------------------------------
		align 10h

loc_679C3140:				; CODE XREF: mmap+7Dj
		call	ds:GetLastError
		cmp	eax, 6
		jnz	loc_679C2FD1
		mov	[esp+5Ch+hObject], esi
		call	ds:_get_osfhandle
		cmp	eax, 0FFFFFFFFh
		mov	esi, eax
		jnz	loc_679C2F83
		jmp	loc_679C2FD1
; ---------------------------------------------------------------------------

loc_679C3168:				; CODE XREF: mmap+61j
		mov	[esp+5Ch+hObject], 9
		nop
		call	_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	loc_679C2FD6
; ---------------------------------------------------------------------------
		align 10h

loc_679C3180:				; CODE XREF: mmap+22j
		mov	dword_679C8010,	0
		mov	[esp+5Ch+hObject], offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	loc_679C2F28
; ---------------------------------------------------------------------------
		align 10h

loc_679C31A0:				; CODE XREF: mmap+1CEj
		call	ds:GetLastError
		mov	ebx, ds:CloseHandle
		mov	esi, eax
		mov	eax, [esp+5Ch+var_28]
		mov	[esp+5Ch+hObject], eax ; hObject
		call	ebx ; CloseHandle
		sub	esp, 4
		mov	eax, [esp+5Ch+TargetHandle]
		mov	[esp+5Ch+hObject], eax ; hObject
		call	ebx ; CloseHandle
		sub	esp, 4
		cmp	esi, 46Ch
		jz	loc_679C3035
		mov	[esp+5Ch+hObject], 0Dh
		call	_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	loc_679C2FD6
; ---------------------------------------------------------------------------

loc_679C31E8:				; CODE XREF: mmap+1FDj
		add	edx, 0Ah
		mov	dword_679C8010,	edx
		lea	edx, [edx+edx*2]
		shl	edx, 2
		mov	[esp+5Ch+lpdwFlags], edx ; NewSize
		mov	[esp+5Ch+hObject], eax ; Memory
		call	realloc
		mov	edx, ds:dword_679CA008
		mov	ds:Memory, eax
		jmp	loc_679C3103
; ---------------------------------------------------------------------------

loc_679C3213:				; CODE XREF: mmap+19Aj
		mov	eax, [esp+5Ch+TargetHandle]
		mov	[esp+5Ch+hObject], eax ; hObject
		call	ds:CloseHandle
		sub	esp, 4
		mov	[esp+5Ch+hObject], 0Dh
		call	_set_errno
		mov	eax, 0FFFFFFFFh
		jmp	loc_679C2FD6
; ---------------------------------------------------------------------------

loc_679C3239:				; CODE XREF: mmap+1EBj
		mov	dword_679C8010,	0Ah
		mov	[esp+5Ch+lpdwFlags], 0Ch ; SizeOfElements
		mov	[esp+5Ch+hObject], 0Ah ; NumOfElements
		call	calloc
		mov	ds:Memory, eax
		jmp	loc_679C30F1
mmap		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  64. nl_langinfo

; =============== S U B	R O U T	I N E =======================================


		public nl_langinfo
nl_langinfo	proc near

VarName		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	edx, [esp+1Ch+arg_0]
		lea	ecx, [edx-7]
		lea	eax, [edx+edx*4]
		cmp	ecx, 6
		lea	eax, (off_679C90EC+0AEh)[eax+eax]
		jbe	short loc_679C32B6
		lea	ecx, [edx-0Eh]
		cmp	ecx, 6
		lea	eax, aSun_0[ecx*4] ; "Sun"
		jbe	short loc_679C32B6
		lea	eax, [edx-15h]
		cmp	eax, 0Bh
		jbe	short loc_679C32C7
		lea	ecx, [edx-21h]
		cmp	ecx, 0Bh
		lea	eax, dword_679C92E0[ecx*4]
		jbe	short loc_679C32B6
		cmp	edx, 36h	; switch 55 cases
		jbe	short loc_679C32C0

loc_679C32B4:				; CODE XREF: nl_langinfo:loc_679C32C0j
					; DATA XREF: .rdata:off_679C90ECo
		xor	eax, eax	; jumptable 679C32C0 default case

loc_679C32B6:				; CODE XREF: nl_langinfo+17j
					; nl_langinfo+26j ...
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C32C0:				; CODE XREF: nl_langinfo+42j
		jmp	ds:off_679C90EC[edx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_679C32C7:				; CODE XREF: nl_langinfo+2Ej
		mov	eax, ds:off_679C92A0[eax*4]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_679C32D2:				; CODE XREF: nl_langinfo:loc_679C32C0j
					; DATA XREF: .rdata:off_679C90ECo
		mov	eax, offset byte_679C90D8 ; jumptable 679C32C0 cases 46-49,51
		jmp	short loc_679C32B6
; ---------------------------------------------------------------------------

loc_679C32D9:				; CODE XREF: nl_langinfo:loc_679C32C0j
					; DATA XREF: .rdata:off_679C90ECo
		mov	eax, offset aYy	; jumptable 679C32C0 case 52
		jmp	short loc_679C32B6
; ---------------------------------------------------------------------------

loc_679C32E0:				; CODE XREF: nl_langinfo:loc_679C32C0j
					; DATA XREF: .rdata:off_679C90ECo
		mov	eax, offset byte_679C90D9 ; jumptable 679C32C0 case 50
		jmp	short loc_679C32B6
; ---------------------------------------------------------------------------

loc_679C32E7:				; CODE XREF: nl_langinfo:loc_679C32C0j
					; DATA XREF: .rdata:off_679C90ECo
		mov	eax, offset aNn	; jumptable 679C32C0 case 53
		jmp	short loc_679C32B6
; ---------------------------------------------------------------------------

loc_679C32EE:				; CODE XREF: nl_langinfo:loc_679C32C0j
					; DATA XREF: .rdata:off_679C90ECo
		mov	eax, offset aPm_0 ; jumptable 679C32C0 case 6
		jmp	short loc_679C32B6
; ---------------------------------------------------------------------------

loc_679C32F5:				; CODE XREF: nl_langinfo:loc_679C32C0j
					; DATA XREF: .rdata:off_679C90ECo
		mov	eax, offset aAm_0 ; jumptable 679C32C0 case 5
		jmp	short loc_679C32B6
; ---------------------------------------------------------------------------

loc_679C32FC:				; CODE XREF: nl_langinfo:loc_679C32C0j
					; DATA XREF: .rdata:off_679C90ECo
		mov	eax, offset aIMSP ; jumptable 679C32C0 case 4
		jmp	short loc_679C32B6
; ---------------------------------------------------------------------------

loc_679C3303:				; CODE XREF: nl_langinfo:loc_679C32C0j
					; DATA XREF: .rdata:off_679C90ECo
		mov	eax, offset aHM	; jumptable 679C32C0 case 3
		jmp	short loc_679C32B6
; ---------------------------------------------------------------------------

loc_679C330A:				; CODE XREF: nl_langinfo:loc_679C32C0j
					; DATA XREF: .rdata:off_679C90ECo
		mov	eax, offset aBAD ; jumptable 679C32C0 case 2
		jmp	short loc_679C32B6
; ---------------------------------------------------------------------------

loc_679C3311:				; CODE XREF: nl_langinfo:loc_679C32C0j
					; DATA XREF: .rdata:off_679C90ECo
		mov	eax, offset aBADKMSZY ;	jumptable 679C32C0 case	1
		jmp	short loc_679C32B6
; ---------------------------------------------------------------------------

loc_679C3318:				; CODE XREF: nl_langinfo:loc_679C32C0j
					; DATA XREF: .rdata:off_679C90ECo
		mov	[esp+1Ch+VarName], offset VarName ; jumptable 679C32C0 case 0
		call	getenv
		test	eax, eax
		jnz	short loc_679C32B6
		mov	[esp+1Ch+VarName], offset aLc_all ; "LC_ALL"
		call	getenv
		test	eax, eax
		jnz	loc_679C32B6
		mov	eax, offset aAnsi_x3_41968 ; "ANSI_X3.4-1968"
		jmp	loc_679C32B6
; ---------------------------------------------------------------------------

loc_679C3346:				; CODE XREF: nl_langinfo:loc_679C32C0j
					; DATA XREF: .rdata:off_679C90ECo
		mov	eax, offset asc_679C90E7 ; jumptable 679C32C0 case 54
		jmp	loc_679C32B6
nl_langinfo	endp

; Exported entry  35. htonl

; =============== S U B	R O U T	I N E =======================================


; u_long __stdcall htonl(u_long	hostlong)
		public htonl
htonl		proc near

hostlong	= dword	ptr  4

		mov	edx, [esp+hostlong]
		mov	eax, edx
		mov	ecx, edx
		shl	ecx, 18h
		shr	eax, 18h
		or	eax, ecx
		mov	ecx, edx
		and	ecx, 0FF00h
		and	edx, 0FF0000h
		shl	ecx, 8
		or	eax, ecx
		shr	edx, 8
		or	eax, edx
		retn
htonl		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  65. ntohl

; =============== S U B	R O U T	I N E =======================================


; u_long __stdcall ntohl(u_long	netlong)
		public ntohl
ntohl		proc near

netlong		= dword	ptr  4

		mov	edx, [esp+netlong]
		mov	eax, edx
		mov	ecx, edx
		shl	ecx, 18h
		shr	eax, 18h
		or	eax, ecx
		mov	ecx, edx
		and	ecx, 0FF00h
		and	edx, 0FF0000h
		shl	ecx, 8
		or	eax, ecx
		shr	edx, 8
		or	eax, edx
		retn
ntohl		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  36. htons

; =============== S U B	R O U T	I N E =======================================


; u_short __stdcall htons(u_short hostshort)
		public htons
htons		proc near

hostshort	= word ptr  4

		movzx	eax, [esp+hostshort]
		rol	ax, 8
		retn
htons		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  66. ntohs

; =============== S U B	R O U T	I N E =======================================


; u_short __stdcall ntohs(u_short netshort)
		public ntohs
ntohs		proc near

netshort	= word ptr  4

		movzx	eax, [esp+netshort]
		rol	ax, 8
		retn
ntohs		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  27. getpwnam

; =============== S U B	R O U T	I N E =======================================


		public getpwnam
getpwnam	proc near
		mov	eax, offset off_679C8020
		retn
getpwnam	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  28. getpwuid

; =============== S U B	R O U T	I N E =======================================


		public getpwuid
getpwuid	proc near
		mov	eax, offset off_679C8020
		retn
getpwuid	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  79. setpwent

; =============== S U B	R O U T	I N E =======================================


		public setpwent
setpwent	proc near
		rep retn
setpwent	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  26. getpwent

; =============== S U B	R O U T	I N E =======================================


		public getpwent
getpwent	proc near
		mov	eax, offset off_679C8020
		retn
getpwent	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  10. endpwent

; =============== S U B	R O U T	I N E =======================================


		public endpwent
endpwent	proc near
		rep retn
endpwent	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  73. realpath

; =============== S U B	R O U T	I N E =======================================


; int __cdecl realpath(LPCSTR, LPSTR)
		public realpath
realpath	proc near

lpFileName	= dword	ptr -1Ch
nBufferLength	= dword	ptr -18h
lpBuffer	= dword	ptr -14h
lpFilePart	= dword	ptr -10h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		sub	esp, 18h
		mov	ebx, [esp+1Ch+arg_4]
		mov	byte ptr [ebx],	0
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpFilePart], 0	; lpFilePart
		mov	[esp+1Ch+lpBuffer], ebx	; lpBuffer
		mov	[esp+1Ch+nBufferLength], 104h ;	nBufferLength
		mov	[esp+1Ch+lpFileName], eax ; lpFileName
		call	ds:GetFullPathNameA
		movzx	edx, byte ptr [ebx]
		sub	esp, 10h
		test	dl, dl
		jz	short loc_679C3480
		lea	eax, [ebx+1]
		mov	ecx, ebx
		jmp	short loc_679C346C
; ---------------------------------------------------------------------------
		align 10h

loc_679C3460:				; CODE XREF: realpath+4Fj
		movzx	edx, byte ptr [eax]
		mov	ecx, eax
		add	eax, 1
		test	dl, dl
		jz	short loc_679C3480

loc_679C346C:				; CODE XREF: realpath+3Bj realpath+5Ej
		cmp	dl, 5Ch
		jnz	short loc_679C3460
		mov	byte ptr [ecx],	2Fh
		movzx	edx, byte ptr [eax]
		mov	ecx, eax
		add	eax, 1
		test	dl, dl
		jnz	short loc_679C346C

loc_679C3480:				; CODE XREF: realpath+34j realpath+4Aj
		mov	eax, ebx
		add	esp, 18h
		pop	ebx
		retn
realpath	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  29. getrlimit

; =============== S U B	R O U T	I N E =======================================


		public getrlimit
getrlimit	proc near
		mov	eax, 0FFFFFFFFh
		retn
getrlimit	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  81. setrlimit

; =============== S U B	R O U T	I N E =======================================


		public setrlimit
setrlimit	proc near
		mov	eax, 0FFFFFFFFh
		retn
setrlimit	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  30. getrusage

; =============== S U B	R O U T	I N E =======================================


		public getrusage
getrusage	proc near
		mov	eax, 0FFFFFFFFh
		retn
getrusage	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  53. kdewin32_signal

; =============== S U B	R O U T	I N E =======================================


		public kdewin32_signal
kdewin32_signal	proc near

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 0Ch
		mov	eax, [esp+0Ch+arg_0]
		mov	edx, [esp+0Ch+arg_4]
		cmp	eax, 8
		jz	short loc_679C34DA
		cmp	eax, 16h
		jz	short loc_679C34DA
		cmp	eax, 2
		jnz	short loc_679C34F0

loc_679C34DA:				; CODE XREF: kdewin32_signal+Ej
					; kdewin32_signal+13j ...
		mov	[esp+0Ch+arg_4], edx
		mov	[esp+0Ch+arg_0], eax
		add	esp, 0Ch
		jmp	signal
; ---------------------------------------------------------------------------
		align 10h

loc_679C34F0:				; CODE XREF: kdewin32_signal+18j
		cmp	eax, 4
		jz	short loc_679C34DA
		cmp	eax, 0Fh
		jz	short loc_679C34DA
		cmp	eax, 0Bh
		lea	esi, [esi+0]
		jz	short loc_679C34DA
		mov	eax, 0FFFFFFFFh
		add	esp, 0Ch
		retn
kdewin32_signal	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  95. waitpid

; =============== S U B	R O U T	I N E =======================================


; int __cdecl waitpid(DWORD)
		public waitpid
waitpid		proc near

dwDesiredAccess	= dword	ptr -2Ch
bInheritHandle	= dword	ptr -28h
dwProcessId	= dword	ptr -24h
ExitCode	= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, [esp+2Ch+arg_0]
		mov	[esp+2Ch+bInheritHandle], 0 ; bInheritHandle
		mov	[esp+2Ch+dwDesiredAccess], 1 ; dwDesiredAccess
		mov	[esp+2Ch+dwProcessId], eax ; dwProcessId
		call	ds:OpenProcess
		sub	esp, 0Ch
		test	eax, eax
		mov	ebx, eax
		jz	short loc_679C3575
		mov	[esp+2Ch+bInheritHandle], 0FFFFFFFFh ; dwMilliseconds
		mov	[esp+2Ch+dwDesiredAccess], eax ; hHandle
		call	ds:WaitForSingleObject
		sub	esp, 8
		lea	eax, [esp+2Ch+ExitCode]
		mov	[esp+2Ch+bInheritHandle], eax ;	lpExitCode
		mov	[esp+2Ch+dwDesiredAccess], ebx ; hProcess
		call	ds:GetExitCodeProcess
		sub	esp, 8
		mov	[esp+2Ch+dwDesiredAccess], ebx ; hObject
		call	ds:CloseHandle
		xor	eax, eax
		sub	esp, 4

loc_679C3570:				; CODE XREF: waitpid+76j
		add	esp, 28h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_679C3575:				; CODE XREF: waitpid+28j
		call	ds:_errno
		mov	dword ptr [eax], 0Ah
		mov	eax, 0FFFFFFFFh
		jmp	short loc_679C3570
waitpid		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  34. handle_kill_result

; =============== S U B	R O U T	I N E =======================================


; int __cdecl handle_kill_result(HANDLE)
		public handle_kill_result
handle_kill_result proc	near		; CODE XREF: kill+1F2p

hObject		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 18h
		mov	ebx, ds:GetLastError
		call	ebx ; GetLastError
		cmp	eax, 5
		jz	short loc_679C35D6
		call	ebx ; GetLastError
		cmp	eax, 12h
		jz	short loc_679C35E4
		nop
		lea	esi, [esi+0]
		call	ds:_errno
		mov	dword ptr [eax], 16h

loc_679C35BC:				; CODE XREF: handle_kill_result+52j
					; handle_kill_result+60j
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+hObject], eax ; hObject
		call	ds:CloseHandle
		mov	eax, 0FFFFFFFFh
		sub	esp, 4
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_679C35D6:				; CODE XREF: handle_kill_result+Fj
		call	ds:_errno
		mov	dword ptr [eax], 1
		jmp	short loc_679C35BC
; ---------------------------------------------------------------------------

loc_679C35E4:				; CODE XREF: handle_kill_result+16j
		call	ds:_errno
		mov	dword ptr [eax], 3
		jmp	short loc_679C35BC
handle_kill_result endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  55. kill

; =============== S U B	R O U T	I N E =======================================


; int __cdecl kill(DWORD th32ProcessID,	int)
		public kill
kill		proc near

dwDesiredAccess	= dword	ptr -25Ch
bInheritHandle	= dword	ptr -258h
dwProcessId	= dword	ptr -254h
lpStartAddress	= dword	ptr -250h
lpParameter	= dword	ptr -24Ch
dwCreationFlags	= dword	ptr -248h
lpThreadId	= dword	ptr -244h
pe		= PROCESSENTRY32W ptr -23Ch
ThreadId	= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
th32ProcessID	= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 25Ch
		mov	[esp+25Ch+var_C], ebx
		mov	ebx, [esp+25Ch+arg_4]
		mov	[esp+25Ch+var_8], esi
		mov	esi, [esp+25Ch+th32ProcessID]
		mov	[esp+25Ch+var_4], edi
		test	ebx, ebx
		js	loc_679C3846
		test	esi, esi
		jle	loc_679C3846
		test	ebx, ebx
		jz	loc_679C3706
		mov	[esp+25Ch+dwProcessId],	esi ; dwProcessId
		mov	[esp+25Ch+bInheritHandle], 0 ; bInheritHandle
		mov	[esp+25Ch+dwDesiredAccess], 1F0FFFh ; dwDesiredAccess
		call	ds:OpenProcess
		sub	esp, 0Ch
		test	eax, eax
		mov	edi, eax
		jz	loc_679C385C
		cmp	ebx, 3
		jz	loc_679C3785
		cmp	ebx, 9
		jz	loc_679C3800
		cmp	ebx, 2
		lea	esi, [esi+0]
		jz	loc_679C37D7
		mov	[esp+25Ch+dwDesiredAccess], offset aKernel32_dll ; "KERNEL32.DLL"
		call	ds:GetModuleHandleA
		sub	esp, 4
		mov	[esp+25Ch+bInheritHandle], offset aExitprocess ; "ExitProcess"
		mov	[esp+25Ch+dwDesiredAccess], eax	; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		lea	edx, [esp+25Ch+ThreadId]
		mov	[esp+25Ch+lpThreadId], edx ; lpThreadId
		mov	[esp+25Ch+dwCreationFlags], 0 ;	dwCreationFlags
		mov	[esp+25Ch+lpParameter],	0 ; lpParameter
		mov	[esp+25Ch+lpStartAddress], eax ; lpStartAddress
		mov	[esp+25Ch+dwProcessId],	0 ; dwStackSize
		mov	[esp+25Ch+bInheritHandle], 0 ; lpThreadAttributes
		mov	[esp+25Ch+dwDesiredAccess], edi	; hProcess
		call	ds:CreateRemoteThread
		sub	esp, 1Ch
		test	eax, eax
		jz	loc_679C37EF
		mov	[esp+25Ch+bInheritHandle], 5 ; dwMilliseconds
		mov	[esp+25Ch+dwDesiredAccess], eax	; hHandle
		call	ds:WaitForSingleObject
		sub	esp, 8
		jmp	loc_679C379D
; ---------------------------------------------------------------------------

loc_679C3706:				; CODE XREF: kill+3Bj
		mov	[esp+25Ch+bInheritHandle], esi ; th32ProcessID
		mov	[esp+25Ch+dwDesiredAccess], 0 ;	dwFlags
		call	CreateToolhelp32Snapshot
		sub	esp, 8
		cmp	eax, 0FFFFFFFFh
		mov	ebx, eax
		jz	loc_679C386C
		lea	eax, [esp+25Ch+pe]
		mov	[esp+25Ch+pe.dwSize], 22Ch
		mov	[esp+25Ch+bInheritHandle], eax ; lppe
		mov	[esp+25Ch+dwDesiredAccess], ebx	; hSnapshot
		call	Process32FirstW
		sub	esp, 8
		test	eax, eax
		jnz	loc_679C37C7
		mov	esi, ds:GetLastError
		call	esi ; GetLastError
		cmp	eax, 5
		jz	loc_679C3820
		call	esi ; GetLastError
		cmp	eax, 12h
		lea	esi, [esi+0]
		jz	loc_679C3835
		call	ds:_errno
		mov	dword ptr [eax], 16h

loc_679C3772:				; CODE XREF: kill+230j	kill+241j
		mov	[esp+25Ch+dwDesiredAccess], ebx	; hObject
		call	ds:CloseHandle
		mov	eax, 0FFFFFFFFh
		sub	esp, 4
		jmp	short loc_679C37AB
; ---------------------------------------------------------------------------

loc_679C3785:				; CODE XREF: kill+6Aj
		mov	[esp+25Ch+bInheritHandle], esi ; dwProcessGroupId
		mov	[esp+25Ch+dwDesiredAccess], 1 ;	dwCtrlEvent
		call	ds:GenerateConsoleCtrlEvent
		sub	esp, 8
		test	eax, eax
		jz	short loc_679C37EF

loc_679C379D:				; CODE XREF: kill+101j	kill+1EDj ...
		mov	[esp+25Ch+dwDesiredAccess], edi	; hObject
		call	ds:CloseHandle
		xor	eax, eax
		sub	esp, 4

loc_679C37AB:				; CODE XREF: kill+183j	kill+1D5j ...
		mov	ebx, [esp+25Ch+var_C]
		mov	esi, [esp+25Ch+var_8]
		mov	edi, [esp+25Ch+var_4]
		add	esp, 25Ch
		retn
; ---------------------------------------------------------------------------

loc_679C37C7:				; CODE XREF: kill+141j
		mov	[esp+25Ch+dwDesiredAccess], ebx	; hObject
		call	ds:CloseHandle
		xor	eax, eax
		sub	esp, 4
		jmp	short loc_679C37AB
; ---------------------------------------------------------------------------

loc_679C37D7:				; CODE XREF: kill+80j
		mov	[esp+25Ch+bInheritHandle], esi ; dwProcessGroupId
		mov	[esp+25Ch+dwDesiredAccess], 0 ;	dwCtrlEvent
		call	ds:GenerateConsoleCtrlEvent
		sub	esp, 8
		test	eax, eax
		jnz	short loc_679C379D

loc_679C37EF:				; CODE XREF: kill+E7j kill+19Bj ...
		mov	[esp+25Ch+dwDesiredAccess], edi	; HANDLE
		call	handle_kill_result
		jmp	short loc_679C37AB
; ---------------------------------------------------------------------------
		align 10h

loc_679C3800:				; CODE XREF: kill+73j
		mov	[esp+25Ch+bInheritHandle], 9 ; uExitCode
		mov	[esp+25Ch+dwDesiredAccess], eax	; hProcess
		call	ds:TerminateProcess
		sub	esp, 8
		test	eax, eax
		jnz	short loc_679C379D
		jmp	short loc_679C37EF
; ---------------------------------------------------------------------------
		align 10h

loc_679C3820:				; CODE XREF: kill+152j
		call	ds:_errno
		mov	dword ptr [eax], 1
		lea	esi, [esi+0]
		jmp	loc_679C3772
; ---------------------------------------------------------------------------

loc_679C3835:				; CODE XREF: kill+160j
		call	ds:_errno
		mov	dword ptr [eax], 3
		jmp	loc_679C3772
; ---------------------------------------------------------------------------

loc_679C3846:				; CODE XREF: kill+2Bj kill+33j
		call	ds:_errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	loc_679C37AB
; ---------------------------------------------------------------------------

loc_679C385C:				; CODE XREF: kill+61j
		mov	[esp+25Ch+dwDesiredAccess], 0 ;	hObject
		call	ds:CloseHandle
		sub	esp, 4

loc_679C386C:				; CODE XREF: kill+11Ej
		call	ds:_errno
		mov	dword ptr [eax], 3
		mov	eax, 0FFFFFFFFh
		jmp	loc_679C37AB
kill		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  83. srandom

; =============== S U B	R O U T	I N E =======================================


		public srandom
srandom		proc near
		sub	esp, 0Ch
		add	esp, 0Ch
		jmp	srand
srandom		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  69. rand_r

; =============== S U B	R O U T	I N E =======================================


		public rand_r
rand_r		proc near

Seed		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	eax, [eax]
		mov	[esp+1Ch+Seed],	eax ; Seed
		call	srand
		add	esp, 1Ch
		jmp	rand
rand_r		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   8. drand48

; =============== S U B	R O U T	I N E =======================================


		public drand48
drand48		proc near

var_10		= dword	ptr -10h

		sub	esp, 1Ch
		call	rand
		mov	[esp+1Ch+var_10], eax
		fild	[esp+1Ch+var_10]
		fmul	ds:flt_679C9340
		add	esp, 1Ch
		retn
drand48		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  70. random

; =============== S U B	R O U T	I N E =======================================


		public random
random		proc near
		sub	esp, 0Ch
		add	esp, 0Ch
		jmp	rand
random		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  75. setenv

; =============== S U B	R O U T	I N E =======================================


; int __cdecl setenv(char *Str,	char *,	int)
		public setenv
setenv		proc near

VarName		= dword	ptr -2Ch
Source		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
Str		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 2Ch
		mov	edx, [esp+2Ch+arg_8]
		mov	[esp+2Ch+var_C], ebx
		mov	ebx, [esp+2Ch+Str]
		mov	[esp+2Ch+var_8], esi
		mov	esi, [esp+2Ch+arg_4]
		mov	[esp+2Ch+var_4], edi
		test	edx, edx
		jnz	short loc_679C3930
		mov	[esp+2Ch+VarName], ebx ; VarName
		call	getenv
		test	eax, eax
		jz	short loc_679C3930
		xor	eax, eax

loc_679C391D:				; CODE XREF: setenv+5Aj setenv+89j ...
		mov	ebx, [esp+2Ch+var_C]
		mov	esi, [esp+2Ch+var_8]
		mov	edi, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C3930:				; CODE XREF: setenv+1Dj setenv+29j
		mov	eax, ds:dword_679CA00C
		test	eax, eax
		jnz	short loc_679C3943
		mov	ds:dword_679CA00C, 1

loc_679C3943:				; CODE XREF: setenv+47j
		test	ebx, ebx
		mov	eax, 0FFFFFFFFh
		jz	short loc_679C391D
		mov	[esp+2Ch+VarName], ebx ; Str
		call	strlen
		mov	edi, eax
		xor	eax, eax
		test	esi, esi
		jz	short loc_679C3964
		mov	[esp+2Ch+VarName], esi ; Str
		call	strlen

loc_679C3964:				; CODE XREF: setenv+6Aj
		lea	eax, [eax+edi+2]
		mov	[esp+2Ch+VarName], eax ; Size
		call	malloc
		mov	edi, eax
		mov	eax, 1
		test	edi, edi
		jz	short loc_679C391D
		mov	[esp+2Ch+Source], ebx ;	Source
		mov	[esp+2Ch+VarName], edi ; Dest
		call	strcpy
		mov	[esp+2Ch+VarName], edi ; Str
		call	strlen
		test	esi, esi
		mov	word ptr [edi+eax], 3Dh
		jz	short loc_679C39A5
		mov	[esp+2Ch+Source], esi ;	Source
		mov	[esp+2Ch+VarName], edi ; Dest
		call	strcat

loc_679C39A5:				; CODE XREF: setenv+A7j
		mov	[esp+2Ch+VarName], edi ; EnvString
		call	_putenv
		mov	[esp+2Ch+VarName], edi ; Memory
		mov	[esp+2Ch+var_10], eax
		call	free
		mov	eax, [esp+2Ch+var_10]
		jmp	loc_679C391D
setenv		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  93. unsetenv

; =============== S U B	R O U T	I N E =======================================


; int __cdecl unsetenv(char *Source)
		public unsetenv
unsetenv	proc near

Str		= dword	ptr -1Ch
Val		= dword	ptr -18h
Source		= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 14h
		mov	ebx, [esp+1Ch+Source]
		test	ebx, ebx
		jz	short loc_679C3A57
		cmp	byte ptr [ebx],	0
		jz	short loc_679C3A57
		mov	[esp+1Ch+Val], 3Dh ; Val
		mov	[esp+1Ch+Str], ebx ; Str
		call	strchr
		test	eax, eax
		jnz	short loc_679C3A57
		mov	ecx, ds:dword_679CA00C
		test	ecx, ecx
		jnz	short loc_679C3A0A
		mov	ds:dword_679CA00C, 1

loc_679C3A0A:				; CODE XREF: unsetenv+2Ej
		mov	[esp+1Ch+Str], ebx ; Str
		call	strlen
		add	eax, 2
		mov	[esp+1Ch+Str], eax ; Size
		call	malloc
		mov	esi, eax
		xor	eax, eax
		test	esi, esi
		jz	short loc_679C3A51
		mov	[esp+1Ch+Val], ebx ; Source
		mov	[esp+1Ch+Str], esi ; Dest
		call	strcpy
		mov	[esp+1Ch+Str], esi ; Str
		call	strlen
		mov	word ptr [esi+eax], 3Dh
		mov	[esp+1Ch+Str], esi ; EnvString
		call	_putenv
		mov	[esp+1Ch+Str], esi ; Memory
		call	free
		xor	eax, eax

loc_679C3A51:				; CODE XREF: unsetenv+53j
		add	esp, 14h
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_679C3A57:				; CODE XREF: unsetenv+Bj unsetenv+10j	...
		call	ds:_errno
		mov	dword ptr [eax], 16h
		add	esp, 14h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn
unsetenv	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  84. strcasestr

; =============== S U B	R O U T	I N E =======================================


; int __cdecl strcasestr(char *, char *)
		public strcasestr
strcasestr	proc near

Src		= dword	ptr -2Ch
SubStr		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 2Ch
		mov	[esp+2Ch+var_8], edi
		mov	edi, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_10], ebx
		mov	[esp+2Ch+var_C], esi
		mov	[esp+2Ch+var_4], ebp
		mov	[esp+2Ch+Src], edi ; Src
		call	_strdup
		mov	ebx, eax
		mov	eax, [esp+2Ch+arg_4]
		mov	[esp+2Ch+Src], eax ; Src
		call	_strdup
		mov	[esp+2Ch+Src], ebx ; Str
		mov	esi, eax
		call	_strlwr
		mov	[esp+2Ch+Src], esi ; Str
		call	_strlwr
		mov	[esp+2Ch+SubStr], esi ;	SubStr
		mov	[esp+2Ch+Src], ebx ; Str
		call	strstr
		test	eax, eax
		mov	ebp, eax
		jz	short loc_679C3AC6
		sub	ebp, ebx
		lea	ebp, [edi+ebp]

loc_679C3AC6:				; CODE XREF: strcasestr+4Fj
		mov	[esp+2Ch+Src], ebx ; Memory
		call	free
		mov	[esp+2Ch+Src], esi ; Memory
		call	free
		mov	eax, ebp
		mov	ebx, [esp+2Ch+var_10]
		mov	esi, [esp+2Ch+var_C]
		mov	edi, [esp+2Ch+var_8]
		mov	ebp, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
strcasestr	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  85. strlcat

; =============== S U B	R O U T	I N E =======================================


; int __cdecl strlcat(void *Buf, char *, size_t)
		public strlcat
strlcat		proc near

Str		= dword	ptr -3Ch
Val		= dword	ptr -38h
MaxCount	= dword	ptr -34h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
Buf		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 3Ch
		mov	[esp+3Ch+var_8], edi
		mov	edi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+var_10], ebx
		mov	[esp+3Ch+var_C], esi
		mov	esi, [esp+3Ch+arg_8]
		mov	[esp+3Ch+var_4], ebp
		mov	ebp, [esp+3Ch+Buf]
		mov	[esp+3Ch+Str], edi ; Str
		call	strlen
		mov	[esp+3Ch+MaxCount], esi	; MaxCount
		mov	[esp+3Ch+Val], 0 ; Val
		mov	[esp+3Ch+Str], ebp ; Buf
		mov	[esp+3Ch+var_20], eax
		call	memchr
		mov	edx, [esp+3Ch+var_20]
		test	eax, eax
		mov	ebx, eax
		jz	short loc_679C3B90
		sub	eax, ebp
		lea	ebp, [eax+edx]
		cmp	esi, ebp
		jbe	short loc_679C3B70
		add	edx, 1
		mov	[esp+3Ch+MaxCount], edx	; Size
		mov	[esp+3Ch+Val], edi ; Src
		mov	[esp+3Ch+Str], ebx ; Dst
		call	memcpy

loc_679C3B55:				; CODE XREF: strlcat+99j strlcat+A3j
		mov	eax, ebp
		mov	ebx, [esp+3Ch+var_10]
		mov	esi, [esp+3Ch+var_C]
		mov	edi, [esp+3Ch+var_8]
		mov	ebp, [esp+3Ch+var_4]
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C3B70:				; CODE XREF: strlcat+50j
		sub	esi, 1
		sub	esi, eax
		mov	[esp+3Ch+MaxCount], esi	; Size
		mov	[esp+3Ch+Val], edi ; Src
		mov	[esp+3Ch+Str], ebx ; Dst
		call	memcpy
		mov	byte ptr [ebx+esi], 0
		jmp	short loc_679C3B55
; ---------------------------------------------------------------------------
		align 10h

loc_679C3B90:				; CODE XREF: strlcat+47j
		lea	ebp, [edx+esi]
		jmp	short loc_679C3B55
strlcat		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  86. strlcpy

; =============== S U B	R O U T	I N E =======================================


; int __cdecl strlcpy(void *Dst, char *, int)
		public strlcpy
strlcpy		proc near

Str		= dword	ptr -2Ch
Src		= dword	ptr -28h
Size		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
Dst		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 2Ch
		mov	[esp+2Ch+var_8], edi
		mov	edi, [esp+2Ch+arg_4]
		mov	[esp+2Ch+var_10], ebx
		mov	[esp+2Ch+var_C], esi
		mov	esi, [esp+2Ch+arg_8]
		mov	[esp+2Ch+var_4], ebp
		mov	ebp, [esp+2Ch+Dst]
		mov	[esp+2Ch+Str], edi ; Str
		call	strlen
		cmp	eax, esi
		mov	ebx, eax
		jb	short loc_679C3BE7
		test	esi, esi
		jnz	short loc_679C3C00

loc_679C3BD1:				; CODE XREF: strlcpy+5Aj strlcpy+78j
		mov	eax, ebx
		mov	esi, [esp+2Ch+var_C]
		mov	ebx, [esp+2Ch+var_10]
		mov	edi, [esp+2Ch+var_8]
		mov	ebp, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_679C3BE7:				; CODE XREF: strlcpy+2Bj
		lea	eax, [eax+1]
		mov	[esp+2Ch+Size],	eax ; Size
		mov	[esp+2Ch+Src], edi ; Src
		mov	[esp+2Ch+Str], ebp ; Dst
		call	memcpy
		jmp	short loc_679C3BD1
; ---------------------------------------------------------------------------
		align 10h

loc_679C3C00:				; CODE XREF: strlcpy+2Fj
		lea	eax, [esi-1]
		mov	[esp+2Ch+Size],	eax ; Size
		mov	[esp+2Ch+Src], edi ; Src
		mov	[esp+2Ch+Str], ebp ; Dst
		call	memcpy
		mov	byte ptr [ebp+esi-1], 0
		jmp	short loc_679C3BD1
strlcpy		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  87. strndup

; =============== S U B	R O U T	I N E =======================================


; int __cdecl strndup(char *, int)
		public strndup
strndup		proc near		; CODE XREF: customize_file_name+8Cp
					; kdewin32_stat+128p ...

Str		= dword	ptr -1Ch
Src		= dword	ptr -18h
Size		= dword	ptr -14h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	[esp+1Ch+var_4], edi
		mov	edi, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_C], ebx
		mov	[esp+1Ch+var_8], esi
		mov	esi, [esp+1Ch+arg_4]
		mov	[esp+1Ch+Str], edi ; Str
		call	strlen
		cmp	eax, esi
		mov	ebx, eax
		jbe	short loc_679C3C47
		mov	ebx, esi

loc_679C3C47:				; CODE XREF: strndup+23j
		lea	eax, [ebx+1]
		mov	[esp+1Ch+Str], eax ; Size
		call	malloc
		test	eax, eax
		mov	esi, eax
		jz	short loc_679C3C6C
		mov	[esp+1Ch+Size],	ebx ; Size
		mov	[esp+1Ch+Src], edi ; Src
		mov	[esp+1Ch+Str], eax ; Dst
		call	memcpy
		mov	byte ptr [esi+ebx], 0

loc_679C3C6C:				; CODE XREF: strndup+36j
		mov	eax, esi
		mov	ebx, [esp+1Ch+var_C]
		mov	esi, [esp+1Ch+var_8]
		mov	edi, [esp+1Ch+var_4]
		add	esp, 1Ch
		retn
strndup		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   1. _nl_select_era_entry

; =============== S U B	R O U T	I N E =======================================


		public _nl_select_era_entry
_nl_select_era_entry proc near
		xor	eax, eax
		retn
_nl_select_era_entry endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_679C3C90	proc near		; CODE XREF: sub_679C3D80+87Ap
					; sub_679C3D80+933p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 18h
		mov	ecx, eax
		mov	[esp+18h+var_10], ebx
		xor	ebx, ebx
		mov	[esp+18h+var_C], esi
		mov	[esp+18h+var_4], ebp
		mov	[esp+18h+var_8], edi
		mov	edi, [ecx+10h]
		mov	eax, [eax+14h]
		cmp	edi, 1
		movzx	edi, ds:word_679C9720[edi+edi]
		setle	bl
		lea	edx, [eax+76Ch]
		sub	edx, ebx
		mov	esi, edx
		sar	esi, 1Fh
		mov	ebp, esi
		imul	eax, 16Dh
		add	eax, [ecx+0Ch]
		shr	ebp, 1Eh
		add	ebp, edx
		mov	ebx, ebp
		sar	ebx, 2
		lea	eax, [eax+edi-65A8h]
		mov	edi, 51EB851Fh
		add	eax, ebx
		mov	[esp+18h+var_14], eax
		mov	eax, edx
		imul	edi
		sar	ebp, 1Fh
		mov	eax, edx
		sar	eax, 5
		mov	[esp+18h+var_18], eax
		mov	eax, esi
		sub	eax, [esp+18h+var_18]
		sar	edx, 7
		sub	edx, esi
		mov	[esp+18h+var_18], eax
		add	eax, [esp+18h+var_14]
		lea	esi, [eax+edx]
		mov	eax, ebx
		imul	edi
		mov	edi, 92492493h
		sar	edx, 3
		sub	edx, ebp
		lea	eax, [edx+edx*4]
		lea	eax, [eax+eax*4]
		sub	ebx, eax
		shr	ebx, 1Fh
		add	esi, ebx
		mov	eax, esi
		imul	edi
		mov	eax, esi
		sar	eax, 1Fh
		add	edx, esi
		sar	edx, 2
		sub	edx, eax
		lea	eax, ds:0[edx*8]
		sub	eax, edx
		sub	esi, eax
		add	esi, 7
		mov	eax, esi
		imul	edi
		mov	eax, esi
		sar	eax, 1Fh
		add	edx, esi
		sar	edx, 2
		sub	edx, eax
		lea	eax, ds:0[edx*8]
		sub	eax, edx
		sub	esi, eax
		mov	[ecx+18h], esi
		mov	ebx, [esp+18h+var_10]
		mov	esi, [esp+18h+var_C]
		mov	edi, [esp+18h+var_8]
		mov	ebp, [esp+18h+var_4]
		add	esp, 18h
		retn
sub_679C3C90	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_679C3D80	proc near		; CODE XREF: sub_679C3D80+B27p
					; sub_679C3D80+B6Ep ...

C		= dword	ptr -7Ch
Str		= dword	ptr -78h
MaxCount	= dword	ptr -74h
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4

		push	ebp
		mov	ebp, ecx
		push	edi
		mov	edi, edx
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 6Ch
		mov	eax, ds:_strnicmp
		mov	esi, ds:isspace
		mov	[esp+7Ch+var_44], 0
		mov	[esp+7Ch+var_30], 0
		mov	[esp+7Ch+var_38], 0
		mov	[esp+7Ch+var_48], 0
		mov	[esp+7Ch+var_4C], 0
		mov	[esp+7Ch+var_34], 0
		mov	[esp+7Ch+var_5C], 0
		mov	[esp+7Ch+var_50], 0
		mov	[esp+7Ch+var_3C], 0
		mov	[esp+7Ch+var_54], 0FFFFFFFFh
		mov	[esp+7Ch+var_40], 0
		mov	[esp+7Ch+var_58], 0
		mov	[esp+7Ch+var_64], eax

loc_679C3DFC:				; CODE XREF: sub_679C3D80+C3j
					; sub_679C3D80+CBj ...
		movzx	edx, byte ptr [edi] ; jumptable	679C3E63 case 53
		test	dl, dl
		jz	loc_679C4488
		movsx	eax, dl
		mov	byte ptr [esp+7Ch+var_68], dl
		mov	[esp+7Ch+C], eax ; C
		call	esi ; isspace
		movzx	edx, byte ptr [esp+7Ch+var_68]
		test	eax, eax
		jnz	short loc_679C3E34
		cmp	dl, 25h
		jz	short loc_679C3E50
		cmp	[ebx], dl
		jz	short loc_679C3E45

loc_679C3E25:				; CODE XREF: sub_679C3D80+DEj
					; sub_679C3D80+E3j ...
		xor	ebx, ebx	; jumptable 679C3E63 default case

loc_679C3E27:				; CODE XREF: sub_679C3D80+904j
					; sub_679C3D80+910j ...
		add	esp, 6Ch
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_679C3E31:				; CODE XREF: sub_679C3D80+BEj
		add	ebx, 1

loc_679C3E34:				; CODE XREF: sub_679C3D80+9Aj
		movsx	eax, byte ptr [ebx]
		mov	[esp+7Ch+C], eax ; C
		call	esi ; isspace
		test	eax, eax
		jnz	short loc_679C3E31
		add	edi, 1
		jmp	short loc_679C3DFC ; jumptable 679C3E63	case 53
; ---------------------------------------------------------------------------

loc_679C3E45:				; CODE XREF: sub_679C3D80+A3j
		add	edi, 1
		add	ebx, 1
		jmp	short loc_679C3DFC ; jumptable 679C3E63	case 53
; ---------------------------------------------------------------------------
		align 10h

loc_679C3E50:				; CODE XREF: sub_679C3D80+9Fj
		add	edi, 1
		movzx	eax, byte ptr [edi]

loc_679C3E56:				; CODE XREF: sub_679C3D80+B8Fj
					; sub_679C3D80+B97j ...
		sub	eax, 25h
		add	edi, 1
		cmp	al, 54h		; switch 85 cases
		ja	short loc_679C3E25 ; jumptable 679C3E63	default	case
		movzx	eax, al
		jmp	ds:off_679C93A8[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_679C3E6A:				; CODE XREF: sub_679C3D80+F2j
		add	ebx, 1

loc_679C3E6D:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		movzx	eax, byte ptr [ebx] ; jumptable	679C3E63 case 30
		cmp	al, 20h
		jz	short loc_679C3E6A
		lea	edx, [eax-30h]
		cmp	dl, 9
		ja	short loc_679C3E25 ; jumptable 679C3E63	default	case
		movsx	eax, al
		add	ebx, 1
		sub	eax, 30h
		lea	ecx, [eax+eax*4]
		add	ecx, ecx
		cmp	ecx, 63h
		ja	short loc_679C3EA6
		movzx	edx, byte ptr [ebx]
		cmp	dl, 2Fh
		jle	short loc_679C3EA6
		cmp	dl, 39h
		jg	short loc_679C3EA6
		movsx	edx, dl
		add	ebx, 1
		lea	eax, [ecx+edx-30h]

loc_679C3EA6:				; CODE XREF: sub_679C3D80+10Dj
					; sub_679C3D80+115j ...
		cmp	eax, 63h
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		mov	[esp+7Ch+var_54], eax
		mov	[esp+7Ch+var_5C], 1
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C3EC0:				; CODE XREF: sub_679C3D80+148j
		add	ebx, 1

loc_679C3EC3:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		movzx	eax, byte ptr [ebx] ; jumptable	679C3E63 cases 35,70
		cmp	al, 20h
		jz	short loc_679C3EC0

loc_679C3ECA:				; CODE XREF: sub_679C3D80+1310j
		lea	edx, [eax-30h]
		cmp	dl, 9
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		movsx	eax, al
		add	ebx, 1
		sub	eax, 30h
		lea	ecx, [eax+eax*4]
		add	ecx, ecx
		cmp	ecx, 17h
		ja	short loc_679C3F00
		movzx	edx, byte ptr [ebx]
		cmp	dl, 2Fh
		jle	short loc_679C3F00
		cmp	dl, 39h
		jg	short loc_679C3F00
		movsx	edx, dl
		add	ebx, 1
		lea	eax, [ecx+edx-30h]

loc_679C3F00:				; CODE XREF: sub_679C3D80+167j
					; sub_679C3D80+16Fj ...
		cmp	eax, 17h
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		mov	[ebp+8], eax
		mov	[esp+7Ch+var_58], 0
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C3F19:				; CODE XREF: sub_679C3D80+1A1j
		add	ebx, 1

loc_679C3F1C:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		movzx	eax, byte ptr [ebx] ; jumptable	679C3E63 cases 36,71
		cmp	al, 20h
		jz	short loc_679C3F19

loc_679C3F23:				; CODE XREF: sub_679C3D80+1300j
		lea	edx, [eax-30h]
		cmp	dl, 9
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		movsx	eax, al
		add	ebx, 1
		lea	ecx, [eax-30h]
		lea	edx, [ecx+ecx*4]
		add	edx, edx
		cmp	edx, 0Ch
		ja	short loc_679C3F57
		movzx	eax, byte ptr [ebx]
		cmp	al, 2Fh
		jle	short loc_679C3F57
		cmp	al, 39h
		jg	short loc_679C3F57
		movsx	eax, al
		add	ebx, 1
		lea	ecx, [edx+eax-30h]

loc_679C3F57:				; CODE XREF: sub_679C3D80+1C0j
					; sub_679C3D80+1C7j ...
		lea	eax, [ecx-1]
		cmp	eax, 0Bh
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		mov	eax, ecx
		mov	edx, 0AAAAAAABh
		mul	edx
		mov	[esp+7Ch+var_58], 1
		shr	edx, 3
		lea	eax, [edx+edx*2]
		shl	eax, 2
		sub	ecx, eax
		mov	[ebp+8], ecx
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C3F87:				; CODE XREF: sub_679C3D80+20Fj
		add	ebx, 1

loc_679C3F8A:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		movzx	eax, byte ptr [ebx] ; jumptable	679C3E63 case 40
		cmp	al, 20h
		jz	short loc_679C3F87

loc_679C3F91:				; CODE XREF: sub_679C3D80+12F0j
		lea	edx, [eax-30h]
		cmp	dl, 9
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		movsx	eax, al
		add	ebx, 1
		sub	eax, 30h
		lea	ecx, [eax+eax*4]
		add	ecx, ecx
		cmp	ecx, 3Bh
		ja	short loc_679C3FC7
		movzx	edx, byte ptr [ebx]
		cmp	dl, 2Fh
		jle	short loc_679C3FC7
		cmp	dl, 39h
		jg	short loc_679C3FC7
		movsx	edx, dl
		add	ebx, 1
		lea	eax, [ecx+edx-30h]

loc_679C3FC7:				; CODE XREF: sub_679C3D80+22Ej
					; sub_679C3D80+236j ...
		cmp	eax, 3Bh
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		mov	[ebp+4], eax
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C3FD8:				; CODE XREF: sub_679C3D80+260j
		add	ebx, 1

loc_679C3FDB:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		movzx	eax, byte ptr [ebx] ; jumptable	679C3E63 case 46
		cmp	al, 20h
		jz	short loc_679C3FD8

loc_679C3FE2:				; CODE XREF: sub_679C3D80+12E0j
		lea	edx, [eax-30h]
		cmp	dl, 9
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		movsx	eax, al
		add	ebx, 1
		sub	eax, 30h
		lea	ecx, [eax+eax*4]
		add	ecx, ecx
		cmp	ecx, 3Dh
		ja	short loc_679C4018
		movzx	edx, byte ptr [ebx]
		cmp	dl, 2Fh
		jle	short loc_679C4018
		cmp	dl, 39h
		jg	short loc_679C4018
		movsx	edx, dl
		add	ebx, 1
		lea	eax, [ecx+edx-30h]

loc_679C4018:				; CODE XREF: sub_679C3D80+27Fj
					; sub_679C3D80+287j ...
		cmp	eax, 3Dh
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		mov	[ebp+0], eax
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C4029:				; CODE XREF: sub_679C3D80+2B1j
		add	ebx, 1

loc_679C402C:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		movzx	eax, byte ptr [ebx] ; jumptable	679C3E63 case 48
		cmp	al, 20h
		jz	short loc_679C4029

loc_679C4033:				; CODE XREF: sub_679C3D80+12D0j
		lea	edx, [eax-30h]
		cmp	dl, 9
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		movsx	eax, al
		add	ebx, 1
		sub	eax, 30h
		lea	ecx, [eax+eax*4]
		add	ecx, ecx
		cmp	ecx, 35h
		ja	short loc_679C4069
		movzx	edx, byte ptr [ebx]
		cmp	dl, 2Fh
		jle	short loc_679C4069
		cmp	dl, 39h
		jg	short loc_679C4069
		movsx	edx, dl
		add	ebx, 1
		lea	eax, [ecx+edx-30h]

loc_679C4069:				; CODE XREF: sub_679C3D80+2D0j
					; sub_679C3D80+2D8j ...
		cmp	eax, 35h
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		mov	[esp+7Ch+var_44], eax
		mov	[esp+7Ch+var_38], 1
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C4083:				; CODE XREF: sub_679C3D80+30Bj
		add	ebx, 1

loc_679C4086:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		movzx	eax, byte ptr [ebx] ; jumptable	679C3E63 case 49
		cmp	al, 20h
		jz	short loc_679C4083

loc_679C408D:				; CODE XREF: sub_679C3D80+12C0j
		lea	edx, [eax-30h]
		cmp	dl, 9
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		movsx	eax, al
		add	ebx, 1
		sub	eax, 30h
		lea	ecx, [eax+eax*4]
		add	ecx, ecx
		cmp	ecx, 35h
		ja	short loc_679C40C3
		movzx	edx, byte ptr [ebx]
		cmp	dl, 2Fh
		jle	short loc_679C40C3
		cmp	dl, 39h
		jg	short loc_679C40C3
		movsx	edx, dl
		add	ebx, 1
		lea	eax, [ecx+edx-30h]

loc_679C40C3:				; CODE XREF: sub_679C3D80+32Aj
					; sub_679C3D80+332j ...
		cmp	eax, 35h
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C40D1:				; CODE XREF: sub_679C3D80+359j
		add	ebx, 1

loc_679C40D4:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		movzx	eax, byte ptr [ebx] ; jumptable	679C3E63 case 50
		cmp	al, 20h
		jz	short loc_679C40D1

loc_679C40DB:				; CODE XREF: sub_679C3D80+12B0j
		lea	edx, [eax-30h]
		cmp	dl, 9
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		movsx	eax, al
		add	ebx, 1
		sub	eax, 30h
		lea	ecx, [eax+eax*4]
		add	ecx, ecx
		cmp	ecx, 35h
		ja	short loc_679C4111
		movzx	edx, byte ptr [ebx]
		cmp	dl, 2Fh
		jle	short loc_679C4111
		cmp	dl, 39h
		jg	short loc_679C4111
		movsx	edx, dl
		add	ebx, 1
		lea	eax, [ecx+edx-30h]

loc_679C4111:				; CODE XREF: sub_679C3D80+378j
					; sub_679C3D80+380j ...
		cmp	eax, 35h
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		mov	[esp+7Ch+var_44], eax
		mov	[esp+7Ch+var_30], 1
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C412B:				; CODE XREF: sub_679C3D80+3B3j
		add	ebx, 1

loc_679C412E:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		movzx	eax, byte ptr [ebx] ; jumptable	679C3E63 case 52
		cmp	al, 20h
		jz	short loc_679C412B
		lea	edx, [eax-30h]
		cmp	dl, 9
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		movsx	eax, al
		add	ebx, 1
		sub	eax, 30h
		lea	ecx, [eax+eax*4]
		add	ecx, ecx
		cmp	ecx, 270Fh
		ja	short loc_679C41B6
		movzx	edx, byte ptr [ebx]
		cmp	dl, 2Fh
		jle	short loc_679C41B6
		cmp	dl, 39h
		jg	short loc_679C41B6
		movsx	edx, dl
		add	ebx, 1
		lea	eax, [ecx+edx-30h]
		lea	ecx, [eax+eax*4]
		add	ecx, ecx
		cmp	ecx, 270Fh
		ja	short loc_679C41B6
		movzx	edx, byte ptr [ebx]
		cmp	dl, 2Fh
		jle	short loc_679C41B6
		cmp	dl, 39h
		jg	short loc_679C41B6
		movsx	edx, dl
		add	ebx, 1
		lea	eax, [ecx+edx-30h]
		lea	ecx, [eax+eax*4]
		add	ecx, ecx
		cmp	ecx, 270Fh
		ja	short loc_679C41B6
		movzx	edx, byte ptr [ebx]
		cmp	dl, 2Fh
		jle	short loc_679C41B6
		cmp	dl, 39h
		jg	short loc_679C41B6
		movsx	edx, dl
		add	ebx, 1
		lea	eax, [ecx+edx-30h]

loc_679C41B6:				; CODE XREF: sub_679C3D80+3D5j
					; sub_679C3D80+3DDj ...
		cmp	eax, 270Fh
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		sub	eax, 76Ch
		mov	[ebp+14h], eax
		mov	[esp+7Ch+var_5C], 1
		mov	[esp+7Ch+var_3C], 0
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C41DE:				; CODE XREF: sub_679C3D80+466j
		add	ebx, 1

loc_679C41E1:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		movzx	eax, byte ptr [ebx] ; jumptable	679C3E63 cases 63,64
		cmp	al, 20h
		jz	short loc_679C41DE

loc_679C41E8:				; CODE XREF: sub_679C3D80+12A0j
		lea	edx, [eax-30h]
		cmp	dl, 9
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		movsx	eax, al
		add	ebx, 1
		sub	eax, 30h
		lea	ecx, [eax+eax*4]
		add	ecx, ecx
		cmp	ecx, 1Fh
		ja	short loc_679C421E
		movzx	edx, byte ptr [ebx]
		cmp	dl, 2Fh
		jle	short loc_679C421E
		cmp	dl, 39h
		jg	short loc_679C421E
		movsx	edx, dl
		add	ebx, 1
		lea	eax, [ecx+edx-30h]

loc_679C421E:				; CODE XREF: sub_679C3D80+485j
					; sub_679C3D80+48Dj ...
		lea	edx, [eax-1]
		cmp	edx, 1Eh
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		mov	[ebp+0Ch], eax
		mov	[esp+7Ch+var_48], 1
		mov	[esp+7Ch+var_5C], 1
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C4242:				; CODE XREF: sub_679C3D80+4CAj
		add	ebx, 1

loc_679C4245:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		movzx	eax, byte ptr [ebx] ; jumptable	679C3E63 case 66
		cmp	al, 20h
		jz	short loc_679C4242
		lea	edx, [eax-30h]
		cmp	dl, 9
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		movsx	eax, al
		add	ebx, 1
		sub	eax, 30h
		lea	ecx, [eax+eax*4]
		add	ecx, ecx
		cmp	ecx, 63h
		ja	short loc_679C4282
		movzx	edx, byte ptr [ebx]
		cmp	dl, 2Fh
		jle	short loc_679C4282
		cmp	dl, 39h
		jg	short loc_679C4282
		movsx	edx, dl
		add	ebx, 1
		lea	eax, [ecx+edx-30h]

loc_679C4282:				; CODE XREF: sub_679C3D80+4E9j
					; sub_679C3D80+4F1j ...
		cmp	eax, 63h
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C4290:				; CODE XREF: sub_679C3D80+518j
		add	ebx, 1

loc_679C4293:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		movzx	eax, byte ptr [ebx] ; jumptable	679C3E63 case 69
		cmp	al, 20h
		jz	short loc_679C4290
		lea	edx, [eax-30h]
		cmp	dl, 9
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		movsx	eax, al
		add	ebx, 1
		sub	eax, 30h
		lea	ecx, [eax+eax*4]
		add	ecx, ecx
		cmp	ecx, 16Eh
		ja	short loc_679C42F7
		movzx	edx, byte ptr [ebx]
		cmp	dl, 2Fh
		jle	short loc_679C42F7
		cmp	dl, 39h
		jg	short loc_679C42F7
		movsx	edx, dl
		add	ebx, 1
		lea	eax, [ecx+edx-30h]
		lea	ecx, [eax+eax*4]
		add	ecx, ecx
		cmp	ecx, 16Eh
		ja	short loc_679C42F7
		movzx	edx, byte ptr [ebx]
		cmp	dl, 2Fh
		jle	short loc_679C42F7
		cmp	dl, 39h
		jg	short loc_679C42F7
		movsx	edx, dl
		add	ebx, 1
		lea	eax, [ecx+edx-30h]

loc_679C42F7:				; CODE XREF: sub_679C3D80+53Aj
					; sub_679C3D80+542j ...
		sub	eax, 1
		cmp	eax, 16Dh
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		mov	[ebp+1Ch], eax
		mov	[esp+7Ch+var_34], 1
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C4315:				; CODE XREF: sub_679C3D80+59Dj
		add	ebx, 1

loc_679C4318:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		movzx	eax, byte ptr [ebx] ; jumptable	679C3E63 case 72
		cmp	al, 20h
		jz	short loc_679C4315

loc_679C431F:				; CODE XREF: sub_679C3D80+1291j
		lea	edx, [eax-30h]
		cmp	dl, 9
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		movsx	eax, al
		add	ebx, 1
		sub	eax, 30h
		lea	ecx, [eax+eax*4]
		add	ecx, ecx
		cmp	ecx, 0Ch
		ja	short loc_679C4355
		movzx	edx, byte ptr [ebx]
		cmp	dl, 2Fh
		jle	short loc_679C4355
		cmp	dl, 39h
		jg	short loc_679C4355
		movsx	edx, dl
		add	ebx, 1
		lea	eax, [ecx+edx-30h]

loc_679C4355:				; CODE XREF: sub_679C3D80+5BCj
					; sub_679C3D80+5C4j ...
		sub	eax, 1
		cmp	eax, 0Bh
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		mov	[ebp+10h], eax
		mov	[esp+7Ch+var_4C], 1
		mov	[esp+7Ch+var_5C], 1
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C4379:				; CODE XREF: sub_679C3D80+606j
		add	ebx, 1

loc_679C437C:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		movsx	eax, byte ptr [ebx] ; jumptable	679C3E63 cases 73,79
		mov	[esp+7Ch+C], eax ; C
		call	esi ; isspace
		test	eax, eax
		jnz	short loc_679C4379
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C438D:				; CODE XREF: sub_679C3D80+615j
		add	ebx, 1

loc_679C4390:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		movzx	eax, byte ptr [ebx] ; jumptable	679C3E63 case 80
		cmp	al, 20h
		jz	short loc_679C438D
		lea	edx, [eax-30h]
		cmp	dl, 9
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		movsx	eax, al
		lea	ecx, [eax-30h]
		sub	eax, 31h
		cmp	eax, 6
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		mov	eax, ecx
		mov	edx, 24924925h
		mul	edx
		mov	eax, ecx
		add	ebx, 1
		mov	[esp+7Ch+var_50], 1
		sub	eax, edx
		shr	eax, 1
		add	edx, eax
		shr	edx, 2
		lea	eax, ds:0[edx*8]
		sub	eax, edx
		sub	ecx, eax
		mov	[ebp+18h], ecx
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C43E7:				; CODE XREF: sub_679C3D80+66Fj
		add	ebx, 1

loc_679C43EA:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		movzx	eax, byte ptr [ebx] ; jumptable	679C3E63 case 82
		cmp	al, 20h
		jz	short loc_679C43E7

loc_679C43F1:				; CODE XREF: sub_679C3D80+1282j
		lea	edx, [eax-30h]
		cmp	dl, 9
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		movsx	eax, al
		sub	eax, 30h
		cmp	eax, 6
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		add	ebx, 1
		mov	[ebp+18h], eax
		mov	[esp+7Ch+var_50], 1
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C441F:				; CODE XREF: sub_679C3D80+6A7j
		add	ebx, 1

loc_679C4422:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		movzx	eax, byte ptr [ebx] ; jumptable	679C3E63 case 84
		cmp	al, 20h
		jz	short loc_679C441F
		lea	edx, [eax-30h]
		cmp	dl, 9
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		movsx	eax, al
		add	ebx, 1
		sub	eax, 30h
		lea	ecx, [eax+eax*4]
		add	ecx, ecx
		cmp	ecx, 63h
		ja	short loc_679C445F
		movzx	edx, byte ptr [ebx]
		cmp	dl, 2Fh
		jle	short loc_679C445F
		cmp	dl, 39h
		jg	short loc_679C445F
		movsx	edx, dl
		add	ebx, 1
		lea	eax, [ecx+edx-30h]

loc_679C445F:				; CODE XREF: sub_679C3D80+6C6j
					; sub_679C3D80+6CEj ...
		cmp	eax, 63h
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		cmp	eax, 44h
		ja	short loc_679C4470
		add	eax, 64h

loc_679C4470:				; CODE XREF: sub_679C3D80+6EBj
		mov	[ebp+14h], eax
		mov	[esp+7Ch+var_5C], 1
		mov	[esp+7Ch+var_3C], 1
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C4488:				; CODE XREF: sub_679C3D80+81j
		mov	ecx, [esp+7Ch+var_40]
		test	ecx, ecx
		jnz	loc_679C4850

loc_679C4494:				; CODE XREF: sub_679C3D80+AD6j
					; sub_679C3D80+AE0j
		cmp	[esp+7Ch+var_54], 0FFFFFFFFh
		jz	short loc_679C44B4
		mov	eax, [esp+7Ch+var_3C]
		test	eax, eax
		jnz	loc_679C4865
		imul	eax, [esp+7Ch+var_54], 64h
		sub	eax, 76Ch
		mov	[ebp+14h], eax

loc_679C44B4:				; CODE XREF: sub_679C3D80+719j
					; sub_679C3D80+B0Fj
		mov	edi, [esp+7Ch+var_50]
		movzx	edx, byte ptr [esp+7Ch+var_5C]
		test	edi, edi
		jnz	loc_679C45FF
		test	dl, dl
		jz	loc_679C45FF
		mov	esi, [esp+7Ch+var_4C]
		mov	ecx, [esp+7Ch+var_48]
		test	esi, esi
		setz	byte ptr [esp+7Ch+var_64]
		test	ecx, ecx
		setz	byte ptr [esp+7Ch+var_54]
		jnz	loc_679C50DE

loc_679C44E9:				; CODE XREF: sub_679C3D80+1369j
		mov	edx, [esp+7Ch+var_34]
		test	edx, edx
		jz	loc_679C45F8
		mov	edi, [ebp+14h]
		mov	eax, 51EB851Fh
		mov	esi, [ebp+1Ch]
		lea	ecx, [edi+76Ch]
		imul	ecx
		mov	eax, ecx
		sar	eax, 1Fh
		mov	[esp+7Ch+var_58], eax
		mov	[esp+7Ch+var_60], edx
		sar	edx, 5
		sub	edx, eax
		mov	eax, ecx
		imul	edx, 64h
		sub	eax, edx
		mov	edx, eax
		mov	eax, [esp+7Ch+var_60]
		sar	eax, 7
		mov	[esp+7Ch+var_60], eax
		mov	eax, [esp+7Ch+var_58]
		sub	[esp+7Ch+var_60], eax
		imul	eax, [esp+7Ch+var_60], 190h
		mov	[esp+7Ch+var_60], eax
		mov	eax, ecx
		sub	eax, [esp+7Ch+var_60]
		and	ecx, 3
		mov	[esp+7Ch+var_60], eax
		jnz	loc_679C54EA
		test	edx, edx
		jz	loc_679C554D
		xor	ecx, ecx
		test	eax, eax
		jz	loc_679C5098
		jmp	short loc_679C456C
; ---------------------------------------------------------------------------

loc_679C4569:				; CODE XREF: sub_679C3D80+7F6j
		add	ecx, 1

loc_679C456C:				; CODE XREF: sub_679C3D80+7E7j
		movzx	eax, ds:word_679C973A[ecx+ecx]
		cmp	esi, eax
		jge	short loc_679C4569

loc_679C4578:				; CODE XREF: sub_679C3D80+1324j
					; sub_679C3D80+178Bj ...
		cmp	byte ptr [esp+7Ch+var_64], 0
		jz	short loc_679C4585
		lea	eax, [ecx-1]
		mov	[ebp+10h], eax

loc_679C4585:				; CODE XREF: sub_679C3D80+7FDj
		cmp	byte ptr [esp+7Ch+var_54], 0
		jz	short loc_679C45F8
		add	edi, 76Ch
		xor	eax, eax
		test	edi, 3
		jnz	short loc_679C45DC
		mov	eax, 51EB851Fh
		imul	edi
		mov	eax, edx
		mov	[esp+7Ch+var_58], edx
		mov	edx, edi
		sar	edx, 1Fh
		sar	eax, 5
		sub	eax, edx
		mov	[esp+7Ch+var_64], edx
		imul	edx, eax, 64h
		mov	eax, 1
		cmp	edi, edx
		jnz	short loc_679C45DC
		mov	eax, [esp+7Ch+var_58]
		sar	eax, 7
		sub	eax, [esp+7Ch+var_64]
		imul	eax, 190h
		cmp	edi, eax
		setz	al
		movzx	eax, al

loc_679C45DC:				; CODE XREF: sub_679C3D80+81Aj
					; sub_679C3D80+841j
		lea	edx, [eax+eax]
		add	esi, 1
		add	edx, eax
		lea	eax, [eax+edx*4]
		lea	eax, [ecx+eax-1]
		movzx	eax, ds:word_679C9720[eax+eax]
		sub	esi, eax
		mov	[ebp+0Ch], esi

loc_679C45F8:				; CODE XREF: sub_679C3D80+76Fj
					; sub_679C3D80+80Aj ...
		mov	eax, ebp
		call	sub_679C3C90

loc_679C45FF:				; CODE XREF: sub_679C3D80+73Fj
					; sub_679C3D80+747j
		mov	eax, [esp+7Ch+var_34]
		test	eax, eax
		setz	byte ptr [esp+7Ch+var_64]
		jnz	short loc_679C4676
		cmp	byte ptr [esp+7Ch+var_5C], 0
		jz	short loc_679C4676
		mov	ecx, [ebp+14h]
		xor	eax, eax
		add	ecx, 76Ch
		test	cl, 3
		jnz	short loc_679C4659
		mov	eax, ecx
		mov	edx, 51EB851Fh
		imul	edx
		mov	esi, ecx
		sar	esi, 1Fh
		mov	eax, edx
		sar	eax, 5
		sub	eax, esi
		imul	edi, eax, 64h
		mov	eax, 1
		cmp	ecx, edi
		jnz	short loc_679C4659
		mov	eax, edx
		sar	eax, 7
		sub	eax, esi
		imul	eax, 190h
		cmp	ecx, eax
		setz	al
		movzx	eax, al

loc_679C4659:				; CODE XREF: sub_679C3D80+8A1j
					; sub_679C3D80+8C2j
		lea	edx, [eax+eax]
		mov	ecx, [ebp+0Ch]
		add	edx, eax
		lea	eax, [eax+edx*4]
		add	eax, [ebp+10h]
		movzx	eax, ds:word_679C9720[eax+eax]
		lea	eax, [ecx+eax-1]
		mov	[ebp+1Ch], eax

loc_679C4676:				; CODE XREF: sub_679C3D80+88Aj
					; sub_679C3D80+891j
		mov	edi, [esp+7Ch+var_30]
		test	edi, edi
		jnz	short loc_679C468A
		mov	esi, [esp+7Ch+var_38]
		test	esi, esi
		jz	loc_679C3E27

loc_679C468A:				; CODE XREF: sub_679C3D80+8FCj
		mov	ecx, [esp+7Ch+var_50]
		test	ecx, ecx
		jz	loc_679C3E27
		mov	edx, [ebp+18h]
		mov	eax, ebp
		mov	esi, [ebp+0Ch]
		mov	edi, [ebp+10h]
		mov	dword ptr [ebp+0Ch], 1
		mov	dword ptr [ebp+10h], 0
		mov	[esp+7Ch+var_5C], edx
		call	sub_679C3C90
		mov	edx, [esp+7Ch+var_48]
		test	edx, edx
		jz	short loc_679C46C3
		mov	[ebp+0Ch], esi

loc_679C46C3:				; CODE XREF: sub_679C3D80+93Ej
		mov	eax, [esp+7Ch+var_4C]
		test	eax, eax
		jz	short loc_679C46CE
		mov	[ebp+10h], edi

loc_679C46CE:				; CODE XREF: sub_679C3D80+949j
		cmp	byte ptr [esp+7Ch+var_64], 0
		jz	short loc_679C4723
		mov	ecx, [esp+7Ch+var_44]
		xor	edx, edx
		cmp	[esp+7Ch+var_38], 0
		mov	esi, [esp+7Ch+var_5C]
		setz	dl
		sub	ecx, 1
		lea	eax, ds:0[ecx*8]
		sub	eax, ecx
		sub	eax, edx
		sub	edx, [ebp+18h]
		lea	esi, [eax+esi]
		lea	ecx, [edx+7]
		mov	edx, 92492493h
		mov	eax, ecx
		imul	edx
		mov	eax, ecx
		sar	eax, 1Fh
		add	edx, ecx
		sar	edx, 2
		sub	edx, eax
		lea	eax, ds:0[edx*8]
		sub	eax, edx
		sub	ecx, eax
		add	esi, ecx
		mov	[ebp+1Ch], esi

loc_679C4723:				; CODE XREF: sub_679C3D80+953j
		mov	edi, [esp+7Ch+var_48]
		mov	esi, [esp+7Ch+var_4C]
		test	edi, edi
		setz	byte ptr [esp+7Ch+var_64]
		test	esi, esi
		setz	byte ptr [esp+7Ch+var_54]
		jnz	loc_679C5129

loc_679C473F:				; CODE XREF: sub_679C3D80+13AEj
		mov	edi, [ebp+14h]
		mov	eax, 51EB851Fh
		mov	esi, [ebp+1Ch]
		lea	ecx, [edi+76Ch]
		imul	ecx
		mov	eax, ecx
		sar	eax, 1Fh
		mov	[esp+7Ch+var_58], eax
		mov	[esp+7Ch+var_60], edx
		sar	edx, 5
		sub	edx, eax
		mov	eax, ecx
		imul	edx, 64h
		sub	eax, edx
		mov	edx, eax
		mov	eax, [esp+7Ch+var_60]
		sar	eax, 7
		mov	[esp+7Ch+var_60], eax
		mov	eax, [esp+7Ch+var_58]
		sub	[esp+7Ch+var_60], eax
		imul	eax, [esp+7Ch+var_60], 190h
		mov	[esp+7Ch+var_60], eax
		mov	eax, ecx
		sub	eax, [esp+7Ch+var_60]
		and	ecx, 3
		mov	[esp+7Ch+var_60], eax
		jnz	loc_679C5486
		test	edx, edx
		jz	loc_679C54C5
		xor	ecx, ecx
		test	eax, eax
		jz	loc_679C50B3
		jmp	short loc_679C47B6
; ---------------------------------------------------------------------------

loc_679C47B3:				; CODE XREF: sub_679C3D80+A40j
		add	ecx, 1

loc_679C47B6:				; CODE XREF: sub_679C3D80+A31j
		movzx	eax, ds:word_679C973A[ecx+ecx]
		cmp	esi, eax
		jge	short loc_679C47B3

loc_679C47C2:				; CODE XREF: sub_679C3D80+133Fj
					; sub_679C3D80+1727j ...
		cmp	byte ptr [esp+7Ch+var_54], 0
		jz	short loc_679C47CF
		lea	eax, [ecx-1]
		mov	[ebp+10h], eax

loc_679C47CF:				; CODE XREF: sub_679C3D80+A47j
		cmp	byte ptr [esp+7Ch+var_64], 0
		jz	loc_679C5134
		add	edi, 76Ch
		xor	eax, eax
		test	edi, 3
		jnz	short loc_679C4829
		mov	eax, 51EB851Fh
		imul	edi
		mov	eax, edx
		mov	[esp+7Ch+var_58], edx
		mov	edx, edi
		sar	edx, 1Fh
		sar	eax, 5
		sub	eax, edx
		mov	[esp+7Ch+var_64], edx
		imul	edx, eax, 64h
		mov	eax, 1
		cmp	edi, edx
		jnz	short loc_679C4829
		mov	edx, [esp+7Ch+var_58]
		xor	eax, eax
		sar	edx, 7
		sub	edx, [esp+7Ch+var_64]
		imul	edx, 190h
		cmp	edi, edx
		setz	al

loc_679C4829:				; CODE XREF: sub_679C3D80+A68j
					; sub_679C3D80+A8Fj
		lea	edx, [eax+eax]
		add	esi, 1
		add	edx, eax
		lea	eax, [eax+edx*4]
		lea	eax, [ecx+eax-1]
		movzx	eax, ds:word_679C9720[eax+eax]
		sub	esi, eax
		mov	[ebp+0Ch], esi
		jmp	loc_679C5134
; ---------------------------------------------------------------------------
		align 10h

loc_679C4850:				; CODE XREF: sub_679C3D80+70Ej
		mov	edx, [esp+7Ch+var_58]
		test	edx, edx
		jz	loc_679C4494
		add	dword ptr [ebp+8], 0Ch
		jmp	loc_679C4494
; ---------------------------------------------------------------------------

loc_679C4865:				; CODE XREF: sub_679C3D80+721j
		mov	ecx, [ebp+14h]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		mov	eax, ecx
		sar	eax, 1Fh
		sar	edx, 5
		sub	edx, eax
		imul	edx, 64h
		imul	eax, [esp+7Ch+var_54], 64h
		sub	ecx, edx
		lea	eax, [ecx+eax-76Ch]
		mov	[ebp+14h], eax
		jmp	loc_679C44B4
; ---------------------------------------------------------------------------

loc_679C4894:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		mov	eax, [esp+7Ch+arg_0] ; jumptable 679C3E63 case 45
		mov	ecx, ebp
		mov	edx, offset aHM_0 ; "%H:%M"
		mov	[esp+7Ch+C], eax

loc_679C48A5:				; CODE XREF: sub_679C3D80+1198j
					; sub_679C3D80+1212j
		mov	eax, ebx
		call	sub_679C3D80
		test	eax, eax
		mov	ebx, eax
		jz	loc_679C3E27
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C48BB:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		movzx	eax, byte ptr [ebx] ; jumptable	679C3E63 case 34
		sub	eax, 30h
		cmp	al, 9
		ja	loc_679C3E25	; jumptable 679C3E63 default case

loc_679C48C9:				; CODE XREF: sub_679C3D80+B54j
		add	ebx, 1
		movzx	eax, byte ptr [ebx]
		sub	eax, 30h
		cmp	al, 9
		jbe	short loc_679C48C9
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C48DB:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		mov	edx, [esp+7Ch+arg_0] ; jumptable 679C3E63 case 33
		mov	ecx, ebp
		mov	[esp+7Ch+C], edx
		mov	edx, offset aYMD ; "%Y-%m-%d"

loc_679C48EC:				; CODE XREF: sub_679C3D80+BD6j
					; sub_679C3D80+11E1j
		mov	eax, ebx
		call	sub_679C3D80
		test	eax, eax
		mov	ebx, eax
		jz	loc_679C3E27
		mov	[esp+7Ch+var_5C], 1
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C490A:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		movzx	eax, byte ptr [edi] ; jumptable	679C3E63 case 32
		cmp	al, 43h
		jz	loc_679C3E56
		cmp	al, 63h
		jz	loc_679C3E56
		cmp	al, 79h
		nop
		jz	loc_679C3E56
		cmp	al, 59h
		jz	loc_679C3E56
		cmp	al, 78h
		jz	loc_679C3E56
		cmp	al, 58h
		jnz	loc_679C3E25	; jumptable 679C3E63 default case
		xchg	ax, ax
		jmp	loc_679C3E56
; ---------------------------------------------------------------------------

loc_679C4945:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		mov	eax, [esp+7Ch+arg_0] ; jumptable 679C3E63 cases	31,83
		mov	ecx, ebp
		mov	edx, offset aMDY ; "%m/%d/%y"
		mov	[esp+7Ch+C], eax
		jmp	short loc_679C48EC
; ---------------------------------------------------------------------------

loc_679C4958:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		mov	edx, [esp+7Ch+arg_0] ; jumptable 679C3E63 cases	28,60
		cmp	dword ptr [edx], 1
		jz	loc_679C3E25	; jumptable 679C3E63 default case
		mov	[esp+7Ch+C], offset Str1 ; "Sunday"
		call	strlen
		mov	[esp+7Ch+Str], ebx ; Str
		mov	[esp+7Ch+C], offset Str1 ; "Sunday"
		mov	[esp+7Ch+MaxCount], eax	; MaxCount
		mov	[esp+7Ch+var_68], eax
		call	ds:_strnicmp
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C54BB
		mov	[esp+7Ch+C], offset aSun ; "Sun"
		call	strlen
		mov	[esp+7Ch+Str], ebx ; Str
		mov	[esp+7Ch+C], offset aSun ; "Sun"
		mov	[esp+7Ch+MaxCount], eax	; MaxCount
		mov	[esp+7Ch+var_68], eax
		call	ds:_strnicmp
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jnz	loc_679C5180
		add	ebx, edx

loc_679C49CC:				; CODE XREF: sub_679C3D80+1472j
					; sub_679C3D80+14E9j ...
		mov	edx, [esp+7Ch+arg_0]
		mov	[ebp+18h], eax
		mov	[esp+7Ch+var_50], 1
		mov	dword ptr [edx], 2
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C49E9:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		cmp	byte ptr [ebx],	25h ; jumptable	679C3E63 case 0
		jnz	loc_679C3E25	; jumptable 679C3E63 default case
		add	ebx, 1
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C49FA:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		mov	[esp+7Ch+C], offset aJanuary ; jumptable 679C3E63 cases	29,61,67
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aJanuary ; "January"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C50C4
		mov	[esp+7Ch+C], offset aJan ; "Jan"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aJan ; "Jan"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C50C4
		mov	[esp+7Ch+C], offset aFebruary ;	"February"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aFebruary ;	"February"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C50CB
		mov	[esp+7Ch+C], offset aFeb ; "Feb"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aFeb ; "Feb"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C50CB
		mov	[esp+7Ch+C], offset aMarch ; "March"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aMarch ; "March"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C50D5
		mov	[esp+7Ch+C], offset aMar ; "Mar"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aMar ; "Mar"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C50D5
		mov	[esp+7Ch+C], offset aApril ; "April"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aApril ; "April"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C50F9
		mov	[esp+7Ch+C], offset aApr ; "Apr"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aApr ; "Apr"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C50F9
		mov	[esp+7Ch+C], offset aMay ; "May"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aMay ; "May"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C50F0
		mov	[esp+7Ch+C], offset aMay_0 ; "May"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aMay_0 ; "May"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C50F0
		mov	[esp+7Ch+C], offset aJune ; "June"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aJune ; "June"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C5120
		mov	[esp+7Ch+C], offset aJun ; "Jun"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aJun ; "Jun"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C5120
		mov	[esp+7Ch+C], offset aJuly ; "July"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aJuly ; "July"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C5117
		mov	[esp+7Ch+C], offset aJul ; "Jul"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aJul ; "Jul"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C5117
		mov	[esp+7Ch+C], offset aAugust ; "August"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aAugust ; "August"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C510E
		mov	[esp+7Ch+C], offset aAug ; "Aug"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aAug ; "Aug"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C510E
		mov	[esp+7Ch+C], offset aSeptember ; "September"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aSeptember ; "September"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C5105
		mov	[esp+7Ch+C], offset aSep ; "Sep"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aSep ; "Sep"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C5105
		mov	[esp+7Ch+C], offset aOctober ; "October"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aOctober ; "October"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C5140
		mov	[esp+7Ch+C], offset aOct ; "Oct"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aOct ; "Oct"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C5140
		mov	[esp+7Ch+C], offset aNovember ;	"November"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aNovember ;	"November"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C5149
		mov	[esp+7Ch+C], offset aNov ; "Nov"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aNov ; "Nov"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C5149
		mov	[esp+7Ch+C], offset aDecember ;	"December"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aDecember ;	"December"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	short loc_679C4E5E
		mov	[esp+7Ch+C], offset aDec ; "Dec"
		call	strlen
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aDec ; "Dec"
		mov	[esp+7Ch+MaxCount], eax
		mov	[esp+7Ch+var_68], eax
		call	[esp+7Ch+var_64]
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jnz	loc_679C3E25	; jumptable 679C3E63 default case

loc_679C4E5E:				; CODE XREF: sub_679C3D80+10ADj
		add	ebx, edx
		mov	al, 0Bh

loc_679C4E62:				; CODE XREF: sub_679C3D80+1346j
					; sub_679C3D80+1350j ...
		mov	edx, [esp+7Ch+arg_0]
		mov	[ebp+10h], eax
		mov	[esp+7Ch+var_5C], 1
		mov	dword ptr [edx], 2
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C4E7F:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		mov	[esp+7Ch+var_20], 0 ; jumptable	679C3E63 case 78
		movzx	eax, byte ptr [ebx]
		sub	eax, 30h
		cmp	al, 9
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		xor	eax, eax

loc_679C4E97:				; CODE XREF: sub_679C3D80+1137j
		lea	eax, [eax+eax*4]
		add	eax, eax
		mov	[esp+7Ch+var_20], eax
		movsx	edx, byte ptr [ebx]
		add	ebx, 1
		lea	eax, [eax+edx-30h]
		mov	[esp+7Ch+var_20], eax
		movzx	edx, byte ptr [ebx]
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_679C4E97
		lea	eax, [esp+7Ch+var_20]
		mov	[esp+7Ch+C], eax
		call	sub_679C77A0
		test	eax, eax
		jz	loc_679C3E25	; jumptable 679C3E63 default case
		mov	edx, [eax]
		mov	[ebp+0], edx
		mov	edx, [eax+4]
		mov	[ebp+4], edx
		mov	edx, [eax+8]
		mov	[ebp+8], edx
		mov	edx, [eax+0Ch]
		mov	[ebp+0Ch], edx
		mov	edx, [eax+10h]
		mov	[ebp+10h], edx
		mov	edx, [eax+14h]
		mov	[ebp+14h], edx
		mov	edx, [eax+18h]
		mov	[ebp+18h], edx
		mov	edx, [eax+1Ch]
		mov	[ebp+1Ch], edx
		mov	eax, [eax+20h]
		mov	[ebp+20h], eax
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C4F07:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		mov	edx, [esp+7Ch+arg_0] ; jumptable 679C3E63 case 77
		mov	ecx, ebp
		mov	[esp+7Ch+C], edx
		mov	edx, offset aIMSP_0 ; "%I:%M:%S	%p"
		jmp	loc_679C48A5
; ---------------------------------------------------------------------------

loc_679C4F1D:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		mov	edx, ds:_strnicmp ; jumptable 679C3E63 case 75
		mov	[esp+7Ch+MaxCount], 2 ;	MaxCount
		mov	[esp+7Ch+Str], ebx ; Str
		mov	[esp+7Ch+C], offset aAm	; "AM"
		mov	[esp+7Ch+var_68], edx
		call	edx ; _strnicmp
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jnz	loc_679C5152
		add	ebx, 2
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C4F50:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		mov	eax, [esp+7Ch+arg_0] ; jumptable 679C3E63 case 62
		mov	ecx, ebp
		mov	edx, offset aABEHMSY ; "%a %b %e %H:%M:%S %Y"
		mov	[esp+7Ch+C], eax
		jmp	loc_679C48EC
; ---------------------------------------------------------------------------

loc_679C4F66:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		movzx	eax, byte ptr [edi] ; jumptable	679C3E63 case 42
		add	edi, 1
		sub	eax, 48h
		cmp	al, 31h		; switch 50 cases
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		movzx	eax, al
		jmp	ds:off_679C94FC[eax*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_679C4F81:				; CODE XREF: sub_679C3D80+E3j
					; DATA XREF: .rdata:off_679C93A8o
		mov	edx, [esp+7Ch+arg_0] ; jumptable 679C3E63 cases	47,51
		mov	ecx, ebp
		mov	[esp+7Ch+C], edx
		mov	edx, offset aHMS ; "%H:%M:%S"
		jmp	loc_679C48A5
; ---------------------------------------------------------------------------

loc_679C4F97:				; CODE XREF: sub_679C3D80+121Fj
		add	ebx, 1

loc_679C4F9A:				; CODE XREF: sub_679C3D80+11FAj
					; DATA XREF: .rdata:off_679C94FCo
		movzx	eax, byte ptr [ebx] ; jumptable	679C4F7A case 49
		cmp	al, 20h
		jz	short loc_679C4F97
		lea	edx, [eax-30h]
		cmp	dl, 9
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		movsx	eax, al
		add	ebx, 1
		sub	eax, 30h
		lea	ecx, [eax+eax*4]
		add	ecx, ecx
		cmp	ecx, 63h
		ja	short loc_679C4FD7
		movzx	edx, byte ptr [ebx]
		cmp	dl, 2Fh
		jle	short loc_679C4FD7
		cmp	dl, 39h
		jg	short loc_679C4FD7
		movsx	edx, dl
		add	ebx, 1
		lea	eax, [ecx+edx-30h]

loc_679C4FD7:				; CODE XREF: sub_679C3D80+123Ej
					; sub_679C3D80+1246j ...
		cmp	eax, 63h
		ja	loc_679C3E25	; jumptable 679C3E63 default case
		cmp	eax, 44h
		ja	short loc_679C4FE8
		add	eax, 64h

loc_679C4FE8:				; CODE XREF: sub_679C3D80+1263j
		mov	[ebp+14h], eax
		mov	[esp+7Ch+var_5C], 1
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------

loc_679C4FF8:				; CODE XREF: sub_679C3D80+1280j
		add	ebx, 1

loc_679C4FFB:				; CODE XREF: sub_679C3D80+11FAj
					; DATA XREF: .rdata:off_679C94FCo
		movzx	eax, byte ptr [ebx] ; jumptable	679C4F7A case 47
		cmp	al, 20h
		jz	short loc_679C4FF8
		jmp	loc_679C43F1
; ---------------------------------------------------------------------------

loc_679C5007:				; CODE XREF: sub_679C3D80+128Fj
		add	ebx, 1

loc_679C500A:				; CODE XREF: sub_679C3D80+11FAj
					; DATA XREF: .rdata:off_679C94FCo
		movzx	eax, byte ptr [ebx] ; jumptable	679C4F7A case 37
		cmp	al, 20h
		jz	short loc_679C5007
		jmp	loc_679C431F
; ---------------------------------------------------------------------------

loc_679C5016:				; CODE XREF: sub_679C3D80+129Ej
		add	ebx, 1

loc_679C5019:				; CODE XREF: sub_679C3D80+11FAj
					; DATA XREF: .rdata:off_679C94FCo
		movzx	eax, byte ptr [ebx] ; jumptable	679C4F7A cases 28,29
		cmp	al, 20h
		jz	short loc_679C5016
		jmp	loc_679C41E8
; ---------------------------------------------------------------------------

loc_679C5025:				; CODE XREF: sub_679C3D80+12ADj
		add	ebx, 1

loc_679C5028:				; CODE XREF: sub_679C3D80+11FAj
					; DATA XREF: .rdata:off_679C94FCo
		movzx	eax, byte ptr [ebx] ; jumptable	679C4F7A case 15
		cmp	al, 20h
		jz	short loc_679C5025
		nop
		jmp	loc_679C40DB
; ---------------------------------------------------------------------------

loc_679C5035:				; CODE XREF: sub_679C3D80+12BDj
		add	ebx, 1

loc_679C5038:				; CODE XREF: sub_679C3D80+11FAj
					; DATA XREF: .rdata:off_679C94FCo
		movzx	eax, byte ptr [ebx] ; jumptable	679C4F7A case 14
		cmp	al, 20h
		jz	short loc_679C5035
		nop
		jmp	loc_679C408D
; ---------------------------------------------------------------------------

loc_679C5045:				; CODE XREF: sub_679C3D80+12CDj
		add	ebx, 1

loc_679C5048:				; CODE XREF: sub_679C3D80+11FAj
					; DATA XREF: .rdata:off_679C94FCo
		movzx	eax, byte ptr [ebx] ; jumptable	679C4F7A case 13
		cmp	al, 20h
		jz	short loc_679C5045
		nop
		jmp	loc_679C4033
; ---------------------------------------------------------------------------

loc_679C5055:				; CODE XREF: sub_679C3D80+12DDj
		add	ebx, 1

loc_679C5058:				; CODE XREF: sub_679C3D80+11FAj
					; DATA XREF: .rdata:off_679C94FCo
		movzx	eax, byte ptr [ebx] ; jumptable	679C4F7A case 11
		cmp	al, 20h
		jz	short loc_679C5055
		nop
		jmp	loc_679C3FE2
; ---------------------------------------------------------------------------

loc_679C5065:				; CODE XREF: sub_679C3D80+12EDj
		add	ebx, 1

loc_679C5068:				; CODE XREF: sub_679C3D80+11FAj
					; DATA XREF: .rdata:off_679C94FCo
		movzx	eax, byte ptr [ebx] ; jumptable	679C4F7A case 5
		cmp	al, 20h
		jz	short loc_679C5065
		nop
		jmp	loc_679C3F91
; ---------------------------------------------------------------------------

loc_679C5075:				; CODE XREF: sub_679C3D80+12FDj
		add	ebx, 1

loc_679C5078:				; CODE XREF: sub_679C3D80+11FAj
					; DATA XREF: .rdata:off_679C94FCo
		movzx	eax, byte ptr [ebx] ; jumptable	679C4F7A case 1
		cmp	al, 20h
		jz	short loc_679C5075
		nop
		jmp	loc_679C3F23
; ---------------------------------------------------------------------------

loc_679C5085:				; CODE XREF: sub_679C3D80+130Dj
		add	ebx, 1

loc_679C5088:				; CODE XREF: sub_679C3D80+11FAj
					; DATA XREF: .rdata:off_679C94FCo
		movzx	eax, byte ptr [ebx] ; jumptable	679C4F7A case 0
		cmp	al, 20h
		jz	short loc_679C5085
		nop
		jmp	loc_679C3ECA
; ---------------------------------------------------------------------------

loc_679C5095:				; CODE XREF: sub_679C3D80+1322j
		add	ecx, 1

loc_679C5098:				; CODE XREF: sub_679C3D80+7E1j
		movzx	eax, ds:word_679C973A[ecx+ecx]
		cmp	esi, eax
		jge	short loc_679C5095
		jmp	loc_679C4578
; ---------------------------------------------------------------------------
		align 10h

loc_679C50B0:				; CODE XREF: sub_679C3D80+133Dj
		add	ecx, 1

loc_679C50B3:				; CODE XREF: sub_679C3D80+A2Bj
		movzx	eax, ds:word_679C973A[ecx+ecx]
		cmp	eax, esi
		jle	short loc_679C50B0
		jmp	loc_679C47C2
; ---------------------------------------------------------------------------

loc_679C50C4:				; CODE XREF: sub_679C3D80+CA3j
					; sub_679C3D80+CD2j
		add	ebx, edx
		jmp	loc_679C4E62
; ---------------------------------------------------------------------------

loc_679C50CB:				; CODE XREF: sub_679C3D80+D01j
					; sub_679C3D80+D30j
		add	ebx, edx
		mov	al, 1
		nop
		jmp	loc_679C4E62
; ---------------------------------------------------------------------------

loc_679C50D5:				; CODE XREF: sub_679C3D80+D5Fj
					; sub_679C3D80+D8Ej
		add	ebx, edx
		mov	al, 2
		jmp	loc_679C4E62
; ---------------------------------------------------------------------------

loc_679C50DE:				; CODE XREF: sub_679C3D80+763j
		cmp	byte ptr [esp+7Ch+var_64], 0
		jz	loc_679C45F8
		jmp	loc_679C44E9
; ---------------------------------------------------------------------------
		align 10h

loc_679C50F0:				; CODE XREF: sub_679C3D80+E1Bj
					; sub_679C3D80+E4Aj
		add	ebx, edx
		mov	al, 4
		jmp	loc_679C4E62
; ---------------------------------------------------------------------------

loc_679C50F9:				; CODE XREF: sub_679C3D80+DBDj
					; sub_679C3D80+DECj
		add	ebx, edx
		mov	al, 3
		lea	esi, [esi+0]
		jmp	loc_679C4E62
; ---------------------------------------------------------------------------

loc_679C5105:				; CODE XREF: sub_679C3D80+F93j
					; sub_679C3D80+FC2j
		add	ebx, edx
		mov	al, 8
		jmp	loc_679C4E62
; ---------------------------------------------------------------------------

loc_679C510E:				; CODE XREF: sub_679C3D80+F35j
					; sub_679C3D80+F64j
		add	ebx, edx
		mov	al, 7
		jmp	loc_679C4E62
; ---------------------------------------------------------------------------

loc_679C5117:				; CODE XREF: sub_679C3D80+ED7j
					; sub_679C3D80+F06j
		add	ebx, edx
		mov	al, 6
		jmp	loc_679C4E62
; ---------------------------------------------------------------------------

loc_679C5120:				; CODE XREF: sub_679C3D80+E79j
					; sub_679C3D80+EA8j
		add	ebx, edx
		mov	al, 5
		jmp	loc_679C4E62
; ---------------------------------------------------------------------------

loc_679C5129:				; CODE XREF: sub_679C3D80+9B9j
		cmp	byte ptr [esp+7Ch+var_64], 0
		jnz	loc_679C473F

loc_679C5134:				; CODE XREF: sub_679C3D80+A54j
					; sub_679C3D80+AC5j
		mov	eax, [esp+7Ch+var_5C]
		mov	[ebp+18h], eax
		jmp	loc_679C3E27
; ---------------------------------------------------------------------------

loc_679C5140:				; CODE XREF: sub_679C3D80+FF1j
					; sub_679C3D80+1020j
		add	ebx, edx
		mov	al, 9
		jmp	loc_679C4E62
; ---------------------------------------------------------------------------

loc_679C5149:				; CODE XREF: sub_679C3D80+104Fj
					; sub_679C3D80+107Ej
		add	ebx, edx
		mov	al, 0Ah
		jmp	loc_679C4E62
; ---------------------------------------------------------------------------

loc_679C5152:				; CODE XREF: sub_679C3D80+11C2j
		mov	[esp+7Ch+MaxCount], 2
		mov	[esp+7Ch+Str], ebx
		mov	[esp+7Ch+C], offset aPm	; "PM"
		call	edx
		test	eax, eax
		jnz	loc_679C3E25	; jumptable 679C3E63 default case
		add	ebx, 2
		mov	[esp+7Ch+var_40], 1
		jmp	loc_679C3DFC	; jumptable 679C3E63 case 53
; ---------------------------------------------------------------------------
		align 10h

loc_679C5180:				; CODE XREF: sub_679C3D80+C44j
		mov	eax, [esp+7Ch+arg_0]
		cmp	dword ptr [eax], 1
		jz	loc_679C3E25	; jumptable 679C3E63 default case
		mov	[esp+7Ch+C], offset aMonday ; "Monday"
		call	strlen
		mov	[esp+7Ch+Str], ebx ; Str
		mov	[esp+7Ch+C], offset aMonday ; "Monday"
		mov	[esp+7Ch+MaxCount], eax	; MaxCount
		mov	[esp+7Ch+var_68], eax
		call	ds:_strnicmp
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C54AF
		mov	[esp+7Ch+C], offset aMon ; "Mon"
		call	strlen
		mov	[esp+7Ch+Str], ebx ; Str
		mov	[esp+7Ch+C], offset aMon ; "Mon"
		mov	[esp+7Ch+MaxCount], eax	; MaxCount
		mov	[esp+7Ch+var_68], eax
		call	ds:_strnicmp
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jnz	short loc_679C51F7
		add	ebx, edx
		mov	al, 1
		jmp	loc_679C49CC
; ---------------------------------------------------------------------------

loc_679C51F7:				; CODE XREF: sub_679C3D80+146Cj
		mov	edx, [esp+7Ch+arg_0]
		cmp	dword ptr [edx], 1
		jz	loc_679C3E25	; jumptable 679C3E63 default case
		mov	[esp+7Ch+C], offset aTuesday ; "Tuesday"
		call	strlen
		mov	[esp+7Ch+Str], ebx ; Str
		mov	[esp+7Ch+C], offset aTuesday ; "Tuesday"
		mov	[esp+7Ch+MaxCount], eax	; MaxCount
		mov	[esp+7Ch+var_68], eax
		call	ds:_strnicmp
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C547A
		mov	[esp+7Ch+C], offset aTue ; "Tue"
		call	strlen
		mov	[esp+7Ch+Str], ebx ; Str
		mov	[esp+7Ch+C], offset aTue ; "Tue"
		mov	[esp+7Ch+MaxCount], eax	; MaxCount
		mov	[esp+7Ch+var_68], eax
		call	ds:_strnicmp
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jnz	short loc_679C526E
		add	ebx, edx
		mov	al, 2
		jmp	loc_679C49CC
; ---------------------------------------------------------------------------

loc_679C526E:				; CODE XREF: sub_679C3D80+14E3j
		mov	eax, [esp+7Ch+arg_0]
		cmp	dword ptr [eax], 1
		jz	loc_679C3E25	; jumptable 679C3E63 default case
		mov	[esp+7Ch+C], offset aWednesday ; "Wednesday"
		call	strlen
		mov	[esp+7Ch+Str], ebx ; Str
		mov	[esp+7Ch+C], offset aWednesday ; "Wednesday"
		mov	[esp+7Ch+MaxCount], eax	; MaxCount
		mov	[esp+7Ch+var_68], eax
		call	ds:_strnicmp
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C546E
		mov	[esp+7Ch+C], offset aWed ; "Wed"
		call	strlen
		mov	[esp+7Ch+Str], ebx ; Str
		mov	[esp+7Ch+C], offset aWed ; "Wed"
		mov	[esp+7Ch+MaxCount], eax	; MaxCount
		mov	[esp+7Ch+var_68], eax
		call	ds:_strnicmp
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jnz	short loc_679C52E5
		add	ebx, edx
		mov	al, 3
		jmp	loc_679C49CC
; ---------------------------------------------------------------------------

loc_679C52E5:				; CODE XREF: sub_679C3D80+155Aj
		mov	edx, [esp+7Ch+arg_0]
		cmp	dword ptr [edx], 1
		jz	loc_679C3E25	; jumptable 679C3E63 default case
		mov	[esp+7Ch+C], offset aThursday ;	"Thursday"
		call	strlen
		mov	[esp+7Ch+Str], ebx ; Str
		mov	[esp+7Ch+C], offset aThursday ;	"Thursday"
		mov	[esp+7Ch+MaxCount], eax	; MaxCount
		mov	[esp+7Ch+var_68], eax
		call	ds:_strnicmp
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C5462
		mov	[esp+7Ch+C], offset aThu ; "Thu"
		call	strlen
		mov	[esp+7Ch+Str], ebx ; Str
		mov	[esp+7Ch+C], offset aThu ; "Thu"
		mov	[esp+7Ch+MaxCount], eax	; MaxCount
		mov	[esp+7Ch+var_68], eax
		call	ds:_strnicmp
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jnz	short loc_679C535C
		add	ebx, edx
		mov	al, 4
		jmp	loc_679C49CC
; ---------------------------------------------------------------------------

loc_679C535C:				; CODE XREF: sub_679C3D80+15D1j
		mov	eax, [esp+7Ch+arg_0]
		cmp	dword ptr [eax], 1
		jz	loc_679C3E25	; jumptable 679C3E63 default case
		mov	[esp+7Ch+C], offset aFriday ; "Friday"
		call	strlen
		mov	[esp+7Ch+Str], ebx ; Str
		mov	[esp+7Ch+C], offset aFriday ; "Friday"
		mov	[esp+7Ch+MaxCount], eax	; MaxCount
		mov	[esp+7Ch+var_68], eax
		call	ds:_strnicmp
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	loc_679C544A
		mov	[esp+7Ch+C], offset aFri ; "Fri"
		call	strlen
		mov	[esp+7Ch+Str], ebx ; Str
		mov	[esp+7Ch+C], offset aFri ; "Fri"
		mov	[esp+7Ch+MaxCount], eax	; MaxCount
		mov	[esp+7Ch+var_68], eax
		call	ds:_strnicmp
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jnz	short loc_679C53D3
		add	ebx, edx
		mov	al, 5
		jmp	loc_679C49CC
; ---------------------------------------------------------------------------

loc_679C53D3:				; CODE XREF: sub_679C3D80+1648j
		mov	edx, [esp+7Ch+arg_0]
		cmp	dword ptr [edx], 1
		jz	loc_679C3E25	; jumptable 679C3E63 default case
		mov	[esp+7Ch+C], offset aSaturday ;	"Saturday"
		call	strlen
		mov	[esp+7Ch+Str], ebx ; Str
		mov	[esp+7Ch+C], offset aSaturday ;	"Saturday"
		mov	[esp+7Ch+MaxCount], eax	; MaxCount
		mov	[esp+7Ch+var_68], eax
		call	ds:_strnicmp
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jz	short loc_679C5456
		mov	[esp+7Ch+C], offset aSat ; "Sat"
		call	strlen
		mov	[esp+7Ch+Str], ebx ; Str
		mov	[esp+7Ch+C], offset aSat ; "Sat"
		mov	[esp+7Ch+MaxCount], eax	; MaxCount
		mov	[esp+7Ch+var_68], eax
		call	ds:_strnicmp
		mov	edx, [esp+7Ch+var_68]
		test	eax, eax
		jnz	loc_679C3E25	; jumptable 679C3E63 default case
		add	ebx, edx
		mov	al, 6
		jmp	loc_679C49CC
; ---------------------------------------------------------------------------

loc_679C544A:				; CODE XREF: sub_679C3D80+1617j
		add	ebx, edx
		mov	eax, 5
		jmp	loc_679C49CC
; ---------------------------------------------------------------------------

loc_679C5456:				; CODE XREF: sub_679C3D80+168Ej
		add	ebx, edx
		mov	eax, 6
		jmp	loc_679C49CC
; ---------------------------------------------------------------------------

loc_679C5462:				; CODE XREF: sub_679C3D80+15A0j
		add	ebx, edx
		mov	eax, 4
		jmp	loc_679C49CC
; ---------------------------------------------------------------------------

loc_679C546E:				; CODE XREF: sub_679C3D80+1529j
		add	ebx, edx
		mov	eax, 3
		jmp	loc_679C49CC
; ---------------------------------------------------------------------------

loc_679C547A:				; CODE XREF: sub_679C3D80+14B2j
		add	ebx, edx
		mov	eax, 2
		jmp	loc_679C49CC
; ---------------------------------------------------------------------------

loc_679C5486:				; CODE XREF: sub_679C3D80+A19j
		test	edx, edx
		jnz	loc_679C552C
		mov	edx, [esp+7Ch+var_60]
		test	edx, edx
		jz	short loc_679C5513
		xor	ecx, ecx
		jmp	short loc_679C549D
; ---------------------------------------------------------------------------

loc_679C549A:				; CODE XREF: sub_679C3D80+172Dj
		add	ecx, 1

loc_679C549D:				; CODE XREF: sub_679C3D80+1718j
		movzx	eax, ds:word_679C9720[ecx+ecx]
		cmp	esi, eax
		jl	loc_679C47C2
		jmp	short loc_679C549A
; ---------------------------------------------------------------------------

loc_679C54AF:				; CODE XREF: sub_679C3D80+143Bj
		add	ebx, edx
		mov	eax, 1
		jmp	loc_679C49CC
; ---------------------------------------------------------------------------

loc_679C54BB:				; CODE XREF: sub_679C3D80+C13j
		add	ebx, edx
		xor	eax, eax
		nop
		jmp	loc_679C49CC
; ---------------------------------------------------------------------------

loc_679C54C5:				; CODE XREF: sub_679C3D80+A21j
		mov	ecx, [esp+7Ch+var_60]
		test	ecx, ecx
		jz	loc_679C558B
		xor	ecx, ecx
		jmp	short loc_679C54D8
; ---------------------------------------------------------------------------

loc_679C54D5:				; CODE XREF: sub_679C3D80+1768j
		add	ecx, 1

loc_679C54D8:				; CODE XREF: sub_679C3D80+1753j
		movzx	eax, ds:word_679C9720[ecx+ecx]
		cmp	esi, eax
		jl	loc_679C47C2
		jmp	short loc_679C54D5
; ---------------------------------------------------------------------------

loc_679C54EA:				; CODE XREF: sub_679C3D80+7CFj
		test	edx, edx
		jnz	loc_679C55BD
		mov	ecx, [esp+7Ch+var_60]
		test	ecx, ecx
		jz	short loc_679C5572
		xor	ecx, ecx
		jmp	short loc_679C5501
; ---------------------------------------------------------------------------

loc_679C54FE:				; CODE XREF: sub_679C3D80+1791j
		add	ecx, 1

loc_679C5501:				; CODE XREF: sub_679C3D80+177Cj
		movzx	eax, ds:word_679C9720[ecx+ecx]
		cmp	esi, eax
		jl	loc_679C4578
		jmp	short loc_679C54FE
; ---------------------------------------------------------------------------

loc_679C5513:				; CODE XREF: sub_679C3D80+1714j
		xor	ecx, ecx
		jmp	short loc_679C551A
; ---------------------------------------------------------------------------

loc_679C5517:				; CODE XREF: sub_679C3D80+17AAj
		add	ecx, 1

loc_679C551A:				; CODE XREF: sub_679C3D80+1795j
		movzx	eax, ds:word_679C9720[ecx+ecx]
		cmp	esi, eax
		jl	loc_679C47C2
		jmp	short loc_679C5517
; ---------------------------------------------------------------------------

loc_679C552C:				; CODE XREF: sub_679C3D80+1708j
		mov	eax, [esp+7Ch+var_60]
		test	eax, eax
		jz	short loc_679C55A4
		xor	ecx, ecx
		jmp	short loc_679C553B
; ---------------------------------------------------------------------------

loc_679C5538:				; CODE XREF: sub_679C3D80+17CBj
		add	ecx, 1

loc_679C553B:				; CODE XREF: sub_679C3D80+17B6j
		movzx	eax, ds:word_679C9720[ecx+ecx]
		cmp	esi, eax
		jl	loc_679C47C2
		jmp	short loc_679C5538
; ---------------------------------------------------------------------------

loc_679C554D:				; CODE XREF: sub_679C3D80+7D7j
		mov	eax, [esp+7Ch+var_60]
		test	eax, eax
		jz	loc_679C55DE
		xor	ecx, ecx
		jmp	short loc_679C5560
; ---------------------------------------------------------------------------

loc_679C555D:				; CODE XREF: sub_679C3D80+17F0j
		add	ecx, 1

loc_679C5560:				; CODE XREF: sub_679C3D80+17DBj
		movzx	eax, ds:word_679C9720[ecx+ecx]
		cmp	esi, eax
		jl	loc_679C4578
		jmp	short loc_679C555D
; ---------------------------------------------------------------------------

loc_679C5572:				; CODE XREF: sub_679C3D80+1778j
		xor	ecx, ecx
		jmp	short loc_679C5579
; ---------------------------------------------------------------------------

loc_679C5576:				; CODE XREF: sub_679C3D80+1809j
		add	ecx, 1

loc_679C5579:				; CODE XREF: sub_679C3D80+17F4j
		movzx	eax, ds:word_679C9720[ecx+ecx]
		cmp	esi, eax
		jl	loc_679C4578
		jmp	short loc_679C5576
; ---------------------------------------------------------------------------

loc_679C558B:				; CODE XREF: sub_679C3D80+174Bj
		xor	ecx, ecx
		jmp	short loc_679C5592
; ---------------------------------------------------------------------------

loc_679C558F:				; CODE XREF: sub_679C3D80+1822j
		add	ecx, 1

loc_679C5592:				; CODE XREF: sub_679C3D80+180Dj
		movzx	eax, ds:word_679C973A[ecx+ecx]
		cmp	esi, eax
		jl	loc_679C47C2
		jmp	short loc_679C558F
; ---------------------------------------------------------------------------

loc_679C55A4:				; CODE XREF: sub_679C3D80+17B2j
		xor	ecx, ecx
		jmp	short loc_679C55AB
; ---------------------------------------------------------------------------

loc_679C55A8:				; CODE XREF: sub_679C3D80+183Bj
		add	ecx, 1

loc_679C55AB:				; CODE XREF: sub_679C3D80+1826j
		movzx	eax, ds:word_679C9720[ecx+ecx]
		cmp	esi, eax
		jl	loc_679C47C2
		jmp	short loc_679C55A8
; ---------------------------------------------------------------------------

loc_679C55BD:				; CODE XREF: sub_679C3D80+176Cj
		mov	edx, [esp+7Ch+var_60]
		test	edx, edx
		jz	short loc_679C55F7
		xor	ecx, ecx
		jmp	short loc_679C55CC
; ---------------------------------------------------------------------------

loc_679C55C9:				; CODE XREF: sub_679C3D80+185Cj
		add	ecx, 1

loc_679C55CC:				; CODE XREF: sub_679C3D80+1847j
		movzx	eax, ds:word_679C9720[ecx+ecx]
		cmp	esi, eax
		jl	loc_679C4578
		jmp	short loc_679C55C9
; ---------------------------------------------------------------------------

loc_679C55DE:				; CODE XREF: sub_679C3D80+17D3j
		xor	ecx, ecx
		jmp	short loc_679C55E5
; ---------------------------------------------------------------------------

loc_679C55E2:				; CODE XREF: sub_679C3D80+1875j
		add	ecx, 1

loc_679C55E5:				; CODE XREF: sub_679C3D80+1860j
		movzx	eax, ds:word_679C973A[ecx+ecx]
		cmp	esi, eax
		jl	loc_679C4578
		jmp	short loc_679C55E2
; ---------------------------------------------------------------------------

loc_679C55F7:				; CODE XREF: sub_679C3D80+1843j
		xor	ecx, ecx
		jmp	short loc_679C55FE
; ---------------------------------------------------------------------------

loc_679C55FB:				; CODE XREF: sub_679C3D80+188Ej
		add	ecx, 1

loc_679C55FE:				; CODE XREF: sub_679C3D80+1879j
		movzx	eax, ds:word_679C9720[ecx+ecx]
		cmp	esi, eax
		jl	loc_679C4578
		jmp	short loc_679C55FB
sub_679C3D80	endp

; Exported entry  88. strptime

; =============== S U B	R O U T	I N E =======================================


		public strptime
strptime	proc near

var_2C		= dword	ptr -2Ch
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 2Ch
		lea	eax, [esp+2Ch+var_10]
		mov	ecx, [esp+2Ch+arg_8]
		mov	[esp+2Ch+var_2C], eax
		mov	edx, [esp+2Ch+arg_4]
		mov	eax, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_10], 2
		call	sub_679C3D80
		add	esp, 2Ch
		retn
strptime	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   5. closelog

; =============== S U B	R O U T	I N E =======================================


		public closelog
closelog	proc near
		rep retn
closelog	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  67. openlog

; =============== S U B	R O U T	I N E =======================================


		public openlog
openlog		proc near
		rep retn
openlog		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  78. setlogmask

; =============== S U B	R O U T	I N E =======================================


		public setlogmask
setlogmask	proc near
		xor	eax, eax
		retn
setlogmask	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  90. syslog

; =============== S U B	R O U T	I N E =======================================


		public syslog
syslog		proc near
		rep retn
syslog		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  33. gmtime_r

; =============== S U B	R O U T	I N E =======================================


		public gmtime_r
gmtime_r	proc near

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, [esp+1Ch+arg_0]
		mov	ebx, [esp+1Ch+arg_4]
		mov	[esp+1Ch+var_1C], eax
		call	sub_679C77B0
		mov	edx, [eax]
		mov	[ebx], edx
		mov	edx, [eax+4]
		mov	[ebx+4], edx
		mov	edx, [eax+8]
		mov	[ebx+8], edx
		mov	edx, [eax+0Ch]
		mov	[ebx+0Ch], edx
		mov	edx, [eax+10h]
		mov	[ebx+10h], edx
		mov	edx, [eax+14h]
		mov	[ebx+14h], edx
		mov	edx, [eax+18h]
		mov	[ebx+18h], edx
		mov	edx, [eax+1Ch]
		mov	[ebx+1Ch], edx
		mov	eax, [eax+20h]
		mov	[ebx+20h], eax
		mov	eax, ebx
		add	esp, 18h
		pop	ebx
		retn
gmtime_r	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  57. localtime_r

; =============== S U B	R O U T	I N E =======================================


		public localtime_r
localtime_r	proc near

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, [esp+1Ch+arg_0]
		mov	ebx, [esp+1Ch+arg_4]
		mov	[esp+1Ch+var_1C], eax
		call	sub_679C77A0
		mov	edx, [eax]
		mov	[ebx], edx
		mov	edx, [eax+4]
		mov	[ebx+4], edx
		mov	edx, [eax+8]
		mov	[ebx+8], edx
		mov	edx, [eax+0Ch]
		mov	[ebx+0Ch], edx
		mov	edx, [eax+10h]
		mov	[ebx+10h], edx
		mov	edx, [eax+14h]
		mov	[ebx+14h], edx
		mov	edx, [eax+18h]
		mov	[ebx+18h], edx
		mov	edx, [eax+1Ch]
		mov	[ebx+1Ch], edx
		mov	eax, [eax+20h]
		mov	[ebx+20h], eax
		mov	eax, ebx
		add	esp, 18h
		pop	ebx
		retn
localtime_r	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  31. gettimeofday

; =============== S U B	R O U T	I N E =======================================


		public gettimeofday
gettimeofday	proc near

lpSystemTimeAsFileTime=	dword ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
SystemTimeAsFileTime= _FILETIME	ptr -14h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 2Ch
		lea	eax, [esp+2Ch+SystemTimeAsFileTime]
		mov	[esp+2Ch+var_C], ebx
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_8], esi
		mov	[esp+2Ch+var_4], edi
		mov	[esp+2Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	esi, [esp+2Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	edi, [esp+2Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	[esp+2Ch+var_24], 0Ah
		mov	[esp+2Ch+var_20], 0
		mov	[esp+2Ch+lpSystemTimeAsFileTime], esi
		mov	[esp+2Ch+var_28], edi
		call	__udivdi3
		mov	[esp+2Ch+var_24], 0F4240h
		mov	[esp+2Ch+var_20], 0
		mov	[esp+2Ch+lpSystemTimeAsFileTime], eax
		mov	[esp+2Ch+var_28], edx
		call	__umoddi3
		mov	[ebx+4], eax
		mov	[esp+2Ch+lpSystemTimeAsFileTime], esi
		mov	[esp+2Ch+var_28], edi
		mov	[esp+2Ch+var_24], 989680h
		mov	[esp+2Ch+var_20], 0
		call	__udivdi3
		add	eax, 49EF6F00h
		mov	[ebx], eax
		xor	eax, eax
		mov	ebx, [esp+2Ch+var_C]
		mov	esi, [esp+2Ch+var_8]
		mov	edi, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
gettimeofday	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  94. utimes

; =============== S U B	R O U T	I N E =======================================


; int __cdecl utimes(LPCSTR, int)
		public utimes
utimes		proc near

lpFileName	= dword	ptr -4Ch
dwDesiredAccess	= dword	ptr -48h
dwShareMode	= dword	ptr -44h
lpSecurityAttributes= dword ptr	-40h
dwCreationDisposition= dword ptr -3Ch
dwFlagsAndAttributes= dword ptr	-38h
hTemplateFile	= dword	ptr -34h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
LastWriteTime	= FILETIME ptr -1Ch
LastAccessTime	= FILETIME ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	edi
		push	esi
		push	ebx
		sub	esp, 40h
		mov	ebx, [esp+4Ch+arg_4]
		test	ebx, ebx
		jz	loc_679C5930
		mov	eax, [ebx]
		mov	ecx, 989680h
		mov	esi, [ebx+4]
		imul	ecx
		lea	esi, [esi+esi*4]
		add	esi, esi
		mov	edi, esi
		mov	[esp+4Ch+var_24], eax
		sar	edi, 1Fh
		add	[esp+4Ch+var_24], esi
		mov	[esp+4Ch+var_20], edx
		adc	[esp+4Ch+var_20], edi
		add	[esp+4Ch+var_24], 0D53E8000h
		adc	[esp+4Ch+var_20], 19DB1DEh
		mov	edx, [esp+4Ch+var_24]
		mov	eax, [esp+4Ch+var_20]
		mov	[esp+4Ch+LastAccessTime.dwLowDateTime],	edx
		mov	[esp+4Ch+LastAccessTime.dwHighDateTime], eax
		mov	eax, ecx
		mov	ecx, [ebx+0Ch]
		imul	dword ptr [ebx+8]
		lea	ecx, [ecx+ecx*4]
		add	ecx, ecx
		mov	ebx, ecx
		mov	[esp+4Ch+var_24], eax
		sar	ebx, 1Fh
		add	[esp+4Ch+var_24], ecx
		mov	[esp+4Ch+var_20], edx
		adc	[esp+4Ch+var_20], ebx
		add	[esp+4Ch+var_24], 0D53E8000h
		mov	edx, [esp+4Ch+var_24]
		adc	[esp+4Ch+var_20], 19DB1DEh
		mov	[esp+4Ch+LastWriteTime.dwLowDateTime], edx
		mov	eax, [esp+4Ch+var_20]
		mov	[esp+4Ch+LastWriteTime.dwHighDateTime],	eax

loc_679C585A:				; CODE XREF: utimes+18Ej
		mov	eax, [esp+4Ch+arg_0]
		mov	[esp+4Ch+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+4Ch+dwFlagsAndAttributes],	0 ; dwFlagsAndAttributes
		mov	[esp+4Ch+dwCreationDisposition], 3 ; dwCreationDisposition
		mov	[esp+4Ch+lpSecurityAttributes],	0 ; lpSecurityAttributes
		mov	[esp+4Ch+dwShareMode], 7 ; dwShareMode
		mov	[esp+4Ch+dwDesiredAccess], 100h	; dwDesiredAccess
		mov	[esp+4Ch+lpFileName], eax ; lpFileName
		call	ds:CreateFileA
		sub	esp, 1Ch
		cmp	eax, 0FFFFFFFFh
		mov	ebx, eax
		jz	short loc_679C58E0
		lea	eax, [esp+4Ch+LastWriteTime]
		mov	[esp+4Ch+lpSecurityAttributes],	eax ; lpLastWriteTime
		lea	eax, [esp+4Ch+LastAccessTime]
		mov	[esp+4Ch+dwShareMode], eax ; lpLastAccessTime
		mov	[esp+4Ch+dwDesiredAccess], 0 ; lpCreationTime
		mov	[esp+4Ch+lpFileName], ebx ; hFile
		call	ds:SetFileTime
		sub	esp, 10h
		test	eax, eax
		jz	short loc_679C5915
		mov	[esp+4Ch+lpFileName], ebx ; hObject
		call	ds:CloseHandle
		xor	eax, eax
		sub	esp, 4

loc_679C58D7:				; CODE XREF: utimes+153j utimes+1A4j
		add	esp, 40h
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C58E0:				; CODE XREF: utimes+DFj
		call	ds:GetLastError
		cmp	eax, 3
		jz	short loc_679C5902
		nop
		lea	esi, [esi+0]
		jbe	short loc_679C5915
		cmp	eax, 5
		jz	short loc_679C5953
		cmp	eax, 0Fh
		lea	esi, [esi+0]
		jnz	short loc_679C5915

loc_679C5902:				; CODE XREF: utimes+129j
		call	ds:_errno
		mov	dword ptr [eax], 14h
		mov	eax, 0FFFFFFFFh
		jmp	short loc_679C58D7
; ---------------------------------------------------------------------------

loc_679C5915:				; CODE XREF: utimes+107j utimes+130j ...
		call	ds:_errno
		mov	dword ptr [eax], 2
		add	esp, 40h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C5930:				; CODE XREF: utimes+Cj
		lea	eax, [esp+4Ch+LastAccessTime]
		mov	ebx, ds:GetSystemTimeAsFileTime
		mov	[esp+4Ch+lpFileName], eax ; lpSystemTimeAsFileTime
		call	ebx ; GetSystemTimeAsFileTime
		sub	esp, 4
		lea	eax, [esp+4Ch+LastWriteTime]
		mov	[esp+4Ch+lpFileName], eax ; lpSystemTimeAsFileTime
		call	ebx ; GetSystemTimeAsFileTime
		sub	esp, 4
		jmp	loc_679C585A
; ---------------------------------------------------------------------------

loc_679C5953:				; CODE XREF: utimes+135j
		call	ds:_errno
		mov	dword ptr [eax], 0Dh
		mov	eax, 0FFFFFFFFh
		jmp	loc_679C58D7
utimes		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  92. uname

; =============== S U B	R O U T	I N E =======================================


; int __cdecl uname(char *Dest)
		public uname
uname		proc near

lpVersionInformation= dword ptr	-29Ch
Format		= dword	ptr -298h
var_294		= dword	ptr -294h
var_290		= dword	ptr -290h
var_28C		= dword	ptr -28Ch
VersionInformation= _OSVERSIONINFOW ptr	-270h
var_156		= byte ptr -156h
var_154		= _OSVERSIONINFOW ptr -154h
SystemInfo	= _SYSTEM_INFO ptr -40h
Dest		= dword	ptr  4

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 28Ch
		mov	edi, ds:GetVersionExW
		lea	esi, [esp+29Ch+VersionInformation]
		mov	ebx, [esp+29Ch+Dest]
		mov	[esp+29Ch+VersionInformation.dwOSVersionInfoSize], 11Ch
		mov	[esp+29Ch+lpVersionInformation], esi ; lpVersionInformation
		call	edi ; GetVersionExW
		sub	esp, 4
		test	eax, eax
		mov	ebp, eax
		jz	loc_679C5AE1
		lea	edi, [esp+29Ch+var_154]
		mov	ecx, 45h
		rep movsd

loc_679C59B3:				; CODE XREF: uname+18Dj
		lea	esi, [ebx+14h]
		mov	[esp+29Ch+Format], 14h ; int
		mov	[esp+29Ch+lpVersionInformation], esi ; LPSTR
		call	kde_gethostname
		test	eax, eax
		js	loc_679C5C84

loc_679C59CE:				; CODE XREF: uname+328j
		mov	eax, [esp+29Ch+var_154.dwPlatformId]
		cmp	eax, 2
		jz	loc_679C5B70
		cmp	eax, 3
		jz	loc_679C5C10
		cmp	eax, 1
		jz	loc_679C5C21
		mov	eax, [esp+29Ch+var_154.dwMinorVersion]
		mov	esi, offset byte_679C9766

loc_679C59FC:				; CODE XREF: uname+20Cj uname+2ACj ...
		mov	[esp+29Ch+var_28C], eax
		mov	eax, [esp+29Ch+var_154.dwMajorVersion]
		mov	[esp+29Ch+var_294], esi
		mov	[esp+29Ch+Format], offset aMingw32_SU_U	; "MINGW32_%s-%u.%u"
		mov	[esp+29Ch+lpVersionInformation], ebx ; Dest
		mov	[esp+29Ch+var_290], eax
		call	sprintf
		mov	eax, [esp+29Ch+var_154.dwPlatformId]
		cmp	eax, 2
		jz	loc_679C5B08
		cmp	eax, 3
		jz	loc_679C5BE0
		lea	eax, [ebx+28h]
		mov	[esp+29Ch+var_294], esi
		mov	[esp+29Ch+Format], offset aWindowsS ; "Windows %s"
		mov	[esp+29Ch+lpVersionInformation], eax ; Dest
		call	sprintf

loc_679C5A4F:				; CODE XREF: uname+1F6j uname+299j ...
		lea	eax, [esp+29Ch+var_154.szCSDVersion]
		mov	[esp+29Ch+Format], eax ; Source
		lea	eax, [ebx+3Ch]
		mov	[esp+29Ch+lpVersionInformation], eax ; Dest
		call	strcpy
		lea	eax, [esp+29Ch+SystemInfo]
		mov	[esp+29Ch+lpVersionInformation], eax ; lpSystemInfo
		call	ds:GetSystemInfo
		sub	esp, 4
		mov	eax, [esp+29Ch+var_154.dwPlatformId]
		sub	eax, 2
		cmp	eax, 1
		jbe	loc_679C5BC0
		mov	ecx, [esp+29Ch+SystemInfo.dwProcessorType]
		cmp	ecx, 898h
		jz	loc_679C5BA2	; jumptable 679C5BD7 case 6
		cmp	ecx, 21D8h
		jz	loc_679C5B81	; jumptable 679C5BD7 case 9
		mov	eax, ecx
		mov	edx, 51EB851Fh
		mul	edx
		mov	eax, ecx
		shr	edx, 5
		imul	edx, 64h
		sub	eax, edx
		cmp	eax, 56h
		jz	loc_679C5CB9

loc_679C5AC6:				; CODE XREF: uname+259j uname+267j
					; DATA XREF: ...
		mov	dword ptr [ebx+50h], 6E6B6E75h ; jumptable 679C5BD7 default case
		mov	dword ptr [ebx+54h], 6E776Fh

loc_679C5AD4:				; CODE XREF: uname+360j uname+370j ...
		add	esp, 28Ch
		xor	eax, eax
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_679C5AE1:				; CODE XREF: uname+2Fj
		lea	eax, [esp+29Ch+var_154]
		mov	[esp+29Ch+var_154.dwOSVersionInfoSize],	114h
		mov	[esp+29Ch+lpVersionInformation], eax ; lpVersionInformation
		call	edi ; GetVersionExW
		sub	esp, 4
		test	eax, eax
		jnz	loc_679C59B3
		call	abort
; ---------------------------------------------------------------------------

loc_679C5B08:				; CODE XREF: uname+B9j
		mov	esi, [esp+29Ch+var_154.dwMajorVersion]
		mov	eax, offset dword_679C98A0
		mov	edi, [esp+29Ch+var_154.dwMinorVersion]
		jmp	short loc_679C5B28
; ---------------------------------------------------------------------------
		align 10h

loc_679C5B20:				; CODE XREF: uname+1BCj
		cmp	edx, 0FFFFFFFFh
		jz	short loc_679C5B2E

loc_679C5B25:				; CODE XREF: uname+1C8j
		add	eax, 10h

loc_679C5B28:				; CODE XREF: uname+1ABj
		mov	edx, [eax]
		cmp	edx, esi
		jnz	short loc_679C5B20

loc_679C5B2E:				; CODE XREF: uname+1B3j
		mov	ecx, [eax+4]
		cmp	ecx, edi
		jz	short loc_679C5B3A
		cmp	ecx, 0FFFFFFFFh
		jnz	short loc_679C5B25

loc_679C5B3A:				; CODE XREF: uname+1C3j
		test	ebp, ebp
		jnz	loc_679C5C42

loc_679C5B42:				; CODE XREF: uname+2DAj
		mov	ebp, [eax+0Ch]

loc_679C5B45:				; CODE XREF: uname+2E6j
		cmp	edx, 0FFFFFFFFh
		jz	loc_679C5C60
		cmp	ecx, 0FFFFFFFFh
		jz	loc_679C5C60
		lea	eax, [ebx+28h]
		mov	[esp+29Ch+Format], ebp ; Source
		mov	[esp+29Ch+lpVersionInformation], eax ; Dest
		call	strcpy
		jmp	loc_679C5A4F
; ---------------------------------------------------------------------------
		align 10h

loc_679C5B70:				; CODE XREF: uname+68j
		mov	eax, [esp+29Ch+var_154.dwMinorVersion]
		mov	esi, offset byte_679C9760
		jmp	loc_679C59FC
; ---------------------------------------------------------------------------

loc_679C5B81:				; CODE XREF: uname+134j uname+267j
					; DATA XREF: ...
		lea	eax, [ebx+50h]	; jumptable 679C5BD7 case 9
		mov	dword ptr [ebx+50h], 5F363878h
		mov	word ptr [eax+4], 3436h
		mov	byte ptr [eax+6], 0
		add	esp, 28Ch
		xor	eax, eax
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_679C5BA2:				; CODE XREF: uname+128j uname+267j
					; DATA XREF: ...
		mov	dword ptr [ebx+50h], 34366169h ; jumptable 679C5BD7 case 6
		xor	eax, eax
		mov	byte ptr [ebx+54h], 0
		add	esp, 28Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C5BC0:				; CODE XREF: uname+115j
		cmp	word ptr [esp+29Ch+SystemInfo.u], 0Ah ;	switch 11 cases
		ja	loc_679C5AC6	; jumptable 679C5BD7 default case
		movzx	eax, word ptr [esp+29Ch+SystemInfo.u]
		jmp	ds:off_679C97AC[eax*4] ; switch	jump
; ---------------------------------------------------------------------------
		align 10h

loc_679C5BE0:				; CODE XREF: uname+C2j
		mov	eax, [esp+29Ch+var_154.dwMinorVersion]
		mov	[esp+29Ch+Format], offset aWindowsCeU_U	; "Windows CE %u.%u"
		mov	[esp+29Ch+var_290], eax
		mov	eax, [esp+29Ch+var_154.dwMajorVersion]
		mov	[esp+29Ch+var_294], eax
		lea	eax, [ebx+28h]
		mov	[esp+29Ch+lpVersionInformation], eax ; Dest
		call	sprintf
		jmp	loc_679C5A4F
; ---------------------------------------------------------------------------
		align 10h

loc_679C5C10:				; CODE XREF: uname+71j
		mov	eax, [esp+29Ch+var_154.dwMinorVersion]
		mov	esi, offset byte_679C9763
		jmp	loc_679C59FC
; ---------------------------------------------------------------------------

loc_679C5C21:				; CODE XREF: uname+7Aj
		mov	eax, [esp+29Ch+var_154.dwMinorVersion]
		mov	esi, offset byte_679C976D
		cmp	eax, 5Ah
		jz	loc_679C59FC
		jbe	short loc_679C5C9D

loc_679C5C38:				; CODE XREF: uname+342j
		mov	esi, offset byte_679C9766
		jmp	loc_679C59FC
; ---------------------------------------------------------------------------

loc_679C5C42:				; CODE XREF: uname+1CCj
		cmp	[esp+29Ch+var_156], 1
		jz	loc_679C5B42
		mov	ebp, [eax+0Ch]
		add	ebp, [eax+8]
		jmp	loc_679C5B45
; ---------------------------------------------------------------------------
		align 10h

loc_679C5C60:				; CODE XREF: uname+1D8j uname+1E1j
		lea	eax, [ebx+28h]
		mov	[esp+29Ch+var_28C], edi
		mov	[esp+29Ch+var_290], esi
		mov	[esp+29Ch+var_294], ebp
		mov	[esp+29Ch+Format], offset aSU_U	; "%s %u.%u"
		mov	[esp+29Ch+lpVersionInformation], eax ; Dest
		call	sprintf
		jmp	loc_679C5A4F
; ---------------------------------------------------------------------------

loc_679C5C84:				; CODE XREF: uname+58j
		mov	dword ptr [ebx+14h], 61636F6Ch
		mov	dword ptr [esi+4], 736F686Ch
		mov	word ptr [esi+8], 74h
		jmp	loc_679C59CE
; ---------------------------------------------------------------------------

loc_679C5C9D:				; CODE XREF: uname+2C6j
		test	eax, eax
		mov	esi, offset byte_679C9767
		jz	loc_679C59FC
		cmp	eax, 0Ah
		mov	esi, offset word_679C976A
		jnz	short loc_679C5C38
		jmp	loc_679C59FC
; ---------------------------------------------------------------------------

loc_679C5CB9:				; CODE XREF: uname+150j
		add	ebx, 50h
		mov	[esp+29Ch+var_294], ecx
		mov	[esp+29Ch+Format], offset aIU ;	"i%u"
		mov	[esp+29Ch+lpVersionInformation], ebx ; Dest
		call	sprintf
		jmp	loc_679C5AD4
; ---------------------------------------------------------------------------

loc_679C5CD5:				; CODE XREF: uname+267j
					; DATA XREF: .rdata:off_679C97ACo
		mov	dword ptr [ebx+50h], 36383669h ; jumptable 679C5BD7 case 10
		mov	byte ptr [ebx+54h], 0
		jmp	loc_679C5AD4
; ---------------------------------------------------------------------------

loc_679C5CE5:				; CODE XREF: uname+267j
					; DATA XREF: .rdata:off_679C97ACo
		mov	dword ptr [ebx+50h], 7370696Dh ; jumptable 679C5BD7 case 1
		mov	byte ptr [ebx+54h], 0
		jmp	loc_679C5AD4
; ---------------------------------------------------------------------------

loc_679C5CF5:				; CODE XREF: uname+267j
					; DATA XREF: .rdata:off_679C97ACo
		mov	dword ptr [ebx+50h], 36383369h ; jumptable 679C5BD7 case 0
		mov	byte ptr [ebx+54h], 0
		movzx	eax, [esp+29Ch+SystemInfo.wProcessorLevel]
		cmp	ax, 2
		jbe	loc_679C5AD4
		cmp	ax, 6
		mov	edx, 36h
		ja	short loc_679C5D20
		lea	edx, [eax+30h]

loc_679C5D20:				; CODE XREF: uname+3ABj
		mov	[ebx+51h], dl
		jmp	loc_679C5AD4
; ---------------------------------------------------------------------------

loc_679C5D28:				; CODE XREF: uname+267j
					; DATA XREF: .rdata:off_679C97ACo
		mov	dword ptr [ebx+50h], 6D7261h ; jumptable 679C5BD7 case 5
		jmp	loc_679C5AD4
; ---------------------------------------------------------------------------

loc_679C5D34:				; CODE XREF: uname+267j
					; DATA XREF: .rdata:off_679C97ACo
		mov	word ptr [ebx+50h], 6873h ; jumptable 679C5BD7 case 4
		mov	byte ptr [ebx+52h], 0
		jmp	loc_679C5AD4
; ---------------------------------------------------------------------------

loc_679C5D43:				; CODE XREF: uname+267j
					; DATA XREF: .rdata:off_679C97ACo
		mov	dword ptr [ebx+50h], 65776F70h ; jumptable 679C5BD7 case 3
		mov	dword ptr [ebx+54h], 637072h
		jmp	loc_679C5AD4
; ---------------------------------------------------------------------------

loc_679C5D56:				; CODE XREF: uname+267j
					; DATA XREF: .rdata:off_679C97ACo
		mov	dword ptr [ebx+50h], 68706C61h ; jumptable 679C5BD7 cases 2,7
		mov	word ptr [ebx+54h], 61h
		jmp	loc_679C5AD4
uname		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  11. fchmod

; =============== S U B	R O U T	I N E =======================================


		public fchmod
fchmod		proc near
		xor	eax, eax
		retn
fchmod		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  22. getgroups

; =============== S U B	R O U T	I N E =======================================


		public getgroups
getgroups	proc near
		xor	eax, eax
		retn
getgroups	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   4. chown

; =============== S U B	R O U T	I N E =======================================


		public chown
chown		proc near
		xor	eax, eax
		retn
chown		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  12. fchown

; =============== S U B	R O U T	I N E =======================================


		public fchown
fchown		proc near
		xor	eax, eax
		retn
fchown		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  32. getuid

; =============== S U B	R O U T	I N E =======================================


		public getuid
getuid		proc near
		mov	eax, 0FFFFFFFEh
		retn
getuid		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  17. geteuid

; =============== S U B	R O U T	I N E =======================================


		public geteuid
geteuid		proc near
		mov	eax, 0FFFFFFFEh
		retn
geteuid		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  18. getgid

; =============== S U B	R O U T	I N E =======================================


		public getgid
getgid		proc near
		mov	eax, 0FFFFFFFEh
		retn
getgid		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  16. getegid

; =============== S U B	R O U T	I N E =======================================


		public getegid
getegid		proc near
		mov	eax, 0FFFFFFFEh
		retn
getegid		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  14. fork

; =============== S U B	R O U T	I N E =======================================


		public fork
fork		proc near
		mov	eax, 0FFFFFFFFh
		retn
fork		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  82. setsid

; =============== S U B	R O U T	I N E =======================================


		public setsid
setsid		proc near
		mov	eax, 0FFFFFFFFh
		retn
setsid		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   3. alarm

; =============== S U B	R O U T	I N E =======================================


		public alarm
alarm		proc near
		mov	eax, 1
		retn
alarm		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  80. setreuid

; =============== S U B	R O U T	I N E =======================================


		public setreuid
setreuid	proc near
		xor	eax, eax
		retn
setreuid	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  76. seteuid

; =============== S U B	R O U T	I N E =======================================


		public seteuid
seteuid		proc near
		xor	eax, eax
		retn
seteuid		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  74. revoke

; =============== S U B	R O U T	I N E =======================================


		public revoke
revoke		proc near
		sub	esp, 0Ch
		call	ds:_errno
		mov	dword ptr [eax], 28h
		mov	eax, 0FFFFFFFFh
		add	esp, 0Ch
		retn
revoke		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  91. truncate

; =============== S U B	R O U T	I N E =======================================


; int __cdecl truncate(LPCSTR lpFileName, LARGE_INTEGER	liDistanceToMove)
		public truncate
truncate	proc near

lpOutputString	= dword	ptr -3Ch
dwDesiredAccess	= dword	ptr -38h
dwShareMode	= dword	ptr -34h
lpSecurityAttributes= dword ptr	-30h
dwCreationDisposition= dword ptr -2Ch
dwFlagsAndAttributes= dword ptr	-28h
hTemplateFile	= dword	ptr -24h
FileSize	= LARGE_INTEGER	ptr -14h
lpFileName	= dword	ptr  4
liDistanceToMove= LARGE_INTEGER	ptr  8

		push	edi
		push	esi
		push	ebx
		sub	esp, 30h
		mov	esi, dword ptr [esp+3Ch+liDistanceToMove]
		mov	[esp+3Ch+lpOutputString], offset OutputString ;	"ERROR broken function truncate	from kde"...
		call	ds:OutputDebugStringW
		sub	esp, 4
		test	esi, esi
		js	loc_679C5F43
		mov	eax, [esp+3Ch+lpFileName]
		mov	[esp+3Ch+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+3Ch+dwFlagsAndAttributes],	80h ; dwFlagsAndAttributes
		mov	[esp+3Ch+dwCreationDisposition], 3 ; dwCreationDisposition
		mov	[esp+3Ch+lpSecurityAttributes],	0 ; lpSecurityAttributes
		mov	[esp+3Ch+dwShareMode], 0 ; dwShareMode
		mov	[esp+3Ch+dwDesiredAccess], 40000000h ; dwDesiredAccess
		mov	[esp+3Ch+lpOutputString], eax ;	lpFileName
		call	ds:CreateFileA
		sub	esp, 1Ch
		cmp	eax, 0FFFFFFFFh
		mov	ebx, eax
		jz	loc_679C5F8C
		lea	eax, [esp+3Ch+FileSize]
		mov	[esp+3Ch+dwDesiredAccess], eax ; lpFileSize
		mov	[esp+3Ch+lpOutputString], ebx ;	hFile
		call	ds:GetFileSizeEx
		sub	esp, 8
		test	eax, eax
		jz	short loc_679C5F62
		mov	edi, esi
		sar	edi, 1Fh
		cmp	dword ptr [esp+3Ch+FileSize+4],	edi
		jle	short loc_679C5F35

loc_679C5EF0:				; CODE XREF: truncate+FAj
		mov	dword ptr [esp+3Ch+FileSize], esi
		mov	dword ptr [esp+3Ch+FileSize+4],	edi
		mov	[esp+3Ch+dwCreationDisposition], 0 ; dwMoveMethod
		mov	[esp+3Ch+lpSecurityAttributes],	0 ; lpNewFilePointer
		mov	[esp+3Ch+dwDesiredAccess], esi ; liDistanceToMove
		mov	[esp+3Ch+dwShareMode], edi
		mov	[esp+3Ch+lpOutputString], ebx ;	hFile
		call	ds:SetFilePointerEx
		sub	esp, 14h
		test	eax, eax
		jz	short loc_679C5F62
		mov	[esp+3Ch+lpOutputString], ebx ;	hObject
		call	ds:CloseHandle
		xor	eax, eax
		sub	esp, 4

loc_679C5F2E:				; CODE XREF: truncate+F4j
					; truncate+12Aj ...
		add	esp, 30h
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------

loc_679C5F35:				; CODE XREF: truncate+8Ej
		jge	short loc_679C5F56

loc_679C5F37:				; CODE XREF: truncate+100j
		mov	[esp+3Ch+lpOutputString], ebx ;	hObject
		call	ds:CloseHandle
		sub	esp, 4

loc_679C5F43:				; CODE XREF: truncate+1Cj
		call	ds:_errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short loc_679C5F2E
; ---------------------------------------------------------------------------

loc_679C5F56:				; CODE XREF: truncate:loc_679C5F35j
		cmp	dword ptr [esp+3Ch+FileSize], esi
		jnb	short loc_679C5EF0
		lea	esi, [esi+0]
		jmp	short loc_679C5F37
; ---------------------------------------------------------------------------

loc_679C5F62:				; CODE XREF: truncate+83j truncate+BEj
		call	ds:GetLastError
		mov	[esp+3Ch+lpOutputString], ebx ;	hObject
		nop
		lea	esi, [esi+0]
		call	ds:CloseHandle
		sub	esp, 4
		call	ds:_errno
		mov	dword ptr [eax], 0Dh
		mov	eax, 0FFFFFFFFh
		jmp	short loc_679C5F2E
; ---------------------------------------------------------------------------

loc_679C5F8C:				; CODE XREF: truncate+67j
		call	ds:GetLastError
		call	ds:_errno
		mov	dword ptr [eax], 0Dh
		mov	eax, 0FFFFFFFFh
		jmp	short loc_679C5F2E
truncate	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  25. getpagesize

; =============== S U B	R O U T	I N E =======================================


		public getpagesize
getpagesize	proc near

lpSystemInfo	= dword	ptr -4Ch
SystemInfo	= _SYSTEM_INFO ptr -30h

		sub	esp, 4Ch
		mov	eax, ds:dword_679CA010
		test	eax, eax
		jnz	short loc_679C5FD5
		lea	eax, [esp+4Ch+SystemInfo]
		mov	[esp+4Ch+lpSystemInfo],	eax ; lpSystemInfo
		call	ds:GetSystemInfo
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemInfo.dwPageSize]
		mov	ds:dword_679CA010, eax

loc_679C5FD5:				; CODE XREF: getpagesize+Aj
		add	esp, 4Ch
		retn
getpagesize	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  59. mkdtemp

; =============== S U B	R O U T	I N E =======================================


; int __cdecl mkdtemp(char *)
		public mkdtemp
mkdtemp		proc near

Str		= dword	ptr -4Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 4Ch
		mov	[esp+4Ch+var_10], ebx
		mov	ebx, [esp+4Ch+arg_0]
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+Str], ebx ; Str
		call	strlen
		cmp	eax, 5
		jg	short loc_679C6020

loc_679C6004:				; CODE XREF: mkdtemp+56j mkdtemp+B4j
		xor	ebx, ebx

loc_679C6006:				; CODE XREF: mkdtemp+1A5j
		mov	eax, ebx
		mov	esi, [esp+4Ch+var_C]
		mov	ebx, [esp+4Ch+var_10]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C6020:				; CODE XREF: mkdtemp+22j
		lea	eax, [ebx+eax-6]
		mov	edi, offset aXxxxxx ; "XXXXXX"
		mov	[esp+4Ch+var_38], eax
		mov	ecx, 6
		mov	esi, eax
		repe cmpsb
		jnz	short loc_679C6004
		call	rand
		mov	edx, [esp+4Ch+var_38]
		mov	ebp, 84210843h
		mov	esi, ebx
		add	edx, 2
		mov	[esp+4Ch+var_28], edx
		mov	edx, [esp+4Ch+var_38]
		mov	edi, eax
		mov	eax, [esp+4Ch+var_38]
		add	edx, 4
		add	eax, 1
		mov	[esp+4Ch+var_24], eax
		mov	eax, [esp+4Ch+var_38]
		mov	[esp+4Ch+var_30], edx
		lea	edx, [edi+1E6100h]
		mov	[esp+4Ch+var_20], edx
		add	eax, 3
		mov	[esp+4Ch+var_2C], eax
		mov	eax, [esp+4Ch+var_38]
		add	eax, 5
		mov	[esp+4Ch+var_34], eax
		jmp	short loc_679C609A
; ---------------------------------------------------------------------------
		align 10h

loc_679C6090:				; CODE XREF: mkdtemp+19Dj
		cmp	edi, [esp+4Ch+var_20]
		jz	loc_679C6004

loc_679C609A:				; CODE XREF: mkdtemp+A7j
		mov	eax, edi
		imul	ebp
		mov	eax, edi
		sar	eax, 1Fh
		lea	ecx, [edx+edi]
		mov	edx, edi
		sar	ecx, 5
		sub	ecx, eax
		imul	eax, ecx, 3Eh
		sub	edx, eax
		movzx	eax, ds:byte_679C9980[edx]
		mov	edx, [esp+4Ch+var_38]
		mov	[edx], al
		mov	eax, ecx
		imul	ebp
		mov	eax, ecx
		sar	eax, 1Fh
		lea	ebx, [edx+ecx]
		mov	edx, [esp+4Ch+var_24]
		sar	ebx, 5
		sub	ebx, eax
		imul	eax, ebx, 3Eh
		sub	ecx, eax
		movzx	eax, ds:byte_679C9980[ecx]
		mov	[edx], al
		mov	eax, ebx
		imul	ebp
		mov	eax, ebx
		sar	eax, 1Fh
		lea	ecx, [edx+ebx]
		mov	edx, [esp+4Ch+var_28]
		sar	ecx, 5
		sub	ecx, eax
		imul	eax, ecx, 3Eh
		sub	ebx, eax
		movzx	eax, ds:byte_679C9980[ebx]
		mov	[edx], al
		mov	eax, ecx
		imul	ebp
		mov	eax, ecx
		sar	eax, 1Fh
		lea	ebx, [edx+ecx]
		mov	edx, [esp+4Ch+var_2C]
		sar	ebx, 5
		sub	ebx, eax
		imul	eax, ebx, 3Eh
		sub	ecx, eax
		movzx	eax, ds:byte_679C9980[ecx]
		mov	[edx], al
		mov	eax, ebx
		imul	ebp
		mov	eax, ebx
		sar	eax, 1Fh
		lea	ecx, [edx+ebx]
		mov	edx, [esp+4Ch+var_30]
		sar	ecx, 5
		sub	ecx, eax
		imul	eax, ecx, 3Eh
		sub	ebx, eax
		movzx	eax, ds:byte_679C9980[ebx]
		mov	[edx], al
		mov	eax, ecx
		imul	ebp
		mov	eax, ecx
		add	edx, ecx
		sar	edx, 5
		sar	eax, 1Fh
		add	edi, 1E61h
		sub	edx, eax
		imul	edx, 3Eh
		sub	ecx, edx
		mov	edx, [esp+4Ch+var_34]
		movzx	eax, ds:byte_679C9980[ecx]
		mov	[edx], al
		mov	[esp+4Ch+Str], esi
		call	_mkdir
		test	eax, eax
		jnz	loc_679C6090
		mov	ebx, esi
		jmp	loc_679C6006
mkdtemp		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  61. mkstemps

; =============== S U B	R O U T	I N E =======================================


; int __cdecl mkstemps(char *, int)
		public mkstemps
mkstemps	proc near

Str		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 4Ch
		mov	[esp+4Ch+var_4], ebp
		mov	ebp, [esp+4Ch+arg_0]
		mov	[esp+4Ch+var_10], ebx
		mov	ebx, [esp+4Ch+arg_4]
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		mov	[esp+4Ch+Str], ebp ; Str
		call	strlen
		lea	edx, [ebx+5]
		cmp	eax, edx
		jg	short loc_679C61D3

loc_679C61BA:				; CODE XREF: mkstemps+5Bj
		mov	eax, 0FFFFFFFFh

loc_679C61BF:				; CODE XREF: mkstemps+1A3j
					; mkstemps+1BCj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------

loc_679C61D3:				; CODE XREF: mkstemps+28j
		sub	eax, ebx
		mov	edi, offset aXxxxxx ; "XXXXXX"
		lea	eax, [ebp+eax-6]
		mov	ecx, 6
		mov	[esp+4Ch+var_38], eax
		mov	esi, eax
		repe cmpsb
		jnz	short loc_679C61BA
		call	rand
		mov	edx, [esp+4Ch+var_38]
		mov	edi, 84210843h
		add	edx, 2
		mov	[esp+4Ch+var_28], edx
		mov	edx, [esp+4Ch+var_38]
		mov	esi, eax
		mov	eax, [esp+4Ch+var_38]
		add	edx, 4
		add	eax, 1
		mov	[esp+4Ch+var_24], eax
		mov	eax, [esp+4Ch+var_38]
		mov	[esp+4Ch+var_30], edx
		lea	edx, [esi+1E429Fh]
		mov	[esp+4Ch+var_20], edx
		add	eax, 3
		mov	[esp+4Ch+var_2C], eax
		mov	eax, [esp+4Ch+var_38]
		add	eax, 5
		mov	[esp+4Ch+var_34], eax
		jmp	short loc_679C6246
; ---------------------------------------------------------------------------
		align 10h

loc_679C6240:				; CODE XREF: mkstemps+1ADj
		add	esi, 1E61h

loc_679C6246:				; CODE XREF: mkstemps+AAj
		mov	eax, esi
		imul	edi
		mov	eax, esi
		sar	eax, 1Fh
		lea	ecx, [edx+esi]
		mov	edx, esi
		sar	ecx, 5
		sub	ecx, eax
		imul	eax, ecx, 3Eh
		sub	edx, eax
		movzx	eax, ds:byte_679C99C0[edx]
		mov	edx, [esp+4Ch+var_38]
		mov	[edx], al
		mov	eax, ecx
		imul	edi
		mov	eax, ecx
		sar	eax, 1Fh
		lea	ebx, [edx+ecx]
		mov	edx, [esp+4Ch+var_24]
		sar	ebx, 5
		sub	ebx, eax
		imul	eax, ebx, 3Eh
		sub	ecx, eax
		movzx	eax, ds:byte_679C99C0[ecx]
		mov	[edx], al
		mov	eax, ebx
		imul	edi
		mov	eax, ebx
		sar	eax, 1Fh
		lea	ecx, [edx+ebx]
		mov	edx, [esp+4Ch+var_28]
		sar	ecx, 5
		sub	ecx, eax
		imul	eax, ecx, 3Eh
		sub	ebx, eax
		movzx	eax, ds:byte_679C99C0[ebx]
		mov	[edx], al
		mov	eax, ecx
		imul	edi
		mov	eax, ecx
		sar	eax, 1Fh
		lea	ebx, [edx+ecx]
		mov	edx, [esp+4Ch+var_2C]
		sar	ebx, 5
		sub	ebx, eax
		imul	eax, ebx, 3Eh
		sub	ecx, eax
		movzx	eax, ds:byte_679C99C0[ecx]
		mov	[edx], al
		mov	eax, ebx
		imul	edi
		mov	eax, ebx
		sar	eax, 1Fh
		lea	ecx, [edx+ebx]
		mov	edx, [esp+4Ch+var_30]
		sar	ecx, 5
		sub	ecx, eax
		imul	eax, ecx, 3Eh
		sub	ebx, eax
		movzx	eax, ds:byte_679C99C0[ebx]
		mov	[edx], al
		mov	eax, ecx
		imul	edi
		mov	eax, ecx
		add	edx, ecx
		sar	edx, 5
		sar	eax, 1Fh
		sub	edx, eax
		imul	edx, 3Eh
		sub	ecx, edx
		mov	edx, [esp+4Ch+var_34]
		movzx	eax, ds:byte_679C99C0[ecx]
		mov	[edx], al
		mov	[esp+4Ch+var_44], 180h
		mov	[esp+4Ch+var_48], 502h
		mov	[esp+4Ch+Str], ebp
		call	_open
		test	eax, eax
		jns	loc_679C61BF
		cmp	esi, [esp+4Ch+var_20]
		jnz	loc_679C6240
		mov	byte ptr [ebp+0], 0
		mov	eax, 0FFFFFFFFh
		jmp	loc_679C61BF
mkstemps	endp

; ---------------------------------------------------------------------------
		jmp	short getlogin
; ---------------------------------------------------------------------------
		align 10h
; Exported entry  23. getlogin

; =============== S U B	R O U T	I N E =======================================


		public getlogin
getlogin	proc near		; CODE XREF: .text:679C6351j

lpBuffer	= dword	ptr -2Ch
pcbBuffer	= dword	ptr -28h
var_10		= dword	ptr -10h

		sub	esp, 2Ch
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_10], 100h
		mov	ds:getlogin_buf, 0
		mov	[esp+2Ch+pcbBuffer], eax ; pcbBuffer
		mov	[esp+2Ch+lpBuffer], offset getlogin_buf	; lpBuffer
		call	ds:GetUserNameA
		sub	esp, 8
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 2Ch
		not	eax
		and	eax, offset getlogin_buf
		retn
getlogin	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  41. kde_gethostname

; =============== S U B	R O U T	I N E =======================================


; int __cdecl kde_gethostname(LPSTR, int)
		public kde_gethostname
kde_gethostname	proc near		; CODE XREF: uname+51p

lpBuffer	= dword	ptr -2Ch
nSize		= dword	ptr -28h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 2Ch
		mov	eax, [esp+2Ch+arg_4]
		mov	[esp+2Ch+var_10], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+nSize], eax ; nSize
		mov	eax, [esp+2Ch+arg_0]
		mov	[esp+2Ch+lpBuffer], eax	; lpBuffer
		call	ds:GetComputerNameA
		sub	esp, 8
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 2Ch
		retn
kde_gethostname	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  68. pipe

; =============== S U B	R O U T	I N E =======================================


		public pipe
pipe		proc near

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], 8000h
		mov	[esp+1Ch+var_18], 100h
		mov	[esp+1Ch+var_1C], eax
		call	ds:_pipe
		add	esp, 1Ch
		retn
pipe		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  89. symlink

; =============== S U B	R O U T	I N E =======================================


; int __cdecl symlink(LPCSTR, LPCSTR)
		public symlink
symlink		proc near

lpExistingFileName= dword ptr -1Ch
lpNewFileName	= dword	ptr -18h
bFailIfExists	= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		mov	[esp+1Ch+bFailIfExists], 0 ; bFailIfExists
		mov	[esp+1Ch+lpNewFileName], eax ; lpNewFileName
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpExistingFileName], eax ; lpExistingFileName
		call	ds:CopyFileA
		mov	edx, eax
		sub	esp, 0Ch
		xor	eax, eax
		test	edx, edx
		jz	short loc_679C6430
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C6430:				; CODE XREF: symlink+29j
		call	ds:GetLastError
		cmp	eax, 50h
		jz	short loc_679C6470
		cmp	eax, 52h
		xchg	ax, ax
		jz	short loc_679C6457
		call	ds:_errno
		mov	dword ptr [eax], 0Eh
		mov	eax, 0FFFFFFFFh
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_679C6457:				; CODE XREF: symlink+40j
		call	ds:_errno
		mov	dword ptr [eax], 0Dh
		mov	eax, 0FFFFFFFFh
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C6470:				; CODE XREF: symlink+39j
		call	ds:_errno
		mov	dword ptr [eax], 11h
		mov	eax, 0FFFFFFFFh
		add	esp, 1Ch
		retn
symlink		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  72. readlink

; =============== S U B	R O U T	I N E =======================================


; int __cdecl readlink(char *, char *Dest, size_t)
		public readlink
readlink	proc near

Str		= dword	ptr -1Ch
Source		= dword	ptr -18h
Count		= dword	ptr -14h
arg_0		= dword	ptr  4
Dest		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		push	ebx
		sub	esp, 14h
		mov	ebx, [esp+1Ch+arg_0]
		mov	esi, [esp+1Ch+arg_8]
		test	ebx, ebx
		jz	short loc_679C6516
		test	esi, esi
		js	short loc_679C64F0
		mov	[esp+1Ch+Str], ebx ; Str
		call	strlen
		cmp	esi, eax
		nop
		jle	short loc_679C64F0
		mov	[esp+1Ch+Source], 4
		mov	[esp+1Ch+Str], ebx
		call	_access
		test	eax, eax
		jnz	short loc_679C6503
		mov	eax, [esp+1Ch+Dest]
		mov	[esp+1Ch+Count], esi ; Count
		mov	[esp+1Ch+Source], ebx ;	Source
		mov	[esp+1Ch+Str], eax ; Dest
		call	strncpy
		call	ds:_errno
		mov	dword ptr [eax], 0
		xor	eax, eax

loc_679C64E8:				; CODE XREF: readlink+71j readlink+84j ...
		add	esp, 14h
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C64F0:				; CODE XREF: readlink+13j readlink+20j
		call	ds:_errno
		mov	dword ptr [eax], 26h
		mov	eax, 0FFFFFFFFh
		jmp	short loc_679C64E8
; ---------------------------------------------------------------------------

loc_679C6503:				; CODE XREF: readlink+34j
		call	ds:_errno
		mov	dword ptr [eax], 2
		mov	eax, 0FFFFFFFFh
		jmp	short loc_679C64E8
; ---------------------------------------------------------------------------

loc_679C6516:				; CODE XREF: readlink+Fj
		call	ds:_errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short loc_679C64E8
readlink	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  58. lstat

; =============== S U B	R O U T	I N E =======================================


		public lstat
lstat		proc near
		sub	esp, 0Ch
		mov	eax, ds:_stat
		add	esp, 0Ch
		jmp	eax
lstat		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  60. mkstemp

; =============== S U B	R O U T	I N E =======================================


; int __cdecl mkstemp(char *)
		public mkstemp
mkstemp		proc near

Str		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 4Ch
		mov	[esp+4Ch+var_4], ebp
		mov	ebp, [esp+4Ch+arg_0]
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		mov	[esp+4Ch+Str], ebp ; Str
		call	strlen
		cmp	eax, 5
		jg	short loc_679C6580

loc_679C6564:				; CODE XREF: mkstemp+56j
		mov	eax, 0FFFFFFFFh

loc_679C6569:				; CODE XREF: mkstemp+19Aj mkstemp+1B3j
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C6580:				; CODE XREF: mkstemp+22j
		lea	eax, [ebp+eax-6]
		mov	edi, offset aXxxxxx ; "XXXXXX"
		mov	[esp+4Ch+var_38], eax
		mov	ecx, 6
		mov	esi, eax
		repe cmpsb
		jnz	short loc_679C6564
		call	rand
		mov	edx, [esp+4Ch+var_38]
		mov	edi, 84210843h
		add	edx, 2
		mov	[esp+4Ch+var_28], edx
		mov	edx, [esp+4Ch+var_38]
		mov	esi, eax
		mov	eax, [esp+4Ch+var_38]
		add	edx, 4
		add	eax, 1
		mov	[esp+4Ch+var_24], eax
		mov	eax, [esp+4Ch+var_38]
		mov	[esp+4Ch+var_30], edx
		lea	edx, [esi+1E429Fh]
		mov	[esp+4Ch+var_20], edx
		add	eax, 3
		mov	[esp+4Ch+var_2C], eax
		mov	eax, [esp+4Ch+var_38]
		add	eax, 5
		mov	[esp+4Ch+var_34], eax
		jmp	short loc_679C65ED
; ---------------------------------------------------------------------------

loc_679C65E7:				; CODE XREF: mkstemp+1A4j
		add	esi, 1E61h

loc_679C65ED:				; CODE XREF: mkstemp+A5j
		mov	eax, esi
		imul	edi
		mov	eax, esi
		sar	eax, 1Fh
		lea	ecx, [edx+esi]
		mov	edx, esi
		sar	ecx, 5
		sub	ecx, eax
		imul	eax, ecx, 3Eh
		sub	edx, eax
		movzx	eax, ds:byte_679C99C0[edx]
		mov	edx, [esp+4Ch+var_38]
		mov	[edx], al
		mov	eax, ecx
		imul	edi
		mov	eax, ecx
		sar	eax, 1Fh
		lea	ebx, [edx+ecx]
		mov	edx, [esp+4Ch+var_24]
		sar	ebx, 5
		sub	ebx, eax
		imul	eax, ebx, 3Eh
		sub	ecx, eax
		movzx	eax, ds:byte_679C99C0[ecx]
		mov	[edx], al
		mov	eax, ebx
		imul	edi
		mov	eax, ebx
		sar	eax, 1Fh
		lea	ecx, [edx+ebx]
		mov	edx, [esp+4Ch+var_28]
		sar	ecx, 5
		sub	ecx, eax
		imul	eax, ecx, 3Eh
		sub	ebx, eax
		movzx	eax, ds:byte_679C99C0[ebx]
		mov	[edx], al
		mov	eax, ecx
		imul	edi
		mov	eax, ecx
		sar	eax, 1Fh
		lea	ebx, [edx+ecx]
		mov	edx, [esp+4Ch+var_2C]
		sar	ebx, 5
		sub	ebx, eax
		imul	eax, ebx, 3Eh
		sub	ecx, eax
		movzx	eax, ds:byte_679C99C0[ecx]
		mov	[edx], al
		mov	eax, ebx
		imul	edi
		mov	eax, ebx
		sar	eax, 1Fh
		lea	ecx, [edx+ebx]
		mov	edx, [esp+4Ch+var_30]
		sar	ecx, 5
		sub	ecx, eax
		imul	eax, ecx, 3Eh
		sub	ebx, eax
		movzx	eax, ds:byte_679C99C0[ebx]
		mov	[edx], al
		mov	eax, ecx
		imul	edi
		mov	eax, ecx
		add	edx, ecx
		sar	edx, 5
		sar	eax, 1Fh
		sub	edx, eax
		imul	edx, 3Eh
		sub	ecx, edx
		mov	edx, [esp+4Ch+var_34]
		movzx	eax, ds:byte_679C99C0[ecx]
		mov	[edx], al
		mov	[esp+4Ch+var_44], 180h
		mov	[esp+4Ch+var_48], 502h
		mov	[esp+4Ch+Str], ebp
		call	_open
		test	eax, eax
		jns	loc_679C6569
		cmp	esi, [esp+4Ch+var_20]
		jnz	loc_679C65E7
		mov	byte ptr [ebp+0], 0
		mov	eax, 0FFFFFFFFh
		jmp	loc_679C6569
mkstemp		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  56. link

; =============== S U B	R O U T	I N E =======================================


; int __cdecl link(LPCSTR, LPCSTR)
		public link
link		proc near

lpExistingFileName= dword ptr -1Ch
lpNewFileName	= dword	ptr -18h
bFailIfExists	= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		mov	[esp+1Ch+bFailIfExists], 0 ; bFailIfExists
		mov	[esp+1Ch+lpNewFileName], eax ; lpNewFileName
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpExistingFileName], eax ; lpExistingFileName
		call	ds:CopyFileA
		mov	edx, eax
		sub	esp, 0Ch
		xor	eax, eax
		test	edx, edx
		jz	short loc_679C6730
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C6730:				; CODE XREF: link+29j
		call	ds:GetLastError
		cmp	eax, 50h
		jz	short loc_679C6770
		cmp	eax, 52h
		xchg	ax, ax
		jz	short loc_679C6757
		call	ds:_errno
		mov	dword ptr [eax], 0Eh
		mov	eax, 0FFFFFFFFh
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_679C6757:				; CODE XREF: link+40j
		call	ds:_errno
		mov	dword ptr [eax], 0Dh
		mov	eax, 0FFFFFFFFh
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C6770:				; CODE XREF: link+39j
		call	ds:_errno
		mov	dword ptr [eax], 11h
		mov	eax, 0FFFFFFFFh
		add	esp, 1Ch
		retn
link		endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  71. readdir_r

; =============== S U B	R O U T	I N E =======================================


		public readdir_r
readdir_r	proc near
		xor	eax, eax
		retn
readdir_r	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry  13. fcntl

; =============== S U B	R O U T	I N E =======================================


		public fcntl
fcntl		proc near
		mov	eax, 0FFFFFFFFh
		retn
fcntl		endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION CreateToolhelp32Snapshot]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION Process32FirstW]
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_679C67C0(_onexit_t)
sub_679C67C0	proc near		; CODE XREF: sub_679C6880+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_679CA4C4
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_679C6980
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_10], eax
		jz	loc_679C6860
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_679CA4C4
		mov	[esp+2Ch+Func],	eax
		call	sub_679C6980
		mov	[esp+2Ch+var_10], eax
		mov	eax, ds:dword_679CA4C0
		mov	[esp+2Ch+Func],	eax
		call	sub_679C6980
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_14], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_679C6990
		mov	ds:dword_679CA4C4, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_679C6990
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_679CA4C0, eax
		call	_unlock
		mov	eax, ebx
		add	esp, 28h
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C6860:				; CODE XREF: sub_679C67C0+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_679C67C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_679C6880(_onexit_t)
sub_679C6880	proc near		; CODE XREF: sub_679C6E60-2Fp
					; sub_679C78F0+12p

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_679C67C0
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_679C6880	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:679CD01Co

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_679C68D0
		cmp	eax, 3
		jz	short loc_679C68D0
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_679C68D0:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_679C7080
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_679C1040+117p
					; DATA XREF: .rdata:off_679C9A00o ...

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		cmp	dword_679C804C,	2
		mov	eax, [esp+1Ch+arg_4]
		jz	short loc_679C691B
		mov	dword_679C804C,	2

loc_679C691B:				; CODE XREF: TlsCallback_0+Fj
		cmp	eax, 2
		jz	short loc_679C6931
		cmp	eax, 1
		jz	short loc_679C6960

loc_679C6925:				; CODE XREF: TlsCallback_0+3Cj
					; TlsCallback_0+7Cj
		mov	eax, 1
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_679C6931:				; CODE XREF: TlsCallback_0+1Ej
		mov	ebx, offset dword_679CD028
		cmp	ebx, offset dword_679CD028
		jz	short loc_679C6925
		xchg	ax, ax

loc_679C6940:				; CODE XREF: TlsCallback_0+51j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_679C6948
		call	eax

loc_679C6948:				; CODE XREF: TlsCallback_0+44j
		add	ebx, 4
		cmp	ebx, offset dword_679CD028
		jnz	short loc_679C6940
		mov	eax, 1
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_679C6960:				; CODE XREF: TlsCallback_0+23j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax
		call	sub_679C7080
		jmp	short loc_679C6925
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_679C6980	proc near		; CODE XREF: sub_679C1040+138p
					; sub_679C1040+14Bp ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_679C6980	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_679C6990	proc near		; CODE XREF: sub_679C1000+15p
					; sub_679C67C0+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_679C6990	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_679C69A0(char	*Format, char ArgList)
sub_679C69A0	proc near		; CODE XREF: sub_679C6A00+131p
					; sub_679C6A00+141p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aMingwW64Runtim ;	"Mingw-w64 runtime failure:\n"
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_679C69A0	endp

; ---------------------------------------------------------------------------
		jmp	short sub_679C6A00
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_679C6A00(size_t Size)
sub_679C6A00	proc near		; CODE XREF: .text:679C69F1j
					; sub_679C6B50+12Ap ...

lpAddress	= dword	ptr -5Ch
lpBuffer	= dword	ptr -58h
dwLength	= dword	ptr -54h
lpflOldProtect	= dword	ptr -50h
var_44		= dword	ptr -44h
Src		= dword	ptr -40h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-38h

		push	ebp
		push	edi
		mov	edi, ecx
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 4Ch
		test	ecx, ecx
		mov	[esp+5Ch+Src], edx
		jnz	short loc_679C6A20
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C6A20:				; CODE XREF: sub_679C6A00+11j
		mov	ecx, ds:dword_679CA02C
		xor	esi, esi
		test	ecx, ecx
		jle	short loc_679C6A50
		mov	eax, ds:dword_679CA028

loc_679C6A31:				; CODE XREF: sub_679C6A00+4Ej
		mov	edx, [eax+4]
		cmp	edx, ebx
		ja	short loc_679C6A46
		mov	ebp, [eax+8]
		add	edx, [ebp+8]
		cmp	ebx, edx
		jb	loc_679C6AC9

loc_679C6A46:				; CODE XREF: sub_679C6A00+36j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jl	short loc_679C6A31

loc_679C6A50:				; CODE XREF: sub_679C6A00+2Aj
		mov	[esp+5Ch+lpAddress], ebx
		call	sub_679C72A0
		test	eax, eax
		mov	ebp, eax
		jz	loc_679C6B36
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_679CA028
		shl	edx, 2
		mov	[esp+5Ch+var_44], edx
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		call	sub_679C73C0
		mov	edx, [esp+5Ch+var_44]
		add	eax, [ebp+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+5Ch+Buffer]
		mov	[esp+5Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_679CA028
		mov	[esp+5Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+5Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+5Ch+var_44]
		jz	short loc_679C6B16
		mov	eax, [esp+5Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	short loc_679C6AE5

loc_679C6AC2:				; CODE XREF: sub_679C6A00+E8j
					; sub_679C6A00+114j
		add	ds:dword_679CA02C, 1

loc_679C6AC9:				; CODE XREF: sub_679C6A00+40j
		mov	eax, [esp+5Ch+Src]
		mov	[esp+5Ch+dwLength], edi	; Size
		mov	[esp+5Ch+lpAddress], ebx ; Dst
		mov	[esp+5Ch+lpBuffer], eax	; Src
		call	memcpy
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_679C6AE5:				; CODE XREF: sub_679C6A00+C0j
		cmp	eax, 40h
		jz	short loc_679C6AC2
		mov	eax, [esp+5Ch+Buffer.RegionSize]
		add	edx, ds:dword_679CA028
		mov	[esp+5Ch+dwLength], 40h	; flNewProtect
		mov	[esp+5Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+5Ch+Buffer.BaseAddress]
		mov	[esp+5Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+5Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_679C6AC2
; ---------------------------------------------------------------------------

loc_679C6B16:				; CODE XREF: sub_679C6A00+B7j
		mov	eax, ds:dword_679CA028
		mov	eax, [eax+edx+4]
		mov	[esp+5Ch+dwLength], eax
		mov	eax, [ebp+8]
		mov	[esp+5Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+5Ch+lpBuffer], eax	; ArgList
		call	sub_679C69A0
; ---------------------------------------------------------------------------

loc_679C6B36:				; CODE XREF: sub_679C6A00+5Cj
		mov	[esp+5Ch+lpBuffer], ebx	; ArgList
		mov	[esp+5Ch+lpAddress], offset aAddressPHasNoI ; "Address %p has no image-section"
		call	sub_679C69A0
sub_679C6A00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_679C6B50	proc near		; CODE XREF: sub_679C1260+30p
					; sub_679C1260:loc_679C12E8p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h
var_1C		= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	ebx, ds:dword_679CA030
		test	ebx, ebx
		jz	short loc_679C6B70

loc_679C6B63:				; CODE XREF: sub_679C6B50+64j
					; sub_679C6B50+B4j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C6B70:				; CODE XREF: sub_679C6B50+11j
		mov	ds:dword_679CA030, 1
		call	sub_679C7310
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_679C76D0
		mov	ds:dword_679CA02C, 0
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_679CA028, eax
		mov	eax, offset dword_679C9AF4
		sub	eax, offset dword_679C9AF4
		cmp	eax, 7
		jle	short loc_679C6B63
		cmp	eax, 0Bh
		mov	ebx, offset dword_679C9AF4
		jle	short loc_679C6BE2
		mov	ecx, ds:dword_679C9AF4
		test	ecx, ecx
		jnz	short loc_679C6BE2
		mov	edx, ds:dword_679C9AF8
		test	edx, edx
		jnz	short loc_679C6BE2
		mov	eax, ds:dword_679C9AFC
		test	eax, eax
		jnz	short loc_679C6BE2
		mov	ebx, offset dword_679C9B00

loc_679C6BE2:				; CODE XREF: sub_679C6B50+6Ej
					; sub_679C6B50+78j ...
		mov	edi, [ebx]
		test	edi, edi
		jnz	short loc_679C6C50
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	short loc_679C6C50
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_679C6DB3
		add	ebx, 0Ch
		cmp	ebx, offset dword_679C9AF4
		jnb	loc_679C6B63
		mov	esi, 679C0000h

loc_679C6C0F:				; CODE XREF: sub_679C6B50+217j
		mov	eax, [ebx+4]
		mov	ecx, [ebx]
		movzx	edx, byte ptr [ebx+8]
		add	eax, esi
		add	ecx, esi
		cmp	edx, 10h
		mov	edi, [ecx]
		jz	loc_679C6D0D
		cmp	edx, 20h
		jz	loc_679C6D4A
		cmp	edx, 8
		jz	loc_679C6D2C
		mov	[ebp+var_1C], 0
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		call	sub_679C69A0
; ---------------------------------------------------------------------------

loc_679C6C50:				; CODE XREF: sub_679C6B50+96j
					; sub_679C6B50+9Dj
		cmp	ebx, offset dword_679C9AF4
		jnb	loc_679C6B63
		mov	esi, 679C0000h
		lea	edi, [ebp+flOldProtect]

loc_679C6C64:				; CODE XREF: sub_679C6B50+135j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		mov	edx, edi
		call	sub_679C6A00
		cmp	ebx, offset dword_679C9AF4
		jb	short loc_679C6C64

loc_679C6C87:				; CODE XREF: sub_679C6B50+21Dj
		mov	ecx, ds:dword_679CA02C
		test	ecx, ecx
		jle	loc_679C6B63
		xor	ebx, ebx
		xor	esi, esi
		lea	edi, [ebp+flOldProtect]
		jmp	short loc_679C6CB2
; ---------------------------------------------------------------------------
		align 10h

loc_679C6CA0:				; CODE XREF: sub_679C6B50+16Dj
					; sub_679C6B50+1BBj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_679CA02C
		jge	loc_679C6B63

loc_679C6CB2:				; CODE XREF: sub_679C6B50+14Cj
		mov	eax, ds:dword_679CA028
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_679C6CA0
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_679C6D90
		mov	eax, ds:dword_679CA028
		mov	[esp+58h+lpflOldProtect], edi ;	lpflOldProtect
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_679C6CA0
; ---------------------------------------------------------------------------

loc_679C6D0D:				; CODE XREF: sub_679C6B50+D1j
		movzx	edx, word ptr [eax]
		test	dx, dx
		js	short loc_679C6D81
		sub	edx, ecx
		lea	edi, [edx+edi]
		mov	[ebp+var_1C], edi

loc_679C6D1D:				; CODE XREF: sub_679C6B50+23Ej
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_1C]
		call	sub_679C6A00
		jmp	short loc_679C6D5E
; ---------------------------------------------------------------------------

loc_679C6D2C:				; CODE XREF: sub_679C6B50+E3j
		movzx	edx, byte ptr [eax]
		test	dl, dl
		js	short loc_679C6D72
		sub	edx, ecx
		lea	edi, [edx+edi]
		mov	[ebp+var_1C], edi

loc_679C6D3B:				; CODE XREF: sub_679C6B50+22Fj
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_1C]
		call	sub_679C6A00
		jmp	short loc_679C6D5E
; ---------------------------------------------------------------------------

loc_679C6D4A:				; CODE XREF: sub_679C6B50+DAj
		add	edi, [eax]
		lea	edx, [ebp+var_1C]
		sub	edi, ecx
		mov	ecx, 4		; Size
		mov	[ebp+var_1C], edi
		call	sub_679C6A00

loc_679C6D5E:				; CODE XREF: sub_679C6B50+1DAj
					; sub_679C6B50+1F8j
		add	ebx, 0Ch
		cmp	ebx, offset dword_679C9AF4
		jb	loc_679C6C0F
		jmp	loc_679C6C87
; ---------------------------------------------------------------------------

loc_679C6D72:				; CODE XREF: sub_679C6B50+1E1j
		or	edx, 0FFFFFF00h
		sub	edx, ecx
		add	edx, edi
		mov	[ebp+var_1C], edx
		jmp	short loc_679C6D3B
; ---------------------------------------------------------------------------

loc_679C6D81:				; CODE XREF: sub_679C6B50+1C3j
		or	edx, 0FFFF0000h
		sub	edx, ecx
		add	edx, edi
		mov	[ebp+var_1C], edx
		jmp	short loc_679C6D1D
; ---------------------------------------------------------------------------

loc_679C6D90:				; CODE XREF: sub_679C6B50+18Fj
		add	ebx, ds:dword_679CA028
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_679C69A0
; ---------------------------------------------------------------------------

loc_679C6DB3:				; CODE XREF: sub_679C6B50+A5j
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_679C69A0
sub_679C6B50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_679C6DD0()
sub_679C6DD0	proc near		; DATA XREF: sub_679C6E60:loc_679C6E2Ao
		sub	esp, 0Ch
		mov	eax, off_679C8048
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_679C6DF7
		xchg	ax, ax

loc_679C6DE0:				; CODE XREF: sub_679C6DD0+25j
		call	eax
		mov	eax, off_679C8048
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_679C8048, edx
		test	eax, eax
		jnz	short loc_679C6DE0

loc_679C6DF7:				; CODE XREF: sub_679C6DD0+Cj
		add	esp, 0Ch
		retn
sub_679C6DD0	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_679C6E60

loc_679C6E00:				; CODE XREF: sub_679C6E60+1Ej
		push	esi
		push	ebx
		sub	esp, 14h
		mov	ebx, ds:dword_679C7910
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_679C6E40

loc_679C6E10:				; CODE XREF: sub_679C6E60-Cj
		test	ebx, ebx
		jz	short loc_679C6E2A
		lea	esi, dword_679C7910[ebx*4]
		nop
		lea	esi, [esi+0]

loc_679C6E20:				; CODE XREF: sub_679C6E60-38j
		call	dword ptr [esi]
		sub	esi, 4
		sub	ebx, 1
		jnz	short loc_679C6E20

loc_679C6E2A:				; CODE XREF: sub_679C6E60-4Ej
		mov	[esp+1Ch+var_1C], offset sub_679C6DD0 ;	_onexit_t
		call	sub_679C6880
		add	esp, 14h
		pop	ebx
		pop	esi
		retn
; END OF FUNCTION CHUNK	FOR sub_679C6E60
; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_679C6E60

loc_679C6E40:				; CODE XREF: sub_679C6E60-52j
		xor	ebx, ebx
		jmp	short loc_679C6E46
; ---------------------------------------------------------------------------

loc_679C6E44:				; CODE XREF: sub_679C6E60-Ej
		mov	ebx, eax

loc_679C6E46:				; CODE XREF: sub_679C6E60-1Ej
		lea	eax, [ebx+1]
		mov	edx, ds:dword_679C7910[eax*4]
		test	edx, edx
		jnz	short loc_679C6E44
		jmp	short loc_679C6E10
; END OF FUNCTION CHUNK	FOR sub_679C6E60
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_679C6E60	proc near		; CODE XREF: sub_679C1260+92p

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 679C6E00 SIZE 0000003C BYTES
; FUNCTION CHUNK AT 679C6E40 SIZE 00000016 BYTES

		sub	esp, 0Ch
		mov	ecx, ds:dword_679CA034
		test	ecx, ecx
		jz	short loc_679C6E71
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------

loc_679C6E71:				; CODE XREF: sub_679C6E60+Bj
		mov	ds:dword_679CA034, 1
		add	esp, 0Ch
		jmp	short loc_679C6E00
sub_679C6E60	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


sub_679C6E80	proc near		; CODE XREF: sub_679C1260+40p
					; sub_679C1260+A6p ...
		mov	eax, 1
		retn	0Ch
sub_679C6E80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_679C6E90	proc near		; CODE XREF: sub_679C1260+F1p
					; sub_679C1260+10Bp ...
		mov	eax, 1
		retn	0Ch
sub_679C6E90	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_679CA164, edx
		mov	ds:dword_679CA040, 0C0000409h
		mov	ds:dword_679CA044, 1
		mov	ds:dword_679CA158, eax
		mov	ds:dword_679CA04C, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_679CA14C, eax
		mov	eax, dword_679C8050
		mov	[ebp-10h], eax
		mov	eax, dword_679C8054
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_679C9AD4
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_679C6F30	proc near		; CODE XREF: DllEntryPoint+34p

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
PerformanceCount= LARGE_INTEGER	ptr -2Ch
SystemTimeAsFileTime= _FILETIME	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_679C8050
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		jz	short loc_679C6F70
		not	eax
		mov	dword_679C8054,	eax

loc_679C6F56:				; CODE XREF: sub_679C6F30+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C6F70:				; CODE XREF: sub_679C6F30+1Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_679C6FF2

loc_679C6FE2:				; CODE XREF: sub_679C6F30+CBj
		mov	dword_679C8050,	ebp
		mov	dword_679C8054,	eax
		jmp	loc_679C6F56
; ---------------------------------------------------------------------------

loc_679C6FF2:				; CODE XREF: sub_679C6F30+B0j
		mov	eax, 44BF19B0h
		mov	bp, 0E64Fh
		jmp	short loc_679C6FE2
sub_679C6F30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_679C7000	proc near		; CODE XREF: sub_679C7080+13p
					; sub_679C7080:loc_679C70A1p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	eax, ds:dword_679CA380
		test	eax, eax
		jnz	short loc_679C7018
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_679C7018:				; CODE XREF: sub_679C7000+Ej
		mov	[esp+2Ch+lpCriticalSection], offset stru_679CA384 ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_679CA39C
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_679C7065
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		xchg	ax, ax

loc_679C7040:				; CODE XREF: sub_679C7000+63j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_679C705E
		test	esi, esi
		jz	short loc_679C705E
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_679C705E:				; CODE XREF: sub_679C7000+50j
					; sub_679C7000+54j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_679C7040

loc_679C7065:				; CODE XREF: sub_679C7000+30j
		mov	[esp+2Ch+lpCriticalSection], offset stru_679CA384 ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_679C7000	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_679C7080	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+77p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_679C70D0
		jb	short loc_679C70A1
		cmp	eax, 3
		jnz	short loc_679C7098
		call	sub_679C7000

loc_679C7098:				; CODE XREF: sub_679C7080+11j
					; sub_679C7080+2Ej ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_679C70A1:				; CODE XREF: sub_679C7080+Cj
		call	sub_679C7000
		mov	eax, ds:dword_679CA380
		cmp	eax, 1
		jnz	short loc_679C7098
		mov	ds:dword_679CA380, 0
		mov	[esp+1Ch+lpCriticalSection], offset stru_679CA384 ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_679C7098
; ---------------------------------------------------------------------------
		align 10h

loc_679C70D0:				; CODE XREF: sub_679C7080+Aj
		mov	eax, ds:dword_679CA380
		test	eax, eax
		jz	short loc_679C70F0

loc_679C70D9:				; CODE XREF: sub_679C7080+80j
		mov	ds:dword_679CA380, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C70F0:				; CODE XREF: sub_679C7080+57j
		mov	[esp+1Ch+lpCriticalSection], offset stru_679CA384 ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_679C70D9
sub_679C7080	endp

; ---------------------------------------------------------------------------
		align 10h

loc_679C7110:				; CODE XREF: .text:679C77F6j
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_679CA380
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_679C7128
		xor	eax, eax
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_679C7128:				; CODE XREF: .text:679C711Fj
		mov	dword ptr [esp], offset	stru_679CA384
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_679CA39C
		sub	esp, 4
		test	eax, eax
		jz	short loc_679C715F
		mov	edx, [eax]
		cmp	edx, ebx
		jnz	short loc_679C7156
		jmp	short loc_679C7196
; ---------------------------------------------------------------------------
		align 10h

loc_679C7150:				; CODE XREF: .text:679C715Dj
		mov	edx, [eax]
		cmp	edx, ebx
		jz	short loc_679C7176

loc_679C7156:				; CODE XREF: .text:679C7145j
		mov	ecx, eax
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_679C7150

loc_679C715F:				; CODE XREF: .text:679C713Fj
		mov	dword ptr [esp], offset	stru_679CA384
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_679C716F:				; CODE XREF: .text:679C7194j
		xor	eax, eax
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_679C7176:				; CODE XREF: .text:679C7154j
		mov	edx, [eax+8]
		mov	[ecx+8], edx

loc_679C717C:				; CODE XREF: .text:679C719Fj
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	stru_679CA384
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_679C716F
; ---------------------------------------------------------------------------

loc_679C7196:				; CODE XREF: .text:679C7147j
		mov	edx, [eax+8]
		mov	ds:dword_679CA39C, edx
		jmp	short loc_679C717C
; ---------------------------------------------------------------------------
		jmp	short loc_679C71B0
; ---------------------------------------------------------------------------
		align 10h

loc_679C71B0:				; CODE XREF: .text:679C71A1j
					; .text:679C77DAj
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_679CA380
		test	eax, eax
		jnz	short loc_679C71C2

loc_679C71BD:				; CODE XREF: .text:679C71DFj
					; .text:679C721Ej
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_679C71C2:				; CODE XREF: .text:679C71BBj
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		mov	ebx, eax
		mov	eax, 0FFFFFFFFh
		test	ebx, ebx
		jz	short loc_679C71BD
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	stru_679CA384
		mov	[ebx], eax
		mov	eax, [esp+24h]
		mov	[ebx+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_679CA39C
		mov	ds:dword_679CA39C, ebx
		mov	[ebx+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	stru_679CA384
		call	ds:LeaveCriticalSection
		xor	eax, eax
		sub	esp, 4
		jmp	short loc_679C71BD
; ---------------------------------------------------------------------------
		mov	eax, [esp+4]
		cmp	word ptr [eax],	5A4Dh
		jz	short loc_679C7230

loc_679C722B:				; CODE XREF: .text:679C7239j
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C7230:				; CODE XREF: .text:679C7229j
		add	eax, [eax+3Ch]
		cmp	dword ptr [eax], 4550h
		jnz	short loc_679C722B
		cmp	word ptr [eax+18h], 10Bh
		setz	al
		movzx	eax, al
		retn
; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		mov	eax, [esp+0Ch]
		mov	ebx, [esp+10h]
		add	eax, [eax+3Ch]
		movzx	esi, word ptr [eax+6]
		movzx	edx, word ptr [eax+14h]
		test	esi, esi
		jz	short loc_679C728C
		movzx	edx, dx
		lea	eax, [eax+edx+18h]
		xor	edx, edx
		jmp	short loc_679C7277
; ---------------------------------------------------------------------------

loc_679C7274:				; CODE XREF: .text:679C728Aj
		add	eax, 28h

loc_679C7277:				; CODE XREF: .text:679C7272j
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_679C7285
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_679C728E

loc_679C7285:				; CODE XREF: .text:679C727Cj
		add	edx, 1
		cmp	edx, esi
		jb	short loc_679C7274

loc_679C728C:				; CODE XREF: .text:679C7267j
		xor	eax, eax

loc_679C728E:				; CODE XREF: .text:679C7283j
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_679C72A0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_679C72A0	proc near		; CODE XREF: sub_679C6A00+53p
					; .text:679C7291j

arg_0		= dword	ptr  4

		cmp	word ptr ds:679C0000h, 5A4Dh
		push	esi
		push	ebx
		jz	short loc_679C72B2

loc_679C72AD:				; CODE XREF: sub_679C72A0+27j
					; sub_679C72A0+2Fj ...
		xor	eax, eax

loc_679C72AF:				; CODE XREF: sub_679C72A0+61j
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_679C72B2:				; CODE XREF: sub_679C72A0+Bj
		mov	eax, ds:679C003Ch
		cmp	dword ptr [eax+679C0000h], 4550h
		lea	edx, [eax+679C0000h]
		jnz	short loc_679C72AD
		cmp	word ptr [edx+18h], 10Bh
		jnz	short loc_679C72AD
		mov	ebx, [esp+8+arg_0]
		movzx	esi, word ptr [edx+6]
		movzx	eax, word ptr [edx+14h]
		sub	ebx, 679C0000h
		test	esi, esi
		jz	short loc_679C72AD
		movzx	eax, ax
		lea	eax, [edx+eax+18h]
		xor	edx, edx
		jmp	short loc_679C72F5
; ---------------------------------------------------------------------------

loc_679C72F2:				; CODE XREF: sub_679C72A0+68j
		add	eax, 28h

loc_679C72F5:				; CODE XREF: sub_679C72A0+50j
		mov	ecx, [eax+0Ch]
		cmp	ebx, ecx
		jb	short loc_679C7303
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_679C72AF

loc_679C7303:				; CODE XREF: sub_679C72A0+5Aj
		add	edx, 1
		cmp	edx, esi
		jb	short loc_679C72F2
		jmp	short loc_679C72AD
sub_679C72A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_679C7310	proc near		; CODE XREF: sub_679C6B50+2Ap
		cmp	word ptr ds:679C0000h, 5A4Dh
		jz	short loc_679C7320

loc_679C731B:				; CODE XREF: sub_679C7310+25j
					; sub_679C7310+2Dj
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C7320:				; CODE XREF: sub_679C7310+9j
		mov	eax, ds:679C003Ch
		cmp	dword ptr [eax+679C0000h], 4550h
		lea	edx, [eax+679C0000h]
		jnz	short loc_679C731B
		cmp	word ptr [edx+18h], 10Bh
		jnz	short loc_679C731B
		movzx	eax, word ptr [edx+6]
		retn
sub_679C7310	endp

; ---------------------------------------------------------------------------
		align 10h
		cmp	word ptr ds:679C0000h, 5A4Dh
		push	ebx
		mov	edx, [esp+8]
		jz	short loc_679C7364

loc_679C7360:				; CODE XREF: .text:679C7379j
					; .text:679C7381j ...
		xor	eax, eax

loc_679C7362:				; CODE XREF: .text:679C73ABj
					; .text:679C73B9j
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_679C7364:				; CODE XREF: .text:679C735Ej
		mov	eax, ds:679C003Ch
		cmp	dword ptr [eax+679C0000h], 4550h
		lea	ecx, [eax+679C0000h]
		jnz	short loc_679C7360
		cmp	word ptr [ecx+18h], 10Bh
		jnz	short loc_679C7360
		movzx	ebx, word ptr [ecx+6]
		movzx	eax, word ptr [ecx+14h]
		test	ebx, ebx
		jz	short loc_679C7360
		movzx	eax, ax
		lea	eax, [ecx+eax+18h]
		xor	ecx, ecx
		jmp	short loc_679C73A3
; ---------------------------------------------------------------------------
		align 10h

loc_679C73A0:				; CODE XREF: .text:679C73B5j
		add	eax, 28h

loc_679C73A3:				; CODE XREF: .text:679C7398j
		test	byte ptr [eax+27h], 20h
		jz	short loc_679C73B0
		test	edx, edx
		jz	short loc_679C7362
		sub	edx, 1

loc_679C73B0:				; CODE XREF: .text:679C73A7j
		add	ecx, 1
		cmp	ecx, ebx
		jb	short loc_679C73A0
		xor	eax, eax
		jmp	short loc_679C7362
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_679C73C0	proc near		; CODE XREF: sub_679C6A00+7Dp
		cmp	word ptr ds:679C0000h, 5A4Dh
		jz	short loc_679C73D0

loc_679C73CB:				; CODE XREF: sub_679C73C0+25j
		xor	eax, eax

locret_679C73CD:			; CODE XREF: sub_679C73C0+32j
					; sub_679C73C0+36j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C73D0:				; CODE XREF: sub_679C73C0+9j
		mov	eax, ds:679C003Ch
		cmp	dword ptr [eax+679C0000h], 4550h
		lea	edx, [eax+679C0000h]
		jnz	short loc_679C73CB
		cmp	word ptr [edx+18h], 10Bh
		mov	eax, 679C0000h
		jz	short locret_679C73CD
		xor	eax, eax
		jmp	short locret_679C73CD
sub_679C73C0	endp

; ---------------------------------------------------------------------------
		align 10h
		cmp	word ptr ds:679C0000h, 5A4Dh
		push	esi
		push	ebx
		jz	short loc_679C7412

loc_679C740D:				; CODE XREF: .text:679C7427j
					; .text:679C742Fj ...
		xor	eax, eax
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_679C7412:				; CODE XREF: .text:679C740Bj
		mov	eax, ds:679C003Ch
		cmp	dword ptr [eax+679C0000h], 4550h
		lea	edx, [eax+679C0000h]
		jnz	short loc_679C740D
		cmp	word ptr [edx+18h], 10Bh
		jnz	short loc_679C740D
		mov	ebx, [esp+0Ch]
		movzx	esi, word ptr [edx+6]
		movzx	eax, word ptr [edx+14h]
		sub	ebx, 679C0000h
		test	esi, esi
		jz	short loc_679C740D
		movzx	eax, ax
		lea	eax, [edx+eax+18h]
		xor	edx, edx
		jmp	short loc_679C7455
; ---------------------------------------------------------------------------

loc_679C7452:				; CODE XREF: .text:679C7468j
		add	eax, 28h

loc_679C7455:				; CODE XREF: .text:679C7450j
		mov	ecx, [eax+0Ch]
		cmp	ebx, ecx
		jb	short loc_679C7463
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_679C7470

loc_679C7463:				; CODE XREF: .text:679C745Aj
		add	edx, 1
		cmp	esi, edx
		ja	short loc_679C7452
		jmp	short loc_679C740D
; ---------------------------------------------------------------------------
		align 10h

loc_679C7470:				; CODE XREF: .text:679C7461j
		test	eax, eax
		jz	short loc_679C740D
		mov	eax, [eax+24h]
		pop	ebx
		pop	esi
		not	eax
		shr	eax, 1Fh
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_679C7480	proc near		; CODE XREF: .text:679C75A8p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 0Ch
		cmp	word ptr ds:679C0000h, 5A4Dh
		mov	[esp+0Ch+var_C], ebx
		mov	eax, [esp+0Ch+arg_0]
		mov	[esp+0Ch+var_8], esi
		mov	[esp+0Ch+var_4], edi
		jz	short loc_679C74B0

loc_679C749D:				; CODE XREF: sub_679C7480+46j
					; sub_679C7480+4Ej ...
		xor	eax, eax

loc_679C749F:				; CODE XREF: sub_679C7480+C8j
		mov	ebx, [esp+0Ch+var_C]
		mov	esi, [esp+0Ch+var_8]
		mov	edi, [esp+0Ch+var_4]
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C74B0:				; CODE XREF: sub_679C7480+1Bj
		mov	edx, ds:679C003Ch
		cmp	dword ptr [edx+679C0000h], 4550h
		lea	ecx, [edx+679C0000h]
		jnz	short loc_679C749D
		cmp	word ptr [ecx+18h], 10Bh
		jnz	short loc_679C749D
		mov	esi, [ecx+80h]
		test	esi, esi
		jz	short loc_679C749D
		movzx	edi, word ptr [ecx+6]
		movzx	edx, word ptr [ecx+14h]
		test	edi, edi
		jz	short loc_679C749D
		movzx	edx, dx
		lea	edx, [ecx+edx+18h]
		xor	ecx, ecx
		jmp	short loc_679C74F4
; ---------------------------------------------------------------------------

loc_679C74F1:				; CODE XREF: sub_679C7480+87j
		add	edx, 28h

loc_679C74F4:				; CODE XREF: sub_679C7480+6Fj
		mov	ebx, [edx+0Ch]
		cmp	esi, ebx
		jb	short loc_679C7502
		add	ebx, [edx+8]
		cmp	esi, ebx
		jb	short loc_679C750B

loc_679C7502:				; CODE XREF: sub_679C7480+79j
		add	ecx, 1
		cmp	edi, ecx
		ja	short loc_679C74F1
		jmp	short loc_679C749D
; ---------------------------------------------------------------------------

loc_679C750B:				; CODE XREF: sub_679C7480+80j
		test	edx, edx
		lea	esi, [esi+0]
		jz	short loc_679C749D
		add	esi, 679C0000h
		jmp	short loc_679C752A
; ---------------------------------------------------------------------------
		align 10h

loc_679C7520:				; CODE XREF: sub_679C7480+AFj
					; sub_679C7480+B6j
		test	eax, eax
		jle	short loc_679C7540
		sub	eax, 1
		add	esi, 14h

loc_679C752A:				; CODE XREF: sub_679C7480+98j
		mov	ecx, [esi+4]
		test	ecx, ecx
		jnz	short loc_679C7520
		mov	edx, [esi+0Ch]
		test	edx, edx
		jnz	short loc_679C7520
		jmp	loc_679C749D
; ---------------------------------------------------------------------------
		align 10h

loc_679C7540:				; CODE XREF: sub_679C7480+A2j
		mov	eax, 679C0000h
		add	eax, [esi+0Ch]
		jmp	loc_679C749F
sub_679C7480	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		xor	edx, edx
		sub	esp, 18h
		mov	eax, ds:dword_679CA3A4
		test	eax, eax
		jz	short loc_679C75A2

loc_679C755F:				; CODE XREF: .text:679C75EFj
					; .text:679C760Aj
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_679C7564:				; CODE XREF: .text:679C75D3j
					; .text:679C75D8j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_679C7572
		cmp	dl, 63h
		jnz	short loc_679C75A0

loc_679C7572:				; CODE XREF: .text:679C756Bj
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_679C7582
		cmp	dl, 72h
		xchg	ax, ax
		jnz	short loc_679C75A0

loc_679C7582:				; CODE XREF: .text:679C7579j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_679C75DE
		cmp	dl, 74h
		xchg	ax, ax
		jz	short loc_679C75DE
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_679C75DE
		lea	esi, [esi+0]

loc_679C75A0:				; CODE XREF: .text:679C7570j
					; .text:679C7580j ...
		mov	edx, ebx

loc_679C75A2:				; CODE XREF: .text:679C755Dj
					; .text:679C75DCj
		lea	ebx, [edx+1]
		mov	[esp], edx
		call	sub_679C7480
		test	eax, eax
		jz	short loc_679C75F5
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_679C75BE
		cmp	dl, 6Dh
		jnz	short loc_679C75A0

loc_679C75BE:				; CODE XREF: .text:679C75B7j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_679C75CC
		cmp	dl, 73h
		jnz	short loc_679C75A0

loc_679C75CC:				; CODE XREF: .text:679C75C5j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_679C7564
		cmp	dl, 76h
		jz	short loc_679C7564
		mov	edx, ebx
		jmp	short loc_679C75A2
; ---------------------------------------------------------------------------

loc_679C75DE:				; CODE XREF: .text:679C7589j
					; .text:679C7590j ...
		mov	[esp], eax
		call	ds:GetModuleHandleA
		test	eax, eax
		push	ebx
		mov	ds:dword_679CA3A4, eax
		jnz	loc_679C755F

loc_679C75F5:				; CODE XREF: .text:679C75AFj
		mov	dword ptr [esp], offset	aMsvcrt_dll ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_679CA3A4, eax
		jmp	loc_679C755F
; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 2Ch
		mov	[esp+20h], esi
		mov	esi, [esp+30h]
		mov	[esp+1Ch], ebx
		mov	[esp+24h], edi
		mov	[esp+28h], ebp
		mov	[esp], esi
		call	strlen
		cmp	eax, 8
		jbe	short loc_679C7650

loc_679C7634:				; CODE XREF: .text:679C7659j
					; .text:679C7670j ...
		xor	ebx, ebx

loc_679C7636:				; CODE XREF: .text:679C76AAj
		mov	eax, ebx
		mov	esi, [esp+20h]
		mov	ebx, [esp+1Ch]
		mov	edi, [esp+24h]
		mov	ebp, [esp+28h]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_679C7650:				; CODE XREF: .text:679C7632j
		cmp	word ptr ds:679C0000h, 5A4Dh
		jnz	short loc_679C7634
		mov	eax, ds:679C003Ch
		cmp	dword ptr [eax+679C0000h], 4550h
		lea	edx, [eax+679C0000h]
		jnz	short loc_679C7634
		cmp	word ptr [edx+18h], 10Bh
		jnz	short loc_679C7634
		movzx	ebp, word ptr [edx+6]
		movzx	eax, word ptr [edx+14h]
		test	ebp, ebp
		jz	short loc_679C7634
		movzx	eax, ax
		xor	edi, edi
		lea	ebx, [edx+eax+18h]
		jmp	short loc_679C7694
; ---------------------------------------------------------------------------

loc_679C7691:				; CODE XREF: .text:679C76B1j
		add	ebx, 28h

loc_679C7694:				; CODE XREF: .text:679C768Fj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], esi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jz	short loc_679C7636
		add	edi, 1
		cmp	edi, ebp
		jb	short loc_679C7691
		jmp	loc_679C7634
; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __udivdi3]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __umoddi3]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_679C76D0	proc near		; CODE XREF: sub_679C6B50+3Cp

arg_0		= byte ptr  4

		push	ecx
		lea	ecx, [esp+4+arg_0]
		cmp	eax, 1000h
		jb	short loc_679C76F1

loc_679C76DC:				; CODE XREF: sub_679C76D0+1Fj
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_679C76DC

loc_679C76F1:				; CODE XREF: sub_679C76D0+Aj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		mov	eax, esp
		mov	esp, ecx
		mov	ecx, [eax]
		mov	eax, [eax+4]
		push	eax
		retn
sub_679C76D0	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _mkdir]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _access]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fdopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _putenv]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _strdup]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _strlwr]
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_679C7760
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_679C7760	proc near		; CODE XREF: sub_679C1040+53p
					; sub_679C1040+C8p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_679C7760	endp

; ---------------------------------------------------------------------------
		align 10h
		mov	eax, [esp+8]
		mov	edx, [esp+4]
		lock xchg eax, [edx]
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_679C7790	proc near		; CODE XREF: sub_679C1040+1A2p
					; sub_679C1040+211p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		mov	edx, [esp+arg_0]
		lock xchg eax, [edx]
		retn	8
sub_679C7790	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_679C77A0	proc near		; CODE XREF: sub_679C3D80+1140p
					; localtime_r+Fp
		sub	esp, 0Ch
		mov	eax, ds:localtime
		add	esp, 0Ch
		jmp	eax
sub_679C77A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_679C77B0	proc near		; CODE XREF: gmtime_r+Fp
		sub	esp, 0Ch
		mov	eax, ds:gmtime
		add	esp, 0Ch
		jmp	eax
sub_679C77B0	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		mov	eax, [esp+14h]
		mov	edx, [esp+10h]
		test	eax, eax
		jz	short loc_679C77E0
		mov	[esp+14h], eax
		mov	[esp+10h], edx
		add	esp, 0Ch
		jmp	loc_679C71B0
; ---------------------------------------------------------------------------
		align 10h

loc_679C77E0:				; CODE XREF: .text:679C77CDj
		add	esp, 0Ch
		retn
; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		add	esp, 0Ch
		jmp	loc_679C7110
; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION sprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION rename]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION remove]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION freopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncpy]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION realloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION getenv]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION signal]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION srand]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION rand]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcat]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strstr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION memchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_679C78F0	proc near		; DATA XREF: .text:679C7914o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_679C1430
		mov	[esp+18h+var_18], offset sub_679C1480 ;	_onexit_t
		call	sub_679C6880
		leave
		retn
sub_679C78F0	endp

; ---------------------------------------------------------------------------
		align 10h
dword_679C7910	dd 0FFFFFFFFh		; DATA XREF: sub_679C6E60-5Br
					; sub_679C6E60-4Co ...
		dd offset sub_679C78F0
		dd 0
		dd 0FFFFFFFFh
dword_679C7920	dd 38h dup(0)		; DATA XREF: .data:off_679C8048o
		dd 180h	dup(?)
_text		ends

; Section 2. (virtual address 00008000)
; Virtual size			: 0000005C (	 92.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00006E00
; Flags	C0600040: Data Readable	Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 679C8000h
off_679C8000	dd offset dword_679C9064 ; DATA	XREF: getgrnamo getgrgido ...
		dd offset dword_679C9064
		dd 0FFFFFFFEh, 0
dword_679C8010	dd 0FFFFFFFFh		; DATA XREF: munmap+137w mmap+3r ...
		align 10h
off_679C8020	dd offset dword_679C9320 ; DATA	XREF: getpwnamo getpwuido ...
		dd offset dword_679C9320
		dd 2 dup(0FFFFFFFEh)
		dd offset dword_679C9320
		dd offset dword_679C9320
		dd offset dword_679C9320
		dd offset dword_679C9320
dword_679C8040	dd 0FFFFFFFFh		; DATA XREF: sub_679C1260+1Bw
					; sub_679C1260+61w
		dd 0FFFFFFFFh
off_679C8048	dd offset dword_679C7920 ; DATA	XREF: sub_679C6DD0+3r
					; sub_679C6DD0+12r ...
dword_679C804C	dd 2			; DATA XREF: TlsCallback_0+4r
					; TlsCallback_0+11w
dword_679C8050	dd 0BB40E64Eh		; DATA XREF: .text:679C6EDFr
					; sub_679C6F30+3r ...
dword_679C8054	dd 44BF19B1h		; DATA XREF: .text:679C6EE7r
					; sub_679C6F30+21w ...
dword_679C8058	dd 0			; DATA XREF: sub_679C1430+6r
					; sub_679C1430+42o
		align 1000h
_data		ends

; Section 3. (virtual address 00009000)
; Virtual size			: 00000AF4 (   2804.)
; Section size in file		: 00000C00 (   3072.)
; Offset to raw	data for section: 00007000
; Flags	40600040: Data Readable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment '32byte' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 679C9000h
; CHAR ModuleName[]
ModuleName	db 'libgcj_s.dll',0     ; DATA XREF: sub_679C1430+Fo
; CHAR ProcName[]
ProcName	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_679C1430+2Ao
		align 4
; char Format[]
Format		db '%x',0               ; DATA XREF: kde_inet_ntop+2AEo
					; kde_inet_ntop+501o ...
; char aU_U_U_U[]
aU_U_U_U	db '%u.%u.%u.%u',0      ; DATA XREF: kde_inet_ntop+3B3o
					; kde_inet_ntop+A62o
		align 4
; char Str[]
Str		db '0123456789',0       ; DATA XREF: kde_inet_pton+69o
					; kde_inet_pton+9Eo ...
; char a0123456789ab_0[]
a0123456789ab_0	db '0123456789ABCDEF',0 ; DATA XREF: kde_inet_pton+264o
					; kde_inet_pton:loc_679C24A9o
; char a0123456789abcd[]
a0123456789abcd	db '0123456789abcdef',0 ; DATA XREF: kde_inet_pton+14Fo
					; kde_inet_pton+15Bo
		align 4
dword_679C9064	dd 0			; DATA XREF: .data:off_679C8000o
					; .data:679C8004o
a255_255_255_25	db '255.255.255.255',0  ; DATA XREF: inet_aton+45o
		align 10h
aBAD		db '%b %a %d',0         ; DATA XREF: nl_langinfo:loc_679C330Ao
aBADKMSZY	db '%b %a %d %k:%M:%S %Z %Y',0 ; DATA XREF: nl_langinfo:loc_679C3311o
; char VarName[]
VarName		db 'LC_CTYPE',0         ; DATA XREF: nl_langinfo:loc_679C3318o
; char aLc_all[]
aLc_all		db 'LC_ALL',0           ; DATA XREF: nl_langinfo+B8o
aAnsi_x3_41968	db 'ANSI_X3.4-1968',0   ; DATA XREF: nl_langinfo+CCo
aHM		db '%H:%M',0            ; DATA XREF: nl_langinfo:loc_679C3303o
aIMSP		db '%I:%M:%S %p',0      ; DATA XREF: nl_langinfo:loc_679C32FCo
aAm_0		db 'am',0               ; DATA XREF: nl_langinfo:loc_679C32F5o
aPm_0		db 'pm',0               ; DATA XREF: nl_langinfo:loc_679C32EEo
byte_679C90D8	db 0			; DATA XREF: nl_langinfo:loc_679C32D2o
byte_679C90D9	db 2Eh,	0		; DATA XREF: nl_langinfo:loc_679C32E0o
aYy		db '^[yY]',0            ; DATA XREF: nl_langinfo:loc_679C32D9o
aNn		db '^[nN]',0            ; DATA XREF: nl_langinfo:loc_679C32E7o
asc_679C90E7	db '$',0                ; DATA XREF: nl_langinfo:loc_679C3346o
		align 4
off_679C90EC	dd offset loc_679C3318,	offset loc_679C3311, offset loc_679C330A
					; DATA XREF: nl_langinfo:loc_679C32C0r
		dd offset loc_679C3303,	offset loc_679C32FC, offset loc_679C32F5 ; jump	table for switch statement
		dd offset loc_679C32EE,	offset loc_679C32B4, offset loc_679C32B4
		dd offset loc_679C32B4,	offset loc_679C32B4, offset loc_679C32B4
		dd offset loc_679C32B4,	offset loc_679C32B4, offset loc_679C32B4
		dd offset loc_679C32B4,	offset loc_679C32B4, offset loc_679C32B4
		dd offset loc_679C32B4,	offset loc_679C32B4, offset loc_679C32B4
		dd offset loc_679C32B4,	offset loc_679C32B4, offset loc_679C32B4
		dd offset loc_679C32B4,	offset loc_679C32B4, offset loc_679C32B4
		dd offset loc_679C32B4,	offset loc_679C32B4, offset loc_679C32B4
		dd offset loc_679C32B4,	offset loc_679C32B4, offset loc_679C32B4
		dd offset loc_679C32B4,	offset loc_679C32B4, offset loc_679C32B4
		dd offset loc_679C32B4,	offset loc_679C32B4, offset loc_679C32B4
		dd offset loc_679C32B4,	offset loc_679C32B4, offset loc_679C32B4
		dd offset loc_679C32B4,	offset loc_679C32B4, offset loc_679C32B4
		dd offset loc_679C32B4,	offset loc_679C32D2, offset loc_679C32D2
		dd offset loc_679C32D2,	offset loc_679C32D2, offset loc_679C32E0
		dd offset loc_679C32D2,	offset loc_679C32D9, offset loc_679C32E7
		dd offset loc_679C3346
		align 20h
aSunday		db 'Sunday',0
		align 4
		dd 6F4D0000h, 7961646Eh, 0
aTuesday_0	db 'Tuesday',0
		dd 65570000h, 73656E64h, 796164h, 72756854h, 79616473h
		dd 72460000h, 79616469h, 0
aSaturday_0	db 'Saturday',0
		align 2
aSun_0		db 'Sun',0              ; DATA XREF: nl_langinfo+1Fo
aMon_0		db 'Mon',0
aTue_0		db 'Tue',0
aWed_0		db 'Wed',0
aThu_0		db 'Thu',0
aFri_0		db 'Fri',0
aSat_0		db 'Sat',0
aJanuary_0	db 'January',0          ; DATA XREF: .rdata:off_679C92A0o
aFebruary_0	db 'February',0         ; DATA XREF: .rdata:679C92A4o
aMarch_0	db 'March',0            ; DATA XREF: .rdata:679C92A8o
aApril_0	db 'April',0            ; DATA XREF: .rdata:679C92ACo
aJune_0		db 'June',0             ; DATA XREF: .rdata:679C92B4o
aJuly_0		db 'July',0             ; DATA XREF: .rdata:679C92B8o
aAugust_0	db 'August',0           ; DATA XREF: .rdata:679C92BCo
aSeptember_0	db 'September',0        ; DATA XREF: .rdata:679C92C0o
aOctober_0	db 'October',0          ; DATA XREF: .rdata:679C92C4o
aNovember_0	db 'November',0         ; DATA XREF: .rdata:679C92C8o
aDecember_0	db 'December',0         ; DATA XREF: .rdata:679C92CCo
		align 10h
off_679C92A0	dd offset aJanuary_0	; DATA XREF: nl_langinfo:loc_679C32C7r
					; "January"
		dd offset aFebruary_0	; "February"
		dd offset aMarch_0	; "March"
		dd offset aApril_0	; "April"
		dd offset dword_679C92F0
		dd offset aJune_0	; "June"
		dd offset aJuly_0	; "July"
		dd offset aAugust_0	; "August"
		dd offset aSeptember_0	; "September"
		dd offset aOctober_0	; "October"
		dd offset aNovember_0	; "November"
		dd offset aDecember_0	; "December"
		align 20h
dword_679C92E0	dd 6E614Ah, 626546h, 72614Dh, 727041h ;	DATA XREF: nl_langinfo+36o
dword_679C92F0	dd 79614Dh, 6E754Ah, 6C754Ah, 677541h, 706553h,	74634Fh
					; DATA XREF: .rdata:679C92B0o
		dd 766F4Eh, 636544h, 4 dup(0)
dword_679C9320	dd 0			; DATA XREF: .data:off_679C8020o
					; .data:679C8024o ...
; CHAR aKernel32_dll[]
aKernel32_dll	db 'KERNEL32.DLL',0     ; DATA XREF: kill+86o
; CHAR aExitprocess[]
aExitprocess	db 'ExitProcess',0      ; DATA XREF: kill+96o
		align 10h
flt_679C9340	dd 0.000030517578	; DATA XREF: drand48+10r
		align 20h
aABEHMSY	db '%a %b %e %H:%M:%S %Y',0 ; DATA XREF: sub_679C3D80+11D9o
aYMD		db '%Y-%m-%d',0         ; DATA XREF: sub_679C3D80+B67o
aMDY		db '%m/%d/%y',0         ; DATA XREF: sub_679C3D80+BCEo
; char aAm[]
aAm		db 'AM',0               ; DATA XREF: sub_679C3D80+11AFo
aPm		db 'PM',0               ; DATA XREF: sub_679C3D80+13DEo
aIMSP_0		db '%I:%M:%S %p',0      ; DATA XREF: sub_679C3D80+1193o
aHM_0		db '%H:%M',0            ; DATA XREF: sub_679C3D80+B1Do
aHMS		db '%H:%M:%S',0         ; DATA XREF: sub_679C3D80+120Do
off_679C93A8	dd offset loc_679C49E9,	offset loc_679C3E25, offset loc_679C3E25
					; DATA XREF: sub_679C3D80+E3r
		dd offset loc_679C3E25,	offset loc_679C3E25, offset loc_679C3E25 ; jump	table for switch statement
		dd offset loc_679C3E25,	offset loc_679C3E25, offset loc_679C3E25
		dd offset loc_679C3E25,	offset loc_679C3E25, offset loc_679C3E25
		dd offset loc_679C3E25,	offset loc_679C3E25, offset loc_679C3E25
		dd offset loc_679C3E25,	offset loc_679C3E25, offset loc_679C3E25
		dd offset loc_679C3E25,	offset loc_679C3E25, offset loc_679C3E25
		dd offset loc_679C3E25,	offset loc_679C3E25, offset loc_679C3E25
		dd offset loc_679C3E25,	offset loc_679C3E25, offset loc_679C3E25
		dd offset loc_679C3E25,	offset loc_679C4958, offset loc_679C49FA
		dd offset loc_679C3E6D,	offset loc_679C4945, offset loc_679C490A
		dd offset loc_679C48DB,	offset loc_679C48BB, offset loc_679C3EC3
		dd offset loc_679C3F1C,	offset loc_679C3E25, offset loc_679C3E25
		dd offset loc_679C3E25,	offset loc_679C3F8A, offset loc_679C3E25
		dd offset loc_679C4F66,	offset loc_679C3E25, offset loc_679C3E25
		dd offset loc_679C4894,	offset loc_679C3FDB, offset loc_679C4F81
		dd offset loc_679C402C,	offset loc_679C4086, offset loc_679C40D4
		dd offset loc_679C4F81,	offset loc_679C412E, offset loc_679C3DFC
		dd offset loc_679C3E25,	offset loc_679C3E25, offset loc_679C3E25
		dd offset loc_679C3E25,	offset loc_679C3E25, offset loc_679C3E25
		dd offset loc_679C4958,	offset loc_679C49FA, offset loc_679C4F50
		dd offset loc_679C41E1,	offset loc_679C41E1, offset loc_679C3E25
		dd offset loc_679C4245,	offset loc_679C49FA, offset loc_679C3E25
		dd offset loc_679C4293,	offset loc_679C3EC3, offset loc_679C3F1C
		dd offset loc_679C4318,	offset loc_679C437C, offset loc_679C3E25
		dd offset loc_679C4F1D,	offset loc_679C3E25, offset loc_679C4F07
		dd offset loc_679C4E7F,	offset loc_679C437C, offset loc_679C4390
		dd offset loc_679C3E25,	offset loc_679C43EA, offset loc_679C4945
		dd offset loc_679C4422
off_679C94FC	dd offset loc_679C5088	; DATA XREF: sub_679C3D80+11FAr
		dd offset loc_679C5078	; jump table for switch	statement
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C5068
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C5058
		dd offset loc_679C3E25
		dd offset loc_679C5048
		dd offset loc_679C5038
		dd offset loc_679C5028
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C5019
		dd offset loc_679C5019
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C500A
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C3E25
		dd offset loc_679C4FFB
		dd offset loc_679C3E25
		dd offset loc_679C4F9A
		align 20h
; char Str1[]
Str1		db 'Sunday',0           ; DATA XREF: sub_679C3D80+BE8o
					; sub_679C3D80+BF8o
		align 4
		db 2 dup(0)
; char aMonday[]
aMonday		db 'Monday',0           ; DATA XREF: sub_679C3D80+1410o
					; sub_679C3D80+1420o
		align 4
; char aTuesday[]
aTuesday	db 'Tuesday',0          ; DATA XREF: sub_679C3D80+1487o
					; sub_679C3D80+1497o
		db 2 dup(0)
; char aWednesday[]
aWednesday	db 'Wednesday',0        ; DATA XREF: sub_679C3D80+14FEo
					; sub_679C3D80+150Eo
; char aThursday[]
aThursday	db 'Thursday',0         ; DATA XREF: sub_679C3D80+1575o
					; sub_679C3D80+1585o
		align 2
; char aFriday[]
aFriday		db 'Friday',0           ; DATA XREF: sub_679C3D80+15ECo
					; sub_679C3D80+15FCo
		align 4
; char aSaturday[]
aSaturday	db 'Saturday',0         ; DATA XREF: sub_679C3D80+1663o
					; sub_679C3D80+1673o
		align 2
; char aSun[]
aSun		db 'Sun',0              ; DATA XREF: sub_679C3D80+C19o
					; sub_679C3D80+C29o
; char aMon[]
aMon		db 'Mon',0              ; DATA XREF: sub_679C3D80+1441o
					; sub_679C3D80+1451o
; char aTue[]
aTue		db 'Tue',0              ; DATA XREF: sub_679C3D80+14B8o
					; sub_679C3D80+14C8o
; char aWed[]
aWed		db 'Wed',0              ; DATA XREF: sub_679C3D80+152Fo
					; sub_679C3D80+153Fo
; char aThu[]
aThu		db 'Thu',0              ; DATA XREF: sub_679C3D80+15A6o
					; sub_679C3D80+15B6o
; char aFri[]
aFri		db 'Fri',0              ; DATA XREF: sub_679C3D80+161Do
					; sub_679C3D80+162Do
; char aSat[]
aSat		db 'Sat',0              ; DATA XREF: sub_679C3D80+1690o
					; sub_679C3D80+16A0o
		align 20h
; char aJanuary[]
aJanuary	db 'January',0          ; DATA XREF: sub_679C3D80:loc_679C49FAo
					; sub_679C3D80+C8Ao
		db 2 dup(0)
; char aFebruary[]
aFebruary	db 'February',0         ; DATA XREF: sub_679C3D80+CD8o
					; sub_679C3D80+CE8o
		align 4
; char aMarch[]
aMarch		db 'March',0            ; DATA XREF: sub_679C3D80+D36o
					; sub_679C3D80+D46o
		align 4
		db 2 dup(0)
; char aApril[]
aApril		db 'April',0            ; DATA XREF: sub_679C3D80+D94o
					; sub_679C3D80+DA4o
		align 8
; char aMay[]
aMay		db 'May',0              ; DATA XREF: sub_679C3D80+DF2o
					; sub_679C3D80+E02o
		dd 0
		db 2 dup(0)
; char aJune[]
aJune		db 'June',0             ; DATA XREF: sub_679C3D80+E50o
					; sub_679C3D80+E60o
		align 4
		dd 0
; char aJuly[]
aJuly		db 'July',0             ; DATA XREF: sub_679C3D80+EAEo
					; sub_679C3D80+EBEo
		align 4
		db 2 dup(0)
; char aAugust[]
aAugust		db 'August',0           ; DATA XREF: sub_679C3D80+F0Co
					; sub_679C3D80+F1Co
		align 10h
; char aSeptember[]
aSeptember	db 'September',0        ; DATA XREF: sub_679C3D80+F6Ao
					; sub_679C3D80+F7Ao
; char aOctober[]
aOctober	db 'October',0          ; DATA XREF: sub_679C3D80+FC8o
					; sub_679C3D80+FD8o
		align 4
; char aNovember[]
aNovember	db 'November',0         ; DATA XREF: sub_679C3D80+1026o
					; sub_679C3D80+1036o
		align 2
; char aDecember[]
aDecember	db 'December',0         ; DATA XREF: sub_679C3D80+1084o
					; sub_679C3D80+1094o
		align 10h
; char aJan[]
aJan		db 'Jan',0              ; DATA XREF: sub_679C3D80+CA9o
					; sub_679C3D80+CB9o
; char aFeb[]
aFeb		db 'Feb',0              ; DATA XREF: sub_679C3D80+D07o
					; sub_679C3D80+D17o
; char aMar[]
aMar		db 'Mar',0              ; DATA XREF: sub_679C3D80+D65o
					; sub_679C3D80+D75o
; char aApr[]
aApr		db 'Apr',0              ; DATA XREF: sub_679C3D80+DC3o
					; sub_679C3D80+DD3o
; char aMay_0[]
aMay_0		db 'May',0              ; DATA XREF: sub_679C3D80+E21o
					; sub_679C3D80+E31o
; char aJun[]
aJun		db 'Jun',0              ; DATA XREF: sub_679C3D80+E7Fo
					; sub_679C3D80+E8Fo
; char aJul[]
aJul		db 'Jul',0              ; DATA XREF: sub_679C3D80+EDDo
					; sub_679C3D80+EEDo
; char aAug[]
aAug		db 'Aug',0              ; DATA XREF: sub_679C3D80+F3Bo
					; sub_679C3D80+F4Bo
; char aSep[]
aSep		db 'Sep',0              ; DATA XREF: sub_679C3D80+F99o
					; sub_679C3D80+FA9o
; char aOct[]
aOct		db 'Oct',0              ; DATA XREF: sub_679C3D80+FF7o
					; sub_679C3D80+1007o
; char aNov[]
aNov		db 'Nov',0              ; DATA XREF: sub_679C3D80+1055o
					; sub_679C3D80+1065o
; char aDec[]
aDec		db 'Dec',0              ; DATA XREF: sub_679C3D80+10AFo
					; sub_679C3D80+10BFo
		align 20h
word_679C9720	dw 0			; DATA XREF: sub_679C3C90+20r
					; sub_679C3D80+86Br ...
		dw 1Fh
aZx:
		unicode	0, <;Zx>
		dw 97h
aC:
		unicode	0, <>
		dw 0D4h
		dd 11100F3h, 14E0130h
		db 6Dh,	1
word_679C973A	dw 0			; DATA XREF: sub_679C3D80:loc_679C456Cr
					; sub_679C3D80:loc_679C47B6r ...
		dd 3C001Fh, 79005Bh, 0B60098h, 0F400D5h, 1310112h, 16E014Fh
		dd 3 dup(0)
byte_679C9760	db 4Eh,	54h, 0		; DATA XREF: uname+207o
byte_679C9763	db 43h			; DATA XREF: uname+2A7o
		db 45h,	0
byte_679C9766	db 0			; DATA XREF: uname+87o
					; uname:loc_679C5C38o
byte_679C9767	db 39h			; DATA XREF: uname+32Fo
		db 35h,	0
word_679C976A	dw 3839h		; DATA XREF: uname+33Do
		db 0
byte_679C976D	db 4Dh,	45h, 0		; DATA XREF: uname+2B8o
; char aMingw32_SU_U[]
aMingw32_SU_U	db 'MINGW32_%s-%u.%u',0 ; DATA XREF: uname+9Bo
; char aSU_U[]
aSU_U		db '%s %u.%u',0         ; DATA XREF: uname+2FFo
; char aWindowsCeU_U[]
aWindowsCeU_U	db 'Windows CE %u.%u',0 ; DATA XREF: uname+277o
; char aWindowsS[]
aWindowsS	db 'Windows %s',0       ; DATA XREF: uname+CFo
; char aIU[]
aIU		db 'i%u',0              ; DATA XREF: uname+350o
		align 4
off_679C97AC	dd offset loc_679C5CF5	; DATA XREF: uname+267r
		dd offset loc_679C5CE5	; jump table for switch	statement
		dd offset loc_679C5D56
		dd offset loc_679C5D43
		dd offset loc_679C5D34
		dd offset loc_679C5D28
		dd offset loc_679C5BA2
		dd offset loc_679C5D56
		dd offset loc_679C5AC6
		dd offset loc_679C5B81
		dd offset loc_679C5CD5
aWindowsNtWorks	db 'Windows NT Workstation',0 ; DATA XREF: .rdata:679C98ACo
					; .rdata:679C98BCo
aWindowsNtServe	db 'Windows NT Server',0
aWindows2000	db 'Windows 2000',0     ; DATA XREF: .rdata:679C98CCo
aWindowsXp	db 'Windows XP',0       ; DATA XREF: .rdata:679C98DCo
aWindowsServer2	db 'Windows Server 2003',0 ; DATA XREF: .rdata:679C98ECo
		align 10h
aWindowsVista	db 'Windows Vista',0    ; DATA XREF: .rdata:679C98FCo
aWindowsServe_0	db 'Windows Server 2008',0
		align 4
aWindows7	db 'Windows 7',0        ; DATA XREF: .rdata:679C990Co
aWindowsServe_1	db 'Windows Server 2008 R2',0
aWindows	db 'Windows',0          ; DATA XREF: .rdata:679C991Co
aWindowsServer	db 'Windows Server',0
		align 20h
dword_679C98A0	dd 3, 0FFFFFFFFh, 17h	; DATA XREF: uname+19Fo
		dd offset aWindowsNtWorks ; "Windows NT	Workstation"
		dd 4, 0FFFFFFFFh, 17h
		dd offset aWindowsNtWorks ; "Windows NT	Workstation"
		dd 5, 2	dup(0)
		dd offset aWindows2000	; "Windows 2000"
		dd 5, 1, 0
		dd offset aWindowsXp	; "Windows XP"
		dd 5, 2, 0
		dd offset aWindowsServer2 ; "Windows Server 2003"
		dd 6, 0
		dd 0Eh
		dd offset aWindowsVista	; "Windows Vista"
		dd 6, 1, 0Ah
		dd offset aWindows7	; "Windows 7"
		dd 2 dup(0FFFFFFFFh), 8
		dd offset aWindows	; "Windows"
; const	WCHAR OutputString
OutputString:				; DATA XREF: truncate+Ao
		unicode	0, <ERROR broken function truncate from	kdewin!>,0
aXxxxxx		db 'XXXXXX',0           ; DATA XREF: mkdtemp+44o mkstemps+45o ...
		align 10h
byte_679C9980	db 61h			; DATA XREF: mkdtemp+D2r mkdtemp+F9r ...
aBcdefghijklmno	db 'bcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789',0
		align 10h
byte_679C99C0	db 61h			; DATA XREF: mkstemps+CEr mkstemps+F5r ...
aBcdefghijklm_0	db 'bcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789',0
		align 10h
off_679C9A00	dd offset TlsCallback_0	; DATA XREF: sub_679C1040:loc_679C1137r
aMingwW64Runtim	db 'Mingw-w64 runtime failure:',0Ah,0 ; DATA XREF: sub_679C69A0+1Do
; char aAddressPHasNoI[]
aAddressPHasNoI	db 'Address %p has no image-section',0 ; DATA XREF: sub_679C6A00+13Ao
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: sub_679C6A00+126o
					; sub_679C6B50+253o
		align 4
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_679C6B50+267o
		align 4
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_679C6B50+F4o
		align 4
off_679C9AD4	dd offset dword_679CA040 ; DATA	XREF: .text:679C6EF8o
		dd offset dword_679CA0A0
aMsvcrt_dll:				; DATA XREF: .text:loc_679C75F5o
		unicode	0, <msvcrt.dll>,0
		align 4
dword_679C9AF4	dd 0			; DATA XREF: sub_679C6B50+57o
					; sub_679C6B50+5Co ...
dword_679C9AF8	dd 0			; DATA XREF: sub_679C6B50+7Ar
dword_679C9AFC	dd 0			; DATA XREF: sub_679C6B50+84r
dword_679C9B00	dd 40h dup(0)		; DATA XREF: sub_679C6B50+8Do
		align 800h
_rdata		ends

; Section 4. (virtual address 0000A000)
; Virtual size			: 000004E0 (   1248.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 679CA000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_679CA000	dd ?			; DATA XREF: sub_679C1040+Dr
					; sub_679C1040+22w ...
; void *Memory
Memory		dd ?			; DATA XREF: munmap+16r munmap+4Er ...
dword_679CA008	dd ?			; DATA XREF: munmap+8r	munmap+A0r ...
dword_679CA00C	dd ?			; DATA XREF: setenv:loc_679C3930r
					; setenv+49w ...
dword_679CA010	dd ?			; DATA XREF: getpagesize+3r
					; getpagesize+20w
TlsIndex	dd 4 dup(?)		; DATA XREF: .tls:TlsIndex_ptro
dword_679CA024	dd ?			; DATA XREF: DllEntryPoint+7w
dword_679CA028	dd ?			; DATA XREF: sub_679C6A00+2Cr
					; sub_679C6A00+65r ...
dword_679CA02C	dd ?			; DATA XREF: sub_679C6A00:loc_679C6A20r
					; sub_679C6A00:loc_679C6AC2w ...
dword_679CA030	dd ?			; DATA XREF: sub_679C6B50+9r
					; sub_679C6B50:loc_679C6B70w
dword_679CA034	dd ?			; DATA XREF: sub_679C6E60+3r
					; sub_679C6E60:loc_679C6E71w
		align 10h
dword_679CA040	dd ?			; DATA XREF: .text:679C6EB2w
					; .rdata:off_679C9AD4o
dword_679CA044	dd ?			; DATA XREF: .text:679C6EBCw
		dd ?
dword_679CA04C	dd ?			; DATA XREF: .text:679C6ECBw
		dd 14h dup(?)
dword_679CA0A0	dd 2Bh dup(?)		; DATA XREF: .rdata:679C9AD8o
dword_679CA14C	dd ?			; DATA XREF: .text:679C6EDAw
		dd 2 dup(?)
dword_679CA158	dd ?			; DATA XREF: .text:679C6EC6w
		dd 2 dup(?)
dword_679CA164	dd ?			; DATA XREF: .text:679C6EACw
		dd 86h dup(?)
dword_679CA380	dd ?			; DATA XREF: sub_679C7000+7r
					; sub_679C7080+26r ...
; struct _RTL_CRITICAL_SECTION stru_679CA384
stru_679CA384	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_679C7000:loc_679C7018o
					; sub_679C7000:loc_679C7065o ...
dword_679CA39C	dd ?			; DATA XREF: sub_679C7000+25r
					; .text:679C7135r ...
		dd ?
dword_679CA3A4	dd ?			; DATA XREF: .text:679C7556r
					; .text:679C75EAw ...
; Exported entry   6. cs
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: munmap+93o
					; munmap:loc_679C2E89o	...
; Exported entry  24. getlogin_buf
		public getlogin_buf
; CHAR getlogin_buf
getlogin_buf	db ?			; DATA XREF: getlogin+Fw getlogin+1Ao	...
		align 4
		dd 3Fh dup(?)
dword_679CA4C0	dd ?			; DATA XREF: sub_679C1000+21w
					; sub_679C1040+143r ...
dword_679CA4C4	dd ?			; DATA XREF: sub_679C1000+1Cw
					; sub_679C1040:loc_679C1170r ...
dword_679CA4C8	dd ?			; DATA XREF: sub_679C1040+4Co
					; sub_679C1040+C1o ...
dword_679CA4CC	dd ?			; DATA XREF: sub_679C1040+5Fr
					; sub_679C1040:loc_679C1116r ...
		align 1000h
_bss		ends

;
; Imports from ADVAPI32.DLL
;
; Section 6. (virtual address 0000C000)
; Virtual size			: 00000BA8 (   2984.)
; Section size in file		: 00000C00 (   3072.)
; Offset to raw	data for section: 00008400
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
; BOOL __stdcall GetUserNameA(LPSTR lpBuffer, LPDWORD pcbBuffer)
		extrn GetUserNameA:dword ; CODE	XREF: getlogin+21p
					; DATA XREF: getlogin+21r

;
; Imports from KERNEL32.dll
;
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: munmap+7Ep munmap+8Ep ...
; BOOL __stdcall CopyFileA(LPCSTR lpExistingFileName, LPCSTR lpNewFileName, BOOL bFailIfExists)
		extrn CopyFileA:dword	; CODE XREF: symlink+1Ap link+1Ap
					; DATA XREF: ...
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
		extrn CreateFileA:dword	; CODE XREF: utimes+D1p truncate+59p
					; DATA XREF: ...
; HANDLE __stdcall CreateFileMappingW(HANDLE hFile, LPSECURITY_ATTRIBUTES lpFileMappingAttributes, DWORD flProtect, DWORD dwMaximumSizeHigh, DWORD dwMaximumSizeLow, LPCWSTR lpName)
		extrn CreateFileMappingW:dword ; CODE XREF: mmap+18Bp
					; DATA XREF: mmap+18Br
; HANDLE __stdcall CreateRemoteThread(HANDLE hProcess, LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T	dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter,	DWORD dwCreationFlags, LPDWORD lpThreadId)
		extrn CreateRemoteThread:dword ; CODE XREF: kill+DCp
					; DATA XREF: kill+DCr
; HANDLE __stdcall CreateToolhelp32Snapshot(DWORD dwFlags, DWORD th32ProcessID)
		extrn __imp_CreateToolhelp32Snapshot:dword
					; DATA XREF: CreateToolhelp32Snapshotr
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_679C7080+41p
					; DATA XREF: sub_679C7080+41r
; BOOL __stdcall DuplicateHandle(HANDLE	hSourceProcessHandle, HANDLE hSourceHandle, HANDLE hTargetProcessHandle, LPHANDLE lpTargetHandle, DWORD	dwDesiredAccess, BOOL bInheritHandle, DWORD dwOptions)
		extrn DuplicateHandle:dword ; CODE XREF: mmap+C0p
					; DATA XREF: mmap+C0r
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: munmap+9Ap
					; mmap+1DBp ...
; BOOL __stdcall FlushFileBuffers(HANDLE hFile)
		extrn FlushFileBuffers:dword ; CODE XREF: fsync+25p
					; DATA XREF: fsync+25r
; BOOL __stdcall GenerateConsoleCtrlEvent(DWORD	dwCtrlEvent, DWORD dwProcessGroupId)
		extrn GenerateConsoleCtrlEvent:dword ; CODE XREF: kill+190p
					; kill+1E2p
					; DATA XREF: ...
; BOOL __stdcall GetComputerNameA(LPSTR	lpBuffer, LPDWORD nSize)
		extrn GetComputerNameA:dword ; CODE XREF: kde_gethostname+1Ap
					; DATA XREF: kde_gethostname+1Ar
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: mmap+89p mmap+8Fp ...
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_679C6F30+6Cp
					; DATA XREF: sub_679C6F30+6Cr
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_679C6F30+74p
					; DATA XREF: sub_679C6F30+74r
; DWORD	__stdcall GetEnvironmentVariableA(LPCSTR lpName, LPSTR lpBuffer, DWORD nSize)
		extrn GetEnvironmentVariableA:dword ; CODE XREF: kde_getenv+4Cp
					; kde_getenv+6Dp
					; DATA XREF: ...
; BOOL __stdcall GetExitCodeProcess(HANDLE hProcess, LPDWORD lpExitCode)
		extrn GetExitCodeProcess:dword ; CODE XREF: waitpid+49p
					; DATA XREF: waitpid+49r
; BOOL __stdcall GetFileSizeEx(HANDLE hFile, PLARGE_INTEGER lpFileSize)
		extrn GetFileSizeEx:dword ; CODE XREF: truncate+78p
					; DATA XREF: truncate+78r
; DWORD	__stdcall GetFullPathNameA(LPCSTR lpFileName, DWORD nBufferLength, LPSTR lpBuffer, LPSTR *lpFilePart)
		extrn GetFullPathNameA:dword ; CODE XREF: realpath+26p
					; DATA XREF: realpath+26r
; BOOL __stdcall GetHandleInformation(HANDLE hObject, LPDWORD lpdwFlags)
		extrn GetHandleInformation:dword ; CODE	XREF: mmap+72p
					; DATA XREF: mmap+72r
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: mmap:loc_679C3140p
					; mmap:loc_679C31A0p ...
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_679C1430+16p
					; kill+8Dp ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_679C1430+35p
					; kill+A1p
					; DATA XREF: ...
; void __stdcall GetSystemInfo(LPSYSTEM_INFO lpSystemInfo)
		extrn GetSystemInfo:dword ; CODE XREF: uname+FFp
					; getpagesize+13p
					; DATA XREF: ...
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: gettimeofday+1Ap
					; utimes+17Dp ...
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_679C6F30+7Cp
					; DATA XREF: sub_679C6F30+7Cr
; BOOL __stdcall GetVersionExW(LPOSVERSIONINFOW	lpVersionInformation)
		extrn GetVersionExW:dword ; CODE XREF: uname+26p uname+186p
					; DATA XREF: ...
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: mmap+291p
					; sub_679C7080+77p
					; DATA XREF: ...
; LONG __stdcall InterlockedCompareExchange(volatile LONG *Destination,	LONG Exchange, LONG Comperand)
		extrn InterlockedCompareExchange:dword
; LONG __stdcall InterlockedExchange(volatile LONG *Target, LONG Value)
		extrn InterlockedExchange:dword
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: munmap+100p
					; mmap+22Bp ...
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: .text:679C75FCp
					; DATA XREF: .text:679C75FCr
; LPVOID __stdcall MapViewOfFile(HANDLE	hFileMappingObject, DWORD dwDesiredAccess, DWORD dwFileOffsetHigh, DWORD dwFileOffsetLow, SIZE_T dwNumberOfBytesToMap)
		extrn MapViewOfFile:dword ; CODE XREF: mmap+1BFp
					; DATA XREF: mmap+1BFr
; HANDLE __stdcall OpenProcess(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwProcessId)
		extrn OpenProcess:dword	; CODE XREF: waitpid+1Bp kill+54p
					; DATA XREF: ...
; void __stdcall OutputDebugStringW(LPCWSTR lpOutputString)
		extrn OutputDebugStringW:dword ; CODE XREF: truncate+11p
					; DATA XREF: truncate+11r
; BOOL __stdcall Process32FirstW(HANDLE	hSnapshot, LPPROCESSENTRY32W lppe)
		extrn __imp_Process32FirstW:dword ; DATA XREF: Process32FirstWr
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_679C6F30+8Bp
					; DATA XREF: sub_679C6F30+8Br
; BOOL __stdcall SetFilePointerEx(HANDLE hFile,	LARGE_INTEGER liDistanceToMove,	PLARGE_INTEGER lpNewFilePointer, DWORD dwMoveMethod)
		extrn SetFilePointerEx:dword ; CODE XREF: truncate+B3p
					; DATA XREF: truncate+B3r
; BOOL __stdcall SetFileTime(HANDLE hFile, const FILETIME *lpCreationTime, const FILETIME *lpLastAccessTime, const FILETIME *lpLastWriteTime)
		extrn SetFileTime:dword	; CODE XREF: utimes+FCp
					; DATA XREF: utimes+FCr
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: .text:679C6EEFp
					; DATA XREF: .text:679C6EEFr
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_679C1040+37p
					; sub_679C1040+B0p
					; DATA XREF: ...
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: kill+20Bp
					; .text:679C6F19p
					; DATA XREF: ...
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_679C7000+45p
					; DATA XREF: sub_679C7000+32r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:679C6EFFp
					; DATA XREF: .text:679C6EFFr
; BOOL __stdcall UnmapViewOfFile(LPCVOID lpBaseAddress)
		extrn UnmapViewOfFile:dword ; CODE XREF: munmap+63p
					; DATA XREF: munmap+63r
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_679C6A00+10Bp
					; sub_679C6B50+1B2p
					; DATA XREF: ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_679C6A00+A8p
					; sub_679C6B50+184p
					; DATA XREF: ...
; DWORD	__stdcall WaitForSingleObject(HANDLE hHandle, DWORD dwMilliseconds)
		extrn WaitForSingleObject:dword	; CODE XREF: waitpid+35p
					; kill+F8p
					; DATA XREF: ...

;
; Imports from msvcrt.dll
;
		extrn __imp__access:dword ; DATA XREF: _accessr
; FILE *__cdecl	_fdopen(int FileHandle,	const char *Format)
		extrn __imp__fdopen:dword ; DATA XREF: _fdopenr
		extrn __imp__mkdir:dword ; DATA	XREF: _mkdirr
		extrn __imp__open:dword	; DATA XREF: _openr
; int __cdecl _putenv(const char *EnvString)
		extrn __imp__putenv:dword ; DATA XREF: _putenvr
; char *__cdecl	_strdup(const char *Src)
		extrn __imp__strdup:dword ; DATA XREF: _strdupr
; char *__cdecl	_strlwr(char *Str)
		extrn __imp__strlwr:dword ; DATA XREF: _strlwrr

;
; Imports from msvcrt.dll
;
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
; int *__cdecl errno()
		extrn _errno:dword	; CODE XREF: kde_inet_ntop+45p
					; kde_inet_ntop:loc_679C1871p ...
		extrn _get_osfhandle:dword ; CODE XREF:	fsync+17p mmap+252p
					; DATA XREF: ...
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn _iob:dword	; DATA XREF: sub_679C69A0+4r
					; sub_679C69A0+3Cr
		extrn __imp__lock:dword	; DATA XREF: _lockr
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_679C67C0+A3p
					; DATA XREF: sub_679C67C0+A3r
		extrn _pipe:dword	; CODE XREF: pipe+1Ap
					; DATA XREF: pipe+1Ar
		extrn _stat:dword	; CODE XREF: kdewin32_stat+5Fp
					; kdewin32_lstat+5Fp
					; DATA XREF: ...
; int __cdecl strnicmp(const char *Str1, const char *Str, size_t MaxCount)
		extrn _strnicmp:dword	; CODE XREF: sub_679C3D80+C07p
					; sub_679C3D80+C38p ...
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; FILE *__cdecl	fopen(const char *Filename, const char *Mode)
		extrn __imp_fopen:dword	; DATA XREF: fopenr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; FILE *__cdecl	freopen(const char *Filename, const char *Mode,	FILE *File)
		extrn __imp_freopen:dword ; DATA XREF: freopenr
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; char *__cdecl	getenv(const char *VarName)
		extrn __imp_getenv:dword ; DATA	XREF: getenvr
; struct tm *__cdecl static gmtime(const time_t	*Time)
		extrn gmtime:dword	; DATA XREF: sub_679C77B0+3r
; int __cdecl isalpha(int C)
		extrn isalpha:dword	; CODE XREF: customize_file_name+2Dp
					; kdewin32_stat+39p ...
; int __cdecl isspace(int C)
		extrn isspace:dword	; CODE XREF: sub_679C3D80+91p
					; sub_679C3D80+BAp ...
; struct tm *__cdecl static localtime(const time_t *Time)
		extrn localtime:dword	; DATA XREF: sub_679C77A0+3r
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; void *__cdecl	memchr(const void *Buf,	int Val, size_t	MaxCount)
		extrn __imp_memchr:dword ; DATA	XREF: memchrr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; int __cdecl rand()
		extrn __imp_rand:dword	; DATA XREF: randr
; void *__cdecl	realloc(void *Memory, size_t NewSize)
		extrn __imp_realloc:dword ; DATA XREF: reallocr
; int __cdecl remove(const char	*Filename)
		extrn __imp_remove:dword ; DATA	XREF: remover
; int __cdecl rename(const char	*OldFilename, const char *NewFilename)
		extrn __imp_rename:dword ; DATA	XREF: renamer
		extrn __imp_signal:dword ; DATA	XREF: signalr
; int sprintf(char *Dest, const	char *Format, ...)
		extrn __imp_sprintf:dword ; DATA XREF: sprintfr
; void __cdecl srand(unsigned int Seed)
		extrn __imp_srand:dword	; DATA XREF: srandr
; char *__cdecl	strcat(char *Dest, const char *Source)
		extrn __imp_strcat:dword ; DATA	XREF: strcatr
; char *__cdecl	strchr(const char *Str,	int Val)
		extrn __imp_strchr:dword ; DATA	XREF: strchrr
; char *__cdecl	strcpy(char *Dest, const char *Source)
		extrn __imp_strcpy:dword ; DATA	XREF: strcpyr
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; char *__cdecl	strncpy(char *Dest, const char *Source,	size_t Count)
		extrn __imp_strncpy:dword ; DATA XREF: strncpyr
; char *__cdecl	strstr(const char *Str,	const char *SubStr)
		extrn __imp_strstr:dword ; DATA	XREF: strstrr
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr

;
; Imports from WS2_32.dll
;
; unsigned __int32 __stdcall inet_addr(const char *cp)
		extrn inet_addr:dword	; CODE XREF: inet_aton+1Ap
					; DATA XREF: inet_aton+1Ar

;
; Imports from libgcc_s_sjlj-1.dll
;
		extrn __imp___udivdi3:dword ; DATA XREF: __udivdi3r
		extrn __imp___umoddi3:dword ; DATA XREF: __umoddi3r


; Section 7. (virtual address 0000D000)
; Virtual size			: 0000002C (	 44.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00009000
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 679CD000h
dword_679CD000	dd 0			; DATA XREF: sub_679C1040+1DDo
dword_679CD004	dd 0			; DATA XREF: sub_679C1040+1D5o
dword_679CD008	dd 0			; DATA XREF: sub_679C1040+1C9o
		dd offset sub_679C1000
dword_679CD010	dd 2 dup(0)		; DATA XREF: sub_679C1040+1C1o
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
		dd offset TlsCallback_1
		dd 0
		align 8
dword_679CD028	dd 76h dup(0)		; DATA XREF: TlsCallback_0:loc_679C6931o
					; TlsCallback_0+36o ...
		align 1000h
_CRT		ends

; Section 8. (virtual address 0000E000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00009200
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 679CE000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end DllEntryPoint
