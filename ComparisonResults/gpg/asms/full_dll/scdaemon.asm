;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	C158174E05F48E45BBE06A613855F6E7
; Input	CRC32 :	C791B5AF

; File Name   :	C:\compspace\compare\gpg\dlls\full\scdaemon.exe
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 000421E4 ( 270820.)
; Section size in file		: 00042200 ( 270848.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
; [00000002 BYTES: COLLAPSED FUNCTION nullsub_1]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401010	proc near		; DATA XREF: .CRT:00455004o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch

		sub	esp, 2Ch
		mov	eax, ds:dword_451950
		mov	[esp+2Ch+var_1C], offset dword_451018
		mov	[esp+2Ch+var_24], offset dword_45100C
		mov	[esp+2Ch+var_28], offset dword_451008
		mov	ds:dword_451018, eax
		mov	eax, ds:dword_451954
		mov	[esp+2Ch+var_2C], offset dword_451004
		mov	[esp+2Ch+var_20], eax
		call	__getmainargs
		mov	ds:dword_45101C, eax
		add	esp, 2Ch
		retn
sub_401010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401060	proc near		; DATA XREF: .CRT:00455010o

var_1C		= dword	ptr -1Ch

		sub	esp, 1Ch
		xor	eax, eax
		cmp	word ptr ds:400000h, 5A4Dh
		mov	ds:dword_451960, 1
		mov	ds:dword_45195C, 1
		mov	ds:dword_451958, 1
		mov	ds:dword_45196C, 1
		jz	short loc_401100

loc_401098:				; CODE XREF: sub_401060+B6j
					; sub_401060+C8j ...
		mov	ds:dword_451014, eax
		mov	eax, ds:dword_451970
		test	eax, eax
		jz	short loc_4010F0
		mov	[esp+1Ch+var_1C], 2
		call	__set_app_type

loc_4010B2:				; CODE XREF: sub_401060+9Cj
		mov	[esp+1Ch+var_1C], 0FFFFFFFFh
		call	sub_441090
		mov	edx, ds:dword_451974
		mov	ds:dword_451DA0, eax
		mov	ds:dword_451DA4, eax
		mov	eax, ds:_fmode
		mov	[eax], edx
		call	sub_4413D0
		cmp	dword_444C58, 1
		jz	short loc_401150
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4010F0:				; CODE XREF: sub_401060+44j
		mov	[esp+1Ch+var_1C], 1
		call	__set_app_type
		jmp	short loc_4010B2
; ---------------------------------------------------------------------------
		align 10h

loc_401100:				; CODE XREF: sub_401060+36j
		mov	edx, ds:40003Ch
		cmp	dword ptr [edx+400000h], 4550h
		lea	ecx, [edx+400000h]
		jnz	short loc_401098
		movzx	edx, word ptr [ecx+18h]
		cmp	dx, 10Bh
		jz	short loc_401162
		cmp	dx, 20Bh
		jnz	loc_401098
		cmp	dword ptr [ecx+84h], 0Eh
		jbe	loc_401098
		mov	edx, [ecx+0F8h]
		xor	eax, eax
		test	edx, edx
		setnz	al
		jmp	loc_401098
; ---------------------------------------------------------------------------
		align 10h

loc_401150:				; CODE XREF: sub_401060+81j
		mov	[esp+1Ch+var_1C], offset sub_441370
		call	sub_441360
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_401162:				; CODE XREF: sub_401060+C1j
		cmp	dword ptr [ecx+74h], 0Eh
		jbe	loc_401098
		mov	ecx, [ecx+0E8h]
		xor	eax, eax
		test	ecx, ecx
		setnz	al
		jmp	loc_401098
sub_401060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401180	proc near		; CODE XREF: .text:004014C5j start+15j

dwMilliseconds	= dword	ptr -88h
lpProcName	= dword	ptr -84h
Size		= dword	ptr -80h
var_6D		= byte ptr -6Dh
var_6C		= dword	ptr -6Ch
var_5C		= byte ptr -5Ch
var_30		= byte ptr -30h
var_2C		= word ptr -2Ch

		push	ebp
		xor	eax, eax
		mov	ebp, esp
		mov	ecx, 11h
		push	edi
		push	esi
		lea	edx, [ebp+var_5C]
		push	ebx
		mov	edi, edx
		sub	esp, 7Ch
		rep stosd
		mov	al, 30h
		call	sub_442140
		sub	esp, eax
		lea	eax, [esp+88h+var_6D]
		and	eax, 0FFFFFFF0h
		mov	dword ptr [eax], 0CCCCCCCCh
		mov	dword ptr [eax+4], 0CCCCCCCCh
		mov	dword ptr [eax+8], 0CCCCCCCCh
		mov	dword ptr [eax+0Ch], 0CCCCCCCCh
		mov	dword ptr [eax+10h], 0CCCCCCCCh
		mov	dword ptr [eax+14h], 0CCCCCCCCh
		mov	dword ptr [eax+18h], 0CCCCCCCCh
		mov	dword ptr [eax+1Ch], 0CCCCCCCCh
		and	esp, 0FFFFFFF0h
		mov	eax, ds:dword_451970
		test	eax, eax
		jnz	loc_401473

loc_4011EE:				; CODE XREF: sub_401180+2FFj
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_401214
; ---------------------------------------------------------------------------
		align 10h

loc_401200:				; CODE XREF: sub_401180+B1j
		cmp	eax, ebx
		jz	loc_401420
		mov	[esp+88h+dwMilliseconds], 3E8h ; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_401214:				; CODE XREF: sub_401180+7Dj
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], ebx
		mov	[esp+88h+dwMilliseconds], offset dword_451DA8
		call	sub_442450
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_401200
		mov	eax, ds:dword_451DAC
		xor	ebx, ebx
		cmp	eax, 1
		jz	loc_401433

loc_401243:				; CODE XREF: sub_401180+2ADj
		mov	eax, ds:dword_451DAC
		test	eax, eax
		jz	loc_401484
		mov	ds:dword_451000, 1

loc_40125A:				; CODE XREF: sub_401180+322j
		mov	eax, ds:dword_451DAC
		cmp	eax, 1
		jz	loc_401450

loc_401268:				; CODE XREF: sub_401180+2C7j
					; sub_401180+2EEj
		test	ebx, ebx
		jnz	short loc_401273
		lock xchg ebx, ds:dword_451DA8

loc_401273:				; CODE XREF: sub_401180+EAj
		mov	eax, ds:off_44FCFC
		test	eax, eax
		jz	short loc_401298
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], 2
		mov	[esp+88h+dwMilliseconds], 0
		call	eax ; TlsCallback_0
		sub	esp, 0Ch

loc_401298:				; CODE XREF: sub_401180+FAj
		call	sub_441680
		mov	[esp+88h+dwMilliseconds], offset TopLevelExceptionFilter ; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	ds:dword_451978, eax
		call	sub_441C30
		mov	[esp+88h+lpProcName], offset ProcName ;	"_set_invalid_parameter_handler"
		mov	[esp+88h+dwMilliseconds], eax ;	hModule
		call	ds:GetProcAddress
		sub	esp, 8
		test	eax, eax
		jz	short loc_4012D8
		mov	[esp+88h+dwMilliseconds], offset nullsub_1
		call	eax

loc_4012D8:				; CODE XREF: sub_401180+14Dj
		call	sub_441CF0
		mov	eax, ds:dword_451970
		test	eax, eax
		jz	short loc_401344
		mov	eax, ds:_acmdln
		xor	ecx, ecx
		mov	eax, [eax]
		jmp	short loc_4012FC
; ---------------------------------------------------------------------------

loc_4012F1:				; CODE XREF: sub_401180+182j
		test	dl, dl
		jz	short loc_401320
		test	cl, cl
		jz	short loc_401315

loc_4012F9:				; CODE XREF: sub_401180+18Fj
		add	eax, 1

loc_4012FC:				; CODE XREF: sub_401180+16Fj
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_4012F1
		mov	ebx, ecx
		xor	ebx, 1
		cmp	dl, 22h
		cmovz	ecx, ebx
		jmp	short loc_4012F9
; ---------------------------------------------------------------------------

loc_401311:				; CODE XREF: sub_401180+19Ej
		test	dl, dl
		jz	short loc_401320

loc_401315:				; CODE XREF: sub_401180+177j
		add	eax, 1
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_401311

loc_401320:				; CODE XREF: sub_401180+173j
					; sub_401180+193j
		movzx	edx, [ebp+var_2C]
		test	[ebp+var_30], 1
		mov	ds:dword_451D04, eax
		mov	eax, 0Ah
		mov	ds:dword_451D0C, 400000h
		cmovnz	eax, edx
		mov	ds:dword_451D08, eax

loc_401344:				; CODE XREF: sub_401180+164j
		mov	edx, ds:dword_451004
		xor	ebx, ebx
		lea	eax, ds:4[edx*4]
		mov	[ebp+var_6C], edx
		mov	[esp+88h+dwMilliseconds], eax ;	Size
		call	malloc
		mov	edi, ds:dword_451008
		mov	[ebp-70h], eax
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jle	short loc_4013AA
		xchg	ax, ax

loc_401370:				; CODE XREF: sub_401180+225j
		mov	eax, [edi+ebx*4]
		mov	[esp+88h+dwMilliseconds], eax ;	Str
		call	strlen
		lea	esi, [eax+1]
		mov	[esp+88h+dwMilliseconds], esi ;	Size
		call	malloc
		mov	edx, [ebp-70h]
		mov	[edx+ebx*4], eax
		mov	edx, [edi+ebx*4]
		add	ebx, 1
		mov	[esp+88h+Size],	esi ; Size
		mov	[esp+88h+dwMilliseconds], eax ;	Dst
		mov	[esp+88h+lpProcName], edx ; Src
		call	memcpy
		cmp	ebx, [ebp+var_6C]
		jnz	short loc_401370
		shl	ebx, 2

loc_4013AA:				; CODE XREF: sub_401180+1ECj
		mov	eax, [ebp-70h]
		mov	dword ptr [eax+ebx], 0
		mov	ds:dword_451008, eax
		call	sub_441D80
		mov	eax, ds:__initenv
		mov	edx, ds:dword_45100C
		mov	[eax], edx
		mov	eax, ds:dword_45100C
		mov	[esp+88h+Size],	eax
		mov	eax, ds:dword_451008
		mov	[esp+88h+lpProcName], eax
		mov	eax, ds:dword_451004
		mov	[esp+88h+dwMilliseconds], eax
		call	sub_401C11
		mov	esi, ds:dword_451014
		test	esi, esi
		mov	ds:dword_451010, eax
		jz	loc_4014A7
		mov	ebx, ds:dword_451000
		test	ebx, ebx
		jnz	short loc_401411
		call	_cexit
		mov	eax, ds:dword_451010

loc_401411:				; CODE XREF: sub_401180+285j
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_401420:				; CODE XREF: sub_401180+82j
		mov	eax, ds:dword_451DAC
		mov	ebx, 1
		cmp	eax, 1
		jnz	loc_401243

loc_401433:				; CODE XREF: sub_401180+BDj
		mov	[esp+88h+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, ds:dword_451DAC
		cmp	eax, 1
		jnz	loc_401268
		lea	esi, [esi+0]

loc_401450:				; CODE XREF: sub_401180+E2j
		mov	[esp+88h+lpProcName], offset dword_455008
		mov	[esp+88h+dwMilliseconds], offset dword_455000
		call	_initterm
		mov	ds:dword_451DAC, 2
		jmp	loc_401268
; ---------------------------------------------------------------------------

loc_401473:				; CODE XREF: sub_401180+68j
		mov	[esp+88h+dwMilliseconds], edx ;	lpStartupInfo
		call	ds:GetStartupInfoA
		sub	esp, 4
		jmp	loc_4011EE
; ---------------------------------------------------------------------------

loc_401484:				; CODE XREF: sub_401180+CAj
		mov	ds:dword_451DAC, 1
		mov	[esp+88h+lpProcName], offset dword_455018
		mov	[esp+88h+dwMilliseconds], offset dword_45500C
		call	_initterm
		jmp	loc_40125A
; ---------------------------------------------------------------------------

loc_4014A7:				; CODE XREF: sub_401180+277j
		mov	[esp+88h+dwMilliseconds], eax ;	Code
		call	exit
sub_401180	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		mov	ds:dword_451970, 1
		call	sub_441DA0
		add	esp, 0Ch
		jmp	sub_401180
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public start
start		proc near
		sub	esp, 0Ch
		mov	ds:dword_451970, 0
		call	sub_441DA0
		add	esp, 0Ch
		jmp	sub_401180
start		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4014F0	proc near		; CODE XREF: sub_4431B0+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_444C64
		test	eax, eax
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj-12.dll"
		call	ds:GetModuleHandleA
		mov	edx, 0
		sub	esp, 4
		test	eax, eax
		jz	short loc_40152E
		mov	[esp+18h+lpProcName], offset a_jv_registercl ; "_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	eax ; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		mov	edx, eax

loc_40152E:				; CODE XREF: sub_4014F0+26j
		test	edx, edx
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset dword_444C64
		call	edx

locret_40153B:				; CODE XREF: sub_4014F0+Dj
					; sub_4014F0+40j
		leave
		retn
sub_4014F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401540()
sub_401540	proc near		; DATA XREF: sub_4431B0+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401540	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401550	proc near		; CODE XREF: sub_401577+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_401570
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_401575
; ---------------------------------------------------------------------------

loc_401570:				; CODE XREF: sub_401550+7j
		mov	eax, 0

loc_401575:				; CODE XREF: sub_401550+1Ej
		pop	ebp
		retn
sub_401550	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401577	proc near		; CODE XREF: sub_401592+Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 6
		call	sub_401550
		leave
		retn
sub_401577	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401592	proc near		; CODE XREF: sub_402D72+1F7p
					; sub_402D72+25Cp

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_401577
		leave
		retn
sub_401592	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	pth_usleep
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp+14h]
		mov	[esp+8], edx
		mov	edx, [ebp+10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	pth_read
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp+14h]
		mov	[esp+8], edx
		mov	edx, [ebp+10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	pth_write
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp], 28h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp], 28h
		call	gpg_err_set_errno
		mov	eax, 0FFFFFFFFh
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_401655
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp+18h]
		mov	[esp+8], edx
		mov	edx, [ebp+14h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	pth_waitpid
		jmp	short locret_40165A
; ---------------------------------------------------------------------------

loc_401655:				; CODE XREF: .text:00401638j
		mov	eax, 0

locret_40165A:				; CODE XREF: .text:00401653j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40165C	proc near		; CODE XREF: sub_401723+6Fp
					; sub_401723+9Bp

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, dword_444210
		test	eax, eax
		jz	short loc_401693
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+Source], 0
		mov	[esp+38h+Dest],	18h
		call	gcry_control
		mov	dword_444210, 0

loc_401693:				; CODE XREF: sub_40165C+Fj
		mov	[esp+38h+Dest],	0
		mov	eax, [ebp+arg_4]
		call	eax
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 2
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dest],	eax
		call	sub_43A1E9
		mov	word ptr [eax],	20h
		lea	edx, [eax+1]
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Source], eax ;	Source
		mov	[esp+38h+Dest],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+var_10]
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40165C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401723	proc near		; DATA XREF: sub_401C11+CFo

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 29h ; switch 42 cases
		ja	loc_4017F4	; jumptable 00401740 default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_4454C4
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_401742:				; CODE XREF: sub_401723+1Dj
					; DATA XREF: .rdata:off_4454C4o
		mov	[ebp+var_C], offset aScdaemonGnupg ; jumptable 00401740	case 11
		jmp	loc_4017FB
; ---------------------------------------------------------------------------

loc_40174E:				; CODE XREF: sub_401723+1Dj
					; DATA XREF: .rdata:off_4454C4o
		mov	[ebp+var_C], offset a2_0_30 ; jumptable	00401740 case 13
		jmp	loc_4017FB
; ---------------------------------------------------------------------------

loc_40175A:				; CODE XREF: sub_401723+1Dj
					; DATA XREF: .rdata:off_4454C4o
		mov	[ebp+var_C], offset aMingw32 ; jumptable 00401740 case 17
		jmp	loc_4017FB
; ---------------------------------------------------------------------------

loc_401766:				; CODE XREF: sub_401723+1Dj
					; DATA XREF: .rdata:off_4454C4o
		mov	[esp+28h+var_28], offset aPleaseReportBu ; jumptable 00401740 case 19
		call	sub_43C238
		mov	[ebp+var_C], eax
		jmp	loc_4017FB
; ---------------------------------------------------------------------------

loc_40177A:				; CODE XREF: sub_401723+1Dj
					; DATA XREF: .rdata:off_4454C4o
		mov	eax, ds:dword_451044 ; jumptable 00401740 case 20
		test	eax, eax
		jnz	short loc_40179C
		mov	[esp+28h+var_24], offset gcry_check_version
		mov	[esp+28h+var_28], offset aLibgcrypt ; "libgcrypt"
		call	sub_40165C
		mov	ds:dword_451044, eax

loc_40179C:				; CODE XREF: sub_401723+5Ej
		mov	eax, ds:dword_451044
		mov	[ebp+var_C], eax
		jmp	short loc_4017FB
; ---------------------------------------------------------------------------

loc_4017A6:				; CODE XREF: sub_401723+1Dj
					; DATA XREF: .rdata:off_4454C4o
		mov	eax, ds:dword_451048 ; jumptable 00401740 case 21
		test	eax, eax
		jnz	short loc_4017C8
		mov	[esp+28h+var_24], offset loc_440C50
		mov	[esp+28h+var_28], offset aLibksba ; "libksba"
		call	sub_40165C
		mov	ds:dword_451048, eax

loc_4017C8:				; CODE XREF: sub_401723+8Aj
		mov	eax, ds:dword_451048
		mov	[ebp+var_C], eax
		jmp	short loc_4017FB
; ---------------------------------------------------------------------------

loc_4017D2:				; CODE XREF: sub_401723+1Dj
					; DATA XREF: .rdata:off_4454C4o
		mov	[esp+28h+var_28], offset aUsageScdaemonO ; jumptable 00401740 cases 1,40
		call	sub_43C238
		mov	[ebp+var_C], eax
		jmp	short loc_4017FB
; ---------------------------------------------------------------------------

loc_4017E3:				; CODE XREF: sub_401723+1Dj
					; DATA XREF: .rdata:off_4454C4o
		mov	[esp+28h+var_28], offset aSyntaxScdaemon ; jumptable 00401740 case 41
		call	sub_43C238
		mov	[ebp+var_C], eax
		jmp	short loc_4017FB
; ---------------------------------------------------------------------------

loc_4017F4:				; CODE XREF: sub_401723+Aj
					; sub_401723+1Dj
					; DATA XREF: ...
		mov	[ebp+var_C], 0	; jumptable 00401740 default case

loc_4017FB:				; CODE XREF: sub_401723+26j
					; sub_401723+32j ...
		mov	eax, [ebp+var_C]
		leave
		retn
sub_401723	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401800	proc near		; DATA XREF: sub_401C11:loc_402390o
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		call	pth_thread_id
		leave
		retn
sub_401800	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40180D(char *)
sub_40180D	proc near		; CODE XREF: sub_401C11+A8Fp

Str		= dword	ptr -68h
var_64		= byte ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		cmp	[ebp+arg_0], 0
		jz	short loc_401837
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_401837
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_401837
		mov	eax, 1
		jmp	short loc_40183C
; ---------------------------------------------------------------------------

loc_401837:				; CODE XREF: sub_40180D+Dj
					; sub_40180D+17j ...
		mov	eax, 0

loc_40183C:				; CODE XREF: sub_40180D+28j
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_401852
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Str], eax ; Str
		call	atoi
		jmp	short loc_401857
; ---------------------------------------------------------------------------

loc_401852:				; CODE XREF: sub_40180D+36j
		mov	eax, 0

loc_401857:				; CODE XREF: sub_40180D+43j
		mov	[ebp+var_20], eax
		cmp	[ebp+arg_0], 0
		jz	loc_4019E1
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aNone ; "none"
		mov	ecx, 5
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_401898
		cmp	[ebp+var_1C], 0
		jz	short loc_4018A7
		cmp	[ebp+var_20], 0
		jg	short loc_4018A7

loc_401898:				; CODE XREF: sub_40180D+7Dj
		mov	ds:dword_451D20, 0
		jmp	loc_4019E1
; ---------------------------------------------------------------------------

loc_4018A7:				; CODE XREF: sub_40180D+83j
					; sub_40180D+89j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aBasic ; "basic"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_4018DB
		cmp	[ebp+var_1C], 0
		jz	short loc_4018EA
		cmp	[ebp+var_20], 2
		jg	short loc_4018EA

loc_4018DB:				; CODE XREF: sub_40180D+C0j
		mov	ds:dword_451D20, 400h
		jmp	loc_4019E1
; ---------------------------------------------------------------------------

loc_4018EA:				; CODE XREF: sub_40180D+C6j
					; sub_40180D+CCj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aAdvanced ;	"advanced"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_40191E
		cmp	[ebp+var_1C], 0
		jz	short loc_40192D
		cmp	[ebp+var_20], 5
		jg	short loc_40192D

loc_40191E:				; CODE XREF: sub_40180D+103j
		mov	ds:dword_451D20, 401h
		jmp	loc_4019E1
; ---------------------------------------------------------------------------

loc_40192D:				; CODE XREF: sub_40180D+109j
					; sub_40180D+10Fj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aExpert ; "expert"
		mov	ecx, 7
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_401961
		cmp	[ebp+var_1C], 0
		jz	short loc_40196D
		cmp	[ebp+var_20], 8
		jg	short loc_40196D

loc_401961:				; CODE XREF: sub_40180D+146j
		mov	ds:dword_451D20, 0C41h
		jmp	short loc_4019E1
; ---------------------------------------------------------------------------

loc_40196D:				; CODE XREF: sub_40180D+14Cj
					; sub_40180D+152j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aGuru ; "guru"
		mov	ecx, 5
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_40199B
		cmp	[ebp+var_1C], 0
		jz	short loc_4019BA

loc_40199B:				; CODE XREF: sub_40180D+186j
		mov	ds:dword_451D20, 0FFFFFFFFh
		cmp	[ebp+var_1C], 0
		jz	short loc_4019E1
		mov	eax, ds:dword_451D20
		and	ah, 0FDh
		mov	ds:dword_451D20, eax
		jmp	short loc_4019E1
; ---------------------------------------------------------------------------

loc_4019BA:				; CODE XREF: sub_40180D+18Cj
		mov	[esp+68h+Str], offset aInvalidDebugLe ;	"invalid debug-level `%s' given\n"
		call	sub_43C238
		mov	edx, [ebp+arg_0]
		mov	dword ptr [esp+68h+var_64], edx	; char
		mov	[esp+68h+Str], eax ; char *
		call	sub_43CB21
		mov	[esp+68h+Str], 2
		call	sub_402B62
; ---------------------------------------------------------------------------

loc_4019E1:				; CODE XREF: sub_40180D+51j
					; sub_40180D+95j ...
		mov	eax, ds:dword_451D20
		test	eax, eax
		jz	short loc_4019FD
		mov	eax, ds:dword_451D24
		test	eax, eax
		jnz	short loc_4019FD
		mov	ds:dword_451D24, 1

loc_4019FD:				; CODE XREF: sub_40180D+1DBj
					; sub_40180D+1E4j
		mov	eax, ds:dword_451D20
		test	eax, eax
		jz	short loc_401A19
		mov	eax, ds:dword_451D28
		test	eax, eax
		jz	short loc_401A19
		mov	ds:dword_451D28, 0

loc_401A19:				; CODE XREF: sub_40180D+1F7j
					; sub_40180D+200j
		mov	eax, ds:dword_451D20
		and	eax, 2
		test	eax, eax
		jz	short loc_401A39
		mov	dword ptr [esp+68h+var_64], 2
		mov	[esp+68h+Str], 14h
		call	gcry_control

loc_401A39:				; CODE XREF: sub_40180D+216j
		mov	eax, ds:dword_451D20
		and	eax, 4
		test	eax, eax
		jz	short loc_401A59
		mov	dword ptr [esp+68h+var_64], 1
		mov	[esp+68h+Str], 14h
		call	gcry_control

loc_401A59:				; CODE XREF: sub_40180D+236j
		mov	eax, ds:dword_451D24
		mov	dword ptr [esp+68h+var_64], eax
		mov	[esp+68h+Str], 13h
		call	gcry_control
		mov	eax, ds:dword_451D20
		test	eax, eax
		jz	loc_401BA0
		mov	eax, ds:dword_451D20
		and	eax, 800h
		test	eax, eax
		jz	short loc_401A90
		mov	ebx, offset aCardio ; "	cardio"
		jmp	short loc_401A95
; ---------------------------------------------------------------------------

loc_401A90:				; CODE XREF: sub_40180D+27Aj
		mov	ebx, offset byte_4455B4

loc_401A95:				; CODE XREF: sub_40180D+281j
		mov	eax, ds:dword_451D20
		and	eax, 400h
		test	eax, eax
		jz	short loc_401AAA
		mov	esi, offset aAssuan ; "	assuan"
		jmp	short loc_401AAF
; ---------------------------------------------------------------------------

loc_401AAA:				; CODE XREF: sub_40180D+294j
		mov	esi, offset byte_4455B4

loc_401AAF:				; CODE XREF: sub_40180D+29Bj
		mov	eax, ds:dword_451D20
		and	eax, 200h
		test	eax, eax
		jz	short loc_401AC6
		mov	[ebp+var_2C], offset aHashing ;	" hashing"
		jmp	short loc_401ACD
; ---------------------------------------------------------------------------

loc_401AC6:				; CODE XREF: sub_40180D+2AEj
		mov	[ebp+var_2C], offset byte_4455B4

loc_401ACD:				; CODE XREF: sub_40180D+2B7j
		mov	eax, ds:dword_451D20
		and	eax, 80h
		test	eax, eax
		jz	short loc_401AE4
		mov	[ebp+var_30], offset aMemstat ;	" memstat"
		jmp	short loc_401AEB
; ---------------------------------------------------------------------------

loc_401AE4:				; CODE XREF: sub_40180D+2CCj
		mov	[ebp+var_30], offset byte_4455B4

loc_401AEB:				; CODE XREF: sub_40180D+2D5j
		mov	eax, ds:dword_451D20
		and	eax, 40h
		test	eax, eax
		jz	short loc_401B00
		mov	[ebp+var_34], offset aCache ; "	cache"
		jmp	short loc_401B07
; ---------------------------------------------------------------------------

loc_401B00:				; CODE XREF: sub_40180D+2E8j
		mov	[ebp+var_34], offset byte_4455B4

loc_401B07:				; CODE XREF: sub_40180D+2F1j
		mov	eax, ds:dword_451D20
		and	eax, 20h
		test	eax, eax
		jz	short loc_401B1A
		mov	edi, offset aMemory ; "	memory"
		jmp	short loc_401B1F
; ---------------------------------------------------------------------------

loc_401B1A:				; CODE XREF: sub_40180D+304j
		mov	edi, offset byte_4455B4

loc_401B1F:				; CODE XREF: sub_40180D+30Bj
		mov	eax, ds:dword_451D20
		and	eax, 4
		test	eax, eax
		jz	short loc_401B32
		mov	ecx, offset aCrypto ; "	crypto"
		jmp	short loc_401B37
; ---------------------------------------------------------------------------

loc_401B32:				; CODE XREF: sub_40180D+31Cj
		mov	ecx, offset byte_4455B4

loc_401B37:				; CODE XREF: sub_40180D+323j
		mov	eax, ds:dword_451D20
		and	eax, 2
		test	eax, eax
		jz	short loc_401B4A
		mov	edx, offset aMpi ; " mpi"
		jmp	short loc_401B4F
; ---------------------------------------------------------------------------

loc_401B4A:				; CODE XREF: sub_40180D+334j
		mov	edx, offset byte_4455B4

loc_401B4F:				; CODE XREF: sub_40180D+33Bj
		mov	eax, ds:dword_451D20
		and	eax, 1
		test	al, al
		jz	short loc_401B62
		mov	eax, offset aCommand ; " command"
		jmp	short loc_401B67
; ---------------------------------------------------------------------------

loc_401B62:				; CODE XREF: sub_40180D+34Cj
		mov	eax, offset byte_4455B4

loc_401B67:				; CODE XREF: sub_40180D+353j
		mov	[esp+68h+var_44], ebx
		mov	[esp+68h+var_48], esi
		mov	ebx, [ebp+var_2C]
		mov	[esp+68h+var_4C], ebx
		mov	esi, [ebp+var_30]
		mov	[esp+68h+var_50], esi
		mov	ebx, [ebp+var_34]
		mov	[esp+68h+var_54], ebx
		mov	[esp+68h+var_58], edi
		mov	[esp+68h+var_5C], ecx
		mov	[esp+68h+var_60], edx
		mov	dword ptr [esp+68h+var_64], eax	; char
		mov	[esp+68h+Str], offset aEnabledDebugFl ;	"enabled debug flags:%s%s%s%s%s%s%s%s%s\"...
		call	sub_43CAF7

loc_401BA0:				; CODE XREF: sub_40180D+268j
		add	esp, 5Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40180D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401BA8()
sub_401BA8	proc near		; CODE XREF: sub_401C11+A74p
					; sub_40316F:loc_4036DFp
					; DATA XREF: ...

Filename	= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:Str
		test	eax, eax
		jz	short locret_401C0F
		mov	eax, ds:Str
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short locret_401C0F
		mov	eax, ds:Str
		mov	[esp+28h+Filename], eax	; Filename
		call	remove
		mov	eax, ds:Str
		mov	[esp+28h+var_24], 2Fh ;	Ch
		mov	[esp+28h+Filename], eax	; Str
		call	strrchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_401C07
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	eax, ds:Str
		mov	[esp+28h+Filename], eax
		call	_rmdir
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	2Fh

loc_401C07:				; CODE XREF: sub_401BA8+44j
		mov	eax, ds:Str
		mov	byte ptr [eax],	0

locret_401C0F:				; CODE XREF: sub_401BA8+Dj
					; sub_401BA8+19j
		leave
		retn
sub_401BA8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401C11	proc near		; CODE XREF: sub_401180+265p

VarName		= dword	ptr -0ECh
Mode		= dword	ptr -0E8h
var_E4		= dword	ptr -0E4h
var_E0		= dword	ptr -0E0h
var_DC		= dword	ptr -0DCh
var_C0		= dword	ptr -0C0h
var_BC		= dword	ptr -0BCh
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_94		= dword	ptr -94h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
Filename	= dword	ptr -14h
File		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		and	esp, 0FFFFFFF0h
		sub	esp, 0E0h
		call	sub_441D80
		mov	[esp+0ECh+File], 0
		mov	[esp+0ECh+Filename], 0
		mov	[esp+0ECh+var_18], 0
		mov	[esp+0ECh+var_1C], 0
		mov	[esp+0ECh+var_20], 1
		mov	[esp+0ECh+var_24], 0
		mov	[esp+0ECh+var_28], 0
		mov	[esp+0ECh+var_2C], 0
		mov	[esp+0ECh+var_30], 0
		mov	[esp+0ECh+var_50], 0
		mov	[esp+0ECh+var_54], 0
		mov	[esp+0ECh+var_34], 0
		mov	[esp+0ECh+var_38], 0
		mov	[esp+0ECh+var_3C], 0
		mov	[esp+0ECh+var_40], 0
		mov	[esp+0ECh+var_44], 0
		mov	[esp+0ECh+var_58], 0
		mov	[esp+0ECh+VarName], offset sub_401723
		call	sub_43EEC6
		mov	[esp+0ECh+VarName], 1Ch
		call	gcry_control
		mov	[esp+0ECh+Mode], 5 ; int
		mov	[esp+0ECh+VarName], offset aScdaemon ; "scdaemon"
		call	sub_43C5B8
		call	sub_425774
		call	sub_4257EC
		mov	[esp+0ECh+VarName], offset a1_5_0 ; "1.5.0"
		call	gcry_check_version
		test	eax, eax
		jnz	short loc_401D5C
		mov	[esp+0ECh+VarName], 0
		call	gcry_check_version
		mov	ebx, eax
		mov	[esp+0ECh+VarName], offset aSIsTooOldNeedS ; "%s is too	old (need %s, have %s)\n"
		call	sub_43C238
		mov	[esp+0ECh+var_E0], ebx
		mov	[esp+0ECh+var_E4], offset a1_5_0 ; "1.5.0"
		mov	[esp+0ECh+Mode], offset	aLibgcrypt ; "libgcrypt"
		mov	[esp+0ECh+VarName], eax	; char *
		call	sub_43CB64
; ---------------------------------------------------------------------------

loc_401D5C:				; CODE XREF: sub_401C11+113j
		mov	[esp+0ECh+var_E4], offset gcry_free
		mov	[esp+0ECh+Mode], offset	gcry_realloc
		mov	[esp+0ECh+VarName], offset gcry_malloc
		call	ksba_set_malloc_hooks
		mov	[esp+0ECh+var_BC], offset gcry_malloc
		mov	[esp+0ECh+var_B8], offset gcry_realloc
		mov	[esp+0ECh+var_B4], offset gcry_free
		lea	eax, [esp+0ECh+var_BC]
		mov	[esp+0ECh+VarName], eax
		call	assuan_set_malloc_hooks
		mov	[esp+0ECh+VarName], 0
		call	sub_43C616
		mov	[esp+0ECh+VarName], eax
		call	assuan_set_assuan_log_prefix
		mov	[esp+0ECh+VarName], 6
		call	assuan_set_gpg_err_source
		mov	[esp+0ECh+VarName], offset dword_444220
		call	assuan_set_system_hooks
		call	assuan_sock_init
		call	sub_425985
		mov	[esp+0ECh+VarName], 16h
		call	gcry_control
		call	sub_425D39
		mov	ds:dword_451D50, 1
		mov	ds:dword_451D3C, offset	aWinscard_dll ;	"winscard.dll"
		mov	[esp+0ECh+var_58], 1
		mov	[esp+0ECh+VarName], offset VarName ; "SHELL"
		call	getenv
		mov	[esp+0ECh+var_5C], eax
		cmp	[esp+0ECh+var_5C], 0
		jz	loc_401EAC
		mov	eax, [esp+0ECh+var_5C]
		mov	[esp+0ECh+var_C0], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [esp+0ECh+var_C0]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 2
		jbe	short loc_401EAC
		mov	eax, [esp+0ECh+var_5C]
		mov	[esp+0ECh+var_C0], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [esp+0ECh+var_C0]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 3
		add	eax, [esp+0ECh+var_5C]
		mov	edx, eax
		mov	eax, offset aCsh ; "csh"
		mov	ecx, 4
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_401EAC
		mov	[esp+0ECh+var_54], 1

loc_401EAC:				; CODE XREF: sub_401C11+20Cj
					; sub_401C11+23Aj ...
		call	sub_4265F1
		mov	ds:dword_451D34, eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0ECh+var_60], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0ECh+var_64], eax
		lea	esi, [ebp+arg_0]
		mov	[esp+0ECh+var_AC], esi
		lea	eax, [ebp+arg_4]
		mov	[esp+0ECh+var_A8], eax
		mov	[esp+0ECh+var_A4], 41h
		jmp	short loc_401F46
; ---------------------------------------------------------------------------

loc_401EE2:				; CODE XREF: sub_401C11+34Bj
		mov	eax, [esp+0ECh+var_9C]
		cmp	eax, 1F8h
		jz	short loc_401EF8
		mov	eax, [esp+0ECh+var_9C]
		cmp	eax, 1F9h
		jnz	short loc_401F02

loc_401EF8:				; CODE XREF: sub_401C11+2DAj
		add	[esp+0ECh+var_18], 1
		jmp	short loc_401F46
; ---------------------------------------------------------------------------

loc_401F02:				; CODE XREF: sub_401C11+2E5j
		mov	eax, [esp+0ECh+var_9C]
		cmp	eax, 1F7h
		jnz	short loc_401F1A
		mov	[esp+0ECh+var_20], 0
		jmp	short loc_401F46
; ---------------------------------------------------------------------------

loc_401F1A:				; CODE XREF: sub_401C11+2FAj
		mov	eax, [esp+0ECh+var_9C]
		cmp	eax, 200h
		jnz	short loc_401F32
		mov	[esp+0ECh+var_20], 0
		jmp	short loc_401F46
; ---------------------------------------------------------------------------

loc_401F32:				; CODE XREF: sub_401C11+312j
		mov	eax, [esp+0ECh+var_9C]
		cmp	eax, 201h
		jnz	short loc_401F46
		mov	eax, [esp+0ECh+var_94]
		mov	ds:dword_451D34, eax

loc_401F46:				; CODE XREF: sub_401C11+2CFj
					; sub_401C11+2EFj ...
		mov	[esp+0ECh+Mode], offset	dword_444000
		lea	eax, [esp+0ECh+var_AC]
		mov	[esp+0ECh+VarName], eax
		call	sub_43DC31
		test	eax, eax
		jnz	short loc_401EE2
		mov	[esp+0ECh+var_E4], 0
		mov	[esp+0ECh+Mode], 4000h
		mov	[esp+0ECh+VarName], 18h
		call	gcry_control
		mov	dword_444210, 0
		cmp	[esp+0ECh+var_20], 0
		jz	short loc_401FB2
		mov	eax, ds:dword_451D34
		mov	[esp+0ECh+var_E4], 0
		mov	[esp+0ECh+Mode], offset	aScdaemon_conf ; "scdaemon.conf"
		mov	[esp+0ECh+VarName], eax
		call	sub_43960B
		mov	[esp+0ECh+Filename], eax

loc_401FB2:				; CODE XREF: sub_401C11+37Bj
		mov	eax, [esp+0ECh+var_60]
		mov	[ebp+arg_0], eax
		mov	eax, [esp+0ECh+var_64]
		mov	[ebp+arg_4], eax
		lea	edi, [ebp+arg_0]
		mov	[esp+0ECh+var_AC], edi
		lea	eax, [ebp+arg_4]
		mov	[esp+0ECh+var_A8], eax
		mov	[esp+0ECh+var_A4], 1

loc_401FDC:				; CODE XREF: sub_401C11+7C0j
					; sub_401C11+986j
		cmp	[esp+0ECh+Filename], 0
		jz	loc_402510
		mov	[esp+0ECh+var_B0], 0
		mov	edx, offset Mode ; "r"
		mov	eax, [esp+0ECh+Filename]
		mov	[esp+0ECh+Mode], edx ; Mode
		mov	[esp+0ECh+VarName], eax	; Filename
		call	fopen
		mov	[esp+0ECh+File], eax
		cmp	[esp+0ECh+File], 0
		jnz	loc_4020B0
		cmp	[esp+0ECh+var_20], 0
		jz	short loc_402054
		cmp	[esp+0ECh+var_18], 0
		jz	short loc_402096
		mov	[esp+0ECh+VarName], offset aNoteNoDefaultO ; "NOTE: no default option file `%s'\n"
		call	sub_43C238
		mov	edx, [esp+0ECh+Filename]
		mov	[esp+0ECh+Mode], edx ; char
		mov	[esp+0ECh+VarName], eax	; char *
		call	sub_43CAF7
		jmp	short loc_402096
; ---------------------------------------------------------------------------

loc_402054:				; CODE XREF: sub_401C11+416j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+0ECh+VarName], eax	; int
		call	strerror
		mov	ebx, eax
		mov	[esp+0ECh+VarName], offset aOptionFileSS ; "option file	`%s': %s\n"
		call	sub_43C238
		mov	[esp+0ECh+var_E4], ebx
		mov	edx, [esp+0ECh+Filename]
		mov	[esp+0ECh+Mode], edx ; char
		mov	[esp+0ECh+VarName], eax	; char *
		call	sub_43CB21
		mov	[esp+0ECh+VarName], 2 ;	Code
		call	exit
; ---------------------------------------------------------------------------

loc_402096:				; CODE XREF: sub_401C11+420j
					; sub_401C11+441j
		mov	eax, [esp+0ECh+Filename]
		mov	[esp+0ECh+VarName], eax
		call	gcry_free
		mov	[esp+0ECh+Filename], 0

loc_4020B0:				; CODE XREF: sub_401C11+408j
		cmp	[esp+0ECh+var_18], 0
		jz	short loc_4020E3
		cmp	[esp+0ECh+Filename], 0
		jz	short loc_4020E3
		mov	[esp+0ECh+VarName], offset aReadingOptions ; "reading options from `%s'\n"
		call	sub_43C238
		mov	edx, [esp+0ECh+Filename]
		mov	[esp+0ECh+Mode], edx ; char
		mov	[esp+0ECh+VarName], eax	; char *
		call	sub_43CAF7

loc_4020E3:				; CODE XREF: sub_401C11+4A7j
					; sub_401C11+4B1j
		mov	[esp+0ECh+var_20], 0
		jmp	loc_402510
; ---------------------------------------------------------------------------

loc_4020F3:				; CODE XREF: sub_401C11+943j
		mov	eax, [esp+0ECh+var_9C]
		cmp	eax, 201h
		jz	loc_4023F5
		cmp	eax, 201h
		jg	loc_4021E8
		cmp	eax, 1F8h
		jz	loc_402327
		cmp	eax, 1F8h
		jg	short loc_40218A
		cmp	eax, 76h
		jz	loc_402306
		cmp	eax, 76h
		jg	short loc_40214D
		cmp	eax, 71h
		jz	loc_4022F7
		cmp	eax, 73h
		jz	loc_402433
		cmp	eax, 63h
		jz	loc_402423
		jmp	loc_4024F4
; ---------------------------------------------------------------------------

loc_40214D:				; CODE XREF: sub_401C11+51Aj
		cmp	eax, 1F5h
		jz	loc_4022D7
		cmp	eax, 1F5h
		jg	short loc_40216F
		cmp	eax, 1F4h
		jz	loc_4023E6
		jmp	loc_4024F4
; ---------------------------------------------------------------------------

loc_40216F:				; CODE XREF: sub_401C11+54Cj
		cmp	eax, 1F6h
		jz	loc_4022E7
		cmp	eax, 1F7h
		jz	loc_4023A1
		jmp	loc_4024F4
; ---------------------------------------------------------------------------

loc_40218A:				; CODE XREF: sub_401C11+50Cj
		cmp	eax, 1FCh
		jz	loc_40236C
		cmp	eax, 1FCh
		jg	short loc_4021B7
		cmp	eax, 1FAh
		jz	loc_40234C
		cmp	eax, 1FAh
		jg	loc_40235C
		jmp	loc_40233D
; ---------------------------------------------------------------------------

loc_4021B7:				; CODE XREF: sub_401C11+589j
		cmp	eax, 1FEh
		jz	loc_402390
		cmp	eax, 1FEh
		jl	loc_402513
		cmp	eax, 1FFh
		jz	loc_4023D6
		cmp	eax, 200h
		jz	loc_402516
		jmp	loc_4024F4
; ---------------------------------------------------------------------------

loc_4021E8:				; CODE XREF: sub_401C11+4F6j
		cmp	eax, 20Bh
		jz	loc_40248A
		cmp	eax, 20Bh
		jg	short loc_402263
		cmp	eax, 206h
		jz	loc_402452
		cmp	eax, 206h
		jg	short loc_402232
		cmp	eax, 204h
		jz	loc_402413
		cmp	eax, 204h
		jg	loc_402443
		cmp	eax, 202h
		jz	loc_402403
		jmp	loc_4024F4
; ---------------------------------------------------------------------------

loc_402232:				; CODE XREF: sub_401C11+5F9j
		cmp	eax, 208h
		jz	loc_402318
		cmp	eax, 208h
		jl	loc_40246C
		cmp	eax, 209h
		jz	loc_40247C
		cmp	eax, 20Ah
		jz	loc_4024C7
		jmp	loc_4024F4
; ---------------------------------------------------------------------------

loc_402263:				; CODE XREF: sub_401C11+5E7j
		cmp	eax, 210h
		jz	loc_402519
		cmp	eax, 210h
		jg	short loc_4022A6
		cmp	eax, 20Dh
		jz	loc_4024A3
		cmp	eax, 20Dh
		jl	loc_402498
		cmp	eax, 20Eh
		jz	loc_40251C
		cmp	eax, 20Fh
		jz	loc_4024AF
		jmp	loc_4024F4
; ---------------------------------------------------------------------------

loc_4022A6:				; CODE XREF: sub_401C11+662j
		cmp	eax, 212h
		jz	loc_4024D2
		cmp	eax, 212h
		jl	loc_4024BB
		cmp	eax, 213h
		jz	loc_4024E8
		cmp	eax, 214h
		jz	loc_402381
		jmp	loc_4024F4
; ---------------------------------------------------------------------------

loc_4022D7:				; CODE XREF: sub_401C11+541j
		mov	[esp+0ECh+var_3C], 1
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_4022E7:				; CODE XREF: sub_401C11+563j
		mov	[esp+0ECh+var_3C], 2
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_4022F7:				; CODE XREF: sub_401C11+51Fj
		mov	ds:dword_451D28, 1
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_402306:				; CODE XREF: sub_401C11+511j
		mov	eax, ds:dword_451D24
		add	eax, 1
		mov	ds:dword_451D24, eax
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_402318:				; CODE XREF: sub_401C11+626j
		mov	ds:dword_451D30, 1
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_402327:				; CODE XREF: sub_401C11+501j
		mov	edx, ds:dword_451D20
		mov	eax, [esp+0ECh+var_94]
		or	eax, edx
		mov	ds:dword_451D20, eax
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_40233D:				; CODE XREF: sub_401C11+5A1j
		mov	ds:dword_451D20, 0FFFFFFFFh
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_40234C:				; CODE XREF: sub_401C11+590j
		mov	eax, [esp+0ECh+var_94]
		mov	[esp+0ECh+var_1C], eax
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_40235C:				; CODE XREF: sub_401C11+59Bj
		mov	eax, [esp+0ECh+var_94]
		mov	[esp+0ECh+var_38], eax
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_40236C:				; CODE XREF: sub_401C11+57Ej
		call	sub_425D43
		mov	[esp+0ECh+var_44], 1
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_402381:				; CODE XREF: sub_401C11+6BBj
		mov	ds:dword_451040, 1
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_402390:				; CODE XREF: sub_401C11+5ABj
		mov	[esp+0ECh+VarName], offset sub_401800
		call	sub_43C5AB
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_4023A1:				; CODE XREF: sub_401C11+56Ej
		cmp	[esp+0ECh+File], 0
		jnz	loc_40251F
		mov	eax, [esp+0ECh+Filename]
		mov	[esp+0ECh+VarName], eax
		call	gcry_free
		mov	eax, [esp+0ECh+var_94]
		mov	[esp+0ECh+VarName], eax
		call	gcry_xstrdup
		mov	[esp+0ECh+Filename], eax
		jmp	loc_401FDC
; ---------------------------------------------------------------------------

loc_4023D6:				; CODE XREF: sub_401C11+5C1j
		mov	[esp+0ECh+var_28], 1
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_4023E6:				; CODE XREF: sub_401C11+553j
		mov	ds:dword_451D24, 0
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_4023F5:				; CODE XREF: sub_401C11+4EBj
		mov	eax, [esp+0ECh+var_94]
		mov	ds:dword_451D34, eax
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_402403:				; CODE XREF: sub_401C11+616j
		mov	[esp+0ECh+var_50], 1
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_402413:				; CODE XREF: sub_401C11+600j
		mov	eax, [esp+0ECh+var_94]
		mov	[esp+0ECh+var_34], eax
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_402423:				; CODE XREF: sub_401C11+531j
		mov	[esp+0ECh+var_54], 1
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_402433:				; CODE XREF: sub_401C11+528j
		mov	[esp+0ECh+var_54], 0
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_402443:				; CODE XREF: sub_401C11+60Bj
		mov	ds:dword_451024, 1
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_402452:				; CODE XREF: sub_401C11+5EEj
		mov	ds:dword_451024, 1
		mov	[esp+0ECh+var_2C], 1
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_40246C:				; CODE XREF: sub_401C11+631j
		mov	[esp+0ECh+var_30], 1
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_40247C:				; CODE XREF: sub_401C11+63Cj
		mov	eax, [esp+0ECh+var_94]
		mov	ds:dword_451D40, eax
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_40248A:				; CODE XREF: sub_401C11+5DCj
		mov	eax, [esp+0ECh+var_94]
		mov	ds:dword_451D38, eax
		jmp	loc_402520
; ---------------------------------------------------------------------------

loc_402498:				; CODE XREF: sub_401C11+674j
		mov	eax, [esp+0ECh+var_94]
		mov	ds:dword_451D3C, eax
		jmp	short loc_402520
; ---------------------------------------------------------------------------

loc_4024A3:				; CODE XREF: sub_401C11+669j
		mov	ds:dword_451D44, 1
		jmp	short loc_402520
; ---------------------------------------------------------------------------

loc_4024AF:				; CODE XREF: sub_401C11+68Aj
		mov	ds:dword_451D48, 1
		jmp	short loc_402520
; ---------------------------------------------------------------------------

loc_4024BB:				; CODE XREF: sub_401C11+6A5j
		mov	ds:dword_451D50, 0
		jmp	short loc_402520
; ---------------------------------------------------------------------------

loc_4024C7:				; CODE XREF: sub_401C11+647j
		mov	eax, [esp+0ECh+var_94]
		mov	ds:dword_451D58, eax
		jmp	short loc_402520
; ---------------------------------------------------------------------------

loc_4024D2:				; CODE XREF: sub_401C11+69Aj
		mov	eax, [esp+0ECh+var_94]
		mov	[esp+0ECh+Mode], eax ; char *
		mov	[esp+0ECh+VarName], offset dword_451D54	; int
		call	sub_43EEFD
		jmp	short loc_402520
; ---------------------------------------------------------------------------

loc_4024E8:				; CODE XREF: sub_401C11+6B0j
		mov	ds:dword_451D4C, 1
		jmp	short loc_402520
; ---------------------------------------------------------------------------

loc_4024F4:				; CODE XREF: sub_401C11+537j
					; sub_401C11+559j ...
		cmp	[esp+0ECh+File], 0
		jz	short loc_402505
		mov	eax, 1
		jmp	short loc_40250A
; ---------------------------------------------------------------------------

loc_402505:				; CODE XREF: sub_401C11+8EBj
		mov	eax, 2

loc_40250A:				; CODE XREF: sub_401C11+8F2j
		mov	[esp+0ECh+var_A0], eax
		jmp	short loc_402520
; ---------------------------------------------------------------------------

loc_402510:				; CODE XREF: sub_401C11+3D3j
					; sub_401C11+4DDj
		nop
		jmp	short loc_402520
; ---------------------------------------------------------------------------

loc_402513:				; CODE XREF: sub_401C11+5B6j
		nop
		jmp	short loc_402520
; ---------------------------------------------------------------------------

loc_402516:				; CODE XREF: sub_401C11+5CCj
		nop
		jmp	short loc_402520
; ---------------------------------------------------------------------------

loc_402519:				; CODE XREF: sub_401C11+657j
		nop
		jmp	short loc_402520
; ---------------------------------------------------------------------------

loc_40251C:				; CODE XREF: sub_401C11+67Fj
		nop
		jmp	short loc_402520
; ---------------------------------------------------------------------------

loc_40251F:				; CODE XREF: sub_401C11+798j
		nop

loc_402520:				; CODE XREF: sub_401C11+6D1j
					; sub_401C11+6E1j ...
		mov	[esp+0ECh+var_DC], offset dword_444000 ; int
		lea	eax, [esp+0ECh+var_AC]
		mov	[esp+0ECh+var_E0], eax ; int
		lea	eax, [esp+0ECh+var_B0]
		mov	[esp+0ECh+var_E4], eax ; int
		mov	eax, [esp+0ECh+Filename]
		mov	[esp+0ECh+Mode], eax ; int
		mov	eax, [esp+0ECh+File]
		mov	[esp+0ECh+VarName], eax	; FILE *
		call	sub_43D24E
		test	eax, eax
		jnz	loc_4020F3
		cmp	[esp+0ECh+File], 0
		jz	short loc_40259C
		mov	eax, [esp+0ECh+File]
		mov	[esp+0ECh+VarName], eax	; File
		call	fclose
		mov	[esp+0ECh+File], 0
		mov	eax, [esp+0ECh+Filename]
		mov	[esp+0ECh+var_40], eax
		mov	[esp+0ECh+Filename], 0
		jmp	loc_401FDC
; ---------------------------------------------------------------------------

loc_40259C:				; CODE XREF: sub_401C11+951j
		mov	eax, [esp+0ECh+Filename]
		mov	[esp+0ECh+VarName], eax
		call	gcry_free
		mov	[esp+0ECh+Filename], 0
		mov	[esp+0ECh+VarName], 0
		call	sub_43C2D4
		test	eax, eax
		jz	short loc_4025D2
		mov	[esp+0ECh+VarName], 2 ;	Code
		call	exit
; ---------------------------------------------------------------------------

loc_4025D2:				; CODE XREF: sub_401C11+9B3j
		cmp	[esp+0ECh+var_28], 0
		jz	short loc_4025E7
		mov	[esp+0ECh+var_24], 0

loc_4025E7:				; CODE XREF: sub_401C11+9C9j
		cmp	[esp+0ECh+var_24], 0
		jz	short loc_402669
		mov	[esp+0ECh+VarName], 0Eh
		call	sub_43EE3D
		mov	esi, eax
		mov	[esp+0ECh+VarName], 0Dh
		call	sub_43EE3D
		mov	ebx, eax
		mov	[esp+0ECh+VarName], 0Bh
		call	sub_43EE3D
		mov	edx, offset Format ; "%s %s; %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+0ECh+var_DC], esi
		mov	[esp+0ECh+var_E0], ebx
		mov	[esp+0ECh+var_E4], eax
		mov	[esp+0ECh+Mode], edx ; Format
		mov	[esp+0ECh+VarName], ecx	; File
		call	fprintf
		mov	[esp+0ECh+VarName], 0Fh
		call	sub_43EE3D
		mov	edx, offset aS	; "%s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+0ECh+var_E4], eax
		mov	[esp+0ECh+Mode], edx ; char
		mov	[esp+0ECh+VarName], ecx	; File
		call	fprintf

loc_402669:				; CODE XREF: sub_401C11+9DEj
		mov	[esp+0ECh+VarName], offset sub_401BA8 ;	_onexit_t
		call	sub_441160
		test	eax, eax
		jz	short loc_402696
		mov	[esp+0ECh+VarName], offset aAtexitFailed ; "atexit failed\n"
		call	sub_43CB21
		call	sub_401BA8
		mov	[esp+0ECh+VarName], 1 ;	Code
		call	exit
; ---------------------------------------------------------------------------

loc_402696:				; CODE XREF: sub_401C11+A66j
		mov	eax, [esp+0ECh+var_1C]
		mov	[esp+0ECh+VarName], eax	; char *
		call	sub_40180D
		call	sub_403795
		cmp	[esp+0ECh+var_3C], 2
		jnz	short loc_4026C0
		mov	[esp+0ECh+VarName], 0
		call	sub_402B62
; ---------------------------------------------------------------------------

loc_4026C0:				; CODE XREF: sub_401C11+AA1j
		cmp	[esp+0ECh+var_3C], 0
		jz	loc_402857
		mov	[esp+0ECh+var_48], 0
		cmp	[esp+0ECh+var_40], 0
		jz	short loc_4026FB
		mov	eax, [esp+0ECh+var_40]
		mov	[esp+0ECh+VarName], eax
		call	gcry_xstrdup
		mov	[esp+0ECh+var_48], eax
		jmp	short loc_40271F
; ---------------------------------------------------------------------------

loc_4026FB:				; CODE XREF: sub_401C11+AD0j
		mov	eax, ds:dword_451D34
		mov	[esp+0ECh+var_E4], 0
		mov	[esp+0ECh+Mode], offset	aScdaemon_conf ; "scdaemon.conf"
		mov	[esp+0ECh+VarName], eax
		call	sub_43960B
		mov	[esp+0ECh+var_48], eax

loc_40271F:				; CODE XREF: sub_401C11+AE8j
		mov	[esp+0ECh+Mode], 0 ; char *
		mov	eax, [esp+0ECh+var_48]
		mov	[esp+0ECh+VarName], eax	; int
		call	sub_43A532
		mov	[esp+0ECh+var_68], eax
		mov	eax, offset aGpgconfScdaemo ; "gpgconf-scdaemon.conf:%lu:\"%s\n"
		mov	edx, [esp+0ECh+var_68]
		mov	[esp+0ECh+var_E4], edx
		mov	[esp+0ECh+Mode], 10h
		mov	[esp+0ECh+VarName], eax	; Format
		call	printf
		mov	eax, [esp+0ECh+var_68]
		mov	[esp+0ECh+VarName], eax
		call	gcry_free
		mov	eax, [esp+0ECh+var_48]
		mov	[esp+0ECh+VarName], eax
		call	gcry_free
		mov	eax, offset aVerboseLuQuiet ; "verbose:%lu:\nquiet:%lu:\ndebug-level:%"...
		mov	[esp+0ECh+var_DC], 0
		mov	[esp+0ECh+var_E0], 10h
		mov	[esp+0ECh+var_E4], 0
		mov	[esp+0ECh+Mode], 0
		mov	[esp+0ECh+VarName], eax	; Format
		call	printf
		mov	eax, offset aReaderPortLu ; "reader-port:%lu:\n"
		mov	[esp+0ECh+Mode], 0
		mov	[esp+0ECh+VarName], eax	; Format
		call	printf
		mov	eax, offset aCtapiDriverLu ; "ctapi-driver:%lu:\n"
		mov	[esp+0ECh+Mode], 0
		mov	[esp+0ECh+VarName], eax	; Format
		call	printf
		mov	eax, offset aPcscDriverLuS ; "pcsc-driver:%lu:\"%s:\n"
		mov	[esp+0ECh+var_E4], offset aWinscard_dll	; "winscard.dll"
		mov	[esp+0ECh+Mode], 10h
		mov	[esp+0ECh+VarName], eax	; Format
		call	printf
		mov	eax, offset aDenyAdminLu ; "deny-admin:%lu:\n"
		mov	[esp+0ECh+Mode], 0
		mov	[esp+0ECh+VarName], eax	; Format
		call	printf
		mov	eax, offset aDisablePinpadL ; "disable-pinpad:%lu:\n"
		mov	[esp+0ECh+Mode], 0
		mov	[esp+0ECh+VarName], eax	; Format
		call	printf
		mov	eax, offset aCardTimeoutLuD ; "card-timeout:%lu:%d:\n"
		mov	[esp+0ECh+var_E4], 0
		mov	[esp+0ECh+Mode], 10h
		mov	[esp+0ECh+VarName], eax	; Format
		call	printf
		mov	eax, offset aEnablePinpadVa ; "enable-pinpad-varlen:%lu:\n"
		mov	[esp+0ECh+Mode], 0
		mov	[esp+0ECh+VarName], eax	; Format
		call	printf
		mov	[esp+0ECh+VarName], 0
		call	sub_402B62
; ---------------------------------------------------------------------------

loc_402857:				; CODE XREF: sub_401C11+AB7j
		cmp	[esp+0ECh+var_34], 0
		jz	short loc_402884
		mov	eax, [esp+0ECh+var_34]
		mov	[esp+0ECh+VarName], eax	; char *
		call	sub_43C568
		mov	[esp+0ECh+Mode], 7 ; int
		mov	[esp+0ECh+VarName], 0 ;	char *
		call	sub_43C5B8

loc_402884:				; CODE XREF: sub_401C11+C4Ej
		cmp	[esp+0ECh+var_38], 0
		jz	short loc_4028C7
		mov	eax, ds:dword_451024
		test	eax, eax
		jz	short loc_4028C7
		call	_getpid
		mov	[esp+0ECh+Mode], eax ; char
		mov	[esp+0ECh+VarName], offset aWaitingForDebu ; "waiting for debugger - my	pid is %u ..."...
		call	sub_43CBBE
		mov	eax, [esp+0ECh+var_38]
		mov	[esp+0ECh+VarName], eax
		call	sub_425DB1
		mov	[esp+0ECh+VarName], offset a___Okay ; "... okay\n"
		call	sub_43CBBE

loc_4028C7:				; CODE XREF: sub_401C11+C7Bj
					; sub_401C11+C84j
		mov	eax, ds:dword_451024
		test	eax, eax
		jz	loc_402AC9
		mov	[esp+0ECh+var_4C], 0FFFFFFFFh
		cmp	[esp+0ECh+var_44], 0
		jz	short loc_402928
		mov	[esp+0ECh+VarName], offset aTmp	; "/tmp"
		call	_chdir
		test	eax, eax
		jz	short loc_40291C
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+0ECh+VarName], eax	; int
		call	strerror
		mov	[esp+0ECh+Mode], eax ; char
		mov	[esp+0ECh+VarName], offset aChdirToTmpFail ; "chdir to `/tmp' failed: %s\n"
		call	sub_43CBBE
		jmp	short loc_402928
; ---------------------------------------------------------------------------

loc_40291C:				; CODE XREF: sub_401C11+CE6j
		mov	[esp+0ECh+VarName], offset aChangedWorking ; "changed working directory	to `/tmp'\n"
		call	sub_43CBBE

loc_402928:				; CODE XREF: sub_401C11+CD6j
					; sub_401C11+D09j
		cmp	[esp+0ECh+var_2C], 0
		jz	short loc_40297D
		mov	[esp+0ECh+var_E4], offset aTmpGpgXxxxxxS_ ; "/tmp/gpg-XXXXXX/S.scdaemon"
		mov	[esp+0ECh+Mode], offset	aS_scdaemon ; "S.scdaemon"
		mov	eax, [esp+0ECh+var_58]
		mov	[esp+0ECh+VarName], eax
		call	sub_402C19
		mov	ds:Str,	eax
		mov	eax, ds:Str
		mov	[esp+0ECh+var_E4], offset dword_45102C ; int
		mov	[esp+0ECh+Mode], eax ; Filename
		mov	eax, [esp+0ECh+var_58]
		mov	[esp+0ECh+VarName], eax	; int
		call	sub_402D72
		mov	[esp+0ECh+var_4C], eax

loc_40297D:				; CODE XREF: sub_401C11+D1Fj
		call	pth_attr_new
		mov	[esp+0ECh+var_6C], eax
		mov	[esp+0ECh+var_E4], 0
		mov	[esp+0ECh+Mode], 2
		mov	eax, [esp+0ECh+var_6C]
		mov	[esp+0ECh+VarName], eax
		call	pth_attr_set
		mov	[esp+0ECh+var_E4], 80000h
		mov	[esp+0ECh+Mode], 4
		mov	eax, [esp+0ECh+var_6C]
		mov	[esp+0ECh+VarName], eax
		call	pth_attr_set
		mov	[esp+0ECh+var_E4], offset aPipeConnection ; "pipe-connection"
		mov	[esp+0ECh+Mode], 1
		mov	eax, [esp+0ECh+var_6C]
		mov	[esp+0ECh+VarName], eax
		call	pth_attr_set
		mov	[esp+0ECh+Mode], 18h
		mov	[esp+0ECh+VarName], 1
		call	gcry_calloc
		mov	[esp+0ECh+var_70], eax
		cmp	[esp+0ECh+var_70], 0
		jnz	short loc_402A32
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+0ECh+VarName], eax	; int
		call	strerror
		mov	[esp+0ECh+Mode], eax ; char
		mov	[esp+0ECh+VarName], offset aErrorAllocatin ; "error allocating connection control dat"...
		call	sub_43CB21
		mov	[esp+0ECh+VarName], 2
		call	sub_402B62
; ---------------------------------------------------------------------------

loc_402A32:				; CODE XREF: sub_401C11+DF2j
		mov	eax, [esp+0ECh+var_70]
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	eax, [esp+0ECh+var_70]
		mov	[esp+0ECh+var_E4], eax
		mov	[esp+0ECh+Mode], offset	sub_40303E
		mov	eax, [esp+0ECh+var_6C]
		mov	[esp+0ECh+VarName], eax
		call	pth_spawn
		test	eax, eax
		jnz	short loc_402A98
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+0ECh+VarName], eax	; int
		call	strerror
		mov	[esp+0ECh+Mode], eax ; char
		mov	[esp+0ECh+VarName], offset aErrorSpawningP ; "error spawning pipe connection handler:"...
		call	sub_43CB21
		mov	eax, [esp+0ECh+var_70]
		mov	[esp+0ECh+VarName], eax
		call	gcry_free
		mov	[esp+0ECh+VarName], 2
		call	sub_402B62
; ---------------------------------------------------------------------------

loc_402A98:				; CODE XREF: sub_401C11+E4Cj
		mov	eax, [esp+0ECh+var_4C]
		mov	[esp+0ECh+VarName], eax	; SOCKET
		call	sub_40316F
		cmp	[esp+0ECh+var_4C], 0FFFFFFFFh
		jz	loc_402B55
		mov	eax, [esp+0ECh+var_4C]
		mov	[esp+0ECh+VarName], eax
		call	_close
		jmp	loc_402B55
; ---------------------------------------------------------------------------

loc_402AC9:				; CODE XREF: sub_401C11+CBDj
		cmp	[esp+0ECh+var_30], 0
		jnz	short loc_402AE9
		mov	[esp+0ECh+VarName], offset aPleaseUseTheOp ; "please use the option `--daemon' to run"...
		call	sub_43C238
		mov	[esp+0ECh+VarName], eax	; char *
		call	sub_43CAF7
		jmp	short loc_402B55
; ---------------------------------------------------------------------------

loc_402AE9:				; CODE XREF: sub_401C11+EC0j
		mov	[esp+0ECh+var_E4], offset aTmpGpgXxxxxxS_ ; "/tmp/gpg-XXXXXX/S.scdaemon"
		mov	[esp+0ECh+Mode], offset	aS_scdaemon ; "S.scdaemon"
		mov	eax, [esp+0ECh+var_58]
		mov	[esp+0ECh+VarName], eax
		call	sub_402C19
		mov	ds:Str,	eax
		mov	eax, ds:Str
		mov	[esp+0ECh+var_E4], offset dword_45102C ; int
		mov	[esp+0ECh+Mode], eax ; Filename
		mov	eax, [esp+0ECh+var_58]
		mov	[esp+0ECh+VarName], eax	; int
		call	sub_402D72
		mov	[esp+0ECh+var_74], eax
		mov	[esp+0ECh+VarName], 0 ;	File
		call	fflush
		mov	eax, [esp+0ECh+var_74]
		mov	[esp+0ECh+VarName], eax	; SOCKET
		call	sub_40316F
		mov	eax, [esp+0ECh+var_74]
		mov	[esp+0ECh+VarName], eax
		call	_close

loc_402B55:				; CODE XREF: sub_401C11+E9Ej
					; sub_401C11+EB3j ...
		mov	eax, 0
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_401C11	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_402B62	proc near		; CODE XREF: sub_40180D+1CFp
					; sub_401C11+AAAp ...

Code		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_40A995
		mov	[esp+18h+Code],	19h
		call	gcry_control
		cmp	[ebp+arg_0], 0
		jnz	short loc_402B9D
		mov	[esp+18h+Code],	0
		call	sub_43C2D4
		test	eax, eax
		jz	short loc_402B96
		mov	eax, 2
		jmp	short loc_402B9B
; ---------------------------------------------------------------------------

loc_402B96:				; CODE XREF: sub_402B62+2Bj
		mov	eax, 0

loc_402B9B:				; CODE XREF: sub_402B62+32j
		jmp	short loc_402BA0
; ---------------------------------------------------------------------------

loc_402B9D:				; CODE XREF: sub_402B62+1Bj
		mov	eax, [ebp+arg_0]

loc_402BA0:				; CODE XREF: sub_402B62:loc_402B9Bj
		mov	[ebp+arg_0], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Code],	eax ; Code
		call	exit
sub_402B62	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402BAE	proc near		; CODE XREF: sub_40303E+8Fp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0FFFFFFFFh
		pop	ebp
		retn
sub_402BAE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402BBD	proc near		; CODE XREF: sub_40303E+115p
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_402BBD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402BC2	proc near		; CODE XREF: sub_406449+12Cp
		push	ebp
		mov	ebp, esp
		mov	eax, ds:Str
		test	eax, eax
		jz	short loc_402BE1
		mov	eax, ds:Str
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_402BE1
		mov	eax, ds:Str
		jmp	short loc_402BE6
; ---------------------------------------------------------------------------

loc_402BE1:				; CODE XREF: sub_402BC2+Aj
					; sub_402BC2+16j
		mov	eax, 0

loc_402BE6:				; CODE XREF: sub_402BC2+1Dj
		pop	ebp
		retn
sub_402BC2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402BE8	proc near		; CODE XREF: sub_40316F+2B0p
					; sub_40316F+347p

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aSignalDReceive ; "signal %d received - no action defined\"...
		call	sub_43CAF7
		leave
		retn
sub_402BE8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402C03	proc near		; CODE XREF: sub_40316F+2ECp
					; sub_40316F+37Bp
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, ds:dword_451040
		test	eax, eax
		jnz	short locret_402C17
		call	sub_40772E

locret_402C17:				; CODE XREF: sub_402C03+Dj
		leave
		retn
sub_402C03	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402C19	proc near		; CODE XREF: sub_401C11+D3Bp
					; sub_401C11+EF2p

Str		= dword	ptr -38h
Val		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		cmp	[ebp+arg_0], 0
		jz	short loc_402C4B
		mov	eax, ds:dword_451D34
		mov	[esp+38h+var_30], 0
		mov	edx, [ebp+arg_4]
		mov	[esp+38h+Val], edx
		mov	[esp+38h+Str], eax
		call	sub_43960B
		mov	[ebp+var_C], eax
		jmp	loc_402CEA
; ---------------------------------------------------------------------------

loc_402C4B:				; CODE XREF: sub_402C19+Cj
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+Str], eax
		call	gcry_xstrdup
		mov	[ebp+var_C], eax
		mov	[esp+38h+Val], 2Fh ; Ch
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	strrchr
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_402C91
		mov	[esp+38h+var_30], offset aCreate_socket_ ; "create_socket_name"
		mov	[esp+38h+Val], 40Ch
		mov	[esp+38h+Str], offset a____Gnupg22_0_ ;	"../../gnupg2-2.0.30/scd/scdaemon.c"
		call	sub_43CCB0
; ---------------------------------------------------------------------------

loc_402C91:				; CODE XREF: sub_402C19+5Aj
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax
		call	sub_440B1E
		test	eax, eax
		jnz	short loc_402CE4
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+38h+Str], eax ; int
		call	strerror
		mov	ebx, eax
		mov	[esp+38h+Str], offset aCanTCreateDire ;	"can't create directory `%s': %s\n"
		call	sub_43C238
		mov	[esp+38h+var_30], ebx
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Val], edx ; char
		mov	[esp+38h+Str], eax ; char *
		call	sub_43CB21
		mov	[esp+38h+Str], 2
		call	sub_402B62
; ---------------------------------------------------------------------------

loc_402CE4:				; CODE XREF: sub_402C19+8Bj
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	2Fh

loc_402CEA:				; CODE XREF: sub_402C19+2Dj
		mov	[esp+38h+Val], 3Bh ; char
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_402D21
		mov	[esp+38h+Val], offset asc_44599D ; ";"
		mov	[esp+38h+Str], offset aSAreNotAllowed ;	"`%s' are not allowed in the socket name"...
		call	sub_43CB21
		mov	[esp+38h+Str], 2
		call	sub_402B62
; ---------------------------------------------------------------------------

loc_402D21:				; CODE XREF: sub_402C19+E6j
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		cmp	eax, 65h
		jbe	short loc_402D68
		mov	[esp+38h+Str], offset aNameOfSocketTo ;	"name of socket	too long\n"
		call	sub_43C238
		mov	[esp+38h+Str], eax ; char *
		call	sub_43CB21
		mov	[esp+38h+Str], 2
		call	sub_402B62
; ---------------------------------------------------------------------------

loc_402D68:				; CODE XREF: sub_402C19+12Dj
		mov	eax, [ebp+var_C]
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_402C19	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402D72(int, char *Filename, int)
sub_402D72	proc near		; CODE XREF: sub_401C11+D60p
					; sub_401C11+F17p

Dest		= dword	ptr -48h
Source		= dword	ptr -44h
var_40		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_24		= dword	ptr -24h
s		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
Filename	= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+Source], 1
		mov	[esp+48h+Dest],	1
		call	assuan_sock_new
		mov	[ebp+s], eax
		cmp	[ebp+s], 0FFFFFFFFh
		jnz	short loc_402DD7
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+48h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	[esp+48h+Dest],	offset aCanTCreateSock ; "can't create socket: %s\n"
		call	sub_43C238
		mov	[esp+48h+Source], ebx ;	char
		mov	[esp+48h+Dest],	eax ; char *
		call	sub_43CB21
		mov	[esp+48h+Dest],	2
		call	sub_402B62
; ---------------------------------------------------------------------------

loc_402DD7:				; CODE XREF: sub_402D72+2Cj
		mov	[esp+48h+Dest],	70h
		call	gcry_xmalloc
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	edx, eax
		mov	ebx, 70h
		mov	eax, 0
		mov	ecx, edx
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_402E06
		mov	[edx], al
		add	edx, 1
		sub	ebx, 1

loc_402E06:				; CODE XREF: sub_402D72+8Aj
		mov	ecx, edx
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_402E18
		mov	[edx], ax
		add	edx, 2
		sub	ebx, 2

loc_402E18:				; CODE XREF: sub_402D72+9Bj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, edx
		rep stosd
		mov	edx, edi
		mov	ecx, ebx
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_402E32
		mov	[edx], ax
		add	edx, 2

loc_402E32:				; CODE XREF: sub_402D72+B8j
		mov	ecx, ebx
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_402E40
		mov	[edx], al
		add	edx, 1

loc_402E40:				; CODE XREF: sub_402D72+C7j
		mov	eax, [ebp+var_24]
		mov	word ptr [eax],	1
		mov	eax, [ebp+Filename]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		cmp	eax, 65h
		jbe	short loc_402E8B
		mov	[esp+48h+var_40], 43Ch ; int
		mov	[esp+48h+Source], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/scd/scdaemon.c"
		mov	[esp+48h+Dest],	offset aStrlenName1Siz ; "strlen (name)	+ 1 < sizeof (serv_addr->"...
		call	sub_442650

loc_402E8B:				; CODE XREF: sub_402D72+FBj
		mov	eax, [ebp+var_24]
		lea	edx, [eax+8]
		mov	eax, [ebp+Filename]
		mov	[esp+48h+Source], eax ;	Source
		mov	[esp+48h+Dest],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+var_24]
		add	eax, 8
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 8
		mov	dword ptr [ebp+var_28],	eax
		mov	eax, dword ptr [ebp+var_28]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Source], eax
		mov	eax, [ebp+s]
		mov	[esp+48h+Dest],	eax
		call	assuan_sock_bind
		mov	[ebp+var_1C], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_402F27
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jnz	short loc_402F27
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 2740h
		jnz	short loc_402F27
		mov	eax, [ebp+Filename]
		mov	[esp+48h+Dest],	eax ; Filename
		call	remove
		mov	eax, dword ptr [ebp+var_28]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Source], eax
		mov	eax, [ebp+s]
		mov	[esp+48h+Dest],	eax
		call	assuan_sock_bind
		mov	[ebp+var_1C], eax

loc_402F27:				; CODE XREF: sub_402D72+176j
					; sub_402D72+17Cj ...
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jz	short loc_402F63
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_40], eax
		mov	eax, dword ptr [ebp+var_28]
		mov	[esp+48h+Source], eax ;	char
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Dest],	eax
		call	assuan_sock_get_nonce
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_402F63
		mov	[esp+48h+Dest],	offset aErrorGettingNo ; "error	getting	nonce for the socket\n"
		call	sub_43C238
		mov	[esp+48h+Dest],	eax ; char *
		call	sub_43CB21

loc_402F63:				; CODE XREF: sub_402D72+1B9j
					; sub_402D72+1DBj
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jnz	short loc_402FB1
		call	sub_401592
		mov	[esp+48h+Dest],	eax
		call	gpg_strerror
		mov	ebx, eax
		mov	eax, [ebp+var_24]
		lea	esi, [eax+8]
		mov	[esp+48h+Dest],	offset aErrorBindingSo ; "error	binding	socket to `%s': %s\n"
		call	sub_43C238
		mov	[esp+48h+var_40], ebx
		mov	[esp+48h+Source], esi ;	char
		mov	[esp+48h+Dest],	eax ; char *
		call	sub_43CB21
		mov	eax, [ebp+s]
		mov	[esp+48h+Dest],	eax
		call	assuan_sock_close
		mov	[esp+48h+Dest],	2
		call	sub_402B62
; ---------------------------------------------------------------------------

loc_402FB1:				; CODE XREF: sub_402D72+1F5j
		mov	eax, [ebp+s]
		mov	[esp+48h+Source], 5 ; backlog
		mov	[esp+48h+Dest],	eax ; s
		mov	eax, ds:listen
		call	eax ; listen
		sub	esp, 8
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40300C
		call	sub_401592
		mov	[esp+48h+Dest],	eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+48h+Dest],	offset aListenFailedS ;	"listen() failed: %s\n"
		call	sub_43C238
		mov	[esp+48h+Source], ebx ;	char
		mov	[esp+48h+Dest],	eax ; char *
		call	sub_43CB21
		mov	eax, [ebp+s]
		mov	[esp+48h+Dest],	eax
		call	assuan_sock_close
		mov	[esp+48h+Dest],	2
		call	sub_402B62
; ---------------------------------------------------------------------------

loc_40300C:				; CODE XREF: sub_402D72+25Aj
		mov	eax, ds:dword_451D24
		test	eax, eax
		jz	short loc_403033
		mov	eax, [ebp+var_24]
		lea	ebx, [eax+8]
		mov	[esp+48h+Dest],	offset aListeningOnSoc ; "listening on socket `%s'\n"
		call	sub_43C238
		mov	[esp+48h+Source], ebx ;	char
		mov	[esp+48h+Dest],	eax ; char *
		call	sub_43CAF7

loc_403033:				; CODE XREF: sub_402D72+2A1j
		mov	eax, [ebp+s]
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_402D72	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40303E	proc near		; DATA XREF: sub_401C11+E33o
					; sub_40316F+4C5o

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_4030C7
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	dword ptr [esp+28h+var_24], offset dword_45102C
		mov	[esp+28h+var_28], eax
		call	assuan_sock_check_nonce
		test	eax, eax
		jz	short loc_4030C7
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	int
		call	strerror
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	esi, eax
		mov	[esp+28h+var_28], offset aErrorReadingNo ; "error reading nonce	on fd %d: %s\n"
		call	sub_43C238
		mov	[esp+28h+var_20], ebx
		mov	dword ptr [esp+28h+var_24], esi	; char
		mov	[esp+28h+var_28], eax ;	char *
		call	sub_43CAF7
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		call	assuan_sock_close
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_403168
; ---------------------------------------------------------------------------

loc_4030C7:				; CODE XREF: sub_40303E+16j
					; sub_40303E+2Fj
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_402BAE
		mov	eax, ds:dword_451D24
		test	eax, eax
		jz	short loc_4030FA
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	ebx, eax
		mov	[esp+28h+var_28], offset aHandlerForFdDS ; "handler for	fd %d started\n"
		call	sub_43C238
		mov	dword ptr [esp+28h+var_24], ebx	; char
		mov	[esp+28h+var_28], eax ;	char *
		call	sub_43CAF7

loc_4030FA:				; CODE XREF: sub_40303E+9Bj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	dword ptr [esp+28h+var_24], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_406CEF
		test	eax, eax
		jz	short loc_403125
		mov	eax, ds:dword_451024
		test	eax, eax
		jz	short loc_403125
		mov	ds:dword_451020, 1

loc_403125:				; CODE XREF: sub_40303E+D2j
					; sub_40303E+DBj
		mov	eax, ds:dword_451D24
		test	eax, eax
		jz	short loc_40314D
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	ebx, eax
		mov	[esp+28h+var_28], offset aHandlerForFdDT ; "handler for	fd %d terminated\n"
		call	sub_43C238
		mov	dword ptr [esp+28h+var_24], ebx	; char
		mov	[esp+28h+var_28], eax ;	char *
		call	sub_43CAF7

loc_40314D:				; CODE XREF: sub_40303E+EEj
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_402BBD
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, 0

loc_403168:				; CODE XREF: sub_40303E+84j
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_40303E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40316F(SOCKET)
sub_40316F	proc near		; CODE XREF: sub_401C11+E91p
					; sub_401C11+F33p

fd		= dword	ptr -328h
var_324		= dword	ptr -324h
var_320		= dword	ptr -320h
var_31C		= dword	ptr -31Ch
var_318		= dword	ptr -318h
var_314		= dword	ptr -314h
var_2FA		= byte ptr -2FAh
var_2C9		= byte ptr -2C9h
var_2C8		= dword	ptr -2C8h
var_2C4		= dword	ptr -2C4h
var_2C0		= byte ptr -2C0h
var_2BC		= fd_set ptr -2BCh
var_1B8		= dword	ptr -1B8h
var_1B4		= dword	ptr -1B4h
var_B4		= dword	ptr -0B4h
var_B0		= byte ptr -0B0h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 31Ch
		call	pth_attr_new
		mov	[ebp+var_28], eax
		mov	[esp+328h+var_320], 0
		mov	[esp+328h+var_324], 2
		mov	eax, [ebp+var_28]
		mov	[esp+328h+fd], eax
		call	pth_attr_set
		mov	[esp+328h+var_320], 80000h
		mov	[esp+328h+var_324], 4
		mov	eax, [ebp+var_28]
		mov	[esp+328h+fd], eax
		call	pth_attr_set
		mov	[ebp+var_3C], 0
		lea	eax, [ebp+var_40]
		mov	[esp+328h+var_320], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+328h+var_324], eax
		mov	[esp+328h+fd], 8
		call	pth_event
		mov	[ebp+var_2C], eax
		mov	[ebp+var_1C], 0
		mov	[ebp+var_1B8], 0
		mov	[ebp+var_20], 0
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jz	short loc_40325C
		mov	[ebp+var_24], 0
		jmp	short loc_403219
; ---------------------------------------------------------------------------

loc_403204:				; CODE XREF: sub_40316F+B3j
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+eax*4+var_1B4]
		mov	eax, [ebp+arg_0]
		cmp	edx, eax
		jz	short loc_403224
		add	[ebp+var_24], 1

loc_403219:				; CODE XREF: sub_40316F+93j
		mov	eax, [ebp+var_1B8]
		cmp	eax, [ebp+var_24]
		ja	short loc_403204

loc_403224:				; CODE XREF: sub_40316F+A4j
		mov	eax, [ebp+var_1B8]
		cmp	eax, [ebp+var_24]
		jnz	short loc_403256
		mov	eax, [ebp+var_1B8]
		cmp	eax, 3Fh
		ja	short loc_403256
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_24]
		mov	[ebp+eax*4+var_1B4], edx
		mov	eax, [ebp+var_1B8]
		add	eax, 1
		mov	[ebp+var_1B8], eax

loc_403256:				; CODE XREF: sub_40316F+BEj
					; sub_40316F+C9j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_20], eax

loc_40325C:				; CODE XREF: sub_40316F+8Aj
					; sub_40316F+538j ...
		mov	eax, ds:dword_451020
		test	eax, eax
		jz	short loc_40328B
		mov	[esp+328h+fd], 3F0h
		call	pth_ctrl
		cmp	eax, 1
		jz	loc_4036B2
		mov	[ebp+var_1B8], 0
		mov	[ebp+arg_0], 0FFFFFFFFh

loc_40328B:				; CODE XREF: sub_40316F+F4j
		cmp	[ebp+var_1C], 0
		jnz	loc_403358
		mov	[esp+328h+var_324], 3D090h
		mov	[esp+328h+fd], 0
		call	pth_timeout
		mov	[ebp+var_2C8], eax
		mov	[ebp+var_2C4], edx
		mov	ecx, [ebp+var_2C4]
		mov	edx, 431BDE83h
		mov	eax, ecx
		imul	edx
		sar	edx, 10h
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		imul	eax, 3D090h
		mov	esi, ecx
		sub	esi, eax
		mov	eax, esi
		cmp	eax, 0Ah
		jle	short loc_403335
		mov	ecx, [ebp+var_2C4]
		mov	edx, 431BDE83h
		mov	eax, ecx
		imul	edx
		sar	edx, 10h
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		imul	eax, 3D090h
		mov	[ebp+var_2C4], eax
		mov	eax, [ebp+var_2C4]
		cmp	eax, 0F423Fh
		jle	short loc_403335
		mov	eax, [ebp+var_2C8]
		add	eax, 1
		mov	[ebp+var_2C8], eax
		mov	[ebp+var_2C4], 0

loc_403335:				; CODE XREF: sub_40316F+172j
					; sub_40316F+1ABj
		mov	eax, [ebp+var_2C8]
		mov	edx, [ebp+var_2C4]
		mov	[esp+328h+var_324], eax
		mov	[esp+328h+var_320], edx
		mov	[esp+328h+fd], 10h
		call	pth_event
		mov	[ebp+var_1C], eax

loc_403358:				; CODE XREF: sub_40316F+120j
		lea	edx, [ebp+var_2BC]
		lea	ebx, [ebp+var_1B8]
		mov	eax, 41h
		mov	edi, edx
		mov	esi, ebx
		mov	ecx, eax
		rep movsd
		cmp	[ebp+var_1C], 0
		jz	short loc_403391
		mov	[esp+328h+var_320], 0
		mov	eax, [ebp+var_1C]
		mov	[esp+328h+var_324], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+328h+fd], eax
		call	pth_event_concat

loc_403391:				; CODE XREF: sub_40316F+206j
		mov	eax, [ebp+var_20]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_2C]
		mov	[esp+328h+var_314], eax
		mov	[esp+328h+var_318], 0
		mov	[esp+328h+var_31C], 0
		mov	[esp+328h+var_320], 0
		lea	eax, [ebp+var_2BC]
		mov	[esp+328h+var_324], eax
		mov	[esp+328h+fd], edx
		call	pth_select_ev
		mov	[ebp+var_30], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_4033DC
		mov	eax, [ebp+var_1C]
		mov	[esp+328h+fd], eax
		call	pth_event_isolate

loc_4033DC:				; CODE XREF: sub_40316F+260j
		cmp	[ebp+var_30], 0FFFFFFFFh
		jnz	loc_4034A1
		mov	eax, [ebp+var_2C]
		mov	[esp+328h+fd], eax
		call	pth_event_occurred
		test	eax, eax
		jnz	short loc_40340A
		cmp	[ebp+var_1C], 0
		jz	short loc_403465
		mov	eax, [ebp+var_1C]
		mov	[esp+328h+fd], eax
		call	pth_event_occurred
		test	eax, eax
		jz	short loc_403465

loc_40340A:				; CODE XREF: sub_40316F+284j
		mov	eax, [ebp+var_2C]
		mov	[esp+328h+fd], eax
		call	pth_event_occurred
		test	eax, eax
		jz	short loc_403424
		mov	eax, [ebp+var_40]
		mov	[esp+328h+fd], eax
		call	sub_402BE8

loc_403424:				; CODE XREF: sub_40316F+2A8j
		cmp	[ebp+var_1C], 0
		jz	loc_4036AC
		mov	eax, [ebp+var_1C]
		mov	[esp+328h+fd], eax
		call	pth_event_occurred
		test	eax, eax
		jz	loc_4036AC
		mov	[esp+328h+var_324], 1
		mov	eax, [ebp+var_1C]
		mov	[esp+328h+fd], eax
		call	pth_event_free
		mov	[ebp+var_1C], 0
		call	sub_402C03
		jmp	loc_4036AC
; ---------------------------------------------------------------------------

loc_403465:				; CODE XREF: sub_40316F+28Aj
					; sub_40316F+299j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+328h+fd], eax ; int
		call	strerror
		mov	ebx, eax
		mov	[esp+328h+fd], offset aPth_selectFail ;	"pth_select failed: %s - waiting 1s\n"
		call	sub_43C238
		mov	[esp+328h+var_324], ebx	; char
		mov	[esp+328h+fd], eax ; char *
		call	sub_43CB21
		mov	[esp+328h+fd], 1
		call	pth_sleep
		jmp	loc_4036AD
; ---------------------------------------------------------------------------

loc_4034A1:				; CODE XREF: sub_40316F+271j
		mov	eax, [ebp+var_2C]
		mov	[esp+328h+fd], eax
		call	pth_event_occurred
		test	eax, eax
		jz	short loc_4034BB
		mov	eax, [ebp+var_40]
		mov	[esp+328h+fd], eax
		call	sub_402BE8

loc_4034BB:				; CODE XREF: sub_40316F+33Fj
		cmp	[ebp+var_1C], 0
		jz	short loc_4034EF
		mov	eax, [ebp+var_1C]
		mov	[esp+328h+fd], eax
		call	pth_event_occurred
		test	eax, eax
		jz	short loc_4034EF
		mov	[esp+328h+var_324], 1
		mov	eax, [ebp+var_1C]
		mov	[esp+328h+fd], eax
		call	pth_event_free
		mov	[ebp+var_1C], 0
		call	sub_402C03

loc_4034EF:				; CODE XREF: sub_40316F+350j
					; sub_40316F+35Fj
		lea	eax, [ebp+var_2C0]
		mov	[esp+328h+var_320], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+328h+var_324], eax
		mov	[esp+328h+fd], 0
		call	pth_sigmask
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jz	loc_403689
		mov	eax, [ebp+arg_0]
		lea	edx, [ebp+var_2BC]
		mov	[esp+328h+var_324], edx	; fd_set *
		mov	[esp+328h+fd], eax ; fd
		call	__WSAFDIsSet
		sub	esp, 8
		test	eax, eax
		jz	loc_403689
		mov	[ebp+var_B4], 70h
		lea	eax, [ebp+var_B4]
		mov	[esp+328h+var_320], eax
		lea	eax, [ebp+var_B0]
		mov	[esp+328h+var_324], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+328h+fd], eax
		call	pth_accept
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0FFFFFFFFh
		jnz	short loc_40358E
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+328h+fd], eax ; int
		call	strerror
		mov	[esp+328h+var_324], eax	; char
		mov	[esp+328h+fd], offset aAcceptFailedS ; "accept failed: %s\n"
		call	sub_43CB21
		jmp	loc_403682
; ---------------------------------------------------------------------------

loc_40358E:				; CODE XREF: sub_40316F+3F7j
		mov	[esp+328h+var_324], 18h
		mov	[esp+328h+fd], 1
		call	gcry_calloc
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jnz	short loc_4035DC
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+328h+fd], eax ; int
		call	strerror
		mov	[esp+328h+var_324], eax	; char
		mov	[esp+328h+fd], offset aErrorAllocatin ;	"error allocating connection control dat"...
		call	sub_43CB21
		mov	eax, [ebp+var_34]
		mov	[esp+328h+fd], eax
		call	_close
		jmp	loc_403682
; ---------------------------------------------------------------------------

loc_4035DC:				; CODE XREF: sub_40316F+43Aj
		mov	eax, [ebp+var_34]
		mov	[esp+328h+var_31C], eax
		mov	[esp+328h+var_320], offset aConnFdD ; "conn fd=%d"
		mov	[esp+328h+var_324], 31h
		lea	eax, [ebp+var_2FA]
		mov	[esp+328h+fd], eax
		call	sub_429C1D
		mov	[ebp+var_2C9], 0
		lea	eax, [ebp+var_2FA]
		mov	[esp+328h+var_320], eax
		mov	[esp+328h+var_324], 1
		mov	eax, [ebp+var_28]
		mov	[esp+328h+fd], eax
		call	pth_attr_set
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_38]
		mov	[eax], edx
		mov	eax, [ebp+var_38]
		mov	[esp+328h+var_320], eax
		mov	[esp+328h+var_324], offset sub_40303E
		mov	eax, [ebp+var_28]
		mov	[esp+328h+fd], eax
		call	pth_spawn
		test	eax, eax
		jnz	short loc_403682
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+328h+fd], eax ; int
		call	strerror
		mov	[esp+328h+var_324], eax	; char
		mov	[esp+328h+fd], offset aErrorSpawningC ;	"error spawning	connection handler: %s\n"
		call	sub_43CB21
		mov	eax, [ebp+var_38]
		mov	[esp+328h+fd], eax
		call	gcry_free
		mov	eax, [ebp+var_34]
		mov	[esp+328h+fd], eax
		call	_close

loc_403682:				; CODE XREF: sub_40316F+41Aj
					; sub_40316F+468j ...
		mov	[ebp+var_34], 0FFFFFFFFh

loc_403689:				; CODE XREF: sub_40316F+3A1j
					; sub_40316F+3C1j
		mov	[esp+328h+var_320], 0
		lea	eax, [ebp+var_2C0]
		mov	[esp+328h+var_324], eax
		mov	[esp+328h+fd], 2
		call	pth_sigmask
		jmp	loc_40325C
; ---------------------------------------------------------------------------

loc_4036AC:				; CODE XREF: sub_40316F+2B9j
					; sub_40316F+2CCj ...
		nop

loc_4036AD:				; CODE XREF: sub_40316F+32Dj
		jmp	loc_40325C
; ---------------------------------------------------------------------------

loc_4036B2:				; CODE XREF: sub_40316F+105j
		nop
		mov	[esp+328h+var_324], 1
		mov	eax, [ebp+var_2C]
		mov	[esp+328h+fd], eax
		call	pth_event_free
		cmp	[ebp+var_1C], 0
		jz	short loc_4036DF
		mov	[esp+328h+var_324], 1
		mov	eax, [ebp+var_1C]
		mov	[esp+328h+fd], eax
		call	pth_event_free

loc_4036DF:				; CODE XREF: sub_40316F+55Bj
		call	sub_401BA8
		mov	[esp+328h+fd], 0Dh
		call	sub_43EE3D
		mov	esi, eax
		mov	[esp+328h+fd], 0Bh
		call	sub_43EE3D
		mov	ebx, eax
		mov	[esp+328h+fd], offset aSSStopped ; "%s %s stopped\n"
		call	sub_43C238
		mov	[esp+328h+var_320], esi
		mov	[esp+328h+var_324], ebx	; char
		mov	[esp+328h+fd], eax ; char *
		call	sub_43CAF7
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40316F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403724	proc near		; CODE XREF: sub_40374B+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_403744
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_403749
; ---------------------------------------------------------------------------

loc_403744:				; CODE XREF: sub_403724+7j
		mov	eax, 0

loc_403749:				; CODE XREF: sub_403724+1Ej
		pop	ebp
		retn
sub_403724	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40374B	proc near		; CODE XREF: sub_403773+Ep
					; sub_403DCE+50p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 6
		call	sub_403724
		leave
		retn
sub_40374B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403766	proc near		; CODE XREF: sub_403EBF+1AEp
					; sub_403EBF+1BEp ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_403766	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403773	proc near		; CODE XREF: sub_403788+6p
					; sub_4068D3+205p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_40374B
		leave
		retn
sub_403773	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403788	proc near		; CODE XREF: sub_4040C4+152p
					; sub_404250+C3p ...
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		call	sub_403773
		leave
		retn
sub_403788	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403795	proc near		; CODE XREF: sub_401C11+A94p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_45115C
		test	eax, eax
		jnz	short locret_4037BE
		mov	[esp+18h+var_18], offset dword_451158
		call	pth_mutex_init
		test	eax, eax
		jz	short locret_4037BE
		mov	ds:dword_45115C, 1

locret_4037BE:				; CODE XREF: sub_403795+Dj
					; sub_403795+1Dj
		leave
		retn
sub_403795	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4037C0	proc near		; CODE XREF: sub_403BAA+1C9p
					; sub_403EBF+1FBp ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jz	short loc_403818
		mov	eax, ds:dword_451150
		mov	[ebp+var_C], eax
		jmp	short loc_4037FF
; ---------------------------------------------------------------------------

loc_4037D6:				; CODE XREF: sub_4037C0+43j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_4037F7
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	eax, [eax+8]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_4037F7
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+10h], edx

loc_4037F7:				; CODE XREF: sub_4037C0+1Ej
					; sub_4037C0+2Cj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_4037FF:				; CODE XREF: sub_4037C0+14j
		cmp	[ebp+var_C], 0
		jnz	short loc_4037D6
		cmp	[ebp+arg_4], 0
		jz	short locret_403819
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40E4A8
		jmp	short locret_403819
; ---------------------------------------------------------------------------

loc_403818:				; CODE XREF: sub_4037C0+Aj
		nop

locret_403819:				; CODE XREF: sub_4037C0+49j
					; sub_4037C0+56j
		leave
		retn
sub_4037C0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40381B(char *, char *)
sub_40381B	proc near		; CODE XREF: sub_404250+29p
					; sub_404250+FCp ...

Str		= dword	ptr -38h
SubStr		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+SubStr], eax ;	SubStr
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; Str
		call	strstr
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4038AF
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_0]
		jz	short loc_403881
		mov	eax, [ebp+var_10]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_403881
		mov	eax, [ebp+var_10]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_4038AF

loc_403881:				; CODE XREF: sub_40381B+4Aj
					; sub_40381B+57j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4038A8
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4038A8
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_4038AF

loc_4038A8:				; CODE XREF: sub_40381B+71j
					; sub_40381B+7Ej
		mov	eax, 1
		jmp	short loc_4038B4
; ---------------------------------------------------------------------------

loc_4038AF:				; CODE XREF: sub_40381B+42j
					; sub_40381B+64j ...
		mov	eax, 0

loc_4038B4:				; CODE XREF: sub_40381B+92j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_40381B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4038BA(char *, char *)
sub_4038BA	proc near		; CODE XREF: sub_405B59+8Dp
					; sub_4068D3+52p

Str		= dword	ptr -38h
SubStr		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+SubStr], eax ;	SubStr
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; Str
		call	strstr
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40395C
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_0]
		jz	short loc_403920
		mov	eax, [ebp+var_10]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_403920
		mov	eax, [ebp+var_10]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_40395C

loc_403920:				; CODE XREF: sub_4038BA+4Aj
					; sub_4038BA+57j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_403954
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_403954
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_403954
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_40395C

loc_403954:				; CODE XREF: sub_4038BA+71j
					; sub_4038BA+7Ej ...
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		jmp	short loc_403961
; ---------------------------------------------------------------------------

loc_40395C:				; CODE XREF: sub_4038BA+42j
					; sub_4038BA+64j ...
		mov	eax, 0

loc_403961:				; CODE XREF: sub_4038BA+A0j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_4038BA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403967	proc near		; CODE XREF: sub_404879+4Ap
					; sub_404D51+152p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		jmp	short loc_4039AE
; ---------------------------------------------------------------------------

loc_40396C:				; CODE XREF: sub_403967+28j
		add	[ebp+arg_0], 1
		jmp	short loc_403973
; ---------------------------------------------------------------------------

loc_403972:				; CODE XREF: sub_403967+5Cj
		nop

loc_403973:				; CODE XREF: sub_403967+9j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_403999
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_403999
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_40396C
		jmp	short loc_403999
; ---------------------------------------------------------------------------

loc_403993:				; CODE XREF: sub_403967+3Bj
					; sub_403967+45j
		add	[ebp+arg_0], 1
		jmp	short loc_40399A
; ---------------------------------------------------------------------------

loc_403999:				; CODE XREF: sub_403967+14j
					; sub_403967+1Ej ...
		nop

loc_40399A:				; CODE XREF: sub_403967+30j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_403993
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_403993

loc_4039AE:				; CODE XREF: sub_403967+3j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_4039C5
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jz	short loc_403972

loc_4039C5:				; CODE XREF: sub_403967+4Fj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_403967	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4039CA	proc near		; CODE XREF: sub_4068D3+1F7p

var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+var_38], eax
		call	gcry_malloc
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_403A0E
		mov	eax, 0
		jmp	loc_403BA4
; ---------------------------------------------------------------------------

loc_403A0E:				; CODE XREF: sub_4039CA+38j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_403B8B
; ---------------------------------------------------------------------------

loc_403A20:				; CODE XREF: sub_4039CA+1C9j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	loc_403B86
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	loc_403B86
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	loc_403B86
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_403A5E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_403A8E

loc_403A5E:				; CODE XREF: sub_4039CA+88j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_403A72
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_403A8E

loc_403A72:				; CODE XREF: sub_4039CA+9Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	loc_403B99
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	loc_403B99

loc_403A8E:				; CODE XREF: sub_4039CA+92j
					; sub_4039CA+A6j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_403AA8
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_403AE4

loc_403AA8:				; CODE XREF: sub_4039CA+CFj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_403AC2
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_403AE4

loc_403AC2:				; CODE XREF: sub_4039CA+E9j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	loc_403B99
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	loc_403B99

loc_403AE4:				; CODE XREF: sub_4039CA+DCj
					; sub_4039CA+F6j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		lea	ecx, [edx+eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_403B0A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_403B36
; ---------------------------------------------------------------------------

loc_403B0A:				; CODE XREF: sub_4039CA+12Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_403B25
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_403B34
; ---------------------------------------------------------------------------

loc_403B25:				; CODE XREF: sub_4039CA+148j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_403B34:				; CODE XREF: sub_4039CA+159j
		mov	edx, eax

loc_403B36:				; CODE XREF: sub_4039CA+13Ej
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_403B51
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_403B78
; ---------------------------------------------------------------------------

loc_403B51:				; CODE XREF: sub_4039CA+177j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_403B6C
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_403B78
; ---------------------------------------------------------------------------

loc_403B6C:				; CODE XREF: sub_4039CA+192j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_403B78:				; CODE XREF: sub_4039CA+185j
					; sub_4039CA+1A0j
		add	eax, edx
		mov	[ecx], al
		add	[ebp+var_10], 1
		add	[ebp+var_C], 1
		jmp	short loc_403B87
; ---------------------------------------------------------------------------

loc_403B86:				; CODE XREF: sub_4039CA+5Ej
					; sub_4039CA+6Cj ...
		nop

loc_403B87:				; CODE XREF: sub_4039CA+1BAj
		add	[ebp+var_C], 1

loc_403B8B:				; CODE XREF: sub_4039CA+51j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_403A20

loc_403B99:				; CODE XREF: sub_4039CA+B0j
					; sub_4039CA+BEj ...
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_14]

loc_403BA4:				; CODE XREF: sub_4039CA+3Fj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_4039CA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403BAA	proc near		; CODE XREF: sub_403DA0+22p
					; sub_4040C4+95p ...

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jz	short loc_403BE9
		cmp	[ebp+var_10], 0
		js	short loc_403BCD
		mov	eax, [ebp+var_10]
		cmp	eax, 9
		jbe	short loc_403BE9

loc_403BCD:				; CODE XREF: sub_403BAA+19j
		mov	[esp+28h+var_20], offset aDo_reset ; "do_reset"
		mov	dword ptr [esp+28h+var_24], 120h
		mov	[esp+28h+var_28], offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/scd/command.c"
		call	sub_43CCB0
; ---------------------------------------------------------------------------

loc_403BE9:				; CODE XREF: sub_403BAA+13j
					; sub_403BAA+21j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_403C4B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+28h+var_28], eax
		call	sub_40ECE7
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_403C4B
		mov	eax, ds:dword_451150
		mov	[ebp+var_C], eax
		jmp	short loc_403C45
; ---------------------------------------------------------------------------

loc_403C1B:				; CODE XREF: sub_403BAA+9Fj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_403C3D
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_10]
		jnz	short loc_403C3D
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+14h], 1

loc_403C3D:				; CODE XREF: sub_403BAA+79j
					; sub_403BAA+87j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_403C45:				; CODE XREF: sub_403BAA+6Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_403C1B

loc_403C4B:				; CODE XREF: sub_403BAA+47j
					; sub_403BAA+65j
		cmp	[ebp+var_10], 0FFFFFFFFh
		jz	loc_403CF3
		cmp	[ebp+arg_4], 0
		jz	loc_403CF3
		mov	eax, ds:dword_451154
		test	eax, eax
		jz	short loc_403CA3
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, ds:dword_451154
		cmp	edx, eax
		jz	short loc_403CA3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_403CA3
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_403CA3
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		mov	eax, [eax+8]
		cmp	edx, eax
		jz	short loc_403CF3

loc_403CA3:				; CODE XREF: sub_403BAA+BCj
					; sub_403BAA+CBj ...
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_40E4A8
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_40ACEF
		test	eax, eax
		jz	short loc_403CF2
		test	eax, eax
		js	short loc_403CCD
		sub	eax, 10008h
		cmp	eax, 1
		ja	short loc_403CCD
		jmp	short loc_403CF3
; ---------------------------------------------------------------------------

loc_403CCD:				; CODE XREF: sub_403BAA+115j
					; sub_403BAA+11Fj
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_40A90C
		mov	edx, [ebp+var_10]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, offset dword_451060
		mov	dword ptr [eax+4], 0FFFFFFFFh
		jmp	short loc_403CF3
; ---------------------------------------------------------------------------

loc_403CF2:				; CODE XREF: sub_403BAA+111j
		nop

loc_403CF3:				; CODE XREF: sub_403BAA+A5j
					; sub_403BAA+AFj ...
		mov	eax, ds:dword_451154
		test	eax, eax
		jz	short loc_403D21
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, ds:dword_451154
		cmp	edx, eax
		jnz	short loc_403D21
		mov	ds:dword_451154, 0
		mov	[esp+28h+var_28], offset aImplicitlyUnlo ; "implicitly unlocking due to	RESET\n"
		call	sub_43CAF7

loc_403D21:				; CODE XREF: sub_403BAA+150j
					; sub_403BAA+15Fj
		mov	[esp+28h+var_20], 0
		mov	dword ptr [esp+28h+var_24], 0 ;	char
		mov	[esp+28h+var_28], offset dword_451158
		call	pth_mutex_acquire
		test	eax, eax
		jnz	short loc_403D59
		mov	[esp+28h+var_28], offset aFailedToAcquir ; "failed to acquire status_fle_update	loc"...
		call	sub_43CB21
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0FFFFFFFFh
		jmp	short locret_403D9E
; ---------------------------------------------------------------------------

loc_403D59:				; CODE XREF: sub_403BAA+195j
		mov	[esp+28h+var_28], 0
		call	sub_40729B
		mov	dword ptr [esp+28h+var_24], 0 ;	char
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_4037C0
		mov	[esp+28h+var_28], offset dword_451158
		call	pth_mutex_release
		test	eax, eax
		jnz	short loc_403D94
		mov	[esp+28h+var_28], offset aFailedToReleas ; "failed to release status_file_update lo"...
		call	sub_43CB21

loc_403D94:				; CODE XREF: sub_403BAA+1DCj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0FFFFFFFFh

locret_403D9E:				; CODE XREF: sub_403BAA+1ADj
		leave
		retn
sub_403BAA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403DA0	proc near		; DATA XREF: sub_406C20+9Eo

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_get_pointer
		mov	[ebp+var_C], eax
		mov	[esp+28h+var_24], 1
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_403BAA
		mov	eax, 0
		leave
		retn
sub_403DA0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403DCE(int, int, char	*)
sub_403DCE	proc near		; DATA XREF: sub_406C20+B1o

Str		= dword	ptr -38h
EndPtr		= dword	ptr -34h
Radix		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	assuan_get_pointer
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aEventSignal ; "event-signal"
		mov	ecx, 0Dh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_403E49
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_403E25
		mov	[esp+38h+Str], 118h
		call	sub_40374B
		jmp	short loc_403E4E
; ---------------------------------------------------------------------------

loc_403E25:				; CODE XREF: sub_403DCE+47j
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax+4]
		mov	[esp+38h+Radix], 10h ; Radix
		mov	[esp+38h+EndPtr], 0 ; EndPtr
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+Str], eax ; Str
		call	strtoul
		mov	[ebx+0Ch], eax

loc_403E49:				; CODE XREF: sub_403DCE+3Dj
		mov	eax, 0

loc_403E4E:				; CODE XREF: sub_403DCE+55j
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_403DCE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403E56	proc near		; CODE XREF: sub_403EBF:loc_403FA1p
					; sub_406CEF+194p

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], offset dword_451060
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_403E7F
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4], 0FFFFFFFFh
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax], 1

loc_403E7F:				; CODE XREF: sub_403E56+14j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_403EB8
		mov	eax, ds:dword_451D40
		mov	[esp+28h+var_28], eax ;	char *
		call	sub_40A3E0
		mov	edx, [ebp+var_C]
		mov	[edx+4], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_403EB8
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh
		jmp	short locret_403EBD
; ---------------------------------------------------------------------------

loc_403EB8:				; CODE XREF: sub_403E56+32j
					; sub_403E56+50j
		mov	eax, 0

locret_403EBD:				; CODE XREF: sub_403E56+60j
		leave
		retn
sub_403E56	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403EBF(int, char *)
sub_403EBF	proc near		; CODE XREF: sub_4040C4+B8p
					; sub_404250+3Fp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_403EE3
		mov	[esp+28h+var_28], 6Eh
		call	sub_40374B
		jmp	locret_4040C2
; ---------------------------------------------------------------------------

loc_403EE3:				; CODE XREF: sub_403EBF+11j
		mov	eax, ds:dword_451154
		test	eax, eax
		jz	short loc_403F38
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, ds:dword_451154
		cmp	edx, eax
		jz	short loc_403F38
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_403F38
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_403F38
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_403F38
		mov	[esp+28h+var_28], 0ADh
		call	sub_40374B
		jmp	locret_4040C2
; ---------------------------------------------------------------------------

loc_403F38:				; CODE XREF: sub_403EBF+2Bj
					; sub_403EBF+3Aj ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_403F6A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+28h+var_28], eax
		call	sub_40ECE7
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0

loc_403F6A:				; CODE XREF: sub_403EBF+84j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_403F8B
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40E5ED
		jmp	locret_4040C2
; ---------------------------------------------------------------------------

loc_403F8B:				; CODE XREF: sub_403EBF+B3j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_403FA1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[ebp+var_10], eax
		jmp	short loc_403FA9
; ---------------------------------------------------------------------------

loc_403FA1:				; CODE XREF: sub_403EBF+D5j
		call	sub_403E56
		mov	[ebp+var_10], eax

loc_403FA9:				; CODE XREF: sub_403EBF+E0j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+8], edx
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_403FCC
		mov	[esp+28h+var_28], 6Ch
		call	sub_40374B
		mov	[ebp+var_C], eax
		jmp	loc_404061
; ---------------------------------------------------------------------------

loc_403FCC:				; CODE XREF: sub_403EBF+F7j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	dword ptr [eax+18h], 0
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_40AADF
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_40403B
		cmp	[ebp+var_14], 1000Fh
		jz	short loc_40403B
		cmp	[ebp+var_14], 10008h
		jnz	short loc_404010
		mov	[esp+28h+var_28], 70h
		call	sub_40374B
		mov	[ebp+var_C], eax
		jmp	short loc_404061
; ---------------------------------------------------------------------------

loc_404010:				; CODE XREF: sub_403EBF+13Ej
		cmp	[ebp+var_14], 10009h
		jnz	short loc_40402A
		mov	[esp+28h+var_28], 6Dh
		call	sub_40374B
		mov	[ebp+var_C], eax
		jmp	short loc_404061
; ---------------------------------------------------------------------------

loc_40402A:				; CODE XREF: sub_403EBF+158j
		mov	[esp+28h+var_28], 6Ch
		call	sub_40374B
		mov	[ebp+var_C], eax
		jmp	short loc_404061
; ---------------------------------------------------------------------------

loc_40403B:				; CODE XREF: sub_403EBF+12Cj
					; sub_403EBF+135j
		mov	eax, [ebp+arg_0]
		add	eax, 0Ch
		mov	[esp+28h+var_1C], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_20], eax ;	char *
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_40E65D
		mov	[ebp+var_C], eax

loc_404061:				; CODE XREF: sub_403EBF+108j
					; sub_403EBF+14Fj ...
		mov	eax, [ebp+var_C]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	sub_403766
		cmp	eax, 70h
		jz	short loc_4040A9
		mov	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	sub_403766
		cmp	eax, 6Eh
		jz	short loc_4040A9
		mov	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	sub_403766
		cmp	eax, 6Dh
		jz	short loc_4040A9
		mov	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	sub_403766
		cmp	eax, 8050h
		jnz	short loc_4040BF

loc_4040A9:				; CODE XREF: sub_403EBF+1B6j
					; sub_403EBF+1C6j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+var_24], 1
		mov	[esp+28h+var_28], eax
		call	sub_4037C0

loc_4040BF:				; CODE XREF: sub_403EBF+1E8j
		mov	eax, [ebp+var_C]

locret_4040C2:				; CODE XREF: sub_403EBF+1Fj
					; sub_403EBF+74j ...
		leave
		retn
sub_403EBF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4040C4(int, char *)
sub_4040C4	proc near		; DATA XREF: .data:00444264o

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	[ebp+var_14], 0
		mov	[ebp+var_C], 0
		jmp	short loc_4040E9
; ---------------------------------------------------------------------------

loc_4040E8:				; CODE XREF: sub_4040C4+E3j
		nop

loc_4040E9:				; CODE XREF: sub_4040C4+22j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_40415E
		mov	eax, ds:dword_451154
		test	eax, eax
		jz	short loc_40414B
		mov	eax, [ebp+var_10]
		mov	edx, [eax+4]
		mov	eax, ds:dword_451154
		cmp	edx, eax
		jz	short loc_40414B
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40414B
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40414B
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_40414B
		mov	[esp+38h+var_38], 0ADh
		call	sub_40374B
		jmp	locret_40424E
; ---------------------------------------------------------------------------

loc_40414B:				; CODE XREF: sub_4040C4+39j
					; sub_4040C4+48j ...
		mov	[esp+38h+var_34], 1
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_403BAA

loc_40415E:				; CODE XREF: sub_4040C4+30j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40416D
		mov	eax, [ebp+arg_4]
		jmp	short loc_404172
; ---------------------------------------------------------------------------

loc_40416D:				; CODE XREF: sub_4040C4+A2j
		mov	eax, 0

loc_404172:				; CODE XREF: sub_4040C4+A7j
		mov	[esp+38h+var_34], eax ;	char *
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax ;	int
		call	sub_403EBF
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_4041B5
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_38], eax
		call	sub_403766
		cmp	eax, 6Dh
		jnz	short loc_4041AD
		cmp	[ebp+var_C], 0
		setle	al
		add	[ebp+var_C], 1
		test	al, al
		jnz	loc_4040E8

loc_4041AD:				; CODE XREF: sub_4040C4+D4j
		mov	eax, [ebp+var_14]
		jmp	locret_40424E
; ---------------------------------------------------------------------------

loc_4041B5:				; CODE XREF: sub_4040C4+C4j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		lea	edx, [ebp+var_20]
		mov	[esp+38h+var_30], edx
		lea	edx, [ebp+var_1C]
		mov	[esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		call	sub_40EEAD
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_4041DF
		mov	eax, [ebp+var_14]
		jmp	short locret_40424E
; ---------------------------------------------------------------------------

loc_4041DF:				; CODE XREF: sub_4040C4+114j
		mov	eax, [ebp+var_20]
		mov	edx, eax
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+var_2C], edx
		mov	[esp+38h+var_30], eax
		mov	[esp+38h+var_34], offset aSLu ;	"%s %lu"
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_38], eax
		call	sub_429E78
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		cmp	[ebp+var_14], 0
		jns	short loc_40421D
		call	sub_403788
		jmp	short locret_40424E
; ---------------------------------------------------------------------------

loc_40421D:				; CODE XREF: sub_4040C4+150j
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_30], eax
		mov	[esp+38h+var_34], offset aSerialno ; "SERIALNO"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_write_status
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, 0

locret_40424E:				; CODE XREF: sub_4040C4+82j
					; sub_4040C4+ECj ...
		leave
		retn
sub_4040C4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404250(int, char *)
sub_404250	proc near		; DATA XREF: .data:00444270o

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		mov	[esp+48h+var_44], offset aKeypairinfo ;	"--keypairinfo"
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_40381B
		mov	[ebp+var_14], eax
		mov	[esp+48h+var_44], 0 ; char *
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_403EBF
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4042A5
		mov	eax, [ebp+var_C]
		jmp	locret_4044A7
; ---------------------------------------------------------------------------

loc_4042A5:				; CODE XREF: sub_404250+4Bj
		cmp	[ebp+var_14], 0
		jnz	loc_404421
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		lea	edx, [ebp+var_24]
		mov	[esp+48h+var_40], edx
		lea	edx, [ebp+var_20]
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	sub_40EEAD
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4042DC
		mov	eax, [ebp+var_C]
		jmp	locret_4044A7
; ---------------------------------------------------------------------------

loc_4042DC:				; CODE XREF: sub_404250+82j
		mov	eax, [ebp+var_24]
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+var_44], offset aSLu ;	"%s %lu"
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	sub_429E78
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jns	short loc_40431D
		call	sub_403788
		jmp	locret_4044A7
; ---------------------------------------------------------------------------

loc_40431D:				; CODE XREF: sub_404250+C1j
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+var_44], offset aSerialno ; "SERIALNO"
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_write_status
		mov	[esp+48h+var_44], offset aForce	; "--force"
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_40381B
		test	eax, eax
		jnz	loc_404416
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+var_44], offset aKnowncardpS ;	"KNOWNCARDP %s"
		lea	eax, [ebp+var_28]
		mov	[esp+48h+var_48], eax
		call	sub_429E78
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_404391
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		call	sub_403788
		jmp	locret_4044A7
; ---------------------------------------------------------------------------

loc_404391:				; CODE XREF: sub_404250+12Aj
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_28]
		mov	[esp+48h+var_38], 0
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_inquire
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_28]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_404416
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 115h
		jz	short loc_404403
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aInquireKnownca ; "inquire KNOWNCARDP failed: %s\n"
		call	sub_43CB21

loc_404403:				; CODE XREF: sub_404250+196j
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	locret_4044A7
; ---------------------------------------------------------------------------

loc_404416:				; CODE XREF: sub_404250+103j
					; sub_404250+184j
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_free

loc_404421:				; CODE XREF: sub_404250+59j
		cmp	[ebp+var_C], 0
		jnz	short loc_404446
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	[esp+48h+var_40], edx
		mov	edx, [ebp+var_10]
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	sub_40EF3F
		mov	[ebp+var_C], eax

loc_404446:				; CODE XREF: sub_404250+1D5j
		mov	eax, [ebp+var_C]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 70h
		jz	short loc_40448E
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 6Eh
		jz	short loc_40448E
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 6Dh
		jz	short loc_40448E
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 8050h
		jnz	short loc_4044A4

loc_40448E:				; CODE XREF: sub_404250+20Aj
					; sub_404250+21Aj ...
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	[esp+48h+var_44], 1
		mov	[esp+48h+var_48], eax
		call	sub_4037C0

loc_4044A4:				; CODE XREF: sub_404250+23Cj
		mov	eax, [ebp+var_C]

locret_4044A7:				; CODE XREF: sub_404250+50j
					; sub_404250+87j ...
		leave
		retn
sub_404250	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4044A9	proc near		; DATA XREF: .data:0044427Co

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	[esp+38h+var_34], 0 ; char *
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax ;	int
		call	sub_403EBF
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4044E1
		mov	eax, [ebp+var_C]
		jmp	locret_4045E1
; ---------------------------------------------------------------------------

loc_4044E1:				; CODE XREF: sub_4044A9+2Ej
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	gcry_xstrdup
		mov	[ebp+arg_4], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		lea	edx, [ebp+var_1C]
		mov	[esp+38h+var_2C], edx
		lea	edx, [ebp+var_18]
		mov	[esp+38h+var_30], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		call	sub_40F052
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_404536
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		mov	[esp+38h+var_34], eax ;	char
		mov	[esp+38h+var_38], offset aApp_readcertFa ; "app_readcert failed: %s\n"
		call	sub_43CB21

loc_404536:				; CODE XREF: sub_4044A9+70j
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	[ebp+arg_4], 0
		cmp	[ebp+var_C], 0
		jnz	short loc_404580
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_404580
		mov	eax, [ebp+var_C]
		jmp	short locret_4045E1
; ---------------------------------------------------------------------------

loc_404580:				; CODE XREF: sub_4044A9+A3j
					; sub_4044A9+D0j
		mov	eax, [ebp+var_C]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_38], eax
		call	sub_403766
		cmp	eax, 70h
		jz	short loc_4045C8
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_38], eax
		call	sub_403766
		cmp	eax, 6Eh
		jz	short loc_4045C8
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_38], eax
		call	sub_403766
		cmp	eax, 6Dh
		jz	short loc_4045C8
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_38], eax
		call	sub_403766
		cmp	eax, 8050h
		jnz	short loc_4045DE

loc_4045C8:				; CODE XREF: sub_4044A9+EBj
					; sub_4044A9+FBj ...
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	[esp+38h+var_34], 1
		mov	[esp+38h+var_38], eax
		call	sub_4037C0

loc_4045DE:				; CODE XREF: sub_4044A9+11Dj
		mov	eax, [ebp+var_C]

locret_4045E1:				; CODE XREF: sub_4044A9+33j
					; sub_4044A9+D5j
		leave
		retn
sub_4044A9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4045E3	proc near		; DATA XREF: .data:00444288o

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	[ebp+var_20], 0
		mov	[ebp+var_28], 0
		mov	[esp+48h+var_44], 0 ; char *
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_403EBF
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_404629
		mov	eax, [ebp+var_C]
		jmp	locret_404877
; ---------------------------------------------------------------------------

loc_404629:				; CODE XREF: sub_4045E3+3Cj
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	gcry_xstrdup
		mov	[ebp+arg_4], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		lea	edx, [ebp+var_30]
		mov	[esp+48h+var_3C], edx
		lea	edx, [ebp+var_2C]
		mov	[esp+48h+var_40], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	sub_40F0FB
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4046A1
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_2C]
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	[ebp+arg_4], 0
		jmp	loc_404800
; ---------------------------------------------------------------------------

loc_4046A1:				; CODE XREF: sub_4045E3+7Ej
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 7Ch
		jz	short loc_4046CE
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aApp_readkeyFai ; "app_readkey	failed:	%s\n"
		call	sub_43CB21
		jmp	short loc_404715
; ---------------------------------------------------------------------------

loc_4046CE:				; CODE XREF: sub_4045E3+CCj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		lea	edx, [ebp+var_24]
		mov	[esp+48h+var_3C], edx
		lea	edx, [ebp+var_20]
		mov	[esp+48h+var_40], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	sub_40F052
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_404715
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aApp_readcertFa ; "app_readcert failed: %s\n"
		call	sub_43CB21

loc_404715:				; CODE XREF: sub_4045E3+E9j
					; sub_4045E3+115j
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	[ebp+arg_4], 0
		cmp	[ebp+var_C], 0
		jnz	loc_4047FC
		lea	eax, [ebp+var_28]
		mov	[esp+48h+var_48], eax
		call	ksba_cert_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_4047FF
		mov	ecx, [ebp+var_24]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_28]
		mov	[esp+48h+var_40], ecx
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	ksba_cert_init_from_mem
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_404788
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aFailedToParseT ; "failed to parse the	certificate: %s\n"
		call	sub_43CB21
		jmp	short loc_404800
; ---------------------------------------------------------------------------

loc_404788:				; CODE XREF: sub_4045E3+186j
		mov	eax, [ebp+var_28]
		mov	[esp+48h+var_48], eax
		call	ksba_cert_get_public_key
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4047AD
		mov	[esp+48h+var_48], 9
		call	sub_40374B
		mov	[ebp+var_C], eax
		jmp	short loc_404800
; ---------------------------------------------------------------------------

loc_4047AD:				; CODE XREF: sub_4045E3+1B7j
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+var_44], 0
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		jmp	short loc_404800
; ---------------------------------------------------------------------------

loc_4047FC:				; CODE XREF: sub_4045E3+148j
		nop
		jmp	short loc_404800
; ---------------------------------------------------------------------------

loc_4047FF:				; CODE XREF: sub_4045E3+160j
		nop

loc_404800:				; CODE XREF: sub_4045E3+B9j
					; sub_4045E3+1A3j ...
		mov	eax, [ebp+var_28]
		mov	[esp+48h+var_48], eax
		call	ksba_cert_release
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 70h
		jz	short loc_40485E
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 6Eh
		jz	short loc_40485E
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 6Dh
		jz	short loc_40485E
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 8050h
		jnz	short loc_404874

loc_40485E:				; CODE XREF: sub_4045E3+247j
					; sub_4045E3+257j ...
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	[esp+48h+var_44], 1
		mov	[esp+48h+var_48], eax
		call	sub_4037C0

loc_404874:				; CODE XREF: sub_4045E3+279j
		mov	eax, [ebp+var_C]

locret_404877:				; CODE XREF: sub_4045E3+41j
		leave
		retn
sub_4045E3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404879(int, char *)
sub_404879	proc near		; DATA XREF: .data:00444294o

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dst], eax
		call	assuan_get_pointer
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_4048B5
		mov	[esp+38h+Src], offset aAppend ;	"--append"
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Dst], eax ; char *
		call	sub_40381B
		test	eax, eax
		jz	short loc_4048B5
		mov	eax, 1
		jmp	short loc_4048BA
; ---------------------------------------------------------------------------

loc_4048B5:				; CODE XREF: sub_404879+1Cj
					; sub_404879+33j
		mov	eax, 0

loc_4048BA:				; CODE XREF: sub_404879+3Aj
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Dst], eax
		call	sub_403967
		mov	[ebp+arg_4], eax
		mov	eax, ds:dword_451154
		test	eax, eax
		jz	short loc_4048F4
		mov	eax, [ebp+var_20]
		mov	edx, [eax+4]
		mov	eax, ds:dword_451154
		cmp	edx, eax
		jz	short loc_4048F4
		mov	[esp+38h+Dst], 0ADh
		call	sub_40374B
		jmp	locret_404B73
; ---------------------------------------------------------------------------

loc_4048F4:				; CODE XREF: sub_404879+59j
					; sub_404879+68j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_18], eax
		mov	[ebp+var_C], 0
		jmp	short loc_40490B
; ---------------------------------------------------------------------------

loc_404903:				; CODE XREF: sub_404879+A4j
					; sub_404879+B8j ...
		add	[ebp+var_18], 1
		add	[ebp+var_C], 1

loc_40490B:				; CODE XREF: sub_404879+88j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40491F
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_404903

loc_40491F:				; CODE XREF: sub_404879+9Aj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_404933
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_404903

loc_404933:				; CODE XREF: sub_404879+AEj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_404947
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	short loc_404903

loc_404947:				; CODE XREF: sub_404879+C2j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404979
		mov	[esp+38h+Dst], 118h
		call	sub_40374B
		mov	[esp+38h+Size],	offset aInvalidHexstri ; "invalid hexstring"
		mov	[esp+38h+Src], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dst], eax
		call	assuan_set_error
		jmp	locret_404B73
; ---------------------------------------------------------------------------

loc_404979:				; CODE XREF: sub_404879+D6j
		cmp	[ebp+var_C], 0
		jnz	short loc_4049A7
		mov	[esp+38h+Dst], 118h
		call	sub_40374B
		mov	[esp+38h+Size],	offset aNoDataGiven ; "no data given"
		mov	[esp+38h+Src], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dst], eax
		call	assuan_set_error
		jmp	locret_404B73
; ---------------------------------------------------------------------------

loc_4049A7:				; CODE XREF: sub_404879+104j
		mov	eax, [ebp+var_C]
		and	eax, 1
		test	al, al
		jz	short loc_4049D9
		mov	[esp+38h+Dst], 118h
		call	sub_40374B
		mov	[esp+38h+Size],	offset aOddNumberOfDig ; "odd number of	digits"
		mov	[esp+38h+Src], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dst], eax
		call	assuan_set_error
		jmp	locret_404B73
; ---------------------------------------------------------------------------

loc_4049D9:				; CODE XREF: sub_404879+136j
		mov	eax, [ebp+var_C]
		mov	edx, eax
		shr	edx, 1Fh
		add	eax, edx
		sar	eax, 1
		mov	[ebp+var_C], eax
		cmp	[ebp+var_24], 0
		jz	short loc_404A3C
		mov	eax, [ebp+var_20]
		mov	eax, [eax+14h]
		add	eax, [ebp+var_C]
		cmp	eax, 1000h
		jle	short loc_404A26
		mov	[esp+38h+Dst], 43h
		call	sub_40374B
		mov	[esp+38h+Size],	offset aLimitOnTotalSi ; "limit	on total size of data reached"
		mov	[esp+38h+Src], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dst], eax
		call	assuan_set_error
		jmp	locret_404B73
; ---------------------------------------------------------------------------

loc_404A26:				; CODE XREF: sub_404879+183j
		mov	eax, [ebp+var_20]
		mov	eax, [eax+14h]
		add	eax, [ebp+var_C]
		mov	[esp+38h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_1C], eax
		jmp	short loc_404A4A
; ---------------------------------------------------------------------------

loc_404A3C:				; CODE XREF: sub_404879+173j
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_1C], eax

loc_404A4A:				; CODE XREF: sub_404879+1C1j
		cmp	[ebp+var_1C], 0
		jnz	short loc_404A5A
		call	sub_403788
		jmp	locret_404B73
; ---------------------------------------------------------------------------

loc_404A5A:				; CODE XREF: sub_404879+1D5j
		cmp	[ebp+var_24], 0
		jz	short loc_404A8E
		mov	eax, [ebp+var_20]
		mov	eax, [eax+14h]
		mov	ecx, eax
		mov	eax, [ebp+var_20]
		mov	eax, [eax+10h]
		mov	edx, eax
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_20]
		mov	eax, [eax+14h]
		mov	[ebp+var_14], eax
		jmp	short loc_404A95
; ---------------------------------------------------------------------------

loc_404A8E:				; CODE XREF: sub_404879+1E5j
		mov	[ebp+var_14], 0

loc_404A95:				; CODE XREF: sub_404879+213j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_18], eax
		mov	[ebp+var_10], 0
		jmp	loc_404B4B
; ---------------------------------------------------------------------------

loc_404AA7:				; CODE XREF: sub_404879+2D8j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		add	eax, edx
		mov	ecx, eax
		add	ecx, [ebp+var_1C]
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_404AD1
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_404AFD
; ---------------------------------------------------------------------------

loc_404AD1:				; CODE XREF: sub_404879+243j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_404AEC
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_404AFB
; ---------------------------------------------------------------------------

loc_404AEC:				; CODE XREF: sub_404879+260j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_404AFB:				; CODE XREF: sub_404879+271j
		mov	edx, eax

loc_404AFD:				; CODE XREF: sub_404879+256j
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_404B18
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_404B3F
; ---------------------------------------------------------------------------

loc_404B18:				; CODE XREF: sub_404879+28Fj
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_404B33
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_404B3F
; ---------------------------------------------------------------------------

loc_404B33:				; CODE XREF: sub_404879+2AAj
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_404B3F:				; CODE XREF: sub_404879+29Dj
					; sub_404879+2B8j
		add	eax, edx
		mov	[ecx], al
		add	[ebp+var_18], 2
		add	[ebp+var_10], 1

loc_404B4B:				; CODE XREF: sub_404879+229j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_C]
		jl	loc_404AA7
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_1C]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		mov	eax, [ebp+var_20]
		mov	[eax+14h], edx
		mov	eax, 0

locret_404B73:				; CODE XREF: sub_404879+76j
					; sub_404879+FBj ...
		leave
		retn
sub_404879	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404B75	proc near		; DATA XREF: sub_404D51+222o
					; sub_40505B+F8o ...

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+arg_8], 0
		jnz	loc_404C72
		cmp	dword ptr [ebp+arg_4], 0
		jz	loc_404C21
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aPromptingForPi ; "prompting for pinpad entry '%s'\n"
		call	sub_43CBBE
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+48h+var_40], eax
		mov	dword ptr [esp+48h+var_44], offset aPopuppinpadpro ; "POPUPPINPADPROMPT	%s"
		lea	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	sub_429E78
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_404BE9
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+48h+var_48], eax
		call	gpg_err_code_from_errno
		mov	[esp+48h+var_48], eax
		call	sub_40374B
		jmp	locret_404D4F
; ---------------------------------------------------------------------------

loc_404BE9:				; CODE XREF: sub_404B75+54j
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_38], 64h
		lea	edx, [ebp+var_1C]
		mov	[esp+48h+var_3C], edx
		lea	edx, [ebp+var_18]
		mov	[esp+48h+var_40], edx
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	assuan_inquire
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		jmp	short loc_404C59
; ---------------------------------------------------------------------------

loc_404C21:				; CODE XREF: sub_404B75+1Aj
		mov	[esp+48h+var_48], offset aDismissPinpadE ; "dismiss pinpad entry prompt\n"
		call	sub_43CBBE
		mov	[esp+48h+var_38], 64h
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+var_3C], eax
		lea	eax, [ebp+var_18]
		mov	[esp+48h+var_40], eax
		mov	dword ptr [esp+48h+var_44], offset aDismisspinpadp ; "DISMISSPINPADPROMPT"
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	assuan_inquire
		mov	[ebp+var_C], eax

loc_404C59:				; CODE XREF: sub_404B75+AAj
		cmp	[ebp+var_C], 0
		jnz	short loc_404C6A
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_free

loc_404C6A:				; CODE XREF: sub_404B75+E8j
		mov	eax, [ebp+var_C]
		jmp	locret_404D4F
; ---------------------------------------------------------------------------

loc_404C72:				; CODE XREF: sub_404B75+10j
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aAskingForPinS	; "asking for PIN '%s'\n"
		call	sub_43CBBE
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+48h+var_40], eax
		mov	dword ptr [esp+48h+var_44], offset aNeedpinS ; "NEEDPIN	%s"
		lea	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	sub_429E78
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_404CCF
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+48h+var_48], eax
		call	gpg_err_code_from_errno
		mov	[esp+48h+var_48], eax
		call	sub_40374B
		jmp	locret_404D4F
; ---------------------------------------------------------------------------

loc_404CCF:				; CODE XREF: sub_404B75+13Aj
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_38], 64h
		lea	edx, [ebp+var_1C]
		mov	[esp+48h+var_3C], edx
		lea	edx, [ebp+var_18]
		mov	[esp+48h+var_40], edx
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	assuan_inquire
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_404D10
		mov	eax, [ebp+var_C]
		jmp	short locret_404D4F
; ---------------------------------------------------------------------------

loc_404D10:				; CODE XREF: sub_404B75+194j
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jz	short loc_404D29
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_1C]
		sub	edx, 1
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404D42

loc_404D29:				; CODE XREF: sub_404B75+1A0j
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	[esp+48h+var_48], 4Ch
		call	sub_40374B
		jmp	short locret_404D4F
; ---------------------------------------------------------------------------

loc_404D42:				; CODE XREF: sub_404B75+1B2j
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, 0

locret_404D4F:				; CODE XREF: sub_404B75+6Fj
					; sub_404B75+F8j ...
		leave
		retn
sub_404B75	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404D51(int, char *)
sub_404D51	proc near		; DATA XREF: .data:004442A0o

Str		= dword	ptr -58h
SubStr		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 54h
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str], eax
		call	assuan_get_pointer
		mov	[ebp+var_14], eax
		mov	[esp+58h+SubStr], offset aHashRmd160 ; "--hash=rmd160"
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Str], eax ; char *
		call	sub_40381B
		test	eax, eax
		jz	short loc_404D89
		mov	[ebp+var_10], 3
		jmp	loc_404E9D
; ---------------------------------------------------------------------------

loc_404D89:				; CODE XREF: sub_404D51+2Aj
		mov	[esp+58h+SubStr], offset aHashSha1 ; "--hash=sha1"
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Str], eax ; char *
		call	sub_40381B
		test	eax, eax
		jz	short loc_404DAC
		mov	[ebp+var_10], 2
		jmp	loc_404E9D
; ---------------------------------------------------------------------------

loc_404DAC:				; CODE XREF: sub_404D51+4Dj
		mov	[esp+58h+SubStr], offset aHashSha224 ; "--hash=sha224"
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Str], eax ; char *
		call	sub_40381B
		test	eax, eax
		jz	short loc_404DCF
		mov	[ebp+var_10], 0Bh
		jmp	loc_404E9D
; ---------------------------------------------------------------------------

loc_404DCF:				; CODE XREF: sub_404D51+70j
		mov	[esp+58h+SubStr], offset aHashSha256 ; "--hash=sha256"
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Str], eax ; char *
		call	sub_40381B
		test	eax, eax
		jz	short loc_404DF2
		mov	[ebp+var_10], 8
		jmp	loc_404E9D
; ---------------------------------------------------------------------------

loc_404DF2:				; CODE XREF: sub_404D51+93j
		mov	[esp+58h+SubStr], offset aHashSha384 ; "--hash=sha384"
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Str], eax ; char *
		call	sub_40381B
		test	eax, eax
		jz	short loc_404E15
		mov	[ebp+var_10], 9
		jmp	loc_404E9D
; ---------------------------------------------------------------------------

loc_404E15:				; CODE XREF: sub_404D51+B6j
		mov	[esp+58h+SubStr], offset aHashSha512 ; "--hash=sha512"
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Str], eax ; char *
		call	sub_40381B
		test	eax, eax
		jz	short loc_404E35
		mov	[ebp+var_10], 0Ah
		jmp	short loc_404E9D
; ---------------------------------------------------------------------------

loc_404E35:				; CODE XREF: sub_404D51+D9j
		mov	[esp+58h+SubStr], offset aHashMd5 ; "--hash=md5"
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Str], eax ; char *
		call	sub_40381B
		test	eax, eax
		jz	short loc_404E55
		mov	[ebp+var_10], 1
		jmp	short loc_404E9D
; ---------------------------------------------------------------------------

loc_404E55:				; CODE XREF: sub_404D51+F9j
		mov	[esp+58h+SubStr], offset asc_446C14 ; "--"
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Str], eax ; Str
		call	strstr
		test	eax, eax
		jnz	short loc_404E75
		mov	[ebp+var_10], 2
		jmp	short loc_404E9D
; ---------------------------------------------------------------------------

loc_404E75:				; CODE XREF: sub_404D51+119j
		mov	[esp+58h+Str], 118h
		call	sub_40374B
		mov	[esp+58h+var_50], offset aInvalidHashAlg ; "invalid hash algorithm"
		mov	[esp+58h+SubStr], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str], eax
		call	assuan_set_error
		jmp	loc_405055
; ---------------------------------------------------------------------------

loc_404E9D:				; CODE XREF: sub_404D51+33j
					; sub_404D51+56j ...
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Str], eax
		call	sub_403967
		mov	[ebp+arg_4], eax
		mov	eax, ds:dword_451154
		test	eax, eax
		jz	short loc_404F00
		mov	eax, [ebp+var_14]
		mov	edx, [eax+4]
		mov	eax, ds:dword_451154
		cmp	edx, eax
		jz	short loc_404F00
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_404F00
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_404F00
		mov	eax, [ebp+var_14]
		mov	edx, [eax+8]
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_404F00
		mov	[esp+58h+Str], 0ADh
		call	sub_40374B
		jmp	loc_405055
; ---------------------------------------------------------------------------

loc_404F00:				; CODE XREF: sub_404D51+161j
					; sub_404D51+170j ...
		mov	[esp+58h+SubStr], 0 ; char *
		mov	eax, [ebp+var_14]
		mov	[esp+58h+Str], eax ; int
		call	sub_403EBF
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_404F24
		mov	eax, [ebp+var_C]
		jmp	loc_405055
; ---------------------------------------------------------------------------

loc_404F24:				; CODE XREF: sub_404D51+1C9j
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+Str], eax
		call	gcry_strdup
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_404F42
		call	sub_403788
		jmp	loc_405055
; ---------------------------------------------------------------------------

loc_404F42:				; CODE XREF: sub_404D51+1E5j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	ecx, eax
		mov	eax, [ebp+var_14]
		mov	edx, [eax+10h]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		lea	ebx, [ebp+var_24]
		mov	[esp+58h+var_38], ebx
		lea	ebx, [ebp+var_20]
		mov	[esp+58h+var_3C], ebx
		mov	[esp+58h+var_40], ecx
		mov	[esp+58h+var_44], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+58h+var_48], edx
		mov	[esp+58h+var_4C], offset sub_404B75
		mov	edx, [ebp+var_10]
		mov	[esp+58h+var_50], edx
		mov	edx, [ebp+var_18]
		mov	[esp+58h+SubStr], edx
		mov	[esp+58h+Str], eax
		call	sub_40F48F
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_404FC2
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Str], eax
		call	gpg_strerror
		mov	[esp+58h+SubStr], eax ;	char
		mov	[esp+58h+Str], offset aApp_signFailed ;	"app_sign failed: %s\n"
		call	sub_43CB21
		jmp	short loc_404FF4
; ---------------------------------------------------------------------------

loc_404FC2:				; CODE XREF: sub_404D51+252j
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+SubStr], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Str], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_404FF4
		mov	eax, [ebp+var_C]
		jmp	short loc_405055
; ---------------------------------------------------------------------------

loc_404FF4:				; CODE XREF: sub_404D51+26Fj
					; sub_404D51+29Cj
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Str], eax
		call	sub_403766
		cmp	eax, 70h
		jz	short loc_40503C
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Str], eax
		call	sub_403766
		cmp	eax, 6Eh
		jz	short loc_40503C
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Str], eax
		call	sub_403766
		cmp	eax, 6Dh
		jz	short loc_40503C
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Str], eax
		call	sub_403766
		cmp	eax, 8050h
		jnz	short loc_405052

loc_40503C:				; CODE XREF: sub_404D51+2B7j
					; sub_404D51+2C7j ...
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	[esp+58h+SubStr], 1
		mov	[esp+58h+Str], eax
		call	sub_4037C0

loc_405052:				; CODE XREF: sub_404D51+2E9j
		mov	eax, [ebp+var_C]

loc_405055:				; CODE XREF: sub_404D51+147j
					; sub_404D51+1AAj ...
		add	esp, 54h
		pop	ebx
		pop	ebp
		retn
sub_404D51	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40505B	proc near		; DATA XREF: .data:004442ACo

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	eax, ds:dword_451154
		test	eax, eax
		jz	short loc_4050C5
		mov	eax, [ebp+var_10]
		mov	edx, [eax+4]
		mov	eax, ds:dword_451154
		cmp	edx, eax
		jz	short loc_4050C5
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_4050C5
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_4050C5
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_4050C5
		mov	[esp+48h+var_48], 0ADh
		call	sub_40374B
		jmp	loc_40522E
; ---------------------------------------------------------------------------

loc_4050C5:				; CODE XREF: sub_40505B+1Cj
					; sub_40505B+2Bj ...
		mov	[esp+48h+var_44], 0 ; char *
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_403EBF
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4050E9
		mov	eax, [ebp+var_C]
		jmp	loc_40522E
; ---------------------------------------------------------------------------

loc_4050E9:				; CODE XREF: sub_40505B+84j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_405104
		mov	[esp+48h+var_48], 7Ch
		call	sub_40374B
		jmp	loc_40522E
; ---------------------------------------------------------------------------

loc_405104:				; CODE XREF: sub_40505B+96j
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	gcry_strdup
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_405122
		call	sub_403788
		jmp	loc_40522E
; ---------------------------------------------------------------------------

loc_405122:				; CODE XREF: sub_40505B+BBj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+14h]
		mov	ecx, eax
		mov	eax, [ebp+var_10]
		mov	edx, [eax+10h]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		lea	ebx, [ebp+var_20]
		mov	[esp+48h+var_2C], ebx
		lea	ebx, [ebp+var_1C]
		mov	[esp+48h+var_30], ebx
		mov	[esp+48h+var_34], ecx
		mov	[esp+48h+var_38], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], offset sub_404B75
		mov	edx, [ebp+var_14]
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	sub_40F5A3
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_40519B
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aApp_authFailed ; "app_auth failed: %s\n"
		call	sub_43CB21
		jmp	short loc_4051CD
; ---------------------------------------------------------------------------

loc_40519B:				; CODE XREF: sub_40505B+121j
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_4051CD
		mov	eax, [ebp+var_C]
		jmp	short loc_40522E
; ---------------------------------------------------------------------------

loc_4051CD:				; CODE XREF: sub_40505B+13Ej
					; sub_40505B+16Bj
		mov	eax, [ebp+var_C]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 70h
		jz	short loc_405215
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 6Eh
		jz	short loc_405215
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 6Dh
		jz	short loc_405215
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 8050h
		jnz	short loc_40522B

loc_405215:				; CODE XREF: sub_40505B+186j
					; sub_40505B+196j ...
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	[esp+48h+var_44], 1
		mov	[esp+48h+var_48], eax
		call	sub_4037C0

loc_40522B:				; CODE XREF: sub_40505B+1B8j
		mov	eax, [ebp+var_C]

loc_40522E:				; CODE XREF: sub_40505B+65j
					; sub_40505B+89j ...
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_40505B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405234	proc near		; DATA XREF: .data:004442B8o

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	eax, ds:dword_451154
		test	eax, eax
		jz	short loc_40529E
		mov	eax, [ebp+var_10]
		mov	edx, [eax+4]
		mov	eax, ds:dword_451154
		cmp	edx, eax
		jz	short loc_40529E
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40529E
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40529E
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_40529E
		mov	[esp+48h+var_48], 0ADh
		call	sub_40374B
		jmp	loc_4053EC
; ---------------------------------------------------------------------------

loc_40529E:				; CODE XREF: sub_405234+1Cj
					; sub_405234+2Bj ...
		mov	[esp+48h+var_44], 0 ; char *
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_403EBF
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4052C2
		mov	eax, [ebp+var_C]
		jmp	loc_4053EC
; ---------------------------------------------------------------------------

loc_4052C2:				; CODE XREF: sub_405234+84j
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	gcry_strdup
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4052E0
		call	sub_403788
		jmp	loc_4053EC
; ---------------------------------------------------------------------------

loc_4052E0:				; CODE XREF: sub_405234+A0j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+14h]
		mov	ecx, eax
		mov	eax, [ebp+var_10]
		mov	edx, [eax+10h]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		lea	ebx, [ebp+var_20]
		mov	[esp+48h+var_2C], ebx
		lea	ebx, [ebp+var_1C]
		mov	[esp+48h+var_30], ebx
		mov	[esp+48h+var_34], ecx
		mov	[esp+48h+var_38], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], offset sub_404B75
		mov	edx, [ebp+var_14]
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	sub_40F6B0
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_405359
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aApp_decipherFa ; "app_decipher failed: %s\n"
		call	sub_43CB21
		jmp	short loc_40538B
; ---------------------------------------------------------------------------

loc_405359:				; CODE XREF: sub_405234+106j
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_40538B
		mov	eax, [ebp+var_C]
		jmp	short loc_4053EC
; ---------------------------------------------------------------------------

loc_40538B:				; CODE XREF: sub_405234+123j
					; sub_405234+150j
		mov	eax, [ebp+var_C]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 70h
		jz	short loc_4053D3
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 6Eh
		jz	short loc_4053D3
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 6Dh
		jz	short loc_4053D3
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 8050h
		jnz	short loc_4053E9

loc_4053D3:				; CODE XREF: sub_405234+16Bj
					; sub_405234+17Bj ...
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	[esp+48h+var_44], 1
		mov	[esp+48h+var_48], eax
		call	sub_4037C0

loc_4053E9:				; CODE XREF: sub_405234+19Dj
		mov	eax, [ebp+var_C]

loc_4053EC:				; CODE XREF: sub_405234+65j
					; sub_405234+89j ...
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_405234	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4053F2	proc near		; DATA XREF: .data:004442DCo

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_get_pointer
		mov	[ebp+var_C], eax
		mov	[esp+28h+var_24], 0 ; char *
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_403EBF
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40542A
		mov	eax, [ebp+var_10]
		jmp	locret_4054E8
; ---------------------------------------------------------------------------

loc_40542A:				; CODE XREF: sub_4053F2+2Ej
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		jmp	short loc_405436
; ---------------------------------------------------------------------------

loc_405432:				; CODE XREF: sub_4053F2+60j
		add	[ebp+arg_4], 1

loc_405436:				; CODE XREF: sub_4053F2+3Ej
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405454
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_405454
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_405432

loc_405454:				; CODE XREF: sub_4053F2+4Cj
					; sub_4053F2+56j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405468
		mov	eax, [ebp+arg_4]
		mov	byte ptr [eax],	0
		add	[ebp+arg_4], 1

loc_405468:				; CODE XREF: sub_4053F2+6Aj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+var_14]
		mov	[esp+28h+var_20], edx ;	char *
		mov	edx, [ebp+var_C]
		mov	[esp+28h+var_24], edx ;	int
		mov	[esp+28h+var_28], eax ;	int
		call	sub_40F1D4
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	sub_403766
		cmp	eax, 70h
		jz	short loc_4054CF
		mov	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	sub_403766
		cmp	eax, 6Eh
		jz	short loc_4054CF
		mov	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	sub_403766
		cmp	eax, 6Dh
		jz	short loc_4054CF
		mov	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	sub_403766
		cmp	eax, 8050h
		jnz	short loc_4054E5

loc_4054CF:				; CODE XREF: sub_4053F2+A9j
					; sub_4053F2+B9j ...
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[esp+28h+var_24], 1
		mov	[esp+28h+var_28], eax
		call	sub_4037C0

loc_4054E5:				; CODE XREF: sub_4053F2+DBj
		mov	eax, [ebp+var_10]

locret_4054E8:				; CODE XREF: sub_4053F2+33j
		leave
		retn
sub_4053F2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4054EA	proc near		; DATA XREF: .data:004442E8o

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_get_pointer
		mov	[ebp+var_14], eax
		mov	eax, ds:dword_451154
		test	eax, eax
		jz	short loc_405553
		mov	eax, [ebp+var_14]
		mov	edx, [eax+4]
		mov	eax, ds:dword_451154
		cmp	edx, eax
		jz	short loc_405553
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_405553
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_405553
		mov	eax, [ebp+var_14]
		mov	edx, [eax+8]
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_405553
		mov	[esp+48h+var_48], 0ADh
		call	sub_40374B
		jmp	locret_4056B8
; ---------------------------------------------------------------------------

loc_405553:				; CODE XREF: sub_4054EA+1Bj
					; sub_4054EA+2Aj ...
		mov	[esp+48h+var_44], 0 ; char *
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_403EBF
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_405577
		mov	eax, [ebp+var_18]
		jmp	locret_4056B8
; ---------------------------------------------------------------------------

loc_405577:				; CODE XREF: sub_4054EA+83j
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	gcry_strdup
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40559B
		call	sub_403788
		jmp	locret_4056B8
; ---------------------------------------------------------------------------

loc_40559B:				; CODE XREF: sub_4054EA+A5j
		mov	eax, [ebp+var_10]
		mov	[ebp+var_20], eax
		mov	[ebp+var_C], 0
		jmp	short loc_4055B2
; ---------------------------------------------------------------------------

loc_4055AA:				; CODE XREF: sub_4054EA+E4j
		add	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_4055B2:				; CODE XREF: sub_4054EA+BEj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4055D0
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4055D0
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_4055AA

loc_4055D0:				; CODE XREF: sub_4054EA+D0j
					; sub_4054EA+DAj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4055EC
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1
		jmp	short loc_4055EC
; ---------------------------------------------------------------------------

loc_4055E6:				; CODE XREF: sub_4054EA+10Bj
					; sub_4054EA+115j
		add	[ebp+var_10], 1
		jmp	short loc_4055ED
; ---------------------------------------------------------------------------

loc_4055EC:				; CODE XREF: sub_4054EA+EEj
					; sub_4054EA+FAj
		nop

loc_4055ED:				; CODE XREF: sub_4054EA+100j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4055E6
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jz	short loc_4055E6
		mov	[esp+48h+var_44], 0
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	sub_42A351
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+var_24]
		mov	[esp+48h+var_34], edx
		mov	edx, [ebp+var_10]
		mov	[esp+48h+var_38], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], offset sub_404B75
		mov	edx, [ebp+var_20]
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	sub_40F3BF
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 70h
		jz	short loc_40569F
		mov	eax, [ebp+var_28]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 6Eh
		jz	short loc_40569F
		mov	eax, [ebp+var_28]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 6Dh
		jz	short loc_40569F
		mov	eax, [ebp+var_28]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 8050h
		jnz	short loc_4056B5

loc_40569F:				; CODE XREF: sub_4054EA+181j
					; sub_4054EA+191j ...
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	[esp+48h+var_44], 1
		mov	[esp+48h+var_48], eax
		call	sub_4037C0

loc_4056B5:				; CODE XREF: sub_4054EA+1B3j
		mov	eax, [ebp+var_18]

locret_4056B8:				; CODE XREF: sub_4054EA+64j
					; sub_4054EA+88j ...
		leave
		retn
sub_4054EA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4056BA	proc near		; DATA XREF: .data:004442F4o

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_get_pointer
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_451154
		test	eax, eax
		jz	short loc_405723
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, ds:dword_451154
		cmp	edx, eax
		jz	short loc_405723
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_405723
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_405723
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_405723
		mov	[esp+48h+var_48], 0ADh
		call	sub_40374B
		jmp	locret_4058E8
; ---------------------------------------------------------------------------

loc_405723:				; CODE XREF: sub_4056BA+1Bj
					; sub_4056BA+2Aj ...
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	sub_403967
		mov	[ebp+arg_4], eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_405763
		mov	[esp+48h+var_48], 118h
		call	sub_40374B
		mov	[esp+48h+var_40], offset aNoCertidGiven	; "no certid given"
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_set_error
		jmp	locret_4058E8
; ---------------------------------------------------------------------------

loc_405763:				; CODE XREF: sub_4056BA+7Fj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		jmp	short loc_40576F
; ---------------------------------------------------------------------------

loc_40576B:				; CODE XREF: sub_4056BA+D1j
		add	[ebp+arg_4], 1

loc_40576F:				; CODE XREF: sub_4056BA+AFj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40578D
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40578D
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_40576B

loc_40578D:				; CODE XREF: sub_4056BA+BDj
					; sub_4056BA+C7j
		mov	eax, [ebp+arg_4]
		mov	byte ptr [eax],	0
		mov	[esp+48h+var_44], 0 ; char *
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_403EBF
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_4057B7
		mov	eax, [ebp+var_14]
		jmp	locret_4058E8
; ---------------------------------------------------------------------------

loc_4057B7:				; CODE XREF: sub_4056BA+F3j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_4057D2
		mov	[esp+48h+var_48], 7Ch
		call	sub_40374B
		jmp	locret_4058E8
; ---------------------------------------------------------------------------

loc_4057D2:				; CODE XREF: sub_4056BA+105j
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_strdup
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4057F0
		call	sub_403788
		jmp	locret_4058E8
; ---------------------------------------------------------------------------

loc_4057F0:				; CODE XREF: sub_4056BA+12Aj
		mov	[esp+48h+var_38], 4000h
		lea	eax, [ebp+var_20]
		mov	[esp+48h+var_3C], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+var_44], offset aCertdata ; "CERTDATA"
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_inquire
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_405835
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		jmp	locret_4058E8
; ---------------------------------------------------------------------------

loc_405835:				; CODE XREF: sub_4056BA+166j
		mov	ecx, [ebp+var_20]
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	[esp+48h+var_30], ecx
		mov	[esp+48h+var_34], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+48h+var_38], edx
		mov	[esp+48h+var_3C], offset sub_404B75
		mov	edx, [ebp+var_10]
		mov	[esp+48h+var_40], edx
		mov	edx, [ebp+var_C]
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	sub_40F7BD
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 70h
		jz	short loc_4058CF
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 6Eh
		jz	short loc_4058CF
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 6Dh
		jz	short loc_4058CF
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 8050h
		jnz	short loc_4058E5

loc_4058CF:				; CODE XREF: sub_4056BA+1E1j
					; sub_4056BA+1F1j ...
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[esp+48h+var_44], 1
		mov	[esp+48h+var_48], eax
		call	sub_4037C0

loc_4058E5:				; CODE XREF: sub_4056BA+213j
		mov	eax, [ebp+var_14]

locret_4058E8:				; CODE XREF: sub_4056BA+64j
					; sub_4056BA+A4j ...
		leave
		retn
sub_4056BA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4058EA(int, char *)
sub_4058EA	proc near		; DATA XREF: .data:00444300o

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_get_pointer
		mov	[ebp+var_C], eax
		mov	[esp+48h+var_44], offset aForce	; "--force"
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_40381B
		mov	[ebp+var_10], eax
		mov	eax, ds:dword_451154
		test	eax, eax
		jz	short loc_40596A
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, ds:dword_451154
		cmp	edx, eax
		jz	short loc_40596A
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40596A
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40596A
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_40596A
		mov	[esp+48h+var_48], 0ADh
		call	sub_40374B
		jmp	loc_405B53
; ---------------------------------------------------------------------------

loc_40596A:				; CODE XREF: sub_4058EA+32j
					; sub_4058EA+41j ...
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	sub_403967
		mov	[ebp+arg_4], eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4059AA
		mov	[esp+48h+var_48], 118h
		call	sub_40374B
		mov	[esp+48h+var_40], offset aNoKeyidGiven ; "no keyid given"
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_set_error
		jmp	loc_405B53
; ---------------------------------------------------------------------------

loc_4059AA:				; CODE XREF: sub_4058EA+96j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		jmp	short loc_4059B6
; ---------------------------------------------------------------------------

loc_4059B2:				; CODE XREF: sub_4058EA+E8j
		add	[ebp+arg_4], 1

loc_4059B6:				; CODE XREF: sub_4058EA+C6j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4059D4
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_4059D4
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_4059B2

loc_4059D4:				; CODE XREF: sub_4058EA+D4j
					; sub_4058EA+DEj
		mov	eax, [ebp+arg_4]
		mov	byte ptr [eax],	0
		mov	[esp+48h+var_44], 0 ; char *
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_403EBF
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_4059FE
		mov	eax, [ebp+var_18]
		jmp	loc_405B53
; ---------------------------------------------------------------------------

loc_4059FE:				; CODE XREF: sub_4058EA+10Aj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_405A19
		mov	[esp+48h+var_48], 7Ch
		call	sub_40374B
		jmp	loc_405B53
; ---------------------------------------------------------------------------

loc_405A19:				; CODE XREF: sub_4058EA+11Cj
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_strdup
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_405A37
		call	sub_403788
		jmp	loc_405B53
; ---------------------------------------------------------------------------

loc_405A37:				; CODE XREF: sub_4058EA+141j
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_begin_confidential
		mov	[esp+48h+var_38], 1000h
		lea	eax, [ebp+var_24]
		mov	[esp+48h+var_3C], eax
		lea	eax, [ebp+var_20]
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+var_44], offset aKeydata ; "KEYDATA"
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_inquire
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_end_confidential
		cmp	[ebp+var_18], 0
		jz	short loc_405A92
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		jmp	loc_405B53
; ---------------------------------------------------------------------------

loc_405A92:				; CODE XREF: sub_4058EA+193j
		mov	ebx, [ebp+var_24]
		mov	ecx, [ebp+var_20]
		cmp	[ebp+var_10], 0
		setnz	al
		movzx	edx, al
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	[esp+48h+var_2C], ebx
		mov	[esp+48h+var_30], ecx
		mov	ecx, [ebp+arg_0]
		mov	[esp+48h+var_34], ecx
		mov	[esp+48h+var_38], offset sub_404B75
		mov	[esp+48h+var_3C], edx
		mov	edx, [ebp+var_14]
		mov	[esp+48h+var_40], edx
		mov	edx, [ebp+var_C]
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	sub_40F8BA
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 70h
		jz	short loc_405B3A
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 6Eh
		jz	short loc_405B3A
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 6Dh
		jz	short loc_405B3A
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 8050h
		jnz	short loc_405B50

loc_405B3A:				; CODE XREF: sub_4058EA+21Cj
					; sub_4058EA+22Cj ...
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[esp+48h+var_44], 1
		mov	[esp+48h+var_48], eax
		call	sub_4037C0

loc_405B50:				; CODE XREF: sub_4058EA+24Ej
		mov	eax, [ebp+var_18]

loc_405B53:				; CODE XREF: sub_4058EA+7Bj
					; sub_4058EA+BBj ...
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_4058EA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405B59(int, char *)
sub_405B59	proc near		; DATA XREF: .data:0044430Co

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	eax, ds:dword_451154
		test	eax, eax
		jz	short loc_405BC2
		mov	eax, [ebp+var_10]
		mov	edx, [eax+4]
		mov	eax, ds:dword_451154
		cmp	edx, eax
		jz	short loc_405BC2
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_405BC2
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_405BC2
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_405BC2
		mov	[esp+48h+var_48], 0ADh
		call	sub_40374B
		jmp	locret_405DE8
; ---------------------------------------------------------------------------

loc_405BC2:				; CODE XREF: sub_405B59+1Bj
					; sub_405B59+2Aj ...
		mov	[esp+48h+var_44], offset aForce	; "--force"
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_40381B
		mov	[ebp+var_14], eax
		mov	[esp+48h+var_44], offset aTimestamp ; "--timestamp"
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_4038BA
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_405C65
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_405C26
		mov	[esp+48h+var_48], 118h
		call	sub_40374B
		mov	[esp+48h+var_40], offset aMissingValueFo ; "missing value for option"
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_set_error
		jmp	locret_405DE8
; ---------------------------------------------------------------------------

loc_405C26:				; CODE XREF: sub_405B59+A3j
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[esp+48h+var_48], eax
		call	sub_42A743
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jg	short loc_405C6C
		mov	[esp+48h+var_48], 118h
		call	sub_40374B
		mov	[esp+48h+var_40], offset aInvalidTimeVal ; "invalid time value"
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_set_error
		jmp	locret_405DE8
; ---------------------------------------------------------------------------

loc_405C65:				; CODE XREF: sub_405B59+99j
		mov	[ebp+var_C], 0

loc_405C6C:				; CODE XREF: sub_405B59+E2j
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	sub_403967
		mov	[ebp+arg_4], eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_405CAC
		mov	[esp+48h+var_48], 118h
		call	sub_40374B
		mov	[esp+48h+var_40], offset aNoKeyNumberGiv ; "no key number given"
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_set_error
		jmp	locret_405DE8
; ---------------------------------------------------------------------------

loc_405CAC:				; CODE XREF: sub_405B59+129j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], eax
		jmp	short loc_405CB8
; ---------------------------------------------------------------------------

loc_405CB4:				; CODE XREF: sub_405B59+17Bj
		add	[ebp+arg_4], 1

loc_405CB8:				; CODE XREF: sub_405B59+159j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405CD6
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_405CD6
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_405CB4

loc_405CD6:				; CODE XREF: sub_405B59+167j
					; sub_405B59+171j
		mov	eax, [ebp+arg_4]
		mov	byte ptr [eax],	0
		mov	[esp+48h+var_44], 0 ; char *
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_403EBF
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_405D00
		mov	eax, [ebp+var_20]
		jmp	locret_405DE8
; ---------------------------------------------------------------------------

loc_405D00:				; CODE XREF: sub_405B59+19Dj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_405D1B
		mov	[esp+48h+var_48], 7Ch
		call	sub_40374B
		jmp	locret_405DE8
; ---------------------------------------------------------------------------

loc_405D1B:				; CODE XREF: sub_405B59+1AFj
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_strdup
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_405D39
		call	sub_403788
		jmp	locret_405DE8
; ---------------------------------------------------------------------------

loc_405D39:				; CODE XREF: sub_405B59+1D4j
		cmp	[ebp+var_14], 0
		setnz	al
		movzx	edx, al
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	ecx, [ebp+arg_0]
		mov	[esp+48h+var_30], ecx
		mov	[esp+48h+var_34], offset sub_404B75
		mov	ecx, [ebp+var_C]
		mov	[esp+48h+var_38], ecx
		mov	[esp+48h+var_3C], edx
		mov	edx, [ebp+var_1C]
		mov	[esp+48h+var_40], edx
		mov	edx, [ebp+var_10]
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	sub_40F9BE
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 70h
		jz	short loc_405DCF
		mov	eax, [ebp+var_24]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 6Eh
		jz	short loc_405DCF
		mov	eax, [ebp+var_24]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 6Dh
		jz	short loc_405DCF
		mov	eax, [ebp+var_24]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 8050h
		jnz	short loc_405DE5

loc_405DCF:				; CODE XREF: sub_405B59+242j
					; sub_405B59+252j ...
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	[esp+48h+var_44], 1
		mov	[esp+48h+var_48], eax
		call	sub_4037C0

loc_405DE5:				; CODE XREF: sub_405B59+274j
		mov	eax, [ebp+var_20]

locret_405DE8:				; CODE XREF: sub_405B59+64j
					; sub_405B59+C8j ...
		leave
		retn
sub_405B59	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405DEA(int, char *)
sub_405DEA	proc near		; DATA XREF: .data:00444318o

Str		= dword	ptr -38h
EndPtr		= dword	ptr -34h
Radix		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	assuan_get_pointer
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_405E30
		mov	[esp+38h+Str], 118h
		call	sub_40374B
		mov	[esp+38h+Radix], offset	aNumberOfReques	; "number of requested bytes missing"
		mov	[esp+38h+EndPtr], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	assuan_set_error
		jmp	locret_405F68
; ---------------------------------------------------------------------------

loc_405E30:				; CODE XREF: sub_405DEA+1Cj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Radix], 0 ; Radix
		mov	[esp+38h+EndPtr], 0 ; EndPtr
		mov	[esp+38h+Str], eax ; Str
		call	strtoul
		mov	[ebp+var_10], eax
		mov	[esp+38h+EndPtr], 0 ; char *
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; int
		call	sub_403EBF
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_405E72
		mov	eax, [ebp+var_14]
		jmp	locret_405F68
; ---------------------------------------------------------------------------

loc_405E72:				; CODE XREF: sub_405DEA+7Ej
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_405E8D
		mov	[esp+38h+Str], 7Ch
		call	sub_40374B
		jmp	locret_405F68
; ---------------------------------------------------------------------------

loc_405E8D:				; CODE XREF: sub_405DEA+90j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax
		call	gcry_malloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_405EAB
		call	sub_403788
		jmp	locret_405F68
; ---------------------------------------------------------------------------

loc_405EAB:				; CODE XREF: sub_405DEA+B5j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+var_18]
		mov	[esp+38h+Radix], edx ; void *
		mov	edx, [ebp+var_10]
		mov	[esp+38h+EndPtr], edx ;	int
		mov	[esp+38h+Str], eax ; int
		call	sub_40FABB
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_405EFC
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Radix], eax
		mov	eax, [ebp+var_18]
		mov	[esp+38h+EndPtr], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	assuan_send_data
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		jmp	short locret_405F68
; ---------------------------------------------------------------------------

loc_405EFC:				; CODE XREF: sub_405DEA+E4j
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Str], eax
		call	sub_403766
		cmp	eax, 70h
		jz	short loc_405F4F
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Str], eax
		call	sub_403766
		cmp	eax, 6Eh
		jz	short loc_405F4F
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Str], eax
		call	sub_403766
		cmp	eax, 6Dh
		jz	short loc_405F4F
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Str], eax
		call	sub_403766
		cmp	eax, 8050h
		jnz	short loc_405F65

loc_405F4F:				; CODE XREF: sub_405DEA+131j
					; sub_405DEA+141j ...
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[esp+38h+EndPtr], 1
		mov	[esp+38h+Str], eax
		call	sub_4037C0

loc_405F65:				; CODE XREF: sub_405DEA+163j
		mov	eax, [ebp+var_14]

locret_405F68:				; CODE XREF: sub_405DEA+41j
					; sub_405DEA+83j ...
		leave
		retn
sub_405DEA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405F6A(int, char *)
sub_405F6A	proc near		; DATA XREF: .data:00444324o

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		mov	[esp+48h+var_44], offset aReset	; "--reset"
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_40381B
		test	eax, eax
		jz	short loc_405FA0
		or	[ebp+var_C], 1

loc_405FA0:				; CODE XREF: sub_405F6A+30j
		mov	[esp+48h+var_44], offset aNullpin ; "--nullpin"
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_40381B
		test	eax, eax
		jz	short loc_405FBB
		or	[ebp+var_C], 2

loc_405FBB:				; CODE XREF: sub_405F6A+4Bj
		mov	eax, ds:dword_451154
		test	eax, eax
		jz	short loc_406010
		mov	eax, [ebp+var_10]
		mov	edx, [eax+4]
		mov	eax, ds:dword_451154
		cmp	edx, eax
		jz	short loc_406010
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_406010
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_406010
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_406010
		mov	[esp+48h+var_48], 0ADh
		call	sub_40374B
		jmp	locret_40619F
; ---------------------------------------------------------------------------

loc_406010:				; CODE XREF: sub_405F6A+58j
					; sub_405F6A+67j ...
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	sub_403967
		mov	[ebp+arg_4], eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_406050
		mov	[esp+48h+var_48], 118h
		call	sub_40374B
		mov	[esp+48h+var_40], offset aNoChvNumberGiv ; "no CHV number given"
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	assuan_set_error
		jmp	locret_40619F
; ---------------------------------------------------------------------------

loc_406050:				; CODE XREF: sub_405F6A+BCj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		jmp	short loc_40605C
; ---------------------------------------------------------------------------

loc_406058:				; CODE XREF: sub_405F6A+10Ej
		add	[ebp+arg_4], 1

loc_40605C:				; CODE XREF: sub_405F6A+ECj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40607A
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40607A
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 9
		jnz	short loc_406058

loc_40607A:				; CODE XREF: sub_405F6A+FAj
					; sub_405F6A+104j
		mov	eax, [ebp+arg_4]
		mov	byte ptr [eax],	0
		mov	[esp+48h+var_44], 0 ; char *
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_403EBF
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_4060A4
		mov	eax, [ebp+var_18]
		jmp	locret_40619F
; ---------------------------------------------------------------------------

loc_4060A4:				; CODE XREF: sub_405F6A+130j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_4060BF
		mov	[esp+48h+var_48], 7Ch
		call	sub_40374B
		jmp	locret_40619F
; ---------------------------------------------------------------------------

loc_4060BF:				; CODE XREF: sub_405F6A+142j
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_strdup
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4060DD
		call	sub_403788
		jmp	locret_40619F
; ---------------------------------------------------------------------------

loc_4060DD:				; CODE XREF: sub_405F6A+167j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	ecx, [ebp+arg_0]
		mov	[esp+48h+var_34], ecx
		mov	[esp+48h+var_38], offset sub_404B75
		mov	[esp+48h+var_3C], edx
		mov	edx, [ebp+var_14]
		mov	[esp+48h+var_40], edx
		mov	edx, [ebp+var_10]
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	sub_40FB4E
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_406133
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aCommandPasswdF ; "command passwd failed: %s\n"
		call	sub_43CB21

loc_406133:				; CODE XREF: sub_405F6A+1ACj
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 70h
		jz	short loc_406186
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 6Eh
		jz	short loc_406186
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 6Dh
		jz	short loc_406186
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	sub_403766
		cmp	eax, 8050h
		jnz	short loc_40619C

loc_406186:				; CODE XREF: sub_405F6A+1E8j
					; sub_405F6A+1F8j ...
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	[esp+48h+var_44], 1
		mov	[esp+48h+var_48], eax
		call	sub_4037C0

loc_40619C:				; CODE XREF: sub_405F6A+21Aj
		mov	eax, [ebp+var_18]

locret_40619F:				; CODE XREF: sub_405F6A+A1j
					; sub_405F6A+E1j ...
		leave
		retn
sub_405F6A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4061A1	proc near		; DATA XREF: .data:00444330o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_get_pointer
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_451154
		test	eax, eax
		jz	short loc_40620A
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, ds:dword_451154
		cmp	edx, eax
		jz	short loc_40620A
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40620A
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40620A
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_40620A
		mov	[esp+28h+var_28], 0ADh
		call	sub_40374B
		jmp	locret_40631B
; ---------------------------------------------------------------------------

loc_40620A:				; CODE XREF: sub_4061A1+1Bj
					; sub_4061A1+2Aj ...
		mov	[esp+28h+var_24], 0 ; char *
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_403EBF
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40622E
		mov	eax, [ebp+var_10]
		jmp	locret_40631B
; ---------------------------------------------------------------------------

loc_40622E:				; CODE XREF: sub_4061A1+83j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_406249
		mov	[esp+28h+var_28], 7Ch
		call	sub_40374B
		jmp	locret_40631B
; ---------------------------------------------------------------------------

loc_406249:				; CODE XREF: sub_4061A1+95j
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	gcry_strdup
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_406267
		call	sub_403788
		jmp	locret_40631B
; ---------------------------------------------------------------------------

loc_406267:				; CODE XREF: sub_4061A1+BAj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], offset sub_404B75
		mov	edx, [ebp+var_14]
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	sub_40FC44
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		cmp	[ebp+var_10], 0
		jz	short loc_4062BA
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	[esp+28h+var_24], eax ;	char
		mov	[esp+28h+var_28], offset aApp_check_pinF ; "app_check_pin failed: %s\n"
		call	sub_43CB21

loc_4062BA:				; CODE XREF: sub_4061A1+FCj
		mov	eax, [ebp+var_10]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	sub_403766
		cmp	eax, 70h
		jz	short loc_406302
		mov	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	sub_403766
		cmp	eax, 6Eh
		jz	short loc_406302
		mov	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	sub_403766
		cmp	eax, 6Dh
		jz	short loc_406302
		mov	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	sub_403766
		cmp	eax, 8050h
		jnz	short loc_406318

loc_406302:				; CODE XREF: sub_4061A1+12Dj
					; sub_4061A1+13Dj ...
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[esp+28h+var_24], 1
		mov	[esp+28h+var_28], eax
		call	sub_4037C0

loc_406318:				; CODE XREF: sub_4061A1+15Fj
		mov	eax, [ebp+var_10]

locret_40631B:				; CODE XREF: sub_4061A1+64j
					; sub_4061A1+88j ...
		leave
		retn
sub_4061A1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40631D(int, char *)
sub_40631D	proc near		; DATA XREF: .data:0044433Co

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0

loc_406338:				; CODE XREF: sub_40631D+7Fj
		mov	eax, ds:dword_451154
		test	eax, eax
		jz	short loc_406361
		mov	eax, [ebp+var_10]
		mov	edx, [eax+4]
		mov	eax, ds:dword_451154
		cmp	edx, eax
		jz	short loc_40636C
		mov	[esp+28h+var_28], 0ADh
		call	sub_40374B
		mov	[ebp+var_C], eax
		jmp	short loc_40636C
; ---------------------------------------------------------------------------

loc_406361:				; CODE XREF: sub_40631D+22j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	ds:dword_451154, eax

loc_40636C:				; CODE XREF: sub_40631D+31j
					; sub_40631D+42j
		cmp	[ebp+var_C], 0
		jz	short loc_40639E
		mov	[esp+28h+var_24], offset aWait ; "--wait"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax ;	char *
		call	sub_40381B
		test	eax, eax
		jz	short loc_40639E
		mov	[ebp+var_C], 0
		mov	[esp+28h+var_28], 1
		call	pth_sleep
		jmp	short loc_406338
; ---------------------------------------------------------------------------

loc_40639E:				; CODE XREF: sub_40631D+53j
					; sub_40631D+6Aj
		cmp	[ebp+var_C], 0
		jz	short loc_4063BF
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	[esp+28h+var_24], eax ;	char
		mov	[esp+28h+var_28], offset aCmd_lockFailed ; "cmd_lock failed: %s\n"
		call	sub_43CB21

loc_4063BF:				; CODE XREF: sub_40631D+85j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40631D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4063C4	proc near		; DATA XREF: .data:00444348o

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_get_pointer
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		mov	eax, ds:dword_451154
		test	eax, eax
		jz	short loc_406414
		mov	eax, [ebp+var_10]
		mov	edx, [eax+4]
		mov	eax, ds:dword_451154
		cmp	edx, eax
		jz	short loc_406408
		mov	[esp+28h+var_28], 0ADh
		call	sub_40374B
		mov	[ebp+var_C], eax
		jmp	short loc_406423
; ---------------------------------------------------------------------------

loc_406408:				; CODE XREF: sub_4063C4+31j
		mov	ds:dword_451154, 0
		jmp	short loc_406423
; ---------------------------------------------------------------------------

loc_406414:				; CODE XREF: sub_4063C4+22j
		mov	[esp+28h+var_28], 0A7h
		call	sub_40374B
		mov	[ebp+var_C], eax

loc_406423:				; CODE XREF: sub_4063C4+42j
					; sub_4063C4+4Ej
		cmp	[ebp+var_C], 0
		jz	short loc_406444
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aCmd_unlockFail ; "cmd_unlock failed: %s\n"
		call	sub_43CB21

loc_406444:				; CODE XREF: sub_4063C4+63j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4063C4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406449	proc near		; DATA XREF: .data:00444354o

var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_6C		= dword	ptr -6Ch
var_5B		= byte ptr -5Bh
var_29		= byte ptr -29h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		add	esp, 0FFFFFF80h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aVersion ; "version"
		mov	ecx, 8
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4064C4
		mov	[ebp+var_10], offset a2_0_30_0 ; "2.0.30"
		mov	eax, [ebp+var_10]
		mov	[ebp+var_6C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_6C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+var_10]
		mov	[esp+88h+var_84], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+var_88], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		jmp	loc_406836
; ---------------------------------------------------------------------------

loc_4064C4:				; CODE XREF: sub_406449+35j
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aPid ; "pid"
		mov	ecx, 4
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40654D
		call	_getpid
		mov	[esp+88h+var_7C], eax
		mov	[esp+88h+var_80], offset aLu ; "%lu"
		mov	[esp+88h+var_84], 32h
		lea	eax, [ebp+var_5B]
		mov	[esp+88h+var_88], eax
		call	sub_429C1D
		lea	eax, [ebp+var_5B]
		mov	[ebp+var_6C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_6C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+88h+var_80], eax
		lea	eax, [ebp+var_5B]
		mov	[esp+88h+var_84], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+var_88], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		jmp	loc_406836
; ---------------------------------------------------------------------------

loc_40654D:				; CODE XREF: sub_406449+A1j
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aSocket_name ; "socket_name"
		mov	ecx, 0Ch
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4065D4
		call	sub_402BC2
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_4065C0
		mov	eax, [ebp+var_14]
		mov	[ebp+var_6C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_6C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+var_14]
		mov	[esp+88h+var_84], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+var_88], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		jmp	loc_406836
; ---------------------------------------------------------------------------

loc_4065C0:				; CODE XREF: sub_406449+138j
		mov	[esp+88h+var_88], 3Ah
		call	sub_40374B
		mov	[ebp+var_C], eax
		jmp	loc_406836
; ---------------------------------------------------------------------------

loc_4065D4:				; CODE XREF: sub_406449+12Aj
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aStatus ; "status"
		mov	ecx, 7
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	loc_4066B2
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+var_88], eax
		call	assuan_get_pointer
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_29], 72h
		mov	eax, [ebp+var_18]
		mov	eax, [eax+4]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_406690
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jz	short loc_406690
		cmp	[ebp+var_1C], 0
		js	short loc_40663C
		mov	eax, [ebp+var_1C]
		cmp	eax, 9
		jbe	short loc_406658

loc_40663C:				; CODE XREF: sub_406449+1E9j
		mov	[esp+88h+var_80], offset aCmd_getinfo ;	"cmd_getinfo"
		mov	[esp+88h+var_84], 69Dh
		mov	[esp+88h+var_88], offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/scd/command.c"
		call	sub_43CCB0
; ---------------------------------------------------------------------------

loc_406658:				; CODE XREF: sub_406449+1F1j
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, offset dword_451060
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_406690
		mov	eax, [ebp+var_20]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_406690
		mov	eax, [ebp+var_20]
		mov	eax, [eax+10h]
		and	eax, 1
		test	al, al
		jz	short loc_406690
		mov	[ebp+var_29], 75h

loc_406690:				; CODE XREF: sub_406449+1DDj
					; sub_406449+1E3j ...
		mov	[esp+88h+var_80], 1
		lea	eax, [ebp+var_29]
		mov	[esp+88h+var_84], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+var_88], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		jmp	loc_406836
; ---------------------------------------------------------------------------

loc_4066B2:				; CODE XREF: sub_406449+1B1j
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aReader_list ; "reader_list"
		mov	ecx, 0Ch
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_406740
		mov	[ebp+var_24], 0
		cmp	[ebp+var_24], 0
		jz	short loc_406721
		mov	eax, [ebp+var_24]
		mov	[ebp+var_6C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_6C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+var_24]
		mov	[esp+88h+var_84], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+var_88], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		jmp	short loc_406730
; ---------------------------------------------------------------------------

loc_406721:				; CODE XREF: sub_406449+29Cj
		mov	[esp+88h+var_88], 3Ah
		call	sub_40374B
		mov	[ebp+var_C], eax

loc_406730:				; CODE XREF: sub_406449+2D6j
		mov	eax, [ebp+var_24]
		mov	[esp+88h+var_88], eax
		call	gcry_free
		jmp	loc_406836
; ---------------------------------------------------------------------------

loc_406740:				; CODE XREF: sub_406449+28Fj
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aDeny_admin	; "deny_admin"
		mov	ecx, 0Bh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40678C
		mov	eax, ds:dword_451D50
		test	eax, eax
		jz	short loc_40677F
		mov	[esp+88h+var_88], 1
		call	sub_40374B
		jmp	short loc_406784
; ---------------------------------------------------------------------------

loc_40677F:				; CODE XREF: sub_406449+326j
		mov	eax, 0

loc_406784:				; CODE XREF: sub_406449+334j
		mov	[ebp+var_C], eax
		jmp	loc_406836
; ---------------------------------------------------------------------------

loc_40678C:				; CODE XREF: sub_406449+31Dj
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aApp_list ;	"app_list"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_406810
		call	sub_40EBA8
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jz	short loc_4067FC
		mov	eax, [ebp+var_28]
		mov	[ebp+var_6C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_6C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+var_28]
		mov	[esp+88h+var_84], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+var_88], eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		jmp	short loc_406803
; ---------------------------------------------------------------------------

loc_4067FC:				; CODE XREF: sub_406449+377j
		mov	[ebp+var_C], 0

loc_406803:				; CODE XREF: sub_406449+3B1j
		mov	eax, [ebp+var_28]
		mov	[esp+88h+var_88], eax
		call	gcry_free
		jmp	short loc_406836
; ---------------------------------------------------------------------------

loc_406810:				; CODE XREF: sub_406449+369j
		mov	[esp+88h+var_88], 118h
		call	sub_40374B
		mov	[esp+88h+var_80], offset aUnknownValueFo ; "unknown value for WHAT"
		mov	[esp+88h+var_84], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+var_88], eax
		call	assuan_set_error
		mov	[ebp+var_C], eax

loc_406836:				; CODE XREF: sub_406449+76j
					; sub_406449+FFj ...
		mov	eax, [ebp+var_C]
		sub	esp, 0FFFFFF80h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_406449	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406840	proc near		; DATA XREF: .data:00444360o

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_get_pointer
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_406876
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	[esp+28h+var_28], eax
		call	sub_40ECE7
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+0Ch], 0

loc_406876:				; CODE XREF: sub_406840+1Cj
		mov	eax, ds:dword_451154
		test	eax, eax
		jz	short loc_4068A4
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, ds:dword_451154
		cmp	edx, eax
		jnz	short loc_4068A4
		mov	ds:dword_451154, 0
		mov	[esp+28h+var_28], offset aImplicitlyUn_0 ; "implicitly unlocking due to	RESTART\n"
		call	sub_43CAF7

loc_4068A4:				; CODE XREF: sub_406840+3Dj
					; sub_406840+4Cj
		mov	eax, 0
		leave
		retn
sub_406840	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4068AB	proc near		; DATA XREF: .data:0044436Co

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_get_pointer
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	dword ptr [eax+18h], 1
		mov	eax, 0
		leave
		retn
sub_4068AB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4068D3(int, char *)
sub_4068D3	proc near		; DATA XREF: .data:00444378o

Str		= dword	ptr -208h
EndPtr		= dword	ptr -204h
Radix		= dword	ptr -200h
var_1FC		= dword	ptr -1FCh
var_1F8		= dword	ptr -1F8h
var_1F4		= dword	ptr -1F4h
var_1F0		= dword	ptr -1F0h
var_1DC		= dword	ptr -1DCh
var_1CC		= byte ptr -1CCh
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 204h
		mov	eax, [ebp+arg_0]
		mov	[esp+208h+Str],	eax
		call	assuan_get_pointer
		mov	[ebp+var_14], eax
		mov	[esp+208h+EndPtr], offset aAtr ; "--atr"
		mov	eax, [ebp+arg_4]
		mov	[esp+208h+Str],	eax ; char *
		call	sub_40381B
		mov	[ebp+var_18], eax
		mov	[esp+208h+EndPtr], offset aMore	; "--more"
		mov	eax, [ebp+arg_4]
		mov	[esp+208h+Str],	eax ; char *
		call	sub_40381B
		mov	[ebp+var_1C], eax
		mov	[esp+208h+EndPtr], offset aExlen ; "--exlen"
		mov	eax, [ebp+arg_4]
		mov	[esp+208h+Str],	eax ; char *
		call	sub_4038BA
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_406969
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	short loc_406960
		mov	eax, [ebp+var_20]
		add	eax, 1
		mov	[esp+208h+Radix], 0 ; Radix
		mov	[esp+208h+EndPtr], 0 ; EndPtr
		mov	[esp+208h+Str],	eax ; Str
		call	strtoul
		mov	[ebp+var_10], eax
		jmp	short loc_406970
; ---------------------------------------------------------------------------

loc_406960:				; CODE XREF: sub_4068D3+68j
		mov	[ebp+var_10], 1000h
		jmp	short loc_406970
; ---------------------------------------------------------------------------

loc_406969:				; CODE XREF: sub_4068D3+5Ej
		mov	[ebp+var_10], 0

loc_406970:				; CODE XREF: sub_4068D3+8Bj
					; sub_4068D3+94j
		mov	eax, [ebp+arg_4]
		mov	[esp+208h+Str],	eax
		call	sub_403967
		mov	[ebp+arg_4], eax
		mov	eax, ds:dword_451154
		test	eax, eax
		jz	short loc_4069D3
		mov	eax, [ebp+var_14]
		mov	edx, [eax+4]
		mov	eax, ds:dword_451154
		cmp	edx, eax
		jz	short loc_4069D3
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_4069D3
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_4069D3
		mov	eax, [ebp+var_14]
		mov	edx, [eax+8]
		mov	eax, ds:dword_451154
		mov	eax, [eax+4]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_4069D3
		mov	[esp+208h+Str],	0ADh
		call	sub_40374B
		jmp	loc_406BE8
; ---------------------------------------------------------------------------

loc_4069D3:				; CODE XREF: sub_4068D3+B2j
					; sub_4068D3+C1j ...
		mov	[esp+208h+EndPtr], 0 ; char *
		mov	eax, [ebp+var_14]
		mov	[esp+208h+Str],	eax ; int
		call	sub_403EBF
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4069F7
		mov	eax, [ebp+var_C]
		jmp	loc_406BE8
; ---------------------------------------------------------------------------

loc_4069F7:				; CODE XREF: sub_4068D3+11Aj
		cmp	[ebp+var_18], 0
		jz	loc_406ABD
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		lea	edx, [ebp+var_34]
		mov	[esp+208h+EndPtr], edx
		mov	[esp+208h+Str],	eax
		call	sub_40AEE3
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_406A29
		mov	eax, [ebp+var_34]
		cmp	eax, 18Eh
		jbe	short loc_406A3D

loc_406A29:				; CODE XREF: sub_4068D3+14Aj
		mov	[esp+208h+Str],	6Fh
		call	sub_40374B
		mov	[ebp+var_C], eax
		jmp	loc_406B87
; ---------------------------------------------------------------------------

loc_406A3D:				; CODE XREF: sub_4068D3+154j
		mov	eax, [ebp+var_34]
		lea	edx, [ebp+var_1CC]
		mov	[esp+208h+Radix], edx
		mov	[esp+208h+EndPtr], eax
		mov	eax, [ebp+var_24]
		mov	[esp+208h+Str],	eax
		call	sub_42BDA4
		mov	eax, [ebp+var_24]
		mov	[esp+208h+Str],	eax
		call	gcry_free
		lea	eax, [ebp+var_1CC]
		mov	[ebp+var_1DC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1DC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+208h+var_1F4], 0
		mov	[esp+208h+var_1F8], 0
		mov	[esp+208h+var_1FC], eax
		lea	eax, [ebp+var_1CC]
		mov	[esp+208h+Radix], eax
		mov	[esp+208h+EndPtr], offset aCardAtr ; "CARD-ATR"
		mov	eax, [ebp+var_14]
		mov	[esp+208h+Str],	eax
		call	sub_406FDB

loc_406ABD:				; CODE XREF: sub_4068D3+128j
		lea	eax, [ebp+var_30]
		mov	[esp+208h+EndPtr], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+208h+Str],	eax
		call	sub_4039CA
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_406AE5
		call	sub_403773
		mov	[ebp+var_C], eax
		jmp	loc_406B87
; ---------------------------------------------------------------------------

loc_406AE5:				; CODE XREF: sub_4068D3+203j
		mov	eax, [ebp+var_30]
		test	eax, eax
		jz	loc_406B7C
		mov	[ebp+var_38], 0
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		lea	ecx, [ebp+var_3C]
		mov	[esp+208h+var_1F0], ecx	; int
		lea	ecx, [ebp+var_38]
		mov	[esp+208h+var_1F4], ecx	; int
		mov	ecx, [ebp+var_1C]
		mov	[esp+208h+var_1F8], ecx	; int
		mov	[esp+208h+var_1FC], edx	; size_t
		mov	edx, [ebp+var_28]
		mov	[esp+208h+Radix], edx ;	void *
		mov	edx, [ebp+var_10]
		mov	[esp+208h+EndPtr], edx ; int
		mov	[esp+208h+Str],	eax ; char
		call	sub_40C143
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_406B55
		mov	eax, [ebp+var_C]
		mov	[esp+208h+Str],	eax
		call	gpg_strerror
		mov	[esp+208h+EndPtr], eax ; char
		mov	[esp+208h+Str],	offset aApdu_send_dire ; "apdu_send_direct failed: %s\n"
		call	sub_43CB21
		jmp	short loc_406B7C
; ---------------------------------------------------------------------------

loc_406B55:				; CODE XREF: sub_4068D3+263j
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+var_38]
		mov	[esp+208h+Radix], edx
		mov	[esp+208h+EndPtr], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+208h+Str],	eax
		call	assuan_send_data
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_38]
		mov	[esp+208h+Str],	eax
		call	gcry_free

loc_406B7C:				; CODE XREF: sub_4068D3+217j
					; sub_4068D3+280j
		mov	eax, [ebp+var_28]
		mov	[esp+208h+Str],	eax
		call	gcry_free

loc_406B87:				; CODE XREF: sub_4068D3+165j
					; sub_4068D3+20Dj
		mov	eax, [ebp+var_C]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+208h+Str],	eax
		call	sub_403766
		cmp	eax, 70h
		jz	short loc_406BCF
		mov	eax, [ebp+var_2C]
		mov	[esp+208h+Str],	eax
		call	sub_403766
		cmp	eax, 6Eh
		jz	short loc_406BCF
		mov	eax, [ebp+var_2C]
		mov	[esp+208h+Str],	eax
		call	sub_403766
		cmp	eax, 6Dh
		jz	short loc_406BCF
		mov	eax, [ebp+var_2C]
		mov	[esp+208h+Str],	eax
		call	sub_403766
		cmp	eax, 8050h
		jnz	short loc_406BE5

loc_406BCF:				; CODE XREF: sub_4068D3+2C8j
					; sub_4068D3+2D8j ...
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	[esp+208h+EndPtr], 1
		mov	[esp+208h+Str],	eax
		call	sub_4037C0

loc_406BE5:				; CODE XREF: sub_4068D3+2FAj
		mov	eax, [ebp+var_C]

loc_406BE8:				; CODE XREF: sub_4068D3+FBj
					; sub_4068D3+11Fj
		add	esp, 204h
		pop	edi
		pop	ebp
		retn
sub_4068D3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406BF1	proc near		; DATA XREF: .data:00444384o

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_get_pointer
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	dword ptr [eax+1Ch], 1
		mov	[esp+28h+var_28], 3FFFh
		call	sub_40374B
		leave
		retn
sub_406BF1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406C20	proc near		; CODE XREF: sub_406CEF+D3p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	[ebp+var_C], 0
		jmp	short loc_406C94
; ---------------------------------------------------------------------------

loc_406C30:				; CODE XREF: sub_406C20+89j
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_444260
		mov	ebx, [eax+8]
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_444260
		mov	ecx, [eax+4]
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_444260
		mov	eax, [eax]
		mov	[esp+28h+var_1C], ebx
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_register_command
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_406C90
		mov	eax, [ebp+var_10]
		jmp	short loc_406CE9
; ---------------------------------------------------------------------------

loc_406C90:				; CODE XREF: sub_406C20+69j
		add	[ebp+var_C], 1

loc_406C94:				; CODE XREF: sub_406C20+Ej
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_444260
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_406C30
		mov	[esp+28h+var_24], offset aGnuPrivacyGuar ; "GNU	Privacy	Guard's Smartcard server re"...
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_set_hello_line
		mov	[esp+28h+var_24], offset sub_403DA0
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_register_reset_notify
		mov	[esp+28h+var_24], offset sub_403DCE
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	assuan_register_option_handler
		mov	eax, 0

loc_406CE9:				; CODE XREF: sub_406C20+6Ej
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_406C20	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406CEF	proc near		; CODE XREF: sub_40303E+CBp

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_18], 0
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_38], eax
		call	assuan_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_406D37
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aFailedToAlloca ; "failed to allocate assuan context: %s\n"
		call	sub_43CB21
		mov	[esp+38h+var_38], 2
		call	sub_402B62
; ---------------------------------------------------------------------------

loc_406D37:				; CODE XREF: sub_406CEF+1Fj
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jnz	short loc_406D72
		mov	[esp+38h+var_38], 0
		call	assuan_fdopen
		mov	[ebp+var_20], eax
		mov	[esp+38h+var_38], 1
		call	assuan_fdopen
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+var_20]
		mov	dword ptr [esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		call	assuan_init_pipe_server
		mov	[ebp+var_C], eax
		jmp	short loc_406D8F
; ---------------------------------------------------------------------------

loc_406D72:				; CODE XREF: sub_406CEF+4Cj
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_30], 2
		mov	dword ptr [esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		call	assuan_init_socket_server
		mov	[ebp+var_C], eax

loc_406D8F:				; CODE XREF: sub_406CEF+81j
		cmp	[ebp+var_C], 0
		jz	short loc_406DBC
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aFailedToInitia ; "failed to initialize the server: %s\n"
		call	sub_43CB21
		mov	[esp+38h+var_38], 2
		call	sub_402B62
; ---------------------------------------------------------------------------

loc_406DBC:				; CODE XREF: sub_406CEF+A4j
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_38], eax
		call	sub_406C20
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_406DF7
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aFailedToRegist ; "failed to register commands	with Assuan"...
		call	sub_43CB21
		mov	[esp+38h+var_38], 2
		call	sub_402B62
; ---------------------------------------------------------------------------

loc_406DF7:				; CODE XREF: sub_406CEF+DFj
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+arg_0]
		mov	dword ptr [esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		call	assuan_set_pointer
		mov	dword ptr [esp+38h+var_34], 20h
		mov	[esp+38h+var_38], 1
		call	gcry_xcalloc
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, ds:dword_451150
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	ds:dword_451150, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_0]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_18]
		mov	[eax+8], edx
		mov	eax, ds:dword_451D20
		and	eax, 400h
		test	eax, eax
		jz	short loc_406E78
		call	sub_43C70D
		mov	edx, [ebp+var_18]
		mov	dword ptr [esp+38h+var_34], eax
		mov	[esp+38h+var_38], edx
		call	assuan_set_log_stream

loc_406E78:				; CODE XREF: sub_406CEF+173j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_406E91
		call	sub_403E56
		mov	edx, [ebp+arg_0]
		mov	[edx+8], eax
		jmp	short loc_406E91
; ---------------------------------------------------------------------------

loc_406E90:				; CODE XREF: sub_406CEF+1EBj
					; sub_406CEF+209j
		nop

loc_406E91:				; CODE XREF: sub_406CEF+192j
					; sub_406CEF+19Fj
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_38], eax
		call	assuan_accept
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	short loc_406EFA
		cmp	[ebp+var_C], 0
		jz	short loc_406EC8
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aAssuanAcceptPr ; "Assuan accept problem: %s\n"
		call	sub_43CAF7
		jmp	short loc_406EFB
; ---------------------------------------------------------------------------

loc_406EC8:				; CODE XREF: sub_406CEF+1BAj
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_38], eax
		call	assuan_process
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_406E90
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aAssuanProcessi ; "Assuan processing failed: %s\n"
		call	sub_43CAF7
		nop
		jmp	short loc_406E90
; ---------------------------------------------------------------------------

loc_406EFA:				; CODE XREF: sub_406CEF+1B4j
		nop

loc_406EFB:				; CODE XREF: sub_406CEF+1D7j
		mov	dword ptr [esp+38h+var_34], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_403BAA
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, ds:dword_451150
		cmp	edx, eax
		jnz	short loc_406F2C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	eax, [eax]
		mov	ds:dword_451150, eax
		jmp	short loc_406F8B
; ---------------------------------------------------------------------------

loc_406F2C:				; CODE XREF: sub_406CEF+22Cj
		mov	eax, ds:dword_451150
		mov	[ebp+var_10], eax
		jmp	short loc_406F4D
; ---------------------------------------------------------------------------

loc_406F36:				; CODE XREF: sub_406CEF+265j
		mov	eax, [ebp+var_10]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jz	short loc_406F58
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[ebp+var_10], eax

loc_406F4D:				; CODE XREF: sub_406CEF+245j
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_406F36
		jmp	short loc_406F59
; ---------------------------------------------------------------------------

loc_406F58:				; CODE XREF: sub_406CEF+254j
		nop

loc_406F59:				; CODE XREF: sub_406CEF+267j
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_406F7E
		mov	[esp+38h+var_30], offset aScd_command_ha ; "scd_command_handler"
		mov	dword ptr [esp+38h+var_34], 803h
		mov	[esp+38h+var_38], offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/scd/command.c"
		call	sub_43CCB0
; ---------------------------------------------------------------------------

loc_406F7E:				; CODE XREF: sub_406CEF+271j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx

loc_406F8B:				; CODE XREF: sub_406CEF+23Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_38], eax
		call	assuan_release
		cmp	[ebp+var_14], 0
		jz	short loc_406FCC
		mov	[esp+38h+var_38], 0
		call	sub_402B62
; ---------------------------------------------------------------------------

loc_406FCC:				; CODE XREF: sub_406CEF+2CFj
		mov	eax, ds:dword_451150
		test	eax, eax
		setz	al
		movzx	eax, al
		leave
		retn
sub_406CEF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406FDB	proc near		; CODE XREF: sub_4068D3+1E5p
					; sub_40EF3F+B5p ...

Dest		= dword	ptr -3E8h
Format		= dword	ptr -3E4h
var_3E0		= dword	ptr -3E0h
var_3D6		= byte ptr -3D6h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 3E8h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	eax, [eax+8]
		mov	[ebp+var_1C], eax
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_20]
		mov	[eax], edx
		lea	eax, [ebp+var_3D6]
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		jmp	loc_4070BB
; ---------------------------------------------------------------------------

loc_40700D:				; CODE XREF: sub_406FDB+F2j
		mov	eax, [ebp+var_20]
		lea	edx, [eax+4]
		mov	[ebp+var_20], edx
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	loc_4070BA
		cmp	[ebp+var_18], 0
		jz	short loc_4070A9
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	20h
		add	[ebp+var_14], 1
		add	[ebp+var_18], 1
		jmp	short loc_4070A9
; ---------------------------------------------------------------------------

loc_40703B:				; CODE XREF: sub_406FDB+DBj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_40704F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Bh
		jnz	short loc_407076

loc_40704F:				; CODE XREF: sub_406FDB+68j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset a02x ; "%%%02X"
		mov	[esp+3E8h+var_3E0], edx
		mov	[esp+3E8h+Format], eax ; Format
		mov	eax, [ebp+var_14]
		mov	[esp+3E8h+Dest], eax ; Dest
		call	sprintf
		add	[ebp+var_14], 3
		jmp	short loc_40709D
; ---------------------------------------------------------------------------

loc_407076:				; CODE XREF: sub_406FDB+72j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_40708C
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	2Bh
		add	[ebp+var_14], 1
		jmp	short loc_40709D
; ---------------------------------------------------------------------------

loc_40708C:				; CODE XREF: sub_406FDB+A3j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1

loc_40709D:				; CODE XREF: sub_406FDB+99j
					; sub_406FDB+AFj
		add	[ebp+var_18], 1
		sub	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_4070A9:				; CODE XREF: sub_406FDB+4Ej
					; sub_406FDB+5Ej
		cmp	[ebp+var_10], 0
		jz	short loc_4070BB
		cmp	[ebp+var_18], 3B3h
		jbe	short loc_40703B
		jmp	short loc_4070BB
; ---------------------------------------------------------------------------

loc_4070BA:				; CODE XREF: sub_406FDB+44j
		nop

loc_4070BB:				; CODE XREF: sub_406FDB+2Dj
					; sub_406FDB+D2j ...
		mov	eax, [ebp+var_20]
		lea	edx, [eax+4]
		mov	[ebp+var_20], edx
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_40700D
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		lea	eax, [ebp+var_3D6]
		mov	[esp+3E8h+var_3E0], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+3E8h+Format], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+3E8h+Dest], eax
		call	assuan_write_status
		leave
		retn
sub_406FDB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4070F7(int, int, char	*)
sub_4070F7	proc near		; CODE XREF: sub_40E0F8+61p
					; sub_4118BE+CEp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	eax, [eax+8]
		mov	[ebp+var_C], eax
		mov	[esp+28h+Val], 0Ah ; char
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_40712E
		mov	[esp+28h+Str], offset aErrorLfDetecte ;	"error:	LF detected in status line - not"...
		call	sub_43CB21
		jmp	short locret_407147
; ---------------------------------------------------------------------------

loc_40712E:				; CODE XREF: sub_4070F7+27j
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Val], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	assuan_write_status

locret_407147:				; CODE XREF: sub_4070F7+35j
		leave
		retn
sub_4070F7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407149	proc near		; CODE XREF: sub_40729B+40Dp

hEvent		= dword	ptr -1C8h
var_1C4		= byte ptr -1C4h
var_1C0		= dword	ptr -1C0h
var_1BC		= dword	ptr -1BCh
var_1AC		= dword	ptr -1ACh
var_1A8		= dword	ptr -1A8h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 1C8h
		mov	[ebp+var_C], 0
		mov	eax, ds:dword_451150
		mov	[ebp+var_14], eax
		jmp	loc_40728F
; ---------------------------------------------------------------------------

loc_407166:				; CODE XREF: sub_407149+14Aj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_407287
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		test	eax, eax
		jz	loc_407287
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	[esp+1C8h+hEvent], eax
		call	assuan_get_pid
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_10], 0
		jmp	short loc_4071C7
; ---------------------------------------------------------------------------

loc_4071A5:				; CODE XREF: sub_407149+84j
		mov	eax, [ebp+var_10]
		mov	eax, [ebp+eax*8+var_1AC]
		cmp	eax, [ebp+var_18]
		jnz	short loc_4071C3
		mov	eax, [ebp+var_10]
		mov	eax, [ebp+eax*8+var_1A8]
		cmp	eax, [ebp+var_1C]
		jz	short loc_4071D1

loc_4071C3:				; CODE XREF: sub_407149+69j
		add	[ebp+var_10], 1

loc_4071C7:				; CODE XREF: sub_407149+5Aj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_C]
		jl	short loc_4071A5
		jmp	short loc_4071D2
; ---------------------------------------------------------------------------

loc_4071D1:				; CODE XREF: sub_407149+78j
		nop

loc_4071D2:				; CODE XREF: sub_407149+86j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_C]
		jge	short loc_407203
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+var_18]
		mov	[esp+1C8h+var_1BC], edx
		mov	edx, [ebp+var_1C]
		mov	[esp+1C8h+var_1C0], edx
		mov	dword ptr [esp+1C8h+var_1C4], eax ; char
		mov	[esp+1C8h+hEvent], offset aEventLxPAlread ; "event %lx (%p) already triggered for cl"...
		call	sub_43CAF7
		jmp	loc_407287
; ---------------------------------------------------------------------------

loc_407203:				; CODE XREF: sub_407149+8Fj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+var_18]
		mov	[esp+1C8h+var_1BC], edx
		mov	edx, [ebp+var_1C]
		mov	[esp+1C8h+var_1C0], edx
		mov	dword ptr [esp+1C8h+var_1C4], eax ; char
		mov	[esp+1C8h+hEvent], offset aTriggeringEven ; "triggering	event %lx (%p) for client %d"...
		call	sub_43CAF7
		mov	eax, [ebp+var_1C]
		mov	[esp+1C8h+hEvent], eax ; hEvent
		mov	eax, ds:SetEvent
		call	eax ; SetEvent
		sub	esp, 4
		test	eax, eax
		jnz	short loc_407261
		mov	[esp+1C8h+hEvent], 0FFFFFFFFh ;	DWORD
		call	sub_439E46
		mov	edx, [ebp+var_14]
		mov	edx, [edx+0Ch]
		mov	[esp+1C8h+var_1C0], eax
		mov	dword ptr [esp+1C8h+var_1C4], edx ; char
		mov	[esp+1C8h+hEvent], offset aSeteventLxFail ; "SetEvent(%lx) failed: %s\n"
		call	sub_43CB21

loc_407261:				; CODE XREF: sub_407149+F0j
		mov	eax, [ebp+var_C]
		cmp	eax, 31h
		ja	short loc_407287
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_18]
		mov	[ebp+eax*8+var_1AC], edx
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		mov	[ebp+eax*8+var_1A8], edx
		add	[ebp+var_C], 1

loc_407287:				; CODE XREF: sub_407149+25j
					; sub_407149+33j ...
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_40728F:				; CODE XREF: sub_407149+18j
		cmp	[ebp+var_14], 0
		jnz	loc_407166
		leave
		retn
sub_407149	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40729B	proc near		; CODE XREF: sub_403BAA+1B6p
					; sub_40772E+2Dp

Filename	= dword	ptr -118h
Mode		= dword	ptr -114h
var_110		= dword	ptr -110h
var_10C		= dword	ptr -10Ch
var_108		= dword	ptr -108h
var_104		= dword	ptr -104h
var_EE		= byte ptr -0EEh
var_BC		= dword	ptr -0BCh
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_92		= byte ptr -92h
var_74		= byte ptr -74h
Dest		= byte ptr -56h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
File		= dword	ptr -20h
lpApplicationName= dword ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 110h
		mov	[ebp+var_C], 0
		jmp	loc_407718
; ---------------------------------------------------------------------------

loc_4072B2:				; CODE XREF: sub_40729B+483j
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, offset dword_451060
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		test	eax, eax
		jz	loc_407710
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jz	loc_407710
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_30]
		mov	[esp+118h+var_10C], edx
		lea	edx, [ebp+var_2C]
		mov	[esp+118h+var_110], edx
		mov	[esp+118h+Mode], 0
		mov	[esp+118h+Filename], eax
		call	sub_40B139
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 1000Ch
		jnz	short loc_407349
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[esp+118h+Filename], eax
		call	sub_40E4A8
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[esp+118h+Filename], eax
		call	sub_40A90C
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax], 0
		mov	[ebp+var_2C], 0
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	[ebp+var_30], eax
		jmp	short loc_407353
; ---------------------------------------------------------------------------

loc_407349:				; CODE XREF: sub_40729B+75j
		cmp	[ebp+var_18], 0
		jnz	loc_407713

loc_407353:				; CODE XREF: sub_40729B+ACj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_40737B
		mov	eax, [ebp+var_14]
		mov	edx, [eax+10h]
		mov	eax, [ebp+var_2C]
		cmp	edx, eax
		jnz	short loc_40737B
		mov	eax, [ebp+var_14]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_30]
		cmp	edx, eax
		jz	loc_4076AD

loc_40737B:				; CODE XREF: sub_40729B+C0j
					; sub_40729B+CDj
		mov	esi, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	ebx, [eax+14h]
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+var_14]
		mov	edx, [eax+10h]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[esp+118h+var_104], esi
		mov	[esp+118h+var_108], ebx
		mov	[esp+118h+var_10C], ecx
		mov	[esp+118h+var_110], edx
		mov	[esp+118h+Mode], eax ; char
		mov	[esp+118h+Filename], offset aUpdatingSlotDS ; "updating	slot %d	status:	0x%04X->0x%04X"...
		call	sub_43CAF7
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_14]
		mov	[eax+10h], edx
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[esp+118h+var_10C], eax
		mov	[esp+118h+var_110], offset aReader_D_statu ; "reader_%d.status"
		mov	[esp+118h+Mode], 32h
		lea	eax, [ebp+var_EE]
		mov	[esp+118h+Filename], eax
		call	sub_429C1D
		mov	eax, ds:dword_451D34
		mov	[esp+118h+var_110], 0
		lea	edx, [ebp+var_EE]
		mov	[esp+118h+Mode], edx
		mov	[esp+118h+Filename], eax
		call	sub_43960B
		mov	[ebp+lpApplicationName], eax
		mov	edx, offset aW	; "w"
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+118h+Mode], edx ; Mode
		mov	[esp+118h+Filename], eax ; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jz	short loc_407487
		mov	eax, [ebp+var_2C]
		and	eax, 1
		test	al, al
		jz	short loc_40743D
		mov	eax, offset aUsable ; "USABLE"
		jmp	short loc_407464
; ---------------------------------------------------------------------------

loc_40743D:				; CODE XREF: sub_40729B+199j
		mov	eax, [ebp+var_2C]
		and	eax, 4
		test	eax, eax
		jnz	short loc_40745F
		mov	eax, [ebp+var_2C]
		and	eax, 2
		test	eax, eax
		jz	short loc_407458
		mov	eax, offset aPresent ; "PRESENT"
		jmp	short loc_40745D
; ---------------------------------------------------------------------------

loc_407458:				; CODE XREF: sub_40729B+1B4j
		mov	eax, offset aNocard ; "NOCARD"

loc_40745D:				; CODE XREF: sub_40729B+1BBj
		jmp	short loc_407464
; ---------------------------------------------------------------------------

loc_40745F:				; CODE XREF: sub_40729B+1AAj
		mov	eax, offset aActive ; "ACTIVE"

loc_407464:				; CODE XREF: sub_40729B+1A0j
					; sub_40729B:loc_40745Dj
		mov	edx, offset aS_0 ; "%s\n"
		mov	[esp+118h+var_110], eax
		mov	[esp+118h+Mode], edx ; Format
		mov	eax, [ebp+File]
		mov	[esp+118h+Filename], eax ; File
		call	fprintf
		mov	eax, [ebp+File]
		mov	[esp+118h+Filename], eax ; File
		call	fclose

loc_407487:				; CODE XREF: sub_40729B+18Fj
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+118h+Filename], eax
		call	gcry_free
		mov	eax, ds:dword_451D34
		mov	[esp+118h+Mode], 0
		mov	[esp+118h+Filename], eax
		call	sub_43960B
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	[esp+118h+var_110], eax
		mov	[esp+118h+Mode], offset	aGnupghomeS ; "GNUPGHOME=%s"
		lea	eax, [ebp+var_98]
		mov	[esp+118h+Filename], eax
		call	sub_429E78
		test	eax, eax
		jns	short loc_4074DC
		mov	[esp+118h+Filename], offset aOutOfCoreWhile ; "out of core while building environment\"...
		call	sub_43CB21
		jmp	loc_407666
; ---------------------------------------------------------------------------

loc_4074DC:				; CODE XREF: sub_40729B+22Ej
		mov	eax, [ebp+var_98]
		mov	[ebp+var_38], eax
		mov	[ebp+var_34], 0
		mov	eax, [ebp+var_14]
		mov	edx, [eax+4]
		mov	eax, offset aD	; "%d"
		mov	[esp+118h+var_110], edx
		mov	[esp+118h+Mode], eax ; Format
		lea	eax, [ebp+Dest]
		mov	[esp+118h+Filename], eax ; Dest
		call	sprintf
		mov	eax, [ebp+var_14]
		mov	edx, [eax+10h]
		mov	eax, offset a0x04x ; "0x%04X"
		mov	[esp+118h+var_110], edx
		mov	[esp+118h+Mode], eax ; Format
		lea	eax, [ebp+var_74]
		mov	[esp+118h+Filename], eax ; Dest
		call	sprintf
		mov	edx, [ebp+var_2C]
		mov	eax, offset a0x04x ; "0x%04X"
		mov	[esp+118h+var_110], edx
		mov	[esp+118h+Mode], eax ; Format
		lea	eax, [ebp+var_92]
		mov	[esp+118h+Filename], eax ; Dest
		call	sprintf
		mov	[ebp+var_BC], offset aReaderPort ; "--reader-port"
		lea	eax, [ebp+Dest]
		mov	[ebp+var_B8], eax
		mov	[ebp+var_B4], offset aOldCode ;	"--old-code"
		lea	eax, [ebp+var_74]
		mov	[ebp+var_B0], eax
		mov	[ebp+var_AC], offset aNewCode ;	"--new-code"
		lea	eax, [ebp+var_92]
		mov	[ebp+var_A8], eax
		mov	[ebp+var_A4], offset aStatus_0 ; "--status"
		mov	eax, [ebp+var_2C]
		and	eax, 1
		test	al, al
		jz	short loc_40759D
		mov	eax, offset aUsable ; "USABLE"
		jmp	short loc_4075C4
; ---------------------------------------------------------------------------

loc_40759D:				; CODE XREF: sub_40729B+2F9j
		mov	eax, [ebp+var_2C]
		and	eax, 4
		test	eax, eax
		jnz	short loc_4075BF
		mov	eax, [ebp+var_2C]
		and	eax, 2
		test	eax, eax
		jz	short loc_4075B8
		mov	eax, offset aPresent ; "PRESENT"
		jmp	short loc_4075BD
; ---------------------------------------------------------------------------

loc_4075B8:				; CODE XREF: sub_40729B+314j
		mov	eax, offset aNocard ; "NOCARD"

loc_4075BD:				; CODE XREF: sub_40729B+31Bj
		jmp	short loc_4075C4
; ---------------------------------------------------------------------------

loc_4075BF:				; CODE XREF: sub_40729B+30Aj
		mov	eax, offset aActive ; "ACTIVE"

loc_4075C4:				; CODE XREF: sub_40729B+300j
					; sub_40729B:loc_4075BDj
		mov	[ebp+var_A0], eax
		mov	[ebp+var_9C], 0
		mov	eax, ds:dword_451D34
		mov	[esp+118h+var_110], 0
		mov	[esp+118h+Mode], offset	aScdEvent ; "scd-event"
		mov	[esp+118h+Filename], eax
		call	sub_43960B
		mov	[ebp+lpApplicationName], eax
		lea	eax, [ebp+var_38]
		mov	[esp+118h+var_110], eax
		lea	eax, [ebp+var_BC]
		mov	[esp+118h+Mode], eax ; int
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+118h+Filename], eax ; lpApplicationName
		call	sub_42CFF2
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jz	short loc_40764D
		mov	eax, [ebp+var_28]
		mov	[esp+118h+Filename], eax
		call	sub_403766
		cmp	eax, 8051h
		jz	short loc_40764D
		mov	eax, [ebp+var_28]
		mov	[esp+118h+Filename], eax
		call	gpg_strerror
		mov	[esp+118h+var_110], eax
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+118h+Mode], eax ; char
		mov	[esp+118h+Filename], offset aFailedToRunEve ; "failed to run event handler `%s': %s\n"
		call	sub_43CB21

loc_40764D:				; CODE XREF: sub_40729B+37Cj
					; sub_40729B+38Ej
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+118h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+var_98]
		mov	[esp+118h+Filename], eax
		call	gcry_free

loc_407666:				; CODE XREF: sub_40729B+23Cj
		mov	eax, [ebp+var_24]
		mov	[esp+118h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_40769E
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_40769E
		cmp	[ebp+arg_0], 0
		jz	short loc_40769E
		mov	[esp+118h+Mode], 1
		mov	eax, [ebp+var_C]
		mov	[esp+118h+Filename], eax
		call	sub_4037C0

loc_40769E:				; CODE XREF: sub_40729B+3DEj
					; sub_40729B+3E8j ...
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+0Ch], 1
		call	sub_407149

loc_4076AD:				; CODE XREF: sub_40729B+DAj
		mov	eax, ds:dword_451D58
		test	eax, eax
		jz	short loc_407714
		mov	eax, ds:dword_451150
		mov	[ebp+var_10], eax
		jmp	short loc_4076D2
; ---------------------------------------------------------------------------

loc_4076C0:				; CODE XREF: sub_40729B+43Bj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	short loc_4076DA
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[ebp+var_10], eax

loc_4076D2:				; CODE XREF: sub_40729B+423j
		cmp	[ebp+var_10], 0
		jnz	short loc_4076C0
		jmp	short loc_4076DB
; ---------------------------------------------------------------------------

loc_4076DA:				; CODE XREF: sub_40729B+42Dj
		nop

loc_4076DB:				; CODE XREF: sub_40729B+43Dj
		mov	eax, ds:dword_451150
		test	eax, eax
		jz	short loc_407714
		cmp	[ebp+var_10], 0
		jnz	short loc_407714
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[esp+118h+Mode], eax ; char
		mov	[esp+118h+Filename], offset aDisconnectingC ; "disconnecting card in slot %d\n"
		call	sub_43CAF7
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[esp+118h+Filename], eax
		call	sub_40ABCB
		jmp	short loc_407714
; ---------------------------------------------------------------------------

loc_407710:				; CODE XREF: sub_40729B+32j
					; sub_40729B+41j
		nop
		jmp	short loc_407714
; ---------------------------------------------------------------------------

loc_407713:				; CODE XREF: sub_40729B+B2j
		nop

loc_407714:				; CODE XREF: sub_40729B+419j
					; sub_40729B+447j ...
		add	[ebp+var_C], 1

loc_407718:				; CODE XREF: sub_40729B+12j
		mov	eax, [ebp+var_C]
		cmp	eax, 9
		jbe	loc_4072B2
		add	esp, 110h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_40729B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40772E	proc near		; CODE XREF: sub_402C03+Fp

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_10], 0
		mov	dword ptr [esp+18h+var_14], 1 ;	char
		mov	[esp+18h+var_18], offset dword_451158
		call	pth_mutex_acquire
		test	eax, eax
		jz	short loc_40777E
		mov	[esp+18h+var_18], 1
		call	sub_40729B
		mov	[esp+18h+var_18], offset dword_451158
		call	pth_mutex_release
		test	eax, eax
		jnz	short locret_40777F
		mov	[esp+18h+var_18], offset aFailedToReleas ; "failed to release status_file_update lo"...
		call	sub_43CB21
		jmp	short locret_40777F
; ---------------------------------------------------------------------------

loc_40777E:				; CODE XREF: sub_40772E+24j
		nop

locret_40777F:				; CODE XREF: sub_40772E+40j
					; sub_40772E+4Ej
		leave
		retn
sub_40772E	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407784(LPCSTR)
sub_407784	proc near		; CODE XREF: sub_40A3E0+5Ep
					; sub_40A3E0+146p

lpLibFileName	= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+lpLibFileName], eax ; lpLibFileName
		mov	eax, ds:LoadLibraryA
		call	eax ; LoadLibraryA
		sub	esp, 4
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_407784	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4077A2(HMODULE, LPCSTR)
sub_4077A2	proc near		; CODE XREF: sub_40A3E0+99p
					; sub_40A3E0+B1p ...

hModule		= dword	ptr -28h
lpProcName	= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_4077E0
		cmp	[ebp+arg_4], 0
		jz	short loc_4077E0
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lpProcName], eax ; lpProcName
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hModule], eax ; hModule
		mov	eax, ds:GetProcAddress
		call	eax ; GetProcAddress
		sub	esp, 8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4077DB
		mov	eax, 0
		jmp	short locret_4077E5
; ---------------------------------------------------------------------------

loc_4077DB:				; CODE XREF: sub_4077A2+30j
		mov	eax, [ebp+var_C]
		jmp	short locret_4077E5
; ---------------------------------------------------------------------------

loc_4077E0:				; CODE XREF: sub_4077A2+Aj
					; sub_4077A2+10j
		mov	eax, 0

locret_4077E5:				; CODE XREF: sub_4077A2+37j
					; sub_4077A2+3Cj
		leave
		retn
sub_4077A2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4077E7	proc near		; CODE XREF: sub_40A3E0+6Cp
					; sub_40A3E0+154p

Dest		= dword	ptr -18h
Format		= dword	ptr -14h
var_10		= dword	ptr -10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	edx, offset aEcLu ; "ec=%lu"
		mov	[esp+18h+var_10], eax
		mov	[esp+18h+Format], edx ;	Format
		mov	[esp+18h+Dest],	offset Dest ; Dest
		call	sprintf
		mov	eax, offset Dest
		leave
		retn
sub_4077E7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407814(HANDLE)
sub_407814	proc near		; CODE XREF: sub_40A3E0+100p
					; sub_40A3E0+4E9p

hObject		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_407837
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		jmp	short locret_40783C
; ---------------------------------------------------------------------------

loc_407837:				; CODE XREF: sub_407814+Aj
		mov	eax, 0FFFFFFFFh

locret_40783C:				; CODE XREF: sub_407814+21j
		leave
		retn
sub_407814	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40783E	proc near		; CODE XREF: sub_409117+D7p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 8
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, edx
		leave
		retn
sub_40783E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407868	proc near		; CODE XREF: sub_409117+EDp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 10h
		or	edx, eax
		mov	eax, [ebp+var_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 8
		or	edx, eax
		mov	eax, [ebp+var_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, edx
		leave
		retn
sub_407868	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4078B4	proc near		; CODE XREF: sub_4079E2+D7p
					; sub_40AADF+4Bp ...

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, 0A0h
		add	eax, offset dword_451160
		add	eax, 4
		mov	[esp+18h+var_10], 0
		mov	dword ptr [esp+18h+var_14], 0
		mov	[esp+18h+var_18], eax
		call	pth_mutex_acquire
		test	eax, eax
		jnz	short loc_407914
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+18h+var_18], eax ;	int
		call	strerror
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aFailedToAcqu_0 ; "failed to acquire apdu lock: %s\n"
		call	sub_43CB21
		mov	eax, 10006h
		jmp	short locret_407919
; ---------------------------------------------------------------------------

loc_407914:				; CODE XREF: sub_4078B4+36j
		mov	eax, 0

locret_407919:				; CODE XREF: sub_4078B4+5Ej
		leave
		retn
sub_4078B4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40791B	proc near		; CODE XREF: .text:0040ADDDp
					; sub_40AFAD+49p ...

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, 0A0h
		add	eax, offset dword_451160
		add	eax, 4
		mov	[esp+18h+var_10], 0
		mov	dword ptr [esp+18h+var_14], 1
		mov	[esp+18h+var_18], eax
		call	pth_mutex_acquire
		test	eax, eax
		jnz	short loc_407990
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 10h
		jnz	short loc_407968
		mov	eax, 10007h
		jmp	short locret_407995
; ---------------------------------------------------------------------------

loc_407968:				; CODE XREF: sub_40791B+44j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+18h+var_18], eax ;	int
		call	strerror
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aFailedToAcqu_0 ; "failed to acquire apdu lock: %s\n"
		call	sub_43CB21
		mov	eax, 10006h
		jmp	short locret_407995
; ---------------------------------------------------------------------------

loc_407990:				; CODE XREF: sub_40791B+36j
		mov	eax, 0

locret_407995:				; CODE XREF: sub_40791B+4Bj
					; sub_40791B+73j
		leave
		retn
sub_40791B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407997	proc near		; CODE XREF: sub_408463+C4p
					; sub_408463+1B9p ...

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, 0A0h
		add	eax, offset dword_451160
		add	eax, 4
		mov	[esp+18h+var_18], eax
		call	pth_mutex_release
		test	eax, eax
		jnz	short locret_4079E0
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+18h+var_18], eax ;	int
		call	strerror
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aFailedToRele_0 ; "failed to release apdu lock: %s\n"
		call	sub_43CB21

locret_4079E0:				; CODE XREF: sub_407997+26j
		leave
		retn
sub_407997	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4079E2	proc near		; CODE XREF: sub_408463:loc_408495p
					; sub_40970C+15p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0FFFFFFFFh
		mov	[ebp+var_C], 0
		jmp	short loc_407A1C
; ---------------------------------------------------------------------------

loc_4079F8:				; CODE XREF: sub_4079E2+3Ej
		mov	eax, [ebp+var_C]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_407A18
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_407A18
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax

loc_407A18:				; CODE XREF: sub_4079E2+28j
					; sub_4079E2+2Ej
		add	[ebp+var_C], 1

loc_407A1C:				; CODE XREF: sub_4079E2+14j
		cmp	[ebp+var_C], 3
		jle	short loc_4079F8
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_407A3E
		mov	[esp+28h+var_28], offset aNew_reader_slo ; "new_reader_slot: out of slots\n"
		call	sub_43CB21
		mov	eax, 0FFFFFFFFh
		jmp	locret_407CB8
; ---------------------------------------------------------------------------

loc_407A3E:				; CODE XREF: sub_4079E2+44j
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_451200
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_407AB3
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, 0A0h
		add	eax, offset dword_451160
		add	eax, 4
		mov	[esp+28h+var_28], eax
		call	pth_mutex_init
		test	eax, eax
		jnz	short loc_407A9F
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	int
		call	strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aErrorInitializ ; "error initializing mutex: %s\n"
		call	sub_43CB21
		mov	eax, 0FFFFFFFFh
		jmp	locret_407CB8
; ---------------------------------------------------------------------------

loc_407A9F:				; CODE XREF: sub_4079E2+90j
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_451200
		mov	dword ptr [eax], 1

loc_407AB3:				; CODE XREF: sub_4079E2+6Ej
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_4078B4
		test	eax, eax
		jz	short loc_407AED
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	int
		call	strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aErrorLockingMu ; "error locking mutex: %s\n"
		call	sub_43CB21
		mov	eax, 0FFFFFFFFh
		jmp	locret_407CB8
; ---------------------------------------------------------------------------

loc_407AED:				; CODE XREF: sub_4079E2+DEj
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_451180
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_451180
		mov	dword ptr [eax+4], offset sub_409BE8
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_451180
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_451180
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	dword ptr [eax], offset	sub_409CFE
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	dword ptr [eax+4], offset sub_40A04A
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	dword ptr [eax], 1
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_4511B0
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	dword ptr [eax+8], 1
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_4511D0
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	dword ptr [eax+18h], 0
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_4511A0
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_4511A0
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		mov	eax, [ebp+var_10]
		imul	eax, 0A8h
		add	eax, offset dword_4511A0
		mov	dword ptr [eax+14h], 0FFFFFFFFh
		mov	eax, [ebp+var_10]

locret_407CB8:				; CODE XREF: sub_4079E2+57j
					; sub_4079E2+B8j ...
		leave
		retn
sub_4079E2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407CBA	proc near		; CODE XREF: sub_408463+1AEp
					; sub_408D9F+25Fp ...

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_451D24
		test	eax, eax
		jz	loc_407D75
		mov	eax, dword ptr [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451180
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_407CFB
		mov	eax, dword ptr [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451180
		mov	edx, [eax+8]
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	edx

loc_407CFB:				; CODE XREF: sub_407CBA+26j
		mov	eax, dword ptr [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jz	short locret_407D76
		mov	eax, dword ptr [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511F0
		mov	eax, [eax+8]
		test	eax, eax
		jz	short locret_407D76
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aSlotDAtr ; "slot %d: ATR="
		call	sub_43CAF7
		mov	eax, dword ptr [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511F0
		mov	eax, [eax+8]
		mov	edx, dword ptr [ebp+arg_0]
		imul	edx, 0A8h
		add	edx, 70h
		add	edx, offset dword_451160
		add	edx, 4
		mov	[esp+18h+var_10], eax
		mov	dword ptr [esp+18h+var_14], edx
		mov	[esp+18h+var_18], offset byte_449014
		call	sub_43CC18
		jmp	short locret_407D76
; ---------------------------------------------------------------------------

loc_407D75:				; CODE XREF: sub_407CBA+Dj
		nop

locret_407D76:				; CODE XREF: sub_407CBA+55j
					; sub_407CBA+6Aj ...
		leave
		retn
sub_407CBA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407D78	proc near		; CODE XREF: sub_407E6A+180p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		cmp	eax, 10008h
		jz	loc_407E2B
		cmp	eax, 10008h
		jg	short loc_407DC5
		cmp	eax, 10004h
		jz	short loc_407E0F
		cmp	eax, 10004h
		jg	short loc_407DB5
		cmp	eax, 10001h
		jz	short loc_407E01
		cmp	eax, 10002h
		jz	short loc_407E08
		test	eax, eax
		jz	short loc_407DFA
		jmp	loc_407E63
; ---------------------------------------------------------------------------

loc_407DB5:				; CODE XREF: sub_407D78+24j
		cmp	eax, 10006h
		jz	short loc_407E1D
		cmp	eax, 10006h
		jg	short loc_407E24
		jmp	short loc_407E16
; ---------------------------------------------------------------------------

loc_407DC5:				; CODE XREF: sub_407D78+16j
		cmp	eax, 1000Ch
		jz	short loc_407E47
		cmp	eax, 1000Ch
		jg	short loc_407DE3
		cmp	eax, 1000Ah
		jz	short loc_407E39
		cmp	eax, 1000Ah
		jg	short loc_407E40
		jmp	short loc_407E32
; ---------------------------------------------------------------------------

loc_407DE3:				; CODE XREF: sub_407D78+59j
		cmp	eax, 1000Eh
		jz	short loc_407E55
		cmp	eax, 1000Eh
		jl	short loc_407E4E
		cmp	eax, 1000Fh
		jz	short loc_407E5C
		jmp	short loc_407E63
; ---------------------------------------------------------------------------

loc_407DFA:				; CODE XREF: sub_407D78+36j
		mov	eax, offset aOkay ; "okay"
		jmp	short loc_407E68
; ---------------------------------------------------------------------------

loc_407E01:				; CODE XREF: sub_407D78+2Bj
		mov	eax, offset aOutOfCore ; "out of core"
		jmp	short loc_407E68
; ---------------------------------------------------------------------------

loc_407E08:				; CODE XREF: sub_407D78+32j
		mov	eax, offset aInvalidValue ; "invalid value"
		jmp	short loc_407E68
; ---------------------------------------------------------------------------

loc_407E0F:				; CODE XREF: sub_407D78+1Dj
		mov	eax, offset aNoDriver ;	"no driver"
		jmp	short loc_407E68
; ---------------------------------------------------------------------------

loc_407E16:				; CODE XREF: sub_407D78+4Bj
		mov	eax, offset aNotSupported ; "not supported"
		jmp	short loc_407E68
; ---------------------------------------------------------------------------

loc_407E1D:				; CODE XREF: sub_407D78+42j
		mov	eax, offset aLockingFailed ; "locking failed"
		jmp	short loc_407E68
; ---------------------------------------------------------------------------

loc_407E24:				; CODE XREF: sub_407D78+49j
		mov	eax, offset aBusy ; "busy"
		jmp	short loc_407E68
; ---------------------------------------------------------------------------

loc_407E2B:				; CODE XREF: sub_407D78+Bj
		mov	eax, offset aNoCard ; "no card"
		jmp	short loc_407E68
; ---------------------------------------------------------------------------

loc_407E32:				; CODE XREF: sub_407D78+69j
		mov	eax, offset aCardInactive ; "card inactive"
		jmp	short loc_407E68
; ---------------------------------------------------------------------------

loc_407E39:				; CODE XREF: sub_407D78+60j
		mov	eax, offset aCardIOError ; "card I/O error"
		jmp	short loc_407E68
; ---------------------------------------------------------------------------

loc_407E40:				; CODE XREF: sub_407D78+67j
		mov	eax, offset aGeneralError ; "general error"
		jmp	short loc_407E68
; ---------------------------------------------------------------------------

loc_407E47:				; CODE XREF: sub_407D78+52j
		mov	eax, offset aNoReader ;	"no reader"
		jmp	short loc_407E68
; ---------------------------------------------------------------------------

loc_407E4E:				; CODE XREF: sub_407D78+77j
		mov	eax, offset aAborted ; "aborted"
		jmp	short loc_407E68
; ---------------------------------------------------------------------------

loc_407E55:				; CODE XREF: sub_407D78+70j
		mov	eax, offset aNoPinpad ;	"no pinpad"
		jmp	short loc_407E68
; ---------------------------------------------------------------------------

loc_407E5C:				; CODE XREF: sub_407D78+7Ej
		mov	eax, offset aAlreadyConnect ; "already connected"
		jmp	short loc_407E68
; ---------------------------------------------------------------------------

loc_407E63:				; CODE XREF: sub_407D78+38j
					; sub_407D78+80j
		mov	eax, offset aUnknownHostSta ; "unknown host status error"

loc_407E68:				; CODE XREF: sub_407D78+87j
					; sub_407D78+8Ej ...
		pop	ebp
		retn
sub_407D78	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407E6A	proc near		; CODE XREF: sub_40B402+596p
					; sub_40B402+978p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		cmp	eax, 6A81h
		jz	loc_407F86
		cmp	eax, 6A81h
		jg	short loc_407EE3
		cmp	eax, 6982h
		jz	loc_407F67
		cmp	eax, 6982h
		jg	short loc_407EBD
		cmp	eax, 6581h
		jz	loc_407F53
		cmp	eax, 6700h
		jz	loc_407F5D
		cmp	eax, 6282h
		jz	loc_407F49
		jmp	loc_407FC5
; ---------------------------------------------------------------------------

loc_407EBD:				; CODE XREF: sub_407E6A+2Bj
		cmp	eax, 6985h
		jz	loc_407F78
		cmp	eax, 6A80h
		jz	loc_407F7F
		cmp	eax, 6983h
		jz	loc_407F71
		jmp	loc_407FC5
; ---------------------------------------------------------------------------

loc_407EE3:				; CODE XREF: sub_407E6A+19j
		cmp	eax, 6A88h
		jz	loc_407F9B
		cmp	eax, 6A88h
		jg	short loc_407F1B
		cmp	eax, 6A83h
		jz	loc_407F94
		cmp	eax, 6A83h
		jl	loc_407F8D
		cmp	eax, 6A87h
		jz	loc_407FA2
		jmp	loc_407FC5
; ---------------------------------------------------------------------------

loc_407F1B:				; CODE XREF: sub_407E6A+89j
		cmp	eax, 6D00h
		jz	loc_407FB0
		cmp	eax, 6D00h
		jg	short loc_407F39
		cmp	eax, 6B00h
		jz	short loc_407FA9
		jmp	loc_407FC5
; ---------------------------------------------------------------------------

loc_407F39:				; CODE XREF: sub_407E6A+C1j
		cmp	eax, 6E00h
		jz	short loc_407FB7
		cmp	eax, 9000h
		jz	short loc_407FBE
		jmp	short loc_407FC5
; ---------------------------------------------------------------------------

loc_407F49:				; CODE XREF: sub_407E6A+48j
		mov	eax, offset aEofReached	; "eof reached"
		jmp	locret_407FF6
; ---------------------------------------------------------------------------

loc_407F53:				; CODE XREF: sub_407E6A+32j
		mov	eax, offset aEepromFailure ; "eeprom failure"
		jmp	locret_407FF6
; ---------------------------------------------------------------------------

loc_407F5D:				; CODE XREF: sub_407E6A+3Dj
		mov	eax, offset aWrongLength ; "wrong length"
		jmp	locret_407FF6
; ---------------------------------------------------------------------------

loc_407F67:				; CODE XREF: sub_407E6A+20j
		mov	eax, offset aChvWrong ;	"CHV wrong"
		jmp	locret_407FF6
; ---------------------------------------------------------------------------

loc_407F71:				; CODE XREF: sub_407E6A+6Ej
		mov	eax, offset aChvBlocked	; "CHV blocked"
		jmp	short locret_407FF6
; ---------------------------------------------------------------------------

loc_407F78:				; CODE XREF: sub_407E6A+58j
		mov	eax, offset aUseConditionsN ; "use conditions not satisfied"
		jmp	short locret_407FF6
; ---------------------------------------------------------------------------

loc_407F7F:				; CODE XREF: sub_407E6A+63j
		mov	eax, offset aBadParameter ; "bad parameter"
		jmp	short locret_407FF6
; ---------------------------------------------------------------------------

loc_407F86:				; CODE XREF: sub_407E6A+Ej
		mov	eax, offset aNotSupported ; "not supported"
		jmp	short locret_407FF6
; ---------------------------------------------------------------------------

loc_407F8D:				; CODE XREF: sub_407E6A+9Bj
		mov	eax, offset aFileNotFound ; "file not found"
		jmp	short locret_407FF6
; ---------------------------------------------------------------------------

loc_407F94:				; CODE XREF: sub_407E6A+90j
		mov	eax, offset aRecordNotFound ; "record not found"
		jmp	short locret_407FF6
; ---------------------------------------------------------------------------

loc_407F9B:				; CODE XREF: sub_407E6A+7Ej
		mov	eax, offset aReferenceNotFo ; "reference not found"
		jmp	short locret_407FF6
; ---------------------------------------------------------------------------

loc_407FA2:				; CODE XREF: sub_407E6A+A6j
		mov	eax, offset aBadLc ; "bad Lc"
		jmp	short locret_407FF6
; ---------------------------------------------------------------------------

loc_407FA9:				; CODE XREF: sub_407E6A+C8j
		mov	eax, offset aBadP0OrP1 ; "bad P0 or P1"
		jmp	short locret_407FF6
; ---------------------------------------------------------------------------

loc_407FB0:				; CODE XREF: sub_407E6A+B6j
		mov	eax, offset aInstructionNot ; "instruction not supported"
		jmp	short locret_407FF6
; ---------------------------------------------------------------------------

loc_407FB7:				; CODE XREF: sub_407E6A+D4j
		mov	eax, offset aClassNotSuppor ; "class not supported"
		jmp	short locret_407FF6
; ---------------------------------------------------------------------------

loc_407FBE:				; CODE XREF: sub_407E6A+DBj
		mov	eax, offset aSuccess ; "success"
		jmp	short locret_407FF6
; ---------------------------------------------------------------------------

loc_407FC5:				; CODE XREF: sub_407E6A+4Ej
					; sub_407E6A+74j ...
		mov	eax, [ebp+arg_0]
		mov	al, 0
		cmp	eax, 6100h
		jnz	short loc_407FD8
		mov	eax, offset aMoreDataAvaila ; "more data available"
		jmp	short locret_407FF6
; ---------------------------------------------------------------------------

loc_407FD8:				; CODE XREF: sub_407E6A+165j
		mov	eax, [ebp+arg_0]
		and	eax, 10000h
		test	eax, eax
		jz	short loc_407FF1
		mov	eax, [ebp+arg_0]
		mov	[esp+4+var_4], eax
		call	sub_407D78
		jmp	short locret_407FF6
; ---------------------------------------------------------------------------

loc_407FF1:				; CODE XREF: sub_407E6A+178j
		mov	eax, offset aUnknownStatusE ; "unknown status error"

locret_407FF6:				; CODE XREF: sub_407E6A+E4j
					; sub_407E6A+EEj ...
		leave
		retn
sub_407E6A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407FF8	proc near		; CODE XREF: sub_4080B2+ABp
					; sub_4080B2+173p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		cmp	eax, 0FFFFFFF6h
		jz	short loc_408039
		cmp	eax, 0FFFFFFF6h
		jg	short loc_408014
		cmp	eax, 0FFFFFF80h
		jz	short loc_408047
		cmp	eax, 0FFFFFFF5h
		jz	short loc_408040
		jmp	short loc_40804E
; ---------------------------------------------------------------------------

loc_408014:				; CODE XREF: sub_407FF8+Ej
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40802B
		test	eax, eax
		jz	short loc_408024
		cmp	eax, 0FFFFFFF8h
		jz	short loc_408032
		jmp	short loc_40804E
; ---------------------------------------------------------------------------

loc_408024:				; CODE XREF: sub_407FF8+23j
		mov	eax, offset aOkay ; "okay"
		jmp	short loc_408053
; ---------------------------------------------------------------------------

loc_40802B:				; CODE XREF: sub_407FF8+1Fj
		mov	eax, offset aInvalidData ; "invalid data"
		jmp	short loc_408053
; ---------------------------------------------------------------------------

loc_408032:				; CODE XREF: sub_407FF8+28j
		mov	eax, offset aCtError ; "ct error"
		jmp	short loc_408053
; ---------------------------------------------------------------------------

loc_408039:				; CODE XREF: sub_407FF8+9j
		mov	eax, offset aTransmissionEr ; "transmission error"
		jmp	short loc_408053
; ---------------------------------------------------------------------------

loc_408040:				; CODE XREF: sub_407FF8+18j
		mov	eax, offset aMemoryAllocati ; "memory allocation error"
		jmp	short loc_408053
; ---------------------------------------------------------------------------

loc_408047:				; CODE XREF: sub_407FF8+13j
		mov	eax, offset aHtsiError ; "HTSI error"
		jmp	short loc_408053
; ---------------------------------------------------------------------------

loc_40804E:				; CODE XREF: sub_407FF8+1Aj
					; sub_407FF8+2Aj
		mov	eax, offset aUnknownCtApiEr ; "unknown CT-API error"

loc_408053:				; CODE XREF: sub_407FF8+31j
					; sub_407FF8+38j ...
		pop	ebp
		retn
sub_407FF8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408055	proc near		; DATA XREF: sub_408463+178o

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword ptr [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	eax, [eax+4]
		cmp	eax, 1
		jz	short loc_408094
		mov	eax, dword ptr [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_40808D
		mov	eax, offset aMemoryIccPrese ; "Memory ICC present"
		jmp	short loc_408092
; ---------------------------------------------------------------------------

loc_40808D:				; CODE XREF: sub_408055+2Fj
		mov	eax, offset aIccNotPresent ; "ICC not present"

loc_408092:				; CODE XREF: sub_408055+36j
		jmp	short loc_408099
; ---------------------------------------------------------------------------

loc_408094:				; CODE XREF: sub_408055+1Aj
		mov	eax, offset aProcessorIccPr ; "Processor ICC present"

loc_408099:				; CODE XREF: sub_408055:loc_408092j
		mov	[esp+18h+var_10], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aReaderSlotDS ; "reader slot %d: %s\n"
		call	sub_43CAF7
		leave
		retn
sub_408055	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4080B2	proc near		; CODE XREF: sub_408362+Cp
					; sub_408463+D9p

Dst		= dword	ptr -148h
Src		= dword	ptr -144h
Size		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_134		= dword	ptr -134h
var_130		= dword	ptr -130h
var_11C		= word ptr -11Ch
var_119		= byte ptr -119h
var_19		= byte ptr -19h
var_18		= byte ptr -18h
var_17		= byte ptr -17h
var_16		= byte ptr -16h
var_15		= byte ptr -15h
var_E		= byte ptr -0Eh
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 148h
		mov	[ebp+var_D], 1
		mov	[ebp+var_E], 2
		mov	[ebp+var_19], 20h
		mov	[ebp+var_18], 13h
		mov	[ebp+var_17], 0
		mov	[ebp+var_16], 80h
		mov	[ebp+var_15], 0
		mov	[ebp+var_11C], 100h
		mov	ecx, ds:dword_451404
		mov	eax, dword ptr [ebp+arg_0]
		movzx	eax, ax
		lea	edx, [ebp+var_119]
		mov	[esp+148h+var_130], edx
		lea	edx, [ebp+var_11C]
		mov	[esp+148h+var_134], edx
		lea	edx, [ebp+var_19]
		mov	[esp+148h+var_138], edx
		mov	[esp+148h+var_13C], 5
		lea	edx, [ebp+var_E]
		mov	[esp+148h+Size], edx
		lea	edx, [ebp+var_D]
		mov	[esp+148h+Src],	edx
		mov	[esp+148h+Dst],	eax
		call	ecx ; dword_451404
		sub	esp, 1Ch
		movsx	eax, al
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_408157
		movzx	eax, [ebp+var_11C]
		cmp	ax, 1
		jbe	short loc_408157
		movzx	eax, [ebp+var_11C]
		movzx	eax, ax
		sub	eax, 2
		movzx	eax, [ebp+eax+var_119]
		cmp	al, 90h
		jz	short loc_408183

loc_408157:				; CODE XREF: sub_4080B2+7Dj
					; sub_4080B2+8Aj
		mov	eax, [ebp+var_C]
		mov	[esp+148h+Dst],	eax
		call	sub_407FF8
		mov	[esp+148h+Size], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+148h+Src],	eax ; char
		mov	[esp+148h+Dst],	offset aCt_activate_ca ; "ct_activate_card: can't get status of r"...
		call	sub_43CB21
		mov	eax, 1000Ah
		jmp	locret_40832B
; ---------------------------------------------------------------------------

loc_408183:				; CODE XREF: sub_4080B2+A3j
		mov	[ebp+var_D], 1
		mov	[ebp+var_E], 2
		mov	[ebp+var_19], 20h
		mov	[ebp+var_18], 12h
		mov	[ebp+var_17], 1
		mov	[ebp+var_16], 1
		mov	[ebp+var_15], 0
		mov	[ebp+var_11C], 100h
		mov	ecx, ds:dword_451404
		mov	eax, dword ptr [ebp+arg_0]
		movzx	eax, ax
		lea	edx, [ebp+var_119]
		mov	[esp+148h+var_130], edx
		lea	edx, [ebp+var_11C]
		mov	[esp+148h+var_134], edx
		lea	edx, [ebp+var_19]
		mov	[esp+148h+var_138], edx
		mov	[esp+148h+var_13C], 5
		lea	edx, [ebp+var_E]
		mov	[esp+148h+Size], edx
		lea	edx, [ebp+var_D]
		mov	[esp+148h+Src],	edx
		mov	[esp+148h+Dst],	eax
		call	ecx ; dword_451404
		sub	esp, 1Ch
		movsx	eax, al
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40821F
		movzx	eax, [ebp+var_11C]
		cmp	ax, 1
		jbe	short loc_40821F
		movzx	eax, [ebp+var_11C]
		movzx	eax, ax
		sub	eax, 2
		movzx	eax, [ebp+eax+var_119]
		cmp	al, 90h
		jz	short loc_408275

loc_40821F:				; CODE XREF: sub_4080B2+145j
					; sub_4080B2+152j
		mov	eax, [ebp+var_C]
		mov	[esp+148h+Dst],	eax
		call	sub_407FF8
		mov	[esp+148h+Size], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+148h+Src],	eax ; char
		mov	[esp+148h+Dst],	offset aCt_activate__0 ; "ct_activate_card(%d):	activation failed"...
		call	sub_43CB21
		cmp	[ebp+var_C], 0
		jnz	short loc_40826B
		movzx	eax, [ebp+var_11C]
		movzx	eax, ax
		mov	[esp+148h+Size], eax
		lea	eax, [ebp+var_119]
		mov	[esp+148h+Src],	eax
		mov	[esp+148h+Dst],	offset aReceivedData ; "  received data:"
		call	sub_43CC18

loc_40826B:				; CODE XREF: sub_4080B2+193j
		mov	eax, 1000Ah
		jmp	locret_40832B
; ---------------------------------------------------------------------------

loc_408275:				; CODE XREF: sub_4080B2+16Bj
		movzx	eax, [ebp+var_11C]
		movzx	eax, ax
		sub	eax, 2
		cmp	eax, 21h
		jbe	short loc_4082A4
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+148h+Src],	eax ; char
		mov	[esp+148h+Dst],	offset aCt_activate__1 ; "ct_activate_card(%d):	ATR too	long\n"
		call	sub_43CB21
		mov	eax, 1000Ah
		jmp	locret_40832B
; ---------------------------------------------------------------------------

loc_4082A4:				; CODE XREF: sub_4080B2+1D3j
		movzx	eax, [ebp+var_11C]
		movzx	eax, ax
		sub	eax, 1
		movzx	eax, [ebp+eax+var_119]
		movzx	eax, al
		mov	edx, dword ptr [ebp+arg_0]
		imul	edx, 0A8h
		add	edx, offset dword_4511C0
		mov	[edx+4], eax
		movzx	eax, [ebp+var_11C]
		movzx	eax, ax
		sub	eax, 2
		mov	ecx, eax
		lea	edx, [ebp+var_119]
		mov	eax, dword ptr [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, 70h
		add	eax, offset dword_451160
		add	eax, 4
		mov	[esp+148h+Size], ecx ; Size
		mov	[esp+148h+Src],	edx ; Src
		mov	[esp+148h+Dst],	eax ; Dst
		call	memcpy
		movzx	eax, [ebp+var_11C]
		movzx	eax, ax
		sub	eax, 2
		mov	edx, dword ptr [ebp+arg_0]
		imul	edx, 0A8h
		add	edx, offset dword_4511F0
		mov	[edx+8], eax
		mov	eax, 0

locret_40832B:				; CODE XREF: sub_4080B2+CCj
					; sub_4080B2+1BEj ...
		leave
		retn
sub_4080B2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40832D	proc near		; DATA XREF: sub_408463+111o

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	edx, ds:dword_451408
		mov	eax, [ebp+arg_0]
		movzx	eax, ax
		mov	[esp+18h+var_18], eax
		call	edx ; dword_451408
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	dword ptr [eax], 0
		mov	eax, 0
		leave
		retn
sub_40832D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408362	proc near		; CODE XREF: sub_408388+22p
					; DATA XREF: sub_408463+125o

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_4080B2
		leave
		retn
sub_408362	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408375	proc near		; DATA XREF: sub_408463+13Ao

arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 7
		mov	eax, 0
		pop	ebp
		retn
sub_408375	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408388	proc near		; DATA XREF: sub_408463+14Fo

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= word ptr -10h
var_E		= byte ptr -0Eh
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511F0
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_4083C0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_408362
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4083C0
		mov	eax, [ebp+var_C]
		jmp	loc_40845E
; ---------------------------------------------------------------------------

loc_4083C0:				; CODE XREF: sub_408388+1Aj
					; sub_408388+2Ej
		mov	[ebp+var_D], 0
		mov	[ebp+var_E], 2
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	[ebp+var_10], ax
		mov	eax, ds:dword_451D20
		and	eax, 800h
		test	eax, eax
		jz	short loc_4083F9
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	[esp+38h+var_38], offset aCt_data ; "  CT_data:"
		call	sub_43CC18

loc_4083F9:				; CODE XREF: sub_408388+55j
		mov	ebx, ds:dword_451404
		mov	eax, [ebp+arg_8]
		movzx	edx, ax
		mov	eax, [ebp+arg_0]
		movzx	eax, ax
		mov	ecx, [ebp+arg_C]
		mov	[esp+38h+var_20], ecx
		lea	ecx, [ebp+var_10]
		mov	[esp+38h+var_24], ecx
		mov	ecx, [ebp+arg_4]
		mov	[esp+38h+var_28], ecx
		mov	[esp+38h+var_2C], edx
		lea	edx, [ebp+var_E]
		mov	[esp+38h+var_30], edx
		lea	edx, [ebp+var_D]
		mov	[esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		call	ebx ; dword_451404
		sub	esp, 1Ch
		movsx	eax, al
		mov	[ebp+var_C], eax
		movzx	eax, [ebp+var_10]
		movzx	edx, ax
		mov	eax, [ebp+arg_10]
		mov	[eax], edx
		cmp	[ebp+var_C], 0
		jz	short loc_408459
		mov	eax, 1000Ah
		jmp	short loc_40845E
; ---------------------------------------------------------------------------

loc_408459:				; CODE XREF: sub_408388+C8j
		mov	eax, 0

loc_40845E:				; CODE XREF: sub_408388+33j
					; sub_408388+CFj
		mov	ebx, [ebp+var_4]
		leave
		retn
sub_408388	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408463	proc near		; CODE XREF: sub_40A3E0+11Fp

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+arg_0], 0
		js	short loc_408478
		cmp	dword ptr [ebp+arg_0], 0FFFFh
		jle	short loc_408495

loc_408478:				; CODE XREF: sub_408463+Aj
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aOpen_ct_reader ; "open_ct_reader: invalid port %d request"...
		call	sub_43CB21
		mov	eax, 0FFFFFFFFh
		jmp	locret_408624
; ---------------------------------------------------------------------------

loc_408495:				; CODE XREF: sub_408463+13j
		call	sub_4079E2
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_4084AB
		mov	eax, [ebp+var_C]
		jmp	locret_408624
; ---------------------------------------------------------------------------

loc_4084AB:				; CODE XREF: sub_408463+3Ej
		mov	eax, dword ptr [ebp+arg_0]
		mov	edx, [ebp+var_C]
		imul	edx, 0A8h
		add	edx, offset dword_451160
		mov	[edx+4], ax
		mov	ecx, ds:dword_451400
		mov	eax, dword ptr [ebp+arg_0]
		movzx	edx, ax
		mov	eax, [ebp+var_C]
		movzx	eax, ax
		mov	dword ptr [esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	ecx ; dword_451400
		sub	esp, 8
		movsx	eax, al
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_408536
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_407FF8
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aApdu_open_ct_r ; "apdu_open_ct_reader	failed on port %d: "...
		call	sub_43CB21
		mov	eax, [ebp+var_C]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_407997
		mov	eax, 0FFFFFFFFh
		jmp	locret_408624
; ---------------------------------------------------------------------------

loc_408536:				; CODE XREF: sub_408463+86j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_4080B2
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_408566
		mov	eax, [ebp+var_C]
		imul	eax, 0A8h
		add	eax, offset dword_4511F0
		mov	dword ptr [eax+8], 0
		mov	[ebp+var_10], 0

loc_408566:				; CODE XREF: sub_408463+E5j
		mov	eax, [ebp+var_C]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	dword ptr [eax], offset	sub_40832D
		mov	eax, [ebp+var_C]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	dword ptr [eax+8], offset sub_408362
		mov	eax, [ebp+var_C]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	dword ptr [eax+0Ch], offset sub_408375
		mov	eax, [ebp+var_C]
		imul	eax, 0A8h
		add	eax, offset dword_451180
		mov	dword ptr [eax], offset	sub_408388
		mov	eax, [ebp+var_C]
		imul	eax, 0A8h
		add	eax, offset dword_451180
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_C]
		imul	eax, 0A8h
		add	eax, offset dword_451180
		mov	dword ptr [eax+8], offset sub_408055
		mov	eax, [ebp+var_C]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_C]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_407CBA
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_407997
		mov	eax, [ebp+var_C]

locret_408624:				; CODE XREF: sub_408463+2Dj
					; sub_408463+43j ...
		leave
		retn
sub_408463	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408626	proc near		; CODE XREF: sub_4089BB+8Dp
					; sub_408AF0+F7p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		cmp	[ebp+arg_0], 0
		jnz	short loc_40863C
		mov	eax, offset aOkay ; "okay"
		jmp	locret_408806
; ---------------------------------------------------------------------------

loc_40863C:				; CODE XREF: sub_408626+Aj
		mov	eax, [ebp+arg_0]
		and	eax, 80100000h
		cmp	eax, 80100000h
		jz	short loc_408655
		mov	eax, offset aInvalidPcScErr ; "invalid PC/SC error code"
		jmp	locret_408806
; ---------------------------------------------------------------------------

loc_408655:				; CODE XREF: sub_408626+23j
		and	[ebp+arg_0], 0FFFFh
		cmp	[ebp+arg_0], 6Ah ; switch 107 cases
		ja	loc_4087FB	; jumptable 00408673 default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_4495D0
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_408675:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aCancelled ; jumptable 00408673 case 2
		jmp	loc_408803
; ---------------------------------------------------------------------------

loc_408681:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aCanTDispose ; jumptable 00408673 case 14
		jmp	loc_408803
; ---------------------------------------------------------------------------

loc_40868D:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aInsufficientBu ; jumptable	00408673 case 8
		jmp	loc_408803
; ---------------------------------------------------------------------------

loc_408699:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aInvalidAtr	; jumptable 00408673 case 21
		jmp	loc_408803
; ---------------------------------------------------------------------------

loc_4086A5:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aInvalidHandle ; jumptable 00408673	case 3
		jmp	loc_408803
; ---------------------------------------------------------------------------

loc_4086B1:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aInvalidParamet ; jumptable	00408673 case 4
		jmp	loc_408803
; ---------------------------------------------------------------------------

loc_4086BD:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aInvalidTarget ; jumptable 00408673	case 5
		jmp	loc_408803
; ---------------------------------------------------------------------------

loc_4086C9:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aInvalidValue ; jumptable 00408673 case 17
		jmp	loc_408803
; ---------------------------------------------------------------------------

loc_4086D5:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aNoMemory ;	jumptable 00408673 case	6
		jmp	loc_408803
; ---------------------------------------------------------------------------

loc_4086E1:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aCommError ; jumptable 00408673 case 19
		jmp	loc_408803
; ---------------------------------------------------------------------------

loc_4086ED:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aInternalError ; jumptable 00408673	case 1
		jmp	loc_408803
; ---------------------------------------------------------------------------

loc_4086F9:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aUnknownError ; jumptable 00408673 case 20
		jmp	loc_408803
; ---------------------------------------------------------------------------

loc_408705:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aWaitedTooLong ; jumptable 00408673	case 7
		jmp	loc_408803
; ---------------------------------------------------------------------------

loc_408711:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aUnknownReader ; jumptable 00408673	case 9
		jmp	loc_408803
; ---------------------------------------------------------------------------

loc_40871D:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aTimeout ; jumptable 00408673 case 10
		jmp	loc_408803
; ---------------------------------------------------------------------------

loc_408729:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aSharingViolati ; jumptable	00408673 case 11
		jmp	loc_408803
; ---------------------------------------------------------------------------

loc_408735:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aNoSmartcard ; jumptable 00408673 case 12
		jmp	loc_408803
; ---------------------------------------------------------------------------

loc_408741:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aUnknownCard ; jumptable 00408673 case 13
		jmp	loc_408803
; ---------------------------------------------------------------------------

loc_40874D:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aProtoMismatch ; jumptable 00408673	case 15
		jmp	loc_408803
; ---------------------------------------------------------------------------

loc_408759:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aNotReady ;	jumptable 00408673 case	16
		jmp	loc_408803
; ---------------------------------------------------------------------------

loc_408765:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aSystemCancelle ; jumptable	00408673 case 18
		jmp	loc_408803
; ---------------------------------------------------------------------------

loc_408771:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aNotTransacted ; jumptable 00408673	case 22
		jmp	loc_408803
; ---------------------------------------------------------------------------

loc_40877D:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aReaderUnavaila ; jumptable	00408673 case 23
		jmp	short loc_408803
; ---------------------------------------------------------------------------

loc_408786:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aUnsupportedCar ; jumptable	00408673 case 101
		jmp	short loc_408803
; ---------------------------------------------------------------------------

loc_40878F:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aUnresponsiveCa ; jumptable	00408673 case 102
		jmp	short loc_408803
; ---------------------------------------------------------------------------

loc_408798:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aUnpoweredCard ; jumptable 00408673	case 103
		jmp	short loc_408803
; ---------------------------------------------------------------------------

loc_4087A1:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aResetCard ; jumptable 00408673 case 104
		jmp	short loc_408803
; ---------------------------------------------------------------------------

loc_4087AA:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aRemovedCard ; jumptable 00408673 case 105
		jmp	short loc_408803
; ---------------------------------------------------------------------------

loc_4087B3:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aInsertedCard ; jumptable 00408673 case 106
		jmp	short loc_408803
; ---------------------------------------------------------------------------

loc_4087BC:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aUnsupportedFea ; jumptable	00408673 case 31
		jmp	short loc_408803
; ---------------------------------------------------------------------------

loc_4087C5:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aPciTooSmall ; jumptable 00408673 case 25
		jmp	short loc_408803
; ---------------------------------------------------------------------------

loc_4087CE:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aReaderUnsuppor ; jumptable	00408673 case 26
		jmp	short loc_408803
; ---------------------------------------------------------------------------

loc_4087D7:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aDuplicateReade ; jumptable	00408673 case 27
		jmp	short loc_408803
; ---------------------------------------------------------------------------

loc_4087E0:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aCardUnsupporte ; jumptable	00408673 case 28
		jmp	short loc_408803
; ---------------------------------------------------------------------------

loc_4087E9:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aNoService ; jumptable 00408673 case 29
		jmp	short loc_408803
; ---------------------------------------------------------------------------

loc_4087F2:				; CODE XREF: sub_408626+4Dj
					; DATA XREF: .rdata:off_4495D0o
		mov	[ebp+var_4], offset aServiceStopped ; jumptable	00408673 case 30
		jmp	short loc_408803
; ---------------------------------------------------------------------------

loc_4087FB:				; CODE XREF: sub_408626+3Aj
					; sub_408626+4Dj
					; DATA XREF: ...
		mov	[ebp+var_4], offset aUnknownPcScErr ; jumptable	00408673 default case
		nop

loc_408803:				; CODE XREF: sub_408626+56j
					; sub_408626+62j ...
		mov	eax, [ebp+var_4]

locret_408806:				; CODE XREF: sub_408626+11j
					; sub_408626+2Aj
		leave
		retn
sub_408626	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408808	proc near		; CODE XREF: sub_4089BB+AFp
					; sub_408AF0+119p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		cmp	eax, 80100009h
		jz	loc_4088BC
		cmp	eax, 80100009h
		ja	short loc_40885C
		cmp	eax, 80100005h
		ja	short loc_408845
		cmp	eax, 80100003h
		jnb	loc_4088E0
		test	eax, eax
		jz	short loc_408898
		cmp	eax, 80100002h
		jz	short loc_4088A1
		jmp	loc_4088E9
; ---------------------------------------------------------------------------

loc_408845:				; CODE XREF: sub_408808+20j
		cmp	eax, 80100006h
		jz	short loc_4088AA
		cmp	eax, 80100008h
		jz	loc_4088E0
		jmp	loc_4088E9
; ---------------------------------------------------------------------------

loc_40885C:				; CODE XREF: sub_408808+19j
		cmp	eax, 80100011h
		jz	short loc_4088E0
		cmp	eax, 80100011h
		ja	short loc_408881
		cmp	eax, 8010000Bh
		jz	short loc_4088C5
		cmp	eax, 8010000Bh
		jb	short loc_4088B3
		cmp	eax, 8010000Ch
		jz	short loc_4088CE
		jmp	short loc_4088E9
; ---------------------------------------------------------------------------

loc_408881:				; CODE XREF: sub_408808+60j
		cmp	eax, 8010001Dh
		jb	short loc_4088E9
		cmp	eax, 8010001Eh
		jbe	short loc_4088BC
		cmp	eax, 80100069h
		jz	short loc_4088D7
		jmp	short loc_4088E9
; ---------------------------------------------------------------------------

loc_408898:				; CODE XREF: sub_408808+2Fj
		mov	[ebp+var_4], 0
		jmp	short loc_4088F1
; ---------------------------------------------------------------------------

loc_4088A1:				; CODE XREF: sub_408808+36j
		mov	[ebp+var_4], 1000Dh
		jmp	short loc_4088F1
; ---------------------------------------------------------------------------

loc_4088AA:				; CODE XREF: sub_408808+42j
		mov	[ebp+var_4], 10001h
		jmp	short loc_4088F1
; ---------------------------------------------------------------------------

loc_4088B3:				; CODE XREF: sub_408808+6Ej
		mov	[ebp+var_4], 1000Ah
		jmp	short loc_4088F1
; ---------------------------------------------------------------------------

loc_4088BC:				; CODE XREF: sub_408808+Ej
					; sub_408808+85j
		mov	[ebp+var_4], 1000Ch
		jmp	short loc_4088F1
; ---------------------------------------------------------------------------

loc_4088C5:				; CODE XREF: sub_408808+67j
		mov	[ebp+var_4], 10006h
		jmp	short loc_4088F1
; ---------------------------------------------------------------------------

loc_4088CE:				; CODE XREF: sub_408808+75j
		mov	[ebp+var_4], 10008h
		jmp	short loc_4088F1
; ---------------------------------------------------------------------------

loc_4088D7:				; CODE XREF: sub_408808+8Cj
		mov	[ebp+var_4], 10008h
		jmp	short loc_4088F1
; ---------------------------------------------------------------------------

loc_4088E0:				; CODE XREF: sub_408808+27j
					; sub_408808+49j ...
		mov	[ebp+var_4], 10002h
		jmp	short loc_4088F1
; ---------------------------------------------------------------------------

loc_4088E9:				; CODE XREF: sub_408808+38j
					; sub_408808+4Fj ...
		mov	[ebp+var_4], 1000Bh
		nop

loc_4088F1:				; CODE XREF: sub_408808+97j
					; sub_408808+A0j ...
		mov	eax, [ebp+var_4]
		leave
		retn
sub_408808	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4088F6	proc near		; DATA XREF: sub_40970C+4A4o

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword ptr [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	eax, [eax+10h]
		test	eax, eax
		jz	loc_4089A6
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aReaderSlotDAct ; "reader slot	%d: active protocol:"
		call	sub_43CAF7
		mov	eax, dword ptr [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	eax, [eax+14h]
		and	eax, 1
		test	al, al
		jz	short loc_40894E
		mov	[esp+18h+var_18], offset aT0 ; " T0"
		call	sub_43CBE8
		jmp	short loc_408998
; ---------------------------------------------------------------------------

loc_40894E:				; CODE XREF: sub_4088F6+48j
		mov	eax, dword ptr [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	eax, [eax+14h]
		and	eax, 2
		test	eax, eax
		jz	short loc_408974
		mov	[esp+18h+var_18], offset aT1 ; " T1"
		call	sub_43CBE8
		jmp	short loc_408998
; ---------------------------------------------------------------------------

loc_408974:				; CODE XREF: sub_4088F6+6Ej
		mov	eax, dword ptr [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	eax, [eax+14h]
		and	eax, 4
		test	eax, eax
		jz	short loc_408998
		mov	[esp+18h+var_18], offset aRaw ;	" raw"
		call	sub_43CBE8

loc_408998:				; CODE XREF: sub_4088F6+56j
					; sub_4088F6+7Cj ...
		mov	[esp+18h+var_18], offset asc_4497AA ; "\n"
		call	sub_43CBE8
		jmp	short locret_4089B9
; ---------------------------------------------------------------------------

loc_4089A6:				; CODE XREF: sub_4088F6+19j
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aReaderSlotDNot ; "reader slot	%d: not	connected\n"
		call	sub_43CAF7

locret_4089B9:				; CODE XREF: sub_4088F6+AEj
		leave
		retn
sub_4088F6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4089BB	proc near		; CODE XREF: sub_408AD6+13p

var_58		= dword	ptr -58h
var_54		= byte ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_44		= dword	ptr -44h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		lea	eax, [ebp+var_44]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 0Eh
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511B0
		mov	eax, [eax+8]
		mov	[ebp+var_44], eax
		mov	[ebp+var_3C], 0
		mov	ecx, ds:dword_451D84
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	eax, [eax+0Ch]
		mov	[esp+58h+var_4C], 1
		lea	edx, [ebp+var_44]
		mov	[esp+58h+var_50], edx
		mov	dword ptr [esp+58h+var_54], 0
		mov	[esp+58h+var_58], eax
		call	ecx ; dword_451D84
		sub	esp, 10h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 8010000Ah
		jnz	short loc_408A3C
		mov	[ebp+var_C], 0

loc_408A3C:				; CODE XREF: sub_4089BB+78j
		cmp	[ebp+var_C], 0
		jz	short loc_408A71
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	sub_408626
		mov	edx, [ebp+var_C]
		mov	[esp+58h+var_50], edx
		mov	dword ptr [esp+58h+var_54], eax	; char
		mov	[esp+58h+var_58], offset aPcsc_get_statu ; "pcsc_get_status_change failed: %s (0x%l"...
		call	sub_43CB21
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_58], eax
		call	sub_408808
		jmp	short loc_408ACF
; ---------------------------------------------------------------------------

loc_408A71:				; CODE XREF: sub_4089BB+85j
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_38]
		and	eax, 20h
		test	eax, eax
		jz	short loc_408AAE
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 2
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+var_38]
		and	eax, 200h
		test	eax, eax
		jnz	short loc_408AAE
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 4
		mov	eax, [ebp+arg_4]
		mov	[eax], edx

loc_408AAE:				; CODE XREF: sub_4089BB+C7j
					; sub_4089BB+E2j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		and	eax, 6
		cmp	eax, 6
		jnz	short loc_408ACA
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 1
		mov	eax, [ebp+arg_4]
		mov	[eax], edx

loc_408ACA:				; CODE XREF: sub_4089BB+FEj
		mov	eax, 0

loc_408ACF:				; CODE XREF: sub_4089BB+B4j
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4089BB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408AD6	proc near		; DATA XREF: sub_40970C+47Bo

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_4089BB
		leave
		retn
sub_408AD6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408AF0	proc near		; CODE XREF: sub_408C10+2Fp

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511F0
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_408B27
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_409104
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_408B27
		mov	eax, [ebp+var_C]
		jmp	locret_408C0E
; ---------------------------------------------------------------------------

loc_408B27:				; CODE XREF: sub_408AF0+19j
					; sub_408AF0+2Dj
		mov	eax, ds:dword_451D20
		and	eax, 800h
		test	eax, eax
		jz	short loc_408B4F
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], eax
		mov	[esp+38h+var_38], offset aPcsc_data ; "	 PCSC_data:"
		call	sub_43CC18

loc_408B4F:				; CODE XREF: sub_408AF0+43j
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	eax, [eax+14h]
		and	eax, 2
		test	eax, eax
		jz	short loc_408B70
		mov	[ebp+var_14], 2
		jmp	short loc_408B77
; ---------------------------------------------------------------------------

loc_408B70:				; CODE XREF: sub_408AF0+75j
		mov	[ebp+var_14], 1

loc_408B77:				; CODE XREF: sub_408AF0+7Ej
		mov	[ebp+var_10], 8
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		mov	ecx, ds:dword_451D64
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	eax, [eax+10h]
		lea	edx, [ebp+var_18]
		mov	[esp+38h+var_20], edx
		mov	edx, [ebp+arg_C]
		mov	[esp+38h+var_24], edx
		mov	[esp+38h+var_28], 0
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+var_2C], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+38h+var_30], edx
		lea	edx, [ebp+var_14]
		mov	dword ptr [esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		call	ecx ; dword_451D64
		sub	esp, 1Ch
		mov	[ebp+var_C], eax
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx
		cmp	[ebp+var_C], 0
		jz	short loc_408C03
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_408626
		mov	edx, [ebp+var_C]
		mov	[esp+38h+var_30], edx
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aPcsc_transmitF ; "pcsc_transmit failed: %s (0x%lx)\n"
		call	sub_43CB21

loc_408C03:				; CODE XREF: sub_408AF0+EFj
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_408808

locret_408C0E:				; CODE XREF: sub_408AF0+32j
		leave
		retn
sub_408AF0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408C10	proc near		; DATA XREF: sub_40970C+490o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_14]
		mov	[esp+28h+var_14], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+28h+var_18], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_408AF0
		leave
		retn
sub_408C10	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408C46	proc near		; CODE XREF: sub_408CE8+2Fp

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	ebx, ds:dword_451D8C
		cmp	[ebp+arg_14], 0
		jz	short loc_408C60
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		jmp	short loc_408C65
; ---------------------------------------------------------------------------

loc_408C60:				; CODE XREF: sub_408C46+11j
		mov	eax, 0

loc_408C65:				; CODE XREF: sub_408C46+18j
		mov	edx, [ebp+arg_0]
		imul	edx, 0A8h
		add	edx, offset dword_451190
		mov	edx, [edx+10h]
		mov	ecx, [ebp+arg_14]
		mov	[esp+38h+var_20], ecx
		mov	[esp+38h+var_24], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], eax
		mov	[esp+38h+var_38], edx
		call	ebx ; dword_451D8C
		sub	esp, 1Ch
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_408CDE
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_408626
		mov	edx, [ebp+var_C]
		mov	[esp+38h+var_30], edx
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aPcsc_controlFa ; "pcsc_control failed: %s (0x%lx)\n"
		call	sub_43CB21
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_408808
		jmp	short loc_408CE3
; ---------------------------------------------------------------------------

loc_408CDE:				; CODE XREF: sub_408C46+67j
		mov	eax, 0

loc_408CE3:				; CODE XREF: sub_408C46+96j
		mov	ebx, [ebp+var_4]
		leave
		retn
sub_408C46	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408CE8	proc near		; CODE XREF: sub_409117+5Ap
					; sub_409117+33Ep ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_14]
		mov	[esp+28h+var_14], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+28h+var_18], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_408C46
		leave
		retn
sub_408CE8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408D1E	proc near		; CODE XREF: sub_408D8C+Cp

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	edx, ds:dword_451D68
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	eax, [eax+0Ch]
		mov	[esp+18h+var_18], eax
		call	edx ; dword_451D68
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511B0
		mov	eax, [eax+8]
		mov	[esp+1Ch+var_1C], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511B0
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	dword ptr [eax], 0
		mov	eax, 0
		leave
		retn
sub_408D1E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408D8C	proc near		; DATA XREF: sub_40970C+452o

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_408D1E
		leave
		retn
sub_408D8C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408D9F	proc near		; CODE XREF: sub_4090D7+20p
					; DATA XREF: sub_40970C+428o

var_138		= dword	ptr -138h
var_134		= dword	ptr -134h
var_130		= dword	ptr -130h
var_12C		= dword	ptr -12Ch
var_128		= dword	ptr -128h
var_124		= dword	ptr -124h
var_120		= dword	ptr -120h
var_116		= byte ptr -116h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 130h
		cmp	[ebp+arg_0], 0
		js	short loc_408DB6
		cmp	[ebp+arg_0], 3
		jle	short loc_408DD4

loc_408DB6:				; CODE XREF: sub_408D9F+Fj
		mov	[esp+138h+var_130], 5E8h ; int
		mov	[esp+138h+var_134], offset a____Gnupg22__1 ; "../../gnupg2-2.0.30/scd/apdu.c"
		mov	[esp+138h+var_138], offset aSlot0SlotMax_r ; "slot >= 0	&& slot	< MAX_READER"
		call	sub_442650
		jmp	short loc_408DD5
; ---------------------------------------------------------------------------

loc_408DD4:				; CODE XREF: sub_408D9F+15j
		nop

loc_408DD5:				; CODE XREF: sub_408D9F+33j
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_408DF4
		mov	eax, 1000Fh
		jmp	loc_40900E
; ---------------------------------------------------------------------------

loc_408DF4:				; CODE XREF: sub_408D9F+49j
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511F0
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	dword ptr [eax+8], 0
		mov	ecx, ds:dword_451D80
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, 30h
		add	eax, offset dword_451160
		lea	esi, [eax+14h]
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, 30h
		add	eax, offset dword_451160
		lea	ebx, [eax+10h]
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511B0
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	eax, [eax+0Ch]
		mov	[esp+138h+var_124], esi
		mov	[esp+138h+var_128], ebx
		mov	[esp+138h+var_12C], 3
		mov	[esp+138h+var_130], 1
		mov	[esp+138h+var_134], edx
		mov	[esp+138h+var_138], eax
		call	ecx ; dword_451D80
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_408EF8
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	dword ptr [eax+10h], 0
		cmp	[ebp+var_C], 8010000Ch
		jz	loc_408FF8
		mov	eax, [ebp+var_C]
		mov	[esp+138h+var_138], eax
		call	sub_408626
		mov	edx, [ebp+var_C]
		mov	[esp+138h+var_130], edx
		mov	[esp+138h+var_134], eax	; char
		mov	[esp+138h+var_138], offset aPcsc_connectFa ; "pcsc_connect failed: %s (0x%lx)\n"
		call	sub_43CB21
		jmp	loc_408FF8
; ---------------------------------------------------------------------------

loc_408EF8:				; CODE XREF: sub_408D9F+10Ej
		mov	eax, [ebp+arg_0]
		mov	[esp+138h+var_138], eax
		call	sub_409117
		mov	[ebp+var_14], 21h
		mov	[ebp+var_10], 0F9h
		mov	ecx, ds:dword_451D7C
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, 70h
		add	eax, offset dword_451160
		lea	ebx, [eax+4]
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	eax, [eax+10h]
		lea	edx, [ebp+var_14]
		mov	[esp+138h+var_120], edx
		mov	[esp+138h+var_124], ebx
		lea	edx, [ebp+var_1C]
		mov	[esp+138h+var_128], edx
		lea	edx, [ebp+var_18]
		mov	[esp+138h+var_12C], edx
		lea	edx, [ebp+var_10]
		mov	[esp+138h+var_130], edx
		lea	edx, [ebp+var_116]
		mov	[esp+138h+var_134], edx	; char
		mov	[esp+138h+var_138], eax
		call	ecx ; dword_451D7C
		sub	esp, 1Ch
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_408FA2
		mov	ebx, [ebp+var_10]
		mov	eax, [ebp+var_C]
		mov	[esp+138h+var_138], eax
		call	sub_408626
		mov	[esp+138h+var_12C], ebx
		mov	edx, [ebp+var_C]
		mov	[esp+138h+var_130], edx
		mov	[esp+138h+var_134], eax	; char
		mov	[esp+138h+var_138], offset aPcsc_statusFai ; "pcsc_status failed: %s (0x%lx) %lu\n"
		call	sub_43CB21
		jmp	short loc_408FF8
; ---------------------------------------------------------------------------

loc_408FA2:				; CODE XREF: sub_408D9F+1D6j
		mov	eax, [ebp+var_14]
		cmp	eax, 21h
		jbe	short loc_408FB6
		mov	[esp+138h+var_138], offset aAtrReturnedByP ; "ATR returned by pcsc_status is too larg"...
		call	sub_43CB91
; ---------------------------------------------------------------------------

loc_408FB6:				; CODE XREF: sub_408D9F+209j
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		imul	edx, 0A8h
		add	edx, offset dword_4511F0
		mov	[edx+8], eax
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	dword ptr [eax], 7
		mov	eax, [ebp+var_1C]
		mov	edx, eax
		and	edx, 1
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	[eax+8], edx

loc_408FF8:				; CODE XREF: sub_408D9F+12Cj
					; sub_408D9F+154j ...
		mov	eax, [ebp+arg_0]
		mov	[esp+138h+var_138], eax
		call	sub_407CBA
		mov	eax, [ebp+var_C]
		mov	[esp+138h+var_138], eax
		call	sub_408808

loc_40900E:				; CODE XREF: sub_408D9F+50j
		lea	esp, [ebp-8]
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_408D9F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409015	proc near		; CODE XREF: sub_4090D7+Cp
					; DATA XREF: sub_40970C+43Do

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		js	short loc_409027
		cmp	[ebp+arg_0], 3
		jle	short loc_409045

loc_409027:				; CODE XREF: sub_409015+Aj
		mov	[esp+28h+var_20], 62Bh ; int
		mov	[esp+28h+var_24], offset a____Gnupg22__1 ; "../../gnupg2-2.0.30/scd/apdu.c"
		mov	[esp+28h+var_28], offset aSlot0SlotMax_r ; "slot >= 0 && slot <	MAX_READER"
		call	sub_442650
		jmp	short loc_409046
; ---------------------------------------------------------------------------

loc_409045:				; CODE XREF: sub_409015+10j
		nop

loc_409046:				; CODE XREF: sub_409015+2Ej
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_409062
		mov	eax, 0
		jmp	short locret_4090D5
; ---------------------------------------------------------------------------

loc_409062:				; CODE XREF: sub_409015+44j
		mov	edx, ds:dword_451D5C
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	eax, [eax+10h]
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	edx ; dword_451D5C
		sub	esp, 8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4090BB
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_408626
		mov	edx, [ebp+var_C]
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], eax ;	char
		mov	[esp+28h+var_28], offset aPcsc_disconnec ; "pcsc_disconnect failed: %s (0x%lx)\n"
		call	sub_43CB21
		mov	eax, 1000Ah
		jmp	short locret_4090D5
; ---------------------------------------------------------------------------

loc_4090BB:				; CODE XREF: sub_409015+7Bj
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	dword ptr [eax+10h], 0
		mov	eax, 0

locret_4090D5:				; CODE XREF: sub_409015+4Bj
					; sub_409015+A4j
		leave
		retn
sub_409015	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4090D7	proc near		; CODE XREF: sub_409104+Cp

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_409015
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4090FF
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_408D9F
		mov	[ebp+var_C], eax

loc_4090FF:				; CODE XREF: sub_4090D7+18j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4090D7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409104	proc near		; CODE XREF: sub_408AF0+21p
					; sub_409CFE+34p ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_4090D7
		leave
		retn
sub_409104	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409117	proc near		; CODE XREF: sub_408D9F+15Fp

Str		= dword	ptr -168h
SubStr		= dword	ptr -164h
var_160		= dword	ptr -160h
var_15C		= dword	ptr -15Ch
var_158		= dword	ptr -158h
var_154		= dword	ptr -154h
var_13D		= byte ptr -13Dh
var_13C		= byte ptr -13Ch
var_13B		= byte ptr -13Bh
var_13A		= byte ptr -13Ah
var_139		= byte ptr -139h
var_138		= dword	ptr -138h
var_134		= byte ptr -134h
var_34		= dword	ptr -34h
var_2D		= byte ptr -2Dh
var_2C		= dword	ptr -2Ch
var_25		= byte ptr -25h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 168h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0FFFFFFFFh
		mov	[ebp+var_138], 100h
		lea	eax, [ebp+var_138]
		mov	[esp+168h+var_154], eax
		lea	eax, [ebp+var_134]
		mov	[esp+168h+var_158], eax
		mov	[esp+168h+var_15C], 0
		mov	[esp+168h+var_160], 0
		mov	[esp+168h+SubStr], 313520h
		mov	eax, [ebp+arg_0]
		mov	[esp+168h+Str],	eax
		call	sub_408CE8
		mov	dword ptr [ebp+var_24],	eax
		cmp	dword ptr [ebp+var_24],	0
		jz	short loc_40919C
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+168h+SubStr], eax ; char
		mov	[esp+168h+Str],	offset aPcsc_vendor_sp ; "pcsc_vendor_specific_init: GET_FEATURE_"...
		call	sub_43CB21
		mov	eax, 6A81h
		jmp	locret_40970A
; ---------------------------------------------------------------------------

loc_40919C:				; CODE XREF: sub_409117+66j
		lea	eax, [ebp+var_134]
		mov	[ebp+var_18], eax
		jmp	loc_409288
; ---------------------------------------------------------------------------

loc_4091AA:				; CODE XREF: sub_409117+182j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		mov	[ebp+var_25], al
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_2C], eax
		add	[ebp+var_18], 1
		mov	[ebp+var_1C], 0
		cmp	[ebp+var_2C], 1
		jnz	short loc_4091E2
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_1C], eax
		jmp	short loc_40920C
; ---------------------------------------------------------------------------

loc_4091E2:				; CODE XREF: sub_409117+BBj
		cmp	[ebp+var_2C], 2
		jnz	short loc_4091F8
		mov	eax, [ebp+var_18]
		mov	[esp+168h+Str],	eax
		call	sub_40783E
		mov	[ebp+var_1C], eax
		jmp	short loc_40920C
; ---------------------------------------------------------------------------

loc_4091F8:				; CODE XREF: sub_409117+CFj
		cmp	[ebp+var_2C], 4
		jnz	short loc_40920C
		mov	eax, [ebp+var_18]
		mov	[esp+168h+Str],	eax
		call	sub_407868
		mov	[ebp+var_1C], eax

loc_40920C:				; CODE XREF: sub_409117+C9j
					; sub_409117+DFj ...
		cmp	[ebp+var_25], 6
		jnz	short loc_409229
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		lea	edx, dword_451190[eax]
		mov	eax, [ebp+var_1C]
		mov	[edx+18h], eax
		jmp	short loc_409252
; ---------------------------------------------------------------------------

loc_409229:				; CODE XREF: sub_409117+F9j
		cmp	[ebp+var_25], 7
		jnz	short loc_409246
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		lea	edx, dword_4511A0[eax]
		mov	eax, [ebp+var_1C]
		mov	[edx+0Ch], eax
		jmp	short loc_409252
; ---------------------------------------------------------------------------

loc_409246:				; CODE XREF: sub_409117+116j
		cmp	[ebp+var_25], 12h
		jnz	short loc_409252
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_14], eax

loc_409252:				; CODE XREF: sub_409117+110j
					; sub_409117+12Dj ...
		mov	eax, ds:dword_451D20
		and	eax, 800h
		test	eax, eax
		jz	short loc_409282
		movzx	eax, [ebp+var_25]
		mov	edx, [ebp+var_1C]
		mov	[esp+168h+var_15C], edx
		mov	edx, [ebp+var_2C]
		mov	[esp+168h+var_160], edx
		mov	[esp+168h+SubStr], eax ; char
		mov	[esp+168h+Str],	offset aFeatureCode02x ; "feature: code=%02X, len=%d, v=%02X\n"
		call	sub_43CBBE

loc_409282:				; CODE XREF: sub_409117+147j
		mov	eax, [ebp+var_2C]
		add	[ebp+var_18], eax

loc_409288:				; CODE XREF: sub_409117+8Ej
		mov	eax, [ebp+var_138]
		lea	edx, [ebp+var_134]
		add	eax, edx
		cmp	eax, [ebp+var_18]
		ja	loc_4091AA
		cmp	[ebp+var_14], 0FFFFFFFFh
		jnz	loc_40941A
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511B0
		mov	eax, [eax+8]
		test	eax, eax
		jz	loc_409410
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511B0
		mov	eax, [eax+8]
		mov	[esp+168h+SubStr], offset SubStr ; "SPRx32"
		mov	[esp+168h+Str],	eax ; Str
		call	strstr
		test	eax, eax
		jz	short loc_409315
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	dword ptr [eax+0Ch], 1
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511D0
		mov	dword ptr [eax], 1
		jmp	loc_409410
; ---------------------------------------------------------------------------

loc_409315:				; CODE XREF: sub_409117+1CEj
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511B0
		mov	eax, [eax+8]
		mov	[esp+168h+SubStr], offset aSt2xxx ; "ST-2xxx"
		mov	[esp+168h+Str],	eax ; Str
		call	strstr
		test	eax, eax
		jz	short loc_409368
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511A0
		mov	dword ptr [eax+14h], 0Fh
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511D0
		mov	dword ptr [eax], 1
		jmp	loc_409410
; ---------------------------------------------------------------------------

loc_409368:				; CODE XREF: sub_409117+221j
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511B0
		mov	eax, [eax+8]
		mov	[esp+168h+SubStr], offset aCyberjack ; "cyberJack"
		mov	[esp+168h+Str],	eax ; Str
		call	strstr
		test	eax, eax
		jnz	short loc_4093FC
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511B0
		mov	eax, [eax+8]
		mov	[esp+168h+SubStr], offset aDigipass ; "DIGIPASS"
		mov	[esp+168h+Str],	eax ; Str
		call	strstr
		test	eax, eax
		jnz	short loc_4093FC
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511B0
		mov	eax, [eax+8]
		mov	[esp+168h+SubStr], offset aGnuk	; "Gnuk"
		mov	[esp+168h+Str],	eax ; Str
		call	strstr
		test	eax, eax
		jnz	short loc_4093FC
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511B0
		mov	eax, [eax+8]
		mov	[esp+168h+SubStr], offset aKaan	; "KAAN"
		mov	[esp+168h+Str],	eax ; Str
		call	strstr
		test	eax, eax
		jz	short loc_409410

loc_4093FC:				; CODE XREF: sub_409117+274j
					; sub_409117+299j ...
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511D0
		mov	dword ptr [eax], 1

loc_409410:				; CODE XREF: sub_409117+1A5j
					; sub_409117+1F9j ...
		mov	eax, 0
		jmp	locret_40970A
; ---------------------------------------------------------------------------

loc_40941A:				; CODE XREF: sub_409117+18Cj
		mov	[ebp+var_138], 100h
		lea	eax, [ebp+var_138]
		mov	[esp+168h+var_154], eax
		lea	eax, [ebp+var_134]
		mov	[esp+168h+var_158], eax
		mov	[esp+168h+var_15C], 0
		mov	[esp+168h+var_160], 0
		mov	eax, [ebp+var_14]
		mov	[esp+168h+SubStr], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+168h+Str],	eax
		call	sub_408CE8
		mov	dword ptr [ebp+var_24],	eax
		cmp	dword ptr [ebp+var_24],	0
		jz	short loc_409480
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+168h+SubStr], eax ; char
		mov	[esp+168h+Str],	offset aPcsc_vendor__0 ; "pcsc_vendor_specific_init: GET_TLV_IOCT"...
		call	sub_43CB21
		mov	eax, 6A81h
		jmp	locret_40970A
; ---------------------------------------------------------------------------

loc_409480:				; CODE XREF: sub_409117+34Aj
		lea	eax, [ebp+var_134]
		mov	[ebp+var_18], eax
		jmp	loc_4095BE
; ---------------------------------------------------------------------------

loc_40948E:				; CODE XREF: sub_409117+4B8j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		mov	[ebp+var_2D], al
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_34], eax
		add	[ebp+var_18], 1
		mov	[ebp+var_20], 0
		cmp	[ebp+var_34], 1
		jnz	short loc_4094C6
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_20], eax
		jmp	short loc_409534
; ---------------------------------------------------------------------------

loc_4094C6:				; CODE XREF: sub_409117+39Fj
		cmp	[ebp+var_34], 2
		jnz	short loc_4094ED
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 8
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, edx
		mov	[ebp+var_20], eax
		jmp	short loc_409534
; ---------------------------------------------------------------------------

loc_4094ED:				; CODE XREF: sub_409117+3B3j
		cmp	[ebp+var_34], 4
		jnz	short loc_409534
		mov	eax, [ebp+var_18]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+var_18]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 10h
		or	edx, eax
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 8
		or	edx, eax
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, edx
		mov	[ebp+var_20], eax

loc_409534:				; CODE XREF: sub_409117+3ADj
					; sub_409117+3D4j ...
		cmp	[ebp+var_2D], 6
		jnz	short loc_409551
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+arg_0]
		imul	edx, 0A8h
		add	edx, offset dword_4511A0
		mov	[edx+10h], eax
		jmp	short loc_409588
; ---------------------------------------------------------------------------

loc_409551:				; CODE XREF: sub_409117+421j
		cmp	[ebp+var_2D], 7
		jnz	short loc_40956E
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+arg_0]
		imul	edx, 0A8h
		add	edx, offset dword_4511A0
		mov	[edx+14h], eax
		jmp	short loc_409588
; ---------------------------------------------------------------------------

loc_40956E:				; CODE XREF: sub_409117+43Ej
		cmp	[ebp+var_2D], 0Bh
		jnz	short loc_40957C
		mov	eax, [ebp+var_20]
		mov	[ebp+var_C], eax
		jmp	short loc_409588
; ---------------------------------------------------------------------------

loc_40957C:				; CODE XREF: sub_409117+45Bj
		cmp	[ebp+var_2D], 0Ch
		jnz	short loc_409588
		mov	eax, [ebp+var_20]
		mov	[ebp+var_10], eax

loc_409588:				; CODE XREF: sub_409117+438j
					; sub_409117+455j ...
		mov	eax, ds:dword_451D20
		and	eax, 800h
		test	eax, eax
		jz	short loc_4095B8
		movzx	eax, [ebp+var_2D]
		mov	edx, [ebp+var_20]
		mov	[esp+168h+var_15C], edx
		mov	edx, [ebp+var_34]
		mov	[esp+168h+var_160], edx
		mov	[esp+168h+SubStr], eax ; char
		mov	[esp+168h+Str],	offset aTlvPropertiesT ; "TLV properties: tag=%02X, len=%d, v=%08"...
		call	sub_43CBBE

loc_4095B8:				; CODE XREF: sub_409117+47Dj
		mov	eax, [ebp+var_34]
		add	[ebp+var_18], eax

loc_4095BE:				; CODE XREF: sub_409117+372j
		mov	eax, [ebp+var_138]
		lea	edx, [ebp+var_134]
		add	eax, edx
		cmp	eax, [ebp+var_18]
		ja	loc_40948E
		cmp	[ebp+var_C], 982h
		jnz	short loc_409653
		cmp	[ebp+var_10], 8
		jnz	short loc_409653
		mov	[ebp+var_13D], 0B5h
		mov	[ebp+var_13C], 1
		mov	[ebp+var_13B], 0
		mov	[ebp+var_13A], 3
		mov	[ebp+var_139], 0
		mov	[esp+168h+var_154], 0
		mov	[esp+168h+var_158], 0
		mov	[esp+168h+var_15C], 5
		lea	eax, [ebp+var_13D]
		mov	[esp+168h+var_160], eax
		mov	[esp+168h+SubStr], 310004h
		mov	eax, [ebp+arg_0]
		mov	[esp+168h+Str],	eax
		call	sub_408CE8
		mov	dword ptr [ebp+var_24],	eax
		cmp	dword ptr [ebp+var_24],	0
		jz	loc_409704
		mov	eax, 6A81h
		jmp	locret_40970A
; ---------------------------------------------------------------------------

loc_409653:				; CODE XREF: sub_409117+4C5j
					; sub_409117+4CBj
		cmp	[ebp+var_C], 4E6h
		jnz	short loc_409690
		cmp	[ebp+var_10], 0E003h
		jnz	short loc_409690
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	dword ptr [eax+0Ch], 1
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511D0
		mov	dword ptr [eax], 1
		jmp	short loc_409705
; ---------------------------------------------------------------------------

loc_409690:				; CODE XREF: sub_409117+543j
					; sub_409117+54Cj
		cmp	[ebp+var_C], 46Ah
		jnz	short loc_4096CA
		cmp	[ebp+var_10], 3Eh
		jnz	short loc_4096CA
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511A0
		mov	dword ptr [eax+14h], 0Fh
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511D0
		mov	dword ptr [eax], 1
		jmp	short loc_409705
; ---------------------------------------------------------------------------

loc_4096CA:				; CODE XREF: sub_409117+580j
					; sub_409117+586j
		cmp	[ebp+var_C], 0C4Bh
		jz	short loc_4096EE
		cmp	[ebp+var_C], 1A44h
		jz	short loc_4096EE
		cmp	[ebp+var_C], 234Bh
		jz	short loc_4096EE
		cmp	[ebp+var_C], 0D46h
		jnz	short loc_409705

loc_4096EE:				; CODE XREF: sub_409117+5BAj
					; sub_409117+5C3j ...
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511D0
		mov	dword ptr [eax], 1
		jmp	short loc_409705
; ---------------------------------------------------------------------------

loc_409704:				; CODE XREF: sub_409117+52Cj
		nop

loc_409705:				; CODE XREF: sub_409117+577j
					; sub_409117+5B1j ...
		mov	eax, 0

locret_40970A:				; CODE XREF: sub_409117+80j
					; sub_409117+2FEj ...
		leave
		retn
sub_409117	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40970C(char *)
sub_40970C	proc near		; CODE XREF: sub_409BD5+Cp

var_4C		= dword	ptr -4Ch
Str1		= dword	ptr -48h
Str2		= dword	ptr -44h
MaxCount	= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		call	sub_4079E2
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jnz	short loc_409739
		mov	eax, 0FFFFFFFFh
		jmp	loc_409BD0
; ---------------------------------------------------------------------------

loc_409739:				; CODE XREF: sub_40970C+21j
		mov	eax, ds:dword_451D74
		mov	edx, [ebp+var_1C]
		imul	edx, 0A8h
		add	edx, 30h
		add	edx, offset dword_451160
		add	edx, 0Ch
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+MaxCount], 0
		mov	[esp+48h+Str2],	0
		mov	[esp+48h+Str1],	2
		call	eax ; dword_451D74
		sub	esp, 10h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4097C7
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str1],	eax
		call	sub_408626
		mov	edx, [ebp+var_C]
		mov	[esp+48h+MaxCount], edx
		mov	[esp+48h+Str2],	eax ; char
		mov	[esp+48h+Str1],	offset aPcsc_establish ; "pcsc_establish_context failed: %s (0x%l"...
		call	sub_43CB21
		mov	eax, [ebp+var_1C]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Str1],	eax
		call	sub_407997
		mov	eax, 0FFFFFFFFh
		jmp	loc_409BD0
; ---------------------------------------------------------------------------

loc_4097C7:				; CODE XREF: sub_40970C+6Ej
		mov	ecx, ds:dword_451D78
		mov	eax, [ebp+var_1C]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	eax, [eax+0Ch]
		lea	edx, [ebp+var_20]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+MaxCount], 0
		mov	[esp+48h+Str2],	0 ; char
		mov	[esp+48h+Str1],	eax
		call	ecx ; dword_451D78
		sub	esp, 10h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_4098AD
		mov	eax, [ebp+var_20]
		add	eax, 1
		mov	[esp+48h+Str1],	eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_409875
		mov	[esp+48h+Str1],	offset aErrorAllocat_0 ; "error	allocating memory for reader list"...
		call	sub_43CB21
		mov	edx, ds:dword_451D68
		mov	eax, [ebp+var_1C]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	eax, [eax+0Ch]
		mov	[esp+48h+Str1],	eax
		call	edx ; dword_451D68
		sub	esp, 4
		mov	eax, [ebp+var_1C]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Str1],	eax
		call	sub_407997
		mov	eax, 0FFFFFFFFh
		jmp	loc_409BD0
; ---------------------------------------------------------------------------

loc_409875:				; CODE XREF: sub_40970C+113j
		mov	ecx, ds:dword_451D78
		mov	eax, [ebp+var_1C]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	eax, [eax+0Ch]
		lea	edx, [ebp+var_20]
		mov	[esp+48h+var_3C], edx
		mov	edx, [ebp+var_10]
		mov	[esp+48h+MaxCount], edx
		mov	[esp+48h+Str2],	0
		mov	[esp+48h+Str1],	eax
		call	ecx ; dword_451D78
		sub	esp, 10h
		mov	[ebp+var_C], eax

loc_4098AD:				; CODE XREF: sub_40970C+F8j
		cmp	[ebp+var_C], 0
		jz	short loc_409928
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str1],	eax
		call	sub_408626
		mov	edx, [ebp+var_C]
		mov	[esp+48h+MaxCount], edx
		mov	[esp+48h+Str2],	eax ; char
		mov	[esp+48h+Str1],	offset aPcsc_list_read ; "pcsc_list_readers failed: %s (0x%lx)\n"
		call	sub_43CB21
		mov	edx, ds:dword_451D68
		mov	eax, [ebp+var_1C]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	eax, [eax+0Ch]
		mov	[esp+48h+Str1],	eax
		call	edx ; dword_451D68
		sub	esp, 4
		mov	eax, [ebp+var_1C]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_10]
		mov	[esp+4Ch+var_4C], eax
		call	gcry_free
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Str1],	eax
		call	sub_407997
		mov	eax, 0FFFFFFFFh
		jmp	loc_409BD0
; ---------------------------------------------------------------------------

loc_409928:				; CODE XREF: sub_40970C+1A5j
		mov	eax, [ebp+var_10]
		mov	[ebp+var_18], eax
		jmp	loc_409A36
; ---------------------------------------------------------------------------

loc_409933:				; CODE XREF: sub_40970C+32Fj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40994E
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_409A43

loc_40994E:				; CODE XREF: sub_40970C+22Fj
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Str2],	eax ; char
		mov	[esp+48h+Str1],	offset aDetectedReader ; "detected reader `%s'\n"
		call	sub_43CAF7
		mov	eax, [ebp+var_18]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		lea	edx, [eax+1]
		mov	eax, [ebp+var_20]
		cmp	edx, eax
		jbe	short loc_40999B
		mov	[esp+48h+Str1],	offset aInvalidRespons ; "invalid response from	pcsc_list_readers"...
		call	sub_43CB21
		jmp	loc_409A44
; ---------------------------------------------------------------------------

loc_40999B:				; CODE XREF: sub_40970C+27Cj
		cmp	[ebp+var_14], 0
		jnz	short loc_4099E6
		cmp	[ebp+arg_0], 0
		jz	short loc_4099E6
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+48h+MaxCount], eax	; MaxCount
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str2],	eax ; char
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_4099E6
		mov	eax, [ebp+var_18]
		mov	[ebp+var_14], eax

loc_4099E6:				; CODE XREF: sub_40970C+293j
					; sub_40970C+299j ...
		mov	eax, [ebp+var_18]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	edx, eax
		not	edx
		mov	eax, [ebp+var_20]
		add	eax, edx
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp+var_18], eax

loc_409A36:				; CODE XREF: sub_40970C+222j
		mov	eax, [ebp+var_20]
		test	eax, eax
		jnz	loc_409933
		jmp	short loc_409A44
; ---------------------------------------------------------------------------

loc_409A43:				; CODE XREF: sub_40970C+23Cj
		nop

loc_409A44:				; CODE XREF: sub_40970C+28Aj
					; sub_40970C+335j
		cmp	[ebp+var_14], 0
		jnz	short loc_409A50
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax

loc_409A50:				; CODE XREF: sub_40970C+33Cj
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Str1],	eax
		call	gcry_strdup
		mov	edx, [ebp+var_1C]
		imul	edx, 0A8h
		add	edx, offset dword_4511B0
		mov	[edx+8], eax
		mov	eax, [ebp+var_1C]
		imul	eax, 0A8h
		add	eax, offset dword_4511B0
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_409AD6
		mov	[esp+48h+Str1],	offset aErrorAllocat_1 ; "error	allocating memory for reader name"...
		call	sub_43CB21
		mov	edx, ds:dword_451D68
		mov	eax, [ebp+var_1C]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	eax, [eax+0Ch]
		mov	[esp+48h+Str1],	eax
		call	edx ; dword_451D68
		sub	esp, 4
		mov	eax, [ebp+var_1C]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Str1],	eax
		call	sub_407997
		mov	eax, 0FFFFFFFFh
		jmp	loc_409BD0
; ---------------------------------------------------------------------------

loc_409AD6:				; CODE XREF: sub_40970C+374j
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str1],	eax
		call	gcry_free
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_1C]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+var_1C]
		imul	eax, 0A8h
		add	eax, offset dword_4511F0
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+var_1C]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_1C]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	dword ptr [eax+8], offset sub_408D9F
		mov	eax, [ebp+var_1C]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	dword ptr [eax+0Ch], offset sub_409015
		mov	eax, [ebp+var_1C]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	dword ptr [eax], offset	sub_408D8C
		mov	eax, [ebp+var_1C]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	dword ptr [eax+8], offset sub_409104
		mov	eax, [ebp+var_1C]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	dword ptr [eax+0Ch], offset sub_408AD6
		mov	eax, [ebp+var_1C]
		imul	eax, 0A8h
		add	eax, offset dword_451180
		mov	dword ptr [eax], offset	sub_408C10
		mov	eax, [ebp+var_1C]
		imul	eax, 0A8h
		add	eax, offset dword_451180
		mov	dword ptr [eax+8], offset sub_4088F6
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Str1],	eax
		call	sub_407CBA
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Str1],	eax
		call	sub_407997
		mov	eax, [ebp+var_1C]

loc_409BD0:				; CODE XREF: sub_40970C+28j
					; sub_40970C+B6j ...
		mov	edi, [ebp+var_4]
		leave
		retn
sub_40970C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409BD5(char *)
sub_409BD5	proc near		; CODE XREF: sub_40A3E0+505p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_40970C
		leave
		retn
sub_409BD5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409BE8	proc near		; DATA XREF: sub_4079E2+1AAo

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511A0
		mov	eax, [eax+10h]
		test	eax, eax
		js	short loc_409C1A
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511A0
		mov	edx, [eax+10h]
		mov	eax, [ebp+arg_8]
		mov	[eax+4], edx

loc_409C1A:				; CODE XREF: sub_409BE8+19j
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511A0
		mov	eax, [eax+14h]
		test	eax, eax
		js	short loc_409C46
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511A0
		mov	edx, [eax+14h]
		mov	eax, [ebp+arg_8]
		mov	[eax+8], edx

loc_409C46:				; CODE XREF: sub_409BE8+45j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_409C5A
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax+4], 1

loc_409C5A:				; CODE XREF: sub_409BE8+66j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_409C6E
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax+8], 0Fh

loc_409C6E:				; CODE XREF: sub_409BE8+7Aj
		cmp	dword ptr [ebp+arg_4], 20h
		jnz	short loc_409C89
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	eax, [eax+18h]
		test	eax, eax
		jnz	short loc_409CA4

loc_409C89:				; CODE XREF: sub_409BE8+8Aj
		cmp	dword ptr [ebp+arg_4], 24h
		jnz	short loc_409CAD
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511A0
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_409CAD

loc_409CA4:				; CODE XREF: sub_409BE8+9Fj
		mov	[ebp+var_C], 0
		jmp	short loc_409CB4
; ---------------------------------------------------------------------------

loc_409CAD:				; CODE XREF: sub_409BE8+A5j
					; sub_409BE8+BAj
		mov	[ebp+var_C], 6A81h

loc_409CB4:				; CODE XREF: sub_409BE8+C3j
		mov	eax, ds:dword_451D20
		and	eax, 800h
		test	eax, eax
		jz	short loc_409CDC
		mov	eax, dword ptr [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+var_20], edx
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aCheck_pcsc_pin ; "check_pcsc_pinpad: command=%02X, r=%d\n"
		call	sub_43CBBE

loc_409CDC:				; CODE XREF: sub_409BE8+D8j
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511D0
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_409CF9
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0

loc_409CF9:				; CODE XREF: sub_409BE8+106j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_409BE8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409CFE	proc near		; DATA XREF: sub_4079E2+1E9o

Dst		= dword	ptr -48h
Val		= dword	ptr -44h
Size		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_24		= dword	ptr -24h
var_1E		= byte ptr -1Eh
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		add	eax, 18h
		mov	[ebp+var_C], eax
		mov	[ebp+var_24], 6
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511F0
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_409D48
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Dst], eax
		call	sub_409104
		mov	dword ptr [ebp+var_10],	eax
		cmp	dword ptr [ebp+var_10],	0
		jz	short loc_409D48
		mov	eax, dword ptr [ebp+var_10]
		jmp	loc_40A044
; ---------------------------------------------------------------------------

loc_409D48:				; CODE XREF: sub_409CFE+2Cj
					; sub_409CFE+40j
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		test	eax, eax
		js	short loc_409D5B
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	eax, 0Fh
		jle	short loc_409D65

loc_409D5B:				; CODE XREF: sub_409CFE+51j
		mov	eax, 6A81h
		jmp	loc_40A044
; ---------------------------------------------------------------------------

loc_409D65:				; CODE XREF: sub_409CFE+5Bj
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_409D83
		mov	eax, 10001h
		jmp	loc_40A044
; ---------------------------------------------------------------------------

loc_409D83:				; CODE XREF: sub_409CFE+79j
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_409DA8
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_409DA8
		mov	eax, 1
		jmp	short loc_409DAD
; ---------------------------------------------------------------------------

loc_409DA8:				; CODE XREF: sub_409CFE+8Cj
					; sub_409CFE+A1j
		mov	eax, 0

loc_409DAD:				; CODE XREF: sub_409CFE+A8j
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]
		add	eax, 2
		mov	byte ptr [eax],	82h
		mov	eax, [ebp+var_14]
		lea	edx, [eax+3]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		mov	[edx], al
		mov	eax, [ebp+var_14]
		add	eax, 4
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]
		lea	edx, [eax+5]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax+8]
		mov	[edx], al
		mov	eax, [ebp+var_14]
		lea	edx, [eax+6]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax+4]
		mov	[edx], al
		mov	eax, [ebp+var_14]
		add	eax, 7
		mov	byte ptr [eax],	2
		mov	eax, [ebp+arg_14]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_409E3B
		mov	eax, [ebp+arg_14]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_409E3B
		mov	eax, [ebp+arg_14]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_409E3B
		mov	eax, [ebp+var_14]
		lea	edx, [eax+7]
		mov	eax, [ebp+var_14]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		or	eax, 1
		mov	[edx], al

loc_409E3B:				; CODE XREF: sub_409CFE+10Dj
					; sub_409CFE+117j ...
		mov	eax, [ebp+var_14]
		add	eax, 8
		mov	byte ptr [eax],	1
		mov	eax, [ebp+var_14]
		add	eax, 9
		mov	byte ptr [eax],	9
		mov	eax, [ebp+var_14]
		add	eax, 0Ah
		mov	byte ptr [eax],	4
		mov	eax, [ebp+var_14]
		add	eax, 0Bh
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]
		add	eax, 0Ch
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]
		add	eax, 0Dh
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]
		lea	edx, [eax+0Eh]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		mov	ecx, eax
		mov	eax, [ebp+var_18]
		mov	ebx, ecx
		sub	bl, al
		mov	eax, ebx
		add	eax, 5
		mov	[edx], al
		mov	eax, [ebp+var_14]
		lea	edx, [eax+0Fh]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		mov	ecx, eax
		mov	eax, [ebp+var_18]
		mov	ebx, ecx
		sub	bl, al
		mov	eax, ebx
		add	eax, 5
		mov	[edx], al
		mov	eax, [ebp+var_14]
		add	eax, 10h
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]
		add	eax, 11h
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]
		add	eax, 12h
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]
		lea	edx, [eax+13h]
		mov	eax, dword ptr [ebp+arg_4]
		mov	[edx], al
		mov	eax, [ebp+var_14]
		lea	edx, [eax+14h]
		mov	eax, [ebp+arg_8]
		mov	[edx], al
		mov	eax, [ebp+var_14]
		lea	edx, [eax+15h]
		mov	eax, [ebp+arg_C]
		mov	[edx], al
		mov	eax, [ebp+var_14]
		lea	edx, [eax+16h]
		mov	eax, [ebp+arg_10]
		mov	[edx], al
		mov	eax, [ebp+var_14]
		lea	edx, [eax+17h]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		mov	[edx], al
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_409F25
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		mov	edx, [ebp+var_14]
		add	edx, 18h
		mov	[esp+48h+Size],	eax ; Size
		mov	[esp+48h+Val], 0FFh ; Val
		mov	[esp+48h+Dst], edx ; Dst
		call	memset
		jmp	short loc_409F2F
; ---------------------------------------------------------------------------

loc_409F25:				; CODE XREF: sub_409CFE+204j
		cmp	[ebp+var_18], 0
		jz	short loc_409F2F
		sub	[ebp+var_C], 1

loc_409F2F:				; CODE XREF: sub_409CFE+225j
					; sub_409CFE+22Bj
		mov	eax, ds:dword_451D20
		and	eax, 800h
		test	eax, eax
		jz	short loc_409F76
		mov	eax, [ebp+arg_14]
		mov	eax, [eax+8]
		mov	[esp+48h+var_30], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+var_3C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Size],	eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+48h+Val], eax ; char
		mov	[esp+48h+Dst], offset aSendSecureC02x ;	"send secure: c=%02X i=%02X p1=%02X p2=%"...
		call	sub_43CBBE

loc_409F76:				; CODE XREF: sub_409CFE+23Dj
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	eax, [eax+18h]
		lea	ecx, [ebp+var_24]
		mov	[esp+48h+var_34], ecx
		lea	ecx, [ebp+var_1E]
		mov	[esp+48h+var_38], ecx
		mov	[esp+48h+var_3C], edx
		mov	edx, [ebp+var_14]
		mov	[esp+48h+Size],	edx
		mov	[esp+48h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Dst], eax
		call	sub_408CE8
		mov	dword ptr [ebp+var_10],	eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Dst], eax
		call	gcry_free
		cmp	dword ptr [ebp+var_10],	0
		jnz	short loc_409FCE
		mov	eax, [ebp+var_24]
		cmp	eax, 1
		ja	short loc_409FF3

loc_409FCE:				; CODE XREF: sub_409CFE+2C6j
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+48h+Val], eax ; char
		mov	[esp+48h+Dst], offset aControl_pcscFa ;	"control_pcsc failed: %d\n"
		call	sub_43CB21
		cmp	dword ptr [ebp+var_10],	0
		jz	short loc_409FEC
		mov	eax, dword ptr [ebp+var_10]
		jmp	short loc_409FF1
; ---------------------------------------------------------------------------

loc_409FEC:				; CODE XREF: sub_409CFE+2E7j
		mov	eax, 10003h

loc_409FF1:				; CODE XREF: sub_409CFE+2ECj
		jmp	short loc_40A044
; ---------------------------------------------------------------------------

loc_409FF3:				; CODE XREF: sub_409CFE+2CEj
		mov	eax, [ebp+var_24]
		sub	eax, 2
		movzx	eax, [ebp+eax+var_1E]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 8
		mov	eax, [ebp+var_24]
		sub	eax, 1
		movzx	eax, [ebp+eax+var_1E]
		movzx	eax, al
		or	eax, edx
		mov	dword ptr [ebp+var_10],	eax
		mov	eax, ds:dword_451D20
		and	eax, 800h
		test	eax, eax
		jz	short loc_40A041
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Size],	eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+48h+Val], eax ; char
		mov	[esp+48h+Dst], offset aResponseSw04xD ;	" response: sw=%04X  datalen=%d\n"
		call	sub_43CBBE

loc_40A041:				; CODE XREF: sub_409CFE+327j
		mov	eax, dword ptr [ebp+var_10]

loc_40A044:				; CODE XREF: sub_409CFE+45j
					; sub_409CFE+62j ...
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_409CFE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A04A	proc near		; DATA XREF: sub_4079E2+1FDo

Dst		= dword	ptr -48h
Val		= dword	ptr -44h
Size		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_24		= dword	ptr -24h
var_1E		= byte ptr -1Eh
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		add	eax, eax
		add	eax, 1Dh
		mov	[ebp+var_C], eax
		mov	[ebp+var_24], 6
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511F0
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_40A096
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Dst], eax
		call	sub_409104
		mov	dword ptr [ebp+var_10],	eax
		cmp	dword ptr [ebp+var_10],	0
		jz	short loc_40A096
		mov	eax, dword ptr [ebp+var_10]
		jmp	loc_40A3DA
; ---------------------------------------------------------------------------

loc_40A096:				; CODE XREF: sub_40A04A+2Ej
					; sub_40A04A+42j
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		test	eax, eax
		js	short loc_40A0A9
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	eax, 0Fh
		jle	short loc_40A0B3

loc_40A0A9:				; CODE XREF: sub_40A04A+53j
		mov	eax, 6A81h
		jmp	loc_40A3DA
; ---------------------------------------------------------------------------

loc_40A0B3:				; CODE XREF: sub_40A04A+5Dj
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40A0D1
		mov	eax, 10001h
		jmp	loc_40A3DA
; ---------------------------------------------------------------------------

loc_40A0D1:				; CODE XREF: sub_40A04A+7Bj
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40A0F6
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_40A0F6
		mov	eax, 1
		jmp	short loc_40A0FB
; ---------------------------------------------------------------------------

loc_40A0F6:				; CODE XREF: sub_40A04A+8Ej
					; sub_40A04A+A3j
		mov	eax, 0

loc_40A0FB:				; CODE XREF: sub_40A04A+AAj
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]
		add	eax, 2
		mov	byte ptr [eax],	82h
		mov	eax, [ebp+var_14]
		lea	edx, [eax+3]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		mov	[edx], al
		mov	eax, [ebp+var_14]
		add	eax, 4
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]
		add	eax, 5
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]
		lea	edx, [eax+6]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		mov	[edx], al
		mov	eax, [ebp+var_14]
		lea	edx, [eax+7]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax+8]
		mov	[edx], al
		mov	eax, [ebp+var_14]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax+4]
		mov	[edx], al
		mov	eax, [ebp+var_14]
		lea	edx, [eax+9]
		cmp	[ebp+arg_C], 0
		jnz	short loc_40A171
		mov	eax, 3
		jmp	short loc_40A176
; ---------------------------------------------------------------------------

loc_40A171:				; CODE XREF: sub_40A04A+11Ej
		mov	eax, 1

loc_40A176:				; CODE XREF: sub_40A04A+125j
		mov	[edx], al
		mov	eax, [ebp+var_14]
		add	eax, 0Ah
		mov	byte ptr [eax],	2
		mov	eax, [ebp+arg_14]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40A1B9
		mov	eax, [ebp+arg_14]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40A1B9
		mov	eax, [ebp+arg_14]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_40A1B9
		mov	eax, [ebp+var_14]
		lea	edx, [eax+0Ah]
		mov	eax, [ebp+var_14]
		add	eax, 0Ah
		movzx	eax, byte ptr [eax]
		or	eax, 1
		mov	[edx], al

loc_40A1B9:				; CODE XREF: sub_40A04A+13Fj
					; sub_40A04A+149j ...
		mov	eax, [ebp+var_14]
		add	eax, 0Bh
		mov	byte ptr [eax],	3
		mov	eax, [ebp+var_14]
		add	eax, 0Ch
		mov	byte ptr [eax],	9
		mov	eax, [ebp+var_14]
		add	eax, 0Dh
		mov	byte ptr [eax],	4
		mov	eax, [ebp+var_14]
		add	eax, 0Eh
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]
		add	eax, 0Fh
		mov	byte ptr [eax],	1
		mov	eax, [ebp+var_14]
		add	eax, 10h
		mov	byte ptr [eax],	2
		mov	eax, [ebp+var_14]
		add	eax, 11h
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]
		add	eax, 12h
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]
		lea	edx, [eax+13h]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		lea	ecx, [eax+eax]
		mov	eax, [ebp+var_18]
		mov	ebx, ecx
		sub	bl, al
		mov	eax, ebx
		add	eax, 5
		mov	[edx], al
		mov	eax, [ebp+var_14]
		lea	edx, [eax+14h]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		lea	ecx, [eax+eax]
		mov	eax, [ebp+var_18]
		mov	ebx, ecx
		sub	bl, al
		mov	eax, ebx
		add	eax, 5
		mov	[edx], al
		mov	eax, [ebp+var_14]
		add	eax, 15h
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]
		add	eax, 16h
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]
		add	eax, 17h
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]
		lea	edx, [eax+18h]
		mov	eax, dword ptr [ebp+arg_4]
		mov	[edx], al
		mov	eax, [ebp+var_14]
		lea	edx, [eax+19h]
		mov	eax, [ebp+arg_8]
		mov	[edx], al
		mov	eax, [ebp+var_14]
		lea	edx, [eax+1Ah]
		mov	eax, [ebp+arg_C]
		mov	[edx], al
		mov	eax, [ebp+var_14]
		lea	edx, [eax+1Bh]
		mov	eax, [ebp+arg_10]
		mov	[edx], al
		mov	eax, [ebp+var_14]
		lea	edx, [eax+1Ch]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		add	eax, eax
		mov	[edx], al
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40A2BB
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		add	eax, eax
		mov	edx, [ebp+var_14]
		add	edx, 1Dh
		mov	[esp+48h+Size],	eax ; Size
		mov	[esp+48h+Val], 0FFh ; Val
		mov	[esp+48h+Dst], edx ; Dst
		call	memset
		jmp	short loc_40A2C5
; ---------------------------------------------------------------------------

loc_40A2BB:				; CODE XREF: sub_40A04A+24Cj
		cmp	[ebp+var_18], 0
		jz	short loc_40A2C5
		sub	[ebp+var_C], 1

loc_40A2C5:				; CODE XREF: sub_40A04A+26Fj
					; sub_40A04A+275j
		mov	eax, ds:dword_451D20
		and	eax, 800h
		test	eax, eax
		jz	short loc_40A30C
		mov	eax, [ebp+arg_14]
		mov	eax, [eax+8]
		mov	[esp+48h+var_30], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+var_3C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Size],	eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+48h+Val], eax ; char
		mov	[esp+48h+Dst], offset aSendSecureC02x ;	"send secure: c=%02X i=%02X p1=%02X p2=%"...
		call	sub_43CBBE

loc_40A30C:				; CODE XREF: sub_40A04A+287j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511A0
		mov	eax, [eax+0Ch]
		lea	ecx, [ebp+var_24]
		mov	[esp+48h+var_34], ecx
		lea	ecx, [ebp+var_1E]
		mov	[esp+48h+var_38], ecx
		mov	[esp+48h+var_3C], edx
		mov	edx, [ebp+var_14]
		mov	[esp+48h+Size],	edx
		mov	[esp+48h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Dst], eax
		call	sub_408CE8
		mov	dword ptr [ebp+var_10],	eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Dst], eax
		call	gcry_free
		cmp	dword ptr [ebp+var_10],	0
		jnz	short loc_40A364
		mov	eax, [ebp+var_24]
		cmp	eax, 1
		ja	short loc_40A389

loc_40A364:				; CODE XREF: sub_40A04A+310j
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+48h+Val], eax ; char
		mov	[esp+48h+Dst], offset aControl_pcscFa ;	"control_pcsc failed: %d\n"
		call	sub_43CB21
		cmp	dword ptr [ebp+var_10],	0
		jz	short loc_40A382
		mov	eax, dword ptr [ebp+var_10]
		jmp	short loc_40A387
; ---------------------------------------------------------------------------

loc_40A382:				; CODE XREF: sub_40A04A+331j
		mov	eax, 10003h

loc_40A387:				; CODE XREF: sub_40A04A+336j
		jmp	short loc_40A3DA
; ---------------------------------------------------------------------------

loc_40A389:				; CODE XREF: sub_40A04A+318j
		mov	eax, [ebp+var_24]
		sub	eax, 2
		movzx	eax, [ebp+eax+var_1E]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 8
		mov	eax, [ebp+var_24]
		sub	eax, 1
		movzx	eax, [ebp+eax+var_1E]
		movzx	eax, al
		or	eax, edx
		mov	dword ptr [ebp+var_10],	eax
		mov	eax, ds:dword_451D20
		and	eax, 800h
		test	eax, eax
		jz	short loc_40A3D7
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Size],	eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+48h+Val], eax ; char
		mov	[esp+48h+Dst], offset aResponseSw04xD ;	" response: sw=%04X  datalen=%d\n"
		call	sub_43CBBE

loc_40A3D7:				; CODE XREF: sub_40A04A+371j
		mov	eax, dword ptr [ebp+var_10]

loc_40A3DA:				; CODE XREF: sub_40A04A+47j
					; sub_40A04A+64j ...
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_40A04A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40A3E0(char *)
sub_40A3E0	proc near		; CODE XREF: sub_403E56+3Cp

Str		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_48		= byte ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 7Ch
		mov	eax, ds:dword_451D38
		test	eax, eax
		jz	loc_40A509
		mov	eax, ds:dword_451D38
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_40A509
		cmp	[ebp+arg_0], 0
		jz	short loc_40A419
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str], eax ; Str
		call	atoi
		jmp	short loc_40A41E
; ---------------------------------------------------------------------------

loc_40A419:				; CODE XREF: sub_40A3E0+2Aj
		mov	eax, 8000h

loc_40A41E:				; CODE XREF: sub_40A3E0+37j
		mov	[ebp+var_1C], eax
		mov	eax, ds:dword_451410
		test	eax, eax
		jnz	loc_40A4F9
		mov	eax, ds:dword_451D38
		mov	[esp+88h+var_84], 0
		mov	[esp+88h+Str], eax ; LPCSTR
		call	sub_407784
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_40A46B
		call	sub_4077E7
		mov	[esp+88h+var_84], eax ;	char
		mov	[esp+88h+Str], offset aApdu_open_read ;	"apdu_open_reader: failed to open driver"...
		call	sub_43CB21
		mov	eax, 0FFFFFFFFh
		jmp	loc_40A8EA
; ---------------------------------------------------------------------------

loc_40A46B:				; CODE XREF: sub_40A3E0+6Aj
		mov	[esp+88h+var_84], offset aCt_init ; "CT_init"
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Str], eax ; HMODULE
		call	sub_4077A2
		mov	ds:dword_451400, eax
		mov	[esp+88h+var_84], offset aCt_data_0 ; "CT_data"
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Str], eax ; HMODULE
		call	sub_4077A2
		mov	ds:dword_451404, eax
		mov	[esp+88h+var_84], offset aCt_close ; "CT_close"
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Str], eax ; HMODULE
		call	sub_4077A2
		mov	ds:dword_451408, eax
		mov	eax, ds:dword_451400
		test	eax, eax
		jz	short loc_40A4CE
		mov	eax, ds:dword_451404
		test	eax, eax
		jz	short loc_40A4CE
		mov	eax, ds:dword_451408
		test	eax, eax
		jnz	short loc_40A4EF

loc_40A4CE:				; CODE XREF: sub_40A3E0+DAj
					; sub_40A3E0+E3j
		mov	[esp+88h+Str], offset aApdu_open_re_0 ;	"apdu_open_reader: invalid CT-API driver"...
		call	sub_43CB21
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Str], eax ; HANDLE
		call	sub_407814
		mov	eax, 0FFFFFFFFh
		jmp	loc_40A8EA
; ---------------------------------------------------------------------------

loc_40A4EF:				; CODE XREF: sub_40A3E0+ECj
		mov	ds:dword_451410, 1

loc_40A4F9:				; CODE XREF: sub_40A3E0+48j
		mov	eax, [ebp+var_1C]
		mov	[esp+88h+Str], eax
		call	sub_408463
		jmp	loc_40A8EA
; ---------------------------------------------------------------------------

loc_40A509:				; CODE XREF: sub_40A3E0+10j
					; sub_40A3E0+20j
		mov	eax, ds:dword_451414
		test	eax, eax
		jnz	loc_40A8DF
		mov	eax, ds:dword_451D3C
		mov	[esp+88h+var_84], 0
		mov	[esp+88h+Str], eax ; LPCSTR
		call	sub_407784
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_40A55D
		call	sub_4077E7
		mov	edx, ds:dword_451D3C
		mov	[esp+88h+var_80], eax
		mov	[esp+88h+var_84], edx ;	char
		mov	[esp+88h+Str], offset aApdu_open_re_1 ;	"apdu_open_reader: failed to open driver"...
		call	sub_43CB21
		mov	eax, 0FFFFFFFFh
		jmp	loc_40A8EA
; ---------------------------------------------------------------------------

loc_40A55D:				; CODE XREF: sub_40A3E0+152j
		mov	[esp+88h+var_84], offset aScardestablish ; "SCardEstablishContext"
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Str], eax ; HMODULE
		call	sub_4077A2
		mov	ds:dword_451D74, eax
		mov	[esp+88h+var_84], offset aScardreleaseco ; "SCardReleaseContext"
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Str], eax ; HMODULE
		call	sub_4077A2
		mov	ds:dword_451D68, eax
		mov	[esp+88h+var_84], offset aScardlistreade ; "SCardListReaders"
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Str], eax ; HMODULE
		call	sub_4077A2
		mov	ds:dword_451D78, eax
		mov	eax, ds:dword_451D78
		test	eax, eax
		jnz	short loc_40A5C6
		mov	[esp+88h+var_84], offset aScardlistrea_0 ; "SCardListReadersA"
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Str], eax ; HMODULE
		call	sub_4077A2
		mov	ds:dword_451D78, eax

loc_40A5C6:				; CODE XREF: sub_40A3E0+1CCj
		mov	[esp+88h+var_84], offset aScardgetstatus ; "SCardGetStatusChange"
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Str], eax ; HMODULE
		call	sub_4077A2
		mov	ds:dword_451D84, eax
		mov	eax, ds:dword_451D84
		test	eax, eax
		jnz	short loc_40A5FF
		mov	[esp+88h+var_84], offset aScardgetstat_0 ; "SCardGetStatusChangeA"
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Str], eax ; HMODULE
		call	sub_4077A2
		mov	ds:dword_451D84, eax

loc_40A5FF:				; CODE XREF: sub_40A3E0+205j
		mov	[esp+88h+var_84], offset aScardconnect ; "SCardConnect"
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Str], eax ; HMODULE
		call	sub_4077A2
		mov	ds:dword_451D80, eax
		mov	eax, ds:dword_451D80
		test	eax, eax
		jnz	short loc_40A638
		mov	[esp+88h+var_84], offset aScardconnecta	; "SCardConnectA"
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Str], eax ; HMODULE
		call	sub_4077A2
		mov	ds:dword_451D80, eax

loc_40A638:				; CODE XREF: sub_40A3E0+23Ej
		mov	[esp+88h+var_84], offset aScardreconnect ; "SCardReconnect"
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Str], eax ; HMODULE
		call	sub_4077A2
		mov	ds:dword_451D88, eax
		mov	eax, ds:dword_451D88
		test	eax, eax
		jnz	short loc_40A671
		mov	[esp+88h+var_84], offset aScardreconne_0 ; "SCardReconnectA"
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Str], eax ; HMODULE
		call	sub_4077A2
		mov	ds:dword_451D88, eax

loc_40A671:				; CODE XREF: sub_40A3E0+277j
		mov	[esp+88h+var_84], offset aScarddisconnec ; "SCardDisconnect"
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Str], eax ; HMODULE
		call	sub_4077A2
		mov	ds:dword_451D5C, eax
		mov	[esp+88h+var_84], offset aScardstatus ;	"SCardStatus"
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Str], eax ; HMODULE
		call	sub_4077A2
		mov	ds:dword_451D7C, eax
		mov	eax, ds:dword_451D7C
		test	eax, eax
		jnz	short loc_40A6C2
		mov	[esp+88h+var_84], offset aScardstatusa ; "SCardStatusA"
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Str], eax ; HMODULE
		call	sub_4077A2
		mov	ds:dword_451D7C, eax

loc_40A6C2:				; CODE XREF: sub_40A3E0+2C8j
		mov	[esp+88h+var_84], offset aScardbegintran ; "SCardBeginTransaction"
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Str], eax ; HMODULE
		call	sub_4077A2
		mov	ds:dword_451D70, eax
		mov	[esp+88h+var_84], offset aScardendtransa ; "SCardEndTransaction"
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Str], eax ; HMODULE
		call	sub_4077A2
		mov	ds:dword_451D60, eax
		mov	[esp+88h+var_84], offset aScardtransmit	; "SCardTransmit"
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Str], eax ; HMODULE
		call	sub_4077A2
		mov	ds:dword_451D64, eax
		mov	[esp+88h+var_84], offset aScardsettimeou ; "SCardSetTimeout"
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Str], eax ; HMODULE
		call	sub_4077A2
		mov	ds:dword_451D6C, eax
		mov	[esp+88h+var_84], offset aScardcontrol ; "SCardControl"
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Str], eax ; HMODULE
		call	sub_4077A2
		mov	ds:dword_451D8C, eax
		mov	eax, ds:dword_451D74
		test	eax, eax
		jz	short loc_40A7AA
		mov	eax, ds:dword_451D68
		test	eax, eax
		jz	short loc_40A7AA
		mov	eax, ds:dword_451D78
		test	eax, eax
		jz	short loc_40A7AA
		mov	eax, ds:dword_451D84
		test	eax, eax
		jz	short loc_40A7AA
		mov	eax, ds:dword_451D80
		test	eax, eax
		jz	short loc_40A7AA
		mov	eax, ds:dword_451D88
		test	eax, eax
		jz	short loc_40A7AA
		mov	eax, ds:dword_451D5C
		test	eax, eax
		jz	short loc_40A7AA
		mov	eax, ds:dword_451D7C
		test	eax, eax
		jz	short loc_40A7AA
		mov	eax, ds:dword_451D70
		test	eax, eax
		jz	short loc_40A7AA
		mov	eax, ds:dword_451D60
		test	eax, eax
		jz	short loc_40A7AA
		mov	eax, ds:dword_451D64
		test	eax, eax
		jz	short loc_40A7AA
		mov	eax, ds:dword_451D8C
		test	eax, eax
		jnz	loc_40A8D5

loc_40A7AA:				; CODE XREF: sub_40A3E0+361j
					; sub_40A3E0+36Aj ...
		mov	eax, ds:dword_451D8C
		test	eax, eax
		setnz	al
		movzx	eax, al
		mov	[ebp+var_2C], eax
		mov	eax, ds:dword_451D6C
		test	eax, eax
		setnz	al
		movzx	eax, al
		mov	[ebp+var_30], eax
		mov	eax, ds:dword_451D64
		test	eax, eax
		setnz	al
		movzx	eax, al
		mov	[ebp+var_34], eax
		mov	eax, ds:dword_451D60
		test	eax, eax
		setnz	al
		movzx	eax, al
		mov	[ebp+var_38], eax
		mov	eax, ds:dword_451D70
		test	eax, eax
		setnz	al
		movzx	eax, al
		mov	[ebp+var_3C], eax
		mov	eax, ds:dword_451D7C
		test	eax, eax
		setnz	al
		movzx	eax, al
		mov	[ebp+var_40], eax
		mov	eax, ds:dword_451D5C
		test	eax, eax
		setnz	al
		movzx	eax, al
		mov	[ebp+var_44], eax
		mov	eax, ds:dword_451D88
		test	eax, eax
		setnz	al
		movzx	edi, al
		mov	eax, ds:dword_451D80
		test	eax, eax
		setnz	al
		movzx	esi, al
		mov	eax, ds:dword_451D84
		test	eax, eax
		setnz	al
		movzx	ebx, al
		mov	eax, ds:dword_451D78
		test	eax, eax
		setnz	al
		movzx	ecx, al
		mov	eax, ds:dword_451D68
		test	eax, eax
		setnz	al
		movzx	edx, al
		mov	eax, ds:dword_451D74
		test	eax, eax
		setnz	al
		movzx	eax, al
		mov	dword ptr [ebp+var_48],	eax
		mov	eax, [ebp+var_2C]
		mov	[esp+88h+var_54], eax
		mov	eax, [ebp+var_30]
		mov	[esp+88h+var_58], eax
		mov	eax, [ebp+var_34]
		mov	[esp+88h+var_5C], eax
		mov	eax, [ebp+var_38]
		mov	[esp+88h+var_60], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+88h+var_64], eax
		mov	eax, [ebp+var_40]
		mov	[esp+88h+var_68], eax
		mov	eax, [ebp+var_44]
		mov	[esp+88h+var_6C], eax
		mov	[esp+88h+var_70], edi
		mov	[esp+88h+var_74], esi
		mov	[esp+88h+var_78], ebx
		mov	[esp+88h+var_7C], ecx
		mov	[esp+88h+var_80], edx
		mov	eax, dword ptr [ebp+var_48]
		mov	[esp+88h+var_84], eax ;	char
		mov	[esp+88h+Str], offset aApdu_open_re_2 ;	"apdu_open_reader: invalid PC/SC driver	"...
		call	sub_43CB21
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Str], eax ; HANDLE
		call	sub_407814
		mov	eax, 0FFFFFFFFh
		jmp	short loc_40A8EA
; ---------------------------------------------------------------------------

loc_40A8D5:				; CODE XREF: sub_40A3E0+3C4j
		mov	ds:dword_451414, 1

loc_40A8DF:				; CODE XREF: sub_40A3E0+130j
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Str], eax ; char *
		call	sub_409BD5

loc_40A8EA:				; CODE XREF: sub_40A3E0+86j
					; sub_40A3E0+10Aj ...
		add	esp, 7Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40A3E0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 2
		mov	eax, 0FFFFFFFFh
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A90C	proc near		; CODE XREF: sub_403BAA+129p
					; sub_40729B+8Ep

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		js	short loc_40A932
		cmp	[ebp+arg_0], 3
		jg	short loc_40A932
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40A939

loc_40A932:				; CODE XREF: sub_40A90C+Aj
					; sub_40A90C+10j
		mov	eax, 10004h
		jmp	short locret_40A993
; ---------------------------------------------------------------------------

loc_40A939:				; CODE XREF: sub_40A90C+24j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40ABCB
		mov	dword ptr [ebp+var_C], eax
		cmp	dword ptr [ebp+var_C], 0
		jz	short loc_40A960
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aApdu_close_rea ; "apdu_close_reader => 0x%x (apdu_disconn"...
		call	sub_43CBBE

loc_40A960:				; CODE XREF: sub_40A90C+3Fj
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40A98E
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx
		jmp	short locret_40A993
; ---------------------------------------------------------------------------

loc_40A98E:				; CODE XREF: sub_40A90C+66j
		mov	eax, 10005h

locret_40A993:				; CODE XREF: sub_40A90C+2Bj
					; sub_40A90C+80j
		leave
		retn
sub_40A90C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A995	proc near		; CODE XREF: sub_402B62+6p

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_45140C
		test	eax, eax
		jnz	locret_40AA2E
		mov	ds:dword_45140C, 1
		mov	[ebp+var_C], 0
		jmp	short loc_40AA1E
; ---------------------------------------------------------------------------

loc_40A9BB:				; CODE XREF: sub_40A995+8Dj
		mov	eax, [ebp+var_C]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40AA1A
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_40ABCB
		mov	eax, [ebp+var_C]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40AA06
		mov	eax, [ebp+var_C]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	edx

loc_40AA06:				; CODE XREF: sub_40A995+57j
		mov	eax, [ebp+var_C]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	dword ptr [eax], 0

loc_40AA1A:				; CODE XREF: sub_40A995+38j
		add	[ebp+var_C], 1

loc_40AA1E:				; CODE XREF: sub_40A995+24j
		cmp	[ebp+var_C], 3
		jle	short loc_40A9BB
		mov	ds:dword_45140C, 0

locret_40AA2E:				; CODE XREF: sub_40A995+Dj
		leave
		retn
sub_40A995	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		js	short loc_40AA56
		cmp	dword ptr [ebp+8], 3
		jg	short loc_40AA56
		mov	eax, [ebp+8]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40AA5D

loc_40AA56:				; CODE XREF: .text:0040AA3Aj
					; .text:0040AA40j
		mov	eax, 10004h
		jmp	short locret_40AAAB
; ---------------------------------------------------------------------------

loc_40AA5D:				; CODE XREF: .text:0040AA54j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40ABCB
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40AA76
		mov	eax, [ebp-0Ch]
		jmp	short locret_40AAAB
; ---------------------------------------------------------------------------

loc_40AA76:				; CODE XREF: .text:0040AA6Fj
		mov	eax, [ebp+8]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40AAA6
		mov	eax, [ebp+8]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	edx, [eax+4]
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	edx
		jmp	short locret_40AAAB
; ---------------------------------------------------------------------------

loc_40AAA6:				; CODE XREF: .text:0040AA89j
		mov	eax, 10005h

locret_40AAAB:				; CODE XREF: .text:0040AA5Bj
					; .text:0040AA74j ...
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		js	short loc_40AABC
		cmp	dword ptr [ebp+8], 3
		jle	short loc_40AAC3

loc_40AABC:				; CODE XREF: .text:0040AAB4j
		mov	eax, 10004h
		jmp	short loc_40AADD
; ---------------------------------------------------------------------------

loc_40AAC3:				; CODE XREF: .text:0040AABAj
		mov	eax, [ebp+8]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	edx, [eax]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx
		mov	eax, 0

loc_40AADD:				; CODE XREF: .text:0040AAC1j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40AADF	proc near		; CODE XREF: sub_403EBF+120p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_0], 0
		js	short loc_40AB05
		cmp	[ebp+arg_0], 3
		jg	short loc_40AB05
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40AB0F

loc_40AB05:				; CODE XREF: sub_40AADF+Aj
					; sub_40AADF+10j
		mov	eax, 10004h
		jmp	locret_40ABC9
; ---------------------------------------------------------------------------

loc_40AB0F:				; CODE XREF: sub_40AADF+24j
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40AB61
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_4078B4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40AB68
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_407997
		jmp	short loc_40AB68
; ---------------------------------------------------------------------------

loc_40AB61:				; CODE XREF: sub_40AADF+43j
		mov	[ebp+var_C], 0

loc_40AB68:				; CODE XREF: sub_40AADF+57j
					; sub_40AADF+80j
		mov	[esp+38h+var_28], 0
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_2C], eax
		mov	[esp+38h+var_30], 1
		mov	[esp+38h+var_34], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_40AFAD
		cmp	[ebp+var_C], 0
		jnz	short loc_40ABC6
		mov	eax, [ebp+var_10]
		and	eax, 2
		test	eax, eax
		jnz	short loc_40ABAB
		mov	[ebp+var_C], 10008h
		jmp	short loc_40ABC6
; ---------------------------------------------------------------------------

loc_40ABAB:				; CODE XREF: sub_40AADF+C1j
		mov	eax, [ebp+var_10]
		and	eax, 2
		test	eax, eax
		jz	short loc_40ABC6
		mov	eax, [ebp+var_10]
		and	eax, 4
		test	eax, eax
		jnz	short loc_40ABC6
		mov	[ebp+var_C], 10009h

loc_40ABC6:				; CODE XREF: sub_40AADF+B7j
					; sub_40AADF+CAj ...
		mov	eax, [ebp+var_C]

locret_40ABC9:				; CODE XREF: sub_40AADF+2Bj
		leave
		retn
sub_40AADF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40ABCB	proc near		; CODE XREF: sub_40729B+46Ep
					; sub_40A90C+33p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		js	short loc_40ABF1
		cmp	[ebp+arg_0], 3
		jg	short loc_40ABF1
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40ABF8

loc_40ABF1:				; CODE XREF: sub_40ABCB+Aj
					; sub_40ABCB+10j
		mov	eax, 10004h
		jmp	short locret_40AC54
; ---------------------------------------------------------------------------

loc_40ABF8:				; CODE XREF: sub_40ABCB+24j
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_40AC4A
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4078B4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40AC51
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_407997
		jmp	short loc_40AC51
; ---------------------------------------------------------------------------

loc_40AC4A:				; CODE XREF: sub_40ABCB+40j
		mov	[ebp+var_C], 0

loc_40AC51:				; CODE XREF: sub_40ABCB+54j
					; sub_40ABCB+7Dj
		mov	eax, [ebp+var_C]

locret_40AC54:				; CODE XREF: sub_40ABCB+2Bj
		leave
		retn
sub_40ABCB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40AC56	proc near		; CODE XREF: sub_40E160+148p
					; sub_40E2B4+54p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		js	short loc_40AC7C
		cmp	[ebp+arg_0], 3
		jg	short loc_40AC7C
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40AC83

loc_40AC7C:				; CODE XREF: sub_40AC56+Aj
					; sub_40AC56+10j
		mov	eax, 10004h
		jmp	short locret_40ACED
; ---------------------------------------------------------------------------

loc_40AC83:				; CODE XREF: sub_40AC56+24j
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451180
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_40ACE3
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4078B4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40ACEA
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451180
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_407997
		jmp	short loc_40ACEA
; ---------------------------------------------------------------------------

loc_40ACE3:				; CODE XREF: sub_40AC56+40j
		mov	[ebp+var_C], 0

loc_40ACEA:				; CODE XREF: sub_40AC56+54j
					; sub_40AC56+8Bj
		mov	eax, [ebp+var_C]

locret_40ACED:				; CODE XREF: sub_40AC56+2Bj
		leave
		retn
sub_40AC56	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40ACEF	proc near		; CODE XREF: sub_403BAA+10Ap

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		js	short loc_40AD15
		cmp	[ebp+arg_0], 3
		jg	short loc_40AD15
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40AD1F

loc_40AD15:				; CODE XREF: sub_40ACEF+Aj
					; sub_40ACEF+10j
		mov	eax, 10004h
		jmp	locret_40ADA5
; ---------------------------------------------------------------------------

loc_40AD1F:				; CODE XREF: sub_40ACEF+24j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4078B4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40AD38
		mov	eax, [ebp+var_C]
		jmp	short locret_40ADA5
; ---------------------------------------------------------------------------

loc_40AD38:				; CODE XREF: sub_40ACEF+42j
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40AD7D
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx
		mov	[ebp+var_C], eax

loc_40AD7D:				; CODE XREF: sub_40ACEF+70j
		cmp	[ebp+var_C], 0
		jnz	short loc_40AD97
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	dword ptr [eax], 7

loc_40AD97:				; CODE XREF: sub_40ACEF+92j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_407997
		mov	eax, [ebp+var_C]

locret_40ADA5:				; CODE XREF: sub_40ACEF+2Bj
					; sub_40ACEF+47j
		leave
		retn
sub_40ACEF	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		js	short loc_40ADCD
		cmp	dword ptr [ebp+8], 3
		jg	short loc_40ADCD
		mov	eax, [ebp+8]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40ADD7

loc_40ADCD:				; CODE XREF: .text:0040ADB1j
					; .text:0040ADB7j
		mov	eax, 10004h
		jmp	locret_40AEE1
; ---------------------------------------------------------------------------

loc_40ADD7:				; CODE XREF: .text:0040ADCBj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40791B
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40ADF3
		mov	eax, [ebp-0Ch]
		jmp	locret_40AEE1
; ---------------------------------------------------------------------------

loc_40ADF3:				; CODE XREF: .text:0040ADE9j
		mov	eax, [ebp+8]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_40AE2B
		mov	eax, [ebp+8]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	edx, [eax+0Ch]
		lea	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	edx
		mov	[ebp-0Ch], eax

loc_40AE2B:				; CODE XREF: .text:0040AE06j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	loc_40AED3
		mov	eax, [ebp-10h]
		and	eax, 2
		test	eax, eax
		jnz	short loc_40AE4B
		mov	dword ptr [ebp-0Ch], 10008h
		jmp	loc_40AED3
; ---------------------------------------------------------------------------

loc_40AE4B:				; CODE XREF: .text:0040AE3Dj
		mov	eax, [ebp-10h]
		and	eax, 2
		test	eax, eax
		jz	short loc_40AE5F
		mov	eax, [ebp-10h]
		and	eax, 4
		test	eax, eax
		jz	short loc_40AE74

loc_40AE5F:				; CODE XREF: .text:0040AE53j
		mov	eax, [ebp+8]
		imul	eax, 0A8h
		add	eax, offset dword_4511F0
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_40AED3

loc_40AE74:				; CODE XREF: .text:0040AE5Dj
		mov	eax, [ebp+8]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40AED3
		mov	eax, [ebp+8]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	dword ptr [eax], 0
		mov	eax, [ebp+8]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	edx, [eax+8]
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	edx
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40AED3
		mov	eax, [ebp+8]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	dword ptr [eax], 7

loc_40AED3:				; CODE XREF: .text:0040AE2Fj
					; .text:0040AE46j ...
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407997
		mov	eax, [ebp-0Ch]

locret_40AEE1:				; CODE XREF: .text:0040ADD2j
					; .text:0040ADEEj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40AEE3	proc near		; CODE XREF: sub_4068D3+13Ep
					; sub_4245B2+159p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		js	short loc_40AF09
		cmp	[ebp+arg_0], 3
		jg	short loc_40AF09
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40AF13

loc_40AF09:				; CODE XREF: sub_40AEE3+Aj
					; sub_40AEE3+10j
		mov	eax, 0
		jmp	locret_40AFAB
; ---------------------------------------------------------------------------

loc_40AF13:				; CODE XREF: sub_40AEE3+24j
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511F0
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_40AF2F
		mov	eax, 0
		jmp	short locret_40AFAB
; ---------------------------------------------------------------------------

loc_40AF2F:				; CODE XREF: sub_40AEE3+43j
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511F0
		mov	eax, [eax+8]
		mov	[esp+28h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40AF58
		mov	eax, 0
		jmp	short locret_40AFAB
; ---------------------------------------------------------------------------

loc_40AF58:				; CODE XREF: sub_40AEE3+6Cj
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511F0
		mov	ecx, [eax+8]
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, 70h
		add	eax, offset dword_451160
		add	eax, 4
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511F0
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+var_C]

locret_40AFAB:				; CODE XREF: sub_40AEE3+2Bj
					; sub_40AEE3+4Aj ...
		leave
		retn
sub_40AEE3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40AFAD	proc near		; CODE XREF: sub_40AADF+AEp
					; sub_40B139+29p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		js	short loc_40AFD3
		cmp	[ebp+arg_0], 3
		jg	short loc_40AFD3
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40AFDD

loc_40AFD3:				; CODE XREF: sub_40AFAD+Aj
					; sub_40AFAD+10j
		mov	eax, 10004h
		jmp	locret_40B137
; ---------------------------------------------------------------------------

loc_40AFDD:				; CODE XREF: sub_40AFAD+24j
		cmp	[ebp+arg_4], 0
		jz	short loc_40AFF0
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4078B4
		jmp	short loc_40AFFB
; ---------------------------------------------------------------------------

loc_40AFF0:				; CODE XREF: sub_40AFAD+34j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40791B

loc_40AFFB:				; CODE XREF: sub_40AFAD+41j
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40B00C
		mov	eax, [ebp+var_C]
		jmp	locret_40B137
; ---------------------------------------------------------------------------

loc_40B00C:				; CODE XREF: sub_40AFAD+55j
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_40B044
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451170
		mov	edx, [eax+0Ch]
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx
		mov	[ebp+var_C], eax

loc_40B044:				; CODE XREF: sub_40AFAD+72j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_407997
		cmp	[ebp+var_C], 0
		jz	short loc_40B071
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_C]
		jmp	locret_40B137
; ---------------------------------------------------------------------------

loc_40B071:				; CODE XREF: sub_40AFAD+A6j
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		cmp	edx, eax
		jnz	short loc_40B09F
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511B0
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_40B0DF

loc_40B09F:				; CODE XREF: sub_40AFAD+DBj
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511F0
		mov	eax, [eax+0Ch]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511F0
		mov	[eax+0Ch], edx
		cmp	[ebp+arg_8], 0
		jnz	short loc_40B0DF
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511F0
		mov	dword ptr [eax+8], 0

loc_40B0DF:				; CODE XREF: sub_40AFAD+F0j
					; sub_40AFAD+11Bj
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511B0
		mov	dword ptr [eax+0Ch], 1
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_0]
		imul	edx, 0A8h
		add	edx, offset dword_4511C0
		mov	[edx], eax
		cmp	[ebp+arg_C], 0
		jz	short loc_40B116
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_40B116:				; CODE XREF: sub_40AFAD+15Fj
		cmp	[ebp+arg_10], 0
		jz	short loc_40B132
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511F0
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx

loc_40B132:				; CODE XREF: sub_40AFAD+16Dj
		mov	eax, 0

locret_40B137:				; CODE XREF: sub_40AFAD+2Bj
					; sub_40AFAD+5Aj ...
		leave
		retn
sub_40AFAD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B139	proc near		; CODE XREF: sub_40729B+66p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_18], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40AFAD
		leave
		retn
sub_40B139	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B169	proc near		; CODE XREF: sub_40D0D7+1Ap

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		js	short loc_40B18F
		cmp	[ebp+arg_0], 3
		jg	short loc_40B18F
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40B196

loc_40B18F:				; CODE XREF: sub_40B169+Aj
					; sub_40B169+10j
		mov	eax, 10004h
		jmp	short locret_40B215
; ---------------------------------------------------------------------------

loc_40B196:				; CODE XREF: sub_40B169+24j
		mov	eax, ds:dword_451D4C
		test	eax, eax
		jz	short loc_40B1A8
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0

loc_40B1A8:				; CODE XREF: sub_40B169+34j
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451180
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40B210
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4078B4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40B1D6
		mov	eax, [ebp+var_C]
		jmp	short locret_40B215
; ---------------------------------------------------------------------------

loc_40B1D6:				; CODE XREF: sub_40B169+66j
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451180
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_407997
		mov	eax, [ebp+var_C]
		jmp	short locret_40B215
; ---------------------------------------------------------------------------

loc_40B210:				; CODE XREF: sub_40B169+52j
		mov	eax, 10005h

locret_40B215:				; CODE XREF: sub_40B169+2Bj
					; sub_40B169+6Bj ...
		leave
		retn
sub_40B169	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B217	proc near		; CODE XREF: sub_40D106+32p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_0], 0
		js	short loc_40B23D
		cmp	[ebp+arg_0], 3
		jg	short loc_40B23D
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40B247

loc_40B23D:				; CODE XREF: sub_40B217+Aj
					; sub_40B217+10j
		mov	eax, 10004h
		jmp	locret_40B2C7
; ---------------------------------------------------------------------------

loc_40B247:				; CODE XREF: sub_40B217+24j
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40B2C2
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_4078B4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40B274
		mov	eax, [ebp+var_C]
		jmp	short locret_40B2C7
; ---------------------------------------------------------------------------

loc_40B274:				; CODE XREF: sub_40B217+56j
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	edx, [eax]
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+var_24], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_407997
		mov	eax, [ebp+var_C]
		jmp	short locret_40B2C7
; ---------------------------------------------------------------------------

loc_40B2C2:				; CODE XREF: sub_40B217+42j
		mov	eax, 10005h

locret_40B2C7:				; CODE XREF: sub_40B217+2Bj
					; sub_40B217+5Bj ...
		leave
		retn
sub_40B217	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B2C9	proc near		; CODE XREF: sub_40D1A3+38p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_0], 0
		js	short loc_40B2EF
		cmp	[ebp+arg_0], 3
		jg	short loc_40B2EF
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40B2F9

loc_40B2EF:				; CODE XREF: sub_40B2C9+Aj
					; sub_40B2C9+10j
		mov	eax, 10004h
		jmp	locret_40B37B
; ---------------------------------------------------------------------------

loc_40B2F9:				; CODE XREF: sub_40B2C9+24j
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40B376
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_4078B4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40B327
		mov	eax, [ebp+var_C]
		jmp	short locret_40B37B
; ---------------------------------------------------------------------------

loc_40B327:				; CODE XREF: sub_40B2C9+57j
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451190
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+var_24], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_407997
		mov	eax, [ebp+var_C]
		jmp	short locret_40B37B
; ---------------------------------------------------------------------------

loc_40B376:				; CODE XREF: sub_40B2C9+43j
		mov	eax, 10005h

locret_40B37B:				; CODE XREF: sub_40B2C9+2Bj
					; sub_40B2C9+5Cj ...
		leave
		retn
sub_40B2C9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B37D	proc near		; CODE XREF: sub_40B402+577p
					; sub_40B402+959p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		js	short loc_40B3A3
		cmp	[ebp+arg_0], 3
		jg	short loc_40B3A3
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40B3AA

loc_40B3A3:				; CODE XREF: sub_40B37D+Aj
					; sub_40B37D+10j
		mov	eax, 10004h
		jmp	short locret_40B400
; ---------------------------------------------------------------------------

loc_40B3AA:				; CODE XREF: sub_40B37D+24j
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451180
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40B3FB
		mov	eax, [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451180
		mov	edx, [eax]
		mov	eax, [ebp+arg_14]
		mov	[esp+28h+var_14], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+28h+var_18], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx
		jmp	short locret_40B400
; ---------------------------------------------------------------------------

loc_40B3FB:				; CODE XREF: sub_40B37D+3Fj
		mov	eax, 10005h

locret_40B400:				; CODE XREF: sub_40B37D+2Bj
					; sub_40B37D+7Cj
		leave
		retn
sub_40B37D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40B402(char, char, int, int, int, size_t, void *, int, int, int, int,	int)
sub_40B402	proc near		; CODE XREF: sub_40C01C+5Ap
					; sub_40C07D+5Bp ...

Dst		= dword	ptr -288h
Src		= dword	ptr -284h
Size		= dword	ptr -280h
var_27C		= dword	ptr -27Ch
var_278		= dword	ptr -278h
var_274		= dword	ptr -274h
var_270		= dword	ptr -270h
var_26C		= dword	ptr -26Ch
var_262		= byte ptr -262h
var_15C		= dword	ptr -15Ch
var_158		= byte ptr -158h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch
arg_28		= dword	ptr  30h
arg_2C		= dword	ptr  34h

		push	ebp
		mov	ebp, esp
		sub	esp, 288h
		mov	[ebp+var_C], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_2C], 0
		mov	[ebp+var_30], 0
		mov	[ebp+var_34], 0
		cmp	dword ptr [ebp+arg_0], 0
		js	short loc_40B44E
		cmp	dword ptr [ebp+arg_0], 3
		jg	short loc_40B44E
		mov	eax, dword ptr [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40B458

loc_40B44E:				; CODE XREF: sub_40B402+30j
					; sub_40B402+36j
		mov	eax, 10004h
		jmp	locret_40C01A
; ---------------------------------------------------------------------------

loc_40B458:				; CODE XREF: sub_40B402+4Aj
		mov	eax, ds:dword_451D20
		and	eax, 800h
		test	eax, eax
		jz	short loc_40B4A3
		mov	eax, [ebp+arg_2C]
		mov	[esp+288h+var_26C], eax
		mov	eax, [ebp+arg_1C]
		mov	[esp+288h+var_270], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+288h+var_274], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+288h+var_278], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+288h+var_27C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+288h+Size], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+288h+Src],	eax ; char
		mov	[esp+288h+Dst],	offset aSendApduC02xI0 ; "send apdu: c=%02X i=%02X p1=%02X p2=%02"...
		call	sub_43CBBE

loc_40B4A3:				; CODE XREF: sub_40B402+62j
		cmp	[ebp+arg_14], 0FFFFFFFFh
		jz	loc_40B532
		cmp	[ebp+arg_14], 0FFh
		jg	short loc_40B4BC
		cmp	[ebp+arg_14], 0
		jns	short loc_40B532

loc_40B4BC:				; CODE XREF: sub_40B402+B2j
		cmp	[ebp+arg_2C], 0
		jnz	short loc_40B4CC
		mov	eax, 6700h
		jmp	locret_40C01A
; ---------------------------------------------------------------------------

loc_40B4CC:				; CODE XREF: sub_40B402+BEj
		cmp	[ebp+arg_2C], 0
		jle	short loc_40B4DB
		mov	[ebp+var_34], 1
		jmp	short loc_40B545
; ---------------------------------------------------------------------------

loc_40B4DB:				; CODE XREF: sub_40B402+CEj
		cmp	[ebp+arg_2C], 0
		jns	short loc_40B528
		cmp	[ebp+arg_14], 4000h
		jle	short loc_40B4F4
		mov	eax, 6700h
		jmp	locret_40C01A
; ---------------------------------------------------------------------------

loc_40B4F4:				; CODE XREF: sub_40B402+E6j
		mov	eax, dword ptr [ebp+arg_4]
		and	eax, 0F0h
		test	eax, eax
		jz	short loc_40B50A
		mov	eax, 10002h
		jmp	locret_40C01A
; ---------------------------------------------------------------------------

loc_40B50A:				; CODE XREF: sub_40B402+FCj
		cmp	[ebp+arg_2C], 0FFFFFFFFh
		jz	short loc_40B517
		mov	eax, [ebp+arg_2C]
		neg	eax
		jmp	short loc_40B51C
; ---------------------------------------------------------------------------

loc_40B517:				; CODE XREF: sub_40B402+10Cj
		mov	eax, 0FFh

loc_40B51C:				; CODE XREF: sub_40B402+113j
		mov	[ebp+var_30], eax
		and	[ebp+var_30], 0FFh
		jmp	short loc_40B545
; ---------------------------------------------------------------------------

loc_40B528:				; CODE XREF: sub_40B402+DDj
		mov	eax, 10002h
		jmp	locret_40C01A
; ---------------------------------------------------------------------------

loc_40B532:				; CODE XREF: sub_40B402+A5j
					; sub_40B402+B8j
		cmp	[ebp+arg_14], 0FFFFFFFFh
		jnz	short loc_40B545
		cmp	[ebp+arg_2C], 0
		jle	short loc_40B545
		mov	[ebp+var_34], 1

loc_40B545:				; CODE XREF: sub_40B402+D7j
					; sub_40B402+124j ...
		cmp	[ebp+arg_1C], 0FFFFFFFFh
		jz	short loc_40B597
		cmp	[ebp+arg_2C], 0
		jle	short loc_40B558
		mov	eax, 0FFh
		jmp	short loc_40B55D
; ---------------------------------------------------------------------------

loc_40B558:				; CODE XREF: sub_40B402+14Dj
		mov	eax, 100h

loc_40B55D:				; CODE XREF: sub_40B402+154j
		cmp	eax, [ebp+arg_1C]
		jl	short loc_40B568
		cmp	[ebp+arg_1C], 0
		jns	short loc_40B597

loc_40B568:				; CODE XREF: sub_40B402+15Ej
		cmp	[ebp+arg_2C], 0
		jnz	short loc_40B578
		mov	eax, 6700h
		jmp	locret_40C01A
; ---------------------------------------------------------------------------

loc_40B578:				; CODE XREF: sub_40B402+16Aj
		cmp	[ebp+var_34], 0
		jnz	short loc_40B597
		cmp	[ebp+arg_2C], 0
		jle	short loc_40B58D
		mov	[ebp+var_34], 1
		jmp	short loc_40B597
; ---------------------------------------------------------------------------

loc_40B58D:				; CODE XREF: sub_40B402+180j
		mov	eax, 10002h
		jmp	locret_40C01A
; ---------------------------------------------------------------------------

loc_40B597:				; CODE XREF: sub_40B402+147j
					; sub_40B402+164j ...
		cmp	[ebp+arg_18], 0
		jnz	short loc_40B5A3
		cmp	[ebp+arg_14], 0FFFFFFFFh
		jnz	short loc_40B5AF

loc_40B5A3:				; CODE XREF: sub_40B402+199j
		cmp	[ebp+arg_18], 0
		jz	short loc_40B5B9
		cmp	[ebp+arg_14], 0FFFFFFFFh
		jnz	short loc_40B5B9

loc_40B5AF:				; CODE XREF: sub_40B402+19Fj
		mov	eax, 10002h
		jmp	locret_40C01A
; ---------------------------------------------------------------------------

loc_40B5B9:				; CODE XREF: sub_40B402+1A5j
					; sub_40B402+1ABj
		cmp	[ebp+var_34], 0
		jz	short loc_40B61D
		mov	eax, dword ptr [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40B5DE
		mov	eax, 10005h
		jmp	locret_40C01A
; ---------------------------------------------------------------------------

loc_40B5DE:				; CODE XREF: sub_40B402+1D0j
		cmp	[ebp+arg_14], 0
		js	short loc_40B5EC
		mov	eax, [ebp+arg_14]
		add	eax, 9
		jmp	short loc_40B5F1
; ---------------------------------------------------------------------------

loc_40B5EC:				; CODE XREF: sub_40B402+1E0j
		mov	eax, 7

loc_40B5F1:				; CODE XREF: sub_40B402+1E8j
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		add	eax, 0Ah
		mov	[esp+288h+Dst],	eax
		call	gcry_malloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_40B615
		mov	eax, 10001h
		jmp	locret_40C01A
; ---------------------------------------------------------------------------

loc_40B615:				; CODE XREF: sub_40B402+207j
		mov	eax, [ebp+var_18]
		mov	[ebp+var_20], eax
		jmp	short loc_40B62D
; ---------------------------------------------------------------------------

loc_40B61D:				; CODE XREF: sub_40B402+1BBj
		mov	[ebp+var_1C], 106h
		lea	eax, [ebp+var_262]
		mov	[ebp+var_20], eax

loc_40B62D:				; CODE XREF: sub_40B402+219j
		cmp	[ebp+var_34], 0
		jz	short loc_40B689
		cmp	[ebp+arg_1C], 100h
		jg	short loc_40B642
		cmp	[ebp+arg_1C], 0
		jns	short loc_40B689

loc_40B642:				; CODE XREF: sub_40B402+238j
		cmp	[ebp+arg_1C], 0
		js	short loc_40B64D
		mov	eax, [ebp+arg_1C]
		jmp	short loc_40B652
; ---------------------------------------------------------------------------

loc_40B64D:				; CODE XREF: sub_40B402+244j
		mov	eax, 1000h

loc_40B652:				; CODE XREF: sub_40B402+249j
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		add	eax, 0Ah
		mov	[esp+288h+Dst],	eax
		call	gcry_malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40B681
		mov	eax, [ebp+var_18]
		mov	[esp+288h+Dst],	eax
		call	gcry_free
		mov	eax, 10001h
		jmp	locret_40C01A
; ---------------------------------------------------------------------------

loc_40B681:				; CODE XREF: sub_40B402+268j
		mov	eax, [ebp+var_C]
		mov	[ebp+var_14], eax
		jmp	short loc_40B699
; ---------------------------------------------------------------------------

loc_40B689:				; CODE XREF: sub_40B402+22Fj
					; sub_40B402+23Ej
		mov	[ebp+var_10], 102h
		lea	eax, [ebp+var_158]
		mov	[ebp+var_14], eax

loc_40B699:				; CODE XREF: sub_40B402+285j
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Dst],	eax
		call	sub_4078B4
		mov	dword ptr [ebp+var_28],	eax
		cmp	dword ptr [ebp+var_28],	0
		jz	short loc_40B6CB
		mov	eax, [ebp+var_18]
		mov	[esp+288h+Dst],	eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	[esp+288h+Dst],	eax
		call	gcry_free
		mov	eax, dword ptr [ebp+var_28]
		jmp	locret_40C01A
; ---------------------------------------------------------------------------

loc_40B6CB:				; CODE XREF: sub_40B402+2A9j
					; sub_40B402+655j
		cmp	[ebp+var_34], 0
		jz	loc_40B7D2
		mov	[ebp+var_30], 0
		mov	[ebp+var_24], 0
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]
		add	edx, eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	[edx], al
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]
		add	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[edx], al
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]
		add	edx, eax
		mov	eax, [ebp+arg_C]
		mov	[edx], al
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]
		add	edx, eax
		mov	eax, [ebp+arg_10]
		mov	[edx], al
		add	[ebp+var_24], 1
		cmp	[ebp+arg_14], 0
		jle	short loc_40B789
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]
		add	eax, edx
		mov	byte ptr [eax],	0
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]
		add	edx, eax
		mov	eax, [ebp+arg_14]
		sar	eax, 8
		mov	[edx], al
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]
		add	edx, eax
		mov	eax, [ebp+arg_14]
		mov	[edx], al
		add	[ebp+var_24], 1
		mov	ecx, [ebp+arg_14]
		mov	edx, [ebp+arg_18]
		mov	eax, [ebp+var_20]
		add	eax, [ebp+var_24]
		mov	[esp+288h+Size], ecx ; Size
		mov	[esp+288h+Src],	edx ; Src
		mov	[esp+288h+Dst],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_14]
		add	[ebp+arg_18], eax
		mov	eax, [ebp+arg_14]
		add	[ebp+var_24], eax

loc_40B789:				; CODE XREF: sub_40B402+329j
		cmp	[ebp+arg_1C], 0FFFFFFFFh
		jz	loc_40B8FC
		cmp	[ebp+arg_14], 0
		jg	short loc_40B7A8
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]
		add	eax, edx
		mov	byte ptr [eax],	0
		add	[ebp+var_24], 1

loc_40B7A8:				; CODE XREF: sub_40B402+395j
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]
		add	edx, eax
		mov	eax, [ebp+arg_1C]
		sar	eax, 8
		mov	[edx], al
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]
		add	edx, eax
		mov	eax, [ebp+arg_1C]
		mov	[edx], al
		add	[ebp+var_24], 1
		jmp	loc_40B8FC
; ---------------------------------------------------------------------------

loc_40B7D2:				; CODE XREF: sub_40B402+2CDj
		mov	[ebp+var_24], 0
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]
		add	edx, eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	[edx], al
		cmp	[ebp+var_30], 0
		jz	short loc_40B840
		cmp	[ebp+arg_14], 0FFh
		jle	short loc_40B840
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]
		add	edx, eax
		mov	eax, [ebp+var_24]
		mov	ecx, [ebp+var_20]
		add	eax, ecx
		movzx	eax, byte ptr [eax]
		or	eax, 10h
		mov	[edx], al
		cmp	[ebp+var_30], 0FFh
		jle	short loc_40B832
		mov	[esp+288h+Size], 0E95h ; int
		mov	[esp+288h+Src],	offset a____Gnupg22__1 ; "../../gnupg2-2.0.30/scd/apdu.c"
		mov	[esp+288h+Dst],	offset aUse_chaining25 ; "use_chaining < 256"
		call	sub_442650

loc_40B832:				; CODE XREF: sub_40B402+412j
		mov	eax, [ebp+var_30]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_30]
		sub	[ebp+arg_14], eax
		jmp	short loc_40B84D
; ---------------------------------------------------------------------------

loc_40B840:				; CODE XREF: sub_40B402+3E8j
					; sub_40B402+3F1j
		mov	[ebp+var_30], 0
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_38], eax

loc_40B84D:				; CODE XREF: sub_40B402+43Cj
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]
		add	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[edx], al
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]
		add	edx, eax
		mov	eax, [ebp+arg_C]
		mov	[edx], al
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]
		add	edx, eax
		mov	eax, [ebp+arg_10]
		mov	[edx], al
		add	[ebp+var_24], 1
		cmp	[ebp+var_38], 0FFFFFFFFh
		jz	short loc_40B8DF
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]
		add	edx, eax
		mov	eax, [ebp+var_38]
		mov	[edx], al
		add	[ebp+var_24], 1
		mov	ecx, [ebp+var_38]
		mov	edx, [ebp+arg_18]
		mov	eax, [ebp+var_20]
		add	eax, [ebp+var_24]
		mov	[esp+288h+Size], ecx ; Size
		mov	[esp+288h+Src],	edx ; Src
		mov	[esp+288h+Dst],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_38]
		add	[ebp+arg_18], eax
		mov	eax, [ebp+var_38]
		add	[ebp+var_24], eax
		mov	eax, dword ptr [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_4511C0
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40B8DF
		mov	[ebp+arg_1C], 0FFFFFFFFh

loc_40B8DF:				; CODE XREF: sub_40B402+486j
					; sub_40B402+4D4j
		cmp	[ebp+arg_1C], 0FFFFFFFFh
		jz	short loc_40B8FC
		cmp	[ebp+var_30], 0
		jnz	short loc_40B8FC
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]
		add	edx, eax
		mov	eax, [ebp+arg_1C]
		mov	[edx], al
		add	[ebp+var_24], 1

loc_40B8FC:				; CODE XREF: sub_40B402+38Bj
					; sub_40B402+3CBj ...
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_1C]
		jbe	short loc_40B920
		mov	[esp+288h+Size], 0EB3h ; int
		mov	[esp+288h+Src],	offset a____Gnupg22__1 ; "../../gnupg2-2.0.30/scd/apdu.c"
		mov	[esp+288h+Dst],	offset aApdulenApdu_bu ; "apdulen <= apdu_buffer_size"
		call	sub_442650

loc_40B920:				; CODE XREF: sub_40B402+500j
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_1C]
		sub	edx, eax
		mov	eax, [ebp+var_24]
		mov	ecx, [ebp+var_20]
		add	eax, ecx
		mov	[esp+288h+Size], edx ; Size
		mov	[esp+288h+Src],	0 ; Val
		mov	[esp+288h+Dst],	eax ; Dst
		call	memset
		mov	eax, [ebp+var_10]
		mov	[ebp+var_15C], eax
		mov	eax, [ebp+arg_28]
		mov	[esp+288h+var_274], eax
		lea	eax, [ebp+var_15C]
		mov	[esp+288h+var_278], eax
		mov	eax, [ebp+var_14]
		mov	[esp+288h+var_27C], eax
		mov	eax, [ebp+var_24]
		mov	[esp+288h+Size], eax
		mov	eax, [ebp+var_20]
		mov	[esp+288h+Src],	eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Dst],	eax
		call	sub_40B37D
		mov	[ebp+var_44], eax
		cmp	[ebp+var_44], 0
		jnz	short loc_40B992
		mov	eax, [ebp+var_15C]
		cmp	eax, 1
		ja	short loc_40B9EA

loc_40B992:				; CODE XREF: sub_40B402+583j
		mov	eax, [ebp+var_44]
		mov	[esp+288h+Dst],	eax
		call	sub_407E6A
		mov	[esp+288h+Size], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Src],	eax ; char
		mov	[esp+288h+Dst],	offset aApdu_send_simp ; "apdu_send_simple(%d) failed: %s\n"
		call	sub_43CAF7
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Dst],	eax
		call	sub_407997
		mov	eax, [ebp+var_18]
		mov	[esp+288h+Dst],	eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	[esp+288h+Dst],	eax
		call	gcry_free
		cmp	[ebp+var_44], 0
		jz	short loc_40B9E0
		mov	eax, [ebp+var_44]
		jmp	short loc_40B9E5
; ---------------------------------------------------------------------------

loc_40B9E0:				; CODE XREF: sub_40B402+5D7j
		mov	eax, 10003h

loc_40B9E5:				; CODE XREF: sub_40B402+5DCj
		jmp	locret_40C01A
; ---------------------------------------------------------------------------

loc_40B9EA:				; CODE XREF: sub_40B402+58Ej
		mov	eax, [ebp+var_15C]
		sub	eax, 2
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 8
		mov	eax, [ebp+var_15C]
		sub	eax, 1
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, edx
		mov	dword ptr [ebp+var_28],	eax
		cmp	[ebp+var_34], 0
		jnz	short loc_40BA4A
		cmp	[ebp+var_2C], 0
		jnz	short loc_40BA4A
		mov	eax, dword ptr [ebp+var_28]
		mov	al, 0
		cmp	eax, 6C00h
		jnz	short loc_40BA4A
		mov	eax, [ebp+var_24]
		sub	eax, 1
		add	eax, [ebp+var_20]
		mov	edx, dword ptr [ebp+var_28]
		mov	[eax], dl
		mov	[ebp+var_2C], 1
		jmp	loc_40B8FC
; ---------------------------------------------------------------------------

loc_40BA4A:				; CODE XREF: sub_40B402+61Aj
					; sub_40B402+620j ...
		cmp	[ebp+var_30], 0
		jz	short loc_40BA5D
		cmp	dword ptr [ebp+var_28],	9000h
		jz	loc_40B6CB

loc_40BA5D:				; CODE XREF: sub_40B402+64Cj
		cmp	[ebp+var_18], 0
		jz	short loc_40BA7C
		mov	eax, [ebp+var_18]
		mov	[esp+288h+Dst],	eax
		call	gcry_free
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0

loc_40BA7C:				; CODE XREF: sub_40B402+65Fj
		mov	eax, [ebp+var_15C]
		sub	eax, 2
		mov	[ebp+var_15C], eax
		mov	eax, ds:dword_451D20
		and	eax, 800h
		test	eax, eax
		jz	short loc_40BAF1
		mov	eax, [ebp+var_15C]
		mov	[esp+288h+Size], eax
		mov	eax, dword ptr [ebp+var_28]
		mov	[esp+288h+Src],	eax ; char
		mov	[esp+288h+Dst],	offset aResponseSw04xD ; " response: sw=%04X  datalen=%d\n"
		call	sub_43CBBE
		cmp	[ebp+arg_20], 0
		jnz	short loc_40BAF1
		cmp	dword ptr [ebp+var_28],	9000h
		jz	short loc_40BAD4
		mov	eax, dword ptr [ebp+var_28]
		and	eax, 0FF00h
		cmp	eax, 6100h
		jnz	short loc_40BAF1

loc_40BAD4:				; CODE XREF: sub_40B402+6C1j
		mov	eax, [ebp+var_15C]
		mov	[esp+288h+Size], eax
		mov	eax, [ebp+var_14]
		mov	[esp+288h+Src],	eax
		mov	[esp+288h+Dst],	offset aDump ; "    dump: "
		call	sub_43CC18

loc_40BAF1:				; CODE XREF: sub_40B402+695j
					; sub_40B402+6B8j ...
		cmp	dword ptr [ebp+var_28],	9000h
		jz	short loc_40BB07
		cmp	dword ptr [ebp+var_28],	6282h
		jnz	loc_40BB8E

loc_40BB07:				; CODE XREF: sub_40B402+6F6j
		cmp	[ebp+arg_20], 0
		jz	loc_40BFC6
		mov	eax, [ebp+var_15C]
		test	eax, eax
		jz	short loc_40BB23
		mov	eax, [ebp+var_15C]
		jmp	short loc_40BB28
; ---------------------------------------------------------------------------

loc_40BB23:				; CODE XREF: sub_40B402+717j
		mov	eax, 1

loc_40BB28:				; CODE XREF: sub_40B402+71Fj
		mov	[esp+288h+Dst],	eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+arg_20]
		mov	[eax], edx
		mov	eax, [ebp+arg_20]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40BB60
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Dst],	eax
		call	sub_407997
		mov	eax, [ebp+var_C]
		mov	[esp+288h+Dst],	eax
		call	gcry_free
		mov	eax, 10001h
		jmp	locret_40C01A
; ---------------------------------------------------------------------------

loc_40BB60:				; CODE XREF: sub_40B402+73Cj
		mov	edx, [ebp+var_15C]
		mov	eax, [ebp+arg_24]
		mov	[eax], edx
		mov	ecx, [ebp+var_15C]
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_20]
		mov	eax, [eax]
		mov	[esp+288h+Size], ecx ; Size
		mov	[esp+288h+Src],	edx ; Src
		mov	[esp+288h+Dst],	eax ; Dst
		call	memcpy
		jmp	loc_40BFC6
; ---------------------------------------------------------------------------

loc_40BB8E:				; CODE XREF: sub_40B402+6FFj
		mov	eax, dword ptr [ebp+var_28]
		and	eax, 0FF00h
		cmp	eax, 6100h
		jnz	loc_40BFC6
		mov	[ebp+var_3C], 0
		mov	[ebp+var_40], 1000h
		cmp	[ebp+arg_20], 0
		jz	loc_40BC44
		mov	eax, [ebp+var_40]
		mov	[esp+288h+Dst],	eax
		call	gcry_malloc
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+arg_20]
		mov	edx, [ebp+var_3C]
		mov	[eax], edx
		mov	eax, [ebp+arg_20]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40BBF8
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Dst],	eax
		call	sub_407997
		mov	eax, [ebp+var_C]
		mov	[esp+288h+Dst],	eax
		call	gcry_free
		mov	eax, 10001h
		jmp	locret_40C01A
; ---------------------------------------------------------------------------

loc_40BBF8:				; CODE XREF: sub_40B402+7D4j
		mov	eax, [ebp+var_15C]
		cmp	eax, [ebp+var_40]
		jb	short loc_40BC1F
		mov	[esp+288h+Size], 0EFBh ; int
		mov	[esp+288h+Src],	offset a____Gnupg22__1 ; "../../gnupg2-2.0.30/scd/apdu.c"
		mov	[esp+288h+Dst],	offset aResultlenBufsi ; "resultlen < bufsize"
		call	sub_442650

loc_40BC1F:				; CODE XREF: sub_40B402+7FFj
		mov	ecx, [ebp+var_15C]
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_3C]
		mov	[esp+288h+Size], ecx ; Size
		mov	[esp+288h+Src],	edx ; Src
		mov	[esp+288h+Dst],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_15C]
		add	[ebp+var_3C], eax

loc_40BC44:				; CODE XREF: sub_40B402+7B1j
					; sub_40B402+B7Cj
		mov	eax, dword ptr [ebp+var_28]
		and	eax, 0FFh
		mov	[ebp+var_48], eax
		mov	eax, ds:dword_451D20
		and	eax, 800h
		test	eax, eax
		jz	short loc_40BC77
		mov	eax, [ebp+var_48]
		mov	[esp+288h+Size], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Src],	eax ; char
		mov	[esp+288h+Dst],	offset aApdu_send_si_0 ; "apdu_send_simple(%d):	%d more	bytes ava"...
		call	sub_43CBBE

loc_40BC77:				; CODE XREF: sub_40B402+859j
		mov	[ebp+var_1C], 106h
		lea	eax, [ebp+var_262]
		mov	[ebp+var_20], eax
		mov	[ebp+var_24], 0
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]
		add	edx, eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	[edx], al
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]
		add	eax, edx
		mov	byte ptr [eax],	0C0h
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]
		add	eax, edx
		mov	byte ptr [eax],	0
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]
		add	eax, edx
		mov	byte ptr [eax],	0
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_20]
		add	edx, eax
		mov	eax, [ebp+var_48]
		mov	[edx], al
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_1C]
		jbe	short loc_40BD01
		mov	[esp+288h+Size], 0F0Fh ; int
		mov	[esp+288h+Src],	offset a____Gnupg22__1 ; "../../gnupg2-2.0.30/scd/apdu.c"
		mov	[esp+288h+Dst],	offset aApdulenApdu_bu ; "apdulen <= apdu_buffer_size"
		call	sub_442650

loc_40BD01:				; CODE XREF: sub_40B402+8E1j
		mov	eax, [ebp+var_24]
		mov	edx, [ebp+var_1C]
		sub	edx, eax
		mov	eax, [ebp+var_24]
		mov	ecx, [ebp+var_20]
		add	eax, ecx
		mov	[esp+288h+Size], edx ; Size
		mov	[esp+288h+Src],	0 ; Val
		mov	[esp+288h+Dst],	eax ; Dst
		call	memset
		mov	eax, [ebp+var_10]
		mov	[ebp+var_15C], eax
		mov	[esp+288h+var_274], 0
		lea	eax, [ebp+var_15C]
		mov	[esp+288h+var_278], eax
		mov	eax, [ebp+var_14]
		mov	[esp+288h+var_27C], eax
		mov	eax, [ebp+var_24]
		mov	[esp+288h+Size], eax
		mov	eax, [ebp+var_20]
		mov	[esp+288h+Src],	eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Dst],	eax
		call	sub_40B37D
		mov	[ebp+var_44], eax
		cmp	[ebp+var_44], 0
		jnz	short loc_40BD74
		mov	eax, [ebp+var_15C]
		cmp	eax, 1
		ja	short loc_40BDC1

loc_40BD74:				; CODE XREF: sub_40B402+965j
		mov	eax, [ebp+var_44]
		mov	[esp+288h+Dst],	eax
		call	sub_407E6A
		mov	[esp+288h+Size], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Src],	eax ; char
		mov	[esp+288h+Dst],	offset aApdu_send_si_1 ; "apdu_send_simple(%d) for get response	f"...
		call	sub_43CB21
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Dst],	eax
		call	sub_407997
		mov	eax, [ebp+var_C]
		mov	[esp+288h+Dst],	eax
		call	gcry_free
		cmp	[ebp+var_44], 0
		jz	short loc_40BDB7
		mov	eax, [ebp+var_44]
		jmp	short loc_40BDBC
; ---------------------------------------------------------------------------

loc_40BDB7:				; CODE XREF: sub_40B402+9AEj
		mov	eax, 10003h

loc_40BDBC:				; CODE XREF: sub_40B402+9B3j
		jmp	locret_40C01A
; ---------------------------------------------------------------------------

loc_40BDC1:				; CODE XREF: sub_40B402+970j
		mov	eax, [ebp+var_15C]
		sub	eax, 2
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 8
		mov	eax, [ebp+var_15C]
		sub	eax, 1
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, edx
		mov	dword ptr [ebp+var_28],	eax
		mov	eax, [ebp+var_15C]
		sub	eax, 2
		mov	[ebp+var_15C], eax
		mov	eax, ds:dword_451D20
		and	eax, 800h
		test	eax, eax
		jz	short loc_40BE64
		mov	eax, [ebp+var_15C]
		mov	[esp+288h+Size], eax
		mov	eax, dword ptr [ebp+var_28]
		mov	[esp+288h+Src],	eax ; char
		mov	[esp+288h+Dst],	offset aMoreSw04xDatal ; "     more: sw=%04X  datalen=%d\n"
		call	sub_43CBBE
		cmp	[ebp+arg_20], 0
		jnz	short loc_40BE64
		cmp	dword ptr [ebp+var_28],	9000h
		jz	short loc_40BE47
		mov	eax, dword ptr [ebp+var_28]
		and	eax, 0FF00h
		cmp	eax, 6100h
		jnz	short loc_40BE64

loc_40BE47:				; CODE XREF: sub_40B402+A34j
		mov	eax, [ebp+var_15C]
		mov	[esp+288h+Size], eax
		mov	eax, [ebp+var_14]
		mov	[esp+288h+Src],	eax
		mov	[esp+288h+Dst],	offset aDump_0 ; "     dump: "
		call	sub_43CC18

loc_40BE64:				; CODE XREF: sub_40B402+A08j
					; sub_40B402+A2Bj ...
		mov	eax, dword ptr [ebp+var_28]
		and	eax, 0FF00h
		cmp	eax, 6100h
		jz	short loc_40BE89
		cmp	dword ptr [ebp+var_28],	9000h
		jz	short loc_40BE89
		cmp	dword ptr [ebp+var_28],	6282h
		jnz	loc_40BF54

loc_40BE89:				; CODE XREF: sub_40B402+A6Fj
					; sub_40B402+A78j
		cmp	[ebp+arg_20], 0
		jz	loc_40BF70
		mov	eax, [ebp+var_15C]
		test	eax, eax
		jz	loc_40BF70
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+arg_20]
		mov	eax, [eax]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+var_15C]
		add	eax, edx
		cmp	eax, [ebp+var_40]
		jbe	short loc_40BF2D
		mov	eax, [ebp+var_15C]
		mov	edx, 1000h
		cmp	eax, 1000h
		cmovb	eax, edx
		add	[ebp+var_40], eax
		mov	eax, [ebp+arg_20]
		mov	eax, [eax]
		mov	edx, [ebp+var_40]
		mov	[esp+288h+Src],	edx
		mov	[esp+288h+Dst],	eax
		call	gcry_realloc
		mov	[ebp+var_4C], eax
		cmp	[ebp+var_4C], 0
		jnz	short loc_40BF11
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Dst],	eax
		call	sub_407997
		mov	eax, [ebp+var_C]
		mov	[esp+288h+Dst],	eax
		call	gcry_free
		mov	eax, 10001h
		jmp	locret_40C01A
; ---------------------------------------------------------------------------

loc_40BF11:				; CODE XREF: sub_40B402+AEDj
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+arg_20]
		mov	eax, [eax]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, [ebp+var_4C]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+arg_20]
		mov	edx, [ebp+var_4C]
		mov	[eax], edx

loc_40BF2D:				; CODE XREF: sub_40B402+ABAj
		mov	ecx, [ebp+var_15C]
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_3C]
		mov	[esp+288h+Size], ecx ; Size
		mov	[esp+288h+Src],	edx ; Src
		mov	[esp+288h+Dst],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_15C]
		add	[ebp+var_3C], eax
		jmp	short loc_40BF70
; ---------------------------------------------------------------------------

loc_40BF54:				; CODE XREF: sub_40B402+A81j
		mov	eax, dword ptr [ebp+var_28]
		mov	[esp+288h+Size], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Src],	eax ; char
		mov	[esp+288h+Dst],	offset aApdu_send_si_2 ; "apdu_send_simple(%d) got unexpected sta"...
		call	sub_43CAF7
		jmp	short loc_40BF71
; ---------------------------------------------------------------------------

loc_40BF70:				; CODE XREF: sub_40B402+A8Bj
					; sub_40B402+A99j ...
		nop

loc_40BF71:				; CODE XREF: sub_40B402+B6Cj
		mov	eax, dword ptr [ebp+var_28]
		and	eax, 0FF00h
		cmp	eax, 6100h
		jz	loc_40BC44
		cmp	[ebp+arg_20], 0
		jz	short loc_40BFC6
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+arg_20]
		mov	eax, [eax]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+arg_24]
		mov	[eax], edx
		mov	eax, [ebp+arg_24]
		mov	edx, [eax]
		mov	eax, [ebp+arg_20]
		mov	eax, [eax]
		mov	[esp+288h+Src],	edx
		mov	[esp+288h+Dst],	eax
		call	gcry_realloc
		mov	[ebp+var_4C], eax
		cmp	[ebp+var_4C], 0
		jz	short loc_40BFC6
		mov	eax, [ebp+arg_20]
		mov	edx, [ebp+var_4C]
		mov	[eax], edx

loc_40BFC6:				; CODE XREF: sub_40B402+709j
					; sub_40B402+787j ...
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Dst],	eax
		call	sub_407997
		mov	eax, [ebp+var_C]
		mov	[esp+288h+Dst],	eax
		call	gcry_free
		mov	eax, ds:dword_451D20
		and	eax, 800h
		test	eax, eax
		jz	short loc_40C017
		cmp	[ebp+arg_20], 0
		jz	short loc_40C017
		cmp	dword ptr [ebp+var_28],	9000h
		jnz	short loc_40C017
		mov	eax, [ebp+arg_24]
		mov	edx, [eax]
		mov	eax, [ebp+arg_20]
		mov	eax, [eax]
		mov	[esp+288h+Size], edx
		mov	[esp+288h+Src],	eax
		mov	[esp+288h+Dst],	offset aDump_1 ; "	dump: "
		call	sub_43CC18

loc_40C017:				; CODE XREF: sub_40B402+BE6j
					; sub_40B402+BECj ...
		mov	eax, dword ptr [ebp+var_28]

locret_40C01A:				; CODE XREF: sub_40B402+51j
					; sub_40B402+C5j ...
		leave
		retn
sub_40B402	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40C01C(char, int, char, int, int, int, size_t, void *, int, int, int)
sub_40C01C	proc near		; CODE XREF: sub_40D3CB+BBp
					; sub_40D61C+B6p ...

var_38		= byte ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch
arg_28		= dword	ptr  30h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_C], eax ; int
		mov	[esp+38h+var_10], 0 ; int
		mov	eax, [ebp+arg_28]
		mov	[esp+38h+var_14], eax ;	int
		mov	eax, [ebp+arg_24]
		mov	[esp+38h+var_18], eax ;	int
		mov	eax, [ebp+arg_20]
		mov	[esp+38h+var_1C], eax ;	int
		mov	eax, [ebp+arg_1C]
		mov	[esp+38h+var_20], eax ;	void *
		mov	eax, [ebp+arg_18]
		mov	[esp+38h+var_24], eax ;	size_t
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+var_28], eax ;	int
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_2C], eax ;	int
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_30], eax ;	int
		mov	eax, dword ptr [ebp+arg_8]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+38h+var_38], eax	; char
		call	sub_40B402
		leave
		retn
sub_40C01C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40C07D(char, int, char, int, int, int, size_t, void *, int, int)
sub_40C07D	proc near		; CODE XREF: .text:0040CF90p

var_38		= byte ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_C], eax ; int
		mov	[esp+38h+var_10], 0 ; int
		mov	eax, [ebp+arg_24]
		mov	[esp+38h+var_14], eax ;	int
		mov	eax, [ebp+arg_20]
		mov	[esp+38h+var_18], eax ;	int
		mov	[esp+38h+var_1C], 100h ; int
		mov	eax, [ebp+arg_1C]
		mov	[esp+38h+var_20], eax ;	void *
		mov	eax, [ebp+arg_18]
		mov	[esp+38h+var_24], eax ;	size_t
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+var_28], eax ;	int
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_2C], eax ;	int
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_30], eax ;	int
		mov	eax, dword ptr [ebp+arg_8]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+38h+var_38], eax	; char
		call	sub_40B402
		leave
		retn
sub_40C07D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40C0DF(char, int, char, int, int, int, size_t, void *)
sub_40C0DF	proc near		; CODE XREF: sub_40CCE9+54p
					; sub_40CD52+A8p ...

var_38		= byte ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_C], eax ; int
		mov	[esp+38h+var_10], 0 ; int
		mov	[esp+38h+var_14], 0 ; int
		mov	[esp+38h+var_18], 0 ; int
		mov	[esp+38h+var_1C], 0FFFFFFFFh ; int
		mov	eax, [ebp+arg_1C]
		mov	[esp+38h+var_20], eax ;	void *
		mov	eax, [ebp+arg_18]
		mov	[esp+38h+var_24], eax ;	size_t
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+var_28], eax ;	int
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_2C], eax ;	int
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_30], eax ;	int
		mov	eax, dword ptr [ebp+arg_8]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+38h+var_38], eax	; char
		call	sub_40B402
		leave
		retn
sub_40C0DF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40C143(char, int, void *, size_t, int, int, int)
sub_40C143	proc near		; CODE XREF: sub_4068D3+257p
					; sub_40CFCD+66p ...

Dst		= dword	ptr -288h
Src		= dword	ptr -284h
Size		= dword	ptr -280h
var_27C		= dword	ptr -27Ch
var_278		= dword	ptr -278h
var_274		= dword	ptr -274h
var_25B		= byte ptr -25Bh
var_14C		= dword	ptr -14Ch
var_148		= byte ptr -148h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		sub	esp, 288h
		mov	[ebp+var_C], 0
		mov	[ebp+var_18], 0
		cmp	dword ptr [ebp+arg_0], 0
		js	short loc_40C17A
		cmp	dword ptr [ebp+arg_0], 3
		jg	short loc_40C17A
		mov	eax, dword ptr [ebp+arg_0]
		imul	eax, 0A8h
		add	eax, offset dword_451160
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40C184

loc_40C17A:				; CODE XREF: sub_40C143+1Bj
					; sub_40C143+21j
		mov	eax, 10004h
		jmp	locret_40C924
; ---------------------------------------------------------------------------

loc_40C184:				; CODE XREF: sub_40C143+35j
		cmp	[ebp+arg_C], 0FFFFh
		jbe	short loc_40C197
		mov	eax, 10002h
		jmp	locret_40C924
; ---------------------------------------------------------------------------

loc_40C197:				; CODE XREF: sub_40C143+48j
		cmp	[ebp+arg_C], 10Ah
		jbe	short loc_40C1C9
		mov	eax, [ebp+arg_C]
		add	eax, 5
		mov	[esp+288h+Dst],	eax
		call	gcry_malloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_40C1C1
		mov	eax, 10001h
		jmp	locret_40C924
; ---------------------------------------------------------------------------

loc_40C1C1:				; CODE XREF: sub_40C143+72j
		mov	eax, [ebp+var_18]
		mov	[ebp+var_1C], eax
		jmp	short loc_40C1D2
; ---------------------------------------------------------------------------

loc_40C1C9:				; CODE XREF: sub_40C143+5Bj
		lea	eax, [ebp+var_25B]
		mov	[ebp+var_1C], eax

loc_40C1D2:				; CODE XREF: sub_40C143+84j
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_2C], eax
		mov	edx, [ebp+arg_8]
		mov	eax, [ebp+var_1C]
		mov	ecx, [ebp+arg_C]
		mov	[esp+288h+Size], ecx ; Size
		mov	[esp+288h+Src],	edx ; Src
		mov	[esp+288h+Dst],	eax ; Dst
		call	memcpy
		cmp	[ebp+var_2C], 0
		jz	short loc_40C202
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		jmp	short loc_40C207
; ---------------------------------------------------------------------------

loc_40C202:				; CODE XREF: sub_40C143+B2j
		mov	eax, 0

loc_40C207:				; CODE XREF: sub_40C143+BDj
		mov	[ebp+var_30], eax
		cmp	[ebp+arg_4], 0FFh
		jbe	short loc_40C256
		cmp	[ebp+arg_4], 10000h
		ja	short loc_40C256
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		add	eax, 0Ah
		mov	[esp+288h+Dst],	eax
		call	gcry_malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40C24E
		mov	eax, [ebp+var_18]
		mov	[esp+288h+Dst],	eax
		call	gcry_free
		mov	eax, 10001h
		jmp	locret_40C924
; ---------------------------------------------------------------------------

loc_40C24E:				; CODE XREF: sub_40C143+F4j
		mov	eax, [ebp+var_C]
		mov	[ebp+var_14], eax
		jmp	short loc_40C266
; ---------------------------------------------------------------------------

loc_40C256:				; CODE XREF: sub_40C143+CEj
					; sub_40C143+D7j
		mov	[ebp+var_10], 102h
		lea	eax, [ebp+var_148]
		mov	[ebp+var_14], eax

loc_40C266:				; CODE XREF: sub_40C143+111j
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Dst],	eax
		call	sub_40791B
		mov	dword ptr [ebp+var_20],	eax
		cmp	dword ptr [ebp+var_20],	0
		jz	short loc_40C298
		mov	eax, [ebp+var_18]
		mov	[esp+288h+Dst],	eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	[esp+288h+Dst],	eax
		call	gcry_free
		mov	eax, dword ptr [ebp+var_20]
		jmp	locret_40C924
; ---------------------------------------------------------------------------

loc_40C298:				; CODE XREF: sub_40C143+135j
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14C], eax
		mov	[esp+288h+var_274], 0
		lea	eax, [ebp+var_14C]
		mov	[esp+288h+var_278], eax
		mov	eax, [ebp+var_14]
		mov	[esp+288h+var_27C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+288h+Size], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+288h+Src],	eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Dst],	eax
		call	sub_40B37D
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_18]
		mov	[esp+288h+Dst],	eax
		call	gcry_free
		mov	[ebp+var_18], 0
		cmp	[ebp+var_34], 0
		jnz	short loc_40C2F9
		mov	eax, [ebp+var_14C]
		cmp	eax, 1
		ja	short loc_40C346

loc_40C2F9:				; CODE XREF: sub_40C143+1A9j
		mov	eax, [ebp+var_34]
		mov	[esp+288h+Dst],	eax
		call	sub_407E6A
		mov	[esp+288h+Size], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Src],	eax ; char
		mov	[esp+288h+Dst],	offset aApdu_send_di_0 ; "apdu_send_direct(%d) failed: %s\n"
		call	sub_43CB21
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Dst],	eax
		call	sub_407997
		mov	eax, [ebp+var_C]
		mov	[esp+288h+Dst],	eax
		call	gcry_free
		cmp	[ebp+var_34], 0
		jz	short loc_40C33C
		mov	eax, [ebp+var_34]
		jmp	short loc_40C341
; ---------------------------------------------------------------------------

loc_40C33C:				; CODE XREF: sub_40C143+1F2j
		mov	eax, 10003h

loc_40C341:				; CODE XREF: sub_40C143+1F7j
		jmp	locret_40C924
; ---------------------------------------------------------------------------

loc_40C346:				; CODE XREF: sub_40C143+1B4j
		mov	eax, [ebp+var_14C]
		sub	eax, 2
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 8
		mov	eax, [ebp+var_14C]
		sub	eax, 1
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, edx
		mov	dword ptr [ebp+var_20],	eax
		mov	eax, [ebp+var_14C]
		sub	eax, 2
		mov	[ebp+var_14C], eax
		mov	eax, ds:dword_451D20
		and	eax, 800h
		test	eax, eax
		jz	short loc_40C3E9
		mov	eax, [ebp+var_14C]
		mov	[esp+288h+Size], eax
		mov	eax, dword ptr [ebp+var_20]
		mov	[esp+288h+Src],	eax ; char
		mov	[esp+288h+Dst],	offset aResponseSw04xD ; " response: sw=%04X  datalen=%d\n"
		call	sub_43CBBE
		cmp	[ebp+arg_14], 0
		jnz	short loc_40C3E9
		cmp	dword ptr [ebp+var_20],	9000h
		jz	short loc_40C3CC
		mov	eax, dword ptr [ebp+var_20]
		and	eax, 0FF00h
		cmp	eax, 6100h
		jnz	short loc_40C3E9

loc_40C3CC:				; CODE XREF: sub_40C143+278j
		mov	eax, [ebp+var_14C]
		mov	[esp+288h+Size], eax
		mov	eax, [ebp+var_14]
		mov	[esp+288h+Src],	eax
		mov	[esp+288h+Dst],	offset aDump_0 ; "     dump: "
		call	sub_43CC18

loc_40C3E9:				; CODE XREF: sub_40C143+24Cj
					; sub_40C143+26Fj ...
		cmp	[ebp+arg_10], 0
		jz	loc_40C816
		mov	eax, dword ptr [ebp+var_20]
		and	eax, 0FF00h
		cmp	eax, 6100h
		jnz	loc_40C816
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 1000h
		cmp	[ebp+arg_14], 0
		jz	loc_40C4AC
		mov	eax, [ebp+var_28]
		add	eax, 2
		mov	[esp+288h+Dst],	eax
		call	gcry_malloc
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_14]
		mov	edx, [ebp+var_24]
		mov	[eax], edx
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40C460
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Dst],	eax
		call	sub_407997
		mov	eax, [ebp+var_C]
		mov	[esp+288h+Dst],	eax
		call	gcry_free
		mov	eax, 10001h
		jmp	locret_40C924
; ---------------------------------------------------------------------------

loc_40C460:				; CODE XREF: sub_40C143+2FBj
		mov	eax, [ebp+var_14C]
		cmp	eax, [ebp+var_28]
		jb	short loc_40C487
		mov	[esp+288h+Size], 1003h ; int
		mov	[esp+288h+Src],	offset a____Gnupg22__1 ; "../../gnupg2-2.0.30/scd/apdu.c"
		mov	[esp+288h+Dst],	offset aResultlenBufsi ; "resultlen < bufsize"
		call	sub_442650

loc_40C487:				; CODE XREF: sub_40C143+326j
		mov	ecx, [ebp+var_14C]
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_24]
		mov	[esp+288h+Size], ecx ; Size
		mov	[esp+288h+Src],	edx ; Src
		mov	[esp+288h+Dst],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_14C]
		add	[ebp+var_24], eax

loc_40C4AC:				; CODE XREF: sub_40C143+2D5j
					; sub_40C143+67Bj
		mov	eax, dword ptr [ebp+var_20]
		and	eax, 0FFh
		mov	[ebp+var_38], eax
		mov	eax, ds:dword_451D20
		and	eax, 800h
		test	eax, eax
		jz	short loc_40C4DF
		mov	eax, [ebp+var_38]
		mov	[esp+288h+Size], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Src],	eax ; char
		mov	[esp+288h+Dst],	offset aApdu_send_di_1 ; "apdu_send_direct(%d):	%d more	bytes ava"...
		call	sub_43CBBE

loc_40C4DF:				; CODE XREF: sub_40C143+380j
		lea	eax, [ebp+var_25B]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_2C], 0
		mov	eax, [ebp+var_2C]
		mov	edx, [ebp+var_1C]
		add	edx, eax
		mov	eax, [ebp+var_30]
		mov	[edx], al
		add	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	edx, [ebp+var_1C]
		add	eax, edx
		mov	byte ptr [eax],	0C0h
		add	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	edx, [ebp+var_1C]
		add	eax, edx
		mov	byte ptr [eax],	0
		add	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	edx, [ebp+var_1C]
		add	eax, edx
		mov	byte ptr [eax],	0
		add	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	edx, [ebp+var_1C]
		add	edx, eax
		mov	eax, [ebp+var_38]
		mov	[edx], al
		add	[ebp+var_2C], 1
		mov	eax, 10Fh
		sub	eax, [ebp+var_2C]
		mov	edx, [ebp+var_2C]
		mov	ecx, [ebp+var_1C]
		add	edx, ecx
		mov	[esp+288h+Size], eax ; Size
		mov	[esp+288h+Src],	0 ; Val
		mov	[esp+288h+Dst],	edx ; Dst
		call	memset
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14C], eax
		mov	[esp+288h+var_274], 0
		lea	eax, [ebp+var_14C]
		mov	[esp+288h+var_278], eax
		mov	eax, [ebp+var_14]
		mov	[esp+288h+var_27C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+288h+Size], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+288h+Src],	eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Dst],	eax
		call	sub_40B37D
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jnz	short loc_40C5B1
		mov	eax, [ebp+var_14C]
		cmp	eax, 1
		ja	short loc_40C5FE

loc_40C5B1:				; CODE XREF: sub_40C143+461j
		mov	eax, [ebp+var_34]
		mov	[esp+288h+Dst],	eax
		call	sub_407E6A
		mov	[esp+288h+Size], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Src],	eax ; char
		mov	[esp+288h+Dst],	offset aApdu_send_di_2 ; "apdu_send_direct(%d) for get response	f"...
		call	sub_43CB21
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Dst],	eax
		call	sub_407997
		mov	eax, [ebp+var_C]
		mov	[esp+288h+Dst],	eax
		call	gcry_free
		cmp	[ebp+var_34], 0
		jz	short loc_40C5F4
		mov	eax, [ebp+var_34]
		jmp	short loc_40C5F9
; ---------------------------------------------------------------------------

loc_40C5F4:				; CODE XREF: sub_40C143+4AAj
		mov	eax, 10003h

loc_40C5F9:				; CODE XREF: sub_40C143+4AFj
		jmp	locret_40C924
; ---------------------------------------------------------------------------

loc_40C5FE:				; CODE XREF: sub_40C143+46Cj
		mov	eax, [ebp+var_14C]
		sub	eax, 2
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 8
		mov	eax, [ebp+var_14C]
		sub	eax, 1
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, edx
		mov	dword ptr [ebp+var_20],	eax
		mov	eax, [ebp+var_14C]
		sub	eax, 2
		mov	[ebp+var_14C], eax
		mov	eax, ds:dword_451D20
		and	eax, 800h
		test	eax, eax
		jz	short loc_40C6A1
		mov	eax, [ebp+var_14C]
		mov	[esp+288h+Size], eax
		mov	eax, dword ptr [ebp+var_20]
		mov	[esp+288h+Src],	eax ; char
		mov	[esp+288h+Dst],	offset aMoreSw04xDatal ; "     more: sw=%04X  datalen=%d\n"
		call	sub_43CBBE
		cmp	[ebp+arg_14], 0
		jnz	short loc_40C6A1
		cmp	dword ptr [ebp+var_20],	9000h
		jz	short loc_40C684
		mov	eax, dword ptr [ebp+var_20]
		and	eax, 0FF00h
		cmp	eax, 6100h
		jnz	short loc_40C6A1

loc_40C684:				; CODE XREF: sub_40C143+530j
		mov	eax, [ebp+var_14C]
		mov	[esp+288h+Size], eax
		mov	eax, [ebp+var_14]
		mov	[esp+288h+Src],	eax
		mov	[esp+288h+Dst],	offset aDump_0 ; "     dump: "
		call	sub_43CC18

loc_40C6A1:				; CODE XREF: sub_40C143+504j
					; sub_40C143+527j ...
		mov	eax, dword ptr [ebp+var_20]
		and	eax, 0FF00h
		cmp	eax, 6100h
		jz	short loc_40C6C6
		cmp	dword ptr [ebp+var_20],	9000h
		jz	short loc_40C6C6
		cmp	dword ptr [ebp+var_20],	6282h
		jnz	loc_40C794

loc_40C6C6:				; CODE XREF: sub_40C143+56Bj
					; sub_40C143+574j
		cmp	[ebp+arg_14], 0
		jz	loc_40C7B0
		mov	eax, [ebp+var_14C]
		test	eax, eax
		jz	loc_40C7B0
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+var_14C]
		add	eax, edx
		cmp	eax, [ebp+var_28]
		jbe	short loc_40C76D
		mov	eax, [ebp+var_14C]
		mov	edx, 1000h
		cmp	eax, 1000h
		cmovb	eax, edx
		add	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		mov	[esp+288h+Src],	edx
		mov	[esp+288h+Dst],	eax
		call	gcry_realloc
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jnz	short loc_40C751
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Dst],	eax
		call	sub_407997
		mov	eax, [ebp+var_C]
		mov	[esp+288h+Dst],	eax
		call	gcry_free
		mov	eax, 10001h
		jmp	locret_40C924
; ---------------------------------------------------------------------------

loc_40C751:				; CODE XREF: sub_40C143+5ECj
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, [ebp+var_3C]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_14]
		mov	edx, [ebp+var_3C]
		mov	[eax], edx

loc_40C76D:				; CODE XREF: sub_40C143+5B6j
		mov	ecx, [ebp+var_14C]
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_24]
		mov	[esp+288h+Size], ecx ; Size
		mov	[esp+288h+Src],	edx ; Src
		mov	[esp+288h+Dst],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_14C]
		add	[ebp+var_24], eax
		jmp	short loc_40C7B0
; ---------------------------------------------------------------------------

loc_40C794:				; CODE XREF: sub_40C143+57Dj
		mov	eax, dword ptr [ebp+var_20]
		mov	[esp+288h+Size], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Src],	eax ; char
		mov	[esp+288h+Dst],	offset aApdu_send_di_3 ; "apdu_send_direct(%d) got unexpected sta"...
		call	sub_43CAF7
		jmp	short loc_40C7B1
; ---------------------------------------------------------------------------

loc_40C7B0:				; CODE XREF: sub_40C143+587j
					; sub_40C143+595j ...
		nop

loc_40C7B1:				; CODE XREF: sub_40C143+66Bj
		mov	eax, dword ptr [ebp+var_20]
		and	eax, 0FF00h
		cmp	eax, 6100h
		jz	loc_40C4AC
		cmp	[ebp+arg_14], 0
		jz	loc_40C899
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+arg_18]
		mov	[eax], edx
		mov	eax, [ebp+arg_18]
		mov	eax, [eax]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		mov	[esp+288h+Src],	edx
		mov	[esp+288h+Dst],	eax
		call	gcry_realloc
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	loc_40C899
		mov	eax, [ebp+arg_14]
		mov	edx, [ebp+var_3C]
		mov	[eax], edx
		jmp	loc_40C899
; ---------------------------------------------------------------------------

loc_40C816:				; CODE XREF: sub_40C143+2AAj
					; sub_40C143+2BDj
		cmp	[ebp+arg_14], 0
		jz	short loc_40C89A
		mov	eax, [ebp+var_14C]
		test	eax, eax
		jz	short loc_40C831
		mov	eax, [ebp+var_14C]
		add	eax, 2
		jmp	short loc_40C836
; ---------------------------------------------------------------------------

loc_40C831:				; CODE XREF: sub_40C143+6E1j
		mov	eax, 3

loc_40C836:				; CODE XREF: sub_40C143+6ECj
		mov	[esp+288h+Dst],	eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+arg_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40C86E
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Dst],	eax
		call	sub_407997
		mov	eax, [ebp+var_C]
		mov	[esp+288h+Dst],	eax
		call	gcry_free
		mov	eax, 10001h
		jmp	locret_40C924
; ---------------------------------------------------------------------------

loc_40C86E:				; CODE XREF: sub_40C143+709j
		mov	edx, [ebp+var_14C]
		mov	eax, [ebp+arg_18]
		mov	[eax], edx
		mov	ecx, [ebp+var_14C]
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		mov	[esp+288h+Size], ecx ; Size
		mov	[esp+288h+Src],	edx ; Src
		mov	[esp+288h+Dst],	eax ; Dst
		call	memcpy
		jmp	short loc_40C89A
; ---------------------------------------------------------------------------

loc_40C899:				; CODE XREF: sub_40C143+685j
					; sub_40C143+6C0j ...
		nop

loc_40C89A:				; CODE XREF: sub_40C143+6D7j
					; sub_40C143+754j
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+288h+Dst],	eax
		call	sub_407997
		mov	eax, [ebp+var_C]
		mov	[esp+288h+Dst],	eax
		call	gcry_free
		cmp	[ebp+arg_14], 0
		jz	short loc_40C8ED
		mov	eax, [ebp+arg_14]
		mov	edx, [eax]
		mov	eax, [ebp+arg_18]
		mov	eax, [eax]
		lea	ecx, [edx+eax]
		mov	edx, dword ptr [ebp+var_20]
		sar	edx, 8
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_18]
		mov	[eax], edx
		mov	eax, [ebp+arg_14]
		mov	edx, [eax]
		mov	eax, [ebp+arg_18]
		mov	eax, [eax]
		lea	ecx, [edx+eax]
		mov	edx, dword ptr [ebp+var_20]
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_18]
		mov	[eax], edx

loc_40C8ED:				; CODE XREF: sub_40C143+771j
		mov	eax, ds:dword_451D20
		and	eax, 800h
		test	eax, eax
		jz	short loc_40C91F
		cmp	[ebp+arg_14], 0
		jz	short loc_40C91F
		mov	eax, [ebp+arg_18]
		mov	edx, [eax]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		mov	[esp+288h+Size], edx
		mov	[esp+288h+Src],	eax
		mov	[esp+288h+Dst],	offset aDump_1 ; "	dump: "
		call	sub_43CC18

loc_40C91F:				; CODE XREF: sub_40C143+7B6j
					; sub_40C143+7BCj
		mov	eax, 0

locret_40C924:				; CODE XREF: sub_40C143+3Cj
					; sub_40C143+4Fj ...
		leave
		retn
sub_40C143	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C928	proc near		; CODE XREF: sub_40C94F+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_40C948
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_40C94D
; ---------------------------------------------------------------------------

loc_40C948:				; CODE XREF: sub_40C928+7j
		mov	eax, 0

loc_40C94D:				; CODE XREF: sub_40C928+1Ej
		pop	ebp
		retn
sub_40C928	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C94F	proc near		; CODE XREF: sub_40C96A+Ep
					; sub_40C97F+343p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 6
		call	sub_40C928
		leave
		retn
sub_40C94F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C96A	proc near		; CODE XREF: sub_40DC72+1ECp

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_40C94F
		leave
		retn
sub_40C96A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C97F	proc near		; CODE XREF: sub_40CCC9+12p
					; sub_40CCE9+62p ...

var_14		= dword	ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		cmp	eax, 6D00h
		jz	loc_40CBE3
		cmp	eax, 6D00h
		jg	loc_40CA6C
		cmp	eax, 6985h
		jz	loc_40CB83
		cmp	eax, 6985h
		jg	short loc_40CA0E
		cmp	eax, 6882h
		jz	loc_40CB53
		cmp	eax, 6882h
		jg	short loc_40C9E8
		cmp	eax, 6581h
		jz	loc_40CB2F
		cmp	eax, 6700h
		jz	loc_40CB47
		cmp	eax, 6285h
		jz	loc_40CB3B
		jmp	loc_40CC88
; ---------------------------------------------------------------------------

loc_40C9E8:				; CODE XREF: sub_40C97F+41j
		cmp	eax, 6982h
		jz	loc_40CB6B
		cmp	eax, 6983h
		jz	loc_40CB77
		cmp	eax, 6884h
		jz	loc_40CB5F
		jmp	loc_40CC88
; ---------------------------------------------------------------------------

loc_40CA0E:				; CODE XREF: sub_40C97F+2Fj
		cmp	eax, 6A83h
		jz	loc_40CBB3
		cmp	eax, 6A83h
		jg	short loc_40CA46
		cmp	eax, 6A81h
		jz	loc_40CB8F
		cmp	eax, 6A81h
		jg	loc_40CBA7
		cmp	eax, 6A80h
		jz	loc_40CB9B
		jmp	loc_40CC88
; ---------------------------------------------------------------------------

loc_40CA46:				; CODE XREF: sub_40C97F+9Fj
		cmp	eax, 6B00h
		jz	loc_40CBCB
		cmp	eax, 6C00h
		jz	loc_40CBD7
		cmp	eax, 6A88h
		jz	loc_40CBBF
		jmp	loc_40CC88
; ---------------------------------------------------------------------------

loc_40CA6C:				; CODE XREF: sub_40C97F+19j
		cmp	eax, 10007h
		jz	loc_40CC40
		cmp	eax, 10007h
		jg	short loc_40CADC
		cmp	eax, 10002h
		jz	loc_40CC13
		cmp	eax, 10002h
		jg	short loc_40CAB6
		cmp	eax, 9000h
		jz	loc_40CBFB
		cmp	eax, 10001h
		jz	loc_40CC07
		cmp	eax, 6E00h
		jz	loc_40CBEF
		jmp	loc_40CC88
; ---------------------------------------------------------------------------

loc_40CAB6:				; CODE XREF: sub_40C97F+10Fj
		cmp	eax, 10005h
		jz	loc_40CC2B
		cmp	eax, 10005h
		jg	loc_40CC37
		cmp	eax, 10003h
		jz	loc_40CC1F
		jmp	loc_40CC88
; ---------------------------------------------------------------------------

loc_40CADC:				; CODE XREF: sub_40C97F+FDj
		cmp	eax, 1000Bh
		jz	loc_40CC64
		cmp	eax, 1000Bh
		jg	short loc_40CB09
		cmp	eax, 10009h
		jz	loc_40CC52
		cmp	eax, 10009h
		jg	loc_40CC5B
		jmp	loc_40CC49
; ---------------------------------------------------------------------------

loc_40CB09:				; CODE XREF: sub_40C97F+16Dj
		cmp	eax, 1000Dh
		jz	loc_40CC76
		cmp	eax, 1000Dh
		jl	loc_40CC6D
		cmp	eax, 1000Eh
		jz	loc_40CC7F
		jmp	loc_40CC88
; ---------------------------------------------------------------------------

loc_40CB2F:				; CODE XREF: sub_40C97F+48j
		mov	[ebp+var_4], 81h
		jmp	loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CB3B:				; CODE XREF: sub_40C97F+5Ej
		mov	[ebp+var_4], 6Ch
		jmp	loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CB47:				; CODE XREF: sub_40C97F+53j
		mov	[ebp+var_4], 37h
		jmp	loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CB53:				; CODE XREF: sub_40C97F+36j
		mov	[ebp+var_4], 3Ch
		jmp	loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CB5F:				; CODE XREF: sub_40C97F+84j
		mov	[ebp+var_4], 3Ch
		jmp	loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CB6B:				; CODE XREF: sub_40C97F+6Ej
		mov	[ebp+var_4], 57h
		jmp	loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CB77:				; CODE XREF: sub_40C97F+79j
		mov	[ebp+var_4], 82h
		jmp	loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CB83:				; CODE XREF: sub_40C97F+24j
		mov	[ebp+var_4], 83h
		jmp	loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CB8F:				; CODE XREF: sub_40C97F+A6j
		mov	[ebp+var_4], 3Ch
		jmp	loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CB9B:				; CODE XREF: sub_40C97F+BCj
		mov	[ebp+var_4], 37h
		jmp	loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CBA7:				; CODE XREF: sub_40C97F+B1j
		mov	[ebp+var_4], 8051h
		jmp	loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CBB3:				; CODE XREF: sub_40C97F+94j
		mov	[ebp+var_4], 1Bh
		jmp	loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CBBF:				; CODE XREF: sub_40C97F+E2j
		mov	[ebp+var_4], 44h
		jmp	loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CBCB:				; CODE XREF: sub_40C97F+CCj
		mov	[ebp+var_4], 37h
		jmp	loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CBD7:				; CODE XREF: sub_40C97F+D7j
		mov	[ebp+var_4], 37h
		jmp	loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CBE3:				; CODE XREF: sub_40C97F+Ej
		mov	[ebp+var_4], 6Ch
		jmp	loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CBEF:				; CODE XREF: sub_40C97F+12Cj
		mov	[ebp+var_4], 6Ch
		jmp	loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CBFB:				; CODE XREF: sub_40C97F+116j
		mov	[ebp+var_4], 0
		jmp	loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CC07:				; CODE XREF: sub_40C97F+121j
		mov	[ebp+var_4], 8056h
		jmp	loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CC13:				; CODE XREF: sub_40C97F+104j
		mov	[ebp+var_4], 37h
		jmp	loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CC1F:				; CODE XREF: sub_40C97F+152j
		mov	[ebp+var_4], 6Ch
		jmp	loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CC2B:				; CODE XREF: sub_40C97F+13Cj
		mov	[ebp+var_4], 3Ch
		jmp	loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CC37:				; CODE XREF: sub_40C97F+147j
		mov	[ebp+var_4], 3Bh
		jmp	short loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CC40:				; CODE XREF: sub_40C97F+F2j
		mov	[ebp+var_4], 8013h
		jmp	short loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CC49:				; CODE XREF: sub_40C97F+185j
		mov	[ebp+var_4], 70h
		jmp	short loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CC52:				; CODE XREF: sub_40C97F+174j
		mov	[ebp+var_4], 6Dh
		jmp	short loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CC5B:				; CODE XREF: sub_40C97F+17Fj
		mov	[ebp+var_4], 8031h
		jmp	short loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CC64:				; CODE XREF: sub_40C97F+162j
		mov	[ebp+var_4], 1
		jmp	short loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CC6D:				; CODE XREF: sub_40C97F+19Aj
		mov	[ebp+var_4], 8050h
		jmp	short loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CC76:				; CODE XREF: sub_40C97F+18Fj
		mov	[ebp+var_4], 63h
		jmp	short loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CC7F:				; CODE XREF: sub_40C97F+1A5j
		mov	[ebp+var_4], 3Ch
		jmp	short loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CC88:				; CODE XREF: sub_40C97F+64j
					; sub_40C97F+8Aj ...
		mov	eax, [ebp+arg_0]
		and	eax, 10000h
		test	eax, eax
		jz	short loc_40CC9D
		mov	[ebp+var_4], 1
		jmp	short loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CC9D:				; CODE XREF: sub_40C97F+313j
		mov	eax, [ebp+arg_0]
		and	eax, 0FF00h
		cmp	eax, 6100h
		jnz	short loc_40CCB5
		mov	[ebp+var_4], 0
		jmp	short loc_40CCBC
; ---------------------------------------------------------------------------

loc_40CCB5:				; CODE XREF: sub_40C97F+32Bj
		mov	[ebp+var_4], 6Ch

loc_40CCBC:				; CODE XREF: sub_40C97F+1B7j
					; sub_40C97F+1C3j ...
		mov	eax, [ebp+var_4]
		mov	[esp+14h+var_14], eax
		call	sub_40C94F
		leave
		retn
sub_40C97F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CCC9	proc near		; CODE XREF: sub_40D0D7+28p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 4
		cmp	[ebp+arg_0], 0
		jz	short loc_40CCE2
		mov	eax, [ebp+arg_0]
		mov	[esp+4+var_4], eax
		call	sub_40C97F
		jmp	short locret_40CCE7
; ---------------------------------------------------------------------------

loc_40CCE2:				; CODE XREF: sub_40CCC9+Aj
		mov	eax, 0

locret_40CCE7:				; CODE XREF: sub_40CCC9+17j
		leave
		retn
sub_40CCC9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40CCE9(char, void *, size_t, int)
sub_40CCE9	proc near		; CODE XREF: sub_418EB5+2Dp
					; sub_41C19D+8Cp ...

var_38		= byte ptr -38h
var_34		= dword	ptr -34h
var_30		= byte ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_C]
		and	eax, 1
		test	al, al
		jz	short loc_40CD03
		mov	eax, 0
		jmp	short loc_40CD08
; ---------------------------------------------------------------------------

loc_40CD03:				; CODE XREF: sub_40CCE9+11j
		mov	eax, 0Ch

loc_40CD08:				; CODE XREF: sub_40CCE9+18j
		mov	ecx, [ebp+arg_4]
		mov	[esp+38h+var_1C], ecx ;	void *
		mov	[esp+38h+var_20], edx ;	size_t
		mov	[esp+38h+var_24], eax ;	int
		mov	[esp+38h+var_28], 4 ; int
		mov	[esp+38h+var_2C], 0A4h ; int
		mov	dword ptr [esp+38h+var_30], 0 ;	char
		mov	[esp+38h+var_34], 0 ; int
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+38h+var_38], eax	; char
		call	sub_40C0DF
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	dword ptr [esp+38h+var_38], eax
		call	sub_40C97F
		leave
		retn
sub_40CCE9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CD52	proc near		; CODE XREF: sub_40E65D+19Ep
					; sub_40E65D+1D2p ...

var_38		= byte ptr -38h
var_34		= dword	ptr -34h
var_30		= byte ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_16		= byte ptr -16h
var_15		= byte ptr -15h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		sar	eax, 8
		mov	[ebp+var_16], al
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_15], al
		cmp	[ebp+arg_C], 0
		jnz	short loc_40CD73
		cmp	[ebp+arg_10], 0
		jz	short loc_40CD93

loc_40CD73:				; CODE XREF: sub_40CD52+19j
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		mov	dword ptr [esp+38h+var_38], 45h
		call	sub_40C94F
		jmp	short locret_40CE0D
; ---------------------------------------------------------------------------

loc_40CD93:				; CODE XREF: sub_40CD52+1Fj
		cmp	[ebp+arg_4], 3F00h
		jz	short loc_40CDB0
		cmp	[ebp+arg_8], 0
		jz	short loc_40CDA9
		mov	eax, 1
		jmp	short loc_40CDAE
; ---------------------------------------------------------------------------

loc_40CDA9:				; CODE XREF: sub_40CD52+4Ej
		mov	eax, 2

loc_40CDAE:				; CODE XREF: sub_40CD52+55j
		jmp	short loc_40CDB5
; ---------------------------------------------------------------------------

loc_40CDB0:				; CODE XREF: sub_40CD52+48j
		mov	eax, 0

loc_40CDB5:				; CODE XREF: sub_40CD52:loc_40CDAEj
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0Ch
		lea	eax, [ebp+var_16]
		mov	[esp+38h+var_1C], eax ;	void *
		mov	[esp+38h+var_20], 2 ; size_t
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_24], eax ;	int
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_28], eax ;	int
		mov	[esp+38h+var_2C], 0A4h ; int
		mov	dword ptr [esp+38h+var_30], 0 ;	char
		mov	[esp+38h+var_34], 0 ; int
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+38h+var_38], eax	; char
		call	sub_40C0DF
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	dword ptr [esp+38h+var_38], eax
		call	sub_40C97F

locret_40CE0D:				; CODE XREF: sub_40CD52+3Fj
		leave
		retn
sub_40CD52	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CE0F	proc near		; CODE XREF: sub_41A8F7+6Bp
					; sub_41DC64+79p ...

var_A8		= byte ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= byte ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_7C		= byte ptr -7Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 0A8h
		cmp	[ebp+arg_C], 0
		jnz	short loc_40CE24
		cmp	[ebp+arg_10], 0
		jz	short loc_40CE47

loc_40CE24:				; CODE XREF: sub_40CE0F+Dj
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		mov	dword ptr [esp+0A8h+var_A8], 45h
		call	sub_40C94F
		jmp	locret_40CEFF
; ---------------------------------------------------------------------------

loc_40CE47:				; CODE XREF: sub_40CE0F+13j
		cmp	[ebp+arg_8], 0C7h
		jbe	short loc_40CE61
		mov	dword ptr [esp+0A8h+var_A8], 43h
		call	sub_40C94F
		jmp	locret_40CEFF
; ---------------------------------------------------------------------------

loc_40CE61:				; CODE XREF: sub_40CE0F+3Fj
		mov	[ebp+var_C], 0
		jmp	short loc_40CE9E
; ---------------------------------------------------------------------------

loc_40CE6A:				; CODE XREF: sub_40CE0F+93j
		mov	eax, [ebp+arg_4]
		movzx	eax, word ptr [eax]
		shr	ax, 8
		mov	edx, eax
		lea	eax, [ebp+var_7C]
		add	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_4]
		movzx	eax, word ptr [eax]
		mov	edx, eax
		lea	eax, [ebp+var_7C]
		add	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1
		sub	[ebp+arg_8], 1
		add	[ebp+arg_4], 2

loc_40CE9E:				; CODE XREF: sub_40CE0F+59j
		cmp	[ebp+arg_8], 0
		jnz	short loc_40CE6A
		mov	[ebp+var_10], 8
		mov	[ebp+var_14], 0Ch
		lea	eax, [ebp+var_7C]
		mov	[esp+0A8h+var_8C], eax ; void *
		mov	eax, [ebp+var_C]
		mov	[esp+0A8h+var_90], eax ; size_t
		mov	eax, [ebp+var_14]
		mov	[esp+0A8h+var_94], eax ; int
		mov	eax, [ebp+var_10]
		mov	[esp+0A8h+var_98], eax ; int
		mov	[esp+0A8h+var_9C], 0A4h	; int
		mov	dword ptr [esp+0A8h+var_A0], 0 ; char
		mov	[esp+0A8h+var_A4], 0 ; int
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+0A8h+var_A8], eax ; char
		call	sub_40C0DF
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	dword ptr [esp+0A8h+var_A8], eax
		call	sub_40C97F

locret_40CEFF:				; CODE XREF: sub_40CE0F+33j
					; sub_40CE0F+4Dj
		leave
		retn
sub_40CE0F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_40CF13
		cmp	dword ptr [ebp+14h], 0
		jnz	short loc_40CF24

loc_40CF13:				; CODE XREF: .text:0040CF0Bj
		mov	dword ptr [esp], 37h
		call	sub_40C94F
		jmp	locret_40CFCB
; ---------------------------------------------------------------------------

loc_40CF24:				; CODE XREF: .text:0040CF11j
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_40CF43
		mov	eax, 1
		jmp	short loc_40CF48
; ---------------------------------------------------------------------------

loc_40CF43:				; CODE XREF: .text:0040CF3Aj
		mov	eax, 2

loc_40CF48:				; CODE XREF: .text:0040CF41j
		mov	edx, [ebp+14h]
		mov	[esp+24h], edx
		mov	edx, [ebp+10h]
		mov	[esp+20h], edx
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+18h], 0FFFFFFFFh
		mov	dword ptr [esp+14h], 0
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0AAh
		mov	dword ptr [esp+8], 80h
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40C07D
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 9000h
		jz	short loc_40CFC0
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		mov	[esp], eax
		call	gcry_free
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0

loc_40CFC0:				; CODE XREF: .text:0040CF9Fj
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_40C97F

locret_40CFCB:				; CODE XREF: .text:0040CF1Fj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40CFCD(char, void *, size_t, int, int, int)
sub_40CFCD	proc near		; CODE XREF: sub_41C124+39p

var_38		= byte ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_10], 0
		jz	short loc_40CFDF
		cmp	[ebp+arg_14], 0
		jnz	short loc_40CFF0

loc_40CFDF:				; CODE XREF: sub_40CFCD+Aj
		mov	dword ptr [esp+38h+var_38], 37h
		call	sub_40C94F
		jmp	locret_40D0D5
; ---------------------------------------------------------------------------

loc_40CFF0:				; CODE XREF: sub_40CFCD+10j
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+var_20], eax ;	int
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_24], eax ;	int
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_28], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_2C], eax ;	size_t
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_30], eax ;	void *
		mov	[esp+38h+var_34], 0 ; int
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+38h+var_38], eax	; char
		call	sub_40C143
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40D0A2
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	eax, 1
		ja	short loc_40D054
		mov	[ebp+var_C], 1000Bh
		jmp	short loc_40D0A2
; ---------------------------------------------------------------------------

loc_40D054:				; CODE XREF: sub_40CFCD+7Cj
		mov	eax, [ebp+arg_10]
		mov	edx, [eax]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		sub	eax, 2
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	ecx, eax
		shl	ecx, 8
		mov	eax, [ebp+arg_10]
		mov	edx, [eax]
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		sub	eax, 1
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_14]
		mov	[eax], edx

loc_40D0A2:				; CODE XREF: sub_40CFCD+72j
					; sub_40CFCD+85j
		cmp	[ebp+var_C], 9000h
		jz	short loc_40D0CA
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	dword ptr [esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0

loc_40D0CA:				; CODE XREF: sub_40CFCD+DCj
		mov	eax, [ebp+var_C]
		mov	dword ptr [esp+38h+var_38], eax
		call	sub_40C97F

locret_40D0D5:				; CODE XREF: sub_40CFCD+1Ej
		leave
		retn
sub_40CFCD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D0D7	proc near		; CODE XREF: sub_41327A+1EBp
					; sub_413993+C2p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40B169
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_40CCC9
		leave
		retn
sub_40D0D7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D106	proc near		; CODE XREF: sub_41327A+2A0p
					; sub_413993+16Bp ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_24], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_28], eax
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], 20h
		mov	[esp+38h+var_34], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_40B217
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_40C97F
		leave
		retn
sub_40D106	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D14D(char, int, void *, size_t)
sub_40D14D	proc near		; CODE XREF: sub_41327A+B6p
					; sub_41327A+40Fp ...

var_38		= byte ptr -38h
var_34		= dword	ptr -34h
var_30		= byte ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+var_1C], edx ;	void *
		mov	[esp+38h+var_20], eax ;	size_t
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_24], eax ;	int
		mov	[esp+38h+var_28], 0 ; int
		mov	[esp+38h+var_2C], 20h ;	int
		mov	dword ptr [esp+38h+var_30], 0 ;	char
		mov	[esp+38h+var_34], 0 ; int
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+38h+var_38], eax	; char
		call	sub_40C0DF
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	dword ptr [esp+38h+var_38], eax
		call	sub_40C97F
		leave
		retn
sub_40D14D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D1A3	proc near		; CODE XREF: sub_414024+A90p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_8], 0
		setnz	al
		movzx	eax, al
		mov	edx, [ebp+arg_C]
		mov	[esp+38h+var_24], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+38h+var_28], edx
		mov	[esp+38h+var_2C], eax
		mov	[esp+38h+var_30], 24h
		mov	[esp+38h+var_34], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_40B2C9
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_40C97F
		leave
		retn
sub_40D1A3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D1F0(char, int, void *, size_t, void *, size_t)
sub_40D1F0	proc near		; CODE XREF: sub_414024+8F8p
					; sub_414024+95Bp ...

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_8], 0
		jnz	short loc_40D202
		cmp	[ebp+arg_C], 0
		jnz	short loc_40D21A

loc_40D202:				; CODE XREF: sub_40D1F0+Aj
		cmp	[ebp+arg_8], 0
		jz	short loc_40D20E
		cmp	[ebp+arg_C], 0
		jz	short loc_40D21A

loc_40D20E:				; CODE XREF: sub_40D1F0+16j
		cmp	[ebp+arg_10], 0
		jz	short loc_40D21A
		cmp	[ebp+arg_14], 0
		jnz	short loc_40D22B

loc_40D21A:				; CODE XREF: sub_40D1F0+10j
					; sub_40D1F0+1Cj ...
		mov	[esp+38h+Dst], 37h
		call	sub_40C94F
		jmp	locret_40D303
; ---------------------------------------------------------------------------

loc_40D22B:				; CODE XREF: sub_40D1F0+28j
		mov	eax, [ebp+arg_14]
		mov	edx, [ebp+arg_C]
		add	eax, edx
		mov	[esp+38h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40D262
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+38h+Dst], eax
		call	gpg_err_code_from_errno
		mov	[esp+38h+Dst], eax
		call	sub_40C94F
		jmp	locret_40D303
; ---------------------------------------------------------------------------

loc_40D262:				; CODE XREF: sub_40D1F0+52j
		cmp	[ebp+arg_C], 0
		jz	short loc_40D281
		mov	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+arg_C]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy

loc_40D281:				; CODE XREF: sub_40D1F0+76j
		mov	edx, [ebp+arg_10]
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_C]
		mov	ecx, [ebp+arg_14]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_14]
		mov	edx, [ebp+arg_C]
		add	eax, edx
		mov	edx, eax
		cmp	[ebp+arg_C], 0
		setz	al
		movzx	eax, al
		mov	ecx, [ebp+var_C]
		mov	[esp+38h+var_1C], ecx ;	void *
		mov	[esp+38h+var_20], edx ;	size_t
		mov	edx, [ebp+arg_4]
		mov	[esp+38h+var_24], edx ;	int
		mov	[esp+38h+var_28], eax ;	int
		mov	[esp+38h+var_2C], 24h ;	int
		mov	[esp+38h+Size],	0 ; char
		mov	[esp+38h+Src], 0 ; int
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+38h+Dst], eax ; char
		call	sub_40C0DF
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax
		call	sub_40C97F

locret_40D303:				; CODE XREF: sub_40D1F0+36j
					; sub_40D1F0+6Dj
		leave
		retn
sub_40D1F0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D305(char, int, void *, size_t)
sub_40D305	proc near		; CODE XREF: sub_414024+6ACp
					; sub_41BC8F+379p

var_38		= byte ptr -38h
var_34		= dword	ptr -34h
var_30		= byte ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_8], 0
		jz	short loc_40D317
		cmp	[ebp+arg_C], 0
		jnz	short loc_40D325

loc_40D317:				; CODE XREF: sub_40D305+Aj
		mov	dword ptr [esp+38h+var_38], 37h
		call	sub_40C94F
		jmp	short locret_40D373
; ---------------------------------------------------------------------------

loc_40D325:				; CODE XREF: sub_40D305+10j
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+var_1C], edx ;	void *
		mov	[esp+38h+var_20], eax ;	size_t
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_24], eax ;	int
		mov	[esp+38h+var_28], 0 ; int
		mov	[esp+38h+var_2C], 2Ch ;	int
		mov	dword ptr [esp+38h+var_30], 0 ;	char
		mov	[esp+38h+var_34], 0 ; int
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+38h+var_38], eax	; char
		call	sub_40C0DF
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	dword ptr [esp+38h+var_38], eax
		call	sub_40C97F

locret_40D373:				; CODE XREF: sub_40D305+1Ej
		leave
		retn
sub_40D305	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D375(char, int, void *, size_t)
sub_40D375	proc near		; CODE XREF: sub_414024+80Dp
					; sub_414024+875p

var_38		= byte ptr -38h
var_34		= dword	ptr -34h
var_30		= byte ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+var_1C], edx ;	void *
		mov	[esp+38h+var_20], eax ;	size_t
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_24], eax ;	int
		mov	[esp+38h+var_28], 2 ; int
		mov	[esp+38h+var_2C], 2Ch ;	int
		mov	dword ptr [esp+38h+var_30], 0 ;	char
		mov	[esp+38h+var_34], 0 ; int
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+38h+var_38], eax	; char
		call	sub_40C0DF
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	dword ptr [esp+38h+var_38], eax
		call	sub_40C97F
		leave
		retn
sub_40D375	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D3CB	proc near		; CODE XREF: sub_4102D7+122p
					; sub_41075F+110p ...

var_48		= byte ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		cmp	[ebp+arg_C], 0
		jz	short loc_40D3DD
		cmp	[ebp+arg_10], 0
		jnz	short loc_40D3EE

loc_40D3DD:				; CODE XREF: sub_40D3CB+Aj
		mov	dword ptr [esp+48h+var_48], 37h
		call	sub_40C94F
		jmp	locret_40D4C8
; ---------------------------------------------------------------------------

loc_40D3EE:				; CODE XREF: sub_40D3CB+10j
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_4], 0
		jle	short loc_40D418
		cmp	[ebp+arg_4], 0FFh
		jg	short loc_40D418
		mov	[ebp+var_C], 0FFFEh
		jmp	short loc_40D42D
; ---------------------------------------------------------------------------

loc_40D418:				; CODE XREF: sub_40D3CB+39j
					; sub_40D3CB+42j
		cmp	[ebp+arg_4], 0
		jle	short loc_40D426
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		jmp	short loc_40D42D
; ---------------------------------------------------------------------------

loc_40D426:				; CODE XREF: sub_40D3CB+51j
		mov	[ebp+var_C], 100h

loc_40D42D:				; CODE XREF: sub_40D3CB+4Bj
					; sub_40D3CB+59j
		mov	eax, [ebp+arg_8]
		movzx	ecx, al
		mov	eax, [ebp+arg_8]
		sar	eax, 8
		movzx	edx, al
		mov	eax, [ebp+arg_10]
		mov	[esp+48h+var_20], eax ;	int
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+var_24], eax ;	int
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_28], eax ;	int
		mov	[esp+48h+var_2C], 0 ; void *
		mov	[esp+48h+var_30], 0FFFFFFFFh ; size_t
		mov	[esp+48h+var_34], ecx ;	int
		mov	[esp+48h+var_38], edx ;	int
		mov	[esp+48h+var_3C], 0CAh ; int
		mov	dword ptr [esp+48h+var_40], 0 ;	char
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax ;	int
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+48h+var_48], eax	; char
		call	sub_40C01C
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 9000h
		jz	short loc_40D4C3
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		mov	dword ptr [esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_10]
		mov	dword ptr [esp+48h+var_48], eax
		call	sub_40C97F
		jmp	short locret_40D4C8
; ---------------------------------------------------------------------------

loc_40D4C3:				; CODE XREF: sub_40D3CB+CAj
		mov	eax, 0

locret_40D4C8:				; CODE XREF: sub_40D3CB+1Ej
					; sub_40D3CB+F6j
		leave
		retn
sub_40D3CB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D4CA(char, int, int, void *, size_t)
sub_40D4CA	proc near		; CODE XREF: sub_4112C8+233p
					; sub_4112C8+2C1p ...

var_38		= byte ptr -38h
var_34		= dword	ptr -34h
var_30		= byte ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+arg_8]
		movzx	ebx, dl
		mov	edx, [ebp+arg_8]
		sar	edx, 8
		movzx	ecx, dl
		mov	edx, [ebp+arg_C]
		mov	[esp+38h+var_1C], edx ;	void *
		mov	[esp+38h+var_20], eax ;	size_t
		mov	[esp+38h+var_24], ebx ;	int
		mov	[esp+38h+var_28], ecx ;	int
		mov	[esp+38h+var_2C], 0DAh ; int
		mov	dword ptr [esp+38h+var_30], 0 ;	char
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax ;	int
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+38h+var_38], eax	; char
		call	sub_40C0DF
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	dword ptr [esp+38h+var_38], eax
		call	sub_40C97F
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_40D4CA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D52C(char, int, int, void *, size_t)
sub_40D52C	proc near		; CODE XREF: sub_415770+E42p

var_38		= byte ptr -38h
var_34		= dword	ptr -34h
var_30		= byte ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+arg_8]
		movzx	ebx, dl
		mov	edx, [ebp+arg_8]
		sar	edx, 8
		movzx	ecx, dl
		mov	edx, [ebp+arg_C]
		mov	[esp+38h+var_1C], edx ;	void *
		mov	[esp+38h+var_20], eax ;	size_t
		mov	[esp+38h+var_24], ebx ;	int
		mov	[esp+38h+var_28], ecx ;	int
		mov	[esp+38h+var_2C], 0DBh ; int
		mov	dword ptr [esp+38h+var_30], 0 ;	char
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax ;	int
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+38h+var_38], eax	; char
		call	sub_40C0DF
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	dword ptr [esp+38h+var_38], eax
		call	sub_40C97F
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_40D52C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D58E(char, int, int, void *, size_t)
sub_40D58E	proc near		; CODE XREF: sub_41AEE6+67Fp
					; sub_41B5EF+478p ...

var_38		= byte ptr -38h
var_34		= dword	ptr -34h
var_30		= byte ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_4], 0
		js	short loc_40D5B2
		cmp	[ebp+arg_4], 0FFh
		jg	short loc_40D5B2
		cmp	[ebp+arg_8], 0
		js	short loc_40D5B2
		cmp	[ebp+arg_8], 0FFh
		jle	short loc_40D5C0

loc_40D5B2:				; CODE XREF: sub_40D58E+Aj
					; sub_40D58E+13j ...
		mov	dword ptr [esp+38h+var_38], 37h
		call	sub_40C94F
		jmp	short locret_40D61A
; ---------------------------------------------------------------------------

loc_40D5C0:				; CODE XREF: sub_40D58E+22j
		cmp	[ebp+arg_C], 0
		jz	short loc_40D5CB
		mov	eax, [ebp+arg_10]
		jmp	short loc_40D5D0
; ---------------------------------------------------------------------------

loc_40D5CB:				; CODE XREF: sub_40D58E+36j
		mov	eax, 0FFFFFFFFh

loc_40D5D0:				; CODE XREF: sub_40D58E+3Bj
		mov	edx, [ebp+arg_C]
		mov	[esp+38h+var_1C], edx ;	void *
		mov	[esp+38h+var_20], eax ;	size_t
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_24], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_28], eax ;	int
		mov	[esp+38h+var_2C], 22h ;	int
		mov	dword ptr [esp+38h+var_30], 0 ;	char
		mov	[esp+38h+var_34], 0 ; int
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+38h+var_38], eax	; char
		call	sub_40C0DF
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	dword ptr [esp+38h+var_38], eax
		call	sub_40C97F

locret_40D61A:				; CODE XREF: sub_40D58E+30j
		leave
		retn
sub_40D58E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D61C(char, int, void *, size_t, int, int, int)
sub_40D61C	proc near		; CODE XREF: sub_4170F2+B0Dp
					; sub_41AEE6+6F4p ...

var_48		= byte ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		cmp	[ebp+arg_8], 0
		jz	short loc_40D63A
		cmp	[ebp+arg_C], 0
		jz	short loc_40D63A
		cmp	[ebp+arg_14], 0
		jz	short loc_40D63A
		cmp	[ebp+arg_18], 0
		jnz	short loc_40D64B

loc_40D63A:				; CODE XREF: sub_40D61C+Aj
					; sub_40D61C+10j ...
		mov	dword ptr [esp+48h+var_48], 37h
		call	sub_40C94F
		jmp	locret_40D714
; ---------------------------------------------------------------------------

loc_40D64B:				; CODE XREF: sub_40D61C+1Cj
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_18]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_4], 0
		jnz	short loc_40D66C
		mov	[ebp+arg_10], 100h
		jmp	short loc_40D682
; ---------------------------------------------------------------------------

loc_40D66C:				; CODE XREF: sub_40D61C+45j
		cmp	[ebp+arg_10], 0
		js	short loc_40D682
		cmp	[ebp+arg_10], 0FFh
		jg	short loc_40D682
		mov	[ebp+arg_10], 100h

loc_40D682:				; CODE XREF: sub_40D61C+4Ej
					; sub_40D61C+54j ...
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+arg_18]
		mov	[esp+48h+var_20], edx ;	int
		mov	edx, [ebp+arg_14]
		mov	[esp+48h+var_24], edx ;	int
		mov	edx, [ebp+arg_10]
		mov	[esp+48h+var_28], edx ;	int
		mov	edx, [ebp+arg_8]
		mov	[esp+48h+var_2C], edx ;	void *
		mov	[esp+48h+var_30], eax ;	size_t
		mov	[esp+48h+var_34], 9Ah ;	int
		mov	[esp+48h+var_38], 9Eh ;	int
		mov	[esp+48h+var_3C], 2Ah ;	int
		mov	dword ptr [esp+48h+var_40], 0 ;	char
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax ;	int
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+48h+var_48], eax	; char
		call	sub_40C01C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 9000h
		jz	short loc_40D70F
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		mov	dword ptr [esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_18]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [esp+48h+var_48], eax
		call	sub_40C97F
		jmp	short locret_40D714
; ---------------------------------------------------------------------------

loc_40D70F:				; CODE XREF: sub_40D61C+C5j
		mov	eax, 0

locret_40D714:				; CODE XREF: sub_40D61C+2Aj
					; sub_40D61C+F1j
		leave
		retn
sub_40D61C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D716(char, int, void *, size_t, int, int, int, int)
sub_40D716	proc near		; CODE XREF: sub_417F4C+474p
					; sub_41B5EF+535p

Dst		= dword	ptr -48h
Src		= dword	ptr -44h
Size		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		cmp	[ebp+arg_8], 0
		jz	short loc_40D734
		cmp	[ebp+arg_C], 0
		jz	short loc_40D734
		cmp	[ebp+arg_18], 0
		jz	short loc_40D734
		cmp	[ebp+arg_1C], 0
		jnz	short loc_40D745

loc_40D734:				; CODE XREF: sub_40D716+Aj
					; sub_40D716+10j ...
		mov	[esp+48h+Dst], 37h
		call	sub_40C94F
		jmp	locret_40D8DB
; ---------------------------------------------------------------------------

loc_40D745:				; CODE XREF: sub_40D716+1Cj
		mov	eax, [ebp+arg_18]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_1C]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_4], 0
		jnz	short loc_40D766
		mov	[ebp+arg_10], 100h
		jmp	short loc_40D77C
; ---------------------------------------------------------------------------

loc_40D766:				; CODE XREF: sub_40D716+45j
		cmp	[ebp+arg_10], 0
		js	short loc_40D77C
		cmp	[ebp+arg_10], 0FFh
		jg	short loc_40D77C
		mov	[ebp+arg_10], 100h

loc_40D77C:				; CODE XREF: sub_40D716+4Ej
					; sub_40D716+54j ...
		cmp	[ebp+arg_14], 0
		js	loc_40D849
		mov	eax, [ebp+arg_C]
		add	eax, 1
		mov	[esp+48h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40D7BB
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+48h+Dst], eax
		call	gpg_err_code_from_errno
		mov	[esp+48h+Dst], eax
		call	sub_40C94F
		jmp	locret_40D8DB
; ---------------------------------------------------------------------------

loc_40D7BB:				; CODE XREF: sub_40D716+85j
		mov	eax, [ebp+arg_14]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		mov	edx, [ebp+arg_8]
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	ecx, [ebp+arg_C]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_C]
		add	eax, 1
		mov	edx, [ebp+arg_1C]
		mov	[esp+48h+var_20], edx ;	int
		mov	edx, [ebp+arg_18]
		mov	[esp+48h+var_24], edx ;	int
		mov	edx, [ebp+arg_10]
		mov	[esp+48h+var_28], edx ;	int
		mov	edx, [ebp+var_10]
		mov	[esp+48h+var_2C], edx ;	void *
		mov	[esp+48h+var_30], eax ;	size_t
		mov	[esp+48h+var_34], 86h ;	int
		mov	[esp+48h+var_38], 80h ;	int
		mov	[esp+48h+var_3C], 2Ah ;	int
		mov	[esp+48h+Size],	0 ; char
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Src], eax ; int
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+48h+Dst], eax ; char
		call	sub_40C01C
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Dst], eax
		call	gcry_free
		jmp	short loc_40D8A1
; ---------------------------------------------------------------------------

loc_40D849:				; CODE XREF: sub_40D716+6Aj
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+arg_1C]
		mov	[esp+48h+var_20], edx ;	int
		mov	edx, [ebp+arg_18]
		mov	[esp+48h+var_24], edx ;	int
		mov	edx, [ebp+arg_10]
		mov	[esp+48h+var_28], edx ;	int
		mov	edx, [ebp+arg_8]
		mov	[esp+48h+var_2C], edx ;	void *
		mov	[esp+48h+var_30], eax ;	size_t
		mov	[esp+48h+var_34], 86h ;	int
		mov	[esp+48h+var_38], 80h ;	int
		mov	[esp+48h+var_3C], 2Ah ;	int
		mov	[esp+48h+Size],	0 ; char
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Src], eax ; int
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+48h+Dst], eax ; char
		call	sub_40C01C
		mov	[ebp+var_C], eax

loc_40D8A1:				; CODE XREF: sub_40D716+131j
		cmp	[ebp+var_C], 9000h
		jz	short loc_40D8D6
		mov	eax, [ebp+arg_18]
		mov	eax, [eax]
		mov	[esp+48h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_18]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_1C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Dst], eax
		call	sub_40C97F
		jmp	short locret_40D8DB
; ---------------------------------------------------------------------------

loc_40D8D6:				; CODE XREF: sub_40D716+192j
		mov	eax, 0

locret_40D8DB:				; CODE XREF: sub_40D716+2Aj
					; sub_40D716+A0j ...
		leave
		retn
sub_40D716	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D8DD(char, int, void *, size_t, int, int, int)
sub_40D8DD	proc near		; CODE XREF: sub_417C15+325p

var_48		= byte ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		cmp	[ebp+arg_8], 0
		jz	short loc_40D8FB
		cmp	[ebp+arg_C], 0
		jz	short loc_40D8FB
		cmp	[ebp+arg_14], 0
		jz	short loc_40D8FB
		cmp	[ebp+arg_18], 0
		jnz	short loc_40D90C

loc_40D8FB:				; CODE XREF: sub_40D8DD+Aj
					; sub_40D8DD+10j ...
		mov	dword ptr [esp+48h+var_48], 37h
		call	sub_40C94F
		jmp	locret_40D9D5
; ---------------------------------------------------------------------------

loc_40D90C:				; CODE XREF: sub_40D8DD+1Cj
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_18]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_4], 0
		jnz	short loc_40D92D
		mov	[ebp+arg_10], 100h
		jmp	short loc_40D943
; ---------------------------------------------------------------------------

loc_40D92D:				; CODE XREF: sub_40D8DD+45j
		cmp	[ebp+arg_10], 0
		js	short loc_40D943
		cmp	[ebp+arg_10], 0FFh
		jg	short loc_40D943
		mov	[ebp+arg_10], 100h

loc_40D943:				; CODE XREF: sub_40D8DD+4Ej
					; sub_40D8DD+54j ...
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+arg_18]
		mov	[esp+48h+var_20], edx ;	int
		mov	edx, [ebp+arg_14]
		mov	[esp+48h+var_24], edx ;	int
		mov	edx, [ebp+arg_10]
		mov	[esp+48h+var_28], edx ;	int
		mov	edx, [ebp+arg_8]
		mov	[esp+48h+var_2C], edx ;	void *
		mov	[esp+48h+var_30], eax ;	size_t
		mov	[esp+48h+var_34], 0 ; int
		mov	[esp+48h+var_38], 0 ; int
		mov	[esp+48h+var_3C], 88h ;	int
		mov	dword ptr [esp+48h+var_40], 0 ;	char
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax ;	int
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+48h+var_48], eax	; char
		call	sub_40C01C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 9000h
		jz	short loc_40D9D0
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		mov	dword ptr [esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_18]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [esp+48h+var_48], eax
		call	sub_40C97F
		jmp	short locret_40D9D5
; ---------------------------------------------------------------------------

loc_40D9D0:				; CODE XREF: sub_40D8DD+C5j
		mov	eax, 0

locret_40D9D5:				; CODE XREF: sub_40D8DD+2Aj
					; sub_40D8DD+F1j
		leave
		retn
sub_40D8DD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40D9D7(char, int, int, void *, size_t, int, int, int)
sub_40D9D7	proc near		; CODE XREF: sub_40DAD5+3Ep
					; sub_40DB1A+3Ep

var_48		= byte ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		cmp	[ebp+arg_C], 0
		jz	short loc_40D9F6
		cmp	[ebp+arg_10], 0
		jz	short loc_40D9F6
		cmp	[ebp+arg_18], 0
		jz	short loc_40D9F6
		cmp	[ebp+arg_1C], 0
		jnz	short loc_40DA07

loc_40D9F6:				; CODE XREF: sub_40D9D7+Bj
					; sub_40D9D7+11j ...
		mov	dword ptr [esp+48h+var_48], 37h
		call	sub_40C94F
		jmp	loc_40DACF
; ---------------------------------------------------------------------------

loc_40DA07:				; CODE XREF: sub_40D9D7+1Dj
		mov	eax, [ebp+arg_18]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_1C]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_14], 0
		js	short loc_40DA28
		cmp	[ebp+arg_14], 0FFh
		jle	short loc_40DA2D

loc_40DA28:				; CODE XREF: sub_40D9D7+46j
		mov	edx, [ebp+arg_14]
		jmp	short loc_40DA32
; ---------------------------------------------------------------------------

loc_40DA2D:				; CODE XREF: sub_40D9D7+4Fj
		mov	edx, 100h

loc_40DA32:				; CODE XREF: sub_40D9D7+54j
		mov	ecx, [ebp+arg_10]
		cmp	[ebp+arg_8], 0
		jz	short loc_40DA42
		mov	eax, 81h
		jmp	short loc_40DA47
; ---------------------------------------------------------------------------

loc_40DA42:				; CODE XREF: sub_40D9D7+62j
		mov	eax, 80h

loc_40DA47:				; CODE XREF: sub_40D9D7+69j
		mov	ebx, [ebp+arg_1C]
		mov	[esp+48h+var_20], ebx ;	int
		mov	ebx, [ebp+arg_18]
		mov	[esp+48h+var_24], ebx ;	int
		mov	[esp+48h+var_28], edx ;	int
		mov	edx, [ebp+arg_C]
		mov	[esp+48h+var_2C], edx ;	void *
		mov	[esp+48h+var_30], ecx ;	size_t
		mov	[esp+48h+var_34], 0 ; int
		mov	[esp+48h+var_38], eax ;	int
		mov	[esp+48h+var_3C], 47h ;	int
		mov	dword ptr [esp+48h+var_40], 0 ;	char
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax ;	int
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+48h+var_48], eax	; char
		call	sub_40C01C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 9000h
		jz	short loc_40DACA
		mov	eax, [ebp+arg_18]
		mov	eax, [eax]
		mov	dword ptr [esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+arg_18]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_1C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [esp+48h+var_48], eax
		call	sub_40C97F
		jmp	short loc_40DACF
; ---------------------------------------------------------------------------

loc_40DACA:				; CODE XREF: sub_40D9D7+C5j
		mov	eax, 0

loc_40DACF:				; CODE XREF: sub_40D9D7+2Bj
					; sub_40D9D7+F1j
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_40D9D7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40DAD5(char, int, void *, size_t, int, int, int)
sub_40DAD5	proc near		; CODE XREF: sub_4168B1+20Fp

var_28		= byte ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_18]
		mov	[esp+28h+var_C], eax ; int
		mov	eax, [ebp+arg_14]
		mov	[esp+28h+var_10], eax ;	int
		mov	eax, [ebp+arg_10]
		mov	[esp+28h+var_14], eax ;	int
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_18], eax ;	size_t
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_1C], eax ;	void *
		mov	[esp+28h+var_20], 0 ; int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_28], eax	; char
		call	sub_40D9D7
		leave
		retn
sub_40DAD5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40DB1A(char, int, void *, size_t, int, int, int)
sub_40DB1A	proc near		; CODE XREF: sub_41257F+170p

var_28		= byte ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_18]
		mov	[esp+28h+var_C], eax ; int
		mov	eax, [ebp+arg_14]
		mov	[esp+28h+var_10], eax ;	int
		mov	eax, [ebp+arg_10]
		mov	[esp+28h+var_14], eax ;	int
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_18], eax ;	size_t
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_1C], eax ;	void *
		mov	[esp+28h+var_20], 1 ; int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_28], eax	; char
		call	sub_40D9D7
		leave
		retn
sub_40DB1A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40DB5F(char, int, void *)
sub_40DB5F	proc near		; CODE XREF: sub_40FABB+78p

Dst		= dword	ptr -48h
Src		= dword	ptr -44h
Size		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		cmp	[ebp+arg_8], 0
		jz	short loc_40DB71
		cmp	[ebp+arg_4], 0
		jg	short loc_40DB82

loc_40DB71:				; CODE XREF: sub_40DB5F+Aj
		mov	[esp+48h+Dst], 37h
		call	sub_40C94F
		jmp	locret_40DC70
; ---------------------------------------------------------------------------

loc_40DB82:				; CODE XREF: sub_40DB5F+10j
					; sub_40DB5F+106j
		mov	[ebp+var_14], 0
		mov	eax, 0FEh
		cmp	[ebp+arg_4], 0FEh
		cmovle	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		lea	edx, [ebp+var_18]
		mov	[esp+48h+var_20], edx ;	int
		lea	edx, [ebp+var_14]
		mov	[esp+48h+var_24], edx ;	int
		mov	[esp+48h+var_28], eax ;	int
		mov	[esp+48h+var_2C], 0 ; void *
		mov	[esp+48h+var_30], 0FFFFFFFFh ; size_t
		mov	[esp+48h+var_34], 0 ; int
		mov	[esp+48h+var_38], 0 ; int
		mov	[esp+48h+var_3C], 84h ;	int
		mov	[esp+48h+Size],	0 ; char
		mov	[esp+48h+Src], 0 ; int
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+48h+Dst], eax ; char
		call	sub_40C01C
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 9000h
		jz	short loc_40DC18
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Dst], eax
		call	sub_40C97F
		jmp	short locret_40DC70
; ---------------------------------------------------------------------------

loc_40DC18:				; CODE XREF: sub_40DB5F+9Fj
		mov	eax, [ebp+var_18]
		cmp	eax, [ebp+var_C]
		jbe	short loc_40DC26
		mov	eax, [ebp+var_C]
		mov	[ebp+var_18], eax

loc_40DC26:				; CODE XREF: sub_40DB5F+BFj
		mov	ecx, [ebp+var_18]
		mov	eax, [ebp+var_14]
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_18]
		add	[ebp+arg_8], eax
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_18]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+arg_4], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Dst], eax
		call	gcry_free
		cmp	[ebp+arg_4], 0
		jg	loc_40DB82
		mov	eax, 0

locret_40DC70:				; CODE XREF: sub_40DB5F+1Ej
					; sub_40DB5F+B7j
		leave
		retn
sub_40DB5F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40DC72	proc near		; CODE XREF: sub_40E65D+204p
					; sub_40FEE5+89p ...

Dst		= dword	ptr -58h
Src		= dword	ptr -54h
Size		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 54h
		cmp	[ebp+arg_8], 0
		setz	al
		movzx	eax, al
		mov	[ebp+var_10], eax
		cmp	[ebp+arg_C], 0
		jz	short loc_40DC92
		cmp	[ebp+arg_10], 0
		jnz	short loc_40DCA3

loc_40DC92:				; CODE XREF: sub_40DC72+18j
		mov	[esp+58h+Dst], 37h
		call	sub_40C94F
		jmp	loc_40DF4D
; ---------------------------------------------------------------------------

loc_40DCA3:				; CODE XREF: sub_40DC72+1Ej
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_4], 7FFFh
		jbe	short loc_40DCCF
		mov	[esp+58h+Dst], 37h
		call	sub_40C94F
		jmp	loc_40DF4D
; ---------------------------------------------------------------------------

loc_40DCCF:				; CODE XREF: sub_40DC72+4Aj
					; sub_40DC72+2BAj ...
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		cmp	[ebp+var_10], 0
		jnz	short loc_40DCE8
		mov	eax, [ebp+arg_8]
		jmp	short loc_40DCED
; ---------------------------------------------------------------------------

loc_40DCE8:				; CODE XREF: sub_40DC72+6Fj
		mov	eax, 0

loc_40DCED:				; CODE XREF: sub_40DC72+74j
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_4]
		movzx	ebx, dl
		mov	edx, [ebp+arg_4]
		shr	edx, 8
		movzx	ecx, dl
		lea	edx, [ebp+var_24]
		mov	[esp+58h+var_30], edx ;	int
		lea	edx, [ebp+var_20]
		mov	[esp+58h+var_34], edx ;	int
		mov	[esp+58h+var_38], eax ;	int
		mov	[esp+58h+var_3C], 0 ; void *
		mov	[esp+58h+var_40], 0FFFFFFFFh ; size_t
		mov	[esp+58h+var_44], ebx ;	int
		mov	[esp+58h+var_48], ecx ;	int
		mov	[esp+58h+var_4C], 0B0h ; int
		mov	[esp+58h+Size],	0 ; char
		mov	[esp+58h+Src], 0 ; int
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+58h+Dst], eax ; char
		call	sub_40C01C
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	al, 0
		cmp	eax, 6C00h
		jnz	short loc_40DDCB
		mov	eax, [ebp+var_C]
		and	eax, 0FFh
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_4]
		movzx	ebx, dl
		mov	edx, [ebp+arg_4]
		shr	edx, 8
		movzx	ecx, dl
		lea	edx, [ebp+var_24]
		mov	[esp+58h+var_30], edx ;	int
		lea	edx, [ebp+var_20]
		mov	[esp+58h+var_34], edx ;	int
		mov	[esp+58h+var_38], eax ;	int
		mov	[esp+58h+var_3C], 0 ; void *
		mov	[esp+58h+var_40], 0FFFFFFFFh ; size_t
		mov	[esp+58h+var_44], ebx ;	int
		mov	[esp+58h+var_48], ecx ;	int
		mov	[esp+58h+var_4C], 0B0h ; int
		mov	[esp+58h+Size],	0 ; char
		mov	[esp+58h+Src], 0 ; int
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+58h+Dst], eax ; char
		call	sub_40C01C
		mov	[ebp+var_C], eax

loc_40DDCB:				; CODE XREF: sub_40DC72+EAj
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40DDE1
		cmp	[ebp+var_C], 6B00h
		jz	loc_40DF44

loc_40DDE1:				; CODE XREF: sub_40DC72+160j
		cmp	[ebp+var_C], 9000h
		jz	short loc_40DE2D
		cmp	[ebp+var_C], 6282h
		jz	short loc_40DE2D
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		mov	[esp+58h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Dst], eax
		call	sub_40C97F
		jmp	loc_40DF4D
; ---------------------------------------------------------------------------

loc_40DE2D:				; CODE XREF: sub_40DC72+176j
					; sub_40DC72+17Fj
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		test	eax, eax
		jz	loc_40DEE9
		mov	eax, [ebp+arg_10]
		mov	edx, [eax]
		mov	eax, [ebp+var_24]
		add	edx, eax
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		mov	[esp+58h+Src], edx
		mov	[esp+58h+Dst], eax
		call	gcry_realloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_40DE98
		call	sub_40C96A
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		mov	[esp+58h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_1C]
		jmp	loc_40DF4D
; ---------------------------------------------------------------------------

loc_40DE98:				; CODE XREF: sub_40DC72+1EAj
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_18]
		mov	[eax], edx
		mov	ecx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		mov	edx, eax
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		mov	ebx, eax
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		add	eax, ebx
		mov	[esp+58h+Size],	ecx ; Size
		mov	[esp+58h+Src], edx ; Src
		mov	[esp+58h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_10]
		mov	edx, [eax]
		mov	eax, [ebp+var_24]
		add	edx, eax
		mov	eax, [ebp+arg_10]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Dst], eax
		call	gcry_free
		mov	[ebp+var_20], 0
		jmp	short loc_40DEF9
; ---------------------------------------------------------------------------

loc_40DEE9:				; CODE XREF: sub_40DC72+1C2j
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx

loc_40DEF9:				; CODE XREF: sub_40DC72+275j
		mov	eax, [ebp+var_24]
		add	[ebp+arg_4], eax
		cmp	[ebp+arg_4], 7FFFh
		ja	short loc_40DF47
		mov	eax, [ebp+var_24]
		cmp	[ebp+arg_8], eax
		jbe	short loc_40DF18
		mov	eax, [ebp+var_24]
		sub	[ebp+arg_8], eax
		jmp	short loc_40DF1F
; ---------------------------------------------------------------------------

loc_40DF18:				; CODE XREF: sub_40DC72+29Cj
		mov	[ebp+arg_8], 0

loc_40DF1F:				; CODE XREF: sub_40DC72+2A4j
		cmp	[ebp+var_10], 0
		jz	short loc_40DF32
		cmp	[ebp+var_C], 6282h
		jnz	loc_40DCCF

loc_40DF32:				; CODE XREF: sub_40DC72+2B1j
		cmp	[ebp+var_10], 0
		jnz	short loc_40DF48
		cmp	[ebp+arg_8], 0
		jnz	loc_40DCCF
		jmp	short loc_40DF48
; ---------------------------------------------------------------------------

loc_40DF44:				; CODE XREF: sub_40DC72+169j
		nop
		jmp	short loc_40DF48
; ---------------------------------------------------------------------------

loc_40DF47:				; CODE XREF: sub_40DC72+294j
		nop

loc_40DF48:				; CODE XREF: sub_40DC72+2C4j
					; sub_40DC72+2D0j ...
		mov	eax, 0

loc_40DF4D:				; CODE XREF: sub_40DC72+2Cj
					; sub_40DC72+58j ...
		add	esp, 54h
		pop	ebx
		pop	ebp
		retn
sub_40DC72	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40DF53	proc near		; CODE XREF: sub_4195EC+84p
					; sub_4195EC+CFp ...

var_48		= byte ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		cmp	[ebp+arg_10], 0
		jz	short loc_40DF65
		cmp	[ebp+arg_14], 0
		jnz	short loc_40DF76

loc_40DF65:				; CODE XREF: sub_40DF53+Aj
		mov	dword ptr [esp+48h+var_48], 37h
		call	sub_40C94F
		jmp	locret_40E090
; ---------------------------------------------------------------------------

loc_40DF76:				; CODE XREF: sub_40DF53+10j
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_4], 0
		js	short loc_40DFAC
		cmp	[ebp+arg_4], 0FFh
		jg	short loc_40DFAC
		cmp	[ebp+arg_8], 1
		jnz	short loc_40DFAC
		cmp	[ebp+arg_C], 0
		js	short loc_40DFAC
		cmp	[ebp+arg_C], 0FEh
		jle	short loc_40DFBD

loc_40DFAC:				; CODE XREF: sub_40DF53+39j
					; sub_40DF53+42j ...
		mov	dword ptr [esp+48h+var_48], 37h
		call	sub_40C94F
		jmp	locret_40E090
; ---------------------------------------------------------------------------

loc_40DFBD:				; CODE XREF: sub_40DF53+57j
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_C], 0
		jz	short loc_40DFD6
		mov	eax, [ebp+arg_C]
		jmp	short loc_40DFDB
; ---------------------------------------------------------------------------

loc_40DFD6:				; CODE XREF: sub_40DF53+7Cj
		mov	eax, 4

loc_40DFDB:				; CODE XREF: sub_40DF53+81j
		lea	edx, [ebp+var_14]
		mov	[esp+48h+var_20], edx ;	int
		lea	edx, [ebp+var_10]
		mov	[esp+48h+var_24], edx ;	int
		mov	[esp+48h+var_28], 0 ; int
		mov	[esp+48h+var_2C], 0 ; void *
		mov	[esp+48h+var_30], 0FFFFFFFFh ; size_t
		mov	[esp+48h+var_34], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_38], eax ;	int
		mov	[esp+48h+var_3C], 0B2h ; int
		mov	dword ptr [esp+48h+var_40], 0 ;	char
		mov	[esp+48h+var_44], 0 ; int
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+48h+var_48], eax	; char
		call	sub_40C01C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 9000h
		jz	short loc_40E07B
		cmp	[ebp+var_C], 6282h
		jz	short loc_40E07B
		mov	eax, [ebp+var_10]
		mov	dword ptr [esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	dword ptr [esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [esp+48h+var_48], eax
		call	sub_40C97F
		jmp	short locret_40E090
; ---------------------------------------------------------------------------

loc_40E07B:				; CODE XREF: sub_40DF53+E6j
					; sub_40DF53+EFj
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_14]
		mov	[eax], edx
		mov	eax, 0

locret_40E090:				; CODE XREF: sub_40DF53+1Ej
					; sub_40DF53+65j ...
		leave
		retn
sub_40DF53	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E094	proc near		; CODE XREF: sub_40E0BB+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_40E0B4
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_40E0B9
; ---------------------------------------------------------------------------

loc_40E0B4:				; CODE XREF: sub_40E094+7j
		mov	eax, 0

loc_40E0B9:				; CODE XREF: sub_40E094+1Ej
		pop	ebp
		retn
sub_40E094	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E0BB	proc near		; CODE XREF: sub_40E0E3+Ep
					; sub_40E160+29p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 6
		call	sub_40E094
		leave
		retn
sub_40E0BB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E0D6	proc near		; CODE XREF: sub_40E65D+2FEp
					; sub_40E65D+312p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_40E0D6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E0E3	proc near		; CODE XREF: sub_40E160+6Ep
					; sub_40E160+FEp ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_40E0BB
		leave
		retn
sub_40E0E3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E0F8	proc near		; DATA XREF: sub_40E160+13Ao

var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_70		= byte ptr -70h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 98h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short locret_40E15E
		mov	eax, [ebp+arg_10]
		mov	[esp+98h+var_80], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+98h+var_84], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+98h+var_88], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+98h+var_8C], eax
		mov	[esp+98h+var_90], offset aSCDD ; "%s %c	%d %d"
		mov	[esp+98h+var_94], 64h
		lea	eax, [ebp+var_70]
		mov	[esp+98h+var_98], eax
		call	sub_429C1D
		lea	eax, [ebp+var_70]
		mov	[esp+98h+var_90], eax ;	char *
		mov	[esp+98h+var_94], offset aProgress ; "PROGRESS"
		mov	eax, [ebp+var_C]
		mov	[esp+98h+var_98], eax ;	int
		call	sub_4070F7

locret_40E15E:				; CODE XREF: sub_40E0F8+13j
		leave
		retn
sub_40E0F8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E160	proc near		; CODE XREF: sub_40E4A8+22p
					; sub_40E5ED+38p ...

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+arg_0], 0
		js	short loc_40E174
		mov	eax, dword ptr [ebp+arg_0]
		cmp	eax, 9
		jbe	short loc_40E193

loc_40E174:				; CODE XREF: sub_40E160+Aj
		cmp	dword ptr [ebp+arg_0], 0
		jns	short loc_40E181
		mov	eax, 37h
		jmp	short loc_40E186
; ---------------------------------------------------------------------------

loc_40E181:				; CODE XREF: sub_40E160+18j
		mov	eax, 21h

loc_40E186:				; CODE XREF: sub_40E160+1Fj
		mov	[esp+28h+var_28], eax
		call	sub_40E0BB
		jmp	locret_40E2B2
; ---------------------------------------------------------------------------

loc_40E193:				; CODE XREF: sub_40E160+12j
		mov	edx, dword ptr [ebp+arg_0]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_451440
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_40E22E
		mov	edx, dword ptr [ebp+arg_0]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_451440
		add	eax, 4
		mov	[esp+28h+var_28], eax
		call	pth_mutex_init
		test	eax, eax
		jnz	short loc_40E1FF
		call	sub_40E0E3
		mov	[ebp+var_C], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	int
		call	strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aErrorInitial_0 ; "error initializing mutex: %s\n"
		call	sub_43CB21
		mov	eax, [ebp+var_C]
		jmp	locret_40E2B2
; ---------------------------------------------------------------------------

loc_40E1FF:				; CODE XREF: sub_40E160+6Cj
		mov	edx, dword ptr [ebp+arg_0]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_451440
		mov	dword ptr [eax], 1
		mov	edx, dword ptr [ebp+arg_0]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_451440
		mov	dword ptr [eax+8], 0

loc_40E22E:				; CODE XREF: sub_40E160+48j
		mov	edx, dword ptr [ebp+arg_0]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_451440
		add	eax, 4
		mov	[esp+28h+var_20], 0
		mov	dword ptr [esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire
		test	eax, eax
		jnz	short loc_40E293
		call	sub_40E0E3
		mov	[ebp+var_C], eax
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	int
		call	strerror
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aFailedToAcqu_1 ; "failed to acquire APP lock for slot	%d:"...
		call	sub_43CB21
		mov	eax, [ebp+var_C]
		jmp	short locret_40E2B2
; ---------------------------------------------------------------------------

loc_40E293:				; CODE XREF: sub_40E160+FCj
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_20], eax
		mov	dword ptr [esp+28h+var_24], offset sub_40E0F8
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40AC56
		mov	eax, 0

locret_40E2B2:				; CODE XREF: sub_40E160+2Ej
					; sub_40E160+9Aj ...
		leave
		retn
sub_40E160	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E2B4	proc near		; CODE XREF: sub_40E4A8+79p
					; sub_40E5ED+66p ...

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+arg_0], 0
		js	short loc_40E2DF
		mov	eax, dword ptr [ebp+arg_0]
		cmp	eax, 9
		ja	short loc_40E2DF
		mov	edx, dword ptr [ebp+arg_0]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_451440
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40E2F2

loc_40E2DF:				; CODE XREF: sub_40E2B4+Aj
					; sub_40E2B4+12j
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aUnlock_readerC ; "unlock_reader called for invalid slot %"...
		call	sub_43CB91
; ---------------------------------------------------------------------------

loc_40E2F2:				; CODE XREF: sub_40E2B4+29j
		mov	[esp+18h+var_10], 0
		mov	dword ptr [esp+18h+var_14], 0
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_40AC56
		mov	edx, dword ptr [ebp+arg_0]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_451440
		add	eax, 4
		mov	[esp+18h+var_18], eax
		call	pth_mutex_release
		test	eax, eax
		jnz	short locret_40E355
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+18h+var_18], eax ;	int
		call	strerror
		mov	[esp+18h+var_10], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aFailedToRele_1 ; "failed to release APP lock for slot	%d:"...
		call	sub_43CB21

locret_40E355:				; CODE XREF: sub_40E2B4+77j
		leave
		retn
sub_40E2B4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E357	proc near		; CODE XREF: .text:0040E3C2p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], offset aUnknownUnderW3 ; "unknown under W32"
		call	sub_43CBE8
		leave
		retn
sub_40E357	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-0Ch], 0
		jmp	loc_40E455
; ---------------------------------------------------------------------------

loc_40E37D:				; CODE XREF: .text:0040E45Bj
		mov	edx, [ebp-0Ch]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_451440
		mov	eax, [eax]
		test	eax, eax
		jz	loc_40E451
		mov	eax, [ebp-0Ch]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aApp_dump_state	; "app_dump_state: slot=%d lock="
		call	sub_43CAF7
		mov	edx, [ebp-0Ch]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_451440
		add	eax, 4
		mov	[esp], eax
		call	sub_40E357
		mov	edx, [ebp-0Ch]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_451440
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40E445
		mov	edx, [ebp-0Ch]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_451440
		mov	eax, [eax+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aAppP ;	" app=%p"
		call	sub_43CBE8
		mov	edx, [ebp-0Ch]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_451440
		mov	eax, [eax+8]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_40E445
		mov	edx, [ebp-0Ch]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_451440
		mov	eax, [eax+8]
		mov	eax, [eax+10h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aTypeS ; " type=`%s'"
		call	sub_43CBE8

loc_40E445:				; CODE XREF: .text:0040E3DDj
					; .text:0040E41Cj
		mov	dword ptr [esp], offset	asc_44A143 ; "\n"
		call	sub_43CBE8

loc_40E451:				; CODE XREF: .text:0040E392j
		add	dword ptr [ebp-0Ch], 1

loc_40E455:				; CODE XREF: .text:0040E378j
		mov	eax, [ebp-0Ch]
		cmp	eax, 9
		jbe	loc_40E37D
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40E463(char *)
sub_40E463	proc near		; CODE XREF: sub_40E65D+357p
					; sub_40E65D+398p ...

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_451D54
		mov	[ebp+var_C], eax
		jmp	short loc_40E49B
; ---------------------------------------------------------------------------

loc_40E473:				; CODE XREF: sub_40E463+3Cj
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str2],	eax ; Str2
		mov	[esp+28h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40E493
		mov	eax, 0
		jmp	short locret_40E4A6
; ---------------------------------------------------------------------------

loc_40E493:				; CODE XREF: sub_40E463+27j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_40E49B:				; CODE XREF: sub_40E463+Ej
		cmp	[ebp+var_C], 0
		jnz	short loc_40E473
		mov	eax, 1

locret_40E4A6:				; CODE XREF: sub_40E463+2Ej
		leave
		retn
sub_40E463	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E4A8	proc near		; CODE XREF: sub_4037C0+51p
					; sub_403BAA+FFp ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		js	short loc_40E528
		mov	eax, [ebp+arg_0]
		cmp	eax, 9
		ja	short loc_40E528
		mov	[esp+18h+var_14], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_40E160
		mov	edx, [ebp+arg_0]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_451440
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40E51B
		mov	edx, [ebp+arg_0]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_451440
		mov	eax, [eax+8]
		mov	[esp+18h+var_18], eax
		call	sub_40ECA4
		mov	edx, [ebp+arg_0]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_451440
		mov	dword ptr [eax+8], 0

loc_40E51B:				; CODE XREF: sub_40E4A8+3Dj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_40E2B4
		jmp	short locret_40E529
; ---------------------------------------------------------------------------

loc_40E528:				; CODE XREF: sub_40E4A8+Aj
					; sub_40E4A8+12j
		nop

locret_40E529:				; CODE XREF: sub_40E4A8+7Ej
		leave
		retn
sub_40E4A8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E52B	proc near		; CODE XREF: sub_40E5ED+58p
					; sub_40E65D+79p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	edx, [ebp+arg_0]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_451440
		mov	eax, [eax+8]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40E577
		cmp	[ebp+arg_4], 0
		jz	short loc_40E577
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_40E57E
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		mov	dword ptr [esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	sub_439F0D
		test	eax, eax
		jnz	short loc_40E57E

loc_40E577:				; CODE XREF: sub_40E52B+21j
					; sub_40E52B+27j
		mov	eax, 0
		jmp	short locret_40E5EB
; ---------------------------------------------------------------------------

loc_40E57E:				; CODE XREF: sub_40E52B+31j
					; sub_40E52B+4Aj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40E5B1
		mov	edx, [ebp+arg_0]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_451440
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_40ECA4
		mov	eax, 0
		jmp	short locret_40E5EB
; ---------------------------------------------------------------------------

loc_40E5B1:				; CODE XREF: sub_40E52B+5Aj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_40E5C3
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		jmp	short loc_40E5C8
; ---------------------------------------------------------------------------

loc_40E5C3:				; CODE XREF: sub_40E52B+8Ej
		mov	eax, offset aNull ; "<null>"

loc_40E5C8:				; CODE XREF: sub_40E52B+96j
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+var_20], edx
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aApplicationSIn ; "application	'%s' in use by reader %d - "...
		call	sub_43CAF7
		mov	[esp+28h+var_28], 46h
		call	sub_40E0BB

locret_40E5EB:				; CODE XREF: sub_40E52B+51j
					; sub_40E52B+84j
		leave
		retn
sub_40E52B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E5ED	proc near		; CODE XREF: sub_403EBF+C2p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_40E60A
		mov	eax, [ebp+var_C]
		cmp	eax, 9
		jbe	short loc_40E618

loc_40E60A:				; CODE XREF: sub_40E5ED+13j
		mov	[esp+28h+var_28], 37h
		call	sub_40E0BB
		jmp	short locret_40E65B
; ---------------------------------------------------------------------------

loc_40E618:				; CODE XREF: sub_40E5ED+1Bj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_40E160
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40E638
		mov	eax, [ebp+var_10]
		jmp	short locret_40E65B
; ---------------------------------------------------------------------------

loc_40E638:				; CODE XREF: sub_40E5ED+44j
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_40E52B
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_40E2B4
		mov	eax, [ebp+var_10]

locret_40E65B:				; CODE XREF: sub_40E5ED+29j
					; sub_40E5ED+49j
		leave
		retn
sub_40E5ED	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40E65D(int, int, char	*, int)
sub_40E65D	proc near		; CODE XREF: sub_403EBF+19Ap

Str1		= dword	ptr -48h
Str2		= dword	ptr -44h
Size		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
Dst		= dword	ptr -1Ch
Src		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[ebp+var_10], 0
		mov	[ebp+Dst], 0
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_8], 0
		jz	short loc_40E69E
		mov	[esp+48h+Str2],	offset Str2 ; "undefined"
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40E69E
		mov	eax, 1
		jmp	short loc_40E6A3
; ---------------------------------------------------------------------------

loc_40E69E:				; CODE XREF: sub_40E65D+21j
					; sub_40E65D+38j
		mov	eax, 0

loc_40E6A3:				; CODE XREF: sub_40E65D+3Fj
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str2],	eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str1],	eax
		call	sub_40E160
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40E6C9
		mov	eax, [ebp+var_C]
		jmp	locret_40EBA6
; ---------------------------------------------------------------------------

loc_40E6C9:				; CODE XREF: sub_40E65D+62j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Str2],	eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str1],	eax
		call	sub_40E52B
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40E6F7
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str1],	eax
		call	sub_40E2B4
		mov	eax, [ebp+var_C]
		jmp	locret_40EBA6
; ---------------------------------------------------------------------------

loc_40E6F7:				; CODE XREF: sub_40E65D+85j
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_451440
		mov	eax, [eax+8]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40E76F
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		cmp	eax, [ebp+arg_4]
		jz	short loc_40E73C
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_4]
		mov	[esp+48h+Size],	edx
		mov	[esp+48h+Str2],	eax ; char
		mov	[esp+48h+Str1],	offset aSlotMismatchDD ; "slot mismatch	%d/%d\n"
		call	sub_43CB91
; ---------------------------------------------------------------------------

loc_40E73C:				; CODE XREF: sub_40E65D+C0j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str1],	eax
		call	sub_40E2B4
		mov	eax, 0
		jmp	locret_40EBA6
; ---------------------------------------------------------------------------

loc_40E76F:				; CODE XREF: sub_40E65D+B5j
		mov	[esp+48h+Str2],	58h
		mov	[esp+48h+Str1],	1
		call	gcry_calloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40E7C2
		call	sub_40E0E3
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str1],	eax
		call	gpg_strerror
		mov	[esp+48h+Str2],	eax ; char
		mov	[esp+48h+Str1],	offset aErrorAllocat_2 ; "error	allocating context: %s\n"
		call	sub_43CAF7
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str1],	eax
		call	sub_40E2B4
		mov	eax, [ebp+var_C]
		jmp	locret_40EBA6
; ---------------------------------------------------------------------------

loc_40E7C2:				; CODE XREF: sub_40E65D+12Dj
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		cmp	[ebp+var_14], 0
		jnz	loc_40E955
		mov	[esp+48h+var_38], 0
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+Size],	1
		mov	[esp+48h+Str2],	3F00h
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str1],	eax
		call	sub_40CD52
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40E837
		mov	[esp+48h+var_38], 0
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+Size],	0
		mov	[esp+48h+Str2],	2F02h
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str1],	eax
		call	sub_40CD52
		mov	[ebp+var_C], eax

loc_40E837:				; CODE XREF: sub_40E65D+1AAj
		cmp	[ebp+var_C], 0
		jnz	short loc_40E869
		lea	eax, [ebp+var_20]
		mov	[esp+48h+var_38], eax
		lea	eax, [ebp+Dst]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+Size],	0
		mov	[esp+48h+Str2],	0
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str1],	eax
		call	sub_40DC72
		mov	[ebp+var_C], eax

loc_40E869:				; CODE XREF: sub_40E65D+1DEj
		cmp	[ebp+var_C], 0
		jnz	loc_40E955
		mov	edx, dword ptr [ebp+var_20]
		mov	eax, [ebp+Dst]
		lea	ecx, [ebp+var_24]
		mov	[esp+48h+var_3C], ecx
		mov	[esp+48h+Size],	5Ah
		mov	[esp+48h+Str2],	edx ; char
		mov	[esp+48h+Str1],	eax
		call	sub_42D3FC
		mov	[ebp+Src], eax
		cmp	[ebp+Src], 0
		jz	short loc_40E8B5
		mov	eax, [ebp+Dst]
		mov	edx, eax
		mov	eax, [ebp+Src]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, dword ptr [ebp+var_20]
		add	eax, edx
		mov	dword ptr [ebp+var_20],	eax

loc_40E8B5:				; CODE XREF: sub_40E65D+23Ej
		cmp	[ebp+Src], 0
		jz	short loc_40E8EF
		mov	edx, [ebp+var_24]
		mov	eax, dword ptr [ebp+var_20]
		cmp	edx, eax
		jbe	short loc_40E8EF
		mov	eax, [ebp+var_24]
		cmp	eax, 0Dh
		jnz	short loc_40E8EF
		mov	eax, dword ptr [ebp+var_20]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_24]
		cmp	edx, eax
		jnz	short loc_40E8EF
		mov	[esp+48h+Str1],	offset aEnablingBmiTes ; "enabling BMI testcard	workaround\n"
		call	sub_43CAF7
		mov	eax, [ebp+var_24]
		sub	eax, 1
		mov	[ebp+var_24], eax

loc_40E8EF:				; CODE XREF: sub_40E65D+25Cj
					; sub_40E65D+266j ...
		cmp	[ebp+Src], 0
		jz	short loc_40E943
		mov	edx, [ebp+var_24]
		mov	eax, dword ptr [ebp+var_20]
		cmp	edx, eax
		ja	short loc_40E943
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+Dst]
		mov	[esp+48h+Size],	edx ; Size
		mov	edx, [ebp+Src]
		mov	[esp+48h+Str2],	edx ; Src
		mov	[esp+48h+Str1],	eax ; Dst
		call	memmove
		mov	edx, [ebp+Dst]
		mov	eax, [ebp+var_10]
		mov	[eax+8], edx
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_10]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str1],	eax
		call	sub_40EDA0
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40E94E
		jmp	loc_40EB07
; ---------------------------------------------------------------------------

loc_40E943:				; CODE XREF: sub_40E65D+296j
					; sub_40E65D+2A0j
		mov	eax, [ebp+Dst]
		mov	[esp+48h+Str1],	eax
		call	gcry_free

loc_40E94E:				; CODE XREF: sub_40E65D+2DFj
		mov	[ebp+Dst], 0

loc_40E955:				; CODE XREF: sub_40E65D+172j
					; sub_40E65D+210j
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str1],	eax
		call	sub_40E0D6
		cmp	eax, 70h
		jz	loc_40EB07
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str1],	eax
		call	sub_40E0D6
		cmp	eax, 8050h
		jz	loc_40EB07
		cmp	[ebp+var_14], 0
		jz	short loc_40E998
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+10h], offset aUndefined_0 ; "UNDEFINED"
		mov	[ebp+var_C], 0
		jmp	short loc_40E9A7
; ---------------------------------------------------------------------------

loc_40E998:				; CODE XREF: sub_40E65D+326j
		mov	[esp+48h+Str1],	1Bh
		call	sub_40E0BB
		mov	[ebp+var_C], eax

loc_40E9A7:				; CODE XREF: sub_40E65D+339j
		cmp	[ebp+var_C], 0
		jz	short loc_40E9E8
		mov	[esp+48h+Str1],	offset aOpenpgp	; "openpgp"
		call	sub_40E463
		test	eax, eax
		jz	short loc_40E9E8
		cmp	[ebp+arg_8], 0
		jz	short loc_40E9DA
		mov	[esp+48h+Str2],	offset aOpenpgp	; "openpgp"
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40E9E8

loc_40E9DA:				; CODE XREF: sub_40E65D+364j
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str1],	eax
		call	sub_418EB5
		mov	[ebp+var_C], eax

loc_40E9E8:				; CODE XREF: sub_40E65D+34Ej
					; sub_40E65D+35Ej ...
		cmp	[ebp+var_C], 0
		jz	short loc_40EA29
		mov	[esp+48h+Str1],	offset aNks ; "nks"
		call	sub_40E463
		test	eax, eax
		jz	short loc_40EA29
		cmp	[ebp+arg_8], 0
		jz	short loc_40EA1B
		mov	[esp+48h+Str2],	offset aNks ; "nks"
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40EA29

loc_40EA1B:				; CODE XREF: sub_40E65D+3A5j
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str1],	eax
		call	sub_41C3FB
		mov	[ebp+var_C], eax

loc_40EA29:				; CODE XREF: sub_40E65D+38Fj
					; sub_40E65D+39Fj ...
		cmp	[ebp+var_C], 0
		jz	short loc_40EA6A
		mov	[esp+48h+Str1],	offset aP15 ; "p15"
		call	sub_40E463
		test	eax, eax
		jz	short loc_40EA6A
		cmp	[ebp+arg_8], 0
		jz	short loc_40EA5C
		mov	[esp+48h+Str2],	offset aP15 ; "p15"
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40EA6A

loc_40EA5C:				; CODE XREF: sub_40E65D+3E6j
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str1],	eax
		call	sub_4245B2
		mov	[ebp+var_C], eax

loc_40EA6A:				; CODE XREF: sub_40E65D+3D0j
					; sub_40E65D+3E0j ...
		cmp	[ebp+var_C], 0
		jz	short loc_40EAAB
		mov	[esp+48h+Str1],	offset aGeldkarte ; "geldkarte"
		call	sub_40E463
		test	eax, eax
		jz	short loc_40EAAB
		cmp	[ebp+arg_8], 0
		jz	short loc_40EA9D
		mov	[esp+48h+Str2],	offset aGeldkarte ; "geldkarte"
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40EAAB

loc_40EA9D:				; CODE XREF: sub_40E65D+427j
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str1],	eax
		call	sub_425215
		mov	[ebp+var_C], eax

loc_40EAAB:				; CODE XREF: sub_40E65D+411j
					; sub_40E65D+421j ...
		cmp	[ebp+var_C], 0
		jz	short loc_40EAEC
		mov	[esp+48h+Str1],	offset aDinsig ; "dinsig"
		call	sub_40E463
		test	eax, eax
		jz	short loc_40EAEC
		cmp	[ebp+arg_8], 0
		jz	short loc_40EADE
		mov	[esp+48h+Str2],	offset aDinsig ; "dinsig"
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40EAEC

loc_40EADE:				; CODE XREF: sub_40E65D+468j
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str1],	eax
		call	sub_41D8DA
		mov	[ebp+var_C], eax

loc_40EAEC:				; CODE XREF: sub_40E65D+452j
					; sub_40E65D+462j ...
		cmp	[ebp+var_C], 0
		jz	short loc_40EB07
		cmp	[ebp+arg_8], 0
		jz	short loc_40EB07
		mov	[esp+48h+Str1],	3Ch
		call	sub_40E0BB
		mov	[ebp+var_C], eax

loc_40EB07:				; CODE XREF: sub_40E65D+2E1j
					; sub_40E65D+306j ...
		cmp	[ebp+var_C], 0
		jz	short loc_40EB6D
		cmp	[ebp+arg_8], 0
		jz	short loc_40EB37
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str1],	eax
		call	gpg_strerror
		mov	[esp+48h+Size],	eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Str2],	eax ; char
		mov	[esp+48h+Str1],	offset aCanTSelectAppl ; "can't select application `%s': %s\n"
		call	sub_43CAF7
		jmp	short loc_40EB52
; ---------------------------------------------------------------------------

loc_40EB37:				; CODE XREF: sub_40E65D+4B4j
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str1],	eax
		call	gpg_strerror
		mov	[esp+48h+Str2],	eax ; char
		mov	[esp+48h+Str1],	offset aNoSupportedCar ; "no supported card application	found: %s"...
		call	sub_43CAF7

loc_40EB52:				; CODE XREF: sub_40E65D+4D8j
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str1],	eax
		call	sub_40E2B4
		mov	eax, [ebp+var_C]
		jmp	short locret_40EBA6
; ---------------------------------------------------------------------------

loc_40EB6D:				; CODE XREF: sub_40E65D+4AEj
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax], 1
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		lea	edx, dword_451440[eax]
		mov	eax, [ebp+var_10]
		mov	[edx+8], eax
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str1],	eax
		call	sub_40E2B4
		mov	eax, 0

locret_40EBA6:				; CODE XREF: sub_40E65D+67j
					; sub_40E65D+95j ...
		leave
		retn
sub_40E65D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EBA8	proc near		; CODE XREF: sub_406449+36Bp

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	[ebp+var_30], offset aOpenpgp ;	"openpgp"
		mov	[ebp+var_2C], offset aNks ; "nks"
		mov	[ebp+var_28], offset aP15 ; "p15"
		mov	[ebp+var_24], offset aGeldkarte	; "geldkarte"
		mov	[ebp+var_20], offset aDinsig ; "dinsig"
		mov	[ebp+var_1C], 0
		mov	[ebp+var_10], 1
		mov	[ebp+var_C], 0
		jmp	short loc_40EC19
; ---------------------------------------------------------------------------

loc_40EBE9:				; CODE XREF: sub_40EBA8+7Aj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_30]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_10]
		add	eax, 2
		mov	[ebp+var_10], eax
		add	[ebp+var_C], 1

loc_40EC19:				; CODE XREF: sub_40EBA8+3Fj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_30]
		test	eax, eax
		jnz	short loc_40EBE9
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	gcry_malloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_40EC3F
		mov	eax, 0
		jmp	short loc_40EC9E
; ---------------------------------------------------------------------------

loc_40EC3F:				; CODE XREF: sub_40EBA8+8Ej
		mov	eax, [ebp+var_18]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	short loc_40EC8A
; ---------------------------------------------------------------------------

loc_40EC4E:				; CODE XREF: sub_40EBA8+EBj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_30]
		mov	[esp+58h+var_58], eax ;	char *
		call	sub_40E463
		test	eax, eax
		jz	short loc_40EC86
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_30]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_58], eax
		call	sub_43A1E9
		mov	word ptr [eax],	0A3Ah
		mov	byte ptr [eax+2], 0
		add	eax, 2
		mov	[ebp+var_14], eax

loc_40EC86:				; CODE XREF: sub_40EBA8+B7j
		add	[ebp+var_C], 1

loc_40EC8A:				; CODE XREF: sub_40EBA8+A4j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_30]
		test	eax, eax
		jnz	short loc_40EC4E
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_18]

loc_40EC9E:				; CODE XREF: sub_40EBA8+95j
		add	esp, 54h
		pop	edi
		pop	ebp
		retn
sub_40EBA8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40ECA4	proc near		; CODE XREF: sub_40E4A8+56p
					; sub_40E52B+7Ap

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	short loc_40ECCC
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+20h]
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0

loc_40ECCC:				; CODE XREF: sub_40ECA4+Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+18h+var_18], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gcry_free
		leave
		retn
sub_40ECA4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40ECE7	proc near		; CODE XREF: sub_403BAA+52p
					; sub_403EBF+9Cp ...

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+arg_0], 0
		jz	loc_40ED9A
		mov	eax, dword ptr [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40ED0C
		mov	[esp+28h+var_28], offset aTryingToReleas ; "trying to release an already released c"...
		call	sub_43CB91
; ---------------------------------------------------------------------------

loc_40ED0C:				; CODE XREF: sub_40ECE7+17j
		mov	eax, dword ptr [ebp+arg_0]
		mov	eax, [eax]
		lea	edx, [eax-1]
		mov	eax, dword ptr [ebp+arg_0]
		mov	[eax], edx
		mov	eax, dword ptr [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40ED9D
		mov	eax, dword ptr [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[ebp+var_C], eax
		mov	dword ptr [esp+28h+var_24], 0
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_40E160
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_451440
		mov	eax, [eax+8]
		cmp	eax, dword ptr [ebp+arg_0]
		jz	short loc_40ED8D
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_40E2B4
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_451440
		mov	eax, [eax+8]
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aAppMismatchPP	; "app mismatch	%p/%p\n"
		call	sub_43CB91
; ---------------------------------------------------------------------------

loc_40ED8D:				; CODE XREF: sub_40ECE7+6Ej
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_40E2B4
		jmp	short locret_40ED9E
; ---------------------------------------------------------------------------

loc_40ED9A:				; CODE XREF: sub_40ECE7+Aj
		nop
		jmp	short locret_40ED9E
; ---------------------------------------------------------------------------

loc_40ED9D:				; CODE XREF: sub_40ECE7+39j
		nop

locret_40ED9E:				; CODE XREF: sub_40ECE7+B1j
					; sub_40ECE7+B4j
		leave
		retn
sub_40ECE7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EDA0	proc near		; CODE XREF: sub_40E65D+2D3p
					; sub_422340+6Ap ...

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_40EE4A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FFh
		jnz	loc_40EE4A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	eax, 3
		mov	[esp+28h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40EDE9
		call	sub_40E0E3
		jmp	locret_40EEAB
; ---------------------------------------------------------------------------

loc_40EDE9:				; CODE XREF: sub_40EDA0+3Dj
		mov	edx, offset byte_44A2A3
		mov	eax, [ebp+var_C]
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		movzx	edx, byte ptr [edx+2]
		mov	[eax+2], dl
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		add	eax, 3
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		lea	edx, [eax+3]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+8], edx
		jmp	short loc_40EEA6
; ---------------------------------------------------------------------------

loc_40EE4A:				; CODE XREF: sub_40EDA0+Ej
					; sub_40EDA0+1Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_40EEA6
		mov	[esp+28h+Dst], 3
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40EE70
		call	sub_40E0E3
		jmp	short locret_40EEAB
; ---------------------------------------------------------------------------

loc_40EE70:				; CODE XREF: sub_40EDA0+C7j
		mov	edx, offset word_44A2A6
		mov	eax, [ebp+var_10]
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		movzx	edx, byte ptr [edx+2]
		mov	[eax+2], dl
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+8], edx

loc_40EEA6:				; CODE XREF: sub_40EDA0+A8j
					; sub_40EDA0+B2j
		mov	eax, 0

locret_40EEAB:				; CODE XREF: sub_40EDA0+44j
					; sub_40EDA0+CEj
		leave
		retn
sub_40EDA0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EEAD	proc near		; CODE XREF: sub_4040C4+108p
					; sub_404250+76p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_40EEBF
		cmp	[ebp+arg_4], 0
		jnz	short loc_40EECD

loc_40EEBF:				; CODE XREF: sub_40EEAD+Aj
		mov	[esp+28h+var_28], 37h
		call	sub_40E0BB
		jmp	short locret_40EF3D
; ---------------------------------------------------------------------------

loc_40EECD:				; CODE XREF: sub_40EEAD+10j
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_8], 0
		jz	short loc_40EEE5
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0

loc_40EEE5:				; CODE XREF: sub_40EEAD+2Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_40EF00
		mov	[esp+28h+var_28], offset aFf7f00 ; "FF7F00"
		call	gcry_strdup
		mov	[ebp+var_C], eax
		jmp	short loc_40EF23
; ---------------------------------------------------------------------------

loc_40EF00:				; CODE XREF: sub_40EEAD+40j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	sub_42BDA4
		mov	[ebp+var_C], eax

loc_40EF23:				; CODE XREF: sub_40EEAD+51j
		cmp	[ebp+var_C], 0
		jnz	short loc_40EF30
		call	sub_40E0E3
		jmp	short locret_40EF3D
; ---------------------------------------------------------------------------

loc_40EF30:				; CODE XREF: sub_40EEAD+7Aj
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, 0

locret_40EF3D:				; CODE XREF: sub_40EEAD+1Ej
					; sub_40EEAD+81j
		leave
		retn
sub_40EEAD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EF3F	proc near		; CODE XREF: sub_404250+1EEp

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		cmp	[ebp+arg_0], 0
		jnz	short loc_40EF5D
		mov	[esp+48h+var_48], 37h
		call	sub_40E0BB
		jmp	loc_40F04C
; ---------------------------------------------------------------------------

loc_40EF5D:				; CODE XREF: sub_40EF3F+Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40EF77
		mov	[esp+48h+var_48], 7Bh
		call	sub_40E0BB
		jmp	loc_40F04C
; ---------------------------------------------------------------------------

loc_40EF77:				; CODE XREF: sub_40EF3F+25j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jnz	short loc_40EF92
		mov	[esp+48h+var_48], 7Ch
		call	sub_40E0BB
		jmp	loc_40F04C
; ---------------------------------------------------------------------------

loc_40EF92:				; CODE XREF: sub_40EF3F+40j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_40EFF9
		mov	eax, [ebp+arg_8]
		and	eax, 1
		test	eax, eax
		jnz	short loc_40EFF9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+48h+var_34], 0
		mov	[esp+48h+var_38], 0
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+var_44], offset aApptype ; "APPTYPE"
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	sub_406FDB

loc_40EFF9:				; CODE XREF: sub_40EF3F+5Bj
					; sub_40EF3F+65j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_4]
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	sub_40E160
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40F01C
		mov	eax, [ebp+var_C]
		jmp	short loc_40F04C
; ---------------------------------------------------------------------------

loc_40F01C:				; CODE XREF: sub_40EF3F+D6j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+24h]
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+48h+var_48], eax
		call	sub_40E2B4
		mov	eax, [ebp+var_C]

loc_40F04C:				; CODE XREF: sub_40EF3F+19j
					; sub_40EF3F+33j ...
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_40EF3F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F052	proc near		; CODE XREF: sub_4044A9+64p
					; sub_4045E3+109p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_40F06F
		mov	[esp+28h+var_28], 37h
		call	sub_40E0BB
		jmp	locret_40F0F9
; ---------------------------------------------------------------------------

loc_40F06F:				; CODE XREF: sub_40F052+Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40F086
		mov	[esp+28h+var_28], 7Bh
		call	sub_40E0BB
		jmp	short locret_40F0F9
; ---------------------------------------------------------------------------

loc_40F086:				; CODE XREF: sub_40F052+24j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		test	eax, eax
		jnz	short loc_40F09E
		mov	[esp+28h+var_28], 7Ch
		call	sub_40E0BB
		jmp	short locret_40F0F9
; ---------------------------------------------------------------------------

loc_40F09E:				; CODE XREF: sub_40F052+3Cj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	sub_40E160
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40F0C2
		mov	eax, [ebp+var_C]
		jmp	short locret_40F0F9
; ---------------------------------------------------------------------------

loc_40F0C2:				; CODE XREF: sub_40F052+69j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+28h]
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+28h+var_28], eax
		call	sub_40E2B4
		mov	eax, [ebp+var_C]

locret_40F0F9:				; CODE XREF: sub_40F052+18j
					; sub_40F052+32j ...
		leave
		retn
sub_40F052	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F0FB	proc near		; CODE XREF: sub_4045E3+72p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jz	short loc_40F110
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0

loc_40F110:				; CODE XREF: sub_40F0FB+Aj
		cmp	[ebp+arg_C], 0
		jz	short loc_40F11F
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0

loc_40F11F:				; CODE XREF: sub_40F0FB+19j
		cmp	[ebp+arg_0], 0
		jz	short loc_40F137
		cmp	[ebp+arg_4], 0
		jz	short loc_40F137
		cmp	[ebp+arg_8], 0
		jz	short loc_40F137
		cmp	[ebp+arg_C], 0
		jnz	short loc_40F148

loc_40F137:				; CODE XREF: sub_40F0FB+28j
					; sub_40F0FB+2Ej ...
		mov	[esp+28h+var_28], 37h
		call	sub_40E0BB
		jmp	locret_40F1D2
; ---------------------------------------------------------------------------

loc_40F148:				; CODE XREF: sub_40F0FB+3Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40F15F
		mov	[esp+28h+var_28], 7Bh
		call	sub_40E0BB
		jmp	short locret_40F1D2
; ---------------------------------------------------------------------------

loc_40F15F:				; CODE XREF: sub_40F0FB+54j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		test	eax, eax
		jnz	short loc_40F177
		mov	[esp+28h+var_28], 7Ch
		call	sub_40E0BB
		jmp	short locret_40F1D2
; ---------------------------------------------------------------------------

loc_40F177:				; CODE XREF: sub_40F0FB+6Cj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	sub_40E160
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40F19B
		mov	eax, [ebp+var_C]
		jmp	short locret_40F1D2
; ---------------------------------------------------------------------------

loc_40F19B:				; CODE XREF: sub_40F0FB+99j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+28h+var_28], eax
		call	sub_40E2B4
		mov	eax, [ebp+var_C]

locret_40F1D2:				; CODE XREF: sub_40F0FB+48j
					; sub_40F0FB+62j ...
		leave
		retn
sub_40F0FB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40F1D4(int, int, char	*)
sub_40F1D4	proc near		; CODE XREF: sub_4053F2+8Dp

Str1		= dword	ptr -48h
Str2		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		cmp	[ebp+arg_0], 0
		jz	short loc_40F1F1
		cmp	[ebp+arg_8], 0
		jz	short loc_40F1F1
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40F202

loc_40F1F1:				; CODE XREF: sub_40F1D4+Bj
					; sub_40F1D4+11j
		mov	[esp+48h+Str1],	37h
		call	sub_40E0BB
		jmp	loc_40F3B9
; ---------------------------------------------------------------------------

loc_40F202:				; CODE XREF: sub_40F1D4+1Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40F21C
		mov	[esp+48h+Str1],	7Bh
		call	sub_40E0BB
		jmp	loc_40F3B9
; ---------------------------------------------------------------------------

loc_40F21C:				; CODE XREF: sub_40F1D4+35j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_40F2A0
		cmp	[ebp+arg_8], 0
		jz	short loc_40F2A0
		mov	[esp+48h+Str2],	offset aApptype	; "APPTYPE"
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40F2A0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+48h+var_34], 0
		mov	[esp+48h+var_38], 0
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+Str2],	offset aApptype	; "APPTYPE"
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str1],	eax
		call	sub_406FDB
		mov	eax, 0
		jmp	loc_40F3B9
; ---------------------------------------------------------------------------

loc_40F2A0:				; CODE XREF: sub_40F1D4+50j
					; sub_40F1D4+56j ...
		cmp	[ebp+arg_8], 0
		jz	loc_40F34E
		mov	[esp+48h+Str2],	offset aSerialno_0 ; "SERIALNO"
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	loc_40F34E
		lea	eax, [ebp+var_18]
		mov	[esp+48h+var_40], eax
		lea	eax, [ebp+var_14]
		mov	[esp+48h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str1],	eax
		call	sub_40EEAD
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40F2EF
		mov	eax, [ebp+var_C]
		jmp	loc_40F3B9
; ---------------------------------------------------------------------------

loc_40F2EF:				; CODE XREF: sub_40F1D4+111j
		mov	eax, [ebp+var_14]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_34], 0
		mov	[esp+48h+var_38], 0
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+Str2],	offset aSerialno_0 ; "SERIALNO"
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str1],	eax
		call	sub_406FDB
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Str1],	eax
		call	gcry_free
		mov	eax, 0
		jmp	short loc_40F3B9
; ---------------------------------------------------------------------------

loc_40F34E:				; CODE XREF: sub_40F1D4+D0j
					; sub_40F1D4+EBj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		test	eax, eax
		jnz	short loc_40F366
		mov	[esp+48h+Str1],	7Ch
		call	sub_40E0BB
		jmp	short loc_40F3B9
; ---------------------------------------------------------------------------

loc_40F366:				; CODE XREF: sub_40F1D4+182j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_4]
		mov	[esp+48h+Str2],	edx
		mov	[esp+48h+Str1],	eax
		call	sub_40E160
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40F389
		mov	eax, [ebp+var_10]
		jmp	short loc_40F3B9
; ---------------------------------------------------------------------------

loc_40F389:				; CODE XREF: sub_40F1D4+1AEj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str1],	eax
		call	edx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+48h+Str1],	eax
		call	sub_40E2B4
		mov	eax, [ebp+var_10]

loc_40F3B9:				; CODE XREF: sub_40F1D4+29j
					; sub_40F1D4+43j ...
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_40F1D4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F3BF	proc near		; CODE XREF: sub_4054EA+15Ap

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_0], 0
		jz	short loc_40F3E1
		cmp	[ebp+arg_4], 0
		jz	short loc_40F3E1
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40F3E1
		cmp	[ebp+arg_10], 0
		jnz	short loc_40F3F2

loc_40F3E1:				; CODE XREF: sub_40F3BF+Aj
					; sub_40F3BF+10j ...
		mov	[esp+38h+var_38], 37h
		call	sub_40E0BB
		jmp	locret_40F48D
; ---------------------------------------------------------------------------

loc_40F3F2:				; CODE XREF: sub_40F3BF+20j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40F40C
		mov	[esp+38h+var_38], 7Bh
		call	sub_40E0BB
		jmp	locret_40F48D
; ---------------------------------------------------------------------------

loc_40F40C:				; CODE XREF: sub_40F3BF+3Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		test	eax, eax
		jnz	short loc_40F424
		mov	[esp+38h+var_38], 7Ch
		call	sub_40E0BB
		jmp	short locret_40F48D
; ---------------------------------------------------------------------------

loc_40F424:				; CODE XREF: sub_40F3BF+55j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax
		call	sub_40E160
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40F448
		mov	eax, [ebp+var_C]
		jmp	short locret_40F48D
; ---------------------------------------------------------------------------

loc_40F448:				; CODE XREF: sub_40F3BF+82j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+34h]
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+var_24], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+38h+var_38], eax
		call	sub_40E2B4
		mov	eax, [ebp+var_C]

locret_40F48D:				; CODE XREF: sub_40F3BF+2Ej
					; sub_40F3BF+48j ...
		leave
		retn
sub_40F3BF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F48F	proc near		; CODE XREF: sub_404D51+23Bp

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		cmp	[ebp+arg_0], 0
		jz	short loc_40F4B9
		cmp	[ebp+arg_14], 0
		jz	short loc_40F4B9
		cmp	[ebp+arg_18], 0
		jz	short loc_40F4B9
		cmp	[ebp+arg_1C], 0
		jz	short loc_40F4B9
		cmp	[ebp+arg_20], 0
		jz	short loc_40F4B9
		cmp	[ebp+arg_C], 0
		jnz	short loc_40F4CA

loc_40F4B9:				; CODE XREF: sub_40F48F+Aj
					; sub_40F48F+10j ...
		mov	[esp+48h+var_48], 37h
		call	sub_40E0BB
		jmp	locret_40F5A1
; ---------------------------------------------------------------------------

loc_40F4CA:				; CODE XREF: sub_40F48F+28j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40F4E4
		mov	[esp+48h+var_48], 7Bh
		call	sub_40E0BB
		jmp	locret_40F5A1
; ---------------------------------------------------------------------------

loc_40F4E4:				; CODE XREF: sub_40F48F+42j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+38h]
		test	eax, eax
		jnz	short loc_40F4FF
		mov	[esp+48h+var_48], 7Ch
		call	sub_40E0BB
		jmp	locret_40F5A1
; ---------------------------------------------------------------------------

loc_40F4FF:				; CODE XREF: sub_40F48F+5Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	dword ptr [esp+48h+var_44], 0
		mov	[esp+48h+var_48], eax
		call	sub_40E160
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40F523
		mov	eax, [ebp+var_C]
		jmp	short locret_40F5A1
; ---------------------------------------------------------------------------

loc_40F523:				; CODE XREF: sub_40F48F+8Dj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+38h]
		mov	eax, [ebp+arg_20]
		mov	[esp+48h+var_28], eax
		mov	eax, [ebp+arg_1C]
		mov	[esp+48h+var_2C], eax
		mov	eax, [ebp+arg_18]
		mov	[esp+48h+var_30], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+var_3C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+48h+var_48], eax
		call	sub_40E2B4
		mov	eax, ds:dword_451D24
		test	eax, eax
		jz	short loc_40F59E
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aOperationSignR ; "operation sign result: %s\n"
		call	sub_43CAF7

loc_40F59E:				; CODE XREF: sub_40F48F+F2j
		mov	eax, [ebp+var_C]

locret_40F5A1:				; CODE XREF: sub_40F48F+36j
					; sub_40F48F+50j ...
		leave
		retn
sub_40F48F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F5A3	proc near		; CODE XREF: sub_40505B+10Ap

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_0], 0
		jz	short loc_40F5CD
		cmp	[ebp+arg_10], 0
		jz	short loc_40F5CD
		cmp	[ebp+arg_14], 0
		jz	short loc_40F5CD
		cmp	[ebp+arg_18], 0
		jz	short loc_40F5CD
		cmp	[ebp+arg_1C], 0
		jz	short loc_40F5CD
		cmp	[ebp+arg_8], 0
		jnz	short loc_40F5DE

loc_40F5CD:				; CODE XREF: sub_40F5A3+Aj
					; sub_40F5A3+10j ...
		mov	[esp+38h+var_38], 37h
		call	sub_40E0BB
		jmp	locret_40F6AE
; ---------------------------------------------------------------------------

loc_40F5DE:				; CODE XREF: sub_40F5A3+28j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40F5F8
		mov	[esp+38h+var_38], 7Bh
		call	sub_40E0BB
		jmp	locret_40F6AE
; ---------------------------------------------------------------------------

loc_40F5F8:				; CODE XREF: sub_40F5A3+42j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		test	eax, eax
		jnz	short loc_40F613
		mov	[esp+38h+var_38], 7Ch
		call	sub_40E0BB
		jmp	locret_40F6AE
; ---------------------------------------------------------------------------

loc_40F613:				; CODE XREF: sub_40F5A3+5Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	dword ptr [esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax
		call	sub_40E160
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40F637
		mov	eax, [ebp+var_C]
		jmp	short locret_40F6AE
; ---------------------------------------------------------------------------

loc_40F637:				; CODE XREF: sub_40F5A3+8Dj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+3Ch]
		mov	eax, [ebp+arg_1C]
		mov	[esp+38h+var_1C], eax
		mov	eax, [ebp+arg_18]
		mov	[esp+38h+var_20], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+var_24], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+38h+var_38], eax
		call	sub_40E2B4
		mov	eax, ds:dword_451D24
		test	eax, eax
		jz	short loc_40F6AB
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aOperationAuthR ; "operation auth result: %s\n"
		call	sub_43CAF7

loc_40F6AB:				; CODE XREF: sub_40F5A3+EBj
		mov	eax, [ebp+var_C]

locret_40F6AE:				; CODE XREF: sub_40F5A3+36j
					; sub_40F5A3+50j ...
		leave
		retn
sub_40F5A3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F6B0	proc near		; CODE XREF: sub_405234+EFp

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_0], 0
		jz	short loc_40F6DA
		cmp	[ebp+arg_10], 0
		jz	short loc_40F6DA
		cmp	[ebp+arg_14], 0
		jz	short loc_40F6DA
		cmp	[ebp+arg_18], 0
		jz	short loc_40F6DA
		cmp	[ebp+arg_1C], 0
		jz	short loc_40F6DA
		cmp	[ebp+arg_8], 0
		jnz	short loc_40F6EB

loc_40F6DA:				; CODE XREF: sub_40F6B0+Aj
					; sub_40F6B0+10j ...
		mov	[esp+38h+var_38], 37h
		call	sub_40E0BB
		jmp	locret_40F7BB
; ---------------------------------------------------------------------------

loc_40F6EB:				; CODE XREF: sub_40F6B0+28j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40F705
		mov	[esp+38h+var_38], 7Bh
		call	sub_40E0BB
		jmp	locret_40F7BB
; ---------------------------------------------------------------------------

loc_40F705:				; CODE XREF: sub_40F6B0+42j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jnz	short loc_40F720
		mov	[esp+38h+var_38], 7Ch
		call	sub_40E0BB
		jmp	locret_40F7BB
; ---------------------------------------------------------------------------

loc_40F720:				; CODE XREF: sub_40F6B0+5Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	dword ptr [esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax
		call	sub_40E160
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40F744
		mov	eax, [ebp+var_C]
		jmp	short locret_40F7BB
; ---------------------------------------------------------------------------

loc_40F744:				; CODE XREF: sub_40F6B0+8Dj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+40h]
		mov	eax, [ebp+arg_1C]
		mov	[esp+38h+var_1C], eax
		mov	eax, [ebp+arg_18]
		mov	[esp+38h+var_20], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+var_24], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+38h+var_38], eax
		call	sub_40E2B4
		mov	eax, ds:dword_451D24
		test	eax, eax
		jz	short loc_40F7B8
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aOperationDecip ; "operation decipher result: %s\n"
		call	sub_43CAF7

loc_40F7B8:				; CODE XREF: sub_40F6B0+EBj
		mov	eax, [ebp+var_C]

locret_40F7BB:				; CODE XREF: sub_40F6B0+36j
					; sub_40F6B0+50j ...
		leave
		retn
sub_40F6B0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F7BD	proc near		; CODE XREF: sub_4056BA+1AFp

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_0], 0
		jz	short loc_40F7DF
		cmp	[ebp+arg_8], 0
		jz	short loc_40F7DF
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40F7DF
		cmp	[ebp+arg_C], 0
		jnz	short loc_40F7F0

loc_40F7DF:				; CODE XREF: sub_40F7BD+Aj
					; sub_40F7BD+10j ...
		mov	[esp+38h+var_38], 37h
		call	sub_40E0BB
		jmp	locret_40F8B8
; ---------------------------------------------------------------------------

loc_40F7F0:				; CODE XREF: sub_40F7BD+20j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40F80A
		mov	[esp+38h+var_38], 7Bh
		call	sub_40E0BB
		jmp	locret_40F8B8
; ---------------------------------------------------------------------------

loc_40F80A:				; CODE XREF: sub_40F7BD+3Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		test	eax, eax
		jnz	short loc_40F825
		mov	[esp+38h+var_38], 7Ch
		call	sub_40E0BB
		jmp	locret_40F8B8
; ---------------------------------------------------------------------------

loc_40F825:				; CODE XREF: sub_40F7BD+55j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		call	sub_40E160
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40F848
		mov	eax, [ebp+var_C]
		jmp	short locret_40F8B8
; ---------------------------------------------------------------------------

loc_40F848:				; CODE XREF: sub_40F7BD+84j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+44h]
		mov	eax, [ebp+arg_18]
		mov	[esp+38h+var_20], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+var_24], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+38h+var_38], eax
		call	sub_40E2B4
		mov	eax, ds:dword_451D24
		test	eax, eax
		jz	short loc_40F8B5
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aOperationWrite ; "operation writecert	result:	%s\n"
		call	sub_43CAF7

loc_40F8B5:				; CODE XREF: sub_40F7BD+DBj
		mov	eax, [ebp+var_C]

locret_40F8B8:				; CODE XREF: sub_40F7BD+2Ej
					; sub_40F7BD+48j ...
		leave
		retn
sub_40F7BD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F8BA	proc near		; CODE XREF: sub_4058EA+1EAp

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_0], 0
		jz	short loc_40F8DC
		cmp	[ebp+arg_8], 0
		jz	short loc_40F8DC
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40F8DC
		cmp	[ebp+arg_10], 0
		jnz	short loc_40F8ED

loc_40F8DC:				; CODE XREF: sub_40F8BA+Aj
					; sub_40F8BA+10j ...
		mov	[esp+38h+var_38], 37h
		call	sub_40E0BB
		jmp	locret_40F9BC
; ---------------------------------------------------------------------------

loc_40F8ED:				; CODE XREF: sub_40F8BA+20j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40F907
		mov	[esp+38h+var_38], 7Bh
		call	sub_40E0BB
		jmp	locret_40F9BC
; ---------------------------------------------------------------------------

loc_40F907:				; CODE XREF: sub_40F8BA+3Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+48h]
		test	eax, eax
		jnz	short loc_40F922
		mov	[esp+38h+var_38], 7Ch
		call	sub_40E0BB
		jmp	locret_40F9BC
; ---------------------------------------------------------------------------

loc_40F922:				; CODE XREF: sub_40F8BA+55j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		call	sub_40E160
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40F945
		mov	eax, [ebp+var_C]
		jmp	short locret_40F9BC
; ---------------------------------------------------------------------------

loc_40F945:				; CODE XREF: sub_40F8BA+84j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+48h]
		mov	eax, [ebp+arg_1C]
		mov	[esp+38h+var_1C], eax
		mov	eax, [ebp+arg_18]
		mov	[esp+38h+var_20], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+var_24], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+38h+var_38], eax
		call	sub_40E2B4
		mov	eax, ds:dword_451D24
		test	eax, eax
		jz	short loc_40F9B9
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aOperationWri_0 ; "operation writekey result: %s\n"
		call	sub_43CAF7

loc_40F9B9:				; CODE XREF: sub_40F8BA+E2j
		mov	eax, [ebp+var_C]

locret_40F9BC:				; CODE XREF: sub_40F8BA+2Ej
					; sub_40F8BA+48j ...
		leave
		retn
sub_40F8BA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F9BE	proc near		; CODE XREF: sub_405B59+21Bp

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_0], 0
		jz	short loc_40F9E0
		cmp	[ebp+arg_8], 0
		jz	short loc_40F9E0
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40F9E0
		cmp	[ebp+arg_14], 0
		jnz	short loc_40F9F1

loc_40F9E0:				; CODE XREF: sub_40F9BE+Aj
					; sub_40F9BE+10j ...
		mov	[esp+38h+var_38], 37h
		call	sub_40E0BB
		jmp	locret_40FAB9
; ---------------------------------------------------------------------------

loc_40F9F1:				; CODE XREF: sub_40F9BE+20j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40FA0B
		mov	[esp+38h+var_38], 7Bh
		call	sub_40E0BB
		jmp	locret_40FAB9
; ---------------------------------------------------------------------------

loc_40FA0B:				; CODE XREF: sub_40F9BE+3Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		test	eax, eax
		jnz	short loc_40FA26
		mov	[esp+38h+var_38], 7Ch
		call	sub_40E0BB
		jmp	locret_40FAB9
; ---------------------------------------------------------------------------

loc_40FA26:				; CODE XREF: sub_40F9BE+55j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		call	sub_40E160
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40FA49
		mov	eax, [ebp+var_C]
		jmp	short locret_40FAB9
; ---------------------------------------------------------------------------

loc_40FA49:				; CODE XREF: sub_40F9BE+84j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4Ch]
		mov	eax, [ebp+arg_18]
		mov	[esp+38h+var_20], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+var_24], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+38h+var_38], eax
		call	sub_40E2B4
		mov	eax, ds:dword_451D24
		test	eax, eax
		jz	short loc_40FAB6
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aOperationGenke ; "operation genkey result: %s\n"
		call	sub_43CAF7

loc_40FAB6:				; CODE XREF: sub_40F9BE+DBj
		mov	eax, [ebp+var_C]

locret_40FAB9:				; CODE XREF: sub_40F9BE+2Ej
					; sub_40F9BE+48j ...
		leave
		retn
sub_40F9BE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40FABB(int, int, void	*)
sub_40FABB	proc near		; CODE XREF: sub_405DEA+D8p

var_28		= byte ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_40FAD3
		cmp	[ebp+arg_4], 0
		jz	short loc_40FAD3
		cmp	[ebp+arg_8], 0
		jnz	short loc_40FAE1

loc_40FAD3:				; CODE XREF: sub_40FABB+Aj
					; sub_40FABB+10j
		mov	dword ptr [esp+28h+var_28], 37h
		call	sub_40E0BB
		jmp	short locret_40FB4C
; ---------------------------------------------------------------------------

loc_40FAE1:				; CODE XREF: sub_40FABB+16j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40FAF8
		mov	dword ptr [esp+28h+var_28], 7Bh
		call	sub_40E0BB
		jmp	short locret_40FB4C
; ---------------------------------------------------------------------------

loc_40FAF8:				; CODE XREF: sub_40FABB+2Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+28h+var_24], 0
		mov	dword ptr [esp+28h+var_28], eax
		call	sub_40E160
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40FB1C
		mov	eax, [ebp+var_C]
		jmp	short locret_40FB4C
; ---------------------------------------------------------------------------

loc_40FB1C:				; CODE XREF: sub_40FABB+5Aj
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+var_20], ecx ;	void *
		mov	[esp+28h+var_24], edx ;	int
		mov	dword ptr [esp+28h+var_28], eax	; char
		call	sub_40DB5F
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	dword ptr [esp+28h+var_28], eax
		call	sub_40E2B4
		mov	eax, [ebp+var_C]

locret_40FB4C:				; CODE XREF: sub_40FABB+24j
					; sub_40FABB+3Bj ...
		leave
		retn
sub_40FABB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40FB4E	proc near		; CODE XREF: sub_405F6A+1A0p

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_0], 0
		jz	short loc_40FB70
		cmp	[ebp+arg_8], 0
		jz	short loc_40FB70
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40FB70
		cmp	[ebp+arg_10], 0
		jnz	short loc_40FB81

loc_40FB70:				; CODE XREF: sub_40FB4E+Aj
					; sub_40FB4E+10j ...
		mov	[esp+38h+var_38], 37h
		call	sub_40E0BB
		jmp	locret_40FC42
; ---------------------------------------------------------------------------

loc_40FB81:				; CODE XREF: sub_40FB4E+20j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40FB9B
		mov	[esp+38h+var_38], 7Bh
		call	sub_40E0BB
		jmp	locret_40FC42
; ---------------------------------------------------------------------------

loc_40FB9B:				; CODE XREF: sub_40FB4E+3Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_40FBB6
		mov	[esp+38h+var_38], 7Ch
		call	sub_40E0BB
		jmp	locret_40FC42
; ---------------------------------------------------------------------------

loc_40FBB6:				; CODE XREF: sub_40FB4E+55j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		call	sub_40E160
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40FBD9
		mov	eax, [ebp+var_C]
		jmp	short locret_40FC42
; ---------------------------------------------------------------------------

loc_40FBD9:				; CODE XREF: sub_40FB4E+84j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+50h]
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+arg_14]
		mov	[esp+38h+var_24], edx
		mov	edx, [ebp+arg_10]
		mov	[esp+38h+var_28], edx
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+38h+var_38], eax
		call	sub_40E2B4
		mov	eax, ds:dword_451D24
		test	eax, eax
		jz	short loc_40FC3F
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aOperationChang ; "operation change_pin result: %s\n"
		call	sub_43CAF7

loc_40FC3F:				; CODE XREF: sub_40FB4E+D4j
		mov	eax, [ebp+var_C]

locret_40FC42:				; CODE XREF: sub_40FB4E+2Ej
					; sub_40FB4E+48j ...
		leave
		retn
sub_40FB4E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40FC44	proc near		; CODE XREF: sub_4061A1+E5p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_40FC66
		cmp	[ebp+arg_4], 0
		jz	short loc_40FC66
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40FC66
		cmp	[ebp+arg_8], 0
		jnz	short loc_40FC77

loc_40FC66:				; CODE XREF: sub_40FC44+Aj
					; sub_40FC44+10j ...
		mov	[esp+28h+var_28], 37h
		call	sub_40E0BB
		jmp	locret_40FD28
; ---------------------------------------------------------------------------

loc_40FC77:				; CODE XREF: sub_40FC44+20j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40FC91
		mov	[esp+28h+var_28], 7Bh
		call	sub_40E0BB
		jmp	locret_40FD28
; ---------------------------------------------------------------------------

loc_40FC91:				; CODE XREF: sub_40FC44+3Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		test	eax, eax
		jnz	short loc_40FCA9
		mov	[esp+28h+var_28], 7Ch
		call	sub_40E0BB
		jmp	short locret_40FD28
; ---------------------------------------------------------------------------

loc_40FCA9:				; CODE XREF: sub_40FC44+55j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	dword ptr [esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	sub_40E160
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40FCCD
		mov	eax, [ebp+var_C]
		jmp	short locret_40FD28
; ---------------------------------------------------------------------------

loc_40FCCD:				; CODE XREF: sub_40FC44+82j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+54h]
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+28h+var_28], eax
		call	sub_40E2B4
		mov	eax, ds:dword_451D24
		test	eax, eax
		jz	short loc_40FD25
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aOperationCheck ; "operation check_pin	result:	%s\n"
		call	sub_43CAF7

loc_40FD25:				; CODE XREF: sub_40FC44+C4j
		mov	eax, [ebp+var_C]

locret_40FD28:				; CODE XREF: sub_40FC44+2Ej
					; sub_40FC44+48j ...
		leave
		retn
sub_40FC44	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40FD2C	proc near		; CODE XREF: sub_40FD53+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_40FD4C
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_40FD51
; ---------------------------------------------------------------------------

loc_40FD4C:				; CODE XREF: sub_40FD2C+7j
		mov	eax, 0

loc_40FD51:				; CODE XREF: sub_40FD2C+1Ej
		pop	ebp
		retn
sub_40FD2C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40FD53	proc near		; CODE XREF: sub_40FDE8+21p
					; sub_40FDE8+5Ep ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 6
		call	sub_40FD2C
		leave
		retn
sub_40FD53	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40FD6E	proc near		; CODE XREF: sub_41AAB8+D7p
					; sub_41AAB8+122p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 10h
		mov	eax, [ebp+arg_4]
		shl	eax, 3
		mov	[ebp+var_8], eax
		cmp	[ebp+arg_0], 0
		jnz	short loc_40FD97
		mov	eax, 0
		jmp	short loc_40FDE2
; ---------------------------------------------------------------------------

loc_40FD8B:				; CODE XREF: sub_40FD6E+37j
		sub	[ebp+arg_4], 1
		add	[ebp+arg_0], 1
		sub	[ebp+var_8], 8

loc_40FD97:				; CODE XREF: sub_40FD6E+14j
		cmp	[ebp+arg_4], 0
		jz	short loc_40FDA7
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40FD8B

loc_40FDA7:				; CODE XREF: sub_40FD6E+2Dj
		cmp	[ebp+arg_4], 0
		jz	short loc_40FDDF
		mov	[ebp+var_C], 7
		jmp	short loc_40FDBE
; ---------------------------------------------------------------------------

loc_40FDB6:				; CODE XREF: sub_40FD6E+6Fj
		sub	[ebp+var_8], 1
		sub	[ebp+var_C], 1

loc_40FDBE:				; CODE XREF: sub_40FD6E+46j
		cmp	[ebp+var_C], 0
		jz	short loc_40FDDF
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, [ebp+var_C]
		mov	ebx, edx
		mov	ecx, eax
		sar	ebx, cl
		mov	eax, ebx
		and	eax, 1
		test	eax, eax
		jz	short loc_40FDB6

loc_40FDDF:				; CODE XREF: sub_40FD6E+3Dj
					; sub_40FD6E+54j
		mov	eax, [ebp+var_8]

loc_40FDE2:				; CODE XREF: sub_40FD6E+1Bj
		add	esp, 10h
		pop	ebx
		pop	ebp
		retn
sub_40FD6E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40FDE8	proc near		; CODE XREF: sub_41C5AB+234p
					; sub_422762+1A4p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_2C		= byte ptr -2Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	ksba_cert_get_public_key
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40FE13
		mov	[esp+48h+var_48], 3Bh
		call	sub_40FD53
		jmp	locret_40FEE3
; ---------------------------------------------------------------------------

loc_40FE13:				; CODE XREF: sub_40FDE8+18j
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+var_44], 0
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gcry_sexp_canon_len
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40FE50
		mov	[esp+48h+var_48], 53h
		call	sub_40FD53
		jmp	locret_40FEE3
; ---------------------------------------------------------------------------

loc_40FE50:				; CODE XREF: sub_40FDE8+55j
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_3C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+var_44], 0
		lea	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_sexp_sscan
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		cmp	[ebp+var_14], 0
		jz	short loc_40FE8A
		mov	eax, [ebp+var_14]
		jmp	short locret_40FEE3
; ---------------------------------------------------------------------------

loc_40FE8A:				; CODE XREF: sub_40FDE8+9Bj
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+var_2C]
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	gcry_pk_get_keygrip
		test	eax, eax
		jnz	short loc_40FEB9
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_sexp_release
		mov	[esp+48h+var_48], 1
		call	sub_40FD53
		jmp	short locret_40FEE3
; ---------------------------------------------------------------------------

loc_40FEB9:				; CODE XREF: sub_40FDE8+B6j
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_sexp_release
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+var_44], 14h
		lea	eax, [ebp+var_2C]
		mov	[esp+48h+var_48], eax
		call	sub_42BDA4
		mov	eax, 0

locret_40FEE3:				; CODE XREF: sub_40FDE8+26j
					; sub_40FDE8+63j ...
		leave
		retn
sub_40FDE8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40FEE5	proc near		; CODE XREF: sub_419DB2+CBp
					; sub_41C5AB+2Cp

var_68		= dword	ptr -68h
var_64		= byte ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= byte ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	[esp+68h+var_58], 0
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_60], 0
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+68h+var_64], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_40CD52
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40FF4A
		mov	eax, [ebp+var_C]
		mov	[esp+68h+var_68], eax
		call	gpg_strerror
		mov	[esp+68h+var_60], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+68h+var_64], eax	; char
		mov	[esp+68h+var_68], offset aErrorSelecting ; "error selecting FID	0x%04X:	%s\n"
		call	sub_43CAF7
		mov	eax, 0
		jmp	locret_41016D
; ---------------------------------------------------------------------------

loc_40FF4A:				; CODE XREF: sub_40FEE5+37j
		lea	eax, [ebp+var_1C]
		mov	[esp+68h+var_58], eax
		lea	eax, [ebp+var_14]
		mov	[esp+68h+var_5C], eax
		mov	[esp+68h+var_60], 20h
		mov	dword ptr [esp+68h+var_64], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	sub_40DC72
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40FFA8
		mov	eax, [ebp+var_C]
		mov	[esp+68h+var_68], eax
		call	gpg_strerror
		mov	[esp+68h+var_60], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+68h+var_64], eax	; char
		mov	[esp+68h+var_68], offset aErrorReadingCe ; "error reading certificate from FID 0x%0"...
		call	sub_43CAF7
		mov	eax, 0
		jmp	locret_41016D
; ---------------------------------------------------------------------------

loc_40FFA8:				; CODE XREF: sub_40FEE5+95j
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jz	short loc_40FFB9
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FFh
		jnz	short loc_40FFE1

loc_40FFB9:				; CODE XREF: sub_40FEE5+C8j
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+68h+var_64], eax	; char
		mov	[esp+68h+var_68], offset aNoCertificateC ; "no certificate contained in	FID 0x%04X\"...
		call	sub_43CAF7
		mov	eax, [ebp+var_14]
		mov	[esp+68h+var_68], eax
		call	gcry_free
		mov	eax, 0
		jmp	locret_41016D
; ---------------------------------------------------------------------------

loc_40FFE1:				; CODE XREF: sub_40FEE5+D2j
		mov	eax, [ebp+var_14]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_20], eax
		mov	[esp+68h+var_48], 6
		lea	eax, [ebp+var_38]
		mov	[esp+68h+var_4C], eax
		lea	eax, [ebp+var_34]
		mov	[esp+68h+var_50], eax
		lea	eax, [ebp+var_30]
		mov	[esp+68h+var_54], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+var_58], eax
		lea	eax, [ebp+var_28]
		mov	[esp+68h+var_5C], eax
		lea	eax, [ebp+var_24]
		mov	[esp+68h+var_60], eax
		lea	eax, [ebp+var_20]
		mov	dword ptr [esp+68h+var_64], eax
		lea	eax, [ebp+var_18]
		mov	[esp+68h+var_68], eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_410071
		mov	eax, [ebp+var_C]
		mov	[esp+68h+var_68], eax
		call	gpg_strerror
		mov	[esp+68h+var_60], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+68h+var_64], eax	; char
		mov	[esp+68h+var_68], offset aErrorParsingCe ; "error parsing certificate in FID 0x%04X"...
		call	sub_43CAF7
		mov	eax, [ebp+var_14]
		mov	[esp+68h+var_68], eax
		call	gcry_free
		mov	eax, 0
		jmp	locret_41016D
; ---------------------------------------------------------------------------

loc_410071:				; CODE XREF: sub_40FEE5+153j
		mov	eax, [ebp+var_24]
		test	eax, eax
		jnz	short loc_41008F
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jz	short loc_41008F
		mov	eax, [ebp+var_28]
		cmp	eax, 10h
		jz	short loc_4100AC
		mov	eax, [ebp+var_28]
		cmp	eax, 11h
		jz	short loc_4100AC

loc_41008F:				; CODE XREF: sub_40FEE5+191j
					; sub_40FEE5+198j
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+68h+var_64], eax	; char
		mov	[esp+68h+var_68], offset aDataAtFid0x04x ; "data at FID	0x%04X does not	look like a"...
		call	sub_43CAF7
		mov	eax, 0
		jmp	locret_41016D
; ---------------------------------------------------------------------------

loc_4100AC:				; CODE XREF: sub_40FEE5+1A0j
					; sub_40FEE5+1A8j
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_38]
		add	eax, edx
		mov	[ebp+var_10], eax
		cmp	[ebp+arg_8], 0
		jz	loc_41016A
		mov	edx, [ebp+var_38]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	[esp+68h+var_48], 6
		lea	eax, [ebp+var_38]
		mov	[esp+68h+var_4C], eax
		lea	eax, [ebp+var_34]
		mov	[esp+68h+var_50], eax
		lea	eax, [ebp+var_30]
		mov	[esp+68h+var_54], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+var_58], eax
		lea	eax, [ebp+var_28]
		mov	[esp+68h+var_5C], eax
		lea	eax, [ebp+var_24]
		mov	[esp+68h+var_60], eax
		lea	eax, [ebp+var_20]
		mov	dword ptr [esp+68h+var_64], eax
		lea	eax, [ebp+var_18]
		mov	[esp+68h+var_68], eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41011D
		mov	eax, 0
		jmp	short locret_41016D
; ---------------------------------------------------------------------------

loc_41011D:				; CODE XREF: sub_40FEE5+22Fj
		mov	eax, [ebp+var_24]
		test	eax, eax
		jnz	short loc_410161
		mov	eax, [ebp+var_28]
		cmp	eax, 6
		jnz	short loc_410161
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jnz	short loc_410161
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	ecx, [ebp+var_38]
		mov	edx, [ebp+var_34]
		add	edx, ecx
		add	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		cmp	eax, [ebp+var_10]
		jbe	short loc_41016A
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	eax, 0
		jmp	short locret_41016D
; ---------------------------------------------------------------------------

loc_410161:				; CODE XREF: sub_40FEE5+23Dj
					; sub_40FEE5+245j ...
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0

loc_41016A:				; CODE XREF: sub_40FEE5+1D6j
					; sub_40FEE5+26Aj
		mov	eax, [ebp+var_10]

locret_41016D:				; CODE XREF: sub_40FEE5+60j
					; sub_40FEE5+BEj ...
		leave
		retn
sub_40FEE5	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410170	proc near		; CODE XREF: sub_410197+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_410190
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_410195
; ---------------------------------------------------------------------------

loc_410190:				; CODE XREF: sub_410170+7j
		mov	eax, 0

loc_410195:				; CODE XREF: sub_410170+1Ej
		pop	ebp
		retn
sub_410170	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410197	proc near		; CODE XREF: sub_4101BF+Ep
					; sub_4102D7+73p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 6
		call	sub_410170
		leave
		retn
sub_410197	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4101B2	proc near		; CODE XREF: sub_410B09+72p
					; sub_4136EE+E6p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_4101B2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4101BF	proc near		; CODE XREF: sub_4112C8+66p
					; sub_412250+7Bp ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_410197
		leave
		retn
sub_4101BF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4101D4	proc near		; CODE XREF: sub_4116B8+11p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+var_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 10h
		or	edx, eax
		mov	eax, [ebp+var_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 8
		or	edx, eax
		mov	eax, [ebp+var_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, edx
		leave
		retn
sub_4101D4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410220	proc near		; CODE XREF: sub_418EB5+662p
					; DATA XREF: sub_418EB5+5CAo

var_28		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	locret_4102D5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	locret_4102D5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		jmp	short loc_410264
; ---------------------------------------------------------------------------

loc_41024B:				; CODE XREF: sub_410220+48j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		mov	[ebp+var_C], eax

loc_410264:				; CODE XREF: sub_410220+29j
		cmp	[ebp+var_C], 0
		jnz	short loc_41024B
		mov	[ebp+var_10], 0
		jmp	short loc_4102B5
; ---------------------------------------------------------------------------

loc_410273:				; CODE XREF: sub_410220+9Bj
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+var_10]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 8
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+var_10]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 4
		mov	dword ptr [eax], 0
		add	[ebp+var_10], 1

loc_4102B5:				; CODE XREF: sub_410220+51j
		mov	eax, [ebp+var_10]
		cmp	eax, 2
		jbe	short loc_410273
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0

locret_4102D5:				; CODE XREF: sub_410220+Aj
					; sub_410220+18j
		leave
		retn
sub_410220	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4102D7	proc near		; CODE XREF: sub_41075F+22Fp
					; sub_41075F+362p ...

Dst		= dword	ptr -48h
Src		= dword	ptr -44h
Size		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_10], 0
		jnz	loc_4103A4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		jmp	loc_41039A
; ---------------------------------------------------------------------------

loc_410309:				; CODE XREF: sub_4102D7+C7j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_410392
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41037D
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	[esp+48h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jnz	short loc_410354
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+48h+Dst], eax
		call	gpg_err_code_from_errno
		mov	[esp+48h+Dst], eax
		call	sub_410197
		jmp	locret_410540
; ---------------------------------------------------------------------------

loc_410354:				; CODE XREF: sub_4102D7+5Dj
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+8]
		mov	eax, [ebp+var_10]
		add	eax, 0Ch
		mov	edx, eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_41037D:				; CODE XREF: sub_4102D7+45j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, 0
		jmp	locret_410540
; ---------------------------------------------------------------------------

loc_410392:				; CODE XREF: sub_4102D7+3Bj
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[ebp+var_10], eax

loc_41039A:				; CODE XREF: sub_4102D7+2Dj
		cmp	[ebp+var_10], 0
		jnz	loc_410309

loc_4103A4:				; CODE XREF: sub_4102D7+1Cj
		cmp	[ebp+arg_14], 0
		jz	short loc_4103CD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+30h]
		and	eax, 2
		test	al, al
		jz	short loc_4103CD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+3Ch]
		movzx	eax, ax
		mov	[ebp+var_14], eax
		jmp	short loc_4103D4
; ---------------------------------------------------------------------------

loc_4103CD:				; CODE XREF: sub_4102D7+D1j
					; sub_4102D7+E2j
		mov	[ebp+var_14], 0

loc_4103D4:				; CODE XREF: sub_4102D7+F4j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_20]
		mov	[esp+48h+var_38], edx
		lea	edx, [ebp+var_1C]
		mov	[esp+48h+var_3C], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+48h+Size],	edx
		mov	edx, [ebp+var_14]
		mov	[esp+48h+Src], edx
		mov	[esp+48h+Dst], eax
		call	sub_40D3CB
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_41040F
		mov	eax, [ebp+var_18]
		jmp	locret_410540
; ---------------------------------------------------------------------------

loc_41040F:				; CODE XREF: sub_4102D7+12Ej
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		cmp	[ebp+arg_10], 0
		jz	short loc_41042F
		mov	eax, 0
		jmp	locret_410540
; ---------------------------------------------------------------------------

loc_41042F:				; CODE XREF: sub_4102D7+14Cj
		mov	[ebp+var_C], 0
		jmp	short loc_41047F
; ---------------------------------------------------------------------------

loc_410438:				; CODE XREF: sub_4102D7+1BEj
		mov	edx, [ebp+var_C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		mov	eax, [eax]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_41047B
		mov	edx, [ebp+var_C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		movzx	eax, byte ptr [eax+0Ch]
		shl	eax, 6
		sar	al, 7
		test	al, al
		jz	short loc_410499
		mov	eax, 0
		jmp	locret_410540
; ---------------------------------------------------------------------------

loc_41047B:				; CODE XREF: sub_4102D7+178j
		add	[ebp+var_C], 1

loc_41047F:				; CODE XREF: sub_4102D7+15Fj
		mov	edx, [ebp+var_C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_410438
		jmp	short loc_41049A
; ---------------------------------------------------------------------------

loc_410499:				; CODE XREF: sub_4102D7+198j
		nop

loc_41049A:				; CODE XREF: sub_4102D7+1C0j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		jmp	short loc_4104D6
; ---------------------------------------------------------------------------

loc_4104A7:				; CODE XREF: sub_4102D7+203j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_4104CE
		mov	[esp+48h+Size],	146h ; int
		mov	[esp+48h+Src], offset a____Gnupg22__2 ;	"../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+48h+Dst], offset aCTagTag ; "c->tag != tag"
		call	sub_442650

loc_4104CE:				; CODE XREF: sub_4102D7+1D9j
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[ebp+var_10], eax

loc_4104D6:				; CODE XREF: sub_4102D7+1CEj
		cmp	[ebp+var_10], 0
		jnz	short loc_4104A7
		mov	eax, [ebp+var_20]
		add	eax, 10h
		mov	[esp+48h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41053B
		mov	ecx, [ebp+var_20]
		mov	eax, [ebp+var_1C]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		add	eax, 0Ch
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_10]
		mov	[eax+8], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_41053B:				; CODE XREF: sub_4102D7+21Aj
		mov	eax, 0

locret_410540:				; CODE XREF: sub_4102D7+78j
					; sub_4102D7+B6j ...
		leave
		retn
sub_4102D7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410542	proc near		; CODE XREF: sub_410542+133p
					; sub_41069F+4Dp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	loc_41069C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_4105F7
; ---------------------------------------------------------------------------

loc_41056D:				; CODE XREF: sub_410542+B9j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_4105E9
		cmp	[ebp+var_10], 0
		jz	short loc_41058A
		mov	eax, [ebp+var_C]
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_410597
; ---------------------------------------------------------------------------

loc_41058A:				; CODE XREF: sub_410542+3Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+var_C]
		mov	edx, [edx]
		mov	[eax], edx

loc_410597:				; CODE XREF: sub_410542+46j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		jmp	short loc_4105DE
; ---------------------------------------------------------------------------

loc_4105AF:				; CODE XREF: sub_410542+A0j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_4105D6
		mov	[esp+28h+var_20], 16Ah ; int
		mov	[esp+28h+var_24], offset a____Gnupg22__2 ; "../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+28h+var_28], offset aCTagTag ; "c->tag != tag"
		call	sub_442650

loc_4105D6:				; CODE XREF: sub_410542+76j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_4105DE:				; CODE XREF: sub_410542+6Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_4105AF
		jmp	locret_41069D
; ---------------------------------------------------------------------------

loc_4105E9:				; CODE XREF: sub_410542+34j
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_4105F7:				; CODE XREF: sub_410542+26j
		cmp	[ebp+var_C], 0
		jnz	loc_41056D
		mov	[ebp+var_14], 0
		jmp	short loc_41067E
; ---------------------------------------------------------------------------

loc_41060A:				; CODE XREF: sub_410542+152j
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		mov	eax, [eax]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_41067A
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41067A
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		mov	eax, [eax+8]
		cmp	eax, [ebp+arg_4]
		jz	short loc_41067A
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		mov	eax, [eax+8]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_410542

loc_41067A:				; CODE XREF: sub_410542+DFj
					; sub_410542+F8j ...
		add	[ebp+var_14], 1

loc_41067E:				; CODE XREF: sub_410542+C6j
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_41060A
		jmp	short locret_41069D
; ---------------------------------------------------------------------------

loc_41069C:				; CODE XREF: sub_410542+Ej
		nop

locret_41069D:				; CODE XREF: sub_410542+A2j
					; sub_410542+158j
		leave
		retn
sub_410542	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41069F	proc near		; CODE XREF: sub_41327A+465p
					; sub_4136EE+138p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		jmp	short loc_4106F5
; ---------------------------------------------------------------------------

loc_4106AE:				; CODE XREF: sub_41069F+6Cj
		mov	edx, [ebp+var_C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		movzx	eax, byte ptr [eax+0Ch]
		shl	eax, 5
		sar	al, 7
		test	al, al
		jz	short loc_4106F1
		mov	edx, [ebp+var_C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		mov	eax, [eax]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_410542

loc_4106F1:				; CODE XREF: sub_41069F+2Dj
		add	[ebp+var_C], 1

loc_4106F5:				; CODE XREF: sub_41069F+Dj
		mov	edx, [ebp+var_C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4106AE
		leave
		retn
sub_41069F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41070F	proc near		; CODE XREF: sub_415465+1A6p
					; sub_4168B1+50p

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short locret_41075D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short locret_41075D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		jmp	short loc_41074B
; ---------------------------------------------------------------------------

loc_410732:				; CODE XREF: sub_41070F+40j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_41074B:				; CODE XREF: sub_41070F+21j
		cmp	[ebp+var_C], 0
		jnz	short loc_410732
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	dword ptr [eax], 0

locret_41075D:				; CODE XREF: sub_41070F+Aj
					; sub_41070F+14j
		leave
		retn
sub_41070F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41075F	proc near		; CODE XREF: sub_410EAE+74p
					; sub_41199B+4DFp ...

var_58		= dword	ptr -58h
var_54		= byte ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_2C		= byte ptr -2Ch
var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 54h
		cmp	[ebp+arg_10], 0
		jnz	short loc_410772
		lea	eax, [ebp+var_2C]
		mov	[ebp+arg_10], eax

loc_410772:				; CODE XREF: sub_41075F+Bj
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		mov	[ebp+var_10], 0
		jmp	short loc_41079A
; ---------------------------------------------------------------------------

loc_410796:				; CODE XREF: sub_41075F+6Aj
		add	[ebp+var_10], 1

loc_41079A:				; CODE XREF: sub_41075F+35j
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4107CB
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		mov	eax, [eax]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_410796

loc_4107CB:				; CODE XREF: sub_41075F+51j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 100h
		jbe	loc_4108A7
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		movzx	eax, byte ptr [eax+0Ch]
		shl	eax, 4
		sar	al, 7
		test	al, al
		jz	loc_4108A7
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		movzx	eax, byte ptr [eax+0Ch]
		shl	eax, 3
		sar	al, 7
		test	al, al
		jz	short loc_410843
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+30h]
		and	eax, 2
		test	al, al
		jz	short loc_410843
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+3Ch]
		movzx	eax, ax
		mov	[ebp+var_18], eax
		jmp	short loc_41084A
; ---------------------------------------------------------------------------

loc_410843:				; CODE XREF: sub_41075F+BFj
					; sub_41075F+D0j
		mov	[ebp+var_18], 0

loc_41084A:				; CODE XREF: sub_41075F+E2j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_24]
		mov	[esp+58h+var_48], edx
		lea	edx, [ebp+var_20]
		mov	[esp+58h+var_4C], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+58h+var_50], edx
		mov	edx, [ebp+var_18]
		mov	dword ptr [esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		call	sub_40D3CB
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41088F
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, 0
		jmp	loc_410B03
; ---------------------------------------------------------------------------

loc_41088F:				; CODE XREF: sub_41075F+11Cj
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	edx, dword ptr [ebp+var_24]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		jmp	loc_410B03
; ---------------------------------------------------------------------------

loc_4108A7:				; CODE XREF: sub_41075F+77j
					; sub_41075F+9Bj
		mov	[ebp+var_14], 0
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		mov	eax, [eax]
		test	eax, eax
		jz	loc_410A29
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		mov	eax, [eax+8]
		test	eax, eax
		jz	loc_410A29
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		movzx	eax, byte ptr [eax+0Ch]
		shl	eax, 3
		sar	al, 7
		movsx	ebx, al
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		movzx	eax, byte ptr [eax+0Ch]
		shl	eax, 6
		sar	al, 7
		test	al, al
		jnz	short loc_41094D
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		movzx	eax, byte ptr [eax+0Ch]
		shl	eax, 4
		sar	al, 7
		test	al, al
		jz	short loc_410954

loc_41094D:				; CODE XREF: sub_41075F+1CCj
		mov	edx, 1
		jmp	short loc_410959
; ---------------------------------------------------------------------------

loc_410954:				; CODE XREF: sub_41075F+1ECj
		mov	edx, 0

loc_410959:				; CODE XREF: sub_41075F+1F3j
		mov	ecx, [ebp+var_10]
		mov	eax, ecx
		shl	eax, 2
		add	eax, ecx
		shl	eax, 2
		add	eax, offset dword_4443A0
		mov	eax, [eax+8]
		mov	[esp+58h+var_44], ebx
		mov	[esp+58h+var_48], edx
		lea	edx, [ebp+var_24]
		mov	[esp+58h+var_4C], edx
		lea	edx, [ebp+var_20]
		mov	[esp+58h+var_50], edx
		mov	dword ptr [esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_4102D7
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_410A29
		mov	edx, dword ptr [ebp+var_24]
		mov	eax, [ebp+var_20]
		lea	ecx, [ebp+var_28]
		mov	[esp+58h+var_4C], ecx
		mov	ecx, [ebp+arg_4]
		mov	[esp+58h+var_50], ecx
		mov	dword ptr [esp+58h+var_54], edx	; char
		mov	[esp+58h+var_58], eax
		call	sub_42D3FC
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_4109D2
		mov	[ebp+var_14], 0
		jmp	short loc_410A29
; ---------------------------------------------------------------------------

loc_4109D2:				; CODE XREF: sub_41075F+268j
		mov	eax, [ebp+var_20]
		mov	edx, eax
		mov	eax, [ebp+var_1C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, dword ptr [ebp+var_24]
		add	edx, eax
		mov	eax, [ebp+var_28]
		cmp	edx, eax
		jnb	short loc_410A15
		mov	[esp+58h+var_58], offset aWarningConstru ; "warning: constructed DO too	short\n"
		call	sub_43CB21
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_20]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	[ebp+var_20], 0
		jmp	short loc_410A29
; ---------------------------------------------------------------------------

loc_410A15:				; CODE XREF: sub_41075F+28Dj
		mov	edx, [ebp+var_20]
		mov	ecx, [ebp+var_1C]
		mov	eax, [ebp+var_20]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	eax, edx
		mov	[ebp+var_14], eax

loc_410A29:				; CODE XREF: sub_41075F+16Cj
					; sub_41075F+189j ...
		cmp	[ebp+var_14], 0
		jnz	loc_410ADB
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		movzx	eax, byte ptr [eax+0Ch]
		shl	eax, 3
		sar	al, 7
		movsx	ecx, al
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		movzx	eax, byte ptr [eax+0Ch]
		shl	eax, 6
		sar	al, 7
		test	al, al
		jnz	short loc_410A92
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		movzx	eax, byte ptr [eax+0Ch]
		shl	eax, 4
		sar	al, 7
		test	al, al
		jz	short loc_410A99

loc_410A92:				; CODE XREF: sub_41075F+311j
		mov	eax, 1
		jmp	short loc_410A9E
; ---------------------------------------------------------------------------

loc_410A99:				; CODE XREF: sub_41075F+331j
		mov	eax, 0

loc_410A9E:				; CODE XREF: sub_41075F+338j
		mov	[esp+58h+var_44], ecx
		mov	[esp+58h+var_48], eax
		lea	eax, [ebp+var_24]
		mov	[esp+58h+var_4C], eax
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_4102D7
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_410ADB
		mov	eax, [ebp+var_20]
		mov	[ebp+var_14], eax
		mov	eax, dword ptr [ebp+var_24]
		mov	[ebp+var_28], eax

loc_410ADB:				; CODE XREF: sub_41075F+2CEj
					; sub_41075F+36Ej
		cmp	[ebp+var_C], 0
		jnz	short loc_410AF6
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		jmp	short loc_410B03
; ---------------------------------------------------------------------------

loc_410AF6:				; CODE XREF: sub_41075F+380j
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, 0

loc_410B03:				; CODE XREF: sub_41075F+12Bj
					; sub_41075F+143j ...
		add	esp, 54h
		pop	ebx
		pop	ebp
		retn
sub_41075F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410B09	proc near		; CODE XREF: sub_418EB5+5C2p

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_24		= byte ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	[ebp+var_C], 0
		jmp	loc_410E1D
; ---------------------------------------------------------------------------

loc_410B1C:				; CODE XREF: sub_410B09+32Aj
		mov	edx, [ebp+var_C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		mov	eax, [eax+8]
		test	eax, eax
		jnz	loc_410E18
		mov	edx, [ebp+var_C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		mov	eax, [eax]
		lea	edx, [ebp+var_20]
		mov	[esp+48h+var_38], edx
		lea	edx, [ebp+var_1C]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], eax
		mov	dword ptr [esp+48h+var_44], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_40D3CB
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	sub_4101B2
		cmp	eax, 44h
		jz	loc_410E04
		cmp	[ebp+var_14], 0
		jz	short loc_410BC9
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	ecx, eax
		mov	edx, [ebp+var_C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4443B0
		mov	eax, [eax]
		mov	[esp+48h+var_40], ecx
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aDoSNotAvailabl ; "DO `%s' not available: %s\n"
		call	sub_43CAF7
		jmp	loc_410E04
; ---------------------------------------------------------------------------

loc_410BC9:				; CODE XREF: sub_410B09+84j
		mov	edx, [ebp+var_C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		movzx	eax, byte ptr [eax+0Ch]
		shl	eax, 7
		sar	al, 7
		test	al, al
		jz	short loc_410C29
		mov	edx, [ebp+var_C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4443B0
		mov	eax, [eax]
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aDoS ;	"DO `%s': "
		call	sub_43CAF7
		mov	edx, dword ptr [ebp+var_20]
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], edx
		mov	dword ptr [esp+48h+var_44], eax
		mov	[esp+48h+var_48], offset byte_44A6F4
		call	sub_43CC18
		jmp	short loc_410C5D
; ---------------------------------------------------------------------------

loc_410C29:				; CODE XREF: sub_410B09+DEj
		mov	ebx, [ebp+var_1C]
		mov	eax, dword ptr [ebp+var_20]
		mov	ecx, eax
		mov	edx, [ebp+var_C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4443B0
		mov	eax, [eax]
		mov	[esp+48h+var_3C], ebx
		mov	[esp+48h+var_40], ecx
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aDoS_S	; "DO `%s': `%.*s'\n"
		call	sub_43CAF7

loc_410C5D:				; CODE XREF: sub_410B09+11Ej
		mov	edx, [ebp+var_C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		mov	eax, [eax+4]
		test	eax, eax
		jz	loc_410E04
		mov	[ebp+var_10], 0
		jmp	loc_410DE8
; ---------------------------------------------------------------------------

loc_410C86:				; CODE XREF: sub_410B09+2F5j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_C]
		jz	loc_410DE3
		mov	edx, [ebp+var_C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		mov	ecx, [eax]
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		mov	eax, [eax+8]
		cmp	ecx, eax
		jnz	loc_410DE3
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		mov	ecx, [eax]
		mov	edx, dword ptr [ebp+var_20]
		mov	eax, [ebp+var_1C]
		lea	ebx, [ebp+var_24]
		mov	[esp+48h+var_3C], ebx
		mov	[esp+48h+var_40], ecx
		mov	dword ptr [esp+48h+var_44], edx	; char
		mov	[esp+48h+var_48], eax
		call	sub_42D3FC
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	loc_410DE4
		mov	eax, [ebp+var_1C]
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, dword ptr [ebp+var_20]
		add	edx, eax
		mov	eax, dword ptr [ebp+var_24]
		cmp	edx, eax
		jnb	short loc_410D2E
		mov	[esp+48h+var_48], offset aWarningConstru ; "warning: constructed DO too	short\n"
		call	sub_43CB21
		jmp	loc_410DE4
; ---------------------------------------------------------------------------

loc_410D2E:				; CODE XREF: sub_410B09+212j
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		movzx	eax, byte ptr [eax+0Ch]
		shl	eax, 7
		sar	al, 7
		test	al, al
		jz	short loc_410DAD
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4443B0
		mov	eax, [eax]
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aDoS ;	"DO `%s': "
		call	sub_43CAF7
		mov	eax, dword ptr [ebp+var_24]
		cmp	eax, 0C8h
		jbe	short loc_410D91
		mov	eax, dword ptr [ebp+var_24]
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aU ; "[%u]\n"
		call	sub_43CAF7
		jmp	short loc_410DE4
; ---------------------------------------------------------------------------

loc_410D91:				; CODE XREF: sub_410B09+271j
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+var_18]
		mov	dword ptr [esp+48h+var_44], eax
		mov	[esp+48h+var_48], offset byte_44A6F4
		call	sub_43CC18
		jmp	short loc_410DE4
; ---------------------------------------------------------------------------

loc_410DAD:				; CODE XREF: sub_410B09+243j
		mov	eax, dword ptr [ebp+var_24]
		mov	ecx, eax
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4443B0
		mov	eax, [eax]
		mov	edx, [ebp+var_18]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], ecx
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aDoS_S	; "DO `%s': `%.*s'\n"
		call	sub_43CAF7
		jmp	short loc_410DE4
; ---------------------------------------------------------------------------

loc_410DE3:				; CODE XREF: sub_410B09+183j
					; sub_410B09+1B4j
		nop

loc_410DE4:				; CODE XREF: sub_410B09+1F2j
					; sub_410B09+220j ...
		add	[ebp+var_10], 1

loc_410DE8:				; CODE XREF: sub_410B09+178j
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_410C86

loc_410E04:				; CODE XREF: sub_410B09+7Aj
					; sub_410B09+BBj ...
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	[ebp+var_1C], 0
		jmp	short loc_410E19
; ---------------------------------------------------------------------------

loc_410E18:				; CODE XREF: sub_410B09+2Aj
		nop

loc_410E19:				; CODE XREF: sub_410B09+30Dj
		add	[ebp+var_C], 1

loc_410E1D:				; CODE XREF: sub_410B09+Ej
		mov	edx, [ebp+var_C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_4443A0
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_410B1C
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_410B09	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410E3F	proc near		; CODE XREF: sub_4112C8+FBp
					; sub_4112C8+14Ep ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 10h
		mov	eax, [ebp+arg_4]
		shl	eax, 3
		mov	[ebp+var_8], eax
		jmp	short loc_410E5D
; ---------------------------------------------------------------------------

loc_410E51:				; CODE XREF: sub_410E3F+2Cj
		sub	[ebp+arg_4], 1
		add	[ebp+arg_0], 1
		sub	[ebp+var_8], 8

loc_410E5D:				; CODE XREF: sub_410E3F+10j
		cmp	[ebp+arg_4], 0
		jz	short loc_410E6D
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_410E51

loc_410E6D:				; CODE XREF: sub_410E3F+22j
		cmp	[ebp+arg_4], 0
		jz	short loc_410EA5
		mov	[ebp+var_C], 7
		jmp	short loc_410E84
; ---------------------------------------------------------------------------

loc_410E7C:				; CODE XREF: sub_410E3F+64j
		sub	[ebp+var_8], 1
		sub	[ebp+var_C], 1

loc_410E84:				; CODE XREF: sub_410E3F+3Bj
		cmp	[ebp+var_C], 0
		jz	short loc_410EA5
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, [ebp+var_C]
		mov	ebx, edx
		mov	ecx, eax
		sar	ebx, cl
		mov	eax, ebx
		and	eax, 1
		test	eax, eax
		jz	short loc_410E7C

loc_410EA5:				; CODE XREF: sub_410E3F+32j
					; sub_410E3F+49j
		mov	eax, [ebp+var_8]
		add	esp, 10h
		pop	ebx
		pop	ebp
		retn
sub_410E3F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410EAE	proc near		; CODE XREF: sub_413C94+2CEp
					; sub_418EB5+55Dp

Str		= dword	ptr -58h
EndPtr		= dword	ptr -54h
Radix		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	edx, byte ptr [eax+40h]
		and	edx, 0FFFFFFFEh
		mov	[eax+40h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	edx, byte ptr [eax+40h]
		and	edx, 0FFFFFFFDh
		mov	[eax+40h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	edx, byte ptr [eax+44h]
		and	edx, 0FFFFFFFEh
		mov	[eax+44h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	dword ptr [eax+48h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	dword ptr [eax+4Ch], 0FFFFFFFFh
		mov	[esp+58h+var_48], 0
		lea	eax, [ebp+var_28]
		mov	[esp+58h+var_4C], eax
		lea	eax, [ebp+var_24]
		mov	[esp+58h+Radix], eax
		mov	[esp+58h+EndPtr], 5Eh
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str], eax
		call	sub_41075F
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_410F53
		jmp	locret_4112C6
; ---------------------------------------------------------------------------

loc_410F35:				; CODE XREF: sub_410EAE+ABj
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_410F5D
		mov	eax, [ebp+var_28]
		sub	eax, 1
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_24]
		add	eax, 1
		mov	[ebp+var_24], eax
		jmp	short loc_410F54
; ---------------------------------------------------------------------------

loc_410F53:				; CODE XREF: sub_410EAE+80j
		nop

loc_410F54:				; CODE XREF: sub_410EAE+A3j
		mov	eax, [ebp+var_28]
		test	eax, eax
		jnz	short loc_410F35
		jmp	short loc_410F5E
; ---------------------------------------------------------------------------

loc_410F5D:				; CODE XREF: sub_410EAE+8Fj
		nop

loc_410F5E:				; CODE XREF: sub_410EAE+ADj
		mov	eax, [ebp+var_28]
		cmp	eax, 1
		jbe	short loc_410F73
		mov	eax, [ebp+var_24]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 14h
		jz	short loc_410F83

loc_410F73:				; CODE XREF: sub_410EAE+B6j
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Str], eax
		call	gcry_free
		jmp	locret_4112C6
; ---------------------------------------------------------------------------

loc_410F83:				; CODE XREF: sub_410EAE+C3j
		mov	eax, [ebp+var_28]
		sub	eax, 1
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_24]
		add	eax, 1
		mov	[ebp+var_24], eax

loc_410F95:				; CODE XREF: sub_410EAE+404j
		mov	eax, [ebp+var_28]
		sub	eax, 1
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_24]
		add	eax, 1
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_28]
		cmp	eax, 1
		jbe	loc_4110F0
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jnz	loc_4110F0
		mov	eax, [ebp+var_24]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	loc_4110F0
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_24]
		add	eax, 2
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_28]
		sub	eax, 2
		mov	[ebp+var_10], eax
		jmp	short loc_411034
; ---------------------------------------------------------------------------

loc_410FED:				; CODE XREF: sub_410EAE+19Ej
					; sub_410EAE+1B2j ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_411005
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		jmp	short loc_411029
; ---------------------------------------------------------------------------

loc_411005:				; CODE XREF: sub_410EAE+147j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_41101D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 37h
		jmp	short loc_411029
; ---------------------------------------------------------------------------

loc_41101D:				; CODE XREF: sub_410EAE+15Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 57h

loc_411029:				; CODE XREF: sub_410EAE+155j
					; sub_410EAE+16Dj
		mov	[ebp+var_14], eax
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1

loc_411034:				; CODE XREF: sub_410EAE+13Dj
		cmp	[ebp+var_10], 0
		jz	short loc_41107A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_41104E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jbe	short loc_410FED

loc_41104E:				; CODE XREF: sub_410EAE+194j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jbe	short loc_411062
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jbe	short loc_410FED

loc_411062:				; CODE XREF: sub_410EAE+1A8j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jbe	short loc_41107A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jbe	loc_410FED

loc_41107A:				; CODE XREF: sub_410EAE+18Aj
					; sub_410EAE+1BCj
		mov	eax, [ebp+var_C]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_28], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4110A4
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_4110A4
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 18h
		jnz	loc_41126D

loc_4110A4:				; CODE XREF: sub_410EAE+1DCj
					; sub_410EAE+1E6j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+1Ch]
		mov	eax, [ebp+var_14]
		and	eax, 1
		and	eax, 1
		and	eax, 1
		mov	ecx, eax
		and	ecx, 1
		movzx	eax, byte ptr [edx+40h]
		and	eax, 0FFFFFFFEh
		or	eax, ecx
		mov	[edx+40h], al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+var_14]
		and	edx, 3
		cmp	edx, 3
		setz	dl
		and	edx, 1
		lea	ecx, [edx+edx]
		movzx	edx, byte ptr [eax+40h]
		and	edx, 0FFFFFFFDh
		or	edx, ecx
		mov	[eax+40h], dl
		jmp	loc_411271
; ---------------------------------------------------------------------------

loc_4110F0:				; CODE XREF: sub_410EAE+FFj
					; sub_410EAE+10Dj ...
		mov	eax, [ebp+var_28]
		cmp	eax, 1
		jbe	loc_411287
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 50h
		jnz	loc_411287
		mov	eax, [ebp+var_24]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jnz	loc_411287
		mov	eax, [ebp+var_24]
		add	eax, 2
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_28]
		sub	eax, 2
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		test	eax, eax
		jz	loc_411287
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	loc_411287
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	loc_411287
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Radix], 0Ah ; Radix
		lea	edx, [ebp+var_2C]
		mov	[esp+58h+EndPtr], edx ;	EndPtr
		mov	[esp+58h+Str], eax ; Str
		call	strtol
		mov	[ebp+var_20], eax
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_28]
		add	edx, eax
		mov	eax, [ebp+var_2C]
		cmp	edx, eax
		jbe	short loc_411194
		mov	eax, [ebp+var_2C]
		movzx	eax, byte ptr [eax]
		cmp	al, 18h
		jz	short loc_411194
		mov	eax, [ebp+var_2C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_41119C

loc_411194:				; CODE XREF: sub_410EAE+2D0j
					; sub_410EAE+2DAj
		mov	eax, [ebp+var_20]
		mov	[ebp+var_18], eax
		jmp	short loc_4111EF
; ---------------------------------------------------------------------------

loc_41119C:				; CODE XREF: sub_410EAE+2E4j
		mov	eax, [ebp+var_2C]
		movzx	edx, byte ptr [eax]
		cmp	dl, 2Ch
		setnz	dl
		add	eax, 1
		mov	[ebp+var_2C], eax
		test	dl, dl
		jnz	loc_411287
		mov	eax, [ebp+var_2C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	loc_411287
		mov	eax, [ebp+var_2C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	loc_411287
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Radix], 0Ah ; Radix
		lea	edx, [ebp+var_2C]
		mov	[esp+58h+EndPtr], edx ;	EndPtr
		mov	[esp+58h+Str], eax ; Str
		call	strtol
		mov	[ebp+var_18], eax

loc_4111EF:				; CODE XREF: sub_410EAE+2ECj
		mov	eax, [ebp+var_2C]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+var_28]
		cmp	edx, eax
		ja	loc_4112BA
		mov	eax, [ebp+var_24]
		mov	edx, eax
		mov	eax, [ebp+var_2C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+var_28]
		add	eax, edx
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_28]
		test	eax, eax
		jz	short loc_411243
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_411243
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 18h
		jnz	short loc_411270

loc_411243:				; CODE XREF: sub_410EAE+37Fj
					; sub_410EAE+389j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	edx, byte ptr [eax+44h]
		or	edx, 1
		mov	[eax+44h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+var_20]
		mov	[eax+48h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+var_18]
		mov	[eax+4Ch], edx
		jmp	short loc_411287
; ---------------------------------------------------------------------------

loc_41126D:				; CODE XREF: sub_410EAE+1F0j
		nop
		jmp	short loc_411271
; ---------------------------------------------------------------------------

loc_411270:				; CODE XREF: sub_410EAE+393j
		nop

loc_411271:				; CODE XREF: sub_410EAE+23Dj
					; sub_410EAE+3C0j
		jmp	short loc_411287
; ---------------------------------------------------------------------------

loc_411273:				; CODE XREF: sub_410EAE+3F3j
		mov	eax, [ebp+var_24]
		add	eax, 1
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_28]
		sub	eax, 1
		mov	[ebp+var_28], eax
		jmp	short loc_411288
; ---------------------------------------------------------------------------

loc_411287:				; CODE XREF: sub_410EAE+248j
					; sub_410EAE+256j ...
		nop

loc_411288:				; CODE XREF: sub_410EAE+3D7j
		mov	eax, [ebp+var_28]
		test	eax, eax
		jz	short loc_4112A3
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 18h
		jz	short loc_4112A3
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_411273

loc_4112A3:				; CODE XREF: sub_410EAE+3DFj
					; sub_410EAE+3E9j
		mov	eax, [ebp+var_28]
		test	eax, eax
		jz	short loc_4112BB
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	loc_410F95
		jmp	short loc_4112BB
; ---------------------------------------------------------------------------

loc_4112BA:				; CODE XREF: sub_410EAE+356j
		nop

loc_4112BB:				; CODE XREF: sub_410EAE+3FAj
					; sub_410EAE+40Aj
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Str], eax
		call	gcry_free

locret_4112C6:				; CODE XREF: sub_410EAE+82j
					; sub_410EAE+D0j
		leave
		retn
sub_410EAE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4112C8(int, int, int,	void *,	size_t,	void *,	size_t,	void *,	int)
sub_4112C8	proc near		; CODE XREF: sub_415770+10F2p
					; sub_4168B1+468p

Dst		= dword	ptr -48h
Src		= dword	ptr -44h
Size		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_28		= byte ptr -28h
var_27		= byte ptr -27h
var_26		= byte ptr -26h
var_25		= byte ptr -25h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		jmp	short loc_4112D9
; ---------------------------------------------------------------------------

loc_4112D1:				; CODE XREF: sub_4112C8+1Fj
		sub	[ebp+arg_10], 1
		add	[ebp+arg_C], 1

loc_4112D9:				; CODE XREF: sub_4112C8+7j
		cmp	[ebp+arg_10], 0
		jz	short loc_4112F3
		mov	eax, [ebp+arg_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4112D1
		jmp	short loc_4112F3
; ---------------------------------------------------------------------------

loc_4112EB:				; CODE XREF: sub_4112C8+39j
		sub	[ebp+arg_18], 1
		add	[ebp+arg_14], 1

loc_4112F3:				; CODE XREF: sub_4112C8+15j
					; sub_4112C8+21j
		cmp	[ebp+arg_18], 0
		jz	short loc_411303
		mov	eax, [ebp+arg_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4112EB

loc_411303:				; CODE XREF: sub_4112C8+2Fj
		mov	eax, [ebp+arg_18]
		mov	edx, [ebp+arg_10]
		add	eax, edx
		add	eax, 0Ah
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		add	eax, 3
		mov	[esp+48h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_18], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_411338
		call	sub_4101BF
		jmp	loc_4115BF
; ---------------------------------------------------------------------------

loc_411338:				; CODE XREF: sub_4112C8+64j
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	99h
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_10]
		shr	eax, 8
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_10]
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	4
		add	[ebp+var_18], 1
		mov	eax, [ebp+arg_8]
		shr	eax, 18h
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_18], 1
		mov	eax, [ebp+arg_8]
		shr	eax, 10h
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_18], 1
		mov	eax, [ebp+arg_8]
		shr	eax, 8
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_18], 1
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	1
		add	[ebp+var_18], 1
		mov	eax, [ebp+arg_10]
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+Dst], eax
		call	sub_410E3F
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		shr	eax, 8
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_1C]
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_18], 1
		mov	edx, [ebp+arg_C]
		mov	eax, [ebp+var_18]
		mov	ecx, [ebp+arg_10]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_10]
		add	[ebp+var_18], eax
		mov	eax, [ebp+arg_18]
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+48h+Dst], eax
		call	sub_410E3F
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		shr	eax, 8
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_1C]
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_18], 1
		mov	edx, [ebp+arg_14]
		mov	eax, [ebp+var_18]
		mov	ecx, [ebp+arg_18]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_18]
		add	[ebp+var_18], eax
		mov	eax, [ebp+var_10]
		add	eax, 3
		mov	[esp+48h+var_3C], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Size],	eax
		mov	eax, [ebp+arg_1C]
		mov	[esp+48h+Src], eax
		mov	[esp+48h+Dst], 2
		call	gcry_md_hash_buffer
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Dst], eax
		call	gcry_free
		cmp	[ebp+arg_20], 7
		jbe	short loc_411498
		mov	eax, 0C7h
		jmp	short loc_41149D
; ---------------------------------------------------------------------------

loc_411498:				; CODE XREF: sub_4112C8+1C7j
		mov	eax, 0C6h

loc_41149D:				; CODE XREF: sub_4112C8+1CEj
		add	eax, [ebp+arg_4]
		mov	[ebp+var_20], eax
		mov	[esp+48h+Src], 0C5h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Dst], eax
		call	sub_410542
		mov	eax, [ebp+arg_4]
		add	eax, 0CEh
		mov	[ebp+var_24], eax
		mov	[esp+48h+Src], 0CDh
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Dst], eax
		call	sub_410542
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+48h+var_38], 14h ;	size_t
		mov	edx, [ebp+arg_1C]
		mov	[esp+48h+var_3C], edx ;	void *
		mov	edx, [ebp+var_20]
		mov	[esp+48h+Size],	edx ; int
		mov	[esp+48h+Src], 0 ; int
		mov	[esp+48h+Dst], eax ; char
		call	sub_40D4CA
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41152E
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Dst], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+48h+Dst], offset aFailedToStoreT ;	"failed	to store the fingerprint: %s\n"
		call	sub_43C238
		mov	[esp+48h+Src], ebx ; char
		mov	[esp+48h+Dst], eax ; char *
		call	sub_43CB21

loc_41152E:				; CODE XREF: sub_4112C8+23Fj
		cmp	[ebp+var_C], 0
		jnz	loc_4115BC
		cmp	[ebp+arg_20], 100h
		jbe	short loc_4115BC
		mov	eax, [ebp+arg_8]
		shr	eax, 18h
		mov	[ebp+var_28], al
		mov	eax, [ebp+arg_8]
		shr	eax, 10h
		mov	[ebp+var_27], al
		mov	eax, [ebp+arg_8]
		shr	eax, 8
		mov	[ebp+var_26], al
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_25], al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+48h+var_38], 4 ; size_t
		lea	edx, [ebp+var_28]
		mov	[esp+48h+var_3C], edx ;	void *
		mov	edx, [ebp+var_24]
		mov	[esp+48h+Size],	edx ; int
		mov	[esp+48h+Src], 0 ; int
		mov	[esp+48h+Dst], eax ; char
		call	sub_40D4CA
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4115BC
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Dst], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+48h+Dst], offset aFailedToStor_0 ;	"failed	to store the creation date: %s\n"
		call	sub_43C238
		mov	[esp+48h+Src], ebx ; char
		mov	[esp+48h+Dst], eax ; char *
		call	sub_43CB21

loc_4115BC:				; CODE XREF: sub_4112C8+26Aj
					; sub_4112C8+277j ...
		mov	eax, [ebp+var_C]

loc_4115BF:				; CODE XREF: sub_4112C8+6Bj
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_4112C8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4115C5	proc near		; CODE XREF: sub_41199B+715p
					; sub_4168B1+493p

Dest		= dword	ptr -88h
Format		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_5C		= dword	ptr -5Ch
var_4E		= byte ptr -4Eh
var_35		= byte ptr -35h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		add	esp, 0FFFFFF80h
		mov	[ebp+var_C], 0
		jmp	short loc_4115DA
; ---------------------------------------------------------------------------

loc_4115D6:				; CODE XREF: sub_4115C5+26j
		add	[ebp+var_C], 1

loc_4115DA:				; CODE XREF: sub_4115C5+Fj
		cmp	[ebp+var_C], 13h
		jg	short loc_4115ED
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4115D6

loc_4115ED:				; CODE XREF: sub_4115C5+19j
		cmp	[ebp+var_C], 14h
		jz	loc_4116B0
		lea	eax, [ebp+var_35]
		mov	[esp+88h+var_80], eax
		mov	[esp+88h+Format], 14h
		mov	eax, [ebp+arg_C]
		mov	[esp+88h+Dest],	eax
		call	sub_42BDA4
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jnz	short loc_41161D
		mov	[ebp+var_4E], 0
		jmp	short loc_411638
; ---------------------------------------------------------------------------

loc_41161D:				; CODE XREF: sub_4115C5+50j
		mov	eax, offset aD_0 ; "%d"
		mov	edx, [ebp+arg_8]
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		lea	eax, [ebp+var_4E]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf

loc_411638:				; CODE XREF: sub_4115C5+56j
		lea	eax, [ebp+var_35]
		mov	[ebp+var_5C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_5C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		lea	eax, [ebp+var_4E]
		mov	[ebp+var_5C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_5C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	[esp+88h+var_6C], 0
		mov	[esp+88h+var_70], 0
		mov	[esp+88h+var_74], ebx
		lea	eax, [ebp+var_35]
		mov	[esp+88h+var_78], eax
		mov	[esp+88h+var_7C], edx
		lea	eax, [ebp+var_4E]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_406FDB
		jmp	short loc_4116B1
; ---------------------------------------------------------------------------

loc_4116B0:				; CODE XREF: sub_4115C5+2Cj
		nop

loc_4116B1:				; CODE XREF: sub_4115C5+E9j
		sub	esp, 0FFFFFF80h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4115C5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4116B8	proc near		; CODE XREF: sub_41199B+78Ep

Dest		= dword	ptr -0A8h
Format		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_7C		= dword	ptr -7Ch
var_70		= byte ptr -70h
var_3E		= byte ptr -3Eh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0A0h
		mov	eax, [ebp+arg_C]
		mov	[esp+0A8h+Dest], eax
		call	sub_4101D4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_411789
		mov	eax, offset aD_0 ; "%d"
		mov	edx, [ebp+arg_8]
		mov	[esp+0A8h+var_A0], edx
		mov	[esp+0A8h+Format], eax ; Format
		lea	eax, [ebp+var_3E]
		mov	[esp+0A8h+Dest], eax ; Dest
		call	sprintf
		mov	eax, offset aLu_0 ; "%lu"
		mov	edx, [ebp+var_C]
		mov	[esp+0A8h+var_A0], edx
		mov	[esp+0A8h+Format], eax ; Format
		lea	eax, [ebp+var_70]
		mov	[esp+0A8h+Dest], eax ; Dest
		call	sprintf
		lea	eax, [ebp+var_70]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		lea	eax, [ebp+var_3E]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	[esp+0A8h+var_8C], 0
		mov	[esp+0A8h+var_90], 0
		mov	[esp+0A8h+var_94], ebx
		lea	eax, [ebp+var_70]
		mov	[esp+0A8h+var_98], eax
		mov	[esp+0A8h+var_9C], edx
		lea	eax, [ebp+var_3E]
		mov	[esp+0A8h+var_A0], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+Dest], eax
		call	sub_406FDB
		jmp	short loc_41178A
; ---------------------------------------------------------------------------

loc_411789:				; CODE XREF: sub_4116B8+1Dj
		nop

loc_41178A:				; CODE XREF: sub_4116B8+CFj
		add	esp, 0A0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4116B8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411794	proc near		; CODE XREF: sub_4168B1+32Ep
					; sub_4168B1+3A1p

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	[esp+48h+var_40], 0
		mov	eax, dword ptr [ebp+arg_C]
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_48], eax
		call	sub_42BDA4
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4117D5
		mov	[esp+48h+var_48], offset aMemoryAlloca_0 ; "memory allocation error in send_key_dat"...
		call	sub_43CB21
		jmp	loc_4118B8
; ---------------------------------------------------------------------------

loc_4117D5:				; CODE XREF: sub_411794+2Ej
		mov	eax, [ebp+var_14]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_411849
; ---------------------------------------------------------------------------

loc_4117F9:				; CODE XREF: sub_411794+BCj
		mov	[esp+48h+var_2C], 0
		mov	[esp+48h+var_30], 0
		mov	[esp+48h+var_34], 300h
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_38], eax
		mov	[esp+48h+var_3C], 1
		mov	[esp+48h+var_40], offset asc_44A78E ; "-"
		mov	dword ptr [esp+48h+var_44], offset aKeyData ; "KEY-DATA"
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_406FDB
		sub	[ebp+var_10], 300h
		add	[ebp+var_C], 300h

loc_411849:				; CODE XREF: sub_411794+63j
		cmp	[ebp+var_10], 300h
		ja	short loc_4117F9
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	[esp+48h+var_2C], 0
		mov	[esp+48h+var_30], 0
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_38], eax
		mov	[esp+48h+var_3C], edx
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_40], eax
		mov	dword ptr [esp+48h+var_44], offset aKeyData ; "KEY-DATA"
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_406FDB
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_free

loc_4118B8:				; CODE XREF: sub_411794+3Cj
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_411794	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4118BE	proc near		; CODE XREF: sub_41199B+493p

var_F8		= dword	ptr -0F8h
var_F4		= dword	ptr -0F4h
var_F0		= dword	ptr -0F0h
var_EC		= dword	ptr -0ECh
var_E8		= dword	ptr -0E8h
var_E4		= dword	ptr -0E4h
var_E0		= dword	ptr -0E0h
var_D0		= byte ptr -0D0h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 0F0h
		cmp	[ebp+arg_C], 0
		js	short loc_4118D7
		mov	eax, [ebp+arg_C]
		cmp	eax, 2
		jbe	short loc_4118F5

loc_4118D7:				; CODE XREF: sub_4118BE+Fj
		mov	[esp+0F8h+var_F0], 356h	; int
		mov	[esp+0F8h+var_F4], offset a____Gnupg22__2 ; "../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+0F8h+var_F8], offset aNumber0NumberD ; "number >=0	&& number < DIM(app->app_loc"...
		call	sub_442650
		jmp	short loc_4118F6
; ---------------------------------------------------------------------------

loc_4118F5:				; CODE XREF: sub_4118BE+17j
		nop

loc_4118F6:				; CODE XREF: sub_4118BE+35j
		mov	eax, [ebp+arg_4]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 58h
		mov	ebx, [eax]
		mov	eax, [ebp+arg_4]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 54h
		mov	ecx, [eax]
		mov	eax, [ebp+arg_4]
		mov	esi, [eax+1Ch]
		mov	edx, [ebp+arg_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, esi
		add	eax, 50h
		mov	eax, [eax]
		mov	edx, [ebp+arg_C]
		add	edx, 1
		mov	[esp+0F8h+var_E0], ebx
		mov	[esp+0F8h+var_E4], ecx
		mov	[esp+0F8h+var_E8], eax
		mov	[esp+0F8h+var_EC], edx
		mov	[esp+0F8h+var_F0], offset aD1UUD ; "%d 1 %u %u %d"
		mov	[esp+0F8h+var_F4], 0C8h
		lea	eax, [ebp+var_D0]
		mov	[esp+0F8h+var_F8], eax
		call	sub_429C1D
		lea	eax, [ebp+var_D0]
		mov	[esp+0F8h+var_F0], eax ; char *
		mov	eax, [ebp+arg_8]
		mov	[esp+0F8h+var_F4], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+0F8h+var_F8], eax ; int
		call	sub_4070F7
		add	esp, 0F0h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_4118BE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41199B(int, int, char	*)
sub_41199B	proc near		; CODE XREF: sub_412D77+1Bp
					; sub_412D77+35p ...

Str1		= dword	ptr -138h
Str2		= dword	ptr -134h
var_130		= dword	ptr -130h
var_12C		= dword	ptr -12Ch
var_128		= dword	ptr -128h
var_124		= dword	ptr -124h
var_120		= dword	ptr -120h
var_11C		= dword	ptr -11Ch
var_118		= dword	ptr -118h
var_114		= dword	ptr -114h
var_100		= dword	ptr -100h
var_FC		= dword	ptr -0FCh
Dest		= byte ptr -0EDh
var_4C		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_42		= dword	ptr -42h
var_3E		= dword	ptr -3Eh
var_3A		= word ptr -3Ah
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 12Ch
		mov	[ebp+var_1C], 0
		jmp	short loc_4119B4
; ---------------------------------------------------------------------------

loc_4119B0:				; CODE XREF: sub_41199B+54j
		add	[ebp+var_1C], 1

loc_4119B4:				; CODE XREF: sub_41199B+13j
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4447C0
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4119F1
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4447C0
		mov	eax, [eax]
		mov	edx, [ebp+arg_8]
		mov	[esp+138h+Str2], edx ; Str2
		mov	[esp+138h+Str1], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4119B0

loc_4119F1:				; CODE XREF: sub_41199B+2Ej
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4447C0
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_411A19
		mov	[esp+138h+Str1], 58h
		call	sub_410197
		jmp	loc_412188
; ---------------------------------------------------------------------------

loc_411A19:				; CODE XREF: sub_41199B+6Bj
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4447C0
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFFh
		jnz	loc_411B15
		lea	eax, [ebp+var_38]
		mov	[esp+138h+var_130], eax
		lea	eax, [ebp+var_34]
		mov	[esp+138h+Str2], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+138h+Str1], eax
		call	sub_40EEAD
		test	eax, eax
		jnz	loc_411B0B
		mov	eax, [ebp+var_38]
		mov	edx, eax
		mov	eax, offset aLu_0 ; "%lu"
		mov	[esp+138h+var_130], edx
		mov	[esp+138h+Str2], eax ; Format
		lea	eax, [ebp+Dest]
		mov	[esp+138h+Str1], eax ; Dest
		call	sprintf
		lea	eax, [ebp+Dest]
		mov	[ebp+var_100], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_100]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_34]
		mov	[ebp+var_100], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_100]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ecx, [eax-1]
		mov	eax, [ebp+var_34]
		mov	[esp+138h+var_11C], 0
		mov	[esp+138h+var_120], 0
		mov	[esp+138h+var_124], ebx
		lea	edx, [ebp+Dest]
		mov	[esp+138h+var_128], edx
		mov	[esp+138h+var_12C], ecx
		mov	[esp+138h+var_130], eax
		mov	[esp+138h+Str2], offset	aSerialno_1 ; "SERIALNO"
		mov	eax, [ebp+arg_4]
		mov	[esp+138h+Str1], eax
		call	sub_406FDB
		mov	eax, [ebp+var_34]
		mov	[esp+138h+Str1], eax
		call	gcry_free

loc_411B0B:				; CODE XREF: sub_41199B+B6j
		mov	eax, 0
		jmp	loc_412188
; ---------------------------------------------------------------------------

loc_411B15:				; CODE XREF: sub_41199B+95j
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4447C0
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	loc_411C8C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 40h
		test	al, al
		jz	short loc_411B64
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 0FFFFFF80h
		test	al, al
		jz	short loc_411B5B
		mov	eax, 7
		jmp	short loc_411B60
; ---------------------------------------------------------------------------

loc_411B5B:				; CODE XREF: sub_41199B+1B7j
		mov	eax, 2

loc_411B60:				; CODE XREF: sub_41199B+1BEj
		mov	edx, eax
		jmp	short loc_411B69
; ---------------------------------------------------------------------------

loc_411B64:				; CODE XREF: sub_41199B+1A6j
		mov	edx, 0

loc_411B69:				; CODE XREF: sub_41199B+1C7j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		shr	al, 5
		and	eax, 1
		movzx	eax, al
		mov	[ebp+var_FC], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+35h]
		movzx	edi, ax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		shr	al, 4
		and	eax, 1
		movzx	esi, al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		shr	al, 3
		and	eax, 1
		movzx	ebx, al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		shr	al, 2
		and	eax, 1
		movzx	ecx, al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		shr	al, 1
		and	eax, 1
		movzx	eax, al
		mov	[esp+138h+var_114], edx
		mov	edx, [ebp+var_FC]
		mov	[esp+138h+var_118], edx
		mov	[esp+138h+var_11C], edi
		mov	[esp+138h+var_120], esi
		mov	[esp+138h+var_124], ebx
		mov	[esp+138h+var_128], ecx
		mov	[esp+138h+var_12C], eax
		mov	[esp+138h+var_130], offset aGcDKiDFcDPdDMc ; "gc=%d ki=%d fc=%d	pd=%d mcl3=%u aac=%d "...
		mov	[esp+138h+Str2], 64h
		lea	eax, [ebp+Dest]
		mov	[esp+138h+Str1], eax
		call	sub_429C1D
		lea	eax, [ebp+Dest]
		mov	[ebp+var_100], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_100]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ecx, [eax-1]
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4447C0
		mov	eax, [eax]
		mov	[esp+138h+var_124], 0
		mov	[esp+138h+var_128], 0
		mov	[esp+138h+var_12C], ecx
		lea	edx, [ebp+Dest]
		mov	[esp+138h+var_130], edx
		mov	[esp+138h+Str2], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+138h+Str1], eax
		call	sub_406FDB
		mov	eax, 0
		jmp	loc_412188
; ---------------------------------------------------------------------------

loc_411C8C:				; CODE XREF: sub_41199B+191j
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4447C0
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_411D04
		mov	[ebp+var_42], 4E45504Fh
		mov	[ebp+var_3E], 2E504750h
		mov	[ebp+var_3A], 33h
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4447C0
		mov	eax, [eax]
		mov	[esp+138h+var_124], 0
		mov	[esp+138h+var_128], 0
		mov	[esp+138h+var_12C], 9
		lea	edx, [ebp+var_42]
		mov	[esp+138h+var_130], edx
		mov	[esp+138h+Str2], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+138h+Str1], eax
		call	sub_406FDB
		mov	eax, 0
		jmp	loc_412188
; ---------------------------------------------------------------------------

loc_411D04:				; CODE XREF: sub_41199B+308j
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4447C0
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFCh
		jnz	loc_411DE1
		lea	eax, [ebp+var_4C]
		mov	[esp+138h+var_130], eax
		lea	eax, [ebp+var_48]
		mov	[esp+138h+Str2], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+138h+Str1], eax
		call	sub_40EEAD
		test	eax, eax
		jnz	loc_411DD0
		mov	eax, [ebp+var_48]
		mov	[ebp+var_100], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_100]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 1Ch
		jbe	short loc_411DC5
		mov	eax, [ebp+var_48]
		lea	ecx, [eax+10h]
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4447C0
		mov	eax, [eax]
		mov	[esp+138h+var_124], 0
		mov	[esp+138h+var_128], 0
		mov	[esp+138h+var_12C], 0Ch
		mov	[esp+138h+var_130], ecx
		mov	[esp+138h+Str2], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+138h+Str1], eax
		call	sub_406FDB
		mov	eax, [ebp+var_48]
		mov	[esp+138h+Str1], eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_412188
; ---------------------------------------------------------------------------

loc_411DC5:				; CODE XREF: sub_41199B+3CFj
		mov	eax, [ebp+var_48]
		mov	[esp+138h+Str1], eax
		call	gcry_free

loc_411DD0:				; CODE XREF: sub_41199B+3A1j
		mov	[esp+138h+Str1], 58h
		call	sub_410197
		jmp	loc_412188
; ---------------------------------------------------------------------------

loc_411DE1:				; CODE XREF: sub_41199B+380j
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4447C0
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFBh
		jnz	short loc_411E47
		mov	[ebp+var_20], 0
		jmp	short loc_411E37
; ---------------------------------------------------------------------------

loc_411E03:				; CODE XREF: sub_41199B+4A0j
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4447C0
		mov	eax, [eax]
		mov	edx, [ebp+var_20]
		mov	[esp+138h+var_12C], edx
		mov	[esp+138h+var_130], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+138h+Str2], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+138h+Str1], eax
		call	sub_4118BE
		add	[ebp+var_20], 1

loc_411E37:				; CODE XREF: sub_41199B+466j
		cmp	[ebp+var_20], 2
		jle	short loc_411E03
		mov	eax, 0
		jmp	loc_412188
; ---------------------------------------------------------------------------

loc_411E47:				; CODE XREF: sub_41199B+45Dj
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4447C0
		mov	eax, [eax+4]
		lea	edx, [ebp+var_28]
		mov	[esp+138h+var_128], edx
		lea	edx, [ebp+var_30]
		mov	[esp+138h+var_12C], edx
		lea	edx, [ebp+var_2C]
		mov	[esp+138h+var_130], edx
		mov	[esp+138h+Str2], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+138h+Str1], eax
		call	sub_41075F
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	loc_412185
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4447C0
		mov	eax, [eax+8]
		cmp	eax, 1
		jnz	loc_411F8D
		mov	[ebp+var_20], 0
		mov	[ebp+Dest], 0
		jmp	short loc_411F10
; ---------------------------------------------------------------------------

loc_411EB9:				; CODE XREF: sub_41199B+583j
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_20]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	esi, al
		mov	ebx, offset aD_1 ; " %d"
		lea	eax, [ebp+Dest]
		mov	[ebp+var_100], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_100]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp+Dest]
		add	eax, edx
		mov	[esp+138h+var_130], esi
		mov	[esp+138h+Str2], ebx ; Format
		mov	[esp+138h+Str1], eax ; Dest
		call	sprintf
		add	[ebp+var_20], 1

loc_411F10:				; CODE XREF: sub_41199B+51Cj
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_30]
		cmp	edx, eax
		jnb	short loc_411F20
		cmp	[ebp+var_20], 6
		jle	short loc_411EB9

loc_411F20:				; CODE XREF: sub_41199B+57Dj
		lea	eax, [ebp+Dest]
		mov	[ebp+var_100], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_100]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ecx, [eax-1]
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4447C0
		mov	eax, [eax]
		mov	[esp+138h+var_124], 0
		mov	[esp+138h+var_128], 0
		mov	[esp+138h+var_12C], ecx
		lea	edx, [ebp+Dest]
		mov	[esp+138h+var_130], edx
		mov	[esp+138h+Str2], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+138h+Str1], eax
		call	sub_406FDB
		jmp	loc_41217A
; ---------------------------------------------------------------------------

loc_411F8D:				; CODE XREF: sub_41199B+508j
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4447C0
		mov	eax, [eax+8]
		cmp	eax, 2
		jnz	loc_412044
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_2C]
		mov	[esp+138h+Str2], edx
		mov	[esp+138h+Str1], eax
		call	sub_416D67
		mov	edx, offset aLu_0 ; "%lu"
		mov	[esp+138h+var_130], eax
		mov	[esp+138h+Str2], edx ; Format
		lea	eax, [ebp+Dest]
		mov	[esp+138h+Str1], eax ; Dest
		call	sprintf
		lea	eax, [ebp+Dest]
		mov	[ebp+var_100], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_100]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ecx, [eax-1]
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4447C0
		mov	eax, [eax]
		mov	[esp+138h+var_124], 0
		mov	[esp+138h+var_128], 0
		mov	[esp+138h+var_12C], ecx
		lea	edx, [ebp+Dest]
		mov	[esp+138h+var_130], edx
		mov	[esp+138h+Str2], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+138h+Str1], eax
		call	sub_406FDB
		jmp	loc_41217A
; ---------------------------------------------------------------------------

loc_412044:				; CODE XREF: sub_41199B+609j
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4447C0
		mov	eax, [eax+8]
		cmp	eax, 3
		jnz	short loc_4120C4
		mov	eax, [ebp+var_30]
		cmp	eax, 3Bh
		jbe	loc_41217A
		mov	[ebp+var_20], 0
		jmp	short loc_4120B9
; ---------------------------------------------------------------------------

loc_412072:				; CODE XREF: sub_41199B+722j
		mov	ecx, [ebp+var_2C]
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		lea	ebx, [ecx+eax]
		mov	eax, [ebp+var_20]
		lea	ecx, [eax+1]
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4447C0
		mov	eax, [eax]
		mov	[esp+138h+var_12C], ebx
		mov	[esp+138h+var_130], ecx
		mov	[esp+138h+Str2], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+138h+Str1], eax
		call	sub_4115C5
		add	[ebp+var_20], 1

loc_4120B9:				; CODE XREF: sub_41199B+6D5j
		cmp	[ebp+var_20], 2
		jle	short loc_412072
		jmp	loc_41217A
; ---------------------------------------------------------------------------

loc_4120C4:				; CODE XREF: sub_41199B+6C0j
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4447C0
		mov	eax, [eax+8]
		cmp	eax, 4
		jnz	short loc_41213A
		mov	eax, [ebp+var_30]
		cmp	eax, 0Bh
		jbe	loc_41217A
		mov	[ebp+var_20], 0
		jmp	short loc_412132
; ---------------------------------------------------------------------------

loc_4120F2:				; CODE XREF: sub_41199B+79Bj
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_20]
		shl	eax, 2
		lea	ebx, [edx+eax]
		mov	eax, [ebp+var_20]
		lea	ecx, [eax+1]
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4447C0
		mov	eax, [eax]
		mov	[esp+138h+var_12C], ebx
		mov	[esp+138h+var_130], ecx
		mov	[esp+138h+Str2], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+138h+Str1], eax
		call	sub_4116B8
		add	[ebp+var_20], 1

loc_412132:				; CODE XREF: sub_41199B+755j
		cmp	[ebp+var_20], 2
		jle	short loc_4120F2
		jmp	short loc_41217A
; ---------------------------------------------------------------------------

loc_41213A:				; CODE XREF: sub_41199B+740j
		mov	ebx, [ebp+var_30]
		mov	ecx, [ebp+var_2C]
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_4447C0
		mov	eax, [eax]
		mov	[esp+138h+var_124], 0
		mov	[esp+138h+var_128], 0
		mov	[esp+138h+var_12C], ebx
		mov	[esp+138h+var_130], ecx
		mov	[esp+138h+Str2], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+138h+Str1], eax
		call	sub_406FDB

loc_41217A:				; CODE XREF: sub_41199B+5EDj
					; sub_41199B+6A4j ...
		mov	eax, [ebp+var_24]
		mov	[esp+138h+Str1], eax
		call	gcry_free

loc_412185:				; CODE XREF: sub_41199B+4EBj
		mov	eax, [ebp+var_28]

loc_412188:				; CODE XREF: sub_41199B+79j
					; sub_41199B+175j ...
		add	esp, 12Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_41199B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_412193	proc near		; CODE XREF: sub_41257F+39Fp

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_4], 0
		js	short loc_4121AC
		cmp	[ebp+arg_4], 2
		jle	short loc_4121CA

loc_4121AC:				; CODE XREF: sub_412193+11j
		mov	[esp+38h+var_30], 407h ; int
		mov	[esp+38h+var_34], offset a____Gnupg22__2 ; "../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+38h+var_38], offset aKeyno0Keyno2 ; "keyno	>=0 && keyno <=	2"
		call	sub_442650
		jmp	short loc_4121CB
; ---------------------------------------------------------------------------

loc_4121CA:				; CODE XREF: sub_412193+17j
		nop

loc_4121CB:				; CODE XREF: sub_412193+35j
		mov	[esp+38h+var_28], 0
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_2C], eax
		lea	eax, [ebp+var_14]
		mov	[esp+38h+var_30], eax
		mov	[esp+38h+var_34], 0C5h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_41075F
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_412231
		mov	eax, [ebp+var_18]
		cmp	eax, 3Bh
		jbe	short loc_412231
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		lea	edx, [ecx+eax]
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	[esp+38h+var_34], 14h
		mov	[esp+38h+var_38], edx
		call	sub_42BDA4
		jmp	short loc_412240
; ---------------------------------------------------------------------------

loc_412231:				; CODE XREF: sub_412193+68j
					; sub_412193+70j
		mov	[esp+38h+var_38], 1Bh
		call	sub_410197
		mov	[ebp+var_C], eax

loc_412240:				; CODE XREF: sub_412193+9Cj
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		leave
		retn
sub_412193	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_412250(FILE *, char *Str2, int, int, int, int)
sub_412250	proc near		; CODE XREF: sub_41257F+480p

Str		= dword	ptr -78h
Val		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
Str1		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Str2		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 78h
		mov	[ebp+var_C], 0
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_28], 0
		mov	[ebp+var_2C], 0
		mov	[ebp+var_30], 0
		mov	[ebp+var_34], 0
		jmp	short loc_412291
; ---------------------------------------------------------------------------

loc_412290:				; CODE XREF: sub_412250+2A7j
					; sub_412250:loc_412506j
		nop

loc_412291:				; CODE XREF: sub_412250+3Ej
		mov	[ebp+var_50], 1000h
		lea	eax, [ebp+var_50]
		mov	[esp+78h+var_6C], eax ;	int
		lea	eax, [ebp+var_24]
		mov	[esp+78h+var_70], eax ;	int
		lea	eax, [ebp+var_20]
		mov	[esp+78h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Str], eax ; FILE *
		call	sub_42D85C
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_41250B
		cmp	[ebp+var_1C], 0
		jns	short loc_4122D8
		call	sub_4101BF
		mov	[ebp+var_C], eax
		jmp	loc_412559
; ---------------------------------------------------------------------------

loc_4122D8:				; CODE XREF: sub_412250+79j
		mov	eax, [ebp+var_50]
		test	eax, eax
		jnz	short loc_4122F3
		mov	[esp+78h+Str], 4Ah
		call	sub_410197
		mov	[ebp+var_C], eax
		jmp	loc_412559
; ---------------------------------------------------------------------------

loc_4122F3:				; CODE XREF: sub_412250+8Dj
		mov	[ebp+var_18], 0
		mov	eax, [ebp+var_20]
		mov	[ebp+var_14], eax
		jmp	short loc_412336
; ---------------------------------------------------------------------------

loc_412302:				; CODE XREF: sub_412250+F2j
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	[ebp+eax*4+Str1], edx
		mov	[esp+78h+Val], 3Ah ; Val
		mov	eax, [ebp+var_14]
		mov	[esp+78h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_412332
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		add	[ebp+var_14], 1

loc_412332:				; CODE XREF: sub_412250+D6j
		add	[ebp+var_18], 1

loc_412336:				; CODE XREF: sub_412250+B0j
		cmp	[ebp+var_14], 0
		jz	short loc_412344
		mov	eax, [ebp+var_18]
		cmp	eax, 5
		jbe	short loc_412302

loc_412344:				; CODE XREF: sub_412250+EAj
		cmp	[ebp+var_18], 0
		jz	loc_4124FF
		cmp	[ebp+var_10], 0
		jnz	short loc_4123B6
		mov	eax, [ebp+Str1]
		mov	[esp+78h+Val], offset aSub ; "sub"
		mov	[esp+78h+Str], eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_412386
		mov	eax, [ebp+Str1]
		mov	[esp+78h+Val], offset aPub ; "pub"
		mov	[esp+78h+Str], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	loc_412502

loc_412386:				; CODE XREF: sub_412250+119j
		cmp	[ebp+var_18], 4
		jle	loc_412502
		mov	eax, [ebp+var_3C]
		mov	edx, [ebp+Str2]
		mov	[esp+78h+Val], edx ; Str2
		mov	[esp+78h+Str], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	loc_412502
		mov	[ebp+var_10], 1
		jmp	loc_412502
; ---------------------------------------------------------------------------

loc_4123B6:				; CODE XREF: sub_412250+102j
		mov	eax, [ebp+Str1]
		mov	[esp+78h+Val], offset aSub ; "sub"
		mov	[esp+78h+Str], eax ; Str1
		call	strcmp
		test	eax, eax
		jz	loc_41250C
		mov	eax, [ebp+Str1]
		mov	[esp+78h+Val], offset aPub ; "pub"
		mov	[esp+78h+Str], eax ; Str1
		call	strcmp
		test	eax, eax
		jz	loc_41250C
		mov	eax, [ebp+Str1]
		mov	[esp+78h+Val], offset aPkd ; "pkd"
		mov	[esp+78h+Str], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	loc_412505
		mov	[ebp+var_1C], 0
		cmp	[ebp+var_18], 3
		jle	short loc_412448
		mov	eax, [ebp+var_48]
		mov	[esp+78h+Str], eax ; Str
		call	atoi
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		js	short loc_412448
		cmp	[ebp+var_1C], 1
		jg	short loc_412448
		cmp	[ebp+var_1C], 0
		jnz	short loc_41243B
		mov	eax, [ebp+var_28]
		test	eax, eax
		jnz	short loc_412448

loc_41243B:				; CODE XREF: sub_412250+1E2j
		cmp	[ebp+var_1C], 0
		jz	short loc_41245C
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jz	short loc_41245C

loc_412448:				; CODE XREF: sub_412250+1C2j
					; sub_412250+1D6j ...
		mov	[esp+78h+Str], 1
		call	sub_410197
		mov	[ebp+var_C], eax
		jmp	loc_412559
; ---------------------------------------------------------------------------

loc_41245C:				; CODE XREF: sub_412250+1EFj
					; sub_412250+1F6j
		mov	eax, [ebp+var_40]
		mov	[esp+78h+var_68], 0
		mov	[esp+78h+var_6C], 0
		mov	[esp+78h+var_70], eax
		mov	[esp+78h+Val], 4
		lea	eax, [ebp+var_54]
		mov	[esp+78h+Str], eax
		call	gcry_mpi_scan
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_412498
		mov	[ebp+var_54], 0
		jmp	short loc_4124E8
; ---------------------------------------------------------------------------

loc_412498:				; CODE XREF: sub_412250+23Dj
		cmp	[ebp+var_1C], 0
		jnz	short loc_4124C4
		mov	eax, [ebp+var_54]
		mov	[esp+78h+var_6C], eax
		lea	eax, [ebp+var_30]
		mov	[esp+78h+var_70], eax
		lea	eax, [ebp+var_28]
		mov	[esp+78h+Val], eax
		mov	[esp+78h+Str], 1
		call	gcry_mpi_aprint
		mov	[ebp+var_C], eax
		jmp	short loc_4124E8
; ---------------------------------------------------------------------------

loc_4124C4:				; CODE XREF: sub_412250+24Cj
		mov	eax, [ebp+var_54]
		mov	[esp+78h+var_6C], eax
		lea	eax, [ebp+var_34]
		mov	[esp+78h+var_70], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+78h+Val], eax
		mov	[esp+78h+Str], 1
		call	gcry_mpi_aprint
		mov	[ebp+var_C], eax

loc_4124E8:				; CODE XREF: sub_412250+246j
					; sub_412250+272j
		mov	eax, [ebp+var_54]
		mov	[esp+78h+Str], eax
		call	gcry_mpi_release
		cmp	[ebp+var_C], 0
		jz	loc_412290
		jmp	short loc_412559
; ---------------------------------------------------------------------------

loc_4124FF:				; CODE XREF: sub_412250+F8j
		nop
		jmp	short loc_412506
; ---------------------------------------------------------------------------

loc_412502:				; CODE XREF: sub_412250+130j
					; sub_412250+13Aj ...
		nop
		jmp	short loc_412506
; ---------------------------------------------------------------------------

loc_412505:				; CODE XREF: sub_412250+1B1j
		nop

loc_412506:				; CODE XREF: sub_412250+2B0j
					; sub_412250+2B3j
		jmp	loc_412290
; ---------------------------------------------------------------------------

loc_41250B:				; CODE XREF: sub_412250+6Fj
		nop

loc_41250C:				; CODE XREF: sub_412250+17Bj
					; sub_412250+196j
		mov	eax, [ebp+var_28]
		test	eax, eax
		jz	short loc_41254A
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jz	short loc_41254A
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	[ebp+var_28], 0
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+arg_14]
		mov	[eax], edx
		mov	[ebp+var_2C], 0
		jmp	short loc_412559
; ---------------------------------------------------------------------------

loc_41254A:				; CODE XREF: sub_412250+2C1j
					; sub_412250+2C8j
		mov	[esp+78h+Str], 1
		call	sub_410197
		mov	[ebp+var_C], eax

loc_412559:				; CODE XREF: sub_412250+83j
					; sub_412250+9Ej ...
		mov	eax, [ebp+var_28]
		mov	[esp+78h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		leave
		retn
sub_412250	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41257F	proc near		; CODE XREF: sub_412BF2+1Fp
					; sub_412F96+84p

Dst		= dword	ptr -0B8h
Src		= dword	ptr -0B4h
Size		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_8C		= dword	ptr -8Ch
var_7D		= byte ptr -7Dh
Command		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= byte ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
File		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
Str2		= dword	ptr -28h
var_24		= dword	ptr -24h
Dest		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0B0h
		mov	[ebp+var_1C], 0
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		mov	[ebp+Dest], 0
		cmp	[ebp+arg_4], 0
		jle	short loc_4125B2
		cmp	[ebp+arg_4], 3
		jle	short loc_4125C3

loc_4125B2:				; CODE XREF: sub_41257F+2Bj
		mov	[esp+0B8h+Dst],	76h
		call	sub_410197
		jmp	loc_412BE8
; ---------------------------------------------------------------------------

loc_4125C3:				; CODE XREF: sub_41257F+31j
		sub	[ebp+arg_4], 1
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 4
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4125EE
		mov	eax, 0
		jmp	loc_412BE8
; ---------------------------------------------------------------------------

loc_4125EE:				; CODE XREF: sub_41257F+63j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 8
		mov	eax, [eax]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 8
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 0Ch
		mov	dword ptr [eax], 0
		mov	[ebp+var_40], 0
		mov	eax, [ebp+var_40]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 100h
		jbe	loc_4128FC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+30h]
		and	eax, 2
		test	al, al
		jz	short loc_412691
		mov	[ebp+var_14], 1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+3Ch]
		movzx	eax, ax
		mov	[ebp+var_18], eax
		jmp	short loc_41269F
; ---------------------------------------------------------------------------

loc_412691:				; CODE XREF: sub_41257F+F7j
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 100h

loc_41269F:				; CODE XREF: sub_41257F+110j
		cmp	[ebp+arg_4], 0
		jz	short loc_4126B9
		cmp	[ebp+arg_4], 1
		jnz	short loc_4126B2
		mov	eax, offset asc_44A83D ; ""
		jmp	short loc_4126B7
; ---------------------------------------------------------------------------

loc_4126B2:				; CODE XREF: sub_41257F+12Aj
		mov	eax, offset aD_2 ; ""

loc_4126B7:				; CODE XREF: sub_41257F+131j
		jmp	short loc_4126BE
; ---------------------------------------------------------------------------

loc_4126B9:				; CODE XREF: sub_41257F+124j
		mov	eax, offset asc_44A841 ; ""

loc_4126BE:				; CODE XREF: sub_41257F:loc_4126B7j
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+4]
		lea	ecx, [ebp+var_44]
		mov	[esp+0B8h+var_A0], ecx ; int
		lea	ecx, [ebp+var_38]
		mov	[esp+0B8h+var_A4], ecx ; int
		mov	ecx, [ebp+var_18]
		mov	[esp+0B8h+var_A8], ecx ; int
		mov	[esp+0B8h+var_AC], 2 ; size_t
		mov	[esp+0B8h+Size], eax ; void *
		mov	eax, [ebp+var_14]
		mov	[esp+0B8h+Src],	eax ; int
		mov	[esp+0B8h+Dst],	edx ; char
		call	sub_40DB1A
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_412727
		mov	eax, [ebp+var_1C]
		mov	[esp+0B8h+Dst],	eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+0B8h+Dst],	offset aReadingPublicK ; "reading public key failed: %s\n"
		call	sub_43C238
		mov	[esp+0B8h+Src],	ebx ; char
		mov	[esp+0B8h+Dst],	eax ; char *
		call	sub_43CB21
		jmp	loc_412BA5
; ---------------------------------------------------------------------------

loc_412727:				; CODE XREF: sub_41257F+17Cj
		mov	edx, dword ptr [ebp+var_44]
		mov	eax, [ebp+var_38]
		lea	ecx, [ebp+var_48]
		mov	[esp+0B8h+var_AC], ecx
		mov	[esp+0B8h+Size], 7F49h
		mov	[esp+0B8h+Src],	edx ; char
		mov	[esp+0B8h+Dst],	eax
		call	sub_42D39C
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_412779
		mov	[esp+0B8h+Dst],	6Ch
		call	sub_410197
		mov	[ebp+var_1C], eax
		mov	[esp+0B8h+Dst],	offset aResponseDoesNo ; "response does	not contain the	public ke"...
		call	sub_43C238
		mov	[esp+0B8h+Dst],	eax ; char *
		call	sub_43CB21
		jmp	loc_412BA5
; ---------------------------------------------------------------------------

loc_412779:				; CODE XREF: sub_41257F+1D0j
		mov	eax, dword ptr [ebp+var_48]
		lea	edx, [ebp+var_4C]
		mov	[esp+0B8h+var_AC], edx
		mov	[esp+0B8h+Size], 81h
		mov	[esp+0B8h+Src],	eax ; char
		mov	eax, [ebp+var_24]
		mov	[esp+0B8h+Dst],	eax
		call	sub_42D39C
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		test	eax, eax
		jnz	short loc_4127CC
		mov	[esp+0B8h+Dst],	6Ch
		call	sub_410197
		mov	[ebp+var_1C], eax
		mov	[esp+0B8h+Dst],	offset aResponseDoes_0 ; "response does	not contain the	RSA modul"...
		call	sub_43C238
		mov	[esp+0B8h+Dst],	eax ; char *
		call	sub_43CB21
		jmp	loc_412BA5
; ---------------------------------------------------------------------------

loc_4127CC:				; CODE XREF: sub_41257F+223j
		mov	eax, dword ptr [ebp+var_48]
		lea	edx, [ebp+var_50]
		mov	[esp+0B8h+var_AC], edx
		mov	[esp+0B8h+Size], 82h
		mov	[esp+0B8h+Src],	eax ; char
		mov	eax, [ebp+var_24]
		mov	[esp+0B8h+Dst],	eax
		call	sub_42D39C
		mov	[ebp+var_40], eax
		mov	eax, [ebp+var_40]
		test	eax, eax
		jnz	short loc_41281F
		mov	[esp+0B8h+Dst],	6Ch
		call	sub_410197
		mov	[ebp+var_1C], eax
		mov	[esp+0B8h+Dst],	offset aResponseDoes_1 ; "response does	not contain the	RSA publi"...
		call	sub_43C238
		mov	[esp+0B8h+Dst],	eax ; char *
		call	sub_43CB21
		jmp	loc_412BA5
; ---------------------------------------------------------------------------

loc_41281F:				; CODE XREF: sub_41257F+276j
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jz	short loc_412887
		mov	eax, [ebp+var_3C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_412887
		mov	eax, [ebp+var_4C]
		add	eax, 1
		mov	[esp+0B8h+Dst],	eax
		call	gcry_malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_412854
		call	sub_4101BF
		mov	[ebp+var_1C], eax
		jmp	loc_412BA5
; ---------------------------------------------------------------------------

loc_412854:				; CODE XREF: sub_41257F+2C6j
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	ecx, [ebp+var_4C]
		mov	eax, [ebp+var_3C]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Src],	edx ; Src
		mov	[esp+0B8h+Dst],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_4C]
		add	eax, 1
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+var_3C], eax

loc_412887:				; CODE XREF: sub_41257F+2A5j
					; sub_41257F+2AFj
		mov	eax, [ebp+var_50]
		test	eax, eax
		jz	loc_412A3A
		mov	eax, [ebp+var_40]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	loc_412A3A
		mov	eax, [ebp+var_50]
		add	eax, 1
		mov	[esp+0B8h+Dst],	eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4128C4
		call	sub_4101BF
		mov	[ebp+var_1C], eax
		jmp	loc_412BA5
; ---------------------------------------------------------------------------

loc_4128C4:				; CODE XREF: sub_41257F+336j
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	ecx, [ebp+var_50]
		mov	eax, [ebp+var_40]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Src],	edx ; Src
		mov	[esp+0B8h+Dst],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_50]
		add	eax, 1
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_40], eax
		jmp	loc_412A3A
; ---------------------------------------------------------------------------

loc_4128FC:				; CODE XREF: sub_41257F+E2j
		mov	[ebp+Command], 0
		mov	[ebp+var_38], 0
		lea	eax, [ebp+var_7D]
		mov	[esp+0B8h+Size], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0B8h+Src],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+Dst],	eax
		call	sub_412193
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_41294C
		mov	eax, [ebp+var_1C]
		mov	[esp+0B8h+Dst],	eax
		call	gpg_strerror
		mov	[esp+0B8h+Src],	eax ; char
		mov	[esp+0B8h+Dst],	offset aErrorWhileRetr ; "error	while retrieving fpr from card:	%"...
		call	sub_43CB21
		jmp	loc_412BA5
; ---------------------------------------------------------------------------

loc_41294C:				; CODE XREF: sub_41257F+3ABj
		lea	eax, [ebp+var_7D]
		add	eax, 18h
		mov	[ebp+Str2], eax
		lea	eax, [ebp+var_7D]
		mov	[esp+0B8h+Size], eax
		mov	[esp+0B8h+Src],	offset aGpgListKeysWit ; "gpg --list-keys --with-colons	--with-ke"...
		lea	eax, [ebp+Command]
		mov	[esp+0B8h+Dst],	eax
		call	sub_429E78
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jns	short loc_412985
		call	sub_4101BF
		mov	[ebp+var_1C], eax
		jmp	loc_412BA5
; ---------------------------------------------------------------------------

loc_412985:				; CODE XREF: sub_41257F+3F7j
		mov	eax, [ebp+Command]
		mov	[esp+0B8h+Src],	offset aR_0 ; "r"
		mov	[esp+0B8h+Dst],	eax ; Command
		mov	eax, ds:_popen
		call	eax ; _popen
		mov	[ebp+File], eax
		mov	eax, [ebp+Command]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_free
		cmp	[ebp+File], 0
		jnz	short loc_4129D6
		call	sub_4101BF
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0B8h+Dst],	eax
		call	gpg_strerror
		mov	[esp+0B8h+Src],	eax ; char
		mov	[esp+0B8h+Dst],	offset aRunningGpgFail ; "running gpg failed: %s\n"
		call	sub_43CB21
		jmp	loc_412BA5
; ---------------------------------------------------------------------------

loc_4129D6:				; CODE XREF: sub_41257F+42Dj
		lea	eax, [ebp+var_50]
		mov	[esp+0B8h+var_A4], eax ; int
		lea	eax, [ebp+var_40]
		mov	[esp+0B8h+var_A8], eax ; int
		lea	eax, [ebp+var_4C]
		mov	[esp+0B8h+var_AC], eax ; int
		lea	eax, [ebp+var_3C]
		mov	[esp+0B8h+Size], eax ; int
		mov	eax, [ebp+Str2]
		mov	[esp+0B8h+Src],	eax ; Str2
		mov	eax, [ebp+File]
		mov	[esp+0B8h+Dst],	eax ; FILE *
		call	sub_412250
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+File]
		mov	[esp+0B8h+Dst],	eax ; File
		mov	eax, ds:_pclose
		call	eax ; _pclose
		cmp	[ebp+var_1C], 0
		jz	short loc_412A3A
		mov	eax, [ebp+var_1C]
		mov	[esp+0B8h+Dst],	eax
		call	gpg_strerror
		mov	[esp+0B8h+Src],	eax ; char
		mov	[esp+0B8h+Dst],	offset aErrorWhileRe_0 ; "error	while retrieving key material thr"...
		call	sub_43CB21
		jmp	loc_412BA5
; ---------------------------------------------------------------------------

loc_412A3A:				; CODE XREF: sub_41257F+30Dj
					; sub_41257F+31Bj ...
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_50]
		add	eax, edx
		add	eax, 79h
		mov	[esp+0B8h+Dst],	eax
		call	gcry_malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jnz	short loc_412A63
		call	sub_4101BF
		mov	[ebp+var_1C], eax
		jmp	loc_412BA5
; ---------------------------------------------------------------------------

loc_412A63:				; CODE XREF: sub_41257F+4D5j
		mov	edx, [ebp+var_4C]
		mov	eax, offset a10PublicKey3Rs ; "(10:public-key(3:rsa(1:n%u:"
		mov	[esp+0B8h+Size], edx
		mov	[esp+0B8h+Src],	eax ; Format
		mov	eax, [ebp+Dest]
		mov	[esp+0B8h+Dst],	eax ; Dest
		call	sprintf
		mov	eax, [ebp+Dest]
		mov	[ebp+var_8C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_8C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+Dest]
		mov	[ebp+var_34], eax
		mov	ecx, [ebp+var_4C]
		mov	eax, [ebp+var_3C]
		mov	edx, eax
		mov	eax, [ebp+var_34]
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Src],	edx ; Src
		mov	[esp+0B8h+Dst],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_4C]
		add	[ebp+var_34], eax
		mov	edx, [ebp+var_50]
		mov	eax, offset a1EU ; ")(1:e%u:"
		mov	[esp+0B8h+Size], edx
		mov	[esp+0B8h+Src],	eax ; Format
		mov	eax, [ebp+var_34]
		mov	[esp+0B8h+Dst],	eax ; Dest
		call	sprintf
		mov	eax, [ebp+var_34]
		mov	[ebp+var_8C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_8C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_34], eax
		mov	ecx, [ebp+var_50]
		mov	eax, [ebp+var_40]
		mov	edx, eax
		mov	eax, [ebp+var_34]
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Src],	edx ; Src
		mov	[esp+0B8h+Dst],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_50]
		add	[ebp+var_34], eax
		mov	edx, offset asc_44A9CB ; ")))"
		mov	eax, [ebp+var_34]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, [ebp+var_34]
		mov	[ebp+var_8C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_8C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		lea	edx, [eax+8]
		mov	eax, [ebp+Dest]
		mov	[edx], eax
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+1Ch]
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+Dest]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	ecx, eax
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ebx
		add	eax, 0Ch
		mov	[eax], ecx

loc_412BA5:				; CODE XREF: sub_41257F+1A3j
					; sub_41257F+1F5j ...
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 4
		mov	dword ptr [eax], 1
		mov	eax, [ebp+var_38]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[esp+0B8h+Dst],	eax
		call	gcry_free
		mov	eax, 0

loc_412BE8:				; CODE XREF: sub_41257F+3Fj
					; sub_41257F+6Aj
		add	esp, 0B0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41257F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_412BF2	proc near		; CODE XREF: sub_412D77+1DFp
					; sub_412D77+1F9p ...

Dest		= dword	ptr -0B8h
Format		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_8C		= dword	ptr -8Ch
var_7B		= byte ptr -7Bh
var_49		= byte ptr -49h
var_20		= byte ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0B0h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+0B8h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+Dest], eax
		call	sub_41257F
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_412D63
		cmp	[ebp+arg_8], 0
		jle	short loc_412C2F
		cmp	[ebp+arg_8], 3
		jle	short loc_412C4D

loc_412C2F:				; CODE XREF: sub_412BF2+35j
		mov	[esp+0B8h+var_B0], 56Bh	; int
		mov	[esp+0B8h+Format], offset a____Gnupg22__2 ; "../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+0B8h+Dest], offset	aKeyno1Keyno3 ;	"keyno >= 1 && keyno <=	3"
		call	sub_442650
		jmp	short loc_412C4E
; ---------------------------------------------------------------------------

loc_412C4D:				; CODE XREF: sub_412BF2+3Bj
		nop

loc_412C4E:				; CODE XREF: sub_412BF2+59j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	eax, [ebp+arg_8]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 8
		mov	eax, [eax]
		test	eax, eax
		jz	loc_412D66
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	eax, [ebp+arg_8]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 0Ch
		mov	ecx, [eax]
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+1Ch]
		mov	eax, [ebp+arg_8]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ebx
		add	eax, 8
		mov	eax, [eax]
		lea	edx, [ebp+var_20]
		mov	[esp+0B8h+var_B0], edx
		mov	[esp+0B8h+Format], ecx
		mov	[esp+0B8h+Dest], eax
		call	sub_42DD89
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_412D69
		lea	eax, [ebp+var_49]
		mov	[esp+0B8h+var_B0], eax
		mov	[esp+0B8h+Format], 14h
		lea	eax, [ebp+var_20]
		mov	[esp+0B8h+Dest], eax
		call	sub_42BDA4
		mov	eax, offset aOpenpgp_D ; "OPENPGP.%d"
		mov	edx, [ebp+arg_8]
		mov	[esp+0B8h+var_B0], edx
		mov	[esp+0B8h+Format], eax ; Format
		lea	eax, [ebp+var_7B]
		mov	[esp+0B8h+Dest], eax ; Dest
		call	sprintf
		lea	eax, [ebp+var_7B]
		mov	[ebp+var_8C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_8C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+0B8h+var_9C], 0
		mov	[esp+0B8h+var_A0], 0
		mov	[esp+0B8h+var_A4], eax
		lea	eax, [ebp+var_7B]
		mov	[esp+0B8h+var_A8], eax
		mov	[esp+0B8h+var_AC], 28h
		lea	eax, [ebp+var_49]
		mov	[esp+0B8h+var_B0], eax
		mov	[esp+0B8h+Format], offset aKeypairinfo_0 ; "KEYPAIRINFO"
		mov	eax, [ebp+arg_4]
		mov	[esp+0B8h+Dest], eax
		call	sub_406FDB
		jmp	short loc_412D6A
; ---------------------------------------------------------------------------

loc_412D63:				; CODE XREF: sub_412BF2+2Bj
		nop
		jmp	short loc_412D6A
; ---------------------------------------------------------------------------

loc_412D66:				; CODE XREF: sub_412BF2+7Aj
		nop
		jmp	short loc_412D6A
; ---------------------------------------------------------------------------

loc_412D69:				; CODE XREF: sub_412BF2+D2j
		nop

loc_412D6A:				; CODE XREF: sub_412BF2+16Fj
					; sub_412BF2+172j ...
		mov	eax, [ebp+var_C]
		add	esp, 0B0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_412BF2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_412D77	proc near		; DATA XREF: sub_418EB5+5D4o

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_10], offset aExtcap ; "EXTCAP"
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_41199B
		mov	[esp+18h+var_10], offset aDispName ; "DISP-NAME"
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_41199B
		mov	[esp+18h+var_10], offset aDispLang ; "DISP-LANG"
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_41199B
		mov	[esp+18h+var_10], offset aDispSex ; "DISP-SEX"
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_41199B
		mov	[esp+18h+var_10], offset aPubkeyUrl ; "PUBKEY-URL"
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_41199B
		mov	[esp+18h+var_10], offset aLoginData ; "LOGIN-DATA"
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_41199B
		mov	[esp+18h+var_10], offset aKeyFpr ; "KEY-FPR"
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_41199B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 100h
		jbe	short loc_412E5A
		mov	[esp+18h+var_10], offset aKeyTime ; "KEY-TIME"
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_41199B

loc_412E5A:				; CODE XREF: sub_412D77+C7j
		mov	[esp+18h+var_10], offset aCaFpr	; "CA-FPR"
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_41199B
		mov	[esp+18h+var_10], offset aChvStatus ; "CHV-STATUS"
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_41199B
		mov	[esp+18h+var_10], offset aSigCounter ; "SIG-COUNTER"
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_41199B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 10h
		test	al, al
		jz	loc_412F41
		mov	[esp+18h+var_10], offset aPrivateDo1 ; "PRIVATE-DO-1"
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_41199B
		mov	[esp+18h+var_10], offset aPrivateDo2 ; "PRIVATE-DO-2"
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_41199B
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+18h]
		and	eax, 4
		test	al, al
		jz	short loc_412F19
		mov	[esp+18h+var_10], offset aPrivateDo3 ; "PRIVATE-DO-3"
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_41199B

loc_412F19:				; CODE XREF: sub_412D77+186j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+18h]
		and	eax, 8
		test	al, al
		jz	short loc_412F41
		mov	[esp+18h+var_10], offset aPrivateDo4 ; "PRIVATE-DO-4"
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_41199B

loc_412F41:				; CODE XREF: sub_412D77+140j
					; sub_412D77+1AEj
		mov	[esp+18h+var_10], 1
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_412BF2
		mov	[esp+18h+var_10], 2
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_412BF2
		mov	[esp+18h+var_10], 3
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_412BF2
		mov	eax, 0
		leave
		retn
sub_412D77	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_412F96(int, char *, int, int)
sub_412F96	proc near		; DATA XREF: sub_418EB5+5E8o

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
Size		= dword	ptr -20h
Src		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+Str2],	offset aOpenpgp_1 ; "OPENPGP.1"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_412FBC
		mov	[ebp+var_C], 1
		jmp	short loc_41300D
; ---------------------------------------------------------------------------

loc_412FBC:				; CODE XREF: sub_412F96+1Bj
		mov	[esp+28h+Str2],	offset aOpenpgp_2 ; "OPENPGP.2"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_412FDC
		mov	[ebp+var_C], 2
		jmp	short loc_41300D
; ---------------------------------------------------------------------------

loc_412FDC:				; CODE XREF: sub_412F96+3Bj
		mov	[esp+28h+Str2],	offset aOpenpgp_3 ; "OPENPGP.3"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_412FFC
		mov	[ebp+var_C], 3
		jmp	short loc_41300D
; ---------------------------------------------------------------------------

loc_412FFC:				; CODE XREF: sub_412F96+5Bj
		mov	[esp+28h+Str1],	76h
		call	sub_410197
		jmp	locret_4130D9
; ---------------------------------------------------------------------------

loc_41300D:				; CODE XREF: sub_412F96+24j
					; sub_412F96+44j ...
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str1],	eax
		call	sub_41257F
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_413030
		mov	eax, [ebp+var_10]
		jmp	locret_4130D9
; ---------------------------------------------------------------------------

loc_413030:				; CODE XREF: sub_412F96+90j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	eax, [ebp+var_C]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 8
		mov	eax, [eax]
		mov	[ebp+Src], eax
		cmp	[ebp+Src], 0
		jnz	short loc_413063
		mov	[esp+28h+Str1],	9
		call	sub_410197
		jmp	short locret_4130D9
; ---------------------------------------------------------------------------

loc_413063:				; CODE XREF: sub_412F96+BDj
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	eax, [ebp+var_C]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 0Ch
		mov	edx, [eax]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		mov	[esp+28h+Str1],	eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4130B7
		call	sub_4101BF
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_10]
		jmp	short locret_4130D9
; ---------------------------------------------------------------------------

loc_4130B7:				; CODE XREF: sub_412F96+109j
		mov	eax, [ebp+arg_C]
		mov	ecx, [eax]
		mov	edx, [ebp+Src]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Str2],	edx ; Src
		mov	[esp+28h+Str1],	eax ; Dst
		call	memcpy
		mov	eax, 0

locret_4130D9:				; CODE XREF: sub_412F96+72j
					; sub_412F96+95j ...
		leave
		retn
sub_412F96	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4130DB(int, char *, int, int)
sub_4130DB	proc near		; DATA XREF: sub_418EB5+5DEo

Str1		= dword	ptr -38h
Str2		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
Src		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	[esp+38h+Str2],	offset aOpenpgp_3 ; "OPENPGP.3"
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_41311B
		mov	[esp+38h+Str1],	76h
		call	sub_410197
		jmp	locret_4131F4
; ---------------------------------------------------------------------------

loc_41311B:				; CODE XREF: sub_4130DB+2Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 1
		test	al, al
		jnz	short loc_41313D
		mov	[esp+38h+Str1],	1Bh
		call	sub_410197
		jmp	locret_4131F4
; ---------------------------------------------------------------------------

loc_41313D:				; CODE XREF: sub_4130DB+4Fj
		mov	[esp+38h+var_28], 0
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_2C], eax
		lea	eax, [ebp+Src]
		mov	[esp+38h+Size],	eax
		mov	[esp+38h+Str2],	7F21h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	sub_41075F
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41317D
		mov	[esp+38h+Str1],	1Bh
		call	sub_410197
		jmp	short locret_4131F4
; ---------------------------------------------------------------------------

loc_41317D:				; CODE XREF: sub_4130DB+92j
		mov	eax, [ebp+var_18]
		test	eax, eax
		jnz	short loc_413195
		mov	[esp+38h+Str1],	1Bh
		call	sub_410197
		mov	[ebp+var_C], eax
		jmp	short loc_4131E6
; ---------------------------------------------------------------------------

loc_413195:				; CODE XREF: sub_4130DB+A7j
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Str1],	eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4131BA
		call	sub_4101BF
		mov	[ebp+var_C], eax
		jmp	short loc_4131E6
; ---------------------------------------------------------------------------

loc_4131BA:				; CODE XREF: sub_4130DB+D3j
		mov	ecx, [ebp+var_18]
		mov	eax, [ebp+Src]
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Str2],	edx ; Src
		mov	[esp+38h+Str1],	eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_4131E6:				; CODE XREF: sub_4130DB+B8j
					; sub_4130DB+DDj
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+var_C]

locret_4131F4:				; CODE XREF: sub_4130DB+3Bj
					; sub_4130DB+5Dj ...
		leave
		retn
sub_4130DB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4131F6	proc near		; CODE XREF: sub_41327A+20Dp
					; sub_413993+E4p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+44h]
		and	eax, 1
		test	al, al
		jnz	short loc_413221
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41321A
		mov	eax, 0
		jmp	short loc_413278
; ---------------------------------------------------------------------------

loc_41321A:				; CODE XREF: sub_4131F6+1Bj
		mov	eax, 1
		jmp	short loc_413278
; ---------------------------------------------------------------------------

loc_413221:				; CODE XREF: sub_4131F6+12j
		cmp	[ebp+arg_8], 0
		jz	short loc_413237
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [eax+4Ch]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		jmp	short loc_413245
; ---------------------------------------------------------------------------

loc_413237:				; CODE XREF: sub_4131F6+2Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [eax+48h]
		mov	eax, [ebp+arg_4]
		mov	[eax], edx

loc_413245:				; CODE XREF: sub_4131F6+3Fj
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_41326C
		mov	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		cmp	edx, eax
		jl	short loc_41326C
		mov	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		cmp	edx, eax
		jle	short loc_413273

loc_41326C:				; CODE XREF: sub_4131F6+56j
					; sub_4131F6+65j
		mov	eax, 1
		jmp	short loc_413278
; ---------------------------------------------------------------------------

loc_413273:				; CODE XREF: sub_4131F6+74j
		mov	eax, 0

loc_413278:				; CODE XREF: sub_4131F6+22j
					; sub_4131F6+29j ...
		pop	ebp
		retn
sub_4131F6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41327A	proc near		; CODE XREF: sub_4136EE+4Bp
					; sub_4170F2+96Ap

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_18], 6
		cmp	dword ptr [ebp+arg_C], 1
		jz	short loc_4132C1
		cmp	dword ptr [ebp+arg_C], 2
		jz	short loc_4132C1
		mov	[esp+48h+var_40], 638h ; int
		mov	[esp+48h+var_44], offset a____Gnupg22__2 ; "../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+48h+var_48], offset aChvno1Chvno2 ; "chvno	== 1 ||	chvno == 2"
		call	sub_442650
		jmp	short loc_4132C2
; ---------------------------------------------------------------------------

loc_4132C1:				; CODE XREF: sub_41327A+21j
					; sub_41327A+27j
		nop

loc_4132C2:				; CODE XREF: sub_41327A+45j
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0
		cmp	dword ptr [ebp+arg_C], 2
		jnz	loc_413383
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+40h]
		and	eax, 2
		test	al, al
		jz	loc_413383
		mov	eax, ds:dword_451D24
		test	eax, eax
		jz	short loc_41330F
		mov	[esp+48h+var_48], offset aUsingDefaultPi ; "using default PIN as %s\n"
		call	sub_43C238
		mov	[esp+48h+var_44], offset aChv2 ; "CHV2"
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CAF7

loc_41330F:				; CODE XREF: sub_41327A+77j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+48h+var_3C], 6 ; size_t
		mov	[esp+48h+var_40], offset a123456 ; "123456"
		mov	[esp+48h+var_44], 82h ;	int
		mov	[esp+48h+var_48], eax ;	char
		call	sub_40D14D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41337B
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+48h+var_48], offset aFailedToUseDef ; "failed to use default PIN as %s: %s	- d"...
		call	sub_43C238
		mov	[esp+48h+var_40], ebx
		mov	[esp+48h+var_44], offset aChv2 ; "CHV2"
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CAF7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	edx, byte ptr [eax+40h]
		and	edx, 0FFFFFFFDh
		mov	[eax+40h], dl

loc_41337B:				; CODE XREF: sub_41327A+C2j
		mov	eax, [ebp+var_C]
		jmp	loc_4136E7
; ---------------------------------------------------------------------------

loc_413383:				; CODE XREF: sub_41327A+55j
					; sub_41327A+6Aj
		lea	eax, [ebp+var_28]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+var_28], 0FFFFFFFFh
		mov	eax, [ebp+var_18]
		mov	[ebp+var_24], eax
		cmp	dword ptr [ebp+arg_C], 1
		jnz	loc_413431
		mov	[esp+48h+var_48], offset aPleaseEnterThe ; "||Please enter the PIN%%0A[sigs done: %"...
		call	sub_43C238
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 32h
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4133FD
		call	sub_4101BF
		jmp	loc_4136E7
; ---------------------------------------------------------------------------

loc_4133FD:				; CODE XREF: sub_41327A+177j
		mov	[esp+48h+var_48], offset aPleaseEnterThe ; "||Please enter the PIN%%0A[sigs done: %"...
		call	sub_43C238
		mov	edx, [ebp+var_1C]
		lea	ecx, [edx-1]
		mov	edx, [ebp+arg_10]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+var_44], ecx
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	sub_429C1D
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		jmp	short loc_413440
; ---------------------------------------------------------------------------

loc_413431:				; CODE XREF: sub_41327A+131j
		mov	[esp+48h+var_48], offset aPleaseEnterT_0 ; "||Please enter the PIN"
		call	sub_43C238
		mov	[ebp+var_14], eax

loc_413440:				; CODE XREF: sub_41327A+1B5j
		mov	eax, ds:dword_451D48
		test	eax, eax
		jnz	loc_41356C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_28]
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], 20h
		mov	[esp+48h+var_48], eax
		call	sub_40D0D7
		test	eax, eax
		jnz	loc_41356C
		mov	[esp+48h+var_40], 0
		lea	eax, [ebp+var_28]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_4131F6
		test	eax, eax
		jnz	loc_41356C
		mov	[esp+48h+var_40], 0
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_48], eax
		mov	eax, [ebp+arg_4]
		call	eax
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	[ebp+var_10], 0
		cmp	[ebp+var_C], 0
		jz	short loc_4134FD
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+48h+var_48], offset aPinCallbackRet ; "PIN	callback returned error: %s\n"
		call	sub_43C238
		mov	[esp+48h+var_44], ebx ;	char
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CAF7
		mov	eax, [ebp+var_C]
		jmp	loc_4136E7
; ---------------------------------------------------------------------------

loc_4134FD:				; CODE XREF: sub_41327A+254j
		mov	eax, dword ptr [ebp+arg_C]
		lea	ecx, [eax+80h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_28]
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], ecx
		mov	[esp+48h+var_48], eax
		call	sub_40D106
		mov	[ebp+var_C], eax
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+var_44], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_48], eax
		mov	eax, [ebp+arg_4]
		call	eax
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_413567
		mov	[esp+48h+var_40], 679h ; int
		mov	[esp+48h+var_44], offset a____Gnupg22__2 ; "../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+48h+var_48], offset aPinvalue ; "!*pinvalue"
		call	sub_442650
		jmp	loc_413691
; ---------------------------------------------------------------------------

loc_413567:				; CODE XREF: sub_41327A+2CAj
		jmp	loc_413691
; ---------------------------------------------------------------------------

loc_41356C:				; CODE XREF: sub_41327A+1CDj
					; sub_41327A+1F2j ...
		mov	eax, [ebp+arg_14]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_48], eax
		mov	eax, [ebp+arg_4]
		call	eax
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	[ebp+var_10], 0
		cmp	[ebp+var_C], 0
		jz	short loc_4135D4
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+48h+var_48], offset aPinCallbackRet ; "PIN	callback returned error: %s\n"
		call	sub_43C238
		mov	[esp+48h+var_44], ebx ;	char
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CAF7
		mov	eax, [ebp+var_C]
		jmp	loc_4136E7
; ---------------------------------------------------------------------------

loc_4135D4:				; CODE XREF: sub_41327A+32Bj
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_18]
		cmp	edx, eax
		jnb	short loc_413645
		mov	[esp+48h+var_48], offset aPinForChvDIsTo ; "PIN	for CHV%d is too short;	minimum	len"...
		call	sub_43C238
		mov	edx, [ebp+var_18]
		mov	[esp+48h+var_40], edx
		mov	edx, dword ptr [ebp+arg_C]
		mov	[esp+48h+var_44], edx ;	char
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CB21
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0
		mov	[esp+48h+var_48], 57h
		call	sub_410197
		jmp	loc_4136E7
; ---------------------------------------------------------------------------

loc_413645:				; CODE XREF: sub_41327A+380j
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+arg_14]
		mov	edx, [eax]
		mov	eax, dword ptr [ebp+arg_C]
		lea	ecx, [eax+80h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+48h+var_3C], ebx ;	size_t
		mov	[esp+48h+var_40], edx ;	void *
		mov	[esp+48h+var_44], ecx ;	int
		mov	[esp+48h+var_48], eax ;	char
		call	sub_40D14D
		mov	[ebp+var_C], eax

loc_413691:				; CODE XREF: sub_41327A+2E8j
					; sub_41327A:loc_413567j
		cmp	[ebp+var_C], 0
		jz	short loc_4136E4
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+48h+var_48], offset aVerifyChvDFail ; "verify CHV%d failed: %s\n"
		call	sub_43C238
		mov	[esp+48h+var_40], ebx
		mov	edx, dword ptr [ebp+arg_C]
		mov	[esp+48h+var_44], edx ;	char
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CB21
		mov	eax, [ebp+arg_14]
		mov	eax, [eax]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41069F

loc_4136E4:				; CODE XREF: sub_41327A+41Bj
		mov	eax, [ebp+var_C]

loc_4136E7:				; CODE XREF: sub_41327A+104j
					; sub_41327A+17Ej ...
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41327A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4136EE	proc near		; CODE XREF: sub_413C94+134p
					; sub_414024+14Ep ...

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+18h]
		and	eax, 4
		test	al, al
		jz	short loc_41370E
		mov	eax, 0
		jmp	loc_413848
; ---------------------------------------------------------------------------

loc_41370E:				; CODE XREF: sub_4136EE+14j
		lea	eax, [ebp+var_10]
		mov	[esp+48h+var_34], eax
		mov	[esp+48h+var_38], 0
		mov	[esp+48h+var_3C], 2
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41327A
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41374F
		mov	eax, [ebp+var_C]
		jmp	loc_413848
; ---------------------------------------------------------------------------

loc_41374F:				; CODE XREF: sub_4136EE+57j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		or	edx, 4
		mov	[eax+18h], dl
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+18h]
		and	eax, 1
		test	al, al
		jnz	loc_41383A
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+18h]
		and	eax, 2
		test	al, al
		jnz	loc_41383A
		mov	eax, [ebp+var_10]
		test	eax, eax
		jz	loc_41383A
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ecx, [eax-1]
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+48h+var_3C], ecx ;	size_t
		mov	[esp+48h+var_40], edx ;	void *
		mov	dword ptr [esp+48h+var_44], 81h	; int
		mov	[esp+48h+var_48], eax ;	char
		call	sub_40D14D
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	sub_4101B2
		cmp	eax, 57h
		jnz	short loc_4137ED
		mov	[esp+48h+var_48], 84h
		call	sub_410197
		mov	[ebp+var_C], eax

loc_4137ED:				; CODE XREF: sub_4136EE+EEj
		cmp	[ebp+var_C], 0
		jz	short loc_41382D
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+48h+var_48], offset aVerifyChvDFail ; "verify CHV%d failed: %s\n"
		call	sub_43C238
		mov	[esp+48h+var_40], ebx
		mov	dword ptr [esp+48h+var_44], 1 ;	char
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CB21
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41069F
		jmp	short loc_41383A
; ---------------------------------------------------------------------------

loc_41382D:				; CODE XREF: sub_4136EE+103j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		or	edx, 1
		mov	[eax+18h], dl

loc_41383A:				; CODE XREF: sub_4136EE+7Aj
					; sub_4136EE+8Cj ...
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_C]

loc_413848:				; CODE XREF: sub_4136EE+1Bj
					; sub_4136EE+5Cj
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4136EE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41384F	proc near		; CODE XREF: sub_413993+87p
					; sub_414024+27Cp

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	[esp+48h+var_38], 0
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+var_3C], eax
		lea	eax, [ebp+var_18]
		mov	[esp+48h+var_40], eax
		mov	dword ptr [esp+48h+var_44], 0C4h ; char
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41075F
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_413898
		mov	eax, [ebp+var_1C]
		cmp	eax, 6
		ja	short loc_4138C8

loc_413898:				; CODE XREF: sub_41384F+3Fj
		mov	[esp+48h+var_48], offset aErrorRetrievin ; "error retrieving CHV status	from card\n"
		call	sub_43C238
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CB21
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	[esp+48h+var_48], 6Ch
		call	sub_410197
		jmp	locret_413991
; ---------------------------------------------------------------------------

loc_4138C8:				; CODE XREF: sub_41384F+47j
		mov	eax, [ebp+var_18]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_413905
		mov	[esp+48h+var_48], offset aCardIsPermanen ; "card is permanently	locked!\n"
		call	sub_43C238
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CAF7
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	[esp+48h+var_48], 57h
		call	sub_410197
		jmp	locret_413991
; ---------------------------------------------------------------------------

loc_413905:				; CODE XREF: sub_41384F+84j
		mov	eax, [ebp+var_18]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	dword ptr [ebp+var_14],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	[esp+48h+var_48], offset aDAdminPinAttem ; "%d Admin PIN attempts remaining before "...
		call	sub_43C238
		mov	edx, dword ptr [ebp+var_14]
		mov	dword ptr [esp+48h+var_44], edx	; char
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CAF7
		cmp	dword ptr [ebp+var_14],	2
		jg	short loc_413960
		mov	[esp+48h+var_48], offset aAPleaseEnterTh ; "|A|Please enter the	Admin PIN%%0A[remai"...
		call	sub_43C238
		mov	edx, dword ptr [ebp+var_14]
		mov	dword ptr [esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	sub_42EC0D
		mov	[ebp+var_C], eax
		jmp	short loc_413977
; ---------------------------------------------------------------------------

loc_413960:				; CODE XREF: sub_41384F+EFj
		mov	[esp+48h+var_48], offset aAPleaseEnter_0 ; "|A|Please enter the	Admin PIN"
		call	sub_43C238
		mov	[esp+48h+var_48], eax
		call	gcry_strdup
		mov	[ebp+var_C], eax

loc_413977:				; CODE XREF: sub_41384F+10Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_413984
		call	sub_4101BF
		jmp	short locret_413991
; ---------------------------------------------------------------------------

loc_413984:				; CODE XREF: sub_41384F+12Cj
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, 0

locret_413991:				; CODE XREF: sub_41384F+74j
					; sub_41384F+B1j ...
		leave
		retn
sub_41384F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413993	proc near		; CODE XREF: sub_413C94+152p
					; sub_414024+DAp ...

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		mov	[ebp+var_C], 0
		mov	eax, ds:dword_451D50
		test	eax, eax
		jnz	short loc_4139D0
		mov	[esp+48h+var_48], offset aAccessToAdminC ; "access to admin commands is	not configu"...
		call	sub_43C238
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CAF7
		mov	[esp+48h+var_48], 8001h
		call	sub_410197
		jmp	loc_413C8D
; ---------------------------------------------------------------------------

loc_4139D0:				; CODE XREF: sub_413993+16j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+18h]
		and	eax, 8
		test	al, al
		jnz	loc_413C8A
		mov	[ebp+var_10], 8
		lea	eax, [ebp+var_1C]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	eax, [ebp+var_10]
		mov	[ebp+var_18], eax
		lea	eax, [ebp+var_20]
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41384F
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_413A30
		mov	eax, [ebp+var_C]
		jmp	loc_413C8D
; ---------------------------------------------------------------------------

loc_413A30:				; CODE XREF: sub_413993+93j
		mov	eax, ds:dword_451D48
		test	eax, eax
		jnz	loc_413B26
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_1C]
		mov	[esp+48h+var_40], edx
		mov	dword ptr [esp+48h+var_44], 20h
		mov	[esp+48h+var_48], eax
		call	sub_40D0D7
		test	eax, eax
		jnz	loc_413B26
		mov	[esp+48h+var_40], 1
		lea	eax, [ebp+var_1C]
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_4131F6
		test	eax, eax
		jnz	loc_413B26
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_40], 0
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_48], eax
		mov	eax, [ebp+arg_4]
		call	eax
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	[ebp+var_20], 0
		cmp	[ebp+var_C], 0
		jz	short loc_413AE6
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+48h+var_48], offset aPinCallbackRet ; "PIN	callback returned error: %s\n"
		call	sub_43C238
		mov	dword ptr [esp+48h+var_44], ebx	; char
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CAF7
		mov	eax, [ebp+var_C]
		jmp	loc_413C8D
; ---------------------------------------------------------------------------

loc_413AE6:				; CODE XREF: sub_413993+124j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_1C]
		mov	[esp+48h+var_40], edx
		mov	dword ptr [esp+48h+var_44], 83h
		mov	[esp+48h+var_48], eax
		call	sub_40D106
		mov	[ebp+var_C], eax
		mov	[esp+48h+var_40], 0
		mov	dword ptr [esp+48h+var_44], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_48], eax
		mov	eax, [ebp+arg_4]
		call	eax
		jmp	loc_413C3A
; ---------------------------------------------------------------------------

loc_413B26:				; CODE XREF: sub_413993+A4j
					; sub_413993+C9j ...
		mov	eax, [ebp+var_20]
		lea	edx, [ebp+var_24]
		mov	[esp+48h+var_40], edx
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_48], eax
		mov	eax, [ebp+arg_4]
		call	eax
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	[ebp+var_20], 0
		cmp	[ebp+var_C], 0
		jz	short loc_413B87
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+48h+var_48], offset aPinCallbackRet ; "PIN	callback returned error: %s\n"
		call	sub_43C238
		mov	dword ptr [esp+48h+var_44], ebx	; char
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CAF7
		mov	eax, [ebp+var_C]
		jmp	loc_413C8D
; ---------------------------------------------------------------------------

loc_413B87:				; CODE XREF: sub_413993+1C5j
		mov	eax, [ebp+var_24]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_10]
		cmp	edx, eax
		jnb	short loc_413BEC
		mov	[esp+48h+var_48], offset aPinForChvDIsTo ; "PIN	for CHV%d is too short;	minimum	len"...
		call	sub_43C238
		mov	edx, [ebp+var_10]
		mov	[esp+48h+var_40], edx
		mov	dword ptr [esp+48h+var_44], 3 ;	char
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CB21
		mov	eax, [ebp+var_24]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	[esp+48h+var_48], 57h
		call	sub_410197
		jmp	loc_413C8D
; ---------------------------------------------------------------------------

loc_413BEC:				; CODE XREF: sub_413993+218j
		mov	eax, [ebp+var_24]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ecx, [eax-1]
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+48h+var_3C], ecx ;	size_t
		mov	[esp+48h+var_40], edx ;	void *
		mov	dword ptr [esp+48h+var_44], 83h	; int
		mov	[esp+48h+var_48], eax ;	char
		call	sub_40D14D
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_24]
		mov	[esp+48h+var_48], eax
		call	gcry_free

loc_413C3A:				; CODE XREF: sub_413993+18Ej
		cmp	[ebp+var_C], 0
		jz	short loc_413C7D
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+48h+var_48], offset aVerifyChvDFail ; "verify CHV%d failed: %s\n"
		call	sub_43C238
		mov	[esp+48h+var_40], ebx
		mov	dword ptr [esp+48h+var_44], 3 ;	char
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CB21
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41069F
		mov	eax, [ebp+var_C]
		jmp	short loc_413C8D
; ---------------------------------------------------------------------------

loc_413C7D:				; CODE XREF: sub_413993+2ABj
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		or	edx, 8
		mov	[eax+18h], dl

loc_413C8A:				; CODE XREF: sub_413993+49j
		mov	eax, [ebp+var_C]

loc_413C8D:				; CODE XREF: sub_413993+38j
					; sub_413993+98j ...
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_413993	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_413C94(int, char *, int, int,	void *,	size_t)
sub_413C94	proc near		; CODE XREF: sub_413F6C+B1p
					; DATA XREF: sub_418EB5+5FCo

Str1		= dword	ptr -38h
Str2		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		jmp	short loc_413CA7
; ---------------------------------------------------------------------------

loc_413CA3:				; CODE XREF: sub_413C94+50j
		add	[ebp+var_10], 1

loc_413CA7:				; CODE XREF: sub_413C94+Dj
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_444640
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_413CE6
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_444640
		mov	eax, [eax]
		mov	edx, [ebp+arg_4]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_413CA3

loc_413CE6:				; CODE XREF: sub_413C94+29j
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_444640
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_413D0F
		mov	[esp+38h+Str1],	58h
		call	sub_410197
		jmp	locret_413F6A
; ---------------------------------------------------------------------------

loc_413D0F:				; CODE XREF: sub_413C94+68j
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_444650
		movzx	eax, byte ptr [eax]
		and	eax, 1
		test	al, al
		jz	short loc_413D4D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 1
		test	al, al
		jnz	short loc_413D4D
		mov	[esp+38h+Str1],	3Ch
		call	sub_410197
		jmp	locret_413F6A
; ---------------------------------------------------------------------------

loc_413D4D:				; CODE XREF: sub_413C94+95j
					; sub_413C94+A6j
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_444640
		mov	eax, [eax+0Ch]
		cmp	eax, 3
		jnz	short loc_413D93
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+var_28], eax ;	size_t
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_2C], eax ;	void *
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_30], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+Str2],	eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax ; int
		call	sub_415652
		jmp	locret_413F6A
; ---------------------------------------------------------------------------

loc_413D93:				; CODE XREF: sub_413C94+D1j
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_444640
		mov	eax, [eax+8]
		cmp	eax, 2
		jz	short loc_413DB4
		cmp	eax, 3
		jz	short loc_413DD2
		jmp	short loc_413DF0
; ---------------------------------------------------------------------------

loc_413DB4:				; CODE XREF: sub_413C94+117j
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	sub_4136EE
		mov	[ebp+var_C], eax
		jmp	short loc_413DF7
; ---------------------------------------------------------------------------

loc_413DD2:				; CODE XREF: sub_413C94+11Cj
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	sub_413993
		mov	[ebp+var_C], eax
		jmp	short loc_413DF7
; ---------------------------------------------------------------------------

loc_413DF0:				; CODE XREF: sub_413C94+11Ej
		mov	[ebp+var_C], 0

loc_413DF7:				; CODE XREF: sub_413C94+13Cj
					; sub_413C94+15Aj
		cmp	[ebp+var_C], 0
		jz	short loc_413E05
		mov	eax, [ebp+var_C]
		jmp	locret_413F6A
; ---------------------------------------------------------------------------

loc_413E05:				; CODE XREF: sub_413C94+167j
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_444640
		mov	eax, [eax+4]
		mov	[esp+38h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	sub_410542
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+30h]
		and	eax, 2
		test	al, al
		jz	short loc_413E4C
		cmp	[ebp+arg_14], 0FEh
		jbe	short loc_413E4C
		mov	[ebp+var_14], 1
		jmp	short loc_413E76
; ---------------------------------------------------------------------------

loc_413E4C:				; CODE XREF: sub_413C94+1A4j
					; sub_413C94+1ADj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+30h]
		and	eax, 1
		test	al, al
		jz	short loc_413E6F
		cmp	[ebp+arg_14], 0FEh
		jbe	short loc_413E6F
		mov	[ebp+var_14], 0FFFFFF02h
		jmp	short loc_413E76
; ---------------------------------------------------------------------------

loc_413E6F:				; CODE XREF: sub_413C94+1C7j
					; sub_413C94+1D0j
		mov	[ebp+var_14], 0

loc_413E76:				; CODE XREF: sub_413C94+1B6j
					; sub_413C94+1D9j
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_444640
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	ecx, [ebp+arg_14]
		mov	[esp+38h+var_28], ecx ;	size_t
		mov	ecx, [ebp+arg_10]
		mov	[esp+38h+var_2C], ecx ;	void *
		mov	[esp+38h+var_30], edx ;	int
		mov	edx, [ebp+var_14]
		mov	[esp+38h+Str2],	edx ; int
		mov	[esp+38h+Str1],	eax ; char
		call	sub_40D4CA
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_413EF0
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str1],	eax
		call	gpg_strerror
		mov	ecx, eax
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_444640
		mov	eax, [eax]
		mov	[esp+38h+var_30], ecx
		mov	[esp+38h+Str2],	eax ; char
		mov	[esp+38h+Str1],	offset aFailedToSetSS ;	"failed	to set `%s': %s\n"
		call	sub_43CB21

loc_413EF0:				; CODE XREF: sub_413C94+225j
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_444640
		mov	eax, [eax+0Ch]
		cmp	eax, 1
		jnz	short loc_413F42
		cmp	[ebp+arg_14], 0
		jz	short loc_413F21
		mov	eax, [ebp+arg_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_413F21
		mov	eax, 1
		jmp	short loc_413F26
; ---------------------------------------------------------------------------

loc_413F21:				; CODE XREF: sub_413C94+27Aj
					; sub_413C94+284j
		mov	eax, 0

loc_413F26:				; CODE XREF: sub_413C94+28Bj
		mov	edx, eax
		and	edx, 1
		mov	eax, [ebp+arg_0]
		and	edx, 1
		lea	ecx, [edx+edx]
		movzx	edx, byte ptr [eax+18h]
		and	edx, 0FFFFFFFDh
		or	edx, ecx
		mov	[eax+18h], dl
		jmp	short loc_413F67
; ---------------------------------------------------------------------------

loc_413F42:				; CODE XREF: sub_413C94+274j
		mov	edx, [ebp+var_10]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	eax, offset off_444640
		mov	eax, [eax+0Ch]
		cmp	eax, 2
		jnz	short loc_413F67
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str1],	eax
		call	sub_410EAE

loc_413F67:				; CODE XREF: sub_413C94+2ACj
					; sub_413C94+2C6j
		mov	eax, [ebp+var_C]

locret_413F6A:				; CODE XREF: sub_413C94+76j
					; sub_413C94+B4j ...
		leave
		retn
sub_413C94	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_413F6C(int, int, char	*, int,	int, void *, size_t)
sub_413F6C	proc near		; DATA XREF: sub_418EB5+606o

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+Str2],	offset aOpenpgp_3 ; "OPENPGP.3"
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_413F9A
		mov	[esp+28h+Str1],	76h
		call	sub_410197
		jmp	locret_414022
; ---------------------------------------------------------------------------

loc_413F9A:				; CODE XREF: sub_413F6C+1Bj
		cmp	[ebp+arg_14], 0
		jz	short loc_413FA6
		cmp	[ebp+arg_18], 0
		jnz	short loc_413FB4

loc_413FA6:				; CODE XREF: sub_413F6C+32j
		mov	[esp+28h+Str1],	2Dh
		call	sub_410197
		jmp	short locret_414022
; ---------------------------------------------------------------------------

loc_413FB4:				; CODE XREF: sub_413F6C+38j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 1
		test	al, al
		jnz	short loc_413FD3
		mov	[esp+28h+Str1],	3Ch
		call	sub_410197
		jmp	short locret_414022
; ---------------------------------------------------------------------------

loc_413FD3:				; CODE XREF: sub_413F6C+57j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+35h]
		movzx	eax, ax
		cmp	eax, [ebp+arg_18]
		jnb	short loc_413FF3
		mov	[esp+28h+Str1],	43h
		call	sub_410197
		jmp	short locret_414022
; ---------------------------------------------------------------------------

loc_413FF3:				; CODE XREF: sub_413F6C+77j
		mov	eax, [ebp+arg_18]
		mov	[esp+28h+var_14], eax ;	size_t
		mov	eax, [ebp+arg_14]
		mov	[esp+28h+var_18], eax ;	void *
		mov	eax, [ebp+arg_10]
		mov	[esp+28h+var_1C], eax ;	int
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_20], eax ;	int
		mov	[esp+28h+Str2],	offset aCert3 ;	"CERT-3"
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str1],	eax ; int
		call	sub_413C94

locret_414022:				; CODE XREF: sub_413F6C+29j
					; sub_413F6C+46j ...
		leave
		retn
sub_413F6C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_414024(int, int, char	*, int,	int, int)
sub_414024	proc near		; DATA XREF: sub_418EB5+642o

Str		= dword	ptr -0B8h
Source		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= byte ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0ACh
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+0B8h+Str],	eax ; Str
		call	atoi
		mov	dword ptr [ebp+var_50],	eax
		mov	[ebp+var_68], 0
		mov	[ebp+var_6C], 0
		mov	[ebp+var_70], 0
		mov	eax, [ebp+arg_C]
		and	eax, 1
		mov	[ebp+var_54], eax
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	dword ptr [ebp+var_28],	6
		lea	eax, [ebp+var_7C]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	eax, dword ptr [ebp+var_28]
		mov	[ebp+var_78], eax
		cmp	[ebp+var_54], 0
		jz	short loc_4140BC
		cmp	dword ptr [ebp+var_50],	3
		jnz	short loc_4140BC
		mov	[esp+0B8h+Str],	76h
		call	sub_410197
		mov	[ebp+var_1C], eax
		jmp	loc_414BD3
; ---------------------------------------------------------------------------

loc_4140BC:				; CODE XREF: sub_414024+7Cj
					; sub_414024+82j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 1
		test	al, al
		jnz	loc_4141BA
		cmp	[ebp+var_54], 0
		jnz	short loc_4140DD
		cmp	dword ptr [ebp+var_50],	3
		jnz	short loc_414115

loc_4140DD:				; CODE XREF: sub_414024+B1j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		and	edx, 0FFFFFFF7h
		mov	[eax+18h], dl
		mov	eax, [ebp+arg_14]
		mov	[esp+0B8h+var_B0], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+0B8h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+Str],	eax
		call	sub_413993
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_41452E
		jmp	loc_414BD3
; ---------------------------------------------------------------------------

loc_414115:				; CODE XREF: sub_414024+B7j
		cmp	dword ptr [ebp+var_50],	1
		jz	short loc_414125
		cmp	dword ptr [ebp+var_50],	2
		jnz	loc_4141A6

loc_414125:				; CODE XREF: sub_414024+F5j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+18h]
		shr	al, 1
		and	eax, 1
		movzx	eax, al
		mov	[ebp+var_58], eax
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		and	edx, 0FFFFFFFDh
		mov	[eax+18h], dl
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		and	edx, 0FFFFFFFEh
		mov	[eax+18h], dl
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		and	edx, 0FFFFFFFBh
		mov	[eax+18h], dl
		mov	eax, [ebp+arg_14]
		mov	[esp+0B8h+var_B0], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+0B8h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+Str],	eax
		call	sub_4136EE
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_58]
		mov	edx, eax
		and	edx, 1
		mov	eax, [ebp+arg_0]
		and	edx, 1
		lea	ecx, [edx+edx]
		movzx	edx, byte ptr [eax+18h]
		and	edx, 0FFFFFFFDh
		or	edx, ecx
		mov	[eax+18h], dl
		cmp	[ebp+var_1C], 0
		jz	loc_41452A
		jmp	loc_414BD3
; ---------------------------------------------------------------------------

loc_4141A6:				; CODE XREF: sub_414024+FBj
		mov	[esp+0B8h+Str],	76h
		call	sub_410197
		mov	[ebp+var_1C], eax
		jmp	loc_414BD3
; ---------------------------------------------------------------------------

loc_4141BA:				; CODE XREF: sub_414024+A7j
		mov	eax, ds:dword_451D48
		test	eax, eax
		jnz	short loc_41420F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_7C]
		mov	[esp+0B8h+var_B0], edx
		mov	[esp+0B8h+Source], 24h
		mov	[esp+0B8h+Str],	eax
		call	sub_40D0D7
		test	eax, eax
		jnz	short loc_41420F
		cmp	dword ptr [ebp+var_50],	3
		setz	al
		movzx	eax, al
		mov	[esp+0B8h+var_B0], eax
		lea	eax, [ebp+var_7C]
		mov	[esp+0B8h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+Str],	eax
		call	sub_4131F6
		test	eax, eax
		jnz	short loc_41420F
		mov	[ebp+var_24], 1

loc_41420F:				; CODE XREF: sub_414024+19Dj
					; sub_414024+1BEj ...
		cmp	[ebp+var_54], 0
		jz	short loc_414265
		mov	[ebp+var_24], 0
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		and	edx, 0FFFFFFF7h
		mov	[eax+18h], dl
		mov	eax, [ebp+arg_14]
		mov	[esp+0B8h+var_B0], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+0B8h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+Str],	eax
		call	sub_413993
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_414BCF
		cmp	dword ptr [ebp+var_50],	2
		jnz	loc_41452E
		mov	[ebp+var_20], 1
		jmp	loc_41452E
; ---------------------------------------------------------------------------

loc_414265:				; CODE XREF: sub_414024+1EFj
		cmp	dword ptr [ebp+var_50],	1
		jz	short loc_414275
		cmp	dword ptr [ebp+var_50],	3
		jnz	loc_41438D

loc_414275:				; CODE XREF: sub_414024+245j
		cmp	[ebp+var_24], 0
		jnz	loc_41452D
		mov	[ebp+var_80], 0
		cmp	dword ptr [ebp+var_50],	3
		jnz	short loc_4142BA
		mov	dword ptr [ebp+var_28],	8
		lea	eax, [ebp+var_80]
		mov	[esp+0B8h+Source], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+Str],	eax
		call	sub_41384F
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_414BD2
		mov	eax, [ebp+var_80]
		mov	[ebp+var_2C], eax
		jmp	short loc_4142C9
; ---------------------------------------------------------------------------

loc_4142BA:				; CODE XREF: sub_414024+266j
		mov	[esp+0B8h+Str],	offset aPleaseEnterT_0 ; "||Please enter the PIN"
		call	sub_43C238
		mov	[ebp+var_2C], eax

loc_4142C9:				; CODE XREF: sub_414024+294j
		lea	eax, [ebp+var_6C]
		mov	[esp+0B8h+var_B0], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+0B8h+Source], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+0B8h+Str],	eax
		mov	eax, [ebp+arg_10]
		call	eax
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_80]
		mov	[esp+0B8h+Str],	eax
		call	gcry_free
		mov	[ebp+var_80], 0
		cmp	[ebp+var_1C], 0
		jz	short loc_414327
		mov	eax, [ebp+var_1C]
		mov	[esp+0B8h+Str],	eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+0B8h+Str],	offset aPinCallbackRet ; "PIN callback returned	error: %s\n"
		call	sub_43C238
		mov	[esp+0B8h+Source], ebx ; char
		mov	[esp+0B8h+Str],	eax ; char *
		call	sub_43CAF7
		jmp	loc_414BD3
; ---------------------------------------------------------------------------

loc_414327:				; CODE XREF: sub_414024+2D7j
		mov	eax, [ebp+var_6C]
		mov	[ebp+var_90], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_90]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, dword ptr [ebp+var_28]
		cmp	edx, eax
		jnb	loc_41452D
		mov	[esp+0B8h+Str],	offset aPinForChvDIsTo ; "PIN for CHV%d	is too short; minimum len"...
		call	sub_43C238
		mov	edx, dword ptr [ebp+var_28]
		mov	[esp+0B8h+var_B0], edx
		mov	edx, dword ptr [ebp+var_50]
		mov	[esp+0B8h+Source], edx ; char
		mov	[esp+0B8h+Str],	eax ; char *
		call	sub_43CAF7
		mov	[esp+0B8h+Str],	57h
		call	sub_410197
		mov	[ebp+var_1C], eax
		jmp	loc_414BD3
; ---------------------------------------------------------------------------

loc_41438D:				; CODE XREF: sub_414024+24Bj
		cmp	dword ptr [ebp+var_50],	2
		jnz	loc_414516
		mov	[ebp+var_24], 0
		mov	dword ptr [ebp+var_28],	8
		mov	[esp+0B8h+var_A8], 0
		lea	eax, [ebp+var_88]
		mov	[esp+0B8h+var_AC], eax
		lea	eax, [ebp+var_84]
		mov	[esp+0B8h+var_B0], eax
		mov	[esp+0B8h+Source], 0C4h	; char
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+Str],	eax
		call	sub_41075F
		mov	[ebp+var_5C], eax
		cmp	[ebp+var_5C], 0
		jz	short loc_4143E8
		mov	eax, [ebp+var_88]
		cmp	eax, 6
		ja	short loc_41441B

loc_4143E8:				; CODE XREF: sub_414024+3B7j
		mov	[esp+0B8h+Str],	offset aErrorRetrievin ; "error	retrieving CHV status from card\n"
		call	sub_43C238
		mov	[esp+0B8h+Str],	eax ; char *
		call	sub_43CB21
		mov	eax, [ebp+var_5C]
		mov	[esp+0B8h+Str],	eax
		call	gcry_free
		mov	[esp+0B8h+Str],	6Ch
		call	sub_410197
		mov	[ebp+var_1C], eax
		jmp	loc_414BD3
; ---------------------------------------------------------------------------

loc_41441B:				; CODE XREF: sub_414024+3C2j
		mov	eax, [ebp+var_84]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_60], eax
		mov	eax, [ebp+var_5C]
		mov	[esp+0B8h+Str],	eax
		call	gcry_free
		cmp	[ebp+var_60], 0
		jnz	short loc_414466
		mov	[esp+0B8h+Str],	offset aResetCodeNotOr ; "Reset	Code not or not	anymore	available"...
		call	sub_43C238
		mov	[esp+0B8h+Str],	eax ; char *
		call	sub_43CB21
		mov	[esp+0B8h+Str],	57h
		call	sub_410197
		mov	[ebp+var_1C], eax
		jmp	loc_414BD3
; ---------------------------------------------------------------------------

loc_414466:				; CODE XREF: sub_414024+418j
		mov	[esp+0B8h+Str],	offset aPleaseEnterT_1 ; "||Please enter the Reset Code	for the	c"...
		call	sub_43C238
		lea	edx, [ebp+var_68]
		mov	[esp+0B8h+var_B0], edx
		mov	[esp+0B8h+Source], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+0B8h+Str],	eax
		mov	eax, [ebp+arg_10]
		call	eax
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_4144BB
		mov	eax, [ebp+var_1C]
		mov	[esp+0B8h+Str],	eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+0B8h+Str],	offset aPinCallbackRet ; "PIN callback returned	error: %s\n"
		call	sub_43C238
		mov	[esp+0B8h+Source], ebx ; char
		mov	[esp+0B8h+Str],	eax ; char *
		call	sub_43CAF7
		jmp	loc_414BD3
; ---------------------------------------------------------------------------

loc_4144BB:				; CODE XREF: sub_414024+46Bj
		mov	eax, [ebp+var_68]
		mov	[ebp+var_90], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_90]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, dword ptr [ebp+var_28]
		cmp	edx, eax
		jnb	short loc_41452E
		mov	[esp+0B8h+Str],	offset aResetCodeIsToo ; "Reset	Code is	too short; minimum length"...
		call	sub_43C238
		mov	edx, dword ptr [ebp+var_28]
		mov	[esp+0B8h+Source], edx ; char
		mov	[esp+0B8h+Str],	eax ; char *
		call	sub_43CAF7
		mov	[esp+0B8h+Str],	57h
		call	sub_410197
		mov	[ebp+var_1C], eax
		jmp	loc_414BD3
; ---------------------------------------------------------------------------

loc_414516:				; CODE XREF: sub_414024+36Dj
		mov	[esp+0B8h+Str],	76h
		call	sub_410197
		mov	[ebp+var_1C], eax
		jmp	loc_414BD3
; ---------------------------------------------------------------------------

loc_41452A:				; CODE XREF: sub_414024+177j
		nop
		jmp	short loc_41452E
; ---------------------------------------------------------------------------

loc_41452D:				; CODE XREF: sub_414024+255j
					; sub_414024+32Dj
		nop

loc_41452E:				; CODE XREF: sub_414024+E6j
					; sub_414024+22Fj ...
		cmp	dword ptr [ebp+var_50],	3
		jnz	short loc_414543
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		and	edx, 0FFFFFFF7h
		mov	[eax+18h], dl
		jmp	short loc_414571
; ---------------------------------------------------------------------------

loc_414543:				; CODE XREF: sub_414024+50Ej
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		and	edx, 0FFFFFFFBh
		mov	[eax+18h], dl
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+18h]
		shr	al, 2
		and	eax, 1
		mov	edx, [ebp+arg_0]
		mov	ecx, eax
		and	ecx, 1
		movzx	eax, byte ptr [edx+18h]
		and	eax, 0FFFFFFFEh
		or	eax, ecx
		mov	[edx+18h], al

loc_414571:				; CODE XREF: sub_414024+51Dj
		cmp	[ebp+var_24], 0
		jnz	short loc_4145F4
		cmp	[ebp+var_20], 0
		jz	short loc_41458B
		mov	[esp+0B8h+Str],	offset aRnNewResetCode ; "|RN|New Reset	Code"
		call	sub_43C238
		jmp	short loc_4145AB
; ---------------------------------------------------------------------------

loc_41458B:				; CODE XREF: sub_414024+557j
		cmp	dword ptr [ebp+var_50],	3
		jnz	short loc_41459F
		mov	[esp+0B8h+Str],	offset aAnNewAdminPin ;	"|AN|New Admin PIN"
		call	sub_43C238
		jmp	short loc_4145AB
; ---------------------------------------------------------------------------

loc_41459F:				; CODE XREF: sub_414024+56Bj
		mov	[esp+0B8h+Str],	offset aNNewPin	; "|N|New PIN"
		call	sub_43C238

loc_4145AB:				; CODE XREF: sub_414024+565j
					; sub_414024+579j
		lea	edx, [ebp+var_70]
		mov	[esp+0B8h+var_B0], edx
		mov	[esp+0B8h+Source], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+0B8h+Str],	eax
		mov	eax, [ebp+arg_10]
		call	eax
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_4145F4
		mov	eax, [ebp+var_1C]
		mov	[esp+0B8h+Str],	eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+0B8h+Str],	offset aErrorGettingNe ; "error	getting	new PIN: %s\n"
		call	sub_43C238
		mov	[esp+0B8h+Source], ebx ; char
		mov	[esp+0B8h+Str],	eax ; char *
		call	sub_43CB21
		jmp	loc_414BD3
; ---------------------------------------------------------------------------

loc_4145F4:				; CODE XREF: sub_414024+551j
					; sub_414024+5A4j
		mov	eax, [ebp+var_68]
		test	eax, eax
		jz	loc_41472C
		mov	eax, [ebp+var_68]
		mov	[ebp+var_90], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_90]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_70]
		mov	[ebp+var_90], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_90]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+0B8h+Str],	eax
		call	gcry_malloc
		mov	[ebp+var_64], eax
		cmp	[ebp+var_64], 0
		jnz	short loc_41466C
		call	sub_4101BF
		mov	[ebp+var_1C], eax
		jmp	loc_414B66
; ---------------------------------------------------------------------------

loc_41466C:				; CODE XREF: sub_414024+639j
		mov	eax, [ebp+var_70]
		mov	ebx, eax
		mov	eax, [ebp+var_68]
		mov	[esp+0B8h+Source], eax
		mov	eax, [ebp+var_64]
		mov	[esp+0B8h+Str],	eax
		call	sub_43A1E9
		mov	[esp+0B8h+Source], ebx ; Source
		mov	[esp+0B8h+Str],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+var_64]
		mov	[ebp+var_90], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_90]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+0B8h+var_AC], edx ; size_t
		mov	edx, [ebp+var_64]
		mov	[esp+0B8h+var_B0], edx ; void *
		mov	[esp+0B8h+Source], 81h ; int
		mov	[esp+0B8h+Str],	eax ; char
		call	sub_40D305
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_64]
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_64]
		mov	[ebp+var_90], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_90]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_34], eax
		jmp	short loc_414716
; ---------------------------------------------------------------------------

loc_414708:				; CODE XREF: sub_414024+6F6j
		mov	eax, [ebp+var_30]
		mov	byte ptr [eax],	0
		add	[ebp+var_30], 1
		sub	[ebp+var_34], 1

loc_414716:				; CODE XREF: sub_414024+6E2j
		cmp	[ebp+var_34], 0
		jnz	short loc_414708
		mov	eax, [ebp+var_64]
		mov	[esp+0B8h+Str],	eax
		call	gcry_free
		jmp	loc_414B66
; ---------------------------------------------------------------------------

loc_41472C:				; CODE XREF: sub_414024+5D5j
		cmp	[ebp+var_20], 0
		jz	loc_4147E6
		mov	eax, [ebp+var_70]
		mov	[ebp+var_90], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_90]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 7
		ja	short loc_414790
		mov	[esp+0B8h+Str],	offset aResetCodeIsToo ; "Reset	Code is	too short; minimum length"...
		call	sub_43C238
		mov	[esp+0B8h+Source], 8 ; char
		mov	[esp+0B8h+Str],	eax ; char *
		call	sub_43CB21
		mov	[esp+0B8h+Str],	57h
		call	sub_410197
		mov	[ebp+var_1C], eax
		jmp	loc_414B66
; ---------------------------------------------------------------------------

loc_414790:				; CODE XREF: sub_414024+73Aj
		mov	eax, [ebp+var_70]
		mov	[ebp+var_90], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_90]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ecx, [eax-1]
		mov	edx, [ebp+var_70]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+0B8h+var_A8], ecx ; size_t
		mov	[esp+0B8h+var_AC], edx ; void *
		mov	[esp+0B8h+var_B0], 0D3h	; int
		mov	[esp+0B8h+Source], 0 ; int
		mov	[esp+0B8h+Str],	eax ; char
		call	sub_40D4CA
		mov	[ebp+var_1C], eax
		jmp	loc_414B66
; ---------------------------------------------------------------------------

loc_4147E6:				; CODE XREF: sub_414024+70Cj
		cmp	[ebp+var_54], 0
		jz	loc_4148A6
		mov	eax, [ebp+var_70]
		mov	[ebp+var_90], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_90]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ecx, [eax-1]
		mov	edx, [ebp+var_70]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+0B8h+var_AC], ecx ; size_t
		mov	[esp+0B8h+var_B0], edx ; void *
		mov	[esp+0B8h+Source], 81h ; int
		mov	[esp+0B8h+Str],	eax ; char
		call	sub_40D375
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_414B66
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 1
		test	al, al
		jnz	loc_414B66
		mov	eax, [ebp+var_70]
		mov	[ebp+var_90], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_90]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ecx, [eax-1]
		mov	edx, [ebp+var_70]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+0B8h+var_AC], ecx ; size_t
		mov	[esp+0B8h+var_B0], edx ; void *
		mov	[esp+0B8h+Source], 82h ; int
		mov	[esp+0B8h+Str],	eax ; char
		call	sub_40D375
		mov	[ebp+var_1C], eax
		jmp	loc_414B66
; ---------------------------------------------------------------------------

loc_4148A6:				; CODE XREF: sub_414024+7C6j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 1
		test	al, al
		jnz	loc_4149F0
		cmp	dword ptr [ebp+var_50],	1
		jz	short loc_4148CB
		cmp	dword ptr [ebp+var_50],	2
		jnz	loc_41498D

loc_4148CB:				; CODE XREF: sub_414024+89Bj
		mov	eax, [ebp+var_70]
		mov	[ebp+var_90], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_90]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ecx, [eax-1]
		mov	edx, [ebp+var_70]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+0B8h+var_A4], ecx ; size_t
		mov	[esp+0B8h+var_A8], edx ; void *
		mov	[esp+0B8h+var_AC], 0 ; size_t
		mov	[esp+0B8h+var_B0], 0 ; void *
		mov	[esp+0B8h+Source], 81h ; int
		mov	[esp+0B8h+Str],	eax ; char
		call	sub_40D1F0
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_414B66
		mov	eax, [ebp+var_70]
		mov	[ebp+var_90], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_90]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ecx, [eax-1]
		mov	edx, [ebp+var_70]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+0B8h+var_A4], ecx ; size_t
		mov	[esp+0B8h+var_A8], edx ; void *
		mov	[esp+0B8h+var_AC], 0 ; size_t
		mov	[esp+0B8h+var_B0], 0 ; void *
		mov	[esp+0B8h+Source], 82h ; int
		mov	[esp+0B8h+Str],	eax ; char
		call	sub_40D1F0
		mov	[ebp+var_1C], eax
		nop
		jmp	loc_414B66
; ---------------------------------------------------------------------------

loc_41498D:				; CODE XREF: sub_414024+8A1j
		mov	eax, [ebp+var_70]
		mov	[ebp+var_90], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_90]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	edx, [ebp+var_70]
		mov	eax, dword ptr [ebp+var_50]
		lea	ecx, [eax+80h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+0B8h+var_A4], ebx ; size_t
		mov	[esp+0B8h+var_A8], edx ; void *
		mov	[esp+0B8h+var_AC], 0 ; size_t
		mov	[esp+0B8h+var_B0], 0 ; void *
		mov	[esp+0B8h+Source], ecx ; int
		mov	[esp+0B8h+Str],	eax ; char
		call	sub_40D1F0
		mov	[ebp+var_1C], eax
		jmp	loc_414B66
; ---------------------------------------------------------------------------

loc_4149F0:				; CODE XREF: sub_414024+891j
		cmp	dword ptr [ebp+var_50],	1
		jz	short loc_414A1A
		cmp	dword ptr [ebp+var_50],	3
		jz	short loc_414A1A
		mov	[esp+0B8h+var_B0], 8CCh	; int
		mov	[esp+0B8h+Source], offset a____Gnupg22__2 ; "../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+0B8h+Str],	offset aChvno1Chvno3 ; "chvno == 1 || chvno == 3"
		call	sub_442650
		jmp	short loc_414A1B
; ---------------------------------------------------------------------------

loc_414A1A:				; CODE XREF: sub_414024+9D0j
					; sub_414024+9D6j
		nop

loc_414A1B:				; CODE XREF: sub_414024+9F4j
		cmp	[ebp+var_24], 0
		jz	loc_414ADC
		cmp	dword ptr [ebp+var_50],	3
		jnz	short loc_414A39
		mov	[esp+0B8h+Str],	offset aPleaseEnterT_2 ; "||Please enter the Admin PIN and New Ad"...
		call	sub_43C238
		jmp	short loc_414A45
; ---------------------------------------------------------------------------

loc_414A39:				; CODE XREF: sub_414024+A05j
		mov	[esp+0B8h+Str],	offset aPleaseEnterT_3 ; "||Please enter the PIN and New PIN"
		call	sub_43C238

loc_414A45:				; CODE XREF: sub_414024+A13j
		mov	[esp+0B8h+var_B0], 0
		mov	[esp+0B8h+Source], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+0B8h+Str],	eax
		mov	eax, [ebp+arg_10]
		call	eax
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_414A8F
		mov	eax, [ebp+var_1C]
		mov	[esp+0B8h+Str],	eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+0B8h+Str],	offset aPinCallbackRet ; "PIN callback returned	error: %s\n"
		call	sub_43C238
		mov	[esp+0B8h+Source], ebx ; char
		mov	[esp+0B8h+Str],	eax ; char *
		call	sub_43CAF7
		jmp	loc_414BD3
; ---------------------------------------------------------------------------

loc_414A8F:				; CODE XREF: sub_414024+A3Fj
		mov	eax, dword ptr [ebp+var_50]
		lea	ecx, [eax+80h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_7C]
		mov	[esp+0B8h+var_AC], edx
		mov	[esp+0B8h+var_B0], 0
		mov	[esp+0B8h+Source], ecx
		mov	[esp+0B8h+Str],	eax
		call	sub_40D1A3
		mov	[ebp+var_1C], eax
		mov	[esp+0B8h+var_B0], 0
		mov	[esp+0B8h+Source], 0
		mov	eax, [ebp+arg_14]
		mov	[esp+0B8h+Str],	eax
		mov	eax, [ebp+arg_10]
		call	eax
		jmp	loc_414B66
; ---------------------------------------------------------------------------

loc_414ADC:				; CODE XREF: sub_414024+9FBj
		mov	eax, [ebp+var_70]
		mov	[ebp+var_90], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_90]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_8C], eax
		mov	ebx, [ebp+var_70]
		mov	eax, [ebp+var_6C]
		mov	[ebp+var_90], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_90]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	esi, [eax-1]
		mov	edx, [ebp+var_6C]
		mov	eax, dword ptr [ebp+var_50]
		lea	ecx, [eax+80h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edi, [ebp+var_8C]
		mov	[esp+0B8h+var_A4], edi ; size_t
		mov	[esp+0B8h+var_A8], ebx ; void *
		mov	[esp+0B8h+var_AC], esi ; size_t
		mov	[esp+0B8h+var_B0], edx ; void *
		mov	[esp+0B8h+Source], ecx ; int
		mov	[esp+0B8h+Str],	eax ; char
		call	sub_40D1F0
		mov	[ebp+var_1C], eax

loc_414B66:				; CODE XREF: sub_414024+643j
					; sub_414024+703j ...
		mov	eax, [ebp+var_70]
		test	eax, eax
		jz	short loc_414BBC
		mov	eax, [ebp+var_70]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_70]
		mov	[ebp+var_90], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_90]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_3C], eax
		jmp	short loc_414BAB
; ---------------------------------------------------------------------------

loc_414B9D:				; CODE XREF: sub_414024+B8Bj
		mov	eax, [ebp+var_38]
		mov	byte ptr [eax],	0
		add	[ebp+var_38], 1
		sub	[ebp+var_3C], 1

loc_414BAB:				; CODE XREF: sub_414024+B77j
		cmp	[ebp+var_3C], 0
		jnz	short loc_414B9D
		mov	eax, [ebp+var_70]
		mov	[esp+0B8h+Str],	eax
		call	gcry_free

loc_414BBC:				; CODE XREF: sub_414024+B47j
		cmp	[ebp+var_1C], 0
		jz	short loc_414BD3
		mov	eax, [ebp+arg_0]
		mov	[esp+0B8h+Str],	eax
		call	sub_41069F
		jmp	short loc_414BD3
; ---------------------------------------------------------------------------

loc_414BCF:				; CODE XREF: sub_414024+225j
		nop
		jmp	short loc_414BD3
; ---------------------------------------------------------------------------

loc_414BD2:				; CODE XREF: sub_414024+288j
		nop

loc_414BD3:				; CODE XREF: sub_414024+93j
					; sub_414024+ECj ...
		mov	eax, [ebp+var_68]
		test	eax, eax
		jz	short loc_414C29
		mov	eax, [ebp+var_68]
		mov	[ebp+var_40], eax
		mov	eax, [ebp+var_68]
		mov	[ebp+var_90], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_90]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_44], eax
		jmp	short loc_414C18
; ---------------------------------------------------------------------------

loc_414C0A:				; CODE XREF: sub_414024+BF8j
		mov	eax, [ebp+var_40]
		mov	byte ptr [eax],	0
		add	[ebp+var_40], 1
		sub	[ebp+var_44], 1

loc_414C18:				; CODE XREF: sub_414024+BE4j
		cmp	[ebp+var_44], 0
		jnz	short loc_414C0A
		mov	eax, [ebp+var_68]
		mov	[esp+0B8h+Str],	eax
		call	gcry_free

loc_414C29:				; CODE XREF: sub_414024+BB4j
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jz	short loc_414C7F
		mov	eax, [ebp+var_6C]
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_6C]
		mov	[ebp+var_90], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_90]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_4C], eax
		jmp	short loc_414C6E
; ---------------------------------------------------------------------------

loc_414C60:				; CODE XREF: sub_414024+C4Ej
		mov	eax, [ebp+var_48]
		mov	byte ptr [eax],	0
		add	[ebp+var_48], 1
		sub	[ebp+var_4C], 1

loc_414C6E:				; CODE XREF: sub_414024+C3Aj
		cmp	[ebp+var_4C], 0
		jnz	short loc_414C60
		mov	eax, [ebp+var_6C]
		mov	[esp+0B8h+Str],	eax
		call	gcry_free

loc_414C7F:				; CODE XREF: sub_414024+C0Aj
		mov	eax, [ebp+var_1C]
		add	esp, 0ACh
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_414024	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414C8D	proc near		; CODE XREF: sub_415770+CFp
					; sub_4168B1+E9p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		cmp	[ebp+arg_4], 0
		js	short loc_414C9F
		cmp	[ebp+arg_4], 2
		jle	short loc_414CBD

loc_414C9F:				; CODE XREF: sub_414C8D+Aj
		mov	[esp+48h+var_40], 908h ; int
		mov	[esp+48h+var_44], offset a____Gnupg22__2 ; "../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+48h+var_48], offset aKeyidx0Keyidx2 ; "keyidx >=0 && keyidx <= 2"
		call	sub_442650
		jmp	short loc_414CBE
; ---------------------------------------------------------------------------

loc_414CBD:				; CODE XREF: sub_414C8D+10j
		nop

loc_414CBE:				; CODE XREF: sub_414C8D+2Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_18]
		mov	[esp+48h+var_38], edx
		lea	edx, [ebp+var_14]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], 6Eh
		mov	[esp+48h+var_44], 0 ; char
		mov	[esp+48h+var_48], eax
		call	sub_40D3CB
		test	eax, eax
		jz	short loc_414D13
		mov	[esp+48h+var_48], offset aErrorReadingAp ; "error reading application data\n"
		call	sub_43C238
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CB21
		mov	[esp+48h+var_48], 1
		call	sub_410197
		jmp	locret_414E2F
; ---------------------------------------------------------------------------

loc_414D13:				; CODE XREF: sub_414C8D+5Fj
		mov	edx, dword ptr [ebp+var_18]
		mov	eax, [ebp+var_14]
		lea	ecx, [ebp+var_1C]
		mov	[esp+48h+var_3C], ecx
		mov	[esp+48h+var_40], 0C5h
		mov	[esp+48h+var_44], edx ;	char
		mov	[esp+48h+var_48], eax
		call	sub_42D39C
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_414D45
		mov	eax, [ebp+var_1C]
		cmp	eax, 3Bh
		ja	short loc_414D75

loc_414D45:				; CODE XREF: sub_414C8D+AEj
		mov	[esp+48h+var_48], offset aErrorReadingFi ; "error reading fingerprint DO\n"
		call	sub_43C238
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CB21
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	[esp+48h+var_48], 1
		call	sub_410197
		jmp	locret_414E2F
; ---------------------------------------------------------------------------

loc_414D75:				; CODE XREF: sub_414C8D+B6j
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_414D92
; ---------------------------------------------------------------------------

loc_414D8E:				; CODE XREF: sub_414C8D+116j
		add	[ebp+var_C], 1

loc_414D92:				; CODE XREF: sub_414C8D+FFj
		cmp	[ebp+var_C], 13h
		jg	short loc_414DA5
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_414D8E

loc_414DA5:				; CODE XREF: sub_414C8D+109j
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		cmp	[ebp+var_C], 14h
		jz	short loc_414DDE
		cmp	[ebp+arg_C], 0
		jnz	short loc_414DDE
		mov	[esp+48h+var_48], offset aKeyAlreadyExis ; "key	already	exists\n"
		call	sub_43C238
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CB21
		mov	[esp+48h+var_48], 8023h
		call	sub_410197
		jmp	short locret_414E2F
; ---------------------------------------------------------------------------

loc_414DDE:				; CODE XREF: sub_414C8D+127j
					; sub_414C8D+12Dj
		cmp	[ebp+var_C], 14h
		jz	short loc_414DFA
		mov	[esp+48h+var_48], offset aExistingKeyWil ; "existing key will be replaced\n"
		call	sub_43C238
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CAF7
		jmp	short loc_414E2A
; ---------------------------------------------------------------------------

loc_414DFA:				; CODE XREF: sub_414C8D+155j
		cmp	[ebp+arg_8], 0
		jz	short loc_414E16
		mov	[esp+48h+var_48], offset aGeneratingNewK ; "generating new key\n"
		call	sub_43C238
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CAF7
		jmp	short loc_414E2A
; ---------------------------------------------------------------------------

loc_414E16:				; CODE XREF: sub_414C8D+171j
		mov	[esp+48h+var_48], offset aWritingNewKey	; "writing new key\n"
		call	sub_43C238
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CAF7

loc_414E2A:				; CODE XREF: sub_414C8D+16Bj
					; sub_414C8D+187j
		mov	eax, 0

locret_414E2F:				; CODE XREF: sub_414C8D+81j
					; sub_414C8D+E3j ...
		leave
		retn
sub_414C8D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414E31	proc near		; CODE XREF: sub_414F0A+B5p
					; sub_414F0A+D8p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_4], 0FFFFh
		jbe	short loc_414E62
		mov	[esp+28h+var_20], 930h ; int
		mov	[esp+28h+var_24], offset a____Gnupg22__2 ; "../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+28h+var_28], offset aTag0xffff ; "tag <= 0xffff"
		call	sub_442650

loc_414E62:				; CODE XREF: sub_414E31+13j
		cmp	[ebp+arg_4], 0FFh
		jbe	short loc_414E7C
		mov	eax, [ebp+arg_4]
		shr	eax, 8
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_414E7C:				; CODE XREF: sub_414E31+38j
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1
		cmp	[ebp+arg_8], 7Fh
		ja	short loc_414EA0
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1
		jmp	short loc_414EFC
; ---------------------------------------------------------------------------

loc_414EA0:				; CODE XREF: sub_414E31+5Dj
		cmp	[ebp+arg_8], 0FFh
		ja	short loc_414EC3
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	81h
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1
		jmp	short loc_414EFC
; ---------------------------------------------------------------------------

loc_414EC3:				; CODE XREF: sub_414E31+76j
		cmp	[ebp+arg_8], 0FFFFh
		jbe	short loc_414ED3
		mov	[ebp+arg_8], 0FFFFh

loc_414ED3:				; CODE XREF: sub_414E31+99j
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	82h
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_8]
		shr	eax, 8
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_414EFC:				; CODE XREF: sub_414E31+6Dj
					; sub_414E31+90j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		leave
		retn
sub_414E31	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_414F0A(int, int, void	*, size_t, void	*, size_t, void	*, size_t, void	*, size_t, void	*, size_t, void	*, size_t, void	*, size_t, int,	int)
sub_414F0A	proc near		; CODE XREF: sub_415770+D5Fp

Dst		= dword	ptr -78h
Src		= dword	ptr -74h
Size		= dword	ptr -70h
var_65		= byte ptr -65h
var_60		= byte ptr -60h
var_59		= byte ptr -59h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch
arg_28		= dword	ptr  30h
arg_2C		= dword	ptr  34h
arg_30		= dword	ptr  38h
arg_34		= dword	ptr  3Ch
arg_38		= dword	ptr  40h
arg_3C		= dword	ptr  44h
arg_40		= dword	ptr  48h
arg_44		= dword	ptr  4Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 78h
		mov	eax, [ebp+arg_40]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_44]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 58h
		mov	eax, [eax]
		sub	eax, 1
		cmp	eax, 3
		ja	short loc_414F70
		nop
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 54h
		mov	eax, [eax]
		add	eax, 7
		shr	eax, 3
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_14]
		cmp	eax, [ebp+var_14]
		jbe	short loc_414F9D
		jmp	short loc_414F81
; ---------------------------------------------------------------------------

loc_414F70:				; CODE XREF: sub_414F0A+37j
		mov	[esp+78h+Dst], 37h
		call	sub_410197
		jmp	locret_415463
; ---------------------------------------------------------------------------

loc_414F81:				; CODE XREF: sub_414F0A+64j
		mov	[esp+78h+Size],	972h ; int
		mov	[esp+78h+Src], offset a____Gnupg22__2 ;	"../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+78h+Dst], offset aRsa_e_lenRsa_e ;	"rsa_e_len <= rsa_e_reqlen"
		call	sub_442650

loc_414F9D:				; CODE XREF: sub_414F0A+62j
		mov	[ebp+var_10], 0
		lea	eax, [ebp+var_59]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[esp+78h+Size],	eax
		mov	[esp+78h+Src], 91h
		mov	eax, [ebp+var_C]
		mov	[esp+78h+Dst], eax
		call	sub_414E31
		add	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		add	[ebp+var_10], eax
		mov	eax, [ebp+arg_1C]
		mov	[esp+78h+Size],	eax
		mov	[esp+78h+Src], 92h
		mov	eax, [ebp+var_C]
		mov	[esp+78h+Dst], eax
		call	sub_414E31
		add	[ebp+var_C], eax
		mov	eax, [ebp+arg_1C]
		add	[ebp+var_10], eax
		mov	eax, [ebp+arg_24]
		mov	[esp+78h+Size],	eax
		mov	[esp+78h+Src], 93h
		mov	eax, [ebp+var_C]
		mov	[esp+78h+Dst], eax
		call	sub_414E31
		add	[ebp+var_C], eax
		mov	eax, [ebp+arg_24]
		add	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 58h
		mov	eax, [eax]
		cmp	eax, 3
		jz	short loc_41504F
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 58h
		mov	eax, [eax]
		cmp	eax, 4
		jnz	short loc_4150B8

loc_41504F:				; CODE XREF: sub_414F0A+125j
		mov	eax, [ebp+arg_2C]
		mov	[esp+78h+Size],	eax
		mov	[esp+78h+Src], 94h
		mov	eax, [ebp+var_C]
		mov	[esp+78h+Dst], eax
		call	sub_414E31
		add	[ebp+var_C], eax
		mov	eax, [ebp+arg_2C]
		add	[ebp+var_10], eax
		mov	eax, [ebp+arg_34]
		mov	[esp+78h+Size],	eax
		mov	[esp+78h+Src], 95h
		mov	eax, [ebp+var_C]
		mov	[esp+78h+Dst], eax
		call	sub_414E31
		add	[ebp+var_C], eax
		mov	eax, [ebp+arg_34]
		add	[ebp+var_10], eax
		mov	eax, [ebp+arg_3C]
		mov	[esp+78h+Size],	eax
		mov	[esp+78h+Src], 96h
		mov	eax, [ebp+var_C]
		mov	[esp+78h+Dst], eax
		call	sub_414E31
		add	[ebp+var_C], eax
		mov	eax, [ebp+arg_3C]
		add	[ebp+var_10], eax

loc_4150B8:				; CODE XREF: sub_414F0A+143j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 58h
		mov	eax, [eax]
		cmp	eax, 2
		jz	short loc_4150F4
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 58h
		mov	eax, [eax]
		cmp	eax, 4
		jnz	short loc_415117

loc_4150F4:				; CODE XREF: sub_414F0A+1CAj
		mov	eax, [ebp+arg_C]
		mov	[esp+78h+Size],	eax
		mov	[esp+78h+Src], 97h
		mov	eax, [ebp+var_C]
		mov	[esp+78h+Dst], eax
		call	sub_414E31
		add	[ebp+var_C], eax
		mov	eax, [ebp+arg_C]
		add	[ebp+var_10], eax

loc_415117:				; CODE XREF: sub_414F0A+1E8j
		mov	edx, [ebp+var_C]
		lea	eax, [ebp+var_59]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		lea	eax, [ebp+var_60]
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_415146
		cmp	[ebp+arg_4], 1
		jnz	short loc_41513F
		mov	eax, 0FFFFFFB8h
		jmp	short loc_415144
; ---------------------------------------------------------------------------

loc_41513F:				; CODE XREF: sub_414F0A+22Cj
		mov	eax, 0FFFFFFA4h

loc_415144:				; CODE XREF: sub_414F0A+233j
		jmp	short loc_41514B
; ---------------------------------------------------------------------------

loc_415146:				; CODE XREF: sub_414F0A+226j
		mov	eax, 0FFFFFFB6h

loc_41514B:				; CODE XREF: sub_414F0A:loc_415144j
		mov	edx, [ebp+var_C]
		mov	[edx], al
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_18]
		mov	[esp+78h+Size],	eax
		mov	[esp+78h+Src], 7F48h
		mov	eax, [ebp+var_C]
		mov	[esp+78h+Dst], eax
		call	sub_414E31
		add	[ebp+var_C], eax
		mov	edx, [ebp+var_C]
		lea	eax, [ebp+var_60]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+var_65]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+78h+Size],	eax
		mov	[esp+78h+Src], 5F48h
		mov	eax, [ebp+var_C]
		mov	[esp+78h+Dst], eax
		call	sub_414E31
		add	[ebp+var_C], eax
		mov	edx, [ebp+var_C]
		lea	eax, [ebp+var_65]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_1C]
		add	eax, edx
		add	eax, [ebp+var_20]
		add	eax, [ebp+var_10]
		add	eax, 4
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	[esp+78h+Dst], eax
		call	gcry_malloc_secure
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_4151F4
		call	sub_4101BF
		jmp	locret_415463
; ---------------------------------------------------------------------------

loc_4151F4:				; CODE XREF: sub_414F0A+2DEj
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_1C]
		add	eax, edx
		add	eax, [ebp+var_20]
		add	eax, [ebp+var_10]
		mov	[esp+78h+Size],	eax
		mov	[esp+78h+Src], 4Dh
		mov	eax, [ebp+var_C]
		mov	[esp+78h+Dst], eax
		call	sub_414E31
		add	[ebp+var_C], eax
		lea	edx, [ebp+var_60]
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+var_1C]
		mov	[esp+78h+Size],	ecx ; Size
		mov	[esp+78h+Src], edx ; Src
		mov	[esp+78h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_1C]
		add	[ebp+var_C], eax
		lea	edx, [ebp+var_59]
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+var_18]
		mov	[esp+78h+Size],	ecx ; Size
		mov	[esp+78h+Src], edx ; Src
		mov	[esp+78h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_18]
		add	[ebp+var_C], eax
		lea	edx, [ebp+var_65]
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+var_20]
		mov	[esp+78h+Size],	ecx ; Size
		mov	[esp+78h+Src], edx ; Src
		mov	[esp+78h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_20]
		add	[ebp+var_C], eax
		mov	edx, [ebp+arg_10]
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+arg_14]
		mov	[esp+78h+Size],	ecx ; Size
		mov	[esp+78h+Src], edx ; Src
		mov	[esp+78h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_14]
		cmp	eax, [ebp+var_14]
		jnb	short loc_4152DE
		mov	eax, [ebp+arg_14]
		mov	edx, [ebp+var_14]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, [ebp+var_C]
		mov	edx, [ebp+arg_14]
		mov	[esp+78h+Size],	edx ; Size
		mov	edx, [ebp+var_C]
		mov	[esp+78h+Src], edx ; Src
		mov	[esp+78h+Dst], eax ; Dst
		call	memmove
		mov	eax, [ebp+arg_14]
		mov	edx, [ebp+var_14]
		sub	edx, eax
		mov	eax, [ebp+var_C]
		mov	[esp+78h+Size],	edx ; Size
		mov	[esp+78h+Src], 0 ; Val
		mov	[esp+78h+Dst], eax ; Dst
		call	memset

loc_4152DE:				; CODE XREF: sub_414F0A+38Ej
		mov	eax, [ebp+var_14]
		add	[ebp+var_C], eax
		mov	edx, [ebp+arg_18]
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+arg_1C]
		mov	[esp+78h+Size],	ecx ; Size
		mov	[esp+78h+Src], edx ; Src
		mov	[esp+78h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_1C]
		add	[ebp+var_C], eax
		mov	edx, [ebp+arg_20]
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+arg_24]
		mov	[esp+78h+Size],	ecx ; Size
		mov	[esp+78h+Src], edx ; Src
		mov	[esp+78h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_24]
		add	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 58h
		mov	eax, [eax]
		cmp	eax, 3
		jz	short loc_41535E
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 58h
		mov	eax, [eax]
		cmp	eax, 4
		jnz	short loc_4153BB

loc_41535E:				; CODE XREF: sub_414F0A+434j
		mov	edx, [ebp+arg_28]
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+arg_2C]
		mov	[esp+78h+Size],	ecx ; Size
		mov	[esp+78h+Src], edx ; Src
		mov	[esp+78h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_2C]
		add	[ebp+var_C], eax
		mov	edx, [ebp+arg_30]
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+arg_34]
		mov	[esp+78h+Size],	ecx ; Size
		mov	[esp+78h+Src], edx ; Src
		mov	[esp+78h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_34]
		add	[ebp+var_C], eax
		mov	edx, [ebp+arg_38]
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+arg_3C]
		mov	[esp+78h+Size],	ecx ; Size
		mov	[esp+78h+Src], edx ; Src
		mov	[esp+78h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_3C]
		add	[ebp+var_C], eax

loc_4153BB:				; CODE XREF: sub_414F0A+452j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 58h
		mov	eax, [eax]
		cmp	eax, 2
		jz	short loc_4153F7
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 58h
		mov	eax, [eax]
		cmp	eax, 4
		jnz	short loc_415416

loc_4153F7:				; CODE XREF: sub_414F0A+4CDj
		mov	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+arg_C]
		mov	[esp+78h+Size],	ecx ; Size
		mov	[esp+78h+Src], edx ; Src
		mov	[esp+78h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_C]
		add	[ebp+var_C], eax

loc_415416:				; CODE XREF: sub_414F0A+4EBj
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_28]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+var_24]
		jbe	short loc_415443
		mov	[esp+78h+Size],	9D5h ; int
		mov	[esp+78h+Src], offset a____Gnupg22__2 ;	"../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+78h+Dst], offset aTpTemplateTemp ;	"tp - template <= template_size"
		call	sub_442650

loc_415443:				; CODE XREF: sub_414F0A+51Bj
		mov	eax, [ebp+arg_40]
		mov	edx, [ebp+var_28]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_28]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+arg_44]
		mov	[eax], edx
		mov	eax, 0

locret_415463:				; CODE XREF: sub_414F0A+72j
					; sub_414F0A+2E5j
		leave
		retn
sub_414F0A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415465	proc near		; CODE XREF: sub_415652+106p
					; sub_415770+7BDp

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		cmp	[ebp+arg_4], 0
		js	short loc_415478
		cmp	[ebp+arg_4], 2
		jle	short loc_415496

loc_415478:				; CODE XREF: sub_415465+Bj
		mov	[esp+38h+var_30], 9E9h ; int
		mov	[esp+38h+var_34], offset a____Gnupg22__2 ; "../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+38h+var_38], offset aKeyno0Keyno2 ; "keyno	>=0 && keyno <=	2"
		call	sub_442650
		jmp	short loc_415497
; ---------------------------------------------------------------------------

loc_415496:				; CODE XREF: sub_415465+11j
		nop

loc_415497:				; CODE XREF: sub_415465+2Fj
		cmp	[ebp+arg_8], 1000h
		jbe	short loc_4154B1
		mov	[esp+38h+var_38], 43h
		call	sub_410197
		jmp	loc_41564C
; ---------------------------------------------------------------------------

loc_4154B1:				; CODE XREF: sub_415465+39j
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+0C1h]
		mov	[esp+38h+var_28], 0
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_2C], eax
		lea	eax, [ebp+var_14]
		mov	[esp+38h+var_30], eax
		mov	[esp+38h+var_34], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_41075F
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4154F9
		mov	[esp+38h+var_38], 6Ch
		call	sub_410197
		jmp	loc_41564C
; ---------------------------------------------------------------------------

loc_4154F9:				; CODE XREF: sub_415465+81j
		mov	eax, [ebp+var_18]
		cmp	eax, 5
		jbe	short loc_41550B
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 1
		jz	short loc_415527

loc_41550B:				; CODE XREF: sub_415465+9Aj
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	[esp+38h+var_38], 6Ch
		call	sub_410197
		jmp	loc_41564C
; ---------------------------------------------------------------------------

loc_415527:				; CODE XREF: sub_415465+A4j
		mov	eax, [ebp+arg_8]
		add	eax, 1Fh
		shr	eax, 5
		shl	eax, 5
		mov	[ebp+arg_8], eax
		mov	eax, [ebp+var_14]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_8]
		shr	eax, 8
		mov	[edx], al
		mov	eax, [ebp+var_14]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_8]
		mov	[edx], al
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_413993
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_415584
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		jmp	loc_41564C
; ---------------------------------------------------------------------------

loc_415584:				; CODE XREF: sub_415465+10Aj
		mov	ecx, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_4]
		lea	ebx, [eax+0C1h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+38h+var_28], ecx ;	size_t
		mov	[esp+38h+var_2C], edx ;	void *
		mov	[esp+38h+var_30], ebx ;	int
		mov	[esp+38h+var_34], 0 ; int
		mov	[esp+38h+var_38], eax ;	char
		call	sub_40D4CA
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		cmp	[ebp+var_10], 0
		jz	short loc_4155E8
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	[esp+38h+var_34], edx ;	char
		mov	[esp+38h+var_38], offset aErrorChangingS ; "error changing size	of key %d to %u	bit"...
		call	sub_43CB21
		jmp	short loc_415605
; ---------------------------------------------------------------------------

loc_4155E8:				; CODE XREF: sub_415465+162j
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	[esp+38h+var_34], edx ;	char
		mov	[esp+38h+var_38], offset aSizeOfKeyDChan ; "size of key	%d changed to %u bits\n"
		call	sub_43CAF7

loc_415605:				; CODE XREF: sub_415465+181j
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_41070F
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_418B26
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		and	edx, 0FFFFFFFEh
		mov	[eax+18h], dl
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		and	edx, 0FFFFFFFBh
		mov	[eax+18h], dl
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		and	edx, 0FFFFFFF7h
		mov	[eax+18h], dl
		mov	eax, [ebp+var_10]

loc_41564C:				; CODE XREF: sub_415465+47j
					; sub_415465+8Fj ...
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_415465	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_415652(int, int, int,	void *,	size_t)
sub_415652	proc near		; CODE XREF: sub_413C94+F5p

Dst		= dword	ptr -48h
Src		= dword	ptr -44h
Size		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_10]
		add	eax, 1
		mov	[esp+48h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_415679
		call	sub_4101BF
		jmp	locret_41576E
; ---------------------------------------------------------------------------

loc_415679:				; CODE XREF: sub_415652+1Bj
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	ecx, [ebp+arg_10]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_10]
		add	eax, edx
		mov	byte ptr [eax],	0
		mov	edx, offset aForceDDU ;	" --force %d %d	%u"
		mov	eax, [ebp+var_10]
		lea	ecx, [ebp+var_1C]
		mov	[esp+48h+var_38], ecx
		lea	ecx, [ebp+var_18]
		mov	[esp+48h+var_3C], ecx
		lea	ecx, [ebp+var_14]
		mov	[esp+48h+Size],	ecx
		mov	[esp+48h+Src], edx ; Format
		mov	[esp+48h+Dst], eax ; Src
		call	sscanf
		cmp	eax, 3
		jz	short loc_4156DF
		mov	[esp+48h+Dst], 4Fh
		call	sub_410197
		mov	[ebp+var_C], eax
		jmp	loc_415760
; ---------------------------------------------------------------------------

loc_4156DF:				; CODE XREF: sub_415652+77j
		mov	eax, [ebp+var_14]
		test	eax, eax
		jle	short loc_4156EE
		mov	eax, [ebp+var_14]
		cmp	eax, 3
		jle	short loc_4156FF

loc_4156EE:				; CODE XREF: sub_415652+92j
		mov	[esp+48h+Dst], 76h
		call	sub_410197
		mov	[ebp+var_C], eax
		jmp	short loc_415760
; ---------------------------------------------------------------------------

loc_4156FF:				; CODE XREF: sub_415652+9Aj
		mov	eax, [ebp+var_18]
		cmp	eax, 1
		jz	short loc_415718
		mov	[esp+48h+Dst], 4
		call	sub_410197
		mov	[ebp+var_C], eax
		jmp	short loc_415760
; ---------------------------------------------------------------------------

loc_415718:				; CODE XREF: sub_415652+B3j
		mov	eax, [ebp+var_1C]
		cmp	eax, 3FFh
		ja	short loc_415733
		mov	[esp+48h+Dst], 42h
		call	sub_410197
		mov	[ebp+var_C], eax
		jmp	short loc_415760
; ---------------------------------------------------------------------------

loc_415733:				; CODE XREF: sub_415652+CEj
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_14]
		lea	ecx, [edx-1]
		mov	edx, [ebp+arg_8]
		mov	[esp+48h+var_38], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+Size],	eax
		mov	[esp+48h+Src], ecx
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Dst], eax
		call	sub_415465
		mov	[ebp+var_C], eax

loc_415760:				; CODE XREF: sub_415652+88j
					; sub_415652+ABj ...
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+var_C]

locret_41576E:				; CODE XREF: sub_415652+22j
		leave
		retn
sub_415652	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_415770(int, int, char	*, int,	int, int, int, int)
sub_415770	proc near		; DATA XREF: sub_418EB5+610o

Str1		= dword	ptr -158h
Str2		= dword	ptr -154h
Size		= dword	ptr -150h
var_14C		= dword	ptr -14Ch
var_148		= dword	ptr -148h
var_144		= dword	ptr -144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_134		= dword	ptr -134h
var_130		= dword	ptr -130h
var_12C		= dword	ptr -12Ch
var_128		= dword	ptr -128h
var_124		= dword	ptr -124h
var_120		= dword	ptr -120h
var_11C		= dword	ptr -11Ch
var_118		= dword	ptr -118h
var_114		= dword	ptr -114h
var_FC		= dword	ptr -0FCh
var_F8		= dword	ptr -0F8h
var_F4		= dword	ptr -0F4h
var_F0		= dword	ptr -0F0h
var_EC		= dword	ptr -0ECh
var_E8		= dword	ptr -0E8h
var_E4		= dword	ptr -0E4h
var_E0		= dword	ptr -0E0h
var_DC		= dword	ptr -0DCh
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_C4		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_BC		= dword	ptr -0BCh
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= byte ptr -0A8h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
Src		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= byte ptr -64h
Buf2		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
Dst		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 14Ch
		mov	eax, [ebp+arg_C]
		and	eax, 1
		mov	[ebp+var_38], eax
		mov	[ebp+var_70], 0
		mov	[ebp+Src], 0
		mov	[ebp+var_78], 0
		mov	[ebp+var_7C], 0
		mov	[ebp+var_90], 0
		mov	[ebp+var_28], 0
		mov	[esp+158h+Str2], offset	aOpenpgp_1 ; "OPENPGP.1"
		mov	eax, [ebp+arg_8]
		mov	[esp+158h+Str1], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4157D2
		mov	[ebp+var_20], 0
		jmp	short loc_415823
; ---------------------------------------------------------------------------

loc_4157D2:				; CODE XREF: sub_415770+57j
		mov	[esp+158h+Str2], offset	aOpenpgp_2 ; "OPENPGP.2"
		mov	eax, [ebp+arg_8]
		mov	[esp+158h+Str1], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4157F2
		mov	[ebp+var_20], 1
		jmp	short loc_415823
; ---------------------------------------------------------------------------

loc_4157F2:				; CODE XREF: sub_415770+77j
		mov	[esp+158h+Str2], offset	aOpenpgp_3 ; "OPENPGP.3"
		mov	eax, [ebp+arg_8]
		mov	[esp+158h+Str1], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_415812
		mov	[ebp+var_20], 2
		jmp	short loc_415823
; ---------------------------------------------------------------------------

loc_415812:				; CODE XREF: sub_415770+97j
		mov	[esp+158h+Str1], 76h
		call	sub_410197
		jmp	loc_4168A6
; ---------------------------------------------------------------------------

loc_415823:				; CODE XREF: sub_415770+60j
					; sub_415770+80j ...
		mov	eax, [ebp+var_38]
		mov	[esp+158h+var_14C], eax
		mov	[esp+158h+Size], 0
		mov	eax, [ebp+var_20]
		mov	[esp+158h+Str2], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+158h+Str1], eax
		call	sub_414C8D
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_415855
		mov	eax, [ebp+var_1C]
		jmp	loc_4168A6
; ---------------------------------------------------------------------------

loc_415855:				; CODE XREF: sub_415770+DBj
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_5C], eax
		mov	eax, [ebp+arg_1C]
		mov	dword ptr [ebp+var_64],	eax
		mov	[ebp+var_6C], 0
		mov	[esp+158h+var_144], 6
		lea	eax, [ebp+var_68]
		mov	[esp+158h+var_148], eax
		lea	eax, [ebp+Buf2]
		mov	[esp+158h+var_14C], eax
		lea	eax, [ebp+var_6C]
		mov	[esp+158h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+158h+Str2], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+158h+Str1], eax
		call	sub_42D68E
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_416870
		mov	[esp+158h+var_144], 6
		lea	eax, [ebp+var_68]
		mov	[esp+158h+var_148], eax
		lea	eax, [ebp+Buf2]
		mov	[esp+158h+var_14C], eax
		lea	eax, [ebp+var_6C]
		mov	[esp+158h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+158h+Str2], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+158h+Str1], eax
		call	sub_42D68E
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_416873
		mov	eax, [ebp+Buf2]
		test	eax, eax
		jz	short loc_415911
		mov	eax, [ebp+var_68]
		cmp	eax, 0Bh
		jnz	short loc_415911
		mov	edx, [ebp+var_68]
		mov	eax, [ebp+Buf2]
		mov	[esp+158h+Size], edx ; Size
		mov	[esp+158h+Str2], eax ; Buf2
		mov	[esp+158h+Str1], offset	aPrivateKey ; "private-key"
		call	memcmp
		test	eax, eax
		jz	loc_415992

loc_415911:				; CODE XREF: sub_415770+175j
					; sub_415770+17Dj
		mov	eax, [ebp+Buf2]
		test	eax, eax
		jz	short loc_41597E
		mov	eax, [ebp+var_68]
		cmp	eax, 15h
		jnz	short loc_41594C
		mov	edx, [ebp+var_68]
		mov	eax, [ebp+Buf2]
		mov	[esp+158h+Size], edx ; Size
		mov	[esp+158h+Str2], eax ; char
		mov	[esp+158h+Str1], offset	aProtectedPriva	; "protected-private-key"
		call	memcmp
		test	eax, eax
		jnz	short loc_41594C
		mov	[esp+158h+Str1], offset	aProtectedPri_0	; "protected-private-key passed	to writeke"...
		call	sub_43CAF7
		jmp	short loc_41597E
; ---------------------------------------------------------------------------

loc_41594C:				; CODE XREF: sub_415770+1AEj
					; sub_415770+1CCj
		mov	eax, [ebp+var_68]
		cmp	eax, 14h
		jnz	short loc_41597E
		mov	edx, [ebp+var_68]
		mov	eax, [ebp+Buf2]
		mov	[esp+158h+Size], edx ; Size
		mov	[esp+158h+Str2], eax ; char
		mov	[esp+158h+Str1], offset	aShadowedPrivat	; "shadowed-private-key"
		call	memcmp
		test	eax, eax
		jnz	short loc_41597E
		mov	[esp+158h+Str1], offset	aShadowedPriv_0	; "shadowed-private-key	passed to writekey"...
		call	sub_43CAF7

loc_41597E:				; CODE XREF: sub_415770+1A6j
					; sub_415770+1DAj ...
		mov	[esp+158h+Str1], 7
		call	sub_410197
		mov	[ebp+var_1C], eax
		jmp	loc_416895
; ---------------------------------------------------------------------------

loc_415992:				; CODE XREF: sub_415770+19Bj
		mov	[esp+158h+var_144], 6
		lea	eax, [ebp+var_68]
		mov	[esp+158h+var_148], eax
		lea	eax, [ebp+Buf2]
		mov	[esp+158h+var_14C], eax
		lea	eax, [ebp+var_6C]
		mov	[esp+158h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+158h+Str2], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+158h+Str1], eax
		call	sub_42D68E
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_416876
		mov	[esp+158h+var_144], 6
		lea	eax, [ebp+var_68]
		mov	[esp+158h+var_148], eax
		lea	eax, [ebp+Buf2]
		mov	[esp+158h+var_14C], eax
		lea	eax, [ebp+var_6C]
		mov	[esp+158h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+158h+Str2], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+158h+Str1], eax
		call	sub_42D68E
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_416879
		mov	eax, [ebp+Buf2]
		test	eax, eax
		jz	short loc_415A37
		mov	eax, [ebp+var_68]
		cmp	eax, 3
		jnz	short loc_415A37
		mov	edx, [ebp+var_68]
		mov	eax, [ebp+Buf2]
		mov	[esp+158h+Size], edx ; Size
		mov	[esp+158h+Str2], eax ; Buf2
		mov	[esp+158h+Str1], offset	aRsa ; "rsa"
		call	memcmp
		test	eax, eax
		jz	short loc_415A4B

loc_415A37:				; CODE XREF: sub_415770+29Fj
					; sub_415770+2A7j
		mov	[esp+158h+Str1], 29h
		call	sub_410197
		mov	[ebp+var_1C], eax
		jmp	loc_416895
; ---------------------------------------------------------------------------

loc_415A4B:				; CODE XREF: sub_415770+2C5j
		mov	eax, [ebp+var_6C]
		mov	[ebp+var_3C], eax
		jmp	loc_415C32
; ---------------------------------------------------------------------------

loc_415A56:				; CODE XREF: sub_415770+507j
		mov	eax, [ebp+Buf2]
		test	eax, eax
		jz	short loc_415A71
		mov	[esp+158h+Str1], 68h
		call	sub_410197
		mov	[ebp+var_1C], eax
		jmp	loc_416895
; ---------------------------------------------------------------------------

loc_415A71:				; CODE XREF: sub_415770+2EBj
		mov	[esp+158h+var_144], 6
		lea	eax, [ebp+var_68]
		mov	[esp+158h+var_148], eax
		lea	eax, [ebp+Buf2]
		mov	[esp+158h+var_14C], eax
		lea	eax, [ebp+var_6C]
		mov	[esp+158h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+158h+Str2], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+158h+Str1], eax
		call	sub_42D68E
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_41687C
		mov	eax, [ebp+Buf2]
		test	eax, eax
		jz	loc_415BDB
		mov	eax, [ebp+var_68]
		cmp	eax, 1
		jnz	loc_415BDB
		mov	eax, [ebp+Buf2]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, 6Eh
		jz	short loc_415AEA
		cmp	eax, 6Eh
		jg	short loc_415ADE
		cmp	eax, 65h
		jz	short loc_415AF8
		jmp	short loc_415B2B
; ---------------------------------------------------------------------------

loc_415ADE:				; CODE XREF: sub_415770+365j
		cmp	eax, 70h
		jz	short loc_415B09
		cmp	eax, 71h
		jz	short loc_415B1A
		jmp	short loc_415B2B
; ---------------------------------------------------------------------------

loc_415AEA:				; CODE XREF: sub_415770+360j
		lea	eax, [ebp+var_70]
		mov	[ebp+var_2C], eax
		lea	eax, [ebp+var_80]
		mov	[ebp+var_30], eax
		jmp	short loc_415B3A
; ---------------------------------------------------------------------------

loc_415AF8:				; CODE XREF: sub_415770+36Aj
		lea	eax, [ebp+Src]
		mov	[ebp+var_2C], eax
		lea	eax, [ebp+var_84]
		mov	[ebp+var_30], eax
		jmp	short loc_415B3A
; ---------------------------------------------------------------------------

loc_415B09:				; CODE XREF: sub_415770+371j
		lea	eax, [ebp+var_78]
		mov	[ebp+var_2C], eax
		lea	eax, [ebp+var_88]
		mov	[ebp+var_30], eax
		jmp	short loc_415B3A
; ---------------------------------------------------------------------------

loc_415B1A:				; CODE XREF: sub_415770+376j
		lea	eax, [ebp+var_7C]
		mov	[ebp+var_2C], eax
		lea	eax, [ebp+var_8C]
		mov	[ebp+var_30], eax
		jmp	short loc_415B3A
; ---------------------------------------------------------------------------

loc_415B2B:				; CODE XREF: sub_415770+36Cj
					; sub_415770+378j
		mov	[ebp+var_2C], 0
		mov	[ebp+var_30], 0
		nop

loc_415B3A:				; CODE XREF: sub_415770+386j
					; sub_415770+397j ...
		cmp	[ebp+var_2C], 0
		jz	short loc_415B5D
		mov	eax, [ebp+var_2C]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_415B5D
		mov	[esp+158h+Str1], 9Dh
		call	sub_410197
		mov	[ebp+var_1C], eax
		jmp	loc_416895
; ---------------------------------------------------------------------------

loc_415B5D:				; CODE XREF: sub_415770+3CEj
					; sub_415770+3D7j
		mov	[esp+158h+var_144], 6
		lea	eax, [ebp+var_68]
		mov	[esp+158h+var_148], eax
		lea	eax, [ebp+Buf2]
		mov	[esp+158h+var_14C], eax
		lea	eax, [ebp+var_6C]
		mov	[esp+158h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+158h+Str2], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+158h+Str1], eax
		call	sub_42D68E
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_41687F
		mov	eax, [ebp+Buf2]
		test	eax, eax
		jz	short loc_415BDB
		cmp	[ebp+var_2C], 0
		jz	short loc_415BDB
		jmp	short loc_415BBA
; ---------------------------------------------------------------------------

loc_415BA8:				; CODE XREF: sub_415770+459j
		mov	eax, [ebp+var_68]
		sub	eax, 1
		mov	[ebp+var_68], eax
		mov	eax, [ebp+Buf2]
		add	eax, 1
		mov	[ebp+Buf2], eax

loc_415BBA:				; CODE XREF: sub_415770+436j
		mov	eax, [ebp+var_68]
		test	eax, eax
		jz	short loc_415BCB
		mov	eax, [ebp+Buf2]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_415BA8

loc_415BCB:				; CODE XREF: sub_415770+44Fj
		mov	edx, [ebp+Buf2]
		mov	eax, [ebp+var_2C]
		mov	[eax], edx
		mov	edx, [ebp+var_68]
		mov	eax, [ebp+var_30]
		mov	[eax], edx

loc_415BDB:				; CODE XREF: sub_415770+342j
					; sub_415770+34Ej ...
		mov	eax, [ebp+var_6C]
		mov	[ebp+var_40], eax

loc_415BE1:				; CODE XREF: sub_415770+4B6j
		mov	[esp+158h+var_144], 6
		lea	eax, [ebp+var_68]
		mov	[esp+158h+var_148], eax
		lea	eax, [ebp+Buf2]
		mov	[esp+158h+var_14C], eax
		lea	eax, [ebp+var_6C]
		mov	[esp+158h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+158h+Str2], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+158h+Str1], eax
		call	sub_42D68E
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_415C28
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jz	short loc_415C28
		mov	eax, [ebp+var_6C]
		cmp	eax, [ebp+var_40]
		jge	short loc_415BE1

loc_415C28:				; CODE XREF: sub_415770+4A7j
					; sub_415770+4AEj
		cmp	[ebp+var_1C], 0
		jnz	loc_416882

loc_415C32:				; CODE XREF: sub_415770+2E1j
		mov	[esp+158h+var_144], 6
		lea	eax, [ebp+var_68]
		mov	[esp+158h+var_148], eax
		lea	eax, [ebp+Buf2]
		mov	[esp+158h+var_14C], eax
		lea	eax, [ebp+var_6C]
		mov	[esp+158h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+158h+Str2], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+158h+Str1], eax
		call	sub_42D68E
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_415C7D
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jz	short loc_415C7D
		mov	eax, [ebp+var_6C]
		cmp	eax, [ebp+var_3C]
		jge	loc_415A56

loc_415C7D:				; CODE XREF: sub_415770+4F8j
					; sub_415770+4FFj
		mov	eax, [ebp+var_6C]
		mov	[ebp+var_3C], eax
		jmp	loc_415E11
; ---------------------------------------------------------------------------

loc_415C88:				; CODE XREF: sub_415770+6E6j
		mov	eax, [ebp+Buf2]
		test	eax, eax
		jz	short loc_415CA3
		mov	[esp+158h+Str1], 68h
		call	sub_410197
		mov	[ebp+var_1C], eax
		jmp	loc_416895
; ---------------------------------------------------------------------------

loc_415CA3:				; CODE XREF: sub_415770+51Dj
		mov	[esp+158h+var_144], 6
		lea	eax, [ebp+var_68]
		mov	[esp+158h+var_148], eax
		lea	eax, [ebp+Buf2]
		mov	[esp+158h+var_14C], eax
		lea	eax, [ebp+var_6C]
		mov	[esp+158h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+158h+Str2], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+158h+Str1], eax
		call	sub_42D68E
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_416885
		mov	eax, [ebp+Buf2]
		test	eax, eax
		jz	loc_415DBA
		mov	eax, [ebp+var_68]
		cmp	eax, 0Ah
		jnz	loc_415DBA
		mov	edx, [ebp+var_68]
		mov	eax, [ebp+Buf2]
		mov	[esp+158h+Size], edx ; Size
		mov	[esp+158h+Str2], eax ; Buf2
		mov	[esp+158h+Str1], offset	aCreatedAt ; "created-at"
		call	memcmp
		test	eax, eax
		jnz	loc_415DBA
		mov	[esp+158h+var_144], 6
		lea	eax, [ebp+var_68]
		mov	[esp+158h+var_148], eax
		lea	eax, [ebp+Buf2]
		mov	[esp+158h+var_14C], eax
		lea	eax, [ebp+var_6C]
		mov	[esp+158h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+158h+Str2], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+158h+Str1], eax
		call	sub_42D68E
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_416888
		mov	eax, [ebp+Buf2]
		test	eax, eax
		jz	short loc_415DBA
		mov	[ebp+var_28], 0
		jmp	short loc_415D95
; ---------------------------------------------------------------------------

loc_415D64:				; CODE XREF: sub_415770+648j
		mov	edx, [ebp+var_28]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+Buf2]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		add	eax, edx
		sub	eax, 30h
		mov	[ebp+var_28], eax
		mov	eax, [ebp+Buf2]
		add	eax, 1
		mov	[ebp+Buf2], eax
		mov	eax, [ebp+var_68]
		sub	eax, 1
		mov	[ebp+var_68], eax

loc_415D95:				; CODE XREF: sub_415770+5F2j
		mov	eax, [ebp+var_68]
		test	eax, eax
		jz	short loc_415DBA
		mov	eax, [ebp+Buf2]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_415DBA
		mov	eax, [ebp+Buf2]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_415DBA
		mov	eax, [ebp+Buf2]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jbe	short loc_415D64

loc_415DBA:				; CODE XREF: sub_415770+574j
					; sub_415770+580j ...
		mov	eax, [ebp+var_6C]
		mov	[ebp+var_40], eax

loc_415DC0:				; CODE XREF: sub_415770+695j
		mov	[esp+158h+var_144], 6
		lea	eax, [ebp+var_68]
		mov	[esp+158h+var_148], eax
		lea	eax, [ebp+Buf2]
		mov	[esp+158h+var_14C], eax
		lea	eax, [ebp+var_6C]
		mov	[esp+158h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+158h+Str2], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+158h+Str1], eax
		call	sub_42D68E
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_415E07
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jz	short loc_415E07
		mov	eax, [ebp+var_6C]
		cmp	eax, [ebp+var_40]
		jge	short loc_415DC0

loc_415E07:				; CODE XREF: sub_415770+686j
					; sub_415770+68Dj
		cmp	[ebp+var_1C], 0
		jnz	loc_41688B

loc_415E11:				; CODE XREF: sub_415770+513j
		mov	[esp+158h+var_144], 6
		lea	eax, [ebp+var_68]
		mov	[esp+158h+var_148], eax
		lea	eax, [ebp+Buf2]
		mov	[esp+158h+var_14C], eax
		lea	eax, [ebp+var_6C]
		mov	[esp+158h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+158h+Str2], eax ; char
		lea	eax, [ebp+var_5C]
		mov	[esp+158h+Str1], eax
		call	sub_42D68E
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_415E5C
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jz	short loc_415E5C
		mov	eax, [ebp+var_6C]
		cmp	eax, [ebp+var_3C]
		jge	loc_415C88

loc_415E5C:				; CODE XREF: sub_415770+6D7j
					; sub_415770+6DEj
		cmp	[ebp+var_28], 0
		jnz	short loc_415E8A
		mov	[esp+158h+Str1], offset	aCreationTimest	; "creation timestamp missing\n"
		call	sub_43C238
		mov	[esp+158h+Str1], eax ; char *
		call	sub_43CB21
		mov	[esp+158h+Str1], 37h
		call	sub_410197
		mov	[ebp+var_1C], eax
		jmp	loc_416895
; ---------------------------------------------------------------------------

loc_415E8A:				; CODE XREF: sub_415770+6F0j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+var_20]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 50h
		mov	eax, [eax]
		mov	dword ptr [ebp+var_24],	eax
		mov	eax, [ebp+var_70]
		test	eax, eax
		jz	short loc_415EC1
		mov	edx, [ebp+var_80]
		mov	eax, [ebp+var_70]
		mov	[esp+158h+Str2], edx
		mov	[esp+158h+Str1], eax
		call	sub_410E3F
		jmp	short loc_415EC6
; ---------------------------------------------------------------------------

loc_415EC1:				; CODE XREF: sub_415770+73Bj
		mov	eax, 0

loc_415EC6:				; CODE XREF: sub_415770+74Fj
		mov	dword ptr [ebp+var_44],	eax
		mov	eax, ds:dword_451D24
		test	eax, eax
		jz	short loc_415EEC
		mov	eax, [ebp+var_80]
		mov	[esp+158h+Size], eax
		mov	eax, dword ptr [ebp+var_44]
		mov	[esp+158h+Str2], eax ; char
		mov	[esp+158h+Str1], offset	aRsaModulusSize	; "RSA modulus size is %u bits (%u bytes)\"...
		call	sub_43CAF7

loc_415EEC:				; CODE XREF: sub_415770+760j
		cmp	dword ptr [ebp+var_44],	0
		jz	short loc_415F57
		mov	eax, dword ptr [ebp+var_44]
		cmp	eax, dword ptr [ebp+var_24]
		jz	short loc_415F57
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 20h
		test	al, al
		jz	short loc_415F57
		mov	eax, [ebp+arg_14]
		mov	[esp+158h+var_148], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+158h+var_14C], eax
		mov	eax, dword ptr [ebp+var_44]
		mov	[esp+158h+Size], eax
		mov	eax, [ebp+var_20]
		mov	[esp+158h+Str2], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+158h+Str1], eax
		call	sub_415465
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_415F57
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+var_20]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 50h
		mov	eax, [eax]
		mov	dword ptr [ebp+var_24],	eax

loc_415F57:				; CODE XREF: sub_415770+780j
					; sub_415770+788j ...
		mov	eax, dword ptr [ebp+var_44]
		cmp	eax, dword ptr [ebp+var_24]
		jz	short loc_415F8E
		mov	ebx, dword ptr [ebp+var_24]
		mov	[esp+158h+Str1], offset	aRsaModulusMiss	; "RSA modulus missing or not of size %d b"...
		call	sub_43C238
		mov	[esp+158h+Str2], ebx ; char
		mov	[esp+158h+Str1], eax ; char *
		call	sub_43CB21
		mov	[esp+158h+Str1], 7
		call	sub_410197
		mov	[ebp+var_1C], eax
		jmp	loc_416895
; ---------------------------------------------------------------------------

loc_415F8E:				; CODE XREF: sub_415770+7EDj
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+var_20]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 54h
		mov	eax, [eax]
		mov	dword ptr [ebp+var_24],	eax
		cmp	dword ptr [ebp+var_24],	20h
		jbe	short loc_415FC8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 1
		test	al, al
		jnz	short loc_415FC8
		mov	dword ptr [ebp+var_24],	20h

loc_415FC8:				; CODE XREF: sub_415770+83Ej
					; sub_415770+84Fj
		mov	eax, [ebp+Src]
		test	eax, eax
		jz	short loc_415FE6
		mov	edx, [ebp+var_84]
		mov	eax, [ebp+Src]
		mov	[esp+158h+Str2], edx
		mov	[esp+158h+Str1], eax
		call	sub_410E3F
		jmp	short loc_415FEB
; ---------------------------------------------------------------------------

loc_415FE6:				; CODE XREF: sub_415770+85Dj
		mov	eax, 0

loc_415FEB:				; CODE XREF: sub_415770+874j
		mov	dword ptr [ebp+var_44],	eax
		cmp	dword ptr [ebp+var_44],	1
		jbe	short loc_415FFC
		mov	eax, dword ptr [ebp+var_44]
		cmp	eax, dword ptr [ebp+var_24]
		jbe	short loc_41602B

loc_415FFC:				; CODE XREF: sub_415770+882j
		mov	ebx, dword ptr [ebp+var_24]
		mov	[esp+158h+Str1], offset	aRsaPublicExpon	; "RSA public exponent missing or larger t"...
		call	sub_43C238
		mov	[esp+158h+Str2], ebx ; char
		mov	[esp+158h+Str1], eax ; char *
		call	sub_43CB21
		mov	[esp+158h+Str1], 7
		call	sub_410197
		mov	[ebp+var_1C], eax
		jmp	loc_416895
; ---------------------------------------------------------------------------

loc_41602B:				; CODE XREF: sub_415770+88Aj
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+var_20]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 50h
		mov	eax, [eax]
		shr	eax, 1
		mov	dword ptr [ebp+var_24],	eax
		mov	eax, [ebp+var_78]
		test	eax, eax
		jz	short loc_416067
		mov	edx, [ebp+var_88]
		mov	eax, [ebp+var_78]
		mov	[esp+158h+Str2], edx
		mov	[esp+158h+Str1], eax
		call	sub_410E3F
		jmp	short loc_41606C
; ---------------------------------------------------------------------------

loc_416067:				; CODE XREF: sub_415770+8DEj
		mov	eax, 0

loc_41606C:				; CODE XREF: sub_415770+8F5j
		mov	dword ptr [ebp+var_44],	eax
		mov	eax, dword ptr [ebp+var_44]
		cmp	eax, dword ptr [ebp+var_24]
		jz	short loc_4160AE
		mov	ebx, dword ptr [ebp+var_24]
		mov	[esp+158h+Str1], offset	aRsaPrimeSMissi	; "RSA prime %s	missing	or not of size %d "...
		call	sub_43C238
		mov	[esp+158h+Size], ebx
		mov	[esp+158h+Str2], offset	aP ; "P"
		mov	[esp+158h+Str1], eax ; char *
		call	sub_43CB21
		mov	[esp+158h+Str1], 7
		call	sub_410197
		mov	[ebp+var_1C], eax
		jmp	loc_416895
; ---------------------------------------------------------------------------

loc_4160AE:				; CODE XREF: sub_415770+905j
		mov	eax, [ebp+var_7C]
		test	eax, eax
		jz	short loc_4160CC
		mov	edx, [ebp+var_8C]
		mov	eax, [ebp+var_7C]
		mov	[esp+158h+Str2], edx
		mov	[esp+158h+Str1], eax
		call	sub_410E3F
		jmp	short loc_4160D1
; ---------------------------------------------------------------------------

loc_4160CC:				; CODE XREF: sub_415770+943j
		mov	eax, 0

loc_4160D1:				; CODE XREF: sub_415770+95Aj
		mov	dword ptr [ebp+var_44],	eax
		mov	eax, dword ptr [ebp+var_44]
		cmp	eax, dword ptr [ebp+var_24]
		jz	short loc_416113
		mov	ebx, dword ptr [ebp+var_24]
		mov	[esp+158h+Str1], offset	aRsaPrimeSMissi	; "RSA prime %s	missing	or not of size %d "...
		call	sub_43C238
		mov	[esp+158h+Size], ebx
		mov	[esp+158h+Str2], offset	aQ ; "Q"
		mov	[esp+158h+Str1], eax ; char *
		call	sub_43CB21
		mov	[esp+158h+Str1], 7
		call	sub_410197
		mov	[ebp+var_1C], eax
		jmp	loc_416895
; ---------------------------------------------------------------------------

loc_416113:				; CODE XREF: sub_415770+96Aj
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+var_20]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 8
		mov	eax, [eax]
		mov	[esp+158h+Str1], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+var_20]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 8
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+var_20]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 0Ch
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+var_20]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 4
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 1
		test	al, al
		jz	loc_4165BF
		mov	[esp+158h+Str1], 0
		call	gcry_mpi_snew
		mov	[ebp+var_48], eax
		mov	[esp+158h+Str1], 0
		call	gcry_mpi_snew
		mov	[ebp+var_4C], eax
		mov	[esp+158h+Str1], 0
		call	gcry_mpi_snew
		mov	[ebp+var_50], eax
		mov	[esp+158h+Str1], 0
		call	gcry_mpi_snew
		mov	[ebp+var_54], eax
		mov	edx, [ebp+var_84]
		mov	eax, [ebp+Src]
		mov	[esp+158h+var_148], 0
		mov	[esp+158h+var_14C], edx
		mov	[esp+158h+Size], eax
		mov	[esp+158h+Str2], 5
		lea	eax, [ebp+var_C4]
		mov	[esp+158h+Str1], eax
		call	gcry_mpi_scan
		mov	edx, [ebp+var_88]
		mov	eax, [ebp+var_78]
		mov	[esp+158h+var_148], 0
		mov	[esp+158h+var_14C], edx
		mov	[esp+158h+Size], eax
		mov	[esp+158h+Str2], 5
		lea	eax, [ebp+var_C8]
		mov	[esp+158h+Str1], eax
		call	gcry_mpi_scan
		mov	edx, [ebp+var_8C]
		mov	eax, [ebp+var_7C]
		mov	[esp+158h+var_148], 0
		mov	[esp+158h+var_14C], edx
		mov	[esp+158h+Size], eax
		mov	[esp+158h+Str2], 5
		lea	eax, [ebp+var_CC]
		mov	[esp+158h+Str1], eax
		call	gcry_mpi_scan
		mov	edx, [ebp+var_C8]
		mov	eax, [ebp+var_CC]
		mov	[esp+158h+Size], edx
		mov	[esp+158h+Str2], eax
		mov	eax, [ebp+var_48]
		mov	[esp+158h+Str1], eax
		call	gcry_mpi_invm
		mov	eax, [ebp+var_C8]
		mov	[esp+158h+Size], 1
		mov	[esp+158h+Str2], eax
		mov	eax, [ebp+var_54]
		mov	[esp+158h+Str1], eax
		call	gcry_mpi_sub_ui
		mov	eax, [ebp+var_C4]
		mov	edx, [ebp+var_54]
		mov	[esp+158h+Size], edx
		mov	[esp+158h+Str2], eax
		mov	eax, [ebp+var_4C]
		mov	[esp+158h+Str1], eax
		call	gcry_mpi_invm
		mov	eax, [ebp+var_CC]
		mov	[esp+158h+Size], 1
		mov	[esp+158h+Str2], eax
		mov	eax, [ebp+var_54]
		mov	[esp+158h+Str1], eax
		call	gcry_mpi_sub_ui
		mov	eax, [ebp+var_C4]
		mov	edx, [ebp+var_54]
		mov	[esp+158h+Size], edx
		mov	[esp+158h+Str2], eax
		mov	eax, [ebp+var_50]
		mov	[esp+158h+Str1], eax
		call	gcry_mpi_invm
		mov	eax, [ebp+var_48]
		mov	[esp+158h+var_14C], eax
		lea	eax, [ebp+var_B8]
		mov	[esp+158h+Size], eax
		lea	eax, [ebp+var_AC]
		mov	[esp+158h+Str2], eax
		mov	[esp+158h+Str1], 5
		call	gcry_mpi_aprint
		mov	eax, [ebp+var_4C]
		mov	[esp+158h+var_14C], eax
		lea	eax, [ebp+var_BC]
		mov	[esp+158h+Size], eax
		lea	eax, [ebp+var_B0]
		mov	[esp+158h+Str2], eax
		mov	[esp+158h+Str1], 5
		call	gcry_mpi_aprint
		mov	eax, [ebp+var_50]
		mov	[esp+158h+var_14C], eax
		lea	eax, [ebp+var_C0]
		mov	[esp+158h+Size], eax
		lea	eax, [ebp+var_B4]
		mov	[esp+158h+Str2], eax
		mov	[esp+158h+Str1], 5
		call	gcry_mpi_aprint
		mov	eax, [ebp+var_C4]
		mov	[esp+158h+Str1], eax
		call	gcry_mpi_release
		mov	eax, [ebp+var_C8]
		mov	[esp+158h+Str1], eax
		call	gcry_mpi_release
		mov	eax, [ebp+var_CC]
		mov	[esp+158h+Str1], eax
		call	gcry_mpi_release
		mov	eax, [ebp+var_48]
		mov	[esp+158h+Str1], eax
		call	gcry_mpi_release
		mov	eax, [ebp+var_4C]
		mov	[esp+158h+Str1], eax
		call	gcry_mpi_release
		mov	eax, [ebp+var_50]
		mov	[esp+158h+Str1], eax
		call	gcry_mpi_release
		mov	eax, [ebp+var_54]
		mov	[esp+158h+Str1], eax
		call	gcry_mpi_release
		mov	ecx, [ebp+var_C0]
		mov	esi, [ebp+var_B4]
		mov	eax, [ebp+var_BC]
		mov	[ebp+var_DC], eax
		mov	ebx, [ebp+var_B0]
		mov	[ebp+var_E0], ebx
		mov	eax, [ebp+var_B8]
		mov	[ebp+var_E4], eax
		mov	ebx, [ebp+var_AC]
		mov	[ebp+var_E8], ebx
		mov	eax, [ebp+var_8C]
		mov	[ebp+var_EC], eax
		mov	ebx, [ebp+var_7C]
		mov	[ebp+var_F0], ebx
		mov	eax, [ebp+var_88]
		mov	[ebp+var_F4], eax
		mov	ebx, [ebp+var_78]
		mov	[ebp+var_F8], ebx
		mov	eax, [ebp+var_84]
		mov	[ebp+var_FC], eax
		mov	edi, [ebp+Src]
		mov	ebx, [ebp+var_80]
		mov	edx, [ebp+var_70]
		lea	eax, [ebp+var_94]
		mov	[esp+158h+var_114], eax	; int
		lea	eax, [ebp+var_90]
		mov	[esp+158h+var_118], eax	; int
		mov	[esp+158h+var_11C], ecx	; size_t
		mov	[esp+158h+var_120], esi	; void *
		mov	ecx, [ebp+var_DC]
		mov	[esp+158h+var_124], ecx	; size_t
		mov	eax, [ebp+var_E0]
		mov	[esp+158h+var_128], eax	; void *
		mov	ecx, [ebp+var_E4]
		mov	[esp+158h+var_12C], ecx	; size_t
		mov	eax, [ebp+var_E8]
		mov	[esp+158h+var_130], eax	; void *
		mov	ecx, [ebp+var_EC]
		mov	[esp+158h+var_134], ecx	; size_t
		mov	eax, [ebp+var_F0]
		mov	[esp+158h+var_138], eax	; void *
		mov	ecx, [ebp+var_F4]
		mov	[esp+158h+var_13C], ecx	; size_t
		mov	eax, [ebp+var_F8]
		mov	[esp+158h+var_140], eax	; void *
		mov	ecx, [ebp+var_FC]
		mov	[esp+158h+var_144], ecx	; size_t
		mov	[esp+158h+var_148], edi	; void *
		mov	[esp+158h+var_14C], ebx	; size_t
		mov	[esp+158h+Size], edx ; void *
		mov	eax, [ebp+var_20]
		mov	[esp+158h+Str2], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+158h+Str1], eax ; int
		call	sub_414F0A
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_AC]
		mov	[esp+158h+Str1], eax
		call	gcry_free
		mov	eax, [ebp+var_B0]
		mov	[esp+158h+Str1], eax
		call	gcry_free
		mov	eax, [ebp+var_B4]
		mov	[esp+158h+Str1], eax
		call	gcry_free
		cmp	[ebp+var_1C], 0
		jnz	loc_41688E
		mov	eax, [ebp+arg_14]
		mov	[esp+158h+Size], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+158h+Str2], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+158h+Str1], eax
		call	sub_413993
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_416891
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+30h]
		and	eax, 2
		test	al, al
		jz	short loc_416558
		mov	eax, [ebp+var_94]
		cmp	eax, 0FEh
		jbe	short loc_416558
		mov	[ebp+var_34], 1
		jmp	short loc_416586
; ---------------------------------------------------------------------------

loc_416558:				; CODE XREF: sub_415770+DD0j
					; sub_415770+DDDj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+30h]
		and	eax, 1
		test	al, al
		jz	short loc_41657F
		mov	eax, [ebp+var_94]
		cmp	eax, 0FEh
		jbe	short loc_41657F
		mov	[ebp+var_34], 0FFFFFF02h
		jmp	short loc_416586
; ---------------------------------------------------------------------------

loc_41657F:				; CODE XREF: sub_415770+DF7j
					; sub_415770+E04j
		mov	[ebp+var_34], 0

loc_416586:				; CODE XREF: sub_415770+DE6j
					; sub_415770+E0Dj
		mov	ecx, [ebp+var_94]
		mov	edx, [ebp+var_90]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+158h+var_148], ecx	; size_t
		mov	[esp+158h+var_14C], edx	; void *
		mov	[esp+158h+Size], 3FFFh ; int
		mov	edx, [ebp+var_34]
		mov	[esp+158h+Str2], edx ; int
		mov	[esp+158h+Str1], eax ; char
		call	sub_40D52C
		mov	[ebp+var_1C], eax
		jmp	loc_4167EE
; ---------------------------------------------------------------------------

loc_4165BF:				; CODE XREF: sub_415770+A2Aj
		mov	eax, [ebp+var_84]
		cmp	eax, 4
		jbe	short loc_4165E6
		mov	[esp+158h+Size], 0B6Fh ; int
		mov	[esp+158h+Str2], offset	a____Gnupg22__2	; "../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+158h+Str1], offset	aRsa_e_len4 ; "rsa_e_len <= 4"
		call	sub_442650

loc_4165E6:				; CODE XREF: sub_415770+E58j
		mov	edx, [ebp+var_88]
		mov	eax, [ebp+var_8C]
		add	eax, edx
		add	eax, 0Ah
		mov	[ebp+var_94], eax
		mov	eax, [ebp+var_94]
		mov	[esp+158h+Str1], eax
		call	gcry_malloc_secure
		mov	[ebp+Dst], eax
		mov	eax, [ebp+Dst]
		mov	[ebp+var_90], eax
		mov	eax, [ebp+var_90]
		test	eax, eax
		jnz	short loc_41662E
		call	sub_4101BF
		mov	[ebp+var_1C], eax
		jmp	loc_416895
; ---------------------------------------------------------------------------

loc_41662E:				; CODE XREF: sub_415770+EAFj
		mov	eax, [ebp+Dst]
		mov	byte ptr [eax],	0C0h
		add	[ebp+Dst], 1
		mov	eax, [ebp+Dst]
		mov	byte ptr [eax],	4
		add	[ebp+Dst], 1
		mov	ecx, [ebp+var_84]
		mov	eax, [ebp+Src]
		mov	edx, eax
		mov	eax, [ebp+Dst]
		mov	[esp+158h+Size], ecx ; Size
		mov	[esp+158h+Str2], edx ; Src
		mov	[esp+158h+Str1], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_84]
		cmp	eax, 3
		ja	short loc_4166BC
		mov	edx, [ebp+var_84]
		mov	eax, [ebp+var_84]
		mov	ecx, 4
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	eax, [ebp+Dst]
		mov	[esp+158h+Size], edx ; Size
		mov	edx, [ebp+Dst]
		mov	[esp+158h+Str2], edx ; Src
		mov	[esp+158h+Str1], eax ; Dst
		call	memmove
		mov	eax, [ebp+var_84]
		mov	edx, 4
		sub	edx, eax
		mov	eax, [ebp+Dst]
		mov	[esp+158h+Size], edx ; Size
		mov	[esp+158h+Str2], 0 ; Val
		mov	[esp+158h+Str1], eax ; Dst
		call	memset

loc_4166BC:				; CODE XREF: sub_415770+EF9j
		add	[ebp+Dst], 4
		mov	eax, [ebp+Dst]
		mov	byte ptr [eax],	0C1h
		add	[ebp+Dst], 1
		mov	eax, [ebp+var_88]
		mov	edx, eax
		mov	eax, [ebp+Dst]
		mov	[eax], dl
		add	[ebp+Dst], 1
		mov	ecx, [ebp+var_88]
		mov	eax, [ebp+var_78]
		mov	edx, eax
		mov	eax, [ebp+Dst]
		mov	[esp+158h+Size], ecx ; Size
		mov	[esp+158h+Str2], edx ; Src
		mov	[esp+158h+Str1], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_88]
		add	[ebp+Dst], eax
		mov	eax, [ebp+Dst]
		mov	byte ptr [eax],	0C2h
		add	[ebp+Dst], 1
		mov	eax, [ebp+var_8C]
		mov	edx, eax
		mov	eax, [ebp+Dst]
		mov	[eax], dl
		add	[ebp+Dst], 1
		mov	ecx, [ebp+var_8C]
		mov	eax, [ebp+var_7C]
		mov	edx, eax
		mov	eax, [ebp+Dst]
		mov	[esp+158h+Size], ecx ; Size
		mov	[esp+158h+Str2], edx ; Src
		mov	[esp+158h+Str1], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_8C]
		add	[ebp+Dst], eax
		mov	edx, [ebp+Dst]
		mov	eax, [ebp+var_90]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+var_94]
		cmp	edx, eax
		jz	short loc_41677B
		mov	[esp+158h+Size], 0B8Eh ; int
		mov	[esp+158h+Str2], offset	a____Gnupg22__2	; "../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+158h+Str1], offset	aTpTemplateTe_0	; "tp -	template == template_len"
		call	sub_442650

loc_41677B:				; CODE XREF: sub_415770+FEDj
		mov	eax, [ebp+arg_14]
		mov	[esp+158h+Size], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+158h+Str2], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+158h+Str1], eax
		call	sub_413993
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_416894
		mov	ebx, [ebp+var_94]
		mov	ecx, [ebp+var_90]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 7
		jbe	short loc_4167BF
		mov	eax, 0E0h
		jmp	short loc_4167C4
; ---------------------------------------------------------------------------

loc_4167BF:				; CODE XREF: sub_415770+1046j
		mov	eax, 0E9h

loc_4167C4:				; CODE XREF: sub_415770+104Dj
		mov	edx, eax
		add	edx, [ebp+var_20]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+158h+var_148], ebx	; size_t
		mov	[esp+158h+var_14C], ecx	; void *
		mov	[esp+158h+Size], edx ; int
		mov	[esp+158h+Str2], 0 ; int
		mov	[esp+158h+Str1], eax ; char
		call	sub_40D4CA
		mov	[ebp+var_1C], eax

loc_4167EE:				; CODE XREF: sub_415770+E4Aj
		cmp	[ebp+var_1C], 0
		jz	short loc_41681B
		mov	eax, [ebp+var_1C]
		mov	[esp+158h+Str1], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+158h+Str1], offset	aFailedToStor_1	; "failed to store the key: %s\n"
		call	sub_43C238
		mov	[esp+158h+Str2], ebx ; char
		mov	[esp+158h+Str1], eax ; char *
		call	sub_43CB21
		jmp	short loc_416895
; ---------------------------------------------------------------------------

loc_41681B:				; CODE XREF: sub_415770+1082j
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+14h]
		mov	ebx, [ebp+var_84]
		mov	ecx, [ebp+Src]
		mov	edx, [ebp+var_80]
		mov	eax, [ebp+var_70]
		mov	[esp+158h+var_138], esi	; int
		lea	esi, [ebp+var_A8]
		mov	[esp+158h+var_13C], esi	; void *
		mov	[esp+158h+var_140], ebx	; size_t
		mov	[esp+158h+var_144], ecx	; void *
		mov	[esp+158h+var_148], edx	; size_t
		mov	[esp+158h+var_14C], eax	; void *
		mov	eax, [ebp+var_28]
		mov	[esp+158h+Size], eax ; int
		mov	eax, [ebp+var_20]
		mov	[esp+158h+Str2], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+158h+Str1], eax ; int
		call	sub_4112C8
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jmp	short loc_416895
; ---------------------------------------------------------------------------

loc_416870:				; CODE XREF: sub_415770+12Ej
		nop
		jmp	short loc_416895
; ---------------------------------------------------------------------------

loc_416873:				; CODE XREF: sub_415770+16Aj
		nop
		jmp	short loc_416895
; ---------------------------------------------------------------------------

loc_416876:				; CODE XREF: sub_415770+258j
		nop
		jmp	short loc_416895
; ---------------------------------------------------------------------------

loc_416879:				; CODE XREF: sub_415770+294j
		nop
		jmp	short loc_416895
; ---------------------------------------------------------------------------

loc_41687C:				; CODE XREF: sub_415770+337j
		nop
		jmp	short loc_416895
; ---------------------------------------------------------------------------

loc_41687F:				; CODE XREF: sub_415770+423j
		nop
		jmp	short loc_416895
; ---------------------------------------------------------------------------

loc_416882:				; CODE XREF: sub_415770+4BCj
		nop
		jmp	short loc_416895
; ---------------------------------------------------------------------------

loc_416885:				; CODE XREF: sub_415770+569j
		nop
		jmp	short loc_416895
; ---------------------------------------------------------------------------

loc_416888:				; CODE XREF: sub_415770+5DEj
		nop
		jmp	short loc_416895
; ---------------------------------------------------------------------------

loc_41688B:				; CODE XREF: sub_415770+69Bj
		nop
		jmp	short loc_416895
; ---------------------------------------------------------------------------

loc_41688E:				; CODE XREF: sub_415770+D95j
		nop
		jmp	short loc_416895
; ---------------------------------------------------------------------------

loc_416891:				; CODE XREF: sub_415770+DBBj
		nop
		jmp	short loc_416895
; ---------------------------------------------------------------------------

loc_416894:				; CODE XREF: sub_415770+102Bj
		nop

loc_416895:				; CODE XREF: sub_415770+21Dj
					; sub_415770+2D6j ...
		mov	eax, [ebp+var_90]
		mov	[esp+158h+Str1], eax
		call	gcry_free
		mov	eax, [ebp+var_1C]

loc_4168A6:				; CODE XREF: sub_415770+AEj
					; sub_415770+E0j
		add	esp, 14Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_415770	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4168B1(int, int, char	*, int,	int, char, int)
sub_4168B1	proc near		; DATA XREF: sub_418EB5+61Ao

Str		= dword	ptr -0C8h
Format		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_BC		= dword	ptr -0BCh
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_8C		= dword	ptr -8Ch
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= byte ptr -74h
var_70		= byte ptr -70h
var_6C		= dword	ptr -6Ch
var_66		= byte ptr -66h
Dest		= byte ptr -52h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= byte ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0C0h
		mov	[ebp+var_6C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+0C8h+Str],	eax ; Str
		call	atoi
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_C]
		and	eax, 1
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_18], 0
		jle	short loc_4168E6
		cmp	[ebp+var_18], 3
		jle	short loc_4168F7

loc_4168E6:				; CODE XREF: sub_4168B1+2Dj
		mov	[esp+0C8h+Str],	76h
		call	sub_410197
		jmp	loc_416D5D
; ---------------------------------------------------------------------------

loc_4168F7:				; CODE XREF: sub_4168B1+33j
		sub	[ebp+var_18], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+Str],	eax
		call	sub_41070F
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 8
		mov	eax, [eax]
		mov	[esp+0C8h+Str],	eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 8
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 0Ch
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 4
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+var_BC], eax
		mov	[esp+0C8h+var_C0], 1
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+Str],	eax
		call	sub_414C8D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4169B0
		mov	eax, [ebp+var_C]
		jmp	loc_416D5D
; ---------------------------------------------------------------------------

loc_4169B0:				; CODE XREF: sub_4168B1+F5j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 50h
		mov	eax, [eax]
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 1000h
		jbe	short loc_4169E6
		mov	[esp+0C8h+Str],	43h
		call	sub_410197
		jmp	loc_416D5D
; ---------------------------------------------------------------------------

loc_4169E6:				; CODE XREF: sub_4168B1+122j
		mov	eax, [ebp+arg_18]
		mov	[esp+0C8h+var_C0], eax
		mov	eax, dword ptr [ebp+arg_14]
		mov	[esp+0C8h+Format], eax ; char
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+Str],	eax
		call	sub_413993
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_416D4B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+30h]
		and	eax, 2
		test	al, al
		jz	short loc_416A3F
		cmp	[ebp+var_20], 76Ch
		jbe	short loc_416A3F
		mov	dword ptr [ebp+var_10],	1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+3Ch]
		movzx	eax, ax
		mov	[ebp+var_14], eax
		jmp	short loc_416A4D
; ---------------------------------------------------------------------------

loc_416A3F:				; CODE XREF: sub_4168B1+16Aj
					; sub_4168B1+173j
		mov	dword ptr [ebp+var_10],	0
		mov	[ebp+var_14], 100h

loc_416A4D:				; CODE XREF: sub_4168B1+18Cj
		mov	[esp+0C8h+Str],	offset aPleaseWaitWhil ; "please wait while key	is being generate"...
		call	sub_43C238
		mov	[esp+0C8h+Str],	eax ; char *
		call	sub_43CAF7
		mov	[esp+0C8h+Str],	0
		call	sub_442720
		mov	[ebp+var_24], eax
		cmp	[ebp+var_18], 0
		jz	short loc_416A8A
		cmp	[ebp+var_18], 1
		jnz	short loc_416A83
		mov	eax, offset asc_44A83D ; ""
		jmp	short loc_416A88
; ---------------------------------------------------------------------------

loc_416A83:				; CODE XREF: sub_4168B1+1C9j
		mov	eax, offset aD_2 ; ""

loc_416A88:				; CODE XREF: sub_4168B1+1D0j
		jmp	short loc_416A8F
; ---------------------------------------------------------------------------

loc_416A8A:				; CODE XREF: sub_4168B1+1C3j
		mov	eax, offset asc_44A841 ; ""

loc_416A8F:				; CODE XREF: sub_4168B1:loc_416A88j
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+4]
		lea	ecx, [ebp+var_70]
		mov	[esp+0C8h+var_B0], ecx ; int
		lea	ecx, [ebp+var_6C]
		mov	[esp+0C8h+var_B4], ecx ; int
		mov	ecx, [ebp+var_14]
		mov	[esp+0C8h+var_B8], ecx ; int
		mov	[esp+0C8h+var_BC], 2 ; size_t
		mov	[esp+0C8h+var_C0], eax ; void *
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+0C8h+Format], eax ; char
		mov	[esp+0C8h+Str],	edx ; char
		call	sub_40DAD5
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_416AF6
		mov	[esp+0C8h+Str],	6Ch
		call	sub_410197
		mov	[ebp+var_C], eax
		mov	[esp+0C8h+Str],	offset aGeneratingKeyF ; "generating key failed\n"
		call	sub_43C238
		mov	[esp+0C8h+Str],	eax ; char *
		call	sub_43CB21
		jmp	loc_416D4F
; ---------------------------------------------------------------------------

loc_416AF6:				; CODE XREF: sub_4168B1+21Bj
		mov	[esp+0C8h+Str],	0
		call	sub_442720
		mov	ebx, eax
		sub	ebx, [ebp+var_24]
		mov	[esp+0C8h+Str],	offset aKeyGenerationC ; "key generation completed (%d seconds)\n"
		call	sub_43C238
		mov	[esp+0C8h+Format], ebx ; char
		mov	[esp+0C8h+Str],	eax ; char *
		call	sub_43CAF7
		mov	edx, dword ptr [ebp+var_70]
		mov	eax, [ebp+var_6C]
		lea	ecx, [ebp+var_74]
		mov	[esp+0C8h+var_BC], ecx
		mov	[esp+0C8h+var_C0], 7F49h
		mov	[esp+0C8h+Format], edx ; char
		mov	[esp+0C8h+Str],	eax
		call	sub_42D39C
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_416B71
		mov	[esp+0C8h+Str],	6Ch
		call	sub_410197
		mov	[ebp+var_C], eax
		mov	[esp+0C8h+Str],	offset aResponseDoesNo ; "response does	not contain the	public ke"...
		call	sub_43C238
		mov	[esp+0C8h+Str],	eax ; char *
		call	sub_43CB21
		jmp	loc_416D4F
; ---------------------------------------------------------------------------

loc_416B71:				; CODE XREF: sub_4168B1+296j
		mov	eax, dword ptr [ebp+var_74]
		lea	edx, [ebp+var_78]
		mov	[esp+0C8h+var_BC], edx
		mov	[esp+0C8h+var_C0], 81h
		mov	[esp+0C8h+Format], eax ; char
		mov	eax, [ebp+var_28]
		mov	[esp+0C8h+Str],	eax
		call	sub_42D39C
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jnz	short loc_416BC3
		mov	[esp+0C8h+Str],	6Ch
		call	sub_410197
		mov	[ebp+var_C], eax
		mov	[esp+0C8h+Str],	offset aResponseDoes_0 ; "response does	not contain the	RSA modul"...
		call	sub_43C238
		mov	[esp+0C8h+Str],	eax ; char *
		call	sub_43CB21
		jmp	loc_416D4F
; ---------------------------------------------------------------------------

loc_416BC3:				; CODE XREF: sub_4168B1+2E8j
		mov	eax, [ebp+var_78]
		mov	[esp+0C8h+var_BC], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+0C8h+var_C0], eax
		mov	[esp+0C8h+Format], offset aN ; "n"
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Str],	eax
		call	sub_411794
		mov	eax, dword ptr [ebp+var_74]
		lea	edx, [ebp+var_7C]
		mov	[esp+0C8h+var_BC], edx
		mov	[esp+0C8h+var_C0], 82h
		mov	[esp+0C8h+Format], eax ; char
		mov	eax, [ebp+var_28]
		mov	[esp+0C8h+Str],	eax
		call	sub_42D39C
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	short loc_416C36
		mov	[esp+0C8h+Str],	6Ch
		call	sub_410197
		mov	[ebp+var_C], eax
		mov	[esp+0C8h+Str],	offset aResponseDoes_1 ; "response does	not contain the	RSA publi"...
		call	sub_43C238
		mov	[esp+0C8h+Str],	eax ; char *
		call	sub_43CB21
		jmp	loc_416D4F
; ---------------------------------------------------------------------------

loc_416C36:				; CODE XREF: sub_4168B1+35Bj
		mov	eax, [ebp+var_7C]
		mov	[esp+0C8h+var_BC], eax
		mov	eax, [ebp+var_30]
		mov	[esp+0C8h+var_C0], eax
		mov	[esp+0C8h+Format], offset aE ; "e"
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Str],	eax
		call	sub_411794
		cmp	[ebp+arg_10], 0
		jnz	short loc_416C64
		call	sub_42A3DA
		jmp	short loc_416C67
; ---------------------------------------------------------------------------

loc_416C64:				; CODE XREF: sub_4168B1+3AAj
		mov	eax, [ebp+arg_10]

loc_416C67:				; CODE XREF: sub_4168B1+3B1j
		mov	[ebp+var_34], eax
		mov	edx, [ebp+var_34]
		mov	eax, offset aLu_0 ; "%lu"
		mov	[esp+0C8h+var_C0], edx
		mov	[esp+0C8h+Format], eax ; Format
		lea	eax, [ebp+Dest]
		mov	[esp+0C8h+Str],	eax ; Dest
		call	sprintf
		lea	eax, [ebp+Dest]
		mov	[ebp+var_8C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_8C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+0C8h+var_B4], 0
		mov	[esp+0C8h+var_B8], 0
		mov	[esp+0C8h+var_BC], eax
		lea	eax, [ebp+Dest]
		mov	[esp+0C8h+var_C0], eax
		mov	[esp+0C8h+Format], offset aKeyCreatedAt	; "KEY-CREATED-AT"
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Str],	eax
		call	sub_406FDB
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+14h]
		mov	ecx, [ebp+var_7C]
		mov	edx, [ebp+var_78]
		mov	eax, [ebp+var_34]
		mov	[esp+0C8h+var_A8], ebx ; int
		lea	ebx, [ebp+var_66]
		mov	[esp+0C8h+var_AC], ebx ; void *
		mov	[esp+0C8h+var_B0], ecx ; size_t
		mov	ecx, [ebp+var_30]
		mov	[esp+0C8h+var_B4], ecx ; void *
		mov	[esp+0C8h+var_B8], edx ; size_t
		mov	edx, [ebp+var_2C]
		mov	[esp+0C8h+var_BC], edx ; void *
		mov	[esp+0C8h+var_C0], eax ; int
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+Format], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+Str],	eax ; int
		call	sub_4112C8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_416D4E
		lea	eax, [ebp+var_66]
		mov	[esp+0C8h+var_BC], eax
		mov	[esp+0C8h+var_C0], 0FFFFFFFFh
		mov	[esp+0C8h+Format], offset aKeyFpr ; "KEY-FPR"
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Str],	eax
		call	sub_4115C5
		jmp	short loc_416D4F
; ---------------------------------------------------------------------------

loc_416D4B:				; CODE XREF: sub_4168B1+155j
		nop
		jmp	short loc_416D4F
; ---------------------------------------------------------------------------

loc_416D4E:				; CODE XREF: sub_4168B1+474j
		nop

loc_416D4F:				; CODE XREF: sub_4168B1+240j
					; sub_4168B1+2BBj ...
		mov	eax, [ebp+var_6C]
		mov	[esp+0C8h+Str],	eax
		call	gcry_free
		mov	eax, [ebp+var_C]

loc_416D5D:				; CODE XREF: sub_4168B1+41j
					; sub_4168B1+FAj ...
		add	esp, 0C0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4168B1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416D67	proc near		; CODE XREF: sub_41199B+61Cp
					; sub_416DC5+4Cp

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 3
		jnz	short loc_416DA5
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 10h
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 8
		or	edx, eax
		mov	eax, [ebp+arg_0]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, edx
		mov	[ebp+var_C], eax
		jmp	short loc_416DC0
; ---------------------------------------------------------------------------

loc_416DA5:				; CODE XREF: sub_416D67+Aj
		mov	[esp+28h+var_28], offset aInvalidStructu ; "invalid structure of OpenPGP card (DO 0"...
		call	sub_43C238
		mov	[esp+28h+var_28], eax ;	char *
		call	sub_43CB21
		mov	[ebp+var_C], 0

loc_416DC0:				; CODE XREF: sub_416D67+3Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_416D67	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416DC5	proc near		; CODE XREF: sub_4170F2+8FAp

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+var_28], 0
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_2C], eax
		lea	eax, [ebp+var_14]
		mov	[esp+38h+var_30], eax
		mov	[esp+38h+var_34], 93h
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_41075F
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_416E04
		mov	eax, 0
		jmp	short locret_416E27
; ---------------------------------------------------------------------------

loc_416E04:				; CODE XREF: sub_416DC5+36j
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		call	sub_416D67
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+var_10]

locret_416E27:				; CODE XREF: sub_416DC5+3Dj
		leave
		retn
sub_416DC5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416E29	proc near		; CODE XREF: sub_416F93+158p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		cmp	[ebp+arg_4], 0
		jle	short loc_416E3B
		cmp	[ebp+arg_4], 3
		jle	short loc_416E59

loc_416E3B:				; CODE XREF: sub_416E29+Aj
		mov	[esp+48h+var_40], 0C5Ah	; int
		mov	[esp+48h+var_44], offset a____Gnupg22__2 ; "../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+48h+var_48], offset aKeyno1Keyno3 ; "keyno	>= 1 &&	keyno <= 3"
		call	sub_442650
		jmp	short loc_416E5A
; ---------------------------------------------------------------------------

loc_416E59:				; CODE XREF: sub_416E29+10j
		nop

loc_416E5A:				; CODE XREF: sub_416E29+2Ej
		mov	[esp+48h+var_34], 0
		mov	[esp+48h+var_38], 0
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+var_3C], eax
		lea	eax, [ebp+var_18]
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+var_44], 6Eh ;	char
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_4102D7
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_416EB9
		mov	[esp+48h+var_48], offset aErrorReadingAp ; "error reading application data\n"
		call	sub_43C238
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CB21
		mov	[esp+48h+var_48], 1
		call	sub_410197
		jmp	locret_416F91
; ---------------------------------------------------------------------------

loc_416EB9:				; CODE XREF: sub_416E29+69j
		mov	edx, dword ptr [ebp+var_1C]
		mov	eax, [ebp+var_18]
		lea	ecx, [ebp+var_20]
		mov	[esp+48h+var_3C], ecx
		mov	[esp+48h+var_40], 0C5h
		mov	[esp+48h+var_44], edx ;	char
		mov	[esp+48h+var_48], eax
		call	sub_42D39C
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_416EEB
		mov	eax, [ebp+var_20]
		cmp	eax, 3Ch
		jz	short loc_416F18

loc_416EEB:				; CODE XREF: sub_416E29+B8j
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	[esp+48h+var_48], offset aErrorReadingFi ; "error reading fingerprint DO\n"
		call	sub_43C238
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CB21
		mov	[esp+48h+var_48], 1
		call	sub_410197
		jmp	short locret_416F91
; ---------------------------------------------------------------------------

loc_416F18:				; CODE XREF: sub_416E29+C0j
		mov	eax, [ebp+arg_4]
		lea	edx, [eax-1]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 2
		add	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	short loc_416F7B
; ---------------------------------------------------------------------------

loc_416F34:				; CODE XREF: sub_416E29+156j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_416F77
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	[esp+48h+var_48], offset aFingerprintOnC ; "fingerprint	on card	does not match requ"...
		call	sub_43C238
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CAF7
		mov	[esp+48h+var_48], 12h
		call	sub_410197
		jmp	short locret_416F91
; ---------------------------------------------------------------------------

loc_416F77:				; CODE XREF: sub_416E29+11Fj
		add	[ebp+var_C], 1

loc_416F7B:				; CODE XREF: sub_416E29+109j
		cmp	[ebp+var_C], 13h
		jle	short loc_416F34
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, 0

locret_416F91:				; CODE XREF: sub_416E29+8Bj
					; sub_416E29+EDj ...
		leave
		retn
sub_416E29	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416F93	proc near		; CODE XREF: sub_4170F2+498p
					; sub_417C15+27Bp ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_24		= byte ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	short loc_416FB0
; ---------------------------------------------------------------------------

loc_416FA8:				; CODE XREF: sub_416F93+2Fj
					; sub_416F93+43j ...
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_416FB0:				; CODE XREF: sub_416F93+13j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_416FC4
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_416FA8

loc_416FC4:				; CODE XREF: sub_416F93+25j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_416FD8
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_416FA8

loc_416FD8:				; CODE XREF: sub_416F93+39j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_416FEC
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	short loc_416FA8

loc_416FEC:				; CODE XREF: sub_416F93+4Dj
		cmp	[ebp+var_10], 28h
		jz	short loc_417003
		mov	[esp+38h+var_38], 76h
		call	sub_410197
		jmp	locret_4170F0
; ---------------------------------------------------------------------------

loc_417003:				; CODE XREF: sub_416F93+5Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41701E
		mov	[esp+38h+var_38], 76h
		call	sub_410197
		jmp	locret_4170F0
; ---------------------------------------------------------------------------

loc_41701E:				; CODE XREF: sub_416F93+78j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_4170CD
; ---------------------------------------------------------------------------

loc_417030:				; CODE XREF: sub_416F93+13Ej
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41704D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_417079
; ---------------------------------------------------------------------------

loc_41704D:				; CODE XREF: sub_416F93+A5j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_417068
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_417077
; ---------------------------------------------------------------------------

loc_417068:				; CODE XREF: sub_416F93+C2j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_417077:				; CODE XREF: sub_416F93+D3j
		mov	edx, eax

loc_417079:				; CODE XREF: sub_416F93+B8j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_417094
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_4170BB
; ---------------------------------------------------------------------------

loc_417094:				; CODE XREF: sub_416F93+F1j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4170AF
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_4170BB
; ---------------------------------------------------------------------------

loc_4170AF:				; CODE XREF: sub_416F93+10Cj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_4170BB:				; CODE XREF: sub_416F93+FFj
					; sub_416F93+11Aj
		add	edx, eax
		lea	eax, [ebp+var_24]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_C], 2
		add	[ebp+var_10], 1

loc_4170CD:				; CODE XREF: sub_416F93+98j
		cmp	[ebp+var_10], 13h
		jle	loc_417030
		lea	eax, [ebp+var_24]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_416E29

locret_4170F0:				; CODE XREF: sub_416F93+6Bj
					; sub_416F93+86j
		leave
		retn
sub_416F93	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4170F2(int, char *Str1, int, int, int, void *Src, size_t, int, int)
sub_4170F2	proc near		; DATA XREF: sub_418EB5+624o

Buf1		= dword	ptr -0D8h
Buf2		= dword	ptr -0D4h
Size		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_C4		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_BC		= dword	ptr -0BCh
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A3		= byte ptr -0A3h
var_8F		= dword	ptr -8Fh
var_8B		= dword	ptr -8Bh
var_87		= dword	ptr -87h
var_83		= dword	ptr -83h
var_7F		= word ptr -7Fh
var_7D		= byte ptr -7Dh
var_3C		= byte ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
Str1		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
Src		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 0CCh
		mov	[ebp+var_2C], 0
		mov	[ebp+var_30], 0
		cmp	[ebp+Str1], 0
		jz	short loc_41711C
		mov	eax, [ebp+Str1]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41712D

loc_41711C:				; CODE XREF: sub_4170F2+1Ej
		mov	[esp+0D8h+Buf1], 37h
		call	sub_410197
		jmp	loc_417C0A
; ---------------------------------------------------------------------------

loc_41712D:				; CODE XREF: sub_4170F2+28j
		cmp	[ebp+arg_18], 14h
		jz	loc_417327
		cmp	[ebp+arg_8], 2
		jnz	short loc_41716F
		cmp	[ebp+arg_18], 23h
		jnz	short loc_41716F
		mov	[esp+0D8h+Size], 0Fh ; Size
		mov	[esp+0D8h+Buf2], offset	dword_4445BC ; Buf2
		mov	eax, [ebp+Src]
		mov	[esp+0D8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_41716F
		add	[ebp+Src], 0Fh
		sub	[ebp+arg_18], 0Fh
		jmp	loc_417327
; ---------------------------------------------------------------------------

loc_41716F:				; CODE XREF: sub_4170F2+49j
					; sub_4170F2+4Fj ...
		cmp	[ebp+arg_8], 3
		jnz	short loc_4171A7
		cmp	[ebp+arg_18], 23h
		jnz	short loc_4171A7
		mov	[esp+0D8h+Size], 0Fh ; Size
		mov	[esp+0D8h+Buf2], offset	dword_4445CB ; Buf2
		mov	eax, [ebp+Src]
		mov	[esp+0D8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_4171A7
		add	[ebp+Src], 0Fh
		sub	[ebp+arg_18], 0Fh
		jmp	loc_417327
; ---------------------------------------------------------------------------

loc_4171A7:				; CODE XREF: sub_4170F2+81j
					; sub_4170F2+87j ...
		cmp	[ebp+arg_8], 0Bh
		jnz	short loc_4171F0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 1
		test	al, al
		jz	short loc_4171F0
		cmp	[ebp+arg_18], 2Fh
		jnz	short loc_4171F0
		mov	[esp+0D8h+Size], 13h ; Size
		mov	[esp+0D8h+Buf2], offset	dword_4445DA ; Buf2
		mov	eax, [ebp+Src]
		mov	[esp+0D8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_4171F0
		add	[ebp+Src], 13h
		sub	[ebp+arg_18], 13h
		jmp	loc_417327
; ---------------------------------------------------------------------------

loc_4171F0:				; CODE XREF: sub_4170F2+B9j
					; sub_4170F2+CAj ...
		cmp	[ebp+arg_8], 8
		jnz	short loc_417239
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 1
		test	al, al
		jz	short loc_417239
		cmp	[ebp+arg_18], 33h
		jnz	short loc_417239
		mov	[esp+0D8h+Size], 13h ; Size
		mov	[esp+0D8h+Buf2], offset	dword_4445ED ; Buf2
		mov	eax, [ebp+Src]
		mov	[esp+0D8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_417239
		add	[ebp+Src], 13h
		sub	[ebp+arg_18], 13h
		jmp	loc_417327
; ---------------------------------------------------------------------------

loc_417239:				; CODE XREF: sub_4170F2+102j
					; sub_4170F2+113j ...
		cmp	[ebp+arg_8], 9
		jnz	short loc_417282
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 1
		test	al, al
		jz	short loc_417282
		cmp	[ebp+arg_18], 43h
		jnz	short loc_417282
		mov	[esp+0D8h+Size], 13h ; Size
		mov	[esp+0D8h+Buf2], offset	dword_444600 ; Buf2
		mov	eax, [ebp+Src]
		mov	[esp+0D8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_417282
		add	[ebp+Src], 13h
		sub	[ebp+arg_18], 13h
		jmp	loc_417327
; ---------------------------------------------------------------------------

loc_417282:				; CODE XREF: sub_4170F2+14Bj
					; sub_4170F2+15Cj ...
		cmp	[ebp+arg_8], 0Ah
		jnz	short loc_4172C8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 1
		test	al, al
		jz	short loc_4172C8
		cmp	[ebp+arg_18], 53h
		jnz	short loc_4172C8
		mov	[esp+0D8h+Size], 13h ; Size
		mov	[esp+0D8h+Buf2], offset	dword_444613 ; Buf2
		mov	eax, [ebp+Src]
		mov	[esp+0D8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_4172C8
		add	[ebp+Src], 13h
		sub	[ebp+arg_18], 13h
		jmp	short loc_417327
; ---------------------------------------------------------------------------

loc_4172C8:				; CODE XREF: sub_4170F2+194j
					; sub_4170F2+1A5j ...
		cmp	[ebp+arg_18], 1Ch
		jz	short loc_4172E0
		cmp	[ebp+arg_18], 20h
		jz	short loc_4172E0
		cmp	[ebp+arg_18], 30h
		jz	short loc_4172E0
		cmp	[ebp+arg_18], 40h
		jnz	short loc_4172F1

loc_4172E0:				; CODE XREF: sub_4170F2+1DAj
					; sub_4170F2+1E0j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 1
		test	al, al
		jnz	short loc_417327

loc_4172F1:				; CODE XREF: sub_4170F2+1ECj
		mov	eax, [ebp+arg_8]
		mov	[esp+0D8h+Buf1], eax
		call	gcry_md_algo_name
		mov	ebx, eax
		mov	[esp+0D8h+Buf1], offset	aCardDoesNotSup	; "card	does not support digest	algorithm "...
		call	sub_43C238
		mov	[esp+0D8h+Buf2], ebx ; char
		mov	[esp+0D8h+Buf1], eax ; char *
		call	sub_43CB21
		mov	[esp+0D8h+Buf1], 37h
		call	sub_410197
		jmp	loc_417C0A
; ---------------------------------------------------------------------------

loc_417327:				; CODE XREF: sub_4170F2+3Fj
					; sub_4170F2+78j ...
		mov	[esp+0D8h+Buf2], offset	aOpenpgp_1 ; "OPENPGP.1"
		mov	eax, [ebp+Str1]
		mov	[esp+0D8h+Buf1], eax ; Str1
		call	strcmp
		test	eax, eax
		jz	loc_41756F
		mov	[esp+0D8h+Buf2], offset	aOpenpgp_3 ; "OPENPGP.3"
		mov	eax, [ebp+Str1]
		mov	[esp+0D8h+Buf1], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_417365
		mov	[ebp+var_30], 1
		jmp	loc_41756F
; ---------------------------------------------------------------------------

loc_417365:				; CODE XREF: sub_4170F2+265j
		mov	eax, [ebp+Str1]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 1Fh
		jbe	short loc_4173B7
		mov	eax, [ebp+Str1]
		mov	edx, eax
		mov	eax, offset aD27600012401 ; "D27600012401"
		mov	ecx, 0Ch
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_4173C8

loc_4173B7:				; CODE XREF: sub_4170F2+29Bj
		mov	[esp+0D8h+Buf1], 76h
		call	sub_410197
		jmp	loc_417C0A
; ---------------------------------------------------------------------------

loc_4173C8:				; CODE XREF: sub_4170F2+2C3j
		mov	eax, [ebp+Str1]
		mov	[ebp+var_24], eax
		mov	[ebp+var_28], 0
		jmp	short loc_4173DF
; ---------------------------------------------------------------------------

loc_4173D7:				; CODE XREF: sub_4170F2+2FFj
					; sub_4170F2+313j ...
		add	[ebp+var_24], 1
		add	[ebp+var_28], 1

loc_4173DF:				; CODE XREF: sub_4170F2+2E3j
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4173F3
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_4173D7

loc_4173F3:				; CODE XREF: sub_4170F2+2F5j
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_417407
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_4173D7

loc_417407:				; CODE XREF: sub_4170F2+309j
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_41741B
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	short loc_4173D7

loc_41741B:				; CODE XREF: sub_4170F2+31Dj
		cmp	[ebp+var_28], 20h
		jz	short loc_417432
		mov	[esp+0D8h+Buf1], 76h
		call	sub_410197
		jmp	loc_417C0A
; ---------------------------------------------------------------------------

loc_417432:				; CODE XREF: sub_4170F2+32Dj
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_417462
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_417451
		mov	eax, [ebp+var_24]
		add	eax, 1
		mov	[ebp+var_2C], eax
		jmp	short loc_417462
; ---------------------------------------------------------------------------

loc_417451:				; CODE XREF: sub_4170F2+352j
		mov	[esp+0D8h+Buf1], 76h
		call	sub_410197
		jmp	loc_417C0A
; ---------------------------------------------------------------------------

loc_417462:				; CODE XREF: sub_4170F2+348j
					; sub_4170F2+35Dj
		mov	eax, [ebp+Str1]
		mov	[ebp+var_24], eax
		mov	[ebp+var_28], 0
		jmp	loc_417514
; ---------------------------------------------------------------------------

loc_417474:				; CODE XREF: sub_4170F2+426j
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_417491
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_4174BD
; ---------------------------------------------------------------------------

loc_417491:				; CODE XREF: sub_4170F2+38Aj
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4174AC
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_4174BB
; ---------------------------------------------------------------------------

loc_4174AC:				; CODE XREF: sub_4170F2+3A7j
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_4174BB:				; CODE XREF: sub_4170F2+3B8j
		mov	edx, eax

loc_4174BD:				; CODE XREF: sub_4170F2+39Dj
		mov	eax, [ebp+var_24]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4174D8
		mov	eax, [ebp+var_24]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_4174FF
; ---------------------------------------------------------------------------

loc_4174D8:				; CODE XREF: sub_4170F2+3D6j
		mov	eax, [ebp+var_24]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4174F3
		mov	eax, [ebp+var_24]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_4174FF
; ---------------------------------------------------------------------------

loc_4174F3:				; CODE XREF: sub_4170F2+3F1j
		mov	eax, [ebp+var_24]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_4174FF:				; CODE XREF: sub_4170F2+3E4j
					; sub_4170F2+3FFj
		add	edx, eax
		lea	eax, [ebp+var_A3]
		add	eax, [ebp+var_28]
		mov	[eax], dl
		add	[ebp+var_24], 2
		add	[ebp+var_28], 1

loc_417514:				; CODE XREF: sub_4170F2+37Dj
		cmp	[ebp+var_28], 0Fh
		jle	loc_417474
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, 10h
		jz	short loc_41753A
		mov	[esp+0D8h+Buf1], 6Fh
		call	sub_410197
		jmp	loc_417C0A
; ---------------------------------------------------------------------------

loc_41753A:				; CODE XREF: sub_4170F2+435j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+0D8h+Size], 10h ; Size
		lea	edx, [ebp+var_A3]
		mov	[esp+0D8h+Buf2], edx ; Buf2
		mov	[esp+0D8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_41756F
		mov	[esp+0D8h+Buf1], 5Bh
		call	sub_410197
		jmp	loc_417C0A
; ---------------------------------------------------------------------------

loc_41756F:				; CODE XREF: sub_4170F2+24Aj
					; sub_4170F2+26Ej ...
		cmp	[ebp+var_2C], 0
		jz	short loc_417591
		mov	[esp+0D8h+Size], 1
		mov	eax, [ebp+var_2C]
		mov	[esp+0D8h+Buf2], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+Buf1], eax
		call	sub_416F93
		jmp	short loc_417596
; ---------------------------------------------------------------------------

loc_417591:				; CODE XREF: sub_4170F2+481j
		mov	eax, 0

loc_417596:				; CODE XREF: sub_4170F2+49Dj
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_4175A7
		mov	eax, [ebp+var_1C]
		jmp	loc_417C0A
; ---------------------------------------------------------------------------

loc_4175A7:				; CODE XREF: sub_4170F2+4ABj
		cmp	[ebp+arg_8], 2
		jnz	loc_41763C
		mov	eax, [ebp+arg_18]
		add	eax, 0Fh
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 53h
		jbe	short loc_4175DC
		mov	[esp+0D8h+Size], 0D1Ah ; int
		mov	[esp+0D8h+Buf2], offset	a____Gnupg22__2	; "../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+0D8h+Buf1], offset	aDatalenSizeofD	; "datalen <= sizeof data"
		call	sub_442650

loc_4175DC:				; CODE XREF: sub_4170F2+4CCj
		mov	eax, dword_4445BC
		mov	[ebp+var_8F], eax
		mov	eax, dword_4445C0
		mov	[ebp+var_8B], eax
		mov	eax, dword_4445C4
		mov	[ebp+var_87], eax
		movzx	eax, word_4445C8
		mov	word ptr [ebp+var_83], ax
		movzx	eax, byte_4445CA
		mov	byte ptr [ebp+var_83+2], al
		lea	eax, [ebp+var_8F]
		add	eax, 0Fh
		mov	edx, [ebp+Src]
		mov	ecx, [ebp+arg_18]
		mov	[esp+0D8h+Size], ecx ; Size
		mov	[esp+0D8h+Buf2], edx ; Src
		mov	[esp+0D8h+Buf1], eax ; Dst
		call	memcpy
		jmp	loc_41799B
; ---------------------------------------------------------------------------

loc_41763C:				; CODE XREF: sub_4170F2+4B9j
		cmp	[ebp+arg_8], 3
		jnz	loc_4176D1
		mov	eax, [ebp+arg_18]
		add	eax, 0Fh
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 53h
		jbe	short loc_417671
		mov	[esp+0D8h+Size], 0D1Bh ; int
		mov	[esp+0D8h+Buf2], offset	a____Gnupg22__2	; "../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+0D8h+Buf1], offset	aDatalenSizeofD	; "datalen <= sizeof data"
		call	sub_442650

loc_417671:				; CODE XREF: sub_4170F2+561j
		mov	eax, dword_4445CB
		mov	[ebp+var_8F], eax
		mov	eax, dword_4445CF
		mov	[ebp+var_8B], eax
		mov	eax, dword_4445D3
		mov	[ebp+var_87], eax
		movzx	eax, word_4445D7
		mov	word ptr [ebp+var_83], ax
		movzx	eax, byte_4445D9
		mov	byte ptr [ebp+var_83+2], al
		lea	eax, [ebp+var_8F]
		add	eax, 0Fh
		mov	edx, [ebp+Src]
		mov	ecx, [ebp+arg_18]
		mov	[esp+0D8h+Size], ecx ; Size
		mov	[esp+0D8h+Buf2], edx ; Src
		mov	[esp+0D8h+Buf1], eax ; Dst
		call	memcpy
		jmp	loc_41799B
; ---------------------------------------------------------------------------

loc_4176D1:				; CODE XREF: sub_4170F2+54Ej
		cmp	[ebp+arg_8], 0Bh
		jnz	loc_417780
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 1
		test	al, al
		jz	loc_417780
		mov	eax, [ebp+arg_18]
		add	eax, 13h
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 53h
		jbe	short loc_41771B
		mov	[esp+0D8h+Size], 0D1Ch ; int
		mov	[esp+0D8h+Buf2], offset	a____Gnupg22__2	; "../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+0D8h+Buf1], offset	aDatalenSizeofD	; "datalen <= sizeof data"
		call	sub_442650

loc_41771B:				; CODE XREF: sub_4170F2+60Bj
		mov	eax, dword_4445DA
		mov	[ebp+var_8F], eax
		mov	eax, dword_4445DE
		mov	[ebp+var_8B], eax
		mov	eax, dword_4445E2
		mov	[ebp+var_87], eax
		mov	eax, dword_4445E6
		mov	[ebp+var_83], eax
		movzx	eax, word_4445EA
		mov	[ebp+var_7F], ax
		movzx	eax, byte_4445EC
		mov	[ebp+var_7D], al
		lea	eax, [ebp+var_8F]
		add	eax, 13h
		mov	edx, [ebp+Src]
		mov	ecx, [ebp+arg_18]
		mov	[esp+0D8h+Size], ecx ; Size
		mov	[esp+0D8h+Buf2], edx ; Src
		mov	[esp+0D8h+Buf1], eax ; Dst
		call	memcpy
		jmp	loc_41799B
; ---------------------------------------------------------------------------

loc_417780:				; CODE XREF: sub_4170F2+5E3j
					; sub_4170F2+5F8j
		cmp	[ebp+arg_8], 8
		jnz	loc_41782F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 1
		test	al, al
		jz	loc_41782F
		mov	eax, [ebp+arg_18]
		add	eax, 13h
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 53h
		jbe	short loc_4177CA
		mov	[esp+0D8h+Size], 0D1Dh ; int
		mov	[esp+0D8h+Buf2], offset	a____Gnupg22__2	; "../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+0D8h+Buf1], offset	aDatalenSizeofD	; "datalen <= sizeof data"
		call	sub_442650

loc_4177CA:				; CODE XREF: sub_4170F2+6BAj
		mov	eax, dword_4445ED
		mov	[ebp+var_8F], eax
		mov	eax, dword_4445F1
		mov	[ebp+var_8B], eax
		mov	eax, dword_4445F5
		mov	[ebp+var_87], eax
		mov	eax, dword_4445F9
		mov	[ebp+var_83], eax
		movzx	eax, word_4445FD
		mov	[ebp+var_7F], ax
		movzx	eax, byte_4445FF
		mov	[ebp+var_7D], al
		lea	eax, [ebp+var_8F]
		add	eax, 13h
		mov	edx, [ebp+Src]
		mov	ecx, [ebp+arg_18]
		mov	[esp+0D8h+Size], ecx ; Size
		mov	[esp+0D8h+Buf2], edx ; Src
		mov	[esp+0D8h+Buf1], eax ; Dst
		call	memcpy
		jmp	loc_41799B
; ---------------------------------------------------------------------------

loc_41782F:				; CODE XREF: sub_4170F2+692j
					; sub_4170F2+6A7j
		cmp	[ebp+arg_8], 9
		jnz	loc_4178DE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 1
		test	al, al
		jz	loc_4178DE
		mov	eax, [ebp+arg_18]
		add	eax, 13h
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 53h
		jbe	short loc_417879
		mov	[esp+0D8h+Size], 0D1Eh ; int
		mov	[esp+0D8h+Buf2], offset	a____Gnupg22__2	; "../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+0D8h+Buf1], offset	aDatalenSizeofD	; "datalen <= sizeof data"
		call	sub_442650

loc_417879:				; CODE XREF: sub_4170F2+769j
		mov	eax, dword_444600
		mov	[ebp+var_8F], eax
		mov	eax, dword_444604
		mov	[ebp+var_8B], eax
		mov	eax, dword_444608
		mov	[ebp+var_87], eax
		mov	eax, dword_44460C
		mov	[ebp+var_83], eax
		movzx	eax, word_444610
		mov	[ebp+var_7F], ax
		movzx	eax, byte_444612
		mov	[ebp+var_7D], al
		lea	eax, [ebp+var_8F]
		add	eax, 13h
		mov	edx, [ebp+Src]
		mov	ecx, [ebp+arg_18]
		mov	[esp+0D8h+Size], ecx ; Size
		mov	[esp+0D8h+Buf2], edx ; Src
		mov	[esp+0D8h+Buf1], eax ; Dst
		call	memcpy
		jmp	loc_41799B
; ---------------------------------------------------------------------------

loc_4178DE:				; CODE XREF: sub_4170F2+741j
					; sub_4170F2+756j
		cmp	[ebp+arg_8], 0Ah
		jnz	loc_41798A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 1
		test	al, al
		jz	loc_41798A
		mov	eax, [ebp+arg_18]
		add	eax, 13h
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 53h
		jbe	short loc_417928
		mov	[esp+0D8h+Size], 0D1Fh ; int
		mov	[esp+0D8h+Buf2], offset	a____Gnupg22__2	; "../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+0D8h+Buf1], offset	aDatalenSizeofD	; "datalen <= sizeof data"
		call	sub_442650

loc_417928:				; CODE XREF: sub_4170F2+818j
		mov	eax, dword_444613
		mov	[ebp+var_8F], eax
		mov	eax, dword_444617
		mov	[ebp+var_8B], eax
		mov	eax, dword_44461B
		mov	[ebp+var_87], eax
		mov	eax, dword_44461F
		mov	[ebp+var_83], eax
		movzx	eax, word_444623
		mov	[ebp+var_7F], ax
		movzx	eax, byte_444625
		mov	[ebp+var_7D], al
		lea	eax, [ebp+var_8F]
		add	eax, 13h
		mov	edx, [ebp+Src]
		mov	ecx, [ebp+arg_18]
		mov	[esp+0D8h+Size], ecx ; Size
		mov	[esp+0D8h+Buf2], edx ; Src
		mov	[esp+0D8h+Buf1], eax ; Dst
		call	memcpy
		jmp	short loc_41799B
; ---------------------------------------------------------------------------

loc_41798A:				; CODE XREF: sub_4170F2+7F0j
					; sub_4170F2+805j
		mov	[esp+0D8h+Buf1], 54h
		call	sub_410197
		jmp	loc_417C0A
; ---------------------------------------------------------------------------

loc_41799B:				; CODE XREF: sub_4170F2+545j
					; sub_4170F2+5DAj ...
		cmp	[ebp+var_30], 0
		jz	short loc_4179E6
		mov	eax, [ebp+arg_20]
		mov	[esp+0D8h+var_BC], eax ; int
		mov	eax, [ebp+arg_1C]
		mov	[esp+0D8h+var_C0], eax ; int
		mov	eax, [ebp+var_20]
		mov	[esp+0D8h+var_C4], eax ; size_t
		lea	eax, [ebp+var_8F]
		mov	[esp+0D8h+var_C8], eax ; void *
		mov	eax, [ebp+arg_10]
		mov	[esp+0D8h+var_CC], eax ; int
		mov	eax, [ebp+arg_C]
		mov	[esp+0D8h+Size], eax ; int
		mov	[esp+0D8h+Buf2], offset	aOpenpgp_3 ; "OPENPGP.3"
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+Buf1], eax ; int
		call	sub_417C15
		jmp	loc_417C0A
; ---------------------------------------------------------------------------

loc_4179E6:				; CODE XREF: sub_4170F2+8ADj
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+Buf1], eax
		call	sub_416DC5
		mov	dword ptr [ebp+var_3C],	eax
		mov	[esp+0D8h+Buf1], offset	aSignaturesCrea	; "signatures created so far: %lu\n"
		call	sub_43C238
		mov	edx, dword ptr [ebp+var_3C]
		mov	[esp+0D8h+Buf2], edx ; char
		mov	[esp+0D8h+Buf1], eax ; char *
		call	sub_43CAF7
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+18h]
		and	eax, 1
		test	al, al
		jz	short loc_417A2F
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+18h]
		and	eax, 2
		test	al, al
		jz	loc_417B91

loc_417A2F:				; CODE XREF: sub_4170F2+929j
		lea	eax, [ebp+var_A8]
		mov	[esp+0D8h+var_C4], eax
		mov	eax, dword ptr [ebp+var_3C]
		mov	[esp+0D8h+var_C8], eax
		mov	[esp+0D8h+var_CC], 1
		mov	eax, [ebp+arg_10]
		mov	[esp+0D8h+Size], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+0D8h+Buf2], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+Buf1], eax
		call	sub_41327A
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_417A72
		mov	eax, [ebp+var_1C]
		jmp	loc_417C0A
; ---------------------------------------------------------------------------

loc_417A72:				; CODE XREF: sub_4170F2+976j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		or	edx, 1
		mov	[eax+18h], dl
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+18h]
		and	eax, 4
		test	al, al
		jnz	loc_417B83
		mov	eax, [ebp+var_A8]
		test	eax, eax
		jz	loc_417B83
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 1
		test	al, al
		jnz	loc_417B83
		mov	eax, [ebp+var_A8]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ecx, [eax-1]
		mov	edx, [ebp+var_A8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+0D8h+var_CC], ecx ; size_t
		mov	[esp+0D8h+Size], edx ; void *
		mov	[esp+0D8h+Buf2], 82h ; int
		mov	[esp+0D8h+Buf1], eax ; char
		call	sub_40D14D
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0D8h+Buf1], eax
		call	sub_4101B2
		cmp	eax, 57h
		jnz	short loc_417B22
		mov	[esp+0D8h+Buf1], 84h
		call	sub_410197
		mov	[ebp+var_1C], eax

loc_417B22:				; CODE XREF: sub_4170F2+A1Fj
		cmp	[ebp+var_1C], 0
		jz	short loc_417B76
		mov	eax, [ebp+var_1C]
		mov	[esp+0D8h+Buf1], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+0D8h+Buf1], offset	aVerifyChvDFail	; "verify CHV%d	failed:	%s\n"
		call	sub_43C238
		mov	[esp+0D8h+Size], ebx
		mov	[esp+0D8h+Buf2], 2 ; char
		mov	[esp+0D8h+Buf1], eax ; char *
		call	sub_43CB21
		mov	eax, [ebp+var_A8]
		mov	[esp+0D8h+Buf1], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+Buf1], eax
		call	sub_41069F
		mov	eax, [ebp+var_1C]
		jmp	loc_417C0A
; ---------------------------------------------------------------------------

loc_417B76:				; CODE XREF: sub_4170F2+A34j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		or	edx, 4
		mov	[eax+18h], dl

loc_417B83:				; CODE XREF: sub_4170F2+999j
					; sub_4170F2+9A7j ...
		mov	eax, [ebp+var_A8]
		mov	[esp+0D8h+Buf1], eax
		call	gcry_free

loc_417B91:				; CODE XREF: sub_4170F2+937j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+30h]
		and	eax, 2
		test	al, al
		jz	short loc_417BBB
		mov	[ebp+var_34], 1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+3Ch]
		movzx	eax, ax
		mov	[ebp+var_38], eax
		jmp	short loc_417BC9
; ---------------------------------------------------------------------------

loc_417BBB:				; CODE XREF: sub_4170F2+AAEj
		mov	[ebp+var_34], 0
		mov	[ebp+var_38], 0

loc_417BC9:				; CODE XREF: sub_4170F2+AC7j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_20]
		mov	[esp+0D8h+var_C0], edx ; int
		mov	edx, [ebp+arg_1C]
		mov	[esp+0D8h+var_C4], edx ; int
		mov	edx, [ebp+var_38]
		mov	[esp+0D8h+var_C8], edx ; int
		mov	edx, [ebp+var_20]
		mov	[esp+0D8h+var_CC], edx ; size_t
		lea	edx, [ebp+var_8F]
		mov	[esp+0D8h+Size], edx ; void *
		mov	edx, [ebp+var_34]
		mov	[esp+0D8h+Buf2], edx ; int
		mov	[esp+0D8h+Buf1], eax ; char
		call	sub_40D61C
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]

loc_417C0A:				; CODE XREF: sub_4170F2+36j
					; sub_4170F2+230j ...
		add	esp, 0CCh
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4170F2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_417C15(int, char *, int, int,	void *,	size_t,	int, int)
sub_417C15	proc near		; CODE XREF: sub_4170F2+8EAp
					; DATA XREF: sub_418EB5+62Eo

Str1		= dword	ptr -68h
Str2		= dword	ptr -64h
Size		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_3C		= dword	ptr -3Ch
Buf2		= byte ptr -34h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 60h
		mov	[ebp+var_18], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_417C34
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_417C45

loc_417C34:				; CODE XREF: sub_417C15+13j
		mov	[esp+68h+Str1],	37h
		call	sub_410197
		jmp	loc_417F45
; ---------------------------------------------------------------------------

loc_417C45:				; CODE XREF: sub_417C15+1Dj
		cmp	[ebp+arg_14], 65h
		jbe	short loc_417C5C
		mov	[esp+68h+Str1],	37h
		call	sub_410197
		jmp	loc_417F45
; ---------------------------------------------------------------------------

loc_417C5C:				; CODE XREF: sub_417C15+34j
		mov	[esp+68h+Str2],	offset aOpenpgp_3 ; "OPENPGP.3"
		mov	eax, [ebp+arg_4]
		mov	[esp+68h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jz	loc_417E75
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 1Fh
		jbe	short loc_417CC3
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aD27600012401 ; "D27600012401"
		mov	ecx, 0Ch
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_417CD4

loc_417CC3:				; CODE XREF: sub_417C15+84j
		mov	[esp+68h+Str1],	76h
		call	sub_410197
		jmp	loc_417F45
; ---------------------------------------------------------------------------

loc_417CD4:				; CODE XREF: sub_417C15+ACj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_14], 0
		jmp	short loc_417CEB
; ---------------------------------------------------------------------------

loc_417CE3:				; CODE XREF: sub_417C15+E8j
					; sub_417C15+FCj ...
		add	[ebp+var_10], 1
		add	[ebp+var_14], 1

loc_417CEB:				; CODE XREF: sub_417C15+CCj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_417CFF
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_417CE3

loc_417CFF:				; CODE XREF: sub_417C15+DEj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_417D13
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_417CE3

loc_417D13:				; CODE XREF: sub_417C15+F2j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_417D27
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	short loc_417CE3

loc_417D27:				; CODE XREF: sub_417C15+106j
		cmp	[ebp+var_14], 20h
		jz	short loc_417D3E
		mov	[esp+68h+Str1],	76h
		call	sub_410197
		jmp	loc_417F45
; ---------------------------------------------------------------------------

loc_417D3E:				; CODE XREF: sub_417C15+116j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_417D6E
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_417D5D
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[ebp+var_18], eax
		jmp	short loc_417D6E
; ---------------------------------------------------------------------------

loc_417D5D:				; CODE XREF: sub_417C15+13Bj
		mov	[esp+68h+Str1],	76h
		call	sub_410197
		jmp	loc_417F45
; ---------------------------------------------------------------------------

loc_417D6E:				; CODE XREF: sub_417C15+131j
					; sub_417C15+146j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_14], 0
		jmp	loc_417E1D
; ---------------------------------------------------------------------------

loc_417D80:				; CODE XREF: sub_417C15+20Cj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_417D9D
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_417DC9
; ---------------------------------------------------------------------------

loc_417D9D:				; CODE XREF: sub_417C15+173j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_417DB8
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_417DC7
; ---------------------------------------------------------------------------

loc_417DB8:				; CODE XREF: sub_417C15+190j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_417DC7:				; CODE XREF: sub_417C15+1A1j
		mov	edx, eax

loc_417DC9:				; CODE XREF: sub_417C15+186j
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_417DE4
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_417E0B
; ---------------------------------------------------------------------------

loc_417DE4:				; CODE XREF: sub_417C15+1BFj
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_417DFF
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_417E0B
; ---------------------------------------------------------------------------

loc_417DFF:				; CODE XREF: sub_417C15+1DAj
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_417E0B:				; CODE XREF: sub_417C15+1CDj
					; sub_417C15+1E8j
		add	edx, eax
		lea	eax, [ebp+Buf2]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_10], 2
		add	[ebp+var_14], 1

loc_417E1D:				; CODE XREF: sub_417C15+166j
		cmp	[ebp+var_14], 0Fh
		jle	loc_417D80
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, 10h
		jz	short loc_417E43
		mov	[esp+68h+Str1],	6Fh
		call	sub_410197
		jmp	loc_417F45
; ---------------------------------------------------------------------------

loc_417E43:				; CODE XREF: sub_417C15+21Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+68h+Size],	10h ; Size
		lea	edx, [ebp+Buf2]
		mov	[esp+68h+Str2],	edx ; Buf2
		mov	[esp+68h+Str1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_417E75
		mov	[esp+68h+Str1],	5Bh
		call	sub_410197
		jmp	loc_417F45
; ---------------------------------------------------------------------------

loc_417E75:				; CODE XREF: sub_417C15+5Cj
					; sub_417C15+24Dj
		cmp	[ebp+var_18], 0
		jz	short loc_417E97
		mov	[esp+68h+Size],	3
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Str1],	eax
		call	sub_416F93
		jmp	short loc_417E9C
; ---------------------------------------------------------------------------

loc_417E97:				; CODE XREF: sub_417C15+264j
		mov	eax, 0

loc_417E9C:				; CODE XREF: sub_417C15+280j
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_417EAD
		mov	eax, [ebp+var_C]
		jmp	loc_417F45
; ---------------------------------------------------------------------------

loc_417EAD:				; CODE XREF: sub_417C15+28Ej
		mov	eax, [ebp+arg_C]
		mov	[esp+68h+Size],	eax
		mov	eax, [ebp+arg_8]
		mov	[esp+68h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Str1],	eax
		call	sub_4136EE
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_417F42
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+30h]
		and	eax, 2
		test	al, al
		jz	short loc_417EF9
		mov	[ebp+var_1C], 1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+3Ch]
		movzx	eax, ax
		mov	[ebp+var_20], eax
		jmp	short loc_417F07
; ---------------------------------------------------------------------------

loc_417EF9:				; CODE XREF: sub_417C15+2C9j
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 0

loc_417F07:				; CODE XREF: sub_417C15+2E2j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_1C]
		mov	[esp+68h+var_50], edx ;	int
		mov	edx, [ebp+arg_18]
		mov	[esp+68h+var_54], edx ;	int
		mov	edx, [ebp+var_20]
		mov	[esp+68h+var_58], edx ;	int
		mov	edx, [ebp+arg_14]
		mov	[esp+68h+var_5C], edx ;	size_t
		mov	edx, [ebp+arg_10]
		mov	[esp+68h+Size],	edx ; void *
		mov	edx, [ebp+var_1C]
		mov	[esp+68h+Str2],	edx ; int
		mov	[esp+68h+Str1],	eax ; char
		call	sub_40D8DD
		mov	[ebp+var_C], eax

loc_417F42:				; CODE XREF: sub_417C15+2B8j
		mov	eax, [ebp+var_C]

loc_417F45:				; CODE XREF: sub_417C15+2Bj
					; sub_417C15+42j ...
		add	esp, 60h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_417C15	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_417F4C(int, char *, int, int,	void *Src, size_t, int,	int)
sub_417F4C	proc near		; DATA XREF: sub_418EB5+638o

Str1		= dword	ptr -78h
Str2		= dword	ptr -74h
Size		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_4C		= dword	ptr -4Ch
Buf2		= byte ptr -40h
var_2C		= dword	ptr -2Ch
Dst		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
Src		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 70h
		mov	[ebp+var_18], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_417F71
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_417F71
		cmp	[ebp+arg_14], 0
		jnz	short loc_417F82

loc_417F71:				; CODE XREF: sub_417F4C+13j
					; sub_417F4C+1Dj
		mov	[esp+78h+Str1],	37h
		call	sub_410197
		jmp	loc_41840F
; ---------------------------------------------------------------------------

loc_417F82:				; CODE XREF: sub_417F4C+23j
		mov	[esp+78h+Str2],	offset aOpenpgp_2 ; "OPENPGP.2"
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jz	loc_41819B
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 1Fh
		jbe	short loc_417FE9
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aD27600012401 ; "D27600012401"
		mov	ecx, 0Ch
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_417FFA

loc_417FE9:				; CODE XREF: sub_417F4C+73j
		mov	[esp+78h+Str1],	76h
		call	sub_410197
		jmp	loc_41840F
; ---------------------------------------------------------------------------

loc_417FFA:				; CODE XREF: sub_417F4C+9Bj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_14], 0
		jmp	short loc_418011
; ---------------------------------------------------------------------------

loc_418009:				; CODE XREF: sub_417F4C+D7j
					; sub_417F4C+EBj ...
		add	[ebp+var_10], 1
		add	[ebp+var_14], 1

loc_418011:				; CODE XREF: sub_417F4C+BBj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_418025
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_418009

loc_418025:				; CODE XREF: sub_417F4C+CDj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_418039
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_418009

loc_418039:				; CODE XREF: sub_417F4C+E1j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_41804D
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	short loc_418009

loc_41804D:				; CODE XREF: sub_417F4C+F5j
		cmp	[ebp+var_14], 20h
		jz	short loc_418064
		mov	[esp+78h+Str1],	76h
		call	sub_410197
		jmp	loc_41840F
; ---------------------------------------------------------------------------

loc_418064:				; CODE XREF: sub_417F4C+105j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_418094
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_418083
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[ebp+var_18], eax
		jmp	short loc_418094
; ---------------------------------------------------------------------------

loc_418083:				; CODE XREF: sub_417F4C+12Aj
		mov	[esp+78h+Str1],	76h
		call	sub_410197
		jmp	loc_41840F
; ---------------------------------------------------------------------------

loc_418094:				; CODE XREF: sub_417F4C+120j
					; sub_417F4C+135j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_14], 0
		jmp	loc_418143
; ---------------------------------------------------------------------------

loc_4180A6:				; CODE XREF: sub_417F4C+1FBj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4180C3
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_4180EF
; ---------------------------------------------------------------------------

loc_4180C3:				; CODE XREF: sub_417F4C+162j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4180DE
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_4180ED
; ---------------------------------------------------------------------------

loc_4180DE:				; CODE XREF: sub_417F4C+17Fj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_4180ED:				; CODE XREF: sub_417F4C+190j
		mov	edx, eax

loc_4180EF:				; CODE XREF: sub_417F4C+175j
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41810A
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_418131
; ---------------------------------------------------------------------------

loc_41810A:				; CODE XREF: sub_417F4C+1AEj
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_418125
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_418131
; ---------------------------------------------------------------------------

loc_418125:				; CODE XREF: sub_417F4C+1C9j
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_418131:				; CODE XREF: sub_417F4C+1BCj
					; sub_417F4C+1D7j
		add	edx, eax
		lea	eax, [ebp+Buf2]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_10], 2
		add	[ebp+var_14], 1

loc_418143:				; CODE XREF: sub_417F4C+155j
		cmp	[ebp+var_14], 0Fh
		jle	loc_4180A6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, 10h
		jz	short loc_418169
		mov	[esp+78h+Str1],	6Fh
		call	sub_410197
		jmp	loc_41840F
; ---------------------------------------------------------------------------

loc_418169:				; CODE XREF: sub_417F4C+20Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+78h+Size],	10h ; Size
		lea	edx, [ebp+Buf2]
		mov	[esp+78h+Str2],	edx ; Buf2
		mov	[esp+78h+Str1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_41819B
		mov	[esp+78h+Str1],	5Bh
		call	sub_410197
		jmp	loc_41840F
; ---------------------------------------------------------------------------

loc_41819B:				; CODE XREF: sub_417F4C+4Bj
					; sub_417F4C+23Cj
		cmp	[ebp+var_18], 0
		jz	short loc_4181BD
		mov	[esp+78h+Size],	2
		mov	eax, [ebp+var_18]
		mov	[esp+78h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Str1],	eax
		call	sub_416F93
		jmp	short loc_4181C2
; ---------------------------------------------------------------------------

loc_4181BD:				; CODE XREF: sub_417F4C+253j
		mov	eax, 0

loc_4181C2:				; CODE XREF: sub_417F4C+26Fj
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4181D3
		mov	eax, [ebp+var_C]
		jmp	loc_41840F
; ---------------------------------------------------------------------------

loc_4181D3:				; CODE XREF: sub_417F4C+27Dj
		mov	eax, [ebp+arg_C]
		mov	[esp+78h+Size],	eax
		mov	eax, [ebp+arg_8]
		mov	[esp+78h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Str1],	eax
		call	sub_4136EE
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_41840C
		mov	[ebp+Dst], 0
		mov	[ebp+var_2C], 0
		cmp	[ebp+arg_14], 6Fh
		jbe	short loc_418223
		cmp	[ebp+arg_14], 7Fh
		ja	short loc_418223
		mov	eax, 80h
		sub	eax, [ebp+arg_14]
		mov	[ebp+var_24], eax
		jmp	loc_4182A6
; ---------------------------------------------------------------------------

loc_418223:				; CODE XREF: sub_417F4C+2BFj
					; sub_417F4C+2C5j
		cmp	[ebp+arg_14], 0AFh
		jbe	short loc_418242
		cmp	[ebp+arg_14], 0BFh
		ja	short loc_418242
		mov	eax, 0C0h
		sub	eax, [ebp+arg_14]
		mov	[ebp+var_24], eax
		jmp	short loc_4182A6
; ---------------------------------------------------------------------------

loc_418242:				; CODE XREF: sub_417F4C+2DEj
					; sub_417F4C+2E7j
		cmp	[ebp+arg_14], 0EFh
		jbe	short loc_418261
		cmp	[ebp+arg_14], 0FFh
		ja	short loc_418261
		mov	eax, 100h
		sub	eax, [ebp+arg_14]
		mov	[ebp+var_24], eax
		jmp	short loc_4182A6
; ---------------------------------------------------------------------------

loc_418261:				; CODE XREF: sub_417F4C+2FDj
					; sub_417F4C+306j
		cmp	[ebp+arg_14], 16Fh
		jbe	short loc_418280
		cmp	[ebp+arg_14], 17Fh
		ja	short loc_418280
		mov	eax, 180h
		sub	eax, [ebp+arg_14]
		mov	[ebp+var_24], eax
		jmp	short loc_4182A6
; ---------------------------------------------------------------------------

loc_418280:				; CODE XREF: sub_417F4C+31Cj
					; sub_417F4C+325j
		cmp	[ebp+arg_14], 1EFh
		jbe	short loc_41829F
		cmp	[ebp+arg_14], 1FFh
		ja	short loc_41829F
		mov	eax, 200h
		sub	eax, [ebp+arg_14]
		mov	[ebp+var_24], eax
		jmp	short loc_4182A6
; ---------------------------------------------------------------------------

loc_41829F:				; CODE XREF: sub_417F4C+33Bj
					; sub_417F4C+344j
		mov	[ebp+var_24], 0

loc_4182A6:				; CODE XREF: sub_417F4C+2D2j
					; sub_417F4C+2F4j ...
		cmp	[ebp+var_24], 0
		jz	short loc_41831C
		add	[ebp+var_24], 1
		mov	eax, [ebp+arg_14]
		mov	edx, [ebp+var_24]
		add	eax, edx
		mov	[esp+78h+Str1],	eax
		call	gcry_malloc
		mov	[ebp+Dst], eax
		cmp	[ebp+Dst], 0
		jnz	short loc_4182D3
		call	sub_4101BF
		jmp	loc_41840F
; ---------------------------------------------------------------------------

loc_4182D3:				; CODE XREF: sub_417F4C+37Bj
		mov	eax, [ebp+Dst]
		mov	edx, [ebp+var_24]
		mov	[esp+78h+Size],	edx ; Size
		mov	[esp+78h+Str2],	0 ; Val
		mov	[esp+78h+Str1],	eax ; Dst
		call	memset
		mov	eax, [ebp+Dst]
		add	eax, [ebp+var_24]
		mov	edx, [ebp+Src]
		mov	ecx, [ebp+arg_14]
		mov	[esp+78h+Size],	ecx ; Size
		mov	[esp+78h+Str2],	edx ; Src
		mov	[esp+78h+Str1],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+Dst]
		mov	[ebp+Src], eax
		mov	eax, [ebp+var_24]
		add	[ebp+arg_14], eax
		mov	[ebp+var_2C], 0FFFFFFFFh

loc_41831C:				; CODE XREF: sub_417F4C+35Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+30h]
		and	eax, 2
		test	al, al
		jz	short loc_41834F
		cmp	[ebp+arg_14], 0FEh
		jbe	short loc_41834F
		mov	dword ptr [ebp+var_1C],	1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+3Ch]
		movzx	eax, ax
		mov	[ebp+var_20], eax
		jmp	short loc_418386
; ---------------------------------------------------------------------------

loc_41834F:				; CODE XREF: sub_417F4C+3DFj
					; sub_417F4C+3E8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, byte ptr [eax+30h]
		and	eax, 1
		test	al, al
		jz	short loc_418379
		cmp	[ebp+arg_14], 0FEh
		jbe	short loc_418379
		mov	dword ptr [ebp+var_1C],	0FFFFFF02h
		mov	[ebp+var_20], 0
		jmp	short loc_418386
; ---------------------------------------------------------------------------

loc_418379:				; CODE XREF: sub_417F4C+412j
					; sub_417F4C+41Bj
		mov	[ebp+var_20], 0
		mov	eax, [ebp+var_20]
		mov	dword ptr [ebp+var_1C],	eax

loc_418386:				; CODE XREF: sub_417F4C+401j
					; sub_417F4C+42Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_1C]
		mov	[esp+78h+var_5C], edx ;	int
		mov	edx, [ebp+arg_18]
		mov	[esp+78h+var_60], edx ;	int
		mov	edx, [ebp+var_2C]
		mov	[esp+78h+var_64], edx ;	int
		mov	edx, [ebp+var_20]
		mov	[esp+78h+var_68], edx ;	int
		mov	edx, [ebp+arg_14]
		mov	[esp+78h+var_6C], edx ;	size_t
		mov	edx, [ebp+Src]
		mov	[esp+78h+Size],	edx ; void *
		mov	edx, dword ptr [ebp+var_1C]
		mov	[esp+78h+Str2],	edx ; char
		mov	[esp+78h+Str1],	eax ; char
		call	sub_40D716
		mov	[ebp+var_C], eax
		mov	eax, [ebp+Dst]
		mov	[esp+78h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	[esp+78h+Str1],	eax
		call	sub_4101B2
		cmp	eax, 6Ch
		jnz	short loc_41840C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+2Ch]
		cmp	ax, 5
		jnz	short loc_41840C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 200h
		jnz	short loc_41840C
		mov	[esp+78h+Str1],	offset aNoteCardsWithM ; "NOTE:	Cards with manufacturer	id 5 and "...
		call	sub_43CAF7

loc_41840C:				; CODE XREF: sub_417F4C+2A7j
					; sub_417F4C+495j ...
		mov	eax, [ebp+var_C]

loc_41840F:				; CODE XREF: sub_417F4C+31j
					; sub_417F4C+A9j ...
		add	esp, 70h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_417F4C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_418416	proc near		; DATA XREF: sub_418EB5+64Co

Str1		= dword	ptr -68h
Str2		= dword	ptr -64h
Size		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Buf2		= byte ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 60h
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_418435
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_418446

loc_418435:				; CODE XREF: sub_418416+13j
		mov	[esp+68h+Str1],	37h
		call	sub_410197
		jmp	loc_418778
; ---------------------------------------------------------------------------

loc_418446:				; CODE XREF: sub_418416+1Dj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 1Fh
		jbe	short loc_418492
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aD27600012401 ; "D27600012401"
		mov	ecx, 0Ch
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_4184A3

loc_418492:				; CODE XREF: sub_418416+52j
		mov	[esp+68h+Str1],	76h
		call	sub_410197
		jmp	loc_418778
; ---------------------------------------------------------------------------

loc_4184A3:				; CODE XREF: sub_418416+7Aj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	short loc_4184BA
; ---------------------------------------------------------------------------

loc_4184B2:				; CODE XREF: sub_418416+B6j
					; sub_418416+CAj ...
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_4184BA:				; CODE XREF: sub_418416+9Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4184CE
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_4184B2

loc_4184CE:				; CODE XREF: sub_418416+ACj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_4184E2
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_4184B2

loc_4184E2:				; CODE XREF: sub_418416+C0j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_4184F6
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	short loc_4184B2

loc_4184F6:				; CODE XREF: sub_418416+D4j
		cmp	[ebp+var_10], 20h
		jz	short loc_41850D
		mov	[esp+68h+Str1],	76h
		call	sub_410197
		jmp	loc_418778
; ---------------------------------------------------------------------------

loc_41850D:				; CODE XREF: sub_418416+E4j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_418552
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jz	short loc_418552
		mov	[esp+68h+Str2],	offset aChv3 ; "[CHV3]"
		mov	eax, [ebp+var_C]
		mov	[esp+68h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_418541
		mov	[ebp+var_14], 1
		jmp	short loc_418552
; ---------------------------------------------------------------------------

loc_418541:				; CODE XREF: sub_418416+120j
		mov	[esp+68h+Str1],	76h
		call	sub_410197
		jmp	loc_418778
; ---------------------------------------------------------------------------

loc_418552:				; CODE XREF: sub_418416+FFj
					; sub_418416+109j ...
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_418601
; ---------------------------------------------------------------------------

loc_418564:				; CODE XREF: sub_418416+1EFj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_418581
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_4185AD
; ---------------------------------------------------------------------------

loc_418581:				; CODE XREF: sub_418416+156j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41859C
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_4185AB
; ---------------------------------------------------------------------------

loc_41859C:				; CODE XREF: sub_418416+173j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_4185AB:				; CODE XREF: sub_418416+184j
		mov	edx, eax

loc_4185AD:				; CODE XREF: sub_418416+169j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4185C8
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_4185EF
; ---------------------------------------------------------------------------

loc_4185C8:				; CODE XREF: sub_418416+1A2j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4185E3
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_4185EF
; ---------------------------------------------------------------------------

loc_4185E3:				; CODE XREF: sub_418416+1BDj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_4185EF:				; CODE XREF: sub_418416+1B0j
					; sub_418416+1CBj
		add	edx, eax
		lea	eax, [ebp+Buf2]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_C], 2
		add	[ebp+var_10], 1

loc_418601:				; CODE XREF: sub_418416+149j
		cmp	[ebp+var_10], 0Fh
		jle	loc_418564
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, 10h
		jz	short loc_418627
		mov	[esp+68h+Str1],	6Fh
		call	sub_410197
		jmp	loc_418778
; ---------------------------------------------------------------------------

loc_418627:				; CODE XREF: sub_418416+1FEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+68h+Size],	10h ; Size
		lea	edx, [ebp+Buf2]
		mov	[esp+68h+Str2],	edx ; Buf2
		mov	[esp+68h+Str1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_418659
		mov	[esp+68h+Str1],	5Bh
		call	sub_410197
		jmp	loc_418778
; ---------------------------------------------------------------------------

loc_418659:				; CODE XREF: sub_418416+230j
		cmp	[ebp+var_14], 0
		jz	loc_41875F
		mov	[esp+68h+var_58], 0
		lea	eax, [ebp+var_38]
		mov	[esp+68h+var_5C], eax
		lea	eax, [ebp+var_34]
		mov	[esp+68h+Size],	eax
		mov	[esp+68h+Str2],	0C4h ; char
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Str1],	eax
		call	sub_41075F
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_41869D
		mov	eax, [ebp+var_38]
		cmp	eax, 6
		ja	short loc_4186CD

loc_41869D:				; CODE XREF: sub_418416+27Dj
		mov	[esp+68h+Str1],	offset aErrorRetrievin ; "error	retrieving CHV status from card\n"
		call	sub_43C238
		mov	[esp+68h+Str1],	eax ; char *
		call	sub_43CB21
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Str1],	eax
		call	gcry_free
		mov	[esp+68h+Str1],	6Ch
		call	sub_410197
		jmp	loc_418778
; ---------------------------------------------------------------------------

loc_4186CD:				; CODE XREF: sub_418416+285j
		mov	eax, [ebp+var_34]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Str1],	eax
		call	gcry_free
		cmp	[ebp+var_1C], 0
		jnz	short loc_41870F
		mov	[esp+68h+Str1],	offset aCardIsPermanen ; "card is permanently locked!\n"
		call	sub_43C238
		mov	[esp+68h+Str1],	eax ; char *
		call	sub_43CAF7
		mov	[esp+68h+Str1],	57h
		call	sub_410197
		jmp	short loc_418778
; ---------------------------------------------------------------------------

loc_41870F:				; CODE XREF: sub_418416+2D5j
		cmp	[ebp+var_1C], 2
		jg	short loc_418737
		mov	[esp+68h+Str1],	offset aVerificationOf ; "verification of Admin	PIN is currently "...
		call	sub_43C238
		mov	[esp+68h+Str1],	eax ; char *
		call	sub_43CAF7
		mov	[esp+68h+Str1],	1
		call	sub_410197
		jmp	short loc_418778
; ---------------------------------------------------------------------------

loc_418737:				; CODE XREF: sub_418416+2FDj
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		and	edx, 0FFFFFFF7h
		mov	[eax+18h], dl
		mov	eax, [ebp+arg_C]
		mov	[esp+68h+Size],	eax
		mov	eax, [ebp+arg_8]
		mov	[esp+68h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Str1],	eax
		call	sub_413993
		jmp	short loc_418778
; ---------------------------------------------------------------------------

loc_41875F:				; CODE XREF: sub_418416+247j
		mov	eax, [ebp+arg_C]
		mov	[esp+68h+Size],	eax
		mov	eax, [ebp+arg_8]
		mov	[esp+68h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Str1],	eax
		call	sub_4136EE

loc_418778:				; CODE XREF: sub_418416+2Bj
					; sub_418416+88j ...
		add	esp, 60h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_418416	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41877F	proc near		; CODE XREF: sub_418EB5+574p

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 1
		test	al, al
		jz	short loc_41879A
		mov	eax, offset aYes ; "yes"
		jmp	short loc_41879F
; ---------------------------------------------------------------------------

loc_41879A:				; CODE XREF: sub_41877F+12j
		mov	eax, offset aNo	; "no"

loc_41879F:				; CODE XREF: sub_41877F+19j
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aVersion2______ ; "Version-2 ......: %s\n"
		call	sub_43CAF7
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 2
		test	al, al
		jz	short loc_4187C4
		mov	eax, offset aYes ; "yes"
		jmp	short loc_4187C9
; ---------------------------------------------------------------------------

loc_4187C4:				; CODE XREF: sub_41877F+3Cj
		mov	eax, offset aNo	; "no"

loc_4187C9:				; CODE XREF: sub_41877F+43j
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aGetChallenge__ ; "Get-Challenge ..: %s"
		call	sub_43CAF7
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 2
		test	al, al
		jz	short loc_418801
		mov	eax, [ebp+arg_0]
		movzx	eax, word ptr [eax+38h]
		movzx	eax, ax
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aUBytesMax ; "	(%u bytes max)"
		call	sub_43CBE8

loc_418801:				; CODE XREF: sub_41877F+66j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 4
		test	al, al
		jz	short loc_418816
		mov	eax, offset aYes ; "yes"
		jmp	short loc_41881B
; ---------------------------------------------------------------------------

loc_418816:				; CODE XREF: sub_41877F+8Ej
		mov	eax, offset aNo	; "no"

loc_41881B:				; CODE XREF: sub_41877F+95j
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aKeyImport_____ ; "Key-Import .....: %s\n"
		call	sub_43CAF7
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 8
		test	al, al
		jz	short loc_418840
		mov	eax, offset aYes ; "yes"
		jmp	short loc_418845
; ---------------------------------------------------------------------------

loc_418840:				; CODE XREF: sub_41877F+B8j
		mov	eax, offset aNo	; "no"

loc_418845:				; CODE XREF: sub_41877F+BFj
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aChangeForcePw1 ; "Change-Force-PW1: %s\n"
		call	sub_43CAF7
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 10h
		test	al, al
		jz	short loc_41886A
		mov	eax, offset aYes ; "yes"
		jmp	short loc_41886F
; ---------------------------------------------------------------------------

loc_41886A:				; CODE XREF: sub_41877F+E2j
		mov	eax, offset aNo	; "no"

loc_41886F:				; CODE XREF: sub_41877F+E9j
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aPrivateDos____ ; "Private-DOs	....: %s\n"
		call	sub_43CAF7
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 20h
		test	al, al
		jz	short loc_418894
		mov	eax, offset aYes ; "yes"
		jmp	short loc_418899
; ---------------------------------------------------------------------------

loc_418894:				; CODE XREF: sub_41877F+10Cj
		mov	eax, offset aNo	; "no"

loc_418899:				; CODE XREF: sub_41877F+113j
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aAlgoAttrChange ; "Algo-Attr-Change: %s\n"
		call	sub_43CAF7
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 40h
		test	al, al
		jz	short loc_4188BE
		mov	eax, offset aYes ; "yes"
		jmp	short loc_4188C3
; ---------------------------------------------------------------------------

loc_4188BE:				; CODE XREF: sub_41877F+136j
		mov	eax, offset aNo	; "no"

loc_4188C3:				; CODE XREF: sub_41877F+13Dj
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aSmSupport_____ ; "SM-Support .....: %s"
		call	sub_43CAF7
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 40h
		test	al, al
		jz	short loc_41890B
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 0FFFFFF80h
		test	al, al
		jz	short loc_4188F6
		mov	eax, offset aAes128 ; "AES-128"
		jmp	short loc_4188FB
; ---------------------------------------------------------------------------

loc_4188F6:				; CODE XREF: sub_41877F+16Ej
		mov	eax, offset a3des ; "3DES"

loc_4188FB:				; CODE XREF: sub_41877F+175j
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aS_1 ;	" (%s)"
		call	sub_43CBE8

loc_41890B:				; CODE XREF: sub_41877F+160j
		mov	eax, [ebp+arg_0]
		movzx	eax, word ptr [eax+35h]
		movzx	eax, ax
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aMaxCert3Len__U ; "Max-Cert3-Len ..: %u\n"
		call	sub_43CAF7
		mov	eax, [ebp+arg_0]
		movzx	eax, word ptr [eax+3Ah]
		movzx	eax, ax
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aMaxCmdData___U ; "Max-Cmd-Data ...: %u\n"
		call	sub_43CAF7
		mov	eax, [ebp+arg_0]
		movzx	eax, word ptr [eax+3Ch]
		movzx	eax, ax
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aMaxRspData___U ; "Max-Rsp-Data ...: %u\n"
		call	sub_43CAF7
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+30h]
		and	eax, 1
		test	al, al
		jz	short loc_41896E
		mov	eax, offset aYes ; "yes"
		jmp	short loc_418973
; ---------------------------------------------------------------------------

loc_41896E:				; CODE XREF: sub_41877F+1E6j
		mov	eax, offset aNo	; "no"

loc_418973:				; CODE XREF: sub_41877F+1EDj
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aCmdChaining___ ; "Cmd-Chaining ...: %s\n"
		call	sub_43CAF7
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+30h]
		and	eax, 2
		test	al, al
		jz	short loc_418998
		mov	eax, offset aYes ; "yes"
		jmp	short loc_41899D
; ---------------------------------------------------------------------------

loc_418998:				; CODE XREF: sub_41877F+210j
		mov	eax, offset aNo	; "no"

loc_41899D:				; CODE XREF: sub_41877F+217j
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aExtLcLe______S ; "Ext-Lc-Le ......: %s\n"
		call	sub_43CAF7
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+28h]
		movzx	eax, al
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aStatusIndicato ; "Status Indicator: %02X\n"
		call	sub_43CAF7
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+40h]
		and	eax, 1
		test	al, al
		jz	short loc_4189DC
		mov	eax, offset aYes ; "yes"
		jmp	short loc_4189E1
; ---------------------------------------------------------------------------

loc_4189DC:				; CODE XREF: sub_41877F+254j
		mov	eax, offset aNo	; "no"

loc_4189E1:				; CODE XREF: sub_41877F+25Bj
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aGnupgNoSync__S ; "GnuPG-No-Sync ..: %s\n"
		call	sub_43CAF7
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+40h]
		and	eax, 2
		test	al, al
		jz	short loc_418A06
		mov	eax, offset aYes ; "yes"
		jmp	short loc_418A0B
; ---------------------------------------------------------------------------

loc_418A06:				; CODE XREF: sub_41877F+27Ej
		mov	eax, offset aNo	; "no"

loc_418A0B:				; CODE XREF: sub_41877F+285j
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aGnupgDefPw2__S ; "GnuPG-Def-PW2 ..: %s\n"
		call	sub_43CAF7
		leave
		retn
sub_41877F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_418A1D	proc near		; CODE XREF: sub_418EB5+242p

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 3
		ja	short loc_418A3A
		mov	[esp+28h+var_28], offset aWarningHistori ; "warning: historical	bytes are too short"...
		call	sub_43CB21
		jmp	locret_418B24
; ---------------------------------------------------------------------------

loc_418A3A:				; CODE XREF: sub_418A1D+Aj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_418A55
		mov	[esp+28h+var_28], offset aWarningBadCate ; "warning: bad category indicator in hist"...
		call	sub_43CB21
		jmp	locret_418B24
; ---------------------------------------------------------------------------

loc_418A55:				; CODE XREF: sub_418A1D+25j
		add	[ebp+arg_4], 1
		sub	[ebp+arg_8], 1
		mov	eax, [ebp+arg_8]
		sub	eax, 3
		add	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+28h], dl
		sub	[ebp+arg_8], 3
		jmp	loc_418B1A
; ---------------------------------------------------------------------------

loc_418A78:				; CODE XREF: sub_418A1D+101j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		add	eax, 1
		cmp	eax, [ebp+arg_8]
		jbe	short loc_418AAF
		mov	[esp+28h+var_28], offset aWarningBadComp ; "warning: bad Compact-TLV in	historical "...
		call	sub_43CB21
		jmp	short locret_418B24
; ---------------------------------------------------------------------------

loc_418AAF:				; CODE XREF: sub_418A1D+82j
		add	[ebp+arg_4], 1
		sub	[ebp+arg_8], 1
		cmp	[ebp+var_C], 7
		jnz	short loc_418B0E
		cmp	[ebp+var_10], 3
		jnz	short loc_418B0E
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		shr	dl, 7
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		and	ecx, 1
		movzx	edx, byte ptr [eax+30h]
		and	edx, 0FFFFFFFEh
		or	edx, ecx
		mov	[eax+30h], dl
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 40h
		test	eax, eax
		setnz	dl
		mov	eax, [ebp+arg_0]
		and	edx, 1
		lea	ecx, [edx+edx]
		movzx	edx, byte ptr [eax+30h]
		and	edx, 0FFFFFFFDh
		or	edx, ecx
		mov	[eax+30h], dl

loc_418B0E:				; CODE XREF: sub_418A1D+9Ej
					; sub_418A1D+A4j
		mov	eax, [ebp+var_10]
		add	[ebp+arg_4], eax
		mov	eax, [ebp+var_10]
		sub	[ebp+arg_8], eax

loc_418B1A:				; CODE XREF: sub_418A1D+56j
		cmp	[ebp+arg_8], 0
		jnz	loc_418A78

locret_418B24:				; CODE XREF: sub_418A1D+18j
					; sub_418A1D+33j ...
		leave
		retn
sub_418A1D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_418B26	proc near		; CODE XREF: sub_415465+1B8p
					; sub_418EB5+587p ...

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_23		= dword	ptr -23h
var_1F		= byte ptr -1Fh
var_1E		= dword	ptr -1Eh
var_1A		= byte ptr -1Ah
var_19		= dword	ptr -19h
var_15		= byte ptr -15h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 40h
		mov	[ebp+var_23], 6E676973h
		mov	[ebp+var_1F], 0
		mov	[ebp+var_1E], 72636E65h
		mov	[ebp+var_1A], 0
		mov	[ebp+var_19], 68747561h
		mov	[ebp+var_15], 0
		cmp	[ebp+arg_4], 0
		js	short loc_418B5B
		cmp	[ebp+arg_4], 2
		jle	short loc_418B79

loc_418B5B:				; CODE XREF: sub_418B26+2Dj
		mov	[esp+48h+var_40], 0EE9h	; int
		mov	[esp+48h+var_44], offset a____Gnupg22__2 ; "../../gnupg2-2.0.30/scd/app-openpgp.c"
		mov	[esp+48h+var_48], offset aKeyno0Keyno2 ; "keyno	>=0 && keyno <=	2"
		call	sub_442650
		jmp	short loc_418B7A
; ---------------------------------------------------------------------------

loc_418B79:				; CODE XREF: sub_418B26+33j
		nop

loc_418B7A:				; CODE XREF: sub_418B26+51j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 50h
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+0C1h]
		mov	[esp+48h+var_38], 0
		lea	eax, [ebp+var_14]
		mov	[esp+48h+var_3C], eax
		lea	eax, [ebp+var_10]
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+var_44], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41075F
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_418BEB
		mov	eax, [ebp+arg_4]
		add	eax, 0C1h
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aErrorReadingDo ; "error reading DO 0x%02X\n"
		call	sub_43CB21
		jmp	loc_418EAE
; ---------------------------------------------------------------------------

loc_418BEB:				; CODE XREF: sub_418B26+A6j
		mov	eax, [ebp+var_14]
		test	eax, eax
		jnz	short loc_418C1A
		mov	eax, [ebp+arg_4]
		add	eax, 0C1h
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aErrorReadingDo ; "error reading DO 0x%02X\n"
		call	sub_43CB21
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		jmp	loc_418EAE
; ---------------------------------------------------------------------------

loc_418C1A:				; CODE XREF: sub_418B26+CAj
		mov	eax, ds:dword_451D24
		test	eax, eax
		jz	short loc_418C42
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		shl	eax, 2
		add	edx, eax
		lea	eax, [ebp+var_23]
		add	eax, edx
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aKeyAttrS__ ; "Key-Attr-%s ..:	"
		call	sub_43CAF7

loc_418C42:				; CODE XREF: sub_418B26+FBj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 1
		jnz	loc_418E80
		mov	eax, [ebp+var_14]
		cmp	eax, 5
		jz	short loc_418C64
		mov	eax, [ebp+var_14]
		cmp	eax, 6
		jnz	loc_418E80

loc_418C64:				; CODE XREF: sub_418B26+130j
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+1Ch]
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 8
		mov	eax, [ebp+var_10]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, edx
		mov	ecx, eax
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ebx
		add	eax, 50h
		mov	[eax], ecx
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+1Ch]
		mov	eax, [ebp+var_10]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 8
		mov	eax, [ebp+var_10]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, edx
		mov	ecx, eax
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ebx
		add	eax, 54h
		mov	[eax], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 58h
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_14]
		cmp	eax, 5
		ja	short loc_418D1C
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 58h
		mov	dword ptr [eax], 1
		jmp	short loc_418D8C
; ---------------------------------------------------------------------------

loc_418D1C:				; CODE XREF: sub_418B26+1D5j
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+1Ch]
		mov	eax, [ebp+var_10]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_418D74
		mov	eax, [ebp+var_10]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 1
		jz	short loc_418D6B
		mov	eax, [ebp+var_10]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 2
		jz	short loc_418D64
		mov	eax, [ebp+var_10]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 3
		jnz	short loc_418D5D
		mov	eax, 4
		jmp	short loc_418D62
; ---------------------------------------------------------------------------

loc_418D5D:				; CODE XREF: sub_418B26+22Ej
		mov	eax, 0

loc_418D62:				; CODE XREF: sub_418B26+235j
		jmp	short loc_418D69
; ---------------------------------------------------------------------------

loc_418D64:				; CODE XREF: sub_418B26+221j
		mov	eax, 3

loc_418D69:				; CODE XREF: sub_418B26:loc_418D62j
		jmp	short loc_418D70
; ---------------------------------------------------------------------------

loc_418D6B:				; CODE XREF: sub_418B26+214j
		mov	eax, 2

loc_418D70:				; CODE XREF: sub_418B26:loc_418D69j
		mov	edx, eax
		jmp	short loc_418D79
; ---------------------------------------------------------------------------

loc_418D74:				; CODE XREF: sub_418B26+207j
		mov	edx, 1

loc_418D79:				; CODE XREF: sub_418B26+24Cj
		mov	ecx, [ebp+arg_4]
		mov	eax, ecx
		add	eax, eax
		add	eax, ecx
		shl	eax, 2
		add	eax, ebx
		add	eax, 58h
		mov	[eax], edx

loc_418D8C:				; CODE XREF: sub_418B26+1F4j
		mov	eax, ds:dword_451D24
		test	eax, eax
		jz	loc_418EA3
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 58h
		mov	eax, [eax]
		cmp	eax, 1
		jz	short loc_418E2F
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 58h
		mov	eax, [eax]
		cmp	eax, 2
		jz	short loc_418E26
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 58h
		mov	eax, [eax]
		cmp	eax, 3
		jz	short loc_418E1F
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, ecx
		add	eax, 58h
		mov	eax, [eax]
		cmp	eax, 4
		jnz	short loc_418E18
		mov	eax, offset aCrtN ; "crt+n"
		jmp	short loc_418E1D
; ---------------------------------------------------------------------------

loc_418E18:				; CODE XREF: sub_418B26+2E9j
		mov	eax, offset a?	; "?"

loc_418E1D:				; CODE XREF: sub_418B26+2F0j
		jmp	short loc_418E24
; ---------------------------------------------------------------------------

loc_418E1F:				; CODE XREF: sub_418B26+2CBj
		mov	eax, offset aCrt ; "crt"

loc_418E24:				; CODE XREF: sub_418B26:loc_418E1Dj
		jmp	short loc_418E2B
; ---------------------------------------------------------------------------

loc_418E26:				; CODE XREF: sub_418B26+2ADj
		mov	eax, offset aStdN ; "std+n"

loc_418E2B:				; CODE XREF: sub_418B26:loc_418E24j
		mov	edx, eax
		jmp	short loc_418E34
; ---------------------------------------------------------------------------

loc_418E2F:				; CODE XREF: sub_418B26+28Fj
		mov	edx, offset aStd ; "std"

loc_418E34:				; CODE XREF: sub_418B26+307j
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+1Ch]
		mov	ecx, [ebp+arg_4]
		mov	eax, ecx
		add	eax, eax
		add	eax, ecx
		shl	eax, 2
		add	eax, ebx
		add	eax, 54h
		mov	ebx, [eax]
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+1Ch]
		mov	ecx, [ebp+arg_4]
		mov	eax, ecx
		add	eax, eax
		add	eax, ecx
		shl	eax, 2
		add	eax, esi
		add	eax, 50h
		mov	eax, [eax]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], ebx
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aRsaNUEUFmtS ;	"RSA, n=%u, e=%u, fmt=%s\n"
		call	sub_43CBE8
		jmp	short loc_418EA3
; ---------------------------------------------------------------------------

loc_418E80:				; CODE XREF: sub_418B26+124j
					; sub_418B26+138j
		mov	eax, ds:dword_451D24
		test	eax, eax
		jz	short loc_418EA3
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], eax
		mov	[esp+48h+var_48], offset byte_44A6F4
		call	sub_43CC18

loc_418EA3:				; CODE XREF: sub_418B26+26Dj
					; sub_418B26+358j ...
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gcry_free

loc_418EAE:				; CODE XREF: sub_418B26+C0j
					; sub_418B26+EFj
		add	esp, 40h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_418B26	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_418EB5	proc near		; CODE XREF: sub_40E65D+383p

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	dword ptr [ebp+var_10],	eax
		mov	[esp+48h+var_3C], 1 ; int
		mov	[esp+48h+var_40], 6 ; size_t
		mov	[esp+48h+var_44], offset aV_0 ;	"v"
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+48h+var_48], eax ;	char
		call	sub_40CCE9
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_41950B
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], offset aOpenpgp_0 ; "OPENPGP"
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		and	edx, 0FFFFFFFEh
		mov	[eax+18h], dl
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		and	edx, 0FFFFFFFBh
		mov	[eax+18h], dl
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		and	edx, 0FFFFFFF7h
		mov	[eax+18h], dl
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		lea	eax, [ebp+var_20]
		mov	[esp+48h+var_38], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], 4Fh
		mov	[esp+48h+var_44], 0 ; char
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	sub_40D3CB
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_41950A
		mov	eax, ds:dword_451D24
		test	eax, eax
		jz	short loc_418F94
		mov	[esp+48h+var_48], offset aAid ;	"AID: "
		call	sub_43CAF7
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], eax
		mov	[esp+48h+var_48], offset byte_44A6F4
		call	sub_43CC18

loc_418F94:				; CODE XREF: sub_418EB5+B7j
		mov	eax, [ebp+var_1C]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 8
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_1C]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_1C]
		add	eax, 8
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 8
		mov	eax, [ebp+var_1C]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, edx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	[ebp+var_1C], 0
		mov	[esp+48h+var_44], 74h
		mov	[esp+48h+var_48], 1
		call	gcry_calloc
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_419055
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+48h+var_48], eax
		call	gpg_err_code_from_errno
		mov	[esp+48h+var_48], eax
		call	sub_410197
		mov	[ebp+var_C], eax
		jmp	loc_41950B
; ---------------------------------------------------------------------------

loc_419055:				; CODE XREF: sub_418EB5+17Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+var_14]
		mov	[eax+2Ch], dx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 1FFh
		jbe	short loc_41907F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	edx, byte ptr [eax+34h]
		or	edx, 1
		mov	[eax+34h], dl

loc_41907F:				; CODE XREF: sub_418EB5+1B8j
		mov	[esp+48h+var_38], 0
		lea	eax, [ebp+var_20]
		mov	[esp+48h+var_3C], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+var_44], 5F52h	; char
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41075F
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_419107
		mov	eax, ds:dword_451D24
		test	eax, eax
		jz	short loc_4190E0
		mov	[esp+48h+var_48], offset aHistoricalByte ; "Historical Bytes: "
		call	sub_43CAF7
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], eax
		mov	[esp+48h+var_48], offset byte_44A6F4
		call	sub_43CC18

loc_4190E0:				; CODE XREF: sub_418EB5+203j
		mov	ecx, [ebp+var_20]
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[esp+48h+var_40], ecx
		mov	[esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	sub_418A1D
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_free

loc_419107:				; CODE XREF: sub_418EB5+1FAj
		mov	[esp+48h+var_38], 0
		lea	eax, [ebp+var_20]
		mov	[esp+48h+var_3C], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+var_44], 0C4h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41075F
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_41915A
		mov	[esp+48h+var_48], offset aCanTAccessSInv ; "can't access %s - invalid OpenPGP card?"...
		call	sub_43C238
		mov	[esp+48h+var_44], offset aChvStatusBytes ; "CHV	Status Bytes"
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CB21
		jmp	loc_41950B
; ---------------------------------------------------------------------------

loc_41915A:				; CODE XREF: sub_418EB5+282j
		mov	eax, [ebp+var_20]
		test	eax, eax
		jz	short loc_419172
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_419172
		mov	eax, 1
		jmp	short loc_419177
; ---------------------------------------------------------------------------

loc_419172:				; CODE XREF: sub_418EB5+2AAj
					; sub_418EB5+2B4j
		mov	eax, 0

loc_419177:				; CODE XREF: sub_418EB5+2BBj
		mov	edx, eax
		and	edx, 1
		mov	eax, [ebp+arg_0]
		and	edx, 1
		lea	ecx, [edx+edx]
		movzx	edx, byte ptr [eax+18h]
		and	edx, 0FFFFFFFDh
		or	edx, ecx
		mov	[eax+18h], dl
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	[esp+48h+var_38], 0
		lea	eax, [ebp+var_20]
		mov	[esp+48h+var_3C], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+var_44], 0C0h
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_41075F
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_4191EF
		mov	[esp+48h+var_48], offset aCanTAccessSInv ; "can't access %s - invalid OpenPGP card?"...
		call	sub_43C238
		mov	[esp+48h+var_44], offset aExtendedCapabi ; "Extended Capability	Flags"
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CB21
		jmp	loc_41950B
; ---------------------------------------------------------------------------

loc_4191EF:				; CODE XREF: sub_418EB5+317j
		mov	eax, [ebp+var_20]
		test	eax, eax
		jz	loc_4192F6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+var_1C]
		movzx	edx, byte ptr [edx]
		shr	dl, 7
		and	edx, 1
		mov	ecx, edx
		shl	ecx, 6
		movzx	edx, byte ptr [eax+34h]
		and	edx, 0FFFFFFBFh
		or	edx, ecx
		mov	[eax+34h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+var_1C]
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		and	edx, 40h
		test	edx, edx
		setnz	dl
		and	edx, 1
		lea	ecx, [edx+edx]
		movzx	edx, byte ptr [eax+34h]
		and	edx, 0FFFFFFFDh
		or	edx, ecx
		mov	[eax+34h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+var_1C]
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		and	edx, 20h
		test	edx, edx
		setnz	dl
		and	edx, 1
		lea	ecx, ds:0[edx*4]
		movzx	edx, byte ptr [eax+34h]
		and	edx, 0FFFFFFFBh
		or	edx, ecx
		mov	[eax+34h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+var_1C]
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		and	edx, 10h
		test	edx, edx
		setnz	dl
		and	edx, 1
		lea	ecx, ds:0[edx*8]
		movzx	edx, byte ptr [eax+34h]
		and	edx, 0FFFFFFF7h
		or	edx, ecx
		mov	[eax+34h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+var_1C]
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		and	edx, 8
		test	edx, edx
		setnz	dl
		and	edx, 1
		mov	ecx, edx
		shl	ecx, 4
		movzx	edx, byte ptr [eax+34h]
		and	edx, 0FFFFFFEFh
		or	edx, ecx
		mov	[eax+34h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+var_1C]
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		and	edx, 4
		test	edx, edx
		setnz	dl
		and	edx, 1
		mov	ecx, edx
		shl	ecx, 5
		movzx	edx, byte ptr [eax+34h]
		and	edx, 0FFFFFFDFh
		or	edx, ecx
		mov	[eax+34h], dl

loc_4192F6:				; CODE XREF: sub_418EB5+33Fj
		mov	eax, [ebp+var_20]
		cmp	eax, 9
		jbe	loc_4193DE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+var_1C]
		add	edx, 1
		movzx	edx, byte ptr [edx]
		cmp	dl, 1
		setz	dl
		mov	ecx, edx
		shl	ecx, 7
		movzx	edx, byte ptr [eax+34h]
		and	edx, 7Fh
		or	edx, ecx
		mov	[eax+34h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+var_1C]
		add	edx, 2
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		shl	edx, 8
		mov	ecx, edx
		mov	edx, [ebp+var_1C]
		add	edx, 3
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		or	edx, ecx
		mov	[eax+38h], dx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+var_1C]
		add	edx, 4
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		shl	edx, 8
		mov	ecx, edx
		mov	edx, [ebp+var_1C]
		add	edx, 5
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		or	edx, ecx
		movzx	edx, dx
		mov	ecx, edx
		shl	ecx, 8
		mov	edx, [eax+34h]
		and	edx, 0FF0000FFh
		or	edx, ecx
		mov	[eax+34h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+var_1C]
		add	edx, 6
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		shl	edx, 8
		mov	ecx, edx
		mov	edx, [ebp+var_1C]
		add	edx, 7
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		or	edx, ecx
		mov	[eax+3Ah], dx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+var_1C]
		add	edx, 8
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		shl	edx, 8
		mov	ecx, edx
		mov	edx, [ebp+var_1C]
		add	edx, 9
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		or	edx, ecx
		mov	[eax+3Ch], dx

loc_4193DE:				; CODE XREF: sub_418EB5+447j
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 100h
		ja	short loc_41940C
		cmp	[ebp+var_14], 1
		jnz	short loc_41940C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	edx, byte ptr [eax+34h]
		or	edx, 8
		mov	[eax+34h], dl

loc_41940C:				; CODE XREF: sub_418EB5+53Fj
					; sub_418EB5+545j
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_410EAE
		mov	eax, ds:dword_451D24
		test	eax, eax
		jz	short loc_41942E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[esp+48h+var_48], eax
		call	sub_41877F

loc_41942E:				; CODE XREF: sub_418EB5+569j
		mov	[esp+48h+var_44], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_418B26
		mov	[esp+48h+var_44], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_418B26
		mov	[esp+48h+var_44], 2
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_418B26
		mov	eax, ds:dword_451D24
		cmp	eax, 1
		jle	short loc_41947C
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	sub_410B09

loc_41947C:				; CODE XREF: sub_418EB5+5BAj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], offset sub_410220
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], offset sub_412D77
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+28h], offset sub_4130DB
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], offset sub_412F96
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], offset sub_41199B
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+34h], offset sub_413C94
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+44h], offset sub_413F6C
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+48h], offset sub_415770
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4Ch], offset sub_4168B1
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+38h], offset sub_4170F2
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+3Ch], offset sub_417C15
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+40h], offset sub_417F4C
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+50h], offset sub_414024
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+54h], offset sub_418416
		jmp	short loc_41950B
; ---------------------------------------------------------------------------

loc_41950A:				; CODE XREF: sub_418EB5+AAj
		nop

loc_41950B:				; CODE XREF: sub_418EB5+39j
					; sub_418EB5+19Bj ...
		cmp	[ebp+var_C], 0
		jz	short loc_41951C
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_410220

loc_41951C:				; CODE XREF: sub_418EB5+65Aj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_418EB5	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419524	proc near		; CODE XREF: sub_41954B+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_419544
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_419549
; ---------------------------------------------------------------------------

loc_419544:				; CODE XREF: sub_419524+7j
		mov	eax, 0

loc_419549:				; CODE XREF: sub_419524+1Ej
		pop	ebp
		retn
sub_419524	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41954B	proc near		; CODE XREF: sub_419573+Ep
					; sub_4195EC+119p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 6
		call	sub_419524
		leave
		retn
sub_41954B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419566	proc near		; CODE XREF: sub_41ACD2+1D5p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_419566	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419573	proc near		; CODE XREF: sub_4195EC+25Bp
					; sub_41A8F7+199p ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_41954B
		leave
		retn
sub_419573	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419588	proc near		; CODE XREF: sub_41C3FB+153p
					; DATA XREF: sub_41C3FB+C8o

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_4195B6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short locret_4195B6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[esp+18h+var_18], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0

locret_4195B6:				; CODE XREF: sub_419588+Aj
					; sub_419588+14j
		leave
		retn
sub_419588	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4195B8	proc near		; CODE XREF: sub_41A8F7+E0p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_4], eax
		jmp	short loc_4195DF
; ---------------------------------------------------------------------------

loc_4195C6:				; CODE XREF: sub_4195B8+2Bj
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4195D7
		mov	eax, 0
		jmp	short locret_4195EA
; ---------------------------------------------------------------------------

loc_4195D7:				; CODE XREF: sub_4195B8+16j
		sub	[ebp+arg_4], 1
		add	[ebp+var_4], 1

loc_4195DF:				; CODE XREF: sub_4195B8+Cj
		cmp	[ebp+arg_4], 0
		jnz	short loc_4195C6
		mov	eax, 1

locret_4195EA:				; CODE XREF: sub_4195B8+1Dj
		leave
		retn
sub_4195B8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4195EC	proc near		; CODE XREF: sub_419DB2+206p

Dst		= dword	ptr -78h
Src		= dword	ptr -74h
Size		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= byte ptr -3Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	[ebp+var_58], 0
		mov	[ebp+var_54], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+78h+var_68], 0
		mov	[esp+78h+var_6C], 0
		mov	[esp+78h+Size],	0
		mov	edx, [ebp+arg_4]
		mov	[esp+78h+Src], edx
		mov	[esp+78h+Dst], eax
		call	sub_40CD52
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_419641
		mov	eax, [ebp+var_1C]
		jmp	loc_41999C
; ---------------------------------------------------------------------------

loc_419641:				; CODE XREF: sub_4195EC+4Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_4C]
		mov	[esp+78h+var_64], edx
		lea	edx, [ebp+var_44]
		mov	[esp+78h+var_68], edx
		mov	[esp+78h+var_6C], 0
		mov	[esp+78h+Size],	1
		mov	[esp+78h+Src], 1
		mov	[esp+78h+Dst], eax
		call	sub_40DF53
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_419686
		mov	eax, [ebp+var_1C]
		jmp	loc_41999C
; ---------------------------------------------------------------------------

loc_419686:				; CODE XREF: sub_4195EC+90j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_4C]
		add	edx, 4
		mov	[esp+78h+var_64], edx
		lea	edx, [ebp+var_44]
		add	edx, 4
		mov	[esp+78h+var_68], edx
		mov	[esp+78h+var_6C], 0
		mov	[esp+78h+Size],	1
		mov	[esp+78h+Src], 2
		mov	[esp+78h+Dst], eax
		call	sub_40DF53
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_4196DC
		mov	eax, [ebp+var_44]
		mov	[esp+78h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+var_1C]
		jmp	loc_41999C
; ---------------------------------------------------------------------------

loc_4196DC:				; CODE XREF: sub_4195EC+DBj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax]
		cmp	eax, 2
		jg	short loc_419755
		mov	[ebp+var_20], 0
		jmp	short loc_41974D
; ---------------------------------------------------------------------------

loc_4196F2:				; CODE XREF: sub_4195EC+165j
		mov	eax, [ebp+var_20]
		mov	eax, [ebp+eax*4+var_4C]
		cmp	eax, 2
		ja	short loc_41970F
		mov	[esp+78h+Dst], 42h
		call	sub_41954B
		mov	[ebp+var_1C], eax
		jmp	short loc_419749
; ---------------------------------------------------------------------------

loc_41970F:				; CODE XREF: sub_4195EC+110j
		mov	eax, [ebp+var_20]
		mov	eax, [ebp+eax*4+var_44]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, [ebp+var_20]
		mov	eax, [ebp+eax*4+var_4C]
		sub	eax, 2
		cmp	edx, eax
		jz	short loc_41973E
		mov	[esp+78h+Dst], 41h
		call	sub_41954B
		mov	[ebp+var_1C], eax
		jmp	short loc_419749
; ---------------------------------------------------------------------------

loc_41973E:				; CODE XREF: sub_4195EC+13Fj
		mov	eax, [ebp+var_20]
		mov	[ebp+eax*4+var_58], 2

loc_419749:				; CODE XREF: sub_4195EC+121j
					; sub_4195EC+150j
		add	[ebp+var_20], 1

loc_41974D:				; CODE XREF: sub_4195EC+104j
		cmp	[ebp+var_20], 1
		jle	short loc_4196F2
		jmp	short loc_4197C6
; ---------------------------------------------------------------------------

loc_419755:				; CODE XREF: sub_4195EC+FBj
		mov	[ebp+var_20], 0
		jmp	short loc_4197C0
; ---------------------------------------------------------------------------

loc_41975E:				; CODE XREF: sub_4195EC+1CEj
		mov	eax, [ebp+var_20]
		mov	eax, [ebp+eax*4+var_58]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_20]
		mov	[ebp+eax*4+var_58], edx
		jmp	short loc_419772
; ---------------------------------------------------------------------------

loc_419771:				; CODE XREF: sub_4195EC+1D8j
		nop

loc_419772:				; CODE XREF: sub_4195EC+183j
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+eax*4+var_4C]
		mov	eax, [ebp+var_20]
		mov	eax, [ebp+eax*4+var_58]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, 1
		jbe	short loc_4197BC
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+eax*4+var_44]
		mov	eax, [ebp+var_20]
		mov	eax, [ebp+eax*4+var_58]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4197BC
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+eax*4+var_44]
		mov	eax, [ebp+var_20]
		mov	eax, [ebp+eax*4+var_58]
		add	eax, 1
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_41975E

loc_4197BC:				; CODE XREF: sub_4195EC+19Dj
					; sub_4195EC+1B4j
		add	[ebp+var_20], 1

loc_4197C0:				; CODE XREF: sub_4195EC+170j
		cmp	[ebp+var_20], 1
		jle	short loc_419771

loc_4197C6:				; CODE XREF: sub_4195EC+167j
		mov	[ebp+var_20], 0
		jmp	loc_4198C3
; ---------------------------------------------------------------------------

loc_4197D2:				; CODE XREF: sub_4195EC+2DBj
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+eax*4+var_4C]
		mov	eax, [ebp+var_20]
		mov	eax, [ebp+eax*4+var_58]
		cmp	edx, eax
		jz	loc_4198BF
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+eax*4+var_44]
		mov	eax, [ebp+var_20]
		mov	eax, [ebp+eax*4+var_58]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	loc_4198BF
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+eax*4+var_4C]
		mov	eax, [ebp+var_20]
		mov	eax, [ebp+eax*4+var_58]
		mov	edi, edx
		sub	edi, eax
		mov	eax, edi
		add	eax, 1
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	[esp+78h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_28], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_419851
		mov	eax, [ebp+var_44]
		mov	[esp+78h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+var_40]
		mov	[esp+78h+Dst], eax
		call	gcry_free
		call	sub_419573
		jmp	loc_41999C
; ---------------------------------------------------------------------------

loc_419851:				; CODE XREF: sub_4195EC+243j
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+eax*4+var_4C]
		mov	eax, [ebp+var_20]
		mov	eax, [ebp+eax*4+var_58]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_20]
		mov	eax, [ebp+eax*4+var_44]
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	eax, [ebp+eax*4+var_58]
		add	edx, eax
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[esp+78h+Size],	ecx ; Size
		mov	[esp+78h+Src], edx ; Src
		mov	[esp+78h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_20]
		mov	eax, [ebp+eax*4+var_44]
		mov	[esp+78h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_28]
		mov	[ebp+eax*4+var_44], edx
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_24]
		mov	[ebp+eax*4+var_4C], edx
		mov	eax, [ebp+var_20]
		mov	[ebp+eax*4+var_58], 0

loc_4198BF:				; CODE XREF: sub_4195EC+1F6j
					; sub_4195EC+211j
		add	[ebp+var_20], 1

loc_4198C3:				; CODE XREF: sub_4195EC+1E1j
		cmp	[ebp+var_20], 1
		jle	loc_4197D2
		cmp	[ebp+var_1C], 0
		jnz	short loc_41992C
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_54]
		lea	ebx, [edx+eax]
		mov	eax, [ebp+var_48]
		mov	edx, eax
		mov	eax, [ebp+var_54]
		mov	ecx, edx
		sub	ecx, eax
		mov	edx, [ebp+var_44]
		mov	eax, [ebp+var_58]
		add	edx, eax
		mov	eax, [ebp+var_4C]
		mov	esi, eax
		mov	eax, [ebp+var_58]
		mov	edi, esi
		sub	edi, eax
		mov	eax, edi
		mov	[esp+78h+var_60], ebx
		mov	[esp+78h+var_64], ecx
		mov	[esp+78h+var_68], edx
		mov	[esp+78h+var_6C], eax
		mov	[esp+78h+Size],	offset aPublicKeyRsaNB ; "(public-key (rsa (n %b) (e %b)))"
		mov	[esp+78h+Src], 0
		lea	eax, [ebp+var_50]
		mov	[esp+78h+Dst], eax
		call	gcry_sexp_build
		mov	[ebp+var_1C], eax

loc_41992C:				; CODE XREF: sub_4195EC+2E5j
		mov	eax, [ebp+var_44]
		mov	[esp+78h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+var_40]
		mov	[esp+78h+Dst], eax
		call	gcry_free
		cmp	[ebp+var_1C], 0
		jz	short loc_41994D
		mov	eax, [ebp+var_1C]
		jmp	short loc_41999C
; ---------------------------------------------------------------------------

loc_41994D:				; CODE XREF: sub_4195EC+35Aj
		mov	eax, [ebp+var_50]
		lea	edx, [ebp+var_3C]
		mov	[esp+78h+Src], edx
		mov	[esp+78h+Dst], eax
		call	gcry_pk_get_keygrip
		test	eax, eax
		jnz	short loc_419974
		mov	[esp+78h+Dst], 3Fh
		call	sub_41954B
		mov	[ebp+var_1C], eax
		jmp	short loc_41998E
; ---------------------------------------------------------------------------

loc_419974:				; CODE XREF: sub_4195EC+375j
		mov	eax, [ebp+arg_8]
		mov	[esp+78h+Size],	eax
		mov	[esp+78h+Src], 14h
		lea	eax, [ebp+var_3C]
		mov	[esp+78h+Dst], eax
		call	sub_42BDA4

loc_41998E:				; CODE XREF: sub_4195EC+386j
		mov	eax, [ebp+var_50]
		mov	[esp+78h+Dst], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_1C]

loc_41999C:				; CODE XREF: sub_4195EC+50j
					; sub_4195EC+95j ...
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4195EC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4199A4	proc near		; CODE XREF: sub_419AE2+1A7p
					; sub_419AE2+1C8p ...

var_48		= byte ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= byte ptr -1Ch
var_1B		= byte ptr -1Bh
var_1A		= byte ptr -1Ah
var_19		= byte ptr -19h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+48h+var_48], eax
		call	sub_41C19D
		test	eax, eax
		jz	short loc_4199DE
		cmp	[ebp+arg_4], 0
		jz	short loc_4199D4
		mov	eax, 0FFFFFFFEh
		jmp	short loc_4199D9
; ---------------------------------------------------------------------------

loc_4199D4:				; CODE XREF: sub_4199A4+27j
		mov	eax, 0FFFFFFFFh

loc_4199D9:				; CODE XREF: sub_4199A4+2Ej
		jmp	locret_419AE0
; ---------------------------------------------------------------------------

loc_4199DE:				; CODE XREF: sub_4199A4+21j
		mov	[ebp+var_1C], 0
		mov	[ebp+var_1B], 20h
		mov	[ebp+var_1A], 0
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_19], al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_18]
		mov	[esp+48h+var_30], edx ;	int
		lea	edx, [ebp+var_14]
		mov	[esp+48h+var_34], edx ;	int
		mov	[esp+48h+var_38], 0 ; int
		mov	[esp+48h+var_3C], 4 ; size_t
		lea	edx, [ebp+var_1C]
		mov	[esp+48h+var_40], edx ;	void *
		mov	[esp+48h+var_44], 0 ; int
		mov	dword ptr [esp+48h+var_48], eax	; char
		call	sub_40C143
		test	eax, eax
		jz	short loc_419A3B
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_419AD2
; ---------------------------------------------------------------------------

loc_419A3B:				; CODE XREF: sub_4199A4+89j
		mov	eax, [ebp+var_18]
		cmp	eax, 1
		ja	short loc_419A4F
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_419AD2
; ---------------------------------------------------------------------------

loc_419A4F:				; CODE XREF: sub_4199A4+9Dj
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_18]
		sub	edx, 2
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	ecx, eax
		shl	ecx, 8
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_18]
		sub	edx, 1
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, ecx
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 6A88h
		jnz	short loc_419A8D
		mov	[ebp+var_C], 0FFFFFFFEh
		jmp	short loc_419AD2
; ---------------------------------------------------------------------------

loc_419A8D:				; CODE XREF: sub_4199A4+DEj
		cmp	[ebp+var_10], 6983h
		jnz	short loc_419A9F
		mov	[ebp+var_C], 0FFFFFFFDh
		jmp	short loc_419AD2
; ---------------------------------------------------------------------------

loc_419A9F:				; CODE XREF: sub_4199A4+F0j
		cmp	[ebp+var_10], 6985h
		jnz	short loc_419AB1
		mov	[ebp+var_C], 0FFFFFFFCh
		jmp	short loc_419AD2
; ---------------------------------------------------------------------------

loc_419AB1:				; CODE XREF: sub_4199A4+102j
		mov	eax, [ebp+var_10]
		and	eax, 0FFF0h
		cmp	eax, 63C0h
		jnz	short loc_419ACB
		mov	eax, [ebp+var_10]
		and	eax, 0Fh
		mov	[ebp+var_C], eax
		jmp	short loc_419AD2
; ---------------------------------------------------------------------------

loc_419ACB:				; CODE XREF: sub_4199A4+11Aj
		mov	[ebp+var_C], 0FFFFFFFFh

loc_419AD2:				; CODE XREF: sub_4199A4+92j
					; sub_4199A4+A6j ...
		mov	eax, [ebp+var_14]
		mov	dword ptr [esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_C]

locret_419AE0:				; CODE XREF: sub_4199A4:loc_4199D9j
		leave
		retn
sub_4199A4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_419AE2(int, int, char	*)
sub_419AE2	proc near		; DATA XREF: sub_41C3FB+F0o

Str1		= dword	ptr -0C8h
Str2		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_BC		= dword	ptr -0BCh
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_9C		= dword	ptr -9Ch
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_82		= dword	ptr -82h
var_7E		= dword	ptr -7Eh
var_7A		= dword	ptr -7Ah
var_76		= word ptr -76h
var_74		= byte ptr -74h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0C0h
		mov	[ebp+var_C], 0
		mov	[esp+0C8h+Str2], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+Str1], eax
		call	sub_41C19D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_419B18
		mov	eax, [ebp+var_C]
		jmp	loc_419DA8
; ---------------------------------------------------------------------------

loc_419B18:				; CODE XREF: sub_419AE2+2Cj
		mov	[ebp+var_10], 0
		jmp	short loc_419B25
; ---------------------------------------------------------------------------

loc_419B21:				; CODE XREF: sub_419AE2+6Cj
		add	[ebp+var_10], 1

loc_419B25:				; CODE XREF: sub_419AE2+3Dj
		mov	eax, [ebp+var_10]
		mov	eax, Str1[eax*8]
		test	eax, eax
		jz	short loc_419B50
		mov	eax, [ebp+var_10]
		mov	eax, Str1[eax*8]
		mov	edx, [ebp+arg_8]
		mov	[esp+0C8h+Str2], edx ; Str2
		mov	[esp+0C8h+Str1], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_419B21

loc_419B50:				; CODE XREF: sub_419AE2+4Fj
		mov	eax, [ebp+var_10]
		mov	eax, Str1[eax*8]
		test	eax, eax
		jnz	short loc_419B6F
		mov	[esp+0C8h+Str1], 58h
		call	sub_41954B
		jmp	loc_419DA8
; ---------------------------------------------------------------------------

loc_419B6F:				; CODE XREF: sub_419AE2+7Aj
		mov	eax, [ebp+var_10]
		mov	eax, dword_444AE4[eax*8]
		cmp	eax, 2
		jz	short loc_419BEE
		cmp	eax, 3
		jz	loc_419C73
		cmp	eax, 1
		jnz	loc_419D95
		mov	[ebp+var_82], 2D534B4Eh
		mov	[ebp+var_7E], 33534B4Eh
		mov	[ebp+var_7A], 3335342Eh
		mov	[ebp+var_76], 31h
		mov	eax, [ebp+var_10]
		mov	eax, Str1[eax*8]
		mov	[esp+0C8h+var_B4], 0
		mov	[esp+0C8h+var_B8], 0
		mov	[esp+0C8h+var_BC], 0Dh
		lea	edx, [ebp+var_82]
		mov	[esp+0C8h+var_C0], edx
		mov	[esp+0C8h+Str2], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Str1], eax
		call	sub_406FDB
		jmp	loc_419DA5
; ---------------------------------------------------------------------------

loc_419BEE:				; CODE XREF: sub_419AE2+9Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax]
		mov	[esp+0C8h+var_BC], eax
		mov	[esp+0C8h+var_C0], offset aD_3 ; "%d"
		mov	[esp+0C8h+Str2], 64h
		lea	eax, [ebp+var_74]
		mov	[esp+0C8h+Str1], eax
		call	sub_429C1D
		lea	eax, [ebp+var_74]
		mov	[ebp+var_9C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_9C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	eax, Str1[eax*8]
		mov	[esp+0C8h+var_B4], 0
		mov	[esp+0C8h+var_B8], 0
		mov	[esp+0C8h+var_BC], edx
		lea	edx, [ebp+var_74]
		mov	[esp+0C8h+var_C0], edx
		mov	[esp+0C8h+Str2], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Str1], eax
		call	sub_406FDB
		jmp	loc_419DA5
; ---------------------------------------------------------------------------

loc_419C73:				; CODE XREF: sub_419AE2+9Fj
		mov	[esp+0C8h+var_C0], 0
		mov	[esp+0C8h+Str2], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+Str1], eax
		call	sub_4199A4
		mov	[ebp+var_94], eax
		mov	[esp+0C8h+var_C0], 1
		mov	[esp+0C8h+Str2], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+Str1], eax
		call	sub_4199A4
		mov	[ebp+var_90], eax
		mov	[esp+0C8h+var_C0], 81h
		mov	[esp+0C8h+Str2], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+Str1], eax
		call	sub_4199A4
		mov	[ebp+var_8C], eax
		mov	[esp+0C8h+var_C0], 83h
		mov	[esp+0C8h+Str2], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+Str1], eax
		call	sub_4199A4
		mov	[ebp+var_88], eax
		mov	ebx, [ebp+var_88]
		mov	ecx, [ebp+var_8C]
		mov	edx, [ebp+var_90]
		mov	eax, [ebp+var_94]
		mov	[esp+0C8h+var_B0], ebx
		mov	[esp+0C8h+var_B4], ecx
		mov	[esp+0C8h+var_B8], edx
		mov	[esp+0C8h+var_BC], eax
		mov	[esp+0C8h+var_C0], offset aDDDD	; "%d %d %d %d"
		mov	[esp+0C8h+Str2], 64h
		lea	eax, [ebp+var_74]
		mov	[esp+0C8h+Str1], eax
		call	sub_429C1D
		lea	eax, [ebp+var_74]
		mov	[ebp+var_9C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_9C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	eax, Str1[eax*8]
		mov	[esp+0C8h+var_B4], 0
		mov	[esp+0C8h+var_B8], 0
		mov	[esp+0C8h+var_BC], edx
		lea	edx, [ebp+var_74]
		mov	[esp+0C8h+var_C0], edx
		mov	[esp+0C8h+Str2], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Str1], eax
		call	sub_406FDB
		jmp	short loc_419DA5
; ---------------------------------------------------------------------------

loc_419D95:				; CODE XREF: sub_419AE2+A8j
		mov	[esp+0C8h+Str1], 45h
		call	sub_41954B
		mov	[ebp+var_C], eax
		nop

loc_419DA5:				; CODE XREF: sub_419AE2+107j
					; sub_419AE2+18Cj ...
		mov	eax, [ebp+var_C]

loc_419DA8:				; CODE XREF: sub_419AE2+31j
					; sub_419AE2+88j
		add	esp, 0C0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_419AE2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_419DB2	proc near		; CODE XREF: sub_41A0C8+43p
					; sub_41A0C8+87p

var_148		= dword	ptr -148h
var_144		= byte ptr -144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_134		= dword	ptr -134h
var_130		= dword	ptr -130h
var_12C		= dword	ptr -12Ch
var_11C		= dword	ptr -11Ch
var_109		= byte ptr -109h
var_E0		= byte ptr -0E0h
var_7C		= byte ptr -7Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		cmp	[ebp+arg_C], 0
		jz	short loc_419DCC
		mov	[ebp+var_10], offset aSigg ; "SIGG"
		jmp	short loc_419DE9
; ---------------------------------------------------------------------------

loc_419DCC:				; CODE XREF: sub_419DB2+Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax]
		cmp	eax, 2
		jg	short loc_419DE2
		mov	[ebp+var_10], offset aDf01 ; "DF01"
		jmp	short loc_419DE9
; ---------------------------------------------------------------------------

loc_419DE2:				; CODE XREF: sub_419DB2+25j
		mov	[ebp+var_10], offset aNks3 ; "NKS3"

loc_419DE9:				; CODE XREF: sub_419DB2+18j
					; sub_419DB2+2Ej
		mov	[ebp+var_C], 0
		jmp	loc_41A0A8
; ---------------------------------------------------------------------------

loc_419DF5:				; CODE XREF: sub_419DB2+306j
		mov	eax, [ebp+var_C]
		shl	eax, 5
		add	eax, offset dword_4448C0
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax]
		cmp	edx, eax
		jg	loc_41A09D
		mov	eax, [ebp+var_C]
		shl	eax, 5
		add	eax, offset dword_4448C0
		mov	eax, [eax]
		test	eax, eax
		setnz	dl
		cmp	[ebp+arg_C], 0
		setnz	al
		xor	eax, edx
		test	al, al
		jnz	loc_41A0A0
		mov	eax, [ebp+var_C]
		shl	eax, 5
		add	eax, offset dword_4448C0
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_419F81
		mov	eax, [ebp+arg_8]
		and	eax, 1
		test	eax, eax
		jnz	loc_419F81
		mov	eax, [ebp+var_C]
		shl	eax, 5
		add	eax, offset dword_4448C0
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+148h+var_140], 0
		mov	dword ptr [esp+148h+var_144], edx
		mov	[esp+148h+var_148], eax
		call	sub_40FEE5
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	loc_41A0A3
		mov	eax, [ebp+var_C]
		shl	eax, 5
		add	eax, offset dword_4448C0
		mov	eax, [eax+0Ch]
		mov	[esp+148h+var_13C], eax
		mov	[esp+148h+var_140], offset aD_3	; "%d"
		mov	dword ptr [esp+148h+var_144], 64h
		lea	eax, [ebp+var_7C]
		mov	[esp+148h+var_148], eax
		call	sub_429C1D
		mov	eax, [ebp+var_C]
		shl	eax, 5
		add	eax, offset dword_4448C0
		mov	eax, [eax+4]
		mov	[esp+148h+var_138], eax
		mov	eax, [ebp+var_10]
		mov	[esp+148h+var_13C], eax
		mov	[esp+148h+var_140], offset aNksS_04x ; "NKS-%s.%04X"
		mov	dword ptr [esp+148h+var_144], 64h
		lea	eax, [ebp+var_E0]
		mov	[esp+148h+var_148], eax
		call	sub_429C1D
		lea	eax, [ebp+var_E0]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		lea	eax, [ebp+var_7C]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	[esp+148h+var_12C], 0
		mov	[esp+148h+var_130], 0
		mov	[esp+148h+var_134], ebx
		lea	eax, [ebp+var_E0]
		mov	[esp+148h+var_138], eax
		mov	[esp+148h+var_13C], edx
		lea	eax, [ebp+var_7C]
		mov	[esp+148h+var_140], eax
		mov	dword ptr [esp+148h+var_144], offset aCertinfo ; "CERTINFO"
		mov	eax, [ebp+arg_4]
		mov	[esp+148h+var_148], eax
		call	sub_406FDB
		jmp	loc_41A0A3
; ---------------------------------------------------------------------------

loc_419F81:				; CODE XREF: sub_419DB2+94j
					; sub_419DB2+A2j
		mov	eax, [ebp+var_C]
		shl	eax, 5
		add	eax, offset dword_4448D0
		mov	eax, [eax]
		test	eax, eax
		jz	loc_41A0A4
		mov	eax, [ebp+var_C]
		shl	eax, 5
		add	eax, offset dword_4448C0
		mov	eax, [eax+4]
		lea	edx, [ebp+var_109]
		mov	[esp+148h+var_140], edx
		mov	dword ptr [esp+148h+var_144], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+148h+var_148], eax
		call	sub_4195EC
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_419FF9
		mov	eax, [ebp+var_18]
		mov	[esp+148h+var_148], eax
		call	gpg_strerror
		mov	edx, [ebp+var_C]
		shl	edx, 5
		add	edx, offset dword_4448C0
		mov	edx, [edx+4]
		mov	[esp+148h+var_140], eax
		mov	dword ptr [esp+148h+var_144], edx ; char
		mov	[esp+148h+var_148], offset aCanTGetKeygrip ; "can't get keygrip from FID 0x%04X: %s\n"
		call	sub_43CB21
		jmp	loc_41A0A4
; ---------------------------------------------------------------------------

loc_419FF9:				; CODE XREF: sub_419DB2+212j
		mov	eax, [ebp+var_C]
		shl	eax, 5
		add	eax, offset dword_4448C0
		mov	eax, [eax+4]
		mov	[esp+148h+var_138], eax
		mov	eax, [ebp+var_10]
		mov	[esp+148h+var_13C], eax
		mov	[esp+148h+var_140], offset aNksS_04x ; "NKS-%s.%04X"
		mov	dword ptr [esp+148h+var_144], 64h
		lea	eax, [ebp+var_E0]
		mov	[esp+148h+var_148], eax
		call	sub_429C1D
		lea	eax, [ebp+var_E0]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+148h+var_12C], 0
		mov	[esp+148h+var_130], 0
		mov	[esp+148h+var_134], eax
		lea	eax, [ebp+var_E0]
		mov	[esp+148h+var_138], eax
		mov	[esp+148h+var_13C], 28h
		lea	eax, [ebp+var_109]
		mov	[esp+148h+var_140], eax
		mov	dword ptr [esp+148h+var_144], offset aKeypairinfo_1 ; "KEYPAIRINFO"
		mov	eax, [ebp+arg_4]
		mov	[esp+148h+var_148], eax
		call	sub_406FDB
		jmp	short loc_41A0A4
; ---------------------------------------------------------------------------

loc_41A09D:				; CODE XREF: sub_419DB2+5Bj
		nop
		jmp	short loc_41A0A4
; ---------------------------------------------------------------------------

loc_41A0A0:				; CODE XREF: sub_419DB2+7Ej
		nop
		jmp	short loc_41A0A4
; ---------------------------------------------------------------------------

loc_41A0A3:				; CODE XREF: sub_419DB2+D7j
					; sub_419DB2+1CAj
		nop

loc_41A0A4:				; CODE XREF: sub_419DB2+1DEj
					; sub_419DB2+242j ...
		add	[ebp+var_C], 1

loc_41A0A8:				; CODE XREF: sub_419DB2+3Ej
		mov	eax, [ebp+var_C]
		shl	eax, 5
		add	eax, offset dword_4448C0
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_419DF5
		add	esp, 140h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_419DB2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A0C8	proc near		; DATA XREF: sub_41C3FB+D2o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_24], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41C19D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41A0EF
		mov	eax, [ebp+var_C]
		jmp	short locret_41A159
; ---------------------------------------------------------------------------

loc_41A0EF:				; CODE XREF: sub_41A0C8+20j
		mov	[esp+28h+var_1C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_419DB2
		mov	[esp+28h+var_24], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41C19D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41A133
		mov	eax, 0
		jmp	short locret_41A159
; ---------------------------------------------------------------------------

loc_41A133:				; CODE XREF: sub_41A0C8+62j
		mov	[esp+28h+var_1C], 1
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_419DB2
		mov	eax, 0

locret_41A159:				; CODE XREF: sub_41A0C8+25j
					; sub_41A0C8+69j
		leave
		retn
sub_41A0C8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41A15B	proc near		; DATA XREF: sub_41C3FB+DCo

Dst		= dword	ptr -88h
Src		= dword	ptr -84h
Size		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		add	esp, 0FFFFFF80h
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aNksNks3_ ;	"NKS-NKS3."
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_41A215
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aNksDf01_ ;	"NKS-DF01."
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_41A215
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aNksSigg_ ;	"NKS-SIGG."
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_41A204
		mov	[ebp+var_20], 1
		jmp	short loc_41A215
; ---------------------------------------------------------------------------

loc_41A204:				; CODE XREF: sub_41A15B+9Ej
		mov	[esp+88h+Dst], 76h
		call	sub_41954B
		jmp	loc_41A8F0
; ---------------------------------------------------------------------------

loc_41A215:				; CODE XREF: sub_41A15B+4Ej
					; sub_41A15B+76j ...
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Src], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dst], eax
		call	sub_41C19D
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_41A238
		mov	eax, [ebp+var_14]
		jmp	loc_41A8F0
; ---------------------------------------------------------------------------

loc_41A238:				; CODE XREF: sub_41A15B+D3j
		add	[ebp+arg_4], 9
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41A250
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41A280

loc_41A250:				; CODE XREF: sub_41A15B+E9j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41A264
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41A280

loc_41A264:				; CODE XREF: sub_41A15B+FDj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	loc_41A37F
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	loc_41A37F

loc_41A280:				; CODE XREF: sub_41A15B+F3j
					; sub_41A15B+107j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41A29A
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41A2D6

loc_41A29A:				; CODE XREF: sub_41A15B+130j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41A2B4
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41A2D6

loc_41A2B4:				; CODE XREF: sub_41A15B+14Aj
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	loc_41A37F
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	loc_41A37F

loc_41A2D6:				; CODE XREF: sub_41A15B+13Dj
					; sub_41A15B+157j
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41A2F0
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41A324

loc_41A2F0:				; CODE XREF: sub_41A15B+186j
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41A30A
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41A324

loc_41A30A:				; CODE XREF: sub_41A15B+1A0j
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_41A37F
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_41A37F

loc_41A324:				; CODE XREF: sub_41A15B+193j
					; sub_41A15B+1ADj
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41A33E
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41A372

loc_41A33E:				; CODE XREF: sub_41A15B+1D4j
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41A358
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41A372

loc_41A358:				; CODE XREF: sub_41A15B+1EEj
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_41A37F
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_41A37F

loc_41A372:				; CODE XREF: sub_41A15B+1E1j
					; sub_41A15B+1FBj
		mov	eax, [ebp+arg_4]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41A390

loc_41A37F:				; CODE XREF: sub_41A15B+111j
					; sub_41A15B+11Fj ...
		mov	[esp+88h+Dst], 76h
		call	sub_41954B
		jmp	loc_41A8F0
; ---------------------------------------------------------------------------

loc_41A390:				; CODE XREF: sub_41A15B+222j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41A3AD
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_41A3D9
; ---------------------------------------------------------------------------

loc_41A3AD:				; CODE XREF: sub_41A15B+23Dj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41A3C8
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_41A3D7
; ---------------------------------------------------------------------------

loc_41A3C8:				; CODE XREF: sub_41A15B+25Aj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_41A3D7:				; CODE XREF: sub_41A15B+26Bj
		mov	edx, eax

loc_41A3D9:				; CODE XREF: sub_41A15B+250j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41A3F7
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		jmp	short loc_41A424
; ---------------------------------------------------------------------------

loc_41A3F7:				; CODE XREF: sub_41A15B+289j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41A415
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		jmp	short loc_41A424
; ---------------------------------------------------------------------------

loc_41A415:				; CODE XREF: sub_41A15B+2A7j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h

loc_41A424:				; CODE XREF: sub_41A15B+29Aj
					; sub_41A15B+2B8j
		add	eax, edx
		mov	ecx, eax
		shl	ecx, 8
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41A44E
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_41A483
; ---------------------------------------------------------------------------

loc_41A44E:				; CODE XREF: sub_41A15B+2DBj
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41A46F
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_41A481
; ---------------------------------------------------------------------------

loc_41A46F:				; CODE XREF: sub_41A15B+2FEj
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_41A481:				; CODE XREF: sub_41A15B+312j
		mov	edx, eax

loc_41A483:				; CODE XREF: sub_41A15B+2F1j
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41A4A1
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		jmp	short loc_41A4CE
; ---------------------------------------------------------------------------

loc_41A4A1:				; CODE XREF: sub_41A15B+333j
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41A4BF
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		jmp	short loc_41A4CE
; ---------------------------------------------------------------------------

loc_41A4BF:				; CODE XREF: sub_41A15B+351j
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h

loc_41A4CE:				; CODE XREF: sub_41A15B+344j
					; sub_41A15B+362j
		add	eax, edx
		add	eax, ecx
		mov	dword ptr [ebp+var_10],	eax
		mov	[ebp+var_C], 0
		jmp	short loc_41A518
; ---------------------------------------------------------------------------

loc_41A4DE:				; CODE XREF: sub_41A15B+3CDj
		mov	eax, [ebp+var_C]
		shl	eax, 5
		add	eax, offset dword_4448C0
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_41A501
		mov	eax, [ebp+var_C]
		shl	eax, 5
		add	eax, offset dword_4448D0
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_41A514

loc_41A501:				; CODE XREF: sub_41A15B+393j
		mov	eax, [ebp+var_C]
		shl	eax, 5
		add	eax, offset dword_4448C0
		mov	eax, [eax+4]
		cmp	eax, dword ptr [ebp+var_10]
		jz	short loc_41A52C

loc_41A514:				; CODE XREF: sub_41A15B+3A4j
		add	[ebp+var_C], 1

loc_41A518:				; CODE XREF: sub_41A15B+381j
		mov	eax, [ebp+var_C]
		shl	eax, 5
		add	eax, offset dword_4448C0
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_41A4DE
		jmp	short loc_41A52D
; ---------------------------------------------------------------------------

loc_41A52C:				; CODE XREF: sub_41A15B+3B7j
		nop

loc_41A52D:				; CODE XREF: sub_41A15B+3CFj
		mov	eax, [ebp+var_C]
		shl	eax, 5
		add	eax, offset dword_4448C0
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_41A550
		mov	[esp+88h+Dst], 1Bh
		call	sub_41954B
		jmp	loc_41A8F0
; ---------------------------------------------------------------------------

loc_41A550:				; CODE XREF: sub_41A15B+3E2j
		mov	eax, [ebp+var_C]
		shl	eax, 5
		add	eax, offset dword_4448D0
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_41A571
		mov	eax, [ebp+var_C]
		shl	eax, 5
		add	eax, offset dword_4448D0
		mov	eax, [eax]
		mov	dword ptr [ebp+var_10],	eax

loc_41A571:				; CODE XREF: sub_41A15B+404j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+88h+var_78], 0
		mov	[esp+88h+var_7C], 0
		mov	[esp+88h+Size],	0
		mov	edx, dword ptr [ebp+var_10]
		mov	[esp+88h+Src], edx
		mov	[esp+88h+Dst], eax
		call	sub_40CD52
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_41A5D1
		mov	eax, [ebp+var_14]
		mov	[esp+88h+Dst], eax
		call	gpg_strerror
		mov	[esp+88h+Size],	eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+88h+Src], eax ; char
		mov	[esp+88h+Dst], offset aErrorSelecti_0 ;	"error selecting FID 0x%04X: %s\n"
		call	sub_43CB21
		mov	eax, [ebp+var_14]
		jmp	loc_41A8F0
; ---------------------------------------------------------------------------

loc_41A5D1:				; CODE XREF: sub_41A15B+44Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_30]
		mov	[esp+88h+var_78], edx
		lea	edx, [ebp+var_28]
		mov	[esp+88h+var_7C], edx
		mov	[esp+88h+Size],	0
		mov	[esp+88h+Src], 0
		mov	[esp+88h+Dst], eax
		call	sub_40DC72
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_41A630
		mov	eax, [ebp+var_14]
		mov	[esp+88h+Dst], eax
		call	gpg_strerror
		mov	[esp+88h+Size],	eax
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+88h+Src], eax ; char
		mov	[esp+88h+Dst], offset aErrorReading_0 ;	"error reading certificate from	FID 0x%0"...
		call	sub_43CB21
		mov	eax, [ebp+var_14]
		jmp	loc_41A8F0
; ---------------------------------------------------------------------------

loc_41A630:				; CODE XREF: sub_41A15B+4A9j
		mov	eax, [ebp+var_30]
		test	eax, eax
		jz	short loc_41A641
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FFh
		jnz	short loc_41A668

loc_41A641:				; CODE XREF: sub_41A15B+4DAj
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+88h+Src], eax ; char
		mov	[esp+88h+Dst], offset aNoCertificat_0 ;	"no certificate	contained in FID 0x%04X\"...
		call	sub_43CAF7
		mov	[esp+88h+Dst], 1Bh
		call	sub_41954B
		mov	[ebp+var_14], eax
		jmp	loc_41A8E2
; ---------------------------------------------------------------------------

loc_41A668:				; CODE XREF: sub_41A15B+4E4j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_30]
		mov	[ebp+var_34], eax
		mov	[esp+88h+var_68], 6
		lea	eax, [ebp+var_4C]
		mov	[esp+88h+var_6C], eax
		lea	eax, [ebp+var_48]
		mov	[esp+88h+var_70], eax
		lea	eax, [ebp+var_44]
		mov	[esp+88h+var_74], eax
		lea	eax, [ebp+var_40]
		mov	[esp+88h+var_78], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+88h+var_7C], eax
		lea	eax, [ebp+var_38]
		mov	[esp+88h+Size],	eax
		lea	eax, [ebp+var_34]
		mov	[esp+88h+Src], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+88h+Dst], eax
		call	sub_42D42C
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	loc_41A8DB
		mov	eax, [ebp+var_38]
		test	eax, eax
		jnz	short loc_41A6DB
		mov	eax, [ebp+var_3C]
		cmp	eax, 10h
		jnz	short loc_41A6DB
		mov	eax, [ebp+var_40]
		test	eax, eax
		jnz	short loc_41A70B

loc_41A6DB:				; CODE XREF: sub_41A15B+56Fj
					; sub_41A15B+577j
		mov	eax, [ebp+var_38]
		test	eax, eax
		jnz	short loc_41A6FA
		mov	eax, [ebp+var_3C]
		cmp	eax, 11h
		jnz	short loc_41A6FA
		mov	eax, [ebp+var_40]
		test	eax, eax
		jz	short loc_41A6FA
		mov	[ebp+var_1C], 1
		jmp	short loc_41A70B
; ---------------------------------------------------------------------------

loc_41A6FA:				; CODE XREF: sub_41A15B+585j
					; sub_41A15B+58Dj ...
		mov	[esp+88h+Dst], 41h
		call	sub_41954B
		jmp	loc_41A8F0
; ---------------------------------------------------------------------------

loc_41A70B:				; CODE XREF: sub_41A15B+57Ej
					; sub_41A15B+59Dj
		mov	edx, [ebp+var_48]
		mov	eax, [ebp+var_4C]
		add	eax, edx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_30]
		cmp	[ebp+var_18], eax
		jbe	short loc_41A73A
		mov	[esp+88h+Size],	236h ; int
		mov	[esp+88h+Src], offset a____Gnupg22__3 ;	"../../gnupg2-2.0.30/scd/app-nks.c"
		mov	[esp+88h+Dst], offset aTotobjlenBufle ;	"totobjlen <= buflen"
		call	sub_442650

loc_41A73A:				; CODE XREF: sub_41A15B+5C1j
		mov	[esp+88h+var_68], 6
		lea	eax, [ebp+var_4C]
		mov	[esp+88h+var_6C], eax
		lea	eax, [ebp+var_48]
		mov	[esp+88h+var_70], eax
		lea	eax, [ebp+var_44]
		mov	[esp+88h+var_74], eax
		lea	eax, [ebp+var_40]
		mov	[esp+88h+var_78], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+88h+var_7C], eax
		lea	eax, [ebp+var_38]
		mov	[esp+88h+Size],	eax
		lea	eax, [ebp+var_34]
		mov	[esp+88h+Src], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+88h+Dst], eax
		call	sub_42D42C
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	loc_41A8DE
		cmp	[ebp+var_1C], 0
		jnz	loc_41A8C2
		mov	eax, [ebp+var_38]
		test	eax, eax
		jnz	loc_41A8C2
		mov	eax, [ebp+var_3C]
		cmp	eax, 6
		jnz	loc_41A8C2
		mov	eax, [ebp+var_40]
		test	eax, eax
		jnz	loc_41A8C2
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_48]
		cmp	edx, eax
		jnb	short loc_41A7D5
		mov	[esp+88h+Dst], 41h
		call	sub_41954B
		mov	[ebp+var_14], eax
		jmp	loc_41A8E2
; ---------------------------------------------------------------------------

loc_41A7D5:				; CODE XREF: sub_41A15B+664j
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_48]
		add	eax, edx
		mov	[ebp+var_2C], eax
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_48]
		mov	esi, edx
		sub	esi, eax
		mov	eax, esi
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_24], eax
		mov	[esp+88h+var_68], 6
		lea	eax, [ebp+var_4C]
		mov	[esp+88h+var_6C], eax
		lea	eax, [ebp+var_48]
		mov	[esp+88h+var_70], eax
		lea	eax, [ebp+var_44]
		mov	[esp+88h+var_74], eax
		lea	eax, [ebp+var_40]
		mov	[esp+88h+var_78], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+88h+var_7C], eax
		lea	eax, [ebp+var_38]
		mov	[esp+88h+Size],	eax
		lea	eax, [ebp+var_34]
		mov	[esp+88h+Src], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+88h+Dst], eax
		call	sub_42D42C
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	loc_41A8E1
		mov	eax, [ebp+var_38]
		test	eax, eax
		jnz	short loc_41A85C
		mov	eax, [ebp+var_3C]
		cmp	eax, 10h
		jnz	short loc_41A85C
		mov	eax, [ebp+var_40]
		test	eax, eax
		jnz	short loc_41A86D

loc_41A85C:				; CODE XREF: sub_41A15B+6F0j
					; sub_41A15B+6F8j
		mov	[esp+88h+Dst], 41h
		call	sub_41954B
		jmp	loc_41A8F0
; ---------------------------------------------------------------------------

loc_41A86D:				; CODE XREF: sub_41A15B+6FFj
		mov	edx, [ebp+var_48]
		mov	eax, [ebp+var_4C]
		add	eax, edx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_24]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_30]
		add	eax, edx
		cmp	ecx, eax
		jbe	short loc_41A8A9
		mov	[esp+88h+Size],	255h ; int
		mov	[esp+88h+Src], offset a____Gnupg22__3 ;	"../../gnupg2-2.0.30/scd/app-nks.c"
		mov	[esp+88h+Dst], offset aSave_pTotobjle ;	"save_p	+ totobjlen <= buffer +	buflen"
		call	sub_442650

loc_41A8A9:				; CODE XREF: sub_41A15B+730j
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_18]
		mov	[esp+88h+Size],	edx ; Size
		mov	edx, [ebp+var_24]
		mov	[esp+88h+Src], edx ; Src
		mov	[esp+88h+Dst], eax ; Dst
		call	memmove

loc_41A8C2:				; CODE XREF: sub_41A15B+634j
					; sub_41A15B+63Fj ...
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	[ebp+var_28], 0
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_18]
		mov	[eax], edx
		jmp	short loc_41A8E2
; ---------------------------------------------------------------------------

loc_41A8DB:				; CODE XREF: sub_41A15B+564j
		nop
		jmp	short loc_41A8E2
; ---------------------------------------------------------------------------

loc_41A8DE:				; CODE XREF: sub_41A15B+62Aj
		nop
		jmp	short loc_41A8E2
; ---------------------------------------------------------------------------

loc_41A8E1:				; CODE XREF: sub_41A15B+6E5j
		nop

loc_41A8E2:				; CODE XREF: sub_41A15B+508j
					; sub_41A15B+675j ...
		mov	eax, [ebp+var_28]
		mov	[esp+88h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+var_14]

loc_41A8F0:				; CODE XREF: sub_41A15B+B5j
					; sub_41A15B+D8j ...
		sub	esp, 0FFFFFF80h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_41A15B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41A8F7(int, char *, int, int)
sub_41A8F7	proc near		; CODE XREF: sub_41AAB8+75p
					; DATA XREF: sub_41C3FB+E6o

Str1		= dword	ptr -48h
Str2		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1E		= word ptr -1Eh
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 40h
		mov	[ebp+var_1E], 4500h
		mov	[esp+48h+Str2],	offset aIfdauthkey ; "$IFDAUTHKEY"
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41A929
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax]
		cmp	eax, 2
		jg	short loc_41A93A

loc_41A929:				; CODE XREF: sub_41A8F7+23j
		mov	[esp+48h+Str1],	7Ch
		call	sub_41954B
		jmp	loc_41AAB1
; ---------------------------------------------------------------------------

loc_41A93A:				; CODE XREF: sub_41A8F7+30j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+48h+var_38], 0
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], 1
		lea	edx, [ebp+var_1E]
		mov	[esp+48h+Str2],	edx
		mov	[esp+48h+Str1],	eax
		call	sub_40CE0F
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41A978
		mov	eax, [ebp+var_C]
		jmp	loc_41AAB1
; ---------------------------------------------------------------------------

loc_41A978:				; CODE XREF: sub_41A8F7+77j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	dword ptr [eax+10h], 1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_1C]
		mov	[esp+48h+var_34], edx
		lea	edx, [ebp+var_14]
		mov	[esp+48h+var_38], edx
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], 1
		mov	[esp+48h+Str2],	5
		mov	[esp+48h+Str1],	eax
		call	sub_40DF53
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41A9CA
		mov	eax, [ebp+var_C]
		jmp	loc_41AAB1
; ---------------------------------------------------------------------------

loc_41A9CA:				; CODE XREF: sub_41A8F7+C9j
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Str2],	edx
		mov	[esp+48h+Str1],	eax
		call	sub_4195B8
		test	eax, eax
		jz	short loc_41A9FC
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Str1],	eax
		call	gcry_free
		mov	[esp+48h+Str1],	1Bh
		call	sub_41954B
		jmp	loc_41AAB1
; ---------------------------------------------------------------------------

loc_41A9FC:				; CODE XREF: sub_41A8F7+E7j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_1C]
		add	edx, 4
		mov	[esp+48h+var_34], edx
		lea	edx, [ebp+var_14]
		add	edx, 4
		mov	[esp+48h+var_38], edx
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], 1
		mov	[esp+48h+Str2],	6
		mov	[esp+48h+Str1],	eax
		call	sub_40DF53
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41AA4F
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	short loc_41AAB1
; ---------------------------------------------------------------------------

loc_41AA4F:				; CODE XREF: sub_41A8F7+146j
		cmp	[ebp+arg_8], 0
		jz	short loc_41AA98
		cmp	[ebp+arg_C], 0
		jz	short loc_41AA98
		mov	ebx, [ebp+var_18]
		mov	ecx, [ebp+var_10]
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_14]
		mov	esi, [ebp+arg_C]
		mov	[esp+48h+var_38], esi ;	int
		mov	[esp+48h+var_3C], ebx ;	size_t
		mov	[esp+48h+var_40], ecx ;	int
		mov	[esp+48h+Str2],	edx ; size_t
		mov	[esp+48h+Str1],	eax ; int
		call	sub_42E296
		mov	edx, [ebp+arg_8]
		mov	[edx], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41AA98
		call	sub_419573
		mov	[ebp+var_C], eax

loc_41AA98:				; CODE XREF: sub_41A8F7+15Cj
					; sub_41A8F7+162j ...
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+var_C]

loc_41AAB1:				; CODE XREF: sub_41A8F7+3Ej
					; sub_41A8F7+7Cj ...
		add	esp, 40h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_41A8F7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41AAB8(int, int, char	*, int,	int, int, int, int)
sub_41AAB8	proc near		; DATA XREF: sub_41C3FB+104o

Str1		= dword	ptr -48h
Str2		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_C]
		and	eax, 1
		mov	[ebp+var_10], eax
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[esp+48h+Str2],	offset aIfdauthkey ; "$IFDAUTHKEY"
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41AAF9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax]
		cmp	eax, 2
		jg	short loc_41AB0A

loc_41AAF9:				; CODE XREF: sub_41AAB8+32j
		mov	[esp+48h+Str1],	76h
		call	sub_41954B
		jmp	locret_41AC30
; ---------------------------------------------------------------------------

loc_41AB0A:				; CODE XREF: sub_41AAB8+3Fj
		cmp	[ebp+var_10], 0
		jnz	short loc_41AB47
		mov	[esp+48h+var_3C], 0 ; int
		mov	[esp+48h+var_40], 0 ; int
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Str2],	eax ; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str1],	eax ; int
		call	sub_41A8F7
		test	eax, eax
		jnz	short loc_41AB47
		mov	[esp+48h+Str1],	8023h
		call	sub_41954B
		jmp	locret_41AC30
; ---------------------------------------------------------------------------

loc_41AB47:				; CODE XREF: sub_41AAB8+56j
					; sub_41AAB8+7Cj
		lea	eax, [ebp+var_24]
		mov	[esp+48h+var_34], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+var_38], eax
		lea	eax, [ebp+var_20]
		mov	[esp+48h+var_3C], eax
		lea	eax, [ebp+var_18]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_1C]
		mov	[esp+48h+Str2],	eax
		mov	eax, [ebp+arg_18]
		mov	[esp+48h+Str1],	eax
		call	sub_42E542
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_41AC2C
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Str2],	edx
		mov	[esp+48h+Str1],	eax
		call	sub_40FD6E
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 400h
		jz	short loc_41ABCD
		mov	[esp+48h+Str1],	offset aRsaModulusMi_0 ; "RSA modulus missing or not of	size %d	b"...
		call	sub_43C238
		mov	[esp+48h+Str2],	400h ; char
		mov	[esp+48h+Str1],	eax ; char *
		call	sub_43CB21
		mov	[esp+48h+Str1],	6
		call	sub_41954B
		mov	[ebp+var_C], eax
		jmp	short loc_41AC2D
; ---------------------------------------------------------------------------

loc_41ABCD:				; CODE XREF: sub_41AAB8+E6j
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Str2],	edx
		mov	[esp+48h+Str1],	eax
		call	sub_40FD6E
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 1
		jbe	short loc_41ABEE
		cmp	[ebp+var_14], 20h
		jbe	short loc_41AC1B

loc_41ABEE:				; CODE XREF: sub_41AAB8+12Ej
		mov	[esp+48h+Str1],	offset aRsaPublicExp_0 ; "RSA public exponent missing or larger	t"...
		call	sub_43C238
		mov	[esp+48h+Str2],	20h ; char
		mov	[esp+48h+Str1],	eax ; char *
		call	sub_43CB21
		mov	[esp+48h+Str1],	6
		call	sub_41954B
		mov	[ebp+var_C], eax
		jmp	short loc_41AC2D
; ---------------------------------------------------------------------------

loc_41AC1B:				; CODE XREF: sub_41AAB8+134j
		mov	[esp+48h+Str1],	45h
		call	sub_41954B
		mov	[ebp+var_C], eax
		jmp	short loc_41AC2D
; ---------------------------------------------------------------------------

loc_41AC2C:				; CODE XREF: sub_41AAB8+C4j
		nop

loc_41AC2D:				; CODE XREF: sub_41AAB8+113j
					; sub_41AAB8+161j ...
		mov	eax, [ebp+var_C]

locret_41AC30:				; CODE XREF: sub_41AAB8+4Dj
					; sub_41AAB8+8Aj
		leave
		retn
sub_41AAB8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41AC32	proc near		; CODE XREF: sub_41ACD2+15Bp
					; sub_41BC8F+242p ...

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, dword ptr [ebp+arg_4]
		cmp	edx, eax
		jnb	short loc_41AC80
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aPinIsTooShortM ; "PIN	is too short; minimum length is	%d\"...
		call	sub_43CB21
		mov	[esp+28h+var_28], 57h
		call	sub_41954B
		jmp	short loc_41ACCC
; ---------------------------------------------------------------------------

loc_41AC80:				; CODE XREF: sub_41AC32+2Bj
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, dword ptr [ebp+arg_8]
		cmp	edx, eax
		jbe	short loc_41ACC7
		mov	eax, dword ptr [ebp+arg_8]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aPinIsTooLargeM ; "PIN	is too large; maximum length is	%d\"...
		call	sub_43CB21
		mov	[esp+28h+var_28], 57h
		call	sub_41954B
		jmp	short loc_41ACCC
; ---------------------------------------------------------------------------

loc_41ACC7:				; CODE XREF: sub_41AC32+72j
		mov	eax, 0

loc_41ACCC:				; CODE XREF: sub_41AC32+4Cj
					; sub_41AC32+93j
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
sub_41AC32	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41ACD2	proc near		; CODE XREF: sub_41AEE6+6B1p
					; sub_41B5EF+4DDp ...

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		cmp	[ebp+arg_8], 0
		jnz	short loc_41ACE7
		mov	[ebp+arg_8], offset aPin ; "PIN"

loc_41ACE7:				; CODE XREF: sub_41ACD2+Cj
		lea	eax, [ebp+var_18]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+var_18], 0FFFFFFFFh
		mov	[ebp+var_14], 6
		mov	[ebp+var_10], 10h
		mov	eax, ds:dword_451D48
		test	eax, eax
		jnz	loc_41ADD4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_18]
		mov	[esp+48h+var_40], edx
		mov	dword ptr [esp+48h+var_44], 20h
		mov	[esp+48h+var_48], eax
		call	sub_40D0D7
		test	eax, eax
		jnz	loc_41ADD4
		mov	[esp+48h+var_40], 0
		mov	eax, [ebp+arg_8]
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+48h+var_48], eax
		mov	eax, [ebp+arg_C]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41AD95
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+48h+var_48], offset aPinCallbackR_0 ; "PIN	callback returned error: %s\n"
		call	sub_43C238
		mov	dword ptr [esp+48h+var_44], ebx	; char
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CAF7
		mov	eax, [ebp+var_C]
		jmp	loc_41AEDF
; ---------------------------------------------------------------------------

loc_41AD95:				; CODE XREF: sub_41ACD2+94j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_18]
		mov	[esp+48h+var_40], edx
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	sub_40D106
		mov	[ebp+var_C], eax
		mov	[esp+48h+var_40], 0
		mov	dword ptr [esp+48h+var_44], 0
		mov	eax, [ebp+arg_10]
		mov	[esp+48h+var_48], eax
		mov	eax, [ebp+arg_C]
		call	eax
		jmp	loc_41AE9B
; ---------------------------------------------------------------------------

loc_41ADD4:				; CODE XREF: sub_41ACD2+48j
					; sub_41ACD2+6Dj
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_8]
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+48h+var_48], eax
		mov	eax, [ebp+arg_C]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41AE19
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aPinCallbackR_0 ; "PIN	callback returned error: %s\n"
		call	sub_43CAF7
		mov	eax, [ebp+var_C]
		jmp	loc_41AEDF
; ---------------------------------------------------------------------------

loc_41AE19:				; CODE XREF: sub_41ACD2+122j
		mov	ecx, [ebp+var_10]
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], ecx
		mov	dword ptr [esp+48h+var_44], edx
		mov	[esp+48h+var_48], eax
		call	sub_41AC32
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41AE4E
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	loc_41AEDF
; ---------------------------------------------------------------------------

loc_41AE4E:				; CODE XREF: sub_41ACD2+167j
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ecx, [eax-1]
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+48h+var_3C], ecx ;	size_t
		mov	[esp+48h+var_40], edx ;	void *
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+48h+var_44], edx	; char
		mov	[esp+48h+var_48], eax ;	char
		call	sub_40D14D
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_free

loc_41AE9B:				; CODE XREF: sub_41ACD2+FDj
		cmp	[ebp+var_C], 0
		jz	short loc_41AEDA
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	sub_419566
		cmp	eax, 83h
		jnz	short loc_41AEC9
		mov	[esp+48h+var_48], offset aTheNullpinHasN ; "the	NullPIN	has not	yet been changed\n"
		call	sub_43C238
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_43CB21
		jmp	short loc_41AED5
; ---------------------------------------------------------------------------

loc_41AEC9:				; CODE XREF: sub_41ACD2+1DFj
		mov	[esp+48h+var_48], offset aVerifyPinFaile ; "verify PIN failed\n"
		call	sub_43CB21

loc_41AED5:				; CODE XREF: sub_41ACD2+1F5j
		mov	eax, [ebp+var_C]
		jmp	short loc_41AEDF
; ---------------------------------------------------------------------------

loc_41AEDA:				; CODE XREF: sub_41ACD2+1CDj
		mov	eax, 0

loc_41AEDF:				; CODE XREF: sub_41ACD2+BEj
					; sub_41ACD2+142j ...
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41ACD2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41AEE6(int, int, int,	int, int, void *Buf1, size_t, int, int)
sub_41AEE6	proc near		; DATA XREF: sub_41C3FB+118o

Dst		= dword	ptr -98h
Src		= dword	ptr -94h
Size		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_76		= byte ptr -76h
var_75		= byte ptr -75h
var_74		= byte ptr -74h
var_73		= byte ptr -73h
var_72		= byte ptr -72h
var_71		= byte ptr -71h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= word ptr -64h
var_62		= byte ptr -62h
var_1D		= byte ptr -1Dh
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
Buf1		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 90h
		mov	dword ptr [ebp+var_14],	0
		cmp	[ebp+arg_4], 0
		jz	short loc_41AF08
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41AF19

loc_41AF08:				; CODE XREF: sub_41AEE6+16j
		mov	[esp+98h+Dst], 37h
		call	sub_41954B
		jmp	loc_41B5E5
; ---------------------------------------------------------------------------

loc_41AF19:				; CODE XREF: sub_41AEE6+20j
		mov	eax, [ebp+arg_18]
		sub	eax, 10h	; switch 68 cases
		cmp	eax, 43h
		ja	short loc_41AF2D ; jumptable 0041AF2B default case
		mov	eax, ds:off_44B9AC[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41AF2D:				; CODE XREF: sub_41AEE6+3Cj
					; sub_41AEE6+45j
					; DATA XREF: ...
		mov	[esp+98h+Dst], 37h ; jumptable 0041AF2B	default	case
		call	sub_41954B
		jmp	loc_41B5E5
; ---------------------------------------------------------------------------

loc_41AF3E:				; CODE XREF: sub_41AEE6+45j
					; DATA XREF: .rdata:off_44B9ACo
		nop			; jumptable 0041AF2B cases 16,20,35,47,51,67,83
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aNksNks3_ ;	"NKS-NKS3."
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_41AFD1
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aNksDf01_ ;	"NKS-DF01."
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_41AFD1
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aNksSigg_ ;	"NKS-SIGG."
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_41AFC0
		mov	dword ptr [ebp+var_14],	1
		jmp	short loc_41AFD1
; ---------------------------------------------------------------------------

loc_41AFC0:				; CODE XREF: sub_41AEE6+CFj
		mov	[esp+98h+Dst], 76h
		call	sub_41954B
		jmp	loc_41B5E5
; ---------------------------------------------------------------------------

loc_41AFD1:				; CODE XREF: sub_41AEE6+7Fj
					; sub_41AEE6+A7j ...
		add	[ebp+arg_4], 9
		mov	eax, dword ptr [ebp+var_14]
		mov	[esp+98h+Src], eax ; char
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+Dst], eax
		call	sub_41C19D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41AFF8
		mov	eax, [ebp+var_C]
		jmp	loc_41B5E5
; ---------------------------------------------------------------------------

loc_41AFF8:				; CODE XREF: sub_41AEE6+108j
		cmp	dword ptr [ebp+var_14],	0
		jz	short loc_41B028
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_41B028
		mov	[esp+98h+Dst], offset aMassSignatureC ;	"mass signature	cards are not allowed\n"
		call	sub_43CAF7
		mov	[esp+98h+Dst], 3Ch
		call	sub_41954B
		jmp	loc_41B5E5
; ---------------------------------------------------------------------------

loc_41B028:				; CODE XREF: sub_41AEE6+116j
					; sub_41AEE6+123j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41B03C
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41B06C

loc_41B03C:				; CODE XREF: sub_41AEE6+14Aj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41B050
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41B06C

loc_41B050:				; CODE XREF: sub_41AEE6+15Ej
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	loc_41B16B
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	loc_41B16B

loc_41B06C:				; CODE XREF: sub_41AEE6+154j
					; sub_41AEE6+168j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41B086
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41B0C2

loc_41B086:				; CODE XREF: sub_41AEE6+191j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41B0A0
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41B0C2

loc_41B0A0:				; CODE XREF: sub_41AEE6+1ABj
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	loc_41B16B
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	loc_41B16B

loc_41B0C2:				; CODE XREF: sub_41AEE6+19Ej
					; sub_41AEE6+1B8j
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41B0DC
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41B110

loc_41B0DC:				; CODE XREF: sub_41AEE6+1E7j
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41B0F6
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41B110

loc_41B0F6:				; CODE XREF: sub_41AEE6+201j
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_41B16B
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_41B16B

loc_41B110:				; CODE XREF: sub_41AEE6+1F4j
					; sub_41AEE6+20Ej
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41B12A
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41B15E

loc_41B12A:				; CODE XREF: sub_41AEE6+235j
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41B144
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41B15E

loc_41B144:				; CODE XREF: sub_41AEE6+24Fj
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_41B16B
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_41B16B

loc_41B15E:				; CODE XREF: sub_41AEE6+242j
					; sub_41AEE6+25Cj
		mov	eax, [ebp+arg_4]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41B17C

loc_41B16B:				; CODE XREF: sub_41AEE6+172j
					; sub_41AEE6+180j ...
		mov	[esp+98h+Dst], 76h
		call	sub_41954B
		jmp	loc_41B5E5
; ---------------------------------------------------------------------------

loc_41B17C:				; CODE XREF: sub_41AEE6+283j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41B199
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_41B1C5
; ---------------------------------------------------------------------------

loc_41B199:				; CODE XREF: sub_41AEE6+29Ej
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41B1B4
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_41B1C3
; ---------------------------------------------------------------------------

loc_41B1B4:				; CODE XREF: sub_41AEE6+2BBj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_41B1C3:				; CODE XREF: sub_41AEE6+2CCj
		mov	edx, eax

loc_41B1C5:				; CODE XREF: sub_41AEE6+2B1j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41B1E3
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		jmp	short loc_41B210
; ---------------------------------------------------------------------------

loc_41B1E3:				; CODE XREF: sub_41AEE6+2EAj
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41B201
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		jmp	short loc_41B210
; ---------------------------------------------------------------------------

loc_41B201:				; CODE XREF: sub_41AEE6+308j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h

loc_41B210:				; CODE XREF: sub_41AEE6+2FBj
					; sub_41AEE6+319j
		add	eax, edx
		mov	ecx, eax
		shl	ecx, 8
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41B23A
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_41B26F
; ---------------------------------------------------------------------------

loc_41B23A:				; CODE XREF: sub_41AEE6+33Cj
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41B25B
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_41B26D
; ---------------------------------------------------------------------------

loc_41B25B:				; CODE XREF: sub_41AEE6+35Fj
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_41B26D:				; CODE XREF: sub_41AEE6+373j
		mov	edx, eax

loc_41B26F:				; CODE XREF: sub_41AEE6+352j
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41B28D
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		jmp	short loc_41B2BA
; ---------------------------------------------------------------------------

loc_41B28D:				; CODE XREF: sub_41AEE6+394j
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41B2AB
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		jmp	short loc_41B2BA
; ---------------------------------------------------------------------------

loc_41B2AB:				; CODE XREF: sub_41AEE6+3B2j
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h

loc_41B2BA:				; CODE XREF: sub_41AEE6+3A5j
					; sub_41AEE6+3C3j
		add	eax, edx
		add	eax, ecx
		mov	[ebp+var_1C], eax
		mov	[ebp+var_10], 0
		jmp	short loc_41B2F2
; ---------------------------------------------------------------------------

loc_41B2CA:				; CODE XREF: sub_41AEE6+41Cj
		mov	eax, [ebp+var_10]
		shl	eax, 5
		add	eax, offset dword_4448D0
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_41B2EE
		mov	eax, [ebp+var_10]
		shl	eax, 5
		add	eax, offset dword_4448C0
		mov	eax, [eax+4]
		cmp	eax, [ebp+var_1C]
		jz	short loc_41B306

loc_41B2EE:				; CODE XREF: sub_41AEE6+3F3j
		add	[ebp+var_10], 1

loc_41B2F2:				; CODE XREF: sub_41AEE6+3E2j
		mov	eax, [ebp+var_10]
		shl	eax, 5
		add	eax, offset dword_4448C0
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_41B2CA
		jmp	short loc_41B307
; ---------------------------------------------------------------------------

loc_41B306:				; CODE XREF: sub_41AEE6+406j
		nop

loc_41B307:				; CODE XREF: sub_41AEE6+41Ej
		mov	eax, [ebp+var_10]
		shl	eax, 5
		add	eax, offset dword_4448C0
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_41B32A
		mov	[esp+98h+Dst], 1Bh
		call	sub_41954B
		jmp	loc_41B5E5
; ---------------------------------------------------------------------------

loc_41B32A:				; CODE XREF: sub_41AEE6+431j
		mov	eax, [ebp+var_10]
		shl	eax, 5
		add	eax, offset dword_4448D0
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_41B34D
		mov	[esp+98h+Dst], 76h
		call	sub_41954B
		jmp	loc_41B5E5
; ---------------------------------------------------------------------------

loc_41B34D:				; CODE XREF: sub_41AEE6+454j
		mov	eax, [ebp+var_10]
		shl	eax, 5
		add	eax, offset dword_4448D0
		movzx	eax, byte ptr [eax+0Ch]
		mov	[ebp+var_1D], al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax]
		cmp	eax, 2
		jle	short loc_41B3D0
		cmp	[ebp+arg_18], 23h
		jz	short loc_41B38A
		cmp	[ebp+arg_18], 2Fh
		jz	short loc_41B38A
		cmp	[ebp+arg_18], 33h
		jz	short loc_41B38A
		cmp	[ebp+arg_18], 43h
		jz	short loc_41B38A
		cmp	[ebp+arg_18], 53h
		jnz	short loc_41B3D0

loc_41B38A:				; CODE XREF: sub_41AEE6+48Aj
					; sub_41AEE6+490j ...
		cmp	[ebp+arg_18], 53h
		jbe	short loc_41B3AC
		mov	[esp+98h+Size],	39Ah ; int
		mov	[esp+98h+Src], offset a____Gnupg22__3 ;	"../../gnupg2-2.0.30/scd/app-nks.c"
		mov	[esp+98h+Dst], offset aIndatalenSizeo ;	"indatalen <= sizeof data"
		call	sub_442650

loc_41B3AC:				; CODE XREF: sub_41AEE6+4A8j
		lea	eax, [ebp+var_70]
		mov	edx, [ebp+Buf1]
		mov	ecx, [ebp+arg_18]
		mov	[esp+98h+Size],	ecx ; Size
		mov	[esp+98h+Src], edx ; Src
		mov	[esp+98h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_18], eax
		jmp	loc_41B515
; ---------------------------------------------------------------------------

loc_41B3D0:				; CODE XREF: sub_41AEE6+484j
					; sub_41AEE6+4A2j
		cmp	[ebp+arg_18], 23h
		jnz	loc_41B45A
		cmp	[ebp+arg_8], 2
		jnz	short loc_41B3FF
		mov	[esp+98h+Size],	0Fh ; Size
		mov	[esp+98h+Src], offset dword_444AC0 ; Buf2
		mov	eax, [ebp+Buf1]
		mov	[esp+98h+Dst], eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_41B435

loc_41B3FF:				; CODE XREF: sub_41AEE6+4F8j
		cmp	[ebp+arg_8], 3
		jnz	short loc_41B424
		mov	[esp+98h+Size],	0Fh ; Size
		mov	[esp+98h+Src], offset dword_444ACF ; Buf2
		mov	eax, [ebp+Buf1]
		mov	[esp+98h+Dst], eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_41B435

loc_41B424:				; CODE XREF: sub_41AEE6+51Dj
		mov	[esp+98h+Dst], 54h
		call	sub_41954B
		jmp	loc_41B5E5
; ---------------------------------------------------------------------------

loc_41B435:				; CODE XREF: sub_41AEE6+517j
					; sub_41AEE6+53Cj
		lea	eax, [ebp+var_70]
		mov	edx, [ebp+Buf1]
		mov	ecx, [ebp+arg_18]
		mov	[esp+98h+Size],	ecx ; Size
		mov	[esp+98h+Src], edx ; Src
		mov	[esp+98h+Dst], eax ; Dst
		call	memcpy
		mov	[ebp+var_18], 23h
		jmp	loc_41B515
; ---------------------------------------------------------------------------

loc_41B45A:				; CODE XREF: sub_41AEE6+4EEj
		cmp	[ebp+arg_18], 14h
		jnz	loc_41B504
		cmp	[ebp+arg_8], 2
		jnz	short loc_41B499
		mov	eax, dword_444AC0
		mov	[ebp+var_70], eax
		mov	eax, dword_444AC4
		mov	[ebp+var_6C], eax
		mov	eax, dword_444AC8
		mov	[ebp+var_68], eax
		movzx	eax, word_444ACC
		mov	[ebp+var_64], ax
		movzx	eax, byte_444ACE
		mov	[ebp+var_62], al
		jmp	short loc_41B4DF
; ---------------------------------------------------------------------------

loc_41B499:				; CODE XREF: sub_41AEE6+582j
		cmp	[ebp+arg_8], 3
		jnz	short loc_41B4CE
		mov	eax, dword_444ACF
		mov	[ebp+var_70], eax
		mov	eax, dword_444AD3
		mov	[ebp+var_6C], eax
		mov	eax, dword_444AD7
		mov	[ebp+var_68], eax
		movzx	eax, word_444ADB
		mov	[ebp+var_64], ax
		movzx	eax, byte_444ADD
		mov	[ebp+var_62], al
		jmp	short loc_41B4DF
; ---------------------------------------------------------------------------

loc_41B4CE:				; CODE XREF: sub_41AEE6+5B7j
		mov	[esp+98h+Dst], 54h
		call	sub_41954B
		jmp	loc_41B5E5
; ---------------------------------------------------------------------------

loc_41B4DF:				; CODE XREF: sub_41AEE6+5B1j
					; sub_41AEE6+5E6j
		lea	eax, [ebp+var_70]
		add	eax, 0Fh
		mov	edx, [ebp+Buf1]
		mov	ecx, [ebp+arg_18]
		mov	[esp+98h+Size],	ecx ; Size
		mov	[esp+98h+Src], edx ; Src
		mov	[esp+98h+Dst], eax ; Dst
		call	memcpy
		mov	[ebp+var_18], 23h
		jmp	short loc_41B515
; ---------------------------------------------------------------------------

loc_41B504:				; CODE XREF: sub_41AEE6+578j
		mov	[esp+98h+Dst], 37h
		call	sub_41954B
		jmp	loc_41B5E5
; ---------------------------------------------------------------------------

loc_41B515:				; CODE XREF: sub_41AEE6+4E5j
					; sub_41AEE6+56Fj ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax]
		cmp	eax, 2
		jle	short loc_41B56D
		mov	[ebp+var_76], 80h
		mov	[ebp+var_75], 1
		mov	[ebp+var_74], 2
		mov	[ebp+var_73], 84h
		mov	[ebp+var_72], 1
		movzx	eax, [ebp+var_1D]
		mov	[ebp+var_71], al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+98h+var_88], 6 ; size_t
		lea	edx, [ebp+var_76]
		mov	[esp+98h+var_8C], edx ;	void *
		mov	[esp+98h+Size],	0B6h ; int
		mov	[esp+98h+Src], 41h ; int
		mov	[esp+98h+Dst], eax ; char
		call	sub_40D58E
		mov	[ebp+var_C], eax

loc_41B56D:				; CODE XREF: sub_41AEE6+63Aj
		cmp	[ebp+var_C], 0
		jnz	short loc_41B59F
		mov	eax, [ebp+arg_10]
		mov	[esp+98h+var_88], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+98h+var_8C], eax
		mov	[esp+98h+Size],	0
		mov	[esp+98h+Src], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+Dst], eax
		call	sub_41ACD2
		mov	[ebp+var_C], eax

loc_41B59F:				; CODE XREF: sub_41AEE6+68Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_41B5E2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_20]
		mov	[esp+98h+var_80], edx ;	int
		mov	edx, [ebp+arg_1C]
		mov	[esp+98h+var_84], edx ;	int
		mov	[esp+98h+var_88], 0 ; int
		mov	edx, [ebp+var_18]
		mov	[esp+98h+var_8C], edx ;	size_t
		lea	edx, [ebp+var_70]
		mov	[esp+98h+Size],	edx ; void *
		mov	[esp+98h+Src], 0 ; int
		mov	[esp+98h+Dst], eax ; char
		call	sub_40D61C
		mov	[ebp+var_C], eax

loc_41B5E2:				; CODE XREF: sub_41AEE6+6BDj
		mov	eax, [ebp+var_C]

loc_41B5E5:				; CODE XREF: sub_41AEE6+2Ej
					; sub_41AEE6+53j ...
		add	esp, 90h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_41AEE6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41B5EF(int, int, int,	int, void *, size_t, int, int)
sub_41B5EF	proc near		; DATA XREF: sub_41C3FB+12Co

var_48		= byte ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_22		= byte ptr -22h
var_21		= byte ptr -21h
var_20		= byte ptr -20h
var_1F		= byte ptr -1Fh
var_1E		= byte ptr -1Eh
var_1D		= byte ptr -1Dh
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 40h
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_41B614
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41B614
		cmp	[ebp+arg_14], 0
		jnz	short loc_41B625

loc_41B614:				; CODE XREF: sub_41B5EF+13j
					; sub_41B5EF+1Dj
		mov	dword ptr [esp+48h+var_48], 37h
		call	sub_41954B
		jmp	loc_41BB2F
; ---------------------------------------------------------------------------

loc_41B625:				; CODE XREF: sub_41B5EF+23j
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aNksNks3_ ;	"NKS-NKS3."
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_41B6B7
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aNksDf01_ ;	"NKS-DF01."
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_41B6B7
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aNksSigg_ ;	"NKS-SIGG."
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_41B6A6
		mov	[ebp+var_14], 1
		jmp	short loc_41B6B7
; ---------------------------------------------------------------------------

loc_41B6A6:				; CODE XREF: sub_41B5EF+ACj
		mov	dword ptr [esp+48h+var_48], 76h
		call	sub_41954B
		jmp	loc_41BB2F
; ---------------------------------------------------------------------------

loc_41B6B7:				; CODE XREF: sub_41B5EF+5Cj
					; sub_41B5EF+84j ...
		add	[ebp+arg_4], 9
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+48h+var_48], eax
		call	sub_41C19D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41B6DE
		mov	eax, [ebp+var_C]
		jmp	loc_41BB2F
; ---------------------------------------------------------------------------

loc_41B6DE:				; CODE XREF: sub_41B5EF+E5j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41B6F2
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41B722

loc_41B6F2:				; CODE XREF: sub_41B5EF+F7j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41B706
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41B722

loc_41B706:				; CODE XREF: sub_41B5EF+10Bj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	loc_41B821
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	loc_41B821

loc_41B722:				; CODE XREF: sub_41B5EF+101j
					; sub_41B5EF+115j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41B73C
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41B778

loc_41B73C:				; CODE XREF: sub_41B5EF+13Ej
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41B756
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41B778

loc_41B756:				; CODE XREF: sub_41B5EF+158j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	loc_41B821
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	loc_41B821

loc_41B778:				; CODE XREF: sub_41B5EF+14Bj
					; sub_41B5EF+165j
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41B792
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41B7C6

loc_41B792:				; CODE XREF: sub_41B5EF+194j
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41B7AC
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41B7C6

loc_41B7AC:				; CODE XREF: sub_41B5EF+1AEj
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_41B821
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_41B821

loc_41B7C6:				; CODE XREF: sub_41B5EF+1A1j
					; sub_41B5EF+1BBj
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41B7E0
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41B814

loc_41B7E0:				; CODE XREF: sub_41B5EF+1E2j
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41B7FA
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41B814

loc_41B7FA:				; CODE XREF: sub_41B5EF+1FCj
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_41B821
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_41B821

loc_41B814:				; CODE XREF: sub_41B5EF+1EFj
					; sub_41B5EF+209j
		mov	eax, [ebp+arg_4]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41B832

loc_41B821:				; CODE XREF: sub_41B5EF+11Fj
					; sub_41B5EF+12Dj ...
		mov	dword ptr [esp+48h+var_48], 76h
		call	sub_41954B
		jmp	loc_41BB2F
; ---------------------------------------------------------------------------

loc_41B832:				; CODE XREF: sub_41B5EF+230j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41B84F
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_41B87B
; ---------------------------------------------------------------------------

loc_41B84F:				; CODE XREF: sub_41B5EF+24Bj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41B86A
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_41B879
; ---------------------------------------------------------------------------

loc_41B86A:				; CODE XREF: sub_41B5EF+268j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_41B879:				; CODE XREF: sub_41B5EF+279j
		mov	edx, eax

loc_41B87B:				; CODE XREF: sub_41B5EF+25Ej
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41B899
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		jmp	short loc_41B8C6
; ---------------------------------------------------------------------------

loc_41B899:				; CODE XREF: sub_41B5EF+297j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41B8B7
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		jmp	short loc_41B8C6
; ---------------------------------------------------------------------------

loc_41B8B7:				; CODE XREF: sub_41B5EF+2B5j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h

loc_41B8C6:				; CODE XREF: sub_41B5EF+2A8j
					; sub_41B5EF+2C6j
		add	eax, edx
		mov	ecx, eax
		shl	ecx, 8
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41B8F0
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_41B925
; ---------------------------------------------------------------------------

loc_41B8F0:				; CODE XREF: sub_41B5EF+2E9j
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41B911
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_41B923
; ---------------------------------------------------------------------------

loc_41B911:				; CODE XREF: sub_41B5EF+30Cj
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_41B923:				; CODE XREF: sub_41B5EF+320j
		mov	edx, eax

loc_41B925:				; CODE XREF: sub_41B5EF+2FFj
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41B943
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		jmp	short loc_41B970
; ---------------------------------------------------------------------------

loc_41B943:				; CODE XREF: sub_41B5EF+341j
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41B961
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		jmp	short loc_41B970
; ---------------------------------------------------------------------------

loc_41B961:				; CODE XREF: sub_41B5EF+35Fj
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h

loc_41B970:				; CODE XREF: sub_41B5EF+352j
					; sub_41B5EF+370j
		add	eax, edx
		add	eax, ecx
		mov	[ebp+var_18], eax
		mov	[ebp+var_10], 0
		jmp	short loc_41B9A8
; ---------------------------------------------------------------------------

loc_41B980:				; CODE XREF: sub_41B5EF+3C9j
		mov	eax, [ebp+var_10]
		shl	eax, 5
		add	eax, offset dword_4448D0
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_41B9A4
		mov	eax, [ebp+var_10]
		shl	eax, 5
		add	eax, offset dword_4448C0
		mov	eax, [eax+4]
		cmp	eax, [ebp+var_18]
		jz	short loc_41B9BC

loc_41B9A4:				; CODE XREF: sub_41B5EF+3A0j
		add	[ebp+var_10], 1

loc_41B9A8:				; CODE XREF: sub_41B5EF+38Fj
		mov	eax, [ebp+var_10]
		shl	eax, 5
		add	eax, offset dword_4448C0
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_41B980
		jmp	short loc_41B9BD
; ---------------------------------------------------------------------------

loc_41B9BC:				; CODE XREF: sub_41B5EF+3B3j
		nop

loc_41B9BD:				; CODE XREF: sub_41B5EF+3CBj
		mov	eax, [ebp+var_10]
		shl	eax, 5
		add	eax, offset dword_4448C0
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_41B9E0
		mov	dword ptr [esp+48h+var_48], 1Bh
		call	sub_41954B
		jmp	loc_41BB2F
; ---------------------------------------------------------------------------

loc_41B9E0:				; CODE XREF: sub_41B5EF+3DEj
		mov	eax, [ebp+var_10]
		shl	eax, 5
		add	eax, offset dword_4448D0
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_41BA03
		mov	dword ptr [esp+48h+var_48], 76h
		call	sub_41954B
		jmp	loc_41BB2F
; ---------------------------------------------------------------------------

loc_41BA03:				; CODE XREF: sub_41B5EF+401j
		mov	eax, [ebp+var_10]
		shl	eax, 5
		add	eax, offset dword_4448D0
		movzx	eax, byte ptr [eax+0Ch]
		movzx	eax, al
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax]
		cmp	eax, 2
		jle	short loc_41BA71
		mov	[ebp+var_22], 80h
		mov	[ebp+var_21], 1
		mov	[ebp+var_20], 0Ah
		mov	[ebp+var_1F], 84h
		mov	[ebp+var_1E], 1
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_1D], al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+48h+var_38], 6 ; size_t
		lea	edx, [ebp+var_22]
		mov	[esp+48h+var_3C], edx ;	void *
		mov	[esp+48h+var_40], 0B8h ; int
		mov	[esp+48h+var_44], 41h ;	int
		mov	dword ptr [esp+48h+var_48], eax	; char
		call	sub_40D58E
		mov	[ebp+var_C], eax
		jmp	short loc_41BAA2
; ---------------------------------------------------------------------------

loc_41BA71:				; CODE XREF: sub_41B5EF+434j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+48h+var_38], 6 ; size_t
		mov	[esp+48h+var_3C], offset word_44BDE6 ; void *
		mov	[esp+48h+var_40], 0B8h ; int
		mov	[esp+48h+var_44], 0C1h ; int
		mov	dword ptr [esp+48h+var_48], eax	; char
		call	sub_40D58E
		mov	[ebp+var_C], eax

loc_41BAA2:				; CODE XREF: sub_41B5EF+480j
		cmp	[ebp+var_C], 0
		jnz	short loc_41BAD4
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+var_44], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+48h+var_48], eax
		call	sub_41ACD2
		mov	[ebp+var_C], eax

loc_41BAD4:				; CODE XREF: sub_41B5EF+4B7j
		cmp	[ebp+var_C], 0
		jnz	short loc_41BB2C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax]
		cmp	eax, 2
		setnle	al
		movzx	edx, al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	ecx, [ebp+arg_1C]
		mov	[esp+48h+var_2C], ecx ;	int
		mov	ecx, [ebp+arg_18]
		mov	[esp+48h+var_30], ecx ;	int
		mov	[esp+48h+var_34], 81h ;	int
		mov	[esp+48h+var_38], 0 ; int
		mov	ecx, [ebp+arg_14]
		mov	[esp+48h+var_3C], ecx ;	size_t
		mov	ecx, [ebp+arg_10]
		mov	[esp+48h+var_40], ecx ;	void *
		mov	[esp+48h+var_44], edx ;	int
		mov	dword ptr [esp+48h+var_48], eax	; char
		call	sub_40D716
		mov	[ebp+var_C], eax

loc_41BB2C:				; CODE XREF: sub_41B5EF+4E9j
		mov	eax, [ebp+var_C]

loc_41BB2F:				; CODE XREF: sub_41B5EF+31j
					; sub_41B5EF+C3j ...
		add	esp, 40h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_41B5EF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41BB36(char *, int, int, int)
sub_41BB36	proc near		; CODE XREF: sub_41BC8F+5Bp
					; sub_41BC8F+19Cp ...

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_41BB4E
		mov	[ebp+var_C], 0
		jmp	loc_41BC8A
; ---------------------------------------------------------------------------

loc_41BB4E:				; CODE XREF: sub_41BB36+Aj
		mov	[esp+28h+Str2],	offset aPw1_ch ; "PW1.CH"
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41BB9F
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_41BB8B
		mov	[esp+28h+Str1],	offset aNPleaseEnterAN ; "|N|Please enter a new	PIN for	the stand"...
		call	sub_43C238
		jmp	short loc_41BB97
; ---------------------------------------------------------------------------

loc_41BB8B:				; CODE XREF: sub_41BB36+45j
		mov	[esp+28h+Str1],	offset aPleaseEnterT_4 ; "||Please enter the PIN for the standard"...
		call	sub_43C238

loc_41BB97:				; CODE XREF: sub_41BB36+53j
		mov	[ebp+var_C], eax
		jmp	loc_41BC8A
; ---------------------------------------------------------------------------

loc_41BB9F:				; CODE XREF: sub_41BB36+2Dj
		mov	[esp+28h+Str2],	offset aPw2_ch ; "PW2.CH"
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41BBE7
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 1
		cmp	[ebp+arg_4], 0
		jz	short loc_41BBD3
		mov	[esp+28h+Str1],	offset aNpPleaseEnterA ; "|NP|Please enter a new PIN Unblocking	C"...
		call	sub_43C238
		jmp	short loc_41BBDF
; ---------------------------------------------------------------------------

loc_41BBD3:				; CODE XREF: sub_41BB36+8Dj
		mov	[esp+28h+Str1],	offset aPPleaseEnterTh ; "|P|Please enter the PIN Unblocking Code"...
		call	sub_43C238

loc_41BBDF:				; CODE XREF: sub_41BB36+9Bj
		mov	[ebp+var_C], eax
		jmp	loc_41BC8A
; ---------------------------------------------------------------------------

loc_41BBE7:				; CODE XREF: sub_41BB36+7Ej
		mov	[esp+28h+Str2],	offset aPw1_ch_sig ; "PW1.CH.SIG"
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41BC35
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 81h
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 1
		cmp	[ebp+arg_4], 0
		jz	short loc_41BC24
		mov	[esp+28h+Str1],	offset aNPleaseEnter_0 ; "|N|Please enter a new	PIN for	the key	t"...
		call	sub_43C238
		jmp	short loc_41BC30
; ---------------------------------------------------------------------------

loc_41BC24:				; CODE XREF: sub_41BB36+DEj
		mov	[esp+28h+Str1],	offset aPleaseEnterT_5 ; "||Please enter the PIN for the key to	c"...
		call	sub_43C238

loc_41BC30:				; CODE XREF: sub_41BB36+ECj
		mov	[ebp+var_C], eax
		jmp	short loc_41BC8A
; ---------------------------------------------------------------------------

loc_41BC35:				; CODE XREF: sub_41BB36+C6j
		mov	[esp+28h+Str2],	offset aPw2_ch_sig ; "PW2.CH.SIG"
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41BC83
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 83h
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 1
		cmp	[ebp+arg_4], 0
		jz	short loc_41BC72
		mov	[esp+28h+Str1],	offset aNpPleaseEnte_0 ; "|NP|Please enter a new PIN Unblocking	C"...
		call	sub_43C238
		jmp	short loc_41BC7E
; ---------------------------------------------------------------------------

loc_41BC72:				; CODE XREF: sub_41BB36+12Cj
		mov	[esp+28h+Str1],	offset aPPleaseEnter_0 ; "|P|Please enter the PIN Unblocking Code"...
		call	sub_43C238

loc_41BC7E:				; CODE XREF: sub_41BB36+13Aj
		mov	[ebp+var_C], eax
		jmp	short loc_41BC8A
; ---------------------------------------------------------------------------

loc_41BC83:				; CODE XREF: sub_41BB36+114j
		mov	[ebp+var_C], 0

loc_41BC8A:				; CODE XREF: sub_41BB36+13j
					; sub_41BB36+64j ...
		mov	eax, [ebp+var_C]
		leave
		retn
sub_41BB36	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41BC8F(int, int, char	*, int,	int, int)
sub_41BC8F	proc near		; DATA XREF: sub_41C3FB+136o

Str1		= dword	ptr -98h
Str2		= dword	ptr -94h
Size		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_6C		= dword	ptr -6Ch
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= byte ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
Src		= dword	ptr -48h
var_44		= dword	ptr -44h
Dst		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 8Ch
		mov	[ebp+var_44], 0
		mov	[ebp+Src], 0
		lea	eax, [ebp+var_5C]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+var_58], 6
		mov	[ebp+var_54], 10h
		lea	eax, [ebp+var_50]
		mov	[esp+98h+var_8C], eax ;	int
		lea	eax, [ebp+var_4C]
		mov	[esp+98h+Size],	eax ; int
		mov	[esp+98h+Str2],	1 ; int
		mov	eax, [ebp+arg_8]
		mov	[esp+98h+Str1],	eax ; char *
		call	sub_41BB36
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jnz	short loc_41BD09
		mov	[esp+98h+Str1],	76h
		call	sub_41954B
		jmp	loc_41C092
; ---------------------------------------------------------------------------

loc_41BD09:				; CODE XREF: sub_41BC8F+67j
		mov	eax, [ebp+var_4C]
		mov	[esp+98h+Str2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+Str1],	eax
		call	sub_41C19D
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_41BD2C
		mov	eax, [ebp+var_1C]
		jmp	loc_41C092
; ---------------------------------------------------------------------------

loc_41BD2C:				; CODE XREF: sub_41BC8F+93j
		mov	eax, [ebp+arg_C]
		and	eax, 2
		test	eax, eax
		jz	short loc_41BD6D
		mov	[esp+98h+Str2],	6
		mov	[esp+98h+Str1],	1
		call	gcry_calloc
		mov	[ebp+Src], eax
		mov	eax, [ebp+Src]
		test	eax, eax
		jnz	short loc_41BD61
		call	sub_419573
		mov	[ebp+var_1C], eax
		jmp	loc_41C079
; ---------------------------------------------------------------------------

loc_41BD61:				; CODE XREF: sub_41BC8F+C3j
		mov	[ebp+var_20], 6
		jmp	loc_41BEE3
; ---------------------------------------------------------------------------

loc_41BD6D:				; CODE XREF: sub_41BC8F+A5j
		mov	eax, [ebp+arg_C]
		and	eax, 1
		test	al, al
		jz	loc_41BE35
		mov	[esp+98h+Str2],	offset aPw1_ch ; "PW1.CH"
		mov	eax, [ebp+arg_8]
		mov	[esp+98h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41BD9B
		mov	[ebp+var_28], offset aPw2_ch ; "PW2.CH"
		jmp	short loc_41BE0F
; ---------------------------------------------------------------------------

loc_41BD9B:				; CODE XREF: sub_41BC8F+101j
		mov	[esp+98h+Str2],	offset aPw2_ch ; "PW2.CH"
		mov	eax, [ebp+arg_8]
		mov	[esp+98h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41BDBB
		mov	[ebp+var_28], offset aPw1_ch ; "PW1.CH"
		jmp	short loc_41BE0F
; ---------------------------------------------------------------------------

loc_41BDBB:				; CODE XREF: sub_41BC8F+121j
		mov	[esp+98h+Str2],	offset aPw1_ch_sig ; "PW1.CH.SIG"
		mov	eax, [ebp+arg_8]
		mov	[esp+98h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41BDDB
		mov	[ebp+var_28], offset aPw2_ch_sig ; "PW2.CH.SIG"
		jmp	short loc_41BE0F
; ---------------------------------------------------------------------------

loc_41BDDB:				; CODE XREF: sub_41BC8F+141j
		mov	[esp+98h+Str2],	offset aPw2_ch_sig ; "PW2.CH.SIG"
		mov	eax, [ebp+arg_8]
		mov	[esp+98h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_41BDFB
		mov	[ebp+var_28], offset aPw1_ch_sig ; "PW1.CH.SIG"
		jmp	short loc_41BE0F
; ---------------------------------------------------------------------------

loc_41BDFB:				; CODE XREF: sub_41BC8F+161j
		mov	[esp+98h+Str1],	3Bh
		call	sub_41954B
		mov	[ebp+var_1C], eax
		jmp	loc_41C079
; ---------------------------------------------------------------------------

loc_41BE0F:				; CODE XREF: sub_41BC8F+10Aj
					; sub_41BC8F+12Aj ...
		lea	eax, [ebp+var_64]
		mov	[esp+98h+var_8C], eax ;	int
		lea	eax, [ebp+var_60]
		mov	[esp+98h+Size],	eax ; int
		mov	[esp+98h+Str2],	0 ; int
		mov	eax, [ebp+var_28]
		mov	[esp+98h+Str1],	eax ; char *
		call	sub_41BB36
		mov	[ebp+var_24], eax
		jmp	short loc_41BE59
; ---------------------------------------------------------------------------

loc_41BE35:				; CODE XREF: sub_41BC8F+E6j
		lea	eax, [ebp+var_64]
		mov	[esp+98h+var_8C], eax ;	int
		lea	eax, [ebp+var_60]
		mov	[esp+98h+Size],	eax ; int
		mov	[esp+98h+Str2],	0 ; int
		mov	eax, [ebp+arg_8]
		mov	[esp+98h+Str1],	eax ; char *
		call	sub_41BB36
		mov	[ebp+var_24], eax

loc_41BE59:				; CODE XREF: sub_41BC8F+1A4j
		lea	eax, [ebp+Src]
		mov	[esp+98h+Size],	eax
		mov	eax, [ebp+var_24]
		mov	[esp+98h+Str2],	eax
		mov	eax, [ebp+arg_14]
		mov	[esp+98h+Str1],	eax
		mov	eax, [ebp+arg_10]
		call	eax
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_41BE9B
		mov	eax, [ebp+var_1C]
		mov	[esp+98h+Str1],	eax
		call	gpg_strerror
		mov	[esp+98h+Str2],	eax ; char
		mov	[esp+98h+Str1],	offset aErrorGettingOl ; "error	getting	old PIN: %s\n"
		call	sub_43CB21
		jmp	loc_41C079
; ---------------------------------------------------------------------------

loc_41BE9B:				; CODE XREF: sub_41BC8F+1EAj
		mov	eax, [ebp+Src]
		mov	[ebp+var_6C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_6C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_20], eax
		mov	ecx, [ebp+var_54]
		mov	edx, [ebp+var_58]
		mov	eax, [ebp+Src]
		mov	[esp+98h+Size],	ecx
		mov	[esp+98h+Str2],	edx
		mov	[esp+98h+Str1],	eax
		call	sub_41AC32
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_41C075

loc_41BEE3:				; CODE XREF: sub_41BC8F+D9j
		lea	eax, [ebp+var_44]
		mov	[esp+98h+Size],	eax
		mov	eax, [ebp+var_34]
		mov	[esp+98h+Str2],	eax
		mov	eax, [ebp+arg_14]
		mov	[esp+98h+Str1],	eax
		mov	eax, [ebp+arg_10]
		call	eax
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_41BF2F
		mov	eax, [ebp+var_1C]
		mov	[esp+98h+Str1],	eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+98h+Str1],	offset aErrorGetting_0 ; "error	getting	new PIN: %s\n"
		call	sub_43C238
		mov	[esp+98h+Str2],	ebx ; char
		mov	[esp+98h+Str1],	eax ; char *
		call	sub_43CB21
		jmp	loc_41C079
; ---------------------------------------------------------------------------

loc_41BF2F:				; CODE XREF: sub_41BC8F+274j
		mov	eax, [ebp+var_44]
		mov	[ebp+var_6C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_6C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_38], eax
		mov	ecx, [ebp+var_54]
		mov	edx, [ebp+var_58]
		mov	eax, [ebp+var_44]
		mov	[esp+98h+Size],	ecx
		mov	[esp+98h+Str2],	edx
		mov	[esp+98h+Str1],	eax
		call	sub_41AC32
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_41C078
		mov	eax, [ebp+arg_C]
		and	eax, 1
		test	al, al
		jz	loc_41C03F
		mov	eax, [ebp+var_38]
		mov	edx, [ebp+var_20]
		add	eax, edx
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		mov	[esp+98h+Str1],	eax
		call	gcry_malloc
		mov	[ebp+Dst], eax
		cmp	[ebp+Dst], 0
		jnz	short loc_41BFB1
		call	sub_419573
		mov	[ebp+var_1C], eax
		jmp	loc_41C079
; ---------------------------------------------------------------------------

loc_41BFB1:				; CODE XREF: sub_41BC8F+313j
		mov	eax, [ebp+Src]
		mov	edx, eax
		mov	eax, [ebp+Dst]
		mov	ecx, [ebp+var_20]
		mov	[esp+98h+Size],	ecx ; Size
		mov	[esp+98h+Str2],	edx ; Src
		mov	[esp+98h+Str1],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_44]
		mov	edx, eax
		mov	eax, [ebp+Dst]
		add	eax, [ebp+var_20]
		mov	ecx, [ebp+var_38]
		mov	[esp+98h+Size],	ecx ; Size
		mov	[esp+98h+Str2],	edx ; Src
		mov	[esp+98h+Str1],	eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_50]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	ecx, [ebp+var_3C]
		mov	[esp+98h+var_8C], ecx ;	size_t
		mov	ecx, [ebp+Dst]
		mov	[esp+98h+Size],	ecx ; void *
		mov	[esp+98h+Str2],	edx ; int
		mov	[esp+98h+Str1],	eax ; char
		call	sub_40D305
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+Dst]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_30], eax
		jmp	short loc_41C02C
; ---------------------------------------------------------------------------

loc_41C01E:				; CODE XREF: sub_41BC8F+3A1j
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	0
		add	[ebp+var_2C], 1
		sub	[ebp+var_30], 1

loc_41C02C:				; CODE XREF: sub_41BC8F+38Dj
		cmp	[ebp+var_30], 0
		jnz	short loc_41C01E
		mov	eax, [ebp+Dst]
		mov	[esp+98h+Str1],	eax
		call	gcry_free
		jmp	short loc_41C079
; ---------------------------------------------------------------------------

loc_41C03F:				; CODE XREF: sub_41BC8F+2F0j
		mov	ebx, [ebp+var_44]
		mov	ecx, [ebp+Src]
		mov	edx, [ebp+var_50]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	esi, [ebp+var_38]
		mov	[esp+98h+var_84], esi ;	size_t
		mov	[esp+98h+var_88], ebx ;	void *
		mov	ebx, [ebp+var_20]
		mov	[esp+98h+var_8C], ebx ;	size_t
		mov	[esp+98h+Size],	ecx ; void *
		mov	[esp+98h+Str2],	edx ; int
		mov	[esp+98h+Str1],	eax ; char
		call	sub_40D1F0
		mov	[ebp+var_1C], eax
		jmp	short loc_41C079
; ---------------------------------------------------------------------------

loc_41C075:				; CODE XREF: sub_41BC8F+24Ej
		nop
		jmp	short loc_41C079
; ---------------------------------------------------------------------------

loc_41C078:				; CODE XREF: sub_41BC8F+2E2j
		nop

loc_41C079:				; CODE XREF: sub_41BC8F+CDj
					; sub_41BC8F+17Bj ...
		mov	eax, [ebp+Src]
		mov	[esp+98h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+var_44]
		mov	[esp+98h+Str1],	eax
		call	gcry_free
		mov	eax, [ebp+var_1C]

loc_41C092:				; CODE XREF: sub_41BC8F+75j
					; sub_41BC8F+98j
		add	esp, 8Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_41BC8F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41C09D(int, char *, int, int)
sub_41C09D	proc near		; DATA XREF: sub_41C3FB+140o

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		lea	eax, [ebp+var_14]
		mov	[esp+38h+var_2C], eax ;	int
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_30], eax ;	int
		mov	[esp+38h+var_34], 0 ; int
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_41BB36
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41C0DB
		mov	[esp+38h+var_38], 76h
		call	sub_41954B
		jmp	short locret_41C122
; ---------------------------------------------------------------------------

loc_41C0DB:				; CODE XREF: sub_41C09D+2Ej
		mov	eax, [ebp+var_18]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_41C19D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41C0FB
		mov	eax, [ebp+var_10]
		jmp	short locret_41C122
; ---------------------------------------------------------------------------

loc_41C0FB:				; CODE XREF: sub_41C09D+57j
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_C]
		mov	[esp+38h+var_28], edx
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+var_2C], edx
		mov	edx, [ebp+var_C]
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_41ACD2

locret_41C122:				; CODE XREF: sub_41C09D+3Cj
					; sub_41C09D+5Cj
		leave
		retn
sub_41C09D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C124	proc near		; CODE XREF: sub_41C3FB+9Dp

var_38		= byte ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		lea	eax, [ebp+var_14]
		mov	[esp+38h+var_24], eax ;	int
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_28], eax ;	int
		mov	[esp+38h+var_2C], 0 ; int
		mov	[esp+38h+var_30], 5 ; size_t
		mov	[esp+38h+var_34], offset dword_44BD50 ;	void *
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+38h+var_38], eax	; char
		call	sub_40CFCD
		test	eax, eax
		jz	short loc_41C16D
		mov	eax, 2
		jmp	short locret_41C19B
; ---------------------------------------------------------------------------

loc_41C16D:				; CODE XREF: sub_41C124+40j
		mov	eax, [ebp+var_14]
		cmp	eax, 0Fh
		ja	short loc_41C17E
		mov	[ebp+var_C], 0
		jmp	short loc_41C18D
; ---------------------------------------------------------------------------

loc_41C17E:				; CODE XREF: sub_41C124+4Fj
		mov	eax, [ebp+var_10]
		add	eax, 8
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_C], eax

loc_41C18D:				; CODE XREF: sub_41C124+58j
		mov	eax, [ebp+var_10]
		mov	dword ptr [esp+38h+var_38], eax
		call	gcry_free
		mov	eax, [ebp+var_C]

locret_41C19B:				; CODE XREF: sub_41C124+47j
		leave
		retn
sub_41C124	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C19D	proc near		; CODE XREF: sub_4199A4+1Ap
					; sub_419AE2+20p ...

Buf1		= dword	ptr -48h
Buf2		= dword	ptr -44h
Size		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_41C1B6
		cmp	[ebp+arg_4], 0
		jnz	short loc_41C1C9

loc_41C1B6:				; CODE XREF: sub_41C19D+11j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_41C1E0
		cmp	[ebp+arg_4], 0
		jnz	short loc_41C1E0

loc_41C1C9:				; CODE XREF: sub_41C19D+17j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_41C1E0
		mov	eax, 0
		jmp	locret_41C3F9
; ---------------------------------------------------------------------------

loc_41C1E0:				; CODE XREF: sub_41C19D+24j
					; sub_41C19D+2Aj ...
		cmp	[ebp+arg_4], 0
		jz	short loc_41C1ED
		mov	eax, offset aSigg_0 ; "SigG"
		jmp	short loc_41C1F2
; ---------------------------------------------------------------------------

loc_41C1ED:				; CODE XREF: sub_41C19D+47j
		mov	eax, offset aNks_0 ; "NKS"

loc_41C1F2:				; CODE XREF: sub_41C19D+4Ej
		mov	[esp+48h+Buf2],	eax ; char
		mov	[esp+48h+Buf1],	offset aAppNksSwitchin ; "app-nks: switching to	%s\n"
		call	sub_43CAF7
		cmp	[ebp+arg_4], 0
		jz	short loc_41C233
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+48h+var_3C], 0 ; int
		mov	[esp+48h+Size],	6 ; size_t
		mov	[esp+48h+Buf2],	offset byte_44B6C3 ; void *
		mov	[esp+48h+Buf1],	eax ; char
		call	sub_40CCE9
		mov	[ebp+var_C], eax
		jmp	short loc_41C25C
; ---------------------------------------------------------------------------

loc_41C233:				; CODE XREF: sub_41C19D+69j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+48h+var_3C], 0 ; int
		mov	[esp+48h+Size],	7 ; size_t
		mov	[esp+48h+Buf2],	offset aV_2 ; "v"
		mov	[esp+48h+Buf1],	eax ; char
		call	sub_40CCE9
		mov	[ebp+var_C], eax

loc_41C25C:				; CODE XREF: sub_41C19D+94j
		cmp	[ebp+var_C], 0
		jnz	loc_41C3A2
		cmp	[ebp+arg_4], 0
		jz	loc_41C3A2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax]
		cmp	eax, 2
		jle	loc_41C3A2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	loc_41C3A2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	dword ptr [eax+8], 1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	dword ptr [eax+0Ch], 1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+48h+var_38], 0
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+Size],	0
		mov	[esp+48h+Buf2],	5349h
		mov	[esp+48h+Buf1],	eax
		call	sub_40CD52
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41C31A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_18]
		mov	[esp+48h+var_34], edx
		lea	edx, [ebp+var_14]
		mov	[esp+48h+var_38], edx
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+Size],	1
		mov	[esp+48h+Buf2],	1
		mov	[esp+48h+Buf1],	eax
		call	sub_40DF53
		mov	[ebp+var_C], eax

loc_41C31A:				; CODE XREF: sub_41C19D+144j
		cmp	[ebp+var_C], 0
		jnz	short loc_41C389
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_14]
		lea	ecx, [ebp+var_1C]
		mov	[esp+48h+var_3C], ecx
		mov	[esp+48h+Size],	7Ah
		mov	[esp+48h+Buf2],	edx
		mov	[esp+48h+Buf1],	eax
		call	sub_42D39C
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41C37E
		mov	eax, [ebp+var_1C]
		cmp	eax, 0Ch
		jnz	short loc_41C37E
		mov	[esp+48h+Size],	0Ch ; Size
		mov	[esp+48h+Buf2],	offset byte_44BD79 ; char
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_41C37E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	dword ptr [eax+0Ch], 0

loc_41C37E:				; CODE XREF: sub_41C19D+1ABj
					; sub_41C19D+1B3j ...
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Buf1],	eax
		call	gcry_free

loc_41C389:				; CODE XREF: sub_41C19D+181j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_41C3A2
		mov	[esp+48h+Buf1],	offset aThisIsAMassSig ; "This is a mass signature card\n"
		call	sub_43CAF7

loc_41C3A2:				; CODE XREF: sub_41C19D+C3j
					; sub_41C19D+CDj ...
		cmp	[ebp+var_C], 0
		jnz	short loc_41C3C3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		jmp	short loc_41C3F6
; ---------------------------------------------------------------------------

loc_41C3C3:				; CODE XREF: sub_41C19D+209j
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Buf1],	eax
		call	gpg_strerror
		mov	edx, eax
		cmp	[ebp+arg_4], 0
		jz	short loc_41C3DD
		mov	eax, offset aSigg_0 ; "SigG"
		jmp	short loc_41C3E2
; ---------------------------------------------------------------------------

loc_41C3DD:				; CODE XREF: sub_41C19D+237j
		mov	eax, offset aNks_0 ; "NKS"

loc_41C3E2:				; CODE XREF: sub_41C19D+23Ej
		mov	[esp+48h+Size],	edx
		mov	[esp+48h+Buf2],	eax ; char
		mov	[esp+48h+Buf1],	offset aAppNksErrorSwi ; "app-nks: error switching to %s: %s\n"
		call	sub_43CB21

loc_41C3F6:				; CODE XREF: sub_41C19D+224j
		mov	eax, [ebp+var_C]

locret_41C3F9:				; CODE XREF: sub_41C19D+3Ej
		leave
		retn
sub_41C19D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C3FB	proc near		; CODE XREF: sub_40E65D+3C4p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	dword ptr [ebp+var_10],	eax
		mov	[esp+28h+var_1C], 0 ; int
		mov	[esp+28h+var_20], 7 ; size_t
		mov	[esp+28h+var_24], offset aV_2 ;	"v"
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	char
		call	sub_40CCE9
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_41C542
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], offset aNks_0 ; "NKS"
		mov	[esp+28h+var_24], 14h
		mov	[esp+28h+var_28], 1
		call	gcry_calloc
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_41C48C
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		call	gpg_err_code_from_errno
		mov	[esp+28h+var_28], eax
		call	sub_41954B
		mov	[ebp+var_C], eax
		jmp	loc_41C542
; ---------------------------------------------------------------------------

loc_41C48C:				; CODE XREF: sub_41C3FB+6Ej
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+1Ch]
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_41C124
		mov	[ebx], eax
		mov	eax, ds:dword_451D24
		test	eax, eax
		jz	short loc_41C4C0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax]
		mov	[esp+28h+var_24], eax ;	char
		mov	[esp+28h+var_28], offset aDetectedNksVer ; "Detected NKS version: %d\n"
		call	sub_43CAF7

loc_41C4C0:				; CODE XREF: sub_41C3FB+ABj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], offset sub_419588
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], offset sub_41A0C8
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+28h], offset sub_41A15B
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], offset sub_41A8F7
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], offset sub_419AE2
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+34h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+48h], offset sub_41AAB8
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+38h], offset sub_41AEE6
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+3Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+40h], offset sub_41B5EF
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+50h], offset sub_41BC8F
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+54h], offset sub_41C09D

loc_41C542:				; CODE XREF: sub_41C3FB+3Aj
					; sub_41C3FB+8Cj
		cmp	[ebp+var_C], 0
		jz	short loc_41C553
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_419588

loc_41C553:				; CODE XREF: sub_41C3FB+14Bj
		mov	eax, [ebp+var_C]
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_41C3FB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C55C	proc near		; CODE XREF: sub_41C583+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_41C57C
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_41C581
; ---------------------------------------------------------------------------

loc_41C57C:				; CODE XREF: sub_41C55C+7j
		mov	eax, 0

loc_41C581:				; CODE XREF: sub_41C55C+1Ej
		pop	ebp
		retn
sub_41C55C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C583	proc near		; CODE XREF: sub_41C5AB+26Ap
					; sub_41C8C5+50p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 6
		call	sub_41C55C
		leave
		retn
sub_41C583	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C59E	proc near		; CODE XREF: sub_41CF5C+2B0p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_41C59E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C5AB	proc near		; DATA XREF: sub_41D8DA+48o

Dest		= dword	ptr -148h
Format		= dword	ptr -144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_134		= dword	ptr -134h
var_130		= dword	ptr -130h
var_12C		= dword	ptr -12Ch
var_11C		= dword	ptr -11Ch
var_118		= dword	ptr -118h
var_114		= dword	ptr -114h
var_110		= dword	ptr -110h
var_10C		= dword	ptr -10Ch
var_105		= byte ptr -105h
var_DC		= byte ptr -0DCh
var_78		= byte ptr -78h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	dword ptr [ebp+var_C], 0C000h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_10C]
		mov	[esp+148h+var_140], edx
		mov	edx, dword ptr [ebp+var_C]
		mov	[esp+148h+Format], edx
		mov	[esp+148h+Dest], eax
		call	sub_40FEE5
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41C5EF
		mov	eax, 0
		jmp	loc_41C8BB
; ---------------------------------------------------------------------------

loc_41C5EF:				; CODE XREF: sub_41C5AB+38j
		mov	eax, offset aD_4 ; "%d"
		mov	[esp+148h+var_140], 65h
		mov	[esp+148h+Format], eax ; Format
		lea	eax, [ebp+var_78]
		mov	[esp+148h+Dest], eax ; Dest
		call	sprintf
		mov	eax, offset aDinsig_04x	; "DINSIG.%04X"
		mov	edx, dword ptr [ebp+var_C]
		mov	[esp+148h+var_140], edx
		mov	[esp+148h+Format], eax ; Format
		lea	eax, [ebp+var_DC]
		mov	[esp+148h+Dest], eax ; Dest
		call	sprintf
		lea	eax, [ebp+var_DC]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		lea	eax, [ebp+var_78]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	[esp+148h+var_12C], 0
		mov	[esp+148h+var_130], 0
		mov	[esp+148h+var_134], ebx
		lea	eax, [ebp+var_DC]
		mov	[esp+148h+var_138], eax
		mov	[esp+148h+var_13C], edx
		lea	eax, [ebp+var_78]
		mov	[esp+148h+var_140], eax
		mov	[esp+148h+Format], offset aCertinfo_0 ;	"CERTINFO"
		mov	eax, [ebp+arg_4]
		mov	[esp+148h+Dest], eax
		call	sub_406FDB
		mov	eax, [ebp+var_10C]
		mov	edx, [ebp+var_10]
		mov	ebx, edx
		sub	ebx, eax
		mov	edx, [ebp+var_10C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	ecx, [ebp+var_114]
		mov	[esp+148h+var_138], ecx
		lea	ecx, [ebp+var_110]
		mov	[esp+148h+var_13C], ecx
		mov	[esp+148h+var_140], ebx
		mov	[esp+148h+Format], edx
		mov	[esp+148h+Dest], eax
		call	sub_40DC72
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_41C724
		mov	eax, [ebp+var_14]
		mov	[esp+148h+Dest], eax
		call	gpg_strerror
		mov	[esp+148h+var_140], eax
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+148h+Format], eax ; char
		mov	[esp+148h+Dest], offset	aErrorReadingEn	; "error reading entire	certificate from F"...
		call	sub_43CAF7
		mov	eax, 0
		jmp	loc_41C8BB
; ---------------------------------------------------------------------------

loc_41C724:				; CODE XREF: sub_41C5AB+14Bj
		lea	eax, [ebp+var_118]
		mov	[esp+148h+Dest], eax
		call	ksba_cert_new
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_41C751
		mov	eax, [ebp+var_110]
		mov	[esp+148h+Dest], eax
		call	gcry_free
		mov	eax, [ebp+var_14]
		jmp	loc_41C8BB
; ---------------------------------------------------------------------------

loc_41C751:				; CODE XREF: sub_41C5AB+18Ej
		mov	ecx, [ebp+var_114]
		mov	edx, [ebp+var_110]
		mov	eax, [ebp+var_118]
		mov	[esp+148h+var_140], ecx
		mov	[esp+148h+Format], edx
		mov	[esp+148h+Dest], eax
		call	ksba_cert_init_from_mem
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_110]
		mov	[esp+148h+Dest], eax
		call	gcry_free
		mov	[ebp+var_110], 0
		cmp	[ebp+var_14], 0
		jz	short loc_41C7CC
		mov	eax, [ebp+var_14]
		mov	[esp+148h+Dest], eax
		call	gpg_strerror
		mov	[esp+148h+var_140], eax
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+148h+Format], eax ; char
		mov	[esp+148h+Dest], offset	aFailedToPars_0	; "failed to parse the certificate at FID "...
		call	sub_43CB21
		mov	eax, [ebp+var_118]
		mov	[esp+148h+Dest], eax
		call	ksba_cert_release
		mov	eax, [ebp+var_14]
		jmp	loc_41C8BB
; ---------------------------------------------------------------------------

loc_41C7CC:				; CODE XREF: sub_41C5AB+1E7j
		mov	eax, [ebp+var_118]
		lea	edx, [ebp+var_105]
		mov	[esp+148h+Format], edx
		mov	[esp+148h+Dest], eax
		call	sub_40FDE8
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_41C81F
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+148h+Format], eax ; char
		mov	[esp+148h+Dest], offset	aFailedToCalcul	; "failed to calculate the keygrip for FID"...
		call	sub_43CB21
		mov	eax, [ebp+var_118]
		mov	[esp+148h+Dest], eax
		call	ksba_cert_release
		mov	[esp+148h+Dest], 6Ch
		call	sub_41C583
		jmp	loc_41C8BB
; ---------------------------------------------------------------------------

loc_41C81F:				; CODE XREF: sub_41C5AB+240j
		mov	eax, [ebp+var_118]
		mov	[esp+148h+Dest], eax
		call	ksba_cert_release
		mov	eax, offset aDinsig_04x	; "DINSIG.%04X"
		mov	edx, dword ptr [ebp+var_C]
		mov	[esp+148h+var_140], edx
		mov	[esp+148h+Format], eax ; Format
		lea	eax, [ebp+var_DC]
		mov	[esp+148h+Dest], eax ; Dest
		call	sprintf
		lea	eax, [ebp+var_DC]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+148h+var_12C], 0
		mov	[esp+148h+var_130], 0
		mov	[esp+148h+var_134], eax
		lea	eax, [ebp+var_DC]
		mov	[esp+148h+var_138], eax
		mov	[esp+148h+var_13C], 28h
		lea	eax, [ebp+var_105]
		mov	[esp+148h+var_140], eax
		mov	[esp+148h+Format], offset aKeypairinfo_2 ; "KEYPAIRINFO"
		mov	eax, [ebp+arg_4]
		mov	[esp+148h+Dest], eax
		call	sub_406FDB
		mov	eax, 0

loc_41C8BB:				; CODE XREF: sub_41C5AB+3Fj
					; sub_41C5AB+174j ...
		add	esp, 140h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41C5AB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41C8C5	proc near		; DATA XREF: sub_41D8DA+52o

Dst		= dword	ptr -78h
Src		= dword	ptr -74h
Size		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= byte ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 70h
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aDinsig_ ; "DINSIG."
		mov	ecx, 7
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_41C91F
		mov	[esp+78h+Dst], 76h
		call	sub_41C583
		jmp	loc_41CF55
; ---------------------------------------------------------------------------

loc_41C91F:				; CODE XREF: sub_41C8C5+47j
		add	[ebp+arg_4], 7
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41C937
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41C967

loc_41C937:				; CODE XREF: sub_41C8C5+66j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41C94B
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41C967

loc_41C94B:				; CODE XREF: sub_41C8C5+7Aj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	loc_41CA66
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	loc_41CA66

loc_41C967:				; CODE XREF: sub_41C8C5+70j
					; sub_41C8C5+84j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41C981
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41C9BD

loc_41C981:				; CODE XREF: sub_41C8C5+ADj
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41C99B
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41C9BD

loc_41C99B:				; CODE XREF: sub_41C8C5+C7j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	loc_41CA66
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	loc_41CA66

loc_41C9BD:				; CODE XREF: sub_41C8C5+BAj
					; sub_41C8C5+D4j
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41C9D7
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41CA0B

loc_41C9D7:				; CODE XREF: sub_41C8C5+103j
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41C9F1
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41CA0B

loc_41C9F1:				; CODE XREF: sub_41C8C5+11Dj
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_41CA66
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_41CA66

loc_41CA0B:				; CODE XREF: sub_41C8C5+110j
					; sub_41C8C5+12Aj
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41CA25
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41CA59

loc_41CA25:				; CODE XREF: sub_41C8C5+151j
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41CA3F
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41CA59

loc_41CA3F:				; CODE XREF: sub_41C8C5+16Bj
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_41CA66
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_41CA66

loc_41CA59:				; CODE XREF: sub_41C8C5+15Ej
					; sub_41C8C5+178j
		mov	eax, [ebp+arg_4]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41CA77

loc_41CA66:				; CODE XREF: sub_41C8C5+8Ej
					; sub_41C8C5+9Cj ...
		mov	[esp+78h+Dst], 76h
		call	sub_41C583
		jmp	loc_41CF55
; ---------------------------------------------------------------------------

loc_41CA77:				; CODE XREF: sub_41C8C5+19Fj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41CA94
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_41CAC0
; ---------------------------------------------------------------------------

loc_41CA94:				; CODE XREF: sub_41C8C5+1BAj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41CAAF
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_41CABE
; ---------------------------------------------------------------------------

loc_41CAAF:				; CODE XREF: sub_41C8C5+1D7j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_41CABE:				; CODE XREF: sub_41C8C5+1E8j
		mov	edx, eax

loc_41CAC0:				; CODE XREF: sub_41C8C5+1CDj
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41CADE
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		jmp	short loc_41CB0B
; ---------------------------------------------------------------------------

loc_41CADE:				; CODE XREF: sub_41C8C5+206j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41CAFC
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		jmp	short loc_41CB0B
; ---------------------------------------------------------------------------

loc_41CAFC:				; CODE XREF: sub_41C8C5+224j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h

loc_41CB0B:				; CODE XREF: sub_41C8C5+217j
					; sub_41C8C5+235j
		add	eax, edx
		mov	ecx, eax
		shl	ecx, 8
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41CB35
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_41CB6A
; ---------------------------------------------------------------------------

loc_41CB35:				; CODE XREF: sub_41C8C5+258j
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41CB56
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_41CB68
; ---------------------------------------------------------------------------

loc_41CB56:				; CODE XREF: sub_41C8C5+27Bj
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_41CB68:				; CODE XREF: sub_41C8C5+28Fj
		mov	edx, eax

loc_41CB6A:				; CODE XREF: sub_41C8C5+26Ej
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41CB88
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		jmp	short loc_41CBB5
; ---------------------------------------------------------------------------

loc_41CB88:				; CODE XREF: sub_41C8C5+2B0j
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41CBA6
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		jmp	short loc_41CBB5
; ---------------------------------------------------------------------------

loc_41CBA6:				; CODE XREF: sub_41C8C5+2CEj
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h

loc_41CBB5:				; CODE XREF: sub_41C8C5+2C1j
					; sub_41C8C5+2DFj
		add	eax, edx
		add	eax, ecx
		mov	dword ptr [ebp+var_18],	eax
		cmp	dword ptr [ebp+var_18],	0C000h
		jz	short loc_41CBD6
		mov	[esp+78h+Dst], 1Bh
		call	sub_41C583
		jmp	loc_41CF55
; ---------------------------------------------------------------------------

loc_41CBD6:				; CODE XREF: sub_41C8C5+2FEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+78h+var_68], 0
		mov	[esp+78h+var_6C], 0
		mov	[esp+78h+Size],	0
		mov	edx, dword ptr [ebp+var_18]
		mov	[esp+78h+Src], edx
		mov	[esp+78h+Dst], eax
		call	sub_40CD52
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41CC36
		mov	eax, [ebp+var_C]
		mov	[esp+78h+Dst], eax
		call	gpg_strerror
		mov	[esp+78h+Size],	eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+78h+Src], eax ; char
		mov	[esp+78h+Dst], offset aErrorSelecti_1 ;	"error selecting FID 0x%04X: %s\n"
		call	sub_43CB21
		mov	eax, [ebp+var_C]
		jmp	loc_41CF55
; ---------------------------------------------------------------------------

loc_41CC36:				; CODE XREF: sub_41C8C5+345j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_28]
		mov	[esp+78h+var_68], edx
		lea	edx, [ebp+var_20]
		mov	[esp+78h+var_6C], edx
		mov	[esp+78h+Size],	0
		mov	[esp+78h+Src], 0
		mov	[esp+78h+Dst], eax
		call	sub_40DC72
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41CC95
		mov	eax, [ebp+var_C]
		mov	[esp+78h+Dst], eax
		call	gpg_strerror
		mov	[esp+78h+Size],	eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+78h+Src], eax ; char
		mov	[esp+78h+Dst], offset aErrorReading_1 ;	"error reading certificate from	FID 0x%0"...
		call	sub_43CB21
		mov	eax, [ebp+var_C]
		jmp	loc_41CF55
; ---------------------------------------------------------------------------

loc_41CC95:				; CODE XREF: sub_41C8C5+3A4j
		mov	eax, [ebp+var_28]
		test	eax, eax
		jz	short loc_41CCA6
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FFh
		jnz	short loc_41CCCD

loc_41CCA6:				; CODE XREF: sub_41C8C5+3D5j
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+78h+Src], eax ; char
		mov	[esp+78h+Dst], offset aNoCertificat_1 ;	"no certificate	contained in FID 0x%04X\"...
		call	sub_43CAF7
		mov	[esp+78h+Dst], 1Bh
		call	sub_41C583
		mov	[ebp+var_C], eax
		jmp	loc_41CF47
; ---------------------------------------------------------------------------

loc_41CCCD:				; CODE XREF: sub_41C8C5+3DFj
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_2C], eax
		mov	[esp+78h+var_58], 6
		lea	eax, [ebp+var_44]
		mov	[esp+78h+var_5C], eax
		lea	eax, [ebp+var_40]
		mov	[esp+78h+var_60], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+78h+var_64], eax
		lea	eax, [ebp+var_38]
		mov	[esp+78h+var_68], eax
		lea	eax, [ebp+var_34]
		mov	[esp+78h+var_6C], eax
		lea	eax, [ebp+var_30]
		mov	[esp+78h+Size],	eax
		lea	eax, [ebp+var_2C]
		mov	[esp+78h+Src], eax
		lea	eax, [ebp+var_24]
		mov	[esp+78h+Dst], eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_41CF40
		mov	eax, [ebp+var_30]
		test	eax, eax
		jnz	short loc_41CD40
		mov	eax, [ebp+var_34]
		cmp	eax, 10h
		jnz	short loc_41CD40
		mov	eax, [ebp+var_38]
		test	eax, eax
		jnz	short loc_41CD70

loc_41CD40:				; CODE XREF: sub_41C8C5+46Aj
					; sub_41C8C5+472j
		mov	eax, [ebp+var_30]
		test	eax, eax
		jnz	short loc_41CD5F
		mov	eax, [ebp+var_34]
		cmp	eax, 11h
		jnz	short loc_41CD5F
		mov	eax, [ebp+var_38]
		test	eax, eax
		jz	short loc_41CD5F
		mov	[ebp+var_14], 1
		jmp	short loc_41CD70
; ---------------------------------------------------------------------------

loc_41CD5F:				; CODE XREF: sub_41C8C5+480j
					; sub_41C8C5+488j ...
		mov	[esp+78h+Dst], 41h
		call	sub_41C583
		jmp	loc_41CF55
; ---------------------------------------------------------------------------

loc_41CD70:				; CODE XREF: sub_41C8C5+479j
					; sub_41C8C5+498j
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_44]
		add	eax, edx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_28]
		cmp	[ebp+var_10], eax
		jbe	short loc_41CD9F
		mov	[esp+78h+Size],	0E8h ; int
		mov	[esp+78h+Src], offset a____Gnupg22__4 ;	"../../gnupg2-2.0.30/scd/app-dinsig.c"
		mov	[esp+78h+Dst], offset aTotobjlenBuf_0 ;	"totobjlen <= buflen"
		call	sub_442650

loc_41CD9F:				; CODE XREF: sub_41C8C5+4BCj
		mov	[esp+78h+var_58], 6
		lea	eax, [ebp+var_44]
		mov	[esp+78h+var_5C], eax
		lea	eax, [ebp+var_40]
		mov	[esp+78h+var_60], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+78h+var_64], eax
		lea	eax, [ebp+var_38]
		mov	[esp+78h+var_68], eax
		lea	eax, [ebp+var_34]
		mov	[esp+78h+var_6C], eax
		lea	eax, [ebp+var_30]
		mov	[esp+78h+Size],	eax
		lea	eax, [ebp+var_2C]
		mov	[esp+78h+Src], eax
		lea	eax, [ebp+var_24]
		mov	[esp+78h+Dst], eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_41CF43
		cmp	[ebp+var_14], 0
		jnz	loc_41CF27
		mov	eax, [ebp+var_30]
		test	eax, eax
		jnz	loc_41CF27
		mov	eax, [ebp+var_34]
		cmp	eax, 6
		jnz	loc_41CF27
		mov	eax, [ebp+var_38]
		test	eax, eax
		jnz	loc_41CF27
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_40]
		cmp	edx, eax
		jnb	short loc_41CE3A
		mov	[esp+78h+Dst], 41h
		call	sub_41C583
		mov	[ebp+var_C], eax
		jmp	loc_41CF47
; ---------------------------------------------------------------------------

loc_41CE3A:				; CODE XREF: sub_41C8C5+55Fj
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_40]
		add	eax, edx
		mov	[ebp+var_24], eax
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_40]
		mov	esi, edx
		sub	esi, eax
		mov	eax, esi
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_1C], eax
		mov	[esp+78h+var_58], 6
		lea	eax, [ebp+var_44]
		mov	[esp+78h+var_5C], eax
		lea	eax, [ebp+var_40]
		mov	[esp+78h+var_60], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+78h+var_64], eax
		lea	eax, [ebp+var_38]
		mov	[esp+78h+var_68], eax
		lea	eax, [ebp+var_34]
		mov	[esp+78h+var_6C], eax
		lea	eax, [ebp+var_30]
		mov	[esp+78h+Size],	eax
		lea	eax, [ebp+var_2C]
		mov	[esp+78h+Src], eax
		lea	eax, [ebp+var_24]
		mov	[esp+78h+Dst], eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_41CF46
		mov	eax, [ebp+var_30]
		test	eax, eax
		jnz	short loc_41CEC1
		mov	eax, [ebp+var_34]
		cmp	eax, 10h
		jnz	short loc_41CEC1
		mov	eax, [ebp+var_38]
		test	eax, eax
		jnz	short loc_41CED2

loc_41CEC1:				; CODE XREF: sub_41C8C5+5EBj
					; sub_41C8C5+5F3j
		mov	[esp+78h+Dst], 41h
		call	sub_41C583
		jmp	loc_41CF55
; ---------------------------------------------------------------------------

loc_41CED2:				; CODE XREF: sub_41C8C5+5FAj
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_44]
		add	eax, edx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_1C]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_28]
		add	eax, edx
		cmp	ecx, eax
		jbe	short loc_41CF0E
		mov	[esp+78h+Size],	107h ; int
		mov	[esp+78h+Src], offset a____Gnupg22__4 ;	"../../gnupg2-2.0.30/scd/app-dinsig.c"
		mov	[esp+78h+Dst], offset aSave_pTotobj_0 ;	"save_p	+ totobjlen <= buffer +	buflen"
		call	sub_442650

loc_41CF0E:				; CODE XREF: sub_41C8C5+62Bj
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_10]
		mov	[esp+78h+Size],	edx ; Size
		mov	edx, [ebp+var_1C]
		mov	[esp+78h+Src], edx ; Src
		mov	[esp+78h+Dst], eax ; Dst
		call	memmove

loc_41CF27:				; CODE XREF: sub_41C8C5+52Fj
					; sub_41C8C5+53Aj ...
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_41CF47
; ---------------------------------------------------------------------------

loc_41CF40:				; CODE XREF: sub_41C8C5+45Fj
		nop
		jmp	short loc_41CF47
; ---------------------------------------------------------------------------

loc_41CF43:				; CODE XREF: sub_41C8C5+525j
		nop
		jmp	short loc_41CF47
; ---------------------------------------------------------------------------

loc_41CF46:				; CODE XREF: sub_41C8C5+5E0j
		nop

loc_41CF47:				; CODE XREF: sub_41C8C5+403j
					; sub_41C8C5+570j ...
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+var_C]

loc_41CF55:				; CODE XREF: sub_41C8C5+55j
					; sub_41C8C5+1ADj ...
		add	esp, 70h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_41C8C5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41CF5C	proc near		; CODE XREF: sub_41D35C+529p

var_58		= dword	ptr -58h
var_54		= byte ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_30		= byte ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= byte ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+18h]
		and	eax, 1
		test	al, al
		jz	short loc_41CF8A
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+18h]
		and	eax, 2
		test	al, al
		jnz	short loc_41CF8A
		mov	eax, 0
		jmp	loc_41D355
; ---------------------------------------------------------------------------

loc_41CF8A:				; CODE XREF: sub_41CF5C+14j
					; sub_41CF5C+22j
		lea	eax, [ebp+var_24]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+var_24], 0FFFFFFFFh
		mov	dword ptr [ebp+var_20],	6
		mov	dword ptr [ebp+var_1C],	8
		mov	eax, ds:dword_451D48
		test	eax, eax
		jnz	loc_41D081
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_24]
		mov	[esp+58h+var_50], edx
		mov	dword ptr [esp+58h+var_54], 20h
		mov	[esp+58h+var_58], eax
		call	sub_40D0D7
		test	eax, eax
		jnz	loc_41D081
		mov	[esp+58h+var_58], offset aPleaseEnterYou ; "||Please enter your	PIN at the reader's"...
		call	sub_43C238
		mov	[esp+58h+var_50], 0
		mov	dword ptr [esp+58h+var_54], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_4]
		call	eax
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41D041
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+58h+var_58], offset aPinCallbackR_1 ; "PIN	callback returned error: %s\n"
		call	sub_43C238
		mov	dword ptr [esp+58h+var_54], ebx	; char
		mov	[esp+58h+var_58], eax ;	char *
		call	sub_43CAF7
		mov	eax, [ebp+var_10]
		jmp	loc_41D355
; ---------------------------------------------------------------------------

loc_41D041:				; CODE XREF: sub_41CF5C+B6j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_24]
		mov	[esp+58h+var_50], edx
		mov	dword ptr [esp+58h+var_54], 81h
		mov	[esp+58h+var_58], eax
		call	sub_40D106
		mov	[ebp+var_10], eax
		mov	[esp+58h+var_50], 0
		mov	dword ptr [esp+58h+var_54], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_4]
		call	eax
		jmp	loc_41D32C
; ---------------------------------------------------------------------------

loc_41D081:				; CODE XREF: sub_41CF5C+61j
					; sub_41CF5C+86j
		lea	eax, [ebp+var_28]
		mov	[esp+58h+var_50], eax
		mov	dword ptr [esp+58h+var_54], offset aPin_0 ; "PIN"
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_4]
		call	eax
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41D0C7
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	gpg_strerror
		mov	dword ptr [esp+58h+var_54], eax	; char
		mov	[esp+58h+var_58], offset aPinCallbackR_1 ; "PIN	callback returned error: %s\n"
		call	sub_43CAF7
		mov	eax, [ebp+var_10]
		jmp	loc_41D355
; ---------------------------------------------------------------------------

loc_41D0C7:				; CODE XREF: sub_41CF5C+146j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_C], eax
		jmp	short loc_41D0D3
; ---------------------------------------------------------------------------

loc_41D0CF:				; CODE XREF: sub_41CF5C+189j
		add	[ebp+var_C], 1

loc_41D0D3:				; CODE XREF: sub_41CF5C+171j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41D0E7
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41D0CF

loc_41D0E7:				; CODE XREF: sub_41CF5C+17Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41D119
		mov	[esp+58h+var_58], offset aNonNumericDigi ; "Non-numeric	digits found in	PIN\n"
		call	sub_43CB21
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	[esp+58h+var_58], 57h
		call	sub_41C583
		jmp	loc_41D355
; ---------------------------------------------------------------------------

loc_41D119:				; CODE XREF: sub_41CF5C+193j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, dword ptr [ebp+var_20]
		cmp	edx, eax
		jnb	short loc_41D16E
		mov	eax, dword ptr [ebp+var_20]
		mov	dword ptr [esp+58h+var_54], eax	; char
		mov	[esp+58h+var_58], offset aPinIsTooShor_0 ; "PIN	is too short; minimum length is	%d\"...
		call	sub_43CB21
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	[esp+58h+var_58], 57h
		call	sub_41C583
		jmp	loc_41D355
; ---------------------------------------------------------------------------

loc_41D16E:				; CODE XREF: sub_41CF5C+1E1j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, dword ptr [ebp+var_1C]
		cmp	edx, eax
		jbe	short loc_41D1C3
		mov	eax, dword ptr [ebp+var_1C]
		mov	dword ptr [esp+58h+var_54], eax	; char
		mov	[esp+58h+var_58], offset aPinIsTooLarg_0 ; "PIN	is too large; maximum length is	%d\"...
		call	sub_43CB21
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_58], eax
		call	gcry_free
		mov	[esp+58h+var_58], 57h
		call	sub_41C583
		jmp	loc_41D355
; ---------------------------------------------------------------------------

loc_41D1C3:				; CODE XREF: sub_41CF5C+236j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ecx, [eax-1]
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+58h+var_4C], ecx ;	size_t
		mov	[esp+58h+var_50], edx ;	void *
		mov	dword ptr [esp+58h+var_54], 81h	; int
		mov	[esp+58h+var_58], eax ;	char
		call	sub_40D14D
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_58], eax
		call	sub_41C59E
		cmp	eax, 37h
		jnz	loc_41D321
		mov	[ebp+var_18], 0
		mov	eax, [ebp+var_28]
		mov	[ebp+var_C], eax
		jmp	short loc_41D231
; ---------------------------------------------------------------------------

loc_41D229:				; CODE XREF: sub_41CF5C+2DDj
		add	[ebp+var_18], 1
		add	[ebp+var_C], 1

loc_41D231:				; CODE XREF: sub_41CF5C+2CBj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41D229
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		and	eax, 0Fh
		mov	edx, eax
		or	edx, 20h
		lea	eax, [ebp+var_30]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_28]
		mov	[ebp+var_C], eax
		jmp	short loc_41D28E
; ---------------------------------------------------------------------------

loc_41D261:				; CODE XREF: sub_41CF5C+34Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		shl	eax, 4
		mov	edx, [ebp+var_C]
		add	edx, 1
		movzx	edx, byte ptr [edx]
		and	edx, 0Fh
		or	edx, eax
		lea	eax, [ebp+var_30]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		add	[ebp+var_C], 2

loc_41D28E:				; CODE XREF: sub_41CF5C+303j
		mov	eax, [ebp+var_14]
		cmp	eax, 7
		ja	short loc_41D2AD
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41D2AD
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41D261

loc_41D2AD:				; CODE XREF: sub_41CF5C+338j
					; sub_41CF5C+342j
		mov	eax, [ebp+var_14]
		cmp	eax, 7
		ja	short loc_41D2F0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41D2F0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		shl	eax, 4
		mov	edx, eax
		or	edx, 0Fh
		lea	eax, [ebp+var_30]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	short loc_41D2F0
; ---------------------------------------------------------------------------

loc_41D2E1:				; CODE XREF: sub_41CF5C+39Bj
		lea	eax, [ebp+var_30]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	0FFh
		add	[ebp+var_14], 1
		jmp	short loc_41D2F1
; ---------------------------------------------------------------------------

loc_41D2F0:				; CODE XREF: sub_41CF5C+357j
					; sub_41CF5C+361j ...
		nop

loc_41D2F1:				; CODE XREF: sub_41CF5C+392j
		mov	eax, [ebp+var_14]
		cmp	eax, 7
		jbe	short loc_41D2E1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+58h+var_4C], 8 ; size_t
		lea	edx, [ebp+var_30]
		mov	[esp+58h+var_50], edx ;	void *
		mov	dword ptr [esp+58h+var_54], 81h	; char
		mov	[esp+58h+var_58], eax ;	char
		call	sub_40D14D
		mov	[ebp+var_10], eax

loc_41D321:				; CODE XREF: sub_41CF5C+2B8j
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_58], eax
		call	gcry_free

loc_41D32C:				; CODE XREF: sub_41CF5C+120j
		cmp	[ebp+var_10], 0
		jz	short loc_41D343
		mov	[esp+58h+var_58], offset aVerifyPinFai_0 ; "verify PIN failed\n"
		call	sub_43CB21
		mov	eax, [ebp+var_10]
		jmp	short loc_41D355
; ---------------------------------------------------------------------------

loc_41D343:				; CODE XREF: sub_41CF5C+3D4j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		or	edx, 1
		mov	[eax+18h], dl
		mov	eax, 0

loc_41D355:				; CODE XREF: sub_41CF5C+29j
					; sub_41CF5C+E0j ...
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41CF5C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41D35C(int, int, int,	int, int, void *Src, size_t, int, int)
sub_41D35C	proc near		; DATA XREF: sub_41D8DA+7Ao

Buf1		= dword	ptr -78h
Buf2		= dword	ptr -74h
Size		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
Dst		= byte ptr -4Bh
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
Src		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 70h
		cmp	[ebp+arg_4], 0
		jz	short loc_41D374
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41D385

loc_41D374:				; CODE XREF: sub_41D35C+Cj
		mov	[esp+78h+Buf1],	37h
		call	sub_41C583
		jmp	loc_41D8D3
; ---------------------------------------------------------------------------

loc_41D385:				; CODE XREF: sub_41D35C+16j
		cmp	[ebp+arg_18], 14h
		jz	short loc_41D3B4
		cmp	[ebp+arg_18], 10h
		jz	short loc_41D3B4
		cmp	[ebp+arg_18], 20h
		jz	short loc_41D3B4
		cmp	[ebp+arg_18], 23h
		jz	short loc_41D3B4
		cmp	[ebp+arg_18], 33h
		jz	short loc_41D3B4
		mov	[esp+78h+Buf1],	37h
		call	sub_41C583
		jmp	loc_41D8D3
; ---------------------------------------------------------------------------

loc_41D3B4:				; CODE XREF: sub_41D35C+2Dj
					; sub_41D35C+33j ...
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		mov	eax, offset aDinsig_ ; "DINSIG."
		mov	ecx, 7
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_41D3ED
		mov	[esp+78h+Buf1],	76h
		call	sub_41C583
		jmp	loc_41D8D3
; ---------------------------------------------------------------------------

loc_41D3ED:				; CODE XREF: sub_41D35C+7Ej
		add	[ebp+arg_4], 7
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41D405
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41D435

loc_41D405:				; CODE XREF: sub_41D35C+9Dj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41D419
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41D435

loc_41D419:				; CODE XREF: sub_41D35C+B1j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	loc_41D534
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	loc_41D534

loc_41D435:				; CODE XREF: sub_41D35C+A7j
					; sub_41D35C+BBj
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41D44F
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41D48B

loc_41D44F:				; CODE XREF: sub_41D35C+E4j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41D469
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41D48B

loc_41D469:				; CODE XREF: sub_41D35C+FEj
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	loc_41D534
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	loc_41D534

loc_41D48B:				; CODE XREF: sub_41D35C+F1j
					; sub_41D35C+10Bj
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41D4A5
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41D4D9

loc_41D4A5:				; CODE XREF: sub_41D35C+13Aj
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41D4BF
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41D4D9

loc_41D4BF:				; CODE XREF: sub_41D35C+154j
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_41D534
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_41D534

loc_41D4D9:				; CODE XREF: sub_41D35C+147j
					; sub_41D35C+161j
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41D4F3
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41D527

loc_41D4F3:				; CODE XREF: sub_41D35C+188j
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41D50D
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41D527

loc_41D50D:				; CODE XREF: sub_41D35C+1A2j
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_41D534
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_41D534

loc_41D527:				; CODE XREF: sub_41D35C+195j
					; sub_41D35C+1AFj
		mov	eax, [ebp+arg_4]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41D545

loc_41D534:				; CODE XREF: sub_41D35C+C5j
					; sub_41D35C+D3j ...
		mov	[esp+78h+Buf1],	76h
		call	sub_41C583
		jmp	loc_41D8D3
; ---------------------------------------------------------------------------

loc_41D545:				; CODE XREF: sub_41D35C+1D6j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41D562
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_41D58E
; ---------------------------------------------------------------------------

loc_41D562:				; CODE XREF: sub_41D35C+1F1j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41D57D
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_41D58C
; ---------------------------------------------------------------------------

loc_41D57D:				; CODE XREF: sub_41D35C+20Ej
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_41D58C:				; CODE XREF: sub_41D35C+21Fj
		mov	edx, eax

loc_41D58E:				; CODE XREF: sub_41D35C+204j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41D5AC
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		jmp	short loc_41D5D9
; ---------------------------------------------------------------------------

loc_41D5AC:				; CODE XREF: sub_41D35C+23Dj
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41D5CA
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		jmp	short loc_41D5D9
; ---------------------------------------------------------------------------

loc_41D5CA:				; CODE XREF: sub_41D35C+25Bj
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h

loc_41D5D9:				; CODE XREF: sub_41D35C+24Ej
					; sub_41D35C+26Cj
		add	eax, edx
		mov	ecx, eax
		shl	ecx, 8
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41D603
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_41D638
; ---------------------------------------------------------------------------

loc_41D603:				; CODE XREF: sub_41D35C+28Fj
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41D624
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_41D636
; ---------------------------------------------------------------------------

loc_41D624:				; CODE XREF: sub_41D35C+2B2j
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_41D636:				; CODE XREF: sub_41D35C+2C6j
		mov	edx, eax

loc_41D638:				; CODE XREF: sub_41D35C+2A5j
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41D656
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		jmp	short loc_41D683
; ---------------------------------------------------------------------------

loc_41D656:				; CODE XREF: sub_41D35C+2E7j
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41D674
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		jmp	short loc_41D683
; ---------------------------------------------------------------------------

loc_41D674:				; CODE XREF: sub_41D35C+305j
		mov	eax, [ebp+arg_4]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h

loc_41D683:				; CODE XREF: sub_41D35C+2F8j
					; sub_41D35C+316j
		add	eax, edx
		add	eax, ecx
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0C000h
		jz	short loc_41D6A4
		mov	[esp+78h+Buf1],	1Bh
		call	sub_41C583
		jmp	loc_41D8D3
; ---------------------------------------------------------------------------

loc_41D6A4:				; CODE XREF: sub_41D35C+335j
		mov	[ebp+var_10], 23h
		cmp	[ebp+arg_18], 23h
		jnz	short loc_41D72A
		cmp	[ebp+arg_8], 2
		jnz	short loc_41D6D6
		mov	[esp+78h+Size],	0Fh ; Size
		mov	[esp+78h+Buf2],	offset dword_444B00 ; Buf2
		mov	eax, [ebp+Src]
		mov	[esp+78h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_41D70C

loc_41D6D6:				; CODE XREF: sub_41D35C+359j
		cmp	[ebp+arg_8], 3
		jnz	short loc_41D6FB
		mov	[esp+78h+Size],	0Fh ; Size
		mov	[esp+78h+Buf2],	offset byte_444B0F ; Buf2
		mov	eax, [ebp+Src]
		mov	[esp+78h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_41D70C

loc_41D6FB:				; CODE XREF: sub_41D35C+37Ej
		mov	[esp+78h+Buf1],	54h
		call	sub_41C583
		jmp	loc_41D8D3
; ---------------------------------------------------------------------------

loc_41D70C:				; CODE XREF: sub_41D35C+378j
					; sub_41D35C+39Dj
		lea	eax, [ebp+Dst]
		mov	edx, [ebp+Src]
		mov	ecx, [ebp+arg_18]
		mov	[esp+78h+Size],	ecx ; Size
		mov	[esp+78h+Buf2],	edx ; Src
		mov	[esp+78h+Buf1],	eax ; Dst
		call	memcpy
		jmp	loc_41D871
; ---------------------------------------------------------------------------

loc_41D72A:				; CODE XREF: sub_41D35C+353j
		cmp	[ebp+arg_18], 33h
		jnz	loc_41D7C2
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_10], eax
		cmp	[ebp+arg_8], 8
		jnz	short loc_41D75F
		mov	[esp+78h+Size],	13h ; Size
		mov	[esp+78h+Buf2],	offset word_444B1E ; Buf2
		mov	eax, [ebp+Src]
		mov	[esp+78h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_41D7A4

loc_41D75F:				; CODE XREF: sub_41D35C+3E2j
		cmp	[ebp+arg_8], 2
		jnz	short loc_41D793
		mov	[esp+78h+Size],	13h ; Size
		mov	[esp+78h+Buf2],	offset word_444B1E ; Buf2
		mov	eax, [ebp+Src]
		mov	[esp+78h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_41D793
		mov	[ebp+arg_8], 8
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_10], eax
		jmp	short loc_41D7A4
; ---------------------------------------------------------------------------

loc_41D793:				; CODE XREF: sub_41D35C+407j
					; sub_41D35C+426j
		mov	[esp+78h+Buf1],	54h
		call	sub_41C583
		jmp	loc_41D8D3
; ---------------------------------------------------------------------------

loc_41D7A4:				; CODE XREF: sub_41D35C+401j
					; sub_41D35C+435j
		lea	eax, [ebp+Dst]
		mov	edx, [ebp+Src]
		mov	ecx, [ebp+arg_18]
		mov	[esp+78h+Size],	ecx ; Size
		mov	[esp+78h+Buf2],	edx ; Src
		mov	[esp+78h+Buf1],	eax ; Dst
		call	memcpy
		jmp	loc_41D871
; ---------------------------------------------------------------------------

loc_41D7C2:				; CODE XREF: sub_41D35C+3D2j
		mov	[ebp+var_14], 0Fh
		cmp	[ebp+arg_8], 2
		jnz	short loc_41D7EC
		mov	ecx, [ebp+var_14]
		mov	edx, offset dword_444B00
		lea	eax, [ebp+Dst]
		mov	[esp+78h+Size],	ecx ; Size
		mov	[esp+78h+Buf2],	edx ; Src
		mov	[esp+78h+Buf1],	eax ; Dst
		call	memcpy
		jmp	short loc_41D853
; ---------------------------------------------------------------------------

loc_41D7EC:				; CODE XREF: sub_41D35C+471j
		cmp	[ebp+arg_8], 3
		jnz	short loc_41D80F
		mov	ecx, [ebp+var_14]
		mov	edx, offset byte_444B0F
		lea	eax, [ebp+Dst]
		mov	[esp+78h+Size],	ecx ; Size
		mov	[esp+78h+Buf2],	edx ; Src
		mov	[esp+78h+Buf1],	eax ; Dst
		call	memcpy
		jmp	short loc_41D853
; ---------------------------------------------------------------------------

loc_41D80F:				; CODE XREF: sub_41D35C+494j
		cmp	[ebp+arg_8], 8
		jnz	short loc_41D842
		mov	[ebp+var_14], 13h
		mov	eax, [ebp+var_14]
		add	eax, [ebp+arg_18]
		mov	[ebp+var_10], eax
		mov	ecx, [ebp+var_14]
		mov	edx, offset word_444B1E
		lea	eax, [ebp+Dst]
		mov	[esp+78h+Size],	ecx ; Size
		mov	[esp+78h+Buf2],	edx ; Src
		mov	[esp+78h+Buf1],	eax ; Dst
		call	memcpy
		jmp	short loc_41D853
; ---------------------------------------------------------------------------

loc_41D842:				; CODE XREF: sub_41D35C+4B7j
		mov	[esp+78h+Buf1],	54h
		call	sub_41C583
		jmp	loc_41D8D3
; ---------------------------------------------------------------------------

loc_41D853:				; CODE XREF: sub_41D35C+48Ej
					; sub_41D35C+4B1j ...
		lea	edx, [ebp+Dst]
		mov	eax, [ebp+var_14]
		add	eax, edx
		mov	edx, [ebp+Src]
		mov	ecx, [ebp+arg_18]
		mov	[esp+78h+Size],	ecx ; Size
		mov	[esp+78h+Buf2],	edx ; Src
		mov	[esp+78h+Buf1],	eax ; Dst
		call	memcpy

loc_41D871:				; CODE XREF: sub_41D35C+3C9j
					; sub_41D35C+461j
		mov	eax, [ebp+arg_10]
		mov	[esp+78h+Size],	eax
		mov	eax, [ebp+arg_C]
		mov	[esp+78h+Buf2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Buf1],	eax
		call	sub_41CF5C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41D8D0
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	ecx, [ebp+arg_20]
		mov	[esp+78h+var_60], ecx ;	int
		mov	ecx, [ebp+arg_1C]
		mov	[esp+78h+var_64], ecx ;	int
		mov	[esp+78h+var_68], 0 ; int
		mov	[esp+78h+var_6C], edx ;	size_t
		lea	edx, [ebp+Dst]
		mov	[esp+78h+Size],	edx ; void *
		mov	[esp+78h+Buf2],	0 ; int
		mov	[esp+78h+Buf1],	eax ; char
		call	sub_40D61C
		mov	[ebp+var_C], eax

loc_41D8D0:				; CODE XREF: sub_41D35C+535j
		mov	eax, [ebp+var_C]

loc_41D8D3:				; CODE XREF: sub_41D35C+24j
					; sub_41D35C+53j ...
		add	esp, 70h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_41D35C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41D8DA	proc near		; CODE XREF: sub_40E65D+487p

var_28		= byte ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	dword ptr [ebp+var_C], eax
		mov	[esp+28h+var_1C], 0 ; int
		mov	[esp+28h+var_20], 6 ; size_t
		mov	[esp+28h+var_24], offset aV_1 ;	"v"
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_28], eax	; char
		call	sub_40CCE9
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41D990
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], offset aDinsig_0 ;	"DINSIG"
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], offset sub_41C5AB
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+28h], offset sub_41C8C5
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+34h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+38h], offset sub_41D35C
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+3Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+40h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+50h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+54h], 0
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+18h]
		or	edx, 2
		mov	[eax+18h], dl

loc_41D990:				; CODE XREF: sub_41D8DA+39j
		mov	eax, [ebp+var_10]
		leave
		retn
sub_41D8DA	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41D998	proc near		; CODE XREF: sub_41D9BF+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_41D9B8
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_41D9BD
; ---------------------------------------------------------------------------

loc_41D9B8:				; CODE XREF: sub_41D998+7j
		mov	eax, 0

loc_41D9BD:				; CODE XREF: sub_41D998+1Ej
		pop	ebp
		retn
sub_41D998	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41D9BF	proc near		; CODE XREF: sub_41D9E7+Ep
					; sub_41DC64+13p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 6
		call	sub_41D998
		leave
		retn
sub_41D9BF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41D9DA	proc near		; CODE XREF: sub_41E9ED+290p
					; sub_41E9ED+34Ap ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_41D9DA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41D9E7	proc near		; CODE XREF: sub_41DE26+316p
					; sub_41E9ED+C6Fp ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_41D9BF
		leave
		retn
sub_41D9E7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41D9FC	proc near		; CODE XREF: sub_41DAF2+26p
					; sub_41DAF2+37p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		jmp	short loc_41DA39
; ---------------------------------------------------------------------------

loc_41DA04:				; CODE XREF: sub_41D9FC+41j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_0], eax

loc_41DA39:				; CODE XREF: sub_41D9FC+6j
		cmp	[ebp+arg_0], 0
		jnz	short loc_41DA04
		leave
		retn
sub_41D9FC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41DA41	proc near		; CODE XREF: sub_41DAF2+59p
					; sub_41E9ED+132Dp

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		jmp	short loc_41DA7E
; ---------------------------------------------------------------------------

loc_41DA49:				; CODE XREF: sub_41DA41+41j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_0], eax

loc_41DA7E:				; CODE XREF: sub_41DA41+6j
		cmp	[ebp+arg_0], 0
		jnz	short loc_41DA49
		leave
		retn
sub_41DA41	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41DA86	proc near		; CODE XREF: sub_41DAC9+16p
					; sub_4206B5+18D4p ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_41DAC7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+18h+var_18], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+18h+var_18], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+18h+var_18], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gcry_free

locret_41DAC7:				; CODE XREF: sub_41DA86+Aj
		leave
		retn
sub_41DA86	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41DAC9	proc near		; CODE XREF: sub_41DAF2+6Ap
					; sub_4206B5+198Dp

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		jmp	short loc_41DAEA
; ---------------------------------------------------------------------------

loc_41DAD1:				; CODE XREF: sub_41DAC9+25j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41DA86
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_0], eax

loc_41DAEA:				; CODE XREF: sub_41DAC9+6j
		cmp	[ebp+arg_0], 0
		jnz	short loc_41DAD1
		leave
		retn
sub_41DAC9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41DAF2	proc near		; CODE XREF: sub_4245B2+3D8p
					; DATA XREF: sub_4245B2+35Eo

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	locret_41DB8A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short locret_41DB8A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+28h]
		mov	[esp+18h+var_18], eax
		call	sub_41D9FC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+2Ch]
		mov	[esp+18h+var_18], eax
		call	sub_41D9FC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+30h]
		mov	[esp+18h+var_18], eax
		call	sub_41D9FC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+34h]
		mov	[esp+18h+var_18], eax
		call	sub_41DA41
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+38h]
		mov	[esp+18h+var_18], eax
		call	sub_41DAC9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+20h]
		mov	[esp+18h+var_18], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[esp+18h+var_18], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0

locret_41DB8A:				; CODE XREF: sub_41DAF2+Aj
					; sub_41DAF2+18j
		leave
		retn
sub_41DAF2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41DB8C	proc near		; CODE XREF: sub_41E421+34p
					; sub_41E9ED+66p ...

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= word ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], ax
		movzx	eax, [ebp+var_1C]
		mov	[esp+48h+var_38], 0
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], 0
		mov	dword ptr [esp+48h+var_44], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_40CD52
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41DBFC
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		movzx	edx, [ebp+var_1C]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], edx
		mov	eax, dword ptr [ebp+arg_8]
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aErrorSelecti_2 ; "error selecting %s (0x%04X): %s\n"
		call	sub_43CB21
		mov	eax, [ebp+var_C]
		jmp	short locret_41DC62
; ---------------------------------------------------------------------------

loc_41DBFC:				; CODE XREF: sub_41DB8C+3Fj
		mov	eax, [ebp+arg_10]
		mov	[esp+48h+var_38], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], 0
		mov	dword ptr [esp+48h+var_44], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_40DC72
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41DC5D
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		movzx	edx, [ebp+var_1C]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], edx
		mov	eax, dword ptr [ebp+arg_8]
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aErrorReadingS0 ; "error reading %s (0x%04X): %s\n"
		call	sub_43CB21
		mov	eax, [ebp+var_C]
		jmp	short locret_41DC62
; ---------------------------------------------------------------------------

loc_41DC5D:				; CODE XREF: sub_41DB8C+A0j
		mov	eax, 0

locret_41DC62:				; CODE XREF: sub_41DB8C+6Ej
					; sub_41DB8C+CFj
		leave
		retn
sub_41DB8C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41DC64	proc near		; CODE XREF: sub_422BE2+A4p
					; sub_4230B6+1CAp ...

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_8], 0
		jnz	short loc_41DC81
		mov	[esp+38h+var_38], 37h
		call	sub_41D9BF
		jmp	locret_41DE24
; ---------------------------------------------------------------------------

loc_41DC81:				; CODE XREF: sub_41DC64+Aj
		cmp	[ebp+arg_8], 0
		jz	short loc_41DC9F
		mov	eax, [ebp+arg_4]
		movzx	eax, word ptr [eax]
		cmp	ax, 3F00h
		jz	short loc_41DC9F
		mov	[esp+38h+var_38], offset aWarningRelativ ; "WARNING: relative path selection not ye"...
		call	sub_43CBBE

loc_41DC9F:				; CODE XREF: sub_41DC64+21j
					; sub_41DC64+2Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+8]
		test	eax, eax
		jz	loc_41DD51
		mov	eax, [ebp+arg_8]
		lea	ecx, [eax-1]
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+38h+var_28], 0
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], ecx
		mov	dword ptr [esp+38h+var_34], edx	; char
		mov	[esp+38h+var_38], eax
		call	sub_40CE0F
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	loc_41DE1F
		mov	[esp+38h+var_38], offset aErrorSelecti_3 ; "error selecting path "
		call	sub_43CB21
		mov	[ebp+var_10], 0
		jmp	short loc_41DD26
; ---------------------------------------------------------------------------

loc_41DD04:				; CODE XREF: sub_41DC64+C8j
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+arg_4]
		movzx	eax, word ptr [eax]
		movzx	eax, ax
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset a04hx ; "%04hX"
		call	sub_43CBE8
		add	[ebp+var_10], 1

loc_41DD26:				; CODE XREF: sub_41DC64+9Ej
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jb	short loc_41DD04
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aS_2 ;	": %s\n"
		call	sub_43CBE8
		mov	eax, [ebp+var_14]
		jmp	locret_41DE24
; ---------------------------------------------------------------------------

loc_41DD51:				; CODE XREF: sub_41DC64+46j
		mov	dword ptr [ebp+var_C], 0
		jmp	loc_41DE13
; ---------------------------------------------------------------------------

loc_41DD5D:				; CODE XREF: sub_41DC64+1B5j
		mov	eax, dword ptr [ebp+var_C]
		add	eax, 1
		cmp	eax, [ebp+arg_8]
		setnz	al
		movzx	ecx, al
		mov	eax, dword ptr [ebp+var_C]
		add	eax, eax
		add	eax, [ebp+arg_4]
		movzx	eax, word ptr [eax]
		movzx	edx, ax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+38h+var_28], 0
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], ecx
		mov	dword ptr [esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		call	sub_40CD52
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_41DE0F
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aErrorSelecti_4 ; "error selecting part %d from path "
		call	sub_43CB21
		mov	[ebp+var_10], 0
		jmp	short loc_41DDE7
; ---------------------------------------------------------------------------

loc_41DDC5:				; CODE XREF: sub_41DC64+189j
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+arg_4]
		movzx	eax, word ptr [eax]
		movzx	eax, ax
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset a04hx ; "%04hX"
		call	sub_43CBE8
		add	[ebp+var_10], 1

loc_41DDE7:				; CODE XREF: sub_41DC64+15Fj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jb	short loc_41DDC5
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_38], eax
		call	gpg_strerror
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aS_2 ;	": %s\n"
		call	sub_43CBE8
		mov	eax, [ebp+var_14]
		jmp	short locret_41DE24
; ---------------------------------------------------------------------------

loc_41DE0F:				; CODE XREF: sub_41DC64+143j
		add	dword ptr [ebp+var_C], 1

loc_41DE13:				; CODE XREF: sub_41DC64+F4j
		mov	eax, dword ptr [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jb	loc_41DD5D

loc_41DE1F:				; CODE XREF: sub_41DC64+85j
		mov	eax, 0

locret_41DE24:				; CODE XREF: sub_41DC64+18j
					; sub_41DC64+E8j ...
		leave
		retn
sub_41DC64	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41DE26(int, char *Str1, int, int)
sub_41DE26	proc near		; CODE XREF: sub_41E21E+21p
					; sub_41E373+21p

Dest		= dword	ptr -48h
Format		= dword	ptr -44h
MaxCount	= dword	ptr -40h
var_2C		= dword	ptr -2Ch
Str2		= byte ptr -22h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Str1		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax]
		test	ax, ax
		jz	short loc_41DE73
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax]
		movzx	edx, ax
		mov	eax, offset aP1504hx_ ;	"P15-%04hX."
		mov	[esp+48h+MaxCount], edx
		mov	[esp+48h+Format], eax ;	Format
		lea	eax, [ebp+Str2]
		mov	[esp+48h+Dest],	eax ; Dest
		call	sprintf
		jmp	short loc_41DE86
; ---------------------------------------------------------------------------

loc_41DE73:				; CODE XREF: sub_41DE26+25j
		mov	edx, offset aP15_ ; "P15."
		lea	eax, [ebp+Str2]
		mov	ecx, [edx]
		mov	[eax], ecx
		movzx	edx, byte ptr [edx+4]
		mov	[eax+4], dl

loc_41DE86:				; CODE XREF: sub_41DE26+4Bj
		lea	eax, [ebp+Str2]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+48h+MaxCount], eax	; MaxCount
		lea	eax, [ebp+Str2]
		mov	[esp+48h+Format], eax ;	Str2
		mov	eax, [ebp+Str1]
		mov	[esp+48h+Dest],	eax ; Str1
		call	strncmp
		test	eax, eax
		jz	loc_41E080
		mov	[esp+48h+MaxCount], 4 ;	MaxCount
		mov	[esp+48h+Format], offset aP15_ ; "P15."
		mov	eax, [ebp+Str1]
		mov	[esp+48h+Dest],	eax ; Str1
		call	strncmp
		test	eax, eax
		jz	loc_41E05E
		mov	[esp+48h+MaxCount], 4 ;	MaxCount
		mov	[esp+48h+Format], offset aP15_0	; "P15-"
		mov	eax, [ebp+Str1]
		mov	[esp+48h+Dest],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	loc_41E06F
		mov	eax, [ebp+Str1]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41DF23
		mov	eax, [ebp+Str1]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41DF5F

loc_41DF23:				; CODE XREF: sub_41DE26+EEj
		mov	eax, [ebp+Str1]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41DF3D
		mov	eax, [ebp+Str1]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41DF5F

loc_41DF3D:				; CODE XREF: sub_41DE26+108j
		mov	eax, [ebp+Str1]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	loc_41E06F
		mov	eax, [ebp+Str1]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	loc_41E06F

loc_41DF5F:				; CODE XREF: sub_41DE26+FBj
					; sub_41DE26+115j
		mov	eax, [ebp+Str1]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41DF79
		mov	eax, [ebp+Str1]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41DFB5

loc_41DF79:				; CODE XREF: sub_41DE26+144j
		mov	eax, [ebp+Str1]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41DF93
		mov	eax, [ebp+Str1]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41DFB5

loc_41DF93:				; CODE XREF: sub_41DE26+15Ej
		mov	eax, [ebp+Str1]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	loc_41E06F
		mov	eax, [ebp+Str1]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	loc_41E06F

loc_41DFB5:				; CODE XREF: sub_41DE26+151j
					; sub_41DE26+16Bj
		mov	eax, [ebp+Str1]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41DFCF
		mov	eax, [ebp+Str1]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41E003

loc_41DFCF:				; CODE XREF: sub_41DE26+19Aj
		mov	eax, [ebp+Str1]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41DFE9
		mov	eax, [ebp+Str1]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41E003

loc_41DFE9:				; CODE XREF: sub_41DE26+1B4j
		mov	eax, [ebp+Str1]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_41E06F
		mov	eax, [ebp+Str1]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_41E06F

loc_41E003:				; CODE XREF: sub_41DE26+1A7j
					; sub_41DE26+1C1j
		mov	eax, [ebp+Str1]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41E01D
		mov	eax, [ebp+Str1]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41E051

loc_41E01D:				; CODE XREF: sub_41DE26+1E8j
		mov	eax, [ebp+Str1]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41E037
		mov	eax, [ebp+Str1]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41E051

loc_41E037:				; CODE XREF: sub_41DE26+202j
		mov	eax, [ebp+Str1]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_41E06F
		mov	eax, [ebp+Str1]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_41E06F

loc_41E051:				; CODE XREF: sub_41DE26+1F5j
					; sub_41DE26+20Fj
		mov	eax, [ebp+Str1]
		add	eax, 8
		movzx	eax, byte ptr [eax]
		cmp	al, 2Eh
		jnz	short loc_41E06F

loc_41E05E:				; CODE XREF: sub_41DE26+BAj
		mov	[esp+48h+Dest],	1Bh
		call	sub_41D9BF
		jmp	loc_41E218
; ---------------------------------------------------------------------------

loc_41E06F:				; CODE XREF: sub_41DE26+DDj
					; sub_41DE26+122j ...
		mov	[esp+48h+Dest],	76h
		call	sub_41D9BF
		jmp	loc_41E218
; ---------------------------------------------------------------------------

loc_41E080:				; CODE XREF: sub_41DE26+97j
		lea	eax, [ebp+Str2]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+Str1], eax
		mov	eax, [ebp+Str1]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	short loc_41E0B9
; ---------------------------------------------------------------------------

loc_41E0B1:				; CODE XREF: sub_41DE26+2A5j
					; sub_41DE26+2B9j ...
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_41E0B9:				; CODE XREF: sub_41DE26+289j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_41E0CD
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_41E0B1

loc_41E0CD:				; CODE XREF: sub_41DE26+29Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41E0E1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_41E0B1

loc_41E0E1:				; CODE XREF: sub_41DE26+2AFj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_41E0F5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	short loc_41E0B1

loc_41E0F5:				; CODE XREF: sub_41DE26+2C3j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41E10F
		cmp	[ebp+var_10], 0
		jz	short loc_41E10F
		mov	eax, [ebp+var_10]
		and	eax, 1
		test	al, al
		jz	short loc_41E120

loc_41E10F:				; CODE XREF: sub_41DE26+2D7j
					; sub_41DE26+2DDj
		mov	[esp+48h+Dest],	76h
		call	sub_41D9BF
		jmp	loc_41E218
; ---------------------------------------------------------------------------

loc_41E120:				; CODE XREF: sub_41DE26+2E7j
		mov	eax, [ebp+var_10]
		shr	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Dest],	eax
		call	gcry_malloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_41E146
		call	sub_41D9E7
		jmp	loc_41E218
; ---------------------------------------------------------------------------

loc_41E146:				; CODE XREF: sub_41DE26+314j
		mov	eax, [ebp+Str1]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	loc_41E1F7
; ---------------------------------------------------------------------------

loc_41E158:				; CODE XREF: sub_41DE26+3D7j
		mov	eax, [ebp+var_14]
		mov	ecx, eax
		add	ecx, [ebp+var_18]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41E17D
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_41E1A9
; ---------------------------------------------------------------------------

loc_41E17D:				; CODE XREF: sub_41DE26+342j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41E198
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_41E1A7
; ---------------------------------------------------------------------------

loc_41E198:				; CODE XREF: sub_41DE26+35Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_41E1A7:				; CODE XREF: sub_41DE26+370j
		mov	edx, eax

loc_41E1A9:				; CODE XREF: sub_41DE26+355j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_41E1C4
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_41E1EB
; ---------------------------------------------------------------------------

loc_41E1C4:				; CODE XREF: sub_41DE26+38Ej
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41E1DF
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_41E1EB
; ---------------------------------------------------------------------------

loc_41E1DF:				; CODE XREF: sub_41DE26+3A9j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_41E1EB:				; CODE XREF: sub_41DE26+39Cj
					; sub_41DE26+3B7j
		add	eax, edx
		mov	[ecx], al
		add	[ebp+var_14], 1
		add	[ebp+var_C], 2

loc_41E1F7:				; CODE XREF: sub_41DE26+32Dj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_10]
		jb	loc_41E158
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_18]
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, 0

loc_41E218:				; CODE XREF: sub_41DE26+244j
					; sub_41DE26+255j ...
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_41DE26	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41E21E(int, char *Str1, int)
sub_41E21E	proc near		; CODE XREF: sub_423054+2Cp

Buf1		= dword	ptr -28h
Buf2		= dword	ptr -24h
Size		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Str1		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_1C], eax ;	int
		lea	eax, [ebp+var_18]
		mov	[esp+28h+Size],	eax ; int
		mov	eax, [ebp+Str1]
		mov	[esp+28h+Buf2],	eax ; Str1
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Buf1],	eax ; int
		call	sub_41DE26
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41E255
		mov	eax, [ebp+var_10]
		jmp	locret_41E371
; ---------------------------------------------------------------------------

loc_41E255:				; CODE XREF: sub_41E21E+2Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+28h]
		mov	[ebp+var_C], eax
		jmp	short loc_41E298
; ---------------------------------------------------------------------------

loc_41E263:				; CODE XREF: sub_41E21E+7Ej
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_14]
		cmp	edx, eax
		jnz	short loc_41E290
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Buf2],	edx ; Buf2
		mov	[esp+28h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_41E2A0

loc_41E290:				; CODE XREF: sub_41E21E+50j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_41E298:				; CODE XREF: sub_41E21E+43j
		cmp	[ebp+var_C], 0
		jnz	short loc_41E263
		jmp	short loc_41E2A1
; ---------------------------------------------------------------------------

loc_41E2A0:				; CODE XREF: sub_41E21E+70j
		nop

loc_41E2A1:				; CODE XREF: sub_41E21E+80j
		cmp	[ebp+var_C], 0
		jnz	short loc_41E2F3
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+2Ch]
		mov	[ebp+var_C], eax
		jmp	short loc_41E2EA
; ---------------------------------------------------------------------------

loc_41E2B5:				; CODE XREF: sub_41E21E+D0j
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_14]
		cmp	edx, eax
		jnz	short loc_41E2E2
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Buf2],	edx ; Buf2
		mov	[esp+28h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_41E2F2

loc_41E2E2:				; CODE XREF: sub_41E21E+A2j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_41E2EA:				; CODE XREF: sub_41E21E+95j
		cmp	[ebp+var_C], 0
		jnz	short loc_41E2B5
		jmp	short loc_41E2F3
; ---------------------------------------------------------------------------

loc_41E2F2:				; CODE XREF: sub_41E21E+C2j
		nop

loc_41E2F3:				; CODE XREF: sub_41E21E+87j
					; sub_41E21E+D2j
		cmp	[ebp+var_C], 0
		jnz	short loc_41E345
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+30h]
		mov	[ebp+var_C], eax
		jmp	short loc_41E33C
; ---------------------------------------------------------------------------

loc_41E307:				; CODE XREF: sub_41E21E+122j
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_14]
		cmp	edx, eax
		jnz	short loc_41E334
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Buf2],	edx ; Buf2
		mov	[esp+28h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_41E344

loc_41E334:				; CODE XREF: sub_41E21E+F4j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_41E33C:				; CODE XREF: sub_41E21E+E7j
		cmp	[ebp+var_C], 0
		jnz	short loc_41E307
		jmp	short loc_41E345
; ---------------------------------------------------------------------------

loc_41E344:				; CODE XREF: sub_41E21E+114j
		nop

loc_41E345:				; CODE XREF: sub_41E21E+D9j
					; sub_41E21E+124j
		mov	eax, [ebp+var_18]
		mov	[esp+28h+Buf1],	eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jnz	short loc_41E364
		mov	[esp+28h+Buf1],	1Bh
		call	sub_41D9BF
		jmp	short locret_41E371
; ---------------------------------------------------------------------------

loc_41E364:				; CODE XREF: sub_41E21E+136j
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, 0

locret_41E371:				; CODE XREF: sub_41E21E+32j
					; sub_41E21E+144j
		leave
		retn
sub_41E21E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41E373(int, char *Str1, int)
sub_41E373	proc near		; CODE XREF: sub_42371E+77p
					; sub_4242C6+3Bp

Buf1		= dword	ptr -28h
Buf2		= dword	ptr -24h
Size		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Str1		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_1C], eax ;	int
		lea	eax, [ebp+var_18]
		mov	[esp+28h+Size],	eax ; int
		mov	eax, [ebp+Str1]
		mov	[esp+28h+Buf2],	eax ; Str1
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Buf1],	eax ; int
		call	sub_41DE26
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41E3A7
		mov	eax, [ebp+var_10]
		jmp	short locret_41E41F
; ---------------------------------------------------------------------------

loc_41E3A7:				; CODE XREF: sub_41E373+2Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+34h]
		mov	[ebp+var_C], eax
		jmp	short loc_41E3EA
; ---------------------------------------------------------------------------

loc_41E3B5:				; CODE XREF: sub_41E373+7Bj
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_14]
		cmp	edx, eax
		jnz	short loc_41E3E2
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Buf2],	edx ; Buf2
		mov	[esp+28h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_41E3F2

loc_41E3E2:				; CODE XREF: sub_41E373+4Dj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_41E3EA:				; CODE XREF: sub_41E373+40j
		cmp	[ebp+var_C], 0
		jnz	short loc_41E3B5
		jmp	short loc_41E3F3
; ---------------------------------------------------------------------------

loc_41E3F2:				; CODE XREF: sub_41E373+6Dj
		nop

loc_41E3F3:				; CODE XREF: sub_41E373+7Dj
		mov	eax, [ebp+var_18]
		mov	[esp+28h+Buf1],	eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jnz	short loc_41E412
		mov	[esp+28h+Buf1],	1Bh
		call	sub_41D9BF
		jmp	short locret_41E41F
; ---------------------------------------------------------------------------

loc_41E412:				; CODE XREF: sub_41E373+8Fj
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, 0

locret_41E41F:				; CODE XREF: sub_41E373+32j
					; sub_41E373+9Dj
		leave
		retn
sub_41E373	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E421	proc near		; CODE XREF: sub_422340+8Ep

Buf1		= dword	ptr -58h
Buf2		= dword	ptr -54h
Size		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= word ptr -2Ch
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_E		= word ptr -0Eh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], ax
		movzx	edx, [ebp+var_2C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	ecx, [ebp+var_20]
		mov	[esp+58h+var_48], ecx
		lea	ecx, [ebp+var_1C]
		mov	[esp+58h+var_4C], ecx
		mov	[esp+58h+Size],	offset aOdf ; "ODF"
		mov	[esp+58h+Buf2],	edx ; char
		mov	[esp+58h+Buf1],	eax
		call	sub_41DB8C
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_41E46B
		mov	eax, [ebp+var_18]
		jmp	locret_41E7CF
; ---------------------------------------------------------------------------

loc_41E46B:				; CODE XREF: sub_41E421+40j
		mov	eax, dword ptr [ebp+var_20]
		cmp	eax, 7
		ja	short loc_41E49B
		mov	[esp+58h+Buf1],	offset aErrorOdfTooSho ; "error: ODF too short\n"
		call	sub_43CB21
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Buf1],	eax
		call	gcry_free
		mov	[esp+58h+Buf1],	41h
		call	sub_41D9BF
		jmp	locret_41E7CF
; ---------------------------------------------------------------------------

loc_41E49B:				; CODE XREF: sub_41E421+50j
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax
		jmp	loc_41E783
; ---------------------------------------------------------------------------

loc_41E4A6:				; CODE XREF: sub_41E421+37Bj
		mov	eax, dword ptr [ebp+var_20]
		cmp	eax, 7
		jbe	short loc_41E4F1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F0h
		cmp	eax, 0A0h
		jnz	short loc_41E4F1
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+58h+Size],	5 ; Size
		mov	[esp+58h+Buf2],	offset word_44C22E ; Buf2
		mov	[esp+58h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_41E4F1
		mov	[ebp+var_14], 6
		jmp	loc_41E590
; ---------------------------------------------------------------------------

loc_41E4F1:				; CODE XREF: sub_41E421+8Bj
					; sub_41E421+A0j ...
		mov	eax, dword ptr [ebp+var_20]
		cmp	eax, 0Bh
		jbe	short loc_41E568
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F0h
		cmp	eax, 0A0h
		jnz	short loc_41E568
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+58h+Size],	7 ; Size
		mov	[esp+58h+Buf2],	offset dword_44C234 ; Buf2
		mov	[esp+58h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_41E568
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax]
		movzx	eax, ax
		mov	edx, [ebp+var_C]
		add	edx, 8
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		mov	ecx, edx
		shl	ecx, 8
		mov	edx, [ebp+var_C]
		add	edx, 9
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		or	edx, ecx
		cmp	eax, edx
		jnz	short loc_41E568
		mov	[ebp+var_14], 0Ah
		jmp	short loc_41E590
; ---------------------------------------------------------------------------

loc_41E568:				; CODE XREF: sub_41E421+D6j
					; sub_41E421+EBj ...
		mov	[esp+58h+Buf1],	offset aOdfFormatIsNot ; "ODF format is	not supported by us\n"
		call	sub_43CB21
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Buf1],	eax
		call	gcry_free
		mov	[esp+58h+Buf1],	41h
		call	sub_41D9BF
		jmp	locret_41E7CF
; ---------------------------------------------------------------------------

loc_41E590:				; CODE XREF: sub_41E421+CBj
					; sub_41E421+145j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 8		; switch 9 cases
		ja	loc_41E641	; jumptable 0041E5AC default case
		mov	eax, ds:off_44C2EC[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41E5AE:				; CODE XREF: sub_41E421+18Bj
					; DATA XREF: .rdata:off_44C2ECo
		mov	eax, [ebp+arg_0] ; jumptable 0041E5AC case 0
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+0Ch]
		mov	[ebp+var_E], ax
		jmp	loc_41E648
; ---------------------------------------------------------------------------

loc_41E5C1:				; CODE XREF: sub_41E421+18Bj
					; DATA XREF: .rdata:off_44C2ECo
		mov	eax, [ebp+arg_0] ; jumptable 0041E5AC case 1
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+0Eh]
		mov	[ebp+var_E], ax
		jmp	short loc_41E648
; ---------------------------------------------------------------------------

loc_41E5D1:				; CODE XREF: sub_41E421+18Bj
					; DATA XREF: .rdata:off_44C2ECo
		mov	eax, [ebp+arg_0] ; jumptable 0041E5AC case 2
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+10h]
		mov	[ebp+var_E], ax
		jmp	short loc_41E648
; ---------------------------------------------------------------------------

loc_41E5E1:				; CODE XREF: sub_41E421+18Bj
					; DATA XREF: .rdata:off_44C2ECo
		mov	eax, [ebp+arg_0] ; jumptable 0041E5AC case 3
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+12h]
		mov	[ebp+var_E], ax
		jmp	short loc_41E648
; ---------------------------------------------------------------------------

loc_41E5F1:				; CODE XREF: sub_41E421+18Bj
					; DATA XREF: .rdata:off_44C2ECo
		mov	eax, [ebp+arg_0] ; jumptable 0041E5AC case 4
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+14h]
		mov	[ebp+var_E], ax
		jmp	short loc_41E648
; ---------------------------------------------------------------------------

loc_41E601:				; CODE XREF: sub_41E421+18Bj
					; DATA XREF: .rdata:off_44C2ECo
		mov	eax, [ebp+arg_0] ; jumptable 0041E5AC case 5
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+16h]
		mov	[ebp+var_E], ax
		jmp	short loc_41E648
; ---------------------------------------------------------------------------

loc_41E611:				; CODE XREF: sub_41E421+18Bj
					; DATA XREF: .rdata:off_44C2ECo
		mov	eax, [ebp+arg_0] ; jumptable 0041E5AC case 6
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+18h]
		mov	[ebp+var_E], ax
		jmp	short loc_41E648
; ---------------------------------------------------------------------------

loc_41E621:				; CODE XREF: sub_41E421+18Bj
					; DATA XREF: .rdata:off_44C2ECo
		mov	eax, [ebp+arg_0] ; jumptable 0041E5AC case 7
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+1Ah]
		mov	[ebp+var_E], ax
		jmp	short loc_41E648
; ---------------------------------------------------------------------------

loc_41E631:				; CODE XREF: sub_41E421+18Bj
					; DATA XREF: .rdata:off_44C2ECo
		mov	eax, [ebp+arg_0] ; jumptable 0041E5AC case 8
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+1Ch]
		mov	[ebp+var_E], ax
		jmp	short loc_41E648
; ---------------------------------------------------------------------------

loc_41E641:				; CODE XREF: sub_41E421+17Ej
		mov	[ebp+var_E], 0	; jumptable 0041E5AC default case
		nop

loc_41E648:				; CODE XREF: sub_41E421+19Bj
					; sub_41E421+1AEj ...
		cmp	[ebp+var_E], 0
		jz	short loc_41E670
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		mov	[esp+58h+Buf2],	eax ; char
		mov	[esp+58h+Buf1],	offset aDuplicateObjec ; "duplicate object type	%d in ODF ignored"...
		call	sub_43CB21
		jmp	loc_41E783
; ---------------------------------------------------------------------------

loc_41E670:				; CODE XREF: sub_41E421+22Cj
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_C]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 8
		mov	edx, eax
		mov	eax, [ebp+var_14]
		add	eax, 1
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, edx
		mov	[ebp+var_E], ax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 8		; switch 9 cases
		ja	loc_41E74C	; jumptable 0041E6B4 default case
		mov	eax, ds:off_44C310[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41E6B6:				; CODE XREF: sub_41E421+293j
					; DATA XREF: .rdata:off_44C310o
		mov	eax, [ebp+arg_0] ; jumptable 0041E6B4 case 0
		mov	eax, [eax+1Ch]
		movzx	edx, [ebp+var_E]
		mov	[eax+0Ch], dx
		jmp	loc_41E768
; ---------------------------------------------------------------------------

loc_41E6C9:				; CODE XREF: sub_41E421+293j
					; DATA XREF: .rdata:off_44C310o
		mov	eax, [ebp+arg_0] ; jumptable 0041E6B4 case 1
		mov	eax, [eax+1Ch]
		movzx	edx, [ebp+var_E]
		mov	[eax+0Eh], dx
		jmp	loc_41E768
; ---------------------------------------------------------------------------

loc_41E6DC:				; CODE XREF: sub_41E421+293j
					; DATA XREF: .rdata:off_44C310o
		mov	eax, [ebp+arg_0] ; jumptable 0041E6B4 case 2
		mov	eax, [eax+1Ch]
		movzx	edx, [ebp+var_E]
		mov	[eax+10h], dx
		jmp	short loc_41E768
; ---------------------------------------------------------------------------

loc_41E6EC:				; CODE XREF: sub_41E421+293j
					; DATA XREF: .rdata:off_44C310o
		mov	eax, [ebp+arg_0] ; jumptable 0041E6B4 case 3
		mov	eax, [eax+1Ch]
		movzx	edx, [ebp+var_E]
		mov	[eax+12h], dx
		jmp	short loc_41E768
; ---------------------------------------------------------------------------

loc_41E6FC:				; CODE XREF: sub_41E421+293j
					; DATA XREF: .rdata:off_44C310o
		mov	eax, [ebp+arg_0] ; jumptable 0041E6B4 case 4
		mov	eax, [eax+1Ch]
		movzx	edx, [ebp+var_E]
		mov	[eax+14h], dx
		jmp	short loc_41E768
; ---------------------------------------------------------------------------

loc_41E70C:				; CODE XREF: sub_41E421+293j
					; DATA XREF: .rdata:off_44C310o
		mov	eax, [ebp+arg_0] ; jumptable 0041E6B4 case 5
		mov	eax, [eax+1Ch]
		movzx	edx, [ebp+var_E]
		mov	[eax+16h], dx
		jmp	short loc_41E768
; ---------------------------------------------------------------------------

loc_41E71C:				; CODE XREF: sub_41E421+293j
					; DATA XREF: .rdata:off_44C310o
		mov	eax, [ebp+arg_0] ; jumptable 0041E6B4 case 6
		mov	eax, [eax+1Ch]
		movzx	edx, [ebp+var_E]
		mov	[eax+18h], dx
		jmp	short loc_41E768
; ---------------------------------------------------------------------------

loc_41E72C:				; CODE XREF: sub_41E421+293j
					; DATA XREF: .rdata:off_44C310o
		mov	eax, [ebp+arg_0] ; jumptable 0041E6B4 case 7
		mov	eax, [eax+1Ch]
		movzx	edx, [ebp+var_E]
		mov	[eax+1Ah], dx
		jmp	short loc_41E768
; ---------------------------------------------------------------------------

loc_41E73C:				; CODE XREF: sub_41E421+293j
					; DATA XREF: .rdata:off_44C310o
		mov	eax, [ebp+arg_0] ; jumptable 0041E6B4 case 8
		mov	eax, [eax+1Ch]
		movzx	edx, [ebp+var_E]
		mov	[eax+1Ch], dx
		jmp	short loc_41E768
; ---------------------------------------------------------------------------

loc_41E74C:				; CODE XREF: sub_41E421+286j
		mov	eax, [ebp+var_C] ; jumptable 0041E6B4 default case
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		mov	[esp+58h+Buf2],	eax ; char
		mov	[esp+58h+Buf1],	offset aUnknownObjectT ; "unknown object type %d in ODF	ignored\n"
		call	sub_43CB21

loc_41E768:				; CODE XREF: sub_41E421+2A3j
					; sub_41E421+2B6j ...
		add	[ebp+var_14], 2
		mov	eax, dword ptr [ebp+var_20]
		cmp	eax, [ebp+var_14]
		jb	short loc_41E7A4
		mov	eax, [ebp+var_14]
		add	[ebp+var_C], eax
		mov	eax, dword ptr [ebp+var_20]
		sub	eax, [ebp+var_14]
		mov	dword ptr [ebp+var_20],	eax

loc_41E783:				; CODE XREF: sub_41E421+80j
					; sub_41E421+24Aj
		mov	eax, dword ptr [ebp+var_20]
		test	eax, eax
		jz	short loc_41E7A5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41E7A5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FFh
		jnz	loc_41E4A6
		jmp	short loc_41E7A5
; ---------------------------------------------------------------------------

loc_41E7A4:				; CODE XREF: sub_41E421+351j
		nop

loc_41E7A5:				; CODE XREF: sub_41E421+367j
					; sub_41E421+371j ...
		mov	eax, dword ptr [ebp+var_20]
		test	eax, eax
		jz	short loc_41E7BF
		mov	eax, dword ptr [ebp+var_20]
		mov	[esp+58h+Buf2],	eax ; char
		mov	[esp+58h+Buf1],	offset aWarningUBytesO ; "warning: %u bytes of garbage detected	a"...
		call	sub_43CAF7

loc_41E7BF:				; CODE XREF: sub_41E421+389j
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+Buf1],	eax
		call	gcry_free
		mov	eax, 0

locret_41E7CF:				; CODE XREF: sub_41E421+45j
					; sub_41E421+75j ...
		leave
		retn
sub_41E421	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E7D1	proc near		; CODE XREF: sub_41E9ED+63Ep

var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_4], 0
		jnz	short loc_41E7F7
		mov	[esp+24h+var_24], 41h
		call	sub_41D9BF
		jmp	locret_41E9EB
; ---------------------------------------------------------------------------

loc_41E7F7:				; CODE XREF: sub_41E7D1+13j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_10], eax
		add	[ebp+arg_0], 1
		sub	[ebp+arg_4], 1
		cmp	[ebp+arg_4], 0
		jnz	short loc_41E817
		cmp	[ebp+var_10], 0
		jnz	short loc_41E82A

loc_41E817:				; CODE XREF: sub_41E7D1+3Ej
		mov	eax, [ebp+var_10]
		lea	edx, [eax+7]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 3
		cmp	eax, [ebp+arg_4]
		jbe	short loc_41E83B

loc_41E82A:				; CODE XREF: sub_41E7D1+44j
		mov	[esp+24h+var_24], 9Bh
		call	sub_41D9BF
		jmp	locret_41E9EB
; ---------------------------------------------------------------------------

loc_41E83B:				; CODE XREF: sub_41E7D1+57j
		mov	eax, [ebp+var_10]
		add	eax, 7
		lea	edx, [eax+7]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 3
		mov	edx, [ebp+arg_4]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	edx, eax
		sar	edx, 1Fh
		shr	edx, 1Dh
		add	eax, edx
		and	eax, 7
		sub	eax, edx
		mov	[ebp+var_10], eax
		mov	[ebp+var_8], 0
		mov	[ebp+var_C], 1
		jmp	short loc_41E88A
; ---------------------------------------------------------------------------

loc_41E87D:				; CODE XREF: sub_41E7D1+BDj
		mov	eax, [ebp+var_C]
		or	[ebp+var_8], eax
		shl	[ebp+var_C], 1
		sub	[ebp+var_10], 1

loc_41E88A:				; CODE XREF: sub_41E7D1+AAj
		cmp	[ebp+var_10], 0
		jnz	short loc_41E87D
		cmp	[ebp+arg_4], 0
		jz	short loc_41E8C7
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_4], eax
		add	[ebp+arg_0], 1
		sub	[ebp+arg_4], 1
		cmp	[ebp+var_14], 0
		jz	short loc_41E8B6
		sub	[ebp+var_14], 1
		jmp	short loc_41E8CE
; ---------------------------------------------------------------------------

loc_41E8B6:				; CODE XREF: sub_41E7D1+DDj
		mov	eax, [ebp+var_8]
		not	eax
		and	[ebp+var_4], eax
		mov	[ebp+var_8], 0
		jmp	short loc_41E8CE
; ---------------------------------------------------------------------------

loc_41E8C7:				; CODE XREF: sub_41E7D1+C3j
		mov	[ebp+var_4], 0

loc_41E8CE:				; CODE XREF: sub_41E7D1+E3j
					; sub_41E7D1+F4j
		mov	eax, [ebp+var_4]
		and	eax, 80h
		test	eax, eax
		jz	short loc_41E8E5
		mov	eax, [ebp+arg_8]
		movzx	edx, byte ptr [eax]
		or	edx, 1
		mov	[eax], dl

loc_41E8E5:				; CODE XREF: sub_41E7D1+107j
		mov	eax, [ebp+var_4]
		and	eax, 40h
		test	eax, eax
		jz	short loc_41E8FA
		mov	eax, [ebp+arg_8]
		movzx	edx, byte ptr [eax]
		or	edx, 2
		mov	[eax], dl

loc_41E8FA:				; CODE XREF: sub_41E7D1+11Cj
		mov	eax, [ebp+var_4]
		and	eax, 20h
		test	eax, eax
		jz	short loc_41E90F
		mov	eax, [ebp+arg_8]
		movzx	edx, byte ptr [eax]
		or	edx, 4
		mov	[eax], dl

loc_41E90F:				; CODE XREF: sub_41E7D1+131j
		mov	eax, [ebp+var_4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_41E924
		mov	eax, [ebp+arg_8]
		movzx	edx, byte ptr [eax]
		or	edx, 8
		mov	[eax], dl

loc_41E924:				; CODE XREF: sub_41E7D1+146j
		mov	eax, [ebp+var_4]
		and	eax, 8
		test	eax, eax
		jz	short loc_41E939
		mov	eax, [ebp+arg_8]
		movzx	edx, byte ptr [eax]
		or	edx, 10h
		mov	[eax], dl

loc_41E939:				; CODE XREF: sub_41E7D1+15Bj
		mov	eax, [ebp+var_4]
		and	eax, 4
		test	eax, eax
		jz	short loc_41E94E
		mov	eax, [ebp+arg_8]
		movzx	edx, byte ptr [eax]
		or	edx, 20h
		mov	[eax], dl

loc_41E94E:				; CODE XREF: sub_41E7D1+170j
		mov	eax, [ebp+var_4]
		and	eax, 2
		test	eax, eax
		jz	short loc_41E963
		mov	eax, [ebp+arg_8]
		movzx	edx, byte ptr [eax]
		or	edx, 40h
		mov	[eax], dl

loc_41E963:				; CODE XREF: sub_41E7D1+185j
		mov	eax, [ebp+var_4]
		and	eax, 1
		test	al, al
		jz	short loc_41E978
		mov	eax, [ebp+arg_8]
		movzx	edx, byte ptr [eax]
		or	edx, 0FFFFFF80h
		mov	[eax], dl

loc_41E978:				; CODE XREF: sub_41E7D1+19Aj
		cmp	[ebp+arg_4], 0
		jz	short loc_41E9AF
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_4], eax
		add	[ebp+arg_0], 1
		sub	[ebp+arg_4], 1
		cmp	[ebp+var_14], 0
		jz	short loc_41E99E
		sub	[ebp+var_14], 1
		jmp	short loc_41E9B6
; ---------------------------------------------------------------------------

loc_41E99E:				; CODE XREF: sub_41E7D1+1C5j
		mov	eax, [ebp+var_8]
		not	eax
		and	[ebp+var_4], eax
		mov	[ebp+var_8], 0
		jmp	short loc_41E9B6
; ---------------------------------------------------------------------------

loc_41E9AF:				; CODE XREF: sub_41E7D1+1ABj
		mov	[ebp+var_4], 0

loc_41E9B6:				; CODE XREF: sub_41E7D1+1CBj
					; sub_41E7D1+1DCj
		mov	eax, [ebp+var_4]
		and	eax, 80h
		test	eax, eax
		jz	short loc_41E9CF
		mov	eax, [ebp+arg_8]
		movzx	edx, byte ptr [eax+1]
		or	edx, 1
		mov	[eax+1], dl

loc_41E9CF:				; CODE XREF: sub_41E7D1+1EFj
		mov	eax, [ebp+var_4]
		and	eax, 40h
		test	eax, eax
		jz	short loc_41E9E6
		mov	eax, [ebp+arg_8]
		movzx	edx, byte ptr [eax+1]
		or	edx, 2
		mov	[eax+1], dl

loc_41E9E6:				; CODE XREF: sub_41E7D1+206j
		mov	eax, 0

locret_41E9EB:				; CODE XREF: sub_41E7D1+21j
					; sub_41E7D1+65j
		leave
		retn
sub_41E7D1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41E9ED	proc near		; CODE XREF: sub_422340+241p

Dst		= dword	ptr -0C8h
Src		= dword	ptr -0C4h
Size		= dword	ptr -0C0h
var_BC		= dword	ptr -0BCh
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_8C		= word ptr -8Ch
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= byte ptr -68h
var_64		= byte ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= byte ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= byte ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 0C8h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_8C], ax
		mov	[ebp+var_44], 0
		mov	[ebp+var_10], 0
		cmp	[ebp+var_8C], 0
		jnz	short loc_41EA29
		mov	[esp+0C8h+Dst],	3Ah
		call	sub_41D9BF
		jmp	locret_41FD2C
; ---------------------------------------------------------------------------

loc_41EA29:				; CODE XREF: sub_41E9ED+29j
		movzx	edx, [ebp+var_8C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	ecx, [ebp+var_48]
		mov	[esp+0C8h+var_B8], ecx
		lea	ecx, [ebp+var_44]
		mov	[esp+0C8h+var_BC], ecx
		mov	[esp+0C8h+Size], offset	aPrkdf ; "PrKDF"
		mov	[esp+0C8h+Src],	edx
		mov	[esp+0C8h+Dst],	eax
		call	sub_41DB8C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41EA69
		mov	eax, [ebp+var_C]
		jmp	locret_41FD2C
; ---------------------------------------------------------------------------

loc_41EA69:				; CODE XREF: sub_41E9ED+72j
		mov	eax, [ebp+var_44]
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_48]
		mov	[ebp+var_50], eax
		jmp	loc_41FCE4
; ---------------------------------------------------------------------------

loc_41EA7A:				; CODE XREF: sub_41E9ED+1310j
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 0
		mov	[ebp+var_28], 0
		mov	[ebp+var_2C], 0
		mov	[ebp+var_30], 0
		mov	[ebp+var_34], 0
		mov	[esp+0C8h+var_A8], 6
		lea	eax, [ebp+var_58]
		mov	[esp+0C8h+var_AC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0C8h+var_B0], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0C8h+var_B4], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0C8h+var_B8], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0C8h+var_BC], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0C8h+Size], eax
		lea	eax, [ebp+var_50]
		mov	[esp+0C8h+Src],	eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0C8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41EB12
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_50]
		cmp	edx, eax
		ja	short loc_41EB03
		mov	eax, [ebp+var_60]
		cmp	eax, 10h
		jz	short loc_41EB12

loc_41EB03:				; CODE XREF: sub_41E9ED+10Cj
		mov	[esp+0C8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_41EB12:				; CODE XREF: sub_41E9ED+102j
					; sub_41E9ED+114j
		cmp	[ebp+var_C], 0
		jz	short loc_41EB38
		mov	eax, [ebp+var_C]
		mov	[esp+0C8h+Dst],	eax
		call	gpg_strerror
		mov	[esp+0C8h+Src],	eax ; char
		mov	[esp+0C8h+Dst],	offset aErrorParsingPr ; "error	parsing	PrKDF record: %s\n"
		call	sub_43CB21
		jmp	loc_41FD03
; ---------------------------------------------------------------------------

loc_41EB38:				; CODE XREF: sub_41E9ED+129j
		mov	eax, [ebp+var_4C]
		mov	[ebp+var_6C], eax
		mov	eax, [ebp+var_54]
		mov	[ebp+var_70], eax
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_54]
		add	eax, edx
		mov	[ebp+var_4C], eax
		mov	edx, [ebp+var_50]
		mov	eax, [ebp+var_54]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_50], eax
		mov	dword ptr [ebp+var_18],	36Ah
		mov	[esp+0C8h+var_A8], 6
		lea	eax, [ebp+var_58]
		mov	[esp+0C8h+var_AC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0C8h+var_B0], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0C8h+var_B4], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0C8h+var_B8], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0C8h+var_BC], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0C8h+Size], eax
		lea	eax, [ebp+var_70]
		mov	[esp+0C8h+Src],	eax
		lea	eax, [ebp+var_6C]
		mov	[esp+0C8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41EBD3
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_70]
		cmp	edx, eax
		ja	short loc_41EBC4
		mov	eax, [ebp+var_60]
		cmp	eax, 10h
		jz	short loc_41EBD3

loc_41EBC4:				; CODE XREF: sub_41E9ED+1CDj
		mov	[esp+0C8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_41EBD3:				; CODE XREF: sub_41E9ED+1C3j
					; sub_41E9ED+1D5j
		cmp	[ebp+var_C], 0
		jnz	loc_41FC4F
		mov	eax, [ebp+var_6C]
		mov	[ebp+var_78], eax
		mov	eax, [ebp+var_54]
		mov	[ebp+var_7C], eax
		mov	edx, [ebp+var_6C]
		mov	eax, [ebp+var_54]
		add	eax, edx
		mov	[ebp+var_6C], eax
		mov	edx, [ebp+var_70]
		mov	eax, [ebp+var_54]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_70], eax
		mov	dword ptr [ebp+var_18],	37Bh
		mov	[esp+0C8h+var_A8], 6
		lea	eax, [ebp+var_58]
		mov	[esp+0C8h+var_AC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0C8h+var_B0], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0C8h+var_B4], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0C8h+var_B8], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0C8h+var_BC], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0C8h+Size], eax
		lea	eax, [ebp+var_7C]
		mov	[esp+0C8h+Src],	eax
		lea	eax, [ebp+var_78]
		mov	[esp+0C8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41EC77
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_7C]
		cmp	edx, eax
		ja	short loc_41EC68
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jz	short loc_41EC77

loc_41EC68:				; CODE XREF: sub_41E9ED+272j
		mov	[esp+0C8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_41EC77:				; CODE XREF: sub_41E9ED+268j
					; sub_41E9ED+279j
		mov	eax, [ebp+var_C]
		mov	[esp+0C8h+Dst],	eax
		call	sub_41D9DA
		cmp	eax, 3FFFh
		jz	loc_41EE24
		cmp	[ebp+var_C], 0
		jnz	loc_41FC52
		mov	eax, [ebp+var_60]
		cmp	eax, 0Ch
		jnz	loc_41ED51
		mov	edx, [ebp+var_78]
		mov	eax, [ebp+var_54]
		add	eax, edx
		mov	[ebp+var_78], eax
		mov	edx, [ebp+var_7C]
		mov	eax, [ebp+var_54]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_7C], eax
		mov	dword ptr [ebp+var_18],	389h
		mov	[esp+0C8h+var_A8], 6
		lea	eax, [ebp+var_58]
		mov	[esp+0C8h+var_AC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0C8h+var_B0], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0C8h+var_B4], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0C8h+var_B8], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0C8h+var_BC], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0C8h+Size], eax
		lea	eax, [ebp+var_7C]
		mov	[esp+0C8h+Src],	eax
		lea	eax, [ebp+var_78]
		mov	[esp+0C8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41ED31
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_7C]
		cmp	edx, eax
		ja	short loc_41ED22
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jz	short loc_41ED31

loc_41ED22:				; CODE XREF: sub_41E9ED+32Cj
		mov	[esp+0C8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_41ED31:				; CODE XREF: sub_41E9ED+322j
					; sub_41E9ED+333j
		mov	eax, [ebp+var_C]
		mov	[esp+0C8h+Dst],	eax
		call	sub_41D9DA
		cmp	eax, 3FFFh
		jz	loc_41EE27
		cmp	[ebp+var_C], 0
		jnz	loc_41FC55

loc_41ED51:				; CODE XREF: sub_41E9ED+2B0j
		mov	eax, [ebp+var_60]
		cmp	eax, 3
		jnz	loc_41EE07
		mov	edx, [ebp+var_78]
		mov	eax, [ebp+var_54]
		add	eax, edx
		mov	[ebp+var_78], eax
		mov	edx, [ebp+var_7C]
		mov	eax, [ebp+var_54]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_7C], eax
		mov	dword ptr [ebp+var_18],	398h
		mov	[esp+0C8h+var_A8], 6
		lea	eax, [ebp+var_58]
		mov	[esp+0C8h+var_AC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0C8h+var_B0], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0C8h+var_B4], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0C8h+var_B8], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0C8h+var_BC], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0C8h+Size], eax
		lea	eax, [ebp+var_7C]
		mov	[esp+0C8h+Src],	eax
		lea	eax, [ebp+var_78]
		mov	[esp+0C8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41EDEB
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_7C]
		cmp	edx, eax
		ja	short loc_41EDDC
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jz	short loc_41EDEB

loc_41EDDC:				; CODE XREF: sub_41E9ED+3E6j
		mov	[esp+0C8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_41EDEB:				; CODE XREF: sub_41E9ED+3DCj
					; sub_41E9ED+3EDj
		mov	eax, [ebp+var_C]
		mov	[esp+0C8h+Dst],	eax
		call	sub_41D9DA
		cmp	eax, 3FFFh
		jz	short loc_41EE2A
		cmp	[ebp+var_C], 0
		jnz	loc_41FC58

loc_41EE07:				; CODE XREF: sub_41E9ED+36Aj
		mov	eax, [ebp+var_60]
		cmp	eax, 4
		jnz	short loc_41EE2B
		mov	eax, [ebp+var_54]
		test	eax, eax
		jz	short loc_41EE2B
		mov	eax, [ebp+var_78]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_54]
		mov	[ebp+var_2C], eax
		jmp	short loc_41EE2B
; ---------------------------------------------------------------------------

loc_41EE24:				; CODE XREF: sub_41E9ED+29Aj
		nop
		jmp	short loc_41EE2B
; ---------------------------------------------------------------------------

loc_41EE27:				; CODE XREF: sub_41E9ED+354j
		nop
		jmp	short loc_41EE2B
; ---------------------------------------------------------------------------

loc_41EE2A:				; CODE XREF: sub_41E9ED+40Ej
		nop

loc_41EE2B:				; CODE XREF: sub_41E9ED+420j
					; sub_41E9ED+427j ...
		mov	dword ptr [ebp+var_18],	3ACh
		mov	[esp+0C8h+var_A8], 6
		lea	eax, [ebp+var_58]
		mov	[esp+0C8h+var_AC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0C8h+var_B0], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0C8h+var_B4], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0C8h+var_B8], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0C8h+var_BC], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0C8h+Size], eax
		lea	eax, [ebp+var_70]
		mov	[esp+0C8h+Src],	eax
		lea	eax, [ebp+var_6C]
		mov	[esp+0C8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41EEA0
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_70]
		cmp	edx, eax
		ja	short loc_41EE91
		mov	eax, [ebp+var_60]
		cmp	eax, 10h
		jz	short loc_41EEA0

loc_41EE91:				; CODE XREF: sub_41E9ED+49Aj
		mov	[esp+0C8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_41EEA0:				; CODE XREF: sub_41E9ED+490j
					; sub_41E9ED+4A2j
		cmp	[ebp+var_C], 0
		jnz	loc_41FC5B
		mov	eax, [ebp+var_6C]
		mov	[ebp+var_80], eax
		mov	eax, [ebp+var_54]
		mov	[ebp+var_84], eax
		mov	edx, [ebp+var_6C]
		mov	eax, [ebp+var_54]
		add	eax, edx
		mov	[ebp+var_6C], eax
		mov	edx, [ebp+var_70]
		mov	eax, [ebp+var_54]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_70], eax
		mov	dword ptr [ebp+var_18],	3BBh
		mov	[esp+0C8h+var_A8], 6
		lea	eax, [ebp+var_58]
		mov	[esp+0C8h+var_AC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0C8h+var_B0], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0C8h+var_B4], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0C8h+var_B8], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0C8h+var_BC], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0C8h+Size], eax
		lea	eax, [ebp+var_84]
		mov	[esp+0C8h+Src],	eax
		lea	eax, [ebp+var_80]
		mov	[esp+0C8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41EF55
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_84]
		cmp	edx, eax
		ja	short loc_41EF46
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	short loc_41EF46
		mov	eax, [ebp+var_60]
		cmp	eax, 4
		jz	short loc_41EF55

loc_41EF46:				; CODE XREF: sub_41E9ED+548j
					; sub_41E9ED+54Fj
		mov	[esp+0C8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_41EF55:				; CODE XREF: sub_41E9ED+53Bj
					; sub_41E9ED+557j
		cmp	[ebp+var_C], 0
		jnz	loc_41FC5E
		mov	eax, [ebp+var_80]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_54]
		mov	[ebp+var_40], eax
		mov	edx, [ebp+var_80]
		mov	eax, [ebp+var_54]
		add	eax, edx
		mov	[ebp+var_80], eax
		mov	edx, [ebp+var_84]
		mov	eax, [ebp+var_54]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_84], eax
		mov	dword ptr [ebp+var_18],	3C9h
		mov	[esp+0C8h+var_A8], 6
		lea	eax, [ebp+var_58]
		mov	[esp+0C8h+var_AC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0C8h+var_B0], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0C8h+var_B4], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0C8h+var_B8], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0C8h+var_BC], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0C8h+Size], eax
		lea	eax, [ebp+var_84]
		mov	[esp+0C8h+Src],	eax
		lea	eax, [ebp+var_80]
		mov	[esp+0C8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41F00D
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_84]
		cmp	edx, eax
		ja	short loc_41EFFE
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	short loc_41EFFE
		mov	eax, [ebp+var_60]
		cmp	eax, 3
		jz	short loc_41F00D

loc_41EFFE:				; CODE XREF: sub_41E9ED+600j
					; sub_41E9ED+607j
		mov	[esp+0C8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_41F00D:				; CODE XREF: sub_41E9ED+5F3j
					; sub_41E9ED+60Fj
		cmp	[ebp+var_C], 0
		jnz	loc_41FC61
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_80]
		lea	ecx, [ebp+var_74]
		mov	[esp+0C8h+Size], ecx
		mov	[esp+0C8h+Src],	edx
		mov	[esp+0C8h+Dst],	eax
		call	sub_41E7D1
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_41FC64
		mov	edx, [ebp+var_80]
		mov	eax, [ebp+var_54]
		add	eax, edx
		mov	[ebp+var_80], eax
		mov	edx, [ebp+var_84]
		mov	eax, [ebp+var_54]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_84], eax
		mov	dword ptr [ebp+var_18],	3D8h
		mov	[esp+0C8h+var_A8], 6
		lea	eax, [ebp+var_58]
		mov	[esp+0C8h+var_AC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0C8h+var_B0], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0C8h+var_B4], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0C8h+var_B8], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0C8h+var_BC], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0C8h+Size], eax
		lea	eax, [ebp+var_84]
		mov	[esp+0C8h+Src],	eax
		lea	eax, [ebp+var_80]
		mov	[esp+0C8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+0C8h+Dst],	eax
		call	sub_41D9DA
		cmp	eax, 3FFFh
		jz	loc_41F2D2
		cmp	[ebp+var_C], 0
		jnz	short loc_41F0E6
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_84]
		cmp	edx, eax
		jbe	short loc_41F0E6
		mov	[esp+0C8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_41F0E6:				; CODE XREF: sub_41E9ED+6DBj
					; sub_41E9ED+6E8j
		cmp	[ebp+var_C], 0
		jnz	loc_41FC67
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	loc_41F1B3
		mov	eax, [ebp+var_60]
		cmp	eax, 1
		jnz	loc_41F1B3
		mov	edx, [ebp+var_80]
		mov	eax, [ebp+var_54]
		add	eax, edx
		mov	[ebp+var_80], eax
		mov	edx, [ebp+var_84]
		mov	eax, [ebp+var_54]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_84], eax
		mov	[esp+0C8h+var_A8], 6
		lea	eax, [ebp+var_58]
		mov	[esp+0C8h+var_AC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0C8h+var_B0], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0C8h+var_B4], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0C8h+var_B8], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0C8h+var_BC], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0C8h+Size], eax
		lea	eax, [ebp+var_84]
		mov	[esp+0C8h+Src],	eax
		lea	eax, [ebp+var_80]
		mov	[esp+0C8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+0C8h+Dst],	eax
		call	sub_41D9DA
		cmp	eax, 3FFFh
		jz	loc_41F2D5
		cmp	[ebp+var_C], 0
		jnz	short loc_41F1A9
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_84]
		cmp	edx, eax
		jbe	short loc_41F1A9
		mov	[esp+0C8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_41F1A9:				; CODE XREF: sub_41E9ED+79Ej
					; sub_41E9ED+7ABj
		cmp	[ebp+var_C], 0
		jnz	loc_41FC6A

loc_41F1B3:				; CODE XREF: sub_41E9ED+708j
					; sub_41E9ED+714j
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	loc_41F276
		mov	eax, [ebp+var_60]
		cmp	eax, 3
		jnz	loc_41F276
		mov	edx, [ebp+var_80]
		mov	eax, [ebp+var_54]
		add	eax, edx
		mov	[ebp+var_80], eax
		mov	edx, [ebp+var_84]
		mov	eax, [ebp+var_54]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_84], eax
		mov	[esp+0C8h+var_A8], 6
		lea	eax, [ebp+var_58]
		mov	[esp+0C8h+var_AC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0C8h+var_B0], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0C8h+var_B4], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0C8h+var_B8], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0C8h+var_BC], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0C8h+Size], eax
		lea	eax, [ebp+var_84]
		mov	[esp+0C8h+Src],	eax
		lea	eax, [ebp+var_80]
		mov	[esp+0C8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+0C8h+Dst],	eax
		call	sub_41D9DA
		cmp	eax, 3FFFh
		jz	loc_41F2D8
		cmp	[ebp+var_C], 0
		jnz	short loc_41F26C
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_84]
		cmp	edx, eax
		jbe	short loc_41F26C
		mov	[esp+0C8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_41F26C:				; CODE XREF: sub_41E9ED+861j
					; sub_41E9ED+86Ej
		cmp	[ebp+var_C], 0
		jnz	loc_41FC6D

loc_41F276:				; CODE XREF: sub_41E9ED+7CBj
					; sub_41E9ED+7D7j
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	short loc_41F2D9
		mov	eax, [ebp+var_60]
		cmp	eax, 2
		jnz	short loc_41F2D9
		mov	[ebp+var_24], 0
		jmp	short loc_41F2BC
; ---------------------------------------------------------------------------

loc_41F28E:				; CODE XREF: sub_41E9ED+8D4j
		shl	[ebp+var_24], 8
		mov	eax, [ebp+var_80]
		movzx	edx, byte ptr [eax]
		movzx	edx, dl
		or	[ebp+var_24], edx
		add	eax, 1
		mov	[ebp+var_80], eax
		mov	eax, [ebp+var_84]
		sub	eax, 1
		mov	[ebp+var_84], eax
		mov	eax, [ebp+var_54]
		sub	eax, 1
		mov	[ebp+var_54], eax

loc_41F2BC:				; CODE XREF: sub_41E9ED+89Fj
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	short loc_41F28E
		mov	eax, [ebp+var_24]
		mov	[ebp+var_30], eax
		mov	[ebp+var_34], 1
		jmp	short loc_41F2D9
; ---------------------------------------------------------------------------

loc_41F2D2:				; CODE XREF: sub_41E9ED+6D1j
		nop
		jmp	short loc_41F2D9
; ---------------------------------------------------------------------------

loc_41F2D5:				; CODE XREF: sub_41E9ED+794j
		nop
		jmp	short loc_41F2D9
; ---------------------------------------------------------------------------

loc_41F2D8:				; CODE XREF: sub_41E9ED+857j
		nop

loc_41F2D9:				; CODE XREF: sub_41E9ED+88Ej
					; sub_41E9ED+896j ...
		mov	dword ptr [ebp+var_18],	412h
		mov	[esp+0C8h+var_A8], 6
		lea	eax, [ebp+var_58]
		mov	[esp+0C8h+var_AC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0C8h+var_B0], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0C8h+var_B4], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0C8h+var_B8], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0C8h+var_BC], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0C8h+Size], eax
		lea	eax, [ebp+var_70]
		mov	[esp+0C8h+Src],	eax
		lea	eax, [ebp+var_6C]
		mov	[esp+0C8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41F346
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_70]
		cmp	edx, eax
		jbe	short loc_41F346
		mov	[esp+0C8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_41F346:				; CODE XREF: sub_41E9ED+93Ej
					; sub_41E9ED+948j
		cmp	[ebp+var_C], 0
		jnz	loc_41FC70
		mov	eax, [ebp+var_5C]
		cmp	eax, 2
		jnz	short loc_41F3C7
		mov	eax, [ebp+var_60]
		test	eax, eax
		jnz	short loc_41F3C7
		mov	edx, [ebp+var_6C]
		mov	eax, [ebp+var_54]
		add	eax, edx
		mov	[ebp+var_6C], eax
		mov	edx, [ebp+var_70]
		mov	eax, [ebp+var_54]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_70], eax
		mov	dword ptr [ebp+var_18],	41Eh
		mov	[esp+0C8h+var_A8], 6
		lea	eax, [ebp+var_58]
		mov	[esp+0C8h+var_AC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0C8h+var_B0], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0C8h+var_B4], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0C8h+var_B8], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0C8h+var_BC], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0C8h+Size], eax
		lea	eax, [ebp+var_70]
		mov	[esp+0C8h+Src],	eax
		lea	eax, [ebp+var_6C]
		mov	[esp+0C8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax

loc_41F3C7:				; CODE XREF: sub_41E9ED+969j
					; sub_41E9ED+970j
		cmp	[ebp+var_C], 0
		jnz	short loc_41F3F6
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_70]
		cmp	edx, eax
		ja	short loc_41F3E7
		mov	eax, [ebp+var_5C]
		cmp	eax, 2
		jnz	short loc_41F3E7
		mov	eax, [ebp+var_60]
		cmp	eax, 1
		jz	short loc_41F3F6

loc_41F3E7:				; CODE XREF: sub_41E9ED+9E8j
					; sub_41E9ED+9F0j
		mov	[esp+0C8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_41F3F6:				; CODE XREF: sub_41E9ED+9DEj
					; sub_41E9ED+9F8j
		cmp	[ebp+var_C], 0
		jnz	loc_41FC73
		mov	eax, [ebp+var_54]
		mov	[ebp+var_70], eax
		mov	dword ptr [ebp+var_18],	429h
		mov	[esp+0C8h+var_A8], 6
		lea	eax, [ebp+var_58]
		mov	[esp+0C8h+var_AC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0C8h+var_B0], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0C8h+var_B4], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0C8h+var_B8], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0C8h+var_BC], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0C8h+Size], eax
		lea	eax, [ebp+var_70]
		mov	[esp+0C8h+Src],	eax
		lea	eax, [ebp+var_6C]
		mov	[esp+0C8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41F473
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_70]
		cmp	edx, eax
		jbe	short loc_41F473
		mov	[esp+0C8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_41F473:				; CODE XREF: sub_41E9ED+A6Bj
					; sub_41E9ED+A75j
		cmp	[ebp+var_C], 0
		jnz	loc_41FC76
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	short loc_41F48C
		mov	eax, [ebp+var_60]
		cmp	eax, 10h
		jz	short loc_41F4F8

loc_41F48C:				; CODE XREF: sub_41E9ED+A95j
		mov	eax, [ebp+var_5C]
		cmp	eax, 2
		jnz	short loc_41F4E4
		mov	eax, [ebp+var_60]
		cmp	eax, 1
		jz	short loc_41F4BC
		cmp	eax, 1
		jg	short loc_41F4A7
		test	eax, eax
		jz	short loc_41F4B3
		jmp	short loc_41F4D7
; ---------------------------------------------------------------------------

loc_41F4A7:				; CODE XREF: sub_41E9ED+AB2j
		cmp	eax, 2
		jz	short loc_41F4C5
		cmp	eax, 3
		jz	short loc_41F4CE
		jmp	short loc_41F4D7
; ---------------------------------------------------------------------------

loc_41F4B3:				; CODE XREF: sub_41E9ED+AB6j
		mov	[ebp+var_1C], offset aEcKeyObjectsAr ; "EC key objects are not supported"
		jmp	short loc_41F4DF
; ---------------------------------------------------------------------------

loc_41F4BC:				; CODE XREF: sub_41E9ED+AADj
		mov	[ebp+var_1C], offset aDhKeyObjectsAr ; "DH key objects are not supported"
		jmp	short loc_41F4DF
; ---------------------------------------------------------------------------

loc_41F4C5:				; CODE XREF: sub_41E9ED+ABDj
		mov	[ebp+var_1C], offset aDsaKeyObjectsA ; "DSA key	objects	are not	supported"
		jmp	short loc_41F4DF
; ---------------------------------------------------------------------------

loc_41F4CE:				; CODE XREF: sub_41E9ED+AC2j
		mov	[ebp+var_1C], offset aKeaKeyObjectsA ; "KEA key	objects	are not	supported"
		jmp	short loc_41F4DF
; ---------------------------------------------------------------------------

loc_41F4D7:				; CODE XREF: sub_41E9ED+AB8j
					; sub_41E9ED+AC4j
		mov	[ebp+var_1C], offset aUnknownPrivate ; "unknown	privateKeyObject"
		nop

loc_41F4DF:				; CODE XREF: sub_41E9ED+ACDj
					; sub_41E9ED+AD6j ...
		jmp	loc_41FC83
; ---------------------------------------------------------------------------

loc_41F4E4:				; CODE XREF: sub_41E9ED+AA5j
		mov	[esp+0C8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax
		jmp	loc_41FC83
; ---------------------------------------------------------------------------

loc_41F4F8:				; CODE XREF: sub_41E9ED+A9Dj
		mov	eax, [ebp+var_54]
		mov	[ebp+var_70], eax
		mov	dword ptr [ebp+var_18],	447h
		mov	[esp+0C8h+var_A8], 6
		lea	eax, [ebp+var_58]
		mov	[esp+0C8h+var_AC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0C8h+var_B0], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0C8h+var_B4], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0C8h+var_B8], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0C8h+var_BC], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0C8h+Size], eax
		lea	eax, [ebp+var_70]
		mov	[esp+0C8h+Src],	eax
		lea	eax, [ebp+var_6C]
		mov	[esp+0C8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41F56B
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_70]
		cmp	edx, eax
		jbe	short loc_41F56B
		mov	[esp+0C8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_41F56B:				; CODE XREF: sub_41E9ED+B63j
					; sub_41E9ED+B6Dj
		cmp	[ebp+var_C], 0
		jnz	loc_41FC79
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	short loc_41F584
		mov	eax, [ebp+var_60]
		cmp	eax, 10h
		jz	short loc_41F590

loc_41F584:				; CODE XREF: sub_41E9ED+B8Dj
		mov	[ebp+var_1C], offset aUnsupportedRef ; "unsupported reference type"
		jmp	loc_41FC83
; ---------------------------------------------------------------------------

loc_41F590:				; CODE XREF: sub_41E9ED+B95j
		mov	eax, [ebp+var_54]
		mov	[ebp+var_70], eax
		mov	dword ptr [ebp+var_18],	456h
		mov	[esp+0C8h+var_A8], 6
		lea	eax, [ebp+var_58]
		mov	[esp+0C8h+var_AC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0C8h+var_B0], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0C8h+var_B4], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0C8h+var_B8], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0C8h+var_BC], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0C8h+Size], eax
		lea	eax, [ebp+var_70]
		mov	[esp+0C8h+Src],	eax
		lea	eax, [ebp+var_6C]
		mov	[esp+0C8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41F603
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_70]
		cmp	edx, eax
		jbe	short loc_41F603
		mov	[esp+0C8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_41F603:				; CODE XREF: sub_41E9ED+BFBj
					; sub_41E9ED+C05j
		cmp	[ebp+var_C], 0
		jnz	loc_41FC7C
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	short loc_41F62D
		mov	eax, [ebp+var_60]
		cmp	eax, 4
		jnz	short loc_41F62D
		mov	eax, [ebp+var_54]
		test	eax, eax
		jz	short loc_41F62D
		mov	eax, [ebp+var_54]
		and	eax, 1
		test	al, al
		jz	short loc_41F639

loc_41F62D:				; CODE XREF: sub_41E9ED+C25j
					; sub_41E9ED+C2Dj ...
		mov	[ebp+var_1C], offset aInvalidPathRef ; "invalid	path reference"
		jmp	loc_41FC83
; ---------------------------------------------------------------------------

loc_41F639:				; CODE XREF: sub_41E9ED+C3Ej
		mov	eax, [ebp+var_54]
		shr	eax, 1
		add	eax, 19h
		add	eax, eax
		mov	[esp+0C8h+Src],	eax
		mov	[esp+0C8h+Dst],	1
		call	gcry_calloc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_41F669
		call	sub_41D9E7
		mov	[ebp+var_C], eax
		jmp	loc_41FD03
; ---------------------------------------------------------------------------

loc_41F669:				; CODE XREF: sub_41E9ED+C6Dj
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_40]
		mov	[eax+4], edx
		mov	eax, [ebp+var_40]
		mov	[esp+0C8h+Dst],	eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[eax+8], edx
		mov	eax, [ebp+var_20]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_41F6A7
		call	sub_41D9E7
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_20]
		mov	[esp+0C8h+Dst],	eax
		call	gcry_free
		jmp	loc_41FD03
; ---------------------------------------------------------------------------

loc_41F6A7:				; CODE XREF: sub_41E9ED+CA0j
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+var_20]
		mov	eax, [eax+8]
		mov	ecx, [ebp+var_40]
		mov	[esp+0C8h+Size], ecx ; Size
		mov	[esp+0C8h+Src],	edx ; Src
		mov	[esp+0C8h+Dst],	eax ; Dst
		call	memcpy
		cmp	[ebp+var_28], 0
		jz	short loc_41F731
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_2C]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_2C]
		mov	[esp+0C8h+Dst],	eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_20]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_41F715
		call	sub_41D9E7
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_20]
		mov	eax, [eax+8]
		mov	[esp+0C8h+Dst],	eax
		call	gcry_free
		mov	eax, [ebp+var_20]
		mov	[esp+0C8h+Dst],	eax
		call	gcry_free
		jmp	loc_41FD03
; ---------------------------------------------------------------------------

loc_41F715:				; CODE XREF: sub_41E9ED+D00j
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_20]
		mov	eax, [eax+10h]
		mov	ecx, [ebp+var_2C]
		mov	[esp+0C8h+Size], ecx ; Size
		mov	[esp+0C8h+Src],	edx ; Src
		mov	[esp+0C8h+Dst],	eax ; Dst
		call	memcpy

loc_41F731:				; CODE XREF: sub_41E9ED+CDAj
		mov	eax, [ebp+var_54]
		mov	edx, eax
		shr	edx, 1
		mov	eax, [ebp+var_20]
		mov	[eax+2Ch], edx
		mov	[ebp+var_14], 0
		jmp	short loc_41F788
; ---------------------------------------------------------------------------

loc_41F747:				; CODE XREF: sub_41E9ED+DA6j
		mov	eax, [ebp+var_6C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 8
		mov	edx, eax
		mov	eax, [ebp+var_6C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, edx
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	ecx, [ebp+var_14]
		add	ecx, 18h
		mov	[eax+ecx*2], dx
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_6C]
		add	eax, 2
		mov	[ebp+var_6C], eax
		mov	eax, [ebp+var_70]
		sub	eax, 2
		mov	[ebp+var_70], eax

loc_41F788:				; CODE XREF: sub_41E9ED+D58j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_20]
		mov	eax, [eax+2Ch]
		cmp	edx, eax
		jb	short loc_41F747
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_74]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_30]
		mov	[eax+18h], edx
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_34]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+var_70]
		test	eax, eax
		jz	loc_41F953
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+20h], 1
		mov	dword ptr [ebp+var_18],	492h
		mov	[esp+0C8h+var_A8], 6
		lea	eax, [ebp+var_58]
		mov	[esp+0C8h+var_AC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0C8h+var_B0], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0C8h+var_B4], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0C8h+var_B8], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0C8h+var_BC], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0C8h+Size], eax
		lea	eax, [ebp+var_70]
		mov	[esp+0C8h+Src],	eax
		lea	eax, [ebp+var_6C]
		mov	[esp+0C8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41F841
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_70]
		cmp	edx, eax
		ja	short loc_41F832
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jnz	short loc_41F832
		mov	eax, [ebp+var_60]
		cmp	eax, 2
		jz	short loc_41F841

loc_41F832:				; CODE XREF: sub_41E9ED+E34j
					; sub_41E9ED+E3Bj
		mov	[esp+0C8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_41F841:				; CODE XREF: sub_41E9ED+E2Aj
					; sub_41E9ED+E43j
		cmp	[ebp+var_C], 0
		jnz	loc_41FC7F
		mov	[ebp+var_24], 0
		jmp	short loc_41F87C
; ---------------------------------------------------------------------------

loc_41F854:				; CODE XREF: sub_41E9ED+E94j
		shl	[ebp+var_24], 8
		mov	eax, [ebp+var_6C]
		movzx	edx, byte ptr [eax]
		movzx	edx, dl
		or	[ebp+var_24], edx
		add	eax, 1
		mov	[ebp+var_6C], eax
		mov	eax, [ebp+var_70]
		sub	eax, 1
		mov	[ebp+var_70], eax
		mov	eax, [ebp+var_54]
		sub	eax, 1
		mov	[ebp+var_54], eax

loc_41F87C:				; CODE XREF: sub_41E9ED+E65j
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	short loc_41F854
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_24]
		mov	[eax+24h], edx
		mov	dword ptr [ebp+var_18],	4A3h
		mov	[esp+0C8h+var_A8], 6
		lea	eax, [ebp+var_58]
		mov	[esp+0C8h+var_AC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0C8h+var_B0], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0C8h+var_B4], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0C8h+var_B8], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0C8h+var_BC], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0C8h+Size], eax
		lea	eax, [ebp+var_70]
		mov	[esp+0C8h+Src],	eax
		lea	eax, [ebp+var_6C]
		mov	[esp+0C8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41F908
		mov	edx, [ebp+var_54]
		mov	eax, [ebp+var_70]
		cmp	edx, eax
		ja	short loc_41F8F9
		mov	eax, [ebp+var_5C]
		cmp	eax, 2
		jnz	short loc_41F8F9
		mov	eax, [ebp+var_60]
		test	eax, eax
		jz	short loc_41F908

loc_41F8F9:				; CODE XREF: sub_41E9ED+EFBj
					; sub_41E9ED+F03j
		mov	[esp+0C8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_41F908:				; CODE XREF: sub_41E9ED+EF1j
					; sub_41E9ED+F0Aj
		cmp	[ebp+var_C], 0
		jnz	loc_41FC82
		mov	[ebp+var_24], 0
		jmp	short loc_41F943
; ---------------------------------------------------------------------------

loc_41F91B:				; CODE XREF: sub_41E9ED+F5Bj
		shl	[ebp+var_24], 8
		mov	eax, [ebp+var_6C]
		movzx	edx, byte ptr [eax]
		movzx	edx, dl
		or	[ebp+var_24], edx
		add	eax, 1
		mov	[ebp+var_6C], eax
		mov	eax, [ebp+var_70]
		sub	eax, 1
		mov	[ebp+var_70], eax
		mov	eax, [ebp+var_54]
		sub	eax, 1
		mov	[ebp+var_54], eax

loc_41F943:				; CODE XREF: sub_41E9ED+F2Cj
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	short loc_41F91B
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_24]
		mov	[eax+28h], edx

loc_41F953:				; CODE XREF: sub_41E9ED+DC8j
		movzx	eax, [ebp+var_8C]
		mov	[esp+0C8h+Src],	eax ; char
		mov	[esp+0C8h+Dst],	offset aPrkdf04hxId ; "PrKDF %04hX: id="
		call	sub_43CBBE
		mov	[ebp+var_14], 0
		jmp	short loc_41F998
; ---------------------------------------------------------------------------

loc_41F973:				; CODE XREF: sub_41E9ED+FB6j
		mov	eax, [ebp+var_20]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_14]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+0C8h+Src],	eax ; char
		mov	[esp+0C8h+Dst],	offset a02x_0 ;	"%02X"
		call	sub_43CBE8
		add	[ebp+var_14], 1

loc_41F998:				; CODE XREF: sub_41E9ED+F84j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_20]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	short loc_41F973
		mov	[esp+0C8h+Dst],	offset aPath ; " path="
		call	sub_43CBE8
		mov	[ebp+var_14], 0
		jmp	short loc_41F9DE
; ---------------------------------------------------------------------------

loc_41F9BA:				; CODE XREF: sub_41E9ED+FFCj
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_14]
		add	edx, 18h
		movzx	eax, word ptr [eax+edx*2]
		movzx	eax, ax
		mov	[esp+0C8h+Src],	eax ; char
		mov	[esp+0C8h+Dst],	offset a04hx ; "%04hX"
		call	sub_43CBE8
		add	[ebp+var_14], 1

loc_41F9DE:				; CODE XREF: sub_41E9ED+FCBj
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_20]
		mov	eax, [eax+2Ch]
		cmp	edx, eax
		jb	short loc_41F9BA
		mov	eax, [ebp+var_20]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	short loc_41FA15
		mov	eax, [ebp+var_20]
		mov	edx, [eax+28h]
		mov	eax, [ebp+var_20]
		mov	eax, [eax+24h]
		mov	[esp+0C8h+Size], edx
		mov	[esp+0C8h+Src],	eax ; char
		mov	[esp+0C8h+Dst],	offset aLuLu ; "[%lu/%lu]"
		call	sub_43CBE8

loc_41FA15:				; CODE XREF: sub_41E9ED+1006j
		mov	eax, [ebp+var_20]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_41FA66
		mov	[esp+0C8h+Dst],	offset aAuthid ; " authid="
		call	sub_43CBE8
		mov	[ebp+var_14], 0
		jmp	short loc_41FA59
; ---------------------------------------------------------------------------

loc_41FA34:				; CODE XREF: sub_41E9ED+1077j
		mov	eax, [ebp+var_20]
		mov	edx, [eax+10h]
		mov	eax, [ebp+var_14]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+0C8h+Src],	eax ; char
		mov	[esp+0C8h+Dst],	offset a02x_0 ;	"%02X"
		call	sub_43CBE8
		add	[ebp+var_14], 1

loc_41FA59:				; CODE XREF: sub_41E9ED+1045j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_20]
		mov	eax, [eax+0Ch]
		cmp	edx, eax
		jb	short loc_41FA34

loc_41FA66:				; CODE XREF: sub_41E9ED+1030j
		mov	eax, [ebp+var_20]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short loc_41FA86
		mov	eax, [ebp+var_20]
		mov	eax, [eax+18h]
		mov	[esp+0C8h+Src],	eax ; char
		mov	[esp+0C8h+Dst],	offset aKeyref0x02lx ; " keyref=0x%02lX"
		call	sub_43CBE8

loc_41FA86:				; CODE XREF: sub_41E9ED+1081j
		mov	[esp+0C8h+Dst],	offset aUsage ;	" usage="
		call	sub_43CBE8
		mov	dword ptr [ebp+var_38],	offset byte_44C47D
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 1
		test	al, al
		jz	short loc_41FAC1
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+0C8h+Src],	eax ; char
		mov	[esp+0C8h+Dst],	offset aSencrypt ; "%sencrypt"
		call	sub_43CBE8
		mov	dword ptr [ebp+var_38],	offset asc_44C488 ; ","

loc_41FAC1:				; CODE XREF: sub_41E9ED+10B8j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 2
		test	al, al
		jz	short loc_41FAE9
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+0C8h+Src],	eax ; char
		mov	[esp+0C8h+Dst],	offset aSdecrypt ; "%sdecrypt"
		call	sub_43CBE8
		mov	dword ptr [ebp+var_38],	offset asc_44C488 ; ","

loc_41FAE9:				; CODE XREF: sub_41E9ED+10E0j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 4
		test	al, al
		jz	short loc_41FB11
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+0C8h+Src],	eax ; char
		mov	[esp+0C8h+Dst],	offset aSsign ;	"%ssign"
		call	sub_43CBE8
		mov	dword ptr [ebp+var_38],	offset asc_44C488 ; ","

loc_41FB11:				; CODE XREF: sub_41E9ED+1108j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 8
		test	al, al
		jz	short loc_41FB39
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+0C8h+Src],	eax ; char
		mov	[esp+0C8h+Dst],	offset aSsign_recover ;	"%ssign_recover"
		call	sub_43CBE8
		mov	dword ptr [ebp+var_38],	offset asc_44C488 ; ","

loc_41FB39:				; CODE XREF: sub_41E9ED+1130j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 10h
		test	al, al
		jz	short loc_41FB61
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+0C8h+Src],	eax ; char
		mov	[esp+0C8h+Dst],	offset aSwrap ;	"%swrap"
		call	sub_43CBE8
		mov	dword ptr [ebp+var_38],	offset asc_44C488 ; ","

loc_41FB61:				; CODE XREF: sub_41E9ED+1158j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 20h
		test	al, al
		jz	short loc_41FB89
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+0C8h+Src],	eax ; char
		mov	[esp+0C8h+Dst],	offset aSunwrap	; "%sunwrap"
		call	sub_43CBE8
		mov	dword ptr [ebp+var_38],	offset asc_44C488 ; ","

loc_41FB89:				; CODE XREF: sub_41E9ED+1180j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 40h
		test	al, al
		jz	short loc_41FBB1
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+0C8h+Src],	eax ; char
		mov	[esp+0C8h+Dst],	offset aSverify	; "%sverify"
		call	sub_43CBE8
		mov	dword ptr [ebp+var_38],	offset asc_44C488 ; ","

loc_41FBB1:				; CODE XREF: sub_41E9ED+11A8j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 0FFFFFF80h
		test	al, al
		jz	short loc_41FBD9
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+0C8h+Src],	eax ; char
		mov	[esp+0C8h+Dst],	offset aSverify_recove ; "%sverify_recover"
		call	sub_43CBE8
		mov	dword ptr [ebp+var_38],	offset asc_44C488 ; ","

loc_41FBD9:				; CODE XREF: sub_41E9ED+11D0j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax+15h]
		and	eax, 1
		test	al, al
		jz	short loc_41FC01
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+0C8h+Src],	eax ; char
		mov	[esp+0C8h+Dst],	offset aSderive	; "%sderive"
		call	sub_43CBE8
		mov	dword ptr [ebp+var_38],	offset asc_44C488 ; ","

loc_41FC01:				; CODE XREF: sub_41E9ED+11F8j
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax+15h]
		and	eax, 2
		test	al, al
		jz	short loc_41FC29
		mov	eax, dword ptr [ebp+var_38]
		mov	[esp+0C8h+Src],	eax ; char
		mov	[esp+0C8h+Dst],	offset aSnon_repudiati ; "%snon_repudiation"
		call	sub_43CBE8
		mov	dword ptr [ebp+var_38],	offset asc_44C488 ; ","

loc_41FC29:				; CODE XREF: sub_41E9ED+1220j
		mov	[esp+0C8h+Dst],	offset asc_44C4EF ; "\n"
		call	sub_43CBE8
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	[ebp+var_10], eax
		mov	[ebp+var_20], 0
		jmp	loc_41FCE4
; ---------------------------------------------------------------------------

loc_41FC4F:				; CODE XREF: sub_41E9ED+1EAj
		nop
		jmp	short loc_41FC83
; ---------------------------------------------------------------------------

loc_41FC52:				; CODE XREF: sub_41E9ED+2A4j
		nop
		jmp	short loc_41FC83
; ---------------------------------------------------------------------------

loc_41FC55:				; CODE XREF: sub_41E9ED+35Ej
		nop
		jmp	short loc_41FC83
; ---------------------------------------------------------------------------

loc_41FC58:				; CODE XREF: sub_41E9ED+414j
		nop
		jmp	short loc_41FC83
; ---------------------------------------------------------------------------

loc_41FC5B:				; CODE XREF: sub_41E9ED+4B7j
		nop
		jmp	short loc_41FC83
; ---------------------------------------------------------------------------

loc_41FC5E:				; CODE XREF: sub_41E9ED+56Cj
		nop
		jmp	short loc_41FC83
; ---------------------------------------------------------------------------

loc_41FC61:				; CODE XREF: sub_41E9ED+624j
		nop
		jmp	short loc_41FC83
; ---------------------------------------------------------------------------

loc_41FC64:				; CODE XREF: sub_41E9ED+64Aj
		nop
		jmp	short loc_41FC83
; ---------------------------------------------------------------------------

loc_41FC67:				; CODE XREF: sub_41E9ED+6FDj
		nop
		jmp	short loc_41FC83
; ---------------------------------------------------------------------------

loc_41FC6A:				; CODE XREF: sub_41E9ED+7C0j
		nop
		jmp	short loc_41FC83
; ---------------------------------------------------------------------------

loc_41FC6D:				; CODE XREF: sub_41E9ED+883j
		nop
		jmp	short loc_41FC83
; ---------------------------------------------------------------------------

loc_41FC70:				; CODE XREF: sub_41E9ED+95Dj
		nop
		jmp	short loc_41FC83
; ---------------------------------------------------------------------------

loc_41FC73:				; CODE XREF: sub_41E9ED+A0Dj
		nop
		jmp	short loc_41FC83
; ---------------------------------------------------------------------------

loc_41FC76:				; CODE XREF: sub_41E9ED+A8Aj
		nop
		jmp	short loc_41FC83
; ---------------------------------------------------------------------------

loc_41FC79:				; CODE XREF: sub_41E9ED+B82j
		nop
		jmp	short loc_41FC83
; ---------------------------------------------------------------------------

loc_41FC7C:				; CODE XREF: sub_41E9ED+C1Aj
		nop
		jmp	short loc_41FC83
; ---------------------------------------------------------------------------

loc_41FC7F:				; CODE XREF: sub_41E9ED+E58j
		nop
		jmp	short loc_41FC83
; ---------------------------------------------------------------------------

loc_41FC82:				; CODE XREF: sub_41E9ED+F1Fj
		nop

loc_41FC83:				; CODE XREF: sub_41E9ED:loc_41F4DFj
					; sub_41E9ED+B06j ...
		cmp	[ebp+var_1C], 0
		jnz	short loc_41FC96
		mov	eax, [ebp+var_C]
		mov	[esp+0C8h+Dst],	eax
		call	gpg_strerror
		jmp	short loc_41FC99
; ---------------------------------------------------------------------------

loc_41FC96:				; CODE XREF: sub_41E9ED+129Aj
		mov	eax, [ebp+var_1C]

loc_41FC99:				; CODE XREF: sub_41E9ED+12A7j
		mov	[esp+0C8h+Size], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+0C8h+Src],	eax ; char
		mov	[esp+0C8h+Dst],	offset aErrorParsing_0 ; "error	parsing	PrKDF record (%d): %s -	s"...
		call	sub_43CB21
		cmp	[ebp+var_20], 0
		jz	short loc_41FCDD
		mov	eax, [ebp+var_20]
		mov	eax, [eax+8]
		mov	[esp+0C8h+Dst],	eax
		call	gcry_free
		mov	eax, [ebp+var_20]
		mov	eax, [eax+10h]
		mov	[esp+0C8h+Dst],	eax
		call	gcry_free
		mov	eax, [ebp+var_20]
		mov	[esp+0C8h+Dst],	eax
		call	gcry_free

loc_41FCDD:				; CODE XREF: sub_41E9ED+12C7j
		mov	[ebp+var_C], 0

loc_41FCE4:				; CODE XREF: sub_41E9ED+88j
					; sub_41E9ED+125Dj
		mov	eax, [ebp+var_50]
		test	eax, eax
		jz	short loc_41FD03
		mov	eax, [ebp+var_4C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41FD03
		mov	eax, [ebp+var_4C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FFh
		jnz	loc_41EA7A

loc_41FD03:				; CODE XREF: sub_41E9ED+146j
					; sub_41E9ED+C77j ...
		mov	eax, [ebp+var_44]
		mov	[esp+0C8h+Dst],	eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_41FD21
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+Dst],	eax
		call	sub_41DA41
		jmp	short loc_41FD29
; ---------------------------------------------------------------------------

loc_41FD21:				; CODE XREF: sub_41E9ED+1325j
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_41FD29:				; CODE XREF: sub_41E9ED+1332j
		mov	eax, [ebp+var_C]

locret_41FD2C:				; CODE XREF: sub_41E9ED+37j
					; sub_41E9ED+77j
		leave
		retn
sub_41E9ED	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41FD2E	proc near		; CODE XREF: sub_422340+143p
					; sub_422340+185p ...

Dst		= dword	ptr -0A8h
Src		= dword	ptr -0A4h
Size		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_6C		= word ptr -6Ch
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= byte ptr -54h
var_50		= byte ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 0A8h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_6C], ax
		mov	[ebp+var_30], 0
		mov	[ebp+var_10], 0
		cmp	[ebp+var_6C], 0
		jnz	short loc_41FD64
		mov	[esp+0A8h+Dst],	3Ah
		call	sub_41D9BF
		jmp	locret_4206B3
; ---------------------------------------------------------------------------

loc_41FD64:				; CODE XREF: sub_41FD2E+23j
		movzx	edx, [ebp+var_6C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	ecx, [ebp+var_34]
		mov	[esp+0A8h+var_98], ecx
		lea	ecx, [ebp+var_30]
		mov	[esp+0A8h+var_9C], ecx
		mov	[esp+0A8h+Size], offset	aCdf ; "CDF"
		mov	[esp+0A8h+Src],	edx
		mov	[esp+0A8h+Dst],	eax
		call	sub_41DB8C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_41FDA1
		mov	eax, [ebp+var_C]
		jmp	locret_4206B3
; ---------------------------------------------------------------------------

loc_41FDA1:				; CODE XREF: sub_41FD2E+69j
		mov	eax, [ebp+var_30]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_34]
		mov	[ebp+var_3C], eax
		jmp	loc_42066B
; ---------------------------------------------------------------------------

loc_41FDB2:				; CODE XREF: sub_41FD2E+956j
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 0
		mov	[esp+0A8h+var_88], 6
		lea	eax, [ebp+var_44]
		mov	[esp+0A8h+var_8C], eax
		lea	eax, [ebp+var_40]
		mov	[esp+0A8h+var_90], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+var_94], eax
		lea	eax, [ebp+var_50]
		mov	[esp+0A8h+var_98], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+var_9C], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+0A8h+Src],	eax
		lea	eax, [ebp+var_38]
		mov	[esp+0A8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41FE2E
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_3C]
		cmp	edx, eax
		ja	short loc_41FE1F
		mov	eax, [ebp+var_4C]
		cmp	eax, 10h
		jz	short loc_41FE2E

loc_41FE1F:				; CODE XREF: sub_41FD2E+E7j
		mov	[esp+0A8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_41FE2E:				; CODE XREF: sub_41FD2E+DDj
					; sub_41FD2E+EFj
		cmp	[ebp+var_C], 0
		jz	short loc_41FE54
		mov	eax, [ebp+var_C]
		mov	[esp+0A8h+Dst],	eax
		call	gpg_strerror
		mov	[esp+0A8h+Src],	eax ; char
		mov	[esp+0A8h+Dst],	offset aErrorParsingCd ; "error	parsing	CDF record: %s\n"
		call	sub_43CB21
		jmp	loc_42068A
; ---------------------------------------------------------------------------

loc_41FE54:				; CODE XREF: sub_41FD2E+104j
		mov	eax, [ebp+var_38]
		mov	[ebp+var_58], eax
		mov	eax, [ebp+var_40]
		mov	[ebp+var_5C], eax
		mov	edx, [ebp+var_38]
		mov	eax, [ebp+var_40]
		add	eax, edx
		mov	[ebp+var_38], eax
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+var_40]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_3C], eax
		mov	dword ptr [ebp+var_18],	52Ah
		mov	[esp+0A8h+var_88], 6
		lea	eax, [ebp+var_44]
		mov	[esp+0A8h+var_8C], eax
		lea	eax, [ebp+var_40]
		mov	[esp+0A8h+var_90], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+var_94], eax
		lea	eax, [ebp+var_50]
		mov	[esp+0A8h+var_98], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+var_9C], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0A8h+Src],	eax
		lea	eax, [ebp+var_58]
		mov	[esp+0A8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41FEEF
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_5C]
		cmp	edx, eax
		ja	short loc_41FEE0
		mov	eax, [ebp+var_4C]
		cmp	eax, 10h
		jz	short loc_41FEEF

loc_41FEE0:				; CODE XREF: sub_41FD2E+1A8j
		mov	[esp+0A8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_41FEEF:				; CODE XREF: sub_41FD2E+19Ej
					; sub_41FD2E+1B0j
		cmp	[ebp+var_C], 0
		jnz	loc_420613
		mov	edx, [ebp+var_58]
		mov	eax, [ebp+var_40]
		add	eax, edx
		mov	[ebp+var_58], eax
		mov	edx, [ebp+var_5C]
		mov	eax, [ebp+var_40]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_5C], eax
		mov	dword ptr [ebp+var_18],	535h
		mov	[esp+0A8h+var_88], 6
		lea	eax, [ebp+var_44]
		mov	[esp+0A8h+var_8C], eax
		lea	eax, [ebp+var_40]
		mov	[esp+0A8h+var_90], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+var_94], eax
		lea	eax, [ebp+var_50]
		mov	[esp+0A8h+var_98], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+var_9C], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0A8h+Src],	eax
		lea	eax, [ebp+var_58]
		mov	[esp+0A8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41FF88
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_5C]
		cmp	edx, eax
		ja	short loc_41FF79
		mov	eax, [ebp+var_4C]
		cmp	eax, 10h
		jz	short loc_41FF88

loc_41FF79:				; CODE XREF: sub_41FD2E+241j
		mov	[esp+0A8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_41FF88:				; CODE XREF: sub_41FD2E+237j
					; sub_41FD2E+249j
		cmp	[ebp+var_C], 0
		jnz	loc_420616
		mov	eax, [ebp+var_58]
		mov	[ebp+var_60], eax
		mov	eax, [ebp+var_40]
		mov	[ebp+var_64], eax
		mov	edx, [ebp+var_58]
		mov	eax, [ebp+var_40]
		add	eax, edx
		mov	[ebp+var_58], eax
		mov	edx, [ebp+var_5C]
		mov	eax, [ebp+var_40]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_5C], eax
		mov	dword ptr [ebp+var_18],	544h
		mov	[esp+0A8h+var_88], 6
		lea	eax, [ebp+var_44]
		mov	[esp+0A8h+var_8C], eax
		lea	eax, [ebp+var_40]
		mov	[esp+0A8h+var_90], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+var_94], eax
		lea	eax, [ebp+var_50]
		mov	[esp+0A8h+var_98], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+var_9C], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_64]
		mov	[esp+0A8h+Src],	eax
		lea	eax, [ebp+var_60]
		mov	[esp+0A8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_420034
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_64]
		cmp	edx, eax
		ja	short loc_420025
		mov	eax, [ebp+var_48]
		test	eax, eax
		jnz	short loc_420025
		mov	eax, [ebp+var_4C]
		cmp	eax, 4
		jz	short loc_420034

loc_420025:				; CODE XREF: sub_41FD2E+2E6j
					; sub_41FD2E+2EDj
		mov	[esp+0A8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_420034:				; CODE XREF: sub_41FD2E+2DCj
					; sub_41FD2E+2F5j
		cmp	[ebp+var_C], 0
		jnz	loc_420619
		mov	eax, [ebp+var_60]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_40]
		mov	[ebp+var_2C], eax
		mov	dword ptr [ebp+var_18],	551h
		mov	[esp+0A8h+var_88], 6
		lea	eax, [ebp+var_44]
		mov	[esp+0A8h+var_8C], eax
		lea	eax, [ebp+var_40]
		mov	[esp+0A8h+var_90], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+var_94], eax
		lea	eax, [ebp+var_50]
		mov	[esp+0A8h+var_98], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+var_9C], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0A8h+Src],	eax
		lea	eax, [ebp+var_58]
		mov	[esp+0A8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4200C7
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_5C]
		cmp	edx, eax
		ja	short loc_4200B8
		mov	eax, [ebp+var_48]
		cmp	eax, 2
		jnz	short loc_4200B8
		mov	eax, [ebp+var_4C]
		cmp	eax, 1
		jz	short loc_4200C7

loc_4200B8:				; CODE XREF: sub_41FD2E+378j
					; sub_41FD2E+380j
		mov	[esp+0A8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_4200C7:				; CODE XREF: sub_41FD2E+36Ej
					; sub_41FD2E+388j
		cmp	[ebp+var_C], 0
		jnz	loc_42061C
		mov	eax, [ebp+var_40]
		mov	[ebp+var_5C], eax
		mov	dword ptr [ebp+var_18],	55Ah
		mov	[esp+0A8h+var_88], 6
		lea	eax, [ebp+var_44]
		mov	[esp+0A8h+var_8C], eax
		lea	eax, [ebp+var_40]
		mov	[esp+0A8h+var_90], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+var_94], eax
		lea	eax, [ebp+var_50]
		mov	[esp+0A8h+var_98], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+var_9C], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0A8h+Src],	eax
		lea	eax, [ebp+var_58]
		mov	[esp+0A8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_420153
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_5C]
		cmp	edx, eax
		ja	short loc_420144
		mov	eax, [ebp+var_48]
		test	eax, eax
		jnz	short loc_420144
		mov	eax, [ebp+var_4C]
		cmp	eax, 10h
		jz	short loc_420153

loc_420144:				; CODE XREF: sub_41FD2E+405j
					; sub_41FD2E+40Cj
		mov	[esp+0A8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_420153:				; CODE XREF: sub_41FD2E+3FBj
					; sub_41FD2E+414j
		cmp	[ebp+var_C], 0
		jnz	loc_42061F
		mov	eax, [ebp+var_40]
		mov	[ebp+var_5C], eax
		mov	dword ptr [ebp+var_18],	565h
		mov	[esp+0A8h+var_88], 6
		lea	eax, [ebp+var_44]
		mov	[esp+0A8h+var_8C], eax
		lea	eax, [ebp+var_40]
		mov	[esp+0A8h+var_90], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+var_94], eax
		lea	eax, [ebp+var_50]
		mov	[esp+0A8h+var_98], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+var_9C], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0A8h+Src],	eax
		lea	eax, [ebp+var_58]
		mov	[esp+0A8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4201D0
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_5C]
		cmp	edx, eax
		jbe	short loc_4201D0
		mov	[esp+0A8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_4201D0:				; CODE XREF: sub_41FD2E+487j
					; sub_41FD2E+491j
		cmp	[ebp+var_C], 0
		jnz	loc_420622
		mov	eax, [ebp+var_48]
		test	eax, eax
		jnz	short loc_4201E9
		mov	eax, [ebp+var_4C]
		cmp	eax, 10h
		jz	short loc_4201F5

loc_4201E9:				; CODE XREF: sub_41FD2E+4B1j
		mov	[ebp+var_1C], offset aUnsupportedRef ; "unsupported reference type"
		jmp	loc_42066B
; ---------------------------------------------------------------------------

loc_4201F5:				; CODE XREF: sub_41FD2E+4B9j
		mov	eax, [ebp+var_40]
		mov	[ebp+var_5C], eax
		mov	dword ptr [ebp+var_18],	574h
		mov	[esp+0A8h+var_88], 6
		lea	eax, [ebp+var_44]
		mov	[esp+0A8h+var_8C], eax
		lea	eax, [ebp+var_40]
		mov	[esp+0A8h+var_90], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+var_94], eax
		lea	eax, [ebp+var_50]
		mov	[esp+0A8h+var_98], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+var_9C], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0A8h+Src],	eax
		lea	eax, [ebp+var_58]
		mov	[esp+0A8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_420268
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_5C]
		cmp	edx, eax
		jbe	short loc_420268
		mov	[esp+0A8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_420268:				; CODE XREF: sub_41FD2E+51Fj
					; sub_41FD2E+529j
		cmp	[ebp+var_C], 0
		jnz	loc_420625
		mov	eax, [ebp+var_48]
		test	eax, eax
		jnz	short loc_420292
		mov	eax, [ebp+var_4C]
		cmp	eax, 4
		jnz	short loc_420292
		mov	eax, [ebp+var_40]
		test	eax, eax
		jz	short loc_420292
		mov	eax, [ebp+var_40]
		and	eax, 1
		test	al, al
		jz	short loc_42029E

loc_420292:				; CODE XREF: sub_41FD2E+549j
					; sub_41FD2E+551j ...
		mov	[ebp+var_1C], offset aInvalidPathRef ; "invalid	path reference"
		jmp	loc_42062C
; ---------------------------------------------------------------------------

loc_42029E:				; CODE XREF: sub_41FD2E+562j
		mov	eax, [ebp+var_40]
		shr	eax, 1
		add	eax, 13h
		add	eax, eax
		mov	[esp+0A8h+Src],	eax
		mov	[esp+0A8h+Dst],	1
		call	gcry_calloc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_4202CE
		call	sub_41D9E7
		mov	[ebp+var_C], eax
		jmp	loc_42068A
; ---------------------------------------------------------------------------

loc_4202CE:				; CODE XREF: sub_41FD2E+591j
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_2C]
		mov	[esp+0A8h+Dst],	eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[eax+8], edx
		mov	eax, [ebp+var_20]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_42030C
		call	sub_41D9E7
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_20]
		mov	[esp+0A8h+Dst],	eax
		call	gcry_free
		jmp	loc_42068A
; ---------------------------------------------------------------------------

loc_42030C:				; CODE XREF: sub_41FD2E+5C4j
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_20]
		mov	eax, [eax+8]
		mov	ecx, [ebp+var_2C]
		mov	[esp+0A8h+Size], ecx ; Size
		mov	[esp+0A8h+Src],	edx ; Src
		mov	[esp+0A8h+Dst],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_40]
		mov	edx, eax
		shr	edx, 1
		mov	eax, [ebp+var_20]
		mov	[eax+20h], edx
		mov	[ebp+var_14], 0
		jmp	short loc_420380
; ---------------------------------------------------------------------------

loc_42033E:				; CODE XREF: sub_41FD2E+65Dj
		mov	eax, [ebp+var_58]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 8
		mov	edx, eax
		mov	eax, [ebp+var_58]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, edx
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	ecx, [ebp+var_14]
		add	ecx, 10h
		mov	[eax+ecx*2+4], dx
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_58]
		add	eax, 2
		mov	[ebp+var_58], eax
		mov	eax, [ebp+var_5C]
		sub	eax, 2
		mov	[ebp+var_5C], eax

loc_420380:				; CODE XREF: sub_41FD2E+60Ej
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_20]
		mov	eax, [eax+20h]
		cmp	edx, eax
		jb	short loc_42033E
		mov	eax, [ebp+var_5C]
		test	eax, eax
		jz	loc_420530
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+14h], 1
		mov	dword ptr [ebp+var_18],	59Fh
		mov	[esp+0A8h+var_88], 6
		lea	eax, [ebp+var_44]
		mov	[esp+0A8h+var_8C], eax
		lea	eax, [ebp+var_40]
		mov	[esp+0A8h+var_90], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+var_94], eax
		lea	eax, [ebp+var_50]
		mov	[esp+0A8h+var_98], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+var_9C], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0A8h+Src],	eax
		lea	eax, [ebp+var_58]
		mov	[esp+0A8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_42041E
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_5C]
		cmp	edx, eax
		ja	short loc_42040F
		mov	eax, [ebp+var_48]
		test	eax, eax
		jnz	short loc_42040F
		mov	eax, [ebp+var_4C]
		cmp	eax, 2
		jz	short loc_42041E

loc_42040F:				; CODE XREF: sub_41FD2E+6D0j
					; sub_41FD2E+6D7j
		mov	[esp+0A8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_42041E:				; CODE XREF: sub_41FD2E+6C6j
					; sub_41FD2E+6DFj
		cmp	[ebp+var_C], 0
		jnz	loc_420628
		mov	[ebp+var_24], 0
		jmp	short loc_420459
; ---------------------------------------------------------------------------

loc_420431:				; CODE XREF: sub_41FD2E+730j
		shl	[ebp+var_24], 8
		mov	eax, [ebp+var_58]
		movzx	edx, byte ptr [eax]
		movzx	edx, dl
		or	[ebp+var_24], edx
		add	eax, 1
		mov	[ebp+var_58], eax
		mov	eax, [ebp+var_5C]
		sub	eax, 1
		mov	[ebp+var_5C], eax
		mov	eax, [ebp+var_40]
		sub	eax, 1
		mov	[ebp+var_40], eax

loc_420459:				; CODE XREF: sub_41FD2E+701j
		mov	eax, [ebp+var_40]
		test	eax, eax
		jnz	short loc_420431
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_24]
		mov	[eax+18h], edx
		mov	dword ptr [ebp+var_18],	5B0h
		mov	[esp+0A8h+var_88], 6
		lea	eax, [ebp+var_44]
		mov	[esp+0A8h+var_8C], eax
		lea	eax, [ebp+var_40]
		mov	[esp+0A8h+var_90], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0A8h+var_94], eax
		lea	eax, [ebp+var_50]
		mov	[esp+0A8h+var_98], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0A8h+var_9C], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0A8h+Size], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0A8h+Src],	eax
		lea	eax, [ebp+var_58]
		mov	[esp+0A8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4204E5
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_5C]
		cmp	edx, eax
		ja	short loc_4204D6
		mov	eax, [ebp+var_48]
		cmp	eax, 2
		jnz	short loc_4204D6
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jz	short loc_4204E5

loc_4204D6:				; CODE XREF: sub_41FD2E+797j
					; sub_41FD2E+79Fj
		mov	[esp+0A8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_4204E5:				; CODE XREF: sub_41FD2E+78Dj
					; sub_41FD2E+7A6j
		cmp	[ebp+var_C], 0
		jnz	loc_42062B
		mov	[ebp+var_24], 0
		jmp	short loc_420520
; ---------------------------------------------------------------------------

loc_4204F8:				; CODE XREF: sub_41FD2E+7F7j
		shl	[ebp+var_24], 8
		mov	eax, [ebp+var_58]
		movzx	edx, byte ptr [eax]
		movzx	edx, dl
		or	[ebp+var_24], edx
		add	eax, 1
		mov	[ebp+var_58], eax
		mov	eax, [ebp+var_5C]
		sub	eax, 1
		mov	[ebp+var_5C], eax
		mov	eax, [ebp+var_40]
		sub	eax, 1
		mov	[ebp+var_40], eax

loc_420520:				; CODE XREF: sub_41FD2E+7C8j
		mov	eax, [ebp+var_40]
		test	eax, eax
		jnz	short loc_4204F8
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_24]
		mov	[eax+1Ch], edx

loc_420530:				; CODE XREF: sub_41FD2E+664j
		movzx	eax, [ebp+var_6C]
		mov	[esp+0A8h+Src],	eax ; char
		mov	[esp+0A8h+Dst],	offset aCdf04hxId ; "CDF %04hX:	id="
		call	sub_43CBBE
		mov	[ebp+var_14], 0
		jmp	short loc_420572
; ---------------------------------------------------------------------------

loc_42054D:				; CODE XREF: sub_41FD2E+84Fj
		mov	eax, [ebp+var_20]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_14]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+0A8h+Src],	eax ; char
		mov	[esp+0A8h+Dst],	offset a02x_0 ;	"%02X"
		call	sub_43CBE8
		add	[ebp+var_14], 1

loc_420572:				; CODE XREF: sub_41FD2E+81Dj
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_20]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	short loc_42054D
		mov	[esp+0A8h+Dst],	offset aPath ; " path="
		call	sub_43CBE8
		mov	[ebp+var_14], 0
		jmp	short loc_4205B9
; ---------------------------------------------------------------------------

loc_420594:				; CODE XREF: sub_41FD2E+896j
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_14]
		add	edx, 10h
		movzx	eax, word ptr [eax+edx*2+4]
		movzx	eax, ax
		mov	[esp+0A8h+Src],	eax ; char
		mov	[esp+0A8h+Dst],	offset a04hx ; "%04hX"
		call	sub_43CBE8
		add	[ebp+var_14], 1

loc_4205B9:				; CODE XREF: sub_41FD2E+864j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_20]
		mov	eax, [eax+20h]
		cmp	edx, eax
		jb	short loc_420594
		mov	eax, [ebp+var_20]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_4205F0
		mov	eax, [ebp+var_20]
		mov	edx, [eax+1Ch]
		mov	eax, [ebp+var_20]
		mov	eax, [eax+18h]
		mov	[esp+0A8h+Size], edx
		mov	[esp+0A8h+Src],	eax ; char
		mov	[esp+0A8h+Dst],	offset aLuLu ; "[%lu/%lu]"
		call	sub_43CBE8

loc_4205F0:				; CODE XREF: sub_41FD2E+8A0j
		mov	[esp+0A8h+Dst],	offset asc_44C4EF ; "\n"
		call	sub_43CBE8
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	[ebp+var_10], eax
		mov	[ebp+var_20], 0
		jmp	short loc_42066B
; ---------------------------------------------------------------------------

loc_420613:				; CODE XREF: sub_41FD2E+1C5j
		nop
		jmp	short loc_42062C
; ---------------------------------------------------------------------------

loc_420616:				; CODE XREF: sub_41FD2E+25Ej
		nop
		jmp	short loc_42062C
; ---------------------------------------------------------------------------

loc_420619:				; CODE XREF: sub_41FD2E+30Aj
		nop
		jmp	short loc_42062C
; ---------------------------------------------------------------------------

loc_42061C:				; CODE XREF: sub_41FD2E+39Dj
		nop
		jmp	short loc_42062C
; ---------------------------------------------------------------------------

loc_42061F:				; CODE XREF: sub_41FD2E+429j
		nop
		jmp	short loc_42062C
; ---------------------------------------------------------------------------

loc_420622:				; CODE XREF: sub_41FD2E+4A6j
		nop
		jmp	short loc_42062C
; ---------------------------------------------------------------------------

loc_420625:				; CODE XREF: sub_41FD2E+53Ej
		nop
		jmp	short loc_42062C
; ---------------------------------------------------------------------------

loc_420628:				; CODE XREF: sub_41FD2E+6F4j
		nop
		jmp	short loc_42062C
; ---------------------------------------------------------------------------

loc_42062B:				; CODE XREF: sub_41FD2E+7BBj
		nop

loc_42062C:				; CODE XREF: sub_41FD2E+56Bj
					; sub_41FD2E+8E6j ...
		cmp	[ebp+var_1C], 0
		jnz	short loc_42063F
		mov	eax, [ebp+var_C]
		mov	[esp+0A8h+Dst],	eax
		call	gpg_strerror
		jmp	short loc_420642
; ---------------------------------------------------------------------------

loc_42063F:				; CODE XREF: sub_41FD2E+902j
		mov	eax, [ebp+var_1C]

loc_420642:				; CODE XREF: sub_41FD2E+90Fj
		mov	[esp+0A8h+Size], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+0A8h+Src],	eax ; char
		mov	[esp+0A8h+Dst],	offset aErrorParsing_1 ; "error	parsing	CDF record (%d): %s - ski"...
		call	sub_43CB21
		mov	eax, [ebp+var_20]
		mov	[esp+0A8h+Dst],	eax
		call	gcry_free
		mov	[ebp+var_C], 0

loc_42066B:				; CODE XREF: sub_41FD2E+7Fj
					; sub_41FD2E+4C2j ...
		mov	eax, [ebp+var_3C]
		test	eax, eax
		jz	short loc_42068A
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42068A
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FFh
		jnz	loc_41FDB2

loc_42068A:				; CODE XREF: sub_41FD2E+121j
					; sub_41FD2E+59Bj ...
		mov	eax, [ebp+var_30]
		mov	[esp+0A8h+Dst],	eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_4206A8
		mov	eax, [ebp+var_10]
		mov	[esp+0A8h+Dst],	eax
		call	sub_41D9FC
		jmp	short loc_4206B0
; ---------------------------------------------------------------------------

loc_4206A8:				; CODE XREF: sub_41FD2E+96Bj
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_4206B0:				; CODE XREF: sub_41FD2E+978j
		mov	eax, [ebp+var_C]

locret_4206B3:				; CODE XREF: sub_41FD2E+31j
					; sub_41FD2E+6Ej
		leave
		retn
sub_41FD2E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4206B5	proc near		; CODE XREF: sub_422340+2B8p

Dst		= dword	ptr -0F8h
Src		= dword	ptr -0F4h
Size		= dword	ptr -0F0h
var_EC		= dword	ptr -0ECh
var_E8		= dword	ptr -0E8h
var_E4		= dword	ptr -0E4h
var_E0		= dword	ptr -0E0h
var_DC		= dword	ptr -0DCh
var_D8		= dword	ptr -0D8h
var_BC		= word ptr -0BCh
Dest		= byte ptr -0B2h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= byte ptr -60h
var_5C		= byte ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= byte ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 0F8h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_BC], ax
		mov	[ebp+var_3C], 0
		mov	[ebp+var_10], 0
		cmp	[ebp+var_BC], 0
		jnz	short loc_4206F1
		mov	[esp+0F8h+Dst],	3Ah
		call	sub_41D9BF
		jmp	locret_422054
; ---------------------------------------------------------------------------

loc_4206F1:				; CODE XREF: sub_4206B5+29j
		movzx	edx, [ebp+var_BC]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	ecx, [ebp+var_40]
		mov	[esp+0F8h+var_E8], ecx
		lea	ecx, [ebp+var_3C]
		mov	[esp+0F8h+var_EC], ecx
		mov	[esp+0F8h+Size], offset	aAodf ;	"AODF"
		mov	[esp+0F8h+Src],	edx
		mov	[esp+0F8h+Dst],	eax
		call	sub_41DB8C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_420731
		mov	eax, [ebp+var_C]
		jmp	locret_422054
; ---------------------------------------------------------------------------

loc_420731:				; CODE XREF: sub_4206B5+72j
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_44], eax
		mov	eax, [ebp+var_40]
		mov	[ebp+var_48], eax
		jmp	loc_42200C
; ---------------------------------------------------------------------------

loc_420742:				; CODE XREF: sub_4206B5+1970j
		mov	[ebp+var_1C], 0
		mov	[ebp+var_38], 0
		mov	[esp+0F8h+var_D8], 6
		lea	eax, [ebp+var_50]
		mov	[esp+0F8h+var_DC], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0F8h+var_E0], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0F8h+var_E4], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0F8h+var_E8], eax
		lea	eax, [ebp+var_58]
		mov	[esp+0F8h+var_EC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0F8h+Size], eax
		lea	eax, [ebp+var_48]
		mov	[esp+0F8h+Src],	eax
		lea	eax, [ebp+var_44]
		mov	[esp+0F8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4207BE
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_48]
		cmp	edx, eax
		ja	short loc_4207AF
		mov	eax, [ebp+var_58]
		cmp	eax, 10h
		jz	short loc_4207BE

loc_4207AF:				; CODE XREF: sub_4206B5+F0j
		mov	[esp+0F8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_4207BE:				; CODE XREF: sub_4206B5+E6j
					; sub_4206B5+F8j
		cmp	[ebp+var_C], 0
		jz	short loc_4207E4
		mov	eax, [ebp+var_C]
		mov	[esp+0F8h+Dst],	eax
		call	gpg_strerror
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset aErrorParsingAo ; "error	parsing	AODF record: %s\n"
		call	sub_43CB21
		jmp	loc_42202B
; ---------------------------------------------------------------------------

loc_4207E4:				; CODE XREF: sub_4206B5+10Dj
		mov	eax, [ebp+var_44]
		mov	[ebp+var_64], eax
		mov	eax, [ebp+var_4C]
		mov	[ebp+var_68], eax
		mov	edx, [ebp+var_44]
		mov	eax, [ebp+var_4C]
		add	eax, edx
		mov	[ebp+var_44], eax
		mov	edx, [ebp+var_48]
		mov	eax, [ebp+var_4C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_48], eax
		mov	[esp+0F8h+Src],	50h
		mov	[esp+0F8h+Dst],	1
		call	gcry_calloc
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0
		jz	loc_421F71
		mov	dword ptr [ebp+var_18],	641h
		mov	[esp+0F8h+var_D8], 6
		lea	eax, [ebp+var_50]
		mov	[esp+0F8h+var_DC], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0F8h+var_E0], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0F8h+var_E4], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0F8h+var_E8], eax
		lea	eax, [ebp+var_58]
		mov	[esp+0F8h+var_EC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0F8h+Size], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0F8h+Src],	eax
		lea	eax, [ebp+var_64]
		mov	[esp+0F8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4208A0
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_68]
		cmp	edx, eax
		ja	short loc_420891
		mov	eax, [ebp+var_58]
		cmp	eax, 10h
		jz	short loc_4208A0

loc_420891:				; CODE XREF: sub_4206B5+1D2j
		mov	[esp+0F8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_4208A0:				; CODE XREF: sub_4206B5+1C8j
					; sub_4206B5+1DAj
		cmp	[ebp+var_C], 0
		jnz	loc_421F93
		mov	eax, [ebp+var_64]
		mov	[ebp+var_6C], eax
		mov	eax, [ebp+var_4C]
		mov	[ebp+var_70], eax
		mov	edx, [ebp+var_64]
		mov	eax, [ebp+var_4C]
		add	eax, edx
		mov	[ebp+var_64], eax
		mov	edx, [ebp+var_68]
		mov	eax, [ebp+var_4C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_68], eax
		mov	dword ptr [ebp+var_18],	652h
		mov	[esp+0F8h+var_D8], 6
		lea	eax, [ebp+var_50]
		mov	[esp+0F8h+var_DC], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0F8h+var_E0], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0F8h+var_E4], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0F8h+var_E8], eax
		lea	eax, [ebp+var_58]
		mov	[esp+0F8h+var_EC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0F8h+Size], eax
		lea	eax, [ebp+var_70]
		mov	[esp+0F8h+Src],	eax
		lea	eax, [ebp+var_6C]
		mov	[esp+0F8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_420944
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_70]
		cmp	edx, eax
		ja	short loc_420935
		mov	eax, [ebp+var_54]
		test	eax, eax
		jz	short loc_420944

loc_420935:				; CODE XREF: sub_4206B5+277j
		mov	[esp+0F8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_420944:				; CODE XREF: sub_4206B5+26Dj
					; sub_4206B5+27Ej
		mov	eax, [ebp+var_C]
		mov	[esp+0F8h+Dst],	eax
		call	sub_41D9DA
		cmp	eax, 3FFFh
		jz	loc_420B2D
		cmp	[ebp+var_C], 0
		jnz	loc_421F96
		mov	eax, [ebp+var_58]
		cmp	eax, 0Ch
		jnz	loc_420A1E
		mov	edx, [ebp+var_6C]
		mov	eax, [ebp+var_4C]
		add	eax, edx
		mov	[ebp+var_6C], eax
		mov	edx, [ebp+var_70]
		mov	eax, [ebp+var_4C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_70], eax
		mov	dword ptr [ebp+var_18],	660h
		mov	[esp+0F8h+var_D8], 6
		lea	eax, [ebp+var_50]
		mov	[esp+0F8h+var_DC], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0F8h+var_E0], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0F8h+var_E4], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0F8h+var_E8], eax
		lea	eax, [ebp+var_58]
		mov	[esp+0F8h+var_EC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0F8h+Size], eax
		lea	eax, [ebp+var_70]
		mov	[esp+0F8h+Src],	eax
		lea	eax, [ebp+var_6C]
		mov	[esp+0F8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4209FE
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_70]
		cmp	edx, eax
		ja	short loc_4209EF
		mov	eax, [ebp+var_54]
		test	eax, eax
		jz	short loc_4209FE

loc_4209EF:				; CODE XREF: sub_4206B5+331j
		mov	[esp+0F8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_4209FE:				; CODE XREF: sub_4206B5+327j
					; sub_4206B5+338j
		mov	eax, [ebp+var_C]
		mov	[esp+0F8h+Dst],	eax
		call	sub_41D9DA
		cmp	eax, 3FFFh
		jz	loc_420B30
		cmp	[ebp+var_C], 0
		jnz	loc_421F99

loc_420A1E:				; CODE XREF: sub_4206B5+2B5j
		mov	eax, [ebp+var_58]
		cmp	eax, 3
		jnz	loc_420AD4
		mov	edx, [ebp+var_6C]
		mov	eax, [ebp+var_4C]
		add	eax, edx
		mov	[ebp+var_6C], eax
		mov	edx, [ebp+var_70]
		mov	eax, [ebp+var_4C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_70], eax
		mov	dword ptr [ebp+var_18],	66Fh
		mov	[esp+0F8h+var_D8], 6
		lea	eax, [ebp+var_50]
		mov	[esp+0F8h+var_DC], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0F8h+var_E0], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0F8h+var_E4], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0F8h+var_E8], eax
		lea	eax, [ebp+var_58]
		mov	[esp+0F8h+var_EC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0F8h+Size], eax
		lea	eax, [ebp+var_70]
		mov	[esp+0F8h+Src],	eax
		lea	eax, [ebp+var_6C]
		mov	[esp+0F8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_420AB8
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_70]
		cmp	edx, eax
		ja	short loc_420AA9
		mov	eax, [ebp+var_54]
		test	eax, eax
		jz	short loc_420AB8

loc_420AA9:				; CODE XREF: sub_4206B5+3EBj
		mov	[esp+0F8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_420AB8:				; CODE XREF: sub_4206B5+3E1j
					; sub_4206B5+3F2j
		mov	eax, [ebp+var_C]
		mov	[esp+0F8h+Dst],	eax
		call	sub_41D9DA
		cmp	eax, 3FFFh
		jz	short loc_420B33
		cmp	[ebp+var_C], 0
		jnz	loc_421F9C

loc_420AD4:				; CODE XREF: sub_4206B5+36Fj
		mov	eax, [ebp+var_58]
		cmp	eax, 4
		jnz	short loc_420B34
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jz	short loc_420B34
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_38]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_4C]
		mov	[esp+0F8h+Dst],	eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+var_38]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_38]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	loc_421F74
		mov	ecx, [ebp+var_4C]
		mov	eax, [ebp+var_6C]
		mov	edx, eax
		mov	eax, [ebp+var_38]
		mov	eax, [eax+10h]
		mov	[esp+0F8h+Size], ecx ; Size
		mov	[esp+0F8h+Src],	edx ; Src
		mov	[esp+0F8h+Dst],	eax ; Dst
		call	memcpy
		jmp	short loc_420B34
; ---------------------------------------------------------------------------

loc_420B2D:				; CODE XREF: sub_4206B5+29Fj
		nop
		jmp	short loc_420B34
; ---------------------------------------------------------------------------

loc_420B30:				; CODE XREF: sub_4206B5+359j
		nop
		jmp	short loc_420B34
; ---------------------------------------------------------------------------

loc_420B33:				; CODE XREF: sub_4206B5+413j
		nop

loc_420B34:				; CODE XREF: sub_4206B5+425j
					; sub_4206B5+42Cj ...
		mov	dword ptr [ebp+var_18],	686h
		mov	[esp+0F8h+var_D8], 6
		lea	eax, [ebp+var_50]
		mov	[esp+0F8h+var_DC], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0F8h+var_E0], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0F8h+var_E4], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0F8h+var_E8], eax
		lea	eax, [ebp+var_58]
		mov	[esp+0F8h+var_EC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0F8h+Size], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0F8h+Src],	eax
		lea	eax, [ebp+var_64]
		mov	[esp+0F8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_420BA9
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_68]
		cmp	edx, eax
		ja	short loc_420B9A
		mov	eax, [ebp+var_58]
		cmp	eax, 10h
		jz	short loc_420BA9

loc_420B9A:				; CODE XREF: sub_4206B5+4DBj
		mov	[esp+0F8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_420BA9:				; CODE XREF: sub_4206B5+4D1j
					; sub_4206B5+4E3j
		cmp	[ebp+var_C], 0
		jnz	loc_421F9F
		mov	eax, [ebp+var_64]
		mov	[ebp+var_74], eax
		mov	eax, [ebp+var_4C]
		mov	[ebp+var_78], eax
		mov	edx, [ebp+var_64]
		mov	eax, [ebp+var_4C]
		add	eax, edx
		mov	[ebp+var_64], eax
		mov	edx, [ebp+var_68]
		mov	eax, [ebp+var_4C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_68], eax
		mov	dword ptr [ebp+var_18],	695h
		mov	[esp+0F8h+var_D8], 6
		lea	eax, [ebp+var_50]
		mov	[esp+0F8h+var_DC], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0F8h+var_E0], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0F8h+var_E4], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0F8h+var_E8], eax
		lea	eax, [ebp+var_58]
		mov	[esp+0F8h+var_EC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0F8h+Size], eax
		lea	eax, [ebp+var_78]
		mov	[esp+0F8h+Src],	eax
		lea	eax, [ebp+var_74]
		mov	[esp+0F8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_420C55
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_78]
		cmp	edx, eax
		ja	short loc_420C46
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	short loc_420C46
		mov	eax, [ebp+var_58]
		cmp	eax, 4
		jz	short loc_420C55

loc_420C46:				; CODE XREF: sub_4206B5+580j
					; sub_4206B5+587j
		mov	[esp+0F8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_420C55:				; CODE XREF: sub_4206B5+576j
					; sub_4206B5+58Fj
		cmp	[ebp+var_C], 0
		jnz	loc_421FA2
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_38]
		mov	[eax+4], edx
		mov	eax, [ebp+var_4C]
		mov	[esp+0F8h+Dst],	eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+var_38]
		mov	[eax+8], edx
		mov	eax, [ebp+var_38]
		mov	eax, [eax+8]
		test	eax, eax
		jz	loc_421F77
		mov	ecx, [ebp+var_4C]
		mov	eax, [ebp+var_74]
		mov	edx, eax
		mov	eax, [ebp+var_38]
		mov	eax, [eax+8]
		mov	[esp+0F8h+Size], ecx ; Size
		mov	[esp+0F8h+Src],	edx ; Src
		mov	[esp+0F8h+Dst],	eax ; Dst
		call	memcpy
		mov	dword ptr [ebp+var_18],	6A6h
		mov	[esp+0F8h+var_D8], 6
		lea	eax, [ebp+var_50]
		mov	[esp+0F8h+var_DC], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0F8h+var_E0], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0F8h+var_E4], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0F8h+var_E8], eax
		lea	eax, [ebp+var_58]
		mov	[esp+0F8h+var_EC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0F8h+Size], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0F8h+Src],	eax
		lea	eax, [ebp+var_64]
		mov	[esp+0F8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_420D24
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_68]
		cmp	edx, eax
		ja	short loc_420D15
		mov	eax, [ebp+var_54]
		cmp	eax, 2
		jnz	short loc_420D15
		mov	eax, [ebp+var_58]
		cmp	eax, 1
		jz	short loc_420D24

loc_420D15:				; CODE XREF: sub_4206B5+64Ej
					; sub_4206B5+656j
		mov	[esp+0F8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_420D24:				; CODE XREF: sub_4206B5+644j
					; sub_4206B5+65Ej
		cmp	[ebp+var_C], 0
		jnz	loc_421FA5
		mov	eax, [ebp+var_4C]
		mov	[ebp+var_68], eax
		mov	dword ptr [ebp+var_18],	6AFh
		mov	[esp+0F8h+var_D8], 6
		lea	eax, [ebp+var_50]
		mov	[esp+0F8h+var_DC], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0F8h+var_E0], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0F8h+var_E4], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0F8h+var_E8], eax
		lea	eax, [ebp+var_58]
		mov	[esp+0F8h+var_EC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0F8h+Size], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0F8h+Src],	eax
		lea	eax, [ebp+var_64]
		mov	[esp+0F8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_420DA1
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_68]
		cmp	edx, eax
		jbe	short loc_420DA1
		mov	[esp+0F8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_420DA1:				; CODE XREF: sub_4206B5+6D1j
					; sub_4206B5+6DBj
		cmp	[ebp+var_C], 0
		jnz	loc_421FA8
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	short loc_420DBA
		mov	eax, [ebp+var_58]
		cmp	eax, 10h
		jz	short loc_420E0F

loc_420DBA:				; CODE XREF: sub_4206B5+6FBj
		mov	eax, [ebp+var_54]
		cmp	eax, 2
		jnz	short loc_420DFB
		mov	eax, [ebp+var_58]
		cmp	eax, 1
		jz	short loc_420DDC
		cmp	eax, 2
		jz	short loc_420DE5
		test	eax, eax
		jnz	short loc_420DEE
		mov	[ebp+var_1C], offset aBiometricAuthT ; "biometric auth types are not supported"
		jmp	short loc_420DF6
; ---------------------------------------------------------------------------

loc_420DDC:				; CODE XREF: sub_4206B5+713j
		mov	[ebp+var_1C], offset aAuthkeyAuthTyp ; "authKey	auth types are not supported"
		jmp	short loc_420DF6
; ---------------------------------------------------------------------------

loc_420DE5:				; CODE XREF: sub_4206B5+718j
		mov	[ebp+var_1C], offset aExternalAuthTy ; "external auth type are not supported"
		jmp	short loc_420DF6
; ---------------------------------------------------------------------------

loc_420DEE:				; CODE XREF: sub_4206B5+71Cj
		mov	[ebp+var_1C], offset aUnknownPrivate ; "unknown	privateKeyObject"
		nop

loc_420DF6:				; CODE XREF: sub_4206B5+725j
					; sub_4206B5+72Ej ...
		jmp	loc_421FCD
; ---------------------------------------------------------------------------

loc_420DFB:				; CODE XREF: sub_4206B5+70Bj
		mov	[esp+0F8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax
		jmp	loc_421FCD
; ---------------------------------------------------------------------------

loc_420E0F:				; CODE XREF: sub_4206B5+703j
		mov	eax, [ebp+var_4C]
		mov	[ebp+var_68], eax
		mov	dword ptr [ebp+var_18],	6CCh
		mov	[esp+0F8h+var_D8], 6
		lea	eax, [ebp+var_50]
		mov	[esp+0F8h+var_DC], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0F8h+var_E0], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0F8h+var_E4], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0F8h+var_E8], eax
		lea	eax, [ebp+var_58]
		mov	[esp+0F8h+var_EC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0F8h+Size], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0F8h+Src],	eax
		lea	eax, [ebp+var_64]
		mov	[esp+0F8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_420E98
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_68]
		cmp	edx, eax
		ja	short loc_420E89
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jz	short loc_420E89
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	short loc_420E89
		mov	eax, [ebp+var_58]
		cmp	eax, 3
		jz	short loc_420E98

loc_420E89:				; CODE XREF: sub_4206B5+7BCj
					; sub_4206B5+7C3j ...
		mov	[esp+0F8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_420E98:				; CODE XREF: sub_4206B5+7B2j
					; sub_4206B5+7D2j
		cmp	[ebp+var_C], 0
		jnz	loc_421FAB
		mov	eax, [ebp+var_64]
		movzx	edx, byte ptr [eax]
		movzx	edx, dl
		mov	[ebp+var_30], edx
		add	eax, 1
		mov	[ebp+var_64], eax
		mov	eax, [ebp+var_68]
		sub	eax, 1
		mov	[ebp+var_68], eax
		mov	eax, [ebp+var_4C]
		sub	eax, 1
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	short loc_420ED3
		cmp	[ebp+var_30], 0
		jnz	short loc_420EEA

loc_420ED3:				; CODE XREF: sub_4206B5+816j
		mov	eax, [ebp+var_30]
		lea	edx, [eax+7]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 3
		mov	edx, eax
		mov	eax, [ebp+var_4C]
		cmp	edx, eax
		jbe	short loc_420EFE

loc_420EEA:				; CODE XREF: sub_4206B5+81Cj
		mov	[esp+0F8h+Dst],	9Bh
		call	sub_41D9BF
		mov	[ebp+var_C], eax
		jmp	loc_421FCD
; ---------------------------------------------------------------------------

loc_420EFE:				; CODE XREF: sub_4206B5+833j
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_30]
		add	eax, 7
		lea	ecx, [eax+7]
		test	eax, eax
		cmovs	eax, ecx
		sar	eax, 3
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_30]
		mov	edx, eax
		sar	edx, 1Fh
		shr	edx, 1Dh
		add	eax, edx
		and	eax, 7
		sub	eax, edx
		mov	[ebp+var_30], eax
		mov	[ebp+var_2C], 0
		mov	[ebp+var_14], 1
		jmp	short loc_420F4D
; ---------------------------------------------------------------------------

loc_420F40:				; CODE XREF: sub_4206B5+89Cj
		mov	eax, [ebp+var_14]
		or	[ebp+var_2C], eax
		shl	[ebp+var_14], 1
		sub	[ebp+var_30], 1

loc_420F4D:				; CODE XREF: sub_4206B5+889j
		cmp	[ebp+var_30], 0
		jnz	short loc_420F40
		mov	[ebp+var_28], 0
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jz	short loc_420FA0
		mov	eax, [ebp+var_64]
		movzx	edx, byte ptr [eax]
		movzx	edx, dl
		mov	[ebp+var_28], edx
		add	eax, 1
		mov	[ebp+var_64], eax
		mov	eax, [ebp+var_68]
		sub	eax, 1
		mov	[ebp+var_68], eax
		mov	eax, [ebp+var_4C]
		sub	eax, 1
		mov	[ebp+var_4C], eax
		cmp	[ebp+var_34], 0
		jz	short loc_420F91
		sub	[ebp+var_34], 1
		jmp	short loc_420FA0
; ---------------------------------------------------------------------------

loc_420F91:				; CODE XREF: sub_4206B5+8D4j
		mov	eax, [ebp+var_2C]
		not	eax
		and	[ebp+var_28], eax
		mov	[ebp+var_2C], 0

loc_420FA0:				; CODE XREF: sub_4206B5+8AAj
					; sub_4206B5+8DAj
		mov	eax, [ebp+var_28]
		and	eax, 80h
		test	eax, eax
		jz	short loc_420FB9
		mov	eax, [ebp+var_38]
		movzx	edx, byte ptr [eax+14h]
		or	edx, 1
		mov	[eax+14h], dl

loc_420FB9:				; CODE XREF: sub_4206B5+8F5j
		mov	eax, [ebp+var_28]
		and	eax, 40h
		test	eax, eax
		jz	short loc_420FD0
		mov	eax, [ebp+var_38]
		movzx	edx, byte ptr [eax+14h]
		or	edx, 2
		mov	[eax+14h], dl

loc_420FD0:				; CODE XREF: sub_4206B5+90Cj
		mov	eax, [ebp+var_28]
		and	eax, 20h
		test	eax, eax
		jz	short loc_420FE7
		mov	eax, [ebp+var_38]
		movzx	edx, byte ptr [eax+14h]
		or	edx, 4
		mov	[eax+14h], dl

loc_420FE7:				; CODE XREF: sub_4206B5+923j
		mov	eax, [ebp+var_28]
		and	eax, 10h
		test	eax, eax
		jz	short loc_420FFE
		mov	eax, [ebp+var_38]
		movzx	edx, byte ptr [eax+14h]
		or	edx, 8
		mov	[eax+14h], dl

loc_420FFE:				; CODE XREF: sub_4206B5+93Aj
		mov	eax, [ebp+var_28]
		and	eax, 8
		test	eax, eax
		jz	short loc_421015
		mov	eax, [ebp+var_38]
		movzx	edx, byte ptr [eax+14h]
		or	edx, 10h
		mov	[eax+14h], dl

loc_421015:				; CODE XREF: sub_4206B5+951j
		mov	eax, [ebp+var_28]
		and	eax, 4
		test	eax, eax
		jz	short loc_42102C
		mov	eax, [ebp+var_38]
		movzx	edx, byte ptr [eax+14h]
		or	edx, 20h
		mov	[eax+14h], dl

loc_42102C:				; CODE XREF: sub_4206B5+968j
		mov	eax, [ebp+var_28]
		and	eax, 2
		test	eax, eax
		jz	short loc_421043
		mov	eax, [ebp+var_38]
		movzx	edx, byte ptr [eax+14h]
		or	edx, 40h
		mov	[eax+14h], dl

loc_421043:				; CODE XREF: sub_4206B5+97Fj
		mov	eax, [ebp+var_28]
		and	eax, 1
		test	al, al
		jz	short loc_42105A
		mov	eax, [ebp+var_38]
		movzx	edx, byte ptr [eax+14h]
		or	edx, 0FFFFFF80h
		mov	[eax+14h], dl

loc_42105A:				; CODE XREF: sub_4206B5+996j
		mov	[ebp+var_28], 0
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jz	short loc_4210A7
		mov	eax, [ebp+var_64]
		movzx	edx, byte ptr [eax]
		movzx	edx, dl
		mov	[ebp+var_28], edx
		add	eax, 1
		mov	[ebp+var_64], eax
		mov	eax, [ebp+var_68]
		sub	eax, 1
		mov	[ebp+var_68], eax
		mov	eax, [ebp+var_4C]
		sub	eax, 1
		mov	[ebp+var_4C], eax
		cmp	[ebp+var_34], 0
		jz	short loc_421098
		sub	[ebp+var_34], 1
		jmp	short loc_4210A7
; ---------------------------------------------------------------------------

loc_421098:				; CODE XREF: sub_4206B5+9DBj
		mov	eax, [ebp+var_2C]
		not	eax
		and	[ebp+var_28], eax
		mov	[ebp+var_2C], 0

loc_4210A7:				; CODE XREF: sub_4206B5+9B1j
					; sub_4206B5+9E1j
		mov	eax, [ebp+var_28]
		and	eax, 80h
		test	eax, eax
		jz	short loc_4210C0
		mov	eax, [ebp+var_38]
		movzx	edx, byte ptr [eax+15h]
		or	edx, 1
		mov	[eax+15h], dl

loc_4210C0:				; CODE XREF: sub_4206B5+9FCj
		mov	eax, [ebp+var_28]
		and	eax, 40h
		test	eax, eax
		jz	short loc_4210D7
		mov	eax, [ebp+var_38]
		movzx	edx, byte ptr [eax+15h]
		or	edx, 2
		mov	[eax+15h], dl

loc_4210D7:				; CODE XREF: sub_4206B5+A13j
		mov	eax, [ebp+var_28]
		and	eax, 20h
		test	eax, eax
		jz	short loc_4210EE
		mov	eax, [ebp+var_38]
		movzx	edx, byte ptr [eax+15h]
		or	edx, 4
		mov	[eax+15h], dl

loc_4210EE:				; CODE XREF: sub_4206B5+A2Aj
		mov	eax, [ebp+var_28]
		and	eax, 10h
		test	eax, eax
		jz	short loc_421105
		mov	eax, [ebp+var_38]
		movzx	edx, byte ptr [eax+15h]
		or	edx, 8
		mov	[eax+15h], dl

loc_421105:				; CODE XREF: sub_4206B5+A41j
		mov	edx, [ebp+var_64]
		mov	eax, [ebp+var_4C]
		add	eax, edx
		mov	[ebp+var_64], eax
		mov	edx, [ebp+var_68]
		mov	eax, [ebp+var_4C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_68], eax
		mov	dword ptr [ebp+var_18],	71Eh
		mov	[esp+0F8h+var_D8], 6
		lea	eax, [ebp+var_50]
		mov	[esp+0F8h+var_DC], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0F8h+var_E0], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0F8h+var_E4], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0F8h+var_E8], eax
		lea	eax, [ebp+var_58]
		mov	[esp+0F8h+var_EC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0F8h+Size], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0F8h+Src],	eax
		lea	eax, [ebp+var_64]
		mov	[esp+0F8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_42119B
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_68]
		cmp	edx, eax
		ja	short loc_42118C
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	short loc_42118C
		mov	eax, [ebp+var_58]
		cmp	eax, 0Ah
		jz	short loc_42119B

loc_42118C:				; CODE XREF: sub_4206B5+AC6j
					; sub_4206B5+ACDj
		mov	[esp+0F8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_42119B:				; CODE XREF: sub_4206B5+ABCj
					; sub_4206B5+AD5j
		cmp	[ebp+var_C], 0
		jnz	short loc_4211C0
		mov	eax, [ebp+var_4C]
		cmp	eax, 4
		ja	short loc_4211B1
		mov	eax, [ebp+var_4C]
		cmp	eax, 4
		jbe	short loc_4211C0

loc_4211B1:				; CODE XREF: sub_4206B5+AF2j
		mov	[esp+0F8h+Dst],	93h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_4211C0:				; CODE XREF: sub_4206B5+AEAj
					; sub_4206B5+AFAj
		cmp	[ebp+var_C], 0
		jnz	loc_421FAE
		mov	[ebp+var_20], 0
		jmp	short loc_4211FB
; ---------------------------------------------------------------------------

loc_4211D3:				; CODE XREF: sub_4206B5+B4Bj
		shl	[ebp+var_20], 8
		mov	eax, [ebp+var_64]
		movzx	edx, byte ptr [eax]
		movzx	edx, dl
		or	[ebp+var_20], edx
		add	eax, 1
		mov	[ebp+var_64], eax
		mov	eax, [ebp+var_68]
		sub	eax, 1
		mov	[ebp+var_68], eax
		mov	eax, [ebp+var_4C]
		sub	eax, 1
		mov	[ebp+var_4C], eax

loc_4211FB:				; CODE XREF: sub_4206B5+B1Cj
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	short loc_4211D3
		mov	eax, [ebp+var_38]
		mov	edx, [ebp+var_20]
		mov	[eax+18h], edx
		mov	dword ptr [ebp+var_18],	733h
		mov	[esp+0F8h+var_D8], 6
		lea	eax, [ebp+var_50]
		mov	[esp+0F8h+var_DC], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0F8h+var_E0], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0F8h+var_E4], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0F8h+var_E8], eax
		lea	eax, [ebp+var_58]
		mov	[esp+0F8h+var_EC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0F8h+Size], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0F8h+Src],	eax
		lea	eax, [ebp+var_64]
		mov	[esp+0F8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_421287
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_68]
		cmp	edx, eax
		ja	short loc_421278
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	short loc_421278
		mov	eax, [ebp+var_58]
		cmp	eax, 2
		jz	short loc_421287

loc_421278:				; CODE XREF: sub_4206B5+BB2j
					; sub_4206B5+BB9j
		mov	[esp+0F8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_421287:				; CODE XREF: sub_4206B5+BA8j
					; sub_4206B5+BC1j
		cmp	[ebp+var_C], 0
		jnz	short loc_4212A4
		mov	eax, [ebp+var_4C]
		cmp	eax, 4
		jbe	short loc_4212A4
		mov	[esp+0F8h+Dst],	93h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_4212A4:				; CODE XREF: sub_4206B5+BD6j
					; sub_4206B5+BDEj
		cmp	[ebp+var_C], 0
		jnz	loc_421FB1
		mov	[ebp+var_20], 0
		jmp	short loc_4212DF
; ---------------------------------------------------------------------------

loc_4212B7:				; CODE XREF: sub_4206B5+C2Fj
		shl	[ebp+var_20], 8
		mov	eax, [ebp+var_64]
		movzx	edx, byte ptr [eax]
		movzx	edx, dl
		or	[ebp+var_20], edx
		add	eax, 1
		mov	[ebp+var_64], eax
		mov	eax, [ebp+var_68]
		sub	eax, 1
		mov	[ebp+var_68], eax
		mov	eax, [ebp+var_4C]
		sub	eax, 1
		mov	[ebp+var_4C], eax

loc_4212DF:				; CODE XREF: sub_4206B5+C00j
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	short loc_4212B7
		mov	eax, [ebp+var_38]
		mov	edx, [ebp+var_20]
		mov	[eax+1Ch], edx
		mov	dword ptr [ebp+var_18],	747h
		mov	[esp+0F8h+var_D8], 6
		lea	eax, [ebp+var_50]
		mov	[esp+0F8h+var_DC], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0F8h+var_E0], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0F8h+var_E4], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0F8h+var_E8], eax
		lea	eax, [ebp+var_58]
		mov	[esp+0F8h+var_EC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0F8h+Size], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0F8h+Src],	eax
		lea	eax, [ebp+var_64]
		mov	[esp+0F8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_42136B
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_68]
		cmp	edx, eax
		ja	short loc_42135C
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	short loc_42135C
		mov	eax, [ebp+var_58]
		cmp	eax, 2
		jz	short loc_42136B

loc_42135C:				; CODE XREF: sub_4206B5+C96j
					; sub_4206B5+C9Dj
		mov	[esp+0F8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_42136B:				; CODE XREF: sub_4206B5+C8Cj
					; sub_4206B5+CA5j
		cmp	[ebp+var_C], 0
		jnz	short loc_421388
		mov	eax, [ebp+var_4C]
		cmp	eax, 4
		jbe	short loc_421388
		mov	[esp+0F8h+Dst],	93h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_421388:				; CODE XREF: sub_4206B5+CBAj
					; sub_4206B5+CC2j
		cmp	[ebp+var_C], 0
		jnz	loc_421FB4
		mov	[ebp+var_20], 0
		jmp	short loc_4213C3
; ---------------------------------------------------------------------------

loc_42139B:				; CODE XREF: sub_4206B5+D13j
		shl	[ebp+var_20], 8
		mov	eax, [ebp+var_64]
		movzx	edx, byte ptr [eax]
		movzx	edx, dl
		or	[ebp+var_20], edx
		add	eax, 1
		mov	[ebp+var_64], eax
		mov	eax, [ebp+var_68]
		sub	eax, 1
		mov	[ebp+var_68], eax
		mov	eax, [ebp+var_4C]
		sub	eax, 1
		mov	[ebp+var_4C], eax

loc_4213C3:				; CODE XREF: sub_4206B5+CE4j
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	short loc_42139B
		mov	eax, [ebp+var_38]
		mov	edx, [ebp+var_20]
		mov	[eax+20h], edx
		mov	dword ptr [ebp+var_18],	75Ah
		mov	[esp+0F8h+var_D8], 6
		lea	eax, [ebp+var_50]
		mov	[esp+0F8h+var_DC], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0F8h+var_E0], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0F8h+var_E4], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0F8h+var_E8], eax
		lea	eax, [ebp+var_58]
		mov	[esp+0F8h+var_EC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0F8h+Size], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0F8h+Src],	eax
		lea	eax, [ebp+var_64]
		mov	[esp+0F8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+0F8h+Dst],	eax
		call	sub_41D9DA
		cmp	eax, 3FFFh
		jz	loc_421B1D
		cmp	[ebp+var_C], 0
		jnz	short loc_421456
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_68]
		cmp	edx, eax
		jbe	short loc_421456
		mov	[esp+0F8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_421456:				; CODE XREF: sub_4206B5+D86j
					; sub_4206B5+D90j
		cmp	[ebp+var_C], 0
		jnz	loc_421FB7
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	loc_42156B
		mov	eax, [ebp+var_58]
		cmp	eax, 2
		jnz	loc_42156B
		mov	eax, [ebp+var_4C]
		cmp	eax, 4
		jbe	short loc_421493
		mov	[esp+0F8h+Dst],	93h
		call	sub_41D9BF
		mov	[ebp+var_C], eax
		jmp	loc_421FCD
; ---------------------------------------------------------------------------

loc_421493:				; CODE XREF: sub_4206B5+DC8j
		mov	[ebp+var_20], 0
		jmp	short loc_4214C4
; ---------------------------------------------------------------------------

loc_42149C:				; CODE XREF: sub_4206B5+E14j
		shl	[ebp+var_20], 8
		mov	eax, [ebp+var_64]
		movzx	edx, byte ptr [eax]
		movzx	edx, dl
		or	[ebp+var_20], edx
		add	eax, 1
		mov	[ebp+var_64], eax
		mov	eax, [ebp+var_68]
		sub	eax, 1
		mov	[ebp+var_68], eax
		mov	eax, [ebp+var_4C]
		sub	eax, 1
		mov	[ebp+var_4C], eax

loc_4214C4:				; CODE XREF: sub_4206B5+DE5j
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	short loc_42149C
		mov	eax, [ebp+var_38]
		mov	edx, [ebp+var_20]
		mov	[eax+24h], edx
		mov	eax, [ebp+var_38]
		mov	dword ptr [eax+28h], 1
		mov	dword ptr [ebp+var_18],	773h
		mov	[esp+0F8h+var_D8], 6
		lea	eax, [ebp+var_50]
		mov	[esp+0F8h+var_DC], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0F8h+var_E0], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0F8h+var_E4], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0F8h+var_E8], eax
		lea	eax, [ebp+var_58]
		mov	[esp+0F8h+var_EC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0F8h+Size], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0F8h+Src],	eax
		lea	eax, [ebp+var_64]
		mov	[esp+0F8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+0F8h+Dst],	eax
		call	sub_41D9DA
		cmp	eax, 3FFFh
		jz	loc_421B20
		cmp	[ebp+var_C], 0
		jnz	short loc_421561
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_68]
		cmp	edx, eax
		jbe	short loc_421561
		mov	[esp+0F8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_421561:				; CODE XREF: sub_4206B5+E91j
					; sub_4206B5+E9Bj
		cmp	[ebp+var_C], 0
		jnz	loc_421FBA

loc_42156B:				; CODE XREF: sub_4206B5+DB0j
					; sub_4206B5+DBCj
		mov	eax, [ebp+var_54]
		cmp	eax, 2
		jnz	loc_421676
		mov	eax, [ebp+var_58]
		test	eax, eax
		jnz	loc_421676
		mov	eax, [ebp+var_4C]
		cmp	eax, 4
		jbe	short loc_42159E
		mov	[esp+0F8h+Dst],	93h
		call	sub_41D9BF
		mov	[ebp+var_C], eax
		jmp	loc_421FCD
; ---------------------------------------------------------------------------

loc_42159E:				; CODE XREF: sub_4206B5+ED3j
		mov	[ebp+var_20], 0
		jmp	short loc_4215CF
; ---------------------------------------------------------------------------

loc_4215A7:				; CODE XREF: sub_4206B5+F1Fj
		shl	[ebp+var_20], 8
		mov	eax, [ebp+var_64]
		movzx	edx, byte ptr [eax]
		movzx	edx, dl
		or	[ebp+var_20], edx
		add	eax, 1
		mov	[ebp+var_64], eax
		mov	eax, [ebp+var_68]
		sub	eax, 1
		mov	[ebp+var_68], eax
		mov	eax, [ebp+var_4C]
		sub	eax, 1
		mov	[ebp+var_4C], eax

loc_4215CF:				; CODE XREF: sub_4206B5+EF0j
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	short loc_4215A7
		mov	eax, [ebp+var_38]
		mov	edx, [ebp+var_20]
		mov	[eax+2Ch], edx
		mov	eax, [ebp+var_38]
		mov	dword ptr [eax+30h], 1
		mov	dword ptr [ebp+var_18],	78Fh
		mov	[esp+0F8h+var_D8], 6
		lea	eax, [ebp+var_50]
		mov	[esp+0F8h+var_DC], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0F8h+var_E0], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0F8h+var_E4], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0F8h+var_E8], eax
		lea	eax, [ebp+var_58]
		mov	[esp+0F8h+var_EC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0F8h+Size], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0F8h+Src],	eax
		lea	eax, [ebp+var_64]
		mov	[esp+0F8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+0F8h+Dst],	eax
		call	sub_41D9DA
		cmp	eax, 3FFFh
		jz	loc_421B23
		cmp	[ebp+var_C], 0
		jnz	short loc_42166C
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_68]
		cmp	edx, eax
		jbe	short loc_42166C
		mov	[esp+0F8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_42166C:				; CODE XREF: sub_4206B5+F9Cj
					; sub_4206B5+FA6j
		cmp	[ebp+var_C], 0
		jnz	loc_421FBD

loc_421676:				; CODE XREF: sub_4206B5+EBCj
					; sub_4206B5+EC7j
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	loc_421755
		mov	eax, [ebp+var_58]
		cmp	eax, 4
		jnz	loc_421755
		mov	eax, [ebp+var_4C]
		cmp	eax, 1
		jz	short loc_4216A1
		mov	[ebp+var_1C], offset aPadcharIsNotOf ; "padChar	is not of size(1)"
		jmp	loc_421FCD
; ---------------------------------------------------------------------------

loc_4216A1:				; CODE XREF: sub_4206B5+FDEj
		mov	eax, [ebp+var_64]
		movzx	edx, byte ptr [eax]
		mov	ecx, edx
		mov	edx, [ebp+var_38]
		mov	[edx+34h], cl
		add	eax, 1
		mov	[ebp+var_64], eax
		mov	eax, [ebp+var_68]
		sub	eax, 1
		mov	[ebp+var_68], eax
		mov	eax, [ebp+var_38]
		mov	dword ptr [eax+38h], 1
		mov	dword ptr [ebp+var_18],	7A5h
		mov	[esp+0F8h+var_D8], 6
		lea	eax, [ebp+var_50]
		mov	[esp+0F8h+var_DC], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0F8h+var_E0], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0F8h+var_E4], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0F8h+var_E8], eax
		lea	eax, [ebp+var_58]
		mov	[esp+0F8h+var_EC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0F8h+Size], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0F8h+Src],	eax
		lea	eax, [ebp+var_64]
		mov	[esp+0F8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+0F8h+Dst],	eax
		call	sub_41D9DA
		cmp	eax, 3FFFh
		jz	loc_421B26
		cmp	[ebp+var_C], 0
		jnz	short loc_42174B
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_68]
		cmp	edx, eax
		jbe	short loc_42174B
		mov	[esp+0F8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_42174B:				; CODE XREF: sub_4206B5+107Bj
					; sub_4206B5+1085j
		cmp	[ebp+var_C], 0
		jnz	loc_421FC0

loc_421755:				; CODE XREF: sub_4206B5+FC6j
					; sub_4206B5+FD2j
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	loc_421813
		mov	eax, [ebp+var_58]
		cmp	eax, 18h
		jnz	loc_421813
		mov	edx, [ebp+var_64]
		mov	eax, [ebp+var_4C]
		add	eax, edx
		mov	[ebp+var_64], eax
		mov	edx, [ebp+var_68]
		mov	eax, [ebp+var_4C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_68], eax
		mov	dword ptr [ebp+var_18],	7B6h
		mov	[esp+0F8h+var_D8], 6
		lea	eax, [ebp+var_50]
		mov	[esp+0F8h+var_DC], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0F8h+var_E0], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0F8h+var_E4], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0F8h+var_E8], eax
		lea	eax, [ebp+var_58]
		mov	[esp+0F8h+var_EC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0F8h+Size], eax
		lea	eax, [ebp+var_68]
		mov	[esp+0F8h+Src],	eax
		lea	eax, [ebp+var_64]
		mov	[esp+0F8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+0F8h+Dst],	eax
		call	sub_41D9DA
		cmp	eax, 3FFFh
		jz	loc_421B29
		cmp	[ebp+var_C], 0
		jnz	short loc_421809
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_68]
		cmp	edx, eax
		jbe	short loc_421809
		mov	[esp+0F8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_421809:				; CODE XREF: sub_4206B5+1139j
					; sub_4206B5+1143j
		cmp	[ebp+var_C], 0
		jnz	loc_421FC3

loc_421813:				; CODE XREF: sub_4206B5+10A5j
					; sub_4206B5+10B1j
		mov	eax, [ebp+var_54]
		test	eax, eax
		jz	short loc_421826
		mov	eax, [ebp+var_58]
		cmp	eax, 10h
		jnz	loc_421B2A

loc_421826:				; CODE XREF: sub_4206B5+1163j
		mov	eax, [ebp+var_64]
		mov	[ebp+var_7C], eax
		mov	eax, [ebp+var_4C]
		mov	[ebp+var_80], eax
		mov	edx, [ebp+var_64]
		mov	eax, [ebp+var_4C]
		add	eax, edx
		mov	[ebp+var_64], eax
		mov	edx, [ebp+var_68]
		mov	eax, [ebp+var_4C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_68], eax
		mov	dword ptr [ebp+var_18],	7CAh
		mov	[esp+0F8h+var_D8], 6
		lea	eax, [ebp+var_50]
		mov	[esp+0F8h+var_DC], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0F8h+var_E0], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0F8h+var_E4], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0F8h+var_E8], eax
		lea	eax, [ebp+var_58]
		mov	[esp+0F8h+var_EC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0F8h+Size], eax
		lea	eax, [ebp+var_80]
		mov	[esp+0F8h+Src],	eax
		lea	eax, [ebp+var_7C]
		mov	[esp+0F8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4218B9
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_80]
		cmp	edx, eax
		jbe	short loc_4218B9
		mov	[esp+0F8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_4218B9:				; CODE XREF: sub_4206B5+11E9j
					; sub_4206B5+11F3j
		cmp	[ebp+var_C], 0
		jnz	loc_421FC6
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	short loc_4218E3
		mov	eax, [ebp+var_58]
		cmp	eax, 4
		jnz	short loc_4218E3
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jz	short loc_4218E3
		mov	eax, [ebp+var_4C]
		and	eax, 1
		test	al, al
		jz	short loc_4218EF

loc_4218E3:				; CODE XREF: sub_4206B5+1213j
					; sub_4206B5+121Bj ...
		mov	[ebp+var_1C], offset aInvalidPathRef ; "invalid	path reference"
		jmp	loc_421FCD
; ---------------------------------------------------------------------------

loc_4218EF:				; CODE XREF: sub_4206B5+122Cj
		mov	eax, [ebp+var_4C]
		mov	edx, eax
		shr	edx, 1
		mov	eax, [ebp+var_38]
		mov	[eax+48h], edx
		mov	eax, [ebp+var_38]
		mov	eax, [eax+48h]
		mov	[esp+0F8h+Dst],	eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+var_38]
		mov	[eax+4Ch], edx
		mov	eax, [ebp+var_38]
		mov	eax, [eax+4Ch]
		test	eax, eax
		jz	loc_421F7A
		mov	[ebp+var_14], 0
		jmp	short loc_42196B
; ---------------------------------------------------------------------------

loc_421929:				; CODE XREF: sub_4206B5+12C1j
		mov	eax, [ebp+var_38]
		mov	eax, [eax+4Ch]
		mov	edx, [ebp+var_14]
		add	edx, edx
		add	edx, eax
		mov	eax, [ebp+var_7C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 8
		mov	ecx, eax
		mov	eax, [ebp+var_7C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, ecx
		mov	[edx], ax
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_7C]
		add	eax, 2
		mov	[ebp+var_7C], eax
		mov	eax, [ebp+var_80]
		sub	eax, 2
		mov	[ebp+var_80], eax

loc_42196B:				; CODE XREF: sub_4206B5+1272j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_38]
		mov	eax, [eax+48h]
		cmp	edx, eax
		jb	short loc_421929
		mov	eax, [ebp+var_80]
		test	eax, eax
		jz	loc_421B2A
		mov	eax, [ebp+var_38]
		mov	dword ptr [eax+3Ch], 1
		mov	dword ptr [ebp+var_18],	7E6h
		mov	[esp+0F8h+var_D8], 6
		lea	eax, [ebp+var_50]
		mov	[esp+0F8h+var_DC], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0F8h+var_E0], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0F8h+var_E4], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0F8h+var_E8], eax
		lea	eax, [ebp+var_58]
		mov	[esp+0F8h+var_EC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0F8h+Size], eax
		lea	eax, [ebp+var_80]
		mov	[esp+0F8h+Src],	eax
		lea	eax, [ebp+var_7C]
		mov	[esp+0F8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_421A09
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_80]
		cmp	edx, eax
		ja	short loc_4219FA
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	short loc_4219FA
		mov	eax, [ebp+var_58]
		cmp	eax, 2
		jz	short loc_421A09

loc_4219FA:				; CODE XREF: sub_4206B5+1334j
					; sub_4206B5+133Bj
		mov	[esp+0F8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_421A09:				; CODE XREF: sub_4206B5+132Aj
					; sub_4206B5+1343j
		cmp	[ebp+var_C], 0
		jnz	loc_421FC9
		mov	[ebp+var_20], 0
		jmp	short loc_421A44
; ---------------------------------------------------------------------------

loc_421A1C:				; CODE XREF: sub_4206B5+1394j
		shl	[ebp+var_20], 8
		mov	eax, [ebp+var_7C]
		movzx	edx, byte ptr [eax]
		movzx	edx, dl
		or	[ebp+var_20], edx
		add	eax, 1
		mov	[ebp+var_7C], eax
		mov	eax, [ebp+var_80]
		sub	eax, 1
		mov	[ebp+var_80], eax
		mov	eax, [ebp+var_4C]
		sub	eax, 1
		mov	[ebp+var_4C], eax

loc_421A44:				; CODE XREF: sub_4206B5+1365j
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	short loc_421A1C
		mov	eax, [ebp+var_38]
		mov	edx, [ebp+var_20]
		mov	[eax+40h], edx
		mov	dword ptr [ebp+var_18],	7F7h
		mov	[esp+0F8h+var_D8], 6
		lea	eax, [ebp+var_50]
		mov	[esp+0F8h+var_DC], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+0F8h+var_E0], eax
		lea	eax, [ebp+var_60]
		mov	[esp+0F8h+var_E4], eax
		lea	eax, [ebp+var_5C]
		mov	[esp+0F8h+var_E8], eax
		lea	eax, [ebp+var_58]
		mov	[esp+0F8h+var_EC], eax
		lea	eax, [ebp+var_54]
		mov	[esp+0F8h+Size], eax
		lea	eax, [ebp+var_80]
		mov	[esp+0F8h+Src],	eax
		lea	eax, [ebp+var_7C]
		mov	[esp+0F8h+Dst],	eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_421AD0
		mov	edx, [ebp+var_4C]
		mov	eax, [ebp+var_80]
		cmp	edx, eax
		ja	short loc_421AC1
		mov	eax, [ebp+var_54]
		cmp	eax, 2
		jnz	short loc_421AC1
		mov	eax, [ebp+var_58]
		test	eax, eax
		jz	short loc_421AD0

loc_421AC1:				; CODE XREF: sub_4206B5+13FBj
					; sub_4206B5+1403j
		mov	[esp+0F8h+Dst],	41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_421AD0:				; CODE XREF: sub_4206B5+13F1j
					; sub_4206B5+140Aj
		cmp	[ebp+var_C], 0
		jnz	loc_421FCC
		mov	[ebp+var_20], 0
		jmp	short loc_421B0B
; ---------------------------------------------------------------------------

loc_421AE3:				; CODE XREF: sub_4206B5+145Bj
		shl	[ebp+var_20], 8
		mov	eax, [ebp+var_7C]
		movzx	edx, byte ptr [eax]
		movzx	edx, dl
		or	[ebp+var_20], edx
		add	eax, 1
		mov	[ebp+var_7C], eax
		mov	eax, [ebp+var_80]
		sub	eax, 1
		mov	[ebp+var_80], eax
		mov	eax, [ebp+var_4C]
		sub	eax, 1
		mov	[ebp+var_4C], eax

loc_421B0B:				; CODE XREF: sub_4206B5+142Cj
		mov	eax, [ebp+var_4C]
		test	eax, eax
		jnz	short loc_421AE3
		mov	eax, [ebp+var_38]
		mov	edx, [ebp+var_20]
		mov	[eax+44h], edx
		jmp	short loc_421B2A
; ---------------------------------------------------------------------------

loc_421B1D:				; CODE XREF: sub_4206B5+D7Cj
		nop
		jmp	short loc_421B2A
; ---------------------------------------------------------------------------

loc_421B20:				; CODE XREF: sub_4206B5+E87j
		nop
		jmp	short loc_421B2A
; ---------------------------------------------------------------------------

loc_421B23:				; CODE XREF: sub_4206B5+F92j
		nop
		jmp	short loc_421B2A
; ---------------------------------------------------------------------------

loc_421B26:				; CODE XREF: sub_4206B5+1071j
		nop
		jmp	short loc_421B2A
; ---------------------------------------------------------------------------

loc_421B29:				; CODE XREF: sub_4206B5+112Fj
		nop

loc_421B2A:				; CODE XREF: sub_4206B5+116Bj
					; sub_4206B5+12C8j ...
		movzx	eax, [ebp+var_BC]
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset aAodf04hxId ; "AODF %04hX: id="
		call	sub_43CBBE
		mov	[ebp+var_14], 0
		jmp	short loc_421B6F
; ---------------------------------------------------------------------------

loc_421B4A:				; CODE XREF: sub_4206B5+14C5j
		mov	eax, [ebp+var_38]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_14]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset a02x_0 ;	"%02X"
		call	sub_43CBE8
		add	[ebp+var_14], 1

loc_421B6F:				; CODE XREF: sub_4206B5+1493j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_38]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	short loc_421B4A
		mov	eax, [ebp+var_38]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_421BCD
		mov	[esp+0F8h+Dst],	offset aAuthid ; " authid="
		call	sub_43CBE8
		mov	[ebp+var_14], 0
		jmp	short loc_421BC0
; ---------------------------------------------------------------------------

loc_421B9B:				; CODE XREF: sub_4206B5+1516j
		mov	eax, [ebp+var_38]
		mov	edx, [eax+10h]
		mov	eax, [ebp+var_14]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset a02x_0 ;	"%02X"
		call	sub_43CBE8
		add	[ebp+var_14], 1

loc_421BC0:				; CODE XREF: sub_4206B5+14E4j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_38]
		mov	eax, [eax+0Ch]
		cmp	edx, eax
		jb	short loc_421B9B

loc_421BCD:				; CODE XREF: sub_4206B5+14CFj
		mov	[esp+0F8h+Dst],	offset aFlags ;	" flags="
		call	sub_43CBE8
		mov	dword ptr [ebp+var_24],	offset byte_44C47D
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 1
		test	al, al
		jz	short loc_421C08
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset aScase_sensitiv ; "%scase_sensitive"
		call	sub_43CBE8
		mov	dword ptr [ebp+var_24],	offset asc_44C488 ; ","

loc_421C08:				; CODE XREF: sub_4206B5+1537j
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 2
		test	al, al
		jz	short loc_421C30
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset aSlocal ; "%slocal"
		call	sub_43CBE8
		mov	dword ptr [ebp+var_24],	offset asc_44C488 ; ","

loc_421C30:				; CODE XREF: sub_4206B5+155Fj
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 4
		test	al, al
		jz	short loc_421C58
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset aSchange_disabl ; "%schange_disabled"
		call	sub_43CBE8
		mov	dword ptr [ebp+var_24],	offset asc_44C488 ; ","

loc_421C58:				; CODE XREF: sub_4206B5+1587j
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 8
		test	al, al
		jz	short loc_421C80
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset aSunblock_disab ; "%sunblock_disabled"
		call	sub_43CBE8
		mov	dword ptr [ebp+var_24],	offset asc_44C488 ; ","

loc_421C80:				; CODE XREF: sub_4206B5+15AFj
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 10h
		test	al, al
		jz	short loc_421CA8
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset aSinitialized ; "%sinitialized"
		call	sub_43CBE8
		mov	dword ptr [ebp+var_24],	offset asc_44C488 ; ","

loc_421CA8:				; CODE XREF: sub_4206B5+15D7j
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 20h
		test	al, al
		jz	short loc_421CD0
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset aSneeds_padding ; "%sneeds_padding"
		call	sub_43CBE8
		mov	dword ptr [ebp+var_24],	offset asc_44C488 ; ","

loc_421CD0:				; CODE XREF: sub_4206B5+15FFj
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 40h
		test	al, al
		jz	short loc_421CF8
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset aSunblocking_pi ; "%sunblocking_pin"
		call	sub_43CBE8
		mov	dword ptr [ebp+var_24],	offset asc_44C488 ; ","

loc_421CF8:				; CODE XREF: sub_4206B5+1627j
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 0FFFFFF80h
		test	al, al
		jz	short loc_421D20
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset aSso_pin	; "%sso_pin"
		call	sub_43CBE8
		mov	dword ptr [ebp+var_24],	offset asc_44C488 ; ","

loc_421D20:				; CODE XREF: sub_4206B5+164Fj
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax+15h]
		and	eax, 1
		test	al, al
		jz	short loc_421D48
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset aSdisable_allow ; "%sdisable_allowed"
		call	sub_43CBE8
		mov	dword ptr [ebp+var_24],	offset asc_44C488 ; ","

loc_421D48:				; CODE XREF: sub_4206B5+1677j
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax+15h]
		and	eax, 2
		test	al, al
		jz	short loc_421D70
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset aSintegrity_pro ; "%sintegrity_protected"
		call	sub_43CBE8
		mov	dword ptr [ebp+var_24],	offset asc_44C488 ; ","

loc_421D70:				; CODE XREF: sub_4206B5+169Fj
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax+15h]
		and	eax, 4
		test	al, al
		jz	short loc_421D98
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset aSconfidentiali ; "%sconfidentiality_protected"
		call	sub_43CBE8
		mov	dword ptr [ebp+var_24],	offset asc_44C488 ; ","

loc_421D98:				; CODE XREF: sub_4206B5+16C7j
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax+15h]
		and	eax, 8
		test	al, al
		jz	short loc_421DC0
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset aSexchange_ref_ ; "%sexchange_ref_data"
		call	sub_43CBE8
		mov	dword ptr [ebp+var_24],	offset asc_44C488 ; ","

loc_421DC0:				; CODE XREF: sub_4206B5+16EFj
		mov	eax, [ebp+var_38]
		mov	eax, [eax+18h]
		cmp	eax, 4		; switch 5 cases
		ja	short loc_421E01 ; jumptable 00421DD2 default case
		mov	eax, ds:off_44C7C8[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_421DD4:				; CODE XREF: sub_4206B5+171Dj
					; DATA XREF: .rdata:off_44C7C8o
		mov	dword ptr [ebp+var_24],	offset aBcd ; jumptable	00421DD2 case 0
		jmp	short loc_421E2B
; ---------------------------------------------------------------------------

loc_421DDD:				; CODE XREF: sub_4206B5+171Dj
					; DATA XREF: .rdata:off_44C7C8o
		mov	dword ptr [ebp+var_24],	offset aAsciiNumeric ; jumptable 00421DD2 case 1
		jmp	short loc_421E2B
; ---------------------------------------------------------------------------

loc_421DE6:				; CODE XREF: sub_4206B5+171Dj
					; DATA XREF: .rdata:off_44C7C8o
		mov	dword ptr [ebp+var_24],	offset aUtf8 ; jumptable 00421DD2 case 2
		jmp	short loc_421E2B
; ---------------------------------------------------------------------------

loc_421DEF:				; CODE XREF: sub_4206B5+171Dj
					; DATA XREF: .rdata:off_44C7C8o
		mov	dword ptr [ebp+var_24],	offset aHalfNibbleBcd ;	jumptable 00421DD2 case	3
		jmp	short loc_421E2B
; ---------------------------------------------------------------------------

loc_421DF8:				; CODE XREF: sub_4206B5+171Dj
					; DATA XREF: .rdata:off_44C7C8o
		mov	dword ptr [ebp+var_24],	offset aIso95641 ; jumptable 00421DD2 case 4
		jmp	short loc_421E2B
; ---------------------------------------------------------------------------

loc_421E01:				; CODE XREF: sub_4206B5+1714j
		mov	eax, [ebp+var_38] ; jumptable 00421DD2 default case
		mov	edx, [eax+18h]
		mov	eax, offset aLu_1 ; "%lu"
		mov	[esp+0F8h+Size], edx
		mov	[esp+0F8h+Src],	eax ; Format
		lea	eax, [ebp+Dest]
		mov	[esp+0F8h+Dst],	eax ; Dest
		call	sprintf
		lea	eax, [ebp+Dest]
		mov	dword ptr [ebp+var_24],	eax

loc_421E2B:				; CODE XREF: sub_4206B5+1726j
					; sub_4206B5+172Fj ...
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset aTypeS_0	; " type=%s"
		call	sub_43CBE8
		mov	eax, [ebp+var_38]
		mov	eax, [eax+1Ch]
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset aMinLu ;	" min=%lu"
		call	sub_43CBE8
		mov	eax, [ebp+var_38]
		mov	eax, [eax+20h]
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset aStoredLu ; " stored=%lu"
		call	sub_43CBE8
		mov	eax, [ebp+var_38]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_421E8A
		mov	eax, [ebp+var_38]
		mov	eax, [eax+24h]
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset aMaxLu ;	" max=%lu"
		call	sub_43CBE8

loc_421E8A:				; CODE XREF: sub_4206B5+17BDj
		mov	eax, [ebp+var_38]
		mov	eax, [eax+38h]
		test	eax, eax
		jz	short loc_421EAE
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax+34h]
		movsx	eax, al
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset aPad0x02x ; " pad=0x%02x"
		call	sub_43CBE8

loc_421EAE:				; CODE XREF: sub_4206B5+17DDj
		mov	eax, [ebp+var_38]
		mov	eax, [eax+30h]
		test	eax, eax
		jz	short loc_421ECE
		mov	eax, [ebp+var_38]
		mov	eax, [eax+2Ch]
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset aPinref0x02lx ; " pinref=0x%02lX"
		call	sub_43CBE8

loc_421ECE:				; CODE XREF: sub_4206B5+1801j
		mov	eax, [ebp+var_38]
		mov	eax, [eax+48h]
		test	eax, eax
		jz	short loc_421F4B
		mov	[esp+0F8h+Dst],	offset aPath ; " path="
		call	sub_43CBE8
		mov	[ebp+var_14], 0
		jmp	short loc_421F14
; ---------------------------------------------------------------------------

loc_421EED:				; CODE XREF: sub_4206B5+186Aj
		mov	eax, [ebp+var_38]
		mov	eax, [eax+4Ch]
		mov	edx, [ebp+var_14]
		add	edx, edx
		add	eax, edx
		movzx	eax, word ptr [eax]
		movzx	eax, ax
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset a04hx ; "%04hX"
		call	sub_43CBE8
		add	[ebp+var_14], 1

loc_421F14:				; CODE XREF: sub_4206B5+1836j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_38]
		mov	eax, [eax+48h]
		cmp	edx, eax
		jb	short loc_421EED
		mov	eax, [ebp+var_38]
		mov	eax, [eax+3Ch]
		test	eax, eax
		jz	short loc_421F4B
		mov	eax, [ebp+var_38]
		mov	edx, [eax+44h]
		mov	eax, [ebp+var_38]
		mov	eax, [eax+40h]
		mov	[esp+0F8h+Size], edx
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset aLuLu ; "[%lu/%lu]"
		call	sub_43CBE8

loc_421F4B:				; CODE XREF: sub_4206B5+1821j
					; sub_4206B5+1874j
		mov	[esp+0F8h+Dst],	offset asc_44C4EF ; "\n"
		call	sub_43CBE8
		mov	eax, [ebp+var_38]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_38]
		mov	[ebp+var_10], eax
		mov	[ebp+var_38], 0
		jmp	loc_42200C
; ---------------------------------------------------------------------------

loc_421F71:				; CODE XREF: sub_4206B5+170j
		nop
		jmp	short loc_421F7B
; ---------------------------------------------------------------------------

loc_421F74:				; CODE XREF: sub_4206B5+452j
		nop
		jmp	short loc_421F7B
; ---------------------------------------------------------------------------

loc_421F77:				; CODE XREF: sub_4206B5+5CEj
		nop
		jmp	short loc_421F7B
; ---------------------------------------------------------------------------

loc_421F7A:				; CODE XREF: sub_4206B5+1265j
		nop

loc_421F7B:				; CODE XREF: sub_4206B5+18BDj
					; sub_4206B5+18C0j ...
		call	sub_41D9E7
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_38]
		mov	[esp+0F8h+Dst],	eax
		call	sub_41DA86
		jmp	loc_42202B
; ---------------------------------------------------------------------------

loc_421F93:				; CODE XREF: sub_4206B5+1EFj
		nop
		jmp	short loc_421FCD
; ---------------------------------------------------------------------------

loc_421F96:				; CODE XREF: sub_4206B5+2A9j
		nop
		jmp	short loc_421FCD
; ---------------------------------------------------------------------------

loc_421F99:				; CODE XREF: sub_4206B5+363j
		nop
		jmp	short loc_421FCD
; ---------------------------------------------------------------------------

loc_421F9C:				; CODE XREF: sub_4206B5+419j
		nop
		jmp	short loc_421FCD
; ---------------------------------------------------------------------------

loc_421F9F:				; CODE XREF: sub_4206B5+4F8j
		nop
		jmp	short loc_421FCD
; ---------------------------------------------------------------------------

loc_421FA2:				; CODE XREF: sub_4206B5+5A4j
		nop
		jmp	short loc_421FCD
; ---------------------------------------------------------------------------

loc_421FA5:				; CODE XREF: sub_4206B5+673j
		nop
		jmp	short loc_421FCD
; ---------------------------------------------------------------------------

loc_421FA8:				; CODE XREF: sub_4206B5+6F0j
		nop
		jmp	short loc_421FCD
; ---------------------------------------------------------------------------

loc_421FAB:				; CODE XREF: sub_4206B5+7E7j
		nop
		jmp	short loc_421FCD
; ---------------------------------------------------------------------------

loc_421FAE:				; CODE XREF: sub_4206B5+B0Fj
		nop
		jmp	short loc_421FCD
; ---------------------------------------------------------------------------

loc_421FB1:				; CODE XREF: sub_4206B5+BF3j
		nop
		jmp	short loc_421FCD
; ---------------------------------------------------------------------------

loc_421FB4:				; CODE XREF: sub_4206B5+CD7j
		nop
		jmp	short loc_421FCD
; ---------------------------------------------------------------------------

loc_421FB7:				; CODE XREF: sub_4206B5+DA5j
		nop
		jmp	short loc_421FCD
; ---------------------------------------------------------------------------

loc_421FBA:				; CODE XREF: sub_4206B5+EB0j
		nop
		jmp	short loc_421FCD
; ---------------------------------------------------------------------------

loc_421FBD:				; CODE XREF: sub_4206B5+FBBj
		nop
		jmp	short loc_421FCD
; ---------------------------------------------------------------------------

loc_421FC0:				; CODE XREF: sub_4206B5+109Aj
		nop
		jmp	short loc_421FCD
; ---------------------------------------------------------------------------

loc_421FC3:				; CODE XREF: sub_4206B5+1158j
		nop
		jmp	short loc_421FCD
; ---------------------------------------------------------------------------

loc_421FC6:				; CODE XREF: sub_4206B5+1208j
		nop
		jmp	short loc_421FCD
; ---------------------------------------------------------------------------

loc_421FC9:				; CODE XREF: sub_4206B5+1358j
		nop
		jmp	short loc_421FCD
; ---------------------------------------------------------------------------

loc_421FCC:				; CODE XREF: sub_4206B5+141Fj
		nop

loc_421FCD:				; CODE XREF: sub_4206B5:loc_420DF6j
					; sub_4206B5+755j ...
		cmp	[ebp+var_1C], 0
		jnz	short loc_421FE0
		mov	eax, [ebp+var_C]
		mov	[esp+0F8h+Dst],	eax
		call	gpg_strerror
		jmp	short loc_421FE3
; ---------------------------------------------------------------------------

loc_421FE0:				; CODE XREF: sub_4206B5+191Cj
		mov	eax, [ebp+var_1C]

loc_421FE3:				; CODE XREF: sub_4206B5+1929j
		mov	[esp+0F8h+Size], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+0F8h+Src],	eax ; char
		mov	[esp+0F8h+Dst],	offset aErrorParsing_2 ; "error	parsing	AODF record (%d): %s - sk"...
		call	sub_43CB21
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_38]
		mov	[esp+0F8h+Dst],	eax
		call	sub_41DA86

loc_42200C:				; CODE XREF: sub_4206B5+88j
					; sub_4206B5+18B7j
		mov	eax, [ebp+var_48]
		test	eax, eax
		jz	short loc_42202B
		mov	eax, [ebp+var_44]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42202B
		mov	eax, [ebp+var_44]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FFh
		jnz	loc_420742

loc_42202B:				; CODE XREF: sub_4206B5+12Aj
					; sub_4206B5+18D9j ...
		mov	eax, [ebp+var_3C]
		mov	[esp+0F8h+Dst],	eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_422049
		mov	eax, [ebp+var_10]
		mov	[esp+0F8h+Dst],	eax
		call	sub_41DAC9
		jmp	short loc_422051
; ---------------------------------------------------------------------------

loc_422049:				; CODE XREF: sub_4206B5+1985j
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_422051:				; CODE XREF: sub_4206B5+1992j
		mov	eax, [ebp+var_C]

locret_422054:				; CODE XREF: sub_4206B5+37j
					; sub_4206B5+77j
		leave
		retn
sub_4206B5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_422056	proc near		; CODE XREF: sub_422340+Cp

Dst		= dword	ptr -68h
Src		= dword	ptr -64h
Size		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_38		= byte ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= byte ptr -2Ch
var_28		= byte ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 64h
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_18]
		mov	[esp+68h+var_58], edx
		lea	edx, [ebp+var_14]
		mov	[esp+68h+var_5C], edx
		mov	[esp+68h+Size],	offset aTokeninfo ; "TokenInfo"
		mov	[esp+68h+Src], 5032h
		mov	[esp+68h+Dst], eax
		call	sub_41DB8C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4220A1
		mov	eax, [ebp+var_C]
		jmp	loc_42233A
; ---------------------------------------------------------------------------

loc_4220A1:				; CODE XREF: sub_422056+41j
		mov	eax, [ebp+var_14]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_20], eax
		mov	[esp+68h+var_48], 6
		lea	eax, [ebp+var_28]
		mov	[esp+68h+var_4C], eax
		lea	eax, [ebp+var_24]
		mov	[esp+68h+var_50], eax
		lea	eax, [ebp+var_38]
		mov	[esp+68h+var_54], eax
		lea	eax, [ebp+var_34]
		mov	[esp+68h+var_58], eax
		lea	eax, [ebp+var_30]
		mov	[esp+68h+var_5C], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+Size],	eax
		lea	eax, [ebp+var_20]
		mov	[esp+68h+Src], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+68h+Dst], eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_42211B
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		cmp	edx, eax
		ja	short loc_42210C
		mov	eax, [ebp+var_30]
		cmp	eax, 10h
		jz	short loc_42211B

loc_42210C:				; CODE XREF: sub_422056+ACj
		mov	[esp+68h+Dst], 41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_42211B:				; CODE XREF: sub_422056+A2j
					; sub_422056+B4j
		cmp	[ebp+var_C], 0
		jz	short loc_422141
		mov	eax, [ebp+var_C]
		mov	[esp+68h+Dst], eax
		call	gpg_strerror
		mov	[esp+68h+Src], eax ; char
		mov	[esp+68h+Dst], offset aErrorParsingTo ;	"error parsing TokenInfo: %s\n"
		call	sub_43CB21
		jmp	loc_42232C
; ---------------------------------------------------------------------------

loc_422141:				; CODE XREF: sub_422056+C9j
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax
		mov	[esp+68h+var_48], 6
		lea	eax, [ebp+var_28]
		mov	[esp+68h+var_4C], eax
		lea	eax, [ebp+var_24]
		mov	[esp+68h+var_50], eax
		lea	eax, [ebp+var_38]
		mov	[esp+68h+var_54], eax
		lea	eax, [ebp+var_34]
		mov	[esp+68h+var_58], eax
		lea	eax, [ebp+var_30]
		mov	[esp+68h+var_5C], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+Size],	eax
		lea	eax, [ebp+var_20]
		mov	[esp+68h+Src], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+68h+Dst], eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4221B5
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		cmp	edx, eax
		ja	short loc_4221A6
		mov	eax, [ebp+var_30]
		cmp	eax, 2
		jz	short loc_4221B5

loc_4221A6:				; CODE XREF: sub_422056+146j
		mov	[esp+68h+Dst], 41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_4221B5:				; CODE XREF: sub_422056+13Cj
					; sub_422056+14Ej
		cmp	[ebp+var_C], 0
		jnz	loc_422328
		mov	dword ptr [ebp+var_10],	0
		jmp	short loc_4221F0
; ---------------------------------------------------------------------------

loc_4221C8:				; CODE XREF: sub_422056+19Fj
		shl	dword ptr [ebp+var_10],	8
		mov	eax, [ebp+var_1C]
		movzx	edx, byte ptr [eax]
		movzx	edx, dl
		or	dword ptr [ebp+var_10],	edx
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_20]
		sub	eax, 1
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_24]
		sub	eax, 1
		mov	[ebp+var_24], eax

loc_4221F0:				; CODE XREF: sub_422056+170j
		mov	eax, [ebp+var_24]
		test	eax, eax
		jnz	short loc_4221C8
		cmp	dword ptr [ebp+var_10],	0
		jz	short loc_422224
		mov	eax, dword ptr [ebp+var_10]
		mov	[esp+68h+Src], eax ; char
		mov	[esp+68h+Dst], offset aInvalidVersion ;	"invalid version %lu in	TokenInfo\n"
		call	sub_43CB21
		mov	[esp+68h+Dst], 41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax
		jmp	loc_42232C
; ---------------------------------------------------------------------------

loc_422224:				; CODE XREF: sub_422056+1A5j
		mov	[esp+68h+var_48], 6
		lea	eax, [ebp+var_28]
		mov	[esp+68h+var_4C], eax
		lea	eax, [ebp+var_24]
		mov	[esp+68h+var_50], eax
		lea	eax, [ebp+var_38]
		mov	[esp+68h+var_54], eax
		lea	eax, [ebp+var_34]
		mov	[esp+68h+var_58], eax
		lea	eax, [ebp+var_30]
		mov	[esp+68h+var_5C], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+Size],	eax
		lea	eax, [ebp+var_20]
		mov	[esp+68h+Src], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+68h+Dst], eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_422299
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		cmp	edx, eax
		ja	short loc_42228A
		mov	eax, [ebp+var_30]
		cmp	eax, 4
		jnz	short loc_42228A
		mov	eax, [ebp+var_24]
		test	eax, eax
		jnz	short loc_422299

loc_42228A:				; CODE XREF: sub_422056+223j
					; sub_422056+22Bj
		mov	[esp+68h+Dst], 41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_422299:				; CODE XREF: sub_422056+219j
					; sub_422056+232j
		cmp	[ebp+var_C], 0
		jnz	loc_42232B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+20h]
		mov	[esp+68h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+1Ch]
		mov	eax, [ebp+var_24]
		mov	[esp+68h+Dst], eax
		call	gcry_malloc
		mov	[ebx+20h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_4222DF
		call	sub_41D9E7
		mov	[ebp+var_C], eax
		jmp	short loc_42232C
; ---------------------------------------------------------------------------

loc_4222DF:				; CODE XREF: sub_422056+27Dj
		mov	ecx, [ebp+var_24]
		mov	eax, [ebp+var_1C]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+20h]
		mov	[esp+68h+Size],	ecx ; Size
		mov	[esp+68h+Src], edx ; Src
		mov	[esp+68h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+var_24]
		mov	[eax+24h], edx
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_1C]
		mov	[esp+68h+Size],	edx
		mov	[esp+68h+Src], eax
		mov	[esp+68h+Dst], offset aSerialnumberFr ;	"Serialnumber from EF(TokenInfo) is:"
		call	sub_43CC18
		jmp	short loc_42232C
; ---------------------------------------------------------------------------

loc_422328:				; CODE XREF: sub_422056+163j
		nop
		jmp	short loc_42232C
; ---------------------------------------------------------------------------

loc_42232B:				; CODE XREF: sub_422056+247j
		nop

loc_42232C:				; CODE XREF: sub_422056+E6j
					; sub_422056+1C9j ...
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+var_C]

loc_42233A:				; CODE XREF: sub_422056+46j
		add	esp, 64h
		pop	ebx
		pop	ebp
		retn
sub_422056	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_422340	proc near		; CODE XREF: sub_4245B2+27Dp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_422056
		test	eax, eax
		jnz	short loc_4223C0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_4223C0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	short loc_4223C0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [eax+20h]
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	dword ptr [eax+24h], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40EDA0
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4223C0
		mov	eax, [ebp+var_C]
		jmp	locret_42261A
; ---------------------------------------------------------------------------

loc_4223C0:				; CODE XREF: sub_422340+13j
					; sub_422340+1Dj ...
		mov	[esp+28h+var_24], 5031h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41E421
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4223E4
		mov	eax, [ebp+var_C]
		jmp	locret_42261A
; ---------------------------------------------------------------------------

loc_4223E4:				; CODE XREF: sub_422340+9Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_42240D
		mov	[esp+28h+var_20], 90Fh ; int
		mov	[esp+28h+var_24], offset a____Gnupg22__5 ; "../../gnupg2-2.0.30/scd/app-p15.c"
		mov	[esp+28h+var_28], offset aAppApp_localCe ; "!app->app_local->certificate_info"
		call	sub_442650

loc_42240D:				; CODE XREF: sub_422340+AFj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+2Ch]
		test	eax, eax
		jz	short loc_422436
		mov	[esp+28h+var_20], 910h ; int
		mov	[esp+28h+var_24], offset a____Gnupg22__5 ; "../../gnupg2-2.0.30/scd/app-p15.c"
		mov	[esp+28h+var_28], offset aAppApp_localTr ; "!app->app_local->trusted_certificate_in"...
		call	sub_442650

loc_422436:				; CODE XREF: sub_422340+D8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+30h]
		test	eax, eax
		jz	short loc_42245F
		mov	[esp+28h+var_20], 911h ; int
		mov	[esp+28h+var_24], offset a____Gnupg22__5 ; "../../gnupg2-2.0.30/scd/app-p15.c"
		mov	[esp+28h+var_28], offset aAppApp_localUs ; "!app->app_local->useful_certificate_inf"...
		call	sub_442650

loc_42245F:				; CODE XREF: sub_422340+101j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		lea	edx, [eax+28h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+14h]
		movzx	eax, ax
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41FD2E
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4224A1
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_41D9DA
		cmp	eax, 3Ah
		jnz	short loc_4224CD

loc_4224A1:				; CODE XREF: sub_422340+14Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		lea	edx, [eax+2Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+16h]
		movzx	eax, ax
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41FD2E
		mov	[ebp+var_C], eax

loc_4224CD:				; CODE XREF: sub_422340+15Fj
		cmp	[ebp+var_C], 0
		jz	short loc_4224E3
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_41D9DA
		cmp	eax, 3Ah
		jnz	short loc_42250F

loc_4224E3:				; CODE XREF: sub_422340+191j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		lea	edx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+18h]
		movzx	eax, ax
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41FD2E
		mov	[ebp+var_C], eax

loc_42250F:				; CODE XREF: sub_422340+1A1j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_41D9DA
		cmp	eax, 3Ah
		jnz	short loc_422526
		mov	[ebp+var_C], 0

loc_422526:				; CODE XREF: sub_422340+1DDj
		cmp	[ebp+var_C], 0
		jz	short loc_422534
		mov	eax, [ebp+var_C]
		jmp	locret_42261A
; ---------------------------------------------------------------------------

loc_422534:				; CODE XREF: sub_422340+1EAj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+34h]
		test	eax, eax
		jz	short loc_42255D
		mov	[esp+28h+var_20], 920h ; int
		mov	[esp+28h+var_24], offset a____Gnupg22__5 ; "../../gnupg2-2.0.30/scd/app-p15.c"
		mov	[esp+28h+var_28], offset aAppApp_localPr ; "!app->app_local->private_key_info"
		call	sub_442650

loc_42255D:				; CODE XREF: sub_422340+1FFj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		lea	edx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+0Ch]
		movzx	eax, ax
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41E9ED
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_41D9DA
		cmp	eax, 3Ah
		jnz	short loc_4225A0
		mov	[ebp+var_C], 0

loc_4225A0:				; CODE XREF: sub_422340+257j
		cmp	[ebp+var_C], 0
		jz	short loc_4225AB
		mov	eax, [ebp+var_C]
		jmp	short locret_42261A
; ---------------------------------------------------------------------------

loc_4225AB:				; CODE XREF: sub_422340+264j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+38h]
		test	eax, eax
		jz	short loc_4225D4
		mov	[esp+28h+var_20], 929h ; int
		mov	[esp+28h+var_24], offset a____Gnupg22__5 ; "../../gnupg2-2.0.30/scd/app-p15.c"
		mov	[esp+28h+var_28], offset aAppApp_localAu ; "!app->app_local->auth_object_info"
		call	sub_442650

loc_4225D4:				; CODE XREF: sub_422340+276j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		lea	edx, [eax+38h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax+1Ch]
		movzx	eax, ax
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4206B5
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_41D9DA
		cmp	eax, 3Ah
		jnz	short loc_422617
		mov	[ebp+var_C], 0

loc_422617:				; CODE XREF: sub_422340+2CEj
		mov	eax, [ebp+var_C]

locret_42261A:				; CODE XREF: sub_422340+7Bj
					; sub_422340+9Fj ...
		leave
		retn
sub_422340	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42261C	proc near		; CODE XREF: sub_422B0F+3Ep
					; sub_422B0F+6Ep ...

Dest		= dword	ptr -48h
Format		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		jmp	loc_42274C
; ---------------------------------------------------------------------------

loc_422629:				; CODE XREF: sub_42261C+134j
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+4]
		add	eax, 5
		add	eax, eax
		mov	[esp+48h+Dest],	eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_42264F
		call	sub_41D9E7
		jmp	loc_42275B
; ---------------------------------------------------------------------------

loc_42264F:				; CODE XREF: sub_42261C+27j
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax], 353150h
		mov	eax, [ebp+var_10]
		add	eax, 3
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax]
		test	ax, ax
		jz	short loc_422697
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax]
		movzx	edx, ax
		mov	eax, offset a04hx_0 ; "-%04hX"
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+Format], eax ;	Format
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_C], 5

loc_422697:				; CODE XREF: sub_42261C+51j
		mov	eax, [ebp+var_C]
		mov	word ptr [eax],	2Eh
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_C]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+8]
		mov	ecx, [ebp+var_C]
		mov	[esp+48h+var_40], ecx
		mov	[esp+48h+Format], edx
		mov	[esp+48h+Dest],	eax
		call	sub_42BDA4
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	[esp+48h+var_2C], 0
		mov	[esp+48h+var_30], 0
		mov	[esp+48h+var_34], ebx
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_38], eax
		mov	[esp+48h+var_3C], edx
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+Format], offset aCertinfo_1 ; "CERTINFO"
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Dest],	eax
		call	sub_406FDB
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Dest],	eax
		call	gcry_free
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		mov	[ebp+arg_C], eax

loc_42274C:				; CODE XREF: sub_42261C+8j
		cmp	[ebp+arg_C], 0
		jnz	loc_422629
		mov	eax, 0

loc_42275B:				; CODE XREF: sub_42261C+2Ej
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_42261C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_422762	proc near		; CODE XREF: sub_42291E+B9p

Buf1		= dword	ptr -38h
Buf2		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+28h]
		mov	[ebp+var_10], eax
		jmp	short loc_4227B4
; ---------------------------------------------------------------------------

loc_422776:				; CODE XREF: sub_422762+56j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnz	short loc_4227AC
		mov	eax, [ebp+arg_4]
		mov	ecx, [eax+4]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Buf2],	edx ; Buf2
		mov	[esp+38h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_4227BC

loc_4227AC:				; CODE XREF: sub_422762+22j
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[ebp+var_10], eax

loc_4227B4:				; CODE XREF: sub_422762+12j
		cmp	[ebp+var_10], 0
		jnz	short loc_422776
		jmp	short loc_4227BD
; ---------------------------------------------------------------------------

loc_4227BC:				; CODE XREF: sub_422762+48j
		nop

loc_4227BD:				; CODE XREF: sub_422762+58j
		cmp	[ebp+var_10], 0
		jnz	short loc_422818
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+2Ch]
		mov	[ebp+var_10], eax
		jmp	short loc_42280F
; ---------------------------------------------------------------------------

loc_4227D1:				; CODE XREF: sub_422762+B1j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnz	short loc_422807
		mov	eax, [ebp+arg_4]
		mov	ecx, [eax+4]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Buf2],	edx ; Buf2
		mov	[esp+38h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_422817

loc_422807:				; CODE XREF: sub_422762+7Dj
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[ebp+var_10], eax

loc_42280F:				; CODE XREF: sub_422762+6Dj
		cmp	[ebp+var_10], 0
		jnz	short loc_4227D1
		jmp	short loc_422818
; ---------------------------------------------------------------------------

loc_422817:				; CODE XREF: sub_422762+A3j
		nop

loc_422818:				; CODE XREF: sub_422762+5Fj
					; sub_422762+B3j
		cmp	[ebp+var_10], 0
		jnz	short loc_422873
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+30h]
		mov	[ebp+var_10], eax
		jmp	short loc_42286A
; ---------------------------------------------------------------------------

loc_42282C:				; CODE XREF: sub_422762+10Cj
		mov	eax, [ebp+var_10]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnz	short loc_422862
		mov	eax, [ebp+arg_4]
		mov	ecx, [eax+4]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Buf2],	edx ; Buf2
		mov	[esp+38h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_422872

loc_422862:				; CODE XREF: sub_422762+D8j
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[ebp+var_10], eax

loc_42286A:				; CODE XREF: sub_422762+C8j
		cmp	[ebp+var_10], 0
		jnz	short loc_42282C
		jmp	short loc_422873
; ---------------------------------------------------------------------------

loc_422872:				; CODE XREF: sub_422762+FEj
		nop

loc_422873:				; CODE XREF: sub_422762+BAj
					; sub_422762+10Ej
		cmp	[ebp+var_10], 0
		jnz	short loc_42288A
		mov	[esp+38h+Buf1],	1Bh
		call	sub_41D9BF
		jmp	locret_42291C
; ---------------------------------------------------------------------------

loc_42288A:				; CODE XREF: sub_422762+115j
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_2C], eax
		lea	eax, [ebp+var_14]
		mov	[esp+38h+Size],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Buf2],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Buf1],	eax
		call	sub_422BE2
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4228B8
		mov	eax, [ebp+var_C]
		jmp	short locret_42291C
; ---------------------------------------------------------------------------

loc_4228B8:				; CODE XREF: sub_422762+14Fj
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+Buf1],	eax
		call	ksba_cert_new
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4228E8
		mov	ecx, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Size],	ecx
		mov	[esp+38h+Buf2],	edx
		mov	[esp+38h+Buf1],	eax
		call	ksba_cert_init_from_mem
		mov	[ebp+var_C], eax

loc_4228E8:				; CODE XREF: sub_422762+168j
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Buf1],	eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jnz	short loc_42290E
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Buf2],	edx
		mov	[esp+38h+Buf1],	eax
		call	sub_40FDE8
		mov	[ebp+var_C], eax

loc_42290E:				; CODE XREF: sub_422762+195j
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Buf1],	eax
		call	ksba_cert_release
		mov	eax, [ebp+var_C]

locret_42291C:				; CODE XREF: sub_422762+123j
					; sub_422762+154j
		leave
		retn
sub_422762	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42291E	proc near		; CODE XREF: sub_422B0F+C6p

Dest		= dword	ptr -78h
Format		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_4C		= dword	ptr -4Ch
var_41		= byte ptr -41h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 74h
		jmp	loc_422AFA
; ---------------------------------------------------------------------------

loc_42292A:				; CODE XREF: sub_42291E+1E0j
		mov	eax, dword ptr [ebp+arg_8]
		mov	eax, [eax+4]
		add	eax, 5
		add	eax, eax
		mov	[esp+78h+Dest],	eax
		call	gcry_malloc
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_422950
		call	sub_41D9E7
		jmp	loc_422B09
; ---------------------------------------------------------------------------

loc_422950:				; CODE XREF: sub_42291E+26j
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax], 353150h
		mov	eax, [ebp+var_14]
		add	eax, 3
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax]
		test	ax, ax
		jz	short loc_422998
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax]
		movzx	edx, ax
		mov	eax, offset a04hx_0 ; "-%04hX"
		mov	[esp+78h+var_70], edx
		mov	[esp+78h+Format], eax ;	Format
		mov	eax, [ebp+var_C]
		mov	[esp+78h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_C], 5

loc_422998:				; CODE XREF: sub_42291E+50j
		mov	eax, [ebp+var_C]
		mov	word ptr [eax],	2Eh
		add	[ebp+var_C], 1
		mov	eax, dword ptr [ebp+arg_8]
		mov	edx, [eax+4]
		mov	eax, dword ptr [ebp+arg_8]
		mov	eax, [eax+8]
		mov	ecx, [ebp+var_C]
		mov	[esp+78h+var_70], ecx
		mov	[esp+78h+Format], edx
		mov	[esp+78h+Dest],	eax
		call	sub_42BDA4
		lea	eax, [ebp+var_41]
		mov	[esp+78h+var_70], eax
		mov	eax, dword ptr [ebp+arg_8]
		mov	[esp+78h+Format], eax ;	char
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Dest],	eax
		call	sub_422762
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_422A4B
		mov	[esp+78h+Dest],	offset aCanTGetKeygr_0 ; "can't get keygrip from "
		call	sub_43CB21
		mov	[ebp+var_10], 0
		jmp	short loc_422A1E
; ---------------------------------------------------------------------------

loc_4229FA:				; CODE XREF: sub_42291E+10Bj
		mov	eax, dword ptr [ebp+arg_8]
		mov	edx, [ebp+var_10]
		add	edx, 18h
		movzx	eax, word ptr [eax+edx*2]
		movzx	eax, ax
		mov	[esp+78h+Format], eax ;	char
		mov	[esp+78h+Dest],	offset a04hx ; "%04hX"
		call	sub_43CBE8
		add	[ebp+var_10], 1

loc_422A1E:				; CODE XREF: sub_42291E+DAj
		mov	edx, [ebp+var_10]
		mov	eax, dword ptr [ebp+arg_8]
		mov	eax, [eax+2Ch]
		cmp	edx, eax
		jb	short loc_4229FA
		mov	eax, [ebp+var_18]
		mov	[esp+78h+Dest],	eax
		call	gpg_strerror
		mov	[esp+78h+Format], eax ;	char
		mov	[esp+78h+Dest],	offset aS_2 ; ": %s\n"
		call	sub_43CBE8
		jmp	loc_422AE7
; ---------------------------------------------------------------------------

loc_422A4B:				; CODE XREF: sub_42291E+C5j
		lea	eax, [ebp+var_41]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 28h
		jz	short loc_422A8B
		mov	[esp+78h+var_70], 9B0h ; int
		mov	[esp+78h+Format], offset a____Gnupg22__5 ; "../../gnupg2-2.0.30/scd/app-p15.c"
		mov	[esp+78h+Dest],	offset aStrlenGripstr4 ; "strlen (gripstr) == 40"
		call	sub_442650

loc_422A8B:				; CODE XREF: sub_42291E+14Fj
		mov	eax, [ebp+var_14]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+78h+var_5C], 0
		mov	[esp+78h+var_60], 0
		mov	[esp+78h+var_64], eax
		mov	eax, [ebp+var_14]
		mov	[esp+78h+var_68], eax
		mov	[esp+78h+var_6C], 28h
		lea	eax, [ebp+var_41]
		mov	[esp+78h+var_70], eax
		mov	[esp+78h+Format], offset aKeypairinfo_3	; "KEYPAIRINFO"
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+Dest],	eax
		call	sub_406FDB

loc_422AE7:				; CODE XREF: sub_42291E+128j
		mov	eax, [ebp+var_14]
		mov	[esp+78h+Dest],	eax
		call	gcry_free
		mov	eax, dword ptr [ebp+arg_8]
		mov	eax, [eax]
		mov	dword ptr [ebp+arg_8], eax

loc_422AFA:				; CODE XREF: sub_42291E+7j
		cmp	dword ptr [ebp+arg_8], 0
		jnz	loc_42292A
		mov	eax, 0

loc_422B09:				; CODE XREF: sub_42291E+2Dj
		add	esp, 74h
		pop	edi
		pop	ebp
		retn
sub_42291E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_422B0F	proc near		; DATA XREF: sub_4245B2+368o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		and	eax, 1
		test	al, al
		jz	short loc_422B2B
		mov	[ebp+var_C], 0
		jmp	loc_422BB5
; ---------------------------------------------------------------------------

loc_422B2B:				; CODE XREF: sub_422B0F+Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+28h]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], offset a100 ;	"100"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42261C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_422B85
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+2Ch]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], offset a101 ;	"101"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42261C
		mov	[ebp+var_C], eax

loc_422B85:				; CODE XREF: sub_422B0F+4Aj
		cmp	[ebp+var_C], 0
		jnz	short loc_422BB5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+30h]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], offset a102 ;	"102"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42261C
		mov	[ebp+var_C], eax

loc_422BB5:				; CODE XREF: sub_422B0F+17j
					; sub_422B0F+7Aj
		cmp	[ebp+var_C], 0
		jnz	short loc_422BDD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+34h]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42291E
		mov	[ebp+var_C], eax

loc_422BDD:				; CODE XREF: sub_422B0F+AAj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_422B0F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_422BE2	proc near		; CODE XREF: sub_422762+143p
					; sub_423054+55p

Dst		= dword	ptr -78h
Src		= dword	ptr -74h
Size		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= byte ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 74h
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_422C6C
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+0Ch]
		mov	[esp+78h+Dst], eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_422C34
		call	sub_41D9E7
		jmp	loc_42304E
; ---------------------------------------------------------------------------

loc_422C34:				; CODE XREF: sub_422BE2+46j
		mov	eax, [ebp+arg_4]
		mov	ecx, [eax+0Ch]
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+10h]
		mov	edx, eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[esp+78h+Size],	ecx ; Size
		mov	[esp+78h+Src], edx ; Src
		mov	[esp+78h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, 0
		jmp	loc_42304E
; ---------------------------------------------------------------------------

loc_422C6C:				; CODE XREF: sub_422BE2+28j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+20h]
		mov	edx, [ebp+arg_4]
		add	edx, 24h
		mov	[esp+78h+Size],	eax
		mov	[esp+78h+Src], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Dst], eax
		call	sub_41DC64
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_423036
		mov	eax, [ebp+arg_4]
		mov	ecx, [eax+1Ch]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	ebx, [ebp+var_28]
		mov	[esp+78h+var_68], ebx
		lea	ebx, [ebp+var_20]
		mov	[esp+78h+var_6C], ebx
		mov	[esp+78h+Size],	ecx
		mov	[esp+78h+Src], edx ; char
		mov	[esp+78h+Dst], eax
		call	sub_40DC72
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_422CF1
		mov	eax, [ebp+var_28]
		test	eax, eax
		jz	short loc_422CE2
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FFh
		jnz	short loc_422CF1

loc_422CE2:				; CODE XREF: sub_422BE2+F4j
		mov	[esp+78h+Dst], 1Bh
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_422CF1:				; CODE XREF: sub_422BE2+EDj
					; sub_422BE2+FEj
		cmp	[ebp+var_C], 0
		jz	short loc_422D5E
		mov	[esp+78h+Dst], offset aErrorReading_2 ;	"error reading certificate with	Id "
		call	sub_43CB21
		mov	[ebp+var_18], 0
		jmp	short loc_422D31
; ---------------------------------------------------------------------------

loc_422D0C:				; CODE XREF: sub_422BE2+15Aj
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_18]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+78h+Src], eax ; char
		mov	[esp+78h+Dst], offset a02x_0 ; "%02X"
		call	sub_43CBE8
		add	[ebp+var_18], 1

loc_422D31:				; CODE XREF: sub_422BE2+128j
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	short loc_422D0C
		mov	eax, [ebp+var_C]
		mov	[esp+78h+Dst], eax
		call	gpg_strerror
		mov	[esp+78h+Src], eax ; char
		mov	[esp+78h+Dst], offset aS_2 ; ":	%s\n"
		call	sub_43CBE8
		jmp	loc_423040
; ---------------------------------------------------------------------------

loc_422D5E:				; CODE XREF: sub_422BE2+113j
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_2C], eax
		mov	[esp+78h+var_58], 6
		lea	eax, [ebp+var_44]
		mov	[esp+78h+var_5C], eax
		lea	eax, [ebp+var_40]
		mov	[esp+78h+var_60], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+78h+var_64], eax
		lea	eax, [ebp+var_38]
		mov	[esp+78h+var_68], eax
		lea	eax, [ebp+var_34]
		mov	[esp+78h+var_6C], eax
		lea	eax, [ebp+var_30]
		mov	[esp+78h+Size],	eax
		lea	eax, [ebp+var_2C]
		mov	[esp+78h+Src], eax
		lea	eax, [ebp+var_24]
		mov	[esp+78h+Dst], eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_423039
		mov	eax, [ebp+var_30]
		test	eax, eax
		jnz	short loc_422DDA
		mov	eax, [ebp+var_34]
		cmp	eax, 10h
		jnz	short loc_422DDA
		mov	eax, [ebp+var_38]
		test	eax, eax
		jz	short loc_422DDA
		mov	[ebp+var_14], 0
		jmp	short loc_422E0D
; ---------------------------------------------------------------------------

loc_422DDA:				; CODE XREF: sub_422BE2+1DEj
					; sub_422BE2+1E6j ...
		mov	eax, [ebp+var_30]
		test	eax, eax
		jnz	short loc_422DF9
		mov	eax, [ebp+var_34]
		cmp	eax, 11h
		jnz	short loc_422DF9
		mov	eax, [ebp+var_38]
		test	eax, eax
		jz	short loc_422DF9
		mov	[ebp+var_14], 1
		jmp	short loc_422E0D
; ---------------------------------------------------------------------------

loc_422DF9:				; CODE XREF: sub_422BE2+1FDj
					; sub_422BE2+205j ...
		mov	[esp+78h+Dst], 41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax
		jmp	loc_423040
; ---------------------------------------------------------------------------

loc_422E0D:				; CODE XREF: sub_422BE2+1F6j
					; sub_422BE2+215j
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_44]
		add	eax, edx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_28]
		cmp	[ebp+var_10], eax
		jbe	short loc_422E3C
		mov	[esp+78h+Size],	0A1Ah ;	int
		mov	[esp+78h+Src], offset a____Gnupg22__5 ;	"../../gnupg2-2.0.30/scd/app-p15.c"
		mov	[esp+78h+Dst], offset aTotobjlenBuf_1 ;	"totobjlen <= buflen"
		call	sub_442650

loc_422E3C:				; CODE XREF: sub_422BE2+23Cj
		mov	[esp+78h+var_58], 6
		lea	eax, [ebp+var_44]
		mov	[esp+78h+var_5C], eax
		lea	eax, [ebp+var_40]
		mov	[esp+78h+var_60], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+78h+var_64], eax
		lea	eax, [ebp+var_38]
		mov	[esp+78h+var_68], eax
		lea	eax, [ebp+var_34]
		mov	[esp+78h+var_6C], eax
		lea	eax, [ebp+var_30]
		mov	[esp+78h+Size],	eax
		lea	eax, [ebp+var_2C]
		mov	[esp+78h+Src], eax
		lea	eax, [ebp+var_24]
		mov	[esp+78h+Dst], eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_42303C
		cmp	[ebp+var_14], 0
		jnz	loc_422FC7
		mov	eax, [ebp+var_30]
		test	eax, eax
		jnz	loc_422FC7
		mov	eax, [ebp+var_34]
		cmp	eax, 6
		jnz	loc_422FC7
		mov	eax, [ebp+var_38]
		test	eax, eax
		jnz	loc_422FC7
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_40]
		cmp	edx, eax
		jnb	short loc_422ED7
		mov	[esp+78h+Dst], 41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax
		jmp	loc_423040
; ---------------------------------------------------------------------------

loc_422ED7:				; CODE XREF: sub_422BE2+2DFj
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_40]
		add	eax, edx
		mov	[ebp+var_24], eax
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_40]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_1C], eax
		mov	[esp+78h+var_58], 6
		lea	eax, [ebp+var_44]
		mov	[esp+78h+var_5C], eax
		lea	eax, [ebp+var_40]
		mov	[esp+78h+var_60], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+78h+var_64], eax
		lea	eax, [ebp+var_38]
		mov	[esp+78h+var_68], eax
		lea	eax, [ebp+var_34]
		mov	[esp+78h+var_6C], eax
		lea	eax, [ebp+var_30]
		mov	[esp+78h+Size],	eax
		lea	eax, [ebp+var_2C]
		mov	[esp+78h+Src], eax
		lea	eax, [ebp+var_24]
		mov	[esp+78h+Dst], eax
		call	sub_42D42C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_42303F
		mov	eax, [ebp+var_30]
		test	eax, eax
		jnz	short loc_422F5E
		mov	eax, [ebp+var_34]
		cmp	eax, 10h
		jnz	short loc_422F5E
		mov	eax, [ebp+var_38]
		test	eax, eax
		jnz	short loc_422F72

loc_422F5E:				; CODE XREF: sub_422BE2+36Bj
					; sub_422BE2+373j
		mov	[esp+78h+Dst], 41h
		call	sub_41D9BF
		mov	[ebp+var_C], eax
		jmp	loc_423040
; ---------------------------------------------------------------------------

loc_422F72:				; CODE XREF: sub_422BE2+37Aj
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+var_44]
		add	eax, edx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_1C]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_28]
		add	eax, edx
		cmp	ecx, eax
		jbe	short loc_422FAE
		mov	[esp+78h+Size],	0A39h ;	int
		mov	[esp+78h+Src], offset a____Gnupg22__5 ;	"../../gnupg2-2.0.30/scd/app-p15.c"
		mov	[esp+78h+Dst], offset aSave_pTotobj_1 ;	"save_p	+ totobjlen <= buffer +	buflen"
		call	sub_442650

loc_422FAE:				; CODE XREF: sub_422BE2+3AEj
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_10]
		mov	[esp+78h+Size],	edx ; Size
		mov	edx, [ebp+var_1C]
		mov	[esp+78h+Src], edx ; Src
		mov	[esp+78h+Dst], eax ; Dst
		call	memmove

loc_422FC7:				; CODE XREF: sub_422BE2+2AFj
					; sub_422BE2+2BAj ...
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_423040
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		mov	[esp+78h+Dst], eax
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_423040
		mov	eax, [ebp+arg_C]
		mov	ecx, [eax]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+10h]
		mov	[esp+78h+Size],	ecx ; Size
		mov	[esp+78h+Src], edx ; Src
		mov	[esp+78h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_C]
		mov	edx, [eax]
		mov	eax, [ebp+arg_4]
		mov	[eax+0Ch], edx
		jmp	short loc_423040
; ---------------------------------------------------------------------------

loc_423036:				; CODE XREF: sub_422BE2+B0j
		nop
		jmp	short loc_423040
; ---------------------------------------------------------------------------

loc_423039:				; CODE XREF: sub_422BE2+1D3j
		nop
		jmp	short loc_423040
; ---------------------------------------------------------------------------

loc_42303C:				; CODE XREF: sub_422BE2+2A5j
		nop
		jmp	short loc_423040
; ---------------------------------------------------------------------------

loc_42303F:				; CODE XREF: sub_422BE2+360j
		nop

loc_423040:				; CODE XREF: sub_422BE2+177j
					; sub_422BE2+226j ...
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+var_C]

loc_42304E:				; CODE XREF: sub_422BE2+4Dj
					; sub_422BE2+85j
		add	esp, 74h
		pop	ebx
		pop	ebp
		retn
sub_422BE2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_423054(int, char *, int, int)
sub_423054	proc near		; DATA XREF: sub_4245B2+372o

var_28		= dword	ptr -28h
Str1		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str1],	eax ; Str1
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_41E21E
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4230B1
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[esp+28h+var_1C], edx
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+Str1],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_422BE2
		mov	[ebp+var_C], eax

loc_4230B1:				; CODE XREF: sub_423054+38j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_423054	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4230B6	proc near		; DATA XREF: sub_4245B2+37Co

Dest		= dword	ptr -78h
Format		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_4C		= dword	ptr -4Ch
var_3D		= byte ptr -3Dh
var_3A		= byte ptr -3Ah
var_32		= byte ptr -32h
var_2F		= byte ptr -2Fh
var_2E		= word ptr -2Eh
var_2C		= word ptr -2Ch
var_2A		= word ptr -2Ah
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 70h
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, offset aAuthkeyid ; "$AUTHKEYID"
		mov	ecx, 0Bh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	loc_42321B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+34h]
		mov	[ebp+var_14], eax
		jmp	short loc_42310E
; ---------------------------------------------------------------------------

loc_4230F8:				; CODE XREF: sub_4230B6+5Cj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 4
		test	al, al
		jnz	short loc_423116
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_42310E:				; CODE XREF: sub_4230B6+40j
		cmp	[ebp+var_14], 0
		jnz	short loc_4230F8
		jmp	short loc_423117
; ---------------------------------------------------------------------------

loc_423116:				; CODE XREF: sub_4230B6+4Ej
		nop

loc_423117:				; CODE XREF: sub_4230B6+5Ej
		cmp	[ebp+var_14], 0
		jz	loc_4233D9
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		add	eax, 5
		add	eax, eax
		mov	[esp+78h+Dest],	eax
		call	gcry_malloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_423147
		call	sub_41D9E7
		jmp	loc_4233E5
; ---------------------------------------------------------------------------

loc_423147:				; CODE XREF: sub_4230B6+85j
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax], 353150h
		mov	eax, [ebp+var_18]
		add	eax, 3
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax]
		test	ax, ax
		jz	short loc_42318F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	eax, word ptr [eax]
		movzx	edx, ax
		mov	eax, offset a04hx_0 ; "-%04hX"
		mov	[esp+78h+var_70], edx
		mov	[esp+78h+Format], eax ;	Format
		mov	eax, [ebp+var_10]
		mov	[esp+78h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_10], 5

loc_42318F:				; CODE XREF: sub_4230B6+AFj
		mov	eax, [ebp+var_10]
		mov	word ptr [eax],	2Eh
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_14]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	ecx, [ebp+var_10]
		mov	[esp+78h+var_70], ecx
		mov	[esp+78h+Format], edx
		mov	[esp+78h+Dest],	eax
		call	sub_42BDA4
		mov	eax, [ebp+var_18]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+78h+var_64], 0
		mov	[esp+78h+var_68], 0
		mov	[esp+78h+var_6C], eax
		mov	eax, [ebp+var_18]
		mov	[esp+78h+var_70], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+78h+Format], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+Dest],	eax
		call	sub_406FDB
		mov	eax, [ebp+var_18]
		mov	[esp+78h+Dest],	eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_4233E5
; ---------------------------------------------------------------------------

loc_42321B:				; CODE XREF: sub_4230B6+2Ej
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, offset aDispserialno ; "$DISPSERIALNO"
		mov	ecx, 0Eh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	loc_4233D9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+4]
		cmp	eax, 3
		jnz	loc_4233D9
		mov	[ebp+var_2E], 3F00h
		mov	[ebp+var_2C], 0DF01h
		mov	[ebp+var_2A], 4031h
		mov	[esp+78h+var_70], 3
		lea	eax, [ebp+var_2E]
		mov	[esp+78h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Dest],	eax
		call	sub_41DC64
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4232BD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_24]
		mov	[esp+78h+var_68], edx
		lea	edx, [ebp+var_20]
		mov	[esp+78h+var_6C], edx
		mov	[esp+78h+var_70], 0
		mov	[esp+78h+Format], 0
		mov	[esp+78h+Dest],	eax
		call	sub_40DC72
		mov	[ebp+var_C], eax

loc_4232BD:				; CODE XREF: sub_4230B6+1D6j
		cmp	[ebp+var_C], 0
		jz	short loc_4232E6
		mov	eax, [ebp+var_C]
		mov	[esp+78h+Dest],	eax
		call	gpg_strerror
		mov	[esp+78h+Format], eax ;	char
		mov	[esp+78h+Dest],	offset aErrorAccessing ; "error	accessing EF(ID): %s\n"
		call	sub_43CB21
		mov	eax, [ebp+var_C]
		jmp	loc_4233E5
; ---------------------------------------------------------------------------

loc_4232E6:				; CODE XREF: sub_4230B6+20Bj
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		lea	ecx, [ebp+var_28]
		mov	[esp+78h+var_6C], ecx
		mov	[esp+78h+var_70], 1
		mov	[esp+78h+Format], edx
		mov	[esp+78h+Dest],	eax
		call	sub_42D39C
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_4233CE
		mov	eax, [ebp+var_28]
		cmp	eax, 0Ch
		jnz	loc_4233CE
		mov	edx, [ebp+var_1C]
		lea	eax, [ebp+var_3D]
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		movzx	edx, byte ptr [edx+2]
		mov	[eax+2], dl
		mov	[ebp+var_3A], 2Dh
		mov	eax, [ebp+var_1C]
		lea	edx, [eax+3]
		lea	eax, [ebp+var_3D]
		add	eax, 4
		mov	ecx, [edx]
		mov	[eax], ecx
		movzx	ecx, word ptr [edx+4]
		mov	[eax+4], cx
		movzx	edx, byte ptr [edx+6]
		mov	[eax+6], dl
		mov	[ebp+var_32], 2Dh
		mov	eax, [ebp+var_1C]
		add	eax, 0Ah
		lea	edx, [ebp+var_3D]
		add	edx, 0Ch
		movzx	eax, word ptr [eax]
		mov	[edx], ax
		mov	[ebp+var_2F], 0
		lea	eax, [ebp+var_3D]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+78h+var_64], 0
		mov	[esp+78h+var_68], 0
		mov	[esp+78h+var_6C], eax
		lea	eax, [ebp+var_3D]
		mov	[esp+78h+var_70], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+78h+Format], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+Dest],	eax
		call	sub_406FDB
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Dest],	eax
		call	gcry_free
		mov	eax, 0
		jmp	short loc_4233E5
; ---------------------------------------------------------------------------

loc_4233CE:				; CODE XREF: sub_4230B6+258j
					; sub_4230B6+264j
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Dest],	eax
		call	gcry_free

loc_4233D9:				; CODE XREF: sub_4230B6+65j
					; sub_4230B6+18Bj ...
		mov	[esp+78h+Dest],	58h
		call	sub_41D9BF

loc_4233E5:				; CODE XREF: sub_4230B6+8Cj
					; sub_4230B6+160j ...
		add	esp, 70h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4230B6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4233EC	proc near		; CODE XREF: sub_42371E+A4Ap

var_78		= dword	ptr -78h
var_74		= byte ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_4C		= word ptr -4Ch
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2A		= byte ptr -2Ah
var_29		= byte ptr -29h
var_28		= byte ptr -28h
var_27		= byte ptr -27h
var_26		= byte ptr -26h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_E		= word ptr -0Eh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 78h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_4C], ax
		mov	[ebp+var_E], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+78h+var_68], 0
		mov	[esp+78h+var_6C], 0
		mov	[esp+78h+var_70], 0
		mov	dword ptr [esp+78h+var_74], 13h
		mov	[esp+78h+var_78], eax
		call	sub_40CD52
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_423459
		mov	eax, [ebp+var_18]
		mov	[esp+78h+var_78], eax
		call	gpg_strerror
		mov	dword ptr [esp+78h+var_74], eax	; char
		mov	[esp+78h+var_78], offset aErrorReadingEf ; "error reading EF_keyD: %s\n"
		call	sub_43CB21
		mov	eax, [ebp+var_18]
		jmp	locret_42371C
; ---------------------------------------------------------------------------

loc_423459:				; CODE XREF: sub_4233EC+48j
		mov	[ebp+var_C], 1
		mov	dword ptr [ebp+var_14],	0FFFFFFFFh

loc_423467:				; CODE XREF: sub_4233EC+218j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_34]
		mov	[esp+78h+var_64], edx
		lea	edx, [ebp+var_30]
		mov	[esp+78h+var_68], edx
		mov	[esp+78h+var_6C], 0
		mov	[esp+78h+var_70], 1
		mov	edx, [ebp+var_C]
		mov	dword ptr [esp+78h+var_74], edx
		mov	[esp+78h+var_78], eax
		call	sub_40DF53
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[esp+78h+var_78], eax
		call	sub_41D9DA
		cmp	eax, 1Bh
		jz	loc_423609
		cmp	[ebp+var_18], 0
		jz	short loc_4234DA
		mov	eax, [ebp+var_18]
		mov	[esp+78h+var_78], eax
		call	gpg_strerror
		mov	dword ptr [esp+78h+var_74], eax	; char
		mov	[esp+78h+var_78], offset aErrorReading_3 ; "error reading EF_keyD record: %s\n"
		call	sub_43CB21
		mov	eax, [ebp+var_18]
		jmp	locret_42371C
; ---------------------------------------------------------------------------

loc_4234DA:				; CODE XREF: sub_4233EC+C9j
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_30]
		mov	[esp+78h+var_70], edx
		mov	dword ptr [esp+78h+var_74], eax
		mov	[esp+78h+var_78], offset aKeydRecord ; "keyD record:"
		call	sub_43CC18
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_30]
		lea	ecx, [ebp+var_38]
		mov	[esp+78h+var_6C], ecx
		mov	[esp+78h+var_70], 83h
		mov	dword ptr [esp+78h+var_74], edx
		mov	[esp+78h+var_78], eax
		call	sub_42D39C
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_4235F5
		mov	eax, [ebp+var_38]
		cmp	eax, 4
		jnz	loc_4235F5
		mov	eax, [ebp+var_1C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 8
		mov	eax, [ebp+var_1C]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	edx, eax
		movzx	eax, [ebp+var_4C]
		cmp	edx, eax
		jnz	loc_4235F5
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 8
		mov	edx, eax
		mov	eax, [ebp+var_1C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, edx
		mov	[ebp+var_E], ax
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_30]
		lea	ecx, [ebp+var_38]
		mov	[esp+78h+var_6C], ecx
		mov	[esp+78h+var_70], 7Bh
		mov	dword ptr [esp+78h+var_74], edx
		mov	[esp+78h+var_78], eax
		call	sub_42D39C
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_4235F5
		mov	eax, [ebp+var_38]
		test	eax, eax
		jz	short loc_4235F5
		mov	eax, [ebp+var_38]
		lea	edx, [ebp+var_3C]
		mov	[esp+78h+var_6C], edx
		mov	[esp+78h+var_70], 80h
		mov	dword ptr [esp+78h+var_74], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+78h+var_78], eax
		call	sub_42D39C
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_4235F5
		mov	eax, [ebp+var_3C]
		cmp	eax, 1
		jnz	short loc_4235F5
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	dword ptr [ebp+var_14],	eax
		mov	eax, [ebp+var_30]
		mov	[esp+78h+var_78], eax
		call	gcry_free
		jmp	short loc_42360A
; ---------------------------------------------------------------------------

loc_4235F5:				; CODE XREF: sub_4233EC+130j
					; sub_4233EC+13Cj ...
		mov	eax, [ebp+var_30]
		mov	[esp+78h+var_78], eax
		call	gcry_free
		add	[ebp+var_C], 1
		jmp	loc_423467
; ---------------------------------------------------------------------------

loc_423609:				; CODE XREF: sub_4233EC+BFj
		nop

loc_42360A:				; CODE XREF: sub_4233EC+207j
		cmp	dword ptr [ebp+var_14],	0FFFFFFFFh
		jnz	short loc_423635
		movzx	eax, [ebp+var_4C]
		mov	dword ptr [esp+78h+var_74], eax	; char
		mov	[esp+78h+var_78], offset aCrtForKeyfile0 ; "CRT	for keyfile %04hX not found\n"
		call	sub_43CB21
		mov	[esp+78h+var_78], 1Bh
		call	sub_41D9BF
		jmp	locret_42371C
; ---------------------------------------------------------------------------

loc_423635:				; CODE XREF: sub_4233EC+222j
		cmp	dword ptr [ebp+var_14],	0
		jz	short loc_42369B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+78h+var_68], 0 ; size_t
		mov	[esp+78h+var_6C], 0 ; void *
		mov	edx, dword ptr [ebp+var_14]
		mov	[esp+78h+var_70], edx ;	int
		mov	dword ptr [esp+78h+var_74], 0F3h ; int
		mov	[esp+78h+var_78], eax ;	char
		call	sub_40D58E
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_42369B
		mov	eax, [ebp+var_18]
		mov	[esp+78h+var_78], eax
		call	gpg_strerror
		mov	[esp+78h+var_70], eax
		mov	eax, dword ptr [ebp+var_14]
		mov	dword ptr [esp+78h+var_74], eax	; char
		mov	[esp+78h+var_78], offset aRestoringSeToD ; "restoring SE to %d failed: %s\n"
		call	sub_43CB21
		mov	eax, [ebp+var_18]
		jmp	locret_42371C
; ---------------------------------------------------------------------------

loc_42369B:				; CODE XREF: sub_4233EC+24Dj
					; sub_4233EC+283j
		mov	[ebp+var_2A], 83h
		mov	[ebp+var_29], 3
		mov	[ebp+var_28], 80h
		movzx	eax, [ebp+var_E]
		shr	ax, 8
		mov	[ebp+var_27], al
		movzx	eax, [ebp+var_E]
		mov	[ebp+var_26], al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+78h+var_68], 5 ; size_t
		lea	edx, [ebp+var_2A]
		mov	[esp+78h+var_6C], edx ;	void *
		mov	[esp+78h+var_70], 0B6h ; int
		mov	dword ptr [esp+78h+var_74], 41h	; int
		mov	[esp+78h+var_78], eax ;	char
		call	sub_40D58E
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_423717
		mov	eax, [ebp+var_18]
		mov	[esp+78h+var_78], eax
		call	gpg_strerror
		movzx	edx, [ebp+var_E]
		mov	[esp+78h+var_70], eax
		mov	dword ptr [esp+78h+var_74], edx	; char
		mov	[esp+78h+var_78], offset aSettingSeToRef ; "setting SE to reference file %04hX fail"...
		call	sub_43CB21
		mov	eax, [ebp+var_18]
		jmp	short locret_42371C
; ---------------------------------------------------------------------------

loc_423717:				; CODE XREF: sub_4233EC+301j
		mov	eax, 0

locret_42371C:				; CODE XREF: sub_4233EC+68j
					; sub_4233EC+E9j ...
		leave
		retn
sub_4233EC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42371E(int, char *Str1, int, int, int, void *Src, size_t, int, int)
sub_42371E	proc near		; CODE XREF: sub_4242C6+D3p
					; DATA XREF: sub_4245B2+39Ao

Buf1		= dword	ptr -0A8h
Buf2		= dword	ptr -0A4h
Size		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_7C		= dword	ptr -7Ch
var_6B		= byte ptr -6Bh
var_6A		= byte ptr -6Ah
var_69		= byte ptr -69h
var_68		= dword	ptr -68h
var_61		= byte ptr -61h
var_60		= byte ptr -60h
var_5F		= byte ptr -5Fh
var_5E		= byte ptr -5Eh
var_5D		= byte ptr -5Dh
var_5C		= dword	ptr -5Ch
Dst		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= word ptr -4Ch
var_4A		= byte ptr -4Ah
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Str1		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
Src		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0A0h
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		cmp	[ebp+Str1], 0
		jz	short loc_423747
		mov	eax, [ebp+Str1]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_423758

loc_423747:				; CODE XREF: sub_42371E+1Dj
		mov	[esp+0A8h+Buf1], 37h
		call	sub_41D9BF
		jmp	loc_4242BC
; ---------------------------------------------------------------------------

loc_423758:				; CODE XREF: sub_42371E+27j
		cmp	[ebp+arg_18], 14h
		jz	short loc_423781
		cmp	[ebp+arg_18], 10h
		jz	short loc_423781
		cmp	[ebp+arg_18], 23h
		jz	short loc_423781
		cmp	[ebp+arg_18], 24h
		jz	short loc_423781
		mov	[esp+0A8h+Buf1], 37h
		call	sub_41D9BF
		jmp	loc_4242BC
; ---------------------------------------------------------------------------

loc_423781:				; CODE XREF: sub_42371E+3Ej
					; sub_42371E+44j ...
		lea	eax, [ebp+var_5C]
		mov	[esp+0A8h+Size], eax ; int
		mov	eax, [ebp+Str1]
		mov	[esp+0A8h+Buf2], eax ; Str1
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+Buf1], eax ; int
		call	sub_41E373
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4237AB
		mov	eax, [ebp+var_C]
		jmp	loc_4242BC
; ---------------------------------------------------------------------------

loc_4237AB:				; CODE XREF: sub_42371E+83j
		mov	eax, [ebp+var_5C]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 4
		test	al, al
		jnz	short loc_4237F9
		mov	eax, [ebp+var_5C]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 8
		test	al, al
		jnz	short loc_4237F9
		mov	eax, [ebp+var_5C]
		movzx	eax, byte ptr [eax+15h]
		and	eax, 2
		test	al, al
		jnz	short loc_4237F9
		mov	eax, [ebp+Str1]
		mov	[esp+0A8h+Buf2], eax ; char
		mov	[esp+0A8h+Buf1], offset	aKeySMayNotBeUs	; "key %s may not be used for signing\n"
		call	sub_43CB21
		mov	[esp+0A8h+Buf1], 7Dh
		call	sub_41D9BF
		jmp	loc_4242BC
; ---------------------------------------------------------------------------

loc_4237F9:				; CODE XREF: sub_42371E+99j
					; sub_42371E+A7j ...
		mov	eax, [ebp+var_5C]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_423827
		mov	eax, [ebp+Str1]
		mov	[esp+0A8h+Buf2], eax ; char
		mov	[esp+0A8h+Buf1], offset	aNoAuthenticati	; "no authentication object defined for	%s"...
		call	sub_43CB21
		mov	[esp+0A8h+Buf1], 7Ch
		call	sub_41D9BF
		jmp	loc_4242BC
; ---------------------------------------------------------------------------

loc_423827:				; CODE XREF: sub_42371E+E3j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+38h]
		mov	[ebp+var_14], eax
		jmp	short loc_423873
; ---------------------------------------------------------------------------

loc_423835:				; CODE XREF: sub_42371E+159j
		mov	eax, [ebp+var_14]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_5C]
		mov	eax, [eax+0Ch]
		cmp	edx, eax
		jnz	short loc_42386B
		mov	eax, [ebp+var_5C]
		mov	ecx, [eax+0Ch]
		mov	eax, [ebp+var_5C]
		mov	edx, [eax+10h]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	[esp+0A8h+Size], ecx ; Size
		mov	[esp+0A8h+Buf2], edx ; char
		mov	[esp+0A8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_42387B

loc_42386B:				; CODE XREF: sub_42371E+125j
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_423873:				; CODE XREF: sub_42371E+115j
		cmp	[ebp+var_14], 0
		jnz	short loc_423835
		jmp	short loc_42387C
; ---------------------------------------------------------------------------

loc_42387B:				; CODE XREF: sub_42371E+14Bj
		nop

loc_42387C:				; CODE XREF: sub_42371E+15Bj
		cmp	[ebp+var_14], 0
		jnz	short loc_4238A6
		mov	eax, [ebp+Str1]
		mov	[esp+0A8h+Buf2], eax ; char
		mov	[esp+0A8h+Buf1], offset	aAuthentication	; "authentication object for %s	missing\n"
		call	sub_43CB21
		mov	[esp+0A8h+Buf1], 6Fh
		call	sub_41D9BF
		jmp	loc_4242BC
; ---------------------------------------------------------------------------

loc_4238A6:				; CODE XREF: sub_42371E+162j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_4238CD
		mov	[esp+0A8h+Buf1], offset	aPinVerificatio	; "PIN verification is protected by an add"...
		call	sub_43CB21
		mov	[esp+0A8h+Buf1], 7Ah
		call	sub_41D9BF
		jmp	loc_4242BC
; ---------------------------------------------------------------------------

loc_4238CD:				; CODE XREF: sub_42371E+190j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax+15h]
		and	eax, 2
		test	al, al
		jnz	short loc_4238E9
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax+15h]
		and	eax, 4
		test	al, al
		jz	short loc_423906

loc_4238E9:				; CODE XREF: sub_42371E+1BBj
		mov	[esp+0A8h+Buf1], offset	aPinVerificat_0	; "PIN verification requires unsupported p"...
		call	sub_43CB21
		mov	[esp+0A8h+Buf1], 7Ah
		call	sub_41D9BF
		jmp	loc_4242BC
; ---------------------------------------------------------------------------

loc_423906:				; CODE XREF: sub_42371E+1C9j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_42393B
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 20h
		test	al, al
		jz	short loc_42393B
		mov	[esp+0A8h+Buf1], offset	aPinVerificat_1	; "PIN verification requires padding but n"...
		call	sub_43CB21
		mov	[esp+0A8h+Buf1], 6Fh
		call	sub_41D9BF
		jmp	loc_4242BC
; ---------------------------------------------------------------------------

loc_42393B:				; CODE XREF: sub_42371E+1F0j
					; sub_42371E+1FEj
		mov	eax, [ebp+var_5C]
		mov	eax, [eax+2Ch]
		mov	edx, [ebp+var_5C]
		add	edx, 30h
		mov	[esp+0A8h+Size], eax
		mov	[esp+0A8h+Buf2], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+Buf1], eax
		call	sub_41DC64
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_423993
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+0A8h+Buf1], eax
		call	gpg_strerror
		mov	[esp+0A8h+Size], eax
		mov	eax, [ebp+Str1]
		mov	[esp+0A8h+Buf2], eax ; char
		mov	[esp+0A8h+Buf1], offset	aErrorSelecti_5	; "error selecting file	for key	%s: %s\n"
		call	sub_43CB21
		mov	eax, [ebp+var_C]
		jmp	loc_4242BC
; ---------------------------------------------------------------------------

loc_423993:				; CODE XREF: sub_42371E+243j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+4]
		cmp	eax, 3
		jnz	short loc_423A18
		mov	[ebp+var_61], 4
		mov	[ebp+var_60], 80h
		cmp	[ebp+arg_8], 401h
		jnz	short loc_4239B8
		mov	[ebp+var_5F], 1
		jmp	short loc_4239BC
; ---------------------------------------------------------------------------

loc_4239B8:				; CODE XREF: sub_42371E+292j
		mov	[ebp+var_5F], 2

loc_4239BC:				; CODE XREF: sub_42371E+298j
		mov	[ebp+var_5E], 84h
		mov	eax, [ebp+var_5C]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short loc_4239D2
		mov	eax, [ebp+var_5C]
		mov	eax, [eax+18h]
		jmp	short loc_4239D7
; ---------------------------------------------------------------------------

loc_4239D2:				; CODE XREF: sub_42371E+2AAj
		mov	eax, 0FFFFFF82h

loc_4239D7:				; CODE XREF: sub_42371E+2B2j
		mov	[ebp+var_5D], al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+0A8h+var_98], 5 ; size_t
		lea	edx, [ebp+var_61]
		mov	[esp+0A8h+var_9C], edx ; void *
		mov	[esp+0A8h+Size], 0B6h ;	int
		mov	[esp+0A8h+Buf2], 41h ; int
		mov	[esp+0A8h+Buf1], eax ; char
		call	sub_40D58E
		mov	[ebp+var_C], eax
		mov	[ebp+var_18], 1
		mov	[ebp+var_1C], 1

loc_423A18:				; CODE XREF: sub_42371E+281j
		cmp	[ebp+var_C], 0
		jz	short loc_423A41
		mov	eax, [ebp+var_C]
		mov	[esp+0A8h+Buf1], eax
		call	gpg_strerror
		mov	[esp+0A8h+Buf2], eax ; char
		mov	[esp+0A8h+Buf1], offset	aMseFailedS ; "MSE failed: %s\n"
		call	sub_43CB21
		mov	eax, [ebp+var_C]
		jmp	loc_4242BC
; ---------------------------------------------------------------------------

loc_423A41:				; CODE XREF: sub_42371E+2FEj
		mov	eax, [ebp+var_5C]
		movzx	eax, byte ptr [eax+15h]
		and	eax, 2
		test	al, al
		jz	short loc_423A7C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+4]
		cmp	eax, 3
		jnz	short loc_423A7C
		lea	eax, [ebp+var_68]
		mov	[esp+0A8h+Size], eax
		mov	[esp+0A8h+Buf2], offset	aPinQualifiedSi	; "PIN (qualified signature!)"
		mov	eax, [ebp+arg_10]
		mov	[esp+0A8h+Buf1], eax
		mov	eax, [ebp+arg_C]
		call	eax
		mov	[ebp+var_C], eax
		jmp	short loc_423A99
; ---------------------------------------------------------------------------

loc_423A7C:				; CODE XREF: sub_42371E+32Fj
					; sub_42371E+33Dj
		lea	eax, [ebp+var_68]
		mov	[esp+0A8h+Size], eax
		mov	[esp+0A8h+Buf2], offset	aPin_1 ; "PIN"
		mov	eax, [ebp+arg_10]
		mov	[esp+0A8h+Buf1], eax
		mov	eax, [ebp+arg_C]
		call	eax
		mov	[ebp+var_C], eax

loc_423A99:				; CODE XREF: sub_42371E+35Cj
		cmp	[ebp+var_C], 0
		jz	short loc_423AC2
		mov	eax, [ebp+var_C]
		mov	[esp+0A8h+Buf1], eax
		call	gpg_strerror
		mov	[esp+0A8h+Buf2], eax ; char
		mov	[esp+0A8h+Buf1], offset	aPinCallbackR_2	; "PIN callback	returned error:	%s\n"
		call	sub_43CAF7
		mov	eax, [ebp+var_C]
		jmp	loc_4242BC
; ---------------------------------------------------------------------------

loc_423AC2:				; CODE XREF: sub_42371E+37Fj
		mov	eax, [ebp+var_68]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+1Ch]
		cmp	edx, eax
		jnb	short loc_423B15
		mov	eax, [ebp+var_14]
		mov	eax, [eax+1Ch]
		mov	[esp+0A8h+Buf2], eax ; char
		mov	[esp+0A8h+Buf1], offset	aPinIsTooShor_1	; "PIN is too short; minimum length is %lu"...
		call	sub_43CB21
		mov	[esp+0A8h+Buf1], 57h
		call	sub_41D9BF
		mov	[ebp+var_C], eax
		jmp	loc_423BC7
; ---------------------------------------------------------------------------

loc_423B15:				; CODE XREF: sub_42371E+3CBj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	short loc_423B6F
		mov	eax, [ebp+var_68]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		cmp	edx, eax
		jbe	short loc_423B6F
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		mov	[esp+0A8h+Buf2], eax ; char
		mov	[esp+0A8h+Buf1], offset	aPinIsTooLarg_1	; "PIN is too large; maximum length is %lu"...
		call	sub_43CB21
		mov	[esp+0A8h+Buf1], 57h
		call	sub_41D9BF
		mov	[ebp+var_C], eax
		jmp	short loc_423BC7
; ---------------------------------------------------------------------------

loc_423B6F:				; CODE XREF: sub_42371E+3FFj
					; sub_42371E+428j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_423BC7
		mov	eax, [ebp+var_68]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+24h]
		cmp	edx, eax
		jbe	short loc_423BC7
		mov	eax, [ebp+var_14]
		mov	eax, [eax+24h]
		mov	[esp+0A8h+Buf2], eax ; char
		mov	[esp+0A8h+Buf1], offset	aPinIsTooLarg_1	; "PIN is too large; maximum length is %lu"...
		call	sub_43CB21
		mov	[esp+0A8h+Buf1], 57h
		call	sub_41D9BF
		mov	[ebp+var_C], eax

loc_423BC7:				; CODE XREF: sub_42371E+3F2j
					; sub_42371E+44Fj ...
		cmp	[ebp+var_C], 0
		jz	short loc_423BE0
		mov	eax, [ebp+var_68]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	loc_4242BC
; ---------------------------------------------------------------------------

loc_423BE0:				; CODE XREF: sub_42371E+4ADj
		mov	dword ptr [ebp+var_24],	0
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		cmp	eax, 4		; switch 5 cases
		ja	short loc_423C56 ; jumptable 00423C00 default case
		mov	eax, ds:off_44CDB4[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_423C02:				; CODE XREF: sub_42371E+4E2j
					; DATA XREF: .rdata:off_44CDB4o
		mov	eax, [ebp+var_68] ; jumptable 00423C00 cases 0,1
		mov	[ebp+var_28], eax
		jmp	short loc_423C0E
; ---------------------------------------------------------------------------

loc_423C0A:				; CODE XREF: sub_42371E+502j
		add	[ebp+var_28], 1

loc_423C0E:				; CODE XREF: sub_42371E+4EAj
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_423C22
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_423C0A

loc_423C22:				; CODE XREF: sub_42371E+4F8j
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_423C62
		mov	dword ptr [ebp+var_24],	offset aNonNumericDi_0 ; "Non-numeric digits found in PIN"
		mov	[esp+0A8h+Buf1], 57h
		call	sub_41D9BF
		mov	[ebp+var_C], eax
		jmp	short loc_423C62
; ---------------------------------------------------------------------------

loc_423C44:				; CODE XREF: sub_42371E+4E2j
					; DATA XREF: .rdata:off_44CDB4o
		mov	dword ptr [ebp+var_24],	offset aPinTypeHalfNib ; jumptable 00423C00 case 3
		jmp	short loc_423C63
; ---------------------------------------------------------------------------

loc_423C4D:				; CODE XREF: sub_42371E+4E2j
					; DATA XREF: .rdata:off_44CDB4o
		mov	dword ptr [ebp+var_24],	offset aPinTypeIso9564 ; jumptable 00423C00 case 4
		jmp	short loc_423C63
; ---------------------------------------------------------------------------

loc_423C56:				; CODE XREF: sub_42371E+4D9j
		mov	dword ptr [ebp+var_24],	offset aUnknownPinType ; jumptable 00423C00 default case
		jmp	short loc_423C63
; ---------------------------------------------------------------------------

loc_423C5F:				; CODE XREF: sub_42371E+4E2j
					; DATA XREF: .rdata:off_44CDB4o
		nop			; jumptable 00423C00 case 2
		jmp	short loc_423C63
; ---------------------------------------------------------------------------

loc_423C62:				; CODE XREF: sub_42371E+50Cj
					; sub_42371E+524j
		nop

loc_423C63:				; CODE XREF: sub_42371E+52Dj
					; sub_42371E+536j ...
		cmp	dword ptr [ebp+var_24],	0
		jz	short loc_423CA3
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+0A8h+Buf2], eax ; char
		mov	[esp+0A8h+Buf1], offset	aCanTVerifyPinS	; "can't verify PIN: %s\n"
		call	sub_43CB21
		mov	eax, [ebp+var_68]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jnz	short loc_423C9B
		mov	[esp+0A8h+Buf1], 7Ah
		call	sub_41D9BF
		jmp	short loc_423C9E
; ---------------------------------------------------------------------------

loc_423C9B:				; CODE XREF: sub_42371E+56Dj
		mov	eax, [ebp+var_C]

loc_423C9E:				; CODE XREF: sub_42371E+57Bj
		jmp	loc_4242BC
; ---------------------------------------------------------------------------

loc_423CA3:				; CODE XREF: sub_42371E+549j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		test	eax, eax
		jnz	loc_423E2E
		mov	[ebp+var_2C], 0
		mov	eax, [ebp+var_68]
		mov	[ebp+var_28], eax
		jmp	short loc_423CC8
; ---------------------------------------------------------------------------

loc_423CC0:				; CODE XREF: sub_42371E+5B2j
		add	[ebp+var_2C], 1
		add	[ebp+var_28], 1

loc_423CC8:				; CODE XREF: sub_42371E+5A0j
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_423CC0
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		add	eax, 1
		mov	[esp+0A8h+Buf1], eax
		call	gcry_malloc
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	short loc_423D07
		call	sub_41D9E7
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_68]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	loc_4242BC
; ---------------------------------------------------------------------------

loc_423D07:				; CODE XREF: sub_42371E+5CCj
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		and	edx, 0Fh
		or	edx, 20h
		mov	[eax], dl
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_68]
		mov	[ebp+var_28], eax
		jmp	short loc_423D58
; ---------------------------------------------------------------------------

loc_423D2B:				; CODE XREF: sub_42371E+65Cj
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_30]
		mov	edx, [ebp+var_28]
		movzx	edx, byte ptr [edx]
		movsx	edx, dl
		sub	edx, 30h
		shl	edx, 4
		mov	ecx, [ebp+var_28]
		add	ecx, 1
		movzx	ecx, byte ptr [ecx]
		and	ecx, 0Fh
		or	edx, ecx
		mov	[eax], dl
		add	[ebp+var_10], 1
		add	[ebp+var_28], 2

loc_423D58:				; CODE XREF: sub_42371E+60Bj
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		cmp	edx, eax
		jnb	short loc_423D7C
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_423D7C
		mov	eax, [ebp+var_28]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_423D2B

loc_423D7C:				; CODE XREF: sub_42371E+645j
					; sub_42371E+64Fj
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		cmp	edx, eax
		jnb	short loc_423DCF
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_423DCF
		mov	eax, [ebp+var_10]
		mov	edx, eax
		add	edx, [ebp+var_30]
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		shl	eax, 4
		mov	ecx, eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+38h]
		test	eax, eax
		jz	short loc_423DC2
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax+34h]
		and	eax, 0Fh
		jmp	short loc_423DC7
; ---------------------------------------------------------------------------

loc_423DC2:				; CODE XREF: sub_42371E+696j
		mov	eax, 0

loc_423DC7:				; CODE XREF: sub_42371E+6A2j
		or	eax, ecx
		mov	[edx], al
		add	[ebp+var_10], 1

loc_423DCF:				; CODE XREF: sub_42371E+669j
					; sub_42371E+673j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 20h
		test	al, al
		jz	short loc_423E12
		jmp	short loc_423E05
; ---------------------------------------------------------------------------

loc_423DDF:				; CODE XREF: sub_42371E+6F2j
		mov	eax, [ebp+var_10]
		mov	edx, eax
		add	edx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+38h]
		test	eax, eax
		jz	short loc_423DFA
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax+34h]
		jmp	short loc_423DFF
; ---------------------------------------------------------------------------

loc_423DFA:				; CODE XREF: sub_42371E+6D1j
		mov	eax, 0

loc_423DFF:				; CODE XREF: sub_42371E+6DAj
		mov	[edx], al
		add	[ebp+var_10], 1

loc_423E05:				; CODE XREF: sub_42371E+6BFj
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		cmp	edx, eax
		jb	short loc_423DDF

loc_423E12:				; CODE XREF: sub_42371E+6BDj
		mov	eax, [ebp+var_68]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_free
		mov	eax, [ebp+var_30]
		mov	[ebp+var_68], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_20], eax
		jmp	loc_423F2D
; ---------------------------------------------------------------------------

loc_423E2E:				; CODE XREF: sub_42371E+58Dj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 20h
		test	al, al
		jz	loc_423F0B
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		add	eax, 1
		mov	[esp+0A8h+Buf1], eax
		call	gcry_malloc
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jnz	short loc_423E75
		call	sub_41D9E7
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_68]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	loc_4242BC
; ---------------------------------------------------------------------------

loc_423E75:				; CODE XREF: sub_42371E+73Aj
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_68]
		mov	[ebp+var_28], eax
		jmp	short loc_423E9A
; ---------------------------------------------------------------------------

loc_423E84:				; CODE XREF: sub_42371E+791j
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_34]
		mov	edx, [ebp+var_28]
		movzx	edx, byte ptr [edx]
		mov	[eax], dl
		add	[ebp+var_10], 1
		add	[ebp+var_28], 1

loc_423E9A:				; CODE XREF: sub_42371E+764j
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		cmp	edx, eax
		jnb	short loc_423EDB
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_423E84
		jmp	short loc_423EDB
; ---------------------------------------------------------------------------

loc_423EB3:				; CODE XREF: sub_42371E+7C9j
		mov	eax, [ebp+var_10]
		mov	edx, eax
		add	edx, [ebp+var_34]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+38h]
		test	eax, eax
		jz	short loc_423ECE
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax+34h]
		jmp	short loc_423ED3
; ---------------------------------------------------------------------------

loc_423ECE:				; CODE XREF: sub_42371E+7A5j
		mov	eax, 0

loc_423ED3:				; CODE XREF: sub_42371E+7AEj
		mov	[edx], al
		add	[ebp+var_10], 1
		jmp	short loc_423EDC
; ---------------------------------------------------------------------------

loc_423EDB:				; CODE XREF: sub_42371E+787j
					; sub_42371E+793j
		nop

loc_423EDC:				; CODE XREF: sub_42371E+7BBj
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		cmp	edx, eax
		jb	short loc_423EB3
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_34]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_68]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_free
		mov	eax, [ebp+var_34]
		mov	[ebp+var_68], eax
		jmp	short loc_423F2D
; ---------------------------------------------------------------------------

loc_423F0B:				; CODE XREF: sub_42371E+71Cj
		mov	eax, [ebp+var_68]
		mov	[ebp+var_7C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_7C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_20], eax

loc_423F2D:				; CODE XREF: sub_42371E+70Bj
					; sub_42371E+7EBj
		mov	ecx, [ebp+var_68]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+30h]
		test	eax, eax
		jz	short loc_423F42
		mov	eax, [ebp+var_14]
		mov	eax, [eax+2Ch]
		jmp	short loc_423F47
; ---------------------------------------------------------------------------

loc_423F42:				; CODE XREF: sub_42371E+81Aj
		mov	eax, 0

loc_423F47:				; CODE XREF: sub_42371E+822j
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+4]
		mov	ebx, [ebp+var_20]
		mov	[esp+0A8h+var_9C], ebx ; size_t
		mov	[esp+0A8h+Size], ecx ; void *
		mov	[esp+0A8h+Buf2], eax ; char
		mov	[esp+0A8h+Buf1], edx ; char
		call	sub_40D14D
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_68]
		mov	[esp+0A8h+Buf1], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_423F9B
		mov	eax, [ebp+var_C]
		mov	[esp+0A8h+Buf1], eax
		call	gpg_strerror
		mov	[esp+0A8h+Buf2], eax ; char
		mov	[esp+0A8h+Buf1], offset	aPinVerificat_2	; "PIN verification failed: %s\n"
		call	sub_43CB21
		mov	eax, [ebp+var_C]
		jmp	loc_4242BC
; ---------------------------------------------------------------------------

loc_423F9B:				; CODE XREF: sub_42371E+858j
		mov	[esp+0A8h+Buf1], offset	aPinVerificat_3	; "PIN verification succeeded\n"
		call	sub_43CBBE
		cmp	[ebp+arg_18], 24h
		jnz	short loc_423FE5
		cmp	[ebp+arg_8], 401h
		jz	short loc_423FC7
		mov	[esp+0A8h+Buf1], 54h
		call	sub_41D9BF
		jmp	loc_4242BC
; ---------------------------------------------------------------------------

loc_423FC7:				; CODE XREF: sub_42371E+896j
		lea	eax, [ebp+Dst]
		mov	edx, [ebp+Src]
		mov	ecx, [ebp+arg_18]
		mov	[esp+0A8h+Size], ecx ; Size
		mov	[esp+0A8h+Buf2], edx ; Src
		mov	[esp+0A8h+Buf1], eax ; Dst
		call	memcpy
		jmp	loc_4240FB
; ---------------------------------------------------------------------------

loc_423FE5:				; CODE XREF: sub_42371E+88Dj
		cmp	[ebp+arg_18], 23h
		jnz	short loc_424064
		cmp	[ebp+arg_8], 2
		jnz	short loc_424010
		mov	[esp+0A8h+Size], 0Fh ; Size
		mov	[esp+0A8h+Buf2], offset	dword_444B94 ; Buf2
		mov	eax, [ebp+Src]
		mov	[esp+0A8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_424046

loc_424010:				; CODE XREF: sub_42371E+8D1j
		cmp	[ebp+arg_8], 3
		jnz	short loc_424035
		mov	[esp+0A8h+Size], 0Fh ; Size
		mov	[esp+0A8h+Buf2], offset	dword_444BA3 ; Buf2
		mov	eax, [ebp+Src]
		mov	[esp+0A8h+Buf1], eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_424046

loc_424035:				; CODE XREF: sub_42371E+8F6j
		mov	[esp+0A8h+Buf1], 54h
		call	sub_41D9BF
		jmp	loc_4242BC
; ---------------------------------------------------------------------------

loc_424046:				; CODE XREF: sub_42371E+8F0j
					; sub_42371E+915j
		lea	eax, [ebp+Dst]
		mov	edx, [ebp+Src]
		mov	ecx, [ebp+arg_18]
		mov	[esp+0A8h+Size], ecx ; Size
		mov	[esp+0A8h+Buf2], edx ; Src
		mov	[esp+0A8h+Buf1], eax ; Dst
		call	memcpy
		jmp	loc_4240FB
; ---------------------------------------------------------------------------

loc_424064:				; CODE XREF: sub_42371E+8CBj
		cmp	[ebp+arg_8], 2
		jnz	short loc_424099
		mov	eax, dword_444B94
		mov	[ebp+Dst], eax
		mov	eax, dword_444B98
		mov	[ebp+var_54], eax
		mov	eax, dword_444B9C
		mov	[ebp+var_50], eax
		movzx	eax, word_444BA0
		mov	[ebp+var_4C], ax
		movzx	eax, byte_444BA2
		mov	[ebp+var_4A], al
		jmp	short loc_4240DF
; ---------------------------------------------------------------------------

loc_424099:				; CODE XREF: sub_42371E+94Aj
		cmp	[ebp+arg_8], 3
		jnz	short loc_4240CE
		mov	eax, dword_444BA3
		mov	[ebp+Dst], eax
		mov	eax, dword_444BA7
		mov	[ebp+var_54], eax
		mov	eax, dword_444BAB
		mov	[ebp+var_50], eax
		movzx	eax, word_444BAF
		mov	[ebp+var_4C], ax
		movzx	eax, byte_444BB1
		mov	[ebp+var_4A], al
		jmp	short loc_4240DF
; ---------------------------------------------------------------------------

loc_4240CE:				; CODE XREF: sub_42371E+97Fj
		mov	[esp+0A8h+Buf1], 54h
		call	sub_41D9BF
		jmp	loc_4242BC
; ---------------------------------------------------------------------------

loc_4240DF:				; CODE XREF: sub_42371E+979j
					; sub_42371E+9AEj
		lea	eax, [ebp+Dst]
		add	eax, 0Fh
		mov	edx, [ebp+Src]
		mov	ecx, [ebp+arg_18]
		mov	[esp+0A8h+Size], ecx ; Size
		mov	[esp+0A8h+Buf2], edx ; Src
		mov	[esp+0A8h+Buf1], eax ; Dst
		call	memcpy

loc_4240FB:				; CODE XREF: sub_42371E+8C2j
					; sub_42371E+941j
		cmp	[ebp+var_1C], 0
		jz	short loc_42410D
		mov	[ebp+var_C], 0
		jmp	loc_4241BD
; ---------------------------------------------------------------------------

loc_42410D:				; CODE XREF: sub_42371E+9E1j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+4]
		cmp	eax, 1
		jz	loc_4241BD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+4]
		cmp	eax, 2
		jnz	short loc_424172
		mov	eax, [ebp+var_5C]
		mov	eax, [eax+2Ch]
		test	eax, eax
		jnz	short loc_424148
		mov	[esp+0A8h+Buf1], 3Bh
		call	sub_41D9BF
		mov	[ebp+var_C], eax
		jmp	short loc_4241BD
; ---------------------------------------------------------------------------

loc_424148:				; CODE XREF: sub_42371E+A17j
		mov	eax, [ebp+var_5C]
		mov	edx, [ebp+var_5C]
		mov	edx, [edx+2Ch]
		sub	edx, 1
		add	edx, 18h
		movzx	eax, word ptr [eax+edx*2]
		movzx	eax, ax
		mov	[esp+0A8h+Buf2], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0A8h+Buf1], eax
		call	sub_4233EC
		mov	[ebp+var_C], eax
		jmp	short loc_4241BD
; ---------------------------------------------------------------------------

loc_424172:				; CODE XREF: sub_42371E+A0Dj
		mov	eax, [ebp+var_5C]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short loc_4241BD
		mov	[ebp+var_6B], 84h
		mov	[ebp+var_6A], 1
		mov	eax, [ebp+var_5C]
		mov	eax, [eax+18h]
		mov	[ebp+var_69], al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+0A8h+var_98], 3 ; size_t
		lea	edx, [ebp+var_6B]
		mov	[esp+0A8h+var_9C], edx ; void *
		mov	[esp+0A8h+Size], 0B6h ;	int
		mov	[esp+0A8h+Buf2], 41h ; int
		mov	[esp+0A8h+Buf1], eax ; char
		call	sub_40D58E
		mov	[ebp+var_C], eax

loc_4241BD:				; CODE XREF: sub_42371E+9EAj
					; sub_42371E+9FBj ...
		cmp	[ebp+var_C], 0
		jz	short loc_4241E6
		mov	eax, [ebp+var_C]
		mov	[esp+0A8h+Buf1], eax
		call	gpg_strerror
		mov	[esp+0A8h+Buf2], eax ; char
		mov	[esp+0A8h+Buf1], offset	aMseFailedS ; "MSE failed: %s\n"
		call	sub_43CB21
		mov	eax, [ebp+var_C]
		jmp	loc_4242BC
; ---------------------------------------------------------------------------

loc_4241E6:				; CODE XREF: sub_42371E+AA3j
		cmp	[ebp+arg_8], 401h
		jnz	short loc_424232
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_20]
		mov	[esp+0A8h+var_90], edx ; int
		mov	edx, [ebp+arg_1C]
		mov	[esp+0A8h+var_94], edx ; int
		mov	[esp+0A8h+var_98], 0 ; int
		mov	[esp+0A8h+var_9C], 24h ; size_t
		lea	edx, [ebp+Dst]
		mov	[esp+0A8h+Size], edx ; void *
		mov	[esp+0A8h+Buf2], 0 ; int
		mov	[esp+0A8h+Buf1], eax ; char
		call	sub_40D61C
		mov	[ebp+var_C], eax
		jmp	loc_4242B9
; ---------------------------------------------------------------------------

loc_424232:				; CODE XREF: sub_42371E+ACFj
		cmp	[ebp+var_18], 0
		jz	short loc_42427B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_20]
		mov	[esp+0A8h+var_90], edx ; int
		mov	edx, [ebp+arg_1C]
		mov	[esp+0A8h+var_94], edx ; int
		mov	[esp+0A8h+var_98], 0 ; int
		mov	[esp+0A8h+var_9C], 14h ; size_t
		lea	edx, [ebp+Dst]
		add	edx, 0Fh
		mov	[esp+0A8h+Size], edx ; void *
		mov	[esp+0A8h+Buf2], 0 ; int
		mov	[esp+0A8h+Buf1], eax ; char
		call	sub_40D61C
		mov	[ebp+var_C], eax
		jmp	short loc_4242B9
; ---------------------------------------------------------------------------

loc_42427B:				; CODE XREF: sub_42371E+B18j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_20]
		mov	[esp+0A8h+var_90], edx ; int
		mov	edx, [ebp+arg_1C]
		mov	[esp+0A8h+var_94], edx ; int
		mov	[esp+0A8h+var_98], 0 ; int
		mov	[esp+0A8h+var_9C], 23h ; size_t
		lea	edx, [ebp+Dst]
		mov	[esp+0A8h+Size], edx ; void *
		mov	[esp+0A8h+Buf2], 0 ; int
		mov	[esp+0A8h+Buf1], eax ; char
		call	sub_40D61C
		mov	[ebp+var_C], eax

loc_4242B9:				; CODE XREF: sub_42371E+B0Fj
					; sub_42371E+B5Bj
		mov	eax, [ebp+var_C]

loc_4242BC:				; CODE XREF: sub_42371E+35j
					; sub_42371E+5Ej ...
		add	esp, 0A0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_42371E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4242C6(int, char *, int, int,	void *,	size_t,	int, int)
sub_4242C6	proc near		; DATA XREF: sub_4245B2+3A4o

var_48		= dword	ptr -48h
Str1		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
Src		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		cmp	[ebp+arg_4], 0
		jz	short loc_4242DC
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4242ED

loc_4242DC:				; CODE XREF: sub_4242C6+Aj
		mov	[esp+48h+var_48], 37h
		call	sub_41D9BF
		jmp	locret_42439E
; ---------------------------------------------------------------------------

loc_4242ED:				; CODE XREF: sub_4242C6+14j
		lea	eax, [ebp+var_14]
		mov	[esp+48h+var_40], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str1],	eax ; Str1
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_41E373
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_424317
		mov	eax, [ebp+var_C]
		jmp	locret_42439E
; ---------------------------------------------------------------------------

loc_424317:				; CODE XREF: sub_4242C6+47j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax+14h]
		and	eax, 4
		test	al, al
		jnz	short loc_424346
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str1],	eax ; char
		mov	[esp+48h+var_48], offset aKeySMayNotBe_0 ; "key	%s may not be used for authenticati"...
		call	sub_43CB21
		mov	[esp+48h+var_48], 7Dh
		call	sub_41D9BF
		jmp	short locret_42439E
; ---------------------------------------------------------------------------

loc_424346:				; CODE XREF: sub_4242C6+5Dj
		cmp	[ebp+arg_14], 24h
		jnz	short loc_424353
		mov	eax, 401h
		jmp	short loc_424358
; ---------------------------------------------------------------------------

loc_424353:				; CODE XREF: sub_4242C6+84j
		mov	eax, 2

loc_424358:				; CODE XREF: sub_4242C6+8Bj
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_1C]
		mov	[esp+48h+var_28], eax ;	int
		mov	eax, [ebp+arg_18]
		mov	[esp+48h+var_2C], eax ;	int
		mov	eax, [ebp+arg_14]
		mov	[esp+48h+var_30], eax ;	size_t
		mov	eax, [ebp+arg_10]
		mov	[esp+48h+Src], eax ; Src
		mov	eax, [ebp+arg_C]
		mov	[esp+48h+var_38], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_3C], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_40], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Str1],	eax ; Str1
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_42371E

locret_42439E:				; CODE XREF: sub_4242C6+22j
					; sub_4242C6+4Cj ...
		leave
		retn
sub_4242C6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4243A0	proc near		; CODE XREF: sub_4245B2+AAp

Buf1		= dword	ptr -48h
Buf2		= dword	ptr -44h
Size		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_A		= word ptr -0Ah
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[ebp+var_A], 0
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		lea	eax, [ebp+var_20]
		mov	[esp+48h+var_38], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+Size],	0
		mov	[esp+48h+Buf2],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Buf1],	eax
		call	sub_40DC72
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_42440C
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Buf1],	eax
		call	gpg_strerror
		mov	[esp+48h+Buf2],	eax ; char
		mov	[esp+48h+Buf1],	offset aErrorReading_4 ; "error	reading	EF{DIR}: %s\n"
		call	sub_43CB21
		mov	eax, 0
		jmp	locret_4245B0
; ---------------------------------------------------------------------------

loc_42440C:				; CODE XREF: sub_4243A0+45j
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_1C]
		lea	ecx, [ebp+var_24]
		mov	[esp+48h+var_3C], ecx
		mov	[esp+48h+Size],	61h
		mov	[esp+48h+Buf2],	edx
		mov	[esp+48h+Buf1],	eax
		call	sub_42D39C
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	loc_4245A1
		mov	eax, [ebp+var_24]
		test	eax, eax
		jz	loc_4245A1
		mov	eax, [ebp+var_24]
		lea	edx, [ebp+var_28]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+Size],	4Fh
		mov	[esp+48h+Buf2],	eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Buf1],	eax
		call	sub_42D39C
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	loc_4245A1
		mov	eax, [ebp+var_28]
		cmp	eax, 0Ch
		jnz	short loc_424499
		mov	eax, [ebp+var_28]
		mov	[esp+48h+Size],	eax ; Size
		mov	[esp+48h+Buf2],	offset byte_44C127 ; Buf2
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_4244DD

loc_424499:				; CODE XREF: sub_4243A0+D9j
		mov	eax, [ebp+var_28]
		cmp	eax, 0Ch
		jnz	short loc_4244C6
		mov	eax, [ebp+var_28]
		mov	[esp+48h+Size],	eax ; Size
		mov	[esp+48h+Buf2],	(offset	a15a+3)	; Buf2
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_4244C6
		mov	eax, 1
		jmp	short loc_4244CB
; ---------------------------------------------------------------------------

loc_4244C6:				; CODE XREF: sub_4243A0+FFj
					; sub_4243A0+11Dj
		mov	eax, 0

loc_4244CB:				; CODE XREF: sub_4243A0+124j
		mov	edx, [ebp+arg_4]
		mov	[edx], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jz	loc_4245A1

loc_4244DD:				; CODE XREF: sub_4243A0+F7j
		mov	eax, [ebp+var_24]
		lea	edx, [ebp+var_28]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+Size],	50h
		mov	[esp+48h+Buf2],	eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Buf1],	eax
		call	sub_42D39C
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_424521
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_18]
		mov	[esp+48h+Size],	edx
		mov	[esp+48h+Buf2],	eax ; char
		mov	[esp+48h+Buf1],	offset aPkcs15Applicat ; "pkcs#15 application label from EF(DIR) "...
		call	sub_43CAF7

loc_424521:				; CODE XREF: sub_4243A0+165j
		mov	eax, [ebp+var_24]
		lea	edx, [ebp+var_28]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+Size],	51h
		mov	[esp+48h+Buf2],	eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Buf1],	eax
		call	sub_42D39C
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_4245A1
		mov	eax, [ebp+var_28]
		cmp	eax, 4
		jnz	short loc_4245A1
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Fh
		jnz	short loc_4245A1
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4245A1
		mov	eax, [ebp+var_18]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 8
		mov	edx, eax
		mov	eax, [ebp+var_18]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, edx
		mov	[ebp+var_A], ax
		movzx	eax, [ebp+var_A]
		mov	[esp+48h+Buf2],	eax ; char
		mov	[esp+48h+Buf1],	offset aPkcs15Applic_0 ; "pkcs#15 application directory	is 0x%04h"...
		call	sub_43CAF7

loc_4245A1:				; CODE XREF: sub_4243A0+94j
					; sub_4243A0+9Fj ...
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Buf1],	eax
		call	gcry_free
		movzx	eax, [ebp+var_A]

locret_4245B0:				; CODE XREF: sub_4243A0+67j
		leave
		retn
sub_4243A0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4245B2	proc near		; CODE XREF: sub_40E65D+405p

Buf1		= dword	ptr -58h
Buf2		= dword	ptr -54h
Size		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_34		= dword	ptr -34h
var_2E		= word ptr -2Eh
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_E		= word ptr -0Eh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	dword ptr [ebp+var_20],	eax
		mov	[ebp+var_E], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_2C], 0
		mov	[esp+58h+var_4C], 0 ; int
		mov	[esp+58h+Size],	0Ch ; size_t
		mov	[esp+58h+Buf2],	offset byte_44C127 ; void *
		mov	eax, dword ptr [ebp+var_20]
		mov	[esp+58h+Buf1],	eax ; char
		call	sub_40CCE9
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_4246A4
		mov	[ebp+var_2E], 2F00h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+58h+var_48], 0
		mov	[esp+58h+var_4C], 0
		mov	[esp+58h+Size],	1
		lea	edx, [ebp+var_2E]
		mov	[esp+58h+Buf2],	edx
		mov	[esp+58h+Buf1],	eax
		call	sub_40CE0F
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4246A4
		mov	[ebp+var_18], 1
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+Buf2],	eax
		mov	eax, dword ptr [ebp+var_20]
		mov	[esp+58h+Buf1],	eax
		call	sub_4243A0
		mov	[ebp+var_E], ax
		cmp	[ebp+var_E], 0
		jz	short loc_4246A4
		movzx	eax, [ebp+var_E]
		mov	[ebp+var_2E], ax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+58h+var_48], 0
		mov	[esp+58h+var_4C], 0
		mov	[esp+58h+Size],	1
		lea	edx, [ebp+var_2E]
		mov	[esp+58h+Buf2],	edx
		mov	[esp+58h+Buf1],	eax
		call	sub_40CE0F
		mov	[ebp+var_C], eax

loc_4246A4:				; CODE XREF: sub_4245B2+54j
					; sub_4245B2+94j ...
		cmp	[ebp+var_C], 0
		jz	short loc_4246DE
		mov	[ebp+var_E], 5015h
		movzx	eax, [ebp+var_E]
		mov	[esp+58h+var_48], 0
		mov	[esp+58h+var_4C], 0
		mov	[esp+58h+Size],	1
		mov	[esp+58h+Buf2],	eax
		mov	eax, dword ptr [ebp+var_20]
		mov	[esp+58h+Buf1],	eax
		call	sub_40CD52
		mov	[ebp+var_C], eax

loc_4246DE:				; CODE XREF: sub_4245B2+F6j
		cmp	[ebp+var_C], 0
		jnz	loc_4247BD
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jz	short loc_4246FB
		mov	[ebp+var_14], 3
		jmp	loc_4247BD
; ---------------------------------------------------------------------------

loc_4246FB:				; CODE XREF: sub_4245B2+13Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		lea	edx, [ebp+var_34]
		mov	[esp+58h+Buf2],	edx
		mov	[esp+58h+Buf1],	eax
		call	sub_40AEE3
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_42472D
		mov	[esp+58h+Buf1],	6Fh
		call	sub_41D9BF
		mov	[ebp+var_C], eax
		jmp	loc_4247BD
; ---------------------------------------------------------------------------

loc_42472D:				; CODE XREF: sub_4245B2+165j
		mov	[ebp+var_1C], 0
		jmp	short loc_42479B
; ---------------------------------------------------------------------------

loc_424736:				; CODE XREF: sub_4245B2+1FEj
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_444B40
		mov	edx, [eax]
		mov	eax, [ebp+var_34]
		cmp	edx, eax
		jnz	short loc_424797
		mov	ecx, [ebp+var_34]
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_444B40
		mov	eax, [eax+4]
		mov	[esp+58h+Size],	ecx ; Size
		mov	edx, [ebp+var_24]
		mov	[esp+58h+Buf2],	edx ; Buf2
		mov	[esp+58h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_424797
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_444B40
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		jmp	short loc_4247B2
; ---------------------------------------------------------------------------

loc_424797:				; CODE XREF: sub_4245B2+19Cj
					; sub_4245B2+1CAj
		add	[ebp+var_1C], 1

loc_42479B:				; CODE XREF: sub_4245B2+182j
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 2
		add	eax, offset dword_444B40
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_424736

loc_4247B2:				; CODE XREF: sub_4245B2+1E3j
		mov	eax, [ebp+var_24]
		mov	[esp+58h+Buf1],	eax
		call	gcry_free

loc_4247BD:				; CODE XREF: sub_4245B2+130j
					; sub_4245B2+144j ...
		cmp	[ebp+var_C], 0
		jnz	loc_42498F
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], offset aP15_1 ; "P15"
		mov	[esp+58h+Buf2],	3Ch
		mov	[esp+58h+Buf1],	1
		call	gcry_calloc
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_424804
		call	sub_41D9E7
		mov	[ebp+var_C], eax
		jmp	loc_42497E
; ---------------------------------------------------------------------------

loc_424804:				; CODE XREF: sub_4245B2+243j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		movzx	edx, [ebp+var_E]
		mov	[eax], dx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+var_14]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+var_18]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Buf1],	eax
		call	sub_422340
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_42497D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, 0Ch
		jnz	loc_42490D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+58h+Size],	0Ch ; Size
		mov	[esp+58h+Buf2],	offset aV ; "v"
		mov	[esp+58h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	loc_42490D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	eax, 3
		mov	[esp+58h+Buf1],	eax
		call	gcry_malloc
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_4248AE
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+58h+Buf1],	eax
		call	gpg_err_code_from_errno
		mov	[esp+58h+Buf1],	eax
		call	sub_41D9BF
		mov	[ebp+var_C], eax
		jmp	short loc_42490D
; ---------------------------------------------------------------------------

loc_4248AE:				; CODE XREF: sub_4245B2+2DCj
		mov	edx, offset byte_44CE7F
		mov	eax, [ebp+var_28]
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		movzx	edx, byte ptr [edx+2]
		mov	[eax+2], dl
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, eax
		mov	eax, [ebp+var_28]
		add	eax, 3
		mov	[esp+58h+Size],	ecx ; Size
		mov	[esp+58h+Buf2],	edx ; Src
		mov	[esp+58h+Buf1],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		lea	edx, [eax+3]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+58h+Buf1],	eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_28]
		mov	[eax+8], edx

loc_42490D:				; CODE XREF: sub_4245B2+298j
					; sub_4245B2+2BEj ...
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], offset sub_41DAF2
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], offset sub_422B0F
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+28h], offset sub_423054
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], offset sub_4230B6
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+34h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+38h], offset sub_42371E
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+3Ch], offset sub_4242C6
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+40h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+50h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+54h], 0
		jmp	short loc_42497E
; ---------------------------------------------------------------------------

loc_42497D:				; CODE XREF: sub_4245B2+289j
		nop

loc_42497E:				; CODE XREF: sub_4245B2+24Dj
					; sub_4245B2+3C9j
		cmp	[ebp+var_C], 0
		jz	short loc_42498F
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Buf1],	eax
		call	sub_41DAF2

loc_42498F:				; CODE XREF: sub_4245B2+20Fj
					; sub_4245B2+3D0j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4245B2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_424994	proc near		; CODE XREF: sub_4249BB+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_4249B4
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_4249B9
; ---------------------------------------------------------------------------

loc_4249B4:				; CODE XREF: sub_424994+7j
		mov	eax, 0

loc_4249B9:				; CODE XREF: sub_424994+1Ej
		pop	ebp
		retn
sub_424994	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4249BB	proc near		; CODE XREF: sub_4249D6+Ep
					; sub_424AAE+4DEp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 6
		call	sub_424994
		leave
		retn
sub_4249BB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4249D6	proc near		; CODE XREF: sub_425215+149p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_4249BB
		leave
		retn
sub_4249D6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4249EB	proc near		; CODE XREF: sub_425215+550p
					; DATA XREF: sub_425215+11Ao

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_424A3B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short locret_424A3B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+0Ch]
		mov	[esp+18h+var_18], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	eax, [eax+24h]
		mov	[esp+18h+var_18], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[esp+18h+var_18], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0

locret_424A3B:				; CODE XREF: sub_4249EB+Aj
					; sub_4249EB+14j
		leave
		retn
sub_4249EB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_424A3D	proc near		; CODE XREF: sub_424AAE+50p
					; sub_424AAE+9Cp ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	[ebp+arg_4], 0
		jz	short loc_424A50
		cmp	[ebp+arg_8], 0
		jnz	short loc_424A57

loc_424A50:				; CODE XREF: sub_424A3D+Bj
		mov	eax, 0
		jmp	short loc_424AA8
; ---------------------------------------------------------------------------

loc_424A57:				; CODE XREF: sub_424A3D+11j
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[esp+38h+var_24], 0
		mov	[esp+38h+var_28], 0
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_406FDB
		mov	eax, 0

loc_424AA8:				; CODE XREF: sub_424A3D+18j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_424A3D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_424AAE	proc near		; CODE XREF: sub_424FA1+31p
					; DATA XREF: sub_425215+523o

var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= qword	ptr -9Ch
var_88		= qword	ptr -88h
var_7C		= dword	ptr -7Ch
var_74		= byte ptr -74h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 0A0h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, offset aXKblz ; "X-KBLZ"
		mov	ecx, 7
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_424B0B
		mov	eax, [ebp+var_10]
		mov	[esp+0A8h+var_A0], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+0A8h+var_A4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+var_A8], eax
		call	sub_424A3D
		mov	[ebp+var_C], eax
		jmp	loc_424F94
; ---------------------------------------------------------------------------

loc_424B0B:				; CODE XREF: sub_424AAE+3Aj
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, offset aXBankinfo ; "X-BANKINFO"
		mov	ecx, 0Bh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_424B57
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	[esp+0A8h+var_A0], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+0A8h+var_A4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+var_A8], eax
		call	sub_424A3D
		mov	[ebp+var_C], eax
		jmp	loc_424F94
; ---------------------------------------------------------------------------

loc_424B57:				; CODE XREF: sub_424AAE+83j
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, offset aXCardno ; "X-CARDNO"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_424BA3
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		mov	[esp+0A8h+var_A0], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+0A8h+var_A4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+var_A8], eax
		call	sub_424A3D
		mov	[ebp+var_C], eax
		jmp	loc_424F94
; ---------------------------------------------------------------------------

loc_424BA3:				; CODE XREF: sub_424AAE+CFj
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, offset aXExpires ;	"X-EXPIRES"
		mov	ecx, 0Ah
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_424BEF
		mov	eax, [ebp+var_10]
		add	eax, 10h
		mov	[esp+0A8h+var_A0], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+0A8h+var_A4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+var_A8], eax
		call	sub_424A3D
		mov	[ebp+var_C], eax
		jmp	loc_424F94
; ---------------------------------------------------------------------------

loc_424BEF:				; CODE XREF: sub_424AAE+11Bj
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, offset aXValidfrom	; "X-VALIDFROM"
		mov	ecx, 0Ch
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_424C3B
		mov	eax, [ebp+var_10]
		add	eax, 18h
		mov	[esp+0A8h+var_A0], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+0A8h+var_A4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+var_A8], eax
		call	sub_424A3D
		mov	[ebp+var_C], eax
		jmp	loc_424F94
; ---------------------------------------------------------------------------

loc_424C3B:				; CODE XREF: sub_424AAE+167j
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, offset aXCountry ;	"X-COUNTRY"
		mov	ecx, 0Ah
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_424C87
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		mov	[esp+0A8h+var_A0], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+0A8h+var_A4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+var_A8], eax
		call	sub_424A3D
		mov	[ebp+var_C], eax
		jmp	loc_424F94
; ---------------------------------------------------------------------------

loc_424C87:				; CODE XREF: sub_424AAE+1B3j
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, offset aXCurrency ; "X-CURRENCY"
		mov	ecx, 0Bh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_424CD3
		mov	eax, [ebp+var_10]
		add	eax, 28h
		mov	[esp+0A8h+var_A0], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+0A8h+var_A4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+var_A8], eax
		call	sub_424A3D
		mov	[ebp+var_C], eax
		jmp	loc_424F94
; ---------------------------------------------------------------------------

loc_424CD3:				; CODE XREF: sub_424AAE+1FFj
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, offset aXZkachipid	; "X-ZKACHIPID"
		mov	ecx, 0Ch
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_424D45
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+30h]
		movzx	eax, al
		mov	dword ptr [esp+0A8h+var_9C], eax
		mov	[esp+0A8h+var_A0], offset a0x02x ; "0x%02X"
		mov	[esp+0A8h+var_A4], 64h
		lea	eax, [ebp+var_74]
		mov	[esp+0A8h+var_A8], eax
		call	sub_429C1D
		lea	eax, [ebp+var_74]
		mov	[esp+0A8h+var_A0], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+0A8h+var_A4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+var_A8], eax
		call	sub_424A3D
		mov	[ebp+var_C], eax
		jmp	loc_424F94
; ---------------------------------------------------------------------------

loc_424D45:				; CODE XREF: sub_424AAE+24Bj
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, offset aXOsversion	; "X-OSVERSION"
		mov	ecx, 0Ch
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_424DB7
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+31h]
		movzx	eax, al
		mov	dword ptr [esp+0A8h+var_9C], eax
		mov	[esp+0A8h+var_A0], offset a0x02x ; "0x%02X"
		mov	[esp+0A8h+var_A4], 64h
		lea	eax, [ebp+var_74]
		mov	[esp+0A8h+var_A8], eax
		call	sub_429C1D
		lea	eax, [ebp+var_74]
		mov	[esp+0A8h+var_A0], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+0A8h+var_A4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+var_A8], eax
		call	sub_424A3D
		mov	[ebp+var_C], eax
		jmp	loc_424F94
; ---------------------------------------------------------------------------

loc_424DB7:				; CODE XREF: sub_424AAE+2BDj
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, offset aXBalance ;	"X-BALANCE"
		mov	ecx, 0Ah
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_424E52
		mov	eax, [ebp+var_10]
		mov	eax, [eax+34h]
		mov	[ebp+var_7C], eax
		fild	[ebp+var_7C]
		fld	ds:dbl_44CFE8
		fdivp	st(1), st
		mov	eax, [ebp+var_10]
		mov	eax, [eax+2Ch]
		mov	edx, 0
		mov	dword ptr [ebp+var_88],	eax
		mov	dword ptr [ebp+var_88+4], edx
		fild	[ebp+var_88]
		fmulp	st(1), st
		fstp	[esp+0A8h+var_9C]
		mov	[esp+0A8h+var_A0], offset a_2f ; "%.2f"
		mov	[esp+0A8h+var_A4], 64h
		lea	eax, [ebp+var_74]
		mov	[esp+0A8h+var_A8], eax
		call	sub_429C1D
		lea	eax, [ebp+var_74]
		mov	[esp+0A8h+var_A0], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+0A8h+var_A4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+var_A8], eax
		call	sub_424A3D
		mov	[ebp+var_C], eax
		jmp	loc_424F94
; ---------------------------------------------------------------------------

loc_424E52:				; CODE XREF: sub_424AAE+32Fj
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, offset aXMaxamount	; "X-MAXAMOUNT"
		mov	ecx, 0Ch
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_424EED
		mov	eax, [ebp+var_10]
		mov	eax, [eax+38h]
		mov	[ebp+var_7C], eax
		fild	[ebp+var_7C]
		fld	ds:dbl_44CFE8
		fdivp	st(1), st
		mov	eax, [ebp+var_10]
		mov	eax, [eax+2Ch]
		mov	edx, 0
		mov	dword ptr [ebp+var_88],	eax
		mov	dword ptr [ebp+var_88+4], edx
		fild	[ebp+var_88]
		fmulp	st(1), st
		fstp	[esp+0A8h+var_9C]
		mov	[esp+0A8h+var_A0], offset a_2f ; "%.2f"
		mov	[esp+0A8h+var_A4], 64h
		lea	eax, [ebp+var_74]
		mov	[esp+0A8h+var_A8], eax
		call	sub_429C1D
		lea	eax, [ebp+var_74]
		mov	[esp+0A8h+var_A0], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+0A8h+var_A4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+var_A8], eax
		call	sub_424A3D
		mov	[ebp+var_C], eax
		jmp	loc_424F94
; ---------------------------------------------------------------------------

loc_424EED:				; CODE XREF: sub_424AAE+3CAj
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, offset aXMaxamount1 ; "X-MAXAMOUNT1"
		mov	ecx, 0Dh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_424F85
		mov	eax, [ebp+var_10]
		mov	eax, [eax+3Ch]
		mov	[ebp+var_7C], eax
		fild	[ebp+var_7C]
		fld	ds:dbl_44CFE8
		fdivp	st(1), st
		mov	eax, [ebp+var_10]
		mov	eax, [eax+2Ch]
		mov	edx, 0
		mov	dword ptr [ebp+var_88],	eax
		mov	dword ptr [ebp+var_88+4], edx
		fild	[ebp+var_88]
		fmulp	st(1), st
		fstp	[esp+0A8h+var_9C]
		mov	[esp+0A8h+var_A0], offset a_2f ; "%.2f"
		mov	[esp+0A8h+var_A4], 64h
		lea	eax, [ebp+var_74]
		mov	[esp+0A8h+var_A8], eax
		call	sub_429C1D
		lea	eax, [ebp+var_74]
		mov	[esp+0A8h+var_A0], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+0A8h+var_A4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+var_A8], eax
		call	sub_424A3D
		mov	[ebp+var_C], eax
		jmp	short loc_424F94
; ---------------------------------------------------------------------------

loc_424F85:				; CODE XREF: sub_424AAE+465j
		mov	[esp+0A8h+var_A8], 58h
		call	sub_4249BB
		mov	[ebp+var_C], eax

loc_424F94:				; CODE XREF: sub_424AAE+58j
					; sub_424AAE+A4j ...
		mov	eax, [ebp+var_C]
		add	esp, 0A0h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_424AAE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_424FA1	proc near		; DATA XREF: sub_425215+519o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	short loc_424FDE
; ---------------------------------------------------------------------------

loc_424FB7:				; CODE XREF: sub_424FA1+4Fj
		mov	eax, [ebp+var_10]
		mov	eax, off_444BC0[eax*4]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_424AAE
		mov	[ebp+var_C], eax
		add	[ebp+var_10], 1

loc_424FDE:				; CODE XREF: sub_424FA1+14j
		mov	eax, [ebp+var_10]
		mov	eax, off_444BC0[eax*4]
		test	eax, eax
		jz	short loc_424FF2
		cmp	[ebp+var_C], 0
		jz	short loc_424FB7

loc_424FF2:				; CODE XREF: sub_424FA1+49j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_424FA1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_424FF7	proc near		; CODE XREF: sub_4251B4+13p
					; sub_425215+231p ...

var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_4], 0
		jnz	short loc_42501C
		mov	[esp+38h+var_38], offset byte_44CF15
		call	gcry_strdup
		jmp	locret_4251B2
; ---------------------------------------------------------------------------

loc_425014:				; CODE XREF: sub_424FF7+33j
		sub	[ebp+arg_4], 1
		add	[ebp+arg_0], 1

loc_42501C:				; CODE XREF: sub_424FF7+Aj
		cmp	[ebp+arg_4], 0
		jz	short loc_42502C
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_425014

loc_42502C:				; CODE XREF: sub_424FF7+29j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_14], 0
		jmp	loc_4250D6
; ---------------------------------------------------------------------------

loc_425044:				; CODE XREF: sub_424FF7+E3j
		cmp	[ebp+var_14], 0
		jnz	short loc_42505C
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F0h
		test	eax, eax
		jz	short loc_42508B

loc_42505C:				; CODE XREF: sub_424FF7+51j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jle	short loc_425087
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	locret_4251B2
; ---------------------------------------------------------------------------

loc_425087:				; CODE XREF: sub_424FF7+77j
		add	[ebp+var_14], 1

loc_42508B:				; CODE XREF: sub_424FF7+63j
		cmp	[ebp+var_10], 1
		jnz	short loc_4250A2
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_4250CE

loc_4250A2:				; CODE XREF: sub_424FF7+98j
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jle	short loc_4250CE
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	locret_4251B2
; ---------------------------------------------------------------------------

loc_4250CE:				; CODE XREF: sub_424FF7+A9j
					; sub_424FF7+BEj
		sub	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_4250D6:				; CODE XREF: sub_424FF7+48j
		cmp	[ebp+var_10], 0
		jnz	loc_425044
		cmp	[ebp+var_14], 0
		jnz	short loc_4250EA
		add	[ebp+var_14], 1

loc_4250EA:				; CODE XREF: sub_424FF7+EDj
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[esp+38h+var_38], eax
		call	gcry_malloc
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_425111
		mov	eax, 0
		jmp	locret_4251B2
; ---------------------------------------------------------------------------

loc_425111:				; CODE XREF: sub_424FF7+10Ej
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_14], 0
		jmp	short loc_425193
; ---------------------------------------------------------------------------

loc_425126:				; CODE XREF: sub_424FF7+1A0j
		cmp	[ebp+var_14], 0
		jnz	short loc_42513E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F0h
		test	eax, eax
		jz	short loc_425159

loc_42513E:				; CODE XREF: sub_424FF7+133j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_18], 1
		add	[ebp+var_14], 1

loc_425159:				; CODE XREF: sub_424FF7+145j
		cmp	[ebp+var_10], 1
		jnz	short loc_425170
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_42518B

loc_425170:				; CODE XREF: sub_424FF7+166j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax], dl
		add	[ebp+var_18], 1
		add	[ebp+var_14], 1

loc_42518B:				; CODE XREF: sub_424FF7+177j
		sub	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_425193:				; CODE XREF: sub_424FF7+12Dj
		cmp	[ebp+var_10], 0
		jnz	short loc_425126
		cmp	[ebp+var_14], 0
		jnz	short loc_4251A9
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	30h
		add	[ebp+var_18], 1

loc_4251A9:				; CODE XREF: sub_424FF7+1A6j
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_1C]

locret_4251B2:				; CODE XREF: sub_424FF7+18j
					; sub_424FF7+8Bj ...
		leave
		retn
sub_424FF7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4251B4	proc near		; CODE XREF: sub_425215+4B6p
					; sub_425215+4DFp ...

Str		= dword	ptr -28h
EndPtr		= dword	ptr -24h
Radix		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+EndPtr], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_424FF7
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4251E3
		mov	[esp+28h+Str], 59h
		call	sub_4249BB
		jmp	short locret_425213
; ---------------------------------------------------------------------------

loc_4251E3:				; CODE XREF: sub_4251B4+1Fj
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Radix], 0Ah ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtol
		mov	edx, [ebp+arg_8]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	gcry_free
		mov	eax, 0

locret_425213:				; CODE XREF: sub_4251B4+2Dj
		leave
		retn
sub_4251B4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425215	proc near		; CODE XREF: sub_40E65D+446p

var_48		= byte ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	dword ptr [ebp+var_14],	eax
		mov	[ebp+var_1C], 0
		mov	[esp+48h+var_3C], 0 ; int
		mov	[esp+48h+var_40], 9 ; size_t
		mov	[esp+48h+var_44], offset dword_44CFDC ;	void *
		mov	eax, dword ptr [ebp+var_14]
		mov	dword ptr [esp+48h+var_48], eax	; char
		call	sub_40CCE9
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_425741
		lea	eax, [ebp+var_20]
		mov	[esp+48h+var_34], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+var_38], eax
		mov	[esp+48h+var_3C], 0BCh
		mov	[esp+48h+var_40], 1
		mov	[esp+48h+var_44], 1
		mov	eax, dword ptr [ebp+var_14]
		mov	dword ptr [esp+48h+var_48], eax
		call	sub_40DF53
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_425744
		mov	eax, [ebp+var_20]
		cmp	eax, 17h
		jbe	short loc_4252B9
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 67h
		jnz	short loc_4252B9
		mov	eax, [ebp+var_1C]
		add	eax, 16h
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4252CD

loc_4252B9:				; CODE XREF: sub_425215+8Bj
					; sub_425215+95j
		mov	dword ptr [esp+48h+var_48], 1Bh
		call	sub_4249BB
		mov	[ebp+var_C], eax
		jmp	loc_42574E
; ---------------------------------------------------------------------------

loc_4252CD:				; CODE XREF: sub_425215+A2j
		mov	eax, [ebp+var_1C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 21h	; switch 9 cases
		cmp	eax, 8
		ja	short loc_42530E ; jumptable 004252E8 default case
		mov	eax, ds:off_44CFB8[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4252EA:				; CODE XREF: sub_425215+D3j
					; DATA XREF: .rdata:off_44CFB8o
		mov	[ebp+var_10], offset aOeffentlichRec ; jumptable 004252E8 case 33
		jmp	short loc_425322
; ---------------------------------------------------------------------------

loc_4252F3:				; CODE XREF: sub_425215+D3j
					; DATA XREF: .rdata:off_44CFB8o
		mov	[ebp+var_10], offset aPrivatOderGesc ; jumptable 004252E8 case 34
		jmp	short loc_425322
; ---------------------------------------------------------------------------

loc_4252FC:				; CODE XREF: sub_425215+D3j
					; DATA XREF: .rdata:off_44CFB8o
		mov	[ebp+var_10], offset aSparkasse	; jumptable 004252E8 case 37
		jmp	short loc_425322
; ---------------------------------------------------------------------------

loc_425305:				; CODE XREF: sub_425215+D3j
					; DATA XREF: .rdata:off_44CFB8o
		mov	[ebp+var_10], offset aGenossenschaft ; jumptable 004252E8 cases	38,41
		jmp	short loc_425322
; ---------------------------------------------------------------------------

loc_42530E:				; CODE XREF: sub_425215+CAj
					; sub_425215+D3j
					; DATA XREF: ...
		mov	dword ptr [esp+48h+var_48], 1Bh	; jumptable 004252E8 default case
		call	sub_4249BB
		mov	[ebp+var_C], eax
		jmp	loc_42574E
; ---------------------------------------------------------------------------

loc_425322:				; CODE XREF: sub_425215+DCj
					; sub_425215+E5j ...
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], offset aGeldkarte_0 ; "GELDKARTE"
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], offset sub_4249EB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_4253AA
		mov	dword ptr [esp+48h+var_48], 0Ah
		call	gcry_malloc
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_42536B
		call	sub_4249D6
		mov	[ebp+var_C], eax
		jmp	loc_42574E
; ---------------------------------------------------------------------------

loc_42536B:				; CODE XREF: sub_425215+147j
		mov	eax, [ebp+var_1C]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	edx, word ptr [edx+8]
		mov	[eax+8], dx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0Ah
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+48h+var_48], eax
		call	sub_40EDA0
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_425747

loc_4253AA:				; CODE XREF: sub_425215+129j
		mov	[esp+48h+var_44], 40h
		mov	dword ptr [esp+48h+var_48], 1
		call	gcry_calloc
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_4253E1
		call	gpg_err_code_from_syserror
		mov	[ebp+var_C], eax
		jmp	loc_42574E
; ---------------------------------------------------------------------------

loc_4253E1:				; CODE XREF: sub_425215+1BDj
		mov	eax, [ebp+var_1C]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movzx	ebx, al
		mov	eax, [ebp+var_1C]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movzx	ecx, al
		mov	eax, [ebp+var_1C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_34], ebx
		mov	[esp+48h+var_38], ecx
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], offset a02x02x02x ; "%02X-%02X%02X"
		mov	[esp+48h+var_44], 8
		mov	dword ptr [esp+48h+var_48], eax
		call	sub_429C1D
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_10]
		mov	[eax+8], edx
		mov	eax, [ebp+var_1C]
		add	eax, 4
		mov	[esp+48h+var_44], 5
		mov	dword ptr [esp+48h+var_48], eax
		call	sub_424FF7
		mov	edx, [ebp+var_18]
		mov	[edx+0Ch], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_425468
		call	gpg_err_code_from_syserror
		mov	[ebp+var_C], eax
		jmp	loc_42574E
; ---------------------------------------------------------------------------

loc_425468:				; CODE XREF: sub_425215+244j
		mov	eax, [ebp+var_1C]
		add	eax, 0Bh
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, [ebp+var_1C]
		add	eax, 0Ah
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	ecx, [ebp+var_18]
		add	ecx, 10h
		mov	[esp+48h+var_38], edx
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], offset a2002x02x ; "20%02X-%02X"
		mov	[esp+48h+var_44], 8
		mov	dword ptr [esp+48h+var_48], ecx
		call	sub_429C1D
		mov	eax, [ebp+var_1C]
		add	eax, 0Eh
		movzx	eax, byte ptr [eax]
		movzx	ecx, al
		mov	eax, [ebp+var_1C]
		add	eax, 0Dh
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, [ebp+var_1C]
		add	eax, 0Ch
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	ebx, [ebp+var_18]
		add	ebx, 18h
		mov	[esp+48h+var_34], ecx
		mov	[esp+48h+var_38], edx
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], offset a2002x02x02x ;	"20%02X-%02X-%02X"
		mov	[esp+48h+var_44], 0Bh
		mov	dword ptr [esp+48h+var_48], ebx
		call	sub_429C1D
		mov	eax, [ebp+var_1C]
		add	eax, 0Fh
		mov	[esp+48h+var_44], 2
		mov	dword ptr [esp+48h+var_48], eax
		call	sub_424FF7
		mov	edx, [ebp+var_18]
		mov	[edx+24h], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		test	eax, eax
		jnz	short loc_425527
		call	gpg_err_code_from_syserror
		mov	[ebp+var_C], eax
		jmp	loc_42574E
; ---------------------------------------------------------------------------

loc_425527:				; CODE XREF: sub_425215+303j
		mov	eax, [ebp+var_1C]
		add	eax, 13h
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_425542
		mov	eax, [ebp+var_1C]
		add	eax, 13h
		movzx	eax, byte ptr [eax]
		movzx	ecx, al
		jmp	short loc_425547
; ---------------------------------------------------------------------------

loc_425542:				; CODE XREF: sub_425215+31Dj
		mov	ecx, 20h

loc_425547:				; CODE XREF: sub_425215+32Bj
		mov	eax, [ebp+var_1C]
		add	eax, 12h
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_425562
		mov	eax, [ebp+var_1C]
		add	eax, 12h
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		jmp	short loc_425567
; ---------------------------------------------------------------------------

loc_425562:				; CODE XREF: sub_425215+33Dj
		mov	edx, 20h

loc_425567:				; CODE XREF: sub_425215+34Bj
		mov	eax, [ebp+var_1C]
		add	eax, 11h
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_425582
		mov	eax, [ebp+var_1C]
		add	eax, 11h
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		jmp	short loc_425587
; ---------------------------------------------------------------------------

loc_425582:				; CODE XREF: sub_425215+35Dj
		mov	eax, 20h

loc_425587:				; CODE XREF: sub_425215+36Bj
		mov	ebx, [ebp+var_18]
		add	ebx, 28h
		mov	[esp+48h+var_34], ecx
		mov	[esp+48h+var_38], edx
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], offset aCCC ;	"%c%c%c"
		mov	[esp+48h+var_44], 4
		mov	dword ptr [esp+48h+var_48], ebx
		call	sub_429C1D
		mov	eax, [ebp+var_1C]
		add	eax, 14h
		movzx	eax, byte ptr [eax]
		cmp	al, 1
		jz	short loc_425629
		mov	eax, [ebp+var_1C]
		add	eax, 14h
		movzx	eax, byte ptr [eax]
		cmp	al, 2
		jz	short loc_425622
		mov	eax, [ebp+var_1C]
		add	eax, 14h
		movzx	eax, byte ptr [eax]
		cmp	al, 4
		jz	short loc_42561B
		mov	eax, [ebp+var_1C]
		add	eax, 14h
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jz	short loc_425614
		mov	eax, [ebp+var_1C]
		add	eax, 14h
		movzx	eax, byte ptr [eax]
		cmp	al, 10h
		jz	short loc_42560D
		mov	eax, [ebp+var_1C]
		add	eax, 14h
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_425606
		mov	eax, 186A0h
		jmp	short loc_42560B
; ---------------------------------------------------------------------------

loc_425606:				; CODE XREF: sub_425215+3E8j
		mov	eax, 0

loc_42560B:				; CODE XREF: sub_425215+3EFj
		jmp	short loc_425612
; ---------------------------------------------------------------------------

loc_42560D:				; CODE XREF: sub_425215+3DBj
		mov	eax, 2710h

loc_425612:				; CODE XREF: sub_425215:loc_42560Bj
		jmp	short loc_425619
; ---------------------------------------------------------------------------

loc_425614:				; CODE XREF: sub_425215+3CEj
		mov	eax, 3E8h

loc_425619:				; CODE XREF: sub_425215:loc_425612j
		jmp	short loc_425620
; ---------------------------------------------------------------------------

loc_42561B:				; CODE XREF: sub_425215+3C1j
		mov	eax, 64h

loc_425620:				; CODE XREF: sub_425215:loc_425619j
		jmp	short loc_425627
; ---------------------------------------------------------------------------

loc_425622:				; CODE XREF: sub_425215+3B4j
		mov	eax, 0Ah

loc_425627:				; CODE XREF: sub_425215:loc_425620j
		jmp	short loc_42562E
; ---------------------------------------------------------------------------

loc_425629:				; CODE XREF: sub_425215+3A7j
		mov	eax, 1

loc_42562E:				; CODE XREF: sub_425215:loc_425627j
		mov	edx, [ebp+var_18]
		mov	[edx+2Ch], eax
		mov	eax, [ebp+var_1C]
		movzx	edx, byte ptr [eax+15h]
		mov	eax, [ebp+var_18]
		mov	[eax+30h], dl
		mov	eax, [ebp+var_1C]
		movzx	edx, byte ptr [eax+17h]
		mov	eax, [ebp+var_18]
		mov	[eax+31h], dl
		mov	eax, [ebp+var_1C]
		mov	dword ptr [esp+48h+var_48], eax
		call	gcry_free
		lea	eax, [ebp+var_20]
		mov	[esp+48h+var_34], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+48h+var_38], eax
		mov	[esp+48h+var_3C], 0C4h
		mov	[esp+48h+var_40], 1
		mov	[esp+48h+var_44], 1
		mov	eax, dword ptr [ebp+var_14]
		mov	dword ptr [esp+48h+var_48], eax
		call	sub_40DF53
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_42574A
		mov	eax, [ebp+var_20]
		cmp	eax, 0Bh
		ja	short loc_4256B3
		mov	dword ptr [esp+48h+var_48], 1Bh
		call	sub_4249BB
		mov	[ebp+var_C], eax
		jmp	loc_42574E
; ---------------------------------------------------------------------------

loc_4256B3:				; CODE XREF: sub_425215+488j
		mov	eax, [ebp+var_18]
		lea	edx, [eax+34h]
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], 3
		mov	dword ptr [esp+48h+var_48], eax
		call	sub_4251B4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4256FC
		mov	eax, [ebp+var_18]
		lea	edx, [eax+38h]
		mov	eax, [ebp+var_1C]
		add	eax, 3
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], 3
		mov	dword ptr [esp+48h+var_48], eax
		call	sub_4251B4
		mov	[ebp+var_C], eax

loc_4256FC:				; CODE XREF: sub_425215+4C2j
		cmp	[ebp+var_C], 0
		jnz	short loc_425725
		mov	eax, [ebp+var_18]
		lea	edx, [eax+3Ch]
		mov	eax, [ebp+var_1C]
		add	eax, 6
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], 3
		mov	dword ptr [esp+48h+var_48], eax
		call	sub_4251B4
		mov	[ebp+var_C], eax

loc_425725:				; CODE XREF: sub_425215+4EBj
		cmp	[ebp+var_C], 0
		jnz	short loc_42574D
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], offset sub_424FA1
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], offset sub_424AAE
		jmp	short loc_42574E
; ---------------------------------------------------------------------------

loc_425741:				; CODE XREF: sub_425215+41j
		nop
		jmp	short loc_42574E
; ---------------------------------------------------------------------------

loc_425744:				; CODE XREF: sub_425215+7Fj
		nop
		jmp	short loc_42574E
; ---------------------------------------------------------------------------

loc_425747:				; CODE XREF: sub_425215+18Fj
		nop
		jmp	short loc_42574E
; ---------------------------------------------------------------------------

loc_42574A:				; CODE XREF: sub_425215+47Cj
		nop
		jmp	short loc_42574E
; ---------------------------------------------------------------------------

loc_42574D:				; CODE XREF: sub_425215+514j
		nop

loc_42574E:				; CODE XREF: sub_425215+B3j
					; sub_425215+108j ...
		mov	eax, [ebp+var_1C]
		mov	dword ptr [esp+48h+var_48], eax
		call	gcry_free
		cmp	[ebp+var_C], 0
		jz	short loc_42576A
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+48h+var_48], eax
		call	sub_4249EB

loc_42576A:				; CODE XREF: sub_425215+548j
		mov	eax, [ebp+var_C]
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_425215	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425774	proc near		; CODE XREF: sub_401C11+FBp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_426BDA
		mov	[esp+18h+var_14], eax ;	char *
		mov	[esp+18h+var_18], offset aGnupg2 ; "gnupg2"
		call	sub_43B952
		leave
		retn
sub_425774	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425791	proc near		; CODE XREF: .text:004257C4p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 1
		call	sub_43C2C6
		mov	eax, 0
		leave
		retn
sub_425791	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4257AA	proc near		; CODE XREF: .text:004257E0p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 0
		call	sub_43C2C6
		leave
		retn
sub_4257AA	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_425791
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_43C238
		mov	[ebp-10h], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_4257AA
		mov	eax, [ebp-10h]
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4257EC	proc near		; CODE XREF: sub_401C11+100p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 0
		call	sub_43F31B
		call	pth_init
		call	sub_4314F7
		leave
		retn
sub_4257EC	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42580C	proc near		; CODE XREF: sub_425833+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_42582C
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_425831
; ---------------------------------------------------------------------------

loc_42582C:				; CODE XREF: sub_42580C+7j
		mov	eax, 0

loc_425831:				; CODE XREF: sub_42580C+1Ej
		pop	ebp
		retn
sub_42580C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425833	proc near		; CODE XREF: sub_42584E+Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_42580C
		leave
		retn
sub_425833	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42584E	proc near		; CODE XREF: .text:00425BEEp

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_425833
		leave
		retn
sub_42584E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_425863(int, int, char	*, va_list)
sub_425863	proc near		; DATA XREF: sub_425985+Eo

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		cmp	eax, 1Eh
		jz	short loc_4258B2
		cmp	eax, 1Eh
		jg	short loc_425886
		cmp	eax, 0Ah
		jz	short loc_4258A0
		cmp	eax, 14h
		jz	short loc_4258A9
		test	eax, eax
		jz	short loc_425897
		jmp	short loc_4258D6
; ---------------------------------------------------------------------------

loc_425886:				; CODE XREF: sub_425863+11j
		cmp	eax, 32h
		jz	short loc_4258C4
		cmp	eax, 64h
		jz	short loc_4258CD
		cmp	eax, 28h
		jz	short loc_4258BB
		jmp	short loc_4258D6
; ---------------------------------------------------------------------------

loc_425897:				; CODE XREF: sub_425863+1Fj
		mov	[ebp+arg_4], 1
		jmp	short loc_4258DE
; ---------------------------------------------------------------------------

loc_4258A0:				; CODE XREF: sub_425863+16j
		mov	[ebp+arg_4], 2
		jmp	short loc_4258DE
; ---------------------------------------------------------------------------

loc_4258A9:				; CODE XREF: sub_425863+1Bj
		mov	[ebp+arg_4], 3
		jmp	short loc_4258DE
; ---------------------------------------------------------------------------

loc_4258B2:				; CODE XREF: sub_425863+Cj
		mov	[ebp+arg_4], 4
		jmp	short loc_4258DE
; ---------------------------------------------------------------------------

loc_4258BB:				; CODE XREF: sub_425863+30j
		mov	[ebp+arg_4], 5
		jmp	short loc_4258DE
; ---------------------------------------------------------------------------

loc_4258C4:				; CODE XREF: sub_425863+26j
		mov	[ebp+arg_4], 6
		jmp	short loc_4258DE
; ---------------------------------------------------------------------------

loc_4258CD:				; CODE XREF: sub_425863+2Bj
		mov	[ebp+arg_4], 7
		jmp	short loc_4258DE
; ---------------------------------------------------------------------------

loc_4258D6:				; CODE XREF: sub_425863+21j
					; sub_425863+32j
		mov	[ebp+arg_4], 4
		nop

loc_4258DE:				; CODE XREF: sub_425863+3Bj
					; sub_425863+44j ...
		mov	eax, [ebp+arg_C]
		mov	[esp+18h+var_10], eax ;	va_list
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_14], eax ;	char *
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_43CAD6
		leave
		retn
sub_425863	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_4258F9	proc near		; DATA XREF: sub_425985+22o

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_8], 0
		jnz	short loc_425912
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_18], eax
		call	gpg_strerror
		jmp	short loc_425915
; ---------------------------------------------------------------------------

loc_425912:				; CODE XREF: sub_4258F9+Aj
		mov	eax, [ebp+arg_8]

loc_425915:				; CODE XREF: sub_4258F9+17j
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aLibgcryptProbl ; "libgcrypt problem: %s\n"
		call	sub_43CB64
sub_4258F9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425925	proc near		; DATA XREF: sub_425985+36o

var_18		= dword	ptr -18h
var_14		= byte ptr -14h
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_4514C0
		test	eax, eax
		jnz	short loc_42597E
		mov	ds:dword_4514C0, 1
		mov	eax, [ebp+arg_8]
		and	eax, 1
		test	al, al
		jz	short loc_425963
		mov	[esp+18h+var_18], offset aOutOfCoreInSec ; "out	of core	in secure memory while allo"...
		call	sub_43C238
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+18h+var_14], edx	; char
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_43CB64
; ---------------------------------------------------------------------------

loc_425963:				; CODE XREF: sub_425925+21j
		mov	[esp+18h+var_18], offset aOutOfCoreWhi_0 ; "out	of core	while allocating %lu bytes"
		call	sub_43C238
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+18h+var_14], edx	; char
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_43CB64
; ---------------------------------------------------------------------------

loc_42597E:				; CODE XREF: sub_425925+Dj
		mov	eax, 0
		leave
		retn
sub_425925	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425985	proc near		; CODE XREF: sub_401C11+1BCp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_14], 0
		mov	[esp+18h+var_18], offset sub_425863
		call	gcry_set_log_handler
		mov	[esp+18h+var_14], 0
		mov	[esp+18h+var_18], offset sub_4258F9
		call	gcry_set_fatalerror_handler
		mov	[esp+18h+var_14], 0
		mov	[esp+18h+var_18], offset sub_425925
		call	gcry_set_outofcore_handler
		leave
		retn
sub_425985	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_4259E9
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_4259F0
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4259F0

loc_4259E9:				; CODE XREF: .text:004259D0j
		mov	eax, offset aStdout ; "[stdout]"
		jmp	short loc_4259F3
; ---------------------------------------------------------------------------

loc_4259F0:				; CODE XREF: .text:004259DAj
					; .text:004259E7j
		mov	eax, [ebp+8]

loc_4259F3:				; CODE XREF: .text:004259EEj
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_425A15
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_425A1C
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_425A1C

loc_425A15:				; CODE XREF: .text:004259FCj
		mov	eax, offset aStdin ; "[stdin]"
		jmp	short loc_425A1F
; ---------------------------------------------------------------------------

loc_425A1C:				; CODE XREF: .text:00425A06j
					; .text:00425A13j
		mov	eax, [ebp+8]

loc_425A1F:				; CODE XREF: .text:00425A1Aj
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_439A14
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425A49	proc near		; CODE XREF: .text:00425A93p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_C]
		mov	[esp+18h+var_C], eax ; int
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	FILE *
		call	sub_439A44
		leave
		retn
sub_425A49	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_425A49
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	loc_425B3C
; ---------------------------------------------------------------------------

loc_425AAB:				; CODE XREF: .text:00425B40j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_425AD3
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_425AE5
; ---------------------------------------------------------------------------

loc_425AD3:				; CODE XREF: .text:00425ABDj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 37h

loc_425AE5:				; CODE XREF: .text:00425AD1j
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	putc
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_425B16
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_425B25
; ---------------------------------------------------------------------------

loc_425B16:				; CODE XREF: .text:00425B03j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 37h

loc_425B25:				; CODE XREF: .text:00425B14j
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	putc
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp+10h], 1

loc_425B3C:				; CODE XREF: .text:00425AA6j
		cmp	dword ptr [ebp+10h], 0
		jnz	loc_425AAB
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_439C0F
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	dword ptr [ebp-10h], 0
		mov	dword ptr [ebp-34h], 3
		mov	byte ptr [ebp-30h], 42h
		mov	byte ptr [ebp-2Fh], 5Ah
		mov	byte ptr [ebp-2Eh], 68h
		mov	byte ptr [ebp-2Dh], 0
		mov	dword ptr [ebp-2Ch], 3
		mov	byte ptr [ebp-28h], 1Fh
		mov	byte ptr [ebp-27h], 8Bh
		mov	byte ptr [ebp-26h], 8
		mov	byte ptr [ebp-25h], 0
		mov	dword ptr [ebp-24h], 4
		mov	byte ptr [ebp-20h], 50h
		mov	byte ptr [ebp-1Fh], 4Bh
		mov	byte ptr [ebp-1Eh], 3
		mov	byte ptr [ebp-1Dh], 4
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_436456
		test	eax, eax
		jnz	short loc_425BD0
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_425BDA

loc_425BD0:				; CODE XREF: .text:00425BC8j
		mov	eax, 0
		jmp	locret_425CC2
; ---------------------------------------------------------------------------

loc_425BDA:				; CODE XREF: .text:00425BCEj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4364E9
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jnz	short loc_425C04
		call	sub_42584E
		mov	edx, eax
		mov	eax, [ebp+0Ch]
		mov	[eax], edx
		mov	eax, 0
		jmp	locret_425CC2
; ---------------------------------------------------------------------------

loc_425C04:				; CODE XREF: .text:00425BECj
		lea	eax, [ebp-1Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_438394
		test	edx, edx
		jg	short loc_425C35
		test	edx, edx
		js	short loc_425C23
		cmp	eax, 3
		ja	short loc_425C35

loc_425C23:				; CODE XREF: .text:00425C1Cj
		mov	eax, [ebp-1Ch]
		test	eax, eax
		jnz	short loc_425C35
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0
		jmp	short loc_425CB4
; ---------------------------------------------------------------------------

loc_425C35:				; CODE XREF: .text:00425C18j
					; .text:00425C21j ...
		mov	dword ptr [esp+8], 4
		lea	eax, [ebp-18h]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_437E07
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_425C61
		mov	eax, [ebp-14h]
		mov	edx, [eax+3Ch]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx
		jmp	short loc_425CB4
; ---------------------------------------------------------------------------

loc_425C61:				; CODE XREF: .text:00425C52j
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_425CAC
; ---------------------------------------------------------------------------

loc_425C6A:				; CODE XREF: .text:00425CB2j
		mov	eax, [ebp-0Ch]
		mov	eax, [ebp+eax*8-34h]
		lea	edx, [ebp-34h]
		mov	ecx, [ebp-0Ch]
		shl	ecx, 3
		add	edx, ecx
		add	edx, 4
		mov	[esp+8], eax
		mov	[esp+4], edx
		lea	eax, [ebp-18h]
		mov	[esp], eax
		call	memcmp
		test	eax, eax
		jnz	short loc_425CA8
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0
		mov	dword ptr [ebp-10h], 1
		jmp	short loc_425CB4
; ---------------------------------------------------------------------------

loc_425CA8:				; CODE XREF: .text:00425C94j
		add	dword ptr [ebp-0Ch], 1

loc_425CAC:				; CODE XREF: .text:00425C68j
		mov	eax, [ebp-0Ch]
		cmp	eax, 2
		jbe	short loc_425C6A

loc_425CB4:				; CODE XREF: .text:00425C33j
					; .text:00425C5Fj ...
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_4360D1
		mov	eax, [ebp-10h]

locret_425CC2:				; CODE XREF: .text:00425BD5j
					; .text:00425BFFj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h

loc_425CCA:				; CODE XREF: .text:00425D28j
		mov	dword ptr [esp+4], offset asc_44D080 ; "|"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strcspn
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_425D2C
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_425D0C
		mov	eax, 1
		jmp	short locret_425D32
; ---------------------------------------------------------------------------

loc_425D0C:				; CODE XREF: .text:00425D03j
		mov	eax, [ebp-0Ch]
		add	[ebp+8], eax
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_425D20
		add	dword ptr [ebp+8], 1

loc_425D20:				; CODE XREF: .text:00425D1Aj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_425CCA
		jmp	short loc_425D2D
; ---------------------------------------------------------------------------

loc_425D2C:				; CODE XREF: .text:00425CE4j
		nop

loc_425D2D:				; CODE XREF: .text:00425D2Aj
		mov	eax, 0

locret_425D32:				; CODE XREF: .text:00425D0Aj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425D39	proc near		; CODE XREF: sub_401C11+1CDp
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_425D39	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425D43	proc near		; CODE XREF: sub_401C11:loc_40236Cp
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_425D43	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_4514C4
		test	eax, eax
		jnz	short loc_425DA1
		mov	ds:dword_4514C4, 1
		call	_getpid
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		xor	eax, edx
		mov	[ebp-14h], eax
		mov	dword ptr [esp], 0
		call	sub_442720
		mov	edx, eax
		mov	eax, [ebp-10h]
		xor	eax, edx
		mov	[ebp-18h], eax
		lea	eax, [ebp-14h]
		mov	eax, [eax]
		mov	ds:dword_4514C8, eax
		mov	eax, offset dword_4514CC
		lea	edx, [ebp-18h]
		mov	edx, [edx]
		mov	[eax], edx

loc_425DA1:				; CODE XREF: .text:00425D5Aj
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 8
		mov	eax, offset dword_4514C8
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425DB1	proc near		; CODE XREF: sub_401C11+CA5p

dwMilliseconds	= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_425DCE
		mov	[esp+18h+dwMilliseconds], 0 ; dwMilliseconds
		mov	eax, ds:Sleep
		call	eax ; Sleep
		sub	esp, 4

loc_425DCE:				; CODE XREF: sub_425DB1+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+dwMilliseconds], eax
		call	pth_sleep
		leave
		retn
sub_425DB1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_425DDB	proc near		; CODE XREF: .text:00425E48p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+arg_0], 0FFFFFFFFh
		jnz	short loc_425DEE
		mov	eax, 0FFFFFFFFh
		jmp	short locret_425E28
; ---------------------------------------------------------------------------

loc_425DEE:				; CODE XREF: sub_425DDB+Aj
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	edx, al
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_425E25
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aFailedToTransl ; "failed to translate	osfhandle %p\n"
		call	sub_43CB21

loc_425E25:				; CODE XREF: sub_425DDB+35j
		mov	eax, [ebp+var_C]

locret_425E28:				; CODE XREF: sub_425DDB+11j
		leave
		retn
sub_425DDB	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+8], 2
		jg	short loc_425E3B
		mov	eax, [ebp+8]
		jmp	short locret_425E4D
; ---------------------------------------------------------------------------

loc_425E3B:				; CODE XREF: .text:00425E34j
		mov	eax, [ebp+8]
		mov	edx, [ebp+0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_425DDB

locret_425E4D:				; CODE XREF: .text:00425E39j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 184h
		mov	eax, ds:GetCurrentProcessId
		call	eax ; GetCurrentProcessId
		mov	[ebp-1Ch], eax
		lea	eax, [ebp-158h]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	dword ptr [ebp-158h], 0Ch
		mov	dword ptr [ebp-150h], 1
		lea	eax, [ebp-14Ch]
		mov	[esp+4], eax
		mov	dword ptr [esp], 105h
		mov	eax, ds:GetTempPathA
		call	eax ; GetTempPathA
		sub	esp, 8
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-20h], 0
		jz	short loc_425EED
		cmp	dword ptr [ebp-20h], 104h
		jg	short loc_425EED
		lea	eax, [ebp-14Ch]
		mov	dword ptr [ebp-15Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-15Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 104h
		jbe	short loc_425F04

loc_425EED:				; CODE XREF: .text:00425EB3j
					; .text:00425EBCj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 2
		mov	eax, 0
		jmp	loc_4260F2
; ---------------------------------------------------------------------------

loc_425F04:				; CODE XREF: .text:00425EEBj
		lea	eax, [ebp-14Ch]
		mov	dword ptr [ebp-15Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-15Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp-14Ch]
		add	eax, edx
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	dword ptr [eax], 756E675Fh
		mov	word ptr [eax+4], 6770h
		mov	byte ptr [eax+6], 0
		add	dword ptr [ebp-10h], 6
		mov	dword ptr [esp+4], 0
		lea	eax, [ebp-14Ch]
		mov	[esp], eax
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	5Ch
		add	dword ptr [ebp-10h], 1
		mov	eax, [ebp-10h]
		mov	[ebp-24h], eax
		mov	dword ptr [ebp-0Ch], 0
		jmp	loc_4260D6
; ---------------------------------------------------------------------------

loc_425F85:				; CODE XREF: .text:004260DAj
		mov	eax, [ebp-24h]
		mov	[ebp-10h], eax
		mov	eax, ds:GetTickCount
		call	eax ; GetTickCount
		mov	edx, [ebp-1Ch]
		shl	edx, 10h
		xor	eax, edx
		mov	[ebp-14h], eax
		mov	dword ptr [ebp-18h], 0
		jmp	short loc_425FD6
; ---------------------------------------------------------------------------

loc_425FA6:				; CODE XREF: .text:00425FDAj
		mov	eax, [ebp-14h]
		shr	eax, 1Ch
		cmp	eax, 9
		ja	short loc_425FBC
		mov	eax, [ebp-14h]
		shr	eax, 1Ch
		add	eax, 30h
		jmp	short loc_425FC5
; ---------------------------------------------------------------------------

loc_425FBC:				; CODE XREF: .text:00425FAFj
		mov	eax, [ebp-14h]
		shr	eax, 1Ch
		add	eax, 37h

loc_425FC5:				; CODE XREF: .text:00425FBAj
		mov	edx, [ebp-10h]
		mov	[edx], al
		add	dword ptr [ebp-10h], 1
		shl	dword ptr [ebp-14h], 4
		add	dword ptr [ebp-18h], 1

loc_425FD6:				; CODE XREF: .text:00425FA4j
		cmp	dword ptr [ebp-18h], 7
		jle	short loc_425FA6
		mov	edx, offset a_tmp ; ".tmp"
		mov	eax, [ebp-10h]
		mov	ecx, [edx]
		mov	[eax], ecx
		movzx	edx, byte ptr [edx+4]
		mov	[eax+4], dl
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 4000100h
		mov	dword ptr [esp+10h], 1
		lea	eax, [ebp-158h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0C0000000h
		lea	eax, [ebp-14Ch]
		mov	[esp], eax
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp-28h], eax
		cmp	dword ptr [ebp-28h], 0FFFFFFFFh
		jz	loc_4260C1
		mov	eax, [ebp-28h]
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebp-2Ch], eax
		cmp	dword ptr [ebp-2Ch], 0FFFFFFFFh
		jnz	short loc_426076
		mov	eax, [ebp-28h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		jmp	short loc_4260F2
; ---------------------------------------------------------------------------

loc_426076:				; CODE XREF: .text:0042605Dj
		mov	dword ptr [esp+4], offset aWB ;	"w+b"
		mov	eax, [ebp-2Ch]
		mov	[esp], eax
		call	_fdopen
		mov	[ebp-30h], eax
		cmp	dword ptr [ebp-30h], 0
		jnz	short loc_4260BC
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp-34h], eax
		mov	eax, [ebp-2Ch]
		mov	[esp], eax
		call	_close
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp-34h]
		mov	[eax], edx
		mov	eax, 0
		jmp	short loc_4260F2
; ---------------------------------------------------------------------------

loc_4260BC:				; CODE XREF: .text:00426090j
		mov	eax, [ebp-30h]
		jmp	short loc_4260F2
; ---------------------------------------------------------------------------

loc_4260C1:				; CODE XREF: .text:0042603Bj
		mov	dword ptr [esp], 1
		mov	eax, ds:Sleep
		call	eax ; Sleep
		sub	esp, 4
		add	dword ptr [ebp-0Ch], 1

loc_4260D6:				; CODE XREF: .text:00425F80j
		cmp	dword ptr [ebp-0Ch], 9
		jle	loc_425F85
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 2
		mov	eax, 0

loc_4260F2:				; CODE XREF: .text:00425EFFj
					; .text:00426074j ...
		mov	edi, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4260FC(DWORD)
sub_4260FC	proc near		; CODE XREF: .text:0042CB1Dp

dwProcessId	= dword	ptr -18h
var_14		= byte ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_426125
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_10], eax
		mov	dword ptr [esp+18h+var_14], offset aGnupg_allow_se ; "gnupg_allow_set_foregound_window"
		mov	[esp+18h+dwProcessId], offset aSCalledWithInv ;	"%s called with	invalid	pid %lu\n"
		call	sub_43CAF7
		jmp	short locret_426169
; ---------------------------------------------------------------------------

loc_426125:				; CODE XREF: sub_4260FC+Aj
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jz	short loc_426130
		mov	eax, [ebp+arg_0]
		jmp	short loc_426135
; ---------------------------------------------------------------------------

loc_426130:				; CODE XREF: sub_4260FC+2Dj
		mov	eax, 0FFFFFFFFh

loc_426135:				; CODE XREF: sub_4260FC+32j
		mov	[esp+18h+dwProcessId], eax ; dwProcessId
		mov	eax, ds:AllowSetForegroundWindow
		call	eax ; AllowSetForegroundWindow
		sub	esp, 4
		test	eax, eax
		jnz	short locret_426169
		mov	[esp+18h+dwProcessId], 0FFFFFFFFh ; DWORD
		call	sub_439E46
		mov	edx, [ebp+arg_0]
		mov	[esp+18h+var_10], eax
		mov	dword ptr [esp+18h+var_14], edx	; char
		mov	[esp+18h+dwProcessId], offset aAllowsetforegr ;	"AllowSetForegroundWindow(%lu) failed: %"...
		call	sub_43CAF7

locret_426169:				; CODE XREF: sub_4260FC+27j
					; sub_4260FC+48j
		leave
		retn
sub_4260FC	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-20h], 0
		mov	dword ptr [ebp-10h], 0
		mov	dword ptr [ebp-14h], 0
		mov	eax, ds:GetCurrentProcessId
		call	eax ; GetCurrentProcessId
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp], 400h
		mov	eax, ds:OpenProcess
		call	eax ; OpenProcess
		sub	esp, 0Ch
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jz	loc_4262E4
		lea	eax, [ebp-20h]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 8
		mov	eax, [ebp-18h]
		mov	[esp], eax
		mov	eax, ds:OpenProcessToken
		call	eax ; OpenProcessToken
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_4262E7
		mov	eax, [ebp-20h]
		lea	edx, [ebp-24h]
		mov	[esp+10h], edx
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		mov	eax, ds:GetTokenInformation
		call	eax ; GetTokenInformation
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_42622F
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		cmp	eax, 7Ah
		jnz	loc_4262EA

loc_42622F:				; CODE XREF: .text:0042621Dj
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	gcry_malloc
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	loc_4262ED
		mov	edx, [ebp-24h]
		mov	eax, [ebp-20h]
		lea	ecx, [ebp-24h]
		mov	[esp+10h], ecx
		mov	[esp+0Ch], edx
		mov	edx, [ebp-10h]
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		mov	eax, ds:GetTokenInformation
		call	eax ; GetTokenInformation
		sub	esp, 14h
		test	eax, eax
		jz	short loc_4262F0
		mov	eax, [ebp-10h]
		mov	eax, [eax]
		mov	[esp], eax
		mov	eax, ds:IsValidSid
		call	eax ; IsValidSid
		sub	esp, 4
		test	eax, eax
		jz	short loc_4262F3
		mov	eax, [ebp-10h]
		mov	eax, [eax]
		mov	[esp], eax
		mov	eax, ds:GetLengthSid
		call	eax ; GetLengthSid
		sub	esp, 4
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	gcry_malloc
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_4262F6
		mov	eax, [ebp-10h]
		mov	eax, [eax]
		mov	[esp+8], eax
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		mov	eax, ds:CopySid
		call	eax ; CopySid
		sub	esp, 0Ch
		test	eax, eax
		jz	short loc_4262F9
		mov	dword ptr [ebp-0Ch], 1
		jmp	short loc_4262FA
; ---------------------------------------------------------------------------

loc_4262E4:				; CODE XREF: .text:004261BFj
		nop
		jmp	short loc_4262FA
; ---------------------------------------------------------------------------

loc_4262E7:				; CODE XREF: .text:004261E6j
		nop
		jmp	short loc_4262FA
; ---------------------------------------------------------------------------

loc_4262EA:				; CODE XREF: .text:00426229j
		nop
		jmp	short loc_4262FA
; ---------------------------------------------------------------------------

loc_4262ED:				; CODE XREF: .text:00426241j
		nop
		jmp	short loc_4262FA
; ---------------------------------------------------------------------------

loc_4262F0:				; CODE XREF: .text:00426276j
		nop
		jmp	short loc_4262FA
; ---------------------------------------------------------------------------

loc_4262F3:				; CODE XREF: .text:0042628Cj
		nop
		jmp	short loc_4262FA
; ---------------------------------------------------------------------------

loc_4262F6:				; CODE XREF: .text:004262B5j
		nop
		jmp	short loc_4262FA
; ---------------------------------------------------------------------------

loc_4262F9:				; CODE XREF: .text:004262D9j
		nop

loc_4262FA:				; CODE XREF: .text:004262E2j
					; .text:004262E5j ...
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	gcry_free
		mov	eax, [ebp-20h]
		test	eax, eax
		jz	short loc_42631C
		mov	eax, [ebp-20h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_42631C:				; CODE XREF: .text:0042630Aj
		cmp	dword ptr [ebp-18h], 0
		jz	short loc_426332
		mov	eax, [ebp-18h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_426332:				; CODE XREF: .text:00426320j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_42634A
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	gcry_free
		mov	dword ptr [ebp-14h], 0

loc_42634A:				; CODE XREF: .text:00426336j
		mov	eax, [ebp-14h]
		leave
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_426350(LPCSTR)
sub_426350	proc near		; CODE XREF: sub_4263DD+42p

lpLibFileName	= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+lpLibFileName], eax ; lpLibFileName
		mov	eax, ds:LoadLibraryA
		call	eax ; LoadLibraryA
		sub	esp, 4
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_426350	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42636E(HMODULE, LPCSTR)
sub_42636E	proc near		; CODE XREF: sub_4263DD+5Ep

hModule		= dword	ptr -28h
lpProcName	= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_4263AC
		cmp	[ebp+arg_4], 0
		jz	short loc_4263AC
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lpProcName], eax ; lpProcName
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hModule], eax ; hModule
		mov	eax, ds:GetProcAddress
		call	eax ; GetProcAddress
		sub	esp, 8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4263A7
		mov	eax, 0
		jmp	short locret_4263B1
; ---------------------------------------------------------------------------

loc_4263A7:				; CODE XREF: sub_42636E+30j
		mov	eax, [ebp+var_C]
		jmp	short locret_4263B1
; ---------------------------------------------------------------------------

loc_4263AC:				; CODE XREF: sub_42636E+Aj
					; sub_42636E+10j
		mov	eax, 0

locret_4263B1:				; CODE XREF: sub_42636E+37j
					; sub_42636E+3Cj
		leave
		retn
sub_42636E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4263B3(HANDLE)
sub_4263B3	proc near		; CODE XREF: sub_4263DD+77p

hObject		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_4263D6
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		jmp	short locret_4263DB
; ---------------------------------------------------------------------------

loc_4263D6:				; CODE XREF: sub_4263B3+Aj
		mov	eax, 0FFFFFFFFh

locret_4263DB:				; CODE XREF: sub_4263B3+21j
		leave
		retn
sub_4263B3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4263DD	proc near		; CODE XREF: sub_4264B7+77p
					; sub_4268B1+5Ap ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, ds:dword_451654
		test	eax, eax
		jnz	loc_426478
		mov	ds:dword_451654, 1
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		jmp	short loc_426464
; ---------------------------------------------------------------------------

loc_42640A:				; CODE XREF: sub_4263DD+99j
		mov	eax, [ebp+var_10]
		mov	eax, off_444C00[eax*4]
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax ;	LPCSTR
		call	sub_426350
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_426460
		mov	[esp+38h+var_34], offset aShgetfolderpat ; "SHGetFolderPathA"
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax ;	HMODULE
		call	sub_42636E
		mov	ds:dword_451658, eax
		mov	eax, ds:dword_451658
		test	eax, eax
		jnz	short loc_426460
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax ;	HANDLE
		call	sub_4263B3
		mov	[ebp+var_C], 0

loc_426460:				; CODE XREF: sub_4263DD+4Ej
					; sub_4263DD+6Fj
		add	[ebp+var_10], 1

loc_426464:				; CODE XREF: sub_4263DD+2Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_426478
		mov	eax, [ebp+var_10]
		mov	eax, off_444C00[eax*4]
		test	eax, eax
		jnz	short loc_42640A

loc_426478:				; CODE XREF: sub_4263DD+Dj
					; sub_4263DD+8Bj
		mov	eax, ds:dword_451658
		test	eax, eax
		jz	short loc_4264B0
		mov	edx, ds:dword_451658
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	edx ; dword_451658
		sub	esp, 14h
		jmp	short locret_4264B5
; ---------------------------------------------------------------------------

loc_4264B0:				; CODE XREF: sub_4263DD+A2j
		mov	eax, 0FFFFFFFFh

locret_4264B5:				; CODE XREF: sub_4263DD+D1j
		leave
		retn
sub_4263DD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4264B7	proc near		; CODE XREF: sub_4265F1+14p
					; sub_4265F1+B2p

lpPathName	= dword	ptr -148h
lpSecurityAttributes= dword ptr	-144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_11C		= dword	ptr -11Ch
var_114		= byte ptr -114h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:lpPathName
		test	eax, eax
		jnz	loc_4265E5
		call	sub_426784
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_4514E0
		test	eax, eax
		jz	short loc_426505
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+lpSecurityAttributes], offset	aHome ;	"\\home"
		mov	eax, [ebp+var_C]
		mov	[esp+148h+lpPathName], eax
		call	sub_43A6D2
		mov	ds:lpPathName, eax
		jmp	loc_4265E5
; ---------------------------------------------------------------------------

loc_426505:				; CODE XREF: sub_4264B7+27j
		lea	eax, [ebp+var_114]
		mov	[esp+148h+var_138], eax
		mov	[esp+148h+var_13C], 0
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+lpSecurityAttributes], 801Ah
		mov	[esp+148h+lpPathName], 0
		call	sub_4263DD
		test	eax, eax
		js	loc_4265DB
		lea	eax, [ebp+var_114]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 7
		mov	[esp+148h+lpPathName], eax
		call	gcry_xmalloc
		mov	[ebp+var_10], eax
		mov	ebx, offset aGnupg ; "\\gnupg"
		lea	eax, [ebp+var_114]
		mov	[esp+148h+lpSecurityAttributes], eax
		mov	eax, [ebp+var_10]
		mov	[esp+148h+lpPathName], eax
		call	sub_43A1E9
		mov	edx, [ebx]
		mov	[eax], edx
		movzx	edx, word ptr [ebx+4]
		mov	[eax+4], dx
		movzx	edx, byte ptr [ebx+6]
		mov	[eax+6], dl
		mov	eax, [ebp+var_10]
		mov	ds:lpPathName, eax
		mov	eax, ds:lpPathName
		mov	[esp+148h+lpSecurityAttributes], 0
		mov	[esp+148h+lpPathName], eax
		call	_access
		test	eax, eax
		jz	short loc_4265E5
		mov	eax, ds:lpPathName
		mov	[esp+148h+lpSecurityAttributes], 0 ; lpSecurityAttributes
		mov	[esp+148h+lpPathName], eax ; lpPathName
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8
		jmp	short loc_4265E5
; ---------------------------------------------------------------------------

loc_4265DB:				; CODE XREF: sub_4264B7+7Ej
		mov	ds:lpPathName, offset aCGnupg ;	"c:/gnupg"

loc_4265E5:				; CODE XREF: sub_4264B7+12j
					; sub_4264B7+49j ...
		mov	eax, ds:lpPathName
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4264B7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4265F1	proc near		; CODE XREF: sub_401C11:loc_401EACp

VarName		= dword	ptr -28h
var_24		= dword	ptr -24h
lpValueName	= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_426784
		mov	eax, ds:dword_4514E0
		test	eax, eax
		jz	short loc_42660F
		call	sub_4264B7
		jmp	locret_4266CF
; ---------------------------------------------------------------------------

loc_42660F:				; CODE XREF: sub_4265F1+12j
		mov	[esp+28h+VarName], offset aGnupghome ; "GNUPGHOME"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_426632
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4266B5

loc_426632:				; CODE XREF: sub_4265F1+31j
		mov	eax, ds:dword_45164C
		test	eax, eax
		jnz	short loc_4266AD
		cmp	[ebp+var_C], 0
		jz	short loc_42664B
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42669A

loc_42664B:				; CODE XREF: sub_4265F1+4Ej
		mov	[esp+28h+lpValueName], offset ValueName	; "HomeDir"
		mov	[esp+28h+var_24], offset aSoftwareGnuGnu ; "Software\\GNU\\GnuPG"
		mov	[esp+28h+VarName], 0 ; int
		call	sub_440232
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_42668C
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42668C
		mov	eax, [ebp+var_10]
		mov	[esp+28h+VarName], eax
		call	gcry_free
		mov	[ebp+var_10], 0

loc_42668C:				; CODE XREF: sub_4265F1+7Dj
					; sub_4265F1+87j
		cmp	[ebp+var_10], 0
		jz	short loc_42669A
		mov	eax, [ebp+var_10]
		mov	ds:dword_45164C, eax

loc_42669A:				; CODE XREF: sub_4265F1+58j
					; sub_4265F1+9Fj
		mov	eax, ds:dword_45164C
		test	eax, eax
		jnz	short loc_4266AD
		call	sub_4264B7
		mov	ds:dword_45164C, eax

loc_4266AD:				; CODE XREF: sub_4265F1+48j
					; sub_4265F1+B0j
		mov	eax, ds:dword_45164C
		mov	[ebp+var_C], eax

loc_4266B5:				; CODE XREF: sub_4265F1+3Bj
		cmp	[ebp+var_C], 0
		jz	short loc_4266C5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4266CC

loc_4266C5:				; CODE XREF: sub_4265F1+C8j
		mov	[ebp+var_C], offset aCGnupg ; "c:/gnupg"

loc_4266CC:				; CODE XREF: sub_4265F1+D2j
		mov	eax, [ebp+var_C]

locret_4266CF:				; CODE XREF: sub_4265F1+19j
		leave
		retn
sub_4265F1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4266D1	proc near		; CODE XREF: sub_426784+91p

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	[esp+38h+var_30], 0
		mov	dword ptr [esp+38h+var_34], offset aGpgconf_exe	; "\\gpgconf.exe"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_43A6D2
		mov	dword ptr [ebp+var_C], eax
		mov	dword ptr [esp+38h+var_34], 0
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	_access
		test	eax, eax
		jz	short loc_426723
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aRequiredBinary ; "required binary '%s' is not installed\n"
		call	sub_43CB21
		jmp	short loc_426772
; ---------------------------------------------------------------------------

loc_426723:				; CODE XREF: sub_4266D1+3Bj
		mov	ebx, offset aCtl ; "ctl"
		mov	eax, dword ptr [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 3
		add	eax, dword ptr [ebp+var_C]
		mov	edx, [ebx]
		mov	[eax], edx
		mov	dword ptr [esp+38h+var_34], 0
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	_access
		test	eax, eax
		jnz	short loc_426772
		mov	ds:dword_4514E0, 1

loc_426772:				; CODE XREF: sub_4266D1+50j
					; sub_4266D1+95j
		mov	eax, dword ptr [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	gcry_free
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4266D1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_426784	proc near		; CODE XREF: sub_4264B7+18p
					; sub_4265F1+6p ...

hModule		= dword	ptr -28h
lpFilename	= dword	ptr -24h
nSize		= dword	ptr -20h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, ds:dword_45152C
		test	eax, eax
		jnz	loc_426893
		mov	[esp+28h+nSize], 104h ;	nSize
		mov	[esp+28h+lpFilename], offset Filename ;	lpFilename
		mov	[esp+28h+hModule], 0 ; hModule
		mov	eax, ds:GetModuleFileNameA
		call	eax ; GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_4267E1
		mov	[esp+28h+hModule], 0 ; DWORD
		call	sub_439E46
		mov	[esp+28h+lpFilename], eax ; char
		mov	[esp+28h+hModule], offset aGetmodulefilen ; "GetModuleFileName failed: %s\n"
		call	sub_43CBBE
		mov	ds:Filename, 0

loc_4267E1:				; CODE XREF: sub_426784+38j
		mov	ds:dword_45152C, 1
		mov	[esp+28h+lpFilename], 5Ch ; Ch
		mov	[esp+28h+hModule], offset Filename ; Str
		call	strrchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_426872
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	[esp+28h+hModule], offset Filename
		call	sub_4266D1
		mov	[esp+28h+lpFilename], 5Ch ; Ch
		mov	[esp+28h+hModule], offset Filename ; Str
		call	strrchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_426872
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	edx, eax
		mov	eax, offset aBin ; "bin"
		mov	ecx, 4
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_426872
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	ds:dword_4514E4, 1

loc_426872:				; CODE XREF: sub_426784+82j
					; sub_426784+B1j ...
		cmp	[ebp+var_C], 0
		jnz	short loc_426893
		mov	[esp+28h+lpFilename], offset Filename ;	char
		mov	[esp+28h+hModule], offset aBadFilenameSRe ; "bad filename `%s' returned for this pro"...
		call	sub_43CBBE
		mov	ds:Filename, 0

loc_426893:				; CODE XREF: sub_426784+Fj
					; sub_426784+F2j
		movzx	eax, ds:Filename
		test	al, al
		jz	short loc_4268A5
		mov	eax, offset Filename
		jmp	short loc_4268AA
; ---------------------------------------------------------------------------

loc_4268A5:				; CODE XREF: sub_426784+118j
		mov	eax, offset aCGnupg_0 ;	"c:\\gnupg"

loc_4268AA:				; CODE XREF: sub_426784+11Fj
		lea	esp, [ebp-8]
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_426784	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4268B1	proc near		; CODE XREF: .text:004269ADp

var_148		= dword	ptr -148h
var_144		= dword	ptr -144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_11C		= dword	ptr -11Ch
var_114		= byte ptr -114h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:dword_451528
		test	eax, eax
		jnz	loc_426989
		call	sub_426784
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_4514E0
		test	eax, eax
		jz	short loc_4268E2
		mov	eax, [ebp+var_C]
		jmp	loc_42698E
; ---------------------------------------------------------------------------

loc_4268E2:				; CODE XREF: sub_4268B1+27j
		lea	eax, [ebp+var_114]
		mov	[esp+148h+var_138], eax
		mov	[esp+148h+var_13C], 0
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+var_144], 23h
		mov	[esp+148h+var_148], 0
		call	sub_4263DD
		test	eax, eax
		js	short loc_426979
		lea	eax, [ebp+var_114]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 5
		mov	[esp+148h+var_148], eax
		call	gcry_xmalloc
		mov	[ebp+var_10], eax
		mov	ebx, offset aGnu ; "\\GNU"
		lea	eax, [ebp+var_114]
		mov	[esp+148h+var_144], eax
		mov	eax, [ebp+var_10]
		mov	[esp+148h+var_148], eax
		call	sub_43A1E9
		mov	edx, [ebx]
		mov	[eax], edx
		movzx	edx, byte ptr [ebx+4]
		mov	[eax+4], dl
		mov	eax, [ebp+var_10]
		mov	ds:dword_451528, eax
		jmp	short loc_426989
; ---------------------------------------------------------------------------

loc_426979:				; CODE XREF: sub_4268B1+61j
		mov	eax, [ebp+var_C]
		mov	[esp+148h+var_148], eax
		call	gcry_xstrdup
		mov	ds:dword_451528, eax

loc_426989:				; CODE XREF: sub_4268B1+12j
					; sub_4268B1+C6j
		mov	eax, ds:dword_451528

loc_42698E:				; CODE XREF: sub_4268B1+2Cj
		add	esp, 140h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4268B1	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_451524
		test	eax, eax
		jnz	loc_426A2F
		call	sub_4268B1
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aEtcGnupg ;	"\\etc\\gnupg"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_451524, eax
		mov	eax, ds:dword_451524
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_43A1E9
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_426A2F:				; CODE XREF: .text:004269A7j
		mov	eax, ds:dword_451524
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_426A3B	proc near		; CODE XREF: sub_426A87+6p
					; .text:00426DB4p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_426784
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_4514E4
		test	eax, eax
		jz	short loc_426A82
		mov	eax, ds:dword_451520
		test	eax, eax
		jnz	short loc_426A7B
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], offset aBin_0	; "\\bin"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_43A6D2
		mov	ds:dword_451520, eax

loc_426A7B:				; CODE XREF: sub_426A3B+1Ej
		mov	eax, ds:dword_451520
		jmp	short locret_426A85
; ---------------------------------------------------------------------------

loc_426A82:				; CODE XREF: sub_426A3B+15j
		mov	eax, [ebp+var_C]

locret_426A85:				; CODE XREF: sub_426A3B+45j
		leave
		retn
sub_426A3B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_426A87	proc near		; CODE XREF: .text:00426EE6p
					; .text:00427018p ...
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		call	sub_426A3B
		leave
		retn
sub_426A87	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_45151C
		test	eax, eax
		jnz	loc_426B2B
		call	sub_426784
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aLibGnupg ;	"\\lib\\gnupg"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_45151C, eax
		mov	eax, ds:dword_45151C
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_43A1E9
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_426B2B:				; CODE XREF: .text:00426AA3j
		mov	eax, ds:dword_45151C
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_451518
		test	eax, eax
		jnz	loc_426BCE
		call	sub_426784
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aShareGnupg	; "\\share\\gnupg"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_451518, eax
		mov	eax, ds:dword_451518
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_43A1E9
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_426BCE:				; CODE XREF: .text:00426B46j
		mov	eax, ds:dword_451518
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_426BDA	proc near		; CODE XREF: sub_425774+6p

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_451514
		test	eax, eax
		jnz	loc_426C71
		call	sub_426784
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aShareLocale ; "\\share\\locale"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	ds:dword_451514, eax
		mov	eax, ds:dword_451514
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_43A1E9
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_426C71:				; CODE XREF: sub_426BDA+Fj
		mov	eax, ds:dword_451514
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_426BDA	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:dword_451510
		test	eax, eax
		jnz	loc_426D77
		lea	eax, [ebp-110h]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 24h
		mov	dword ptr [esp], 0
		call	sub_4263DD
		test	eax, eax
		jns	short loc_426CEB
		mov	edx, offset aCWindows ;	"C:\\WINDOWS"
		lea	eax, [ebp-110h]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	ecx, word ptr [edx+8]
		mov	[eax+8], cx
		movzx	edx, byte ptr [edx+0Ah]
		mov	[eax+0Ah], dl

loc_426CEB:				; CODE XREF: .text:00426CC5j
		mov	dword ptr [ebp-0Ch], offset aS_dirmngr ; "\\S.dirmngr"
		lea	eax, [ebp-110h]
		mov	dword ptr [ebp-11Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-11Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-11Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-11Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_451510, eax
		mov	eax, ds:dword_451510
		lea	edx, [ebp-110h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_43A1E9
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_426D77:				; CODE XREF: .text:00426C8Fj
		mov	eax, ds:dword_451510
		add	esp, 140h
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		cmp	dword ptr [ebp+8], 0Ah ; switch	11 cases
		ja	loc_42739E	; jumptable 00426DA5 default case
		mov	eax, [ebp+8]
		shl	eax, 2
		add	eax, offset off_44D30C
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_426DA7:				; CODE XREF: .text:00426DA5j
					; DATA XREF: .rdata:off_44D30Co
		mov	eax, ds:dword_4514E8 ; jumptable 00426DA5 case 1
		test	eax, eax
		jnz	loc_426E36
		call	sub_426A3B
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aGpgAgent_exe ; "\\gpg-agent.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_4514E8, eax
		mov	eax, ds:dword_4514E8
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_43A1E9
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_426E36:				; CODE XREF: .text:00426DAEj
		mov	eax, ds:dword_4514E8
		jmp	loc_4273BA
; ---------------------------------------------------------------------------

loc_426E40:				; CODE XREF: .text:00426DA5j
					; DATA XREF: .rdata:off_44D30Co
		mov	eax, ds:dword_4514EC ; jumptable 00426DA5 case 2
		test	eax, eax
		jnz	loc_426ECF
		call	sub_426A3B
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aPinentry_exe ; "\\pinentry.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_4514EC, eax
		mov	eax, ds:dword_4514EC
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_43A1E9
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_426ECF:				; CODE XREF: .text:00426E47j
		mov	eax, ds:dword_4514EC
		jmp	loc_4273BA
; ---------------------------------------------------------------------------

loc_426ED9:				; CODE XREF: .text:00426DA5j
					; DATA XREF: .rdata:off_44D30Co
		mov	eax, ds:dword_4514F0 ; jumptable 00426DA5 case 3
		test	eax, eax
		jnz	loc_426F68
		call	sub_426A87
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aScdaemon_exe ; "\\scdaemon.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_4514F0, eax
		mov	eax, ds:dword_4514F0
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_43A1E9
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_426F68:				; CODE XREF: .text:00426EE0j
		mov	eax, ds:dword_4514F0
		jmp	loc_4273BA
; ---------------------------------------------------------------------------

loc_426F72:				; CODE XREF: .text:00426DA5j
					; DATA XREF: .rdata:off_44D30Co
		mov	eax, ds:dword_4514F4 ; jumptable 00426DA5 case 4
		test	eax, eax
		jnz	loc_427001
		call	sub_426A3B
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aDirmngr_exe ; "\\dirmngr.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_4514F4, eax
		mov	eax, ds:dword_4514F4
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_43A1E9
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_427001:				; CODE XREF: .text:00426F79j
		mov	eax, ds:dword_4514F4
		jmp	loc_4273BA
; ---------------------------------------------------------------------------

loc_42700B:				; CODE XREF: .text:00426DA5j
					; DATA XREF: .rdata:off_44D30Co
		mov	eax, ds:dword_4514F8 ; jumptable 00426DA5 case 5
		test	eax, eax
		jnz	loc_42709A
		call	sub_426A87
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aGpgProtectTool ; "\\gpg-protect-tool.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_4514F8, eax
		mov	eax, ds:dword_4514F8
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_43A1E9
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_42709A:				; CODE XREF: .text:00427012j
		mov	eax, ds:dword_4514F8
		jmp	loc_4273BA
; ---------------------------------------------------------------------------

loc_4270A4:				; CODE XREF: .text:00426DA5j
					; DATA XREF: .rdata:off_44D30Co
		mov	eax, ds:dword_4514FC ; jumptable 00426DA5 case 6
		test	eax, eax
		jnz	loc_427133
		call	sub_426A87
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aGpgCheckPatter ; "\\gpg-check-pattern.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_4514FC, eax
		mov	eax, ds:dword_4514FC
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_43A1E9
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_427133:				; CODE XREF: .text:004270ABj
		mov	eax, ds:dword_4514FC
		jmp	loc_4273BA
; ---------------------------------------------------------------------------

loc_42713D:				; CODE XREF: .text:00426DA5j
					; DATA XREF: .rdata:off_44D30Co
		mov	eax, ds:dword_451500 ; jumptable 00426DA5 case 7
		test	eax, eax
		jnz	loc_4271CC
		call	sub_426A3B
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aGpgsm_exe ; "\\gpgsm.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_451500, eax
		mov	eax, ds:dword_451500
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_43A1E9
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_4271CC:				; CODE XREF: .text:00427144j
		mov	eax, ds:dword_451500
		jmp	loc_4273BA
; ---------------------------------------------------------------------------

loc_4271D6:				; CODE XREF: .text:00426DA5j
					; DATA XREF: .rdata:off_44D30Co
		mov	eax, ds:dword_451504 ; jumptable 00426DA5 case 8
		test	eax, eax
		jnz	loc_427265
		call	sub_426A3B
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aGpg2_exe ;	"\\gpg2.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_451504, eax
		mov	eax, ds:dword_451504
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_43A1E9
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_427265:				; CODE XREF: .text:004271DDj
		mov	eax, ds:dword_451504
		jmp	loc_4273BA
; ---------------------------------------------------------------------------

loc_42726F:				; CODE XREF: .text:00426DA5j
					; DATA XREF: .rdata:off_44D30Co
		mov	eax, ds:dword_451508 ; jumptable 00426DA5 case 9
		test	eax, eax
		jnz	loc_4272FE
		call	sub_426A3B
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aGpgConnectAgen ; "\\gpg-connect-agent.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_451508, eax
		mov	eax, ds:dword_451508
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_43A1E9
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_4272FE:				; CODE XREF: .text:00427276j
		mov	eax, ds:dword_451508
		jmp	loc_4273BA
; ---------------------------------------------------------------------------

loc_427308:				; CODE XREF: .text:00426DA5j
					; DATA XREF: .rdata:off_44D30Co
		mov	eax, ds:dword_45150C ; jumptable 00426DA5 case 10
		test	eax, eax
		jnz	loc_427397
		call	sub_426A3B
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aGpgconf_exe ; "\\gpgconf.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	ds:dword_45150C, eax
		mov	eax, ds:dword_45150C
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_43A1E9
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_427397:				; CODE XREF: .text:0042730Fj
		mov	eax, ds:dword_45150C
		jmp	short loc_4273BA
; ---------------------------------------------------------------------------

loc_42739E:				; CODE XREF: .text:00426D92j
					; .text:00426DA5j
					; DATA XREF: ...
		mov	dword ptr [esp+8], offset aGnupg_module_n ; jumptable 00426DA5 default case
		mov	dword ptr [esp+4], 229h
		mov	dword ptr [esp], offset	a____Gnupg22__6	; "../../gnupg2-2.0.30/common/homedir.c"
		call	sub_43CCB0
; ---------------------------------------------------------------------------

loc_4273BA:				; CODE XREF: .text:00426E3Bj
					; .text:00426ED4j ...
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4273C4	proc near		; CODE XREF: sub_4275C5+6E9p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 12h	; switch 19 cases
		ja	loc_4275C3	; jumptable 004273DD default case
		mov	eax, ds:off_44D364[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4273DF:				; CODE XREF: sub_4273C4+19j
					; DATA XREF: .rdata:off_44D364o
		mov	eax, [ebp+arg_0] ; jumptable 004273DD case 0
		mov	dword ptr [eax+24h], 0
		jmp	loc_4275C3	; jumptable 004273DD default case
; ---------------------------------------------------------------------------

loc_4273EE:				; CODE XREF: sub_4273C4+19j
					; DATA XREF: .rdata:off_44D364o
		mov	eax, [ebp+arg_0] ; jumptable 004273DD case 1
		mov	eax, [eax+10h]
		cmp	eax, 7		; switch 8 cases
		ja	short loc_427456 ; jumptable 00427400 default case
		mov	eax, ds:off_44D3B0[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_427402:				; CODE XREF: sub_4273C4+3Cj
					; DATA XREF: .rdata:off_44D3B0o
		mov	eax, [ebp+arg_0] ; jumptable 00427400 case 1
		mov	dword ptr [eax+24h], 2
		jmp	short loc_427461
; ---------------------------------------------------------------------------

loc_42740E:				; CODE XREF: sub_4273C4+3Cj
					; DATA XREF: .rdata:off_44D3B0o
		mov	eax, [ebp+arg_0] ; jumptable 00427400 case 2
		mov	dword ptr [eax+24h], 4
		jmp	short loc_427461
; ---------------------------------------------------------------------------

loc_42741A:				; CODE XREF: sub_4273C4+3Cj
					; DATA XREF: .rdata:off_44D3B0o
		mov	eax, [ebp+arg_0] ; jumptable 00427400 case 3
		mov	dword ptr [eax+24h], 8
		jmp	short loc_427461
; ---------------------------------------------------------------------------

loc_427426:				; CODE XREF: sub_4273C4+3Cj
					; DATA XREF: .rdata:off_44D3B0o
		mov	eax, [ebp+arg_0] ; jumptable 00427400 case 4
		mov	dword ptr [eax+24h], 0Ah
		jmp	short loc_427461
; ---------------------------------------------------------------------------

loc_427432:				; CODE XREF: sub_4273C4+3Cj
					; DATA XREF: .rdata:off_44D3B0o
		mov	eax, [ebp+arg_0] ; jumptable 00427400 case 5
		mov	dword ptr [eax+24h], 0Fh
		jmp	short loc_427461
; ---------------------------------------------------------------------------

loc_42743E:				; CODE XREF: sub_4273C4+3Cj
					; DATA XREF: .rdata:off_44D3B0o
		mov	eax, [ebp+arg_0] ; jumptable 00427400 case 6
		mov	dword ptr [eax+24h], 11h
		jmp	short loc_427461
; ---------------------------------------------------------------------------

loc_42744A:				; CODE XREF: sub_4273C4+3Cj
					; DATA XREF: .rdata:off_44D3B0o
		mov	eax, [ebp+arg_0] ; jumptable 00427400 case 7
		mov	dword ptr [eax+24h], 12h
		jmp	short loc_427461
; ---------------------------------------------------------------------------

loc_427456:				; CODE XREF: sub_4273C4+33j
					; sub_4273C4+3Cj
					; DATA XREF: ...
		mov	eax, [ebp+arg_0] ; jumptable 00427400 default case
		mov	dword ptr [eax+24h], 6
		nop

loc_427461:				; CODE XREF: sub_4273C4+48j
					; sub_4273C4+54j ...
		jmp	loc_4275C3	; jumptable 004273DD default case
; ---------------------------------------------------------------------------

loc_427466:				; CODE XREF: sub_4273C4+19j
					; DATA XREF: .rdata:off_44D364o
		mov	eax, [ebp+arg_0] ; jumptable 004273DD cases 2-5
		mov	eax, [eax+10h]
		cmp	eax, 7		; switch 8 cases
		ja	short loc_4274CE ; jumptable 00427478 default case
		mov	eax, ds:off_44D3D0[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_42747A:				; CODE XREF: sub_4273C4+B4j
					; DATA XREF: .rdata:off_44D3D0o
		mov	eax, [ebp+arg_0] ; jumptable 00427478 case 1
		mov	dword ptr [eax+24h], 3
		jmp	short loc_4274D9
; ---------------------------------------------------------------------------

loc_427486:				; CODE XREF: sub_4273C4+B4j
					; DATA XREF: .rdata:off_44D3D0o
		mov	eax, [ebp+arg_0] ; jumptable 00427478 case 2
		mov	dword ptr [eax+24h], 5
		jmp	short loc_4274D9
; ---------------------------------------------------------------------------

loc_427492:				; CODE XREF: sub_4273C4+B4j
					; DATA XREF: .rdata:off_44D3D0o
		mov	eax, [ebp+arg_0] ; jumptable 00427478 case 3
		mov	dword ptr [eax+24h], 9
		jmp	short loc_4274D9
; ---------------------------------------------------------------------------

loc_42749E:				; CODE XREF: sub_4273C4+B4j
					; DATA XREF: .rdata:off_44D3D0o
		mov	eax, [ebp+arg_0] ; jumptable 00427478 case 4
		mov	dword ptr [eax+24h], 0Bh
		jmp	short loc_4274D9
; ---------------------------------------------------------------------------

loc_4274AA:				; CODE XREF: sub_4273C4+B4j
					; DATA XREF: .rdata:off_44D3D0o
		mov	eax, [ebp+arg_0] ; jumptable 00427478 case 5
		mov	dword ptr [eax+24h], 10h
		jmp	short loc_4274D9
; ---------------------------------------------------------------------------

loc_4274B6:				; CODE XREF: sub_4273C4+B4j
					; DATA XREF: .rdata:off_44D3D0o
		mov	eax, [ebp+arg_0] ; jumptable 00427478 case 6
		mov	dword ptr [eax+24h], 11h
		jmp	short loc_4274D9
; ---------------------------------------------------------------------------

loc_4274C2:				; CODE XREF: sub_4273C4+B4j
					; DATA XREF: .rdata:off_44D3D0o
		mov	eax, [ebp+arg_0] ; jumptable 00427478 case 7
		mov	dword ptr [eax+24h], 12h
		jmp	short loc_4274D9
; ---------------------------------------------------------------------------

loc_4274CE:				; CODE XREF: sub_4273C4+ABj
					; sub_4273C4+B4j
					; DATA XREF: ...
		mov	eax, [ebp+arg_0] ; jumptable 00427478 default case
		mov	dword ptr [eax+24h], 7
		nop

loc_4274D9:				; CODE XREF: sub_4273C4+C0j
					; sub_4273C4+CCj ...
		jmp	loc_4275C3	; jumptable 004273DD default case
; ---------------------------------------------------------------------------

loc_4274DE:				; CODE XREF: sub_4273C4+19j
					; DATA XREF: .rdata:off_44D364o
		mov	eax, [ebp+arg_0] ; jumptable 004273DD cases 6-13
		mov	eax, [eax+10h]
		cmp	eax, 3
		jz	short loc_4274FA
		cmp	eax, 8
		jnz	short loc_427506
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0Dh
		jmp	short loc_427511
; ---------------------------------------------------------------------------

loc_4274FA:				; CODE XREF: sub_4273C4+123j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0Ch
		jmp	short loc_427511
; ---------------------------------------------------------------------------

loc_427506:				; CODE XREF: sub_4273C4+128j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0Ch
		nop

loc_427511:				; CODE XREF: sub_4273C4+134j
					; sub_4273C4+140j
		jmp	loc_4275C3	; jumptable 004273DD default case
; ---------------------------------------------------------------------------

loc_427516:				; CODE XREF: sub_4273C4+19j
					; DATA XREF: .rdata:off_44D364o
		mov	eax, [ebp+arg_0] ; jumptable 004273DD case 14
		mov	dword ptr [eax+24h], 6
		jmp	loc_4275C3	; jumptable 004273DD default case
; ---------------------------------------------------------------------------

loc_427525:				; CODE XREF: sub_4273C4+19j
					; DATA XREF: .rdata:off_44D364o
		mov	eax, [ebp+arg_0] ; jumptable 004273DD case 15
		mov	dword ptr [eax+24h], 0Eh
		jmp	loc_4275C3	; jumptable 004273DD default case
; ---------------------------------------------------------------------------

loc_427534:				; CODE XREF: sub_4273C4+19j
					; DATA XREF: .rdata:off_44D364o
		mov	eax, [ebp+arg_0] ; jumptable 004273DD case 16
		mov	dword ptr [eax+24h], 13h
		jmp	loc_4275C3	; jumptable 004273DD default case
; ---------------------------------------------------------------------------

loc_427543:				; CODE XREF: sub_4273C4+19j
					; DATA XREF: .rdata:off_44D364o
		mov	eax, [ebp+arg_0] ; jumptable 004273DD case 17
		mov	dword ptr [eax+24h], 0Eh
		jmp	short loc_4275C3 ; jumptable 004273DD default case
; ---------------------------------------------------------------------------

loc_42754F:				; CODE XREF: sub_4273C4+19j
					; DATA XREF: .rdata:off_44D364o
		mov	eax, [ebp+arg_0] ; jumptable 004273DD case 18
		mov	eax, [eax+10h]
		cmp	eax, 7		; switch 8 cases
		ja	short loc_4275B7 ; jumptable 00427561 default case
		mov	eax, ds:off_44D3F0[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_427563:				; CODE XREF: sub_4273C4+19Dj
					; DATA XREF: .rdata:off_44D3F0o
		mov	eax, [ebp+arg_0] ; jumptable 00427561 case 1
		mov	dword ptr [eax+24h], 15h
		jmp	short loc_4275C2
; ---------------------------------------------------------------------------

loc_42756F:				; CODE XREF: sub_4273C4+19Dj
					; DATA XREF: .rdata:off_44D3F0o
		mov	eax, [ebp+arg_0] ; jumptable 00427561 case 2
		mov	dword ptr [eax+24h], 16h
		jmp	short loc_4275C2
; ---------------------------------------------------------------------------

loc_42757B:				; CODE XREF: sub_4273C4+19Dj
					; DATA XREF: .rdata:off_44D3F0o
		mov	eax, [ebp+arg_0] ; jumptable 00427561 case 3
		mov	dword ptr [eax+24h], 18h
		jmp	short loc_4275C2
; ---------------------------------------------------------------------------

loc_427587:				; CODE XREF: sub_4273C4+19Dj
					; DATA XREF: .rdata:off_44D3F0o
		mov	eax, [ebp+arg_0] ; jumptable 00427561 case 4
		mov	dword ptr [eax+24h], 19h
		jmp	short loc_4275C2
; ---------------------------------------------------------------------------

loc_427593:				; CODE XREF: sub_4273C4+19Dj
					; DATA XREF: .rdata:off_44D3F0o
		mov	eax, [ebp+arg_0] ; jumptable 00427561 case 5
		mov	dword ptr [eax+24h], 1Ah
		jmp	short loc_4275C2
; ---------------------------------------------------------------------------

loc_42759F:				; CODE XREF: sub_4273C4+19Dj
					; DATA XREF: .rdata:off_44D3F0o
		mov	eax, [ebp+arg_0] ; jumptable 00427561 case 6
		mov	dword ptr [eax+24h], 1Bh
		jmp	short loc_4275C2
; ---------------------------------------------------------------------------

loc_4275AB:				; CODE XREF: sub_4273C4+19Dj
					; DATA XREF: .rdata:off_44D3F0o
		mov	eax, [ebp+arg_0] ; jumptable 00427561 case 7
		mov	dword ptr [eax+24h], 1Ch
		jmp	short loc_4275C2
; ---------------------------------------------------------------------------

loc_4275B7:				; CODE XREF: sub_4273C4+194j
					; sub_4273C4+19Dj
					; DATA XREF: ...
		mov	eax, [ebp+arg_0] ; jumptable 00427561 default case
		mov	dword ptr [eax+24h], 17h
		nop

loc_4275C2:				; CODE XREF: sub_4273C4+1A9j
					; sub_4273C4+1B5j ...
		nop

loc_4275C3:				; CODE XREF: sub_4273C4+Cj
					; sub_4273C4+25j ...
		pop	ebp		; jumptable 004273DD default case
		retn
sub_4273C4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4275C5	proc near		; CODE XREF: sub_42940F+58p

NumOfElements	= dword	ptr -68h
SizeOfElements	= dword	ptr -64h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Memory		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+Memory], eax
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_0], 0
		jnz	loc_427CC9
		jmp	loc_427D08
; ---------------------------------------------------------------------------

loc_4275E9:				; CODE XREF: sub_4275C5+70Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_427CBF
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_427CEF
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	loc_427CC2
		mov	[ebp+var_2C], 0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jle	loc_4276B5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4276B5
		mov	eax, [ebp+var_C]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_2C], eax
		add	[ebp+var_C], 1
		jmp	short loc_42767A
; ---------------------------------------------------------------------------

loc_427657:				; CODE XREF: sub_4275C5+C7j
		mov	edx, [ebp+var_2C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_2C], eax
		add	[ebp+var_C], 1

loc_42767A:				; CODE XREF: sub_4275C5+90j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42768E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_427657

loc_42768E:				; CODE XREF: sub_4275C5+BDj
		cmp	[ebp+var_2C], 0
		js	loc_427CF2
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	short loc_4276A8
		add	[ebp+var_C], 1
		jmp	short loc_4276B5
; ---------------------------------------------------------------------------

loc_4276A8:				; CODE XREF: sub_4275C5+DBj
		mov	[ebp+var_2C], 0
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_C], eax

loc_4276B5:				; CODE XREF: sub_4275C5+67j
					; sub_4275C5+75j ...
		mov	[ebp+var_18], 0
		jmp	short loc_4276FF
; ---------------------------------------------------------------------------

loc_4276BE:				; CODE XREF: sub_4275C5+142j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 20h	; switch 17 cases
		cmp	eax, 10h
		ja	short loc_42770B ; jumptable 004276D6 default case
		mov	eax, ds:off_44D410[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4276D8:				; CODE XREF: sub_4275C5+111j
					; DATA XREF: .rdata:off_44D410o
		or	[ebp+var_18], 1	; jumptable 004276D6 case 39
		jmp	short loc_4276FB
; ---------------------------------------------------------------------------

loc_4276DE:				; CODE XREF: sub_4275C5+111j
					; DATA XREF: .rdata:off_44D410o
		or	[ebp+var_18], 2	; jumptable 004276D6 case 45
		jmp	short loc_4276FB
; ---------------------------------------------------------------------------

loc_4276E4:				; CODE XREF: sub_4275C5+111j
					; DATA XREF: .rdata:off_44D410o
		or	[ebp+var_18], 4	; jumptable 004276D6 case 43
		jmp	short loc_4276FB
; ---------------------------------------------------------------------------

loc_4276EA:				; CODE XREF: sub_4275C5+111j
					; DATA XREF: .rdata:off_44D410o
		or	[ebp+var_18], 8	; jumptable 004276D6 case 32
		jmp	short loc_4276FB
; ---------------------------------------------------------------------------

loc_4276F0:				; CODE XREF: sub_4275C5+111j
					; DATA XREF: .rdata:off_44D410o
		or	[ebp+var_18], 10h ; jumptable 004276D6 case 35
		jmp	short loc_4276FB
; ---------------------------------------------------------------------------

loc_4276F6:				; CODE XREF: sub_4275C5+111j
					; DATA XREF: .rdata:off_44D410o
		or	[ebp+var_18], 20h ; jumptable 004276D6 case 48
		nop

loc_4276FB:				; CODE XREF: sub_4275C5+117j
					; sub_4275C5+11Dj ...
		add	[ebp+var_C], 1

loc_4276FF:				; CODE XREF: sub_4275C5+F7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4276BE
		jmp	short loc_42770C
; ---------------------------------------------------------------------------

loc_42770B:				; CODE XREF: sub_4275C5+108j
					; sub_4275C5+111j
					; DATA XREF: ...
		nop			; jumptable 004276D6 default case

loc_42770C:				; CODE XREF: sub_4275C5+144j
		mov	[ebp+var_30], 0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	loc_4277BF
		mov	[ebp+var_1C], 0FFFFFFFEh
		add	[ebp+var_C], 1
		cmp	[ebp+var_2C], 0
		jz	loc_427845
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jle	loc_427845
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	loc_427845
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_30], eax
		add	[ebp+var_C], 1
		jmp	short loc_42778A
; ---------------------------------------------------------------------------

loc_427767:				; CODE XREF: sub_4275C5+1D7j
		mov	edx, [ebp+var_30]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_30], eax
		add	[ebp+var_C], 1

loc_42778A:				; CODE XREF: sub_4275C5+1A0j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42779E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_427767

loc_42779E:				; CODE XREF: sub_4275C5+1CDj
		cmp	[ebp+var_30], 0
		jle	loc_427CF5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	loc_427CF8
		add	[ebp+var_C], 1
		jmp	loc_427845
; ---------------------------------------------------------------------------

loc_4277BF:				; CODE XREF: sub_4275C5+156j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42783E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_42783E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_1C], eax
		add	[ebp+var_C], 1
		jmp	short loc_42781F
; ---------------------------------------------------------------------------

loc_4277E8:				; CODE XREF: sub_4275C5+26Cj
		cmp	[ebp+var_1C], 0
		jnz	short loc_4277FC
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	loc_427CFB

loc_4277FC:				; CODE XREF: sub_4275C5+227j
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_1C], eax
		add	[ebp+var_C], 1

loc_42781F:				; CODE XREF: sub_4275C5+221j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_427833
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_4277E8

loc_427833:				; CODE XREF: sub_4275C5+262j
		cmp	[ebp+var_1C], 0
		jns	short loc_427845
		jmp	loc_427D08
; ---------------------------------------------------------------------------

loc_42783E:				; CODE XREF: sub_4275C5+202j
					; sub_4275C5+20Cj
		mov	[ebp+var_1C], 0FFFFFFFFh

loc_427845:				; CODE XREF: sub_4275C5+16Bj
					; sub_4275C5+179j ...
		mov	[ebp+var_34], 0
		mov	[ebp+var_20], 0FFFFFFFFh
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Eh
		jnz	loc_4279B8
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		setz	al
		movzx	eax, al
		mov	[ebp+var_40], eax
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	loc_427925
		mov	[ebp+var_20], 0FFFFFFFEh
		add	[ebp+var_C], 1
		cmp	[ebp+var_2C], 0
		jz	loc_4279AB
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jle	loc_4279AB
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	loc_4279AB
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_34], eax
		add	[ebp+var_C], 1
		jmp	short loc_4278F0
; ---------------------------------------------------------------------------

loc_4278CD:				; CODE XREF: sub_4275C5+33Dj
		mov	edx, [ebp+var_34]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_34], eax
		add	[ebp+var_C], 1

loc_4278F0:				; CODE XREF: sub_4275C5+306j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_427904
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_4278CD

loc_427904:				; CODE XREF: sub_4275C5+333j
		cmp	[ebp+var_34], 0
		jle	loc_427CFE
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	loc_427D01
		add	[ebp+var_C], 1
		jmp	loc_4279AB
; ---------------------------------------------------------------------------

loc_427925:				; CODE XREF: sub_4275C5+2BCj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4279A4
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4279A4
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_20], eax
		add	[ebp+var_C], 1
		jmp	short loc_427985
; ---------------------------------------------------------------------------

loc_42794E:				; CODE XREF: sub_4275C5+3D2j
		cmp	[ebp+var_20], 0
		jnz	short loc_427962
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	loc_427D04

loc_427962:				; CODE XREF: sub_4275C5+38Dj
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_20], eax
		add	[ebp+var_C], 1

loc_427985:				; CODE XREF: sub_4275C5+387j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_427999
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_42794E

loc_427999:				; CODE XREF: sub_4275C5+3C8j
		cmp	[ebp+var_20], 0
		jns	short loc_4279AB
		jmp	loc_427D08
; ---------------------------------------------------------------------------

loc_4279A4:				; CODE XREF: sub_4275C5+368j
					; sub_4275C5+372j
		mov	[ebp+var_20], 0

loc_4279AB:				; CODE XREF: sub_4275C5+2D1j
					; sub_4275C5+2DFj ...
		cmp	[ebp+var_40], 0
		jz	short loc_4279B8
		mov	[ebp+var_20], 0FFFFFFFFh

loc_4279B8:				; CODE XREF: sub_4275C5+296j
					; sub_4275C5+3EAj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 4Ch	; switch 47 cases
		cmp	eax, 2Eh
		ja	loc_427A58	; jumptable 004279D4 default case
		mov	eax, ds:off_44D454[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4279D6:				; CODE XREF: sub_4275C5+40Fj
					; DATA XREF: .rdata:off_44D454o
		mov	eax, [ebp+var_C] ; jumptable 004279D4 case 104
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 68h
		jnz	short loc_4279F0
		mov	[ebp+var_24], 1
		add	[ebp+var_C], 1
		jmp	short loc_4279F7
; ---------------------------------------------------------------------------

loc_4279F0:				; CODE XREF: sub_4275C5+41Cj
		mov	[ebp+var_24], 2

loc_4279F7:				; CODE XREF: sub_4275C5+429j
		add	[ebp+var_C], 1
		jmp	short loc_427A60
; ---------------------------------------------------------------------------

loc_4279FD:				; CODE XREF: sub_4275C5+40Fj
					; DATA XREF: .rdata:off_44D454o
		mov	eax, [ebp+var_C] ; jumptable 004279D4 case 108
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 6Ch
		jnz	short loc_427A17
		mov	[ebp+var_24], 4
		add	[ebp+var_C], 1
		jmp	short loc_427A1E
; ---------------------------------------------------------------------------

loc_427A17:				; CODE XREF: sub_4275C5+443j
		mov	[ebp+var_24], 3

loc_427A1E:				; CODE XREF: sub_4275C5+450j
		add	[ebp+var_C], 1
		jmp	short loc_427A60
; ---------------------------------------------------------------------------

loc_427A24:				; CODE XREF: sub_4275C5+40Fj
					; DATA XREF: .rdata:off_44D454o
		mov	[ebp+var_24], 5	; jumptable 004279D4 case 106
		add	[ebp+var_C], 1
		jmp	short loc_427A60
; ---------------------------------------------------------------------------

loc_427A31:				; CODE XREF: sub_4275C5+40Fj
					; DATA XREF: .rdata:off_44D454o
		mov	[ebp+var_24], 6	; jumptable 004279D4 case 122
		add	[ebp+var_C], 1
		jmp	short loc_427A60
; ---------------------------------------------------------------------------

loc_427A3E:				; CODE XREF: sub_4275C5+40Fj
					; DATA XREF: .rdata:off_44D454o
		mov	[ebp+var_24], 7	; jumptable 004279D4 case 116
		add	[ebp+var_C], 1
		jmp	short loc_427A60
; ---------------------------------------------------------------------------

loc_427A4B:				; CODE XREF: sub_4275C5+40Fj
					; DATA XREF: .rdata:off_44D454o
		mov	[ebp+var_24], 8	; jumptable 004279D4 case 76
		add	[ebp+var_C], 1
		jmp	short loc_427A60
; ---------------------------------------------------------------------------

loc_427A58:				; CODE XREF: sub_4275C5+402j
					; sub_4275C5+40Fj
					; DATA XREF: ...
		mov	[ebp+var_24], 0	; jumptable 004279D4 default case
		nop

loc_427A60:				; CODE XREF: sub_4275C5+436j
					; sub_4275C5+45Dj ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 41h	; switch 56 cases
		cmp	eax, 37h
		ja	loc_427B5F	; jumptable 00427A7C default case
		mov	eax, ds:off_44D510[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_427A7E:				; CODE XREF: sub_4275C5+4B7j
					; DATA XREF: .rdata:off_44D510o
		mov	[ebp+var_28], 1	; jumptable 00427A7C cases 100,105
		jmp	loc_427B66
; ---------------------------------------------------------------------------

loc_427A8A:				; CODE XREF: sub_4275C5+4B7j
					; DATA XREF: .rdata:off_44D510o
		mov	[ebp+var_28], 2	; jumptable 00427A7C case 111
		jmp	loc_427B66
; ---------------------------------------------------------------------------

loc_427A96:				; CODE XREF: sub_4275C5+4B7j
					; DATA XREF: .rdata:off_44D510o
		mov	[ebp+var_28], 3	; jumptable 00427A7C case 117
		jmp	loc_427B66
; ---------------------------------------------------------------------------

loc_427AA2:				; CODE XREF: sub_4275C5+4B7j
					; DATA XREF: .rdata:off_44D510o
		mov	[ebp+var_28], 4	; jumptable 00427A7C case 120
		jmp	loc_427B66
; ---------------------------------------------------------------------------

loc_427AAE:				; CODE XREF: sub_4275C5+4B7j
					; DATA XREF: .rdata:off_44D510o
		mov	[ebp+var_28], 5	; jumptable 00427A7C case 88
		jmp	loc_427B66
; ---------------------------------------------------------------------------

loc_427ABA:				; CODE XREF: sub_4275C5+4B7j
					; DATA XREF: .rdata:off_44D510o
		mov	[ebp+var_28], 6	; jumptable 00427A7C case 102
		jmp	loc_427B66
; ---------------------------------------------------------------------------

loc_427AC6:				; CODE XREF: sub_4275C5+4B7j
					; DATA XREF: .rdata:off_44D510o
		mov	[ebp+var_28], 7	; jumptable 00427A7C case 70
		jmp	loc_427B66
; ---------------------------------------------------------------------------

loc_427AD2:				; CODE XREF: sub_4275C5+4B7j
					; DATA XREF: .rdata:off_44D510o
		mov	[ebp+var_28], 8	; jumptable 00427A7C case 101
		jmp	loc_427B66
; ---------------------------------------------------------------------------

loc_427ADE:				; CODE XREF: sub_4275C5+4B7j
					; DATA XREF: .rdata:off_44D510o
		mov	[ebp+var_28], 9	; jumptable 00427A7C case 69
		jmp	short loc_427B66
; ---------------------------------------------------------------------------

loc_427AE7:				; CODE XREF: sub_4275C5+4B7j
					; DATA XREF: .rdata:off_44D510o
		mov	[ebp+var_28], 0Ah ; jumptable 00427A7C case 103
		jmp	short loc_427B66
; ---------------------------------------------------------------------------

loc_427AF0:				; CODE XREF: sub_4275C5+4B7j
					; DATA XREF: .rdata:off_44D510o
		mov	[ebp+var_28], 0Bh ; jumptable 00427A7C case 71
		jmp	short loc_427B66
; ---------------------------------------------------------------------------

loc_427AF9:				; CODE XREF: sub_4275C5+4B7j
					; DATA XREF: .rdata:off_44D510o
		mov	[ebp+var_28], 0Ch ; jumptable 00427A7C case 97
		jmp	short loc_427B66
; ---------------------------------------------------------------------------

loc_427B02:				; CODE XREF: sub_4275C5+4B7j
					; DATA XREF: .rdata:off_44D510o
		mov	[ebp+var_28], 0Dh ; jumptable 00427A7C case 65
		jmp	short loc_427B66
; ---------------------------------------------------------------------------

loc_427B0B:				; CODE XREF: sub_4275C5+4B7j
					; DATA XREF: .rdata:off_44D510o
		mov	[ebp+var_28], 0Eh ; jumptable 00427A7C case 99
		jmp	short loc_427B66
; ---------------------------------------------------------------------------

loc_427B14:				; CODE XREF: sub_4275C5+4B7j
					; DATA XREF: .rdata:off_44D510o
		mov	[ebp+var_28], 0Fh ; jumptable 00427A7C case 115
		jmp	short loc_427B66
; ---------------------------------------------------------------------------

loc_427B1D:				; CODE XREF: sub_4275C5+4B7j
					; DATA XREF: .rdata:off_44D510o
		mov	[ebp+var_28], 10h ; jumptable 00427A7C case 112
		jmp	short loc_427B66
; ---------------------------------------------------------------------------

loc_427B26:				; CODE XREF: sub_4275C5+4B7j
					; DATA XREF: .rdata:off_44D510o
		mov	[ebp+var_28], 12h ; jumptable 00427A7C case 110
		jmp	short loc_427B66
; ---------------------------------------------------------------------------

loc_427B2F:				; CODE XREF: sub_4275C5+4B7j
					; DATA XREF: .rdata:off_44D510o
		mov	[ebp+var_28], 0Eh ; jumptable 00427A7C case 67
		mov	[ebp+var_24], 3
		jmp	short loc_427B66
; ---------------------------------------------------------------------------

loc_427B3F:				; CODE XREF: sub_4275C5+4B7j
					; DATA XREF: .rdata:off_44D510o
		mov	[ebp+var_28], 0Fh ; jumptable 00427A7C case 83
		mov	[ebp+var_24], 3
		jmp	short loc_427B66
; ---------------------------------------------------------------------------

loc_427B4F:				; CODE XREF: sub_4275C5+4B7j
					; DATA XREF: .rdata:off_44D510o
		mov	[ebp+var_28], 11h ; jumptable 00427A7C case 109
		mov	[ebp+var_2C], 0FFFFFFFFh
		jmp	short loc_427B66
; ---------------------------------------------------------------------------

loc_427B5F:				; CODE XREF: sub_4275C5+4AAj
					; sub_4275C5+4B7j
					; DATA XREF: ...
		mov	[ebp+var_28], 0	; jumptable 00427A7C default case

loc_427B66:				; CODE XREF: sub_4275C5+4C0j
					; sub_4275C5+4CCj ...
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_8]
		jb	loc_427C37
		mov	eax, [ebp+arg_8]
		add	eax, 0Ah
		mov	[ebp+var_44], eax
		mov	eax, [ebp+var_44]
		cmp	eax, [ebp+arg_8]
		jbe	loc_427D07
		mov	[esp+68h+SizeOfElements], 28h ;	SizeOfElements
		mov	eax, [ebp+var_44]
		mov	[esp+68h+NumOfElements], eax ; NumOfElements
		call	calloc
		mov	[ebp+var_48], eax
		cmp	[ebp+var_48], 0
		jz	loc_427D17
		mov	[ebp+var_38], 0
		jmp	short loc_427C0E
; ---------------------------------------------------------------------------

loc_427BB0:				; CODE XREF: sub_4275C5+64Fj
		mov	edx, [ebp+var_38]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+var_48]
		mov	ecx, [ebp+var_38]
		mov	edx, ecx
		shl	edx, 2
		add	edx, ecx
		shl	edx, 3
		add	edx, [ebp+Memory]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	ecx, [edx+10h]
		mov	[eax+10h], ecx
		mov	ecx, [edx+14h]
		mov	[eax+14h], ecx
		mov	ecx, [edx+18h]
		mov	[eax+18h], ecx
		mov	ecx, [edx+1Ch]
		mov	[eax+1Ch], ecx
		mov	ecx, [edx+20h]
		mov	[eax+20h], ecx
		mov	edx, [edx+24h]
		mov	[eax+24h], edx
		add	[ebp+var_38], 1

loc_427C0E:				; CODE XREF: sub_4275C5+5E9j
		mov	eax, [ebp+var_38]
		cmp	eax, [ebp+var_14]
		jb	short loc_427BB0
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		cmp	eax, [ebp+Memory]
		jz	short loc_427C2B
		mov	eax, [ebp+Memory]
		mov	[esp+68h+NumOfElements], eax ; Memory
		call	free

loc_427C2B:				; CODE XREF: sub_4275C5+659j
		mov	eax, [ebp+var_48]
		mov	[ebp+Memory], eax
		mov	eax, [ebp+var_44]
		mov	[ebp+arg_8], eax

loc_427C37:				; CODE XREF: sub_4275C5+5A7j
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	[ebp+var_4C], eax
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 2
		mov	edx, eax
		mov	eax, [ebp+var_4C]
		mov	[eax], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_1C]
		mov	[eax+8], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_20]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_24]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_28]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_2C]
		mov	[eax+18h], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_30]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_34]
		mov	[eax+20h], edx
		mov	eax, [ebp+var_4C]
		mov	[esp+68h+NumOfElements], eax
		call	sub_4273C4
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_0], eax
		jmp	short loc_427CC3
; ---------------------------------------------------------------------------

loc_427CBF:				; CODE XREF: sub_4275C5+2Cj
		nop
		jmp	short loc_427CC3
; ---------------------------------------------------------------------------

loc_427CC2:				; CODE XREF: sub_4275C5+52j
		nop

loc_427CC3:				; CODE XREF: sub_4275C5+6F8j
					; sub_4275C5+6FBj
		add	[ebp+arg_0], 1
		jmp	short loc_427CCA
; ---------------------------------------------------------------------------

loc_427CC9:				; CODE XREF: sub_4275C5+19j
		nop

loc_427CCA:				; CODE XREF: sub_4275C5+702j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4275E9
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+Memory]
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, 0
		jmp	short locret_427D3B
; ---------------------------------------------------------------------------

loc_427CEF:				; CODE XREF: sub_4275C5+44j
		nop
		jmp	short loc_427D08
; ---------------------------------------------------------------------------

loc_427CF2:				; CODE XREF: sub_4275C5+CDj
		nop
		jmp	short loc_427D08
; ---------------------------------------------------------------------------

loc_427CF5:				; CODE XREF: sub_4275C5+1DDj
		nop
		jmp	short loc_427D08
; ---------------------------------------------------------------------------

loc_427CF8:				; CODE XREF: sub_4275C5+1EBj
		nop
		jmp	short loc_427D08
; ---------------------------------------------------------------------------

loc_427CFB:				; CODE XREF: sub_4275C5+231j
		nop
		jmp	short loc_427D08
; ---------------------------------------------------------------------------

loc_427CFE:				; CODE XREF: sub_4275C5+343j
		nop
		jmp	short loc_427D08
; ---------------------------------------------------------------------------

loc_427D01:				; CODE XREF: sub_4275C5+351j
		nop
		jmp	short loc_427D08
; ---------------------------------------------------------------------------

loc_427D04:				; CODE XREF: sub_4275C5+397j
		nop
		jmp	short loc_427D08
; ---------------------------------------------------------------------------

loc_427D07:				; CODE XREF: sub_4275C5+5BCj
		nop

loc_427D08:				; CODE XREF: sub_4275C5+1Fj
					; sub_4275C5+274j ...
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		jmp	short loc_427D18
; ---------------------------------------------------------------------------

loc_427D17:				; CODE XREF: sub_4275C5+5DCj
		nop

loc_427D18:				; CODE XREF: sub_4275C5+750j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		cmp	eax, [ebp+Memory]
		jz	short loc_427D2D
		mov	eax, [ebp+Memory]
		mov	[esp+68h+NumOfElements], eax ; Memory
		call	free

loc_427D2D:				; CODE XREF: sub_4275C5+75Bj
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh

locret_427D3B:				; CODE XREF: sub_4275C5+728j
		leave
		retn
sub_4275C5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_427D3D	proc near		; CODE XREF: sub_42940F+502p

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	[ebp+var_C], 0
		jmp	loc_428004
; ---------------------------------------------------------------------------

loc_427D50:				; CODE XREF: sub_427D3D+2CDj
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_0]
		add	eax, 8
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 1Ch ; switch 29 cases
		ja	loc_427FF9	; jumptable 00427D90 default case
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	eax, offset off_44D5F0
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_427D92:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 1
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		jmp	loc_428000
; ---------------------------------------------------------------------------

loc_427DA9:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 20
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_428000
; ---------------------------------------------------------------------------

loc_427DBE:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 2
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		jmp	loc_428000
; ---------------------------------------------------------------------------

loc_427DD5:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 21
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_428000
; ---------------------------------------------------------------------------

loc_427DEA:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 3
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		jmp	loc_428000
; ---------------------------------------------------------------------------

loc_427E01:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 4
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dx
		jmp	loc_428000
; ---------------------------------------------------------------------------

loc_427E19:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 5
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dx
		jmp	loc_428000
; ---------------------------------------------------------------------------

loc_427E31:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 22
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_428000
; ---------------------------------------------------------------------------

loc_427E46:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 6
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_428000
; ---------------------------------------------------------------------------

loc_427E5B:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 23
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_428000
; ---------------------------------------------------------------------------

loc_427E70:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 7
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_428000
; ---------------------------------------------------------------------------

loc_427E85:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 8
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_428000
; ---------------------------------------------------------------------------

loc_427E9A:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 9
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_428000
; ---------------------------------------------------------------------------

loc_427EAF:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 24
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_428000
; ---------------------------------------------------------------------------

loc_427EC4:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 10
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	loc_428000
; ---------------------------------------------------------------------------

loc_427EDF:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 11
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	loc_428000
; ---------------------------------------------------------------------------

loc_427EFA:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 25
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_428000
; ---------------------------------------------------------------------------

loc_427F0F:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 12
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		fld	qword ptr [eax]
		mov	eax, [ebp+var_10]
		fstp	qword ptr [eax]
		jmp	loc_428000
; ---------------------------------------------------------------------------

loc_427F24:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 13
		lea	edx, [eax+0Ch]
		mov	[ebp+arg_8], edx
		mov	ecx, [eax+8]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ebx, [ebp+var_10]
		mov	[ebx], eax
		mov	[ebx+4], edx
		mov	[ebx+8], ecx
		jmp	loc_428000
; ---------------------------------------------------------------------------

loc_427F45:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 14
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_428000
; ---------------------------------------------------------------------------

loc_427F5A:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 19
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_428000
; ---------------------------------------------------------------------------

loc_427F6F:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 15
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_428000
; ---------------------------------------------------------------------------

loc_427F87:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 26
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_428000
; ---------------------------------------------------------------------------

loc_427F99:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 16
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_428000
; ---------------------------------------------------------------------------

loc_427FB1:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 17
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_428000
; ---------------------------------------------------------------------------

loc_427FC3:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 27
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_428000
; ---------------------------------------------------------------------------

loc_427FD5:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 18
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_428000
; ---------------------------------------------------------------------------

loc_427FE7:				; CODE XREF: sub_427D3D+53j
					; DATA XREF: .rdata:off_44D5F0o
		mov	eax, [ebp+arg_8] ; jumptable 00427D90 case 28
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_428000
; ---------------------------------------------------------------------------

loc_427FF9:				; CODE XREF: sub_427D3D+40j
					; sub_427D3D+53j
					; DATA XREF: ...
		mov	eax, 0FFFFFFFFh	; jumptable 00427D90 default case
		jmp	short loc_428015
; ---------------------------------------------------------------------------

loc_428000:				; CODE XREF: sub_427D3D+67j
					; sub_427D3D+7Cj ...
		add	[ebp+var_C], 1

loc_428004:				; CODE XREF: sub_427D3D+Ej
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_4]
		jb	loc_427D50
		mov	eax, 0

loc_428015:				; CODE XREF: sub_427D3D+2C1j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_427D3D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42801B	proc near		; CODE XREF: sub_428099+4C6p
					; sub_428099+5BAp ...

Dst		= dword	ptr -48h
Val		= dword	ptr -44h
Size		= dword	ptr -40h
var_30		= byte ptr -30h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		jmp	short loc_42808C
; ---------------------------------------------------------------------------

loc_428023:				; CODE XREF: sub_42801B+75j
		mov	eax, [ebp+arg_C]
		mov	edx, 20h
		cmp	eax, 20h
		cmova	eax, edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Size],	eax ; Size
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Val], eax ; Val
		lea	eax, [ebp+var_30]
		mov	[esp+48h+Dst], eax ; Dst
		call	memset
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Size],	eax
		lea	eax, [ebp+var_30]
		mov	[esp+48h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Dst], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_428074
		mov	eax, [ebp+var_10]
		jmp	short locret_428097
; ---------------------------------------------------------------------------

loc_428074:				; CODE XREF: sub_42801B+52j
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		sub	eax, [ebp+var_C]
		mov	[ebp+arg_C], eax

loc_42808C:				; CODE XREF: sub_42801B+6j
		cmp	[ebp+arg_C], 0
		jg	short loc_428023
		mov	eax, 0

locret_428097:				; CODE XREF: sub_42801B+57j
		leave
		retn
sub_42801B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_428099	proc near		; CODE XREF: sub_428F2F+317p

var_D8		= dword	ptr -0D8h
var_D4		= dword	ptr -0D4h
var_D0		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A5		= byte ptr -0A5h
var_A4		= byte ptr -0A4h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0D4h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_B8], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_B4], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_B0], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_AC], eax
		mov	[ebp+var_A5], 0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 1
		jnz	loc_4281C0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		sub	eax, 4		; switch 15 cases
		cmp	eax, 0Eh
		ja	loc_428180	; jumptable 004280F6 default case
		mov	eax, ds:off_44D690[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4280F8:				; CODE XREF: sub_428099+5Dj
					; DATA XREF: .rdata:off_44D690o
		movzx	eax, word ptr [ebp+var_B8] ; jumptable 004280F6	case 4
		cwde
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_42818A
; ---------------------------------------------------------------------------

loc_42810D:				; CODE XREF: sub_428099+5Dj
					; DATA XREF: .rdata:off_44D690o
		mov	eax, [ebp+var_B8] ; jumptable 004280F6 case 6
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_42818A
; ---------------------------------------------------------------------------

loc_428120:				; CODE XREF: sub_428099+5Dj
					; DATA XREF: .rdata:off_44D690o
		mov	eax, [ebp+var_B8] ; jumptable 004280F6 case 8
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_42818A
; ---------------------------------------------------------------------------

loc_428133:				; CODE XREF: sub_428099+5Dj
					; DATA XREF: .rdata:off_44D690o
		mov	eax, [ebp+var_B8] ; jumptable 004280F6 case 10
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_42818A
; ---------------------------------------------------------------------------

loc_428147:				; CODE XREF: sub_428099+5Dj
					; DATA XREF: .rdata:off_44D690o
		mov	eax, [ebp+var_B8] ; jumptable 004280F6 case 17
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], 0
		jmp	short loc_42818A
; ---------------------------------------------------------------------------

loc_428159:				; CODE XREF: sub_428099+5Dj
					; DATA XREF: .rdata:off_44D690o
		mov	eax, [ebp+var_B8] ; jumptable 004280F6 case 15
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_42818A
; ---------------------------------------------------------------------------

loc_42816D:				; CODE XREF: sub_428099+5Dj
					; DATA XREF: .rdata:off_44D690o
		mov	eax, [ebp+var_B8] ; jumptable 004280F6 case 18
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_42818A
; ---------------------------------------------------------------------------

loc_428180:				; CODE XREF: sub_428099+50j
					; sub_428099+5Dj
					; DATA XREF: ...
		mov	eax, 0FFFFFFFFh	; jumptable 004280F6 default case
		jmp	loc_428723
; ---------------------------------------------------------------------------

loc_42818A:				; CODE XREF: sub_428099+72j
					; sub_428099+85j ...
		cmp	[ebp+var_24], 0
		jns	short loc_4281AF
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_24]
		neg	eax
		adc	edx, 0
		neg	edx
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	[ebp+var_A5], 2Dh
		jmp	loc_42826C
; ---------------------------------------------------------------------------

loc_4281AF:				; CODE XREF: sub_428099+F5j
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	loc_42826C
; ---------------------------------------------------------------------------

loc_4281C0:				; CODE XREF: sub_428099+3Ej
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		sub	eax, 5		; switch 14 cases
		cmp	eax, 0Dh
		ja	loc_428262	; jumptable 004281D9 default case
		mov	eax, ds:off_44D6CC[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4281DB:				; CODE XREF: sub_428099+140j
					; DATA XREF: .rdata:off_44D6CCo
		movzx	eax, word ptr [ebp+var_B8] ; jumptable 004281D9	case 5
		movzx	eax, ax
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_42826C
; ---------------------------------------------------------------------------

loc_4281F1:				; CODE XREF: sub_428099+140j
					; DATA XREF: .rdata:off_44D6CCo
		mov	eax, [ebp+var_B8] ; jumptable 004281D9 case 7
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_42826C
; ---------------------------------------------------------------------------

loc_428203:				; CODE XREF: sub_428099+140j
					; DATA XREF: .rdata:off_44D6CCo
		mov	eax, [ebp+var_B8] ; jumptable 004281D9 case 9
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_42826C
; ---------------------------------------------------------------------------

loc_428215:				; CODE XREF: sub_428099+140j
					; DATA XREF: .rdata:off_44D6CCo
		mov	eax, [ebp+var_B8] ; jumptable 004281D9 case 11
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_42826C
; ---------------------------------------------------------------------------

loc_428229:				; CODE XREF: sub_428099+140j
					; DATA XREF: .rdata:off_44D6CCo
		mov	eax, [ebp+var_B8] ; jumptable 004281D9 case 17
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_42826C
; ---------------------------------------------------------------------------

loc_42823B:				; CODE XREF: sub_428099+140j
					; DATA XREF: .rdata:off_44D6CCo
		mov	eax, [ebp+var_B8] ; jumptable 004281D9 case 16
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_42826C
; ---------------------------------------------------------------------------

loc_42824F:				; CODE XREF: sub_428099+140j
					; DATA XREF: .rdata:off_44D6CCo
		mov	eax, [ebp+var_B8] ; jumptable 004281D9 case 18
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_42826C
; ---------------------------------------------------------------------------

loc_428262:				; CODE XREF: sub_428099+133j
					; sub_428099+140j
					; DATA XREF: ...
		mov	eax, 0FFFFFFFFh	; jumptable 004281D9 default case
		jmp	loc_428723
; ---------------------------------------------------------------------------

loc_42826C:				; CODE XREF: sub_428099+111j
					; sub_428099+122j ...
		movzx	eax, [ebp+var_A5]
		cmp	al, 2Dh
		jz	short loc_4282A1
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 4
		test	eax, eax
		jz	short loc_42828D
		mov	[ebp+var_A5], 2Bh
		jmp	short loc_4282A1
; ---------------------------------------------------------------------------

loc_42828D:				; CODE XREF: sub_428099+1E9j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 8
		test	eax, eax
		jz	short loc_4282A1
		mov	[ebp+var_A5], 20h

loc_4282A1:				; CODE XREF: sub_428099+1DCj
					; sub_428099+1F2j ...
		movzx	eax, [ebp+var_A5]
		test	al, al
		setnz	al
		movzx	eax, al
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+var_A4]
		add	eax, 64h
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	short loc_4282DF
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_42846B

loc_4282DF:				; CODE XREF: sub_428099+236j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 1
		jz	short loc_4282F9
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jnz	loc_4283AB

loc_4282F9:				; CODE XREF: sub_428099+24Fj
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	[ebp+var_38], offset byte_44D664

loc_428307:				; CODE XREF: sub_428099+307j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 1
		test	al, al
		jz	short loc_42833E
		add	[ebp+var_2C], 1
		cmp	[ebp+var_2C], 3
		jnz	short loc_42833E
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42833E
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_38]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	[ebp+var_2C], 0

loc_42833E:				; CODE XREF: sub_428099+279j
					; sub_428099+283j ...
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[esp+0D8h+var_D0], 0Ah
		mov	[esp+0D8h+var_CC], 0
		mov	[esp+0D8h+var_D8], eax
		mov	[esp+0D8h+var_D4], edx
		call	sub_442170
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[esp+0D8h+var_D0], 0Ah
		mov	[esp+0D8h+var_CC], 0
		mov	[esp+0D8h+var_D8], eax
		mov	[esp+0D8h+var_D4], edx
		call	sub_4422B0
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	loc_428307
		jmp	loc_42846B
; ---------------------------------------------------------------------------

loc_4283AB:				; CODE XREF: sub_428099+25Aj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 2
		jnz	short loc_42840C

loc_4283B6:				; CODE XREF: sub_428099+34Ej
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_10]
		and	eax, 7
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		shrd	eax, edx, 3
		shr	edx, 3
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	short loc_4283B6
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_42846B
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	short loc_42846B
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	30h
		jmp	short loc_42846B
; ---------------------------------------------------------------------------

loc_42840C:				; CODE XREF: sub_428099+31Bj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 4
		jnz	short loc_42841E
		mov	eax, offset a0123456789abcd ; "0123456789abcdef"
		jmp	short loc_428423
; ---------------------------------------------------------------------------

loc_42841E:				; CODE XREF: sub_428099+37Cj
		mov	eax, offset a0123456789ab_0 ; "0123456789ABCDEF"

loc_428423:				; CODE XREF: sub_428099+383j
		mov	[ebp+var_34], eax

loc_428426:				; CODE XREF: sub_428099+3BFj
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_10]
		and	eax, 0Fh
		add	eax, [ebp+var_34]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		shrd	eax, edx, 4
		shr	edx, 4
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	short loc_428426
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_42846B
		add	[ebp+var_1C], 2

loc_42846B:				; CODE XREF: sub_428099+240j
					; sub_428099+30Dj ...
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 20h
		test	eax, eax
		jz	short loc_4284C4
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_4284C4
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_4284C4
		cmp	[ebp+var_3C], 0
		jz	short loc_4284C4
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_4284C4
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		sub	eax, [ebp+var_3C]
		mov	[ebp+var_18], eax
		jmp	short loc_4284EE
; ---------------------------------------------------------------------------

loc_4284C4:				; CODE XREF: sub_428099+3ECj
					; sub_428099+3F7j ...
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jle	short loc_4284E7
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_4284E7
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		sub	eax, [ebp+var_3C]
		mov	[ebp+var_18], eax
		jmp	short loc_4284EE
; ---------------------------------------------------------------------------

loc_4284E7:				; CODE XREF: sub_428099+433j
					; sub_428099+43Ej
		mov	[ebp+var_18], 0

loc_4284EE:				; CODE XREF: sub_428099+429j
					; sub_428099+44Cj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_428575
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_428575
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_428575
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		mov	edx, eax
		sub	edx, [ebp+var_3C]
		mov	eax, [ebp+var_18]
		cmp	edx, eax
		jb	short loc_428575
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		mov	edx, eax
		sub	edx, [ebp+var_3C]
		mov	eax, [ebp+var_18]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	edx, [ebp+arg_1C]
		mov	[esp+0D8h+var_C8], edx
		mov	[esp+0D8h+var_CC], eax
		mov	[esp+0D8h+var_D0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+var_D8], eax
		call	sub_42801B
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_428575
		mov	eax, [ebp+var_40]
		jmp	loc_428723
; ---------------------------------------------------------------------------

loc_428575:				; CODE XREF: sub_428099+460j
					; sub_428099+46Aj ...
		movzx	eax, [ebp+var_A5]
		test	al, al
		jz	short loc_4285BB
		mov	[esp+0D8h+var_D0], 1
		lea	eax, [ebp+var_A5]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_4285AE
		mov	eax, [ebp+var_40]
		jmp	loc_428723
; ---------------------------------------------------------------------------

loc_4285AE:				; CODE XREF: sub_428099+50Bj
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_4285BB:				; CODE XREF: sub_428099+4E5j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_42862A
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 4
		jz	short loc_4285DE
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 5
		jnz	short loc_42862A

loc_4285DE:				; CODE XREF: sub_428099+538j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 4
		jnz	short loc_4285F0
		mov	eax, offset a0x	; "0x"
		jmp	short loc_4285F5
; ---------------------------------------------------------------------------

loc_4285F0:				; CODE XREF: sub_428099+54Ej
		mov	eax, offset a0x_0 ; "0X"

loc_4285F5:				; CODE XREF: sub_428099+555j
		mov	[esp+0D8h+var_D0], 2
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_42861D
		mov	eax, [ebp+var_40]
		jmp	loc_428723
; ---------------------------------------------------------------------------

loc_42861D:				; CODE XREF: sub_428099+57Aj
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_42862A:				; CODE XREF: sub_428099+52Dj
					; sub_428099+543j
		cmp	[ebp+var_18], 0
		jz	short loc_428669
		mov	eax, [ebp+arg_1C]
		mov	[esp+0D8h+var_C8], eax
		mov	eax, [ebp+var_18]
		mov	[esp+0D8h+var_CC], eax
		mov	[esp+0D8h+var_D0], 30h
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+var_D8], eax
		call	sub_42801B
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_428669
		mov	eax, [ebp+var_40]
		jmp	loc_428723
; ---------------------------------------------------------------------------

loc_428669:				; CODE XREF: sub_428099+595j
					; sub_428099+5C6j
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[esp+0D8h+var_D0], eax
		mov	eax, [ebp+var_14]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_42869C
		mov	eax, [ebp+var_40]
		jmp	loc_428723
; ---------------------------------------------------------------------------

loc_42869C:				; CODE XREF: sub_428099+5F9j
		mov	eax, [ebp+arg_1C]
		mov	edx, [eax]
		mov	ecx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jz	short loc_42871E
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_42871E
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		sub	eax, [ebp+var_18]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_42871E
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		sub	eax, [ebp+var_18]
		sub	eax, [ebp+var_3C]
		mov	edx, [ebp+arg_1C]
		mov	[esp+0D8h+var_C8], edx
		mov	[esp+0D8h+var_CC], eax
		mov	[esp+0D8h+var_D0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+var_D8], eax
		call	sub_42801B
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_42871E
		mov	eax, [ebp+var_40]
		jmp	short loc_428723
; ---------------------------------------------------------------------------

loc_42871E:				; CODE XREF: sub_428099+626j
					; sub_428099+630j ...
		mov	eax, 0

loc_428723:				; CODE XREF: sub_428099+ECj
					; sub_428099+1CEj ...
		add	esp, 0D4h
		pop	ebx
		pop	ebp
		retn
sub_428099	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42872C	proc near		; CODE XREF: sub_428F2F+35Bp

Dest		= dword	ptr -1F8h
Format		= dword	ptr -1F4h
var_1F0		= qword	ptr -1F0h
var_1E8		= dword	ptr -1E8h
var_1D0		= dword	ptr -1D0h
var_1CC		= dword	ptr -1CCh
var_1C8		= qword	ptr -1C8h
var_1C0		= dword	ptr -1C0h
var_1BC		= dword	ptr -1BCh
var_1AF		= byte ptr -1AFh
var_1AE		= byte ptr -1AEh
var_19A		= byte ptr -19Ah
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= qword	ptr -28h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 1F0h
		mov	eax, [ebp+arg_C]
		mov	dword ptr [ebp+var_1C8], eax
		mov	eax, [ebp+arg_10]
		mov	dword ptr [ebp+var_1C8+4], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_1C0], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_1BC], eax
		mov	eax, 0
		mov	edx, 0
		mov	ecx, 0
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	[ebp+var_10], ecx
		mov	[ebp+var_1C], 0
		mov	[ebp+var_1AF], 0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 0Ch
		jz	short loc_428793
		cmp	eax, 0Dh
		jz	short loc_42879E
		jmp	short loc_4287C7
; ---------------------------------------------------------------------------

loc_428793:				; CODE XREF: sub_42872C+5Ej
		fld	[ebp+var_1C8]
		fstp	[ebp+var_28]
		jmp	short loc_4287D1
; ---------------------------------------------------------------------------

loc_42879E:				; CODE XREF: sub_42872C+63j
		fldz
		fstp	[ebp+var_28]
		mov	eax, dword ptr [ebp+var_1C8]
		mov	edx, dword ptr [ebp+var_1C8+4]
		mov	ecx, [ebp+var_1C0]
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	[ebp+var_10], ecx
		mov	[ebp+var_1C], 1
		jmp	short loc_4287D1
; ---------------------------------------------------------------------------

loc_4287C7:				; CODE XREF: sub_42872C+65j
		mov	eax, 0FFFFFFFFh
		jmp	loc_428B57
; ---------------------------------------------------------------------------

loc_4287D1:				; CODE XREF: sub_42872C+70j
					; sub_42872C+99j
		lea	eax, [ebp+var_1AE]
		add	eax, 14h
		mov	[ebp+var_2C], eax
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		sub	eax, 6		; switch 8 cases
		cmp	eax, 7
		ja	short loc_42885E ; jumptable 004287FC default case
		mov	eax, ds:off_44D704[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4287FE:				; CODE XREF: sub_42872C+D0j
					; DATA XREF: .rdata:off_44D704o
		sub	[ebp+var_2C], 1	; jumptable 004287FC case 6
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	66h
		jmp	short loc_428868
; ---------------------------------------------------------------------------

loc_42880A:				; CODE XREF: sub_42872C+D0j
					; DATA XREF: .rdata:off_44D704o
		sub	[ebp+var_2C], 1	; jumptable 004287FC case 7
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	46h
		jmp	short loc_428868
; ---------------------------------------------------------------------------

loc_428816:				; CODE XREF: sub_42872C+D0j
					; DATA XREF: .rdata:off_44D704o
		sub	[ebp+var_2C], 1	; jumptable 004287FC case 8
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	65h
		jmp	short loc_428868
; ---------------------------------------------------------------------------

loc_428822:				; CODE XREF: sub_42872C+D0j
					; DATA XREF: .rdata:off_44D704o
		sub	[ebp+var_2C], 1	; jumptable 004287FC case 9
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	45h
		jmp	short loc_428868
; ---------------------------------------------------------------------------

loc_42882E:				; CODE XREF: sub_42872C+D0j
					; DATA XREF: .rdata:off_44D704o
		sub	[ebp+var_2C], 1	; jumptable 004287FC case 10
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	67h
		jmp	short loc_428868
; ---------------------------------------------------------------------------

loc_42883A:				; CODE XREF: sub_42872C+D0j
					; DATA XREF: .rdata:off_44D704o
		sub	[ebp+var_2C], 1	; jumptable 004287FC case 11
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	47h
		jmp	short loc_428868
; ---------------------------------------------------------------------------

loc_428846:				; CODE XREF: sub_42872C+D0j
					; DATA XREF: .rdata:off_44D704o
		sub	[ebp+var_2C], 1	; jumptable 004287FC case 12
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	61h
		jmp	short loc_428868
; ---------------------------------------------------------------------------

loc_428852:				; CODE XREF: sub_42872C+D0j
					; DATA XREF: .rdata:off_44D704o
		sub	[ebp+var_2C], 1	; jumptable 004287FC case 13
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	41h
		jmp	short loc_428868
; ---------------------------------------------------------------------------

loc_42885E:				; CODE XREF: sub_42872C+C7j
		mov	eax, 0FFFFFFFFh	; jumptable 004287FC default case
		jmp	loc_428B57
; ---------------------------------------------------------------------------

loc_428868:				; CODE XREF: sub_42872C+DCj
					; sub_42872C+E8j ...
		cmp	[ebp+var_1C], 0
		jz	short loc_428878
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	4Ch

loc_428878:				; CODE XREF: sub_42872C+140j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_4288F1
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		mov	edx, 64h
		cmp	eax, 64h
		cmovg	eax, edx
		mov	[ebp+var_30], eax

loc_428897:				; CODE XREF: sub_42872C+1B9j
		sub	[ebp+var_2C], 1
		mov	ecx, [ebp+var_30]
		mov	edx, 0CCCCCCCDh
		mov	eax, ecx
		mul	edx
		shr	edx, 3
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_2C]
		mov	[eax], dl
		mov	ecx, [ebp+var_30]
		mov	[ebp+var_1CC], ecx
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_1CC]
		mul	edx
		mov	eax, edx
		shr	eax, 3
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	short loc_428897
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	2Eh

loc_4288F1:				; CODE XREF: sub_42872C+155j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_428908
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	23h

loc_428908:				; CODE XREF: sub_42872C+1D0j
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	25h
		cmp	[ebp+var_1C], 0
		jz	short loc_428944
		mov	ebx, [ebp+var_2C]
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	ecx, [ebp+var_10]
		mov	dword ptr [esp+1F8h+var_1F0], eax
		mov	dword ptr [esp+1F8h+var_1F0+4],	edx
		mov	[esp+1F8h+var_1E8], ecx
		mov	[esp+1F8h+Format], ebx ; Format
		lea	eax, [ebp+var_19A]
		mov	[esp+1F8h+Dest], eax ; Dest
		call	sprintf
		jmp	short loc_428960
; ---------------------------------------------------------------------------

loc_428944:				; CODE XREF: sub_42872C+1EAj
		mov	eax, [ebp+var_2C]
		fld	[ebp+var_28]
		fstp	[esp+1F8h+var_1F0]
		mov	[esp+1F8h+Format], eax ; Format
		lea	eax, [ebp+var_19A]
		mov	[esp+1F8h+Dest], eax ; Dest
		call	sprintf

loc_428960:				; CODE XREF: sub_42872C+216j
		lea	eax, [ebp+var_19A]
		mov	[ebp+var_2C], eax
		lea	eax, [ebp+var_19A]
		mov	[ebp+var_1D0], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1D0]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		add	eax, edx
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_2C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_4289BA
		mov	[ebp+var_1AF], 2Dh
		add	[ebp+var_2C], 1
		sub	[ebp+var_30], 1
		jmp	short loc_4289E4
; ---------------------------------------------------------------------------

loc_4289BA:				; CODE XREF: sub_42872C+27Bj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 4
		test	eax, eax
		jz	short loc_4289D0
		mov	[ebp+var_1AF], 2Bh
		jmp	short loc_4289E4
; ---------------------------------------------------------------------------

loc_4289D0:				; CODE XREF: sub_42872C+299j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 8
		test	eax, eax
		jz	short loc_4289E4
		mov	[ebp+var_1AF], 20h

loc_4289E4:				; CODE XREF: sub_42872C+28Cj
					; sub_42872C+2A2j ...
		movzx	eax, [ebp+var_1AF]
		test	al, al
		setnz	al
		movzx	eax, al
		mov	[ebp+var_38], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_428A5D
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_428A5D
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		cmp	eax, [ebp+var_30]
		jbe	short loc_428A5D
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		sub	eax, [ebp+var_30]
		mov	edx, [ebp+arg_1C]
		mov	[esp+1F8h+var_1E8], edx
		mov	dword ptr [esp+1F8h+var_1F0+4],	eax
		mov	dword ptr [esp+1F8h+var_1F0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+1F8h+Dest], eax
		call	sub_42801B
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_428A5D
		mov	eax, [ebp+var_3C]
		jmp	loc_428B57
; ---------------------------------------------------------------------------

loc_428A5D:				; CODE XREF: sub_42872C+2D5j
					; sub_42872C+2DFj ...
		movzx	eax, [ebp+var_1AF]
		test	al, al
		jz	short loc_428AA3
		mov	dword ptr [esp+1F8h+var_1F0], 1
		lea	eax, [ebp+var_1AF]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Dest], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_428A96
		mov	eax, [ebp+var_3C]
		jmp	loc_428B57
; ---------------------------------------------------------------------------

loc_428A96:				; CODE XREF: sub_42872C+360j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_428AA3:				; CODE XREF: sub_42872C+33Aj
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_2C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	dword ptr [esp+1F8h+var_1F0], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Dest], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_428AD6
		mov	eax, [ebp+var_3C]
		jmp	loc_428B57
; ---------------------------------------------------------------------------

loc_428AD6:				; CODE XREF: sub_42872C+3A0j
		mov	eax, [ebp+arg_1C]
		mov	edx, [eax]
		mov	ecx, [ebp+var_34]
		mov	eax, [ebp+var_2C]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jz	short loc_428B52
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_428B52
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		cmp	eax, [ebp+var_30]
		jbe	short loc_428B52
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		sub	eax, [ebp+var_30]
		mov	edx, [ebp+arg_1C]
		mov	[esp+1F8h+var_1E8], edx
		mov	dword ptr [esp+1F8h+var_1F0+4],	eax
		mov	dword ptr [esp+1F8h+var_1F0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+1F8h+Dest], eax
		call	sub_42801B
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_428B52
		mov	eax, [ebp+var_3C]
		jmp	short loc_428B57
; ---------------------------------------------------------------------------

loc_428B52:				; CODE XREF: sub_42872C+3CDj
					; sub_42872C+3D7j ...
		mov	eax, 0

loc_428B57:				; CODE XREF: sub_42872C+A0j
					; sub_42872C+137j ...
		add	esp, 1F0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_42872C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_428B61	proc near		; CODE XREF: sub_428F2F+39Fp

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 6
		jz	short loc_428B91
		mov	eax, 0FFFFFFFFh
		jmp	short locret_428BD1
; ---------------------------------------------------------------------------

loc_428B91:				; CODE XREF: sub_428B61+27j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_D], al
		mov	[esp+38h+var_30], 1
		lea	eax, [ebp+var_D]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_428BBF
		mov	eax, [ebp+var_C]
		jmp	short locret_428BD1
; ---------------------------------------------------------------------------

loc_428BBF:				; CODE XREF: sub_428B61+57j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, 0

locret_428BD1:				; CODE XREF: sub_428B61+2Ej
					; sub_428B61+5Cj
		leave
		retn
sub_428B61	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_428BD3	proc near		; CODE XREF: sub_428F2F+3E3p

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 0Eh
		jz	short loc_428C07
		mov	eax, 0FFFFFFFFh
		jmp	loc_428D6E
; ---------------------------------------------------------------------------

loc_428C07:				; CODE XREF: sub_428BD3+28j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_428C1A
		mov	[ebp+var_10], offset aNull_0 ; "(null)"

loc_428C1A:				; CODE XREF: sub_428BD3+3Ej
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		js	short loc_428C52
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		jmp	short loc_428C3B
; ---------------------------------------------------------------------------

loc_428C33:				; CODE XREF: sub_428BD3+7Bj
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1

loc_428C3B:				; CODE XREF: sub_428BD3+5Ej
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_C]
		jbe	short loc_428C74
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_428C33
		jmp	short loc_428C74
; ---------------------------------------------------------------------------

loc_428C52:				; CODE XREF: sub_428BD3+4Fj
		mov	eax, [ebp+var_10]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax

loc_428C74:				; CODE XREF: sub_428BD3+71j
					; sub_428BD3+7Dj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_428CD5
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_428CD5
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		jbe	short loc_428CD5
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_C]
		mov	edx, [ebp+arg_1C]
		mov	[esp+58h+var_48], edx
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_42801B
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_428CD5
		mov	eax, [ebp+var_18]
		jmp	loc_428D6E
; ---------------------------------------------------------------------------

loc_428CD5:				; CODE XREF: sub_428BD3+ACj
					; sub_428BD3+B6j ...
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_428CFC
		mov	eax, [ebp+var_18]
		jmp	short loc_428D6E
; ---------------------------------------------------------------------------

loc_428CFC:				; CODE XREF: sub_428BD3+122j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jz	short loc_428D69
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_428D69
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		jbe	short loc_428D69
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_C]
		mov	edx, [ebp+arg_1C]
		mov	[esp+58h+var_48], edx
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_42801B
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_428D69
		mov	eax, [ebp+var_18]
		jmp	short loc_428D6E
; ---------------------------------------------------------------------------

loc_428D69:				; CODE XREF: sub_428BD3+143j
					; sub_428BD3+14Dj ...
		mov	eax, 0

loc_428D6E:				; CODE XREF: sub_428BD3+2Fj
					; sub_428BD3+FDj ...
		add	esp, 54h
		pop	edi
		pop	ebp
		retn
sub_428BD3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_428D74	proc near		; CODE XREF: sub_428F2F+427p

var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_7C		= byte ptr -7Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0A4h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_98], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_94], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_90], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_8C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 13h
		jz	short loc_428DB7
		mov	eax, 0FFFFFFFFh
		jmp	loc_428E72
; ---------------------------------------------------------------------------

loc_428DB7:				; CODE XREF: sub_428D74+37j
		mov	eax, [ebp+var_98]
		mov	[ebp+var_C], eax
		lea	eax, [ebp+var_7C]
		add	eax, 64h
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_10], eax

loc_428DCF:				; CODE XREF: sub_428D74+7Ej
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		and	eax, 0Fh
		movzx	edx, ds:byte_44D72B[eax]
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		mov	eax, [ebp+var_C]
		shr	eax, 4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_428DCF
		jmp	short loc_428E00
; ---------------------------------------------------------------------------

loc_428DF6:				; CODE XREF: sub_428D74+9Bj
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	30h

loc_428E00:				; CODE XREF: sub_428D74+80j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, 7
		jbe	short loc_428DF6
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	78h
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	30h
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	[esp+0A8h+var_A0], eax
		mov	eax, [ebp+var_10]
		mov	[esp+0A8h+var_A4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+var_A8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_428E55
		mov	eax, [ebp+var_18]
		jmp	short loc_428E72
; ---------------------------------------------------------------------------

loc_428E55:				; CODE XREF: sub_428D74+DAj
		mov	eax, [ebp+arg_1C]
		mov	edx, [eax]
		mov	ecx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, 0

loc_428E72:				; CODE XREF: sub_428D74+3Ej
					; sub_428D74+DFj
		add	esp, 0A4h
		pop	ebx
		pop	ebp
		retn
sub_428D74	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_428E7B	proc near		; CODE XREF: sub_428F2F+468p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		sub	eax, 15h	; switch 8 cases
		cmp	eax, 7
		ja	short loc_428F21 ; jumptable 00428EAE default case
		mov	eax, ds:off_44D740[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_428EB0:				; CODE XREF: sub_428E7B+33j
					; DATA XREF: .rdata:off_44D740o
		mov	eax, [ebp+var_10] ; jumptable 00428EAE case 21
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], dl
		jmp	short loc_428F28
; ---------------------------------------------------------------------------

loc_428EBC:				; CODE XREF: sub_428E7B+33j
					; DATA XREF: .rdata:off_44D740o
		mov	eax, [ebp+var_10] ; jumptable 00428EAE case 22
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], dx
		jmp	short loc_428F28
; ---------------------------------------------------------------------------

loc_428EC9:				; CODE XREF: sub_428E7B+33j
					; DATA XREF: .rdata:off_44D740o
		mov	eax, [ebp+var_10] ; jumptable 00428EAE case 24
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_428F28
; ---------------------------------------------------------------------------

loc_428ED5:				; CODE XREF: sub_428E7B+33j
					; DATA XREF: .rdata:off_44D740o
		mov	ecx, [ebp+var_10] ; jumptable 00428EAE case 25
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, 0
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_428F28
; ---------------------------------------------------------------------------

loc_428EE9:				; CODE XREF: sub_428E7B+33j
					; DATA XREF: .rdata:off_44D740o
		mov	ecx, [ebp+var_10] ; jumptable 00428EAE case 26
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, 0
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_428F28
; ---------------------------------------------------------------------------

loc_428EFD:				; CODE XREF: sub_428E7B+33j
					; DATA XREF: .rdata:off_44D740o
		mov	eax, [ebp+var_10] ; jumptable 00428EAE case 27
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_428F28
; ---------------------------------------------------------------------------

loc_428F09:				; CODE XREF: sub_428E7B+33j
					; DATA XREF: .rdata:off_44D740o
		mov	eax, [ebp+var_10] ; jumptable 00428EAE case 28
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_428F28
; ---------------------------------------------------------------------------

loc_428F15:				; CODE XREF: sub_428E7B+33j
					; DATA XREF: .rdata:off_44D740o
		mov	eax, [ebp+var_10] ; jumptable 00428EAE case 23
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_428F28
; ---------------------------------------------------------------------------

loc_428F21:				; CODE XREF: sub_428E7B+2Aj
		mov	eax, 0FFFFFFFFh	; jumptable 00428EAE default case
		jmp	short locret_428F2D
; ---------------------------------------------------------------------------

loc_428F28:				; CODE XREF: sub_428E7B+3Fj
					; sub_428E7B+4Cj ...
		mov	eax, 0

locret_428F2D:				; CODE XREF: sub_428E7B+ABj
		leave
		retn
sub_428E7B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_428F2F	proc near		; CODE XREF: sub_42940F+550p

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		jmp	loc_4293AF
; ---------------------------------------------------------------------------

loc_428F54:				; CODE XREF: sub_428F2F+488j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_428F67
		add	[ebp+var_10], 1
		jmp	loc_4293AF
; ---------------------------------------------------------------------------

loc_428F67:				; CODE XREF: sub_428F2F+2Dj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jz	short loc_428FB7
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_428FA8
		mov	eax, [ebp+var_C]
		jmp	locret_42940D
; ---------------------------------------------------------------------------

loc_428FA8:				; CODE XREF: sub_428F2F+6Fj
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_428FB7:				; CODE XREF: sub_428F2F+3Ej
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_42900B
		mov	[esp+58h+var_50], 1
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_428FEF
		mov	eax, [ebp+var_C]
		jmp	locret_42940D
; ---------------------------------------------------------------------------

loc_428FEF:				; CODE XREF: sub_428F2F+B6j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		add	[ebp+var_10], 2
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_8], eax
		jmp	loc_4293AF
; ---------------------------------------------------------------------------

loc_42900B:				; CODE XREF: sub_428F2F+93j
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_8], eax
		mov	eax, [ebp+var_18]
		cmp	eax, [ebp+arg_10]
		jb	short loc_42903D
		mov	[esp+58h+var_50], 52Dh ; int
		mov	[esp+58h+var_54], offset a____Gnupg22__7 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aArgidxArgspecs ; "argidx < argspecs_len"
		call	sub_442650

loc_42903D:				; CODE XREF: sub_428F2F+F0j
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	loc_4290D1
		mov	eax, [ebp+var_14]
		mov	eax, [eax+1Ch]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	eax, 6
		jz	short loc_429088
		mov	[esp+58h+var_50], 533h ; int
		mov	[esp+58h+var_54], offset a____Gnupg22__7 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aValuetableArgW ; "valuetable[arg->width_pos-1].vt == VALT"...
		call	sub_442650

loc_429088:				; CODE XREF: sub_428F2F+13Bj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+1Ch]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_14]
		mov	[eax+8], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		test	eax, eax
		jns	short loc_4290D1
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	edx, eax
		neg	edx
		mov	eax, [ebp+var_14]
		mov	[eax+8], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	edx, eax
		or	edx, 2
		mov	eax, [ebp+var_14]
		mov	[eax+4], edx

loc_4290D1:				; CODE XREF: sub_428F2F+11Bj
					; sub_428F2F+17Fj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_429146
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	eax, 6
		jz	short loc_429114
		mov	[esp+58h+var_50], 53Dh ; int
		mov	[esp+58h+var_54], offset a____Gnupg22__7 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aValuetableArgP ; "valuetable[arg->precision_pos-1].vt	== "...
		call	sub_442650

loc_429114:				; CODE XREF: sub_428F2F+1C7j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_14]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jns	short loc_429146
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+0Ch], 0FFFFFFFFh

loc_429146:				; CODE XREF: sub_428F2F+1ABj
					; sub_428F2F+20Bj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_42916C
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		cmp	eax, 11h
		jnz	short loc_42916C
		mov	eax, [ebp+arg_18]
		mov	[esp+58h+var_58], eax ;	int
		call	strerror
		mov	[ebp+var_30], eax
		jmp	short loc_4291D6
; ---------------------------------------------------------------------------

loc_42916C:				; CODE XREF: sub_428F2F+220j
					; sub_428F2F+22Bj
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+24h]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	ecx, eax
		jz	short loc_4291A9
		mov	[esp+58h+var_50], 547h ; int
		mov	[esp+58h+var_54], offset a____Gnupg22__7 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aArgVtValuetabl ; "arg->vt == valuetable[arg->arg_pos-1].v"...
		call	sub_442650

loc_4291A9:				; CODE XREF: sub_428F2F+25Cj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	edx, [eax+8]
		mov	[ebp+var_30], edx
		mov	edx, [eax+0Ch]
		mov	[ebp+var_2C], edx
		mov	edx, [eax+10h]
		mov	[ebp+var_28], edx
		mov	eax, [eax+14h]
		mov	[ebp+var_24], eax

loc_4291D6:				; CODE XREF: sub_428F2F+23Bj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		cmp	eax, 12h	; switch 19 cases
		ja	loc_4293A0	; jumptable 004291EC default case
		mov	eax, ds:off_44D838[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4291EE:				; CODE XREF: sub_428F2F+2BDj
					; DATA XREF: .rdata:off_44D838o
		mov	[esp+58h+var_50], 54Dh ; jumptable 004291EC case 0
		mov	[esp+58h+var_54], offset a____Gnupg22__7 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aBug ;	"!\"bug\""
		call	sub_442650
		jmp	loc_4293A0	; jumptable 004291EC default case
; ---------------------------------------------------------------------------

loc_42920F:				; CODE XREF: sub_428F2F+2BDj
					; DATA XREF: .rdata:off_44D838o
		mov	eax, [ebp+arg_1C] ; jumptable 004291EC cases 1-5
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_428099
		mov	[ebp+var_C], eax
		jmp	loc_4293A0	; jumptable 004291EC default case
; ---------------------------------------------------------------------------

loc_429253:				; CODE XREF: sub_428F2F+2BDj
					; DATA XREF: .rdata:off_44D838o
		mov	eax, [ebp+arg_1C] ; jumptable 004291EC cases 6-13
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_42872C
		mov	[ebp+var_C], eax
		jmp	loc_4293A0	; jumptable 004291EC default case
; ---------------------------------------------------------------------------

loc_429297:				; CODE XREF: sub_428F2F+2BDj
					; DATA XREF: .rdata:off_44D838o
		mov	eax, [ebp+arg_1C] ; jumptable 004291EC case 14
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_428B61
		mov	[ebp+var_C], eax
		jmp	loc_4293A0	; jumptable 004291EC default case
; ---------------------------------------------------------------------------

loc_4292DB:				; CODE XREF: sub_428F2F+2BDj
					; DATA XREF: .rdata:off_44D838o
		mov	eax, [ebp+arg_1C] ; jumptable 004291EC cases 15,17
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_428BD3
		mov	[ebp+var_C], eax
		jmp	loc_4293A0	; jumptable 004291EC default case
; ---------------------------------------------------------------------------

loc_42931F:				; CODE XREF: sub_428F2F+2BDj
					; DATA XREF: .rdata:off_44D838o
		mov	eax, [ebp+arg_1C] ; jumptable 004291EC case 16
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_428D74
		mov	[ebp+var_C], eax
		jmp	short loc_4293A0 ; jumptable 004291EC default case
; ---------------------------------------------------------------------------

loc_429360:				; CODE XREF: sub_428F2F+2BDj
					; DATA XREF: .rdata:off_44D838o
		mov	eax, [ebp+arg_1C] ; jumptable 004291EC case 18
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_428E7B
		mov	[ebp+var_C], eax
		nop

loc_4293A0:				; CODE XREF: sub_428F2F+2B0j
					; sub_428F2F+2DBj ...
		cmp	[ebp+var_C], 0	; jumptable 004291EC default case
		jz	short loc_4293AB
		mov	eax, [ebp+var_C]
		jmp	short locret_42940D
; ---------------------------------------------------------------------------

loc_4293AB:				; CODE XREF: sub_428F2F+475j
		add	[ebp+var_14], 28h

loc_4293AF:				; CODE XREF: sub_428F2F+20j
					; sub_428F2F+33j ...
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_428F54
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_4293ED
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		jmp	short loc_4293F2
; ---------------------------------------------------------------------------

loc_4293ED:				; CODE XREF: sub_428F2F+4A1j
		mov	eax, 0

loc_4293F2:				; CODE XREF: sub_428F2F+4BCj
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_42940A
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_42940A:				; CODE XREF: sub_428F2F+4CAj
		mov	eax, [ebp+var_C]

locret_42940D:				; CODE XREF: sub_428F2F+74j
					; sub_428F2F+BBj ...
		leave
		retn
sub_428F2F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42940F	proc near		; CODE XREF: .text:00429A3Bp
					; .text:00429A72p ...

NumOfElements	= dword	ptr -1E8h
SizeOfElements	= dword	ptr -1E4h
var_1E0		= dword	ptr -1E0h
var_1DC		= dword	ptr -1DCh
var_1D8		= dword	ptr -1D8h
var_1D4		= dword	ptr -1D4h
var_1D0		= dword	ptr -1D0h
var_1CC		= dword	ptr -1CCh
var_1BC		= dword	ptr -1BCh
var_1B4		= dword	ptr -1B4h
var_1B0		= byte ptr -1B0h
var_F0		= dword	ptr -0F0h
var_EC		= dword	ptr -0ECh
var_E8		= byte ptr -0E8h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Memory		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 1E0h
		lea	eax, [ebp+var_E8]
		mov	[ebp+var_EC], eax
		lea	eax, [ebp+var_1B0]
		mov	[ebp+Memory], eax
		mov	[ebp+var_1B4], 0
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_F0]
		mov	[esp+1E8h+var_1DC], eax
		mov	[esp+1E8h+var_1E0], 5
		lea	eax, [ebp+var_EC]
		mov	[esp+1E8h+SizeOfElements], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+1E8h+NumOfElements], eax
		call	sub_4275C5
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_429989
		mov	[ebp+var_14], 0
		mov	[ebp+var_1C], 0
		jmp	loc_429555
; ---------------------------------------------------------------------------

loc_42948C:				; CODE XREF: sub_42940F+14Fj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_4294E1
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, [ebp+var_1C]
		jle	short loc_4294E1
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		mov	[ebp+var_1C], eax

loc_4294E1:				; CODE XREF: sub_42940F+98j
					; sub_42940F+B5j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		cmp	eax, [ebp+var_1C]
		jle	short loc_429519
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		mov	[ebp+var_1C], eax

loc_429519:				; CODE XREF: sub_42940F+EDj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		cmp	eax, [ebp+var_1C]
		jle	short loc_429551
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		mov	[ebp+var_1C], eax

loc_429551:				; CODE XREF: sub_42940F+125j
		add	[ebp+var_14], 1

loc_429555:				; CODE XREF: sub_42940F+78j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_42948C
		cmp	[ebp+var_1C], 0
		jnz	loc_429649
		mov	[ebp+var_14], 0
		jmp	loc_429635
; ---------------------------------------------------------------------------

loc_42957A:				; CODE XREF: sub_42940F+22Fj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_4295B7
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		lea	edx, [ecx+eax]
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		mov	[edx+1Ch], eax

loc_4295B7:				; CODE XREF: sub_42940F+186j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_4295F4
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		lea	edx, [ecx+eax]
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		mov	[edx+20h], eax

loc_4295F4:				; CODE XREF: sub_42940F+1C3j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_429631
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		lea	edx, [ecx+eax]
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		mov	[edx+18h], eax

loc_429631:				; CODE XREF: sub_42940F+200j
		add	[ebp+var_14], 1

loc_429635:				; CODE XREF: sub_42940F+166j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_42957A
		jmp	loc_429702
; ---------------------------------------------------------------------------

loc_429649:				; CODE XREF: sub_42940F+159j
		mov	[ebp+var_14], 0
		jmp	loc_4296F3
; ---------------------------------------------------------------------------

loc_429655:				; CODE XREF: sub_42940F+2EDj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		test	eax, eax
		jz	loc_429973
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_4296B2
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	loc_429973

loc_4296B2:				; CODE XREF: sub_42940F+281j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_4296EF
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		test	eax, eax
		jz	loc_429973

loc_4296EF:				; CODE XREF: sub_42940F+2BEj
		add	[ebp+var_14], 1

loc_4296F3:				; CODE XREF: sub_42940F+241j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_429655

loc_429702:				; CODE XREF: sub_42940F+235j
		cmp	[ebp+var_1C], 0
		js	loc_429973
		mov	ebx, [ebp+var_1C]
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1BC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1BC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	ebx, eax
		jnb	loc_429973
		mov	eax, [ebp+var_1C]
		cmp	eax, 8
		jbe	short loc_429765
		mov	eax, [ebp+var_1C]
		mov	[esp+1E8h+SizeOfElements], 18h ; SizeOfElements
		mov	[esp+1E8h+NumOfElements], eax ;	NumOfElements
		call	calloc
		mov	[ebp+Memory], eax
		cmp	[ebp+Memory], 0
		jnz	short loc_42978D
		jmp	loc_429980
; ---------------------------------------------------------------------------

loc_429765:				; CODE XREF: sub_42940F+333j
		mov	[ebp+var_18], 0
		jmp	short loc_429787
; ---------------------------------------------------------------------------

loc_42976E:				; CODE XREF: sub_42940F+37Cj
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	dword ptr [eax], 0
		add	[ebp+var_18], 1

loc_429787:				; CODE XREF: sub_42940F+35Dj
		cmp	[ebp+var_18], 7
		jbe	short loc_42976E

loc_42978D:				; CODE XREF: sub_42940F+34Fj
		mov	[ebp+var_14], 0
		jmp	loc_4298EE
; ---------------------------------------------------------------------------

loc_429799:				; CODE XREF: sub_42940F+4E8j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_429818
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_429969
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		mov	ecx, eax
		add	ecx, [ebp+Memory]
		mov	ebx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ebx
		mov	eax, [eax+24h]
		mov	[ecx], eax

loc_429818:				; CODE XREF: sub_42940F+3A5j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_429881
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_42996C
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	dword ptr [eax], 6

loc_429881:				; CODE XREF: sub_42940F+424j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_4298EA
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_42996F
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	dword ptr [eax], 6

loc_4298EA:				; CODE XREF: sub_42940F+48Dj
		add	[ebp+var_14], 1

loc_4298EE:				; CODE XREF: sub_42940F+385j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_429799
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+arg_C]
		mov	[esp+1E8h+var_1E0], edx
		mov	[esp+1E8h+SizeOfElements], eax
		mov	eax, [ebp+Memory]
		mov	[esp+1E8h+NumOfElements], eax
		call	sub_427D3D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_429972
		mov	edx, [ebp+var_F0]
		mov	eax, [ebp+var_EC]
		lea	ecx, [ebp+var_1B4]
		mov	[esp+1E8h+var_1CC], ecx
		mov	ecx, [ebp+var_20]
		mov	[esp+1E8h+var_1D0], ecx
		mov	ecx, [ebp+Memory]
		mov	[esp+1E8h+var_1D4], ecx
		mov	[esp+1E8h+var_1D8], edx
		mov	[esp+1E8h+var_1DC], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+1E8h+var_1E0], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+1E8h+SizeOfElements], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+1E8h+NumOfElements], eax
		call	sub_428F2F
		mov	[ebp+var_10], eax
		jmp	short loc_42998A
; ---------------------------------------------------------------------------

loc_429969:				; CODE XREF: sub_42940F+3D8j
		nop
		jmp	short loc_429973
; ---------------------------------------------------------------------------

loc_42996C:				; CODE XREF: sub_42940F+457j
		nop
		jmp	short loc_429973
; ---------------------------------------------------------------------------

loc_42996F:				; CODE XREF: sub_42940F+4C0j
		nop
		jmp	short loc_429973
; ---------------------------------------------------------------------------

loc_429972:				; CODE XREF: sub_42940F+50Ej
		nop

loc_429973:				; CODE XREF: sub_42940F+260j
					; sub_42940F+29Dj ...
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h

loc_429980:				; CODE XREF: sub_42940F+351j
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_42998A
; ---------------------------------------------------------------------------

loc_429989:				; CODE XREF: sub_42940F+64j
		nop

loc_42998A:				; CODE XREF: sub_42940F+558j
					; sub_42940F+578j
		lea	eax, [ebp+var_1B0]
		cmp	[ebp+Memory], eax
		jz	short loc_4299A0
		mov	eax, [ebp+Memory]
		mov	[esp+1E8h+NumOfElements], eax ;	Memory
		call	free

loc_4299A0:				; CODE XREF: sub_42940F+584j
		mov	edx, [ebp+var_EC]
		lea	eax, [ebp+var_E8]
		cmp	edx, eax
		jz	short loc_4299BE
		mov	eax, [ebp+var_EC]
		mov	[esp+1E8h+NumOfElements], eax ;	Memory
		call	free

loc_4299BE:				; CODE XREF: sub_42940F+59Fj
		mov	eax, [ebp+var_10]
		add	esp, 1E0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_42940F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4299CB(int, void *, size_t)
sub_4299CB	proc near		; DATA XREF: .text:00429A34o
					; .text:00429A6Bo ...

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 1 ; Count
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+Size],	edx ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		cmp	eax, 1
		jz	short loc_429A04
		mov	eax, 0FFFFFFFFh
		jmp	short locret_429A09
; ---------------------------------------------------------------------------

loc_429A04:				; CODE XREF: sub_4299CB+30j
		mov	eax, 0

locret_429A09:				; CODE XREF: sub_4299CB+37j
		leave
		retn
sub_4299CB	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	edx, ds:_iob
		add	edx, 40h
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	dword ptr [esp], offset	sub_4299CB
		call	sub_42940F
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+10h]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	sub_4299CB
		call	sub_42940F
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	sub_4299CB
		call	sub_42940F
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_429AA8(int, void *, size_t)
sub_429AA8	proc near		; CODE XREF: sub_429B64+6Dp
					; DATA XREF: sub_429B64+42o

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_429B5D
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	edx, eax
		jnb	short loc_429B48
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	ecx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		add	eax, ecx
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		jmp	short loc_429B5D
; ---------------------------------------------------------------------------

loc_429B20:				; CODE XREF: sub_429AA8+B3j
		mov	eax, [ebp+var_C]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+arg_4]
		movzx	edx, byte ptr [edx]
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		add	[ebp+arg_4], 1
		sub	[ebp+arg_8], 1

loc_429B48:				; CODE XREF: sub_429AA8+3Dj
		cmp	[ebp+arg_8], 0
		jz	short loc_429B5D
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	edx, eax
		jb	short loc_429B20

loc_429B5D:				; CODE XREF: sub_429AA8+25j
					; sub_429AA8+76j ...
		mov	eax, 0
		leave
		retn
sub_429AA8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_429B64	proc near		; CODE XREF: sub_429C1D+29p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_18], 0
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_429B89
		mov	eax, [ebp+arg_0]
		jmp	short loc_429B8E
; ---------------------------------------------------------------------------

loc_429B89:				; CODE XREF: sub_429B64+1Ej
		mov	eax, 0

loc_429B8E:				; CODE XREF: sub_429B64+23j
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_34], eax
		mov	[esp+38h+var_38], offset sub_429AA8
		call	sub_42940F
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_429BD9
		mov	[esp+38h+var_30], 1 ; size_t
		mov	[esp+38h+var_34], offset byte_44D884 ; void *
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_38], eax ;	int
		call	sub_429AA8
		mov	[ebp+var_C], eax

loc_429BD9:				; CODE XREF: sub_429B64+55j
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_429BE6
		mov	eax, 0FFFFFFFFh
		jmp	short locret_429C1B
; ---------------------------------------------------------------------------

loc_429BE6:				; CODE XREF: sub_429B64+79j
		cmp	[ebp+arg_4], 0
		jz	short loc_429C0F
		cmp	[ebp+arg_0], 0
		jz	short loc_429C0F
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jz	short loc_429C0F
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_1C]
		cmp	edx, eax
		jb	short loc_429C0F
		mov	eax, [ebp+var_1C]
		sub	eax, 1
		add	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0

loc_429C0F:				; CODE XREF: sub_429B64+86j
					; sub_429B64+8Cj ...
		mov	eax, [ebp+var_18]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]

locret_429C1B:				; CODE XREF: sub_429B64+80j
		leave
		retn
sub_429B64	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_429C1D	proc near		; CODE XREF: sub_40316F+48Dp
					; sub_406449+C2p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_C]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_429B64
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_429C1D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_429C53(int, void *Src, size_t)
sub_429C53	proc near		; CODE XREF: sub_429D5F+83p
					; DATA XREF: sub_429D5F+58o

Memory		= dword	ptr -28h
NewSize		= dword	ptr -24h
Size		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Src		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_429C80
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_C]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, 0FFFFFFFFh
		jmp	locret_429D5D
; ---------------------------------------------------------------------------

loc_429C80:				; CODE XREF: sub_429C53+13j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	loc_429D21
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		add	eax, [ebp+arg_8]
		lea	edx, [eax+200h]
		mov	eax, [ebp+var_C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	[esp+28h+NewSize], edx ; NewSize
		mov	[esp+28h+Memory], eax ;	Memory
		call	realloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_429D18
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_429CE7
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		jmp	short loc_429CEC
; ---------------------------------------------------------------------------

loc_429CE7:				; CODE XREF: sub_429C53+87j
		mov	eax, 0Ch

loc_429CEC:				; CODE XREF: sub_429C53+92j
		mov	edx, [ebp+var_C]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	[esp+28h+Size],	edx ; Size
		mov	[esp+28h+NewSize], 0 ; Val
		mov	[esp+28h+Memory], eax ;	Dst
		call	memset
		mov	eax, 0FFFFFFFFh
		jmp	short locret_429D5D
; ---------------------------------------------------------------------------

loc_429D18:				; CODE XREF: sub_429C53+7Aj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		mov	[eax+0Ch], edx

loc_429D21:				; CODE XREF: sub_429C53+40j
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	ecx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		add	eax, ecx
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+NewSize], edx ; Src
		mov	[esp+28h+Memory], eax ;	Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, 0

locret_429D5D:				; CODE XREF: sub_429C53+28j
					; sub_429C53+C3j
		leave
		retn
sub_429C53	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_429D5F	proc near		; CODE XREF: sub_429E78+22p
					; .text:0042EBDEp ...

Dst		= dword	ptr -38h
Val		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_1C], 0
		mov	[ebp+var_18], 200h
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		test	eax, eax
		jnz	short loc_429DA2
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh
		jmp	locret_429E76
; ---------------------------------------------------------------------------

loc_429DA2:				; CODE XREF: sub_429D5F+2Ej
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Size],	eax
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+Val], eax
		mov	[esp+38h+Dst], offset sub_429C53
		call	sub_42940F
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_429DEA
		mov	[esp+38h+Size],	1 ; size_t
		mov	[esp+38h+Val], offset byte_44D884 ; Src
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+Dst], eax ; int
		call	sub_429C53
		mov	[ebp+var_C], eax

loc_429DEA:				; CODE XREF: sub_429D5F+6Bj
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	short loc_429E0A
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jz	short loc_429E0A
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_1C]
		mov	[eax], edx

loc_429E0A:				; CODE XREF: sub_429D5F+8Fj
					; sub_429D5F+96j
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_429E45
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Val], 0 ; Val
		mov	[esp+38h+Dst], eax ; Dst
		call	memset
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh
		jmp	short locret_429E76
; ---------------------------------------------------------------------------

loc_429E45:				; CODE XREF: sub_429D5F+AFj
		mov	eax, [ebp+var_14]
		test	eax, eax
		jnz	short loc_429E68
		mov	[esp+38h+Size],	6E9h ; int
		mov	[esp+38h+Val], offset a____Gnupg22__7 ;	"../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+38h+Dst], offset aParm_used ; "parm.used"
		call	sub_442650

loc_429E68:				; CODE XREF: sub_429D5F+EBj
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		sub	eax, 1

locret_429E76:				; CODE XREF: sub_429D5F+3Ej
					; sub_429D5F+E4j
		leave
		retn
sub_429D5F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_429E78	proc near		; CODE XREF: sub_4040C4+139p
					; sub_404250+AAp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_429D5F
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_429E78	endp

; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-14h], 1
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		jmp	short loc_429EF3
; ---------------------------------------------------------------------------

loc_429EBD:				; CODE XREF: .text:00429EFBj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Bh
		jz	short loc_429EE5
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jz	short loc_429EE5
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_429EE5
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		ja	short loc_429EEB

loc_429EE5:				; CODE XREF: .text:00429EC5j
					; .text:00429ECFj ...
		add	dword ptr [ebp-14h], 3
		jmp	short loc_429EEF
; ---------------------------------------------------------------------------

loc_429EEB:				; CODE XREF: .text:00429EE3j
		add	dword ptr [ebp-14h], 1

loc_429EEF:				; CODE XREF: .text:00429EE9j
		add	dword ptr [ebp-10h], 1

loc_429EF3:				; CODE XREF: .text:00429EBBj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_429EBD
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	gcry_malloc
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_429F21
		mov	eax, 0
		jmp	locret_429FBF
; ---------------------------------------------------------------------------

loc_429F21:				; CODE XREF: .text:00429F15j
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		jmp	short loc_429FA8
; ---------------------------------------------------------------------------

loc_429F29:				; CODE XREF: .text:00429FB0j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Bh
		jz	short loc_429F51
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jz	short loc_429F51
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_429F51
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		ja	short loc_429F7F

loc_429F51:				; CODE XREF: .text:00429F31j
					; .text:00429F3Bj ...
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset a02x_1 ; "%%%02X"
		mov	dword ptr [esp+4], 4
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_429C1D
		add	dword ptr [ebp-0Ch], 3
		jmp	short loc_429FA4
; ---------------------------------------------------------------------------

loc_429F7F:				; CODE XREF: .text:00429F4Fj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jnz	short loc_429F95
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	2Bh
		add	dword ptr [ebp-0Ch], 1
		jmp	short loc_429FA4
; ---------------------------------------------------------------------------

loc_429F95:				; CODE XREF: .text:00429F87j
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1

loc_429FA4:				; CODE XREF: .text:00429F7Dj
					; .text:00429F93j
		add	dword ptr [ebp-10h], 1

loc_429FA8:				; CODE XREF: .text:00429F27j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_429F29
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-18h]

locret_429FBF:				; CODE XREF: .text:00429F1Cj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_429FC1	proc near		; CODE XREF: sub_42A14B+46p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_4], eax
		jmp	loc_42A0DD
; ---------------------------------------------------------------------------

loc_429FD2:				; CODE XREF: sub_429FC1+124j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_42A0B2
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_42A0B2
		mov	eax, [ebp+arg_4]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_42A0B2
		add	[ebp+arg_4], 1
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_42A023
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_42A04F
; ---------------------------------------------------------------------------

loc_42A023:				; CODE XREF: sub_429FC1+4Dj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_42A03E
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_42A04D
; ---------------------------------------------------------------------------

loc_42A03E:				; CODE XREF: sub_429FC1+6Aj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_42A04D:				; CODE XREF: sub_429FC1+7Bj
		mov	edx, eax

loc_42A04F:				; CODE XREF: sub_429FC1+60j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		ja	short loc_42A06A
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_42A091
; ---------------------------------------------------------------------------

loc_42A06A:				; CODE XREF: sub_429FC1+99j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		ja	short loc_42A085
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_42A091
; ---------------------------------------------------------------------------

loc_42A085:				; CODE XREF: sub_429FC1+B4j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_42A091:				; CODE XREF: sub_429FC1+A7j
					; sub_429FC1+C2j
		add	edx, eax
		mov	eax, [ebp+var_4]
		mov	[eax], dl
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42A0AC
		mov	eax, [ebp+arg_C]
		mov	edx, eax
		mov	eax, [ebp+var_4]
		mov	[eax], dl

loc_42A0AC:				; CODE XREF: sub_429FC1+DFj
		add	[ebp+arg_4], 1
		jmp	short loc_42A0D5
; ---------------------------------------------------------------------------

loc_42A0B2:				; CODE XREF: sub_429FC1+19j
					; sub_429FC1+2Aj ...
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Bh
		jnz	short loc_42A0CA
		cmp	[ebp+arg_8], 0
		jz	short loc_42A0CA
		mov	eax, [ebp+var_4]
		mov	byte ptr [eax],	20h
		jmp	short loc_42A0D5
; ---------------------------------------------------------------------------

loc_42A0CA:				; CODE XREF: sub_429FC1+F9j
					; sub_429FC1+FFj
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_4]
		mov	[eax], dl

loc_42A0D5:				; CODE XREF: sub_429FC1+EFj
					; sub_429FC1+107j
		add	[ebp+var_4], 1
		add	[ebp+arg_4], 1

loc_42A0DD:				; CODE XREF: sub_429FC1+Cj
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_429FD2
		mov	edx, [ebp+var_4]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		leave
		retn
sub_429FC1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42A0F9	proc near		; CODE XREF: sub_42A14B+Cp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		jmp	short loc_42A13C
; ---------------------------------------------------------------------------

loc_42A108:				; CODE XREF: sub_42A0F9+4Bj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_42A134
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42A134
		mov	eax, [ebp+arg_0]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42A134
		add	[ebp+arg_0], 1
		add	[ebp+arg_0], 1

loc_42A134:				; CODE XREF: sub_42A0F9+17j
					; sub_42A0F9+24j ...
		add	[ebp+arg_0], 1
		add	[ebp+var_4], 1

loc_42A13C:				; CODE XREF: sub_42A0F9+Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42A108
		mov	eax, [ebp+var_4]
		leave
		retn
sub_42A0F9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42A14B	proc near		; CODE XREF: .text:0042A1E8p
					; .text:0042A20Ap

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42A0F9
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+var_28], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_42A1C8
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	sub_429FC1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_C]
		jz	short loc_42A1BD
		mov	[esp+28h+var_20], 92h ;	int
		mov	[esp+28h+var_24], offset a____Gnupg22__8 ; "../../gnupg2-2.0.30/common/percent.c"
		mov	[esp+28h+var_28], offset aNNbytes ; "n == nbytes"
		call	sub_442650

loc_42A1BD:				; CODE XREF: sub_42A14B+54j
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		add	eax, edx
		mov	byte ptr [eax],	0

loc_42A1C8:				; CODE XREF: sub_42A14B+29j
		mov	eax, [ebp+var_10]
		leave
		retn
sub_42A14B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42A14B
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42A14B
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42A211	proc near		; CODE XREF: sub_42A351+1Bp
					; .text:0042A38Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+var_8]
		mov	[ebp+var_4], eax
		jmp	loc_42A335
; ---------------------------------------------------------------------------

loc_42A228:				; CODE XREF: sub_42A211+12Cj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_42A308
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_42A308
		mov	eax, [ebp+arg_0]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_42A308
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_42A279
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_42A2A5
; ---------------------------------------------------------------------------

loc_42A279:				; CODE XREF: sub_42A211+53j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_42A294
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_42A2A3
; ---------------------------------------------------------------------------

loc_42A294:				; CODE XREF: sub_42A211+70j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_42A2A3:				; CODE XREF: sub_42A211+81j
		mov	edx, eax

loc_42A2A5:				; CODE XREF: sub_42A211+66j
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_42A2C0
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_42A2E7
; ---------------------------------------------------------------------------

loc_42A2C0:				; CODE XREF: sub_42A211+9Fj
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_42A2DB
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_42A2E7
; ---------------------------------------------------------------------------

loc_42A2DB:				; CODE XREF: sub_42A211+BAj
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_42A2E7:				; CODE XREF: sub_42A211+ADj
					; sub_42A211+C8j
		add	edx, eax
		mov	eax, [ebp+var_4]
		mov	[eax], dl
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42A302
		mov	eax, [ebp+arg_8]
		mov	edx, eax
		mov	eax, [ebp+var_4]
		mov	[eax], dl

loc_42A302:				; CODE XREF: sub_42A211+E5j
		add	[ebp+arg_0], 1
		jmp	short loc_42A32D
; ---------------------------------------------------------------------------

loc_42A308:				; CODE XREF: sub_42A211+1Fj
					; sub_42A211+30j ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Bh
		jnz	short loc_42A320
		cmp	[ebp+arg_4], 0
		jz	short loc_42A320
		mov	eax, [ebp+var_4]
		mov	byte ptr [eax],	20h
		jmp	short loc_42A32D
; ---------------------------------------------------------------------------

loc_42A320:				; CODE XREF: sub_42A211+FFj
					; sub_42A211+105j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_4]
		mov	[eax], dl

loc_42A32D:				; CODE XREF: sub_42A211+F5j
					; sub_42A211+10Dj
		add	[ebp+var_4], 1
		add	[ebp+arg_0], 1

loc_42A335:				; CODE XREF: sub_42A211+12j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_42A228
		mov	edx, [ebp+var_4]
		mov	eax, [ebp+var_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		leave
		retn
sub_42A211	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42A351	proc near		; CODE XREF: sub_4054EA+125p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	eax, [ebp+arg_4]
		mov	[esp+0Ch+var_4], eax
		mov	[esp+0Ch+var_8], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_42A211
		leave
		retn
sub_42A351	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42A211
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42A398	proc near		; CODE XREF: sub_42A3BF+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_42A3B8
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_42A3BD
; ---------------------------------------------------------------------------

loc_42A3B8:				; CODE XREF: sub_42A398+7j
		mov	eax, 0

loc_42A3BD:				; CODE XREF: sub_42A398+1Ej
		pop	ebp
		retn
sub_42A398	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42A3BF	proc near		; CODE XREF: sub_42B1A5+17p
					; sub_42B1A5+4Bp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_42A398
		leave
		retn
sub_42A3BF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42A3DA	proc near		; CODE XREF: sub_4168B1+3ACp
					; .text:0042A43Dp ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 0
		call	sub_442720
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_451664
		test	eax, eax
		jnz	short loc_42A3FD
		mov	eax, [ebp+var_C]
		jmp	short locret_42A432
; ---------------------------------------------------------------------------

loc_42A3FD:				; CODE XREF: sub_42A3DA+1Cj
		mov	eax, ds:dword_451664
		cmp	eax, 1
		jnz	short loc_42A40E
		mov	eax, ds:dword_451660
		jmp	short locret_42A432
; ---------------------------------------------------------------------------

loc_42A40E:				; CODE XREF: sub_42A3DA+2Bj
		mov	eax, ds:dword_451664
		cmp	eax, 2
		jnz	short loc_42A424
		mov	edx, [ebp+var_C]
		mov	eax, ds:dword_451660
		add	eax, edx
		jmp	short locret_42A432
; ---------------------------------------------------------------------------

loc_42A424:				; CODE XREF: sub_42A3DA+3Cj
		mov	edx, [ebp+var_C]
		mov	eax, ds:dword_451660
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_42A432:				; CODE XREF: sub_42A3DA+21j
					; sub_42A3DA+32j ...
		leave
		retn
sub_42A3DA	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		call	sub_42A3DA
		mov	[ebp-20h], eax
		mov	eax, [ebp-20h]
		test	eax, eax
		jns	short loc_42A454
		mov	eax, [ebp+8]
		mov	byte ptr [eax],	0
		jmp	short loc_42A4C1
; ---------------------------------------------------------------------------

loc_42A454:				; CODE XREF: .text:0042A44Aj
		lea	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_442730
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		mov	ebx, [eax]
		mov	eax, [ebp-1Ch]
		mov	ecx, [eax+4]
		mov	eax, [ebp-1Ch]
		mov	edx, [eax+8]
		mov	eax, [ebp-1Ch]
		mov	eax, [eax+0Ch]
		mov	esi, [ebp-1Ch]
		mov	esi, [esi+10h]
		lea	edi, [esi+1]
		mov	esi, [ebp-1Ch]
		mov	esi, [esi+14h]
		add	esi, 76Ch
		mov	[esp+20h], ebx
		mov	[esp+1Ch], ecx
		mov	[esp+18h], edx
		mov	[esp+14h], eax
		mov	[esp+10h], edi
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], offset a04d02d02dt02d0 ; "%04d%02d%02dT%02d%02d%02d"
		mov	dword ptr [esp+4], 10h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_429C1D

loc_42A4C1:				; CODE XREF: .text:0042A452j
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp], 0
		call	sub_442720
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp+8], 0FFFFFFFFh
		jz	short loc_42A4EC
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_42A502

loc_42A4EC:				; CODE XREF: .text:0042A4E2j
		mov	ds:dword_451664, 0
		mov	ds:dword_451660, 0
		jmp	short locret_42A55C
; ---------------------------------------------------------------------------

loc_42A502:				; CODE XREF: .text:0042A4EAj
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_42A51C
		mov	ds:dword_451664, 1
		mov	eax, [ebp-0Ch]
		mov	ds:dword_451660, eax
		jmp	short locret_42A55C
; ---------------------------------------------------------------------------

loc_42A51C:				; CODE XREF: .text:0042A506j
		mov	eax, [ebp+8]
		cmp	eax, [ebp-0Ch]
		jle	short loc_42A541
		mov	ds:dword_451664, 2
		mov	eax, [ebp-0Ch]
		mov	edx, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	ds:dword_451660, eax
		jmp	short locret_42A55C
; ---------------------------------------------------------------------------

loc_42A541:				; CODE XREF: .text:0042A522j
		mov	ds:dword_451664, 3
		mov	eax, [ebp+8]
		mov	edx, [ebp-0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	ds:dword_451660, eax

locret_42A55C:				; CODE XREF: .text:0042A500j
					; .text:0042A51Aj ...
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_451664
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_42A3DA
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_42A588
		mov	dword ptr [esp], offset	aGnupg_get_time	; "gnupg_get_time() failed\n"
		call	sub_43CB64
; ---------------------------------------------------------------------------

loc_42A588:				; CODE XREF: .text:0042A57Aj
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 60h
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-4Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-4Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 0Ah
		jnz	short loc_42A5D3
		mov	eax, [ebp+8]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_42A5D3
		mov	eax, [ebp+8]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jz	short loc_42A5DD

loc_42A5D3:				; CODE XREF: .text:0042A5B7j
					; .text:0042A5C4j
		mov	eax, 0
		jmp	loc_42A73C
; ---------------------------------------------------------------------------

loc_42A5DD:				; CODE XREF: .text:0042A5D1j
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_42A60E
; ---------------------------------------------------------------------------

loc_42A5E6:				; CODE XREF: .text:0042A612j
		mov	eax, [ebp-0Ch]
		add	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42A600
		mov	eax, [ebp-0Ch]
		add	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_42A60A

loc_42A600:				; CODE XREF: .text:0042A5F1j
		mov	eax, 0
		jmp	loc_42A73C
; ---------------------------------------------------------------------------

loc_42A60A:				; CODE XREF: .text:0042A5FEj
		add	dword ptr [ebp-0Ch], 1

loc_42A60E:				; CODE XREF: .text:0042A5E4j
		cmp	dword ptr [ebp-0Ch], 3
		jle	short loc_42A5E6
		mov	eax, [ebp+8]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42A648
		mov	eax, [ebp+8]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_42A648
		mov	eax, [ebp+8]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42A648
		mov	eax, [ebp+8]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_42A652

loc_42A648:				; CODE XREF: .text:0042A61Fj
					; .text:0042A62Cj ...
		mov	eax, 0
		jmp	loc_42A73C
; ---------------------------------------------------------------------------

loc_42A652:				; CODE XREF: .text:0042A646j
		mov	eax, [ebp+8]
		add	eax, 8
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42A686
		mov	eax, [ebp+8]
		add	eax, 8
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_42A686
		mov	eax, [ebp+8]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42A686
		mov	eax, [ebp+8]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_42A690

loc_42A686:				; CODE XREF: .text:0042A65Dj
					; .text:0042A66Aj ...
		mov	eax, 0
		jmp	loc_42A73C
; ---------------------------------------------------------------------------

loc_42A690:				; CODE XREF: .text:0042A684j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	atoi
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		add	eax, 5
		mov	[esp], eax
		call	atoi
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		add	eax, 8
		mov	[esp], eax
		call	atoi
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-10h], 7B1h
		jle	short loc_42A6E1
		cmp	dword ptr [ebp-14h], 0
		jle	short loc_42A6E1
		cmp	dword ptr [ebp-14h], 0Ch
		jg	short loc_42A6E1
		cmp	dword ptr [ebp-18h], 0
		jle	short loc_42A6E1
		cmp	dword ptr [ebp-18h], 1Fh
		jle	short loc_42A6E8

loc_42A6E1:				; CODE XREF: .text:0042A6C7j
					; .text:0042A6CDj ...
		mov	eax, 0
		jmp	short loc_42A73C
; ---------------------------------------------------------------------------

loc_42A6E8:				; CODE XREF: .text:0042A6DFj
		lea	eax, [ebp-40h]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 9
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	eax, [ebp-18h]
		mov	[ebp-34h], eax
		mov	eax, [ebp-14h]
		sub	eax, 1
		mov	[ebp-30h], eax
		mov	eax, [ebp-10h]
		sub	eax, 76Ch
		mov	[ebp-2Ch], eax
		mov	dword ptr [ebp-20h], 0FFFFFFFFh
		lea	eax, [ebp-40h]
		mov	[esp], eax
		call	sub_442740
		mov	[ebp-1Ch], eax
		cmp	dword ptr [ebp-1Ch], 0FFFFFFFFh
		jnz	short loc_42A739
		mov	eax, 0
		jmp	short loc_42A73C
; ---------------------------------------------------------------------------

loc_42A739:				; CODE XREF: .text:0042A730j
		mov	eax, [ebp-1Ch]

loc_42A73C:				; CODE XREF: .text:0042A5D8j
					; .text:0042A605j ...
		add	esp, 60h
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42A743	proc near		; CODE XREF: sub_405B59+D6p

C		= dword	ptr -68h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 60h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42A75F
		mov	eax, 0FFFFFFFFh
		jmp	loc_42AA05
; ---------------------------------------------------------------------------

loc_42A75F:				; CODE XREF: sub_42A743+10j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	short loc_42A794
; ---------------------------------------------------------------------------

loc_42A76E:				; CODE XREF: sub_42A743+55j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42A782
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_42A78C

loc_42A782:				; CODE XREF: sub_42A743+33j
		mov	eax, 0FFFFFFFFh
		jmp	loc_42AA05
; ---------------------------------------------------------------------------

loc_42A78C:				; CODE XREF: sub_42A743+3Dj
		add	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_42A794:				; CODE XREF: sub_42A743+29j
		cmp	[ebp+var_10], 7
		jle	short loc_42A76E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 54h
		jz	short loc_42A7AE
		mov	eax, 0FFFFFFFFh
		jmp	loc_42AA05
; ---------------------------------------------------------------------------

loc_42A7AE:				; CODE XREF: sub_42A743+5Fj
		add	[ebp+var_C], 1
		mov	[ebp+var_10], 9
		jmp	short loc_42A7E1
; ---------------------------------------------------------------------------

loc_42A7BB:				; CODE XREF: sub_42A743+A2j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42A7CF
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_42A7D9

loc_42A7CF:				; CODE XREF: sub_42A743+80j
		mov	eax, 0FFFFFFFFh
		jmp	loc_42AA05
; ---------------------------------------------------------------------------

loc_42A7D9:				; CODE XREF: sub_42A743+8Aj
		add	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_42A7E1:				; CODE XREF: sub_42A743+76j
		cmp	[ebp+var_10], 0Eh
		jle	short loc_42A7BB
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42A830
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_42A812
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+68h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_42A830

loc_42A812:				; CODE XREF: sub_42A743+B6j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_42A830
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ch
		jz	short loc_42A830
		mov	eax, 0FFFFFFFFh
		jmp	loc_42AA05
; ---------------------------------------------------------------------------

loc_42A830:				; CODE XREF: sub_42A743+ACj
					; sub_42A743+CDj ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 3E8h
		lea	edx, [eax-0BB80h]
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 64h
		sub	eax, 12C0h
		lea	ecx, [edx+eax]
		mov	eax, [ebp+arg_0]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		add	eax, ecx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 0Ah
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_0]
		add	eax, 0Bh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 0Ch
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_0]
		add	eax, 0Dh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+arg_0]
		add	eax, 0Eh
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_28], eax
		cmp	[ebp+var_14], 7B1h
		jle	short loc_42A9AB
		cmp	[ebp+var_18], 0
		jle	short loc_42A9AB
		cmp	[ebp+var_18], 0Ch
		jg	short loc_42A9AB
		cmp	[ebp+var_1C], 0
		jle	short loc_42A9AB
		cmp	[ebp+var_1C], 1Fh
		jg	short loc_42A9AB
		cmp	[ebp+var_20], 17h
		jg	short loc_42A9AB
		cmp	[ebp+var_24], 3Bh
		jg	short loc_42A9AB
		cmp	[ebp+var_28], 3Dh
		jle	short loc_42A9B2

loc_42A9AB:				; CODE XREF: sub_42A743+23Cj
					; sub_42A743+242j ...
		mov	eax, 0FFFFFFFFh
		jmp	short loc_42AA05
; ---------------------------------------------------------------------------

loc_42A9B2:				; CODE XREF: sub_42A743+266j
		lea	eax, [ebp+var_4C]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 9
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	eax, [ebp+var_28]
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_44], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_40], eax
		mov	eax, [ebp+var_18]
		sub	eax, 1
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_14]
		sub	eax, 76Ch
		mov	[ebp+var_38], eax
		mov	[ebp+var_2C], 0FFFFFFFFh
		lea	eax, [ebp+var_4C]
		mov	[esp+68h+C], eax
		call	sub_4406AE

loc_42AA05:				; CODE XREF: sub_42A743+17j
					; sub_42A743+44j ...
		add	esp, 60h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_42A743	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+0Ch]
		test	eax, eax
		jns	short loc_42AA24
		mov	eax, [ebp+8]
		mov	byte ptr [eax],	0
		jmp	short loc_42AA91
; ---------------------------------------------------------------------------

loc_42AA24:				; CODE XREF: .text:0042AA1Aj
		lea	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_442730
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		mov	ebx, [eax]
		mov	eax, [ebp-1Ch]
		mov	ecx, [eax+4]
		mov	eax, [ebp-1Ch]
		mov	edx, [eax+8]
		mov	eax, [ebp-1Ch]
		mov	eax, [eax+0Ch]
		mov	esi, [ebp-1Ch]
		mov	esi, [esi+10h]
		lea	edi, [esi+1]
		mov	esi, [ebp-1Ch]
		mov	esi, [esi+14h]
		add	esi, 76Ch
		mov	[esp+20h], ebx
		mov	[esp+1Ch], ecx
		mov	[esp+18h], edx
		mov	[esp+14h], eax
		mov	[esp+10h], edi
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], offset a04d02d02dt02d0 ; "%04d%02d%02dT%02d%02d%02d"
		mov	dword ptr [esp+4], 10h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_429C1D

loc_42AA91:				; CODE XREF: .text:0042AA22j
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+0Ch]
		mov	[ebp-4], ax
		movzx	eax, word ptr [ebp-4]
		imul	eax, 15180h
		add	eax, [ebp+8]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+8]
		mov	[ebp-1Ch], eax
		mov	edx, 88888889h
		mov	eax, [ebp-1Ch]
		mul	edx
		mov	eax, edx
		shr	eax, 5
		mov	[ebp+8], eax
		mov	ecx, [ebp+8]
		mov	edx, 88888889h
		mov	eax, ecx
		mul	edx
		mov	eax, edx
		shr	eax, 5
		shl	eax, 2
		mov	edx, eax
		shl	edx, 4
		sub	edx, eax
		mov	eax, ecx
		sub	eax, edx
		mov	[ebp-0Ch], eax
		mov	edx, [ebp+8]
		mov	[ebp-1Ch], edx
		mov	edx, 88888889h
		mov	eax, [ebp-1Ch]
		mul	edx
		mov	eax, edx
		shr	eax, 5
		mov	[ebp+8], eax
		mov	ecx, [ebp+8]
		mov	edx, 0AAAAAAABh
		mov	eax, ecx
		mul	edx
		shr	edx, 4
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		mov	[ebp-1Ch], eax
		mov	edx, 0AAAAAAABh
		mov	eax, [ebp-1Ch]
		mul	edx
		mov	eax, edx
		shr	eax, 4
		mov	[ebp+8], eax
		mov	ecx, [ebp+8]
		mov	edx, 6719F361h
		mov	eax, ecx
		mul	edx
		mov	eax, ecx
		sub	eax, edx
		shr	eax, 1
		add	eax, edx
		shr	eax, 8
		imul	eax, 16Dh
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		mov	[ebp-14h], eax
		mov	ecx, [ebp+8]
		mov	edx, 6719F361h
		mov	eax, ecx
		mul	edx
		mov	eax, ecx
		sub	eax, edx
		shr	eax, 1
		add	eax, edx
		shr	eax, 8
		mov	[ebp+8], eax
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, offset aUyUdUhUm ;	"%uy%ud%uh%um"
		mov	edx, [ebp-0Ch]
		mov	[esp+14h], edx
		mov	edx, [ebp-10h]
		mov	[esp+10h], edx
		mov	edx, [ebp-14h]
		mov	[esp+0Ch], edx
		mov	edx, [ebp-18h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_4516E0
		call	sprintf
		cmp	dword ptr [ebp-18h], 0
		jz	short loc_42ABCA
		mov	eax, offset dword_4516E0
		jmp	short locret_42AC00
; ---------------------------------------------------------------------------

loc_42ABCA:				; CODE XREF: .text:0042ABC1j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_42ABE9
		mov	dword ptr [esp+4], 79h
		mov	dword ptr [esp], offset	dword_4516E0
		call	strchr
		add	eax, 1
		jmp	short locret_42AC00
; ---------------------------------------------------------------------------

loc_42ABE9:				; CODE XREF: .text:0042ABCEj
		mov	dword ptr [esp+4], 64h
		mov	dword ptr [esp], offset	dword_4516E0
		call	strchr
		add	eax, 1

locret_42AC00:				; CODE XREF: .text:0042ABC8j
					; .text:0042ABE7j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		test	eax, eax
		jns	short loc_42AC42
		mov	eax, offset a???????? ;	"????-??-??"
		mov	edx, [eax]
		mov	ds:dword_4516D0, edx
		mov	edx, [eax+4]
		mov	ds:dword_4516D4, edx
		movzx	edx, word ptr [eax+8]
		mov	ds:word_4516D8,	dx
		movzx	eax, byte ptr [eax+0Ah]
		mov	ds:byte_4516DA,	al
		jmp	short loc_42AC8C
; ---------------------------------------------------------------------------

loc_42AC42:				; CODE XREF: .text:0042AC14j
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_442730
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+10h]
		lea	ebx, [eax+1]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+14h]
		lea	ecx, [eax+76Ch]
		mov	eax, offset a04d02d02d ; "%04d-%02d-%02d"
		mov	[esp+10h], edx
		mov	[esp+0Ch], ebx
		mov	[esp+8], ecx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_4516D0
		call	sprintf

loc_42AC8C:				; CODE XREF: .text:0042AC40j
		mov	eax, offset dword_4516D0
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+8]
		mov	[ebp-20h], eax
		mov	eax, [ebp-20h]
		test	eax, eax
		jns	short loc_42ACDF
		mov	eax, offset a?????????????? ; "????-??-?? ??:??:??"
		mov	edx, [eax]
		mov	ds:dword_4516B2, edx
		mov	edx, [eax+4]
		mov	ds:dword_4516B6, edx
		mov	edx, [eax+8]
		mov	ds:dword_4516BA, edx
		mov	edx, [eax+0Ch]
		mov	ds:dword_4516BE, edx
		mov	eax, [eax+10h]
		mov	ds:dword_4516C2, eax
		jmp	short loc_42AD4C
; ---------------------------------------------------------------------------

loc_42ACDF:				; CODE XREF: .text:0042ACABj
		lea	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_442730
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		mov	esi, [eax]
		mov	eax, [ebp-1Ch]
		mov	ebx, [eax+4]
		mov	eax, [ebp-1Ch]
		mov	ecx, [eax+8]
		mov	eax, [ebp-1Ch]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp-1Ch]
		mov	eax, [eax+10h]
		add	eax, 1
		mov	[ebp-2Ch], eax
		mov	eax, [ebp-1Ch]
		mov	eax, [eax+14h]
		lea	edi, [eax+76Ch]
		mov	eax, offset a04d02d02d02d02 ; "%04d-%02d-%02d %02d:%02d:%02d"
		mov	[esp+1Ch], esi
		mov	[esp+18h], ebx
		mov	[esp+14h], ecx
		mov	[esp+10h], edx
		mov	edx, [ebp-2Ch]
		mov	[esp+0Ch], edx
		mov	[esp+8], edi
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_4516B2
		call	sprintf

loc_42AD4C:				; CODE XREF: .text:0042ACDDj
		mov	eax, offset dword_4516B2
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		test	eax, eax
		jns	short loc_42AD9D
		mov	eax, offset a???????? ;	"????-??-??"
		mov	edx, [eax]
		mov	ds:dword_451680, edx
		mov	edx, [eax+4]
		mov	ds:dword_451684, edx
		movzx	edx, word ptr [eax+8]
		mov	ds:word_451688,	dx
		movzx	eax, byte ptr [eax+0Ah]
		mov	ds:byte_45168A,	al
		mov	eax, offset dword_451680
		jmp	short locret_42ADDB
; ---------------------------------------------------------------------------

loc_42AD9D:				; CODE XREF: .text:0042AD6Aj
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_442750
		mov	[ebp-0Ch], eax
		mov	edx, [ebp-0Ch]
		mov	eax, offset aCZ	; "%c %Z"
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 31h
		mov	dword ptr [esp], offset	dword_451680
		call	strftime
		mov	ds:byte_4516B1,	0
		mov	eax, offset dword_451680

locret_42ADDB:				; CODE XREF: .text:0042AD9Bj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42ADDD	proc near		; CODE XREF: sub_42B007+8Dp

var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		and	eax, 3
		test	eax, eax
		setz	al
		movzx	eax, al
		mov	[ebp+var_8], eax
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		imul	eax, 64h
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		test	eax, eax
		jnz	short loc_42AE4D
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 7
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		imul	eax, 190h
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		test	eax, eax
		jz	short loc_42AE4D
		mov	[ebp+var_8], 0

loc_42AE4D:				; CODE XREF: sub_42ADDD+3Dj
					; sub_42ADDD+67j
		cmp	[ebp+var_8], 0
		jz	short loc_42AE5A
		mov	eax, 16Eh
		jmp	short loc_42AE5F
; ---------------------------------------------------------------------------

loc_42AE5A:				; CODE XREF: sub_42ADDD+74j
		mov	eax, 16Dh

loc_42AE5F:				; CODE XREF: sub_42ADDD+7Bj
		add	esp, 10h
		pop	ebx
		pop	ebp
		retn
sub_42ADDD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42AE65	proc near		; CODE XREF: sub_42B007+105p
					; sub_42B007+125p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		cmp	[ebp+arg_4], 0Ch
		ja	loc_42AF3C
		mov	eax, [ebp+arg_4]
		mov	edx, 1
		mov	ebx, edx
		mov	ecx, eax
		shl	ebx, cl
		mov	eax, ebx
		mov	edx, eax
		and	edx, 15AAh
		test	edx, edx
		jnz	short loc_42AEAE
		mov	edx, eax
		and	edx, 0A50h
		test	edx, edx
		jnz	loc_42AF35
		and	eax, 4
		test	eax, eax
		jnz	short loc_42AEB8
		jmp	loc_42AF3C
; ---------------------------------------------------------------------------

loc_42AEAE:				; CODE XREF: sub_42AE65+2Bj
		mov	eax, 1Fh
		jmp	loc_42AF58
; ---------------------------------------------------------------------------

loc_42AEB8:				; CODE XREF: sub_42AE65+42j
		mov	eax, [ebp+arg_0]
		and	eax, 3
		test	eax, eax
		setz	al
		movzx	eax, al
		mov	[ebp+var_C], eax
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		imul	eax, 64h
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		test	eax, eax
		jnz	short loc_42AF21
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 7
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		imul	eax, 190h
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		test	eax, eax
		jz	short loc_42AF21
		mov	[ebp+var_C], 0

loc_42AF21:				; CODE XREF: sub_42AE65+89j
					; sub_42AE65+B3j
		cmp	[ebp+var_C], 0
		jz	short loc_42AF2E
		mov	eax, 1Dh
		jmp	short loc_42AF33
; ---------------------------------------------------------------------------

loc_42AF2E:				; CODE XREF: sub_42AE65+C0j
		mov	eax, 1Ch

loc_42AF33:				; CODE XREF: sub_42AE65+C7j
		jmp	short loc_42AF58
; ---------------------------------------------------------------------------

loc_42AF35:				; CODE XREF: sub_42AE65+37j
		mov	eax, 1Eh
		jmp	short loc_42AF58
; ---------------------------------------------------------------------------

loc_42AF3C:				; CODE XREF: sub_42AE65+Bj
					; sub_42AE65+44j
		mov	[esp+28h+var_20], offset aDays_per_month ; "days_per_month"
		mov	[esp+28h+var_24], 191h
		mov	[esp+28h+var_28], offset a____Gnupg22__9 ; "../../gnupg2-2.0.30/common/gettime.c"
		call	sub_43CCB0
; ---------------------------------------------------------------------------

loc_42AF58:				; CODE XREF: sub_42AE65+4Ej
					; sub_42AE65:loc_42AF33j ...
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_42AE65	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42AF5E	proc near		; CODE XREF: sub_42B007+76p
					; sub_42B007+E7p ...

var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		imul	ecx, eax, 16Dh
		mov	eax, [ebp+arg_4]
		lea	edx, [eax-1]
		mov	eax, edx
		shl	eax, 5
		sub	eax, edx
		add	eax, ecx
		add	eax, [ebp+arg_8]
		add	eax, 1A42E4h
		mov	[ebp+var_8], eax
		cmp	[ebp+arg_4], 2
		jg	short loc_42AF94
		sub	[ebp+arg_0], 1
		jmp	short loc_42AFB7
; ---------------------------------------------------------------------------

loc_42AF94:				; CODE XREF: sub_42AF5E+2Ej
		mov	eax, [ebp+arg_4]
		shl	eax, 2
		lea	ecx, [eax+17h]
		mov	edx, 66666667h
		mov	eax, ecx
		imul	edx
		sar	edx, 2
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		sub	[ebp+var_8], eax

loc_42AFB7:				; CODE XREF: sub_42AF5E+34j
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+3]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 2
		mov	ebx, eax
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		lea	edx, [eax+1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		lea	edx, [eax+3]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 2
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		add	[ebp+var_8], eax
		mov	eax, [ebp+var_8]
		add	esp, 10h
		pop	ebx
		pop	ebp
		retn
sub_42AF5E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42B007	proc near		; CODE XREF: .text:0042B5ACp
					; .text:0042B820p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_0], 0
		jnz	short loc_42B01D
		mov	eax, 0
		jmp	locret_42B1A3
; ---------------------------------------------------------------------------

loc_42B01D:				; CODE XREF: sub_42B007+Aj
		cmp	[ebp+arg_0], 1A4450h
		jbe	short loc_42B02F
		cmp	[ebp+arg_0], 2B61CDh
		jbe	short loc_42B039

loc_42B02F:				; CODE XREF: sub_42B007+1Dj
		mov	eax, 0
		jmp	locret_42B1A3
; ---------------------------------------------------------------------------

loc_42B039:				; CODE XREF: sub_42B007+26j
		mov	eax, [ebp+arg_0]
		sub	eax, 1A42E4h
		mov	[ebp+var_1C], eax
		mov	edx, 0B30F6353h
		mov	eax, [ebp+var_1C]
		mul	edx
		mov	eax, edx
		shr	eax, 8
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		jmp	short loc_42B069
; ---------------------------------------------------------------------------

loc_42B065:				; CODE XREF: sub_42B007+95j
		add	[ebp+var_C], 1

loc_42B069:				; CODE XREF: sub_42B007+5Cj
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_42AF5E
		mov	edx, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_42ADDD
		cmp	[ebp+var_18], eax
		jg	short loc_42B065
		mov	ecx, [ebp+var_18]
		mov	edx, 84210843h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 4
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_42B0DA
; ---------------------------------------------------------------------------

loc_42B0C5:				; CODE XREF: sub_42B007+10Dj
		add	[ebp+var_10], 1
		cmp	[ebp+var_10], 0Ch
		jle	short loc_42B0DA
		mov	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_42B0DA:				; CODE XREF: sub_42B007+BCj
					; sub_42B007+C6j
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_42AF5E
		mov	edx, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_42AE65
		cmp	[ebp+var_18], eax
		jg	short loc_42B0C5
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_42AE65
		cmp	eax, [ebp+var_14]
		jge	short loc_42B141
		mov	[ebp+var_14], 1
		add	[ebp+var_10], 1

loc_42B141:				; CODE XREF: sub_42B007+12Dj
		cmp	[ebp+var_10], 0Ch
		jle	short loc_42B152
		mov	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_42B152:				; CODE XREF: sub_42B007+13Ej
		cmp	[ebp+arg_4], 0
		jz	short loc_42B160
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[eax], edx

loc_42B160:				; CODE XREF: sub_42B007+14Fj
		cmp	[ebp+arg_8], 0
		jz	short loc_42B16E
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_42B16E:				; CODE XREF: sub_42B007+15Dj
		cmp	[ebp+arg_C], 0
		jz	short loc_42B17C
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_14]
		mov	[eax], edx

loc_42B17C:				; CODE XREF: sub_42B007+16Bj
		mov	[esp+38h+var_30], 1
		mov	[esp+38h+var_34], 1
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_42AF5E
		mov	edx, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1

locret_42B1A3:				; CODE XREF: sub_42B007+11j
					; sub_42B007+2Dj
		leave
		retn
sub_42B007	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42B1A5	proc near		; CODE XREF: .text:0042B2E8p
					; .text:0042B64Bp

var_14		= dword	ptr -14h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42B1C6
		mov	[esp+14h+var_14], 1Ah
		call	sub_42A3BF
		jmp	locret_42B25F
; ---------------------------------------------------------------------------

loc_42B1C6:				; CODE XREF: sub_42B1A5+Ej
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	[ebp+var_4], 0
		jmp	short loc_42B1FF
; ---------------------------------------------------------------------------

loc_42B1D5:				; CODE XREF: sub_42B1A5+5Ej
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42B1E9
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_42B1F7

loc_42B1E9:				; CODE XREF: sub_42B1A5+38j
		mov	[esp+14h+var_14], 0A1h
		call	sub_42A3BF
		jmp	short locret_42B25F
; ---------------------------------------------------------------------------

loc_42B1F7:				; CODE XREF: sub_42B1A5+42j
		add	[ebp+var_4], 1
		add	[ebp+var_8], 1

loc_42B1FF:				; CODE XREF: sub_42B1A5+2Ej
		cmp	[ebp+var_4], 7
		jle	short loc_42B1D5
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 54h
		jz	short loc_42B21D
		mov	[esp+14h+var_14], 0A1h
		call	sub_42A3BF
		jmp	short locret_42B25F
; ---------------------------------------------------------------------------

loc_42B21D:				; CODE XREF: sub_42B1A5+68j
		add	[ebp+var_8], 1
		mov	[ebp+var_4], 9
		jmp	short loc_42B254
; ---------------------------------------------------------------------------

loc_42B22A:				; CODE XREF: sub_42B1A5+B3j
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42B23E
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_42B24C

loc_42B23E:				; CODE XREF: sub_42B1A5+8Dj
		mov	[esp+14h+var_14], 0A1h
		call	sub_42A3BF
		jmp	short locret_42B25F
; ---------------------------------------------------------------------------

loc_42B24C:				; CODE XREF: sub_42B1A5+97j
		add	[ebp+var_4], 1
		add	[ebp+var_8], 1

loc_42B254:				; CODE XREF: sub_42B1A5+83j
		cmp	[ebp+var_4], 0Eh
		jle	short loc_42B22A
		mov	eax, 0

locret_42B25F:				; CODE XREF: sub_42B1A5+1Cj
					; sub_42B1A5+50j ...
		leave
		retn
sub_42B1A5	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_42B279
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42B28F

loc_42B279:				; CODE XREF: .text:0042B26Dj
		mov	dword ptr [esp], offset	aNone_0	; "[none]"
		call	sub_43C238
		mov	[esp], eax
		call	sub_43CBE8
		jmp	short loc_42B2D4
; ---------------------------------------------------------------------------

loc_42B28F:				; CODE XREF: .text:0042B277j
		mov	eax, [ebp+8]
		lea	esi, [eax+0Dh]
		mov	eax, [ebp+8]
		lea	ebx, [eax+0Bh]
		mov	eax, [ebp+8]
		lea	ecx, [eax+9]
		mov	eax, [ebp+8]
		lea	edx, [eax+6]
		mov	eax, [ebp+8]
		add	eax, 4
		mov	[esp+18h], esi
		mov	[esp+14h], ebx
		mov	[esp+10h], ecx
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a_4s_2s_2s_2s_2	; "%.4s-%.2s-%.2s %.2s:%.2s:%s"
		call	sub_43CBE8

loc_42B2D4:				; CODE XREF: .text:0042B28Dj
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 64h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42B1A5
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_42B2FE
		mov	eax, [ebp-0Ch]
		jmp	loc_42B638
; ---------------------------------------------------------------------------

loc_42B2FE:				; CODE XREF: .text:0042B2F4j
		cmp	dword ptr [ebp+0Ch], 0
		js	short loc_42B30D
		cmp	dword ptr [ebp+0Ch], 7FFFFFC1h
		jle	short loc_42B31E

loc_42B30D:				; CODE XREF: .text:0042B302j
		mov	dword ptr [esp], 37h
		call	sub_42A3BF
		jmp	loc_42B638
; ---------------------------------------------------------------------------

loc_42B31E:				; CODE XREF: .text:0042B30Bj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 3E8h
		lea	edx, [eax-0BB80h]
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 64h
		sub	eax, 12C0h
		lea	ecx, [edx+eax]
		mov	eax, [ebp+8]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		add	eax, ecx
		mov	[ebp-24h], eax
		mov	eax, [ebp+8]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-28h], eax
		mov	eax, [ebp+8]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-2Ch], eax
		mov	eax, [ebp+8]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Ah
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		add	eax, 0Bh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Ch
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		add	eax, 0Dh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Eh
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-18h], eax
		mov	eax, [ebp-24h]
		cmp	eax, 62Eh
		jg	short loc_42B481
		mov	dword ptr [esp], 37h
		call	sub_42A3BF
		jmp	loc_42B638
; ---------------------------------------------------------------------------

loc_42B481:				; CODE XREF: .text:0042B46Ej
		mov	eax, [ebp+0Ch]
		add	[ebp-18h], eax
		mov	ecx, [ebp-18h]
		mov	edx, 88888889h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp-14h], eax
		mov	ecx, [ebp-18h]
		mov	edx, 88888889h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		shl	eax, 2
		mov	edx, eax
		shl	edx, 4
		sub	edx, eax
		mov	eax, ecx
		sub	eax, edx
		mov	[ebp-18h], eax
		mov	ecx, [ebp-14h]
		mov	edx, 88888889h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp-10h], eax
		mov	ecx, [ebp-14h]
		mov	edx, 88888889h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		shl	eax, 2
		mov	edx, eax
		shl	edx, 4
		sub	edx, eax
		mov	eax, ecx
		sub	eax, edx
		mov	[ebp-14h], eax
		mov	ecx, [ebp-10h]
		mov	edx, 2AAAAAABh
		mov	eax, ecx
		imul	edx
		sar	edx, 2
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-1Ch], eax
		mov	ecx, [ebp-10h]
		mov	edx, 2AAAAAABh
		mov	eax, ecx
		imul	edx
		sar	edx, 2
		mov	eax, ecx
		sar	eax, 1Fh
		sub	edx, eax
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		mov	[ebp-10h], eax
		mov	ecx, [ebp-2Ch]
		mov	edx, [ebp-28h]
		mov	eax, [ebp-24h]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_42AF5E
		mov	edx, [ebp-1Ch]
		add	eax, edx
		mov	[ebp-20h], eax
		lea	eax, [ebp-2Ch]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-28h]
		mov	[esp+8], eax
		lea	eax, [ebp-24h]
		mov	[esp+4], eax
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_42B007
		mov	eax, [ebp-24h]
		cmp	eax, 270Fh
		jg	short loc_42B5E0
		mov	eax, [ebp-28h]
		cmp	eax, 0Ch
		jg	short loc_42B5E0
		mov	eax, [ebp-2Ch]
		cmp	eax, 1Fh
		jg	short loc_42B5E0
		mov	eax, [ebp-24h]
		test	eax, eax
		js	short loc_42B5E0
		mov	eax, [ebp-28h]
		test	eax, eax
		jle	short loc_42B5E0
		mov	eax, [ebp-2Ch]
		test	eax, eax
		jg	short loc_42B5EE

loc_42B5E0:				; CODE XREF: .text:0042B5B9j
					; .text:0042B5C1j ...
		mov	dword ptr [esp], 37h
		call	sub_42A3BF
		jmp	short loc_42B638
; ---------------------------------------------------------------------------

loc_42B5EE:				; CODE XREF: .text:0042B5DEj
		mov	ecx, [ebp-2Ch]
		mov	edx, [ebp-28h]
		mov	eax, [ebp-24h]
		mov	ebx, [ebp-18h]
		mov	[esp+20h], ebx
		mov	ebx, [ebp-14h]
		mov	[esp+1Ch], ebx
		mov	ebx, [ebp-10h]
		mov	[esp+18h], ebx
		mov	[esp+14h], ecx
		mov	[esp+10h], edx
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset a04d02d02dt02d0 ; "%04d%02d%02dT%02d%02d%02d"
		mov	dword ptr [esp+4], 10h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_429C1D
		mov	eax, 0

loc_42B638:				; CODE XREF: .text:0042B2F9j
					; .text:0042B319j ...
		add	esp, 64h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 54h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42B1A5
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_42B661
		mov	eax, [ebp-0Ch]
		jmp	loc_42B8AC
; ---------------------------------------------------------------------------

loc_42B661:				; CODE XREF: .text:0042B657j
		cmp	dword ptr [ebp+0Ch], 0
		js	short loc_42B670
		cmp	dword ptr [ebp+0Ch], 37D771h
		jle	short loc_42B681

loc_42B670:				; CODE XREF: .text:0042B665j
		mov	dword ptr [esp], 37h
		call	sub_42A3BF
		jmp	loc_42B8AC
; ---------------------------------------------------------------------------

loc_42B681:				; CODE XREF: .text:0042B66Ej
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 3E8h
		lea	edx, [eax-0BB80h]
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 64h
		sub	eax, 12C0h
		lea	ecx, [edx+eax]
		mov	eax, [ebp+8]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		add	eax, ecx
		mov	[ebp-20h], eax
		mov	eax, [ebp+8]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-24h], eax
		mov	eax, [ebp+8]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-28h], eax
		mov	eax, [ebp+8]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Ah
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		add	eax, 0Bh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Ch
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		add	eax, 0Dh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Eh
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-18h], eax
		mov	eax, [ebp-20h]
		cmp	eax, 62Eh
		jg	short loc_42B7E4
		mov	dword ptr [esp], 37h
		call	sub_42A3BF
		jmp	loc_42B8AC
; ---------------------------------------------------------------------------

loc_42B7E4:				; CODE XREF: .text:0042B7D1j
		mov	ecx, [ebp-28h]
		mov	edx, [ebp-24h]
		mov	eax, [ebp-20h]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_42AF5E
		mov	edx, [ebp+0Ch]
		add	eax, edx
		mov	[ebp-1Ch], eax
		lea	eax, [ebp-28h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-24h]
		mov	[esp+8], eax
		lea	eax, [ebp-20h]
		mov	[esp+4], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_42B007
		mov	eax, [ebp-20h]
		cmp	eax, 270Fh
		jg	short loc_42B854
		mov	eax, [ebp-24h]
		cmp	eax, 0Ch
		jg	short loc_42B854
		mov	eax, [ebp-28h]
		cmp	eax, 1Fh
		jg	short loc_42B854
		mov	eax, [ebp-20h]
		test	eax, eax
		js	short loc_42B854
		mov	eax, [ebp-24h]
		test	eax, eax
		jle	short loc_42B854
		mov	eax, [ebp-28h]
		test	eax, eax
		jg	short loc_42B862

loc_42B854:				; CODE XREF: .text:0042B82Dj
					; .text:0042B835j ...
		mov	dword ptr [esp], 37h
		call	sub_42A3BF
		jmp	short loc_42B8AC
; ---------------------------------------------------------------------------

loc_42B862:				; CODE XREF: .text:0042B852j
		mov	ecx, [ebp-28h]
		mov	edx, [ebp-24h]
		mov	eax, [ebp-20h]
		mov	ebx, [ebp-18h]
		mov	[esp+20h], ebx
		mov	ebx, [ebp-14h]
		mov	[esp+1Ch], ebx
		mov	ebx, [ebp-10h]
		mov	[esp+18h], ebx
		mov	[esp+14h], ecx
		mov	[esp+10h], edx
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset a04d02d02dt02d0 ; "%04d%02d%02dT%02d%02d%02d"
		mov	dword ptr [esp+4], 10h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_429C1D
		mov	eax, 0

loc_42B8AC:				; CODE XREF: .text:0042B65Cj
					; .text:0042B67Cj ...
		add	esp, 54h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		mov	dword ptr [ebp-0Ch], 0
		jmp	loc_42B9FF
; ---------------------------------------------------------------------------

loc_42B8CC:				; CODE XREF: .text:0042BA05j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42B8E0
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_42B908

loc_42B8E0:				; CODE XREF: .text:0042B8D4j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_42B8F4
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_42B908

loc_42B8F4:				; CODE XREF: .text:0042B8E8j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_42B956
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_42B956

loc_42B908:				; CODE XREF: .text:0042B8DEj
					; .text:0042B8F2j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42B922
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_42B960

loc_42B922:				; CODE XREF: .text:0042B913j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_42B93C
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_42B960

loc_42B93C:				; CODE XREF: .text:0042B92Dj
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_42B956
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	short loc_42B960

loc_42B956:				; CODE XREF: .text:0042B8FCj
					; .text:0042B906j ...
		mov	eax, 0FFFFFFFFh
		jmp	locret_42BA66
; ---------------------------------------------------------------------------

loc_42B960:				; CODE XREF: .text:0042B920j
					; .text:0042B93Aj ...
		mov	eax, [ebp-0Ch]
		mov	ecx, eax
		add	ecx, [ebp+0Ch]
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_42B985
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_42B9B1
; ---------------------------------------------------------------------------

loc_42B985:				; CODE XREF: .text:0042B970j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_42B9A0
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_42B9AF
; ---------------------------------------------------------------------------

loc_42B9A0:				; CODE XREF: .text:0042B98Dj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_42B9AF:				; CODE XREF: .text:0042B99Ej
		mov	edx, eax

loc_42B9B1:				; CODE XREF: .text:0042B983j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_42B9CC
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_42B9F3
; ---------------------------------------------------------------------------

loc_42B9CC:				; CODE XREF: .text:0042B9BCj
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_42B9E7
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_42B9F3
; ---------------------------------------------------------------------------

loc_42B9E7:				; CODE XREF: .text:0042B9D7j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_42B9F3:				; CODE XREF: .text:0042B9CAj
					; .text:0042B9E5j
		add	eax, edx
		mov	[ecx], al
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 2

loc_42B9FF:				; CODE XREF: .text:0042B8C7j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jb	loc_42B8CC
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42BA3D
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_42BA36
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_42BA3D

loc_42BA36:				; CODE XREF: .text:0042BA1Dj
		mov	eax, 0FFFFFFFFh
		jmp	short locret_42BA66
; ---------------------------------------------------------------------------

loc_42BA3D:				; CODE XREF: .text:0042BA13j
					; .text:0042BA34j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jz	short loc_42BA4C
		mov	eax, 0FFFFFFFFh
		jmp	short locret_42BA66
; ---------------------------------------------------------------------------

loc_42BA4C:				; CODE XREF: .text:0042BA43j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42BA5A
		add	dword ptr [ebp-10h], 1

loc_42BA5A:				; CODE XREF: .text:0042BA54j
		mov	edx, [ebp-10h]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_42BA66:				; CODE XREF: .text:0042B95Bj
					; .text:0042BA3Bj ...
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-0Ch], 0
		jmp	loc_42BBFD
; ---------------------------------------------------------------------------

loc_42BA87:				; CODE XREF: .text:0042BC03j
		cmp	dword ptr [ebp-0Ch], 1
		jnz	short loc_42BAA4
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_42BAA4
		mov	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_42BACA
; ---------------------------------------------------------------------------

loc_42BAA4:				; CODE XREF: .text:0042BA8Bj
					; .text:0042BA95j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_42BABA
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_42BABA
		add	dword ptr [ebp-10h], 1
		jmp	short loc_42BACA
; ---------------------------------------------------------------------------

loc_42BABA:				; CODE XREF: .text:0042BAA8j
					; .text:0042BAB2j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_42BACA
		mov	eax, 0FFFFFFFFh
		jmp	locret_42BC75
; ---------------------------------------------------------------------------

loc_42BACA:				; CODE XREF: .text:0042BAA2j
					; .text:0042BAB8j ...
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42BADE
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_42BB06

loc_42BADE:				; CODE XREF: .text:0042BAD2j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_42BAF2
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_42BB06

loc_42BAF2:				; CODE XREF: .text:0042BAE6j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_42BB54
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_42BB54

loc_42BB06:				; CODE XREF: .text:0042BADCj
					; .text:0042BAF0j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42BB20
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_42BB5E

loc_42BB20:				; CODE XREF: .text:0042BB11j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_42BB3A
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_42BB5E

loc_42BB3A:				; CODE XREF: .text:0042BB2Bj
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_42BB54
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	short loc_42BB5E

loc_42BB54:				; CODE XREF: .text:0042BAFAj
					; .text:0042BB04j ...
		mov	eax, 0FFFFFFFFh
		jmp	locret_42BC75
; ---------------------------------------------------------------------------

loc_42BB5E:				; CODE XREF: .text:0042BB1Ej
					; .text:0042BB38j ...
		mov	eax, [ebp-0Ch]
		mov	ecx, eax
		add	ecx, [ebp+0Ch]
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_42BB83
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_42BBAF
; ---------------------------------------------------------------------------

loc_42BB83:				; CODE XREF: .text:0042BB6Ej
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_42BB9E
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_42BBAD
; ---------------------------------------------------------------------------

loc_42BB9E:				; CODE XREF: .text:0042BB8Bj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_42BBAD:				; CODE XREF: .text:0042BB9Cj
		mov	edx, eax

loc_42BBAF:				; CODE XREF: .text:0042BB81j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_42BBCA
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_42BBF1
; ---------------------------------------------------------------------------

loc_42BBCA:				; CODE XREF: .text:0042BBBAj
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_42BBE5
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_42BBF1
; ---------------------------------------------------------------------------

loc_42BBE5:				; CODE XREF: .text:0042BBD5j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_42BBF1:				; CODE XREF: .text:0042BBC8j
					; .text:0042BBE3j
		add	eax, edx
		mov	[ecx], al
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 2

loc_42BBFD:				; CODE XREF: .text:0042BA82j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jb	loc_42BA87
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_42BC1A
		mov	eax, 0FFFFFFFFh
		jmp	short locret_42BC75
; ---------------------------------------------------------------------------

loc_42BC1A:				; CODE XREF: .text:0042BC11j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42BC4C
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_42BC45
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_42BC4C

loc_42BC45:				; CODE XREF: .text:0042BC2Cj
		mov	eax, 0FFFFFFFFh
		jmp	short locret_42BC75
; ---------------------------------------------------------------------------

loc_42BC4C:				; CODE XREF: .text:0042BC22j
					; .text:0042BC43j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jz	short loc_42BC5B
		mov	eax, 0FFFFFFFFh
		jmp	short locret_42BC75
; ---------------------------------------------------------------------------

loc_42BC5B:				; CODE XREF: .text:0042BC52j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42BC69
		add	dword ptr [ebp-10h], 1

loc_42BC69:				; CODE XREF: .text:0042BC63j
		mov	edx, [ebp-10h]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_42BC75:				; CODE XREF: .text:0042BAC5j
					; .text:0042BB59j ...
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42BC77	proc near		; CODE XREF: sub_42BDA4+22p
					; .text:0042BDEFp

var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jnz	short loc_42BCF3
		cmp	[ebp+arg_C], 0
		jz	short loc_42BC90
		mov	eax, 3
		jmp	short loc_42BC95
; ---------------------------------------------------------------------------

loc_42BC90:				; CODE XREF: sub_42BC77+10j
		mov	eax, 2

loc_42BC95:				; CODE XREF: sub_42BC77+17j
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		imul	eax, [ebp+arg_4]
		add	eax, 1
		mov	[ebp+var_18], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_42BCD5
		mov	eax, [ebp+var_18]
		sub	eax, 1
		mov	edx, 0
		div	[ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jz	short loc_42BCD5
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0
		jmp	locret_42BDA2
; ---------------------------------------------------------------------------

loc_42BCD5:				; CODE XREF: sub_42BC77+32j
					; sub_42BC77+45j
		mov	eax, [ebp+var_18]
		mov	[esp+28h+var_28], eax
		call	gcry_malloc
		mov	[ebp+arg_8], eax
		cmp	[ebp+arg_8], 0
		jnz	short loc_42BCF3
		mov	eax, 0
		jmp	locret_42BDA2
; ---------------------------------------------------------------------------

loc_42BCF3:				; CODE XREF: sub_42BC77+Aj
					; sub_42BC77+70j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		jmp	loc_42BD8F
; ---------------------------------------------------------------------------

loc_42BD04:				; CODE XREF: sub_42BC77+11Cj
		cmp	[ebp+arg_C], 0
		jz	short loc_42BD1C
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_0]
		jz	short loc_42BD1C
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	3Ah
		add	[ebp+var_10], 1

loc_42BD1C:				; CODE XREF: sub_42BC77+91j
					; sub_42BC77+99j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_42BD3E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 30h
		jmp	short loc_42BD4A
; ---------------------------------------------------------------------------

loc_42BD3E:				; CODE XREF: sub_42BC77+B7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 37h

loc_42BD4A:				; CODE XREF: sub_42BC77+C5j
		mov	edx, [ebp+var_10]
		mov	[edx], al
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_42BD72
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_42BD7E
; ---------------------------------------------------------------------------

loc_42BD72:				; CODE XREF: sub_42BC77+EBj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 37h

loc_42BD7E:				; CODE XREF: sub_42BC77+F9j
		mov	edx, [ebp+var_10]
		mov	[edx], al
		add	[ebp+var_10], 1
		sub	[ebp+arg_4], 1
		add	[ebp+var_C], 1

loc_42BD8F:				; CODE XREF: sub_42BC77+88j
		cmp	[ebp+arg_4], 0
		jnz	loc_42BD04
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_8]

locret_42BDA2:				; CODE XREF: sub_42BC77+59j
					; sub_42BC77+77j
		leave
		retn
sub_42BC77	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42BDA4	proc near		; CODE XREF: sub_4068D3+181p
					; sub_40EEAD+6Ep ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_42BC77
		leave
		retn
sub_42BDA4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 1
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42BC77
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42BDF6	proc near		; CODE XREF: .text:0042C0DAp
					; .text:0042C161p

C		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_18], 0
		cmp	[ebp+arg_C], 0
		jz	short loc_42BE18
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0

loc_42BE18:				; CODE XREF: sub_42BDF6+17j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_42BE2F
; ---------------------------------------------------------------------------

loc_42BE27:				; CODE XREF: sub_42BDF6+8Dj
					; sub_42BDF6+A7j ...
		add	[ebp+var_C], 2
		add	[ebp+var_14], 1

loc_42BE2F:				; CODE XREF: sub_42BDF6+2Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42BE43
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_42BE6B

loc_42BE43:				; CODE XREF: sub_42BDF6+41j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_42BE57
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_42BE6B

loc_42BE57:				; CODE XREF: sub_42BDF6+55j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_42BEBD
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_42BEBD

loc_42BE6B:				; CODE XREF: sub_42BDF6+4Bj
					; sub_42BDF6+5Fj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42BE85
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_42BE27

loc_42BE85:				; CODE XREF: sub_42BDF6+80j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_42BE9F
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_42BE27

loc_42BE9F:				; CODE XREF: sub_42BDF6+9Aj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_42BEBD
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	loc_42BE27

loc_42BEBD:				; CODE XREF: sub_42BDF6+69j
					; sub_42BDF6+73j ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42BEF2
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_42BEE8
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_42BEF2

loc_42BEE8:				; CODE XREF: sub_42BDF6+D9j
		mov	eax, 0
		jmp	locret_42C0B5
; ---------------------------------------------------------------------------

loc_42BEF2:				; CODE XREF: sub_42BDF6+CFj
					; sub_42BDF6+F0j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_0]
		jz	short loc_42BF14
		mov	eax, [ebp+var_C]
		sub	eax, 2
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jnz	short loc_42BF14
		mov	eax, [ebp+var_C]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	short loc_42BF1B

loc_42BF14:				; CODE XREF: sub_42BDF6+102j
					; sub_42BDF6+10Fj
		mov	eax, 1
		jmp	short loc_42BF20
; ---------------------------------------------------------------------------

loc_42BF1B:				; CODE XREF: sub_42BDF6+11Cj
		mov	eax, 0

loc_42BF20:				; CODE XREF: sub_42BDF6+123j
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_42BF2D
		add	[ebp+var_14], 1

loc_42BF2D:				; CODE XREF: sub_42BDF6+131j
		cmp	[ebp+arg_4], 0
		jz	loc_42C09F
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_8]
		jbe	short loc_42BF49
		mov	eax, 0
		jmp	locret_42C0B5
; ---------------------------------------------------------------------------

loc_42BF49:				; CODE XREF: sub_42BDF6+147j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_42BFFA
; ---------------------------------------------------------------------------

loc_42BF5B:				; CODE XREF: sub_42BDF6+258j
					; sub_42BDF6+276j ...
		mov	eax, [ebp+var_10]
		mov	ecx, eax
		add	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_42BF80
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_42BFAC
; ---------------------------------------------------------------------------

loc_42BF80:				; CODE XREF: sub_42BDF6+175j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_42BF9B
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_42BFAA
; ---------------------------------------------------------------------------

loc_42BF9B:				; CODE XREF: sub_42BDF6+192j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_42BFAA:				; CODE XREF: sub_42BDF6+1A3j
		mov	edx, eax

loc_42BFAC:				; CODE XREF: sub_42BDF6+188j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_42BFC7
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_42BFEE
; ---------------------------------------------------------------------------

loc_42BFC7:				; CODE XREF: sub_42BDF6+1C1j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_42BFE2
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_42BFEE
; ---------------------------------------------------------------------------

loc_42BFE2:				; CODE XREF: sub_42BDF6+1DCj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_42BFEE:				; CODE XREF: sub_42BDF6+1CFj
					; sub_42BDF6+1EAj
		add	eax, edx
		mov	[ecx], al
		add	[ebp+var_10], 1
		add	[ebp+var_C], 2

loc_42BFFA:				; CODE XREF: sub_42BDF6+160j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42C00E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_42C036

loc_42C00E:				; CODE XREF: sub_42BDF6+20Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_42C022
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_42C036

loc_42C022:				; CODE XREF: sub_42BDF6+220j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_42C090
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_42C090

loc_42C036:				; CODE XREF: sub_42BDF6+216j
					; sub_42BDF6+22Aj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42C054
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	loc_42BF5B

loc_42C054:				; CODE XREF: sub_42BDF6+24Bj
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_42C072
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	loc_42BF5B

loc_42C072:				; CODE XREF: sub_42BDF6+269j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_42C090
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	loc_42BF5B

loc_42C090:				; CODE XREF: sub_42BDF6+234j
					; sub_42BDF6+23Ej ...
		cmp	[ebp+var_18], 0
		jz	short loc_42C09F
		mov	eax, [ebp+var_10]
		add	eax, [ebp+arg_4]
		mov	byte ptr [eax],	0

loc_42C09F:				; CODE XREF: sub_42BDF6+13Bj
					; sub_42BDF6+29Ej
		cmp	[ebp+arg_C], 0
		jz	short loc_42C0B2
		mov	eax, [ebp+var_14]
		sub	eax, 1
		mov	edx, eax
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_42C0B2:				; CODE XREF: sub_42BDF6+2ADj
		mov	eax, [ebp+var_C]

locret_42C0B5:				; CODE XREF: sub_42BDF6+F7j
					; sub_42BDF6+14Ej
		leave
		retn
sub_42BDF6	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42BDF6
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_42C10B
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_42C0F7
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0

loc_42C0F7:				; CODE XREF: .text:0042C0ECj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	short locret_42C189
; ---------------------------------------------------------------------------

loc_42C10B:				; CODE XREF: .text:0042C0E6j
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_42C124
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+0Ch]
		mov	[eax], edx

loc_42C124:				; CODE XREF: .text:0042C10Fj
		mov	eax, [ebp-14h]
		add	eax, 1
		mov	[esp], eax
		call	gcry_malloc
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_42C142
		mov	eax, 0
		jmp	short locret_42C189
; ---------------------------------------------------------------------------

loc_42C142:				; CODE XREF: .text:0042C139j
		mov	eax, [ebp-14h]
		add	eax, 1
		mov	dword ptr [esp+0Ch], 0
		mov	[esp+8], eax
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42BDF6
		test	eax, eax
		jnz	short loc_42C186
		mov	dword ptr [esp+8], offset aHex2str_alloc ; "hex2str_alloc"
		mov	dword ptr [esp+4], 0F4h
		mov	dword ptr [esp], offset	a____Gnupg22_10	; "../../gnupg2-2.0.30/common/convert.c"
		call	sub_43CCB0
; ---------------------------------------------------------------------------

loc_42C186:				; CODE XREF: .text:0042C168j
		mov	eax, [ebp-10h]

locret_42C189:				; CODE XREF: .text:0042C109j
					; .text:0042C140j
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42C18C	proc near		; CODE XREF: sub_42C1B3+14p
					; .text:0042CFE8p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_42C1AC
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_42C1B1
; ---------------------------------------------------------------------------

loc_42C1AC:				; CODE XREF: sub_42C18C+7j
		mov	eax, 0

loc_42C1B1:				; CODE XREF: sub_42C18C+1Ej
		pop	ebp
		retn
sub_42C18C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42C1B3	proc near		; CODE XREF: sub_42C1CE+Ep
					; .text:0042C7AAp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_42C18C
		leave
		retn
sub_42C1B3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42C1CE	proc near		; CODE XREF: sub_42C47F+ECp
					; .text:0042CB9Cp ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_42C1B3
		leave
		retn
sub_42C1CE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42C1E3	proc near		; CODE XREF: .text:0042C218p
					; .text:0042C2C9p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0FFFFFFFFh
		cmp	[ebp+var_4], 0FFFFFFFFh
		jnz	short loc_42C1FD
		mov	[ebp+var_4], 100h

loc_42C1FD:				; CODE XREF: sub_42C1E3+11j
		cmp	[ebp+var_4], 7FFFFFFFh
		jnz	short loc_42C20D
		mov	[ebp+var_4], 100h

loc_42C20D:				; CODE XREF: sub_42C1E3+21j
		mov	eax, [ebp+var_4]
		leave
		retn
sub_42C1E3	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_42C1E3
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_42C295
		mov	dword ptr [ebp-14h], 0
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_42C28B
; ---------------------------------------------------------------------------

loc_42C235:				; CODE XREF: .text:0042C291j
		mov	eax, [ebp-14h]
		mov	[ebp-10h], eax
		jmp	short loc_42C25C
; ---------------------------------------------------------------------------

loc_42C23D:				; CODE XREF: .text:0042C26Aj
		mov	eax, [ebp-10h]
		shl	eax, 2
		add	eax, [ebp+0Ch]
		mov	eax, [eax]
		cmp	eax, [ebp-0Ch]
		jnz	short loc_42C258
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[ebp-14h], eax
		jmp	short loc_42C26C
; ---------------------------------------------------------------------------

loc_42C258:				; CODE XREF: .text:0042C24Bj
		add	dword ptr [ebp-10h], 1

loc_42C25C:				; CODE XREF: .text:0042C23Bj
		mov	eax, [ebp-10h]
		shl	eax, 2
		add	eax, [ebp+0Ch]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_42C23D

loc_42C26C:				; CODE XREF: .text:0042C256j
		mov	eax, [ebp-10h]
		shl	eax, 2
		add	eax, [ebp+0Ch]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_42C287
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	_close

loc_42C287:				; CODE XREF: .text:0042C27Aj
		add	dword ptr [ebp-0Ch], 1

loc_42C28B:				; CODE XREF: .text:0042C233j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp-18h]
		jl	short loc_42C235
		jmp	short loc_42C2B4
; ---------------------------------------------------------------------------

loc_42C295:				; CODE XREF: .text:0042C224j
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_42C2AC
; ---------------------------------------------------------------------------

loc_42C29D:				; CODE XREF: .text:0042C2B2j
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	_close
		add	dword ptr [ebp-0Ch], 1

loc_42C2AC:				; CODE XREF: .text:0042C29Bj
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp-18h]
		jl	short loc_42C29D

loc_42C2B4:				; CODE XREF: .text:0042C293j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		call	sub_42C1E3
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-10h], 20h
		mov	dword ptr [esp+4], 4
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	calloc
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_42C2FE
		mov	eax, 0
		jmp	locret_42C3C5
; ---------------------------------------------------------------------------

loc_42C2FE:				; CODE XREF: .text:0042C2F2j
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-14h], 0
		jmp	loc_42C3A7
; ---------------------------------------------------------------------------

loc_42C311:				; CODE XREF: .text:0042C3ADj
		lea	eax, [ebp-50h]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_42C338
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 9
		jz	short loc_42C3A3

loc_42C338:				; CODE XREF: .text:0042C328j
		mov	eax, [ebp-18h]
		add	eax, 1
		cmp	eax, [ebp-10h]
		jb	short loc_42C391
		cmp	dword ptr [ebp-10h], 0FFh
		ja	short loc_42C353
		mov	eax, 20h
		jmp	short loc_42C358
; ---------------------------------------------------------------------------

loc_42C353:				; CODE XREF: .text:0042C34Aj
		mov	eax, 100h

loc_42C358:				; CODE XREF: .text:0042C351j
		add	[ebp-10h], eax
		mov	eax, [ebp-10h]
		shl	eax, 2
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	realloc
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-20h], 0
		jnz	short loc_42C38B
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	free
		mov	eax, 0
		jmp	short locret_42C3C5
; ---------------------------------------------------------------------------

loc_42C38B:				; CODE XREF: .text:0042C377j
		mov	eax, [ebp-20h]
		mov	[ebp-0Ch], eax

loc_42C391:				; CODE XREF: .text:0042C341j
		mov	eax, [ebp-18h]
		shl	eax, 2
		add	eax, [ebp-0Ch]
		mov	edx, [ebp-14h]
		mov	[eax], edx
		add	dword ptr [ebp-18h], 1

loc_42C3A3:				; CODE XREF: .text:0042C336j
		add	dword ptr [ebp-14h], 1

loc_42C3A7:				; CODE XREF: .text:0042C30Cj
		mov	eax, [ebp-14h]
		cmp	eax, [ebp-1Ch]
		jl	loc_42C311
		mov	eax, [ebp-18h]
		shl	eax, 2
		add	eax, [ebp-0Ch]
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	eax, [ebp-0Ch]

locret_42C3C5:				; CODE XREF: .text:0042C2F9j
					; .text:0042C389j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42C3C7(int, char *)
sub_42C3C7	proc near		; CODE XREF: sub_42C47F+100p
					; sub_42C47F+130p

Str		= dword	ptr -28h
Control		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42C3F2
		mov	eax, [ebp+var_C]
		mov	word ptr [eax],	2222h
		mov	byte ptr [eax+2], 0
		add	[ebp+var_C], 2
		jmp	loc_42C47A
; ---------------------------------------------------------------------------

loc_42C3F2:				; CODE XREF: sub_42C3C7+14j
		mov	[esp+28h+Control], offset Control ; " \t\n\v"
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strpbrk
		test	eax, eax
		jz	short loc_42C465
		mov	eax, [ebp+var_C]
		mov	word ptr [eax],	22h
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		jmp	short loc_42C449
; ---------------------------------------------------------------------------

loc_42C41D:				; CODE XREF: sub_42C3C7+8Aj
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_42C445
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_42C445:				; CODE XREF: sub_42C3C7+6Dj
		add	[ebp+var_10], 1

loc_42C449:				; CODE XREF: sub_42C3C7+54j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42C41D
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	22h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		jmp	short loc_42C47A
; ---------------------------------------------------------------------------

loc_42C465:				; CODE XREF: sub_42C3C7+40j
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Control], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_43A1E9
		mov	[ebp+var_C], eax

loc_42C47A:				; CODE XREF: sub_42C3C7+26j
					; sub_42C3C7+9Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_42C3C7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42C47F(char *, int, int)
sub_42C47F	proc near		; CODE XREF: .text:0042C952p
					; .text:0042CC5Dp ...

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_10]
		add	eax, edx
		add	eax, 3
		mov	[ebp+var_10], eax
		jmp	short loc_42C4DA
; ---------------------------------------------------------------------------

loc_42C4C8:				; CODE XREF: sub_42C47F+63j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_42C4D6
		add	[ebp+var_10], 1

loc_42C4D6:				; CODE XREF: sub_42C47F+51j
		add	[ebp+var_14], 1

loc_42C4DA:				; CODE XREF: sub_42C47F+47j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42C4C8
		mov	[ebp+var_C], 0
		jmp	short loc_42C539
; ---------------------------------------------------------------------------

loc_42C4ED:				; CODE XREF: sub_42C47F+CCj
		mov	eax, [ebp+var_14]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+var_10]
		add	eax, edx
		add	eax, 3
		mov	[ebp+var_10], eax
		jmp	short loc_42C52B
; ---------------------------------------------------------------------------

loc_42C519:				; CODE XREF: sub_42C47F+B4j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_42C527
		add	[ebp+var_10], 1

loc_42C527:				; CODE XREF: sub_42C47F+A2j
		add	[ebp+var_14], 1

loc_42C52B:				; CODE XREF: sub_42C47F+98j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42C519
		add	[ebp+var_C], 1

loc_42C539:				; CODE XREF: sub_42C47F+6Cj
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_42C4ED
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	gcry_malloc
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_42C572
		call	sub_42C1CE
		jmp	short loc_42C5D7
; ---------------------------------------------------------------------------

loc_42C572:				; CODE XREF: sub_42C47F+EAj
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_44], eax ;	char *
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_42C3C7
		mov	[ebp+var_18], eax
		mov	[ebp+var_C], 0
		jmp	short loc_42C5BB
; ---------------------------------------------------------------------------

loc_42C590:				; CODE XREF: sub_42C47F+149j
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	20h
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+48h+var_44], eax ;	char *
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_48], eax ;	int
		call	sub_42C3C7
		mov	[ebp+var_18], eax
		add	[ebp+var_C], 1

loc_42C5BB:				; CODE XREF: sub_42C47F+10Fj
		mov	eax, [ebp+var_C]
		shl	eax, 2
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_42C590
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_1C]
		mov	[eax], edx
		mov	eax, 0

loc_42C5D7:				; CODE XREF: sub_42C47F+F1j
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_42C47F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42C5DD	proc near		; CODE XREF: .text:0042C7B8p
					; .text:0042C971p

hReadPipe	= dword	ptr -48h
hWritePipe	= dword	ptr -44h
lpPipeAttributes= dword	ptr -40h
nSize		= dword	ptr -3Ch
dwDesiredAccess	= dword	ptr -38h
bInheritHandle	= dword	ptr -34h
dwOptions	= dword	ptr -30h
PipeAttributes	= _SECURITY_ATTRIBUTES ptr -20h
TargetHandle	= dword	ptr -14h
hSourceHandle	= dword	ptr -10h
hObject		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 40h
		lea	eax, [ebp+PipeAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+PipeAttributes.nLength], 0Ch
		mov	[ebp+PipeAttributes.bInheritHandle], 0
		mov	[esp+48h+nSize], 0 ; nSize
		lea	eax, [ebp+PipeAttributes]
		mov	[esp+48h+lpPipeAttributes], eax	; lpPipeAttributes
		lea	eax, [ebp+hSourceHandle]
		mov	[esp+48h+hWritePipe], eax ; hWritePipe
		lea	eax, [ebp+hObject]
		mov	[esp+48h+hReadPipe], eax ; hReadPipe
		mov	eax, ds:CreatePipe
		call	eax ; CreatePipe
		sub	esp, 10h
		test	eax, eax
		jnz	short loc_42C63E
		mov	eax, 0FFFFFFFFh
		jmp	loc_42C6FC
; ---------------------------------------------------------------------------

loc_42C63E:				; CODE XREF: sub_42C5DD+55j
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	ebx, eax
		mov	esi, [ebp+hSourceHandle]
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp+48h+dwOptions], 2 ; dwOptions
		mov	[esp+48h+bInheritHandle], 1 ; bInheritHandle
		mov	[esp+48h+dwDesiredAccess], 0 ; dwDesiredAccess
		lea	edx, [ebp+TargetHandle]
		mov	[esp+48h+nSize], edx ; lpTargetHandle
		mov	[esp+48h+lpPipeAttributes], ebx	; hTargetProcessHandle
		mov	[esp+48h+hWritePipe], esi ; hSourceHandle
		mov	[esp+48h+hReadPipe], eax ; hSourceProcessHandle
		mov	eax, ds:DuplicateHandle
		call	eax ; DuplicateHandle
		sub	esp, 1Ch
		test	eax, eax
		jnz	short loc_42C6CC
		mov	[esp+48h+hReadPipe], 0FFFFFFFFh	; DWORD
		call	sub_439E46
		mov	[esp+48h+hWritePipe], eax ; char
		mov	[esp+48h+hReadPipe], offset aDuplicatehandl ; "DuplicateHandle failed: %s\n"
		call	sub_43CB21
		mov	eax, [ebp+hObject]
		mov	[esp+48h+hReadPipe], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+hSourceHandle]
		mov	[esp+48h+hReadPipe], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0FFFFFFFFh
		jmp	short loc_42C6FC
; ---------------------------------------------------------------------------

loc_42C6CC:				; CODE XREF: sub_42C5DD+AAj
		mov	eax, [ebp+hSourceHandle]
		mov	[esp+48h+hReadPipe], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+TargetHandle]
		mov	[ebp+hSourceHandle], eax
		mov	eax, [ebp+hObject]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+4]
		mov	eax, [ebp+hSourceHandle]
		mov	[edx], eax
		mov	eax, 0

loc_42C6FC:				; CODE XREF: sub_42C5DD+5Cj
					; sub_42C5DD+EDj
		lea	esp, [ebp-8]
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_42C5DD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42C703	proc near		; CODE XREF: .text:0042CCA9p
					; .text:0042CCC5p ...

lpFileName	= dword	ptr -38h
dwDesiredAccess	= dword	ptr -34h
dwShareMode	= dword	ptr -30h
lpSecurityAttributes= dword ptr	-2Ch
dwCreationDisposition= dword ptr -28h
dwFlagsAndAttributes= dword ptr	-24h
hTemplateFile	= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_0], 0
		jz	short loc_42C716
		mov	eax, 40000000h
		jmp	short loc_42C71B
; ---------------------------------------------------------------------------

loc_42C716:				; CODE XREF: sub_42C703+Aj
		mov	eax, 80000000h

loc_42C71B:				; CODE XREF: sub_42C703+11j
		mov	[esp+38h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+38h+dwFlagsAndAttributes],	0 ; dwFlagsAndAttributes
		mov	[esp+38h+dwCreationDisposition], 3 ; dwCreationDisposition
		mov	[esp+38h+lpSecurityAttributes],	0 ; lpSecurityAttributes
		mov	[esp+38h+dwShareMode], 3 ; dwShareMode
		mov	[esp+38h+dwDesiredAccess], eax ; dwDesiredAccess
		mov	[esp+38h+lpFileName], offset FileName ;	"nul"
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_42C77D
		mov	[esp+38h+lpFileName], 0FFFFFFFFh ; DWORD
		call	sub_439E46
		mov	[esp+38h+dwDesiredAccess], eax ; char
		mov	[esp+38h+lpFileName], offset aCanTOpenNulS ; "can't open `nul': %s\n"
		call	sub_43CBBE

loc_42C77D:				; CODE XREF: sub_42C703+5Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_42C703	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, [ebp+8]
		add	eax, 4
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	dword ptr [esp], 1
		call	sub_42C1B3
		mov	[ebp-0Ch], eax
		lea	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_42C5DD
		test	eax, eax
		jnz	loc_42C87A
		mov	eax, [ebp-14h]
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	edx, [ebp+8]
		mov	[edx], eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_42C80E
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aFailedToTran_0	; "failed to translate osfhandle %p\n"
		call	sub_43CB21
		mov	eax, [ebp-10h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		jmp	short loc_42C87A
; ---------------------------------------------------------------------------

loc_42C80E:				; CODE XREF: .text:0042C7E7j
		mov	eax, [ebp+8]
		lea	ebx, [eax+4]
		mov	eax, [ebp-10h]
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebx], eax
		mov	eax, [ebp+8]
		add	eax, 4
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_42C873
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aFailedToTran_0	; "failed to translate osfhandle %p\n"
		call	sub_43CB21
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[esp], eax
		call	_close
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	eax, [ebp-10h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		jmp	short loc_42C87A
; ---------------------------------------------------------------------------

loc_42C873:				; CODE XREF: .text:0042C836j
		mov	dword ptr [ebp-0Ch], 0

loc_42C87A:				; CODE XREF: .text:0042C7BFj
					; .text:0042C80Cj ...
		mov	eax, [ebp-0Ch]
		mov	ebx, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0B0h
		mov	dword ptr [ebp-38h], 0
		mov	dword ptr [ebp-34h], 0
		mov	dword ptr [ebp-30h], 0
		mov	dword ptr [ebp-2Ch], 0
		mov	eax, [ebp+20h]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+24h]
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	fflush
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	rewind
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	_fileno
		mov	[esp], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	_fileno
		mov	[esp], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	short loc_42C90D
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_42C919

loc_42C90D:				; CODE XREF: .text:0042C905j
		mov	dword ptr [esp], offset	aNoFileDescript	; "no file descriptor for file passed to g"...
		call	sub_43CB64
; ---------------------------------------------------------------------------

loc_42C919:				; CODE XREF: .text:0042C90Bj
		lea	eax, [ebp-28h]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	dword ptr [ebp-28h], 0Ch
		mov	dword ptr [ebp-20h], 0
		lea	eax, [ebp-80h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42C47F
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_42C968
		mov	eax, [ebp-14h]
		jmp	loc_42CBED
; ---------------------------------------------------------------------------

loc_42C968:				; CODE XREF: .text:0042C95Ej
		lea	eax, [ebp-88h]
		mov	[esp], eax
		call	sub_42C5DD
		test	eax, eax
		jz	short loc_42C9C1
		mov	dword ptr [esp], 1
		call	sub_42C1B3
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	dword ptr [esp], offset	aErrorCreatingA	; "error creating a pipe: %s\n"
		call	sub_43C238
		mov	[esp+4], ebx
		mov	[esp], eax
		call	sub_43CB21
		mov	eax, [ebp-80h]
		mov	[esp], eax
		call	gcry_free
		mov	eax, [ebp-14h]
		jmp	loc_42CBED
; ---------------------------------------------------------------------------

loc_42C9C1:				; CODE XREF: .text:0042C978j
		lea	eax, [ebp-7Ch]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 11h
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	dword ptr [ebp-7Ch], 44h
		mov	dword ptr [ebp-50h], 101h
		mov	word ptr [ebp-4Ch], 5
		mov	eax, [ebp-0Ch]
		mov	[ebp-44h], eax
		mov	eax, [ebp-10h]
		mov	[ebp-40h], eax
		mov	eax, [ebp-84h]
		mov	[ebp-3Ch], eax
		mov	eax, [ebp+1Ch]
		and	eax, 80h
		test	eax, eax
		jz	short loc_42CA12
		mov	ebx, 4000008h
		jmp	short loc_42CA17
; ---------------------------------------------------------------------------

loc_42CA12:				; CODE XREF: .text:0042CA09j
		mov	ebx, 4000000h

loc_42CA17:				; CODE XREF: .text:0042CA10j
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp], eax
		mov	eax, ds:GetPriorityClass
		call	eax ; GetPriorityClass
		sub	esp, 4
		or	eax, ebx
		or	eax, 4
		mov	[ebp-18h], eax
		mov	edx, [ebp-18h]
		mov	eax, [ebp-80h]
		lea	ecx, [ebp-38h]
		mov	[esp+24h], ecx
		lea	ecx, [ebp-7Ch]
		mov	[esp+20h], ecx
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+18h], 0
		mov	[esp+14h], edx
		mov	dword ptr [esp+10h], 1
		lea	edx, [ebp-28h]
		mov	[esp+0Ch], edx
		lea	edx, [ebp-28h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		mov	eax, ds:CreateProcessA
		call	eax ; CreateProcessA
		sub	esp, 28h
		test	eax, eax
		jnz	short loc_42CAE7
		mov	dword ptr [esp], 0FFFFFFFFh
		call	sub_439E46
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aCreateprocessF	; "CreateProcess failed: %s\n"
		call	sub_43CB21
		mov	eax, [ebp-80h]
		mov	[esp], eax
		call	gcry_free
		mov	eax, [ebp-88h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp-84h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	dword ptr [esp], 1
		call	sub_42C1B3
		jmp	loc_42CBED
; ---------------------------------------------------------------------------

loc_42CAE7:				; CODE XREF: .text:0042CA87j
		mov	eax, [ebp-80h]
		mov	[esp], eax
		call	gcry_free
		mov	dword ptr [ebp-80h], 0
		mov	eax, [ebp-84h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp+1Ch]
		and	eax, 40h
		test	eax, eax
		jz	short loc_42CB22
		mov	dword ptr [esp], 0FFFFFFFFh
		call	sub_4260FC

loc_42CB22:				; CODE XREF: .text:0042CB14j
		mov	eax, [ebp-34h]
		mov	[esp], eax
		mov	eax, ds:ResumeThread
		call	eax ; ResumeThread
		sub	esp, 4
		mov	eax, [ebp-34h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp-88h]
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebp-1Ch], eax
		cmp	dword ptr [ebp-1Ch], 0FFFFFFFFh
		jnz	short loc_42CB7B
		mov	eax, [ebp-88h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aFailedToTran_0	; "failed to translate osfhandle %p\n"
		call	sub_43CB21
		jmp	short loc_42CB93
; ---------------------------------------------------------------------------

loc_42CB7B:				; CODE XREF: .text:0042CB61j
		mov	dword ptr [esp+4], offset aR_1 ; "r"
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	_fdopen
		mov	edx, [ebp+20h]
		mov	[edx], eax

loc_42CB93:				; CODE XREF: .text:0042CB79j
		mov	eax, [ebp+20h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_42CBDE
		call	sub_42C1CE
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	dword ptr [esp], offset	aCanTFdopenPipe	; "can't fdopen pipe for reading: %s\n"
		call	sub_43C238
		mov	[esp+4], ebx
		mov	[esp], eax
		call	sub_43CB21
		mov	eax, [ebp-38h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp-14h]
		jmp	short loc_42CBED
; ---------------------------------------------------------------------------

loc_42CBDE:				; CODE XREF: .text:0042CB9Aj
		mov	eax, [ebp-38h]
		mov	edx, eax
		mov	eax, [ebp+24h]
		mov	[eax], edx
		mov	eax, 0

loc_42CBED:				; CODE XREF: .text:0042C963j
					; .text:0042C9BCj ...
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0B0h
		mov	dword ptr [ebp-2Ch], 0
		mov	dword ptr [ebp-28h], 0
		mov	dword ptr [ebp-24h], 0
		mov	dword ptr [ebp-20h], 0
		mov	eax, [ebp+1Ch]
		mov	dword ptr [eax], 0FFFFFFFFh
		lea	eax, [ebp-1Ch]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	dword ptr [ebp-1Ch], 0Ch
		mov	dword ptr [ebp-14h], 0
		lea	eax, [ebp-74h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42C47F
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_42CC73
		mov	eax, [ebp-0Ch]
		jmp	loc_42CE5C
; ---------------------------------------------------------------------------

loc_42CC73:				; CODE XREF: .text:0042CC69j
		lea	eax, [ebp-70h]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 11h
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	dword ptr [ebp-70h], 44h
		mov	dword ptr [ebp-44h], 101h
		mov	word ptr [ebp-40h], 5
		cmp	dword ptr [ebp+10h], 0FFFFFFFFh
		jnz	short loc_42CCB0
		mov	dword ptr [esp], 0
		call	sub_42C703
		jmp	short loc_42CCB5
; ---------------------------------------------------------------------------

loc_42CCB0:				; CODE XREF: .text:0042CCA0j
		mov	eax, 0FFFFFFFFh

loc_42CCB5:				; CODE XREF: .text:0042CCAEj
		mov	[ebp-80h], eax
		cmp	dword ptr [ebp+14h], 0FFFFFFFFh
		jnz	short loc_42CCCC
		mov	dword ptr [esp], 1
		call	sub_42C703
		jmp	short loc_42CCD1
; ---------------------------------------------------------------------------

loc_42CCCC:				; CODE XREF: .text:0042CCBCj
		mov	eax, 0FFFFFFFFh

loc_42CCD1:				; CODE XREF: .text:0042CCCAj
		mov	[ebp-7Ch], eax
		cmp	dword ptr [ebp+18h], 0FFFFFFFFh
		jnz	short loc_42CCE8
		mov	dword ptr [esp], 1
		call	sub_42C703
		jmp	short loc_42CCED
; ---------------------------------------------------------------------------

loc_42CCE8:				; CODE XREF: .text:0042CCD8j
		mov	eax, 0FFFFFFFFh

loc_42CCED:				; CODE XREF: .text:0042CCE6j
		mov	[ebp-78h], eax
		cmp	dword ptr [ebp+10h], 0FFFFFFFFh
		jnz	short loc_42CCFB
		mov	eax, [ebp-80h]
		jmp	short loc_42CD08
; ---------------------------------------------------------------------------

loc_42CCFB:				; CODE XREF: .text:0042CCF4j
		mov	eax, [ebp+10h]
		mov	[esp], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle

loc_42CD08:				; CODE XREF: .text:0042CCF9j
		mov	[ebp-38h], eax
		cmp	dword ptr [ebp+14h], 0FFFFFFFFh
		jnz	short loc_42CD16
		mov	eax, [ebp-7Ch]
		jmp	short loc_42CD23
; ---------------------------------------------------------------------------

loc_42CD16:				; CODE XREF: .text:0042CD0Fj
		mov	eax, [ebp+14h]
		mov	[esp], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle

loc_42CD23:				; CODE XREF: .text:0042CD14j
		mov	[ebp-34h], eax
		cmp	dword ptr [ebp+18h], 0FFFFFFFFh
		jnz	short loc_42CD31
		mov	eax, [ebp-78h]
		jmp	short loc_42CD3E
; ---------------------------------------------------------------------------

loc_42CD31:				; CODE XREF: .text:0042CD2Aj
		mov	eax, [ebp+18h]
		mov	[esp], eax
		mov	eax, ds:_get_osfhandle
		call	eax ; _get_osfhandle

loc_42CD3E:				; CODE XREF: .text:0042CD2Fj
		mov	[ebp-30h], eax
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp], eax
		mov	eax, ds:GetPriorityClass
		call	eax ; GetPriorityClass
		sub	esp, 4
		mov	ecx, eax
		or	ecx, 400000Ch
		mov	eax, [ebp-74h]
		lea	edx, [ebp-2Ch]
		mov	[esp+24h], edx
		lea	edx, [ebp-70h]
		mov	[esp+20h], edx
		mov	dword ptr [esp+1Ch], 0
		mov	dword ptr [esp+18h], 0
		mov	[esp+14h], ecx
		mov	dword ptr [esp+10h], 1
		lea	edx, [ebp-1Ch]
		mov	[esp+0Ch], edx
		lea	edx, [ebp-1Ch]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		mov	eax, ds:CreateProcessA
		call	eax ; CreateProcessA
		sub	esp, 28h
		test	eax, eax
		jnz	short loc_42CDDD
		mov	dword ptr [esp], 0FFFFFFFFh
		call	sub_439E46
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aCreateprocessF	; "CreateProcess failed: %s\n"
		call	sub_43CB21
		mov	dword ptr [esp], 1
		call	sub_42C1B3
		mov	[ebp-0Ch], eax
		jmp	short loc_42CDE4
; ---------------------------------------------------------------------------

loc_42CDDD:				; CODE XREF: .text:0042CDAEj
		mov	dword ptr [ebp-0Ch], 0

loc_42CDE4:				; CODE XREF: .text:0042CDDBj
		mov	eax, [ebp-74h]
		mov	[esp], eax
		call	gcry_free
		mov	dword ptr [ebp-10h], 0
		jmp	short loc_42CE1C
; ---------------------------------------------------------------------------

loc_42CDF8:				; CODE XREF: .text:0042CE20j
		mov	eax, [ebp-10h]
		mov	eax, [ebp+eax*4-80h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_42CE18
		mov	eax, [ebp-10h]
		mov	eax, [ebp+eax*4-80h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_42CE18:				; CODE XREF: .text:0042CE02j
		add	dword ptr [ebp-10h], 1

loc_42CE1C:				; CODE XREF: .text:0042CDF6j
		cmp	dword ptr [ebp-10h], 2
		jle	short loc_42CDF8
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_42CE2D
		mov	eax, [ebp-0Ch]
		jmp	short loc_42CE5C
; ---------------------------------------------------------------------------

loc_42CE2D:				; CODE XREF: .text:0042CE26j
		mov	eax, [ebp-28h]
		mov	[esp], eax
		mov	eax, ds:ResumeThread
		call	eax ; ResumeThread
		sub	esp, 4
		mov	eax, [ebp-28h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, [ebp-2Ch]
		mov	edx, eax
		mov	eax, [ebp+1Ch]
		mov	[eax], edx
		mov	eax, 0

loc_42CE5C:				; CODE XREF: .text:0042CC6Ej
					; .text:0042CE2Bj
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_42CE7F
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 0FFFFFFFFh

loc_42CE7F:				; CODE XREF: .text:0042CE74j
		cmp	dword ptr [ebp+0Ch], 0FFFFFFFFh
		jnz	short loc_42CE96
		mov	dword ptr [esp], 37h
		call	sub_42C1B3
		jmp	loc_42CFED
; ---------------------------------------------------------------------------

loc_42CE96:				; CODE XREF: .text:0042CE83j
		mov	dword ptr [esp+4], 0FFFFFFFFh
		mov	eax, [ebp-10h]
		mov	[esp], eax
		mov	eax, ds:WaitForSingleObject
		call	eax ; WaitForSingleObject
		sub	esp, 8
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_42CEC2
		test	eax, eax
		jz	short loc_42CEFB
		jmp	loc_42CFB8
; ---------------------------------------------------------------------------

loc_42CEC2:				; CODE XREF: .text:0042CEB7j
		mov	dword ptr [esp], 0FFFFFFFFh
		call	sub_439E46
		mov	ebx, eax
		mov	dword ptr [esp], offset	aWaitingForProc	; "waiting for process %d to terminate fai"...
		call	sub_43C238
		mov	[esp+8], ebx
		mov	edx, [ebp+0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_43CB21
		mov	dword ptr [ebp-0Ch], 1
		jmp	loc_42CFDA
; ---------------------------------------------------------------------------

loc_42CEFB:				; CODE XREF: .text:0042CEBBj
		lea	eax, [ebp-18h]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		mov	eax, ds:GetExitCodeProcess
		call	eax ; GetExitCodeProcess
		sub	esp, 8
		test	eax, eax
		jnz	short loc_42CF4C
		mov	dword ptr [esp], 0FFFFFFFFh
		call	sub_439E46
		mov	ebx, eax
		mov	dword ptr [esp], offset	aErrorGettingEx	; "error getting exit code of process %d: "...
		call	sub_43C238
		mov	[esp+8], ebx
		mov	edx, [ebp+0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_43CB21
		mov	dword ptr [ebp-0Ch], 1
		jmp	short loc_42CFA6
; ---------------------------------------------------------------------------

loc_42CF4C:				; CODE XREF: .text:0042CF14j
		mov	eax, [ebp-18h]
		test	eax, eax
		jz	short loc_42CF90
		mov	eax, [ebp-18h]
		mov	ebx, eax
		mov	dword ptr [esp], offset	aErrorRunningSE	; "error running `%s': exit status %d\n"
		call	sub_43C238
		mov	[esp+8], ebx
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_43CB21
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_42CF87
		mov	eax, [ebp-18h]
		mov	edx, eax
		mov	eax, [ebp+10h]
		mov	[eax], edx

loc_42CF87:				; CODE XREF: .text:0042CF7Bj
		mov	dword ptr [ebp-0Ch], 1
		jmp	short loc_42CFA6
; ---------------------------------------------------------------------------

loc_42CF90:				; CODE XREF: .text:0042CF51j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_42CF9F
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 0

loc_42CF9F:				; CODE XREF: .text:0042CF94j
		mov	dword ptr [ebp-0Ch], 0

loc_42CFA6:				; CODE XREF: .text:0042CF4Aj
					; .text:0042CF8Ej
		mov	eax, [ebp-10h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		jmp	short loc_42CFDA
; ---------------------------------------------------------------------------

loc_42CFB8:				; CODE XREF: .text:0042CEBDj
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aWaitforsingleo	; "WaitForSingleObject returned	unexpected"...
		call	sub_43CB21
		mov	dword ptr [ebp-0Ch], 1
		nop

loc_42CFDA:				; CODE XREF: .text:0042CEF6j
					; .text:0042CFB6j
		mov	eax, [ebp-0Ch]
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_42C18C

loc_42CFED:				; CODE XREF: .text:0042CE91j
		mov	ebx, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42CFF2(LPCSTR	lpApplicationName, int)
sub_42CFF2	proc near		; CODE XREF: sub_40729B+370p

hProcess	= dword	ptr -0A8h
lpCommandLine	= dword	ptr -0A4h
lpProcessAttributes= dword ptr -0A0h
lpThreadAttributes= dword ptr -9Ch
bInheritHandles	= dword	ptr -98h
dwCreationFlags	= dword	ptr -94h
lpEnvironment	= dword	ptr -90h
lpCurrentDirectory= dword ptr -8Ch
lpStartupInfo	= dword	ptr -88h
lpProcessInformation= dword ptr	-84h
var_74		= dword	ptr -74h
StartupInfo	= _STARTUPINFOA	ptr -70h
ProcessInformation= _PROCESS_INFORMATION ptr -2Ch
ProcessAttributes= _SECURITY_ATTRIBUTES	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
lpApplicationName= dword ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0A0h
		mov	[ebp+ProcessInformation.hProcess], 0
		mov	[ebp+ProcessInformation.hThread], 0
		mov	[ebp+ProcessInformation.dwProcessId], 0
		mov	[ebp+ProcessInformation.dwThreadId], 0
		mov	[esp+0A8h+lpCommandLine], 0
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+0A8h+hProcess], eax
		call	_access
		test	eax, eax
		jz	short loc_42D03A
		call	sub_42C1CE
		jmp	loc_42D180
; ---------------------------------------------------------------------------

loc_42D03A:				; CODE XREF: sub_42CFF2+3Cj
		lea	eax, [ebp+ProcessAttributes]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	[ebp+ProcessAttributes.nLength], 0Ch
		mov	[ebp+ProcessAttributes.bInheritHandle],	0
		lea	eax, [ebp+var_74]
		mov	[esp+0A8h+lpProcessAttributes],	eax ; int
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+lpCommandLine], eax ;	int
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+0A8h+hProcess], eax ; char	*
		call	sub_42C47F
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_42D089
		mov	eax, [ebp+var_C]
		jmp	loc_42D180
; ---------------------------------------------------------------------------

loc_42D089:				; CODE XREF: sub_42CFF2+8Dj
		lea	eax, [ebp+StartupInfo]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 11h
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	[ebp+StartupInfo.cb], 44h
		mov	[ebp+StartupInfo.dwFlags], 1
		mov	[ebp+StartupInfo.wShowWindow], 5
		mov	eax, ds:GetCurrentProcess
		call	eax ; GetCurrentProcess
		mov	[esp+0A8h+hProcess], eax ; hProcess
		mov	eax, ds:GetPriorityClass
		call	eax ; GetPriorityClass
		sub	esp, 4
		or	eax, 4000208h
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_74]
		lea	ecx, [ebp+ProcessInformation]
		mov	[esp+0A8h+lpProcessInformation], ecx ; lpProcessInformation
		lea	ecx, [ebp+StartupInfo]
		mov	[esp+0A8h+lpStartupInfo], ecx ;	lpStartupInfo
		mov	[esp+0A8h+lpCurrentDirectory], 0 ; lpCurrentDirectory
		mov	[esp+0A8h+lpEnvironment], 0 ; lpEnvironment
		mov	[esp+0A8h+dwCreationFlags], edx	; dwCreationFlags
		mov	[esp+0A8h+bInheritHandles], 0 ;	bInheritHandles
		lea	edx, [ebp+ProcessAttributes]
		mov	[esp+0A8h+lpThreadAttributes], edx ; lpThreadAttributes
		lea	edx, [ebp+ProcessAttributes]
		mov	[esp+0A8h+lpProcessAttributes],	edx ; lpProcessAttributes
		mov	[esp+0A8h+lpCommandLine], eax ;	lpCommandLine
		mov	eax, [ebp+lpApplicationName]
		mov	[esp+0A8h+hProcess], eax ; lpApplicationName
		mov	eax, ds:CreateProcessA
		call	eax ; CreateProcessA
		sub	esp, 28h
		test	eax, eax
		jnz	short loc_42D159
		mov	[esp+0A8h+hProcess], 0FFFFFFFFh	; DWORD
		call	sub_439E46
		mov	[esp+0A8h+lpCommandLine], eax ;	char
		mov	[esp+0A8h+hProcess], offset aCreateprocessD ; "CreateProcess(detached) failed: %s\n"
		call	sub_43CB21
		mov	eax, [ebp+var_74]
		mov	[esp+0A8h+hProcess], eax
		call	gcry_free
		mov	[esp+0A8h+hProcess], 1
		call	sub_42C1B3
		jmp	short loc_42D180
; ---------------------------------------------------------------------------

loc_42D159:				; CODE XREF: sub_42CFF2+130j
		mov	eax, [ebp+var_74]
		mov	[esp+0A8h+hProcess], eax
		call	gcry_free
		mov	[ebp+var_74], 0
		mov	eax, [ebp+ProcessInformation.hThread]
		mov	[esp+0A8h+hProcess], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0

loc_42D180:				; CODE XREF: sub_42CFF2+43j
					; sub_42CFF2+92j ...
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_42CFF2	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42D188	proc near		; CODE XREF: sub_42D42C+45p
					; sub_42D42C+C3p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_42D1A8
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_42D1AD
; ---------------------------------------------------------------------------

loc_42D1A8:				; CODE XREF: sub_42D188+7j
		mov	eax, 0

loc_42D1AD:				; CODE XREF: sub_42D188+1Ej
		pop	ebp
		retn
sub_42D188	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42D1AF	proc near		; CODE XREF: sub_42D1AF+19Bp
					; sub_42D39C+2Ap ...

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax

loc_42D1C1:				; CODE XREF: sub_42D1AF+45j
					; sub_42D1AF+1E6j
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_0], eax
		cmp	[ebp+var_10], 1
		ja	short loc_42D1D7
		mov	eax, 0
		jmp	locret_42D39A
; ---------------------------------------------------------------------------

loc_42D1D7:				; CODE XREF: sub_42D1AF+1Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42D1EB
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FFh
		jnz	short loc_42D1F6

loc_42D1EB:				; CODE XREF: sub_42D1AF+30j
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1
		nop
		jmp	short loc_42D1C1
; ---------------------------------------------------------------------------

loc_42D1F6:				; CODE XREF: sub_42D1AF+3Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 20h
		test	eax, eax
		setnz	al
		movzx	eax, al
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1Fh
		cmp	eax, 1Fh
		jnz	short loc_42D275
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1
		cmp	[ebp+var_10], 1
		ja	short loc_42D236
		mov	eax, 0
		jmp	locret_42D39A
; ---------------------------------------------------------------------------

loc_42D236:				; CODE XREF: sub_42D1AF+7Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1Fh
		cmp	eax, 1Fh
		jnz	short loc_42D251
		mov	eax, 0
		jmp	locret_42D39A
; ---------------------------------------------------------------------------

loc_42D251:				; CODE XREF: sub_42D1AF+96j
		mov	eax, [ebp+var_C]
		sub	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 8
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 7Fh
		or	eax, edx
		mov	[ebp+var_18], eax
		jmp	short loc_42D281
; ---------------------------------------------------------------------------

loc_42D275:				; CODE XREF: sub_42D1AF+6Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_18], eax

loc_42D281:				; CODE XREF: sub_42D1AF+C4j
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_14], eax
		add	[ebp+var_C], 2
		sub	[ebp+var_10], 2
		cmp	[ebp+var_14], 7Fh
		jbe	short loc_42D319
		cmp	[ebp+var_14], 81h
		jnz	short loc_42D2CD
		cmp	[ebp+var_10], 0
		jnz	short loc_42D2B7
		mov	eax, 0
		jmp	locret_42D39A
; ---------------------------------------------------------------------------

loc_42D2B7:				; CODE XREF: sub_42D1AF+FCj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_14], eax
		add	[ebp+var_C], 1
		sub	[ebp+var_10], 1
		jmp	short loc_42D319
; ---------------------------------------------------------------------------

loc_42D2CD:				; CODE XREF: sub_42D1AF+F6j
		cmp	[ebp+var_14], 82h
		jnz	short loc_42D30F
		cmp	[ebp+var_10], 1
		ja	short loc_42D2E6
		mov	eax, 0
		jmp	locret_42D39A
; ---------------------------------------------------------------------------

loc_42D2E6:				; CODE XREF: sub_42D1AF+12Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, eax
		shl	edx, 8
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		or	eax, edx
		mov	[ebp+var_14], eax
		add	[ebp+var_C], 2
		sub	[ebp+var_10], 2
		jmp	short loc_42D319
; ---------------------------------------------------------------------------

loc_42D30F:				; CODE XREF: sub_42D1AF+125j
		mov	eax, 0
		jmp	locret_42D39A
; ---------------------------------------------------------------------------

loc_42D319:				; CODE XREF: sub_42D1AF+EDj
					; sub_42D1AF+11Cj ...
		cmp	[ebp+var_1C], 0
		jz	short loc_42D365
		cmp	[ebp+arg_10], 63h
		jg	short loc_42D365
		mov	eax, [ebp+arg_10]
		add	eax, 1
		mov	[esp+48h+var_38], eax
		lea	eax, [ebp+var_24]
		mov	[esp+48h+var_3C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	sub_42D1AF
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_42D365
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		jmp	short locret_42D39A
; ---------------------------------------------------------------------------

loc_42D365:				; CODE XREF: sub_42D1AF+16Ej
					; sub_42D1AF+174j ...
		mov	eax, [ebp+var_18]
		cmp	eax, [ebp+arg_8]
		jnz	short loc_42D37A
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		jmp	short locret_42D39A
; ---------------------------------------------------------------------------

loc_42D37A:				; CODE XREF: sub_42D1AF+1BCj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_10]
		jbe	short loc_42D389
		mov	eax, 0
		jmp	short locret_42D39A
; ---------------------------------------------------------------------------

loc_42D389:				; CODE XREF: sub_42D1AF+1D1j
		mov	eax, [ebp+var_14]
		add	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		sub	[ebp+var_10], eax
		jmp	loc_42D1C1
; ---------------------------------------------------------------------------

locret_42D39A:				; CODE XREF: sub_42D1AF+23j
					; sub_42D1AF+82j ...
		leave
		retn
sub_42D1AF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42D39C	proc near		; CODE XREF: sub_41257F+1C4p
					; sub_41257F+216p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	[esp+38h+var_28], 0
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_42D1AF
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_42D3F3
		mov	eax, [ebp+arg_C]
		mov	edx, [eax]
		mov	ecx, [ebp+arg_0]
		mov	eax, [ebp+var_C]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	eax, [ebp+arg_4]
		cmp	edx, eax
		jbe	short loc_42D3F3
		mov	[ebp+var_C], 0

loc_42D3F3:				; CODE XREF: sub_42D39C+36j
					; sub_42D39C+4Ej
		mov	eax, [ebp+var_C]
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_42D39C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42D3FC	proc near		; CODE XREF: sub_40E65D+232p
					; sub_41075F+25Cp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_18], 0
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42D1AF
		leave
		retn
sub_42D3FC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42D42C	proc near		; CODE XREF: sub_40FEE5+147p
					; sub_40FEE5+223p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_18]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_1C]
		mov	dword ptr [eax], 0
		cmp	[ebp+var_C], 0
		jnz	short loc_42D47B
		mov	[esp+28h+var_24], 3FFFh
		mov	eax, [ebp+arg_20]
		mov	[esp+28h+var_28], eax
		call	sub_42D188
		jmp	locret_42D68C
; ---------------------------------------------------------------------------

loc_42D47B:				; CODE XREF: sub_42D42C+35j
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_18], eax
		add	[ebp+var_8], 1
		sub	[ebp+var_C], 1
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+var_18]
		and	eax, 0C0h
		mov	edx, eax
		sar	edx, 6
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_18]
		and	eax, 20h
		test	eax, eax
		setnz	al
		movzx	edx, al
		mov	eax, [ebp+arg_10]
		mov	[eax], edx
		mov	eax, [ebp+var_18]
		and	eax, 1Fh
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 1Fh
		jnz	short loc_42D52F
		mov	[ebp+var_4], 0

loc_42D4D7:				; CODE XREF: sub_42D42C+101j
		shl	[ebp+var_4], 7
		cmp	[ebp+var_C], 0
		jnz	short loc_42D4F9
		mov	[esp+28h+var_24], 3FFFh
		mov	eax, [ebp+arg_20]
		mov	[esp+28h+var_28], eax
		call	sub_42D188
		jmp	locret_42D68C
; ---------------------------------------------------------------------------

loc_42D4F9:				; CODE XREF: sub_42D42C+B3j
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_18], eax
		add	[ebp+var_8], 1
		sub	[ebp+var_C], 1
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+var_18]
		and	eax, 7Fh
		or	[ebp+var_4], eax
		mov	eax, [ebp+var_18]
		and	eax, 80h
		test	eax, eax
		jnz	short loc_42D4D7

loc_42D52F:				; CODE XREF: sub_42D42C+A2j
		mov	edx, [ebp+var_4]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		cmp	[ebp+var_C], 0
		jnz	short loc_42D555
		mov	[esp+28h+var_24], 3FFFh
		mov	eax, [ebp+arg_20]
		mov	[esp+28h+var_28], eax
		call	sub_42D188
		jmp	locret_42D68C
; ---------------------------------------------------------------------------

loc_42D555:				; CODE XREF: sub_42D42C+10Fj
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_18], eax
		add	[ebp+var_8], 1
		sub	[ebp+var_C], 1
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+var_18]
		and	eax, 80h
		test	eax, eax
		jnz	short loc_42D58F
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+arg_18]
		mov	[eax], edx
		jmp	loc_42D65C
; ---------------------------------------------------------------------------

loc_42D58F:				; CODE XREF: sub_42D42C+154j
		cmp	[ebp+var_18], 80h
		jnz	short loc_42D5A6
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 1
		jmp	loc_42D65C
; ---------------------------------------------------------------------------

loc_42D5A6:				; CODE XREF: sub_42D42C+16Aj
		cmp	[ebp+var_18], 0FFh
		jnz	short loc_42D5C7
		mov	[esp+28h+var_24], 86h
		mov	eax, [ebp+arg_20]
		mov	[esp+28h+var_28], eax
		call	sub_42D188
		jmp	locret_42D68C
; ---------------------------------------------------------------------------

loc_42D5C7:				; CODE XREF: sub_42D42C+181j
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_18]
		and	eax, 7Fh
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		cmp	eax, 4
		ja	short loc_42D5E7
		mov	eax, [ebp+var_14]
		cmp	eax, 4
		jbe	short loc_42D64E

loc_42D5E7:				; CODE XREF: sub_42D42C+1B1j
		mov	[esp+28h+var_24], 86h
		mov	eax, [ebp+arg_20]
		mov	[esp+28h+var_28], eax
		call	sub_42D188
		jmp	locret_42D68C
; ---------------------------------------------------------------------------

loc_42D5FF:				; CODE XREF: sub_42D42C+226j
		shl	[ebp+var_10], 8
		cmp	[ebp+var_C], 0
		jnz	short loc_42D61E
		mov	[esp+28h+var_24], 3FFFh
		mov	eax, [ebp+arg_20]
		mov	[esp+28h+var_28], eax
		call	sub_42D188
		jmp	short locret_42D68C
; ---------------------------------------------------------------------------

loc_42D61E:				; CODE XREF: sub_42D42C+1DBj
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[ebp+var_18], eax
		add	[ebp+var_8], 1
		sub	[ebp+var_C], 1
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+var_18]
		and	eax, 0FFh
		or	[ebp+var_10], eax
		sub	[ebp+var_14], 1

loc_42D64E:				; CODE XREF: sub_42D42C+1B9j
		cmp	[ebp+var_14], 0
		jnz	short loc_42D5FF
		mov	eax, [ebp+arg_18]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_42D65C:				; CODE XREF: sub_42D42C+15Ej
					; sub_42D42C+175j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_42D677
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_42D677
		mov	eax, [ebp+arg_18]
		mov	dword ptr [eax], 0

loc_42D677:				; CODE XREF: sub_42D42C+237j
					; sub_42D42C+240j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_8]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, 0

locret_42D68C:				; CODE XREF: sub_42D42C+4Aj
					; sub_42D42C+C8j ...
		leave
		retn
sub_42D42C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42D68E	proc near		; CODE XREF: sub_415770+122p
					; sub_415770+15Ep ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		cmp	[ebp+var_8], 0
		jnz	short loc_42D6E4
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_42D6DA
		mov	[esp+18h+var_14], 53h
		mov	eax, [ebp+arg_14]
		mov	[esp+18h+var_18], eax
		call	sub_42D188
		jmp	short loc_42D6DF
; ---------------------------------------------------------------------------

loc_42D6DA:				; CODE XREF: sub_42D68E+35j
		mov	eax, 0

loc_42D6DF:				; CODE XREF: sub_42D68E+4Aj
		jmp	locret_42D859
; ---------------------------------------------------------------------------

loc_42D6E4:				; CODE XREF: sub_42D68E+2Cj
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jnz	short loc_42D71D
		add	[ebp+var_4], 1
		sub	[ebp+var_8], 1
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_4]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_8]
		mov	[eax], edx
		mov	eax, 0
		jmp	locret_42D859
; ---------------------------------------------------------------------------

loc_42D71D:				; CODE XREF: sub_42D68E+5Ej
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jnz	short loc_42D780
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_42D748
		mov	[esp+18h+var_14], 53h
		mov	eax, [ebp+arg_14]
		mov	[esp+18h+var_18], eax
		call	sub_42D188
		jmp	locret_42D859
; ---------------------------------------------------------------------------

loc_42D748:				; CODE XREF: sub_42D68E+A0j
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 1
		add	[ebp+var_4], 1
		sub	[ebp+var_8], 1
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_4]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_8]
		mov	[eax], edx
		mov	eax, 0
		jmp	locret_42D859
; ---------------------------------------------------------------------------

loc_42D780:				; CODE XREF: sub_42D68E+97j
		mov	[ebp+var_C], 0
		jmp	short loc_42D7B0
; ---------------------------------------------------------------------------

loc_42D789:				; CODE XREF: sub_42D68E+14Ej
		mov	edx, [ebp+var_C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		add	eax, edx
		sub	eax, 30h
		mov	[ebp+var_C], eax
		add	[ebp+var_4], 1
		sub	[ebp+var_8], 1

loc_42D7B0:				; CODE XREF: sub_42D68E+F9j
		cmp	[ebp+var_8], 0
		jz	short loc_42D7DE
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42D7DE
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_42D7DE
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_42D7DE
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jbe	short loc_42D789

loc_42D7DE:				; CODE XREF: sub_42D68E+126j
					; sub_42D68E+130j ...
		cmp	[ebp+var_8], 0
		jz	short loc_42D7EE
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_42D803

loc_42D7EE:				; CODE XREF: sub_42D68E+154j
		mov	[esp+18h+var_14], 53h
		mov	eax, [ebp+arg_14]
		mov	[esp+18h+var_18], eax
		call	sub_42D188
		jmp	short locret_42D859
; ---------------------------------------------------------------------------

loc_42D803:				; CODE XREF: sub_42D68E+15Ej
		add	[ebp+var_4], 1
		sub	[ebp+var_8], 1
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+var_8]
		jbe	short loc_42D828
		mov	[esp+18h+var_14], 53h
		mov	eax, [ebp+arg_14]
		mov	[esp+18h+var_18], eax
		call	sub_42D188
		jmp	short locret_42D859
; ---------------------------------------------------------------------------

loc_42D828:				; CODE XREF: sub_42D68E+183j
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_4]
		mov	[eax], edx
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		add	[ebp+var_4], eax
		mov	eax, [ebp+var_C]
		sub	[ebp+var_8], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_4]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_8]
		mov	[eax], edx
		mov	eax, 0

locret_42D859:				; CODE XREF: sub_42D68E:loc_42D6DFj
					; sub_42D68E+8Aj ...
		leave
		retn
sub_42D68E	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42D85C(FILE *, int, int, int)
sub_42D85C	proc near		; CODE XREF: sub_412250+63p

File		= dword	ptr -38h
var_34		= dword	ptr -34h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		cmp	[ebp+arg_C], 0
		jz	short loc_42D886
		mov	eax, [ebp+arg_C]
		mov	eax, [eax]
		jmp	short loc_42D88B
; ---------------------------------------------------------------------------

loc_42D886:				; CODE XREF: sub_42D85C+21j
		mov	eax, 0

loc_42D88B:				; CODE XREF: sub_42D85C+28j
		mov	[ebp+var_20], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_42D8E1
		mov	[ebp+var_14], 100h
		mov	eax, [ebp+var_14]
		mov	[esp+38h+File],	eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		cmp	[ebp+var_10], 0
		jnz	short loc_42D8D9
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_C], 0
		jz	short loc_42D8CF
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0

loc_42D8CF:				; CODE XREF: sub_42D85C+68j
		mov	eax, 0FFFFFFFFh
		jmp	locret_42DA26
; ---------------------------------------------------------------------------

loc_42D8D9:				; CODE XREF: sub_42D85C+59j
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_14]
		mov	[eax], edx

loc_42D8E1:				; CODE XREF: sub_42D85C+36j
		sub	[ebp+var_14], 3
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], eax
		jmp	loc_42D9FF
; ---------------------------------------------------------------------------

loc_42D8F0:				; CODE XREF: sub_42D85C+1B5j
		mov	eax, [ebp+var_18]
		cmp	eax, [ebp+var_14]
		jnz	loc_42D9E7
		cmp	[ebp+var_20], 0
		jz	short loc_42D94A
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_20]
		jbe	short loc_42D94A

loc_42D90A:				; CODE XREF: sub_42D85C+C6j
		cmp	[ebp+var_C], 0Ah
		jz	short loc_42D924
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+File],	eax ; File
		call	getc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_42D90A

loc_42D924:				; CODE XREF: sub_42D85C+B2j
		mov	eax, [ebp+var_1C]
		mov	byte ptr [eax],	0Ah
		add	[ebp+var_1C], 1
		add	[ebp+var_18], 1
		cmp	[ebp+arg_C], 0
		jz	loc_42DA19
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		jmp	loc_42DA19
; ---------------------------------------------------------------------------

loc_42D94A:				; CODE XREF: sub_42D85C+A4j
					; sub_42D85C+ACj
		add	[ebp+var_14], 3
		cmp	[ebp+var_14], 3FFh
		ja	short loc_42D95E
		mov	eax, 100h
		jmp	short loc_42D963
; ---------------------------------------------------------------------------

loc_42D95E:				; CODE XREF: sub_42D85C+F9j
		mov	eax, 400h

loc_42D963:				; CODE XREF: sub_42D85C+100j
		add	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+File],	eax
		call	gcry_realloc
		mov	edx, [ebp+arg_4]
		mov	[edx], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_42D9C8
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+File],	eax
		call	gcry_free
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		cmp	[ebp+arg_C], 0
		jz	short loc_42D9B5
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0

loc_42D9B5:				; CODE XREF: sub_42D85C+14Ej
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_24]
		mov	[eax], edx
		mov	eax, 0FFFFFFFFh
		jmp	short locret_42DA26
; ---------------------------------------------------------------------------

loc_42D9C8:				; CODE XREF: sub_42D85C+128j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		sub	[ebp+var_14], 3
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_10]
		add	eax, edx
		mov	[ebp+var_1C], eax

loc_42D9E7:				; CODE XREF: sub_42D85C+9Aj
		mov	eax, [ebp+var_C]
		mov	edx, eax
		mov	eax, [ebp+var_1C]
		mov	[eax], dl
		add	[ebp+var_1C], 1
		add	[ebp+var_18], 1
		cmp	[ebp+var_C], 0Ah
		jz	short loc_42DA1C

loc_42D9FF:				; CODE XREF: sub_42D85C+8Fj
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+File],	eax ; File
		call	getc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	loc_42D8F0
		jmp	short loc_42DA1D
; ---------------------------------------------------------------------------

loc_42DA19:				; CODE XREF: sub_42D85C+DAj
					; sub_42D85C+E9j
		nop
		jmp	short loc_42DA1D
; ---------------------------------------------------------------------------

loc_42DA1C:				; CODE XREF: sub_42D85C+1A1j
		nop

loc_42DA1D:				; CODE XREF: sub_42D85C+1BBj
					; sub_42D85C+1BEj
		mov	eax, [ebp+var_1C]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_18]

locret_42DA26:				; CODE XREF: sub_42D85C+78j
					; sub_42D85C+16Aj
		leave
		retn
sub_42D85C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42DA28	proc near		; CODE XREF: sub_42DA4F+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_42DA48
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_42DA4D
; ---------------------------------------------------------------------------

loc_42DA48:				; CODE XREF: sub_42DA28+7j
		mov	eax, 0

loc_42DA4D:				; CODE XREF: sub_42DA28+1Ej
		pop	ebp
		retn
sub_42DA28	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42DA4F	proc near		; CODE XREF: sub_42DA6A+Ep
					; sub_42DB08+57p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_42DA28
		leave
		retn
sub_42DA4F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42DA6A	proc near		; CODE XREF: .text:0042DD2Dp

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_42DA4F
		leave
		retn
sub_42DA6A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42DA7F	proc near		; CODE XREF: sub_42DB08+64p
					; .text:0042E157p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_4], eax
		mov	[ebp+var_8], 0
		jmp	short loc_42DAB9
; ---------------------------------------------------------------------------

loc_42DA96:				; CODE XREF: sub_42DA7F+60j
		mov	edx, [ebp+var_8]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_8], eax
		add	[ebp+var_4], 1

loc_42DAB9:				; CODE XREF: sub_42DA7F+15j
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42DAE1
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_42DAE1
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_42DAE1
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jbe	short loc_42DA96

loc_42DAE1:				; CODE XREF: sub_42DA7F+42j
					; sub_42DA7F+4Cj ...
		cmp	[ebp+var_8], 0
		jz	short loc_42DAF1
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_42DAF8

loc_42DAF1:				; CODE XREF: sub_42DA7F+66j
		mov	eax, 0
		jmp	short locret_42DB06
; ---------------------------------------------------------------------------

loc_42DAF8:				; CODE XREF: sub_42DA7F+70j
		mov	eax, [ebp+var_4]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+var_8]

locret_42DB06:				; CODE XREF: sub_42DA7F+77j
		leave
		retn
sub_42DA7F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42DB08	proc near		; CODE XREF: .text:0042E1C8p

var_14		= dword	ptr -14h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+var_4], eax
		jmp	short loc_42DB91
; ---------------------------------------------------------------------------

loc_42DB20:				; CODE XREF: sub_42DB08+8Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jnz	short loc_42DB39
		add	[ebp+var_4], 1
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+var_C], eax
		jmp	short loc_42DB91
; ---------------------------------------------------------------------------

loc_42DB39:				; CODE XREF: sub_42DB08+20j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 29h
		jnz	short loc_42DB52
		sub	[ebp+var_4], 1
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+var_C], eax
		jmp	short loc_42DB91
; ---------------------------------------------------------------------------

loc_42DB52:				; CODE XREF: sub_42DB08+39j
		cmp	[ebp+var_4], 0
		jnz	short loc_42DB66
		mov	[esp+14h+var_14], 53h
		call	sub_42DA4F
		jmp	short locret_42DBAC
; ---------------------------------------------------------------------------

loc_42DB66:				; CODE XREF: sub_42DB08+4Ej
		lea	eax, [ebp+var_C]
		mov	[esp+14h+var_14], eax
		call	sub_42DA7F
		mov	[ebp+var_8], eax
		cmp	[ebp+var_8], 0
		jnz	short loc_42DB88
		mov	[esp+14h+var_14], 53h
		call	sub_42DA4F
		jmp	short locret_42DBAC
; ---------------------------------------------------------------------------

loc_42DB88:				; CODE XREF: sub_42DB08+70j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_8]
		mov	[ebp+var_C], eax

loc_42DB91:				; CODE XREF: sub_42DB08+16j
					; sub_42DB08+2Fj ...
		cmp	[ebp+var_4], 0
		jg	short loc_42DB20
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_4]
		mov	[eax], edx
		mov	eax, 0

locret_42DBAC:				; CODE XREF: sub_42DB08+5Cj
					; sub_42DB08+7Ej
		leave
		retn
sub_42DB08	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42DBAE(int, int, void	*)
sub_42DBAE	proc near		; CODE XREF: .text:0042E184p
					; .text:0042E22Fp

Buf1		= dword	ptr -38h
Buf2		= dword	ptr -34h
Size		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		cmp	eax, [ebp+var_C]
		jnz	short loc_42DBFE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Size],	edx ; Size
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Buf2],	edx ; Buf2
		mov	[esp+38h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jz	short loc_42DC05

loc_42DBFE:				; CODE XREF: sub_42DBAE+2Fj
		mov	eax, 0
		jmp	short loc_42DC19
; ---------------------------------------------------------------------------

loc_42DC05:				; CODE XREF: sub_42DBAE+4Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, 1

loc_42DC19:				; CODE XREF: sub_42DBAE+55j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_42DBAE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42DC1F	proc near		; CODE XREF: .text:0042DFBDp

var_14		= dword	ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		mov	[ebp+var_4], eax
		cmp	[ebp+arg_4], 2
		jbe	short loc_42DC9C
		sub	[ebp+var_4], 1
		mov	eax, [ebp+var_4]
		mov	byte ptr [eax],	0
		sub	[ebp+var_4], 1
		mov	eax, [ebp+var_4]
		mov	byte ptr [eax],	3Ah

loc_42DC4A:				; CODE XREF: sub_42DC1F+7Bj
		sub	[ebp+var_4], 1
		mov	ecx, [ebp+arg_8]
		mov	edx, 0CCCCCCCDh
		mov	eax, ecx
		mul	edx
		shr	edx, 3
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_4]
		mov	[eax], dl
		mov	ecx, [ebp+arg_8]
		mov	[ebp+var_14], ecx
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_14]
		mul	edx
		mov	eax, edx
		shr	eax, 3
		mov	[ebp+arg_8], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_42DC9C
		mov	eax, [ebp+var_4]
		cmp	eax, [ebp+arg_0]
		ja	short loc_42DC4A

loc_42DC9C:				; CODE XREF: sub_42DC1F+15j
					; sub_42DC1F+73j
		cmp	[ebp+arg_C], 0
		jz	short loc_42DCBC
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		mov	edx, eax
		mov	eax, [ebp+var_4]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_42DCBC:				; CODE XREF: sub_42DC1F+81j
		mov	eax, [ebp+var_4]
		leave
		retn
sub_42DC1F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_42DCDF
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 0

loc_42DCDF:				; CODE XREF: .text:0042DCD4j
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	gcry_sexp_sprint
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_42DD19
		mov	dword ptr [esp], 3Bh
		call	sub_42DA4F
		jmp	short locret_42DD87
; ---------------------------------------------------------------------------

loc_42DD19:				; CODE XREF: .text:0042DD09j
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	gcry_malloc
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_42DD34
		call	sub_42DA6A
		jmp	short locret_42DD87
; ---------------------------------------------------------------------------

loc_42DD34:				; CODE XREF: .text:0042DD2Bj
		mov	eax, [ebp-0Ch]
		mov	[esp+0Ch], eax
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	gcry_sexp_sprint
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_42DD6C
		mov	dword ptr [esp], 3Bh
		call	sub_42DA4F
		jmp	short locret_42DD87
; ---------------------------------------------------------------------------

loc_42DD6C:				; CODE XREF: .text:0042DD5Cj
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp-10h]
		mov	[eax], edx
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_42DD82
		mov	eax, [ebp+10h]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx

loc_42DD82:				; CODE XREF: .text:0042DD78j
		mov	eax, 0

locret_42DD87:				; CODE XREF: .text:0042DD17j
					; .text:0042DD32j ...
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42DD89	proc near		; CODE XREF: sub_412BF2+C6p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jnz	short loc_42DDA3
		mov	[esp+28h+var_28], 37h
		call	sub_42DA4F
		jmp	short locret_42DE05
; ---------------------------------------------------------------------------

loc_42DDA3:				; CODE XREF: sub_42DD89+Aj
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+var_24], 0
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gcry_sexp_sscan
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_42DDD2
		mov	eax, [ebp+var_C]
		jmp	short locret_42DE05
; ---------------------------------------------------------------------------

loc_42DDD2:				; CODE XREF: sub_42DD89+42j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	gcry_pk_get_keygrip
		test	eax, eax
		jnz	short loc_42DDF7
		mov	[esp+28h+var_28], 3Fh
		call	sub_42DA4F
		mov	[ebp+var_C], eax

loc_42DDF7:				; CODE XREF: sub_42DD89+5Dj
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gcry_sexp_release
		mov	eax, [ebp+var_C]

locret_42DE05:				; CODE XREF: sub_42DD89+18j
					; sub_42DD89+47j
		leave
		retn
sub_42DD89	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_42DE2F
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_42DE2F
		mov	eax, 0
		jmp	locret_42DF1A
; ---------------------------------------------------------------------------

loc_42DE2F:				; CODE XREF: .text:0042DE1Dj
					; .text:0042DE23j
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_42DE3B
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_42DE45

loc_42DE3B:				; CODE XREF: .text:0042DE33j
		mov	eax, 1
		jmp	locret_42DF1A
; ---------------------------------------------------------------------------

loc_42DE45:				; CODE XREF: .text:0042DE39j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jnz	short loc_42DE59
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_42DE65

loc_42DE59:				; CODE XREF: .text:0042DE4Dj
		mov	dword ptr [esp], offset	aInvalidSExpInC	; "invalid S-exp in cmp_simple_canon_sexp\"...
		call	sub_43CB91
; ---------------------------------------------------------------------------

loc_42DE65:				; CODE XREF: .text:0042DE57j
		add	dword ptr [ebp-0Ch], 1
		mov	dword ptr [esp+8], 0Ah
		lea	eax, [ebp-1Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	strtoul
		mov	[ebp-14h], eax
		mov	eax, [ebp-1Ch]
		mov	[ebp-0Ch], eax
		add	dword ptr [ebp-10h], 1
		mov	dword ptr [esp+8], 0Ah
		lea	eax, [ebp-1Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	strtoul
		mov	[ebp-18h], eax
		mov	eax, [ebp-1Ch]
		mov	[ebp-10h], eax
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_42DEC7
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_42DED3

loc_42DEC7:				; CODE XREF: .text:0042DEBBj
		mov	dword ptr [esp], offset	aInvalidSExpInC	; "invalid S-exp in cmp_simple_canon_sexp\"...
		call	sub_43CB91
; ---------------------------------------------------------------------------

loc_42DED3:				; CODE XREF: .text:0042DEC5j
		mov	eax, [ebp-14h]
		cmp	eax, [ebp-18h]
		jz	short loc_42DEE2
		mov	eax, 1
		jmp	short locret_42DF1A
; ---------------------------------------------------------------------------

loc_42DEE2:				; CODE XREF: .text:0042DED9j
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_42DF0F
; ---------------------------------------------------------------------------

loc_42DEEC:				; CODE XREF: .text:0042DF13j
		mov	eax, [ebp-0Ch]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_42DF03
		mov	eax, 1
		jmp	short locret_42DF1A
; ---------------------------------------------------------------------------

loc_42DF03:				; CODE XREF: .text:0042DEFAj
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1

loc_42DF0F:				; CODE XREF: .text:0042DEEAj
		cmp	dword ptr [ebp-14h], 0
		jnz	short loc_42DEEC
		mov	eax, 0

locret_42DF1A:				; CODE XREF: .text:0042DE2Aj
					; .text:0042DE40j ...
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		jmp	short loc_42DF39
; ---------------------------------------------------------------------------

loc_42DF31:				; CODE XREF: .text:0042DF4Bj
					; .text:0042DF5Fj ...
		add	dword ptr [ebp-10h], 1
		add	dword ptr [ebp-0Ch], 1

loc_42DF39:				; CODE XREF: .text:0042DF2Fj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_42DF4D
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_42DF31

loc_42DF4D:				; CODE XREF: .text:0042DF41j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_42DF61
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jle	short loc_42DF31

loc_42DF61:				; CODE XREF: .text:0042DF55j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_42DF75
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jle	short loc_42DF31

loc_42DF75:				; CODE XREF: .text:0042DF69j
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_42DF83
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx

loc_42DF83:				; CODE XREF: .text:0042DF79j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_42DF93
		mov	eax, 0
		jmp	locret_42E11F
; ---------------------------------------------------------------------------

loc_42DF93:				; CODE XREF: .text:0042DF87j
		mov	eax, [ebp-0Ch]
		add	eax, 1
		and	eax, 0FFFFFFFEh
		shr	eax, 1
		mov	[ebp-18h], eax
		lea	eax, [ebp-58h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp-18h]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 32h
		lea	eax, [ebp-52h]
		mov	[esp], eax
		call	sub_42DC1F
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-58h]
		add	eax, [ebp-18h]
		add	eax, 3
		mov	[esp], eax
		call	gcry_malloc
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-20h], 0
		jnz	short loc_42DFE9
		mov	eax, 0
		jmp	locret_42E11F
; ---------------------------------------------------------------------------

loc_42DFE9:				; CODE XREF: .text:0042DFDDj
		mov	eax, [ebp-20h]
		mov	byte ptr [eax],	28h
		mov	eax, [ebp-20h]
		lea	edx, [eax+1]
		mov	eax, [ebp-1Ch]
		mov	[esp+4], eax
		mov	[esp], edx
		call	sub_43A1E9
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		mov	eax, [ebp-0Ch]
		and	eax, 1
		test	al, al
		jz	loc_42E102
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_42E030
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_42E04E
; ---------------------------------------------------------------------------

loc_42E030:				; CODE XREF: .text:0042E023j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_42E045
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_42E04E
; ---------------------------------------------------------------------------

loc_42E045:				; CODE XREF: .text:0042E038j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_42E04E:				; CODE XREF: .text:0042E02Ej
					; .text:0042E043j
		mov	edx, [ebp-14h]
		mov	[edx], al
		add	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-0Ch], 1
		jmp	loc_42E102
; ---------------------------------------------------------------------------

loc_42E064:				; CODE XREF: .text:0042E106j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_42E081
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	edx, eax
		shl	edx, 4
		jmp	short loc_42E0AD
; ---------------------------------------------------------------------------

loc_42E081:				; CODE XREF: .text:0042E06Cj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_42E09C
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		jmp	short loc_42E0AB
; ---------------------------------------------------------------------------

loc_42E09C:				; CODE XREF: .text:0042E089j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4

loc_42E0AB:				; CODE XREF: .text:0042E09Aj
		mov	edx, eax

loc_42E0AD:				; CODE XREF: .text:0042E07Fj
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_42E0C8
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 30h
		jmp	short loc_42E0EF
; ---------------------------------------------------------------------------

loc_42E0C8:				; CODE XREF: .text:0042E0B8j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_42E0E3
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 37h
		jmp	short loc_42E0EF
; ---------------------------------------------------------------------------

loc_42E0E3:				; CODE XREF: .text:0042E0D3j
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		sub	eax, 57h

loc_42E0EF:				; CODE XREF: .text:0042E0C6j
					; .text:0042E0E1j
		add	edx, eax
		mov	eax, [ebp-14h]
		mov	[eax], dl
		add	dword ptr [ebp-14h], 1
		sub	dword ptr [ebp-0Ch], 2
		add	dword ptr [ebp-10h], 2

loc_42E102:				; CODE XREF: .text:0042E015j
					; .text:0042E05Fj
		cmp	dword ptr [ebp-0Ch], 1
		ja	loc_42E064
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	29h
		add	dword ptr [ebp-14h], 1
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-20h]

locret_42E11F:				; CODE XREF: .text:0042DF8Ej
					; .text:0042DFE4j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		test	eax, eax
		jz	short loc_42E13E
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_42E148

loc_42E13E:				; CODE XREF: .text:0042E132j
		mov	eax, 0
		jmp	locret_42E294
; ---------------------------------------------------------------------------

loc_42E148:				; CODE XREF: .text:0042E13Cj
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[ebp-10h], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42DA7F
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_42E16F
		mov	eax, 0
		jmp	locret_42E294
; ---------------------------------------------------------------------------

loc_42E16F:				; CODE XREF: .text:0042E163j
		mov	dword ptr [esp+8], offset aSigVal ; "sig-val"
		mov	eax, [ebp-0Ch]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42DBAE
		test	eax, eax
		jnz	short loc_42E197
		mov	eax, 0
		jmp	locret_42E294
; ---------------------------------------------------------------------------

loc_42E197:				; CODE XREF: .text:0042E18Bj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_42E1AB
		mov	eax, 0
		jmp	locret_42E294
; ---------------------------------------------------------------------------

loc_42E1AB:				; CODE XREF: .text:0042E19Fj
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[ebp-10h], eax
		mov	dword ptr [ebp-14h], 1
		lea	eax, [ebp-14h]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42DB08
		test	eax, eax
		jnz	short loc_42E1D8
		mov	eax, [ebp-14h]
		test	eax, eax
		jz	short loc_42E1E2

loc_42E1D8:				; CODE XREF: .text:0042E1CFj
		mov	eax, 0
		jmp	locret_42E294
; ---------------------------------------------------------------------------

loc_42E1E2:				; CODE XREF: .text:0042E1D6j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 28h
		jz	short loc_42E1F6
		mov	eax, 0
		jmp	locret_42E294
; ---------------------------------------------------------------------------

loc_42E1F6:				; CODE XREF: .text:0042E1EAj
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[ebp-10h], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42DA7F
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_42E21A
		mov	eax, 0
		jmp	short locret_42E294
; ---------------------------------------------------------------------------

loc_42E21A:				; CODE XREF: .text:0042E211j
		mov	dword ptr [esp+8], offset aHash	; "hash"
		mov	eax, [ebp-0Ch]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42DBAE
		test	eax, eax
		jnz	short loc_42E23F
		mov	eax, 0
		jmp	short locret_42E294
; ---------------------------------------------------------------------------

loc_42E23F:				; CODE XREF: .text:0042E236j
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42DA7F
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_42E25E
		mov	eax, [ebp-0Ch]
		add	eax, 1
		cmp	eax, 31h
		jbe	short loc_42E265

loc_42E25E:				; CODE XREF: .text:0042E251j
		mov	eax, 0
		jmp	short locret_42E294
; ---------------------------------------------------------------------------

loc_42E265:				; CODE XREF: .text:0042E25Cj
		mov	eax, [ebp-10h]
		mov	edx, eax
		lea	eax, [ebp-46h]
		mov	ecx, [ebp-0Ch]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		lea	eax, [ebp-46h]
		add	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		lea	eax, [ebp-46h]
		mov	[esp], eax
		call	gcry_md_map_name

locret_42E294:				; CODE XREF: .text:0042E143j
					; .text:0042E16Aj ...
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42E296(int, size_t, int, size_t, int)
sub_42E296	proc near		; CODE XREF: sub_41A8F7+186p

Dst		= dword	ptr -0B8h
Src		= dword	ptr -0B4h
Size		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_9C		= dword	ptr -9Ch
var_89		= dword	ptr -89h
var_85		= dword	ptr -85h
var_81		= word ptr -81h
var_7F		= dword	ptr -7Fh
var_7B		= dword	ptr -7Bh
var_77		= dword	ptr -77h
var_73		= dword	ptr -73h
var_6F		= dword	ptr -6Fh
var_6B		= dword	ptr -6Bh
var_67		= byte ptr -67h
var_66		= byte ptr -66h
var_43		= byte ptr -43h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0B0h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_7F], 3A303128h
		mov	[ebp+var_7B], 6C627570h
		mov	[ebp+var_77], 6B2D6369h
		mov	[ebp+var_73], 33287965h
		mov	[ebp+var_6F], 6173723Ah
		mov	[ebp+var_6B], 6E3A3128h
		mov	[ebp+var_67], 0
		mov	[ebp+var_85], 3A312829h
		mov	[ebp+var_81], 65h
		mov	[ebp+var_89], 292929h
		jmp	short loc_42E310
; ---------------------------------------------------------------------------

loc_42E308:				; CODE XREF: sub_42E296+88j
		sub	[ebp+arg_4], 1
		add	[ebp+var_C], 1

loc_42E310:				; CODE XREF: sub_42E296+70j
		cmp	[ebp+arg_4], 0
		jz	short loc_42E32A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42E308
		jmp	short loc_42E32A
; ---------------------------------------------------------------------------

loc_42E322:				; CODE XREF: sub_42E296+A2j
		sub	[ebp+arg_C], 1
		add	[ebp+var_10], 1

loc_42E32A:				; CODE XREF: sub_42E296+7Ej
					; sub_42E296+8Aj
		cmp	[ebp+arg_C], 0
		jz	short loc_42E33A
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42E322

loc_42E33A:				; CODE XREF: sub_42E296+98j
		cmp	[ebp+arg_4], 0
		jz	short loc_42E34A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_42E351

loc_42E34A:				; CODE XREF: sub_42E296+A8j
		mov	[ebp+var_14], 1

loc_42E351:				; CODE XREF: sub_42E296+B2j
		cmp	[ebp+arg_C], 0
		jz	short loc_42E361
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_42E368

loc_42E361:				; CODE XREF: sub_42E296+BFj
		mov	[ebp+var_18], 1

loc_42E368:				; CODE XREF: sub_42E296+C9j
		mov	eax, [ebp+var_14]
		add	eax, [ebp+arg_4]
		mov	[esp+0B8h+var_AC], eax
		mov	[esp+0B8h+Size], offset	aU_0 ; "%u:"
		mov	[esp+0B8h+Src],	23h
		lea	eax, [ebp+var_43]
		mov	[esp+0B8h+Dst],	eax
		call	sub_429C1D
		mov	eax, [ebp+var_18]
		add	eax, [ebp+arg_C]
		mov	[esp+0B8h+var_AC], eax
		mov	[esp+0B8h+Size], offset	aU_0 ; "%u:"
		mov	[esp+0B8h+Src],	23h
		lea	eax, [ebp+var_66]
		mov	[esp+0B8h+Dst],	eax
		call	sub_429C1D
		lea	eax, [ebp+var_43]
		mov	[ebp+var_9C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_9C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	edx, eax
		add	edx, [ebp+arg_4]
		mov	eax, [ebp+var_14]
		lea	ebx, [edx+eax]
		lea	eax, [ebp+var_66]
		mov	[ebp+var_9C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_9C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		mov	edx, eax
		add	edx, [ebp+arg_C]
		mov	eax, [ebp+var_18]
		add	eax, edx
		add	eax, 21h
		mov	[esp+0B8h+Dst],	eax
		call	gcry_malloc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_42E431
		mov	eax, 0
		jmp	loc_42E538
; ---------------------------------------------------------------------------

loc_42E431:				; CODE XREF: sub_42E296+18Fj
		mov	eax, [ebp+var_20]
		lea	edx, [ebp+var_7F]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	ecx, [edx+10h]
		mov	[eax+10h], ecx
		mov	ecx, [edx+14h]
		mov	[eax+14h], ecx
		movzx	edx, byte ptr [edx+18h]
		mov	[eax+18h], dl
		add	eax, 18h
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+var_43]
		mov	[esp+0B8h+Src],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0B8h+Dst],	eax
		call	sub_43A1E9
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_14], 0
		jz	short loc_42E48B
		mov	eax, [ebp+var_1C]
		mov	byte ptr [eax],	0
		add	[ebp+var_1C], 1

loc_42E48B:				; CODE XREF: sub_42E296+1E9j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_1C]
		mov	ecx, [ebp+arg_4]
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Src],	edx ; Src
		mov	[esp+0B8h+Dst],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_4]
		add	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		lea	edx, [ebp+var_85]
		mov	ecx, [edx]
		mov	[eax], ecx
		movzx	edx, word ptr [edx+4]
		mov	[eax+4], dx
		add	eax, 5
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+var_66]
		mov	[esp+0B8h+Src],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0B8h+Dst],	eax
		call	sub_43A1E9
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_18], 0
		jz	short loc_42E4EA
		mov	eax, [ebp+var_1C]
		mov	byte ptr [eax],	0
		add	[ebp+var_1C], 1

loc_42E4EA:				; CODE XREF: sub_42E296+248j
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_1C]
		mov	ecx, [ebp+arg_C]
		mov	[esp+0B8h+Size], ecx ; Size
		mov	[esp+0B8h+Src],	edx ; Src
		mov	[esp+0B8h+Dst],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_C]
		add	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		lea	edx, [ebp+var_89]
		mov	edx, [edx]
		mov	[eax], edx
		add	eax, 3
		mov	[ebp+var_1C], eax
		cmp	[ebp+arg_10], 0
		jz	short loc_42E535
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_20]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	edx, eax
		mov	eax, [ebp+arg_10]
		mov	[eax], edx

loc_42E535:				; CODE XREF: sub_42E296+28Aj
		mov	eax, [ebp+var_20]

loc_42E538:				; CODE XREF: sub_42E296+196j
		add	esp, 0B0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_42E296	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42E542	proc near		; CODE XREF: sub_41AAB8+B8p

Buf1		= dword	ptr -68h
Buf2		= dword	ptr -64h
Size		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	[ebp+var_34], 0
		mov	[ebp+var_38], 0
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_28], eax
		mov	[ebp+var_30], 0
		mov	[esp+68h+var_54], 0
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+var_58], eax
		lea	eax, [ebp+var_24]
		mov	[esp+68h+var_5C], eax
		lea	eax, [ebp+var_30]
		mov	[esp+68h+Size],	eax
		lea	eax, [ebp+var_28]
		mov	[esp+68h+Buf2],	eax
		lea	eax, [ebp+var_20]
		mov	[esp+68h+Buf1],	eax
		call	sub_42D68E
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_42E5CD
		mov	eax, [ebp+var_14]
		jmp	locret_42E963
; ---------------------------------------------------------------------------

loc_42E5CD:				; CODE XREF: sub_42E542+81j
		mov	[esp+68h+var_54], 0
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+var_58], eax
		lea	eax, [ebp+var_24]
		mov	[esp+68h+var_5C], eax
		lea	eax, [ebp+var_30]
		mov	[esp+68h+Size],	eax
		lea	eax, [ebp+var_28]
		mov	[esp+68h+Buf2],	eax
		lea	eax, [ebp+var_20]
		mov	[esp+68h+Buf1],	eax
		call	sub_42D68E
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_42E60D
		mov	eax, [ebp+var_14]
		jmp	locret_42E963
; ---------------------------------------------------------------------------

loc_42E60D:				; CODE XREF: sub_42E542+C1j
		mov	eax, [ebp+var_24]
		test	eax, eax
		jz	short loc_42E63A
		mov	eax, [ebp+var_2C]
		cmp	eax, 0Ah
		jnz	short loc_42E63A
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_24]
		mov	[esp+68h+Size],	edx ; Size
		mov	[esp+68h+Buf2],	eax ; Buf2
		mov	[esp+68h+Buf1],	offset aPublicKey ; "public-key"
		call	memcmp
		test	eax, eax
		jz	short loc_42E64B

loc_42E63A:				; CODE XREF: sub_42E542+D0j
					; sub_42E542+D8j
		mov	[esp+68h+Buf1],	6
		call	sub_42DA4F
		jmp	locret_42E963
; ---------------------------------------------------------------------------

loc_42E64B:				; CODE XREF: sub_42E542+F6j
		mov	[esp+68h+var_54], 0
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+var_58], eax
		lea	eax, [ebp+var_24]
		mov	[esp+68h+var_5C], eax
		lea	eax, [ebp+var_30]
		mov	[esp+68h+Size],	eax
		lea	eax, [ebp+var_28]
		mov	[esp+68h+Buf2],	eax
		lea	eax, [ebp+var_20]
		mov	[esp+68h+Buf1],	eax
		call	sub_42D68E
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_42E68B
		mov	eax, [ebp+var_14]
		jmp	locret_42E963
; ---------------------------------------------------------------------------

loc_42E68B:				; CODE XREF: sub_42E542+13Fj
		mov	[esp+68h+var_54], 0
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+var_58], eax
		lea	eax, [ebp+var_24]
		mov	[esp+68h+var_5C], eax
		lea	eax, [ebp+var_30]
		mov	[esp+68h+Size],	eax
		lea	eax, [ebp+var_28]
		mov	[esp+68h+Buf2],	eax
		lea	eax, [ebp+var_20]
		mov	[esp+68h+Buf1],	eax
		call	sub_42D68E
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_42E6CB
		mov	eax, [ebp+var_14]
		jmp	locret_42E963
; ---------------------------------------------------------------------------

loc_42E6CB:				; CODE XREF: sub_42E542+17Fj
		mov	eax, [ebp+var_24]
		test	eax, eax
		jz	short loc_42E6F8
		mov	eax, [ebp+var_2C]
		cmp	eax, 3
		jnz	short loc_42E6F8
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_24]
		mov	[esp+68h+Size],	edx ; Size
		mov	[esp+68h+Buf2],	eax ; Buf2
		mov	[esp+68h+Buf1],	offset aRsa_0 ;	"rsa"
		call	memcmp
		test	eax, eax
		jz	short loc_42E709

loc_42E6F8:				; CODE XREF: sub_42E542+18Ej
					; sub_42E542+196j
		mov	[esp+68h+Buf1],	29h
		call	sub_42DA4F
		jmp	locret_42E963
; ---------------------------------------------------------------------------

loc_42E709:				; CODE XREF: sub_42E542+1B4j
		mov	eax, [ebp+var_30]
		mov	[ebp+var_18], eax
		jmp	loc_42E8BE
; ---------------------------------------------------------------------------

loc_42E714:				; CODE XREF: sub_42E542+3C1j
		mov	eax, [ebp+var_24]
		test	eax, eax
		jz	short loc_42E72C
		mov	[esp+68h+Buf1],	68h
		call	sub_42DA4F
		jmp	locret_42E963
; ---------------------------------------------------------------------------

loc_42E72C:				; CODE XREF: sub_42E542+1D7j
		mov	[esp+68h+var_54], 0
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+var_58], eax
		lea	eax, [ebp+var_24]
		mov	[esp+68h+var_5C], eax
		lea	eax, [ebp+var_30]
		mov	[esp+68h+Size],	eax
		lea	eax, [ebp+var_28]
		mov	[esp+68h+Buf2],	eax
		lea	eax, [ebp+var_20]
		mov	[esp+68h+Buf1],	eax
		call	sub_42D68E
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_42E76C
		mov	eax, [ebp+var_14]
		jmp	locret_42E963
; ---------------------------------------------------------------------------

loc_42E76C:				; CODE XREF: sub_42E542+220j
		mov	eax, [ebp+var_24]
		test	eax, eax
		jz	loc_42E863
		mov	eax, [ebp+var_2C]
		cmp	eax, 1
		jnz	loc_42E863
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, 65h
		jz	short loc_42E7A4
		cmp	eax, 6Eh
		jnz	short loc_42E7B2
		lea	eax, [ebp+var_34]
		mov	[ebp+var_C], eax
		lea	eax, [ebp+var_3C]
		mov	[ebp+var_10], eax
		jmp	short loc_42E7C1
; ---------------------------------------------------------------------------

loc_42E7A4:				; CODE XREF: sub_42E542+24Dj
		lea	eax, [ebp+var_38]
		mov	[ebp+var_C], eax
		lea	eax, [ebp+var_40]
		mov	[ebp+var_10], eax
		jmp	short loc_42E7C1
; ---------------------------------------------------------------------------

loc_42E7B2:				; CODE XREF: sub_42E542+252j
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		nop

loc_42E7C1:				; CODE XREF: sub_42E542+260j
					; sub_42E542+26Ej
		cmp	[ebp+var_C], 0
		jz	short loc_42E7E1
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_42E7E1
		mov	[esp+68h+Buf1],	9Dh
		call	sub_42DA4F
		jmp	locret_42E963
; ---------------------------------------------------------------------------

loc_42E7E1:				; CODE XREF: sub_42E542+283j
					; sub_42E542+28Cj
		mov	[esp+68h+var_54], 0
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+var_58], eax
		lea	eax, [ebp+var_24]
		mov	[esp+68h+var_5C], eax
		lea	eax, [ebp+var_30]
		mov	[esp+68h+Size],	eax
		lea	eax, [ebp+var_28]
		mov	[esp+68h+Buf2],	eax
		lea	eax, [ebp+var_20]
		mov	[esp+68h+Buf1],	eax
		call	sub_42D68E
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_42E821
		mov	eax, [ebp+var_14]
		jmp	locret_42E963
; ---------------------------------------------------------------------------

loc_42E821:				; CODE XREF: sub_42E542+2D5j
		mov	eax, [ebp+var_24]
		test	eax, eax
		jz	short loc_42E863
		cmp	[ebp+var_C], 0
		jz	short loc_42E863
		jmp	short loc_42E842
; ---------------------------------------------------------------------------

loc_42E830:				; CODE XREF: sub_42E542+30Fj
		mov	eax, [ebp+var_2C]
		sub	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_24]
		add	eax, 1
		mov	[ebp+var_24], eax

loc_42E842:				; CODE XREF: sub_42E542+2ECj
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jz	short loc_42E853
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_42E830

loc_42E853:				; CODE XREF: sub_42E542+305j
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_10]
		mov	[eax], edx

loc_42E863:				; CODE XREF: sub_42E542+22Fj
					; sub_42E542+23Bj ...
		mov	eax, [ebp+var_30]
		mov	[ebp+var_1C], eax

loc_42E869:				; CODE XREF: sub_42E542+36Cj
		mov	[esp+68h+var_54], 0
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+var_58], eax
		lea	eax, [ebp+var_24]
		mov	[esp+68h+var_5C], eax
		lea	eax, [ebp+var_30]
		mov	[esp+68h+Size],	eax
		lea	eax, [ebp+var_28]
		mov	[esp+68h+Buf2],	eax
		lea	eax, [ebp+var_20]
		mov	[esp+68h+Buf1],	eax
		call	sub_42D68E
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_42E8B0
		mov	eax, [ebp+var_30]
		test	eax, eax
		jz	short loc_42E8B0
		mov	eax, [ebp+var_30]
		cmp	eax, [ebp+var_1C]
		jge	short loc_42E869

loc_42E8B0:				; CODE XREF: sub_42E542+35Dj
					; sub_42E542+364j
		cmp	[ebp+var_14], 0
		jz	short loc_42E8BE
		mov	eax, [ebp+var_14]
		jmp	locret_42E963
; ---------------------------------------------------------------------------

loc_42E8BE:				; CODE XREF: sub_42E542+1CDj
					; sub_42E542+372j
		mov	[esp+68h+var_54], 0
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+var_58], eax
		lea	eax, [ebp+var_24]
		mov	[esp+68h+var_5C], eax
		lea	eax, [ebp+var_30]
		mov	[esp+68h+Size],	eax
		lea	eax, [ebp+var_28]
		mov	[esp+68h+Buf2],	eax
		lea	eax, [ebp+var_20]
		mov	[esp+68h+Buf1],	eax
		call	sub_42D68E
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_42E909
		mov	eax, [ebp+var_30]
		test	eax, eax
		jz	short loc_42E909
		mov	eax, [ebp+var_30]
		cmp	eax, [ebp+var_18]
		jge	loc_42E714

loc_42E909:				; CODE XREF: sub_42E542+3B2j
					; sub_42E542+3B9j
		cmp	[ebp+var_14], 0
		jz	short loc_42E914
		mov	eax, [ebp+var_14]
		jmp	short locret_42E963
; ---------------------------------------------------------------------------

loc_42E914:				; CODE XREF: sub_42E542+3CBj
		mov	eax, [ebp+var_34]
		test	eax, eax
		jz	short loc_42E930
		mov	eax, [ebp+var_3C]
		test	eax, eax
		jz	short loc_42E930
		mov	eax, [ebp+var_38]
		test	eax, eax
		jz	short loc_42E930
		mov	eax, [ebp+var_40]
		test	eax, eax
		jnz	short loc_42E93E

loc_42E930:				; CODE XREF: sub_42E542+3D7j
					; sub_42E542+3DEj ...
		mov	[esp+68h+Buf1],	6
		call	sub_42DA4F
		jmp	short locret_42E963
; ---------------------------------------------------------------------------

loc_42E93E:				; CODE XREF: sub_42E542+3ECj
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	edx, [ebp+var_3C]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	edx, [ebp+var_38]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx
		mov	edx, [ebp+var_40]
		mov	eax, [ebp+arg_14]
		mov	[eax], edx
		mov	eax, 0

locret_42E963:				; CODE XREF: sub_42E542+86j
					; sub_42E542+C6j ...
		leave
		retn
sub_42E542	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-18h], eax
		mov	dword ptr [ebp-20h], 0
		mov	dword ptr [esp+14h], 0
		lea	eax, [ebp-1Ch]
		mov	[esp+10h], eax
		lea	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-20h]
		mov	[esp+8], eax
		lea	eax, [ebp-18h]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42D68E
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_42E9C7
		mov	eax, [ebp-0Ch]
		jmp	locret_42EBB7
; ---------------------------------------------------------------------------

loc_42E9C7:				; CODE XREF: .text:0042E9BDj
		mov	dword ptr [esp+14h], 0
		lea	eax, [ebp-1Ch]
		mov	[esp+10h], eax
		lea	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-20h]
		mov	[esp+8], eax
		lea	eax, [ebp-18h]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42D68E
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_42EA07
		mov	eax, [ebp-0Ch]
		jmp	locret_42EBB7
; ---------------------------------------------------------------------------

loc_42EA07:				; CODE XREF: .text:0042E9FDj
		mov	eax, [ebp-14h]
		test	eax, eax
		jz	short loc_42EA34
		mov	eax, [ebp-1Ch]
		cmp	eax, 0Ah
		jnz	short loc_42EA34
		mov	edx, [ebp-1Ch]
		mov	eax, [ebp-14h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aPublicKey ; "public-key"
		call	memcmp
		test	eax, eax
		jz	short loc_42EA45

loc_42EA34:				; CODE XREF: .text:0042EA0Cj
					; .text:0042EA14j
		mov	dword ptr [esp], 6
		call	sub_42DA4F
		jmp	locret_42EBB7
; ---------------------------------------------------------------------------

loc_42EA45:				; CODE XREF: .text:0042EA32j
		mov	dword ptr [esp+14h], 0
		lea	eax, [ebp-1Ch]
		mov	[esp+10h], eax
		lea	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-20h]
		mov	[esp+8], eax
		lea	eax, [ebp-18h]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42D68E
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_42EA85
		mov	eax, [ebp-0Ch]
		jmp	locret_42EBB7
; ---------------------------------------------------------------------------

loc_42EA85:				; CODE XREF: .text:0042EA7Bj
		mov	dword ptr [esp+14h], 0
		lea	eax, [ebp-1Ch]
		mov	[esp+10h], eax
		lea	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-20h]
		mov	[esp+8], eax
		lea	eax, [ebp-18h]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42D68E
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_42EAC5
		mov	eax, [ebp-0Ch]
		jmp	locret_42EBB7
; ---------------------------------------------------------------------------

loc_42EAC5:				; CODE XREF: .text:0042EABBj
		mov	eax, [ebp-14h]
		test	eax, eax
		jnz	short loc_42EADD
		mov	dword ptr [esp], 6
		call	sub_42DA4F
		jmp	locret_42EBB7
; ---------------------------------------------------------------------------

loc_42EADD:				; CODE XREF: .text:0042EACAj
		mov	eax, [ebp-1Ch]
		cmp	eax, 3
		jnz	short loc_42EB11
		mov	edx, [ebp-1Ch]
		mov	eax, [ebp-14h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aRsa_0 ; "rsa"
		call	memcmp
		test	eax, eax
		jnz	short loc_42EB11
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 1
		jmp	loc_42EBB2
; ---------------------------------------------------------------------------

loc_42EB11:				; CODE XREF: .text:0042EAE3j
					; .text:0042EB01j
		mov	eax, [ebp-1Ch]
		cmp	eax, 3
		jnz	short loc_42EB42
		mov	edx, [ebp-1Ch]
		mov	eax, [ebp-14h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aDsa ; "dsa"
		call	memcmp
		test	eax, eax
		jnz	short loc_42EB42
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 11h
		jmp	short loc_42EBB2
; ---------------------------------------------------------------------------

loc_42EB42:				; CODE XREF: .text:0042EB17j
					; .text:0042EB35j
		mov	eax, [ebp-1Ch]
		cmp	eax, 3
		jnz	short loc_42EB73
		mov	edx, [ebp-1Ch]
		mov	eax, [ebp-14h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aElg ; "elg"
		call	memcmp
		test	eax, eax
		jnz	short loc_42EB73
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 14h
		jmp	short loc_42EBB2
; ---------------------------------------------------------------------------

loc_42EB73:				; CODE XREF: .text:0042EB48j
					; .text:0042EB66j
		mov	eax, [ebp-1Ch]
		cmp	eax, 5
		jnz	short loc_42EBA4
		mov	edx, [ebp-1Ch]
		mov	eax, [ebp-14h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aEcdsa ; "ecdsa"
		call	memcmp
		test	eax, eax
		jnz	short loc_42EBA4
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 12Dh
		jmp	short loc_42EBB2
; ---------------------------------------------------------------------------

loc_42EBA4:				; CODE XREF: .text:0042EB79j
					; .text:0042EB97j
		mov	dword ptr [esp], 4
		call	sub_42DA4F
		jmp	short locret_42EBB7
; ---------------------------------------------------------------------------

loc_42EBB2:				; CODE XREF: .text:0042EB0Cj
					; .text:0042EB40j ...
		mov	eax, 0

locret_42EBB7:				; CODE XREF: .text:0042E9C2j
					; .text:0042EA02j ...
		leave
		retn
; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_429D5F
		test	eax, eax
		jns	short loc_42EC08
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp], eax
		call	strerror
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aEstream_asprin	; "estream_asprintf failed: %s\n"
		call	sub_43CB64
; ---------------------------------------------------------------------------

loc_42EC08:				; CODE XREF: .text:0042EBE5j
		mov	eax, [ebp-10h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42EC0D	proc near		; CODE XREF: sub_41384F+107p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	sub_429D5F
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_42EC44
		mov	eax, 0
		jmp	short locret_42EC47
; ---------------------------------------------------------------------------

loc_42EC44:				; CODE XREF: sub_42EC0D+2Ej
		mov	eax, [ebp+var_14]

locret_42EC47:				; CODE XREF: sub_42EC0D+35j
		leave
		retn
sub_42EC0D	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42EC4C	proc near		; CODE XREF: sub_42ECBE+3Ep
					; sub_42ED92+1Dp ...
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_42EC4C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42EC51	proc near		; CODE XREF: sub_42ECBE+B5p
					; sub_42ED92+AEp ...
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_42EC51	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42EC5B(size_t)
sub_42EC5B	proc near		; CODE XREF: sub_42EC78+12p
					; sub_42ECBE+Dp ...

Size		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_42EC6B
		add	[ebp+arg_0], 1

loc_42EC6B:				; CODE XREF: sub_42EC5B+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Size],	eax ; Size
		call	malloc
		leave
		retn
sub_42EC5B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42EC78(void *, size_t)
sub_42EC78	proc near		; CODE XREF: .text:0043342Cp
					; .text:00433686p
					; DATA XREF: ...

Memory		= dword	ptr -18h
NewSize		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_42EC91
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+Memory], eax ;	size_t
		call	sub_42EC5B
		jmp	short locret_42ECA3
; ---------------------------------------------------------------------------

loc_42EC91:				; CODE XREF: sub_42EC78+Aj
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+NewSize], eax ; NewSize
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	realloc

locret_42ECA3:				; CODE XREF: sub_42EC78+17j
		leave
		retn
sub_42EC78	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42ECA5(void *)
sub_42ECA5	proc near		; CODE XREF: sub_42ED92+81p
					; sub_42F6F7+29p ...

Memory		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_42ECBC
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

locret_42ECBC:				; CODE XREF: sub_42ECA5+Aj
		leave
		retn
sub_42ECA5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42ECBE	proc near		; CODE XREF: sub_4302D5+105p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 0Ch ;	size_t
		call	sub_42EC5B
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_42ECE5
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_42ED8D
; ---------------------------------------------------------------------------

loc_42ECE5:				; CODE XREF: sub_42ECBE+19j
		cmp	[ebp+arg_4], 0
		jnz	short loc_42ED1F
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_42ED03
		mov	eax, ds:dword_451708
		mov	[esp+28h+var_28], eax
		call	sub_42EC4C
		jmp	short loc_42ED1F
; ---------------------------------------------------------------------------

loc_42ED03:				; CODE XREF: sub_42ECBE+34j
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], offset dword_451708
		call	pth_mutex_acquire

loc_42ED1F:				; CODE XREF: sub_42ECBE+2Bj
					; sub_42ECBE+43j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_0]
		mov	[eax], edx
		mov	edx, ds:dword_451704
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+8], offset dword_451704
		mov	eax, ds:dword_451704
		test	eax, eax
		jz	short loc_42ED54
		mov	eax, ds:dword_451704
		mov	edx, [ebp+var_10]
		add	edx, 4
		mov	[eax+8], edx

loc_42ED54:				; CODE XREF: sub_42ECBE+86j
		mov	eax, [ebp+var_10]
		mov	ds:dword_451704, eax
		cmp	[ebp+arg_4], 0
		jnz	short loc_42ED86
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_42ED7A
		mov	eax, ds:dword_451708
		mov	[esp+28h+var_28], eax
		call	sub_42EC51
		jmp	short loc_42ED86
; ---------------------------------------------------------------------------

loc_42ED7A:				; CODE XREF: sub_42ECBE+ABj
		mov	[esp+28h+var_28], offset dword_451708
		call	pth_mutex_release

loc_42ED86:				; CODE XREF: sub_42ECBE+A2j
					; sub_42ECBE+BAj
		mov	[ebp+var_C], 0

loc_42ED8D:				; CODE XREF: sub_42ECBE+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_42ECBE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42ED92	proc near		; CODE XREF: sub_43041A+20p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 0
		jnz	short loc_42EDD2
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_42EDB6
		mov	eax, ds:dword_451708
		mov	[esp+28h+var_28], eax
		call	sub_42EC4C
		jmp	short loc_42EDD2
; ---------------------------------------------------------------------------

loc_42EDB6:				; CODE XREF: sub_42ED92+13j
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], offset dword_451708
		call	pth_mutex_acquire

loc_42EDD2:				; CODE XREF: sub_42ED92+Aj
					; sub_42ED92+22j
		mov	eax, ds:dword_451704
		mov	[ebp+var_C], eax
		jmp	short loc_42EE23
; ---------------------------------------------------------------------------

loc_42EDDC:				; CODE XREF: sub_42ED92+95j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_42EE1A
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		mov	edx, [edx+4]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_42EE0D
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		mov	edx, [edx+8]
		mov	[eax+8], edx

loc_42EE0D:				; CODE XREF: sub_42ED92+6Aj
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_42ECA5
		jmp	short loc_42EE29
; ---------------------------------------------------------------------------

loc_42EE1A:				; CODE XREF: sub_42ED92+52j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[ebp+var_C], eax

loc_42EE23:				; CODE XREF: sub_42ED92+48j
		cmp	[ebp+var_C], 0
		jnz	short loc_42EDDC

loc_42EE29:				; CODE XREF: sub_42ED92+86j
		cmp	[ebp+arg_4], 0
		jnz	short locret_42EE53
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_42EE47
		mov	eax, ds:dword_451708
		mov	[esp+28h+var_28], eax
		call	sub_42EC51
		jmp	short locret_42EE53
; ---------------------------------------------------------------------------

loc_42EE47:				; CODE XREF: sub_42ED92+A4j
		mov	[esp+28h+var_28], offset dword_451708
		call	pth_mutex_release

locret_42EE53:				; CODE XREF: sub_42ED92+9Bj
					; sub_42ED92+B3j
		leave
		retn
sub_42ED92	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42EE55	proc near		; CODE XREF: sub_4326CB+9Bp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_42EE7A
		mov	eax, ds:dword_451708
		mov	[esp+28h+var_28], eax
		call	sub_42EC4C
		jmp	short loc_42EE96
; ---------------------------------------------------------------------------

loc_42EE7A:				; CODE XREF: sub_42EE55+14j
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], offset dword_451708
		call	pth_mutex_acquire

loc_42EE96:				; CODE XREF: sub_42EE55+23j
		mov	eax, ds:dword_451704
		mov	[ebp+var_C], eax
		jmp	short loc_42EEB9
; ---------------------------------------------------------------------------

loc_42EEA0:				; CODE XREF: sub_42EE55+68j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+arg_0]
		call	eax
		or	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[ebp+var_C], eax

loc_42EEB9:				; CODE XREF: sub_42EE55+49j
		cmp	[ebp+var_C], 0
		jnz	short loc_42EEA0
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_42EED7
		mov	eax, ds:dword_451708
		mov	[esp+28h+var_28], eax
		call	sub_42EC51
		jmp	short loc_42EEE3
; ---------------------------------------------------------------------------

loc_42EED7:				; CODE XREF: sub_42EE55+71j
		mov	[esp+28h+var_28], offset dword_451708
		call	pth_mutex_release

loc_42EEE3:				; CODE XREF: sub_42EE55+80j
		mov	eax, [ebp+var_10]
		leave
		retn
sub_42EE55	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42EEE8	proc near		; CODE XREF: sub_42F794+4Ap

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_42EF12
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	_read
		jmp	short locret_42EF61
; ---------------------------------------------------------------------------

loc_42EF12:				; CODE XREF: sub_42EEE8+Dj
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	pth_read
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_42EF5E
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_42EF5E
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	_read
		mov	[ebp+var_C], eax

loc_42EF5E:				; CODE XREF: sub_42EEE8+4Aj
					; sub_42EEE8+58j
		mov	eax, [ebp+var_C]

locret_42EF61:				; CODE XREF: sub_42EEE8+28j
		leave
		retn
sub_42EEE8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42EF63	proc near		; CODE XREF: sub_42F7FF+49p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_42EF8D
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	_write
		jmp	short locret_42EFDC
; ---------------------------------------------------------------------------

loc_42EF8D:				; CODE XREF: sub_42EF63+Dj
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	pth_write
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_42EFD9
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_42EFD9
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	_write
		mov	[ebp+var_C], eax

loc_42EFD9:				; CODE XREF: sub_42EF63+4Aj
					; sub_42EF63+58j
		mov	eax, [ebp+var_C]

locret_42EFDC:				; CODE XREF: sub_42EF63+28j
		leave
		retn
sub_42EF63	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42EFDE()
sub_42EFDE	proc near		; DATA XREF: sub_42F015:loc_42F071o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 0
		call	sub_4326CB
		leave
		retn
sub_42EFDE	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	pth_kill
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_42F010
		mov	ds:dword_451700, 1

loc_42F010:				; CODE XREF: .text:0042F004j
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42F015	proc near		; CODE XREF: sub_4314F7+6p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_45171C
		test	eax, eax
		jnz	short loc_42F07D
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_42F039
		mov	ds:dword_45171C, 1
		jmp	short loc_42F071
; ---------------------------------------------------------------------------

loc_42F039:				; CODE XREF: sub_42F015+16j
		call	pth_init
		test	eax, eax
		jnz	short loc_42F057
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 1
		jz	short loc_42F057
		mov	eax, 0FFFFFFFFh
		jmp	short locret_42F082
; ---------------------------------------------------------------------------

loc_42F057:				; CODE XREF: sub_42F015+2Bj
					; sub_42F015+39j
		mov	[esp+18h+var_18], offset dword_451708
		call	pth_mutex_init
		test	eax, eax
		jz	short loc_42F071
		mov	ds:dword_45171C, 1

loc_42F071:				; CODE XREF: sub_42F015+22j
					; sub_42F015+50j
		mov	[esp+18h+var_18], offset sub_42EFDE ; _onexit_t
		call	sub_441160

loc_42F07D:				; CODE XREF: sub_42F015+Dj
		mov	eax, 0

locret_42F082:				; CODE XREF: sub_42F015+40j
		leave
		retn
sub_42F015	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42F084	proc near		; CODE XREF: sub_430E4D+69p
					; .text:004316A1p ...

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 0
		jnz	short loc_42F0B3
		cmp	[ebp+arg_8], 0
		jnz	short loc_42F09C
		cmp	[ebp+arg_C], 0
		jz	short loc_42F0B3

loc_42F09C:				; CODE XREF: sub_42F084+10j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_42F16C
; ---------------------------------------------------------------------------

loc_42F0B3:				; CODE XREF: sub_42F084+Aj
					; sub_42F084+16j
		mov	[esp+28h+var_28], 28h ;	size_t
		call	sub_42EC5B
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_42F0D4
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_42F169
; ---------------------------------------------------------------------------

loc_42F0D4:				; CODE XREF: sub_42F084+42j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_20]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	[eax+8], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_24]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_10]
		mov	[eax+18h], edx
		cmp	[ebp+arg_14], 0
		setnz	dl
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		and	ecx, 1
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFFEh
		or	edx, ecx
		mov	[eax+1Ch], dl
		cmp	[ebp+arg_18], 0
		jz	short loc_42F139
		mov	eax, [ebp+arg_18]
		jmp	short loc_42F13E
; ---------------------------------------------------------------------------

loc_42F139:				; CODE XREF: sub_42F084+AEj
		mov	eax, offset sub_42EC78

loc_42F13E:				; CODE XREF: sub_42F084+B3j
		mov	edx, [ebp+var_10]
		mov	[edx+20h], eax
		cmp	[ebp+arg_1C], 0
		jz	short loc_42F14F
		mov	eax, [ebp+arg_1C]
		jmp	short loc_42F154
; ---------------------------------------------------------------------------

loc_42F14F:				; CODE XREF: sub_42F084+C4j
		mov	eax, offset sub_42ECA5

loc_42F154:				; CODE XREF: sub_42F084+C9j
		mov	edx, [ebp+var_10]
		mov	[edx+24h], eax
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_42F169:				; CODE XREF: sub_42F084+4Bj
		mov	eax, [ebp+var_C]

locret_42F16C:				; CODE XREF: sub_42F084+2Aj
		leave
		retn
sub_42F084	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42F16E(int, void *, size_t)
sub_42F16E	proc near		; DATA XREF: .data:off_444C0Co

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+arg_8]
		jnb	short loc_42F1A6
		mov	eax, [ebp+var_C]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+arg_8], eax

loc_42F1A6:				; CODE XREF: sub_42F16E+21j
		cmp	[ebp+arg_8], 0
		jz	short loc_42F1E3
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		add	edx, eax
		mov	eax, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+10h], edx

loc_42F1E3:				; CODE XREF: sub_42F16E+3Cj
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		leave
		retn
sub_42F16E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42F1EE(int, void *, size_t)
sub_42F1EE	proc near		; DATA XREF: .data:off_444C10o

Dst		= dword	ptr -48h
Src		= dword	ptr -44h
Size		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+arg_8], 0
		jnz	short loc_42F20B
		mov	eax, 0
		jmp	loc_42F46C
; ---------------------------------------------------------------------------

loc_42F20B:				; CODE XREF: sub_42F1EE+11j
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		and	eax, 8
		test	eax, eax
		jz	short loc_42F223
		mov	eax, [ebp+var_10]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	[eax+10h], edx

loc_42F223:				; CODE XREF: sub_42F1EE+27j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	edx, eax
		jnb	short loc_42F24F
		mov	[esp+48h+Size],	283h ; int
		mov	[esp+48h+Src], offset a____Gnupg22_11 ;	"../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+48h+Dst], offset aMem_cookieMemo ;	"mem_cookie->memory_size >= mem_cookie->"...
		call	sub_442650

loc_42F24F:				; CODE XREF: sub_42F1EE+43j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 1
		test	al, al
		jnz	short loc_42F280
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_14]
		jbe	short loc_42F280
		mov	eax, [ebp+var_14]
		mov	[ebp+arg_8], eax

loc_42F280:				; CODE XREF: sub_42F1EE+82j
					; sub_42F1EE+8Aj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_14]
		jbe	loc_42F406
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_42F29E
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		jmp	short loc_42F2B5
; ---------------------------------------------------------------------------

loc_42F29E:				; CODE XREF: sub_42F1EE+A6j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_14]
		mov	ecx, [ebp+arg_8]
		mov	ebx, ecx
		sub	ebx, edx
		mov	edx, ebx
		add	eax, edx
		mov	[ebp+var_C], eax

loc_42F2B5:				; CODE XREF: sub_42F1EE+AEj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	eax, [ebp+var_C]
		jbe	short loc_42F2D7
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	loc_42F46C
; ---------------------------------------------------------------------------

loc_42F2D7:				; CODE XREF: sub_42F1EE+D0j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	short loc_42F338
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		add	eax, [ebp+var_C]
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	eax, [ebp+var_C]
		jbe	short loc_42F312
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	loc_42F46C
; ---------------------------------------------------------------------------

loc_42F312:				; CODE XREF: sub_42F1EE+10Bj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_C]
		mov	edx, 0
		div	[ebp+var_2C]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_C]
		imul	eax, edx
		mov	[ebp+var_C], eax

loc_42F338:				; CODE XREF: sub_42F1EE+F1j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_42F364
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_C]
		jnb	short loc_42F364
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Ch
		mov	eax, 0FFFFFFFFh
		jmp	loc_42F46C
; ---------------------------------------------------------------------------

loc_42F364:				; CODE XREF: sub_42F1EE+152j
					; sub_42F1EE+15Dj
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		mov	[esp+48h+Src], edx
		mov	[esp+48h+Dst], eax
		call	ecx
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_42F38F
		mov	eax, 0FFFFFFFFh
		jmp	loc_42F46C
; ---------------------------------------------------------------------------

loc_42F38F:				; CODE XREF: sub_42F1EE+195j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	edx, eax
		jnb	short loc_42F3CD
		mov	[esp+48h+Size],	2B6h ; int
		mov	[esp+48h+Src], offset a____Gnupg22_11 ;	"../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+48h+Dst], offset aMem_cookieMemo ;	"mem_cookie->memory_size >= mem_cookie->"...
		call	sub_442650

loc_42F3CD:				; CODE XREF: sub_42F1EE+1C1j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_14]
		jbe	short loc_42F406
		mov	[esp+48h+Size],	2B9h ; int
		mov	[esp+48h+Src], offset a____Gnupg22_11 ;	"../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+48h+Dst], offset aSizeNleft ; "size <= nleft"
		call	sub_442650

loc_42F406:				; CODE XREF: sub_42F1EE+98j
					; sub_42F1EE+1FAj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		add	eax, edx
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+14h]
		cmp	edx, eax
		jbe	short loc_42F452
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_10]
		mov	[eax+14h], edx

loc_42F452:				; CODE XREF: sub_42F1EE+251j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_10]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]

loc_42F46C:				; CODE XREF: sub_42F1EE+18j
					; sub_42F1EE+E4j ...
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_42F1EE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42F472	proc near		; DATA XREF: .data:off_444C14o

Dst		= dword	ptr -48h
Val		= dword	ptr -44h
Size		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_8]
		cmp	eax, 1
		jz	short loc_42F49F
		cmp	eax, 2
		jz	short loc_42F4C8
		test	eax, eax
		jnz	short loc_42F4F1
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_42F508
; ---------------------------------------------------------------------------

loc_42F49F:				; CODE XREF: sub_42F472+12j
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+10h]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_14]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_42F508
; ---------------------------------------------------------------------------

loc_42F4C8:				; CODE XREF: sub_42F472+17j
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+14h]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_14]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_42F508
; ---------------------------------------------------------------------------

loc_42F4F1:				; CODE XREF: sub_42F472+1Bj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_42F68D
; ---------------------------------------------------------------------------

loc_42F508:				; CODE XREF: sub_42F472+2Bj
					; sub_42F472+54j ...
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jg	loc_42F61D
		cmp	edx, [ebp+var_C]
		jl	short loc_42F52A
		cmp	eax, [ebp+var_10]
		jnb	loc_42F61D

loc_42F52A:				; CODE XREF: sub_42F472+ADj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 1
		test	al, al
		jnz	short loc_42F54F
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Ch
		mov	eax, 0FFFFFFFFh
		jmp	locret_42F68D
; ---------------------------------------------------------------------------

loc_42F54F:				; CODE XREF: sub_42F472+C4j
		mov	eax, [ebp+var_14]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		add	eax, edx
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jg	short loc_42F58E
		cmp	edx, [ebp+var_C]
		jl	short loc_42F577
		cmp	eax, [ebp+var_10]
		jnb	short loc_42F58E

loc_42F577:				; CODE XREF: sub_42F472+FEj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_42F68D
; ---------------------------------------------------------------------------

loc_42F58E:				; CODE XREF: sub_42F472+F9j
					; sub_42F472+103j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_18]
		mov	edx, 0
		div	[ebp+var_2C]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_18]
		imul	eax, edx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_42F5E0
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_18]
		jnb	short loc_42F5E0
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Ch
		mov	eax, 0FFFFFFFFh
		jmp	locret_42F68D
; ---------------------------------------------------------------------------

loc_42F5E0:				; CODE XREF: sub_42F472+14Aj
					; sub_42F472+155j
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_18]
		mov	[esp+48h+Val], edx
		mov	[esp+48h+Dst], eax
		call	ecx
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_42F60B
		mov	eax, 0FFFFFFFFh
		jmp	locret_42F68D
; ---------------------------------------------------------------------------

loc_42F60B:				; CODE XREF: sub_42F472+18Dj
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_1C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_18]
		mov	[eax+8], edx

loc_42F61D:				; CODE XREF: sub_42F472+A4j
					; sub_42F472+B2j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jg	short loc_42F671
		cmp	edx, [ebp+var_C]
		jl	short loc_42F637
		cmp	eax, [ebp+var_10]
		jnb	short loc_42F671

loc_42F637:				; CODE XREF: sub_42F472+1BEj
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_14]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		add	eax, edx
		mov	edx, ecx
		mov	[esp+48h+Size],	edx ; Size
		mov	[esp+48h+Val], 0 ; Val
		mov	[esp+48h+Dst], eax ; Dst
		call	memset
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	[eax+14h], edx

loc_42F671:				; CODE XREF: sub_42F472+1B9j
					; sub_42F472+1C3j
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	[eax+10h], edx
		mov	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	eax, 0

locret_42F68D:				; CODE XREF: sub_42F472+91j
					; sub_42F472+D8j ...
		leave
		retn
sub_42F472	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42F68F	proc near		; DATA XREF: sub_43172F+109o

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+arg_4], 1
		jnz	short loc_42F6DE
		mov	eax, [ebp+var_10]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [eax+10h]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+10h], 0
		mov	[ebp+var_C], 0
		jmp	short loc_42F6F2
; ---------------------------------------------------------------------------

loc_42F6DE:				; CODE XREF: sub_42F68F+10j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	[ebp+var_C], 0FFFFFFFFh

loc_42F6F2:				; CODE XREF: sub_42F68F+4Dj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_42F68F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42F6F7	proc near		; CODE XREF: sub_430E4D+33Fp
					; .text:00431728p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_42F725
		mov	eax, [ebp+var_C]
		mov	edx, [eax+24h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+28h+var_28], eax
		call	edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_42ECA5

loc_42F725:				; CODE XREF: sub_42F6F7+10j
		mov	eax, 0
		leave
		retn
sub_42F6F7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42F72C	proc near		; CODE XREF: sub_4319B3+55p
					; .text:00433C86p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 8 ; size_t
		call	sub_42EC5B
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_42F750
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_42F78F
; ---------------------------------------------------------------------------

loc_42F750:				; CODE XREF: sub_42F72C+19j
		mov	eax, [ebp+arg_8]
		and	eax, 8000h
		test	eax, eax
		jz	short loc_42F76F
		mov	[esp+28h+var_24], 8000h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	_setmode

loc_42F76F:				; CODE XREF: sub_42F72C+2Ej
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_42F78F:				; CODE XREF: sub_42F72C+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_42F72C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42F794	proc near		; DATA XREF: .data:off_444C1Co

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_42F7C8
		mov	eax, ds:dword_451700
		test	eax, eax
		jnz	short loc_42F7BF
		mov	[esp+28h+var_28], 0
		call	pth_yield

loc_42F7BF:				; CODE XREF: sub_42F794+1Dj
		mov	[ebp+var_C], 0
		jmp	short loc_42F7FA
; ---------------------------------------------------------------------------

loc_42F7C8:				; CODE XREF: sub_42F794+14j
					; sub_42F794+64j
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	sub_42EEE8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_42F7FA
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_42F7C8

loc_42F7FA:				; CODE XREF: sub_42F794+32j
					; sub_42F794+56j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_42F794	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42F7FF	proc near		; DATA XREF: .data:off_444C20o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_42F832
		mov	eax, ds:dword_451700
		test	eax, eax
		jnz	short loc_42F82A
		mov	[esp+28h+var_28], 0
		call	pth_yield

loc_42F82A:				; CODE XREF: sub_42F7FF+1Dj
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		jmp	short loc_42F864
; ---------------------------------------------------------------------------

loc_42F832:				; CODE XREF: sub_42F7FF+14j
					; sub_42F7FF+63j
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	sub_42EF63
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_42F864
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_42F832

loc_42F864:				; CODE XREF: sub_42F7FF+31j
					; sub_42F7FF+55j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_42F7FF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42F869	proc near		; DATA XREF: .data:off_444C24o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_42F896
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Dh
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_42F8F2
; ---------------------------------------------------------------------------

loc_42F896:				; CODE XREF: sub_42F869+15j
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	ecx, [ecx]
		mov	ebx, [ebp+arg_8]
		mov	[esp+28h+var_1C], ebx
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_28], ecx
		call	j__lseeki64
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_14]
		mov	edx, eax
		xor	edx, 0FFFFFFFFh
		mov	eax, [ebp+var_18]
		xor	eax, 0FFFFFFFFh
		or	eax, edx
		test	eax, eax
		jnz	short loc_42F8DD
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_42F8F2
; ---------------------------------------------------------------------------

loc_42F8DD:				; CODE XREF: sub_42F869+69j
		mov	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	[ebp+var_C], 0

loc_42F8F2:				; CODE XREF: sub_42F869+2Bj
					; sub_42F869+72j
		mov	eax, [ebp+var_C]
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_42F869	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42F8FB	proc near		; CODE XREF: .text:00431619p
					; sub_4319B3+DAp ...

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_42F94E
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_42F920
		mov	[ebp+var_C], 0
		jmp	short loc_42F941
; ---------------------------------------------------------------------------

loc_42F920:				; CODE XREF: sub_42F8FB+1Aj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_42F939
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		call	_close
		jmp	short loc_42F93E
; ---------------------------------------------------------------------------

loc_42F939:				; CODE XREF: sub_42F8FB+2Dj
		mov	eax, 0

loc_42F93E:				; CODE XREF: sub_42F8FB+3Cj
		mov	[ebp+var_C], eax

loc_42F941:				; CODE XREF: sub_42F8FB+23j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_42ECA5
		jmp	short loc_42F955
; ---------------------------------------------------------------------------

loc_42F94E:				; CODE XREF: sub_42F8FB+10j
		mov	[ebp+var_C], 0

loc_42F955:				; CODE XREF: sub_42F8FB+51j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_42F8FB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42F95A(int, FILE *, int, int)
sub_42F95A	proc near		; CODE XREF: sub_431AE8+67p

File		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+File],	8 ; size_t
		call	sub_42EC5B
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_42F97E
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_42F9C5
; ---------------------------------------------------------------------------

loc_42F97E:				; CODE XREF: sub_42F95A+19j
		mov	eax, [ebp+arg_8]
		and	eax, 8000h
		test	eax, eax
		jz	short loc_42F9A5
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+File],	eax ; File
		call	_fileno
		mov	[esp+28h+var_24], 8000h
		mov	[esp+28h+File],	eax
		call	_setmode

loc_42F9A5:				; CODE XREF: sub_42F95A+2Ej
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_42F9C5:				; CODE XREF: sub_42F95A+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_42F95A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42F9CA(int, void *, size_t)
sub_42F9CA	proc near		; DATA XREF: .data:off_444C2Co

DstBuf		= dword	ptr -28h
ElementSize	= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_42FA07
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Count], eax ; Count
		mov	[esp+28h+ElementSize], 1 ; ElementSize
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+DstBuf], eax ;	DstBuf
		call	fread
		mov	[ebp+var_C], eax
		jmp	short loc_42FA0E
; ---------------------------------------------------------------------------

loc_42FA07:				; CODE XREF: sub_42F9CA+13j
		mov	[ebp+var_C], 0

loc_42FA0E:				; CODE XREF: sub_42F9CA+3Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_42FA2C
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+DstBuf], eax ;	File
		call	ferror
		test	eax, eax
		jz	short loc_42FA2C
		mov	eax, 0FFFFFFFFh
		jmp	short locret_42FA2F
; ---------------------------------------------------------------------------

loc_42FA2C:				; CODE XREF: sub_42F9CA+48j
					; sub_42F9CA+59j
		mov	eax, [ebp+var_C]

locret_42FA2F:				; CODE XREF: sub_42F9CA+60j
		leave
		retn
sub_42F9CA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_42FA31(int, void *, size_t)
sub_42FA31	proc near		; DATA XREF: .data:off_444C30o

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_42FA6E
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Count], eax ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		mov	[ebp+var_C], eax
		jmp	short loc_42FA74
; ---------------------------------------------------------------------------

loc_42FA6E:				; CODE XREF: sub_42FA31+13j
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax

loc_42FA74:				; CODE XREF: sub_42FA31+3Bj
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jz	short loc_42FA83
		mov	eax, 0FFFFFFFFh
		jmp	short locret_42FA86
; ---------------------------------------------------------------------------

loc_42FA83:				; CODE XREF: sub_42FA31+49j
		mov	eax, [ebp+var_C]

locret_42FA86:				; CODE XREF: sub_42FA31+50j
		leave
		retn
sub_42FA31	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42FA88	proc near		; DATA XREF: .data:off_444C34o

File		= dword	ptr -28h
Offset		= dword	ptr -24h
Origin		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_42FAB1
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 1Dh
		mov	eax, 0FFFFFFFFh
		jmp	short locret_42FB10
; ---------------------------------------------------------------------------

loc_42FAB1:				; CODE XREF: sub_42FA88+13j
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Origin], ecx ;	Origin
		mov	[esp+28h+Offset], edx ;	Offset
		mov	[esp+28h+File],	eax ; File
		call	fseek
		test	eax, eax
		jz	short loc_42FADE
		mov	eax, 0FFFFFFFFh
		jmp	short locret_42FB10
; ---------------------------------------------------------------------------

loc_42FADE:				; CODE XREF: sub_42FA88+4Dj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		call	ftell
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_42FAFB
		mov	eax, 0FFFFFFFFh
		jmp	short locret_42FB10
; ---------------------------------------------------------------------------

loc_42FAFB:				; CODE XREF: sub_42FA88+6Aj
		mov	eax, [ebp+var_10]
		mov	edx, eax
		sar	edx, 1Fh
		mov	ecx, [ebp+arg_4]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	eax, 0

locret_42FB10:				; CODE XREF: sub_42FA88+27j
					; sub_42FA88+54j ...
		leave
		retn
sub_42FA88	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42FB12	proc near		; CODE XREF: sub_431AE8+101p
					; DATA XREF: .data:off_444C38o

File		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_42FB71
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_42FB5D
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		call	fflush
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_42FB53
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		call	fclose
		jmp	short loc_42FB58
; ---------------------------------------------------------------------------

loc_42FB53:				; CODE XREF: sub_42FB12+30j
		mov	eax, 0

loc_42FB58:				; CODE XREF: sub_42FB12+3Fj
		mov	[ebp+var_C], eax
		jmp	short loc_42FB64
; ---------------------------------------------------------------------------

loc_42FB5D:				; CODE XREF: sub_42FB12+19j
		mov	[ebp+var_C], 0

loc_42FB64:				; CODE XREF: sub_42FB12+49j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+File],	eax ; void *
		call	sub_42ECA5
		jmp	short loc_42FB78
; ---------------------------------------------------------------------------

loc_42FB71:				; CODE XREF: sub_42FB12+10j
		mov	[ebp+var_C], 0

loc_42FB78:				; CODE XREF: sub_42FB12+5Dj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_42FB12	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42FB7D	proc near		; CODE XREF: .text:0043155Fp
					; .text:004320C2p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0FFFFFFFFh
		mov	[esp+28h+var_28], 8 ; size_t
		call	sub_42EC5B
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_42FBAF
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_42FC1C
; ---------------------------------------------------------------------------

loc_42FBAF:				; CODE XREF: sub_42FB7D+27j
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_20], 180h
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_28], eax
		call	_open
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_42FBDB
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_42FC1C
; ---------------------------------------------------------------------------

loc_42FBDB:				; CODE XREF: sub_42FB7D+53j
		mov	eax, [ebp+arg_C]
		and	eax, 8000h
		test	eax, eax
		jz	short loc_42FBFA
		mov	[esp+28h+var_24], 8000h
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	_setmode

loc_42FBFA:				; CODE XREF: sub_42FB7D+68j
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_42FC1C:				; CODE XREF: sub_42FB7D+30j
					; sub_42FB7D+5Cj
		cmp	[ebp+var_C], 0
		jz	short loc_42FC2D
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_42ECA5

loc_42FC2D:				; CODE XREF: sub_42FB7D+A3j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_42FB7D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42FC32	proc near		; CODE XREF: .text:00431532p
					; .text:00431648p ...

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	eax, 72h
		jz	short loc_42FC52
		cmp	eax, 77h
		jz	short loc_42FC62
		cmp	eax, 61h
		jz	short loc_42FC72
		jmp	short loc_42FC82
; ---------------------------------------------------------------------------

loc_42FC52:				; CODE XREF: sub_42FC32+12j
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	short loc_42FC96
; ---------------------------------------------------------------------------

loc_42FC62:				; CODE XREF: sub_42FC32+17j
		mov	[ebp+var_C], 1
		mov	[ebp+var_10], 300h
		jmp	short loc_42FC96
; ---------------------------------------------------------------------------

loc_42FC72:				; CODE XREF: sub_42FC32+1Cj
		mov	[ebp+var_C], 1
		mov	[ebp+var_10], 108h
		jmp	short loc_42FC96
; ---------------------------------------------------------------------------

loc_42FC82:				; CODE XREF: sub_42FC32+1Ej
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_42FCF0
; ---------------------------------------------------------------------------

loc_42FC96:				; CODE XREF: sub_42FC32+2Ej
					; sub_42FC32+3Ej ...
		add	[ebp+arg_0], 1
		jmp	short loc_42FCD4
; ---------------------------------------------------------------------------

loc_42FC9C:				; CODE XREF: sub_42FC32+AAj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	eax, 62h
		jz	short loc_42FCBD
		cmp	eax, 78h
		jz	short loc_42FCC6
		cmp	eax, 2Bh
		jnz	short loc_42FCCF
		mov	[ebp+var_C], 2
		jmp	short loc_42FCD0
; ---------------------------------------------------------------------------

loc_42FCBD:				; CODE XREF: sub_42FC32+76j
		or	[ebp+var_10], 8000h
		jmp	short loc_42FCD0
; ---------------------------------------------------------------------------

loc_42FCC6:				; CODE XREF: sub_42FC32+7Bj
		or	[ebp+var_10], 400h
		jmp	short loc_42FCD0
; ---------------------------------------------------------------------------

loc_42FCCF:				; CODE XREF: sub_42FC32+80j
		nop

loc_42FCD0:				; CODE XREF: sub_42FC32+89j
					; sub_42FC32+92j ...
		add	[ebp+arg_0], 1

loc_42FCD4:				; CODE XREF: sub_42FC32+68j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_42FC9C
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, 0

locret_42FCF0:				; CODE XREF: sub_42FC32+62j
		leave
		retn
sub_42FC32	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42FCF2	proc near		; CODE XREF: sub_43052B+2Fp
					; sub_430D63+4Bp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+230h]
		test	eax, eax
		jnz	short loc_42FD27
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 28h
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_42FD83
; ---------------------------------------------------------------------------

loc_42FD27:				; CODE XREF: sub_42FCF2+1Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+230h]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_42FD76
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_42FD83
; ---------------------------------------------------------------------------

loc_42FD76:				; CODE XREF: sub_42FCF2+72j
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0

loc_42FD83:				; CODE XREF: sub_42FCF2+33j
					; sub_42FCF2+82j
		cmp	[ebp+var_10], 0
		jz	short loc_42FDA1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl
		jmp	short loc_42FDBD
; ---------------------------------------------------------------------------

loc_42FDA1:				; CODE XREF: sub_42FCF2+95j
		cmp	[ebp+var_C], 0
		jnz	short loc_42FDBD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 2
		mov	[eax+24Ch], dl

loc_42FDBD:				; CODE XREF: sub_42FCF2+ADj
					; sub_42FCF2+B3j
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_10]
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_42FCF2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42FE0D	proc near		; CODE XREF: sub_4301D1+7Cp
					; sub_430642+35p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 30h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+234h]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_42FE4E
		mov	[esp+38h+var_30], 4F3h ; int
		mov	[esp+38h+var_34], offset a____Gnupg22_11 ; "../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+38h+var_38], offset aStreamFlags_wr ; "stream->flags.writing"
		call	sub_442650

loc_42FE4E:				; CODE XREF: sub_42FE0D+23j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_42FF79
		cmp	[ebp+var_18], 0
		jnz	short loc_42FE6E
		mov	[ebp+var_C], 28h
		jmp	loc_42FF80
; ---------------------------------------------------------------------------

loc_42FE6E:				; CODE XREF: sub_42FE0D+53j
		mov	[ebp+var_14], 0
		mov	[ebp+var_C], 0
		jmp	short loc_42FEDA
; ---------------------------------------------------------------------------

loc_42FE7E:				; CODE XREF: sub_42FE0D+DEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	ecx, eax
		sub	ecx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+38h+var_30], ecx
		mov	[esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+var_18]
		call	eax
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jnz	short loc_42FEC8
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_42FECE
; ---------------------------------------------------------------------------

loc_42FEC8:				; CODE XREF: sub_42FE0D+A9j
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_10], eax

loc_42FECE:				; CODE XREF: sub_42FE0D+B9j
		mov	eax, [ebp+var_10]
		add	[ebp+var_14], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_42FEEF

loc_42FEDA:				; CODE XREF: sub_42FE0D+6Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		sub	eax, [ebp+var_14]
		test	eax, eax
		jle	short loc_42FEF0
		cmp	[ebp+var_C], 0
		jz	short loc_42FE7E
		jmp	short loc_42FEF0
; ---------------------------------------------------------------------------

loc_42FEEF:				; CODE XREF: sub_42FE0D+CBj
		nop

loc_42FEF0:				; CODE XREF: sub_42FE0D+D8j
					; sub_42FE0D+E0j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_14]
		jnz	short loc_42FF80
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+var_18]
		call	eax
		jmp	short loc_42FF80
; ---------------------------------------------------------------------------

loc_42FF79:				; CODE XREF: sub_42FE0D+49j
		mov	[ebp+var_C], 0

loc_42FF80:				; CODE XREF: sub_42FE0D+5Cj
					; sub_42FE0D+FDj ...
		cmp	[ebp+var_C], 0
		jz	short loc_42FF9C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl

loc_42FF9C:				; CODE XREF: sub_42FE0D+177j
		mov	eax, [ebp+var_C]
		add	esp, 30h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_42FE0D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42FFA6	proc near		; CODE XREF: sub_430835+116p
					; sub_43131B+33p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_42FFD6
		mov	[esp+18h+var_10], 536h ; int
		mov	[esp+18h+var_14], offset a____Gnupg22_11 ; "../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+18h+var_18], offset aStreamFlags__0 ; "!stream->flags.writing"
		call	sub_442650

loc_42FFD6:				; CODE XREF: sub_42FFA6+12j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		leave
		retn
sub_42FFA6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_42FFF6	proc near		; CODE XREF: sub_4302D5+F3p
					; .text:0043211Ap

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_4]
		mov	[eax+214h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+218h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+228h], 0
		mov	dword ptr [eax+22Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_C]
		mov	[eax+230h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_10]
		mov	[eax+234h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_14]
		mov	[eax+238h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+23Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_18]
		mov	[eax+240h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+244h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_8]
		mov	[eax+248h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFEFh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+254h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+258h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+25Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFEh
		mov	[eax+24Ch], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+24Ch], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFFDh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFF3h
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFFEh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+220h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFDFh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+arg_1C]
		and	eax, 1
		test	al, al
		jnz	short loc_4301B3
		mov	eax, [ebp+arg_1C]
		and	eax, 2
		test	eax, eax
		jz	short loc_4301C2

loc_4301B3:				; CODE XREF: sub_42FFF6+1B1j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		or	edx, 1
		mov	[eax+20h], dl
		jmp	short loc_4301CF
; ---------------------------------------------------------------------------

loc_4301C2:				; CODE XREF: sub_42FFF6+1BBj
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_4301CF:				; CODE XREF: sub_42FFF6+1CAj
		pop	ebp
		retn
sub_42FFF6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4301D1	proc near		; CODE XREF: sub_4302D5+130p
					; sub_43041A+2Bp ...

File		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+25Ch]
		test	eax, eax
		jz	short loc_430223
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+25Ch]
		mov	[esp+28h+File],	eax ; File
		call	fclose
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+25Ch], 0
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_430223:				; CODE XREF: sub_4301D1+14j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+240h]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_430267
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax
		call	sub_42FE0D
		mov	[ebp+var_18], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_430267
		cmp	[ebp+var_18], 0
		jz	short loc_430267
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_430267:				; CODE XREF: sub_4301D1+74j
					; sub_4301D1+88j ...
		cmp	[ebp+var_14], 0
		jz	short loc_430296
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+File],	eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_430296
		cmp	[ebp+var_18], 0
		jz	short loc_430296
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_430296:				; CODE XREF: sub_4301D1+9Aj
					; sub_4301D1+B7j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	[esp+28h+File],	eax ; void *
		call	sub_42ECA5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+220h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFDFh
		mov	[eax+250h], dl
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4301D1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4302D5	proc near		; CODE XREF: sub_430E4D+C8p
					; .text:004315C3p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[esp+38h+var_38], 28h ;	size_t
		call	sub_42EC5B
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_43030A
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_4303F3
; ---------------------------------------------------------------------------

loc_43030A:				; CODE XREF: sub_4302D5+27j
		mov	[esp+38h+var_38], 260h ; size_t
		call	sub_42EC5B
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_43032B
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_4303F3
; ---------------------------------------------------------------------------

loc_43032B:				; CODE XREF: sub_4302D5+48j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+4], 200h
		mov	eax, [ebp+var_14]
		lea	edx, [eax+200h]
		mov	eax, [ebp+var_10]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+18h], 10h
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		mov	[eax+24h], edx
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_43037E
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+38h+var_38], eax
		call	sub_42EC51
		jmp	short loc_430391
; ---------------------------------------------------------------------------

loc_43037E:				; CODE XREF: sub_4302D5+91j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+38h+var_38], eax
		call	pth_mutex_init

loc_430391:				; CODE XREF: sub_4302D5+A7j
		mov	eax, [ebp+arg_1C]
		mov	[esp+38h+var_1C], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+var_24], eax
		mov	eax, [ebp+arg_18]
		mov	[esp+38h+var_20], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_42FFF6
		mov	eax, [ebp+arg_20]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_42ECBE
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4303F2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_4303F3
; ---------------------------------------------------------------------------

loc_4303F2:				; CODE XREF: sub_4302D5+111j
		nop

loc_4303F3:				; CODE XREF: sub_4302D5+30j
					; sub_4302D5+51j ...
		cmp	[ebp+var_C], 0
		jz	short loc_430415
		cmp	[ebp+var_10], 0
		jz	short loc_430415
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_4301D1
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax ;	void *
		call	sub_42ECA5

loc_430415:				; CODE XREF: sub_4302D5+122j
					; sub_4302D5+128j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4302D5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43041A(void *, int)
sub_43041A	proc near		; CODE XREF: sub_430E4D+32Bp
					; .text:0043214Ap ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_0], 0
		jz	short loc_430466
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42ED92
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4301D1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_42ECA5
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_42ECA5

loc_430466:				; CODE XREF: sub_43041A+11j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_43041A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43046B	proc near		; CODE XREF: sub_430642+DFp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+230h]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	short loc_4304DE
; ---------------------------------------------------------------------------

loc_430492:				; CODE XREF: sub_43046B+79j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_4304D2
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_4304E9
; ---------------------------------------------------------------------------

loc_4304D2:				; CODE XREF: sub_43046B+5Cj
		cmp	[ebp+var_18], 0
		jz	short loc_4304E8
		mov	eax, [ebp+var_18]
		add	[ebp+var_C], eax

loc_4304DE:				; CODE XREF: sub_43046B+25j
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jnz	short loc_430492
		jmp	short loc_4304E9
; ---------------------------------------------------------------------------

loc_4304E8:				; CODE XREF: sub_43046B+6Bj
		nop

loc_4304E9:				; CODE XREF: sub_43046B+65j
					; sub_43046B+7Bj
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+var_C]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_43046B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43052B	proc near		; CODE XREF: sub_430614+21p
					; sub_430642+141p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		jmp	loc_4305F2
; ---------------------------------------------------------------------------

loc_430544:				; CODE XREF: sub_43052B+D3j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_430576
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_42FCF2
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_430576
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	loc_430606

loc_430576:				; CODE XREF: sub_43052B+27j
					; sub_43052B+3Bj
		cmp	[ebp+var_14], 0
		jnz	short loc_4305F2
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+var_18]
		jbe	short loc_4305AE
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_4305AE:				; CODE XREF: sub_43052B+7Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		add	eax, edx
		mov	edx, ecx
		mov	ecx, [ebp+var_C]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_C]
		add	[ebp+var_10], eax

loc_4305F2:				; CODE XREF: sub_43052B+14j
					; sub_43052B+4Fj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_10]
		jz	short loc_430607
		cmp	[ebp+var_14], 0
		jz	loc_430544
		jmp	short loc_430607
; ---------------------------------------------------------------------------

loc_430606:				; CODE XREF: sub_43052B+45j
		nop

loc_430607:				; CODE XREF: sub_43052B+CDj
					; sub_43052B+D9j
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		leave
		retn
sub_43052B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_430614	proc near		; CODE XREF: sub_430642+110p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_43052B
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_430614	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_430642	proc near		; CODE XREF: sub_432AD4+22p
					; sub_432DC2+6Dp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4306C9
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42FE0D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_43078D
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl
		jmp	short loc_4306C9
; ---------------------------------------------------------------------------

loc_430698:				; CODE XREF: sub_430642+97j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+14h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		sub	eax, 1
		add	eax, ecx
		movzx	eax, byte ptr [eax]
		mov	[edx], al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_0]
		mov	[eax+1Ch], edx
		add	[ebp+var_C], 1

loc_4306C9:				; CODE XREF: sub_430642+2Dj
					; sub_430642+54j
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jz	short loc_4306DB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_430698

loc_4306DB:				; CODE XREF: sub_430642+8Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+244h]
		cmp	eax, 4
		jz	short loc_4306FA
		cmp	eax, 40h
		jz	short loc_43072B
		test	eax, eax
		jz	short loc_43075C
		jmp	loc_43078E
; ---------------------------------------------------------------------------

loc_4306FA:				; CODE XREF: sub_430642+A8j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_43046B
		mov	[ebp+var_10], eax
		jmp	short loc_43078E
; ---------------------------------------------------------------------------

loc_43072B:				; CODE XREF: sub_430642+ADj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_430614
		mov	[ebp+var_10], eax
		jmp	short loc_43078E
; ---------------------------------------------------------------------------

loc_43075C:				; CODE XREF: sub_430642+B1j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_43052B
		mov	[ebp+var_10], eax
		jmp	short loc_43078E
; ---------------------------------------------------------------------------

loc_43078D:				; CODE XREF: sub_430642+41j
		nop

loc_43078E:				; CODE XREF: sub_430642+B3j
					; sub_430642+E7j ...
		cmp	[ebp+arg_C], 0
		jz	short loc_4307A1
		mov	eax, [ebp+var_18]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_4307A1:				; CODE XREF: sub_430642+150j
		mov	eax, [ebp+var_10]
		leave
		retn
sub_430642	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4307A6(int, void *, size_t, int)
sub_4307A6	proc near		; CODE XREF: .text:00432D78p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jbe	short loc_4307CF
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_8], eax

loc_4307CF:				; CODE XREF: sub_4307A6+21j
		cmp	[ebp+arg_8], 0
		jz	short loc_430824
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		add	eax, edx
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_0]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+24Ch], dl
		jmp	short loc_430825
; ---------------------------------------------------------------------------

loc_430824:				; CODE XREF: sub_4307A6+2Dj
		nop

loc_430825:				; CODE XREF: sub_4307A6+7Cj
		cmp	[ebp+arg_C], 0
		jz	short locret_430833
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+arg_8]
		mov	[eax], edx

locret_430833:				; CODE XREF: sub_4307A6+83j
		leave
		retn
sub_4307A6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_430835	proc near		; CODE XREF: sub_430C23+58p
					; sub_430E4D+270p ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_40], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+238h]
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_430878
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 28h
		mov	[ebp+var_1C], 0FFFFFFFFh
		jmp	loc_430995
; ---------------------------------------------------------------------------

loc_430878:				; CODE XREF: sub_430835+28j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4308AB
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_42FE0D
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_430994
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_4308AB:				; CODE XREF: sub_430835+4Fj
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[ebp+var_30], eax
		mov	[ebp+var_2C], edx
		cmp	[ebp+arg_C], 1
		jnz	short loc_43090A
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+8]
		mov	ebx, 0
		mov	esi, eax
		mov	edi, edx
		sub	esi, ecx
		sbb	edi, ebx
		mov	ecx, esi
		mov	ebx, edi
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[ebp+var_30], eax
		mov	[ebp+var_2C], edx
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+1Ch]
		mov	ebx, 0
		sub	eax, ecx
		sbb	edx, ebx
		mov	[ebp+var_30], eax
		mov	[ebp+var_2C], edx

loc_43090A:				; CODE XREF: sub_430835+86j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	edx, [ebp+arg_C]
		mov	[esp+58h+var_50], edx
		lea	edx, [ebp+var_30]
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+var_20]
		call	eax
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0FFFFFFFFh
		jnz	short loc_43093E
		mov	[ebp+var_1C], 0FFFFFFFFh
		jmp	short loc_430995
; ---------------------------------------------------------------------------

loc_43093E:				; CODE XREF: sub_430835+FEj
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_42FFA6
		cmp	[ebp+arg_10], 0
		jz	short loc_430964
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	ecx, [ebp+arg_10]
		mov	[ecx], eax
		mov	[ecx+4], edx

loc_430964:				; CODE XREF: sub_430835+11Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+24Ch], dl
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+24h]
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	[ecx+228h], eax
		mov	[ecx+22Ch], edx
		jmp	short loc_430995
; ---------------------------------------------------------------------------

loc_430994:				; CODE XREF: sub_430835+63j
		nop

loc_430995:				; CODE XREF: sub_430835+3Ej
					; sub_430835+107j ...
		cmp	[ebp+var_1C], 0
		jz	short loc_4309B1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl

loc_4309B1:				; CODE XREF: sub_430835+164j
		mov	eax, [ebp+var_1C]
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_430835	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4309BC	proc near		; CODE XREF: sub_430B5D+79p
					; sub_430C23+B6p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+234h]
		mov	[ebp+var_14], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_4309EB
		cmp	[ebp+var_14], 0
		jnz	short loc_4309EB
		mov	[ebp+var_10], 28h
		jmp	loc_430A81
; ---------------------------------------------------------------------------

loc_4309EB:				; CODE XREF: sub_4309BC+1Bj
					; sub_4309BC+21j
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	short loc_430A41
; ---------------------------------------------------------------------------

loc_4309FB:				; CODE XREF: sub_4309BC+8Bj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_430A3B
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_430A49
; ---------------------------------------------------------------------------

loc_430A3B:				; CODE XREF: sub_4309BC+74j
		mov	eax, [ebp+var_18]
		add	[ebp+var_C], eax

loc_430A41:				; CODE XREF: sub_4309BC+3Dj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jnz	short loc_4309FB

loc_430A49:				; CODE XREF: sub_4309BC+7Dj
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+var_C]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_C]
		mov	[eax], edx

loc_430A81:				; CODE XREF: sub_4309BC+2Aj
		mov	eax, [ebp+var_10]
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_4309BC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_430A8B	proc near		; CODE XREF: sub_430B5D+ACp
					; sub_430C23+100p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		jmp	loc_430B3E
; ---------------------------------------------------------------------------

loc_430AA4:				; CODE XREF: sub_430A8B+BFj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnz	short loc_430AC2
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_42FE0D
		mov	[ebp+var_14], eax

loc_430AC2:				; CODE XREF: sub_430A8B+27j
		cmp	[ebp+var_14], 0
		jnz	short loc_430B3E
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+var_18]
		jbe	short loc_430AFA
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_430AFA:				; CODE XREF: sub_430A8B+67j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		lea	ecx, [edx+eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	eax, edx
		mov	edx, ecx
		mov	ecx, [ebp+var_C]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_C]
		add	[ebp+var_10], eax

loc_430B3E:				; CODE XREF: sub_430A8B+14j
					; sub_430A8B+3Bj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_10]
		jz	short loc_430B50
		cmp	[ebp+var_14], 0
		jz	loc_430AA4

loc_430B50:				; CODE XREF: sub_430A8B+B9j
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		leave
		retn
sub_430A8B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_430B5D	proc near		; CODE XREF: sub_430C23+DBp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+var_24], 0Ah
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_43A2E1
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_430BDE
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42FE0D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_430BDE
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_4]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4309BC
		mov	[ebp+var_C], eax

loc_430BDE:				; CODE XREF: sub_430B5D+3Cj
					; sub_430B5D+50j
		cmp	[ebp+var_C], 0
		jnz	short loc_430C11
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_14]
		add	eax, [ebp+arg_4]
		lea	edx, [ebp+var_18]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_430A8B
		mov	[ebp+var_C], eax

loc_430C11:				; CODE XREF: sub_430B5D+85j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		add	edx, eax
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		leave
		retn
sub_430B5D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_430C23	proc near		; CODE XREF: sub_4311C6+2Ep
					; .text:004318B0p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_430CA2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+238h]
		test	eax, eax
		jz	short loc_430CA2
		mov	[esp+38h+var_28], 0
		mov	[esp+38h+var_2C], 1
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_30], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_430835
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_430CA2
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 1Dh
		jnz	loc_430D2D
		mov	[ebp+var_C], 0

loc_430CA2:				; CODE XREF: sub_430C23+20j
					; sub_430C23+30j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+244h]
		cmp	eax, 4
		jz	short loc_430CBE
		cmp	eax, 40h
		jz	short loc_430CE3
		test	eax, eax
		jz	short loc_430D08
		jmp	short loc_430D2E
; ---------------------------------------------------------------------------

loc_430CBE:				; CODE XREF: sub_430C23+8Ej
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_4309BC
		mov	[ebp+var_C], eax
		jmp	short loc_430D2E
; ---------------------------------------------------------------------------

loc_430CE3:				; CODE XREF: sub_430C23+93j
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_430B5D
		mov	[ebp+var_C], eax
		jmp	short loc_430D2E
; ---------------------------------------------------------------------------

loc_430D08:				; CODE XREF: sub_430C23+97j
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_430A8B
		mov	[ebp+var_C], eax
		jmp	short loc_430D2E
; ---------------------------------------------------------------------------

loc_430D2D:				; CODE XREF: sub_430C23+72j
		nop

loc_430D2E:				; CODE XREF: sub_430C23+99j
					; sub_430C23+BEj ...
		cmp	[ebp+arg_C], 0
		jz	short loc_430D3C
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_430D3C:				; CODE XREF: sub_430C23+10Fj
		mov	eax, [ebp+var_10]
		test	eax, eax
		jz	short loc_430D5E
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_430D5E
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		or	edx, 1
		mov	[eax+20h], dl

loc_430D5E:				; CODE XREF: sub_430C23+11Ej
					; sub_430C23+12Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_430C23	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_430D63	proc near		; CODE XREF: sub_430E4D+10Ep

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_430D98
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42FE0D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_430DF6
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_430D98:				; CODE XREF: sub_430D63+12j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_430DBC
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42FCF2
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_430DF9

loc_430DBC:				; CODE XREF: sub_430D63+43j
		cmp	[ebp+arg_4], 0
		jz	short loc_430DD4
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], edx

loc_430DD4:				; CODE XREF: sub_430D63+5Dj
		cmp	[ebp+arg_8], 0
		jz	short loc_430DED
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		sub	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_430DED:				; CODE XREF: sub_430D63+75j
		mov	[ebp+var_C], 0
		jmp	short loc_430DFA
; ---------------------------------------------------------------------------

loc_430DF6:				; CODE XREF: sub_430D63+26j
		nop
		jmp	short loc_430DFA
; ---------------------------------------------------------------------------

loc_430DF9:				; CODE XREF: sub_430D63+57j
		nop

loc_430DFA:				; CODE XREF: sub_430D63+91j
					; sub_430D63+94j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_430D63	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_430DFF	proc near		; CODE XREF: sub_430E4D+1BBp
					; sub_430E4D+207p

var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jbe	short loc_430E30
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_430E48
; ---------------------------------------------------------------------------

loc_430E30:				; CODE XREF: sub_430DFF+19j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	[ebp+var_C], 0

loc_430E48:				; CODE XREF: sub_430DFF+2Fj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_430DFF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_430E4D	proc near		; CODE XREF: .text:004333BAp

Buf		= dword	ptr -68h
Val		= dword	ptr -64h
MaxCount	= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	[ebp+var_14], 0
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		lea	eax, [ebp+var_24]
		mov	[esp+68h+var_44], 0
		mov	[esp+68h+var_48], 2
		mov	[esp+68h+var_4C], offset sub_42ECA5
		mov	[esp+68h+var_50], offset sub_42EC78
		mov	[esp+68h+var_54], 1
		mov	[esp+68h+var_58], 200h
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+MaxCount], 0
		mov	[esp+68h+Val], 0
		mov	[esp+68h+Buf], eax
		call	sub_42F084
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_431156
		mov	eax, [ebp+var_24]
		mov	[esp+68h+var_48], 0
		mov	[esp+68h+var_4C], 2
		mov	edx, off_444C0C
		mov	[esp+68h+var_5C], edx
		mov	edx, off_444C10
		mov	[esp+68h+var_58], edx
		mov	edx, off_444C14
		mov	[esp+68h+var_54], edx
		mov	edx, off_444C18
		mov	[esp+68h+var_50], edx
		mov	[esp+68h+MaxCount], 0FFFFFFFFh
		mov	[esp+68h+Val], eax
		lea	eax, [ebp+var_20]
		mov	[esp+68h+Buf], eax
		call	sub_4302D5
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_431159
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	short loc_430F37
; ---------------------------------------------------------------------------

loc_430F36:				; CODE XREF: sub_430E4D+210j
		nop

loc_430F37:				; CODE XREF: sub_430E4D+E7j
		cmp	[ebp+arg_4], 0
		jz	short loc_430F47
		cmp	[ebp+var_C], 1
		jz	loc_431065

loc_430F47:				; CODE XREF: sub_430E4D+EEj
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+MaxCount], eax
		lea	eax, [ebp+var_28]
		mov	[esp+68h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Buf], eax
		call	sub_430D63
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_431066
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jz	loc_431066
		mov	eax, [ebp+var_C]
		lea	edx, [eax-1]
		mov	eax, [ebp+var_2C]
		cmp	edx, eax
		jnb	short loc_430F8E
		mov	eax, [ebp+var_C]
		sub	eax, 1
		mov	[ebp+var_2C], eax

loc_430F8E:				; CODE XREF: sub_430E4D+136j
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	[esp+68h+MaxCount], edx	; MaxCount
		mov	[esp+68h+Val], 0Ah ; Val
		mov	[esp+68h+Buf], eax ; Buf
		call	memchr
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_43100F
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_28]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+MaxCount], ecx
		mov	[esp+68h+Val], edx
		mov	[esp+68h+Buf], eax
		call	sub_432E77
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_431059
		mov	eax, [ebp+var_2C]
		sub	[ebp+var_C], eax
		mov	eax, [ebp+var_2C]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Buf], eax
		call	sub_430DFF
		jmp	short loc_431066
; ---------------------------------------------------------------------------

loc_43100F:				; CODE XREF: sub_430E4D+162j
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+MaxCount], ecx
		mov	[esp+68h+Val], edx
		mov	[esp+68h+Buf], eax
		call	sub_432E77
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_431059
		mov	eax, [ebp+var_2C]
		sub	[ebp+var_C], eax
		mov	eax, [ebp+var_2C]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Buf], eax
		call	sub_430DFF

loc_431059:				; CODE XREF: sub_430E4D+1A0j
					; sub_430E4D+1ECj
		cmp	[ebp+var_18], 0
		jz	loc_430F36
		jmp	short loc_431066
; ---------------------------------------------------------------------------

loc_431065:				; CODE XREF: sub_430E4D+F4j
		nop

loc_431066:				; CODE XREF: sub_430E4D+11Aj
					; sub_430E4D+125j ...
		cmp	[ebp+var_18], 0
		jnz	loc_43115C
		cmp	[ebp+arg_4], 1
		jbe	short loc_431097
		cmp	[ebp+var_10], 0
		jnz	short loc_431097
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 2
		mov	[eax+24Ch], dl
		jmp	loc_431163
; ---------------------------------------------------------------------------

loc_431097:				; CODE XREF: sub_430E4D+227j
					; sub_430E4D+22Dj
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_58], 0
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+Val], 0
		mov	[esp+68h+MaxCount], 0
		mov	[esp+68h+Buf], eax
		call	sub_430835
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_43115F
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4310F8
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[esp+68h+Buf], eax ; size_t
		call	sub_42EC5B
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_431100
		mov	[ebp+var_18], 0FFFFFFFFh
		jmp	short loc_431163
; ---------------------------------------------------------------------------

loc_4310F8:				; CODE XREF: sub_430E4D+289j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_431100:				; CODE XREF: sub_430E4D+2A0j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_5C], 0
		mov	ecx, [ebp+var_10]
		mov	[esp+68h+MaxCount], ecx
		mov	[esp+68h+Val], edx
		mov	[esp+68h+Buf], eax
		call	sub_432DC2
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_431162
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		add	eax, edx
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_431146
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_431146:				; CODE XREF: sub_430E4D+2EFj
		cmp	[ebp+arg_C], 0
		jz	short loc_431163
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_431163
; ---------------------------------------------------------------------------

loc_431156:				; CODE XREF: sub_430E4D+75j
		nop
		jmp	short loc_431163
; ---------------------------------------------------------------------------

loc_431159:				; CODE XREF: sub_430E4D+D4j
		nop
		jmp	short loc_431163
; ---------------------------------------------------------------------------

loc_43115C:				; CODE XREF: sub_430E4D+21Dj
		nop
		jmp	short loc_431163
; ---------------------------------------------------------------------------

loc_43115F:				; CODE XREF: sub_430E4D+27Cj
		nop
		jmp	short loc_431163
; ---------------------------------------------------------------------------

loc_431162:				; CODE XREF: sub_430E4D+2DBj
		nop

loc_431163:				; CODE XREF: sub_430E4D+245j
					; sub_430E4D+2A9j ...
		mov	eax, [ebp+var_20]
		test	eax, eax
		jz	short loc_43117F
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Val], 0 ; int
		mov	[esp+68h+Buf], eax ; void *
		call	sub_43041A
		jmp	short loc_431191
; ---------------------------------------------------------------------------

loc_43117F:				; CODE XREF: sub_430E4D+31Bj
		mov	eax, [ebp+var_24]
		test	eax, eax
		jz	short loc_431191
		mov	eax, [ebp+var_24]
		mov	[esp+68h+Buf], eax
		call	sub_42F6F7

loc_431191:				; CODE XREF: sub_430E4D+330j
					; sub_430E4D+337j
		cmp	[ebp+var_18], 0
		jz	short loc_4311C1
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4311AB
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Buf], eax ; void *
		call	sub_42ECA5

loc_4311AB:				; CODE XREF: sub_430E4D+351j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl

loc_4311C1:				; CODE XREF: sub_430E4D+348j
		mov	eax, [ebp+var_18]
		leave
		retn
sub_430E4D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4311C6	proc near		; DATA XREF: sub_43121E+2Bo

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_4]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_430C23
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_C]
		mov	edx, [edx+24h]
		mov	ecx, [edx+258h]
		mov	edx, [ebp+var_14]
		add	edx, ecx
		mov	[eax+258h], edx
		mov	eax, [ebp+var_10]
		leave
		retn
sub_4311C6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43121E	proc near		; CODE XREF: .text:00433816p
					; .text:00433879p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+258h], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], offset sub_4311C6
		call	sub_42940F
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_431265
		mov	eax, 0FFFFFFFFh
		jmp	short locret_431271
; ---------------------------------------------------------------------------

loc_431265:				; CODE XREF: sub_43121E+3Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+258h]

locret_431271:				; CODE XREF: sub_43121E+45j
		leave
		retn
sub_43121E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_431273	proc near		; CODE XREF: sub_43131B+4Ep
					; .text:00431926p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jz	short loc_4312A0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		cmp	[ebp+arg_4], 0
		setnz	dl
		mov	ecx, edx
		and	ecx, 1
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFEh
		or	edx, ecx
		mov	[eax+24Ch], dl

loc_4312A0:				; CODE XREF: sub_431273+7j
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jz	short loc_4312CB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		cmp	[ebp+arg_8], 0
		setnz	dl
		and	edx, 1
		lea	ecx, [edx+edx]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		or	edx, ecx
		mov	[eax+24Ch], dl

loc_4312CB:				; CODE XREF: sub_431273+31j
		pop	ebp
		retn
sub_431273	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4312CD	proc near		; CODE XREF: sub_432486+1Cp
					; sub_432536+1Cp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_4312F8
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+24Ch]
		and	eax, 1
		movzx	eax, al
		mov	[ebp+var_4], eax
		jmp	short loc_431316
; ---------------------------------------------------------------------------

loc_4312F8:				; CODE XREF: sub_4312CD+11j
		cmp	[ebp+arg_8], 0
		jz	short loc_431316
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+24Ch]
		shr	al, 1
		and	eax, 1
		movzx	eax, al
		mov	[ebp+var_4], eax

loc_431316:				; CODE XREF: sub_4312CD+29j
					; sub_4312CD+2Fj
		mov	eax, [ebp+var_4]
		leave
		retn
sub_4312CD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43131B(int, int, int,	size_t)
sub_43131B	proc near		; CODE XREF: .text:00431FBDp
					; .text:00433DB6p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_431348
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42FE0D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_431353
		jmp	loc_43143B
; ---------------------------------------------------------------------------

loc_431348:				; CODE XREF: sub_43131B+12j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42FFA6

loc_431353:				; CODE XREF: sub_43131B+26j
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_431273
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		and	eax, 1
		test	al, al
		jz	short loc_4313AE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFFEh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_42ECA5
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0

loc_4313AE:				; CODE XREF: sub_43131B+65j
		cmp	[ebp+arg_8], 4
		jnz	short loc_4313C0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 0
		jmp	short loc_431425
; ---------------------------------------------------------------------------

loc_4313C0:				; CODE XREF: sub_43131B+97j
		cmp	[ebp+arg_4], 0
		jz	short loc_4313CE
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		jmp	short loc_4313F8
; ---------------------------------------------------------------------------

loc_4313CE:				; CODE XREF: sub_43131B+A9j
		cmp	[ebp+arg_C], 0
		jnz	short loc_4313DB
		mov	[ebp+arg_C], 200h

loc_4313DB:				; CODE XREF: sub_43131B+B7j
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_28], eax ;	size_t
		call	sub_42EC5B
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4313F8
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_43143B
; ---------------------------------------------------------------------------

loc_4313F8:				; CODE XREF: sub_43131B+B1j
					; sub_43131B+D2j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_C]
		mov	[eax+4], edx
		cmp	[ebp+arg_4], 0
		jnz	short loc_431425
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		or	edx, 1
		mov	[eax+250h], dl

loc_431425:				; CODE XREF: sub_43131B+A3j
					; sub_43131B+F2j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_8]
		mov	[eax+244h], edx
		mov	[ebp+var_C], 0

loc_43143B:				; CODE XREF: sub_43131B+28j
					; sub_43131B+DBj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_43131B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_431440	proc near		; CODE XREF: .text:00432932p
					; .text:004329CDp

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jl	short loc_431498
		cmp	edx, [ebp+var_C]
		jg	short loc_431488
		cmp	eax, [ebp+var_10]
		jbe	short loc_431498

loc_431488:				; CODE XREF: sub_431440+41j
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		jmp	short loc_4314A9
; ---------------------------------------------------------------------------

loc_431498:				; CODE XREF: sub_431440+3Cj
					; sub_431440+46j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, 0
		sub	[ebp+var_10], eax
		sbb	[ebp+var_C], edx

loc_4314A9:				; CODE XREF: sub_431440+56j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_431440	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4314B5	proc near		; CODE XREF: .text:00433F14p
					; .text:00433FAAp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_8], 0
		jz	short loc_4314CF
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [eax+218h]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_4314CF:				; CODE XREF: sub_4314B5+7j
		cmp	[ebp+arg_4], 0
		jz	short loc_4314E4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_4]
		mov	[eax+218h], edx

loc_4314E4:				; CODE XREF: sub_4314B5+1Ej
		pop	ebp
		retn
sub_4314B5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4314E6	proc near		; CODE XREF: sub_432307+Cp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+248h]
		pop	ebp
		retn
sub_4314E6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4314F7	proc near		; CODE XREF: sub_4257EC+17p

var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_42F015
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4314F7	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-0Ch], 0
		lea	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_42FC32
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_4315FA
		mov	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		lea	eax, [ebp-20h]
		mov	[esp+4], eax
		lea	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_42FB7D
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_4315FD
		mov	dword ptr [ebp-0Ch], 1
		mov	ecx, [ebp-14h]
		mov	edx, [ebp-20h]
		mov	eax, [ebp-1Ch]
		mov	dword ptr [esp+20h], 0
		mov	[esp+1Ch], ecx
		mov	ecx, off_444C1C
		mov	[esp+0Ch], ecx
		mov	ecx, off_444C20
		mov	[esp+10h], ecx
		mov	ecx, off_444C24
		mov	[esp+14h], ecx
		mov	ecx, off_444C28
		mov	[esp+18h], ecx
		mov	[esp+8], edx
		mov	[esp+4], eax
		lea	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_4302D5
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_431600
		mov	eax, [ebp-18h]
		test	eax, eax
		jz	short loc_431601
		cmp	dword ptr [ebp+8], 0
		jz	short loc_431601
		mov	eax, [ebp-18h]
		mov	dword ptr [esp+8], 1
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_433FE6
		jmp	short loc_431601
; ---------------------------------------------------------------------------

loc_4315FA:				; CODE XREF: .text:0043153Ej
		nop
		jmp	short loc_431601
; ---------------------------------------------------------------------------

loc_4315FD:				; CODE XREF: .text:0043156Bj
		nop
		jmp	short loc_431601
; ---------------------------------------------------------------------------

loc_431600:				; CODE XREF: .text:004315CFj
		nop

loc_431601:				; CODE XREF: .text:004315D6j
					; .text:004315DCj ...
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_43161B
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_43161B
		mov	edx, off_444C28
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	edx ; sub_42F8FB

loc_43161B:				; CODE XREF: .text:00431605j
					; .text:0043160Bj
		mov	eax, [ebp-18h]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-0Ch], 0
		lea	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp+20h]
		mov	[esp], eax
		call	sub_42FC32
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_43170C
		mov	edx, [ebp-14h]
		lea	eax, [ebp-1Ch]
		mov	dword ptr [esp+24h], 0
		mov	[esp+20h], edx
		mov	edx, [ebp+1Ch]
		mov	[esp+1Ch], edx
		mov	edx, [ebp+18h]
		mov	[esp+18h], edx
		mov	edx, [ebp+14h]
		mov	[esp+14h], edx
		mov	dword ptr [esp+10h], 200h
		mov	edx, [ebp+10h]
		mov	[esp+0Ch], edx
		mov	edx, [ebp+0Ch]
		mov	[esp+8], edx
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_42F084
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_43170F
		mov	dword ptr [ebp-0Ch], 1
		mov	edx, [ebp-14h]
		mov	eax, [ebp-1Ch]
		mov	dword ptr [esp+20h], 0
		mov	[esp+1Ch], edx
		mov	edx, off_444C0C
		mov	[esp+0Ch], edx
		mov	edx, off_444C10
		mov	[esp+10h], edx
		mov	edx, off_444C14
		mov	[esp+14h], edx
		mov	edx, off_444C18
		mov	[esp+18h], edx
		mov	dword ptr [esp+8], 0FFFFFFFFh
		mov	[esp+4], eax
		lea	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_4302D5
		mov	[ebp-10h], eax
		jmp	short loc_431710
; ---------------------------------------------------------------------------

loc_43170C:				; CODE XREF: .text:00431654j
		nop
		jmp	short loc_431710
; ---------------------------------------------------------------------------

loc_43170F:				; CODE XREF: .text:004316ADj
		nop

loc_431710:				; CODE XREF: .text:0043170Aj
					; .text:0043170Dj
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_43172A
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_43172A
		mov	edx, off_444C18
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	edx ; sub_42F6F7

loc_43172A:				; CODE XREF: .text:00431714j
					; .text:0043171Aj
		mov	eax, [ebp-18h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43172F	proc near		; CODE XREF: .text:0043186Ep

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		lea	eax, [ebp+var_C]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	sub_42FC32
		test	eax, eax
		jz	short loc_431763
		mov	eax, 0
		jmp	locret_431845
; ---------------------------------------------------------------------------

loc_431763:				; CODE XREF: sub_43172F+28j
		mov	eax, [ebp+var_C]
		or	eax, 2
		mov	[ebp+var_C], eax
		mov	edx, [ebp+var_C]
		lea	eax, [ebp+var_14]
		mov	ecx, [ebp+arg_0]
		mov	[esp+48h+var_24], ecx
		mov	[esp+48h+var_28], edx
		mov	[esp+48h+var_2C], offset sub_42ECA5
		mov	[esp+48h+var_30], offset sub_42EC78
		mov	[esp+48h+var_34], 1
		mov	[esp+48h+var_38], 200h
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+var_44], 0
		mov	[esp+48h+var_48], eax
		call	sub_42F084
		test	eax, eax
		jz	short loc_4317C8
		mov	eax, 0
		jmp	short locret_431845
; ---------------------------------------------------------------------------

loc_4317C8:				; CODE XREF: sub_43172F+90j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_28], 0
		mov	[esp+48h+var_2C], edx
		mov	edx, off_444C0C
		mov	[esp+48h+var_3C], edx
		mov	edx, off_444C10
		mov	[esp+48h+var_38], edx
		mov	edx, off_444C14
		mov	[esp+48h+var_34], edx
		mov	edx, off_444C18
		mov	[esp+48h+var_30], edx
		mov	[esp+48h+var_40], 0FFFFFFFFh
		mov	[esp+48h+var_44], eax
		lea	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	sub_4302D5
		test	eax, eax
		jz	short loc_43182B
		mov	edx, off_444C18
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	edx ; sub_42F6F7

loc_43182B:				; CODE XREF: sub_43172F+ECj
		mov	eax, [ebp+var_10]
		test	eax, eax
		jz	short loc_431842
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+23Ch], offset sub_42F68F

loc_431842:				; CODE XREF: sub_43172F+101j
		mov	eax, [ebp+var_10]

locret_431845:				; CODE XREF: sub_43172F+2Fj
					; sub_43172F+97j
		leave
		retn
sub_43172F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_431861
		mov	eax, [ebp+8]
		cmp	eax, [ebp+14h]
		jnb	short loc_431861
		mov	eax, [ebp+14h]
		mov	[ebp+8], eax

loc_431861:				; CODE XREF: .text:00431851j
					; .text:00431859j
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_43172F
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	loc_43192B
		cmp	dword ptr [ebp+10h], 0
		jz	loc_43192B
		cmp	dword ptr [ebp+14h], 0
		jz	loc_43192B
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp+14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_430C23
		test	eax, eax
		jz	short loc_4318E5
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_4321EC
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp-10h]
		mov	[eax], edx
		jmp	short loc_43192B
; ---------------------------------------------------------------------------

loc_4318E5:				; CODE XREF: .text:004318B7j
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_430835
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_431273

loc_43192B:				; CODE XREF: .text:0043187Aj
					; .text:00431884j ...
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-10h], 0
		lea	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_42FC32
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4319AD
		mov	eax, [ebp-10h]
		mov	dword ptr [esp+20h], 0
		mov	[esp+1Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+14h]
		mov	[esp+10h], eax
		mov	eax, [ebp+18h]
		mov	[esp+14h], eax
		mov	eax, [ebp+1Ch]
		mov	[esp+18h], eax
		mov	dword ptr [esp+8], 0FFFFFFFFh
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_4302D5
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jmp	short loc_4319AE
; ---------------------------------------------------------------------------

loc_4319AD:				; CODE XREF: .text:0043195Dj
		nop

loc_4319AE:				; CODE XREF: .text:004319ABj
		mov	eax, [ebp-14h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4319B3	proc near		; CODE XREF: .text:00431AB7p
					; .text:00431AE1p ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_14]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		call	sub_42FC32
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_431A71
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_54], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	sub_42F72C
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_431A74
		mov	[ebp+var_C], 1
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_1C]
		mov	ecx, [ebp+arg_C]
		mov	[esp+58h+var_38], ecx
		mov	[esp+58h+var_3C], edx
		mov	edx, off_444C1C
		mov	[esp+58h+var_4C], edx
		mov	edx, off_444C20
		mov	[esp+58h+var_48], edx
		mov	edx, off_444C24
		mov	[esp+58h+var_44], edx
		mov	edx, off_444C28
		mov	[esp+58h+var_40], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+var_54], eax
		lea	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	sub_4302D5
		mov	[ebp+var_10], eax
		jmp	short loc_431A75
; ---------------------------------------------------------------------------

loc_431A71:				; CODE XREF: sub_4319B3+34j
		nop
		jmp	short loc_431A75
; ---------------------------------------------------------------------------

loc_431A74:				; CODE XREF: sub_4319B3+61j
		nop

loc_431A75:				; CODE XREF: sub_4319B3+BCj
					; sub_4319B3+BFj
		cmp	[ebp+var_10], 0
		jz	short loc_431A8F
		cmp	[ebp+var_C], 0
		jz	short loc_431A8F
		mov	edx, off_444C28
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	edx ; sub_42F8FB

loc_431A8F:				; CODE XREF: sub_4319B3+C6j
					; sub_4319B3+CCj
		mov	eax, [ebp+var_18]
		leave
		retn
sub_4319B3	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4319B3
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4319B3
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_431AE8(FILE *, int, int, int)
sub_431AE8	proc near		; CODE XREF: .text:00431C17p
					; .text:00431C41p ...

File		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 54h
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_14]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+File],	eax
		call	sub_42FC32
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_431BCD
		cmp	[ebp+arg_0], 0
		jz	short loc_431B34
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+File],	eax ; File
		call	fflush

loc_431B34:				; CODE XREF: sub_431AE8+3Fj
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx ;	int
		mov	[esp+58h+var_50], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_54], eax ;	FILE *
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+File],	eax ; int
		call	sub_42F95A
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_431BD0
		mov	[ebp+var_C], 1
		mov	ebx, [ebp+var_14]
		cmp	[ebp+arg_0], 0
		jz	short loc_431B7A
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+File],	eax ; File
		call	_fileno
		jmp	short loc_431B7F
; ---------------------------------------------------------------------------

loc_431B7A:				; CODE XREF: sub_431AE8+83j
		mov	eax, 0FFFFFFFFh

loc_431B7F:				; CODE XREF: sub_431AE8+90j
		mov	edx, [ebp+var_1C]
		mov	ecx, [ebp+arg_C]
		mov	[esp+58h+var_38], ecx
		mov	[esp+58h+var_3C], ebx
		mov	ecx, off_444C2C
		mov	[esp+58h+var_4C], ecx
		mov	ecx, off_444C30
		mov	[esp+58h+var_48], ecx
		mov	ecx, off_444C34
		mov	[esp+58h+var_44], ecx
		mov	ecx, off_444C38
		mov	[esp+58h+var_40], ecx
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+var_54], edx
		lea	eax, [ebp+var_18]
		mov	[esp+58h+File],	eax
		call	sub_4302D5
		mov	[ebp+var_10], eax
		jmp	short loc_431BD1
; ---------------------------------------------------------------------------

loc_431BCD:				; CODE XREF: sub_431AE8+35j
		nop
		jmp	short loc_431BD1
; ---------------------------------------------------------------------------

loc_431BD0:				; CODE XREF: sub_431AE8+73j
		nop

loc_431BD1:				; CODE XREF: sub_431AE8+E3j
					; sub_431AE8+E6j
		cmp	[ebp+var_10], 0
		jz	short loc_431BEB
		cmp	[ebp+var_C], 0
		jz	short loc_431BEB
		mov	edx, off_444C38
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+File],	eax
		call	edx ; sub_42FB12

loc_431BEB:				; CODE XREF: sub_431AE8+EDj
					; sub_431AE8+F3j
		mov	eax, [ebp+var_18]
		add	esp, 54h
		pop	ebx
		pop	ebp
		retn
sub_431AE8	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_431AE8
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_431AE8
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_431C66
		mov	eax, ds:dword_451708
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_431C82
; ---------------------------------------------------------------------------

loc_431C66:				; CODE XREF: .text:00431C55j
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp], offset	dword_451708
		call	pth_mutex_acquire

loc_431C82:				; CODE XREF: .text:00431C64j
		cmp	dword ptr [ebp+8], 0
		js	short loc_431CB5
		cmp	dword ptr [ebp+8], 2
		jg	short loc_431CB5
		mov	eax, [ebp+8]
		add	eax, offset byte_451718
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_431CB5
		mov	eax, [ebp+8]
		mov	edx, [ebp+0Ch]
		mov	ds:dword_45170C[eax*4],	edx
		mov	eax, [ebp+8]
		add	eax, offset byte_451718
		mov	byte ptr [eax],	1

loc_431CB5:				; CODE XREF: .text:00431C86j
					; .text:00431C8Cj ...
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_431CCD
		mov	eax, ds:dword_451708
		mov	[esp], eax
		call	sub_42EC51
		jmp	short locret_431CD9
; ---------------------------------------------------------------------------

loc_431CCD:				; CODE XREF: .text:00431CBCj
		mov	dword ptr [esp], offset	dword_451708
		call	pth_mutex_release

locret_431CD9:				; CODE XREF: .text:00431CCBj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		mov	ecx, [ebp+8]
		mov	edx, 55555556h
		mov	eax, ecx
		imul	edx
		mov	eax, ecx
		sar	eax, 1Fh
		sub	edx, eax
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		mov	[ebp+8], eax
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_431D22
		mov	eax, ds:dword_451708
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_431D3E
; ---------------------------------------------------------------------------

loc_431D22:				; CODE XREF: .text:00431D11j
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp], offset	dword_451708
		call	pth_mutex_acquire

loc_431D3E:				; CODE XREF: .text:00431D20j
		mov	eax, ds:dword_451704
		mov	[ebp-0Ch], eax
		jmp	short loc_431D8E
; ---------------------------------------------------------------------------

loc_431D48:				; CODE XREF: .text:00431D92j
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		and	eax, 2
		test	al, al
		jz	short loc_431D85
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		shr	al, 2
		and	eax, 3
		movzx	eax, al
		cmp	eax, [ebp+8]
		jnz	short loc_431D85
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		jmp	short loc_431D94
; ---------------------------------------------------------------------------

loc_431D85:				; CODE XREF: .text:00431D5Cj
					; .text:00431D79j
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+4]
		mov	[ebp-0Ch], eax

loc_431D8E:				; CODE XREF: .text:00431D46j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_431D48

loc_431D94:				; CODE XREF: .text:00431D83j
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_431FF8
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_431DD9
		movzx	eax, ds:byte_451718
		test	al, al
		jz	short loc_431DD9
		mov	eax, ds:dword_45170C
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aR_2 ; "r"
		mov	[esp], eax
		call	sub_4319B3
		mov	[ebp-10h], eax
		jmp	short loc_431E47
; ---------------------------------------------------------------------------

loc_431DD9:				; CODE XREF: .text:00431DA2j
					; .text:00431DADj
		cmp	dword ptr [ebp+8], 1
		jnz	short loc_431E14
		movzx	eax, ds:byte_451719
		test	al, al
		jz	short loc_431E14
		mov	eax, ds:dword_451710
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aA ; "a"
		mov	[esp], eax
		call	sub_4319B3
		mov	[ebp-10h], eax
		jmp	short loc_431E47
; ---------------------------------------------------------------------------

loc_431E14:				; CODE XREF: .text:00431DDDj
					; .text:00431DE8j
		movzx	eax, ds:byte_45171A
		test	al, al
		jz	short loc_431E47
		mov	eax, ds:dword_451714
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aA ; "a"
		mov	[esp], eax
		call	sub_4319B3
		mov	[ebp-10h], eax

loc_431E47:				; CODE XREF: .text:00431DD7j
					; .text:00431E12j ...
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_431EDF
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_431E81
		mov	eax, ds:_iob
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aR_2 ; "r"
		mov	[esp], eax
		call	sub_431AE8
		mov	[ebp-10h], eax
		jmp	short loc_431EDF
; ---------------------------------------------------------------------------

loc_431E81:				; CODE XREF: .text:00431E55j
		cmp	dword ptr [ebp+8], 1
		jnz	short loc_431EB4
		mov	eax, ds:_iob
		add	eax, 20h
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aA ; "a"
		mov	[esp], eax
		call	sub_431AE8
		mov	[ebp-10h], eax
		jmp	short loc_431EDF
; ---------------------------------------------------------------------------

loc_431EB4:				; CODE XREF: .text:00431E85j
		mov	eax, ds:_iob
		add	eax, 40h
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset aA ; "a"
		mov	[esp], eax
		call	sub_431AE8
		mov	[ebp-10h], eax

loc_431EDF:				; CODE XREF: .text:00431E4Bj
					; .text:00431E7Fj ...
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_431F5B
		cmp	dword ptr [ebp+8], 0
		jz	short loc_431EF2
		mov	eax, offset aA	; "a"
		jmp	short loc_431EF7
; ---------------------------------------------------------------------------

loc_431EF2:				; CODE XREF: .text:00431EE9j
		mov	eax, offset aR_2 ; "r"

loc_431EF7:				; CODE XREF: .text:00431EF0j
		mov	dword ptr [esp+0Ch], 1
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_431AE8
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_431F5B
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp], eax
		call	strerror
		mov	edx, offset aFatalErrorCrea ; "fatal: error creating a dummy estream f"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	[esp], ecx
		call	fprintf
		call	abort
; ---------------------------------------------------------------------------

loc_431F5B:				; CODE XREF: .text:00431EE3j
					; .text:00431F1Ej
		mov	eax, [ebp-10h]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		or	edx, 2
		mov	[eax+250h], dl
		mov	eax, [ebp-10h]
		mov	eax, [eax+24h]
		mov	edx, [ebp+8]
		and	edx, 3
		and	edx, 3
		lea	ecx, ds:0[edx*4]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFF3h
		or	edx, ecx
		mov	[eax+250h], dl
		cmp	dword ptr [ebp+8], 2
		jnz	short loc_431FC2
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 40h
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_43131B

loc_431FC2:				; CODE XREF: .text:00431F9Dj
		cmp	dword ptr [ebp+8], 0
		jz	short loc_431FDC
		cmp	dword ptr [ebp+8], 1
		jnz	short loc_431FD5
		mov	eax, offset aStdout_0 ;	"[stdout]"
		jmp	short loc_431FDA
; ---------------------------------------------------------------------------

loc_431FD5:				; CODE XREF: .text:00431FCCj
		mov	eax, offset aStderr ; "[stderr]"

loc_431FDA:				; CODE XREF: .text:00431FD3j
		jmp	short loc_431FE1
; ---------------------------------------------------------------------------

loc_431FDC:				; CODE XREF: .text:00431FC6j
		mov	eax, offset aStdin_0 ; "[stdin]"

loc_431FE1:				; CODE XREF: .text:loc_431FDAj
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_433FE6

loc_431FF8:				; CODE XREF: .text:00431D98j
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_432010
		mov	eax, ds:dword_451708
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_43201C
; ---------------------------------------------------------------------------

loc_432010:				; CODE XREF: .text:00431FFFj
		mov	dword ptr [esp], offset	dword_451708
		call	pth_mutex_release

loc_43201C:				; CODE XREF: .text:0043200Ej
		mov	eax, [ebp-10h]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		cmp	dword ptr [ebp+8], 0
		jz	loc_4321B5
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-10h], 0
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_43205E
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_432081
; ---------------------------------------------------------------------------

loc_43205E:				; CODE XREF: .text:00432046j
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_432081:				; CODE XREF: .text:0043205Cj
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4301D1
		lea	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_42FC32
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_432121
		mov	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		lea	eax, [ebp-1Ch]
		mov	[esp+4], eax
		lea	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_42FB7D
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_432124
		mov	dword ptr [ebp-10h], 1
		mov	ecx, [ebp-14h]
		mov	edx, [ebp-1Ch]
		mov	eax, [ebp-18h]
		mov	[esp+1Ch], ecx
		mov	ecx, off_444C1C
		mov	[esp+0Ch], ecx
		mov	ecx, off_444C20
		mov	[esp+10h], ecx
		mov	ecx, off_444C24
		mov	[esp+14h], ecx
		mov	ecx, off_444C28
		mov	[esp+18h], ecx
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_42FFF6
		jmp	short loc_432125
; ---------------------------------------------------------------------------

loc_432121:				; CODE XREF: .text:004320A5j
		nop
		jmp	short loc_432125
; ---------------------------------------------------------------------------

loc_432124:				; CODE XREF: .text:004320CEj
		nop

loc_432125:				; CODE XREF: .text:0043211Fj
					; .text:00432122j
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_43215B
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_43213C
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_42F8FB

loc_43213C:				; CODE XREF: .text:0043212Fj
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_43041A
		mov	dword ptr [ebp+10h], 0
		jmp	loc_4321E7
; ---------------------------------------------------------------------------

loc_43215B:				; CODE XREF: .text:00432129j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_432181
		cmp	dword ptr [ebp+8], 0
		jz	short loc_432181
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_433FE6

loc_432181:				; CODE XREF: .text:0043215Fj
					; .text:00432165j
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_4321A0
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_4321E7
; ---------------------------------------------------------------------------

loc_4321A0:				; CODE XREF: .text:00432188j
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		jmp	short loc_4321E7
; ---------------------------------------------------------------------------

loc_4321B5:				; CODE XREF: .text:0043202Bj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4301D1
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_43041A
		mov	dword ptr [ebp+10h], 0

loc_4321E7:				; CODE XREF: .text:00432156j
					; .text:0043219Ej ...
		mov	eax, [ebp+10h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4321EC(void *)
sub_4321EC	proc near		; CODE XREF: .text:004318CBp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_24], 0 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_43041A
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4321EC	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+0Ch], 0
		jz	loc_4322C4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+23Ch]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_432254
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 28h
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jmp	loc_4322E0
; ---------------------------------------------------------------------------

loc_432254:				; CODE XREF: .text:00432239j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_432283
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42FE0D
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4322DC
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_432283:				; CODE XREF: .text:00432260j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		lea	edx, [ebp-14h]
		mov	[esp+0Ch], edx
		mov	edx, [ebp+0Ch]
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		mov	eax, [ebp-10h]
		call	eax
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4322DF
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_4322C4
		mov	edx, [ebp-14h]
		mov	eax, [ebp+10h]
		mov	[eax], edx

loc_4322C4:				; CODE XREF: .text:00432217j
					; .text:004322BAj
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_43041A
		mov	[ebp-0Ch], eax
		jmp	short loc_4322E0
; ---------------------------------------------------------------------------

loc_4322DC:				; CODE XREF: .text:00432274j
		nop
		jmp	short loc_4322E0
; ---------------------------------------------------------------------------

loc_4322DF:				; CODE XREF: .text:004322B4j
		nop

loc_4322E0:				; CODE XREF: .text:0043224Fj
					; .text:004322DAj ...
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_432302
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_432302
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[esp], eax
		call	sub_42ECA5
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0

loc_432302:				; CODE XREF: .text:004322E4j
					; .text:004322EAj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_432307	proc near		; CODE XREF: .text:00432447p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		mov	[esp+4+var_4], eax
		call	sub_4314E6
		leave
		retn
sub_432307	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_43233F
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short locret_432362
; ---------------------------------------------------------------------------

loc_43233F:				; CODE XREF: .text:00432327j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

locret_432362:				; CODE XREF: .text:0043233Dj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_432389
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short locret_4323BD
; ---------------------------------------------------------------------------

loc_432389:				; CODE XREF: .text:00432371j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		call	pth_mutex_acquire
		cmp	eax, 1
		jnz	short loc_4323B8
		mov	eax, 0
		jmp	short locret_4323BD
; ---------------------------------------------------------------------------

loc_4323B8:				; CODE XREF: .text:004323AFj
		mov	eax, 0FFFFFFFFh

locret_4323BD:				; CODE XREF: .text:00432387j
					; .text:004323B6j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_4323E4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short locret_4323F7
; ---------------------------------------------------------------------------

loc_4323E4:				; CODE XREF: .text:004323CCj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

locret_4323F7:				; CODE XREF: .text:004323E2j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_43241E
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_432441
; ---------------------------------------------------------------------------

loc_43241E:				; CODE XREF: .text:00432406j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_432441:				; CODE XREF: .text:0043241Cj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_432307
		mov	[ebp-0Ch], eax
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_43246E
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_432481
; ---------------------------------------------------------------------------

loc_43246E:				; CODE XREF: .text:00432456j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_432481:				; CODE XREF: .text:0043246Cj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_432486	proc near		; CODE XREF: .text:004324F7p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	[esp+0Ch+var_4], 1
		mov	[esp+0Ch+var_8], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_4312CD
		leave
		retn
sub_432486	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_4324CE
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_4324F1
; ---------------------------------------------------------------------------

loc_4324CE:				; CODE XREF: .text:004324B6j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_4324F1:				; CODE XREF: .text:004324CCj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_432486
		mov	[ebp-0Ch], eax
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_43251E
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_432531
; ---------------------------------------------------------------------------

loc_43251E:				; CODE XREF: .text:00432506j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_432531:				; CODE XREF: .text:0043251Cj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_432536	proc near		; CODE XREF: .text:004325A7p
					; sub_434241+3E5p ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	[esp+0Ch+var_4], 0
		mov	[esp+0Ch+var_8], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_4312CD
		leave
		retn
sub_432536	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_43257E
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_4325A1
; ---------------------------------------------------------------------------

loc_43257E:				; CODE XREF: .text:00432566j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_4325A1:				; CODE XREF: .text:0043257Cj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_432536
		mov	[ebp-0Ch], eax
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_4325CE
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_4325E1
; ---------------------------------------------------------------------------

loc_4325CE:				; CODE XREF: .text:004325B6j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_4325E1:				; CODE XREF: .text:004325CCj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4325E6	proc near		; CODE XREF: .text:00432657p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	[esp+0Ch+var_4], 0
		mov	[esp+0Ch+var_8], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_431273
		leave
		retn
sub_4325E6	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_43262E
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_432651
; ---------------------------------------------------------------------------

loc_43262E:				; CODE XREF: .text:00432616j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_432651:				; CODE XREF: .text:0043262Cj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4325E6
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_43267B
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short locret_43268E
; ---------------------------------------------------------------------------

loc_43267B:				; CODE XREF: .text:00432663j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

locret_43268E:				; CODE XREF: .text:00432679j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_432690	proc near		; CODE XREF: sub_4326CB+58p
					; DATA XREF: sub_4326CB:loc_43275Fo

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4326B4
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42FE0D
		mov	[ebp+var_C], eax
		jmp	short loc_4326C6
; ---------------------------------------------------------------------------

loc_4326B4:				; CODE XREF: sub_432690+12j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_42FFA6
		mov	[ebp+var_C], 0

loc_4326C6:				; CODE XREF: sub_432690+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_432690	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4326CB	proc near		; CODE XREF: sub_42EFDE+Dp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	loc_43275F
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_4326FA
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_42EC4C
		jmp	short loc_43271D
; ---------------------------------------------------------------------------

loc_4326FA:				; CODE XREF: sub_4326CB+17j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire

loc_43271D:				; CODE XREF: sub_4326CB+2Dj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_432690
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_43274A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_42EC51
		jmp	short loc_43276E
; ---------------------------------------------------------------------------

loc_43274A:				; CODE XREF: sub_4326CB+67j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release
		jmp	short loc_43276E
; ---------------------------------------------------------------------------

loc_43275F:				; CODE XREF: sub_4326CB+Aj
		mov	[esp+28h+var_28], offset sub_432690
		call	sub_42EE55
		mov	[ebp+var_C], eax

loc_43276E:				; CODE XREF: sub_4326CB+7Dj
					; sub_4326CB+92j
		cmp	[ebp+var_C], 0
		jz	short loc_43277B
		mov	eax, 0FFFFFFFFh
		jmp	short locret_432780
; ---------------------------------------------------------------------------

loc_43277B:				; CODE XREF: sub_4326CB+A7j
		mov	eax, 0

locret_432780:				; CODE XREF: sub_4326CB+AEj
		leave
		retn
sub_4326CB	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_4327A7
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_4327CA
; ---------------------------------------------------------------------------

loc_4327A7:				; CODE XREF: .text:0043278Fj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_4327CA:				; CODE XREF: .text:004327A5j
		mov	eax, [ebp+0Ch]
		mov	edx, eax
		sar	edx, 1Fh
		mov	dword ptr [esp+10h], 0
		mov	ecx, [ebp+10h]
		mov	[esp+0Ch], ecx
		mov	[esp+4], eax
		mov	[esp+8], edx
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_430835
		mov	[ebp-0Ch], eax
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_432816
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_432829
; ---------------------------------------------------------------------------

loc_432816:				; CODE XREF: .text:004327FEj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_432829:				; CODE XREF: .text:00432814j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+0Ch]
		mov	[ebp-20h], eax
		mov	eax, [ebp+10h]
		mov	[ebp-1Ch], eax
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_43285F
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_432882
; ---------------------------------------------------------------------------

loc_43285F:				; CODE XREF: .text:00432847j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_432882:				; CODE XREF: .text:0043285Dj
		mov	dword ptr [esp+10h], 0
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp-20h]
		mov	edx, [ebp-1Ch]
		mov	[esp+4], eax
		mov	[esp+8], edx
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_430835
		mov	[ebp-0Ch], eax
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_4328CC
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_4328DF
; ---------------------------------------------------------------------------

loc_4328CC:				; CODE XREF: .text:004328B4j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_4328DF:				; CODE XREF: .text:004328CAj
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_432909
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_43292C
; ---------------------------------------------------------------------------

loc_432909:				; CODE XREF: .text:004328F1j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_43292C:				; CODE XREF: .text:00432907j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_431440
		mov	[ebp-0Ch], eax
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_432959
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_43296C
; ---------------------------------------------------------------------------

loc_432959:				; CODE XREF: .text:00432941j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_43296C:				; CODE XREF: .text:00432957j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0FFFFFFFFh
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_4329A4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_4329C7
; ---------------------------------------------------------------------------

loc_4329A4:				; CODE XREF: .text:0043298Cj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_4329C7:				; CODE XREF: .text:004329A2j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_431440
		mov	[ebp-10h], eax
		mov	[ebp-0Ch], edx
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_4329F7
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_432A0A
; ---------------------------------------------------------------------------

loc_4329F7:				; CODE XREF: .text:004329DFj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_432A0A:				; CODE XREF: .text:004329F5j
		mov	eax, [ebp-10h]
		mov	edx, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_432A37
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_432A5A
; ---------------------------------------------------------------------------

loc_432A37:				; CODE XREF: .text:00432A1Fj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_432A5A:				; CODE XREF: .text:00432A35j
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_430835
		mov	dword ptr [esp+8], 0FFFFFFFFh
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_431273
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_432ABF
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short locret_432AD2
; ---------------------------------------------------------------------------

loc_432ABF:				; CODE XREF: .text:00432AA7j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

locret_432AD2:				; CODE XREF: .text:00432ABDj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_432AD4	proc near		; CODE XREF: .text:00432BF3p
					; .text:0043318Ap ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_D]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], 1
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_430642
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_432B14
		mov	eax, [ebp+var_14]
		test	eax, eax
		jz	short loc_432B14
		movzx	eax, [ebp+var_D]
		movzx	eax, al
		jmp	short locret_432B19
; ---------------------------------------------------------------------------

loc_432B14:				; CODE XREF: sub_432AD4+2Ej
					; sub_432AD4+35j
		mov	eax, 0FFFFFFFFh

locret_432B19:				; CODE XREF: sub_432AD4+3Ej
		leave
		retn
sub_432AD4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_432B1B	proc near		; CODE XREF: .text:00432CCFp
					; sub_434241+ECp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_D], al
		lea	eax, [ebp+var_D]
		mov	[esp+28h+var_1C], 0
		mov	[esp+28h+var_20], 1
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_430C23
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_432B57
		mov	eax, [ebp+arg_0]
		jmp	short locret_432B5C
; ---------------------------------------------------------------------------

loc_432B57:				; CODE XREF: sub_432B1B+35j
		mov	eax, 0FFFFFFFFh

locret_432B5C:				; CODE XREF: sub_432B1B+3Aj
		leave
		retn
sub_432B1B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_432B83
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_432BA6
; ---------------------------------------------------------------------------

loc_432B83:				; CODE XREF: .text:00432B6Bj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_432BA6:				; CODE XREF: .text:00432B81j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_432BED
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_432BED
		mov	eax, [ebp+8]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_432BED
		mov	eax, [ebp+8]
		mov	ecx, [eax]
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+0Ch], ecx
		jmp	short loc_432BF8
; ---------------------------------------------------------------------------

loc_432BED:				; CODE XREF: .text:00432BB2j
					; .text:00432BC2j ...
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_432AD4

loc_432BF8:				; CODE XREF: .text:00432BEBj
		mov	[ebp-0Ch], eax
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_432C1A
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_432C2D
; ---------------------------------------------------------------------------

loc_432C1A:				; CODE XREF: .text:00432C02j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_432C2D:				; CODE XREF: .text:00432C18j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_432C57
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_432C7A
; ---------------------------------------------------------------------------

loc_432C57:				; CODE XREF: .text:00432C3Fj
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_432C7A:				; CODE XREF: .text:00432C55j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_432CC2
		mov	eax, [ebp+0Ch]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_432CC2
		cmp	dword ptr [ebp+8], 0Ah
		jz	short loc_432CC2
		mov	eax, [ebp+0Ch]
		mov	ecx, [eax]
		mov	eax, [ebp+0Ch]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		mov	ecx, [ebp+8]
		mov	[eax], cl
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+0Ch]
		mov	[edx+0Ch], ecx
		jmp	short loc_432CD4
; ---------------------------------------------------------------------------

loc_432CC2:				; CODE XREF: .text:00432C86j
					; .text:00432C96j ...
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_432B1B

loc_432CD4:				; CODE XREF: .text:00432CC0j
		mov	[ebp-0Ch], eax
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_432CF6
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_432D09
; ---------------------------------------------------------------------------

loc_432CF6:				; CODE XREF: .text:00432CDEj
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_432D09:				; CODE XREF: .text:00432CF4j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-9], al
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_432D39
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_432D5C
; ---------------------------------------------------------------------------

loc_432D39:				; CODE XREF: .text:00432D21j
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_432D5C:				; CODE XREF: .text:00432D37j
		lea	eax, [ebp-9]
		lea	edx, [ebp-10h]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_4307A6
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_432D9C
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_432DAF
; ---------------------------------------------------------------------------

loc_432D9C:				; CODE XREF: .text:00432D84j
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_432DAF:				; CODE XREF: .text:00432D9Aj
		mov	eax, [ebp-10h]
		test	eax, eax
		jz	short loc_432DBB
		mov	eax, [ebp+8]
		jmp	short locret_432DC0
; ---------------------------------------------------------------------------

loc_432DBB:				; CODE XREF: .text:00432DB4j
		mov	eax, 0FFFFFFFFh

locret_432DC0:				; CODE XREF: .text:00432DB9j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_432DC2	proc near		; CODE XREF: sub_430E4D+2CFp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jz	loc_432E6B
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_432DF1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_42EC4C
		jmp	short loc_432E14
; ---------------------------------------------------------------------------

loc_432DF1:				; CODE XREF: sub_432DC2+17j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire

loc_432E14:				; CODE XREF: sub_432DC2+2Dj
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_430642
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_432E56
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_42EC51
		jmp	short loc_432E72
; ---------------------------------------------------------------------------

loc_432E56:				; CODE XREF: sub_432DC2+7Cj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release
		jmp	short loc_432E72
; ---------------------------------------------------------------------------

loc_432E6B:				; CODE XREF: sub_432DC2+Aj
		mov	[ebp+var_C], 0

loc_432E72:				; CODE XREF: sub_432DC2+92j
					; sub_432DC2+A7j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_432DC2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_432E77	proc near		; CODE XREF: sub_430E4D+194p
					; sub_430E4D+1E0p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jz	loc_432F20
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_432EA6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_42EC4C
		jmp	short loc_432EC9
; ---------------------------------------------------------------------------

loc_432EA6:				; CODE XREF: sub_432E77+17j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], eax
		call	pth_mutex_acquire

loc_432EC9:				; CODE XREF: sub_432E77+2Dj
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_430C23
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_432F0B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_42EC51
		jmp	short loc_432F27
; ---------------------------------------------------------------------------

loc_432F0B:				; CODE XREF: sub_432E77+7Cj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_28], eax
		call	pth_mutex_release
		jmp	short loc_432F27
; ---------------------------------------------------------------------------

loc_432F20:				; CODE XREF: sub_432E77+Aj
		mov	[ebp+var_C], 0

loc_432F27:				; CODE XREF: sub_432E77+92j
					; sub_432E77+A7j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_432E77	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		test	eax, eax
		jz	loc_432FE9
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_432F60
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_432F83
; ---------------------------------------------------------------------------

loc_432F60:				; CODE XREF: .text:00432F48j
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_432F83:				; CODE XREF: .text:00432F5Ej
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		lea	edx, [ebp-10h]
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_430642
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_432FC6
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_432FD9
; ---------------------------------------------------------------------------

loc_432FC6:				; CODE XREF: .text:00432FAEj
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_432FD9:				; CODE XREF: .text:00432FC4j
		mov	eax, [ebp-10h]
		mov	edx, 0
		div	dword ptr [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	short loc_432FF0
; ---------------------------------------------------------------------------

loc_432FE9:				; CODE XREF: .text:00432F3Bj
		mov	dword ptr [ebp-0Ch], 0

loc_432FF0:				; CODE XREF: .text:00432FE7j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		test	eax, eax
		jz	loc_4330B2
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_433029
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_43304C
; ---------------------------------------------------------------------------

loc_433029:				; CODE XREF: .text:00433011j
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_43304C:				; CODE XREF: .text:00433027j
		mov	eax, [ebp+0Ch]
		imul	eax, [ebp+10h]
		lea	edx, [ebp-10h]
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_430C23
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_43308F
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_4330A2
; ---------------------------------------------------------------------------

loc_43308F:				; CODE XREF: .text:00433077j
		mov	eax, [ebp+14h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_4330A2:				; CODE XREF: .text:0043308Dj
		mov	eax, [ebp-10h]
		mov	edx, 0
		div	dword ptr [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	short loc_4330B9
; ---------------------------------------------------------------------------

loc_4330B2:				; CODE XREF: .text:00433004j
		mov	dword ptr [ebp-0Ch], 0

loc_4330B9:				; CODE XREF: .text:004330B0j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_4330DA
		mov	eax, 0
		jmp	locret_433208
; ---------------------------------------------------------------------------

loc_4330DA:				; CODE XREF: .text:004330CEj
		mov	dword ptr [ebp-10h], 0FFFFFFFFh
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_433100
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_433137
; ---------------------------------------------------------------------------

loc_433100:				; CODE XREF: .text:004330E8j
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire
		jmp	short loc_433137
; ---------------------------------------------------------------------------

loc_433125:				; CODE XREF: .text:0043319Cj
		mov	eax, [ebp-10h]
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp+0Ch], 1

loc_433137:				; CODE XREF: .text:004330FEj
					; .text:00433123j
		cmp	dword ptr [ebp+0Ch], 1
		jle	short loc_43319E
		mov	eax, [ebp+10h]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_433184
		mov	eax, [ebp+10h]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+10h]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_433184
		mov	eax, [ebp+10h]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_433184
		mov	eax, [ebp+10h]
		mov	ecx, [eax]
		mov	eax, [ebp+10h]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+10h]
		mov	[edx+0Ch], ecx
		jmp	short loc_43318F
; ---------------------------------------------------------------------------

loc_433184:				; CODE XREF: .text:00433149j
					; .text:00433159j ...
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_432AD4

loc_43318F:				; CODE XREF: .text:00433182j
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jz	short loc_43319E
		cmp	dword ptr [ebp-10h], 0Ah
		jnz	short loc_433125

loc_43319E:				; CODE XREF: .text:0043313Bj
					; .text:00433196j
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_4331BD
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_4331D0
; ---------------------------------------------------------------------------

loc_4331BD:				; CODE XREF: .text:004331A5j
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_4331D0:				; CODE XREF: .text:004331BBj
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_4331E5
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_4331E5
		mov	eax, 0
		jmp	short locret_433208
; ---------------------------------------------------------------------------

loc_4331E5:				; CODE XREF: .text:004331D4j
					; .text:004331DCj
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jz	short loc_4331FF
		cmp	dword ptr [ebp+0Ch], 1
		jle	short loc_4331FF
		mov	eax, [ebp-10h]
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1

loc_4331FF:				; CODE XREF: .text:004331E9j
					; .text:004331EFj
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+8]

locret_433208:				; CODE XREF: .text:004330D5j
					; .text:004331E3j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp-0Ch], eax
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_430C23
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_433264
		mov	eax, 0FFFFFFFFh
		jmp	short loc_433269
; ---------------------------------------------------------------------------

loc_433264:				; CODE XREF: .text:0043325Bj
		mov	eax, 0

loc_433269:				; CODE XREF: .text:00433262j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43326F	proc near		; CODE XREF: .text:00434958p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_4332B7
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+38h+var_38], eax
		call	sub_42EC4C
		jmp	short loc_4332DA
; ---------------------------------------------------------------------------

loc_4332B7:				; CODE XREF: sub_43326F+30j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax
		call	pth_mutex_acquire

loc_4332DA:				; CODE XREF: sub_43326F+46j
		mov	[esp+38h+var_2C], 0
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	sub_430C23
		mov	[ebp+var_10], eax
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_43331D
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+38h+var_38], eax
		call	sub_42EC51
		jmp	short loc_433330
; ---------------------------------------------------------------------------

loc_43331D:				; CODE XREF: sub_43326F+96j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+38h+var_38], eax
		call	pth_mutex_release

loc_433330:				; CODE XREF: sub_43326F+ACj
		cmp	[ebp+var_10], 0
		jz	short loc_43333D
		mov	eax, 0FFFFFFFFh
		jmp	short loc_433342
; ---------------------------------------------------------------------------

loc_43333D:				; CODE XREF: sub_43326F+C5j
		mov	eax, 0

loc_433342:				; CODE XREF: sub_43326F+CCj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_43326F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-18h], 0
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_43337B
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_43339E
; ---------------------------------------------------------------------------

loc_43337B:				; CODE XREF: .text:00433363j
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_43339E:				; CODE XREF: .text:00433379j
		lea	eax, [ebp-14h]
		lea	edx, [ebp-18h]
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_430E4D
		mov	[ebp-0Ch], eax
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_4333E1
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_4333F4
; ---------------------------------------------------------------------------

loc_4333E1:				; CODE XREF: .text:004333C9j
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_4333F4:				; CODE XREF: .text:004333DFj
		cmp	dword ptr [ebp-0Ch], 0
		jnz	loc_4334B0
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		test	eax, eax
		jz	loc_43349C
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	edx, [ebp-18h]
		add	edx, 1
		cmp	eax, edx
		jnb	short loc_433455
		mov	eax, [ebp-18h]
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_42EC78
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_433443
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jmp	short loc_433455
; ---------------------------------------------------------------------------

loc_433443:				; CODE XREF: .text:00433438j
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, [ebp-10h]
		jz	short loc_433455
		mov	edx, [ebp-10h]
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_433455:				; CODE XREF: .text:00433418j
					; .text:00433441j ...
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_43348F
		mov	eax, [ebp-18h]
		lea	ecx, [eax+1]
		mov	eax, [ebp-14h]
		mov	edx, eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp+0Ch]
		mov	edx, [eax]
		mov	eax, [ebp-18h]
		cmp	edx, eax
		jz	short loc_43348F
		mov	edx, [ebp-18h]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx

loc_43348F:				; CODE XREF: .text:00433459j
					; .text:00433485j
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_42ECA5
		jmp	short loc_4334B1
; ---------------------------------------------------------------------------

loc_43349C:				; CODE XREF: .text:00433405j
		mov	eax, [ebp-14h]
		mov	edx, eax
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	edx, [ebp-18h]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx
		jmp	short loc_4334B1
; ---------------------------------------------------------------------------

loc_4334B0:				; CODE XREF: .text:004333F8j
		nop

loc_4334B1:				; CODE XREF: .text:0043349Aj
					; .text:004334AEj
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4334BC
		mov	eax, [ebp-18h]
		jmp	short locret_4334BF
; ---------------------------------------------------------------------------

loc_4334BC:				; CODE XREF: .text:004334B5j
		mov	eax, [ebp-0Ch]

locret_4334BF:				; CODE XREF: .text:004334BAj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		mov	[ebp-14h], eax
		mov	dword ptr [ebp-18h], 0
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_4334EB
		mov	eax, [ebp+14h]
		mov	eax, [eax]
		jmp	short loc_4334F0
; ---------------------------------------------------------------------------

loc_4334EB:				; CODE XREF: .text:004334E2j
		mov	eax, 0

loc_4334F0:				; CODE XREF: .text:004334E9j
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_433546
		mov	dword ptr [ebp-14h], 100h
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_42EC5B
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp-10h]
		mov	[eax], edx
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_43353E
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 0
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_433534
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0

loc_433534:				; CODE XREF: .text:00433529j
		mov	eax, 0FFFFFFFFh
		jmp	locret_4337E7
; ---------------------------------------------------------------------------

loc_43353E:				; CODE XREF: .text:0043351Aj
		mov	eax, [ebp+10h]
		mov	edx, [ebp-14h]
		mov	[eax], edx

loc_433546:				; CODE XREF: .text:004334F7j
		cmp	dword ptr [ebp-14h], 3
		ja	short loc_433563
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_4337E7
; ---------------------------------------------------------------------------

loc_433563:				; CODE XREF: .text:0043354Aj
		sub	dword ptr [ebp-14h], 3
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_433586
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_4335A9
; ---------------------------------------------------------------------------

loc_433586:				; CODE XREF: .text:0043356Ej
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_4335A9:				; CODE XREF: .text:00433584j
		mov	eax, [ebp-10h]
		mov	[ebp-1Ch], eax
		jmp	loc_433747
; ---------------------------------------------------------------------------

loc_4335B4:				; CODE XREF: .text:004337A0j
		mov	eax, [ebp-18h]
		cmp	eax, [ebp-14h]
		jnz	loc_43372F
		cmp	dword ptr [ebp-20h], 0
		jz	loc_43365D
		mov	eax, [ebp-14h]
		cmp	eax, [ebp-20h]
		jbe	loc_43365D

loc_4335D6:				; CODE XREF: .text:00433635j
		cmp	dword ptr [ebp-0Ch], 0Ah
		jz	short loc_433637
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_433623
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_433623
		mov	eax, [ebp+8]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_433623
		mov	eax, [ebp+8]
		mov	ecx, [eax]
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+0Ch], ecx
		jmp	short loc_43362E
; ---------------------------------------------------------------------------

loc_433623:				; CODE XREF: .text:004335E8j
					; .text:004335F8j ...
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_432AD4

loc_43362E:				; CODE XREF: .text:00433621j
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_4335D6

loc_433637:				; CODE XREF: .text:004335DAj
		mov	eax, [ebp-1Ch]
		mov	byte ptr [eax],	0Ah
		add	dword ptr [ebp-1Ch], 1
		add	dword ptr [ebp-18h], 1
		cmp	dword ptr [ebp+14h], 0
		jz	loc_4337A8
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0
		jmp	loc_4337A8
; ---------------------------------------------------------------------------

loc_43365D:				; CODE XREF: .text:004335C4j
					; .text:004335D0j
		add	dword ptr [ebp-14h], 3
		cmp	dword ptr [ebp-14h], 3FFh
		ja	short loc_433671
		mov	eax, 100h
		jmp	short loc_433676
; ---------------------------------------------------------------------------

loc_433671:				; CODE XREF: .text:00433668j
		mov	eax, 400h

loc_433676:				; CODE XREF: .text:0043366Fj
		add	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42EC78
		mov	edx, [ebp+0Ch]
		mov	[edx], eax
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_433710
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp-24h], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_42ECA5
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 0
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_4336C8
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0

loc_4336C8:				; CODE XREF: .text:004336BDj
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_4336E7
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_4336FA
; ---------------------------------------------------------------------------

loc_4336E7:				; CODE XREF: .text:004336CFj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_4336FA:				; CODE XREF: .text:004336E5j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp-24h]
		mov	[eax], edx
		mov	eax, 0FFFFFFFFh
		jmp	locret_4337E7
; ---------------------------------------------------------------------------

loc_433710:				; CODE XREF: .text:00433697j
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp+10h]
		mov	edx, [ebp-14h]
		mov	[eax], edx
		sub	dword ptr [ebp-14h], 3
		mov	eax, [ebp-18h]
		mov	edx, [ebp-10h]
		add	eax, edx
		mov	[ebp-1Ch], eax

loc_43372F:				; CODE XREF: .text:004335BAj
		mov	eax, [ebp-0Ch]
		mov	edx, eax
		mov	eax, [ebp-1Ch]
		mov	[eax], dl
		add	dword ptr [ebp-1Ch], 1
		add	dword ptr [ebp-18h], 1
		cmp	dword ptr [ebp-0Ch], 0Ah
		jz	short loc_4337AB

loc_433747:				; CODE XREF: .text:004335AFj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_43378E
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_43378E
		mov	eax, [ebp+8]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_43378E
		mov	eax, [ebp+8]
		mov	ecx, [eax]
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+0Ch], ecx
		jmp	short loc_433799
; ---------------------------------------------------------------------------

loc_43378E:				; CODE XREF: .text:00433753j
					; .text:00433763j ...
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_432AD4

loc_433799:				; CODE XREF: .text:0043378Cj
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	loc_4335B4
		jmp	short loc_4337AC
; ---------------------------------------------------------------------------

loc_4337A8:				; CODE XREF: .text:00433649j
					; .text:00433658j
		nop
		jmp	short loc_4337AC
; ---------------------------------------------------------------------------

loc_4337AB:				; CODE XREF: .text:00433745j
		nop

loc_4337AC:				; CODE XREF: .text:004337A6j
					; .text:004337A9j
		mov	eax, [ebp-1Ch]
		mov	byte ptr [eax],	0
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_4337D1
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_4337E4
; ---------------------------------------------------------------------------

loc_4337D1:				; CODE XREF: .text:004337B9j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_4337E4:				; CODE XREF: .text:004337CFj
		mov	eax, [ebp-18h]

locret_4337E7:				; CODE XREF: .text:00433539j
					; .text:0043355Ej ...
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_42ECA5
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_43121E
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_433842
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_433865
; ---------------------------------------------------------------------------

loc_433842:				; CODE XREF: .text:0043382Aj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_433865:				; CODE XREF: .text:00433840j
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_43121E
		mov	[ebp-0Ch], eax
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_4338A0
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_4338B3
; ---------------------------------------------------------------------------

loc_4338A0:				; CODE XREF: .text:00433888j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_4338B3:				; CODE XREF: .text:0043389Ej
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4338B8	proc near		; CODE XREF: sub_434241+34Bp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_43121E
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4338B8	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+10h]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_433914
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_433937
; ---------------------------------------------------------------------------

loc_433914:				; CODE XREF: .text:004338FCj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_433937:				; CODE XREF: .text:00433912j
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_43121E
		mov	[ebp-0Ch], eax
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_433972
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_433985
; ---------------------------------------------------------------------------

loc_433972:				; CODE XREF: .text:0043395Aj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_433985:				; CODE XREF: .text:00433970j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_429D5F
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jns	short loc_4339C1
		mov	eax, 0
		jmp	short locret_4339C4
; ---------------------------------------------------------------------------

loc_4339C1:				; CODE XREF: .text:004339B8j
		mov	eax, [ebp-14h]

locret_4339C4:				; CODE XREF: .text:004339BFj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_429D5F
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jns	short loc_4339F5
		mov	eax, 0
		jmp	short locret_4339F8
; ---------------------------------------------------------------------------

loc_4339F5:				; CODE XREF: .text:004339ECj
		mov	eax, [ebp-10h]

locret_4339F8:				; CODE XREF: .text:004339F3j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4339FA	proc near		; CODE XREF: .text:00433C50p

nBufferLength	= dword	ptr -178h
lpBuffer	= dword	ptr -174h
dwShareMode	= dword	ptr -170h
lpSecurityAttributes= dword ptr	-16Ch
dwCreationDisposition= dword ptr -168h
dwFlagsAndAttributes= dword ptr	-164h
hTemplateFile	= dword	ptr -160h
var_14C		= dword	ptr -14Ch
Buffer		= byte ptr -146h
var_2C		= dword	ptr -2Ch
hObject		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 174h
		mov	eax, ds:GetCurrentProcessId
		call	eax ; GetCurrentProcessId
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+Buffer]
		mov	[esp+178h+lpBuffer], eax ; lpBuffer
		mov	[esp+178h+nBufferLength], 105h ; nBufferLength
		mov	eax, ds:GetTempPathA
		call	eax ; GetTempPathA
		sub	esp, 8
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_433A6A
		cmp	[ebp+var_20], 104h
		jg	short loc_433A6A
		lea	eax, [ebp+Buffer]
		mov	[ebp+var_14C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 104h
		jbe	short loc_433A81

loc_433A6A:				; CODE XREF: sub_4339FA+36j
					; sub_4339FA+3Fj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 2
		mov	eax, 0FFFFFFFFh
		jmp	loc_433C29
; ---------------------------------------------------------------------------

loc_433A81:				; CODE XREF: sub_4339FA+6Ej
		lea	eax, [ebp+Buffer]
		mov	[ebp+var_14C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp+Buffer]
		add	eax, edx
		mov	[ebp+var_10], eax
		mov	edx, offset a_estream ;	"_estream"
		mov	eax, [ebp+var_10]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	edx, byte ptr [edx+8]
		mov	[eax+8], dl
		add	[ebp+var_10], 8
		mov	[esp+178h+lpBuffer], 0 ; lpSecurityAttributes
		lea	eax, [ebp+Buffer]
		mov	[esp+178h+nBufferLength], eax ;	lpPathName
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[ebp+var_24], eax
		mov	[ebp+var_C], 0
		jmp	loc_433C0D
; ---------------------------------------------------------------------------

loc_433B08:				; CODE XREF: sub_4339FA+217j
		mov	eax, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	eax, ds:GetTickCount
		call	eax ; GetTickCount
		mov	edx, [ebp+var_1C]
		shl	edx, 10h
		xor	eax, edx
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		jmp	short loc_433B59
; ---------------------------------------------------------------------------

loc_433B29:				; CODE XREF: sub_4339FA+163j
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		cmp	eax, 9
		ja	short loc_433B3F
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		add	eax, 30h
		jmp	short loc_433B48
; ---------------------------------------------------------------------------

loc_433B3F:				; CODE XREF: sub_4339FA+138j
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		add	eax, 37h

loc_433B48:				; CODE XREF: sub_4339FA+143j
		mov	edx, [ebp+var_10]
		mov	[edx], al
		add	[ebp+var_10], 1
		shl	[ebp+var_14], 4
		add	[ebp+var_18], 1

loc_433B59:				; CODE XREF: sub_4339FA+12Dj
		cmp	[ebp+var_18], 7
		jle	short loc_433B29
		mov	edx, offset a_tmp_0 ; ".tmp"
		mov	eax, [ebp+var_10]
		mov	ecx, [edx]
		mov	[eax], ecx
		movzx	edx, byte ptr [edx+4]
		mov	[eax+4], dl
		mov	[esp+178h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+178h+dwFlagsAndAttributes], 4000100h ; dwFlagsAndAttributes
		mov	[esp+178h+dwCreationDisposition], 1 ; dwCreationDisposition
		mov	[esp+178h+lpSecurityAttributes], 0 ; lpSecurityAttributes
		mov	[esp+178h+dwShareMode],	0 ; dwShareMode
		mov	[esp+178h+lpBuffer], 0C0000000h	; dwDesiredAccess
		lea	eax, [ebp+Buffer]
		mov	[esp+178h+nBufferLength], eax ;	lpFileName
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0FFFFFFFFh
		jz	short loc_433BF8
		mov	eax, [ebp+hObject]
		mov	[esp+178h+lpBuffer], 0
		mov	[esp+178h+nBufferLength], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0FFFFFFFFh
		jnz	short loc_433BF3
		mov	eax, [ebp+hObject]
		mov	[esp+178h+nBufferLength], eax ;	hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0FFFFFFFFh
		jmp	short loc_433C29
; ---------------------------------------------------------------------------

loc_433BF3:				; CODE XREF: sub_4339FA+1E0j
		mov	eax, [ebp+var_2C]
		jmp	short loc_433C29
; ---------------------------------------------------------------------------

loc_433BF8:				; CODE XREF: sub_4339FA+1C2j
		mov	[esp+178h+nBufferLength], 1 ; dwMilliseconds
		mov	eax, ds:Sleep
		call	eax ; Sleep
		sub	esp, 4
		add	[ebp+var_C], 1

loc_433C0D:				; CODE XREF: sub_4339FA+109j
		cmp	[ebp+var_C], 9
		jle	loc_433B08
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 2
		mov	eax, 0FFFFFFFFh

loc_433C29:				; CODE XREF: sub_4339FA+82j
					; sub_4339FA+1F7j ...
		mov	edi, [ebp+var_4]
		leave
		retn
sub_4339FA	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-14h], 302h
		mov	dword ptr [ebp-20h], 0
		call	sub_4339FA
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jnz	short loc_433C6A
		mov	dword ptr [ebp-10h], 0FFFFFFFFh
		jmp	loc_433CF1
; ---------------------------------------------------------------------------

loc_433C6A:				; CODE XREF: .text:00433C5Cj
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp-14h]
		mov	[esp+8], eax
		mov	eax, [ebp-18h]
		mov	[esp+4], eax
		lea	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_42F72C
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_433CF0
		mov	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-20h]
		mov	dword ptr [esp+20h], 0
		mov	edx, [ebp-14h]
		mov	[esp+1Ch], edx
		mov	edx, off_444C1C
		mov	[esp+0Ch], edx
		mov	edx, off_444C20
		mov	[esp+10h], edx
		mov	edx, off_444C24
		mov	[esp+14h], edx
		mov	edx, off_444C28
		mov	[esp+18h], edx
		mov	edx, [ebp-18h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		lea	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_4302D5
		mov	[ebp-10h], eax
		jmp	short loc_433CF1
; ---------------------------------------------------------------------------

loc_433CF0:				; CODE XREF: .text:00433C92j
		nop

loc_433CF1:				; CODE XREF: .text:00433C65j
					; .text:00433CEEj
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_433D22
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_433D0A
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_42F8FB
		jmp	short loc_433D1B
; ---------------------------------------------------------------------------

loc_433D0A:				; CODE XREF: .text:00433CFBj
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jz	short loc_433D1B
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	_close

loc_433D1B:				; CODE XREF: .text:00433D08j
					; .text:00433D0Ej
		mov	dword ptr [ebp-1Ch], 0

loc_433D22:				; CODE XREF: .text:00433CF5j
		mov	eax, [ebp-1Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_433D43
		cmp	dword ptr [ebp+10h], 40h
		jz	short loc_433D43
		cmp	dword ptr [ebp+10h], 4
		jnz	loc_433DF2

loc_433D43:				; CODE XREF: .text:00433D31j
					; .text:00433D37j
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_433D59
		cmp	dword ptr [ebp+14h], 0
		jnz	short loc_433D59
		cmp	dword ptr [ebp+10h], 4
		jnz	loc_433DF2

loc_433D59:				; CODE XREF: .text:00433D47j
					; .text:00433D4Dj
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_433D78
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_433D9B
; ---------------------------------------------------------------------------

loc_433D78:				; CODE XREF: .text:00433D60j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_433D9B:				; CODE XREF: .text:00433D76j
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_43131B
		mov	[ebp-0Ch], eax
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_433DDD
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_433E06
; ---------------------------------------------------------------------------

loc_433DDD:				; CODE XREF: .text:00433DC5j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release
		jmp	short loc_433E06
; ---------------------------------------------------------------------------

loc_433DF2:				; CODE XREF: .text:00433D3Dj
					; .text:00433D53j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh

loc_433E06:				; CODE XREF: .text:00433DDBj
					; .text:00433DF0j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_433E30
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_433E53
; ---------------------------------------------------------------------------

loc_433E30:				; CODE XREF: .text:00433E18j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_433E53:				; CODE XREF: .text:00433E2Ej
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_433E60
		mov	eax, 0
		jmp	short loc_433E65
; ---------------------------------------------------------------------------

loc_433E60:				; CODE XREF: .text:00433E57j
		mov	eax, 4

loc_433E65:				; CODE XREF: .text:00433E5Ej
		mov	dword ptr [esp+0Ch], 200h
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_43131B
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_433EA2
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short locret_433EB5
; ---------------------------------------------------------------------------

loc_433EA2:				; CODE XREF: .text:00433E8Aj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

locret_433EB5:				; CODE XREF: .text:00433EA0j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_433EDC
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_433EFF
; ---------------------------------------------------------------------------

loc_433EDC:				; CODE XREF: .text:00433EC4j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_433EFF:				; CODE XREF: .text:00433EDAj
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4314B5
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_433F38
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short locret_433F4B
; ---------------------------------------------------------------------------

loc_433F38:				; CODE XREF: .text:00433F20j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

locret_433F4B:				; CODE XREF: .text:00433F36j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_433F72
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_433F95
; ---------------------------------------------------------------------------

loc_433F72:				; CODE XREF: .text:00433F5Aj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_433F95:				; CODE XREF: .text:00433F70j
		lea	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4314B5
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_433FCE
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_433FE1
; ---------------------------------------------------------------------------

loc_433FCE:				; CODE XREF: .text:00433FB6j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_433FE1:				; CODE XREF: .text:00433FCCj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_433FE6(int, char *, int)
sub_433FE6	proc near		; CODE XREF: .text:004315F3p
					; .text:00431FF3p ...

Dest		= dword	ptr -28h
Source		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		test	eax, eax
		jz	short loc_434036
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		and	eax, 20h
		test	al, al
		jnz	short loc_434036
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	[esp+28h+Dest],	eax ; void *
		call	sub_42ECA5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+220h], 0

loc_434036:				; CODE XREF: sub_433FE6+16j
					; sub_433FE6+2Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		test	eax, eax
		jnz	loc_4340E2
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Bh
		jz	short loc_43405D
		mov	[ebp+arg_8], 0
		jmp	short loc_43406A
; ---------------------------------------------------------------------------

loc_43405D:				; CODE XREF: sub_433FE6+6Cj
		cmp	[ebp+arg_8], 0
		setnz	al
		movzx	eax, al
		mov	[ebp+arg_8], eax

loc_43406A:				; CODE XREF: sub_433FE6+75j
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+24h]
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_8]
		add	eax, edx
		add	eax, 1
		mov	[esp+28h+Dest],	eax ; size_t
		call	sub_42EC5B
		mov	[ebx+220h], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_4340E3
		cmp	[ebp+arg_8], 0
		jz	short loc_4340C0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	byte ptr [eax],	5Ch

loc_4340C0:				; CODE XREF: sub_433FE6+C9j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [eax+220h]
		mov	eax, [ebp+arg_8]
		add	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Source], eax ;	Source
		mov	[esp+28h+Dest],	edx ; Dest
		call	strcpy
		jmp	short loc_4340E3
; ---------------------------------------------------------------------------

loc_4340E2:				; CODE XREF: sub_433FE6+5Ej
		nop

loc_4340E3:				; CODE XREF: sub_433FE6+C3j
					; sub_433FE6+FAj
		add	esp, 20h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_433FE6	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+0Ch], 0
		jz	locret_434188
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_434119
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_43413C
; ---------------------------------------------------------------------------

loc_434119:				; CODE XREF: .text:00434101j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_43413C:				; CODE XREF: .text:00434117j
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_433FE6
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_434175
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short locret_434188
; ---------------------------------------------------------------------------

loc_434175:				; CODE XREF: .text:0043415Dj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

locret_434188:				; CODE XREF: .text:004340F4j
					; .text:00434173j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_4341AF
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_4341D2
; ---------------------------------------------------------------------------

loc_4341AF:				; CODE XREF: .text:00434197j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_4341D2:				; CODE XREF: .text:004341ADj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_4341FD
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		or	edx, 20h
		mov	[eax+250h], dl

loc_4341FD:				; CODE XREF: .text:004341E5j
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_43421C
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_43422F
; ---------------------------------------------------------------------------

loc_43421C:				; CODE XREF: .text:00434204j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_43422F:				; CODE XREF: .text:0043421Aj
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_43423C
		mov	dword ptr [ebp-0Ch], offset a?_0 ; "[?]"

loc_43423C:				; CODE XREF: .text:00434233j
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_434241(int, int, int,	char *,	int)
sub_434241	proc near		; CODE XREF: .text:0043499Dp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_434276
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+Str], eax
		call	sub_42EC4C
		jmp	loc_434608
; ---------------------------------------------------------------------------

loc_434276:				; CODE XREF: sub_434241+1Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+Val], 0
		mov	[esp+28h+Str], eax
		call	pth_mutex_acquire
		jmp	loc_434608
; ---------------------------------------------------------------------------

loc_43429E:				; CODE XREF: sub_434241+3CBj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_4342E6
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_4342E6
		cmp	[ebp+arg_C], 0
		jz	loc_434597
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jnz	short loc_4342E6
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_434597

loc_4342E6:				; CODE XREF: sub_434241+65j
					; sub_434241+6Fj ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_43431F
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_43431F
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	5Ch
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_434332
; ---------------------------------------------------------------------------

loc_43431F:				; CODE XREF: sub_434241+B1j
					; sub_434241+C1j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 5Ch
		call	sub_432B1B

loc_434332:				; CODE XREF: sub_434241+DCj
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_434395
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_434379
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_434379
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	6Eh
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_43438C
; ---------------------------------------------------------------------------

loc_434379:				; CODE XREF: sub_434241+10Bj
					; sub_434241+11Bj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 6Eh
		call	sub_432B1B

loc_43438C:				; CODE XREF: sub_434241+136j
		add	[ebp+var_10], 1
		jmp	loc_4345FC
; ---------------------------------------------------------------------------

loc_434395:				; CODE XREF: sub_434241+FDj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_4343F4
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4343D8
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_4343D8
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	72h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_4343EB
; ---------------------------------------------------------------------------

loc_4343D8:				; CODE XREF: sub_434241+16Aj
					; sub_434241+17Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 72h
		call	sub_432B1B

loc_4343EB:				; CODE XREF: sub_434241+195j
		add	[ebp+var_10], 1
		jmp	loc_4345FC
; ---------------------------------------------------------------------------

loc_4343F4:				; CODE XREF: sub_434241+15Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_434453
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_434437
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_434437
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	66h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_43444A
; ---------------------------------------------------------------------------

loc_434437:				; CODE XREF: sub_434241+1C9j
					; sub_434241+1D9j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 66h
		call	sub_432B1B

loc_43444A:				; CODE XREF: sub_434241+1F4j
		add	[ebp+var_10], 1
		jmp	loc_4345FC
; ---------------------------------------------------------------------------

loc_434453:				; CODE XREF: sub_434241+1BBj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_4344B2
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_434496
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_434496
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	76h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_4344A9
; ---------------------------------------------------------------------------

loc_434496:				; CODE XREF: sub_434241+228j
					; sub_434241+238j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 76h
		call	sub_432B1B

loc_4344A9:				; CODE XREF: sub_434241+253j
		add	[ebp+var_10], 1
		jmp	loc_4345FC
; ---------------------------------------------------------------------------

loc_4344B2:				; CODE XREF: sub_434241+21Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_434511
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4344F5
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_4344F5
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	62h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_434508
; ---------------------------------------------------------------------------

loc_4344F5:				; CODE XREF: sub_434241+287j
					; sub_434241+297j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 62h
		call	sub_432B1B

loc_434508:				; CODE XREF: sub_434241+2B2j
		add	[ebp+var_10], 1
		jmp	loc_4345FC
; ---------------------------------------------------------------------------

loc_434511:				; CODE XREF: sub_434241+279j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_434570
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_434554
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_434554
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	30h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_434567
; ---------------------------------------------------------------------------

loc_434554:				; CODE XREF: sub_434241+2E6j
					; sub_434241+2F6j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 30h
		call	sub_432B1B

loc_434567:				; CODE XREF: sub_434241+311j
		add	[ebp+var_10], 1
		jmp	loc_4345FC
; ---------------------------------------------------------------------------

loc_434570:				; CODE XREF: sub_434241+2D8j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x ; "x%02x"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_4338B8
		add	[ebp+var_10], 3
		jmp	short loc_4345FC
; ---------------------------------------------------------------------------

loc_434597:				; CODE XREF: sub_434241+75j
					; sub_434241+9Fj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4345E0
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_4345E0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_4345E0
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+var_C]
		movzx	edx, byte ptr [edx]
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_4345F8
; ---------------------------------------------------------------------------

loc_4345E0:				; CODE XREF: sub_434241+362j
					; sub_434241+372j ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Val], edx
		mov	[esp+28h+Str], eax
		call	sub_432B1B

loc_4345F8:				; CODE XREF: sub_434241+39Dj
		add	[ebp+var_10], 1

loc_4345FC:				; CODE XREF: sub_434241+14Fj
					; sub_434241+1AEj ...
		sub	[ebp+arg_8], 1
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_434608:				; CODE XREF: sub_434241+30j
					; sub_434241+58j
		cmp	[ebp+arg_8], 0
		jnz	loc_43429E
		cmp	[ebp+arg_10], 0
		jz	short loc_434620
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_434620:				; CODE XREF: sub_434241+3D5j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_432536
		test	eax, eax
		jz	short loc_434636
		mov	eax, 0FFFFFFFFh
		jmp	short loc_43463B
; ---------------------------------------------------------------------------

loc_434636:				; CODE XREF: sub_434241+3ECj
		mov	eax, 0

loc_43463B:				; CODE XREF: sub_434241+3F3j
		mov	[ebp+var_14], eax
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_43465D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+Str], eax
		call	sub_42EC51
		jmp	short loc_434670
; ---------------------------------------------------------------------------

loc_43465D:				; CODE XREF: sub_434241+404j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp+28h+Str], eax
		call	pth_mutex_release

loc_434670:				; CODE XREF: sub_434241+41Aj
		mov	eax, [ebp+var_14]
		leave
		retn
sub_434241	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_434692
		mov	eax, 0
		jmp	locret_4348AA
; ---------------------------------------------------------------------------

loc_434692:				; CODE XREF: .text:00434686j
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_4346B1
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC4C
		jmp	short loc_4346D4
; ---------------------------------------------------------------------------

loc_4346B1:				; CODE XREF: .text:00434699j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		call	pth_mutex_acquire

loc_4346D4:				; CODE XREF: .text:004346AFj
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	loc_43483F
; ---------------------------------------------------------------------------

loc_4346DF:				; CODE XREF: .text:00434843j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_434746
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_434746
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		shr	dl, 4
		movzx	edx, dl
		and	edx, 0Fh
		cmp	edx, 9
		jg	short loc_43472D
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		shr	dl, 4
		add	edx, 30h
		jmp	short loc_434739
; ---------------------------------------------------------------------------

loc_43472D:				; CODE XREF: .text:0043471Dj
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		shr	dl, 4
		add	edx, 37h

loc_434739:				; CODE XREF: .text:0043472Bj
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx
		jmp	short loc_43478F
; ---------------------------------------------------------------------------

loc_434746:				; CODE XREF: .text:004346EBj
					; .text:004346FBj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_43476E
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_434780
; ---------------------------------------------------------------------------

loc_43476E:				; CODE XREF: .text:00434758j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 37h

loc_434780:				; CODE XREF: .text:0043476Cj
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_432B1B

loc_43478F:				; CODE XREF: .text:00434744j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4347F3
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_4347F3
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		and	edx, 0Fh
		cmp	edx, 9
		jg	short loc_4347DA
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		and	edx, 0Fh
		add	edx, 30h
		jmp	short loc_4347E6
; ---------------------------------------------------------------------------

loc_4347DA:				; CODE XREF: .text:004347CAj
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		and	edx, 0Fh
		add	edx, 37h

loc_4347E6:				; CODE XREF: .text:004347D8j
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx
		jmp	short loc_434833
; ---------------------------------------------------------------------------

loc_4347F3:				; CODE XREF: .text:0043479Bj
					; .text:004347ABj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_434815
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_434824
; ---------------------------------------------------------------------------

loc_434815:				; CODE XREF: .text:00434802j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 37h

loc_434824:				; CODE XREF: .text:00434813j
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_432B1B

loc_434833:				; CODE XREF: .text:004347F1j
		add	dword ptr [ebp-10h], 2
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp+10h], 1

loc_43483F:				; CODE XREF: .text:004346DAj
		cmp	dword ptr [ebp+10h], 0
		jnz	loc_4346DF
		cmp	dword ptr [ebp+18h], 0
		jz	short loc_434857
		mov	eax, [ebp+18h]
		mov	edx, [ebp-10h]
		mov	[eax], edx

loc_434857:				; CODE XREF: .text:0043484Dj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_432536
		test	eax, eax
		jz	short loc_43486D
		mov	eax, 0FFFFFFFFh
		jmp	short loc_434872
; ---------------------------------------------------------------------------

loc_43486D:				; CODE XREF: .text:00434864j
		mov	eax, 0

loc_434872:				; CODE XREF: .text:0043486Bj
		mov	[ebp-14h], eax
		mov	eax, ds:dword_451700
		test	eax, eax
		jz	short loc_434894
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_42EC51
		jmp	short loc_4348A7
; ---------------------------------------------------------------------------

loc_434894:				; CODE XREF: .text:0043487Cj
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		add	eax, 210h
		mov	[esp], eax
		call	pth_mutex_release

loc_4348A7:				; CODE XREF: .text:00434892j
		mov	eax, [ebp-14h]

locret_4348AA:				; CODE XREF: .text:0043468Dj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_4348D5
; ---------------------------------------------------------------------------

loc_4348C2:				; CODE XREF: .text:004348DBj
		mov	eax, [ebp-0Ch]
		mov	edx, [ebp-10h]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_4348DF
		add	dword ptr [ebp-0Ch], 1

loc_4348D5:				; CODE XREF: .text:004348C0j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jb	short loc_4348C2
		jmp	short loc_4348E0
; ---------------------------------------------------------------------------

loc_4348DF:				; CODE XREF: .text:004348CFj
		nop

loc_4348E0:				; CODE XREF: .text:004348DDj
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jnb	loc_43497B
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_4348FD
		mov	eax, [ebp+14h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		jmp	short loc_434902
; ---------------------------------------------------------------------------

loc_4348FD:				; CODE XREF: .text:004348F0j
		mov	eax, 0

loc_434902:				; CODE XREF: .text:004348FBj
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_44004F
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp+18h], 0
		jz	short loc_43494B
		mov	eax, [ebp-18h]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+18h]
		mov	[eax], edx

loc_43494B:				; CODE XREF: .text:00434925j
		mov	eax, [ebp-18h]
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_43326F
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	gcry_free
		cmp	dword ptr [ebp-1Ch], 0FFFFFFFFh
		jz	short loc_434976
		mov	eax, [ebp-0Ch]
		jmp	short loc_434979
; ---------------------------------------------------------------------------

loc_434976:				; CODE XREF: .text:0043496Fj
		mov	eax, [ebp-1Ch]

loc_434979:				; CODE XREF: .text:00434974j
		jmp	short loc_4349A2
; ---------------------------------------------------------------------------

loc_43497B:				; CODE XREF: .text:004348E6j
		mov	eax, [ebp-10h]
		mov	edx, [ebp+18h]
		mov	[esp+10h], edx
		mov	edx, [ebp+14h]
		mov	[esp+0Ch], edx
		mov	edx, [ebp+10h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_434241

loc_4349A2:				; CODE XREF: .text:loc_434979j
		add	esp, 54h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4349A8	proc near		; CODE XREF: sub_4349CF+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_4349C8
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_4349CD
; ---------------------------------------------------------------------------

loc_4349C8:				; CODE XREF: sub_4349A8+7j
		mov	eax, 0

loc_4349CD:				; CODE XREF: sub_4349A8+1Ej
		pop	ebp
		retn
sub_4349A8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4349CF	proc near		; CODE XREF: sub_4349EA+14p
					; sub_434A05+Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_4349A8
		leave
		retn
sub_4349CF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4349EA	proc near		; CODE XREF: sub_434F78+C3p
					; sub_434F78+17Ep ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	gpg_err_code_from_errno
		mov	[esp+18h+var_18], eax
		call	sub_4349CF
		leave
		retn
sub_4349EA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_434A05	proc near		; CODE XREF: sub_43542D+73Cp
					; sub_43542D+78Bp ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_4349CF
		leave
		retn
sub_434A05	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_434A1A(LPCSTR)
sub_434A1A	proc near		; CODE XREF: sub_438394+CFp

lpLibFileName	= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+lpLibFileName], eax ; lpLibFileName
		mov	eax, ds:LoadLibraryA
		call	eax ; LoadLibraryA
		sub	esp, 4
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_434A1A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_434A38(HMODULE, LPCSTR)
sub_434A38	proc near		; CODE XREF: sub_438394+EBp

hModule		= dword	ptr -28h
lpProcName	= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_434A76
		cmp	[ebp+arg_4], 0
		jz	short loc_434A76
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lpProcName], eax ; lpProcName
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hModule], eax ; hModule
		mov	eax, ds:GetProcAddress
		call	eax ; GetProcAddress
		sub	esp, 8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_434A71
		mov	eax, 0
		jmp	short locret_434A7B
; ---------------------------------------------------------------------------

loc_434A71:				; CODE XREF: sub_434A38+30j
		mov	eax, [ebp+var_C]
		jmp	short locret_434A7B
; ---------------------------------------------------------------------------

loc_434A76:				; CODE XREF: sub_434A38+Aj
					; sub_434A38+10j
		mov	eax, 0

locret_434A7B:				; CODE XREF: sub_434A38+37j
					; sub_434A38+3Cj
		leave
		retn
sub_434A38	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_434A7D(HANDLE)
sub_434A7D	proc near		; CODE XREF: sub_438394+104p

hObject		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_434AA0
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		jmp	short locret_434AA5
; ---------------------------------------------------------------------------

loc_434AA0:				; CODE XREF: sub_434A7D+Aj
		mov	eax, 0FFFFFFFFh

locret_434AA5:				; CODE XREF: sub_434A7D+21j
		leave
		retn
sub_434A7D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_434AA7	proc near		; CODE XREF: sub_434B1A+70p
					; sub_434CEA+93p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		jmp	short loc_434AEC
; ---------------------------------------------------------------------------

loc_434AAC:				; CODE XREF: sub_434AA7+57j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_434AE4
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_434AD0
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_434AE4

loc_434AD0:				; CODE XREF: sub_434AA7+1Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_434B00
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_434B00

loc_434AE4:				; CODE XREF: sub_434AA7+13j
					; sub_434AA7+27j
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_434AEC:				; CODE XREF: sub_434AA7+3j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_434B00
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_434AAC

loc_434B00:				; CODE XREF: sub_434AA7+31j
					; sub_434AA7+3Bj ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		pop	ebp
		retn
sub_434AA7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_434B1A	proc near		; CODE XREF: sub_434BFF+23p
					; sub_434BFF+6Ap ...

hObject		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		cmp	dword ptr [ebp+arg_0], 0
		jnz	short loc_434B49
		mov	[esp+28h+var_20], 0E2h ; int
		mov	[esp+28h+var_24], offset a____Gnupg22_12 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+28h+hObject], offset aFname ; "fname"
		call	sub_442650

loc_434B49:				; CODE XREF: sub_434B1A+11j
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_434B65
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+28h+var_24], eax ;	char
		mov	[esp+28h+hObject], offset aFd_cache_inval ; "fd_cache_invalidate (%s)\n"
		call	sub_43CBBE

loc_434B65:				; CODE XREF: sub_434B1A+36j
		mov	eax, ds:dword_451720
		mov	[ebp+var_C], eax
		jmp	short loc_434BE2
; ---------------------------------------------------------------------------

loc_434B6F:				; CODE XREF: sub_434B1A+CCj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_434BDA
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+hObject], edx
		call	sub_434AA7
		test	eax, eax
		jnz	short loc_434BDA
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_434BB2
		mov	eax, [ebp+var_C]
		add	eax, 8
		mov	[esp+28h+var_24], eax ;	char
		mov	[esp+28h+hObject], offset aDidS	; "		   did (%s)\n"
		call	sub_43CBBE

loc_434BB2:				; CODE XREF: sub_434B1A+80j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+28h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		test	eax, eax
		jnz	short loc_434BD0
		mov	[ebp+var_10], 0FFFFFFFFh

loc_434BD0:				; CODE XREF: sub_434B1A+ADj
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4], 0FFFFFFFFh

loc_434BDA:				; CODE XREF: sub_434B1A+5Ej
					; sub_434B1A+77j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_434BE2:				; CODE XREF: sub_434B1A+53j
		cmp	[ebp+var_C], 0
		jnz	short loc_434B6F
		mov	eax, [ebp+var_10]
		leave
		retn
sub_434B1A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_434BED	proc near		; CODE XREF: sub_436CA4+2A2p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		mov	eax, [ebp+var_4]
		leave
		retn
sub_434BED	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_434BFF(LPCSTR	lpFileName, char *)
sub_434BFF	proc near		; CODE XREF: sub_434E4F+122p
					; .text:004369EDp ...

Str		= dword	ptr -38h
Val		= dword	ptr -34h
dwShareMode	= dword	ptr -30h
lpSecurityAttributes= dword ptr	-2Ch
dwCreationDisposition= dword ptr -28h
dwFlagsAndAttributes= dword ptr	-24h
hTemplateFile	= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
dwDesiredAccess	= dword	ptr -0Ch
lpFileName	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+Val], 2Bh ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_434C4C
		mov	eax, [ebp+lpFileName]
		mov	[esp+38h+Str], eax
		call	sub_434B1A
		test	eax, eax
		jz	short loc_434C35
		mov	eax, 0FFFFFFFFh
		jmp	locret_434CE8
; ---------------------------------------------------------------------------

loc_434C35:				; CODE XREF: sub_434BFF+2Aj
		mov	[ebp+dwDesiredAccess], 0C0000000h
		mov	[ebp+var_10], 3
		mov	[ebp+var_14], 3
		jmp	short loc_434CA5
; ---------------------------------------------------------------------------

loc_434C4C:				; CODE XREF: sub_434BFF+1Bj
		mov	[esp+38h+Val], 77h ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_434C90
		mov	eax, [ebp+lpFileName]
		mov	[esp+38h+Str], eax
		call	sub_434B1A
		test	eax, eax
		jz	short loc_434C79
		mov	eax, 0FFFFFFFFh
		jmp	short locret_434CE8
; ---------------------------------------------------------------------------

loc_434C79:				; CODE XREF: sub_434BFF+71j
		mov	[ebp+dwDesiredAccess], 40000000h
		mov	[ebp+var_10], 2
		mov	[ebp+var_14], 2
		jmp	short loc_434CA5
; ---------------------------------------------------------------------------

loc_434C90:				; CODE XREF: sub_434BFF+62j
		mov	[ebp+dwDesiredAccess], 80000000h
		mov	[ebp+var_10], 3
		mov	[ebp+var_14], 1

loc_434CA5:				; CODE XREF: sub_434BFF+4Bj
					; sub_434BFF+8Fj
		mov	[esp+38h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+38h+dwFlagsAndAttributes],	80h ; dwFlagsAndAttributes
		mov	eax, [ebp+var_10]
		mov	[esp+38h+dwCreationDisposition], eax ; dwCreationDisposition
		mov	[esp+38h+lpSecurityAttributes],	0 ; lpSecurityAttributes
		mov	eax, [ebp+var_14]
		mov	[esp+38h+dwShareMode], eax ; dwShareMode
		mov	eax, [ebp+dwDesiredAccess]
		mov	[esp+38h+Val], eax ; dwDesiredAccess
		mov	eax, [ebp+lpFileName]
		mov	[esp+38h+Str], eax ; lpFileName
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]

locret_434CE8:				; CODE XREF: sub_434BFF+31j
					; sub_434BFF+78j
		leave
		retn
sub_434BFF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_434CEA(char *, HANDLE)
sub_434CEA	proc near		; CODE XREF: sub_434F78+297p

hObject		= dword	ptr -38h
Source		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	[ebp+arg_4], 0
		jnz	short loc_434D13
		mov	[esp+38h+var_30], 174h ; int
		mov	[esp+38h+Source], offset a____Gnupg22_12 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+38h+hObject], offset aFp ;	"fp"
		call	sub_442650

loc_434D13:				; CODE XREF: sub_434CEA+Bj
		cmp	[ebp+arg_0], 0
		jz	short loc_434D23
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_434D58

loc_434D23:				; CODE XREF: sub_434CEA+2Dj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	loc_434E46
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Source], eax ;	char
		mov	[esp+38h+hObject], offset aFd_cache_close ; "fd_cache_close (%d) real\n"
		call	sub_43CBBE
		jmp	loc_434E46
; ---------------------------------------------------------------------------

loc_434D58:				; CODE XREF: sub_434CEA+37j
		mov	eax, ds:dword_451720
		mov	[ebp+var_C], eax
		jmp	short loc_434DBC
; ---------------------------------------------------------------------------

loc_434D62:				; CODE XREF: sub_434CEA+D6j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_434DB4
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax
		mov	[esp+38h+hObject], edx
		call	sub_434AA7
		test	eax, eax
		jnz	short loc_434DB4
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	loc_434E49
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax ;	char
		mov	[esp+38h+hObject], offset aFd_cache_clo_0 ; "fd_cache_close (%s) used existing slot\"...
		call	sub_43CBBE
		jmp	loc_434E49
; ---------------------------------------------------------------------------

loc_434DB4:				; CODE XREF: sub_434CEA+81j
					; sub_434CEA+9Aj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_434DBC:				; CODE XREF: sub_434CEA+76j
		cmp	[ebp+var_C], 0
		jnz	short loc_434D62
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_434DDE
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax ;	char
		mov	[esp+38h+hObject], offset aFd_cache_clo_1 ; "fd_cache_close (%s) new slot created\n"
		call	sub_43CBBE

loc_434DDE:				; CODE XREF: sub_434CEA+DFj
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 0Ch
		mov	[esp+38h+Source], eax
		mov	[esp+38h+hObject], 1
		call	gcry_xcalloc
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax ;	Source
		mov	[esp+38h+hObject], edx ; Dest
		call	strcpy
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	edx, ds:dword_451720
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	ds:dword_451720, eax
		jmp	short loc_434E4A
; ---------------------------------------------------------------------------

loc_434E46:				; CODE XREF: sub_434CEA+50j
					; sub_434CEA+69j
		nop
		jmp	short loc_434E4A
; ---------------------------------------------------------------------------

loc_434E49:				; CODE XREF: sub_434CEA+ACj
					; sub_434CEA+C5j
		nop

loc_434E4A:				; CODE XREF: sub_434CEA+15Aj
					; sub_434CEA+15Dj
		mov	edi, [ebp+var_4]
		leave
		retn
sub_434CEA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_434E4F(LPCSTR	lpFileName, char *)
sub_434E4F	proc near		; CODE XREF: sub_4364E9+A0p

hFile		= dword	ptr -28h
lDistanceToMove	= dword	ptr -24h
lpDistanceToMoveHigh= dword ptr	-20h
dwMoveMethod	= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
lpFileName	= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+lpFileName], 0
		jnz	short loc_434E77
		mov	[esp+28h+lpDistanceToMoveHigh],	19Dh ; int
		mov	[esp+28h+lDistanceToMove], offset a____Gnupg22_12 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+28h+hFile], offset	aFname ; "fname"
		call	sub_442650

loc_434E77:				; CODE XREF: sub_434E4F+Aj
		mov	eax, ds:dword_451720
		mov	[ebp+var_C], eax
		jmp	loc_434F3E
; ---------------------------------------------------------------------------

loc_434E84:				; CODE XREF: sub_434E4F+F3j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, 0FFFFFFFFh
		jz	loc_434F36
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+lpFileName]
		mov	[esp+28h+lDistanceToMove], eax
		mov	[esp+28h+hFile], edx
		call	sub_434AA7
		test	eax, eax
		jnz	loc_434F36
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4], 0FFFFFFFFh
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_434EDF
		mov	eax, [ebp+lpFileName]
		mov	[esp+28h+lDistanceToMove], eax ; char
		mov	[esp+28h+hFile], offset	aFd_cache_openS	; "fd_cache_open (%s) using cached fp\n"
		call	sub_43CBBE

loc_434EDF:				; CODE XREF: sub_434E4F+7Bj
		mov	[esp+28h+dwMoveMethod],	0 ; dwMoveMethod
		mov	[esp+28h+lpDistanceToMoveHigh],	0 ; lpDistanceToMoveHigh
		mov	[esp+28h+lDistanceToMove], 0 ; lDistanceToMove
		mov	eax, [ebp+var_10]
		mov	[esp+28h+hFile], eax ; hFile
		mov	eax, ds:SetFilePointer
		call	eax ; SetFilePointer
		sub	esp, 10h
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_434F31
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+28h+lpDistanceToMoveHigh],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+lDistanceToMove], eax ; char
		mov	[esp+28h+hFile], offset	aRewindFileFail	; "rewind file failed on handle	%p: ec=%d\"...
		call	sub_43CB21
		mov	[ebp+var_10], 0FFFFFFFFh

loc_434F31:				; CODE XREF: sub_434E4F+BBj
		mov	eax, [ebp+var_10]
		jmp	short locret_434F76
; ---------------------------------------------------------------------------

loc_434F36:				; CODE XREF: sub_434E4F+3Ej
					; sub_434E4F+5Bj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_434F3E:				; CODE XREF: sub_434E4F+30j
		cmp	[ebp+var_C], 0
		jnz	loc_434E84
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_434F64
		mov	eax, [ebp+lpFileName]
		mov	[esp+28h+lDistanceToMove], eax ; char
		mov	[esp+28h+hFile], offset	aFd_cache_ope_0	; "fd_cache_open (%s) not cached\n"
		call	sub_43CBBE

loc_434F64:				; CODE XREF: sub_434E4F+100j
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lDistanceToMove], eax ; char *
		mov	eax, [ebp+lpFileName]
		mov	[esp+28h+hFile], eax ; lpFileName
		call	sub_434BFF

locret_434F76:				; CODE XREF: sub_434E4F+E5j
		leave
		retn
sub_434E4F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_434F78(int, int, int,	LPVOID,	int)
sub_434F78	proc near		; CODE XREF: sub_4364E9+175p
					; sub_4364E9+19Fp ...

hFile		= dword	ptr -58h
lpBuffer	= dword	ptr -54h
nNumberOfBytesToRead= dword ptr	-50h
lpNumberOfBytesRead= dword ptr -4Ch
lpOverlapped	= dword	ptr -48h
NumberOfBytesWritten= dword ptr	-30h
NumberOfBytesRead= dword ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
nNumberOfBytesToWrite= dword ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	[ebp+var_20], eax
		mov	[ebp+nNumberOfBytesToWrite], 0
		mov	[ebp+var_10], 0
		cmp	[ebp+arg_4], 3
		jnz	loc_43508F
		cmp	[ebp+var_20], 0
		jnz	short loc_434FCE
		mov	[esp+58h+nNumberOfBytesToRead],	226h ; int
		mov	[esp+58h+lpBuffer], offset a____Gnupg22_12 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+58h+hFile], offset	aSize ;	"size"
		call	sub_442650

loc_434FCE:				; CODE XREF: sub_434F78+38j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_434FED
		mov	[ebp+var_10], 0FFFFFFFFh
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		jmp	loc_43521F
; ---------------------------------------------------------------------------

loc_434FED:				; CODE XREF: sub_434F78+5Ej
		mov	[ebp+nNumberOfBytesToWrite], 0
		mov	[esp+58h+lpOverlapped],	0 ; lpOverlapped
		lea	eax, [ebp+NumberOfBytesRead]
		mov	[esp+58h+lpNumberOfBytesRead], eax ; lpNumberOfBytesRead
		mov	eax, [ebp+var_20]
		mov	[esp+58h+nNumberOfBytesToRead],	eax ; nNumberOfBytesToRead
		mov	eax, [ebp+arg_C]
		mov	[esp+58h+lpBuffer], eax	; lpBuffer
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+hFile], eax ; hFile
		mov	eax, ds:ReadFile
		call	eax ; ReadFile
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_435062
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 6Dh
		jz	short loc_435082
		mov	eax, [ebp+var_24]
		mov	[esp+58h+hFile], eax
		call	sub_4349EA
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_18]
		lea	edx, [eax+14h]
		mov	eax, [ebp+var_24]
		mov	[esp+58h+nNumberOfBytesToRead],	eax
		mov	[esp+58h+lpBuffer], edx	; char
		mov	[esp+58h+hFile], offset	aSReadErrorEcD ; "%s: read error: ec=%d\n"
		call	sub_43CB21
		jmp	short loc_435082
; ---------------------------------------------------------------------------

loc_435062:				; CODE XREF: sub_434F78+ABj
		mov	eax, [ebp+NumberOfBytesRead]
		test	eax, eax
		jnz	short loc_43507C
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+0Ch], 1
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_435082
; ---------------------------------------------------------------------------

loc_43507C:				; CODE XREF: sub_434F78+EFj
		mov	eax, [ebp+NumberOfBytesRead]
		mov	[ebp+nNumberOfBytesToWrite], eax

loc_435082:				; CODE XREF: sub_434F78+BBj
					; sub_434F78+E8j ...
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+nNumberOfBytesToWrite]
		mov	[eax], edx
		jmp	loc_43521F
; ---------------------------------------------------------------------------

loc_43508F:				; CODE XREF: sub_434F78+2Ej
		cmp	[ebp+arg_4], 4
		jnz	loc_43514B
		cmp	[ebp+var_20], 0
		jz	loc_43513E
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+nNumberOfBytesToWrite], eax

loc_4350AF:				; CODE XREF: sub_434F78+1B5j
		cmp	[ebp+var_20], 0
		jz	short loc_43511D
		mov	[esp+58h+lpOverlapped],	0 ; lpOverlapped
		lea	eax, [ebp+NumberOfBytesWritten]
		mov	[esp+58h+lpNumberOfBytesRead], eax ; lpNumberOfBytesWritten
		mov	eax, [ebp+nNumberOfBytesToWrite]
		mov	[esp+58h+nNumberOfBytesToRead],	eax ; nNumberOfBytesToWrite
		mov	eax, [ebp+var_14]
		mov	[esp+58h+lpBuffer], eax	; lpBuffer
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+hFile], eax ; hFile
		mov	eax, ds:WriteFile
		call	eax ; WriteFile
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_43511D
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+hFile], eax
		call	sub_4349EA
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_18]
		lea	edx, [eax+14h]
		mov	eax, [ebp+var_28]
		mov	[esp+58h+nNumberOfBytesToRead],	eax
		mov	[esp+58h+lpBuffer], edx	; char
		mov	[esp+58h+hFile], offset	aSWriteErrorEcD	; "%s: write error: ec=%d\n"
		call	sub_43CB21
		jmp	short loc_43512F
; ---------------------------------------------------------------------------

loc_43511D:				; CODE XREF: sub_434F78+13Bj
					; sub_434F78+16Cj
		mov	eax, [ebp+NumberOfBytesWritten]
		add	[ebp+var_14], eax
		mov	eax, [ebp+NumberOfBytesWritten]
		sub	[ebp+nNumberOfBytesToWrite], eax
		cmp	[ebp+nNumberOfBytesToWrite], 0
		jnz	short loc_4350AF

loc_43512F:				; CODE XREF: sub_434F78+1A3j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+nNumberOfBytesToWrite], eax

loc_43513E:				; CODE XREF: sub_434F78+125j
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+nNumberOfBytesToWrite]
		mov	[eax], edx
		jmp	loc_43521F
; ---------------------------------------------------------------------------

loc_43514B:				; CODE XREF: sub_434F78+11Bj
		cmp	[ebp+arg_4], 1
		jnz	short loc_435174
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+8], 0
		jmp	loc_43521F
; ---------------------------------------------------------------------------

loc_435174:				; CODE XREF: sub_434F78+1D7j
		cmp	[ebp+arg_4], 5
		jnz	short loc_435188
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], offset	aFile_filterFd ; "file_filter(fd)"
		jmp	loc_43521F
; ---------------------------------------------------------------------------

loc_435188:				; CODE XREF: sub_434F78+200j
		cmp	[ebp+arg_4], 2
		jnz	loc_43521F
		mov	[esp+58h+hFile], 0FFFFFFF6h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		cmp	eax, [ebp+var_1C]
		jz	short loc_435214
		mov	[esp+58h+hFile], 0FFFFFFF5h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		cmp	eax, [ebp+var_1C]
		jz	short loc_435214
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_4351E4
		mov	eax, [ebp+var_18]
		lea	edx, [eax+14h]
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+nNumberOfBytesToRead],	eax
		mov	[esp+58h+lpBuffer], edx	; char
		mov	[esp+58h+hFile], offset	aSCloseHandleP ; "%s: close handle %p\n"
		call	sub_43CBBE

loc_4351E4:				; CODE XREF: sub_434F78+24Dj
		mov	eax, [ebp+var_18]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_435214
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_435200
		mov	eax, [ebp+var_18]
		add	eax, 14h
		jmp	short loc_435205
; ---------------------------------------------------------------------------

loc_435200:				; CODE XREF: sub_434F78+27Ej
		mov	eax, 0

loc_435205:				; CODE XREF: sub_434F78+286j
		mov	edx, [ebp+var_1C]
		mov	[esp+58h+lpBuffer], edx	; HANDLE
		mov	[esp+58h+hFile], eax ; char *
		call	sub_434CEA

loc_435214:				; CODE XREF: sub_434F78+22Ej
					; sub_434F78+244j ...
		mov	eax, [ebp+var_18]
		mov	[esp+58h+hFile], eax
		call	gcry_free

loc_43521F:				; CODE XREF: sub_434F78+70j
					; sub_434F78+112j ...
		mov	eax, [ebp+var_10]
		leave
		retn
sub_434F78	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_435224(int, int, int,	char *,	int)
sub_435224	proc near		; CODE XREF: .text:004368CAp
					; .text:004368F4p
					; DATA XREF: ...

s		= dword	ptr -48h
buf		= dword	ptr -44h
len		= dword	ptr -40h
flags		= dword	ptr -3Ch
var_2C		= byte ptr -2Ch
var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		cmp	[ebp+arg_4], 3
		jnz	loc_43531B
		cmp	[ebp+var_1C], 0
		jnz	short loc_435272
		mov	[esp+48h+len], 2CEh ; int
		mov	[esp+48h+buf], offset a____Gnupg22_12 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+s], offset aSize ; "size"
		call	sub_442650

loc_435272:				; CODE XREF: sub_435224+30j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_435291
		mov	[ebp+var_10], 0FFFFFFFFh
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 0
		jmp	loc_435428
; ---------------------------------------------------------------------------

loc_435291:				; CODE XREF: sub_435224+56j
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[esp+48h+flags], 0 ; flags
		mov	[esp+48h+len], edx ; len
		mov	edx, [ebp+arg_C]
		mov	[esp+48h+buf], edx ; buf
		mov	[esp+48h+s], eax ; s
		mov	eax, ds:recv
		call	eax ; recv
		sub	esp, 10h
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jnz	short loc_4352EF
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	dword ptr [ebp+var_24],	eax
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+48h+s], eax
		call	sub_4349EA
		mov	[ebp+var_10], eax
		mov	eax, dword ptr [ebp+var_24]
		mov	[esp+48h+buf], eax ; char
		mov	[esp+48h+s], offset aSocketReadErro ; "socket read error: ec=%d\n"
		call	sub_43CB21
		jmp	short loc_43530E
; ---------------------------------------------------------------------------

loc_4352EF:				; CODE XREF: sub_435224+9Cj
		cmp	[ebp+var_20], 0
		jnz	short loc_435308
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+0Ch], 1
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_43530E
; ---------------------------------------------------------------------------

loc_435308:				; CODE XREF: sub_435224+CFj
		mov	eax, [ebp+var_20]
		mov	[ebp+var_C], eax

loc_43530E:				; CODE XREF: sub_435224+C9j
					; sub_435224+E2j
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		jmp	loc_435428
; ---------------------------------------------------------------------------

loc_43531B:				; CODE XREF: sub_435224+26j
		cmp	[ebp+arg_4], 4
		jnz	loc_4353C4
		cmp	[ebp+var_1C], 0
		jz	loc_4353BA
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax

loc_43533B:				; CODE XREF: sub_435224+185j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[esp+48h+flags], 0 ; flags
		mov	[esp+48h+len], edx ; len
		mov	edx, [ebp+var_14]
		mov	[esp+48h+buf], edx ; buf
		mov	[esp+48h+s], eax ; s
		mov	eax, ds:send
		call	eax ; send
		sub	esp, 10h
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0FFFFFFFFh
		jnz	short loc_435399
		mov	eax, ds:WSAGetLastError
		call	eax ; WSAGetLastError
		mov	dword ptr [ebp+var_2C],	eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+48h+s], eax
		call	sub_4349EA
		mov	[ebp+var_10], eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+48h+buf], eax ; char
		mov	[esp+48h+s], offset aSocketWriteErr ; "socket write error: ec=%d\n"
		call	sub_43CB21
		jmp	short loc_4353AB
; ---------------------------------------------------------------------------

loc_435399:				; CODE XREF: sub_435224+146j
		mov	eax, [ebp+var_28]
		add	[ebp+var_14], eax
		mov	eax, [ebp+var_28]
		sub	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_43533B

loc_4353AB:				; CODE XREF: sub_435224+173j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax

loc_4353BA:				; CODE XREF: sub_435224+105j
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		jmp	short loc_435428
; ---------------------------------------------------------------------------

loc_4353C4:				; CODE XREF: sub_435224+FBj
		cmp	[ebp+arg_4], 1
		jnz	short loc_4353EA
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+8], 0
		jmp	short loc_435428
; ---------------------------------------------------------------------------

loc_4353EA:				; CODE XREF: sub_435224+1A4j
		cmp	[ebp+arg_4], 5
		jnz	short loc_4353FB
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], offset	aSock_filter ; "sock_filter"
		jmp	short loc_435428
; ---------------------------------------------------------------------------

loc_4353FB:				; CODE XREF: sub_435224+1CAj
		cmp	[ebp+arg_4], 2
		jnz	short loc_435428
		mov	eax, [ebp+var_18]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_43541D
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[esp+48h+s], eax ; s
		mov	eax, ds:closesocket
		call	eax ; closesocket
		sub	esp, 4

loc_43541D:				; CODE XREF: sub_435224+1E5j
		mov	eax, [ebp+var_18]
		mov	[esp+48h+s], eax
		call	gcry_free

loc_435428:				; CODE XREF: sub_435224+68j
					; sub_435224+F2j ...
		mov	eax, [ebp+var_10]
		leave
		retn
sub_435224	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43542D	proc near		; DATA XREF: .text:004388E9o
					; .text:00438922o

Dst		= dword	ptr -48h
Src		= dword	ptr -44h
Size		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= byte ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	dword ptr [ebp+var_2C],	eax
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_30], eax
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_4], 3
		jnz	loc_4359F9
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+var_30]
		mov	[ebp+var_18], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_435488
		mov	[esp+48h+Size],	32Dh ; int
		mov	[esp+48h+Src], offset a____Gnupg22_12 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aSize ; "size"
		call	sub_442650

loc_435488:				; CODE XREF: sub_43542D+3Dj
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	loc_4359D0
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_4359D0
; ---------------------------------------------------------------------------

loc_4354A2:				; CODE XREF: sub_43542D+5ADj
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_4359B6
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+0Ch]
		cmp	eax, 2
		jnz	short loc_4354DB
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 1
		cmp	[ebp+var_1C], 0
		jnz	loc_4359E2
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_4359E2
; ---------------------------------------------------------------------------

loc_4354DB:				; CODE XREF: sub_43542D+8Cj
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_435900
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	short loc_435508
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+18h]
		mov	[ebp+var_10], eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+18h], 0
		jmp	short loc_435586
; ---------------------------------------------------------------------------

loc_435508:				; CODE XREF: sub_43542D+C4j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_435522
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_43552F

loc_435522:				; CODE XREF: sub_43542D+E3j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_437D5E
		jmp	short loc_435565
; ---------------------------------------------------------------------------

loc_43552F:				; CODE XREF: sub_43542D+F3j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_435565:				; CODE XREF: sub_43542D+100j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_435586
		mov	[esp+48h+Dst], offset aBlock_filter1s ;	"block_filter: 1st length byte missing\n"
		call	sub_43CB21
		mov	[ebp+var_14], 59h
		jmp	loc_4359EC
; ---------------------------------------------------------------------------

loc_435586:				; CODE XREF: sub_43542D+D9j
					; sub_43542D+13Fj
		cmp	[ebp+var_10], 0BFh
		jg	short loc_4355D0
		mov	edx, [ebp+var_10]
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+0Ch], 2
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_4359B6
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 1
		cmp	[ebp+var_1C], 0
		jnz	loc_4359E5
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_4359E5
; ---------------------------------------------------------------------------

loc_4355D0:				; CODE XREF: sub_43542D+160j
		cmp	[ebp+var_10], 0DFh
		jg	loc_4356BD
		mov	eax, [ebp+var_10]
		sub	eax, 0C0h
		shl	eax, 8
		mov	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_43560A
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_435617

loc_43560A:				; CODE XREF: sub_43542D+1CBj
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_437D5E
		jmp	short loc_43564D
; ---------------------------------------------------------------------------

loc_435617:				; CODE XREF: sub_43542D+1DBj
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_43564D:				; CODE XREF: sub_43542D+1E8j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_43566E
		mov	[esp+48h+Dst], offset aBlock_filter2n ;	"block_filter: 2nd length byte missing\n"
		call	sub_43CB21
		mov	[ebp+var_14], 59h
		jmp	loc_4359EC
; ---------------------------------------------------------------------------

loc_43566E:				; CODE XREF: sub_43542D+227j
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		add	eax, edx
		lea	edx, [eax+0C0h]
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+0Ch], 2
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_4359B6
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 1
		cmp	[ebp+var_1C], 0
		jnz	loc_4359E8
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_4359E8
; ---------------------------------------------------------------------------

loc_4356BD:				; CODE XREF: sub_43542D+1AAj
		cmp	[ebp+var_10], 0FFh
		jnz	loc_4358E0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_4356E4
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_4356F4

loc_4356E4:				; CODE XREF: sub_43542D+2A5j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_437D5E
		shl	eax, 18h
		jmp	short loc_43572D
; ---------------------------------------------------------------------------

loc_4356F4:				; CODE XREF: sub_43542D+2B5j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 18h
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_43572D:				; CODE XREF: sub_43542D+2C5j
		mov	edx, dword ptr [ebp+var_2C]
		mov	[edx+4], eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_435753
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_435763

loc_435753:				; CODE XREF: sub_43542D+314j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_437D5E
		shl	eax, 10h
		jmp	short loc_43579C
; ---------------------------------------------------------------------------

loc_435763:				; CODE XREF: sub_43542D+324j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 10h
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_43579C:				; CODE XREF: sub_43542D+334j
		mov	edx, ebx
		or	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, dword ptr [ebp+var_2C]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_4357C6
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_4357D6

loc_4357C6:				; CODE XREF: sub_43542D+387j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_437D5E
		shl	eax, 8
		jmp	short loc_43580F
; ---------------------------------------------------------------------------

loc_4357D6:				; CODE XREF: sub_43542D+397j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		shl	eax, 8
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_43580F:				; CODE XREF: sub_43542D+3A7j
		mov	edx, ebx
		or	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_435833
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_435840

loc_435833:				; CODE XREF: sub_43542D+3F4j
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_437D5E
		jmp	short loc_435876
; ---------------------------------------------------------------------------

loc_435840:				; CODE XREF: sub_43542D+404j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_8]
		mov	[edx+2Ch], ecx

loc_435876:				; CODE XREF: sub_43542D+411j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_435897
		mov	[esp+48h+Dst], offset aBlock_filterIn ;	"block_filter: invalid 4 byte length\n"
		call	sub_43CB21
		mov	[ebp+var_14], 59h
		jmp	loc_4359EC
; ---------------------------------------------------------------------------

loc_435897:				; CODE XREF: sub_43542D+450j
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		or	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+0Ch], 2
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_4359B6
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 1
		cmp	[ebp+var_1C], 0
		jnz	loc_4359EB
		mov	[ebp+var_14], 0FFFFFFFFh
		jmp	loc_4359EB
; ---------------------------------------------------------------------------

loc_4358E0:				; CODE XREF: sub_43542D+297j
		mov	eax, [ebp+var_10]
		and	eax, 1Fh
		mov	edx, 1
		mov	ebx, edx
		mov	ecx, eax
		shl	ebx, cl
		mov	eax, ebx
		mov	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		jmp	loc_4359B6
; ---------------------------------------------------------------------------

loc_435900:				; CODE XREF: sub_43542D+B6j
		mov	[esp+48h+Size],	offset aBlock_filter ; "block_filter"
		mov	[esp+48h+Src], 386h
		mov	[esp+48h+Dst], offset a____Gnupg22_12 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_43CCB0
; ---------------------------------------------------------------------------

loc_43591C:				; CODE XREF: sub_43542D+59Dj
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_C]
		cmp	edx, eax
		cmovbe	eax, edx
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_34]
		mov	[esp+48h+Size],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Src], eax ; char
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_437E07
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_34]
		jge	short loc_435993
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_43595E
		mov	[ebp+var_10], 0

loc_43595E:				; CODE XREF: sub_43542D+528j
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		add	edx, eax
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_C]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+Size],	eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+48h+Src], eax ; char
		mov	[esp+48h+Dst], offset aBlock_filterPR ;	"block_filter %p: read error (size=%lu,a"...
		call	sub_43CB21
		mov	[ebp+var_14], 59h
		jmp	short loc_4359B6
; ---------------------------------------------------------------------------

loc_435993:				; CODE XREF: sub_43542D+522j
		mov	eax, [ebp+var_10]
		sub	[ebp+var_C], eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_10]
		sub	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		add	[ebp+var_18], eax
		mov	eax, [ebp+var_10]
		add	[ebp+var_1C], eax

loc_4359B6:				; CODE XREF: sub_43542D+7Dj
					; sub_43542D+17Dj ...
		cmp	[ebp+var_14], 0
		jnz	short loc_4359D0
		cmp	[ebp+var_C], 0
		jz	short loc_4359D0
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_43591C

loc_4359D0:				; CODE XREF: sub_43542D+63j
					; sub_43542D+70j ...
		cmp	[ebp+var_14], 0
		jnz	short loc_4359EC
		cmp	[ebp+var_C], 0
		jnz	loc_4354A2
		jmp	short loc_4359EC
; ---------------------------------------------------------------------------

loc_4359E2:				; CODE XREF: sub_43542D+9Cj
					; sub_43542D+A9j
		nop
		jmp	short loc_4359EC
; ---------------------------------------------------------------------------

loc_4359E5:				; CODE XREF: sub_43542D+191j
					; sub_43542D+19Ej
		nop
		jmp	short loc_4359EC
; ---------------------------------------------------------------------------

loc_4359E8:				; CODE XREF: sub_43542D+27Ej
					; sub_43542D+28Bj
		nop
		jmp	short loc_4359EC
; ---------------------------------------------------------------------------

loc_4359EB:				; CODE XREF: sub_43542D+4A1j
					; sub_43542D+4AEj
		nop

loc_4359EC:				; CODE XREF: sub_43542D+154j
					; sub_43542D+23Cj ...
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_1C]
		mov	[eax], edx
		jmp	loc_435F5F
; ---------------------------------------------------------------------------

loc_4359F9:				; CODE XREF: sub_43542D+26j
		cmp	[ebp+arg_4], 4
		jnz	loc_435CA2
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_435C86
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+14h]
		add	eax, [ebp+var_C]
		mov	[ebp+var_28], eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+14h]
		cmp	eax, 200h
		jbe	short loc_435A46
		mov	[esp+48h+Size],	3A7h ; int
		mov	[esp+48h+Src], offset a____Gnupg22_12 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aABuflenOp_min_ ;	"a->buflen <= OP_MIN_PARTIAL_CHUNK"
		call	sub_442650

loc_435A46:				; CODE XREF: sub_43542D+5FBj
		cmp	[ebp+var_28], 1FFh
		ja	short loc_435AA9
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_435A6D
		mov	[esp+48h+Dst], 200h
		call	gcry_xmalloc
		mov	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+10h], edx

loc_435A6D:				; CODE XREF: sub_43542D+62Aj
		mov	edx, [ebp+var_30]
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	ecx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+14h]
		add	eax, ecx
		mov	ecx, [ebp+var_C]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+14h]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+14h], edx
		jmp	loc_435F5F
; ---------------------------------------------------------------------------

loc_435AA9:				; CODE XREF: sub_43542D+620j
		mov	eax, [ebp+var_30]
		mov	[ebp+var_18], eax

loc_435AAF:				; CODE XREF: sub_43542D+7ACj
		mov	[ebp+var_20], 400h
		mov	[ebp+var_10], 0Ah
		jmp	short loc_435AC6
; ---------------------------------------------------------------------------

loc_435ABF:				; CODE XREF: sub_43542D+69Fj
		shl	[ebp+var_20], 1
		add	[ebp+var_10], 1

loc_435AC6:				; CODE XREF: sub_43542D+690j
		mov	eax, [ebp+var_20]
		cmp	eax, [ebp+var_28]
		jbe	short loc_435ABF
		mov	eax, [ebp+var_20]
		shr	eax, 1
		mov	[ebp+var_20], eax
		sub	[ebp+var_10], 1
		cmp	[ebp+var_10], 1Fh
		jle	short loc_435AFC
		mov	[esp+48h+Size],	3BFh ; int
		mov	[esp+48h+Src], offset a____Gnupg22_12 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aC0x1f ; "c <= 0x1f"
		call	sub_442650

loc_435AFC:				; CODE XREF: sub_43542D+6B1j
		or	[ebp+var_10], 0E0h
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_438085
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+14h]
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_435B81
		cmp	[ebp+var_24], 200h
		jz	short loc_435B49
		mov	[esp+48h+Size],	3C4h ; int
		mov	[esp+48h+Src], offset a____Gnupg22_12 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aNOp_min_partia ;	"n == OP_MIN_PARTIAL_CHUNK"
		call	sub_442650

loc_435B49:				; CODE XREF: sub_43542D+6FEj
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	edx, [ebp+var_24]
		mov	[esp+48h+Size],	edx
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_43812A
		test	eax, eax
		jz	short loc_435B71
		call	sub_434A05
		mov	[ebp+var_14], eax

loc_435B71:				; CODE XREF: sub_43542D+73Aj
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+var_24]
		sub	[ebp+var_28], eax

loc_435B81:				; CODE XREF: sub_43542D+6F5j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_20]
		jbe	short loc_435B95
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax

loc_435B95:				; CODE XREF: sub_43542D+760j
		cmp	[ebp+var_24], 0
		jz	short loc_435BC0
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Size],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_43812A
		test	eax, eax
		jz	short loc_435BC0
		call	sub_434A05
		mov	[ebp+var_14], eax

loc_435BC0:				; CODE XREF: sub_43542D+76Cj
					; sub_43542D+789j
		mov	eax, [ebp+var_24]
		add	[ebp+var_18], eax
		mov	eax, [ebp+var_24]
		sub	[ebp+var_28], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_435BDF
		cmp	[ebp+var_28], 1FFh
		ja	loc_435AAF

loc_435BDF:				; CODE XREF: sub_43542D+7A3j
		cmp	[ebp+var_14], 0
		jnz	loc_435F5F
		cmp	[ebp+var_28], 0
		jz	loc_435F5F
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_435C19
		mov	[esp+48h+Size],	3D5h ; int
		mov	[esp+48h+Src], offset a____Gnupg22_12 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aABuflen ; "!a->buflen"
		call	sub_442650

loc_435C19:				; CODE XREF: sub_43542D+7CEj
		cmp	[ebp+var_28], 1FFh
		jbe	short loc_435C3E
		mov	[esp+48h+Size],	3D6h ; int
		mov	[esp+48h+Src], offset a____Gnupg22_12 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+Dst], offset aNbytesOp_min_p ;	"nbytes	< OP_MIN_PARTIAL_CHUNK"
		call	sub_442650

loc_435C3E:				; CODE XREF: sub_43542D+7F3j
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_435C5C
		mov	[esp+48h+Dst], 200h
		call	gcry_xmalloc
		mov	edx, eax
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+10h], edx

loc_435C5C:				; CODE XREF: sub_43542D+819j
		mov	edx, [ebp+var_18]
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	ecx, [ebp+var_28]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [ebp+var_28]
		mov	[eax+14h], edx
		jmp	loc_435F5F
; ---------------------------------------------------------------------------

loc_435C86:				; CODE XREF: sub_43542D+5DEj
		mov	[esp+48h+Size],	offset aBlock_filter ; "block_filter"
		mov	[esp+48h+Src], 3DFh
		mov	[esp+48h+Dst], offset a____Gnupg22_12 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_43CCB0
; ---------------------------------------------------------------------------

loc_435CA2:				; CODE XREF: sub_43542D+5D0j
		cmp	[ebp+arg_4], 1
		jnz	loc_435D2F
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_435CC8
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+48h+Src], eax ; char
		mov	[esp+48h+Dst], offset aInitBlock_filt ;	"init block_filter %p\n"
		call	sub_43CBBE

loc_435CC8:				; CODE XREF: sub_43542D+886j
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_435CDE
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+8], 0
		jmp	short loc_435D0C
; ---------------------------------------------------------------------------

loc_435CDE:				; CODE XREF: sub_43542D+8A3j
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax]
		cmp	eax, 1
		jnz	short loc_435D00
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+4], 0
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+8], edx
		jmp	short loc_435D0C
; ---------------------------------------------------------------------------

loc_435D00:				; CODE XREF: sub_43542D+8B9j
		mov	eax, dword ptr [ebp+var_2C]
		mov	edx, [eax+4]
		mov	eax, dword ptr [ebp+var_2C]
		mov	[eax+8], edx

loc_435D0C:				; CODE XREF: sub_43542D+8AFj
					; sub_43542D+8D1j
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+10h], 0
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_435F5F
; ---------------------------------------------------------------------------

loc_435D2F:				; CODE XREF: sub_43542D+879j
		cmp	[ebp+arg_4], 5
		jnz	short loc_435D43
		mov	eax, [ebp+var_30]
		mov	dword ptr [eax], offset	aBlock_filter_0	; "block_filter"
		jmp	loc_435F5F
; ---------------------------------------------------------------------------

loc_435D43:				; CODE XREF: sub_43542D+906j
		cmp	[ebp+arg_4], 2
		jnz	loc_435F5F
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	loc_435F22
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_435F06
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+14h]
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0BFh
		ja	short loc_435D95
		mov	eax, [ebp+var_38]
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_438085
		mov	[ebp+var_14], eax
		jmp	loc_435E88
; ---------------------------------------------------------------------------

loc_435D95:				; CODE XREF: sub_43542D+94Cj
		cmp	[ebp+var_38], 20BFh
		ja	short loc_435DEE
		mov	eax, [ebp+var_38]
		sub	eax, 0C0h
		shr	eax, 8
		add	eax, 0C0h
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_438085
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	loc_435E88
		mov	eax, [ebp+var_38]
		sub	eax, 0C0h
		and	eax, 0FFh
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_438085
		mov	[ebp+var_14], eax
		jmp	loc_435E88
; ---------------------------------------------------------------------------

loc_435DEE:				; CODE XREF: sub_43542D+96Fj
		mov	[esp+48h+Src], 0FFh
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_438085
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_435E88
		mov	eax, [ebp+var_38]
		shr	eax, 18h
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_438085
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_435E88
		mov	eax, [ebp+var_38]
		shr	eax, 10h
		and	eax, 0FFh
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_438085
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_435E88
		mov	eax, [ebp+var_38]
		shr	eax, 8
		and	eax, 0FFh
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_438085
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_435E88
		mov	eax, [ebp+var_38]
		and	eax, 0FFh
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_438085
		mov	[ebp+var_14], eax

loc_435E88:				; CODE XREF: sub_43542D+963j
					; sub_43542D+997j ...
		cmp	[ebp+var_14], 0
		jnz	short loc_435EB3
		cmp	[ebp+var_38], 0
		jz	short loc_435EB3
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	edx, [ebp+var_38]
		mov	[esp+48h+Size],	edx
		mov	[esp+48h+Src], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Dst], eax
		call	sub_43812A
		mov	[ebp+var_14], eax

loc_435EB3:				; CODE XREF: sub_43542D+A5Fj
					; sub_43542D+A65j
		cmp	[ebp+var_14], 0
		jz	short loc_435EE2
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+48h+Dst], eax ; int
		call	strerror
		mov	[esp+48h+Src], eax ; char
		mov	[esp+48h+Dst], offset aBlock_filterWr ;	"block_filter: write error: %s\n"
		call	sub_43CB21
		call	sub_434A05
		mov	[ebp+var_14], eax

loc_435EE2:				; CODE XREF: sub_43542D+A8Aj
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+10h]
		mov	[esp+48h+Dst], eax
		call	gcry_free
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+10h], 0
		mov	eax, dword ptr [ebp+var_2C]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_435F38
; ---------------------------------------------------------------------------

loc_435F06:				; CODE XREF: sub_43542D+936j
		mov	[esp+48h+Size],	offset aBlock_filter ; "block_filter"
		mov	[esp+48h+Src], 423h
		mov	[esp+48h+Dst], offset a____Gnupg22_12 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_43CCB0
; ---------------------------------------------------------------------------

loc_435F22:				; CODE XREF: sub_43542D+928j
		mov	eax, dword ptr [ebp+var_2C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_435F38
		mov	[esp+48h+Dst], offset aBlock_filterPe ;	"block_filter: pending bytes!\n"
		call	sub_43CB21

loc_435F38:				; CODE XREF: sub_43542D+AD7j
					; sub_43542D+AFDj
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_435F54
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+48h+Src], eax ; char
		mov	[esp+48h+Dst], offset aFreeBlock_filt ;	"free block_filter %p\n"
		call	sub_43CBBE

loc_435F54:				; CODE XREF: sub_43542D+B12j
		mov	eax, dword ptr [ebp+var_2C]
		mov	[esp+48h+Dst], eax
		call	gcry_free

loc_435F5F:				; CODE XREF: sub_43542D+5C7j
					; sub_43542D+677j ...
		mov	eax, [ebp+var_14]
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_43542D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_435F68	proc near		; CODE XREF: .text:00436048p
					; sub_436F81+2CBp ...

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	eax, ds:dword_451D90
		test	eax, eax
		jnz	loc_43602A
		jmp	loc_436034
; ---------------------------------------------------------------------------

loc_435F83:				; CODE XREF: sub_435F68+C6j
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], offset aNone_1 ; "[none]"
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_435FCA
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	edx, [ebp+var_1C]
		mov	[esp+48h+var_38], edx
		lea	edx, [ebp+var_20]
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], 0
		mov	dword ptr [esp+48h+var_44], 5
		mov	[esp+48h+var_48], eax
		call	ecx

loc_435FCA:				; CODE XREF: sub_435F68+31j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	edi, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	esi, eax
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+38h]
		mov	eax, [ebp+var_20]
		test	eax, eax
		jz	short loc_435FEC
		mov	eax, [ebp+var_20]
		jmp	short loc_435FF1
; ---------------------------------------------------------------------------

loc_435FEC:				; CODE XREF: sub_435F68+7Dj
		mov	eax, offset a?_1 ; "?"

loc_435FF1:				; CODE XREF: sub_435F68+82j
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+48h+var_30], edi
		mov	[esp+48h+var_34], esi
		mov	[esp+48h+var_38], ebx
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], ecx
		mov	dword ptr [esp+48h+var_44], edx	; char
		mov	[esp+48h+var_48], offset aIobufChainD_DS ; "iobuf chain: %d.%d `%s' filter_eof=%d s"...
		call	sub_43CBBE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_43602A:				; CODE XREF: sub_435F68+10j
		cmp	[ebp+arg_0], 0
		jnz	loc_435F83

loc_436034:				; CODE XREF: sub_435F68+16j
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_435F68	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_435F68
		mov	eax, 0
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_436054	proc near		; CODE XREF: .text:0043637Ep
					; .text:0043639Fp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_24], 68h
		mov	[esp+28h+var_28], 1
		call	gcry_xcalloc
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	gcry_xmalloc
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax+34h], edx
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+28h], edx
		mov	eax, ds:dword_451730
		add	eax, 1
		mov	ds:dword_451730, eax
		mov	edx, ds:dword_451730
		mov	eax, [ebp+var_C]
		mov	[eax+54h], edx
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+58h], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+60h], 0
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4Ch], 0
		mov	eax, [ebp+var_C]
		leave
		retn
sub_436054	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4360D1	proc near		; CODE XREF: .text:00425CBAp
					; .text:0043633Cp

File		= dword	ptr -38h
Val		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	[ebp+var_14], 0
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_0], 0
		jz	loc_436280
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_436280
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+38h+File],	eax ; File
		call	fclose
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+38h+File],	eax
		call	gcry_free
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_436139
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+File],	offset aIobuf_closeP ; "iobuf_close -> %p\n"
		call	sub_43CBBE

loc_436139:				; CODE XREF: sub_4360D1+50j
		mov	eax, 0
		jmp	loc_436293
; ---------------------------------------------------------------------------

loc_436143:				; CODE XREF: sub_4360D1+1B9j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_436185
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+File],	eax
		call	sub_437BF0
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_436185
		mov	eax, [ebp+var_C]
		mov	[esp+38h+File],	eax
		call	gpg_strerror
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+File],	offset aIobuf_flushFai ; "iobuf_flush failed on	close: %s\n"
		call	sub_43CB21

loc_436185:				; CODE XREF: sub_4360D1+83j
					; sub_4360D1+97j
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_4361C9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_4361A0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		jmp	short loc_4361A5
; ---------------------------------------------------------------------------

loc_4361A0:				; CODE XREF: sub_4360D1+C5j
		mov	eax, offset a?_1 ; "?"

loc_4361A5:				; CODE XREF: sub_4360D1+CDj
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+38h+var_2C], eax
		mov	[esp+38h+Size],	ecx
		mov	[esp+38h+Val], edx ; char
		mov	[esp+38h+File],	offset aIobufD_DCloseS ; "iobuf-%d.%d: close `%s'\n"
		call	sub_43CBBE

loc_4361C9:				; CODE XREF: sub_4360D1+BBj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_436229
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ecx, [ebp+var_14]
		mov	[esp+38h+var_28], ecx
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Val], 2
		mov	[esp+38h+File],	eax
		call	ebx
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_436229
		mov	eax, [ebp+var_C]
		mov	[esp+38h+File],	eax
		call	gpg_strerror
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+File],	offset aIobufctrl_free ; "IOBUFCTRL_FREE failed	on close: %s\n"
		call	sub_43CB21

loc_436229:				; CODE XREF: sub_4360D1+100j
					; sub_4360D1+13Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+38h+File],	eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		test	eax, eax
		jz	short loc_43626F
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+28h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Val], 0 ; Val
		mov	[esp+38h+File],	eax ; Dst
		call	memset
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+38h+File],	eax
		call	gcry_free

loc_43626F:				; CODE XREF: sub_4360D1+16Ej
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+File],	eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_0], eax

loc_436280:				; CODE XREF: sub_4360D1+19j
					; sub_4360D1+27j
		cmp	[ebp+arg_0], 0
		jz	short loc_436290
		cmp	[ebp+var_C], 0
		jz	loc_436143

loc_436290:				; CODE XREF: sub_4360D1+1B3j
		mov	eax, [ebp+var_C]

loc_436293:				; CODE XREF: sub_4360D1+6Dj
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_4360D1	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	dword ptr [ebp-10h], 0
		cmp	dword ptr [ebp+8], 0
		jz	short loc_4362E3
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_4362E3
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4387BE
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_4362E3
		mov	eax, [ebp-14h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4362E3
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	gcry_xstrdup
		mov	[ebp-10h], eax

loc_4362E3:				; CODE XREF: .text:004362ABj
					; .text:004362B5j ...
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_436330
; ---------------------------------------------------------------------------

loc_4362EB:				; CODE XREF: .text:00436334j
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_436327
		mov	eax, [ebp-0Ch]
		mov	ebx, [eax+40h]
		mov	eax, [ebp-0Ch]
		mov	edx, [eax+50h]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+44h]
		lea	ecx, [ebp-1Ch]
		mov	[esp+10h], ecx
		mov	dword ptr [esp+0Ch], 0
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 6
		mov	[esp], eax
		call	ebx

loc_436327:				; CODE XREF: .text:004362F3j
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+50h]
		mov	[ebp-0Ch], eax

loc_436330:				; CODE XREF: .text:004362E9j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4362EB
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4360D1
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_436360
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	remove
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	gcry_free

loc_436360:				; CODE XREF: .text:00436348j
		mov	eax, [ebp-18h]
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2000h
		mov	dword ptr [esp], 3
		call	sub_436054
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	dword ptr [esp], 3
		call	sub_436054
		mov	[ebp-0Ch], eax
		mov	edx, [ebp+8]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+34h]
		mov	ecx, [ebp+0Ch]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp-0Ch]
		mov	edx, [ebp+0Ch]
		mov	[eax+30h], edx
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_451724, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4363DE(char *)
sub_4363DE	proc near		; CODE XREF: sub_436456+30p
					; sub_4364E9+5Cp ...

Str		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_451724
		test	eax, eax
		jz	short loc_43644F
		cmp	[ebp+arg_0], 0
		jz	short loc_43644F
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_43644F
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 26h
		jnz	short loc_43644F
		add	[ebp+arg_0], 2
		mov	[ebp+var_C], 0
		jmp	short loc_43641B
; ---------------------------------------------------------------------------

loc_436417:				; CODE XREF: sub_4363DE+55j
		add	[ebp+var_C], 1

loc_43641B:				; CODE XREF: sub_4363DE+37j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_436435
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_436417

loc_436435:				; CODE XREF: sub_4363DE+48j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43644F
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	atoi
		jmp	short locret_436454
; ---------------------------------------------------------------------------

loc_43644F:				; CODE XREF: sub_4363DE+Dj
					; sub_4363DE+13j ...
		mov	eax, 0FFFFFFFFh

locret_436454:				; CODE XREF: sub_4363DE+6Fj
		leave
		retn
sub_4363DE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_436456(char *)
sub_436456	proc near		; CODE XREF: .text:00425BC1p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_436479
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_436480
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_436480

loc_436479:				; CODE XREF: sub_436456+Aj
		mov	eax, 1
		jmp	short locret_436494
; ---------------------------------------------------------------------------

loc_436480:				; CODE XREF: sub_436456+14j
					; sub_436456+21j
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_4363DE
		cmp	eax, 0FFFFFFFFh
		setnz	al
		movzx	eax, al

locret_436494:				; CODE XREF: sub_436456+28j
		leave
		retn
sub_436456	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0FFFFFFFFh
		jnz	short loc_4364B2
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_4364E9
		mov	[ebp-0Ch], eax
		jmp	short loc_4364E4
; ---------------------------------------------------------------------------

loc_4364B2:				; CODE XREF: .text:004364A0j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	_dup
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_4364CF
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_4364E4
; ---------------------------------------------------------------------------

loc_4364CF:				; CODE XREF: .text:004364C4j
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_4366D0
		mov	[ebp-0Ch], eax

loc_4364E4:				; CODE XREF: .text:004364B0j
					; .text:004364CDj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4364E9(LPCSTR	lpFileName)
sub_4364E9	proc near		; CODE XREF: .text:00425BE0p
					; .text:004364A8p

nStdHandle	= dword	ptr -58h
Source		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
lpFileName	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	[ebp+var_20], 0
		mov	[ebp+var_10], 0
		cmp	[ebp+lpFileName], 0
		jz	short loc_43651B
		mov	eax, [ebp+lpFileName]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_43653F
		mov	eax, [ebp+lpFileName]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43653F

loc_43651B:				; CODE XREF: sub_4364E9+19j
		mov	[esp+58h+nStdHandle], 0FFFFFFF6h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+var_C], eax
		mov	[ebp+lpFileName], offset aStdin_1 ; "[stdin]"
		mov	[ebp+var_10], 1
		jmp	short loc_4365A1
; ---------------------------------------------------------------------------

loc_43653F:				; CODE XREF: sub_4364E9+23j
					; sub_4364E9+30j
		mov	eax, [ebp+lpFileName]
		mov	[esp+58h+nStdHandle], eax ; char *
		call	sub_4363DE
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0FFFFFFFFh
		jz	short loc_43657B
		mov	[esp+58h+Source], 0
		mov	eax, [ebp+var_14]
		mov	[esp+58h+nStdHandle], eax
		call	sub_438B16
		mov	[esp+58h+Source], offset aRb ; "rb"
		mov	[esp+58h+nStdHandle], eax ; int
		call	sub_4366D0
		jmp	loc_4366CB
; ---------------------------------------------------------------------------

loc_43657B:				; CODE XREF: sub_4364E9+68j
		mov	[esp+58h+Source], offset aRb ; "rb"
		mov	eax, [ebp+lpFileName]
		mov	[esp+58h+nStdHandle], eax ; lpFileName
		call	sub_434E4F
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_4365A1
		mov	eax, 0
		jmp	loc_4366CB
; ---------------------------------------------------------------------------

loc_4365A1:				; CODE XREF: sub_4364E9+54j
					; sub_4364E9+ACj
		mov	[esp+58h+Source], 2000h
		mov	[esp+58h+nStdHandle], 1
		call	sub_436054
		mov	[ebp+var_18], eax
		mov	eax, [ebp+lpFileName]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 18h
		mov	[esp+58h+nStdHandle], eax
		call	gcry_xmalloc
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+var_10]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_1C]
		lea	edx, [eax+14h]
		mov	eax, [ebp+lpFileName]
		mov	[esp+58h+Source], eax ;	Source
		mov	[esp+58h+nStdHandle], edx ; Dest
		call	strcpy
		cmp	[ebp+var_10], 0
		jnz	short loc_436624
		mov	eax, [ebp+lpFileName]
		mov	[esp+58h+nStdHandle], eax
		call	gcry_xstrdup
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+4Ch], edx

loc_436624:				; CODE XREF: sub_4364E9+126j
		mov	eax, [ebp+var_18]
		mov	dword ptr [eax+40h], offset sub_434F78
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_1C]
		mov	[eax+44h], edx
		mov	eax, [ebp+var_18]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_48], eax ;	int
		mov	[esp+58h+var_4C], edx ;	LPVOID
		mov	[esp+58h+var_50], 0 ; int
		mov	[esp+58h+Source], 5 ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+nStdHandle], eax ; int
		call	sub_434F78
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_48], eax ;	int
		mov	[esp+58h+var_4C], 0 ; LPVOID
		mov	[esp+58h+var_50], 0 ; int
		mov	[esp+58h+Source], 1 ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+nStdHandle], eax ; int
		call	sub_434F78
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_4366C8
		mov	eax, [ebp+var_1C]
		mov	eax, [eax]
		mov	ecx, eax
		mov	eax, [ebp+var_18]
		mov	edx, [eax+58h]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+54h]
		mov	[esp+58h+var_48], ecx
		mov	ecx, [ebp+lpFileName]
		mov	[esp+58h+var_4C], ecx
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+Source], eax ;	char
		mov	[esp+58h+nStdHandle], offset aIobufD_DOpenSF ; "iobuf-%d.%d: open `%s' fd=%d\n"
		call	sub_43CBBE

loc_4366C8:				; CODE XREF: sub_4364E9+1ABj
		mov	eax, [ebp+var_18]

loc_4366CB:				; CODE XREF: sub_4364E9+8Dj
					; sub_4364E9+B3j
		mov	edi, [ebp+var_4]
		leave
		retn
sub_4364E9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4366D0(int, char *)
sub_4366D0	proc near		; CODE XREF: .text:004364DCp
					; sub_4364E9+88p ...

Str		= dword	ptr -38h
Val		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[esp+38h+Val], 77h ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_4366FA
		mov	eax, 2
		jmp	short loc_4366FF
; ---------------------------------------------------------------------------

loc_4366FA:				; CODE XREF: sub_4366D0+21j
		mov	eax, 1

loc_4366FF:				; CODE XREF: sub_4366D0+28j
		mov	[esp+38h+Val], 2000h
		mov	[esp+38h+Str], eax
		call	sub_436054
		mov	[ebp+var_10], eax
		mov	[esp+38h+Str], 2Ch
		call	gcry_xmalloc
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+10h], 1
		mov	eax, offset aFdD ; "[fd	%d]"
		mov	edx, [ebp+var_14]
		lea	ecx, [edx+14h]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Val], eax ; Format
		mov	[esp+38h+Str], ecx ; Dest
		call	sprintf
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+40h], offset sub_434F78
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		mov	[eax+44h], edx
		mov	eax, [ebp+var_10]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_28], eax ;	int
		mov	[esp+38h+var_2C], edx ;	LPVOID
		mov	[esp+38h+var_30], 0 ; int
		mov	[esp+38h+Val], 5 ; int
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax ; int
		call	sub_434F78
		lea	eax, [ebp+var_18]
		mov	[esp+38h+var_28], eax ;	int
		mov	[esp+38h+var_2C], 0 ; LPVOID
		mov	[esp+38h+var_30], 0 ; int
		mov	[esp+38h+Val], 1 ; int
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax ; int
		call	sub_434F78
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_4367ED
		mov	eax, [ebp+var_14]
		lea	ecx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	edx, [eax+58h]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+54h]
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Val], eax ; char
		mov	[esp+38h+Str], offset aIobufD_DFdopen ;	"iobuf-%d.%d: fdopen `%s'\n"
		call	sub_43CBBE

loc_4367ED:				; CODE XREF: sub_4366D0+F1j
		mov	[esp+38h+var_2C], 0
		mov	[esp+38h+var_30], 1
		mov	[esp+38h+Val], 3
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax
		call	sub_436CA4
		mov	eax, [ebp+var_10]
		leave
		retn
sub_4366D0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	dword ptr [esp+4], 77h
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	strchr
		test	eax, eax
		jz	short loc_436839
		mov	eax, 2
		jmp	short loc_43683E
; ---------------------------------------------------------------------------

loc_436839:				; CODE XREF: .text:00436830j
		mov	eax, 1

loc_43683E:				; CODE XREF: .text:00436837j
		mov	dword ptr [esp+4], 2000h
		mov	[esp], eax
		call	sub_436054
		mov	[ebp-0Ch], eax
		mov	dword ptr [esp], 31h
		call	gcry_xmalloc
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	edx, [ebp+8]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	dword ptr [eax+10h], 1
		mov	eax, offset aSockD ; "[sock %d]"
		mov	edx, [ebp-10h]
		lea	ecx, [edx+14h]
		mov	edx, [ebp+8]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	[esp], ecx
		call	sprintf
		mov	eax, [ebp-0Ch]
		mov	dword ptr [eax+40h], offset sub_435224
		mov	eax, [ebp-0Ch]
		mov	edx, [ebp-10h]
		mov	[eax+44h], edx
		mov	eax, [ebp-0Ch]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp-14h]
		mov	[esp+10h], eax
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 5
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_435224
		lea	eax, [ebp-14h]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_435224
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_43692C
		mov	eax, [ebp-10h]
		lea	ecx, [eax+14h]
		mov	eax, [ebp-0Ch]
		mov	edx, [eax+58h]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+54h]
		mov	[esp+0Ch], ecx
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aIobufD_DSockop	; "iobuf-%d.%d:	sockopen `%s'\n"
		call	sub_43CBBE

loc_43692C:				; CODE XREF: .text:00436900j
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], 3
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_436CA4
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	dword ptr [ebp-10h], 0
		cmp	dword ptr [ebp+8], 0
		jz	short loc_43697F
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_4369A3
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4369A3

loc_43697F:				; CODE XREF: .text:00436966j
		mov	dword ptr [esp], 0FFFFFFF5h
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp+8], offset aStdout_1 ; "[stdout]"
		mov	dword ptr [ebp-10h], 1
		jmp	short loc_436A05
; ---------------------------------------------------------------------------

loc_4369A3:				; CODE XREF: .text:00436970j
					; .text:0043697Dj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4363DE
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0FFFFFFFFh
		jz	short loc_4369DF
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_438B16
		mov	dword ptr [esp+4], offset aWb ;	"wb"
		mov	[esp], eax
		call	sub_4366D0
		jmp	loc_436B38
; ---------------------------------------------------------------------------

loc_4369DF:				; CODE XREF: .text:004369B5j
		mov	dword ptr [esp+4], offset aWb ;	"wb"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_434BFF
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_436A05
		mov	eax, 0
		jmp	loc_436B38
; ---------------------------------------------------------------------------

loc_436A05:				; CODE XREF: .text:004369A1j
					; .text:004369F9j
		mov	dword ptr [esp+4], 2000h
		mov	dword ptr [esp], 2
		call	sub_436054
		mov	[ebp-18h], eax
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 18h
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-1Ch]
		mov	edx, [ebp-10h]
		mov	[eax+10h], edx
		mov	eax, [ebp-1Ch]
		lea	edx, [eax+14h]
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	[esp], edx
		call	strcpy
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_436A88
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	gcry_xstrdup
		mov	edx, eax
		mov	eax, [ebp-18h]
		mov	[eax+4Ch], edx

loc_436A88:				; CODE XREF: .text:00436A73j
		mov	eax, [ebp-18h]
		mov	dword ptr [eax+40h], offset sub_434F78
		mov	eax, [ebp-18h]
		mov	edx, [ebp-1Ch]
		mov	[eax+44h], edx
		mov	eax, [ebp-18h]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp-20h]
		mov	[esp+10h], eax
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 5
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_434F78
		lea	eax, [ebp-20h]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_434F78
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_436B35
		mov	eax, [ebp-18h]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_436B0C
		mov	eax, [ebp-18h]
		mov	eax, [eax+5Ch]
		jmp	short loc_436B11
; ---------------------------------------------------------------------------

loc_436B0C:				; CODE XREF: .text:00436B02j
		mov	eax, offset a?_1 ; "?"

loc_436B11:				; CODE XREF: .text:00436B0Aj
		mov	edx, [ebp-18h]
		mov	ecx, [edx+58h]
		mov	edx, [ebp-18h]
		mov	edx, [edx+54h]
		mov	[esp+0Ch], eax
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	dword ptr [esp], offset	aIobufD_DCreate	; "iobuf-%d.%d:	create `%s'\n"
		call	sub_43CBBE

loc_436B35:				; CODE XREF: .text:00436AF8j
		mov	eax, [ebp-18h]

loc_436B38:				; CODE XREF: .text:004369DAj
					; .text:00436A00j
		mov	edi, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_436B54
		mov	eax, 0
		jmp	loc_436C9E
; ---------------------------------------------------------------------------

loc_436B54:				; CODE XREF: .text:00436B48j
		mov	dword ptr [esp+4], offset aRB ;	"r+b"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_434BFF
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_436B7A
		mov	eax, 0
		jmp	loc_436C9E
; ---------------------------------------------------------------------------

loc_436B7A:				; CODE XREF: .text:00436B6Ej
		mov	dword ptr [esp+4], 2000h
		mov	dword ptr [esp], 2
		call	sub_436054
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 18h
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-14h]
		lea	edx, [eax+14h]
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	[esp], edx
		call	strcpy
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	gcry_xstrdup
		mov	edx, eax
		mov	eax, [ebp-10h]
		mov	[eax+4Ch], edx
		mov	eax, [ebp-10h]
		mov	dword ptr [eax+40h], offset sub_434F78
		mov	eax, [ebp-10h]
		mov	edx, [ebp-14h]
		mov	[eax+44h], edx
		mov	eax, [ebp-10h]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp-18h]
		mov	[esp+10h], eax
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 5
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_434F78
		lea	eax, [ebp-18h]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_434F78
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_436C9B
		mov	eax, [ebp-10h]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_436C72
		mov	eax, [ebp-10h]
		mov	eax, [eax+5Ch]
		jmp	short loc_436C77
; ---------------------------------------------------------------------------

loc_436C72:				; CODE XREF: .text:00436C68j
		mov	eax, offset a?_1 ; "?"

loc_436C77:				; CODE XREF: .text:00436C70j
		mov	edx, [ebp-10h]
		mov	ecx, [edx+58h]
		mov	edx, [ebp-10h]
		mov	edx, [edx+54h]
		mov	[esp+0Ch], eax
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	dword ptr [esp], offset	aIobufD_DOpenrw	; "iobuf-%d.%d:	openrw `%s'\n"
		call	sub_43CBBE

loc_436C9B:				; CODE XREF: .text:00436C5Ej
		mov	eax, [ebp-10h]

loc_436C9E:				; CODE XREF: .text:00436B4Fj
					; .text:00436B75j
		add	esp, 44h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_436CA4	proc near		; CODE XREF: sub_4366D0+13Bp
					; .text:0043694Ap

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		cmp	[ebp+arg_4], 1
		jnz	loc_436DA0
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	loc_436D95
		cmp	[ebp+arg_0], 0
		jz	short loc_436CDA
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_436CDA
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+5Ch]
		jmp	short loc_436CDF
; ---------------------------------------------------------------------------

loc_436CDA:				; CODE XREF: sub_436CA4+22j
					; sub_436CA4+2Cj
		mov	ecx, offset a?_1 ; "?"

loc_436CDF:				; CODE XREF: sub_436CA4+34j
		cmp	[ebp+arg_0], 0
		jz	short loc_436CED
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		jmp	short loc_436CF2
; ---------------------------------------------------------------------------

loc_436CED:				; CODE XREF: sub_436CA4+3Fj
		mov	edx, 0FFFFFFFFh

loc_436CF2:				; CODE XREF: sub_436CA4+47j
		cmp	[ebp+arg_0], 0
		jz	short loc_436D00
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		jmp	short loc_436D05
; ---------------------------------------------------------------------------

loc_436D00:				; CODE XREF: sub_436CA4+52j
		mov	eax, 0FFFFFFFFh

loc_436D05:				; CODE XREF: sub_436CA4+5Aj
		mov	ebx, [ebp+arg_8]
		mov	[esp+38h+var_28], ebx
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+var_30], edx
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aIobufD_DIoctlS ; "iobuf-%d.%d: ioctl `%s' keep=%d\n"
		call	sub_43CBBE
		jmp	short loc_436D95
; ---------------------------------------------------------------------------

loc_436D26:				; CODE XREF: sub_436CA4+F5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_436D59
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_434F78
		jnz	short loc_436D59
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	[eax+4], edx
		mov	eax, 0
		jmp	loc_436F52
; ---------------------------------------------------------------------------

loc_436D59:				; CODE XREF: sub_436CA4+8Aj
					; sub_436CA4+97j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_436D8C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_435224
		jnz	short loc_436D8C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	[eax+4], edx
		mov	eax, 0
		jmp	loc_436F52
; ---------------------------------------------------------------------------

loc_436D8C:				; CODE XREF: sub_436CA4+BDj
					; sub_436CA4+CAj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_436D95:				; CODE XREF: sub_436CA4+18j
					; sub_436CA4+80j
		cmp	[ebp+arg_0], 0
		jnz	short loc_436D26
		jmp	loc_436F4D
; ---------------------------------------------------------------------------

loc_436DA0:				; CODE XREF: sub_436CA4+Bj
		cmp	[ebp+arg_4], 2
		jnz	short loc_436E10
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_436DCF
		cmp	dword ptr [ebp+arg_C], 0
		jz	short loc_436DBA
		mov	eax, dword ptr [ebp+arg_C]
		jmp	short loc_436DBF
; ---------------------------------------------------------------------------

loc_436DBA:				; CODE XREF: sub_436CA4+10Fj
		mov	eax, offset a?_1 ; "?"

loc_436DBF:				; CODE XREF: sub_436CA4+114j
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aIobuf_IoctlSIn ; "iobuf-*.*: ioctl `%s' invalidate\n"
		call	sub_43CBBE

loc_436DCF:				; CODE XREF: sub_436CA4+109j
		cmp	[ebp+arg_0], 0
		jnz	loc_436F4D
		cmp	[ebp+arg_8], 0
		jnz	loc_436F4D
		cmp	dword ptr [ebp+arg_C], 0
		jz	loc_436F4D
		mov	eax, dword ptr [ebp+arg_C]
		mov	[esp+38h+var_38], eax
		call	sub_434B1A
		test	eax, eax
		jz	short loc_436E06
		mov	eax, 0FFFFFFFFh
		jmp	loc_436F52
; ---------------------------------------------------------------------------

loc_436E06:				; CODE XREF: sub_436CA4+156j
		mov	eax, 0
		jmp	loc_436F52
; ---------------------------------------------------------------------------

loc_436E10:				; CODE XREF: sub_436CA4+100j
		cmp	[ebp+arg_4], 3
		jnz	loc_436EFF
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	loc_436EF7
		cmp	[ebp+arg_0], 0
		jz	short loc_436E3F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_436E3F
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+5Ch]
		jmp	short loc_436E44
; ---------------------------------------------------------------------------

loc_436E3F:				; CODE XREF: sub_436CA4+187j
					; sub_436CA4+191j
		mov	ecx, offset a?_1 ; "?"

loc_436E44:				; CODE XREF: sub_436CA4+199j
		cmp	[ebp+arg_0], 0
		jz	short loc_436E52
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		jmp	short loc_436E57
; ---------------------------------------------------------------------------

loc_436E52:				; CODE XREF: sub_436CA4+1A4j
		mov	edx, 0FFFFFFFFh

loc_436E57:				; CODE XREF: sub_436CA4+1ACj
		cmp	[ebp+arg_0], 0
		jz	short loc_436E65
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		jmp	short loc_436E6A
; ---------------------------------------------------------------------------

loc_436E65:				; CODE XREF: sub_436CA4+1B7j
		mov	eax, 0FFFFFFFFh

loc_436E6A:				; CODE XREF: sub_436CA4+1BFj
		mov	ebx, [ebp+arg_8]
		mov	[esp+38h+var_28], ebx
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+var_30], edx
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aIobufD_DIoct_0 ; "iobuf-%d.%d: ioctl `%s' no_cache=%d\n"
		call	sub_43CBBE
		jmp	short loc_436EF7
; ---------------------------------------------------------------------------

loc_436E8B:				; CODE XREF: sub_436CA4+257j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_436EBE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_434F78
		jnz	short loc_436EBE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	[eax+8], edx
		mov	eax, 0
		jmp	loc_436F52
; ---------------------------------------------------------------------------

loc_436EBE:				; CODE XREF: sub_436CA4+1EFj
					; sub_436CA4+1FCj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_436EEE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_435224
		jnz	short loc_436EEE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+arg_8]
		mov	[eax+8], edx
		mov	eax, 0
		jmp	short loc_436F52
; ---------------------------------------------------------------------------

loc_436EEE:				; CODE XREF: sub_436CA4+222j
					; sub_436CA4+22Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_436EF7:				; CODE XREF: sub_436CA4+17Dj
					; sub_436CA4+1E5j
		cmp	[ebp+arg_0], 0
		jnz	short loc_436E8B
		jmp	short loc_436F4D
; ---------------------------------------------------------------------------

loc_436EFF:				; CODE XREF: sub_436CA4+170j
		cmp	[ebp+arg_4], 4
		jnz	short loc_436F4D
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_436F2E
		cmp	dword ptr [ebp+arg_C], 0
		jz	short loc_436F19
		mov	eax, dword ptr [ebp+arg_C]
		jmp	short loc_436F1E
; ---------------------------------------------------------------------------

loc_436F19:				; CODE XREF: sub_436CA4+26Ej
		mov	eax, offset aNull_1 ; "<null>"

loc_436F1E:				; CODE XREF: sub_436CA4+273j
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aIobuf_IoctlSFs ; "iobuf-*.*: ioctl `%s' fsync\n"
		call	sub_43CBBE

loc_436F2E:				; CODE XREF: sub_436CA4+268j
		cmp	[ebp+arg_0], 0
		jnz	short loc_436F4D
		cmp	[ebp+arg_8], 0
		jnz	short loc_436F4D
		cmp	dword ptr [ebp+arg_C], 0
		jz	short loc_436F4D
		mov	eax, dword ptr [ebp+arg_C]
		mov	[esp+38h+var_38], eax
		call	sub_434BED
		jmp	short loc_436F52
; ---------------------------------------------------------------------------

loc_436F4D:				; CODE XREF: sub_436CA4+F7j
					; sub_436CA4+12Fj ...
		mov	eax, 0FFFFFFFFh

loc_436F52:				; CODE XREF: sub_436CA4+B0j
					; sub_436CA4+E3j ...
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_436CA4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_436F58	proc near		; CODE XREF: .text:00438930p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_436F81
		leave
		retn
sub_436F58	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_436F81	proc near		; CODE XREF: sub_436F58+22p

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	[ebp+var_24], 0
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_436FBE
		mov	[esp+48h+var_40], offset aIobuf_push_fil ; "iobuf_push_filter2"
		mov	dword ptr [esp+48h+var_44], 653h
		mov	[esp+48h+var_48], offset a____Gnupg22_12 ; "../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_43CCB0
; ---------------------------------------------------------------------------

loc_436FBE:				; CODE XREF: sub_436F81+1Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_436FE4
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_437BF0
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_436FE4
		mov	eax, [ebp+var_1C]
		jmp	loc_4372B4
; ---------------------------------------------------------------------------

loc_436FE4:				; CODE XREF: sub_436F81+45j
					; sub_436F81+59j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+58h]
		cmp	eax, 3Fh
		jle	short loc_437005
		mov	[esp+48h+var_48], offset aIOFilterTooDee ; "i/o	filter too deeply nested - corrupte"...
		call	sub_43CB21
		mov	eax, 59h
		jmp	loc_4372B4
; ---------------------------------------------------------------------------

loc_437005:				; CODE XREF: sub_436F81+6Cj
		mov	[esp+48h+var_48], 68h
		call	gcry_xmalloc
		mov	[ebp+var_20], eax
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_20]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_437036
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_437036:				; CODE XREF: sub_436F81+A5j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_43704E
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_43704E:				; CODE XREF: sub_436F81+BCj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_437076
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_437076:				; CODE XREF: sub_436F81+E8j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_437084
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_437084:				; CODE XREF: sub_436F81+FAj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		test	eax, eax
		jz	short loc_43709E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+48h+var_48], eax
		call	gcry_xstrdup
		jmp	short loc_4370A3
; ---------------------------------------------------------------------------

loc_43709E:				; CODE XREF: sub_436F81+10Bj
		mov	eax, 0

loc_4370A3:				; CODE XREF: sub_436F81+11Bj
		mov	edx, [ebp+var_20]
		mov	[edx+4Ch], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+40h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+44h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+48h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+38h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 3
		jnz	short loc_4370E4
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 2

loc_4370E4:				; CODE XREF: sub_436F81+158j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_43711A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[esp+48h+var_48], eax
		call	gcry_xmalloc
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[eax+34h], edx
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+2Ch], 0
		jmp	short loc_437144
; ---------------------------------------------------------------------------

loc_43711A:				; CODE XREF: sub_436F81+16Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[esp+48h+var_48], eax
		call	gcry_xmalloc
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+34h], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0

loc_437144:				; CODE XREF: sub_436F81+197j
		mov	eax, [ebp+var_20]
		mov	ecx, [eax+18h]
		mov	ebx, [eax+1Ch]
		mov	eax, [ebp+var_20]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+arg_0]
		mov	[ecx+18h], eax
		mov	[ecx+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		mov	ecx, [ebp+arg_0]
		mov	[ecx+8], eax
		mov	[ecx+0Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	edx, eax
		and	edx, 0FFFFFFFEh
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_20]
		mov	[eax+50h], edx
		mov	eax, [ebp+var_20]
		mov	edx, [eax+60h]
		mov	eax, [ebp+arg_0]
		mov	[eax+60h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_4]
		mov	[eax+40h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[eax+44h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_C]
		mov	[eax+48h], edx
		mov	eax, [ebp+var_20]
		mov	eax, [eax+58h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+58h], edx
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+5Ch]
		lea	eax, [ebp+var_24]
		mov	[esp+48h+var_38], eax
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+var_40], 0
		mov	dword ptr [esp+48h+var_44], 5
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+var_48], eax
		mov	eax, [ebp+arg_4]
		call	eax
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_437251
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_43721D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		jmp	short loc_437222
; ---------------------------------------------------------------------------

loc_43721D:				; CODE XREF: sub_436F81+292j
		mov	eax, offset a?_1 ; "?"

loc_437222:				; CODE XREF: sub_436F81+29Aj
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], ecx
		mov	dword ptr [esp+48h+var_44], edx	; char
		mov	[esp+48h+var_48], offset aIobufD_DPushS	; "iobuf-%d.%d:	push `%s'\n"
		call	sub_43CBBE
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax
		call	sub_435F68

loc_437251:				; CODE XREF: sub_436F81+288j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_4372B1
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ecx, [ebp+var_24]
		mov	[esp+48h+var_38], ecx
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], edx
		mov	dword ptr [esp+48h+var_44], 1
		mov	[esp+48h+var_48], eax
		call	ebx
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_4372B1
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aIobufctrl_init ; "IOBUFCTRL_INIT failed: %s\n"
		call	sub_43CB21

loc_4372B1:				; CODE XREF: sub_436F81+2D8j
					; sub_436F81+313j
		mov	eax, [ebp+var_1C]

loc_4372B4:				; CODE XREF: sub_436F81+5Ej
					; sub_436F81+7Fj
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_436F81	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4372BC	proc near		; CODE XREF: .text:0043826Bp
					; .text:004382FBp ...

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 3Ch
		mov	[ebp+var_24], 0
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_4372F9
		mov	[esp+48h+var_40], offset aPop_filter ; "pop_filter"
		mov	[esp+48h+var_44], 6AAh
		mov	[esp+48h+var_48], offset a____Gnupg22_12 ; "../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_43CCB0
; ---------------------------------------------------------------------------

loc_4372F9:				; CODE XREF: sub_4372BC+1Fj
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_43733D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_437314
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		jmp	short loc_437319
; ---------------------------------------------------------------------------

loc_437314:				; CODE XREF: sub_4372BC+4Ej
		mov	eax, offset a?_1 ; "?"

loc_437319:				; CODE XREF: sub_4372BC+56j
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+48h+var_3C], eax
		mov	[esp+48h+var_40], ecx
		mov	[esp+48h+var_44], edx ;	char
		mov	[esp+48h+var_48], offset aIobufD_DPopS ; "iobuf-%d.%d: pop `%s'\n"
		call	sub_43CBBE

loc_43733D:				; CODE XREF: sub_4372BC+44j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jnz	loc_437417
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_437376
		mov	[esp+48h+var_40], 6B2h ; int
		mov	[esp+48h+var_44], offset a____Gnupg22_12 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+48h+var_48], offset aB ; "b"
		call	sub_442650

loc_437376:				; CODE XREF: sub_4372BC+9Cj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_4373B4
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_4373B4:				; CODE XREF: sub_4372BC+E8j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_4373CC
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_4373CC:				; CODE XREF: sub_4372BC+FFj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_4373F4
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_4373F4:				; CODE XREF: sub_4372BC+12Bj
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_437402
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_437402:				; CODE XREF: sub_4372BC+13Dj
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_43764B
; ---------------------------------------------------------------------------

loc_437417:				; CODE XREF: sub_4372BC+89j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], eax
		jmp	short loc_437444
; ---------------------------------------------------------------------------

loc_43741F:				; CODE XREF: sub_4372BC+18Cj
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+40h]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_43743B
		cmp	[ebp+arg_8], 0
		jz	short loc_43744A
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+44h]
		cmp	eax, [ebp+arg_8]
		jz	short loc_43744A

loc_43743B:				; CODE XREF: sub_4372BC+16Cj
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+50h]
		mov	[ebp+var_1C], eax

loc_437444:				; CODE XREF: sub_4372BC+161j
		cmp	[ebp+var_1C], 0
		jnz	short loc_43741F

loc_43744A:				; CODE XREF: sub_4372BC+172j
					; sub_4372BC+17Dj
		cmp	[ebp+var_1C], 0
		jnz	short loc_43745C
		mov	[esp+48h+var_48], offset aPop_filterFilt ; "pop_filter(): filter function not found"...
		call	sub_43CB91
; ---------------------------------------------------------------------------

loc_43745C:				; CODE XREF: sub_4372BC+192j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jnz	short loc_43749D
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	sub_437BF0
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_43749D
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aIobuf_flushF_0 ; "iobuf_flush	failed in pop_filter: %s\n"
		call	sub_43CB21
		mov	eax, [ebp+var_20]
		jmp	loc_43764B
; ---------------------------------------------------------------------------

loc_43749D:				; CODE XREF: sub_4372BC+1A8j
					; sub_4372BC+1BCj
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	short loc_437505
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax+40h]
		mov	eax, [ebp+var_1C]
		mov	edx, [eax+50h]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+44h]
		lea	ecx, [ebp+var_24]
		mov	[esp+48h+var_38], ecx
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], 2
		mov	[esp+48h+var_48], eax
		call	ebx
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_437505
		mov	eax, [ebp+var_20]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aIobufctrl_fr_0 ; "IOBUFCTRL_FREE failed: %s\n"
		call	sub_43CB21
		mov	eax, [ebp+var_20]
		jmp	loc_43764B
; ---------------------------------------------------------------------------

loc_437505:				; CODE XREF: sub_4372BC+1E9j
					; sub_4372BC+224j
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+44h]
		test	eax, eax
		jz	short loc_437531
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+48h]
		test	eax, eax
		jz	short loc_437531
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+44h]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+var_1C]
		mov	dword ptr [eax+44h], 0

loc_437531:				; CODE XREF: sub_4372BC+251j
					; sub_4372BC+25Bj
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+var_1C]
		jnz	short loc_43754F
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_43754F
		mov	[esp+48h+var_48], offset aCanTRemoveTheL ; "can't remove the last filter from the c"...
		call	sub_43CB91
; ---------------------------------------------------------------------------

loc_43754F:				; CODE XREF: sub_4372BC+27Bj
					; sub_4372BC+285j
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+var_1C]
		jnz	loc_437626
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_4375A2
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_4375A2:				; CODE XREF: sub_4372BC+2D6j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_4375BA
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_4375BA:				; CODE XREF: sub_4372BC+2EDj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_4375E2
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_4375E2:				; CODE XREF: sub_4372BC+319j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_4375F0
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_4375F0:				; CODE XREF: sub_4372BC+32Bj
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+var_48], eax
		call	gcry_free
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_437648
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+48h+var_40], edx
		mov	[esp+48h+var_44], eax ;	char
		mov	[esp+48h+var_48], offset aIobufD_DPopped ; "iobuf-%d.%d: popped	filter\n"
		call	sub_43CBBE
		jmp	short loc_437648
; ---------------------------------------------------------------------------

loc_437626:				; CODE XREF: sub_4372BC+299j
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_43763C
		mov	[esp+48h+var_48], offset aOhhJeeeTryingT ; "Ohh	jeee, trying to	remove a head filte"...
		call	sub_43CB91
; ---------------------------------------------------------------------------

loc_43763C:				; CODE XREF: sub_4372BC+372j
		mov	[esp+48h+var_48], offset aOhhJeeeTryin_0 ; "Ohh	jeee, trying to	remove an intermedi"...
		call	sub_43CB91
; ---------------------------------------------------------------------------

loc_437648:				; CODE XREF: sub_4372BC+346j
					; sub_4372BC+368j
		mov	eax, [ebp+var_20]

loc_43764B:				; CODE XREF: sub_4372BC+156j
					; sub_4372BC+1DCj ...
		add	esp, 3Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4372BC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_437653	proc near		; CODE XREF: sub_437D5E+73p
					; sub_437E07+136p ...

DstBuf		= dword	ptr -58h
ElementSize	= dword	ptr -54h
Count		= dword	ptr -50h
File		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jz	short loc_437688
		mov	[esp+58h+Count], 6FAh ;	int
		mov	[esp+58h+ElementSize], offset a____Gnupg22_12 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+58h+DstBuf], offset aAD_startAD_len ; "a->d.start == a->d.len"
		call	sub_442650

loc_437688:				; CODE XREF: sub_437653+17j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 3
		jnz	short loc_43769C
		mov	eax, 0FFFFFFFFh
		jmp	loc_437BE8
; ---------------------------------------------------------------------------

loc_43769C:				; CODE XREF: sub_437653+3Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+38h]
		test	eax, eax
		jz	loc_4377E6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jz	loc_4377A9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_1C], eax
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_437705
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		test	eax, eax
		jz	short loc_4376DC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+5Ch]
		jmp	short loc_4376E1
; ---------------------------------------------------------------------------

loc_4376DC:				; CODE XREF: sub_437653+7Fj
		mov	eax, offset a?_1 ; "?"

loc_4376E1:				; CODE XREF: sub_437653+87j
		mov	edx, [ebp+arg_0]
		mov	ecx, [edx+58h]
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+54h]
		mov	[esp+58h+File],	eax
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+ElementSize], edx ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DPopSIn ; "iobuf-%d.%d: pop `%s' in underflow\n"
		call	sub_43CBBE

loc_437705:				; CODE XREF: sub_437653+75j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+58h+DstBuf], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+58h+DstBuf], eax
		call	gcry_free
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_0]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_437743
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_437743:				; CODE XREF: sub_437653+E0j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_43775B
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_43775B:				; CODE XREF: sub_437653+F7j
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_437783
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_437783:				; CODE XREF: sub_437653+123j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_437791
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_437791:				; CODE XREF: sub_437653+135j
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+DstBuf], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+DstBuf], eax
		call	sub_435F68
		jmp	short loc_4377B3
; ---------------------------------------------------------------------------

loc_4377A9:				; CODE XREF: sub_437653+5Fj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+38h], 0

loc_4377B3:				; CODE XREF: sub_437653+154j
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_4377DC
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnderf ; "iobuf-%d.%d: underflow: eof	(due to	fil"...
		call	sub_43CBBE

loc_4377DC:				; CODE XREF: sub_437653+167j
		mov	eax, 0FFFFFFFFh
		jmp	loc_437BE8
; ---------------------------------------------------------------------------

loc_4377E6:				; CODE XREF: sub_437653+51j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+3Ch]
		test	eax, eax
		jz	short loc_437823
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_437819
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DError	; "iobuf-%d.%d:	error\n"
		call	sub_43CBBE

loc_437819:				; CODE XREF: sub_437653+1A4j
		mov	eax, 0FFFFFFFFh
		jmp	loc_437BE8
; ---------------------------------------------------------------------------

loc_437823:				; CODE XREF: sub_437653+19Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_4378D1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+28h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	ecx, [ebp+var_20]
		mov	[esp+58h+File],	ecx ; File
		mov	[esp+58h+Count], edx ; Count
		mov	[esp+58h+ElementSize], 1 ; ElementSize
		mov	[esp+58h+DstBuf], eax ;	DstBuf
		call	fread
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+28h]
		mov	eax, [ebp+var_2C]
		cmp	edx, eax
		jbe	short loc_43788D
		mov	eax, [ebp+var_20]
		mov	[esp+58h+DstBuf], eax ;	File
		call	ferror
		test	eax, eax
		jz	short loc_43788D
		call	sub_434A05
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax+3Ch], edx

loc_43788D:				; CODE XREF: sub_437653+21Cj
					; sub_437653+22Bj
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+arg_0]
		mov	[eax+30h], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jz	short loc_4378C7
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_0]
		mov	[edx+2Ch], ecx
		jmp	short loc_4378CC
; ---------------------------------------------------------------------------

loc_4378C7:				; CODE XREF: sub_437653+252j
		mov	eax, 0FFFFFFFFh

loc_4378CC:				; CODE XREF: sub_437653+272j
		jmp	loc_437BE8
; ---------------------------------------------------------------------------

loc_4378D1:				; CODE XREF: sub_437653+1D8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jz	loc_437BBA
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	[ebp+var_2C], eax
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_437918
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+File],	ecx
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnde_0 ; "iobuf-%d.%d: underflow: req=%lu\n"
		call	sub_43CBBE

loc_437918:				; CODE XREF: sub_437653+29Cj
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ebx, [ebp+var_2C]
		mov	[esp+58h+var_48], ebx
		mov	[esp+58h+File],	ecx
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], 3
		mov	[esp+58h+DstBuf], eax
		call	esi
		mov	[ebp+var_24], eax
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_437986
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	ebx, [ebp+var_24]
		mov	[esp+58h+var_48], ebx
		mov	[esp+58h+File],	ecx
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnde_1 ; "iobuf-%d.%d: underflow: got=%lu rc=%d\n"
		call	sub_43CBBE

loc_437986:				; CODE XREF: sub_437653+303j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 1
		jnz	loc_437B3E
		cmp	[ebp+var_24], 0FFFFFFFFh
		jnz	loc_437B3E
		mov	[ebp+var_30], 0
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ecx, [ebp+var_30]
		mov	[esp+58h+var_48], ecx
		mov	[esp+58h+File],	0
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], 2
		mov	[esp+58h+DstBuf], eax
		call	ebx
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_4379FB
		mov	eax, [ebp+var_24]
		mov	[esp+58h+DstBuf], eax
		call	gpg_strerror
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufctrl_fr_0 ; "IOBUFCTRL_FREE failed: %s\n"
		call	sub_43CB21

loc_4379FB:				; CODE XREF: sub_437653+38Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		test	eax, eax
		jz	short loc_437A27
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+48h]
		test	eax, eax
		jz	short loc_437A27
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[esp+58h+DstBuf], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+44h], 0

loc_437A27:				; CODE XREF: sub_437653+3B0j
					; sub_437653+3BAj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+40h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+5Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+44h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+38h], 1
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jnz	loc_437B4F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jz	loc_437B4F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+var_28], eax
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_437A9A
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DPopInU ; "iobuf-%d.%d: pop in	underflow (!len)\n"
		call	sub_43CBBE

loc_437A9A:				; CODE XREF: sub_437653+425j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+58h+DstBuf], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		mov	[esp+58h+DstBuf], eax
		call	gcry_free
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+arg_0]
		mov	ebx, 68h
		mov	ecx, eax
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_437AD8
		movzx	ecx, byte ptr [edx]
		mov	[eax], cl
		add	eax, 1
		add	edx, 1
		sub	ebx, 1

loc_437AD8:				; CODE XREF: sub_437653+475j
		mov	ecx, eax
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_437AF0
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		add	eax, 2
		add	edx, 2
		sub	ebx, 2

loc_437AF0:				; CODE XREF: sub_437653+48Cj
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, eax
		mov	esi, edx
		rep movsd
		mov	edx, esi
		mov	eax, edi
		mov	ecx, 0
		mov	esi, ebx
		and	esi, 2
		test	esi, esi
		jz	short loc_437B18
		movzx	esi, word ptr [edx+ecx]
		mov	[eax+ecx], si
		add	ecx, 2

loc_437B18:				; CODE XREF: sub_437653+4B8j
		and	ebx, 1
		test	ebx, ebx
		jz	short loc_437B26
		movzx	edx, byte ptr [edx+ecx]
		mov	[eax+ecx], dl

loc_437B26:				; CODE XREF: sub_437653+4CAj
		mov	eax, [ebp+var_28]
		mov	[esp+58h+DstBuf], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+DstBuf], eax
		call	sub_435F68
		jmp	short loc_437B4F
; ---------------------------------------------------------------------------

loc_437B3E:				; CODE XREF: sub_437653+33Bj
					; sub_437653+345j
		cmp	[ebp+var_24], 0
		jz	short loc_437B50
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_24]
		mov	[eax+3Ch], edx
		jmp	short loc_437B50
; ---------------------------------------------------------------------------

loc_437B4F:				; CODE XREF: sub_437653+401j
					; sub_437653+40Fj ...
		nop

loc_437B50:				; CODE XREF: sub_437653+4EFj
					; sub_437653+4FAj
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jnz	short loc_437B87
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_437B80
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnde_2 ; "iobuf-%d.%d: underflow: eof\n"
		call	sub_43CBBE

loc_437B80:				; CODE XREF: sub_437653+50Bj
		mov	eax, 0FFFFFFFFh
		jmp	short loc_437BE8
; ---------------------------------------------------------------------------

loc_437B87:				; CODE XREF: sub_437653+502j
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+arg_0]
		mov	[eax+30h], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_0]
		mov	[edx+2Ch], ecx
		jmp	short loc_437BE8
; ---------------------------------------------------------------------------

loc_437BBA:				; CODE XREF: sub_437653+286j
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_437BE3
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+58h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+54h]
		mov	[esp+58h+Count], edx
		mov	[esp+58h+ElementSize], eax ; char
		mov	[esp+58h+DstBuf], offset aIobufD_DUnde_3 ; "iobuf-%d.%d: underflow: eof	(no filter)"...
		call	sub_43CBBE

loc_437BE3:				; CODE XREF: sub_437653+56Ej
		mov	eax, 0FFFFFFFFh

loc_437BE8:				; CODE XREF: sub_437653+44j
					; sub_437653+18Ej ...
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_437653	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_437BF0	proc near		; CODE XREF: sub_4360D1+8Bp
					; sub_436F81+4Dp ...

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 30h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_437C0C
		mov	eax, 0
		jmp	loc_437D57
; ---------------------------------------------------------------------------

loc_437C0C:				; CODE XREF: sub_437BF0+10j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 3
		jnz	loc_437CA7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		add	eax, 2000h
		mov	[ebp+var_10], eax
		mov	eax, ds:dword_451D90
		test	eax, eax
		jz	short loc_437C4E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Src], eax ; char
		mov	[esp+38h+Dst], offset aIncreasingTemp ;	"increasing temp iobuf from %lu	to %lu\n"
		call	sub_43CBBE

loc_437C4E:				; CODE XREF: sub_437BF0+3Fj
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax
		call	gcry_xmalloc
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[esp+38h+Dst], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		mov	[eax+34h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+28h], edx
		mov	eax, 0
		jmp	loc_437D57
; ---------------------------------------------------------------------------

loc_437CA7:				; CODE XREF: sub_437BF0+24j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 2
		jz	short loc_437CBD
		mov	[esp+38h+Dst], offset aFlushOnNonOutp ;	"flush on non-output iobuf\n"
		call	sub_43CB91
; ---------------------------------------------------------------------------

loc_437CBD:				; CODE XREF: sub_437BF0+BFj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		test	eax, eax
		jnz	short loc_437CD3
		mov	[esp+38h+Dst], offset aIobuf_flushNoF ;	"iobuf_flush: no filter\n"
		call	sub_43CB91
; ---------------------------------------------------------------------------

loc_437CD3:				; CODE XREF: sub_437BF0+D5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+40h]
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+50h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		lea	ebx, [ebp+var_18]
		mov	[esp+38h+var_28], ebx
		mov	[esp+38h+var_2C], ecx
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Src], 4 ; char
		mov	[esp+38h+Dst], eax
		call	esi
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_437D3B
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+var_18]
		cmp	edx, eax
		jz	short loc_437D3B
		mov	[esp+38h+Dst], offset aIobuf_flushDid ;	"iobuf_flush did not write all!\n"
		call	sub_43CAF7
		mov	[ebp+var_C], 3Fh
		jmp	short loc_437D4A
; ---------------------------------------------------------------------------

loc_437D3B:				; CODE XREF: sub_437BF0+127j
					; sub_437BF0+134j
		cmp	[ebp+var_C], 0
		jz	short loc_437D4A
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+3Ch], edx

loc_437D4A:				; CODE XREF: sub_437BF0+149j
					; sub_437BF0+14Fj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+var_C]

loc_437D57:				; CODE XREF: sub_437BF0+17j
					; sub_437BF0+B2j
		add	esp, 30h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_437BF0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_437D5E	proc near		; CODE XREF: sub_43542D+FBp
					; sub_43542D+1E3p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [eax+8]
		or	eax, edx
		test	eax, eax
		jz	short loc_437D99
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [eax+8]
		cmp	ebx, edx
		jl	short loc_437D99
		cmp	ebx, edx
		jg	short loc_437D92
		cmp	ecx, eax
		jb	short loc_437D99

loc_437D92:				; CODE XREF: sub_437D5E+2Ej
		mov	eax, 0FFFFFFFFh
		jmp	short loc_437E01
; ---------------------------------------------------------------------------

loc_437D99:				; CODE XREF: sub_437D5E+14j
					; sub_437D5E+2Aj ...
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jnb	short loc_437DCB
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		add	edx, eax
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		mov	[ebp+var_C], edx
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+2Ch], edx
		jmp	short loc_437DE6
; ---------------------------------------------------------------------------

loc_437DCB:				; CODE XREF: sub_437D5E+49j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_437653
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_437DE6
		mov	eax, 0FFFFFFFFh
		jmp	short loc_437E01
; ---------------------------------------------------------------------------

loc_437DE6:				; CODE XREF: sub_437D5E+6Bj
					; sub_437D5E+7Fj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+arg_0]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+var_C]

loc_437E01:				; CODE XREF: sub_437D5E+39j
					; sub_437D5E+86j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_437D5E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_437E07	proc near		; CODE XREF: .text:00425C4Ap
					; sub_43542D+514p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [eax+8]
		or	eax, edx
		test	eax, eax
		jz	short loc_437E81
		mov	[ebp+var_10], 0
		jmp	short loc_437E6E
; ---------------------------------------------------------------------------

loc_437E2C:				; CODE XREF: sub_437E07+6Dj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_437D5E
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_437E50
		cmp	[ebp+var_10], 0
		jnz	short loc_437E78
		mov	eax, 0FFFFFFFFh
		jmp	loc_437FC0
; ---------------------------------------------------------------------------

loc_437E50:				; CODE XREF: sub_437E07+37j
		cmp	[ebp+var_C], 0
		jz	short loc_437E60
		mov	eax, [ebp+var_18]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], dl

loc_437E60:				; CODE XREF: sub_437E07+4Dj
		cmp	[ebp+var_C], 0
		jz	short loc_437E6A
		add	[ebp+var_C], 1

loc_437E6A:				; CODE XREF: sub_437E07+5Dj
		add	[ebp+var_10], 1

loc_437E6E:				; CODE XREF: sub_437E07+23j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jb	short loc_437E2C
		jmp	short loc_437E79
; ---------------------------------------------------------------------------

loc_437E78:				; CODE XREF: sub_437E07+3Dj
		nop

loc_437E79:				; CODE XREF: sub_437E07+6Fj
		mov	eax, [ebp+var_10]
		jmp	loc_437FC0
; ---------------------------------------------------------------------------

loc_437E81:				; CODE XREF: sub_437E07+1Aj
		mov	[ebp+var_10], 0

loc_437E88:				; CODE XREF: sub_437E07+192j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jnb	loc_437F2F
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jnb	loc_437F2F
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+var_14]
		jnb	short loc_437EDD
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax

loc_437EDD:				; CODE XREF: sub_437E07+C5j
		cmp	[ebp+var_C], 0
		jz	short loc_437F09
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		add	edx, eax
		mov	eax, [ebp+var_C]
		mov	ecx, [ebp+var_14]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy

loc_437F09:				; CODE XREF: sub_437E07+DAj
		mov	eax, [ebp+var_10]
		add	eax, [ebp+var_14]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+2Ch]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	[eax+2Ch], edx
		cmp	[ebp+var_C], 0
		jz	short loc_437F2F
		mov	eax, [ebp+var_14]
		add	[ebp+var_C], eax

loc_437F2F:				; CODE XREF: sub_437E07+87j
					; sub_437E07+9Bj ...
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jnb	short loc_437F93
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_437653
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_437F7B
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	edx, eax
		sar	edx, 1Fh
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+arg_0]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		cmp	[ebp+var_10], 0
		jz	short loc_437F74
		mov	eax, [ebp+var_10]
		jmp	short loc_437F79
; ---------------------------------------------------------------------------

loc_437F74:				; CODE XREF: sub_437E07+166j
		mov	eax, 0FFFFFFFFh

loc_437F79:				; CODE XREF: sub_437E07+16Bj
		jmp	short loc_437FC0
; ---------------------------------------------------------------------------

loc_437F7B:				; CODE XREF: sub_437E07+142j
		cmp	[ebp+var_C], 0
		jz	short loc_437F8F
		mov	eax, [ebp+var_18]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_437F8F:				; CODE XREF: sub_437E07+178j
		add	[ebp+var_10], 1

loc_437F93:				; CODE XREF: sub_437E07+12Ej
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jb	loc_437E88
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	edx, eax
		sar	edx, 1Fh
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+arg_0]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+var_10]

loc_437FC0:				; CODE XREF: sub_437E07+44j
					; sub_437E07+75j ...
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_437E07	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax+38h]
		test	eax, eax
		jz	short loc_437FE7
		mov	eax, 0FFFFFFFFh
		jmp	locret_438083
; ---------------------------------------------------------------------------

loc_437FE7:				; CODE XREF: .text:00437FDBj
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_43803F
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_437653
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_43800E
		mov	eax, 0FFFFFFFFh
		jmp	short locret_438083
; ---------------------------------------------------------------------------

loc_43800E:				; CODE XREF: .text:00438005j
		mov	eax, [ebp+8]
		mov	eax, [eax+2Ch]
		cmp	eax, 1
		jz	short loc_438035
		mov	dword ptr [esp+8], 7FCh
		mov	dword ptr [esp+4], offset a____Gnupg22_12 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	dword ptr [esp], offset	aAD_start1 ; "a->d.start == 1"
		call	sub_442650

loc_438035:				; CODE XREF: .text:00438017j
		mov	eax, [ebp+8]
		mov	dword ptr [eax+2Ch], 0

loc_43803F:				; CODE XREF: .text:00437FF5j
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_438063
; ---------------------------------------------------------------------------

loc_438048:				; CODE XREF: .text:0043807Ej
		mov	eax, [ebp+8]
		mov	edx, [eax+34h]
		mov	eax, [ebp-0Ch]
		add	eax, edx
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp+0Ch], 1

loc_438063:				; CODE XREF: .text:00438046j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jnb	short loc_438080
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp-0Ch]
		add	edx, eax
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_438048

loc_438080:				; CODE XREF: .text:00438069j
		mov	eax, [ebp-0Ch]

locret_438083:				; CODE XREF: .text:00437FE2j
					; .text:0043800Cj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_438085	proc near		; CODE XREF: sub_43542D+6E3p
					; sub_43542D+95Bp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_4380B1
		mov	[esp+28h+var_20], offset aIobuf_writebyt ; "iobuf_writebyte"
		mov	[esp+28h+var_24], 80Eh
		mov	[esp+28h+var_28], offset a____Gnupg22_12 ; "../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_43CCB0
; ---------------------------------------------------------------------------

loc_4380B1:				; CODE XREF: sub_438085+Ej
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		cmp	edx, eax
		jnz	short loc_4380DA
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_437BF0
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4380DA
		mov	eax, [ebp+var_C]
		jmp	short locret_438128
; ---------------------------------------------------------------------------

loc_4380DA:				; CODE XREF: sub_438085+3Aj
					; sub_438085+4Ej
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		cmp	edx, eax
		jb	short loc_438106
		mov	[esp+28h+var_20], 814h ; int
		mov	[esp+28h+var_24], offset a____Gnupg22_12 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	[esp+28h+var_28], offset aAD_lenAD_size	; "a->d.len < a->d.size"
		call	sub_442650

loc_438106:				; CODE XREF: sub_438085+63j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+34h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+arg_4]
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+30h], edx
		mov	eax, 0

locret_438128:				; CODE XREF: sub_438085+53j
		leave
		retn
sub_438085	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43812A	proc near		; CODE XREF: sub_43542D+733p
					; sub_43542D+782p ...

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_43815C
		mov	[esp+28h+Size],	offset aIobuf_write ; "iobuf_write"
		mov	[esp+28h+Src], 821h
		mov	[esp+28h+Dst], offset a____Gnupg22_12 ;	"../../gnupg2-2.0.30/common/iobuf.c"
		call	sub_43CCB0
; ---------------------------------------------------------------------------

loc_43815C:				; CODE XREF: sub_43812A+14j
					; sub_43812A+D1j
		cmp	[ebp+arg_8], 0
		jz	short loc_4381D8
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+30h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		cmp	edx, eax
		jnb	short loc_4381D8
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+28h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jbe	short loc_438195
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax

loc_438195:				; CODE XREF: sub_43812A+63j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	ecx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		add	eax, ecx
		mov	ecx, [ebp+var_10]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_10]
		sub	[ebp+arg_8], eax
		mov	eax, [ebp+var_10]
		add	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+30h]
		mov	edx, eax
		add	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax+30h], edx

loc_4381D8:				; CODE XREF: sub_43812A+36j
					; sub_43812A+46j
		cmp	[ebp+arg_8], 0
		jz	short loc_4381F7
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_437BF0
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_4381F7
		mov	eax, [ebp+var_14]
		jmp	short locret_438206
; ---------------------------------------------------------------------------

loc_4381F7:				; CODE XREF: sub_43812A+B2j
					; sub_43812A+C6j
		cmp	[ebp+arg_8], 0
		jnz	loc_43815C
		mov	eax, 0

locret_438206:				; CODE XREF: sub_43812A+CBj
		leave
		retn
sub_43812A	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		jmp	short loc_43823A
; ---------------------------------------------------------------------------

loc_438210:				; CODE XREF: .text:00438242j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_438085
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_438236
		mov	eax, [ebp-0Ch]
		jmp	short locret_438249
; ---------------------------------------------------------------------------

loc_438236:				; CODE XREF: .text:0043822Fj
		add	dword ptr [ebp+0Ch], 1

loc_43823A:				; CODE XREF: .text:0043820Ej
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_438210
		mov	eax, 0

locret_438249:				; CODE XREF: .text:00438234j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		jmp	short loc_438270
; ---------------------------------------------------------------------------

loc_438253:				; CODE XREF: .text:00438278j
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+40h]
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_4372BC

loc_438270:				; CODE XREF: .text:00438251j
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_438253
		mov	eax, [ebp+0Ch]
		mov	edx, [eax+30h]
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+34h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_43812A
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jbe	short loc_4382B8
		mov	eax, [ebp+10h]
		mov	[ebp-0Ch], eax

loc_4382B8:				; CODE XREF: .text:004382B0j
		mov	eax, [ebp+8]
		mov	eax, [eax+34h]
		mov	edx, eax
		mov	eax, [ebp+0Ch]
		mov	ecx, [ebp-0Ch]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		jmp	short loc_438300
; ---------------------------------------------------------------------------

loc_4382E3:				; CODE XREF: .text:00438308j
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4372BC

loc_438300:				; CODE XREF: .text:004382E1j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_4382E3
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0Ch
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		mov	eax, [ebp+10h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-10h]
		mov	edx, [ebp-0Ch]
		or	eax, edx
		test	eax, eax
		jz	short loc_43833E
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		mov	edx, eax
		or	edx, 1
		mov	eax, [ebp+8]
		mov	[eax+20h], edx
		jmp	short loc_43834F
; ---------------------------------------------------------------------------

loc_43833E:				; CODE XREF: .text:00438329j
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		mov	edx, eax
		and	edx, 0FFFFFFFEh
		mov	eax, [ebp+8]
		mov	[eax+20h], edx

loc_43834F:				; CODE XREF: .text:0043833Cj
		mov	ecx, [ebp+8]
		mov	eax, [ebp-10h]
		mov	edx, [ebp-0Ch]
		mov	[ecx+8], eax
		mov	[ecx+0Ch], edx
		mov	eax, [ebp+8]
		mov	ecx, [eax+18h]
		mov	ebx, [eax+1Ch]
		mov	eax, [ebp+8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+8]
		mov	[ecx+18h], eax
		mov	[ecx+1Ch], edx
		mov	eax, [ebp+8]
		mov	dword ptr [eax+10h], 0
		mov	dword ptr [eax+14h], 0
		add	esp, 0Ch
		pop	ebx
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_438394	proc near		; CODE XREF: .text:00425C11p

File		= dword	ptr -68h
lpFileSizeHigh	= dword	ptr -64h
var_60		= dword	ptr -60h
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= byte ptr -50h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
hFile		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		cmp	[ebp+arg_4], 0
		jz	short loc_4383A9
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0

loc_4383A9:				; CODE XREF: sub_438394+Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_438554
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+68h+File],	eax ; File
		call	_fileno
		lea	edx, [ebp+var_50]
		mov	[esp+68h+lpFileSizeHigh], edx
		mov	[esp+68h+File],	eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		test	eax, eax
		jnz	short loc_4383EB
		mov	eax, [ebp+var_38]
		mov	edx, [ebp+var_34]
		jmp	locret_438568
; ---------------------------------------------------------------------------

loc_4383EB:				; CODE XREF: sub_438394+4Aj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+68h+File],	eax ; int
		call	strerror
		mov	[esp+68h+lpFileSizeHigh], eax ;	char
		mov	[esp+68h+File],	offset aFstatFailedS ; "fstat()	failed:	%s\n"
		call	sub_43CB21
		mov	eax, 0
		mov	edx, 0
		jmp	locret_438568
; ---------------------------------------------------------------------------

loc_43841B:				; CODE XREF: sub_438394+1C4j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	loc_43854B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_434F78
		jnz	loc_43854B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[ebp+hFile], eax
		mov	eax, ds:dword_451728
		test	eax, eax
		jnz	short loc_4384A7
		mov	[esp+68h+lpFileSizeHigh], 0
		mov	[esp+68h+File],	offset aKernel32_dll ; "kernel32.dll"
		call	sub_434A1A
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_43849D
		mov	[esp+68h+lpFileSizeHigh], offset aGetfilesizeex	; "GetFileSizeEx"
		mov	eax, [ebp+var_18]
		mov	[esp+68h+File],	eax ; HMODULE
		call	sub_434A38
		mov	ds:dword_45172C, eax
		mov	eax, ds:dword_45172C
		test	eax, eax
		jnz	short loc_43849D
		mov	eax, [ebp+var_18]
		mov	[esp+68h+File],	eax ; HANDLE
		call	sub_434A7D

loc_43849D:				; CODE XREF: sub_438394+DBj
					; sub_438394+FCj
		mov	ds:dword_451728, 1

loc_4384A7:				; CODE XREF: sub_438394+BEj
		mov	eax, ds:dword_45172C
		test	eax, eax
		jz	short loc_4384FB
		mov	edx, ds:dword_45172C
		lea	eax, [ebp+var_58]
		mov	[esp+68h+lpFileSizeHigh], eax
		mov	eax, [ebp+hFile]
		mov	[esp+68h+File],	eax
		call	edx ; dword_45172C
		sub	esp, 8
		test	eax, eax
		jz	short loc_438526
		mov	eax, [ebp+var_54]
		test	eax, eax
		jnz	short loc_4384E0
		mov	eax, [ebp+var_58]
		mov	edx, 0
		jmp	locret_438568
; ---------------------------------------------------------------------------

loc_4384E0:				; CODE XREF: sub_438394+13Dj
		cmp	[ebp+arg_4], 0
		jz	short loc_4384EF
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 1

loc_4384EF:				; CODE XREF: sub_438394+150j
		mov	eax, 0
		mov	edx, 0
		jmp	short locret_438568
; ---------------------------------------------------------------------------

loc_4384FB:				; CODE XREF: sub_438394+11Aj
		mov	[esp+68h+lpFileSizeHigh], 0 ; lpFileSizeHigh
		mov	eax, [ebp+hFile]
		mov	[esp+68h+File],	eax ; hFile
		mov	eax, ds:GetFileSize
		call	eax ; GetFileSize
		sub	esp, 8
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jz	short loc_438526
		mov	eax, [ebp+var_1C]
		mov	edx, 0
		jmp	short locret_438568
; ---------------------------------------------------------------------------

loc_438526:				; CODE XREF: sub_438394+136j
					; sub_438394+186j
		mov	[esp+68h+File],	0 ; DWORD
		call	sub_439E46
		mov	[esp+68h+var_60], eax
		mov	eax, [ebp+hFile]
		mov	[esp+68h+lpFileSizeHigh], eax ;	char
		mov	[esp+68h+File],	offset aGetfilesizeFor ; "GetFileSize for handle %p failed: %s\n"
		call	sub_43CB21
		jmp	short loc_43855E
; ---------------------------------------------------------------------------

loc_43854B:				; CODE XREF: sub_438394+8Fj
					; sub_438394+A0j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_438554:				; CODE XREF: sub_438394+1Dj
		cmp	[ebp+arg_0], 0
		jnz	loc_43841B

loc_43855E:				; CODE XREF: sub_438394+1B5j
		mov	eax, 0
		mov	edx, 0

locret_438568:				; CODE XREF: sub_438394+52j
					; sub_438394+82j ...
		leave
		retn
sub_438394	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_4385C0
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	[esp], eax
		call	_fileno
		jmp	short locret_4385CB
; ---------------------------------------------------------------------------

loc_43858A:				; CODE XREF: .text:004385C4j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_4385B7
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_434F78
		jnz	short loc_4385B7
		mov	eax, [ebp+8]
		mov	eax, [eax+44h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		jmp	short locret_4385CB
; ---------------------------------------------------------------------------

loc_4385B7:				; CODE XREF: .text:00438592j
					; .text:0043859Fj
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		mov	[ebp+8], eax

loc_4385C0:				; CODE XREF: .text:00438578j
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_43858A
		mov	eax, 0FFFFFFFFh

locret_4385CB:				; CODE XREF: .text:00438588j
					; .text:004385B5j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		mov	eax, [ebp+8]
		mov	ecx, [eax+18h]
		mov	ebx, [eax+1Ch]
		mov	eax, [ebp+8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, ecx
		adc	edx, ebx
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+0Ch]
		mov	[ebp-20h], eax
		mov	eax, [ebp+10h]
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_4386A5
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	[ebp-10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp-20h]
		mov	edx, [ebp-1Ch]
		mov	[esp+4], eax
		mov	[esp+8], edx
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_442840
		test	eax, eax
		jz	short loc_43866A
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp], eax
		call	strerror
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aCanTSeekS ; "can't seek: %s\n"
		call	sub_43CB21
		mov	eax, 0FFFFFFFFh
		jmp	locret_4387BC
; ---------------------------------------------------------------------------

loc_43866A:				; CODE XREF: .text:0043863Dj
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	clearerr
		jmp	loc_438715
; ---------------------------------------------------------------------------

loc_43867A:				; CODE XREF: .text:004386A9j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_43869C
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_434F78
		jnz	short loc_43869C
		mov	eax, [ebp+8]
		mov	eax, [eax+44h]
		mov	[ebp-0Ch], eax
		jmp	short loc_4386AB
; ---------------------------------------------------------------------------

loc_43869C:				; CODE XREF: .text:00438682j
					; .text:0043868Fj
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		mov	[ebp+8], eax

loc_4386A5:				; CODE XREF: .text:0043860Bj
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_43867A

loc_4386AB:				; CODE XREF: .text:0043869Aj
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_4386BB
		mov	eax, 0FFFFFFFFh
		jmp	locret_4387BC
; ---------------------------------------------------------------------------

loc_4386BB:				; CODE XREF: .text:004386AFj
		mov	edx, [ebp-20h]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	[esp+4], edx
		mov	[esp], eax
		mov	eax, ds:SetFilePointer
		call	eax ; SetFilePointer
		sub	esp, 10h
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_438715
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aSetfilepointer	; "SetFilePointer failed on handle %p: ec="...
		call	sub_43CB21
		mov	eax, 0FFFFFFFFh
		jmp	locret_4387BC
; ---------------------------------------------------------------------------

loc_438715:				; CODE XREF: .text:00438675j
					; .text:004386E7j
		mov	eax, [ebp+8]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+8]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+8]
		mov	dword ptr [eax+10h], 0
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+8]
		mov	dword ptr [eax+8], 0
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		mov	edx, eax
		and	edx, 0FFFFFFFEh
		mov	eax, [ebp+8]
		mov	[eax+20h], edx
		mov	ecx, [ebp+8]
		mov	eax, [ebp-20h]
		mov	edx, [ebp-1Ch]
		mov	[ecx+18h], eax
		mov	[ecx+1Ch], edx
		mov	eax, [ebp+8]
		mov	dword ptr [eax+3Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jz	short loc_4387AC
		mov	dword ptr [esp], offset	aPop_filterCall	; "pop_filter called in	iobuf_seek - pleas"...
		call	sub_43CBBE
		jmp	short loc_4387AC
; ---------------------------------------------------------------------------

loc_43878D:				; CODE XREF: .text:004387B5j
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		mov	dword ptr [esp+8], 0
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4372BC
		jmp	short loc_4387AD
; ---------------------------------------------------------------------------

loc_4387AC:				; CODE XREF: .text:0043877Dj
					; .text:0043878Bj
		nop

loc_4387AD:				; CODE XREF: .text:004387AAj
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_43878D
		mov	eax, 0

locret_4387BC:				; CODE XREF: .text:00438665j
					; .text:004386B6j ...
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4387BE	proc near		; CODE XREF: .text:004362BDp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		test	eax, eax
		jz	short loc_438818
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4Ch]
		jmp	short locret_438823
; ---------------------------------------------------------------------------

loc_4387D6:				; CODE XREF: sub_4387BE+5Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_43880F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_434F78
		jnz	short loc_43880F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+44h]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+var_4]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_438808
		mov	eax, [ebp+var_4]
		add	eax, 14h
		jmp	short loc_43880D
; ---------------------------------------------------------------------------

loc_438808:				; CODE XREF: sub_4387BE+40j
		mov	eax, 0

loc_43880D:				; CODE XREF: sub_4387BE+48j
		jmp	short locret_438823
; ---------------------------------------------------------------------------

loc_43880F:				; CODE XREF: sub_4387BE+20j
					; sub_4387BE+2Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		mov	[ebp+arg_0], eax

loc_438818:				; CODE XREF: sub_4387BE+Ej
		cmp	[ebp+arg_0], 0
		jnz	short loc_4387D6
		mov	eax, 0

locret_438823:				; CODE XREF: sub_4387BE+16j
					; sub_4387BE:loc_43880Dj
		leave
		retn
sub_4387BE	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		jmp	short loc_43885E
; ---------------------------------------------------------------------------

loc_43882D:				; CODE XREF: .text:00438862j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		test	eax, eax
		jnz	short loc_438855
		mov	eax, [ebp+8]
		mov	eax, [eax+40h]
		cmp	eax, offset sub_434F78
		jnz	short loc_438855
		mov	eax, [ebp+8]
		mov	eax, [eax+44h]
		mov	[ebp-4], eax
		mov	eax, [ebp-4]
		add	eax, 14h
		jmp	short locret_438869
; ---------------------------------------------------------------------------

loc_438855:				; CODE XREF: .text:00438835j
					; .text:00438842j
		mov	eax, [ebp+8]
		mov	eax, [eax+50h]
		mov	[ebp+8], eax

loc_43885E:				; CODE XREF: .text:0043882Bj
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_43882D
		mov	eax, 0

locret_438869:				; CODE XREF: .text:00438853j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 20h
		mov	dword ptr [esp], 1
		call	gcry_xcalloc
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 1
		jz	short loc_4388BA
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 2
		jz	short loc_4388BA
		mov	dword ptr [esp+8], 98Ch
		mov	dword ptr [esp+4], offset a____Gnupg22_12 ; "../../gnupg2-2.0.30/common/iobuf.c"
		mov	dword ptr [esp], offset	aAUse1AUse2 ; "a->use == 1 || a->use ==	2"
		call	sub_442650
		jmp	short loc_4388BB
; ---------------------------------------------------------------------------

loc_4388BA:				; CODE XREF: .text:00438890j
					; .text:0043889Aj
		nop

loc_4388BB:				; CODE XREF: .text:004388B8j
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], edx
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_4388FE
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, 1
		jnz	short loc_4388E1
		mov	dword ptr [esp], offset	aPop_filterCa_0	; "pop_filter called in	set_partial_block_"...
		call	sub_43CBBE

loc_4388E1:				; CODE XREF: .text:004388D3j
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], offset sub_43542D
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4372BC
		jmp	short locret_438935
; ---------------------------------------------------------------------------

loc_4388FE:				; CODE XREF: .text:004388C9j
		mov	eax, [ebp-0Ch]
		mov	dword ptr [eax+0Ch], 1
		mov	eax, [ebp-0Ch]
		mov	dword ptr [eax+4], 0
		mov	edx, [ebp+0Ch]
		mov	eax, [ebp-0Ch]
		mov	[eax+18h], edx
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], offset sub_43542D
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_436F58

locret_438935:				; CODE XREF: .text:004388FCj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		mov	[ebp-14h], eax
		mov	dword ptr [ebp-18h], 0
		mov	eax, [ebp+14h]
		mov	eax, [eax]
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_438987
		mov	dword ptr [ebp-14h], 100h
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp+10h]
		mov	edx, [ebp-14h]
		mov	[eax], edx

loc_438987:				; CODE XREF: .text:00438960j
		sub	dword ptr [ebp-14h], 3
		mov	eax, [ebp-10h]
		mov	[ebp-1Ch], eax
		jmp	loc_438A9E
; ---------------------------------------------------------------------------

loc_438996:				; CODE XREF: .text:00438B02j
		mov	eax, [ebp-18h]
		cmp	eax, [ebp-14h]
		jnz	loc_438A86
		mov	eax, [ebp-14h]
		cmp	eax, [ebp-20h]
		jbe	loc_438A36

loc_4389AE:				; CODE XREF: .text:00438A18j
		cmp	dword ptr [ebp-0Ch], 0Ah
		jz	short loc_438A1A
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_4389CE
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_4389DB

loc_4389CE:				; CODE XREF: .text:004389BCj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_437D5E
		jmp	short loc_438A11
; ---------------------------------------------------------------------------

loc_4389DB:				; CODE XREF: .text:004389CCj
		mov	eax, [ebp+8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+2Ch], ecx

loc_438A11:				; CODE XREF: .text:004389D9j
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_4389AE

loc_438A1A:				; CODE XREF: .text:004389B2j
		mov	eax, [ebp-1Ch]
		mov	byte ptr [eax],	0Ah
		add	dword ptr [ebp-1Ch], 1
		add	dword ptr [ebp-18h], 1
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0
		jmp	loc_438B0B
; ---------------------------------------------------------------------------

loc_438A36:				; CODE XREF: .text:004389A8j
		add	dword ptr [ebp-14h], 3
		cmp	dword ptr [ebp-14h], 3FFh
		ja	short loc_438A4A
		mov	eax, 100h
		jmp	short loc_438A4F
; ---------------------------------------------------------------------------

loc_438A4A:				; CODE XREF: .text:00438A41j
		mov	eax, 400h

loc_438A4F:				; CODE XREF: .text:00438A48j
		add	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	gcry_xrealloc
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp+10h]
		mov	edx, [ebp-14h]
		mov	[eax], edx
		sub	dword ptr [ebp-14h], 3
		mov	eax, [ebp-18h]
		mov	edx, [ebp-10h]
		add	eax, edx
		mov	[ebp-1Ch], eax

loc_438A86:				; CODE XREF: .text:0043899Cj
		mov	eax, [ebp-0Ch]
		mov	edx, eax
		mov	eax, [ebp-1Ch]
		mov	[eax], dl
		add	dword ptr [ebp-1Ch], 1
		add	dword ptr [ebp-18h], 1
		cmp	dword ptr [ebp-0Ch], 0Ah
		jz	short loc_438B0A

loc_438A9E:				; CODE XREF: .text:00438991j
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_438AB8
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_438AC5

loc_438AB8:				; CODE XREF: .text:00438AA6j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_437D5E
		jmp	short loc_438AFB
; ---------------------------------------------------------------------------

loc_438AC5:				; CODE XREF: .text:00438AB6j
		mov	eax, [ebp+8]
		mov	edx, [eax+14h]
		mov	eax, [eax+10h]
		add	eax, 1
		adc	edx, 0
		mov	ecx, [ebp+8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+8]
		mov	ecx, [eax+34h]
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+2Ch], ecx

loc_438AFB:				; CODE XREF: .text:00438AC3j
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	loc_438996
		jmp	short loc_438B0B
; ---------------------------------------------------------------------------

loc_438B0A:				; CODE XREF: .text:00438A9Cj
		nop

loc_438B0B:				; CODE XREF: .text:00438A31j
					; .text:00438B08j
		mov	eax, [ebp-1Ch]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-18h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_438B16	proc near		; CODE XREF: sub_4364E9+78p
					; .text:004369C5p

nStdHandle	= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+arg_0], 0
		jnz	short loc_438B38
		mov	[esp+28h+nStdHandle], 0FFFFFFF6h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+var_C], eax
		jmp	short loc_438B76
; ---------------------------------------------------------------------------

loc_438B38:				; CODE XREF: sub_438B16+Aj
		cmp	dword ptr [ebp+arg_0], 1
		jnz	short loc_438B54
		mov	[esp+28h+nStdHandle], 0FFFFFFF5h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+var_C], eax
		jmp	short loc_438B76
; ---------------------------------------------------------------------------

loc_438B54:				; CODE XREF: sub_438B16+26j
		cmp	dword ptr [ebp+arg_0], 2
		jnz	short loc_438B70
		mov	[esp+28h+nStdHandle], 0FFFFFFF4h ; nStdHandle
		mov	eax, ds:GetStdHandle
		call	eax ; GetStdHandle
		sub	esp, 4
		mov	[ebp+var_C], eax
		jmp	short loc_438B76
; ---------------------------------------------------------------------------

loc_438B70:				; CODE XREF: sub_438B16+42j
		mov	eax, dword ptr [ebp+arg_0]
		mov	[ebp+var_C], eax

loc_438B76:				; CODE XREF: sub_438B16+20j
					; sub_438B16+3Cj ...
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_438B9A
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+nStdHandle], offset aGetstdhandleDF ; "GetStdHandle(%d) failed: ec=%d\n"
		call	sub_43CBBE

loc_438B9A:				; CODE XREF: sub_438B16+64j
		mov	eax, [ebp+var_C]
		mov	dword ptr [ebp+arg_0], eax
		mov	eax, dword ptr [ebp+arg_0]
		leave
		retn
sub_438B16	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_438C24

loc_438BB2:				; CODE XREF: .text:00438C20j
					; .text:loc_438C22j
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_438BCC
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_438BE1

loc_438BCC:				; CODE XREF: .text:00438BBAj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_437D5E
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_438C22
		jmp	loc_438CC4
; ---------------------------------------------------------------------------

loc_438BE1:				; CODE XREF: .text:00438BCAj
		mov	eax, [ebp+8]
		mov	edx, [eax+30h]
		mov	eax, [ebp+8]
		mov	eax, [eax+2Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp-14h]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+8]
		mov	edx, [eax+30h]
		mov	eax, [ebp+8]
		mov	[eax+2Ch], edx
		jmp	short loc_438BB2
; ---------------------------------------------------------------------------

loc_438C22:				; CODE XREF: .text:00438BDAj
		jmp	short loc_438BB2
; ---------------------------------------------------------------------------

loc_438C24:				; CODE XREF: .text:00438BB0j
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	loc_438CB7
; ---------------------------------------------------------------------------

loc_438C2F:				; CODE XREF: .text:00438CBBj
		mov	eax, [ebp+8]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_438C49
		mov	eax, [ebp+8]
		mov	edx, [eax+2Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+30h]
		cmp	edx, eax
		jb	short loc_438C5F

loc_438C49:				; CODE XREF: .text:00438C37j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_437D5E
		cmp	eax, 0FFFFFFFFh
		jz	short loc_438CC3
		sub	dword ptr [ebp-0Ch], 1
		jmp	short loc_438CB7
; ---------------------------------------------------------------------------

loc_438C5F:				; CODE XREF: .text:00438C47j
		mov	eax, [ebp+8]
		mov	edx, [eax+30h]
		mov	eax, [ebp+8]
		mov	eax, [eax+2Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		cmp	eax, [ebp-0Ch]
		jbe	short loc_438C82
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax

loc_438C82:				; CODE XREF: .text:00438C7Aj
		mov	eax, [ebp+8]
		mov	ecx, [eax+10h]
		mov	ebx, [eax+14h]
		mov	eax, [ebp-10h]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	ecx, [ebp+8]
		mov	[ecx+10h], eax
		mov	[ecx+14h], edx
		mov	eax, [ebp+8]
		mov	eax, [eax+2Ch]
		mov	edx, eax
		add	edx, [ebp-10h]
		mov	eax, [ebp+8]
		mov	[eax+2Ch], edx
		mov	eax, [ebp-10h]
		sub	[ebp-0Ch], eax

loc_438CB7:				; CODE XREF: .text:00438C2Aj
					; .text:00438C5Dj
		cmp	dword ptr [ebp-0Ch], 0
		jnz	loc_438C2F
		jmp	short loc_438CC4
; ---------------------------------------------------------------------------

loc_438CC3:				; CODE XREF: .text:00438C57j
		nop

loc_438CC4:				; CODE XREF: .text:00438BDCj
					; .text:00438CC1j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_438CCC(char *)
sub_438CCC	proc near		; CODE XREF: sub_4392A6+356p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+Val], 5Ch ; Val
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_438D0F
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		jmp	short loc_438D05
; ---------------------------------------------------------------------------

loc_438CF1:				; CODE XREF: sub_438CCC+41j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_438D01
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	5Ch

loc_438D01:				; CODE XREF: sub_438CCC+2Dj
		add	[ebp+var_C], 1

loc_438D05:				; CODE XREF: sub_438CCC+23j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_438CF1

loc_438D0F:				; CODE XREF: sub_438CCC+1Bj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_438CCC	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_438DE5
; ---------------------------------------------------------------------------

loc_438D38:				; CODE XREF: .text:00438DE9j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jnz	short loc_438DDD
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_438D8A
; ---------------------------------------------------------------------------

loc_438D7E:				; CODE XREF: .text:00438DBAj
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_438D8A:				; CODE XREF: .text:00438D7Cj
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_438DBC
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_438D7E

loc_438DBC:				; CODE XREF: .text:00438D8Ej
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_438DCB
		mov	eax, [ebp-18h]
		jmp	short loc_438DF4
; ---------------------------------------------------------------------------

loc_438DCB:				; CODE XREF: .text:00438DC4j
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_438DDD:				; CODE XREF: .text:00438D62j
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_438DE5:				; CODE XREF: .text:00438D33j
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_438D38
		mov	eax, 0

loc_438DF4:				; CODE XREF: .text:00438DC9j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_438EC3
; ---------------------------------------------------------------------------

loc_438E1E:				; CODE XREF: .text:00438EC7j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_439EDD
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_439EDD
		cmp	ebx, eax
		jnz	short loc_438EBB
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_438E6C
; ---------------------------------------------------------------------------

loc_438E60:				; CODE XREF: .text:00438E98j
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_438E6C:				; CODE XREF: .text:00438E5Ej
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_438E9A
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_439EDD
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_439EDD
		cmp	ebx, eax
		jz	short loc_438E60

loc_438E9A:				; CODE XREF: .text:00438E70j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_438EA9
		mov	eax, [ebp-18h]
		jmp	short loc_438ED2
; ---------------------------------------------------------------------------

loc_438EA9:				; CODE XREF: .text:00438EA2j
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_438EBB:				; CODE XREF: .text:00438E44j
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_438EC3:				; CODE XREF: .text:00438E19j
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_438E1E
		mov	eax, 0

loc_438ED2:				; CODE XREF: .text:00438EA7j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_438F37
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_438EF8
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp+8], eax

loc_438EF8:				; CODE XREF: .text:00438EE8j
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		sub	dword ptr [ebp+10h], 1
		jmp	short loc_438F21
; ---------------------------------------------------------------------------

loc_438F0A:				; CODE XREF: .text:00438F2Fj
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp+10h], 1

loc_438F21:				; CODE XREF: .text:00438F08j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_438F31
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_438F0A

loc_438F31:				; CODE XREF: .text:00438F25j
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0

loc_438F37:				; CODE XREF: .text:00438EE2j
		mov	eax, [ebp+8]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_438F3C	proc near		; CODE XREF: sub_43D24E+2FFp
					; sub_43D24E+3BCp

C		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_438F54
; ---------------------------------------------------------------------------

loc_438F50:				; CODE XREF: sub_438F3C+37j
		add	[ebp+var_10], 1

loc_438F54:				; CODE XREF: sub_438F3C+12j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_438F75
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_438F50

loc_438F75:				; CODE XREF: sub_438F3C+20j
		mov	[ebp+var_14], 0
		jmp	short loc_438FB2
; ---------------------------------------------------------------------------

loc_438F7E:				; CODE XREF: sub_438F3C+89j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_438FA3
		cmp	[ebp+var_14], 0
		jnz	short loc_438FAA
		mov	eax, [ebp+var_C]
		mov	[ebp+var_14], eax
		jmp	short loc_438FAA
; ---------------------------------------------------------------------------

loc_438FA3:				; CODE XREF: sub_438F3C+57j
		mov	[ebp+var_14], 0

loc_438FAA:				; CODE XREF: sub_438F3C+5Dj
					; sub_438F3C+65j
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_438FB2:				; CODE XREF: sub_438F3C+40j
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_438F7E
		cmp	[ebp+var_14], 0
		jz	short loc_438FD3
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0

loc_438FD3:				; CODE XREF: sub_438F3C+8Fj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_438F3C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_43901D
; ---------------------------------------------------------------------------

loc_438FED:				; CODE XREF: .text:00439025j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_439012
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_439019
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax
		jmp	short loc_439019
; ---------------------------------------------------------------------------

loc_439012:				; CODE XREF: .text:00439002j
		mov	dword ptr [ebp-10h], 0

loc_439019:				; CODE XREF: .text:00439008j
					; .text:00439010j
		add	dword ptr [ebp-0Ch], 1

loc_43901D:				; CODE XREF: .text:00438FEBj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_438FED
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_439033
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	0

loc_439033:				; CODE XREF: .text:0043902Bj
		mov	eax, [ebp+8]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_439038(int, int, char	*)
sub_439038	proc near		; CODE XREF: .text:004390CFp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_43908D
; ---------------------------------------------------------------------------

loc_439054:				; CODE XREF: sub_439038+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_43907E
		cmp	[ebp+var_10], 0
		jnz	short loc_439085
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_439085
; ---------------------------------------------------------------------------

loc_43907E:				; CODE XREF: sub_439038+36j
		mov	[ebp+var_10], 0

loc_439085:				; CODE XREF: sub_439038+3Cj
					; sub_439038+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_43908D:				; CODE XREF: sub_439038+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_439054
		cmp	[ebp+var_10], 0
		jz	short loc_4390AF
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_4390B2
; ---------------------------------------------------------------------------

loc_4390AF:				; CODE XREF: sub_439038+61j
		mov	eax, [ebp+arg_4]

locret_4390B2:				; CODE XREF: sub_439038+75j
		leave
		retn
sub_439038	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_44E7A4 ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_439038
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4390D6(int, int, char	*)
sub_4390D6	proc near		; CODE XREF: .text:00439167p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_43912B
; ---------------------------------------------------------------------------

loc_4390F2:				; CODE XREF: sub_4390D6+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_43911C
		cmp	[ebp+var_10], 0
		jnz	short loc_439123
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_439123
; ---------------------------------------------------------------------------

loc_43911C:				; CODE XREF: sub_4390D6+36j
		mov	[ebp+var_10], 0

loc_439123:				; CODE XREF: sub_4390D6+3Cj
					; sub_4390D6+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_43912B:				; CODE XREF: sub_4390D6+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_4390F2
		cmp	[ebp+var_10], 0
		jz	short loc_439147
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_43914A
; ---------------------------------------------------------------------------

loc_439147:				; CODE XREF: sub_4390D6+61j
		mov	eax, [ebp+arg_4]

locret_43914A:				; CODE XREF: sub_4390D6+6Fj
		leave
		retn
sub_4390D6	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_44E7A4 ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4390D6
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4391D5
		mov	dword ptr [esp+4], 5Ch
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4391D5
		mov	dword ptr [esp+4], 3Ah
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4391D5
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	gcry_xstrdup
		jmp	short locret_4391E3
; ---------------------------------------------------------------------------

loc_4391D5:				; CODE XREF: .text:0043918Ej
					; .text:004391AAj ...
		mov	eax, [ebp-0Ch]
		add	eax, 1
		mov	[esp], eax
		call	gcry_xstrdup

locret_4391E3:				; CODE XREF: .text:004391D3j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_43924D
		mov	dword ptr [esp+4], 5Ch
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_43924D
		mov	dword ptr [esp+4], 3Ah
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_43924D
		mov	dword ptr [esp], offset	a_ ; "."
		call	gcry_xstrdup
		jmp	short locret_439292
; ---------------------------------------------------------------------------

loc_43924D:				; CODE XREF: .text:00439205j
					; .text:00439221j ...
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp-14h], eax
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	strncpy
		mov	eax, [ebp-10h]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-14h]

locret_439292:				; CODE XREF: .text:0043924Bj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_439294	proc near		; CODE XREF: sub_4392A6+144p
					; sub_4392A6+22Bp

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		mov	eax, [ebp+var_4]
		leave
		retn
sub_439294	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4392A6	proc near		; CODE XREF: sub_43960B+23p
					; .text:0043965Ep

VarName		= dword	ptr -0C8h
Val		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
Str		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0C0h
		mov	[ebp+var_14], 1
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_43936D
; ---------------------------------------------------------------------------

loc_4392F3:				; CODE XREF: sub_4392A6+E8j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_10]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		cmp	eax, 1Eh
		jbe	short loc_439369
		cmp	[ebp+arg_0], 0
		jz	short loc_439352
		mov	[esp+0C8h+var_C0], offset aDo_make_filena ; "do_make_filename"
		mov	[esp+0C8h+Val],	176h
		mov	[esp+0C8h+VarName], offset a____Gnupg22_13 ; "../../gnupg2-2.0.30/jnlib/stringhelp.c"
		call	sub_43CCB0
; ---------------------------------------------------------------------------

loc_439352:				; CODE XREF: sub_4392A6+8Ej
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	loc_439601
; ---------------------------------------------------------------------------

loc_439369:				; CODE XREF: sub_4392A6+88j
		add	[ebp+var_C], 1

loc_43936D:				; CODE XREF: sub_4392A6+4Bj
		mov	eax, [ebp+arg_8]
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_A8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		test	eax, eax
		jnz	loc_4392F3
		add	[ebp+var_10], 1
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Eh
		jnz	loc_439524
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jz	short loc_4393C7
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43943D

loc_4393C7:				; CODE XREF: sub_4392A6+112j
		mov	[esp+0C8h+VarName], offset aHome_0 ; "HOME"
		call	getenv
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_4393F8
		mov	[esp+0C8h+Val],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+VarName], eax
		call	sub_439294
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_20], eax

loc_4393F8:				; CODE XREF: sub_4392A6+134j
		cmp	[ebp+var_20], 0
		jz	loc_439523
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_439523
		mov	eax, [ebp+var_20]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		jmp	loc_439523
; ---------------------------------------------------------------------------

loc_43943D:				; CODE XREF: sub_4392A6+11Fj
		cmp	[ebp+arg_0], 0
		jz	short loc_439456
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+0C8h+VarName], eax
		call	gcry_xstrdup
		mov	[ebp+Str], eax
		jmp	short loc_439477
; ---------------------------------------------------------------------------

loc_439456:				; CODE XREF: sub_4392A6+19Bj
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+0C8h+VarName], eax
		call	gcry_strdup
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jnz	short loc_439477
		mov	eax, 0
		jmp	loc_439601
; ---------------------------------------------------------------------------

loc_439477:				; CODE XREF: sub_4392A6+1AEj
					; sub_4392A6+1C5j
		mov	[esp+0C8h+Val],	2Fh ; Val
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+VarName], eax	; Str
		call	strchr
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_439499
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0

loc_439499:				; CODE XREF: sub_4392A6+1EBj
		mov	eax, [ebp+Str]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+VarName], eax
		call	sub_439294
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+VarName], eax
		call	gcry_free
		cmp	[ebp+var_20], 0
		jz	short loc_43951A
		mov	eax, [ebp+var_20]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		jmp	short loc_439524
; ---------------------------------------------------------------------------

loc_43951A:				; CODE XREF: sub_4392A6+248j
		mov	[ebp+var_14], 1
		jmp	short loc_439524
; ---------------------------------------------------------------------------

loc_439523:				; CODE XREF: sub_4392A6+156j
					; sub_4392A6+164j ...
		nop

loc_439524:				; CODE XREF: sub_4392A6+101j
					; sub_4392A6+272j ...
		cmp	[ebp+arg_0], 0
		jz	short loc_43953A
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+VarName], eax
		call	gcry_xmalloc
		mov	[ebp+var_1C], eax
		jmp	short loc_439563
; ---------------------------------------------------------------------------

loc_43953A:				; CODE XREF: sub_4392A6+282j
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+VarName], eax
		call	gcry_malloc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_439563
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+VarName], eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_439601
; ---------------------------------------------------------------------------

loc_439563:				; CODE XREF: sub_4392A6+292j
					; sub_4392A6+2A6j
		cmp	[ebp+var_20], 0
		jz	short loc_439594
		mov	eax, [ebp+var_14]
		mov	ebx, eax
		add	ebx, [ebp+arg_4]
		mov	eax, [ebp+var_20]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax
		call	sub_43A1E9
		mov	[esp+0C8h+Val],	ebx
		mov	[esp+0C8h+VarName], eax
		call	sub_43A1E9
		mov	[ebp+var_24], eax
		jmp	short loc_4395A9
; ---------------------------------------------------------------------------

loc_439594:				; CODE XREF: sub_4392A6+2C1j
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax
		call	sub_43A1E9
		mov	[ebp+var_24], eax

loc_4395A9:				; CODE XREF: sub_4392A6+2ECj
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+VarName], eax
		call	gcry_free
		mov	[ebp+var_C], 0
		jmp	short loc_4395E8
; ---------------------------------------------------------------------------

loc_4395BD:				; CODE XREF: sub_4392A6+34Ej
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		mov	edx, [ebp+var_24]
		mov	word ptr [edx],	2Fh
		mov	edx, [ebp+var_24]
		add	edx, 1
		mov	[esp+0C8h+Val],	eax
		mov	[esp+0C8h+VarName], edx
		call	sub_43A1E9
		mov	[ebp+var_24], eax
		add	[ebp+var_C], 1

loc_4395E8:				; CODE XREF: sub_4392A6+315j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		test	eax, eax
		jnz	short loc_4395BD
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax	; char *
		call	sub_438CCC

loc_439601:				; CODE XREF: sub_4392A6+BEj
					; sub_4392A6+1CCj ...
		add	esp, 0C0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4392A6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43960B	proc near		; CODE XREF: sub_401C11+395p
					; sub_401C11+B02p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], 1
		call	sub_4392A6
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_43960B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_4392A6
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43966B	proc near		; CODE XREF: .text:0044056Ap

C		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		jmp	short loc_4396E0
; ---------------------------------------------------------------------------

loc_439674:				; CODE XREF: sub_43966B+87j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4396D8
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+C], eax ; C
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+C], eax ; C
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_4396D8
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4396C4
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_4396D8

loc_4396C4:				; CODE XREF: sub_43966B+4Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_4396F4
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4396F4

loc_4396D8:				; CODE XREF: sub_43966B+17j
					; sub_43966B+43j ...
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_4396E0:				; CODE XREF: sub_43966B+7j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4396F4
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_439674

loc_4396F4:				; CODE XREF: sub_43966B+61j
					; sub_43966B+6Bj ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_439708
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_43971C

loc_439708:				; CODE XREF: sub_43966B+91j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_439723
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_439723

loc_43971C:				; CODE XREF: sub_43966B+9Bj
		mov	eax, 0
		jmp	short loc_439751
; ---------------------------------------------------------------------------

loc_439723:				; CODE XREF: sub_43966B+A5j
					; sub_43966B+AFj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+C], eax ; C
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+C], eax ; C
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx

loc_439751:				; CODE XREF: sub_43966B+B6j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_43966B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_439785
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_439785
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4397DC
; ---------------------------------------------------------------------------

loc_439785:				; CODE XREF: .text:00439765j
					; .text:0043976Fj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_4397AD
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_4397AD
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4397DC
; ---------------------------------------------------------------------------

loc_4397AD:				; CODE XREF: .text:0043978Dj
					; .text:00439797j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_4397D5
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_4397D5
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4397DC
; ---------------------------------------------------------------------------

loc_4397D5:				; CODE XREF: .text:004397B5j
					; .text:004397BFj
		mov	eax, 0FFFFFFFFh
		jmp	short locret_439859
; ---------------------------------------------------------------------------

loc_4397DC:				; CODE XREF: .text:00439783j
					; .text:004397ABj ...
		add	dword ptr [ebp+8], 1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_439805
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_439805
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	[ebp-4], eax
		jmp	short loc_439856
; ---------------------------------------------------------------------------

loc_439805:				; CODE XREF: .text:004397E8j
					; .text:004397F2j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_43982A
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_43982A
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		add	[ebp-4], eax
		jmp	short loc_439856
; ---------------------------------------------------------------------------

loc_43982A:				; CODE XREF: .text:0043980Dj
					; .text:00439817j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_43984F
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_43984F
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		add	[ebp-4], eax
		jmp	short loc_439856
; ---------------------------------------------------------------------------

loc_43984F:				; CODE XREF: .text:00439832j
					; .text:0043983Cj
		mov	eax, 0FFFFFFFFh
		jmp	short locret_439859
; ---------------------------------------------------------------------------

loc_439856:				; CODE XREF: .text:00439803j
					; .text:00439828j ...
		mov	eax, [ebp-4]

locret_439859:				; CODE XREF: .text:004397DAj
					; .text:00439854j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43985B(FILE *, int, int, int,	int)
sub_43985B	proc near		; CODE XREF: sub_439A14+29p
					; .text:00439B51p

var_28		= dword	ptr -28h
File		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_439A05
; ---------------------------------------------------------------------------

loc_439873:				; CODE XREF: sub_43985B+1AEj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_4398C1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_4398C1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_C]
		jz	short loc_4398C1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_10]
		jz	short loc_4398C1
		cmp	[ebp+arg_C], 0
		jnz	short loc_4398B3
		cmp	[ebp+arg_10], 0
		jz	loc_4399DD

loc_4398B3:				; CODE XREF: sub_43985B+4Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_4399DD

loc_4398C1:				; CODE XREF: sub_43985B+20j
					; sub_43985B+2Aj ...
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 5Ch ;	Ch
		call	putc
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_4398FE
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 6Eh ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_4399F9
; ---------------------------------------------------------------------------

loc_4398FE:				; CODE XREF: sub_43985B+85j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_439924
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 72h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_4399F9
; ---------------------------------------------------------------------------

loc_439924:				; CODE XREF: sub_43985B+ABj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_43994A
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 66h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_4399F9
; ---------------------------------------------------------------------------

loc_43994A:				; CODE XREF: sub_43985B+D1j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_439970
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 76h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_4399F9
; ---------------------------------------------------------------------------

loc_439970:				; CODE XREF: sub_43985B+F7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_439993
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 62h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_4399F9
; ---------------------------------------------------------------------------

loc_439993:				; CODE XREF: sub_43985B+11Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4399B6
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 30h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_4399F9
; ---------------------------------------------------------------------------

loc_4399B6:				; CODE XREF: sub_43985B+140j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "x%02x"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+File],	eax ; Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	File
		call	fprintf
		add	[ebp+var_10], 3
		jmp	short loc_4399F9
; ---------------------------------------------------------------------------

loc_4399DD:				; CODE XREF: sub_43985B+52j
					; sub_43985B+60j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	putc
		add	[ebp+var_10], 1

loc_4399F9:				; CODE XREF: sub_43985B+9Ej
					; sub_43985B+C4j ...
		sub	[ebp+arg_8], 1
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_439A05:				; CODE XREF: sub_43985B+13j
		cmp	[ebp+arg_8], 0
		jnz	loc_439873
		mov	eax, [ebp+var_10]
		leave
		retn
sub_43985B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_439A14(FILE *, int, int, int)
sub_439A14	proc near		; CODE XREF: .text:00425A42p
					; sub_439A44+B7p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_18], 0 ; int
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	FILE *
		call	sub_43985B
		leave
		retn
sub_439A14	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_439A44(FILE *, int, int, int)
sub_439A44	proc near		; CODE XREF: sub_425A49+21p
					; .text:00439BFDp

Str		= dword	ptr -38h
File		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_439A6D
; ---------------------------------------------------------------------------

loc_439A5A:				; CODE XREF: sub_439A44+2Fj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_439A77
		add	[ebp+var_C], 1

loc_439A6D:				; CODE XREF: sub_439A44+14j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jb	short loc_439A5A
		jmp	short loc_439A78
; ---------------------------------------------------------------------------

loc_439A77:				; CODE XREF: sub_439A44+23j
		nop

loc_439A78:				; CODE XREF: sub_439A44+31j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jnb	short loc_439AE0
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+File],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax
		call	sub_44004F
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Str], eax ; Str
		call	fputs
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax
		call	gcry_free
		mov	eax, [ebp+var_C]
		jmp	short loc_439B00
; ---------------------------------------------------------------------------

loc_439AE0:				; CODE XREF: sub_439A44+3Aj
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+File],	eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; FILE *
		call	sub_439A14

loc_439B00:				; CODE XREF: sub_439A44+9Aj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_439A44	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_439B58
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+14h]
		mov	[esp+10h], eax
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_43985B
		jmp	short loc_439B5D
; ---------------------------------------------------------------------------

loc_439B58:				; CODE XREF: .text:00439B11j
		mov	eax, 0

loc_439B5D:				; CODE XREF: .text:00439B56j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_439BAE
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_439A14
		jmp	short loc_439BB3
; ---------------------------------------------------------------------------

loc_439BAE:				; CODE XREF: .text:00439B6Ej
		mov	eax, 0

loc_439BB3:				; CODE XREF: .text:00439BACj
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_439C04
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_439A44
		jmp	short loc_439C09
; ---------------------------------------------------------------------------

loc_439C04:				; CODE XREF: .text:00439BC4j
		mov	eax, 0

loc_439C09:				; CODE XREF: .text:00439C02j
		add	esp, 24h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_439C0F	proc near		; CODE XREF: .text:00425B62p

Dest		= dword	ptr -38h
Format		= dword	ptr -34h
var_30		= dword	ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_10], 1
		jmp	loc_439CB9
; ---------------------------------------------------------------------------

loc_439C33:				; CODE XREF: sub_439C0F+AEj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_439C65
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_439C65
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_8]
		jz	short loc_439C65
		cmp	[ebp+arg_8], 0
		jz	short loc_439CAD
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_439CAD

loc_439C65:				; CODE XREF: sub_439C0F+2Cj
					; sub_439C0F+36j ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_439CA1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_439CA1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jz	short loc_439CA1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jz	short loc_439CA1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jz	short loc_439CA1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_439CA7

loc_439CA1:				; CODE XREF: sub_439C0F+5Ej
					; sub_439C0F+68j ...
		add	[ebp+var_10], 2
		jmp	short loc_439CB1
; ---------------------------------------------------------------------------

loc_439CA7:				; CODE XREF: sub_439C0F+90j
		add	[ebp+var_10], 5
		jmp	short loc_439CB1
; ---------------------------------------------------------------------------

loc_439CAD:				; CODE XREF: sub_439C0F+4Aj
					; sub_439C0F+54j
		add	[ebp+var_10], 1

loc_439CB1:				; CODE XREF: sub_439C0F+96j
					; sub_439C0F+9Cj
		sub	[ebp+arg_4], 1
		add	[ebp+var_C], 1

loc_439CB9:				; CODE XREF: sub_439C0F+1Fj
		cmp	[ebp+arg_4], 0
		jnz	loc_439C33
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+arg_4], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_14], eax
		jmp	loc_439DF6
; ---------------------------------------------------------------------------

loc_439CE8:				; CODE XREF: sub_439C0F+1EBj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_439D22
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_439D22
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_8]
		jz	short loc_439D22
		cmp	[ebp+arg_8], 0
		jz	loc_439DDD
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_439DDD

loc_439D22:				; CODE XREF: sub_439C0F+E1j
					; sub_439C0F+EBj ...
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_439D45
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	6Eh
		add	[ebp+var_14], 1
		jmp	loc_439DEE
; ---------------------------------------------------------------------------

loc_439D45:				; CODE XREF: sub_439C0F+125j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_439D5E
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	72h
		add	[ebp+var_14], 1
		jmp	loc_439DEE
; ---------------------------------------------------------------------------

loc_439D5E:				; CODE XREF: sub_439C0F+13Ej
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_439D74
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	66h
		add	[ebp+var_14], 1
		jmp	short loc_439DEE
; ---------------------------------------------------------------------------

loc_439D74:				; CODE XREF: sub_439C0F+157j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_439D8A
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	76h
		add	[ebp+var_14], 1
		jmp	short loc_439DEE
; ---------------------------------------------------------------------------

loc_439D8A:				; CODE XREF: sub_439C0F+16Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_439DA0
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	62h
		add	[ebp+var_14], 1
		jmp	short loc_439DEE
; ---------------------------------------------------------------------------

loc_439DA0:				; CODE XREF: sub_439C0F+183j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_439DB6
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	30h
		add	[ebp+var_14], 1
		jmp	short loc_439DEE
; ---------------------------------------------------------------------------

loc_439DB6:				; CODE XREF: sub_439C0F+199j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "x%02x"
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Format], eax ;	Format
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_14], 3
		jmp	short loc_439DEE
; ---------------------------------------------------------------------------

loc_439DDD:				; CODE XREF: sub_439C0F+FFj
					; sub_439C0F+10Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1

loc_439DEE:				; CODE XREF: sub_439C0F+131j
					; sub_439C0F+14Aj ...
		sub	[ebp+arg_4], 1
		add	[ebp+var_C], 1

loc_439DF6:				; CODE XREF: sub_439C0F+D4j
		cmp	[ebp+arg_4], 0
		jnz	loc_439CE8
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]
		leave
		retn
sub_439C0F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	dword ptr [ebp-4], 0
		jmp	short loc_439E37
; ---------------------------------------------------------------------------

loc_439E1A:				; CODE XREF: .text:00439E3Fj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0C0h
		cmp	eax, 80h
		jz	short loc_439E33
		add	dword ptr [ebp-4], 1

loc_439E33:				; CODE XREF: .text:00439E2Dj
		add	dword ptr [ebp+8], 1

loc_439E37:				; CODE XREF: .text:00439E18j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_439E1A
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_439E46(DWORD)
sub_439E46	proc near		; CODE XREF: sub_407149+F9p
					; sub_4260FC+51p ...

dwFlags		= dword	ptr -28h
lpSource	= dword	ptr -24h
dwMessageId	= dword	ptr -20h
dwLanguageId	= dword	ptr -1Ch
lpBuffer	= dword	ptr -18h
nSize		= dword	ptr -14h
Arguments	= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jnz	short loc_439E5C
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+arg_0], eax

loc_439E5C:				; CODE XREF: sub_439E46+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Arguments], 0 ; Arguments
		mov	[esp+28h+nSize], 0FFh ;	nSize
		mov	[esp+28h+lpBuffer], offset Buffer ; lpBuffer
		mov	[esp+28h+dwLanguageId],	400h ; dwLanguageId
		mov	[esp+28h+dwMessageId], eax ; dwMessageId
		mov	[esp+28h+lpSource], 0 ;	lpSource
		mov	[esp+28h+dwFlags], 1000h ; dwFlags
		mov	eax, ds:FormatMessageA
		call	eax ; FormatMessageA
		sub	esp, 1Ch
		mov	eax, offset Buffer
		leave
		retn
sub_439E46	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 40h
		jle	short loc_439EB9
		cmp	dword ptr [ebp+8], 5Ah
		jg	short loc_439EB9
		mov	eax, 1
		jmp	short loc_439EBE
; ---------------------------------------------------------------------------

loc_439EB9:				; CODE XREF: .text:00439EAAj
					; .text:00439EB0j
		mov	eax, 0

loc_439EBE:				; CODE XREF: .text:00439EB7j
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 60h
		jle	short loc_439ED6
		cmp	dword ptr [ebp+8], 7Ah
		jg	short loc_439ED6
		mov	eax, 1
		jmp	short loc_439EDB
; ---------------------------------------------------------------------------

loc_439ED6:				; CODE XREF: .text:00439EC7j
					; .text:00439ECDj
		mov	eax, 0

loc_439EDB:				; CODE XREF: .text:00439ED4j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_439EDD	proc near		; CODE XREF: .text:00438E2Ap
					; .text:00438E3Dp ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 60h
		jle	short loc_439EF0
		cmp	[ebp+arg_0], 7Ah
		jg	short loc_439EF0
		and	[ebp+arg_0], 0FFFFFFDFh

loc_439EF0:				; CODE XREF: sub_439EDD+7j
					; sub_439EDD+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_439EDD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_439EF5	proc near		; CODE XREF: .text:00439FFAp
					; .text:0043A00Ep

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 40h
		jle	short loc_439F08
		cmp	[ebp+arg_0], 5Ah
		jg	short loc_439F08
		or	[ebp+arg_0], 20h

loc_439F08:				; CODE XREF: sub_439EF5+7j
					; sub_439EF5+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_439EF5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_439F0D	proc near		; CODE XREF: sub_40E52B+43p
					; sub_43F31B+187p ...

var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_439F68
		mov	eax, 0
		jmp	loc_439FC1
; ---------------------------------------------------------------------------

loc_439F26:				; CODE XREF: sub_439F0D+6Ej
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_439F5E
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_439EDD
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_439EDD
		cmp	ebx, eax
		jnz	short loc_439F7F

loc_439F5E:				; CODE XREF: sub_439F0D+27j
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1
		jmp	short loc_439F69
; ---------------------------------------------------------------------------

loc_439F68:				; CODE XREF: sub_439F0D+Dj
		nop

loc_439F69:				; CODE XREF: sub_439F0D+59j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_439F80
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_439F26
		jmp	short loc_439F80
; ---------------------------------------------------------------------------

loc_439F7F:				; CODE XREF: sub_439F0D+4Fj
		nop

loc_439F80:				; CODE XREF: sub_439F0D+64j
					; sub_439F0D+70j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_439FBC
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_439EDD
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_439EDD
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_439FC1
; ---------------------------------------------------------------------------

loc_439FBC:				; CODE XREF: sub_439F0D+81j
		mov	eax, 0

loc_439FC1:				; CODE XREF: sub_439F0D+14j
					; sub_439F0D+ADj
		add	esp, 4
		pop	ebx
		pop	ebp
		retn
sub_439F0D	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-8], eax
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jz	short loc_439FE7
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_439FEE

loc_439FE7:				; CODE XREF: .text:00439FDFj
		mov	eax, 0
		jmp	short locret_43A045
; ---------------------------------------------------------------------------

loc_439FEE:				; CODE XREF: .text:00439FE5j
					; .text:0043A035j
		mov	eax, [ebp-4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_439EF5
		mov	[ebp-9], al
		mov	eax, [ebp-8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_439EF5
		mov	[ebp-0Ah], al
		sub	dword ptr [ebp+10h], 1
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_43A037
		cmp	byte ptr [ebp-9], 0
		jz	short loc_43A037
		add	dword ptr [ebp-4], 1
		add	dword ptr [ebp-8], 1
		movzx	eax, byte ptr [ebp-9]
		cmp	al, [ebp-0Ah]
		jz	short loc_439FEE

loc_43A037:				; CODE XREF: .text:0043A01Ej
					; .text:0043A024j
		movzx	edx, byte ptr [ebp-9]
		movzx	eax, byte ptr [ebp-0Ah]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_43A045:				; CODE XREF: .text:00439FECj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43A047	proc near		; CODE XREF: .text:0043A1C8p
					; sub_43F31B+14Ap

var_18		= dword	ptr -18h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_C]
		jnz	loc_43A0F7
		mov	eax, 0
		jmp	loc_43A106
; ---------------------------------------------------------------------------

loc_43A070:				; CODE XREF: sub_43A047+B4j
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_43A0EB
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_439EDD
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_439EDD
		cmp	ebx, eax
		jz	short loc_43A0EB
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_43A0E4
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_439EDD
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_439EDD
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_43A0E9
; ---------------------------------------------------------------------------

loc_43A0E4:				; CODE XREF: sub_43A047+6Fj
		mov	eax, 0

loc_43A0E9:				; CODE XREF: sub_43A047+9Bj
		jmp	short loc_43A106
; ---------------------------------------------------------------------------

loc_43A0EB:				; CODE XREF: sub_43A047+37j
					; sub_43A047+5Fj
		sub	[ebp+arg_8], 1
		add	[ebp+var_8], 1
		add	[ebp+var_C], 1

loc_43A0F7:				; CODE XREF: sub_43A047+19j
		cmp	[ebp+arg_8], 0
		jnz	loc_43A070
		mov	eax, 0

loc_43A106:				; CODE XREF: sub_43A047+24j
					; sub_43A047:loc_43A0E9j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_43A047	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		cmp	eax, [ebp+0Ch]
		jnz	short loc_43A138
		mov	eax, 0
		jmp	short loc_43A17F
; ---------------------------------------------------------------------------

loc_43A11E:				; CODE XREF: .text:0043A14Bj
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jnz	short loc_43A14F
		add	dword ptr [ebp+8], 1
		add	dword ptr [ebp+0Ch], 1
		jmp	short loc_43A139
; ---------------------------------------------------------------------------

loc_43A138:				; CODE XREF: .text:0043A115j
		nop

loc_43A139:				; CODE XREF: .text:0043A136j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43A150
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43A11E
		jmp	short loc_43A150
; ---------------------------------------------------------------------------

loc_43A14F:				; CODE XREF: .text:0043A12Cj
		nop

loc_43A150:				; CODE XREF: .text:0043A141j
					; .text:0043A14Dj
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_43A17A
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short loc_43A17F
; ---------------------------------------------------------------------------

loc_43A17A:				; CODE XREF: .text:0043A15Ej
		mov	eax, 0

loc_43A17F:				; CODE XREF: .text:0043A11Cj
					; .text:0043A178j
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		cmp	dword ptr [ebp+14h], 0
		jnz	short loc_43A192
		mov	eax, [ebp+8]
		jmp	short locret_43A1E7
; ---------------------------------------------------------------------------

loc_43A192:				; CODE XREF: .text:0043A18Bj
		mov	eax, [ebp+14h]
		cmp	eax, [ebp+0Ch]
		ja	short loc_43A1E2
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+14h]
		mov	edx, [ebp+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, [ebp-4]
		mov	[ebp-8], eax
		jmp	short loc_43A1DA
; ---------------------------------------------------------------------------

loc_43A1B4:				; CODE XREF: .text:0043A1E0j
		mov	eax, [ebp+14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-4]
		mov	[esp], eax
		call	sub_43A047
		test	eax, eax
		jnz	short loc_43A1D6
		mov	eax, [ebp-4]
		jmp	short locret_43A1E7
; ---------------------------------------------------------------------------

loc_43A1D6:				; CODE XREF: .text:0043A1CFj
		add	dword ptr [ebp-4], 1

loc_43A1DA:				; CODE XREF: .text:0043A1B2j
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jbe	short loc_43A1B4

loc_43A1E2:				; CODE XREF: .text:0043A198j
		mov	eax, 0

locret_43A1E7:				; CODE XREF: .text:0043A190j
					; .text:0043A1D4j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43A1E9	proc near		; CODE XREF: sub_40165C+A1p
					; sub_40EBA8+CAp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		jmp	short loc_43A201
; ---------------------------------------------------------------------------

loc_43A1EE:				; CODE XREF: sub_43A1E9+20j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_43A201:				; CODE XREF: sub_43A1E9+3j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43A1EE
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_43A1E9	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_43A234
		mov	eax, 0
		jmp	locret_43A2DF
; ---------------------------------------------------------------------------

loc_43A234:				; CODE XREF: .text:0043A228j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43A24B
		mov	eax, [ebp+0Ch]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43A2A4

loc_43A24B:				; CODE XREF: .text:0043A23Cj
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		mov	[ebp-11h], al
		cmp	byte ptr [ebp-11h], 0
		jnz	short loc_43A263
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_43A2B9
; ---------------------------------------------------------------------------

loc_43A263:				; CODE XREF: .text:0043A258j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, [ebp-11h]
		jnz	short loc_43A276
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	short loc_43A2B9
; ---------------------------------------------------------------------------

loc_43A276:				; CODE XREF: .text:0043A26Cj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43A289
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_43A2B9
; ---------------------------------------------------------------------------

loc_43A289:				; CODE XREF: .text:0043A27Ej
		movsx	eax, byte ptr [ebp-11h]
		mov	edx, [ebp-10h]
		add	edx, 1
		mov	[esp+4], eax
		mov	[esp], edx
		call	strchr
		mov	[ebp-0Ch], eax
		jmp	short loc_43A2B9
; ---------------------------------------------------------------------------

loc_43A2A4:				; CODE XREF: .text:0043A249j
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	strpbrk
		mov	[ebp-0Ch], eax

loc_43A2B9:				; CODE XREF: .text:0043A261j
					; .text:0043A274j ...
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_43A2D3
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp+8]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		jmp	short loc_43A2DC
; ---------------------------------------------------------------------------

loc_43A2D3:				; CODE XREF: .text:0043A2BDj
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0

loc_43A2DC:				; CODE XREF: .text:0043A2D1j
		mov	eax, [ebp-10h]

locret_43A2DF:				; CODE XREF: .text:0043A22Fj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43A2E1	proc near		; CODE XREF: sub_430B5D+30p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_8]
		add	[ebp+var_4], eax
		jmp	short loc_43A310
; ---------------------------------------------------------------------------

loc_43A2F5:				; CODE XREF: sub_43A2E1+33j
		sub	[ebp+var_4], 1
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_4]
		jnz	short loc_43A30C
		mov	eax, [ebp+var_4]
		jmp	short locret_43A31B
; ---------------------------------------------------------------------------

loc_43A30C:				; CODE XREF: sub_43A2E1+24j
		sub	[ebp+arg_8], 1

loc_43A310:				; CODE XREF: sub_43A2E1+12j
		cmp	[ebp+arg_8], 0
		jnz	short loc_43A2F5
		mov	eax, 0

locret_43A31B:				; CODE XREF: sub_43A2E1+29j
		leave
		retn
sub_43A2E1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43A31D(int, char *, int)
sub_43A31D	proc near		; CODE XREF: sub_43A532+1Bp
					; .text:0043A56Fp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_43A333
		mov	eax, 0
		jmp	locret_43A530
; ---------------------------------------------------------------------------

loc_43A333:				; CODE XREF: sub_43A31D+Aj
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	short loc_43A389
; ---------------------------------------------------------------------------

loc_43A342:				; CODE XREF: sub_43A31D+77j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_43A381
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_43A381
		cmp	[ebp+arg_4], 0
		jz	short loc_43A385
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_43A385

loc_43A381:				; CODE XREF: sub_43A31D+30j
					; sub_43A31D+3Dj
		add	[ebp+var_10], 1

loc_43A385:				; CODE XREF: sub_43A31D+43j
					; sub_43A31D+62j
		add	[ebp+var_C], 1

loc_43A389:				; CODE XREF: sub_43A31D+23j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43A342
		cmp	[ebp+arg_8], 0
		jz	short loc_43A3B4
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+Str], eax
		call	gcry_xmalloc
		mov	[ebp+var_14], eax
		jmp	short loc_43A3DA
; ---------------------------------------------------------------------------

loc_43A3B4:				; CODE XREF: sub_43A31D+7Dj
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+Str], eax
		call	gcry_malloc
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_43A3DA
		mov	eax, 0
		jmp	locret_43A530
; ---------------------------------------------------------------------------

loc_43A3DA:				; CODE XREF: sub_43A31D+95j
					; sub_43A31D+B1j
		mov	[ebp+var_C], 0
		jmp	loc_43A516
; ---------------------------------------------------------------------------

loc_43A3E6:				; CODE XREF: sub_43A31D+201j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_43A41C
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	33h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	61h
		add	[ebp+var_C], 1
		jmp	loc_43A512
; ---------------------------------------------------------------------------

loc_43A41C:				; CODE XREF: sub_43A31D+D1j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_43A452
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	32h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	35h
		add	[ebp+var_C], 1
		jmp	loc_43A512
; ---------------------------------------------------------------------------

loc_43A452:				; CODE XREF: sub_43A31D+107j
		cmp	[ebp+arg_4], 0
		jz	loc_43A500
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	loc_43A500
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		sar	al, 4
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_43A4B3
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 30h
		jmp	short loc_43A4BF
; ---------------------------------------------------------------------------

loc_43A4B3:				; CODE XREF: sub_43A31D+186j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 57h

loc_43A4BF:				; CODE XREF: sub_43A31D+194j
		mov	[edx], al
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_43A4EC
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_43A4F8
; ---------------------------------------------------------------------------

loc_43A4EC:				; CODE XREF: sub_43A31D+1BFj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 57h

loc_43A4F8:				; CODE XREF: sub_43A31D+1CDj
		mov	[edx], al
		add	[ebp+var_C], 1
		jmp	short loc_43A512
; ---------------------------------------------------------------------------

loc_43A500:				; CODE XREF: sub_43A31D+139j
					; sub_43A31D+159j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		movzx	edx, byte ptr [edx]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_43A512:				; CODE XREF: sub_43A31D+FAj
					; sub_43A31D+130j ...
		add	[ebp+arg_0], 1

loc_43A516:				; CODE XREF: sub_43A31D+C4j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_43A3E6
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]

locret_43A530:				; CODE XREF: sub_43A31D+11j
					; sub_43A31D+B8j
		leave
		retn
sub_43A31D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43A532(int, char *)
sub_43A532	proc near		; CODE XREF: sub_401C11+B20p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_10], 1 ; int
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_43A31D
		leave
		retn
sub_43A532	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_43A31D
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43A576	proc near		; CODE XREF: .text:0043A6C5p
					; sub_43A6D2+32p

var_F8		= dword	ptr -0F8h
var_F4		= dword	ptr -0F4h
var_DC		= dword	ptr -0DCh
var_D8		= dword	ptr -0D8h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 0F4h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		mov	[ebp+eax*4+var_D8], edx
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_DC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_DC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_43A60F
; ---------------------------------------------------------------------------

loc_43A5C2:				; CODE XREF: sub_43A576+BAj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		mov	[ebp+var_DC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_DC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		cmp	[ebp+var_C], 2Eh
		jbe	short loc_43A60B
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	short loc_43A68A
; ---------------------------------------------------------------------------

loc_43A60B:				; CODE XREF: sub_43A576+7Fj
		add	[ebp+var_C], 1

loc_43A60F:				; CODE XREF: sub_43A576+4Aj
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+4]
		mov	[ebp+arg_4], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_D8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		test	eax, eax
		jnz	short loc_43A5C2
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[esp+0F8h+var_F8], eax
		call	gcry_malloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_43A687
		mov	eax, [ebp+var_18]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	short loc_43A679
; ---------------------------------------------------------------------------

loc_43A659:				; CODE XREF: sub_43A576+10Fj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		mov	[esp+0F8h+var_F4], eax
		mov	eax, [ebp+var_14]
		mov	[esp+0F8h+var_F8], eax
		call	sub_43A1E9
		mov	[ebp+var_14], eax
		add	[ebp+var_C], 1

loc_43A679:				; CODE XREF: sub_43A576+E1j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		test	eax, eax
		jnz	short loc_43A659

loc_43A687:				; CODE XREF: sub_43A576+D2j
		mov	eax, [ebp+var_18]

loc_43A68A:				; CODE XREF: sub_43A576+93j
		add	esp, 0F4h
		pop	edi
		pop	ebp
		retn
sub_43A576	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_43A6B0
		mov	dword ptr [esp], offset	word_44E7DE
		call	gcry_strdup
		mov	[ebp-0Ch], eax
		jmp	short loc_43A6CD
; ---------------------------------------------------------------------------

loc_43A6B0:				; CODE XREF: .text:0043A69Dj
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_43A576
		mov	[ebp-0Ch], eax

loc_43A6CD:				; CODE XREF: .text:0043A6AEj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43A6D2	proc near		; CODE XREF: sub_4264B7+3Fp
					; sub_4266D1+1Ep ...

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_43A6EF
		mov	[esp+28h+Str], offset word_44E7DE
		call	gcry_xstrdup
		mov	[ebp+var_C], eax
		jmp	short loc_43A70C
; ---------------------------------------------------------------------------

loc_43A6EF:				; CODE XREF: sub_43A6D2+Aj
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Size],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_43A576
		mov	[ebp+var_C], eax

loc_43A70C:				; CODE XREF: sub_43A6D2+1Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_43A780
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_43A74B
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aFatalTooManyAr ; "\nfatal:	too many args for xstrconcat\n"
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 25h ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		jmp	short loc_43A774
; ---------------------------------------------------------------------------

loc_43A74B:				; CODE XREF: sub_43A6D2+4Cj
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aFatalOutOfMemo ; "\nfatal:	out of memory\n"
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 16h ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite

loc_43A774:				; CODE XREF: sub_43A6D2+77j
		mov	[esp+28h+Str], 2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_43A780:				; CODE XREF: sub_43A6D2+3Ej
		mov	eax, [ebp+var_C]
		leave
		retn
sub_43A6D2	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43A788(char *)
sub_43A788	proc near		; CODE XREF: sub_43B952+1Dp
					; .text:0043C2ACp

VarName		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_12		= word ptr -12h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+VarName], offset aLc_all ; "LC_ALL"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_43A7B5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43A7B5
		mov	eax, [ebp+var_C]
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A7B5:				; CODE XREF: sub_43A788+19j
					; sub_43A788+23j
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+VarName], eax ; VarName
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_43A7DB
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43A7DB
		mov	eax, [ebp+var_C]
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A7DB:				; CODE XREF: sub_43A788+3Fj
					; sub_43A788+49j
		mov	[esp+38h+VarName], offset aLang	; "LANG"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_43A802
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43A802
		mov	eax, [ebp+var_C]
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A802:				; CODE XREF: sub_43A788+66j
					; sub_43A788+70j
		mov	eax, ds:GetThreadLocale
		call	eax ; GetThreadLocale
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_12], ax
		movzx	eax, [ebp+var_12]
		and	eax, 3FFh
		mov	[ebp+var_18], eax
		movzx	eax, [ebp+var_12]
		shr	ax, 0Ah
		movzx	eax, ax
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_18], 79h ; switch 122 cases
		ja	loc_43B2C8	; jumptable 0043A844 default case
		mov	eax, [ebp+var_18]
		shl	eax, 2
		add	eax, offset off_44ED98
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_43A846:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aAf_za ; jumptable 0043A844	case 54
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A850:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aSq_al ; jumptable 0043A844	case 28
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A85A:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aAm_et ; jumptable 0043A844	case 94
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A864:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		cmp	[ebp+var_1C], 10h ; jumptable 0043A844 case 1
		ja	loc_43A91D	; jumptable 0043A87B default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_44EF80
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_43A87D:				; CODE XREF: sub_43A788+F3j
					; DATA XREF: .rdata:off_44EF80o
		mov	eax, offset aAr_sa ; jumptable 0043A87B	case 1
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A887:				; CODE XREF: sub_43A788+F3j
					; DATA XREF: .rdata:off_44EF80o
		mov	eax, offset aAr_iq ; jumptable 0043A87B	case 2
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A891:				; CODE XREF: sub_43A788+F3j
					; DATA XREF: .rdata:off_44EF80o
		mov	eax, offset aAr_eg ; jumptable 0043A87B	case 3
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A89B:				; CODE XREF: sub_43A788+F3j
					; DATA XREF: .rdata:off_44EF80o
		mov	eax, offset aAr_ly ; jumptable 0043A87B	case 4
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A8A5:				; CODE XREF: sub_43A788+F3j
					; DATA XREF: .rdata:off_44EF80o
		mov	eax, offset aAr_dz ; jumptable 0043A87B	case 5
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A8AF:				; CODE XREF: sub_43A788+F3j
					; DATA XREF: .rdata:off_44EF80o
		mov	eax, offset aAr_ma ; jumptable 0043A87B	case 6
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A8B9:				; CODE XREF: sub_43A788+F3j
					; DATA XREF: .rdata:off_44EF80o
		mov	eax, offset aAr_tn ; jumptable 0043A87B	case 7
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A8C3:				; CODE XREF: sub_43A788+F3j
					; DATA XREF: .rdata:off_44EF80o
		mov	eax, offset aAr_om ; jumptable 0043A87B	case 8
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A8CD:				; CODE XREF: sub_43A788+F3j
					; DATA XREF: .rdata:off_44EF80o
		mov	eax, offset aAr_ye ; jumptable 0043A87B	case 9
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A8D7:				; CODE XREF: sub_43A788+F3j
					; DATA XREF: .rdata:off_44EF80o
		mov	eax, offset aAr_sy ; jumptable 0043A87B	case 10
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A8E1:				; CODE XREF: sub_43A788+F3j
					; DATA XREF: .rdata:off_44EF80o
		mov	eax, offset aAr_jo ; jumptable 0043A87B	case 11
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A8EB:				; CODE XREF: sub_43A788+F3j
					; DATA XREF: .rdata:off_44EF80o
		mov	eax, offset aAr_lb ; jumptable 0043A87B	case 12
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A8F5:				; CODE XREF: sub_43A788+F3j
					; DATA XREF: .rdata:off_44EF80o
		mov	eax, offset aAr_kw ; jumptable 0043A87B	case 13
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A8FF:				; CODE XREF: sub_43A788+F3j
					; DATA XREF: .rdata:off_44EF80o
		mov	eax, offset aAr_ae ; jumptable 0043A87B	case 14
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A909:				; CODE XREF: sub_43A788+F3j
					; DATA XREF: .rdata:off_44EF80o
		mov	eax, offset aAr_bh ; jumptable 0043A87B	case 15
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A913:				; CODE XREF: sub_43A788+F3j
					; DATA XREF: .rdata:off_44EF80o
		mov	eax, offset aAr_qa ; jumptable 0043A87B	case 16
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A91D:				; CODE XREF: sub_43A788+E0j
					; sub_43A788+F3j
					; DATA XREF: ...
		mov	eax, offset aAr	; jumptable 0043A87B default case
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A927:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aHy_am ; jumptable 0043A844	case 43
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A931:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aAs_in ; jumptable 0043A844	case 77
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A93B:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, [ebp+var_1C] ; jumptable 0043A844 case 44
		cmp	eax, 1
		jz	short loc_43A94A
		cmp	eax, 2
		jz	short loc_43A954
		jmp	short loc_43A95E
; ---------------------------------------------------------------------------

loc_43A94A:				; CODE XREF: sub_43A788+1B9j
		mov	eax, offset aAz_az@latin ; "az_AZ@latin"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A954:				; CODE XREF: sub_43A788+1BEj
		mov	eax, offset aAz_az@cyrillic ; "az_AZ@cyrillic"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A95E:				; CODE XREF: sub_43A788+1C0j
		mov	eax, offset aAz	; "az"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A968:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aEu	; jumptable 0043A844 case 45
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A972:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aBe_by ; jumptable 0043A844	case 35
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A97C:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, [ebp+var_1C] ; jumptable 0043A844 case 69
		cmp	eax, 1
		jz	short loc_43A98B
		cmp	eax, 2
		jz	short loc_43A995
		jmp	short loc_43A99F
; ---------------------------------------------------------------------------

loc_43A98B:				; CODE XREF: sub_43A788+1FAj
		mov	eax, offset aBn_in ; "bn_IN"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A995:				; CODE XREF: sub_43A788+1FFj
		mov	eax, offset aBn_bd ; "bn_BD"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A99F:				; CODE XREF: sub_43A788+201j
		mov	eax, offset aBn	; "bn"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A9A9:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aBg_bg ; jumptable 0043A844	case 2
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A9B3:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aMy_mm ; jumptable 0043A844	case 85
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A9BD:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aKm_kh ; jumptable 0043A844	case 83
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A9C7:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aCa_es ; jumptable 0043A844	case 3
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A9D1:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aChr_us ; jumptable	0043A844 case 92
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A9DB:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		cmp	[ebp+var_1C], 5	; jumptable 0043A844 case 4
		ja	short loc_43AA22 ; jumptable 0043A9EE default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_44EFC4
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_43A9F0:				; CODE XREF: sub_43A788+266j
					; DATA XREF: .rdata:off_44EFC4o
		mov	eax, offset aZh_tw ; jumptable 0043A9EE	case 1
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43A9FA:				; CODE XREF: sub_43A788+266j
					; DATA XREF: .rdata:off_44EFC4o
		mov	eax, offset aZh_cn ; jumptable 0043A9EE	case 2
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AA04:				; CODE XREF: sub_43A788+266j
					; DATA XREF: .rdata:off_44EFC4o
		mov	eax, offset aZh_hk ; jumptable 0043A9EE	case 3
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AA0E:				; CODE XREF: sub_43A788+266j
					; DATA XREF: .rdata:off_44EFC4o
		mov	eax, offset aZh_sg ; jumptable 0043A9EE	case 4
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AA18:				; CODE XREF: sub_43A788+266j
					; DATA XREF: .rdata:off_44EFC4o
		mov	eax, offset aZh_mo ; jumptable 0043A9EE	case 5
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AA22:				; CODE XREF: sub_43A788+257j
					; sub_43A788+266j
					; DATA XREF: ...
		mov	eax, offset aZh	; jumptable 0043A9EE default case
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AA2C:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, [ebp+var_1C] ; jumptable 0043A844 case 26
		cmp	eax, 2
		jz	short loc_43AA48
		cmp	eax, 3
		jz	short loc_43AA52
		cmp	eax, 1
		jnz	short loc_43AA5C
		mov	eax, offset aHr_hr ; "hr_HR"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AA48:				; CODE XREF: sub_43A788+2AAj
		mov	eax, offset aSr_cs ; "sr_CS"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AA52:				; CODE XREF: sub_43A788+2AFj
		mov	eax, offset aSr_cs@cyrillic ; "sr_CS@cyrillic"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AA5C:				; CODE XREF: sub_43A788+2B4j
		mov	eax, offset aHr	; "hr"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AA66:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aCs_cz ; jumptable 0043A844	case 5
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AA70:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aDa_dk ; jumptable 0043A844	case 6
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AA7A:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aDiv_mv ; jumptable	0043A844 case 101
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AA84:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, [ebp+var_1C] ; jumptable 0043A844 case 19
		cmp	eax, 1
		jz	short loc_43AA93
		cmp	eax, 2
		jz	short loc_43AA9D
		jmp	short loc_43AAA7
; ---------------------------------------------------------------------------

loc_43AA93:				; CODE XREF: sub_43A788+302j
		mov	eax, offset aNl_nl ; "nl_NL"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AA9D:				; CODE XREF: sub_43A788+307j
		mov	eax, offset aNl_be ; "nl_BE"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AAA7:				; CODE XREF: sub_43A788+309j
		mov	eax, offset aNl	; "nl"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AAB1:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aBin_ng ; jumptable	0043A844 case 102
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AABB:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		cmp	[ebp+var_1C], 12h ; jumptable 0043A844 case 9
		ja	loc_43AB88	; jumptable 0043AAD2 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_44EFDC
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_43AAD4:				; CODE XREF: sub_43A788+34Aj
					; DATA XREF: .rdata:off_44EFDCo
		mov	eax, offset aEn_us ; jumptable 0043AAD2	case 1
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AADE:				; CODE XREF: sub_43A788+34Aj
					; DATA XREF: .rdata:off_44EFDCo
		mov	eax, offset aEn_gb ; jumptable 0043AAD2	case 2
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AAE8:				; CODE XREF: sub_43A788+34Aj
					; DATA XREF: .rdata:off_44EFDCo
		mov	eax, offset aEn_au ; jumptable 0043AAD2	case 3
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AAF2:				; CODE XREF: sub_43A788+34Aj
					; DATA XREF: .rdata:off_44EFDCo
		mov	eax, offset aEn_ca ; jumptable 0043AAD2	case 4
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AAFC:				; CODE XREF: sub_43A788+34Aj
					; DATA XREF: .rdata:off_44EFDCo
		mov	eax, offset aEn_nz ; jumptable 0043AAD2	case 5
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AB06:				; CODE XREF: sub_43A788+34Aj
					; DATA XREF: .rdata:off_44EFDCo
		mov	eax, offset aEn_ie ; jumptable 0043AAD2	case 6
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AB10:				; CODE XREF: sub_43A788+34Aj
					; DATA XREF: .rdata:off_44EFDCo
		mov	eax, offset aEn_za ; jumptable 0043AAD2	case 7
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AB1A:				; CODE XREF: sub_43A788+34Aj
					; DATA XREF: .rdata:off_44EFDCo
		mov	eax, offset aEn_jm ; jumptable 0043AAD2	case 8
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AB24:				; CODE XREF: sub_43A788+34Aj
					; DATA XREF: .rdata:off_44EFDCo
		mov	eax, offset aEn_gd ; jumptable 0043AAD2	case 9
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AB2E:				; CODE XREF: sub_43A788+34Aj
					; DATA XREF: .rdata:off_44EFDCo
		mov	eax, offset aEn_bz ; jumptable 0043AAD2	case 10
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AB38:				; CODE XREF: sub_43A788+34Aj
					; DATA XREF: .rdata:off_44EFDCo
		mov	eax, offset aEn_tt ; jumptable 0043AAD2	case 11
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AB42:				; CODE XREF: sub_43A788+34Aj
					; DATA XREF: .rdata:off_44EFDCo
		mov	eax, offset aEn_zw ; jumptable 0043AAD2	case 12
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AB4C:				; CODE XREF: sub_43A788+34Aj
					; DATA XREF: .rdata:off_44EFDCo
		mov	eax, offset aEn_ph ; jumptable 0043AAD2	case 13
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AB56:				; CODE XREF: sub_43A788+34Aj
					; DATA XREF: .rdata:off_44EFDCo
		mov	eax, offset aEn_id ; jumptable 0043AAD2	case 14
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AB60:				; CODE XREF: sub_43A788+34Aj
					; DATA XREF: .rdata:off_44EFDCo
		mov	eax, offset aEn_hk ; jumptable 0043AAD2	case 15
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AB6A:				; CODE XREF: sub_43A788+34Aj
					; DATA XREF: .rdata:off_44EFDCo
		mov	eax, offset aEn_in ; jumptable 0043AAD2	case 16
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AB74:				; CODE XREF: sub_43A788+34Aj
					; DATA XREF: .rdata:off_44EFDCo
		mov	eax, offset aEn_my ; jumptable 0043AAD2	case 17
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AB7E:				; CODE XREF: sub_43A788+34Aj
					; DATA XREF: .rdata:off_44EFDCo
		mov	eax, offset aEn_sg ; jumptable 0043AAD2	case 18
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AB88:				; CODE XREF: sub_43A788+337j
					; sub_43A788+34Aj
					; DATA XREF: ...
		mov	eax, offset aEn	; jumptable 0043AAD2 default case
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AB92:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aEt_ee ; jumptable 0043A844	case 37
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AB9C:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aFo_fo ; jumptable 0043A844	case 56
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43ABA6:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aFa_ir ; jumptable 0043A844	case 41
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43ABB0:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aFi_fi ; jumptable 0043A844	case 11
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43ABBA:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		cmp	[ebp+var_1C], 0Fh ; jumptable 0043A844 case 12
		ja	loc_43AC69	; jumptable 0043ABD1 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_44F028
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_43ABD3:				; CODE XREF: sub_43A788+449j
					; DATA XREF: .rdata:off_44F028o
		mov	eax, offset aFr_fr ; jumptable 0043ABD1	case 1
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43ABDD:				; CODE XREF: sub_43A788+449j
					; DATA XREF: .rdata:off_44F028o
		mov	eax, offset aFr_be ; jumptable 0043ABD1	case 2
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43ABE7:				; CODE XREF: sub_43A788+449j
					; DATA XREF: .rdata:off_44F028o
		mov	eax, offset aFr_ca ; jumptable 0043ABD1	case 3
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43ABF1:				; CODE XREF: sub_43A788+449j
					; DATA XREF: .rdata:off_44F028o
		mov	eax, offset aFr_ch ; jumptable 0043ABD1	case 4
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43ABFB:				; CODE XREF: sub_43A788+449j
					; DATA XREF: .rdata:off_44F028o
		mov	eax, offset aFr_lu ; jumptable 0043ABD1	case 5
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AC05:				; CODE XREF: sub_43A788+449j
					; DATA XREF: .rdata:off_44F028o
		mov	eax, offset aFr_mc ; jumptable 0043ABD1	case 6
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AC0F:				; CODE XREF: sub_43A788+449j
					; DATA XREF: .rdata:off_44F028o
		mov	eax, offset aFr	; jumptable 0043ABD1 case 7
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AC19:				; CODE XREF: sub_43A788+449j
					; DATA XREF: .rdata:off_44F028o
		mov	eax, offset aFr_re ; jumptable 0043ABD1	case 8
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AC23:				; CODE XREF: sub_43A788+449j
					; DATA XREF: .rdata:off_44F028o
		mov	eax, offset aFr_cg ; jumptable 0043ABD1	case 9
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AC2D:				; CODE XREF: sub_43A788+449j
					; DATA XREF: .rdata:off_44F028o
		mov	eax, offset aFr_sn ; jumptable 0043ABD1	case 10
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AC37:				; CODE XREF: sub_43A788+449j
					; DATA XREF: .rdata:off_44F028o
		mov	eax, offset aFr_cm ; jumptable 0043ABD1	case 11
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AC41:				; CODE XREF: sub_43A788+449j
					; DATA XREF: .rdata:off_44F028o
		mov	eax, offset aFr_ci ; jumptable 0043ABD1	case 12
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AC4B:				; CODE XREF: sub_43A788+449j
					; DATA XREF: .rdata:off_44F028o
		mov	eax, offset aFr_ml ; jumptable 0043ABD1	case 13
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AC55:				; CODE XREF: sub_43A788+449j
					; DATA XREF: .rdata:off_44F028o
		mov	eax, offset aFr_ma ; jumptable 0043ABD1	case 14
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AC5F:				; CODE XREF: sub_43A788+449j
					; DATA XREF: .rdata:off_44F028o
		mov	eax, offset aFr_ht ; jumptable 0043ABD1	case 15
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AC69:				; CODE XREF: sub_43A788+436j
					; sub_43A788+449j
					; DATA XREF: ...
		mov	eax, offset aFr	; jumptable 0043ABD1 default case
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AC73:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aFy_nl ; jumptable 0043A844	case 98
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AC7D:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aFul_ng ; jumptable	0043A844 case 103
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AC87:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, [ebp+var_1C] ; jumptable 0043A844 case 60
		cmp	eax, 1
		jz	short loc_43AC96
		cmp	eax, 2
		jz	short loc_43ACA0
		jmp	short loc_43ACAA
; ---------------------------------------------------------------------------

loc_43AC96:				; CODE XREF: sub_43A788+505j
		mov	eax, offset aGd_gb ; "gd_GB"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43ACA0:				; CODE XREF: sub_43A788+50Aj
		mov	eax, offset aGa_ie ; "ga_IE"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43ACAA:				; CODE XREF: sub_43A788+50Cj
		mov	eax, offset aC	; "C"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43ACB4:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aGl_es ; jumptable 0043A844	case 86
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43ACBE:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aKa_ge ; jumptable 0043A844	case 55
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43ACC8:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		cmp	[ebp+var_1C], 5	; jumptable 0043A844 case 7
		ja	short loc_43AD0F ; jumptable 0043ACDB default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_44F068
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_43ACDD:				; CODE XREF: sub_43A788+553j
					; DATA XREF: .rdata:off_44F068o
		mov	eax, offset aDe_de ; jumptable 0043ACDB	case 1
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43ACE7:				; CODE XREF: sub_43A788+553j
					; DATA XREF: .rdata:off_44F068o
		mov	eax, offset aDe_ch ; jumptable 0043ACDB	case 2
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43ACF1:				; CODE XREF: sub_43A788+553j
					; DATA XREF: .rdata:off_44F068o
		mov	eax, offset aDe_at ; jumptable 0043ACDB	case 3
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43ACFB:				; CODE XREF: sub_43A788+553j
					; DATA XREF: .rdata:off_44F068o
		mov	eax, offset aDe_lu ; jumptable 0043ACDB	case 4
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AD05:				; CODE XREF: sub_43A788+553j
					; DATA XREF: .rdata:off_44F068o
		mov	eax, offset aDe_li ; jumptable 0043ACDB	case 5
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AD0F:				; CODE XREF: sub_43A788+544j
					; sub_43A788+553j
					; DATA XREF: ...
		mov	eax, offset aDe	; jumptable 0043ACDB default case
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AD19:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aEl_gr ; jumptable 0043A844	case 8
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AD23:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aGn_py ; jumptable 0043A844	case 116
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AD2D:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aGu_in ; jumptable 0043A844	case 71
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AD37:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aHa_ng ; jumptable 0043A844	case 104
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AD41:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aCpe_us ; jumptable	0043A844 case 117
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AD4B:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aHe_il ; jumptable 0043A844	case 13
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AD55:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aHi_in ; jumptable 0043A844	case 57
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AD5F:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aHu_hu ; jumptable 0043A844	case 14
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AD69:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aNic_ng ; jumptable	0043A844 case 105
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AD73:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aIs_is ; jumptable 0043A844	case 15
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AD7D:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aIbo_ng ; jumptable	0043A844 case 112
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AD87:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aId_id ; jumptable 0043A844	case 33
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AD91:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aIu_ca ; jumptable 0043A844	case 93
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AD9B:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, [ebp+var_1C] ; jumptable 0043A844 case 16
		cmp	eax, 1
		jz	short loc_43ADAA
		cmp	eax, 2
		jz	short loc_43ADB4
		jmp	short loc_43ADBE
; ---------------------------------------------------------------------------

loc_43ADAA:				; CODE XREF: sub_43A788+619j
		mov	eax, offset aIt_it ; "it_IT"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43ADB4:				; CODE XREF: sub_43A788+61Ej
		mov	eax, offset aIt_ch ; "it_CH"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43ADBE:				; CODE XREF: sub_43A788+620j
		mov	eax, offset aIt	; "it"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43ADC8:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aJa_jp ; jumptable 0043A844	case 17
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43ADD2:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aKn_in ; jumptable 0043A844	case 75
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43ADDC:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aKau_ng ; jumptable	0043A844 case 113
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43ADE6:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, [ebp+var_1C] ; jumptable 0043A844 case 96
		cmp	eax, 1
		jz	short loc_43ADF5
		cmp	eax, 2
		jz	short loc_43ADFF
		jmp	short loc_43AE09
; ---------------------------------------------------------------------------

loc_43ADF5:				; CODE XREF: sub_43A788+664j
		mov	eax, offset aKs_pk ; "ks_PK"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43ADFF:				; CODE XREF: sub_43A788+669j
		mov	eax, offset aKs_in ; "ks_IN"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AE09:				; CODE XREF: sub_43A788+66Bj
		mov	eax, offset aKs	; "ks"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AE13:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aKk_kz ; jumptable 0043A844	case 63
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AE1D:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aKok_in ; jumptable	0043A844 case 87
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AE27:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aKo_kr ; jumptable 0043A844	case 18
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AE31:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aKy_kg ; jumptable 0043A844	case 64
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AE3B:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aLo_la ; jumptable 0043A844	case 84
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AE45:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aLa_va ; jumptable 0043A844	case 118
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AE4F:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aLv_lv ; jumptable 0043A844	case 38
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AE59:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aLt_lt ; jumptable 0043A844	case 39
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AE63:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aMk_mk ; jumptable 0043A844	case 47
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AE6D:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, [ebp+var_1C] ; jumptable 0043A844 case 62
		cmp	eax, 1
		jz	short loc_43AE7C
		cmp	eax, 2
		jz	short loc_43AE86
		jmp	short loc_43AE90
; ---------------------------------------------------------------------------

loc_43AE7C:				; CODE XREF: sub_43A788+6EBj
		mov	eax, offset aMs_my ; "ms_MY"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AE86:				; CODE XREF: sub_43A788+6F0j
		mov	eax, offset aMs_bn ; "ms_BN"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AE90:				; CODE XREF: sub_43A788+6F2j
		mov	eax, offset aMs	; "ms"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AE9A:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aMl_in ; jumptable 0043A844	case 76
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AEA4:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aMt_mt ; jumptable 0043A844	case 58
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AEAE:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aMni_in ; jumptable	0043A844 case 88
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AEB8:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aMr_in ; jumptable 0043A844	case 78
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AEC2:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aMn	; jumptable 0043A844 case 80
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AECC:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, [ebp+var_1C] ; jumptable 0043A844 case 97
		cmp	eax, 1
		jz	short loc_43AEDB
		cmp	eax, 2
		jz	short loc_43AEE5
		jmp	short loc_43AEEF
; ---------------------------------------------------------------------------

loc_43AEDB:				; CODE XREF: sub_43A788+74Aj
		mov	eax, offset aNe_np ; "ne_NP"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AEE5:				; CODE XREF: sub_43A788+74Fj
		mov	eax, offset aNe_in ; "ne_IN"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AEEF:				; CODE XREF: sub_43A788+751j
		mov	eax, offset aNe	; "ne"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AEF9:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, [ebp+var_1C] ; jumptable 0043A844 case 20
		cmp	eax, 1
		jz	short loc_43AF08
		cmp	eax, 2
		jz	short loc_43AF12
		jmp	short loc_43AF1C
; ---------------------------------------------------------------------------

loc_43AF08:				; CODE XREF: sub_43A788+777j
		mov	eax, offset aNo_no ; "no_NO"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AF12:				; CODE XREF: sub_43A788+77Cj
		mov	eax, offset aNn_no ; "nn_NO"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AF1C:				; CODE XREF: sub_43A788+77Ej
		mov	eax, offset aNo_0 ; "no"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AF26:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aOr_in ; jumptable 0043A844	case 72
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AF30:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aOm_et ; jumptable 0043A844	case 114
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AF3A:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aPap_an ; jumptable	0043A844 case 121
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AF44:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aPs	; jumptable 0043A844 case 99
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AF4E:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aPl_pl ; jumptable 0043A844	case 21
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AF58:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, [ebp+var_1C] ; jumptable 0043A844 case 22
		cmp	eax, 1
		jz	short loc_43AF6F
		cmp	eax, 2
		jnz	short loc_43AF79
		mov	eax, offset aPt_pt ; "pt_PT"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AF6F:				; CODE XREF: sub_43A788+7D6j
		mov	eax, offset aPt_br ; "pt_BR"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AF79:				; CODE XREF: sub_43A788+7DBj
		mov	eax, offset aPt	; "pt"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AF83:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, [ebp+var_1C] ; jumptable 0043A844 case 70
		cmp	eax, 1
		jnz	short loc_43AF95
		mov	eax, offset aPa_in ; "pa_IN"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AF95:				; CODE XREF: sub_43A788+801j
		mov	eax, offset aPa	; "pa"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AF9F:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aRm_ch ; jumptable 0043A844	case 23
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AFA9:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, [ebp+var_1C] ; jumptable 0043A844 case 24
		cmp	eax, 1
		jnz	short loc_43AFBB
		mov	eax, offset aRo_ro ; "ro_RO"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AFBB:				; CODE XREF: sub_43A788+827j
		mov	eax, offset aRo	; "ro"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AFC5:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aRu	; jumptable 0043A844 case 25
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AFCF:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aSe_no ; jumptable 0043A844	case 59
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AFD9:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aSa_in ; jumptable 0043A844	case 79
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AFE3:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, [ebp+var_1C] ; jumptable 0043A844 case 89
		test	eax, eax
		jz	short loc_43AFF1
		cmp	eax, 1
		jz	short loc_43AFFB
		jmp	short loc_43B005
; ---------------------------------------------------------------------------

loc_43AFF1:				; CODE XREF: sub_43A788+860j
		mov	eax, offset aSd_in ; "sd_IN"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43AFFB:				; CODE XREF: sub_43A788+865j
		mov	eax, offset aSd_pk ; "sd_PK"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B005:				; CODE XREF: sub_43A788+867j
		mov	eax, offset aSd	; "sd"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B00F:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aSi_lk ; jumptable 0043A844	case 91
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B019:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aSk_sk ; jumptable 0043A844	case 27
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B023:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aSl_si ; jumptable 0043A844	case 36
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B02D:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aSo_so ; jumptable 0043A844	case 119
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B037:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aWen_de ; jumptable	0043A844 case 46
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B041:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		cmp	[ebp+var_1C], 14h ; jumptable 0043A844 case 10
		ja	loc_43B122	; jumptable 0043B058 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_44F080
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_43B05A:				; CODE XREF: sub_43A788+8D0j
					; DATA XREF: .rdata:off_44F080o
		mov	eax, offset aEs_es ; jumptable 0043B058	case 1
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B064:				; CODE XREF: sub_43A788+8D0j
					; DATA XREF: .rdata:off_44F080o
		mov	eax, offset aEs_mx ; jumptable 0043B058	case 2
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B06E:				; CODE XREF: sub_43A788+8D0j
					; DATA XREF: .rdata:off_44F080o
		mov	eax, offset aEs_es@modern ; jumptable 0043B058 case 3
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B078:				; CODE XREF: sub_43A788+8D0j
					; DATA XREF: .rdata:off_44F080o
		mov	eax, offset aEs_gt ; jumptable 0043B058	case 4
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B082:				; CODE XREF: sub_43A788+8D0j
					; DATA XREF: .rdata:off_44F080o
		mov	eax, offset aEs_cr ; jumptable 0043B058	case 5
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B08C:				; CODE XREF: sub_43A788+8D0j
					; DATA XREF: .rdata:off_44F080o
		mov	eax, offset aEs_pa ; jumptable 0043B058	case 6
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B096:				; CODE XREF: sub_43A788+8D0j
					; DATA XREF: .rdata:off_44F080o
		mov	eax, offset aEs_do ; jumptable 0043B058	case 7
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B0A0:				; CODE XREF: sub_43A788+8D0j
					; DATA XREF: .rdata:off_44F080o
		mov	eax, offset aEs_ve ; jumptable 0043B058	case 8
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B0AA:				; CODE XREF: sub_43A788+8D0j
					; DATA XREF: .rdata:off_44F080o
		mov	eax, offset aEs_co ; jumptable 0043B058	case 9
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B0B4:				; CODE XREF: sub_43A788+8D0j
					; DATA XREF: .rdata:off_44F080o
		mov	eax, offset aEs_pe ; jumptable 0043B058	case 10
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B0BE:				; CODE XREF: sub_43A788+8D0j
					; DATA XREF: .rdata:off_44F080o
		mov	eax, offset aEs_ar ; jumptable 0043B058	case 11
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B0C8:				; CODE XREF: sub_43A788+8D0j
					; DATA XREF: .rdata:off_44F080o
		mov	eax, offset aEs_ec ; jumptable 0043B058	case 12
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B0D2:				; CODE XREF: sub_43A788+8D0j
					; DATA XREF: .rdata:off_44F080o
		mov	eax, offset aEs_cl ; jumptable 0043B058	case 13
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B0DC:				; CODE XREF: sub_43A788+8D0j
					; DATA XREF: .rdata:off_44F080o
		mov	eax, offset aEs_uy ; jumptable 0043B058	case 14
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B0E6:				; CODE XREF: sub_43A788+8D0j
					; DATA XREF: .rdata:off_44F080o
		mov	eax, offset aEs_py ; jumptable 0043B058	case 15
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B0F0:				; CODE XREF: sub_43A788+8D0j
					; DATA XREF: .rdata:off_44F080o
		mov	eax, offset aEs_bo ; jumptable 0043B058	case 16
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B0FA:				; CODE XREF: sub_43A788+8D0j
					; DATA XREF: .rdata:off_44F080o
		mov	eax, offset aEs_sv ; jumptable 0043B058	case 17
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B104:				; CODE XREF: sub_43A788+8D0j
					; DATA XREF: .rdata:off_44F080o
		mov	eax, offset aEs_hn ; jumptable 0043B058	case 18
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B10E:				; CODE XREF: sub_43A788+8D0j
					; DATA XREF: .rdata:off_44F080o
		mov	eax, offset aEs_ni ; jumptable 0043B058	case 19
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B118:				; CODE XREF: sub_43A788+8D0j
					; DATA XREF: .rdata:off_44F080o
		mov	eax, offset aEs_pr ; jumptable 0043B058	case 20
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B122:				; CODE XREF: sub_43A788+8BDj
					; sub_43A788+8D0j
					; DATA XREF: ...
		mov	eax, offset aEs	; jumptable 0043B058 default case
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B12C:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aBnt_tz ; jumptable	0043A844 case 48
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B136:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aSw_ke ; jumptable 0043A844	case 65
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B140:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, [ebp+var_1C] ; jumptable 0043A844 case 29
		cmp	eax, 1
		jz	short loc_43B14F
		cmp	eax, 2
		jz	short loc_43B159
		jmp	short loc_43B163
; ---------------------------------------------------------------------------

loc_43B14F:				; CODE XREF: sub_43A788+9BEj
		mov	eax, offset aSv_se ; "sv_SE"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B159:				; CODE XREF: sub_43A788+9C3j
		mov	eax, offset aSv_fi ; "sv_FI"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B163:				; CODE XREF: sub_43A788+9C5j
		mov	eax, offset aSv	; "sv"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B16D:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aSyr_tr ; jumptable	0043A844 case 90
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B177:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aTl_ph ; jumptable 0043A844	case 100
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B181:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aTg_tj ; jumptable 0043A844	case 40
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B18B:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, [ebp+var_1C] ; jumptable 0043A844 case 95
		cmp	eax, 1
		jz	short loc_43B19A
		cmp	eax, 2
		jz	short loc_43B1A4
		jmp	short loc_43B1AE
; ---------------------------------------------------------------------------

loc_43B19A:				; CODE XREF: sub_43A788+A09j
		mov	eax, offset aBer_ma@arabic ; "ber_MA@arabic"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B1A4:				; CODE XREF: sub_43A788+A0Ej
		mov	eax, offset aBer_ma@latin ; "ber_MA@latin"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B1AE:				; CODE XREF: sub_43A788+A10j
		mov	eax, offset aBer_ma ; "ber_MA"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B1B8:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aTa	; jumptable 0043A844 case 73
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B1C2:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aTt_ru ; jumptable 0043A844	case 68
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B1CC:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aTe_in ; jumptable 0043A844	case 74
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B1D6:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aTh_th ; jumptable 0043A844	case 30
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B1E0:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aBo_cn ; jumptable 0043A844	case 81
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B1EA:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, [ebp+var_1C] ; jumptable 0043A844 case 115
		test	eax, eax
		jz	short loc_43B1F8
		cmp	eax, 1
		jz	short loc_43B202
		jmp	short loc_43B20C
; ---------------------------------------------------------------------------

loc_43B1F8:				; CODE XREF: sub_43A788+A67j
		mov	eax, offset aTi_et ; "ti_ET"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B202:				; CODE XREF: sub_43A788+A6Cj
		mov	eax, offset aTi_er ; "ti_ER"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B20C:				; CODE XREF: sub_43A788+A6Ej
		mov	eax, offset aTi	; "ti"
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B216:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aTs_za ; jumptable 0043A844	case 49
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B220:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aTn_bw ; jumptable 0043A844	case 50
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B22A:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aTr_tr ; jumptable 0043A844	case 31
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B234:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aTk_tm ; jumptable 0043A844	case 66
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B23E:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aUk_ua ; jumptable 0043A844	case 34
		jmp	locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B248:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, [ebp+var_1C] ; jumptable 0043A844 case 32
		cmp	eax, 1
		jz	short loc_43B257
		cmp	eax, 2
		jz	short loc_43B25E
		jmp	short loc_43B265
; ---------------------------------------------------------------------------

loc_43B257:				; CODE XREF: sub_43A788+AC6j
		mov	eax, offset aUr_pk ; "ur_PK"
		jmp	short locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B25E:				; CODE XREF: sub_43A788+ACBj
		mov	eax, offset aUr_in ; "ur_IN"
		jmp	short locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B265:				; CODE XREF: sub_43A788+ACDj
		mov	eax, offset aUr	; "ur"
		jmp	short locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B26C:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, [ebp+var_1C] ; jumptable 0043A844 case 67
		cmp	eax, 1
		jz	short loc_43B27B
		cmp	eax, 2
		jz	short loc_43B282
		jmp	short loc_43B289
; ---------------------------------------------------------------------------

loc_43B27B:				; CODE XREF: sub_43A788+AEAj
		mov	eax, offset aUz_uz ; "uz_UZ"
		jmp	short locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B282:				; CODE XREF: sub_43A788+AEFj
		mov	eax, offset aUz_uz@cyrillic ; "uz_UZ@cyrillic"
		jmp	short locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B289:				; CODE XREF: sub_43A788+AF1j
		mov	eax, offset aUz	; "uz"
		jmp	short locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B290:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aVen_za ; jumptable	0043A844 case 51
		jmp	short locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B297:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aVi_vn ; jumptable 0043A844	case 42
		jmp	short locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B29E:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aCy_gb ; jumptable 0043A844	case 82
		jmp	short locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B2A5:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aXh_za ; jumptable 0043A844	case 52
		jmp	short locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B2AC:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aSit_cn ; jumptable	0043A844 case 120
		jmp	short locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B2B3:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aYi_il ; jumptable 0043A844	case 61
		jmp	short locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B2BA:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aYo_ng ; jumptable 0043A844	case 106
		jmp	short locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B2C1:				; CODE XREF: sub_43A788+BCj
					; DATA XREF: .rdata:off_44ED98o
		mov	eax, offset aZu_za ; jumptable 0043A844	case 53
		jmp	short locret_43B2CD
; ---------------------------------------------------------------------------

loc_43B2C8:				; CODE XREF: sub_43A788+A9j
					; sub_43A788+BCj
					; DATA XREF: ...
		mov	eax, offset aC	; jumptable 0043A844 default case

locret_43B2CD:				; CODE XREF: sub_43A788+28j
					; sub_43A788+4Ej ...
		leave
		retn
sub_43A788	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43B2CF	proc near		; CODE XREF: sub_43B3AE+1EAp
					; sub_43B3AE+212p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_0]
		and	eax, 0FF00h
		shl	eax, 8
		or	edx, eax
		mov	eax, [ebp+arg_0]
		shr	eax, 8
		and	eax, 0FF00h
		or	edx, eax
		mov	eax, [ebp+arg_0]
		shr	eax, 18h
		or	eax, edx
		pop	ebp
		retn
sub_43B2CF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43B2FE	proc near		; CODE XREF: sub_43BF7D+5Fp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	[ebp+var_4], 0
		jmp	short loc_43B347
; ---------------------------------------------------------------------------

loc_43B313:				; CODE XREF: sub_43B2FE+51j
		shl	[ebp+var_4], 4
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		add	[ebp+var_4], eax
		add	[ebp+var_8], 1
		mov	eax, [ebp+var_4]
		and	eax, 0F0000000h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_43B347
		mov	eax, [ebp+var_C]
		shr	eax, 18h
		xor	[ebp+var_4], eax
		mov	eax, [ebp+var_C]
		xor	[ebp+var_4], eax

loc_43B347:				; CODE XREF: sub_43B2FE+13j
					; sub_43B2FE+38j
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43B313
		mov	eax, [ebp+var_4]
		leave
		retn
sub_43B2FE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43B356	proc near		; CODE XREF: sub_43B952+243p

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_C], eax
		jmp	short loc_43B39B
; ---------------------------------------------------------------------------

loc_43B382:				; CODE XREF: sub_43B356+49j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_43B39B:				; CODE XREF: sub_43B356+2Aj
		cmp	[ebp+var_C], 0
		jnz	short loc_43B382
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		leave
		retn
sub_43B356	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43B3AE(char *)
sub_43B3AE	proc near		; CODE XREF: sub_43B952+214p

Filename	= dword	ptr -68h
Mode		= dword	ptr -64h
Count		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= byte ptr -58h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
File		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
DstBuf		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 60h
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	eax, offset aRb_0 ; "rb"
		mov	[esp+68h+Mode],	eax ; Mode
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_43B3EB
		mov	eax, 0
		jmp	loc_43B6E2
; ---------------------------------------------------------------------------

loc_43B3EB:				; CODE XREF: sub_43B3AE+31j
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	_fileno
		lea	edx, [ebp+var_58]
		mov	[esp+68h+Mode],	edx
		mov	[esp+68h+Filename], eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		test	eax, eax
		jnz	short loc_43B434
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[ebp+var_20], eax
		mov	ecx, [ebp+var_20]
		mov	ebx, 0
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	esi, ebx
		xor	esi, edx
		xor	eax, ecx
		or	eax, esi
		test	eax, eax
		jnz	short loc_43B434
		cmp	[ebp+var_20], 1Bh
		ja	short loc_43B449

loc_43B434:				; CODE XREF: sub_43B3AE+5Bj
					; sub_43B3AE+7Ej
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, 0
		jmp	loc_43B6E2
; ---------------------------------------------------------------------------

loc_43B449:				; CODE XREF: sub_43B3AE+84j
		mov	eax, [ebp+var_20]
		add	eax, eax
		cmp	eax, [ebp+var_20]
		jbe	short loc_43B462
		mov	eax, [ebp+var_20]
		add	eax, eax
		mov	[esp+68h+Filename], eax
		call	gcry_malloc
		jmp	short loc_43B467
; ---------------------------------------------------------------------------

loc_43B462:				; CODE XREF: sub_43B3AE+A3j
		mov	eax, 0

loc_43B467:				; CODE XREF: sub_43B3AE+B2j
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_43B485
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, 0
		jmp	loc_43B6E2
; ---------------------------------------------------------------------------

loc_43B485:				; CODE XREF: sub_43B3AE+C0j
		mov	eax, [ebp+var_20]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+DstBuf], eax

loc_43B491:				; CODE XREF: sub_43B3AE+13Fj
		mov	eax, [ebp+DstBuf]
		mov	edx, [ebp+File]
		mov	[esp+68h+var_5C], edx ;	File
		mov	edx, [ebp+var_C]
		mov	[esp+68h+Count], edx ; Count
		mov	[esp+68h+Mode],	1 ; ElementSize
		mov	[esp+68h+Filename], eax	; DstBuf
		call	fread
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_C]
		jnb	short loc_43B4DD
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_43B6E2
; ---------------------------------------------------------------------------

loc_43B4DD:				; CODE XREF: sub_43B3AE+10Dj
		mov	eax, [ebp+var_24]
		add	[ebp+DstBuf], eax
		mov	eax, [ebp+var_24]
		sub	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_43B491
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 950412DEh
		jz	short loc_43B527
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 0DE120495h
		jz	short loc_43B527
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_43B6E2
; ---------------------------------------------------------------------------

loc_43B527:				; CODE XREF: sub_43B3AE+156j
					; sub_43B3AE+162j
		mov	[esp+68h+Mode],	28h
		mov	[esp+68h+Filename], 1
		call	gcry_calloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_43B559
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_43B6E2
; ---------------------------------------------------------------------------

loc_43B559:				; CODE XREF: sub_43B3AE+194j
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_14]
		add	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 950412DEh
		setnz	al
		movzx	edx, al
		mov	eax, [ebp+var_18]
		mov	[eax+8], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_43B59F
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[esp+68h+Filename], eax
		call	sub_43B2CF
		jmp	short loc_43B5A5
; ---------------------------------------------------------------------------

loc_43B59F:				; CODE XREF: sub_43B3AE+1DFj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]

loc_43B5A5:				; CODE XREF: sub_43B3AE+1EFj
		test	eax, eax
		jnz	loc_43B6A5
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_43B5C7
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	[esp+68h+Filename], eax
		call	sub_43B2CF
		jmp	short loc_43B5CD
; ---------------------------------------------------------------------------

loc_43B5C7:				; CODE XREF: sub_43B3AE+207j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]

loc_43B5CD:				; CODE XREF: sub_43B3AE+217j
		mov	edx, [ebp+var_18]
		mov	[edx+0Ch], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_43B5ED
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Filename], eax
		call	sub_43B2CF
		jmp	short loc_43B5F3
; ---------------------------------------------------------------------------

loc_43B5ED:				; CODE XREF: sub_43B3AE+22Dj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]

loc_43B5F3:				; CODE XREF: sub_43B3AE+23Dj
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+18h], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_43B618
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]
		mov	[esp+68h+Filename], eax
		call	sub_43B2CF
		jmp	short loc_43B61E
; ---------------------------------------------------------------------------

loc_43B618:				; CODE XREF: sub_43B3AE+258j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]

loc_43B61E:				; CODE XREF: sub_43B3AE+268j
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_43B643
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	[esp+68h+Filename], eax
		call	sub_43B2CF
		jmp	short loc_43B649
; ---------------------------------------------------------------------------

loc_43B643:				; CODE XREF: sub_43B3AE+283j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]

loc_43B649:				; CODE XREF: sub_43B3AE+293j
		mov	edx, [ebp+var_18]
		mov	[edx+20h], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_43B669
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	[esp+68h+Filename], eax
		call	sub_43B2CF
		jmp	short loc_43B66F
; ---------------------------------------------------------------------------

loc_43B669:				; CODE XREF: sub_43B3AE+2A9j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]

loc_43B66F:				; CODE XREF: sub_43B3AE+2B9j
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+24h], edx
		nop
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Mode],	4
		mov	[esp+68h+Filename], eax
		call	gcry_calloc
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_43B6DF
		jmp	short loc_43B6C2
; ---------------------------------------------------------------------------

loc_43B6A5:				; CODE XREF: sub_43B3AE+1F9j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, 0
		jmp	short loc_43B6E2
; ---------------------------------------------------------------------------

loc_43B6C2:				; CODE XREF: sub_43B3AE+2F5j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Filename], eax
		call	gcry_free
		mov	eax, 0
		jmp	short loc_43B6E2
; ---------------------------------------------------------------------------

loc_43B6DF:				; CODE XREF: sub_43B3AE+2F3j
		mov	eax, [ebp+var_18]

loc_43B6E2:				; CODE XREF: sub_43B3AE+38j
					; sub_43B3AE+96j ...
		add	esp, 60h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_43B3AE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43B6E9(LPCSTR, int, int)
sub_43B6E9	proc near		; CODE XREF: sub_43B8E0+1Ap

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpMultiByteStr	= dword	ptr -30h
cbMultiByte	= dword	ptr -2Ch
lpWideCharStr	= dword	ptr -28h
cchWideChar	= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+cchWideChar], 0 ; cchWideChar
		mov	[esp+38h+lpWideCharStr], 0 ; lpWideCharStr
		mov	[esp+38h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_43B739
		mov	eax, [ebp+var_C]
		add	eax, 1
		test	eax, eax
		jg	short loc_43B743

loc_43B739:				; CODE XREF: sub_43B6E9+44j
		mov	eax, 0
		jmp	locret_43B7E9
; ---------------------------------------------------------------------------

loc_43B743:				; CODE XREF: sub_43B6E9+4Ej
		mov	eax, [ebp+var_C]
		add	eax, 1
		add	eax, eax
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	edx, eax
		shr	edx, 1
		mov	eax, [ebp+var_C]
		add	eax, 1
		cmp	edx, eax
		jz	short loc_43B773
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0
		jmp	short locret_43B7E9
; ---------------------------------------------------------------------------

loc_43B773:				; CODE XREF: sub_43B6E9+74j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+CodePage], eax
		call	gcry_malloc
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_43B78E
		mov	eax, 0
		jmp	short locret_43B7E9
; ---------------------------------------------------------------------------

loc_43B78E:				; CODE XREF: sub_43B6E9+9Cj
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[esp+38h+cchWideChar], edx ; cchWideChar
		mov	edx, [ebp+var_14]
		mov	[esp+38h+lpWideCharStr], edx ; lpWideCharStr
		mov	[esp+38h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_43B7DE
		mov	eax, [ebp+var_14]
		mov	[esp+38h+CodePage], eax
		call	gcry_free
		mov	eax, 0
		jmp	short locret_43B7E9
; ---------------------------------------------------------------------------

loc_43B7DE:				; CODE XREF: sub_43B6E9+E1j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_14]

locret_43B7E9:				; CODE XREF: sub_43B6E9+55j
					; sub_43B6E9+88j ...
		leave
		retn
sub_43B6E9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43B7EB(LPCWSTR, int, int)
sub_43B7EB	proc near		; CODE XREF: sub_43B8E0+3Cp

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpWideCharStr	= dword	ptr -30h
cchWideChar	= dword	ptr -2Ch
lpMultiByteStr	= dword	ptr -28h
cbMultiByte	= dword	ptr -24h
lpDefaultChar	= dword	ptr -20h
lpUsedDefaultChar= dword ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	[esp+38h+cbMultiByte], 0 ; cbMultiByte
		mov	[esp+38h+lpMultiByteStr], 0 ; lpMultiByteStr
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0 ;	CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_43B84B
		mov	eax, [ebp+var_C]
		add	eax, 1
		test	eax, eax
		jg	short loc_43B855

loc_43B84B:				; CODE XREF: sub_43B7EB+54j
		mov	eax, 0
		jmp	locret_43B8DE
; ---------------------------------------------------------------------------

loc_43B855:				; CODE XREF: sub_43B7EB+5Ej
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+38h+CodePage], eax
		call	gcry_malloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_43B873
		mov	eax, 0
		jmp	short locret_43B8DE
; ---------------------------------------------------------------------------

loc_43B873:				; CODE XREF: sub_43B7EB+7Fj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	edx, [ebp+var_C]
		mov	[esp+38h+cbMultiByte], edx ; cbMultiByte
		mov	edx, [ebp+var_10]
		mov	[esp+38h+lpMultiByteStr], edx ;	lpMultiByteStr
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0 ;	CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_43B8D3
		mov	eax, [ebp+var_10]
		mov	[esp+38h+CodePage], eax
		call	gcry_free
		mov	eax, 0
		jmp	short locret_43B8DE
; ---------------------------------------------------------------------------

loc_43B8D3:				; CODE XREF: sub_43B7EB+D4j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_10]

locret_43B8DE:				; CODE XREF: sub_43B7EB+65j
					; sub_43B7EB+86j ...
		leave
		retn
sub_43B7EB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43B8E0(LPCSTR, int, int)
sub_43B8E0	proc near		; CODE XREF: sub_43BC12+12Fp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	LPCSTR
		call	sub_43B6E9
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_43B931
		mov	eax, [ebp+var_14]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_20], edx ;	int
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	LPCWSTR
		call	sub_43B7EB
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		jmp	short loc_43B938
; ---------------------------------------------------------------------------

loc_43B931:				; CODE XREF: sub_43B8E0+26j
		mov	[ebp+var_C], 0

loc_43B938:				; CODE XREF: sub_43B8E0+4Fj
		cmp	[ebp+var_C], 0
		jz	short loc_43B943
		mov	eax, [ebp+var_14]
		jmp	short loc_43B948
; ---------------------------------------------------------------------------

loc_43B943:				; CODE XREF: sub_43B8E0+5Cj
		mov	eax, 0

loc_43B948:				; CODE XREF: sub_43B8E0+61j
		mov	edx, [ebp+arg_8]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_43B8E0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43B952(char *, char *)
sub_43B952	proc near		; CODE XREF: sub_425774+16p

Dest		= dword	ptr -48h
Source		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Str		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		mov	[ebp+var_10], 0
		mov	[ebp+Str], 0
		mov	[esp+48h+Dest],	offset aLc_messages ; "LC_MESSAGES"
		call	sub_43A788
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_43B9E4
		mov	eax, [ebp+var_14]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+48h+Dest],	eax
		call	gcry_malloc
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jz	short loc_43B9E4
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	[esp+48h+Source], 5Fh ;	Val
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax ; Str
		call	strchr
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_43B9E4
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	0

loc_43B9E4:				; CODE XREF: sub_43B952+29j
					; sub_43B952+5Cj ...
		cmp	[ebp+Str], 0
		jnz	short loc_43B9F4
		mov	eax, 0
		jmp	loc_43BBA5
; ---------------------------------------------------------------------------

loc_43B9F4:				; CODE XREF: sub_43B952+96j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+Str]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	ebx, eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 12h
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Dest],	eax
		call	gcry_malloc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_43BA84
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax
		call	gcry_free
		mov	eax, 0
		jmp	loc_43BBA5
; ---------------------------------------------------------------------------

loc_43BA84:				; CODE XREF: sub_43B952+11Bj
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_24], 1
		mov	eax, [ebp+Str]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+Str]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_24], eax
		mov	edx, offset aLc_messages_0 ; "\\LC_MESSAGES\\"
		mov	eax, [ebp+var_24]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		movzx	edx, word ptr [edx+0Ch]
		mov	[eax+0Ch], dx
		add	[ebp+var_24], 0Dh
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_24], eax
		mov	edx, offset a_mo ; ".mo"
		mov	eax, [ebp+var_24]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	[esp+48h+Dest],	eax ; char *
		call	sub_43B3AE
		mov	[ebp+var_10], eax
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax
		call	gcry_free
		mov	eax, [ebp+var_20]
		mov	[esp+48h+Dest],	eax
		call	gcry_free
		mov	eax, ds:dword_451840
		test	eax, eax
		jz	short loc_43BB9A
		mov	eax, ds:dword_451840
		mov	[esp+48h+Dest],	eax
		call	sub_43B356

loc_43BB9A:				; CODE XREF: sub_43B952+239j
		mov	eax, [ebp+var_10]
		mov	ds:dword_451840, eax
		mov	eax, [ebp+arg_4]

loc_43BBA5:				; CODE XREF: sub_43B952+9Dj
					; sub_43B952+12Dj
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_43B952	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43BBAC(char *, int, int)
sub_43BBAC	proc near		; CODE XREF: sub_43BC12+35Bp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 1
		setnz	al
		movzx	eax, al
		mov	[ebp+var_C], eax
		jmp	short loc_43BC07
; ---------------------------------------------------------------------------

loc_43BBC1:				; CODE XREF: sub_43BBAC+5Fj
		mov	[esp+28h+Val], 0 ; Val
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		cmp	eax, [ebp+var_10]
		ja	short loc_43BBEE
		mov	eax, offset aErrorInGettext ; "ERROR in	GETTEXT	(bad plural entry)"
		jmp	short locret_43BC10
; ---------------------------------------------------------------------------

loc_43BBEE:				; CODE XREF: sub_43BBAC+39j
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+arg_4], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_0], eax
		sub	[ebp+var_C], 1

loc_43BC07:				; CODE XREF: sub_43BBAC+13j
		cmp	[ebp+var_C], 0
		jnz	short loc_43BBC1
		mov	eax, [ebp+arg_0]

locret_43BC10:				; CODE XREF: sub_43BBAC+40j
		leave
		retn
sub_43BBAC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43BC12	proc near		; CODE XREF: sub_43BF7D+158p
					; sub_43BF7D+27Dp

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, ds:dword_451844
		test	eax, eax
		jz	short loc_43BC9E
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_43BC4C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_43B2CF
		jmp	short loc_43BC5D
; ---------------------------------------------------------------------------

loc_43BC4C:				; CODE XREF: sub_43BC12+1Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_43BC5D:				; CODE XREF: sub_43BC12+38j
		add	eax, ebx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_43BC86
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+38h+Dst], eax
		call	sub_43B2CF
		jmp	short loc_43BC96
; ---------------------------------------------------------------------------

loc_43BC86:				; CODE XREF: sub_43BC12+58j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_43BC96:				; CODE XREF: sub_43BC12+72j
		mov	[ebp+var_14], eax
		jmp	loc_43BF4D
; ---------------------------------------------------------------------------

loc_43BC9E:				; CODE XREF: sub_43BC12+Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_43BE93
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_43BCE0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_43B2CF
		jmp	short loc_43BCF1
; ---------------------------------------------------------------------------

loc_43BCE0:				; CODE XREF: sub_43BC12+B1j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_43BCF1:				; CODE XREF: sub_43BC12+CCj
		add	eax, ebx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_43BD1A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+38h+Dst], eax
		call	sub_43B2CF
		jmp	short loc_43BD2A
; ---------------------------------------------------------------------------

loc_43BD1A:				; CODE XREF: sub_43BC12+ECj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_43BD2A:				; CODE XREF: sub_43BC12+106j
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+var_28]
		mov	[esp+38h+Size],	eax ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Src], eax ; int
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dst], eax ; LPCSTR
		call	sub_43B8E0
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_43BD62
		mov	[ebp+var_10], offset aErrorInGette_0 ; "ERROR in GETTEXT MALLOC"
		mov	[ebp+var_14], 0
		jmp	loc_43BE83
; ---------------------------------------------------------------------------

loc_43BD62:				; CODE XREF: sub_43BC12+13Bj
		mov	eax, [ebp+var_28]
		cmp	eax, [ebp+var_1C]
		ja	loc_43BDF4
		mov	eax, [ebp+var_28]
		cmp	eax, 1
		jbe	short loc_43BDF4
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_43BDA1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_43B2CF
		jmp	short loc_43BDB2
; ---------------------------------------------------------------------------

loc_43BDA1:				; CODE XREF: sub_43BC12+172j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_43BDB2:				; CODE XREF: sub_43BC12+18Dj
		add	eax, ebx
		mov	[ebp+var_24], eax
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_24]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	edx, eax
		mov	eax, [ebp+var_28]
		mov	[edx], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_14], eax
		jmp	loc_43BE83
; ---------------------------------------------------------------------------

loc_43BDF4:				; CODE XREF: sub_43BC12+156j
					; sub_43BC12+162j
		mov	eax, [ebp+var_28]
		add	eax, 10h
		mov	[esp+38h+Dst], eax
		call	gcry_malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_43BE75
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	dword ptr [eax], 1
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		jmp	short loc_43BE83
; ---------------------------------------------------------------------------

loc_43BE75:				; CODE XREF: sub_43BC12+1F7j
		mov	[ebp+var_10], offset aErrorInGette_0 ; "ERROR in GETTEXT MALLOC"
		mov	[ebp+var_14], 0

loc_43BE83:				; CODE XREF: sub_43BC12+14Bj
					; sub_43BC12+1DDj ...
		mov	eax, [ebp+var_20]
		mov	[esp+38h+Dst], eax
		call	gcry_free
		jmp	loc_43BF4D
; ---------------------------------------------------------------------------

loc_43BE93:				; CODE XREF: sub_43BC12+9Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		cmp	eax, 1
		jnz	short loc_43BEF9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_C], eax
		jmp	short loc_43BEC6
; ---------------------------------------------------------------------------

loc_43BEB3:				; CODE XREF: sub_43BC12+2B8j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, [ebp+arg_4]
		jz	short loc_43BECE
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_43BEC6:				; CODE XREF: sub_43BC12+29Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_43BEB3
		jmp	short loc_43BECF
; ---------------------------------------------------------------------------

loc_43BECE:				; CODE XREF: sub_43BC12+2AAj
		nop

loc_43BECF:				; CODE XREF: sub_43BC12+2BAj
		cmp	[ebp+var_C], 0
		jz	short loc_43BEE9
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		jmp	short loc_43BF4D
; ---------------------------------------------------------------------------

loc_43BEE9:				; CODE XREF: sub_43BC12+2C1j
		mov	[ebp+var_10], offset aErrorInGette_1 ; "ERROR in GETTEXT (overflow space)\n"
		mov	[ebp+var_14], 0
		jmp	short loc_43BF4D
; ---------------------------------------------------------------------------

loc_43BEF9:				; CODE XREF: sub_43BC12+294j
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_43BF24
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_43B2CF
		jmp	short loc_43BF35
; ---------------------------------------------------------------------------

loc_43BF24:				; CODE XREF: sub_43BC12+2F5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_43BF35:				; CODE XREF: sub_43BC12+310j
		add	eax, ebx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_43BF4D:				; CODE XREF: sub_43BC12+87j
					; sub_43BC12+27Cj ...
		cmp	[ebp+arg_8], 0
		jz	short loc_43BF74
		cmp	[ebp+var_14], 0
		jz	short loc_43BF74
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+Size],	eax ; int
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Src], eax ; int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax ; char *
		call	sub_43BBAC
		jmp	short loc_43BF77
; ---------------------------------------------------------------------------

loc_43BF74:				; CODE XREF: sub_43BC12+33Fj
					; sub_43BC12+345j
		mov	eax, [ebp+var_10]

loc_43BF77:				; CODE XREF: sub_43BC12+360j
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_43BC12	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43BF7D(char *, int, int)
sub_43BF7D	proc near		; CODE XREF: sub_43C238+1Cp
					; .text:0043C277p ...

Str1		= dword	ptr -58h
Str2		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		mov	eax, ds:dword_451840
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	loc_43C20F
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		cmp	eax, 2
		jbe	loc_43C148
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_43C148
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax
		call	sub_43B2FE
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_18]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_20]
		mov	edx, 0
		div	ecx
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		lea	ecx, [eax-2]
		mov	eax, [ebp+var_20]
		mov	edx, 0
		div	ecx
		mov	eax, edx
		add	eax, 1
		mov	[ebp+var_24], eax
		jmp	loc_43C107
; ---------------------------------------------------------------------------

loc_43C017:				; CODE XREF: sub_43BF7D+1C5j
		sub	[ebp+var_28], 1
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_28]
		jbe	loc_43C0DF
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_43C04E
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	sub_43B2CF
		jmp	short loc_43C05E
; ---------------------------------------------------------------------------

loc_43C04E:				; CODE XREF: sub_43BF7D+B5j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_43C05E:				; CODE XREF: sub_43BF7D+CFj
		cmp	eax, [ebp+var_1C]
		jb	short loc_43C0DF
		mov	eax, [ebp+var_18]
		mov	ebx, [eax]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_43C08D
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+58h+Str1],	eax
		call	sub_43B2CF
		jmp	short loc_43C09E
; ---------------------------------------------------------------------------

loc_43C08D:				; CODE XREF: sub_43BF7D+F3j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_43C09E:				; CODE XREF: sub_43BF7D+10Ej
		add	eax, ebx
		mov	[esp+58h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_43C0DF
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	eax, al
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str1],	eax
		call	sub_43BC12
		jmp	loc_43C229
; ---------------------------------------------------------------------------

loc_43C0DF:				; CODE XREF: sub_43BF7D+A7j
					; sub_43BF7D+E4j ...
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		sub	eax, [ebp+var_24]
		cmp	eax, [ebp+var_14]
		ja	short loc_43C101
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		mov	edx, [ebp+var_24]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+var_14], eax
		jmp	short loc_43C107
; ---------------------------------------------------------------------------

loc_43C101:				; CODE XREF: sub_43BF7D+16Ej
		mov	eax, [ebp+var_24]
		add	[ebp+var_14], eax

loc_43C107:				; CODE XREF: sub_43BF7D+95j
					; sub_43BF7D+182j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_43C12B
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	sub_43B2CF
		jmp	short loc_43C13B
; ---------------------------------------------------------------------------

loc_43C12B:				; CODE XREF: sub_43BF7D+192j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]

loc_43C13B:				; CODE XREF: sub_43BF7D+1ACj
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	loc_43C017

loc_43C148:				; CODE XREF: sub_43BF7D+23j
					; sub_43BF7D+31j
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_C], eax
		jmp	loc_43C201
; ---------------------------------------------------------------------------

loc_43C15D:				; CODE XREF: sub_43BF7D+28Aj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		shr	eax, 1
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_18]
		mov	ebx, [eax]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_43C194
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+58h+Str1],	eax
		call	sub_43B2CF
		jmp	short loc_43C1A5
; ---------------------------------------------------------------------------

loc_43C194:				; CODE XREF: sub_43BF7D+1FAj
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_43C1A5:				; CODE XREF: sub_43BF7D+215j
		add	eax, ebx
		mov	[esp+58h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jns	short loc_43C1C7
		mov	eax, [ebp+var_28]
		mov	[ebp+var_C], eax
		jmp	short loc_43C201
; ---------------------------------------------------------------------------

loc_43C1C7:				; CODE XREF: sub_43BF7D+240j
		cmp	[ebp+var_2C], 0
		jle	short loc_43C1D8
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_43C201
; ---------------------------------------------------------------------------

loc_43C1D8:				; CODE XREF: sub_43BF7D+24Ej
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	eax, al
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str1],	eax
		call	sub_43BC12
		jmp	short loc_43C229
; ---------------------------------------------------------------------------

loc_43C201:				; CODE XREF: sub_43BF7D+1DBj
					; sub_43BF7D+248j ...
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_C]
		jb	loc_43C15D
		jmp	short loc_43C210
; ---------------------------------------------------------------------------

loc_43C20F:				; CODE XREF: sub_43BF7D+14j
		nop

loc_43C210:				; CODE XREF: sub_43BF7D+290j
		cmp	[ebp+arg_4], 0
		jz	short loc_43C226
		cmp	[ebp+arg_8], 1
		jnz	short loc_43C221
		mov	eax, [ebp+arg_0]
		jmp	short loc_43C224
; ---------------------------------------------------------------------------

loc_43C221:				; CODE XREF: sub_43BF7D+29Dj
		mov	eax, [ebp+arg_4]

loc_43C224:				; CODE XREF: sub_43BF7D+2A2j
		jmp	short loc_43C229
; ---------------------------------------------------------------------------

loc_43C226:				; CODE XREF: sub_43BF7D+297j
		mov	eax, [ebp+arg_0]

loc_43C229:				; CODE XREF: sub_43BF7D+15Dj
					; sub_43BF7D+282j ...
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_43BF7D	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43C238(char *)
sub_43C238	proc near		; CODE XREF: sub_401723+4Ap
					; sub_401723+B6p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_10], 0 ; int
		mov	[esp+18h+var_14], 0 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_43BF7D
		leave
		retn
sub_43C238	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_43BF7D
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_43BF7D
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp], offset	aLc_messages ; "LC_MESSAGES"
		call	sub_43A788
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_43C2BF
		mov	eax, [ebp-0Ch]
		jmp	short locret_43C2C4
; ---------------------------------------------------------------------------

loc_43C2BF:				; CODE XREF: .text:0043C2B8j
		mov	eax, offset byte_44F157

locret_43C2C4:				; CODE XREF: .text:0043C2BDj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43C2C6	proc near		; CODE XREF: sub_425791+Dp
					; sub_4257AA+Dp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ds:dword_451844, eax
		pop	ebp
		retn
sub_43C2C6	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43C2D4	proc near		; CODE XREF: sub_401C11+9ACp
					; sub_402B62+24p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ds:dword_4518EC
		mov	[ebp+var_4], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_43C2F2
		mov	ds:dword_4518EC, 0

loc_43C2F2:				; CODE XREF: sub_43C2D4+12j
		mov	eax, [ebp+var_4]
		leave
		retn
sub_43C2D4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_4518EC
		add	eax, 1
		mov	ds:dword_4518EC, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43C309(char *Filename, int FileHandle)
sub_43C309	proc near		; CODE XREF: sub_43C568+21p
					; .text:0043C5A4p

File		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Filename	= dword	ptr  8
FileHandle	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_43C353
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_43C349
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_43C349
		mov	eax, ds:File
		mov	[esp+28h+File],	eax ; File
		call	fclose

loc_43C349:				; CODE XREF: sub_43C309+20j
					; sub_43C309+31j
		mov	ds:File, 0

loc_43C353:				; CODE XREF: sub_43C309+Fj
		cmp	[ebp+Filename],	0
		jz	short loc_43C39B
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset asc_44F158 ; "-"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_43C39B
		mov	[ebp+Filename],	0
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+28h+File],	eax ; File
		call	_fileno
		mov	[ebp+FileHandle], eax

loc_43C39B:				; CODE XREF: sub_43C309+4Ej
					; sub_43C309+76j
		cmp	[ebp+Filename],	0
		jz	short loc_43C3F1
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset aSocket ; "socket://"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_43C3DD
		mov	eax, [ebp+Filename]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43C3DD
		mov	eax, 1
		jmp	short loc_43C3E2
; ---------------------------------------------------------------------------

loc_43C3DD:				; CODE XREF: sub_43C309+BEj
					; sub_43C309+CBj
		mov	eax, 0

loc_43C3E2:				; CODE XREF: sub_43C309+D2j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_43C3F8
		add	[ebp+Filename],	9
		jmp	short loc_43C3F8
; ---------------------------------------------------------------------------

loc_43C3F1:				; CODE XREF: sub_43C309+96j
		mov	[ebp+var_10], 0

loc_43C3F8:				; CODE XREF: sub_43C309+E0j
					; sub_43C309+E6j
		cmp	[ebp+var_10], 0
		jz	short loc_43C434
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aSystemDoesNotS ; "system does not support logging to a so"...
		mov	[esp+28h+var_1C], edx ;	File
		mov	[esp+28h+Count], 3Bh ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+File],	eax ; Str
		call	fwrite
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_43C48F
; ---------------------------------------------------------------------------

loc_43C434:				; CODE XREF: sub_43C309+F3j
		cmp	[ebp+Filename],	0
		jz	short loc_43C453
		mov	eax, offset aA_0 ; "a"
		mov	[esp+28h+Size],	eax ; Mode
		mov	eax, [ebp+Filename]
		mov	[esp+28h+File],	eax ; Filename
		call	fopen
		mov	[ebp+var_C], eax
		jmp	short loc_43C48F
; ---------------------------------------------------------------------------

loc_43C453:				; CODE XREF: sub_43C309+12Fj
		cmp	[ebp+FileHandle], 1
		jnz	short loc_43C466
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[ebp+var_C], eax
		jmp	short loc_43C48F
; ---------------------------------------------------------------------------

loc_43C466:				; CODE XREF: sub_43C309+14Ej
		cmp	[ebp+FileHandle], 2
		jnz	short loc_43C479
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_43C48F
; ---------------------------------------------------------------------------

loc_43C479:				; CODE XREF: sub_43C309+161j
		mov	[esp+28h+Size],	offset aA_0 ; "a"
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+File],	eax ; FileHandle
		call	_fdopen
		mov	[ebp+var_C], eax

loc_43C48F:				; CODE XREF: sub_43C309+129j
					; sub_43C309+148j ...
		mov	dword_444C3C, 0FFFFFFFFh
		cmp	[ebp+var_C], 0
		jnz	loc_43C524
		cmp	[ebp+Filename],	0
		jz	short loc_43C4E1
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToOpenLo ; "failed to open log file `%s': %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+Filename]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		jmp	short loc_43C517
; ---------------------------------------------------------------------------

loc_43C4E1:				; CODE XREF: sub_43C309+19Ej
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToFdopen ; "failed to fdopen	file descriptor	%d: %s"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf

loc_43C517:				; CODE XREF: sub_43C309+1D6j
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_43C547
; ---------------------------------------------------------------------------

loc_43C524:				; CODE XREF: sub_43C309+194j
		mov	[esp+28h+var_1C], 0 ; Size
		mov	[esp+28h+Count], 40h ; Mode
		mov	[esp+28h+Size],	0 ; Buf
		mov	eax, [ebp+var_C]
		mov	[esp+28h+File],	eax ; File
		call	setvbuf

loc_43C547:				; CODE XREF: sub_43C309+219j
		mov	eax, [ebp+var_C]
		mov	ds:File, eax
		mov	eax, [ebp+var_10]
		mov	ds:dword_4518E4, eax
		mov	ds:dword_4518E8, 0
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_43C309	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43C568(char *)
sub_43C568	proc near		; CODE XREF: sub_401C11+C5Ap
					; sub_43C72A+19p

Filename	= dword	ptr -18h
FileHandle	= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_43C579
		mov	eax, [ebp+arg_0]
		jmp	short loc_43C57E
; ---------------------------------------------------------------------------

loc_43C579:				; CODE XREF: sub_43C568+Aj
		mov	eax, offset asc_44F158 ; "-"

loc_43C57E:				; CODE XREF: sub_43C568+Fj
		mov	[esp+18h+FileHandle], 0FFFFFFFFh ; FileHandle
		mov	[esp+18h+Filename], eax	; Filename
		call	sub_43C309
		leave
		retn
sub_43C568	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_43C309
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43C5AB	proc near		; CODE XREF: sub_401C11+786p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ds:dword_4518DC, eax
		pop	ebp
		retn
sub_43C5AB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43C5B8(char *, int)
sub_43C5B8	proc near		; CODE XREF: sub_401C11+F6p
					; sub_401C11+C6Ep

Dest		= dword	ptr -18h
Source		= dword	ptr -14h
Count		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_43C5E6
		mov	[esp+18h+Count], 4Fh ; Count
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Source], eax ;	Source
		mov	[esp+18h+Dest],	offset byte_451880 ; Dest
		call	strncpy
		mov	ds:byte_4518CF,	0

loc_43C5E6:				; CODE XREF: sub_43C5B8+Aj
		mov	eax, [ebp+arg_4]
		and	eax, 1
		mov	ds:dword_4518D4, eax
		mov	eax, [ebp+arg_4]
		and	eax, 2
		mov	ds:dword_4518D0, eax
		mov	eax, [ebp+arg_4]
		and	eax, 4
		mov	ds:dword_4518D8, eax
		mov	eax, [ebp+arg_4]
		and	eax, 100h
		mov	ds:dword_4518E0, eax
		leave
		retn
sub_43C5B8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43C616	proc near		; CODE XREF: sub_401C11+192p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jz	short loc_43C688
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	eax, ds:dword_4518D4
		test	eax, eax
		jz	short loc_43C640
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_43C640:				; CODE XREF: sub_43C616+19j
		mov	eax, ds:dword_4518D0
		test	eax, eax
		jz	short loc_43C658
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 2
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_43C658:				; CODE XREF: sub_43C616+31j
		mov	eax, ds:dword_4518D8
		test	eax, eax
		jz	short loc_43C670
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 4
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_43C670:				; CODE XREF: sub_43C616+49j
		mov	eax, ds:dword_4518E0
		test	eax, eax
		jz	short loc_43C688
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	dh, 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_43C688:				; CODE XREF: sub_43C616+7j
					; sub_43C616+61j
		mov	eax, offset byte_451880
		pop	ebp
		retn
sub_43C616	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_43C6C3
		mov	eax, ds:File
		mov	[esp], eax
		call	_fileno
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	short loc_43C6C3
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_43C6C3
		mov	eax, 1
		jmp	short locret_43C6E3
; ---------------------------------------------------------------------------

loc_43C6C3:				; CODE XREF: .text:0043C69Cj
					; .text:0043C6B2j ...
		mov	eax, dword_444C3C
		cmp	eax, 0FFFFFFFFh
		jz	short loc_43C6DE
		mov	eax, dword_444C3C
		cmp	eax, [ebp+8]
		jnz	short loc_43C6DE
		mov	eax, 1
		jmp	short locret_43C6E3
; ---------------------------------------------------------------------------

loc_43C6DE:				; CODE XREF: .text:0043C6CBj
					; .text:0043C6D5j
		mov	eax, 0

locret_43C6E3:				; CODE XREF: .text:0043C6C1j
					; .text:0043C6DCj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_43C6FE
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_43C703
; ---------------------------------------------------------------------------

loc_43C6FE:				; CODE XREF: .text:0043C6F2j
		mov	eax, ds:File

loc_43C703:				; CODE XREF: .text:0043C6FCj
		mov	[esp], eax
		call	_fileno
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43C70D	proc near		; CODE XREF: sub_406CEF+175p
		push	ebp
		mov	ebp, esp
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_43C723
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_43C728
; ---------------------------------------------------------------------------

loc_43C723:				; CODE XREF: sub_43C70D+Aj
		mov	eax, ds:File

loc_43C728:				; CODE XREF: sub_43C70D+14j
		pop	ebp
		retn
sub_43C70D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43C72A(int, char *Format, va_list ArgList)
sub_43C72A	proc near		; CODE XREF: sub_43CAAD+22p
					; sub_43CAD6+1Ap ...

var_58		= dword	ptr -58h
File		= dword	ptr -54h
Count		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
Format		= dword	ptr  0Ch
ArgList		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_43C76D
		mov	[esp+58h+var_58], 0 ; char *
		call	sub_43C568
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_43C76D
		mov	[esp+58h+Count], 1C3h ;	int
		mov	[esp+58h+File],	offset a____Gnupg22_14 ; "../../gnupg2-2.0.30/jnlib/logging.c"
		mov	[esp+58h+var_58], offset aLogstream ; "logstream"
		call	sub_442650

loc_43C76D:				; CODE XREF: sub_43C72A+10j
					; sub_43C72A+25j
		mov	eax, ds:dword_4518E8
		test	eax, eax
		jz	short loc_43C791
		cmp	[ebp+arg_0], 1
		jz	short loc_43C791
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_43C791:				; CODE XREF: sub_43C72A+4Aj
					; sub_43C72A+50j
		mov	ds:dword_4518E8, 0
		cmp	[ebp+arg_0], 1
		jz	loc_43C928
		mov	eax, ds:dword_4518D0
		test	eax, eax
		jz	loc_43C841
		mov	eax, ds:dword_4518E4
		test	eax, eax
		jnz	loc_43C841
		mov	[esp+58h+var_58], 0
		call	sub_442720
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_58], eax
		call	sub_442750
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	edx, [eax]
		mov	eax, [ebp+var_1C]
		mov	edi, [eax+4]
		mov	eax, [ebp+var_1C]
		mov	esi, [eax+8]
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax+0Ch]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+10h]
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+14h]
		add	eax, 76Ch
		mov	[ebp+var_30], eax
		mov	ecx, offset a04d02d02d02d_0 ; "%04d-%02d-%02d %02d:%02d:%02d "
		mov	eax, ds:File
		mov	[esp+58h+var_3C], edx
		mov	[esp+58h+var_40], edi
		mov	[esp+58h+var_44], esi
		mov	[esp+58h+var_48], ebx
		mov	edx, [ebp+var_2C]
		mov	[esp+58h+var_4C], edx
		mov	edi, [ebp+var_30]
		mov	[esp+58h+Count], edi
		mov	[esp+58h+File],	ecx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_43C841:				; CODE XREF: sub_43C72A+82j
					; sub_43C72A+8Fj
		mov	eax, ds:dword_4518D4
		test	eax, eax
		jnz	short loc_43C853
		mov	eax, ds:dword_4518E4
		test	eax, eax
		jz	short loc_43C86A

loc_43C853:				; CODE XREF: sub_43C72A+11Ej
		mov	edx, ds:File
		mov	eax, offset byte_451880
		mov	[esp+58h+File],	edx ; File
		mov	[esp+58h+var_58], eax ;	Str
		call	fputs

loc_43C86A:				; CODE XREF: sub_43C72A+127j
		mov	eax, ds:dword_4518D8
		test	eax, eax
		jnz	short loc_43C87C
		mov	eax, ds:dword_4518E4
		test	eax, eax
		jz	short loc_43C8D6

loc_43C87C:				; CODE XREF: sub_43C72A+147j
		mov	eax, ds:dword_4518DC
		test	eax, eax
		jz	short loc_43C8B5
		mov	eax, ds:dword_4518DC
		call	eax ; dword_4518DC
		mov	ebx, eax
		call	_getpid
		mov	ecx, eax
		mov	edx, offset aU_Lx ; "[%u.%lx]"
		mov	eax, ds:File
		mov	[esp+58h+var_4C], ebx
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_43C8D6
; ---------------------------------------------------------------------------

loc_43C8B5:				; CODE XREF: sub_43C72A+159j
		call	_getpid
		mov	ecx, eax
		mov	edx, offset aU_1 ; "[%u]"
		mov	eax, ds:File
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_43C8D6:				; CODE XREF: sub_43C72A+150j
					; sub_43C72A+189j
		mov	eax, ds:dword_4518D0
		test	eax, eax
		jz	short loc_43C8E8
		mov	eax, ds:dword_4518E4
		test	eax, eax
		jz	short loc_43C8FD

loc_43C8E8:				; CODE XREF: sub_43C72A+1B3j
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 3Ah ;	Ch
		call	putc

loc_43C8FD:				; CODE XREF: sub_43C72A+1BCj
		cmp	[ebp+Format], 0
		jz	short loc_43C913
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_43C913
		add	[ebp+Format], 1
		jmp	short loc_43C928
; ---------------------------------------------------------------------------

loc_43C913:				; CODE XREF: sub_43C72A+1D7j
					; sub_43C72A+1E1j
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 20h ;	Ch
		call	putc

loc_43C928:				; CODE XREF: sub_43C72A+75j
					; sub_43C72A+1E7j
		cmp	[ebp+arg_0], 7	; switch 8 cases
		ja	loc_43C9BC	; jumptable 0043C93F default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_44F288
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_43C941:				; CODE XREF: sub_43C72A+215j
					; DATA XREF: .rdata:off_44F288o
		mov	edx, ds:File	; jumptable 0043C93F case 5
		mov	eax, offset aFatal ; "Fatal: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 7 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_43C9DC
; ---------------------------------------------------------------------------

loc_43C96A:				; CODE XREF: sub_43C72A+215j
					; DATA XREF: .rdata:off_44F288o
		mov	edx, ds:File	; jumptable 0043C93F case 6
		mov	eax, offset aOhhhhJeeee	; "Ohhhh jeeee:	"
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 0Dh ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_43C9DC
; ---------------------------------------------------------------------------

loc_43C993:				; CODE XREF: sub_43C72A+215j
					; DATA XREF: .rdata:off_44F288o
		mov	edx, ds:File	; jumptable 0043C93F case 7
		mov	eax, offset aDbg ; "DBG: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 5 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_43C9DC
; ---------------------------------------------------------------------------

loc_43C9BC:				; CODE XREF: sub_43C72A+202j
		mov	edx, offset aUnknownLogLeve ; jumptable	0043C93F default case
		mov	eax, ds:File
		mov	ecx, [ebp+arg_0]
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_43C9DC
; ---------------------------------------------------------------------------

loc_43C9DB:				; CODE XREF: sub_43C72A+215j
					; DATA XREF: .rdata:off_44F288o
		nop			; jumptable 0043C93F cases 0-4

loc_43C9DC:				; CODE XREF: sub_43C72A+23Ej
					; sub_43C72A+267j ...
		cmp	[ebp+Format], 0
		jz	short loc_43CA4C
		mov	eax, ds:File
		mov	edx, [ebp+ArgList]
		mov	[esp+58h+Count], edx ; ArgList
		mov	edx, [ebp+Format]
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	vfprintf
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43CA3F
		mov	eax, [ebp+Format]
		mov	[ebp+var_34], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_34]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_43CA3F
		mov	ds:dword_4518E8, 1
		jmp	short loc_43CA4C
; ---------------------------------------------------------------------------

loc_43CA3F:				; CODE XREF: sub_43C72A+2DBj
					; sub_43C72A+307j
		mov	eax, ds:File
		mov	[esp+58h+var_58], eax ;	File
		call	fflush

loc_43CA4C:				; CODE XREF: sub_43C72A+2B6j
					; sub_43C72A+313j
		cmp	[ebp+arg_0], 5
		jnz	short loc_43CA7C
		mov	eax, ds:dword_4518E8
		test	eax, eax
		jz	short loc_43CA70
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_43CA70:				; CODE XREF: sub_43C72A+32Fj
		mov	[esp+58h+var_58], 2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_43CA7C:				; CODE XREF: sub_43C72A+326j
		cmp	[ebp+arg_0], 6
		jnz	short loc_43CAA5
		mov	eax, ds:dword_4518E8
		test	eax, eax
		jz	short loc_43CAA0
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_43CAA0:				; CODE XREF: sub_43C72A+35Fj
		call	abort
; ---------------------------------------------------------------------------

loc_43CAA5:				; CODE XREF: sub_43C72A+356j
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_43C72A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43CAAD(int, char *, char)
sub_43CAAD	proc near		; CODE XREF: sub_43CCB0+2Ap

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_43C72A
		leave
		retn
sub_43CAAD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43CAD6(int, char *, va_list)
sub_43CAD6	proc near		; CODE XREF: sub_425863+8Fp

var_18		= dword	ptr -18h
Format		= dword	ptr -14h
ArgList		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_43C72A
		leave
		retn
sub_43CAD6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43CAF7(char *, char)
sub_43CAF7	proc near		; CODE XREF: sub_40180D+38Ep
					; sub_401C11+43Cp ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 2 ; int
		call	sub_43C72A
		leave
		retn
sub_43CAF7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43CB21(char *, char)
sub_43CB21	proc near		; CODE XREF: sub_40180D+1C3p
					; sub_401C11+474p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 4 ; int
		call	sub_43C72A
		mov	eax, ds:dword_4518EC
		cmp	eax, 752Fh
		jg	short locret_43CB62
		mov	eax, ds:dword_4518EC
		add	eax, 1
		mov	ds:dword_4518EC, eax

locret_43CB62:				; CODE XREF: sub_43CB21+32j
		leave
		retn
sub_43CB21	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl sub_43CB64(char *, char)
sub_43CB64	proc near		; CODE XREF: sub_401C11+146p
					; sub_4258F9+27p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 5 ; int
		call	sub_43C72A
		call	abort
sub_43CB64	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl sub_43CB91(char *, char)
sub_43CB91	proc near		; CODE XREF: sub_408D9F+212p
					; sub_40E2B4+39p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 6 ; int
		call	sub_43C72A
		call	abort
sub_43CB91	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43CBBE(char *, char)
sub_43CBBE	proc near		; CODE XREF: sub_401C11+C96p
					; sub_401C11+CB1p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 7 ; int
		call	sub_43C72A
		leave
		retn
sub_43CBBE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43CBE8(char *, char)
sub_43CBE8	proc near		; CODE XREF: sub_4088F6+51p
					; sub_4088F6+77p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		cmp	[ebp+arg_0], 0
		setnz	al
		movzx	eax, al
		mov	[esp+28h+ArgList], edx ; ArgList
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+var_28], eax ;	int
		call	sub_43C72A
		leave
		retn
sub_43CBE8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43CC18	proc near		; CODE XREF: sub_407CBA+B4p
					; sub_4080B2+1B4p ...

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+arg_0], 0
		jz	short loc_43CC41
		mov	eax, dword ptr [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43CC41
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset dword_44F2A8 ;	char *
		call	sub_43CBBE

loc_43CC41:				; CODE XREF: sub_43CC18+Aj
					; sub_43CC18+14j
		cmp	[ebp+arg_8], 0
		jz	short loc_43CC9C
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset a02x_2	; "%02X"
		call	sub_43CBE8
		sub	[ebp+arg_8], 1
		add	[ebp+var_C], 1
		jmp	short loc_43CC8D
; ---------------------------------------------------------------------------

loc_43CC70:				; CODE XREF: sub_43CC18+82j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset a02x_3	; " %02X"
		call	sub_43CBE8
		add	[ebp+var_C], 1

loc_43CC8D:				; CODE XREF: sub_43CC18+56j
		cmp	[ebp+arg_8], 0
		setnz	al
		sub	[ebp+arg_8], 1
		test	al, al
		jnz	short loc_43CC70

loc_43CC9C:				; CODE XREF: sub_43CC18+2Dj
		cmp	dword ptr [ebp+arg_0], 0
		jz	short locret_43CCAE
		mov	[esp+28h+var_28], offset asc_44F2B7 ; "\n"
		call	sub_43CBE8

locret_43CCAE:				; CODE XREF: sub_43CC18+88j
		leave
		retn
sub_43CC18	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_43CCB0	proc near		; CODE XREF: sub_402C19+73p
					; sub_403BAA+3Ap ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_18], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_1C], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_20], eax	; char
		mov	[esp+28h+var_24], offset a___ThisIsABugS ; "...	this is	a bug (%s:%d:%s)\n"
		mov	[esp+28h+var_28], 6 ; int
		call	sub_43CAAD
		call	abort
sub_43CCB0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43CCE4	proc near		; CODE XREF: sub_43D24E+57p
					; sub_43DC31+1Cp

Code		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 8000h
		test	eax, eax
		jnz	short loc_43CD71
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+28h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+34h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, eax
		or	dh, 80h
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		test	eax, eax
		jns	short loc_43CD71
		mov	[esp+28h+Code],	offset aInvalidArgumen ; "invalid argument for arg_parsee\n"
		call	sub_43CB91
; ---------------------------------------------------------------------------

loc_43CD71:				; CODE XREF: sub_43CCE4+13j
					; sub_43CCE4+7Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_43D024
		cmp	dword ptr [ebp+arg_4], 0
		jz	loc_43CEA9
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFAh
		jnz	short loc_43CDA8
		mov	[esp+28h+Code],	offset aArgumentNotExp ; "argument not expected"
		call	sub_43C238
		mov	dword ptr [ebp+var_C], eax
		jmp	loc_43CE81
; ---------------------------------------------------------------------------

loc_43CDA8:				; CODE XREF: sub_43CCE4+AEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFBh
		jnz	short loc_43CDC7
		mov	[esp+28h+Code],	offset aReadError ; "read error"
		call	sub_43C238
		mov	dword ptr [ebp+var_C], eax
		jmp	loc_43CE81
; ---------------------------------------------------------------------------

loc_43CDC7:				; CODE XREF: sub_43CCE4+CDj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFCh
		jnz	short loc_43CDE6
		mov	[esp+28h+Code],	offset aKeywordTooLong ; "keyword too long"
		call	sub_43C238
		mov	dword ptr [ebp+var_C], eax
		jmp	loc_43CE81
; ---------------------------------------------------------------------------

loc_43CDE6:				; CODE XREF: sub_43CCE4+ECj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_43CE02
		mov	[esp+28h+Code],	offset aMissingArgumen ; "missing argument"
		call	sub_43C238
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_43CE81
; ---------------------------------------------------------------------------

loc_43CE02:				; CODE XREF: sub_43CCE4+10Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF4h
		jnz	short loc_43CE1E
		mov	[esp+28h+Code],	offset aInvalidArgum_0 ; "invalid argument"
		call	sub_43C238
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_43CE81
; ---------------------------------------------------------------------------

loc_43CE1E:				; CODE XREF: sub_43CCE4+127j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF9h
		jnz	short loc_43CE3A
		mov	[esp+28h+Code],	offset aInvalidCommand ; "invalid command"
		call	sub_43C238
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_43CE81
; ---------------------------------------------------------------------------

loc_43CE3A:				; CODE XREF: sub_43CCE4+143j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF6h
		jnz	short loc_43CE56
		mov	[esp+28h+Code],	offset aInvalidAliasDe ; "invalid alias	definition"
		call	sub_43C238
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_43CE81
; ---------------------------------------------------------------------------

loc_43CE56:				; CODE XREF: sub_43CCE4+15Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF5h
		jnz	short loc_43CE72
		mov	[esp+28h+Code],	offset aOutOfCore_0 ; "out of core"
		call	sub_43C238
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_43CE81
; ---------------------------------------------------------------------------

loc_43CE72:				; CODE XREF: sub_43CCE4+17Bj
		mov	[esp+28h+Code],	offset aInvalidOption ;	"invalid option"
		call	sub_43C238
		mov	dword ptr [ebp+var_C], eax

loc_43CE81:				; CODE XREF: sub_43CCE4+BFj
					; sub_43CCE4+DEj ...
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	edx, dword ptr [ebp+var_C]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aSUS ; "%s:%u: %s\n"
		call	sub_43CB21
		jmp	loc_43D003
; ---------------------------------------------------------------------------

loc_43CEA9:				; CODE XREF: sub_43CCE4+9Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_43CEBB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		jmp	short loc_43CEC0
; ---------------------------------------------------------------------------

loc_43CEBB:				; CODE XREF: sub_43CCE4+1CDj
		mov	eax, offset a??	; "[??]"

loc_43CEC0:				; CODE XREF: sub_43CCE4+1D5j
		mov	dword ptr [ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_43CEEE
		mov	[esp+28h+Code],	offset aMissingArgum_0 ; "missing argument for option \"%.50s\"\n"
		call	sub_43C238
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_43CB21
		jmp	loc_43D003
; ---------------------------------------------------------------------------

loc_43CEEE:				; CODE XREF: sub_43CCE4+1E8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF4h
		jnz	short loc_43CF19
		mov	[esp+28h+Code],	offset aInvalidArgum_1 ; "invalid argument for option \"%.50s\"\n"
		call	sub_43C238
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_43CB21
		jmp	loc_43D003
; ---------------------------------------------------------------------------

loc_43CF19:				; CODE XREF: sub_43CCE4+213j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFAh
		jnz	short loc_43CF44
		mov	[esp+28h+Code],	offset aOption_50sDoes ; "option \"%.50s\" does	not expect an arg"...
		call	sub_43C238
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_43CB21
		jmp	loc_43D003
; ---------------------------------------------------------------------------

loc_43CF44:				; CODE XREF: sub_43CCE4+23Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF9h
		jnz	short loc_43CF6F
		mov	[esp+28h+Code],	offset aInvalidComma_0 ; "invalid command \"%.50s\"\n"
		call	sub_43C238
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_43CB21
		jmp	loc_43D003
; ---------------------------------------------------------------------------

loc_43CF6F:				; CODE XREF: sub_43CCE4+269j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF8h
		jnz	short loc_43CF97
		mov	[esp+28h+Code],	offset aOption_50sIsAm ; "option \"%.50s\" is ambiguous\n"
		call	sub_43C238
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_43CB21
		jmp	short loc_43D003
; ---------------------------------------------------------------------------

loc_43CF97:				; CODE XREF: sub_43CCE4+294j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF8h
		jnz	short loc_43CFBF
		mov	[esp+28h+Code],	offset aCommand_50sIsA ; "command \"%.50s\" is ambiguous\n"
		call	sub_43C238
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_43CB21
		jmp	short loc_43D003
; ---------------------------------------------------------------------------

loc_43CFBF:				; CODE XREF: sub_43CCE4+2BCj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF5h
		jnz	short loc_43CFE8
		mov	[esp+28h+Code],	offset aOutOfCore_1 ; "out of core\n"
		call	sub_43C238
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aS_3 ; "%s\n"
		call	sub_43CB21
		jmp	short loc_43D003
; ---------------------------------------------------------------------------

loc_43CFE8:				; CODE XREF: sub_43CCE4+2E4j
		mov	[esp+28h+Code],	offset aInvalidOption_ ; "invalid option \"%.50s\"\n"
		call	sub_43C238
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_43CB21

loc_43D003:				; CODE XREF: sub_43CCE4+1C0j
					; sub_43CCE4+205j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, 1
		jz	short loc_43D01A
		mov	[esp+28h+Code],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_43D01A:				; CODE XREF: sub_43CCE4+328j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0

loc_43D024:				; CODE XREF: sub_43CCE4+95j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		leave
		retn
sub_43CCE4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43D03A	proc near		; CODE XREF: sub_43D24E+342p
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_43D03A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43D03F(int, char *)
sub_43D03F	proc near		; CODE XREF: sub_43D085+11Cp
					; sub_43D24E+199p ...

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[ebp+var_C], eax
		jmp	short loc_43D078
; ---------------------------------------------------------------------------

loc_43D050:				; CODE XREF: sub_43D03F+3Dj
		mov	eax, [ebp+var_C]
		lea	edx, [eax+4]
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str2],	eax ; Str2
		mov	[esp+28h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_43D070
		mov	eax, 1
		jmp	short locret_43D083
; ---------------------------------------------------------------------------

loc_43D070:				; CODE XREF: sub_43D03F+28j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_43D078:				; CODE XREF: sub_43D03F+Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_43D050
		mov	eax, 0

locret_43D083:				; CODE XREF: sub_43D03F+2Fj
		leave
		retn
sub_43D03F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43D085(int, FILE *)
sub_43D085	proc near		; CODE XREF: sub_43D24E+643p

File		= dword	ptr -98h
Source		= dword	ptr -94h
var_80		= byte ptr -80h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 98h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		jmp	loc_43D201
; ---------------------------------------------------------------------------

loc_43D0A8:				; CODE XREF: sub_43D085+180j
		mov	eax, [ebp+arg_4]
		mov	[esp+98h+File],	eax ; File
		call	getc
		mov	[ebp+C], eax
		cmp	[ebp+C], 0Ah
		jnz	short loc_43D0C5
		mov	[ebp+var_14], 1
		jmp	short loc_43D0D9
; ---------------------------------------------------------------------------

loc_43D0C5:				; CODE XREF: sub_43D085+35j
		cmp	[ebp+C], 0FFFFFFFFh
		jnz	short loc_43D0D9
		mov	[ebp+C], 0Ah
		mov	[ebp+var_14], 1

loc_43D0D9:				; CODE XREF: sub_43D085+3Ej
					; sub_43D085+44j ...
		mov	eax, [ebp+var_18]
		cmp	eax, 1
		jz	short loc_43D126
		cmp	eax, 1
		jb	short loc_43D0F9
		cmp	eax, 2
		jz	short loc_43D16A
		cmp	eax, 3
		jz	loc_43D18B
		jmp	loc_43D201
; ---------------------------------------------------------------------------

loc_43D0F9:				; CODE XREF: sub_43D085+5Fj
		mov	eax, [ebp+C]
		cmp	eax, 7Fh
		ja	short loc_43D116
		mov	eax, [ebp+C]
		mov	[esp+98h+File],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_43D1FD

loc_43D116:				; CODE XREF: sub_43D085+7Aj
		mov	[ebp+var_10], 0
		mov	[ebp+var_18], 1
		jmp	short loc_43D0D9
; ---------------------------------------------------------------------------

loc_43D126:				; CODE XREF: sub_43D085+5Aj
		mov	eax, [ebp+C]
		mov	[esp+98h+File],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_43D140
		mov	[ebp+var_18], 3
		jmp	short loc_43D0D9
; ---------------------------------------------------------------------------

loc_43D140:				; CODE XREF: sub_43D085+B0j
		mov	eax, [ebp+var_10]
		cmp	eax, 62h
		ja	short loc_43D15E
		mov	eax, [ebp+C]
		mov	edx, eax
		lea	eax, [ebp+var_80]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_43D201
; ---------------------------------------------------------------------------

loc_43D15E:				; CODE XREF: sub_43D085+C1j
		mov	[ebp+var_18], 2
		jmp	loc_43D201
; ---------------------------------------------------------------------------

loc_43D16A:				; CODE XREF: sub_43D085+64j
		mov	eax, [ebp+C]
		mov	[esp+98h+File],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	loc_43D200
		mov	[ebp+var_18], 0
		jmp	loc_43D0D9
; ---------------------------------------------------------------------------

loc_43D18B:				; CODE XREF: sub_43D085+69j
		lea	eax, [ebp+var_80]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		lea	eax, [ebp+var_80]
		mov	[esp+98h+Source], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+File],	eax ; int
		call	sub_43D03F
		test	eax, eax
		jnz	short loc_43D1F1
		mov	eax, [ebp+var_10]
		add	eax, 8
		mov	[esp+98h+File],	eax
		call	gcry_malloc
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_43D1C8
		mov	eax, 1
		jmp	short locret_43D210
; ---------------------------------------------------------------------------

loc_43D1C8:				; CODE XREF: sub_43D085+13Aj
		lea	eax, [ebp+var_80]
		mov	edx, [ebp+var_1C]
		add	edx, 4
		mov	[esp+98h+Source], eax ;	Source
		mov	[esp+98h+File],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+34h]
		mov	eax, [ebp+var_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_1C]
		mov	[eax+34h], edx

loc_43D1F1:				; CODE XREF: sub_43D085+123j
		mov	[ebp+var_18], 0
		jmp	loc_43D0D9
; ---------------------------------------------------------------------------

loc_43D1FD:				; CODE XREF: sub_43D085+8Bj
		nop
		jmp	short loc_43D201
; ---------------------------------------------------------------------------

loc_43D200:				; CODE XREF: sub_43D085+F4j
		nop

loc_43D201:				; CODE XREF: sub_43D085+1Ej
					; sub_43D085+6Fj ...
		cmp	[ebp+var_14], 0
		jz	loc_43D0A8
		mov	eax, 0

locret_43D210:				; CODE XREF: sub_43D085+141j
		leave
		retn
sub_43D085	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43D212	proc near		; CODE XREF: sub_43D24E+48Ap

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[ebp+var_C], eax
		jmp	short loc_43D23C
; ---------------------------------------------------------------------------

loc_43D223:				; CODE XREF: sub_43D212+2Ej
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gcry_free
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_43D23C:				; CODE XREF: sub_43D212+Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_43D223
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+34h], 0
		leave
		retn
sub_43D212	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43D24E(FILE *, int, int, int,	int)
sub_43D24E	proc near		; CODE XREF: sub_401C11+93Cp

File		= dword	ptr -0C8h
Str2		= dword	ptr -0C4h
Size		= dword	ptr -0C0h
var_AC		= dword	ptr -0ACh
Str1		= byte ptr -9Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
Str		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 0C4h
		mov	[ebp+var_14], 0
		mov	[ebp+Str], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 0
		cmp	[ebp+arg_0], 0
		jnz	short loc_43D291
		mov	eax, [ebp+arg_10]
		mov	[esp+0C8h+Str2], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax
		call	sub_43DC31
		jmp	loc_43DAD0
; ---------------------------------------------------------------------------

loc_43D291:				; CODE XREF: sub_43D24E+2Aj
		mov	eax, [ebp+arg_8]
		mov	[esp+0C8h+Size], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Str2], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax
		call	sub_43CCE4
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	short loc_43D2BA
; ---------------------------------------------------------------------------

loc_43D2B9:				; CODE XREF: sub_43D24E+4D3j
					; sub_43D24E+518j ...
		nop

loc_43D2BA:				; CODE XREF: sub_43D24E+69j
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+File], eax ; File
		call	getc
		mov	[ebp+C], eax
		cmp	[ebp+C], 0Ah
		jz	short loc_43D2D8
		cmp	[ebp+C], 0FFFFFFFFh
		jnz	loc_43D71D

loc_43D2D8:				; CODE XREF: sub_43D24E+7Ej
		cmp	[ebp+C], 0FFFFFFFFh
		jz	short loc_43D2EB
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_43D2EB:				; CODE XREF: sub_43D24E+8Ej
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	loc_43DAC6
		cmp	[ebp+var_C], 2
		jnz	loc_43D481
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	[ebp+var_10], 0
		jmp	short loc_43D34A
; ---------------------------------------------------------------------------

loc_43D314:				; CODE XREF: sub_43D24E+109j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_43D346
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+4]
		lea	edx, [ebp+Str1]
		mov	[esp+0C8h+Str2], edx ; Str2
		mov	[esp+0C8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_43D35B

loc_43D346:				; CODE XREF: sub_43D24E+D4j
		add	[ebp+var_10], 1

loc_43D34A:				; CODE XREF: sub_43D24E+C4j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_43D314
		jmp	short loc_43D35C
; ---------------------------------------------------------------------------

loc_43D35B:				; CODE XREF: sub_43D24E+F6j
		nop

loc_43D35C:				; CODE XREF: sub_43D24E+10Bj
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	edx, [eax]
		mov	eax, [ebp+arg_C]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jz	short loc_43D398
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	loc_43DAC1
; ---------------------------------------------------------------------------

loc_43D398:				; CODE XREF: sub_43D24E+136j
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_43D42E
		mov	[esp+0C8h+Str2], offset	aIgnoreInvalidO	; "ignore-invalid-option"
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_43D3D7
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	loc_43DAC1
; ---------------------------------------------------------------------------

loc_43D3D7:				; CODE XREF: sub_43D24E+175j
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+Str2], eax ; char *
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax ; int
		call	sub_43D03F
		test	eax, eax
		jz	short loc_43D402
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	loc_43DAC1
; ---------------------------------------------------------------------------

loc_43D402:				; CODE XREF: sub_43D24E+1A0j
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 80h
		test	eax, eax
		jz	short loc_43D41E
		mov	eax, 0FFFFFFF9h
		jmp	short loc_43D423
; ---------------------------------------------------------------------------

loc_43D41E:				; CODE XREF: sub_43D24E+1C7j
		mov	eax, 0FFFFFFFEh

loc_43D423:				; CODE XREF: sub_43D24E+1CEj
		mov	edx, [ebp+arg_C]
		mov	[edx+10h], eax
		jmp	loc_43DACA
; ---------------------------------------------------------------------------

loc_43D42E:				; CODE XREF: sub_43D24E+157j
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_43D450
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_43DACA
; ---------------------------------------------------------------------------

loc_43D450:				; CODE XREF: sub_43D24E+1F1j
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_43D472
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_43DACA
; ---------------------------------------------------------------------------

loc_43D472:				; CODE XREF: sub_43D24E+213j
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_43DACA
; ---------------------------------------------------------------------------

loc_43D481:				; CODE XREF: sub_43D24E+ABj
		cmp	[ebp+var_C], 3
		jnz	short loc_43D4EF
		cmp	[ebp+var_20], 0
		jz	short loc_43D49C
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_43DACA
; ---------------------------------------------------------------------------

loc_43D49C:				; CODE XREF: sub_43D24E+23Dj
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_43D4BE
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_43DACA
; ---------------------------------------------------------------------------

loc_43D4BE:				; CODE XREF: sub_43D24E+25Fj
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_43D4E0
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_43DACA
; ---------------------------------------------------------------------------

loc_43D4E0:				; CODE XREF: sub_43D24E+281j
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_43DACA
; ---------------------------------------------------------------------------

loc_43D4EF:				; CODE XREF: sub_43D24E+237j
		cmp	[ebp+var_C], 4
		jnz	loc_43D6CC
		cmp	[ebp+var_20], 0
		jz	loc_43D59A
		cmp	[ebp+Str], 0
		jnz	short loc_43D518
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFAh
		jmp	loc_43D6C7
; ---------------------------------------------------------------------------

loc_43D518:				; CODE XREF: sub_43D24E+2B9j
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	byte ptr [eax],	0
		mov	[esp+0C8h+Str2], offset	asc_44F4B3 ; " \t"
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax ; Str
		call	strpbrk
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_43D552
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_24]
		mov	[esp+0C8h+File], eax
		call	sub_438F3C

loc_43D552:				; CODE XREF: sub_43D24E+2EDj
		cmp	[ebp+var_24], 0
		jz	short loc_43D562
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43D57C

loc_43D562:				; CODE XREF: sub_43D24E+308j
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax
		call	gcry_free
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFF6h
		jmp	loc_43DAC9
; ---------------------------------------------------------------------------

loc_43D57C:				; CODE XREF: sub_43D24E+312j
		mov	eax, [ebp+var_24]
		mov	[esp+0C8h+Size], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+Str2], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax
		call	sub_43D03A
		jmp	loc_43D6C7
; ---------------------------------------------------------------------------

loc_43D59A:				; CODE XREF: sub_43D24E+2AFj
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_43D5BC
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFAh
		jmp	loc_43DAC9
; ---------------------------------------------------------------------------

loc_43D5BC:				; CODE XREF: sub_43D24E+35Dj
		cmp	[ebp+Str], 0
		jnz	short loc_43D5F1
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+File], eax
		call	gcry_strdup
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jnz	short loc_43D5FA
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	short loc_43D5FA
; ---------------------------------------------------------------------------

loc_43D5F1:				; CODE XREF: sub_43D24E+372j
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	byte ptr [eax],	0

loc_43D5FA:				; CODE XREF: sub_43D24E+395j
					; sub_43D24E+3A1j
		cmp	[ebp+Str], 0
		jz	loc_43DAC9
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax
		call	sub_438F3C
		mov	eax, [ebp+Str]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_43D68D
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43D68D
		mov	eax, [ebp+var_28]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_43D68D
		mov	eax, [ebp+var_28]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+var_28]
		mov	byte ptr [eax],	0

loc_43D68D:				; CODE XREF: sub_43D24E+3CFj
					; sub_43D24E+3DDj ...
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_28]
		mov	[esp+0C8h+Size], edx ; char *
		mov	[esp+0C8h+Str2], eax ; int
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax ; int
		call	sub_43E3E6
		test	eax, eax
		jnz	loc_43DAC9
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax
		call	gcry_free
		jmp	loc_43DAC9
; ---------------------------------------------------------------------------

loc_43D6C7:				; CODE XREF: sub_43D24E+2C5j
					; sub_43D24E+347j
		jmp	loc_43DAC9
; ---------------------------------------------------------------------------

loc_43D6CC:				; CODE XREF: sub_43D24E+2A5j
		cmp	[ebp+C], 0FFFFFFFFh
		jnz	short loc_43D70A
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax
		call	sub_43D212
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+File], eax ; File
		call	ferror
		test	eax, eax
		jz	short loc_43D6FB
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFBh
		jmp	loc_43DACA
; ---------------------------------------------------------------------------

loc_43D6FB:				; CODE XREF: sub_43D24E+49Cj
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0
		jmp	loc_43DACA
; ---------------------------------------------------------------------------

loc_43D70A:				; CODE XREF: sub_43D24E+482j
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	loc_43DAC1
; ---------------------------------------------------------------------------

loc_43D71D:				; CODE XREF: sub_43D24E+84j
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	loc_43D2B9
		cmp	[ebp+var_C], 0
		jnz	short loc_43D74A
		mov	eax, [ebp+C]
		cmp	eax, 7Fh
		ja	short loc_43D74A
		mov	eax, [ebp+C]
		mov	[esp+0C8h+File], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_43DAC1

loc_43D74A:				; CODE XREF: sub_43D24E+4DDj
					; sub_43D24E+4E5j
		cmp	[ebp+var_C], 0
		jnz	short loc_43D762
		cmp	[ebp+C], 23h
		jnz	short loc_43D762
		mov	[ebp+var_C], 1
		jmp	loc_43DAC1
; ---------------------------------------------------------------------------

loc_43D762:				; CODE XREF: sub_43D24E+500j
					; sub_43D24E+506j
		cmp	[ebp+var_C], 1
		jz	loc_43D2B9
		cmp	[ebp+var_C], 2
		jnz	loc_43D92C
		mov	eax, [ebp+C]
		cmp	eax, 7Fh
		ja	loc_43D92C
		mov	eax, [ebp+C]
		mov	[esp+0C8h+File], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	loc_43D92C
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	[ebp+var_10], 0
		jmp	short loc_43D7E2
; ---------------------------------------------------------------------------

loc_43D7AC:				; CODE XREF: sub_43D24E+5A1j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_43D7DE
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+4]
		lea	edx, [ebp+Str1]
		mov	[esp+0C8h+Str2], edx ; Str2
		mov	[esp+0C8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_43D7F3

loc_43D7DE:				; CODE XREF: sub_43D24E+56Cj
		add	[ebp+var_10], 1

loc_43D7E2:				; CODE XREF: sub_43D24E+55Cj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_43D7AC
		jmp	short loc_43D7F4
; ---------------------------------------------------------------------------

loc_43D7F3:				; CODE XREF: sub_43D24E+58Ej
		nop

loc_43D7F4:				; CODE XREF: sub_43D24E+5A3j
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	edx, [eax]
		mov	eax, [ebp+arg_C]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jz	short loc_43D82A
		mov	[ebp+var_C], 1
		jmp	loc_43DAC1
; ---------------------------------------------------------------------------

loc_43D82A:				; CODE XREF: sub_43D24E+5CEj
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_43D920
		mov	[esp+0C8h+Str2], offset	aAlias ; "alias"
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_43D86A
		mov	[ebp+var_20], 1
		mov	[ebp+var_C], 3
		jmp	loc_43DAC1
; ---------------------------------------------------------------------------

loc_43D86A:				; CODE XREF: sub_43D24E+607j
		mov	[esp+0C8h+Str2], offset	aIgnoreInvalidO	; "ignore-invalid-option"
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_43D8C8
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+Str2], eax ; FILE *
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax ; int
		call	sub_43D085
		test	eax, eax
		jz	short loc_43D8A9
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	loc_43DACA
; ---------------------------------------------------------------------------

loc_43D8A9:				; CODE XREF: sub_43D24E+64Aj
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		jmp	loc_43DAC1
; ---------------------------------------------------------------------------

loc_43D8C8:				; CODE XREF: sub_43D24E+634j
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+Str2], eax ; char *
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax ; int
		call	sub_43D03F
		test	eax, eax
		jz	short loc_43D8ED
		mov	[ebp+var_C], 1
		jmp	loc_43DAC1
; ---------------------------------------------------------------------------

loc_43D8ED:				; CODE XREF: sub_43D24E+691j
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 80h
		test	eax, eax
		jz	short loc_43D909
		mov	eax, 0FFFFFFF9h
		jmp	short loc_43D90E
; ---------------------------------------------------------------------------

loc_43D909:				; CODE XREF: sub_43D24E+6B2j
		mov	eax, 0FFFFFFFEh

loc_43D90E:				; CODE XREF: sub_43D24E+6B9j
		mov	edx, [ebp+arg_C]
		mov	[edx+10h], eax
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_43DAC1
; ---------------------------------------------------------------------------

loc_43D920:				; CODE XREF: sub_43D24E+5E9j
		mov	[ebp+var_C], 3
		jmp	loc_43DAC1
; ---------------------------------------------------------------------------

loc_43D92C:				; CODE XREF: sub_43D24E+522j
					; sub_43D24E+52Ej ...
		cmp	[ebp+var_C], 3
		jnz	short loc_43D976
		mov	eax, [ebp+C]
		cmp	eax, 7Fh
		ja	short loc_43D94F
		mov	eax, [ebp+C]
		mov	[esp+0C8h+File], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_43D2B9

loc_43D94F:				; CODE XREF: sub_43D24E+6EAj
		mov	[ebp+var_10], 0
		mov	eax, [ebp+C]
		mov	edx, eax
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		mov	[ebp+var_C], 4
		jmp	loc_43D2B9
; ---------------------------------------------------------------------------

loc_43D976:				; CODE XREF: sub_43D24E+6E2j
		cmp	[ebp+var_C], 4
		jnz	loc_43DA83
		cmp	[ebp+Str], 0
		jz	short loc_43DA05
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_1C]
		sub	edx, 1
		cmp	eax, edx
		jnb	short loc_43D9A7
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	edx, [ebp+C]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_43D2B9
; ---------------------------------------------------------------------------

loc_43D9A7:				; CODE XREF: sub_43D24E+743j
		mov	eax, [ebp+var_1C]
		add	eax, 32h
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		mov	[esp+0C8h+Str2], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax
		call	gcry_realloc
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jz	short loc_43D9EB
		mov	eax, [ebp+var_30]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_34]
		mov	[ebp+Str], eax
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	edx, [ebp+C]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_43D2B9
; ---------------------------------------------------------------------------

loc_43D9EB:				; CODE XREF: sub_43D24E+77Bj
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax
		call	gcry_free
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	loc_43DACA
; ---------------------------------------------------------------------------

loc_43DA05:				; CODE XREF: sub_43D24E+736j
		mov	eax, [ebp+var_10]
		cmp	eax, 62h
		ja	short loc_43DA26
		mov	eax, [ebp+C]
		mov	edx, eax
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_43D2B9
; ---------------------------------------------------------------------------

loc_43DA26:				; CODE XREF: sub_43D24E+7BDj
		mov	[ebp+var_38], 96h
		mov	eax, [ebp+var_38]
		mov	[esp+0C8h+File], eax
		call	gcry_malloc
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jz	short loc_43DA77
		mov	eax, [ebp+var_38]
		mov	[ebp+var_1C], eax
		mov	ecx, [ebp+var_10]
		lea	edx, [ebp+Str1]
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+Size], ecx ; Size
		mov	[esp+0C8h+Str2], edx ; Src
		mov	[esp+0C8h+File], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	edx, [ebp+C]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_43D2B9
; ---------------------------------------------------------------------------

loc_43DA77:				; CODE XREF: sub_43D24E+7F1j
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	short loc_43DACA
; ---------------------------------------------------------------------------

loc_43DA83:				; CODE XREF: sub_43D24E+72Cj
		mov	eax, [ebp+var_10]
		cmp	eax, 62h
		jbe	short loc_43DAA1
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFCh
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_43D2B9
; ---------------------------------------------------------------------------

loc_43DAA1:				; CODE XREF: sub_43D24E+83Bj
		mov	eax, [ebp+C]
		mov	edx, eax
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		mov	[ebp+var_C], 2
		jmp	loc_43D2B9
; ---------------------------------------------------------------------------

loc_43DAC1:				; CODE XREF: sub_43D24E+145j
					; sub_43D24E+184j ...
		jmp	loc_43D2B9
; ---------------------------------------------------------------------------

loc_43DAC6:				; CODE XREF: sub_43D24E+A1j
		nop
		jmp	short loc_43DACA
; ---------------------------------------------------------------------------

loc_43DAC9:				; CODE XREF: sub_43D24E+329j
					; sub_43D24E+369j ...
		nop

loc_43DACA:				; CODE XREF: sub_43D24E+1DBj
					; sub_43D24E+1FDj ...
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+10h]

loc_43DAD0:				; CODE XREF: sub_43D24E+3Ej
		add	esp, 0C4h
		pop	edi
		pop	ebp
		retn
sub_43D24E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43DAD9(int, int, char	*)
sub_43DAD9	proc near		; CODE XREF: sub_43DC31+182p

Str1		= dword	ptr -38h
Str2		= dword	ptr -34h
MaxCount	= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43DAF4
		mov	eax, 0FFFFFFFFh
		jmp	loc_43DC2B
; ---------------------------------------------------------------------------

loc_43DAF4:				; CODE XREF: sub_43DAD9+Fj
		mov	[ebp+var_C], 0
		jmp	short loc_43DB38
; ---------------------------------------------------------------------------

loc_43DAFD:				; CODE XREF: sub_43DAD9+6Cj
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_43DB34
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_43DB34
		mov	eax, [ebp+var_C]
		jmp	loc_43DC2B
; ---------------------------------------------------------------------------

loc_43DB34:				; CODE XREF: sub_43DAD9+32j
					; sub_43DAD9+51j
		add	[ebp+var_C], 1

loc_43DB38:				; CODE XREF: sub_43DAD9+22j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_43DAFD
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	loc_43DC13
; ---------------------------------------------------------------------------

loc_43DB75:				; CODE XREF: sub_43DAD9+147j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	loc_43DC0F
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[esp+38h+MaxCount], edx	; MaxCount
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_43DC0F
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_43DBFB
; ---------------------------------------------------------------------------

loc_43DBBA:				; CODE XREF: sub_43DAD9+12Fj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_43DBF7
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[esp+38h+MaxCount], edx	; MaxCount
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_43DBF7
		mov	eax, 0FFFFFFFEh
		jmp	short loc_43DC2B
; ---------------------------------------------------------------------------

loc_43DBF7:				; CODE XREF: sub_43DAD9+EFj
					; sub_43DAD9+115j
		add	[ebp+var_10], 1

loc_43DBFB:				; CODE XREF: sub_43DAD9+DFj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_43DBBA
		mov	eax, [ebp+var_C]
		jmp	short loc_43DC2B
; ---------------------------------------------------------------------------

loc_43DC0F:				; CODE XREF: sub_43DAD9+AAj
					; sub_43DAD9+D4j
		add	[ebp+var_C], 1

loc_43DC13:				; CODE XREF: sub_43DAD9+97j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_43DB75
		mov	eax, 0FFFFFFFFh

loc_43DC2B:				; CODE XREF: sub_43DAD9+16j
					; sub_43DAD9+56j ...
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_43DAD9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43DC31	proc near		; CODE XREF: sub_401C11+344p
					; sub_43D24E+39p

Str		= dword	ptr -38h
Val		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+Count], 0
		mov	[esp+38h+Val], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_43CCE4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_43DC95
		cmp	[ebp+var_10], 0
		jz	short loc_43DC95
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 10h
		test	eax, eax
		jnz	short loc_43DC95
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1

loc_43DC95:				; CODE XREF: sub_43DC31+43j
					; sub_43DC31+49j ...
		cmp	[ebp+var_10], 0
		jnz	short loc_43DCAA
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		jmp	loc_43E3C0
; ---------------------------------------------------------------------------

loc_43DCAA:				; CODE XREF: sub_43DC31+68j
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+28h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_43DD00
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 2
		test	eax, eax
		jz	short loc_43DD00
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_43E3C0
; ---------------------------------------------------------------------------

loc_43DD00:				; CODE XREF: sub_43DC31+92j
					; sub_43DC31+9Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_43DD19
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		jmp	loc_43E3C0
; ---------------------------------------------------------------------------

loc_43DD19:				; CODE XREF: sub_43DC31+D7j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	loc_43E09B
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	loc_43E09B
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+var_18]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43DD77
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jnz	short loc_43DD77
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 1
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_43DC95
; ---------------------------------------------------------------------------

loc_43DD77:				; CODE XREF: sub_43DC31+11Cj
					; sub_43DC31+129j
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], 3Dh ; Val
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jz	short loc_43DD9C
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	0

loc_43DD9C:				; CODE XREF: sub_43DC31+163j
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Count], eax ; char *
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_43DAD9
		mov	[ebp+var_20], eax
		cmp	[ebp+var_28], 0
		jz	short loc_43DDC7
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	3Dh

loc_43DDC7:				; CODE XREF: sub_43DC31+18Ej
		cmp	[ebp+var_20], 0
		jns	short loc_43DE01
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aHelp ; "help"
		call	strcmp
		test	eax, eax
		jnz	short loc_43DE01
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax
		call	sub_43E61C
; ---------------------------------------------------------------------------
		jmp	loc_43DF3C
; ---------------------------------------------------------------------------

loc_43DE01:				; CODE XREF: sub_43DC31+19Aj
					; sub_43DC31+1B4j
		cmp	[ebp+var_20], 0
		jns	short loc_43DE43
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aVersion_0 ; "version"
		call	strcmp
		test	eax, eax
		jnz	short loc_43DE43
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jnz	loc_43DF3C
		call	sub_43EB87
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_43DE43:				; CODE XREF: sub_43DC31+1D4j
					; sub_43DC31+1EEj
		cmp	[ebp+var_20], 0
		jns	short loc_43DE83
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aWarranty	; "warranty"
		call	strcmp
		test	eax, eax
		jnz	short loc_43DE83
		mov	[esp+38h+Str], 10h
		call	sub_43EE3D
		mov	[esp+38h+Str], eax ; Str
		call	puts
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_43DE83:				; CODE XREF: sub_43DC31+216j
					; sub_43DC31+230j
		cmp	[ebp+var_20], 0
		jns	loc_43DF3C
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aDumpOptions ; "dump-options"
		call	strcmp
		test	eax, eax
		jnz	loc_43DF3C
		mov	[ebp+var_20], 0
		jmp	short loc_43DEF8
; ---------------------------------------------------------------------------

loc_43DEB4:				; CODE XREF: sub_43DC31+2D4j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_43DEF4
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jnz	short loc_43DEF4
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, offset aS_4 ; "--%s\n"
		mov	[esp+38h+Val], edx
		mov	[esp+38h+Str], eax ; Format
		call	printf

loc_43DEF4:				; CODE XREF: sub_43DC31+291j
					; sub_43DC31+2A4j
		add	[ebp+var_20], 1

loc_43DEF8:				; CODE XREF: sub_43DC31+281j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_43DEB4
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aDumpOptionsHel ; "--dump-options\n--help\n--version\n--wa"...
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 2Bh ; Count
		mov	[esp+38h+Val], 1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_43DF3C:				; CODE XREF: sub_43DC31+1CBj
					; sub_43DC31+1FBj ...
		cmp	[ebp+var_20], 0FFFFFFFEh
		jnz	short loc_43DF4E
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF8h
		jmp	short loc_43DF7D
; ---------------------------------------------------------------------------

loc_43DF4E:				; CODE XREF: sub_43DC31+30Fj
		cmp	[ebp+var_20], 0FFFFFFFFh
		jnz	short loc_43DF6C
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFEh
		mov	eax, [ebp+var_18]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_0]
		mov	[eax+18h], edx
		jmp	short loc_43DF7D
; ---------------------------------------------------------------------------

loc_43DF6C:				; CODE XREF: sub_43DC31+321j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx

loc_43DF7D:				; CODE XREF: sub_43DC31+31Bj
					; sub_43DC31+339j
		cmp	[ebp+var_20], 0
		js	loc_43E08A
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jz	loc_43E06B
		cmp	[ebp+var_28], 0
		jz	short loc_43DFC0
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43DFC9
		mov	[ebp+var_1C], 0
		jmp	short loc_43DFC9
; ---------------------------------------------------------------------------

loc_43DFC0:				; CODE XREF: sub_43DC31+371j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], eax

loc_43DFC9:				; CODE XREF: sub_43DC31+384j
					; sub_43DC31+38Dj
		cmp	[ebp+var_1C], 0
		jnz	short loc_43DFF1
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_43DFF1
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	loc_43E08A
; ---------------------------------------------------------------------------

loc_43DFF1:				; CODE XREF: sub_43DC31+39Cj
					; sub_43DC31+3AFj
		cmp	[ebp+var_1C], 0
		jnz	short loc_43E006
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_43E089
; ---------------------------------------------------------------------------

loc_43E006:				; CODE XREF: sub_43DC31+3C4j
		cmp	[ebp+var_28], 0
		jnz	short loc_43E035
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_43E035
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_43E035
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_43E08A
; ---------------------------------------------------------------------------

loc_43E035:				; CODE XREF: sub_43DC31+3D9j
					; sub_43DC31+3E3j ...
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_43E3E6
		cmp	[ebp+var_28], 0
		jnz	short loc_43E089
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_43E089
; ---------------------------------------------------------------------------

loc_43E06B:				; CODE XREF: sub_43DC31+367j
		cmp	[ebp+var_28], 0
		jz	short loc_43E07D
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0FFFFFFFAh
		jmp	short loc_43E08A
; ---------------------------------------------------------------------------

loc_43E07D:				; CODE XREF: sub_43DC31+43Ej
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_43E08A
; ---------------------------------------------------------------------------

loc_43E089:				; CODE XREF: sub_43DC31+3D0j
					; sub_43DC31+42Aj ...
		nop

loc_43E08A:				; CODE XREF: sub_43DC31+350j
					; sub_43DC31+3BBj ...
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_43E3C0
; ---------------------------------------------------------------------------

loc_43E09B:				; CODE XREF: sub_43DC31+F0j
					; sub_43DC31+101j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_43E0B2
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43E0C0

loc_43E0B2:				; CODE XREF: sub_43DC31+472j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	loc_43E378

loc_43E0C0:				; CODE XREF: sub_43DC31+47Fj
		mov	[ebp+var_24], 0
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_43E14B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 20h
		test	eax, eax
		jz	short loc_43E14B
		mov	[ebp+var_20], 0
		jmp	short loc_43E13C
; ---------------------------------------------------------------------------

loc_43E0FD:				; CODE XREF: sub_43DC31+518j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_43E138
		mov	eax, [ebp+var_18]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	[esp+38h+Val], edx ; Str2
		mov	[esp+38h+Str], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_43E138
		mov	[ebp+var_24], 1
		jmp	short loc_43E14B
; ---------------------------------------------------------------------------

loc_43E138:				; CODE XREF: sub_43DC31+4DAj
					; sub_43DC31+4FCj
		add	[ebp+var_20], 1

loc_43E13C:				; CODE XREF: sub_43DC31+4CAj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_43E0FD

loc_43E14B:				; CODE XREF: sub_43DC31+4A5j
					; sub_43DC31+4C1j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		add	[ebp+var_18], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_43E191
		mov	[ebp+var_20], 0
		jmp	short loc_43E17F
; ---------------------------------------------------------------------------

loc_43E163:				; CODE XREF: sub_43DC31+55Bj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	edx, eax
		jz	short loc_43E190
		add	[ebp+var_20], 1

loc_43E17F:				; CODE XREF: sub_43DC31+530j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_43E163
		jmp	short loc_43E191
; ---------------------------------------------------------------------------

loc_43E190:				; CODE XREF: sub_43DC31+548j
		nop

loc_43E191:				; CODE XREF: sub_43DC31+527j
					; sub_43DC31+55Dj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_43E1C9
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 68h
		jz	short loc_43E1B4
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Fh
		jnz	short loc_43E1C9

loc_43E1B4:				; CODE XREF: sub_43DC31+577j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax
		call	sub_43E61C
; ---------------------------------------------------------------------------

loc_43E1C9:				; CODE XREF: sub_43DC31+56Dj
					; sub_43DC31+581j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_43E22D
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 80h
		test	eax, eax
		jz	short loc_43E205
		mov	eax, 0FFFFFFF9h
		jmp	short loc_43E20A
; ---------------------------------------------------------------------------

loc_43E205:				; CODE XREF: sub_43DC31+5CBj
		mov	eax, 0FFFFFFFEh

loc_43E20A:				; CODE XREF: sub_43DC31+5D2j
		mov	edx, [ebp+arg_0]
		mov	[edx+10h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		jmp	loc_43E34D
; ---------------------------------------------------------------------------

loc_43E22D:				; CODE XREF: sub_43DC31+5B6j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jz	loc_43E334
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43E287
		cmp	[ebp+var_24], 0
		jnz	short loc_43E287
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_43E3E6
		jmp	loc_43E32B
; ---------------------------------------------------------------------------

loc_43E287:				; CODE XREF: sub_43DC31+61Ej
					; sub_43DC31+624j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_43E2B5
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_43E2B5
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_43E32B
; ---------------------------------------------------------------------------

loc_43E2B5:				; CODE XREF: sub_43DC31+663j
					; sub_43DC31+676j
		cmp	[ebp+var_1C], 0
		jnz	short loc_43E2C7
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	short loc_43E32B
; ---------------------------------------------------------------------------

loc_43E2C7:				; CODE XREF: sub_43DC31+688j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_43E2FD
		mov	eax, [ebp+var_1C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43E2FD
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_43E2FD
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_43E32B
; ---------------------------------------------------------------------------

loc_43E2FD:				; CODE XREF: sub_43DC31+69Ej
					; sub_43DC31+6ABj ...
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_43E3E6
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1

loc_43E32B:				; CODE XREF: sub_43DC31+651j
					; sub_43DC31+682j ...
		mov	[ebp+var_18], offset asc_44F514	; "x"
		jmp	short loc_43E34D
; ---------------------------------------------------------------------------

loc_43E334:				; CODE XREF: sub_43DC31+60Dj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx

loc_43E34D:				; CODE XREF: sub_43DC31+5F7j
					; sub_43DC31+701j
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43E360
		cmp	[ebp+var_24], 0
		jz	short loc_43E3BF

loc_43E360:				; CODE XREF: sub_43DC31+727j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_43E3BF
; ---------------------------------------------------------------------------

loc_43E378:				; CODE XREF: sub_43DC31+489j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 4
		test	eax, eax
		jz	short loc_43E3B0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_43E3C0
; ---------------------------------------------------------------------------

loc_43E3B0:				; CODE XREF: sub_43DC31+752j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 1
		jmp	loc_43DC95
; ---------------------------------------------------------------------------

loc_43E3BF:				; CODE XREF: sub_43DC31+72Dj
					; sub_43DC31+745j
		nop

loc_43E3C0:				; CODE XREF: sub_43DC31+74j
					; sub_43DC31+CAj ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		leave
		retn
sub_43DC31	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43E3E6(int, int, char	*)
sub_43E3E6	proc near		; CODE XREF: sub_43D24E+45Cp
					; sub_43DC31+421p ...

Str		= dword	ptr -28h
EndPtr		= dword	ptr -24h
Radix		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_43E3FD
		mov	eax, 0
		jmp	short loc_43E402
; ---------------------------------------------------------------------------

loc_43E3FD:				; CODE XREF: sub_43E3E6+Ej
		mov	eax, 0Ah

loc_43E402:				; CODE XREF: sub_43E3E6+15j
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		and	edx, 7
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jz	short loc_43E430
		cmp	eax, 4
		jz	loc_43E4BD
		cmp	eax, 1
		jnz	loc_43E562

loc_43E430:				; CODE XREF: sub_43E3E6+36j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtol
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 80000000h
		jz	short loc_43E46C
		cmp	[ebp+var_10], 7FFFFFFFh
		jnz	short loc_43E48E

loc_43E46C:				; CODE XREF: sub_43E3E6+7Bj
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 22h
		jnz	short loc_43E48E
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF4h
		mov	eax, 0FFFFFFFFh
		jmp	locret_43E570
; ---------------------------------------------------------------------------

loc_43E48E:				; CODE XREF: sub_43E3E6+84j
					; sub_43E3E6+92j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jnz	short loc_43E4A4
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+18h], edx
		jmp	short loc_43E4AD
; ---------------------------------------------------------------------------

loc_43E4A4:				; CODE XREF: sub_43E3E6+B1j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+18h], edx

loc_43E4AD:				; CODE XREF: sub_43E3E6+BCj
		mov	eax, 0
		jmp	locret_43E570
; ---------------------------------------------------------------------------

loc_43E4B7:				; CODE XREF: sub_43E3E6+F7j
		add	[ebp+arg_8], 1
		jmp	short loc_43E4BE
; ---------------------------------------------------------------------------

loc_43E4BD:				; CODE XREF: sub_43E3E6+3Bj
		nop

loc_43E4BE:				; CODE XREF: sub_43E3E6+D5j
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_43E4DF
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Str], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_43E4B7

loc_43E4DF:				; CODE XREF: sub_43E3E6+E0j
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_43E504
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF4h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_43E570
; ---------------------------------------------------------------------------

loc_43E504:				; CODE XREF: sub_43E3E6+101j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtoul
		mov	edx, [ebp+arg_0]
		mov	[edx+18h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_43E55B
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 22h
		jnz	short loc_43E55B
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF4h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_43E570
; ---------------------------------------------------------------------------

loc_43E55B:				; CODE XREF: sub_43E3E6+154j
					; sub_43E3E6+162j
		mov	eax, 0
		jmp	short locret_43E570
; ---------------------------------------------------------------------------

loc_43E562:				; CODE XREF: sub_43E3E6+44j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[eax+18h], edx
		mov	eax, 1

locret_43E570:				; CODE XREF: sub_43E3E6+A3j
					; sub_43E3E6+CCj ...
		leave
		retn
sub_43E3E6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43E572	proc near		; CODE XREF: sub_43E61C+8Ep

var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_43E613
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_43E613
		call	sub_43F627
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_43E5FE
		add	[ebp+var_C], 1
		jmp	short loc_43E5FE
; ---------------------------------------------------------------------------

loc_43E5D9:				; CODE XREF: sub_43E572+9Fj
		cmp	[ebp+var_14], 0
		jz	short loc_43E5F8
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0C0h
		cmp	eax, 80h
		jz	short loc_43E5F8
		add	[ebp+var_C], 1

loc_43E5F8:				; CODE XREF: sub_43E572+6Bj
					; sub_43E572+80j
		add	[ebp+var_10], 1
		jmp	short loc_43E5FF
; ---------------------------------------------------------------------------

loc_43E5FE:				; CODE XREF: sub_43E572+5Fj
					; sub_43E572+65j
		nop

loc_43E5FF:				; CODE XREF: sub_43E572+8Aj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43E613
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_43E5D9

loc_43E613:				; CODE XREF: sub_43E572+34j
					; sub_43E572+41j ...
		mov	eax, [ebp+var_C]
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
sub_43E572	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_43E61C	proc near		; CODE XREF: sub_43DC31+1C6p
					; sub_43DC31+593p

Str		= dword	ptr -38h
Size		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		call	sub_43EB87
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[esp+38h+Str], 29h
		call	sub_43EE3D
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	puts
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_43EA84
		mov	[ebp+var_18], 0
		mov	eax, [ebp+var_18]
		mov	[ebp+var_10], eax
		jmp	short loc_43E6CA
; ---------------------------------------------------------------------------

loc_43E66B:				; CODE XREF: sub_43E61C+BBj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_43E6C6
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_43E69E
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jz	short loc_43E6C6

loc_43E69E:				; CODE XREF: sub_43E61C+6Dj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_43E572
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jle	short loc_43E6C6
		cmp	[ebp+var_14], 22h
		jg	short loc_43E6C6
		mov	eax, [ebp+var_14]
		mov	[ebp+var_18], eax

loc_43E6C6:				; CODE XREF: sub_43E61C+5Dj
					; sub_43E61C+80j ...
		add	[ebp+var_10], 1

loc_43E6CA:				; CODE XREF: sub_43E61C+4Dj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_43E66B
		add	[ebp+var_18], 0Ah
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jz	short loc_43E6F6
		mov	[esp+38h+Str], offset aOptions ; "Options:"
		call	puts

loc_43E6F6:				; CODE XREF: sub_43E61C+CCj
		mov	[ebp+var_10], 0
		jmp	loc_43EA5B
; ---------------------------------------------------------------------------

loc_43E702:				; CODE XREF: sub_43E61C+44Cj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+38h+Str], eax ; char *
		call	sub_43C238
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_43E73A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jnz	short loc_43E73A
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_43EA56

loc_43E73A:				; CODE XREF: sub_43E61C+101j
					; sub_43E61C+10Bj
		cmp	[ebp+var_C], 0
		jz	short loc_43E7A5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jnz	short loc_43E7A5
		add	[ebp+var_C], 1
		jmp	short loc_43E78A
; ---------------------------------------------------------------------------

loc_43E750:				; CODE XREF: sub_43E61C+176j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_43E775
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43E786
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	short loc_43E786
; ---------------------------------------------------------------------------

loc_43E775:				; CODE XREF: sub_43E61C+13Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar

loc_43E786:				; CODE XREF: sub_43E61C+149j
					; sub_43E61C+157j
		add	[ebp+var_C], 1

loc_43E78A:				; CODE XREF: sub_43E61C+132j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43E750
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	loc_43EA57
; ---------------------------------------------------------------------------

loc_43E7A5:				; CODE XREF: sub_43E61C+122j
					; sub_43E61C+12Cj
		mov	[ebp+var_14], 3
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 0FFh
		jg	loc_43E859
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, offset aC_0 ; " -%c"
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Str], eax ; Format
		call	printf
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_43E882
		cmp	[ebp+var_C], 0
		jz	loc_43E882
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_43E882
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1
		jmp	short loc_43E835
; ---------------------------------------------------------------------------

loc_43E81C:				; CODE XREF: sub_43E61C+22Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1

loc_43E835:				; CODE XREF: sub_43E61C+1FEj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43E849
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_43E81C

loc_43E849:				; CODE XREF: sub_43E61C+221j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43E882
		add	[ebp+var_C], 1
		jmp	short loc_43E882
; ---------------------------------------------------------------------------

loc_43E859:				; CODE XREF: sub_43E61C+1A0j
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset asc_44F524 ; "   "
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 3 ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite

loc_43E882:				; CODE XREF: sub_43E61C+1D0j
					; sub_43E61C+1DAj ...
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	loc_43E985
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 0FFh
		jg	short loc_43E8BB
		mov	eax, 2Ch
		jmp	short loc_43E8C0
; ---------------------------------------------------------------------------

loc_43E8BB:				; CODE XREF: sub_43E61C+296j
		mov	eax, 20h

loc_43E8C0:				; CODE XREF: sub_43E61C+29Dj
		mov	edx, offset aCS	; "%c --%s"
		mov	[esp+38h+Count], ecx
		mov	[esp+38h+Size],	eax
		mov	[esp+38h+Str], edx ; Format
		call	printf
		add	[ebp+var_14], eax
		cmp	[ebp+var_C], 0
		jz	short loc_43E946
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_43E946
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_43E923
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1
		jmp	short loc_43E923
; ---------------------------------------------------------------------------

loc_43E908:				; CODE XREF: sub_43E61C+31Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1
		jmp	short loc_43E924
; ---------------------------------------------------------------------------

loc_43E923:				; CODE XREF: sub_43E61C+2D8j
					; sub_43E61C+2EAj
		nop

loc_43E924:				; CODE XREF: sub_43E61C+305j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43E938
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_43E908

loc_43E938:				; CODE XREF: sub_43E61C+310j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43E946
		add	[ebp+var_C], 1

loc_43E946:				; CODE XREF: sub_43E61C+2C0j
					; sub_43E61C+2CAj ...
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset asc_44F524 ; "   "
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 3 ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		add	[ebp+var_14], 3
		jmp	short loc_43E985
; ---------------------------------------------------------------------------

loc_43E975:				; CODE XREF: sub_43E61C+36Fj
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_43E985:				; CODE XREF: sub_43E61C+274j
					; sub_43E61C+357j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_43E975
		cmp	[ebp+var_C], 0
		jz	loc_43EA48
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_43EA3D
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jle	loc_43EA3D
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[ebp+var_14], 0
		jmp	short loc_43E9D6
; ---------------------------------------------------------------------------

loc_43E9C6:				; CODE XREF: sub_43E61C+3C0j
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_43E9D6:				; CODE XREF: sub_43E61C+3A8j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_43E9C6
		jmp	short loc_43EA3D
; ---------------------------------------------------------------------------

loc_43E9E0:				; CODE XREF: sub_43E61C+42Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_43EA26
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43EA37
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[ebp+var_14], 0
		jmp	short loc_43EA1C
; ---------------------------------------------------------------------------

loc_43EA0C:				; CODE XREF: sub_43E61C+406j
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_43EA1C:				; CODE XREF: sub_43E61C+3EEj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_43EA0C
		jmp	short loc_43EA37
; ---------------------------------------------------------------------------

loc_43EA26:				; CODE XREF: sub_43E61C+3CCj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar

loc_43EA37:				; CODE XREF: sub_43E61C+3D9j
					; sub_43E61C+408j
		add	[ebp+var_C], 1
		jmp	short loc_43EA3E
; ---------------------------------------------------------------------------

loc_43EA3D:				; CODE XREF: sub_43E61C+383j
					; sub_43E61C+38Fj ...
		nop

loc_43EA3E:				; CODE XREF: sub_43E61C+41Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43E9E0

loc_43EA48:				; CODE XREF: sub_43E61C+375j
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	short loc_43EA57
; ---------------------------------------------------------------------------

loc_43EA56:				; CODE XREF: sub_43E61C+118j
		nop

loc_43EA57:				; CODE XREF: sub_43E61C+184j
					; sub_43E61C+438j
		add	[ebp+var_10], 1

loc_43EA5B:				; CODE XREF: sub_43E61C+E1j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_43E702
		mov	eax, [ebp+arg_4]
		and	eax, 20h
		test	eax, eax
		jz	short loc_43EA84
		mov	[esp+38h+Str], offset aASingleDashMay ;	"\n(A single dash may be used instead of"...
		call	puts

loc_43EA84:				; CODE XREF: sub_43E61C+3Aj
					; sub_43E61C+45Aj
		mov	[esp+38h+Str], 13h
		call	sub_43EE3D
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_43EB6B
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[esp+38h+Size],	offset a@email@	; "@EMAIL@"
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	strstr
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_43EB54
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		cmp	edx, eax
		jz	short loc_43EB04
		mov	eax, ds:_iob
		lea	ecx, [eax+20h]
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+File],	ecx ; File
		mov	[esp+38h+Count], 1 ; Count
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite

loc_43EB04:				; CODE XREF: sub_43E61C+4B5j
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aHttpBugs_gnupg ; "http://bugs.gnupg.org"
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 15h ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		add	[ebp+var_1C], 7
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43EB6B
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Size],	edx ; File
		mov	[esp+38h+Str], eax ; Str
		call	fputs
		jmp	short loc_43EB6B
; ---------------------------------------------------------------------------

loc_43EB54:				; CODE XREF: sub_43E61C+4A7j
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+38h+Size],	eax ; File
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	fputs

loc_43EB6B:				; CODE XREF: sub_43E61C+47Bj
					; sub_43E61C+51Dj ...
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+38h+Str], eax ; File
		call	fflush
		mov	[esp+38h+Str], 0 ; Code
		call	exit
sub_43E61C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43EB87	proc near		; CODE XREF: sub_43DC31+201p
					; sub_43E61C+7p

Str		= dword	ptr -28h
File		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, ds:_iob
		lea	ebx, [eax+20h]
		mov	[esp+28h+Str], 0Bh
		call	sub_43EE3D
		mov	[esp+28h+File],	ebx ; File
		mov	[esp+28h+Str], eax ; Str
		call	fputs
		mov	[esp+28h+Str], 0Ch
		call	sub_43EE3D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_43EBD7
		mov	eax, offset aS_5 ; " (%s)"
		mov	edx, [ebp+var_10]
		mov	[esp+28h+File],	edx
		mov	[esp+28h+Str], eax ; Format
		call	printf

loc_43EBD7:				; CODE XREF: sub_43EB87+3Aj
		mov	[esp+28h+Str], 0Dh
		call	sub_43EE3D
		mov	edx, offset aSS	; " %s %s\n"
		mov	[esp+28h+var_20], offset aGpg4win2_3_1 ; "(Gpg4win 2.3.1)"
		mov	[esp+28h+File],	eax
		mov	[esp+28h+Str], edx ; Format
		call	printf
		mov	[ebp+var_C], 14h
		jmp	short loc_43EC28
; ---------------------------------------------------------------------------

loc_43EC05:				; CODE XREF: sub_43EB87+A5j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_43EE3D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_43EC24
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_43EC24:				; CODE XREF: sub_43EB87+90j
		add	[ebp+var_C], 1

loc_43EC28:				; CODE XREF: sub_43EB87+7Cj
		cmp	[ebp+var_C], 1Dh
		jle	short loc_43EC05
		mov	[esp+28h+Str], 0Eh
		call	sub_43EE3D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_43EC4E
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_43EC4E:				; CODE XREF: sub_43EB87+BAj
		mov	[esp+28h+Str], 0Ah
		call	sub_43EE3D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_43EC6E
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_43EC6E:				; CODE XREF: sub_43EB87+DAj
		mov	[esp+28h+Str], 0Fh
		call	sub_43EE3D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_43EC9A
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_43EC9A:				; CODE XREF: sub_43EB87+FAj
		mov	[esp+28h+Str], 12h
		call	sub_43EE3D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_43ECC6
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_43ECC6:				; CODE XREF: sub_43EB87+126j
		mov	[ebp+var_C], 1Eh
		jmp	short loc_43ECFE
; ---------------------------------------------------------------------------

loc_43ECCF:				; CODE XREF: sub_43EB87+17Bj
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_43EE3D
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_43ECFA
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_43ECFA:				; CODE XREF: sub_43EB87+15Aj
		add	[ebp+var_C], 1

loc_43ECFE:				; CODE XREF: sub_43EB87+146j
		cmp	[ebp+var_C], 27h
		jle	short loc_43ECCF
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+Str], eax ; File
		call	fflush
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_43EB87	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_43ED8C
		mov	dword ptr [esp], 0Eh
		call	sub_43EE3D
		mov	esi, eax
		mov	dword ptr [esp], 0Dh
		call	sub_43EE3D
		mov	ebx, eax
		mov	dword ptr [esp], 0Bh
		call	sub_43EE3D
		mov	edx, offset aSSS_0 ; "%s %s; %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+10h], esi
		mov	[esp+0Ch], ebx
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	[esp], ecx
		call	fprintf
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp], eax
		call	fflush
		jmp	loc_43EE35
; ---------------------------------------------------------------------------

loc_43ED8C:				; CODE XREF: .text:0043ED27j
		cmp	dword ptr [ebp+8], 1
		jnz	short loc_43EE0F
		mov	dword ptr [esp], 28h
		call	sub_43EE3D
		mov	[ebp-1Ch], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+4], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	fputs
		mov	eax, [ebp-1Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43EE03
		mov	eax, [ebp-1Ch]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp-1Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_43EE03
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+4], eax
		mov	dword ptr [esp], 0Ah
		call	putc

loc_43EE03:				; CODE XREF: .text:0043EDC0j
					; .text:0043EDE9j
		mov	dword ptr [esp], 2
		call	exit
; ---------------------------------------------------------------------------

loc_43EE0F:				; CODE XREF: .text:0043ED90j
		cmp	dword ptr [ebp+8], 2
		jnz	short loc_43EE35
		mov	dword ptr [esp], 29h
		call	sub_43EE3D
		mov	[esp], eax
		call	puts
		mov	dword ptr [esp], 0
		call	exit
; ---------------------------------------------------------------------------

loc_43EE35:				; CODE XREF: .text:0043ED87j
					; .text:0043EE13j
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43EE3D	proc near		; CODE XREF: sub_401C11+9E7p
					; sub_401C11+9F5p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_451900
		test	eax, eax
		jz	short loc_43EE5C
		mov	edx, ds:dword_451900
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx ; dword_451900
		jmp	short loc_43EE61
; ---------------------------------------------------------------------------

loc_43EE5C:				; CODE XREF: sub_43EE3D+Dj
		mov	eax, 0

loc_43EE61:				; CODE XREF: sub_43EE3D+1Dj
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_43EE6F
		mov	eax, [ebp+var_C]
		jmp	short locret_43EEC4
; ---------------------------------------------------------------------------

loc_43EE6F:				; CODE XREF: sub_43EE3D+2Bj
		mov	eax, [ebp+arg_0]
		sub	eax, 0Ah	; switch 32 cases
		cmp	eax, 1Fh
		ja	short loc_43EEC1 ; jumptable 0043EE81 default case
		mov	eax, ds:off_44F910[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_43EE83:				; CODE XREF: sub_43EE3D+44j
					; DATA XREF: .rdata:off_44F910o
		mov	[ebp+var_C], offset aLicenseGplv3Gn ; jumptable	0043EE81 case 10
		jmp	short loc_43EEC1 ; jumptable 0043EE81 default case
; ---------------------------------------------------------------------------

loc_43EE8C:				; CODE XREF: sub_43EE3D+44j
					; DATA XREF: .rdata:off_44F910o
		mov	[ebp+var_C], offset aFoo ; jumptable 0043EE81 case 11
		jmp	short loc_43EEC1 ; jumptable 0043EE81 default case
; ---------------------------------------------------------------------------

loc_43EE95:				; CODE XREF: sub_43EE3D+44j
					; DATA XREF: .rdata:off_44F910o
		mov	[ebp+var_C], offset a0_0 ; jumptable 0043EE81 case 13
		jmp	short loc_43EEC1 ; jumptable 0043EE81 default case
; ---------------------------------------------------------------------------

loc_43EE9E:				; CODE XREF: sub_43EE3D+44j
					; DATA XREF: .rdata:off_44F910o
		mov	[ebp+var_C], offset aCopyrightC2015 ; jumptable	0043EE81 case 14
		jmp	short loc_43EEC1 ; jumptable 0043EE81 default case
; ---------------------------------------------------------------------------

loc_43EEA7:				; CODE XREF: sub_43EE3D+44j
					; DATA XREF: .rdata:off_44F910o
		mov	[ebp+var_C], offset aThisIsFreeSoft ; jumptable	0043EE81 case 15
		jmp	short loc_43EEC1 ; jumptable 0043EE81 default case
; ---------------------------------------------------------------------------

loc_43EEB0:				; CODE XREF: sub_43EE3D+44j
					; DATA XREF: .rdata:off_44F910o
		mov	[ebp+var_C], offset aThisIsFreeSo_0 ; jumptable	0043EE81 case 16
		jmp	short loc_43EEC1 ; jumptable 0043EE81 default case
; ---------------------------------------------------------------------------

loc_43EEB9:				; CODE XREF: sub_43EE3D+44j
					; DATA XREF: .rdata:off_44F910o
		mov	[ebp+var_C], offset dword_44F90C ; jumptable 0043EE81 cases 40,41
		nop

loc_43EEC1:				; CODE XREF: sub_43EE3D+3Bj
					; sub_43EE3D+44j ...
		mov	eax, [ebp+var_C] ; jumptable 0043EE81 default case

locret_43EEC4:				; CODE XREF: sub_43EE3D+30j
		leave
		retn
sub_43EE3D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43EEC6	proc near		; CODE XREF: sub_401C11+D6p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ds:dword_451900, eax
		pop	ebp
		retn
sub_43EEC6	endp

; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		jmp	short loc_43EEF5
; ---------------------------------------------------------------------------

loc_43EEDC:				; CODE XREF: .text:0043EEF9j
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	gcry_free
		mov	eax, [ebp-0Ch]
		mov	[ebp+8], eax

loc_43EEF5:				; CODE XREF: .text:0043EEDAj
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_43EEDC
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43EEFD(int, char *)
sub_43EEFD	proc near		; CODE XREF: sub_401C11+8D0p
					; .text:0043EF84p ...

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 0Ch
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_C]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Source], eax ;	Source
		mov	[esp+38h+Dest],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_43EEFD	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_43EF8E
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_43EEFD
		mov	[ebp-0Ch], eax
		jmp	short loc_43EFBC
; ---------------------------------------------------------------------------

loc_43EF8E:				; CODE XREF: .text:0043EF75j
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_43F631
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_43EEFD
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	gcry_free

loc_43EFBC:				; CODE XREF: .text:0043EF8Cj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_43EFC1(int, char *)
sub_43EFC1	proc near		; CODE XREF: .text:0043F075p
					; .text:0043F09Ap

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 0Ch
		mov	[esp+38h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_10]
		lea	edx, [eax+8]
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Source], eax ;	Source
		mov	[esp+38h+Dest],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_43F030
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_43F053
; ---------------------------------------------------------------------------

loc_43F030:				; CODE XREF: sub_43EFC1+63j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		jmp	short loc_43F042
; ---------------------------------------------------------------------------

loc_43F03A:				; CODE XREF: sub_43EFC1+88j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_43F042:				; CODE XREF: sub_43EFC1+77j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_43F03A
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_43F053:				; CODE XREF: sub_43EFC1+6Dj
		mov	eax, [ebp+var_10]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_43EFC1	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_43F07F
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_43EFC1
		mov	[ebp-0Ch], eax
		jmp	short loc_43F0AD
; ---------------------------------------------------------------------------

loc_43F07F:				; CODE XREF: .text:0043F066j
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_43F631
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_43EFC1
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	gcry_free

loc_43F0AD:				; CODE XREF: .text:0043F07Dj
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	dword ptr [ebp-10h], 0
		lea	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	short loc_43F13B
; ---------------------------------------------------------------------------

loc_43F0C8:				; CODE XREF: .text:0043F13Fj
		mov	eax, [ebp+8]
		add	eax, 8
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 0Ch
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	edx, [ebp+8]
		mov	edx, [edx+4]
		mov	[eax+4], edx
		mov	eax, [ebp+8]
		add	eax, 8
		mov	edx, [ebp-14h]
		add	edx, 8
		mov	[esp+4], eax
		mov	[esp], edx
		call	strcpy
		mov	eax, [ebp-14h]
		mov	dword ptr [eax], 0
		mov	edx, [ebp-14h]
		mov	eax, [ebp-0Ch]
		mov	[eax], edx
		lea	eax, [ebp-14h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[ebp+8], eax

loc_43F13B:				; CODE XREF: .text:0043F0C6j
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_43F0C8
		mov	eax, [ebp-10h]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	dword ptr [ebp-4], 0
		jmp	short loc_43F167
; ---------------------------------------------------------------------------

loc_43F159:				; CODE XREF: .text:0043F173j
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[ebp+8], eax

loc_43F167:				; CODE XREF: .text:0043F157j
		cmp	dword ptr [ebp+8], 0
		jz	short loc_43F175
		mov	eax, [ebp+8]
		cmp	eax, [ebp+0Ch]
		jnz	short loc_43F159

loc_43F175:				; CODE XREF: .text:0043F16Bj
		mov	eax, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_43F196
		jmp	short loc_43F18D
; ---------------------------------------------------------------------------

loc_43F185:				; CODE XREF: .text:0043F194j
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[ebp+8], eax

loc_43F18D:				; CODE XREF: .text:0043F183j
		mov	eax, [ebp+8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_43F185

loc_43F196:				; CODE XREF: .text:0043F181j
		mov	eax, [ebp+8]
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_43F211
		mov	eax, [ebp-10h]
		add	eax, 8
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp], eax
		call	gcry_xmalloc
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-10h]
		add	eax, 8
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	strcpy
		mov	eax, [ebp-10h]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	gcry_free

loc_43F211:				; CODE XREF: .text:0043F1B5j
		mov	eax, [ebp-0Ch]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43F21C	proc near		; CODE XREF: sub_43F31B+27Bp
					; sub_43F31B+2C4p ...

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_43F2B1
		cmp	[ebp+arg_0], 0
		jz	short loc_43F275
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aUtf8_0 ; "utf-8"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_43F275
		mov	eax, ds:dword_451934
		mov	[ebp+var_1C], eax
		mov	ds:dword_451934, 1
		jmp	short loc_43F287
; ---------------------------------------------------------------------------

loc_43F275:				; CODE XREF: sub_43F21C+1Bj
					; sub_43F21C+43j
		mov	eax, ds:dword_451938
		mov	[ebp+var_1C], eax
		mov	ds:dword_451938, 1

loc_43F287:				; CODE XREF: sub_43F21C+57j
		cmp	[ebp+var_1C], 0
		jnz	short loc_43F2EF
		mov	[esp+38h+var_38], offset aConversionFrom ; "conversion from `%s' to `%s' not availa"...
		call	sub_43C238
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+var_30], edx
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], edx	; char
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_43CAF7
		jmp	short loc_43F2EF
; ---------------------------------------------------------------------------

loc_43F2B1:				; CODE XREF: sub_43F21C+15j
		mov	eax, ds:dword_45193C
		test	eax, eax
		jnz	short loc_43F2E5
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+38h+var_38], eax ;	int
		call	strerror
		mov	ebx, eax
		mov	[esp+38h+var_38], offset aIconv_openFail ; "iconv_open failed: %s\n"
		call	sub_43C238
		mov	dword ptr [esp+38h+var_34], ebx	; char
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_43CAF7

loc_43F2E5:				; CODE XREF: sub_43F21C+9Cj
		mov	ds:dword_45193C, 1

loc_43F2EF:				; CODE XREF: sub_43F21C+6Fj
					; sub_43F21C+93j
		cmp	[ebp+arg_8], 0
		jz	short loc_43F313
		mov	off_444C40, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_451904, 0
		mov	ds:dword_451908, 0

loc_43F313:				; CODE XREF: sub_43F21C+D7j
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_43F21C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43F31B	proc near		; CODE XREF: sub_4257EC+Dp

Dest		= dword	ptr -38h
Format		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Str2		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	[ebp+arg_0], 0
		jnz	loc_43F425
		mov	eax, ds:GetConsoleOutputCP
		call	eax ; GetConsoleOutputCP
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_43F346
		mov	eax, ds:GetACP
		call	eax ; GetACP
		mov	[ebp+var_C], eax

loc_43F346:				; CODE XREF: sub_43F31B+1Fj
		mov	eax, offset aCpU ; "CP%u"
		mov	edx, [ebp+var_C]
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Format], eax ;	Format
		mov	[esp+38h+Dest],	offset byte_451914 ; Dest
		call	sprintf
		mov	[ebp+arg_0], offset byte_451914
		mov	[ebp+Str2], offset aCp936 ; "CP936"
		jmp	loc_43F417
; ---------------------------------------------------------------------------

loc_43F375:				; CODE XREF: sub_43F31B+104j
		mov	eax, [ebp+Str2]
		mov	[esp+38h+Format], eax ;	Str2
		mov	[esp+38h+Dest],	offset byte_451914 ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_43F3A3
		mov	eax, [ebp+Str2]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	short loc_43F3CD
		mov	eax, [ebp+Str2]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43F3CD

loc_43F3A3:				; CODE XREF: sub_43F31B+6Fj
		mov	eax, [ebp+Str2]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	eax, [ebp+Str2]
		mov	[ebp+arg_0], eax
		jmp	short loc_43F425
; ---------------------------------------------------------------------------

loc_43F3CD:				; CODE XREF: sub_43F31B+79j
					; sub_43F31B+86j
		mov	eax, [ebp+Str2]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp+Str2], eax
		mov	eax, [ebp+Str2]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp+Str2], eax

loc_43F417:				; CODE XREF: sub_43F31B+55j
		mov	eax, [ebp+Str2]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_43F375

loc_43F425:				; CODE XREF: sub_43F31B+Bj
					; sub_43F31B+B0j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 3
		jbe	short loc_43F48A
		mov	[esp+38h+var_30], 3
		mov	[esp+38h+Format], offset aIso ;	"iso"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_43A047
		test	eax, eax
		jnz	short loc_43F48A
		add	[ebp+arg_0], 3
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jz	short loc_43F486
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Fh
		jnz	short loc_43F48A

loc_43F486:				; CODE XREF: sub_43F31B+15Fj
		add	[ebp+arg_0], 1

loc_43F48A:				; CODE XREF: sub_43F31B+132j
					; sub_43F31B+151j ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_43F4F0
		mov	[esp+38h+Format], offset a88591	; "8859-1"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_439F0D
		test	eax, eax
		jz	short loc_43F4F0
		mov	[esp+38h+Format], offset a646 ;	"646"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_439F0D
		test	eax, eax
		jz	short loc_43F4F0
		mov	[esp+38h+Format], offset aAscii	; "ASCII"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_439F0D
		test	eax, eax
		jz	short loc_43F4F0
		mov	[esp+38h+Format], offset aAnsi_x3_41968	; "ANSI_X3.4-1968"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_439F0D
		test	eax, eax
		jnz	short loc_43F513

loc_43F4F0:				; CODE XREF: sub_43F31B+177j
					; sub_43F31B+18Ej ...
		mov	off_444C40, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_451904, 0
		mov	ds:dword_451908, 0
		jmp	loc_43F612
; ---------------------------------------------------------------------------

loc_43F513:				; CODE XREF: sub_43F31B+1D3j
		mov	[esp+38h+Format], offset aUtf8_1 ; "utf8"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_439F0D
		test	eax, eax
		jz	short loc_43F541
		mov	[esp+38h+Format], offset aUtf8_0 ; "utf-8"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_439F0D
		test	eax, eax
		jnz	short loc_43F564

loc_43F541:				; CODE XREF: sub_43F31B+20Dj
		mov	off_444C40, offset aUtf8_0 ; "utf-8"
		mov	ds:dword_451904, 1
		mov	ds:dword_451908, 0
		jmp	loc_43F612
; ---------------------------------------------------------------------------

loc_43F564:				; CODE XREF: sub_43F31B+224j
		mov	[esp+38h+Format], offset aUtf8_0 ; "utf-8"
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Dest],	eax
		call	libiconv_open
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_43F5A2
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+Format], offset aUtf8_0 ; "utf-8"
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Dest],	eax
		call	sub_43F21C
		mov	eax, 0FFFFFFFFh
		jmp	short loc_43F617
; ---------------------------------------------------------------------------

loc_43F5A2:				; CODE XREF: sub_43F31B+263j
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dest],	eax
		call	libiconv_close
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Format], eax
		mov	[esp+38h+Dest],	offset aUtf8_0 ; "utf-8"
		call	libiconv_open
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_43F5EB
		mov	[esp+38h+var_30], 0
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Format], eax
		mov	[esp+38h+Dest],	offset aUtf8_0 ; "utf-8"
		call	sub_43F21C
		mov	eax, 0FFFFFFFFh
		jmp	short loc_43F617
; ---------------------------------------------------------------------------

loc_43F5EB:				; CODE XREF: sub_43F31B+2ACj
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dest],	eax
		call	libiconv_close
		mov	eax, [ebp+var_14]
		mov	off_444C40, eax
		mov	ds:dword_451904, 0
		mov	ds:dword_451908, 1

loc_43F612:				; CODE XREF: sub_43F31B+1F3j
					; sub_43F31B+244j
		mov	eax, 0

loc_43F617:				; CODE XREF: sub_43F31B+285j
					; sub_43F31B+2CEj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_43F31B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, off_444C40
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43F627	proc near		; CODE XREF: sub_43E572+43p
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_451904
		pop	ebp
		retn
sub_43F627	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43F631	proc near		; CODE XREF: .text:0043EF94p
					; .text:0043F085p ...

Dest		= dword	ptr -78h
Source		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_4C		= dword	ptr -4Ch
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_28], 0
		mov	eax, ds:dword_451904
		test	eax, eax
		jz	short loc_43F663
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Dest],	eax
		call	gcry_xstrdup
		mov	[ebp+var_20], eax
		jmp	loc_43F872
; ---------------------------------------------------------------------------

loc_43F663:				; CODE XREF: sub_43F631+1Dj
		mov	eax, ds:dword_451908
		test	eax, eax
		jnz	loc_43F719
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_43F68E
; ---------------------------------------------------------------------------

loc_43F678:				; CODE XREF: sub_43F631+65j
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_43F68A
		add	[ebp+var_28], 1

loc_43F68A:				; CODE XREF: sub_43F631+53j
		add	[ebp+var_1C], 1

loc_43F68E:				; CODE XREF: sub_43F631+45j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43F678
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[esp+78h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_43F704
; ---------------------------------------------------------------------------

loc_43F6B7:				; CODE XREF: sub_43F631+DBj
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_43F6F1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		shr	al, 6
		or	eax, 0FFFFFFC0h
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		and	eax, 3Fh
		or	eax, 0FFFFFF80h
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_43F700
; ---------------------------------------------------------------------------

loc_43F6F1:				; CODE XREF: sub_43F631+8Ej
		mov	eax, [ebp+var_1C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_43F700:				; CODE XREF: sub_43F631+BEj
		add	[ebp+var_1C], 1

loc_43F704:				; CODE XREF: sub_43F631+84j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43F6B7
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		jmp	loc_43F872
; ---------------------------------------------------------------------------

loc_43F719:				; CODE XREF: sub_43F631+39j
		mov	eax, off_444C40
		mov	[esp+78h+Source], eax
		mov	[esp+78h+Dest],	offset aUtf8_0 ; "utf-8"
		call	libiconv_open
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0FFFFFFFFh
		jnz	short loc_43F764
		mov	eax, off_444C40
		mov	[esp+78h+var_70], 1
		mov	[esp+78h+Source], eax
		mov	[esp+78h+Dest],	offset aUtf8_0 ; "utf-8"
		call	sub_43F21C
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Dest],	eax
		call	sub_43F631
		jmp	loc_43F875
; ---------------------------------------------------------------------------

loc_43F764:				; CODE XREF: sub_43F631+104j
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_43F782
; ---------------------------------------------------------------------------

loc_43F76C:				; CODE XREF: sub_43F631+159j
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_43F77E
		add	[ebp+var_28], 5

loc_43F77E:				; CODE XREF: sub_43F631+147j
		add	[ebp+var_1C], 1

loc_43F782:				; CODE XREF: sub_43F631+139j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_43F76C
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[esp+78h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_40], eax
		lea	eax, [ebp+var_40]
		mov	[esp+78h+var_68], eax
		lea	eax, [ebp+var_38]
		mov	[esp+78h+var_6C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+78h+var_70], eax
		lea	eax, [ebp+var_34]
		mov	[esp+78h+Source], eax
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Dest],	eax
		call	libiconv
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_43F861
		mov	eax, ds:dword_451910
		test	eax, eax
		jnz	short loc_43F843
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+78h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	esi, off_444C40
		mov	[esp+78h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_43C238
		mov	[esp+78h+var_6C], ebx
		mov	[esp+78h+var_70], offset aUtf8_0 ; "utf-8"
		mov	[esp+78h+Source], esi ;	char
		mov	[esp+78h+Dest],	eax ; char *
		call	sub_43CAF7

loc_43F843:				; CODE XREF: sub_43F631+1D3j
		mov	ds:dword_451910, 1
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Source], eax ;	Source
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Dest],	eax ; Dest
		call	strcpy
		jmp	short loc_43F867
; ---------------------------------------------------------------------------

loc_43F861:				; CODE XREF: sub_43F631+1CAj
		mov	eax, [ebp+var_38]
		mov	byte ptr [eax],	0

loc_43F867:				; CODE XREF: sub_43F631+22Ej
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Dest],	eax
		call	libiconv_close

loc_43F872:				; CODE XREF: sub_43F631+2Dj
					; sub_43F631+E3j
		mov	eax, [ebp+var_20]

loc_43F875:				; CODE XREF: sub_43F631+12Ej
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_43F631	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_43F87D	proc near		; CODE XREF: sub_43F87D+797p
					; sub_44004F+23p

Dest		= dword	ptr -88h
Format		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		add	esp, 0FFFFFF80h
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 0
		mov	[ebp+var_30], 0

loc_43F8A1:				; CODE XREF: sub_43F87D+5EDj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_14]
		mov	[ebp+var_C], eax
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		jmp	loc_43FE43
; ---------------------------------------------------------------------------

loc_43F8C6:				; CODE XREF: sub_43F87D+5CAj
		cmp	[ebp+var_30], 0
		jz	short loc_43F925
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_43F91E
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	short loc_43F8EA
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FDh
		jbe	short loc_43F91E

loc_43F8EA:				; CODE XREF: sub_43F87D+61j
		cmp	[ebp+var_24], 0
		jz	short loc_43F915
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_43F915:				; CODE XREF: sub_43F87D+71j
		add	[ebp+var_1C], 4
		jmp	loc_43FE3B
; ---------------------------------------------------------------------------

loc_43F91E:				; CODE XREF: sub_43F87D+57j
					; sub_43F87D+6Bj
		mov	[ebp+var_30], 0

loc_43F925:				; CODE XREF: sub_43F87D+4Dj
		cmp	[ebp+var_C], 0
		jnz	loc_43FC58
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	loc_43FAB0
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jz	loc_43FA90
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_43F981
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_43F981
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_8]
		jz	short loc_43F981
		cmp	[ebp+arg_8], 0
		jz	loc_43FA90
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_43FA90

loc_43F981:				; CODE XREF: sub_43F87D+D2j
					; sub_43F87D+DCj ...
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_43F995
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_24], 1

loc_43F995:				; CODE XREF: sub_43F87D+10Cj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, 0Dh	; switch 14 cases
		ja	loc_43FA46	; jumptable 0043F9AE default case
		mov	eax, ds:off_44FB88[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_43F9B0:				; CODE XREF: sub_43F87D+131j
					; DATA XREF: .rdata:off_44FB88o
		add	[ebp+var_1C], 1	; jumptable 0043F9AE case 10
		cmp	[ebp+var_24], 0
		jz	loc_43FA77
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	6Eh
		add	[ebp+var_24], 1
		jmp	loc_43FA77
; ---------------------------------------------------------------------------

loc_43F9CD:				; CODE XREF: sub_43F87D+131j
					; DATA XREF: .rdata:off_44FB88o
		add	[ebp+var_1C], 1	; jumptable 0043F9AE case 13
		cmp	[ebp+var_24], 0
		jz	loc_43FA7A
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	72h
		add	[ebp+var_24], 1
		jmp	loc_43FA7A
; ---------------------------------------------------------------------------

loc_43F9EA:				; CODE XREF: sub_43F87D+131j
					; DATA XREF: .rdata:off_44FB88o
		add	[ebp+var_1C], 1	; jumptable 0043F9AE case 12
		cmp	[ebp+var_24], 0
		jz	loc_43FA7D
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	66h
		add	[ebp+var_24], 1
		jmp	short loc_43FA7D
; ---------------------------------------------------------------------------

loc_43FA04:				; CODE XREF: sub_43F87D+131j
					; DATA XREF: .rdata:off_44FB88o
		add	[ebp+var_1C], 1	; jumptable 0043F9AE case 11
		cmp	[ebp+var_24], 0
		jz	short loc_43FA80
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	76h
		add	[ebp+var_24], 1
		jmp	short loc_43FA80
; ---------------------------------------------------------------------------

loc_43FA1A:				; CODE XREF: sub_43F87D+131j
					; DATA XREF: .rdata:off_44FB88o
		add	[ebp+var_1C], 1	; jumptable 0043F9AE case 8
		cmp	[ebp+var_24], 0
		jz	short loc_43FA83
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	62h
		add	[ebp+var_24], 1
		jmp	short loc_43FA83
; ---------------------------------------------------------------------------

loc_43FA30:				; CODE XREF: sub_43F87D+131j
					; DATA XREF: .rdata:off_44FB88o
		add	[ebp+var_1C], 1	; jumptable 0043F9AE case 0
		cmp	[ebp+var_24], 0
		jz	short loc_43FA86
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	30h
		add	[ebp+var_24], 1
		jmp	short loc_43FA86
; ---------------------------------------------------------------------------

loc_43FA46:				; CODE XREF: sub_43F87D+124j
					; sub_43F87D+131j
					; DATA XREF: ...
		add	[ebp+var_1C], 3	; jumptable 0043F9AE default case
		cmp	[ebp+var_24], 0
		jz	short loc_43FA89
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_2 ; "x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 3
		jmp	short loc_43FA89
; ---------------------------------------------------------------------------

loc_43FA77:				; CODE XREF: sub_43F87D+13Bj
					; sub_43F87D+14Bj
		nop
		jmp	short loc_43FA8A
; ---------------------------------------------------------------------------

loc_43FA7A:				; CODE XREF: sub_43F87D+158j
					; sub_43F87D+168j
		nop
		jmp	short loc_43FA8A
; ---------------------------------------------------------------------------

loc_43FA7D:				; CODE XREF: sub_43F87D+175j
					; sub_43F87D+185j
		nop
		jmp	short loc_43FA8A
; ---------------------------------------------------------------------------

loc_43FA80:				; CODE XREF: sub_43F87D+18Fj
					; sub_43F87D+19Bj
		nop
		jmp	short loc_43FA8A
; ---------------------------------------------------------------------------

loc_43FA83:				; CODE XREF: sub_43F87D+1A5j
					; sub_43F87D+1B1j
		nop
		jmp	short loc_43FA8A
; ---------------------------------------------------------------------------

loc_43FA86:				; CODE XREF: sub_43F87D+1BBj
					; sub_43F87D+1C7j
		nop
		jmp	short loc_43FA8A
; ---------------------------------------------------------------------------

loc_43FA89:				; CODE XREF: sub_43F87D+1D1j
					; sub_43F87D+1F8j
		nop

loc_43FA8A:				; CODE XREF: sub_43F87D+1FBj
					; sub_43F87D+1FEj ...
		nop
		jmp	loc_43FE3B
; ---------------------------------------------------------------------------

loc_43FA90:				; CODE XREF: sub_43F87D+C4j
					; sub_43F87D+F0j ...
		cmp	[ebp+var_24], 0
		jz	short loc_43FAA7
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_43FAA7:				; CODE XREF: sub_43F87D+217j
		add	[ebp+var_1C], 1
		jmp	loc_43FE3B
; ---------------------------------------------------------------------------

loc_43FAB0:				; CODE XREF: sub_43F87D+BAj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0E0h
		cmp	eax, 0C0h
		jnz	short loc_43FAF9
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 1
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_43FE3B
; ---------------------------------------------------------------------------

loc_43FAF9:				; CODE XREF: sub_43F87D+246j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F0h
		cmp	eax, 0E0h
		jnz	short loc_43FB42
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 2
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_43FE3B
; ---------------------------------------------------------------------------

loc_43FB42:				; CODE XREF: sub_43F87D+28Fj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F8h
		cmp	eax, 0F0h
		jnz	short loc_43FB8B
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 7
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 3
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_43FE3B
; ---------------------------------------------------------------------------

loc_43FB8B:				; CODE XREF: sub_43F87D+2D8j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FCh
		cmp	eax, 0F8h
		jnz	short loc_43FBD4
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 4
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_43FE3B
; ---------------------------------------------------------------------------

loc_43FBD4:				; CODE XREF: sub_43F87D+321j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FEh
		cmp	eax, 0FCh
		jnz	short loc_43FC1D
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 5
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_43FE3B
; ---------------------------------------------------------------------------

loc_43FC1D:				; CODE XREF: sub_43F87D+36Aj
		cmp	[ebp+var_24], 0
		jz	short loc_43FC48
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_43FC48:				; CODE XREF: sub_43F87D+3A4j
		add	[ebp+var_1C], 4
		mov	[ebp+var_30], 1
		jmp	loc_43FE3B
; ---------------------------------------------------------------------------

loc_43FC58:				; CODE XREF: sub_43F87D+ACj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_43FC70
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	loc_43FCFE

loc_43FC70:				; CODE XREF: sub_43F87D+3E3j
		cmp	[ebp+var_24], 0
		jz	short loc_43FCD8
		mov	[ebp+var_10], 0
		jmp	short loc_43FCAB
; ---------------------------------------------------------------------------

loc_43FC7F:				; CODE XREF: sub_43F87D+434j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_43FCAB:				; CODE XREF: sub_43F87D+400j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_43FC7F
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_43FCD8:				; CODE XREF: sub_43F87D+3F7j
		mov	eax, [ebp+var_14]
		add	eax, 1
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_30], 1
		jmp	loc_43FE3B
; ---------------------------------------------------------------------------

loc_43FCFE:				; CODE XREF: sub_43F87D+3EDj
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		shl	[ebp+var_28], 6
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3Fh
		or	[ebp+var_28], eax
		sub	[ebp+var_C], 1
		cmp	[ebp+var_C], 0
		jnz	loc_43FE3B
		mov	eax, ds:dword_451904
		test	eax, eax
		jz	short loc_43FD7B
		cmp	[ebp+var_24], 0
		jz	short loc_43FD69
		mov	[ebp+var_10], 0
		jmp	short loc_43FD61
; ---------------------------------------------------------------------------

loc_43FD49:				; CODE XREF: sub_43F87D+4EAj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_43FD61:				; CODE XREF: sub_43F87D+4CAj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_43FD49

loc_43FD69:				; CODE XREF: sub_43F87D+4C1j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	loc_43FE3B
; ---------------------------------------------------------------------------

loc_43FD7B:				; CODE XREF: sub_43F87D+4BBj
		cmp	[ebp+arg_C], 0
		jz	short loc_43FDBF
		cmp	[ebp+var_24], 0
		jz	short loc_43FDB0
		mov	[ebp+var_10], 0
		jmp	short loc_43FDA8
; ---------------------------------------------------------------------------

loc_43FD90:				; CODE XREF: sub_43F87D+531j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_43FDA8:				; CODE XREF: sub_43F87D+511j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_43FD90

loc_43FDB0:				; CODE XREF: sub_43F87D+508j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_43FE3B
; ---------------------------------------------------------------------------

loc_43FDBF:				; CODE XREF: sub_43F87D+502j
		cmp	[ebp+var_28], 7Fh
		jbe	short loc_43FDE8
		cmp	[ebp+var_28], 0FFh
		ja	short loc_43FDE8
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_43FE3B
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_43FE3B
; ---------------------------------------------------------------------------

loc_43FDE8:				; CODE XREF: sub_43F87D+546j
					; sub_43F87D+54Fj
		cmp	[ebp+var_24], 0
		jz	short loc_43FE2B
		mov	[ebp+var_10], 0
		jmp	short loc_43FE23
; ---------------------------------------------------------------------------

loc_43FDF7:				; CODE XREF: sub_43F87D+5ACj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_43FE23:				; CODE XREF: sub_43F87D+578j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_43FDF7

loc_43FE2B:				; CODE XREF: sub_43F87D+56Fj
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0

loc_43FE3B:				; CODE XREF: sub_43F87D+9Cj
					; sub_43F87D+20Ej ...
		add	[ebp+var_18], 1
		sub	[ebp+var_2C], 1

loc_43FE43:				; CODE XREF: sub_43F87D+44j
		cmp	[ebp+var_2C], 0
		jnz	loc_43F8C6
		cmp	[ebp+var_20], 0
		jnz	short loc_43FE6F
		mov	eax, [ebp+var_1C]
		add	eax, 1
		mov	[esp+88h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax
		jmp	loc_43F8A1
; ---------------------------------------------------------------------------

loc_43FE6F:				; CODE XREF: sub_43F87D+5D4j
		cmp	[ebp+arg_C], 0
		jz	loc_44003F
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, off_444C40
		mov	[esp+88h+Format], offset aUtf8_0 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	libiconv_open
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0FFFFFFFFh
		jnz	short loc_43FEE3
		mov	eax, off_444C40
		mov	[esp+88h+var_80], 1
		mov	[esp+88h+Format], offset aUtf8_0 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	sub_43F21C
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax
		call	gcry_free
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_44004F
		jmp	loc_440048
; ---------------------------------------------------------------------------

loc_43FEE3:				; CODE XREF: sub_43F87D+61Ej
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		sub	eax, 1
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_44], eax
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_50]
		mov	[ebp+var_5C], eax
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_5C]
		mul	edx
		mov	eax, edx
		shr	eax, 2
		cmp	eax, [ebp+var_1C]
		jz	short loc_43FF47
		mov	[esp+88h+var_80], offset aDo_utf8_to_nat ; "do_utf8_to_native"
		mov	[esp+88h+Format], 24Ah
		mov	[esp+88h+Dest],	offset a____Gnupg22_15 ; "../../gnupg2-2.0.30/jnlib/utf8conv.c"
		call	sub_43CCB0
; ---------------------------------------------------------------------------

loc_43FF47:				; CODE XREF: sub_43F87D+6ACj
		mov	eax, [ebp+var_50]
		mov	[esp+88h+Dest],	eax
		call	gcry_xmalloc
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_48]
		mov	[ebp+var_34], eax
		lea	eax, [ebp+var_50]
		mov	[esp+88h+var_78], eax
		lea	eax, [ebp+var_48]
		mov	[esp+88h+var_7C], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+88h+var_80], eax
		lea	eax, [ebp+var_44]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	libiconv
		cmp	eax, 0FFFFFFFFh
		jnz	loc_44001E
		mov	eax, ds:dword_45190C
		test	eax, eax
		jnz	short loc_43FFD1
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[esp+88h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	esi, off_444C40
		mov	[esp+88h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_43C238
		mov	[esp+88h+var_7C], ebx
		mov	[esp+88h+var_80], esi
		mov	[esp+88h+Format], offset aUtf8_0 ; "utf-8"
		mov	[esp+88h+Dest],	eax ; char *
		call	sub_43CAF7

loc_43FFD1:				; CODE XREF: sub_43F87D+715j
		mov	ds:dword_45190C, 1
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax
		call	gcry_free
		mov	[ebp+var_20], 0
		mov	eax, [ebp+var_34]
		mov	[esp+88h+Dest],	eax
		call	gcry_free
		mov	[esp+88h+var_7C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_43F87D
		mov	[ebp+var_34], eax
		jmp	short loc_44002F
; ---------------------------------------------------------------------------

loc_44001E:				; CODE XREF: sub_43F87D+708j
		mov	eax, [ebp+var_48]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax
		call	gcry_free

loc_44002F:				; CODE XREF: sub_43F87D+79Fj
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	libiconv_close
		mov	eax, [ebp+var_34]
		jmp	short loc_440048
; ---------------------------------------------------------------------------

loc_44003F:				; CODE XREF: sub_43F87D+5F6j
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]

loc_440048:				; CODE XREF: sub_43F87D+661j
					; sub_43F87D+7C0j
		sub	esp, 0FFFFFF80h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_43F87D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_44004F	proc near		; CODE XREF: .text:00434919p
					; sub_439A44+50p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_451908
		mov	[esp+18h+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_43F87D
		leave
		retn
sub_44004F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv_open
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+18h]
		mov	[esp+10h], eax
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv_close
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4400D8	proc near		; CODE XREF: sub_440232+14p

var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 10h
		cmp	[ebp+arg_0], 0
		jnz	short loc_4400F2
		mov	[ebp+var_C], 80000001h
		jmp	loc_440228
; ---------------------------------------------------------------------------

loc_4400F2:				; CODE XREF: sub_4400D8+Cj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_classes_r ; "HKEY_CLASSES_ROOT"
		mov	ecx, 12h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_440126
		mov	[ebp+var_C], 80000000h
		jmp	loc_440228
; ---------------------------------------------------------------------------

loc_440126:				; CODE XREF: sub_4400D8+40j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_current_u ; "HKEY_CURRENT_USER"
		mov	ecx, 12h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_44015A
		mov	[ebp+var_C], 80000001h
		jmp	loc_440228
; ---------------------------------------------------------------------------

loc_44015A:				; CODE XREF: sub_4400D8+74j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_local_mac ; "HKEY_LOCAL_MACHINE"
		mov	ecx, 13h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_44018E
		mov	[ebp+var_C], 80000002h
		jmp	loc_440228
; ---------------------------------------------------------------------------

loc_44018E:				; CODE XREF: sub_4400D8+A8j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_users	; "HKEY_USERS"
		mov	ecx, 0Bh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4401BF
		mov	[ebp+var_C], 80000003h
		jmp	short loc_440228
; ---------------------------------------------------------------------------

loc_4401BF:				; CODE XREF: sub_4400D8+DCj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_performan ; "HKEY_PERFORMANCE_DATA"
		mov	ecx, 16h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4401F0
		mov	[ebp+var_C], 80000004h
		jmp	short loc_440228
; ---------------------------------------------------------------------------

loc_4401F0:				; CODE XREF: sub_4400D8+10Dj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_current_c ; "HKEY_CURRENT_CONFIG"
		mov	ecx, 14h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_440221
		mov	[ebp+var_C], 80000005h
		jmp	short loc_440228
; ---------------------------------------------------------------------------

loc_440221:				; CODE XREF: sub_4400D8+13Ej
		mov	eax, 0
		jmp	short loc_44022B
; ---------------------------------------------------------------------------

loc_440228:				; CODE XREF: sub_4400D8+15j
					; sub_4400D8+49j ...
		mov	eax, [ebp+var_C]

loc_44022B:				; CODE XREF: sub_4400D8+14Ej
		add	esp, 10h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4400D8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_440232(int, LPCSTR, LPCSTR lpValueName)
sub_440232	proc near		; CODE XREF: sub_4265F1+71p

hKey		= dword	ptr -58h
lpSubKey	= dword	ptr -54h
ulOptions	= dword	ptr -50h
samDesired	= dword	ptr -4Ch
phkResult	= dword	ptr -48h
lpcbData	= dword	ptr -44h
var_2C		= dword	ptr -2Ch
Type		= dword	ptr -24h
cbData		= dword	ptr -20h
nSize		= dword	ptr -1Ch
var_18		= dword	ptr -18h
lpDst		= dword	ptr -14h
var_10		= dword	ptr -10h
lpData		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
lpValueName	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	[ebp+lpData], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+hKey],	eax
		call	sub_4400D8
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_44025E
		mov	eax, 0
		jmp	loc_44054E
; ---------------------------------------------------------------------------

loc_44025E:				; CODE XREF: sub_440232+20j
		lea	eax, [ebp+var_18]
		mov	[esp+58h+phkResult], eax ; phkResult
		mov	[esp+58h+samDesired], 20019h ; samDesired
		mov	[esp+58h+ulOptions], 0 ; ulOptions
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+lpSubKey], eax	; lpSubKey
		mov	eax, [ebp+var_10]
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegOpenKeyExA
		call	eax ; RegOpenKeyExA
		sub	esp, 14h
		test	eax, eax
		jz	short loc_4402DD
		cmp	[ebp+arg_0], 0
		jz	short loc_4402A0
		mov	eax, 0
		jmp	loc_44054E
; ---------------------------------------------------------------------------

loc_4402A0:				; CODE XREF: sub_440232+62j
		lea	eax, [ebp+var_18]
		mov	[esp+58h+phkResult], eax ; phkResult
		mov	[esp+58h+samDesired], 20019h ; samDesired
		mov	[esp+58h+ulOptions], 0 ; ulOptions
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+lpSubKey], eax	; lpSubKey
		mov	[esp+58h+hKey],	80000002h ; hKey
		mov	eax, ds:RegOpenKeyExA
		call	eax ; RegOpenKeyExA
		sub	esp, 14h
		test	eax, eax
		jz	short loc_4402DD
		mov	eax, 0
		jmp	loc_44054E
; ---------------------------------------------------------------------------

loc_4402DD:				; CODE XREF: sub_440232+5Cj
					; sub_440232+9Fj
		mov	[ebp+cbData], 1
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+cbData]
		mov	[esp+58h+lpcbData], edx	; lpcbData
		mov	[esp+58h+phkResult], 0 ; lpData
		mov	[esp+58h+samDesired], 0	; lpType
		mov	[esp+58h+ulOptions], 0 ; lpReserved
		mov	edx, [ebp+lpValueName]
		mov	[esp+58h+lpSubKey], edx	; lpValueName
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegQueryValueExA
		call	eax ; RegQueryValueExA
		sub	esp, 18h
		test	eax, eax
		jnz	loc_440531
		mov	eax, [ebp+cbData]
		add	eax, 1
		mov	[ebp+nSize], eax
		mov	eax, [ebp+nSize]
		mov	[esp+58h+hKey],	eax
		call	gcry_malloc
		mov	[ebp+lpData], eax
		cmp	[ebp+lpData], 0
		jz	loc_440534
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+nSize]
		mov	[esp+58h+lpcbData], edx	; lpcbData
		mov	edx, [ebp+lpData]
		mov	[esp+58h+phkResult], edx ; lpData
		lea	edx, [ebp+Type]
		mov	[esp+58h+samDesired], edx ; lpType
		mov	[esp+58h+ulOptions], 0 ; lpReserved
		mov	edx, [ebp+lpValueName]
		mov	[esp+58h+lpSubKey], edx	; lpValueName
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegQueryValueExA
		call	eax ; RegQueryValueExA
		sub	esp, 18h
		test	eax, eax
		jz	short loc_440392
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		mov	[ebp+lpData], 0
		jmp	loc_44053B
; ---------------------------------------------------------------------------

loc_440392:				; CODE XREF: sub_440232+147j
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpData]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+Type]
		cmp	eax, 2
		jnz	loc_44053B
		mov	[esp+58h+lpSubKey], 25h	; Val
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; Str
		call	strchr
		test	eax, eax
		jz	loc_44053B
		mov	eax, [ebp+nSize]
		add	eax, 3E8h
		mov	[ebp+nSize], eax
		mov	eax, [ebp+nSize]
		add	eax, 1
		mov	[esp+58h+hKey],	eax
		call	gcry_malloc
		mov	[ebp+lpDst], eax
		cmp	[ebp+lpDst], 0
		jz	loc_440537
		mov	eax, [ebp+nSize]
		mov	[esp+58h+ulOptions], eax ; nSize
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; lpDst
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; lpSrc
		mov	eax, ds:ExpandEnvironmentStringsA
		call	eax ; ExpandEnvironmentStringsA
		sub	esp, 0Ch
		mov	[ebp+cbData], eax
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	loc_4404AF
		mov	edx, [ebp+cbData]
		mov	eax, [ebp+nSize]
		cmp	edx, eax
		jbe	loc_4404AF
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		mov	eax, [ebp+cbData]
		mov	[ebp+nSize], eax
		mov	eax, [ebp+nSize]
		add	eax, 1
		mov	[esp+58h+hKey],	eax
		call	gcry_malloc
		mov	[ebp+lpDst], eax
		cmp	[ebp+lpDst], 0
		jz	loc_44053A
		mov	eax, [ebp+nSize]
		mov	[esp+58h+ulOptions], eax ; nSize
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; lpDst
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; lpSrc
		mov	eax, ds:ExpandEnvironmentStringsA
		call	eax ; ExpandEnvironmentStringsA
		sub	esp, 0Ch
		mov	[ebp+cbData], eax
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	short loc_440490
		mov	edx, [ebp+cbData]
		mov	eax, [ebp+nSize]
		cmp	edx, eax
		jbe	short loc_440490
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		jmp	loc_44053B
; ---------------------------------------------------------------------------

loc_440490:				; CODE XREF: sub_440232+242j
					; sub_440232+24Cj
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpDst]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		mov	eax, [ebp+lpDst]
		mov	[ebp+lpData], eax
		jmp	loc_44053B
; ---------------------------------------------------------------------------

loc_4404AF:				; CODE XREF: sub_440232+1DCj
					; sub_440232+1EAj
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	short loc_440524
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpDst]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		mov	eax, [ebp+lpDst]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+58h+hKey],	eax
		call	gcry_malloc
		mov	[ebp+lpData], eax
		cmp	[ebp+lpData], 0
		jnz	short loc_440505
		mov	eax, [ebp+lpDst]
		mov	[ebp+lpData], eax
		jmp	short loc_44053B
; ---------------------------------------------------------------------------

loc_440505:				; CODE XREF: sub_440232+2C9j
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; Source
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		jmp	short loc_44053B
; ---------------------------------------------------------------------------

loc_440524:				; CODE XREF: sub_440232+282j
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax
		call	gcry_free
		jmp	short loc_44053B
; ---------------------------------------------------------------------------

loc_440531:				; CODE XREF: sub_440232+EAj
		nop
		jmp	short loc_44053B
; ---------------------------------------------------------------------------

loc_440534:				; CODE XREF: sub_440232+10Bj
		nop
		jmp	short loc_44053B
; ---------------------------------------------------------------------------

loc_440537:				; CODE XREF: sub_440232+1B0j
		nop
		jmp	short loc_44053B
; ---------------------------------------------------------------------------

loc_44053A:				; CODE XREF: sub_440232+216j
		nop

loc_44053B:				; CODE XREF: sub_440232+15Bj
					; sub_440232+16Fj ...
		mov	eax, [ebp+var_18]
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegCloseKey
		call	eax ; RegCloseKey
		sub	esp, 4
		mov	eax, [ebp+lpData]

loc_44054E:				; CODE XREF: sub_440232+27j
					; sub_440232+69j ...
		mov	edi, [ebp+var_4]
		leave
		retn
sub_440232	endp

; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		sub	esp, 0A8h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_43966B
		test	eax, eax
		jnz	short loc_44057F
		mov	dword ptr [ebp-0Ch], 1
		jmp	loc_4406A9
; ---------------------------------------------------------------------------

loc_44057F:				; CODE XREF: .text:00440571j
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 3
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_4405D4
		mov	dword ptr [ebp-0Ch], 0
		jmp	loc_4406A9
; ---------------------------------------------------------------------------

loc_4405D4:				; CODE XREF: .text:004405C6j
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 3
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_440626
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_440699
; ---------------------------------------------------------------------------

loc_440626:				; CODE XREF: .text:0044061Bj
		lea	eax, [ebp-7Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		mov	eax, ds:GetFileInformationByHandle
		call	eax ; GetFileInformationByHandle
		sub	esp, 8
		test	eax, eax
		jz	short loc_440681
		lea	eax, [ebp-48h]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		mov	eax, ds:GetFileInformationByHandle
		call	eax ; GetFileInformationByHandle
		sub	esp, 8
		test	eax, eax
		jz	short loc_440681
		mov	edx, [ebp-60h]
		mov	eax, [ebp-2Ch]
		cmp	edx, eax
		jnz	short loc_440681
		mov	edx, [ebp-50h]
		mov	eax, [ebp-1Ch]
		cmp	edx, eax
		jnz	short loc_440681
		mov	edx, [ebp-4Ch]
		mov	eax, [ebp-18h]
		cmp	edx, eax
		jnz	short loc_440681
		mov	eax, 1
		jmp	short loc_440686
; ---------------------------------------------------------------------------

loc_440681:				; CODE XREF: .text:0044063Fj
					; .text:0044065Aj ...
		mov	eax, 0

loc_440686:				; CODE XREF: .text:0044067Fj
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_440699:				; CODE XREF: .text:00440624j
		mov	eax, [ebp-10h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_4406A9:				; CODE XREF: .text:0044057Aj
					; .text:004405CFj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4406AE	proc near		; CODE XREF: sub_42A743+2BDp

VarName		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	[esp+38h+VarName], offset aTz ;	"TZ"
		call	getenv
		mov	[ebp+var_C], eax
		mov	[esp+38h+VarName], offset EnvString ; "TZ=UTC"
		call	_putenv
		call	_tzset
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+VarName], eax
		call	sub_442740
		mov	[ebp+var_10], eax
		cmp	[ebp+var_C], 0
		jz	short loc_440764
		mov	eax, ds:dword_451940
		test	eax, eax
		jnz	short loc_44074C
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 4
		mov	[esp+38h+VarName], eax ; Size
		call	malloc
		mov	ds:dword_451940, eax
		mov	eax, ds:dword_451940
		test	eax, eax
		jz	short loc_44074C
		mov	edx, offset aTz_0 ; "TZ="
		mov	eax, ds:dword_451940
		mov	edx, [edx]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		mov	eax, ds:dword_451940
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+VarName], eax ; Dest
		call	strcat

loc_44074C:				; CODE XREF: sub_4406AE+42j
					; sub_4406AE+7Aj
		mov	eax, ds:dword_451940
		test	eax, eax
		jz	short loc_440770
		mov	eax, ds:dword_451940
		mov	[esp+38h+VarName], eax ; EnvString
		call	_putenv
		jmp	short loc_440770
; ---------------------------------------------------------------------------

loc_440764:				; CODE XREF: sub_4406AE+39j
		mov	[esp+38h+VarName], offset aTz ;	"TZ"
		call	_putenv

loc_440770:				; CODE XREF: sub_4406AE+A5j
					; sub_4406AE+B4j
		call	_tzset
		mov	eax, [ebp+var_10]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_4406AE	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_440780	proc near		; CODE XREF: sub_440B1E+Cp

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	[ebp+var_20], 0FFFFFFFFh
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		mov	[ebp+var_24], eax
		mov	[ebp+var_28], 3A2F8h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_54], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_54]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 5
		jle	short loc_4407F9
		mov	eax, [ebp+var_2C]
		sub	eax, 6
		add	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aXxxxxx ; "XXXXXX"
		mov	ecx, 7
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_440810

loc_4407F9:				; CODE XREF: sub_440780+49j
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	loc_440B16
; ---------------------------------------------------------------------------

loc_440810:				; CODE XREF: sub_440780+77j
		mov	eax, [ebp+var_2C]
		sub	eax, 6
		add	eax, [ebp+arg_0]
		mov	[ebp+var_30], eax
		mov	[esp+68h+var_64], 0
		lea	eax, [ebp+var_48]
		mov	[esp+68h+var_68], eax
		call	sub_442EA0
		mov	eax, [ebp+var_44]
		mov	edx, eax
		sar	edx, 1Fh
		mov	ecx, eax
		mov	ebx, edx
		shld	ebx, ecx, 10h
		shl	ecx, 10h
		mov	eax, [ebp+var_48]
		mov	edx, eax
		sar	edx, 1Fh
		mov	esi, ecx
		xor	esi, eax
		mov	[ebp+var_38], esi
		mov	eax, ebx
		xor	eax, edx
		mov	[ebp+var_34], eax
		call	_getpid
		mov	edx, eax
		sar	edx, 1Fh
		mov	esi, [ebp+var_38]
		xor	esi, eax
		mov	[ebp+var_50], esi
		mov	edi, [ebp+var_34]
		xor	edi, edx
		mov	[ebp+var_4C], edi
		mov	eax, ds:dword_451948
		mov	edx, ds:dword_45194C
		add	eax, [ebp+var_50]
		adc	edx, [ebp+var_4C]
		mov	ds:dword_451948, eax
		mov	ds:dword_45194C, edx
		mov	[ebp+var_1C], 0
		jmp	loc_440AF8
; ---------------------------------------------------------------------------

loc_44089A:				; CODE XREF: sub_440780+37Ej
		mov	eax, ds:dword_451948
		mov	edx, ds:dword_45194C
		mov	[ebp+var_40], eax
		mov	[ebp+var_3C], edx
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[esp+68h+var_60], 3Eh
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_68], eax
		mov	[esp+68h+var_64], edx
		call	sub_442170
		add	eax, offset aAbcdefghijklmn ; "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLM"...
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_30]
		mov	[eax], dl
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[esp+68h+var_60], 3Eh
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_68], eax
		mov	[esp+68h+var_64], edx
		call	sub_4422B0
		mov	[ebp+var_40], eax
		mov	[ebp+var_3C], edx
		mov	eax, [ebp+var_30]
		lea	ebx, [eax+1]
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[esp+68h+var_60], 3Eh
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_68], eax
		mov	[esp+68h+var_64], edx
		call	sub_442170
		add	eax, offset aAbcdefghijklmn ; "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLM"...
		movzx	eax, byte ptr [eax]
		mov	[ebx], al
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[esp+68h+var_60], 3Eh
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_68], eax
		mov	[esp+68h+var_64], edx
		call	sub_4422B0
		mov	[ebp+var_40], eax
		mov	[ebp+var_3C], edx
		mov	eax, [ebp+var_30]
		lea	ebx, [eax+2]
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[esp+68h+var_60], 3Eh
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_68], eax
		mov	[esp+68h+var_64], edx
		call	sub_442170
		add	eax, offset aAbcdefghijklmn ; "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLM"...
		movzx	eax, byte ptr [eax]
		mov	[ebx], al
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[esp+68h+var_60], 3Eh
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_68], eax
		mov	[esp+68h+var_64], edx
		call	sub_4422B0
		mov	[ebp+var_40], eax
		mov	[ebp+var_3C], edx
		mov	eax, [ebp+var_30]
		lea	ebx, [eax+3]
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[esp+68h+var_60], 3Eh
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_68], eax
		mov	[esp+68h+var_64], edx
		call	sub_442170
		add	eax, offset aAbcdefghijklmn ; "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLM"...
		movzx	eax, byte ptr [eax]
		mov	[ebx], al
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[esp+68h+var_60], 3Eh
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_68], eax
		mov	[esp+68h+var_64], edx
		call	sub_4422B0
		mov	[ebp+var_40], eax
		mov	[ebp+var_3C], edx
		mov	eax, [ebp+var_30]
		lea	ebx, [eax+4]
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[esp+68h+var_60], 3Eh
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_68], eax
		mov	[esp+68h+var_64], edx
		call	sub_442170
		add	eax, offset aAbcdefghijklmn ; "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLM"...
		movzx	eax, byte ptr [eax]
		mov	[ebx], al
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[esp+68h+var_60], 3Eh
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_68], eax
		mov	[esp+68h+var_64], edx
		call	sub_4422B0
		mov	[ebp+var_40], eax
		mov	[ebp+var_3C], edx
		mov	eax, [ebp+var_30]
		lea	ebx, [eax+5]
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[esp+68h+var_60], 3Eh
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+var_68], eax
		mov	[esp+68h+var_64], edx
		call	sub_442170
		add	eax, offset aAbcdefghijklmn ; "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLM"...
		movzx	eax, byte ptr [eax]
		mov	[ebx], al
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+var_68], eax
		call	_mkdir
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		js	short loc_440AC1
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	edx, [ebp+var_24]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		jmp	short loc_440B16
; ---------------------------------------------------------------------------

loc_440AC1:				; CODE XREF: sub_440780+32Ej
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	eax, [eax]
		cmp	eax, 11h
		jz	short loc_440AD6
		mov	eax, 0FFFFFFFFh
		jmp	short loc_440B16
; ---------------------------------------------------------------------------

loc_440AD6:				; CODE XREF: sub_440780+34Dj
		mov	eax, ds:dword_451948
		mov	edx, ds:dword_45194C
		add	eax, 1E61h
		adc	edx, 0
		mov	ds:dword_451948, eax
		mov	ds:dword_45194C, edx
		add	[ebp+var_1C], 1

loc_440AF8:				; CODE XREF: sub_440780+115j
		mov	eax, [ebp+var_1C]
		cmp	eax, [ebp+var_28]
		jb	loc_44089A
		mov	eax, ds:__imp__errno
		call	eax ; __imp__errno
		mov	dword ptr [eax], 11h
		mov	eax, 0FFFFFFFFh

loc_440B16:				; CODE XREF: sub_440780+8Bj
					; sub_440780+33Fj ...
		add	esp, 5Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_440780	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_440B1E	proc near		; CODE XREF: sub_402C19+84p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_440780
		test	eax, eax
		jz	short loc_440B3A
		mov	eax, 0
		jmp	short locret_440B3D
; ---------------------------------------------------------------------------

loc_440B3A:				; CODE XREF: sub_440B1E+13j
		mov	eax, [ebp+arg_0]

locret_440B3D:				; CODE XREF: sub_440B1E+1Aj
		leave
		retn
sub_440B1E	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_control]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_xmalloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_check_version]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_free]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_realloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_malloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_xstrdup]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_calloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_canon_len]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_strdup]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_xcalloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_sscan]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_pk_get_keygrip]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_release]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_hash_buffer]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_scan]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_aprint]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_release]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_malloc_secure]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_snew]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_invm]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_mpi_sub_ui]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_algo_name]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_build]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_set_log_handler]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_set_fatalerror_handler]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_set_outofcore_handler]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_sexp_sprint]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gcry_md_map_name]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gcry_xrealloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gpg_err_code_from_syserror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_err_set_errno]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gpg_strerror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_err_code_from_errno]
		align 10h

loc_440C50:				; DATA XREF: sub_401723+8Co
		jmp	ds:ksba_check_version
; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_set_malloc_hooks]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_new]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_init_from_mem]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_get_public_key]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ksba_cert_release]
		align 10h
		jmp	ds:__assuan_pipe
; ---------------------------------------------------------------------------
		align 4
		jmp	ds:__assuan_close
; ---------------------------------------------------------------------------
		align 10h
		jmp	ds:__assuan_spawn
; ---------------------------------------------------------------------------
		align 4
		jmp	ds:__assuan_socketpair
; ---------------------------------------------------------------------------
		align 10h
		jmp	ds:__assuan_socket
; ---------------------------------------------------------------------------
		align 4
		jmp	ds:__assuan_connect
; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_malloc_hooks]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_assuan_log_prefix]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_gpg_err_source]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_system_hooks]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION assuan_sock_init]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_sock_new]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION assuan_sock_bind]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_sock_get_nonce]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION assuan_sock_close]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_sock_check_nonce]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION assuan_get_pointer]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_write_status]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION assuan_inquire]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_send_data]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_error]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_begin_confidential]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION assuan_end_confidential]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_register_command]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_hello_line]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_register_reset_notify]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION assuan_register_option_handler]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_new]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION assuan_fdopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_init_pipe_server]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION assuan_init_socket_server]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_pointer]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION assuan_set_log_stream]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_accept]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION assuan_process]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION assuan_release]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION assuan_get_pid]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __WSAFDIsSet]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION pth_usleep]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_read]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION pth_write]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_waitpid]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION pth_thread_id]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_attr_new]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION pth_attr_set]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_spawn]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION pth_event]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_ctrl]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION pth_timeout]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_event_concat]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION pth_select_ev]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_event_isolate]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION pth_event_occurred]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_event_free]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION pth_sleep]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_sigmask]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION pth_accept]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_mutex_init]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION pth_mutex_acquire]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_mutex_release]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION pth_init]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION pth_kill]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION pth_yield]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION libiconv_open]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION libiconv_close]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION libiconv]
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:00455024o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_440EB0
		cmp	eax, 3
		jz	short loc_440EB0
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_440EB0:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_4420A0
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_401180+113p
					; DATA XREF: .rdata:off_44FCFCo ...

lpLibFileName	= dword	ptr -1Ch
lpProcName	= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		mov	edx, ds:_winmajor
		mov	eax, [esp+1Ch+arg_4]
		cmp	dword ptr [edx], 3
		jbe	short loc_440F24
		cmp	dword_444C54, 2
		jz	short loc_440F06
		mov	dword_444C54, 2

loc_440F06:				; CODE XREF: TlsCallback_0+1Aj
		cmp	eax, 2
		jz	loc_441013
		cmp	eax, 1
		jz	loc_440FB2

loc_440F18:				; CODE XREF: TlsCallback_0+EEj
					; TlsCallback_0+13Ej
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_440F24:				; CODE XREF: TlsCallback_0+11j
		mov	ds:dword_451D9C, 1
		mov	[esp+1Ch+lpLibFileName], offset	LibFileName ; "mingwm10.dll"
		call	ds:LoadLibraryA
		sub	esp, 4
		test	eax, eax
		mov	ds:hLibModule, eax
		jz	loc_441043
		mov	ebx, ds:GetProcAddress
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_rem ; "__mingwthr_remove_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	ds:dword_451D98, eax
		mov	eax, ds:hLibModule
		sub	esp, 8
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_key ; "__mingwthr_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	edx, ds:hLibModule
		sub	esp, 8
		test	edx, edx
		mov	ds:dword_451D94, eax
		jz	loc_441043
		mov	ecx, ds:dword_451D98
		test	ecx, ecx
		jz	short loc_440FD3
		test	eax, eax
		jz	short loc_440FD3
		mov	dword_444C54, 1
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_440FB2:				; CODE XREF: TlsCallback_0+32j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+lpProcName], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpLibFileName], eax
		call	sub_4420A0
		jmp	loc_440F18
; ---------------------------------------------------------------------------

loc_440FD3:				; CODE XREF: TlsCallback_0+B6j
					; TlsCallback_0+BAj
		mov	ds:dword_451D94, 0
		mov	ds:dword_451D98, 0
		mov	[esp+1Ch+lpLibFileName], edx ; hLibModule
		call	ds:FreeLibrary
		sub	esp, 4

loc_440FF3:				; CODE XREF: TlsCallback_0+177j
		mov	ds:hLibModule, 0
		mov	eax, 1
		mov	dword_444C54, 0
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_441013:				; CODE XREF: TlsCallback_0+29j
		mov	ebx, offset dword_455030
		cmp	ebx, offset dword_455030
		jz	loc_440F18

loc_441024:				; CODE XREF: TlsCallback_0+155j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_44102C
		call	eax

loc_44102C:				; CODE XREF: TlsCallback_0+148j
		add	ebx, 4
		cmp	ebx, offset dword_455030
		jnz	short loc_441024
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_441043:				; CODE XREF: TlsCallback_0+65j
					; TlsCallback_0+A8j
		mov	ds:dword_451D94, 0
		mov	ds:dword_451D98, 0
		jmp	short loc_440FF3
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_441070	proc near		; DATA XREF: .CRT:00455014o
		mov	eax, ds:__lconv_init
		jmp	eax
sub_441070	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_441080	proc near		; CODE XREF: sub_4410A0+10p
					; sub_4410A0+36p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_441080	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_441090	proc near		; CODE XREF: sub_401060+59p
					; sub_4410A0+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_441090	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4410A0(_onexit_t)
sub_4410A0	proc near		; CODE XREF: sub_441160+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_451DA4
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_441080
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_14], eax
		jz	loc_441140
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_451DA4
		mov	[esp+2Ch+Func],	eax
		call	sub_441080
		mov	[esp+2Ch+var_14], eax
		mov	eax, ds:dword_451DA0
		mov	[esp+2Ch+Func],	eax
		call	sub_441080
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_10], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_441090
		mov	ds:dword_451DA4, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_441090
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_451DA0, eax
		call	_unlock
		add	esp, 28h
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_441140:				; CODE XREF: sub_4410A0+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_4410A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_441160(_onexit_t)
sub_441160	proc near		; CODE XREF: sub_401C11+A5Fp
					; sub_42F015+63p ...

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_4410A0
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_441160	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LONG __stdcall TopLevelExceptionFilter(struct	_EXCEPTION_POINTERS *ExceptionInfo)
TopLevelExceptionFilter	proc near	; DATA XREF: sub_401180+11Do

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
ExceptionInfo	= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 24h
		mov	ebx, [esp+2Ch+ExceptionInfo]
		mov	eax, [ebx]
		mov	eax, [eax]
		cmp	eax, 0C0000091h
		ja	short loc_4411D7
		cmp	eax, 0C000008Dh
		jb	short loc_441204

loc_44119B:				; CODE XREF: TopLevelExceptionFilter+6Aj
		mov	esi, 1

loc_4411A0:				; CODE XREF: TopLevelExceptionFilter+C7j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 8
		call	signal
		cmp	eax, 1
		jz	loc_4412D0
		test	eax, eax
		jz	short loc_4411EC
		mov	[esp+2Ch+var_2C], 8
		call	eax
		mov	eax, 0FFFFFFFFh

loc_4411CF:				; CODE XREF: TopLevelExceptionFilter+120j
					; TopLevelExceptionFilter+13Ej	...
		add	esp, 24h
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_4411D7:				; CODE XREF: TopLevelExceptionFilter+12j
		cmp	eax, 0C0000094h
		jz	short loc_441245
		cmp	eax, 0C0000096h
		jz	short loc_441212
		cmp	eax, 0C0000093h
		jz	short loc_44119B

loc_4411EC:				; CODE XREF: TopLevelExceptionFilter+3Fj
					; TopLevelExceptionFilter+90j ...
		mov	eax, ds:dword_451978
		test	eax, eax
		jz	loc_4412C3
		mov	[esp+2Ch+ExceptionInfo], ebx
		add	esp, 24h
		pop	ebx
		pop	esi
		jmp	eax
; ---------------------------------------------------------------------------

loc_441204:				; CODE XREF: TopLevelExceptionFilter+19j
		cmp	eax, 0C0000005h
		jz	short loc_441250
		cmp	eax, 0C000001Dh
		jnz	short loc_4411EC

loc_441212:				; CODE XREF: TopLevelExceptionFilter+63j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 4
		call	signal
		cmp	eax, 1
		jz	short loc_441287
		test	eax, eax
		jz	short loc_4411EC
		mov	[esp+2Ch+var_2C], 4
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_441245:				; CODE XREF: TopLevelExceptionFilter+5Cj
		xor	esi, esi
		jmp	loc_4411A0
; ---------------------------------------------------------------------------
		align 10h

loc_441250:				; CODE XREF: TopLevelExceptionFilter+89j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		cmp	eax, 1
		jz	short loc_4412A5
		test	eax, eax
		jz	loc_4411EC
		mov	[esp+2Ch+var_2C], 0Bh
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_441287:				; CODE XREF: TopLevelExceptionFilter+A9j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 4
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_4411CF
; ---------------------------------------------------------------------------

loc_4412A5:				; CODE XREF: TopLevelExceptionFilter+E7j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_4411CF
; ---------------------------------------------------------------------------

loc_4412C3:				; CODE XREF: TopLevelExceptionFilter+73j
		xor	eax, eax
		jmp	loc_4411CF
; ---------------------------------------------------------------------------
		align 10h

loc_4412D0:				; CODE XREF: TopLevelExceptionFilter+37j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 8
		call	signal
		test	esi, esi
		mov	eax, 0FFFFFFFFh
		jz	loc_4411CF
		mov	[esp+2Ch+var_10], eax
		call	sub_441CF0
		mov	eax, [esp+2Ch+var_10]
		jmp	loc_4411CF
TopLevelExceptionFilter	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 3Ch
		mov	eax, ds:dword_45197C
		fld	qword ptr [esp+48h]
		fld	qword ptr [esp+50h]
		fld	qword ptr [esp+58h]
		test	eax, eax
		jz	short loc_441351
		fxch	st(2)
		mov	edx, [esp+40h]
		fstp	qword ptr [esp+18h]
		fstp	qword ptr [esp+20h]
		fstp	qword ptr [esp+28h]
		mov	[esp+10h], edx
		mov	edx, [esp+44h]
		mov	[esp+14h], edx
		lea	edx, [esp+10h]
		mov	[esp], edx
		call	eax ; dword_45197C
		jmp	short loc_441357
; ---------------------------------------------------------------------------

loc_441351:				; CODE XREF: .text:00441326j
		fstp	st
		fstp	st
		fstp	st

loc_441357:				; CODE XREF: .text:0044134Fj
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_441360	proc near		; CODE XREF: sub_401060+F7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ds:dword_45197C, eax
		jmp	__setusermatherr
sub_441360	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_441370	proc near		; DATA XREF: sub_401060:loc_401150o

File		= dword	ptr -3Ch
Format		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= qword	ptr -2Ch
var_24		= qword	ptr -24h
var_1C		= qword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 3Ch
		mov	edx, offset aUnknownError_0 ; "Unknown error"
		mov	eax, [esp+3Ch+arg_0]
		mov	ecx, [eax]
		sub	ecx, 1
		cmp	ecx, 5
		ja	short loc_44138D
		mov	edx, ds:off_44FE1C[ecx*4]

loc_44138D:				; CODE XREF: sub_441370+14j
		fld	qword ptr [eax+18h]
		fstp	[esp+3Ch+var_1C]
		fld	qword ptr [eax+10h]
		fstp	[esp+3Ch+var_24]
		fld	qword ptr [eax+8]
		fstp	[esp+3Ch+var_2C]
		mov	eax, [eax+4]
		mov	[esp+3Ch+var_34], edx
		mov	[esp+3Ch+Format], offset a_matherrSInSGG ; "_matherr():	%s in %s(%g, %g)  (retval=%"...
		mov	[esp+3Ch+var_30], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+3Ch+File],	eax ; File
		call	fprintf
		xor	eax, eax
		add	esp, 3Ch
		retn
sub_441370	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4413D0	proc near		; CODE XREF: sub_401060+75p
		xor	eax, eax
		retn
sub_4413D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_4413E0(char *Format, char ArgList)
sub_4413E0	proc near		; CODE XREF: sub_441440+1DDp
					; sub_441440+204p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aMingwW64Runtim ;	"Mingw-w64 runtime failure:\n"
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_4413E0	endp

; ---------------------------------------------------------------------------
		jmp	short sub_441440
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_441440(size_t Size)
sub_441440	proc near		; CODE XREF: .text:00441431j
					; sub_441680+B8p ...

lpAddress	= dword	ptr -7Ch
lpBuffer	= dword	ptr -78h
dwLength	= dword	ptr -74h
lpflOldProtect	= dword	ptr -70h
var_64		= dword	ptr -64h
Src		= dword	ptr -60h
var_58		= _MEMORY_BASIC_INFORMATION ptr	-58h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h

		push	ebp
		mov	ebp, ecx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 6Ch
		mov	ecx, ds:dword_451988
		mov	[esp+7Ch+Src], edx
		test	ecx, ecx
		jle	loc_441622
		mov	eax, ds:dword_451984
		xor	esi, esi

loc_441464:				; CODE XREF: sub_441440+41j
		mov	edx, [eax+4]
		cmp	ebx, edx
		jb	short loc_441479
		mov	edi, [eax+8]
		add	edx, [edi+8]
		cmp	ebx, edx
		jb	loc_441550

loc_441479:				; CODE XREF: sub_441440+29j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jnz	short loc_441464

loc_441483:				; CODE XREF: sub_441440+1E4j
		mov	[esp+7Ch+lpAddress], ebx
		call	sub_441A40
		test	eax, eax
		mov	edi, eax
		jz	loc_441649
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_451984
		shl	edx, 2
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		mov	[esp+7Ch+var_64], edx
		call	sub_441B20
		mov	edx, [esp+7Ch+var_64]
		add	eax, [edi+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+7Ch+Buffer]
		mov	esi, ds:VirtualQuery
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_451984
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+7Ch+var_64]
		jz	loc_441629
		mov	eax, [esp+7Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	loc_4415D1

loc_4414FF:				; CODE XREF: sub_441440+194j
					; sub_441440+1C6j
		add	ds:dword_451988, 1

loc_441506:				; CODE XREF: sub_441440+116j
		lea	eax, [esp+7Ch+var_58]
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	[esp+7Ch+lpAddress], ebx ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_441659
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 4
		jnz	short loc_441558

loc_44152F:				; CODE XREF: sub_441440+11Bj
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy

loc_441543:				; CODE XREF: sub_441440+162j
					; sub_441440+167j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_441550:				; CODE XREF: sub_441440+33j
		mov	esi, ds:VirtualQuery
		jmp	short loc_441506
; ---------------------------------------------------------------------------

loc_441558:				; CODE XREF: sub_441440+EDj
		cmp	eax, 40h
		jz	short loc_44152F
		mov	eax, [esp+7Ch+var_58.RegionSize]
		lea	edi, [esp+7Ch+flOldProtect]
		mov	esi, ds:VirtualProtect
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 40h
		jz	short loc_441543
		cmp	eax, 4
		jz	short loc_441543
		mov	eax, [esp+7Ch+flOldProtect]
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], eax	; flNewProtect
		mov	eax, [esp+7Ch+var_58.RegionSize]
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4415D1:				; CODE XREF: sub_441440+B9j
		cmp	eax, 40h
		jz	loc_4414FF
		mov	eax, [esp+7Ch+Buffer.RegionSize]
		add	edx, ds:dword_451984
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+Buffer.BaseAddress]
		mov	[esp+7Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		test	eax, eax
		jnz	loc_4414FF
		call	ds:GetLastError
		mov	[esp+7Ch+lpAddress], offset aVirtualprotect ; "	 VirtualProtect	failed with code 0x%x"
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_4413E0
; ---------------------------------------------------------------------------

loc_441622:				; CODE XREF: sub_441440+17j
		xor	esi, esi
		jmp	loc_441483
; ---------------------------------------------------------------------------

loc_441629:				; CODE XREF: sub_441440+ACj
		mov	eax, ds:dword_451984
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+dwLength], eax
		mov	eax, [edi+8]
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_4413E0
; ---------------------------------------------------------------------------

loc_441649:				; CODE XREF: sub_441440+4Fj
		mov	[esp+7Ch+lpBuffer], ebx	; ArgList
		mov	[esp+7Ch+lpAddress], offset aAddressPHasNoI ; "Address %p has no image-section"
		call	sub_4413E0
; ---------------------------------------------------------------------------

loc_441659:				; CODE XREF: sub_441440+E0j
		mov	[esp+7Ch+dwLength], ebx
		mov	[esp+7Ch+lpBuffer], 1Ch	; ArgList
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		call	sub_4413E0
sub_441440	endp

; ---------------------------------------------------------------------------
		db 0EBh	; 
		db  0Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_441680	proc near		; CODE XREF: sub_401180:loc_401298p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
var_20		= dword	ptr -20h
flOldProtect	= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_451980
		test	eax, eax
		jz	short loc_4416A0

loc_441692:				; CODE XREF: sub_441680+66j
					; sub_441680+96j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4416A0:				; CODE XREF: sub_441680+10j
		mov	ds:dword_451980, 1
		call	sub_441A80
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_442140
		mov	ds:dword_451988, 0
		sub	esp, eax
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_451984, eax
		mov	eax, offset dword_450140
		sub	eax, offset dword_450140
		cmp	eax, 7
		jle	short loc_441692
		cmp	eax, 0Bh
		mov	ebx, offset dword_450140
		jle	loc_4417E0
		mov	eax, ds:dword_450140
		test	eax, eax
		jnz	short loc_441710
		mov	eax, ds:dword_450144
		test	eax, eax
		jz	loc_4417CC
		lea	esi, [esi+0]

loc_441710:				; CODE XREF: sub_441680+7Dj
					; sub_441680+164j ...
		cmp	ebx, offset dword_450140
		jnb	loc_441692
		mov	esi, 400000h

loc_441721:				; CODE XREF: sub_441680+C3j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		lea	edx, [ebp+flOldProtect]
		call	sub_441440
		cmp	ebx, offset dword_450140
		jb	short loc_441721

loc_441745:				; CODE XREF: sub_441680+24Bj
		mov	ecx, ds:dword_451988
		test	ecx, ecx
		jle	loc_441692
		xor	ebx, ebx
		xor	esi, esi
		mov	edi, ds:VirtualQuery
		jmp	short loc_441772
; ---------------------------------------------------------------------------
		align 10h

loc_441760:				; CODE XREF: sub_441680+FDj
					; sub_441680+14Aj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_451988
		jge	loc_441692

loc_441772:				; CODE XREF: sub_441680+DDj
		mov	eax, ds:dword_451984
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_441760
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	edi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_4418F2
		lea	eax, [ebp+flOldProtect]
		mov	[esp+58h+lpflOldProtect], eax ;	lpflOldProtect
		mov	eax, ds:dword_451984
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_441760
; ---------------------------------------------------------------------------

loc_4417CC:				; CODE XREF: sub_441680+86j
		mov	eax, ds:dword_450148
		test	eax, eax
		jnz	short loc_4417F5
		mov	ebx, offset dword_45014C
		lea	esi, [esi+0]

loc_4417E0:				; CODE XREF: sub_441680+70j
		mov	edi, [ebx]
		test	edi, edi
		jnz	loc_441710
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	loc_441710

loc_4417F5:				; CODE XREF: sub_441680+153j
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_441915
		add	ebx, 0Ch
		cmp	ebx, offset dword_450140
		jnb	loc_441692

loc_441810:				; CODE XREF: sub_441680+245j
		movzx	edx, byte ptr [ebx+8]
		mov	eax, 400000h
		mov	ecx, [ebx]
		add	eax, [ebx+4]
		cmp	edx, 10h
		mov	esi, [ecx+400000h]
		jz	short loc_44186A
		cmp	edx, 20h
		jz	short loc_4418A0
		cmp	edx, 8
		jz	short loc_44184A
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		mov	[ebp+var_20], 0
		call	sub_4413E0
; ---------------------------------------------------------------------------

loc_44184A:				; CODE XREF: sub_441680+1B1j
		movzx	edi, byte ptr [eax]
		test	edi, 80h
		jz	short loc_441875
		or	edi, 0FFFFFF00h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi
		jmp	short loc_441891
; ---------------------------------------------------------------------------

loc_44186A:				; CODE XREF: sub_441680+1A7j
		movzx	edi, word ptr [eax]
		test	edi, 8000h
		jnz	short loc_4418D0

loc_441875:				; CODE XREF: sub_441680+1D3j
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		cmp	edx, 10h
		mov	[ebp+var_20], esi
		jz	short loc_4418E3
		cmp	edx, 20h
		jz	short loc_4418AF
		cmp	edx, 8
		jnz	short loc_4418BC

loc_441891:				; CODE XREF: sub_441680+1E8j
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_20]
		call	sub_441440
		jmp	short loc_4418BC
; ---------------------------------------------------------------------------

loc_4418A0:				; CODE XREF: sub_441680+1ACj
		mov	edx, [eax]
		sub	edx, ecx
		sub	edx, 400000h
		add	edx, esi
		mov	[ebp+var_20], edx

loc_4418AF:				; CODE XREF: sub_441680+20Aj
		mov	ecx, 4		; Size
		lea	edx, [ebp+var_20]
		call	sub_441440

loc_4418BC:				; CODE XREF: sub_441680+20Fj
					; sub_441680+21Ej ...
		add	ebx, 0Ch
		cmp	ebx, offset dword_450140
		jb	loc_441810
		jmp	loc_441745
; ---------------------------------------------------------------------------

loc_4418D0:				; CODE XREF: sub_441680+1F3j
		or	edi, 0FFFF0000h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi

loc_4418E3:				; CODE XREF: sub_441680+205j
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_20]
		call	sub_441440
		jmp	short loc_4418BC
; ---------------------------------------------------------------------------

loc_4418F2:				; CODE XREF: sub_441680+11Bj
		add	ebx, ds:dword_451984
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_4413E0
; ---------------------------------------------------------------------------

loc_441915:				; CODE XREF: sub_441680+17Bj
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_4413E0
sub_441680	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_441930	proc near		; CODE XREF: .text:004419D1p
					; sub_441A40+Ap ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	eax, eax
		cmp	word ptr [edx],	5A4Dh
		jz	short loc_441940

locret_44193D:				; CODE XREF: sub_441930+19j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_441940:				; CODE XREF: sub_441930+Bj
		add	edx, [edx+3Ch]
		cmp	dword ptr [edx], 4550h
		jnz	short locret_44193D
		xor	eax, eax
		cmp	word ptr [edx+18h], 10Bh
		setz	al
		retn
sub_441930	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_441960	proc near		; CODE XREF: sub_441A40+2Bp
					; .text:00441B84p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		xor	eax, eax
		push	ebx
		mov	edx, [esp+8+arg_0]
		mov	ebx, [esp+8+arg_4]
		add	edx, [edx+3Ch]
		movzx	esi, word ptr [edx+6]
		movzx	ecx, word ptr [edx+14h]
		test	esi, esi
		jz	short loc_44199E
		movzx	ecx, cx
		lea	eax, [edx+ecx+18h]
		xor	edx, edx

loc_441984:				; CODE XREF: sub_441960+3Aj
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_441992
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_44199E

loc_441992:				; CODE XREF: sub_441960+29j
		add	edx, 1
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_441984
		xor	eax, eax

loc_44199E:				; CODE XREF: sub_441960+19j
					; sub_441960+30j
		pop	ebx
		pop	esi
		retn
sub_441960	endp

; ---------------------------------------------------------------------------
		jmp	short loc_4419B0
; ---------------------------------------------------------------------------
		align 10h

loc_4419B0:				; CODE XREF: .text:004419A1j
		push	ebp
		push	edi
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 1Ch
		mov	edi, [esp+30h]
		mov	[esp], edi
		call	strlen
		cmp	eax, 8
		ja	short loc_441A23
		mov	dword ptr [esp], 400000h
		call	sub_441930
		test	eax, eax
		jz	short loc_441A23
		mov	eax, ds:40003Ch
		movzx	ebp, word ptr [eax+400006h]
		movzx	edx, word ptr [eax+400014h]
		add	eax, 400000h
		test	ebp, ebp
		jz	short loc_441A23
		movzx	edx, dx
		xor	esi, esi
		lea	ebx, [eax+edx+18h]
		jmp	short loc_441A0B
; ---------------------------------------------------------------------------

loc_441A01:				; CODE XREF: .text:00441A21j
		add	esi, 1
		add	ebx, 28h
		cmp	esi, ebp
		jnb	short loc_441A30

loc_441A0B:				; CODE XREF: .text:004419FFj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], edi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jnz	short loc_441A01

loc_441A23:				; CODE XREF: .text:004419C8j
					; .text:004419D8j ...
		add	esp, 1Ch
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_441A30:				; CODE XREF: .text:00441A09j
		add	esp, 1Ch
		xor	ebx, ebx
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_441A40	proc near		; CODE XREF: sub_441440+46p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	[esp+8+var_8], 400000h
		call	sub_441930
		mov	edx, eax
		xor	eax, eax
		test	edx, edx
		jz	short loc_441A70
		mov	eax, [esp+8+arg_0]
		mov	[esp+8+var_8], 400000h
		sub	eax, 400000h
		mov	[esp+8+var_4], eax
		call	sub_441960

loc_441A70:				; CODE XREF: sub_441A40+15j
		add	esp, 8
		retn
sub_441A40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_441A80	proc near		; CODE XREF: sub_441680+2Ap

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_441930
		xor	edx, edx
		test	eax, eax
		jz	short loc_441AA1
		mov	eax, ds:40003Ch
		movzx	edx, word ptr [eax+400006h]

loc_441AA1:				; CODE XREF: sub_441A80+13j
		mov	eax, edx
		add	esp, 4
		retn
sub_441A80	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 4
		mov	dword ptr [esp], 400000h
		mov	ebx, [esp+10h]
		call	sub_441930
		xor	edx, edx
		test	eax, eax
		jz	short loc_441B09
		mov	eax, ds:40003Ch
		movzx	ecx, word ptr [eax+400006h]
		movzx	esi, word ptr [eax+400014h]
		add	eax, 400000h
		test	ecx, ecx
		jz	short loc_441B09
		movzx	esi, si
		lea	edx, [eax+esi+18h]
		xor	eax, eax

loc_441AF0:				; CODE XREF: .text:00441B05j
		test	byte ptr [edx+27h], 20h
		jz	short loc_441AFD
		test	ebx, ebx
		jz	short loc_441B09
		sub	ebx, 1

loc_441AFD:				; CODE XREF: .text:00441AF4j
		add	eax, 1
		add	edx, 28h
		cmp	eax, ecx
		jb	short loc_441AF0
		xor	edx, edx

loc_441B09:				; CODE XREF: .text:00441AC9j
					; .text:00441AE5j ...
		add	esp, 4
		mov	eax, edx
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_441B20
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_441B20	proc near		; CODE XREF: sub_441440+70p
					; .text:00441B11j

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_441930
		xor	edx, edx
		test	eax, eax
		mov	eax, 400000h
		cmovnz	edx, eax
		add	esp, 4
		mov	eax, edx
		retn
sub_441B20	endp

; ---------------------------------------------------------------------------
		jmp	short loc_441B50
; ---------------------------------------------------------------------------
		align 10h

loc_441B50:				; CODE XREF: .text:00441B41j
		push	ebx
		xor	ebx, ebx
		sub	esp, 8
		mov	dword ptr [esp], 400000h
		call	sub_441930
		test	eax, eax
		jnz	short loc_441B70

loc_441B66:				; CODE XREF: .text:00441B8Bj
		add	esp, 8
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_441B70:				; CODE XREF: .text:00441B64j
		mov	eax, [esp+10h]
		mov	dword ptr [esp], 400000h
		sub	eax, 400000h
		mov	[esp+4], eax
		call	sub_441960
		test	eax, eax
		jz	short loc_441B66
		mov	ebx, [eax+24h]
		add	esp, 8
		not	ebx
		shr	ebx, 1Fh
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_441BA0	proc near		; CODE XREF: sub_441C30+1Ap

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	edi
		xor	edi, edi
		push	esi
		push	ebx
		sub	esp, 8
		mov	[esp+14h+var_14], 400000h
		mov	ebx, [esp+14h+arg_0]
		call	sub_441930
		test	eax, eax
		jz	short loc_441C11
		mov	eax, ds:40003Ch
		mov	esi, [eax+400080h]
		test	esi, esi
		jz	short loc_441C11
		mov	[esp+14h+var_10], esi
		mov	[esp+14h+var_14], 400000h
		call	sub_441960
		test	eax, eax
		jz	short loc_441C11
		add	esi, 400000h
		jnz	short loc_441BF6
		jmp	short loc_441C11
; ---------------------------------------------------------------------------
		align 10h

loc_441BF0:				; CODE XREF: sub_441BA0+66j
		sub	ebx, 1
		add	esi, 14h

loc_441BF6:				; CODE XREF: sub_441BA0+45j
		mov	edx, [esi+4]
		test	edx, edx
		jnz	short loc_441C04
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_441C20

loc_441C04:				; CODE XREF: sub_441BA0+5Bj
		test	ebx, ebx
		jg	short loc_441BF0
		mov	edi, [esi+0Ch]
		add	edi, 400000h

loc_441C11:				; CODE XREF: sub_441BA0+1Aj
					; sub_441BA0+29j ...
		add	esp, 8
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_441C20:				; CODE XREF: sub_441BA0+62j
		add	esp, 8
		xor	edi, edi
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_441BA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_441C30	proc near		; CODE XREF: sub_401180+132p

lpModuleName	= dword	ptr -1Ch

		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_45198C
		test	eax, eax
		jz	short loc_441C42

loc_441C3D:				; CODE XREF: sub_441C30+97j
					; sub_441C30+B5j
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_441C42:				; CODE XREF: sub_441C30+Bj
		xor	eax, eax

loc_441C44:				; CODE XREF: sub_441C30+82j
		mov	[esp+1Ch+lpModuleName],	eax
		lea	ebx, [eax+1]
		call	sub_441BA0
		test	eax, eax
		jz	short loc_441CD0
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_441C60
		cmp	dl, 6Dh
		jnz	short loc_441CB0

loc_441C60:				; CODE XREF: sub_441C30+29j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_441C6E
		cmp	dl, 73h
		jnz	short loc_441CB0

loc_441C6E:				; CODE XREF: sub_441C30+37j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_441C7C
		cmp	dl, 76h
		jnz	short loc_441CB0

loc_441C7C:				; CODE XREF: sub_441C30+45j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_441C8A
		cmp	dl, 63h
		jnz	short loc_441CB0

loc_441C8A:				; CODE XREF: sub_441C30+53j
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_441C98
		cmp	dl, 72h
		jnz	short loc_441CB0

loc_441C98:				; CODE XREF: sub_441C30+61j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_441CB4
		cmp	dl, 74h
		jz	short loc_441CB4
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_441CB4
		xchg	ax, ax

loc_441CB0:				; CODE XREF: sub_441C30+2Ej
					; sub_441C30+3Cj ...
		mov	eax, ebx
		jmp	short loc_441C44
; ---------------------------------------------------------------------------

loc_441CB4:				; CODE XREF: sub_441C30+6Fj
					; sub_441C30+74j ...
		mov	[esp+1Ch+lpModuleName],	eax ; lpModuleName
		call	ds:GetModuleHandleA
		sub	esp, 4
		test	eax, eax
		mov	ds:dword_45198C, eax
		jnz	loc_441C3D
		lea	esi, [esi+0]

loc_441CD0:				; CODE XREF: sub_441C30+21j
		mov	[esp+1Ch+lpModuleName],	offset aMsvcrt_dll ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_45198C, eax
		jmp	loc_441C3D
sub_441C30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_441CF0	proc near		; CODE XREF: sub_401180:loc_4012D8p
					; TopLevelExceptionFilter+175p
		fninit
		retn
sub_441CF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_441D00()
sub_441D00	proc near		; DATA XREF: sub_441D80:loc_441D52o
		sub	esp, 0Ch
		mov	eax, off_444C50
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_441D27
		xchg	ax, ax

loc_441D10:				; CODE XREF: sub_441D00+25j
		call	eax
		mov	eax, off_444C50
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_444C50, edx
		test	eax, eax
		jnz	short loc_441D10

loc_441D27:				; CODE XREF: sub_441D00+Cj
		add	esp, 0Ch
		retn
sub_441D00	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_441D80

loc_441D30:				; CODE XREF: sub_441D80+1Aj
		push	ebx
		sub	esp, 18h
		mov	ebx, ds:dword_4431D0
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_441D63

loc_441D3F:				; CODE XREF: sub_441D80-9j
		test	ebx, ebx
		jz	short loc_441D52

loc_441D43:				; CODE XREF: sub_441D80-30j
		call	ds:dword_4431D0[ebx*4]
		sub	ebx, 1
		lea	esi, [esi+0]
		jnz	short loc_441D43

loc_441D52:				; CODE XREF: sub_441D80-3Fj
		mov	[esp+1Ch+var_1C], offset sub_441D00 ; _onexit_t
		call	sub_441160
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_441D63:				; CODE XREF: sub_441D80-43j
		xor	ebx, ebx
		jmp	short loc_441D69
; ---------------------------------------------------------------------------

loc_441D67:				; CODE XREF: sub_441D80-Bj
		mov	ebx, eax

loc_441D69:				; CODE XREF: sub_441D80-1Bj
		lea	eax, [ebx+1]
		mov	edx, ds:dword_4431D0[eax*4]
		test	edx, edx
		jnz	short loc_441D67
		jmp	short loc_441D3F
; END OF FUNCTION CHUNK	FOR sub_441D80
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_441D80	proc near		; CODE XREF: sub_401180+239p
					; sub_401C11+Fp

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 00441D30 SIZE 00000049 BYTES

		mov	ecx, ds:dword_451990
		test	ecx, ecx
		jz	short loc_441D90
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_441D90:				; CODE XREF: sub_441D80+8j
		mov	ds:dword_451990, 1
		jmp	short loc_441D30
sub_441D80	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_441DA0	proc near		; CODE XREF: .text:004014BDp start+Dp

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
SystemTimeAsFileTime= _FILETIME	ptr -2Ch
PerformanceCount= LARGE_INTEGER	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_444C5C
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		jz	short loc_441DF0
		not	eax
		mov	dword_444C60, eax

loc_441DD6:				; CODE XREF: sub_441DA0+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_441DF0:				; CODE XREF: sub_441DA0+2Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_441E62

loc_441E52:				; CODE XREF: sub_441DA0+CCj
		mov	dword_444C5C, ebp
		mov	dword_444C60, eax
		jmp	loc_441DD6
; ---------------------------------------------------------------------------

loc_441E62:				; CODE XREF: sub_441DA0+B0j
		mov	eax, 44BF19B0h
		mov	ebp, 0BB40E64Fh
		jmp	short loc_441E52
sub_441DA0	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_451A64, edx
		mov	ds:dword_451C80, 0C0000409h
		mov	ds:dword_451C84, 1
		mov	ds:dword_451A58, eax
		mov	ds:dword_451C8C, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_451A4C, eax
		mov	eax, dword_444C5C
		mov	[ebp-10h], eax
		mov	eax, dword_444C60
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_44FF44
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_441F00	proc near		; CODE XREF: sub_4420A0+79p
					; sub_4420A0:loc_442132p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_451CFC
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_441F55
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		lea	esi, [esi+0]

loc_441F30:				; CODE XREF: sub_441F00+53j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_441F4E
		test	esi, esi
		jz	short loc_441F4E
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_441F4E:				; CODE XREF: sub_441F00+40j
					; sub_441F00+44j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_441F30

loc_441F55:				; CODE XREF: sub_441F00+1Fj
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_441F00	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 1Ch
		mov	eax, ds:dword_451CE0
		mov	[esp+14h], ebx
		xor	ebx, ebx
		mov	[esp+18h], esi
		test	eax, eax
		jnz	short loc_441F94

loc_441F86:				; CODE XREF: .text:00441FFCj
		mov	eax, ebx
		mov	esi, [esp+18h]
		mov	ebx, [esp+14h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_441F94:				; CODE XREF: .text:00441F84j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		test	eax, eax
		mov	esi, eax
		jz	short loc_441FF7
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	CriticalSection
		mov	[esi], eax
		mov	eax, [esp+24h]
		mov	[esi+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_451CFC
		mov	ds:dword_451CFC, esi
		mov	[esi+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, ebx
		sub	esp, 4
		mov	ebx, [esp+14h]
		mov	esi, [esp+18h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_441FF7:				; CODE XREF: .text:00441FACj
		mov	ebx, 0FFFFFFFFh
		jmp	short loc_441F86
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_451CE0
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_442018
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_442018:				; CODE XREF: .text:0044200Fj
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:EnterCriticalSection
		mov	edx, ds:dword_451CFC
		sub	esp, 4
		test	edx, edx
		jz	short loc_44204F
		mov	eax, [edx]
		cmp	eax, ebx
		jnz	short loc_442048
		jmp	short loc_442086
; ---------------------------------------------------------------------------
		align 10h

loc_442040:				; CODE XREF: .text:0044204Dj
		mov	ecx, [eax]
		cmp	ecx, ebx
		jz	short loc_442066
		mov	edx, eax

loc_442048:				; CODE XREF: .text:00442036j
		mov	eax, [edx+8]
		test	eax, eax
		jnz	short loc_442040

loc_44204F:				; CODE XREF: .text:00442030j
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_44205F:				; CODE XREF: .text:00442084j
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_442066:				; CODE XREF: .text:00442044j
		mov	ecx, [eax+8]
		mov	[edx+8], ecx

loc_44206C:				; CODE XREF: .text:00442090j
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_44205F
; ---------------------------------------------------------------------------

loc_442086:				; CODE XREF: .text:00442038j
		mov	eax, [edx+8]
		mov	ds:dword_451CFC, eax
		mov	eax, edx
		jmp	short loc_44206C
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4420A0	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+E9p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_4420F0
		jb	short loc_4420C0
		cmp	eax, 3
		jz	short loc_442110

loc_4420B3:				; CODE XREF: sub_4420A0+31j
					; sub_4420A0+4Dj ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4420C0:				; CODE XREF: sub_4420A0+Cj
		mov	eax, ds:dword_451CE0
		test	eax, eax
		jnz	short loc_442132

loc_4420C9:				; CODE XREF: sub_4420A0+97j
		mov	eax, ds:dword_451CE0
		cmp	eax, 1
		jnz	short loc_4420B3
		mov	ds:dword_451CE0, 0
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_4420B3
; ---------------------------------------------------------------------------
		align 10h

loc_4420F0:				; CODE XREF: sub_4420A0+Aj
		mov	eax, ds:dword_451CE0
		test	eax, eax
		jz	short loc_442120

loc_4420F9:				; CODE XREF: sub_4420A0+90j
		mov	ds:dword_451CE0, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_442110:				; CODE XREF: sub_4420A0+11j
		mov	eax, ds:dword_451CE0
		test	eax, eax
		jz	short loc_4420B3
		call	sub_441F00
		jmp	short loc_4420B3
; ---------------------------------------------------------------------------

loc_442120:				; CODE XREF: sub_4420A0+57j
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_4420F9
; ---------------------------------------------------------------------------

loc_442132:				; CODE XREF: sub_4420A0+27j
		call	sub_441F00
		jmp	short loc_4420C9
sub_4420A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_442140	proc near		; CODE XREF: sub_401180+19p
					; sub_441680+3Cp

arg_0		= byte ptr  4

		push	ecx
		push	eax
		cmp	eax, 1000h
		lea	ecx, [esp+8+arg_0]
		jb	short loc_442162

loc_44214D:				; CODE XREF: sub_442140+20j
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_44214D

loc_442162:				; CODE XREF: sub_442140+Bj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		pop	eax
		pop	ecx
		retn
sub_442140	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_442170	proc near		; CODE XREF: sub_428099+2C6p
					; sub_440780+148p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 2Ch
		mov	[esp+2Ch+var_4], ebp
		mov	ebp, [esp+2Ch+arg_C]
		mov	eax, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_10], ebx
		mov	ecx, [esp+2Ch+arg_8]
		mov	ebx, [esp+2Ch+arg_4]
		test	ebp, ebp
		mov	[esp+2Ch+var_C], esi
		mov	esi, eax
		mov	[esp+2Ch+var_8], edi
		mov	edi, ecx
		mov	[esp+2Ch+var_24], eax
		mov	edx, ebx
		jnz	short loc_4421C0
		cmp	ecx, ebx
		jbe	short loc_4421E2
		div	ecx

loc_4421A7:				; CODE XREF: sub_442170+8Bj
		mov	eax, edx
		xor	edx, edx

loc_4421AB:				; CODE XREF: sub_442170+70j
					; sub_442170+92j ...
		mov	ebx, [esp+2Ch+var_10]
		mov	esi, [esp+2Ch+var_C]
		mov	edi, [esp+2Ch+var_8]
		mov	ebp, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4421C0:				; CODE XREF: sub_442170+2Fj
		cmp	ebp, ebx
		ja	short loc_442200
		bsr	eax, ebp
		xor	eax, 1Fh
		mov	[esp+2Ch+var_28], eax
		jnz	short loc_442204
		cmp	ecx, esi
		ja	loc_442298

loc_4421D8:				; CODE XREF: sub_442170+12Aj
		mov	edx, ebx
		sub	esi, ecx
		sbb	edx, ebp
		mov	eax, esi
		jmp	short loc_4421AB
; ---------------------------------------------------------------------------

loc_4421E2:				; CODE XREF: sub_442170+33j
		test	ecx, ecx
		jnz	short loc_4421F1
		mov	eax, 1
		xor	edx, edx
		div	ecx
		mov	ecx, eax

loc_4421F1:				; CODE XREF: sub_442170+74j
		mov	eax, ebx
		xor	edx, edx
		div	ecx
		mov	eax, esi
		div	ecx
		jmp	short loc_4421A7
; ---------------------------------------------------------------------------
		align 10h

loc_442200:				; CODE XREF: sub_442170+52j
		mov	edx, ebx
		jmp	short loc_4421AB
; ---------------------------------------------------------------------------

loc_442204:				; CODE XREF: sub_442170+5Ej
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		mov	esi, 20h
		mov	eax, ebp
		sub	esi, [esp+2Ch+var_28]
		mov	ebp, edi
		mov	edx, ebx
		shl	eax, cl
		mov	ecx, esi
		shr	ebp, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		or	ebp, eax
		mov	eax, [esp+2Ch+var_24]
		shl	edi, cl
		mov	ecx, esi
		shr	edx, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		mov	[esp+2Ch+var_20], edi
		shl	ebx, cl
		mov	ecx, esi
		shr	eax, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		or	eax, ebx
		mov	ebx, [esp+2Ch+var_24]
		div	ebp
		shl	ebx, cl
		mov	[esp+2Ch+var_24], ebx
		mov	ebx, edx
		mul	edi
		cmp	ebx, edx
		mov	edi, eax
		mov	ecx, edx
		jb	short loc_44228C
		cmp	[esp+2Ch+var_24], eax
		jb	short loc_442288

loc_442263:				; CODE XREF: sub_442170+11Aj
					; sub_442170+126j
		mov	eax, [esp+2Ch+var_24]
		sub	eax, edi
		sbb	ebx, ecx
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		mov	edx, ebx
		shr	eax, cl
		mov	ecx, esi
		shl	edx, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		or	eax, edx
		mov	edx, ebx
		shr	edx, cl
		jmp	loc_4421AB
; ---------------------------------------------------------------------------

loc_442288:				; CODE XREF: sub_442170+F1j
		cmp	ebx, edx
		jnz	short loc_442263

loc_44228C:				; CODE XREF: sub_442170+EBj
		mov	ecx, edx
		mov	edi, eax
		sub	edi, [esp+2Ch+var_20]
		sbb	ecx, ebp
		jmp	short loc_442263
; ---------------------------------------------------------------------------

loc_442298:				; CODE XREF: sub_442170+62j
		cmp	ebp, ebx
		jb	loc_4421D8
		mov	eax, esi
		jmp	loc_4421AB
sub_442170	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4422B0	proc near		; CODE XREF: sub_428099+2F2p
					; sub_440780+177p ...

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 2Ch
		mov	edx, [esp+2Ch+arg_C]
		mov	[esp+2Ch+var_C], esi
		mov	ecx, [esp+2Ch+arg_8]
		mov	esi, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_10], ebx
		mov	ebx, [esp+2Ch+arg_4]
		test	edx, edx
		mov	[esp+2Ch+var_8], edi
		mov	edi, ecx
		mov	[esp+2Ch+var_4], ebp
		mov	[esp+2Ch+var_24], esi
		jnz	short loc_442318
		cmp	ecx, ebx
		ja	short loc_442340
		test	ecx, ecx
		jnz	short loc_4422F0
		mov	eax, 1
		xor	edx, edx
		div	ecx
		mov	ecx, eax

loc_4422F0:				; CODE XREF: sub_4422B0+33j
		mov	eax, ebx
		xor	edx, edx
		div	ecx
		mov	ebx, eax
		mov	eax, esi
		div	ecx
		mov	ecx, ebx
		mov	esi, eax

loc_442300:				; CODE XREF: sub_4422B0+6Ej
					; sub_4422B0+80j ...
		mov	eax, esi
		mov	edx, ecx
		mov	ebx, [esp+2Ch+var_10]
		mov	esi, [esp+2Ch+var_C]
		mov	edi, [esp+2Ch+var_8]
		mov	ebp, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_442318:				; CODE XREF: sub_4422B0+2Bj
		xor	ecx, ecx
		xor	esi, esi
		cmp	edx, ebx
		ja	short loc_442300
		bsr	ebp, edx
		xor	ebp, 1Fh
		jnz	short loc_442350
		cmp	edi, [esp+2Ch+var_24]
		jbe	short loc_442332
		cmp	edx, ebx
		jnb	short loc_442300

loc_442332:				; CODE XREF: sub_4422B0+7Cj
		xor	ecx, ecx
		mov	esi, 1
		jmp	short loc_442300
; ---------------------------------------------------------------------------
		align 10h

loc_442340:				; CODE XREF: sub_4422B0+2Fj
		mov	eax, esi
		mov	edx, ebx
		div	ecx
		xor	ecx, ecx
		mov	esi, eax
		jmp	short loc_442300
; ---------------------------------------------------------------------------
		align 10h

loc_442350:				; CODE XREF: sub_4422B0+76j
		mov	eax, 20h
		mov	ecx, ebp
		sub	eax, ebp
		mov	esi, edi
		shl	edx, cl
		mov	ecx, eax
		shr	esi, cl
		mov	ecx, ebp
		or	esi, edx
		mov	edx, ebx
		mov	[esp+2Ch+var_20], esi
		mov	esi, [esp+2Ch+var_24]
		shl	edi, cl
		mov	ecx, eax
		shr	edx, cl
		mov	ecx, ebp
		shl	ebx, cl
		mov	ecx, eax
		shr	esi, cl
		or	esi, ebx
		mov	eax, esi
		div	[esp+2Ch+var_20]
		mov	ebx, edx
		mov	esi, eax
		mul	edi
		cmp	ebx, edx
		jb	short loc_44239F
		mov	edi, [esp+2Ch+var_24]
		mov	ecx, ebp
		shl	edi, cl
		cmp	edi, eax
		jnb	short loc_4423A2
		cmp	ebx, edx
		jnz	short loc_4423A2

loc_44239F:				; CODE XREF: sub_4422B0+DDj
		sub	esi, 1

loc_4423A2:				; CODE XREF: sub_4422B0+E9j
					; sub_4422B0+EDj
		xor	ecx, ecx
		jmp	loc_442300
sub_4422B0	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _rmdir]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _getpid]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _chdir]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _close]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _fdopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _access]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _fileno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _read]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _write]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _setmode]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _dup]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _putenv]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _tzset]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _mkdir]
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_442450
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_442450	proc near		; CODE XREF: sub_401180+A7p
					; .text:00442441j

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_442450	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame fpd=222h

sub_442470	proc near		; CODE XREF: sub_442650+A6p

Size		= dword	ptr -348h
lpFilename	= dword	ptr -344h
nSize		= dword	ptr -340h
uType		= dword	ptr -33Ch
var_338		= dword	ptr -338h
var_334		= dword	ptr -334h
Filename	= byte ptr -327h
var_323		= dword	ptr -323h
var_31F		= word ptr -31Fh
var_223		= byte ptr -223h
var_222		= word ptr -222h
var_11D		= dword	ptr -11Dh
var_119		= dword	ptr -119h
var_115		= word ptr -115h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 33Ch
		mov	esi, [esp+348h+arg_0]
		lea	ebp, [esp+126h]
		mov	ebx, [esp+348h+arg_4]
		mov	[esp+348h+Size], 2000h ; Size
		call	malloc
		test	esi, esi
		lea	ecx, [esi+208h]
		mov	edi, eax
		mov	eax, ebp
		jnz	short loc_4424BC
		jmp	short loc_4424C4
; ---------------------------------------------------------------------------
		align 10h

loc_4424B0:				; CODE XREF: sub_442470+52j
		add	esi, 2
		mov	[eax], dl
		add	eax, 1
		cmp	esi, ecx
		jz	short loc_4424C4

loc_4424BC:				; CODE XREF: sub_442470+37j
		movzx	edx, word ptr [esi]
		test	dx, dx
		jnz	short loc_4424B0

loc_4424C4:				; CODE XREF: sub_442470+39j
					; sub_442470+4Aj
		lea	esi, [esp+348h+var_11D]
		test	ebx, ebx
		mov	byte ptr [eax],	0
		lea	ecx, [ebx+208h]
		mov	eax, esi
		jnz	short loc_4424EC
		jmp	short loc_4424F4
; ---------------------------------------------------------------------------
		align 10h

loc_4424E0:				; CODE XREF: sub_442470+82j
		add	ebx, 2
		mov	[eax], dl
		add	eax, 1
		cmp	ebx, ecx
		jz	short loc_4424F4

loc_4424EC:				; CODE XREF: sub_442470+68j
		movzx	edx, word ptr [ebx]
		test	dx, dx
		jnz	short loc_4424E0

loc_4424F4:				; CODE XREF: sub_442470+6Aj
					; sub_442470+7Aj
		mov	byte ptr [eax],	0
		cmp	byte ptr [esp+348h+var_11D], 0
		jz	loc_4425B0
		cmp	byte ptr [esp+348h+var_222], 0
		jz	loc_4425DE

loc_442513:				; CODE XREF: sub_442470+168j
					; sub_442470+178j
		lea	ebx, [esp+348h+Filename]
		mov	[esp+348h+var_223], 0
		mov	[esp+348h+nSize], 104h ; nSize
		mov	[esp+348h+lpFilename], ebx ; lpFilename
		mov	[esp+348h+Size], 0 ; hModule
		call	ds:GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_4425F0

loc_442543:				; CODE XREF: sub_442470+197j
		mov	eax, [esp+348h+arg_8]
		mov	[esp+348h+var_334], ebp
		mov	[esp+348h+uType], esi
		mov	[esp+348h+nSize], ebx
		mov	[esp+348h+var_338], eax
		mov	[esp+348h+lpFilename], offset aAssertionFaile ;	"Assertion failed!\n\nProgram: %s\nFile:"...
		mov	[esp+348h+Size], edi ; Dest
		call	sprintf
		mov	eax, ds:dword_451970
		test	eax, eax
		jz	loc_442629
		mov	[esp+348h+uType], 12012h ; uType
		mov	[esp+348h+nSize], offset Caption ; "MinGW Runtime Assertion"
		mov	[esp+348h+lpFilename], edi ; lpText
		mov	[esp+348h+Size], 0 ; hWnd
		call	ds:MessageBoxA
		sub	esp, 10h
		cmp	eax, 3
		jz	short loc_442611
		cmp	eax, 5
		jnz	short loc_44260C
		add	esp, 33Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_4425B0:				; CODE XREF: sub_442470+8Fj
		cmp	byte ptr [esp+348h+var_222], 0
		mov	[esp+348h+var_11D], 6B6E753Ch
		mov	[esp+348h+var_119], 6E776F6Eh
		mov	[esp+348h+var_115], 3Eh
		jnz	loc_442513

loc_4425DE:				; CODE XREF: sub_442470+9Dj
		mov	[esp+348h+var_222], 3Fh
		jmp	loc_442513
; ---------------------------------------------------------------------------
		align 10h

loc_4425F0:				; CODE XREF: sub_442470+CDj
		mov	dword ptr [esp+348h+Filename], 6B6E753Ch
		mov	[esp+348h+var_323], 6E776F6Eh
		mov	[esp+348h+var_31F], 3Eh
		jmp	loc_442543
; ---------------------------------------------------------------------------

loc_44260C:				; CODE XREF: sub_442470+133j
		call	abort
; ---------------------------------------------------------------------------

loc_442611:				; CODE XREF: sub_442470+12Ej
		mov	[esp+348h+Size], 16h
		call	raise
		mov	[esp+348h+Size], 3 ; Code
		call	_exit
; ---------------------------------------------------------------------------

loc_442629:				; CODE XREF: sub_442470+101j
		mov	eax, ds:_iob
		mov	[esp+348h+nSize], edi
		mov	[esp+348h+lpFilename], offset aS_6 ; "%s\n"
		add	eax, 40h
		mov	[esp+348h+Size], eax ; File
		call	fprintf
		call	abort
sub_442470	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_442650(char *, char *, int)
sub_442650	proc near		; CODE XREF: sub_402D72+114p
					; sub_408D9F+2Ep ...

Str		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Memory		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [esp+3Ch+arg_0]
		mov	edx, [esp+3Ch+arg_8]
		mov	esi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+Str], edi ; Str
		mov	[esp+3Ch+var_20], edx
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		mov	[esp+3Ch+Str], esi ; Str
		mov	ebx, eax
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		movzx	ecx, byte ptr [edi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_4426B6
		xor	ebp, ebp
		lea	esi, [esi+0]

loc_4426A0:				; CODE XREF: sub_442650+62j
		add	edx, 1
		movzx	ecx, cl
		mov	[ebx+ebp*2], cx
		movzx	ecx, byte ptr [edi+edx]
		mov	ebp, edx
		test	cl, cl
		jnz	short loc_4426A0
		add	edx, edx

loc_4426B6:				; CODE XREF: sub_442650+48j
		mov	word ptr [ebx+edx], 0
		movzx	ecx, byte ptr [esi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_4426DD
		xor	edi, edi

loc_4426C7:				; CODE XREF: sub_442650+89j
		add	edx, 1
		movzx	ecx, cl
		mov	[eax+edi*2], cx
		movzx	ecx, byte ptr [esi+edx]
		mov	edi, edx
		test	cl, cl
		jnz	short loc_4426C7
		add	edx, edx

loc_4426DD:				; CODE XREF: sub_442650+73j
		mov	word ptr [eax+edx], 0
		mov	edx, [esp+3Ch+var_20]
		mov	[esp+3Ch+var_38], eax
		mov	[esp+3Ch+Memory], eax
		mov	[esp+3Ch+Str], ebx
		mov	[esp+3Ch+var_34], edx
		call	sub_442470
		mov	[esp+3Ch+Str], ebx ; Memory
		call	free
		mov	eax, [esp+3Ch+Memory]
		mov	[esp+3Ch+arg_0], eax ; Memory
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		jmp	free
sub_442650	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_442720	proc near		; CODE XREF: sub_4168B1+1B7p
					; sub_4168B1+24Cp ...
		jmp	sub_442F40
sub_442720	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_442730	proc near		; CODE XREF: .text:0042A45Ap
					; .text:0042AA2Ap ...
		jmp	sub_442F50
sub_442730	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_442740	proc near		; CODE XREF: .text:0042A724p
					; sub_4406AE+2Dp
		jmp	sub_442F60
sub_442740	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_442750	proc near		; CODE XREF: .text:0042ADA3p
					; sub_43C72A+AAp
		jmp	sub_442F70
sub_442750	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000005 BYTES: COLLAPSED FUNCTION j__lseeki64]
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_442770(FILE *)
sub_442770	proc near		; CODE XREF: .text:00442C7Bp

File		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 2Ch
		mov	[esp+2Ch+var_C], ebx
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_8], esi
		mov	[esp+2Ch+var_4], edi
		mov	eax, [ebx+0Ch]
		mov	edx, eax
		and	edx, 3
		cmp	edx, 2
		jz	short loc_4427B0

loc_442790:				; CODE XREF: sub_442770+94j
					; sub_442770+9Cj
		mov	edi, [ebx+8]
		xor	eax, eax

loc_442795:				; CODE XREF: sub_442770+A7j
					; sub_442770+BCj
		mov	[ebx], edi
		mov	esi, [esp+2Ch+var_8]
		mov	dword ptr [ebx+4], 0
		mov	edi, [esp+2Ch+var_4]
		mov	ebx, [esp+2Ch+var_C]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4427B0:				; CODE XREF: sub_442770+1Ej
		test	eax, 108h
		mov	edi, [ebx+8]
		jz	short loc_442815
		mov	esi, [ebx]
		sub	esi, edi
		mov	eax, esi
		sar	eax, 1Fh
		mov	[esp+2Ch+var_10], eax
		cmp	[esp+2Ch+var_10], 0
		mov	[esp+2Ch+var_14], esi
		jl	short loc_442815
		jle	short loc_442810

loc_4427D4:				; CODE XREF: sub_442770+A3j
		mov	[esp+2Ch+File],	ebx ; File
		call	_fileno_0
		mov	[esp+2Ch+var_24], esi
		mov	[esp+2Ch+var_28], edi
		mov	[esp+2Ch+File],	eax
		call	_write_0
		mov	ecx, eax
		mov	edx, eax
		mov	eax, [esp+2Ch+var_10]
		sar	edx, 1Fh
		xor	esi, ecx
		xor	eax, edx
		or	eax, esi
		jnz	short loc_442820
		mov	eax, [ebx+0Ch]
		test	al, 80h
		jz	short loc_442790
		and	eax, 0FFFFFFFDh
		mov	[ebx+0Ch], eax
		jmp	short loc_442790
; ---------------------------------------------------------------------------
		align 10h

loc_442810:				; CODE XREF: sub_442770+62j
		cmp	esi, 0
		ja	short loc_4427D4

loc_442815:				; CODE XREF: sub_442770+48j
					; sub_442770+60j
		xor	eax, eax
		jmp	loc_442795
; ---------------------------------------------------------------------------
		align 10h

loc_442820:				; CODE XREF: sub_442770+8Dj
		or	dword ptr [ebx+0Ch], 20h
		mov	eax, 0FFFFFFFFh
		mov	edi, [ebx+8]
		jmp	loc_442795
sub_442770	endp

; ---------------------------------------------------------------------------
		jmp	short sub_442840
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_442840(FILE *, int, int, int)
sub_442840	proc near		; CODE XREF: .text:00438636p
					; .text:00442831j

File		= dword	ptr -3Ch
Pos		= dword	ptr -38h
var_24		= qword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 3Ch
		mov	eax, [esp+3Ch+arg_C]
		mov	[esp+3Ch+var_C], esi
		mov	esi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+var_8], edi
		mov	edi, [esp+3Ch+arg_8]
		mov	[esp+3Ch+var_4], ebp
		mov	ebp, [esp+3Ch+arg_0]
		cmp	eax, 1
		mov	[esp+3Ch+var_10], ebx
		jz	short loc_4428A0
		cmp	eax, 2
		jz	short loc_4428C5
		test	eax, eax
		jnz	short loc_4428F0
		mov	dword ptr [esp+3Ch+var_24], esi
		lea	ebx, [esp+3Ch+var_24]
		mov	dword ptr [esp+3Ch+var_24+4], edi

loc_44287D:				; CODE XREF: sub_442840+83j
					; sub_442840+ADj
		mov	[esp+3Ch+Pos], ebx ; Pos
		mov	[esp+3Ch+File],	ebp ; File
		call	fsetpos

loc_442889:				; CODE XREF: sub_442840+79j
					; sub_442840+C0j
		mov	ebx, [esp+3Ch+var_10]
		mov	esi, [esp+3Ch+var_C]
		mov	edi, [esp+3Ch+var_8]
		mov	ebp, [esp+3Ch+var_4]
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4428A0:				; CODE XREF: sub_442840+26j
		lea	ebx, [esp+3Ch+var_24]
		mov	[esp+3Ch+Pos], ebx ; Pos
		mov	[esp+3Ch+File],	ebp ; File
		call	fgetpos
		mov	edx, eax
		mov	eax, 0FFFFFFFFh
		test	edx, edx
		jnz	short loc_442889
		add	dword ptr [esp+3Ch+var_24], esi
		adc	dword ptr [esp+3Ch+var_24+4], edi
		jmp	short loc_44287D
; ---------------------------------------------------------------------------

loc_4428C5:				; CODE XREF: sub_442840+2Bj
		mov	[esp+3Ch+File],	ebp ; File
		lea	ebx, [esp+3Ch+var_24]
		call	fflush
		mov	[esp+3Ch+File],	ebp ; File
		call	_fileno_0
		mov	[esp+3Ch+File],	eax
		call	_filelengthi64
		add	eax, esi
		adc	edx, edi
		mov	dword ptr [esp+3Ch+var_24], eax
		mov	dword ptr [esp+3Ch+var_24+4], edx
		jmp	short loc_44287D
; ---------------------------------------------------------------------------
		align 10h

loc_4428F0:				; CODE XREF: sub_442840+2Fj
		call	_errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short loc_442889
sub_442840	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_442910(FILE *)
sub_442910	proc near		; CODE XREF: .text:00442CE4p

File		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 5Ch
		mov	[esp+5Ch+var_10], ebx
		mov	ebx, [esp+5Ch+arg_0]
		mov	[esp+5Ch+var_C], esi
		mov	[esp+5Ch+var_8], edi
		mov	[esp+5Ch+var_4], ebp
		call	_errno
		mov	dword ptr [eax], 0
		mov	[esp+5Ch+File],	ebx ; File
		call	_fileno_0
		mov	[esp+5Ch+var_3C], eax
		mov	eax, [ebx+4]
		test	eax, eax
		js	loc_442AD0

loc_442949:				; CODE XREF: sub_442910+1C7j
		mov	eax, [esp+5Ch+var_3C]
		mov	[esp+5Ch+var_50], 1
		mov	[esp+5Ch+var_58], 0
		mov	[esp+5Ch+var_54], 0
		mov	[esp+5Ch+File],	eax
		call	_lseeki64
		test	edx, edx
		mov	esi, eax
		mov	edi, edx
		js	loc_442AF4
		mov	ecx, [ebx+0Ch]
		test	ecx, 108h
		jz	loc_442AA4
		mov	eax, [ebx]
		mov	[esp+5Ch+var_34], eax
		mov	eax, [ebx+8]
		mov	edx, [esp+5Ch+var_34]
		sub	edx, eax
		test	cl, 3
		mov	[esp+5Ch+var_28], edx
		jnz	loc_442A35
		test	cl, 80h
		jz	loc_442BF0
		mov	ebp, [esp+5Ch+var_28]

loc_4429B1:				; CODE XREF: sub_442910+156j
					; sub_442910+160j ...
		mov	eax, edi
		or	eax, esi
		jz	loc_442AE0
		and	ecx, 1
		jz	loc_442AE6
		mov	eax, [ebx+4]
		xor	edx, edx
		xor	ecx, ecx
		mov	[esp+5Ch+var_34], 0
		mov	[esp+5Ch+var_30], 0
		test	eax, eax
		jz	short loc_442A28
		mov	ecx, [esp+5Ch+var_28]
		mov	edx, [esp+5Ch+var_3C]
		add	ecx, eax
		mov	eax, [esp+5Ch+var_3C]
		sar	edx, 5
		mov	[esp+5Ch+var_28], edx
		and	eax, 1Fh
		lea	eax, [eax+eax*4]
		shl	eax, 3
		mov	[esp+5Ch+var_34], eax
		mov	eax, ds:__pioinfo
		mov	eax, [eax+edx*4]
		mov	edx, [esp+5Ch+var_34]
		cmp	byte ptr [eax+edx+4], 0
		js	loc_442B00

loc_442A18:				; CODE XREF: sub_442910+255j
		mov	[esp+5Ch+var_34], ecx
		mov	edx, ebp
		xor	ecx, ecx
		mov	[esp+5Ch+var_30], 0

loc_442A28:				; CODE XREF: sub_442910+CDj
					; sub_442910+26Ej ...
		sub	esi, [esp+5Ch+var_34]
		sbb	edi, [esp+5Ch+var_30]
		jmp	loc_442AEA
; ---------------------------------------------------------------------------

loc_442A35:				; CODE XREF: sub_442910+8Ej
		mov	edx, [esp+5Ch+var_3C]
		mov	ebp, [esp+5Ch+var_3C]
		and	edx, 1Fh
		lea	edx, [edx+edx*4]
		shl	edx, 3
		mov	[esp+5Ch+var_24], edx
		mov	edx, ds:__pioinfo
		sar	ebp, 5
		mov	edx, [edx+ebp*4]
		add	[esp+5Ch+var_24], edx
		mov	edx, [esp+5Ch+var_24]
		mov	ebp, [esp+5Ch+var_28]
		cmp	byte ptr [edx+4], 0
		jns	loc_4429B1
		cmp	[esp+5Ch+var_34], eax
		jbe	loc_4429B1
		mov	[esp+5Ch+var_24], esi
		mov	esi, ecx
		mov	ecx, [esp+5Ch+var_34]
		mov	[esp+5Ch+var_20], edi

loc_442A84:				; CODE XREF: sub_442910+183j
		xor	edx, edx
		cmp	byte ptr [eax],	0Ah
		setz	dl
		add	eax, 1
		add	ebp, edx
		cmp	eax, ecx
		jnz	short loc_442A84
		mov	ecx, esi
		mov	edi, [esp+5Ch+var_20]
		mov	esi, [esp+5Ch+var_24]
		jmp	loc_4429B1
; ---------------------------------------------------------------------------

loc_442AA4:				; CODE XREF: sub_442910+72j
		mov	eax, [ebx+4]
		mov	ecx, esi
		mov	ebx, edi
		mov	edx, eax
		sar	edx, 1Fh
		sub	ecx, eax
		sbb	ebx, edx
		mov	eax, ecx
		mov	edx, ebx

loc_442AB8:				; CODE XREF: sub_442910+1D4j
					; sub_442910+1E2j ...
		mov	ebx, [esp+5Ch+var_10]
		mov	esi, [esp+5Ch+var_C]
		mov	edi, [esp+5Ch+var_8]
		mov	ebp, [esp+5Ch+var_4]
		add	esp, 5Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_442AD0:				; CODE XREF: sub_442910+33j
		mov	dword ptr [ebx+4], 0
		jmp	loc_442949
; ---------------------------------------------------------------------------
		align 10h

loc_442AE0:				; CODE XREF: sub_442910+A5j
		mov	eax, ebp
		xor	edx, edx
		jmp	short loc_442AB8
; ---------------------------------------------------------------------------

loc_442AE6:				; CODE XREF: sub_442910+AEj
		mov	edx, ebp
		xor	ecx, ecx

loc_442AEA:				; CODE XREF: sub_442910+120j
		mov	eax, edx
		mov	edx, ecx
		add	eax, esi
		adc	edx, edi
		jmp	short loc_442AB8
; ---------------------------------------------------------------------------

loc_442AF4:				; CODE XREF: sub_442910+63j
		mov	eax, 0FFFFFFFFh
		mov	edx, 0FFFFFFFFh
		jmp	short loc_442AB8
; ---------------------------------------------------------------------------

loc_442B00:				; CODE XREF: sub_442910+102j
		mov	eax, [esp+5Ch+var_3C]
		mov	[esp+5Ch+var_40], ecx
		mov	[esp+5Ch+var_50], 2
		mov	[esp+5Ch+var_58], 0
		mov	[esp+5Ch+var_54], 0
		mov	[esp+5Ch+File],	eax
		call	_lseeki64
		mov	ecx, [esp+5Ch+var_40]
		xor	edx, edi
		xor	eax, esi
		or	edx, eax
		jnz	short loc_442B83
		mov	edx, [ebx+8]
		lea	eax, [edx+ecx]
		cmp	edx, eax
		jnb	short loc_442B61
		mov	[esp+5Ch+var_3C], esi
		mov	esi, eax
		mov	[esp+5Ch+var_38], edi

loc_442B48:				; CODE XREF: sub_442910+247j
		xor	eax, eax
		cmp	byte ptr [edx],	0Ah
		setz	al
		add	edx, 1
		add	ecx, eax
		cmp	edx, esi
		jnz	short loc_442B48
		mov	esi, [esp+5Ch+var_3C]
		mov	edi, [esp+5Ch+var_38]

loc_442B61:				; CODE XREF: sub_442910+22Cj
		test	byte ptr [ebx+0Dh], 20h
		jz	loc_442A18
		lea	eax, [ecx+1]
		mov	edx, ebp
		mov	[esp+5Ch+var_34], eax
		xor	ecx, ecx
		mov	[esp+5Ch+var_30], 0
		jmp	loc_442A28
; ---------------------------------------------------------------------------

loc_442B83:				; CODE XREF: sub_442910+222j
		mov	eax, [esp+5Ch+var_3C]
		mov	[esp+5Ch+var_40], ecx
		mov	[esp+5Ch+var_50], 0
		mov	[esp+5Ch+var_58], esi
		mov	[esp+5Ch+var_54], edi
		mov	[esp+5Ch+File],	eax
		call	_lseeki64
		mov	ecx, [esp+5Ch+var_40]
		cmp	ecx, 200h
		ja	short loc_442BC1
		mov	eax, [ebx+0Ch]
		mov	edx, 200h
		and	eax, 408h
		cmp	eax, 8
		jz	short loc_442BC4

loc_442BC1:				; CODE XREF: sub_442910+29Dj
		mov	edx, [ebx+18h]

loc_442BC4:				; CODE XREF: sub_442910+2AFj
		mov	eax, ds:__pioinfo
		mov	ecx, [esp+5Ch+var_28]
		mov	ebx, [esp+5Ch+var_34]
		mov	eax, [eax+ecx*4]
		test	byte ptr [eax+ebx+4], 4
		jnz	short loc_442C0A
		mov	[esp+5Ch+var_34], edx
		xor	ecx, ecx
		mov	edx, ebp
		mov	[esp+5Ch+var_30], 0
		jmp	loc_442A28
; ---------------------------------------------------------------------------

loc_442BF0:				; CODE XREF: sub_442910+97j
		call	_errno
		mov	edx, 0FFFFFFFFh
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	loc_442AB8
; ---------------------------------------------------------------------------

loc_442C0A:				; CODE XREF: sub_442910+2C9j
		lea	eax, [edx+1]
		xor	ecx, ecx
		mov	[esp+5Ch+var_34], eax
		mov	edx, ebp
		mov	[esp+5Ch+var_30], 0
		jmp	loc_442A28
sub_442910	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 2Ch
		mov	[esp+1Ch], ebx
		mov	ebx, [esp+30h]
		mov	[esp+20h], esi
		mov	esi, [esp+3Ch]
		mov	[esp+24h], edi
		mov	edi, [esp+34h]
		mov	[esp+28h], ebp
		mov	ebp, [esp+38h]
		call	_errno
		cmp	esi, 2
		mov	dword ptr [eax], 0
		ja	loc_442CF5
		test	ebx, ebx
		jz	loc_442CF5
		and	dword ptr [ebx+0Ch], 0FFFFFFEFh
		cmp	esi, 1
		jz	short loc_442CE1

loc_442C78:				; CODE XREF: .text:00442CF0j
		mov	[esp], ebx
		call	sub_442770
		mov	eax, [ebx+0Ch]
		test	al, 80h
		jnz	short loc_442CD0
		and	eax, 409h
		cmp	eax, 9
		jz	short loc_442CD8

loc_442C91:				; CODE XREF: .text:00442CD6j
					; .text:00442CDFj
		mov	[esp], ebx
		call	_fileno_0
		mov	[esp+0Ch], esi
		mov	[esp+4], edi
		mov	[esp+8], ebp
		mov	[esp], eax
		call	_lseeki64
		and	eax, edx
		not	eax
		cmp	eax, 1
		sbb	eax, eax

loc_442CB6:				; CODE XREF: .text:00442D05j
		mov	ebx, [esp+1Ch]
		mov	esi, [esp+20h]
		mov	edi, [esp+24h]
		mov	ebp, [esp+28h]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_442CD0:				; CODE XREF: .text:00442C85j
		and	eax, 0FFFFFFFCh
		mov	[ebx+0Ch], eax
		jmp	short loc_442C91
; ---------------------------------------------------------------------------

loc_442CD8:				; CODE XREF: .text:00442C8Fj
		mov	dword ptr [ebx+18h], 200h
		jmp	short loc_442C91
; ---------------------------------------------------------------------------

loc_442CE1:				; CODE XREF: .text:00442C76j
		mov	[esp], ebx
		call	sub_442910
		add	edi, eax
		adc	ebp, edx
		xor	si, si
		jmp	loc_442C78
; ---------------------------------------------------------------------------

loc_442CF5:				; CODE XREF: .text:00442C61j
					; .text:00442C69j
		call	_errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short loc_442CB6
; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 4
		mov	esi, [esp+10h]
		call	__doserrno
		mov	[eax], esi
		jmp	short loc_442D31
; ---------------------------------------------------------------------------

loc_442D24:				; CODE XREF: .text:00442D38j
		add	ebx, 1
		cmp	ds:dword_44FFC4[ebx*8],	0FFFFFFFFh
		jz	short loc_442D50

loc_442D31:				; CODE XREF: .text:00442D22j
		cmp	ds:dword_44FFC0[ebx*8],	esi
		jnz	short loc_442D24
		call	_errno
		mov	edx, ds:dword_44FFC4[ebx*8]
		mov	[eax], edx
		add	esp, 4
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_442D50:				; CODE XREF: .text:00442D2Fj
		lea	eax, [esi-13h]
		cmp	eax, 11h
		jbe	short loc_442D85
		sub	esi, 0BCh
		cmp	esi, 0Eh
		jbe	short loc_442D74
		call	_errno
		mov	dword ptr [eax], 16h
		add	esp, 4
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_442D74:				; CODE XREF: .text:00442D61j
		call	_errno
		mov	dword ptr [eax], 8
		add	esp, 4
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_442D85:				; CODE XREF: .text:00442D56j
		call	_errno
		mov	dword ptr [eax], 0Dh
		add	esp, 4
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_442DA0	proc near		; CODE XREF: sub_442EA0+17p
					; .text:00442F07p

lpTimeZoneInformation= dword ptr -0DCh
var_D8		= dword	ptr -0D8h
var_D4		= dword	ptr -0D4h
var_D0		= dword	ptr -0D0h
TimeZoneInformation= _TIME_ZONE_INFORMATION ptr	-0C0h
SystemTimeAsFileTime= _FILETIME	ptr -14h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 0DCh
		mov	[esp+0DCh+var_8], esi
		mov	esi, [esp+0DCh+arg_4]
		mov	[esp+0DCh+var_C], ebx
		mov	ebx, [esp+0DCh+arg_0]
		mov	[esp+0DCh+var_4], edi
		test	esi, esi
		jz	short loc_442DF8
		lea	eax, [esp+0DCh+TimeZoneInformation]
		mov	[esp+0DCh+lpTimeZoneInformation], eax ;	lpTimeZoneInformation
		call	ds:GetTimeZoneInformation
		sub	esp, 4
		cmp	eax, 0FFFFFFFFh
		jz	loc_442E87
		mov	edx, [esp+0DCh+TimeZoneInformation.Bias]
		cmp	eax, 2
		setz	al
		movzx	eax, al
		mov	[esi+4], eax
		mov	[esi], edx

loc_442DF8:				; CODE XREF: sub_442DA0+2Bj
					; sub_442DA0+F4j
		test	ebx, ebx
		jz	short loc_442E69
		lea	eax, [esp+0DCh+SystemTimeAsFileTime]
		mov	[esp+0DCh+lpTimeZoneInformation], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	esi, [esp+0DCh+SystemTimeAsFileTime.dwLowDateTime]
		mov	edi, [esp+0DCh+SystemTimeAsFileTime.dwHighDateTime]
		mov	[esp+0DCh+var_D4], 989680h
		mov	[esp+0DCh+var_D0], 0
		add	esi, 2AC18000h
		adc	edi, 0FE624E21h
		mov	[esp+0DCh+lpTimeZoneInformation], esi
		mov	[esp+0DCh+var_D8], edi
		call	sub_4422B0
		mov	[ebx], eax
		mov	[esp+0DCh+var_D4], 989680h
		mov	[esp+0DCh+var_D0], 0
		mov	[esp+0DCh+lpTimeZoneInformation], esi
		mov	[esp+0DCh+var_D8], edi
		call	sub_442170
		imul	eax, 64h
		mov	[ebx+4], eax

loc_442E69:				; CODE XREF: sub_442DA0+5Aj
		xor	eax, eax
		mov	ebx, [esp+0DCh+var_C]
		mov	esi, [esp+0DCh+var_8]
		mov	edi, [esp+0DCh+var_4]
		add	esp, 0DCh
		retn
; ---------------------------------------------------------------------------

loc_442E87:				; CODE XREF: sub_442DA0+40j
		mov	dword ptr [esi], 0
		mov	dword ptr [esi+4], 0
		jmp	loc_442DF8
sub_442DA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_442EA0	proc near		; CODE XREF: sub_440780+AAp

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		sub	esp, 28h
		mov	eax, [esp+2Ch+arg_4]
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_28], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_2C], eax
		call	sub_442DA0
		mov	edx, 0FFFFFFFFh
		test	eax, eax
		jnz	short loc_442EE5
		mov	eax, [esp+2Ch+var_14]
		mov	edx, 10624DD3h
		mov	ecx, [esp+2Ch+var_10]
		mov	[ebx], eax
		mov	eax, ecx
		imul	edx
		sar	ecx, 1Fh
		sar	edx, 6
		sub	edx, ecx
		mov	[ebx+4], edx
		xor	edx, edx

loc_442EE5:				; CODE XREF: sub_442EA0+23j
		add	esp, 28h
		mov	eax, edx
		pop	ebx
		retn
sub_442EA0	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 28h
		mov	eax, [esp+34h]
		mov	ebx, [esp+30h]
		mov	[esp+4], eax
		lea	eax, [esp+18h]
		mov	[esp], eax
		call	sub_442DA0
		mov	edx, 0FFFFFFFFh
		test	eax, eax
		jnz	short loc_442F35
		mov	eax, [esp+18h]
		mov	edx, 10624DD3h
		mov	ecx, [esp+1Ch]
		mov	[ebx], eax
		mov	eax, ecx
		imul	edx
		sar	ecx, 1Fh
		sar	edx, 6
		sub	edx, ecx
		mov	[ebx+4], edx
		xor	edx, edx

loc_442F35:				; CODE XREF: .text:00442F13j
		add	esp, 28h
		mov	eax, edx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_442F40	proc near		; CODE XREF: sub_442720j
		mov	eax, ds:time
		jmp	eax
sub_442F40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_442F50	proc near		; CODE XREF: sub_442730j
		mov	eax, ds:gmtime
		jmp	eax
sub_442F50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_442F60	proc near		; CODE XREF: sub_442740j
		mov	eax, ds:mktime
		jmp	eax
sub_442F60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_442F70	proc near		; CODE XREF: sub_442750j
		mov	eax, ds:localtime
		jmp	eax
sub_442F70	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __getmainargs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __set_app_type]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _cexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _errno]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION atoi]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION remove]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strrchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION getenv]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fopen]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strerror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fclose]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION printf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fflush]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strstr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strtoul]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION sprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memset]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memmove]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strtol]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION sscanf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION memcmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION putc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcspn]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION realloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strftime]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strpbrk]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION rewind]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION getc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fread]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ferror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fseek]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ftell]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memchr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION clearerr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncpy]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fputs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION setvbuf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION putchar]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION puts]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcat]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION signal]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __setusermatherr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION raise]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _lseeki64]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _fileno_0]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _write_0]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fsetpos]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fgetpos]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _filelengthi64]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __doserrno]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4431B0	proc near		; DATA XREF: .text:004431D4o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4014F0
		mov	[esp+18h+var_18], offset sub_401540 ; _onexit_t
		call	sub_441160
		leave
		retn
sub_4431B0	endp

; ---------------------------------------------------------------------------
		align 10h
dword_4431D0	dd 0FFFFFFFFh		; DATA XREF: sub_441D80-4Cr
					; sub_441D80:loc_441D43r ...
		dd offset sub_4431B0
		dd 0
		dd 0FFFFFFFFh
dword_4431E0	dd 8 dup(0)		; DATA XREF: .data:off_444C50o
		dd 380h	dup(?)
_text		ends

; Section 2. (virtual address 00044000)
; Virtual size			: 00000C68 (   3176.)
; Section size in file		: 00000E00 (   3584.)
; Offset to raw	data for section: 00042600
; Flags	C0600040: Data Readable	Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 444000h
dword_444000	dd 1F5h, 445044h, 80h, 445051h,	1F6h, 445053h, 80h, 445051h
					; DATA XREF: sub_401C11:loc_401F46o
					; sub_401C11:loc_402520o
		dd 12Dh, 2 dup(0)
		dd offset a@options	; "@Options:\n "
		dd 205h, 44506Ch, 0
		dd offset aRunInServerMod ; "run in server mode	(foreground)"
		dd 206h, 445094h, 0
		dd offset aRunInMultiServ ; "run in multi server mode (foreground)"
		dd 207h, 4450CAh, 0
		dd offset aRunInDaemonMod ; "run in daemon mode	(background)"
		dd 76h,	4450F4h, 0
		dd offset aVerbose	; "verbose"
		dd 71h,	4450FCh, 0
		dd offset aBeSomewhatMore ; "be	somewhat more quiet"
		dd 73h,	445119h, 0
		dd offset aShStyleCommand ; "sh-style command output"
		dd 63h,	445134h, 0
		dd offset aCshStyleComman ; "csh-style command output"
		dd 1F7h, 445151h, 2, 445159h, 1F8h, 445176h, 14h, 445051h
		dd 1F9h, 44517Ch, 0
		dd offset a@		; "@"
		dd 1FAh, 445186h, 2, 445194h, 1FBh, 4451BCh, 1,	445051h
		dd 1FCh, 4451C7h, 0
		dd offset a@		; "@"
		dd 1FDh, 4451DDh, 0
		dd offset a@		; "@"
		dd 214h, 4451EFh, 0
		dd offset a@		; "@"
		dd 1FEh, 445204h, 0
		dd offset a@		; "@"
		dd 202h, 445212h, 0
		dd offset aDoNotDetachFro ; "do	not detach from	the console"
		dd 204h, 44523Bh, 2, 445244h, 209h, 44525Eh, 2,	44526Ch
		dd 20Bh, 44528Bh, 2, 445298h, 20Ch, 4452B8h, 2,	4452C4h
		dd 20Dh, 4452E3h, 0
		dd offset a@		; "@"
		dd 20Ah, 4452F0h, 4, 445300h, 20Fh, 445335h, 0
		dd offset aDoNotUseAReade ; "do	not use	a reader's pinpad"
		dd 12Ch, 445361h, 40h, 445051h,	210h, 445370h, 0
		dd offset a@		; "@"
		dd 211h, 44537Ch, 0
		dd offset aDenyTheUseOfAd ; "deny the use of admin card	commands"
		dd 212h, 4453ACh, 2, 445051h, 213h, 4453C0h, 0
		dd offset aUseVariableLen ; "use variable length input for pinpad"
		dd 4 dup(0)
dword_444210	dd 1			; DATA XREF: sub_40165C+8r
					; sub_40165C+2Dw ...
		align 10h
dword_444220	dd 2, 4015A7h, 440C80h,	440C88h, 4015BAh, 4015DBh, 4015FCh
					; DATA XREF: sub_401C11+1ABo
		dd 401615h, 440C90h, 40162Eh, 440C98h, 440CA0h,	440CA8h
		dd 3 dup(0)
off_444260	dd offset aSerialno	; DATA XREF: sub_406C20+1Co
					; sub_406C20+30o ...
					; "SERIALNO"
		dd offset sub_4040C4
		dd offset aSerialnoApptyp ; "SERIALNO [<apptype>]\n\nReturn the	seri"...
		dd offset aLearn	; "LEARN"
		dd offset sub_404250
		dd offset aLearnForceKeyp ; "LEARN [--force] [--keypairinfo]\n\nLear"...
		dd offset aReadcert	; "READCERT"
		dd offset sub_4044A9
		dd offset aReadcertHexifi ; "READCERT <hexified_certid>|<keyid>\n\nN"...
		dd offset aReadkey	; "READKEY"
		dd offset sub_4045E3
		dd offset aReadkeyKeyidRe ; "READKEY <keyid>\n\nReturn the public ke"...
		dd offset aSetdata	; "SETDATA"
		dd offset sub_404879
		dd offset aSetdataAppendH ; "SETDATA [--append]	<hexstring>\n\nThe c"...
		dd offset aPksign	; "PKSIGN"
		dd offset sub_404D51
		dd offset aPksignHashRmd1 ; "PKSIGN [--hash=[rmd160|sha{1,224,256,38"...
		dd offset aPkauth	; "PKAUTH"
		dd offset sub_40505B
		dd offset aPkauthHexified ; "PKAUTH <hexified_id>"
		dd offset aPkdecrypt	; "PKDECRYPT"
		dd offset sub_405234
		dd offset aPkdecryptHexif ; "PKDECRYPT <hexified_id>"
		dd offset aInput	; "INPUT"
		dd 2 dup(0)
		dd offset aOutput	; "OUTPUT"
		dd 2 dup(0)
		dd offset aGetattr	; "GETATTR"
		dd offset sub_4053F2
		dd offset aGetattrNameThi ; "GETATTR <name>\n\nThis command is used "...
		dd offset aSetattr	; "SETATTR"
		dd offset sub_4054EA
		dd offset aSetattrNameVal ; "SETATTR <name> <value> \n\nThis command"...
		dd offset aWritecert	; "WRITECERT"
		dd offset sub_4056BA
		dd offset aWritecertHexif ; "WRITECERT <hexified_certid>\n\nThis com"...
		dd offset aWritekey	; "WRITEKEY"
		dd offset sub_4058EA
		dd offset aWritekeyForceK ; "WRITEKEY [--force]	<keyid>	\n\nThis com"...
		dd offset aGenkey	; "GENKEY"
		dd offset sub_405B59
		dd offset aGenkeyForceTim ; "GENKEY [--force] [--timestamp=<isodate>"...
		dd offset aRandom	; "RANDOM"
		dd offset sub_405DEA
		dd offset aRandomNbytesGe ; "RANDOM <nbytes>\n\nGet NBYTES of random"...
		dd offset aPasswd	; "PASSWD"
		dd offset sub_405F6A
		dd offset aPasswdResetNul ; "PASSWD [--reset] [--nullpin] <chvno>\n\"...
		dd offset aCheckpin	; "CHECKPIN"
		dd offset sub_4061A1
		dd offset aCheckpinIdstrP ; "CHECKPIN <idstr>\n\nPerform a VERIFY op"...
		dd offset aLock		; "LOCK"
		dd offset sub_40631D
		dd offset aLockWaitGrantE ; "LOCK [--wait]\n\nGrant exclusive card a"...
		dd offset aUnlock	; "UNLOCK"
		dd offset sub_4063C4
		dd offset aUnlockReleaseE ; "UNLOCK\n\nRelease exclusive card access"...
		dd offset aGetinfo	; "GETINFO"
		dd offset sub_406449
		dd offset aGetinfoWhatMul ; "GETINFO <what>\n\nMulti purpose command"...
		dd offset aRestart	; "RESTART"
		dd offset sub_406840
		dd offset aRestartRestart ; "RESTART\n\nRestart	the current connecti"...
		dd offset aDisconnect	; "DISCONNECT"
		dd offset sub_4068AB
		dd offset aDisconnectDisc ; "DISCONNECT\n\nDisconnect the card if it"...
		dd offset aApdu		; "APDU"
		dd offset sub_4068D3
		dd offset aApduAtrMoreExl ; "APDU [--atr] [--more] [--exlen[=N]] [he"...
		dd offset aKillscd	; "KILLSCD"
		dd offset sub_406BF1
		dd offset aKillscdCommitS ; "KILLSCD\n\nCommit suicide."
		align 20h
dword_4443A0	dd 5Eh,	2 dup(0)	; DATA XREF: sub_4102D7+16Eo
					; sub_4102D7+187o ...
		dd 1
off_4443B0	dd offset aLoginData_0	; DATA XREF: sub_410B09+A0o
					; sub_410B09+EDo ...
					; "Login Data"
		dd 5F50h, 3 dup(0)
		dd offset aUrl		; "URL"
		dd 5F52h, 2 dup(0)
		dd 1, 44A4A7h, 65h, 1, 0
		dd 1, 44A4B8h, 5Bh, 0
		dd 65h,	0
		dd offset aName		; "Name"
		dd 5F2Dh, 0
		dd 65h,	0
		dd offset aLanguagePrefer ; "Language preferences"
		dd 5F35h, 0
		dd 65h,	0
		dd offset aSex		; "Sex"
		dd 6Eh,	1, 0
		dd 1, 44A4EEh, 4Fh, 0
		dd 6Eh,	1, 44A507h, 73h, 1, 0
		dd 1, 44A50Bh, 47h, 0
		dd 6Eh,	3, 44A526h, 0C0h, 0
		dd 6Eh,	3, 44A538h, 0C1h, 0
		dd 6Eh,	3, 44A554h, 0C2h, 0
		dd 6Eh,	3, 44A574h, 0C3h, 0
		dd 6Eh,	3, 44A594h, 0C4h, 0
		dd 6Eh,	0Dh, 44A5B8h, 0C5h, 0
		dd 6Eh,	1, 44A5C9h, 0C6h, 0
		dd 6Eh,	1, 44A5D6h, 0CDh, 0
		dd 6Eh,	1, 44A5E6h, 7Ah, 1, 0
		dd 1, 44A5F6h, 93h, 0
		dd 7Ah,	3, 44A610h, 101h, 3 dup(0)
		dd offset aPrivateDo1_0	; "Private DO 1"
		dd 102h, 3 dup(0)
		dd offset aPrivateDo2_0	; "Private DO 2"
		dd 103h, 3 dup(0)
		dd offset aPrivateDo3_0	; "Private DO 3"
		dd 104h, 3 dup(0)
		dd offset aPrivateDo4_0	; "Private DO 4"
		dd 7F21h, 1, 0
		dd 11h,	44A65Eh, 5 dup(0)
dword_4445BC	dd 9302130h		; DATA XREF: sub_4170F2+59o
					; sub_4170F2:loc_4175DCr
dword_4445C0	dd 0E2B0506h		; DATA XREF: sub_4170F2+4F5r
dword_4445C4	dd 51A0203h		; DATA XREF: sub_4170F2+500r
word_4445C8	dw 400h			; DATA XREF: sub_4170F2+50Br
byte_4445CA	db 14h			; DATA XREF: sub_4170F2+519r
dword_4445CB	dd 9302130h		; DATA XREF: sub_4170F2+91o
					; sub_4170F2:loc_417671r
dword_4445CF	dd 242B0506h		; DATA XREF: sub_4170F2+58Ar
dword_4445D3	dd 5010203h		; DATA XREF: sub_4170F2+595r
word_4445D7	dw 400h			; DATA XREF: sub_4170F2+5A0r
byte_4445D9	db 14h			; DATA XREF: sub_4170F2+5AEr
dword_4445DA	dd 0D302D30h		; DATA XREF: sub_4170F2+DAo
					; sub_4170F2:loc_41771Br
dword_4445DE	dd 86600906h		; DATA XREF: sub_4170F2+634r
dword_4445E2	dd 3650148h		; DATA XREF: sub_4170F2+63Fr
dword_4445E6	dd 5040204h		; DATA XREF: sub_4170F2+64Ar
word_4445EA	dw 400h			; DATA XREF: sub_4170F2+655r
byte_4445EC	db 1Ch			; DATA XREF: sub_4170F2+660r
dword_4445ED	dd 0D303130h		; DATA XREF: sub_4170F2+123o
					; sub_4170F2:loc_4177CAr
dword_4445F1	dd 86600906h		; DATA XREF: sub_4170F2+6E3r
dword_4445F5	dd 3650148h		; DATA XREF: sub_4170F2+6EEr
dword_4445F9	dd 5010204h		; DATA XREF: sub_4170F2+6F9r
word_4445FD	dw 400h			; DATA XREF: sub_4170F2+704r
byte_4445FF	db 20h			; DATA XREF: sub_4170F2+70Fr
dword_444600	dd 0D304130h		; DATA XREF: sub_4170F2+16Co
					; sub_4170F2:loc_417879r
dword_444604	dd 86600906h		; DATA XREF: sub_4170F2+792r
dword_444608	dd 3650148h		; DATA XREF: sub_4170F2+79Dr
dword_44460C	dd 5020204h		; DATA XREF: sub_4170F2+7A8r
word_444610	dw 400h			; DATA XREF: sub_4170F2+7B3r
byte_444612	db 30h			; DATA XREF: sub_4170F2+7BEr
dword_444613	dd 0D305130h		; DATA XREF: sub_4170F2+1B5o
					; sub_4170F2:loc_417928r
dword_444617	dd 86600906h		; DATA XREF: sub_4170F2+841r
dword_44461B	dd 3650148h		; DATA XREF: sub_4170F2+84Cr
dword_44461F	dd 5030204h		; DATA XREF: sub_4170F2+857r
word_444623	dw 400h			; DATA XREF: sub_4170F2+862r
byte_444625	db 40h			; DATA XREF: sub_4170F2+86Dr
		align 20h
off_444640	dd offset aDispName	; DATA XREF: sub_413C94+20o
					; sub_413C94+38o ...
					; "DISP-NAME"
		dd 5Bh,	3, 0
dword_444650	dd 0			; DATA XREF: sub_413C94+88o
		dd offset aLoginData	; "LOGIN-DATA"
		dd 5Eh,	3, 2, 0
		dd offset aDispLang	; "DISP-LANG"
		dd 5F2Dh, 3, 2 dup(0)
		dd offset aDispSex	; "DISP-SEX"
		dd 5F35h, 3, 2 dup(0)
		dd offset aPubkeyUrl	; "PUBKEY-URL"
		dd 5F50h, 3, 2 dup(0)
		dd offset aChvStatus1	; "CHV-STATUS-1"
		dd 0C4h, 3, 1, 0
		dd offset aCaFpr1	; "CA-FPR-1"
		dd 0CAh, 3, 2 dup(0)
		dd offset aCaFpr2	; "CA-FPR-2"
		dd 0CBh, 3, 2 dup(0)
		dd offset aCaFpr3	; "CA-FPR-3"
		dd 0CCh, 3, 2 dup(0)
		dd offset aPrivateDo1	; "PRIVATE-DO-1"
		dd 101h, 2, 2 dup(0)
		dd offset aPrivateDo2	; "PRIVATE-DO-2"
		dd 102h, 3, 2 dup(0)
		dd offset aPrivateDo3	; "PRIVATE-DO-3"
		dd 103h, 2, 2 dup(0)
		dd offset aPrivateDo4	; "PRIVATE-DO-4"
		dd 104h, 3, 2 dup(0)
		dd offset aCert3	; "CERT-3"
		dd 7F21h, 3, 0
		dd 1, 44B681h, 0D1h, 3,	0
		dd 1, 44B68Ch, 0D2h, 3,	0
		dd 1, 44B697h, 2 dup(0)
		dd 3, 1, 0Bh dup(0)
off_4447C0	dd offset aDispName	; DATA XREF: sub_41199B+25o
					; sub_41199B+3Co ...
					; "DISP-NAME"
		dd 5Bh,	0
		dd offset aLoginData	; "LOGIN-DATA"
		dd 5Eh,	0
		dd offset aDispLang	; "DISP-LANG"
		dd 5F2Dh, 0
		dd offset aDispSex	; "DISP-SEX"
		dd 5F35h, 0
		dd offset aPubkeyUrl	; "PUBKEY-URL"
		dd 5F50h, 0
		dd offset aKeyFpr	; "KEY-FPR"
		dd 0C5h, 3, 44AA41h, 0CDh, 4, 44B697h, 0
		dd 0FFFFFFFBh, 44AA4Ah,	0C6h, 3, 44AA51h, 0C4h,	1, 44AA5Ch
		dd 93h,	2, 44A7DEh, 4Fh, 0FFFFFFFFh, 44A507h, 4Fh, 0
		dd offset aExtcap	; "EXTCAP"
		dd 0
		dd 0FFFFFFFEh, 44AA68h,	101h, 0
		dd offset aPrivateDo2	; "PRIVATE-DO-2"
		dd 102h, 0
		dd offset aPrivateDo3	; "PRIVATE-DO-3"
		dd 103h, 0
		dd offset aPrivateDo4	; "PRIVATE-DO-4"
		dd 104h, 0
		dd offset aAuthkeyid_1	; "$AUTHKEYID"
		align 10h
		dd 0FFFFFFFDh, 44B6ABh,	0
		dd 0FFFFFFFCh, 4 dup(0)
dword_4448C0	dd 0			; DATA XREF: sub_419DB2+49o
					; sub_419DB2+67o ...
		dd 4531h, 2 dup(0)
dword_4448D0	dd 0C000h, 1, 0		; DATA XREF: sub_419DB2+1D5o
					; sub_41A15B+39Bo ...
		dd 80h,	0
		dd 0C000h, 0
		dd 65h,	5 dup(0)
		dd 4331h, 0
		dd 64h,	5 dup(0)
		dd 4332h, 0
dword_44492C	dd 64h,	5 dup(0)
		dd 0B000h, 0
		dd 6Eh,	5 dup(0)
		dd 45B1h, 2 dup(0)
		dd 0C200h, 0
		dd 1, 81h, 0
		dd 0C200h, 0
		dd 65h,	5 dup(0)
		dd 43B1h, 0
		dd 64h,	5 dup(0)
		dd 43B2h, 0
		dd 64h,	5 dup(0)
		dd 45B2h, 3, 0
		dd 0C201h, 0
		dd 1, 83h, 0
		dd 0C201h, 3, 65h, 4 dup(0)
		dd 1, 4531h, 3,	0
		dd 0C000h, 2 dup(1), 84h, 1, 0C000h, 0
		dd 65h,	4 dup(0)
		dd 1, 0C008h, 3, 65h, 4	dup(0)
		dd 1, 0C00Eh, 3, 6Fh, 0Ch dup(0)
dword_444AC0	dd 9302130h		; DATA XREF: sub_41AEE6+502o
					; sub_41AEE6+584r
dword_444AC4	dd 0E2B0506h		; DATA XREF: sub_41AEE6+58Cr
dword_444AC8	dd 51A0203h		; DATA XREF: sub_41AEE6+594r
word_444ACC	dw 400h			; DATA XREF: sub_41AEE6+59Cr
byte_444ACE	db 14h			; DATA XREF: sub_41AEE6+5A7r
dword_444ACF	dd 9302130h		; DATA XREF: sub_41AEE6+527o
					; sub_41AEE6+5B9r
dword_444AD3	dd 242B0506h		; DATA XREF: sub_41AEE6+5C1r
dword_444AD7	dd 5010203h		; DATA XREF: sub_41AEE6+5C9r
word_444ADB	dw 400h			; DATA XREF: sub_41AEE6+5D1r
byte_444ADD	db 14h			; DATA XREF: sub_41AEE6+5DCr
		align 10h
; char *Str1
Str1		dd offset aAuthkeyid_0	; DATA XREF: sub_419AE2+46r
					; sub_419AE2+54r ...
					; "$AUTHKEYID"
dword_444AE4	dd 1			; DATA XREF: sub_419AE2+90r
		dd offset aNksVersion	; "NKS-VERSION"
		dd 2, 44BE03h, 3, 2 dup(0)
dword_444B00	dd 9302130h, 0E2B0506h,	51A0203h ; DATA	XREF: sub_41D35C+363o
					; sub_41D35C+476o
		db 0, 4, 14h
byte_444B0F	db 30h			; DATA XREF: sub_41D35C+388o
					; sub_41D35C+499o
		dd 6093021h, 3242B05h, 50102h
		db 4, 14h
word_444B1E	dw 3130h		; DATA XREF: sub_41D35C+3ECo
					; sub_41D35C+411o ...
		dd 9060D30h, 1488660h, 2040365h, 4000501h, 20h,	3 dup(0)
dword_444B40	dd 13h,	44C0A0h, 1, 13h, 44C0B4h, 1, 13h, 44C0C8h, 1, 1Bh
					; DATA XREF: sub_4245B2+190o
					; sub_4245B2+1ADo ...
		dd 44C0DCh, 2, 13h, 44C0F8h, 2,	1Ah, 44C10Ch, 2, 3 dup(0)
dword_444B94	dd 9302130h		; DATA XREF: sub_42371E+8DBo
					; sub_42371E+94Cr
dword_444B98	dd 0E2B0506h		; DATA XREF: sub_42371E+954r
dword_444B9C	dd 51A0203h		; DATA XREF: sub_42371E+95Cr
word_444BA0	dw 400h			; DATA XREF: sub_42371E+964r
byte_444BA2	db 14h			; DATA XREF: sub_42371E+96Fr
dword_444BA3	dd 9302130h		; DATA XREF: sub_42371E+900o
					; sub_42371E+981r
dword_444BA7	dd 242B0506h		; DATA XREF: sub_42371E+989r
dword_444BAB	dd 5010203h		; DATA XREF: sub_42371E+991r
word_444BAF	dw 400h			; DATA XREF: sub_42371E+999r
byte_444BB1	db 14h			; DATA XREF: sub_42371E+9A4r
		align 10h
off_444BC0	dd offset aXKblz	; DATA XREF: sub_424FA1+19r
					; sub_424FA1+40r
					; "X-KBLZ"
		dd offset aXBankinfo	; "X-BANKINFO"
		dd offset aXCardno	; "X-CARDNO"
		dd offset aXExpires	; "X-EXPIRES"
		dd offset aXValidfrom	; "X-VALIDFROM"
		dd offset aXCountry	; "X-COUNTRY"
		dd offset aXCurrency	; "X-CURRENCY"
		dd offset aXZkachipid	; "X-ZKACHIPID"
		dd offset aXOsversion	; "X-OSVERSION"
		dd offset aXBalance	; "X-BALANCE"
		dd offset aXMaxamount	; "X-MAXAMOUNT"
		dd offset aXMaxamount1	; "X-MAXAMOUNT1"
		align 20h
; LPCSTR off_444C00
off_444C00	dd offset aShell32_dll	; DATA XREF: sub_4263DD+30r
					; sub_4263DD+90r
					; "shell32.dll"
		dd offset aShfolder_dll	; "shfolder.dll"
		dd 0
off_444C0C	dd offset sub_42F16E	; DATA XREF: sub_430E4D+8Er
					; .text:004316C8r ...
off_444C10	dd offset sub_42F1EE	; DATA XREF: sub_430E4D+98r
					; .text:004316D2r ...
off_444C14	dd offset sub_42F472	; DATA XREF: sub_430E4D+A2r
					; .text:004316DCr ...
off_444C18	dd offset sub_42F6F7	; DATA XREF: sub_430E4D+ACr
					; .text:004316E6r ...
off_444C1C	dd offset sub_42F794	; DATA XREF: .text:0043158Dr
					; sub_4319B3+7Br ...
off_444C20	dd offset sub_42F7FF	; DATA XREF: .text:00431597r
					; sub_4319B3+85r ...
off_444C24	dd offset sub_42F869	; DATA XREF: .text:004315A1r
					; sub_4319B3+8Fr ...
off_444C28	dd offset sub_42F8FB	; DATA XREF: .text:004315ABr
					; .text:0043160Dr ...
off_444C2C	dd offset sub_42F9CA	; DATA XREF: sub_431AE8+A5r
off_444C30	dd offset sub_42FA31	; DATA XREF: sub_431AE8+AFr
off_444C34	dd offset sub_42FA88	; DATA XREF: sub_431AE8+B9r
off_444C38	dd offset sub_42FB12	; DATA XREF: sub_431AE8+C3r
					; sub_431AE8+F5r
dword_444C3C	dd 0FFFFFFFFh		; DATA XREF: sub_43C309:loc_43C48Fw
					; .text:loc_43C6C3r ...
; char off_444C40[]
off_444C40	dd offset aIso88591	; DATA XREF: sub_43F21C+D9w
					; sub_43F31B:loc_43F4F0w ...
					; "iso-8859-1"
		dd 0FFh, 2 dup(0FFFFFFFFh)
off_444C50	dd offset dword_4431E0	; DATA XREF: sub_441D00+3r
					; sub_441D00+12r ...
dword_444C54	dd 2			; DATA XREF: TlsCallback_0+13r
					; TlsCallback_0+1Cw ...
dword_444C58	dd 0FFFFFFFFh		; DATA XREF: sub_401060+7Ar
dword_444C5C	dd 0BB40E64Eh		; DATA XREF: sub_441DA0+3r
					; sub_441DA0:loc_441E52w ...
dword_444C60	dd 44BF19B1h		; DATA XREF: sub_441DA0+31w
					; sub_441DA0+B8w ...
dword_444C64	dd 0			; DATA XREF: sub_4014F0+6r
					; sub_4014F0+42o
		align 400h
_data		ends

; Section 3. (virtual address 00045000)
; Virtual size			: 0000B140 (  45376.)
; Section size in file		: 0000B200 (  45568.)
; Offset to raw	data for section: 00043400
; Flags	40600040: Data Readable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment '32byte' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 445000h
; CHAR ProcName[]
ProcName	db '_set_invalid_parameter_handler',0 ; DATA XREF: sub_401180+137o
		align 10h
; CHAR ModuleName[]
ModuleName	db 'libgcj-12.dll',0    ; DATA XREF: sub_4014F0+Fo
; CHAR a_jv_registercl[]
a_jv_registercl	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_4014F0+28o
		align 4
aGpgconfList	db 'gpgconf-list',0
a@		db '@',0                ; DATA XREF: .data:004440CCo
					; .data:004440FCo ...
aGpgconfTest	db 'gpgconf-test',0
a@options	db '@Options:',0Ah      ; DATA XREF: .data:0044402Co
		db ' ',0
aServer		db 'server',0
		align 4
aRunInServerMod	db 'run in server mode (foreground)',0 ; DATA XREF: .data:0044403Co
aMultiServer	db 'multi-server',0
		align 4
aRunInMultiServ	db 'run in multi server mode (foreground)',0 ; DATA XREF: .data:0044404Co
aDaemon		db 'daemon',0
		align 4
aRunInDaemonMod	db 'run in daemon mode (background)',0 ; DATA XREF: .data:0044405Co
aVerbose	db 'verbose',0          ; DATA XREF: .data:0044406Co
aQuiet		db 'quiet',0
aBeSomewhatMore	db 'be somewhat more quiet',0 ; DATA XREF: .data:0044407Co
aSh		db 'sh',0
aShStyleCommand	db 'sh-style command output',0 ; DATA XREF: .data:0044408Co
aCsh		db 'csh',0              ; DATA XREF: sub_401C11+26Do
aCshStyleComman	db 'csh-style command output',0 ; DATA XREF: .data:0044409Co
aOptions_0	db 'options',0
aFileReadOption	db '|FILE|read options from FILE',0
aDebug		db 'debug',0
aDebugAll	db 'debug-all',0
aDebugLevel	db 'debug-level',0
		align 4
aLevelSetTheDeb	db '|LEVEL|set the debugging level to LEVEL',0
aDebugWait	db 'debug-wait',0
aDebugAllowCore	db 'debug-allow-core-dump',0
aDebugCcidDrive	db 'debug-ccid-driver',0
aDebugDisableTi	db 'debug-disable-ticker',0
aDebugLogTid	db 'debug-log-tid',0
aNoDetach	db 'no-detach',0
aDoNotDetachFro	db 'do not detach from the console',0 ; DATA XREF: .data:0044413Co
aLogFile	db 'log-file',0
aFileWriteALogT	db '|FILE|write a log to FILE',0
aReaderPort_0	db 'reader-port',0
		align 4
aNConnectToRead	db '|N|connect to reader at port N',0
aCtapiDriver	db 'ctapi-driver',0
aNameUseNameAsC	db '|NAME|use NAME as ct-API driver',0
aPcscDriver	db 'pcsc-driver',0
aNameUseNameAsP	db '|NAME|use NAME as PC/SC driver',0
aDisableCcid	db 'disable-ccid',0
aCardTimeout	db 'card-timeout',0
		align 10h
aNDisconnectThe	db '|N|disconnect the card after N seconds of inactivity',0
aDisablePinpad	db 'disable-pinpad',0
aDoNotUseAReade	db 'do not use a reader',27h,'s pinpad',0 ; DATA XREF: .data:004441ACo
aDisableKeypad	db 'disable-keypad',0
aAllowAdmin	db 'allow-admin',0
aDenyAdmin	db 'deny-admin',0
		align 4
aDenyTheUseOfAd	db 'deny the use of admin card commands',0 ; DATA XREF: .data:004441DCo
aDisableApplica	db 'disable-application',0
aEnablePinpad_0	db 'enable-pinpad-varlen',0
		align 4
aUseVariableLen	db 'use variable length input for pinpad',0 ; DATA XREF: .data:004441FCo
aScdaemonGnupg	db 'scdaemon (GnuPG)',0 ; DATA XREF: sub_401723:loc_401742o
a2_0_30		db '2.0.30',0           ; DATA XREF: sub_401723:loc_40174Eo
aMingw32	db 'MingW32',0          ; DATA XREF: sub_401723:loc_40175Ao
		align 10h
; char aPleaseReportBu[]
aPleaseReportBu	db 'Please report bugs to <@EMAIL@>.',0Ah,0
					; DATA XREF: sub_401723:loc_401766o
aLibgcrypt	db 'libgcrypt',0        ; DATA XREF: sub_401723+68o
					; sub_401C11+13Bo
aLibksba	db 'libksba',0          ; DATA XREF: sub_401723+94o
; char aUsageScdaemonO[]
aUsageScdaemonO	db 'Usage: scdaemon [options] (-h for help)',0
					; DATA XREF: sub_401723:loc_4017D2o
; char aSyntaxScdaemon[]
aSyntaxScdaemon	db 'Syntax: scdaemon [options] [command [args]]',0Ah
					; DATA XREF: sub_401723:loc_4017E3o
		db 'Smartcard daemon for GnuPG',0Ah,0
off_4454C4	dd offset loc_4017F4	; DATA XREF: sub_401723+16o
		dd offset loc_4017D2	; jump table for switch	statement
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_401742
		dd offset loc_4017F4
		dd offset loc_40174E
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_40175A
		dd offset loc_4017F4
		dd offset loc_401766
		dd offset loc_40177A
		dd offset loc_4017A6
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017F4
		dd offset loc_4017D2
		dd offset loc_4017E3
aNone		db 'none',0             ; DATA XREF: sub_40180D+5Co
aBasic		db 'basic',0            ; DATA XREF: sub_40180D+9Fo
aAdvanced	db 'advanced',0         ; DATA XREF: sub_40180D+E2o
aExpert		db 'expert',0           ; DATA XREF: sub_40180D+125o
aGuru		db 'guru',0             ; DATA XREF: sub_40180D+165o
; char aInvalidDebugLe[]
aInvalidDebugLe	db 'invalid debug-level `%s',27h,' given',0Ah,0
					; DATA XREF: sub_40180D:loc_4019BAo
aCardio		db ' cardio',0          ; DATA XREF: sub_40180D+27Co
byte_4455B4	db 0			; DATA XREF: sub_40180D:loc_401A90o
					; sub_40180D:loc_401AAAo ...
aAssuan		db ' assuan',0          ; DATA XREF: sub_40180D+296o
aHashing	db ' hashing',0         ; DATA XREF: sub_40180D+2B0o
aMemstat	db ' memstat',0         ; DATA XREF: sub_40180D+2CEo
aCache		db ' cache',0           ; DATA XREF: sub_40180D+2EAo
aMemory		db ' memory',0          ; DATA XREF: sub_40180D+306o
aCrypto		db ' crypto',0          ; DATA XREF: sub_40180D+31Eo
aMpi		db ' mpi',0             ; DATA XREF: sub_40180D+336o
aCommand	db ' command',0         ; DATA XREF: sub_40180D+34Eo
; char aEnabledDebugFl[]
aEnabledDebugFl	db 'enabled debug flags:%s%s%s%s%s%s%s%s%s',0Ah,0
					; DATA XREF: sub_40180D+387o
; char aScdaemon[]
aScdaemon	db 'scdaemon',0         ; DATA XREF: sub_401C11+EFo
a1_5_0		db '1.5.0',0            ; DATA XREF: sub_401C11+105o
					; sub_401C11+133o
		align 4
; char aSIsTooOldNeedS[]
aSIsTooOldNeedS	db '%s is too old (need %s, have %s)',0Ah,0 ; DATA XREF: sub_401C11+123o
aWinscard_dll	db 'winscard.dll',0     ; DATA XREF: sub_401C11+1DCo
					; sub_401C11+BC6o
; char VarName[]
VarName		db 'SHELL',0            ; DATA XREF: sub_401C11+1F1o
aScdaemon_conf	db 'scdaemon.conf',0    ; DATA XREF: sub_401C11+38Ao
					; sub_401C11+AF7o
; char Mode[]
Mode		db 'r',0                ; DATA XREF: sub_401C11+3E1o
		align 4
; char aNoteNoDefaultO[]
aNoteNoDefaultO	db 'NOTE: no default option file `%s',27h,0Ah,0 ; DATA XREF: sub_401C11+422o
; char aOptionFileSS[]
aOptionFileSS	db 'option file `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_401C11+456o
; char aReadingOptions[]
aReadingOptions	db 'reading options from `%s',27h,0Ah,0 ; DATA XREF: sub_401C11+4B3o
; char Format[]
Format		db '%s %s; %s',0Ah,0    ; DATA XREF: sub_401C11+A08o
; char aS[]
aS		db '%s',0Ah,0           ; DATA XREF: sub_401C11+A3Ao
; char aAtexitFailed[]
aAtexitFailed	db 'atexit failed',0Ah,0 ; DATA XREF: sub_401C11+A68o
		align 4
; char aGpgconfScdaemo[]
aGpgconfScdaemo	db 'gpgconf-scdaemon.conf:%lu:"%s',0Ah,0 ; DATA XREF: sub_401C11+B2Co
		align 4
; char aVerboseLuQuiet[]
aVerboseLuQuiet	db 'verbose:%lu:',0Ah   ; DATA XREF: sub_401C11+B6Ao
		db 'quiet:%lu:',0Ah
		db 'debug-level:%lu:"none:',0Ah
		db 'log-file:%lu:',0Ah,0
; char aReaderPortLu[]
aReaderPortLu	db 'reader-port:%lu:',0Ah,0 ; DATA XREF: sub_401C11+B97o
; char aCtapiDriverLu[]
aCtapiDriverLu	db 'ctapi-driver:%lu:',0Ah,0 ; DATA XREF: sub_401C11+BACo
; char aPcscDriverLuS[]
aPcscDriverLuS	db 'pcsc-driver:%lu:"%s:',0Ah,0 ; DATA XREF: sub_401C11+BC1o
; char aDenyAdminLu[]
aDenyAdminLu	db 'deny-admin:%lu:',0Ah,0 ; DATA XREF: sub_401C11+BDEo
; char aDisablePinpadL[]
aDisablePinpadL	db 'disable-pinpad:%lu:',0Ah,0 ; DATA XREF: sub_401C11+BF3o
; char aCardTimeoutLuD[]
aCardTimeoutLuD	db 'card-timeout:%lu:%d:',0Ah,0 ; DATA XREF: sub_401C11+C08o
; char aEnablePinpadVa[]
aEnablePinpadVa	db 'enable-pinpad-varlen:%lu:',0Ah,0 ; DATA XREF: sub_401C11+C25o
; char aWaitingForDebu[]
aWaitingForDebu	db 'waiting for debugger - my pid is %u .....',0Ah,0
					; DATA XREF: sub_401C11+C8Fo
; char a___Okay[]
a___Okay	db '... okay',0Ah,0     ; DATA XREF: sub_401C11+CAAo
aTmp		db '/tmp',0             ; DATA XREF: sub_401C11+CD8o
; char aChdirToTmpFail[]
aChdirToTmpFail	db 'chdir to `/tmp',27h,' failed: %s',0Ah,0 ; DATA XREF: sub_401C11+CFDo
		align 10h
; char aChangedWorking[]
aChangedWorking	db 'changed working directory to `/tmp',27h,0Ah,0
					; DATA XREF: sub_401C11:loc_40291Co
aTmpGpgXxxxxxS_	db '/tmp/gpg-XXXXXX/S.scdaemon',0 ; DATA XREF: sub_401C11+D21o
					; sub_401C11:loc_402AE9o
aS_scdaemon	db 'S.scdaemon',0       ; DATA XREF: sub_401C11+D29o
					; sub_401C11+EE0o
aPipeConnection	db 'pipe-connection',0  ; DATA XREF: sub_401C11+DB6o
		align 4
; char aErrorAllocatin[]
aErrorAllocatin	db 'error allocating connection control data: %s',0Ah,0
					; DATA XREF: sub_401C11+E09o
					; sub_40316F+451o
		align 4
; char aErrorSpawningP[]
aErrorSpawningP	db 'error spawning pipe connection handler: %s',0Ah,0
					; DATA XREF: sub_401C11+E63o
; char aPleaseUseTheOp[]
aPleaseUseTheOp	db 'please use the option `--daemon',27h,' to run the program in the bac'
					; DATA XREF: sub_401C11+EC2o
		db 'kground',0Ah,0
		align 10h
; char aSignalDReceive[]
aSignalDReceive	db 'signal %d received - no action defined',0Ah,0 ; DATA XREF: sub_402BE8+Do
; char a____Gnupg22_0_[]
a____Gnupg22_0_	db '../../gnupg2-2.0.30/scd/scdaemon.c',0 ; DATA XREF: sub_402C19+6Co
					; sub_402D72+105o
		align 4
; char aCanTCreateDire[]
aCanTCreateDire	db 'can',27h,'t create directory `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_402C19+A0o
asc_44599D	db ';',0                ; DATA XREF: sub_402C19+E8o
		align 10h
; char aSAreNotAllowed[]
aSAreNotAllowed	db '`%s',27h,' are not allowed in the socket name',0Ah,0
					; DATA XREF: sub_402C19+F0o
; char aNameOfSocketTo[]
aNameOfSocketTo	db 'name of socket too long',0Ah,0 ; DATA XREF: sub_402C19+12Fo
; char aCanTCreateSock[]
aCanTCreateSock	db 'can',27h,'t create socket: %s',0Ah,0 ; DATA XREF: sub_402D72+41o
		align 4
; char aStrlenName1Siz[]
aStrlenName1Siz	db 'strlen (name) + 1 < sizeof (serv_addr->sun_path)',0
					; DATA XREF: sub_402D72+10Do
		align 10h
; char aErrorGettingNo[]
aErrorGettingNo	db 'error getting nonce for the socket',0Ah,0 ; DATA XREF: sub_402D72+1DDo
; char aErrorBindingSo[]
aErrorBindingSo	db 'error binding socket to `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_402D72+20Co
; char aListenFailedS[]
aListenFailedS	db 'listen() failed: %s',0Ah,0 ; DATA XREF: sub_402D72+26Bo
; char aListeningOnSoc[]
aListeningOnSoc	db 'listening on socket `%s',27h,0Ah,0 ; DATA XREF: sub_402D72+2A9o
		align 4
; char aErrorReadingNo[]
aErrorReadingNo	db 'error reading nonce on fd %d: %s',0Ah,0 ; DATA XREF: sub_40303E+4Bo
; char aHandlerForFdDS[]
aHandlerForFdDS	db 'handler for fd %d started',0Ah,0 ; DATA XREF: sub_40303E+A4o
; char aHandlerForFdDT[]
aHandlerForFdDT	db 'handler for fd %d terminated',0Ah,0 ; DATA XREF: sub_40303E+F7o
		align 4
; char aPth_selectFail[]
aPth_selectFail	db 'pth_select failed: %s - waiting 1s',0Ah,0 ; DATA XREF: sub_40316F+309o
; char aAcceptFailedS[]
aAcceptFailedS	db 'accept failed: %s',0Ah,0 ; DATA XREF: sub_40316F+40Eo
aConnFdD	db 'conn fd=%d',0       ; DATA XREF: sub_40316F+474o
		align 4
; char aErrorSpawningC[]
aErrorSpawningC	db 'error spawning connection handler: %s',0Ah,0
					; DATA XREF: sub_40316F+4F1o
; char aSSStopped[]
aSSStopped	db '%s %s stopped',0Ah,0 ; DATA XREF: sub_40316F+591o
aCreate_socket_	db 'create_socket_name',0 ; DATA XREF: sub_402C19+5Co
		align 10h
a____Gnupg22__0	db '../../gnupg2-2.0.30/scd/command.c',0 ; DATA XREF: sub_403BAA+33o
					; sub_406449+203o ...
		align 4
; char aImplicitlyUnlo[]
aImplicitlyUnlo	db 'implicitly unlocking due to RESET',0Ah,0 ; DATA XREF: sub_403BAA+16Bo
		align 4
; char aFailedToAcquir[]
aFailedToAcquir	db 'failed to acquire status_fle_update lock',0Ah,0
					; DATA XREF: sub_403BAA+197o
		align 4
; char aFailedToReleas[]
aFailedToReleas	db 'failed to release status_file_update lock',0Ah,0
					; DATA XREF: sub_403BAA+1DEo
					; sub_40772E+42o
aEventSignal	db 'event-signal',0     ; DATA XREF: sub_403DCE+1Co
		align 20h
aSerialnoApptyp	db 'SERIALNO [<apptype>]',0Ah ; DATA XREF: .data:00444268o
		db 0Ah
		db 'Return the serial number of the card using a status reponse.  Thi'
		db 's',0Ah
		db 'function should be used to check for the presence of a card.',0Ah
		db 0Ah
		db 'If APPTYPE is given, an application of that type is selected and '
		db 'an',0Ah
		db 'error is returned if the application is not supported or availabl'
		db 'e.',0Ah
		db 'The default is to auto-select the application using a hardwired',0Ah
		db 'preference system.  Note, that a future extension to this functio'
		db 'n',0Ah
		db 'may allow to specify a list and order of applications to try.',0Ah
		db 0Ah
		db 'This function is special in that it can be used to reset the card'
		db '.',0Ah
		db 'Most other functions will return an error when a card change has',0Ah
		db 'been detected and the use of this function is therefore required.'
		db 0Ah
		db 0Ah
		db 'Background: We want to keep the client clear of handling card',0Ah
		db 'changes between operations; i.e. the client can assume that all',0Ah
		db 'operations are done on the same card unless he calls this functio'
		db 'n.',0
aSLu		db '%s %lu',0           ; DATA XREF: sub_4040C4+12Bo
					; sub_404250+9Co
aSerialno	db 'SERIALNO',0         ; DATA XREF: sub_4040C4+167o
					; sub_404250+DBo ...
		align 10h
aLearnForceKeyp	db 'LEARN [--force] [--keypairinfo]',0Ah ; DATA XREF: .data:00444274o
		db 0Ah
		db 'Learn all useful information of the currently inserted card.  Whe'
		db 'n',0Ah
		db 'used without the force options, the command might do an INQUIRE',0Ah
		db 'like this:',0Ah
		db 0Ah
		db '   INQUIRE KNOWNCARDP <hexstring_with_serialNumber> <timestamp>',0Ah
		db 0Ah
		db 'The client should just send an "END" if the processing should go '
		db 'on',0Ah
		db 'or a "CANCEL" to force the function to terminate with a Cancel',0Ah
		db 'error message.',0Ah
		db 0Ah
		db 'With the option --keypairinfo only KEYPARIINFO lstatus lines are',0Ah
		db 'returned.',0Ah
		db 0Ah
		db 'The response of this command is a list of status lines formatted '
		db 'as',0Ah
		db 'this:',0Ah
		db 0Ah
		db '  S APPTYPE <apptype>',0Ah
		db 0Ah
		db 'This returns the type of the application, currently the strings:',0Ah
		db 0Ah
		db '    P15     = PKCS-15 structure used',0Ah
		db '    DINSIG  = DIN SIG',0Ah
		db '    OPENPGP = OpenPGP card',0Ah
		db '    NKS     = NetKey card',0Ah
		db 0Ah
		db 'are implemented.  These strings are aliases for the AID',0Ah
		db 0Ah
		db '  S KEYPAIRINFO <hexstring_with_keygrip> <hexstring_with_id>',0Ah
		db 0Ah
		db 'If there is no certificate yet stored on the card a single ',27h,'X',27h
		db ' is',0Ah
		db 'returned as the keygrip.  In addition to the keypair info, inform'
		db 'ation',0Ah
		db 'about all certificates stored on the card is also returned:',0Ah
		db 0Ah
		db '  S CERTINFO <certtype> <hexstring_with_id>',0Ah
		db 0Ah
		db 'Where CERTTYPE is a number indicating the type of certificate:',0Ah
		db '   0   := Unknown',0Ah
		db '   100 := Regular X.509 cert',0Ah
		db '   101 := Trusted X.509 cert',0Ah
		db '   102 := Useful X.509 cert',0Ah
		db '   110 := Root CA cert in a special format (e.g. DINSIG)',0Ah
		db '   111 := Root CA cert as standard X509 cert.',0Ah
		db 0Ah
		db 'For certain cards, more information will be returned:',0Ah
		db 0Ah
		db '  S KEY-FPR <no> <hexstring>',0Ah
		db 0Ah
		db 'For OpenPGP cards this returns the stored fingerprints of the',0Ah
		db 'keys. This can be used check whether a key is available on the',0Ah
		db 'card.  NO may be 1, 2 or 3.',0Ah
		db 0Ah
		db '  S CA-FPR <no> <hexstring>',0Ah
		db 0Ah
		db 'Similar to above, these are the fingerprints of keys assumed to b'
		db 'e',0Ah
		db 'ultimately trusted.',0Ah
		db 0Ah
		db '  S DISP-NAME <name_of_card_holder>',0Ah
		db 0Ah
		db 'The name of the card holder as stored on the card; percent',0Ah
		db 'escaping takes place, spaces are encoded as ',27h,'+',27h,0Ah
		db 0Ah
		db '  S PUBKEY-URL <url>',0Ah
		db 0Ah
		db 'The URL to be used for locating the entire public key.',0Ah
		db '  ',0Ah
		db 'Note, that this function may even be used on a locked card.',0
; char aKeypairinfo[]
aKeypairinfo	db '--keypairinfo',0    ; DATA XREF: sub_404250+1Bo
; char aForce[]
aForce		db '--force',0          ; DATA XREF: sub_404250+EEo
					; sub_4058EA+15o ...
aKnowncardpS	db 'KNOWNCARDP %s',0    ; DATA XREF: sub_404250+110o
		align 4
; char aInquireKnownca[]
aInquireKnownca	db 'inquire KNOWNCARDP failed: %s',0Ah,0 ; DATA XREF: sub_404250+1A7o
		align 20h
aReadcertHexifi	db 'READCERT <hexified_certid>|<keyid>',0Ah ; DATA XREF: .data:00444280o
		db 0Ah
		db 'Note, that this function may even be used on a locked card.',0
; char aApp_readcertFa[]
aApp_readcertFa	db 'app_readcert failed: %s',0Ah,0 ; DATA XREF: sub_4044A9+81o
					; sub_4045E3+126o
		align 10h
aReadkeyKeyidRe	db 'READKEY <keyid>',0Ah ; DATA XREF: .data:0044428Co
		db 0Ah
		db 'Return the public key for the given cert or key ID as a standard',0Ah
		db 'S-expression.',0Ah
		db 0Ah
		db 'Note, that this function may even be used on a locked card.',0
; char aApp_readkeyFai[]
aApp_readkeyFai	db 'app_readkey failed: %s',0Ah,0 ; DATA XREF: sub_4045E3+DDo
		align 4
; char aFailedToParseT[]
aFailedToParseT	db 'failed to parse the certificate: %s',0Ah,0 ; DATA XREF: sub_4045E3+197o
		align 10h
aSetdataAppendH	db 'SETDATA [--append] <hexstring>',0Ah ; DATA XREF: .data:00444298o
		db 0Ah
		db 'The client should use this command to tell us the data he want to'
		db ' sign.',0Ah
		db 'With the option --append, the data is appended to the data set by'
		db ' a',0Ah
		db 'previous SETDATA command.',0
; char aAppend[]
aAppend		db '--append',0         ; DATA XREF: sub_404879+1Eo
aInvalidHexstri	db 'invalid hexstring',0 ; DATA XREF: sub_404879+E4o
aNoDataGiven	db 'no data given',0    ; DATA XREF: sub_404879+112o
aOddNumberOfDig	db 'odd number of digits',0 ; DATA XREF: sub_404879+144o
aLimitOnTotalSi	db 'limit on total size of data reached',0 ; DATA XREF: sub_404879+191o
; char aPromptingForPi[]
aPromptingForPi	db 'prompting for pinpad entry ',27h,'%s',27h,0Ah,0
					; DATA XREF: sub_404B75+27o
aPopuppinpadpro	db 'POPUPPINPADPROMPT %s',0 ; DATA XREF: sub_404B75+3Ao
; char aDismissPinpadE[]
aDismissPinpadE	db 'dismiss pinpad entry prompt',0Ah,0 ; DATA XREF: sub_404B75:loc_404C21o
aDismisspinpadp	db 'DISMISSPINPADPROMPT',0 ; DATA XREF: sub_404B75+CEo
; char aAskingForPinS[]
aAskingForPinS	db 'asking for PIN ',27h,'%s',27h,0Ah,0 ; DATA XREF: sub_404B75+10Do
aNeedpinS	db 'NEEDPIN %s',0       ; DATA XREF: sub_404B75+120o
		align 20h
aPksignHashRmd1	db 'PKSIGN [--hash=[rmd160|sha{1,224,256,384,512}|md5]] <hexified_id>'
					; DATA XREF: .data:004442A4o
		db 0Ah
		db 0Ah
		db 'The --hash option is optional; the default is SHA1.',0
; char aHashRmd160[]
aHashRmd160	db '--hash=rmd160',0    ; DATA XREF: sub_404D51+15o
; char aHashSha1[]
aHashSha1	db '--hash=sha1',0      ; DATA XREF: sub_404D51:loc_404D89o
; char aHashSha224[]
aHashSha224	db '--hash=sha224',0    ; DATA XREF: sub_404D51:loc_404DACo
; char aHashSha256[]
aHashSha256	db '--hash=sha256',0    ; DATA XREF: sub_404D51:loc_404DCFo
; char aHashSha384[]
aHashSha384	db '--hash=sha384',0    ; DATA XREF: sub_404D51:loc_404DF2o
; char aHashSha512[]
aHashSha512	db '--hash=sha512',0    ; DATA XREF: sub_404D51:loc_404E15o
; char aHashMd5[]
aHashMd5	db '--hash=md5',0       ; DATA XREF: sub_404D51:loc_404E35o
; char asc_446C14[]
asc_446C14	db '--',0               ; DATA XREF: sub_404D51:loc_404E55o
aInvalidHashAlg	db 'invalid hash algorithm',0 ; DATA XREF: sub_404D51+130o
; char aApp_signFailed[]
aApp_signFailed	db 'app_sign failed: %s',0Ah,0 ; DATA XREF: sub_404D51+263o
aPkauthHexified	db 'PKAUTH <hexified_id>',0 ; DATA XREF: .data:004442B0o
; char aApp_authFailed[]
aApp_authFailed	db 'app_auth failed: %s',0Ah,0 ; DATA XREF: sub_40505B+132o
aPkdecryptHexif	db 'PKDECRYPT <hexified_id>',0 ; DATA XREF: .data:004442BCo
; char aApp_decipherFa[]
aApp_decipherFa	db 'app_decipher failed: %s',0Ah,0 ; DATA XREF: sub_405234+117o
		align 10h
aGetattrNameThi	db 'GETATTR <name>',0Ah ; DATA XREF: .data:004442E0o
		db 0Ah
		db 'This command is used to retrieve data from a smartcard.  The',0Ah
		db 'allowed names depend on the currently selected smartcard',0Ah
		db 'application.  NAME must be percent and ',27h,'+',27h,' escaped.  The va'
		db 'lue is',0Ah
		db 'returned through status message, see the LEARN command for detail'
		db 's.',0Ah
		db 0Ah
		db 'However, the current implementation assumes that Name is not esca'
		db 'ped;',0Ah
		db 'this works as long as noone uses arbitrary escaping. ',0Ah
		db 0Ah
		db 'Note, that this function may even be used on a locked card.',0
		align 20h
aSetattrNameVal	db 'SETATTR <name> <value> ',0Ah ; DATA XREF: .data:004442ECo
		db 0Ah
		db 'This command is used to store data on a a smartcard.  The allowed'
		db 0Ah
		db 'names and values are depend on the currently selected smartcard',0Ah
		db 'application.  NAME and VALUE must be percent and ',27h,'+',27h,' escape'
		db 'd.',0Ah
		db 0Ah
		db 'However, the current implementation assumes that NAME is not',0Ah
		db 'escaped; this works as long as noone uses arbitrary escaping.',0Ah
		db 0Ah
		db 'A PIN will be requested for most NAMEs.  See the corresponding',0Ah
		db 'setattr function of the actually used application (app-*.c) for',0Ah
		db 'details.',0
		align 10h
aWritecertHexif	db 'WRITECERT <hexified_certid>',0Ah ; DATA XREF: .data:004442F8o
		db 0Ah
		db 'This command is used to store a certifciate on a smartcard.  The',0Ah
		db 'allowed certids depend on the currently selected smartcard',0Ah
		db 'application. The actual certifciate is requested using the inquir'
		db 'y',0Ah
		db '"CERTDATA" and needs to be provided in its raw (e.g. DER) form.',0Ah
		db 0Ah
		db 'In almost all cases a a PIN will be requested.  See the related',0Ah
		db 'writecert function of the actually used application (app-*.c) for'
		db 0Ah
		db 'details.',0
aNoCertidGiven	db 'no certid given',0  ; DATA XREF: sub_4056BA+8Do
aCertdata	db 'CERTDATA',0         ; DATA XREF: sub_4056BA+14Co
		align 20h
aWritekeyForceK	db 'WRITEKEY [--force] <keyid> ',0Ah ; DATA XREF: .data:00444304o
		db 0Ah
		db 'This command is used to store a secret key on a a smartcard.  The'
		db 0Ah
		db 'allowed keyids depend on the currently selected smartcard',0Ah
		db 'application. The actual keydata is requested using the inquiry',0Ah
		db '"KEYDATA" and need to be provided without any protection.  With',0Ah
		db '--force set an existing key under this KEYID will get overwritten'
		db '.',0Ah
		db 'The keydata is expected to be the usual canonical encoded',0Ah
		db 'S-expression.',0Ah
		db 0Ah
		db 'A PIN will be requested for most NAMEs.  See the corresponding',0Ah
		db 'writekey function of the actually used application (app-*.c) for',0Ah
		db 'details.',0
aNoKeyidGiven	db 'no keyid given',0   ; DATA XREF: sub_4058EA+A4o
aKeydata	db 'KEYDATA',0          ; DATA XREF: sub_4058EA+16Eo
		align 20h
aGenkeyForceTim	db 'GENKEY [--force] [--timestamp=<isodate>] <no>',0Ah
					; DATA XREF: .data:00444310o
		db 0Ah
		db 'Generate a key on-card identified by NO, which is application',0Ah
		db 'specific.  Return values are application specific.  For OpenPGP',0Ah
		db 'cards 3 status lines are returned:',0Ah
		db 0Ah
		db '  S KEY-FPR  <hexstring>',0Ah
		db '  S KEY-CREATED-AT <seconds_since_epoch>',0Ah
		db '  S KEY-DATA [-|p|n] <hexdata>',0Ah
		db 0Ah
		db '  ',27h,'p',27h,' and ',27h,'n',27h,' are the names of the RSA parameters; ',27h
		db '-',27h,' is used to',0Ah
		db '  indicate that HEXDATA is the first chunk of a parameter given',0Ah
		db '  by the next KEY-DATA.',0Ah
		db 0Ah
		db '--force is required to overwrite an already existing key.  The',0Ah
		db 'KEY-CREATED-AT is required for further processing because it is',0Ah
		db 'part of the hashed key material for the fingerprint.',0Ah
		db 0Ah
		db 'If --timestamp is given an OpenPGP key will be created using this'
		db 0Ah
		db 'value.  The value needs to be in ISO Format; e.g.',0Ah
		db '"--timestamp=20030316T120000" and after 1970-01-01 00:00:00.',0Ah
		db 0Ah
		db 'The public part of the key can also later be retrieved using the',0Ah
		db 'READKEY command.',0
; char aTimestamp[]
aTimestamp	db '--timestamp',0      ; DATA XREF: sub_405B59+7Fo
aMissingValueFo	db 'missing value for option',0 ; DATA XREF: sub_405B59+B1o
aInvalidTimeVal	db 'invalid time value',0 ; DATA XREF: sub_405B59+F0o
aNoKeyNumberGiv	db 'no key number given',0 ; DATA XREF: sub_405B59+137o
		align 10h
aRandomNbytesGe	db 'RANDOM <nbytes>',0Ah ; DATA XREF: .data:0044431Co
		db 0Ah
		db 'Get NBYTES of random from the card and send them back as data.',0Ah
		db 'This usually involves EEPROM write on the card and thus excessive'
		db 0Ah
		db 'use of this command may destroy the card.',0Ah
		db 0Ah
		db 'Note, that this function may be even be used on a locked card.',0
aNumberOfReques	db 'number of requested bytes missing',0 ; DATA XREF: sub_405DEA+2Ao
		align 10h
aPasswdResetNul	db 'PASSWD [--reset] [--nullpin] <chvno>',0Ah ; DATA XREF: .data:00444328o
		db 0Ah
		db 'Change the PIN or, if --reset is given, reset the retry counter o'
		db 'f',0Ah
		db 'the card holder verfication vector CHVNO.  The option --nullpin i'
		db 's',0Ah
		db 'used for TCOS cards to set the initial PIN.  The format of CHVNO',0Ah
		db 'depends on the card application.',0
; char aReset[]
aReset		db '--reset',0          ; DATA XREF: sub_405F6A+1Bo
; char aNullpin[]
aNullpin	db '--nullpin',0        ; DATA XREF: sub_405F6A:loc_405FA0o
aNoChvNumberGiv	db 'no CHV number given',0 ; DATA XREF: sub_405F6A+CAo
; char aCommandPasswdF[]
aCommandPasswdF	db 'command passwd failed: %s',0Ah,0 ; DATA XREF: sub_405F6A+1BDo
		align 20h
aCheckpinIdstrP	db 'CHECKPIN <idstr>',0Ah ; DATA XREF: .data:00444334o
		db 0Ah
		db 'Perform a VERIFY operation without doing anything else.  This may'
		db 0Ah
		db 'be used to initialize a the PIN cache earlier to long lasting',0Ah
		db 'operations.  Its use is highly application dependent.',0Ah
		db 0Ah
		db 'For OpenPGP:',0Ah
		db 0Ah
		db '   Perform a simple verify operation for CHV1 and CHV2, so that',0Ah
		db '   further operations won',27h,'t ask for CHV2 and it is possible to'
		db ' do a',0Ah
		db '   cheap check on the PIN: If there is something wrong with the P'
		db 'IN',0Ah
		db '   entry system, only the regular CHV will get blocked and not th'
		db 'e',0Ah
		db '   dangerous CHV3.  IDSTR is the usual card',27h,'s serial number in'
		db ' hex',0Ah
		db '   notation; an optional fingerprint part will get ignored.  Ther'
		db 'e',0Ah
		db '   is however a special mode if the IDSTR is sffixed with the',0Ah
		db '   literal string "[CHV3]": In this case the Admin PIN is checked'
		db 0Ah
		db '   if and only if the retry counter is still at 3.',0Ah
		db 0Ah
		db 'For Netkey:',0Ah
		db 0Ah
		db '   Any of the valid PIN Ids may be used.  These are the strings:',0Ah
		db 0Ah
		db '     PW1.CH       - Global password 1',0Ah
		db '     PW2.CH       - Global password 2',0Ah
		db '     PW1.CH.SIG   - SigG password 1',0Ah
		db '     PW2.CH.SIG   - SigG password 2',0Ah
		db 0Ah
		db '   For a definitive list, see the implementation in app-nks.c.',0Ah
		db '   Note that we call a PW2.* PIN a "PUK" despite that since TCOS',0Ah
		db '   3.0 they are technically alternative PINs used to mutally',0Ah
		db '   unblock each other.',0
; char aApp_check_pinF[]
aApp_check_pinF	db 'app_check_pin failed: %s',0Ah,0 ; DATA XREF: sub_4061A1+10Do
		align 20h
aLockWaitGrantE	db 'LOCK [--wait]',0Ah  ; DATA XREF: .data:00444340o
		db 0Ah
		db 'Grant exclusive card access to this session.  Note that there is',0Ah
		db 'no lock counter used and a second lock from the same session will'
		db 0Ah
		db 'be ignored.  A single unlock (or RESET) unlocks the session.',0Ah
		db 'Return GPG_ERR_LOCKED if another session has locked the reader.',0Ah
		db 0Ah
		db 'If the option --wait is given the command will wait until a',0Ah
		db 'lock has been released.',0
; char aWait[]
aWait		db '--wait',0           ; DATA XREF: sub_40631D+55o
; char aCmd_lockFailed[]
aCmd_lockFailed	db 'cmd_lock failed: %s',0Ah,0 ; DATA XREF: sub_40631D+96o
aUnlockReleaseE	db 'UNLOCK',0Ah         ; DATA XREF: .data:0044434Co
		db 0Ah
		db 'Release exclusive card access.',0
; char aCmd_unlockFail[]
aCmd_unlockFail	db 'cmd_unlock failed: %s',0Ah,0 ; DATA XREF: sub_4063C4+74o
		align 10h
aGetinfoWhatMul	db 'GETINFO <what>',0Ah ; DATA XREF: .data:00444358o
		db 0Ah
		db 'Multi purpose command to return certain information.  ',0Ah
		db 'Supported values of WHAT are:',0Ah
		db 0Ah
		db 'version     - Return the version of the program.',0Ah
		db 'pid         - Return the process id of the server.',0Ah
		db 0Ah
		db 'socket_name - Return the name of the socket.',0Ah
		db 0Ah
		db 'status - Return the status of the current slot (in the future, ma'
		db 'y',0Ah
		db 'also return the status of all slots).  The status is a list of',0Ah
		db 'one-character flags.  The following flags are currently defined:',0Ah
		db '  ',27h,'u',27h,'  Usable card present.  This is the normal state durin'
		db 'g operation.',0Ah
		db '  ',27h,'r',27h,'  Card removed.  A reset is necessary.',0Ah
		db 'These flags are exclusive.',0Ah
		db 0Ah
		db 'reader_list - Return a list of detected card readers.  Does',0Ah
		db '              currently only work with the internal CCID driver.',0Ah
		db 0Ah
		db 'deny_admin  - Returns OK if admin commands are not allowed or',0Ah
		db '              GPG_ERR_GENERAL if admin commands are allowed.',0Ah
		db 0Ah
		db 'app_list    - Return a list of supported applications.  One',0Ah
		db '              application per line, fields delimited by colons,',0Ah
		db '              first field is the name.',0
aVersion	db 'version',0          ; DATA XREF: sub_406449+14o
a2_0_30_0	db '2.0.30',0           ; DATA XREF: sub_406449+37o
aPid		db 'pid',0              ; DATA XREF: sub_406449+80o
aLu		db '%lu',0              ; DATA XREF: sub_406449+ACo
aSocket_name	db 'socket_name',0      ; DATA XREF: sub_406449+109o
aStatus		db 'status',0           ; DATA XREF: sub_406449+190o
aReader_list	db 'reader_list',0      ; DATA XREF: sub_406449+26Eo
aDeny_admin	db 'deny_admin',0       ; DATA XREF: sub_406449+2FCo
aApp_list	db 'app_list',0         ; DATA XREF: sub_406449+348o
aUnknownValueFo	db 'unknown value for WHAT',0 ; DATA XREF: sub_406449+3D3o
		align 20h
aRestartRestart	db 'RESTART',0Ah        ; DATA XREF: .data:00444364o
		db 0Ah
		db 'Restart the current connection; this is a kind of warm reset.  It'
		db 0Ah
		db 'deletes the context used by this connection but does not send a',0Ah
		db 'RESET to the card.  Thus the card itself won',27h,'t get reset. ',0Ah
		db 0Ah
		db 'This is used by gpg-agent to reuse a primary pipe connection and',0Ah
		db 'may be used by clients to backup from a conflict in the serial',0Ah
		db 'command; i.e. to select another application.',0
; char aImplicitlyUn_0[]
aImplicitlyUn_0	db 'implicitly unlocking due to RESTART',0Ah,0 ; DATA XREF: sub_406840+58o
		align 10h
aDisconnectDisc	db 'DISCONNECT',0Ah     ; DATA XREF: .data:00444370o
		db 0Ah
		db 'Disconnect the card if it is not any longer used by other',0Ah
		db 'connections and the backend supports a disconnect operation.',0
		align 20h
aApduAtrMoreExl	db 'APDU [--atr] [--more] [--exlen[=N]] [hexstring]',0Ah
					; DATA XREF: .data:0044437Co
		db 0Ah
		db 'Send an APDU to the current reader.  This command bypasses the hi'
		db 'gh',0Ah
		db 'level functions and sends the data directly to the card.  HEXSTRI'
		db 'NG',0Ah
		db 'is expected to be a proper APDU.  If HEXSTRING is not given no',0Ah
		db 'commands are set to the card but the command will implictly check'
		db 0Ah
		db 'whether the card is ready for use. ',0Ah
		db 0Ah
		db 'Using the option "--atr" returns the ATR of the card as a status',0Ah
		db 'message before any data like this:',0Ah
		db '  S CARD-ATR 3BFA1300FF813180450031C173C00100009000B1',0Ah
		db 0Ah
		db 'Using the option --more handles the card status word MORE_DATA',0Ah
		db '(61xx) and concatenates all reponses to one block.',0Ah
		db 0Ah
		db 'Using the option "--exlen" the returned APDU may use extended',0Ah
		db 'length up to N bytes.  If N is not given a default value is used',0Ah
		db '(currently 4096).',0
; char aAtr[]
aAtr		db '--atr',0            ; DATA XREF: sub_4068D3+18o
; char aMore[]
aMore		db '--more',0           ; DATA XREF: sub_4068D3+2Eo
; char aExlen[]
aExlen		db '--exlen',0          ; DATA XREF: sub_4068D3+44o
aCardAtr	db 'CARD-ATR',0         ; DATA XREF: sub_4068D3+1D7o
; char aApdu_send_dire[]
aApdu_send_dire	db 'apdu_send_direct failed: %s',0Ah,0 ; DATA XREF: sub_4068D3+274o
aKillscdCommitS	db 'KILLSCD',0Ah        ; DATA XREF: .data:00444388o
		db 0Ah
		db 'Commit suicide.',0
		align 4
aGnuPrivacyGuar	db 'GNU Privacy Guard',27h,'s Smartcard server ready',0
					; DATA XREF: sub_406C20+8Bo
		align 10h
; char aFailedToAlloca[]
aFailedToAlloca	db 'failed to allocate assuan context: %s',0Ah,0 ; DATA XREF: sub_406CEF+30o
		align 4
; char aFailedToInitia[]
aFailedToInitia	db 'failed to initialize the server: %s',0Ah,0 ; DATA XREF: sub_406CEF+B5o
		align 10h
; char aFailedToRegist[]
aFailedToRegist	db 'failed to register commands with Assuan: %s',0Ah,0
					; DATA XREF: sub_406CEF+F0o
; char aAssuanAcceptPr[]
aAssuanAcceptPr	db 'Assuan accept problem: %s',0Ah,0 ; DATA XREF: sub_406CEF+1CBo
; char aAssuanProcessi[]
aAssuanProcessi	db 'Assuan processing failed: %s',0Ah,0 ; DATA XREF: sub_406CEF+1FCo
; char a02x[]
a02x		db '%%%02X',0           ; DATA XREF: sub_406FDB+7Do
		align 10h
; char aErrorLfDetecte[]
aErrorLfDetecte	db 'error: LF detected in status line - not sending',0Ah,0
					; DATA XREF: sub_4070F7+29o
		align 4
; char aEventLxPAlread[]
aEventLxPAlread	db 'event %lx (%p) already triggered for client %d',0Ah,0
					; DATA XREF: sub_407149+A9o
; char aTriggeringEven[]
aTriggeringEven	db 'triggering event %lx (%p) for client %d',0Ah,0
					; DATA XREF: sub_407149+D2o
; char aSeteventLxFail[]
aSeteventLxFail	db 'SetEvent(%lx) failed: %s',0Ah,0 ; DATA XREF: sub_407149+10Co
		align 4
; char aUpdatingSlotDS[]
aUpdatingSlotDS	db 'updating slot %d status: 0x%04X->0x%04X (%u->%u)',0Ah,0
					; DATA XREF: sub_40729B+10Co
aReader_D_statu	db 'reader_%d.status',0 ; DATA XREF: sub_40729B+134o
; char aW[]
aW		db 'w',0                ; DATA XREF: sub_40729B+174o
aUsable		db 'USABLE',0           ; DATA XREF: sub_40729B+19Bo
					; sub_40729B+2FBo
aPresent	db 'PRESENT',0          ; DATA XREF: sub_40729B+1B6o
					; sub_40729B+316o
aNocard		db 'NOCARD',0           ; DATA XREF: sub_40729B:loc_407458o
					; sub_40729B:loc_4075B8o
aActive		db 'ACTIVE',0           ; DATA XREF: sub_40729B:loc_40745Fo
					; sub_40729B:loc_4075BFo
; char aS_0[]
aS_0		db '%s',0Ah,0           ; DATA XREF: sub_40729B:loc_407464o
aGnupghomeS	db 'GNUPGHOME=%s',0     ; DATA XREF: sub_40729B+216o
		align 4
; char aOutOfCoreWhile[]
aOutOfCoreWhile	db 'out of core while building environment',0Ah,0
					; DATA XREF: sub_40729B+230o
; char aD[]
aD		db '%d',0               ; DATA XREF: sub_40729B+257o
; char a0x04x[]
a0x04x		db '0x%04X',0           ; DATA XREF: sub_40729B+275o
					; sub_40729B+290o
aReaderPort	db '--reader-port',0    ; DATA XREF: sub_40729B+2ABo
aOldCode	db '--old-code',0       ; DATA XREF: sub_40729B+2BEo
aNewCode	db '--new-code',0       ; DATA XREF: sub_40729B+2D1o
aStatus_0	db '--status',0         ; DATA XREF: sub_40729B+2E7o
aScdEvent	db 'scd-event',0        ; DATA XREF: sub_40729B+346o
		align 4
; char aFailedToRunEve[]
aFailedToRunEve	db 'failed to run event handler `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40729B+3A6o
		align 10h
; char aDisconnectingC[]
aDisconnectingC	db 'disconnecting card in slot %d',0Ah,0 ; DATA XREF: sub_40729B+459o
aScd_command_ha	db 'scd_command_handler',0 ; DATA XREF: sub_406CEF+273o
aLearn		db 'LEARN',0            ; DATA XREF: .data:0044426Co
aReadcert	db 'READCERT',0         ; DATA XREF: .data:00444278o
aReadkey	db 'READKEY',0          ; DATA XREF: .data:00444284o
aSetdata	db 'SETDATA',0          ; DATA XREF: .data:00444290o
aPksign		db 'PKSIGN',0           ; DATA XREF: .data:0044429Co
aPkauth		db 'PKAUTH',0           ; DATA XREF: .data:004442A8o
aPkdecrypt	db 'PKDECRYPT',0        ; DATA XREF: .data:004442B4o
aInput		db 'INPUT',0            ; DATA XREF: .data:004442C0o
aOutput		db 'OUTPUT',0           ; DATA XREF: .data:004442CCo
aGetattr	db 'GETATTR',0          ; DATA XREF: .data:004442D8o
aSetattr	db 'SETATTR',0          ; DATA XREF: .data:004442E4o
aWritecert	db 'WRITECERT',0        ; DATA XREF: .data:004442F0o
aWritekey	db 'WRITEKEY',0         ; DATA XREF: .data:004442FCo
aGenkey		db 'GENKEY',0           ; DATA XREF: .data:00444308o
aRandom		db 'RANDOM',0           ; DATA XREF: .data:00444314o
aPasswd		db 'PASSWD',0           ; DATA XREF: .data:00444320o
aCheckpin	db 'CHECKPIN',0         ; DATA XREF: .data:0044432Co
aLock		db 'LOCK',0             ; DATA XREF: .data:00444338o
aUnlock		db 'UNLOCK',0           ; DATA XREF: .data:00444344o
aGetinfo	db 'GETINFO',0          ; DATA XREF: .data:00444350o
aRestart	db 'RESTART',0          ; DATA XREF: .data:0044435Co
aDisconnect	db 'DISCONNECT',0       ; DATA XREF: .data:00444368o
aApdu		db 'APDU',0             ; DATA XREF: .data:00444374o
aKillscd	db 'KILLSCD',0          ; DATA XREF: .data:00444380o
aCmd_getinfo	db 'cmd_getinfo',0      ; DATA XREF: sub_406449:loc_40663Co
aDo_reset	db 'do_reset',0         ; DATA XREF: sub_403BAA:loc_403BCDo
		align 10h
; char aEcLu[]
aEcLu		db 'ec=%lu',0           ; DATA XREF: sub_4077E7+Do
		align 4
; char aFailedToAcqu_0[]
aFailedToAcqu_0	db 'failed to acquire apdu lock: %s',0Ah,0 ; DATA XREF: sub_4078B4+4Do
					; sub_40791B+62o
		align 4
; char aFailedToRele_0[]
aFailedToRele_0	db 'failed to release apdu lock: %s',0Ah,0 ; DATA XREF: sub_407997+3Do
		align 10h
; char aNew_reader_slo[]
aNew_reader_slo	db 'new_reader_slot: out of slots',0Ah,0 ; DATA XREF: sub_4079E2+46o
; char aErrorInitializ[]
aErrorInitializ	db 'error initializing mutex: %s',0Ah,0 ; DATA XREF: sub_4079E2+A7o
; char aErrorLockingMu[]
aErrorLockingMu	db 'error locking mutex: %s',0Ah,0 ; DATA XREF: sub_4079E2+F5o
; char aSlotDAtr[]
aSlotDAtr	db 'slot %d: ATR=',0    ; DATA XREF: sub_407CBA+73o
byte_449014	db 0			; DATA XREF: sub_407CBA+ADo
aOkay		db 'okay',0             ; DATA XREF: sub_407D78:loc_407DFAo
					; sub_407FF8:loc_408024o ...
aOutOfCore	db 'out of core',0      ; DATA XREF: sub_407D78:loc_407E01o
aInvalidValue	db 'invalid value',0    ; DATA XREF: sub_407D78:loc_407E08o
					; sub_408626:loc_4086C9o
aNoDriver	db 'no driver',0        ; DATA XREF: sub_407D78:loc_407E0Fo
aNotSupported	db 'not supported',0    ; DATA XREF: sub_407D78:loc_407E16o
					; sub_407E6A:loc_407F86o
aLockingFailed	db 'locking failed',0   ; DATA XREF: sub_407D78:loc_407E1Do
aBusy		db 'busy',0             ; DATA XREF: sub_407D78:loc_407E24o
aNoCard		db 'no card',0          ; DATA XREF: sub_407D78:loc_407E2Bo
aCardInactive	db 'card inactive',0    ; DATA XREF: sub_407D78:loc_407E32o
aCardIOError	db 'card I/O error',0   ; DATA XREF: sub_407D78:loc_407E39o
aGeneralError	db 'general error',0    ; DATA XREF: sub_407D78:loc_407E40o
aNoReader	db 'no reader',0        ; DATA XREF: sub_407D78:loc_407E47o
aAborted	db 'aborted',0          ; DATA XREF: sub_407D78:loc_407E4Eo
aNoPinpad	db 'no pinpad',0        ; DATA XREF: sub_407D78:loc_407E55o
aAlreadyConnect	db 'already connected',0 ; DATA XREF: sub_407D78:loc_407E5Co
aUnknownHostSta	db 'unknown host status error',0 ; DATA XREF: sub_407D78:loc_407E63o
aEofReached	db 'eof reached',0      ; DATA XREF: sub_407E6A:loc_407F49o
aEepromFailure	db 'eeprom failure',0   ; DATA XREF: sub_407E6A:loc_407F53o
aWrongLength	db 'wrong length',0     ; DATA XREF: sub_407E6A:loc_407F5Do
aChvWrong	db 'CHV wrong',0        ; DATA XREF: sub_407E6A:loc_407F67o
aChvBlocked	db 'CHV blocked',0      ; DATA XREF: sub_407E6A:loc_407F71o
aUseConditionsN	db 'use conditions not satisfied',0 ; DATA XREF: sub_407E6A:loc_407F78o
aBadParameter	db 'bad parameter',0    ; DATA XREF: sub_407E6A:loc_407F7Fo
aFileNotFound	db 'file not found',0   ; DATA XREF: sub_407E6A:loc_407F8Do
aRecordNotFound	db 'record not found',0 ; DATA XREF: sub_407E6A:loc_407F94o
aReferenceNotFo	db 'reference not found',0 ; DATA XREF: sub_407E6A:loc_407F9Bo
aBadLc		db 'bad Lc',0           ; DATA XREF: sub_407E6A:loc_407FA2o
aBadP0OrP1	db 'bad P0 or P1',0     ; DATA XREF: sub_407E6A:loc_407FA9o
aInstructionNot	db 'instruction not supported',0 ; DATA XREF: sub_407E6A:loc_407FB0o
aClassNotSuppor	db 'class not supported',0 ; DATA XREF: sub_407E6A:loc_407FB7o
aSuccess	db 'success',0          ; DATA XREF: sub_407E6A:loc_407FBEo
aMoreDataAvaila	db 'more data available',0 ; DATA XREF: sub_407E6A+167o
aUnknownStatusE	db 'unknown status error',0 ; DATA XREF: sub_407E6A:loc_407FF1o
aInvalidData	db 'invalid data',0     ; DATA XREF: sub_407FF8:loc_40802Bo
aCtError	db 'ct error',0         ; DATA XREF: sub_407FF8:loc_408032o
aTransmissionEr	db 'transmission error',0 ; DATA XREF: sub_407FF8:loc_408039o
aMemoryAllocati	db 'memory allocation error',0 ; DATA XREF: sub_407FF8:loc_408040o
aHtsiError	db 'HTSI error',0       ; DATA XREF: sub_407FF8:loc_408047o
aUnknownCtApiEr	db 'unknown CT-API error',0 ; DATA XREF: sub_407FF8:loc_40804Eo
aMemoryIccPrese	db 'Memory ICC present',0 ; DATA XREF: sub_408055+31o
aIccNotPresent	db 'ICC not present',0  ; DATA XREF: sub_408055:loc_40808Do
aProcessorIccPr	db 'Processor ICC present',0 ; DATA XREF: sub_408055:loc_408094o
; char aReaderSlotDS[]
aReaderSlotDS	db 'reader slot %d: %s',0Ah,0 ; DATA XREF: sub_408055+4Fo
		align 4
; char aCt_activate_ca[]
aCt_activate_ca	db 'ct_activate_card: can',27h,'t get status of reader %d: %s',0Ah,0
					; DATA XREF: sub_4080B2+BBo
		align 4
; char aCt_activate__0[]
aCt_activate__0	db 'ct_activate_card(%d): activation failed: %s',0Ah,0
					; DATA XREF: sub_4080B2+183o
aReceivedData	db '  received data:',0 ; DATA XREF: sub_4080B2+1ADo
		align 4
; char aCt_activate__1[]
aCt_activate__1	db 'ct_activate_card(%d): ATR too long',0Ah,0 ; DATA XREF: sub_4080B2+1DCo
aCt_data	db '  CT_data:',0       ; DATA XREF: sub_408388+65o
		align 4
; char aOpen_ct_reader[]
aOpen_ct_reader	db 'open_ct_reader: invalid port %d requested',0Ah,0
					; DATA XREF: sub_408463+1Co
		align 10h
; char aApdu_open_ct_r[]
aApdu_open_ct_r	db 'apdu_open_ct_reader failed on port %d: %s',0Ah,0
					; DATA XREF: sub_408463+9Eo
aInvalidPcScErr	db 'invalid PC/SC error code',0 ; DATA XREF: sub_408626+25o
aCancelled	db 'cancelled',0        ; DATA XREF: sub_408626:loc_408675o
aCanTDispose	db 'can',27h,'t dispose',0 ; DATA XREF: sub_408626:loc_408681o
aInsufficientBu	db 'insufficient buffer',0 ; DATA XREF: sub_408626:loc_40868Do
aInvalidAtr	db 'invalid ATR',0      ; DATA XREF: sub_408626:loc_408699o
aInvalidHandle	db 'invalid handle',0   ; DATA XREF: sub_408626:loc_4086A5o
aInvalidParamet	db 'invalid parameter',0 ; DATA XREF: sub_408626:loc_4086B1o
aInvalidTarget	db 'invalid target',0   ; DATA XREF: sub_408626:loc_4086BDo
aNoMemory	db 'no memory',0        ; DATA XREF: sub_408626:loc_4086D5o
aCommError	db 'comm error',0       ; DATA XREF: sub_408626:loc_4086E1o
aInternalError	db 'internal error',0   ; DATA XREF: sub_408626:loc_4086EDo
aUnknownError	db 'unknown error',0    ; DATA XREF: sub_408626:loc_4086F9o
aWaitedTooLong	db 'waited too long',0  ; DATA XREF: sub_408626:loc_408705o
aUnknownReader	db 'unknown reader',0   ; DATA XREF: sub_408626:loc_408711o
aTimeout	db 'timeout',0          ; DATA XREF: sub_408626:loc_40871Do
aSharingViolati	db 'sharing violation',0 ; DATA XREF: sub_408626:loc_408729o
aNoSmartcard	db 'no smartcard',0     ; DATA XREF: sub_408626:loc_408735o
aUnknownCard	db 'unknown card',0     ; DATA XREF: sub_408626:loc_408741o
aProtoMismatch	db 'proto mismatch',0   ; DATA XREF: sub_408626:loc_40874Do
aNotReady	db 'not ready',0        ; DATA XREF: sub_408626:loc_408759o
aSystemCancelle	db 'system cancelled',0 ; DATA XREF: sub_408626:loc_408765o
aNotTransacted	db 'not transacted',0   ; DATA XREF: sub_408626:loc_408771o
aReaderUnavaila	db 'reader unavailable',0 ; DATA XREF: sub_408626:loc_40877Do
aUnsupportedCar	db 'unsupported card',0 ; DATA XREF: sub_408626:loc_408786o
aUnresponsiveCa	db 'unresponsive card',0 ; DATA XREF: sub_408626:loc_40878Fo
aUnpoweredCard	db 'unpowered card',0   ; DATA XREF: sub_408626:loc_408798o
aResetCard	db 'reset card',0       ; DATA XREF: sub_408626:loc_4087A1o
aRemovedCard	db 'removed card',0     ; DATA XREF: sub_408626:loc_4087AAo
aInsertedCard	db 'inserted card',0    ; DATA XREF: sub_408626:loc_4087B3o
aUnsupportedFea	db 'unsupported feature',0 ; DATA XREF: sub_408626:loc_4087BCo
aPciTooSmall	db 'PCI too small',0    ; DATA XREF: sub_408626:loc_4087C5o
aReaderUnsuppor	db 'reader unsupported',0 ; DATA XREF: sub_408626:loc_4087CEo
aDuplicateReade	db 'duplicate reader',0 ; DATA XREF: sub_408626:loc_4087D7o
aCardUnsupporte	db 'card unsupported',0 ; DATA XREF: sub_408626:loc_4087E0o
aNoService	db 'no service',0       ; DATA XREF: sub_408626:loc_4087E9o
aServiceStopped	db 'service stopped',0  ; DATA XREF: sub_408626:loc_4087F2o
aUnknownPcScErr	db 'unknown PC/SC error code',0 ; DATA XREF: sub_408626:loc_4087FBo
off_4495D0	dd offset loc_4087FB, offset loc_4086ED, offset	loc_408675
					; DATA XREF: sub_408626+46o
		dd offset loc_4086A5, offset loc_4086B1, offset	loc_4086BD ; jump table	for switch statement
		dd offset loc_4086D5, offset loc_408705, offset	loc_40868D
		dd offset loc_408711, offset loc_40871D, offset	loc_408729
		dd offset loc_408735, offset loc_408741, offset	loc_408681
		dd offset loc_40874D, offset loc_408759, offset	loc_4086C9
		dd offset loc_408765, offset loc_4086E1, offset	loc_4086F9
		dd offset loc_408699, offset loc_408771, offset	loc_40877D
		dd offset loc_4087FB, offset loc_4087C5, offset	loc_4087CE
		dd offset loc_4087D7, offset loc_4087E0, offset	loc_4087E9
		dd offset loc_4087F2, offset loc_4087BC, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_4087FB
		dd offset loc_4087FB, offset loc_4087FB, offset	loc_408786
		dd offset loc_40878F, offset loc_408798, offset	loc_4087A1
		dd offset loc_4087AA, offset loc_4087B3
; char aReaderSlotDAct[]
aReaderSlotDAct	db 'reader slot %d: active protocol:',0 ; DATA XREF: sub_4088F6+26o
; char aT0[]
aT0		db ' T0',0              ; DATA XREF: sub_4088F6+4Ao
; char aT1[]
aT1		db ' T1',0              ; DATA XREF: sub_4088F6+70o
; char aRaw[]
aRaw		db ' raw',0             ; DATA XREF: sub_4088F6+96o
; char asc_4497AA[]
asc_4497AA	db 0Ah,0		; DATA XREF: sub_4088F6:loc_408998o
; char aReaderSlotDNot[]
aReaderSlotDNot	db 'reader slot %d: not connected',0Ah,0 ; DATA XREF: sub_4088F6+B7o
		align 4
; char aPcsc_get_statu[]
aPcsc_get_statu	db 'pcsc_get_status_change failed: %s (0x%lx)',0Ah,0
					; DATA XREF: sub_4089BB+9Do
aPcsc_data	db '  PCSC_data:',0     ; DATA XREF: sub_408AF0+53o
; char aPcsc_transmitF[]
aPcsc_transmitF	db 'pcsc_transmit failed: %s (0x%lx)',0Ah,0 ; DATA XREF: sub_408AF0+107o
		align 4
; char aPcsc_controlFa[]
aPcsc_controlFa	db 'pcsc_control failed: %s (0x%lx)',0Ah,0 ; DATA XREF: sub_408C46+7Fo
		align 4
; char a____Gnupg22__1[]
a____Gnupg22__1	db '../../gnupg2-2.0.30/scd/apdu.c',0 ; DATA XREF: sub_408D9F+1Fo
					; sub_409015+1Ao ...
		align 4
; char aSlot0SlotMax_r[]
aSlot0SlotMax_r	db 'slot >= 0 && slot < MAX_READER',0 ; DATA XREF: sub_408D9F+27o
					; sub_409015+22o
		align 4
; char aPcsc_connectFa[]
aPcsc_connectFa	db 'pcsc_connect failed: %s (0x%lx)',0Ah,0 ; DATA XREF: sub_408D9F+148o
		align 10h
; char aPcsc_statusFai[]
aPcsc_statusFai	db 'pcsc_status failed: %s (0x%lx) %lu',0Ah,0 ; DATA XREF: sub_408D9F+1F5o
; char aAtrReturnedByP[]
aAtrReturnedByP	db 'ATR returned by pcsc_status is too large',0Ah,0
					; DATA XREF: sub_408D9F+20Bo
		align 10h
; char aPcsc_disconnec[]
aPcsc_disconnec	db 'pcsc_disconnect failed: %s (0x%lx)',0Ah,0 ; DATA XREF: sub_409015+93o
; char aPcsc_vendor_sp[]
aPcsc_vendor_sp	db 'pcsc_vendor_specific_init: GET_FEATURE_REQUEST failed: %d',0Ah,0
					; DATA XREF: sub_409117+6Fo
		align 10h
; char aFeatureCode02x[]
aFeatureCode02x	db 'feature: code=%02X, len=%d, v=%02X',0Ah,0 ; DATA XREF: sub_409117+15Fo
; char SubStr[]
SubStr		db 'SPRx32',0           ; DATA XREF: sub_409117+1BCo
; char aSt2xxx[]
aSt2xxx		db 'ST-2xxx',0          ; DATA XREF: sub_409117+20Fo
; char aCyberjack[]
aCyberjack	db 'cyberJack',0        ; DATA XREF: sub_409117+262o
; char aDigipass[]
aDigipass	db 'DIGIPASS',0         ; DATA XREF: sub_409117+287o
; char aGnuk[]
aGnuk		db 'Gnuk',0             ; DATA XREF: sub_409117+2ACo
; char aKaan[]
aKaan		db 'KAAN',0             ; DATA XREF: sub_409117+2D1o
; char aPcsc_vendor__0[]
aPcsc_vendor__0	db 'pcsc_vendor_specific_init: GET_TLV_IOCTL failed: %d',0Ah,0
					; DATA XREF: sub_409117+353o
		align 4
; char aTlvPropertiesT[]
aTlvPropertiesT	db 'TLV properties: tag=%02X, len=%d, v=%08X',0Ah,0
					; DATA XREF: sub_409117+495o
		align 4
; char aPcsc_establish[]
aPcsc_establish	db 'pcsc_establish_context failed: %s (0x%lx)',0Ah,0
					; DATA XREF: sub_40970C+86o
		align 10h
; char aErrorAllocat_0[]
aErrorAllocat_0	db 'error allocating memory for reader list',0Ah,0
					; DATA XREF: sub_40970C+115o
		align 4
; char aPcsc_list_read[]
aPcsc_list_read	db 'pcsc_list_readers failed: %s (0x%lx)',0Ah,0 ; DATA XREF: sub_40970C+1BDo
; char aDetectedReader[]
aDetectedReader	db 'detected reader `%s',27h,0Ah,0 ; DATA XREF: sub_40970C+249o
; char aInvalidRespons[]
aInvalidRespons	db 'invalid response from pcsc_list_readers',0Ah,0
					; DATA XREF: sub_40970C+27Eo
		align 4
; char aErrorAllocat_1[]
aErrorAllocat_1	db 'error allocating memory for reader name',0Ah,0
					; DATA XREF: sub_40970C+376o
		align 10h
; char aCheck_pcsc_pin[]
aCheck_pcsc_pin	db 'check_pcsc_pinpad: command=%02X, r=%d',0Ah,0 ; DATA XREF: sub_409BE8+E8o
		align 4
; char aSendSecureC02x[]
aSendSecureC02x	db 'send secure: c=%02X i=%02X p1=%02X p2=%02X len=%d pinmax=%d',0Ah,0
					; DATA XREF: sub_409CFE+26Co
					; sub_40A04A+2B6o
; char aControl_pcscFa[]
aControl_pcscFa	db 'control_pcsc failed: %d',0Ah,0 ; DATA XREF: sub_409CFE+2D7o
					; sub_40A04A+321o
		align 10h
; char aResponseSw04xD[]
aResponseSw04xD	db ' response: sw=%04X  datalen=%d',0Ah,0 ; DATA XREF: sub_409CFE+337o
					; sub_40A04A+381o ...
; char aApdu_open_read[]
aApdu_open_read	db 'apdu_open_reader: failed to open driver: %s',0Ah,0
					; DATA XREF: sub_40A3E0+75o
; CHAR aCt_init[]
aCt_init	db 'CT_init',0          ; DATA XREF: sub_40A3E0:loc_40A46Bo
; CHAR aCt_data_0[]
aCt_data_0	db 'CT_data',0          ; DATA XREF: sub_40A3E0+A3o
; CHAR aCt_close[]
aCt_close	db 'CT_close',0         ; DATA XREF: sub_40A3E0+BBo
		align 4
; char aApdu_open_re_0[]
aApdu_open_re_0	db 'apdu_open_reader: invalid CT-API driver',0Ah,0
					; DATA XREF: sub_40A3E0:loc_40A4CEo
		align 4
; char aApdu_open_re_1[]
aApdu_open_re_1	db 'apdu_open_reader: failed to open driver `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40A3E0+167o
; CHAR aScardestablish[]
aScardestablish	db 'SCardEstablishContext',0 ; DATA XREF: sub_40A3E0:loc_40A55Do
; CHAR aScardreleaseco[]
aScardreleaseco	db 'SCardReleaseContext',0 ; DATA XREF: sub_40A3E0+195o
; CHAR aScardlistreade[]
aScardlistreade	db 'SCardListReaders',0 ; DATA XREF: sub_40A3E0+1ADo
; CHAR aScardlistrea_0[]
aScardlistrea_0	db 'SCardListReadersA',0 ; DATA XREF: sub_40A3E0+1CEo
; CHAR aScardgetstatus[]
aScardgetstatus	db 'SCardGetStatusChange',0 ; DATA XREF: sub_40A3E0:loc_40A5C6o
; CHAR aScardgetstat_0[]
aScardgetstat_0	db 'SCardGetStatusChangeA',0 ; DATA XREF: sub_40A3E0+207o
; CHAR aScardconnect[]
aScardconnect	db 'SCardConnect',0     ; DATA XREF: sub_40A3E0:loc_40A5FFo
; CHAR aScardconnecta[]
aScardconnecta	db 'SCardConnectA',0    ; DATA XREF: sub_40A3E0+240o
; CHAR aScardreconnect[]
aScardreconnect	db 'SCardReconnect',0   ; DATA XREF: sub_40A3E0:loc_40A638o
; CHAR aScardreconne_0[]
aScardreconne_0	db 'SCardReconnectA',0  ; DATA XREF: sub_40A3E0+279o
; CHAR aScarddisconnec[]
aScarddisconnec	db 'SCardDisconnect',0  ; DATA XREF: sub_40A3E0:loc_40A671o
; CHAR aScardstatus[]
aScardstatus	db 'SCardStatus',0      ; DATA XREF: sub_40A3E0+2A9o
; CHAR aScardstatusa[]
aScardstatusa	db 'SCardStatusA',0     ; DATA XREF: sub_40A3E0+2CAo
; CHAR aScardbegintran[]
aScardbegintran	db 'SCardBeginTransaction',0 ; DATA XREF: sub_40A3E0:loc_40A6C2o
; CHAR aScardendtransa[]
aScardendtransa	db 'SCardEndTransaction',0 ; DATA XREF: sub_40A3E0+2FAo
; CHAR aScardtransmit[]
aScardtransmit	db 'SCardTransmit',0    ; DATA XREF: sub_40A3E0+312o
; CHAR aScardsettimeou[]
aScardsettimeou	db 'SCardSetTimeout',0  ; DATA XREF: sub_40A3E0+32Ao
; CHAR aScardcontrol[]
aScardcontrol	db 'SCardControl',0     ; DATA XREF: sub_40A3E0+342o
		align 4
; char aApdu_open_re_2[]
aApdu_open_re_2	db 'apdu_open_reader: invalid PC/SC driver (%d%d%d%d%d%d%d%d%d%d%d%d%'
					; DATA XREF: sub_40A3E0+4D7o
		db 'd)',0Ah,0
		align 10h
; char aApdu_close_rea[]
aApdu_close_rea	db 'apdu_close_reader => 0x%x (apdu_disconnect)',0Ah,0
					; DATA XREF: sub_40A90C+48o
		align 10h
; char aSendApduC02xI0[]
aSendApduC02xI0	db 'send apdu: c=%02X i=%02X p1=%02X p2=%02X lc=%d le=%d em=%d',0Ah,0
					; DATA XREF: sub_40B402+95o
; char aUse_chaining25[]
aUse_chaining25	db 'use_chaining < 256',0 ; DATA XREF: sub_40B402+424o
; char aApdulenApdu_bu[]
aApdulenApdu_bu	db 'apdulen <= apdu_buffer_size',0 ; DATA XREF: sub_40B402+512o
					; sub_40B402+8F3o
		align 4
; char aApdu_send_simp[]
aApdu_send_simp	db 'apdu_send_simple(%d) failed: %s',0Ah,0 ; DATA XREF: sub_40B402+5A6o
aDump		db '    dump: ',0       ; DATA XREF: sub_40B402+6E3o
; char aResultlenBufsi[]
aResultlenBufsi	db 'resultlen < bufsize',0 ; DATA XREF: sub_40B402+811o
					; sub_40C143+338o
; char aApdu_send_si_0[]
aApdu_send_si_0	db 'apdu_send_simple(%d): %d more bytes available',0Ah,0
					; DATA XREF: sub_40B402+869o
		align 4
; char aApdu_send_si_1[]
aApdu_send_si_1	db 'apdu_send_simple(%d) for get response failed: %s',0Ah,0
					; DATA XREF: sub_40B402+988o
		align 10h
; char aMoreSw04xDatal[]
aMoreSw04xDatal	db '     more: sw=%04X  datalen=%d',0Ah,0 ; DATA XREF: sub_40B402+A1Bo
					; sub_40C143+517o
aDump_0		db '     dump: ',0      ; DATA XREF: sub_40B402+A56o
					; sub_40C143+29Ao ...
; char aApdu_send_si_2[]
aApdu_send_si_2	db 'apdu_send_simple(%d) got unexpected status %04X from get response'
					; DATA XREF: sub_40B402+B60o
		db 0Ah,0
aDump_1		db '      dump: ',0     ; DATA XREF: sub_40B402+C09o
					; sub_40C143+7D0o
; char aApdu_send_di_0[]
aApdu_send_di_0	db 'apdu_send_direct(%d) failed: %s',0Ah,0 ; DATA XREF: sub_40C143+1CCo
		align 10h
; char aApdu_send_di_1[]
aApdu_send_di_1	db 'apdu_send_direct(%d): %d more bytes available',0Ah,0
					; DATA XREF: sub_40C143+390o
		align 10h
; char aApdu_send_di_2[]
aApdu_send_di_2	db 'apdu_send_direct(%d) for get response failed: %s',0Ah,0
					; DATA XREF: sub_40C143+484o
		align 4
; char aApdu_send_di_3[]
aApdu_send_di_3	db 'apdu_send_direct(%d) got unexpected status %04X from get response'
					; DATA XREF: sub_40C143+65Fo
		db 0Ah,0
		align 4
aSCDD		db '%s %c %d %d',0      ; DATA XREF: sub_40E0F8+31o
aProgress	db 'PROGRESS',0         ; DATA XREF: sub_40E0F8+53o
; char aErrorInitial_0[]
aErrorInitial_0	db 'error initializing mutex: %s',0Ah,0 ; DATA XREF: sub_40E160+8Bo
		align 4
; char aFailedToAcqu_1[]
aFailedToAcqu_1	db 'failed to acquire APP lock for slot %d: %s',0Ah,0
					; DATA XREF: sub_40E160+122o
; char aUnlock_readerC[]
aUnlock_readerC	db 'unlock_reader called for invalid slot %d',0Ah,0
					; DATA XREF: sub_40E2B4+32o
		align 4
; char aFailedToRele_1[]
aFailedToRele_1	db 'failed to release APP lock for slot %d: %s',0Ah,0
					; DATA XREF: sub_40E2B4+95o
; char aUnknownUnderW3[]
aUnknownUnderW3	db 'unknown under W32',0 ; DATA XREF: sub_40E357+6o
aApp_dump_state	db 'app_dump_state: slot=%d lock=',0 ; DATA XREF: .text:0040E39Fo
aAppP		db ' app=%p',0          ; DATA XREF: .text:0040E3F7o
aTypeS		db ' type=`%s',27h,0    ; DATA XREF: .text:0040E439o
asc_44A143	db 0Ah,0		; DATA XREF: .text:loc_40E445o
aNull		db '<null>',0           ; DATA XREF: sub_40E52B:loc_40E5C3o
; char aApplicationSIn[]
aApplicationSIn	db 'application ',27h,'%s',27h,' in use by reader %d - can',27h,'t switch',0Ah,0
					; DATA XREF: sub_40E52B+A8o
; char Str2[]
Str2		db 'undefined',0        ; DATA XREF: sub_40E65D+23o
; char aSlotMismatchDD[]
aSlotMismatchDD	db 'slot mismatch %d/%d',0Ah,0 ; DATA XREF: sub_40E65D+D3o
; char aErrorAllocat_2[]
aErrorAllocat_2	db 'error allocating context: %s',0Ah,0 ; DATA XREF: sub_40E65D+146o
		align 10h
; char aEnablingBmiTes[]
aEnablingBmiTes	db 'enabling BMI testcard workaround',0Ah,0 ; DATA XREF: sub_40E65D+27Do
aUndefined_0	db 'UNDEFINED',0        ; DATA XREF: sub_40E65D+32Bo
; char aOpenpgp[]
aOpenpgp	db 'openpgp',0          ; DATA XREF: sub_40E65D+350o
					; sub_40E65D+366o ...
; char aNks[]
aNks		db 'nks',0              ; DATA XREF: sub_40E65D+391o
					; sub_40E65D+3A7o ...
; char aP15[]
aP15		db 'p15',0              ; DATA XREF: sub_40E65D+3D2o
					; sub_40E65D+3E8o ...
; char aGeldkarte[]
aGeldkarte	db 'geldkarte',0        ; DATA XREF: sub_40E65D+413o
					; sub_40E65D+429o ...
; char aDinsig[]
aDinsig		db 'dinsig',0           ; DATA XREF: sub_40E65D+454o
					; sub_40E65D+46Ao ...
		align 10h
; char aCanTSelectAppl[]
aCanTSelectAppl	db 'can',27h,'t select application `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_40E65D+4CCo
		align 4
; char aNoSupportedCar[]
aNoSupportedCar	db 'no supported card application found: %s',0Ah,0
					; DATA XREF: sub_40E65D+4E9o
		align 10h
; char aTryingToReleas[]
aTryingToReleas	db 'trying to release an already released context',0Ah,0
					; DATA XREF: sub_40ECE7+19o
; char aAppMismatchPP[]
aAppMismatchPP	db 'app mismatch %p/%p',0Ah,0 ; DATA XREF: sub_40ECE7+9Ao
byte_44A2A3	db 0FFh			; DATA XREF: sub_40EDA0:loc_40EDE9o
		db 2 dup(0)
word_44A2A6	dw 7FFFh		; DATA XREF: sub_40EDA0:loc_40EE70o
		db 0
aFf7f00		db 'FF7F00',0           ; DATA XREF: sub_40EEAD+42o
; char aApptype[]
aApptype	db 'APPTYPE',0          ; DATA XREF: sub_40EF3F+A7o
					; sub_40F1D4+58o ...
; char aSerialno_0[]
aSerialno_0	db 'SERIALNO',0         ; DATA XREF: sub_40F1D4+D6o
					; sub_40F1D4+155o
; char aOperationSignR[]
aOperationSignR	db 'operation sign result: %s',0Ah,0 ; DATA XREF: sub_40F48F+103o
; char aOperationAuthR[]
aOperationAuthR	db 'operation auth result: %s',0Ah,0 ; DATA XREF: sub_40F5A3+FCo
		align 4
; char aOperationDecip[]
aOperationDecip	db 'operation decipher result: %s',0Ah,0 ; DATA XREF: sub_40F6B0+FCo
		align 4
; char aOperationWrite[]
aOperationWrite	db 'operation writecert result: %s',0Ah,0 ; DATA XREF: sub_40F7BD+ECo
; char aOperationWri_0[]
aOperationWri_0	db 'operation writekey result: %s',0Ah,0 ; DATA XREF: sub_40F8BA+F3o
; char aOperationGenke[]
aOperationGenke	db 'operation genkey result: %s',0Ah,0 ; DATA XREF: sub_40F9BE+ECo
; char aOperationChang[]
aOperationChang	db 'operation change_pin result: %s',0Ah,0 ; DATA XREF: sub_40FB4E+E5o
		align 4
; char aOperationCheck[]
aOperationCheck	db 'operation check_pin result: %s',0Ah,0 ; DATA XREF: sub_40FC44+D5o
; char aErrorSelecting[]
aErrorSelecting	db 'error selecting FID 0x%04X: %s',0Ah,0 ; DATA XREF: sub_40FEE5+4Fo
; char aErrorReadingCe[]
aErrorReadingCe	db 'error reading certificate from FID 0x%04X: %s',0Ah,0
					; DATA XREF: sub_40FEE5+ADo
		align 4
; char aNoCertificateC[]
aNoCertificateC	db 'no certificate contained in FID 0x%04X',0Ah,0
					; DATA XREF: sub_40FEE5+DBo
; char aErrorParsingCe[]
aErrorParsingCe	db 'error parsing certificate in FID 0x%04X: %s',0Ah,0
					; DATA XREF: sub_40FEE5+16Bo
		align 10h
; char aDataAtFid0x04x[]
aDataAtFid0x04x	db 'data at FID 0x%04X does not look like a certificate',0Ah,0
					; DATA XREF: sub_40FEE5+1B1o
		align 4
aLoginData_0	db 'Login Data',0       ; DATA XREF: .data:off_4443B0o
aUrl		db 'URL',0              ; DATA XREF: .data:004443C4o
aHistoricalBy_0	db 'Historical Bytes',0
aCardholderRela	db 'Cardholder Related Data',0
aName		db 'Name',0             ; DATA XREF: .data:00444400o
aLanguagePrefer	db 'Language preferences',0 ; DATA XREF: .data:00444414o
aSex		db 'Sex',0              ; DATA XREF: .data:00444428o
aApplicationRel	db 'Application Related Data',0
		dd offset dword_44492C+15h
aDiscretionaryD	db 'Discretionary Data Objects',0
aCardCapabiliti	db 'Card Capabilities',0
aExtendedCardCa	db 'Extended Card Capabilities',0
		align 4
aAlgorithmAttri	db 'Algorithm Attributes Signature',0
		align 4
aAlgorithmAtt_0	db 'Algorithm Attributes Decryption',0
aAlgorithmAtt_1	db 'Algorithm Attributes Authentication',0
aChvStatusBytes	db 'CHV Status Bytes',0 ; DATA XREF: sub_418EB5+290o
aFingerprints	db 'Fingerprints',0
aCaFingerprints	db 'CA Fingerprints',0
aGenerationTime	db 'Generation time',0
aSecuritySuppor	db 'Security Support Template',0
aDigitalSignatu	db 'Digital Signature Counter',0
aPrivateDo1_0	db 'Private DO 1',0     ; DATA XREF: .data:00444554o
aPrivateDo2_0	db 'Private DO 2',0     ; DATA XREF: .data:00444568o
aPrivateDo3_0	db 'Private DO 3',0     ; DATA XREF: .data:0044457Co
aPrivateDo4_0	db 'Private DO 4',0     ; DATA XREF: .data:00444590o
aCardholderCert	db 'Cardholder certificate',0
		align 4
; char a____Gnupg22__2[]
a____Gnupg22__2	db '../../gnupg2-2.0.30/scd/app-openpgp.c',0 ; DATA XREF: sub_4102D7+1E3o
					; sub_410542+80o ...
; char aCTagTag[]
aCTagTag	db 'c->tag != tag',0    ; DATA XREF: sub_4102D7+1EBo
					; sub_410542+88o
; char aWarningConstru[]
aWarningConstru	db 'warning: constructed DO too short',0Ah,0 ; DATA XREF: sub_41075F+28Fo
					; sub_410B09+214o
; char aDoSNotAvailabl[]
aDoSNotAvailabl	db 'DO `%s',27h,' not available: %s',0Ah,0 ; DATA XREF: sub_410B09+AFo
; char aDoS[]
aDoS		db 'DO `%s',27h,': ',0  ; DATA XREF: sub_410B09+F8o
					; sub_410B09+25Do
byte_44A6F4	db 0			; DATA XREF: sub_410B09+112o
					; sub_410B09+296o ...
; char aDoS_S[]
aDoS_S		db 'DO `%s',27h,': `%.*s',27h,0Ah,0 ; DATA XREF: sub_410B09+148o
					; sub_410B09+2CCo
; char aU[]
aU		db '[%u]',0Ah,0         ; DATA XREF: sub_410B09+27Ao
; char aFailedToStoreT[]
aFailedToStoreT	db 'failed to store the fingerprint: %s',0Ah,0 ; DATA XREF: sub_4112C8+24Eo
		align 4
; char aFailedToStor_0[]
aFailedToStor_0	db 'failed to store the creation date: %s',0Ah,0
					; DATA XREF: sub_4112C8+2DCo
; char aD_0[]
aD_0		db '%d',0               ; DATA XREF: sub_4115C5:loc_41161Do
					; sub_4116B8+23o
; char aLu_0[]
aLu_0		db '%lu',0              ; DATA XREF: sub_4116B8+3Eo
					; sub_41199B+C1o ...
		align 4
; char aMemoryAlloca_0[]
aMemoryAlloca_0	db 'memory allocation error in send_key_data',0Ah,0
					; DATA XREF: sub_411794+30o
asc_44A78E	db '-',0                ; DATA XREF: sub_411794+8Co
aKeyData	db 'KEY-DATA',0         ; DATA XREF: sub_411794+94o
					; sub_411794+106o
		align 4
; char aNumber0NumberD[]
aNumber0NumberD	db 'number >=0 && number < DIM(app->app_local->keyattr)',0
					; DATA XREF: sub_4118BE+29o
aD1UUD		db '%d 1 %u %u %d',0    ; DATA XREF: sub_4118BE+99o
aSerialno_1	db 'SERIALNO',0         ; DATA XREF: sub_41199B+152o
		align 4
aGcDKiDFcDPdDMc	db 'gc=%d ki=%d fc=%d pd=%d mcl3=%u aac=%d sm=%d',0
					; DATA XREF: sub_41199B+261o
; char aD_1[]
aD_1		db ' %d',0              ; DATA XREF: sub_41199B+52Co
; char aKeyno0Keyno2[]
aKeyno0Keyno2	db 'keyno >=0 && keyno <= 2',0 ; DATA XREF: sub_412193+29o
					; sub_415465+23o ...
; char aSub[]
aSub		db 'sub',0              ; DATA XREF: sub_412250+107o
					; sub_412250+169o
; char aPub[]
aPub		db 'pub',0              ; DATA XREF: sub_412250+11Eo
					; sub_412250+184o
; char aPkd[]
aPkd		db 'pkd',0              ; DATA XREF: sub_412250+19Fo
asc_44A83D	db '',0                ; DATA XREF: sub_41257F+12Co
					; sub_4168B1+1CBo
aD_2		db '',0                ; DATA XREF: sub_41257F:loc_4126B2o
					; sub_4168B1:loc_416A83o
asc_44A841	db '',0                ; DATA XREF: sub_41257F:loc_4126B9o
					; sub_4168B1:loc_416A8Ao
		align 4
; char aReadingPublicK[]
aReadingPublicK	db 'reading public key failed: %s',0Ah,0 ; DATA XREF: sub_41257F+18Bo
		align 4
; char aResponseDoesNo[]
aResponseDoesNo	db 'response does not contain the public key data',0Ah,0
					; DATA XREF: sub_41257F+1E1o
					; sub_4168B1+2A7o
		align 4
; char aResponseDoes_0[]
aResponseDoes_0	db 'response does not contain the RSA modulus',0Ah,0
					; DATA XREF: sub_41257F+234o
					; sub_4168B1+2F9o
		align 10h
; char aResponseDoes_1[]
aResponseDoes_1	db 'response does not contain the RSA public exponent',0Ah,0
					; DATA XREF: sub_41257F+287o
					; sub_4168B1+36Co
		align 4
; char aErrorWhileRetr[]
aErrorWhileRetr	db 'error while retrieving fpr from card: %s',0Ah,0
					; DATA XREF: sub_41257F+3BCo
		align 10h
aGpgListKeysWit	db 'gpg --list-keys --with-colons --with-key-data ',27h,'%s',27h,0
					; DATA XREF: sub_41257F+3DDo
; char aR_0[]
aR_0		db 'r',0                ; DATA XREF: sub_41257F+409o
; char aRunningGpgFail[]
aRunningGpgFail	db 'running gpg failed: %s',0Ah,0 ; DATA XREF: sub_41257F+446o
		align 10h
; char aErrorWhileRe_0[]
aErrorWhileRe_0	db 'error while retrieving key material through pipe: %s',0Ah,0
					; DATA XREF: sub_41257F+4AAo
; char a10PublicKey3Rs[]
a10PublicKey3Rs	db '(10:public-key(3:rsa(1:n%u:',0 ; DATA XREF: sub_41257F+4E7o
; char a1EU[]
a1EU		db ')(1:e%u:',0         ; DATA XREF: sub_41257F+54Eo
asc_44A9CB	db ')))',0              ; DATA XREF: sub_41257F+5AFo
; char aKeyno1Keyno3[]
aKeyno1Keyno3	db 'keyno >= 1 && keyno <= 3',0 ; DATA XREF: sub_412BF2+4Do
					; sub_416E29+22o
; char aOpenpgp_D[]
aOpenpgp_D	db 'OPENPGP.%d',0       ; DATA XREF: sub_412BF2+F2o
aKeypairinfo_0	db 'KEYPAIRINFO',0      ; DATA XREF: sub_412BF2+15Co
; char aExtcap[]
aExtcap		db 'EXTCAP',0           ; DATA XREF: sub_412D77+6o
					; .data:0044485Co
; char aDispName[]
aDispName	db 'DISP-NAME',0        ; DATA XREF: sub_412D77+20o
					; .data:off_444640o ...
; char aDispLang[]
aDispLang	db 'DISP-LANG',0        ; DATA XREF: sub_412D77+3Ao
					; .data:00444668o ...
; char aDispSex[]
aDispSex	db 'DISP-SEX',0         ; DATA XREF: sub_412D77+54o
					; .data:0044467Co ...
; char aPubkeyUrl[]
aPubkeyUrl	db 'PUBKEY-URL',0       ; DATA XREF: sub_412D77+6Eo
					; .data:00444690o ...
; char aLoginData[]
aLoginData	db 'LOGIN-DATA',0       ; DATA XREF: sub_412D77+88o
					; .data:00444654o ...
; char aKeyFpr[]
aKeyFpr		db 'KEY-FPR',0          ; DATA XREF: sub_412D77+A2o
					; sub_4168B1+485o ...
; char aKeyTime[]
aKeyTime	db 'KEY-TIME',0         ; DATA XREF: sub_412D77+C9o
; char aCaFpr[]
aCaFpr		db 'CA-FPR',0           ; DATA XREF: sub_412D77:loc_412E5Ao
; char aChvStatus[]
aChvStatus	db 'CHV-STATUS',0       ; DATA XREF: sub_412D77+FDo
; char aSigCounter[]
aSigCounter	db 'SIG-COUNTER',0      ; DATA XREF: sub_412D77+117o
; char aPrivateDo1[]
aPrivateDo1	db 'PRIVATE-DO-1',0     ; DATA XREF: sub_412D77+146o
					; .data:004446F4o
; char aPrivateDo2[]
aPrivateDo2	db 'PRIVATE-DO-2',0     ; DATA XREF: sub_412D77+160o
					; .data:00444708o ...
; char aPrivateDo3[]
aPrivateDo3	db 'PRIVATE-DO-3',0     ; DATA XREF: sub_412D77+188o
					; .data:0044471Co ...
; char aPrivateDo4[]
aPrivateDo4	db 'PRIVATE-DO-4',0     ; DATA XREF: sub_412D77+1B0o
					; .data:00444730o ...
; char aOpenpgp_1[]
aOpenpgp_1	db 'OPENPGP.1',0        ; DATA XREF: sub_412F96+6o
					; sub_415770+42o ...
; char aOpenpgp_2[]
aOpenpgp_2	db 'OPENPGP.2',0        ; DATA XREF: sub_412F96:loc_412FBCo
					; sub_415770:loc_4157D2o ...
; char aOpenpgp_3[]
aOpenpgp_3	db 'OPENPGP.3',0        ; DATA XREF: sub_412F96:loc_412FDCo
					; sub_4130DB+18o ...
; char aChvno1Chvno2[]
aChvno1Chvno2	db 'chvno == 1 || chvno == 2',0 ; DATA XREF: sub_41327A+39o
; char aUsingDefaultPi[]
aUsingDefaultPi	db 'using default PIN as %s',0Ah,0 ; DATA XREF: sub_41327A+79o
aChv2		db 'CHV2',0             ; DATA XREF: sub_41327A+85o
					; sub_41327A+E1o
a123456		db '123456',0           ; DATA XREF: sub_41327A+A3o
; char aFailedToUseDef[]
aFailedToUseDef	db 'failed to use default PIN as %s: %s - disabling further default u'
					; DATA XREF: sub_41327A+D1o
		db 'se',0Ah,0
		align 10h
; char aPleaseEnterThe[]
aPleaseEnterThe	db '||Please enter the PIN%%0A[sigs done: %lu]',0
					; DATA XREF: sub_41327A+137o
					; sub_41327A:loc_4133FDo
; char aPleaseEnterT_0[]
aPleaseEnterT_0	db '||Please enter the PIN',0 ; DATA XREF: sub_41327A:loc_413431o
					; sub_414024:loc_4142BAo
		align 4
; char aPinCallbackRet[]
aPinCallbackRet	db 'PIN callback returned error: %s',0Ah,0 ; DATA XREF: sub_41327A+263o
					; sub_41327A+33Ao ...
; char aPinvalue[]
aPinvalue	db '!*pinvalue',0       ; DATA XREF: sub_41327A+2DCo
; char aPinForChvDIsTo[]
aPinForChvDIsTo	db 'PIN for CHV%d is too short; minimum length is %d',0Ah,0
					; DATA XREF: sub_41327A+382o
					; sub_413993+21Ao ...
; char aVerifyChvDFail[]
aVerifyChvDFail	db 'verify CHV%d failed: %s',0Ah,0 ; DATA XREF: sub_41327A+42Ao
					; sub_4136EE+112o ...
		align 4
; char aErrorRetrievin[]
aErrorRetrievin	db 'error retrieving CHV status from card',0Ah,0
					; DATA XREF: sub_41384F:loc_413898o
					; sub_414024:loc_4143E8o ...
; char aCardIsPermanen[]
aCardIsPermanen	db 'card is permanently locked!',0Ah,0 ; DATA XREF: sub_41384F+86o
					; sub_418416+2D7o
; char aDAdminPinAttem[]
aDAdminPinAttem	db '%d Admin PIN attempts remaining before card is permanently locked'
					; DATA XREF: sub_41384F+D0o
		db 0Ah,0
		align 4
; char aAPleaseEnterTh[]
aAPleaseEnterTh	db '|A|Please enter the Admin PIN%%0A[remaining attempts: %d]',0
					; DATA XREF: sub_41384F+F1o
; char aAPleaseEnter_0[]
aAPleaseEnter_0	db '|A|Please enter the Admin PIN',0 ; DATA XREF: sub_41384F:loc_413960o
; char aAccessToAdminC[]
aAccessToAdminC	db 'access to admin commands is not configured',0Ah,0
					; DATA XREF: sub_413993+18o
; char aFailedToSetSS[]
aFailedToSetSS	db 'failed to set `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_413C94+250o
; char aCert3[]
aCert3		db 'CERT-3',0           ; DATA XREF: sub_413F6C+A3o
					; .data:00444744o
		align 4
; char aResetCodeNotOr[]
aResetCodeNotOr	db 'Reset Code not or not anymore available',0Ah,0
					; DATA XREF: sub_414024+41Ao
		align 4
; char aPleaseEnterT_1[]
aPleaseEnterT_1	db '||Please enter the Reset Code for the card',0
					; DATA XREF: sub_414024:loc_414466o
		align 10h
; char aResetCodeIsToo[]
aResetCodeIsToo	db 'Reset Code is too short; minimum length is %d',0Ah,0
					; DATA XREF: sub_414024+4C3o
					; sub_414024+73Co
; char aRnNewResetCode[]
aRnNewResetCode	db '|RN|New Reset Code',0 ; DATA XREF: sub_414024+559o
; char aAnNewAdminPin[]
aAnNewAdminPin	db '|AN|New Admin PIN',0 ; DATA XREF: sub_414024+56Do
; char aNNewPin[]
aNNewPin	db '|N|New PIN',0       ; DATA XREF: sub_414024:loc_41459Fo
; char aErrorGettingNe[]
aErrorGettingNe	db 'error getting new PIN: %s',0Ah,0 ; DATA XREF: sub_414024+5B3o
; char aChvno1Chvno3[]
aChvno1Chvno3	db 'chvno == 1 || chvno == 3',0 ; DATA XREF: sub_414024+9E8o
		align 4
; char aPleaseEnterT_2[]
aPleaseEnterT_2	db '||Please enter the Admin PIN and New Admin PIN',0
					; DATA XREF: sub_414024+A07o
		align 4
; char aPleaseEnterT_3[]
aPleaseEnterT_3	db '||Please enter the PIN and New PIN',0
					; DATA XREF: sub_414024:loc_414A39o
; char aKeyidx0Keyidx2[]
aKeyidx0Keyidx2	db 'keyidx >=0 && keyidx <= 2',0 ; DATA XREF: sub_414C8D+22o
		align 4
; char aErrorReadingAp[]
aErrorReadingAp	db 'error reading application data',0Ah,0 ; DATA XREF: sub_414C8D+61o
					; sub_416E29+6Bo
; char aErrorReadingFi[]
aErrorReadingFi	db 'error reading fingerprint DO',0Ah,0 ; DATA XREF: sub_414C8D:loc_414D45o
					; sub_416E29+CDo
; char aKeyAlreadyExis[]
aKeyAlreadyExis	db 'key already exists',0Ah,0 ; DATA XREF: sub_414C8D+12Fo
		align 4
; char aExistingKeyWil[]
aExistingKeyWil	db 'existing key will be replaced',0Ah,0 ; DATA XREF: sub_414C8D+157o
; char aGeneratingNewK[]
aGeneratingNewK	db 'generating new key',0Ah,0 ; DATA XREF: sub_414C8D+173o
; char aWritingNewKey[]
aWritingNewKey	db 'writing new key',0Ah,0 ; DATA XREF: sub_414C8D:loc_414E16o
; char aTag0xffff[]
aTag0xffff	db 'tag <= 0xffff',0    ; DATA XREF: sub_414E31+25o
; char aRsa_e_lenRsa_e[]
aRsa_e_lenRsa_e	db 'rsa_e_len <= rsa_e_reqlen',0 ; DATA XREF: sub_414F0A+87o
; char aTpTemplateTemp[]
aTpTemplateTemp	db 'tp - template <= template_size',0 ; DATA XREF: sub_414F0A+52Do
		align 4
; char aErrorChangingS[]
aErrorChangingS	db 'error changing size of key %d to %u bits',0Ah,0
					; DATA XREF: sub_415465+175o
		align 10h
; char aSizeOfKeyDChan[]
aSizeOfKeyDChan	db 'size of key %d changed to %u bits',0Ah,0 ; DATA XREF: sub_415465+194o
; char aForceDDU[]
aForceDDU	db ' --force %d %d %u',0 ; DATA XREF: sub_415652+4Bo
aPrivateKey	db 'private-key',0      ; DATA XREF: sub_415770+18Do
aProtectedPriva	db 'protected-private-key',0 ; DATA XREF: sub_415770+1BEo
		align 4
; char aProtectedPri_0[]
aProtectedPri_0	db 'protected-private-key passed to writekey',0Ah,0
					; DATA XREF: sub_415770+1CEo
aShadowedPrivat	db 'shadowed-private-key',0 ; DATA XREF: sub_415770+1F2o
		align 4
; char aShadowedPriv_0[]
aShadowedPriv_0	db 'shadowed-private-key passed to writekey',0Ah,0
					; DATA XREF: sub_415770+202o
aRsa		db 'rsa',0              ; DATA XREF: sub_415770+2B7o
aCreatedAt	db 'created-at',0       ; DATA XREF: sub_415770+594o
; char aCreationTimest[]
aCreationTimest	db 'creation timestamp missing',0Ah,0 ; DATA XREF: sub_415770+6F2o
; char aRsaModulusSize[]
aRsaModulusSize	db 'RSA modulus size is %u bits (%u bytes)',0Ah,0
					; DATA XREF: sub_415770+770o
; char aRsaModulusMiss[]
aRsaModulusMiss	db 'RSA modulus missing or not of size %d bits',0Ah,0
					; DATA XREF: sub_415770+7F2o
; char aRsaPublicExpon[]
aRsaPublicExpon	db 'RSA public exponent missing or larger than %d bits',0Ah,0
					; DATA XREF: sub_415770+88Fo
; char aRsaPrimeSMissi[]
aRsaPrimeSMissi	db 'RSA prime %s missing or not of size %d bits',0Ah,0
					; DATA XREF: sub_415770+90Ao
					; sub_415770+96Fo
aP		db 'P',0                ; DATA XREF: sub_415770+91Ao
aQ		db 'Q',0                ; DATA XREF: sub_415770+97Fo
; char aRsa_e_len4[]
aRsa_e_len4	db 'rsa_e_len <= 4',0   ; DATA XREF: sub_415770+E6Ao
; char aTpTemplateTe_0[]
aTpTemplateTe_0	db 'tp - template == template_len',0 ; DATA XREF: sub_415770+FFFo
; char aFailedToStor_1[]
aFailedToStor_1	db 'failed to store the key: %s',0Ah,0 ; DATA XREF: sub_415770+1091o
		align 10h
; char aPleaseWaitWhil[]
aPleaseWaitWhil	db 'please wait while key is being generated ...',0Ah,0
					; DATA XREF: sub_4168B1:loc_416A4Do
; char aGeneratingKeyF[]
aGeneratingKeyF	db 'generating key failed',0Ah,0 ; DATA XREF: sub_4168B1+22Co
		align 4
; char aKeyGenerationC[]
aKeyGenerationC	db 'key generation completed (%d seconds)',0Ah,0
					; DATA XREF: sub_4168B1+256o
aN		db 'n',0                ; DATA XREF: sub_4168B1+320o
aE		db 'e',0                ; DATA XREF: sub_4168B1+393o
aKeyCreatedAt	db 'KEY-CREATED-AT',0   ; DATA XREF: sub_4168B1+414o
		align 4
; char aInvalidStructu[]
aInvalidStructu	db 'invalid structure of OpenPGP card (DO 0x93)',0Ah,0
					; DATA XREF: sub_416D67:loc_416DA5o
		align 4
; char aFingerprintOnC[]
aFingerprintOnC	db 'fingerprint on card does not match requested one',0Ah,0
					; DATA XREF: sub_416E29+12Co
		align 4
; char aCardDoesNotSup[]
aCardDoesNotSup	db 'card does not support digest algorithm %s',0Ah,0
					; DATA XREF: sub_4170F2+20Co
aD27600012401	db 'D27600012401',0     ; DATA XREF: sub_4170F2+2A2o
					; sub_417C15+8Bo ...
; char aDatalenSizeofD[]
aDatalenSizeofD	db 'datalen <= sizeof data',0 ; DATA XREF: sub_4170F2+4DEo
					; sub_4170F2+573o ...
		align 4
; char aSignaturesCrea[]
aSignaturesCrea	db 'signatures created so far: %lu',0Ah,0 ; DATA XREF: sub_4170F2+902o
; char aNoteCardsWithM[]
aNoteCardsWithM	db 'NOTE: Cards with manufacturer id 5 and s/n <= 346 (0x15a) do not '
					; DATA XREF: sub_417F4C+4B4o
		db 'work with encryption keys > 2048 bits',0Ah,0
; char aChv3[]
aChv3		db '[CHV3]',0           ; DATA XREF: sub_418416+10Bo
		align 4
; char aVerificationOf[]
aVerificationOf	db 'verification of Admin PIN is currently prohibited through this co'
					; DATA XREF: sub_418416+2FFo
		db 'mmand',0Ah,0
aYes		db 'yes',0              ; DATA XREF: sub_41877F+14o
					; sub_41877F+3Eo ...
aNo		db 'no',0               ; DATA XREF: sub_41877F:loc_41879Ao
					; sub_41877F:loc_4187C4o ...
; char aVersion2______[]
aVersion2______	db 'Version-2 ......: %s',0Ah,0 ; DATA XREF: sub_41877F+24o
; char aGetChallenge__[]
aGetChallenge__	db 'Get-Challenge ..: %s',0 ; DATA XREF: sub_41877F+4Eo
; char aUBytesMax[]
aUBytesMax	db ' (%u bytes max)',0  ; DATA XREF: sub_41877F+76o
; char aKeyImport_____[]
aKeyImport_____	db 'Key-Import .....: %s',0Ah,0 ; DATA XREF: sub_41877F+A0o
; char aChangeForcePw1[]
aChangeForcePw1	db 'Change-Force-PW1: %s',0Ah,0 ; DATA XREF: sub_41877F+CAo
; char aPrivateDos____[]
aPrivateDos____	db 'Private-DOs ....: %s',0Ah,0 ; DATA XREF: sub_41877F+F4o
; char aAlgoAttrChange[]
aAlgoAttrChange	db 'Algo-Attr-Change: %s',0Ah,0 ; DATA XREF: sub_41877F+11Eo
; char aSmSupport_____[]
aSmSupport_____	db 'SM-Support .....: %s',0 ; DATA XREF: sub_41877F+148o
aAes128		db 'AES-128',0          ; DATA XREF: sub_41877F+170o
a3des		db '3DES',0             ; DATA XREF: sub_41877F:loc_4188F6o
; char aS_1[]
aS_1		db ' (%s)',0            ; DATA XREF: sub_41877F+180o
; char aMaxCert3Len__U[]
aMaxCert3Len__U	db 'Max-Cert3-Len ..: %u',0Ah,0 ; DATA XREF: sub_41877F+19Ao
; char aMaxCmdData___U[]
aMaxCmdData___U	db 'Max-Cmd-Data ...: %u',0Ah,0 ; DATA XREF: sub_41877F+1B4o
; char aMaxRspData___U[]
aMaxRspData___U	db 'Max-Rsp-Data ...: %u',0Ah,0 ; DATA XREF: sub_41877F+1CEo
; char aCmdChaining___[]
aCmdChaining___	db 'Cmd-Chaining ...: %s',0Ah,0 ; DATA XREF: sub_41877F+1F8o
; char aExtLcLe____[]
aExtLcLe______S	db 'Ext-Lc-Le ......: %s',0Ah,0 ; DATA XREF: sub_41877F+222o
; char aStatusIndicato[]
aStatusIndicato	db 'Status Indicator: %02X',0Ah,0 ; DATA XREF: sub_41877F+23Co
; char aGnupgNoSync[]
aGnupgNoSync__S	db 'GnuPG-No-Sync ..: %s',0Ah,0 ; DATA XREF: sub_41877F+266o
; char aGnupgDefPw2[]
aGnupgDefPw2__S	db 'GnuPG-Def-PW2 ..: %s',0Ah,0 ; DATA XREF: sub_41877F+290o
; char aWarningHistori[]
aWarningHistori	db 'warning: historical bytes are too short',0Ah,0
					; DATA XREF: sub_418A1D+Co
		align 10h
; char aWarningBadCate[]
aWarningBadCate	db 'warning: bad category indicator in historical bytes',0Ah,0
					; DATA XREF: sub_418A1D+27o
		align 4
; char aWarningBadComp[]
aWarningBadComp	db 'warning: bad Compact-TLV in historical bytes',0Ah,0
					; DATA XREF: sub_418A1D+84o
; char aErrorReadingDo[]
aErrorReadingDo	db 'error reading DO 0x%02X',0Ah,0 ; DATA XREF: sub_418B26+B4o
					; sub_418B26+D8o
; char aKeyAttrS__[]
aKeyAttrS__	db 'Key-Attr-%s ..: ',0 ; DATA XREF: sub_418B26+110o
aCrtN		db 'crt+n',0            ; DATA XREF: sub_418B26+2EBo
a?		db '?',0                ; DATA XREF: sub_418B26:loc_418E18o
aCrt		db 'crt',0              ; DATA XREF: sub_418B26:loc_418E1Fo
aStdN		db 'std+n',0            ; DATA XREF: sub_418B26:loc_418E26o
aStd		db 'std',0              ; DATA XREF: sub_418B26:loc_418E2Fo
; char aRsaNUEUFmtS[]
aRsaNUEUFmtS	db 'RSA, n=%u, e=%u, fmt=%s',0Ah,0 ; DATA XREF: sub_418B26+34Co
aOpenpgp_0	db 'OPENPGP',0          ; DATA XREF: sub_418EB5+42o
; char aAid[]
aAid		db 'AID: ',0            ; DATA XREF: sub_418EB5+B9o
; char aHistoricalByte[]
aHistoricalByte	db 'Historical Bytes: ',0 ; DATA XREF: sub_418EB5+205o
; char aCanTAccessSInv[]
aCanTAccessSInv	db 'can',27h,'t access %s - invalid OpenPGP card?',0Ah,0
					; DATA XREF: sub_418EB5+284o
					; sub_418EB5+319o
aExtendedCapabi	db 'Extended Capability Flags',0 ; DATA XREF: sub_418EB5+325o
aV_0		db 'v',0               ; DATA XREF: sub_418EB5+1Fo
		dw 2401h
		db 1
aChvStatus1	db 'CHV-STATUS-1',0     ; DATA XREF: .data:004446A4o
aCaFpr1		db 'CA-FPR-1',0         ; DATA XREF: .data:004446B8o
aCaFpr2		db 'CA-FPR-2',0         ; DATA XREF: .data:004446CCo
aCaFpr3		db 'CA-FPR-3',0         ; DATA XREF: .data:004446E0o
aSmKeyEnc	db 'SM-KEY-ENC',0
aSmKeyMac	db 'SM-KEY-MAC',0
aKeyAttr	db 'KEY-ATTR',0
aAuthkeyid_1	db '$AUTHKEYID',0       ; DATA XREF: .data:00444898o
aDispserialno_0	db '$DISPSERIALNO',0
		align 4
aV_2		db 'v',0               ; DATA XREF: sub_41C19D+ACo
					; sub_41C3FB+20o
		align 10h
		db 3, 1, 2
byte_44B6C3	db 0D2h			; DATA XREF: sub_41C19D+81o
		dd 66000076h, 1
aPublicKeyRsaNB	db '(public-key (rsa (n %b) (e %b)))',0 ; DATA XREF: sub_4195EC+322o
aD_3		db '%d',0               ; DATA XREF: sub_419AE2+118o
					; sub_419DB2+EFo
aDDDD		db '%d %d %d %d',0      ; DATA XREF: sub_419AE2+23Do
aSigg		db 'SIGG',0             ; DATA XREF: sub_419DB2+11o
aDf01		db 'DF01',0             ; DATA XREF: sub_419DB2+27o
aNks3		db 'NKS3',0             ; DATA XREF: sub_419DB2:loc_419DE2o
aNksS_04x	db 'NKS-%s.%04X',0      ; DATA XREF: sub_419DB2+123o
					; sub_419DB2+260o
aCertinfo	db 'CERTINFO',0         ; DATA XREF: sub_419DB2+1B7o
; char aCanTGetKeygrip[]
aCanTGetKeygrip	db 'can',27h,'t get keygrip from FID 0x%04X: %s',0Ah,0
					; DATA XREF: sub_419DB2+236o
aKeypairinfo_1	db 'KEYPAIRINFO',0      ; DATA XREF: sub_419DB2+2D6o
aNksNks3_	db 'NKS-NKS3.',0        ; DATA XREF: sub_41A15B+2Do
					; sub_41AEE6+5Eo ...
aNksDf01_	db 'NKS-DF01.',0        ; DATA XREF: sub_41A15B+55o
					; sub_41AEE6+86o ...
aNksSigg_	db 'NKS-SIGG.',0        ; DATA XREF: sub_41A15B+7Do
					; sub_41AEE6+AEo ...
		align 4
; char aErrorSelecti_0[]
aErrorSelecti_0	db 'error selecting FID 0x%04X: %s',0Ah,0 ; DATA XREF: sub_41A15B+462o
; char aErrorReading_0[]
aErrorReading_0	db 'error reading certificate from FID 0x%04X: %s',0Ah,0
					; DATA XREF: sub_41A15B+4C1o
		align 4
; char aNoCertificat_0[]
aNoCertificat_0	db 'no certificate contained in FID 0x%04X',0Ah,0
					; DATA XREF: sub_41A15B+4EDo
; char a____Gnupg22__3[]
a____Gnupg22__3	db '../../gnupg2-2.0.30/scd/app-nks.c',0 ; DATA XREF: sub_41A15B+5CBo
					; sub_41A15B+73Ao ...
; char aTotobjlenBufle[]
aTotobjlenBufle	db 'totobjlen <= buflen',0 ; DATA XREF: sub_41A15B+5D3o
		align 4
; char aSave_pTotobjle[]
aSave_pTotobjle	db 'save_p + totobjlen <= buffer + buflen',0 ; DATA XREF: sub_41A15B+742o
; char aIfdauthkey[]
aIfdauthkey	db '$IFDAUTHKEY',0      ; DATA XREF: sub_41A8F7+Eo
					; sub_41AAB8+1Do
		align 4
; char aRsaModulusMi_0[]
aRsaModulusMi_0	db 'RSA modulus missing or not of size %d bits',0Ah,0
					; DATA XREF: sub_41AAB8+E8o
; char aRsaPublicExp_0[]
aRsaPublicExp_0	db 'RSA public exponent missing or larger than %d bits',0Ah,0
					; DATA XREF: sub_41AAB8:loc_41ABEEo
; char aPinIsTooShortM[]
aPinIsTooShortM	db 'PIN is too short; minimum length is %d',0Ah,0
					; DATA XREF: sub_41AC32+34o
; char aPinIsTooLargeM[]
aPinIsTooLargeM	db 'PIN is too large; maximum length is %d',0Ah,0
					; DATA XREF: sub_41AC32+7Bo
aPin		db 'PIN',0              ; DATA XREF: sub_41ACD2+Eo
; char aPinCallbackR_0[]
aPinCallbackR_0	db 'PIN callback returned error: %s',0Ah,0 ; DATA XREF: sub_41ACD2+A3o
					; sub_41ACD2+133o
		align 10h
; char aTheNullpinHasN[]
aTheNullpinHasN	db 'the NullPIN has not yet been changed',0Ah,0 ; DATA XREF: sub_41ACD2+1E1o
; char aVerifyPinFaile[]
aVerifyPinFaile	db 'verify PIN failed',0Ah,0 ; DATA XREF: sub_41ACD2:loc_41AEC9o
		align 4
; char aMassSignatureC[]
aMassSignatureC	db 'mass signature cards are not allowed',0Ah,0 ; DATA XREF: sub_41AEE6+125o
; char aIndatalenSizeo[]
aIndatalenSizeo	db 'indatalen <= sizeof data',0 ; DATA XREF: sub_41AEE6+4BAo
		align 4
off_44B9AC	dd offset loc_41AF3E, offset loc_41AF2D, offset	loc_41AF2D
					; DATA XREF: sub_41AEE6+3Er
		dd offset loc_41AF2D, offset loc_41AF3E, offset	loc_41AF2D ; jump table	for switch statement
		dd offset loc_41AF2D, offset loc_41AF2D, offset	loc_41AF2D
		dd offset loc_41AF2D, offset loc_41AF2D, offset	loc_41AF2D
		dd offset loc_41AF2D, offset loc_41AF2D, offset	loc_41AF2D
		dd offset loc_41AF2D, offset loc_41AF2D, offset	loc_41AF2D
		dd offset loc_41AF2D, offset loc_41AF3E, offset	loc_41AF2D
		dd offset loc_41AF2D, offset loc_41AF2D, offset	loc_41AF2D
		dd offset loc_41AF2D, offset loc_41AF2D, offset	loc_41AF2D
		dd offset loc_41AF2D, offset loc_41AF2D, offset	loc_41AF2D
		dd offset loc_41AF2D, offset loc_41AF3E, offset	loc_41AF2D
		dd offset loc_41AF2D, offset loc_41AF2D, offset	loc_41AF3E
		dd offset loc_41AF2D, offset loc_41AF2D, offset	loc_41AF2D
		dd offset loc_41AF2D, offset loc_41AF2D, offset	loc_41AF2D
		dd offset loc_41AF2D, offset loc_41AF2D, offset	loc_41AF2D
		dd offset loc_41AF2D, offset loc_41AF2D, offset	loc_41AF2D
		dd offset loc_41AF2D, offset loc_41AF2D, offset	loc_41AF2D
		dd offset loc_41AF3E, offset loc_41AF2D, offset	loc_41AF2D
		dd offset loc_41AF2D, offset loc_41AF2D, offset	loc_41AF2D
		dd offset loc_41AF2D, offset loc_41AF2D, offset	loc_41AF2D
		dd offset loc_41AF2D, offset loc_41AF2D, offset	loc_41AF2D
		dd offset loc_41AF2D, offset loc_41AF2D, offset	loc_41AF2D
		dd offset loc_41AF2D, offset loc_41AF3E
; char aPw1_ch[]
aPw1_ch		db 'PW1.CH',0           ; DATA XREF: sub_41BB36:loc_41BB4Eo
					; sub_41BC8F+ECo ...
		align 4
; char aNPleaseEnterAN[]
aNPleaseEnterAN	db '|N|Please enter a new PIN for the standard keys.',0
					; DATA XREF: sub_41BB36+47o
		align 4
; char aPleaseEnterT_4[]
aPleaseEnterT_4	db '||Please enter the PIN for the standard keys.',0
					; DATA XREF: sub_41BB36:loc_41BB8Bo
; char aPw2_ch[]
aPw2_ch		db 'PW2.CH',0           ; DATA XREF: sub_41BB36:loc_41BB9Fo
					; sub_41BC8F+103o ...
		align 10h
; char aNpPleaseEnterA[]
aNpPleaseEnterA	db '|NP|Please enter a new PIN Unblocking Code (PUK) for the standard'
					; DATA XREF: sub_41BB36+8Fo
		db ' keys.',0
; char aPPleaseEnterTh[]
aPPleaseEnterTh	db '|P|Please enter the PIN Unblocking Code (PUK) for the standard ke'
					; DATA XREF: sub_41BB36:loc_41BBD3o
		db 'ys.',0
; char aPw1_ch_sig[]
aPw1_ch_sig	db 'PW1.CH.SIG',0       ; DATA XREF: sub_41BB36:loc_41BBE7o
					; sub_41BC8F:loc_41BDBBo ...
; char aNPleaseEnter_0[]
aNPleaseEnter_0	db '|N|Please enter a new PIN for the key to create qualified signatu'
					; DATA XREF: sub_41BB36+E0o
		db 'res.',0
		align 10h
; char aPleaseEnterT_5[]
aPleaseEnterT_5	db '||Please enter the PIN for the key to create qualified signatures'
					; DATA XREF: sub_41BB36:loc_41BC24o
		db '.',0
; char aPw2_ch_sig[]
aPw2_ch_sig	db 'PW2.CH.SIG',0       ; DATA XREF: sub_41BB36:loc_41BC35o
					; sub_41BC8F+143o ...
		align 10h
; char aNpPleaseEnte_0[]
aNpPleaseEnte_0	db '|NP|Please enter a new PIN Unblocking Code (PUK) for the key to c'
					; DATA XREF: sub_41BB36+12Eo
		db 'reate qualified signatures.',0
		align 10h
; char aPPleaseEnter_0[]
aPPleaseEnter_0	db '|P|Please enter the PIN Unblocking Code (PUK) for the key to crea'
					; DATA XREF: sub_41BB36:loc_41BC72o
		db 'te qualified signatures.',0
; char aErrorGettingOl[]
aErrorGettingOl	db 'error getting old PIN: %s',0Ah,0 ; DATA XREF: sub_41BC8F+1FBo
; char aErrorGetting_0[]
aErrorGetting_0	db 'error getting new PIN: %s',0Ah,0 ; DATA XREF: sub_41BC8F+283o
dword_44BD50	dd 6AA80h		; DATA XREF: sub_41C124+2Bo
		db 2 dup(0)
aSigg_0		db 'SigG',0             ; DATA XREF: sub_41C19D+49o
					; sub_41C19D+239o
aNks_0		db 'NKS',0              ; DATA XREF: sub_41C19D:loc_41C1EDo
					; sub_41C19D:loc_41C3DDo ...
; char aAppNksSwitchin[]
aAppNksSwitchin	db 'app-nks: switching to %s',0Ah,0 ; DATA XREF: sub_41C19D+59o
byte_44BD79	db 93h,	2, 0		; DATA XREF: sub_41C19D+1BDo
		dd 8306A401h, 1838101h,	83h
; char aThisIsAMassSig[]
aThisIsAMassSig	db 'This is a mass signature card',0Ah,0 ; DATA XREF: sub_41C19D+1F9o
		align 4
; char aAppNksErrorSwi[]
aAppNksErrorSwi	db 'app-nks: error switching to %s: %s',0Ah,0 ; DATA XREF: sub_41C19D+24Do
; char aDetectedNksVer[]
aDetectedNksVer	db 'Detected NKS version: %d',0Ah,0 ; DATA XREF: sub_41C3FB+B9o
word_44BDE6	dw 180h			; DATA XREF: sub_41B5EF+490o
		dd 81018410h
aAuthkeyid_0	db '$AUTHKEYID',0       ; DATA XREF: .data:Str1o
aNksVersion	db 'NKS-VERSION',0      ; DATA XREF: .data:00444AE8o
aChvStatus_0	db 'CHV-STATUS',0
		align 10h
; char aD_4[3]
aD_4		db '%d',0               ; DATA XREF: sub_41C5AB:loc_41C5EFo
; char aDinsig_04x[]
aDinsig_04x	db 'DINSIG.%04X',0      ; DATA XREF: sub_41C5AB+60o
					; sub_41C5AB+282o
aCertinfo_0	db 'CERTINFO',0         ; DATA XREF: sub_41C5AB+F4o
; char aErrorReadingEn[]
aErrorReadingEn	db 'error reading entire certificate from FID 0x%04X: %s',0Ah,0
					; DATA XREF: sub_41C5AB+163o
		align 10h
; char aFailedToPars_0[]
aFailedToPars_0	db 'failed to parse the certificate at FID 0x%04X: %s',0Ah,0
					; DATA XREF: sub_41C5AB+1FFo
		align 4
; char aFailedToCalcul[]
aFailedToCalcul	db 'failed to calculate the keygrip for FID 0x%04X',0Ah,0
					; DATA XREF: sub_41C5AB+249o
aKeypairinfo_2	db 'KEYPAIRINFO',0      ; DATA XREF: sub_41C5AB+2F8o
aDinsig_	db 'DINSIG.',0          ; DATA XREF: sub_41C8C5+26o
					; sub_41D35C+5Do
; char aErrorSelecti_1[]
aErrorSelecti_1	db 'error selecting FID 0x%04X: %s',0Ah,0 ; DATA XREF: sub_41C8C5+35Do
; char aErrorReading_1[]
aErrorReading_1	db 'error reading certificate from FID 0x%04X: %s',0Ah,0
					; DATA XREF: sub_41C8C5+3BCo
		align 4
; char aNoCertificat_1[]
aNoCertificat_1	db 'no certificate contained in FID 0x%04X',0Ah,0
					; DATA XREF: sub_41C8C5+3E8o
; char a____Gnupg22__4[]
a____Gnupg22__4	db '../../gnupg2-2.0.30/scd/app-dinsig.c',0 ; DATA XREF: sub_41C8C5+4C6o
					; sub_41C8C5+635o
; char aTotobjlenBuf_0[]
aTotobjlenBuf_0	db 'totobjlen <= buflen',0 ; DATA XREF: sub_41C8C5+4CEo
		align 4
; char aSave_pTotobj_0[]
aSave_pTotobj_0	db 'save_p + totobjlen <= buffer + buflen',0 ; DATA XREF: sub_41C8C5+63Do
		align 4
; char aPleaseEnterYou[]
aPleaseEnterYou	db '||Please enter your PIN at the reader',27h,'s pinpad',0
					; DATA XREF: sub_41CF5C+8Co
		align 4
; char aPinCallbackR_1[]
aPinCallbackR_1	db 'PIN callback returned error: %s',0Ah,0 ; DATA XREF: sub_41CF5C+C5o
					; sub_41CF5C+157o
aPin_0		db 'PIN',0              ; DATA XREF: sub_41CF5C+12Co
		align 4
; char aNonNumericDigi[]
aNonNumericDigi	db 'Non-numeric digits found in PIN',0Ah,0 ; DATA XREF: sub_41CF5C+195o
		align 10h
; char aPinIsTooShor_0[]
aPinIsTooShor_0	db 'PIN is too short; minimum length is %d',0Ah,0
					; DATA XREF: sub_41CF5C+1EAo
; char aPinIsTooLarg_0[]
aPinIsTooLarg_0	db 'PIN is too large; maximum length is %d',0Ah,0
					; DATA XREF: sub_41CF5C+23Fo
; char aVerifyPinFai_0[]
aVerifyPinFai_0	db 'verify PIN failed',0Ah,0 ; DATA XREF: sub_41CF5C+3D6o
aDinsig_0	db 'DINSIG',0           ; DATA XREF: sub_41D8DA+3Eo
aV_1		db 'v',0               ; DATA XREF: sub_41D8DA+1Fo
		align 2
		dw 166h
		dd 13BA3Bh, 5D863181h, 0A056400h, 80310102h, 8B0090h, 14BA3Bh
		dd 5D863181h, 14056400h, 80310202h, 910090h, 96BA3Bh, 5D863181h
		dd 60056400h, 80310302h, 660090h, 94FF3Bh, 0FEB180FFh
		dd 31F45h, 76D268h, 5FF2800h, 80311Eh, 230090h,	0FF006F3Bh
		dd 76D26800h, 0FF280000h, 80311E05h, 9000h, 94FE3Bh, 0FAB180FFh
		dd 45031F45h, 49457473h, 65762044h, 2E312072h
		db 30h,	43h, 0
byte_44C127	db 0A0h			; DATA XREF: sub_4243A0+E2o
					; sub_4245B2+3Ao
		dd 63000000h, 53434B50h
a15a		db '-15',0             ; DATA XREF: sub_4243A0+108o
		align 2
		dw 7701h
aPkcs15		db 'PKCS-15',0
; char aErrorSelecti_2[]
aErrorSelecti_2	db 'error selecting %s (0x%04X): %s',0Ah,0 ; DATA XREF: sub_41DB8C+5Fo
		align 4
; char aErrorReadingS0[]
aErrorReadingS0	db 'error reading %s (0x%04X): %s',0Ah,0 ; DATA XREF: sub_41DB8C+C0o
		align 4
; char aWarningRelativ[]
aWarningRelativ	db 'WARNING: relative path selection not yet implemented',0Ah,0
					; DATA XREF: sub_41DC64+2Fo
; char aErrorSelecti_3[]
aErrorSelecti_3	db 'error selecting path ',0 ; DATA XREF: sub_41DC64+8Bo
; char a04hx[]
a04hx		db '%04hX',0            ; DATA XREF: sub_41DC64+B2o
					; sub_41DC64+173o ...
; char aS_2[]
aS_2		db ': %s',0Ah,0         ; DATA XREF: sub_41DC64+D9o
					; sub_41DC64+19Ao ...
; char aErrorSelecti_4[]
aErrorSelecti_4	db 'error selecting part %d from path ',0 ; DATA XREF: sub_41DC64+14Co
; char aP1504hx_[]
aP1504hx_	db 'P15-%04hX.',0       ; DATA XREF: sub_41DE26+33o
; char aP15_[]
aP15_		db 'P15.',0             ; DATA XREF: sub_41DE26:loc_41DE73o
					; sub_41DE26+A5o
; char aP15_0[]
aP15_0		db 'P15-',0             ; DATA XREF: sub_41DE26+C8o
aOdf		db 'ODF',0              ; DATA XREF: sub_41E421+25o
; char aErrorOdfTooSho[]
aErrorOdfTooSho	db 'error: ODF too short',0Ah,0 ; DATA XREF: sub_41E421+52o
word_44C22E	dw 3006h		; DATA XREF: sub_41E421+B0o
		dd 20404h
dword_44C234	dd 408300Ah, 3F06h	; DATA XREF: sub_41E421+FBo
; char aOdfFormatIsNot[]
aOdfFormatIsNot	db 'ODF format is not supported by us',0Ah,0
					; DATA XREF: sub_41E421:loc_41E568o
		align 10h
; char aDuplicateObjec[]
aDuplicateObjec	db 'duplicate object type %d in ODF ignored',0Ah,0
					; DATA XREF: sub_41E421+23Eo
		align 4
; char aUnknownObjectT[]
aUnknownObjectT	db 'unknown object type %d in ODF ignored',0Ah,0
					; DATA XREF: sub_41E421+33Bo
		align 4
; char aWarningUBytesO[]
aWarningUBytesO	db 'warning: %u bytes of garbage detected at end of ODF',0Ah,0
					; DATA XREF: sub_41E421+392o
		align 4
off_44C2EC	dd offset loc_41E5AE	; DATA XREF: sub_41E421+184r
		dd offset loc_41E5C1	; jump table for switch	statement
		dd offset loc_41E5D1
		dd offset loc_41E5E1
		dd offset loc_41E5F1
		dd offset loc_41E601
		dd offset loc_41E611
		dd offset loc_41E621
		dd offset loc_41E631
off_44C310	dd offset loc_41E6B6	; DATA XREF: sub_41E421+28Cr
		dd offset loc_41E6C9	; jump table for switch	statement
		dd offset loc_41E6DC
		dd offset loc_41E6EC
		dd offset loc_41E6FC
		dd offset loc_41E70C
		dd offset loc_41E71C
		dd offset loc_41E72C
		dd offset loc_41E73C
aPrkdf		db 'PrKDF',0            ; DATA XREF: sub_41E9ED+57o
		align 4
; char aErrorParsingPr[]
aErrorParsingPr	db 'error parsing PrKDF record: %s',0Ah,0 ; DATA XREF: sub_41E9ED+13Ao
aEcKeyObjectsAr	db 'EC key objects are not supported',0 ; DATA XREF: sub_41E9ED:loc_41F4B3o
		align 10h
aDhKeyObjectsAr	db 'DH key objects are not supported',0 ; DATA XREF: sub_41E9ED:loc_41F4BCo
		align 4
aDsaKeyObjectsA	db 'DSA key objects are not supported',0 ; DATA XREF: sub_41E9ED:loc_41F4C5o
		align 4
aKeaKeyObjectsA	db 'KEA key objects are not supported',0 ; DATA XREF: sub_41E9ED:loc_41F4CEo
aUnknownPrivate	db 'unknown privateKeyObject',0 ; DATA XREF: sub_41E9ED:loc_41F4D7o
					; sub_4206B5:loc_420DEEo
aUnsupportedRef	db 'unsupported reference type',0 ; DATA XREF: sub_41E9ED:loc_41F584o
					; sub_41FD2E:loc_4201E9o
aInvalidPathRef	db 'invalid path reference',0 ; DATA XREF: sub_41E9ED:loc_41F62Do
					; sub_41FD2E:loc_420292o ...
; char aPrkdf04hxId[]
aPrkdf04hxId	db 'PrKDF %04hX: id=',0 ; DATA XREF: sub_41E9ED+F71o
; char a02x_0[]
a02x_0		db '%02X',0             ; DATA XREF: sub_41E9ED+F9Bo
					; sub_41E9ED+105Co ...
; char aPath[]
aPath		db ' path=',0           ; DATA XREF: sub_41E9ED+FB8o
					; sub_41FD2E+851o ...
; char aLuLu[]
aLuLu		db '[%lu/%lu]',0        ; DATA XREF: sub_41E9ED+101Co
					; sub_41FD2E+8B6o ...
; char aAuthid[]
aAuthid		db ' authid=',0         ; DATA XREF: sub_41E9ED+1032o
					; sub_4206B5+14D1o
; char aKeyref0x02lx[]
aKeyref0x02lx	db ' keyref=0x%02lX',0  ; DATA XREF: sub_41E9ED+108Do
; char aUsage[]
aUsage		db ' usage=',0          ; DATA XREF: sub_41E9ED:loc_41FA86o
byte_44C47D	db 0			; DATA XREF: sub_41E9ED+10A5o
					; sub_4206B5+1524o
; char aSencrypt[]
aSencrypt	db '%sencrypt',0        ; DATA XREF: sub_41E9ED+10C1o
asc_44C488	db ',',0                ; DATA XREF: sub_41E9ED+10CDo
					; sub_41E9ED+10F5o ...
; char aSdecrypt[]
aSdecrypt	db '%sdecrypt',0        ; DATA XREF: sub_41E9ED+10E9o
; char aSsign[]
aSsign		db '%ssign',0           ; DATA XREF: sub_41E9ED+1111o
; char aSsign_recover[]
aSsign_recover	db '%ssign_recover',0   ; DATA XREF: sub_41E9ED+1139o
; char aSwrap[]
aSwrap		db '%swrap',0           ; DATA XREF: sub_41E9ED+1161o
; char aSunwrap[]
aSunwrap	db '%sunwrap',0         ; DATA XREF: sub_41E9ED+1189o
; char aSverify[]
aSverify	db '%sverify',0         ; DATA XREF: sub_41E9ED+11B1o
; char aSverify_recove[]
aSverify_recove	db '%sverify_recover',0 ; DATA XREF: sub_41E9ED+11D9o
; char aSderive[]
aSderive	db '%sderive',0         ; DATA XREF: sub_41E9ED+1201o
; char aSnon_repudiati[]
aSnon_repudiati	db '%snon_repudiation',0 ; DATA XREF: sub_41E9ED+1229o
; char asc_44C4EF[]
asc_44C4EF	db 0Ah,0		; DATA XREF: sub_41E9ED:loc_41FC29o
					; sub_41FD2E:loc_4205F0o ...
		align 4
; char aErrorParsing_0[]
aErrorParsing_0	db 'error parsing PrKDF record (%d): %s - skipped',0Ah,0
					; DATA XREF: sub_41E9ED+12B7o
aCdf		db 'CDF',0              ; DATA XREF: sub_41FD2E+4Eo
; char aErrorParsingCd[]
aErrorParsingCd	db 'error parsing CDF record: %s',0Ah,0 ; DATA XREF: sub_41FD2E+115o
; char aCdf04hxId[]
aCdf04hxId	db 'CDF %04hX: id=',0   ; DATA XREF: sub_41FD2E+80Ao
; char aErrorParsing_1[]
aErrorParsing_1	db 'error parsing CDF record (%d): %s - skipped',0Ah,0
					; DATA XREF: sub_41FD2E+91Fo
aAodf		db 'AODF',0             ; DATA XREF: sub_4206B5+57o
		align 4
; char aErrorParsingAo[]
aErrorParsingAo	db 'error parsing AODF record: %s',0Ah,0 ; DATA XREF: sub_4206B5+11Eo
		align 4
aBiometricAuthT	db 'biometric auth types are not supported',0 ; DATA XREF: sub_4206B5+71Eo
		align 10h
aAuthkeyAuthTyp	db 'authKey auth types are not supported',0
					; DATA XREF: sub_4206B5:loc_420DDCo
		align 4
aExternalAuthTy	db 'external auth type are not supported',0
					; DATA XREF: sub_4206B5:loc_420DE5o
aPadcharIsNotOf	db 'padChar is not of size(1)',0 ; DATA XREF: sub_4206B5+FE0o
; char aAodf04hxId[]
aAodf04hxId	db 'AODF %04hX: id=',0  ; DATA XREF: sub_4206B5+1480o
; char aFlags[]
aFlags		db ' flags=',0          ; DATA XREF: sub_4206B5:loc_421BCDo
; char aScase_sensitiv[]
aScase_sensitiv	db '%scase_sensitive',0 ; DATA XREF: sub_4206B5+1540o
; char aSlocal[]
aSlocal		db '%slocal',0          ; DATA XREF: sub_4206B5+1568o
; char aSchange_disabl[]
aSchange_disabl	db '%schange_disabled',0 ; DATA XREF: sub_4206B5+1590o
; char aSunblock_disab[]
aSunblock_disab	db '%sunblock_disabled',0 ; DATA XREF: sub_4206B5+15B8o
; char aSinitialized[]
aSinitialized	db '%sinitialized',0    ; DATA XREF: sub_4206B5+15E0o
; char aSneeds_padding[]
aSneeds_padding	db '%sneeds_padding',0  ; DATA XREF: sub_4206B5+1608o
; char aSunblocking_pi[]
aSunblocking_pi	db '%sunblocking_pin',0 ; DATA XREF: sub_4206B5+1630o
; char aSso_pin[]
aSso_pin	db '%sso_pin',0         ; DATA XREF: sub_4206B5+1658o
; char aSdisable_allow[]
aSdisable_allow	db '%sdisable_allowed',0 ; DATA XREF: sub_4206B5+1680o
; char aSintegrity_pro[]
aSintegrity_pro	db '%sintegrity_protected',0 ; DATA XREF: sub_4206B5+16A8o
; char aSconfidentiali[]
aSconfidentiali	db '%sconfidentiality_protected',0 ; DATA XREF: sub_4206B5+16D0o
; char aSexchange_ref_[]
aSexchange_ref_	db '%sexchange_ref_data',0 ; DATA XREF: sub_4206B5+16F8o
aBcd		db 'bcd',0              ; DATA XREF: sub_4206B5:loc_421DD4o
aAsciiNumeric	db 'ascii-numeric',0    ; DATA XREF: sub_4206B5:loc_421DDDo
aUtf8		db 'utf8',0             ; DATA XREF: sub_4206B5:loc_421DE6o
aHalfNibbleBcd	db 'half-nibble-bcd',0  ; DATA XREF: sub_4206B5:loc_421DEFo
aIso95641	db 'iso9564-1',0        ; DATA XREF: sub_4206B5:loc_421DF8o
; char aLu_1[]
aLu_1		db '%lu',0              ; DATA XREF: sub_4206B5+1752o
; char aTypeS_0[]
aTypeS_0	db ' type=%s',0         ; DATA XREF: sub_4206B5+177Do
; char aMinLu[]
aMinLu		db ' min=%lu',0         ; DATA XREF: sub_4206B5+1793o
; char aStoredLu[]
aStoredLu	db ' stored=%lu',0      ; DATA XREF: sub_4206B5+17A9o
; char aMaxLu[]
aMaxLu		db ' max=%lu',0         ; DATA XREF: sub_4206B5+17C9o
; char aPad0x02x[]
aPad0x02x	db ' pad=0x%02x',0      ; DATA XREF: sub_4206B5+17EDo
; char aPinref0x02lx[]
aPinref0x02lx	db ' pinref=0x%02lX',0  ; DATA XREF: sub_4206B5+180Do
		align 4
; char aErrorParsing_2[]
aErrorParsing_2	db 'error parsing AODF record (%d): %s - skipped',0Ah,0
					; DATA XREF: sub_4206B5+1939o
		align 4
off_44C7C8	dd offset loc_421DD4	; DATA XREF: sub_4206B5+1716r
		dd offset loc_421DDD	; jump table for switch	statement
		dd offset loc_421DE6
		dd offset loc_421DEF
		dd offset loc_421DF8
aTokeninfo	db 'TokenInfo',0        ; DATA XREF: sub_422056+22o
; char aErrorParsingTo[]
aErrorParsingTo	db 'error parsing TokenInfo: %s',0Ah,0 ; DATA XREF: sub_422056+DAo
		align 4
; char aInvalidVersion[]
aInvalidVersion	db 'invalid version %lu in TokenInfo',0Ah,0 ; DATA XREF: sub_422056+1AEo
		align 4
aSerialnumberFr	db 'Serialnumber from EF(TokenInfo) is:',0 ; DATA XREF: sub_422056+2C4o
; char a____Gnupg22__5[]
a____Gnupg22__5	db '../../gnupg2-2.0.30/scd/app-p15.c',0 ; DATA XREF: sub_422340+B9o
					; sub_422340+E2o ...
		align 10h
; char aAppApp_localCe[]
aAppApp_localCe	db '!app->app_local->certificate_info',0 ; DATA XREF: sub_422340+C1o
		align 4
; char aAppApp_localTr[]
aAppApp_localTr	db '!app->app_local->trusted_certificate_info',0 ; DATA XREF: sub_422340+EAo
		align 10h
; char aAppApp_localUs[]
aAppApp_localUs	db '!app->app_local->useful_certificate_info',0 ; DATA XREF: sub_422340+113o
		align 4
; char aAppApp_localPr[]
aAppApp_localPr	db '!app->app_local->private_key_info',0 ; DATA XREF: sub_422340+211o
		align 10h
; char aAppApp_localAu[]
aAppApp_localAu	db '!app->app_local->auth_object_info',0 ; DATA XREF: sub_422340+288o
; char a04hx_0[]
a04hx_0		db '-%04hX',0           ; DATA XREF: sub_42261C+5Fo
					; sub_42291E+5Eo ...
aCertinfo_1	db 'CERTINFO',0         ; DATA XREF: sub_42261C+10Ao
; char aCanTGetKeygr_0[]
aCanTGetKeygr_0	db 'can',27h,'t get keygrip from ',0 ; DATA XREF: sub_42291E+C7o
; char aStrlenGripstr4[]
aStrlenGripstr4	db 'strlen (gripstr) == 40',0 ; DATA XREF: sub_42291E+161o
aKeypairinfo_3	db 'KEYPAIRINFO',0      ; DATA XREF: sub_42291E+1B6o
a100		db '100',0              ; DATA XREF: sub_422B0F+29o
a101		db '101',0              ; DATA XREF: sub_422B0F+59o
a102		db '102',0              ; DATA XREF: sub_422B0F+89o
		align 4
; char aErrorReading_2[]
aErrorReading_2	db 'error reading certificate with Id ',0 ; DATA XREF: sub_422BE2+115o
; char aTotobjlenBuf_1[]
aTotobjlenBuf_1	db 'totobjlen <= buflen',0 ; DATA XREF: sub_422BE2+24Eo
		align 4
; char aSave_pTotobj_1[]
aSave_pTotobj_1	db 'save_p + totobjlen <= buffer + buflen',0 ; DATA XREF: sub_422BE2+3C0o
aAuthkeyid	db '$AUTHKEYID',0       ; DATA XREF: sub_4230B6+Do
aDispserialno	db '$DISPSERIALNO',0    ; DATA XREF: sub_4230B6+16Ao
; char aErrorAccessing[]
aErrorAccessing	db 'error accessing EF(ID): %s',0Ah,0 ; DATA XREF: sub_4230B6+21Co
; char aErrorReadingEf[]
aErrorReadingEf	db 'error reading EF_keyD: %s',0Ah,0 ; DATA XREF: sub_4233EC+59o
		align 4
; char aErrorReading_3[]
aErrorReading_3	db 'error reading EF_keyD record: %s',0Ah,0 ; DATA XREF: sub_4233EC+DAo
aKeydRecord	db 'keyD record:',0     ; DATA XREF: sub_4233EC+FCo
		align 4
; char aCrtForKeyfile0[]
aCrtForKeyfile0	db 'CRT for keyfile %04hX not found',0Ah,0 ; DATA XREF: sub_4233EC+22Co
		align 10h
; char aRestoringSeToD[]
aRestoringSeToD	db 'restoring SE to %d failed: %s',0Ah,0 ; DATA XREF: sub_4233EC+29Bo
		align 10h
; char aSettingSeToRef[]
aSettingSeToRef	db 'setting SE to reference file %04hX failed: %s',0Ah,0
					; DATA XREF: sub_4233EC+31Ao
		align 10h
; char aKeySMayNotBeUs[]
aKeySMayNotBeUs	db 'key %s may not be used for signing',0Ah,0 ; DATA XREF: sub_42371E+BEo
; char aNoAuthenticati[]
aNoAuthenticati	db 'no authentication object defined for %s',0Ah,0
					; DATA XREF: sub_42371E+ECo
		align 10h
; char aAuthentication[]
aAuthentication	db 'authentication object for %s missing',0Ah,0 ; DATA XREF: sub_42371E+16Bo
		align 4
; char aPinVerificatio[]
aPinVerificatio	db 'PIN verification is protected by an additional authentication tok'
					; DATA XREF: sub_42371E+192o
		db 'en',0Ah,0
		align 10h
; char aPinVerificat_0[]
aPinVerificat_0	db 'PIN verification requires unsupported protection method',0Ah,0
					; DATA XREF: sub_42371E:loc_4238E9o
		align 4
; char aPinVerificat_1[]
aPinVerificat_1	db 'PIN verification requires padding but no length known',0Ah,0
					; DATA XREF: sub_42371E+200o
		align 4
; char aErrorSelecti_5[]
aErrorSelecti_5	db 'error selecting file for key %s: %s',0Ah,0 ; DATA XREF: sub_42371E+261o
; char aMseFailedS[]
aMseFailedS	db 'MSE failed: %s',0Ah,0 ; DATA XREF: sub_42371E+30Fo
					; sub_42371E+AB4o
aPinQualifiedSi	db 'PIN (qualified signature!)',0 ; DATA XREF: sub_42371E+346o
aPin_1		db 'PIN',0              ; DATA XREF: sub_42371E+365o
; char aPinCallbackR_2[]
aPinCallbackR_2	db 'PIN callback returned error: %s',0Ah,0 ; DATA XREF: sub_42371E+390o
		align 4
; char aPinIsTooShor_1[]
aPinIsTooShor_1	db 'PIN is too short; minimum length is %lu',0Ah,0
					; DATA XREF: sub_42371E+3D7o
		align 4
; char aPinIsTooLarg_1[]
aPinIsTooLarg_1	db 'PIN is too large; maximum length is %lu',0Ah,0
					; DATA XREF: sub_42371E+434o
					; sub_42371E+48Eo
		align 4
aNonNumericDi_0	db 'Non-numeric digits found in PIN',0 ; DATA XREF: sub_42371E+50Eo
aPinTypeHalfNib	db 'PIN type Half-Nibble-BCD is not supported',0
					; DATA XREF: sub_42371E:loc_423C44o
		align 10h
aPinTypeIso9564	db 'PIN type ISO9564-1 is not supported',0
					; DATA XREF: sub_42371E:loc_423C4Do
aUnknownPinType	db 'Unknown PIN type',0 ; DATA XREF: sub_42371E:loc_423C56o
; char aCanTVerifyPinS[]
aCanTVerifyPinS	db 'can',27h,'t verify PIN: %s',0Ah,0 ; DATA XREF: sub_42371E+552o
; char aPinVerificat_2[]
aPinVerificat_2	db 'PIN verification failed: %s',0Ah,0 ; DATA XREF: sub_42371E+869o
; char aPinVerificat_3[]
aPinVerificat_3	db 'PIN verification succeeded',0Ah,0 ; DATA XREF: sub_42371E:loc_423F9Bo
off_44CDB4	dd offset loc_423C02	; DATA XREF: sub_42371E+4DBr
		dd offset loc_423C02	; jump table for switch	statement
		dd offset loc_423C5F
		dd offset loc_423C44
		dd offset loc_423C4D
; char aKeySMayNotBe_0[]
aKeySMayNotBe_0	db 'key %s may not be used for authentication',0Ah,0
					; DATA XREF: sub_4242C6+66o
; char aErrorReading_4[]
aErrorReading_4	db 'error reading EF{DIR}: %s',0Ah,0 ; DATA XREF: sub_4243A0+56o
		align 10h
; char aPkcs15Applicat[]
aPkcs15Applicat	db 'pkcs#15 application label from EF(DIR) is `%.*s',27h,0Ah,0
					; DATA XREF: sub_4243A0+175o
		align 4
; char aPkcs15Applic_0[]
aPkcs15Applic_0	db 'pkcs#15 application directory is 0x%04hX',0Ah,0
					; DATA XREF: sub_4243A0+1F5o
aP15_1		db 'P15',0              ; DATA XREF: sub_4245B2+218o
aV		db 'v',0               ; DATA XREF: sub_4245B2+2ACo
		align 4
		dd 0
		db 3 dup(0)
byte_44CE7F	db 0FFh			; DATA XREF: sub_4245B2:loc_4248AEo
		dd 1, 0
aXKblz		db 'X-KBLZ',0           ; DATA XREF: sub_424AAE+19o
					; .data:off_444BC0o
aXBankinfo	db 'X-BANKINFO',0       ; DATA XREF: sub_424AAE+62o
					; .data:00444BC4o
aXCardno	db 'X-CARDNO',0         ; DATA XREF: sub_424AAE+AEo
					; .data:00444BC8o
aXExpires	db 'X-EXPIRES',0        ; DATA XREF: sub_424AAE+FAo
					; .data:00444BCCo
aXValidfrom	db 'X-VALIDFROM',0      ; DATA XREF: sub_424AAE+146o
					; .data:00444BD0o
aXCountry	db 'X-COUNTRY',0        ; DATA XREF: sub_424AAE+192o
					; .data:00444BD4o
aXCurrency	db 'X-CURRENCY',0       ; DATA XREF: sub_424AAE+1DEo
					; .data:00444BD8o
aXZkachipid	db 'X-ZKACHIPID',0      ; DATA XREF: sub_424AAE+22Ao
					; .data:00444BDCo
a0x02x		db '0x%02X',0           ; DATA XREF: sub_424AAE+25Bo
					; sub_424AAE+2CDo
aXOsversion	db 'X-OSVERSION',0      ; DATA XREF: sub_424AAE+29Co
					; .data:00444BE0o
aXBalance	db 'X-BALANCE',0        ; DATA XREF: sub_424AAE+30Eo
					; .data:00444BE4o
a_2f		db '%.2f',0             ; DATA XREF: sub_424AAE+368o
					; sub_424AAE+403o ...
aXMaxamount	db 'X-MAXAMOUNT',0      ; DATA XREF: sub_424AAE+3A9o
					; .data:00444BE8o
aXMaxamount1	db 'X-MAXAMOUNT1',0     ; DATA XREF: sub_424AAE+444o
					; .data:00444BECo
byte_44CF15	db 3 dup(0)		; DATA XREF: sub_424FF7+Co
aOeffentlichRec	db 'Oeffentlich-rechtliche oder private Bank',0
					; DATA XREF: sub_425215:loc_4252EAo
aPrivatOderGesc	db 'Privat- oder Geschaeftsbank',0 ; DATA XREF: sub_425215:loc_4252F3o
aSparkasse	db 'Sparkasse',0        ; DATA XREF: sub_425215:loc_4252FCo
aGenossenschaft	db 'Genossenschaftsbank',0 ; DATA XREF: sub_425215:loc_425305o
aGeldkarte_0	db 'GELDKARTE',0        ; DATA XREF: sub_425215+110o
a02x02x02x	db '%02X-%02X%02X',0    ; DATA XREF: sub_425215+1FFo
a2002x02x	db '20%02X-%02X',0      ; DATA XREF: sub_425215+279o
a2002x02x02x	db '20%02X-%02X-%02X',0 ; DATA XREF: sub_425215+2C7o
aCCC		db '%c%c%c',0           ; DATA XREF: sub_425215+384o
		align 4
off_44CFB8	dd offset loc_4252EA	; DATA XREF: sub_425215+CCr
		dd offset loc_4252F3	; jump table for switch	statement
		dd offset loc_42530E
		dd offset loc_42530E
		dd offset loc_4252FC
		dd offset loc_425305
		dd offset loc_42530E
		dd offset loc_42530E
		dd offset loc_425305
dword_44CFDC	dd 76D2h, 2504525h, 0	; DATA XREF: sub_425215+27o
dbl_44CFE8	dq 100.0		; DATA XREF: sub_424AAE+33Dr
					; sub_424AAE+3D8r ...
; char aGnupg2[]
aGnupg2		db 'gnupg2',0           ; DATA XREF: sub_425774+Fo
		align 4
; char aLibgcryptProbl[]
aLibgcryptProbl	db 'libgcrypt problem: %s',0Ah,0 ; DATA XREF: sub_4258F9+20o
		align 10h
; char aOutOfCoreInSec[]
aOutOfCoreInSec	db 'out of core in secure memory while allocating %lu bytes',0
					; DATA XREF: sub_425925+23o
; char aOutOfCoreWhi_0[]
aOutOfCoreWhi_0	db 'out of core while allocating %lu bytes',0
					; DATA XREF: sub_425925:loc_425963o
aStdout		db '[stdout]',0         ; DATA XREF: .text:loc_4259E9o
aStdin		db '[stdin]',0          ; DATA XREF: .text:loc_425A15o
asc_44D080	db '|',0                ; DATA XREF: .text:loc_425CCAo
		align 4
; char aFailedToTransl[]
aFailedToTransl	db 'failed to translate osfhandle %p',0Ah,0 ; DATA XREF: sub_425DDB+3Eo
a_tmp		db '.tmp',0             ; DATA XREF: .text:00425FDCo
aWB		db 'w+b',0              ; DATA XREF: .text:loc_426076o
		align 10h
aGnupg_allow_se	db 'gnupg_allow_set_foregound_window',0 ; DATA XREF: sub_4260FC+13o
		align 4
; char aSCalledWithInv[]
aSCalledWithInv	db '%s called with invalid pid %lu',0Ah,0 ; DATA XREF: sub_4260FC+1Bo
; char aAllowsetforegr[]
aAllowsetforegr	db 'AllowSetForegroundWindow(%lu) failed: %s',0Ah,0
					; DATA XREF: sub_4260FC+61o
		align 10h
; CHAR aShgetfolderpat[]
aShgetfolderpat	db 'SHGetFolderPathA',0 ; DATA XREF: sub_4263DD+50o
aHome		db '\home',0            ; DATA XREF: sub_4264B7+31o
aGnupg		db '\gnupg',0           ; DATA XREF: sub_4264B7+BAo
aCGnupg		db 'c:/gnupg',0         ; DATA XREF: sub_4264B7:loc_4265DBo
					; sub_4265F1:loc_4266C5o
; char aGnupghome[]
aGnupghome	db 'GNUPGHOME',0        ; DATA XREF: sub_4265F1:loc_42660Fo
; CHAR ValueName[]
ValueName	db 'HomeDir',0          ; DATA XREF: sub_4265F1:loc_42664Bo
; CHAR aSoftwareGnuGnu[]
aSoftwareGnuGnu	db 'Software\GNU\GnuPG',0 ; DATA XREF: sub_4265F1+62o
aGpgconf_exe	db '\gpgconf.exe',0     ; DATA XREF: sub_4266D1+10o
					; .text:0042731Do
		align 4
; char aRequiredBinary[]
aRequiredBinary	db 'required binary ',27h,'%s',27h,' is not installed',0Ah,0
					; DATA XREF: sub_4266D1+44o
aCtl		db 'ctl',0              ; DATA XREF: sub_4266D1:loc_426723o
; char aGetmodulefilen[]
aGetmodulefilen	db 'GetModuleFileName failed: %s',0Ah,0 ; DATA XREF: sub_426784+4Ao
aBin		db 'bin',0              ; DATA XREF: sub_426784+BBo
		align 4
; char aBadFilenameSRe[]
aBadFilenameSRe	db 'bad filename `%s',27h,' returned for this process',0Ah,0
					; DATA XREF: sub_426784+FCo
aCGnupg_0	db 'c:\gnupg',0         ; DATA XREF: sub_426784:loc_4268A5o
aGnu		db '\GNU',0             ; DATA XREF: sub_4268B1+99o
aEtcGnupg	db '\etc\gnupg',0       ; DATA XREF: .text:004269B5o
aBin_0		db '\bin',0             ; DATA XREF: sub_426A3B+28o
aLibGnupg	db '\lib\gnupg',0       ; DATA XREF: .text:00426AB1o
aShareGnupg	db '\share\gnupg',0     ; DATA XREF: .text:00426B54o
aShareLocale	db '\share\locale',0    ; DATA XREF: sub_426BDA+1Do
aCWindows	db 'C:\WINDOWS',0       ; DATA XREF: .text:00426CC7o
aS_dirmngr	db '\S.dirmngr',0       ; DATA XREF: .text:loc_426CEBo
aGpgAgent_exe	db '\gpg-agent.exe',0   ; DATA XREF: .text:00426DBCo
aPinentry_exe	db '\pinentry.exe',0    ; DATA XREF: .text:00426E55o
aScdaemon_exe	db '\scdaemon.exe',0    ; DATA XREF: .text:00426EEEo
aDirmngr_exe	db '\dirmngr.exe',0     ; DATA XREF: .text:00426F87o
aGpgProtectTool	db '\gpg-protect-tool.exe',0 ; DATA XREF: .text:00427020o
aGpgCheckPatter	db '\gpg-check-pattern.exe',0 ; DATA XREF: .text:004270B9o
aGpgsm_exe	db '\gpgsm.exe',0       ; DATA XREF: .text:00427152o
aGpg2_exe	db '\gpg2.exe',0        ; DATA XREF: .text:004271EBo
aGpgConnectAgen	db '\gpg-connect-agent.exe',0 ; DATA XREF: .text:00427284o
a____Gnupg22__6	db '../../gnupg2-2.0.30/common/homedir.c',0 ; DATA XREF: .text:004273AEo
		align 4
off_44D30C	dd offset loc_42739E	; DATA XREF: .text:00426D9Eo
		dd offset loc_426DA7	; jump table for switch	statement
		dd offset loc_426E40
		dd offset loc_426ED9
		dd offset loc_426F72
		dd offset loc_42700B
		dd offset loc_4270A4
		dd offset loc_42713D
		dd offset loc_4271D6
		dd offset loc_42726F
		dd offset loc_427308
aGnupg_module_n	db 'gnupg_module_name',0 ; DATA XREF: .text:loc_42739Eo
aShell32_dll	db 'shell32.dll',0      ; DATA XREF: .data:off_444C00o
aShfolder_dll	db 'shfolder.dll',0     ; DATA XREF: .data:00444C04o
		align 4
off_44D364	dd offset loc_4273DF	; DATA XREF: sub_4273C4+12r
		dd offset loc_4273EE	; jump table for switch	statement
		dd offset loc_427466
		dd offset loc_427466
		dd offset loc_427466
		dd offset loc_427466
		dd offset loc_4274DE
		dd offset loc_4274DE
		dd offset loc_4274DE
		dd offset loc_4274DE
		dd offset loc_4274DE
		dd offset loc_4274DE
		dd offset loc_4274DE
		dd offset loc_4274DE
		dd offset loc_427516
		dd offset loc_427525
		dd offset loc_427534
		dd offset loc_427543
		dd offset loc_42754F
off_44D3B0	dd offset loc_427456	; DATA XREF: sub_4273C4+35r
		dd offset loc_427402	; jump table for switch	statement
		dd offset loc_42740E
		dd offset loc_42741A
		dd offset loc_427426
		dd offset loc_427432
		dd offset loc_42743E
		dd offset loc_42744A
off_44D3D0	dd offset loc_4274CE	; DATA XREF: sub_4273C4+ADr
		dd offset loc_42747A	; jump table for switch	statement
		dd offset loc_427486
		dd offset loc_427492
		dd offset loc_42749E
		dd offset loc_4274AA
		dd offset loc_4274B6
		dd offset loc_4274C2
off_44D3F0	dd offset loc_4275B7	; DATA XREF: sub_4273C4+196r
		dd offset loc_427563	; jump table for switch	statement
		dd offset loc_42756F
		dd offset loc_42757B
		dd offset loc_427587
		dd offset loc_427593
		dd offset loc_42759F
		dd offset loc_4275AB
off_44D410	dd offset loc_4276EA	; DATA XREF: sub_4275C5+10Ar
		dd offset loc_42770B	; jump table for switch	statement
		dd offset loc_42770B
		dd offset loc_4276F0
		dd offset loc_42770B
		dd offset loc_42770B
		dd offset loc_42770B
		dd offset loc_4276D8
		dd offset loc_42770B
		dd offset loc_42770B
		dd offset loc_42770B
		dd offset loc_4276E4
		dd offset loc_42770B
		dd offset loc_4276DE
		dd offset loc_42770B
		dd offset loc_42770B
		dd offset loc_4276F6
off_44D454	dd offset loc_427A4B	; DATA XREF: sub_4275C5+408r
		dd offset loc_427A58	; jump table for switch	statement
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_4279D6
		dd offset loc_427A58
		dd offset loc_427A24
		dd offset loc_427A58
		dd offset loc_4279FD
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A3E
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A58
		dd offset loc_427A31
off_44D510	dd offset loc_427B02, offset loc_427B5F, offset	loc_427B2F
					; DATA XREF: sub_4275C5+4B0r
		dd offset loc_427B5F, offset loc_427ADE, offset	loc_427AC6 ; jump table	for switch statement
		dd offset loc_427AF0, offset loc_427B5F, offset	loc_427B5F
		dd offset loc_427B5F, offset loc_427B5F, offset	loc_427B5F
		dd offset loc_427B5F, offset loc_427B5F, offset	loc_427B5F
		dd offset loc_427B5F, offset loc_427B5F, offset	loc_427B5F
		dd offset loc_427B3F, offset loc_427B5F, offset	loc_427B5F
		dd offset loc_427B5F, offset loc_427B5F, offset	loc_427AAE
		dd offset loc_427B5F, offset loc_427B5F, offset	loc_427B5F
		dd offset loc_427B5F, offset loc_427B5F, offset	loc_427B5F
		dd offset loc_427B5F, offset loc_427B5F, offset	loc_427AF9
		dd offset loc_427B5F, offset loc_427B0B, offset	loc_427A7E
		dd offset loc_427AD2, offset loc_427ABA, offset	loc_427AE7
		dd offset loc_427B5F, offset loc_427A7E, offset	loc_427B5F
		dd offset loc_427B5F, offset loc_427B5F, offset	loc_427B4F
		dd offset loc_427B26, offset loc_427A8A, offset	loc_427B1D
		dd offset loc_427B5F, offset loc_427B5F, offset	loc_427B14
		dd offset loc_427B5F, offset loc_427A96, offset	loc_427B5F
		dd offset loc_427B5F, offset loc_427AA2
off_44D5F0	dd offset loc_427FF9	; DATA XREF: sub_427D3D+4Co
		dd offset loc_427D92	; jump table for switch	statement
		dd offset loc_427DBE
		dd offset loc_427DEA
		dd offset loc_427E01
		dd offset loc_427E19
		dd offset loc_427E46
		dd offset loc_427E70
		dd offset loc_427E85
		dd offset loc_427E9A
		dd offset loc_427EC4
		dd offset loc_427EDF
		dd offset loc_427F0F
		dd offset loc_427F24
		dd offset loc_427F45
		dd offset loc_427F6F
		dd offset loc_427F99
		dd offset loc_427FB1
		dd offset loc_427FD5
		dd offset loc_427F5A
		dd offset loc_427DA9
		dd offset loc_427DD5
		dd offset loc_427E31
		dd offset loc_427E5B
		dd offset loc_427EAF
		dd offset loc_427EFA
		dd offset loc_427F87
		dd offset loc_427FC3
		dd offset loc_427FE7
byte_44D664	db 27h,	0		; DATA XREF: sub_428099+267o
a0123456789abcd	db '0123456789abcdef',0 ; DATA XREF: sub_428099+37Eo
a0123456789ab_0	db '0123456789ABCDEF',0 ; DATA XREF: sub_428099:loc_42841Eo
a0x		db '0x',0               ; DATA XREF: sub_428099+550o
a0x_0		db '0X',0               ; DATA XREF: sub_428099:loc_4285F0o
		align 10h
off_44D690	dd offset loc_4280F8	; DATA XREF: sub_428099+56r
		dd offset loc_428180	; jump table for switch	statement
		dd offset loc_42810D
		dd offset loc_428180
		dd offset loc_428120
		dd offset loc_428180
		dd offset loc_428133
		dd offset loc_428180
		dd offset loc_428180
		dd offset loc_428180
		dd offset loc_428180
		dd offset loc_428159
		dd offset loc_428180
		dd offset loc_428147
		dd offset loc_42816D
off_44D6CC	dd offset loc_4281DB	; DATA XREF: sub_428099+139r
		dd offset loc_428262	; jump table for switch	statement
		dd offset loc_4281F1
		dd offset loc_428262
		dd offset loc_428203
		dd offset loc_428262
		dd offset loc_428215
		dd offset loc_428262
		dd offset loc_428262
		dd offset loc_428262
		dd offset loc_428262
		dd offset loc_42823B
		dd offset loc_428229
		dd offset loc_42824F
off_44D704	dd offset loc_4287FE	; DATA XREF: sub_42872C+C9r
		dd offset loc_42880A	; jump table for switch	statement
		dd offset loc_428816
		dd offset loc_428822
		dd offset loc_42882E
		dd offset loc_42883A
		dd offset loc_428846
		dd offset loc_428852
aNull_0		db '(null)',0           ; DATA XREF: sub_428BD3+40o
byte_44D72B	db 30h			; DATA XREF: sub_428D74+65r
a123456789abcde	db '123456789abcdefx',0
		align 10h
off_44D740	dd offset loc_428EB0	; DATA XREF: sub_428E7B+2Cr
		dd offset loc_428EBC	; jump table for switch	statement
		dd offset loc_428F15
		dd offset loc_428EC9
		dd offset loc_428ED5
		dd offset loc_428EE9
		dd offset loc_428EFD
		dd offset loc_428F09
; char a____Gnupg22__7[]
a____Gnupg22__7	db '../../gnupg2-2.0.30/common/estream-printf.c',0
					; DATA XREF: sub_428F2F+FAo
					; sub_428F2F+145o ...
; char aArgidxArgspecs[]
aArgidxArgspecs	db 'argidx < argspecs_len',0 ; DATA XREF: sub_428F2F+102o
		align 4
; char aValuetableArgW[]
aValuetableArgW	db 'valuetable[arg->width_pos-1].vt == VALTYPE_INT',0
					; DATA XREF: sub_428F2F+14Do
		align 4
; char aValuetableArgP[]
aValuetableArgP	db 'valuetable[arg->precision_pos-1].vt == VALTYPE_INT',0
					; DATA XREF: sub_428F2F+1D9o
		align 4
; char aArgVtValuetabl[]
aArgVtValuetabl	db 'arg->vt == valuetable[arg->arg_pos-1].vt',0 ; DATA XREF: sub_428F2F+26Eo
; char aBug[]
aBug		db '!"bug"',0           ; DATA XREF: sub_428F2F+2CFo
off_44D838	dd offset loc_4291EE	; DATA XREF: sub_428F2F+2B6r
		dd offset loc_42920F	; jump table for switch	statement
		dd offset loc_42920F
		dd offset loc_42920F
		dd offset loc_42920F
		dd offset loc_42920F
		dd offset loc_429253
		dd offset loc_429253
		dd offset loc_429253
		dd offset loc_429253
		dd offset loc_429253
		dd offset loc_429253
		dd offset loc_429253
		dd offset loc_429253
		dd offset loc_429297
		dd offset loc_4292DB
		dd offset loc_42931F
		dd offset loc_4292DB
		dd offset loc_429360
byte_44D884	db 0			; DATA XREF: sub_429B64+5Fo
					; sub_429D5F+75o
; char aParm_used[]
aParm_used	db 'parm.used',0        ; DATA XREF: sub_429D5F+FDo
		align 10h
a02x_1		db '%%%02X',0           ; DATA XREF: .text:00429F5Eo
		align 4
; char a____Gnupg22__8[]
a____Gnupg22__8	db '../../gnupg2-2.0.30/common/percent.c',0 ; DATA XREF: sub_42A14B+5Eo
; char aNNbytes[]
aNNbytes	db 'n == nbytes',0      ; DATA XREF: sub_42A14B+66o
		align 4
a04d02d02dt02d0	db '%04d%02d%02dT%02d%02d%02d',0 ; DATA XREF: .text:0042A4A6o
					; .text:0042AA76o ...
aGnupg_get_time	db 'gnupg_get_time() failed',0Ah,0 ; DATA XREF: .text:0042A57Co
aUyUdUhUm	db '%uy%ud%uh%um',0     ; DATA XREF: .text:0042AB8Co
a????????	db '????-??-??',0       ; DATA XREF: .text:0042AC16o
					; .text:0042AD6Co
a04d02d02d	db '%04d-%02d-%02d',0   ; DATA XREF: .text:0042AC6Bo
a??????????????	db '????-??-?? ??:??:??',0 ; DATA XREF: .text:0042ACADo
a04d02d02d02d02	db '%04d-%02d-%02d %02d:%02d:%02d',0 ; DATA XREF: .text:0042AD1Co
aCZ		db '%c %Z',0            ; DATA XREF: .text:0042ADAEo
		align 10h
a____Gnupg22__9	db '../../gnupg2-2.0.30/common/gettime.c',0 ; DATA XREF: sub_42AE65+E7o
aNone_0		db '[none]',0           ; DATA XREF: .text:loc_42B279o
a_4s_2s_2s_2s_2	db '%.4s-%.2s-%.2s %.2s:%.2s:%s',0 ; DATA XREF: .text:0042B2C8o
aDays_per_month	db 'days_per_month',0   ; DATA XREF: sub_42AE65:loc_42AF3Co
		align 4
a____Gnupg22_10	db '../../gnupg2-2.0.30/common/convert.c',0 ; DATA XREF: .text:0042C17Ao
aHex2str_alloc	db 'hex2str_alloc',0    ; DATA XREF: .text:0042C16Ao
		align 4
; char Control[4]
Control		db ' ',9,0Ah,0Bh        ; DATA XREF: sub_42C3C7:loc_42C3F2o
		db 0Ch,	22h, 0
; char aDuplicatehandl[]
aDuplicatehandl	db 'DuplicateHandle failed: %s',0Ah,0 ; DATA XREF: sub_42C5DD+BCo
; CHAR FileName[]
FileName	db 'nul',0              ; DATA XREF: sub_42C703+44o
; char aCanTOpenNulS[]
aCanTOpenNulS	db 'can',27h,'t open `nul',27h,': %s',0Ah,0 ; DATA XREF: sub_42C703+6Eo
		align 4
aFailedToTran_0	db 'failed to translate osfhandle %p',0Ah,0 ; DATA XREF: .text:0042C7F0o
					; .text:0042C83Fo ...
		align 10h
aNoFileDescript	db 'no file descriptor for file passed to gnupg_spawn_process',0Ah,0
					; DATA XREF: .text:loc_42C90Do
aErrorCreatingA	db 'error creating a pipe: %s',0Ah,0 ; DATA XREF: .text:0042C996o
aCreateprocessF	db 'CreateProcess failed: %s',0Ah,0 ; DATA XREF: .text:0042CA99o
					; .text:0042CDC0o
aR_1		db 'r',0                ; DATA XREF: .text:loc_42CB7Bo
		align 4
aCanTFdopenPipe	db 'can',27h,'t fdopen pipe for reading: %s',0Ah,0
					; DATA XREF: .text:0042CBB1o
		align 4
aWaitingForProc	db 'waiting for process %d to terminate failed: %s',0Ah,0
					; DATA XREF: .text:0042CED0o
aErrorGettingEx	db 'error getting exit code of process %d: %s',0Ah,0
					; DATA XREF: .text:0042CF24o
		align 4
aErrorRunningSE	db 'error running `%s',27h,': exit status %d',0Ah,0
					; DATA XREF: .text:0042CF58o
aWaitforsingleo	db 'WaitForSingleObject returned unexpected code %d for pid %d',0Ah,0
					; DATA XREF: .text:0042CFC6o
; char aCreateprocessD[]
aCreateprocessD	db 'CreateProcess(detached) failed: %s',0Ah,0 ; DATA XREF: sub_42CFF2+142o
aInvalidSExpInC	db 'invalid S-exp in cmp_simple_canon_sexp',0Ah,0
					; DATA XREF: .text:loc_42DE59o
					; .text:loc_42DEC7o
aSigVal		db 'sig-val',0          ; DATA XREF: .text:loc_42E16Fo
aHash		db 'hash',0             ; DATA XREF: .text:loc_42E21Ao
aU_0		db '%u:',0              ; DATA XREF: sub_42E296+DCo
					; sub_42E296+101o
aPublicKey	db 'public-key',0       ; DATA XREF: sub_42E542+E8o
					; .text:0042EA24o
aRsa_0		db 'rsa',0              ; DATA XREF: sub_42E542+1A6o
					; .text:0042EAF3o
aDsa		db 'dsa',0              ; DATA XREF: .text:0042EB27o
aElg		db 'elg',0              ; DATA XREF: .text:0042EB58o
aEcdsa		db 'ecdsa',0            ; DATA XREF: .text:0042EB89o
		align 10h
aEstream_asprin	db 'estream_asprintf failed: %s',0Ah,0 ; DATA XREF: .text:0042EBFCo
		align 10h
; char a____Gnupg22_11[]
a____Gnupg22_11	db '../../gnupg2-2.0.30/common/estream.c',0 ; DATA XREF: sub_42F1EE+4Do
					; sub_42F1EE+1CBo ...
		align 4
; char aMem_cookieMemo[]
aMem_cookieMemo	db 'mem_cookie->memory_size >= mem_cookie->offset',0
					; DATA XREF: sub_42F1EE+55o
					; sub_42F1EE+1D3o
; char aSizeNleft[]
aSizeNleft	db 'size <= nleft',0    ; DATA XREF: sub_42F1EE+20Co
; char aStreamFlags_wr[]
aStreamFlags_wr	db 'stream->flags.writing',0 ; DATA XREF: sub_42FE0D+35o
; char aStreamFlags__0[]
aStreamFlags__0	db '!stream->flags.writing',0 ; DATA XREF: sub_42FFA6+24o
aR_2		db 'r',0                ; DATA XREF: .text:00431DC4o
					; .text:00431E6Co ...
aA		db 'a',0                ; DATA XREF: .text:00431DFFo
					; .text:00431E34o ...
		align 4
aFatalErrorCrea	db 'fatal: error creating a dummy estream for %d: %s',0Ah,0
					; DATA XREF: .text:00431F31o
aStdout_0	db '[stdout]',0         ; DATA XREF: .text:00431FCEo
aStderr		db '[stderr]',0         ; DATA XREF: .text:loc_431FD5o
aStdin_0	db '[stdin]',0          ; DATA XREF: .text:loc_431FDCo
a_estream	db '_estream',0         ; DATA XREF: sub_4339FA+BAo
a_tmp_0		db '.tmp',0             ; DATA XREF: sub_4339FA+165o
a?_0		db '[?]',0              ; DATA XREF: .text:00434235o
aX02x		db 'x%02x',0            ; DATA XREF: sub_434241+338o
; char a____Gnupg22_12[]
a____Gnupg22_12	db '../../gnupg2-2.0.30/common/iobuf.c',0 ; DATA XREF: sub_434B1A+1Bo
					; sub_434CEA+15o ...
; char aFname[]
aFname		db 'fname',0            ; DATA XREF: sub_434B1A+23o
					; sub_434E4F+1Co
; char aFd_cache_inval[]
aFd_cache_inval	db 'fd_cache_invalidate (%s)',0Ah,0 ; DATA XREF: sub_434B1A+3Fo
; char aDidS[]
aDidS		db '                did (%s)',0Ah,0 ; DATA XREF: sub_434B1A+8Co
; char aFp[]
aFp		db 'fp',0               ; DATA XREF: sub_434CEA+1Do
; char aFd_cache_close[]
aFd_cache_close	db 'fd_cache_close (%d) real',0Ah,0 ; DATA XREF: sub_434CEA+5Do
		align 4
; char aFd_cache_clo_0[]
aFd_cache_clo_0	db 'fd_cache_close (%s) used existing slot',0Ah,0
					; DATA XREF: sub_434CEA+B9o
; char aFd_cache_clo_1[]
aFd_cache_clo_1	db 'fd_cache_close (%s) new slot created',0Ah,0 ; DATA XREF: sub_434CEA+E8o
		align 4
; char aFd_cache_openS[]
aFd_cache_openS	db 'fd_cache_open (%s) using cached fp',0Ah,0 ; DATA XREF: sub_434E4F+84o
; char aRewindFileFail[]
aRewindFileFail	db 'rewind file failed on handle %p: ec=%d',0Ah,0
					; DATA XREF: sub_434E4F+CFo
; char aFd_cache_ope_0[]
aFd_cache_ope_0	db 'fd_cache_open (%s) not cached',0Ah,0 ; DATA XREF: sub_434E4F+109o
; char aSize[]
aSize		db 'size',0             ; DATA XREF: sub_434F78+4Ao
					; sub_435224+42o ...
; char aSReadErrorEcD[]
aSReadErrorEcD	db '%s: read error: ec=%d',0Ah,0 ; DATA XREF: sub_434F78+DCo
; char aSWriteErrorEcD[]
aSWriteErrorEcD	db '%s: write error: ec=%d',0Ah,0 ; DATA XREF: sub_434F78+197o
aFile_filterFd	db 'file_filter(fd)',0  ; DATA XREF: sub_434F78+205o
; char aSCloseHandleP[]
aSCloseHandleP	db '%s: close handle %p',0Ah,0 ; DATA XREF: sub_434F78+260o
; char aSocketReadErro[]
aSocketReadErro	db 'socket read error: ec=%d',0Ah,0 ; DATA XREF: sub_435224+BDo
; char aSocketWriteErr[]
aSocketWriteErr	db 'socket write error: ec=%d',0Ah,0 ; DATA XREF: sub_435224+167o
aSock_filter	db 'sock_filter',0      ; DATA XREF: sub_435224+1CFo
		align 10h
; char aBlock_filter1s[]
aBlock_filter1s	db 'block_filter: 1st length byte missing',0Ah,0
					; DATA XREF: sub_43542D+141o
		align 4
; char aBlock_filter2n[]
aBlock_filter2n	db 'block_filter: 2nd length byte missing',0Ah,0
					; DATA XREF: sub_43542D+229o
		align 10h
; char aBlock_filterIn[]
aBlock_filterIn	db 'block_filter: invalid 4 byte length',0Ah,0 ; DATA XREF: sub_43542D+452o
		align 4
; char aBlock_filterPR[]
aBlock_filterPR	db 'block_filter %p: read error (size=%lu,a->size=%lu)',0Ah,0
					; DATA XREF: sub_43542D+551o
; char aABuflenOp_min_[]
aABuflenOp_min_	db 'a->buflen <= OP_MIN_PARTIAL_CHUNK',0 ; DATA XREF: sub_43542D+60Do
; char aC0x1f[]
aC0x1f		db 'c <= 0x1f',0        ; DATA XREF: sub_43542D+6C3o
; char aNOp_min_partia[]
aNOp_min_partia	db 'n == OP_MIN_PARTIAL_CHUNK',0 ; DATA XREF: sub_43542D+710o
; char aABuflen[]
aABuflen	db '!a->buflen',0       ; DATA XREF: sub_43542D+7E0o
; char aNbytesOp_min_p[]
aNbytesOp_min_p	db 'nbytes < OP_MIN_PARTIAL_CHUNK',0 ; DATA XREF: sub_43542D+805o
; char aInitBlock_filt[]
aInitBlock_filt	db 'init block_filter %p',0Ah,0 ; DATA XREF: sub_43542D+88Fo
aBlock_filter_0	db 'block_filter',0     ; DATA XREF: sub_43542D+90Bo
		align 10h
; char aBlock_filterWr[]
aBlock_filterWr	db 'block_filter: write error: %s',0Ah,0 ; DATA XREF: sub_43542D+AA1o
; char aBlock_filterPe[]
aBlock_filterPe	db 'block_filter: pending bytes!',0Ah,0 ; DATA XREF: sub_43542D+AFFo
; char aFreeBlock_filt[]
aFreeBlock_filt	db 'free block_filter %p',0Ah,0 ; DATA XREF: sub_43542D+B1Bo
aNone_1		db '[none]',0           ; DATA XREF: sub_435F68+22o
a?_1		db '?',0                ; DATA XREF: sub_435F68:loc_435FECo
					; sub_4360D1:loc_4361A0o ...
; char aIobufChainD_DS[]
aIobufChainD_DS	db 'iobuf chain: %d.%d `%s',27h,' filter_eof=%d start=%d len=%d',0Ah,0
					; DATA XREF: sub_435F68+ADo
; char aIobuf_closeP[]
aIobuf_closeP	db 'iobuf_close -> %p',0Ah,0 ; DATA XREF: sub_4360D1+5Co
		align 4
; char aIobuf_flushFai[]
aIobuf_flushFai	db 'iobuf_flush failed on close: %s',0Ah,0 ; DATA XREF: sub_4360D1+A8o
; char aIobufD_DCloseS[]
aIobufD_DCloseS	db 'iobuf-%d.%d: close `%s',27h,0Ah,0 ; DATA XREF: sub_4360D1+ECo
		align 4
; char aIobufctrl_free[]
aIobufctrl_free	db 'IOBUFCTRL_FREE failed on close: %s',0Ah,0 ; DATA XREF: sub_4360D1+14Co
aStdin_1	db '[stdin]',0          ; DATA XREF: sub_4364E9+46o
; char aRb[]
aRb		db 'rb',0               ; DATA XREF: sub_4364E9+7Do
					; sub_4364E9:loc_43657Bo
; char aIobufD_DOpenSF[]
aIobufD_DOpenSF	db 'iobuf-%d.%d: open `%s',27h,' fd=%d',0Ah,0 ; DATA XREF: sub_4364E9+1D3o
; char aFdD[]
aFdD		db '[fd %d]',0          ; DATA XREF: sub_4366D0+63o
; char aIobufD_DFdopen[]
aIobufD_DFdopen	db 'iobuf-%d.%d: fdopen `%s',27h,0Ah,0 ; DATA XREF: sub_4366D0+111o
aSockD		db '[sock %d]',0        ; DATA XREF: .text:00436872o
aIobufD_DSockop	db 'iobuf-%d.%d: sockopen `%s',27h,0Ah,0 ; DATA XREF: .text:00436920o
aStdout_1	db '[stdout]',0         ; DATA XREF: .text:00436993o
aWb		db 'wb',0               ; DATA XREF: .text:004369CAo
					; .text:loc_4369DFo
aIobufD_DCreate	db 'iobuf-%d.%d: create `%s',27h,0Ah,0 ; DATA XREF: .text:00436B29o
aRB		db 'r+b',0              ; DATA XREF: .text:loc_436B54o
aIobufD_DOpenrw	db 'iobuf-%d.%d: openrw `%s',27h,0Ah,0 ; DATA XREF: .text:00436C8Fo
		align 10h
; char aIobufD_DIoctlS[]
aIobufD_DIoctlS	db 'iobuf-%d.%d: ioctl `%s',27h,' keep=%d',0Ah,0 ; DATA XREF: sub_436CA4+74o
		align 4
; char aIobuf_IoctlSIn[]
aIobuf_IoctlSIn	db 'iobuf-*.*: ioctl `%s',27h,' invalidate',0Ah,0
					; DATA XREF: sub_436CA4+11Fo
		align 4
; char aIobufD_DIoct_0[]
aIobufD_DIoct_0	db 'iobuf-%d.%d: ioctl `%s',27h,' no_cache=%d',0Ah,0
					; DATA XREF: sub_436CA4+1D9o
aNull_1		db '<null>',0           ; DATA XREF: sub_436CA4:loc_436F19o
; char aIobuf_IoctlSFs[]
aIobuf_IoctlSFs	db 'iobuf-*.*: ioctl `%s',27h,' fsync',0Ah,0 ; DATA XREF: sub_436CA4+27Eo
		align 4
; char aIOFilterTooDee[]
aIOFilterTooDee	db 'i/o filter too deeply nested - corrupted data?',0Ah,0
					; DATA XREF: sub_436F81+6Eo
; char aIobufD_DPushS[]
aIobufD_DPushS	db 'iobuf-%d.%d: push `%s',27h,0Ah,0 ; DATA XREF: sub_436F81+2B9o
; char aIobufctrl_init[]
aIobufctrl_init	db 'IOBUFCTRL_INIT failed: %s',0Ah,0 ; DATA XREF: sub_436F81+324o
; char aIobufD_DPopS[]
aIobufD_DPopS	db 'iobuf-%d.%d: pop `%s',27h,0Ah,0 ; DATA XREF: sub_4372BC+75o
; char aB[]
aB		db 'b',0                ; DATA XREF: sub_4372BC+AEo
; char aPop_filterFilt[]
aPop_filterFilt	db 'pop_filter(): filter function not found',0Ah,0
					; DATA XREF: sub_4372BC+194o
		align 4
; char aIobuf_flushF_0[]
aIobuf_flushF_0	db 'iobuf_flush failed in pop_filter: %s',0Ah,0 ; DATA XREF: sub_4372BC+1CDo
; char aIobufctrl_fr_0[]
aIobufctrl_fr_0	db 'IOBUFCTRL_FREE failed: %s',0Ah,0 ; DATA XREF: sub_4372BC+235o
					; sub_437653+39Co
		align 10h
; char aCanTRemoveTheL[]
aCanTRemoveTheL	db 'can',27h,'t remove the last filter from the chain',0Ah,0
					; DATA XREF: sub_4372BC+287o
; char aIobufD_DPopped[]
aIobufD_DPopped	db 'iobuf-%d.%d: popped filter',0Ah,0 ; DATA XREF: sub_4372BC+35Co
		align 4
; char aOhhJeeeTryingT[]
aOhhJeeeTryingT	db 'Ohh jeee, trying to remove a head filter',0Ah,0
					; DATA XREF: sub_4372BC+374o
		align 4
; char aOhhJeeeTryin_0[]
aOhhJeeeTryin_0	db 'Ohh jeee, trying to remove an intermediate filter',0Ah,0
					; DATA XREF: sub_4372BC:loc_43763Co
; char aAD_startAD_len[]
aAD_startAD_len	db 'a->d.start == a->d.len',0 ; DATA XREF: sub_437653+29o
		align 4
; char aIobufD_DPopSIn[]
aIobufD_DPopSIn	db 'iobuf-%d.%d: pop `%s',27h,' in underflow',0Ah,0
					; DATA XREF: sub_437653+A6o
; char aIobufD_DUnderf[]
aIobufD_DUnderf	db 'iobuf-%d.%d: underflow: eof (due to filter eof)',0Ah,0
					; DATA XREF: sub_437653+17Do
; char aIobufD_DError[]
aIobufD_DError	db 'iobuf-%d.%d: error',0Ah,0 ; DATA XREF: sub_437653+1BAo
		align 10h
; char aIobufD_DUnde_0[]
aIobufD_DUnde_0	db 'iobuf-%d.%d: underflow: req=%lu',0Ah,0 ; DATA XREF: sub_437653+2B9o
		align 4
; char aIobufD_DUnde_1[]
aIobufD_DUnde_1	db 'iobuf-%d.%d: underflow: got=%lu rc=%d',0Ah,0
					; DATA XREF: sub_437653+327o
		align 4
; char aIobufD_DPopInU[]
aIobufD_DPopInU	db 'iobuf-%d.%d: pop in underflow (!len)',0Ah,0 ; DATA XREF: sub_437653+43Bo
; char aIobufD_DUnde_2[]
aIobufD_DUnde_2	db 'iobuf-%d.%d: underflow: eof',0Ah,0 ; DATA XREF: sub_437653+521o
		align 10h
; char aIobufD_DUnde_3[]
aIobufD_DUnde_3	db 'iobuf-%d.%d: underflow: eof (no filter)',0Ah,0
					; DATA XREF: sub_437653+584o
		align 4
; char aIncreasingTemp[]
aIncreasingTemp	db 'increasing temp iobuf from %lu to %lu',0Ah,0 ; DATA XREF: sub_437BF0+52o
; char aFlushOnNonOutp[]
aFlushOnNonOutp	db 'flush on non-output iobuf',0Ah,0 ; DATA XREF: sub_437BF0+C1o
; char aIobuf_flushNoF[]
aIobuf_flushNoF	db 'iobuf_flush: no filter',0Ah,0 ; DATA XREF: sub_437BF0+D7o
		align 4
; char aIobuf_flushDid[]
aIobuf_flushDid	db 'iobuf_flush did not write all!',0Ah,0 ; DATA XREF: sub_437BF0+136o
aAD_start1	db 'a->d.start == 1',0  ; DATA XREF: .text:00438029o
; char aAD_lenAD_size[]
aAD_lenAD_size	db 'a->d.len < a->d.size',0 ; DATA XREF: sub_438085+75o
; char aFstatFailedS[]
aFstatFailedS	db 'fstat() failed: %s',0Ah,0 ; DATA XREF: sub_438394+6Co
; CHAR aKernel32_dll[]
aKernel32_dll	db 'kernel32.dll',0     ; DATA XREF: sub_438394+C8o
; CHAR aGetfilesizeex[]
aGetfilesizeex	db 'GetFileSizeEx',0    ; DATA XREF: sub_438394+DDo
; char aGetfilesizeFor[]
aGetfilesizeFor	db 'GetFileSize for handle %p failed: %s',0Ah,0 ; DATA XREF: sub_438394+1A9o
aCanTSeekS	db 'can',27h,'t seek: %s',0Ah,0 ; DATA XREF: .text:00438654o
		align 4
aSetfilepointer	db 'SetFilePointer failed on handle %p: ec=%d',0Ah,0
					; DATA XREF: .text:004386FFo
		align 10h
aPop_filterCall	db 'pop_filter called in iobuf_seek - please report',0Ah,0
					; DATA XREF: .text:0043877Fo
aAUse1AUse2	db 'a->use == 1 || a->use == 2',0 ; DATA XREF: .text:004388ACo
aPop_filterCa_0	db 'pop_filter called in set_partial_block_mode - please report',0Ah,0
					; DATA XREF: .text:004388D5o
		align 4
; char aGetstdhandleDF[]
aGetstdhandleDF	db 'GetStdHandle(%d) failed: ec=%d',0Ah,0 ; DATA XREF: sub_438B16+78o
aIobuf_write	db 'iobuf_write',0      ; DATA XREF: sub_43812A+16o
aIobuf_writebyt	db 'iobuf_writebyte',0  ; DATA XREF: sub_438085+10o
aPop_filter	db 'pop_filter',0       ; DATA XREF: sub_4372BC+21o
aIobuf_push_fil	db 'iobuf_push_filter2',0 ; DATA XREF: sub_436F81+21o
aBlock_filter	db 'block_filter',0     ; DATA XREF: sub_43542D:loc_435900o
					; sub_43542D:loc_435C86o ...
		align 4
asc_44E7A4	db ' ',9,0Dh,0Ah,0      ; DATA XREF: .text:004390BAo
					; .text:00439152o
a_		db '.',0                ; DATA XREF: .text:0043923Fo
		align 4
a____Gnupg22_13	db '../../gnupg2-2.0.30/jnlib/stringhelp.c',0 ; DATA XREF: sub_4392A6+A0o
; char aHome_0[]
aHome_0		db 'HOME',0             ; DATA XREF: sub_4392A6:loc_4393C7o
; char aX02x_0[]
aX02x_0		db 'x%02x',0            ; DATA XREF: sub_43985B+164o
					; sub_439C0F+1B0o
word_44E7DE	dw 0			; DATA XREF: .text:0043A69Fo
					; sub_43A6D2+Co
aFatalTooManyAr	db 0Ah			; DATA XREF: sub_43A6D2+56o
		db 'fatal: too many args for xstrconcat',0Ah,0
aFatalOutOfMemo	db 0Ah			; DATA XREF: sub_43A6D2+81o
		db 'fatal: out of memory',0Ah,0
aDo_make_filena	db 'do_make_filename',0 ; DATA XREF: sub_4392A6+90o
		align 10h
; char aLc_all[]
aLc_all		db 'LC_ALL',0           ; DATA XREF: sub_43A788+6o
; char aLang[]
aLang		db 'LANG',0             ; DATA XREF: sub_43A788:loc_43A7DBo
aAf_za		db 'af_ZA',0            ; DATA XREF: sub_43A788:loc_43A846o
aSq_al		db 'sq_AL',0            ; DATA XREF: sub_43A788:loc_43A850o
aAm_et		db 'am_ET',0            ; DATA XREF: sub_43A788:loc_43A85Ao
aAr_sa		db 'ar_SA',0            ; DATA XREF: sub_43A788:loc_43A87Do
aAr_iq		db 'ar_IQ',0            ; DATA XREF: sub_43A788:loc_43A887o
aAr_eg		db 'ar_EG',0            ; DATA XREF: sub_43A788:loc_43A891o
aAr_ly		db 'ar_LY',0            ; DATA XREF: sub_43A788:loc_43A89Bo
aAr_dz		db 'ar_DZ',0            ; DATA XREF: sub_43A788:loc_43A8A5o
aAr_ma		db 'ar_MA',0            ; DATA XREF: sub_43A788:loc_43A8AFo
aAr_tn		db 'ar_TN',0            ; DATA XREF: sub_43A788:loc_43A8B9o
aAr_om		db 'ar_OM',0            ; DATA XREF: sub_43A788:loc_43A8C3o
aAr_ye		db 'ar_YE',0            ; DATA XREF: sub_43A788:loc_43A8CDo
aAr_sy		db 'ar_SY',0            ; DATA XREF: sub_43A788:loc_43A8D7o
aAr_jo		db 'ar_JO',0            ; DATA XREF: sub_43A788:loc_43A8E1o
aAr_lb		db 'ar_LB',0            ; DATA XREF: sub_43A788:loc_43A8EBo
aAr_kw		db 'ar_KW',0            ; DATA XREF: sub_43A788:loc_43A8F5o
aAr_ae		db 'ar_AE',0            ; DATA XREF: sub_43A788:loc_43A8FFo
aAr_bh		db 'ar_BH',0            ; DATA XREF: sub_43A788:loc_43A909o
aAr_qa		db 'ar_QA',0            ; DATA XREF: sub_43A788:loc_43A913o
aAr		db 'ar',0               ; DATA XREF: sub_43A788:loc_43A91Do
aHy_am		db 'hy_AM',0            ; DATA XREF: sub_43A788:loc_43A927o
aAs_in		db 'as_IN',0            ; DATA XREF: sub_43A788:loc_43A931o
aAz_az@latin	db 'az_AZ@latin',0      ; DATA XREF: sub_43A788:loc_43A94Ao
aAz_az@cyrillic	db 'az_AZ@cyrillic',0   ; DATA XREF: sub_43A788:loc_43A954o
aAz		db 'az',0               ; DATA XREF: sub_43A788:loc_43A95Eo
aEu		db 'eu',0               ; DATA XREF: sub_43A788:loc_43A968o
aBe_by		db 'be_BY',0            ; DATA XREF: sub_43A788:loc_43A972o
aBn_in		db 'bn_IN',0            ; DATA XREF: sub_43A788:loc_43A98Bo
aBn_bd		db 'bn_BD',0            ; DATA XREF: sub_43A788:loc_43A995o
aBn		db 'bn',0               ; DATA XREF: sub_43A788:loc_43A99Fo
aBg_bg		db 'bg_BG',0            ; DATA XREF: sub_43A788:loc_43A9A9o
aMy_mm		db 'my_MM',0            ; DATA XREF: sub_43A788:loc_43A9B3o
aKm_kh		db 'km_KH',0            ; DATA XREF: sub_43A788:loc_43A9BDo
aCa_es		db 'ca_ES',0            ; DATA XREF: sub_43A788:loc_43A9C7o
aChr_us		db 'chr_US',0           ; DATA XREF: sub_43A788:loc_43A9D1o
aZh_tw		db 'zh_TW',0            ; DATA XREF: sub_43A788:loc_43A9F0o
aZh_cn		db 'zh_CN',0            ; DATA XREF: sub_43A788:loc_43A9FAo
aZh_hk		db 'zh_HK',0            ; DATA XREF: sub_43A788:loc_43AA04o
aZh_sg		db 'zh_SG',0            ; DATA XREF: sub_43A788:loc_43AA0Eo
aZh_mo		db 'zh_MO',0            ; DATA XREF: sub_43A788:loc_43AA18o
aZh		db 'zh',0               ; DATA XREF: sub_43A788:loc_43AA22o
aHr_hr		db 'hr_HR',0            ; DATA XREF: sub_43A788+2B6o
aSr_cs		db 'sr_CS',0            ; DATA XREF: sub_43A788:loc_43AA48o
aSr_cs@cyrillic	db 'sr_CS@cyrillic',0   ; DATA XREF: sub_43A788:loc_43AA52o
aHr		db 'hr',0               ; DATA XREF: sub_43A788:loc_43AA5Co
aCs_cz		db 'cs_CZ',0            ; DATA XREF: sub_43A788:loc_43AA66o
aDa_dk		db 'da_DK',0            ; DATA XREF: sub_43A788:loc_43AA70o
aDiv_mv		db 'div_MV',0           ; DATA XREF: sub_43A788:loc_43AA7Ao
aNl_nl		db 'nl_NL',0            ; DATA XREF: sub_43A788:loc_43AA93o
aNl_be		db 'nl_BE',0            ; DATA XREF: sub_43A788:loc_43AA9Do
aNl		db 'nl',0               ; DATA XREF: sub_43A788:loc_43AAA7o
aBin_ng		db 'bin_NG',0           ; DATA XREF: sub_43A788:loc_43AAB1o
aEn_us		db 'en_US',0            ; DATA XREF: sub_43A788:loc_43AAD4o
aEn_gb		db 'en_GB',0            ; DATA XREF: sub_43A788:loc_43AADEo
aEn_au		db 'en_AU',0            ; DATA XREF: sub_43A788:loc_43AAE8o
aEn_ca		db 'en_CA',0            ; DATA XREF: sub_43A788:loc_43AAF2o
aEn_nz		db 'en_NZ',0            ; DATA XREF: sub_43A788:loc_43AAFCo
aEn_ie		db 'en_IE',0            ; DATA XREF: sub_43A788:loc_43AB06o
aEn_za		db 'en_ZA',0            ; DATA XREF: sub_43A788:loc_43AB10o
aEn_jm		db 'en_JM',0            ; DATA XREF: sub_43A788:loc_43AB1Ao
aEn_gd		db 'en_GD',0            ; DATA XREF: sub_43A788:loc_43AB24o
aEn_bz		db 'en_BZ',0            ; DATA XREF: sub_43A788:loc_43AB2Eo
aEn_tt		db 'en_TT',0            ; DATA XREF: sub_43A788:loc_43AB38o
aEn_zw		db 'en_ZW',0            ; DATA XREF: sub_43A788:loc_43AB42o
aEn_ph		db 'en_PH',0            ; DATA XREF: sub_43A788:loc_43AB4Co
aEn_id		db 'en_ID',0            ; DATA XREF: sub_43A788:loc_43AB56o
aEn_hk		db 'en_HK',0            ; DATA XREF: sub_43A788:loc_43AB60o
aEn_in		db 'en_IN',0            ; DATA XREF: sub_43A788:loc_43AB6Ao
aEn_my		db 'en_MY',0            ; DATA XREF: sub_43A788:loc_43AB74o
aEn_sg		db 'en_SG',0            ; DATA XREF: sub_43A788:loc_43AB7Eo
aEn		db 'en',0               ; DATA XREF: sub_43A788:loc_43AB88o
aEt_ee		db 'et_EE',0            ; DATA XREF: sub_43A788:loc_43AB92o
aFo_fo		db 'fo_FO',0            ; DATA XREF: sub_43A788:loc_43AB9Co
aFa_ir		db 'fa_IR',0            ; DATA XREF: sub_43A788:loc_43ABA6o
aFi_fi		db 'fi_FI',0            ; DATA XREF: sub_43A788:loc_43ABB0o
aFr_fr		db 'fr_FR',0            ; DATA XREF: sub_43A788:loc_43ABD3o
aFr_be		db 'fr_BE',0            ; DATA XREF: sub_43A788:loc_43ABDDo
aFr_ca		db 'fr_CA',0            ; DATA XREF: sub_43A788:loc_43ABE7o
aFr_ch		db 'fr_CH',0            ; DATA XREF: sub_43A788:loc_43ABF1o
aFr_lu		db 'fr_LU',0            ; DATA XREF: sub_43A788:loc_43ABFBo
aFr_mc		db 'fr_MC',0            ; DATA XREF: sub_43A788:loc_43AC05o
aFr		db 'fr',0               ; DATA XREF: sub_43A788:loc_43AC0Fo
					; sub_43A788:loc_43AC69o
aFr_re		db 'fr_RE',0            ; DATA XREF: sub_43A788:loc_43AC19o
aFr_cg		db 'fr_CG',0            ; DATA XREF: sub_43A788:loc_43AC23o
aFr_sn		db 'fr_SN',0            ; DATA XREF: sub_43A788:loc_43AC2Do
aFr_cm		db 'fr_CM',0            ; DATA XREF: sub_43A788:loc_43AC37o
aFr_ci		db 'fr_CI',0            ; DATA XREF: sub_43A788:loc_43AC41o
aFr_ml		db 'fr_ML',0            ; DATA XREF: sub_43A788:loc_43AC4Bo
aFr_ma		db 'fr_MA',0            ; DATA XREF: sub_43A788:loc_43AC55o
aFr_ht		db 'fr_HT',0            ; DATA XREF: sub_43A788:loc_43AC5Fo
aFy_nl		db 'fy_NL',0            ; DATA XREF: sub_43A788:loc_43AC73o
aFul_ng		db 'ful_NG',0           ; DATA XREF: sub_43A788:loc_43AC7Do
aGd_gb		db 'gd_GB',0            ; DATA XREF: sub_43A788:loc_43AC96o
aGa_ie		db 'ga_IE',0            ; DATA XREF: sub_43A788:loc_43ACA0o
aC		db 'C',0                ; DATA XREF: sub_43A788:loc_43ACAAo
					; sub_43A788:loc_43B2C8o
aGl_es		db 'gl_ES',0            ; DATA XREF: sub_43A788:loc_43ACB4o
aKa_ge		db 'ka_GE',0            ; DATA XREF: sub_43A788:loc_43ACBEo
aDe_de		db 'de_DE',0            ; DATA XREF: sub_43A788:loc_43ACDDo
aDe_ch		db 'de_CH',0            ; DATA XREF: sub_43A788:loc_43ACE7o
aDe_at		db 'de_AT',0            ; DATA XREF: sub_43A788:loc_43ACF1o
aDe_lu		db 'de_LU',0            ; DATA XREF: sub_43A788:loc_43ACFBo
aDe_li		db 'de_LI',0            ; DATA XREF: sub_43A788:loc_43AD05o
aDe		db 'de',0               ; DATA XREF: sub_43A788:loc_43AD0Fo
aEl_gr		db 'el_GR',0            ; DATA XREF: sub_43A788:loc_43AD19o
aGn_py		db 'gn_PY',0            ; DATA XREF: sub_43A788:loc_43AD23o
aGu_in		db 'gu_IN',0            ; DATA XREF: sub_43A788:loc_43AD2Do
aHa_ng		db 'ha_NG',0            ; DATA XREF: sub_43A788:loc_43AD37o
aCpe_us		db 'cpe_US',0           ; DATA XREF: sub_43A788:loc_43AD41o
aHe_il		db 'he_IL',0            ; DATA XREF: sub_43A788:loc_43AD4Bo
aHi_in		db 'hi_IN',0            ; DATA XREF: sub_43A788:loc_43AD55o
aHu_hu		db 'hu_HU',0            ; DATA XREF: sub_43A788:loc_43AD5Fo
aNic_ng		db 'nic_NG',0           ; DATA XREF: sub_43A788:loc_43AD69o
aIs_is		db 'is_IS',0            ; DATA XREF: sub_43A788:loc_43AD73o
aIbo_ng		db 'ibo_NG',0           ; DATA XREF: sub_43A788:loc_43AD7Do
aId_id		db 'id_ID',0            ; DATA XREF: sub_43A788:loc_43AD87o
aIu_ca		db 'iu_CA',0            ; DATA XREF: sub_43A788:loc_43AD91o
aIt_it		db 'it_IT',0            ; DATA XREF: sub_43A788:loc_43ADAAo
aIt_ch		db 'it_CH',0            ; DATA XREF: sub_43A788:loc_43ADB4o
aIt		db 'it',0               ; DATA XREF: sub_43A788:loc_43ADBEo
aJa_jp		db 'ja_JP',0            ; DATA XREF: sub_43A788:loc_43ADC8o
aKn_in		db 'kn_IN',0            ; DATA XREF: sub_43A788:loc_43ADD2o
aKau_ng		db 'kau_NG',0           ; DATA XREF: sub_43A788:loc_43ADDCo
aKs_pk		db 'ks_PK',0            ; DATA XREF: sub_43A788:loc_43ADF5o
aKs_in		db 'ks_IN',0            ; DATA XREF: sub_43A788:loc_43ADFFo
aKs		db 'ks',0               ; DATA XREF: sub_43A788:loc_43AE09o
aKk_kz		db 'kk_KZ',0            ; DATA XREF: sub_43A788:loc_43AE13o
aKok_in		db 'kok_IN',0           ; DATA XREF: sub_43A788:loc_43AE1Do
aKo_kr		db 'ko_KR',0            ; DATA XREF: sub_43A788:loc_43AE27o
aKy_kg		db 'ky_KG',0            ; DATA XREF: sub_43A788:loc_43AE31o
aLo_la		db 'lo_LA',0            ; DATA XREF: sub_43A788:loc_43AE3Bo
aLa_va		db 'la_VA',0            ; DATA XREF: sub_43A788:loc_43AE45o
aLv_lv		db 'lv_LV',0            ; DATA XREF: sub_43A788:loc_43AE4Fo
aLt_lt		db 'lt_LT',0            ; DATA XREF: sub_43A788:loc_43AE59o
aMk_mk		db 'mk_MK',0            ; DATA XREF: sub_43A788:loc_43AE63o
aMs_my		db 'ms_MY',0            ; DATA XREF: sub_43A788:loc_43AE7Co
aMs_bn		db 'ms_BN',0            ; DATA XREF: sub_43A788:loc_43AE86o
aMs		db 'ms',0               ; DATA XREF: sub_43A788:loc_43AE90o
aMl_in		db 'ml_IN',0            ; DATA XREF: sub_43A788:loc_43AE9Ao
aMt_mt		db 'mt_MT',0            ; DATA XREF: sub_43A788:loc_43AEA4o
aMni_in		db 'mni_IN',0           ; DATA XREF: sub_43A788:loc_43AEAEo
aMr_in		db 'mr_IN',0            ; DATA XREF: sub_43A788:loc_43AEB8o
aMn		db 'mn',0               ; DATA XREF: sub_43A788:loc_43AEC2o
aNe_np		db 'ne_NP',0            ; DATA XREF: sub_43A788:loc_43AEDBo
aNe_in		db 'ne_IN',0            ; DATA XREF: sub_43A788:loc_43AEE5o
aNe		db 'ne',0               ; DATA XREF: sub_43A788:loc_43AEEFo
aNo_no		db 'no_NO',0            ; DATA XREF: sub_43A788:loc_43AF08o
aNn_no		db 'nn_NO',0            ; DATA XREF: sub_43A788:loc_43AF12o
aNo_0		db 'no',0               ; DATA XREF: sub_43A788:loc_43AF1Co
aOr_in		db 'or_IN',0            ; DATA XREF: sub_43A788:loc_43AF26o
aOm_et		db 'om_ET',0            ; DATA XREF: sub_43A788:loc_43AF30o
aPap_an		db 'pap_AN',0           ; DATA XREF: sub_43A788:loc_43AF3Ao
aPs		db 'ps',0               ; DATA XREF: sub_43A788:loc_43AF44o
aPl_pl		db 'pl_PL',0            ; DATA XREF: sub_43A788:loc_43AF4Eo
aPt_pt		db 'pt_PT',0            ; DATA XREF: sub_43A788+7DDo
aPt_br		db 'pt_BR',0            ; DATA XREF: sub_43A788:loc_43AF6Fo
aPt		db 'pt',0               ; DATA XREF: sub_43A788:loc_43AF79o
aPa_in		db 'pa_IN',0            ; DATA XREF: sub_43A788+803o
aPa		db 'pa',0               ; DATA XREF: sub_43A788:loc_43AF95o
aRm_ch		db 'rm_CH',0            ; DATA XREF: sub_43A788:loc_43AF9Fo
aRo_ro		db 'ro_RO',0            ; DATA XREF: sub_43A788+829o
aRo		db 'ro',0               ; DATA XREF: sub_43A788:loc_43AFBBo
aRu		db 'ru',0               ; DATA XREF: sub_43A788:loc_43AFC5o
aSe_no		db 'se_NO',0            ; DATA XREF: sub_43A788:loc_43AFCFo
aSa_in		db 'sa_IN',0            ; DATA XREF: sub_43A788:loc_43AFD9o
aSd_in		db 'sd_IN',0            ; DATA XREF: sub_43A788:loc_43AFF1o
aSd_pk		db 'sd_PK',0            ; DATA XREF: sub_43A788:loc_43AFFBo
aSd		db 'sd',0               ; DATA XREF: sub_43A788:loc_43B005o
aSi_lk		db 'si_LK',0            ; DATA XREF: sub_43A788:loc_43B00Fo
aSk_sk		db 'sk_SK',0            ; DATA XREF: sub_43A788:loc_43B019o
aSl_si		db 'sl_SI',0            ; DATA XREF: sub_43A788:loc_43B023o
aSo_so		db 'so_SO',0            ; DATA XREF: sub_43A788:loc_43B02Do
aWen_de		db 'wen_DE',0           ; DATA XREF: sub_43A788:loc_43B037o
aEs_es		db 'es_ES',0            ; DATA XREF: sub_43A788:loc_43B05Ao
aEs_mx		db 'es_MX',0            ; DATA XREF: sub_43A788:loc_43B064o
aEs_es@modern	db 'es_ES@modern',0     ; DATA XREF: sub_43A788:loc_43B06Eo
aEs_gt		db 'es_GT',0            ; DATA XREF: sub_43A788:loc_43B078o
aEs_cr		db 'es_CR',0            ; DATA XREF: sub_43A788:loc_43B082o
aEs_pa		db 'es_PA',0            ; DATA XREF: sub_43A788:loc_43B08Co
aEs_do		db 'es_DO',0            ; DATA XREF: sub_43A788:loc_43B096o
aEs_ve		db 'es_VE',0            ; DATA XREF: sub_43A788:loc_43B0A0o
aEs_co		db 'es_CO',0            ; DATA XREF: sub_43A788:loc_43B0AAo
aEs_pe		db 'es_PE',0            ; DATA XREF: sub_43A788:loc_43B0B4o
aEs_ar		db 'es_AR',0            ; DATA XREF: sub_43A788:loc_43B0BEo
aEs_ec		db 'es_EC',0            ; DATA XREF: sub_43A788:loc_43B0C8o
aEs_cl		db 'es_CL',0            ; DATA XREF: sub_43A788:loc_43B0D2o
aEs_uy		db 'es_UY',0            ; DATA XREF: sub_43A788:loc_43B0DCo
aEs_py		db 'es_PY',0            ; DATA XREF: sub_43A788:loc_43B0E6o
aEs_bo		db 'es_BO',0            ; DATA XREF: sub_43A788:loc_43B0F0o
aEs_sv		db 'es_SV',0            ; DATA XREF: sub_43A788:loc_43B0FAo
aEs_hn		db 'es_HN',0            ; DATA XREF: sub_43A788:loc_43B104o
aEs_ni		db 'es_NI',0            ; DATA XREF: sub_43A788:loc_43B10Eo
aEs_pr		db 'es_PR',0            ; DATA XREF: sub_43A788:loc_43B118o
aEs		db 'es',0               ; DATA XREF: sub_43A788:loc_43B122o
aBnt_tz		db 'bnt_TZ',0           ; DATA XREF: sub_43A788:loc_43B12Co
aSw_ke		db 'sw_KE',0            ; DATA XREF: sub_43A788:loc_43B136o
aSv_se		db 'sv_SE',0            ; DATA XREF: sub_43A788:loc_43B14Fo
aSv_fi		db 'sv_FI',0            ; DATA XREF: sub_43A788:loc_43B159o
aSv		db 'sv',0               ; DATA XREF: sub_43A788:loc_43B163o
aSyr_tr		db 'syr_TR',0           ; DATA XREF: sub_43A788:loc_43B16Do
aTl_ph		db 'tl_PH',0            ; DATA XREF: sub_43A788:loc_43B177o
aTg_tj		db 'tg_TJ',0            ; DATA XREF: sub_43A788:loc_43B181o
aBer_ma@arabic	db 'ber_MA@arabic',0    ; DATA XREF: sub_43A788:loc_43B19Ao
aBer_ma@latin	db 'ber_MA@latin',0     ; DATA XREF: sub_43A788:loc_43B1A4o
aBer_ma		db 'ber_MA',0           ; DATA XREF: sub_43A788:loc_43B1AEo
aTa		db 'ta',0               ; DATA XREF: sub_43A788:loc_43B1B8o
aTt_ru		db 'tt_RU',0            ; DATA XREF: sub_43A788:loc_43B1C2o
aTe_in		db 'te_IN',0            ; DATA XREF: sub_43A788:loc_43B1CCo
aTh_th		db 'th_TH',0            ; DATA XREF: sub_43A788:loc_43B1D6o
aBo_cn		db 'bo_CN',0            ; DATA XREF: sub_43A788:loc_43B1E0o
aTi_et		db 'ti_ET',0            ; DATA XREF: sub_43A788:loc_43B1F8o
aTi_er		db 'ti_ER',0            ; DATA XREF: sub_43A788:loc_43B202o
aTi		db 'ti',0               ; DATA XREF: sub_43A788:loc_43B20Co
aTs_za		db 'ts_ZA',0            ; DATA XREF: sub_43A788:loc_43B216o
aTn_bw		db 'tn_BW',0            ; DATA XREF: sub_43A788:loc_43B220o
aTr_tr		db 'tr_TR',0            ; DATA XREF: sub_43A788:loc_43B22Ao
aTk_tm		db 'tk_TM',0            ; DATA XREF: sub_43A788:loc_43B234o
aUk_ua		db 'uk_UA',0            ; DATA XREF: sub_43A788:loc_43B23Eo
aUr_pk		db 'ur_PK',0            ; DATA XREF: sub_43A788:loc_43B257o
aUr_in		db 'ur_IN',0            ; DATA XREF: sub_43A788:loc_43B25Eo
aUr		db 'ur',0               ; DATA XREF: sub_43A788:loc_43B265o
aUz_uz		db 'uz_UZ',0            ; DATA XREF: sub_43A788:loc_43B27Bo
aUz_uz@cyrillic	db 'uz_UZ@cyrillic',0   ; DATA XREF: sub_43A788:loc_43B282o
aUz		db 'uz',0               ; DATA XREF: sub_43A788:loc_43B289o
aVen_za		db 'ven_ZA',0           ; DATA XREF: sub_43A788:loc_43B290o
aVi_vn		db 'vi_VN',0            ; DATA XREF: sub_43A788:loc_43B297o
aCy_gb		db 'cy_GB',0            ; DATA XREF: sub_43A788:loc_43B29Eo
aXh_za		db 'xh_ZA',0            ; DATA XREF: sub_43A788:loc_43B2A5o
aSit_cn		db 'sit_CN',0           ; DATA XREF: sub_43A788:loc_43B2ACo
aYi_il		db 'yi_IL',0            ; DATA XREF: sub_43A788:loc_43B2B3o
aYo_ng		db 'yo_NG',0            ; DATA XREF: sub_43A788:loc_43B2BAo
aZu_za		db 'zu_ZA',0            ; DATA XREF: sub_43A788:loc_43B2C1o
		align 4
off_44ED98	dd offset loc_43B2C8, offset loc_43A864, offset	loc_43A9A9
					; DATA XREF: sub_43A788+B5o
		dd offset loc_43A9C7, offset loc_43A9DB, offset	loc_43AA66 ; jump table	for switch statement
		dd offset loc_43AA70, offset loc_43ACC8, offset	loc_43AD19
		dd offset loc_43AABB, offset loc_43B041, offset	loc_43ABB0
		dd offset loc_43ABBA, offset loc_43AD4B, offset	loc_43AD5F
		dd offset loc_43AD73, offset loc_43AD9B, offset	loc_43ADC8
		dd offset loc_43AE27, offset loc_43AA84, offset	loc_43AEF9
		dd offset loc_43AF4E, offset loc_43AF58, offset	loc_43AF9F
		dd offset loc_43AFA9, offset loc_43AFC5, offset	loc_43AA2C
		dd offset loc_43B019, offset loc_43A850, offset	loc_43B140
		dd offset loc_43B1D6, offset loc_43B22A, offset	loc_43B248
		dd offset loc_43AD87, offset loc_43B23E, offset	loc_43A972
		dd offset loc_43B023, offset loc_43AB92, offset	loc_43AE4F
		dd offset loc_43AE59, offset loc_43B181, offset	loc_43ABA6
		dd offset loc_43B297, offset loc_43A927, offset	loc_43A93B
		dd offset loc_43A968, offset loc_43B037, offset	loc_43AE63
		dd offset loc_43B12C, offset loc_43B216, offset	loc_43B220
		dd offset loc_43B290, offset loc_43B2A5, offset	loc_43B2C1
		dd offset loc_43A846, offset loc_43ACBE, offset	loc_43AB9C
		dd offset loc_43AD55, offset loc_43AEA4, offset	loc_43AFCF
		dd offset loc_43AC87, offset loc_43B2B3, offset	loc_43AE6D
		dd offset loc_43AE13, offset loc_43AE31, offset	loc_43B136
		dd offset loc_43B234, offset loc_43B26C, offset	loc_43B1C2
		dd offset loc_43A97C, offset loc_43AF83, offset	loc_43AD2D
		dd offset loc_43AF26, offset loc_43B1B8, offset	loc_43B1CC
		dd offset loc_43ADD2, offset loc_43AE9A, offset	loc_43A931
		dd offset loc_43AEB8, offset loc_43AFD9, offset	loc_43AEC2
		dd offset loc_43B1E0, offset loc_43B29E, offset	loc_43A9BD
		dd offset loc_43AE3B, offset loc_43A9B3, offset	loc_43ACB4
		dd offset loc_43AE1D, offset loc_43AEAE, offset	loc_43AFE3
		dd offset loc_43B16D, offset loc_43B00F, offset	loc_43A9D1
		dd offset loc_43AD91, offset loc_43A85A, offset	loc_43B18B
		dd offset loc_43ADE6, offset loc_43AECC, offset	loc_43AC73
		dd offset loc_43AF44, offset loc_43B177, offset	loc_43AA7A
		dd offset loc_43AAB1, offset loc_43AC7D, offset	loc_43AD37
		dd offset loc_43AD69, offset loc_43B2BA, offset	loc_43B2C8
		dd offset loc_43B2C8, offset loc_43B2C8, offset	loc_43B2C8
		dd offset loc_43B2C8, offset loc_43AD7D, offset	loc_43ADDC
		dd offset loc_43AF30, offset loc_43B1EA, offset	loc_43AD23
		dd offset loc_43AD41, offset loc_43AE45, offset	loc_43B02D
		dd offset loc_43B2AC, offset loc_43AF3A
off_44EF80	dd offset loc_43A91D	; DATA XREF: sub_43A788+ECo
		dd offset loc_43A87D	; jump table for switch	statement
		dd offset loc_43A887
		dd offset loc_43A891
		dd offset loc_43A89B
		dd offset loc_43A8A5
		dd offset loc_43A8AF
		dd offset loc_43A8B9
		dd offset loc_43A8C3
		dd offset loc_43A8CD
		dd offset loc_43A8D7
		dd offset loc_43A8E1
		dd offset loc_43A8EB
		dd offset loc_43A8F5
		dd offset loc_43A8FF
		dd offset loc_43A909
		dd offset loc_43A913
off_44EFC4	dd offset loc_43AA22	; DATA XREF: sub_43A788+25Fo
		dd offset loc_43A9F0	; jump table for switch	statement
		dd offset loc_43A9FA
		dd offset loc_43AA04
		dd offset loc_43AA0E
		dd offset loc_43AA18
off_44EFDC	dd offset loc_43AB88	; DATA XREF: sub_43A788+343o
		dd offset loc_43AAD4	; jump table for switch	statement
		dd offset loc_43AADE
		dd offset loc_43AAE8
		dd offset loc_43AAF2
		dd offset loc_43AAFC
		dd offset loc_43AB06
		dd offset loc_43AB10
		dd offset loc_43AB1A
		dd offset loc_43AB24
		dd offset loc_43AB2E
		dd offset loc_43AB38
		dd offset loc_43AB42
		dd offset loc_43AB4C
		dd offset loc_43AB56
		dd offset loc_43AB60
		dd offset loc_43AB6A
		dd offset loc_43AB74
		dd offset loc_43AB7E
off_44F028	dd offset loc_43AC69	; DATA XREF: sub_43A788+442o
		dd offset loc_43ABD3	; jump table for switch	statement
		dd offset loc_43ABDD
		dd offset loc_43ABE7
		dd offset loc_43ABF1
		dd offset loc_43ABFB
		dd offset loc_43AC05
		dd offset loc_43AC0F
		dd offset loc_43AC19
		dd offset loc_43AC23
		dd offset loc_43AC2D
		dd offset loc_43AC37
		dd offset loc_43AC41
		dd offset loc_43AC4B
		dd offset loc_43AC55
		dd offset loc_43AC5F
off_44F068	dd offset loc_43AD0F	; DATA XREF: sub_43A788+54Co
		dd offset loc_43ACDD	; jump table for switch	statement
		dd offset loc_43ACE7
		dd offset loc_43ACF1
		dd offset loc_43ACFB
		dd offset loc_43AD05
off_44F080	dd offset loc_43B122	; DATA XREF: sub_43A788+8C9o
		dd offset loc_43B05A	; jump table for switch	statement
		dd offset loc_43B064
		dd offset loc_43B06E
		dd offset loc_43B078
		dd offset loc_43B082
		dd offset loc_43B08C
		dd offset loc_43B096
		dd offset loc_43B0A0
		dd offset loc_43B0AA
		dd offset loc_43B0B4
		dd offset loc_43B0BE
		dd offset loc_43B0C8
		dd offset loc_43B0D2
		dd offset loc_43B0DC
		dd offset loc_43B0E6
		dd offset loc_43B0F0
		dd offset loc_43B0FA
		dd offset loc_43B104
		dd offset loc_43B10E
		dd offset loc_43B118
; char aRb_0[3]
aRb_0		db 'rb',0               ; DATA XREF: sub_43B3AE+16o
; char aLc_messages[]
aLc_messages	db 'LC_MESSAGES',0      ; DATA XREF: sub_43B952+16o
					; .text:0043C2A5o
aLc_messages_0	db '\LC_MESSAGES\',0    ; DATA XREF: sub_43B952+1AAo
a_mo		db '.mo',0              ; DATA XREF: sub_43B952+202o
		align 4
aErrorInGettext	db 'ERROR in GETTEXT (bad plural entry)',0 ; DATA XREF: sub_43BBAC+3Bo
aErrorInGette_0	db 'ERROR in GETTEXT MALLOC',0 ; DATA XREF: sub_43BC12+13Do
					; sub_43BC12:loc_43BE75o
aErrorInGette_1	db 'ERROR in GETTEXT (overflow space)',0Ah,0
					; DATA XREF: sub_43BC12:loc_43BEE9o
byte_44F157	db 0			; DATA XREF: .text:loc_43C2BFo
asc_44F158	db '-',0                ; DATA XREF: sub_43C309+55o
					; sub_43C568:loc_43C579o
aSocket		db 'socket://',0        ; DATA XREF: sub_43C309+9Do
aSystemDoesNotS	db 'system does not support logging to a socket - using stderr',0Ah,0
					; DATA XREF: sub_43C309+FDo
; char aA_0[]
aA_0		db 'a',0                ; DATA XREF: sub_43C309+131o
					; sub_43C309:loc_43C479o
		align 4
; char aFailedToOpenLo[]
aFailedToOpenLo	db 'failed to open log file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_43C309+1B1o
		align 4
; char aFailedToFdopen[]
aFailedToFdopen	db 'failed to fdopen file descriptor %d: %s',0Ah,0
					; DATA XREF: sub_43C309+1E9o
		align 4
; char a____Gnupg22_14[]
a____Gnupg22_14	db '../../gnupg2-2.0.30/jnlib/logging.c',0 ; DATA XREF: sub_43C72A+2Fo
; char aLogstream[]
aLogstream	db 'logstream',0        ; DATA XREF: sub_43C72A+37o
		align 4
; char a04d02d02d02d_0[]
a04d02d02d02d_0	db '%04d-%02d-%02d %02d:%02d:%02d ',0 ; DATA XREF: sub_43C72A+E3o
; char aU_Lx[]
aU_Lx		db '[%u.%lx]',0         ; DATA XREF: sub_43C72A+16Bo
; char aU_1[]
aU_1		db '[%u]',0             ; DATA XREF: sub_43C72A+192o
aFatal		db 'Fatal: ',0          ; DATA XREF: sub_43C72A+21Do
aOhhhhJeeee	db 'Ohhhh jeeee: ',0    ; DATA XREF: sub_43C72A+246o
aDbg		db 'DBG: ',0            ; DATA XREF: sub_43C72A+26Fo
; char aUnknownLogLeve[]
aUnknownLogLeve	db '[Unknown log level %d]: ',0 ; DATA XREF: sub_43C72A:loc_43C9BCo
		align 4
off_44F288	dd offset loc_43C9DB	; DATA XREF: sub_43C72A+20Eo
		dd offset loc_43C9DB	; jump table for switch	statement
		dd offset loc_43C9DB
		dd offset loc_43C9DB
		dd offset loc_43C9DB
		dd offset loc_43C941
		dd offset loc_43C96A
		dd offset loc_43C993
; char dword_44F2A8[]
dword_44F2A8	dd 207325h		; DATA XREF: sub_43CC18+1Do
; char a02x_2[]
a02x_2		db '%02X',0             ; DATA XREF: sub_43CC18+42o
; char a02x_3[]
a02x_3		db ' %02X',0            ; DATA XREF: sub_43CC18+65o
; char asc_44F2B7[]
asc_44F2B7	db 0Ah,0		; DATA XREF: sub_43CC18+8Ao
; char a___ThisIsABugS[]
a___ThisIsABugS	db '... this is a bug (%s:%d:%s)',0Ah,0 ; DATA XREF: sub_43CCB0+1Bo
		align 4
; char aInvalidArgumen[]
aInvalidArgumen	db 'invalid argument for arg_parsee',0Ah,0 ; DATA XREF: sub_43CCE4+81o
; char aArgumentNotExp[]
aArgumentNotExp	db 'argument not expected',0 ; DATA XREF: sub_43CCE4+B0o
; char aReadError[]
aReadError	db 'read error',0       ; DATA XREF: sub_43CCE4+CFo
; char aKeywordTooLong[]
aKeywordTooLong	db 'keyword too long',0 ; DATA XREF: sub_43CCE4+EEo
; char aMissingArgumen[]
aMissingArgumen	db 'missing argument',0 ; DATA XREF: sub_43CCE4+10Do
; char aInvalidArgum_0[]
aInvalidArgum_0	db 'invalid argument',0 ; DATA XREF: sub_43CCE4+129o
; char aInvalidCommand[]
aInvalidCommand	db 'invalid command',0  ; DATA XREF: sub_43CCE4+145o
; char aInvalidAliasDe[]
aInvalidAliasDe	db 'invalid alias definition',0 ; DATA XREF: sub_43CCE4+161o
; char aOutOfCore_0[]
aOutOfCore_0	db 'out of core',0      ; DATA XREF: sub_43CCE4+17Do
; char aInvalidOption[]
aInvalidOption	db 'invalid option',0   ; DATA XREF: sub_43CCE4:loc_43CE72o
; char aSUS[]
aSUS		db '%s:%u: %s',0Ah,0    ; DATA XREF: sub_43CCE4+1B4o
a??		db '[??]',0             ; DATA XREF: sub_43CCE4:loc_43CEBBo
		align 4
; char aMissingArgum_0[]
aMissingArgum_0	db 'missing argument for option "%.50s"',0Ah,0 ; DATA XREF: sub_43CCE4+1EAo
		align 4
; char aInvalidArgum_1[]
aInvalidArgum_1	db 'invalid argument for option "%.50s"',0Ah,0 ; DATA XREF: sub_43CCE4+215o
		align 4
; char aOption_50sDoes[]
aOption_50sDoes	db 'option "%.50s" does not expect an argument',0Ah,0
					; DATA XREF: sub_43CCE4+240o
; char aInvalidComma_0[]
aInvalidComma_0	db 'invalid command "%.50s"',0Ah,0 ; DATA XREF: sub_43CCE4+26Bo
; char aOption_50sIsAm[]
aOption_50sIsAm	db 'option "%.50s" is ambiguous',0Ah,0 ; DATA XREF: sub_43CCE4+296o
; char aCommand_50sIsA[]
aCommand_50sIsA	db 'command "%.50s" is ambiguous',0Ah,0 ; DATA XREF: sub_43CCE4+2BEo
; char aOutOfCore_1[]
aOutOfCore_1	db 'out of core',0Ah,0  ; DATA XREF: sub_43CCE4+2E6o
; char aS_3[]
aS_3		db '%s',0Ah,0           ; DATA XREF: sub_43CCE4+2F6o
; char aInvalidOption_[]
aInvalidOption_	db 'invalid option "%.50s"',0Ah,0 ; DATA XREF: sub_43CCE4:loc_43CFE8o
; char aIgnoreInvalidO[]
aIgnoreInvalidO	db 'ignore-invalid-option',0 ; DATA XREF: sub_43D24E+15Do
					; sub_43D24E:loc_43D86Ao
; char asc_44F4B3[]
asc_44F4B3	db ' ',9,0              ; DATA XREF: sub_43D24E+2D3o
; char aAlias[]
aAlias		db 'alias',0            ; DATA XREF: sub_43D24E+5EFo
; char aHelp[]
aHelp		db 'help',0             ; DATA XREF: sub_43DC31+1A6o
; char aVersion_0[]
aVersion_0	db 'version',0          ; DATA XREF: sub_43DC31+1E0o
; char aWarranty[]
aWarranty	db 'warranty',0         ; DATA XREF: sub_43DC31+222o
; char aDumpOptions[]
aDumpOptions	db 'dump-options',0     ; DATA XREF: sub_43DC31+266o
; char aS_4[]
aS_4		db '--%s',0Ah,0         ; DATA XREF: sub_43DC31+2B2o
		align 4
aDumpOptionsHel	db '--dump-options',0Ah ; DATA XREF: sub_43DC31+2DEo
		db '--help',0Ah
		db '--version',0Ah
		db '--warranty',0Ah,0
asc_44F514	db 'x',0                ; DATA XREF: sub_43DC31:loc_43E32Bo
; char aOptions[]
aOptions	db 'Options:',0         ; DATA XREF: sub_43E61C+CEo
; char aC_0[]
aC_0		db ' -%c',0             ; DATA XREF: sub_43E61C+1B1o
asc_44F524	db '   ',0              ; DATA XREF: sub_43E61C+245o
					; sub_43E61C+332o
; char aCS[]
aCS		db '%c --%s',0          ; DATA XREF: sub_43E61C:loc_43E8C0o
; char aASingleDashMay[]
aASingleDashMay	db 0Ah			; DATA XREF: sub_43E61C+45Co
		db '(A single dash may be used instead of the double ones)',0
; char a_email_[]
a@email@	db '@EMAIL@',0          ; DATA XREF: sub_43E61C+48Do
aHttpBugs_gnupg	db 'http://bugs.gnupg.org',0 ; DATA XREF: sub_43E61C+4F0o
; char aS_5[]
aS_5		db ' (%s)',0            ; DATA XREF: sub_43EB87+3Co
; char aSS[]
aSS		db ' %s %s',0Ah,0       ; DATA XREF: sub_43EB87+5Co
aGpg4win2_3_1	db '(Gpg4win 2.3.1)',0  ; DATA XREF: sub_43EB87+61o
aSSS_0		db '%s %s; %s',0Ah,0    ; DATA XREF: .text:0043ED51o
		align 10h
aLicenseGplv3Gn	db 'License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licens'
					; DATA XREF: sub_43EE3D:loc_43EE83o
		db 'es/gpl.html>',0
aFoo		db 'foo',0              ; DATA XREF: sub_43EE3D:loc_43EE8Co
a0_0		db '0.0',0              ; DATA XREF: sub_43EE3D:loc_43EE95o
		align 4
aCopyrightC2015	db 'Copyright (C) 2015 Free Software Foundation, Inc.',0
					; DATA XREF: sub_43EE3D:loc_43EE9Eo
		align 4
aThisIsFreeSoft	db 'This is free software: you are free to change and redistribute it'
					; DATA XREF: sub_43EE3D:loc_43EEA7o
		db '.',0Ah
		db 'There is NO WARRANTY, to the extent permitted by law.',0Ah,0
		align 4
aThisIsFreeSo_0	db 'This is free software; you can redistribute it and/or modify',0Ah
					; DATA XREF: sub_43EE3D:loc_43EEB0o
		db 'it under the terms of the GNU General Public License as published'
		db ' by',0Ah
		db 'the Free Software Foundation; either version 3 of the License, or'
		db 0Ah
		db '(at your option) any later version.',0Ah
		db 0Ah
		db 'It is distributed in the hope that it will be useful,',0Ah
		db 'but WITHOUT ANY WARRANTY; without even the implied warranty of',0Ah
		db 'MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the',0Ah
		db 'GNU General Public License for more details.',0Ah
		db 0Ah
		db 'You should have received a copy of the GNU General Public License'
		db 0Ah
		db 'along with this software.  If not, see <http://www.gnu.org/licens'
		db 'es/>.',0Ah,0
dword_44F90C	dd 0			; DATA XREF: sub_43EE3D:loc_43EEB9o
off_44F910	dd offset loc_43EE83	; DATA XREF: sub_43EE3D+3Dr
		dd offset loc_43EE8C	; jump table for switch	statement
		dd offset loc_43EEC1
		dd offset loc_43EE95
		dd offset loc_43EE9E
		dd offset loc_43EEA7
		dd offset loc_43EEB0
		dd offset loc_43EEC1
		dd offset loc_43EEC1
		dd offset loc_43EEC1
		dd offset loc_43EEC1
		dd offset loc_43EEC1
		dd offset loc_43EEC1
		dd offset loc_43EEC1
		dd offset loc_43EEC1
		dd offset loc_43EEC1
		dd offset loc_43EEC1
		dd offset loc_43EEC1
		dd offset loc_43EEC1
		dd offset loc_43EEC1
		dd offset loc_43EEC1
		dd offset loc_43EEC1
		dd offset loc_43EEC1
		dd offset loc_43EEC1
		dd offset loc_43EEC1
		dd offset loc_43EEC1
		dd offset loc_43EEC1
		dd offset loc_43EEC1
		dd offset loc_43EEC1
		dd offset loc_43EEC1
		dd offset loc_43EEB9
		dd offset loc_43EEB9
aIso88591	db 'iso-8859-1',0       ; DATA XREF: sub_43F21C+D9o
					; sub_43F31B:loc_43F4F0o ...
aUtf8_0		db 'utf-8',0            ; DATA XREF: sub_43F21C+22o
					; sub_43F31B+20Fo ...
		align 4
; char aConversionFrom[]
aConversionFrom	db 'conversion from `%s',27h,' to `%s',27h,' not available',0Ah,0
					; DATA XREF: sub_43F21C+71o
; char aIconv_openFail[]
aIconv_openFail	db 'iconv_open failed: %s',0Ah,0 ; DATA XREF: sub_43F21C+B1o
; char aCpU[]
aCpU		db 'CP%u',0             ; DATA XREF: sub_43F31B:loc_43F346o
aCp936		db 'CP936',0            ; DATA XREF: sub_43F31B+4Eo
aGbk		db 'GBK',0
aCp1361		db 'CP1361',0
aJohab		db 'JOHAB',0
aCp20127	db 'CP20127',0
aAscii_0	db 'ASCII',0
aCp20866	db 'CP20866',0
aKoi8R		db 'KOI8-R',0
aCp21866	db 'CP21866',0
aKoi8Ru		db 'KOI8-RU',0
aCp28591	db 'CP28591',0
aIso88591_0	db 'ISO-8859-1',0
aCp28592	db 'CP28592',0
aIso88592	db 'ISO-8859-2',0
aCp28593	db 'CP28593',0
aIso88593	db 'ISO-8859-3',0
aCp28594	db 'CP28594',0
aIso88594	db 'ISO-8859-4',0
aCp28595	db 'CP28595',0
aIso88595	db 'ISO-8859-5',0
aCp28596	db 'CP28596',0
aIso88596	db 'ISO-8859-6',0
aCp28597	db 'CP28597',0
aIso88597	db 'ISO-8859-7',0
aCp28598	db 'CP28598',0
aIso88598	db 'ISO-8859-8',0
aCp28599	db 'CP28599',0
aIso88599	db 'ISO-8859-9',0
aCp28605	db 'CP28605',0
aIso885915	db 'ISO-8859-15',0
aCp65001	db 'CP65001',0
aUtf8_2		db 'UTF-8',0
		align 2
aIso		db 'iso',0              ; DATA XREF: sub_43F31B+13Co
a88591		db '8859-1',0           ; DATA XREF: sub_43F31B+179o
a646		db '646',0              ; DATA XREF: sub_43F31B+190o
aAscii		db 'ASCII',0            ; DATA XREF: sub_43F31B+1A7o
aAnsi_x3_41968	db 'ANSI_X3.4-1968',0   ; DATA XREF: sub_43F31B+1BEo
aUtf8_1		db 'utf8',0             ; DATA XREF: sub_43F31B:loc_43F513o
		align 4
; char aConversionFr_0[]
aConversionFr_0	db 'conversion from `%s',27h,' to `%s',27h,' failed: %s',0Ah,0
					; DATA XREF: sub_43F631+1EEo
					; sub_43F87D+730o
; char aX02x_1[]
aX02x_1		db '\x%02x',0           ; DATA XREF: sub_43F87D+7Co
					; sub_43F87D+3AFo ...
; char aX02x_2[]
aX02x_2		db 'x%02x',0            ; DATA XREF: sub_43F87D+1DCo
		align 10h
a____Gnupg22_15	db '../../gnupg2-2.0.30/jnlib/utf8conv.c',0 ; DATA XREF: sub_43F87D+6BEo
		align 4
off_44FB88	dd offset loc_43FA30	; DATA XREF: sub_43F87D+12Ar
		dd offset loc_43FA46	; jump table for switch	statement
		dd offset loc_43FA46
		dd offset loc_43FA46
		dd offset loc_43FA46
		dd offset loc_43FA46
		dd offset loc_43FA46
		dd offset loc_43FA46
		dd offset loc_43FA1A
		dd offset loc_43FA46
		dd offset loc_43F9B0
		dd offset loc_43FA04
		dd offset loc_43F9EA
		dd offset loc_43F9CD
aDo_utf8_to_nat	db 'do_utf8_to_native',0 ; DATA XREF: sub_43F87D+6AEo
		align 4
aHkey_classes_r	db 'HKEY_CLASSES_ROOT',0 ; DATA XREF: sub_4400D8+1Fo
aHkey_current_u	db 'HKEY_CURRENT_USER',0 ; DATA XREF: sub_4400D8+53o
aHkey_local_mac	db 'HKEY_LOCAL_MACHINE',0 ; DATA XREF: sub_4400D8+87o
aHkey_users	db 'HKEY_USERS',0       ; DATA XREF: sub_4400D8+BBo
aHkey_performan	db 'HKEY_PERFORMANCE_DATA',0 ; DATA XREF: sub_4400D8+ECo
aHkey_current_c	db 'HKEY_CURRENT_CONFIG',0 ; DATA XREF: sub_4400D8+11Do
; char aTz[]
aTz		db 'TZ',0               ; DATA XREF: sub_4406AE+7o
					; sub_4406AE:loc_440764o
; char EnvString[]
EnvString	db 'TZ=UTC',0           ; DATA XREF: sub_4406AE+16o
aTz_0		db 'TZ=',0              ; DATA XREF: sub_4406AE+7Co
		align 20h
aAbcdefghijklmn	db 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789',0
					; DATA XREF: sub_440780+14Do
					; sub_440780+1AAo ...
aXxxxxx		db 'XXXXXX',0           ; DATA XREF: sub_440780+56o
		align 20h
; CHAR LibFileName[]
LibFileName	db 'mingwm10.dll',0     ; DATA XREF: TlsCallback_0+4Eo
; CHAR a__mingwthr_rem[]
a__mingwthr_rem	db '__mingwthr_remove_key_dtor',0 ; DATA XREF: TlsCallback_0+71o
; CHAR a__mingwthr_key[]
a__mingwthr_key	db '__mingwthr_key_dtor',0 ; DATA XREF: TlsCallback_0+8Bo
off_44FCFC	dd offset TlsCallback_0	; DATA XREF: sub_401180:loc_401273r
aUnknownError_0	db 'Unknown error',0    ; DATA XREF: sub_441370+3o
		align 10h
; char a_matherrSInSGG[]
a_matherrSInSGG	db '_matherr(): %s in %s(%g, %g)  (retval=%g)',0Ah,0
					; DATA XREF: sub_441370+39o
		align 4
aArgumentDomain	db 'Argument domain error (DOMAIN)',0 ; DATA XREF: .rdata:off_44FE1Co
aArgumentSingul	db 'Argument singularity (SIGN)',0 ; DATA XREF: .rdata:0044FE20o
		align 4
aOverflowRangeE	db 'Overflow range error (OVERFLOW)',0 ; DATA XREF: .rdata:0044FE24o
aTheResultIsToo	db 'The result is too small to be represented (UNDERFLOW)',0
					; DATA XREF: .rdata:0044FE28o
		align 10h
aTotalLossOfSig	db 'Total loss of significance (TLOSS)',0 ; DATA XREF: .rdata:0044FE2Co
		align 4
aPartialLossOfS	db 'Partial loss of significance (PLOSS)',0 ; DATA XREF: .rdata:0044FE30o
		align 4
off_44FE1C	dd offset aArgumentDomain ; DATA XREF: sub_441370+16r
					; "Argument domain error (DOMAIN)"
		dd offset aArgumentSingul ; "Argument singularity (SIGN)"
		dd offset aOverflowRangeE ; "Overflow range error (OVERFLOW)"
		dd offset aTheResultIsToo ; "The result	is too small to	be represent"...
		dd offset aTotalLossOfSig ; "Total loss	of significance	(TLOSS)"
		dd offset aPartialLossOfS ; "Partial loss of significance (PLOSS)"
aMingwW64Runtim	db 'Mingw-w64 runtime failure:',0Ah,0 ; DATA XREF: sub_4413E0+1Do
; char aAddressPHasNoI[]
aAddressPHasNoI	db 'Address %p has no image-section',0 ; DATA XREF: sub_441440+20Do
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: sub_441440+1F9o
					; sub_441440+225o ...
		align 4
; char aVirtualprotect[]
aVirtualprotect	db '  VirtualProtect failed with code 0x%x',0 ; DATA XREF: sub_441440+1D2o
		align 4
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_441680+299o
		align 10h
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_441680+1B7o
		align 4
; const	WCHAR aMsvcrt_dll
aMsvcrt_dll:				; DATA XREF: sub_441C30:loc_441CD0o
		unicode	0, <msvcrt.dll>,0
		align 4
off_44FF44	dd offset dword_451C80	; DATA XREF: .text:00441EC8o
		dd offset dword_4519A0
; char aAssertionFaile[]
aAssertionFaile	db 'Assertion failed!',0Ah ; DATA XREF: sub_442470+EAo
		db 0Ah
		db 'Program: %s',0Ah
		db 'File: %s, Line %u',0Ah
		db 0Ah
		db 'Expression: %s',0
; char aS_6[]
aS_6		db '%s',0Ah,0           ; DATA XREF: sub_442470+1C2o
; CHAR Caption[]
Caption		db 'MinGW Runtime Assertion',0 ; DATA XREF: sub_442470+10Fo
		align 20h
dword_44FFC0	dd 1			; DATA XREF: .text:loc_442D31r
dword_44FFC4	dd 16h			; DATA XREF: .text:00442D27r
					; .text:00442D3Fr
		dd 2 dup(2), 3,	2, 4, 18h, 5, 0Dh, 6, 9, 7, 0Ch, 8, 0Ch
		dd 9, 0Ch, 0Ah,	7, 0Bh,	8, 0Ch,	16h, 0Dh, 16h, 0Fh, 2
		dd 10h,	0Dh, 11h, 2 dup(12h), 2, 21h, 0Dh, 35h,	2, 41h
		dd 0Dh,	43h, 2,	50h, 11h, 52h, 0Dh, 53h, 0Dh, 57h, 16h
		dd 59h,	0Bh, 6Ch, 0Dh, 6Dh, 20h, 70h, 1Ch, 72h,	9, 6, 16h
		dd 80h,	0Ah, 81h, 0Ah, 82h, 9, 83h, 16h, 84h, 0Dh, 91h
		dd 29h,	9Eh, 0Dh, 0A1h,	2, 0A4h, 0Bh, 0A7h, 0Dh, 0B7h
		dd 11h,	0CEh, 2, 0D7h, 0Bh, 718h, 0Ch, 0
		dd 0FFFFFFFFh, 4 dup(0)
dword_450140	dd 0			; DATA XREF: sub_441680+59o
					; sub_441680+5Eo ...
dword_450144	dd 0			; DATA XREF: sub_441680+7Fr
dword_450148	dd 0			; DATA XREF: sub_441680:loc_4417CCr
dword_45014C	dd 2Dh dup(0)		; DATA XREF: sub_441680+155o
		align 1000h
_rdata		ends

; Section 4. (virtual address 00051000)
; Virtual size			: 00000DC0 (   3520.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 451000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_451000	dd ?			; DATA XREF: sub_401180+D0w
					; sub_401180+27Dr
dword_451004	dd ?			; DATA XREF: sub_401010+2Ao
					; sub_401180:loc_401344r ...
dword_451008	dd ?			; DATA XREF: sub_401010+18o
					; sub_401180+1DEr ...
dword_45100C	dd ?			; DATA XREF: sub_401010+10o
					; sub_401180+243r ...
dword_451010	dd ?			; DATA XREF: sub_401180+272w
					; sub_401180+28Cr
dword_451014	dd ?			; DATA XREF: sub_401060:loc_401098w
					; sub_401180+26Ar
dword_451018	dd ?			; DATA XREF: sub_401010+8o
					; sub_401010+20w
dword_45101C	dd ?			; DATA XREF: sub_401010+3Aw
dword_451020	dd ?			; DATA XREF: sub_40303E+DDw
					; sub_40316F:loc_40325Cr
dword_451024	dd ?			; DATA XREF: sub_401C11:loc_402443w
					; sub_401C11:loc_402452w ...
; char *Str
Str		dd ?			; DATA XREF: sub_401BA8+6r
					; sub_401BA8+Fr ...
dword_45102C	dd 5 dup(?)		; DATA XREF: sub_401C11+D4Ao
					; sub_401C11+F01o ...
dword_451040	dd ?			; DATA XREF: sub_401C11:loc_402381w
					; sub_402C03+6r
dword_451044	dd ?			; DATA XREF: sub_401723:loc_40177Ar
					; sub_401723+74w ...
dword_451048	dd ?			; DATA XREF: sub_401723:loc_4017A6r
					; sub_401723+A0w ...
		align 20h
dword_451060	dd 3Ch dup(?)		; DATA XREF: sub_403BAA+13Ao
					; sub_403E56+6o ...
dword_451150	dd ?			; DATA XREF: sub_4037C0+Cr
					; sub_403BAA+67r ...
dword_451154	dd ?			; DATA XREF: sub_403BAA+B5r
					; sub_403BAA+C4r ...
dword_451158	dd ?			; DATA XREF: sub_403795+Fo
					; sub_403BAA+187o ...
dword_45115C	dd ?			; DATA XREF: sub_403795+6r
					; sub_403795+1Fw
dword_451160	dd 4 dup(?)		; DATA XREF: sub_4078B4+14o
					; sub_40791B+14o ...
dword_451170	dd 4 dup(?)		; DATA XREF: sub_4079E2+13Eo
					; sub_4079E2+152o ...
dword_451180	dd 4 dup(?)		; DATA XREF: sub_4079E2+191o
					; sub_4079E2+1A5o ...
dword_451190	dd 4 dup(?)		; DATA XREF: sub_4079E2+1E4o
					; sub_4079E2+1F8o ...
dword_4511A0	dd 4 dup(?)		; DATA XREF: sub_4079E2+29Do
					; sub_4079E2+2B2o ...
dword_4511B0	dd 4 dup(?)		; DATA XREF: sub_4079E2+221o
					; sub_4089BB+26o ...
dword_4511C0	dd 4 dup(?)		; DATA XREF: sub_4079E2+236o
					; sub_4079E2+24Ao ...
dword_4511D0	dd 8 dup(?)		; DATA XREF: sub_4079E2+274o
					; sub_409117+1EEo ...
dword_4511F0	dd 4 dup(?)		; DATA XREF: sub_407CBA+60o
					; sub_407CBA+88o ...
dword_451200	dd 80h dup(?)		; DATA XREF: sub_4079E2+65o
					; sub_4079E2+C6o
dword_451400	dd ?			; DATA XREF: sub_408463+5Er
					; sub_40A3E0+9Ew ...
dword_451404	dd ?			; DATA XREF: sub_4080B2+2Er
					; sub_4080B2+F6r ...
dword_451408	dd ?			; DATA XREF: sub_40832D+6r
					; sub_40A3E0+CEw ...
dword_45140C	dd ?			; DATA XREF: sub_40A995+6r
					; sub_40A995+13w ...
dword_451410	dd ?			; DATA XREF: sub_40A3E0+41r
					; sub_40A3E0:loc_40A4EFw
dword_451414	dd ?			; DATA XREF: sub_40A3E0:loc_40A509r
					; sub_40A3E0:loc_40A8D5w
		align 10h
; char Dest[32]
Dest		db 20h dup(?)		; DATA XREF: sub_4077E7+1Ao
					; sub_4077E7+26o
dword_451440	dd 20h dup(?)		; DATA XREF: sub_40E160+3Fo
					; sub_40E160+5Ao ...
dword_4514C0	dd ?			; DATA XREF: sub_425925+6r
					; sub_425925+Fw
dword_4514C4	dd ?			; DATA XREF: .text:00425D53r
					; .text:00425D5Cw
dword_4514C8	dd ?			; DATA XREF: .text:00425D90w
					; .text:00425DAAo
dword_4514CC	dd 5 dup(?)		; DATA XREF: .text:00425D95o
dword_4514E0	dd ?			; DATA XREF: sub_4264B7+20r
					; sub_4265F1+Br ...
dword_4514E4	dd ?			; DATA XREF: sub_426784+E4w
					; sub_426A3B+Er
dword_4514E8	dd ?			; DATA XREF: .text:loc_426DA7r
					; .text:00426E0Ew ...
dword_4514EC	dd ?			; DATA XREF: .text:loc_426E40r
					; .text:00426EA7w ...
dword_4514F0	dd ?			; DATA XREF: .text:loc_426ED9r
					; .text:00426F40w ...
dword_4514F4	dd ?			; DATA XREF: .text:loc_426F72r
					; .text:00426FD9w ...
dword_4514F8	dd ?			; DATA XREF: .text:loc_42700Br
					; .text:00427072w ...
dword_4514FC	dd ?			; DATA XREF: .text:loc_4270A4r
					; .text:0042710Bw ...
dword_451500	dd ?			; DATA XREF: .text:loc_42713Dr
					; .text:004271A4w ...
dword_451504	dd ?			; DATA XREF: .text:loc_4271D6r
					; .text:0042723Dw ...
dword_451508	dd ?			; DATA XREF: .text:loc_42726Fr
					; .text:004272D6w ...
dword_45150C	dd ?			; DATA XREF: .text:loc_427308r
					; .text:0042736Fw ...
dword_451510	dd ?			; DATA XREF: .text:00426C88r
					; .text:00426D4Cw ...
dword_451514	dd ?			; DATA XREF: sub_426BDA+8r
					; sub_426BDA+6Fw ...
dword_451518	dd ?			; DATA XREF: .text:00426B3Fr
					; .text:00426BA6w ...
dword_45151C	dd ?			; DATA XREF: .text:00426A9Cr
					; .text:00426B03w ...
dword_451520	dd ?			; DATA XREF: sub_426A3B+17r
					; sub_426A3B+3Bw ...
dword_451524	dd ?			; DATA XREF: .text:004269A0r
					; .text:00426A07w ...
dword_451528	dd ?			; DATA XREF: sub_4268B1+Br
					; sub_4268B1+C1w ...
dword_45152C	dd ?			; DATA XREF: sub_426784+8r
					; sub_426784:loc_4267E1w
		align 20h
; CHAR Filename
Filename	db ?			; DATA XREF: sub_426784+1Do
					; sub_426784+56w ...
		align 4
		dd 42h dup(?)
dword_45164C	dd ?			; DATA XREF: sub_4265F1:loc_426632r
					; sub_4265F1+A4w ...
; LPCSTR lpPathName
lpPathName	dd ?			; DATA XREF: sub_4264B7+Br
					; sub_4264B7+44w ...
dword_451654	dd ?			; DATA XREF: sub_4263DD+6r
					; sub_4263DD+13w
dword_451658	dd ?			; DATA XREF: sub_4263DD+63w
					; sub_4263DD+68r ...
		align 10h
dword_451660	dd ?			; DATA XREF: sub_42A3DA+2Dr
					; sub_42A3DA+41r ...
dword_451664	dd ?			; DATA XREF: sub_42A3DA+15r
					; sub_42A3DA:loc_42A3FDr ...
		align 20h
dword_451680	dd ?			; DATA XREF: .text:0042AD73w
					; .text:0042AD96o ...
dword_451684	dd ?			; DATA XREF: .text:0042AD7Cw
word_451688	dw ?			; DATA XREF: .text:0042AD86w
byte_45168A	db ?			; DATA XREF: .text:0042AD91w
		align 4
		dd 9 dup(?)
		db ?
byte_4516B1	db ?			; DATA XREF: .text:0042ADCFw
dword_4516B2	dd ?			; DATA XREF: .text:0042ACB4w
					; .text:0042AD40o ...
dword_4516B6	dd ?			; DATA XREF: .text:0042ACBDw
dword_4516BA	dd ?			; DATA XREF: .text:0042ACC6w
dword_4516BE	dd ?			; DATA XREF: .text:0042ACCFw
dword_4516C2	dd ?			; DATA XREF: .text:0042ACD8w
		align 10h
dword_4516D0	dd ?			; DATA XREF: .text:0042AC1Dw
					; .text:0042AC80o ...
dword_4516D4	dd ?			; DATA XREF: .text:0042AC26w
word_4516D8	dw ?			; DATA XREF: .text:0042AC30w
byte_4516DA	db ?			; DATA XREF: .text:0042AC3Bw
		align 10h
dword_4516E0	dd 8 dup(?)		; DATA XREF: .text:0042ABB1o
					; .text:0042ABC3o ...
dword_451700	dd ?			; DATA XREF: sub_42ECBE+2Dr
					; sub_42ECBE+A4r ...
dword_451704	dd ?			; DATA XREF: sub_42ECBE+69r
					; sub_42ECBE+78o ...
dword_451708	dd ?			; DATA XREF: sub_42ECBE+36r
					; sub_42ECBE+55o ...
dword_45170C	dd ?			; DATA XREF: .text:00431CA3w
					; .text:00431DAFr
dword_451710	dd ?			; DATA XREF: .text:00431DEAr
dword_451714	dd ?			; DATA XREF: .text:00431E1Fr
byte_451718	db ?			; DATA XREF: .text:00431C91o
					; .text:00431CADo ...
byte_451719	db ?			; DATA XREF: .text:00431DDFr
byte_45171A	db ?			; DATA XREF: .text:loc_431E14r
		align 4
dword_45171C	dd ?			; DATA XREF: sub_42F015+6r
					; sub_42F015+18w ...
dword_451720	dd ?			; DATA XREF: sub_434B1A:loc_434B65r
					; sub_434CEA:loc_434D58r ...
dword_451724	dd ?			; DATA XREF: .text:004363D7w
					; sub_4363DE+6r
dword_451728	dd ?			; DATA XREF: sub_438394+B7r
					; sub_438394:loc_43849Dw
dword_45172C	dd ?			; DATA XREF: sub_438394+F0w
					; sub_438394+F5r ...
dword_451730	dd ?			; DATA XREF: sub_436054+41r
					; sub_436054+49w ...
		align 10h
; CHAR Buffer[256]
Buffer		db 100h	dup(?)		; DATA XREF: sub_439E46+29o
					; sub_439E46+56o
dword_451840	dd ?			; DATA XREF: sub_43B952+232r
					; sub_43B952+23Br ...
dword_451844	dd ?			; DATA XREF: sub_43BC12+7r
					; sub_43C2C6+6w
		align 20h
; FILE *File
File		dd ?			; DATA XREF: sub_43C309+8r
					; sub_43C309+19r ...
		align 20h
; char byte_451880[79]
byte_451880	db 4Fh dup(?)		; DATA XREF: sub_43C5B8+1Bo
					; sub_43C616:loc_43C688o ...
byte_4518CF	db ?			; DATA XREF: sub_43C5B8+27w
dword_4518D0	dd ?			; DATA XREF: sub_43C5B8+3Fw
					; sub_43C616:loc_43C640r ...
dword_4518D4	dd ?			; DATA XREF: sub_43C5B8+34w
					; sub_43C616+12r ...
dword_4518D8	dd ?			; DATA XREF: sub_43C5B8+4Aw
					; sub_43C616:loc_43C658r ...
dword_4518DC	dd ?			; DATA XREF: sub_43C5AB+6w
					; sub_43C72A:loc_43C87Cr ...
dword_4518E0	dd ?			; DATA XREF: sub_43C5B8+57w
					; sub_43C616:loc_43C670r
dword_4518E4	dd ?			; DATA XREF: sub_43C309+249w
					; sub_43C72A+88r ...
dword_4518E8	dd ?			; DATA XREF: sub_43C309+24Ew
					; sub_43C72A:loc_43C76Dr ...
dword_4518EC	dd ?			; DATA XREF: sub_43C2D4+6r
					; sub_43C2D4+14w ...
		align 20h
dword_451900	dd ?			; DATA XREF: sub_43EE3D+6r
					; sub_43EE3D+Fr ...
dword_451904	dd ?			; DATA XREF: sub_43F21C+E3w
					; sub_43F31B+1DFw ...
dword_451908	dd ?			; DATA XREF: sub_43F21C+EDw
					; sub_43F31B+1E9w ...
dword_45190C	dd ?			; DATA XREF: sub_43F87D+70Er
					; sub_43F87D:loc_43FFD1w
dword_451910	dd ?			; DATA XREF: sub_43F631+1CCr
					; sub_43F631:loc_43F843w
; char byte_451914[32]
byte_451914	db 20h dup(?)		; DATA XREF: sub_43F31B+3Bo
					; sub_43F31B+47o ...
dword_451934	dd ?			; DATA XREF: sub_43F21C+45r
					; sub_43F21C+4Dw
dword_451938	dd ?			; DATA XREF: sub_43F21C:loc_43F275r
					; sub_43F21C+61w
dword_45193C	dd ?			; DATA XREF: sub_43F21C:loc_43F2B1r
					; sub_43F21C:loc_43F2E5w
; char *dword_451940
dword_451940	dd ?			; DATA XREF: sub_4406AE+3Br
					; sub_4406AE+6Ew ...
		align 8
dword_451948	dd ?			; DATA XREF: sub_440780+F2r
					; sub_440780+103w ...
dword_45194C	dd ?			; DATA XREF: sub_440780+F7r
					; sub_440780+108w ...
dword_451950	dd ?			; DATA XREF: sub_401010+3r
dword_451954	dd ?			; DATA XREF: sub_401010+25r
dword_451958	dd ?			; DATA XREF: sub_401060+22w
dword_45195C	dd ?			; DATA XREF: sub_401060+18w
dword_451960	dd ?			; DATA XREF: sub_401060+Ew
TlsIndex	dd ?			; DATA XREF: .tls:TlsIndex_ptro
; HMODULE hLibModule
hLibModule	dd ?			; DATA XREF: TlsCallback_0+60w
					; TlsCallback_0+83r ...
dword_45196C	dd ?			; DATA XREF: sub_401060+2Cw
dword_451970	dd ?			; DATA XREF: sub_401060+3Dr
					; sub_401180+61r ...
dword_451974	dd ?			; DATA XREF: sub_401060+5Er
dword_451978	dd ?			; DATA XREF: sub_401180+12Dw
					; TopLevelExceptionFilter:loc_4411ECr
dword_45197C	dd ?			; DATA XREF: .text:00441313r
					; sub_441360+4w
dword_451980	dd ?			; DATA XREF: sub_441680+9r
					; sub_441680:loc_4416A0w
dword_451984	dd ?			; DATA XREF: sub_441440+1Dr
					; sub_441440+58r ...
dword_451988	dd ?			; DATA XREF: sub_441440+Br
					; sub_441440:loc_4414FFw ...
dword_45198C	dd ?			; DATA XREF: sub_441C30+4r
					; sub_441C30+92w ...
dword_451990	dd ?			; DATA XREF: sub_441D80r
					; sub_441D80:loc_441D90w
		align 10h
dword_4519A0	dd 2Bh dup(?)		; DATA XREF: .rdata:0044FF48o
dword_451A4C	dd ?			; DATA XREF: .text:00441EAAw
		dd 2 dup(?)
dword_451A58	dd ?			; DATA XREF: .text:00441E96w
		dd 2 dup(?)
dword_451A64	dd ?			; DATA XREF: .text:00441E7Cw
		dd 86h dup(?)
dword_451C80	dd ?			; DATA XREF: .text:00441E82w
					; .rdata:off_44FF44o
dword_451C84	dd ?			; DATA XREF: .text:00441E8Cw
		dd ?
dword_451C8C	dd ?			; DATA XREF: .text:00441E9Bw
		dd 14h dup(?)
dword_451CE0	dd ?			; DATA XREF: .text:00441F73r
					; .text:00442004r ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_441F00+7o
					; sub_441F00:loc_441F55o ...
dword_451CFC	dd ?			; DATA XREF: sub_441F00+14r
					; .text:00441FC8r ...
		dd ?
dword_451D04	dd ?			; DATA XREF: sub_401180+1A8w
dword_451D08	dd ?			; DATA XREF: sub_401180+1BFw
dword_451D0C	dd ?			; DATA XREF: sub_401180+1B2w
		align 20h
dword_451D20	dd ?			; DATA XREF: sub_40180D:loc_401898w
					; sub_40180D:loc_4018DBw ...
dword_451D24	dd ?			; DATA XREF: sub_40180D+1DDr
					; sub_40180D+1E6w ...
dword_451D28	dd ?			; DATA XREF: sub_40180D+1F9r
					; sub_40180D+202w ...
		align 10h
dword_451D30	dd ?			; DATA XREF: sub_401C11:loc_402318w
dword_451D34	dd ?			; DATA XREF: sub_401C11+2A0w
					; sub_401C11+330w ...
; LPCSTR dword_451D38
dword_451D38	dd ?			; DATA XREF: sub_401C11+87Dw
					; sub_40A3E0+9r ...
; LPCSTR dword_451D3C
dword_451D3C	dd ?			; DATA XREF: sub_401C11+1DCw
					; sub_401C11+88Bw ...
; char *dword_451D40
dword_451D40	dd ?			; DATA XREF: sub_401C11+86Fw
					; sub_403E56+34r
dword_451D44	dd ?			; DATA XREF: sub_401C11:loc_4024A3w
dword_451D48	dd ?			; DATA XREF: sub_401C11:loc_4024AFw
					; sub_41327A:loc_413440r ...
dword_451D4C	dd ?			; DATA XREF: sub_401C11:loc_4024E8w
					; sub_40B169:loc_40B196r
dword_451D50	dd ?			; DATA XREF: sub_401C11+1D2w
					; sub_401C11:loc_4024BBw ...
dword_451D54	dd ?			; DATA XREF: sub_401C11+8C9o
					; sub_40E463+6r
dword_451D58	dd ?			; DATA XREF: sub_401C11+8BAw
					; sub_40729B:loc_4076ADr
dword_451D5C	dd ?			; DATA XREF: sub_409015:loc_409062r
					; sub_40A3E0+2A4w ...
dword_451D60	dd ?			; DATA XREF: sub_40A3E0+30Dw
					; sub_40A3E0+3ABr ...
dword_451D64	dd ?			; DATA XREF: sub_408AF0+96r
					; sub_40A3E0+325w ...
dword_451D68	dd ?			; DATA XREF: sub_408D1E+6r
					; sub_40970C+121r ...
dword_451D6C	dd ?			; DATA XREF: sub_40A3E0+33Dw
					; sub_40A3E0+3DAr
dword_451D70	dd ?			; DATA XREF: sub_40A3E0+2F5w
					; sub_40A3E0+3A2r ...
dword_451D74	dd ?			; DATA XREF: sub_40970C:loc_409739r
					; sub_40A3E0+190w ...
dword_451D78	dd ?			; DATA XREF: sub_40970C:loc_4097C7r
					; sub_40970C:loc_409875r ...
dword_451D7C	dd ?			; DATA XREF: sub_408D9F+172r
					; sub_40A3E0+2BCw ...
dword_451D80	dd ?			; DATA XREF: sub_408D9F+93r
					; sub_40A3E0+232w ...
dword_451D84	dd ?			; DATA XREF: sub_4089BB+38r
					; sub_40A3E0+1F9w ...
dword_451D88	dd ?			; DATA XREF: sub_40A3E0+26Bw
					; sub_40A3E0+270r ...
dword_451D8C	dd ?			; DATA XREF: sub_408C46+7r
					; sub_40A3E0+355w ...
dword_451D90	dd ?			; DATA XREF: sub_434B1A:loc_434B49r
					; sub_434B1A+79r ...
dword_451D94	dd ?			; DATA XREF: TlsCallback_0+A3w
					; TlsCallback_0:loc_440FD3w ...
dword_451D98	dd ?			; DATA XREF: TlsCallback_0+7Ew
					; TlsCallback_0+AEr ...
dword_451D9C	dd ?			; DATA XREF: TlsCallback_0:loc_440F24w
dword_451DA0	dd ?			; DATA XREF: sub_401060+64w
					; sub_4410A0+3Fr ...
dword_451DA4	dd ?			; DATA XREF: sub_401060+69w
					; sub_4410A0+4r ...
dword_451DA8	dd ?			; DATA XREF: sub_401180+A0o
					; sub_401180+ECw
dword_451DAC	dd ?			; DATA XREF: sub_401180+B3r
					; sub_401180:loc_401243r ...
		align 400h
_bss		ends

;
; Imports from libassuan-0.dll
;
; Section 5. (virtual address 00052000)
; Virtual size			: 000020A4 (   8356.)
; Section size in file		: 00002200 (   8704.)
; Offset to raw	data for section: 0004E600
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
		extrn __assuan_close:dword ; DATA XREF:	.text:00440C88r
		extrn __assuan_connect:dword ; DATA XREF: .text:00440CA8r
		extrn __assuan_pipe:dword ; DATA XREF: .text:00440C80r
		extrn __assuan_socket:dword ; DATA XREF: .text:00440CA0r
		extrn __assuan_socketpair:dword	; DATA XREF: .text:00440C98r
		extrn __assuan_spawn:dword ; DATA XREF:	.text:00440C90r
		extrn __imp_assuan_accept:dword	; DATA XREF: assuan_acceptr
		extrn __imp_assuan_begin_confidential:dword
					; DATA XREF: assuan_begin_confidentialr
		extrn __imp_assuan_end_confidential:dword
					; DATA XREF: assuan_end_confidentialr
		extrn __imp_assuan_fdopen:dword	; DATA XREF: assuan_fdopenr
		extrn __imp_assuan_get_pid:dword ; DATA	XREF: assuan_get_pidr
		extrn __imp_assuan_get_pointer:dword ; DATA XREF: assuan_get_pointerr
		extrn __imp_assuan_init_pipe_server:dword
					; DATA XREF: assuan_init_pipe_serverr
		extrn __imp_assuan_init_socket_server:dword
					; DATA XREF: assuan_init_socket_serverr
		extrn __imp_assuan_inquire:dword ; DATA	XREF: assuan_inquirer
		extrn __imp_assuan_new:dword ; DATA XREF: assuan_newr
		extrn __imp_assuan_process:dword ; DATA	XREF: assuan_processr
		extrn __imp_assuan_register_command:dword
					; DATA XREF: assuan_register_commandr
		extrn __imp_assuan_register_option_handler:dword
					; DATA XREF: assuan_register_option_handlerr
		extrn __imp_assuan_register_reset_notify:dword
					; DATA XREF: assuan_register_reset_notifyr
		extrn __imp_assuan_release:dword ; DATA	XREF: assuan_releaser
		extrn __imp_assuan_send_data:dword ; DATA XREF:	assuan_send_datar
		extrn __imp_assuan_set_assuan_log_prefix:dword
					; DATA XREF: assuan_set_assuan_log_prefixr
		extrn __imp_assuan_set_error:dword ; DATA XREF:	assuan_set_errorr
		extrn __imp_assuan_set_gpg_err_source:dword
					; DATA XREF: assuan_set_gpg_err_sourcer
		extrn __imp_assuan_set_hello_line:dword	; DATA XREF: assuan_set_hello_liner
		extrn __imp_assuan_set_log_stream:dword	; DATA XREF: assuan_set_log_streamr
		extrn __imp_assuan_set_malloc_hooks:dword
					; DATA XREF: assuan_set_malloc_hooksr
		extrn __imp_assuan_set_pointer:dword ; DATA XREF: assuan_set_pointerr
		extrn __imp_assuan_set_system_hooks:dword
					; DATA XREF: assuan_set_system_hooksr
		extrn __imp_assuan_sock_bind:dword ; DATA XREF:	assuan_sock_bindr
		extrn __imp_assuan_sock_check_nonce:dword
					; DATA XREF: assuan_sock_check_noncer
		extrn __imp_assuan_sock_close:dword ; DATA XREF: assuan_sock_closer
		extrn __imp_assuan_sock_get_nonce:dword	; DATA XREF: assuan_sock_get_noncer
		extrn __imp_assuan_sock_init:dword ; DATA XREF:	assuan_sock_initr
		extrn __imp_assuan_sock_new:dword ; DATA XREF: assuan_sock_newr
		extrn __imp_assuan_write_status:dword ;	DATA XREF: assuan_write_statusr

;
; Imports from libgcrypt-20.dll
;
		extrn __imp_gcry_calloc:dword ;	DATA XREF: gcry_callocr
		extrn __imp_gcry_check_version:dword ; DATA XREF: gcry_check_versionr
		extrn __imp_gcry_control:dword ; DATA XREF: gcry_controlr
		extrn __imp_gcry_free:dword ; DATA XREF: gcry_freer
		extrn __imp_gcry_malloc:dword ;	DATA XREF: gcry_mallocr
		extrn __imp_gcry_malloc_secure:dword ; DATA XREF: gcry_malloc_securer
		extrn __imp_gcry_md_algo_name:dword ; DATA XREF: gcry_md_algo_namer
		extrn __imp_gcry_md_hash_buffer:dword ;	DATA XREF: gcry_md_hash_bufferr
		extrn __imp_gcry_md_map_name:dword ; DATA XREF:	gcry_md_map_namer
		extrn __imp_gcry_mpi_aprint:dword ; DATA XREF: gcry_mpi_aprintr
		extrn __imp_gcry_mpi_invm:dword	; DATA XREF: gcry_mpi_invmr
		extrn __imp_gcry_mpi_release:dword ; DATA XREF:	gcry_mpi_releaser
		extrn __imp_gcry_mpi_scan:dword	; DATA XREF: gcry_mpi_scanr
		extrn __imp_gcry_mpi_snew:dword	; DATA XREF: gcry_mpi_snewr
		extrn __imp_gcry_mpi_sub_ui:dword ; DATA XREF: gcry_mpi_sub_uir
		extrn __imp_gcry_pk_get_keygrip:dword ;	DATA XREF: gcry_pk_get_keygripr
		extrn __imp_gcry_realloc:dword ; DATA XREF: gcry_reallocr
		extrn __imp_gcry_set_fatalerror_handler:dword
					; DATA XREF: gcry_set_fatalerror_handlerr
		extrn __imp_gcry_set_log_handler:dword ; DATA XREF: gcry_set_log_handlerr
		extrn __imp_gcry_set_outofcore_handler:dword
					; DATA XREF: gcry_set_outofcore_handlerr
		extrn __imp_gcry_sexp_build:dword ; DATA XREF: gcry_sexp_buildr
		extrn __imp_gcry_sexp_canon_len:dword ;	DATA XREF: gcry_sexp_canon_lenr
		extrn __imp_gcry_sexp_release:dword ; DATA XREF: gcry_sexp_releaser
		extrn __imp_gcry_sexp_sprint:dword ; DATA XREF:	gcry_sexp_sprintr
		extrn __imp_gcry_sexp_sscan:dword ; DATA XREF: gcry_sexp_sscanr
		extrn __imp_gcry_strdup:dword ;	DATA XREF: gcry_strdupr
		extrn __imp_gcry_xcalloc:dword ; DATA XREF: gcry_xcallocr
		extrn __imp_gcry_xmalloc:dword ; DATA XREF: gcry_xmallocr
		extrn __imp_gcry_xrealloc:dword	; DATA XREF: gcry_xreallocr
		extrn __imp_gcry_xstrdup:dword ; DATA XREF: gcry_xstrdupr

;
; Imports from libgpg-error-0.dll
;
		extrn __imp_gpg_err_code_from_errno:dword
					; DATA XREF: gpg_err_code_from_errnor
		extrn __imp_gpg_err_code_from_syserror:dword
					; DATA XREF: gpg_err_code_from_syserrorr
		extrn __imp_gpg_err_set_errno:dword ; DATA XREF: gpg_err_set_errnor
		extrn __imp_gpg_strerror:dword ; DATA XREF: gpg_strerrorr

;
; Imports from libiconv-2.dll
;
		extrn __imp_libiconv:dword ; DATA XREF:	libiconvr
		extrn __imp_libiconv_close:dword ; DATA	XREF: libiconv_closer
		extrn __imp_libiconv_open:dword	; DATA XREF: libiconv_openr

;
; Imports from libksba-8.dll
;
		extrn __imp_ksba_cert_get_public_key:dword
					; DATA XREF: ksba_cert_get_public_keyr
		extrn __imp_ksba_cert_init_from_mem:dword
					; DATA XREF: ksba_cert_init_from_memr
		extrn __imp_ksba_cert_new:dword	; DATA XREF: ksba_cert_newr
		extrn __imp_ksba_cert_release:dword ; DATA XREF: ksba_cert_releaser
		extrn ksba_check_version:dword ; DATA XREF: .text:loc_440C50r
		extrn __imp_ksba_set_malloc_hooks:dword	; DATA XREF: ksba_set_malloc_hooksr

;
; Imports from libw32pth-0.dll
;
		extrn __imp_pth_accept:dword ; DATA XREF: pth_acceptr
		extrn __imp_pth_attr_new:dword ; DATA XREF: pth_attr_newr
		extrn __imp_pth_attr_set:dword ; DATA XREF: pth_attr_setr
		extrn __imp_pth_ctrl:dword ; DATA XREF:	pth_ctrlr
		extrn __imp_pth_event:dword ; DATA XREF: pth_eventr
		extrn __imp_pth_event_concat:dword ; DATA XREF:	pth_event_concatr
		extrn __imp_pth_event_free:dword ; DATA	XREF: pth_event_freer
		extrn __imp_pth_event_isolate:dword ; DATA XREF: pth_event_isolater
		extrn __imp_pth_event_occurred:dword ; DATA XREF: pth_event_occurredr
		extrn __imp_pth_init:dword ; DATA XREF:	pth_initr
		extrn __imp_pth_kill:dword ; DATA XREF:	pth_killr
		extrn __imp_pth_mutex_acquire:dword ; DATA XREF: pth_mutex_acquirer
		extrn __imp_pth_mutex_init:dword ; DATA	XREF: pth_mutex_initr
		extrn __imp_pth_mutex_release:dword ; DATA XREF: pth_mutex_releaser
		extrn __imp_pth_read:dword ; DATA XREF:	pth_readr
		extrn __imp_pth_select_ev:dword	; DATA XREF: pth_select_evr
		extrn __imp_pth_sigmask:dword ;	DATA XREF: pth_sigmaskr
		extrn __imp_pth_sleep:dword ; DATA XREF: pth_sleepr
		extrn __imp_pth_spawn:dword ; DATA XREF: pth_spawnr
		extrn __imp_pth_thread_id:dword	; DATA XREF: pth_thread_idr
		extrn __imp_pth_timeout:dword ;	DATA XREF: pth_timeoutr
		extrn __imp_pth_usleep:dword ; DATA XREF: pth_usleepr
		extrn __imp_pth_waitpid:dword ;	DATA XREF: pth_waitpidr
		extrn __imp_pth_write:dword ; DATA XREF: pth_writer
		extrn __imp_pth_yield:dword ; DATA XREF: pth_yieldr

;
; Imports from ADVAPI32.dll
;
; BOOL __stdcall CopySid(DWORD nDestinationSidLength, PSID pDestinationSid, PSID pSourceSid)
		extrn CopySid:dword	; CODE XREF: .text:004262D2p
					; DATA XREF: .text:004262CDr
; DWORD	__stdcall GetLengthSid(PSID pSid)
		extrn GetLengthSid:dword ; CODE	XREF: .text:0042629Bp
					; DATA XREF: .text:00426296r
; BOOL __stdcall GetTokenInformation(HANDLE TokenHandle, TOKEN_INFORMATION_CLASS TokenInformationClass,	LPVOID TokenInformation, DWORD TokenInformationLength, PDWORD ReturnLength)
		extrn GetTokenInformation:dword	; CODE XREF: .text:00426216p
					; .text:0042626Fp
					; DATA XREF: ...
; BOOL __stdcall IsValidSid(PSID pSid)
		extrn IsValidSid:dword	; CODE XREF: .text:00426285p
					; DATA XREF: .text:00426280r
; BOOL __stdcall OpenProcessToken(HANDLE ProcessHandle,	DWORD DesiredAccess, PHANDLE TokenHandle)
		extrn OpenProcessToken:dword ; CODE XREF: .text:004261DFp
					; DATA XREF: .text:004261DAr
; LSTATUS __stdcall RegCloseKey(HKEY hKey)
		extrn RegCloseKey:dword	; CODE XREF: sub_440232+314p
					; DATA XREF: sub_440232+30Fr
; LSTATUS __stdcall RegOpenKeyExA(HKEY hKey, LPCSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY	phkResult)
		extrn RegOpenKeyExA:dword ; CODE XREF: sub_440232+55p
					; sub_440232+98p
					; DATA XREF: ...
; LSTATUS __stdcall RegQueryValueExA(HKEY hKey,	LPCSTR lpValueName, LPDWORD lpReserved,	LPDWORD	lpType,	LPBYTE lpData, LPDWORD lpcbData)
		extrn RegQueryValueExA:dword ; CODE XREF: sub_440232+E3p
					; sub_440232+140p
					; DATA XREF: ...

;
; Imports from KERNEL32.dll
;
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: sub_407814+17p
					; .text:0042606Ap ...
; BOOL __stdcall CreateDirectoryA(LPCSTR lpPathName, LPSECURITY_ATTRIBUTES lpSecurityAttributes)
		extrn CreateDirectoryA:dword ; CODE XREF: .text:00425F64p
					; sub_4264B7+11Dp ...
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
		extrn CreateFileA:dword	; CODE XREF: .text:0042602Fp
					; sub_42C703+50p ...
; BOOL __stdcall CreatePipe(PHANDLE hReadPipe, PHANDLE hWritePipe, LPSECURITY_ATTRIBUTES lpPipeAttributes, DWORD nSize)
		extrn CreatePipe:dword	; CODE XREF: sub_42C5DD+4Ep
					; DATA XREF: sub_42C5DD+49r
; BOOL __stdcall CreateProcessA(LPCSTR lpApplicationName, LPSTR	lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES	lpThreadAttributes, BOOL bInheritHandles, DWORD	dwCreationFlags, LPVOID	lpEnvironment, LPCSTR lpCurrentDirectory, LPSTARTUPINFOA lpStartupInfo,	LPPROCESS_INFORMATION lpProcessInformation)
		extrn CreateProcessA:dword ; CODE XREF:	.text:0042CA80p
					; .text:0042CDA7p ...
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_4420A0+44p
					; DATA XREF: sub_4420A0+44r
; BOOL __stdcall DuplicateHandle(HANDLE	hSourceProcessHandle, HANDLE hSourceHandle, HANDLE hTargetProcessHandle, LPHANDLE lpTargetHandle, DWORD	dwDesiredAccess, BOOL bInheritHandle, DWORD dwOptions)
		extrn DuplicateHandle:dword ; CODE XREF: sub_42C5DD+A3p
					; DATA XREF: sub_42C5DD+9Er
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_441F00+Ep
					; .text:00441FC2p ...
; DWORD	__stdcall ExpandEnvironmentStringsA(LPCSTR lpSrc, LPSTR	lpDst, DWORD nSize)
		extrn ExpandEnvironmentStringsA:dword ;	CODE XREF: sub_440232+1CFp
					; sub_440232+235p
					; DATA XREF: ...
; DWORD	__stdcall FormatMessageA(DWORD dwFlags,	LPCVOID	lpSource, DWORD	dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments)
		extrn FormatMessageA:dword ; CODE XREF:	sub_439E46+51p
					; DATA XREF: sub_439E46+4Cr
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: TlsCallback_0+10Ap
					; DATA XREF: TlsCallback_0+10Ar
; UINT __stdcall GetACP()
		extrn GetACP:dword	; CODE XREF: sub_43F31B+26p
					; DATA XREF: sub_43F31B+21r
; UINT __stdcall GetConsoleOutputCP()
		extrn GetConsoleOutputCP:dword ; CODE XREF: sub_43F31B+16p
					; DATA XREF: sub_43F31B+11r
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: sub_42C5DD+66p
					; sub_42C5DD+72p ...
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: .text:00425E5Ep
					; .text:00426199p ...
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_441DA0+74p
					; DATA XREF: sub_441DA0+74r
; BOOL __stdcall GetExitCodeProcess(HANDLE hProcess, LPDWORD lpExitCode)
		extrn GetExitCodeProcess:dword ; CODE XREF: .text:0042CF0Dp
					; DATA XREF: .text:0042CF08r
; BOOL __stdcall GetFileInformationByHandle(HANDLE hFile, LPBY_HANDLE_FILE_INFORMATION lpFileInformation)
		extrn GetFileInformationByHandle:dword ; CODE XREF: .text:00440638p
					; .text:00440653p
					; DATA XREF: ...
; DWORD	__stdcall GetFileSize(HANDLE hFile, LPDWORD lpFileSizeHigh)
		extrn GetFileSize:dword	; CODE XREF: sub_438394+17Ap
					; DATA XREF: sub_438394+175r
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_4077E7+Bp
					; .text:00426224p ...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename,	DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_426784+31p
					; sub_442470+C2p
					; DATA XREF: ...
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_4014F0+16p
					; sub_441C30+87p
					; DATA XREF: ...
; DWORD	__stdcall GetPriorityClass(HANDLE hProcess)
		extrn GetPriorityClass:dword ; CODE XREF: .text:0042CA26p
					; .text:0042CD50p ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_401180+142p
					; sub_4014F0+33p ...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: sub_401180+2F6p
					; DATA XREF: sub_401180+2F6r
; HANDLE __stdcall GetStdHandle(DWORD nStdHandle)
		extrn GetStdHandle:dword ; CODE	XREF: sub_434F78+226p
					; sub_434F78+23Cp ...
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_441DA0+57p
					; sub_442DA0+66p
					; DATA XREF: ...
; DWORD	__stdcall GetTempPathA(DWORD nBufferLength, LPSTR lpBuffer)
		extrn GetTempPathA:dword ; CODE	XREF: .text:00425EA7p
					; sub_4339FA+2Ap
					; DATA XREF: ...
; LCID __stdcall GetThreadLocale()
		extrn GetThreadLocale:dword ; CODE XREF: sub_43A788+7Fp
					; DATA XREF: sub_43A788:loc_43A802r
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: .text:00425F90p
					; sub_4339FA+119p ...
; DWORD	__stdcall GetTimeZoneInformation(LPTIME_ZONE_INFORMATION lpTimeZoneInformation)
		extrn GetTimeZoneInformation:dword ; CODE XREF:	sub_442DA0+34p
					; DATA XREF: sub_442DA0+34r
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_4420A0+87p
					; DATA XREF: sub_4420A0+87r
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_441F00+5Cp
					; .text:00441FE0p ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: sub_407784+11p
					; sub_426350+11p ...
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: sub_441C30+A7p
					; DATA XREF: sub_441C30+A7r
; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
		extrn MultiByteToWideChar:dword	; CODE XREF: sub_43B6E9+38p
					; sub_43B6E9+D5p
					; DATA XREF: ...
; HANDLE __stdcall OpenProcess(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwProcessId)
		extrn OpenProcess:dword	; CODE XREF: .text:004261B3p
					; DATA XREF: .text:004261AEr
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_441DA0+8Bp
					; DATA XREF: sub_441DA0+8Br
; BOOL __stdcall ReadFile(HANDLE hFile,	LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped)
		extrn ReadFile:dword	; CODE XREF: sub_434F78+A4p
					; DATA XREF: sub_434F78+9Fr
; DWORD	__stdcall ResumeThread(HANDLE hThread)
		extrn ResumeThread:dword ; CODE	XREF: .text:0042CB2Dp
					; .text:0042CE38p
					; DATA XREF: ...
; BOOL __stdcall SetEvent(HANDLE hEvent)
		extrn SetEvent:dword	; CODE XREF: sub_407149+E9p
					; DATA XREF: sub_407149+E4r
; DWORD	__stdcall SetFilePointer(HANDLE	hFile, LONG lDistanceToMove, PLONG lpDistanceToMoveHigh, DWORD dwMoveMethod)
		extrn SetFilePointer:dword ; CODE XREF:	sub_434E4F+B3p
					; .text:004386DFp
					; DATA XREF: ...
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_401180+124p
					; .text:00441EBFp
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_401180+8Fp
					; sub_425DB1+18p ...
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: .text:00441EE9p
					; DATA XREF: .text:00441EE9r
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_441F00+35p
					; DATA XREF: sub_441F00+21r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:00441ECFp
					; DATA XREF: .text:00441ECFr
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_441440+142p
					; sub_441440+184p ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_441440+A1p
					; sub_441440+D9p ...
; DWORD	__stdcall WaitForSingleObject(HANDLE hHandle, DWORD dwMilliseconds)
		extrn WaitForSingleObject:dword	; CODE XREF: .text:0042CEA9p
					; DATA XREF: .text:0042CEA4r
; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
		extrn WideCharToMultiByte:dword	; CODE XREF: sub_43B7EB+48p
					; sub_43B7EB+C8p
					; DATA XREF: ...
; BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite,	LPDWORD	lpNumberOfBytesWritten,	LPOVERLAPPED lpOverlapped)
		extrn WriteFile:dword	; CODE XREF: sub_434F78+165p
					; DATA XREF: sub_434F78+160r

;
; Imports from msvcrt.dll
;
		extrn __imp__access:dword ; DATA XREF: _accessr
		extrn __imp__chdir:dword ; DATA	XREF: _chdirr
		extrn __imp__close:dword ; DATA	XREF: _closer
		extrn __imp__dup:dword	; DATA XREF: _dupr
; FILE *__cdecl	_fdopen(int FileHandle,	const char *Format)
		extrn __imp__fdopen:dword ; DATA XREF: _fdopenr
; int __cdecl _fileno(FILE *File)
		extrn __imp__fileno:dword ; DATA XREF: _filenor
		extrn __imp__getpid:dword ; DATA XREF: _getpidr
		extrn __imp__mkdir:dword ; DATA	XREF: _mkdirr
		extrn __imp__open:dword	; DATA XREF: _openr
; int __cdecl _putenv(const char *EnvString)
		extrn __imp__putenv:dword ; DATA XREF: _putenvr
		extrn __imp__read:dword	; DATA XREF: _readr
		extrn __imp__rmdir:dword ; DATA	XREF: _rmdirr
		extrn __imp__setmode:dword ; DATA XREF:	_setmoder
; void __cdecl _tzset()
		extrn __imp__tzset:dword ; DATA	XREF: _tzsetr
		extrn __imp__write:dword ; DATA	XREF: _writer

;
; Imports from msvcrt.dll
;
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
; unsigned __int32 *__cdecl __doserrno()
		extrn __imp___doserrno:dword ; DATA XREF: __doserrnor
		extrn __imp___getmainargs:dword	; DATA XREF: __getmainargsr
		extrn __initenv:dword	; DATA XREF: sub_401180+23Er
		extrn __lconv_init:dword ; DATA	XREF: sub_441070r
		extrn __pioinfo:dword	; DATA XREF: sub_442910+F1r
					; sub_442910+13Ar ...
		extrn __imp___set_app_type:dword ; DATA	XREF: __set_app_typer
		extrn __imp___setusermatherr:dword ; DATA XREF:	__setusermatherrr
		extrn _acmdln:dword	; DATA XREF: sub_401180+166r
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
		extrn __imp__cexit:dword ; DATA	XREF: _cexitr
; int *__cdecl _errno()
		extrn __imp__errno:dword ; CODE	XREF: sub_401C11+448p
					; sub_401C11+CEDp ...
; void __cdecl __noreturn _exit(int Code)
		extrn __imp__exit:dword	; DATA XREF: _exitr
		extrn __imp__filelengthi64:dword ; DATA	XREF: _filelengthi64r
; int __cdecl _fileno_0(FILE *File)
		extrn __imp__fileno_0:dword ; DATA XREF: _fileno_0r
; int fmode
		extrn _fmode:dword	; DATA XREF: sub_401060+6Er
		extrn _fstati64:dword	; CODE XREF: .text:0042C323p
					; sub_438394+46p ...
		extrn _get_osfhandle:dword ; CODE XREF:	.text:0042C8E4p
					; .text:0042C8FCp ...
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn _iob:dword	; DATA XREF: sub_401C11+A0Dr
					; sub_401C11+A3Fr ...
		extrn __imp__lock:dword	; DATA XREF: _lockr
		extrn __imp__lseeki64:dword ; DATA XREF: _lseeki64r
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_4410A0+A3p
					; DATA XREF: sub_4410A0+A3r
		extrn _open_osfhandle:dword ; CODE XREF: sub_425DDB+2Cp
					; .text:00426054p ...
; int __cdecl pclose(FILE *File)
		extrn _pclose:dword	; CODE XREF: sub_41257F+493p
					; DATA XREF: sub_41257F+48Er
; FILE *__cdecl	popen(const char *Command, const char *Mode)
		extrn _popen:dword	; CODE XREF: sub_41257F+419p
					; DATA XREF: sub_41257F+414r
; int __cdecl strnicmp(const char *Str1, const char *Str, size_t MaxCount)
		extrn _strnicmp:dword	; CODE XREF: .text:00425CFFp
					; DATA XREF: .text:00425CFAr
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
		extrn _winmajor:dword	; DATA XREF: TlsCallback_0+4r
		extrn __imp__write_0:dword ; DATA XREF:	_write_0r
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; int __cdecl atoi(const char *Str)
		extrn __imp_atoi:dword	; DATA XREF: atoir
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; void __cdecl clearerr(FILE *File)
		extrn __imp_clearerr:dword ; DATA XREF:	clearerrr
; void __cdecl __noreturn exit(int Code)
		extrn __imp_exit:dword	; DATA XREF: exitr
; int __cdecl fclose(FILE *File)
		extrn __imp_fclose:dword ; DATA	XREF: fcloser
; int __cdecl ferror(FILE *File)
		extrn __imp_ferror:dword ; DATA	XREF: ferrorr
; int __cdecl fflush(FILE *File)
		extrn __imp_fflush:dword ; DATA	XREF: fflushr
; int __cdecl fgetpos(FILE *File, fpos_t *Pos)
		extrn __imp_fgetpos:dword ; DATA XREF: fgetposr
; FILE *__cdecl	fopen(const char *Filename, const char *Mode)
		extrn __imp_fopen:dword	; DATA XREF: fopenr
; int fprintf(FILE *File, const	char *Format, ...)
		extrn __imp_fprintf:dword ; DATA XREF: fprintfr
; int __cdecl fputs(const char *Str, FILE *File)
		extrn __imp_fputs:dword	; DATA XREF: fputsr
; size_t __cdecl fread(void *DstBuf, size_t ElementSize, size_t	Count, FILE *File)
		extrn __imp_fread:dword	; DATA XREF: freadr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; int __cdecl fseek(FILE *File,	__int32	Offset,	int Origin)
		extrn __imp_fseek:dword	; DATA XREF: fseekr
; int __cdecl fsetpos(FILE *File, const	fpos_t *Pos)
		extrn __imp_fsetpos:dword ; DATA XREF: fsetposr
; __int32 __cdecl ftell(FILE *File)
		extrn __imp_ftell:dword	; DATA XREF: ftellr
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; int __cdecl getc(FILE	*File)
		extrn __imp_getc:dword	; DATA XREF: getcr
; char *__cdecl	getenv(const char *VarName)
		extrn __imp_getenv:dword ; DATA	XREF: getenvr
; struct tm *__cdecl static gmtime(const time_t	*Time)
		extrn gmtime:dword	; DATA XREF: sub_442F50r
; int __cdecl isspace(int C)
		extrn isspace:dword	; CODE XREF: sub_42A743+C9p
					; .text:0042BA30p ...
; struct tm *__cdecl static localtime(const time_t *Time)
		extrn localtime:dword	; DATA XREF: sub_442F70r
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; void *__cdecl	memchr(const void *Buf,	int Val, size_t	MaxCount)
		extrn __imp_memchr:dword ; DATA	XREF: memchrr
; int __cdecl memcmp(const void	*Buf1, const void *Buf2, size_t	Size)
		extrn __imp_memcmp:dword ; DATA	XREF: memcmpr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; void *__cdecl	memmove(void *Dst, const void *Src, size_t Size)
		extrn __imp_memmove:dword ; DATA XREF: memmover
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn __imp_memset:dword ; DATA	XREF: memsetr
; time_t __cdecl static	mktime(struct tm *Tm)
		extrn mktime:dword	; DATA XREF: sub_442F60r
; int printf(const char	*Format, ...)
		extrn __imp_printf:dword ; DATA	XREF: printfr
; int __cdecl putc(int Ch, FILE	*File)
		extrn __imp_putc:dword	; DATA XREF: putcr
; int __cdecl putchar(int Ch)
		extrn __imp_putchar:dword ; DATA XREF: putcharr
; int __cdecl puts(const char *Str)
		extrn __imp_puts:dword	; DATA XREF: putsr
		extrn __imp_raise:dword	; DATA XREF: raiser
; void *__cdecl	realloc(void *Memory, size_t NewSize)
		extrn __imp_realloc:dword ; DATA XREF: reallocr
; int __cdecl remove(const char	*Filename)
		extrn __imp_remove:dword ; DATA	XREF: remover
; void __cdecl rewind(FILE *File)
		extrn __imp_rewind:dword ; DATA	XREF: rewindr
; int __cdecl setvbuf(FILE *File, char *Buf, int Mode, size_t Size)
		extrn __imp_setvbuf:dword ; DATA XREF: setvbufr
		extrn __imp_signal:dword ; DATA	XREF: signalr
; int sprintf(char *Dest, const	char *Format, ...)
		extrn __imp_sprintf:dword ; DATA XREF: sprintfr
; int sscanf(const char	*Src, const char *Format, ...)
		extrn __imp_sscanf:dword ; DATA	XREF: sscanfr
; char *__cdecl	strcat(char *Dest, const char *Source)
		extrn __imp_strcat:dword ; DATA	XREF: strcatr
; char *__cdecl	strchr(const char *Str,	int Val)
		extrn __imp_strchr:dword ; DATA	XREF: strchrr
; int __cdecl strcmp(const char	*Str1, const char *Str2)
		extrn __imp_strcmp:dword ; DATA	XREF: strcmpr
; char *__cdecl	strcpy(char *Dest, const char *Source)
		extrn __imp_strcpy:dword ; DATA	XREF: strcpyr
; size_t __cdecl strcspn(const char *Str, const	char *Control)
		extrn __imp_strcspn:dword ; DATA XREF: strcspnr
; char *__cdecl	strerror(int)
		extrn __imp_strerror:dword ; DATA XREF:	strerrorr
; size_t __cdecl strftime(char *Buf, size_t SizeInBytes, const char *Format, const struct tm *Tm)
		extrn __imp_strftime:dword ; DATA XREF:	strftimer
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; char *__cdecl	strncpy(char *Dest, const char *Source,	size_t Count)
		extrn __imp_strncpy:dword ; DATA XREF: strncpyr
; char *__cdecl	strpbrk(const char *Str, const char *Control)
		extrn __imp_strpbrk:dword ; DATA XREF: strpbrkr
; char *__cdecl	strrchr(const char *Str, int Ch)
		extrn __imp_strrchr:dword ; DATA XREF: strrchrr
; char *__cdecl	strstr(const char *Str,	const char *SubStr)
		extrn __imp_strstr:dword ; DATA	XREF: strstrr
; __int32 __cdecl strtol(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtol:dword ; DATA	XREF: strtolr
; unsigned __int32 __cdecl strtoul(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtoul:dword ; DATA XREF: strtoulr
; time_t __cdecl static	time(time_t *Time)
		extrn time:dword	; DATA XREF: sub_442F40r
; int __cdecl toupper(int C)
		extrn toupper:dword	; CODE XREF: .text:00438D49p
					; .text:00438D5Ep ...
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr

;
; Imports from USER32.dll
;
; BOOL __stdcall AllowSetForegroundWindow(DWORD	dwProcessId)
		extrn AllowSetForegroundWindow:dword ; CODE XREF: sub_4260FC+41p
					; DATA XREF: sub_4260FC+3Cr
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn MessageBoxA:dword	; CODE XREF: sub_442470+122p
					; DATA XREF: sub_442470+122r

;
; Imports from WS2_32.dll
;
; int __stdcall	WSAGetLastError()
		extrn WSAGetLastError:dword ; CODE XREF: sub_435224+A3p
					; sub_435224+14Dp
					; DATA XREF: ...
; int __stdcall	__WSAFDIsSet(SOCKET fd,	fd_set *)
		extrn __imp___WSAFDIsSet:dword ; DATA XREF: __WSAFDIsSetr
; int __stdcall	closesocket(SOCKET s)
		extrn closesocket:dword	; CODE XREF: sub_435224+1F4p
					; DATA XREF: sub_435224+1EFr
; int __stdcall	listen(SOCKET s, int backlog)
		extrn listen:dword	; CODE XREF: sub_402D72+252p
					; DATA XREF: sub_402D72+24Dr
; int __stdcall	recv(SOCKET s, char *buf, int len, int flags)
		extrn recv:dword	; CODE XREF: sub_435224+90p
					; DATA XREF: sub_435224+8Br
; int __stdcall	send(SOCKET s, const char *buf,	int len, int flags)
		extrn send:dword	; CODE XREF: sub_435224+13Ap
					; DATA XREF: sub_435224+135r


; Section 6. (virtual address 00055000)
; Virtual size			: 00000034 (	 52.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00050800
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 455000h
dword_455000	dd 0			; DATA XREF: sub_401180+2D8o
		dd offset sub_401010
dword_455008	dd 0			; DATA XREF: sub_401180:loc_401450o
dword_45500C	dd 0			; DATA XREF: sub_401180+316o
		dd offset sub_401060
		dd offset sub_441070
dword_455018	dd 2 dup(0)		; DATA XREF: sub_401180+30Eo
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
		dd offset TlsCallback_1
		dd 0
		align 10h
dword_455030	dd 74h dup(0)		; DATA XREF: TlsCallback_0:loc_441013o
					; TlsCallback_0+138o ...
		align 1000h
_CRT		ends

; Section 7. (virtual address 00056000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00050A00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 456000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end start
