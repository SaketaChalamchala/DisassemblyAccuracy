;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	BBF3DC42CD3A81D750EAA464A2B2E486
; Input	CRC32 :	A519FF99

; File Name   :	C:\compspace\compare\gpg\dlls\full\dirmngr_ldap.exe
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00008F24 (  36644.)
; Section size in file		: 00009000 (  36864.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
; [00000002 BYTES: COLLAPSED FUNCTION nullsub_1]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401010	proc near		; DATA XREF: .CRT:0040F004o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch

		sub	esp, 2Ch
		mov	eax, dword ptr ds:byte_40D280+20h
		mov	[esp+2Ch+var_1C], offset dword_40D018
		mov	[esp+2Ch+var_24], offset dword_40D00C
		mov	[esp+2Ch+var_28], offset dword_40D008
		mov	ds:dword_40D018, eax
		mov	eax, dword ptr ds:byte_40D280+24h
		mov	[esp+2Ch+var_2C], offset dword_40D004
		mov	[esp+2Ch+var_20], eax
		call	__getmainargs
		mov	ds:dword_40D01C, eax
		add	esp, 2Ch
		retn
sub_401010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401060	proc near		; DATA XREF: .CRT:0040F010o

var_1C		= dword	ptr -1Ch

		sub	esp, 1Ch
		xor	eax, eax
		cmp	word ptr ds:400000h, 5A4Dh
		mov	dword ptr ds:byte_40D280+30h, 1
		mov	dword ptr ds:byte_40D280+2Ch, 1
		mov	dword ptr ds:byte_40D280+28h, 1
		mov	ds:dword_40D2BC, 1
		jz	short loc_401100

loc_401098:				; CODE XREF: sub_401060+B6j
					; sub_401060+C8j ...
		mov	ds:dword_40D014, eax
		mov	eax, ds:dword_40D2C0
		test	eax, eax
		jz	short loc_4010F0
		mov	[esp+1Ch+var_1C], 2
		call	__set_app_type

loc_4010B2:				; CODE XREF: sub_401060+9Cj
		mov	[esp+1Ch+var_1C], 0FFFFFFFFh
		call	sub_408930
		mov	edx, ds:dword_40D2C4
		mov	ds:dword_40D67C, eax
		mov	ds:dword_40D680, eax
		mov	eax, ds:_fmode
		mov	[eax], edx
		call	sub_408C70
		cmp	dword_40A11C, 1
		jz	short loc_401150
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4010F0:				; CODE XREF: sub_401060+44j
		mov	[esp+1Ch+var_1C], 1
		call	__set_app_type
		jmp	short loc_4010B2
; ---------------------------------------------------------------------------
		align 10h

loc_401100:				; CODE XREF: sub_401060+36j
		mov	edx, ds:40003Ch
		cmp	dword ptr [edx+400000h], 4550h
		lea	ecx, [edx+400000h]
		jnz	short loc_401098
		movzx	edx, word ptr [ecx+18h]
		cmp	dx, 10Bh
		jz	short loc_401162
		cmp	dx, 20Bh
		jnz	loc_401098
		cmp	dword ptr [ecx+84h], 0Eh
		jbe	loc_401098
		mov	edx, [ecx+0F8h]
		xor	eax, eax
		test	edx, edx
		setnz	al
		jmp	loc_401098
; ---------------------------------------------------------------------------
		align 10h

loc_401150:				; CODE XREF: sub_401060+81j
		mov	[esp+1Ch+var_1C], offset sub_408C10
		call	sub_408C00
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_401162:				; CODE XREF: sub_401060+C1j
		cmp	dword ptr [ecx+74h], 0Eh
		jbe	loc_401098
		mov	ecx, [ecx+0E8h]
		xor	eax, eax
		test	ecx, ecx
		setnz	al
		jmp	loc_401098
sub_401060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401180	proc near		; CODE XREF: .text:004014C5j start+15j

dwMilliseconds	= dword	ptr -88h
lpProcName	= dword	ptr -84h
Size		= dword	ptr -80h
var_6D		= byte ptr -6Dh
var_6C		= dword	ptr -6Ch
var_5C		= byte ptr -5Ch
var_30		= byte ptr -30h
var_2C		= word ptr -2Ch

		push	ebp
		xor	eax, eax
		mov	ebp, esp
		mov	ecx, 11h
		push	edi
		push	esi
		lea	edx, [ebp+var_5C]
		push	ebx
		mov	edi, edx
		sub	esp, 7Ch
		rep stosd
		mov	al, 30h
		call	sub_4099E0
		sub	esp, eax
		lea	eax, [esp+88h+var_6D]
		and	eax, 0FFFFFFF0h
		mov	dword ptr [eax], 0CCCCCCCCh
		mov	dword ptr [eax+4], 0CCCCCCCCh
		mov	dword ptr [eax+8], 0CCCCCCCCh
		mov	dword ptr [eax+0Ch], 0CCCCCCCCh
		mov	dword ptr [eax+10h], 0CCCCCCCCh
		mov	dword ptr [eax+14h], 0CCCCCCCCh
		mov	dword ptr [eax+18h], 0CCCCCCCCh
		mov	dword ptr [eax+1Ch], 0CCCCCCCCh
		and	esp, 0FFFFFFF0h
		mov	eax, ds:dword_40D2C0
		test	eax, eax
		jnz	loc_401473

loc_4011EE:				; CODE XREF: sub_401180+2FFj
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_401214
; ---------------------------------------------------------------------------
		align 10h

loc_401200:				; CODE XREF: sub_401180+B1j
		cmp	eax, ebx
		jz	loc_401420
		mov	[esp+88h+dwMilliseconds], 3E8h ; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_401214:				; CODE XREF: sub_401180+7Dj
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], ebx
		mov	[esp+88h+dwMilliseconds], offset dword_40D684
		call	sub_409A50
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_401200
		mov	eax, ds:dword_40D688
		xor	ebx, ebx
		cmp	eax, 1
		jz	loc_401433

loc_401243:				; CODE XREF: sub_401180+2ADj
		mov	eax, ds:dword_40D688
		test	eax, eax
		jz	loc_401484
		mov	ds:dword_40D000, 1

loc_40125A:				; CODE XREF: sub_401180+322j
		mov	eax, ds:dword_40D688
		cmp	eax, 1
		jz	loc_401450

loc_401268:				; CODE XREF: sub_401180+2C7j
					; sub_401180+2EEj
		test	ebx, ebx
		jnz	short loc_401273
		lock xchg ebx, ds:dword_40D684

loc_401273:				; CODE XREF: sub_401180+EAj
		mov	eax, ds:off_40C388
		test	eax, eax
		jz	short loc_401298
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], 2
		mov	[esp+88h+dwMilliseconds], 0
		call	eax ; TlsCallback_0
		sub	esp, 0Ch

loc_401298:				; CODE XREF: sub_401180+FAj
		call	sub_408F20
		mov	[esp+88h+dwMilliseconds], offset TopLevelExceptionFilter ; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	ds:dword_40D2C8, eax
		call	sub_4094D0
		mov	[esp+88h+lpProcName], offset ProcName ;	"_set_invalid_parameter_handler"
		mov	[esp+88h+dwMilliseconds], eax ;	hModule
		call	ds:GetProcAddress
		sub	esp, 8
		test	eax, eax
		jz	short loc_4012D8
		mov	[esp+88h+dwMilliseconds], offset nullsub_1
		call	eax

loc_4012D8:				; CODE XREF: sub_401180+14Dj
		call	sub_409590
		mov	eax, ds:dword_40D2C0
		test	eax, eax
		jz	short loc_401344
		mov	eax, ds:_acmdln
		xor	ecx, ecx
		mov	eax, [eax]
		jmp	short loc_4012FC
; ---------------------------------------------------------------------------

loc_4012F1:				; CODE XREF: sub_401180+182j
		test	dl, dl
		jz	short loc_401320
		test	cl, cl
		jz	short loc_401315

loc_4012F9:				; CODE XREF: sub_401180+18Fj
		add	eax, 1

loc_4012FC:				; CODE XREF: sub_401180+16Fj
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_4012F1
		mov	ebx, ecx
		xor	ebx, 1
		cmp	dl, 22h
		cmovz	ecx, ebx
		jmp	short loc_4012F9
; ---------------------------------------------------------------------------

loc_401311:				; CODE XREF: sub_401180+19Ej
		test	dl, dl
		jz	short loc_401320

loc_401315:				; CODE XREF: sub_401180+177j
		add	eax, 1
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_401311

loc_401320:				; CODE XREF: sub_401180+173j
					; sub_401180+193j
		movzx	edx, [ebp+var_2C]
		test	[ebp+var_30], 1
		mov	ds:dword_40D664, eax
		mov	eax, 0Ah
		mov	ds:dword_40D66C, 400000h
		cmovnz	eax, edx
		mov	ds:dword_40D668, eax

loc_401344:				; CODE XREF: sub_401180+164j
		mov	edx, ds:dword_40D004
		xor	ebx, ebx
		lea	eax, ds:4[edx*4]
		mov	[ebp+var_6C], edx
		mov	[esp+88h+dwMilliseconds], eax ;	Size
		call	malloc
		mov	edi, ds:dword_40D008
		mov	[ebp-70h], eax
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jle	short loc_4013AA
		xchg	ax, ax

loc_401370:				; CODE XREF: sub_401180+225j
		mov	eax, [edi+ebx*4]
		mov	[esp+88h+dwMilliseconds], eax ;	Str
		call	strlen
		lea	esi, [eax+1]
		mov	[esp+88h+dwMilliseconds], esi ;	Size
		call	malloc
		mov	edx, [ebp-70h]
		mov	[edx+ebx*4], eax
		mov	edx, [edi+ebx*4]
		add	ebx, 1
		mov	[esp+88h+Size],	esi ; Size
		mov	[esp+88h+dwMilliseconds], eax ;	Dst
		mov	[esp+88h+lpProcName], edx ; Src
		call	memcpy
		cmp	ebx, [ebp+var_6C]
		jnz	short loc_401370
		shl	ebx, 2

loc_4013AA:				; CODE XREF: sub_401180+1ECj
		mov	eax, [ebp-70h]
		mov	dword ptr [eax+ebx], 0
		mov	ds:dword_40D008, eax
		call	sub_409620
		mov	eax, ds:__initenv
		mov	edx, ds:dword_40D00C
		mov	[eax], edx
		mov	eax, ds:dword_40D00C
		mov	[esp+88h+Size],	eax
		mov	eax, ds:dword_40D008
		mov	[esp+88h+lpProcName], eax
		mov	eax, ds:dword_40D004
		mov	[esp+88h+dwMilliseconds], eax
		call	sub_4015C4
		mov	esi, ds:dword_40D014
		test	esi, esi
		mov	ds:dword_40D010, eax
		jz	loc_4014A7
		mov	ebx, ds:dword_40D000
		test	ebx, ebx
		jnz	short loc_401411
		call	_cexit
		mov	eax, ds:dword_40D010

loc_401411:				; CODE XREF: sub_401180+285j
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_401420:				; CODE XREF: sub_401180+82j
		mov	eax, ds:dword_40D688
		mov	ebx, 1
		cmp	eax, 1
		jnz	loc_401243

loc_401433:				; CODE XREF: sub_401180+BDj
		mov	[esp+88h+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, ds:dword_40D688
		cmp	eax, 1
		jnz	loc_401268
		lea	esi, [esi+0]

loc_401450:				; CODE XREF: sub_401180+E2j
		mov	[esp+88h+lpProcName], offset dword_40F008
		mov	[esp+88h+dwMilliseconds], offset dword_40F000
		call	_initterm
		mov	ds:dword_40D688, 2
		jmp	loc_401268
; ---------------------------------------------------------------------------

loc_401473:				; CODE XREF: sub_401180+68j
		mov	[esp+88h+dwMilliseconds], edx ;	lpStartupInfo
		call	ds:GetStartupInfoA
		sub	esp, 4
		jmp	loc_4011EE
; ---------------------------------------------------------------------------

loc_401484:				; CODE XREF: sub_401180+CAj
		mov	ds:dword_40D688, 1
		mov	[esp+88h+lpProcName], offset dword_40F018
		mov	[esp+88h+dwMilliseconds], offset dword_40F00C
		call	_initterm
		jmp	loc_40125A
; ---------------------------------------------------------------------------

loc_4014A7:				; CODE XREF: sub_401180+277j
		mov	[esp+88h+dwMilliseconds], eax ;	Code
		call	exit
sub_401180	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		mov	ds:dword_40D2C0, 1
		call	sub_409640
		add	esp, 0Ch
		jmp	sub_401180
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public start
start		proc near
		sub	esp, 0Ch
		mov	ds:dword_40D2C0, 0
		call	sub_409640
		add	esp, 0Ch
		jmp	sub_401180
start		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4014F0	proc near		; CODE XREF: sub_409EF0+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_40A128
		test	eax, eax
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj-12.dll"
		call	ds:GetModuleHandleA
		mov	edx, 0
		sub	esp, 4
		test	eax, eax
		jz	short loc_40152E
		mov	[esp+18h+lpProcName], offset a_jv_registercl ; "_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	eax ; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		mov	edx, eax

loc_40152E:				; CODE XREF: sub_4014F0+26j
		test	edx, edx
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset dword_40A128
		call	edx

locret_40153B:				; CODE XREF: sub_4014F0+Dj
					; sub_4014F0+40j
		leave
		retn
sub_4014F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401540()
sub_401540	proc near		; DATA XREF: sub_409EF0+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401540	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401550	proc near		; DATA XREF: sub_4015C4+42o

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		cmp	[ebp+arg_0], 31h ; switch 50 cases
		ja	short loc_4015B3 ; jumptable 00401569 default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_40B390
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40156B:				; CODE XREF: sub_401550+19j
					; DATA XREF: .rdata:off_40B390o
		mov	[ebp+var_4], offset aDirmngr_ldapDi ; jumptable	00401569 case 11
		jmp	short loc_4015BA
; ---------------------------------------------------------------------------

loc_401574:				; CODE XREF: sub_401550+19j
					; DATA XREF: .rdata:off_40B390o
		mov	[ebp+var_4], offset a1_1_1 ; jumptable 00401569	case 13
		jmp	short loc_4015BA
; ---------------------------------------------------------------------------

loc_40157D:				; CODE XREF: sub_401550+19j
					; DATA XREF: .rdata:off_40B390o
		mov	[ebp+var_4], offset aCopyrightC2013 ; jumptable	00401569 case 14
		jmp	short loc_4015BA
; ---------------------------------------------------------------------------

loc_401586:				; CODE XREF: sub_401550+19j
					; DATA XREF: .rdata:off_40B390o
		mov	[ebp+var_4], offset aMingw32 ; jumptable 00401569 case 17
		jmp	short loc_4015BA
; ---------------------------------------------------------------------------

loc_40158F:				; CODE XREF: sub_401550+19j
					; DATA XREF: .rdata:off_40B390o
		mov	[ebp+var_4], offset aPleaseReportBu ; jumptable	00401569 case 19
		jmp	short loc_4015BA
; ---------------------------------------------------------------------------

loc_401598:				; CODE XREF: sub_401550+19j
					; DATA XREF: .rdata:off_40B390o
		mov	[ebp+var_4], offset aBugDirmngr@gnu ; jumptable	00401569 case 49
		jmp	short loc_4015BA
; ---------------------------------------------------------------------------

loc_4015A1:				; CODE XREF: sub_401550+19j
					; DATA XREF: .rdata:off_40B390o
		mov	[ebp+var_4], offset aUsageDirmngr_l ; jumptable	00401569 cases 1,40
		jmp	short loc_4015BA
; ---------------------------------------------------------------------------

loc_4015AA:				; CODE XREF: sub_401550+19j
					; DATA XREF: .rdata:off_40B390o
		mov	[ebp+var_4], offset aSyntaxDirmngr_ ; jumptable	00401569 case 41
		jmp	short loc_4015BA
; ---------------------------------------------------------------------------

loc_4015B3:				; CODE XREF: sub_401550+Aj
					; sub_401550+19j
					; DATA XREF: ...
		mov	[ebp+var_4], 0	; jumptable 00401569 default case

loc_4015BA:				; CODE XREF: sub_401550+22j
					; sub_401550+2Bj ...
		mov	eax, [ebp+var_4]
		leave
		retn
sub_401550	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4015BF	proc near		; CODE XREF: sub_4015C4+62p
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_4015BF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4015C4	proc near		; CODE XREF: sub_401180+265p

File		= dword	ptr -60h
Val		= dword	ptr -5Ch
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_28		= dword	ptr -28h
Str		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF0h
		sub	esp, 60h
		call	sub_409620
		mov	[esp+60h+var_4], 0
		mov	[esp+60h+var_8], 0
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+60h+File],	eax ; File
		mov	eax, ds:_fileno_0
		call	eax ; _fileno_0
		mov	[esp+60h+Val], 8000h
		mov	[esp+60h+File],	eax
		mov	eax, ds:_setmode
		call	eax ; _setmode
		mov	[esp+60h+File],	offset sub_401550
		call	sub_4054C1
		mov	[esp+60h+Val], 1 ; int
		mov	[esp+60h+File],	offset aDirmngr_ldap ; "dirmngr_ldap"
		call	sub_4057F2
		call	sub_4015BF
		mov	ds:timeout.tv_sec, 64h
		mov	ds:timeout.tv_usec, 0
		mov	ds:dword_40D030, 0
		lea	eax, [ebp+arg_0]
		mov	[esp+60h+var_40], eax
		lea	eax, [ebp+arg_4]
		mov	[esp+60h+var_3C], eax
		mov	[esp+60h+var_38], 1
		jmp	loc_401818
; ---------------------------------------------------------------------------

loc_401664:				; CODE XREF: sub_4015C4+26Aj
		mov	eax, [esp+60h+var_30]
		cmp	eax, 1F9h
		jz	loc_401779
		cmp	eax, 1F9h
		jg	short loc_4016C9
		cmp	eax, 1F5h
		jz	loc_40176A
		cmp	eax, 1F5h
		jg	short loc_4016AE
		cmp	eax, 76h
		jz	loc_401718
		cmp	eax, 1F4h
		jz	loc_40173C
		cmp	eax, 71h
		jz	loc_40172A
		jmp	loc_40180F
; ---------------------------------------------------------------------------

loc_4016AE:				; CODE XREF: sub_4015C4+C6j
		cmp	eax, 1F7h
		jz	loc_4017B3
		cmp	eax, 1F7h
		jg	loc_4017BE
		jmp	loc_4017A8
; ---------------------------------------------------------------------------

loc_4016C9:				; CODE XREF: sub_4015C4+B4j
		cmp	eax, 1FDh
		jz	loc_4017D4
		cmp	eax, 1FDh
		jg	short loc_4016F6
		cmp	eax, 1FBh
		jz	loc_401795
		cmp	eax, 1FBh
		jg	loc_4017C9
		jmp	loc_401787
; ---------------------------------------------------------------------------

loc_4016F6:				; CODE XREF: sub_4015C4+115j
		cmp	eax, 1FFh
		jz	short loc_40175D
		cmp	eax, 1FFh
		jl	loc_4017DF
		cmp	eax, 200h
		jz	loc_4017EA
		jmp	loc_40180F
; ---------------------------------------------------------------------------

loc_401718:				; CODE XREF: sub_4015C4+CBj
		mov	eax, ds:dword_40D024
		add	eax, 1
		mov	ds:dword_40D024, eax
		jmp	loc_401818
; ---------------------------------------------------------------------------

loc_40172A:				; CODE XREF: sub_4015C4+DFj
		mov	eax, ds:dword_40D020
		add	eax, 1
		mov	ds:dword_40D020, eax
		jmp	loc_401818
; ---------------------------------------------------------------------------

loc_40173C:				; CODE XREF: sub_4015C4+D6j
		mov	eax, [esp+60h+var_28]
		mov	ds:timeout.tv_sec, eax
		mov	ds:timeout.tv_usec, 0
		mov	eax, [esp+60h+var_28]
		mov	ds:dword_40D030, eax
		jmp	loc_401818
; ---------------------------------------------------------------------------

loc_40175D:				; CODE XREF: sub_4015C4+137j
		mov	[esp+60h+var_8], 1
		jmp	loc_401818
; ---------------------------------------------------------------------------

loc_40176A:				; CODE XREF: sub_4015C4+BBj
		mov	ds:dword_40D034, 1
		jmp	loc_401818
; ---------------------------------------------------------------------------

loc_401779:				; CODE XREF: sub_4015C4+A9j
		mov	eax, [esp+60h+var_28]
		mov	ds:dn, eax
		jmp	loc_401818
; ---------------------------------------------------------------------------

loc_401787:				; CODE XREF: sub_4015C4+12Dj
		mov	eax, [esp+60h+var_28]
		mov	ds:passwd, eax
		jmp	loc_401818
; ---------------------------------------------------------------------------

loc_401795:				; CODE XREF: sub_4015C4+11Cj
		mov	[esp+60h+File],	offset VarName ; "DIRMNGR_LDAP_PASS"
		call	getenv
		mov	ds:passwd, eax
		jmp	short loc_401818
; ---------------------------------------------------------------------------

loc_4017A8:				; CODE XREF: sub_4015C4+100j
		mov	eax, [esp+60h+var_28]
		mov	ds:dword_40D038, eax
		jmp	short loc_401818
; ---------------------------------------------------------------------------

loc_4017B3:				; CODE XREF: sub_4015C4+EFj
		mov	eax, [esp+60h+var_28]
		mov	ds:Str,	eax
		jmp	short loc_401818
; ---------------------------------------------------------------------------

loc_4017BE:				; CODE XREF: sub_4015C4+FAj
		mov	eax, [esp+60h+var_28]
		mov	ds:dword_40D048, eax
		jmp	short loc_401818
; ---------------------------------------------------------------------------

loc_4017C9:				; CODE XREF: sub_4015C4+127j
		mov	eax, [esp+60h+var_28]
		mov	ds:dword_40D04C, eax
		jmp	short loc_401818
; ---------------------------------------------------------------------------

loc_4017D4:				; CODE XREF: sub_4015C4+10Aj
		mov	eax, [esp+60h+var_28]
		mov	ds:dword_40D050, eax
		jmp	short loc_401818
; ---------------------------------------------------------------------------

loc_4017DF:				; CODE XREF: sub_4015C4+13Ej
		mov	eax, [esp+60h+var_28]
		mov	ds:dword_40D054, eax
		jmp	short loc_401818
; ---------------------------------------------------------------------------

loc_4017EA:				; CODE XREF: sub_4015C4+149j
		lea	eax, [esp+60h+var_44]
		mov	[esp+60h+File],	eax
		call	sub_405850
		mov	eax, [esp+60h+var_44]
		or	eax, 4
		mov	[esp+60h+Val], eax ; int
		mov	[esp+60h+File],	0 ; char *
		call	sub_4057F2
		jmp	short loc_401818
; ---------------------------------------------------------------------------

loc_40180F:				; CODE XREF: sub_4015C4+E5j
					; sub_4015C4+14Fj
		mov	[esp+60h+var_34], 2
		nop

loc_401818:				; CODE XREF: sub_4015C4+9Bj
					; sub_4015C4+161j ...
		mov	[esp+60h+Val], offset dword_40A000
		lea	eax, [esp+60h+var_40]
		mov	[esp+60h+File],	eax
		call	sub_40436E
		test	eax, eax
		jnz	loc_401664
		cmp	[esp+60h+var_8], 0
		jz	short loc_401845
		mov	ds:dword_40D030, 0

loc_401845:				; CODE XREF: sub_4015C4+275j
		mov	eax, ds:dword_40D038
		test	eax, eax
		jz	short loc_4018B0
		mov	eax, ds:dword_40D038
		mov	[esp+60h+File],	eax ; char *
		call	sub_402543
		mov	ds:Str,	eax
		mov	eax, ds:Str
		mov	[esp+60h+Val], 3Ah ; Val
		mov	[esp+60h+File],	eax ; Str
		call	strchr
		mov	[esp+60h+Str], eax
		cmp	[esp+60h+Str], 0
		jz	short loc_40189D
		mov	eax, [esp+60h+Str]
		mov	byte ptr [eax],	0
		add	[esp+60h+Str], 1
		mov	eax, [esp+60h+Str]
		mov	[esp+60h+File],	eax ; Str
		call	atoi
		mov	ds:dword_40D048, eax

loc_40189D:				; CODE XREF: sub_4015C4+2BAj
		mov	eax, ds:dword_40D048
		test	eax, eax
		jnz	short loc_4018B0
		mov	ds:dword_40D048, 185h

loc_4018B0:				; CODE XREF: sub_4015C4+288j
					; sub_4015C4+2E0j
		mov	eax, ds:dword_40D048
		test	eax, eax
		js	short loc_4018C5
		mov	eax, ds:dword_40D048
		cmp	eax, 0FFFFh
		jle	short loc_4018DA

loc_4018C5:				; CODE XREF: sub_4015C4+2F3j
		mov	eax, ds:dword_40D048
		mov	[esp+60h+Val], eax ; char
		mov	[esp+60h+File],	offset aInvalidPortNum ; "invalid port number %d\n"
		call	sub_405D65

loc_4018DA:				; CODE XREF: sub_4015C4+2FFj
		mov	[esp+60h+File],	0
		call	sub_4054D0
		test	eax, eax
		jz	short loc_4018F6
		mov	[esp+60h+File],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4018F6:				; CODE XREF: sub_4015C4+324j
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jg	short loc_401938
		mov	[esp+60h+File],	1
		call	sub_40536B
		jmp	short loc_401938
; ---------------------------------------------------------------------------

loc_40190B:				; CODE XREF: sub_4015C4+37Aj
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[esp+60h+File],	eax
		call	sub_4023BA
		test	eax, eax
		jz	short loc_401924
		mov	[esp+60h+var_4], 1

loc_401924:				; CODE XREF: sub_4015C4+356j
		mov	eax, [ebp+arg_0]
		sub	eax, 1
		mov	[ebp+arg_0], eax
		mov	eax, [ebp+arg_4]
		add	eax, 4
		mov	[ebp+arg_4], eax
		jmp	short loc_401939
; ---------------------------------------------------------------------------

loc_401938:				; CODE XREF: sub_4015C4+337j
					; sub_4015C4+345j
		nop

loc_401939:				; CODE XREF: sub_4015C4+372j
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jnz	short loc_40190B
		mov	eax, [esp+60h+var_4]
		leave
		retn
sub_4015C4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp], 0Ah
		mov	eax, ds:__imp__exit
		call	eax ; __imp__exit

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40195A	proc near		; CODE XREF: sub_40195F:loc_401A55p
					; sub_401EDD:loc_4021B4p ...
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_40195A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40195F(LDAP *ExternalHandle, LDAPMessage *, char *Str)
sub_40195F	proc near		; CODE XREF: sub_401EDD+4BEp

ld		= dword	ptr -68h
res		= dword	ptr -64h
Count		= dword	ptr -60h
File		= dword	ptr -5Ch
var_4C		= dword	ptr -4Ch
var_3E		= byte ptr -3Eh
var_3D		= byte ptr -3Dh
var_3C		= byte ptr -3Ch
var_3B		= byte ptr -3Bh
var_3A		= byte ptr -3Ah
var_39		= byte ptr -39h
var_38		= byte ptr -38h
var_37		= byte ptr -37h
var_36		= byte ptr -36h
var_35		= byte ptr -35h
ptr		= dword	ptr -34h
var_30		= dword	ptr -30h
Size		= dword	ptr -2Ch
vals		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
Block		= dword	ptr -14h
var_10		= dword	ptr -10h
entry		= dword	ptr -0Ch
ExternalHandle	= dword	ptr  8
arg_4		= dword	ptr  0Ch
Str		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 64h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_4]
		mov	[esp+68h+res], eax ; res
		mov	eax, [ebp+ExternalHandle]
		mov	[esp+68h+ld], eax ; ld
		mov	eax, ds:ldap_first_entry
		call	eax ; ldap_first_entry
		mov	[ebp+entry], eax
		jmp	loc_401E9F
; ---------------------------------------------------------------------------

loc_401989:				; CODE XREF: sub_40195F+544j
		mov	eax, ds:dword_40D024
		cmp	eax, 1
		jle	short loc_4019B3
		cmp	[ebp+Str], 0
		jz	short loc_40199E
		mov	eax, [ebp+Str]
		jmp	short loc_4019A3
; ---------------------------------------------------------------------------

loc_40199E:				; CODE XREF: sub_40195F+38j
		mov	eax, offset aAll ; "[all]"

loc_4019A3:				; CODE XREF: sub_40195F+3Dj
		mov	[esp+68h+res], eax ; char
		mov	[esp+68h+ld], offset aScanningResult ; "scanning result	for attribute `%s'\n"
		call	sub_405D3B

loc_4019B3:				; CODE XREF: sub_40195F+32j
		mov	eax, ds:dword_40D034
		test	eax, eax
		jz	short loc_401A15
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aI	; "I"
		mov	[esp+68h+File],	edx ; File
		mov	[esp+68h+Count], 1 ; Count
		mov	[esp+68h+res], 5 ; Size
		mov	[esp+68h+ld], eax ; Str
		call	fwrite
		cmp	eax, 1
		jz	short loc_401A15
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+68h+ld], eax ; int
		call	strerror
		mov	[esp+68h+res], eax ; char
		mov	[esp+68h+ld], offset aErrorWritingTo ; "error writing to stdout: %s\n"
		call	sub_405D65
		mov	eax, 0FFFFFFFFh
		jmp	loc_401ED7
; ---------------------------------------------------------------------------

loc_401A15:				; CODE XREF: sub_40195F+5Bj
					; sub_40195F+89j
		lea	eax, [ebp+ptr]
		mov	[esp+68h+Count], eax ; ptr
		mov	eax, [ebp+entry]
		mov	[esp+68h+res], eax ; entry
		mov	eax, [ebp+ExternalHandle]
		mov	[esp+68h+ld], eax ; ld
		mov	eax, ds:ldap_first_attribute
		call	eax ; ldap_first_attribute
		mov	[ebp+Block], eax
		jmp	loc_401E6B
; ---------------------------------------------------------------------------

loc_401A38:				; CODE XREF: sub_40195F+510j
		mov	eax, ds:dword_40D024
		cmp	eax, 1
		jle	short loc_401A55
		mov	eax, [ebp+Block]
		mov	[esp+68h+res], eax ; char
		mov	[esp+68h+ld], offset aAvailableAttri ; "	  available attribute `%s'\n"
		call	sub_405D3B

loc_401A55:				; CODE XREF: sub_40195F+E1j
		call	sub_40195A
		cmp	[ebp+Str], 0
		jz	loc_401AED
		mov	[esp+68h+res], 3Bh ; Val
		mov	eax, [ebp+Str]
		mov	[esp+68h+ld], eax ; Str
		call	strchr
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_401A86
		mov	eax, [ebp+var_1C]
		mov	byte ptr [eax],	0

loc_401A86:				; CODE XREF: sub_40195F+11Fj
		mov	[esp+68h+res], 3Bh ; Val
		mov	eax, [ebp+Block]
		mov	[esp+68h+ld], eax ; Str
		call	strchr
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_401AA8
		mov	eax, [ebp+var_20]
		mov	byte ptr [eax],	0

loc_401AA8:				; CODE XREF: sub_40195F+141j
		mov	eax, [ebp+Block]
		mov	[esp+68h+res], eax
		mov	eax, [ebp+Str]
		mov	[esp+68h+ld], eax
		call	sub_406D7B
		mov	[ebp+var_24], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_401AC9
		mov	eax, [ebp+var_1C]
		mov	byte ptr [eax],	3Bh

loc_401AC9:				; CODE XREF: sub_40195F+162j
		cmp	[ebp+var_20], 0
		jz	short loc_401AD5
		mov	eax, [ebp+var_20]
		mov	byte ptr [eax],	3Bh

loc_401AD5:				; CODE XREF: sub_40195F+16Ej
		cmp	[ebp+var_24], 0
		jz	short loc_401AED
		mov	eax, [ebp+Block]
		mov	[esp+68h+ld], eax ; Block
		mov	eax, ds:ldap_memfree
		call	eax ; ldap_memfree
		jmp	loc_401E4D
; ---------------------------------------------------------------------------

loc_401AED:				; CODE XREF: sub_40195F+FFj
					; sub_40195F+17Aj
		mov	eax, [ebp+Block]
		mov	[esp+68h+Count], eax ; attr
		mov	eax, [ebp+entry]
		mov	[esp+68h+res], eax ; Message
		mov	eax, [ebp+ExternalHandle]
		mov	[esp+68h+ld], eax ; ExternalHandle
		mov	eax, ds:ldap_get_values_len
		call	eax ; ldap_get_values_len
		mov	[ebp+vals], eax
		cmp	[ebp+vals], 0
		jnz	short loc_401B3F
		mov	eax, ds:dword_40D024
		test	eax, eax
		jz	short loc_401B2D
		mov	eax, [ebp+Block]
		mov	[esp+68h+res], eax ; char
		mov	[esp+68h+ld], offset aAttributeSNotF ; "attribute `%s' not found\n"
		call	sub_405D3B

loc_401B2D:				; CODE XREF: sub_40195F+1B9j
		mov	eax, [ebp+Block]
		mov	[esp+68h+ld], eax ; Block
		mov	eax, ds:ldap_memfree
		call	eax ; ldap_memfree
		jmp	loc_401E4D
; ---------------------------------------------------------------------------

loc_401B3F:				; CODE XREF: sub_40195F+1B0j
		mov	eax, ds:dword_40D024
		test	eax, eax
		jz	short loc_401B9F
		mov	eax, [ebp+Block]
		mov	[esp+68h+res], eax ; char
		mov	[esp+68h+ld], offset aFoundAttribute ; "found attribute	`%s'\n"
		call	sub_405D3B
		mov	eax, ds:dword_40D024
		cmp	eax, 1
		jle	short loc_401B9F
		mov	dword ptr [ebp+var_18],	0
		jmp	short loc_401B90
; ---------------------------------------------------------------------------

loc_401B6E:				; CODE XREF: sub_40195F+23Ej
		mov	eax, [ebp+vals]
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[esp+68h+Count], eax
		mov	eax, dword ptr [ebp+var_18]
		mov	[esp+68h+res], eax ; char
		mov	[esp+68h+ld], offset aLengthDD ; "	   length[%d]=%d\n"
		call	sub_405D3B
		add	dword ptr [ebp+var_18],	1

loc_401B90:				; CODE XREF: sub_40195F+20Dj
		mov	eax, dword ptr [ebp+var_18]
		shl	eax, 2
		add	eax, [ebp+vals]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_401B6E

loc_401B9F:				; CODE XREF: sub_40195F+1E7j
					; sub_40195F+204j
		mov	eax, ds:dword_40D034
		test	eax, eax
		jz	loc_401CA2
		mov	eax, [ebp+Block]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+Size], eax
		mov	[ebp+var_39], 41h
		mov	eax, [ebp+Size]
		shr	eax, 18h
		mov	[ebp+var_38], al
		mov	eax, [ebp+Size]
		shr	eax, 10h
		mov	[ebp+var_37], al
		mov	eax, [ebp+Size]
		shr	eax, 8
		mov	[ebp+var_36], al
		mov	eax, [ebp+Size]
		mov	[ebp+var_35], al
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		lea	eax, [ebp+var_39]
		mov	[esp+68h+File],	edx ; File
		mov	[esp+68h+Count], 1 ; Count
		mov	[esp+68h+res], 5 ; Size
		mov	[esp+68h+ld], eax ; Str
		call	fwrite
		cmp	eax, 1
		jnz	short loc_401C4A
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, [ebp+Block]
		mov	[esp+68h+File],	edx ; File
		mov	[esp+68h+Count], 1 ; Count
		mov	edx, [ebp+Size]
		mov	[esp+68h+res], edx ; Size
		mov	[esp+68h+ld], eax ; Str
		call	fwrite
		cmp	eax, 1
		jz	short loc_401CA2

loc_401C4A:				; CODE XREF: sub_40195F+2BEj
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+68h+ld], eax ; int
		call	strerror
		mov	[esp+68h+res], eax ; char
		mov	[esp+68h+ld], offset aErrorWritingTo ; "error writing to stdout: %s\n"
		call	sub_405D65
		mov	eax, [ebp+vals]
		mov	[esp+68h+ld], eax ; vals
		mov	eax, ds:ldap_value_free_len
		call	eax ; ldap_value_free_len
		mov	eax, [ebp+Block]
		mov	[esp+68h+ld], eax ; Block
		mov	eax, ds:ldap_memfree
		call	eax ; ldap_memfree
		mov	eax, [ebp+ptr]
		mov	[esp+68h+res], 0
		mov	[esp+68h+ld], eax
		call	ber_free
		mov	eax, 0FFFFFFFFh
		jmp	loc_401ED7
; ---------------------------------------------------------------------------

loc_401CA2:				; CODE XREF: sub_40195F+247j
					; sub_40195F+2E9j
		mov	dword ptr [ebp+var_18],	0
		jmp	loc_401E0E
; ---------------------------------------------------------------------------

loc_401CAE:				; CODE XREF: sub_40195F+4BCj
		mov	eax, ds:dword_40D034
		test	eax, eax
		jz	loc_401D6E
		mov	eax, [ebp+vals]
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp+var_30], eax
		mov	[ebp+var_3E], 56h
		mov	eax, [ebp+var_30]
		shr	eax, 18h
		mov	[ebp+var_3D], al
		mov	eax, [ebp+var_30]
		shr	eax, 10h
		mov	[ebp+var_3C], al
		mov	eax, [ebp+var_30]
		shr	eax, 8
		mov	[ebp+var_3B], al
		mov	eax, [ebp+var_30]
		mov	[ebp+var_3A], al
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		lea	eax, [ebp+var_3E]
		mov	[esp+68h+File],	edx ; File
		mov	[esp+68h+Count], 1 ; Count
		mov	[esp+68h+res], 5 ; Size
		mov	[esp+68h+ld], eax ; Str
		call	fwrite
		cmp	eax, 1
		jz	short loc_401D6E
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+68h+ld], eax ; int
		call	strerror
		mov	[esp+68h+res], eax ; char
		mov	[esp+68h+ld], offset aErrorWritingTo ; "error writing to stdout: %s\n"
		call	sub_405D65
		mov	eax, [ebp+vals]
		mov	[esp+68h+ld], eax ; vals
		mov	eax, ds:ldap_value_free_len
		call	eax ; ldap_value_free_len
		mov	eax, [ebp+Block]
		mov	[esp+68h+ld], eax ; Block
		mov	eax, ds:ldap_memfree
		call	eax ; ldap_memfree
		mov	eax, [ebp+ptr]
		mov	[esp+68h+res], 0
		mov	[esp+68h+ld], eax
		call	ber_free
		mov	eax, 0FFFFFFFFh
		jmp	loc_401ED7
; ---------------------------------------------------------------------------

loc_401D6E:				; CODE XREF: sub_40195F+356j
					; sub_40195F+3B5j
		mov	eax, ds:_iob
		lea	ecx, [eax+20h]
		mov	eax, [ebp+vals]
		mov	eax, [eax]
		mov	edx, [eax]
		mov	eax, [ebp+vals]
		mov	eax, [eax]
		mov	eax, [eax+4]
		mov	[esp+68h+File],	ecx ; File
		mov	[esp+68h+Count], 1 ; Count
		mov	[esp+68h+res], edx ; Size
		mov	[esp+68h+ld], eax ; Str
		call	fwrite
		cmp	eax, 1
		jz	short loc_401DFA
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+68h+ld], eax ; int
		call	strerror
		mov	[esp+68h+res], eax ; char
		mov	[esp+68h+ld], offset aErrorWritingTo ; "error writing to stdout: %s\n"
		call	sub_405D65
		mov	eax, [ebp+vals]
		mov	[esp+68h+ld], eax ; vals
		mov	eax, ds:ldap_value_free_len
		call	eax ; ldap_value_free_len
		mov	eax, [ebp+Block]
		mov	[esp+68h+ld], eax ; Block
		mov	eax, ds:ldap_memfree
		call	eax ; ldap_memfree
		mov	eax, [ebp+ptr]
		mov	[esp+68h+res], 0
		mov	[esp+68h+ld], eax
		call	ber_free
		mov	eax, 0FFFFFFFFh
		jmp	loc_401ED7
; ---------------------------------------------------------------------------

loc_401DFA:				; CODE XREF: sub_40195F+441j
		mov	[ebp+var_10], 1
		mov	eax, ds:dword_40D034
		test	eax, eax
		jz	short loc_401E23
		add	dword ptr [ebp+var_18],	1

loc_401E0E:				; CODE XREF: sub_40195F+34Aj
		mov	eax, dword ptr [ebp+var_18]
		shl	eax, 2
		add	eax, [ebp+vals]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_401CAE
		jmp	short loc_401E24
; ---------------------------------------------------------------------------

loc_401E23:				; CODE XREF: sub_40195F+4A9j
		nop

loc_401E24:				; CODE XREF: sub_40195F+4C2j
		mov	eax, [ebp+vals]
		mov	[esp+68h+ld], eax ; vals
		mov	eax, ds:ldap_value_free_len
		call	eax ; ldap_value_free_len
		mov	eax, [ebp+Block]
		mov	[esp+68h+ld], eax ; Block
		mov	eax, ds:ldap_memfree
		call	eax ; ldap_memfree
		cmp	[ebp+Str], 0
		jnz	short loc_401E75
		mov	eax, ds:dword_40D034
		test	eax, eax
		jz	short loc_401E75

loc_401E4D:				; CODE XREF: sub_40195F+189j
					; sub_40195F+1DBj
		mov	eax, [ebp+ptr]
		mov	[esp+68h+Count], eax ; ptr
		mov	eax, [ebp+entry]
		mov	[esp+68h+res], eax ; entry
		mov	eax, [ebp+ExternalHandle]
		mov	[esp+68h+ld], eax ; ld
		mov	eax, ds:ldap_next_attribute
		call	eax ; ldap_next_attribute
		mov	[ebp+Block], eax

loc_401E6B:				; CODE XREF: sub_40195F+D4j
		cmp	[ebp+Block], 0
		jnz	loc_401A38

loc_401E75:				; CODE XREF: sub_40195F+4E3j
					; sub_40195F+4ECj
		mov	eax, [ebp+ptr]
		mov	[esp+68h+res], 0
		mov	[esp+68h+ld], eax
		call	ber_free
		mov	eax, [ebp+entry]
		mov	[esp+68h+res], eax ; char
		mov	eax, [ebp+ExternalHandle]
		mov	[esp+68h+ld], eax ; ld
		mov	eax, ds:ldap_next_entry
		call	eax ; ldap_next_entry
		mov	[ebp+entry], eax

loc_401E9F:				; CODE XREF: sub_40195F+25j
		cmp	[ebp+entry], 0
		jnz	loc_401989
		mov	eax, ds:dword_40D024
		cmp	eax, 1
		jle	short loc_401EC5
		cmp	[ebp+var_10], 0
		jz	short loc_401EC5
		mov	[esp+68h+ld], offset aResultHasBeenP ; "result has been	printed\n"
		call	sub_405D3B

loc_401EC5:				; CODE XREF: sub_40195F+552j
					; sub_40195F+558j
		cmp	[ebp+var_10], 0
		jz	short loc_401ED2
		mov	eax, 0
		jmp	short loc_401ED7
; ---------------------------------------------------------------------------

loc_401ED2:				; CODE XREF: sub_40195F+56Aj
		mov	eax, 0FFFFFFFFh

loc_401ED7:				; CODE XREF: sub_40195F+B1j
					; sub_40195F+33Ej ...
		add	esp, 64h
		pop	edi
		pop	ebp
		retn
sub_40195F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401EDD	proc near		; CODE XREF: sub_4023BA+73p

HostName	= dword	ptr -58h
PortNumber	= dword	ptr -54h
passwd		= dword	ptr -50h
filter		= dword	ptr -4Ch
attrs		= dword	ptr -48h
attrsonly	= dword	ptr -44h
timeout		= dword	ptr -40h
res		= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
ld		= dword	ptr -28h
Str		= dword	ptr -24h
var_20		= dword	ptr -20h
base		= dword	ptr -1Ch
var_18		= dword	ptr -18h
err		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 50h
		mov	[ebp+err], 0
		mov	eax, ds:Str
		test	eax, eax
		jz	short loc_401EFC
		mov	eax, ds:Str
		jmp	short loc_401F02
; ---------------------------------------------------------------------------

loc_401EFC:				; CODE XREF: sub_401EDD+16j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+8]

loc_401F02:				; CODE XREF: sub_401EDD+1Dj
		mov	[ebp+var_18], eax
		mov	eax, ds:dword_40D048
		test	eax, eax
		jz	short loc_401F15
		mov	eax, ds:dword_40D048
		jmp	short loc_401F1B
; ---------------------------------------------------------------------------

loc_401F15:				; CODE XREF: sub_401EDD+2Fj
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+0Ch]

loc_401F1B:				; CODE XREF: sub_401EDD+36j
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_40D04C
		test	eax, eax
		jz	short loc_401F2E
		mov	eax, ds:dword_40D04C
		jmp	short loc_401F34
; ---------------------------------------------------------------------------

loc_401F2E:				; CODE XREF: sub_401EDD+48j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+10h]

loc_401F34:				; CODE XREF: sub_401EDD+4Fj
		mov	[ebp+base], eax
		mov	eax, ds:dword_40D050
		test	eax, eax
		jz	short loc_401F47
		mov	eax, ds:dword_40D050
		jmp	short loc_401F4D
; ---------------------------------------------------------------------------

loc_401F47:				; CODE XREF: sub_401EDD+61j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+1Ch]

loc_401F4D:				; CODE XREF: sub_401EDD+68j
		mov	[ebp+var_20], eax
		mov	eax, ds:dword_40D054
		test	eax, eax
		jz	short loc_401F60
		mov	eax, ds:dword_40D054
		jmp	short loc_401F79
; ---------------------------------------------------------------------------

loc_401F60:				; CODE XREF: sub_401EDD+7Aj
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_401F74
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		mov	eax, [eax]
		jmp	short loc_401F79
; ---------------------------------------------------------------------------

loc_401F74:				; CODE XREF: sub_401EDD+8Bj
		mov	eax, 0

loc_401F79:				; CODE XREF: sub_401EDD+81j
					; sub_401EDD+95j
		mov	[ebp+var_34], eax
		mov	[ebp+var_30], 0
		mov	eax, [ebp+var_34]
		mov	[ebp+Str], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_401FD3
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_401FCB
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, eax
		mov	eax, offset aLdaps ; "ldaps"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_401FCB
		mov	eax, 27Ch
		jmp	short loc_401FD0
; ---------------------------------------------------------------------------

loc_401FCB:				; CODE XREF: sub_401EDD+BAj
					; sub_401EDD+E5j
		mov	eax, 185h

loc_401FD0:				; CODE XREF: sub_401EDD+ECj
		mov	[ebp+var_C], eax

loc_401FD3:				; CODE XREF: sub_401EDD+B0j
		mov	eax, ds:dword_40D024
		test	eax, eax
		jz	loc_402118
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+58h+PortNumber], eax ; char
		mov	[esp+58h+HostName], offset aProcessingUrlS ; "processing url `%s'\n"
		call	sub_405D3B
		mov	eax, ds:dn
		test	eax, eax
		jz	short loc_402011
		mov	eax, ds:dn
		mov	[esp+58h+PortNumber], eax ; char
		mov	[esp+58h+HostName], offset aUserS ; "	       user `%s'\n"
		call	sub_405D3B

loc_402011:				; CODE XREF: sub_401EDD+11Dj
		mov	eax, ds:passwd
		test	eax, eax
		jz	short loc_402042
		mov	eax, ds:passwd
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40202D
		mov	eax, offset asc_40B595 ; "*****"
		jmp	short loc_402032
; ---------------------------------------------------------------------------

loc_40202D:				; CODE XREF: sub_401EDD+147j
		mov	eax, offset byte_40B59B

loc_402032:				; CODE XREF: sub_401EDD+14Ej
		mov	[esp+58h+PortNumber], eax ; char
		mov	[esp+58h+HostName], offset aPassS ; "	       pass `%s'\n"
		call	sub_405D3B

loc_402042:				; CODE XREF: sub_401EDD+13Bj
		cmp	[ebp+var_18], 0
		jz	short loc_40205B
		mov	eax, [ebp+var_18]
		mov	[esp+58h+PortNumber], eax ; char
		mov	[esp+58h+HostName], offset aHostS ; "	       host `%s'\n"
		call	sub_405D3B

loc_40205B:				; CODE XREF: sub_401EDD+169j
		mov	eax, [ebp+var_C]
		mov	[esp+58h+PortNumber], eax ; char
		mov	[esp+58h+HostName], offset aPortD ; "	       port %d\n"
		call	sub_405D3B
		cmp	[ebp+base], 0
		jz	short loc_402087
		mov	eax, [ebp+base]
		mov	[esp+58h+PortNumber], eax ; char
		mov	[esp+58h+HostName], offset aDnS	; "	       DN `%s'\n"
		call	sub_405D3B

loc_402087:				; CODE XREF: sub_401EDD+195j
		cmp	[ebp+var_20], 0
		jz	short loc_4020A0
		mov	eax, [ebp+var_20]
		mov	[esp+58h+PortNumber], eax ; char
		mov	[esp+58h+HostName], offset aFilterS ; "	       filter `%s'\n"
		call	sub_405D3B

loc_4020A0:				; CODE XREF: sub_401EDD+1AEj
		mov	eax, ds:dword_40D034
		test	eax, eax
		jz	short loc_4020FF
		mov	eax, ds:dword_40D054
		test	eax, eax
		jnz	short loc_4020FF
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_4020FF
		mov	[ebp+var_10], 0
		jmp	short loc_4020E9
; ---------------------------------------------------------------------------

loc_4020C5:				; CODE XREF: sub_401EDD+21Ej
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		mov	edx, [ebp+var_10]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+58h+PortNumber], eax ; char
		mov	[esp+58h+HostName], offset aAttrS ; "	       attr `%s'\n"
		call	sub_405D3B
		add	[ebp+var_10], 1

loc_4020E9:				; CODE XREF: sub_401EDD+1E6j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		mov	edx, [ebp+var_10]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4020C5
		jmp	short loc_402118
; ---------------------------------------------------------------------------

loc_4020FF:				; CODE XREF: sub_401EDD+1CAj
					; sub_401EDD+1D3j ...
		cmp	[ebp+Str], 0
		jz	short loc_402118
		mov	eax, [ebp+Str]
		mov	[esp+58h+PortNumber], eax ; char
		mov	[esp+58h+HostName], offset aAttrS ; "	       attr `%s'\n"
		call	sub_405D3B

loc_402118:				; CODE XREF: sub_401EDD+FDj
					; sub_401EDD+220j ...
		cmp	[ebp+var_18], 0
		jz	short loc_402128
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_402145

loc_402128:				; CODE XREF: sub_401EDD+23Fj
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+58h+PortNumber], eax ; char
		mov	[esp+58h+HostName], offset aNoHostNameInS ; "no	host name in `%s'\n"
		call	sub_405D65
		mov	eax, 0FFFFFFFFh
		jmp	loc_4023B3
; ---------------------------------------------------------------------------

loc_402145:				; CODE XREF: sub_401EDD+249j
		mov	eax, ds:dword_40D034
		test	eax, eax
		jnz	short loc_402171
		cmp	[ebp+Str], 0
		jnz	short loc_402171
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+58h+PortNumber], eax ; char
		mov	[esp+58h+HostName], offset aNoAttributeGiv ; "no attribute given for query `%s'\n"
		call	sub_405D65
		mov	eax, 0FFFFFFFFh
		jmp	loc_4023B3
; ---------------------------------------------------------------------------

loc_402171:				; CODE XREF: sub_401EDD+26Fj
					; sub_401EDD+275j
		mov	eax, ds:dword_40D034
		test	eax, eax
		jnz	short loc_4021B4
		mov	eax, ds:dword_40D054
		test	eax, eax
		jnz	short loc_4021B4
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_4021B4
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4021B4
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		add	eax, 4
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4021B4
		mov	[esp+58h+HostName], offset aWarningUsingFi ; "WARNING: using first attribute only\n"
		call	sub_405D3B

loc_4021B4:				; CODE XREF: sub_401EDD+29Bj
					; sub_401EDD+2A4j ...
		call	sub_40195A
		mov	eax, [ebp+var_C]
		mov	[esp+58h+PortNumber], eax ; PortNumber
		mov	eax, [ebp+var_18]
		mov	[esp+58h+HostName], eax	; HostName
		mov	eax, ds:ldap_init
		call	eax ; ldap_init
		mov	[ebp+ld], eax
		cmp	[ebp+ld], 0
		jnz	short loc_40220F
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+58h+HostName], eax	; int
		call	strerror
		mov	[esp+58h+filter], eax
		mov	eax, [ebp+var_C]
		mov	[esp+58h+passwd], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+PortNumber], eax ; char
		mov	[esp+58h+HostName], offset aLdapInitToSDFa ; "LDAP init	to `%s:%d' failed: %s\n"
		call	sub_405D65
		mov	eax, 0FFFFFFFFh
		jmp	loc_4023B3
; ---------------------------------------------------------------------------

loc_40220F:				; CODE XREF: sub_401EDD+2F7j
		mov	edx, ds:passwd
		mov	eax, ds:dn
		mov	[esp+58h+passwd], edx ;	passwd
		mov	[esp+58h+PortNumber], eax ; dn
		mov	eax, [ebp+ld]
		mov	[esp+58h+HostName], eax	; ld
		mov	eax, ds:ldap_simple_bind_s
		call	eax ; ldap_simple_bind_s
		test	eax, eax
		jz	short loc_40226C
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+58h+HostName], eax	; int
		call	strerror
		mov	[esp+58h+filter], eax
		mov	eax, [ebp+var_C]
		mov	[esp+58h+passwd], eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+PortNumber], eax ; char
		mov	[esp+58h+HostName], offset aBindingToSDFai ; "binding to `%s:%d' failed: %s\n"
		call	sub_405D65
		mov	eax, 0FFFFFFFFh
		jmp	loc_4023B3
; ---------------------------------------------------------------------------

loc_40226C:				; CODE XREF: sub_401EDD+354j
		call	sub_40195A
		mov	eax, ds:dword_40D034
		test	eax, eax
		jz	short loc_402295
		mov	eax, ds:dword_40D054
		test	eax, eax
		jnz	short loc_402295
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_402295
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+14h]
		jmp	short loc_402298
; ---------------------------------------------------------------------------

loc_402295:				; CODE XREF: sub_401EDD+39Bj
					; sub_401EDD+3A4j ...
		lea	eax, [ebp+var_34]

loc_402298:				; CODE XREF: sub_401EDD+3B6j
		mov	edx, [ebp+arg_4]
		mov	edx, [edx+18h]
		lea	ecx, [ebp+var_2C]
		mov	[esp+58h+res], ecx ; res
		mov	[esp+58h+timeout], offset timeout ; timeout
		mov	[esp+58h+attrsonly], 0 ; attrsonly
		mov	[esp+58h+attrs], eax ; attrs
		mov	eax, [ebp+var_20]
		mov	[esp+58h+filter], eax ;	filter
		mov	[esp+58h+passwd], edx ;	scope
		mov	eax, [ebp+base]
		mov	[esp+58h+PortNumber], eax ; base
		mov	eax, [ebp+ld]
		mov	[esp+58h+HostName], eax	; ld
		mov	eax, ds:ldap_search_st
		call	eax ; ldap_search_st
		mov	[ebp+err], eax
		cmp	[ebp+err], 4
		jnz	short loc_402340
		mov	eax, ds:dword_40D034
		test	eax, eax
		jz	short loc_402340
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aE	; "E"
		mov	[esp+58h+filter], edx ;	File
		mov	[esp+58h+passwd], 1 ; Count
		mov	[esp+58h+PortNumber], 0Eh ; Size
		mov	[esp+58h+HostName], eax	; Str
		call	fwrite
		cmp	eax, 1
		jz	short loc_402377
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+58h+HostName], eax	; int
		call	strerror
		mov	[esp+58h+PortNumber], eax ; char
		mov	[esp+58h+HostName], offset aErrorWritingTo ; "error writing to stdout: %s\n"
		call	sub_405D65
		mov	eax, 0FFFFFFFFh
		jmp	short loc_4023B3
; ---------------------------------------------------------------------------

loc_402340:				; CODE XREF: sub_401EDD+402j
					; sub_401EDD+40Bj
		cmp	[ebp+err], 0
		jz	short loc_402377
		mov	eax, [ebp+err]
		mov	[esp+58h+HostName], eax	; err
		mov	eax, ds:ldap_err2string
		call	eax ; ldap_err2string
		mov	[esp+58h+passwd], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+58h+PortNumber], eax ; char
		mov	[esp+58h+HostName], offset aSearchingSFail ; "searching	`%s' failed: %s\n"
		call	sub_405D65
		cmp	[ebp+err], 20h
		jz	short loc_402377
		mov	eax, 0FFFFFFFFh
		jmp	short loc_4023B3
; ---------------------------------------------------------------------------

loc_402377:				; CODE XREF: sub_401EDD+439j
					; sub_401EDD+467j ...
		mov	eax, ds:dword_40D034
		test	eax, eax
		jnz	short loc_402385
		mov	eax, [ebp+Str]
		jmp	short loc_40238A
; ---------------------------------------------------------------------------

loc_402385:				; CODE XREF: sub_401EDD+4A1j
		mov	eax, 0

loc_40238A:				; CODE XREF: sub_401EDD+4A6j
		mov	edx, [ebp+var_2C]
		mov	[esp+58h+passwd], eax ;	Str
		mov	[esp+58h+PortNumber], edx ; LDAPMessage	*
		mov	eax, [ebp+ld]
		mov	[esp+58h+HostName], eax	; ExternalHandle
		call	sub_40195F
		mov	[ebp+err], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+HostName], eax	; res
		mov	eax, ds:ldap_msgfree
		call	eax ; ldap_msgfree
		mov	eax, [ebp+err]

loc_4023B3:				; CODE XREF: sub_401EDD+263j
					; sub_401EDD+28Fj ...
		add	esp, 50h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_401EDD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4023BA	proc near		; CODE XREF: sub_4015C4+34Fp

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_402C2B
		test	eax, eax
		jnz	short loc_4023F0
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aSIsNotAnLdapUr ; "`%s' is not an LDAP URL\n"
		call	sub_405D65
		mov	eax, 0FFFFFFFFh
		jmp	short locret_402443
; ---------------------------------------------------------------------------

loc_4023F0:				; CODE XREF: sub_4023BA+1Aj
		lea	eax, [ebp+var_10]
		mov	dword ptr [esp+28h+var_24], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4035E9
		test	eax, eax
		jz	short loc_402420
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aSIsAnInvalidLd ; "`%s' is an invalid LDAP URL\n"
		call	sub_405D65
		mov	eax, 0FFFFFFFFh
		jmp	short locret_402443
; ---------------------------------------------------------------------------

loc_402420:				; CODE XREF: sub_4023BA+4Aj
		mov	eax, [ebp+var_10]
		mov	dword ptr [esp+28h+var_24], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_401EDD
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_4036EE
		mov	eax, [ebp+var_C]

locret_402443:				; CODE XREF: sub_4023BA+34j
					; sub_4023BA+64j
		leave
		retn
sub_4023BA	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_402448	proc near		; CODE XREF: sub_402482+1Ap
					; sub_4024C0+21p ...

var_18		= dword	ptr -18h
var_14		= byte ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+18h+var_18], eax ;	int
		call	strerror
		mov	dword ptr [esp+18h+var_14], eax	; char
		mov	[esp+18h+var_18], offset aErrorAllocatin ; "error allocating enough memory: %s\n"
		call	sub_405DA8
sub_402448	endp

; ---------------------------------------------------------------------------
		db  55h	; U
		db  89h	; 
		db 0E5h	; 
		db  83h	; 
		db 0ECh	; 
		db  18h
		db  8Bh	; 
		db  45h	; E
		db    8
		db  89h	; 
		db    4
		db  24h	; $
		db 0E8h	; 
		db 0F8h	; 
		db  78h	; x
		db    0
		db    0
		db 0C9h	; 
		db 0C3h	; 

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402482(size_t)
sub_402482	proc near		; CODE XREF: .text:00404188p
					; .text:00406104p ...

Size		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4024A1
		call	sub_402448
; ---------------------------------------------------------------------------

loc_4024A1:				; CODE XREF: sub_402482+18j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_402482	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	realloc
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4024C0(void *, size_t)
sub_4024C0	proc near		; CODE XREF: .text:0040413Ep

Memory		= dword	ptr -28h
NewSize		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+NewSize], eax ; NewSize
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Memory], eax ;	Memory
		call	realloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4024E6
		call	sub_402448
; ---------------------------------------------------------------------------

loc_4024E6:				; CODE XREF: sub_4024C0+1Fj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4024C0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	calloc
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	calloc
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40252B
		call	sub_402448
; ---------------------------------------------------------------------------

loc_40252B:				; CODE XREF: .text:00402524j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	_strdup
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402543(char *)
sub_402543	proc near		; CODE XREF: sub_4015C4+292p
					; .text:00403E44p ...

Size		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
Dest		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jnz	short loc_402582
		call	sub_402448
; ---------------------------------------------------------------------------

loc_402582:				; CODE XREF: sub_402543+38j
		mov	eax, [ebp+Dest]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Size],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+Dest]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_402543	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40259D(void *)
sub_40259D	proc near		; CODE XREF: .text:00403DD5p
					; .text:00403F10p ...

Memory		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_4025B4
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

locret_4025B4:				; CODE XREF: sub_40259D+Aj
		leave
		retn
sub_40259D	endp

; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4025F5
		mov	dword ptr [esp], 8
		call	malloc
		mov	edx, eax
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, [ebp+8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_402652
		mov	eax, 0FFFFFFFFh
		jmp	loc_4026A3
; ---------------------------------------------------------------------------

loc_4025F5:				; CODE XREF: .text:004025C6j
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_402602
; ---------------------------------------------------------------------------

loc_4025FE:				; CODE XREF: .text:0040261Cj
		add	dword ptr [ebp-0Ch], 1

loc_402602:				; CODE XREF: .text:004025FCj
		mov	eax, [ebp+8]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40261E
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, [ebp-0Ch]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4025FE

loc_40261E:				; CODE XREF: .text:00402609j
		mov	eax, [ebp-0Ch]
		add	eax, 2
		shl	eax, 2
		mov	edx, eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[esp+4], edx
		mov	[esp], eax
		call	realloc
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40264A
		mov	eax, 0FFFFFFFFh
		jmp	short loc_4026A3
; ---------------------------------------------------------------------------

loc_40264A:				; CODE XREF: .text:00402641j
		mov	eax, [ebp+8]
		mov	edx, [ebp-10h]
		mov	[eax], edx

loc_402652:				; CODE XREF: .text:004025E9j
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, [ebp-0Ch]
		shl	edx, 2
		lea	ebx, [eax+edx]
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	_strdup
		mov	[ebx], eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, [ebp-0Ch]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_402687
		mov	eax, 1
		jmp	short loc_4026A3
; ---------------------------------------------------------------------------

loc_402687:				; CODE XREF: .text:0040267Ej
		mov	eax, [ebp+8]
		mov	eax, [eax]
		add	dword ptr [ebp-0Ch], 1
		mov	edx, [ebp-0Ch]
		shl	edx, 2
		add	eax, edx
		mov	dword ptr [eax], 0
		mov	eax, 0

loc_4026A3:				; CODE XREF: .text:004025F0j
					; .text:00402648j ...
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	dword ptr [ebp-10h], 0
		jmp	short loc_4026BD
; ---------------------------------------------------------------------------

loc_4026B9:				; CODE XREF: .text:004026D7j
		add	dword ptr [ebp-10h], 1

loc_4026BD:				; CODE XREF: .text:004026B7j
		mov	eax, [ebp+8]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4026D9
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, [ebp-10h]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4026B9

loc_4026D9:				; CODE XREF: .text:004026C4j
		mov	dword ptr [ebp-14h], 0
		jmp	short loc_4026E6
; ---------------------------------------------------------------------------

loc_4026E2:				; CODE XREF: .text:004026F3j
		add	dword ptr [ebp-14h], 1

loc_4026E6:				; CODE XREF: .text:004026E0j
		mov	eax, [ebp-14h]
		shl	eax, 2
		add	eax, [ebp+0Ch]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4026E2
		mov	eax, [ebp-14h]
		mov	edx, [ebp-10h]
		add	eax, edx
		add	eax, 1
		shl	eax, 2
		mov	edx, eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[esp+4], edx
		mov	[esp], eax
		call	realloc
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_402729
		mov	eax, 0FFFFFFFFh
		jmp	loc_4027F5
; ---------------------------------------------------------------------------

loc_402729:				; CODE XREF: .text:0040271Dj
		mov	eax, [ebp+8]
		mov	edx, [ebp-18h]
		mov	[eax], edx
		mov	dword ptr [ebp-0Ch], 0
		jmp	loc_4027CC
; ---------------------------------------------------------------------------

loc_40273D:				; CODE XREF: .text:004027D2j
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, [ebp-0Ch]
		mov	ecx, [ebp-10h]
		add	edx, ecx
		shl	edx, 2
		lea	ebx, [eax+edx]
		mov	eax, [ebp-0Ch]
		shl	eax, 2
		add	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[esp], eax
		call	_strdup
		mov	[ebx], eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, [ebp-0Ch]
		mov	ecx, [ebp-10h]
		add	edx, ecx
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4027C8
		sub	dword ptr [ebp-0Ch], 1
		jmp	short loc_4027BB
; ---------------------------------------------------------------------------

loc_402783:				; CODE XREF: .text:004027BFj
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, [ebp-0Ch]
		mov	ecx, [ebp-10h]
		add	edx, ecx
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp], eax
		call	free
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, [ebp-0Ch]
		mov	ecx, [ebp-10h]
		add	edx, ecx
		shl	edx, 2
		add	eax, edx
		mov	dword ptr [eax], 0
		sub	dword ptr [ebp-0Ch], 1

loc_4027BB:				; CODE XREF: .text:00402781j
		cmp	dword ptr [ebp-0Ch], 0
		jns	short loc_402783
		mov	eax, 0FFFFFFFFh
		jmp	short loc_4027F5
; ---------------------------------------------------------------------------

loc_4027C8:				; CODE XREF: .text:0040277Bj
		add	dword ptr [ebp-0Ch], 1

loc_4027CC:				; CODE XREF: .text:00402738j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp-14h]
		jl	loc_40273D
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, [ebp-14h]
		mov	ecx, [ebp-10h]
		add	edx, ecx
		shl	edx, 2
		add	eax, edx
		mov	dword ptr [eax], 0
		mov	eax, 0

loc_4027F5:				; CODE XREF: .text:00402724j
					; .text:004027C6j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_40283F
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_402829
; ---------------------------------------------------------------------------

loc_40280F:				; CODE XREF: .text:00402830j
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_402825
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	[esp], eax
		call	free

loc_402825:				; CODE XREF: .text:00402816j
		add	dword ptr [ebp-0Ch], 4

loc_402829:				; CODE XREF: .text:0040280Dj
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40280F
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	free
		jmp	short locret_402840
; ---------------------------------------------------------------------------

loc_40283F:				; CODE XREF: .text:00402805j
		nop

locret_402840:				; CODE XREF: .text:0040283Dj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_402855
		mov	eax, 0
		jmp	short locret_40289D
; ---------------------------------------------------------------------------

loc_402855:				; CODE XREF: .text:0040284Cj
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_402889
; ---------------------------------------------------------------------------

loc_40285E:				; CODE XREF: .text:00402896j
		mov	eax, [ebp-0Ch]
		shl	eax, 2
		add	eax, [ebp+8]
		mov	eax, [eax]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_402885
		mov	eax, 1
		jmp	short locret_40289D
; ---------------------------------------------------------------------------

loc_402885:				; CODE XREF: .text:0040287Cj
		add	dword ptr [ebp-0Ch], 1

loc_402889:				; CODE XREF: .text:0040285Cj
		mov	eax, [ebp-0Ch]
		shl	eax, 2
		add	eax, [ebp+8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40285E
		mov	eax, 0

locret_40289D:				; CODE XREF: .text:00402853j
					; .text:00402883j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_4028B3
; ---------------------------------------------------------------------------

loc_4028AF:				; CODE XREF: .text:004028C0j
		add	dword ptr [ebp-0Ch], 1

loc_4028B3:				; CODE XREF: .text:004028ADj
		mov	eax, [ebp-0Ch]
		shl	eax, 2
		add	eax, [ebp+8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4028AF
		mov	eax, [ebp-0Ch]
		add	eax, 1
		shl	eax, 2
		mov	[esp], eax
		call	malloc
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_4028E6
		mov	eax, 0
		jmp	loc_402978
; ---------------------------------------------------------------------------

loc_4028E6:				; CODE XREF: .text:004028DAj
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_402957
; ---------------------------------------------------------------------------

loc_4028EF:				; CODE XREF: .text:00402964j
		mov	eax, [ebp-0Ch]
		shl	eax, 2
		mov	ebx, eax
		add	ebx, [ebp-10h]
		mov	eax, [ebp-0Ch]
		shl	eax, 2
		add	eax, [ebp+8]
		mov	eax, [eax]
		mov	[esp], eax
		call	_strdup
		mov	[ebx], eax
		mov	eax, [ebp-0Ch]
		shl	eax, 2
		add	eax, [ebp-10h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_402953
		sub	dword ptr [ebp-0Ch], 1
		jmp	short loc_40293B
; ---------------------------------------------------------------------------

loc_402924:				; CODE XREF: .text:0040293Fj
		mov	eax, [ebp-0Ch]
		shl	eax, 2
		add	eax, [ebp-10h]
		mov	eax, [eax]
		mov	[esp], eax
		call	free
		sub	dword ptr [ebp-0Ch], 1

loc_40293B:				; CODE XREF: .text:00402922j
		cmp	dword ptr [ebp-0Ch], 0
		jns	short loc_402924
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	free
		mov	eax, 0
		jmp	short loc_402978
; ---------------------------------------------------------------------------

loc_402953:				; CODE XREF: .text:0040291Cj
		add	dword ptr [ebp-0Ch], 1

loc_402957:				; CODE XREF: .text:004028EDj
		mov	eax, [ebp-0Ch]
		shl	eax, 2
		add	eax, [ebp+8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4028EF
		mov	eax, [ebp-0Ch]
		shl	eax, 2
		add	eax, [ebp-10h]
		mov	dword ptr [eax], 0
		mov	eax, [ebp-10h]

loc_402978:				; CODE XREF: .text:004028E1j
					; .text:00402951j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40297E(char *, char *Str)
sub_40297E	proc near		; CODE XREF: sub_402E1C+4D3p
					; sub_402E1C+6F8p

Src		= dword	ptr -28h
Val		= dword	ptr -24h
var_18		= dword	ptr -18h
Memory		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Str		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Src], eax ; Src
		call	_strdup
		mov	[ebp+Memory], eax
		cmp	[ebp+Memory], 0
		jnz	short loc_4029A3
		mov	eax, 0
		jmp	loc_402AD8
; ---------------------------------------------------------------------------

loc_4029A3:				; CODE XREF: sub_40297E+19j
		mov	[ebp+var_10], 1
		mov	eax, [ebp+Memory]
		mov	[ebp+var_C], eax
		jmp	short loc_4029D6
; ---------------------------------------------------------------------------

loc_4029B2:				; CODE XREF: sub_40297E+60j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+Str]
		mov	[esp+28h+Src], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_4029D2
		add	[ebp+var_10], 1

loc_4029D2:				; CODE XREF: sub_40297E+4Ej
		add	[ebp+var_C], 1

loc_4029D6:				; CODE XREF: sub_40297E+32j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4029B2
		mov	eax, [ebp+var_10]
		add	eax, 1
		shl	eax, 2
		mov	[esp+28h+Src], eax ; Size
		call	malloc
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_402A0F
		mov	eax, [ebp+Memory]
		mov	[esp+28h+Src], eax ; Memory
		call	free
		mov	eax, 0
		jmp	loc_402AD8
; ---------------------------------------------------------------------------

loc_402A0F:				; CODE XREF: sub_40297E+7Aj
		mov	[ebp+var_10], 0
		mov	eax, [ebp+Str]
		mov	[esp+28h+Val], eax ; Delim
		mov	eax, [ebp+Memory]
		mov	[esp+28h+Src], eax ; Str
		call	strtok
		mov	[ebp+var_C], eax
		jmp	loc_402AB1
; ---------------------------------------------------------------------------

loc_402A30:				; CODE XREF: sub_40297E+137j
		mov	eax, [ebp+var_10]
		shl	eax, 2
		mov	ebx, eax
		add	ebx, [ebp+var_18]
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Src], eax ; Src
		call	_strdup
		mov	[ebx], eax
		mov	eax, [ebp+var_10]
		shl	eax, 2
		add	eax, [ebp+var_18]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_402A97
		sub	[ebp+var_10], 1
		jmp	short loc_402A74
; ---------------------------------------------------------------------------

loc_402A5D:				; CODE XREF: sub_40297E+FAj
		mov	eax, [ebp+var_10]
		shl	eax, 2
		add	eax, [ebp+var_18]
		mov	eax, [eax]
		mov	[esp+28h+Src], eax ; Memory
		call	free
		sub	[ebp+var_10], 1

loc_402A74:				; CODE XREF: sub_40297E+DDj
		cmp	[ebp+var_10], 0
		jns	short loc_402A5D
		mov	eax, [ebp+var_18]
		mov	[esp+28h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+Memory]
		mov	[esp+28h+Src], eax ; Memory
		call	free
		mov	eax, 0
		jmp	short loc_402AD8
; ---------------------------------------------------------------------------

loc_402A97:				; CODE XREF: sub_40297E+D7j
		add	[ebp+var_10], 1
		mov	eax, [ebp+Str]
		mov	[esp+28h+Val], eax ; Delim
		mov	[esp+28h+Src], 0 ; Str
		call	strtok
		mov	[ebp+var_C], eax

loc_402AB1:				; CODE XREF: sub_40297E+ADj
		cmp	[ebp+var_C], 0
		jnz	loc_402A30
		mov	eax, [ebp+var_10]
		shl	eax, 2
		add	eax, [ebp+var_18]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+Memory]
		mov	[esp+28h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+var_18]

loc_402AD8:				; CODE XREF: sub_40297E+20j
					; sub_40297E+8Cj ...
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_40297E	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_402AF2
		mov	dword ptr [ebp+0Ch], offset asc_40B744 ; " "

loc_402AF2:				; CODE XREF: .text:00402AE9j
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp-18h], eax
		mov	dword ptr [ebp-14h], 0
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_402B55
; ---------------------------------------------------------------------------

loc_402B23:				; CODE XREF: .text:00402B5Cj
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp-18h]
		add	edx, eax
		mov	eax, [ebp-14h]
		add	eax, edx
		mov	[ebp-14h], eax
		add	dword ptr [ebp-0Ch], 4

loc_402B55:				; CODE XREF: .text:00402B21j
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_402B23
		cmp	dword ptr [ebp-14h], 0
		jnz	short loc_402B6E
		mov	eax, 0
		jmp	loc_402C25
; ---------------------------------------------------------------------------

loc_402B6E:				; CODE XREF: .text:00402B62j
		mov	eax, [ebp-18h]
		sub	[ebp-14h], eax
		mov	eax, [ebp-14h]
		add	eax, 1
		mov	[esp], eax
		call	malloc
		mov	[ebp-1Ch], eax
		cmp	dword ptr [ebp-1Ch], 0
		jnz	short loc_402B95
		mov	eax, 0
		jmp	loc_402C25
; ---------------------------------------------------------------------------

loc_402B95:				; CODE XREF: .text:00402B89j
		mov	eax, [ebp-1Ch]
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_402C13
; ---------------------------------------------------------------------------

loc_402BA3:				; CODE XREF: .text:00402C1Aj
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jz	short loc_402BCA
		mov	eax, [ebp-18h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	strncpy
		mov	eax, [ebp-18h]
		add	[ebp-10h], eax

loc_402BCA:				; CODE XREF: .text:00402BA9j
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp-14h], eax
		mov	edx, [ebp-14h]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	strncpy
		mov	eax, [ebp-14h]
		add	[ebp-10h], eax
		add	dword ptr [ebp-0Ch], 4

loc_402C13:				; CODE XREF: .text:00402BA1j
		mov	eax, [ebp-0Ch]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_402BA3
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-1Ch]

loc_402C25:				; CODE XREF: .text:00402B69j
					; .text:00402B90j
		add	esp, 44h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402C2B	proc near		; CODE XREF: sub_4023BA+13p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= byte ptr -10h
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_402C3E
		mov	eax, 0
		jmp	short locret_402C67
; ---------------------------------------------------------------------------

loc_402C3E:				; CODE XREF: sub_402C2B+Aj
		lea	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		lea	eax, [ebp+var_C]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_402C69
		test	eax, eax
		jnz	short loc_402C62
		mov	eax, 0
		jmp	short locret_402C67
; ---------------------------------------------------------------------------

loc_402C62:				; CODE XREF: sub_402C2B+2Ej
		mov	eax, 1

locret_402C67:				; CODE XREF: sub_402C2B+11j
					; sub_402C2B+35j
		leave
		retn
sub_402C2B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402C69	proc near		; CODE XREF: sub_402C2B+27p
					; sub_402E1C+41p

Str1		= dword	ptr -28h
Str		= dword	ptr -24h
MaxCount	= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_402C7F
		mov	eax, 0
		jmp	locret_402D6A
; ---------------------------------------------------------------------------

loc_402C7F:				; CODE XREF: sub_402C69+Aj
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ch
		jnz	short loc_402C9E
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 1
		add	[ebp+var_C], 1
		jmp	short loc_402CA7
; ---------------------------------------------------------------------------

loc_402C9E:				; CODE XREF: sub_402C69+24j
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0

loc_402CA7:				; CODE XREF: sub_402C69+33j
		mov	[esp+28h+MaxCount], 4 ;	MaxCount
		mov	[esp+28h+Str], offset aUrl ; "URL:"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str1],	eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_402CCC
		add	[ebp+var_C], 4

loc_402CCC:				; CODE XREF: sub_402C69+5Dj
		mov	[esp+28h+MaxCount], 7 ;	MaxCount
		mov	[esp+28h+Str], offset aLdap ; "ldap://"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str1],	eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_402CFF
		add	[ebp+var_C], 7
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], offset	aLdap_0	; "ldap"
		mov	eax, [ebp+var_C]
		jmp	short locret_402D6A
; ---------------------------------------------------------------------------

loc_402CFF:				; CODE XREF: sub_402C69+82j
		mov	[esp+28h+MaxCount], 8 ;	MaxCount
		mov	[esp+28h+Str], offset aLdaps_0 ; "ldaps://"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str1],	eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_402D32
		add	[ebp+var_C], 8
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], offset	aLdaps_1 ; "ldaps"
		mov	eax, [ebp+var_C]
		jmp	short locret_402D6A
; ---------------------------------------------------------------------------

loc_402D32:				; CODE XREF: sub_402C69+B5j
		mov	[esp+28h+MaxCount], 8 ;	MaxCount
		mov	[esp+28h+Str], offset aLdapi ; "ldapi://"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str1],	eax ; Str1
		mov	eax, ds:_strnicmp
		call	eax ; _strnicmp
		test	eax, eax
		jnz	short loc_402D65
		add	[ebp+var_C], 8
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], offset	aLdapi_0 ; "ldapi"
		mov	eax, [ebp+var_C]
		jmp	short locret_402D6A
; ---------------------------------------------------------------------------

loc_402D65:				; CODE XREF: sub_402C69+E8j
		mov	eax, 0

locret_402D6A:				; CODE XREF: sub_402C69+11j
					; sub_402C69+94j ...
		leave
		retn
sub_402C69	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402D6C(char *)
sub_402D6C	proc near		; CODE XREF: sub_402E1C+572p

Str1		= dword	ptr -18h
Str2		= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+Str2],	offset Str2 ; "one"
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Str1],	eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_402D95
		mov	eax, 1
		jmp	locret_402E1A
; ---------------------------------------------------------------------------

loc_402D95:				; CODE XREF: sub_402D6C+1Dj
		mov	[esp+18h+Str2],	offset aOnetree	; "onetree"
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Str1],	eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_402DB5
		mov	eax, 1
		jmp	short locret_402E1A
; ---------------------------------------------------------------------------

loc_402DB5:				; CODE XREF: sub_402D6C+40j
		mov	[esp+18h+Str2],	offset aBase ; "base"
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Str1],	eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_402DD5
		mov	eax, 0
		jmp	short locret_402E1A
; ---------------------------------------------------------------------------

loc_402DD5:				; CODE XREF: sub_402D6C+60j
		mov	[esp+18h+Str2],	offset aSub ; "sub"
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Str1],	eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_402DF5
		mov	eax, 2
		jmp	short locret_402E1A
; ---------------------------------------------------------------------------

loc_402DF5:				; CODE XREF: sub_402D6C+80j
		mov	[esp+18h+Str2],	offset aSubtree	; "subtree"
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Str1],	eax ; Str1
		mov	eax, ds:_stricmp
		call	eax ; _stricmp
		test	eax, eax
		jnz	short loc_402E15
		mov	eax, 2
		jmp	short locret_402E1A
; ---------------------------------------------------------------------------

loc_402E15:				; CODE XREF: sub_402D6C+A0j
		mov	eax, 0FFFFFFFFh

locret_402E1A:				; CODE XREF: sub_402D6C+24j
					; sub_402D6C+47j ...
		leave
		retn
sub_402D6C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402E1C	proc near		; CODE XREF: sub_4035E9+15p

Src		= dword	ptr -58h
SizeOfElements	= dword	ptr -54h
var_50		= dword	ptr -50h
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
Str		= dword	ptr -24h
var_20		= dword	ptr -20h
Memory		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	[ebp+var_2C], 0
		cmp	[ebp+arg_0], 0
		jz	short loc_402E36
		cmp	[ebp+arg_4], 0
		jnz	short loc_402E40

loc_402E36:				; CODE XREF: sub_402E1C+12j
		mov	eax, 2
		jmp	loc_4035E3
; ---------------------------------------------------------------------------

loc_402E40:				; CODE XREF: sub_402E1C+18j
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		lea	eax, [ebp+var_2C]
		mov	[esp+58h+var_50], eax
		lea	eax, [ebp+var_28]
		mov	[esp+58h+SizeOfElements], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Src], eax
		call	sub_402C69
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_402E75
		mov	eax, 3
		jmp	loc_4035E3
; ---------------------------------------------------------------------------

loc_402E75:				; CODE XREF: sub_402E1C+4Dj
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jnz	short loc_402E98
		mov	[esp+58h+var_50], 21Eh ; int
		mov	[esp+58h+SizeOfElements], offset a____Dirmngr1_1 ; "../../dirmngr-1.1.1/src/ldap-url.c"
		mov	[esp+58h+Src], offset aScheme ;	"scheme"
		call	sub_409C50

loc_402E98:				; CODE XREF: sub_402E1C+5Ej
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Src], eax ; Src
		call	_strdup
		mov	[ebp+Memory], eax
		cmp	[ebp+Memory], 0
		jnz	short loc_402EB6
		mov	eax, 1
		jmp	loc_4035E3
; ---------------------------------------------------------------------------

loc_402EB6:				; CODE XREF: sub_402E1C+8Ej
		mov	eax, [ebp+var_28]
		test	eax, eax
		jz	short loc_402F0A
		mov	eax, [ebp+Memory]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+Memory]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Eh
		jz	short loc_402F04
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Memory
		call	free
		mov	eax, 4
		jmp	loc_4035E3
; ---------------------------------------------------------------------------

loc_402F04:				; CODE XREF: sub_402E1C+D1j
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0

loc_402F0A:				; CODE XREF: sub_402E1C+9Fj
		mov	[esp+58h+SizeOfElements], 28h ;	SizeOfElements
		mov	[esp+58h+Src], 1 ; NumOfElements
		call	calloc
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_402F3C
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Memory
		call	free
		mov	eax, 1
		jmp	loc_4035E3
; ---------------------------------------------------------------------------

loc_402F3C:				; CODE XREF: sub_402E1C+109j
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+18h], 0FFFFFFFFh
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[eax+4], edx
		mov	eax, [ebp+var_20]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_402FD2
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Src], eax ; void *
		call	sub_4036EE
		mov	eax, 1
		jmp	loc_4035E3
; ---------------------------------------------------------------------------

loc_402FD2:				; CODE XREF: sub_402E1C+194j
		mov	[esp+58h+SizeOfElements], 2Fh ;	Val
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Str
		call	strchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_402FF8
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	[ebp+var_C], 1

loc_402FF8:				; CODE XREF: sub_402E1C+1D0j
		mov	eax, [ebp+Memory]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Bh
		jnz	short loc_403060
		mov	[esp+58h+SizeOfElements], 5Dh ;	Val
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Str
		call	strchr
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jnz	short loc_40303E
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Src], eax ; void *
		call	sub_4036EE
		mov	eax, 5
		jmp	loc_4035E3
; ---------------------------------------------------------------------------

loc_40303E:				; CODE XREF: sub_402E1C+200j
		mov	eax, [ebp+Str]
		mov	byte ptr [eax],	0
		add	[ebp+Str], 1
		mov	[esp+58h+SizeOfElements], 3Ah ;	Val
		mov	eax, [ebp+Str]
		mov	[esp+58h+Src], eax ; Str
		call	strchr
		mov	[ebp+var_10], eax
		jmp	short loc_403076
; ---------------------------------------------------------------------------

loc_403060:				; CODE XREF: sub_402E1C+1E4j
		mov	[esp+58h+SizeOfElements], 3Ah ;	Val
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Str
		call	strchr
		mov	[ebp+var_10], eax

loc_403076:				; CODE XREF: sub_402E1C+242j
		cmp	[ebp+var_10], 0
		jz	short loc_4030CC
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Src], eax
		call	sub_403827
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4030BB
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Src], eax ; void *
		call	sub_4036EE
		mov	eax, 5
		jmp	loc_4035E3
; ---------------------------------------------------------------------------

loc_4030BB:				; CODE XREF: sub_402E1C+27Dj
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Src], eax ; Str
		call	atoi
		mov	edx, [ebp+var_20]
		mov	[edx+0Ch], eax

loc_4030CC:				; CODE XREF: sub_402E1C+25Ej
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax
		call	sub_403827
		mov	eax, [ebp+Memory]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Bh
		setz	al
		movzx	eax, al
		add	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[eax+8], edx
		mov	eax, [ebp+var_20]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_403122
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Src], eax ; void *
		call	sub_4036EE
		mov	eax, 1
		jmp	loc_4035E3
; ---------------------------------------------------------------------------

loc_403122:				; CODE XREF: sub_402E1C+2E4j
		cmp	[ebp+var_C], 0
		jnz	loc_4031CC
		cmp	[ebp+var_10], 0
		jz	loc_4031CC
		mov	[esp+58h+SizeOfElements], 3Fh ;	Val
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Src], eax ; Str
		call	strchr
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4031CC
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Fh
		jnz	short loc_4031CC
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40318E
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Src], eax
		call	sub_403827
		mov	eax, [ebp+var_10]
		mov	[esp+58h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[eax+10h], edx
		jmp	short loc_4031A2
; ---------------------------------------------------------------------------

loc_40318E:				; CODE XREF: sub_402E1C+350j
		mov	[esp+58h+Src], offset Src ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[eax+10h], edx

loc_4031A2:				; CODE XREF: sub_402E1C+370j
		mov	eax, [ebp+var_20]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_4031CC
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Src], eax ; void *
		call	sub_4036EE
		mov	eax, 1
		jmp	loc_4035E3
; ---------------------------------------------------------------------------

loc_4031CC:				; CODE XREF: sub_402E1C+30Aj
					; sub_402E1C+314j ...
		cmp	[ebp+var_C], 0
		jnz	short loc_4031EF
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_20]
		mov	[eax], edx
		mov	eax, 0
		jmp	loc_4035E3
; ---------------------------------------------------------------------------

loc_4031EF:				; CODE XREF: sub_402E1C+3B4j
		mov	[esp+58h+SizeOfElements], 3Fh ;	Val
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Src], eax ; Str
		call	strchr
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_403215
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1

loc_403215:				; CODE XREF: sub_402E1C+3EDj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40323F
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Src], eax
		call	sub_403827
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[eax+10h], edx
		jmp	short loc_403253
; ---------------------------------------------------------------------------

loc_40323F:				; CODE XREF: sub_402E1C+401j
		mov	[esp+58h+Src], offset Src ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[eax+10h], edx

loc_403253:				; CODE XREF: sub_402E1C+421j
		mov	eax, [ebp+var_20]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_40327D
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Src], eax ; void *
		call	sub_4036EE
		mov	eax, 1
		jmp	loc_4035E3
; ---------------------------------------------------------------------------

loc_40327D:				; CODE XREF: sub_402E1C+43Fj
		cmp	[ebp+var_10], 0
		jnz	short loc_4032A0
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_20]
		mov	[eax], edx
		mov	eax, 0
		jmp	loc_4035E3
; ---------------------------------------------------------------------------

loc_4032A0:				; CODE XREF: sub_402E1C+465j
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		mov	[esp+58h+SizeOfElements], 3Fh ;	Val
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Src], eax ; Str
		call	strchr
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4032CC
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1

loc_4032CC:				; CODE XREF: sub_402E1C+4A4j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_403324
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Src], eax
		call	sub_403827
		mov	[esp+58h+SizeOfElements], offset asc_40B7BF ; ","
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Src], eax ; char *
		call	sub_40297E
		mov	edx, [ebp+var_20]
		mov	[edx+14h], eax
		mov	eax, [ebp+var_20]
		mov	eax, [eax+14h]
		test	eax, eax
		jnz	short loc_403324
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Src], eax ; void *
		call	sub_4036EE
		mov	eax, 7
		jmp	loc_4035E3
; ---------------------------------------------------------------------------

loc_403324:				; CODE XREF: sub_402E1C+4B8j
					; sub_402E1C+4E6j
		cmp	[ebp+var_10], 0
		jnz	short loc_403347
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_20]
		mov	[eax], edx
		mov	eax, 0
		jmp	loc_4035E3
; ---------------------------------------------------------------------------

loc_403347:				; CODE XREF: sub_402E1C+50Cj
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		mov	[esp+58h+SizeOfElements], 3Fh ;	Val
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Src], eax ; Str
		call	strchr
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_403373
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1

loc_403373:				; CODE XREF: sub_402E1C+54Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4033C4
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Src], eax
		call	sub_403827
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Src], eax ; char *
		call	sub_402D6C
		mov	edx, [ebp+var_20]
		mov	[edx+18h], eax
		mov	eax, [ebp+var_20]
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_4033C4
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Src], eax ; void *
		call	sub_4036EE
		mov	eax, 8
		jmp	loc_4035E3
; ---------------------------------------------------------------------------

loc_4033C4:				; CODE XREF: sub_402E1C+55Fj
					; sub_402E1C+586j
		cmp	[ebp+var_10], 0
		jnz	short loc_4033E7
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_20]
		mov	[eax], edx
		mov	eax, 0
		jmp	loc_4035E3
; ---------------------------------------------------------------------------

loc_4033E7:				; CODE XREF: sub_402E1C+5ACj
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		mov	[esp+58h+SizeOfElements], 3Fh ;	Val
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Src], eax ; Str
		call	strchr
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_403413
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		add	[ebp+var_10], 1

loc_403413:				; CODE XREF: sub_402E1C+5EBj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_4034A1
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Src], eax
		call	sub_403827
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_403456
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Src], eax ; void *
		call	sub_4036EE
		mov	eax, 9
		jmp	loc_4035E3
; ---------------------------------------------------------------------------

loc_403456:				; CODE XREF: sub_402E1C+618j
		mov	eax, [ebp+var_20]
		mov	eax, [eax+1Ch]
		mov	[esp+58h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Src], eax ; Src
		call	_strdup
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+var_20]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_4034A1
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Src], eax ; void *
		call	sub_4036EE
		mov	eax, 1
		jmp	loc_4035E3
; ---------------------------------------------------------------------------

loc_4034A1:				; CODE XREF: sub_402E1C+5FFj
					; sub_402E1C+663j
		cmp	[ebp+var_10], 0
		jnz	short loc_4034C4
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_20]
		mov	[eax], edx
		mov	eax, 0
		jmp	loc_4035E3
; ---------------------------------------------------------------------------

loc_4034C4:				; CODE XREF: sub_402E1C+689j
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		mov	[esp+58h+SizeOfElements], 3Fh ;	Val
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Src], eax ; Str
		call	strchr
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_403506
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Src], eax ; void *
		call	sub_4036EE
		mov	eax, 5
		jmp	loc_4035E3
; ---------------------------------------------------------------------------

loc_403506:				; CODE XREF: sub_402E1C+6C8j
		mov	[esp+58h+SizeOfElements], offset asc_40B7BF ; ","
		mov	eax, [ebp+var_C]
		mov	[esp+58h+Src], eax ; char *
		call	sub_40297E
		mov	edx, [ebp+var_20]
		mov	[edx+20h], eax
		mov	eax, [ebp+var_20]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_403549
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Src], eax ; void *
		call	sub_4036EE
		mov	eax, 0Ah
		jmp	loc_4035E3
; ---------------------------------------------------------------------------

loc_403549:				; CODE XREF: sub_402E1C+70Bj
		mov	[ebp+var_14], 0
		jmp	short loc_403594
; ---------------------------------------------------------------------------

loc_403552:				; CODE XREF: sub_402E1C+78Aj
		mov	eax, [ebp+var_20]
		mov	eax, [eax+20h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+58h+Src], eax
		call	sub_403827
		mov	eax, [ebp+var_20]
		mov	eax, [eax+20h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		movzx	eax, byte ptr [eax]
		cmp	al, 21h
		jnz	short loc_403590
		mov	eax, [ebp+var_20]
		mov	eax, [eax+24h]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_20]
		mov	[eax+24h], edx

loc_403590:				; CODE XREF: sub_402E1C+763j
		add	[ebp+var_14], 1

loc_403594:				; CODE XREF: sub_402E1C+734j
		mov	eax, [ebp+var_20]
		mov	eax, [eax+20h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_403552
		cmp	[ebp+var_14], 0
		jnz	short loc_4035CB
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Memory
		call	free
		mov	eax, [ebp+var_20]
		mov	[esp+58h+Src], eax ; void *
		call	sub_4036EE
		mov	eax, 0Ah
		jmp	short loc_4035E3
; ---------------------------------------------------------------------------

loc_4035CB:				; CODE XREF: sub_402E1C+790j
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_20]
		mov	[eax], edx
		mov	eax, [ebp+Memory]
		mov	[esp+58h+Src], eax ; Memory
		call	free
		mov	eax, 0

loc_4035E3:				; CODE XREF: sub_402E1C+1Fj
					; sub_402E1C+54j ...
		add	esp, 54h
		pop	edi
		pop	ebp
		retn
sub_402E1C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4035E9	proc near		; CODE XREF: sub_4023BA+43p

Memory		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Memory], eax
		call	sub_402E1C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_403614
		mov	eax, [ebp+var_C]
		jmp	loc_4036E7
; ---------------------------------------------------------------------------

loc_403614:				; CODE XREF: sub_4035E9+21j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40362D
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	dword ptr [eax+18h], 0

loc_40362D:				; CODE XREF: sub_4035E9+36j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_403664
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	eax, [eax+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_403664
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	eax, [eax+8]
		mov	[esp+28h+Memory], eax ;	Memory
		call	free
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	dword ptr [eax+8], 0

loc_403664:				; CODE XREF: sub_4035E9+4Ej
					; sub_4035E9+5Dj
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jnz	short loc_4036E4
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	eax, [eax+4]
		mov	edx, eax
		mov	eax, offset aLdap_0 ; "ldap"
		mov	ecx, 5
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4036AB
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	dword ptr [eax+0Ch], 185h
		jmp	short loc_4036E4
; ---------------------------------------------------------------------------

loc_4036AB:				; CODE XREF: sub_4035E9+B2j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	eax, [eax+4]
		mov	edx, eax
		mov	eax, offset aLdaps_1 ; "ldaps"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4036E4
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	dword ptr [eax+0Ch], 27Ch

loc_4036E4:				; CODE XREF: sub_4035E9+85j
					; sub_4035E9+C0j ...
		mov	eax, [ebp+var_C]

loc_4036E7:				; CODE XREF: sub_4035E9+26j
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4035E9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4036EE(void *)
sub_4036EE	proc near		; CODE XREF: sub_4023BA+81p
					; sub_402E1C+1A7p ...

Memory		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	loc_4037F1
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_403716
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[esp+28h+Memory], eax ;	Memory
		call	free

loc_403716:				; CODE XREF: sub_4036EE+18j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_40372E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+28h+Memory], eax ;	Memory
		call	free

loc_40372E:				; CODE XREF: sub_4036EE+30j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		test	eax, eax
		jz	short loc_403746
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+28h+Memory], eax ;	Memory
		call	free

loc_403746:				; CODE XREF: sub_4036EE+48j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	short loc_40375E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[esp+28h+Memory], eax ;	Memory
		call	free

loc_40375E:				; CODE XREF: sub_4036EE+60j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		test	eax, eax
		jz	short loc_4037A1
		mov	[ebp+var_C], 0
		jmp	short loc_40378D
; ---------------------------------------------------------------------------

loc_403771:				; CODE XREF: sub_4036EE+B1j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+28h+Memory], eax ;	Memory
		call	free
		add	[ebp+var_C], 1

loc_40378D:				; CODE XREF: sub_4036EE+81j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	edx, [ebp+var_C]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_403771

loc_4037A1:				; CODE XREF: sub_4036EE+78j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	short loc_4037E4
		mov	[ebp+var_10], 0
		jmp	short loc_4037D0
; ---------------------------------------------------------------------------

loc_4037B4:				; CODE XREF: sub_4036EE+F4j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	edx, [ebp+var_10]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+28h+Memory], eax ;	Memory
		call	free
		add	[ebp+var_10], 1

loc_4037D0:				; CODE XREF: sub_4036EE+C4j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		mov	edx, [ebp+var_10]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4037B4

loc_4037E4:				; CODE XREF: sub_4036EE+BBj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Memory], eax ;	Memory
		call	free
		jmp	short locret_4037F2
; ---------------------------------------------------------------------------

loc_4037F1:				; CODE XREF: sub_4036EE+Aj
		nop

locret_4037F2:				; CODE XREF: sub_4036EE+101j
		leave
		retn
sub_4036EE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4037F4	proc near		; CODE XREF: sub_403827+34p
					; sub_403827+65p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 2Fh
		jle	short loc_40380B
		cmp	[ebp+arg_0], 39h
		jg	short loc_40380B
		mov	eax, [ebp+arg_0]
		sub	eax, 30h
		jmp	short loc_403825
; ---------------------------------------------------------------------------

loc_40380B:				; CODE XREF: sub_4037F4+7j
					; sub_4037F4+Dj
		cmp	[ebp+arg_0], 40h
		jle	short loc_40381F
		cmp	[ebp+arg_0], 46h
		jg	short loc_40381F
		mov	eax, [ebp+arg_0]
		sub	eax, 37h
		jmp	short loc_403825
; ---------------------------------------------------------------------------

loc_40381F:				; CODE XREF: sub_4037F4+1Bj
					; sub_4037F4+21j
		mov	eax, [ebp+arg_0]
		sub	eax, 57h

loc_403825:				; CODE XREF: sub_4037F4+15j
					; sub_4037F4+29j
		pop	ebp
		retn
sub_4037F4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403827	proc near		; CODE XREF: sub_402E1C+270p
					; sub_402E1C+2B6p ...

var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		jmp	short loc_4038AE
; ---------------------------------------------------------------------------

loc_403837:				; CODE XREF: sub_403827+8Fj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_40389B
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4038BE
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+1Ch+var_1C], eax
		call	sub_4037F4
		shl	eax, 4
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4038C1
		mov	ebx, [ebp+var_C]
		movzx	eax, byte ptr [ebx]
		mov	esi, eax
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+1Ch+var_1C], eax
		call	sub_4037F4
		add	eax, esi
		mov	[ebx], al
		add	[ebp+var_C], 1
		jmp	short loc_4038AA
; ---------------------------------------------------------------------------

loc_40389B:				; CODE XREF: sub_403827+18j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_4038AA:				; CODE XREF: sub_403827+72j
		add	[ebp+arg_0], 1

loc_4038AE:				; CODE XREF: sub_403827+Ej
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_403837
		jmp	short loc_4038C2
; ---------------------------------------------------------------------------

loc_4038BE:				; CODE XREF: sub_403827+26j
		nop
		jmp	short loc_4038C2
; ---------------------------------------------------------------------------

loc_4038C1:				; CODE XREF: sub_403827+4Fj
		nop

loc_4038C2:				; CODE XREF: sub_403827+95j
					; sub_403827+98j
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		add	esp, 14h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_403827	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4038D0	proc near		; CODE XREF: .text:00403B7Cp
					; sub_40436E+1Cp

Code		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 8000h
		test	eax, eax
		jnz	short loc_403953
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+28h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, eax
		or	dh, 80h
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		test	eax, eax
		jns	short loc_403953
		mov	[esp+28h+Code],	offset aInvalidArgumen ; "Invalid argument for ArgParse\n"
		call	sub_405DD5
; ---------------------------------------------------------------------------

loc_403953:				; CODE XREF: sub_4038D0+13j
					; sub_4038D0+75j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_403B03
		cmp	dword ptr [ebp+arg_4], 0
		jz	loc_403A12
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFAh
		jnz	short loc_40397F
		mov	dword ptr [ebp+var_C], offset aArgumentNotExp ;	"argument not expected\n"
		jmp	short loc_4039EA
; ---------------------------------------------------------------------------

loc_40397F:				; CODE XREF: sub_4038D0+A4j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFBh
		jnz	short loc_403993
		mov	dword ptr [ebp+var_C], offset aReadError ; "read error\n"
		jmp	short loc_4039EA
; ---------------------------------------------------------------------------

loc_403993:				; CODE XREF: sub_4038D0+B8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFCh
		jnz	short loc_4039A7
		mov	dword ptr [ebp+var_C], offset aKeywordTooLong ;	"keyword too long\n"
		jmp	short loc_4039EA
; ---------------------------------------------------------------------------

loc_4039A7:				; CODE XREF: sub_4038D0+CCj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_4039BB
		mov	dword ptr [ebp+var_C], offset aMissingArgumen ;	"missing argument\n"
		jmp	short loc_4039EA
; ---------------------------------------------------------------------------

loc_4039BB:				; CODE XREF: sub_4038D0+E0j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF9h
		jnz	short loc_4039CF
		mov	dword ptr [ebp+var_C], offset aInvalidCommand ;	"invalid command\n"
		jmp	short loc_4039EA
; ---------------------------------------------------------------------------

loc_4039CF:				; CODE XREF: sub_4038D0+F4j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF6h
		jnz	short loc_4039E3
		mov	dword ptr [ebp+var_C], offset aInvalidAliasDe ;	"invalid alias definition\n"
		jmp	short loc_4039EA
; ---------------------------------------------------------------------------

loc_4039E3:				; CODE XREF: sub_4038D0+108j
		mov	dword ptr [ebp+var_C], offset aInvalidOption ; "invalid	option\n"

loc_4039EA:				; CODE XREF: sub_4038D0+ADj
					; sub_4038D0+C1j ...
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	edx, dword ptr [ebp+var_C]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aSUS ; "%s:%u: %s\n"
		call	sub_405D65
		jmp	loc_403AE2
; ---------------------------------------------------------------------------

loc_403A12:				; CODE XREF: sub_4038D0+95j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_403A24
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		jmp	short loc_403A29
; ---------------------------------------------------------------------------

loc_403A24:				; CODE XREF: sub_4038D0+14Aj
		mov	eax, offset a??	; "[??]"

loc_403A29:				; CODE XREF: sub_4038D0+152j
		mov	dword ptr [ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_403A4F
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aMissingArgum_0 ; "Missing argument for option \"%.50s\"\n"
		call	sub_405D65
		jmp	loc_403AE2
; ---------------------------------------------------------------------------

loc_403A4F:				; CODE XREF: sub_4038D0+165j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFAh
		jnz	short loc_403A6F
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aOption_50sDoes ; "Option \"%.50s\" does	not expect an arg"...
		call	sub_405D65
		jmp	short loc_403AE2
; ---------------------------------------------------------------------------

loc_403A6F:				; CODE XREF: sub_4038D0+188j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF9h
		jnz	short loc_403A8F
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aInvalidComma_0 ; "Invalid command \"%.50s\"\n"
		call	sub_405D65
		jmp	short loc_403AE2
; ---------------------------------------------------------------------------

loc_403A8F:				; CODE XREF: sub_4038D0+1A8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF8h
		jnz	short loc_403AAF
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aOption_50sIsAm ; "Option \"%.50s\" is ambiguous\n"
		call	sub_405D65
		jmp	short loc_403AE2
; ---------------------------------------------------------------------------

loc_403AAF:				; CODE XREF: sub_4038D0+1C8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF7h
		jnz	short loc_403ACF
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aCommand_50sIsA ; "Command \"%.50s\" is ambiguous\n"
		call	sub_405D65
		jmp	short loc_403AE2
; ---------------------------------------------------------------------------

loc_403ACF:				; CODE XREF: sub_4038D0+1E8j
		mov	eax, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aInvalidOption_ ; "Invalid option \"%.50s\"\n"
		call	sub_405D65

loc_403AE2:				; CODE XREF: sub_4038D0+13Dj
					; sub_4038D0+17Aj ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, 1
		jz	short loc_403AF9
		mov	[esp+28h+Code],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_403AF9:				; CODE XREF: sub_4038D0+21Bj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0

loc_403B03:				; CODE XREF: sub_4038D0+8Bj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		leave
		retn
sub_4038D0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403B19	proc near		; CODE XREF: .text:00403DFDp
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_403B19	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 0B4h
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-2Ch], 0
		mov	dword ptr [ebp-20h], 0
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_403B68
		mov	eax, [ebp+18h]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_40436E
		jmp	loc_40420D
; ---------------------------------------------------------------------------

loc_403B68:				; CODE XREF: .text:00403B4Fj
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_4038D0
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	short loc_403B91
; ---------------------------------------------------------------------------

loc_403B90:				; CODE XREF: .text:00403F69j
					; .text:00403FA6j ...
		nop

loc_403B91:				; CODE XREF: .text:00403B8Ej
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	getc
		mov	[ebp-30h], eax
		cmp	dword ptr [ebp-30h], 0Ah
		jz	short loc_403BAF
		cmp	dword ptr [ebp-30h], 0FFFFFFFFh
		jnz	loc_403F65

loc_403BAF:				; CODE XREF: .text:00403BA3j
		cmp	dword ptr [ebp-30h], 0FFFFFFFFh
		jz	short loc_403BC2
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+10h]
		mov	[eax], edx

loc_403BC2:				; CODE XREF: .text:00403BB3j
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	loc_404203
		cmp	dword ptr [ebp-0Ch], 2
		jnz	loc_403CEE
		lea	eax, [ebp-94h]
		add	eax, [ebp-10h]
		mov	byte ptr [eax],	0
		mov	dword ptr [ebp-10h], 0
		jmp	short loc_403C21
; ---------------------------------------------------------------------------

loc_403BEB:				; CODE XREF: .text:00403C2Ej
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_403C1D
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+4]
		lea	edx, [ebp-94h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcmp
		test	eax, eax
		jz	short loc_403C32

loc_403C1D:				; CODE XREF: .text:00403BF9j
		add	dword ptr [ebp-10h], 1

loc_403C21:				; CODE XREF: .text:00403BE9j
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_403BEB
		jmp	short loc_403C33
; ---------------------------------------------------------------------------

loc_403C32:				; CODE XREF: .text:00403C1Bj
		nop

loc_403C33:				; CODE XREF: .text:00403C30j
		mov	eax, [ebp-10h]
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	edx, [eax]
		mov	eax, [ebp+14h]
		mov	[eax+10h], edx
		cmp	dword ptr [ebp-2Ch], 0
		jz	short loc_403C60
		mov	eax, [ebp+14h]
		mov	eax, [eax+10h]
		mov	edx, eax
		neg	edx
		mov	eax, [ebp+14h]
		mov	[eax+10h], edx

loc_403C60:				; CODE XREF: .text:00403C4Ej
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_403C9B
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 100h
		test	eax, eax
		jz	short loc_403C8B
		mov	eax, 0FFFFFFF9h
		jmp	short loc_403C90
; ---------------------------------------------------------------------------

loc_403C8B:				; CODE XREF: .text:00403C82j
		mov	eax, 0FFFFFFFEh

loc_403C90:				; CODE XREF: .text:00403C89j
		mov	edx, [ebp+14h]
		mov	[edx+10h], eax
		jmp	loc_404207
; ---------------------------------------------------------------------------

loc_403C9B:				; CODE XREF: .text:00403C6Dj
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_403CBD
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+14h], 0
		jmp	loc_404207
; ---------------------------------------------------------------------------

loc_403CBD:				; CODE XREF: .text:00403CACj
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_403CDF
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+14h], 0
		jmp	loc_404207
; ---------------------------------------------------------------------------

loc_403CDF:				; CODE XREF: .text:00403CCEj
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_404207
; ---------------------------------------------------------------------------

loc_403CEE:				; CODE XREF: .text:00403BD0j
		cmp	dword ptr [ebp-0Ch], 3
		jnz	short loc_403D5C
		cmp	dword ptr [ebp-20h], 0
		jz	short loc_403D09
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_404207
; ---------------------------------------------------------------------------

loc_403D09:				; CODE XREF: .text:00403CF8j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_403D2B
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+14h], 0
		jmp	loc_404207
; ---------------------------------------------------------------------------

loc_403D2B:				; CODE XREF: .text:00403D1Aj
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_403D4D
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+14h], 0
		jmp	loc_404207
; ---------------------------------------------------------------------------

loc_403D4D:				; CODE XREF: .text:00403D3Cj
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_404207
; ---------------------------------------------------------------------------

loc_403D5C:				; CODE XREF: .text:00403CF2j
		cmp	dword ptr [ebp-0Ch], 4
		jnz	loc_403F1F
		cmp	dword ptr [ebp-20h], 0
		jz	loc_403E07
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_403D85
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFAh
		jmp	loc_403F1A
; ---------------------------------------------------------------------------

loc_403D85:				; CODE XREF: .text:00403D74j
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	byte ptr [eax],	0
		mov	dword ptr [esp+4], offset asc_40B938 ; " \t"
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	strpbrk
		mov	[ebp-24h], eax
		cmp	dword ptr [ebp-24h], 0
		jz	short loc_403DBF
		mov	eax, [ebp-24h]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-24h], 1
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	sub_406150

loc_403DBF:				; CODE XREF: .text:00403DA8j
		cmp	dword ptr [ebp-24h], 0
		jz	short loc_403DCF
		mov	eax, [ebp-24h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_403DE9

loc_403DCF:				; CODE XREF: .text:00403DC3j
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_40259D
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFF6h
		jmp	loc_404206
; ---------------------------------------------------------------------------

loc_403DE9:				; CODE XREF: .text:00403DCDj
		mov	eax, [ebp-24h]
		mov	[esp+8], eax
		mov	eax, [ebp-18h]
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_403B19
		jmp	loc_403F1A
; ---------------------------------------------------------------------------

loc_403E07:				; CODE XREF: .text:00403D6Aj
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_403E29
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFAh
		jmp	loc_404206
; ---------------------------------------------------------------------------

loc_403E29:				; CODE XREF: .text:00403E18j
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_403E4E
		lea	eax, [ebp-94h]
		add	eax, [ebp-10h]
		mov	byte ptr [eax],	0
		lea	eax, [ebp-94h]
		mov	[esp], eax
		call	sub_402543
		mov	[ebp-18h], eax
		jmp	short loc_403E57
; ---------------------------------------------------------------------------

loc_403E4E:				; CODE XREF: .text:00403E2Dj
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	byte ptr [eax],	0

loc_403E57:				; CODE XREF: .text:00403E4Cj
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_406150
		mov	eax, [ebp-18h]
		mov	[ebp-28h], eax
		mov	eax, [ebp-28h]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_403EE0
		add	dword ptr [ebp-28h], 1
		mov	eax, [ebp-28h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_403EE0
		mov	eax, [ebp-28h]
		mov	dword ptr [ebp-9Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-9Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp-28h]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_403EE0
		mov	eax, [ebp-28h]
		mov	dword ptr [ebp-9Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-9Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp-28h]
		mov	byte ptr [eax],	0

loc_403EE0:				; CODE XREF: .text:00403E70j
					; .text:00403E7Ej ...
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		mov	edx, [ebp-28h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+14h]
		mov	[esp], eax
		call	sub_404B0C
		test	eax, eax
		jnz	loc_404206
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_40259D
		jmp	loc_404206
; ---------------------------------------------------------------------------

loc_403F1A:				; CODE XREF: .text:00403D80j
					; .text:00403E02j
		jmp	loc_404206
; ---------------------------------------------------------------------------

loc_403F1F:				; CODE XREF: .text:00403D60j
		cmp	dword ptr [ebp-30h], 0FFFFFFFFh
		jnz	short loc_403F52
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	ferror
		test	eax, eax
		jz	short loc_403F43
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFBh
		jmp	loc_404207
; ---------------------------------------------------------------------------

loc_403F43:				; CODE XREF: .text:00403F32j
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0
		jmp	loc_404207
; ---------------------------------------------------------------------------

loc_403F52:				; CODE XREF: .text:00403F23j
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [ebp-10h], 0
		jmp	loc_4041FE
; ---------------------------------------------------------------------------

loc_403F65:				; CODE XREF: .text:00403BA9j
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	loc_403B90
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_403F8A
		mov	eax, [ebp-30h]
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_4041FE

loc_403F8A:				; CODE XREF: .text:00403F73j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_403FA2
		cmp	dword ptr [ebp-30h], 23h
		jnz	short loc_403FA2
		mov	dword ptr [ebp-0Ch], 1
		jmp	loc_4041FE
; ---------------------------------------------------------------------------

loc_403FA2:				; CODE XREF: .text:00403F8Ej
					; .text:00403F94j
		cmp	dword ptr [ebp-0Ch], 1
		jz	loc_403B90
		cmp	dword ptr [ebp-0Ch], 2
		jnz	loc_4040BA
		mov	eax, [ebp-30h]
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	loc_4040BA
		lea	eax, [ebp-94h]
		add	eax, [ebp-10h]
		mov	byte ptr [eax],	0
		mov	dword ptr [ebp-10h], 0
		jmp	short loc_404016
; ---------------------------------------------------------------------------

loc_403FE0:				; CODE XREF: .text:00404023j
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_404012
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+4]
		lea	edx, [ebp-94h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcmp
		test	eax, eax
		jz	short loc_404027

loc_404012:				; CODE XREF: .text:00403FEEj
		add	dword ptr [ebp-10h], 1

loc_404016:				; CODE XREF: .text:00403FDEj
		mov	eax, [ebp-10h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_403FE0
		jmp	short loc_404028
; ---------------------------------------------------------------------------

loc_404027:				; CODE XREF: .text:00404010j
		nop

loc_404028:				; CODE XREF: .text:00404025j
		mov	eax, [ebp-10h]
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	edx, [eax]
		mov	eax, [ebp+14h]
		mov	[eax+10h], edx
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4040AE
		mov	dword ptr [esp+4], offset aAlias ; "alias"
		lea	eax, [ebp-94h]
		mov	[esp], eax
		call	strcmp
		test	eax, eax
		jnz	short loc_40407B
		mov	dword ptr [ebp-20h], 1
		mov	dword ptr [ebp-0Ch], 3
		jmp	loc_4041FE
; ---------------------------------------------------------------------------

loc_40407B:				; CODE XREF: .text:00404066j
		mov	eax, [ebp-14h]
		shl	eax, 4
		add	eax, [ebp+18h]
		mov	eax, [eax+8]
		and	eax, 100h
		test	eax, eax
		jz	short loc_404097
		mov	eax, 0FFFFFFF9h
		jmp	short loc_40409C
; ---------------------------------------------------------------------------

loc_404097:				; CODE XREF: .text:0040408Ej
		mov	eax, 0FFFFFFFEh

loc_40409C:				; CODE XREF: .text:00404095j
		mov	edx, [ebp+14h]
		mov	[edx+10h], eax
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jmp	loc_4041FE
; ---------------------------------------------------------------------------

loc_4040AE:				; CODE XREF: .text:0040404Cj
		mov	dword ptr [ebp-0Ch], 3
		jmp	loc_4041FE
; ---------------------------------------------------------------------------

loc_4040BA:				; CODE XREF: .text:00403FB0j
					; .text:00403FC5j
		cmp	dword ptr [ebp-0Ch], 3
		jnz	short loc_4040FC
		mov	eax, [ebp-30h]
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_403B90
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-30h]
		mov	edx, eax
		lea	eax, [ebp-94h]
		add	eax, [ebp-10h]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		mov	dword ptr [ebp-0Ch], 4
		jmp	loc_403B90
; ---------------------------------------------------------------------------

loc_4040FC:				; CODE XREF: .text:004040BEj
		cmp	dword ptr [ebp-0Ch], 4
		jnz	loc_4041C0
		cmp	dword ptr [ebp-18h], 0
		jz	short loc_40415A
		mov	eax, [ebp-10h]
		mov	edx, [ebp-1Ch]
		sub	edx, 1
		cmp	eax, edx
		jnb	short loc_40412D
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	edx, [ebp-30h]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		jmp	loc_403B90
; ---------------------------------------------------------------------------

loc_40412D:				; CODE XREF: .text:00404117j
		add	dword ptr [ebp-1Ch], 32h
		mov	eax, [ebp-1Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_4024C0
		mov	[ebp-18h], eax
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	edx, [ebp-30h]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		jmp	loc_403B90
; ---------------------------------------------------------------------------

loc_40415A:				; CODE XREF: .text:0040410Aj
		mov	eax, [ebp-10h]
		cmp	eax, 62h
		ja	short loc_40417B
		mov	eax, [ebp-30h]
		mov	edx, eax
		lea	eax, [ebp-94h]
		add	eax, [ebp-10h]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		jmp	loc_403B90
; ---------------------------------------------------------------------------

loc_40417B:				; CODE XREF: .text:00404160j
		mov	dword ptr [ebp-1Ch], 96h
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_402482
		mov	[ebp-18h], eax
		mov	ecx, [ebp-10h]
		lea	edx, [ebp-94h]
		mov	eax, [ebp-18h]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp-10h]
		add	eax, [ebp-18h]
		mov	edx, [ebp-30h]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		jmp	loc_403B90
; ---------------------------------------------------------------------------

loc_4041C0:				; CODE XREF: .text:00404100j
		mov	eax, [ebp-10h]
		cmp	eax, 62h
		jbe	short loc_4041DE
		mov	eax, [ebp+14h]
		mov	dword ptr [eax+10h], 0FFFFFFFCh
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jmp	loc_403B90
; ---------------------------------------------------------------------------

loc_4041DE:				; CODE XREF: .text:004041C6j
		mov	eax, [ebp-30h]
		mov	edx, eax
		lea	eax, [ebp-94h]
		add	eax, [ebp-10h]
		mov	[eax], dl
		add	dword ptr [ebp-10h], 1
		mov	dword ptr [ebp-0Ch], 2
		jmp	loc_403B90
; ---------------------------------------------------------------------------

loc_4041FE:				; CODE XREF: .text:00403F60j
					; .text:00403F84j ...
		jmp	loc_403B90
; ---------------------------------------------------------------------------

loc_404203:				; CODE XREF: .text:00403BC6j
		nop
		jmp	short loc_404207
; ---------------------------------------------------------------------------

loc_404206:				; CODE XREF: .text:00403DE4j
					; .text:00403E24j ...
		nop

loc_404207:				; CODE XREF: .text:00403C96j
					; .text:00403CB8j ...
		mov	eax, [ebp+14h]
		mov	eax, [eax+10h]

loc_40420D:				; CODE XREF: .text:00403B63j
		add	esp, 0B4h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404216(int, int, char	*)
sub_404216	proc near		; CODE XREF: sub_40436E+182p

Str1		= dword	ptr -38h
Str2		= dword	ptr -34h
MaxCount	= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_404231
		mov	eax, 0FFFFFFFFh
		jmp	loc_404368
; ---------------------------------------------------------------------------

loc_404231:				; CODE XREF: sub_404216+Fj
		mov	[ebp+var_C], 0
		jmp	short loc_404275
; ---------------------------------------------------------------------------

loc_40423A:				; CODE XREF: sub_404216+6Cj
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_404271
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_404271
		mov	eax, [ebp+var_C]
		jmp	loc_404368
; ---------------------------------------------------------------------------

loc_404271:				; CODE XREF: sub_404216+32j
					; sub_404216+51j
		add	[ebp+var_C], 1

loc_404275:				; CODE XREF: sub_404216+22j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40423A
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	loc_404350
; ---------------------------------------------------------------------------

loc_4042B2:				; CODE XREF: sub_404216+147j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	loc_40434C
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[esp+38h+MaxCount], edx	; MaxCount
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_40434C
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_404338
; ---------------------------------------------------------------------------

loc_4042F7:				; CODE XREF: sub_404216+12Fj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_404334
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[esp+38h+MaxCount], edx	; MaxCount
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_404334
		mov	eax, 0FFFFFFFEh
		jmp	short loc_404368
; ---------------------------------------------------------------------------

loc_404334:				; CODE XREF: sub_404216+EFj
					; sub_404216+115j
		add	[ebp+var_10], 1

loc_404338:				; CODE XREF: sub_404216+DFj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4042F7
		mov	eax, [ebp+var_C]
		jmp	short loc_404368
; ---------------------------------------------------------------------------

loc_40434C:				; CODE XREF: sub_404216+AAj
					; sub_404216+D4j
		add	[ebp+var_C], 1

loc_404350:				; CODE XREF: sub_404216+97j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_4042B2
		mov	eax, 0FFFFFFFFh

loc_404368:				; CODE XREF: sub_404216+16j
					; sub_404216+56j ...
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_404216	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40436E	proc near		; CODE XREF: sub_4015C4+263p
					; .text:00403B5Ep

Str		= dword	ptr -38h
Val		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+Count], 0
		mov	[esp+38h+Val], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_4038D0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4043D2
		cmp	[ebp+var_10], 0
		jz	short loc_4043D2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 10h
		test	eax, eax
		jnz	short loc_4043D2
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1

loc_4043D2:				; CODE XREF: sub_40436E+43j
					; sub_40436E+49j ...
		cmp	[ebp+var_10], 0
		jnz	short loc_4043E7
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		jmp	loc_404AE6
; ---------------------------------------------------------------------------

loc_4043E7:				; CODE XREF: sub_40436E+68j
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+28h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_40443D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 2
		test	eax, eax
		jz	short loc_40443D
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_404AE6
; ---------------------------------------------------------------------------

loc_40443D:				; CODE XREF: sub_40436E+92j
					; sub_40436E+9Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_404456
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		jmp	loc_404AE6
; ---------------------------------------------------------------------------

loc_404456:				; CODE XREF: sub_40436E+D7j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	loc_4047C1
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	loc_4047C1
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+var_18]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4044B4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jnz	short loc_4044B4
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 1
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_4043D2
; ---------------------------------------------------------------------------

loc_4044B4:				; CODE XREF: sub_40436E+11Cj
					; sub_40436E+129j
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], 3Dh ; Val
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jz	short loc_4044D9
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	0

loc_4044D9:				; CODE XREF: sub_40436E+163j
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Count], eax ; char *
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_404216
		mov	[ebp+var_20], eax
		cmp	[ebp+var_28], 0
		jz	short loc_404504
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	3Dh

loc_404504:				; CODE XREF: sub_40436E+18Ej
		cmp	[ebp+var_20], 0
		jns	short loc_40453E
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset Str1 ; "help"
		call	strcmp
		test	eax, eax
		jnz	short loc_40453E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax
		call	sub_404C7D
; ---------------------------------------------------------------------------
		jmp	loc_404662
; ---------------------------------------------------------------------------

loc_40453E:				; CODE XREF: sub_40436E+19Aj
					; sub_40436E+1B4j
		cmp	[ebp+var_20], 0
		jns	short loc_404580
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aVersion ; "version"
		call	strcmp
		test	eax, eax
		jnz	short loc_404580
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jnz	loc_404662
		call	sub_4051E0
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_404580:				; CODE XREF: sub_40436E+1D4j
					; sub_40436E+1EEj
		cmp	[ebp+var_20], 0
		jns	short loc_4045C0
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aWarranty	; "warranty"
		call	strcmp
		test	eax, eax
		jnz	short loc_4045C0
		mov	[esp+38h+Str], 10h
		call	sub_405438
		mov	[esp+38h+Str], eax ; Str
		call	puts
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_4045C0:				; CODE XREF: sub_40436E+216j
					; sub_40436E+230j
		cmp	[ebp+var_20], 0
		jns	loc_404662
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aDumpOptions ; "dump-options"
		call	strcmp
		test	eax, eax
		jnz	short loc_404662
		mov	[ebp+var_20], 0
		jmp	short loc_40461E
; ---------------------------------------------------------------------------

loc_4045ED:				; CODE XREF: sub_40436E+2BDj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40461A
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, offset Format ; "--%s\n"
		mov	[esp+38h+Val], edx
		mov	[esp+38h+Str], eax ; Format
		call	printf

loc_40461A:				; CODE XREF: sub_40436E+28Dj
		add	[ebp+var_20], 1

loc_40461E:				; CODE XREF: sub_40436E+27Dj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4045ED
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aDumpOptionsHel ; "--dump-options\n--help\n--version\n--wa"...
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 2Bh ; Count
		mov	[esp+38h+Val], 1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_404662:				; CODE XREF: sub_40436E+1CBj
					; sub_40436E+1FBj ...
		cmp	[ebp+var_20], 0FFFFFFFEh
		jnz	short loc_404674
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF8h
		jmp	short loc_4046A3
; ---------------------------------------------------------------------------

loc_404674:				; CODE XREF: sub_40436E+2F8j
		cmp	[ebp+var_20], 0FFFFFFFFh
		jnz	short loc_404692
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFEh
		mov	eax, [ebp+var_18]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_0]
		mov	[eax+18h], edx
		jmp	short loc_4046A3
; ---------------------------------------------------------------------------

loc_404692:				; CODE XREF: sub_40436E+30Aj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx

loc_4046A3:				; CODE XREF: sub_40436E+304j
					; sub_40436E+322j
		cmp	[ebp+var_20], 0
		js	loc_4047B0
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jz	loc_404791
		cmp	[ebp+var_28], 0
		jz	short loc_4046E6
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4046EF
		mov	[ebp+var_1C], 0
		jmp	short loc_4046EF
; ---------------------------------------------------------------------------

loc_4046E6:				; CODE XREF: sub_40436E+35Aj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], eax

loc_4046EF:				; CODE XREF: sub_40436E+36Dj
					; sub_40436E+376j
		cmp	[ebp+var_1C], 0
		jnz	short loc_404717
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_404717
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	loc_4047B0
; ---------------------------------------------------------------------------

loc_404717:				; CODE XREF: sub_40436E+385j
					; sub_40436E+398j
		cmp	[ebp+var_1C], 0
		jnz	short loc_40472C
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_4047AF
; ---------------------------------------------------------------------------

loc_40472C:				; CODE XREF: sub_40436E+3ADj
		cmp	[ebp+var_28], 0
		jnz	short loc_40475B
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_40475B
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_40475B
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_4047B0
; ---------------------------------------------------------------------------

loc_40475B:				; CODE XREF: sub_40436E+3C2j
					; sub_40436E+3CCj ...
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_404B0C
		cmp	[ebp+var_28], 0
		jnz	short loc_4047AF
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_4047AF
; ---------------------------------------------------------------------------

loc_404791:				; CODE XREF: sub_40436E+350j
		cmp	[ebp+var_28], 0
		jz	short loc_4047A3
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0FFFFFFFAh
		jmp	short loc_4047B0
; ---------------------------------------------------------------------------

loc_4047A3:				; CODE XREF: sub_40436E+427j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_4047B0
; ---------------------------------------------------------------------------

loc_4047AF:				; CODE XREF: sub_40436E+3B9j
					; sub_40436E+413j ...
		nop

loc_4047B0:				; CODE XREF: sub_40436E+339j
					; sub_40436E+3A4j ...
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_404AE6
; ---------------------------------------------------------------------------

loc_4047C1:				; CODE XREF: sub_40436E+F0j
					; sub_40436E+101j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_4047D8
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4047E6

loc_4047D8:				; CODE XREF: sub_40436E+45Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	loc_404A9E

loc_4047E6:				; CODE XREF: sub_40436E+468j
		mov	[ebp+var_24], 0
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_404871
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 20h
		test	eax, eax
		jz	short loc_404871
		mov	[ebp+var_20], 0
		jmp	short loc_404862
; ---------------------------------------------------------------------------

loc_404823:				; CODE XREF: sub_40436E+501j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40485E
		mov	eax, [ebp+var_18]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	[esp+38h+Val], edx ; Str2
		mov	[esp+38h+Str], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_40485E
		mov	[ebp+var_24], 1
		jmp	short loc_404871
; ---------------------------------------------------------------------------

loc_40485E:				; CODE XREF: sub_40436E+4C3j
					; sub_40436E+4E5j
		add	[ebp+var_20], 1

loc_404862:				; CODE XREF: sub_40436E+4B3j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_404823

loc_404871:				; CODE XREF: sub_40436E+48Ej
					; sub_40436E+4AAj ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		add	[ebp+var_18], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_4048B7
		mov	[ebp+var_20], 0
		jmp	short loc_4048A5
; ---------------------------------------------------------------------------

loc_404889:				; CODE XREF: sub_40436E+544j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	edx, eax
		jz	short loc_4048B6
		add	[ebp+var_20], 1

loc_4048A5:				; CODE XREF: sub_40436E+519j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_404889
		jmp	short loc_4048B7
; ---------------------------------------------------------------------------

loc_4048B6:				; CODE XREF: sub_40436E+531j
		nop

loc_4048B7:				; CODE XREF: sub_40436E+510j
					; sub_40436E+546j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4048EF
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 68h
		jz	short loc_4048DA
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Fh
		jnz	short loc_4048EF

loc_4048DA:				; CODE XREF: sub_40436E+560j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax
		call	sub_404C7D
; ---------------------------------------------------------------------------

loc_4048EF:				; CODE XREF: sub_40436E+556j
					; sub_40436E+56Aj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_404953
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 100h
		test	eax, eax
		jz	short loc_40492B
		mov	eax, 0FFFFFFF9h
		jmp	short loc_404930
; ---------------------------------------------------------------------------

loc_40492B:				; CODE XREF: sub_40436E+5B4j
		mov	eax, 0FFFFFFFEh

loc_404930:				; CODE XREF: sub_40436E+5BBj
		mov	edx, [ebp+arg_0]
		mov	[edx+10h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		jmp	loc_404A73
; ---------------------------------------------------------------------------

loc_404953:				; CODE XREF: sub_40436E+59Fj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jz	loc_404A5A
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4049AD
		cmp	[ebp+var_24], 0
		jnz	short loc_4049AD
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_404B0C
		jmp	loc_404A51
; ---------------------------------------------------------------------------

loc_4049AD:				; CODE XREF: sub_40436E+607j
					; sub_40436E+60Dj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_4049DB
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_4049DB
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_404A51
; ---------------------------------------------------------------------------

loc_4049DB:				; CODE XREF: sub_40436E+64Cj
					; sub_40436E+65Fj
		cmp	[ebp+var_1C], 0
		jnz	short loc_4049ED
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	short loc_404A51
; ---------------------------------------------------------------------------

loc_4049ED:				; CODE XREF: sub_40436E+671j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_404A23
		mov	eax, [ebp+var_1C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404A23
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_404A23
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_404A51
; ---------------------------------------------------------------------------

loc_404A23:				; CODE XREF: sub_40436E+687j
					; sub_40436E+694j ...
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_404B0C
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1

loc_404A51:				; CODE XREF: sub_40436E+63Aj
					; sub_40436E+66Bj ...
		mov	[ebp+var_18], offset asc_40B998	; "x"
		jmp	short loc_404A73
; ---------------------------------------------------------------------------

loc_404A5A:				; CODE XREF: sub_40436E+5F6j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx

loc_404A73:				; CODE XREF: sub_40436E+5E0j
					; sub_40436E+6EAj
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404A86
		cmp	[ebp+var_24], 0
		jz	short loc_404AE5

loc_404A86:				; CODE XREF: sub_40436E+710j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_404AE5
; ---------------------------------------------------------------------------

loc_404A9E:				; CODE XREF: sub_40436E+472j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 4
		test	eax, eax
		jz	short loc_404AD6
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_404AE6
; ---------------------------------------------------------------------------

loc_404AD6:				; CODE XREF: sub_40436E+73Bj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 1
		jmp	loc_4043D2
; ---------------------------------------------------------------------------

loc_404AE5:				; CODE XREF: sub_40436E+716j
					; sub_40436E+72Ej
		nop

loc_404AE6:				; CODE XREF: sub_40436E+74j
					; sub_40436E+CAj ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		leave
		retn
sub_40436E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404B0C(int, int, char	*)
sub_404B0C	proc near		; CODE XREF: .text:00403EFDp
					; sub_40436E+40Ap ...

Str		= dword	ptr -28h
EndPtr		= dword	ptr -24h
Radix		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_404B23
		mov	eax, 0
		jmp	short loc_404B28
; ---------------------------------------------------------------------------

loc_404B23:				; CODE XREF: sub_404B0C+Ej
		mov	eax, 0Ah

loc_404B28:				; CODE XREF: sub_404B0C+15j
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		and	edx, 7
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jz	short loc_404B75
		cmp	eax, 4
		jz	short loc_404B9C
		cmp	eax, 1
		jnz	short loc_404BC3
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtol
		mov	edx, [ebp+arg_0]
		mov	[edx+18h], eax
		mov	eax, 0
		jmp	short locret_404BD1
; ---------------------------------------------------------------------------

loc_404B75:				; CODE XREF: sub_404B0C+36j
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtol
		mov	edx, [ebp+arg_0]
		mov	[edx+18h], eax
		mov	eax, 0
		jmp	short locret_404BD1
; ---------------------------------------------------------------------------

loc_404B9C:				; CODE XREF: sub_404B0C+3Bj
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtoul
		mov	edx, [ebp+arg_0]
		mov	[edx+18h], eax
		mov	eax, 0
		jmp	short locret_404BD1
; ---------------------------------------------------------------------------

loc_404BC3:				; CODE XREF: sub_404B0C+40j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[eax+18h], edx
		mov	eax, 1

locret_404BD1:				; CODE XREF: sub_404B0C+67j
					; sub_404B0C+8Ej ...
		leave
		retn
sub_404B0C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404BD3	proc near		; CODE XREF: sub_404C7D+8Ep

var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_404C74
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_404C74
		call	sub_40798C
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_404C5F
		add	[ebp+var_C], 1
		jmp	short loc_404C5F
; ---------------------------------------------------------------------------

loc_404C3A:				; CODE XREF: sub_404BD3+9Fj
		cmp	[ebp+var_14], 0
		jz	short loc_404C59
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0C0h
		cmp	eax, 80h
		jz	short loc_404C59
		add	[ebp+var_C], 1

loc_404C59:				; CODE XREF: sub_404BD3+6Bj
					; sub_404BD3+80j
		add	[ebp+var_10], 1
		jmp	short loc_404C60
; ---------------------------------------------------------------------------

loc_404C5F:				; CODE XREF: sub_404BD3+5Fj
					; sub_404BD3+65j
		nop

loc_404C60:				; CODE XREF: sub_404BD3+8Aj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404C74
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_404C3A

loc_404C74:				; CODE XREF: sub_404BD3+34j
					; sub_404BD3+41j ...
		mov	eax, [ebp+var_C]
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
sub_404BD3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_404C7D	proc near		; CODE XREF: sub_40436E+1C6p
					; sub_40436E+57Cp

Str		= dword	ptr -38h
Size		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		call	sub_4051E0
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[esp+38h+Str], 29h
		call	sub_405438
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	puts
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_4050DD
		mov	[ebp+var_18], 0
		mov	eax, [ebp+var_18]
		mov	[ebp+var_10], eax
		jmp	short loc_404D2B
; ---------------------------------------------------------------------------

loc_404CCC:				; CODE XREF: sub_404C7D+BBj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_404D27
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_404CFF
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jz	short loc_404D27

loc_404CFF:				; CODE XREF: sub_404C7D+6Dj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_404BD3
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jle	short loc_404D27
		cmp	[ebp+var_14], 22h
		jg	short loc_404D27
		mov	eax, [ebp+var_14]
		mov	[ebp+var_18], eax

loc_404D27:				; CODE XREF: sub_404C7D+5Dj
					; sub_404C7D+80j ...
		add	[ebp+var_10], 1

loc_404D2B:				; CODE XREF: sub_404C7D+4Dj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_404CCC
		add	[ebp+var_18], 0Ah
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jz	short loc_404D57
		mov	[esp+38h+Str], offset aOptions ; "Options:"
		call	puts

loc_404D57:				; CODE XREF: sub_404C7D+CCj
		mov	[ebp+var_10], 0
		jmp	loc_4050B4
; ---------------------------------------------------------------------------

loc_404D63:				; CODE XREF: sub_404C7D+444j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_404D93
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jnz	short loc_404D93
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_4050AF

loc_404D93:				; CODE XREF: sub_404C7D+F9j
					; sub_404C7D+103j
		cmp	[ebp+var_C], 0
		jz	short loc_404DFE
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jnz	short loc_404DFE
		add	[ebp+var_C], 1
		jmp	short loc_404DE3
; ---------------------------------------------------------------------------

loc_404DA9:				; CODE XREF: sub_404C7D+16Ej
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_404DCE
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404DDF
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	short loc_404DDF
; ---------------------------------------------------------------------------

loc_404DCE:				; CODE XREF: sub_404C7D+134j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar

loc_404DDF:				; CODE XREF: sub_404C7D+141j
					; sub_404C7D+14Fj
		add	[ebp+var_C], 1

loc_404DE3:				; CODE XREF: sub_404C7D+12Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_404DA9
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	loc_4050B0
; ---------------------------------------------------------------------------

loc_404DFE:				; CODE XREF: sub_404C7D+11Aj
					; sub_404C7D+124j
		mov	[ebp+var_14], 3
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 0FFh
		jg	loc_404EB2
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, offset aC	; " -%c"
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Str], eax ; Format
		call	printf
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_404EDB
		cmp	[ebp+var_C], 0
		jz	loc_404EDB
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_404EDB
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1
		jmp	short loc_404E8E
; ---------------------------------------------------------------------------

loc_404E75:				; CODE XREF: sub_404C7D+223j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1

loc_404E8E:				; CODE XREF: sub_404C7D+1F6j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404EA2
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_404E75

loc_404EA2:				; CODE XREF: sub_404C7D+219j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404EDB
		add	[ebp+var_C], 1
		jmp	short loc_404EDB
; ---------------------------------------------------------------------------

loc_404EB2:				; CODE XREF: sub_404C7D+198j
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset asc_40B9A8 ; "   "
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 3 ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite

loc_404EDB:				; CODE XREF: sub_404C7D+1C8j
					; sub_404C7D+1D2j ...
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	loc_404FDE
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 0FFh
		jg	short loc_404F14
		mov	eax, 2Ch
		jmp	short loc_404F19
; ---------------------------------------------------------------------------

loc_404F14:				; CODE XREF: sub_404C7D+28Ej
		mov	eax, 20h

loc_404F19:				; CODE XREF: sub_404C7D+295j
		mov	edx, offset aCS	; "%c --%s"
		mov	[esp+38h+Count], ecx
		mov	[esp+38h+Size],	eax
		mov	[esp+38h+Str], edx ; Format
		call	printf
		add	[ebp+var_14], eax
		cmp	[ebp+var_C], 0
		jz	short loc_404F9F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_404F9F
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_404F7C
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1
		jmp	short loc_404F7C
; ---------------------------------------------------------------------------

loc_404F61:				; CODE XREF: sub_404C7D+312j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1
		jmp	short loc_404F7D
; ---------------------------------------------------------------------------

loc_404F7C:				; CODE XREF: sub_404C7D+2D0j
					; sub_404C7D+2E2j
		nop

loc_404F7D:				; CODE XREF: sub_404C7D+2FDj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404F91
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_404F61

loc_404F91:				; CODE XREF: sub_404C7D+308j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404F9F
		add	[ebp+var_C], 1

loc_404F9F:				; CODE XREF: sub_404C7D+2B8j
					; sub_404C7D+2C2j ...
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset asc_40B9A8 ; "   "
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 3 ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		add	[ebp+var_14], 3
		jmp	short loc_404FDE
; ---------------------------------------------------------------------------

loc_404FCE:				; CODE XREF: sub_404C7D+367j
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_404FDE:				; CODE XREF: sub_404C7D+26Cj
					; sub_404C7D+34Fj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_404FCE
		cmp	[ebp+var_C], 0
		jz	loc_4050A1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_405096
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jle	loc_405096
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[ebp+var_14], 0
		jmp	short loc_40502F
; ---------------------------------------------------------------------------

loc_40501F:				; CODE XREF: sub_404C7D+3B8j
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_40502F:				; CODE XREF: sub_404C7D+3A0j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_40501F
		jmp	short loc_405096
; ---------------------------------------------------------------------------

loc_405039:				; CODE XREF: sub_404C7D+422j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_40507F
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405090
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[ebp+var_14], 0
		jmp	short loc_405075
; ---------------------------------------------------------------------------

loc_405065:				; CODE XREF: sub_404C7D+3FEj
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_405075:				; CODE XREF: sub_404C7D+3E6j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_405065
		jmp	short loc_405090
; ---------------------------------------------------------------------------

loc_40507F:				; CODE XREF: sub_404C7D+3C4j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar

loc_405090:				; CODE XREF: sub_404C7D+3D1j
					; sub_404C7D+400j
		add	[ebp+var_C], 1
		jmp	short loc_405097
; ---------------------------------------------------------------------------

loc_405096:				; CODE XREF: sub_404C7D+37Bj
					; sub_404C7D+387j ...
		nop

loc_405097:				; CODE XREF: sub_404C7D+417j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_405039

loc_4050A1:				; CODE XREF: sub_404C7D+36Dj
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	short loc_4050B0
; ---------------------------------------------------------------------------

loc_4050AF:				; CODE XREF: sub_404C7D+110j
		nop

loc_4050B0:				; CODE XREF: sub_404C7D+17Cj
					; sub_404C7D+430j
		add	[ebp+var_10], 1

loc_4050B4:				; CODE XREF: sub_404C7D+E1j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_404D63
		mov	eax, [ebp+arg_4]
		and	eax, 20h
		test	eax, eax
		jz	short loc_4050DD
		mov	[esp+38h+Str], offset aASingleDashMay ;	"\n(A single dash may be used instead of"...
		call	puts

loc_4050DD:				; CODE XREF: sub_404C7D+3Aj
					; sub_404C7D+452j
		mov	[esp+38h+Str], 13h
		call	sub_405438
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_4051C4
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[esp+38h+Size],	offset SubStr ;	"@EMAIL@"
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	strstr
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_4051AD
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		cmp	edx, eax
		jz	short loc_40515D
		mov	eax, ds:_iob
		lea	ecx, [eax+20h]
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+File],	ecx ; File
		mov	[esp+38h+Count], 1 ; Count
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite

loc_40515D:				; CODE XREF: sub_404C7D+4ADj
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aBugDirmngr@g_0 ; "bug-dirmngr@gnupg.org"
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 15h ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		add	[ebp+var_1C], 7
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4051C4
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Size],	edx ; File
		mov	[esp+38h+Str], eax ; Str
		call	fputs
		jmp	short loc_4051C4
; ---------------------------------------------------------------------------

loc_4051AD:				; CODE XREF: sub_404C7D+49Fj
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+38h+Size],	eax ; File
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	fputs

loc_4051C4:				; CODE XREF: sub_404C7D+473j
					; sub_404C7D+515j ...
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+38h+Str], eax ; File
		call	fflush
		mov	[esp+38h+Str], 0 ; Code
		call	exit
sub_404C7D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4051E0	proc near		; CODE XREF: sub_40436E+201p
					; sub_404C7D+7p

Str		= dword	ptr -28h
File		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, ds:_iob
		lea	ebx, [eax+20h]
		mov	[esp+28h+Str], 0Bh
		call	sub_405438
		mov	[esp+28h+File],	ebx ; File
		mov	[esp+28h+Str], eax ; Str
		call	fputs
		mov	[esp+28h+Str], 0Ch
		call	sub_405438
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_405230
		mov	eax, offset aS_0 ; " (%s)"
		mov	edx, [ebp+var_10]
		mov	[esp+28h+File],	edx
		mov	[esp+28h+Str], eax ; Format
		call	printf

loc_405230:				; CODE XREF: sub_4051E0+3Aj
		mov	[esp+28h+Str], 0Dh
		call	sub_405438
		mov	edx, offset aS_1 ; " %s\n"
		mov	[esp+28h+File],	eax
		mov	[esp+28h+Str], edx ; Format
		call	printf
		mov	[ebp+var_C], 14h
		jmp	short loc_405279
; ---------------------------------------------------------------------------

loc_405256:				; CODE XREF: sub_4051E0+9Dj
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_405438
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_405275
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_405275:				; CODE XREF: sub_4051E0+88j
		add	[ebp+var_C], 1

loc_405279:				; CODE XREF: sub_4051E0+74j
		cmp	[ebp+var_C], 1Dh
		jle	short loc_405256
		mov	[esp+28h+Str], 0Eh
		call	sub_405438
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40529F
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_40529F:				; CODE XREF: sub_4051E0+B2j
		mov	[esp+28h+Str], 0Ah
		call	sub_405438
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4052BF
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_4052BF:				; CODE XREF: sub_4051E0+D2j
		mov	[esp+28h+Str], 0Fh
		call	sub_405438
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4052EB
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_4052EB:				; CODE XREF: sub_4051E0+F2j
		mov	[esp+28h+Str], 12h
		call	sub_405438
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_405317
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_405317:				; CODE XREF: sub_4051E0+11Ej
		mov	[ebp+var_C], 1Eh
		jmp	short loc_40534F
; ---------------------------------------------------------------------------

loc_405320:				; CODE XREF: sub_4051E0+173j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_405438
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40534B
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_40534B:				; CODE XREF: sub_4051E0+152j
		add	[ebp+var_C], 1

loc_40534F:				; CODE XREF: sub_4051E0+13Ej
		cmp	[ebp+var_C], 27h
		jle	short loc_405320
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+Str], eax ; File
		call	fflush
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_4051E0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40536B	proc near		; CODE XREF: sub_4015C4+340p

File		= dword	ptr -28h
Format		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		cmp	[ebp+arg_0], 0
		jnz	short loc_4053D9
		mov	[esp+28h+File],	0Eh
		call	sub_405438
		mov	esi, eax
		mov	[esp+28h+File],	0Dh
		call	sub_405438
		mov	ebx, eax
		mov	[esp+28h+File],	0Bh
		call	sub_405438
		mov	edx, offset aSSS ; "%s %s; %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_18], esi
		mov	[esp+28h+var_1C], ebx
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+28h+File],	eax ; File
		call	fflush
		jmp	short loc_405431
; ---------------------------------------------------------------------------

loc_4053D9:				; CODE XREF: sub_40536B+Cj
		cmp	[ebp+arg_0], 1
		jnz	short loc_40540B
		mov	eax, ds:_iob
		lea	ebx, [eax+40h]
		mov	[esp+28h+File],	28h
		call	sub_405438
		mov	[esp+28h+Format], ebx ;	File
		mov	[esp+28h+File],	eax ; Str
		call	fputs
		mov	[esp+28h+File],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_40540B:				; CODE XREF: sub_40536B+72j
		cmp	[ebp+arg_0], 2
		jnz	short loc_405431
		mov	[esp+28h+File],	29h
		call	sub_405438
		mov	[esp+28h+File],	eax ; Str
		call	puts
		mov	[esp+28h+File],	0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_405431:				; CODE XREF: sub_40536B+6Cj
					; sub_40536B+A4j
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_40536B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405438	proc near		; CODE XREF: sub_40436E+239p
					; sub_404C7D+1Fp ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_40D060
		test	eax, eax
		jz	short loc_405457
		mov	edx, ds:dword_40D060
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx ; dword_40D060
		jmp	short loc_40545C
; ---------------------------------------------------------------------------

loc_405457:				; CODE XREF: sub_405438+Dj
		mov	eax, 0

loc_40545C:				; CODE XREF: sub_405438+1Dj
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40546A
		mov	eax, [ebp+var_C]
		jmp	short locret_4054BF
; ---------------------------------------------------------------------------

loc_40546A:				; CODE XREF: sub_405438+2Bj
		mov	eax, [ebp+arg_0]
		sub	eax, 0Ah	; switch 32 cases
		cmp	eax, 1Fh
		ja	short loc_4054BC ; jumptable 0040547C default case
		mov	eax, ds:off_40BD80[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40547E:				; CODE XREF: sub_405438+44j
					; DATA XREF: .rdata:off_40BD80o
		mov	[ebp+var_C], offset aLicenseGplv3Gn ; jumptable	0040547C case 10
		jmp	short loc_4054BC ; jumptable 0040547C default case
; ---------------------------------------------------------------------------

loc_405487:				; CODE XREF: sub_405438+44j
					; DATA XREF: .rdata:off_40BD80o
		mov	[ebp+var_C], offset aFoo ; jumptable 0040547C case 11
		jmp	short loc_4054BC ; jumptable 0040547C default case
; ---------------------------------------------------------------------------

loc_405490:				; CODE XREF: sub_405438+44j
					; DATA XREF: .rdata:off_40BD80o
		mov	[ebp+var_C], offset a0_0 ; jumptable 0040547C case 13
		jmp	short loc_4054BC ; jumptable 0040547C default case
; ---------------------------------------------------------------------------

loc_405499:				; CODE XREF: sub_405438+44j
					; DATA XREF: .rdata:off_40BD80o
		mov	[ebp+var_C], offset aCopyrightC2010 ; jumptable	0040547C case 14
		jmp	short loc_4054BC ; jumptable 0040547C default case
; ---------------------------------------------------------------------------

loc_4054A2:				; CODE XREF: sub_405438+44j
					; DATA XREF: .rdata:off_40BD80o
		mov	[ebp+var_C], offset aThisIsFreeSoft ; jumptable	0040547C case 15
		jmp	short loc_4054BC ; jumptable 0040547C default case
; ---------------------------------------------------------------------------

loc_4054AB:				; CODE XREF: sub_405438+44j
					; DATA XREF: .rdata:off_40BD80o
		mov	[ebp+var_C], offset aThisIsFreeSo_0 ; jumptable	0040547C case 16
		jmp	short loc_4054BC ; jumptable 0040547C default case
; ---------------------------------------------------------------------------

loc_4054B4:				; CODE XREF: sub_405438+44j
					; DATA XREF: .rdata:off_40BD80o
		mov	[ebp+var_C], offset dword_40BD7C ; jumptable 0040547C cases 40,41
		nop

loc_4054BC:				; CODE XREF: sub_405438+3Bj
					; sub_405438+44j ...
		mov	eax, [ebp+var_C] ; jumptable 0040547C default case

locret_4054BF:				; CODE XREF: sub_405438+30j
		leave
		retn
sub_405438	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4054C1	proc near		; CODE XREF: sub_4015C4+49p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ds:dword_40D060, eax
		pop	ebp
		retn
sub_4054C1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4054D0	proc near		; CODE XREF: sub_4015C4+31Dp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ds:dword_40D10C
		mov	[ebp+var_4], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_4054EE
		mov	ds:dword_40D10C, 0

loc_4054EE:				; CODE XREF: sub_4054D0+12j
		mov	eax, [ebp+var_4]
		leave
		retn
sub_4054D0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_40D10C
		add	eax, 1
		mov	ds:dword_40D10C, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405505(char *Filename, int FileHandle)
sub_405505	proc near		; CODE XREF: sub_4057A2+21p
					; .text:004057DEp

File		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Filename	= dword	ptr  8
FileHandle	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		cmp	[ebp+Filename],	0
		jz	short loc_405555
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset byte_40BE00
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_405555
		mov	[ebp+Filename],	0
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+28h+File],	eax ; File
		call	_fileno
		mov	[ebp+FileHandle], eax

loc_405555:				; CODE XREF: sub_405505+Cj
					; sub_405505+34j
		cmp	[ebp+Filename],	0
		jz	short loc_4055AB
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset aSocket ; "socket://"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_405597
		mov	eax, [ebp+Filename]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405597
		mov	eax, 1
		jmp	short loc_40559C
; ---------------------------------------------------------------------------

loc_405597:				; CODE XREF: sub_405505+7Cj
					; sub_405505+89j
		mov	eax, 0

loc_40559C:				; CODE XREF: sub_405505+90j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4055B2
		add	[ebp+Filename],	9
		jmp	short loc_4055B2
; ---------------------------------------------------------------------------

loc_4055AB:				; CODE XREF: sub_405505+54j
		mov	[ebp+var_10], 0

loc_4055B2:				; CODE XREF: sub_405505+9Ej
					; sub_405505+A4j
		cmp	[ebp+var_10], 0
		jz	short loc_4055EE
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aSystemDoesNotS ; "system does not support logging to a so"...
		mov	[esp+28h+var_1C], edx ;	File
		mov	[esp+28h+Count], 3Bh ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+File],	eax ; Str
		call	fwrite
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_405649
; ---------------------------------------------------------------------------

loc_4055EE:				; CODE XREF: sub_405505+B1j
		cmp	[ebp+Filename],	0
		jz	short loc_40560D
		mov	eax, offset Mode ; "a"
		mov	[esp+28h+Size],	eax ; Mode
		mov	eax, [ebp+Filename]
		mov	[esp+28h+File],	eax ; Filename
		call	fopen
		mov	[ebp+var_C], eax
		jmp	short loc_405649
; ---------------------------------------------------------------------------

loc_40560D:				; CODE XREF: sub_405505+EDj
		cmp	[ebp+FileHandle], 1
		jnz	short loc_405620
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[ebp+var_C], eax
		jmp	short loc_405649
; ---------------------------------------------------------------------------

loc_405620:				; CODE XREF: sub_405505+10Cj
		cmp	[ebp+FileHandle], 2
		jnz	short loc_405633
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_405649
; ---------------------------------------------------------------------------

loc_405633:				; CODE XREF: sub_405505+11Fj
		mov	[esp+28h+Size],	offset Mode ; "a"
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+File],	eax ; FileHandle
		call	_fdopen
		mov	[ebp+var_C], eax

loc_405649:				; CODE XREF: sub_405505+E7j
					; sub_405505+106j ...
		mov	dword_40A100, 0FFFFFFFFh
		cmp	[ebp+var_C], 0
		jz	short loc_40569B
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_40569B
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_405691
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_405691
		mov	eax, ds:File
		mov	[esp+28h+File],	eax ; File
		call	fclose

loc_405691:				; CODE XREF: sub_405505+16Cj
					; sub_405505+17Dj
		mov	ds:File, 0

loc_40569B:				; CODE XREF: sub_405505+152j
					; sub_405505+15Bj
		cmp	[ebp+var_C], 0
		jnz	loc_405726
		cmp	[ebp+Filename],	0
		jz	short loc_4056E3
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToOpenLo ; "failed to open log file `%s': %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+Filename]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		jmp	short loc_405719
; ---------------------------------------------------------------------------

loc_4056E3:				; CODE XREF: sub_405505+1A4j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToFdopen ; "failed to fdopen	file descriptor	%d: %s"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf

loc_405719:				; CODE XREF: sub_405505+1DCj
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_405749
; ---------------------------------------------------------------------------

loc_405726:				; CODE XREF: sub_405505+19Aj
		mov	[esp+28h+var_1C], 0 ; Size
		mov	[esp+28h+Count], 40h ; Mode
		mov	[esp+28h+Size],	0 ; Buf
		mov	eax, [ebp+var_C]
		mov	[esp+28h+File],	eax ; File
		call	setvbuf

loc_405749:				; CODE XREF: sub_405505+21Fj
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_405781
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_405781
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_405781
		mov	eax, ds:File
		mov	[esp+28h+File],	eax ; File
		call	fclose

loc_405781:				; CODE XREF: sub_405505+24Bj
					; sub_405505+25Cj ...
		mov	eax, [ebp+var_C]
		mov	ds:File, eax
		mov	eax, [ebp+var_10]
		mov	ds:dword_40D104, eax
		mov	ds:dword_40D108, 0
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_405505	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4057A2(char *)
sub_4057A2	proc near		; CODE XREF: sub_405964+19p

Filename	= dword	ptr -18h
FileHandle	= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_4057B3
		mov	eax, [ebp+arg_0]
		jmp	short loc_4057B8
; ---------------------------------------------------------------------------

loc_4057B3:				; CODE XREF: sub_4057A2+Aj
		mov	eax, offset byte_40BE00

loc_4057B8:				; CODE XREF: sub_4057A2+Fj
		mov	[esp+18h+FileHandle], 0FFFFFFFFh ; FileHandle
		mov	[esp+18h+Filename], eax	; Filename
		call	sub_405505
		leave
		retn
sub_4057A2	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_405505
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_40D0FC, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4057F2(char *, int)
sub_4057F2	proc near		; CODE XREF: sub_4015C4+5Dp
					; sub_4015C4+244p

Dest		= dword	ptr -18h
Source		= dword	ptr -14h
Count		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_405820
		mov	[esp+18h+Count], 4Fh ; Count
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Source], eax ;	Source
		mov	[esp+18h+Dest],	offset Dest ; Dest
		call	strncpy
		mov	ds:byte_40D0EF,	0

loc_405820:				; CODE XREF: sub_4057F2+Aj
		mov	eax, [ebp+arg_4]
		and	eax, 1
		mov	ds:dword_40D0F4, eax
		mov	eax, [ebp+arg_4]
		and	eax, 2
		mov	ds:dword_40D0F0, eax
		mov	eax, [ebp+arg_4]
		and	eax, 4
		mov	ds:dword_40D0F8, eax
		mov	eax, [ebp+arg_4]
		and	eax, 100h
		mov	ds:dword_40D100, eax
		leave
		retn
sub_4057F2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405850	proc near		; CODE XREF: sub_4015C4+22Dp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 0
		jz	short loc_4058C2
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	eax, ds:dword_40D0F4
		test	eax, eax
		jz	short loc_40587A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_40587A:				; CODE XREF: sub_405850+19j
		mov	eax, ds:dword_40D0F0
		test	eax, eax
		jz	short loc_405892
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 2
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_405892:				; CODE XREF: sub_405850+31j
		mov	eax, ds:dword_40D0F8
		test	eax, eax
		jz	short loc_4058AA
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 4
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_4058AA:				; CODE XREF: sub_405850+49j
		mov	eax, ds:dword_40D100
		test	eax, eax
		jz	short loc_4058C2
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		or	dh, 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edx

loc_4058C2:				; CODE XREF: sub_405850+7j
					; sub_405850+61j
		mov	eax, offset Dest
		pop	ebp
		retn
sub_405850	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_4058FD
		mov	eax, ds:File
		mov	[esp], eax
		call	_fileno
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	short loc_4058FD
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_4058FD
		mov	eax, 1
		jmp	short locret_40591D
; ---------------------------------------------------------------------------

loc_4058FD:				; CODE XREF: .text:004058D6j
					; .text:004058ECj ...
		mov	eax, dword_40A100
		cmp	eax, 0FFFFFFFFh
		jz	short loc_405918
		mov	eax, dword_40A100
		cmp	eax, [ebp+8]
		jnz	short loc_405918
		mov	eax, 1
		jmp	short locret_40591D
; ---------------------------------------------------------------------------

loc_405918:				; CODE XREF: .text:00405905j
					; .text:0040590Fj
		mov	eax, 0

locret_40591D:				; CODE XREF: .text:004058FBj
					; .text:00405916j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_405938
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_40593D
; ---------------------------------------------------------------------------

loc_405938:				; CODE XREF: .text:0040592Cj
		mov	eax, ds:File

loc_40593D:				; CODE XREF: .text:00405936j
		mov	[esp], eax
		call	_fileno
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_40595D
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_405962
; ---------------------------------------------------------------------------

loc_40595D:				; CODE XREF: .text:00405951j
		mov	eax, ds:File

loc_405962:				; CODE XREF: .text:0040595Bj
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405964(int, char *Format, va_list ArgList)
sub_405964	proc near		; CODE XREF: sub_405CF1+22p
					; .text:00405D34p ...

var_58		= dword	ptr -58h
File		= dword	ptr -54h
Count		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
Format		= dword	ptr  0Ch
ArgList		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_4059A7
		mov	[esp+58h+var_58], 0 ; char *
		call	sub_4057A2
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_4059A7
		mov	[esp+58h+Count], 1BEh ;	int
		mov	[esp+58h+File],	offset a____Dirmngr1_0 ; "../../dirmngr-1.1.1/jnlib/logging.c"
		mov	[esp+58h+var_58], offset aLogstream ; "logstream"
		call	sub_409C50

loc_4059A7:				; CODE XREF: sub_405964+10j
					; sub_405964+25j
		mov	eax, ds:dword_40D108
		test	eax, eax
		jz	short loc_4059CB
		cmp	[ebp+arg_0], 1
		jz	short loc_4059CB
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_4059CB:				; CODE XREF: sub_405964+4Aj
					; sub_405964+50j
		mov	ds:dword_40D108, 0
		cmp	[ebp+arg_0], 1
		jz	loc_405B6E
		mov	eax, ds:dword_40D0F0
		test	eax, eax
		jz	loc_405A7B
		mov	eax, ds:dword_40D104
		test	eax, eax
		jnz	loc_405A7B
		mov	[esp+58h+var_58], 0
		call	sub_409D20
		mov	[ebp+var_24], eax
		lea	eax, [ebp+var_24]
		mov	[esp+58h+var_58], eax
		call	sub_409D30
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	edx, [eax]
		mov	eax, [ebp+var_1C]
		mov	edi, [eax+4]
		mov	eax, [ebp+var_1C]
		mov	esi, [eax+8]
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax+0Ch]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+10h]
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+14h]
		add	eax, 76Ch
		mov	[ebp+var_30], eax
		mov	ecx, offset a04d02d02d02d02 ; "%04d-%02d-%02d %02d:%02d:%02d "
		mov	eax, ds:File
		mov	[esp+58h+var_3C], edx
		mov	[esp+58h+var_40], edi
		mov	[esp+58h+var_44], esi
		mov	[esp+58h+var_48], ebx
		mov	edx, [ebp+var_2C]
		mov	[esp+58h+var_4C], edx
		mov	edi, [ebp+var_30]
		mov	[esp+58h+Count], edi
		mov	[esp+58h+File],	ecx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_405A7B:				; CODE XREF: sub_405964+82j
					; sub_405964+8Fj
		mov	eax, ds:dword_40D0F4
		test	eax, eax
		jnz	short loc_405A8D
		mov	eax, ds:dword_40D104
		test	eax, eax
		jz	short loc_405AA4

loc_405A8D:				; CODE XREF: sub_405964+11Ej
		mov	edx, ds:File
		mov	eax, offset Dest
		mov	[esp+58h+File],	edx ; File
		mov	[esp+58h+var_58], eax ;	Str
		call	fputs

loc_405AA4:				; CODE XREF: sub_405964+127j
		mov	eax, ds:dword_40D0F8
		test	eax, eax
		jnz	short loc_405AB6
		mov	eax, ds:dword_40D104
		test	eax, eax
		jz	short loc_405B1C

loc_405AB6:				; CODE XREF: sub_405964+147j
		call	_getpid
		mov	[ebp+var_20], eax
		mov	eax, ds:dword_40D0FC
		test	eax, eax
		jz	short loc_405AFF
		mov	edx, ds:dword_40D0FC
		lea	eax, [ebp+var_28]
		mov	[esp+58h+var_58], eax
		call	edx ; dword_40D0FC
		test	eax, eax
		jz	short loc_405AFF
		mov	ecx, [ebp+var_28]
		mov	edx, offset aU_D ; "[%u.%d]"
		mov	eax, ds:File
		mov	[esp+58h+var_4C], ecx
		mov	ecx, [ebp+var_20]
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_405B1C
; ---------------------------------------------------------------------------

loc_405AFF:				; CODE XREF: sub_405964+161j
					; sub_405964+173j
		mov	edx, offset aU	; "[%u]"
		mov	eax, ds:File
		mov	ecx, [ebp+var_20]
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_405B1C:				; CODE XREF: sub_405964+150j
					; sub_405964+199j
		mov	eax, ds:dword_40D0F0
		test	eax, eax
		jz	short loc_405B2E
		mov	eax, ds:dword_40D104
		test	eax, eax
		jz	short loc_405B43

loc_405B2E:				; CODE XREF: sub_405964+1BFj
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 3Ah ;	Ch
		call	putc

loc_405B43:				; CODE XREF: sub_405964+1C8j
		cmp	[ebp+Format], 0
		jz	short loc_405B59
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_405B59
		add	[ebp+Format], 1
		jmp	short loc_405B6E
; ---------------------------------------------------------------------------

loc_405B59:				; CODE XREF: sub_405964+1E3j
					; sub_405964+1EDj
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 20h ;	Ch
		call	putc

loc_405B6E:				; CODE XREF: sub_405964+75j
					; sub_405964+1F3j
		cmp	[ebp+arg_0], 7	; switch 8 cases
		ja	loc_405C02	; jumptable 00405B85 default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_40BF30
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_405B87:				; CODE XREF: sub_405964+221j
					; DATA XREF: .rdata:off_40BF30o
		mov	edx, ds:File	; jumptable 00405B85 case 5
		mov	eax, offset aFatal ; "Fatal: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 7 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_405C22
; ---------------------------------------------------------------------------

loc_405BB0:				; CODE XREF: sub_405964+221j
					; DATA XREF: .rdata:off_40BF30o
		mov	edx, ds:File	; jumptable 00405B85 case 6
		mov	eax, offset aOhhhhJeeee	; "Ohhhh jeeee:	"
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 0Dh ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_405C22
; ---------------------------------------------------------------------------

loc_405BD9:				; CODE XREF: sub_405964+221j
					; DATA XREF: .rdata:off_40BF30o
		mov	edx, ds:File	; jumptable 00405B85 case 7
		mov	eax, offset aDbg ; "DBG: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 5 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_405C22
; ---------------------------------------------------------------------------

loc_405C02:				; CODE XREF: sub_405964+20Ej
		mov	edx, offset aUnknownLogLeve ; jumptable	00405B85 default case
		mov	eax, ds:File
		mov	ecx, [ebp+arg_0]
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_405C22
; ---------------------------------------------------------------------------

loc_405C21:				; CODE XREF: sub_405964+221j
					; DATA XREF: .rdata:off_40BF30o
		nop			; jumptable 00405B85 cases 0-4

loc_405C22:				; CODE XREF: sub_405964+24Aj
					; sub_405964+273j ...
		cmp	[ebp+Format], 0
		jz	short loc_405C83
		mov	eax, ds:File
		mov	edx, [ebp+ArgList]
		mov	[esp+58h+Count], edx ; ArgList
		mov	edx, [ebp+Format]
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	vfprintf
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405C83
		mov	eax, [ebp+Format]
		mov	[ebp+var_34], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_34]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_405C83
		mov	ds:dword_40D108, 1

loc_405C83:				; CODE XREF: sub_405964+2C2j
					; sub_405964+2E7j ...
		cmp	[ebp+arg_0], 5
		jnz	short loc_405CB3
		mov	eax, ds:dword_40D108
		test	eax, eax
		jz	short loc_405CA7
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_405CA7:				; CODE XREF: sub_405964+32Cj
		mov	[esp+58h+var_58], 2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_405CB3:				; CODE XREF: sub_405964+323j
		cmp	[ebp+arg_0], 6
		jnz	short loc_405CDC
		mov	eax, ds:dword_40D108
		test	eax, eax
		jz	short loc_405CD7
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_405CD7:				; CODE XREF: sub_405964+35Cj
		call	abort
; ---------------------------------------------------------------------------

loc_405CDC:				; CODE XREF: sub_405964+353j
		mov	eax, ds:File
		mov	[esp+58h+var_58], eax ;	File
		call	fflush
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_405964	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405CF1(int, char *, char)
sub_405CF1	proc near		; CODE XREF: sub_405EF4+2Ap

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_405964
		leave
		retn
sub_405CF1	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_405964
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405D3B(char *, char)
sub_405D3B	proc near		; CODE XREF: sub_40195F+4Fp
					; sub_40195F+F1p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 2 ; int
		call	sub_405964
		leave
		retn
sub_405D3B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405D65(char *, char)
sub_405D65	proc near		; CODE XREF: sub_4015C4+311p
					; sub_40195F+A7p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 4 ; int
		call	sub_405964
		mov	eax, ds:dword_40D10C
		cmp	eax, 752Fh
		jg	short locret_405DA6
		mov	eax, ds:dword_40D10C
		add	eax, 1
		mov	ds:dword_40D10C, eax

locret_405DA6:				; CODE XREF: sub_405D65+32j
		leave
		retn
sub_405D65	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl sub_405DA8(char *, char)
sub_405DA8	proc near		; CODE XREF: sub_402448+22p

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 5 ; int
		call	sub_405964
		call	abort
sub_405DA8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl sub_405DD5(char *, char)
sub_405DD5	proc near		; CODE XREF: sub_4038D0+7Ep

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 6 ; int
		call	sub_405964
		call	abort
sub_405DD5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405E02(char *, char)
sub_405E02	proc near		; CODE XREF: .text:00405E80p

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 7 ; int
		call	sub_405964
		leave
		retn
sub_405E02	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405E2C(char *, char)
sub_405E2C	proc near		; CODE XREF: .text:00405EA5p
					; .text:00405EC8p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		cmp	[ebp+arg_0], 0
		setnz	al
		movzx	eax, al
		mov	[esp+28h+ArgList], edx ; ArgList
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+var_28], eax ;	int
		call	sub_405964
		leave
		retn
sub_405E2C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_405E85
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_405E85
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_40BF50
		call	sub_405E02

loc_405E85:				; CODE XREF: .text:00405E66j
					; .text:00405E70j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_405EE0
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a02x ; "%02X"
		call	sub_405E2C
		sub	dword ptr [ebp+10h], 1
		add	dword ptr [ebp-0Ch], 1
		jmp	short loc_405ED1
; ---------------------------------------------------------------------------

loc_405EB4:				; CODE XREF: .text:00405EDEj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a02x_0 ; " %02X"
		call	sub_405E2C
		add	dword ptr [ebp-0Ch], 1

loc_405ED1:				; CODE XREF: .text:00405EB2j
		cmp	dword ptr [ebp+10h], 0
		setnz	al
		sub	dword ptr [ebp+10h], 1
		test	al, al
		jnz	short loc_405EB4

loc_405EE0:				; CODE XREF: .text:00405E89j
		cmp	dword ptr [ebp+8], 0
		jz	short locret_405EF2
		mov	dword ptr [esp], offset	asc_40BF5F ; "\n"
		call	sub_405E2C

locret_405EF2:				; CODE XREF: .text:00405EE4j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_405EF4	proc near		; CODE XREF: sub_407BF2+6CCp

C		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_18], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_1C], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_20], eax	; char
		mov	[esp+28h+var_24], offset a___ThisIsABugS ; "...	this is	a bug (%s:%d:%s)\n"
		mov	[esp+28h+C], 6	; int
		call	sub_405CF1
		call	abort
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, dword ptr [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		jmp	loc_405FF9
; ---------------------------------------------------------------------------

loc_405F4C:				; CODE XREF: sub_405EF4+109j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+0], eax	; C
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+0], eax	; C
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jnz	short loc_405FF1
		mov	eax, [ebp+var_C]
		mov	[ebp+var_18], eax
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_14]
		mov	[ebp+arg_4], eax
		sub	[ebp+var_14], 1
		add	[ebp+var_10], 1
		jmp	short loc_405F9E
; ---------------------------------------------------------------------------

loc_405F92:				; CODE XREF: sub_405EF4+DAj
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1
		sub	[ebp+var_14], 1

loc_405F9E:				; CODE XREF: sub_405EF4+9Cj
		cmp	[ebp+var_14], 0
		jz	short loc_405FD0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+0], eax	; C
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+0], eax	; C
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_405F92

loc_405FD0:				; CODE XREF: sub_405EF4+AEj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_405FDF
		mov	eax, [ebp+var_18]
		jmp	short loc_406008
; ---------------------------------------------------------------------------

loc_405FDF:				; CODE XREF: sub_405EF4+E4j
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax

loc_405FF1:				; CODE XREF: sub_405EF4+82j
		add	[ebp+var_C], 1
		sub	[ebp+var_14], 1

loc_405FF9:				; CODE XREF: sub_405EF4+53j
		cmp	[ebp+var_14], 0
		jnz	loc_405F4C
		mov	eax, 0

loc_406008:				; CODE XREF: sub_405EF4+E9j
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_405EF4	endp ; sp-analysis failed

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_4060D7
; ---------------------------------------------------------------------------

loc_406032:				; CODE XREF: .text:004060DBj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_406D4B
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_406D4B
		cmp	ebx, eax
		jnz	short loc_4060CF
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_406080
; ---------------------------------------------------------------------------

loc_406074:				; CODE XREF: .text:004060ACj
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_406080:				; CODE XREF: .text:00406072j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_4060AE
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_406D4B
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_406D4B
		cmp	ebx, eax
		jz	short loc_406074

loc_4060AE:				; CODE XREF: .text:00406084j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4060BD
		mov	eax, [ebp-18h]
		jmp	short loc_4060E6
; ---------------------------------------------------------------------------

loc_4060BD:				; CODE XREF: .text:004060B6j
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_4060CF:				; CODE XREF: .text:00406058j
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_4060D7:				; CODE XREF: .text:0040602Dj
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_406032
		mov	eax, 0

loc_4060E6:				; CODE XREF: .text:004060BBj
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_40614B
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_40610C
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_402482
		mov	[ebp+8], eax

loc_40610C:				; CODE XREF: .text:004060FCj
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		sub	dword ptr [ebp+10h], 1
		jmp	short loc_406135
; ---------------------------------------------------------------------------

loc_40611E:				; CODE XREF: .text:00406143j
		mov	eax, [ebp-10h]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp+10h], 1

loc_406135:				; CODE XREF: .text:0040611Cj
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_406145
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40611E

loc_406145:				; CODE XREF: .text:00406139j
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0

loc_40614B:				; CODE XREF: .text:004060F6j
		mov	eax, [ebp+8]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406150	proc near		; CODE XREF: .text:00403DBAp
					; .text:00403E5Dp

C		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_406168
; ---------------------------------------------------------------------------

loc_406164:				; CODE XREF: sub_406150+37j
		add	[ebp+var_10], 1

loc_406168:				; CODE XREF: sub_406150+12j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406189
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_406164

loc_406189:				; CODE XREF: sub_406150+20j
		mov	[ebp+var_14], 0
		jmp	short loc_4061C6
; ---------------------------------------------------------------------------

loc_406192:				; CODE XREF: sub_406150+89j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_4061B7
		cmp	[ebp+var_14], 0
		jnz	short loc_4061BE
		mov	eax, [ebp+var_C]
		mov	[ebp+var_14], eax
		jmp	short loc_4061BE
; ---------------------------------------------------------------------------

loc_4061B7:				; CODE XREF: sub_406150+57j
		mov	[ebp+var_14], 0

loc_4061BE:				; CODE XREF: sub_406150+5Dj
					; sub_406150+65j
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_4061C6:				; CODE XREF: sub_406150+40j
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_406192
		cmp	[ebp+var_14], 0
		jz	short loc_4061E7
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0

loc_4061E7:				; CODE XREF: sub_406150+8Fj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_406150	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_406231
; ---------------------------------------------------------------------------

loc_406201:				; CODE XREF: .text:00406239j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_406226
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40622D
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax
		jmp	short loc_40622D
; ---------------------------------------------------------------------------

loc_406226:				; CODE XREF: .text:00406216j
		mov	dword ptr [ebp-10h], 0

loc_40622D:				; CODE XREF: .text:0040621Cj
					; .text:00406224j
		add	dword ptr [ebp-0Ch], 1

loc_406231:				; CODE XREF: .text:004061FFj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_406201
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_406247
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	0

loc_406247:				; CODE XREF: .text:0040623Fj
		mov	eax, [ebp+8]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40624C(int, int, char	*)
sub_40624C	proc near		; CODE XREF: .text:004062E3p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_4062A1
; ---------------------------------------------------------------------------

loc_406268:				; CODE XREF: sub_40624C+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_406292
		cmp	[ebp+var_10], 0
		jnz	short loc_406299
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_406299
; ---------------------------------------------------------------------------

loc_406292:				; CODE XREF: sub_40624C+36j
		mov	[ebp+var_10], 0

loc_406299:				; CODE XREF: sub_40624C+3Cj
					; sub_40624C+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_4062A1:				; CODE XREF: sub_40624C+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_406268
		cmp	[ebp+var_10], 0
		jz	short loc_4062C3
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_4062C6
; ---------------------------------------------------------------------------

loc_4062C3:				; CODE XREF: sub_40624C+61j
		mov	eax, [ebp+arg_4]

locret_4062C6:				; CODE XREF: sub_40624C+75j
		leave
		retn
sub_40624C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_40BF80 ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40624C
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4062EA(int, int, char	*)
sub_4062EA	proc near		; CODE XREF: .text:0040637Bp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_40633F
; ---------------------------------------------------------------------------

loc_406306:				; CODE XREF: sub_4062EA+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_406330
		cmp	[ebp+var_10], 0
		jnz	short loc_406337
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_406337
; ---------------------------------------------------------------------------

loc_406330:				; CODE XREF: sub_4062EA+36j
		mov	[ebp+var_10], 0

loc_406337:				; CODE XREF: sub_4062EA+3Cj
					; sub_4062EA+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_40633F:				; CODE XREF: sub_4062EA+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_406306
		cmp	[ebp+var_10], 0
		jz	short loc_40635B
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_40635E
; ---------------------------------------------------------------------------

loc_40635B:				; CODE XREF: sub_4062EA+61j
		mov	eax, [ebp+arg_4]

locret_40635E:				; CODE XREF: sub_4062EA+6Fj
		leave
		retn
sub_4062EA	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_40BF80 ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4062EA
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4063B1
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_402543
		jmp	short locret_4063BF
; ---------------------------------------------------------------------------

loc_4063B1:				; CODE XREF: .text:004063A2j
		mov	eax, [ebp-0Ch]
		add	eax, 1
		mov	[esp], eax
		call	sub_402543

locret_4063BF:				; CODE XREF: .text:004063AFj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4063F1
		mov	dword ptr [esp], offset	a_ ; "."
		call	sub_402543
		jmp	short locret_406436
; ---------------------------------------------------------------------------

loc_4063F1:				; CODE XREF: .text:004063E1j
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[esp], eax
		call	sub_402482
		mov	[ebp-14h], eax
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	strncpy
		mov	eax, [ebp-10h]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-14h]

locret_406436:				; CODE XREF: .text:004063EFj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-20h]
		mov	[eax], edx
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp-0Ch], eax
		jmp	short loc_406497
; ---------------------------------------------------------------------------

loc_40646F:				; CODE XREF: .text:004064A9j
		mov	eax, [ebp-18h]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp-0Ch]
		add	eax, 1
		mov	[ebp-0Ch], eax

loc_406497:				; CODE XREF: .text:0040646Dj
		mov	eax, [ebp-20h]
		lea	edx, [eax+4]
		mov	[ebp-20h], edx
		mov	eax, [eax]
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_40646F
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Eh
		jnz	short loc_40650A
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_40650A
		mov	dword ptr [esp], offset	aHome ;	"HOME"
		call	getenv
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_40650A
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40650A
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp-0Ch], eax

loc_40650A:				; CODE XREF: .text:004064BAj
					; .text:004064C7j ...
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_402482
		mov	[ebp-1Ch], eax
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_406544
		mov	eax, [ebp+8]
		lea	ebx, [eax+1]
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_407057
		mov	[esp+4], ebx
		mov	[esp], eax
		call	sub_407057
		jmp	short loc_406556
; ---------------------------------------------------------------------------

loc_406544:				; CODE XREF: .text:0040651Cj
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_407057

loc_406556:				; CODE XREF: .text:00406542j
		mov	[ebp-14h], eax
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-20h]
		mov	[eax], edx
		jmp	short loc_406583
; ---------------------------------------------------------------------------

loc_406563:				; CODE XREF: .text:00406595j
		mov	eax, [ebp-14h]
		mov	word ptr [eax],	2Fh
		mov	eax, [ebp-14h]
		lea	edx, [eax+1]
		mov	eax, [ebp-18h]
		mov	[esp+4], eax
		mov	[esp], edx
		call	sub_407057
		mov	[ebp-14h], eax

loc_406583:				; CODE XREF: .text:00406561j
		mov	eax, [ebp-20h]
		lea	edx, [eax+4]
		mov	[ebp-20h], edx
		mov	eax, [eax]
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jnz	short loc_406563
		mov	eax, [ebp-1Ch]
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strcmp
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4065E9
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4065E9
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_406640
; ---------------------------------------------------------------------------

loc_4065E9:				; CODE XREF: .text:004065C9j
					; .text:004065D3j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_406611
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_406611
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_406640
; ---------------------------------------------------------------------------

loc_406611:				; CODE XREF: .text:004065F1j
					; .text:004065FBj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_406639
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_406639
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_406640
; ---------------------------------------------------------------------------

loc_406639:				; CODE XREF: .text:00406619j
					; .text:00406623j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4066BD
; ---------------------------------------------------------------------------

loc_406640:				; CODE XREF: .text:004065E7j
					; .text:0040660Fj ...
		add	dword ptr [ebp+8], 1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_406669
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_406669
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	[ebp-4], eax
		jmp	short loc_4066BA
; ---------------------------------------------------------------------------

loc_406669:				; CODE XREF: .text:0040664Cj
					; .text:00406656j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_40668E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_40668E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		add	[ebp-4], eax
		jmp	short loc_4066BA
; ---------------------------------------------------------------------------

loc_40668E:				; CODE XREF: .text:00406671j
					; .text:0040667Bj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_4066B3
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_4066B3
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		add	[ebp-4], eax
		jmp	short loc_4066BA
; ---------------------------------------------------------------------------

loc_4066B3:				; CODE XREF: .text:00406696j
					; .text:004066A0j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4066BD
; ---------------------------------------------------------------------------

loc_4066BA:				; CODE XREF: .text:00406667j
					; .text:0040668Cj ...
		mov	eax, [ebp-4]

locret_4066BD:				; CODE XREF: .text:0040663Ej
					; .text:004066B8j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4066BF(FILE *, int, int, int,	int)
sub_4066BF	proc near		; CODE XREF: sub_406882+29p
					; .text:004069BFp

var_28		= dword	ptr -28h
File		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_406873
; ---------------------------------------------------------------------------

loc_4066D7:				; CODE XREF: sub_4066BF+1B8j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_40672F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Eh
		jbe	short loc_4066F5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 9Fh
		jbe	short loc_40672F

loc_4066F5:				; CODE XREF: sub_4066BF+2Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_C]
		jz	short loc_40672F
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_10]
		jz	short loc_40672F
		cmp	[ebp+arg_C], 0
		jnz	short loc_406721
		cmp	[ebp+arg_10], 0
		jz	loc_40684B

loc_406721:				; CODE XREF: sub_4066BF+56j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_40684B

loc_40672F:				; CODE XREF: sub_4066BF+20j
					; sub_4066BF+34j ...
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 5Ch ;	Ch
		call	putc
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_40676C
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 6Eh ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_406867
; ---------------------------------------------------------------------------

loc_40676C:				; CODE XREF: sub_4066BF+8Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_406792
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 72h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_406867
; ---------------------------------------------------------------------------

loc_406792:				; CODE XREF: sub_4066BF+B5j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_4067B8
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 66h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_406867
; ---------------------------------------------------------------------------

loc_4067B8:				; CODE XREF: sub_4066BF+DBj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_4067DE
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 76h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_406867
; ---------------------------------------------------------------------------

loc_4067DE:				; CODE XREF: sub_4066BF+101j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_406801
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 62h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_406867
; ---------------------------------------------------------------------------

loc_406801:				; CODE XREF: sub_4066BF+127j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_406824
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 30h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_406867
; ---------------------------------------------------------------------------

loc_406824:				; CODE XREF: sub_4066BF+14Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x ; "x%02x"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+File],	eax ; Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	File
		call	fprintf
		add	[ebp+var_10], 3
		jmp	short loc_406867
; ---------------------------------------------------------------------------

loc_40684B:				; CODE XREF: sub_4066BF+5Cj
					; sub_4066BF+6Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	putc
		add	[ebp+var_10], 1

loc_406867:				; CODE XREF: sub_4066BF+A8j
					; sub_4066BF+CEj ...
		sub	[ebp+arg_8], 1
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_406873:				; CODE XREF: sub_4066BF+13j
		cmp	[ebp+arg_8], 0
		jnz	loc_4066D7
		mov	eax, [ebp+var_10]
		leave
		retn
sub_4066BF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406882(FILE *, int, int, int)
sub_406882	proc near		; CODE XREF: sub_4068B2+B7p
					; .text:00406A15p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_18], 0 ; int
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	FILE *
		call	sub_4066BF
		leave
		retn
sub_406882	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4068B2(FILE *, int, int, int)
sub_4068B2	proc near		; CODE XREF: .text:00406A6Bp

Str		= dword	ptr -38h
File		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_4068DB
; ---------------------------------------------------------------------------

loc_4068C8:				; CODE XREF: sub_4068B2+2Fj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_4068E5
		add	[ebp+var_C], 1

loc_4068DB:				; CODE XREF: sub_4068B2+14j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jb	short loc_4068C8
		jmp	short loc_4068E6
; ---------------------------------------------------------------------------

loc_4068E5:				; CODE XREF: sub_4068B2+23j
		nop

loc_4068E6:				; CODE XREF: sub_4068B2+31j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jnb	short loc_40694E
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+File],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax
		call	sub_4083C8
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Str], eax ; Str
		call	fputs
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax ; void *
		call	sub_40259D
		mov	eax, [ebp+var_C]
		jmp	short loc_40696E
; ---------------------------------------------------------------------------

loc_40694E:				; CODE XREF: sub_4068B2+3Aj
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+File],	eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; FILE *
		call	sub_406882

loc_40696E:				; CODE XREF: sub_4068B2+9Aj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_4068B2	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_4069C6
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+14h]
		mov	[esp+10h], eax
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4066BF
		jmp	short loc_4069CB
; ---------------------------------------------------------------------------

loc_4069C6:				; CODE XREF: .text:0040697Fj
		mov	eax, 0

loc_4069CB:				; CODE XREF: .text:004069C4j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_406A1C
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406882
		jmp	short loc_406A21
; ---------------------------------------------------------------------------

loc_406A1C:				; CODE XREF: .text:004069DCj
		mov	eax, 0

loc_406A21:				; CODE XREF: .text:00406A1Aj
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_406A72
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4068B2
		jmp	short loc_406A77
; ---------------------------------------------------------------------------

loc_406A72:				; CODE XREF: .text:00406A32j
		mov	eax, 0

loc_406A77:				; CODE XREF: .text:00406A70j
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-18h], eax
		mov	eax, [ebp-0Ch]
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-10h], 1
		jmp	loc_406B27
; ---------------------------------------------------------------------------

loc_406AA1:				; CODE XREF: .text:00406B2Bj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_406AD3
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_406AD3
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+10h]
		jz	short loc_406AD3
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_406B1B
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_406B1B

loc_406AD3:				; CODE XREF: .text:00406AA9j
					; .text:00406AB3j ...
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_406B0F
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_406B0F
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jz	short loc_406B0F
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jz	short loc_406B0F
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jz	short loc_406B0F
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_406B15

loc_406B0F:				; CODE XREF: .text:00406ADBj
					; .text:00406AE5j ...
		add	dword ptr [ebp-10h], 2
		jmp	short loc_406B1F
; ---------------------------------------------------------------------------

loc_406B15:				; CODE XREF: .text:00406B0Dj
		add	dword ptr [ebp-10h], 5
		jmp	short loc_406B1F
; ---------------------------------------------------------------------------

loc_406B1B:				; CODE XREF: .text:00406AC7j
					; .text:00406AD1j
		add	dword ptr [ebp-10h], 1

loc_406B1F:				; CODE XREF: .text:00406B13j
					; .text:00406B19j
		sub	dword ptr [ebp+0Ch], 1
		add	dword ptr [ebp-0Ch], 1

loc_406B27:				; CODE XREF: .text:00406A9Cj
		cmp	dword ptr [ebp+0Ch], 0
		jnz	loc_406AA1
		mov	eax, [ebp-1Ch]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-18h]
		mov	[ebp+0Ch], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_402482
		mov	[ebp-20h], eax
		mov	eax, [ebp-20h]
		mov	[ebp-14h], eax
		jmp	loc_406C64
; ---------------------------------------------------------------------------

loc_406B56:				; CODE XREF: .text:00406C68j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_406B90
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_406B90
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+10h]
		jz	short loc_406B90
		cmp	dword ptr [ebp+10h], 0
		jz	loc_406C4B
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_406C4B

loc_406B90:				; CODE XREF: .text:00406B5Ej
					; .text:00406B68j ...
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	5Ch
		add	dword ptr [ebp-14h], 1
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_406BB3
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	6Eh
		add	dword ptr [ebp-14h], 1
		jmp	loc_406C5C
; ---------------------------------------------------------------------------

loc_406BB3:				; CODE XREF: .text:00406BA2j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_406BCC
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	72h
		add	dword ptr [ebp-14h], 1
		jmp	loc_406C5C
; ---------------------------------------------------------------------------

loc_406BCC:				; CODE XREF: .text:00406BBBj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_406BE2
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	66h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_406C5C
; ---------------------------------------------------------------------------

loc_406BE2:				; CODE XREF: .text:00406BD4j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_406BF8
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	76h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_406C5C
; ---------------------------------------------------------------------------

loc_406BF8:				; CODE XREF: .text:00406BEAj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_406C0E
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	62h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_406C5C
; ---------------------------------------------------------------------------

loc_406C0E:				; CODE XREF: .text:00406C00j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_406C24
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	30h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_406C5C
; ---------------------------------------------------------------------------

loc_406C24:				; CODE XREF: .text:00406C16j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x ; "x%02x"
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sprintf
		add	dword ptr [ebp-14h], 3
		jmp	short loc_406C5C
; ---------------------------------------------------------------------------

loc_406C4B:				; CODE XREF: .text:00406B7Cj
					; .text:00406B8Aj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp-14h]
		mov	[eax], dl
		add	dword ptr [ebp-14h], 1

loc_406C5C:				; CODE XREF: .text:00406BAEj
					; .text:00406BC7j ...
		sub	dword ptr [ebp+0Ch], 1
		add	dword ptr [ebp-0Ch], 1

loc_406C64:				; CODE XREF: .text:00406B51j
		cmp	dword ptr [ebp+0Ch], 0
		jnz	loc_406B56
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-20h]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	dword ptr [ebp-4], 0
		jmp	short loc_406CA5
; ---------------------------------------------------------------------------

loc_406C88:				; CODE XREF: .text:00406CADj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0C0h
		cmp	eax, 80h
		jz	short loc_406CA1
		add	dword ptr [ebp-4], 1

loc_406CA1:				; CODE XREF: .text:00406C9Bj
		add	dword ptr [ebp+8], 1

loc_406CA5:				; CODE XREF: .text:00406C86j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_406C88
		mov	eax, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0FFFFFFFFh
		jnz	short loc_406CCA
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+8], eax

loc_406CCA:				; CODE XREF: .text:00406CBEj
		mov	eax, [ebp+8]
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 0FFh
		mov	dword ptr [esp+10h], offset dword_40D120
		mov	dword ptr [esp+0Ch], 400h
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp], 1000h
		mov	eax, ds:FormatMessageA
		call	eax ; FormatMessageA
		sub	esp, 1Ch
		mov	eax, offset dword_40D120
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 40h
		jle	short loc_406D27
		cmp	dword ptr [ebp+8], 5Ah
		jg	short loc_406D27
		mov	eax, 1
		jmp	short loc_406D2C
; ---------------------------------------------------------------------------

loc_406D27:				; CODE XREF: .text:00406D18j
					; .text:00406D1Ej
		mov	eax, 0

loc_406D2C:				; CODE XREF: .text:00406D25j
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 60h
		jle	short loc_406D44
		cmp	dword ptr [ebp+8], 7Ah
		jg	short loc_406D44
		mov	eax, 1
		jmp	short loc_406D49
; ---------------------------------------------------------------------------

loc_406D44:				; CODE XREF: .text:00406D35j
					; .text:00406D3Bj
		mov	eax, 0

loc_406D49:				; CODE XREF: .text:00406D42j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406D4B	proc near		; CODE XREF: .text:0040603Ep
					; .text:00406051p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 60h
		jle	short loc_406D5E
		cmp	[ebp+arg_0], 7Ah
		jg	short loc_406D5E
		and	[ebp+arg_0], 0FFFFFFDFh

loc_406D5E:				; CODE XREF: sub_406D4B+7j
					; sub_406D4B+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_406D4B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406D63	proc near		; CODE XREF: .text:00406E68p
					; .text:00406E7Cp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 40h
		jle	short loc_406D76
		cmp	[ebp+arg_0], 5Ah
		jg	short loc_406D76
		or	[ebp+arg_0], 20h

loc_406D76:				; CODE XREF: sub_406D63+7j
					; sub_406D63+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_406D63	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406D7B	proc near		; CODE XREF: sub_40195F+156p
					; .text:004077BCp ...

var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_406DD6
		mov	eax, 0
		jmp	loc_406E2F
; ---------------------------------------------------------------------------

loc_406D94:				; CODE XREF: sub_406D7B+6Ej
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_406DCC
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_406D4B
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_406D4B
		cmp	ebx, eax
		jnz	short loc_406DED

loc_406DCC:				; CODE XREF: sub_406D7B+27j
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1
		jmp	short loc_406DD7
; ---------------------------------------------------------------------------

loc_406DD6:				; CODE XREF: sub_406D7B+Dj
		nop

loc_406DD7:				; CODE XREF: sub_406D7B+59j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406DEE
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_406D94
		jmp	short loc_406DEE
; ---------------------------------------------------------------------------

loc_406DED:				; CODE XREF: sub_406D7B+4Fj
		nop

loc_406DEE:				; CODE XREF: sub_406D7B+64j
					; sub_406D7B+70j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_406E2A
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_406D4B
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_406D4B
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_406E2F
; ---------------------------------------------------------------------------

loc_406E2A:				; CODE XREF: sub_406D7B+81j
		mov	eax, 0

loc_406E2F:				; CODE XREF: sub_406D7B+14j
					; sub_406D7B+ADj
		add	esp, 4
		pop	ebx
		pop	ebp
		retn
sub_406D7B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-8], eax
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jz	short loc_406E55
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_406E5C

loc_406E55:				; CODE XREF: .text:00406E4Dj
		mov	eax, 0
		jmp	short locret_406EB3
; ---------------------------------------------------------------------------

loc_406E5C:				; CODE XREF: .text:00406E53j
					; .text:00406EA3j
		mov	eax, [ebp-4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_406D63
		mov	[ebp-9], al
		mov	eax, [ebp-8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_406D63
		mov	[ebp-0Ah], al
		sub	dword ptr [ebp+10h], 1
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_406EA5
		cmp	byte ptr [ebp-9], 0
		jz	short loc_406EA5
		add	dword ptr [ebp-4], 1
		add	dword ptr [ebp-8], 1
		movzx	eax, byte ptr [ebp-9]
		cmp	al, [ebp-0Ah]
		jz	short loc_406E5C

loc_406EA5:				; CODE XREF: .text:00406E8Cj
					; .text:00406E92j
		movzx	edx, byte ptr [ebp-9]
		movzx	eax, byte ptr [ebp-0Ah]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_406EB3:				; CODE XREF: .text:00406E5Aj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406EB5	proc near		; CODE XREF: .text:00407036p
					; .text:0040777Fp

var_18		= dword	ptr -18h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_C]
		jnz	loc_406F65
		mov	eax, 0
		jmp	loc_406F74
; ---------------------------------------------------------------------------

loc_406EDE:				; CODE XREF: sub_406EB5+B4j
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_406F59
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_406D4B
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_406D4B
		cmp	ebx, eax
		jz	short loc_406F59
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_406F52
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_406D4B
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_406D4B
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_406F57
; ---------------------------------------------------------------------------

loc_406F52:				; CODE XREF: sub_406EB5+6Fj
		mov	eax, 0

loc_406F57:				; CODE XREF: sub_406EB5+9Bj
		jmp	short loc_406F74
; ---------------------------------------------------------------------------

loc_406F59:				; CODE XREF: sub_406EB5+37j
					; sub_406EB5+5Fj
		sub	[ebp+arg_8], 1
		add	[ebp+var_8], 1
		add	[ebp+var_C], 1

loc_406F65:				; CODE XREF: sub_406EB5+19j
		cmp	[ebp+arg_8], 0
		jnz	loc_406EDE
		mov	eax, 0

loc_406F74:				; CODE XREF: sub_406EB5+24j
					; sub_406EB5:loc_406F57j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_406EB5	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		cmp	eax, [ebp+0Ch]
		jnz	short loc_406FA6
		mov	eax, 0
		jmp	short loc_406FED
; ---------------------------------------------------------------------------

loc_406F8C:				; CODE XREF: .text:00406FB9j
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jnz	short loc_406FBD
		add	dword ptr [ebp+8], 1
		add	dword ptr [ebp+0Ch], 1
		jmp	short loc_406FA7
; ---------------------------------------------------------------------------

loc_406FA6:				; CODE XREF: .text:00406F83j
		nop

loc_406FA7:				; CODE XREF: .text:00406FA4j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_406FBE
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_406F8C
		jmp	short loc_406FBE
; ---------------------------------------------------------------------------

loc_406FBD:				; CODE XREF: .text:00406F9Aj
		nop

loc_406FBE:				; CODE XREF: .text:00406FAFj
					; .text:00406FBBj
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_406FE8
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short loc_406FED
; ---------------------------------------------------------------------------

loc_406FE8:				; CODE XREF: .text:00406FCCj
		mov	eax, 0

loc_406FED:				; CODE XREF: .text:00406F8Aj
					; .text:00406FE6j
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		cmp	dword ptr [ebp+14h], 0
		jnz	short loc_407000
		mov	eax, [ebp+8]
		jmp	short locret_407055
; ---------------------------------------------------------------------------

loc_407000:				; CODE XREF: .text:00406FF9j
		mov	eax, [ebp+14h]
		cmp	eax, [ebp+0Ch]
		ja	short loc_407050
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+14h]
		mov	edx, [ebp+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, [ebp-4]
		mov	[ebp-8], eax
		jmp	short loc_407048
; ---------------------------------------------------------------------------

loc_407022:				; CODE XREF: .text:0040704Ej
		mov	eax, [ebp+14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-4]
		mov	[esp], eax
		call	sub_406EB5
		test	eax, eax
		jnz	short loc_407044
		mov	eax, [ebp-4]
		jmp	short locret_407055
; ---------------------------------------------------------------------------

loc_407044:				; CODE XREF: .text:0040703Dj
		add	dword ptr [ebp-4], 1

loc_407048:				; CODE XREF: .text:00407020j
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jbe	short loc_407022

loc_407050:				; CODE XREF: .text:00407006j
		mov	eax, 0

locret_407055:				; CODE XREF: .text:00406FFEj
					; .text:00407042j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407057	proc near		; CODE XREF: .text:00406531p
					; .text:0040653Dp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		jmp	short loc_40706F
; ---------------------------------------------------------------------------

loc_40705C:				; CODE XREF: sub_407057+20j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_40706F:				; CODE XREF: sub_407057+3j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40705C
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_407057	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_4070A2
		mov	eax, 0
		jmp	locret_40714D
; ---------------------------------------------------------------------------

loc_4070A2:				; CODE XREF: .text:00407096j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4070B9
		mov	eax, [ebp+0Ch]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407112

loc_4070B9:				; CODE XREF: .text:004070AAj
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		mov	[ebp-11h], al
		cmp	byte ptr [ebp-11h], 0
		jnz	short loc_4070D1
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_407127
; ---------------------------------------------------------------------------

loc_4070D1:				; CODE XREF: .text:004070C6j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, [ebp-11h]
		jnz	short loc_4070E4
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	short loc_407127
; ---------------------------------------------------------------------------

loc_4070E4:				; CODE XREF: .text:004070DAj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4070F7
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_407127
; ---------------------------------------------------------------------------

loc_4070F7:				; CODE XREF: .text:004070ECj
		movsx	eax, byte ptr [ebp-11h]
		mov	edx, [ebp-10h]
		add	edx, 1
		mov	[esp+4], eax
		mov	[esp], edx
		call	strchr
		mov	[ebp-0Ch], eax
		jmp	short loc_407127
; ---------------------------------------------------------------------------

loc_407112:				; CODE XREF: .text:004070B7j
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	strpbrk
		mov	[ebp-0Ch], eax

loc_407127:				; CODE XREF: .text:004070CFj
					; .text:004070E2j ...
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_407141
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp+8]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		jmp	short loc_40714A
; ---------------------------------------------------------------------------

loc_407141:				; CODE XREF: .text:0040712Bj
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0

loc_40714A:				; CODE XREF: .text:0040713Fj
		mov	eax, [ebp-10h]

locret_40714D:				; CODE XREF: .text:0040709Dj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+10h]
		add	[ebp-4], eax
		jmp	short loc_40717E
; ---------------------------------------------------------------------------

loc_407163:				; CODE XREF: .text:00407182j
		sub	dword ptr [ebp-4], 1
		mov	eax, [ebp-4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+0Ch]
		jnz	short loc_40717A
		mov	eax, [ebp-4]
		jmp	short locret_407189
; ---------------------------------------------------------------------------

loc_40717A:				; CODE XREF: .text:00407173j
		sub	dword ptr [ebp+10h], 1

loc_40717E:				; CODE XREF: .text:00407161j
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_407163
		mov	eax, 0

locret_407189:				; CODE XREF: .text:00407178j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_4071A1
		mov	eax, 0
		jmp	locret_407370
; ---------------------------------------------------------------------------

loc_4071A1:				; CODE XREF: .text:00407195j
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	short loc_4071F7
; ---------------------------------------------------------------------------

loc_4071B0:				; CODE XREF: .text:00407202j
		mov	eax, [ebp-0Ch]
		add	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_4071EF
		mov	eax, [ebp-0Ch]
		add	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_4071EF
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_4071F3
		mov	eax, [ebp-0Ch]
		add	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	strchr
		test	eax, eax
		jz	short loc_4071F3

loc_4071EF:				; CODE XREF: .text:004071BBj
					; .text:004071C8j
		add	dword ptr [ebp-10h], 1

loc_4071F3:				; CODE XREF: .text:004071CEj
					; .text:004071EDj
		add	dword ptr [ebp-0Ch], 1

loc_4071F7:				; CODE XREF: .text:004071AEj
		mov	eax, [ebp-0Ch]
		add	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4071B0
		mov	eax, [ebp-10h]
		add	eax, eax
		add	eax, [ebp-0Ch]
		add	eax, 1
		mov	[esp], eax
		call	sub_402482
		mov	[ebp-14h], eax
		mov	dword ptr [ebp-0Ch], 0
		jmp	loc_407356
; ---------------------------------------------------------------------------

loc_407226:				; CODE XREF: .text:0040735Ej
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_40725C
		mov	eax, [ebp-0Ch]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	25h
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-0Ch]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	33h
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-0Ch]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	61h
		add	dword ptr [ebp-0Ch], 1
		jmp	loc_407352
; ---------------------------------------------------------------------------

loc_40725C:				; CODE XREF: .text:0040722Ej
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_407292
		mov	eax, [ebp-0Ch]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	25h
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-0Ch]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	32h
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-0Ch]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	35h
		add	dword ptr [ebp-0Ch], 1
		jmp	loc_407352
; ---------------------------------------------------------------------------

loc_407292:				; CODE XREF: .text:00407264j
		cmp	dword ptr [ebp+0Ch], 0
		jz	loc_407340
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	strchr
		test	eax, eax
		jz	loc_407340
		mov	eax, [ebp-0Ch]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	25h
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-0Ch]
		mov	edx, eax
		add	edx, [ebp-14h]
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		sar	al, 4
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_4072F3
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 30h
		jmp	short loc_4072FF
; ---------------------------------------------------------------------------

loc_4072F3:				; CODE XREF: .text:004072E3j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 57h

loc_4072FF:				; CODE XREF: .text:004072F1j
		mov	[edx], al
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-0Ch]
		mov	edx, eax
		add	edx, [ebp-14h]
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_40732C
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_407338
; ---------------------------------------------------------------------------

loc_40732C:				; CODE XREF: .text:0040731Cj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 57h

loc_407338:				; CODE XREF: .text:0040732Aj
		mov	[edx], al
		add	dword ptr [ebp-0Ch], 1
		jmp	short loc_407352
; ---------------------------------------------------------------------------

loc_407340:				; CODE XREF: .text:00407296j
					; .text:004072B6j
		mov	eax, [ebp-0Ch]
		add	eax, [ebp-14h]
		mov	edx, [ebp+8]
		movzx	edx, byte ptr [edx]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1

loc_407352:				; CODE XREF: .text:00407257j
					; .text:0040728Dj ...
		add	dword ptr [ebp+8], 1

loc_407356:				; CODE XREF: .text:00407221j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_407226
		mov	eax, [ebp-0Ch]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-14h]

locret_407370:				; CODE XREF: .text:0040719Cj
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407374(LPCSTR)
sub_407374	proc near		; CODE XREF: sub_40742E+2Cp

lpLibFileName	= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+lpLibFileName], eax ; lpLibFileName
		mov	eax, ds:LoadLibraryA
		call	eax ; LoadLibraryA
		sub	esp, 4
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_407374	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407392(HMODULE, LPCSTR)
sub_407392	proc near		; CODE XREF: sub_40742E+48p
					; sub_40742E+69p ...

hModule		= dword	ptr -28h
lpProcName	= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_4073D0
		cmp	[ebp+arg_4], 0
		jz	short loc_4073D0
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lpProcName], eax ; lpProcName
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hModule], eax ; hModule
		mov	eax, ds:GetProcAddress
		call	eax ; GetProcAddress
		sub	esp, 8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4073CB
		mov	eax, 0
		jmp	short locret_4073D5
; ---------------------------------------------------------------------------

loc_4073CB:				; CODE XREF: sub_407392+30j
		mov	eax, [ebp+var_C]
		jmp	short locret_4073D5
; ---------------------------------------------------------------------------

loc_4073D0:				; CODE XREF: sub_407392+Aj
					; sub_407392+10j
		mov	eax, 0

locret_4073D5:				; CODE XREF: sub_407392+37j
					; sub_407392+3Cj
		leave
		retn
sub_407392	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4073D7	proc near		; CODE XREF: sub_40742E:loc_4074D1p

Dest		= dword	ptr -18h
Format		= dword	ptr -14h
var_10		= dword	ptr -10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	edx, offset aEcLu ; "ec=%lu"
		mov	[esp+18h+var_10], eax
		mov	[esp+18h+Format], edx ;	Format
		mov	[esp+18h+Dest],	offset byte_40D280 ; Dest
		call	sprintf
		mov	eax, offset byte_40D280
		leave
		retn
sub_4073D7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407404(HANDLE)
sub_407404	proc near		; CODE XREF: sub_40742E+F6p

hObject		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_407427
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		jmp	short locret_40742C
; ---------------------------------------------------------------------------

loc_407427:				; CODE XREF: sub_407404+Aj
		mov	eax, 0FFFFFFFFh

locret_40742C:				; CODE XREF: sub_407404+21j
		leave
		retn
sub_407404	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40742E	proc near		; CODE XREF: .text:loc_407892p
					; .text:004083F8p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_40D26C
		test	eax, eax
		jnz	loc_407529
		mov	ds:dword_40D26C, 1
		mov	[esp+28h+var_24], 0
		mov	[esp+28h+var_28], offset aIconv_dll ; "iconv.dll"
		call	sub_407374
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4074C2
		mov	[esp+28h+var_24], offset aLibiconv_open	; "libiconv_open"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	HMODULE
		call	sub_407392
		mov	ds:dword_40D22C, eax
		mov	eax, ds:dword_40D22C
		test	eax, eax
		jz	short loc_4074A1
		mov	[esp+28h+var_24], offset aLibiconv ; "libiconv"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	HMODULE
		call	sub_407392
		mov	ds:dword_40D230, eax

loc_4074A1:				; CODE XREF: sub_40742E+59j
		mov	eax, ds:dword_40D230
		test	eax, eax
		jz	short loc_4074C2
		mov	[esp+28h+var_24], offset aLibiconv_close ; "libiconv_close"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	HMODULE
		call	sub_407392
		mov	ds:dword_40D234, eax

loc_4074C2:				; CODE XREF: sub_40742E+38j
					; sub_40742E+7Aj
		cmp	[ebp+var_C], 0
		jz	short loc_4074D1
		mov	eax, ds:dword_40D234
		test	eax, eax
		jnz	short loc_407529

loc_4074D1:				; CODE XREF: sub_40742E+98j
		call	sub_4073D7
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+var_24], offset aIconv_dll ; "iconv.dll"
		mov	[esp+28h+var_28], offset aErrorLoadingSS ; "error loading `%s': %s\n"
		call	sub_405D3B
		mov	[esp+28h+var_28], offset aPleaseSeeHttpW ; "please see http://www.gnupg.org/downloa"...
		call	sub_405D3B
		mov	ds:dword_40D22C, 0
		mov	ds:dword_40D230, 0
		mov	ds:dword_40D234, 0
		cmp	[ebp+var_C], 0
		jz	short loc_407529
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	HANDLE
		call	sub_407404

loc_407529:				; CODE XREF: sub_40742E+Dj
					; sub_40742E+A1j ...
		mov	eax, ds:dword_40D22C
		test	eax, eax
		jz	short loc_407539
		mov	eax, 0
		jmp	short locret_40753E
; ---------------------------------------------------------------------------

loc_407539:				; CODE XREF: sub_40742E+102j
		mov	eax, 0FFFFFFFFh

locret_40753E:				; CODE XREF: sub_40742E+109j
		leave
		retn
sub_40742E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407540	proc near		; CODE XREF: .text:004078DDp
					; .text:00407935p ...

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_4075CC
		cmp	[ebp+arg_0], 0
		jz	short loc_407598
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aUtf8 ; "utf-8"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_407598
		mov	eax, ds:dword_40D260
		mov	[ebp+var_C], eax
		mov	ds:dword_40D260, 1
		jmp	short loc_4075AA
; ---------------------------------------------------------------------------

loc_407598:				; CODE XREF: sub_407540+1Aj
					; sub_407540+42j
		mov	eax, ds:dword_40D264
		mov	[ebp+var_C], eax
		mov	ds:dword_40D264, 1

loc_4075AA:				; CODE XREF: sub_407540+56j
		cmp	[ebp+var_C], 0
		jnz	short loc_407600
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aConversionFrom ; "conversion from `%s' to `%s' not availa"...
		call	sub_405D3B
		jmp	short loc_407600
; ---------------------------------------------------------------------------

loc_4075CC:				; CODE XREF: sub_407540+14j
		mov	eax, ds:dword_40D268
		test	eax, eax
		jnz	short loc_4075F6
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	int
		call	strerror
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aIconv_openFail ; "iconv_open failed: %s\n"
		call	sub_405D3B

loc_4075F6:				; CODE XREF: sub_407540+93j
		mov	ds:dword_40D268, 1

loc_407600:				; CODE XREF: sub_407540+6Ej
					; sub_407540+8Aj
		cmp	[ebp+arg_8], 0
		jz	short loc_40762E
		mov	off_40A104, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_40D224, 0
		mov	ds:dword_40D220, 0
		mov	ds:dword_40D228, 0

loc_40762E:				; CODE XREF: sub_407540+C4j
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_407540	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+8], 0
		jnz	loc_40773F
		mov	eax, ds:GetConsoleOutputCP
		call	eax ; GetConsoleOutputCP
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_407660
		mov	eax, ds:GetACP
		call	eax ; GetACP
		mov	[ebp-0Ch], eax

loc_407660:				; CODE XREF: .text:00407654j
		mov	eax, offset aCpU ; "CP%u"
		mov	edx, [ebp-0Ch]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_40D240
		call	sprintf
		mov	dword ptr [ebp+8], offset dword_40D240
		mov	dword ptr [ebp-10h], offset aCp936 ; "CP936"
		jmp	loc_407731
; ---------------------------------------------------------------------------

loc_40768F:				; CODE XREF: .text:00407739j
		mov	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_40D240
		call	strcmp
		test	eax, eax
		jz	short loc_4076BD
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	short loc_4076E7
		mov	eax, [ebp-10h]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4076E7

loc_4076BD:				; CODE XREF: .text:004076A4j
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	eax, [ebp-10h]
		mov	[ebp+8], eax
		jmp	short loc_40773F
; ---------------------------------------------------------------------------

loc_4076E7:				; CODE XREF: .text:004076AEj
					; .text:004076BBj
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp-10h], eax

loc_407731:				; CODE XREF: .text:0040768Aj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_40768F

loc_40773F:				; CODE XREF: .text:00407640j
					; .text:004076E5j
		mov	eax, [ebp+8]
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 3
		jbe	short loc_4077A4
		mov	dword ptr [esp+8], 3
		mov	dword ptr [esp+4], offset aIso ; "iso"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406EB5
		test	eax, eax
		jnz	short loc_4077A4
		add	dword ptr [ebp+8], 3
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jz	short loc_4077A0
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Fh
		jnz	short loc_4077A4

loc_4077A0:				; CODE XREF: .text:00407794j
		add	dword ptr [ebp+8], 1

loc_4077A4:				; CODE XREF: .text:00407767j
					; .text:00407786j ...
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40780A
		mov	dword ptr [esp+4], offset a88591 ; "8859-1"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406D7B
		test	eax, eax
		jz	short loc_40780A
		mov	dword ptr [esp+4], offset a646 ; "646"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406D7B
		test	eax, eax
		jz	short loc_40780A
		mov	dword ptr [esp+4], offset aAscii ; "ASCII"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406D7B
		test	eax, eax
		jz	short loc_40780A
		mov	dword ptr [esp+4], offset aAnsi_x3_41968 ; "ANSI_X3.4-1968"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406D7B
		test	eax, eax
		jnz	short loc_407837

loc_40780A:				; CODE XREF: .text:004077ACj
					; .text:004077C3j ...
		mov	off_40A104, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_40D224, 0
		mov	ds:dword_40D220, 0
		mov	ds:dword_40D228, 0
		jmp	loc_407978
; ---------------------------------------------------------------------------

loc_407837:				; CODE XREF: .text:00407808j
		mov	dword ptr [esp+4], offset aUtf8_0 ; "utf8"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406D7B
		test	eax, eax
		jz	short loc_407865
		mov	dword ptr [esp+4], offset aUtf8	; "utf-8"
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406D7B
		test	eax, eax
		jnz	short loc_407892

loc_407865:				; CODE XREF: .text:0040784Cj
		mov	off_40A104, offset aUtf8 ; "utf-8"
		mov	ds:dword_40D224, 1
		mov	ds:dword_40D220, 0
		mov	ds:dword_40D228, 0
		jmp	loc_407978
; ---------------------------------------------------------------------------

loc_407892:				; CODE XREF: .text:00407863j
		call	sub_40742E
		test	eax, eax
		jz	short loc_4078A5
		mov	eax, 0FFFFFFFFh
		jmp	loc_40797D
; ---------------------------------------------------------------------------

loc_4078A5:				; CODE XREF: .text:00407899j
		mov	edx, ds:dword_40D22C
		mov	dword ptr [esp+4], offset aUtf8	; "utf-8"
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	edx ; dword_40D22C
		sub	esp, 8
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jnz	short loc_4078EC
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], offset aUtf8	; "utf-8"
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_407540
		mov	eax, 0FFFFFFFFh
		jmp	loc_40797D
; ---------------------------------------------------------------------------

loc_4078EC:				; CODE XREF: .text:004078C5j
		mov	edx, ds:dword_40D234
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	edx ; dword_40D234
		sub	esp, 4
		mov	edx, ds:dword_40D22C
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aUtf8 ;	"utf-8"
		call	edx ; dword_40D22C
		sub	esp, 8
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jnz	short loc_407941
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aUtf8 ;	"utf-8"
		call	sub_407540
		mov	eax, 0FFFFFFFFh
		jmp	short loc_40797D
; ---------------------------------------------------------------------------

loc_407941:				; CODE XREF: .text:0040791Dj
		mov	edx, ds:dword_40D234
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	edx ; dword_40D234
		sub	esp, 4
		mov	eax, [ebp-14h]
		mov	off_40A104, eax
		mov	ds:dword_40D224, 0
		mov	ds:dword_40D220, 0
		mov	ds:dword_40D228, 1

loc_407978:				; CODE XREF: .text:00407832j
					; .text:0040788Dj
		mov	eax, 0

loc_40797D:				; CODE XREF: .text:004078A0j
					; .text:004078E7j ...
		mov	edi, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, off_40A104
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40798C	proc near		; CODE XREF: sub_404BD3+43p
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_40D224
		pop	ebp
		retn
sub_40798C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407996(char *)
sub_407996	proc near		; CODE XREF: sub_407996+13Ap

Dest		= dword	ptr -68h
Source		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 64h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_18], 0
		mov	eax, ds:dword_40D224
		test	eax, eax
		jz	short loc_4079C6
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Dest],	eax ; char *
		call	sub_402543
		mov	[ebp+var_10], eax
		jmp	loc_407BEA
; ---------------------------------------------------------------------------

loc_4079C6:				; CODE XREF: sub_407996+1Bj
		mov	eax, ds:dword_40D220
		test	eax, eax
		jnz	loc_407A89
		mov	eax, ds:dword_40D228
		test	eax, eax
		jnz	loc_407A89
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax
		jmp	short loc_4079FE
; ---------------------------------------------------------------------------

loc_4079E8:				; CODE XREF: sub_407996+70j
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_4079FA
		add	[ebp+var_18], 1

loc_4079FA:				; CODE XREF: sub_407996+5Ej
		add	[ebp+var_C], 1

loc_4079FE:				; CODE XREF: sub_407996+50j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4079E8
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[esp+68h+Dest],	eax ; size_t
		call	sub_402482
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax
		jmp	short loc_407A74
; ---------------------------------------------------------------------------

loc_407A27:				; CODE XREF: sub_407996+E6j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_407A61
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		shr	al, 6
		or	eax, 0FFFFFFC0h
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		and	eax, 3Fh
		or	eax, 0FFFFFF80h
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	short loc_407A70
; ---------------------------------------------------------------------------

loc_407A61:				; CODE XREF: sub_407996+99j
		mov	eax, [ebp+var_C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1

loc_407A70:				; CODE XREF: sub_407996+C9j
		add	[ebp+var_C], 1

loc_407A74:				; CODE XREF: sub_407996+8Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407A27
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		jmp	loc_407BEA
; ---------------------------------------------------------------------------

loc_407A89:				; CODE XREF: sub_407996+37j
					; sub_407996+44j
		mov	edx, ds:dword_40D22C
		mov	eax, off_40A104
		mov	[esp+68h+Source], eax
		mov	[esp+68h+Dest],	offset aUtf8 ; "utf-8"
		call	edx ; dword_40D22C
		sub	esp, 8
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0FFFFFFFFh
		jnz	short loc_407ADA
		mov	eax, off_40A104
		mov	[esp+68h+var_60], 1
		mov	[esp+68h+Source], eax
		mov	[esp+68h+Dest],	offset aUtf8 ; "utf-8"
		call	sub_407540
		mov	eax, [ebp+var_1C]
		mov	[esp+68h+Dest],	eax ; char *
		call	sub_407996
		jmp	loc_407BED
; ---------------------------------------------------------------------------

loc_407ADA:				; CODE XREF: sub_407996+115j
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax
		jmp	short loc_407AF8
; ---------------------------------------------------------------------------

loc_407AE2:				; CODE XREF: sub_407996+16Aj
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_407AF4
		add	[ebp+var_18], 5

loc_407AF4:				; CODE XREF: sub_407996+158j
		add	[ebp+var_C], 1

loc_407AF8:				; CODE XREF: sub_407996+14Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_407AE2
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[esp+68h+Dest],	eax ; size_t
		call	sub_402482
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_30], eax
		mov	edx, ds:dword_40D230
		lea	eax, [ebp+var_30]
		mov	[esp+68h+var_58], eax
		lea	eax, [ebp+var_28]
		mov	[esp+68h+var_5C], eax
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+var_60], eax
		lea	eax, [ebp+var_24]
		mov	[esp+68h+Source], eax
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Dest],	eax
		call	edx ; dword_40D230
		sub	esp, 14h
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_407BD3
		mov	eax, ds:dword_40D23C
		test	eax, eax
		jnz	short loc_407BB5
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+68h+Dest],	eax ; int
		call	strerror
		mov	edx, off_40A104
		mov	[esp+68h+var_5C], eax
		mov	[esp+68h+var_60], offset aUtf8 ; "utf-8"
		mov	[esp+68h+Source], edx ;	char
		mov	[esp+68h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_405D3B

loc_407BB5:				; CODE XREF: sub_407996+1EAj
		mov	ds:dword_40D23C, 1
		mov	eax, [ebp+var_1C]
		mov	[esp+68h+Source], eax ;	Source
		mov	eax, [ebp+var_10]
		mov	[esp+68h+Dest],	eax ; Dest
		call	strcpy
		jmp	short loc_407BD9
; ---------------------------------------------------------------------------

loc_407BD3:				; CODE XREF: sub_407996+1E1j
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	0

loc_407BD9:				; CODE XREF: sub_407996+23Bj
		mov	edx, ds:dword_40D234
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Dest],	eax
		call	edx ; dword_40D234
		sub	esp, 4

loc_407BEA:				; CODE XREF: sub_407996+2Bj
					; sub_407996+EEj
		mov	eax, [ebp+var_10]

loc_407BED:				; CODE XREF: sub_407996+13Fj
		mov	edi, [ebp+var_4]
		leave
		retn
sub_407996	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407BF2	proc near		; CODE XREF: sub_407BF2+79Ap
					; sub_4083C8+23p

Dest		= dword	ptr -88h
Format		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 88h
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 0
		mov	[ebp+var_30], 0

loc_407C17:				; CODE XREF: sub_407BF2+5EEj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_14]
		mov	[ebp+var_C], eax
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		jmp	loc_4081B9
; ---------------------------------------------------------------------------

loc_407C3C:				; CODE XREF: sub_407BF2+5CBj
		cmp	[ebp+var_30], 0
		jz	short loc_407C9B
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_407C94
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	short loc_407C60
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FDh
		jbe	short loc_407C94

loc_407C60:				; CODE XREF: sub_407BF2+62j
		cmp	[ebp+var_24], 0
		jz	short loc_407C8B
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_407C8B:				; CODE XREF: sub_407BF2+72j
		add	[ebp+var_1C], 4
		jmp	loc_4081B1
; ---------------------------------------------------------------------------

loc_407C94:				; CODE XREF: sub_407BF2+58j
					; sub_407BF2+6Cj
		mov	[ebp+var_30], 0

loc_407C9B:				; CODE XREF: sub_407BF2+4Ej
		cmp	[ebp+var_C], 0
		jnz	loc_407FCE
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	loc_407E26
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jz	loc_407E06
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_407CF7
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_407CF7
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_8]
		jz	short loc_407CF7
		cmp	[ebp+arg_8], 0
		jz	loc_407E06
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_407E06

loc_407CF7:				; CODE XREF: sub_407BF2+D3j
					; sub_407BF2+DDj ...
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_407D0B
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_24], 1

loc_407D0B:				; CODE XREF: sub_407BF2+10Dj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, 0Dh	; switch 14 cases
		ja	loc_407DBC	; jumptable 00407D24 default case
		mov	eax, ds:off_40C224[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_407D26:				; CODE XREF: sub_407BF2+132j
					; DATA XREF: .rdata:off_40C224o
		add	[ebp+var_1C], 1	; jumptable 00407D24 case 10
		cmp	[ebp+var_24], 0
		jz	loc_407DED
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	6Eh
		add	[ebp+var_24], 1
		jmp	loc_407DED
; ---------------------------------------------------------------------------

loc_407D43:				; CODE XREF: sub_407BF2+132j
					; DATA XREF: .rdata:off_40C224o
		add	[ebp+var_1C], 1	; jumptable 00407D24 case 13
		cmp	[ebp+var_24], 0
		jz	loc_407DF0
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	72h
		add	[ebp+var_24], 1
		jmp	loc_407DF0
; ---------------------------------------------------------------------------

loc_407D60:				; CODE XREF: sub_407BF2+132j
					; DATA XREF: .rdata:off_40C224o
		add	[ebp+var_1C], 1	; jumptable 00407D24 case 12
		cmp	[ebp+var_24], 0
		jz	loc_407DF3
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	66h
		add	[ebp+var_24], 1
		jmp	short loc_407DF3
; ---------------------------------------------------------------------------

loc_407D7A:				; CODE XREF: sub_407BF2+132j
					; DATA XREF: .rdata:off_40C224o
		add	[ebp+var_1C], 1	; jumptable 00407D24 case 11
		cmp	[ebp+var_24], 0
		jz	short loc_407DF6
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	76h
		add	[ebp+var_24], 1
		jmp	short loc_407DF6
; ---------------------------------------------------------------------------

loc_407D90:				; CODE XREF: sub_407BF2+132j
					; DATA XREF: .rdata:off_40C224o
		add	[ebp+var_1C], 1	; jumptable 00407D24 case 8
		cmp	[ebp+var_24], 0
		jz	short loc_407DF9
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	62h
		add	[ebp+var_24], 1
		jmp	short loc_407DF9
; ---------------------------------------------------------------------------

loc_407DA6:				; CODE XREF: sub_407BF2+132j
					; DATA XREF: .rdata:off_40C224o
		add	[ebp+var_1C], 1	; jumptable 00407D24 case 0
		cmp	[ebp+var_24], 0
		jz	short loc_407DFC
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	30h
		add	[ebp+var_24], 1
		jmp	short loc_407DFC
; ---------------------------------------------------------------------------

loc_407DBC:				; CODE XREF: sub_407BF2+125j
					; sub_407BF2+132j
					; DATA XREF: ...
		add	[ebp+var_1C], 3	; jumptable 00407D24 default case
		cmp	[ebp+var_24], 0
		jz	short loc_407DFF
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 3
		jmp	short loc_407DFF
; ---------------------------------------------------------------------------

loc_407DED:				; CODE XREF: sub_407BF2+13Cj
					; sub_407BF2+14Cj
		nop
		jmp	short loc_407E00
; ---------------------------------------------------------------------------

loc_407DF0:				; CODE XREF: sub_407BF2+159j
					; sub_407BF2+169j
		nop
		jmp	short loc_407E00
; ---------------------------------------------------------------------------

loc_407DF3:				; CODE XREF: sub_407BF2+176j
					; sub_407BF2+186j
		nop
		jmp	short loc_407E00
; ---------------------------------------------------------------------------

loc_407DF6:				; CODE XREF: sub_407BF2+190j
					; sub_407BF2+19Cj
		nop
		jmp	short loc_407E00
; ---------------------------------------------------------------------------

loc_407DF9:				; CODE XREF: sub_407BF2+1A6j
					; sub_407BF2+1B2j
		nop
		jmp	short loc_407E00
; ---------------------------------------------------------------------------

loc_407DFC:				; CODE XREF: sub_407BF2+1BCj
					; sub_407BF2+1C8j
		nop
		jmp	short loc_407E00
; ---------------------------------------------------------------------------

loc_407DFF:				; CODE XREF: sub_407BF2+1D2j
					; sub_407BF2+1F9j
		nop

loc_407E00:				; CODE XREF: sub_407BF2+1FCj
					; sub_407BF2+1FFj ...
		nop
		jmp	loc_4081B1
; ---------------------------------------------------------------------------

loc_407E06:				; CODE XREF: sub_407BF2+C5j
					; sub_407BF2+F1j ...
		cmp	[ebp+var_24], 0
		jz	short loc_407E1D
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_407E1D:				; CODE XREF: sub_407BF2+218j
		add	[ebp+var_1C], 1
		jmp	loc_4081B1
; ---------------------------------------------------------------------------

loc_407E26:				; CODE XREF: sub_407BF2+BBj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0E0h
		cmp	eax, 0C0h
		jnz	short loc_407E6F
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 1
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_4081B1
; ---------------------------------------------------------------------------

loc_407E6F:				; CODE XREF: sub_407BF2+247j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F0h
		cmp	eax, 0E0h
		jnz	short loc_407EB8
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 2
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_4081B1
; ---------------------------------------------------------------------------

loc_407EB8:				; CODE XREF: sub_407BF2+290j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F8h
		cmp	eax, 0F0h
		jnz	short loc_407F01
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 7
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 3
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_4081B1
; ---------------------------------------------------------------------------

loc_407F01:				; CODE XREF: sub_407BF2+2D9j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FCh
		cmp	eax, 0F8h
		jnz	short loc_407F4A
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 4
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_4081B1
; ---------------------------------------------------------------------------

loc_407F4A:				; CODE XREF: sub_407BF2+322j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FEh
		cmp	eax, 0FCh
		jnz	short loc_407F93
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 5
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_4081B1
; ---------------------------------------------------------------------------

loc_407F93:				; CODE XREF: sub_407BF2+36Bj
		cmp	[ebp+var_24], 0
		jz	short loc_407FBE
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_407FBE:				; CODE XREF: sub_407BF2+3A5j
		add	[ebp+var_1C], 4
		mov	[ebp+var_30], 1
		jmp	loc_4081B1
; ---------------------------------------------------------------------------

loc_407FCE:				; CODE XREF: sub_407BF2+ADj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_407FE6
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	loc_408074

loc_407FE6:				; CODE XREF: sub_407BF2+3E4j
		cmp	[ebp+var_24], 0
		jz	short loc_40804E
		mov	[ebp+var_10], 0
		jmp	short loc_408021
; ---------------------------------------------------------------------------

loc_407FF5:				; CODE XREF: sub_407BF2+435j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_408021:				; CODE XREF: sub_407BF2+401j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_407FF5
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_40804E:				; CODE XREF: sub_407BF2+3F8j
		mov	eax, [ebp+var_14]
		add	eax, 1
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_30], 1
		jmp	loc_4081B1
; ---------------------------------------------------------------------------

loc_408074:				; CODE XREF: sub_407BF2+3EEj
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		shl	[ebp+var_28], 6
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3Fh
		or	[ebp+var_28], eax
		sub	[ebp+var_C], 1
		cmp	[ebp+var_C], 0
		jnz	loc_4081B1
		mov	eax, ds:dword_40D224
		test	eax, eax
		jz	short loc_4080F1
		cmp	[ebp+var_24], 0
		jz	short loc_4080DF
		mov	[ebp+var_10], 0
		jmp	short loc_4080D7
; ---------------------------------------------------------------------------

loc_4080BF:				; CODE XREF: sub_407BF2+4EBj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_4080D7:				; CODE XREF: sub_407BF2+4CBj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_4080BF

loc_4080DF:				; CODE XREF: sub_407BF2+4C2j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	loc_4081B1
; ---------------------------------------------------------------------------

loc_4080F1:				; CODE XREF: sub_407BF2+4BCj
		cmp	[ebp+arg_C], 0
		jz	short loc_408135
		cmp	[ebp+var_24], 0
		jz	short loc_408126
		mov	[ebp+var_10], 0
		jmp	short loc_40811E
; ---------------------------------------------------------------------------

loc_408106:				; CODE XREF: sub_407BF2+532j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_40811E:				; CODE XREF: sub_407BF2+512j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_408106

loc_408126:				; CODE XREF: sub_407BF2+509j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_4081B1
; ---------------------------------------------------------------------------

loc_408135:				; CODE XREF: sub_407BF2+503j
		cmp	[ebp+var_28], 7Fh
		jbe	short loc_40815E
		cmp	[ebp+var_28], 0FFh
		ja	short loc_40815E
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_4081B1
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_4081B1
; ---------------------------------------------------------------------------

loc_40815E:				; CODE XREF: sub_407BF2+547j
					; sub_407BF2+550j
		cmp	[ebp+var_24], 0
		jz	short loc_4081A1
		mov	[ebp+var_10], 0
		jmp	short loc_408199
; ---------------------------------------------------------------------------

loc_40816D:				; CODE XREF: sub_407BF2+5ADj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_408199:				; CODE XREF: sub_407BF2+579j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_40816D

loc_4081A1:				; CODE XREF: sub_407BF2+570j
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0

loc_4081B1:				; CODE XREF: sub_407BF2+9Dj
					; sub_407BF2+20Fj ...
		add	[ebp+var_18], 1
		sub	[ebp+var_2C], 1

loc_4081B9:				; CODE XREF: sub_407BF2+45j
		cmp	[ebp+var_2C], 0
		jnz	loc_407C3C
		cmp	[ebp+var_20], 0
		jnz	short loc_4081E5
		mov	eax, [ebp+var_1C]
		add	eax, 1
		mov	[esp+88h+Dest],	eax ; size_t
		call	sub_402482
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax
		jmp	loc_407C17
; ---------------------------------------------------------------------------

loc_4081E5:				; CODE XREF: sub_407BF2+5D5j
		cmp	[ebp+arg_C], 0
		jz	loc_4083BD
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	edx, ds:dword_40D22C
		mov	eax, off_40A104
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	edx ; dword_40D22C
		sub	esp, 8
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0FFFFFFFFh
		jnz	short loc_40825F
		mov	eax, off_40A104
		mov	[esp+88h+var_80], 1
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	sub_407540
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_40259D
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_4083C8
		jmp	locret_4083C6
; ---------------------------------------------------------------------------

loc_40825F:				; CODE XREF: sub_407BF2+625j
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		sub	eax, 1
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_44], eax
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_50]
		mov	[ebp+var_5C], eax
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_5C]
		mul	edx
		mov	eax, edx
		shr	eax, 2
		cmp	eax, [ebp+var_1C]
		jz	short loc_4082C3
		mov	[esp+88h+var_80], offset aDo_utf8_to_nat ; "do_utf8_to_native"
		mov	[esp+88h+Format], 28Ch
		mov	[esp+88h+Dest],	offset a____Dirmngr1_2 ; "../../dirmngr-1.1.1/jnlib/utf8conv.c"
		call	sub_405EF4
; ---------------------------------------------------------------------------

loc_4082C3:				; CODE XREF: sub_407BF2+6B3j
		mov	eax, [ebp+var_50]
		mov	[esp+88h+Dest],	eax ; size_t
		call	sub_402482
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_48]
		mov	[ebp+var_34], eax
		mov	edx, ds:dword_40D230
		lea	eax, [ebp+var_50]
		mov	[esp+88h+var_78], eax
		lea	eax, [ebp+var_48]
		mov	[esp+88h+var_7C], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+88h+var_80], eax
		lea	eax, [ebp+var_44]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	edx ; dword_40D230
		sub	esp, 14h
		cmp	eax, 0FFFFFFFFh
		jnz	loc_408396
		mov	eax, ds:dword_40D238
		test	eax, eax
		jnz	short loc_408349
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+88h+Dest],	eax ; int
		call	strerror
		mov	edx, off_40A104
		mov	[esp+88h+var_7C], eax
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_405D3B

loc_408349:				; CODE XREF: sub_407BF2+722j
		mov	ds:dword_40D238, 1
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_40259D
		mov	[ebp+var_20], 0
		mov	eax, [ebp+var_34]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_40259D
		mov	[esp+88h+var_7C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_407BF2
		mov	[ebp+var_34], eax
		jmp	short loc_4083A7
; ---------------------------------------------------------------------------

loc_408396:				; CODE XREF: sub_407BF2+715j
		mov	eax, [ebp+var_48]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_40259D

loc_4083A7:				; CODE XREF: sub_407BF2+7A2j
		mov	edx, ds:dword_40D234
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	edx ; dword_40D234
		sub	esp, 4
		mov	eax, [ebp+var_34]
		jmp	short locret_4083C6
; ---------------------------------------------------------------------------

loc_4083BD:				; CODE XREF: sub_407BF2+5F7j
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]

locret_4083C6:				; CODE XREF: sub_407BF2+668j
					; sub_407BF2+7C9j
		leave
		retn
sub_407BF2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4083C8	proc near		; CODE XREF: sub_4068B2+50p
					; sub_407BF2+663p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_40D228
		mov	[esp+18h+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_407BF2
		leave
		retn
sub_4083C8	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_40742E
		test	eax, eax
		jz	short loc_408408
		mov	eax, 0FFFFFFFFh
		jmp	short locret_408420
; ---------------------------------------------------------------------------

loc_408408:				; CODE XREF: .text:004083FFj
		mov	edx, ds:dword_40D22C
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	edx ; dword_40D22C
		sub	esp, 8

locret_408420:				; CODE XREF: .text:00408406j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_40742E
		test	eax, eax
		jz	short loc_408438
		mov	eax, 0
		jmp	short locret_408465
; ---------------------------------------------------------------------------

loc_408438:				; CODE XREF: .text:0040842Fj
		mov	edx, ds:dword_40D230
		mov	eax, [ebp+18h]
		mov	[esp+10h], eax
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	edx ; dword_40D230
		sub	esp, 14h

locret_408465:				; CODE XREF: .text:00408436j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_40742E
		test	eax, eax
		jz	short loc_40847D
		mov	eax, 0
		jmp	short locret_40848E
; ---------------------------------------------------------------------------

loc_40847D:				; CODE XREF: .text:00408474j
		mov	edx, ds:dword_40D234
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	edx ; dword_40D234
		sub	esp, 4

locret_40848E:				; CODE XREF: .text:0040847Bj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408490(int, char *Format, int)
sub_408490	proc near		; CODE XREF: sub_4086CF+1Ap

Str		= dword	ptr -38h
Val		= dword	ptr -34h
Radix		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
EndPtr		= dword	ptr -14h
var_10		= dword	ptr -10h
Size		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Format		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+Format]
		mov	[ebp+EndPtr], eax
		mov	eax, [ebp+Format]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+Size], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		jmp	loc_40867C
; ---------------------------------------------------------------------------

loc_4084CF:				; CODE XREF: sub_408490+1F4j
		mov	eax, [ebp+EndPtr]
		movzx	edx, byte ptr [eax]
		cmp	dl, 25h
		setz	dl
		add	eax, 1
		mov	[ebp+EndPtr], eax
		test	dl, dl
		jz	loc_40867C
		jmp	short loc_4084F4
; ---------------------------------------------------------------------------

loc_4084EB:				; CODE XREF: sub_408490+7Fj
		mov	eax, [ebp+EndPtr]
		add	eax, 1
		mov	[ebp+EndPtr], eax

loc_4084F4:				; CODE XREF: sub_408490+59j
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Val], eax ; Val
		mov	[esp+38h+Str], offset a0 ; "-+ #0"
		call	strchr
		test	eax, eax
		jnz	short loc_4084EB
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	short loc_40853D
		mov	eax, [ebp+EndPtr]
		add	eax, 1
		mov	[ebp+EndPtr], eax
		mov	eax, [ebp+var_18]
		lea	edx, [eax+4]
		mov	[ebp+var_18], edx
		mov	eax, [eax]
		mov	edx, eax
		sar	edx, 1Fh
		xor	eax, edx
		sub	eax, edx
		add	[ebp+Size], eax
		jmp	short loc_40855F
; ---------------------------------------------------------------------------

loc_40853D:				; CODE XREF: sub_408490+89j
		mov	eax, [ebp+EndPtr]
		mov	[esp+38h+Radix], 0Ah ; Radix
		lea	edx, [ebp+EndPtr]
		mov	[esp+38h+Val], edx ; EndPtr
		mov	[esp+38h+Str], eax ; Str
		call	strtoul
		mov	edx, [ebp+Size]
		add	eax, edx
		mov	[ebp+Size], eax

loc_40855F:				; CODE XREF: sub_408490+ABj
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Eh
		jnz	short loc_4085CD
		mov	eax, [ebp+EndPtr]
		add	eax, 1
		mov	[ebp+EndPtr], eax
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	short loc_40859E
		mov	eax, [ebp+EndPtr]
		add	eax, 1
		mov	[ebp+EndPtr], eax
		mov	eax, [ebp+var_18]
		lea	edx, [eax+4]
		mov	[ebp+var_18], edx
		mov	eax, [eax]
		mov	edx, eax
		sar	edx, 1Fh
		xor	eax, edx
		sub	eax, edx
		add	[ebp+Size], eax
		jmp	short loc_4085CD
; ---------------------------------------------------------------------------

loc_40859E:				; CODE XREF: sub_408490+EAj
		mov	eax, [ebp+EndPtr]
		mov	[esp+38h+Radix], 0Ah ; Radix
		lea	edx, [ebp+EndPtr]
		mov	[esp+38h+Val], edx ; EndPtr
		mov	[esp+38h+Str], eax ; Str
		call	strtoul
		mov	edx, [ebp+Size]
		add	eax, edx
		mov	[ebp+Size], eax
		jmp	short loc_4085CD
; ---------------------------------------------------------------------------

loc_4085C2:				; CODE XREF: sub_408490+159j
		mov	eax, [ebp+EndPtr]
		add	eax, 1
		mov	[ebp+EndPtr], eax
		jmp	short loc_4085CE
; ---------------------------------------------------------------------------

loc_4085CD:				; CODE XREF: sub_408490+D7j
					; sub_408490+10Cj ...
		nop

loc_4085CE:				; CODE XREF: sub_408490+13Bj
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Val], eax ; Val
		mov	[esp+38h+Str], offset aHll ; "hlL"
		call	strchr
		test	eax, eax
		jnz	short loc_4085C2
		add	[ebp+Size], 1Eh
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 45h	; switch 52 cases
		cmp	eax, 33h
		ja	short loc_408673 ; jumptable 00408607 default case
		mov	eax, ds:off_40C27C[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_408609:				; CODE XREF: sub_408490+177j
					; DATA XREF: .rdata:off_40C27Co
		mov	eax, [ebp+var_18] ; jumptable 00408607 cases 88,99,100,105,111,117,120
		add	eax, 4
		mov	[ebp+var_18], eax
		jmp	short loc_408673 ; jumptable 00408607 default case
; ---------------------------------------------------------------------------

loc_408614:				; CODE XREF: sub_408490+177j
					; DATA XREF: .rdata:off_40C27Co
		mov	eax, [ebp+var_18] ; jumptable 00408607 cases 69,71,101-103
		add	eax, 8
		mov	[ebp+var_18], eax
		add	[ebp+Size], 133h
		jmp	short loc_408673 ; jumptable 00408607 default case
; ---------------------------------------------------------------------------

loc_408626:				; CODE XREF: sub_408490+177j
					; DATA XREF: .rdata:off_40C27Co
		mov	eax, [ebp+var_18] ; jumptable 00408607 case 115
		lea	edx, [eax+4]
		mov	[ebp+var_18], edx
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_408663
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+Size]
		add	eax, edx
		mov	[ebp+Size], eax
		jmp	short loc_408673 ; jumptable 00408607 default case
; ---------------------------------------------------------------------------

loc_408663:				; CODE XREF: sub_408490+1A8j
		add	[ebp+Size], 19h
		jmp	short loc_408673 ; jumptable 00408607 default case
; ---------------------------------------------------------------------------

loc_408669:				; CODE XREF: sub_408490+177j
					; DATA XREF: .rdata:off_40C27Co
		mov	eax, [ebp+var_18] ; jumptable 00408607 cases 110,112
		add	eax, 4
		mov	[ebp+var_18], eax
		nop

loc_408673:				; CODE XREF: sub_408490+16Ej
					; sub_408490+177j ...
		mov	eax, [ebp+EndPtr] ; jumptable 00408607 default case
		add	eax, 1
		mov	[ebp+EndPtr], eax

loc_40867C:				; CODE XREF: sub_408490+3Aj
					; sub_408490+53j
		mov	eax, [ebp+EndPtr]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4084CF
		mov	eax, [ebp+Size]
		mov	[esp+38h+Str], eax ; Size
		call	malloc
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4086C4
		mov	eax, [ebp+arg_8]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+38h+Radix], edx ; Args
		mov	edx, [ebp+Format]
		mov	[esp+38h+Val], edx ; Format
		mov	[esp+38h+Str], eax ; Dest
		call	vsprintf
		jmp	short loc_4086C9
; ---------------------------------------------------------------------------

loc_4086C4:				; CODE XREF: sub_408490+213j
		mov	eax, 0

loc_4086C9:				; CODE XREF: sub_408490+232j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_408490	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4086CF(int, char *, int)
sub_4086CF	proc near		; CODE XREF: .text:00408712p

var_18		= dword	ptr -18h
Format		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		lea	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_408490
		leave
		retn
sub_4086CF	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+10h]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4086CF
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION ber_free]
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:0040F024o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_408750
		cmp	eax, 3
		jz	short loc_408750
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_408750:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_409940
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_401180+113p
					; DATA XREF: .rdata:off_40C388o ...

lpLibFileName	= dword	ptr -1Ch
lpProcName	= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		mov	edx, ds:_winmajor
		mov	eax, [esp+1Ch+arg_4]
		cmp	dword ptr [edx], 3
		jbe	short loc_4087C4
		cmp	dword_40A118, 2
		jz	short loc_4087A6
		mov	dword_40A118, 2

loc_4087A6:				; CODE XREF: TlsCallback_0+1Aj
		cmp	eax, 2
		jz	loc_4088B3
		cmp	eax, 1
		jz	loc_408852

loc_4087B8:				; CODE XREF: TlsCallback_0+EEj
					; TlsCallback_0+13Ej
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_4087C4:				; CODE XREF: TlsCallback_0+11j
		mov	ds:dword_40D678, 1
		mov	[esp+1Ch+lpLibFileName], offset	LibFileName ; "mingwm10.dll"
		call	ds:LoadLibraryA
		sub	esp, 4
		test	eax, eax
		mov	ds:hLibModule, eax
		jz	loc_4088E3
		mov	ebx, ds:GetProcAddress
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_rem ; "__mingwthr_remove_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	ds:dword_40D674, eax
		mov	eax, ds:hLibModule
		sub	esp, 8
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_key ; "__mingwthr_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	edx, ds:hLibModule
		sub	esp, 8
		test	edx, edx
		mov	ds:dword_40D670, eax
		jz	loc_4088E3
		mov	ecx, ds:dword_40D674
		test	ecx, ecx
		jz	short loc_408873
		test	eax, eax
		jz	short loc_408873
		mov	dword_40A118, 1
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_408852:				; CODE XREF: TlsCallback_0+32j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+lpProcName], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpLibFileName], eax
		call	sub_409940
		jmp	loc_4087B8
; ---------------------------------------------------------------------------

loc_408873:				; CODE XREF: TlsCallback_0+B6j
					; TlsCallback_0+BAj
		mov	ds:dword_40D670, 0
		mov	ds:dword_40D674, 0
		mov	[esp+1Ch+lpLibFileName], edx ; hLibModule
		call	ds:FreeLibrary
		sub	esp, 4

loc_408893:				; CODE XREF: TlsCallback_0+177j
		mov	ds:hLibModule, 0
		mov	eax, 1
		mov	dword_40A118, 0
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_4088B3:				; CODE XREF: TlsCallback_0+29j
		mov	ebx, offset dword_40F030
		cmp	ebx, offset dword_40F030
		jz	loc_4087B8

loc_4088C4:				; CODE XREF: TlsCallback_0+155j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_4088CC
		call	eax

loc_4088CC:				; CODE XREF: TlsCallback_0+148j
		add	ebx, 4
		cmp	ebx, offset dword_40F030
		jnz	short loc_4088C4
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_4088E3:				; CODE XREF: TlsCallback_0+65j
					; TlsCallback_0+A8j
		mov	ds:dword_40D670, 0
		mov	ds:dword_40D674, 0
		jmp	short loc_408893
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_408910	proc near		; DATA XREF: .CRT:0040F014o
		mov	eax, ds:__lconv_init
		jmp	eax
sub_408910	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_408920	proc near		; CODE XREF: sub_408940+10p
					; sub_408940+36p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_408920	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_408930	proc near		; CODE XREF: sub_401060+59p
					; sub_408940+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_408930	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_408940(_onexit_t)
sub_408940	proc near		; CODE XREF: sub_408A00+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_40D680
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_408920
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_14], eax
		jz	loc_4089E0
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_40D680
		mov	[esp+2Ch+Func],	eax
		call	sub_408920
		mov	[esp+2Ch+var_14], eax
		mov	eax, ds:dword_40D67C
		mov	[esp+2Ch+Func],	eax
		call	sub_408920
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_10], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_408930
		mov	ds:dword_40D680, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_408930
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_40D67C, eax
		call	_unlock
		add	esp, 28h
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4089E0:				; CODE XREF: sub_408940+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_408940	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_408A00(_onexit_t)
sub_408A00	proc near		; CODE XREF: sub_409620-27p
					; sub_409EF0+12p

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_408940
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_408A00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LONG __stdcall TopLevelExceptionFilter(struct	_EXCEPTION_POINTERS *ExceptionInfo)
TopLevelExceptionFilter	proc near	; DATA XREF: sub_401180+11Do

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
ExceptionInfo	= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 24h
		mov	ebx, [esp+2Ch+ExceptionInfo]
		mov	eax, [ebx]
		mov	eax, [eax]
		cmp	eax, 0C0000091h
		ja	short loc_408A77
		cmp	eax, 0C000008Dh
		jb	short loc_408AA4

loc_408A3B:				; CODE XREF: TopLevelExceptionFilter+6Aj
		mov	esi, 1

loc_408A40:				; CODE XREF: TopLevelExceptionFilter+C7j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 8
		call	signal
		cmp	eax, 1
		jz	loc_408B70
		test	eax, eax
		jz	short loc_408A8C
		mov	[esp+2Ch+var_2C], 8
		call	eax
		mov	eax, 0FFFFFFFFh

loc_408A6F:				; CODE XREF: TopLevelExceptionFilter+120j
					; TopLevelExceptionFilter+13Ej	...
		add	esp, 24h
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_408A77:				; CODE XREF: TopLevelExceptionFilter+12j
		cmp	eax, 0C0000094h
		jz	short loc_408AE5
		cmp	eax, 0C0000096h
		jz	short loc_408AB2
		cmp	eax, 0C0000093h
		jz	short loc_408A3B

loc_408A8C:				; CODE XREF: TopLevelExceptionFilter+3Fj
					; TopLevelExceptionFilter+90j ...
		mov	eax, ds:dword_40D2C8
		test	eax, eax
		jz	loc_408B63
		mov	[esp+2Ch+ExceptionInfo], ebx
		add	esp, 24h
		pop	ebx
		pop	esi
		jmp	eax
; ---------------------------------------------------------------------------

loc_408AA4:				; CODE XREF: TopLevelExceptionFilter+19j
		cmp	eax, 0C0000005h
		jz	short loc_408AF0
		cmp	eax, 0C000001Dh
		jnz	short loc_408A8C

loc_408AB2:				; CODE XREF: TopLevelExceptionFilter+63j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 4
		call	signal
		cmp	eax, 1
		jz	short loc_408B27
		test	eax, eax
		jz	short loc_408A8C
		mov	[esp+2Ch+var_2C], 4
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_408AE5:				; CODE XREF: TopLevelExceptionFilter+5Cj
		xor	esi, esi
		jmp	loc_408A40
; ---------------------------------------------------------------------------
		align 10h

loc_408AF0:				; CODE XREF: TopLevelExceptionFilter+89j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		cmp	eax, 1
		jz	short loc_408B45
		test	eax, eax
		jz	loc_408A8C
		mov	[esp+2Ch+var_2C], 0Bh
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_408B27:				; CODE XREF: TopLevelExceptionFilter+A9j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 4
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_408A6F
; ---------------------------------------------------------------------------

loc_408B45:				; CODE XREF: TopLevelExceptionFilter+E7j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_408A6F
; ---------------------------------------------------------------------------

loc_408B63:				; CODE XREF: TopLevelExceptionFilter+73j
		xor	eax, eax
		jmp	loc_408A6F
; ---------------------------------------------------------------------------
		align 10h

loc_408B70:				; CODE XREF: TopLevelExceptionFilter+37j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 8
		call	signal
		test	esi, esi
		mov	eax, 0FFFFFFFFh
		jz	loc_408A6F
		mov	[esp+2Ch+var_10], eax
		call	sub_409590
		mov	eax, [esp+2Ch+var_10]
		jmp	loc_408A6F
TopLevelExceptionFilter	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 3Ch
		mov	eax, ds:dword_40D2CC
		fld	qword ptr [esp+48h]
		fld	qword ptr [esp+50h]
		fld	qword ptr [esp+58h]
		test	eax, eax
		jz	short loc_408BF1
		fxch	st(2)
		mov	edx, [esp+40h]
		fstp	qword ptr [esp+18h]
		fstp	qword ptr [esp+20h]
		fstp	qword ptr [esp+28h]
		mov	[esp+10h], edx
		mov	edx, [esp+44h]
		mov	[esp+14h], edx
		lea	edx, [esp+10h]
		mov	[esp], edx
		call	eax ; dword_40D2CC
		jmp	short loc_408BF7
; ---------------------------------------------------------------------------

loc_408BF1:				; CODE XREF: .text:00408BC6j
		fstp	st
		fstp	st
		fstp	st

loc_408BF7:				; CODE XREF: .text:00408BEFj
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_408C00	proc near		; CODE XREF: sub_401060+F7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ds:dword_40D2CC, eax
		jmp	__setusermatherr
sub_408C00	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_408C10	proc near		; DATA XREF: sub_401060:loc_401150o

File		= dword	ptr -3Ch
Format		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= qword	ptr -2Ch
var_24		= qword	ptr -24h
var_1C		= qword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 3Ch
		mov	edx, offset aUnknownError ; "Unknown error"
		mov	eax, [esp+3Ch+arg_0]
		mov	ecx, [eax]
		sub	ecx, 1
		cmp	ecx, 5
		ja	short loc_408C2D
		mov	edx, ds:off_40C4A8[ecx*4]

loc_408C2D:				; CODE XREF: sub_408C10+14j
		fld	qword ptr [eax+18h]
		fstp	[esp+3Ch+var_1C]
		fld	qword ptr [eax+10h]
		fstp	[esp+3Ch+var_24]
		fld	qword ptr [eax+8]
		fstp	[esp+3Ch+var_2C]
		mov	eax, [eax+4]
		mov	[esp+3Ch+var_34], edx
		mov	[esp+3Ch+Format], offset a_matherrSInSGG ; "_matherr():	%s in %s(%g, %g)  (retval=%"...
		mov	[esp+3Ch+var_30], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+3Ch+File],	eax ; File
		call	fprintf
		xor	eax, eax
		add	esp, 3Ch
		retn
sub_408C10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_408C70	proc near		; CODE XREF: sub_401060+75p
		xor	eax, eax
		retn
sub_408C70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_408C80(char *Format, char ArgList)
sub_408C80	proc near		; CODE XREF: sub_408CE0+1DDp
					; sub_408CE0+204p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aMingwW64Runtim ;	"Mingw-w64 runtime failure:\n"
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_408C80	endp

; ---------------------------------------------------------------------------
		jmp	short sub_408CE0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_408CE0(size_t Size)
sub_408CE0	proc near		; CODE XREF: .text:00408CD1j
					; sub_408F20+B8p ...

lpAddress	= dword	ptr -7Ch
lpBuffer	= dword	ptr -78h
dwLength	= dword	ptr -74h
lpflOldProtect	= dword	ptr -70h
var_64		= dword	ptr -64h
Src		= dword	ptr -60h
var_58		= _MEMORY_BASIC_INFORMATION ptr	-58h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h

		push	ebp
		mov	ebp, ecx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 6Ch
		mov	ecx, ds:dword_40D2D8
		mov	[esp+7Ch+Src], edx
		test	ecx, ecx
		jle	loc_408EC2
		mov	eax, ds:dword_40D2D4
		xor	esi, esi

loc_408D04:				; CODE XREF: sub_408CE0+41j
		mov	edx, [eax+4]
		cmp	ebx, edx
		jb	short loc_408D19
		mov	edi, [eax+8]
		add	edx, [edi+8]
		cmp	ebx, edx
		jb	loc_408DF0

loc_408D19:				; CODE XREF: sub_408CE0+29j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jnz	short loc_408D04

loc_408D23:				; CODE XREF: sub_408CE0+1E4j
		mov	[esp+7Ch+lpAddress], ebx
		call	sub_4092E0
		test	eax, eax
		mov	edi, eax
		jz	loc_408EE9
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_40D2D4
		shl	edx, 2
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		mov	[esp+7Ch+var_64], edx
		call	sub_4093C0
		mov	edx, [esp+7Ch+var_64]
		add	eax, [edi+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+7Ch+Buffer]
		mov	esi, ds:VirtualQuery
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_40D2D4
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+7Ch+var_64]
		jz	loc_408EC9
		mov	eax, [esp+7Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	loc_408E71

loc_408D9F:				; CODE XREF: sub_408CE0+194j
					; sub_408CE0+1C6j
		add	ds:dword_40D2D8, 1

loc_408DA6:				; CODE XREF: sub_408CE0+116j
		lea	eax, [esp+7Ch+var_58]
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	[esp+7Ch+lpAddress], ebx ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_408EF9
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 4
		jnz	short loc_408DF8

loc_408DCF:				; CODE XREF: sub_408CE0+11Bj
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy

loc_408DE3:				; CODE XREF: sub_408CE0+162j
					; sub_408CE0+167j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_408DF0:				; CODE XREF: sub_408CE0+33j
		mov	esi, ds:VirtualQuery
		jmp	short loc_408DA6
; ---------------------------------------------------------------------------

loc_408DF8:				; CODE XREF: sub_408CE0+EDj
		cmp	eax, 40h
		jz	short loc_408DCF
		mov	eax, [esp+7Ch+var_58.RegionSize]
		lea	edi, [esp+7Ch+flOldProtect]
		mov	esi, ds:VirtualProtect
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 40h
		jz	short loc_408DE3
		cmp	eax, 4
		jz	short loc_408DE3
		mov	eax, [esp+7Ch+flOldProtect]
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], eax	; flNewProtect
		mov	eax, [esp+7Ch+var_58.RegionSize]
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_408E71:				; CODE XREF: sub_408CE0+B9j
		cmp	eax, 40h
		jz	loc_408D9F
		mov	eax, [esp+7Ch+Buffer.RegionSize]
		add	edx, ds:dword_40D2D4
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+Buffer.BaseAddress]
		mov	[esp+7Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		test	eax, eax
		jnz	loc_408D9F
		call	ds:GetLastError
		mov	[esp+7Ch+lpAddress], offset aVirtualprotect ; "	 VirtualProtect	failed with code 0x%x"
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_408C80
; ---------------------------------------------------------------------------

loc_408EC2:				; CODE XREF: sub_408CE0+17j
		xor	esi, esi
		jmp	loc_408D23
; ---------------------------------------------------------------------------

loc_408EC9:				; CODE XREF: sub_408CE0+ACj
		mov	eax, ds:dword_40D2D4
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+dwLength], eax
		mov	eax, [edi+8]
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_408C80
; ---------------------------------------------------------------------------

loc_408EE9:				; CODE XREF: sub_408CE0+4Fj
		mov	[esp+7Ch+lpBuffer], ebx	; ArgList
		mov	[esp+7Ch+lpAddress], offset aAddressPHasNoI ; "Address %p has no image-section"
		call	sub_408C80
; ---------------------------------------------------------------------------

loc_408EF9:				; CODE XREF: sub_408CE0+E0j
		mov	[esp+7Ch+dwLength], ebx
		mov	[esp+7Ch+lpBuffer], 1Ch	; ArgList
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		call	sub_408C80
sub_408CE0	endp

; ---------------------------------------------------------------------------
		db 0EBh	; 
		db  0Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408F20	proc near		; CODE XREF: sub_401180:loc_401298p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
var_20		= dword	ptr -20h
flOldProtect	= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_40D2D0
		test	eax, eax
		jz	short loc_408F40

loc_408F32:				; CODE XREF: sub_408F20+66j
					; sub_408F20+96j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_408F40:				; CODE XREF: sub_408F20+10j
		mov	ds:dword_40D2D0, 1
		call	sub_409320
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_4099E0
		mov	ds:dword_40D2D8, 0
		sub	esp, eax
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_40D2D4, eax
		mov	eax, offset dword_40C638
		sub	eax, offset dword_40C638
		cmp	eax, 7
		jle	short loc_408F32
		cmp	eax, 0Bh
		mov	ebx, offset dword_40C638
		jle	loc_409080
		mov	eax, ds:dword_40C638
		test	eax, eax
		jnz	short loc_408FB0
		mov	eax, ds:dword_40C63C
		test	eax, eax
		jz	loc_40906C
		lea	esi, [esi+0]

loc_408FB0:				; CODE XREF: sub_408F20+7Dj
					; sub_408F20+164j ...
		cmp	ebx, offset dword_40C638
		jnb	loc_408F32
		mov	esi, 400000h

loc_408FC1:				; CODE XREF: sub_408F20+C3j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		lea	edx, [ebp+flOldProtect]
		call	sub_408CE0
		cmp	ebx, offset dword_40C638
		jb	short loc_408FC1

loc_408FE5:				; CODE XREF: sub_408F20+24Bj
		mov	ecx, ds:dword_40D2D8
		test	ecx, ecx
		jle	loc_408F32
		xor	ebx, ebx
		xor	esi, esi
		mov	edi, ds:VirtualQuery
		jmp	short loc_409012
; ---------------------------------------------------------------------------
		align 10h

loc_409000:				; CODE XREF: sub_408F20+FDj
					; sub_408F20+14Aj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_40D2D8
		jge	loc_408F32

loc_409012:				; CODE XREF: sub_408F20+DDj
		mov	eax, ds:dword_40D2D4
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_409000
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	edi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_409192
		lea	eax, [ebp+flOldProtect]
		mov	[esp+58h+lpflOldProtect], eax ;	lpflOldProtect
		mov	eax, ds:dword_40D2D4
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_409000
; ---------------------------------------------------------------------------

loc_40906C:				; CODE XREF: sub_408F20+86j
		mov	eax, ds:dword_40C640
		test	eax, eax
		jnz	short loc_409095
		mov	ebx, offset dword_40C644
		lea	esi, [esi+0]

loc_409080:				; CODE XREF: sub_408F20+70j
		mov	edi, [ebx]
		test	edi, edi
		jnz	loc_408FB0
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	loc_408FB0

loc_409095:				; CODE XREF: sub_408F20+153j
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_4091B5
		add	ebx, 0Ch
		cmp	ebx, offset dword_40C638
		jnb	loc_408F32

loc_4090B0:				; CODE XREF: sub_408F20+245j
		movzx	edx, byte ptr [ebx+8]
		mov	eax, 400000h
		mov	ecx, [ebx]
		add	eax, [ebx+4]
		cmp	edx, 10h
		mov	esi, [ecx+400000h]
		jz	short loc_40910A
		cmp	edx, 20h
		jz	short loc_409140
		cmp	edx, 8
		jz	short loc_4090EA
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		mov	[ebp+var_20], 0
		call	sub_408C80
; ---------------------------------------------------------------------------

loc_4090EA:				; CODE XREF: sub_408F20+1B1j
		movzx	edi, byte ptr [eax]
		test	edi, 80h
		jz	short loc_409115
		or	edi, 0FFFFFF00h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi
		jmp	short loc_409131
; ---------------------------------------------------------------------------

loc_40910A:				; CODE XREF: sub_408F20+1A7j
		movzx	edi, word ptr [eax]
		test	edi, 8000h
		jnz	short loc_409170

loc_409115:				; CODE XREF: sub_408F20+1D3j
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		cmp	edx, 10h
		mov	[ebp+var_20], esi
		jz	short loc_409183
		cmp	edx, 20h
		jz	short loc_40914F
		cmp	edx, 8
		jnz	short loc_40915C

loc_409131:				; CODE XREF: sub_408F20+1E8j
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_20]
		call	sub_408CE0
		jmp	short loc_40915C
; ---------------------------------------------------------------------------

loc_409140:				; CODE XREF: sub_408F20+1ACj
		mov	edx, [eax]
		sub	edx, ecx
		sub	edx, 400000h
		add	edx, esi
		mov	[ebp+var_20], edx

loc_40914F:				; CODE XREF: sub_408F20+20Aj
		mov	ecx, 4		; Size
		lea	edx, [ebp+var_20]
		call	sub_408CE0

loc_40915C:				; CODE XREF: sub_408F20+20Fj
					; sub_408F20+21Ej ...
		add	ebx, 0Ch
		cmp	ebx, offset dword_40C638
		jb	loc_4090B0
		jmp	loc_408FE5
; ---------------------------------------------------------------------------

loc_409170:				; CODE XREF: sub_408F20+1F3j
		or	edi, 0FFFF0000h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi

loc_409183:				; CODE XREF: sub_408F20+205j
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_20]
		call	sub_408CE0
		jmp	short loc_40915C
; ---------------------------------------------------------------------------

loc_409192:				; CODE XREF: sub_408F20+11Bj
		add	ebx, ds:dword_40D2D4
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_408C80
; ---------------------------------------------------------------------------

loc_4091B5:				; CODE XREF: sub_408F20+17Bj
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_408C80
sub_408F20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4091D0	proc near		; CODE XREF: .text:00409271p
					; sub_4092E0+Ap ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	eax, eax
		cmp	word ptr [edx],	5A4Dh
		jz	short loc_4091E0

locret_4091DD:				; CODE XREF: sub_4091D0+19j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_4091E0:				; CODE XREF: sub_4091D0+Bj
		add	edx, [edx+3Ch]
		cmp	dword ptr [edx], 4550h
		jnz	short locret_4091DD
		xor	eax, eax
		cmp	word ptr [edx+18h], 10Bh
		setz	al
		retn
sub_4091D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409200	proc near		; CODE XREF: sub_4092E0+2Bp
					; .text:00409424p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		xor	eax, eax
		push	ebx
		mov	edx, [esp+8+arg_0]
		mov	ebx, [esp+8+arg_4]
		add	edx, [edx+3Ch]
		movzx	esi, word ptr [edx+6]
		movzx	ecx, word ptr [edx+14h]
		test	esi, esi
		jz	short loc_40923E
		movzx	ecx, cx
		lea	eax, [edx+ecx+18h]
		xor	edx, edx

loc_409224:				; CODE XREF: sub_409200+3Aj
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_409232
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_40923E

loc_409232:				; CODE XREF: sub_409200+29j
		add	edx, 1
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_409224
		xor	eax, eax

loc_40923E:				; CODE XREF: sub_409200+19j
					; sub_409200+30j
		pop	ebx
		pop	esi
		retn
sub_409200	endp

; ---------------------------------------------------------------------------
		jmp	short loc_409250
; ---------------------------------------------------------------------------
		align 10h

loc_409250:				; CODE XREF: .text:00409241j
		push	ebp
		push	edi
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 1Ch
		mov	edi, [esp+30h]
		mov	[esp], edi
		call	strlen
		cmp	eax, 8
		ja	short loc_4092C3
		mov	dword ptr [esp], 400000h
		call	sub_4091D0
		test	eax, eax
		jz	short loc_4092C3
		mov	eax, ds:40003Ch
		movzx	ebp, word ptr [eax+400006h]
		movzx	edx, word ptr [eax+400014h]
		add	eax, 400000h
		test	ebp, ebp
		jz	short loc_4092C3
		movzx	edx, dx
		xor	esi, esi
		lea	ebx, [eax+edx+18h]
		jmp	short loc_4092AB
; ---------------------------------------------------------------------------

loc_4092A1:				; CODE XREF: .text:004092C1j
		add	esi, 1
		add	ebx, 28h
		cmp	esi, ebp
		jnb	short loc_4092D0

loc_4092AB:				; CODE XREF: .text:0040929Fj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], edi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jnz	short loc_4092A1

loc_4092C3:				; CODE XREF: .text:00409268j
					; .text:00409278j ...
		add	esp, 1Ch
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4092D0:				; CODE XREF: .text:004092A9j
		add	esp, 1Ch
		xor	ebx, ebx
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4092E0	proc near		; CODE XREF: sub_408CE0+46p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	[esp+8+var_8], 400000h
		call	sub_4091D0
		mov	edx, eax
		xor	eax, eax
		test	edx, edx
		jz	short loc_409310
		mov	eax, [esp+8+arg_0]
		mov	[esp+8+var_8], 400000h
		sub	eax, 400000h
		mov	[esp+8+var_4], eax
		call	sub_409200

loc_409310:				; CODE XREF: sub_4092E0+15j
		add	esp, 8
		retn
sub_4092E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409320	proc near		; CODE XREF: sub_408F20+2Ap

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_4091D0
		xor	edx, edx
		test	eax, eax
		jz	short loc_409341
		mov	eax, ds:40003Ch
		movzx	edx, word ptr [eax+400006h]

loc_409341:				; CODE XREF: sub_409320+13j
		mov	eax, edx
		add	esp, 4
		retn
sub_409320	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 4
		mov	dword ptr [esp], 400000h
		mov	ebx, [esp+10h]
		call	sub_4091D0
		xor	edx, edx
		test	eax, eax
		jz	short loc_4093A9
		mov	eax, ds:40003Ch
		movzx	ecx, word ptr [eax+400006h]
		movzx	esi, word ptr [eax+400014h]
		add	eax, 400000h
		test	ecx, ecx
		jz	short loc_4093A9
		movzx	esi, si
		lea	edx, [eax+esi+18h]
		xor	eax, eax

loc_409390:				; CODE XREF: .text:004093A5j
		test	byte ptr [edx+27h], 20h
		jz	short loc_40939D
		test	ebx, ebx
		jz	short loc_4093A9
		sub	ebx, 1

loc_40939D:				; CODE XREF: .text:00409394j
		add	eax, 1
		add	edx, 28h
		cmp	eax, ecx
		jb	short loc_409390
		xor	edx, edx

loc_4093A9:				; CODE XREF: .text:00409369j
					; .text:00409385j ...
		add	esp, 4
		mov	eax, edx
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_4093C0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4093C0	proc near		; CODE XREF: sub_408CE0+70p
					; .text:004093B1j

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_4091D0
		xor	edx, edx
		test	eax, eax
		mov	eax, 400000h
		cmovnz	edx, eax
		add	esp, 4
		mov	eax, edx
		retn
sub_4093C0	endp

; ---------------------------------------------------------------------------
		jmp	short loc_4093F0
; ---------------------------------------------------------------------------
		align 10h

loc_4093F0:				; CODE XREF: .text:004093E1j
		push	ebx
		xor	ebx, ebx
		sub	esp, 8
		mov	dword ptr [esp], 400000h
		call	sub_4091D0
		test	eax, eax
		jnz	short loc_409410

loc_409406:				; CODE XREF: .text:0040942Bj
		add	esp, 8
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_409410:				; CODE XREF: .text:00409404j
		mov	eax, [esp+10h]
		mov	dword ptr [esp], 400000h
		sub	eax, 400000h
		mov	[esp+4], eax
		call	sub_409200
		test	eax, eax
		jz	short loc_409406
		mov	ebx, [eax+24h]
		add	esp, 8
		not	ebx
		shr	ebx, 1Fh
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409440	proc near		; CODE XREF: sub_4094D0+1Ap

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	edi
		xor	edi, edi
		push	esi
		push	ebx
		sub	esp, 8
		mov	[esp+14h+var_14], 400000h
		mov	ebx, [esp+14h+arg_0]
		call	sub_4091D0
		test	eax, eax
		jz	short loc_4094B1
		mov	eax, ds:40003Ch
		mov	esi, [eax+400080h]
		test	esi, esi
		jz	short loc_4094B1
		mov	[esp+14h+var_10], esi
		mov	[esp+14h+var_14], 400000h
		call	sub_409200
		test	eax, eax
		jz	short loc_4094B1
		add	esi, 400000h
		jnz	short loc_409496
		jmp	short loc_4094B1
; ---------------------------------------------------------------------------
		align 10h

loc_409490:				; CODE XREF: sub_409440+66j
		sub	ebx, 1
		add	esi, 14h

loc_409496:				; CODE XREF: sub_409440+45j
		mov	edx, [esi+4]
		test	edx, edx
		jnz	short loc_4094A4
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_4094C0

loc_4094A4:				; CODE XREF: sub_409440+5Bj
		test	ebx, ebx
		jg	short loc_409490
		mov	edi, [esi+0Ch]
		add	edi, 400000h

loc_4094B1:				; CODE XREF: sub_409440+1Aj
					; sub_409440+29j ...
		add	esp, 8
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4094C0:				; CODE XREF: sub_409440+62j
		add	esp, 8
		xor	edi, edi
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_409440	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4094D0	proc near		; CODE XREF: sub_401180+132p

lpModuleName	= dword	ptr -1Ch

		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_40D2DC
		test	eax, eax
		jz	short loc_4094E2

loc_4094DD:				; CODE XREF: sub_4094D0+97j
					; sub_4094D0+B5j
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4094E2:				; CODE XREF: sub_4094D0+Bj
		xor	eax, eax

loc_4094E4:				; CODE XREF: sub_4094D0+82j
		mov	[esp+1Ch+lpModuleName],	eax
		lea	ebx, [eax+1]
		call	sub_409440
		test	eax, eax
		jz	short loc_409570
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_409500
		cmp	dl, 6Dh
		jnz	short loc_409550

loc_409500:				; CODE XREF: sub_4094D0+29j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_40950E
		cmp	dl, 73h
		jnz	short loc_409550

loc_40950E:				; CODE XREF: sub_4094D0+37j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_40951C
		cmp	dl, 76h
		jnz	short loc_409550

loc_40951C:				; CODE XREF: sub_4094D0+45j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_40952A
		cmp	dl, 63h
		jnz	short loc_409550

loc_40952A:				; CODE XREF: sub_4094D0+53j
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_409538
		cmp	dl, 72h
		jnz	short loc_409550

loc_409538:				; CODE XREF: sub_4094D0+61j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_409554
		cmp	dl, 74h
		jz	short loc_409554
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_409554
		xchg	ax, ax

loc_409550:				; CODE XREF: sub_4094D0+2Ej
					; sub_4094D0+3Cj ...
		mov	eax, ebx
		jmp	short loc_4094E4
; ---------------------------------------------------------------------------

loc_409554:				; CODE XREF: sub_4094D0+6Fj
					; sub_4094D0+74j ...
		mov	[esp+1Ch+lpModuleName],	eax ; lpModuleName
		call	ds:GetModuleHandleA
		sub	esp, 4
		test	eax, eax
		mov	ds:dword_40D2DC, eax
		jnz	loc_4094DD
		lea	esi, [esi+0]

loc_409570:				; CODE XREF: sub_4094D0+21j
		mov	[esp+1Ch+lpModuleName],	offset aMsvcrt_dll ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_40D2DC, eax
		jmp	loc_4094DD
sub_4094D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409590	proc near		; CODE XREF: sub_401180:loc_4012D8p
					; TopLevelExceptionFilter+175p
		fninit
		retn
sub_409590	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4095A0()
sub_4095A0	proc near		; DATA XREF: sub_409620:loc_4095F2o
		sub	esp, 0Ch
		mov	eax, off_40A114
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4095C7
		xchg	ax, ax

loc_4095B0:				; CODE XREF: sub_4095A0+25j
		call	eax
		mov	eax, off_40A114
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_40A114, edx
		test	eax, eax
		jnz	short loc_4095B0

loc_4095C7:				; CODE XREF: sub_4095A0+Cj
		add	esp, 0Ch
		retn
sub_4095A0	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_409620

loc_4095D0:				; CODE XREF: sub_409620+1Aj
		push	ebx
		sub	esp, 18h
		mov	ebx, ds:dword_409F10
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_409603

loc_4095DF:				; CODE XREF: sub_409620-9j
		test	ebx, ebx
		jz	short loc_4095F2

loc_4095E3:				; CODE XREF: sub_409620-30j
		call	ds:dword_409F10[ebx*4]
		sub	ebx, 1
		lea	esi, [esi+0]
		jnz	short loc_4095E3

loc_4095F2:				; CODE XREF: sub_409620-3Fj
		mov	[esp+1Ch+var_1C], offset sub_4095A0 ; _onexit_t
		call	sub_408A00
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_409603:				; CODE XREF: sub_409620-43j
		xor	ebx, ebx
		jmp	short loc_409609
; ---------------------------------------------------------------------------

loc_409607:				; CODE XREF: sub_409620-Bj
		mov	ebx, eax

loc_409609:				; CODE XREF: sub_409620-1Bj
		lea	eax, [ebx+1]
		mov	edx, ds:dword_409F10[eax*4]
		test	edx, edx
		jnz	short loc_409607
		jmp	short loc_4095DF
; END OF FUNCTION CHUNK	FOR sub_409620
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409620	proc near		; CODE XREF: sub_401180+239p
					; sub_4015C4+9p

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 004095D0 SIZE 00000049 BYTES

		mov	ecx, ds:dword_40D2E0
		test	ecx, ecx
		jz	short loc_409630
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_409630:				; CODE XREF: sub_409620+8j
		mov	ds:dword_40D2E0, 1
		jmp	short loc_4095D0
sub_409620	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409640	proc near		; CODE XREF: .text:004014BDp start+Dp

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
SystemTimeAsFileTime= _FILETIME	ptr -2Ch
PerformanceCount= LARGE_INTEGER	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_40A120
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		jz	short loc_409690
		not	eax
		mov	dword_40A124, eax

loc_409676:				; CODE XREF: sub_409640+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_409690:				; CODE XREF: sub_409640+2Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_409702

loc_4096F2:				; CODE XREF: sub_409640+CCj
		mov	dword_40A120, ebp
		mov	dword_40A124, eax
		jmp	loc_409676
; ---------------------------------------------------------------------------

loc_409702:				; CODE XREF: sub_409640+B0j
		mov	eax, 44BF19B0h
		mov	ebp, 0BB40E64Fh
		jmp	short loc_4096F2
sub_409640	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_40D3C4, edx
		mov	ds:dword_40D5E0, 0C0000409h
		mov	ds:dword_40D5E4, 1
		mov	ds:dword_40D3B8, eax
		mov	ds:dword_40D5EC, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_40D3AC, eax
		mov	eax, dword_40A120
		mov	[ebp-10h], eax
		mov	eax, dword_40A124
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_40C5D0
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4097A0	proc near		; CODE XREF: sub_409940+79p
					; sub_409940:loc_4099D2p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_40D65C
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_4097F5
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		lea	esi, [esi+0]

loc_4097D0:				; CODE XREF: sub_4097A0+53j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_4097EE
		test	esi, esi
		jz	short loc_4097EE
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_4097EE:				; CODE XREF: sub_4097A0+40j
					; sub_4097A0+44j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_4097D0

loc_4097F5:				; CODE XREF: sub_4097A0+1Fj
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4097A0	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 1Ch
		mov	eax, ds:dword_40D640
		mov	[esp+14h], ebx
		xor	ebx, ebx
		mov	[esp+18h], esi
		test	eax, eax
		jnz	short loc_409834

loc_409826:				; CODE XREF: .text:0040989Cj
		mov	eax, ebx
		mov	esi, [esp+18h]
		mov	ebx, [esp+14h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_409834:				; CODE XREF: .text:00409824j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		test	eax, eax
		mov	esi, eax
		jz	short loc_409897
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	CriticalSection
		mov	[esi], eax
		mov	eax, [esp+24h]
		mov	[esi+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_40D65C
		mov	ds:dword_40D65C, esi
		mov	[esi+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, ebx
		sub	esp, 4
		mov	ebx, [esp+14h]
		mov	esi, [esp+18h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_409897:				; CODE XREF: .text:0040984Cj
		mov	ebx, 0FFFFFFFFh
		jmp	short loc_409826
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_40D640
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_4098B8
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_4098B8:				; CODE XREF: .text:004098AFj
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:EnterCriticalSection
		mov	edx, ds:dword_40D65C
		sub	esp, 4
		test	edx, edx
		jz	short loc_4098EF
		mov	eax, [edx]
		cmp	eax, ebx
		jnz	short loc_4098E8
		jmp	short loc_409926
; ---------------------------------------------------------------------------
		align 10h

loc_4098E0:				; CODE XREF: .text:004098EDj
		mov	ecx, [eax]
		cmp	ecx, ebx
		jz	short loc_409906
		mov	edx, eax

loc_4098E8:				; CODE XREF: .text:004098D6j
		mov	eax, [edx+8]
		test	eax, eax
		jnz	short loc_4098E0

loc_4098EF:				; CODE XREF: .text:004098D0j
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_4098FF:				; CODE XREF: .text:00409924j
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_409906:				; CODE XREF: .text:004098E4j
		mov	ecx, [eax+8]
		mov	[edx+8], ecx

loc_40990C:				; CODE XREF: .text:00409930j
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_4098FF
; ---------------------------------------------------------------------------

loc_409926:				; CODE XREF: .text:004098D8j
		mov	eax, [edx+8]
		mov	ds:dword_40D65C, eax
		mov	eax, edx
		jmp	short loc_40990C
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409940	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+E9p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_409990
		jb	short loc_409960
		cmp	eax, 3
		jz	short loc_4099B0

loc_409953:				; CODE XREF: sub_409940+31j
					; sub_409940+4Dj ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_409960:				; CODE XREF: sub_409940+Cj
		mov	eax, ds:dword_40D640
		test	eax, eax
		jnz	short loc_4099D2

loc_409969:				; CODE XREF: sub_409940+97j
		mov	eax, ds:dword_40D640
		cmp	eax, 1
		jnz	short loc_409953
		mov	ds:dword_40D640, 0
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_409953
; ---------------------------------------------------------------------------
		align 10h

loc_409990:				; CODE XREF: sub_409940+Aj
		mov	eax, ds:dword_40D640
		test	eax, eax
		jz	short loc_4099C0

loc_409999:				; CODE XREF: sub_409940+90j
		mov	ds:dword_40D640, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4099B0:				; CODE XREF: sub_409940+11j
		mov	eax, ds:dword_40D640
		test	eax, eax
		jz	short loc_409953
		call	sub_4097A0
		jmp	short loc_409953
; ---------------------------------------------------------------------------

loc_4099C0:				; CODE XREF: sub_409940+57j
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_409999
; ---------------------------------------------------------------------------

loc_4099D2:				; CODE XREF: sub_409940+27j
		call	sub_4097A0
		jmp	short loc_409969
sub_409940	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4099E0	proc near		; CODE XREF: sub_401180+19p
					; sub_408F20+3Cp

arg_0		= byte ptr  4

		push	ecx
		push	eax
		cmp	eax, 1000h
		lea	ecx, [esp+8+arg_0]
		jb	short loc_409A02

loc_4099ED:				; CODE XREF: sub_4099E0+20j
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_4099ED

loc_409A02:				; CODE XREF: sub_4099E0+Bj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		pop	eax
		pop	ecx
		retn
sub_4099E0	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _strdup]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fileno]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fdopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _getpid]
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_409A50
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409A50	proc near		; CODE XREF: sub_401180+A7p
					; .text:00409A41j

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_409A50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame fpd=222h

sub_409A70	proc near		; CODE XREF: sub_409C50+A6p

Size		= dword	ptr -348h
lpFilename	= dword	ptr -344h
nSize		= dword	ptr -340h
uType		= dword	ptr -33Ch
var_338		= dword	ptr -338h
var_334		= dword	ptr -334h
Filename	= byte ptr -327h
var_323		= dword	ptr -323h
var_31F		= word ptr -31Fh
var_223		= byte ptr -223h
var_222		= word ptr -222h
var_11D		= dword	ptr -11Dh
var_119		= dword	ptr -119h
var_115		= word ptr -115h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 33Ch
		mov	esi, [esp+348h+arg_0]
		lea	ebp, [esp+126h]
		mov	ebx, [esp+348h+arg_4]
		mov	[esp+348h+Size], 2000h ; Size
		call	malloc
		test	esi, esi
		lea	ecx, [esi+208h]
		mov	edi, eax
		mov	eax, ebp
		jnz	short loc_409ABC
		jmp	short loc_409AC4
; ---------------------------------------------------------------------------
		align 10h

loc_409AB0:				; CODE XREF: sub_409A70+52j
		add	esi, 2
		mov	[eax], dl
		add	eax, 1
		cmp	esi, ecx
		jz	short loc_409AC4

loc_409ABC:				; CODE XREF: sub_409A70+37j
		movzx	edx, word ptr [esi]
		test	dx, dx
		jnz	short loc_409AB0

loc_409AC4:				; CODE XREF: sub_409A70+39j
					; sub_409A70+4Aj
		lea	esi, [esp+348h+var_11D]
		test	ebx, ebx
		mov	byte ptr [eax],	0
		lea	ecx, [ebx+208h]
		mov	eax, esi
		jnz	short loc_409AEC
		jmp	short loc_409AF4
; ---------------------------------------------------------------------------
		align 10h

loc_409AE0:				; CODE XREF: sub_409A70+82j
		add	ebx, 2
		mov	[eax], dl
		add	eax, 1
		cmp	ebx, ecx
		jz	short loc_409AF4

loc_409AEC:				; CODE XREF: sub_409A70+68j
		movzx	edx, word ptr [ebx]
		test	dx, dx
		jnz	short loc_409AE0

loc_409AF4:				; CODE XREF: sub_409A70+6Aj
					; sub_409A70+7Aj
		mov	byte ptr [eax],	0
		cmp	byte ptr [esp+348h+var_11D], 0
		jz	loc_409BB0
		cmp	byte ptr [esp+348h+var_222], 0
		jz	loc_409BDE

loc_409B13:				; CODE XREF: sub_409A70+168j
					; sub_409A70+178j
		lea	ebx, [esp+348h+Filename]
		mov	[esp+348h+var_223], 0
		mov	[esp+348h+nSize], 104h ; nSize
		mov	[esp+348h+lpFilename], ebx ; lpFilename
		mov	[esp+348h+Size], 0 ; hModule
		call	ds:GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_409BF0

loc_409B43:				; CODE XREF: sub_409A70+197j
		mov	eax, [esp+348h+arg_8]
		mov	[esp+348h+var_334], ebp
		mov	[esp+348h+uType], esi
		mov	[esp+348h+nSize], ebx
		mov	[esp+348h+var_338], eax
		mov	[esp+348h+lpFilename], offset aAssertionFaile ;	"Assertion failed!\n\nProgram: %s\nFile:"...
		mov	[esp+348h+Size], edi ; Dest
		call	sprintf
		mov	eax, ds:dword_40D2C0
		test	eax, eax
		jz	loc_409C29
		mov	[esp+348h+uType], 12012h ; uType
		mov	[esp+348h+nSize], offset Caption ; "MinGW Runtime Assertion"
		mov	[esp+348h+lpFilename], edi ; lpText
		mov	[esp+348h+Size], 0 ; hWnd
		call	ds:MessageBoxA
		sub	esp, 10h
		cmp	eax, 3
		jz	short loc_409C11
		cmp	eax, 5
		jnz	short loc_409C0C
		add	esp, 33Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_409BB0:				; CODE XREF: sub_409A70+8Fj
		cmp	byte ptr [esp+348h+var_222], 0
		mov	[esp+348h+var_11D], 6B6E753Ch
		mov	[esp+348h+var_119], 6E776F6Eh
		mov	[esp+348h+var_115], 3Eh
		jnz	loc_409B13

loc_409BDE:				; CODE XREF: sub_409A70+9Dj
		mov	[esp+348h+var_222], 3Fh
		jmp	loc_409B13
; ---------------------------------------------------------------------------
		align 10h

loc_409BF0:				; CODE XREF: sub_409A70+CDj
		mov	dword ptr [esp+348h+Filename], 6B6E753Ch
		mov	[esp+348h+var_323], 6E776F6Eh
		mov	[esp+348h+var_31F], 3Eh
		jmp	loc_409B43
; ---------------------------------------------------------------------------

loc_409C0C:				; CODE XREF: sub_409A70+133j
		call	abort
; ---------------------------------------------------------------------------

loc_409C11:				; CODE XREF: sub_409A70+12Ej
		mov	[esp+348h+Size], 16h
		call	raise
		mov	[esp+348h+Size], 3 ; Code
		call	_exit
; ---------------------------------------------------------------------------

loc_409C29:				; CODE XREF: sub_409A70+101j
		mov	eax, ds:_iob
		mov	[esp+348h+nSize], edi
		mov	[esp+348h+lpFilename], offset aS_2 ; "%s\n"
		add	eax, 40h
		mov	[esp+348h+Size], eax ; File
		call	fprintf
		call	abort
sub_409A70	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_409C50(char *, char *, int)
sub_409C50	proc near		; CODE XREF: sub_402E1C+77p
					; sub_405964+3Ep

Str		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Memory		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [esp+3Ch+arg_0]
		mov	edx, [esp+3Ch+arg_8]
		mov	esi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+Str], edi ; Str
		mov	[esp+3Ch+var_20], edx
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		mov	[esp+3Ch+Str], esi ; Str
		mov	ebx, eax
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		movzx	ecx, byte ptr [edi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_409CB6
		xor	ebp, ebp
		lea	esi, [esi+0]

loc_409CA0:				; CODE XREF: sub_409C50+62j
		add	edx, 1
		movzx	ecx, cl
		mov	[ebx+ebp*2], cx
		movzx	ecx, byte ptr [edi+edx]
		mov	ebp, edx
		test	cl, cl
		jnz	short loc_409CA0
		add	edx, edx

loc_409CB6:				; CODE XREF: sub_409C50+48j
		mov	word ptr [ebx+edx], 0
		movzx	ecx, byte ptr [esi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_409CDD
		xor	edi, edi

loc_409CC7:				; CODE XREF: sub_409C50+89j
		add	edx, 1
		movzx	ecx, cl
		mov	[eax+edi*2], cx
		movzx	ecx, byte ptr [esi+edx]
		mov	edi, edx
		test	cl, cl
		jnz	short loc_409CC7
		add	edx, edx

loc_409CDD:				; CODE XREF: sub_409C50+73j
		mov	word ptr [eax+edx], 0
		mov	edx, [esp+3Ch+var_20]
		mov	[esp+3Ch+var_38], eax
		mov	[esp+3Ch+Memory], eax
		mov	[esp+3Ch+Str], ebx
		mov	[esp+3Ch+var_34], edx
		call	sub_409A70
		mov	[esp+3Ch+Str], ebx ; Memory
		call	free
		mov	eax, [esp+3Ch+Memory]
		mov	[esp+3Ch+arg_0], eax ; Memory
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		jmp	free
sub_409C50	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_409D20	proc near		; CODE XREF: sub_405964+9Cp
		jmp	sub_409D40
sub_409D20	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_409D30	proc near		; CODE XREF: sub_405964+AAp
		jmp	sub_409D50
sub_409D30	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409D40	proc near		; CODE XREF: sub_409D20j
		mov	eax, ds:time
		jmp	eax
sub_409D40	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_409D50	proc near		; CODE XREF: sub_409D30j
		mov	eax, ds:localtime
		jmp	eax
sub_409D50	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __getmainargs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __set_app_type]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _cexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _exit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION getenv]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION atoi]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strerror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION realloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcpy]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strtok]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strncpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION getc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcmp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strpbrk]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION ferror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION printf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strtol]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strtoul]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION putchar]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strstr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fputs]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fflush]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION puts]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fopen]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fclose]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION setvbuf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION putc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strrchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION sprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION vsprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION signal]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __setusermatherr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION raise]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409EF0	proc near		; DATA XREF: .text:00409F14o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4014F0
		mov	[esp+18h+var_18], offset sub_401540 ; _onexit_t
		call	sub_408A00
		leave
		retn
sub_409EF0	endp

; ---------------------------------------------------------------------------
		align 10h
dword_409F10	dd 0FFFFFFFFh		; DATA XREF: sub_409620-4Cr
					; sub_409620:loc_4095E3r ...
		dd offset sub_409EF0
		dd 0
		dd 0FFFFFFFFh
dword_409F20	dd 38h dup(0)		; DATA XREF: .data:off_40A114o
_text		ends

; Section 2. (virtual address 0000A000)
; Virtual size			: 0000012C (	300.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00009400
; Flags	C0600040: Data Readable	Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 40A000h
dword_40A000	dd 76h,	40B044h, 0	; DATA XREF: sub_4015C4:loc_401818o
		dd offset aVerbose	; "verbose"
		dd 71h,	40B04Ch, 0
		dd offset aBeSomewhatMore ; "be	somewhat more quiet"
		dd 1F4h, 40B069h, 1, 40B074h, 1F5h, 40B095h, 0
		dd offset aReturnAllValue ; "return all	values in a record oriented "...
		dd 1F6h, 40B0CAh, 2, 40B0D0h, 1F7h, 40B100h, 2,	40B105h
		dd 1F8h, 40B120h, 1, 40B125h, 1F9h, 40B13Ah, 2,	40B140h
		dd 1FAh, 40B167h, 2, 40B16Ch, 1FBh, 40B197h, 0
		dd offset aTakePasswordFr ; "take password from	$DIRMNGR_LDAP_PASS"
		dd 1FCh, 40B1C6h, 2, 40B1C9h, 1FDh, 40B1E1h, 2,	40B1E8h
		dd 1FEh, 40B210h, 2, 40B218h, 1FFh, 40B23Ch, 0
		dd offset a@		; "@"
		dd 200h, 40B252h, 0
		dd offset a@		; "@"
		align 20h
dword_40A100	dd 0FFFFFFFFh		; DATA XREF: sub_405505:loc_405649w
					; .text:loc_4058FDr ...
; char off_40A104[]
off_40A104	dd offset aIso88591	; DATA XREF: sub_407540+C6w
					; .text:loc_40780Aw ...
					; "iso-8859-1"
		dd 0FFh, 2 dup(0FFFFFFFFh)
off_40A114	dd offset dword_409F20	; DATA XREF: sub_4095A0+3r
					; sub_4095A0+12r ...
dword_40A118	dd 2			; DATA XREF: TlsCallback_0+13r
					; TlsCallback_0+1Cw ...
dword_40A11C	dd 0FFFFFFFFh		; DATA XREF: sub_401060+7Ar
dword_40A120	dd 0BB40E64Eh		; DATA XREF: sub_409640+3r
					; sub_409640:loc_4096F2w ...
dword_40A124	dd 44BF19B1h		; DATA XREF: sub_409640+31w
					; sub_409640+B8w ...
dword_40A128	dd 0			; DATA XREF: sub_4014F0+6r
					; sub_4014F0+42o
		align 1000h
_data		ends

; Section 3. (virtual address 0000B000)
; Virtual size			: 00001638 (   5688.)
; Section size in file		: 00001800 (   6144.)
; Offset to raw	data for section: 00009600
; Flags	40300040: Data Readable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 40B000h
; CHAR ProcName[]
ProcName	db '_set_invalid_parameter_handler',0 ; DATA XREF: sub_401180+137o
		align 10h
; CHAR ModuleName[]
ModuleName	db 'libgcj-12.dll',0    ; DATA XREF: sub_4014F0+Fo
; CHAR a_jv_registercl[]
a_jv_registercl	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_4014F0+28o
		align 4
aVerbose	db 'verbose',0          ; DATA XREF: .data:0040A00Co
aQuiet		db 'quiet',0
aBeSomewhatMore	db 'be somewhat more quiet',0 ; DATA XREF: .data:0040A01Co
aTimeout	db 'timeout',0
		align 4
aNSetLdapTimeou	db '|N|set LDAP timeout to N seconds',0
aMulti		db 'multi',0
		align 4
aReturnAllValue	db 'return all values in a record oriented format',0
					; DATA XREF: .data:0040A03Co
aProxy		db 'proxy',0
aNameIgnoreHost	db '|NAME|ignore host part and connect through NAME',0
aHost		db 'host',0
aNameConnectToH	db '|NAME|connect to host NAME',0
aPort		db 'port',0
aNConnectToPort	db '|N|connect to port N',0
aUser		db 'user',0
		align 10h
aNameUseUserNam	db '|NAME|use user NAME for authentication',0
aPass		db 'pass',0
aPassUsePasswor	db '|PASS|use password PASS for authentication',0
aEnvPass	db 'env-pass',0
aTakePasswordFr	db 'take password from $DIRMNGR_LDAP_PASS',0 ; DATA XREF: .data:0040A09Co
aDn		db 'dn',0
aStringQueryDnS	db '|STRING|query DN STRING',0
aFilter		db 'filter',0
aStringUseStrin	db '|STRING|use STRING as filter expression',0
aAttr		db 'attr',0
		align 4
aStringReturnTh	db '|STRING|return the attribute STRING',0
aOnlySearchTime	db 'only-search-timeout',0
a@		db '@',0                ; DATA XREF: .data:0040A0DCo
					; .data:0040A0ECo
aLogWithPid	db 'log-with-pid',0
aDirmngr_ldapDi	db 'dirmngr_ldap (dirmngr)',0 ; DATA XREF: sub_401550:loc_40156Bo
a1_1_1		db '1.1.1',0            ; DATA XREF: sub_401550:loc_401574o
aCopyrightC2013	db 'Copyright (C) 2013 g10 Code GmbH',0 ; DATA XREF: sub_401550:loc_40157Do
aMingw32	db 'MingW32',0          ; DATA XREF: sub_401550:loc_401586o
		align 4
aPleaseReportBu	db 'Please report bugs to <@EMAIL@>.',0Ah,0
					; DATA XREF: sub_401550:loc_40158Fo
aBugDirmngr@gnu	db 'bug-dirmngr@gnupg.org',0 ; DATA XREF: sub_401550:loc_401598o
aUsageDirmngr_l	db 'Usage: dirmngr_ldap [options] [URL] (-h for help)',0Ah,0
					; DATA XREF: sub_401550:loc_4015A1o
		align 4
aSyntaxDirmngr_	db 'Syntax: dirmngr_ldap [options] [URL]',0Ah
					; DATA XREF: sub_401550:loc_4015AAo
		db 'Internal LDAP helper for Dirmngr.',0Ah
		db 'Interface and options may change without notice.',0Ah,0
		align 10h
off_40B390	dd offset loc_4015B3	; DATA XREF: sub_401550+12o
		dd offset loc_4015A1	; jump table for switch	statement
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_40156B
		dd offset loc_4015B3
		dd offset loc_401574
		dd offset loc_40157D
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_401586
		dd offset loc_4015B3
		dd offset loc_40158F
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015A1
		dd offset loc_4015AA
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_4015B3
		dd offset loc_401598
; char aDirmngr_ldap[]
aDirmngr_ldap	db 'dirmngr_ldap',0     ; DATA XREF: sub_4015C4+56o
; char VarName[]
VarName		db 'DIRMNGR_LDAP_PASS',0 ; DATA XREF: sub_4015C4:loc_401795o
; char aInvalidPortNum[]
aInvalidPortNum	db 'invalid port number %d',0Ah,0 ; DATA XREF: sub_4015C4+30Ao
aAll		db '[all]',0            ; DATA XREF: sub_40195F:loc_40199Eo
		align 4
; char aScanningResult[]
aScanningResult	db 'scanning result for attribute `%s',27h,0Ah,0 ; DATA XREF: sub_40195F+48o
aI		db 'I',0                ; DATA XREF: sub_40195F+65o
		align 10h
		db 2 dup(0)
; char aErrorWritingTo[]
aErrorWritingTo	db 'error writing to stdout: %s',0Ah,0 ; DATA XREF: sub_40195F+A0o
					; sub_40195F+300o ...
		align 10h
; char aAvailableAttri[]
aAvailableAttri	db '          available attribute `%s',27h,0Ah,0 ; DATA XREF: sub_40195F+EAo
; char aAttributeSNotF[]
aAttributeSNotF	db 'attribute `%s',27h,' not found',0Ah,0 ; DATA XREF: sub_40195F+1C2o
; char aFoundAttribute[]
aFoundAttribute	db 'found attribute `%s',27h,0Ah,0 ; DATA XREF: sub_40195F+1F0o
; char aLengthDD[]
aLengthDD	db '         length[%d]=%d',0Ah,0 ; DATA XREF: sub_40195F+221o
; char aResultHasBeenP[]
aResultHasBeenP	db 'result has been printed',0Ah,0 ; DATA XREF: sub_40195F+55Ao
aLdaps		db 'ldaps',0            ; DATA XREF: sub_401EDD+C4o
; char aProcessingUrlS[]
aProcessingUrlS	db 'processing url `%s',27h,0Ah,0 ; DATA XREF: sub_401EDD+10Ao
; char aUserS[]
aUserS		db '          user `%s',27h,0Ah,0 ; DATA XREF: sub_401EDD+128o
asc_40B595	db '*****',0            ; DATA XREF: sub_401EDD+149o
byte_40B59B	db 0			; DATA XREF: sub_401EDD:loc_40202Do
; char aPassS[]
aPassS		db '          pass `%s',27h,0Ah,0 ; DATA XREF: sub_401EDD+159o
; char aHostS[]
aHostS		db '          host `%s',27h,0Ah,0 ; DATA XREF: sub_401EDD+172o
; char aPortD[]
aPortD		db '          port %d',0Ah,0 ; DATA XREF: sub_401EDD+185o
; char aDnS[]
aDnS		db '            DN `%s',27h,0Ah,0 ; DATA XREF: sub_401EDD+19Eo
; char aFilterS[]
aFilterS	db '        filter `%s',27h,0Ah,0 ; DATA XREF: sub_401EDD+1B7o
; char aAttrS[]
aAttrS		db '          attr `%s',27h,0Ah,0 ; DATA XREF: sub_401EDD+1FCo
					; sub_401EDD+22Fo
; char aNoHostNameInS[]
aNoHostNameInS	db 'no host name in `%s',27h,0Ah,0 ; DATA XREF: sub_401EDD+252o
		align 10h
; char aNoAttributeGiv[]
aNoAttributeGiv	db 'no attribute given for query `%s',27h,0Ah,0 ; DATA XREF: sub_401EDD+27Eo
		align 4
; char aWarningUsingFi[]
aWarningUsingFi	db 'WARNING: using first attribute only',0Ah,0 ; DATA XREF: sub_401EDD+2CBo
		align 4
; char aLdapInitToSDFa[]
aLdapInitToSDFa	db 'LDAP init to `%s:%d',27h,' failed: %s',0Ah,0
					; DATA XREF: sub_401EDD+31Co
		align 10h
; char aBindingToSDFai[]
aBindingToSDFai	db 'binding to `%s:%d',27h,' failed: %s',0Ah,0 ; DATA XREF: sub_401EDD+379o
aE		db 'E',0                ; DATA XREF: sub_401EDD+415o
		db 2 dup(0), 9
aTruncated	db 'truncated',0
; char aSearchingSFail[]
aSearchingSFail	db 'searching `%s',27h,' failed: %s',0Ah,0 ; DATA XREF: sub_401EDD+481o
; char aSIsNotAnLdapUr[]
aSIsNotAnLdapUr	db '`%s',27h,' is not an LDAP URL',0Ah,0 ; DATA XREF: sub_4023BA+23o
; char aSIsAnInvalidLd[]
aSIsAnInvalidLd	db '`%s',27h,' is an invalid LDAP URL',0Ah,0 ; DATA XREF: sub_4023BA+53o
		align 10h
; char aErrorAllocatin[]
aErrorAllocatin	db 'error allocating enough memory: %s',0Ah,0 ; DATA XREF: sub_402448+1Bo
asc_40B744	db ' ',0                ; DATA XREF: .text:00402AEBo
; char aUrl[]
aUrl		db 'URL:',0             ; DATA XREF: sub_402C69+46o
; char aLdap[]
aLdap		db 'ldap://',0          ; DATA XREF: sub_402C69+6Bo
aLdap_0		db 'ldap',0             ; DATA XREF: sub_402C69+8Bo
					; sub_4035E9+91o
; char aLdaps_0[]
aLdaps_0	db 'ldaps://',0         ; DATA XREF: sub_402C69+9Eo
aLdaps_1	db 'ldaps',0            ; DATA XREF: sub_402C69+BEo
					; sub_4035E9+CCo
; char aLdapi[]
aLdapi		db 'ldapi://',0         ; DATA XREF: sub_402C69+D1o
aLdapi_0	db 'ldapi',0            ; DATA XREF: sub_402C69+F1o
; char Str2[]
Str2		db 'one',0              ; DATA XREF: sub_402D6C+6o
; char aOnetree[]
aOnetree	db 'onetree',0          ; DATA XREF: sub_402D6C:loc_402D95o
; char aBase[]
aBase		db 'base',0             ; DATA XREF: sub_402D6C:loc_402DB5o
; char aSub[]
aSub		db 'sub',0              ; DATA XREF: sub_402D6C:loc_402DD5o
; char aSubtree[]
aSubtree	db 'subtree',0          ; DATA XREF: sub_402D6C:loc_402DF5o
		align 4
; char a____Dirmngr1_1[]
a____Dirmngr1_1	db '../../dirmngr-1.1.1/src/ldap-url.c',0 ; DATA XREF: sub_402E1C+68o
; char aScheme[]
aScheme		db 'scheme',0           ; DATA XREF: sub_402E1C+70o
; char Src
Src		db 0			; DATA XREF: sub_402E1C:loc_40318Eo
					; sub_402E1C:loc_40323Fo
; char asc_40B7BF[]
asc_40B7BF	db ',',0                ; DATA XREF: sub_402E1C+4C5o
					; sub_402E1C:loc_403506o
		align 4
; char aInvalidArgumen[]
aInvalidArgumen	db 'Invalid argument for ArgParse',0Ah,0 ; DATA XREF: sub_4038D0+77o
aArgumentNotExp	db 'argument not expected',0Ah,0 ; DATA XREF: sub_4038D0+A6o
aReadError	db 'read error',0Ah,0   ; DATA XREF: sub_4038D0+BAo
aKeywordTooLong	db 'keyword too long',0Ah,0 ; DATA XREF: sub_4038D0+CEo
aMissingArgumen	db 'missing argument',0Ah,0 ; DATA XREF: sub_4038D0+E2o
aInvalidCommand	db 'invalid command',0Ah,0 ; DATA XREF: sub_4038D0+F6o
aInvalidAliasDe	db 'invalid alias definition',0Ah,0 ; DATA XREF: sub_4038D0+10Ao
aInvalidOption	db 'invalid option',0Ah,0 ; DATA XREF: sub_4038D0:loc_4039E3o
; char aSUS[]
aSUS		db '%s:%u: %s',0Ah,0    ; DATA XREF: sub_4038D0+131o
a??		db '[??]',0             ; DATA XREF: sub_4038D0:loc_403A24o
		align 4
; char aMissingArgum_0[]
aMissingArgum_0	db 'Missing argument for option "%.50s"',0Ah,0 ; DATA XREF: sub_4038D0+16Eo
		align 10h
; char aOption_50sDoes[]
aOption_50sDoes	db 'Option "%.50s" does not expect an argument',0Ah,0
					; DATA XREF: sub_4038D0+191o
; char aInvalidComma_0[]
aInvalidComma_0	db 'Invalid command "%.50s"',0Ah,0 ; DATA XREF: sub_4038D0+1B1o
; char aOption_50sIsAm[]
aOption_50sIsAm	db 'Option "%.50s" is ambiguous',0Ah,0 ; DATA XREF: sub_4038D0+1D1o
; char aCommand_50sIsA[]
aCommand_50sIsA	db 'Command "%.50s" is ambiguous',0Ah,0 ; DATA XREF: sub_4038D0+1F1o
; char aInvalidOption_[]
aInvalidOption_	db 'Invalid option "%.50s"',0Ah,0 ; DATA XREF: sub_4038D0+206o
asc_40B938	db ' ',9,0              ; DATA XREF: .text:00403D8Eo
aAlias		db 'alias',0            ; DATA XREF: .text:0040404Eo
; char Str1[]
Str1		db 'help',0             ; DATA XREF: sub_40436E+1A6o
; char aVersion[]
aVersion	db 'version',0          ; DATA XREF: sub_40436E+1E0o
; char aWarranty[]
aWarranty	db 'warranty',0         ; DATA XREF: sub_40436E+222o
; char aDumpOptions[]
aDumpOptions	db 'dump-options',0     ; DATA XREF: sub_40436E+266o
; char Format[]
Format		db '--%s',0Ah,0         ; DATA XREF: sub_40436E+29Bo
		align 4
aDumpOptionsHel	db '--dump-options',0Ah ; DATA XREF: sub_40436E+2C7o
		db '--help',0Ah
		db '--version',0Ah
		db '--warranty',0Ah,0
asc_40B998	db 'x',0                ; DATA XREF: sub_40436E:loc_404A51o
; char aOptions[]
aOptions	db 'Options:',0         ; DATA XREF: sub_404C7D+CEo
; char aC[]
aC		db ' -%c',0             ; DATA XREF: sub_404C7D+1A9o
asc_40B9A8	db '   ',0              ; DATA XREF: sub_404C7D+23Do
					; sub_404C7D+32Ao
; char aCS[]
aCS		db '%c --%s',0          ; DATA XREF: sub_404C7D:loc_404F19o
; char aASingleDashMay[]
aASingleDashMay	db 0Ah			; DATA XREF: sub_404C7D+454o
		db '(A single dash may be used instead of the double ones)',0
; char SubStr[]
SubStr		db '@EMAIL@',0          ; DATA XREF: sub_404C7D+485o
aBugDirmngr@g_0	db 'bug-dirmngr@gnupg.org',0 ; DATA XREF: sub_404C7D+4E8o
; char aS_0[]
aS_0		db ' (%s)',0            ; DATA XREF: sub_4051E0+3Co
; char aS_1[]
aS_1		db ' %s',0Ah,0          ; DATA XREF: sub_4051E0+5Co
; char aSSS[]
aSSS		db '%s %s; %s',0Ah,0    ; DATA XREF: sub_40536B+36o
aLicenseGplv3Gn	db 'License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licens'
					; DATA XREF: sub_405438:loc_40547Eo
		db 'es/gpl.html>',0
aFoo		db 'foo',0              ; DATA XREF: sub_405438:loc_405487o
a0_0		db '0.0',0              ; DATA XREF: sub_405438:loc_405490o
		align 4
aCopyrightC2010	db 'Copyright (C) 2010 Free Software Foundation, Inc.',0
					; DATA XREF: sub_405438:loc_405499o
		align 4
aThisIsFreeSoft	db 'This is free software: you are free to change and redistribute it'
					; DATA XREF: sub_405438:loc_4054A2o
		db '.',0Ah
		db 'There is NO WARRANTY, to the extent permitted by law.',0Ah,0
		align 4
aThisIsFreeSo_0	db 'This is free software; you can redistribute it and/or modify',0Ah
					; DATA XREF: sub_405438:loc_4054ABo
		db 'it under the terms of the GNU General Public License as published'
		db ' by',0Ah
		db 'the Free Software Foundation; either version 3 of the License, or'
		db 0Ah
		db '(at your option) any later version.',0Ah
		db 0Ah
		db 'It is distributed in the hope that it will be useful,',0Ah
		db 'but WITHOUT ANY WARRANTY; without even the implied warranty of',0Ah
		db 'MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the',0Ah
		db 'GNU General Public License for more details.',0Ah
		db 0Ah
		db 'You should have received a copy of the GNU General Public License'
		db 0Ah
		db 'along with this software.  If not, see <http://www.gnu.org/licens'
		db 'es/>.',0Ah,0
dword_40BD7C	dd 0			; DATA XREF: sub_405438:loc_4054B4o
off_40BD80	dd offset loc_40547E	; DATA XREF: sub_405438+3Dr
		dd offset loc_405487	; jump table for switch	statement
		dd offset loc_4054BC
		dd offset loc_405490
		dd offset loc_405499
		dd offset loc_4054A2
		dd offset loc_4054AB
		dd offset loc_4054BC
		dd offset loc_4054BC
		dd offset loc_4054BC
		dd offset loc_4054BC
		dd offset loc_4054BC
		dd offset loc_4054BC
		dd offset loc_4054BC
		dd offset loc_4054BC
		dd offset loc_4054BC
		dd offset loc_4054BC
		dd offset loc_4054BC
		dd offset loc_4054BC
		dd offset loc_4054BC
		dd offset loc_4054BC
		dd offset loc_4054BC
		dd offset loc_4054BC
		dd offset loc_4054BC
		dd offset loc_4054BC
		dd offset loc_4054BC
		dd offset loc_4054BC
		dd offset loc_4054BC
		dd offset loc_4054BC
		dd offset loc_4054BC
		dd offset loc_4054B4
		dd offset loc_4054B4
byte_40BE00	db 2Dh,	0		; DATA XREF: sub_405505+13o
					; sub_4057A2:loc_4057B3o
aSocket		db 'socket://',0        ; DATA XREF: sub_405505+5Bo
aSystemDoesNotS	db 'system does not support logging to a socket - using stderr',0Ah,0
					; DATA XREF: sub_405505+BBo
; char Mode[]
Mode		db 'a',0                ; DATA XREF: sub_405505+EFo
					; sub_405505:loc_405633o
		align 4
; char aFailedToOpenLo[]
aFailedToOpenLo	db 'failed to open log file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_405505+1B7o
		align 10h
; char aFailedToFdopen[]
aFailedToFdopen	db 'failed to fdopen file descriptor %d: %s',0Ah,0
					; DATA XREF: sub_405505+1EFo
		align 4
; char a____Dirmngr1_0[]
a____Dirmngr1_0	db '../../dirmngr-1.1.1/jnlib/logging.c',0 ; DATA XREF: sub_405964+2Fo
; char aLogstream[]
aLogstream	db 'logstream',0        ; DATA XREF: sub_405964+37o
		align 4
; char a04d02d02d02d02[]
a04d02d02d02d02	db '%04d-%02d-%02d %02d:%02d:%02d ',0 ; DATA XREF: sub_405964+E3o
; char aU_D[]
aU_D		db '[%u.%d]',0          ; DATA XREF: sub_405964+178o
; char aU[]
aU		db '[%u]',0             ; DATA XREF: sub_405964:loc_405AFFo
aFatal		db 'Fatal: ',0          ; DATA XREF: sub_405964+229o
aOhhhhJeeee	db 'Ohhhh jeeee: ',0    ; DATA XREF: sub_405964+252o
aDbg		db 'DBG: ',0            ; DATA XREF: sub_405964+27Bo
; char aUnknownLogLeve[]
aUnknownLogLeve	db '[Unknown log level %d]: ',0 ; DATA XREF: sub_405964:loc_405C02o
		align 10h
off_40BF30	dd offset loc_405C21	; DATA XREF: sub_405964+21Ao
		dd offset loc_405C21	; jump table for switch	statement
		dd offset loc_405C21
		dd offset loc_405C21
		dd offset loc_405C21
		dd offset loc_405B87
		dd offset loc_405BB0
		dd offset loc_405BD9
dword_40BF50	dd 207325h		; DATA XREF: .text:00405E79o
a02x		db '%02X',0             ; DATA XREF: .text:00405E9Eo
a02x_0		db ' %02X',0            ; DATA XREF: .text:00405EC1o
asc_40BF5F	db 0Ah,0		; DATA XREF: .text:00405EE6o
; char a___ThisIsABugS[]
a___ThisIsABugS	db '... this is a bug (%s:%d:%s)',0Ah,0 ; DATA XREF: sub_405EF4+1Bo
		align 10h
asc_40BF80	db ' ',9,0Dh,0Ah,0      ; DATA XREF: .text:004062CEo
					; .text:00406366o
a_		db '.',0                ; DATA XREF: .text:004063E3o
aHome		db 'HOME',0             ; DATA XREF: .text:004064C9o
; char aX02x[]
aX02x		db 'x%02x',0            ; DATA XREF: sub_4066BF+16Eo
					; .text:00406C2Do
		align 4
; char aEcLu[]
aEcLu		db 'ec=%lu',0           ; DATA XREF: sub_4073D7+Do
aIso88591	db 'iso-8859-1',0       ; DATA XREF: sub_407540+C6o
					; .text:loc_40780Ao ...
; CHAR aIconv_dll[]
aIconv_dll	db 'iconv.dll',0        ; DATA XREF: sub_40742E+25o
					; sub_40742E+ACo
; CHAR aLibiconv_open[]
aLibiconv_open	db 'libiconv_open',0    ; DATA XREF: sub_40742E+3Ao
; CHAR aLibiconv[]
aLibiconv	db 'libiconv',0         ; DATA XREF: sub_40742E+5Bo
; CHAR aLibiconv_close[]
aLibiconv_close	db 'libiconv_close',0   ; DATA XREF: sub_40742E+7Co
; char aErrorLoadingSS[]
aErrorLoadingSS	db 'error loading `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_40742E+B4o
		align 10h
; char aPleaseSeeHttpW[]
aPleaseSeeHttpW	db 'please see http://www.gnupg.org/download/iconv.html for more info'
					; DATA XREF: sub_40742E+C0o
		db 'rmation',0Ah,0
aUtf8		db 'utf-8',0            ; DATA XREF: sub_407540+21o
					; .text:0040784Eo ...
; char aConversionFrom[]
aConversionFrom	db 'conversion from `%s',27h,' to `%s',27h,' not available',0Ah,0
					; DATA XREF: sub_407540+7Eo
; char aIconv_openFail[]
aIconv_openFail	db 'iconv_open failed: %s',0Ah,0 ; DATA XREF: sub_407540+AAo
aCpU		db 'CP%u',0             ; DATA XREF: .text:loc_407660o
aCp936		db 'CP936',0            ; DATA XREF: .text:00407683o
aGbk		db 'GBK',0
aCp1361		db 'CP1361',0
aJohab		db 'JOHAB',0
aCp20127	db 'CP20127',0
aAscii_0	db 'ASCII',0
aCp20866	db 'CP20866',0
aKoi8R		db 'KOI8-R',0
aCp21866	db 'CP21866',0
aKoi8Ru		db 'KOI8-RU',0
aCp28591	db 'CP28591',0
aIso88591_0	db 'ISO-8859-1',0
aCp28592	db 'CP28592',0
aIso88592	db 'ISO-8859-2',0
aCp28593	db 'CP28593',0
aIso88593	db 'ISO-8859-3',0
aCp28594	db 'CP28594',0
aIso88594	db 'ISO-8859-4',0
aCp28595	db 'CP28595',0
aIso88595	db 'ISO-8859-5',0
aCp28596	db 'CP28596',0
aIso88596	db 'ISO-8859-6',0
aCp28597	db 'CP28597',0
aIso88597	db 'ISO-8859-7',0
aCp28598	db 'CP28598',0
aIso88598	db 'ISO-8859-8',0
aCp28599	db 'CP28599',0
aIso88599	db 'ISO-8859-9',0
aCp28605	db 'CP28605',0
aIso885915	db 'ISO-8859-15',0
aCp65001	db 'CP65001',0
aUtf8_1		db 'UTF-8',0
		align 2
aIso		db 'iso',0              ; DATA XREF: .text:00407771o
a88591		db '8859-1',0           ; DATA XREF: .text:004077AEo
a646		db '646',0              ; DATA XREF: .text:004077C5o
aAscii		db 'ASCII',0            ; DATA XREF: .text:004077DCo
aAnsi_x3_41968	db 'ANSI_X3.4-1968',0   ; DATA XREF: .text:004077F3o
aUtf8_0		db 'utf8',0             ; DATA XREF: .text:loc_407837o
		align 4
; char aConversionFr_0[]
aConversionFr_0	db 'conversion from `%s',27h,' to `%s',27h,' failed: %s',0Ah,0
					; DATA XREF: sub_407996+213o
					; sub_407BF2+74Bo
; char aX02x_0[]
aX02x_0		db '\x%02x',0           ; DATA XREF: sub_407BF2+7Do
					; sub_407BF2+3B0o ...
; char aX02x_1[]
aX02x_1		db 'x%02x',0            ; DATA XREF: sub_407BF2+1DDo
		align 4
a____Dirmngr1_2	db '../../dirmngr-1.1.1/jnlib/utf8conv.c',0 ; DATA XREF: sub_407BF2+6C5o
		align 4
off_40C224	dd offset loc_407DA6	; DATA XREF: sub_407BF2+12Br
		dd offset loc_407DBC	; jump table for switch	statement
		dd offset loc_407DBC
		dd offset loc_407DBC
		dd offset loc_407DBC
		dd offset loc_407DBC
		dd offset loc_407DBC
		dd offset loc_407DBC
		dd offset loc_407D90
		dd offset loc_407DBC
		dd offset loc_407D26
		dd offset loc_407D7A
		dd offset loc_407D60
		dd offset loc_407D43
aDo_utf8_to_nat	db 'do_utf8_to_native',0 ; DATA XREF: sub_407BF2+6B5o
		align 10h
; char a0[]
a0		db '-+ #0',0            ; DATA XREF: sub_408490+71o
; char aHll[]
aHll		db 'hlL',0              ; DATA XREF: sub_408490+14Bo
		align 4
off_40C27C	dd offset loc_408614, offset loc_408673, offset	loc_408614
					; DATA XREF: sub_408490+170r
		dd offset loc_408673, offset loc_408673, offset	loc_408673 ; jump table	for switch statement
		dd offset loc_408673, offset loc_408673, offset	loc_408673
		dd offset loc_408673, offset loc_408673, offset	loc_408673
		dd offset loc_408673, offset loc_408673, offset	loc_408673
		dd offset loc_408673, offset loc_408673, offset	loc_408673
		dd offset loc_408673, offset loc_408609, offset	loc_408673
		dd offset loc_408673, offset loc_408673, offset	loc_408673
		dd offset loc_408673, offset loc_408673, offset	loc_408673
		dd offset loc_408673, offset loc_408673, offset	loc_408673
		dd offset loc_408609, offset loc_408609, offset	loc_408614
		dd offset loc_408614, offset loc_408614, offset	loc_408673
		dd offset loc_408609, offset loc_408673, offset	loc_408673
		dd offset loc_408673, offset loc_408673, offset	loc_408669
		dd offset loc_408609, offset loc_408669, offset	loc_408673
		dd offset loc_408673, offset loc_408626, offset	loc_408673
		dd offset loc_408609, offset loc_408673, offset	loc_408673
		dd offset loc_408609
; CHAR LibFileName[]
LibFileName	db 'mingwm10.dll',0     ; DATA XREF: TlsCallback_0+4Eo
; CHAR a__mingwthr_rem[]
a__mingwthr_rem	db '__mingwthr_remove_key_dtor',0 ; DATA XREF: TlsCallback_0+71o
; CHAR a__mingwthr_key[]
a__mingwthr_key	db '__mingwthr_key_dtor',0 ; DATA XREF: TlsCallback_0+8Bo
off_40C388	dd offset TlsCallback_0	; DATA XREF: sub_401180:loc_401273r
aUnknownError	db 'Unknown error',0    ; DATA XREF: sub_408C10+3o
		align 4
; char a_matherrSInSGG[]
a_matherrSInSGG	db '_matherr(): %s in %s(%g, %g)  (retval=%g)',0Ah,0
					; DATA XREF: sub_408C10+39o
		align 4
aArgumentDomain	db 'Argument domain error (DOMAIN)',0 ; DATA XREF: .rdata:off_40C4A8o
aArgumentSingul	db 'Argument singularity (SIGN)',0 ; DATA XREF: .rdata:0040C4ACo
		align 4
aOverflowRangeE	db 'Overflow range error (OVERFLOW)',0 ; DATA XREF: .rdata:0040C4B0o
aTheResultIsToo	db 'The result is too small to be represented (UNDERFLOW)',0
					; DATA XREF: .rdata:0040C4B4o
		align 4
aTotalLossOfSig	db 'Total loss of significance (TLOSS)',0 ; DATA XREF: .rdata:0040C4B8o
		align 10h
aPartialLossOfS	db 'Partial loss of significance (PLOSS)',0 ; DATA XREF: .rdata:0040C4BCo
		align 4
off_40C4A8	dd offset aArgumentDomain ; DATA XREF: sub_408C10+16r
					; "Argument domain error (DOMAIN)"
		dd offset aArgumentSingul ; "Argument singularity (SIGN)"
		dd offset aOverflowRangeE ; "Overflow range error (OVERFLOW)"
		dd offset aTheResultIsToo ; "The result	is too small to	be represent"...
		dd offset aTotalLossOfSig ; "Total loss	of significance	(TLOSS)"
		dd offset aPartialLossOfS ; "Partial loss of significance (PLOSS)"
aMingwW64Runtim	db 'Mingw-w64 runtime failure:',0Ah,0 ; DATA XREF: sub_408C80+1Do
; char aAddressPHasNoI[]
aAddressPHasNoI	db 'Address %p has no image-section',0 ; DATA XREF: sub_408CE0+20Do
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: sub_408CE0+1F9o
					; sub_408CE0+225o ...
		align 10h
; char aVirtualprotect[]
aVirtualprotect	db '  VirtualProtect failed with code 0x%x',0 ; DATA XREF: sub_408CE0+1D2o
		align 4
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_408F20+299o
		align 4
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_408F20+1B7o
		align 4
; const	WCHAR aMsvcrt_dll
aMsvcrt_dll:				; DATA XREF: sub_4094D0:loc_409570o
		unicode	0, <msvcrt.dll>,0
		align 10h
off_40C5D0	dd offset dword_40D5E0	; DATA XREF: .text:00409768o
		dd offset dword_40D300
; char aAssertionFaile[]
aAssertionFaile	db 'Assertion failed!',0Ah ; DATA XREF: sub_409A70+EAo
		db 0Ah
		db 'Program: %s',0Ah
		db 'File: %s, Line %u',0Ah
		db 0Ah
		db 'Expression: %s',0
; char aS_2[]
aS_2		db '%s',0Ah,0           ; DATA XREF: sub_409A70+1C2o
; CHAR Caption[]
Caption		db 'MinGW Runtime Assertion',0 ; DATA XREF: sub_409A70+10Fo
		align 4
dword_40C638	dd 0			; DATA XREF: sub_408F20+59o
					; sub_408F20+5Eo ...
dword_40C63C	dd 0			; DATA XREF: sub_408F20+7Fr
dword_40C640	dd 0			; DATA XREF: sub_408F20:loc_40906Cr
dword_40C644	dd 6Fh dup(0)		; DATA XREF: sub_408F20+155o
		align 1000h
_rdata		ends

; Section 4. (virtual address 0000D000)
; Virtual size			: 0000069C (   1692.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 40D000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_40D000	dd ?			; DATA XREF: sub_401180+D0w
					; sub_401180+27Dr
dword_40D004	dd ?			; DATA XREF: sub_401010+2Ao
					; sub_401180:loc_401344r ...
dword_40D008	dd ?			; DATA XREF: sub_401010+18o
					; sub_401180+1DEr ...
dword_40D00C	dd ?			; DATA XREF: sub_401010+10o
					; sub_401180+243r ...
dword_40D010	dd ?			; DATA XREF: sub_401180+272w
					; sub_401180+28Cr
dword_40D014	dd ?			; DATA XREF: sub_401060:loc_401098w
					; sub_401180+26Ar
dword_40D018	dd ?			; DATA XREF: sub_401010+8o
					; sub_401010+20w
dword_40D01C	dd ?			; DATA XREF: sub_401010+3Aw
dword_40D020	dd ?			; DATA XREF: sub_4015C4:loc_40172Ar
					; sub_4015C4+16Ew
dword_40D024	dd ?			; DATA XREF: sub_4015C4:loc_401718r
					; sub_4015C4+15Cw ...
; struct l_timeval timeout
timeout		l_timeval <?>		; DATA XREF: sub_4015C4+67w
					; sub_4015C4+17Cw ...
dword_40D030	dd ?			; DATA XREF: sub_4015C4+7Bw
					; sub_4015C4+18Fw ...
dword_40D034	dd ?			; DATA XREF: sub_4015C4:loc_40176Aw
					; sub_40195F:loc_4019B3r ...
; char *dword_40D038
dword_40D038	dd ?			; DATA XREF: sub_4015C4+1E8w
					; sub_4015C4:loc_401845r ...
; PCHAR	dn
dn		dd ?			; DATA XREF: sub_4015C4+1B9w
					; sub_401EDD+116r ...
; PCHAR	passwd
passwd		dd ?			; DATA XREF: sub_4015C4+1C7w
					; sub_4015C4+1DDw ...
; char *Str
Str		dd ?			; DATA XREF: sub_4015C4+1F3w
					; sub_4015C4+297w ...
; char dword_40D048[]
dword_40D048	dd ?			; DATA XREF: sub_4015C4+1FEw
					; sub_4015C4+2D4w ...
dword_40D04C	dd ?			; DATA XREF: sub_4015C4+209w
					; sub_401EDD+41r ...
dword_40D050	dd ?			; DATA XREF: sub_4015C4+214w
					; sub_401EDD+5Ar ...
dword_40D054	dd ?			; DATA XREF: sub_4015C4+21Fw
					; sub_401EDD+73r ...
		align 10h
dword_40D060	dd ?			; DATA XREF: sub_405438+6r
					; sub_405438+Fr ...
		align 20h
; FILE *File
File		dd ?			; DATA XREF: sub_405505+154r
					; sub_405505+165r ...
		align 20h
; char Dest[79]
Dest		db 4Fh dup(?)		; DATA XREF: sub_4057F2+1Bo
					; sub_405850:loc_4058C2o ...
byte_40D0EF	db ?			; DATA XREF: sub_4057F2+27w
dword_40D0F0	dd ?			; DATA XREF: sub_4057F2+3Fw
					; sub_405850:loc_40587Ar ...
dword_40D0F4	dd ?			; DATA XREF: sub_4057F2+34w
					; sub_405850+12r ...
dword_40D0F8	dd ?			; DATA XREF: sub_4057F2+4Aw
					; sub_405850:loc_405892r ...
dword_40D0FC	dd ?			; DATA XREF: .text:004057EBw
					; sub_405964+15Ar ...
dword_40D100	dd ?			; DATA XREF: sub_4057F2+57w
					; sub_405850:loc_4058AAr
dword_40D104	dd ?			; DATA XREF: sub_405505+287w
					; sub_405964+88r ...
dword_40D108	dd ?			; DATA XREF: sub_405505+28Cw
					; sub_405964:loc_4059A7r ...
dword_40D10C	dd ?			; DATA XREF: sub_4054D0+6r
					; sub_4054D0+14w ...
		align 20h
dword_40D120	dd 40h dup(?)		; DATA XREF: .text:00406CDDo
					; .text:00406D0Ao
dword_40D220	dd ?			; DATA XREF: sub_407540+DAw
					; .text:0040781Ew ...
dword_40D224	dd ?			; DATA XREF: sub_407540+D0w
					; .text:00407814w ...
dword_40D228	dd ?			; DATA XREF: sub_407540+E4w
					; .text:00407828w ...
dword_40D22C	dd ?			; DATA XREF: sub_40742E+4Dw
					; sub_40742E+52r ...
dword_40D230	dd ?			; DATA XREF: sub_40742E+6Ew
					; sub_40742E:loc_4074A1r ...
dword_40D234	dd ?			; DATA XREF: sub_40742E+8Fw
					; sub_40742E+9Ar ...
dword_40D238	dd ?			; DATA XREF: sub_407BF2+71Br
					; sub_407BF2:loc_408349w
dword_40D23C	dd ?			; DATA XREF: sub_407996+1E3r
					; sub_407996:loc_407BB5w
dword_40D240	dd 8 dup(?)		; DATA XREF: .text:00407670o
					; .text:0040767Co ...
dword_40D260	dd ?			; DATA XREF: sub_407540+44r
					; sub_407540+4Cw
dword_40D264	dd ?			; DATA XREF: sub_407540:loc_407598r
					; sub_407540+60w
dword_40D268	dd ?			; DATA XREF: sub_407540:loc_4075CCr
					; sub_407540:loc_4075F6w
dword_40D26C	dd ?			; DATA XREF: sub_40742E+6r
					; sub_40742E+13w
		align 20h
; char byte_40D280[52]
byte_40D280	db 34h dup(?)		; DATA XREF: sub_4073D7+1Ao
					; sub_4073D7+26o
TlsIndex	dd ?			; DATA XREF: .tls:TlsIndex_ptro
; HMODULE hLibModule
hLibModule	dd ?			; DATA XREF: TlsCallback_0+60w
					; TlsCallback_0+83r ...
dword_40D2BC	dd ?			; DATA XREF: sub_401060+2Cw
dword_40D2C0	dd ?			; DATA XREF: sub_401060+3Dr
					; sub_401180+61r ...
dword_40D2C4	dd ?			; DATA XREF: sub_401060+5Er
dword_40D2C8	dd ?			; DATA XREF: sub_401180+12Dw
					; TopLevelExceptionFilter:loc_408A8Cr
dword_40D2CC	dd ?			; DATA XREF: .text:00408BB3r
					; sub_408C00+4w
dword_40D2D0	dd ?			; DATA XREF: sub_408F20+9r
					; sub_408F20:loc_408F40w
dword_40D2D4	dd ?			; DATA XREF: sub_408CE0+1Dr
					; sub_408CE0+58r ...
dword_40D2D8	dd ?			; DATA XREF: sub_408CE0+Br
					; sub_408CE0:loc_408D9Fw ...
dword_40D2DC	dd ?			; DATA XREF: sub_4094D0+4r
					; sub_4094D0+92w ...
dword_40D2E0	dd ?			; DATA XREF: sub_409620r
					; sub_409620:loc_409630w
		align 20h
dword_40D300	dd 2Bh dup(?)		; DATA XREF: .rdata:0040C5D4o
dword_40D3AC	dd ?			; DATA XREF: .text:0040974Aw
		dd 2 dup(?)
dword_40D3B8	dd ?			; DATA XREF: .text:00409736w
		dd 2 dup(?)
dword_40D3C4	dd ?			; DATA XREF: .text:0040971Cw
		dd 86h dup(?)
dword_40D5E0	dd ?			; DATA XREF: .text:00409722w
					; .rdata:off_40C5D0o
dword_40D5E4	dd ?			; DATA XREF: .text:0040972Cw
		dd ?
dword_40D5EC	dd ?			; DATA XREF: .text:0040973Bw
		dd 14h dup(?)
dword_40D640	dd ?			; DATA XREF: .text:00409813r
					; .text:004098A4r ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_4097A0+7o
					; sub_4097A0:loc_4097F5o ...
dword_40D65C	dd ?			; DATA XREF: sub_4097A0+14r
					; .text:00409868r ...
		dd ?
dword_40D664	dd ?			; DATA XREF: sub_401180+1A8w
dword_40D668	dd ?			; DATA XREF: sub_401180+1BFw
dword_40D66C	dd ?			; DATA XREF: sub_401180+1B2w
dword_40D670	dd ?			; DATA XREF: TlsCallback_0+A3w
					; TlsCallback_0:loc_408873w ...
dword_40D674	dd ?			; DATA XREF: TlsCallback_0+7Ew
					; TlsCallback_0+AEr ...
dword_40D678	dd ?			; DATA XREF: TlsCallback_0:loc_4087C4w
dword_40D67C	dd ?			; DATA XREF: sub_401060+64w
					; sub_408940+3Fr ...
dword_40D680	dd ?			; DATA XREF: sub_401060+69w
					; sub_408940+4r ...
dword_40D684	dd ?			; DATA XREF: sub_401180+A0o
					; sub_401180+ECw
dword_40D688	dd ?			; DATA XREF: sub_401180+B3r
					; sub_401180:loc_401243r ...
		align 1000h
_bss		ends

;
; Imports from KERNEL32.dll
;
; Section 5. (virtual address 0000E000)
; Virtual size			: 00000C40 (   3136.)
; Section size in file		: 00000E00 (   3584.)
; Offset to raw	data for section: 0000AE00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: sub_407404+17p
					; DATA XREF: sub_407404+12r
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_409940+44p
					; DATA XREF: sub_409940+44r
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_4097A0+Ep
					; .text:00409862p ...
; DWORD	__stdcall FormatMessageA(DWORD dwFlags,	LPCVOID	lpSource, DWORD	dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments)
		extrn FormatMessageA:dword ; CODE XREF:	.text:00406D05p
					; DATA XREF: .text:00406D00r
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: TlsCallback_0+10Ap
					; DATA XREF: TlsCallback_0+10Ar
; UINT __stdcall GetACP()
		extrn GetACP:dword	; CODE XREF: .text:0040765Bp
					; DATA XREF: .text:00407656r
; UINT __stdcall GetConsoleOutputCP()
		extrn GetConsoleOutputCP:dword ; CODE XREF: .text:0040764Bp
					; DATA XREF: .text:00407646r
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: .text:00409778p
					; DATA XREF: .text:00409778r
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_409640+6Cp
					; DATA XREF: sub_409640+6Cr
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_409640+74p
					; DATA XREF: sub_409640+74r
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: .text:00406CC5p
					; sub_4073D7+Bp ...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename,	DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_409A70+C2p
					; DATA XREF: sub_409A70+C2r
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_4014F0+16p
					; sub_4094D0+87p
					; DATA XREF: ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_401180+142p
					; sub_4014F0+33p ...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: sub_401180+2F6p
					; DATA XREF: sub_401180+2F6r
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_409640+57p
					; DATA XREF: sub_409640+57r
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_409640+7Cp
					; DATA XREF: sub_409640+7Cr
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_409940+87p
					; DATA XREF: sub_409940+87r
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_4097A0+5Cp
					; .text:00409880p ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: sub_407374+11p
					; TlsCallback_0+55p
					; DATA XREF: ...
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: sub_4094D0+A7p
					; DATA XREF: sub_4094D0+A7r
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_409640+8Bp
					; DATA XREF: sub_409640+8Br
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_401180+124p
					; .text:0040975Fp
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_401180+8Fp
					; DATA XREF: sub_401180+74r
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: .text:00409789p
					; DATA XREF: .text:00409789r
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_4097A0+35p
					; DATA XREF: sub_4097A0+21r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:0040976Fp
					; DATA XREF: .text:0040976Fr
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_408CE0+142p
					; sub_408CE0+184p ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_408CE0+A1p
					; sub_408CE0+D9p ...

;
; Imports from msvcrt.dll
;
; FILE *__cdecl	_fdopen(int FileHandle,	const char *Format)
		extrn __imp__fdopen:dword ; DATA XREF: _fdopenr
; int __cdecl _fileno(FILE *File)
		extrn __imp__fileno:dword ; DATA XREF: _filenor
		extrn __imp__getpid:dword ; DATA XREF: _getpidr
; char *__cdecl	_strdup(const char *Src)
		extrn __imp__strdup:dword ; DATA XREF: _strdupr

;
; Imports from msvcrt.dll
;
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
		extrn __imp___getmainargs:dword	; DATA XREF: __getmainargsr
		extrn __initenv:dword	; DATA XREF: sub_401180+23Er
		extrn __lconv_init:dword ; DATA	XREF: sub_408910r
		extrn __imp___set_app_type:dword ; DATA	XREF: __set_app_typer
		extrn __imp___setusermatherr:dword ; DATA XREF:	__setusermatherrr
		extrn _acmdln:dword	; DATA XREF: sub_401180+166r
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
		extrn __imp__cexit:dword ; DATA	XREF: _cexitr
; int *__cdecl errno()
		extrn _errno:dword	; CODE XREF: sub_40195F+90p
					; sub_40195F+2F0p ...
; void __cdecl __noreturn _exit(int Code)
		extrn __imp__exit:dword	; CODE XREF: .text:00401958p
					; DATA XREF: .text:00401953r ...
; int __cdecl fileno_0(FILE *File)
		extrn _fileno_0:dword	; CODE XREF: sub_4015C4+2Ep
					; DATA XREF: sub_4015C4+29r
; int fmode
		extrn _fmode:dword	; DATA XREF: sub_401060+6Er
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn _iob:dword	; DATA XREF: sub_4015C4+1Er
					; sub_40195F+5Dr ...
		extrn __imp__lock:dword	; DATA XREF: _lockr
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_408940+A3p
					; DATA XREF: sub_408940+A3r
		extrn _setmode:dword	; CODE XREF: sub_4015C4+40p
					; DATA XREF: sub_4015C4+3Br
; int __cdecl stricmp(const char *Str1,	const char *Str2)
		extrn _stricmp:dword	; CODE XREF: .text:00402878p
					; sub_402D6C+19p ...
; int __cdecl strnicmp(const char *Str1, const char *Str, size_t MaxCount)
		extrn _strnicmp:dword	; CODE XREF: sub_402C69+59p
					; sub_402C69+7Ep ...
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
		extrn _winmajor:dword	; DATA XREF: TlsCallback_0+4r
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; int __cdecl atoi(const char *Str)
		extrn __imp_atoi:dword	; DATA XREF: atoir
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; void __cdecl __noreturn exit(int Code)
		extrn __imp_exit:dword	; DATA XREF: exitr
; int __cdecl fclose(FILE *File)
		extrn __imp_fclose:dword ; DATA	XREF: fcloser
; int __cdecl ferror(FILE *File)
		extrn __imp_ferror:dword ; DATA	XREF: ferrorr
; int __cdecl fflush(FILE *File)
		extrn __imp_fflush:dword ; DATA	XREF: fflushr
; FILE *__cdecl	fopen(const char *Filename, const char *Mode)
		extrn __imp_fopen:dword	; DATA XREF: fopenr
; int fprintf(FILE *File, const	char *Format, ...)
		extrn __imp_fprintf:dword ; DATA XREF: fprintfr
; int __cdecl fputs(const char *Str, FILE *File)
		extrn __imp_fputs:dword	; DATA XREF: fputsr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; int __cdecl getc(FILE	*File)
		extrn __imp_getc:dword	; DATA XREF: getcr
; char *__cdecl	getenv(const char *VarName)
		extrn __imp_getenv:dword ; DATA	XREF: getenvr
; int __cdecl isspace(int C)
		extrn isspace:dword	; CODE XREF: .text:00403F80p
					; .text:00403FC1p ...
; struct tm *__cdecl static localtime(const time_t *Time)
		extrn localtime:dword	; DATA XREF: sub_409D50r
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; int printf(const char	*Format, ...)
		extrn __imp_printf:dword ; DATA	XREF: printfr
; int __cdecl putc(int Ch, FILE	*File)
		extrn __imp_putc:dword	; DATA XREF: putcr
; int __cdecl putchar(int Ch)
		extrn __imp_putchar:dword ; DATA XREF: putcharr
; int __cdecl puts(const char *Str)
		extrn __imp_puts:dword	; DATA XREF: putsr
		extrn __imp_raise:dword	; DATA XREF: raiser
; void *__cdecl	realloc(void *Memory, size_t NewSize)
		extrn __imp_realloc:dword ; DATA XREF: reallocr
; int __cdecl setvbuf(FILE *File, char *Buf, int Mode, size_t Size)
		extrn __imp_setvbuf:dword ; DATA XREF: setvbufr
		extrn __imp_signal:dword ; DATA	XREF: signalr
; int sprintf(char *Dest, const	char *Format, ...)
		extrn __imp_sprintf:dword ; DATA XREF: sprintfr
; char *__cdecl	strchr(const char *Str,	int Val)
		extrn __imp_strchr:dword ; DATA	XREF: strchrr
; int __cdecl strcmp(const char	*Str1, const char *Str2)
		extrn __imp_strcmp:dword ; DATA	XREF: strcmpr
; char *__cdecl	strcpy(char *Dest, const char *Source)
		extrn __imp_strcpy:dword ; DATA	XREF: strcpyr
; char *__cdecl	strerror(int)
		extrn __imp_strerror:dword ; DATA XREF:	strerrorr
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; char *__cdecl	strncpy(char *Dest, const char *Source,	size_t Count)
		extrn __imp_strncpy:dword ; DATA XREF: strncpyr
; char *__cdecl	strpbrk(const char *Str, const char *Control)
		extrn __imp_strpbrk:dword ; DATA XREF: strpbrkr
; char *__cdecl	strrchr(const char *Str, int Ch)
		extrn __imp_strrchr:dword ; DATA XREF: strrchrr
; char *__cdecl	strstr(const char *Str,	const char *SubStr)
		extrn __imp_strstr:dword ; DATA	XREF: strstrr
; char *__cdecl	strtok(char *Str, const	char *Delim)
		extrn __imp_strtok:dword ; DATA	XREF: strtokr
; __int32 __cdecl strtol(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtol:dword ; DATA	XREF: strtolr
; unsigned __int32 __cdecl strtoul(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtoul:dword ; DATA XREF: strtoulr
; time_t __cdecl static	time(time_t *Time)
		extrn time:dword	; DATA XREF: sub_409D40r
; int __cdecl toupper(int C)
		extrn toupper:dword	; CODE XREF: sub_405EF4+69p
					; sub_405EF4+7Ep ...
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr
; int __cdecl vsprintf(char *Dest, const char *Format, va_list Args)
		extrn __imp_vsprintf:dword ; DATA XREF:	vsprintfr

;
; Imports from USER32.dll
;
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn MessageBoxA:dword	; CODE XREF: sub_409A70+122p
					; DATA XREF: sub_409A70+122r

;
; Imports from wldap32.dll
;
		extrn __imp_ber_free:dword ; DATA XREF:	ber_freer
; PCHAR	__cdecl	ldap_err2string(ULONG err)
		extrn ldap_err2string:dword ; CODE XREF: sub_401EDD+474p
					; DATA XREF: sub_401EDD+46Fr
; PCHAR	__cdecl	ldap_first_attribute(LDAP *ld, LDAPMessage *entry, BerElement **ptr)
		extrn ldap_first_attribute:dword ; CODE	XREF: sub_40195F+CFp
					; DATA XREF: sub_40195F+CAr
; LDAPMessage *__cdecl ldap_first_entry(LDAP *ld, LDAPMessage *res)
		extrn ldap_first_entry:dword ; CODE XREF: sub_40195F+20p
					; DATA XREF: sub_40195F+1Br
; struct berval	**__cdecl ldap_get_values_len(LDAP *ExternalHandle, LDAPMessage	*Message, const	PCHAR attr)
		extrn ldap_get_values_len:dword	; CODE XREF: sub_40195F+1A7p
					; DATA XREF: sub_40195F+1A2r
; LDAP *__cdecl	ldap_init(PCHAR	HostName, ULONG	PortNumber)
		extrn ldap_init:dword	; CODE XREF: sub_401EDD+2EEp
					; DATA XREF: sub_401EDD+2E9r
; void __cdecl ldap_memfree(PCHAR Block)
		extrn ldap_memfree:dword ; CODE	XREF: sub_40195F+187p
					; sub_40195F+1D9p ...
; ULONG	__cdecl	ldap_msgfree(LDAPMessage *res)
		extrn ldap_msgfree:dword ; CODE	XREF: sub_401EDD+4D1p
					; DATA XREF: sub_401EDD+4CCr
; PCHAR	__cdecl	ldap_next_attribute(LDAP *ld, LDAPMessage *entry, BerElement *ptr)
		extrn ldap_next_attribute:dword	; CODE XREF: sub_40195F+507p
					; DATA XREF: sub_40195F+502r
; LDAPMessage *__cdecl ldap_next_entry(LDAP *ld, LDAPMessage *entry)
		extrn ldap_next_entry:dword ; CODE XREF: sub_40195F+53Bp
					; DATA XREF: sub_40195F+536r
; ULONG	__cdecl	ldap_search_st(LDAP *ld, PCHAR base, ULONG scope, PCHAR	filter,	PCHAR attrs[], ULONG attrsonly,	struct l_timeval *timeout, LDAPMessage **res)
		extrn ldap_search_st:dword ; CODE XREF:	sub_401EDD+3F9p
					; DATA XREF: sub_401EDD+3F4r
; ULONG	__cdecl	ldap_simple_bind_s(LDAP	*ld, const PCHAR dn, const PCHAR passwd)
		extrn ldap_simple_bind_s:dword ; CODE XREF: sub_401EDD+350p
					; DATA XREF: sub_401EDD+34Br
; ULONG	__cdecl	ldap_value_free_len(struct berval **vals)
		extrn ldap_value_free_len:dword	; CODE XREF: sub_40195F+317p
					; sub_40195F+3E3p ...


; Section 6. (virtual address 0000F000)
; Virtual size			: 00000034 (	 52.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0000BC00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 40F000h
dword_40F000	dd 0			; DATA XREF: sub_401180+2D8o
		dd offset sub_401010
dword_40F008	dd 0			; DATA XREF: sub_401180:loc_401450o
dword_40F00C	dd 0			; DATA XREF: sub_401180+316o
		dd offset sub_401060
		dd offset sub_408910
dword_40F018	dd 2 dup(0)		; DATA XREF: sub_401180+30Eo
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
		dd offset TlsCallback_1
		dd 0
		align 10h
dword_40F030	dd 74h dup(0)		; DATA XREF: TlsCallback_0:loc_4088B3o
					; TlsCallback_0+138o ...
		align 1000h
_CRT		ends

; Section 7. (virtual address 00010000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0000BE00
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 410000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end start
