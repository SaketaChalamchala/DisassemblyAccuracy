;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	5C9E8A361123A715200ABD4798D25A26
; Input	CRC32 :	0D251B61

; File Name   :	C:\compspace\compare\gpg\dlls\full\gpgtar.exe
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00017904 (  96516.)
; Section size in file		: 00017A00 (  96768.)
; Offset to raw	data for section: 00000400
; Flags	60500060: Text Data Executable Readable
; Alignment	: 16 bytes

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
; [00000002 BYTES: COLLAPSED FUNCTION nullsub_1]
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401010	proc near		; DATA XREF: .CRT:0041F004o

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch

		sub	esp, 2Ch
		mov	eax, ds:dword_41D520
		mov	[esp+2Ch+var_1C], offset dword_41D018
		mov	[esp+2Ch+var_24], offset dword_41D00C
		mov	[esp+2Ch+var_28], offset dword_41D008
		mov	ds:dword_41D018, eax
		mov	eax, ds:dword_41D524
		mov	[esp+2Ch+var_2C], offset dword_41D004
		mov	[esp+2Ch+var_20], eax
		call	__getmainargs
		mov	ds:dword_41D01C, eax
		add	esp, 2Ch
		retn
sub_401010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_401060	proc near		; DATA XREF: .CRT:0041F010o

var_1C		= dword	ptr -1Ch

		sub	esp, 1Ch
		xor	eax, eax
		cmp	word ptr ds:400000h, 5A4Dh
		mov	ds:dword_41D530, 1
		mov	ds:dword_41D52C, 1
		mov	ds:dword_41D528, 1
		mov	ds:dword_41D53C, 1
		jz	short loc_401100

loc_401098:				; CODE XREF: sub_401060+B6j
					; sub_401060+C8j ...
		mov	ds:dword_41D014, eax
		mov	eax, ds:dword_41D540
		test	eax, eax
		jz	short loc_4010F0
		mov	[esp+1Ch+var_1C], 2
		call	__set_app_type

loc_4010B2:				; CODE XREF: sub_401060+9Cj
		mov	[esp+1Ch+var_1C], 0FFFFFFFFh
		call	sub_417000
		mov	edx, ds:dword_41D544
		mov	ds:dword_41D914, eax
		mov	ds:dword_41D918, eax
		mov	eax, ds:_fmode
		mov	[eax], edx
		call	sub_417340
		cmp	dword_419198, 1
		jz	short loc_401150
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4010F0:				; CODE XREF: sub_401060+44j
		mov	[esp+1Ch+var_1C], 1
		call	__set_app_type
		jmp	short loc_4010B2
; ---------------------------------------------------------------------------
		align 10h

loc_401100:				; CODE XREF: sub_401060+36j
		mov	edx, ds:40003Ch
		cmp	dword ptr [edx+400000h], 4550h
		lea	ecx, [edx+400000h]
		jnz	short loc_401098
		movzx	edx, word ptr [ecx+18h]
		cmp	dx, 10Bh
		jz	short loc_401162
		cmp	dx, 20Bh
		jnz	loc_401098
		cmp	dword ptr [ecx+84h], 0Eh
		jbe	loc_401098
		mov	edx, [ecx+0F8h]
		xor	eax, eax
		test	edx, edx
		setnz	al
		jmp	loc_401098
; ---------------------------------------------------------------------------
		align 10h

loc_401150:				; CODE XREF: sub_401060+81j
		mov	[esp+1Ch+var_1C], offset sub_4172E0
		call	sub_4172D0
		xor	eax, eax
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_401162:				; CODE XREF: sub_401060+C1j
		cmp	dword ptr [ecx+74h], 0Eh
		jbe	loc_401098
		mov	ecx, [ecx+0E8h]
		xor	eax, eax
		test	ecx, ecx
		setnz	al
		jmp	loc_401098
sub_401060	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401180	proc near		; CODE XREF: .text:004014C5j start+15j

dwMilliseconds	= dword	ptr -88h
lpProcName	= dword	ptr -84h
Size		= dword	ptr -80h
var_6D		= byte ptr -6Dh
var_6C		= dword	ptr -6Ch
var_5C		= byte ptr -5Ch
var_30		= byte ptr -30h
var_2C		= word ptr -2Ch

		push	ebp
		xor	eax, eax
		mov	ebp, esp
		mov	ecx, 11h
		push	edi
		push	esi
		lea	edx, [ebp+var_5C]
		push	ebx
		mov	edi, edx
		sub	esp, 7Ch
		rep stosd
		mov	al, 30h
		call	sub_4180B0
		sub	esp, eax
		lea	eax, [esp+88h+var_6D]
		and	eax, 0FFFFFFF0h
		mov	dword ptr [eax], 0CCCCCCCCh
		mov	dword ptr [eax+4], 0CCCCCCCCh
		mov	dword ptr [eax+8], 0CCCCCCCCh
		mov	dword ptr [eax+0Ch], 0CCCCCCCCh
		mov	dword ptr [eax+10h], 0CCCCCCCCh
		mov	dword ptr [eax+14h], 0CCCCCCCCh
		mov	dword ptr [eax+18h], 0CCCCCCCCh
		mov	dword ptr [eax+1Ch], 0CCCCCCCCh
		and	esp, 0FFFFFFF0h
		mov	eax, ds:dword_41D540
		test	eax, eax
		jnz	loc_401473

loc_4011EE:				; CODE XREF: sub_401180+2FFj
		mov	eax, large fs:18h
		mov	esi, ds:Sleep
		mov	ebx, [eax+4]
		jmp	short loc_401214
; ---------------------------------------------------------------------------
		align 10h

loc_401200:				; CODE XREF: sub_401180+B1j
		cmp	eax, ebx
		jz	loc_401420
		mov	[esp+88h+dwMilliseconds], 3E8h ; dwMilliseconds
		call	esi ; Sleep
		sub	esp, 4

loc_401214:				; CODE XREF: sub_401180+7Dj
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], ebx
		mov	[esp+88h+dwMilliseconds], offset dword_41D91C
		call	sub_4183A0
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_401200
		mov	eax, ds:dword_41D920
		xor	ebx, ebx
		cmp	eax, 1
		jz	loc_401433

loc_401243:				; CODE XREF: sub_401180+2ADj
		mov	eax, ds:dword_41D920
		test	eax, eax
		jz	loc_401484
		mov	ds:dword_41D000, 1

loc_40125A:				; CODE XREF: sub_401180+322j
		mov	eax, ds:dword_41D920
		cmp	eax, 1
		jz	loc_401450

loc_401268:				; CODE XREF: sub_401180+2C7j
					; sub_401180+2EEj
		test	ebx, ebx
		jnz	short loc_401273
		lock xchg ebx, ds:dword_41D91C

loc_401273:				; CODE XREF: sub_401180+EAj
		mov	eax, ds:off_41CB9C
		test	eax, eax
		jz	short loc_401298
		mov	[esp+88h+Size],	0
		mov	[esp+88h+lpProcName], 2
		mov	[esp+88h+dwMilliseconds], 0
		call	eax ; TlsCallback_0
		sub	esp, 0Ch

loc_401298:				; CODE XREF: sub_401180+FAj
		call	sub_4175F0
		mov	[esp+88h+dwMilliseconds], offset TopLevelExceptionFilter ; lpTopLevelExceptionFilter
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	ds:dword_41D548, eax
		call	sub_417BA0
		mov	[esp+88h+lpProcName], offset ProcName ;	"_set_invalid_parameter_handler"
		mov	[esp+88h+dwMilliseconds], eax ;	hModule
		call	ds:GetProcAddress
		sub	esp, 8
		test	eax, eax
		jz	short loc_4012D8
		mov	[esp+88h+dwMilliseconds], offset nullsub_1
		call	eax

loc_4012D8:				; CODE XREF: sub_401180+14Dj
		call	sub_417C60
		mov	eax, ds:dword_41D540
		test	eax, eax
		jz	short loc_401344
		mov	eax, ds:_acmdln
		xor	ecx, ecx
		mov	eax, [eax]
		jmp	short loc_4012FC
; ---------------------------------------------------------------------------

loc_4012F1:				; CODE XREF: sub_401180+182j
		test	dl, dl
		jz	short loc_401320
		test	cl, cl
		jz	short loc_401315

loc_4012F9:				; CODE XREF: sub_401180+18Fj
		add	eax, 1

loc_4012FC:				; CODE XREF: sub_401180+16Fj
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_4012F1
		mov	ebx, ecx
		xor	ebx, 1
		cmp	dl, 22h
		cmovz	ecx, ebx
		jmp	short loc_4012F9
; ---------------------------------------------------------------------------

loc_401311:				; CODE XREF: sub_401180+19Ej
		test	dl, dl
		jz	short loc_401320

loc_401315:				; CODE XREF: sub_401180+177j
		add	eax, 1
		movzx	edx, byte ptr [eax]
		cmp	dl, 20h
		jle	short loc_401311

loc_401320:				; CODE XREF: sub_401180+173j
					; sub_401180+193j
		movzx	edx, [ebp+var_2C]
		test	[ebp+var_30], 1
		mov	ds:dword_41D8E4, eax
		mov	eax, 0Ah
		mov	ds:dword_41D8EC, 400000h
		cmovnz	eax, edx
		mov	ds:dword_41D8E8, eax

loc_401344:				; CODE XREF: sub_401180+164j
		mov	edx, ds:dword_41D004
		xor	ebx, ebx
		lea	eax, ds:4[edx*4]
		mov	[ebp+var_6C], edx
		mov	[esp+88h+dwMilliseconds], eax ;	Size
		call	malloc
		mov	edi, ds:dword_41D008
		mov	[ebp-70h], eax
		mov	eax, [ebp+var_6C]
		test	eax, eax
		jle	short loc_4013AA
		xchg	ax, ax

loc_401370:				; CODE XREF: sub_401180+225j
		mov	eax, [edi+ebx*4]
		mov	[esp+88h+dwMilliseconds], eax ;	Str
		call	strlen
		lea	esi, [eax+1]
		mov	[esp+88h+dwMilliseconds], esi ;	Size
		call	malloc
		mov	edx, [ebp-70h]
		mov	[edx+ebx*4], eax
		mov	edx, [edi+ebx*4]
		add	ebx, 1
		mov	[esp+88h+Size],	esi ; Size
		mov	[esp+88h+dwMilliseconds], eax ;	Dst
		mov	[esp+88h+lpProcName], edx ; Src
		call	memcpy
		cmp	ebx, [ebp+var_6C]
		jnz	short loc_401370
		shl	ebx, 2

loc_4013AA:				; CODE XREF: sub_401180+1ECj
		mov	eax, [ebp-70h]
		mov	dword ptr [eax+ebx], 0
		mov	ds:dword_41D008, eax
		call	sub_417CF0
		mov	eax, ds:__initenv
		mov	edx, ds:dword_41D00C
		mov	[eax], edx
		mov	eax, ds:dword_41D00C
		mov	[esp+88h+Size],	eax
		mov	eax, ds:dword_41D008
		mov	[esp+88h+lpProcName], eax
		mov	eax, ds:dword_41D004
		mov	[esp+88h+dwMilliseconds], eax
		call	sub_401695
		mov	esi, ds:dword_41D014
		test	esi, esi
		mov	ds:dword_41D010, eax
		jz	loc_4014A7
		mov	ebx, ds:dword_41D000
		test	ebx, ebx
		jnz	short loc_401411
		call	_cexit
		mov	eax, ds:dword_41D010

loc_401411:				; CODE XREF: sub_401180+285j
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_401420:				; CODE XREF: sub_401180+82j
		mov	eax, ds:dword_41D920
		mov	ebx, 1
		cmp	eax, 1
		jnz	loc_401243

loc_401433:				; CODE XREF: sub_401180+BDj
		mov	[esp+88h+dwMilliseconds], 1Fh
		call	_amsg_exit
		mov	eax, ds:dword_41D920
		cmp	eax, 1
		jnz	loc_401268
		lea	esi, [esi+0]

loc_401450:				; CODE XREF: sub_401180+E2j
		mov	[esp+88h+lpProcName], offset dword_41F008
		mov	[esp+88h+dwMilliseconds], offset dword_41F000
		call	_initterm
		mov	ds:dword_41D920, 2
		jmp	loc_401268
; ---------------------------------------------------------------------------

loc_401473:				; CODE XREF: sub_401180+68j
		mov	[esp+88h+dwMilliseconds], edx ;	lpStartupInfo
		call	ds:GetStartupInfoA
		sub	esp, 4
		jmp	loc_4011EE
; ---------------------------------------------------------------------------

loc_401484:				; CODE XREF: sub_401180+CAj
		mov	ds:dword_41D920, 1
		mov	[esp+88h+lpProcName], offset dword_41F018
		mov	[esp+88h+dwMilliseconds], offset dword_41F00C
		call	_initterm
		jmp	loc_40125A
; ---------------------------------------------------------------------------

loc_4014A7:				; CODE XREF: sub_401180+277j
		mov	[esp+88h+dwMilliseconds], eax ;	Code
		call	exit
sub_401180	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 0Ch
		mov	ds:dword_41D540, 1
		call	sub_417D10
		add	esp, 0Ch
		jmp	sub_401180
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public start
start		proc near
		sub	esp, 0Ch
		mov	ds:dword_41D540, 0
		call	sub_417D10
		add	esp, 0Ch
		jmp	sub_401180
start		endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4014F0	proc near		; CODE XREF: sub_4188D0+6p

lpModuleName	= dword	ptr -18h
lpProcName	= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, dword_4191A4
		test	eax, eax
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset ModuleName ; "libgcj-12.dll"
		call	ds:GetModuleHandleA
		mov	edx, 0
		sub	esp, 4
		test	eax, eax
		jz	short loc_40152E
		mov	[esp+18h+lpProcName], offset a_jv_registercl ; "_Jv_RegisterClasses"
		mov	[esp+18h+lpModuleName],	eax ; hModule
		call	ds:GetProcAddress
		sub	esp, 8
		mov	edx, eax

loc_40152E:				; CODE XREF: sub_4014F0+26j
		test	edx, edx
		jz	short locret_40153B
		mov	[esp+18h+lpModuleName],	offset dword_4191A4
		call	edx

locret_40153B:				; CODE XREF: sub_4014F0+Dj
					; sub_4014F0+40j
		leave
		retn
sub_4014F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401540()
sub_401540	proc near		; DATA XREF: sub_4188D0+Bo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401540	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401550	proc near		; CODE XREF: sub_401577+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_401570
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_401575
; ---------------------------------------------------------------------------

loc_401570:				; CODE XREF: sub_401550+7j
		mov	eax, 0

loc_401575:				; CODE XREF: sub_401550+1Ej
		pop	ebp
		retn
sub_401550	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401577	proc near		; CODE XREF: sub_401592+Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_401550
		leave
		retn
sub_401577	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401592	proc near		; CODE XREF: sub_401AD2+35p
					; sub_401B80+35p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_401577
		leave
		retn
sub_401592	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4015A7	proc near		; DATA XREF: sub_401695+44o

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 29h ; switch 42 cases
		ja	short loc_401610 ; jumptable 004015C0 default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_41A304
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_4015C2:				; CODE XREF: sub_4015A7+19j
					; DATA XREF: .rdata:off_41A304o
		mov	[ebp+var_C], offset aGpgtarGnupg ; jumptable 004015C0 case 11
		jmp	short loc_401618
; ---------------------------------------------------------------------------

loc_4015CB:				; CODE XREF: sub_4015A7+19j
					; DATA XREF: .rdata:off_41A304o
		mov	[ebp+var_C], offset a2_0_30 ; jumptable	004015C0 case 13
		jmp	short loc_401618
; ---------------------------------------------------------------------------

loc_4015D4:				; CODE XREF: sub_4015A7+19j
					; DATA XREF: .rdata:off_41A304o
		mov	[ebp+var_C], offset aMingw32 ; jumptable 004015C0 case 17
		jmp	short loc_401618
; ---------------------------------------------------------------------------

loc_4015DD:				; CODE XREF: sub_4015A7+19j
					; DATA XREF: .rdata:off_41A304o
		mov	[esp+28h+var_28], offset aPleaseReportBu ; jumptable 004015C0 case 19
		call	sub_411114
		mov	[ebp+var_C], eax
		jmp	short loc_401618
; ---------------------------------------------------------------------------

loc_4015EE:				; CODE XREF: sub_4015A7+19j
					; DATA XREF: .rdata:off_41A304o
		mov	[esp+28h+var_28], offset aUsageGpgtarOpt ; jumptable 004015C0 cases 1,40
		call	sub_411114
		mov	[ebp+var_C], eax
		jmp	short loc_401618
; ---------------------------------------------------------------------------

loc_4015FF:				; CODE XREF: sub_4015A7+19j
					; DATA XREF: .rdata:off_41A304o
		mov	[esp+28h+var_28], offset aSyntaxGpgtarOp ; jumptable 004015C0 case 41
		call	sub_411114
		mov	[ebp+var_C], eax
		jmp	short loc_401618
; ---------------------------------------------------------------------------

loc_401610:				; CODE XREF: sub_4015A7+Aj
					; sub_4015A7+19j
					; DATA XREF: ...
		mov	[ebp+var_C], 0	; jumptable 004015C0 default case
		nop

loc_401618:				; CODE XREF: sub_4015A7+22j
					; sub_4015A7+2Bj ...
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4015A7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40161D	proc near		; CODE XREF: sub_401695+181p
					; sub_401695+197p

Code		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_401639
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_401641

loc_401639:				; CODE XREF: sub_40161D+12j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		jmp	short loc_40168B
; ---------------------------------------------------------------------------

loc_401641:				; CODE XREF: sub_40161D+1Aj
		cmp	[ebp+var_C], 73h
		jnz	short loc_401656
		cmp	[ebp+arg_4], 65h
		jnz	short loc_401656
		mov	[ebp+var_C], 1F5h
		jmp	short loc_40168B
; ---------------------------------------------------------------------------

loc_401656:				; CODE XREF: sub_40161D+28j
					; sub_40161D+2Ej
		cmp	[ebp+var_C], 65h
		jnz	short loc_40166B
		cmp	[ebp+arg_4], 73h
		jnz	short loc_40166B
		mov	[ebp+var_C], 1F5h
		jmp	short loc_40168B
; ---------------------------------------------------------------------------

loc_40166B:				; CODE XREF: sub_40161D+3Dj
					; sub_40161D+43j
		mov	[esp+28h+Code],	offset aConflictingCom ; "conflicting commands\n"
		call	sub_411114
		mov	[esp+28h+Code],	eax ; char *
		call	sub_4119FD
		mov	[esp+28h+Code],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_40168B:				; CODE XREF: sub_40161D+22j
					; sub_40161D+37j ...
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		leave
		retn
sub_40161D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401695	proc near		; CODE XREF: sub_401180+265p

Code		= dword	ptr -78h
var_74		= byte ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_3C		= dword	ptr -3Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		and	esp, 0FFFFFFF0h
		sub	esp, 70h
		call	sub_417CF0
		mov	[esp+78h+var_18], 0
		mov	[esp+78h+var_58], 0
		mov	[esp+78h+var_C], 0
		mov	[esp+78h+var_10], 0
		mov	[esp+78h+var_14], 0
		mov	[esp+78h+Code],	offset aGpgtar ; "gpgtar"
		call	sub_40521B
		mov	[esp+78h+Code],	offset sub_4015A7
		call	sub_413DA2
		mov	dword ptr [esp+78h+var_74], 1 ;	int
		mov	[esp+78h+Code],	offset aGpgtar ; "gpgtar"
		call	sub_411494
		call	sub_405474
		call	sub_4054EC
		lea	eax, [ebp+arg_0]
		mov	[esp+78h+var_54], eax
		lea	eax, [ebp+arg_4]
		mov	[esp+78h+var_50], eax
		mov	[esp+78h+var_4C], 1
		jmp	loc_401855
; ---------------------------------------------------------------------------

loc_40171E:				; CODE XREF: sub_401695+1F5j
		mov	eax, [esp+78h+var_44]
		cmp	eax, 74h
		jg	short loc_401764
		cmp	eax, 73h
		jge	loc_401807
		cmp	eax, 65h
		jg	short loc_401755
		cmp	eax, 64h
		jge	loc_401807
		cmp	eax, 54h
		jz	loc_4017F3
		cmp	eax, 63h
		jz	loc_40181D
		jmp	loc_401847
; ---------------------------------------------------------------------------

loc_401755:				; CODE XREF: sub_401695+9Ej
		cmp	eax, 6Fh
		jz	short loc_4017B0
		cmp	eax, 71h
		jz	short loc_4017CC
		jmp	loc_401847
; ---------------------------------------------------------------------------

loc_401764:				; CODE XREF: sub_401695+90j
		cmp	eax, 1F7h
		jz	loc_401851
		cmp	eax, 1F7h
		jg	short loc_401792
		cmp	eax, 1F4h
		jz	short loc_4017E7
		cmp	eax, 1F6h
		jz	loc_40183D
		cmp	eax, 76h
		jz	short loc_4017D8
		jmp	loc_401847
; ---------------------------------------------------------------------------

loc_401792:				; CODE XREF: sub_401695+DFj
		cmp	eax, 1F9h
		jz	short loc_4017BE
		cmp	eax, 1F9h
		jl	loc_401854
		cmp	eax, 1FAh
		jz	short loc_4017FD
		jmp	loc_401847
; ---------------------------------------------------------------------------

loc_4017B0:				; CODE XREF: sub_401695+C3j
		mov	eax, [esp+78h+var_3C]
		mov	ds:Filename, eax
		jmp	loc_401855
; ---------------------------------------------------------------------------

loc_4017BE:				; CODE XREF: sub_401695+102j
		mov	eax, [esp+78h+var_3C]
		mov	ds:Str,	eax
		jmp	loc_401855
; ---------------------------------------------------------------------------

loc_4017CC:				; CODE XREF: sub_401695+C8j
		mov	ds:dword_41D8F4, 1
		jmp	short loc_401855
; ---------------------------------------------------------------------------

loc_4017D8:				; CODE XREF: sub_401695+F6j
		mov	eax, ds:dword_41D8F0
		add	eax, 1
		mov	ds:dword_41D8F0, eax
		jmp	short loc_401855
; ---------------------------------------------------------------------------

loc_4017E7:				; CODE XREF: sub_401695+E6j
		mov	ds:dword_41D8F0, 0
		jmp	short loc_401855
; ---------------------------------------------------------------------------

loc_4017F3:				; CODE XREF: sub_401695+ACj
		mov	eax, [esp+78h+var_3C]
		mov	[esp+78h+var_10], eax
		jmp	short loc_401855
; ---------------------------------------------------------------------------

loc_4017FD:				; CODE XREF: sub_401695+114j
		mov	[esp+78h+var_14], 1
		jmp	short loc_401855
; ---------------------------------------------------------------------------

loc_401807:				; CODE XREF: sub_401695+95j
					; sub_401695+A3j
		mov	eax, [esp+78h+var_44]
		mov	dword ptr [esp+78h+var_74], eax
		lea	eax, [esp+78h+var_58]
		mov	[esp+78h+Code],	eax
		call	sub_40161D
		jmp	short loc_401855
; ---------------------------------------------------------------------------

loc_40181D:				; CODE XREF: sub_401695+B5j
		mov	dword ptr [esp+78h+var_74], 65h
		lea	eax, [esp+78h+var_58]
		mov	[esp+78h+Code],	eax
		call	sub_40161D
		mov	ds:dword_41D8FC, 1
		jmp	short loc_401855
; ---------------------------------------------------------------------------

loc_40183D:				; CODE XREF: sub_401695+EDj
		mov	[esp+78h+var_C], 1
		jmp	short loc_401855
; ---------------------------------------------------------------------------

loc_401847:				; CODE XREF: sub_401695+BBj
					; sub_401695+CAj ...
		mov	[esp+78h+var_48], 2
		jmp	short loc_401855
; ---------------------------------------------------------------------------

loc_401851:				; CODE XREF: sub_401695+D4j
		nop
		jmp	short loc_401855
; ---------------------------------------------------------------------------

loc_401854:				; CODE XREF: sub_401695+109j
		nop

loc_401855:				; CODE XREF: sub_401695+84j
					; sub_401695+124j ...
		cmp	[esp+78h+var_18], 0
		jnz	short loc_401890
		mov	[esp+78h+var_68], offset dword_419000 ;	int
		lea	eax, [esp+78h+var_54]
		mov	[esp+78h+var_6C], eax ;	int
		mov	[esp+78h+var_70], 0 ; int
		mov	dword ptr [esp+78h+var_74], 0 ;	char
		mov	[esp+78h+Code],	0 ; FILE *
		call	sub_41212A
		test	eax, eax
		jnz	loc_40171E

loc_401890:				; CODE XREF: sub_401695+1C5j
		cmp	[esp+78h+var_10], 0
		jz	short loc_40189E
		cmp	[esp+78h+var_14], 0
		jz	short loc_4018AC

loc_40189E:				; CODE XREF: sub_401695+200j
		cmp	[esp+78h+var_10], 0
		jnz	short loc_4018B8
		cmp	[esp+78h+var_14], 0
		jz	short loc_4018B8

loc_4018AC:				; CODE XREF: sub_401695+207j
		mov	[esp+78h+Code],	offset aFilesFromAndNu ; "--files-from and --null may only be use"...
		call	sub_4119FD

loc_4018B8:				; CODE XREF: sub_401695+20Ej
					; sub_401695+215j
		cmp	[esp+78h+var_10], 0
		jz	short loc_4018F4
		mov	eax, [esp+78h+var_10]
		mov	edx, eax
		mov	eax, offset asc_41A405 ; "-"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_4018F4
		mov	[esp+78h+Code],	offset aFilesFromOnlyS ; "--files-from only supports argument \"-"...
		call	sub_4119FD

loc_4018F4:				; CODE XREF: sub_401695+228j
					; sub_401695+251j
		mov	[esp+78h+Code],	0
		call	sub_4111B0
		test	eax, eax
		jz	short loc_401910
		mov	[esp+78h+Code],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_401910:				; CODE XREF: sub_401695+26Dj
		mov	eax, [esp+78h+var_58]
		cmp	eax, 65h
		jz	loc_4019AC
		cmp	eax, 74h
		jz	short loc_401930
		cmp	eax, 64h
		jz	loc_401A2C
		jmp	loc_401AA2
; ---------------------------------------------------------------------------

loc_401930:				; CODE XREF: sub_401695+28Bj
		mov	eax, [ebp+arg_0]
		cmp	eax, 1
		jle	short loc_401944
		mov	[esp+78h+Code],	1
		call	sub_413BF6

loc_401944:				; CODE XREF: sub_401695+2A1j
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jz	short loc_401952
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		jmp	short loc_401957
; ---------------------------------------------------------------------------

loc_401952:				; CODE XREF: sub_401695+2B4j
		mov	eax, 0

loc_401957:				; CODE XREF: sub_401695+2BBj
		mov	[esp+78h+var_1C], eax
		mov	eax, ds:Str
		test	eax, eax
		jz	short loc_401970
		mov	[esp+78h+Code],	offset aNoteIgnoringOp ; "note:	ignoring option	--set-filename\n"
		call	sub_4119D3

loc_401970:				; CODE XREF: sub_401695+2CDj
		cmp	[esp+78h+var_10], 0
		jz	short loc_401983
		mov	[esp+78h+Code],	offset aNoteIgnoring_0 ; "note:	ignoring option	--files-from\n"
		call	sub_4119D3

loc_401983:				; CODE XREF: sub_401695+2E0j
		cmp	[esp+78h+var_C], 0
		jz	short loc_40199B
		mov	eax, [esp+78h+var_1C]
		mov	[esp+78h+Code],	eax ; char *
		call	sub_404AD9
		jmp	loc_401AB7
; ---------------------------------------------------------------------------

loc_40199B:				; CODE XREF: sub_401695+2F3j
		mov	eax, [esp+78h+var_1C]
		mov	[esp+78h+Code],	eax
		call	sub_401C23
		jmp	loc_401AB7
; ---------------------------------------------------------------------------

loc_4019AC:				; CODE XREF: sub_401695+282j
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jnz	short loc_4019BA
		cmp	[esp+78h+var_14], 0
		jz	short loc_4019C8

loc_4019BA:				; CODE XREF: sub_401695+31Cj
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jz	short loc_4019D4
		cmp	[esp+78h+var_14], 0
		jz	short loc_4019D4

loc_4019C8:				; CODE XREF: sub_401695+323j
		mov	[esp+78h+Code],	1
		call	sub_413BF6

loc_4019D4:				; CODE XREF: sub_401695+32Aj
					; sub_401695+331j
		mov	eax, ds:Str
		test	eax, eax
		jz	short loc_4019E9
		mov	[esp+78h+Code],	offset aNoteIgnoringOp ; "note:	ignoring option	--set-filename\n"
		call	sub_4119D3

loc_4019E9:				; CODE XREF: sub_401695+346j
		cmp	[esp+78h+var_C], 0
		jz	short loc_401A0E
		cmp	[esp+78h+var_14], 0
		jnz	short loc_4019FC
		mov	eax, [ebp+arg_4]
		jmp	short loc_401A01
; ---------------------------------------------------------------------------

loc_4019FC:				; CODE XREF: sub_401695+360j
		mov	eax, 0

loc_401A01:				; CODE XREF: sub_401695+365j
		mov	[esp+78h+Code],	eax
		call	sub_403264
		jmp	loc_401AB7
; ---------------------------------------------------------------------------

loc_401A0E:				; CODE XREF: sub_401695+359j
		cmp	[esp+78h+var_14], 0
		jnz	short loc_401A1A
		mov	eax, [ebp+arg_4]
		jmp	short loc_401A1F
; ---------------------------------------------------------------------------

loc_401A1A:				; CODE XREF: sub_401695+37Ej
		mov	eax, 0

loc_401A1F:				; CODE XREF: sub_401695+383j
		mov	[esp+78h+Code],	eax
		call	sub_401BFB
		jmp	loc_401AB7
; ---------------------------------------------------------------------------

loc_401A2C:				; CODE XREF: sub_401695+290j
		mov	eax, [ebp+arg_0]
		cmp	eax, 1
		jz	short loc_401A40
		mov	[esp+78h+Code],	1
		call	sub_413BF6

loc_401A40:				; CODE XREF: sub_401695+39Dj
		mov	eax, ds:Filename
		test	eax, eax
		jz	short loc_401A55
		mov	[esp+78h+Code],	offset aNoteIgnoring_1 ; "note:	ignoring option	--output\n"
		call	sub_4119D3

loc_401A55:				; CODE XREF: sub_401695+3B2j
		cmp	[esp+78h+var_10], 0
		jz	short loc_401A68
		mov	[esp+78h+Code],	offset aNoteIgnoring_0 ; "note:	ignoring option	--files-from\n"
		call	sub_4119D3

loc_401A68:				; CODE XREF: sub_401695+3C5j
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jz	short loc_401A76
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		jmp	short loc_401A7B
; ---------------------------------------------------------------------------

loc_401A76:				; CODE XREF: sub_401695+3D8j
		mov	eax, 0

loc_401A7B:				; CODE XREF: sub_401695+3DFj
		mov	[esp+78h+var_1C], eax
		cmp	[esp+78h+var_C], 0
		jz	short loc_401A94
		mov	eax, [esp+78h+var_1C]
		mov	[esp+78h+Code],	eax ; char *
		call	sub_404026
		jmp	short loc_401AB7
; ---------------------------------------------------------------------------

loc_401A94:				; CODE XREF: sub_401695+3EFj
		mov	eax, [esp+78h+var_1C]
		mov	[esp+78h+Code],	eax
		call	sub_401C0F
		jmp	short loc_401AB7
; ---------------------------------------------------------------------------

loc_401AA2:				; CODE XREF: sub_401695+296j
		mov	[esp+78h+Code],	offset aInvalidCommand ; "invalid command (there is no implicit	c"...
		call	sub_411114
		mov	[esp+78h+Code],	eax ; char *
		call	sub_4119FD
		nop

loc_401AB7:				; CODE XREF: sub_401695+301j
					; sub_401695+312j ...
		mov	[esp+78h+Code],	0
		call	sub_4111B0
		test	eax, eax
		setnz	al
		movzx	eax, al
		lea	esp, [ebp-8]
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_401695	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401AD2	proc near		; CODE XREF: sub_4037A4+D8p
					; sub_403BFB+1D9p ...

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], 200h
		mov	dword ptr [esp+28h+var_24], 1
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_408FD7
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 200h
		jz	short loc_401B70
		call	sub_401592
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4089EC
		test	eax, eax
		jz	short loc_401B4C
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_409E27
		mov	[esp+28h+var_20], ebx
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aErrorReadingSS ; "error reading `%s': %s\n"
		call	sub_4119FD
		jmp	short loc_401B77
; ---------------------------------------------------------------------------

loc_401B4C:				; CODE XREF: sub_401AD2+4Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_409E27
		mov	edx, [ebp+var_10]
		mov	[esp+28h+var_20], edx
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aErrorReadingSP ; "error reading `%s': premature EOF (size"...
		call	sub_4119FD
		jmp	short loc_401B77
; ---------------------------------------------------------------------------

loc_401B70:				; CODE XREF: sub_401AD2+33j
		mov	[ebp+var_C], 0

loc_401B77:				; CODE XREF: sub_401AD2+78j
					; sub_401AD2+9Cj
		mov	eax, [ebp+var_C]
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_401AD2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401B80	proc near		; CODE XREF: sub_402F43+D3p
					; sub_402F43+1E2p ...

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], 200h
		mov	dword ptr [esp+28h+var_24], 1
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_409050
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 200h
		jz	short loc_401BEB
		call	sub_401592
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_409E27
		mov	[esp+28h+var_20], ebx
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aErrorWritingSS ; "error writing `%s': %s\n"
		call	sub_4119FD
		jmp	short loc_401BF2
; ---------------------------------------------------------------------------

loc_401BEB:				; CODE XREF: sub_401B80+33j
		mov	[ebp+var_C], 0

loc_401BF2:				; CODE XREF: sub_401B80+69j
		mov	eax, [ebp+var_C]
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_401B80	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401BFB	proc near		; CODE XREF: sub_401695+38Dp

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], offset aTar_and_encryp ; "tar_and_encrypt has	not yet	been implem"...
		call	sub_4119FD
		leave
		retn
sub_401BFB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401C0F	proc near		; CODE XREF: sub_401695+406p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], offset aDecrypt_and_un ; "decrypt_and_untar has not yet been impl"...
		call	sub_4119FD
		leave
		retn
sub_401C0F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401C23	proc near		; CODE XREF: sub_401695+30Dp

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], offset aDecrypt_and_li ; "decrypt_and_list has not yet been imple"...
		call	sub_4119FD
		leave
		retn
sub_401C23	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401C37	proc near		; CODE XREF: sub_403A04+EBp
					; sub_403A04+13Ep ...

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	_mkdir
		leave
		retn
sub_401C37	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401C4A(LPCWSTR)
sub_401C4A	proc near		; CODE XREF: sub_402302+2BDp

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpWideCharStr	= dword	ptr -30h
cchWideChar	= dword	ptr -2Ch
lpMultiByteStr	= dword	ptr -28h
cbMultiByte	= dword	ptr -24h
lpDefaultChar	= dword	ptr -20h
lpUsedDefaultChar= dword ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	[esp+38h+cbMultiByte], 0 ; cbMultiByte
		mov	[esp+38h+lpMultiByteStr], 0 ; lpMultiByteStr
		mov	[esp+38h+cchWideChar], 0FFFFFFFFh ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jns	short loc_401CB8
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	locret_401D47
; ---------------------------------------------------------------------------

loc_401CB8:				; CODE XREF: sub_401C4A+55j
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[esp+38h+CodePage], eax	; size_t
		call	sub_404CAE
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_401CD6
		mov	eax, 0
		jmp	short locret_401D47
; ---------------------------------------------------------------------------

loc_401CD6:				; CODE XREF: sub_401C4A+83j
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	eax, [ebp+var_10]
		mov	[esp+38h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+var_C]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+cchWideChar], 0FFFFFFFFh ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jns	short loc_401D44
		mov	eax, [ebp+var_C]
		mov	[esp+38h+CodePage], eax	; void *
		call	sub_404E31
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	[ebp+var_C], 0

loc_401D44:				; CODE XREF: sub_401C4A+D9j
		mov	eax, [ebp+var_C]

locret_401D47:				; CODE XREF: sub_401C4A+69j
					; sub_401C4A+8Aj
		leave
		retn
sub_401C4A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_401D49(LPCSTR)
sub_401D49	proc near		; CODE XREF: sub_401EBC+3Bp
					; sub_402302+1ECp

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpMultiByteStr	= dword	ptr -30h
cbMultiByte	= dword	ptr -2Ch
lpWideCharStr	= dword	ptr -28h
cchWideChar	= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+cchWideChar], 0 ; cchWideChar
		mov	[esp+38h+lpWideCharStr], 0 ; lpWideCharStr
		mov	[esp+38h+cbMultiByte], 0FFFFFFFFh ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jns	short loc_401DA7
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	locret_401E53
; ---------------------------------------------------------------------------

loc_401DA7:				; CODE XREF: sub_401D49+45j
		mov	eax, [ebp+var_10]
		add	eax, 1
		add	eax, eax
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	edx, eax
		shr	edx, 1
		mov	eax, [ebp+var_10]
		add	eax, 1
		cmp	edx, eax
		jz	short loc_401DD7
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0
		jmp	short locret_401E53
; ---------------------------------------------------------------------------

loc_401DD7:				; CODE XREF: sub_401D49+78j
		mov	eax, [ebp+var_14]
		mov	[esp+38h+CodePage], eax	; size_t
		call	sub_404CAE
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_401DF2
		mov	eax, 0
		jmp	short locret_401E53
; ---------------------------------------------------------------------------

loc_401DF2:				; CODE XREF: sub_401D49+A0j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+var_C]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+cbMultiByte], 0FFFFFFFFh ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jns	short loc_401E50
		mov	eax, [ebp+var_C]
		mov	[esp+38h+CodePage], eax	; Memory
		call	free
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	[ebp+var_C], 0

loc_401E50:				; CODE XREF: sub_401D49+E6j
		mov	eax, [ebp+var_C]

locret_401E53:				; CODE XREF: sub_401D49+59j
					; sub_401D49+8Cj ...
		leave
		retn
sub_401D49	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401E58	proc near		; CODE XREF: sub_401E7F+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_401E78
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_401E7D
; ---------------------------------------------------------------------------

loc_401E78:				; CODE XREF: sub_401E58+7j
		mov	eax, 0

loc_401E7D:				; CODE XREF: sub_401E58+1Ej
		pop	ebp
		retn
sub_401E58	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401E7F	proc near		; CODE XREF: sub_401EA7+Ep
					; sub_40278B+2Dp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_401E58
		leave
		retn
sub_401E7F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401E9A	proc near		; CODE XREF: sub_402F43+2Ep

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_401E9A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401EA7	proc near		; CODE XREF: sub_401EBC+98p
					; sub_401EBC+F6p ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_401E7F
		leave
		retn
sub_401EA7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_401EBC	proc near		; CODE XREF: sub_402192+112p

lpFileName	= dword	ptr -68h
fInfoLevelId	= dword	ptr -64h
lpFileInformation= dword ptr -60h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
FileInformation	= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 5Ch
		mov	eax, [ebp+arg_0]
		add	eax, 38h
		mov	[ebp+var_1C], eax
		jmp	short loc_401EE4
; ---------------------------------------------------------------------------

loc_401ED0:				; CODE XREF: sub_401EBC+30j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_401EE0
		mov	eax, [ebp+var_1C]
		mov	byte ptr [eax],	5Ch

loc_401EE0:				; CODE XREF: sub_401EBC+1Cj
		add	[ebp+var_1C], 1

loc_401EE4:				; CODE XREF: sub_401EBC+12j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_401ED0
		mov	eax, [ebp+arg_0]
		add	eax, 38h
		mov	[esp+68h+lpFileName], eax ; LPCSTR
		call	sub_401D49
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_0]
		add	eax, 38h
		mov	[ebp+var_1C], eax
		jmp	short loc_401F1E
; ---------------------------------------------------------------------------

loc_401F0A:				; CODE XREF: sub_401EBC+6Aj
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_401F1A
		mov	eax, [ebp+var_1C]
		mov	byte ptr [eax],	2Fh

loc_401F1A:				; CODE XREF: sub_401EBC+56j
		add	[ebp+var_1C], 1

loc_401F1E:				; CODE XREF: sub_401EBC+4Cj
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_401F0A
		cmp	[ebp+var_20], 0
		jnz	short loc_401F5E
		mov	[esp+68h+lpFileName], 0FFFFFFFFh ; DWORD
		call	sub_414F2A
		mov	edx, [ebp+arg_0]
		add	edx, 38h
		mov	[esp+68h+lpFileInformation], eax
		mov	[esp+68h+fInfoLevelId],	edx ; char
		mov	[esp+68h+lpFileName], offset aErrorUtf8IngSS ; "error utf8-ing `%s': %s\n"
		call	sub_4119FD
		call	sub_401EA7
		jmp	loc_40218A
; ---------------------------------------------------------------------------

loc_401F5E:				; CODE XREF: sub_401EBC+70j
		lea	eax, [ebp+FileInformation]
		mov	[esp+68h+lpFileInformation], eax ; lpFileInformation
		mov	[esp+68h+fInfoLevelId],	0 ; fInfoLevelId
		mov	eax, [ebp+var_20]
		mov	[esp+68h+lpFileName], eax ; lpFileName
		mov	eax, ds:GetFileAttributesExW
		call	eax ; GetFileAttributesExW
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_401FBC
		mov	[esp+68h+lpFileName], 0FFFFFFFFh ; DWORD
		call	sub_414F2A
		mov	edx, [ebp+arg_0]
		add	edx, 38h
		mov	[esp+68h+lpFileInformation], eax
		mov	[esp+68h+fInfoLevelId],	edx ; char
		mov	[esp+68h+lpFileName], offset aErrorStatIngSS ; "error stat-ing `%s': %s\n"
		call	sub_4119FD
		mov	eax, [ebp+var_20]
		mov	[esp+68h+lpFileName], eax ; void *
		call	sub_404E31
		call	sub_401EA7
		jmp	loc_40218A
; ---------------------------------------------------------------------------

loc_401FBC:				; CODE XREF: sub_401EBC+C3j
		mov	eax, [ebp+var_20]
		mov	[esp+68h+lpFileName], eax ; void *
		call	sub_404E31
		mov	eax, [ebp+FileInformation]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		and	eax, 80h
		test	eax, eax
		jz	short loc_401FE5
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+28h], 0
		jmp	short loc_402033
; ---------------------------------------------------------------------------

loc_401FE5:				; CODE XREF: sub_401EBC+11Bj
		mov	eax, [ebp+var_24]
		and	eax, 10h
		test	eax, eax
		jz	short loc_401FFB
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+28h], 5
		jmp	short loc_402033
; ---------------------------------------------------------------------------

loc_401FFB:				; CODE XREF: sub_401EBC+131j
		mov	eax, [ebp+var_24]
		and	eax, 40h
		test	eax, eax
		jz	short loc_402011
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+28h], 9
		jmp	short loc_402033
; ---------------------------------------------------------------------------

loc_402011:				; CODE XREF: sub_401EBC+147j
		mov	eax, [ebp+var_24]
		and	eax, 1100h
		test	eax, eax
		jz	short loc_402029
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+28h], 9
		jmp	short loc_402033
; ---------------------------------------------------------------------------

loc_402029:				; CODE XREF: sub_401EBC+15Fj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+28h], 0

loc_402033:				; CODE XREF: sub_401EBC+127j
					; sub_401EBC+13Dj ...
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 1A0h
		mov	eax, [ebp+var_24]
		and	eax, 10h
		test	eax, eax
		jz	short loc_402058
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, eax
		or	edx, 48h
		mov	eax, [ebp+arg_0]
		mov	[eax+4], edx

loc_402058:				; CODE XREF: sub_401EBC+189j
		mov	eax, [ebp+var_24]
		and	eax, 1
		test	al, al
		jz	short loc_402073
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, eax
		and	dl, 7Fh
		mov	eax, [ebp+arg_0]
		mov	[eax+4], edx

loc_402073:				; CODE XREF: sub_401EBC+1A4j
		mov	eax, [ebp+var_24]
		and	eax, 2
		test	eax, eax
		jz	short loc_402091
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, eax
		and	edx, 0FFFFFE38h
		mov	eax, [ebp+arg_0]
		mov	[eax+4], edx

loc_402091:				; CODE XREF: sub_401EBC+1BFj
		mov	eax, [ebp+var_24]
		and	eax, 4
		test	eax, eax
		jz	short loc_4020AC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, eax
		or	edx, 4
		mov	eax, [ebp+arg_0]
		mov	[eax+4], edx

loc_4020AC:				; CODE XREF: sub_401EBC+1DDj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		test	eax, eax
		jnz	short loc_4020C7
		mov	eax, [ebp+var_28]
		mov	edx, 0
		mov	ecx, [ebp+arg_0]
		mov	[ecx+18h], eax
		mov	[ecx+1Ch], edx

loc_4020C7:				; CODE XREF: sub_401EBC+1F8j
		mov	eax, [ebp+var_30]
		mov	edx, 0
		mov	ecx, eax
		mov	ebx, edx
		mov	ebx, ecx
		mov	ecx, 0
		mov	eax, [ebp+var_34]
		mov	edx, 0
		mov	esi, ecx
		or	esi, eax
		mov	edi, ebx
		or	edi, edx
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], esi
		mov	[eax+24h], edi
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+24h]
		mov	eax, [eax+20h]
		or	eax, edx
		test	eax, eax
		jnz	short loc_40213A
		mov	eax, [ebp+var_40]
		mov	edx, 0
		mov	ecx, eax
		mov	ebx, edx
		mov	ebx, ecx
		mov	ecx, 0
		mov	eax, [ebp+var_44]
		mov	edx, 0
		mov	esi, ecx
		or	esi, eax
		mov	[ebp+var_50], esi
		mov	esi, ebx
		or	esi, edx
		mov	[ebp+var_4C], esi
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_50]
		mov	ecx, [ebp+var_4C]
		mov	[eax+20h], edx
		mov	[eax+24h], ecx

loc_40213A:				; CODE XREF: sub_401EBC+244j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+24h]
		mov	eax, [eax+20h]
		add	eax, 2AC18000h
		adc	edx, 0FE624E21h
		mov	ecx, [ebp+arg_0]
		mov	[ecx+20h], eax
		mov	[ecx+24h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+24h]
		mov	eax, [eax+20h]
		mov	[esp+68h+lpFileInformation], 989680h
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+lpFileName], eax
		mov	[esp+68h+fInfoLevelId],	edx
		call	sub_4180E0
		mov	ecx, [ebp+arg_0]
		mov	[ecx+20h], eax
		mov	[ecx+24h], edx
		mov	eax, 0

loc_40218A:				; CODE XREF: sub_401EBC+9Dj
					; sub_401EBC+FBj
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_401EBC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402192(int, char *, int)
sub_402192	proc near		; CODE XREF: sub_402302+3BFp
					; sub_402302+3DDp ...

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4021DD
		mov	[esp+38h+var_30], 0E3h ; int
		mov	[esp+38h+Source], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/tools/gpgtar-create"...
		mov	[esp+38h+Dest],	offset aDnamelen ; "dnamelen"
		call	sub_4185A0

loc_4021DD:				; CODE XREF: sub_402192+2Dj
		cmp	[ebp+arg_4], 0
		jz	short loc_402204
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		jmp	short loc_402209
; ---------------------------------------------------------------------------

loc_402204:				; CODE XREF: sub_402192+4Fj
		mov	eax, 0

loc_402209:				; CODE XREF: sub_402192+70j
		add	eax, [ebp+var_10]
		add	eax, 42h
		mov	[esp+38h+Source], eax ;	size_t
		mov	[esp+38h+Dest],	1 ; size_t
		call	sub_404D92
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_402232
		call	sub_401EA7
		jmp	loc_4022FC
; ---------------------------------------------------------------------------

loc_402232:				; CODE XREF: sub_402192+94j
		mov	eax, [ebp+var_14]
		lea	edx, [eax+38h]
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax
		mov	[esp+38h+Dest],	edx
		call	sub_4152CD
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_40227E
		mov	eax, [ebp+var_10]
		sub	eax, 1
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jz	short loc_40226A
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	2Fh
		add	[ebp+var_C], 1

loc_40226A:				; CODE XREF: sub_402192+CCj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Source], eax ;	Source
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy
		jmp	short loc_40229E
; ---------------------------------------------------------------------------

loc_40227E:				; CODE XREF: sub_402192+BCj
		mov	eax, [ebp+var_10]
		lea	edx, [eax-1]
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax+edx+38h]
		cmp	al, 2Fh
		jnz	short loc_40229E
		mov	eax, [ebp+var_10]
		lea	edx, [eax-1]
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax+edx+38h],	0

loc_40229E:				; CODE XREF: sub_402192+EAj
					; sub_402192+FCj
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Dest],	eax
		call	sub_401EBC
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_4022BF
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Dest],	eax ; void *
		call	sub_404E31
		jmp	short loc_4022F7
; ---------------------------------------------------------------------------

loc_4022BF:				; CODE XREF: sub_402192+11Ej
		mov	eax, ds:dword_41D8F0
		test	eax, eax
		jz	short loc_4022E3
		mov	[esp+38h+Dest],	2
		call	sub_40831E
		mov	[esp+38h+Source], eax
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Dest],	eax
		call	sub_404C53

loc_4022E3:				; CODE XREF: sub_402192+134j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_8]
		mov	[eax+4], edx

loc_4022F7:				; CODE XREF: sub_402192+12Bj
		mov	eax, 0

loc_4022FC:				; CODE XREF: sub_402192+9Bj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_402192	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402302(char *, int)
sub_402302	proc near		; CODE XREF: sub_40278B+82p

Dest		= dword	ptr -2A8h
Source		= dword	ptr -2A4h
var_2A0		= dword	ptr -2A0h
var_28C		= dword	ptr -28Ch
FindFileData	= _WIN32_FIND_DATAW ptr	-280h
var_30		= dword	ptr -30h
lpFileName	= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
hFindFile	= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 29Ch
		mov	[ebp+var_1C], 0
		mov	[ebp+hFindFile], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_402330
		mov	eax, 0
		jmp	loc_402783
; ---------------------------------------------------------------------------

loc_402330:				; CODE XREF: sub_402302+22j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_28C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_28C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 5
		mov	[esp+2A8h+Dest], eax ; size_t
		call	sub_404CAE
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_402376
		call	sub_401EA7
		mov	[ebp+var_1C], eax
		jmp	loc_40276A
; ---------------------------------------------------------------------------

loc_402376:				; CODE XREF: sub_402302+65j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset asc_41A637 ; "/"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4023B8
		mov	edx, offset asc_41A639 ; "/*"
		mov	eax, [ebp+var_28]
		movzx	ecx, word ptr [edx]
		mov	[eax], cx
		movzx	edx, byte ptr [edx+2]
		mov	[eax+2], dl
		jmp	loc_4024C2
; ---------------------------------------------------------------------------

loc_4023B8:				; CODE XREF: sub_402302+9Aj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset a_	; "."
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4023F3
		mov	edx, offset asc_41A63E ; "*"
		mov	eax, [ebp+var_28]
		movzx	edx, word ptr [edx]
		mov	[eax], dx
		jmp	loc_4024C2
; ---------------------------------------------------------------------------

loc_4023F3:				; CODE XREF: sub_402302+DCj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40244E
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_28C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_28C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_40244E
		mov	ebx, offset asc_41A63E ; "*"
		mov	eax, [ebp+arg_0]
		mov	[esp+2A8h+Source], eax
		mov	eax, [ebp+var_28]
		mov	[esp+2A8h+Dest], eax
		call	sub_4152CD
		movzx	edx, word ptr [ebx]
		mov	[eax], dx
		jmp	short loc_4024C2
; ---------------------------------------------------------------------------

loc_40244E:				; CODE XREF: sub_402302+F9j
					; sub_402302+12Bj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4024B0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_28C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_28C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jz	short loc_4024B0
		mov	ebx, offset asc_41A639 ; "/*"
		mov	eax, [ebp+arg_0]
		mov	[esp+2A8h+Source], eax
		mov	eax, [ebp+var_28]
		mov	[esp+2A8h+Dest], eax
		call	sub_4152CD
		movzx	edx, word ptr [ebx]
		mov	[eax], dx
		movzx	edx, byte ptr [ebx+2]
		mov	[eax+2], dl
		jmp	short loc_4024C2
; ---------------------------------------------------------------------------

loc_4024B0:				; CODE XREF: sub_402302+154j
					; sub_402302+186j
		mov	eax, [ebp+arg_0]
		mov	[esp+2A8h+Source], eax ; Source
		mov	eax, [ebp+var_28]
		mov	[esp+2A8h+Dest], eax ; Dest
		call	strcpy

loc_4024C2:				; CODE XREF: sub_402302+B1j
					; sub_402302+ECj ...
		mov	eax, [ebp+var_28]
		mov	[ebp+var_24], eax
		jmp	short loc_4024DE
; ---------------------------------------------------------------------------

loc_4024CA:				; CODE XREF: sub_402302+1E4j
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4024DA
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	5Ch

loc_4024DA:				; CODE XREF: sub_402302+1D0j
		add	[ebp+var_24], 1

loc_4024DE:				; CODE XREF: sub_402302+1C6j
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4024CA
		mov	eax, [ebp+var_28]
		mov	[esp+2A8h+Dest], eax ; LPCSTR
		call	sub_401D49
		mov	[ebp+lpFileName], eax
		mov	eax, [ebp+var_28]
		mov	[esp+2A8h+Dest], eax ; void *
		call	sub_404E31
		cmp	[ebp+lpFileName], 0
		jnz	short loc_402540
		call	sub_401EA7
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+2A8h+Dest], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	[esp+2A8h+Dest], offset	aErrorReadingDi	; "error reading directory `%s': %s\n"
		call	sub_411114
		mov	[esp+2A8h+var_2A0], ebx
		mov	edx, [ebp+arg_0]
		mov	[esp+2A8h+Source], edx ; char
		mov	[esp+2A8h+Dest], eax ; char *
		call	sub_4119FD
		jmp	loc_40276A
; ---------------------------------------------------------------------------

loc_402540:				; CODE XREF: sub_402302+203j
		lea	eax, [ebp+FindFileData]
		mov	[esp+2A8h+Source], eax ; lpFindFileData
		mov	eax, [ebp+lpFileName]
		mov	[esp+2A8h+Dest], eax ; lpFileName
		mov	eax, ds:FindFirstFileW
		call	eax ; FindFirstFileW
		sub	esp, 8
		mov	[ebp+hFindFile], eax
		cmp	[ebp+hFindFile], 0FFFFFFFFh
		jnz	short loc_4025A8
		call	sub_401EA7
		mov	[ebp+var_1C], eax
		mov	[esp+2A8h+Dest], 0FFFFFFFFh ; DWORD
		call	sub_414F2A
		mov	ebx, eax
		mov	[esp+2A8h+Dest], offset	aErrorReadingDi	; "error reading directory `%s': %s\n"
		call	sub_411114
		mov	[esp+2A8h+var_2A0], ebx
		mov	edx, [ebp+arg_0]
		mov	[esp+2A8h+Source], edx ; char
		mov	[esp+2A8h+Dest], eax ; char *
		call	sub_4119FD
		mov	eax, [ebp+lpFileName]
		mov	[esp+2A8h+Dest], eax ; void *
		call	sub_404E31
		jmp	loc_40276A
; ---------------------------------------------------------------------------

loc_4025A8:				; CODE XREF: sub_402302+25Fj
		mov	eax, [ebp+lpFileName]
		mov	[esp+2A8h+Dest], eax ; void *
		call	sub_404E31

loc_4025B3:				; CODE XREF: sub_402302+412j
		lea	eax, [ebp+FindFileData]
		add	eax, 2Ch
		mov	[esp+2A8h+Dest], eax ; LPCWSTR
		call	sub_401C4A
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	short loc_4025F6
		call	sub_401EA7
		mov	[ebp+var_1C], eax
		mov	[esp+2A8h+Dest], 0FFFFFFFFh ; DWORD
		call	sub_414F2A
		mov	[esp+2A8h+Source], eax ; char
		mov	[esp+2A8h+Dest], offset	aErrorUtf8IngFi	; "error utf8-ing filename: %s\n"
		call	sub_4119FD
		jmp	loc_40271A
; ---------------------------------------------------------------------------

loc_4025F6:				; CODE XREF: sub_402302+2C9j
		mov	eax, [ebp+var_30]
		mov	[ebp+var_24], eax
		jmp	short loc_402612
; ---------------------------------------------------------------------------

loc_4025FE:				; CODE XREF: sub_402302+318j
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_40260E
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	2Fh

loc_40260E:				; CODE XREF: sub_402302+304j
		add	[ebp+var_24], 1

loc_402612:				; CODE XREF: sub_402302+2FAj
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4025FE
		mov	eax, [ebp+var_30]
		mov	edx, eax
		mov	eax, offset a_	; "."
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_40266C
		mov	eax, [ebp+var_30]
		mov	edx, eax
		mov	eax, offset a__	; ".."
		mov	ecx, 3
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_402675

loc_40266C:				; CODE XREF: sub_402302+340j
		mov	[ebp+var_1C], 0
		jmp	short loc_4026E7
; ---------------------------------------------------------------------------

loc_402675:				; CODE XREF: sub_402302+368j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset a__0 ; "./"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4026CB
		mov	eax, [ebp+arg_0]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4026CB
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_4]
		mov	[esp+2A8h+var_2A0], eax	; int
		mov	eax, [ebp+var_30]
		mov	[esp+2A8h+Source], eax ; char *
		mov	[esp+2A8h+Dest], edx ; int
		call	sub_402192
		mov	[ebp+var_1C], eax
		jmp	short loc_4026E7
; ---------------------------------------------------------------------------

loc_4026CB:				; CODE XREF: sub_402302+399j
					; sub_402302+3A6j
		mov	eax, [ebp+arg_4]
		mov	[esp+2A8h+var_2A0], eax	; int
		mov	eax, [ebp+var_30]
		mov	[esp+2A8h+Source], eax ; char *
		mov	eax, [ebp+arg_0]
		mov	[esp+2A8h+Dest], eax ; int
		call	sub_402192
		mov	[ebp+var_1C], eax

loc_4026E7:				; CODE XREF: sub_402302+371j
					; sub_402302+3C7j
		mov	eax, [ebp+var_30]
		mov	[esp+2A8h+Dest], eax ; void *
		call	sub_404E31
		cmp	[ebp+var_1C], 0
		jnz	short loc_40271A
		lea	eax, [ebp+FindFileData]
		mov	[esp+2A8h+Source], eax ; lpFindFileData
		mov	eax, [ebp+hFindFile]
		mov	[esp+2A8h+Dest], eax ; hFindFile
		mov	eax, ds:FindNextFileW
		call	eax ; FindNextFileW
		sub	esp, 8
		test	eax, eax
		jnz	loc_4025B3

loc_40271A:				; CODE XREF: sub_402302+2EFj
					; sub_402302+3F4j
		cmp	[ebp+var_1C], 0
		jnz	short loc_40276A
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		cmp	eax, 12h
		jnz	short loc_402735
		mov	[ebp+var_1C], 0
		jmp	short loc_40276A
; ---------------------------------------------------------------------------

loc_402735:				; CODE XREF: sub_402302+428j
		call	sub_401EA7
		mov	[ebp+var_1C], eax
		mov	[esp+2A8h+Dest], 0FFFFFFFFh ; DWORD
		call	sub_414F2A
		mov	ebx, eax
		mov	[esp+2A8h+Dest], offset	aErrorReadingDi	; "error reading directory `%s': %s\n"
		call	sub_411114
		mov	[esp+2A8h+var_2A0], ebx
		mov	edx, [ebp+arg_0]
		mov	[esp+2A8h+Source], edx ; char
		mov	[esp+2A8h+Dest], eax ; char *
		call	sub_4119FD

loc_40276A:				; CODE XREF: sub_402302+6Fj
					; sub_402302+239j ...
		cmp	[ebp+hFindFile], 0FFFFFFFFh
		jz	short loc_402780
		mov	eax, [ebp+hFindFile]
		mov	[esp+2A8h+Dest], eax ; hFindFile
		mov	eax, ds:FindClose
		call	eax ; FindClose
		sub	esp, 4

loc_402780:				; CODE XREF: sub_402302+46Cj
		mov	eax, [ebp+var_1C]

loc_402783:				; CODE XREF: sub_402302+29j
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_402302	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40278B(char *, char)
sub_40278B	proc near		; CODE XREF: sub_40278B+D5p
					; sub_403264+2AEp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, dword ptr [ebp+arg_4]
		mov	eax, [eax+8]
		cmp	eax, 0C8h
		jle	short loc_4027C2
		mov	[esp+28h+var_28], offset aDirectoriesToo ; "directories	too deeply nested\n"
		call	sub_4119FD
		mov	[esp+28h+var_28], 21h
		call	sub_401E7F
		jmp	locret_40288F
; ---------------------------------------------------------------------------

loc_4027C2:				; CODE XREF: sub_40278B+18j
		mov	eax, dword ptr [ebp+arg_4]
		mov	eax, [eax+8]
		lea	edx, [eax+1]
		mov	eax, dword ptr [ebp+arg_4]
		mov	[eax+8], edx
		mov	eax, dword ptr [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_4027F7
		mov	[esp+28h+var_20], 195h ; int
		mov	[esp+28h+var_24], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/tools/gpgtar-create"...
		mov	[esp+28h+var_28], offset aScanctrlFlist_ ; "scanctrl->flist_tail"
		call	sub_4185A0

loc_4027F7:				; CODE XREF: sub_40278B+4Ej
		mov	eax, dword ptr [ebp+arg_4]
		mov	eax, [eax+4]
		mov	[ebp+var_14], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	char *
		call	sub_402302
		mov	eax, dword ptr [ebp+arg_4]
		mov	eax, [eax+4]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[ebp+var_C], eax
		jmp	short loc_40286D
; ---------------------------------------------------------------------------

loc_402825:				; CODE XREF: sub_40278B+F0j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+28h]
		cmp	eax, 5
		jnz	short loc_402865
		mov	eax, ds:dword_41D8F0
		cmp	eax, 1
		jle	short loc_402850
		mov	eax, [ebp+var_C]
		add	eax, 38h
		mov	[esp+28h+var_24], eax ;	char
		mov	[esp+28h+var_28], offset aScanningDirect ; "scanning directory `%s'\n"
		call	sub_4119D3

loc_402850:				; CODE XREF: sub_40278B+ADj
		mov	eax, [ebp+var_C]
		lea	edx, [eax+38h]
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	char
		mov	[esp+28h+var_28], edx ;	char *
		call	sub_40278B

loc_402865:				; CODE XREF: sub_40278B+A3j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_40286D:				; CODE XREF: sub_40278B+98j
		cmp	[ebp+var_C], 0
		jz	short loc_40287D
		mov	eax, [ebp+var_18]
		mov	eax, [eax]
		cmp	eax, [ebp+var_C]
		jnz	short loc_402825

loc_40287D:				; CODE XREF: sub_40278B+E6j
		mov	eax, dword ptr [ebp+arg_4]
		mov	eax, [eax+8]
		lea	edx, [eax-1]
		mov	eax, dword ptr [ebp+arg_4]
		mov	[eax+8], edx
		mov	eax, [ebp+var_10]

locret_40288F:				; CODE XREF: sub_40278B+32j
		leave
		retn
sub_40278B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402891	proc near		; CODE XREF: sub_403264+24Dp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4028A5
		mov	eax, 0
		jmp	short loc_40291F
; ---------------------------------------------------------------------------

loc_4028A5:				; CODE XREF: sub_402891+Bj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Eh
		jnz	short loc_4028C3
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Eh
		jnz	short loc_4028C3
		mov	eax, 0
		jmp	short loc_40291F
; ---------------------------------------------------------------------------

loc_4028C3:				; CODE XREF: sub_402891+1Cj
					; sub_402891+29j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jz	short loc_4028D7
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_4028DE

loc_4028D7:				; CODE XREF: sub_402891+3Aj
		mov	eax, 0
		jmp	short loc_40291F
; ---------------------------------------------------------------------------

loc_4028DE:				; CODE XREF: sub_402891+44j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_4028F2
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ah
		jle	short loc_402906

loc_4028F2:				; CODE XREF: sub_402891+55j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_40291A
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ah
		jg	short loc_40291A

loc_402906:				; CODE XREF: sub_402891+5Fj
		mov	eax, [ebp+arg_0]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_40291A
		mov	eax, 0
		jmp	short loc_40291F
; ---------------------------------------------------------------------------

loc_40291A:				; CODE XREF: sub_402891+69j
					; sub_402891+73j ...
		mov	eax, 1

loc_40291F:				; CODE XREF: sub_402891+12j
					; sub_402891+30j ...
		pop	ebp
		retn
sub_402891	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402921	proc near		; CODE XREF: sub_402B7A+1AEp
					; sub_402B7A+1D7p ...

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_30], eax
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_2C], eax
		cmp	[ebp+arg_4], 1
		ja	short loc_402955
		mov	[esp+48h+var_40], 1C4h ; int
		mov	[esp+48h+var_44], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/tools/gpgtar-create"...
		mov	[esp+48h+var_48], offset aLength1 ; "length > 1"
		call	sub_4185A0

loc_402955:				; CODE XREF: sub_402921+16j
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		sub	[ebp+var_10], 1

loc_402986:				; CODE XREF: sub_402921+A0j
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_18]
		and	eax, 7
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		shrd	eax, edx, 3
		shr	edx, 3
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		or	eax, edx
		test	eax, eax
		jz	short loc_4029C3
		cmp	[ebp+var_10], 0
		jnz	short loc_402986

loc_4029C3:				; CODE XREF: sub_402921+9Aj
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		or	eax, edx
		test	eax, eax
		jnz	short loc_4029EA
		jmp	short loc_4029DF
; ---------------------------------------------------------------------------

loc_4029D1:				; CODE XREF: sub_402921+C2j
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	30h
		sub	[ebp+var_10], 1

loc_4029DF:				; CODE XREF: sub_402921+AEj
		cmp	[ebp+var_10], 0
		jnz	short loc_4029D1
		jmp	locret_402ABA
; ---------------------------------------------------------------------------

loc_4029EA:				; CODE XREF: sub_402921+ACj
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax

loc_402A0D:				; CODE XREF: sub_402921+121j
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_18]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		shrd	eax, edx, 8
		shr	edx, 8
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		or	eax, edx
		test	eax, eax
		jz	short loc_402A44
		cmp	[ebp+var_10], 0
		jnz	short loc_402A0D

loc_402A44:				; CODE XREF: sub_402921+11Bj
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		or	eax, edx
		test	eax, eax
		jnz	short loc_402A9E
		jmp	short loc_402A60
; ---------------------------------------------------------------------------

loc_402A52:				; CODE XREF: sub_402921+143j
		sub	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		sub	[ebp+var_10], 1

loc_402A60:				; CODE XREF: sub_402921+12Fj
		cmp	[ebp+var_10], 0
		jnz	short loc_402A52
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_402A8C
		mov	[esp+48h+var_40], offset aStore_xoctal ; "store_xoctal"
		mov	[esp+48h+var_44], 1EAh
		mov	[esp+48h+var_48], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/tools/gpgtar-create"...
		call	sub_411B8C
; ---------------------------------------------------------------------------

loc_402A8C:				; CODE XREF: sub_402921+14Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		or	edx, 0FFFFFF80h
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		jmp	short locret_402ABA
; ---------------------------------------------------------------------------

loc_402A9E:				; CODE XREF: sub_402921+12Dj
		mov	[esp+48h+var_40], offset aStore_xoctal ; "store_xoctal"
		mov	[esp+48h+var_44], 1EEh
		mov	[esp+48h+var_48], offset a____Gnupg22_0_ ; "../../gnupg2-2.0.30/tools/gpgtar-create"...
		call	sub_411B8C
; ---------------------------------------------------------------------------

locret_402ABA:				; CODE XREF: sub_402921+C4j
					; sub_402921+17Bj
		leave
		retn
sub_402921	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402ABC(int, size_t, int)
sub_402ABC	proc near		; CODE XREF: sub_402B7A+31Ap

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_41D060
		test	eax, eax
		jz	short loc_402AD5
		mov	eax, ds:dword_41D064
		cmp	[ebp+arg_8], eax
		jz	short loc_402AFF

loc_402AD5:				; CODE XREF: sub_402ABC+Dj
		cmp	[ebp+arg_8], 0
		jz	short loc_402AE2
		mov	eax, offset aUser ; "user"
		jmp	short loc_402AE7
; ---------------------------------------------------------------------------

loc_402AE2:				; CODE XREF: sub_402ABC+1Dj
		mov	eax, offset aRoot ; "root"

loc_402AE7:				; CODE XREF: sub_402ABC+24j
		mov	[esp+18h+var_10], 20h ;	size_t
		mov	[esp+18h+var_14], eax ;	int
		mov	[esp+18h+var_18], offset dword_41D080 ;	int
		call	sub_413FBC

loc_402AFF:				; CODE XREF: sub_402ABC+17j
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_10], eax ;	size_t
		mov	[esp+18h+var_14], offset dword_41D080 ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_413FBC
		leave
		retn
sub_402ABC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_402B1B(int, size_t, int)
sub_402B1B	proc near		; CODE XREF: sub_402B7A+33Dp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_41D020
		test	eax, eax
		jz	short loc_402B34
		mov	eax, ds:dword_41D024
		cmp	[ebp+arg_8], eax
		jz	short loc_402B5E

loc_402B34:				; CODE XREF: sub_402B1B+Dj
		cmp	[ebp+arg_8], 0
		jz	short loc_402B41
		mov	eax, offset aUsers ; "users"
		jmp	short loc_402B46
; ---------------------------------------------------------------------------

loc_402B41:				; CODE XREF: sub_402B1B+1Dj
		mov	eax, offset aRoot ; "root"

loc_402B46:				; CODE XREF: sub_402B1B+24j
		mov	[esp+18h+var_10], 20h ;	size_t
		mov	[esp+18h+var_14], eax ;	int
		mov	[esp+18h+var_18], offset dword_41D040 ;	int
		call	sub_413FBC

loc_402B5E:				; CODE XREF: sub_402B1B+17j
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_10], eax ;	size_t
		mov	[esp+18h+var_14], offset dword_41D040 ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	int
		call	sub_413FBC
		leave
		retn
sub_402B1B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402B7A	proc near		; CODE XREF: sub_402F43+1Ap

Dst		= dword	ptr -48h
Src		= dword	ptr -44h
Size		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	ebx, 200h
		mov	eax, 0
		mov	ecx, edx
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_402BA8
		mov	[edx], al
		add	edx, 1
		sub	ebx, 1

loc_402BA8:				; CODE XREF: sub_402B7A+24j
		mov	ecx, edx
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_402BBA
		mov	[edx], ax
		add	edx, 2
		sub	ebx, 2

loc_402BBA:				; CODE XREF: sub_402B7A+35j
		mov	ecx, ebx
		shr	ecx, 2
		mov	edi, edx
		rep stosd
		mov	edx, edi
		mov	ecx, ebx
		and	ecx, 2
		test	ecx, ecx
		jz	short loc_402BD4
		mov	[edx], ax
		add	edx, 2

loc_402BD4:				; CODE XREF: sub_402B7A+52j
		mov	ecx, ebx
		and	ecx, 1
		test	ecx, ecx
		jz	short loc_402BE2
		mov	[edx], al
		add	edx, 1

loc_402BE2:				; CODE XREF: sub_402B7A+61j
		mov	eax, [ebp+arg_4]
		add	eax, 38h
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 63h
		ja	short loc_402C30
		mov	eax, [ebp+arg_4]
		add	eax, 38h
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	ecx, [ebp+var_1C]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		jmp	loc_402D04
; ---------------------------------------------------------------------------

loc_402C30:				; CODE XREF: sub_402B7A+91j
		mov	eax, 9Bh
		cmp	[ebp+var_1C], 9Bh
		cmovbe	eax, [ebp+var_1C]
		mov	[ebp+var_C], eax
		sub	[ebp+var_C], 1
		jmp	short loc_402C5E
; ---------------------------------------------------------------------------

loc_402C49:				; CODE XREF: sub_402B7A+E8j
		mov	eax, [ebp+arg_4]
		add	eax, [ebp+var_C]
		add	eax, 30h
		movzx	eax, byte ptr [eax+8]
		cmp	al, 2Fh
		jz	short loc_402C66
		sub	[ebp+var_C], 1

loc_402C5E:				; CODE XREF: sub_402B7A+CDj
		cmp	[ebp+var_C], 0
		jnz	short loc_402C49
		jmp	short loc_402C67
; ---------------------------------------------------------------------------

loc_402C66:				; CODE XREF: sub_402B7A+DEj
		nop

loc_402C67:				; CODE XREF: sub_402B7A+EAj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, 63h
		ja	short loc_402CC8
		mov	eax, [ebp+arg_4]
		add	eax, 38h
		mov	edx, eax
		mov	eax, [ebp+var_18]
		add	eax, 159h
		mov	ecx, [ebp+var_C]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_1C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+arg_4]
		add	eax, 38h
		mov	edx, [ebp+var_C]
		add	edx, 1
		add	edx, eax
		mov	eax, [ebp+var_18]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		jmp	short loc_402D04
; ---------------------------------------------------------------------------

loc_402CC8:				; CODE XREF: sub_402B7A+FCj
		mov	[esp+48h+Dst], 43h
		call	sub_401E7F
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	[esp+48h+Dst], eax
		call	gpg_strerror
		mov	edx, [ebp+arg_4]
		add	edx, 38h
		mov	[esp+48h+Size],	eax
		mov	[esp+48h+Src], edx ; char
		mov	[esp+48h+Dst], offset aErrorStoringFi ;	"error storing file `%s': %s\n"
		call	sub_4119FD
		mov	eax, [ebp+var_20]
		jmp	loc_402F3C
; ---------------------------------------------------------------------------

loc_402D04:				; CODE XREF: sub_402B7A+B1j
					; sub_402B7A+14Cj
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, 0
		mov	ecx, [ebp+var_18]
		add	ecx, 64h
		mov	[esp+48h+Size],	eax
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+Src], 8
		mov	[esp+48h+Dst], ecx
		call	sub_402921
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+0Ch]
		mov	edx, 0
		mov	ecx, [ebp+var_18]
		add	ecx, 6Ch
		mov	[esp+48h+Size],	eax
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+Src], 8
		mov	[esp+48h+Dst], ecx
		call	sub_402921
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+10h]
		mov	edx, 0
		mov	ecx, [ebp+var_18]
		add	ecx, 74h
		mov	[esp+48h+Size],	eax
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+Src], 8
		mov	[esp+48h+Dst], ecx
		call	sub_402921
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+1Ch]
		mov	eax, [eax+18h]
		mov	ecx, [ebp+var_18]
		add	ecx, 7Ch
		mov	[esp+48h+Size],	eax
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+Src], 0Ch
		mov	[esp+48h+Dst], ecx
		call	sub_402921
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+24h]
		mov	eax, [eax+20h]
		mov	ecx, [ebp+var_18]
		add	ecx, 88h
		mov	[esp+48h+Size],	eax
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+Src], 0Ch
		mov	[esp+48h+Dst], ecx
		call	sub_402921
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+28h]
		cmp	eax, 6		; switch 7 cases
		ja	short loc_402E38 ; jumptable 00402DE2 default case
		mov	eax, ds:off_41A714[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_402DE4:				; CODE XREF: sub_402B7A+268j
					; DATA XREF: .rdata:off_41A714o
		mov	eax, [ebp+var_18] ; jumptable 00402DE2 case 0
		mov	byte ptr [eax+9Ch], 30h
		jmp	short loc_402E49
; ---------------------------------------------------------------------------

loc_402DF0:				; CODE XREF: sub_402B7A+268j
					; DATA XREF: .rdata:off_41A714o
		mov	eax, [ebp+var_18] ; jumptable 00402DE2 case 1
		mov	byte ptr [eax+9Ch], 31h
		jmp	short loc_402E49
; ---------------------------------------------------------------------------

loc_402DFC:				; CODE XREF: sub_402B7A+268j
					; DATA XREF: .rdata:off_41A714o
		mov	eax, [ebp+var_18] ; jumptable 00402DE2 case 2
		mov	byte ptr [eax+9Ch], 32h
		jmp	short loc_402E49
; ---------------------------------------------------------------------------

loc_402E08:				; CODE XREF: sub_402B7A+268j
					; DATA XREF: .rdata:off_41A714o
		mov	eax, [ebp+var_18] ; jumptable 00402DE2 case 3
		mov	byte ptr [eax+9Ch], 33h
		jmp	short loc_402E49
; ---------------------------------------------------------------------------

loc_402E14:				; CODE XREF: sub_402B7A+268j
					; DATA XREF: .rdata:off_41A714o
		mov	eax, [ebp+var_18] ; jumptable 00402DE2 case 4
		mov	byte ptr [eax+9Ch], 34h
		jmp	short loc_402E49
; ---------------------------------------------------------------------------

loc_402E20:				; CODE XREF: sub_402B7A+268j
					; DATA XREF: .rdata:off_41A714o
		mov	eax, [ebp+var_18] ; jumptable 00402DE2 case 5
		mov	byte ptr [eax+9Ch], 35h
		jmp	short loc_402E49
; ---------------------------------------------------------------------------

loc_402E2C:				; CODE XREF: sub_402B7A+268j
					; DATA XREF: .rdata:off_41A714o
		mov	eax, [ebp+var_18] ; jumptable 00402DE2 case 6
		mov	byte ptr [eax+9Ch], 36h
		jmp	short loc_402E49
; ---------------------------------------------------------------------------

loc_402E38:				; CODE XREF: sub_402B7A+25Fj
		mov	[esp+48h+Dst], 3Ch ; jumptable 00402DE2	default	case
		call	sub_401E7F
		jmp	loc_402F3C
; ---------------------------------------------------------------------------

loc_402E49:				; CODE XREF: sub_402B7A+274j
					; sub_402B7A+280j ...
		mov	edx, offset aUstar ; "ustar"
		mov	eax, [ebp+var_18]
		add	eax, 101h
		mov	ecx, [edx]
		mov	[eax], ecx
		movzx	edx, word ptr [edx+4]
		mov	[eax+4], dx
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax+107h], 30h
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax+108h], 30h
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+0Ch]
		mov	edx, [ebp+var_18]
		add	edx, 109h
		mov	[esp+48h+Size],	eax ; int
		mov	[esp+48h+Src], 20h ; size_t
		mov	[esp+48h+Dst], edx ; int
		call	sub_402ABC
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+10h]
		mov	edx, [ebp+var_18]
		add	edx, 129h
		mov	[esp+48h+Size],	eax ; int
		mov	[esp+48h+Src], 20h ; size_t
		mov	[esp+48h+Dst], edx ; int
		call	sub_402B1B
		mov	eax, [ebp+var_18]
		add	eax, 94h
		mov	dword ptr [eax], 20202020h
		mov	dword ptr [eax+4], 20202020h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	short loc_402EFB
; ---------------------------------------------------------------------------

loc_402EE7:				; CODE XREF: sub_402B7A+388j
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		add	[ebp+var_10], eax
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_402EFB:				; CODE XREF: sub_402B7A+36Bj
		cmp	[ebp+var_C], 1FFh
		jbe	short loc_402EE7
		mov	eax, [ebp+var_10]
		mov	edx, 0
		mov	ecx, [ebp+var_18]
		add	ecx, 94h
		mov	[esp+48h+Size],	eax
		mov	[esp+48h+var_3C], edx
		mov	[esp+48h+Src], 7
		mov	[esp+48h+Dst], ecx
		call	sub_402921
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax+9Bh], 20h
		mov	eax, 0

loc_402F3C:				; CODE XREF: sub_402B7A+185j
					; sub_402B7A+2CAj
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_402B7A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_402F43	proc near		; CODE XREF: sub_403264+3CFp

var_238		= dword	ptr -238h
var_234		= byte ptr -234h
var_230		= dword	ptr -230h
var_22C		= dword	ptr -22Ch
var_21C		= byte ptr -21Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 234h
		mov	eax, [ebp+arg_4]
		mov	dword ptr [esp+238h+var_234], eax
		lea	eax, [ebp+var_21C]
		mov	[esp+238h+var_238], eax
		call	sub_402B7A
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_402FA0
		mov	eax, [ebp+var_C]
		mov	[esp+238h+var_238], eax
		call	sub_401E9A
		cmp	eax, 3Ch
		jnz	short loc_402F98
		mov	eax, [ebp+arg_4]
		add	eax, 38h
		mov	dword ptr [esp+238h+var_234], eax ; char
		mov	[esp+238h+var_238], offset aSkippingUnsupp ; "skipping unsupported file	`%s'\n"
		call	sub_4119D3
		mov	[ebp+var_C], 0

loc_402F98:				; CODE XREF: sub_402F43+36j
		mov	eax, [ebp+var_C]
		jmp	loc_4031F5
; ---------------------------------------------------------------------------

loc_402FA0:				; CODE XREF: sub_402F43+26j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+28h]
		test	eax, eax
		jnz	short loc_402FFF
		mov	edx, offset aRb	; "rb"
		mov	eax, [ebp+arg_4]
		add	eax, 38h
		mov	dword ptr [esp+238h+var_234], edx ; int
		mov	[esp+238h+var_238], eax	; char *
		call	sub_407B8B
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_403006
		call	sub_401EA7
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+238h+var_238], eax
		call	gpg_strerror
		mov	edx, [ebp+arg_4]
		add	edx, 38h
		mov	[esp+238h+var_230], eax
		mov	dword ptr [esp+238h+var_234], edx ; char
		mov	[esp+238h+var_238], offset aCanTOpenSSSkip ; "can't open `%s': %s - skipped\n"
		call	sub_4119FD
		mov	eax, [ebp+var_C]
		jmp	loc_4031F5
; ---------------------------------------------------------------------------

loc_402FFF:				; CODE XREF: sub_402F43+65j
		mov	[ebp+var_10], 0

loc_403006:				; CODE XREF: sub_402F43+85j
		lea	eax, [ebp+var_21C]
		mov	dword ptr [esp+238h+var_234], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+238h+var_238], eax
		call	sub_401B80
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	loc_4031A2
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+28h]
		test	eax, eax
		jnz	loc_4031A6
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+1Ch]
		mov	eax, [eax+18h]
		add	eax, 1FFh
		adc	edx, 0
		shrd	eax, edx, 9
		shr	edx, 9
		mov	ecx, [ebp+arg_4]
		mov	[ecx+30h], eax
		mov	[ecx+34h], edx
		mov	[ebp+var_18], 0
		jmp	loc_403133
; ---------------------------------------------------------------------------

loc_403063:				; CODE XREF: sub_402F43+213j
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+34h]
		mov	eax, [eax+30h]
		or	eax, edx
		test	eax, eax
		jnz	short loc_403082
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+1Ch]
		mov	eax, [eax+18h]
		and	eax, 1FFh
		jmp	short loc_403087
; ---------------------------------------------------------------------------

loc_403082:				; CODE XREF: sub_402F43+12Dj
		mov	eax, 200h

loc_403087:				; CODE XREF: sub_402F43+13Dj
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_403097
		mov	[ebp+var_14], 200h

loc_403097:				; CODE XREF: sub_402F43+14Bj
		lea	eax, [ebp+var_21C]
		mov	edx, [ebp+var_10]
		mov	[esp+238h+var_22C], edx
		mov	edx, [ebp+var_14]
		mov	[esp+238h+var_230], edx
		mov	dword ptr [esp+238h+var_234], 1
		mov	[esp+238h+var_238], eax
		call	sub_408FD7
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		cmp	eax, [ebp+var_14]
		jz	short loc_40310E
		call	sub_401EA7
		mov	[ebp+var_C], eax
		cmp	[ebp+var_18], 0
		jz	short loc_4030DB
		mov	ebx, offset aFileShrunk? ; " (file shrunk?)"
		jmp	short loc_4030E0
; ---------------------------------------------------------------------------

loc_4030DB:				; CODE XREF: sub_402F43+18Fj
		mov	ebx, offset byte_41A783

loc_4030E0:				; CODE XREF: sub_402F43+196j
		mov	eax, [ebp+var_C]
		mov	[esp+238h+var_238], eax
		call	gpg_strerror
		mov	edx, [ebp+arg_4]
		add	edx, 38h
		mov	[esp+238h+var_22C], ebx
		mov	[esp+238h+var_230], eax
		mov	dword ptr [esp+238h+var_234], edx ; char
		mov	[esp+238h+var_238], offset aErrorReadingFi ; "error reading file `%s': %s%s\n"
		call	sub_4119FD
		jmp	loc_4031A6
; ---------------------------------------------------------------------------

loc_40310E:				; CODE XREF: sub_402F43+181j
		mov	[ebp+var_18], 1
		lea	eax, [ebp+var_21C]
		mov	dword ptr [esp+238h+var_234], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+238h+var_238], eax
		call	sub_401B80
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_4031A5

loc_403133:				; CODE XREF: sub_402F43+11Bj
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+34h]
		mov	eax, [eax+30h]
		mov	ecx, eax
		or	ecx, edx
		test	ecx, ecx
		setnz	cl
		add	eax, 0FFFFFFFFh
		adc	edx, 0FFFFFFFFh
		mov	ebx, [ebp+arg_4]
		mov	[ebx+30h], eax
		mov	[ebx+34h], edx
		test	cl, cl
		jnz	loc_403063
		lea	eax, [ebp+var_21C]
		mov	edx, [ebp+var_10]
		mov	[esp+238h+var_22C], edx
		mov	[esp+238h+var_230], 1
		mov	dword ptr [esp+238h+var_234], 1
		mov	[esp+238h+var_238], eax
		call	sub_408FD7
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_4031A6
		mov	eax, [ebp+arg_4]
		add	eax, 38h
		mov	dword ptr [esp+238h+var_234], eax ; char
		mov	[esp+238h+var_238], offset aNoteFileSHasGr ; "note: file `%s' has grown\n"
		call	sub_4119D3
		jmp	short loc_4031A6
; ---------------------------------------------------------------------------

loc_4031A2:				; CODE XREF: sub_402F43+DFj
		nop
		jmp	short loc_4031A6
; ---------------------------------------------------------------------------

loc_4031A5:				; CODE XREF: sub_402F43+1EEj
		nop

loc_4031A6:				; CODE XREF: sub_402F43+EDj
					; sub_402F43+1C6j ...
		cmp	[ebp+var_C], 0
		jz	short loc_4031B9
		mov	eax, [ebp+var_10]
		mov	[esp+238h+var_238], eax	; void *
		call	sub_4087A2
		jmp	short loc_4031F2
; ---------------------------------------------------------------------------

loc_4031B9:				; CODE XREF: sub_402F43+267j
		mov	eax, [ebp+var_10]
		mov	[esp+238h+var_238], eax	; void *
		call	sub_4087A2
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4031F2
		mov	eax, [ebp+var_C]
		mov	[esp+238h+var_238], eax
		call	gpg_strerror
		mov	edx, [ebp+arg_4]
		add	edx, 38h
		mov	[esp+238h+var_230], eax
		mov	dword ptr [esp+238h+var_234], edx ; char
		mov	[esp+238h+var_238], offset aErrorClosingFi ; "error closing file `%s': %s\n"
		call	sub_4119FD

loc_4031F2:				; CODE XREF: sub_402F43+274j
					; sub_402F43+288j
		mov	eax, [ebp+var_C]

loc_4031F5:				; CODE XREF: sub_402F43+58j
					; sub_402F43+B7j
		add	esp, 234h
		pop	ebx
		pop	ebp
		retn
sub_402F43	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4031FE	proc near		; CODE XREF: sub_403264+3F1p

var_228		= dword	ptr -228h
var_224		= dword	ptr -224h
var_20C		= byte ptr -20Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 220h
		lea	eax, [ebp+var_20C]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 80h
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		lea	eax, [ebp+var_20C]
		mov	[esp+228h+var_224], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+228h+var_228], eax
		call	sub_401B80
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_403257
		lea	eax, [ebp+var_20C]
		mov	[esp+228h+var_224], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+228h+var_228], eax
		call	sub_401B80
		mov	[ebp+var_C], eax

loc_403257:				; CODE XREF: sub_4031FE+3Fj
		mov	eax, [ebp+var_C]
		add	esp, 220h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_4031FE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403264	proc near		; CODE XREF: sub_401695+36Fp

var_1054	= byte ptr -1054h
var_54		= byte ptr -54h
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
Filename	= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		mov	eax, 105Ch
		call	sub_4180B0
		sub	esp, eax
		mov	[ebp+var_1C], 0
		lea	eax, [ebp+var_54]
		mov	dword ptr [ebp+var_40],	eax
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 0
		cmp	[ebp+arg_0], 0
		jnz	short loc_4032BB
		mov	[esp+0Ch+Filename], 0
		call	sub_40831E
		mov	[esp+0Ch+Filename], eax
		call	sub_408924
		mov	[esp+0Ch+var_8], 8000h
		mov	[esp+0Ch+Filename], eax
		call	_setmode

loc_4032BB:				; CODE XREF: sub_403264+31j
		mov	eax, dword ptr [ebp+var_40]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	edx, dword ptr [ebp+var_40]
		mov	eax, dword ptr [ebp+var_40]
		mov	[eax+4], edx
		jmp	loc_403528
; ---------------------------------------------------------------------------

loc_4032E0:				; CODE XREF: sub_403264+2C8j
		mov	[ebp+var_34], 0
		cmp	[ebp+arg_0], 0
		jz	short loc_403324
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_44], eax
		cmp	[ebp+var_44], 0
		jz	loc_403534
		add	[ebp+arg_0], 4
		mov	eax, [ebp+var_44]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_403524
		mov	eax, [ebp+var_44]
		mov	[esp+0Ch+Filename], eax	; char *
		call	sub_404CF8
		mov	[ebp+var_2C], eax
		jmp	loc_40342B
; ---------------------------------------------------------------------------

loc_403324:				; CODE XREF: sub_403264+87j
		mov	[ebp+var_3C], 0
		jmp	short loc_40332E
; ---------------------------------------------------------------------------

loc_40332D:				; CODE XREF: sub_403264+18Fj
		nop

loc_40332E:				; CODE XREF: sub_403264+C7j
		mov	[esp+0Ch+Filename], 0
		call	sub_40831E
		mov	[esp+0Ch+Filename], eax
		call	sub_408D8D
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0FFFFFFFFh
		jnz	short loc_4033A7
		mov	[esp+0Ch+Filename], 0
		call	sub_40831E
		mov	[esp+0Ch+Filename], eax
		call	sub_4089EC
		test	eax, eax
		jz	short loc_403399
		call	sub_401EA7
		mov	[ebp+var_1C], eax
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+0Ch+Filename], eax	; int
		call	strerror
		mov	[esp+0Ch+var_4], eax
		mov	[esp+0Ch+var_8], offset	aStdin ; "[stdin]"
		mov	[esp+0Ch+Filename], offset aErrorReading_0 ; "error reading `%s': %s\n"
		call	sub_4119FD
		jmp	loc_403660
; ---------------------------------------------------------------------------

loc_403399:				; CODE XREF: sub_403264+FDj
		mov	[ebp+var_38], 0
		mov	[ebp+var_28], 1

loc_4033A7:				; CODE XREF: sub_403264+E5j
		cmp	[ebp+var_3C], 0FFEh
		jbe	short loc_4033DB
		cmp	[ebp+var_34], 0
		jnz	short loc_4033EF
		mov	[ebp+var_34], 1
		mov	[esp+0Ch+var_4], offset	aFilenameTooLon	; "filename too	long"
		mov	[esp+0Ch+var_8], offset	aStdin ; "[stdin]"
		mov	[esp+0Ch+Filename], offset aErrorReading_0 ; "error reading `%s': %s\n"
		call	sub_4119FD
		jmp	short loc_4033EF
; ---------------------------------------------------------------------------

loc_4033DB:				; CODE XREF: sub_403264+14Aj
		mov	eax, [ebp+var_38]
		mov	edx, eax
		lea	eax, [ebp+var_1054]
		add	eax, [ebp+var_3C]
		mov	[eax], dl
		add	[ebp+var_3C], 1

loc_4033EF:				; CODE XREF: sub_403264+150j
					; sub_403264+175j
		cmp	[ebp+var_38], 0
		jnz	loc_40332D
		lea	eax, [ebp+var_1054]
		add	eax, [ebp+var_3C]
		mov	byte ptr [eax],	0
		nop
		cmp	[ebp+var_34], 0
		jnz	loc_403527
		cmp	[ebp+var_3C], 1
		jbe	loc_403527
		lea	eax, [ebp+var_1054]
		mov	[esp+0Ch+Filename], eax	; char *
		call	sub_404CF8
		mov	[ebp+var_2C], eax

loc_40342B:				; CODE XREF: sub_403264+BBj
		cmp	[ebp+var_2C], 0
		jnz	short loc_403459
		call	sub_401EA7
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0Ch+Filename], eax
		call	gpg_strerror
		mov	[esp+0Ch+var_8], eax ; char
		mov	[esp+0Ch+Filename], offset aMemoryAllocati ; "memory allocation	problem: %s\n"
		call	sub_4119FD
		jmp	loc_403660
; ---------------------------------------------------------------------------

loc_403459:				; CODE XREF: sub_403264+1CBj
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_30], eax
		jmp	short loc_403475
; ---------------------------------------------------------------------------

loc_403461:				; CODE XREF: sub_403264+219j
		mov	eax, [ebp+var_30]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_403471
		mov	eax, [ebp+var_30]
		mov	byte ptr [eax],	2Fh

loc_403471:				; CODE XREF: sub_403264+205j
		add	[ebp+var_30], 1

loc_403475:				; CODE XREF: sub_403264+1FBj
		mov	eax, [ebp+var_30]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_403461
		mov	eax, ds:dword_41D8F0
		cmp	eax, 1
		jle	short loc_40349C
		mov	eax, [ebp+var_2C]
		mov	[esp+0Ch+var_8], eax ; char
		mov	[esp+0Ch+Filename], offset aScanningS ;	"scanning `%s'\n"
		call	sub_4119D3

loc_40349C:				; CODE XREF: sub_403264+223j
		mov	eax, dword ptr [ebp+var_40]
		mov	eax, [eax+4]
		mov	[ebp+var_48], eax
		cmp	[ebp+var_34], 0
		jnz	short loc_4034BA
		mov	eax, [ebp+var_2C]
		mov	[esp+0Ch+Filename], eax
		call	sub_402891
		test	eax, eax
		jnz	short loc_4034CF

loc_4034BA:				; CODE XREF: sub_403264+245j
		mov	eax, [ebp+var_2C]
		mov	[esp+0Ch+var_8], eax ; char
		mov	[esp+0Ch+Filename], offset aSkippingInvali ; "skipping invalid name `%s'\n"
		call	sub_4119FD
		jmp	short loc_403517
; ---------------------------------------------------------------------------

loc_4034CF:				; CODE XREF: sub_403264+254j
		mov	eax, dword ptr [ebp+var_40]
		mov	[esp+0Ch+var_4], eax ; int
		mov	[esp+0Ch+var_8], 0 ; char *
		mov	eax, [ebp+var_2C]
		mov	[esp+0Ch+Filename], eax	; int
		call	sub_402192
		test	eax, eax
		jnz	short loc_403517
		mov	eax, [ebp+var_48]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_403517
		mov	eax, [ebp+var_48]
		mov	eax, [eax]
		mov	eax, [eax+28h]
		and	eax, 5
		test	eax, eax
		jz	short loc_403517
		mov	eax, dword ptr [ebp+var_40]
		mov	[esp+0Ch+var_8], eax ; char
		mov	eax, [ebp+var_2C]
		mov	[esp+0Ch+Filename], eax	; char *
		call	sub_40278B

loc_403517:				; CODE XREF: sub_403264+269j
					; sub_403264+287j ...
		mov	eax, [ebp+var_2C]
		mov	[esp+0Ch+Filename], eax	; void *
		call	sub_404E31
		jmp	short loc_403528
; ---------------------------------------------------------------------------

loc_403524:				; CODE XREF: sub_403264+A7j
		nop
		jmp	short loc_403528
; ---------------------------------------------------------------------------

loc_403527:				; CODE XREF: sub_403264+1A6j
					; sub_403264+1B0j
		nop

loc_403528:				; CODE XREF: sub_403264+77j
					; sub_403264+2BEj ...
		cmp	[ebp+var_28], 0
		jz	loc_4032E0
		jmp	short loc_403535
; ---------------------------------------------------------------------------

loc_403534:				; CODE XREF: sub_403264+95j
		nop

loc_403535:				; CODE XREF: sub_403264+2CEj
		mov	eax, ds:Filename
		test	eax, eax
		jz	loc_4035D8
		mov	eax, ds:Filename
		mov	edx, eax
		mov	eax, offset asc_41A85A ; "-"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40357D
		mov	[esp+0Ch+Filename], 1
		call	sub_40831E
		mov	[ebp+var_24], eax
		jmp	short loc_403596
; ---------------------------------------------------------------------------

loc_40357D:				; CODE XREF: sub_403264+306j
		mov	edx, offset aWb	; "wb"
		mov	eax, ds:Filename
		mov	[esp+0Ch+var_8], edx ; int
		mov	[esp+0Ch+Filename], eax	; char *
		call	sub_407B8B
		mov	[ebp+var_24], eax

loc_403596:				; CODE XREF: sub_403264+317j
		cmp	[ebp+var_24], 0
		jnz	short loc_4035E7
		call	sub_401EA7
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0Ch+Filename], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	esi, ds:Filename
		mov	[esp+0Ch+Filename], offset aCanTCreateSS ; "can't create `%s': %s\n"
		call	sub_411114
		mov	[esp+0Ch+var_4], ebx
		mov	[esp+0Ch+var_8], esi ; char
		mov	[esp+0Ch+Filename], eax	; char *
		call	sub_4119FD
		jmp	loc_403660
; ---------------------------------------------------------------------------

loc_4035D8:				; CODE XREF: sub_403264+2D8j
		mov	[esp+0Ch+Filename], 1
		call	sub_40831E
		mov	[ebp+var_24], eax

loc_4035E7:				; CODE XREF: sub_403264+336j
		mov	[esp+0Ch+Filename], 1
		call	sub_40831E
		cmp	eax, [ebp+var_24]
		jnz	short loc_40361C
		mov	[esp+0Ch+Filename], 1
		call	sub_40831E
		mov	[esp+0Ch+Filename], eax
		call	sub_408924
		mov	[esp+0Ch+var_8], 8000h
		mov	[esp+0Ch+Filename], eax
		call	_setmode

loc_40361C:				; CODE XREF: sub_403264+392j
		mov	eax, dword ptr [ebp+var_40]
		mov	eax, [eax]
		mov	[ebp+var_20], eax
		jmp	short loc_403649
; ---------------------------------------------------------------------------

loc_403626:				; CODE XREF: sub_403264+3E9j
		mov	eax, [ebp+var_20]
		mov	[esp+0Ch+var_8], eax
		mov	eax, [ebp+var_24]
		mov	[esp+0Ch+Filename], eax
		call	sub_402F43
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_40365F
		mov	eax, [ebp+var_20]
		mov	eax, [eax]
		mov	[ebp+var_20], eax

loc_403649:				; CODE XREF: sub_403264+3C0j
		cmp	[ebp+var_20], 0
		jnz	short loc_403626
		mov	eax, [ebp+var_24]
		mov	[esp+0Ch+Filename], eax
		call	sub_4031FE
		mov	[ebp+var_1C], eax
		jmp	short loc_403660
; ---------------------------------------------------------------------------

loc_40365F:				; CODE XREF: sub_403264+3DBj
		nop

loc_403660:				; CODE XREF: sub_403264+130j
					; sub_403264+1F0j ...
		cmp	[ebp+var_1C], 0
		jnz	short loc_40369C
		mov	[esp+0Ch+Filename], 1
		call	sub_40831E
		cmp	eax, [ebp+var_24]
		jz	short loc_403687
		mov	eax, [ebp+var_24]
		mov	[esp+0Ch+Filename], eax	; void *
		call	sub_4087A2
		mov	[ebp+var_1C], eax
		jmp	short loc_403695
; ---------------------------------------------------------------------------

loc_403687:				; CODE XREF: sub_403264+411j
		mov	eax, [ebp+var_24]
		mov	[esp+0Ch+Filename], eax
		call	sub_408AC6
		mov	[ebp+var_1C], eax

loc_403695:				; CODE XREF: sub_403264+421j
		mov	[ebp+var_24], 0

loc_40369C:				; CODE XREF: sub_403264+400j
		cmp	[ebp+var_1C], 0
		jz	short loc_403706
		mov	eax, [ebp+var_1C]
		mov	[esp+0Ch+Filename], eax
		call	gpg_strerror
		mov	ebx, eax
		mov	eax, [ebp+var_24]
		mov	[esp+0Ch+Filename], eax
		call	sub_409E27
		mov	[esp+0Ch+var_4], ebx
		mov	[esp+0Ch+var_8], eax ; char
		mov	[esp+0Ch+Filename], offset aCreatingTarbal ; "creating tarball `%s' failed: %s\n"
		call	sub_4119FD
		cmp	[ebp+var_24], 0
		jz	short loc_4036F0
		mov	[esp+0Ch+Filename], 1
		call	sub_40831E
		cmp	eax, [ebp+var_24]
		jz	short loc_4036F0
		mov	eax, [ebp+var_24]
		mov	[esp+0Ch+Filename], eax	; void *
		call	sub_4087A2

loc_4036F0:				; CODE XREF: sub_403264+46Ej
					; sub_403264+47Fj
		mov	eax, ds:Filename
		test	eax, eax
		jz	short loc_403706
		mov	eax, ds:Filename
		mov	[esp+0Ch+Filename], eax	; Filename
		call	remove

loc_403706:				; CODE XREF: sub_403264+43Cj
					; sub_403264+493j
		mov	eax, dword ptr [ebp+var_40]
		mov	dword ptr [eax+4], 0
		jmp	short loc_403727
; ---------------------------------------------------------------------------

loc_403712:				; CODE XREF: sub_403264+4CFj
		mov	eax, [ebp+var_20]
		mov	edx, [eax]
		mov	eax, dword ptr [ebp+var_40]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	[esp+0Ch+Filename], eax	; void *
		call	sub_404E31

loc_403727:				; CODE XREF: sub_403264+4ACj
		mov	eax, dword ptr [ebp+var_40]
		mov	eax, [eax]
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_403712
		add	esp, 105Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_403264	endp ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403740	proc near		; CODE XREF: sub_403767+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_403760
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_403765
; ---------------------------------------------------------------------------

loc_403760:				; CODE XREF: sub_403740+7j
		mov	eax, 0

loc_403765:				; CODE XREF: sub_403740+1Ej
		pop	ebp
		retn
sub_403740	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403767	proc near		; CODE XREF: sub_40378F+Ep
					; sub_403BFB+6Ep ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_403740
		leave
		retn
sub_403767	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403782	proc near		; CODE XREF: sub_403A04+106p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		and	eax, 0FFFFh
		pop	ebp
		retn
sub_403782	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40378F	proc near		; CODE XREF: sub_4037A4+41p
					; sub_4037A4+8Dp ...

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_403767
		leave
		retn
sub_40378F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4037A4	proc near		; CODE XREF: sub_403BFB+16Ap

Filename	= dword	ptr -248h
var_244		= byte ptr -244h
var_240		= dword	ptr -240h
var_23C		= dword	ptr -23Ch
var_230		= byte ptr -230h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 23Ch
		mov	[ebp+var_28], 0
		mov	eax, [ebp+arg_8]
		add	eax, 38h
		mov	[esp+248h+var_23C], 0
		mov	[esp+248h+var_240], eax
		mov	dword ptr [esp+248h+var_244], offset asc_41A8A8	; "/"
		mov	eax, [ebp+arg_4]
		mov	[esp+248h+Filename], eax
		call	sub_415777
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jnz	short loc_40380D
		call	sub_40378F
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+248h+Filename], eax
		call	gpg_strerror
		mov	dword ptr [esp+248h+var_244], eax ; char
		mov	[esp+248h+Filename], offset aErrorCreatingF ; "error creating filename:	%s\n"
		call	sub_4119FD
		jmp	loc_403979
; ---------------------------------------------------------------------------

loc_40380D:				; CODE XREF: sub_4037A4+3Fj
		mov	[ebp+var_1C], 0
		mov	edx, offset aWb_0 ; "wb"
		mov	eax, [ebp+var_2C]
		mov	dword ptr [esp+248h+var_244], edx ; int
		mov	[esp+248h+Filename], eax ; char	*
		call	sub_407B8B
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	short loc_403860
		call	sub_40378F
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+248h+Filename], eax
		call	gpg_strerror
		mov	[esp+248h+var_240], eax
		mov	eax, [ebp+var_2C]
		mov	dword ptr [esp+248h+var_244], eax ; char
		mov	[esp+248h+Filename], offset aErrorCreatingS ; "error creating `%s': %s\n"
		call	sub_4119FD
		jmp	loc_403979
; ---------------------------------------------------------------------------

loc_403860:				; CODE XREF: sub_4037A4+8Bj
		mov	[ebp+var_20], 0
		jmp	loc_403951
; ---------------------------------------------------------------------------

loc_40386C:				; CODE XREF: sub_4037A4+1C0j
					; sub_4037A4+1CCj
		lea	eax, [ebp+var_230]
		mov	dword ptr [esp+248h+var_244], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+248h+Filename], eax
		call	sub_401AD2
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_403978
		add	[ebp+var_20], 1
		mov	ecx, [ebp+var_20]
		mov	ebx, 0
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+34h]
		mov	eax, [eax+30h]
		cmp	ebx, edx
		jb	short loc_4038DC
		cmp	ebx, edx
		ja	short loc_4038AF
		cmp	ecx, eax
		jb	short loc_4038DC

loc_4038AF:				; CODE XREF: sub_4037A4+105j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+1Ch]
		mov	eax, [eax+18h]
		or	eax, edx
		test	eax, eax
		jz	short loc_4038E5
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+1Ch]
		mov	eax, [eax+18h]
		mov	esi, eax
		and	esi, 1FFh
		mov	edi, edx
		and	edi, 0
		mov	eax, edi
		or	eax, esi
		test	eax, eax
		jnz	short loc_4038E5

loc_4038DC:				; CODE XREF: sub_4037A4+101j
					; sub_4037A4+109j
		mov	[ebp+var_24], 200h
		jmp	short loc_4038F6
; ---------------------------------------------------------------------------

loc_4038E5:				; CODE XREF: sub_4037A4+118j
					; sub_4037A4+136j
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+1Ch]
		mov	eax, [eax+18h]
		and	eax, 1FFh
		mov	[ebp+var_24], eax

loc_4038F6:				; CODE XREF: sub_4037A4+13Fj
		lea	eax, [ebp+var_230]
		mov	edx, [ebp+var_28]
		mov	[esp+248h+var_23C], edx
		mov	edx, [ebp+var_24]
		mov	[esp+248h+var_240], edx
		mov	dword ptr [esp+248h+var_244], 1
		mov	[esp+248h+Filename], eax
		call	sub_409050
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		cmp	eax, [ebp+var_24]
		jz	short loc_403951
		call	sub_40378F
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+248h+Filename], eax
		call	gpg_strerror
		mov	[esp+248h+var_240], eax
		mov	eax, [ebp+var_2C]
		mov	dword ptr [esp+248h+var_244], eax ; char
		mov	[esp+248h+Filename], offset aErrorWriting_0 ; "error writing `%s': %s\n"
		call	sub_4119FD
		jmp	short loc_403979
; ---------------------------------------------------------------------------

loc_403951:				; CODE XREF: sub_4037A4+C3j
					; sub_4037A4+17Fj
		mov	ecx, [ebp+var_20]
		mov	ebx, 0
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+34h]
		mov	eax, [eax+30h]
		cmp	ebx, edx
		jb	loc_40386C
		cmp	ebx, edx
		ja	short loc_403979
		cmp	ecx, eax
		jb	loc_40386C
		jmp	short loc_403979
; ---------------------------------------------------------------------------

loc_403978:				; CODE XREF: sub_4037A4+E4j
		nop

loc_403979:				; CODE XREF: sub_4037A4+64j
					; sub_4037A4+B7j ...
		cmp	[ebp+var_1C], 0
		jnz	short loc_40399B
		mov	eax, ds:dword_41D8F0
		test	eax, eax
		jz	short loc_40399B
		mov	eax, [ebp+var_2C]
		mov	dword ptr [esp+248h+var_244], eax ; char
		mov	[esp+248h+Filename], offset aExtractedS	; "extracted `%s'\n"
		call	sub_4119D3

loc_40399B:				; CODE XREF: sub_4037A4+1D9j
					; sub_4037A4+1E2j
		mov	eax, [ebp+var_28]
		mov	[esp+248h+Filename], eax ; void	*
		call	sub_4087A2
		cmp	[ebp+var_1C], 0
		jz	short loc_4039EB
		cmp	[ebp+var_2C], 0
		jz	short loc_4039EB
		cmp	[ebp+var_28], 0
		jz	short loc_4039EB
		mov	eax, [ebp+var_2C]
		mov	[esp+248h+Filename], eax ; Filename
		call	remove
		test	eax, eax
		jz	short loc_4039EB
		call	sub_40378F
		mov	[esp+248h+Filename], eax
		call	gpg_strerror
		mov	[esp+248h+var_240], eax
		mov	eax, [ebp+var_2C]
		mov	dword ptr [esp+248h+var_244], eax ; char
		mov	[esp+248h+Filename], offset aErrorRemovingI ; "error removing incomplete file `%s': %s"...
		call	sub_4119FD

loc_4039EB:				; CODE XREF: sub_4037A4+206j
					; sub_4037A4+20Cj ...
		mov	eax, [ebp+var_2C]
		mov	[esp+248h+Filename], eax ; void	*
		call	sub_404E31
		mov	eax, [ebp+var_1C]
		add	esp, 23Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4037A4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403A04	proc near		; CODE XREF: sub_403BFB+18Fp

Str		= dword	ptr -48h
Val		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_4]
		add	eax, 38h
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], eax
		mov	[esp+48h+Val], offset asc_41A8A8 ; "/"
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Str], eax
		call	sub_415777
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_403A86
		call	sub_40378F
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str], eax
		call	gpg_strerror
		mov	[esp+48h+Val], eax ; char
		mov	[esp+48h+Str], offset aErrorCreatingF ;	"error creating	filename: %s\n"
		call	sub_4119FD
		jmp	loc_403BC5
; ---------------------------------------------------------------------------

loc_403A86:				; CODE XREF: sub_403A04+58j
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_403AE1
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+var_1C]
		mov	byte ptr [eax],	0

loc_403AE1:				; CODE XREF: sub_403A04+B3j
		mov	[esp+48h+Val], offset aRwx ; "-rwx------"
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Str], eax
		call	sub_401C37
		test	eax, eax
		jz	loc_403BC5
		call	sub_40378F
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str], eax
		call	sub_403782
		cmp	eax, 8051h
		jnz	loc_403B9D
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_1C]
		add	eax, edx
		mov	[ebp+var_10], eax
		jmp	short loc_403B5A
; ---------------------------------------------------------------------------

loc_403B2E:				; CODE XREF: sub_403A04+170j
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	[esp+48h+Val], offset aRwx ; "-rwx------"
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Str], eax
		call	sub_401C37
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	2Fh
		cmp	[ebp+var_14], 0
		jnz	short loc_403B78
		add	[ebp+var_10], 1

loc_403B5A:				; CODE XREF: sub_403A04+128j
		mov	[esp+48h+Val], 2Fh ; Val
		mov	eax, [ebp+var_10]
		mov	[esp+48h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_403B2E
		jmp	short loc_403B79
; ---------------------------------------------------------------------------

loc_403B78:				; CODE XREF: sub_403A04+150j
		nop

loc_403B79:				; CODE XREF: sub_403A04+172j
		cmp	[ebp+var_14], 0
		jnz	short loc_403B9D
		mov	[esp+48h+Val], offset aRwx ; "-rwx------"
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Str], eax
		call	sub_401C37
		test	eax, eax
		jnz	short loc_403B9D
		mov	[ebp+var_C], 0

loc_403B9D:				; CODE XREF: sub_403A04+110j
					; sub_403A04+179j ...
		cmp	[ebp+var_C], 0
		jz	short loc_403BC5
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Str], eax
		call	gpg_strerror
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Val], eax ; char
		mov	[esp+48h+Str], offset aErrorCreatingD ;	"error creating	directory `%s': %s\n"
		call	sub_4119FD

loc_403BC5:				; CODE XREF: sub_403A04+7Dj
					; sub_403A04+F2j ...
		cmp	[ebp+var_C], 0
		jnz	short loc_403BE7
		mov	eax, ds:dword_41D8F0
		test	eax, eax
		jz	short loc_403BE7
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Val], eax ; char
		mov	[esp+48h+Str], offset aCreatedS	; "created   `%s/'\n"
		call	sub_4119D3

loc_403BE7:				; CODE XREF: sub_403A04+1C5j
					; sub_403A04+1CEj
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Str], eax ; void *
		call	sub_404E31
		mov	eax, [ebp+var_C]
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_403A04	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_403BFB	proc near		; CODE XREF: sub_404026+1E6p

Str		= dword	ptr -248h
Val		= dword	ptr -244h
var_240		= dword	ptr -240h
var_22C		= dword	ptr -22Ch
var_220		= byte ptr -220h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 23Ch
		mov	eax, [ebp+arg_8]
		add	eax, 38h
		mov	[ebp+var_22C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_22C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_8]
		add	eax, 38h
		mov	[esp+248h+Val],	5Ch ; Val
		mov	[esp+248h+Str],	eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_403C73
		mov	eax, [ebp+arg_8]
		add	eax, 38h
		mov	[esp+248h+Val],	eax ; char
		mov	[esp+248h+Str],	offset aFilenameSConta ; "filename `%s' contains a backslash - ca"...
		call	sub_4119FD
		mov	[esp+248h+Str],	58h
		call	sub_403767
		jmp	loc_403E06
; ---------------------------------------------------------------------------

loc_403C73:				; CODE XREF: sub_403BFB+4Fj
		cmp	[ebp+var_20], 0
		jz	loc_403D15
		mov	eax, [ebp+arg_8]
		add	eax, 38h
		mov	[esp+248h+Val],	offset SubStr ;	"//"
		mov	[esp+248h+Str],	eax ; Str
		call	strstr
		test	eax, eax
		jnz	short loc_403D15
		mov	eax, [ebp+arg_8]
		add	eax, 38h
		mov	[esp+248h+Val],	offset a___0 ; "/../"
		mov	[esp+248h+Str],	eax ; Str
		call	strstr
		test	eax, eax
		jnz	short loc_403D15
		mov	eax, [ebp+arg_8]
		add	eax, 38h
		mov	edx, eax
		mov	eax, offset a___1 ; "../"
		mov	ecx, 3
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jz	short loc_403D15
		cmp	[ebp+var_20], 2
		jbe	short loc_403D3C
		mov	eax, [ebp+arg_8]
		lea	edx, [eax+38h]
		mov	eax, [ebp+var_20]
		sub	eax, 3
		add	eax, edx
		mov	edx, eax
		mov	eax, offset a___2 ; "/.."
		mov	ecx, 4
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_403D3C

loc_403D15:				; CODE XREF: sub_403BFB+7Cj
					; sub_403BFB+9Aj ...
		mov	eax, [ebp+arg_8]
		add	eax, 38h
		mov	[esp+248h+Val],	eax ; char
		mov	[esp+248h+Str],	offset aFilenameSAsSus ; "filename `%s' as suspicious parts - not"...
		call	sub_4119FD
		mov	[esp+248h+Str],	58h
		call	sub_403767
		jmp	loc_403E06
; ---------------------------------------------------------------------------

loc_403D3C:				; CODE XREF: sub_403BFB+E5j
					; sub_403BFB+118j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_403D51
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+28h]
		cmp	eax, 8
		jnz	short loc_403D72

loc_403D51:				; CODE XREF: sub_403BFB+149j
		mov	eax, [ebp+arg_8]
		mov	[esp+248h+var_240], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+248h+Val],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+248h+Str],	eax
		call	sub_4037A4
		mov	[ebp+var_1C], eax
		jmp	loc_403E03
; ---------------------------------------------------------------------------

loc_403D72:				; CODE XREF: sub_403BFB+154j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+28h]
		cmp	eax, 5
		jnz	short loc_403D94
		mov	eax, [ebp+arg_8]
		mov	[esp+248h+Val],	eax
		mov	eax, [ebp+arg_4]
		mov	[esp+248h+Str],	eax
		call	sub_403A04
		mov	[ebp+var_1C], eax
		jmp	short loc_403E03
; ---------------------------------------------------------------------------

loc_403D94:				; CODE XREF: sub_403BFB+180j
		mov	eax, [ebp+arg_8]
		lea	edx, [eax+38h]
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+28h]
		mov	[esp+248h+var_240], edx
		mov	[esp+248h+Val],	eax ; char
		mov	[esp+248h+Str],	offset aUnsupportedFil ; "unsupported file type	%d for `%s' - ski"...
		call	sub_4119D3
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 0
		jmp	short loc_403DE0
; ---------------------------------------------------------------------------

loc_403DC4:				; CODE XREF: sub_403BFB+1FEj
					; sub_403BFB+206j
		lea	eax, [ebp+var_220]
		mov	[esp+248h+Val],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+248h+Str],	eax
		call	sub_401AD2
		mov	[ebp+var_1C], eax
		add	[ebp+var_20], 1

loc_403DE0:				; CODE XREF: sub_403BFB+1C7j
		cmp	[ebp+var_1C], 0
		jnz	short loc_403E03
		mov	ecx, [ebp+var_20]
		mov	ebx, 0
		mov	eax, [ebp+arg_8]
		mov	edx, [eax+34h]
		mov	eax, [eax+30h]
		cmp	ebx, edx
		jb	short loc_403DC4
		cmp	ebx, edx
		ja	short loc_403E03
		cmp	ecx, eax
		jb	short loc_403DC4

loc_403E03:				; CODE XREF: sub_403BFB+172j
					; sub_403BFB+197j ...
		mov	eax, [ebp+var_1C]

loc_403E06:				; CODE XREF: sub_403BFB+73j
					; sub_403BFB+13Cj
		add	esp, 23Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_403BFB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_403E11(char *)
sub_403E11	proc near		; CODE XREF: sub_404026+183p

var_48		= dword	ptr -48h
var_44		= byte ptr -44h
var_40		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 44h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 4
		jbe	loc_403F3E
		mov	eax, [ebp+var_1C]
		sub	eax, 4
		add	eax, [ebp+arg_0]
		mov	dword ptr [esp+48h+var_44], offset a_gpg ; ".gpg"
		mov	[esp+48h+var_48], eax
		call	sub_41474F
		test	eax, eax
		jz	loc_403F0B
		mov	eax, [ebp+var_1C]
		sub	eax, 4
		add	eax, [ebp+arg_0]
		mov	dword ptr [esp+48h+var_44], offset a_pgp ; ".pgp"
		mov	[esp+48h+var_48], eax
		call	sub_41474F
		test	eax, eax
		jz	short loc_403F0B
		mov	eax, [ebp+var_1C]
		sub	eax, 4
		add	eax, [ebp+arg_0]
		mov	dword ptr [esp+48h+var_44], offset a_asc ; ".asc"
		mov	[esp+48h+var_48], eax
		call	sub_41474F
		test	eax, eax
		jz	short loc_403F0B
		mov	eax, [ebp+var_1C]
		sub	eax, 4
		add	eax, [ebp+arg_0]
		mov	dword ptr [esp+48h+var_44], offset a_pem ; ".pem"
		mov	[esp+48h+var_48], eax
		call	sub_41474F
		test	eax, eax
		jz	short loc_403F0B
		mov	eax, [ebp+var_1C]
		sub	eax, 4
		add	eax, [ebp+arg_0]
		mov	dword ptr [esp+48h+var_44], offset a_p7m ; ".p7m"
		mov	[esp+48h+var_48], eax
		call	sub_41474F
		test	eax, eax
		jz	short loc_403F0B
		mov	eax, [ebp+var_1C]
		sub	eax, 4
		add	eax, [ebp+arg_0]
		mov	dword ptr [esp+48h+var_44], offset a_p7e ; ".p7e"
		mov	[esp+48h+var_48], eax
		call	sub_41474F
		test	eax, eax
		jnz	short loc_403F3E

loc_403F0B:				; CODE XREF: sub_403E11+63j
					; sub_403E11+84j ...
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+var_48], eax ;	char *
		call	sub_404CF8
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_403F2C
		call	sub_40378F
		mov	[ebp+var_C], eax
		jmp	loc_403FDF
; ---------------------------------------------------------------------------

loc_403F2C:				; CODE XREF: sub_403E11+10Cj
		mov	eax, [ebp+var_1C]
		sub	eax, 4
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_0], eax

loc_403F3E:				; CODE XREF: sub_403E11+42j
					; sub_403E11+F8j
		mov	[ebp+var_18], 1
		jmp	short loc_403FC0
; ---------------------------------------------------------------------------

loc_403F47:				; CODE XREF: sub_403E11+1B6j
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax ;	void *
		call	sub_404E31
		mov	eax, [ebp+var_18]
		mov	[esp+48h+var_40], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+48h+var_44], eax
		mov	[esp+48h+var_48], offset aS_D_ ; "%s_%d_"
		call	sub_40A5B1
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_403F7F
		call	sub_40378F
		mov	[ebp+var_C], eax
		jmp	short loc_403FDF
; ---------------------------------------------------------------------------

loc_403F7F:				; CODE XREF: sub_403E11+162j
		mov	dword ptr [esp+48h+var_44], offset aRwx	; "-rwx------"
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	sub_401C37
		test	eax, eax
		jz	short loc_403FDE
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 11h
		jz	short loc_403FBC
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 14h
		jz	short loc_403FBC
		call	sub_40378F
		mov	[ebp+var_C], eax
		jmp	short loc_403FDF
; ---------------------------------------------------------------------------

loc_403FBC:				; CODE XREF: sub_403E11+191j
					; sub_403E11+19Fj
		add	[ebp+var_18], 1

loc_403FC0:				; CODE XREF: sub_403E11+134j
		cmp	[ebp+var_18], 1387h
		jle	loc_403F47
		mov	[esp+48h+var_48], 0B7h
		call	sub_403767
		mov	[ebp+var_C], eax
		jmp	short loc_403FDF
; ---------------------------------------------------------------------------

loc_403FDE:				; CODE XREF: sub_403E11+183j
		nop

loc_403FDF:				; CODE XREF: sub_403E11+116j
					; sub_403E11+16Cj ...
		cmp	[ebp+var_C], 0
		jz	short loc_404012
		mov	eax, [ebp+var_C]
		mov	[esp+48h+var_48], eax
		call	gpg_strerror
		mov	dword ptr [esp+48h+var_44], eax	; char
		mov	[esp+48h+var_48], offset aErrorCreatingA ; "error creating an extract directory: %s"...
		call	sub_4119FD
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax ;	void *
		call	sub_404E31
		mov	[ebp+var_14], 0

loc_404012:				; CODE XREF: sub_403E11+1D2j
		mov	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax ;	void *
		call	sub_404E31
		mov	eax, [ebp+var_14]
		add	esp, 44h
		pop	edi
		pop	ebp
		retn
sub_403E11	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404026(char *)
sub_404026	proc near		; CODE XREF: sub_401695+3F8p

Str		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 30h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		cmp	[ebp+arg_0], 0
		jz	loc_4040D2
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset asc_41AA79 ; "-"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_404086
		mov	[esp+38h+Str], 0
		call	sub_40831E
		mov	[ebp+var_C], eax
		jmp	short loc_40409D
; ---------------------------------------------------------------------------

loc_404086:				; CODE XREF: sub_404026+4Dj
		mov	eax, offset aRb_0 ; "rb"
		mov	dword ptr [esp+38h+var_34], eax	; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; char *
		call	sub_407B8B
		mov	[ebp+var_C], eax

loc_40409D:				; CODE XREF: sub_404026+5Ej
		cmp	[ebp+var_C], 0
		jnz	short loc_4040E1
		call	sub_40378F
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Str], eax
		call	gpg_strerror
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+Str], offset aErrorOpeningSS ;	"error opening `%s': %s\n"
		call	sub_4119FD
		jmp	loc_404260
; ---------------------------------------------------------------------------

loc_4040D2:				; CODE XREF: sub_404026+21j
		mov	[esp+38h+Str], 0
		call	sub_40831E
		mov	[ebp+var_C], eax

loc_4040E1:				; CODE XREF: sub_404026+7Bj
		mov	[esp+38h+Str], 0
		call	sub_40831E
		cmp	eax, [ebp+var_C]
		jnz	short loc_404116
		mov	[esp+38h+Str], 0
		call	sub_40831E
		mov	[esp+38h+Str], eax
		call	sub_408924
		mov	dword ptr [esp+38h+var_34], 8000h
		mov	[esp+38h+Str], eax
		call	_setmode

loc_404116:				; CODE XREF: sub_404026+CAj
		cmp	[ebp+arg_0], 0
		jz	short loc_404157
		mov	[esp+38h+Str], 0
		call	sub_40831E
		cmp	eax, [ebp+var_C]
		jz	short loc_404157
		mov	dword ptr [esp+38h+var_34], 2Fh	; Ch
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; Str
		call	strrchr
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_40414F
		add	[ebp+var_14], 1
		jmp	short loc_40418C
; ---------------------------------------------------------------------------

loc_40414F:				; CODE XREF: sub_404026+121j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		jmp	short loc_40418C
; ---------------------------------------------------------------------------

loc_404157:				; CODE XREF: sub_404026+F4j
					; sub_404026+105j
		mov	eax, ds:Str
		test	eax, eax
		jz	short loc_40418C
		mov	eax, ds:Str
		mov	dword ptr [esp+38h+var_34], 2Fh	; Ch
		mov	[esp+38h+Str], eax ; Str
		call	strrchr
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_404184
		add	[ebp+var_14], 1
		jmp	short loc_40418C
; ---------------------------------------------------------------------------

loc_404184:				; CODE XREF: sub_404026+156j
		mov	eax, ds:Str
		mov	[ebp+var_14], eax

loc_40418C:				; CODE XREF: sub_404026+127j
					; sub_404026+12Fj ...
		cmp	[ebp+var_14], 0
		jz	short loc_40419C
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4041A3

loc_40419C:				; CODE XREF: sub_404026+16Aj
		mov	[ebp+var_14], offset aGpgarch ;	"GPGARCH"

loc_4041A3:				; CODE XREF: sub_404026+174j
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax ; char *
		call	sub_403E11
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_4041C8
		mov	[esp+38h+Str], 1
		call	sub_403767
		mov	[ebp+var_1C], eax
		jmp	short loc_40422D
; ---------------------------------------------------------------------------

loc_4041C8:				; CODE XREF: sub_404026+18Fj
		mov	eax, ds:dword_41D8F0
		test	eax, eax
		jz	short loc_4041E4
		mov	eax, [ebp+var_18]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+Str], offset aExtractingToS ; "extracting to `%s/'\n"
		call	sub_4119D3

loc_4041E4:				; CODE XREF: sub_404026+1A9j
					; sub_404026+201j
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax
		call	sub_404C40
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_404229
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+var_18]
		mov	dword ptr [esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax
		call	sub_403BFB
		test	eax, eax
		jnz	short loc_40422C
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax ; void *
		call	sub_404E31
		mov	[ebp+var_10], 0
		jmp	short loc_4041E4
; ---------------------------------------------------------------------------

loc_404229:				; CODE XREF: sub_404026+1D0j
		nop
		jmp	short loc_40422D
; ---------------------------------------------------------------------------

loc_40422C:				; CODE XREF: sub_404026+1EDj
		nop

loc_40422D:				; CODE XREF: sub_404026+1A0j
					; sub_404026+204j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax ; void *
		call	sub_404E31
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Str], eax ; void *
		call	sub_404E31
		mov	[esp+38h+Str], 0
		call	sub_40831E
		cmp	eax, [ebp+var_C]
		jz	short loc_40425F
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; void *
		call	sub_4087A2

loc_40425F:				; CODE XREF: sub_404026+22Cj
		nop

loc_404260:				; CODE XREF: sub_404026+A7j
		add	esp, 30h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_404026	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404268	proc near		; CODE XREF: sub_40428F+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_404288
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_40428D
; ---------------------------------------------------------------------------

loc_404288:				; CODE XREF: sub_404268+7j
		mov	eax, 0

loc_40428D:				; CODE XREF: sub_404268+1Ej
		pop	ebp
		retn
sub_404268	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40428F	proc near		; CODE XREF: sub_4042AA+Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_404268
		leave
		retn
sub_40428F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4042AA	proc near		; CODE XREF: sub_404407+19Cp
					; sub_404AD9+68p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	gpg_err_code_from_syserror
		mov	[esp+18h+var_18], eax
		call	sub_40428F
		leave
		retn
sub_4042AA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4042BF	proc near		; CODE XREF: sub_404407+271p
					; sub_404407+296p ...

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_4], 0
		jnz	short loc_4042E4
		mov	[ebp+var_18], 0
		mov	[ebp+var_14], 0
		jmp	loc_4043FF
; ---------------------------------------------------------------------------

loc_4042E4:				; CODE XREF: sub_4042BF+10j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_40434C
		mov	eax, [ebp+var_C]
		movzx	ecx, byte ptr [eax]
		movzx	eax, cl
		mov	edx, 0
		mov	ecx, eax
		and	ecx, 7Fh
		mov	[ebp+var_18], ecx
		mov	eax, edx
		and	eax, 0
		mov	[ebp+var_14], eax
		add	[ebp+var_C], 1
		jmp	short loc_40433D
; ---------------------------------------------------------------------------

loc_404312:				; CODE XREF: sub_4042BF+86j
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		shld	edx, eax, 8
		shl	eax, 8
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_C]
		movzx	ecx, byte ptr [eax]
		movzx	eax, cl
		mov	edx, 0
		or	[ebp+var_18], eax
		or	[ebp+var_14], edx
		add	[ebp+var_C], 1

loc_40433D:				; CODE XREF: sub_4042BF+51j
		sub	[ebp+arg_4], 1
		cmp	[ebp+arg_4], 0
		jnz	short loc_404312
		jmp	loc_4043FF
; ---------------------------------------------------------------------------

loc_40434C:				; CODE XREF: sub_4042BF+2Dj
		mov	[ebp+var_18], 0
		mov	[ebp+var_14], 0
		jmp	short loc_404364
; ---------------------------------------------------------------------------

loc_40435C:				; CODE XREF: sub_4042BF+B7j
					; sub_4042BF+C1j
		sub	[ebp+arg_4], 1
		add	[ebp+var_C], 1

loc_404364:				; CODE XREF: sub_4042BF+9Bj
		cmp	[ebp+arg_4], 0
		jz	loc_4043EF
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 20h
		jz	short loc_40435C
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	short loc_40435C
		jmp	short loc_4043EF
; ---------------------------------------------------------------------------

loc_404384:				; CODE XREF: sub_4042BF+13Ej
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jbe	short loc_4043CC
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 37h
		ja	short loc_4043CC
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		shld	edx, eax, 3
		shl	eax, 3
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		sub	eax, 30h
		mov	edx, eax
		sar	edx, 1Fh
		add	[ebp+var_18], eax
		adc	[ebp+var_14], edx
		sub	[ebp+arg_4], 1
		add	[ebp+var_C], 1
		jmp	short loc_4043EF
; ---------------------------------------------------------------------------

loc_4043CC:				; CODE XREF: sub_4042BF+CDj
					; sub_4042BF+D7j
		mov	eax, dword ptr [ebp+arg_8]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aSInvalidOctalN ; "%s:	invalid	octal number encountered - "...
		call	sub_4119FD
		mov	[ebp+var_18], 0
		mov	[ebp+var_14], 0
		jmp	short loc_4043FF
; ---------------------------------------------------------------------------

loc_4043EF:				; CODE XREF: sub_4042BF+A9j
					; sub_4042BF+C3j ...
		cmp	[ebp+arg_4], 0
		jz	short loc_4043FF
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_404384

loc_4043FF:				; CODE XREF: sub_4042BF+20j
					; sub_4042BF+88j ...
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		leave
		retn
sub_4042BF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404407	proc near		; CODE XREF: sub_4047F5+F0p

Buf1		= dword	ptr -38h
Buf2		= dword	ptr -34h
Size		= dword	ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
Src		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_0]
		mov	[ebp+Src], eax
		mov	eax, [ebp+Src]
		add	eax, 101h
		mov	[esp+38h+Size],	5 ; Size
		mov	[esp+38h+Buf2],	offset aUstar_0	; "ustar"
		mov	[esp+38h+Buf1],	eax ; Buf1
		call	memcmp
		test	eax, eax
		jnz	short loc_40445A
		mov	eax, [ebp+Src]
		movzx	eax, byte ptr [eax+106h]
		cmp	al, 20h
		jz	short loc_404453
		mov	eax, [ebp+Src]
		movzx	eax, byte ptr [eax+106h]
		test	al, al
		jnz	short loc_40445A

loc_404453:				; CODE XREF: sub_404407+3Cj
		mov	eax, 1
		jmp	short loc_40445F
; ---------------------------------------------------------------------------

loc_40445A:				; CODE XREF: sub_404407+2Ej
					; sub_404407+4Aj
		mov	eax, 0

loc_40445F:				; CODE XREF: sub_404407+51j
		mov	[ebp+var_1C], eax
		mov	[ebp+var_10], 0
		jmp	short loc_40446F
; ---------------------------------------------------------------------------

loc_40446B:				; CODE XREF: sub_404407+7Bj
		add	[ebp+var_10], 1

loc_40446F:				; CODE XREF: sub_404407+62j
		cmp	[ebp+var_10], 63h
		ja	short loc_404484
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_10]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40446B

loc_404484:				; CODE XREF: sub_404407+6Cj
		cmp	[ebp+var_10], 64h
		jnz	short loc_40449D
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+38h+Buf2],	eax ; char
		mov	[esp+38h+Buf1],	offset aSWarningNameNo ; "%s: warning: name not	terminated by a	n"...
		call	sub_4119D3

loc_40449D:				; CODE XREF: sub_404407+81j
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[ebp+var_C], eax
		jmp	short loc_4044D0
; ---------------------------------------------------------------------------

loc_4044A8:				; CODE XREF: sub_404407+CDj
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_C]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4044CC
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+38h+Buf2],	eax ; char
		mov	[esp+38h+Buf1],	offset aSWarningGarbag ; "%s: warning: garbage after name\n"
		call	sub_4119D3
		jmp	short loc_4044D6
; ---------------------------------------------------------------------------

loc_4044CC:				; CODE XREF: sub_404407+AEj
		add	[ebp+var_C], 1

loc_4044D0:				; CODE XREF: sub_404407+9Fj
		cmp	[ebp+var_C], 63h
		jbe	short loc_4044A8

loc_4044D6:				; CODE XREF: sub_404407+C3j
		cmp	[ebp+var_1C], 0
		jz	loc_404578
		mov	eax, [ebp+Src]
		movzx	eax, byte ptr [eax+159h]
		test	al, al
		jz	loc_404578
		mov	[ebp+var_14], 0
		jmp	short loc_4044FF
; ---------------------------------------------------------------------------

loc_4044FB:				; CODE XREF: sub_404407+111j
		add	[ebp+var_14], 1

loc_4044FF:				; CODE XREF: sub_404407+F2j
		cmp	[ebp+var_14], 9Ah
		ja	short loc_40451A
		mov	eax, [ebp+Src]
		add	eax, [ebp+var_14]
		add	eax, 159h
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4044FB

loc_40451A:				; CODE XREF: sub_404407+FFj
		cmp	[ebp+var_14], 9Bh
		jnz	short loc_404536
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+38h+Buf2],	eax ; char
		mov	[esp+38h+Buf1],	offset aSWarningPrefix ; "%s: warning: prefix not terminated by	a"...
		call	sub_4119D3

loc_404536:				; CODE XREF: sub_404407+11Aj
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[ebp+var_C], eax
		jmp	short loc_40456D
; ---------------------------------------------------------------------------

loc_404541:				; CODE XREF: sub_404407+16Dj
		mov	eax, [ebp+Src]
		add	eax, [ebp+var_C]
		add	eax, 159h
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404569
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+38h+Buf2],	eax ; char
		mov	[esp+38h+Buf1],	offset aSWarningGarb_0 ; "%s: warning: garbage after prefix\n"
		call	sub_4119D3
		nop
		jmp	short loc_40457F
; ---------------------------------------------------------------------------

loc_404569:				; CODE XREF: sub_404407+14Aj
		add	[ebp+var_C], 1

loc_40456D:				; CODE XREF: sub_404407+138j
		cmp	[ebp+var_C], 9Ah
		jbe	short loc_404541
		jmp	short loc_40457F
; ---------------------------------------------------------------------------

loc_404578:				; CODE XREF: sub_404407+D3j
					; sub_404407+E5j
		mov	[ebp+var_14], 0

loc_40457F:				; CODE XREF: sub_404407+160j
					; sub_404407+16Fj
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		add	eax, edx
		add	eax, 41h
		mov	[esp+38h+Buf2],	eax ; size_t
		mov	[esp+38h+Buf1],	1 ; size_t
		call	sub_404D92
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_4045D1
		call	sub_4042AA
		mov	[esp+38h+Buf1],	eax
		call	gpg_strerror
		mov	[esp+38h+Size],	eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+38h+Buf2],	eax ; char
		mov	[esp+38h+Buf1],	offset aSErrorAllocati ; "%s: error allocating header: %s\n"
		call	sub_4119FD
		mov	eax, 0
		jmp	locret_4047F3
; ---------------------------------------------------------------------------

loc_4045D1:				; CODE XREF: sub_404407+19Aj
		cmp	[ebp+var_14], 0
		jz	short loc_404628
		mov	eax, [ebp+var_14]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+Src]
		add	eax, 159h
		mov	edx, eax
		mov	eax, [ebp+var_20]
		add	eax, 38h
		mov	ecx, [ebp+var_C]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Buf2],	edx ; Src
		mov	[esp+38h+Buf1],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		lea	edx, [eax-1]
		mov	eax, [ebp+Src]
		movzx	eax, byte ptr [eax+edx+159h]
		cmp	al, 2Fh
		jz	short loc_40462F
		mov	eax, [ebp+var_20]
		add	eax, [ebp+var_C]
		add	eax, 30h
		mov	byte ptr [eax+8], 2Fh
		add	[ebp+var_C], 1
		jmp	short loc_40462F
; ---------------------------------------------------------------------------

loc_404628:				; CODE XREF: sub_404407+1CEj
		mov	[ebp+var_C], 0

loc_40462F:				; CODE XREF: sub_404407+20Cj
					; sub_404407+21Fj
		mov	eax, [ebp+Src]
		mov	edx, eax
		mov	eax, [ebp+var_20]
		add	eax, 38h
		add	eax, [ebp+var_C]
		mov	ecx, [ebp+var_10]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Buf2],	edx ; Src
		mov	[esp+38h+Buf1],	eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		add	edx, eax
		mov	eax, [ebp+var_20]
		mov	byte ptr [eax+edx+38h],	0
		mov	eax, [ebp+Src]
		lea	edx, [eax+64h]
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+38h+Size],	eax
		mov	[esp+38h+Buf2],	8
		mov	[esp+38h+Buf1],	edx
		call	sub_4042BF
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[eax+4], edx
		mov	eax, [ebp+Src]
		lea	edx, [eax+6Ch]
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+38h+Size],	eax
		mov	[esp+38h+Buf2],	8
		mov	[esp+38h+Buf1],	edx
		call	sub_4042BF
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+Src]
		lea	edx, [eax+74h]
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+38h+Size],	eax
		mov	[esp+38h+Buf2],	8
		mov	[esp+38h+Buf1],	edx
		call	sub_4042BF
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[eax+10h], edx
		mov	eax, [ebp+Src]
		lea	edx, [eax+7Ch]
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+38h+Size],	eax
		mov	[esp+38h+Buf2],	0Ch
		mov	[esp+38h+Buf1],	edx
		call	sub_4042BF
		mov	ecx, [ebp+var_20]
		mov	[ecx+18h], eax
		mov	[ecx+1Ch], edx
		mov	eax, [ebp+Src]
		lea	edx, [eax+88h]
		mov	eax, dword ptr [ebp+arg_4]
		mov	[esp+38h+Size],	eax
		mov	[esp+38h+Buf2],	0Ch
		mov	[esp+38h+Buf1],	edx
		call	sub_4042BF
		mov	ecx, [ebp+var_20]
		mov	[ecx+20h], eax
		mov	[ecx+24h], edx
		mov	eax, [ebp+Src]
		movzx	eax, byte ptr [eax+9Ch]
		movsx	eax, al
		sub	eax, 30h	; switch 8 cases
		cmp	eax, 7
		ja	short loc_40479C ; jumptable 0040473A default case
		mov	eax, ds:off_41ABC0[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40473C:				; CODE XREF: sub_404407+333j
					; DATA XREF: .rdata:off_41ABC0o
		mov	eax, [ebp+var_20] ; jumptable 0040473A case 48
		mov	dword ptr [eax+28h], 0
		jmp	short loc_4047A7
; ---------------------------------------------------------------------------

loc_404748:				; CODE XREF: sub_404407+333j
					; DATA XREF: .rdata:off_41ABC0o
		mov	eax, [ebp+var_20] ; jumptable 0040473A case 49
		mov	dword ptr [eax+28h], 1
		jmp	short loc_4047A7
; ---------------------------------------------------------------------------

loc_404754:				; CODE XREF: sub_404407+333j
					; DATA XREF: .rdata:off_41ABC0o
		mov	eax, [ebp+var_20] ; jumptable 0040473A case 50
		mov	dword ptr [eax+28h], 2
		jmp	short loc_4047A7
; ---------------------------------------------------------------------------

loc_404760:				; CODE XREF: sub_404407+333j
					; DATA XREF: .rdata:off_41ABC0o
		mov	eax, [ebp+var_20] ; jumptable 0040473A case 51
		mov	dword ptr [eax+28h], 3
		jmp	short loc_4047A7
; ---------------------------------------------------------------------------

loc_40476C:				; CODE XREF: sub_404407+333j
					; DATA XREF: .rdata:off_41ABC0o
		mov	eax, [ebp+var_20] ; jumptable 0040473A case 52
		mov	dword ptr [eax+28h], 4
		jmp	short loc_4047A7
; ---------------------------------------------------------------------------

loc_404778:				; CODE XREF: sub_404407+333j
					; DATA XREF: .rdata:off_41ABC0o
		mov	eax, [ebp+var_20] ; jumptable 0040473A case 53
		mov	dword ptr [eax+28h], 5
		jmp	short loc_4047A7
; ---------------------------------------------------------------------------

loc_404784:				; CODE XREF: sub_404407+333j
					; DATA XREF: .rdata:off_41ABC0o
		mov	eax, [ebp+var_20] ; jumptable 0040473A case 54
		mov	dword ptr [eax+28h], 6
		jmp	short loc_4047A7
; ---------------------------------------------------------------------------

loc_404790:				; CODE XREF: sub_404407+333j
					; DATA XREF: .rdata:off_41ABC0o
		mov	eax, [ebp+var_20] ; jumptable 0040473A case 55
		mov	dword ptr [eax+28h], 7
		jmp	short loc_4047A7
; ---------------------------------------------------------------------------

loc_40479C:				; CODE XREF: sub_404407+32Aj
		mov	eax, [ebp+var_20] ; jumptable 0040473A default case
		mov	dword ptr [eax+28h], 8
		nop

loc_4047A7:				; CODE XREF: sub_404407+33Fj
					; sub_404407+34Bj ...
		mov	eax, [ebp+var_20]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_4047BC
		mov	eax, [ebp+var_20]
		mov	eax, [eax+28h]
		cmp	eax, 8
		jnz	short loc_4047DF

loc_4047BC:				; CODE XREF: sub_404407+3A8j
		mov	eax, [ebp+var_20]
		mov	edx, [eax+1Ch]
		mov	eax, [eax+18h]
		add	eax, 1FFh
		adc	edx, 0
		shrd	eax, edx, 9
		shr	edx, 9
		mov	ecx, [ebp+var_20]
		mov	[ecx+30h], eax
		mov	[ecx+34h], edx
		jmp	short loc_4047F0
; ---------------------------------------------------------------------------

loc_4047DF:				; CODE XREF: sub_404407+3B3j
		mov	eax, [ebp+var_20]
		mov	dword ptr [eax+30h], 0
		mov	dword ptr [eax+34h], 0

loc_4047F0:				; CODE XREF: sub_404407+3D6j
		mov	eax, [ebp+var_20]

locret_4047F3:				; CODE XREF: sub_404407+1C5j
		leave
		retn
sub_404407	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4047F5	proc near		; CODE XREF: sub_404AD9+E1p
					; sub_404C40+Cp

var_228		= dword	ptr -228h
var_224		= byte ptr -224h
var_210		= byte ptr -210h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 228h
		lea	eax, [ebp+var_210]
		mov	dword ptr [esp+228h+var_224], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+228h+var_228], eax
		call	sub_401AD2
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_404826
		mov	eax, 0
		jmp	locret_4048EA
; ---------------------------------------------------------------------------

loc_404826:				; CODE XREF: sub_4047F5+25j
		mov	[ebp+var_C], 0
		jmp	short loc_404833
; ---------------------------------------------------------------------------

loc_40482F:				; CODE XREF: sub_4047F5+55j
		add	[ebp+var_C], 1

loc_404833:				; CODE XREF: sub_4047F5+38j
		cmp	[ebp+var_C], 1FFh
		jg	short loc_40484C
		lea	eax, [ebp+var_210]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40482F

loc_40484C:				; CODE XREF: sub_4047F5+45j
		cmp	[ebp+var_C], 200h
		jnz	short loc_4048CD
		lea	eax, [ebp+var_210]
		mov	dword ptr [esp+228h+var_224], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+228h+var_228], eax
		call	sub_401AD2
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40487A
		mov	eax, 0
		jmp	short locret_4048EA
; ---------------------------------------------------------------------------

loc_40487A:				; CODE XREF: sub_4047F5+7Cj
		mov	[ebp+var_C], 0
		jmp	short loc_404887
; ---------------------------------------------------------------------------

loc_404883:				; CODE XREF: sub_4047F5+A9j
		add	[ebp+var_C], 1

loc_404887:				; CODE XREF: sub_4047F5+8Cj
		cmp	[ebp+var_C], 1FFh
		jg	short loc_4048A0
		lea	eax, [ebp+var_210]
		add	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_404883

loc_4048A0:				; CODE XREF: sub_4047F5+99j
		cmp	[ebp+var_C], 200h
		jz	short loc_4048C6
		mov	eax, [ebp+arg_0]
		mov	[esp+228h+var_228], eax
		call	sub_409E27
		mov	dword ptr [esp+228h+var_224], eax ; char
		mov	[esp+228h+var_228], offset aSWarningSkippi ; "%s: warning: skipping empty header\n"
		call	sub_4119D3
		jmp	short loc_4048CD
; ---------------------------------------------------------------------------

loc_4048C6:				; CODE XREF: sub_4047F5+B2j
		mov	eax, 0
		jmp	short locret_4048EA
; ---------------------------------------------------------------------------

loc_4048CD:				; CODE XREF: sub_4047F5+5Ej
					; sub_4047F5+CFj
		mov	eax, [ebp+arg_0]
		mov	[esp+228h+var_228], eax
		call	sub_409E27
		mov	dword ptr [esp+228h+var_224], eax
		lea	eax, [ebp+var_210]
		mov	[esp+228h+var_228], eax
		call	sub_404407

locret_4048EA:				; CODE XREF: sub_4047F5+2Cj
					; sub_4047F5+83j ...
		leave
		retn
sub_4047F5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4048EC	proc near		; CODE XREF: sub_404AD9+117p

var_228		= dword	ptr -228h
var_224		= dword	ptr -224h
var_210		= byte ptr -210h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 228h
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		jmp	short loc_40492D
; ---------------------------------------------------------------------------

loc_404905:				; CODE XREF: sub_4048EC+4Dj
					; sub_4048EC+57j
		lea	eax, [ebp+var_210]
		mov	[esp+228h+var_224], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+228h+var_228], eax
		call	sub_401AD2
		test	eax, eax
		jz	short loc_404925
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40494A
; ---------------------------------------------------------------------------

loc_404925:				; CODE XREF: sub_4048EC+30j
		add	[ebp+var_10], 1
		adc	[ebp+var_C], 0

loc_40492D:				; CODE XREF: sub_4048EC+17j
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+34h]
		mov	eax, [eax+30h]
		cmp	edx, [ebp+var_C]
		ja	short loc_404905
		cmp	edx, [ebp+var_C]
		jb	short loc_404945
		cmp	eax, [ebp+var_10]
		ja	short loc_404905

loc_404945:				; CODE XREF: sub_4048EC+52j
		mov	eax, 0

locret_40494A:				; CODE XREF: sub_4048EC+37j
		leave
		retn
sub_4048EC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40494C	proc near		; CODE XREF: sub_404AD9+105p
					; sub_404C53+1Fp

var_78		= dword	ptr -78h
var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_2B		= byte ptr -2Bh
var_28		= byte ptr -28h
var_25		= byte ptr -25h
var_22		= byte ptr -22h
var_21		= byte ptr -21h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	[ebp+var_2B], 3Fh
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		cmp	eax, 9		; switch 10 cases
		ja	short loc_40499E ; jumptable 0040496B default case
		mov	eax, ds:off_41AC2C[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40496D:				; CODE XREF: sub_40494C+1Fj
					; DATA XREF: .rdata:off_41AC2Co
		mov	[ebp+var_2B], 2Dh ; jumptable 0040496B case 0
		jmp	short loc_40499E ; jumptable 0040496B default case
; ---------------------------------------------------------------------------

loc_404973:				; CODE XREF: sub_40494C+1Fj
					; DATA XREF: .rdata:off_41AC2Co
		mov	[ebp+var_2B], 68h ; jumptable 0040496B case 1
		jmp	short loc_40499E ; jumptable 0040496B default case
; ---------------------------------------------------------------------------

loc_404979:				; CODE XREF: sub_40494C+1Fj
					; DATA XREF: .rdata:off_41AC2Co
		mov	[ebp+var_2B], 6Ch ; jumptable 0040496B case 2
		jmp	short loc_40499E ; jumptable 0040496B default case
; ---------------------------------------------------------------------------

loc_40497F:				; CODE XREF: sub_40494C+1Fj
					; DATA XREF: .rdata:off_41AC2Co
		mov	[ebp+var_2B], 63h ; jumptable 0040496B case 3
		jmp	short loc_40499E ; jumptable 0040496B default case
; ---------------------------------------------------------------------------

loc_404985:				; CODE XREF: sub_40494C+1Fj
					; DATA XREF: .rdata:off_41AC2Co
		mov	[ebp+var_2B], 62h ; jumptable 0040496B case 4
		jmp	short loc_40499E ; jumptable 0040496B default case
; ---------------------------------------------------------------------------

loc_40498B:				; CODE XREF: sub_40494C+1Fj
					; DATA XREF: .rdata:off_41AC2Co
		mov	[ebp+var_2B], 64h ; jumptable 0040496B case 5
		jmp	short loc_40499E ; jumptable 0040496B default case
; ---------------------------------------------------------------------------

loc_404991:				; CODE XREF: sub_40494C+1Fj
					; DATA XREF: .rdata:off_41AC2Co
		mov	[ebp+var_2B], 66h ; jumptable 0040496B case 6
		jmp	short loc_40499E ; jumptable 0040496B default case
; ---------------------------------------------------------------------------

loc_404997:				; CODE XREF: sub_40494C+1Fj
					; DATA XREF: .rdata:off_41AC2Co
		mov	[ebp+var_2B], 3Dh ; jumptable 0040496B case 7
		jmp	short loc_40499E ; jumptable 0040496B default case
; ---------------------------------------------------------------------------

loc_40499D:				; CODE XREF: sub_40494C+1Fj
					; DATA XREF: .rdata:off_41AC2Co
		nop			; jumptable 0040496B cases 8,9

loc_40499E:				; CODE XREF: sub_40494C+16j
					; sub_40494C+25j ...
		mov	[ebp+var_1C], 100h ; jumptable 0040496B	default	case
		mov	[ebp+var_20], 0
		jmp	short loc_4049DE
; ---------------------------------------------------------------------------

loc_4049AE:				; CODE XREF: sub_40494C+96j
		mov	eax, [ebp+var_20]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		and	eax, [ebp+var_1C]
		test	eax, eax
		jz	short loc_4049CE
		mov	eax, [ebp+var_20]
		add	eax, offset aRwxrwxrwx ; "rwxrwxrwx"
		movzx	eax, byte ptr [eax]
		jmp	short loc_4049D3
; ---------------------------------------------------------------------------

loc_4049CE:				; CODE XREF: sub_40494C+73j
		mov	eax, 2Dh

loc_4049D3:				; CODE XREF: sub_40494C+80j
		mov	[ebp+edx+var_2B], al
		add	[ebp+var_20], 1
		shr	[ebp+var_1C], 1

loc_4049DE:				; CODE XREF: sub_40494C+60j
		cmp	[ebp+var_20], 8
		jle	short loc_4049AE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		and	eax, 800h
		test	eax, eax
		jz	short loc_404A0A
		movzx	eax, [ebp+var_28]
		cmp	al, 78h
		jnz	short loc_404A02
		mov	eax, 73h
		jmp	short loc_404A07
; ---------------------------------------------------------------------------

loc_404A02:				; CODE XREF: sub_40494C+ADj
		mov	eax, 53h

loc_404A07:				; CODE XREF: sub_40494C+B4j
		mov	[ebp+var_28], al

loc_404A0A:				; CODE XREF: sub_40494C+A5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		and	eax, 400h
		test	eax, eax
		jz	short loc_404A30
		movzx	eax, [ebp+var_25]
		cmp	al, 78h
		jnz	short loc_404A28
		mov	eax, 73h
		jmp	short loc_404A2D
; ---------------------------------------------------------------------------

loc_404A28:				; CODE XREF: sub_40494C+D3j
		mov	eax, 53h

loc_404A2D:				; CODE XREF: sub_40494C+DAj
		mov	[ebp+var_25], al

loc_404A30:				; CODE XREF: sub_40494C+CBj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		and	eax, 200h
		test	eax, eax
		jz	short loc_404A56
		movzx	eax, [ebp+var_22]
		cmp	al, 78h
		jnz	short loc_404A4E
		mov	eax, 74h
		jmp	short loc_404A53
; ---------------------------------------------------------------------------

loc_404A4E:				; CODE XREF: sub_40494C+F9j
		mov	eax, 54h

loc_404A53:				; CODE XREF: sub_40494C+100j
		mov	[ebp+var_22], al

loc_404A56:				; CODE XREF: sub_40494C+F1j
		mov	[ebp+var_21], 0
		mov	eax, [ebp+arg_0]
		lea	esi, [eax+38h]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+24h]
		mov	eax, [eax+20h]
		mov	[esp+78h+var_78], eax
		call	sub_40AEEF
		mov	edi, eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	ecx, [eax+1Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_40], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	ebx, offset aSLuLuLu12lluSS ; "%s %lu %lu/%lu %12llu %s	%s\n"
		mov	[esp+78h+var_54], esi
		mov	[esp+78h+var_58], edi
		mov	[esp+78h+var_60], edx
		mov	[esp+78h+var_5C], ecx
		mov	edx, [ebp+var_3C]
		mov	[esp+78h+var_64], edx
		mov	edx, [ebp+var_40]
		mov	[esp+78h+var_68], edx
		mov	[esp+78h+var_6C], eax
		lea	eax, [ebp+var_2B]
		mov	[esp+78h+var_70], eax
		mov	[esp+78h+var_74], ebx
		mov	eax, [ebp+arg_4]
		mov	[esp+78h+var_78], eax
		call	sub_409758
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40494C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404AD9(char *)
sub_404AD9	proc near		; CODE XREF: sub_401695+2FCp

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		cmp	[ebp+arg_0], 0
		jz	loc_404B70
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset byte_41AC54
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_404B24
		mov	[esp+28h+var_28], 0
		call	sub_40831E
		mov	[ebp+var_C], eax
		jmp	short loc_404B3B
; ---------------------------------------------------------------------------

loc_404B24:				; CODE XREF: sub_404AD9+38j
		mov	eax, offset word_41AC56
		mov	dword ptr [esp+28h+var_24], eax	; int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	char *
		call	sub_407B8B
		mov	[ebp+var_C], eax

loc_404B3B:				; CODE XREF: sub_404AD9+49j
		cmp	[ebp+var_C], 0
		jnz	short loc_404B7F
		call	sub_4042AA
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	gpg_strerror
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aErrorOpening_0 ; "error opening `%s': %s\n"
		call	sub_4119FD
		jmp	loc_404C39
; ---------------------------------------------------------------------------

loc_404B70:				; CODE XREF: sub_404AD9+Cj
		mov	[esp+28h+var_28], 0
		call	sub_40831E
		mov	[ebp+var_C], eax

loc_404B7F:				; CODE XREF: sub_404AD9+66j
		mov	[esp+28h+var_28], 0
		call	sub_40831E
		cmp	eax, [ebp+var_C]
		jnz	short loc_404BB4
		mov	[esp+28h+var_28], 0
		call	sub_40831E
		mov	[esp+28h+var_28], eax
		call	sub_408924
		mov	dword ptr [esp+28h+var_24], 8000h
		mov	[esp+28h+var_28], eax
		call	_setmode

loc_404BB4:				; CODE XREF: sub_404AD9+B5j
					; sub_404AD9+132j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_4047F5
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_404C0D
		mov	[esp+28h+var_28], 1
		call	sub_40831E
		mov	dword ptr [esp+28h+var_24], eax
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	sub_40494C
		mov	eax, [ebp+var_14]
		mov	dword ptr [esp+28h+var_24], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_4048EC
		test	eax, eax
		jnz	short loc_404C10
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_404E31
		mov	[ebp+var_14], 0
		jmp	short loc_404BB4
; ---------------------------------------------------------------------------

loc_404C0D:				; CODE XREF: sub_404AD9+EDj
		nop
		jmp	short loc_404C11
; ---------------------------------------------------------------------------

loc_404C10:				; CODE XREF: sub_404AD9+11Ej
		nop

loc_404C11:				; CODE XREF: sub_404AD9+135j
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_404E31
		mov	[esp+28h+var_28], 0
		call	sub_40831E
		cmp	eax, [ebp+var_C]
		jz	short loc_404C38
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_4087A2

loc_404C38:				; CODE XREF: sub_404AD9+152j
		nop

loc_404C39:				; CODE XREF: sub_404AD9+92j
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_404AD9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404C40	proc near		; CODE XREF: sub_404026+1C4p

var_18		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_4047F5
		leave
		retn
sub_404C40	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404C53	proc near		; CODE XREF: sub_402192+14Cp

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_404C77
		cmp	[ebp+arg_4], 0
		jz	short locret_404C77
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_40494C

locret_404C77:				; CODE XREF: sub_404C53+Aj
					; sub_404C53+10j
		leave
		retn
sub_404C53	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_404C7C	proc near		; CODE XREF: sub_404CD4+1Ap
					; .text:00404D88p ...

var_18		= dword	ptr -18h
var_14		= byte ptr -14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+18h+var_18], eax ;	int
		call	strerror
		mov	ebx, eax
		mov	[esp+18h+var_18], offset aErrorAllocatin ; "error allocating enough memory: %s\n"
		call	sub_411114
		mov	dword ptr [esp+18h+var_14], ebx	; char
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_411A40
sub_404C7C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404CAE(size_t)
sub_404CAE	proc near		; CODE XREF: sub_401C4A+77p
					; sub_401D49+94p ...

Size		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Size],	eax ; Size
		call	malloc
		leave
		retn
sub_404CAE	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	malloc
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404CD4(size_t)
sub_404CD4	proc near		; CODE XREF: sub_40BC73+B2p
					; sub_40C06D+91p ...

Size		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Size],	eax ; Size
		call	malloc
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_404CF3
		call	sub_404C7C
; ---------------------------------------------------------------------------

loc_404CF3:				; CODE XREF: sub_404CD4+18j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_404CD4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404CF8(char *)
sub_404CF8	proc near		; CODE XREF: sub_403264+B3p
					; sub_403264+1BFp ...

Size		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
Dest		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jz	short loc_404D44
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Source], eax ;	Source
		mov	eax, [ebp+Dest]
		mov	[esp+38h+Size],	eax ; Dest
		call	strcpy

loc_404D44:				; CODE XREF: sub_404CF8+38j
		mov	eax, [ebp+Dest]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_404CF8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404D4D(void *, size_t)
sub_404D4D	proc near		; CODE XREF: sub_41212A+76Fp

Memory		= dword	ptr -18h
NewSize		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+NewSize], eax ; NewSize
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	realloc
		leave
		retn
sub_404D4D	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	realloc
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_404D8D
		call	sub_404C7C
; ---------------------------------------------------------------------------

loc_404D8D:				; CODE XREF: .text:00404D86j
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404D92(size_t, size_t)
sub_404D92	proc near		; CODE XREF: sub_402192+88p
					; sub_404407+18Ep ...

NumOfElements	= dword	ptr -18h
SizeOfElements	= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+SizeOfElements], eax ;	SizeOfElements
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+NumOfElements], eax ; NumOfElements
		call	calloc
		leave
		retn
sub_404D92	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	calloc
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_404DD2
		call	sub_404C7C
; ---------------------------------------------------------------------------

loc_404DD2:				; CODE XREF: .text:00404DCBj
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404DD7(char *)
sub_404DD7	proc near		; CODE XREF: sub_40C06D+CEp
					; .text:004142B2p ...

Size		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
Dest		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+38h+Size],	eax ; Size
		call	malloc
		mov	[ebp+Dest], eax
		cmp	[ebp+Dest], 0
		jnz	short loc_404E16
		call	sub_404C7C
; ---------------------------------------------------------------------------

loc_404E16:				; CODE XREF: sub_404DD7+38j
		mov	eax, [ebp+Dest]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Size],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+Dest]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_404DD7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_404E31(void *)
sub_404E31	proc near		; CODE XREF: sub_401C4A+E1p
					; sub_401EBC+F1p ...

Memory		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_404E48
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

locret_404E48:				; CODE XREF: sub_404E31+Aj
		leave
		retn
sub_404E31	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_41D0A0
		test	eax, eax
		jnz	short loc_404ED1
		mov	ds:dword_41D0A0, 1
		call	_getpid
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		xor	eax, edx
		mov	[ebp-14h], eax
		mov	dword ptr [esp], 0
		call	sub_418670
		mov	edx, eax
		mov	eax, [ebp-10h]
		xor	eax, edx
		mov	[ebp-18h], eax
		lea	eax, [ebp-14h]
		mov	eax, [eax]
		mov	ds:dword_41D0A4, eax
		mov	eax, offset dword_41D0A8
		lea	edx, [ebp-18h]
		mov	edx, [edx]
		mov	[eax], edx

loc_404ED1:				; CODE XREF: .text:00404E8Aj
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 8
		mov	eax, offset dword_41D0A4
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		imul	eax, 3E8h
		mov	[esp], eax
		mov	eax, ds:Sleep
		call	eax ; Sleep
		sub	esp, 4
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_404EFF	proc near		; CODE XREF: .text:00404F6Cp

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+arg_0], 0FFFFFFFFh
		jnz	short loc_404F12
		mov	eax, 0FFFFFFFFh
		jmp	short locret_404F4C
; ---------------------------------------------------------------------------

loc_404F12:				; CODE XREF: sub_404EFF+Aj
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	edx, al
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_404F49
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+var_28], offset aFailedToTransl ; "failed to translate	osfhandle %p\n"
		call	sub_4119FD

loc_404F49:				; CODE XREF: sub_404EFF+35j
		mov	eax, [ebp+var_C]

locret_404F4C:				; CODE XREF: sub_404EFF+11j
		leave
		retn
sub_404EFF	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+8], 2
		jg	short loc_404F5F
		mov	eax, [ebp+8]
		jmp	short locret_404F71
; ---------------------------------------------------------------------------

loc_404F5F:				; CODE XREF: .text:00404F58j
		mov	eax, [ebp+8]
		mov	edx, [ebp+0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_404EFF

locret_404F71:				; CODE XREF: .text:00404F5Dj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 184h
		mov	eax, ds:GetCurrentProcessId
		call	eax ; GetCurrentProcessId
		mov	[ebp-1Ch], eax
		lea	eax, [ebp-158h]
		mov	dword ptr [eax], 0
		mov	dword ptr [eax+4], 0
		mov	dword ptr [eax+8], 0
		mov	dword ptr [ebp-158h], 0Ch
		mov	dword ptr [ebp-150h], 1
		lea	eax, [ebp-14Ch]
		mov	[esp+4], eax
		mov	dword ptr [esp], 105h
		mov	eax, ds:GetTempPathA
		call	eax ; GetTempPathA
		sub	esp, 8
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-20h], 0
		jz	short loc_405011
		cmp	dword ptr [ebp-20h], 104h
		jg	short loc_405011
		lea	eax, [ebp-14Ch]
		mov	dword ptr [ebp-15Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-15Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 104h
		jbe	short loc_405028

loc_405011:				; CODE XREF: .text:00404FD7j
					; .text:00404FE0j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 2
		mov	eax, 0
		jmp	loc_405216
; ---------------------------------------------------------------------------

loc_405028:				; CODE XREF: .text:0040500Fj
		lea	eax, [ebp-14Ch]
		mov	dword ptr [ebp-15Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-15Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp-14Ch]
		add	eax, edx
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		mov	dword ptr [eax], 756E675Fh
		mov	word ptr [eax+4], 6770h
		mov	byte ptr [eax+6], 0
		add	dword ptr [ebp-10h], 6
		mov	dword ptr [esp+4], 0
		lea	eax, [ebp-14Ch]
		mov	[esp], eax
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	5Ch
		add	dword ptr [ebp-10h], 1
		mov	eax, [ebp-10h]
		mov	[ebp-24h], eax
		mov	dword ptr [ebp-0Ch], 0
		jmp	loc_4051FA
; ---------------------------------------------------------------------------

loc_4050A9:				; CODE XREF: .text:004051FEj
		mov	eax, [ebp-24h]
		mov	[ebp-10h], eax
		mov	eax, ds:GetTickCount
		call	eax ; GetTickCount
		mov	edx, [ebp-1Ch]
		shl	edx, 10h
		xor	eax, edx
		mov	[ebp-14h], eax
		mov	dword ptr [ebp-18h], 0
		jmp	short loc_4050FA
; ---------------------------------------------------------------------------

loc_4050CA:				; CODE XREF: .text:004050FEj
		mov	eax, [ebp-14h]
		shr	eax, 1Ch
		cmp	eax, 9
		ja	short loc_4050E0
		mov	eax, [ebp-14h]
		shr	eax, 1Ch
		add	eax, 30h
		jmp	short loc_4050E9
; ---------------------------------------------------------------------------

loc_4050E0:				; CODE XREF: .text:004050D3j
		mov	eax, [ebp-14h]
		shr	eax, 1Ch
		add	eax, 37h

loc_4050E9:				; CODE XREF: .text:004050DEj
		mov	edx, [ebp-10h]
		mov	[edx], al
		add	dword ptr [ebp-10h], 1
		shl	dword ptr [ebp-14h], 4
		add	dword ptr [ebp-18h], 1

loc_4050FA:				; CODE XREF: .text:004050C8j
		cmp	dword ptr [ebp-18h], 7
		jle	short loc_4050CA
		mov	edx, offset a_tmp ; ".tmp"
		mov	eax, [ebp-10h]
		mov	ecx, [edx]
		mov	[eax], ecx
		movzx	edx, byte ptr [edx+4]
		mov	[eax+4], dl
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 4000100h
		mov	dword ptr [esp+10h], 1
		lea	eax, [ebp-158h]
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0C0000000h
		lea	eax, [ebp-14Ch]
		mov	[esp], eax
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp-28h], eax
		cmp	dword ptr [ebp-28h], 0FFFFFFFFh
		jz	loc_4051E5
		mov	eax, [ebp-28h]
		mov	dword ptr [esp+4], 0
		mov	[esp], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebp-2Ch], eax
		cmp	dword ptr [ebp-2Ch], 0FFFFFFFFh
		jnz	short loc_40519A
		mov	eax, [ebp-28h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		jmp	short loc_405216
; ---------------------------------------------------------------------------

loc_40519A:				; CODE XREF: .text:00405181j
		mov	dword ptr [esp+4], offset aWB ;	"w+b"
		mov	eax, [ebp-2Ch]
		mov	[esp], eax
		call	_fdopen
		mov	[ebp-30h], eax
		cmp	dword ptr [ebp-30h], 0
		jnz	short loc_4051E0
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[ebp-34h], eax
		mov	eax, [ebp-2Ch]
		mov	[esp], eax
		call	_close
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	edx, [ebp-34h]
		mov	[eax], edx
		mov	eax, 0
		jmp	short loc_405216
; ---------------------------------------------------------------------------

loc_4051E0:				; CODE XREF: .text:004051B4j
		mov	eax, [ebp-30h]
		jmp	short loc_405216
; ---------------------------------------------------------------------------

loc_4051E5:				; CODE XREF: .text:0040515Fj
		mov	dword ptr [esp], 1
		mov	eax, ds:Sleep
		call	eax ; Sleep
		sub	esp, 4
		add	dword ptr [ebp-0Ch], 1

loc_4051FA:				; CODE XREF: .text:004050A4j
		cmp	dword ptr [ebp-0Ch], 9
		jle	loc_4050A9
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 2
		mov	eax, 0

loc_405216:				; CODE XREF: .text:00405023j
					; .text:00405198j ...
		mov	edi, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40521B	proc near		; CODE XREF: sub_401695+3Fp
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_40521B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+8], 0
		jnz	short loc_405249
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], offset aGnupg_allow_se ; "gnupg_allow_set_foregound_window"
		mov	dword ptr [esp], offset	aSCalledWithInv	; "%s called with invalid pid %lu\n"
		call	sub_4119D3
		jmp	short locret_40528D
; ---------------------------------------------------------------------------

loc_405249:				; CODE XREF: .text:0040522Aj
		cmp	dword ptr [ebp+8], 0FFFFFFFFh
		jz	short loc_405254
		mov	eax, [ebp+8]
		jmp	short loc_405259
; ---------------------------------------------------------------------------

loc_405254:				; CODE XREF: .text:0040524Dj
		mov	eax, 0FFFFFFFFh

loc_405259:				; CODE XREF: .text:00405252j
		mov	[esp], eax
		mov	eax, ds:AllowSetForegroundWindow
		call	eax ; AllowSetForegroundWindow
		sub	esp, 4
		test	eax, eax
		jnz	short locret_40528D
		mov	dword ptr [esp], 0FFFFFFFFh
		call	sub_414F2A
		mov	edx, [ebp+8]
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	dword ptr [esp], offset	aAllowsetforegr	; "AllowSetForegroundWindow(%lu) failed: %"...
		call	sub_4119D3

locret_40528D:				; CODE XREF: .text:00405247j
					; .text:00405268j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-20h], 0
		mov	dword ptr [ebp-10h], 0
		mov	dword ptr [ebp-14h], 0
		mov	eax, ds:GetCurrentProcessId
		call	eax ; GetCurrentProcessId
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp], 400h
		mov	eax, ds:OpenProcess
		call	eax ; OpenProcess
		sub	esp, 0Ch
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0
		jz	loc_405408
		lea	eax, [ebp-20h]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 8
		mov	eax, [ebp-18h]
		mov	[esp], eax
		mov	eax, ds:OpenProcessToken
		call	eax ; OpenProcessToken
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_40540B
		mov	eax, [ebp-20h]
		lea	edx, [ebp-24h]
		mov	[esp+10h], edx
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		mov	eax, ds:GetTokenInformation
		call	eax ; GetTokenInformation
		sub	esp, 14h
		test	eax, eax
		jnz	short loc_405353
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		cmp	eax, 7Ah
		jnz	loc_40540E

loc_405353:				; CODE XREF: .text:00405341j
		mov	eax, [ebp-24h]
		mov	[esp], eax
		call	sub_404CAE
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	loc_405411
		mov	edx, [ebp-24h]
		mov	eax, [ebp-20h]
		lea	ecx, [ebp-24h]
		mov	[esp+10h], ecx
		mov	[esp+0Ch], edx
		mov	edx, [ebp-10h]
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		mov	eax, ds:GetTokenInformation
		call	eax ; GetTokenInformation
		sub	esp, 14h
		test	eax, eax
		jz	short loc_405414
		mov	eax, [ebp-10h]
		mov	eax, [eax]
		mov	[esp], eax
		mov	eax, ds:IsValidSid
		call	eax ; IsValidSid
		sub	esp, 4
		test	eax, eax
		jz	short loc_405417
		mov	eax, [ebp-10h]
		mov	eax, [eax]
		mov	[esp], eax
		mov	eax, ds:GetLengthSid
		call	eax ; GetLengthSid
		sub	esp, 4
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_404CAE
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_40541A
		mov	eax, [ebp-10h]
		mov	eax, [eax]
		mov	[esp+8], eax
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		mov	eax, ds:CopySid
		call	eax ; CopySid
		sub	esp, 0Ch
		test	eax, eax
		jz	short loc_40541D
		mov	dword ptr [ebp-0Ch], 1
		jmp	short loc_40541E
; ---------------------------------------------------------------------------

loc_405408:				; CODE XREF: .text:004052E3j
		nop
		jmp	short loc_40541E
; ---------------------------------------------------------------------------

loc_40540B:				; CODE XREF: .text:0040530Aj
		nop
		jmp	short loc_40541E
; ---------------------------------------------------------------------------

loc_40540E:				; CODE XREF: .text:0040534Dj
		nop
		jmp	short loc_40541E
; ---------------------------------------------------------------------------

loc_405411:				; CODE XREF: .text:00405365j
		nop
		jmp	short loc_40541E
; ---------------------------------------------------------------------------

loc_405414:				; CODE XREF: .text:0040539Aj
		nop
		jmp	short loc_40541E
; ---------------------------------------------------------------------------

loc_405417:				; CODE XREF: .text:004053B0j
		nop
		jmp	short loc_40541E
; ---------------------------------------------------------------------------

loc_40541A:				; CODE XREF: .text:004053D9j
		nop
		jmp	short loc_40541E
; ---------------------------------------------------------------------------

loc_40541D:				; CODE XREF: .text:004053FDj
		nop

loc_40541E:				; CODE XREF: .text:00405406j
					; .text:00405409j ...
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_404E31
		mov	eax, [ebp-20h]
		test	eax, eax
		jz	short loc_405440
		mov	eax, [ebp-20h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_405440:				; CODE XREF: .text:0040542Ej
		cmp	dword ptr [ebp-18h], 0
		jz	short loc_405456
		mov	eax, [ebp-18h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_405456:				; CODE XREF: .text:00405444j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40546E
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_404E31
		mov	dword ptr [ebp-14h], 0

loc_40546E:				; CODE XREF: .text:0040545Aj
		mov	eax, [ebp-14h]
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405474	proc near		; CODE XREF: sub_401695+64p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_40C396
		mov	[esp+18h+var_14], eax ;	char *
		mov	[esp+18h+var_18], offset aGnupg2 ; "gnupg2"
		call	sub_41082E
		leave
		retn
sub_405474	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405491	proc near		; CODE XREF: .text:004054C4p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 1
		call	sub_4111A2
		mov	eax, 0
		leave
		retn
sub_405491	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4054AA	proc near		; CODE XREF: .text:004054E0p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 0
		call	sub_4111A2
		leave
		retn
sub_4054AA	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_405491
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_411114
		mov	[ebp-10h], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_4054AA
		mov	eax, [ebp-10h]
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4054EC	proc near		; CODE XREF: sub_401695+69p

wVersionRequested= word	ptr -1A8h
lpWSAData	= dword	ptr -1A4h
WSAData		= WSAData ptr -198h

		push	ebp
		mov	ebp, esp
		sub	esp, 1A8h
		mov	dword ptr [esp+1A8h+wVersionRequested],	0
		call	sub_41596B
		lea	eax, [ebp+WSAData]
		mov	[esp+1A8h+lpWSAData], eax ; lpWSAData
		mov	dword ptr [esp+1A8h+wVersionRequested],	202h ; wVersionRequested
		mov	eax, ds:WSAStartup
		call	eax ; WSAStartup
		sub	esp, 8
		call	sub_407B78
		leave
		retn
sub_4054EC	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405524	proc near		; CODE XREF: sub_405596+32p
					; sub_405596+82p ...
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_405524	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405529	proc near		; CODE XREF: .text:00408901p
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn
sub_405529	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405533(size_t)
sub_405533	proc near		; CODE XREF: sub_405550+12p
					; sub_405596+Dp ...

Size		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_405543
		add	[ebp+arg_0], 1

loc_405543:				; CODE XREF: sub_405533+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Size],	eax ; Size
		call	malloc
		leave
		retn
sub_405533	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405550(void *, size_t)
sub_405550	proc near		; CODE XREF: .text:00409353p
					; .text:0040957Fp
					; DATA XREF: ...

Memory		= dword	ptr -18h
NewSize		= dword	ptr -14h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jnz	short loc_405569
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+Memory], eax ;	size_t
		call	sub_405533
		jmp	short locret_40557B
; ---------------------------------------------------------------------------

loc_405569:				; CODE XREF: sub_405550+Aj
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+NewSize], eax ; NewSize
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	realloc

locret_40557B:				; CODE XREF: sub_405550+17j
		leave
		retn
sub_405550	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40557D(void *)
sub_40557D	proc near		; CODE XREF: sub_405629+5Ap
					; sub_405DC0+29p ...

Memory		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short locret_405594
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Memory], eax ;	Memory
		call	free

locret_405594:				; CODE XREF: sub_40557D+Aj
		leave
		retn
sub_40557D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405596	proc near		; CODE XREF: sub_406974+E7p

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 0Ch ;	size_t
		call	sub_405533
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4055BA
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_405624
; ---------------------------------------------------------------------------

loc_4055BA:				; CODE XREF: sub_405596+19j
		cmp	[ebp+arg_4], 0
		jnz	short loc_4055CD
		mov	eax, ds:dword_41D0B0
		mov	[esp+28h+var_28], eax
		call	sub_405524

loc_4055CD:				; CODE XREF: sub_405596+28j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_0]
		mov	[eax], edx
		mov	edx, ds:dword_41D0AC
		mov	eax, [ebp+var_10]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+8], offset dword_41D0AC
		mov	eax, ds:dword_41D0AC
		test	eax, eax
		jz	short loc_405602
		mov	eax, ds:dword_41D0AC
		mov	edx, [ebp+var_10]
		add	edx, 4
		mov	[eax+8], edx

loc_405602:				; CODE XREF: sub_405596+5Cj
		mov	eax, [ebp+var_10]
		mov	ds:dword_41D0AC, eax
		cmp	[ebp+arg_4], 0
		jnz	short loc_40561D
		mov	eax, ds:dword_41D0B0
		mov	[esp+28h+var_28], eax
		call	sub_405524

loc_40561D:				; CODE XREF: sub_405596+78j
		mov	[ebp+var_C], 0

loc_405624:				; CODE XREF: sub_405596+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_405596	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405629	proc near		; CODE XREF: sub_406A9B+20p

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 0
		jnz	short loc_405642
		mov	eax, ds:dword_41D0B0
		mov	[esp+28h+var_28], eax
		call	sub_405524

loc_405642:				; CODE XREF: sub_405629+Aj
		mov	eax, ds:dword_41D0AC
		mov	[ebp+var_C], eax
		jmp	short loc_405693
; ---------------------------------------------------------------------------

loc_40564C:				; CODE XREF: sub_405629+6Ej
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	eax, [ebp+arg_0]
		jnz	short loc_40568A
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_C]
		mov	edx, [edx+4]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_40567D
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		mov	edx, [edx+8]
		mov	[eax+8], edx

loc_40567D:				; CODE XREF: sub_405629+43j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40557D
		jmp	short loc_405699
; ---------------------------------------------------------------------------

loc_40568A:				; CODE XREF: sub_405629+2Bj
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[ebp+var_C], eax

loc_405693:				; CODE XREF: sub_405629+21j
		cmp	[ebp+var_C], 0
		jnz	short loc_40564C

loc_405699:				; CODE XREF: sub_405629+5Fj
		cmp	[ebp+arg_4], 0
		jnz	short locret_4056AC
		mov	eax, ds:dword_41D0B0
		mov	[esp+28h+var_28], eax
		call	sub_405524

locret_4056AC:				; CODE XREF: sub_405629+74j
		leave
		retn
sub_405629	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4056AE	proc near		; CODE XREF: sub_408AC6+4Bp

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, ds:dword_41D0B0
		mov	[esp+28h+var_28], eax
		call	sub_405524
		mov	eax, ds:dword_41D0AC
		mov	[ebp+var_C], eax
		jmp	short loc_4056EB
; ---------------------------------------------------------------------------

loc_4056D2:				; CODE XREF: sub_4056AE+41j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+arg_0]
		call	eax
		or	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[ebp+var_C], eax

loc_4056EB:				; CODE XREF: sub_4056AE+22j
		cmp	[ebp+var_C], 0
		jnz	short loc_4056D2
		mov	eax, ds:dword_41D0B0
		mov	[esp+28h+var_28], eax
		call	sub_405524
		mov	eax, [ebp+var_10]
		leave
		retn
sub_4056AE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405703()
sub_405703	proc near		; DATA XREF: sub_405721+19o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_18], 0
		call	sub_408AC6
		leave
		retn
sub_405703	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, 0
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405721	proc near		; CODE XREF: sub_407B78+6p

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_41D0C4
		test	eax, eax
		jnz	short loc_405746
		mov	ds:dword_41D0C4, 1
		mov	[esp+18h+var_18], offset sub_405703 ; _onexit_t
		call	sub_4170D0

loc_405746:				; CODE XREF: sub_405721+Dj
		mov	eax, 0
		leave
		retn
sub_405721	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40574D	proc near		; CODE XREF: sub_4074CE+69p
					; .text:00407D22p ...

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_4], 0
		jnz	short loc_40577C
		cmp	[ebp+arg_8], 0
		jnz	short loc_405765
		cmp	[ebp+arg_C], 0
		jz	short loc_40577C

loc_405765:				; CODE XREF: sub_40574D+10j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_405835
; ---------------------------------------------------------------------------

loc_40577C:				; CODE XREF: sub_40574D+Aj
					; sub_40574D+16j
		mov	[esp+28h+var_28], 28h ;	size_t
		call	sub_405533
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40579D
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_405832
; ---------------------------------------------------------------------------

loc_40579D:				; CODE XREF: sub_40574D+42j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_20]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	[eax+8], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_24]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_10]
		mov	[eax+18h], edx
		cmp	[ebp+arg_14], 0
		setnz	dl
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		and	ecx, 1
		movzx	edx, byte ptr [eax+1Ch]
		and	edx, 0FFFFFFFEh
		or	edx, ecx
		mov	[eax+1Ch], dl
		cmp	[ebp+arg_18], 0
		jz	short loc_405802
		mov	eax, [ebp+arg_18]
		jmp	short loc_405807
; ---------------------------------------------------------------------------

loc_405802:				; CODE XREF: sub_40574D+AEj
		mov	eax, offset sub_405550

loc_405807:				; CODE XREF: sub_40574D+B3j
		mov	edx, [ebp+var_10]
		mov	[edx+20h], eax
		cmp	[ebp+arg_1C], 0
		jz	short loc_405818
		mov	eax, [ebp+arg_1C]
		jmp	short loc_40581D
; ---------------------------------------------------------------------------

loc_405818:				; CODE XREF: sub_40574D+C4j
		mov	eax, offset sub_40557D

loc_40581D:				; CODE XREF: sub_40574D+C9j
		mov	edx, [ebp+var_10]
		mov	[edx+24h], eax
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_405832:				; CODE XREF: sub_40574D+4Bj
		mov	eax, [ebp+var_C]

locret_405835:				; CODE XREF: sub_40574D+2Aj
		leave
		retn
sub_40574D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405837(int, void *, size_t)
sub_405837	proc near		; DATA XREF: .data:off_419140o

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, [ebp+arg_8]
		jnb	short loc_40586F
		mov	eax, [ebp+var_C]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+arg_8], eax

loc_40586F:				; CODE XREF: sub_405837+21j
		cmp	[ebp+arg_8], 0
		jz	short loc_4058AC
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		add	edx, eax
		mov	eax, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+10h], edx

loc_4058AC:				; CODE XREF: sub_405837+3Cj
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		leave
		retn
sub_405837	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4058B7(int, void *, size_t)
sub_4058B7	proc near		; DATA XREF: .data:off_419144o

Dst		= dword	ptr -48h
Src		= dword	ptr -44h
Size		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 44h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+arg_8], 0
		jnz	short loc_4058D4
		mov	eax, 0
		jmp	loc_405B35
; ---------------------------------------------------------------------------

loc_4058D4:				; CODE XREF: sub_4058B7+11j
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		and	eax, 8
		test	eax, eax
		jz	short loc_4058EC
		mov	eax, [ebp+var_10]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_10]
		mov	[eax+10h], edx

loc_4058EC:				; CODE XREF: sub_4058B7+27j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	edx, eax
		jnb	short loc_405918
		mov	[esp+48h+Size],	283h ; int
		mov	[esp+48h+Src], offset a____Gnupg22__0 ;	"../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+48h+Dst], offset aMem_cookieMemo ;	"mem_cookie->memory_size >= mem_cookie->"...
		call	sub_4185A0

loc_405918:				; CODE XREF: sub_4058B7+43j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 1
		test	al, al
		jnz	short loc_405949
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_14]
		jbe	short loc_405949
		mov	eax, [ebp+var_14]
		mov	[ebp+arg_8], eax

loc_405949:				; CODE XREF: sub_4058B7+82j
					; sub_4058B7+8Aj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_14]
		jbe	loc_405ACF
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		test	eax, eax
		jnz	short loc_405967
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		jmp	short loc_40597E
; ---------------------------------------------------------------------------

loc_405967:				; CODE XREF: sub_4058B7+A6j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_14]
		mov	ecx, [ebp+arg_8]
		mov	ebx, ecx
		sub	ebx, edx
		mov	edx, ebx
		add	eax, edx
		mov	[ebp+var_C], eax

loc_40597E:				; CODE XREF: sub_4058B7+AEj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	eax, [ebp+var_C]
		jbe	short loc_4059A0
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	loc_405B35
; ---------------------------------------------------------------------------

loc_4059A0:				; CODE XREF: sub_4058B7+D0j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		test	eax, eax
		jz	short loc_405A01
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		add	eax, [ebp+var_C]
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	eax, [ebp+var_C]
		jbe	short loc_4059DB
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	loc_405B35
; ---------------------------------------------------------------------------

loc_4059DB:				; CODE XREF: sub_4058B7+10Bj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_C]
		mov	edx, 0
		div	[ebp+var_2C]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_C]
		imul	eax, edx
		mov	[ebp+var_C], eax

loc_405A01:				; CODE XREF: sub_4058B7+F1j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_405A2D
		mov	eax, [ebp+var_10]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_C]
		jnb	short loc_405A2D
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 1Ch
		mov	eax, 0FFFFFFFFh
		jmp	loc_405B35
; ---------------------------------------------------------------------------

loc_405A2D:				; CODE XREF: sub_4058B7+152j
					; sub_4058B7+15Dj
		mov	eax, [ebp+var_10]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_C]
		mov	[esp+48h+Src], edx
		mov	[esp+48h+Dst], eax
		call	ecx
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_405A58
		mov	eax, 0FFFFFFFFh
		jmp	loc_405B35
; ---------------------------------------------------------------------------

loc_405A58:				; CODE XREF: sub_4058B7+195j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		cmp	edx, eax
		jnb	short loc_405A96
		mov	[esp+48h+Size],	2B6h ; int
		mov	[esp+48h+Src], offset a____Gnupg22__0 ;	"../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+48h+Dst], offset aMem_cookieMemo ;	"mem_cookie->memory_size >= mem_cookie->"...
		call	sub_4185A0

loc_405A96:				; CODE XREF: sub_4058B7+1C1j
		mov	eax, [ebp+var_10]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_14]
		jbe	short loc_405ACF
		mov	[esp+48h+Size],	2B9h ; int
		mov	[esp+48h+Src], offset a____Gnupg22__0 ;	"../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+48h+Dst], offset aSizeNleft ; "size <= nleft"
		call	sub_4185A0

loc_405ACF:				; CODE XREF: sub_4058B7+98j
					; sub_4058B7+1FAj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		add	eax, edx
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+48h+Size],	ecx ; Size
		mov	[esp+48h+Src], edx ; Src
		mov	[esp+48h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_10]
		mov	eax, [eax+14h]
		cmp	edx, eax
		jbe	short loc_405B1B
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_10]
		mov	[eax+14h], edx

loc_405B1B:				; CODE XREF: sub_4058B7+251j
		mov	eax, [ebp+var_10]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_10]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]

loc_405B35:				; CODE XREF: sub_4058B7+18j
					; sub_4058B7+E4j ...
		add	esp, 44h
		pop	ebx
		pop	ebp
		retn
sub_4058B7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405B3B	proc near		; DATA XREF: .data:off_419148o

Dst		= dword	ptr -48h
Val		= dword	ptr -44h
Size		= dword	ptr -40h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_8]
		cmp	eax, 1
		jz	short loc_405B68
		cmp	eax, 2
		jz	short loc_405B91
		test	eax, eax
		jnz	short loc_405BBA
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_405BD1
; ---------------------------------------------------------------------------

loc_405B68:				; CODE XREF: sub_405B3B+12j
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+10h]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_14]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_405BD1
; ---------------------------------------------------------------------------

loc_405B91:				; CODE XREF: sub_405B3B+17j
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+14h]
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		lea	edx, [ecx+eax]
		mov	eax, [ebp+var_14]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_405BD1
; ---------------------------------------------------------------------------

loc_405BBA:				; CODE XREF: sub_405B3B+1Bj
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_405D56
; ---------------------------------------------------------------------------

loc_405BD1:				; CODE XREF: sub_405B3B+2Bj
					; sub_405B3B+54j ...
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jg	loc_405CE6
		cmp	edx, [ebp+var_C]
		jl	short loc_405BF3
		cmp	eax, [ebp+var_10]
		jnb	loc_405CE6

loc_405BF3:				; CODE XREF: sub_405B3B+ADj
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax+1Ch]
		and	eax, 1
		test	al, al
		jnz	short loc_405C18
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 1Ch
		mov	eax, 0FFFFFFFFh
		jmp	locret_405D56
; ---------------------------------------------------------------------------

loc_405C18:				; CODE XREF: sub_405B3B+C4j
		mov	eax, [ebp+var_14]
		mov	edx, [eax+18h]
		mov	eax, [ebp+var_10]
		add	eax, edx
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jg	short loc_405C57
		cmp	edx, [ebp+var_C]
		jl	short loc_405C40
		cmp	eax, [ebp+var_10]
		jnb	short loc_405C57

loc_405C40:				; CODE XREF: sub_405B3B+FEj
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_405D56
; ---------------------------------------------------------------------------

loc_405C57:				; CODE XREF: sub_405B3B+F9j
					; sub_405B3B+103j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_18]
		mov	edx, 0
		div	[ebp+var_2C]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_18]
		imul	eax, edx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_405CA9
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_18]
		jnb	short loc_405CA9
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 1Ch
		mov	eax, 0FFFFFFFFh
		jmp	locret_405D56
; ---------------------------------------------------------------------------

loc_405CA9:				; CODE XREF: sub_405B3B+14Aj
					; sub_405B3B+155j
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_18]
		mov	[esp+48h+Val], edx
		mov	[esp+48h+Dst], eax
		call	ecx
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_405CD4
		mov	eax, 0FFFFFFFFh
		jmp	locret_405D56
; ---------------------------------------------------------------------------

loc_405CD4:				; CODE XREF: sub_405B3B+18Dj
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_1C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_18]
		mov	[eax+8], edx

loc_405CE6:				; CODE XREF: sub_405B3B+A4j
					; sub_405B3B+B2j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jg	short loc_405D3A
		cmp	edx, [ebp+var_C]
		jl	short loc_405D00
		cmp	eax, [ebp+var_10]
		jnb	short loc_405D3A

loc_405D00:				; CODE XREF: sub_405B3B+1BEj
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_14]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		add	eax, edx
		mov	edx, ecx
		mov	[esp+48h+Size],	edx ; Size
		mov	[esp+48h+Val], 0 ; Val
		mov	[esp+48h+Dst], eax ; Dst
		call	memset
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	[eax+14h], edx

loc_405D3A:				; CODE XREF: sub_405B3B+1B9j
					; sub_405B3B+1C3j
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+var_14]
		mov	[eax+10h], edx
		mov	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	eax, 0

locret_405D56:				; CODE XREF: sub_405B3B+91j
					; sub_405B3B+D8j ...
		leave
		retn
sub_405B3B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405D58	proc near		; DATA XREF: sub_407DB0+109o

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+arg_4], 1
		jnz	short loc_405DA7
		mov	eax, [ebp+var_10]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [eax+10h]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+10h], 0
		mov	[ebp+var_C], 0
		jmp	short loc_405DBB
; ---------------------------------------------------------------------------

loc_405DA7:				; CODE XREF: sub_405D58+10j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	[ebp+var_C], 0FFFFFFFFh

loc_405DBB:				; CODE XREF: sub_405D58+4Dj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_405D58	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405DC0	proc near		; CODE XREF: sub_4074CE+33Fp
					; .text:00407DA9p ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_405DEE
		mov	eax, [ebp+var_C]
		mov	edx, [eax+24h]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[esp+28h+var_28], eax
		call	edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40557D

loc_405DEE:				; CODE XREF: sub_405DC0+10j
		mov	eax, 0
		leave
		retn
sub_405DC0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405DF5	proc near		; CODE XREF: sub_408034+55p
					; .text:00409AABp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 8 ; size_t
		call	sub_405533
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_405E19
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_405E58
; ---------------------------------------------------------------------------

loc_405E19:				; CODE XREF: sub_405DF5+19j
		mov	eax, [ebp+arg_8]
		and	eax, 8000h
		test	eax, eax
		jz	short loc_405E38
		mov	[esp+28h+var_24], 8000h
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	_setmode

loc_405E38:				; CODE XREF: sub_405DF5+2Ej
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_405E58:				; CODE XREF: sub_405DF5+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_405DF5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405E5D	proc near		; DATA XREF: .data:off_419150o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_405E7C
		mov	[ebp+var_C], 0
		jmp	short loc_405EAE
; ---------------------------------------------------------------------------

loc_405E7C:				; CODE XREF: sub_405E5D+14j
					; sub_405E5D+4Fj
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	_read
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_405EAE
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_405E7C

loc_405EAE:				; CODE XREF: sub_405E5D+1Dj
					; sub_405E5D+41j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_405E5D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405EB3	proc near		; DATA XREF: .data:off_419154o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_405ED1
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax
		jmp	short loc_405F03
; ---------------------------------------------------------------------------

loc_405ED1:				; CODE XREF: sub_405EB3+14j
					; sub_405EB3+4Ej
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	edx, [ebp+arg_4]
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		call	_write
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_405F03
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 4
		jz	short loc_405ED1

loc_405F03:				; CODE XREF: sub_405EB3+1Cj
					; sub_405EB3+40j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_405EB3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405F08	proc near		; DATA XREF: .data:off_419158o

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_405F35
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 1Dh
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_405F91
; ---------------------------------------------------------------------------

loc_405F35:				; CODE XREF: sub_405F08+15j
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	ecx, [ecx]
		mov	ebx, [ebp+arg_8]
		mov	[esp+28h+var_1C], ebx
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_28], ecx
		call	j__lseeki64
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_14]
		mov	edx, eax
		xor	edx, 0FFFFFFFFh
		mov	eax, [ebp+var_18]
		xor	eax, 0FFFFFFFFh
		or	eax, edx
		test	eax, eax
		jnz	short loc_405F7C
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_405F91
; ---------------------------------------------------------------------------

loc_405F7C:				; CODE XREF: sub_405F08+69j
		mov	ecx, [ebp+arg_4]
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	[ebp+var_C], 0

loc_405F91:				; CODE XREF: sub_405F08+2Bj
					; sub_405F08+72j
		mov	eax, [ebp+var_C]
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_405F08	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_405F9A	proc near		; CODE XREF: sub_407B8B+10Fp
					; sub_408034+DAp ...

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_405FED
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_405FBF
		mov	[ebp+var_C], 0
		jmp	short loc_405FE0
; ---------------------------------------------------------------------------

loc_405FBF:				; CODE XREF: sub_405F9A+1Aj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_405FD8
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax
		call	_close
		jmp	short loc_405FDD
; ---------------------------------------------------------------------------

loc_405FD8:				; CODE XREF: sub_405F9A+2Dj
		mov	eax, 0

loc_405FDD:				; CODE XREF: sub_405F9A+3Cj
		mov	[ebp+var_C], eax

loc_405FE0:				; CODE XREF: sub_405F9A+23j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40557D
		jmp	short loc_405FF4
; ---------------------------------------------------------------------------

loc_405FED:				; CODE XREF: sub_405F9A+10j
		mov	[ebp+var_C], 0

loc_405FF4:				; CODE XREF: sub_405F9A+51j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_405F9A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_405FF9(int, FILE *, int, int)
sub_405FF9	proc near		; CODE XREF: sub_408169+67p

File		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+File],	8 ; size_t
		call	sub_405533
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40601D
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_406064
; ---------------------------------------------------------------------------

loc_40601D:				; CODE XREF: sub_405FF9+19j
		mov	eax, [ebp+arg_8]
		and	eax, 8000h
		test	eax, eax
		jz	short loc_406044
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+File],	eax ; File
		call	_fileno
		mov	[esp+28h+var_24], 8000h
		mov	[esp+28h+File],	eax
		call	_setmode

loc_406044:				; CODE XREF: sub_405FF9+2Ej
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_C]
		mov	[eax+4], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	[ebp+var_C], 0

loc_406064:				; CODE XREF: sub_405FF9+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_405FF9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406069(int, void *, size_t)
sub_406069	proc near		; DATA XREF: .data:off_419160o

DstBuf		= dword	ptr -28h
ElementSize	= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4060A6
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Count], eax ; Count
		mov	[esp+28h+ElementSize], 1 ; ElementSize
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+DstBuf], eax ;	DstBuf
		call	fread
		mov	[ebp+var_C], eax
		jmp	short loc_4060AD
; ---------------------------------------------------------------------------

loc_4060A6:				; CODE XREF: sub_406069+13j
		mov	[ebp+var_C], 0

loc_4060AD:				; CODE XREF: sub_406069+3Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_4060CB
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+DstBuf], eax ;	File
		call	ferror
		test	eax, eax
		jz	short loc_4060CB
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4060CE
; ---------------------------------------------------------------------------

loc_4060CB:				; CODE XREF: sub_406069+48j
					; sub_406069+59j
		mov	eax, [ebp+var_C]

locret_4060CE:				; CODE XREF: sub_406069+60j
		leave
		retn
sub_406069	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4060D0(int, void *, size_t)
sub_4060D0	proc near		; DATA XREF: .data:off_419164o

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40610D
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Count], eax ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		mov	[ebp+var_C], eax
		jmp	short loc_406113
; ---------------------------------------------------------------------------

loc_40610D:				; CODE XREF: sub_4060D0+13j
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_C], eax

loc_406113:				; CODE XREF: sub_4060D0+3Bj
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jz	short loc_406122
		mov	eax, 0FFFFFFFFh
		jmp	short locret_406125
; ---------------------------------------------------------------------------

loc_406122:				; CODE XREF: sub_4060D0+49j
		mov	eax, [ebp+var_C]

locret_406125:				; CODE XREF: sub_4060D0+50j
		leave
		retn
sub_4060D0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406127	proc near		; DATA XREF: .data:off_419168o

File		= dword	ptr -28h
Offset		= dword	ptr -24h
Origin		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_406150
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 1Dh
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4061AF
; ---------------------------------------------------------------------------

loc_406150:				; CODE XREF: sub_406127+13j
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Origin], ecx ;	Origin
		mov	[esp+28h+Offset], edx ;	Offset
		mov	[esp+28h+File],	eax ; File
		call	fseek
		test	eax, eax
		jz	short loc_40617D
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4061AF
; ---------------------------------------------------------------------------

loc_40617D:				; CODE XREF: sub_406127+4Dj
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		call	ftell
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_40619A
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4061AF
; ---------------------------------------------------------------------------

loc_40619A:				; CODE XREF: sub_406127+6Aj
		mov	eax, [ebp+var_10]
		mov	edx, eax
		sar	edx, 1Fh
		mov	ecx, [ebp+arg_4]
		mov	[ecx], eax
		mov	[ecx+4], edx
		mov	eax, 0

locret_4061AF:				; CODE XREF: sub_406127+27j
					; sub_406127+54j ...
		leave
		retn
sub_406127	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4061B1	proc near		; CODE XREF: sub_408169+101p
					; DATA XREF: .data:off_41916Co

File		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_406210
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_4061FC
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		call	fflush
		mov	eax, [ebp+var_10]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	short loc_4061F2
		mov	eax, [ebp+var_10]
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; File
		call	fclose
		jmp	short loc_4061F7
; ---------------------------------------------------------------------------

loc_4061F2:				; CODE XREF: sub_4061B1+30j
		mov	eax, 0

loc_4061F7:				; CODE XREF: sub_4061B1+3Fj
		mov	[ebp+var_C], eax
		jmp	short loc_406203
; ---------------------------------------------------------------------------

loc_4061FC:				; CODE XREF: sub_4061B1+19j
		mov	[ebp+var_C], 0

loc_406203:				; CODE XREF: sub_4061B1+49j
		mov	eax, [ebp+var_10]
		mov	[esp+28h+File],	eax ; void *
		call	sub_40557D
		jmp	short loc_406217
; ---------------------------------------------------------------------------

loc_406210:				; CODE XREF: sub_4061B1+10j
		mov	[ebp+var_C], 0

loc_406217:				; CODE XREF: sub_4061B1+5Dj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4061B1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40621C	proc near		; CODE XREF: sub_407B8B+55p
					; .text:00408699p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0FFFFFFFFh
		mov	[esp+28h+var_28], 8 ; size_t
		call	sub_405533
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_40624E
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_4062BB
; ---------------------------------------------------------------------------

loc_40624E:				; CODE XREF: sub_40621C+27j
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_20], 180h
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_28], eax
		call	_open
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0FFFFFFFFh
		jnz	short loc_40627A
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_4062BB
; ---------------------------------------------------------------------------

loc_40627A:				; CODE XREF: sub_40621C+53j
		mov	eax, [ebp+arg_C]
		and	eax, 8000h
		test	eax, eax
		jz	short loc_406299
		mov	[esp+28h+var_24], 8000h
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax
		call	_setmode

loc_406299:				; CODE XREF: sub_40621C+68j
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+4], 0
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_4062BB:				; CODE XREF: sub_40621C+30j
					; sub_40621C+5Cj
		cmp	[ebp+var_C], 0
		jz	short loc_4062CC
		mov	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40557D

loc_4062CC:				; CODE XREF: sub_40621C+A3j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40621C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4062D1	proc near		; CODE XREF: sub_407B8B+28p
					; .text:00407CC9p ...

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	eax, 72h
		jz	short loc_4062F1
		cmp	eax, 77h
		jz	short loc_406301
		cmp	eax, 61h
		jz	short loc_406311
		jmp	short loc_406321
; ---------------------------------------------------------------------------

loc_4062F1:				; CODE XREF: sub_4062D1+12j
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	short loc_406335
; ---------------------------------------------------------------------------

loc_406301:				; CODE XREF: sub_4062D1+17j
		mov	[ebp+var_C], 1
		mov	[ebp+var_10], 300h
		jmp	short loc_406335
; ---------------------------------------------------------------------------

loc_406311:				; CODE XREF: sub_4062D1+1Cj
		mov	[ebp+var_C], 1
		mov	[ebp+var_10], 108h
		jmp	short loc_406335
; ---------------------------------------------------------------------------

loc_406321:				; CODE XREF: sub_4062D1+1Ej
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40638F
; ---------------------------------------------------------------------------

loc_406335:				; CODE XREF: sub_4062D1+2Ej
					; sub_4062D1+3Ej ...
		add	[ebp+arg_0], 1
		jmp	short loc_406373
; ---------------------------------------------------------------------------

loc_40633B:				; CODE XREF: sub_4062D1+AAj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	eax, 62h
		jz	short loc_40635C
		cmp	eax, 78h
		jz	short loc_406365
		cmp	eax, 2Bh
		jnz	short loc_40636E
		mov	[ebp+var_C], 2
		jmp	short loc_40636F
; ---------------------------------------------------------------------------

loc_40635C:				; CODE XREF: sub_4062D1+76j
		or	[ebp+var_10], 8000h
		jmp	short loc_40636F
; ---------------------------------------------------------------------------

loc_406365:				; CODE XREF: sub_4062D1+7Bj
		or	[ebp+var_10], 400h
		jmp	short loc_40636F
; ---------------------------------------------------------------------------

loc_40636E:				; CODE XREF: sub_4062D1+80j
		nop

loc_40636F:				; CODE XREF: sub_4062D1+89j
					; sub_4062D1+92j ...
		add	[ebp+arg_0], 1

loc_406373:				; CODE XREF: sub_4062D1+68j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40633B
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], edx
		mov	eax, 0

locret_40638F:				; CODE XREF: sub_4062D1+62j
		leave
		retn
sub_4062D1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406391	proc near		; CODE XREF: sub_406BAC+2Fp
					; sub_4073E4+4Bp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+230h]
		test	eax, eax
		jnz	short loc_4063C6
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 28h
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_406422
; ---------------------------------------------------------------------------

loc_4063C6:				; CODE XREF: sub_406391+1Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+230h]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_406415
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_406422
; ---------------------------------------------------------------------------

loc_406415:				; CODE XREF: sub_406391+72j
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0

loc_406422:				; CODE XREF: sub_406391+33j
					; sub_406391+82j
		cmp	[ebp+var_10], 0
		jz	short loc_406440
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl
		jmp	short loc_40645C
; ---------------------------------------------------------------------------

loc_406440:				; CODE XREF: sub_406391+95j
		cmp	[ebp+var_C], 0
		jnz	short loc_40645C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 2
		mov	[eax+24Ch], dl

loc_40645C:				; CODE XREF: sub_406391+ADj
					; sub_406391+B3j
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+var_10]
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_406391	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4064AC	proc near		; CODE XREF: sub_406870+7Cp
					; sub_406CC3+35p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 30h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+234h]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_4064ED
		mov	[esp+38h+var_30], 4F3h ; int
		mov	[esp+38h+var_34], offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+38h+var_38], offset aStreamFlags_wr ; "stream->flags.writing"
		call	sub_4185A0

loc_4064ED:				; CODE XREF: sub_4064AC+23j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_406618
		cmp	[ebp+var_18], 0
		jnz	short loc_40650D
		mov	[ebp+var_C], 28h
		jmp	loc_40661F
; ---------------------------------------------------------------------------

loc_40650D:				; CODE XREF: sub_4064AC+53j
		mov	[ebp+var_14], 0
		mov	[ebp+var_C], 0
		jmp	short loc_406579
; ---------------------------------------------------------------------------

loc_40651D:				; CODE XREF: sub_4064AC+DEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	ecx, eax
		sub	ecx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+38h+var_30], ecx
		mov	[esp+38h+var_34], edx
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+var_18]
		call	eax
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0FFFFFFFFh
		jnz	short loc_406567
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_40656D
; ---------------------------------------------------------------------------

loc_406567:				; CODE XREF: sub_4064AC+A9j
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_10], eax

loc_40656D:				; CODE XREF: sub_4064AC+B9j
		mov	eax, [ebp+var_10]
		add	[ebp+var_14], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40658E

loc_406579:				; CODE XREF: sub_4064AC+6Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		sub	eax, [ebp+var_14]
		test	eax, eax
		jle	short loc_40658F
		cmp	[ebp+var_C], 0
		jz	short loc_40651D
		jmp	short loc_40658F
; ---------------------------------------------------------------------------

loc_40658E:				; CODE XREF: sub_4064AC+CBj
		nop

loc_40658F:				; CODE XREF: sub_4064AC+D8j
					; sub_4064AC+E0j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_14]
		jnz	short loc_40661F
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+var_18]
		call	eax
		jmp	short loc_40661F
; ---------------------------------------------------------------------------

loc_406618:				; CODE XREF: sub_4064AC+49j
		mov	[ebp+var_C], 0

loc_40661F:				; CODE XREF: sub_4064AC+5Cj
					; sub_4064AC+FDj ...
		cmp	[ebp+var_C], 0
		jz	short loc_40663B
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl

loc_40663B:				; CODE XREF: sub_4064AC+177j
		mov	eax, [ebp+var_C]
		add	esp, 30h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_4064AC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406645	proc near		; CODE XREF: sub_406EB6+116p
					; sub_40799C+33p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_406675
		mov	[esp+18h+var_10], 536h ; int
		mov	[esp+18h+var_14], offset a____Gnupg22__0 ; "../../gnupg2-2.0.30/common/estream.c"
		mov	[esp+18h+var_18], offset aStreamFlags__0 ; "!stream->flags.writing"
		call	sub_4185A0

loc_406675:				; CODE XREF: sub_406645+12j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		leave
		retn
sub_406645	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406695	proc near		; CODE XREF: sub_406974+D5p
					; .text:004086F1p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_4]
		mov	[eax+214h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+218h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+228h], 0
		mov	dword ptr [eax+22Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_C]
		mov	[eax+230h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_10]
		mov	[eax+234h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_14]
		mov	[eax+238h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+23Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_18]
		mov	[eax+240h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+244h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_8]
		mov	[eax+248h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFEFh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+254h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+258h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+25Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFEh
		mov	[eax+24Ch], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+24Ch], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFFDh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFF3h
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFFEh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+220h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFDFh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+8], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+arg_1C]
		and	eax, 1
		test	al, al
		jnz	short loc_406852
		mov	eax, [ebp+arg_1C]
		and	eax, 2
		test	eax, eax
		jz	short loc_406861

loc_406852:				; CODE XREF: sub_406695+1B1j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		or	edx, 1
		mov	[eax+20h], dl
		jmp	short loc_40686E
; ---------------------------------------------------------------------------

loc_406861:				; CODE XREF: sub_406695+1BBj
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_40686E:				; CODE XREF: sub_406695+1CAj
		pop	ebp
		retn
sub_406695	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406870	proc near		; CODE XREF: sub_406974+112p
					; sub_406A9B+2Bp ...

File		= dword	ptr -28h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+25Ch]
		test	eax, eax
		jz	short loc_4068C2
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+25Ch]
		mov	[esp+28h+File],	eax ; File
		call	fclose
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+25Ch], 0
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_4068C2:				; CODE XREF: sub_406870+14j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+240h]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_406906
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax
		call	sub_4064AC
		mov	[ebp+var_18], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_406906
		cmp	[ebp+var_18], 0
		jz	short loc_406906
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_406906:				; CODE XREF: sub_406870+74j
					; sub_406870+88j ...
		cmp	[ebp+var_14], 0
		jz	short loc_406935
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+File],	eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_406935
		cmp	[ebp+var_18], 0
		jz	short loc_406935
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_406935:				; CODE XREF: sub_406870+9Aj
					; sub_406870+B7j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	[esp+28h+File],	eax ; void *
		call	sub_40557D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+220h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFDFh
		mov	[eax+250h], dl
		mov	eax, [ebp+var_C]
		leave
		retn
sub_406870	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406974	proc near		; CODE XREF: sub_4074CE+C8p
					; sub_407B8B+B9p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[esp+38h+var_38], 28h ;	size_t
		call	sub_405533
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4069A9
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_406A74
; ---------------------------------------------------------------------------

loc_4069A9:				; CODE XREF: sub_406974+27j
		mov	[esp+38h+var_38], 260h ; size_t
		call	sub_405533
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4069CA
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_406A74
; ---------------------------------------------------------------------------

loc_4069CA:				; CODE XREF: sub_406974+48j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+4], 200h
		mov	eax, [ebp+var_14]
		lea	edx, [eax+200h]
		mov	eax, [ebp+var_10]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_10]
		mov	dword ptr [eax+18h], 10h
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		mov	[eax+24h], edx
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+38h+var_38], eax
		call	sub_405524
		mov	eax, [ebp+arg_1C]
		mov	[esp+38h+var_1C], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_14]
		mov	[esp+38h+var_24], eax
		mov	eax, [ebp+arg_18]
		mov	[esp+38h+var_20], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_406695
		mov	eax, [ebp+arg_20]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_405596
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_406A73
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_406A74
; ---------------------------------------------------------------------------

loc_406A73:				; CODE XREF: sub_406974+F3j
		nop

loc_406A74:				; CODE XREF: sub_406974+30j
					; sub_406974+51j ...
		cmp	[ebp+var_C], 0
		jz	short loc_406A96
		cmp	[ebp+var_10], 0
		jz	short loc_406A96
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax
		call	sub_406870
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_38], eax ;	void *
		call	sub_40557D

loc_406A96:				; CODE XREF: sub_406974+104j
					; sub_406974+10Aj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_406974	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406A9B(void *, int)
sub_406A9B	proc near		; CODE XREF: sub_4074CE+32Bp
					; .text:00408721p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_0], 0
		jz	short loc_406AE7
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_405629
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_406870
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40557D
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40557D

loc_406AE7:				; CODE XREF: sub_406A9B+11j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_406A9B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406AEC	proc near		; CODE XREF: sub_406CC3+DFp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+230h]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	short loc_406B5F
; ---------------------------------------------------------------------------

loc_406B13:				; CODE XREF: sub_406AEC+79j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_406B53
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_406B6A
; ---------------------------------------------------------------------------

loc_406B53:				; CODE XREF: sub_406AEC+5Cj
		cmp	[ebp+var_18], 0
		jz	short loc_406B69
		mov	eax, [ebp+var_18]
		add	[ebp+var_C], eax

loc_406B5F:				; CODE XREF: sub_406AEC+25j
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jnz	short loc_406B13
		jmp	short loc_406B6A
; ---------------------------------------------------------------------------

loc_406B69:				; CODE XREF: sub_406AEC+6Bj
		nop

loc_406B6A:				; CODE XREF: sub_406AEC+65j
					; sub_406AEC+7Bj
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+var_C]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_406AEC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406BAC	proc near		; CODE XREF: sub_406C95+21p
					; sub_406CC3+141p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		jmp	loc_406C73
; ---------------------------------------------------------------------------

loc_406BC5:				; CODE XREF: sub_406BAC+D3j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_406BF7
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_406391
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_406BF7
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	loc_406C87

loc_406BF7:				; CODE XREF: sub_406BAC+27j
					; sub_406BAC+3Bj
		cmp	[ebp+var_14], 0
		jnz	short loc_406C73
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+var_18]
		jbe	short loc_406C2F
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_406C2F:				; CODE XREF: sub_406BAC+7Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		add	eax, edx
		mov	edx, ecx
		mov	ecx, [ebp+var_C]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_C]
		add	[ebp+var_10], eax

loc_406C73:				; CODE XREF: sub_406BAC+14j
					; sub_406BAC+4Fj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_10]
		jz	short loc_406C88
		cmp	[ebp+var_14], 0
		jz	loc_406BC5
		jmp	short loc_406C88
; ---------------------------------------------------------------------------

loc_406C87:				; CODE XREF: sub_406BAC+45j
		nop

loc_406C88:				; CODE XREF: sub_406BAC+CDj
					; sub_406BAC+D9j
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		leave
		retn
sub_406BAC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406C95	proc near		; CODE XREF: sub_406CC3+110p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_406BAC
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_406C95	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406CC3	proc near		; CODE XREF: sub_408D03+22p
					; sub_408F0D+3Bp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_406D4A
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4064AC
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_406E0E
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl
		jmp	short loc_406D4A
; ---------------------------------------------------------------------------

loc_406D19:				; CODE XREF: sub_406CC3+97j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+14h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		sub	eax, 1
		add	eax, ecx
		movzx	eax, byte ptr [eax]
		mov	[edx], al
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_0]
		mov	[eax+1Ch], edx
		add	[ebp+var_C], 1

loc_406D4A:				; CODE XREF: sub_406CC3+2Dj
					; sub_406CC3+54j
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jz	short loc_406D5C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_406D19

loc_406D5C:				; CODE XREF: sub_406CC3+8Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+244h]
		cmp	eax, 4
		jz	short loc_406D7B
		cmp	eax, 40h
		jz	short loc_406DAC
		test	eax, eax
		jz	short loc_406DDD
		jmp	loc_406E0F
; ---------------------------------------------------------------------------

loc_406D7B:				; CODE XREF: sub_406CC3+A8j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_406AEC
		mov	[ebp+var_10], eax
		jmp	short loc_406E0F
; ---------------------------------------------------------------------------

loc_406DAC:				; CODE XREF: sub_406CC3+ADj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_406C95
		mov	[ebp+var_10], eax
		jmp	short loc_406E0F
; ---------------------------------------------------------------------------

loc_406DDD:				; CODE XREF: sub_406CC3+B1j
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_14]
		add	edx, eax
		lea	eax, [ebp+var_18]
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_406BAC
		mov	[ebp+var_10], eax
		jmp	short loc_406E0F
; ---------------------------------------------------------------------------

loc_406E0E:				; CODE XREF: sub_406CC3+41j
		nop

loc_406E0F:				; CODE XREF: sub_406CC3+B3j
					; sub_406CC3+E7j ...
		cmp	[ebp+arg_C], 0
		jz	short loc_406E22
		mov	eax, [ebp+var_18]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_406E22:				; CODE XREF: sub_406CC3+150j
		mov	eax, [ebp+var_10]
		leave
		retn
sub_406CC3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_406E27(int, void *, size_t, int)
sub_406E27	proc near		; CODE XREF: .text:00408EE1p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+18h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jbe	short loc_406E50
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_8], eax

loc_406E50:				; CODE XREF: sub_406E27+21j
		cmp	[ebp+arg_8], 0
		jz	short loc_406EA5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		add	eax, edx
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_0]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+24Ch], dl
		jmp	short loc_406EA6
; ---------------------------------------------------------------------------

loc_406EA5:				; CODE XREF: sub_406E27+2Dj
		nop

loc_406EA6:				; CODE XREF: sub_406E27+7Cj
		cmp	[ebp+arg_C], 0
		jz	short locret_406EB4
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+arg_8]
		mov	[eax], edx

locret_406EB4:				; CODE XREF: sub_406E27+83j
		leave
		retn
sub_406E27	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_406EB6	proc near		; CODE XREF: sub_4072A4+58p
					; sub_4074CE+270p ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_40], eax
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+238h]
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_406EF9
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 28h
		mov	[ebp+var_1C], 0FFFFFFFFh
		jmp	loc_407016
; ---------------------------------------------------------------------------

loc_406EF9:				; CODE XREF: sub_406EB6+28j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_406F2C
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_4064AC
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	loc_407015
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_406F2C:				; CODE XREF: sub_406EB6+4Fj
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[ebp+var_30], eax
		mov	[ebp+var_2C], edx
		cmp	[ebp+arg_C], 1
		jnz	short loc_406F8B
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+8]
		mov	ebx, 0
		mov	esi, eax
		mov	edi, edx
		sub	esi, ecx
		sbb	edi, ebx
		mov	ecx, esi
		mov	ebx, edi
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[ebp+var_30], eax
		mov	[ebp+var_2C], edx
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+1Ch]
		mov	ebx, 0
		sub	eax, ecx
		sbb	edx, ebx
		mov	[ebp+var_30], eax
		mov	[ebp+var_2C], edx

loc_406F8B:				; CODE XREF: sub_406EB6+86j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	edx, [ebp+arg_C]
		mov	[esp+58h+var_50], edx
		lea	edx, [ebp+var_30]
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+var_20]
		call	eax
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0FFFFFFFFh
		jnz	short loc_406FBF
		mov	[ebp+var_1C], 0FFFFFFFFh
		jmp	short loc_407016
; ---------------------------------------------------------------------------

loc_406FBF:				; CODE XREF: sub_406EB6+FEj
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_406645
		cmp	[ebp+arg_10], 0
		jz	short loc_406FE5
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	ecx, [ebp+arg_10]
		mov	[ecx], eax
		mov	[ecx+4], edx

loc_406FE5:				; CODE XREF: sub_406EB6+11Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		mov	[eax+24Ch], dl
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+24h]
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		mov	[ecx+228h], eax
		mov	[ecx+22Ch], edx
		jmp	short loc_407016
; ---------------------------------------------------------------------------

loc_407015:				; CODE XREF: sub_406EB6+63j
		nop

loc_407016:				; CODE XREF: sub_406EB6+3Ej
					; sub_406EB6+107j ...
		cmp	[ebp+var_1C], 0
		jz	short loc_407032
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl

loc_407032:				; CODE XREF: sub_406EB6+164j
		mov	eax, [ebp+var_1C]
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_406EB6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40703D	proc near		; CODE XREF: sub_4071DE+79p
					; sub_4072A4+B6p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+234h]
		mov	[ebp+var_14], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_40706C
		cmp	[ebp+var_14], 0
		jnz	short loc_40706C
		mov	[ebp+var_10], 28h
		jmp	loc_407102
; ---------------------------------------------------------------------------

loc_40706C:				; CODE XREF: sub_40703D+1Bj
					; sub_40703D+21j
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	short loc_4070C2
; ---------------------------------------------------------------------------

loc_40707C:				; CODE XREF: sub_40703D+8Bj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		add	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], edx
		mov	[esp+28h+var_28], eax
		mov	eax, [ebp+var_14]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_4070BC
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_4070CA
; ---------------------------------------------------------------------------

loc_4070BC:				; CODE XREF: sub_40703D+74j
		mov	eax, [ebp+var_18]
		add	[ebp+var_C], eax

loc_4070C2:				; CODE XREF: sub_40703D+3Dj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_C]
		jnz	short loc_40707C

loc_4070CA:				; CODE XREF: sub_40703D+7Dj
		mov	eax, [ebp+arg_0]
		mov	esi, [eax+24h]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+var_C]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[esi+228h], eax
		mov	[esi+22Ch], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_C]
		mov	[eax], edx

loc_407102:				; CODE XREF: sub_40703D+2Aj
		mov	eax, [ebp+var_10]
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_40703D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40710C	proc near		; CODE XREF: sub_4071DE+ACp
					; sub_4072A4+100p

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		jmp	loc_4071BF
; ---------------------------------------------------------------------------

loc_407125:				; CODE XREF: sub_40710C+BFj
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnz	short loc_407143
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Dst], eax
		call	sub_4064AC
		mov	[ebp+var_14], eax

loc_407143:				; CODE XREF: sub_40710C+27j
		cmp	[ebp+var_14], 0
		jnz	short loc_4071BF
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+var_18]
		jbe	short loc_40717B
		mov	eax, [ebp+var_18]
		mov	[ebp+var_C], eax

loc_40717B:				; CODE XREF: sub_40710C+67j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+arg_4]
		lea	ecx, [edx+eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	eax, edx
		mov	edx, ecx
		mov	ecx, [ebp+var_C]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_C]
		add	[ebp+var_10], eax

loc_4071BF:				; CODE XREF: sub_40710C+14j
					; sub_40710C+3Bj
		mov	eax, [ebp+arg_8]
		cmp	eax, [ebp+var_10]
		jz	short loc_4071D1
		cmp	[ebp+var_14], 0
		jz	loc_407125

loc_4071D1:				; CODE XREF: sub_40710C+B9j
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		leave
		retn
sub_40710C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4071DE	proc near		; CODE XREF: sub_4072A4+DBp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+var_24], 0Ah
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_4153C5
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40725F
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4064AC
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40725F
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_4]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40703D
		mov	[ebp+var_C], eax

loc_40725F:				; CODE XREF: sub_4071DE+3Cj
					; sub_4071DE+50j
		cmp	[ebp+var_C], 0
		jnz	short loc_407292
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, [ebp+var_14]
		add	eax, [ebp+arg_4]
		lea	edx, [ebp+var_18]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], ecx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40710C
		mov	[ebp+var_C], eax

loc_407292:				; CODE XREF: sub_4071DE+85j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		add	edx, eax
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4071DE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4072A4	proc near		; CODE XREF: sub_407847+2Ep
					; .text:00407F31p ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_407323
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+238h]
		test	eax, eax
		jz	short loc_407323
		mov	[esp+38h+var_28], 0
		mov	[esp+38h+var_2C], 1
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_30], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_406EB6
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_407323
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 1Dh
		jnz	loc_4073AE
		mov	[ebp+var_C], 0

loc_407323:				; CODE XREF: sub_4072A4+20j
					; sub_4072A4+30j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+244h]
		cmp	eax, 4
		jz	short loc_40733F
		cmp	eax, 40h
		jz	short loc_407364
		test	eax, eax
		jz	short loc_407389
		jmp	short loc_4073AF
; ---------------------------------------------------------------------------

loc_40733F:				; CODE XREF: sub_4072A4+8Ej
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_40703D
		mov	[ebp+var_C], eax
		jmp	short loc_4073AF
; ---------------------------------------------------------------------------

loc_407364:				; CODE XREF: sub_4072A4+93j
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_4071DE
		mov	[ebp+var_C], eax
		jmp	short loc_4073AF
; ---------------------------------------------------------------------------

loc_407389:				; CODE XREF: sub_4072A4+97j
		lea	eax, [ebp+var_10]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_40710C
		mov	[ebp+var_C], eax
		jmp	short loc_4073AF
; ---------------------------------------------------------------------------

loc_4073AE:				; CODE XREF: sub_4072A4+72j
		nop

loc_4073AF:				; CODE XREF: sub_4072A4+99j
					; sub_4072A4+BEj ...
		cmp	[ebp+arg_C], 0
		jz	short loc_4073BD
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx

loc_4073BD:				; CODE XREF: sub_4072A4+10Fj
		mov	eax, [ebp+var_10]
		test	eax, eax
		jz	short loc_4073DF
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_4073DF
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		or	edx, 1
		mov	[eax+20h], dl

loc_4073DF:				; CODE XREF: sub_4072A4+11Ej
					; sub_4072A4+12Cj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4072A4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4073E4	proc near		; CODE XREF: sub_4074CE+10Ep

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_407419
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4064AC
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_407477
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_407419:				; CODE XREF: sub_4073E4+12j
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnz	short loc_40743D
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_406391
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40747A

loc_40743D:				; CODE XREF: sub_4073E4+43j
		cmp	[ebp+arg_4], 0
		jz	short loc_407455
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[eax], edx

loc_407455:				; CODE XREF: sub_4073E4+5Dj
		cmp	[ebp+arg_8], 0
		jz	short loc_40746E
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+8]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		sub	edx, eax
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_40746E:				; CODE XREF: sub_4073E4+75j
		mov	[ebp+var_C], 0
		jmp	short loc_40747B
; ---------------------------------------------------------------------------

loc_407477:				; CODE XREF: sub_4073E4+26j
		nop
		jmp	short loc_40747B
; ---------------------------------------------------------------------------

loc_40747A:				; CODE XREF: sub_4073E4+57j
		nop

loc_40747B:				; CODE XREF: sub_4073E4+91j
					; sub_4073E4+94j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4073E4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407480	proc near		; CODE XREF: sub_4074CE+1BBp
					; sub_4074CE+207p

var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jbe	short loc_4074B1
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_4074C9
; ---------------------------------------------------------------------------

loc_4074B1:				; CODE XREF: sub_407480+19j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, eax
		add	edx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		mov	[ebp+var_C], 0

loc_4074C9:				; CODE XREF: sub_407480+2Fj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_407480	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4074CE	proc near		; CODE XREF: .text:004092FFp

Buf		= dword	ptr -68h
Val		= dword	ptr -64h
MaxCount	= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	[ebp+var_14], 0
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		lea	eax, [ebp+var_24]
		mov	[esp+68h+var_44], 0
		mov	[esp+68h+var_48], 2
		mov	[esp+68h+var_4C], offset sub_40557D
		mov	[esp+68h+var_50], offset sub_405550
		mov	[esp+68h+var_54], 1
		mov	[esp+68h+var_58], 200h
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+MaxCount], 0
		mov	[esp+68h+Val], 0
		mov	[esp+68h+Buf], eax
		call	sub_40574D
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_4077D7
		mov	eax, [ebp+var_24]
		mov	[esp+68h+var_48], 0
		mov	[esp+68h+var_4C], 2
		mov	edx, off_419140
		mov	[esp+68h+var_5C], edx
		mov	edx, off_419144
		mov	[esp+68h+var_58], edx
		mov	edx, off_419148
		mov	[esp+68h+var_54], edx
		mov	edx, off_41914C
		mov	[esp+68h+var_50], edx
		mov	[esp+68h+MaxCount], 0FFFFFFFFh
		mov	[esp+68h+Val], eax
		lea	eax, [ebp+var_20]
		mov	[esp+68h+Buf], eax
		call	sub_406974
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_4077DA
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	short loc_4075B8
; ---------------------------------------------------------------------------

loc_4075B7:				; CODE XREF: sub_4074CE+210j
		nop

loc_4075B8:				; CODE XREF: sub_4074CE+E7j
		cmp	[ebp+arg_4], 0
		jz	short loc_4075C8
		cmp	[ebp+var_C], 1
		jz	loc_4076E6

loc_4075C8:				; CODE XREF: sub_4074CE+EEj
		lea	eax, [ebp+var_2C]
		mov	[esp+68h+MaxCount], eax
		lea	eax, [ebp+var_28]
		mov	[esp+68h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Buf], eax
		call	sub_4073E4
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_4076E7
		mov	eax, [ebp+var_2C]
		test	eax, eax
		jz	loc_4076E7
		mov	eax, [ebp+var_C]
		lea	edx, [eax-1]
		mov	eax, [ebp+var_2C]
		cmp	edx, eax
		jnb	short loc_40760F
		mov	eax, [ebp+var_C]
		sub	eax, 1
		mov	[ebp+var_2C], eax

loc_40760F:				; CODE XREF: sub_4074CE+136j
		mov	edx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	[esp+68h+MaxCount], edx	; MaxCount
		mov	[esp+68h+Val], 0Ah ; Val
		mov	[esp+68h+Buf], eax ; Buf
		call	memchr
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_407690
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_28]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+MaxCount], ecx
		mov	[esp+68h+Val], edx
		mov	[esp+68h+Buf], eax
		call	sub_408F72
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_4076DA
		mov	eax, [ebp+var_2C]
		sub	[ebp+var_C], eax
		mov	eax, [ebp+var_2C]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Buf], eax
		call	sub_407480
		jmp	short loc_4076E7
; ---------------------------------------------------------------------------

loc_407690:				; CODE XREF: sub_4074CE+162j
		mov	ecx, [ebp+var_2C]
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+MaxCount], ecx
		mov	[esp+68h+Val], edx
		mov	[esp+68h+Buf], eax
		call	sub_408F72
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_4076DA
		mov	eax, [ebp+var_2C]
		sub	[ebp+var_C], eax
		mov	eax, [ebp+var_2C]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+68h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Buf], eax
		call	sub_407480

loc_4076DA:				; CODE XREF: sub_4074CE+1A0j
					; sub_4074CE+1ECj
		cmp	[ebp+var_18], 0
		jz	loc_4075B7
		jmp	short loc_4076E7
; ---------------------------------------------------------------------------

loc_4076E6:				; CODE XREF: sub_4074CE+F4j
		nop

loc_4076E7:				; CODE XREF: sub_4074CE+11Aj
					; sub_4074CE+125j ...
		cmp	[ebp+var_18], 0
		jnz	loc_4077DD
		cmp	[ebp+arg_4], 1
		jbe	short loc_407718
		cmp	[ebp+var_10], 0
		jnz	short loc_407718
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 2
		mov	[eax+24Ch], dl
		jmp	loc_4077E4
; ---------------------------------------------------------------------------

loc_407718:				; CODE XREF: sub_4074CE+227j
					; sub_4074CE+22Dj
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_58], 0
		mov	[esp+68h+var_5C], 0
		mov	[esp+68h+Val], 0
		mov	[esp+68h+MaxCount], 0
		mov	[esp+68h+Buf], eax
		call	sub_406EB6
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	loc_4077E0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_407779
		mov	eax, [ebp+var_10]
		add	eax, 1
		mov	[esp+68h+Buf], eax ; size_t
		call	sub_405533
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_407781
		mov	[ebp+var_18], 0FFFFFFFFh
		jmp	short loc_4077E4
; ---------------------------------------------------------------------------

loc_407779:				; CODE XREF: sub_4074CE+289j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_407781:				; CODE XREF: sub_4074CE+2A0j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_20]
		mov	[esp+68h+var_5C], 0
		mov	ecx, [ebp+var_10]
		mov	[esp+68h+MaxCount], ecx
		mov	[esp+68h+Val], edx
		mov	[esp+68h+Buf], eax
		call	sub_408F0D
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_4077E3
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_14]
		add	eax, edx
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4077C7
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_4077C7:				; CODE XREF: sub_4074CE+2EFj
		cmp	[ebp+arg_C], 0
		jz	short loc_4077E4
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_4077E4
; ---------------------------------------------------------------------------

loc_4077D7:				; CODE XREF: sub_4074CE+75j
		nop
		jmp	short loc_4077E4
; ---------------------------------------------------------------------------

loc_4077DA:				; CODE XREF: sub_4074CE+D4j
		nop
		jmp	short loc_4077E4
; ---------------------------------------------------------------------------

loc_4077DD:				; CODE XREF: sub_4074CE+21Dj
		nop
		jmp	short loc_4077E4
; ---------------------------------------------------------------------------

loc_4077E0:				; CODE XREF: sub_4074CE+27Cj
		nop
		jmp	short loc_4077E4
; ---------------------------------------------------------------------------

loc_4077E3:				; CODE XREF: sub_4074CE+2DBj
		nop

loc_4077E4:				; CODE XREF: sub_4074CE+245j
					; sub_4074CE+2A9j ...
		mov	eax, [ebp+var_20]
		test	eax, eax
		jz	short loc_407800
		mov	eax, [ebp+var_20]
		mov	[esp+68h+Val], 0 ; int
		mov	[esp+68h+Buf], eax ; void *
		call	sub_406A9B
		jmp	short loc_407812
; ---------------------------------------------------------------------------

loc_407800:				; CODE XREF: sub_4074CE+31Bj
		mov	eax, [ebp+var_24]
		test	eax, eax
		jz	short loc_407812
		mov	eax, [ebp+var_24]
		mov	[esp+68h+Buf], eax
		call	sub_405DC0

loc_407812:				; CODE XREF: sub_4074CE+330j
					; sub_4074CE+337j
		cmp	[ebp+var_18], 0
		jz	short loc_407842
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_40782C
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Buf], eax ; void *
		call	sub_40557D

loc_40782C:				; CODE XREF: sub_4074CE+351j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+24Ch]
		or	edx, 1
		mov	[eax+24Ch], dl

loc_407842:				; CODE XREF: sub_4074CE+348j
		mov	eax, [ebp+var_18]
		leave
		retn
sub_4074CE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407847	proc near		; DATA XREF: sub_40789F+2Bo

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_4]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_4072A4
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_C]
		mov	edx, [edx+24h]
		mov	ecx, [edx+258h]
		mov	edx, [ebp+var_14]
		add	edx, ecx
		mov	[eax+258h], edx
		mov	eax, [ebp+var_10]
		leave
		retn
sub_407847	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40789F	proc near		; CODE XREF: .text:004096D3p
					; .text:00409708p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+258h], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	[esp+28h+var_28], offset sub_407847
		call	sub_40EBCB
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4078E6
		mov	eax, 0FFFFFFFFh
		jmp	short locret_4078F2
; ---------------------------------------------------------------------------

loc_4078E6:				; CODE XREF: sub_40789F+3Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+258h]

locret_4078F2:				; CODE XREF: sub_40789F+45j
		leave
		retn
sub_40789F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4078F4	proc near		; CODE XREF: sub_40799C+4Ep
					; .text:00407FA7p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jz	short loc_407921
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		cmp	[ebp+arg_4], 0
		setnz	dl
		mov	ecx, edx
		and	ecx, 1
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFEh
		or	edx, ecx
		mov	[eax+24Ch], dl

loc_407921:				; CODE XREF: sub_4078F4+7j
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jz	short loc_40794C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		cmp	[ebp+arg_8], 0
		setnz	dl
		and	edx, 1
		lea	ecx, [edx+edx]
		movzx	edx, byte ptr [eax+24Ch]
		and	edx, 0FFFFFFFDh
		or	edx, ecx
		mov	[eax+24Ch], dl

loc_40794C:				; CODE XREF: sub_4078F4+31j
		pop	ebp
		retn
sub_4078F4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40794E	proc near		; CODE XREF: sub_408965+1Cp
					; sub_4089C9+1Cp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_407979
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+24Ch]
		and	eax, 1
		movzx	eax, al
		mov	[ebp+var_4], eax
		jmp	short loc_407997
; ---------------------------------------------------------------------------

loc_407979:				; CODE XREF: sub_40794E+11j
		cmp	[ebp+arg_8], 0
		jz	short loc_407997
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+24Ch]
		shr	al, 1
		and	eax, 1
		movzx	eax, al
		mov	[ebp+var_4], eax

loc_407997:				; CODE XREF: sub_40794E+29j
					; sub_40794E+2Fj
		mov	eax, [ebp+var_4]
		leave
		retn
sub_40794E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40799C(int, int, int,	size_t)
sub_40799C	proc near		; CODE XREF: sub_40831E+2BBp
					; .text:00409BA5p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_4079C9
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4064AC
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_4079D4
		jmp	loc_407ABC
; ---------------------------------------------------------------------------

loc_4079C9:				; CODE XREF: sub_40799C+12j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_406645

loc_4079D4:				; CODE XREF: sub_40799C+26j
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4078F4
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		and	eax, 1
		test	al, al
		jz	short loc_407A2F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFFEh
		mov	[eax+250h], dl
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_40557D
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0

loc_407A2F:				; CODE XREF: sub_40799C+65j
		cmp	[ebp+arg_8], 4
		jnz	short loc_407A41
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+4], 0
		jmp	short loc_407AA6
; ---------------------------------------------------------------------------

loc_407A41:				; CODE XREF: sub_40799C+97j
		cmp	[ebp+arg_4], 0
		jz	short loc_407A4F
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		jmp	short loc_407A79
; ---------------------------------------------------------------------------

loc_407A4F:				; CODE XREF: sub_40799C+A9j
		cmp	[ebp+arg_C], 0
		jnz	short loc_407A5C
		mov	[ebp+arg_C], 200h

loc_407A5C:				; CODE XREF: sub_40799C+B7j
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_28], eax ;	size_t
		call	sub_405533
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_407A79
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	short loc_407ABC
; ---------------------------------------------------------------------------

loc_407A79:				; CODE XREF: sub_40799C+B1j
					; sub_40799C+D2j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_C]
		mov	[eax+4], edx
		cmp	[ebp+arg_4], 0
		jnz	short loc_407AA6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		or	edx, 1
		mov	[eax+250h], dl

loc_407AA6:				; CODE XREF: sub_40799C+A3j
					; sub_40799C+F2j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_8]
		mov	[eax+244h], edx
		mov	[ebp+var_C], 0

loc_407ABC:				; CODE XREF: sub_40799C+28j
					; sub_40799C+DBj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40799C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407AC1	proc near		; CODE XREF: .text:00408C17p
					; .text:00408C66p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	ecx, [eax+228h]
		mov	ebx, [eax+22Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	edx, 0
		add	eax, ecx
		adc	edx, ebx
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, 0
		cmp	edx, [ebp+var_C]
		jl	short loc_407B19
		cmp	edx, [ebp+var_C]
		jg	short loc_407B09
		cmp	eax, [ebp+var_10]
		jbe	short loc_407B19

loc_407B09:				; CODE XREF: sub_407AC1+41j
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		jmp	short loc_407B2A
; ---------------------------------------------------------------------------

loc_407B19:				; CODE XREF: sub_407AC1+3Cj
					; sub_407AC1+46j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, 0
		sub	[ebp+var_10], eax
		sbb	[ebp+var_C], edx

loc_407B2A:				; CODE XREF: sub_407AC1+56j
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_407AC1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407B36	proc near		; CODE XREF: .text:00409C6Bp
					; .text:00409CB5p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_8], 0
		jz	short loc_407B50
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [eax+218h]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_407B50:				; CODE XREF: sub_407B36+7j
		cmp	[ebp+arg_4], 0
		jz	short loc_407B65
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_4]
		mov	[eax+218h], edx

loc_407B65:				; CODE XREF: sub_407B36+1Ej
		pop	ebp
		retn
sub_407B36	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407B67	proc near		; CODE XREF: sub_4088BD+Cp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+248h]
		pop	ebp
		retn
sub_407B67	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407B78	proc near		; CODE XREF: sub_4054EC+30p

var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_405721
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_407B78	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_407B8B(char *, int)
sub_407B8B	proc near		; CODE XREF: sub_402F43+79p
					; sub_403264+32Ap ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_14]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		call	sub_4062D1
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_407C7B
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_50], eax
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_54], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	sub_40621C
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_407C7E
		mov	[ebp+var_C], 1
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_38], 0
		mov	[esp+58h+var_3C], ecx
		mov	ecx, off_419150
		mov	[esp+58h+var_4C], ecx
		mov	ecx, off_419154
		mov	[esp+58h+var_48], ecx
		mov	ecx, off_419158
		mov	[esp+58h+var_44], ecx
		mov	ecx, off_41915C
		mov	[esp+58h+var_40], ecx
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+var_54], eax
		lea	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	sub_406974
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_407C81
		mov	eax, [ebp+var_18]
		test	eax, eax
		jz	short loc_407C82
		cmp	[ebp+arg_0], 0
		jz	short loc_407C82
		mov	eax, [ebp+var_18]
		mov	[esp+58h+var_50], 1 ; int
		mov	edx, [ebp+arg_0]
		mov	[esp+58h+var_54], edx ;	char *
		mov	[esp+58h+var_58], eax ;	int
		call	sub_409CD3
		jmp	short loc_407C82
; ---------------------------------------------------------------------------

loc_407C7B:				; CODE XREF: sub_407B8B+34j
		nop
		jmp	short loc_407C82
; ---------------------------------------------------------------------------

loc_407C7E:				; CODE XREF: sub_407B8B+61j
		nop
		jmp	short loc_407C82
; ---------------------------------------------------------------------------

loc_407C81:				; CODE XREF: sub_407B8B+C5j
		nop

loc_407C82:				; CODE XREF: sub_407B8B+CCj
					; sub_407B8B+D2j ...
		cmp	[ebp+var_10], 0
		jz	short loc_407C9C
		cmp	[ebp+var_C], 0
		jz	short loc_407C9C
		mov	edx, off_41915C
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	edx ; sub_405F9A

loc_407C9C:				; CODE XREF: sub_407B8B+FBj
					; sub_407B8B+101j
		mov	eax, [ebp+var_18]
		leave
		retn
sub_407B8B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-0Ch], 0
		lea	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp+20h]
		mov	[esp], eax
		call	sub_4062D1
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	loc_407D8D
		mov	edx, [ebp-14h]
		lea	eax, [ebp-1Ch]
		mov	dword ptr [esp+24h], 0
		mov	[esp+20h], edx
		mov	edx, [ebp+1Ch]
		mov	[esp+1Ch], edx
		mov	edx, [ebp+18h]
		mov	[esp+18h], edx
		mov	edx, [ebp+14h]
		mov	[esp+14h], edx
		mov	dword ptr [esp+10h], 200h
		mov	edx, [ebp+10h]
		mov	[esp+0Ch], edx
		mov	edx, [ebp+0Ch]
		mov	[esp+8], edx
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_40574D
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_407D90
		mov	dword ptr [ebp-0Ch], 1
		mov	edx, [ebp-14h]
		mov	eax, [ebp-1Ch]
		mov	dword ptr [esp+20h], 0
		mov	[esp+1Ch], edx
		mov	edx, off_419140
		mov	[esp+0Ch], edx
		mov	edx, off_419144
		mov	[esp+10h], edx
		mov	edx, off_419148
		mov	[esp+14h], edx
		mov	edx, off_41914C
		mov	[esp+18h], edx
		mov	dword ptr [esp+8], 0FFFFFFFFh
		mov	[esp+4], eax
		lea	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_406974
		mov	[ebp-10h], eax
		jmp	short loc_407D91
; ---------------------------------------------------------------------------

loc_407D8D:				; CODE XREF: .text:00407CD5j
		nop
		jmp	short loc_407D91
; ---------------------------------------------------------------------------

loc_407D90:				; CODE XREF: .text:00407D2Ej
		nop

loc_407D91:				; CODE XREF: .text:00407D8Bj
					; .text:00407D8Ej
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_407DAB
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_407DAB
		mov	edx, off_41914C
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	edx ; sub_405DC0

loc_407DAB:				; CODE XREF: .text:00407D95j
					; .text:00407D9Bj
		mov	eax, [ebp-18h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_407DB0	proc near		; CODE XREF: .text:00407EEFp

var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		lea	eax, [ebp+var_C]
		mov	[esp+48h+var_44], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+var_48], eax
		call	sub_4062D1
		test	eax, eax
		jz	short loc_407DE4
		mov	eax, 0
		jmp	locret_407EC6
; ---------------------------------------------------------------------------

loc_407DE4:				; CODE XREF: sub_407DB0+28j
		mov	eax, [ebp+var_C]
		or	eax, 2
		mov	[ebp+var_C], eax
		mov	edx, [ebp+var_C]
		lea	eax, [ebp+var_14]
		mov	ecx, [ebp+arg_0]
		mov	[esp+48h+var_24], ecx
		mov	[esp+48h+var_28], edx
		mov	[esp+48h+var_2C], offset sub_40557D
		mov	[esp+48h+var_30], offset sub_405550
		mov	[esp+48h+var_34], 1
		mov	[esp+48h+var_38], 200h
		mov	[esp+48h+var_3C], 0
		mov	[esp+48h+var_40], 0
		mov	[esp+48h+var_44], 0
		mov	[esp+48h+var_48], eax
		call	sub_40574D
		test	eax, eax
		jz	short loc_407E49
		mov	eax, 0
		jmp	short locret_407EC6
; ---------------------------------------------------------------------------

loc_407E49:				; CODE XREF: sub_407DB0+90j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_28], 0
		mov	[esp+48h+var_2C], edx
		mov	edx, off_419140
		mov	[esp+48h+var_3C], edx
		mov	edx, off_419144
		mov	[esp+48h+var_38], edx
		mov	edx, off_419148
		mov	[esp+48h+var_34], edx
		mov	edx, off_41914C
		mov	[esp+48h+var_30], edx
		mov	[esp+48h+var_40], 0FFFFFFFFh
		mov	[esp+48h+var_44], eax
		lea	eax, [ebp+var_10]
		mov	[esp+48h+var_48], eax
		call	sub_406974
		test	eax, eax
		jz	short loc_407EAC
		mov	edx, off_41914C
		mov	eax, [ebp+var_14]
		mov	[esp+48h+var_48], eax
		call	edx ; sub_405DC0

loc_407EAC:				; CODE XREF: sub_407DB0+ECj
		mov	eax, [ebp+var_10]
		test	eax, eax
		jz	short loc_407EC3
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+23Ch], offset sub_405D58

loc_407EC3:				; CODE XREF: sub_407DB0+101j
		mov	eax, [ebp+var_10]

locret_407EC6:				; CODE XREF: sub_407DB0+2Fj
					; sub_407DB0+97j
		leave
		retn
sub_407DB0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_407EE2
		mov	eax, [ebp+8]
		cmp	eax, [ebp+14h]
		jnb	short loc_407EE2
		mov	eax, [ebp+14h]
		mov	[ebp+8], eax

loc_407EE2:				; CODE XREF: .text:00407ED2j
					; .text:00407EDAj
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407DB0
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	loc_407FAC
		cmp	dword ptr [ebp+10h], 0
		jz	loc_407FAC
		cmp	dword ptr [ebp+14h], 0
		jz	loc_407FAC
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp+14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_4072A4
		test	eax, eax
		jz	short loc_407F66
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_4087A2
		mov	dword ptr [ebp-0Ch], 0
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	edx, [ebp-10h]
		mov	[eax], edx
		jmp	short loc_407FAC
; ---------------------------------------------------------------------------

loc_407F66:				; CODE XREF: .text:00407F38j
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_406EB6
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp-0Ch]
		mov	[esp], eax
		call	sub_4078F4

loc_407FAC:				; CODE XREF: .text:00407EFBj
					; .text:00407F05j ...
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-10h], 0
		lea	eax, [ebp-10h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_4062D1
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_40802E
		mov	eax, [ebp-10h]
		mov	dword ptr [esp+20h], 0
		mov	[esp+1Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+14h]
		mov	[esp+10h], eax
		mov	eax, [ebp+18h]
		mov	[esp+14h], eax
		mov	eax, [ebp+1Ch]
		mov	[esp+18h], eax
		mov	dword ptr [esp+8], 0FFFFFFFFh
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_406974
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jmp	short loc_40802F
; ---------------------------------------------------------------------------

loc_40802E:				; CODE XREF: .text:00407FDEj
		nop

loc_40802F:				; CODE XREF: .text:0040802Cj
		mov	eax, [ebp-14h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408034	proc near		; CODE XREF: .text:00408138p
					; .text:00408162p ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_14]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		call	sub_4062D1
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_4080F2
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_54], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	sub_405DF5
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_4080F5
		mov	[ebp+var_C], 1
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_1C]
		mov	ecx, [ebp+arg_C]
		mov	[esp+58h+var_38], ecx
		mov	[esp+58h+var_3C], edx
		mov	edx, off_419150
		mov	[esp+58h+var_4C], edx
		mov	edx, off_419154
		mov	[esp+58h+var_48], edx
		mov	edx, off_419158
		mov	[esp+58h+var_44], edx
		mov	edx, off_41915C
		mov	[esp+58h+var_40], edx
		mov	edx, [ebp+arg_0]
		mov	[esp+58h+var_50], edx
		mov	[esp+58h+var_54], eax
		lea	eax, [ebp+var_18]
		mov	[esp+58h+var_58], eax
		call	sub_406974
		mov	[ebp+var_10], eax
		jmp	short loc_4080F6
; ---------------------------------------------------------------------------

loc_4080F2:				; CODE XREF: sub_408034+34j
		nop
		jmp	short loc_4080F6
; ---------------------------------------------------------------------------

loc_4080F5:				; CODE XREF: sub_408034+61j
		nop

loc_4080F6:				; CODE XREF: sub_408034+BCj
					; sub_408034+BFj
		cmp	[ebp+var_10], 0
		jz	short loc_408110
		cmp	[ebp+var_C], 0
		jz	short loc_408110
		mov	edx, off_41915C
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_58], eax
		call	edx ; sub_405F9A

loc_408110:				; CODE XREF: sub_408034+C6j
					; sub_408034+CCj
		mov	eax, [ebp+var_18]
		leave
		retn
sub_408034	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408034
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408034
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_408169(FILE *, int, int, int)
sub_408169	proc near		; CODE XREF: .text:00408298p
					; .text:004082C2p ...

File		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 54h
		mov	[ebp+var_18], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_C], 0
		lea	eax, [ebp+var_14]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+File],	eax
		call	sub_4062D1
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_40824E
		cmp	[ebp+arg_0], 0
		jz	short loc_4081B5
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+File],	eax ; File
		call	fflush

loc_4081B5:				; CODE XREF: sub_408169+3Fj
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx ;	int
		mov	[esp+58h+var_50], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_54], eax ;	FILE *
		lea	eax, [ebp+var_1C]
		mov	[esp+58h+File],	eax ; int
		call	sub_405FF9
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_408251
		mov	[ebp+var_C], 1
		mov	ebx, [ebp+var_14]
		cmp	[ebp+arg_0], 0
		jz	short loc_4081FB
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+File],	eax ; File
		call	_fileno
		jmp	short loc_408200
; ---------------------------------------------------------------------------

loc_4081FB:				; CODE XREF: sub_408169+83j
		mov	eax, 0FFFFFFFFh

loc_408200:				; CODE XREF: sub_408169+90j
		mov	edx, [ebp+var_1C]
		mov	ecx, [ebp+arg_C]
		mov	[esp+58h+var_38], ecx
		mov	[esp+58h+var_3C], ebx
		mov	ecx, off_419160
		mov	[esp+58h+var_4C], ecx
		mov	ecx, off_419164
		mov	[esp+58h+var_48], ecx
		mov	ecx, off_419168
		mov	[esp+58h+var_44], ecx
		mov	ecx, off_41916C
		mov	[esp+58h+var_40], ecx
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+var_54], edx
		lea	eax, [ebp+var_18]
		mov	[esp+58h+File],	eax
		call	sub_406974
		mov	[ebp+var_10], eax
		jmp	short loc_408252
; ---------------------------------------------------------------------------

loc_40824E:				; CODE XREF: sub_408169+35j
		nop
		jmp	short loc_408252
; ---------------------------------------------------------------------------

loc_408251:				; CODE XREF: sub_408169+73j
		nop

loc_408252:				; CODE XREF: sub_408169+E3j
					; sub_408169+E6j
		cmp	[ebp+var_10], 0
		jz	short loc_40826C
		cmp	[ebp+var_C], 0
		jz	short loc_40826C
		mov	edx, off_41916C
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+File],	eax
		call	edx ; sub_4061B1

loc_40826C:				; CODE XREF: sub_408169+EDj
					; sub_408169+F3j
		mov	eax, [ebp+var_18]
		add	esp, 54h
		pop	ebx
		pop	ebp
		retn
sub_408169	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408169
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408169
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, ds:dword_41D0B0
		mov	[esp], eax
		call	sub_405524
		cmp	dword ptr [ebp+8], 0
		js	short loc_40830F
		cmp	dword ptr [ebp+8], 2
		jg	short loc_40830F
		mov	eax, [ebp+8]
		add	eax, offset byte_41D0C0
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40830F
		mov	eax, [ebp+8]
		mov	edx, [ebp+0Ch]
		mov	ds:dword_41D0B4[eax*4],	edx
		mov	eax, [ebp+8]
		add	eax, offset byte_41D0C0
		mov	byte ptr [eax],	1

loc_40830F:				; CODE XREF: .text:004082E0j
					; .text:004082E6j ...
		mov	eax, ds:dword_41D0B0
		mov	[esp], eax
		call	sub_405524
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40831E	proc near		; CODE XREF: sub_402192+13Dp
					; sub_403264+3Ap ...

File		= dword	ptr -28h
Format		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	ecx, [ebp+arg_0]
		mov	edx, 55555556h
		mov	eax, ecx
		imul	edx
		mov	eax, ecx
		sar	eax, 1Fh
		sub	edx, eax
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		mov	[ebp+arg_0], eax
		mov	eax, ds:dword_41D0B0
		mov	[esp+28h+File],	eax
		call	sub_405524
		mov	eax, ds:dword_41D0AC
		mov	[ebp+var_C], eax
		jmp	short loc_4083AA
; ---------------------------------------------------------------------------

loc_408364:				; CODE XREF: sub_40831E+90j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		and	eax, 2
		test	al, al
		jz	short loc_4083A1
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		shr	al, 2
		and	eax, 3
		movzx	eax, al
		cmp	eax, [ebp+arg_0]
		jnz	short loc_4083A1
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		jmp	short loc_4083B0
; ---------------------------------------------------------------------------

loc_4083A1:				; CODE XREF: sub_40831E+5Aj
					; sub_40831E+77j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	[ebp+var_C], eax

loc_4083AA:				; CODE XREF: sub_40831E+44j
		cmp	[ebp+var_C], 0
		jnz	short loc_408364

loc_4083B0:				; CODE XREF: sub_40831E+81j
		cmp	[ebp+var_10], 0
		jnz	loc_408614
		cmp	[ebp+arg_0], 0
		jnz	short loc_4083F5
		movzx	eax, ds:byte_41D0C0
		test	al, al
		jz	short loc_4083F5
		mov	eax, ds:dword_41D0B4
		mov	[esp+28h+var_1C], 1
		mov	[esp+28h+var_20], 1
		mov	[esp+28h+Format], offset aR ; "r"
		mov	[esp+28h+File],	eax
		call	sub_408034
		mov	[ebp+var_10], eax
		jmp	short loc_408463
; ---------------------------------------------------------------------------

loc_4083F5:				; CODE XREF: sub_40831E+A0j
					; sub_40831E+ABj
		cmp	[ebp+arg_0], 1
		jnz	short loc_408430
		movzx	eax, ds:byte_41D0C1
		test	al, al
		jz	short loc_408430
		mov	eax, ds:dword_41D0B8
		mov	[esp+28h+var_1C], 1
		mov	[esp+28h+var_20], 1
		mov	[esp+28h+Format], offset aA ; "a"
		mov	[esp+28h+File],	eax
		call	sub_408034
		mov	[ebp+var_10], eax
		jmp	short loc_408463
; ---------------------------------------------------------------------------

loc_408430:				; CODE XREF: sub_40831E+DBj
					; sub_40831E+E6j
		movzx	eax, ds:byte_41D0C2
		test	al, al
		jz	short loc_408463
		mov	eax, ds:dword_41D0BC
		mov	[esp+28h+var_1C], 1
		mov	[esp+28h+var_20], 1
		mov	[esp+28h+Format], offset aA ; "a"
		mov	[esp+28h+File],	eax
		call	sub_408034
		mov	[ebp+var_10], eax

loc_408463:				; CODE XREF: sub_40831E+D5j
					; sub_40831E+110j ...
		cmp	[ebp+var_10], 0
		jnz	loc_4084FB
		cmp	[ebp+arg_0], 0
		jnz	short loc_40849D
		mov	eax, ds:_iob
		mov	[esp+28h+var_1C], 1 ; int
		mov	[esp+28h+var_20], 1 ; int
		mov	[esp+28h+Format], offset aR ; "r"
		mov	[esp+28h+File],	eax ; FILE *
		call	sub_408169
		mov	[ebp+var_10], eax
		jmp	short loc_4084FB
; ---------------------------------------------------------------------------

loc_40849D:				; CODE XREF: sub_40831E+153j
		cmp	[ebp+arg_0], 1
		jnz	short loc_4084D0
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+var_1C], 1 ; int
		mov	[esp+28h+var_20], 1 ; int
		mov	[esp+28h+Format], offset aA ; "a"
		mov	[esp+28h+File],	eax ; FILE *
		call	sub_408169
		mov	[ebp+var_10], eax
		jmp	short loc_4084FB
; ---------------------------------------------------------------------------

loc_4084D0:				; CODE XREF: sub_40831E+183j
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+28h+var_1C], 1 ; int
		mov	[esp+28h+var_20], 1 ; int
		mov	[esp+28h+Format], offset aA ; "a"
		mov	[esp+28h+File],	eax ; FILE *
		call	sub_408169
		mov	[ebp+var_10], eax

loc_4084FB:				; CODE XREF: sub_40831E+149j
					; sub_40831E+17Dj ...
		cmp	[ebp+var_10], 0
		jnz	short loc_408577
		cmp	[ebp+arg_0], 0
		jz	short loc_40850E
		mov	eax, offset aA	; "a"
		jmp	short loc_408513
; ---------------------------------------------------------------------------

loc_40850E:				; CODE XREF: sub_40831E+1E7j
		mov	eax, offset aR	; "r"

loc_408513:				; CODE XREF: sub_40831E+1EEj
		mov	[esp+28h+var_1C], 1 ; int
		mov	[esp+28h+var_20], 0 ; int
		mov	[esp+28h+Format], eax ;	int
		mov	[esp+28h+File],	0 ; FILE *
		call	sub_408169
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_408577
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset Format ; "fatal: error creating a dummy estream f"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_20], eax
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		call	abort
; ---------------------------------------------------------------------------

loc_408577:				; CODE XREF: sub_40831E+1E1j
					; sub_40831E+21Cj
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		or	edx, 2
		mov	[eax+250h], dl
		mov	eax, [ebp+var_10]
		mov	eax, [eax+24h]
		mov	edx, [ebp+arg_0]
		and	edx, 3
		and	edx, 3
		lea	ecx, ds:0[edx*4]
		movzx	edx, byte ptr [eax+250h]
		and	edx, 0FFFFFFF3h
		or	edx, ecx
		mov	[eax+250h], dl
		cmp	[ebp+arg_0], 2
		jnz	short loc_4085DE
		mov	[esp+28h+var_1C], 0 ; size_t
		mov	[esp+28h+var_20], 40h ;	int
		mov	[esp+28h+Format], 0 ; int
		mov	eax, [ebp+var_10]
		mov	[esp+28h+File],	eax ; int
		call	sub_40799C

loc_4085DE:				; CODE XREF: sub_40831E+29Bj
		cmp	[ebp+arg_0], 0
		jz	short loc_4085F8
		cmp	[ebp+arg_0], 1
		jnz	short loc_4085F1
		mov	eax, offset aStdout ; "[stdout]"
		jmp	short loc_4085F6
; ---------------------------------------------------------------------------

loc_4085F1:				; CODE XREF: sub_40831E+2CAj
		mov	eax, offset aStderr ; "[stderr]"

loc_4085F6:				; CODE XREF: sub_40831E+2D1j
		jmp	short loc_4085FD
; ---------------------------------------------------------------------------

loc_4085F8:				; CODE XREF: sub_40831E+2C4j
		mov	eax, offset aStdin_0 ; "[stdin]"

loc_4085FD:				; CODE XREF: sub_40831E:loc_4085F6j
		mov	[esp+28h+var_20], 0 ; int
		mov	[esp+28h+Format], eax ;	char *
		mov	eax, [ebp+var_10]
		mov	[esp+28h+File],	eax ; int
		call	sub_409CD3

loc_408614:				; CODE XREF: sub_40831E+96j
		mov	eax, ds:dword_41D0B0
		mov	[esp+28h+File],	eax
		call	sub_405524
		mov	eax, [ebp+var_10]
		leave
		retn
sub_40831E	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		cmp	dword ptr [ebp+8], 0
		jz	loc_40876B
		mov	dword ptr [ebp-18h], 0
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_406870
		lea	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_4062D1
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4086F8
		mov	eax, [ebp-14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		lea	eax, [ebp-1Ch]
		mov	[esp+4], eax
		lea	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_40621C
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4086FB
		mov	dword ptr [ebp-10h], 1
		mov	ecx, [ebp-14h]
		mov	edx, [ebp-1Ch]
		mov	eax, [ebp-18h]
		mov	[esp+1Ch], ecx
		mov	ecx, off_419150
		mov	[esp+0Ch], ecx
		mov	ecx, off_419154
		mov	[esp+10h], ecx
		mov	ecx, off_419158
		mov	[esp+14h], ecx
		mov	ecx, off_41915C
		mov	[esp+18h], ecx
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_406695
		jmp	short loc_4086FC
; ---------------------------------------------------------------------------

loc_4086F8:				; CODE XREF: .text:0040867Cj
		nop
		jmp	short loc_4086FC
; ---------------------------------------------------------------------------

loc_4086FB:				; CODE XREF: .text:004086A5j
		nop

loc_4086FC:				; CODE XREF: .text:004086F6j
					; .text:004086F9j
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40872F
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_408713
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_405F9A

loc_408713:				; CODE XREF: .text:00408706j
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_406A9B
		mov	dword ptr [ebp+10h], 0
		jmp	short loc_40879D
; ---------------------------------------------------------------------------

loc_40872F:				; CODE XREF: .text:00408700j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_408755
		cmp	dword ptr [ebp+8], 0
		jz	short loc_408755
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_409CD3

loc_408755:				; CODE XREF: .text:00408733j
					; .text:00408739j
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		jmp	short loc_40879D
; ---------------------------------------------------------------------------

loc_40876B:				; CODE XREF: .text:00408630j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_406870
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_406A9B
		mov	dword ptr [ebp+10h], 0

loc_40879D:				; CODE XREF: .text:0040872Dj
					; .text:00408769j
		mov	eax, [ebp+10h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4087A2(void *)
sub_4087A2	proc near		; CODE XREF: sub_402F43+26Fp
					; sub_402F43+27Cp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_24], 0 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_406A9B
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4087A2	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+0Ch], 0
		jz	loc_40887A
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+23Ch]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40880A
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 28h
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jmp	loc_408896
; ---------------------------------------------------------------------------

loc_40880A:				; CODE XREF: .text:004087EFj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_408839
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4064AC
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_408892
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax+20h]
		and	edx, 0FFFFFFFEh
		mov	[eax+20h], dl

loc_408839:				; CODE XREF: .text:00408816j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+214h]
		lea	edx, [ebp-14h]
		mov	[esp+0Ch], edx
		mov	edx, [ebp+0Ch]
		mov	[esp+8], edx
		mov	dword ptr [esp+4], 1
		mov	[esp], eax
		mov	eax, [ebp-10h]
		call	eax
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_408895
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_40887A
		mov	edx, [ebp-14h]
		mov	eax, [ebp+10h]
		mov	[eax], edx

loc_40887A:				; CODE XREF: .text:004087CDj
					; .text:00408870j
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406A9B
		mov	[ebp-0Ch], eax
		jmp	short loc_408896
; ---------------------------------------------------------------------------

loc_408892:				; CODE XREF: .text:0040882Aj
		nop
		jmp	short loc_408896
; ---------------------------------------------------------------------------

loc_408895:				; CODE XREF: .text:0040886Aj
		nop

loc_408896:				; CODE XREF: .text:00408805j
					; .text:00408890j ...
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_4088B8
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_4088B8
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[esp], eax
		call	sub_40557D
		mov	eax, [ebp+0Ch]
		mov	dword ptr [eax], 0

loc_4088B8:				; CODE XREF: .text:0040889Aj
					; .text:004088A0j
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4088BD	proc near		; CODE XREF: sub_408924+20p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		mov	[esp+4+var_4], eax
		call	sub_407B67
		leave
		retn
sub_4088BD	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405529
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408924	proc near		; CODE XREF: sub_403264+42p
					; sub_403264+3A3p ...

var_14		= dword	ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+14h+var_14], eax
		call	sub_405524
		mov	eax, [ebp+arg_0]
		mov	[esp+14h+var_14], eax
		call	sub_4088BD
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+14h+var_14], eax
		call	sub_405524
		mov	eax, [ebp+var_4]
		leave
		retn
sub_408924	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408965	proc near		; CODE XREF: .text:004089A8p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	[esp+0Ch+var_4], 1
		mov	[esp+0Ch+var_8], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_40794E
		leave
		retn
sub_408965	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408965
		mov	[ebp-4], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4089C9	proc near		; CODE XREF: sub_4089EC+20p
					; sub_409E92+3B4p ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	[esp+0Ch+var_4], 0
		mov	[esp+0Ch+var_8], 1
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_40794E
		leave
		retn
sub_4089C9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4089EC	proc near		; CODE XREF: sub_401AD2+43p
					; sub_403264+F6p

var_14		= dword	ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+14h+var_14], eax
		call	sub_405524
		mov	eax, [ebp+arg_0]
		mov	[esp+14h+var_14], eax
		call	sub_4089C9
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+14h+var_14], eax
		call	sub_405524
		mov	eax, [ebp+var_4]
		leave
		retn
sub_4089EC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408A2D	proc near		; CODE XREF: .text:00408A70p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	[esp+0Ch+var_4], 0
		mov	[esp+0Ch+var_8], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+0Ch+var_C], eax
		call	sub_4078F4
		leave
		retn
sub_408A2D	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408A2D
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408A8B	proc near		; CODE XREF: sub_408AC6+26p
					; DATA XREF: sub_408AC6:loc_408B0Ao

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_408AAF
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4064AC
		mov	[ebp+var_C], eax
		jmp	short loc_408AC1
; ---------------------------------------------------------------------------

loc_408AAF:				; CODE XREF: sub_408A8B+12j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_406645
		mov	[ebp+var_C], 0

loc_408AC1:				; CODE XREF: sub_408A8B+22j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_408A8B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408AC6	proc near		; CODE XREF: sub_403264+429p
					; sub_405703+Dp

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_408B0A
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_405524
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_408A8B
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_405524
		jmp	short loc_408B19
; ---------------------------------------------------------------------------

loc_408B0A:				; CODE XREF: sub_408AC6+Aj
		mov	[esp+28h+var_28], offset sub_408A8B
		call	sub_4056AE
		mov	[ebp+var_C], eax

loc_408B19:				; CODE XREF: sub_408AC6+42j
		cmp	[ebp+var_C], 0
		jz	short loc_408B26
		mov	eax, 0FFFFFFFFh
		jmp	short locret_408B2B
; ---------------------------------------------------------------------------

loc_408B26:				; CODE XREF: sub_408AC6+57j
		mov	eax, 0

locret_408B2B:				; CODE XREF: sub_408AC6+5Ej
		leave
		retn
sub_408AC6	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, [ebp+0Ch]
		mov	edx, eax
		sar	edx, 1Fh
		mov	dword ptr [esp+10h], 0
		mov	ecx, [ebp+10h]
		mov	[esp+0Ch], ecx
		mov	[esp+4], eax
		mov	[esp+8], edx
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406EB6
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+0Ch]
		mov	[ebp-20h], eax
		mov	eax, [ebp+10h]
		mov	[ebp-1Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	dword ptr [esp+10h], 0
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp-20h]
		mov	edx, [ebp-1Ch]
		mov	[esp+4], eax
		mov	[esp+8], edx
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406EB6
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407AC1
		mov	[ebp-4], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [ebp-8], 0FFFFFFFFh
		mov	dword ptr [ebp-4], 0FFFFFFFFh
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407AC1
		mov	[ebp-8], eax
		mov	[ebp-4], edx
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, [ebp-8]
		mov	edx, [ebp-4]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	dword ptr [esp+10h], 0
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_406EB6
		mov	dword ptr [esp+8], 0FFFFFFFFh
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4078F4
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408D03	proc near		; CODE XREF: sub_408D8D+67p
					; .text:00409167p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_D]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], 1
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_406CC3
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_408D43
		mov	eax, [ebp+var_14]
		test	eax, eax
		jz	short loc_408D43
		movzx	eax, [ebp+var_D]
		movzx	eax, al
		jmp	short locret_408D48
; ---------------------------------------------------------------------------

loc_408D43:				; CODE XREF: sub_408D03+2Ej
					; sub_408D03+35j
		mov	eax, 0FFFFFFFFh

locret_408D48:				; CODE XREF: sub_408D03+3Ej
		leave
		retn
sub_408D03	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408D4A	proc near		; CODE XREF: .text:00408E84p
					; sub_409E92+BBp ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_D], al
		lea	eax, [ebp+var_D]
		mov	[esp+28h+var_1C], 0
		mov	[esp+28h+var_20], 1
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_28], eax
		call	sub_4072A4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_408D86
		mov	eax, [ebp+arg_0]
		jmp	short locret_408D8B
; ---------------------------------------------------------------------------

loc_408D86:				; CODE XREF: sub_408D4A+35j
		mov	eax, 0FFFFFFFFh

locret_408D8B:				; CODE XREF: sub_408D4A+3Aj
		leave
		retn
sub_408D4A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408D8D	proc near		; CODE XREF: sub_403264+D9p

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_405524
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_408DEE
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_408DEE
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_408DEE
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+arg_0]
		mov	[edx+0Ch], ecx
		jmp	short loc_408DF9
; ---------------------------------------------------------------------------

loc_408DEE:				; CODE XREF: sub_408D8D+26j
					; sub_408D8D+36j ...
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_408D03

loc_408DF9:				; CODE XREF: sub_408D8D+5Fj
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_405524
		mov	eax, [ebp+var_C]
		leave
		retn
sub_408D8D	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_408E77
		mov	eax, [ebp+0Ch]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_408E77
		cmp	dword ptr [ebp+8], 0Ah
		jz	short loc_408E77
		mov	eax, [ebp+0Ch]
		mov	ecx, [eax]
		mov	eax, [ebp+0Ch]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		mov	ecx, [ebp+8]
		mov	[eax], cl
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+0Ch]
		mov	[edx+0Ch], ecx
		jmp	short loc_408E89
; ---------------------------------------------------------------------------

loc_408E77:				; CODE XREF: .text:00408E3Bj
					; .text:00408E4Bj ...
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408D4A

loc_408E89:				; CODE XREF: .text:00408E75j
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-9], al
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		lea	eax, [ebp-9]
		lea	edx, [ebp-10h]
		mov	[esp+0Ch], edx
		mov	dword ptr [esp+8], 1
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_406E27
		mov	eax, [ebp+0Ch]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, [ebp-10h]
		test	eax, eax
		jz	short loc_408F06
		mov	eax, [ebp+8]
		jmp	short locret_408F0B
; ---------------------------------------------------------------------------

loc_408F06:				; CODE XREF: .text:00408EFFj
		mov	eax, 0FFFFFFFFh

locret_408F0B:				; CODE XREF: .text:00408F04j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408F0D	proc near		; CODE XREF: sub_4074CE+2CFp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jz	short loc_408F66
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_405524
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_406CC3
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_405524
		jmp	short loc_408F6D
; ---------------------------------------------------------------------------

loc_408F66:				; CODE XREF: sub_408F0D+Aj
		mov	[ebp+var_C], 0

loc_408F6D:				; CODE XREF: sub_408F0D+57j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_408F0D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408F72	proc near		; CODE XREF: sub_4074CE+194p
					; sub_4074CE+1E0p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jz	short loc_408FCB
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_405524
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_4072A4
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_405524
		jmp	short loc_408FD2
; ---------------------------------------------------------------------------

loc_408FCB:				; CODE XREF: sub_408F72+Aj
		mov	[ebp+var_C], 0

loc_408FD2:				; CODE XREF: sub_408F72+57j
		mov	eax, [ebp+var_C]
		leave
		retn
sub_408F72	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_408FD7	proc near		; CODE XREF: sub_401AD2+24p
					; sub_402F43+173p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		imul	eax, [ebp+arg_8]
		test	eax, eax
		jz	short loc_409044
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_405524
		mov	eax, [ebp+arg_4]
		imul	eax, [ebp+arg_8]
		lea	edx, [ebp+var_10]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_28], eax
		call	sub_406CC3
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_405524
		mov	eax, [ebp+var_10]
		mov	edx, 0
		div	[ebp+arg_4]
		mov	[ebp+var_C], eax
		jmp	short loc_40904B
; ---------------------------------------------------------------------------

loc_409044:				; CODE XREF: sub_408FD7+Fj
		mov	[ebp+var_C], 0

loc_40904B:				; CODE XREF: sub_408FD7+6Bj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_408FD7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409050	proc near		; CODE XREF: sub_401B80+24p
					; sub_4037A4+171p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		imul	eax, [ebp+arg_8]
		test	eax, eax
		jz	short loc_4090BD
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_405524
		mov	eax, [ebp+arg_4]
		imul	eax, [ebp+arg_8]
		lea	edx, [ebp+var_10]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_28], eax
		call	sub_4072A4
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_405524
		mov	eax, [ebp+var_10]
		mov	edx, 0
		div	[ebp+arg_4]
		mov	[ebp+var_C], eax
		jmp	short loc_4090C4
; ---------------------------------------------------------------------------

loc_4090BD:				; CODE XREF: sub_409050+Fj
		mov	[ebp+var_C], 0

loc_4090C4:				; CODE XREF: sub_409050+6Bj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_409050	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp+0Ch], 0
		jnz	short loc_4090E5
		mov	eax, 0
		jmp	locret_4091C7
; ---------------------------------------------------------------------------

loc_4090E5:				; CODE XREF: .text:004090D9j
		mov	dword ptr [ebp-10h], 0FFFFFFFFh
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		jmp	short loc_409114
; ---------------------------------------------------------------------------

loc_409102:				; CODE XREF: .text:00409179j
		mov	eax, [ebp-10h]
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp+0Ch], 1

loc_409114:				; CODE XREF: .text:00409100j
		cmp	dword ptr [ebp+0Ch], 1
		jle	short loc_40917B
		mov	eax, [ebp+10h]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_409161
		mov	eax, [ebp+10h]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+10h]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_409161
		mov	eax, [ebp+10h]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_409161
		mov	eax, [ebp+10h]
		mov	ecx, [eax]
		mov	eax, [ebp+10h]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+10h]
		mov	[edx+0Ch], ecx
		jmp	short loc_40916C
; ---------------------------------------------------------------------------

loc_409161:				; CODE XREF: .text:00409126j
					; .text:00409136j ...
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_408D03

loc_40916C:				; CODE XREF: .text:0040915Fj
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jz	short loc_40917B
		cmp	dword ptr [ebp-10h], 0Ah
		jnz	short loc_409102

loc_40917B:				; CODE XREF: .text:00409118j
					; .text:00409173j
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_4091A4
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_4091A4
		mov	eax, 0
		jmp	short locret_4091C7
; ---------------------------------------------------------------------------

loc_4091A4:				; CODE XREF: .text:00409193j
					; .text:0040919Bj
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jz	short loc_4091BE
		cmp	dword ptr [ebp+0Ch], 1
		jle	short loc_4091BE
		mov	eax, [ebp-10h]
		mov	edx, eax
		mov	eax, [ebp-0Ch]
		mov	[eax], dl
		add	dword ptr [ebp-0Ch], 1

loc_4091BE:				; CODE XREF: .text:004091A8j
					; .text:004091AEj
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+8]

locret_4091C7:				; CODE XREF: .text:004090E0j
					; .text:004091A2j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp-0Ch], eax
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_4072A4
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_409223
		mov	eax, 0FFFFFFFFh
		jmp	short loc_409228
; ---------------------------------------------------------------------------

loc_409223:				; CODE XREF: .text:0040921Aj
		mov	eax, 0

loc_409228:				; CODE XREF: .text:00409221j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40922E	proc near		; CODE XREF: .text:0040A50Ep

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+38h+var_38], eax
		call	sub_405524
		mov	[esp+38h+var_2C], 0
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		call	sub_4072A4
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+38h+var_38], eax
		call	sub_405524
		cmp	[ebp+var_10], 0
		jz	short loc_4092B0
		mov	eax, 0FFFFFFFFh
		jmp	short loc_4092B5
; ---------------------------------------------------------------------------

loc_4092B0:				; CODE XREF: sub_40922E+79j
		mov	eax, 0

loc_4092B5:				; CODE XREF: sub_40922E+80j
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_40922E	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-14h], 0
		mov	dword ptr [ebp-18h], 0
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		lea	eax, [ebp-14h]
		lea	edx, [ebp-18h]
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+10h]
		mov	[esp], eax
		call	sub_4074CE
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		cmp	dword ptr [ebp-0Ch], 0
		jnz	loc_4093D7
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		test	eax, eax
		jz	loc_4093C3
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	edx, [ebp-18h]
		add	edx, 1
		cmp	eax, edx
		jnb	short loc_40937C
		mov	eax, [ebp-18h]
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_405550
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40936A
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jmp	short loc_40937C
; ---------------------------------------------------------------------------

loc_40936A:				; CODE XREF: .text:0040935Fj
		mov	eax, [ebp+8]
		mov	eax, [eax]
		cmp	eax, [ebp-10h]
		jz	short loc_40937C
		mov	edx, [ebp-10h]
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_40937C:				; CODE XREF: .text:0040933Fj
					; .text:00409368j ...
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4093B6
		mov	eax, [ebp-18h]
		lea	ecx, [eax+1]
		mov	eax, [ebp-14h]
		mov	edx, eax
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	memcpy
		mov	eax, [ebp+0Ch]
		mov	edx, [eax]
		mov	eax, [ebp-18h]
		cmp	edx, eax
		jz	short loc_4093B6
		mov	edx, [ebp-18h]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx

loc_4093B6:				; CODE XREF: .text:00409380j
					; .text:004093ACj
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_40557D
		jmp	short loc_4093D8
; ---------------------------------------------------------------------------

loc_4093C3:				; CODE XREF: .text:0040932Cj
		mov	eax, [ebp-14h]
		mov	edx, eax
		mov	eax, [ebp+8]
		mov	[eax], edx
		mov	edx, [ebp-18h]
		mov	eax, [ebp+0Ch]
		mov	[eax], edx
		jmp	short loc_4093D8
; ---------------------------------------------------------------------------

loc_4093D7:				; CODE XREF: .text:0040931Fj
		nop

loc_4093D8:				; CODE XREF: .text:004093C1j
					; .text:004093D5j
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4093E3
		mov	eax, [ebp-18h]
		jmp	short locret_4093E6
; ---------------------------------------------------------------------------

loc_4093E3:				; CODE XREF: .text:004093DCj
		mov	eax, [ebp-0Ch]

locret_4093E6:				; CODE XREF: .text:004093E1j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp+10h]
		mov	eax, [eax]
		mov	[ebp-14h], eax
		mov	dword ptr [ebp-18h], 0
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_409412
		mov	eax, [ebp+14h]
		mov	eax, [eax]
		jmp	short loc_409417
; ---------------------------------------------------------------------------

loc_409412:				; CODE XREF: .text:00409409j
		mov	eax, 0

loc_409417:				; CODE XREF: .text:00409410j
		mov	[ebp-20h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_40946D
		mov	dword ptr [ebp-14h], 100h
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_405533
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	edx, [ebp-10h]
		mov	[eax], edx
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_409465
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 0
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_40945B
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0

loc_40945B:				; CODE XREF: .text:00409450j
		mov	eax, 0FFFFFFFFh
		jmp	locret_4096A4
; ---------------------------------------------------------------------------

loc_409465:				; CODE XREF: .text:00409441j
		mov	eax, [ebp+10h]
		mov	edx, [ebp-14h]
		mov	[eax], edx

loc_40946D:				; CODE XREF: .text:0040941Ej
		cmp	dword ptr [ebp-14h], 3
		ja	short loc_40948A
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0FFFFFFFFh
		jmp	locret_4096A4
; ---------------------------------------------------------------------------

loc_40948A:				; CODE XREF: .text:00409471j
		sub	dword ptr [ebp-14h], 3
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, [ebp-10h]
		mov	[ebp-1Ch], eax
		jmp	loc_409622
; ---------------------------------------------------------------------------

loc_4094AD:				; CODE XREF: .text:0040967Bj
		mov	eax, [ebp-18h]
		cmp	eax, [ebp-14h]
		jnz	loc_40960A
		cmp	dword ptr [ebp-20h], 0
		jz	loc_409556
		mov	eax, [ebp-14h]
		cmp	eax, [ebp-20h]
		jbe	loc_409556

loc_4094CF:				; CODE XREF: .text:0040952Ej
		cmp	dword ptr [ebp-0Ch], 0Ah
		jz	short loc_409530
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_40951C
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_40951C
		mov	eax, [ebp+8]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_40951C
		mov	eax, [ebp+8]
		mov	ecx, [eax]
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+0Ch], ecx
		jmp	short loc_409527
; ---------------------------------------------------------------------------

loc_40951C:				; CODE XREF: .text:004094E1j
					; .text:004094F1j ...
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408D03

loc_409527:				; CODE XREF: .text:0040951Aj
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_4094CF

loc_409530:				; CODE XREF: .text:004094D3j
		mov	eax, [ebp-1Ch]
		mov	byte ptr [eax],	0Ah
		add	dword ptr [ebp-1Ch], 1
		add	dword ptr [ebp-18h], 1
		cmp	dword ptr [ebp+14h], 0
		jz	loc_409683
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0
		jmp	loc_409683
; ---------------------------------------------------------------------------

loc_409556:				; CODE XREF: .text:004094BDj
					; .text:004094C9j
		add	dword ptr [ebp-14h], 3
		cmp	dword ptr [ebp-14h], 3FFh
		ja	short loc_40956A
		mov	eax, 100h
		jmp	short loc_40956F
; ---------------------------------------------------------------------------

loc_40956A:				; CODE XREF: .text:00409561j
		mov	eax, 400h

loc_40956F:				; CODE XREF: .text:00409568j
		add	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_405550
		mov	edx, [ebp+0Ch]
		mov	[edx], eax
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4095EB
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[ebp-24h], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_40557D
		mov	eax, [ebp+10h]
		mov	dword ptr [eax], 0
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_4095C1
		mov	eax, [ebp+14h]
		mov	dword ptr [eax], 0

loc_4095C1:				; CODE XREF: .text:004095B6j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	edx, [ebp-24h]
		mov	[eax], edx
		mov	eax, 0FFFFFFFFh
		jmp	locret_4096A4
; ---------------------------------------------------------------------------

loc_4095EB:				; CODE XREF: .text:00409590j
		mov	eax, [ebp+0Ch]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		mov	eax, [ebp+10h]
		mov	edx, [ebp-14h]
		mov	[eax], edx
		sub	dword ptr [ebp-14h], 3
		mov	eax, [ebp-18h]
		mov	edx, [ebp-10h]
		add	eax, edx
		mov	[ebp-1Ch], eax

loc_40960A:				; CODE XREF: .text:004094B3j
		mov	eax, [ebp-0Ch]
		mov	edx, eax
		mov	eax, [ebp-1Ch]
		mov	[eax], dl
		add	dword ptr [ebp-1Ch], 1
		add	dword ptr [ebp-18h], 1
		cmp	dword ptr [ebp-0Ch], 0Ah
		jz	short loc_409686

loc_409622:				; CODE XREF: .text:004094A8j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jnz	short loc_409669
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+8]
		cmp	edx, eax
		jnb	short loc_409669
		mov	eax, [ebp+8]
		mov	eax, [eax+1Ch]
		test	eax, eax
		jnz	short loc_409669
		mov	eax, [ebp+8]
		mov	ecx, [eax]
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		lea	eax, [ecx+edx]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		lea	ecx, [edx+1]
		mov	edx, [ebp+8]
		mov	[edx+0Ch], ecx
		jmp	short loc_409674
; ---------------------------------------------------------------------------

loc_409669:				; CODE XREF: .text:0040962Ej
					; .text:0040963Ej ...
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_408D03

loc_409674:				; CODE XREF: .text:00409667j
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	loc_4094AD
		jmp	short loc_409687
; ---------------------------------------------------------------------------

loc_409683:				; CODE XREF: .text:00409542j
					; .text:00409551j
		nop
		jmp	short loc_409687
; ---------------------------------------------------------------------------

loc_409686:				; CODE XREF: .text:00409620j
		nop

loc_409687:				; CODE XREF: .text:00409681j
					; .text:00409684j
		mov	eax, [ebp-1Ch]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, [ebp-18h]

locret_4096A4:				; CODE XREF: .text:00409460j
					; .text:00409485j ...
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40557D
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40789F
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40789F
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409729	proc near		; CODE XREF: sub_409E92+31Ap

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40789F
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_409729	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409758	proc near		; CODE XREF: sub_40494C+180p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_405524
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40789F
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+var_28], eax
		call	sub_405524
		mov	eax, [ebp+var_C]
		leave
		retn
sub_409758	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-14h]
		mov	[esp], eax
		call	sub_40F51B
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jns	short loc_4097E6
		mov	eax, 0
		jmp	short locret_4097E9
; ---------------------------------------------------------------------------

loc_4097E6:				; CODE XREF: .text:004097DDj
		mov	eax, [ebp-14h]

locret_4097E9:				; CODE XREF: .text:004097E4j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_40F51B
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jns	short loc_40981A
		mov	eax, 0
		jmp	short locret_40981D
; ---------------------------------------------------------------------------

loc_40981A:				; CODE XREF: .text:00409811j
		mov	eax, [ebp-10h]

locret_40981D:				; CODE XREF: .text:00409818j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40981F	proc near		; CODE XREF: .text:00409A75p

nBufferLength	= dword	ptr -178h
lpBuffer	= dword	ptr -174h
dwShareMode	= dword	ptr -170h
lpSecurityAttributes= dword ptr	-16Ch
dwCreationDisposition= dword ptr -168h
dwFlagsAndAttributes= dword ptr	-164h
hTemplateFile	= dword	ptr -160h
var_14C		= dword	ptr -14Ch
Buffer		= byte ptr -146h
var_2C		= dword	ptr -2Ch
hObject		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 174h
		mov	eax, ds:GetCurrentProcessId
		call	eax ; GetCurrentProcessId
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+Buffer]
		mov	[esp+178h+lpBuffer], eax ; lpBuffer
		mov	[esp+178h+nBufferLength], 105h ; nBufferLength
		mov	eax, ds:GetTempPathA
		call	eax ; GetTempPathA
		sub	esp, 8
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jz	short loc_40988F
		cmp	[ebp+var_20], 104h
		jg	short loc_40988F
		lea	eax, [ebp+Buffer]
		mov	[ebp+var_14C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 104h
		jbe	short loc_4098A6

loc_40988F:				; CODE XREF: sub_40981F+36j
					; sub_40981F+3Fj
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 2
		mov	eax, 0FFFFFFFFh
		jmp	loc_409A4E
; ---------------------------------------------------------------------------

loc_4098A6:				; CODE XREF: sub_40981F+6Ej
		lea	eax, [ebp+Buffer]
		mov	[ebp+var_14C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_14C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		lea	eax, [ebp+Buffer]
		add	eax, edx
		mov	[ebp+var_10], eax
		mov	edx, offset a_estream ;	"_estream"
		mov	eax, [ebp+var_10]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	edx, byte ptr [edx+8]
		mov	[eax+8], dl
		add	[ebp+var_10], 8
		mov	[esp+178h+lpBuffer], 0 ; lpSecurityAttributes
		lea	eax, [ebp+Buffer]
		mov	[esp+178h+nBufferLength], eax ;	lpPathName
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[ebp+var_24], eax
		mov	[ebp+var_C], 0
		jmp	loc_409A32
; ---------------------------------------------------------------------------

loc_40992D:				; CODE XREF: sub_40981F+217j
		mov	eax, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	eax, ds:GetTickCount
		call	eax ; GetTickCount
		mov	edx, [ebp+var_1C]
		shl	edx, 10h
		xor	eax, edx
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		jmp	short loc_40997E
; ---------------------------------------------------------------------------

loc_40994E:				; CODE XREF: sub_40981F+163j
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		cmp	eax, 9
		ja	short loc_409964
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		add	eax, 30h
		jmp	short loc_40996D
; ---------------------------------------------------------------------------

loc_409964:				; CODE XREF: sub_40981F+138j
		mov	eax, [ebp+var_14]
		shr	eax, 1Ch
		add	eax, 37h

loc_40996D:				; CODE XREF: sub_40981F+143j
		mov	edx, [ebp+var_10]
		mov	[edx], al
		add	[ebp+var_10], 1
		shl	[ebp+var_14], 4
		add	[ebp+var_18], 1

loc_40997E:				; CODE XREF: sub_40981F+12Dj
		cmp	[ebp+var_18], 7
		jle	short loc_40994E
		mov	edx, offset a_tmp_0 ; ".tmp"
		mov	eax, [ebp+var_10]
		mov	ecx, [edx]
		mov	[eax], ecx
		movzx	edx, byte ptr [edx+4]
		mov	[eax+4], dl
		mov	[esp+178h+hTemplateFile], 0 ; hTemplateFile
		mov	[esp+178h+dwFlagsAndAttributes], 4000100h ; dwFlagsAndAttributes
		mov	[esp+178h+dwCreationDisposition], 1 ; dwCreationDisposition
		mov	[esp+178h+lpSecurityAttributes], 0 ; lpSecurityAttributes
		mov	[esp+178h+dwShareMode],	0 ; dwShareMode
		mov	[esp+178h+lpBuffer], 0C0000000h	; dwDesiredAccess
		lea	eax, [ebp+Buffer]
		mov	[esp+178h+nBufferLength], eax ;	lpFileName
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp+hObject], eax
		cmp	[ebp+hObject], 0FFFFFFFFh
		jz	short loc_409A1D
		mov	eax, [ebp+hObject]
		mov	[esp+178h+lpBuffer], 0
		mov	[esp+178h+nBufferLength], eax
		mov	eax, ds:_open_osfhandle
		call	eax ; _open_osfhandle
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0FFFFFFFFh
		jnz	short loc_409A18
		mov	eax, [ebp+hObject]
		mov	[esp+178h+nBufferLength], eax ;	hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0FFFFFFFFh
		jmp	short loc_409A4E
; ---------------------------------------------------------------------------

loc_409A18:				; CODE XREF: sub_40981F+1E0j
		mov	eax, [ebp+var_2C]
		jmp	short loc_409A4E
; ---------------------------------------------------------------------------

loc_409A1D:				; CODE XREF: sub_40981F+1C2j
		mov	[esp+178h+nBufferLength], 1 ; dwMilliseconds
		mov	eax, ds:Sleep
		call	eax ; Sleep
		sub	esp, 4
		add	[ebp+var_C], 1

loc_409A32:				; CODE XREF: sub_40981F+109j
		cmp	[ebp+var_C], 9
		jle	loc_40992D
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 2
		mov	eax, 0FFFFFFFFh

loc_409A4E:				; CODE XREF: sub_40981F+82j
					; sub_40981F+1F7j ...
		mov	edi, [ebp+var_4]
		leave
		retn
sub_40981F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	dword ptr [ebp-0Ch], 0
		mov	dword ptr [ebp-1Ch], 0
		mov	dword ptr [ebp-14h], 302h
		mov	dword ptr [ebp-20h], 0
		call	sub_40981F
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jnz	short loc_409A8F
		mov	dword ptr [ebp-10h], 0FFFFFFFFh
		jmp	loc_409B16
; ---------------------------------------------------------------------------

loc_409A8F:				; CODE XREF: .text:00409A81j
		mov	dword ptr [esp+0Ch], 0
		mov	eax, [ebp-14h]
		mov	[esp+8], eax
		mov	eax, [ebp-18h]
		mov	[esp+4], eax
		lea	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_405DF5
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_409B15
		mov	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-20h]
		mov	dword ptr [esp+20h], 0
		mov	edx, [ebp-14h]
		mov	[esp+1Ch], edx
		mov	edx, off_419150
		mov	[esp+0Ch], edx
		mov	edx, off_419154
		mov	[esp+10h], edx
		mov	edx, off_419158
		mov	[esp+14h], edx
		mov	edx, off_41915C
		mov	[esp+18h], edx
		mov	edx, [ebp-18h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		lea	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_406974
		mov	[ebp-10h], eax
		jmp	short loc_409B16
; ---------------------------------------------------------------------------

loc_409B15:				; CODE XREF: .text:00409AB7j
		nop

loc_409B16:				; CODE XREF: .text:00409A8Aj
					; .text:00409B13j
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_409B47
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_409B2F
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_405F9A
		jmp	short loc_409B40
; ---------------------------------------------------------------------------

loc_409B2F:				; CODE XREF: .text:00409B20j
		cmp	dword ptr [ebp-18h], 0FFFFFFFFh
		jz	short loc_409B40
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	_close

loc_409B40:				; CODE XREF: .text:00409B2Dj
					; .text:00409B33j
		mov	dword ptr [ebp-1Ch], 0

loc_409B47:				; CODE XREF: .text:00409B1Aj
		mov	eax, [ebp-1Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_409B64
		cmp	dword ptr [ebp+10h], 40h
		jz	short loc_409B64
		cmp	dword ptr [ebp+10h], 4
		jnz	short loc_409BC3

loc_409B64:				; CODE XREF: .text:00409B56j
					; .text:00409B5Cj
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_409B76
		cmp	dword ptr [ebp+14h], 0
		jnz	short loc_409B76
		cmp	dword ptr [ebp+10h], 4
		jnz	short loc_409BC3

loc_409B76:				; CODE XREF: .text:00409B68j
					; .text:00409B6Ej
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40799C
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		jmp	short loc_409BD7
; ---------------------------------------------------------------------------

loc_409BC3:				; CODE XREF: .text:00409B62j
					; .text:00409B74j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh

loc_409BD7:				; CODE XREF: .text:00409BC1j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_409C03
		mov	eax, 0
		jmp	short loc_409C08
; ---------------------------------------------------------------------------

loc_409C03:				; CODE XREF: .text:00409BFAj
		mov	eax, 4

loc_409C08:				; CODE XREF: .text:00409C01j
		mov	dword ptr [esp+0Ch], 200h
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40799C
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407B36
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		lea	eax, [ebp-4]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_407B36
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409CD3(int, char *, int)
sub_409CD3	proc near		; CODE XREF: sub_407B8B+E9p
					; sub_40831E+2F1p ...

Dest		= dword	ptr -28h
Source		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 20h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		test	eax, eax
		jz	short loc_409D23
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	eax, byte ptr [eax+250h]
		and	eax, 20h
		test	al, al
		jnz	short loc_409D23
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	[esp+28h+Dest],	eax ; void *
		call	sub_40557D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	dword ptr [eax+220h], 0

loc_409D23:				; CODE XREF: sub_409CD3+16j
					; sub_409CD3+2Aj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		test	eax, eax
		jnz	loc_409DCF
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Bh
		jz	short loc_409D4A
		mov	[ebp+arg_8], 0
		jmp	short loc_409D57
; ---------------------------------------------------------------------------

loc_409D4A:				; CODE XREF: sub_409CD3+6Cj
		cmp	[ebp+arg_8], 0
		setnz	al
		movzx	eax, al
		mov	[ebp+arg_8], eax

loc_409D57:				; CODE XREF: sub_409CD3+75j
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+24h]
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+arg_8]
		add	eax, edx
		add	eax, 1
		mov	[esp+28h+Dest],	eax ; size_t
		call	sub_405533
		mov	[ebx+220h], eax
		cmp	[ebp+arg_4], 0
		jz	short loc_409DD0
		cmp	[ebp+arg_8], 0
		jz	short loc_409DAD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	byte ptr [eax],	5Ch

loc_409DAD:				; CODE XREF: sub_409CD3+C9j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	edx, [eax+220h]
		mov	eax, [ebp+arg_8]
		add	edx, eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Source], eax ;	Source
		mov	[esp+28h+Dest],	edx ; Dest
		call	strcpy
		jmp	short loc_409DD0
; ---------------------------------------------------------------------------

loc_409DCF:				; CODE XREF: sub_409CD3+5Ej
		nop

loc_409DD0:				; CODE XREF: sub_409CD3+C3j
					; sub_409CD3+FAj
		add	esp, 20h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_409CD3	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short locret_409E25
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409CD3
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524

locret_409E25:				; CODE XREF: .text:00409DE1j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_409E27	proc near		; CODE XREF: sub_401AD2+5Fp
					; sub_401AD2+80p ...

var_14		= dword	ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+14h+var_14], eax
		call	sub_405524
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+220h]
		mov	[ebp+var_4], eax
		cmp	[ebp+var_4], 0
		jz	short loc_409E6C
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		movzx	edx, byte ptr [eax+250h]
		or	edx, 20h
		mov	[eax+250h], dl

loc_409E6C:				; CODE XREF: sub_409E27+2Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+14h+var_14], eax
		call	sub_405524
		cmp	[ebp+var_4], 0
		jnz	short loc_409E8D
		mov	[ebp+var_4], offset a? ; "[?]"

loc_409E8D:				; CODE XREF: sub_409E27+5Dj
		mov	eax, [ebp+var_4]
		leave
		retn
sub_409E27	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_409E92(int, int, int,	char *,	int)
sub_409E92	proc near		; CODE XREF: .text:0040A553p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+Str], eax
		call	sub_405524
		jmp	loc_40A228
; ---------------------------------------------------------------------------

loc_409EBE:				; CODE XREF: sub_409E92+39Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_409F06
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_409F06
		cmp	[ebp+arg_C], 0
		jz	loc_40A1B7
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jnz	short loc_409F06
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_40A1B7

loc_409F06:				; CODE XREF: sub_409E92+34j
					; sub_409E92+3Ej ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_409F3F
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_409F3F
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	5Ch
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_409F52
; ---------------------------------------------------------------------------

loc_409F3F:				; CODE XREF: sub_409E92+80j
					; sub_409E92+90j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 5Ch
		call	sub_408D4A

loc_409F52:				; CODE XREF: sub_409E92+ABj
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_409FB5
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_409F99
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_409F99
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	6Eh
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_409FAC
; ---------------------------------------------------------------------------

loc_409F99:				; CODE XREF: sub_409E92+DAj
					; sub_409E92+EAj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 6Eh
		call	sub_408D4A

loc_409FAC:				; CODE XREF: sub_409E92+105j
		add	[ebp+var_10], 1
		jmp	loc_40A21C
; ---------------------------------------------------------------------------

loc_409FB5:				; CODE XREF: sub_409E92+CCj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_40A014
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_409FF8
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_409FF8
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	72h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_40A00B
; ---------------------------------------------------------------------------

loc_409FF8:				; CODE XREF: sub_409E92+139j
					; sub_409E92+149j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 72h
		call	sub_408D4A

loc_40A00B:				; CODE XREF: sub_409E92+164j
		add	[ebp+var_10], 1
		jmp	loc_40A21C
; ---------------------------------------------------------------------------

loc_40A014:				; CODE XREF: sub_409E92+12Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_40A073
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40A057
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_40A057
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	66h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_40A06A
; ---------------------------------------------------------------------------

loc_40A057:				; CODE XREF: sub_409E92+198j
					; sub_409E92+1A8j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 66h
		call	sub_408D4A

loc_40A06A:				; CODE XREF: sub_409E92+1C3j
		add	[ebp+var_10], 1
		jmp	loc_40A21C
; ---------------------------------------------------------------------------

loc_40A073:				; CODE XREF: sub_409E92+18Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_40A0D2
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40A0B6
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_40A0B6
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	76h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_40A0C9
; ---------------------------------------------------------------------------

loc_40A0B6:				; CODE XREF: sub_409E92+1F7j
					; sub_409E92+207j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 76h
		call	sub_408D4A

loc_40A0C9:				; CODE XREF: sub_409E92+222j
		add	[ebp+var_10], 1
		jmp	loc_40A21C
; ---------------------------------------------------------------------------

loc_40A0D2:				; CODE XREF: sub_409E92+1E9j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_40A131
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40A115
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_40A115
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	62h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_40A128
; ---------------------------------------------------------------------------

loc_40A115:				; CODE XREF: sub_409E92+256j
					; sub_409E92+266j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 62h
		call	sub_408D4A

loc_40A128:				; CODE XREF: sub_409E92+281j
		add	[ebp+var_10], 1
		jmp	loc_40A21C
; ---------------------------------------------------------------------------

loc_40A131:				; CODE XREF: sub_409E92+248j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40A190
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40A174
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_40A174
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	edx, eax
		mov	byte ptr [edx],	30h
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_40A187
; ---------------------------------------------------------------------------

loc_40A174:				; CODE XREF: sub_409E92+2B5j
					; sub_409E92+2C5j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Val], eax
		mov	[esp+28h+Str], 30h
		call	sub_408D4A

loc_40A187:				; CODE XREF: sub_409E92+2E0j
		add	[ebp+var_10], 1
		jmp	loc_40A21C
; ---------------------------------------------------------------------------

loc_40A190:				; CODE XREF: sub_409E92+2A7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x ; "x%02x"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+Val], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_409729
		add	[ebp+var_10], 3
		jmp	short loc_40A21C
; ---------------------------------------------------------------------------

loc_40A1B7:				; CODE XREF: sub_409E92+44j
					; sub_409E92+6Ej
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40A200
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_40A200
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_40A200
		mov	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+var_C]
		movzx	edx, byte ptr [edx]
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+0Ch], edx
		jmp	short loc_40A218
; ---------------------------------------------------------------------------

loc_40A200:				; CODE XREF: sub_409E92+331j
					; sub_409E92+341j ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Val], edx
		mov	[esp+28h+Str], eax
		call	sub_408D4A

loc_40A218:				; CODE XREF: sub_409E92+36Cj
		add	[ebp+var_10], 1

loc_40A21C:				; CODE XREF: sub_409E92+11Ej
					; sub_409E92+17Dj ...
		sub	[ebp+arg_8], 1
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_40A228:				; CODE XREF: sub_409E92+27j
		cmp	[ebp+arg_8], 0
		jnz	loc_409EBE
		cmp	[ebp+arg_10], 0
		jz	short loc_40A240
		mov	eax, [ebp+arg_10]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_40A240:				; CODE XREF: sub_409E92+3A4j
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_4089C9
		test	eax, eax
		jz	short loc_40A256
		mov	eax, 0FFFFFFFFh
		jmp	short loc_40A25B
; ---------------------------------------------------------------------------

loc_40A256:				; CODE XREF: sub_409E92+3BBj
		mov	eax, 0

loc_40A25B:				; CODE XREF: sub_409E92+3C2j
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp+28h+Str], eax
		call	sub_405524
		mov	eax, [ebp+var_14]
		leave
		retn
sub_409E92	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_40A294
		mov	eax, 0
		jmp	locret_40A460
; ---------------------------------------------------------------------------

loc_40A294:				; CODE XREF: .text:0040A288j
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		jmp	loc_40A413
; ---------------------------------------------------------------------------

loc_40A2B3:				; CODE XREF: .text:0040A417j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40A31A
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_40A31A
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		shr	dl, 4
		movzx	edx, dl
		and	edx, 0Fh
		cmp	edx, 9
		jg	short loc_40A301
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		shr	dl, 4
		add	edx, 30h
		jmp	short loc_40A30D
; ---------------------------------------------------------------------------

loc_40A301:				; CODE XREF: .text:0040A2F1j
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		shr	dl, 4
		add	edx, 37h

loc_40A30D:				; CODE XREF: .text:0040A2FFj
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx
		jmp	short loc_40A363
; ---------------------------------------------------------------------------

loc_40A31A:				; CODE XREF: .text:0040A2BFj
					; .text:0040A2CFj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_40A342
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_40A354
; ---------------------------------------------------------------------------

loc_40A342:				; CODE XREF: .text:0040A32Cj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 37h

loc_40A354:				; CODE XREF: .text:0040A340j
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_408D4A

loc_40A363:				; CODE XREF: .text:0040A318j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax+20h]
		and	eax, 1
		test	al, al
		jz	short loc_40A3C7
		mov	eax, [ebp+8]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+8]
		mov	eax, [eax+4]
		cmp	edx, eax
		jnb	short loc_40A3C7
		mov	eax, [ebp+8]
		mov	edx, [eax]
		mov	eax, [ebp+8]
		mov	eax, [eax+0Ch]
		lea	ecx, [edx+eax]
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		movzx	edx, dl
		and	edx, 0Fh
		cmp	edx, 9
		jg	short loc_40A3AE
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		and	edx, 0Fh
		add	edx, 30h
		jmp	short loc_40A3BA
; ---------------------------------------------------------------------------

loc_40A3AE:				; CODE XREF: .text:0040A39Ej
		mov	edx, [ebp-0Ch]
		movzx	edx, byte ptr [edx]
		and	edx, 0Fh
		add	edx, 37h

loc_40A3BA:				; CODE XREF: .text:0040A3ACj
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+8]
		mov	[eax+0Ch], edx
		jmp	short loc_40A407
; ---------------------------------------------------------------------------

loc_40A3C7:				; CODE XREF: .text:0040A36Fj
					; .text:0040A37Fj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_40A3E9
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_40A3F8
; ---------------------------------------------------------------------------

loc_40A3E9:				; CODE XREF: .text:0040A3D6j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		add	eax, 37h

loc_40A3F8:				; CODE XREF: .text:0040A3E7j
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_408D4A

loc_40A407:				; CODE XREF: .text:0040A3C5j
		add	dword ptr [ebp-10h], 2
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp+10h], 1

loc_40A413:				; CODE XREF: .text:0040A2AEj
		cmp	dword ptr [ebp+10h], 0
		jnz	loc_40A2B3
		cmp	dword ptr [ebp+18h], 0
		jz	short loc_40A42B
		mov	eax, [ebp+18h]
		mov	edx, [ebp-10h]
		mov	[eax], edx

loc_40A42B:				; CODE XREF: .text:0040A421j
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4089C9
		test	eax, eax
		jz	short loc_40A441
		mov	eax, 0FFFFFFFFh
		jmp	short loc_40A446
; ---------------------------------------------------------------------------

loc_40A441:				; CODE XREF: .text:0040A438j
		mov	eax, 0

loc_40A446:				; CODE XREF: .text:0040A43Fj
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		mov	eax, [eax+24h]
		mov	eax, [eax+210h]
		mov	[esp], eax
		call	sub_405524
		mov	eax, [ebp-14h]

locret_40A460:				; CODE XREF: .text:0040A28Fj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	eax, [ebp+0Ch]
		mov	[ebp-10h], eax
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_40A48B
; ---------------------------------------------------------------------------

loc_40A478:				; CODE XREF: .text:0040A491j
		mov	eax, [ebp-0Ch]
		mov	edx, [ebp-10h]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_40A495
		add	dword ptr [ebp-0Ch], 1

loc_40A48B:				; CODE XREF: .text:0040A476j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jb	short loc_40A478
		jmp	short loc_40A496
; ---------------------------------------------------------------------------

loc_40A495:				; CODE XREF: .text:0040A485j
		nop

loc_40A496:				; CODE XREF: .text:0040A493j
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+10h]
		jnb	loc_40A531
		cmp	dword ptr [ebp+14h], 0
		jz	short loc_40A4B3
		mov	eax, [ebp+14h]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		jmp	short loc_40A4B8
; ---------------------------------------------------------------------------

loc_40A4B3:				; CODE XREF: .text:0040A4A6j
		mov	eax, 0

loc_40A4B8:				; CODE XREF: .text:0040A4B1j
		mov	[ebp-14h], eax
		mov	eax, [ebp-14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_41669F
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp+18h], 0
		jz	short loc_40A501
		mov	eax, [ebp-18h]
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-2Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+18h]
		mov	[eax], edx

loc_40A501:				; CODE XREF: .text:0040A4DBj
		mov	eax, [ebp-18h]
		mov	edx, [ebp+8]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_40922E
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-18h]
		mov	[esp], eax
		call	sub_404E31
		cmp	dword ptr [ebp-1Ch], 0FFFFFFFFh
		jz	short loc_40A52C
		mov	eax, [ebp-0Ch]
		jmp	short loc_40A52F
; ---------------------------------------------------------------------------

loc_40A52C:				; CODE XREF: .text:0040A525j
		mov	eax, [ebp-1Ch]

loc_40A52F:				; CODE XREF: .text:0040A52Aj
		jmp	short loc_40A558
; ---------------------------------------------------------------------------

loc_40A531:				; CODE XREF: .text:0040A49Cj
		mov	eax, [ebp-10h]
		mov	edx, [ebp+18h]
		mov	[esp+10h], edx
		mov	edx, [ebp+14h]
		mov	[esp+0Ch], edx
		mov	edx, [ebp+10h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_409E92

loc_40A558:				; CODE XREF: .text:loc_40A52Fj
		add	esp, 54h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-0Ch]
		mov	[eax], edx
		mov	eax, [ebp-0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_40F51B
		test	eax, eax
		jns	short loc_40A5AC
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp], eax
		call	strerror
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	aEstream_asprin	; "estream_asprintf failed: %s\n"
		call	sub_411A40
; ---------------------------------------------------------------------------

loc_40A5AC:				; CODE XREF: .text:0040A589j
		mov	eax, [ebp-10h]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A5B1	proc near		; CODE XREF: sub_403E11+156p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_24], eax
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_28], eax
		call	sub_40F51B
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_40A5E8
		mov	eax, 0
		jmp	short locret_40A5EB
; ---------------------------------------------------------------------------

loc_40A5E8:				; CODE XREF: sub_40A5B1+2Ej
		mov	eax, [ebp+var_14]

locret_40A5EB:				; CODE XREF: sub_40A5B1+35j
		leave
		retn
sub_40A5B1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A5F0	proc near		; CODE XREF: sub_40A617+14p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 0
		jz	short loc_40A610
		mov	eax, [ebp+arg_0]
		and	eax, 7Fh
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_4]
		and	eax, 0FFFFh
		or	eax, edx
		jmp	short loc_40A615
; ---------------------------------------------------------------------------

loc_40A610:				; CODE XREF: sub_40A5F0+7j
		mov	eax, 0

loc_40A615:				; CODE XREF: sub_40A5F0+1Ej
		pop	ebp
		retn
sub_40A5F0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A617	proc near		; CODE XREF: sub_40B3FD+17p
					; sub_40B3FD+4Bp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, [ebp+arg_0]
		mov	[esp+8+var_4], eax
		mov	[esp+8+var_8], 0
		call	sub_40A5F0
		leave
		retn
sub_40A617	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40A632	proc near		; CODE XREF: .text:0040A695p
					; .text:0040A7C6p

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_28], 0
		call	sub_418670
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_41D0E4
		test	eax, eax
		jnz	short loc_40A655
		mov	eax, [ebp+var_C]
		jmp	short locret_40A68A
; ---------------------------------------------------------------------------

loc_40A655:				; CODE XREF: sub_40A632+1Cj
		mov	eax, ds:dword_41D0E4
		cmp	eax, 1
		jnz	short loc_40A666
		mov	eax, ds:dword_41D0E0
		jmp	short locret_40A68A
; ---------------------------------------------------------------------------

loc_40A666:				; CODE XREF: sub_40A632+2Bj
		mov	eax, ds:dword_41D0E4
		cmp	eax, 2
		jnz	short loc_40A67C
		mov	edx, [ebp+var_C]
		mov	eax, ds:dword_41D0E0
		add	eax, edx
		jmp	short locret_40A68A
; ---------------------------------------------------------------------------

loc_40A67C:				; CODE XREF: sub_40A632+3Cj
		mov	edx, [ebp+var_C]
		mov	eax, ds:dword_41D0E0
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_40A68A:				; CODE XREF: sub_40A632+21j
					; sub_40A632+32j ...
		leave
		retn
sub_40A632	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		call	sub_40A632
		mov	[ebp-20h], eax
		mov	eax, [ebp-20h]
		test	eax, eax
		jns	short loc_40A6AC
		mov	eax, [ebp+8]
		mov	byte ptr [eax],	0
		jmp	short loc_40A719
; ---------------------------------------------------------------------------

loc_40A6AC:				; CODE XREF: .text:0040A6A2j
		lea	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_418690
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		mov	ebx, [eax]
		mov	eax, [ebp-1Ch]
		mov	ecx, [eax+4]
		mov	eax, [ebp-1Ch]
		mov	edx, [eax+8]
		mov	eax, [ebp-1Ch]
		mov	eax, [eax+0Ch]
		mov	esi, [ebp-1Ch]
		mov	esi, [esi+10h]
		lea	edi, [esi+1]
		mov	esi, [ebp-1Ch]
		mov	esi, [esi+14h]
		add	esi, 76Ch
		mov	[esp+20h], ebx
		mov	[esp+1Ch], ecx
		mov	[esp+18h], edx
		mov	[esp+14h], eax
		mov	[esp+10h], edi
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], offset a04d02d02dt02d0 ; "%04d%02d%02dT%02d%02d%02d"
		mov	dword ptr [esp+4], 10h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40F3D9

loc_40A719:				; CODE XREF: .text:0040A6AAj
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp], 0
		call	sub_418670
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp+8], 0FFFFFFFFh
		jz	short loc_40A744
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_40A75A

loc_40A744:				; CODE XREF: .text:0040A73Aj
		mov	ds:dword_41D0E4, 0
		mov	ds:dword_41D0E0, 0
		jmp	short locret_40A7B4
; ---------------------------------------------------------------------------

loc_40A75A:				; CODE XREF: .text:0040A742j
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_40A774
		mov	ds:dword_41D0E4, 1
		mov	eax, [ebp-0Ch]
		mov	ds:dword_41D0E0, eax
		jmp	short locret_40A7B4
; ---------------------------------------------------------------------------

loc_40A774:				; CODE XREF: .text:0040A75Ej
		mov	eax, [ebp+8]
		cmp	eax, [ebp-0Ch]
		jle	short loc_40A799
		mov	ds:dword_41D0E4, 2
		mov	eax, [ebp-0Ch]
		mov	edx, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	ds:dword_41D0E0, eax
		jmp	short locret_40A7B4
; ---------------------------------------------------------------------------

loc_40A799:				; CODE XREF: .text:0040A77Aj
		mov	ds:dword_41D0E4, 3
		mov	eax, [ebp+8]
		mov	edx, [ebp-0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	ds:dword_41D0E0, eax

locret_40A7B4:				; CODE XREF: .text:0040A758j
					; .text:0040A772j ...
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_41D0E4
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_40A632
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jnz	short loc_40A7E0
		mov	dword ptr [esp], offset	aGnupg_get_time	; "gnupg_get_time() failed\n"
		call	sub_411A40
; ---------------------------------------------------------------------------

loc_40A7E0:				; CODE XREF: .text:0040A7D2j
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 60h
		mov	eax, [ebp+8]
		mov	dword ptr [ebp-4Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-4Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 0Ah
		jnz	short loc_40A82B
		mov	eax, [ebp+8]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_40A82B
		mov	eax, [ebp+8]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jz	short loc_40A835

loc_40A82B:				; CODE XREF: .text:0040A80Fj
					; .text:0040A81Cj
		mov	eax, 0
		jmp	loc_40A994
; ---------------------------------------------------------------------------

loc_40A835:				; CODE XREF: .text:0040A829j
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_40A866
; ---------------------------------------------------------------------------

loc_40A83E:				; CODE XREF: .text:0040A86Aj
		mov	eax, [ebp-0Ch]
		add	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40A858
		mov	eax, [ebp-0Ch]
		add	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40A862

loc_40A858:				; CODE XREF: .text:0040A849j
		mov	eax, 0
		jmp	loc_40A994
; ---------------------------------------------------------------------------

loc_40A862:				; CODE XREF: .text:0040A856j
		add	dword ptr [ebp-0Ch], 1

loc_40A866:				; CODE XREF: .text:0040A83Cj
		cmp	dword ptr [ebp-0Ch], 3
		jle	short loc_40A83E
		mov	eax, [ebp+8]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40A8A0
		mov	eax, [ebp+8]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40A8A0
		mov	eax, [ebp+8]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40A8A0
		mov	eax, [ebp+8]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40A8AA

loc_40A8A0:				; CODE XREF: .text:0040A877j
					; .text:0040A884j ...
		mov	eax, 0
		jmp	loc_40A994
; ---------------------------------------------------------------------------

loc_40A8AA:				; CODE XREF: .text:0040A89Ej
		mov	eax, [ebp+8]
		add	eax, 8
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40A8DE
		mov	eax, [ebp+8]
		add	eax, 8
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40A8DE
		mov	eax, [ebp+8]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40A8DE
		mov	eax, [ebp+8]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40A8E8

loc_40A8DE:				; CODE XREF: .text:0040A8B5j
					; .text:0040A8C2j ...
		mov	eax, 0
		jmp	loc_40A994
; ---------------------------------------------------------------------------

loc_40A8E8:				; CODE XREF: .text:0040A8DCj
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	atoi
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		add	eax, 5
		mov	[esp], eax
		call	atoi
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		add	eax, 8
		mov	[esp], eax
		call	atoi
		mov	[ebp-18h], eax
		cmp	dword ptr [ebp-10h], 7B1h
		jle	short loc_40A939
		cmp	dword ptr [ebp-14h], 0
		jle	short loc_40A939
		cmp	dword ptr [ebp-14h], 0Ch
		jg	short loc_40A939
		cmp	dword ptr [ebp-18h], 0
		jle	short loc_40A939
		cmp	dword ptr [ebp-18h], 1Fh
		jle	short loc_40A940

loc_40A939:				; CODE XREF: .text:0040A91Fj
					; .text:0040A925j ...
		mov	eax, 0
		jmp	short loc_40A994
; ---------------------------------------------------------------------------

loc_40A940:				; CODE XREF: .text:0040A937j
		lea	eax, [ebp-40h]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 9
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	eax, [ebp-18h]
		mov	[ebp-34h], eax
		mov	eax, [ebp-14h]
		sub	eax, 1
		mov	[ebp-30h], eax
		mov	eax, [ebp-10h]
		sub	eax, 76Ch
		mov	[ebp-2Ch], eax
		mov	dword ptr [ebp-20h], 0FFFFFFFFh
		lea	eax, [ebp-40h]
		mov	[esp], eax
		call	sub_4186A0
		mov	[ebp-1Ch], eax
		cmp	dword ptr [ebp-1Ch], 0FFFFFFFFh
		jnz	short loc_40A991
		mov	eax, 0
		jmp	short loc_40A994
; ---------------------------------------------------------------------------

loc_40A991:				; CODE XREF: .text:0040A988j
		mov	eax, [ebp-1Ch]

loc_40A994:				; CODE XREF: .text:0040A830j
					; .text:0040A85Dj ...
		add	esp, 60h
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 60h
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40A9B7
		mov	eax, 0FFFFFFFFh
		jmp	loc_40AC5D
; ---------------------------------------------------------------------------

loc_40A9B7:				; CODE XREF: .text:0040A9ABj
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], 0
		jmp	short loc_40A9EC
; ---------------------------------------------------------------------------

loc_40A9C6:				; CODE XREF: .text:0040A9F0j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40A9DA
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40A9E4

loc_40A9DA:				; CODE XREF: .text:0040A9CEj
		mov	eax, 0FFFFFFFFh
		jmp	loc_40AC5D
; ---------------------------------------------------------------------------

loc_40A9E4:				; CODE XREF: .text:0040A9D8j
		add	dword ptr [ebp-10h], 1
		add	dword ptr [ebp-0Ch], 1

loc_40A9EC:				; CODE XREF: .text:0040A9C4j
		cmp	dword ptr [ebp-10h], 7
		jle	short loc_40A9C6
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 54h
		jz	short loc_40AA06
		mov	eax, 0FFFFFFFFh
		jmp	loc_40AC5D
; ---------------------------------------------------------------------------

loc_40AA06:				; CODE XREF: .text:0040A9FAj
		add	dword ptr [ebp-0Ch], 1
		mov	dword ptr [ebp-10h], 9
		jmp	short loc_40AA39
; ---------------------------------------------------------------------------

loc_40AA13:				; CODE XREF: .text:0040AA3Dj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40AA27
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40AA31

loc_40AA27:				; CODE XREF: .text:0040AA1Bj
		mov	eax, 0FFFFFFFFh
		jmp	loc_40AC5D
; ---------------------------------------------------------------------------

loc_40AA31:				; CODE XREF: .text:0040AA25j
		add	dword ptr [ebp-10h], 1
		add	dword ptr [ebp-0Ch], 1

loc_40AA39:				; CODE XREF: .text:0040AA11j
		cmp	dword ptr [ebp-10h], 0Eh
		jle	short loc_40AA13
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40AA88
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_40AA6A
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_40AA88

loc_40AA6A:				; CODE XREF: .text:0040AA51j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_40AA88
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ch
		jz	short loc_40AA88
		mov	eax, 0FFFFFFFFh
		jmp	loc_40AC5D
; ---------------------------------------------------------------------------

loc_40AA88:				; CODE XREF: .text:0040AA47j
					; .text:0040AA68j ...
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 3E8h
		lea	edx, [eax-0BB80h]
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 64h
		sub	eax, 12C0h
		lea	ecx, [edx+eax]
		mov	eax, [ebp+8]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		add	eax, ecx
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-18h], eax
		mov	eax, [ebp+8]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-1Ch], eax
		mov	eax, [ebp+8]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Ah
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-20h], eax
		mov	eax, [ebp+8]
		add	eax, 0Bh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Ch
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-24h], eax
		mov	eax, [ebp+8]
		add	eax, 0Dh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Eh
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-28h], eax
		cmp	dword ptr [ebp-14h], 7B1h
		jle	short loc_40AC03
		cmp	dword ptr [ebp-18h], 0
		jle	short loc_40AC03
		cmp	dword ptr [ebp-18h], 0Ch
		jg	short loc_40AC03
		cmp	dword ptr [ebp-1Ch], 0
		jle	short loc_40AC03
		cmp	dword ptr [ebp-1Ch], 1Fh
		jg	short loc_40AC03
		cmp	dword ptr [ebp-20h], 17h
		jg	short loc_40AC03
		cmp	dword ptr [ebp-24h], 3Bh
		jg	short loc_40AC03
		cmp	dword ptr [ebp-28h], 3Dh
		jle	short loc_40AC0A

loc_40AC03:				; CODE XREF: .text:0040ABD7j
					; .text:0040ABDDj ...
		mov	eax, 0FFFFFFFFh
		jmp	short loc_40AC5D
; ---------------------------------------------------------------------------

loc_40AC0A:				; CODE XREF: .text:0040AC01j
		lea	eax, [ebp-4Ch]
		mov	ebx, eax
		mov	eax, 0
		mov	edx, 9
		mov	edi, ebx
		mov	ecx, edx
		rep stosd
		mov	eax, [ebp-28h]
		mov	[ebp-4Ch], eax
		mov	eax, [ebp-24h]
		mov	[ebp-48h], eax
		mov	eax, [ebp-20h]
		mov	[ebp-44h], eax
		mov	eax, [ebp-1Ch]
		mov	[ebp-40h], eax
		mov	eax, [ebp-18h]
		sub	eax, 1
		mov	[ebp-3Ch], eax
		mov	eax, [ebp-14h]
		sub	eax, 76Ch
		mov	[ebp-38h], eax
		mov	dword ptr [ebp-2Ch], 0FFFFFFFFh
		lea	eax, [ebp-4Ch]
		mov	[esp], eax
		call	sub_416882

loc_40AC5D:				; CODE XREF: .text:0040A9B2j
					; .text:0040A9DFj ...
		add	esp, 60h
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+0Ch]
		test	eax, eax
		jns	short loc_40AC7C
		mov	eax, [ebp+8]
		mov	byte ptr [eax],	0
		jmp	short loc_40ACE9
; ---------------------------------------------------------------------------

loc_40AC7C:				; CODE XREF: .text:0040AC72j
		lea	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_418690
		mov	[ebp-1Ch], eax
		mov	eax, [ebp-1Ch]
		mov	ebx, [eax]
		mov	eax, [ebp-1Ch]
		mov	ecx, [eax+4]
		mov	eax, [ebp-1Ch]
		mov	edx, [eax+8]
		mov	eax, [ebp-1Ch]
		mov	eax, [eax+0Ch]
		mov	esi, [ebp-1Ch]
		mov	esi, [esi+10h]
		lea	edi, [esi+1]
		mov	esi, [ebp-1Ch]
		mov	esi, [esi+14h]
		add	esi, 76Ch
		mov	[esp+20h], ebx
		mov	[esp+1Ch], ecx
		mov	[esp+18h], edx
		mov	[esp+14h], eax
		mov	[esp+10h], edi
		mov	[esp+0Ch], esi
		mov	dword ptr [esp+8], offset a04d02d02dt02d0 ; "%04d%02d%02dT%02d%02d%02d"
		mov	dword ptr [esp+4], 10h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40F3D9

loc_40ACE9:				; CODE XREF: .text:0040AC7Aj
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 4
		mov	eax, [ebp+0Ch]
		mov	[ebp-4], ax
		movzx	eax, word ptr [ebp-4]
		imul	eax, 15180h
		add	eax, [ebp+8]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, [ebp+8]
		mov	[ebp-1Ch], eax
		mov	edx, 88888889h
		mov	eax, [ebp-1Ch]
		mul	edx
		mov	eax, edx
		shr	eax, 5
		mov	[ebp+8], eax
		mov	ecx, [ebp+8]
		mov	edx, 88888889h
		mov	eax, ecx
		mul	edx
		mov	eax, edx
		shr	eax, 5
		shl	eax, 2
		mov	edx, eax
		shl	edx, 4
		sub	edx, eax
		mov	eax, ecx
		sub	eax, edx
		mov	[ebp-0Ch], eax
		mov	edx, [ebp+8]
		mov	[ebp-1Ch], edx
		mov	edx, 88888889h
		mov	eax, [ebp-1Ch]
		mul	edx
		mov	eax, edx
		shr	eax, 5
		mov	[ebp+8], eax
		mov	ecx, [ebp+8]
		mov	edx, 0AAAAAAABh
		mov	eax, ecx
		mul	edx
		shr	edx, 4
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		mov	[ebp-1Ch], eax
		mov	edx, 0AAAAAAABh
		mov	eax, [ebp-1Ch]
		mul	edx
		mov	eax, edx
		shr	eax, 4
		mov	[ebp+8], eax
		mov	ecx, [ebp+8]
		mov	edx, 6719F361h
		mov	eax, ecx
		mul	edx
		mov	eax, ecx
		sub	eax, edx
		shr	eax, 1
		add	eax, edx
		shr	eax, 8
		imul	eax, 16Dh
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		mov	[ebp-14h], eax
		mov	ecx, [ebp+8]
		mov	edx, 6719F361h
		mov	eax, ecx
		mul	edx
		mov	eax, ecx
		sub	eax, edx
		shr	eax, 1
		add	eax, edx
		shr	eax, 8
		mov	[ebp+8], eax
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, offset aUyUdUhUm ;	"%uy%ud%uh%um"
		mov	edx, [ebp-0Ch]
		mov	[esp+14h], edx
		mov	edx, [ebp-10h]
		mov	[esp+10h], edx
		mov	edx, [ebp-14h]
		mov	[esp+0Ch], edx
		mov	edx, [ebp-18h]
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_41D160
		call	sprintf
		cmp	dword ptr [ebp-18h], 0
		jz	short loc_40AE22
		mov	eax, offset dword_41D160
		jmp	short locret_40AE58
; ---------------------------------------------------------------------------

loc_40AE22:				; CODE XREF: .text:0040AE19j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_40AE41
		mov	dword ptr [esp+4], 79h
		mov	dword ptr [esp], offset	dword_41D160
		call	strchr
		add	eax, 1
		jmp	short locret_40AE58
; ---------------------------------------------------------------------------

loc_40AE41:				; CODE XREF: .text:0040AE26j
		mov	dword ptr [esp+4], 64h
		mov	dword ptr [esp], offset	dword_41D160
		call	strchr
		add	eax, 1

locret_40AE58:				; CODE XREF: .text:0040AE20j
					; .text:0040AE3Fj
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		test	eax, eax
		jns	short loc_40AE9A
		mov	eax, offset a???????? ;	"????-??-??"
		mov	edx, [eax]
		mov	ds:dword_41D150, edx
		mov	edx, [eax+4]
		mov	ds:dword_41D154, edx
		movzx	edx, word ptr [eax+8]
		mov	ds:word_41D158,	dx
		movzx	eax, byte ptr [eax+0Ah]
		mov	ds:byte_41D15A,	al
		jmp	short loc_40AEE4
; ---------------------------------------------------------------------------

loc_40AE9A:				; CODE XREF: .text:0040AE6Cj
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_418690
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+10h]
		lea	ebx, [eax+1]
		mov	eax, [ebp-0Ch]
		mov	eax, [eax+14h]
		lea	ecx, [eax+76Ch]
		mov	eax, offset a04d02d02d ; "%04d-%02d-%02d"
		mov	[esp+10h], edx
		mov	[esp+0Ch], ebx
		mov	[esp+8], ecx
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_41D150
		call	sprintf

loc_40AEE4:				; CODE XREF: .text:0040AE98j
		mov	eax, offset dword_41D150
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40AEEF	proc near		; CODE XREF: sub_40494C+120p

Dest		= dword	ptr -58h
Format		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		test	eax, eax
		jns	short loc_40AF37
		mov	eax, offset a?????????????? ; "????-??-?? ??:??:??"
		mov	edx, [eax]
		mov	ds:Dest, edx
		mov	edx, [eax+4]
		mov	ds:dword_41D136, edx
		mov	edx, [eax+8]
		mov	ds:dword_41D13A, edx
		mov	edx, [eax+0Ch]
		mov	ds:dword_41D13E, edx
		mov	eax, [eax+10h]
		mov	ds:dword_41D142, eax
		jmp	short loc_40AFA4
; ---------------------------------------------------------------------------

loc_40AF37:				; CODE XREF: sub_40AEEF+14j
		lea	eax, [ebp+var_20]
		mov	[esp+58h+Dest],	eax
		call	sub_418690
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	esi, [eax]
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax+4]
		mov	eax, [ebp+var_1C]
		mov	ecx, [eax+8]
		mov	eax, [ebp+var_1C]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+10h]
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+14h]
		lea	edi, [eax+76Ch]
		mov	eax, offset a04d02d02d02d02 ; "%04d-%02d-%02d %02d:%02d:%02d"
		mov	[esp+58h+var_3C], esi
		mov	[esp+58h+var_40], ebx
		mov	[esp+58h+var_44], ecx
		mov	[esp+58h+var_48], edx
		mov	edx, [ebp+var_2C]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], edi
		mov	[esp+58h+Format], eax ;	Format
		mov	[esp+58h+Dest],	offset Dest ; Dest
		call	sprintf

loc_40AFA4:				; CODE XREF: sub_40AEEF+46j
		mov	eax, offset Dest
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40AEEF	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		test	eax, eax
		jns	short loc_40AFF5
		mov	eax, offset a???????? ;	"????-??-??"
		mov	edx, [eax]
		mov	ds:dword_41D100, edx
		mov	edx, [eax+4]
		mov	ds:dword_41D104, edx
		movzx	edx, word ptr [eax+8]
		mov	ds:word_41D108,	dx
		movzx	eax, byte ptr [eax+0Ah]
		mov	ds:byte_41D10A,	al
		mov	eax, offset dword_41D100
		jmp	short locret_40B033
; ---------------------------------------------------------------------------

loc_40AFF5:				; CODE XREF: .text:0040AFC2j
		lea	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_4186B0
		mov	[ebp-0Ch], eax
		mov	edx, [ebp-0Ch]
		mov	eax, offset aCZ	; "%c %Z"
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 31h
		mov	dword ptr [esp], offset	dword_41D100
		call	strftime
		mov	ds:byte_41D131,	0
		mov	eax, offset dword_41D100

locret_40B033:				; CODE XREF: .text:0040AFF3j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B035	proc near		; CODE XREF: sub_40B25F+8Dp

var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		and	eax, 3
		test	eax, eax
		setz	al
		movzx	eax, al
		mov	[ebp+var_8], eax
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		imul	eax, 64h
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		test	eax, eax
		jnz	short loc_40B0A5
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 7
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		imul	eax, 190h
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		test	eax, eax
		jz	short loc_40B0A5
		mov	[ebp+var_8], 0

loc_40B0A5:				; CODE XREF: sub_40B035+3Dj
					; sub_40B035+67j
		cmp	[ebp+var_8], 0
		jz	short loc_40B0B2
		mov	eax, 16Eh
		jmp	short loc_40B0B7
; ---------------------------------------------------------------------------

loc_40B0B2:				; CODE XREF: sub_40B035+74j
		mov	eax, 16Dh

loc_40B0B7:				; CODE XREF: sub_40B035+7Bj
		add	esp, 10h
		pop	ebx
		pop	ebp
		retn
sub_40B035	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B0BD	proc near		; CODE XREF: sub_40B25F+105p
					; sub_40B25F+125p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		cmp	[ebp+arg_4], 0Ch
		ja	loc_40B194
		mov	eax, [ebp+arg_4]
		mov	edx, 1
		mov	ebx, edx
		mov	ecx, eax
		shl	ebx, cl
		mov	eax, ebx
		mov	edx, eax
		and	edx, 15AAh
		test	edx, edx
		jnz	short loc_40B106
		mov	edx, eax
		and	edx, 0A50h
		test	edx, edx
		jnz	loc_40B18D
		and	eax, 4
		test	eax, eax
		jnz	short loc_40B110
		jmp	loc_40B194
; ---------------------------------------------------------------------------

loc_40B106:				; CODE XREF: sub_40B0BD+2Bj
		mov	eax, 1Fh
		jmp	loc_40B1B0
; ---------------------------------------------------------------------------

loc_40B110:				; CODE XREF: sub_40B0BD+42j
		mov	eax, [ebp+arg_0]
		and	eax, 3
		test	eax, eax
		setz	al
		movzx	eax, al
		mov	[ebp+var_C], eax
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		imul	eax, 64h
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		test	eax, eax
		jnz	short loc_40B179
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 7
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		imul	eax, 190h
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		test	eax, eax
		jz	short loc_40B179
		mov	[ebp+var_C], 0

loc_40B179:				; CODE XREF: sub_40B0BD+89j
					; sub_40B0BD+B3j
		cmp	[ebp+var_C], 0
		jz	short loc_40B186
		mov	eax, 1Dh
		jmp	short loc_40B18B
; ---------------------------------------------------------------------------

loc_40B186:				; CODE XREF: sub_40B0BD+C0j
		mov	eax, 1Ch

loc_40B18B:				; CODE XREF: sub_40B0BD+C7j
		jmp	short loc_40B1B0
; ---------------------------------------------------------------------------

loc_40B18D:				; CODE XREF: sub_40B0BD+37j
		mov	eax, 1Eh
		jmp	short loc_40B1B0
; ---------------------------------------------------------------------------

loc_40B194:				; CODE XREF: sub_40B0BD+Bj
					; sub_40B0BD+44j
		mov	[esp+28h+var_20], offset aDays_per_month ; "days_per_month"
		mov	[esp+28h+var_24], 191h
		mov	[esp+28h+var_28], offset a____Gnupg22__1 ; "../../gnupg2-2.0.30/common/gettime.c"
		call	sub_411B8C
; ---------------------------------------------------------------------------

loc_40B1B0:				; CODE XREF: sub_40B0BD+4Ej
					; sub_40B0BD:loc_40B18Bj ...
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_40B0BD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B1B6	proc near		; CODE XREF: sub_40B25F+76p
					; sub_40B25F+E7p ...

var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		imul	ecx, eax, 16Dh
		mov	eax, [ebp+arg_4]
		lea	edx, [eax-1]
		mov	eax, edx
		shl	eax, 5
		sub	eax, edx
		add	eax, ecx
		add	eax, [ebp+arg_8]
		add	eax, 1A42E4h
		mov	[ebp+var_8], eax
		cmp	[ebp+arg_4], 2
		jg	short loc_40B1EC
		sub	[ebp+arg_0], 1
		jmp	short loc_40B20F
; ---------------------------------------------------------------------------

loc_40B1EC:				; CODE XREF: sub_40B1B6+2Ej
		mov	eax, [ebp+arg_4]
		shl	eax, 2
		lea	ecx, [eax+17h]
		mov	edx, 66666667h
		mov	eax, ecx
		imul	edx
		sar	edx, 2
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		sub	[ebp+var_8], eax

loc_40B20F:				; CODE XREF: sub_40B1B6+34j
		mov	eax, [ebp+arg_0]
		lea	edx, [eax+3]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 2
		mov	ebx, eax
		mov	ecx, [ebp+arg_0]
		mov	edx, 51EB851Fh
		mov	eax, ecx
		imul	edx
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		lea	edx, [eax+1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		lea	edx, [eax+3]
		test	eax, eax
		cmovs	eax, edx
		sar	eax, 2
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		add	[ebp+var_8], eax
		mov	eax, [ebp+var_8]
		add	esp, 10h
		pop	ebx
		pop	ebp
		retn
sub_40B1B6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B25F	proc near		; CODE XREF: .text:0040B804p
					; .text:0040BA78p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		cmp	[ebp+arg_0], 0
		jnz	short loc_40B275
		mov	eax, 0
		jmp	locret_40B3FB
; ---------------------------------------------------------------------------

loc_40B275:				; CODE XREF: sub_40B25F+Aj
		cmp	[ebp+arg_0], 1A4450h
		jbe	short loc_40B287
		cmp	[ebp+arg_0], 2B61CDh
		jbe	short loc_40B291

loc_40B287:				; CODE XREF: sub_40B25F+1Dj
		mov	eax, 0
		jmp	locret_40B3FB
; ---------------------------------------------------------------------------

loc_40B291:				; CODE XREF: sub_40B25F+26j
		mov	eax, [ebp+arg_0]
		sub	eax, 1A42E4h
		mov	[ebp+var_1C], eax
		mov	edx, 0B30F6353h
		mov	eax, [ebp+var_1C]
		mul	edx
		mov	eax, edx
		shr	eax, 8
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		jmp	short loc_40B2C1
; ---------------------------------------------------------------------------

loc_40B2BD:				; CODE XREF: sub_40B25F+95j
		add	[ebp+var_C], 1

loc_40B2C1:				; CODE XREF: sub_40B25F+5Cj
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_40B1B6
		mov	edx, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_40B035
		cmp	[ebp+var_18], eax
		jg	short loc_40B2BD
		mov	ecx, [ebp+var_18]
		mov	edx, 84210843h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 4
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_40B332
; ---------------------------------------------------------------------------

loc_40B31D:				; CODE XREF: sub_40B25F+10Dj
		add	[ebp+var_10], 1
		cmp	[ebp+var_10], 0Ch
		jle	short loc_40B332
		mov	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_40B332:				; CODE XREF: sub_40B25F+BCj
					; sub_40B25F+C6j
		mov	eax, [ebp+var_14]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_40B1B6
		mov	edx, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_40B0BD
		cmp	[ebp+var_18], eax
		jg	short loc_40B31D
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_40B0BD
		cmp	eax, [ebp+var_14]
		jge	short loc_40B399
		mov	[ebp+var_14], 1
		add	[ebp+var_10], 1

loc_40B399:				; CODE XREF: sub_40B25F+12Dj
		cmp	[ebp+var_10], 0Ch
		jle	short loc_40B3AA
		mov	[ebp+var_10], 1
		add	[ebp+var_C], 1

loc_40B3AA:				; CODE XREF: sub_40B25F+13Ej
		cmp	[ebp+arg_4], 0
		jz	short loc_40B3B8
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[eax], edx

loc_40B3B8:				; CODE XREF: sub_40B25F+14Fj
		cmp	[ebp+arg_8], 0
		jz	short loc_40B3C6
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_10]
		mov	[eax], edx

loc_40B3C6:				; CODE XREF: sub_40B25F+15Dj
		cmp	[ebp+arg_C], 0
		jz	short loc_40B3D4
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_14]
		mov	[eax], edx

loc_40B3D4:				; CODE XREF: sub_40B25F+16Bj
		mov	[esp+38h+var_30], 1
		mov	[esp+38h+var_34], 1
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	sub_40B1B6
		mov	edx, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1

locret_40B3FB:				; CODE XREF: sub_40B25F+11j
					; sub_40B25F+2Dj
		leave
		retn
sub_40B25F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40B3FD	proc near		; CODE XREF: .text:0040B540p
					; .text:0040B8A3p

var_14		= dword	ptr -14h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40B41E
		mov	[esp+14h+var_14], 1Ah
		call	sub_40A617
		jmp	locret_40B4B7
; ---------------------------------------------------------------------------

loc_40B41E:				; CODE XREF: sub_40B3FD+Ej
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	[ebp+var_4], 0
		jmp	short loc_40B457
; ---------------------------------------------------------------------------

loc_40B42D:				; CODE XREF: sub_40B3FD+5Ej
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40B441
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40B44F

loc_40B441:				; CODE XREF: sub_40B3FD+38j
		mov	[esp+14h+var_14], 0A1h
		call	sub_40A617
		jmp	short locret_40B4B7
; ---------------------------------------------------------------------------

loc_40B44F:				; CODE XREF: sub_40B3FD+42j
		add	[ebp+var_4], 1
		add	[ebp+var_8], 1

loc_40B457:				; CODE XREF: sub_40B3FD+2Ej
		cmp	[ebp+var_4], 7
		jle	short loc_40B42D
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 54h
		jz	short loc_40B475
		mov	[esp+14h+var_14], 0A1h
		call	sub_40A617
		jmp	short locret_40B4B7
; ---------------------------------------------------------------------------

loc_40B475:				; CODE XREF: sub_40B3FD+68j
		add	[ebp+var_8], 1
		mov	[ebp+var_4], 9
		jmp	short loc_40B4AC
; ---------------------------------------------------------------------------

loc_40B482:				; CODE XREF: sub_40B3FD+B3j
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40B496
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40B4A4

loc_40B496:				; CODE XREF: sub_40B3FD+8Dj
		mov	[esp+14h+var_14], 0A1h
		call	sub_40A617
		jmp	short locret_40B4B7
; ---------------------------------------------------------------------------

loc_40B4A4:				; CODE XREF: sub_40B3FD+97j
		add	[ebp+var_4], 1
		add	[ebp+var_8], 1

loc_40B4AC:				; CODE XREF: sub_40B3FD+83j
		cmp	[ebp+var_4], 0Eh
		jle	short loc_40B482
		mov	eax, 0

locret_40B4B7:				; CODE XREF: sub_40B3FD+1Cj
					; sub_40B3FD+50j ...
		leave
		retn
sub_40B3FD	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 20h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_40B4D1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40B4E7

loc_40B4D1:				; CODE XREF: .text:0040B4C5j
		mov	dword ptr [esp], offset	aNone ;	"[none]"
		call	sub_411114
		mov	[esp], eax
		call	sub_411AC4
		jmp	short loc_40B52C
; ---------------------------------------------------------------------------

loc_40B4E7:				; CODE XREF: .text:0040B4CFj
		mov	eax, [ebp+8]
		lea	esi, [eax+0Dh]
		mov	eax, [ebp+8]
		lea	ebx, [eax+0Bh]
		mov	eax, [ebp+8]
		lea	ecx, [eax+9]
		mov	eax, [ebp+8]
		lea	edx, [eax+6]
		mov	eax, [ebp+8]
		add	eax, 4
		mov	[esp+18h], esi
		mov	[esp+14h], ebx
		mov	[esp+10h], ecx
		mov	[esp+0Ch], edx
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a_4s_2s_2s_2s_2	; "%.4s-%.2s-%.2s %.2s:%.2s:%s"
		call	sub_411AC4

loc_40B52C:				; CODE XREF: .text:0040B4E5j
		add	esp, 20h
		pop	ebx
		pop	esi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 64h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40B3FD
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40B556
		mov	eax, [ebp-0Ch]
		jmp	loc_40B890
; ---------------------------------------------------------------------------

loc_40B556:				; CODE XREF: .text:0040B54Cj
		cmp	dword ptr [ebp+0Ch], 0
		js	short loc_40B565
		cmp	dword ptr [ebp+0Ch], 7FFFFFC1h
		jle	short loc_40B576

loc_40B565:				; CODE XREF: .text:0040B55Aj
		mov	dword ptr [esp], 37h
		call	sub_40A617
		jmp	loc_40B890
; ---------------------------------------------------------------------------

loc_40B576:				; CODE XREF: .text:0040B563j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 3E8h
		lea	edx, [eax-0BB80h]
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 64h
		sub	eax, 12C0h
		lea	ecx, [edx+eax]
		mov	eax, [ebp+8]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		add	eax, ecx
		mov	[ebp-24h], eax
		mov	eax, [ebp+8]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-28h], eax
		mov	eax, [ebp+8]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-2Ch], eax
		mov	eax, [ebp+8]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Ah
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		add	eax, 0Bh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Ch
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		add	eax, 0Dh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Eh
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-18h], eax
		mov	eax, [ebp-24h]
		cmp	eax, 62Eh
		jg	short loc_40B6D9
		mov	dword ptr [esp], 37h
		call	sub_40A617
		jmp	loc_40B890
; ---------------------------------------------------------------------------

loc_40B6D9:				; CODE XREF: .text:0040B6C6j
		mov	eax, [ebp+0Ch]
		add	[ebp-18h], eax
		mov	ecx, [ebp-18h]
		mov	edx, 88888889h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp-14h], eax
		mov	ecx, [ebp-18h]
		mov	edx, 88888889h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		shl	eax, 2
		mov	edx, eax
		shl	edx, 4
		sub	edx, eax
		mov	eax, ecx
		sub	eax, edx
		mov	[ebp-18h], eax
		mov	ecx, [ebp-14h]
		mov	edx, 88888889h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp-10h], eax
		mov	ecx, [ebp-14h]
		mov	edx, 88888889h
		mov	eax, ecx
		imul	edx
		lea	eax, [edx+ecx]
		mov	edx, eax
		sar	edx, 5
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		shl	eax, 2
		mov	edx, eax
		shl	edx, 4
		sub	edx, eax
		mov	eax, ecx
		sub	eax, edx
		mov	[ebp-14h], eax
		mov	ecx, [ebp-10h]
		mov	edx, 2AAAAAABh
		mov	eax, ecx
		imul	edx
		sar	edx, 2
		mov	eax, ecx
		sar	eax, 1Fh
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-1Ch], eax
		mov	ecx, [ebp-10h]
		mov	edx, 2AAAAAABh
		mov	eax, ecx
		imul	edx
		sar	edx, 2
		mov	eax, ecx
		sar	eax, 1Fh
		sub	edx, eax
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		mov	[ebp-10h], eax
		mov	ecx, [ebp-2Ch]
		mov	edx, [ebp-28h]
		mov	eax, [ebp-24h]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_40B1B6
		mov	edx, [ebp-1Ch]
		add	eax, edx
		mov	[ebp-20h], eax
		lea	eax, [ebp-2Ch]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-28h]
		mov	[esp+8], eax
		lea	eax, [ebp-24h]
		mov	[esp+4], eax
		mov	eax, [ebp-20h]
		mov	[esp], eax
		call	sub_40B25F
		mov	eax, [ebp-24h]
		cmp	eax, 270Fh
		jg	short loc_40B838
		mov	eax, [ebp-28h]
		cmp	eax, 0Ch
		jg	short loc_40B838
		mov	eax, [ebp-2Ch]
		cmp	eax, 1Fh
		jg	short loc_40B838
		mov	eax, [ebp-24h]
		test	eax, eax
		js	short loc_40B838
		mov	eax, [ebp-28h]
		test	eax, eax
		jle	short loc_40B838
		mov	eax, [ebp-2Ch]
		test	eax, eax
		jg	short loc_40B846

loc_40B838:				; CODE XREF: .text:0040B811j
					; .text:0040B819j ...
		mov	dword ptr [esp], 37h
		call	sub_40A617
		jmp	short loc_40B890
; ---------------------------------------------------------------------------

loc_40B846:				; CODE XREF: .text:0040B836j
		mov	ecx, [ebp-2Ch]
		mov	edx, [ebp-28h]
		mov	eax, [ebp-24h]
		mov	ebx, [ebp-18h]
		mov	[esp+20h], ebx
		mov	ebx, [ebp-14h]
		mov	[esp+1Ch], ebx
		mov	ebx, [ebp-10h]
		mov	[esp+18h], ebx
		mov	[esp+14h], ecx
		mov	[esp+10h], edx
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset a04d02d02dt02d0 ; "%04d%02d%02dT%02d%02d%02d"
		mov	dword ptr [esp+4], 10h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40F3D9
		mov	eax, 0

loc_40B890:				; CODE XREF: .text:0040B551j
					; .text:0040B571j ...
		add	esp, 64h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 54h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40B3FD
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40B8B9
		mov	eax, [ebp-0Ch]
		jmp	loc_40BB04
; ---------------------------------------------------------------------------

loc_40B8B9:				; CODE XREF: .text:0040B8AFj
		cmp	dword ptr [ebp+0Ch], 0
		js	short loc_40B8C8
		cmp	dword ptr [ebp+0Ch], 37D771h
		jle	short loc_40B8D9

loc_40B8C8:				; CODE XREF: .text:0040B8BDj
		mov	dword ptr [esp], 37h
		call	sub_40A617
		jmp	loc_40BB04
; ---------------------------------------------------------------------------

loc_40B8D9:				; CODE XREF: .text:0040B8C6j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 3E8h
		lea	edx, [eax-0BB80h]
		mov	eax, [ebp+8]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		imul	eax, 64h
		sub	eax, 12C0h
		lea	ecx, [edx+eax]
		mov	eax, [ebp+8]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 3
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		add	eax, ecx
		mov	[ebp-20h], eax
		mov	eax, [ebp+8]
		add	eax, 4
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 5
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-24h], eax
		mov	eax, [ebp+8]
		add	eax, 6
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 7
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-28h], eax
		mov	eax, [ebp+8]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Ah
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-10h], eax
		mov	eax, [ebp+8]
		add	eax, 0Bh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Ch
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-14h], eax
		mov	eax, [ebp+8]
		add	eax, 0Dh
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		lea	edx, [eax-1E0h]
		mov	eax, [ebp+8]
		add	eax, 0Eh
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp-18h], eax
		mov	eax, [ebp-20h]
		cmp	eax, 62Eh
		jg	short loc_40BA3C
		mov	dword ptr [esp], 37h
		call	sub_40A617
		jmp	loc_40BB04
; ---------------------------------------------------------------------------

loc_40BA3C:				; CODE XREF: .text:0040BA29j
		mov	ecx, [ebp-28h]
		mov	edx, [ebp-24h]
		mov	eax, [ebp-20h]
		mov	[esp+8], ecx
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_40B1B6
		mov	edx, [ebp+0Ch]
		add	eax, edx
		mov	[ebp-1Ch], eax
		lea	eax, [ebp-28h]
		mov	[esp+0Ch], eax
		lea	eax, [ebp-24h]
		mov	[esp+8], eax
		lea	eax, [ebp-20h]
		mov	[esp+4], eax
		mov	eax, [ebp-1Ch]
		mov	[esp], eax
		call	sub_40B25F
		mov	eax, [ebp-20h]
		cmp	eax, 270Fh
		jg	short loc_40BAAC
		mov	eax, [ebp-24h]
		cmp	eax, 0Ch
		jg	short loc_40BAAC
		mov	eax, [ebp-28h]
		cmp	eax, 1Fh
		jg	short loc_40BAAC
		mov	eax, [ebp-20h]
		test	eax, eax
		js	short loc_40BAAC
		mov	eax, [ebp-24h]
		test	eax, eax
		jle	short loc_40BAAC
		mov	eax, [ebp-28h]
		test	eax, eax
		jg	short loc_40BABA

loc_40BAAC:				; CODE XREF: .text:0040BA85j
					; .text:0040BA8Dj ...
		mov	dword ptr [esp], 37h
		call	sub_40A617
		jmp	short loc_40BB04
; ---------------------------------------------------------------------------

loc_40BABA:				; CODE XREF: .text:0040BAAAj
		mov	ecx, [ebp-28h]
		mov	edx, [ebp-24h]
		mov	eax, [ebp-20h]
		mov	ebx, [ebp-18h]
		mov	[esp+20h], ebx
		mov	ebx, [ebp-14h]
		mov	[esp+1Ch], ebx
		mov	ebx, [ebp-10h]
		mov	[esp+18h], ebx
		mov	[esp+14h], ecx
		mov	[esp+10h], edx
		mov	[esp+0Ch], eax
		mov	dword ptr [esp+8], offset a04d02d02dt02d0 ; "%04d%02d%02dT%02d%02d%02d"
		mov	dword ptr [esp+4], 10h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40F3D9
		mov	eax, 0

loc_40BB04:				; CODE XREF: .text:0040B8B4j
					; .text:0040B8D4j ...
		add	esp, 54h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40BB0C(LPCSTR)
sub_40BB0C	proc near		; CODE XREF: sub_40BB99+42p

lpLibFileName	= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+lpLibFileName], eax ; lpLibFileName
		mov	eax, ds:LoadLibraryA
		call	eax ; LoadLibraryA
		sub	esp, 4
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40BB0C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40BB2A(HMODULE, LPCSTR)
sub_40BB2A	proc near		; CODE XREF: sub_40BB99+5Ep

hModule		= dword	ptr -28h
lpProcName	= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jz	short loc_40BB68
		cmp	[ebp+arg_4], 0
		jz	short loc_40BB68
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+lpProcName], eax ; lpProcName
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+hModule], eax ; hModule
		mov	eax, ds:GetProcAddress
		call	eax ; GetProcAddress
		sub	esp, 8
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40BB63
		mov	eax, 0
		jmp	short locret_40BB6D
; ---------------------------------------------------------------------------

loc_40BB63:				; CODE XREF: sub_40BB2A+30j
		mov	eax, [ebp+var_C]
		jmp	short locret_40BB6D
; ---------------------------------------------------------------------------

loc_40BB68:				; CODE XREF: sub_40BB2A+Aj
					; sub_40BB2A+10j
		mov	eax, 0

locret_40BB6D:				; CODE XREF: sub_40BB2A+37j
					; sub_40BB2A+3Cj
		leave
		retn
sub_40BB2A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40BB6F(HANDLE)
sub_40BB6F	proc near		; CODE XREF: sub_40BB99+77p

hObject		= dword	ptr -18h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_40BB92
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+hObject], eax ; hObject
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4
		mov	eax, 0
		jmp	short locret_40BB97
; ---------------------------------------------------------------------------

loc_40BB92:				; CODE XREF: sub_40BB6F+Aj
		mov	eax, 0FFFFFFFFh

locret_40BB97:				; CODE XREF: sub_40BB6F+21j
		leave
		retn
sub_40BB6F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BB99	proc near		; CODE XREF: sub_40BC73+77p
					; sub_40C06D+5Ap ...

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, ds:dword_41D2F4
		test	eax, eax
		jnz	loc_40BC34
		mov	ds:dword_41D2F4, 1
		mov	[ebp+var_10], 0
		mov	[ebp+var_C], 0
		jmp	short loc_40BC20
; ---------------------------------------------------------------------------

loc_40BBC6:				; CODE XREF: sub_40BB99+99j
		mov	eax, [ebp+var_10]
		mov	eax, off_419170[eax*4]
		mov	[esp+38h+var_34], 0
		mov	[esp+38h+var_38], eax ;	LPCSTR
		call	sub_40BB0C
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40BC1C
		mov	[esp+38h+var_34], offset aShgetfolderpat ; "SHGetFolderPathA"
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax ;	HMODULE
		call	sub_40BB2A
		mov	ds:dword_41D2F8, eax
		mov	eax, ds:dword_41D2F8
		test	eax, eax
		jnz	short loc_40BC1C
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax ;	HANDLE
		call	sub_40BB6F
		mov	[ebp+var_C], 0

loc_40BC1C:				; CODE XREF: sub_40BB99+4Ej
					; sub_40BB99+6Fj
		add	[ebp+var_10], 1

loc_40BC20:				; CODE XREF: sub_40BB99+2Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_40BC34
		mov	eax, [ebp+var_10]
		mov	eax, off_419170[eax*4]
		test	eax, eax
		jnz	short loc_40BBC6

loc_40BC34:				; CODE XREF: sub_40BB99+Dj
					; sub_40BB99+8Bj
		mov	eax, ds:dword_41D2F8
		test	eax, eax
		jz	short loc_40BC6C
		mov	edx, ds:dword_41D2F8
		mov	eax, [ebp+arg_10]
		mov	[esp+38h+var_28], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	edx ; dword_41D2F8
		sub	esp, 14h
		jmp	short locret_40BC71
; ---------------------------------------------------------------------------

loc_40BC6C:				; CODE XREF: sub_40BB99+A2j
		mov	eax, 0FFFFFFFFh

locret_40BC71:				; CODE XREF: sub_40BB99+D1j
		leave
		retn
sub_40BB99	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BC73	proc near		; CODE XREF: .text:0040BDC1p
					; .text:0040BE5Fp

lpPathName	= dword	ptr -148h
lpSecurityAttributes= dword ptr	-144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_11C		= dword	ptr -11Ch
var_114		= byte ptr -114h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:lpPathName
		test	eax, eax
		jnz	loc_40BDA1
		call	sub_40BF40
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_41D180
		test	eax, eax
		jz	short loc_40BCC1
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+lpSecurityAttributes], offset	aHome ;	"\\home"
		mov	eax, [ebp+var_C]
		mov	[esp+148h+lpPathName], eax
		call	sub_4157B6
		mov	ds:lpPathName, eax
		jmp	loc_40BDA1
; ---------------------------------------------------------------------------

loc_40BCC1:				; CODE XREF: sub_40BC73+27j
		lea	eax, [ebp+var_114]
		mov	[esp+148h+var_138], eax
		mov	[esp+148h+var_13C], 0
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+lpSecurityAttributes], 801Ah
		mov	[esp+148h+lpPathName], 0
		call	sub_40BB99
		test	eax, eax
		js	loc_40BD97
		lea	eax, [ebp+var_114]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 7
		mov	[esp+148h+lpPathName], eax ; size_t
		call	sub_404CD4
		mov	[ebp+var_10], eax
		mov	ebx, offset aGnupg ; "\\gnupg"
		lea	eax, [ebp+var_114]
		mov	[esp+148h+lpSecurityAttributes], eax
		mov	eax, [ebp+var_10]
		mov	[esp+148h+lpPathName], eax
		call	sub_4152CD
		mov	edx, [ebx]
		mov	[eax], edx
		movzx	edx, word ptr [ebx+4]
		mov	[eax+4], dx
		movzx	edx, byte ptr [ebx+6]
		mov	[eax+6], dl
		mov	eax, [ebp+var_10]
		mov	ds:lpPathName, eax
		mov	eax, ds:lpPathName
		mov	[esp+148h+lpSecurityAttributes], 0
		mov	[esp+148h+lpPathName], eax
		call	_access
		test	eax, eax
		jz	short loc_40BDA1
		mov	eax, ds:lpPathName
		mov	[esp+148h+lpSecurityAttributes], 0 ; lpSecurityAttributes
		mov	[esp+148h+lpPathName], eax ; lpPathName
		mov	eax, ds:CreateDirectoryA
		call	eax ; CreateDirectoryA
		sub	esp, 8
		jmp	short loc_40BDA1
; ---------------------------------------------------------------------------

loc_40BD97:				; CODE XREF: sub_40BC73+7Ej
		mov	ds:lpPathName, offset aCGnupg ;	"c:/gnupg"

loc_40BDA1:				; CODE XREF: sub_40BC73+12j
					; sub_40BC73+49j ...
		mov	eax, ds:lpPathName
		lea	esp, [ebp-8]
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40BC73	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_40BF40
		mov	eax, ds:dword_41D180
		test	eax, eax
		jz	short loc_40BDCB
		call	sub_40BC73
		jmp	locret_40BE8B
; ---------------------------------------------------------------------------

loc_40BDCB:				; CODE XREF: .text:0040BDBFj
		mov	dword ptr [esp], offset	aGnupghome ; "GNUPGHOME"
		call	getenv
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40BDEE
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_40BE71

loc_40BDEE:				; CODE XREF: .text:0040BDDEj
		mov	eax, ds:dword_41D2EC
		test	eax, eax
		jnz	short loc_40BE69
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40BE07
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40BE56

loc_40BE07:				; CODE XREF: .text:0040BDFBj
		mov	dword ptr [esp+8], offset aHomedir ; "HomeDir"
		mov	dword ptr [esp+4], offset aSoftwareGnuGnu ; "Software\\GNU\\GnuPG"
		mov	dword ptr [esp], 0
		call	sub_416AAE
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_40BE48
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40BE48
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_404E31
		mov	dword ptr [ebp-10h], 0

loc_40BE48:				; CODE XREF: .text:0040BE2Aj
					; .text:0040BE34j
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_40BE56
		mov	eax, [ebp-10h]
		mov	ds:dword_41D2EC, eax

loc_40BE56:				; CODE XREF: .text:0040BE05j
					; .text:0040BE4Cj
		mov	eax, ds:dword_41D2EC
		test	eax, eax
		jnz	short loc_40BE69
		call	sub_40BC73
		mov	ds:dword_41D2EC, eax

loc_40BE69:				; CODE XREF: .text:0040BDF5j
					; .text:0040BE5Dj
		mov	eax, ds:dword_41D2EC
		mov	[ebp-0Ch], eax

loc_40BE71:				; CODE XREF: .text:0040BDE8j
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_40BE81
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40BE88

loc_40BE81:				; CODE XREF: .text:0040BE75j
		mov	dword ptr [ebp-0Ch], offset aCGnupg ; "c:/gnupg"

loc_40BE88:				; CODE XREF: .text:0040BE7Fj
		mov	eax, [ebp-0Ch]

locret_40BE8B:				; CODE XREF: .text:0040BDC6j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BE8D	proc near		; CODE XREF: sub_40BF40+91p

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	[esp+38h+var_30], 0
		mov	dword ptr [esp+38h+var_34], offset aGpgconf_exe	; "\\gpgconf.exe"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+var_38], eax
		call	sub_4157B6
		mov	[ebp+var_C], eax
		mov	dword ptr [esp+38h+var_34], 0
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	_access
		test	eax, eax
		jz	short loc_40BEDF
		mov	eax, [ebp+var_C]
		mov	dword ptr [esp+38h+var_34], eax	; char
		mov	[esp+38h+var_38], offset aRequiredBinary ; "required binary '%s' is not installed\n"
		call	sub_4119FD
		jmp	short loc_40BF2E
; ---------------------------------------------------------------------------

loc_40BEDF:				; CODE XREF: sub_40BE8D+3Bj
		mov	ebx, offset aCtl ; "ctl"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 3
		add	eax, [ebp+var_C]
		mov	edx, [ebx]
		mov	[eax], edx
		mov	dword ptr [esp+38h+var_34], 0
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax
		call	_access
		test	eax, eax
		jnz	short loc_40BF2E
		mov	ds:dword_41D180, 1

loc_40BF2E:				; CODE XREF: sub_40BE8D+50j
					; sub_40BE8D+95j
		mov	eax, [ebp+var_C]
		mov	[esp+38h+var_38], eax ;	void *
		call	sub_404E31
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40BE8D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40BF40	proc near		; CODE XREF: sub_40BC73+18p
					; .text:0040BDB3p ...

hModule		= dword	ptr -28h
lpFilename	= dword	ptr -24h
nSize		= dword	ptr -20h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, ds:dword_41D1CC
		test	eax, eax
		jnz	loc_40C04F
		mov	[esp+28h+nSize], 104h ;	nSize
		mov	[esp+28h+lpFilename], offset byte_41D1E0 ; lpFilename
		mov	[esp+28h+hModule], 0 ; hModule
		mov	eax, ds:GetModuleFileNameA
		call	eax ; GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jnz	short loc_40BF9D
		mov	[esp+28h+hModule], 0 ; DWORD
		call	sub_414F2A
		mov	[esp+28h+lpFilename], eax ; char
		mov	[esp+28h+hModule], offset aGetmodulefilen ; "GetModuleFileName failed: %s\n"
		call	sub_411A9A
		mov	ds:byte_41D1E0,	0

loc_40BF9D:				; CODE XREF: sub_40BF40+38j
		mov	ds:dword_41D1CC, 1
		mov	[esp+28h+lpFilename], 5Ch ; Ch
		mov	[esp+28h+hModule], offset byte_41D1E0 ;	Str
		call	strrchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40C02E
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	[esp+28h+hModule], offset byte_41D1E0
		call	sub_40BE8D
		mov	[esp+28h+lpFilename], 5Ch ; Ch
		mov	[esp+28h+hModule], offset byte_41D1E0 ;	Str
		call	strrchr
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40C02E
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	edx, eax
		mov	eax, offset aBin ; "bin"
		mov	ecx, 4
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_40C02E
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0
		mov	ds:dword_41D184, 1

loc_40C02E:				; CODE XREF: sub_40BF40+82j
					; sub_40BF40+B1j ...
		cmp	[ebp+var_C], 0
		jnz	short loc_40C04F
		mov	[esp+28h+lpFilename], offset byte_41D1E0 ; char
		mov	[esp+28h+hModule], offset aBadFilenameSRe ; "bad filename `%s' returned for this pro"...
		call	sub_411A9A
		mov	ds:byte_41D1E0,	0

loc_40C04F:				; CODE XREF: sub_40BF40+Fj
					; sub_40BF40+F2j
		movzx	eax, ds:byte_41D1E0
		test	al, al
		jz	short loc_40C061
		mov	eax, offset byte_41D1E0
		jmp	short loc_40C066
; ---------------------------------------------------------------------------

loc_40C061:				; CODE XREF: sub_40BF40+118j
		mov	eax, offset aCGnupg_0 ;	"c:\\gnupg"

loc_40C066:				; CODE XREF: sub_40BF40+11Fj
		lea	esp, [ebp-8]
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_40BF40	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C06D	proc near		; CODE XREF: .text:0040C169p

var_148		= dword	ptr -148h
var_144		= dword	ptr -144h
var_140		= dword	ptr -140h
var_13C		= dword	ptr -13Ch
var_138		= dword	ptr -138h
var_11C		= dword	ptr -11Ch
var_114		= byte ptr -114h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:dword_41D1C8
		test	eax, eax
		jnz	loc_40C145
		call	sub_40BF40
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_41D180
		test	eax, eax
		jz	short loc_40C09E
		mov	eax, [ebp+var_C]
		jmp	loc_40C14A
; ---------------------------------------------------------------------------

loc_40C09E:				; CODE XREF: sub_40C06D+27j
		lea	eax, [ebp+var_114]
		mov	[esp+148h+var_138], eax
		mov	[esp+148h+var_13C], 0
		mov	[esp+148h+var_140], 0
		mov	[esp+148h+var_144], 23h
		mov	[esp+148h+var_148], 0
		call	sub_40BB99
		test	eax, eax
		js	short loc_40C135
		lea	eax, [ebp+var_114]
		mov	[ebp+var_11C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_11C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 5
		mov	[esp+148h+var_148], eax	; size_t
		call	sub_404CD4
		mov	[ebp+var_10], eax
		mov	ebx, offset aGnu ; "\\GNU"
		lea	eax, [ebp+var_114]
		mov	[esp+148h+var_144], eax
		mov	eax, [ebp+var_10]
		mov	[esp+148h+var_148], eax
		call	sub_4152CD
		mov	edx, [ebx]
		mov	[eax], edx
		movzx	edx, byte ptr [ebx+4]
		mov	[eax+4], dl
		mov	eax, [ebp+var_10]
		mov	ds:dword_41D1C8, eax
		jmp	short loc_40C145
; ---------------------------------------------------------------------------

loc_40C135:				; CODE XREF: sub_40C06D+61j
		mov	eax, [ebp+var_C]
		mov	[esp+148h+var_148], eax	; char *
		call	sub_404DD7
		mov	ds:dword_41D1C8, eax

loc_40C145:				; CODE XREF: sub_40C06D+12j
					; sub_40C06D+C6j
		mov	eax, ds:dword_41D1C8

loc_40C14A:				; CODE XREF: sub_40C06D+2Cj
		add	esp, 140h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40C06D	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_41D1C4
		test	eax, eax
		jnz	loc_40C1EB
		call	sub_40C06D
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aEtcGnupg ;	"\\etc\\gnupg"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	sub_404CD4
		mov	ds:dword_41D1C4, eax
		mov	eax, ds:dword_41D1C4
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_4152CD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_40C1EB:				; CODE XREF: .text:0040C163j
		mov	eax, ds:dword_41D1C4
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C1F7	proc near		; CODE XREF: sub_40C243+6p
					; .text:0040C570p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		call	sub_40BF40
		mov	[ebp+var_C], eax
		mov	eax, ds:dword_41D184
		test	eax, eax
		jz	short loc_40C23E
		mov	eax, ds:dword_41D1C0
		test	eax, eax
		jnz	short loc_40C237
		mov	[esp+28h+var_20], 0
		mov	[esp+28h+var_24], offset aBin_0	; "\\bin"
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax
		call	sub_4157B6
		mov	ds:dword_41D1C0, eax

loc_40C237:				; CODE XREF: sub_40C1F7+1Ej
		mov	eax, ds:dword_41D1C0
		jmp	short locret_40C241
; ---------------------------------------------------------------------------

loc_40C23E:				; CODE XREF: sub_40C1F7+15j
		mov	eax, [ebp+var_C]

locret_40C241:				; CODE XREF: sub_40C1F7+45j
		leave
		retn
sub_40C1F7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C243	proc near		; CODE XREF: .text:0040C6A2p
					; .text:0040C7D4p ...
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		call	sub_40C1F7
		leave
		retn
sub_40C243	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_41D1BC
		test	eax, eax
		jnz	loc_40C2E7
		call	sub_40BF40
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aLibGnupg ;	"\\lib\\gnupg"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	sub_404CD4
		mov	ds:dword_41D1BC, eax
		mov	eax, ds:dword_41D1BC
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_4152CD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_40C2E7:				; CODE XREF: .text:0040C25Fj
		mov	eax, ds:dword_41D1BC
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_41D1B8
		test	eax, eax
		jnz	loc_40C38A
		call	sub_40BF40
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aShareGnupg	; "\\share\\gnupg"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	sub_404CD4
		mov	ds:dword_41D1B8, eax
		mov	eax, ds:dword_41D1B8
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_4152CD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_40C38A:				; CODE XREF: .text:0040C302j
		mov	eax, ds:dword_41D1B8
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40C396	proc near		; CODE XREF: sub_405474+6p

Dest		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		mov	eax, ds:dword_41D1B4
		test	eax, eax
		jnz	loc_40C42D
		call	sub_40BF40
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], offset aShareLocale ; "\\share\\locale"
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+var_10]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp+38h+Dest],	eax ; size_t
		call	sub_404CD4
		mov	ds:dword_41D1B4, eax
		mov	eax, ds:dword_41D1B4
		mov	edx, [ebp+var_C]
		mov	[esp+38h+Source], edx
		mov	[esp+38h+Dest],	eax
		call	sub_4152CD
		mov	edx, [ebp+var_10]
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+Dest],	eax ; Dest
		call	strcpy

loc_40C42D:				; CODE XREF: sub_40C396+Fj
		mov	eax, ds:dword_41D1B4
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40C396	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 140h
		mov	eax, ds:dword_41D1B0
		test	eax, eax
		jnz	loc_40C533
		lea	eax, [ebp-110h]
		mov	[esp+10h], eax
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 24h
		mov	dword ptr [esp], 0
		call	sub_40BB99
		test	eax, eax
		jns	short loc_40C4A7
		mov	edx, offset aCWindows ;	"C:\\WINDOWS"
		lea	eax, [ebp-110h]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		movzx	ecx, word ptr [edx+8]
		mov	[eax+8], cx
		movzx	edx, byte ptr [edx+0Ah]
		mov	[eax+0Ah], dl

loc_40C4A7:				; CODE XREF: .text:0040C481j
		mov	dword ptr [ebp-0Ch], offset aS_dirmngr ; "\\S.dirmngr"
		lea	eax, [ebp-110h]
		mov	dword ptr [ebp-11Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-11Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-11Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-11Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	sub_404CD4
		mov	ds:dword_41D1B0, eax
		mov	eax, ds:dword_41D1B0
		lea	edx, [ebp-110h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_4152CD
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_40C533:				; CODE XREF: .text:0040C44Bj
		mov	eax, ds:dword_41D1B0
		add	esp, 140h
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 30h
		cmp	dword ptr [ebp+8], 0Ah ; switch	11 cases
		ja	loc_40CB5A	; jumptable 0040C561 default case
		mov	eax, [ebp+8]
		shl	eax, 2
		add	eax, offset off_41B130
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40C563:				; CODE XREF: .text:0040C561j
					; DATA XREF: .rdata:off_41B130o
		mov	eax, ds:dword_41D188 ; jumptable 0040C561 case 1
		test	eax, eax
		jnz	loc_40C5F2
		call	sub_40C1F7
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aGpgAgent_exe ; "\\gpg-agent.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	sub_404CD4
		mov	ds:dword_41D188, eax
		mov	eax, ds:dword_41D188
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_4152CD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_40C5F2:				; CODE XREF: .text:0040C56Aj
		mov	eax, ds:dword_41D188
		jmp	loc_40CB76
; ---------------------------------------------------------------------------

loc_40C5FC:				; CODE XREF: .text:0040C561j
					; DATA XREF: .rdata:off_41B130o
		mov	eax, ds:dword_41D18C ; jumptable 0040C561 case 2
		test	eax, eax
		jnz	loc_40C68B
		call	sub_40C1F7
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aPinentry_exe ; "\\pinentry.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	sub_404CD4
		mov	ds:dword_41D18C, eax
		mov	eax, ds:dword_41D18C
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_4152CD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_40C68B:				; CODE XREF: .text:0040C603j
		mov	eax, ds:dword_41D18C
		jmp	loc_40CB76
; ---------------------------------------------------------------------------

loc_40C695:				; CODE XREF: .text:0040C561j
					; DATA XREF: .rdata:off_41B130o
		mov	eax, ds:dword_41D190 ; jumptable 0040C561 case 3
		test	eax, eax
		jnz	loc_40C724
		call	sub_40C243
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aScdaemon_exe ; "\\scdaemon.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	sub_404CD4
		mov	ds:dword_41D190, eax
		mov	eax, ds:dword_41D190
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_4152CD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_40C724:				; CODE XREF: .text:0040C69Cj
		mov	eax, ds:dword_41D190
		jmp	loc_40CB76
; ---------------------------------------------------------------------------

loc_40C72E:				; CODE XREF: .text:0040C561j
					; DATA XREF: .rdata:off_41B130o
		mov	eax, ds:dword_41D194 ; jumptable 0040C561 case 4
		test	eax, eax
		jnz	loc_40C7BD
		call	sub_40C1F7
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aDirmngr_exe ; "\\dirmngr.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	sub_404CD4
		mov	ds:dword_41D194, eax
		mov	eax, ds:dword_41D194
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_4152CD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_40C7BD:				; CODE XREF: .text:0040C735j
		mov	eax, ds:dword_41D194
		jmp	loc_40CB76
; ---------------------------------------------------------------------------

loc_40C7C7:				; CODE XREF: .text:0040C561j
					; DATA XREF: .rdata:off_41B130o
		mov	eax, ds:dword_41D198 ; jumptable 0040C561 case 5
		test	eax, eax
		jnz	loc_40C856
		call	sub_40C243
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aGpgProtectTool ; "\\gpg-protect-tool.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	sub_404CD4
		mov	ds:dword_41D198, eax
		mov	eax, ds:dword_41D198
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_4152CD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_40C856:				; CODE XREF: .text:0040C7CEj
		mov	eax, ds:dword_41D198
		jmp	loc_40CB76
; ---------------------------------------------------------------------------

loc_40C860:				; CODE XREF: .text:0040C561j
					; DATA XREF: .rdata:off_41B130o
		mov	eax, ds:dword_41D19C ; jumptable 0040C561 case 6
		test	eax, eax
		jnz	loc_40C8EF
		call	sub_40C243
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aGpgCheckPatter ; "\\gpg-check-pattern.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	sub_404CD4
		mov	ds:dword_41D19C, eax
		mov	eax, ds:dword_41D19C
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_4152CD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_40C8EF:				; CODE XREF: .text:0040C867j
		mov	eax, ds:dword_41D19C
		jmp	loc_40CB76
; ---------------------------------------------------------------------------

loc_40C8F9:				; CODE XREF: .text:0040C561j
					; DATA XREF: .rdata:off_41B130o
		mov	eax, ds:dword_41D1A0 ; jumptable 0040C561 case 7
		test	eax, eax
		jnz	loc_40C988
		call	sub_40C1F7
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aGpgsm_exe ; "\\gpgsm.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	sub_404CD4
		mov	ds:dword_41D1A0, eax
		mov	eax, ds:dword_41D1A0
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_4152CD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_40C988:				; CODE XREF: .text:0040C900j
		mov	eax, ds:dword_41D1A0
		jmp	loc_40CB76
; ---------------------------------------------------------------------------

loc_40C992:				; CODE XREF: .text:0040C561j
					; DATA XREF: .rdata:off_41B130o
		mov	eax, ds:dword_41D1A4 ; jumptable 0040C561 case 8
		test	eax, eax
		jnz	loc_40CA21
		call	sub_40C1F7
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aGpg2_exe ;	"\\gpg2.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	sub_404CD4
		mov	ds:dword_41D1A4, eax
		mov	eax, ds:dword_41D1A4
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_4152CD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_40CA21:				; CODE XREF: .text:0040C999j
		mov	eax, ds:dword_41D1A4
		jmp	loc_40CB76
; ---------------------------------------------------------------------------

loc_40CA2B:				; CODE XREF: .text:0040C561j
					; DATA XREF: .rdata:off_41B130o
		mov	eax, ds:dword_41D1A8 ; jumptable 0040C561 case 9
		test	eax, eax
		jnz	loc_40CABA
		call	sub_40C1F7
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aGpgConnectAgen ; "\\gpg-connect-agent.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	sub_404CD4
		mov	ds:dword_41D1A8, eax
		mov	eax, ds:dword_41D1A8
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_4152CD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_40CABA:				; CODE XREF: .text:0040CA32j
		mov	eax, ds:dword_41D1A8
		jmp	loc_40CB76
; ---------------------------------------------------------------------------

loc_40CAC4:				; CODE XREF: .text:0040C561j
					; DATA XREF: .rdata:off_41B130o
		mov	eax, ds:dword_41D1AC ; jumptable 0040C561 case 10
		test	eax, eax
		jnz	loc_40CB53
		call	sub_40C1F7
		mov	[ebp-0Ch], eax
		mov	dword ptr [ebp-10h], offset aGpgconf_exe ; "\\gpgconf.exe"
		mov	eax, [ebp-0Ch]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp-10h]
		mov	dword ptr [ebp-1Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-1Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 1
		mov	[esp], eax
		call	sub_404CD4
		mov	ds:dword_41D1AC, eax
		mov	eax, ds:dword_41D1AC
		mov	edx, [ebp-0Ch]
		mov	[esp+4], edx
		mov	[esp], eax
		call	sub_4152CD
		mov	edx, [ebp-10h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	strcpy

loc_40CB53:				; CODE XREF: .text:0040CACBj
		mov	eax, ds:dword_41D1AC
		jmp	short loc_40CB76
; ---------------------------------------------------------------------------

loc_40CB5A:				; CODE XREF: .text:0040C54Ej
					; .text:0040C561j
					; DATA XREF: ...
		mov	dword ptr [esp+8], offset aGnupg_module_n ; jumptable 0040C561 default case
		mov	dword ptr [esp+4], 229h
		mov	dword ptr [esp], offset	a____Gnupg22__2	; "../../gnupg2-2.0.30/common/homedir.c"
		call	sub_411B8C
; ---------------------------------------------------------------------------

loc_40CB76:				; CODE XREF: .text:0040C5F7j
					; .text:0040C690j ...
		add	esp, 30h
		pop	ebx
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CB80	proc near		; CODE XREF: sub_40CD81+6E9p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 12h	; switch 19 cases
		ja	loc_40CD7F	; jumptable 0040CB99 default case
		mov	eax, ds:off_41B188[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40CB9B:				; CODE XREF: sub_40CB80+19j
					; DATA XREF: .rdata:off_41B188o
		mov	eax, [ebp+arg_0] ; jumptable 0040CB99 case 0
		mov	dword ptr [eax+24h], 0
		jmp	loc_40CD7F	; jumptable 0040CB99 default case
; ---------------------------------------------------------------------------

loc_40CBAA:				; CODE XREF: sub_40CB80+19j
					; DATA XREF: .rdata:off_41B188o
		mov	eax, [ebp+arg_0] ; jumptable 0040CB99 case 1
		mov	eax, [eax+10h]
		cmp	eax, 7		; switch 8 cases
		ja	short loc_40CC12 ; jumptable 0040CBBC default case
		mov	eax, ds:off_41B1D4[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40CBBE:				; CODE XREF: sub_40CB80+3Cj
					; DATA XREF: .rdata:off_41B1D4o
		mov	eax, [ebp+arg_0] ; jumptable 0040CBBC case 1
		mov	dword ptr [eax+24h], 2
		jmp	short loc_40CC1D
; ---------------------------------------------------------------------------

loc_40CBCA:				; CODE XREF: sub_40CB80+3Cj
					; DATA XREF: .rdata:off_41B1D4o
		mov	eax, [ebp+arg_0] ; jumptable 0040CBBC case 2
		mov	dword ptr [eax+24h], 4
		jmp	short loc_40CC1D
; ---------------------------------------------------------------------------

loc_40CBD6:				; CODE XREF: sub_40CB80+3Cj
					; DATA XREF: .rdata:off_41B1D4o
		mov	eax, [ebp+arg_0] ; jumptable 0040CBBC case 3
		mov	dword ptr [eax+24h], 8
		jmp	short loc_40CC1D
; ---------------------------------------------------------------------------

loc_40CBE2:				; CODE XREF: sub_40CB80+3Cj
					; DATA XREF: .rdata:off_41B1D4o
		mov	eax, [ebp+arg_0] ; jumptable 0040CBBC case 4
		mov	dword ptr [eax+24h], 0Ah
		jmp	short loc_40CC1D
; ---------------------------------------------------------------------------

loc_40CBEE:				; CODE XREF: sub_40CB80+3Cj
					; DATA XREF: .rdata:off_41B1D4o
		mov	eax, [ebp+arg_0] ; jumptable 0040CBBC case 5
		mov	dword ptr [eax+24h], 0Fh
		jmp	short loc_40CC1D
; ---------------------------------------------------------------------------

loc_40CBFA:				; CODE XREF: sub_40CB80+3Cj
					; DATA XREF: .rdata:off_41B1D4o
		mov	eax, [ebp+arg_0] ; jumptable 0040CBBC case 6
		mov	dword ptr [eax+24h], 11h
		jmp	short loc_40CC1D
; ---------------------------------------------------------------------------

loc_40CC06:				; CODE XREF: sub_40CB80+3Cj
					; DATA XREF: .rdata:off_41B1D4o
		mov	eax, [ebp+arg_0] ; jumptable 0040CBBC case 7
		mov	dword ptr [eax+24h], 12h
		jmp	short loc_40CC1D
; ---------------------------------------------------------------------------

loc_40CC12:				; CODE XREF: sub_40CB80+33j
					; sub_40CB80+3Cj
					; DATA XREF: ...
		mov	eax, [ebp+arg_0] ; jumptable 0040CBBC default case
		mov	dword ptr [eax+24h], 6
		nop

loc_40CC1D:				; CODE XREF: sub_40CB80+48j
					; sub_40CB80+54j ...
		jmp	loc_40CD7F	; jumptable 0040CB99 default case
; ---------------------------------------------------------------------------

loc_40CC22:				; CODE XREF: sub_40CB80+19j
					; DATA XREF: .rdata:off_41B188o
		mov	eax, [ebp+arg_0] ; jumptable 0040CB99 cases 2-5
		mov	eax, [eax+10h]
		cmp	eax, 7		; switch 8 cases
		ja	short loc_40CC8A ; jumptable 0040CC34 default case
		mov	eax, ds:off_41B1F4[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40CC36:				; CODE XREF: sub_40CB80+B4j
					; DATA XREF: .rdata:off_41B1F4o
		mov	eax, [ebp+arg_0] ; jumptable 0040CC34 case 1
		mov	dword ptr [eax+24h], 3
		jmp	short loc_40CC95
; ---------------------------------------------------------------------------

loc_40CC42:				; CODE XREF: sub_40CB80+B4j
					; DATA XREF: .rdata:off_41B1F4o
		mov	eax, [ebp+arg_0] ; jumptable 0040CC34 case 2
		mov	dword ptr [eax+24h], 5
		jmp	short loc_40CC95
; ---------------------------------------------------------------------------

loc_40CC4E:				; CODE XREF: sub_40CB80+B4j
					; DATA XREF: .rdata:off_41B1F4o
		mov	eax, [ebp+arg_0] ; jumptable 0040CC34 case 3
		mov	dword ptr [eax+24h], 9
		jmp	short loc_40CC95
; ---------------------------------------------------------------------------

loc_40CC5A:				; CODE XREF: sub_40CB80+B4j
					; DATA XREF: .rdata:off_41B1F4o
		mov	eax, [ebp+arg_0] ; jumptable 0040CC34 case 4
		mov	dword ptr [eax+24h], 0Bh
		jmp	short loc_40CC95
; ---------------------------------------------------------------------------

loc_40CC66:				; CODE XREF: sub_40CB80+B4j
					; DATA XREF: .rdata:off_41B1F4o
		mov	eax, [ebp+arg_0] ; jumptable 0040CC34 case 5
		mov	dword ptr [eax+24h], 10h
		jmp	short loc_40CC95
; ---------------------------------------------------------------------------

loc_40CC72:				; CODE XREF: sub_40CB80+B4j
					; DATA XREF: .rdata:off_41B1F4o
		mov	eax, [ebp+arg_0] ; jumptable 0040CC34 case 6
		mov	dword ptr [eax+24h], 11h
		jmp	short loc_40CC95
; ---------------------------------------------------------------------------

loc_40CC7E:				; CODE XREF: sub_40CB80+B4j
					; DATA XREF: .rdata:off_41B1F4o
		mov	eax, [ebp+arg_0] ; jumptable 0040CC34 case 7
		mov	dword ptr [eax+24h], 12h
		jmp	short loc_40CC95
; ---------------------------------------------------------------------------

loc_40CC8A:				; CODE XREF: sub_40CB80+ABj
					; sub_40CB80+B4j
					; DATA XREF: ...
		mov	eax, [ebp+arg_0] ; jumptable 0040CC34 default case
		mov	dword ptr [eax+24h], 7
		nop

loc_40CC95:				; CODE XREF: sub_40CB80+C0j
					; sub_40CB80+CCj ...
		jmp	loc_40CD7F	; jumptable 0040CB99 default case
; ---------------------------------------------------------------------------

loc_40CC9A:				; CODE XREF: sub_40CB80+19j
					; DATA XREF: .rdata:off_41B188o
		mov	eax, [ebp+arg_0] ; jumptable 0040CB99 cases 6-13
		mov	eax, [eax+10h]
		cmp	eax, 3
		jz	short loc_40CCB6
		cmp	eax, 8
		jnz	short loc_40CCC2
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0Dh
		jmp	short loc_40CCCD
; ---------------------------------------------------------------------------

loc_40CCB6:				; CODE XREF: sub_40CB80+123j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0Ch
		jmp	short loc_40CCCD
; ---------------------------------------------------------------------------

loc_40CCC2:				; CODE XREF: sub_40CB80+128j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0Ch
		nop

loc_40CCCD:				; CODE XREF: sub_40CB80+134j
					; sub_40CB80+140j
		jmp	loc_40CD7F	; jumptable 0040CB99 default case
; ---------------------------------------------------------------------------

loc_40CCD2:				; CODE XREF: sub_40CB80+19j
					; DATA XREF: .rdata:off_41B188o
		mov	eax, [ebp+arg_0] ; jumptable 0040CB99 case 14
		mov	dword ptr [eax+24h], 6
		jmp	loc_40CD7F	; jumptable 0040CB99 default case
; ---------------------------------------------------------------------------

loc_40CCE1:				; CODE XREF: sub_40CB80+19j
					; DATA XREF: .rdata:off_41B188o
		mov	eax, [ebp+arg_0] ; jumptable 0040CB99 case 15
		mov	dword ptr [eax+24h], 0Eh
		jmp	loc_40CD7F	; jumptable 0040CB99 default case
; ---------------------------------------------------------------------------

loc_40CCF0:				; CODE XREF: sub_40CB80+19j
					; DATA XREF: .rdata:off_41B188o
		mov	eax, [ebp+arg_0] ; jumptable 0040CB99 case 16
		mov	dword ptr [eax+24h], 13h
		jmp	loc_40CD7F	; jumptable 0040CB99 default case
; ---------------------------------------------------------------------------

loc_40CCFF:				; CODE XREF: sub_40CB80+19j
					; DATA XREF: .rdata:off_41B188o
		mov	eax, [ebp+arg_0] ; jumptable 0040CB99 case 17
		mov	dword ptr [eax+24h], 0Eh
		jmp	short loc_40CD7F ; jumptable 0040CB99 default case
; ---------------------------------------------------------------------------

loc_40CD0B:				; CODE XREF: sub_40CB80+19j
					; DATA XREF: .rdata:off_41B188o
		mov	eax, [ebp+arg_0] ; jumptable 0040CB99 case 18
		mov	eax, [eax+10h]
		cmp	eax, 7		; switch 8 cases
		ja	short loc_40CD73 ; jumptable 0040CD1D default case
		mov	eax, ds:off_41B214[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40CD1F:				; CODE XREF: sub_40CB80+19Dj
					; DATA XREF: .rdata:off_41B214o
		mov	eax, [ebp+arg_0] ; jumptable 0040CD1D case 1
		mov	dword ptr [eax+24h], 15h
		jmp	short loc_40CD7E
; ---------------------------------------------------------------------------

loc_40CD2B:				; CODE XREF: sub_40CB80+19Dj
					; DATA XREF: .rdata:off_41B214o
		mov	eax, [ebp+arg_0] ; jumptable 0040CD1D case 2
		mov	dword ptr [eax+24h], 16h
		jmp	short loc_40CD7E
; ---------------------------------------------------------------------------

loc_40CD37:				; CODE XREF: sub_40CB80+19Dj
					; DATA XREF: .rdata:off_41B214o
		mov	eax, [ebp+arg_0] ; jumptable 0040CD1D case 3
		mov	dword ptr [eax+24h], 18h
		jmp	short loc_40CD7E
; ---------------------------------------------------------------------------

loc_40CD43:				; CODE XREF: sub_40CB80+19Dj
					; DATA XREF: .rdata:off_41B214o
		mov	eax, [ebp+arg_0] ; jumptable 0040CD1D case 4
		mov	dword ptr [eax+24h], 19h
		jmp	short loc_40CD7E
; ---------------------------------------------------------------------------

loc_40CD4F:				; CODE XREF: sub_40CB80+19Dj
					; DATA XREF: .rdata:off_41B214o
		mov	eax, [ebp+arg_0] ; jumptable 0040CD1D case 5
		mov	dword ptr [eax+24h], 1Ah
		jmp	short loc_40CD7E
; ---------------------------------------------------------------------------

loc_40CD5B:				; CODE XREF: sub_40CB80+19Dj
					; DATA XREF: .rdata:off_41B214o
		mov	eax, [ebp+arg_0] ; jumptable 0040CD1D case 6
		mov	dword ptr [eax+24h], 1Bh
		jmp	short loc_40CD7E
; ---------------------------------------------------------------------------

loc_40CD67:				; CODE XREF: sub_40CB80+19Dj
					; DATA XREF: .rdata:off_41B214o
		mov	eax, [ebp+arg_0] ; jumptable 0040CD1D case 7
		mov	dword ptr [eax+24h], 1Ch
		jmp	short loc_40CD7E
; ---------------------------------------------------------------------------

loc_40CD73:				; CODE XREF: sub_40CB80+194j
					; sub_40CB80+19Dj
					; DATA XREF: ...
		mov	eax, [ebp+arg_0] ; jumptable 0040CD1D default case
		mov	dword ptr [eax+24h], 17h
		nop

loc_40CD7E:				; CODE XREF: sub_40CB80+1A9j
					; sub_40CB80+1B5j ...
		nop

loc_40CD7F:				; CODE XREF: sub_40CB80+Cj
					; sub_40CB80+25j ...
		pop	ebp		; jumptable 0040CB99 default case
		retn
sub_40CB80	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40CD81	proc near		; CODE XREF: sub_40EBCB+58p

NumOfElements	= dword	ptr -68h
SizeOfElements	= dword	ptr -64h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Memory		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 68h
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		mov	[ebp+Memory], eax
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_0], 0
		jnz	loc_40D485
		jmp	loc_40D4C4
; ---------------------------------------------------------------------------

loc_40CDA5:				; CODE XREF: sub_40CD81+70Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	loc_40D47B
		add	[ebp+arg_0], 1
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_40D4AB
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	loc_40D47E
		mov	[ebp+var_2C], 0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jle	loc_40CE71
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40CE71
		mov	eax, [ebp+var_C]
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_2C], eax
		add	[ebp+var_C], 1
		jmp	short loc_40CE36
; ---------------------------------------------------------------------------

loc_40CE13:				; CODE XREF: sub_40CD81+C7j
		mov	edx, [ebp+var_2C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_2C], eax
		add	[ebp+var_C], 1

loc_40CE36:				; CODE XREF: sub_40CD81+90j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40CE4A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40CE13

loc_40CE4A:				; CODE XREF: sub_40CD81+BDj
		cmp	[ebp+var_2C], 0
		js	loc_40D4AE
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	short loc_40CE64
		add	[ebp+var_C], 1
		jmp	short loc_40CE71
; ---------------------------------------------------------------------------

loc_40CE64:				; CODE XREF: sub_40CD81+DBj
		mov	[ebp+var_2C], 0
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_C], eax

loc_40CE71:				; CODE XREF: sub_40CD81+67j
					; sub_40CD81+75j ...
		mov	[ebp+var_18], 0
		jmp	short loc_40CEBB
; ---------------------------------------------------------------------------

loc_40CE7A:				; CODE XREF: sub_40CD81+142j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 20h	; switch 17 cases
		cmp	eax, 10h
		ja	short loc_40CEC7 ; jumptable 0040CE92 default case
		mov	eax, ds:off_41B234[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40CE94:				; CODE XREF: sub_40CD81+111j
					; DATA XREF: .rdata:off_41B234o
		or	[ebp+var_18], 1	; jumptable 0040CE92 case 39
		jmp	short loc_40CEB7
; ---------------------------------------------------------------------------

loc_40CE9A:				; CODE XREF: sub_40CD81+111j
					; DATA XREF: .rdata:off_41B234o
		or	[ebp+var_18], 2	; jumptable 0040CE92 case 45
		jmp	short loc_40CEB7
; ---------------------------------------------------------------------------

loc_40CEA0:				; CODE XREF: sub_40CD81+111j
					; DATA XREF: .rdata:off_41B234o
		or	[ebp+var_18], 4	; jumptable 0040CE92 case 43
		jmp	short loc_40CEB7
; ---------------------------------------------------------------------------

loc_40CEA6:				; CODE XREF: sub_40CD81+111j
					; DATA XREF: .rdata:off_41B234o
		or	[ebp+var_18], 8	; jumptable 0040CE92 case 32
		jmp	short loc_40CEB7
; ---------------------------------------------------------------------------

loc_40CEAC:				; CODE XREF: sub_40CD81+111j
					; DATA XREF: .rdata:off_41B234o
		or	[ebp+var_18], 10h ; jumptable 0040CE92 case 35
		jmp	short loc_40CEB7
; ---------------------------------------------------------------------------

loc_40CEB2:				; CODE XREF: sub_40CD81+111j
					; DATA XREF: .rdata:off_41B234o
		or	[ebp+var_18], 20h ; jumptable 0040CE92 case 48
		nop

loc_40CEB7:				; CODE XREF: sub_40CD81+117j
					; sub_40CD81+11Dj ...
		add	[ebp+var_C], 1

loc_40CEBB:				; CODE XREF: sub_40CD81+F7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40CE7A
		jmp	short loc_40CEC8
; ---------------------------------------------------------------------------

loc_40CEC7:				; CODE XREF: sub_40CD81+108j
					; sub_40CD81+111j
					; DATA XREF: ...
		nop			; jumptable 0040CE92 default case

loc_40CEC8:				; CODE XREF: sub_40CD81+144j
		mov	[ebp+var_30], 0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	loc_40CF7B
		mov	[ebp+var_1C], 0FFFFFFFEh
		add	[ebp+var_C], 1
		cmp	[ebp+var_2C], 0
		jz	loc_40D001
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jle	loc_40D001
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	loc_40D001
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_30], eax
		add	[ebp+var_C], 1
		jmp	short loc_40CF46
; ---------------------------------------------------------------------------

loc_40CF23:				; CODE XREF: sub_40CD81+1D7j
		mov	edx, [ebp+var_30]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_30], eax
		add	[ebp+var_C], 1

loc_40CF46:				; CODE XREF: sub_40CD81+1A0j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40CF5A
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40CF23

loc_40CF5A:				; CODE XREF: sub_40CD81+1CDj
		cmp	[ebp+var_30], 0
		jle	loc_40D4B1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	loc_40D4B4
		add	[ebp+var_C], 1
		jmp	loc_40D001
; ---------------------------------------------------------------------------

loc_40CF7B:				; CODE XREF: sub_40CD81+156j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40CFFA
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40CFFA
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_1C], eax
		add	[ebp+var_C], 1
		jmp	short loc_40CFDB
; ---------------------------------------------------------------------------

loc_40CFA4:				; CODE XREF: sub_40CD81+26Cj
		cmp	[ebp+var_1C], 0
		jnz	short loc_40CFB8
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	loc_40D4B7

loc_40CFB8:				; CODE XREF: sub_40CD81+227j
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_1C], eax
		add	[ebp+var_C], 1

loc_40CFDB:				; CODE XREF: sub_40CD81+221j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40CFEF
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40CFA4

loc_40CFEF:				; CODE XREF: sub_40CD81+262j
		cmp	[ebp+var_1C], 0
		jns	short loc_40D001
		jmp	loc_40D4C4
; ---------------------------------------------------------------------------

loc_40CFFA:				; CODE XREF: sub_40CD81+202j
					; sub_40CD81+20Cj
		mov	[ebp+var_1C], 0FFFFFFFFh

loc_40D001:				; CODE XREF: sub_40CD81+16Bj
					; sub_40CD81+179j ...
		mov	[ebp+var_34], 0
		mov	[ebp+var_20], 0FFFFFFFFh
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Eh
		jnz	loc_40D174
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		setz	al
		movzx	eax, al
		mov	[ebp+var_40], eax
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	loc_40D0E1
		mov	[ebp+var_20], 0FFFFFFFEh
		add	[ebp+var_C], 1
		cmp	[ebp+var_2C], 0
		jz	loc_40D167
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jle	loc_40D167
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	loc_40D167
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_34], eax
		add	[ebp+var_C], 1
		jmp	short loc_40D0AC
; ---------------------------------------------------------------------------

loc_40D089:				; CODE XREF: sub_40CD81+33Dj
		mov	edx, [ebp+var_34]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_34], eax
		add	[ebp+var_C], 1

loc_40D0AC:				; CODE XREF: sub_40CD81+306j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40D0C0
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40D089

loc_40D0C0:				; CODE XREF: sub_40CD81+333j
		cmp	[ebp+var_34], 0
		jle	loc_40D4BA
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 24h
		jnz	loc_40D4BD
		add	[ebp+var_C], 1
		jmp	loc_40D167
; ---------------------------------------------------------------------------

loc_40D0E1:				; CODE XREF: sub_40CD81+2BCj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40D160
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_40D160
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		mov	[ebp+var_20], eax
		add	[ebp+var_C], 1
		jmp	short loc_40D141
; ---------------------------------------------------------------------------

loc_40D10A:				; CODE XREF: sub_40CD81+3D2j
		cmp	[ebp+var_20], 0
		jnz	short loc_40D11E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	loc_40D4C0

loc_40D11E:				; CODE XREF: sub_40CD81+38Dj
		mov	edx, [ebp+var_20]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	eax, edx
		mov	[ebp+var_20], eax
		add	[ebp+var_C], 1

loc_40D141:				; CODE XREF: sub_40CD81+387j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_40D155
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jle	short loc_40D10A

loc_40D155:				; CODE XREF: sub_40CD81+3C8j
		cmp	[ebp+var_20], 0
		jns	short loc_40D167
		jmp	loc_40D4C4
; ---------------------------------------------------------------------------

loc_40D160:				; CODE XREF: sub_40CD81+368j
					; sub_40CD81+372j
		mov	[ebp+var_20], 0

loc_40D167:				; CODE XREF: sub_40CD81+2D1j
					; sub_40CD81+2DFj ...
		cmp	[ebp+var_40], 0
		jz	short loc_40D174
		mov	[ebp+var_20], 0FFFFFFFFh

loc_40D174:				; CODE XREF: sub_40CD81+296j
					; sub_40CD81+3EAj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 4Ch	; switch 47 cases
		cmp	eax, 2Eh
		ja	loc_40D214	; jumptable 0040D190 default case
		mov	eax, ds:off_41B278[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40D192:				; CODE XREF: sub_40CD81+40Fj
					; DATA XREF: .rdata:off_41B278o
		mov	eax, [ebp+var_C] ; jumptable 0040D190 case 104
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 68h
		jnz	short loc_40D1AC
		mov	[ebp+var_24], 1
		add	[ebp+var_C], 1
		jmp	short loc_40D1B3
; ---------------------------------------------------------------------------

loc_40D1AC:				; CODE XREF: sub_40CD81+41Cj
		mov	[ebp+var_24], 2

loc_40D1B3:				; CODE XREF: sub_40CD81+429j
		add	[ebp+var_C], 1
		jmp	short loc_40D21C
; ---------------------------------------------------------------------------

loc_40D1B9:				; CODE XREF: sub_40CD81+40Fj
					; DATA XREF: .rdata:off_41B278o
		mov	eax, [ebp+var_C] ; jumptable 0040D190 case 108
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 6Ch
		jnz	short loc_40D1D3
		mov	[ebp+var_24], 4
		add	[ebp+var_C], 1
		jmp	short loc_40D1DA
; ---------------------------------------------------------------------------

loc_40D1D3:				; CODE XREF: sub_40CD81+443j
		mov	[ebp+var_24], 3

loc_40D1DA:				; CODE XREF: sub_40CD81+450j
		add	[ebp+var_C], 1
		jmp	short loc_40D21C
; ---------------------------------------------------------------------------

loc_40D1E0:				; CODE XREF: sub_40CD81+40Fj
					; DATA XREF: .rdata:off_41B278o
		mov	[ebp+var_24], 5	; jumptable 0040D190 case 106
		add	[ebp+var_C], 1
		jmp	short loc_40D21C
; ---------------------------------------------------------------------------

loc_40D1ED:				; CODE XREF: sub_40CD81+40Fj
					; DATA XREF: .rdata:off_41B278o
		mov	[ebp+var_24], 6	; jumptable 0040D190 case 122
		add	[ebp+var_C], 1
		jmp	short loc_40D21C
; ---------------------------------------------------------------------------

loc_40D1FA:				; CODE XREF: sub_40CD81+40Fj
					; DATA XREF: .rdata:off_41B278o
		mov	[ebp+var_24], 7	; jumptable 0040D190 case 116
		add	[ebp+var_C], 1
		jmp	short loc_40D21C
; ---------------------------------------------------------------------------

loc_40D207:				; CODE XREF: sub_40CD81+40Fj
					; DATA XREF: .rdata:off_41B278o
		mov	[ebp+var_24], 8	; jumptable 0040D190 case 76
		add	[ebp+var_C], 1
		jmp	short loc_40D21C
; ---------------------------------------------------------------------------

loc_40D214:				; CODE XREF: sub_40CD81+402j
					; sub_40CD81+40Fj
					; DATA XREF: ...
		mov	[ebp+var_24], 0	; jumptable 0040D190 default case
		nop

loc_40D21C:				; CODE XREF: sub_40CD81+436j
					; sub_40CD81+45Dj ...
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 41h	; switch 56 cases
		cmp	eax, 37h
		ja	loc_40D31B	; jumptable 0040D238 default case
		mov	eax, ds:off_41B334[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40D23A:				; CODE XREF: sub_40CD81+4B7j
					; DATA XREF: .rdata:off_41B334o
		mov	[ebp+var_28], 1	; jumptable 0040D238 cases 100,105
		jmp	loc_40D322
; ---------------------------------------------------------------------------

loc_40D246:				; CODE XREF: sub_40CD81+4B7j
					; DATA XREF: .rdata:off_41B334o
		mov	[ebp+var_28], 2	; jumptable 0040D238 case 111
		jmp	loc_40D322
; ---------------------------------------------------------------------------

loc_40D252:				; CODE XREF: sub_40CD81+4B7j
					; DATA XREF: .rdata:off_41B334o
		mov	[ebp+var_28], 3	; jumptable 0040D238 case 117
		jmp	loc_40D322
; ---------------------------------------------------------------------------

loc_40D25E:				; CODE XREF: sub_40CD81+4B7j
					; DATA XREF: .rdata:off_41B334o
		mov	[ebp+var_28], 4	; jumptable 0040D238 case 120
		jmp	loc_40D322
; ---------------------------------------------------------------------------

loc_40D26A:				; CODE XREF: sub_40CD81+4B7j
					; DATA XREF: .rdata:off_41B334o
		mov	[ebp+var_28], 5	; jumptable 0040D238 case 88
		jmp	loc_40D322
; ---------------------------------------------------------------------------

loc_40D276:				; CODE XREF: sub_40CD81+4B7j
					; DATA XREF: .rdata:off_41B334o
		mov	[ebp+var_28], 6	; jumptable 0040D238 case 102
		jmp	loc_40D322
; ---------------------------------------------------------------------------

loc_40D282:				; CODE XREF: sub_40CD81+4B7j
					; DATA XREF: .rdata:off_41B334o
		mov	[ebp+var_28], 7	; jumptable 0040D238 case 70
		jmp	loc_40D322
; ---------------------------------------------------------------------------

loc_40D28E:				; CODE XREF: sub_40CD81+4B7j
					; DATA XREF: .rdata:off_41B334o
		mov	[ebp+var_28], 8	; jumptable 0040D238 case 101
		jmp	loc_40D322
; ---------------------------------------------------------------------------

loc_40D29A:				; CODE XREF: sub_40CD81+4B7j
					; DATA XREF: .rdata:off_41B334o
		mov	[ebp+var_28], 9	; jumptable 0040D238 case 69
		jmp	short loc_40D322
; ---------------------------------------------------------------------------

loc_40D2A3:				; CODE XREF: sub_40CD81+4B7j
					; DATA XREF: .rdata:off_41B334o
		mov	[ebp+var_28], 0Ah ; jumptable 0040D238 case 103
		jmp	short loc_40D322
; ---------------------------------------------------------------------------

loc_40D2AC:				; CODE XREF: sub_40CD81+4B7j
					; DATA XREF: .rdata:off_41B334o
		mov	[ebp+var_28], 0Bh ; jumptable 0040D238 case 71
		jmp	short loc_40D322
; ---------------------------------------------------------------------------

loc_40D2B5:				; CODE XREF: sub_40CD81+4B7j
					; DATA XREF: .rdata:off_41B334o
		mov	[ebp+var_28], 0Ch ; jumptable 0040D238 case 97
		jmp	short loc_40D322
; ---------------------------------------------------------------------------

loc_40D2BE:				; CODE XREF: sub_40CD81+4B7j
					; DATA XREF: .rdata:off_41B334o
		mov	[ebp+var_28], 0Dh ; jumptable 0040D238 case 65
		jmp	short loc_40D322
; ---------------------------------------------------------------------------

loc_40D2C7:				; CODE XREF: sub_40CD81+4B7j
					; DATA XREF: .rdata:off_41B334o
		mov	[ebp+var_28], 0Eh ; jumptable 0040D238 case 99
		jmp	short loc_40D322
; ---------------------------------------------------------------------------

loc_40D2D0:				; CODE XREF: sub_40CD81+4B7j
					; DATA XREF: .rdata:off_41B334o
		mov	[ebp+var_28], 0Fh ; jumptable 0040D238 case 115
		jmp	short loc_40D322
; ---------------------------------------------------------------------------

loc_40D2D9:				; CODE XREF: sub_40CD81+4B7j
					; DATA XREF: .rdata:off_41B334o
		mov	[ebp+var_28], 10h ; jumptable 0040D238 case 112
		jmp	short loc_40D322
; ---------------------------------------------------------------------------

loc_40D2E2:				; CODE XREF: sub_40CD81+4B7j
					; DATA XREF: .rdata:off_41B334o
		mov	[ebp+var_28], 12h ; jumptable 0040D238 case 110
		jmp	short loc_40D322
; ---------------------------------------------------------------------------

loc_40D2EB:				; CODE XREF: sub_40CD81+4B7j
					; DATA XREF: .rdata:off_41B334o
		mov	[ebp+var_28], 0Eh ; jumptable 0040D238 case 67
		mov	[ebp+var_24], 3
		jmp	short loc_40D322
; ---------------------------------------------------------------------------

loc_40D2FB:				; CODE XREF: sub_40CD81+4B7j
					; DATA XREF: .rdata:off_41B334o
		mov	[ebp+var_28], 0Fh ; jumptable 0040D238 case 83
		mov	[ebp+var_24], 3
		jmp	short loc_40D322
; ---------------------------------------------------------------------------

loc_40D30B:				; CODE XREF: sub_40CD81+4B7j
					; DATA XREF: .rdata:off_41B334o
		mov	[ebp+var_28], 11h ; jumptable 0040D238 case 109
		mov	[ebp+var_2C], 0FFFFFFFFh
		jmp	short loc_40D322
; ---------------------------------------------------------------------------

loc_40D31B:				; CODE XREF: sub_40CD81+4AAj
					; sub_40CD81+4B7j
					; DATA XREF: ...
		mov	[ebp+var_28], 0	; jumptable 0040D238 default case

loc_40D322:				; CODE XREF: sub_40CD81+4C0j
					; sub_40CD81+4CCj ...
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_8]
		jb	loc_40D3F3
		mov	eax, [ebp+arg_8]
		add	eax, 0Ah
		mov	[ebp+var_44], eax
		mov	eax, [ebp+var_44]
		cmp	eax, [ebp+arg_8]
		jbe	loc_40D4C3
		mov	[esp+68h+SizeOfElements], 28h ;	SizeOfElements
		mov	eax, [ebp+var_44]
		mov	[esp+68h+NumOfElements], eax ; NumOfElements
		call	calloc
		mov	[ebp+var_48], eax
		cmp	[ebp+var_48], 0
		jz	loc_40D4D3
		mov	[ebp+var_38], 0
		jmp	short loc_40D3CA
; ---------------------------------------------------------------------------

loc_40D36C:				; CODE XREF: sub_40CD81+64Fj
		mov	edx, [ebp+var_38]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+var_48]
		mov	ecx, [ebp+var_38]
		mov	edx, ecx
		shl	edx, 2
		add	edx, ecx
		shl	edx, 3
		add	edx, [ebp+Memory]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		mov	ecx, [edx+0Ch]
		mov	[eax+0Ch], ecx
		mov	ecx, [edx+10h]
		mov	[eax+10h], ecx
		mov	ecx, [edx+14h]
		mov	[eax+14h], ecx
		mov	ecx, [edx+18h]
		mov	[eax+18h], ecx
		mov	ecx, [edx+1Ch]
		mov	[eax+1Ch], ecx
		mov	ecx, [edx+20h]
		mov	[eax+20h], ecx
		mov	edx, [edx+24h]
		mov	[eax+24h], edx
		add	[ebp+var_38], 1

loc_40D3CA:				; CODE XREF: sub_40CD81+5E9j
		mov	eax, [ebp+var_38]
		cmp	eax, [ebp+var_14]
		jb	short loc_40D36C
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		cmp	eax, [ebp+Memory]
		jz	short loc_40D3E7
		mov	eax, [ebp+Memory]
		mov	[esp+68h+NumOfElements], eax ; Memory
		call	free

loc_40D3E7:				; CODE XREF: sub_40CD81+659j
		mov	eax, [ebp+var_48]
		mov	[ebp+Memory], eax
		mov	eax, [ebp+var_44]
		mov	[ebp+arg_8], eax

loc_40D3F3:				; CODE XREF: sub_40CD81+5A7j
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	[ebp+var_4C], eax
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 2
		mov	edx, eax
		mov	eax, [ebp+var_4C]
		mov	[eax], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_1C]
		mov	[eax+8], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_20]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_24]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_28]
		mov	[eax+14h], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_2C]
		mov	[eax+18h], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_30]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+var_4C]
		mov	edx, [ebp+var_34]
		mov	[eax+20h], edx
		mov	eax, [ebp+var_4C]
		mov	[esp+68h+NumOfElements], eax
		call	sub_40CB80
		add	[ebp+var_14], 1
		mov	eax, [ebp+var_C]
		mov	[ebp+arg_0], eax
		jmp	short loc_40D47F
; ---------------------------------------------------------------------------

loc_40D47B:				; CODE XREF: sub_40CD81+2Cj
		nop
		jmp	short loc_40D47F
; ---------------------------------------------------------------------------

loc_40D47E:				; CODE XREF: sub_40CD81+52j
		nop

loc_40D47F:				; CODE XREF: sub_40CD81+6F8j
					; sub_40CD81+6FBj
		add	[ebp+arg_0], 1
		jmp	short loc_40D486
; ---------------------------------------------------------------------------

loc_40D485:				; CODE XREF: sub_40CD81+19j
		nop

loc_40D486:				; CODE XREF: sub_40CD81+702j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_40CDA5
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+Memory]
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, 0
		jmp	short locret_40D4F7
; ---------------------------------------------------------------------------

loc_40D4AB:				; CODE XREF: sub_40CD81+44j
		nop
		jmp	short loc_40D4C4
; ---------------------------------------------------------------------------

loc_40D4AE:				; CODE XREF: sub_40CD81+CDj
		nop
		jmp	short loc_40D4C4
; ---------------------------------------------------------------------------

loc_40D4B1:				; CODE XREF: sub_40CD81+1DDj
		nop
		jmp	short loc_40D4C4
; ---------------------------------------------------------------------------

loc_40D4B4:				; CODE XREF: sub_40CD81+1EBj
		nop
		jmp	short loc_40D4C4
; ---------------------------------------------------------------------------

loc_40D4B7:				; CODE XREF: sub_40CD81+231j
		nop
		jmp	short loc_40D4C4
; ---------------------------------------------------------------------------

loc_40D4BA:				; CODE XREF: sub_40CD81+343j
		nop
		jmp	short loc_40D4C4
; ---------------------------------------------------------------------------

loc_40D4BD:				; CODE XREF: sub_40CD81+351j
		nop
		jmp	short loc_40D4C4
; ---------------------------------------------------------------------------

loc_40D4C0:				; CODE XREF: sub_40CD81+397j
		nop
		jmp	short loc_40D4C4
; ---------------------------------------------------------------------------

loc_40D4C3:				; CODE XREF: sub_40CD81+5BCj
		nop

loc_40D4C4:				; CODE XREF: sub_40CD81+1Fj
					; sub_40CD81+274j ...
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		jmp	short loc_40D4D4
; ---------------------------------------------------------------------------

loc_40D4D3:				; CODE XREF: sub_40CD81+5DCj
		nop

loc_40D4D4:				; CODE XREF: sub_40CD81+750j
		mov	eax, [ebp+arg_4]
		mov	eax, [eax]
		cmp	eax, [ebp+Memory]
		jz	short loc_40D4E9
		mov	eax, [ebp+Memory]
		mov	[esp+68h+NumOfElements], eax ; Memory
		call	free

loc_40D4E9:				; CODE XREF: sub_40CD81+75Bj
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh

locret_40D4F7:				; CODE XREF: sub_40CD81+728j
		leave
		retn
sub_40CD81	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D4F9	proc near		; CODE XREF: sub_40EBCB+502p

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	[ebp+var_C], 0
		jmp	loc_40D7C0
; ---------------------------------------------------------------------------

loc_40D50C:				; CODE XREF: sub_40D4F9+2CDj
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_0]
		add	eax, 8
		mov	[ebp+var_10], eax
		mov	edx, [ebp+var_C]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 1Ch ; switch 29 cases
		ja	loc_40D7B5	; jumptable 0040D54C default case
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	eax, offset off_41B414
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40D54E:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 1
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		jmp	loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D565:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 20
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D57A:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 2
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		jmp	loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D591:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 21
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D5A6:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 3
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		jmp	loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D5BD:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 4
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dx
		jmp	loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D5D5:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 5
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	eax, [eax]
		mov	edx, eax
		mov	eax, [ebp+var_10]
		mov	[eax], dx
		jmp	loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D5ED:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 22
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D602:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 6
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D617:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 23
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D62C:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 7
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D641:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 8
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D656:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 9
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D66B:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 24
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D680:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 10
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D69B:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 11
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D6B6:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 25
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D6CB:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 12
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		fld	qword ptr [eax]
		mov	eax, [ebp+var_10]
		fstp	qword ptr [eax]
		jmp	loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D6E0:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 13
		lea	edx, [eax+0Ch]
		mov	[ebp+arg_8], edx
		mov	ecx, [eax+8]
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ebx, [ebp+var_10]
		mov	[ebx], eax
		mov	[ebx+4], edx
		mov	[ebx+8], ecx
		jmp	loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D701:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 14
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D716:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 19
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D72B:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 15
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D743:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 26
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D755:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 16
		lea	edx, [eax+8]
		mov	[ebp+arg_8], edx
		mov	edx, [eax+4]
		mov	eax, [eax]
		mov	ecx, [ebp+var_10]
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D76D:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 17
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D77F:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 27
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D791:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 18
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D7A3:				; CODE XREF: sub_40D4F9+53j
					; DATA XREF: .rdata:off_41B414o
		mov	eax, [ebp+arg_8] ; jumptable 0040D54C case 28
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_10]
		mov	[eax], edx
		jmp	short loc_40D7BC
; ---------------------------------------------------------------------------

loc_40D7B5:				; CODE XREF: sub_40D4F9+40j
					; sub_40D4F9+53j
					; DATA XREF: ...
		mov	eax, 0FFFFFFFFh	; jumptable 0040D54C default case
		jmp	short loc_40D7D1
; ---------------------------------------------------------------------------

loc_40D7BC:				; CODE XREF: sub_40D4F9+67j
					; sub_40D4F9+7Cj ...
		add	[ebp+var_C], 1

loc_40D7C0:				; CODE XREF: sub_40D4F9+Ej
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_4]
		jb	loc_40D50C
		mov	eax, 0

loc_40D7D1:				; CODE XREF: sub_40D4F9+2C1j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_40D4F9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D7D7	proc near		; CODE XREF: sub_40D855+4C6p
					; sub_40D855+5BAp ...

Dst		= dword	ptr -48h
Val		= dword	ptr -44h
Size		= dword	ptr -40h
var_30		= byte ptr -30h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		jmp	short loc_40D848
; ---------------------------------------------------------------------------

loc_40D7DF:				; CODE XREF: sub_40D7D7+75j
		mov	eax, [ebp+arg_C]
		mov	edx, 20h
		cmp	eax, 20h
		cmova	eax, edx
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Size],	eax ; Size
		mov	eax, [ebp+arg_8]
		mov	[esp+48h+Val], eax ; Val
		lea	eax, [ebp+var_30]
		mov	[esp+48h+Dst], eax ; Dst
		call	memset
		mov	eax, [ebp+var_C]
		mov	[esp+48h+Size],	eax
		lea	eax, [ebp+var_30]
		mov	[esp+48h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Dst], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_40D830
		mov	eax, [ebp+var_10]
		jmp	short locret_40D853
; ---------------------------------------------------------------------------

loc_40D830:				; CODE XREF: sub_40D7D7+52j
		mov	eax, [ebp+arg_10]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_C]
		sub	eax, [ebp+var_C]
		mov	[ebp+arg_C], eax

loc_40D848:				; CODE XREF: sub_40D7D7+6j
		cmp	[ebp+arg_C], 0
		jg	short loc_40D7DF
		mov	eax, 0

locret_40D853:				; CODE XREF: sub_40D7D7+57j
		leave
		retn
sub_40D7D7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40D855	proc near		; CODE XREF: sub_40E6EB+317p

var_D8		= dword	ptr -0D8h
var_D4		= dword	ptr -0D4h
var_D0		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A5		= byte ptr -0A5h
var_A4		= byte ptr -0A4h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0D4h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_B8], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_B4], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_B0], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_AC], eax
		mov	[ebp+var_A5], 0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 1
		jnz	loc_40D97C
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		sub	eax, 4		; switch 15 cases
		cmp	eax, 0Eh
		ja	loc_40D93C	; jumptable 0040D8B2 default case
		mov	eax, ds:off_41B4B4[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40D8B4:				; CODE XREF: sub_40D855+5Dj
					; DATA XREF: .rdata:off_41B4B4o
		movzx	eax, word ptr [ebp+var_B8] ; jumptable 0040D8B2	case 4
		cwde
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_40D946
; ---------------------------------------------------------------------------

loc_40D8C9:				; CODE XREF: sub_40D855+5Dj
					; DATA XREF: .rdata:off_41B4B4o
		mov	eax, [ebp+var_B8] ; jumptable 0040D8B2 case 6
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_40D946
; ---------------------------------------------------------------------------

loc_40D8DC:				; CODE XREF: sub_40D855+5Dj
					; DATA XREF: .rdata:off_41B4B4o
		mov	eax, [ebp+var_B8] ; jumptable 0040D8B2 case 8
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_40D946
; ---------------------------------------------------------------------------

loc_40D8EF:				; CODE XREF: sub_40D855+5Dj
					; DATA XREF: .rdata:off_41B4B4o
		mov	eax, [ebp+var_B8] ; jumptable 0040D8B2 case 10
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_40D946
; ---------------------------------------------------------------------------

loc_40D903:				; CODE XREF: sub_40D855+5Dj
					; DATA XREF: .rdata:off_41B4B4o
		mov	eax, [ebp+var_B8] ; jumptable 0040D8B2 case 17
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], 0
		jmp	short loc_40D946
; ---------------------------------------------------------------------------

loc_40D915:				; CODE XREF: sub_40D855+5Dj
					; DATA XREF: .rdata:off_41B4B4o
		mov	eax, [ebp+var_B8] ; jumptable 0040D8B2 case 15
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_40D946
; ---------------------------------------------------------------------------

loc_40D929:				; CODE XREF: sub_40D855+5Dj
					; DATA XREF: .rdata:off_41B4B4o
		mov	eax, [ebp+var_B8] ; jumptable 0040D8B2 case 18
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_24], edx
		jmp	short loc_40D946
; ---------------------------------------------------------------------------

loc_40D93C:				; CODE XREF: sub_40D855+50j
					; sub_40D855+5Dj
					; DATA XREF: ...
		mov	eax, 0FFFFFFFFh	; jumptable 0040D8B2 default case
		jmp	loc_40DEDF
; ---------------------------------------------------------------------------

loc_40D946:				; CODE XREF: sub_40D855+72j
					; sub_40D855+85j ...
		cmp	[ebp+var_24], 0
		jns	short loc_40D96B
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_24]
		neg	eax
		adc	edx, 0
		neg	edx
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	[ebp+var_A5], 2Dh
		jmp	loc_40DA28
; ---------------------------------------------------------------------------

loc_40D96B:				; CODE XREF: sub_40D855+F5j
		mov	eax, [ebp+var_28]
		mov	edx, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	loc_40DA28
; ---------------------------------------------------------------------------

loc_40D97C:				; CODE XREF: sub_40D855+3Ej
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		sub	eax, 5		; switch 14 cases
		cmp	eax, 0Dh
		ja	loc_40DA1E	; jumptable 0040D995 default case
		mov	eax, ds:off_41B4F0[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40D997:				; CODE XREF: sub_40D855+140j
					; DATA XREF: .rdata:off_41B4F0o
		movzx	eax, word ptr [ebp+var_B8] ; jumptable 0040D995	case 5
		movzx	eax, ax
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_40DA28
; ---------------------------------------------------------------------------

loc_40D9AD:				; CODE XREF: sub_40D855+140j
					; DATA XREF: .rdata:off_41B4F0o
		mov	eax, [ebp+var_B8] ; jumptable 0040D995 case 7
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_40DA28
; ---------------------------------------------------------------------------

loc_40D9BF:				; CODE XREF: sub_40D855+140j
					; DATA XREF: .rdata:off_41B4F0o
		mov	eax, [ebp+var_B8] ; jumptable 0040D995 case 9
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_40DA28
; ---------------------------------------------------------------------------

loc_40D9D1:				; CODE XREF: sub_40D855+140j
					; DATA XREF: .rdata:off_41B4F0o
		mov	eax, [ebp+var_B8] ; jumptable 0040D995 case 11
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_40DA28
; ---------------------------------------------------------------------------

loc_40D9E5:				; CODE XREF: sub_40D855+140j
					; DATA XREF: .rdata:off_41B4F0o
		mov	eax, [ebp+var_B8] ; jumptable 0040D995 case 17
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_40DA28
; ---------------------------------------------------------------------------

loc_40D9F7:				; CODE XREF: sub_40D855+140j
					; DATA XREF: .rdata:off_41B4F0o
		mov	eax, [ebp+var_B8] ; jumptable 0040D995 case 16
		mov	edx, [ebp+var_B4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_40DA28
; ---------------------------------------------------------------------------

loc_40DA0B:				; CODE XREF: sub_40D855+140j
					; DATA XREF: .rdata:off_41B4F0o
		mov	eax, [ebp+var_B8] ; jumptable 0040D995 case 18
		mov	edx, eax
		sar	edx, 1Fh
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		jmp	short loc_40DA28
; ---------------------------------------------------------------------------

loc_40DA1E:				; CODE XREF: sub_40D855+133j
					; sub_40D855+140j
					; DATA XREF: ...
		mov	eax, 0FFFFFFFFh	; jumptable 0040D995 default case
		jmp	loc_40DEDF
; ---------------------------------------------------------------------------

loc_40DA28:				; CODE XREF: sub_40D855+111j
					; sub_40D855+122j ...
		movzx	eax, [ebp+var_A5]
		cmp	al, 2Dh
		jz	short loc_40DA5D
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 4
		test	eax, eax
		jz	short loc_40DA49
		mov	[ebp+var_A5], 2Bh
		jmp	short loc_40DA5D
; ---------------------------------------------------------------------------

loc_40DA49:				; CODE XREF: sub_40D855+1E9j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 8
		test	eax, eax
		jz	short loc_40DA5D
		mov	[ebp+var_A5], 20h

loc_40DA5D:				; CODE XREF: sub_40D855+1DCj
					; sub_40D855+1F2j ...
		movzx	eax, [ebp+var_A5]
		test	al, al
		setnz	al
		movzx	eax, al
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+var_A4]
		add	eax, 64h
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	short loc_40DA9B
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_40DC27

loc_40DA9B:				; CODE XREF: sub_40D855+236j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 1
		jz	short loc_40DAB5
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jnz	loc_40DB67

loc_40DAB5:				; CODE XREF: sub_40D855+24Fj
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	[ebp+var_38], offset byte_41B488

loc_40DAC3:				; CODE XREF: sub_40D855+307j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 1
		test	al, al
		jz	short loc_40DAFA
		add	[ebp+var_2C], 1
		cmp	[ebp+var_2C], 3
		jnz	short loc_40DAFA
		mov	eax, [ebp+var_38]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40DAFA
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_38]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	[ebp+var_2C], 0

loc_40DAFA:				; CODE XREF: sub_40D855+279j
					; sub_40D855+283j ...
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[esp+0D8h+var_D0], 0Ah
		mov	[esp+0D8h+var_CC], 0
		mov	[esp+0D8h+var_D8], eax
		mov	[esp+0D8h+var_D4], edx
		call	sub_4181E0
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		mov	[esp+0D8h+var_D0], 0Ah
		mov	[esp+0D8h+var_CC], 0
		mov	[esp+0D8h+var_D8], eax
		mov	[esp+0D8h+var_D4], edx
		call	sub_4180E0
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	loc_40DAC3
		jmp	loc_40DC27
; ---------------------------------------------------------------------------

loc_40DB67:				; CODE XREF: sub_40D855+25Aj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 2
		jnz	short loc_40DBC8

loc_40DB72:				; CODE XREF: sub_40D855+34Ej
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_10]
		and	eax, 7
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		shrd	eax, edx, 3
		shr	edx, 3
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	short loc_40DB72
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_40DC27
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		cmp	al, 30h
		jz	short loc_40DC27
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	30h
		jmp	short loc_40DC27
; ---------------------------------------------------------------------------

loc_40DBC8:				; CODE XREF: sub_40D855+31Bj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 4
		jnz	short loc_40DBDA
		mov	eax, offset a0123456789abcd ; "0123456789abcdef"
		jmp	short loc_40DBDF
; ---------------------------------------------------------------------------

loc_40DBDA:				; CODE XREF: sub_40D855+37Cj
		mov	eax, offset a0123456789ab_0 ; "0123456789ABCDEF"

loc_40DBDF:				; CODE XREF: sub_40D855+383j
		mov	[ebp+var_34], eax

loc_40DBE2:				; CODE XREF: sub_40D855+3BFj
		sub	[ebp+var_14], 1
		mov	eax, [ebp+var_10]
		and	eax, 0Fh
		add	eax, [ebp+var_34]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_14]
		mov	[eax], dl
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		shrd	eax, edx, 4
		shr	edx, 4
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], edx
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_C]
		or	eax, edx
		test	eax, eax
		jnz	short loc_40DBE2
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_40DC27
		add	[ebp+var_1C], 2

loc_40DC27:				; CODE XREF: sub_40D855+240j
					; sub_40D855+30Dj ...
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 20h
		test	eax, eax
		jz	short loc_40DC80
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40DC80
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_40DC80
		cmp	[ebp+var_3C], 0
		jz	short loc_40DC80
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_40DC80
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		sub	eax, [ebp+var_3C]
		mov	[ebp+var_18], eax
		jmp	short loc_40DCAA
; ---------------------------------------------------------------------------

loc_40DC80:				; CODE XREF: sub_40D855+3ECj
					; sub_40D855+3F7j ...
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jle	short loc_40DCA3
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_40DCA3
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		sub	eax, [ebp+var_3C]
		mov	[ebp+var_18], eax
		jmp	short loc_40DCAA
; ---------------------------------------------------------------------------

loc_40DCA3:				; CODE XREF: sub_40D855+433j
					; sub_40D855+43Ej
		mov	[ebp+var_18], 0

loc_40DCAA:				; CODE XREF: sub_40D855+429j
					; sub_40D855+44Cj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_40DD31
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_40DD31
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_40DD31
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		mov	edx, eax
		sub	edx, [ebp+var_3C]
		mov	eax, [ebp+var_18]
		cmp	edx, eax
		jb	short loc_40DD31
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		mov	edx, eax
		sub	edx, [ebp+var_3C]
		mov	eax, [ebp+var_18]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	edx, [ebp+arg_1C]
		mov	[esp+0D8h+var_C8], edx
		mov	[esp+0D8h+var_CC], eax
		mov	[esp+0D8h+var_D0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+var_D8], eax
		call	sub_40D7D7
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_40DD31
		mov	eax, [ebp+var_40]
		jmp	loc_40DEDF
; ---------------------------------------------------------------------------

loc_40DD31:				; CODE XREF: sub_40D855+460j
					; sub_40D855+46Aj ...
		movzx	eax, [ebp+var_A5]
		test	al, al
		jz	short loc_40DD77
		mov	[esp+0D8h+var_D0], 1
		lea	eax, [ebp+var_A5]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_40DD6A
		mov	eax, [ebp+var_40]
		jmp	loc_40DEDF
; ---------------------------------------------------------------------------

loc_40DD6A:				; CODE XREF: sub_40D855+50Bj
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_40DD77:				; CODE XREF: sub_40D855+4E5j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_40DDE6
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 4
		jz	short loc_40DD9A
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 5
		jnz	short loc_40DDE6

loc_40DD9A:				; CODE XREF: sub_40D855+538j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		cmp	eax, 4
		jnz	short loc_40DDAC
		mov	eax, offset a0x	; "0x"
		jmp	short loc_40DDB1
; ---------------------------------------------------------------------------

loc_40DDAC:				; CODE XREF: sub_40D855+54Ej
		mov	eax, offset a0x_0 ; "0X"

loc_40DDB1:				; CODE XREF: sub_40D855+555j
		mov	[esp+0D8h+var_D0], 2
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_40DDD9
		mov	eax, [ebp+var_40]
		jmp	loc_40DEDF
; ---------------------------------------------------------------------------

loc_40DDD9:				; CODE XREF: sub_40D855+57Aj
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_40DDE6:				; CODE XREF: sub_40D855+52Dj
					; sub_40D855+543j
		cmp	[ebp+var_18], 0
		jz	short loc_40DE25
		mov	eax, [ebp+arg_1C]
		mov	[esp+0D8h+var_C8], eax
		mov	eax, [ebp+var_18]
		mov	[esp+0D8h+var_CC], eax
		mov	[esp+0D8h+var_D0], 30h
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+var_D8], eax
		call	sub_40D7D7
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_40DE25
		mov	eax, [ebp+var_40]
		jmp	loc_40DEDF
; ---------------------------------------------------------------------------

loc_40DE25:				; CODE XREF: sub_40D855+595j
					; sub_40D855+5C6j
		mov	edx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[esp+0D8h+var_D0], eax
		mov	eax, [ebp+var_14]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_40DE58
		mov	eax, [ebp+var_40]
		jmp	loc_40DEDF
; ---------------------------------------------------------------------------

loc_40DE58:				; CODE XREF: sub_40D855+5F9j
		mov	eax, [ebp+arg_1C]
		mov	edx, [eax]
		mov	ecx, [ebp+var_30]
		mov	eax, [ebp+var_14]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jz	short loc_40DEDA
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_40DEDA
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		sub	eax, [ebp+var_18]
		cmp	eax, [ebp+var_3C]
		jbe	short loc_40DEDA
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_1C]
		sub	eax, [ebp+var_18]
		sub	eax, [ebp+var_3C]
		mov	edx, [ebp+arg_1C]
		mov	[esp+0D8h+var_C8], edx
		mov	[esp+0D8h+var_CC], eax
		mov	[esp+0D8h+var_D0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+0D8h+var_D4], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0D8h+var_D8], eax
		call	sub_40D7D7
		mov	[ebp+var_40], eax
		cmp	[ebp+var_40], 0
		jz	short loc_40DEDA
		mov	eax, [ebp+var_40]
		jmp	short loc_40DEDF
; ---------------------------------------------------------------------------

loc_40DEDA:				; CODE XREF: sub_40D855+626j
					; sub_40D855+630j ...
		mov	eax, 0

loc_40DEDF:				; CODE XREF: sub_40D855+ECj
					; sub_40D855+1CEj ...
		add	esp, 0D4h
		pop	ebx
		pop	ebp
		retn
sub_40D855	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40DEE8	proc near		; CODE XREF: sub_40E6EB+35Bp

Dest		= dword	ptr -1F8h
Format		= dword	ptr -1F4h
var_1F0		= qword	ptr -1F0h
var_1E8		= dword	ptr -1E8h
var_1D0		= dword	ptr -1D0h
var_1CC		= dword	ptr -1CCh
var_1C8		= qword	ptr -1C8h
var_1C0		= dword	ptr -1C0h
var_1BC		= dword	ptr -1BCh
var_1AF		= byte ptr -1AFh
var_1AE		= byte ptr -1AEh
var_19A		= byte ptr -19Ah
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= qword	ptr -28h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 1F0h
		mov	eax, [ebp+arg_C]
		mov	dword ptr [ebp+var_1C8], eax
		mov	eax, [ebp+arg_10]
		mov	dword ptr [ebp+var_1C8+4], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_1C0], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_1BC], eax
		mov	eax, 0
		mov	edx, 0
		mov	ecx, 0
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	[ebp+var_10], ecx
		mov	[ebp+var_1C], 0
		mov	[ebp+var_1AF], 0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 0Ch
		jz	short loc_40DF4F
		cmp	eax, 0Dh
		jz	short loc_40DF5A
		jmp	short loc_40DF83
; ---------------------------------------------------------------------------

loc_40DF4F:				; CODE XREF: sub_40DEE8+5Ej
		fld	[ebp+var_1C8]
		fstp	[ebp+var_28]
		jmp	short loc_40DF8D
; ---------------------------------------------------------------------------

loc_40DF5A:				; CODE XREF: sub_40DEE8+63j
		fldz
		fstp	[ebp+var_28]
		mov	eax, dword ptr [ebp+var_1C8]
		mov	edx, dword ptr [ebp+var_1C8+4]
		mov	ecx, [ebp+var_1C0]
		mov	[ebp+var_18], eax
		mov	[ebp+var_14], edx
		mov	[ebp+var_10], ecx
		mov	[ebp+var_1C], 1
		jmp	short loc_40DF8D
; ---------------------------------------------------------------------------

loc_40DF83:				; CODE XREF: sub_40DEE8+65j
		mov	eax, 0FFFFFFFFh
		jmp	loc_40E313
; ---------------------------------------------------------------------------

loc_40DF8D:				; CODE XREF: sub_40DEE8+70j
					; sub_40DEE8+99j
		lea	eax, [ebp+var_1AE]
		add	eax, 14h
		mov	[ebp+var_2C], eax
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+14h]
		sub	eax, 6		; switch 8 cases
		cmp	eax, 7
		ja	short loc_40E01A ; jumptable 0040DFB8 default case
		mov	eax, ds:off_41B528[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40DFBA:				; CODE XREF: sub_40DEE8+D0j
					; DATA XREF: .rdata:off_41B528o
		sub	[ebp+var_2C], 1	; jumptable 0040DFB8 case 6
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	66h
		jmp	short loc_40E024
; ---------------------------------------------------------------------------

loc_40DFC6:				; CODE XREF: sub_40DEE8+D0j
					; DATA XREF: .rdata:off_41B528o
		sub	[ebp+var_2C], 1	; jumptable 0040DFB8 case 7
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	46h
		jmp	short loc_40E024
; ---------------------------------------------------------------------------

loc_40DFD2:				; CODE XREF: sub_40DEE8+D0j
					; DATA XREF: .rdata:off_41B528o
		sub	[ebp+var_2C], 1	; jumptable 0040DFB8 case 8
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	65h
		jmp	short loc_40E024
; ---------------------------------------------------------------------------

loc_40DFDE:				; CODE XREF: sub_40DEE8+D0j
					; DATA XREF: .rdata:off_41B528o
		sub	[ebp+var_2C], 1	; jumptable 0040DFB8 case 9
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	45h
		jmp	short loc_40E024
; ---------------------------------------------------------------------------

loc_40DFEA:				; CODE XREF: sub_40DEE8+D0j
					; DATA XREF: .rdata:off_41B528o
		sub	[ebp+var_2C], 1	; jumptable 0040DFB8 case 10
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	67h
		jmp	short loc_40E024
; ---------------------------------------------------------------------------

loc_40DFF6:				; CODE XREF: sub_40DEE8+D0j
					; DATA XREF: .rdata:off_41B528o
		sub	[ebp+var_2C], 1	; jumptable 0040DFB8 case 11
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	47h
		jmp	short loc_40E024
; ---------------------------------------------------------------------------

loc_40E002:				; CODE XREF: sub_40DEE8+D0j
					; DATA XREF: .rdata:off_41B528o
		sub	[ebp+var_2C], 1	; jumptable 0040DFB8 case 12
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	61h
		jmp	short loc_40E024
; ---------------------------------------------------------------------------

loc_40E00E:				; CODE XREF: sub_40DEE8+D0j
					; DATA XREF: .rdata:off_41B528o
		sub	[ebp+var_2C], 1	; jumptable 0040DFB8 case 13
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	41h
		jmp	short loc_40E024
; ---------------------------------------------------------------------------

loc_40E01A:				; CODE XREF: sub_40DEE8+C7j
		mov	eax, 0FFFFFFFFh	; jumptable 0040DFB8 default case
		jmp	loc_40E313
; ---------------------------------------------------------------------------

loc_40E024:				; CODE XREF: sub_40DEE8+DCj
					; sub_40DEE8+E8j ...
		cmp	[ebp+var_1C], 0
		jz	short loc_40E034
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	4Ch

loc_40E034:				; CODE XREF: sub_40DEE8+140j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40E0AD
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		mov	edx, 64h
		cmp	eax, 64h
		cmovg	eax, edx
		mov	[ebp+var_30], eax

loc_40E053:				; CODE XREF: sub_40DEE8+1B9j
		sub	[ebp+var_2C], 1
		mov	ecx, [ebp+var_30]
		mov	edx, 0CCCCCCCDh
		mov	eax, ecx
		mul	edx
		shr	edx, 3
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		add	eax, eax
		mov	edx, ecx
		sub	edx, eax
		mov	eax, edx
		add	eax, 30h
		mov	edx, eax
		mov	eax, [ebp+var_2C]
		mov	[eax], dl
		mov	ecx, [ebp+var_30]
		mov	[ebp+var_1CC], ecx
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_1CC]
		mul	edx
		mov	eax, edx
		shr	eax, 3
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0
		jnz	short loc_40E053
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	2Eh

loc_40E0AD:				; CODE XREF: sub_40DEE8+155j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_40E0C4
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	23h

loc_40E0C4:				; CODE XREF: sub_40DEE8+1D0j
		sub	[ebp+var_2C], 1
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	25h
		cmp	[ebp+var_1C], 0
		jz	short loc_40E100
		mov	ebx, [ebp+var_2C]
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	ecx, [ebp+var_10]
		mov	dword ptr [esp+1F8h+var_1F0], eax
		mov	dword ptr [esp+1F8h+var_1F0+4],	edx
		mov	[esp+1F8h+var_1E8], ecx
		mov	[esp+1F8h+Format], ebx ; Format
		lea	eax, [ebp+var_19A]
		mov	[esp+1F8h+Dest], eax ; Dest
		call	sprintf
		jmp	short loc_40E11C
; ---------------------------------------------------------------------------

loc_40E100:				; CODE XREF: sub_40DEE8+1EAj
		mov	eax, [ebp+var_2C]
		fld	[ebp+var_28]
		fstp	[esp+1F8h+var_1F0]
		mov	[esp+1F8h+Format], eax ; Format
		lea	eax, [ebp+var_19A]
		mov	[esp+1F8h+Dest], eax ; Dest
		call	sprintf

loc_40E11C:				; CODE XREF: sub_40DEE8+216j
		lea	eax, [ebp+var_19A]
		mov	[ebp+var_2C], eax
		lea	eax, [ebp+var_19A]
		mov	[ebp+var_1D0], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1D0]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		mov	edx, [ebp+var_2C]
		add	eax, edx
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_2C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_40E176
		mov	[ebp+var_1AF], 2Dh
		add	[ebp+var_2C], 1
		sub	[ebp+var_30], 1
		jmp	short loc_40E1A0
; ---------------------------------------------------------------------------

loc_40E176:				; CODE XREF: sub_40DEE8+27Bj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 4
		test	eax, eax
		jz	short loc_40E18C
		mov	[ebp+var_1AF], 2Bh
		jmp	short loc_40E1A0
; ---------------------------------------------------------------------------

loc_40E18C:				; CODE XREF: sub_40DEE8+299j
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 8
		test	eax, eax
		jz	short loc_40E1A0
		mov	[ebp+var_1AF], 20h

loc_40E1A0:				; CODE XREF: sub_40DEE8+28Cj
					; sub_40DEE8+2A2j ...
		movzx	eax, [ebp+var_1AF]
		test	al, al
		setnz	al
		movzx	eax, al
		mov	[ebp+var_38], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_40E219
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_40E219
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		cmp	eax, [ebp+var_30]
		jbe	short loc_40E219
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		sub	eax, [ebp+var_30]
		mov	edx, [ebp+arg_1C]
		mov	[esp+1F8h+var_1E8], edx
		mov	dword ptr [esp+1F8h+var_1F0+4],	eax
		mov	dword ptr [esp+1F8h+var_1F0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+1F8h+Dest], eax
		call	sub_40D7D7
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_40E219
		mov	eax, [ebp+var_3C]
		jmp	loc_40E313
; ---------------------------------------------------------------------------

loc_40E219:				; CODE XREF: sub_40DEE8+2D5j
					; sub_40DEE8+2DFj ...
		movzx	eax, [ebp+var_1AF]
		test	al, al
		jz	short loc_40E25F
		mov	dword ptr [esp+1F8h+var_1F0], 1
		lea	eax, [ebp+var_1AF]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Dest], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_40E252
		mov	eax, [ebp+var_3C]
		jmp	loc_40E313
; ---------------------------------------------------------------------------

loc_40E252:				; CODE XREF: sub_40DEE8+360j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_40E25F:				; CODE XREF: sub_40DEE8+33Aj
		mov	edx, [ebp+var_34]
		mov	eax, [ebp+var_2C]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	dword ptr [esp+1F8h+var_1F0], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Dest], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_40E292
		mov	eax, [ebp+var_3C]
		jmp	loc_40E313
; ---------------------------------------------------------------------------

loc_40E292:				; CODE XREF: sub_40DEE8+3A0j
		mov	eax, [ebp+arg_1C]
		mov	edx, [eax]
		mov	ecx, [ebp+var_34]
		mov	eax, [ebp+var_2C]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jz	short loc_40E30E
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_40E30E
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		cmp	eax, [ebp+var_30]
		jbe	short loc_40E30E
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_38]
		sub	eax, [ebp+var_30]
		mov	edx, [ebp+arg_1C]
		mov	[esp+1F8h+var_1E8], edx
		mov	dword ptr [esp+1F8h+var_1F0+4],	eax
		mov	dword ptr [esp+1F8h+var_1F0], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+1F8h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+1F8h+Dest], eax
		call	sub_40D7D7
		mov	[ebp+var_3C], eax
		cmp	[ebp+var_3C], 0
		jz	short loc_40E30E
		mov	eax, [ebp+var_3C]
		jmp	short loc_40E313
; ---------------------------------------------------------------------------

loc_40E30E:				; CODE XREF: sub_40DEE8+3CDj
					; sub_40DEE8+3D7j ...
		mov	eax, 0

loc_40E313:				; CODE XREF: sub_40DEE8+A0j
					; sub_40DEE8+137j ...
		add	esp, 1F0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40DEE8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E31D	proc near		; CODE XREF: sub_40E6EB+39Fp

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_D		= byte ptr -0Dh
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 6
		jz	short loc_40E34D
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40E38D
; ---------------------------------------------------------------------------

loc_40E34D:				; CODE XREF: sub_40E31D+27j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_D], al
		mov	[esp+38h+var_30], 1
		lea	eax, [ebp+var_D]
		mov	[esp+38h+var_34], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+var_38], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40E37B
		mov	eax, [ebp+var_C]
		jmp	short locret_40E38D
; ---------------------------------------------------------------------------

loc_40E37B:				; CODE XREF: sub_40E31D+57j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, 0

locret_40E38D:				; CODE XREF: sub_40E31D+2Ej
					; sub_40E31D+5Cj
		leave
		retn
sub_40E31D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E38F	proc near		; CODE XREF: sub_40E6EB+3E3p

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 0Eh
		jz	short loc_40E3C3
		mov	eax, 0FFFFFFFFh
		jmp	loc_40E52A
; ---------------------------------------------------------------------------

loc_40E3C3:				; CODE XREF: sub_40E38F+28j
		mov	eax, [ebp+var_28]
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40E3D6
		mov	[ebp+var_10], offset aNull ; "(null)"

loc_40E3D6:				; CODE XREF: sub_40E38F+3Ej
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		test	eax, eax
		js	short loc_40E40E
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		jmp	short loc_40E3F7
; ---------------------------------------------------------------------------

loc_40E3EF:				; CODE XREF: sub_40E38F+7Bj
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1

loc_40E3F7:				; CODE XREF: sub_40E38F+5Ej
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_C]
		jbe	short loc_40E430
		mov	eax, [ebp+var_14]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_40E3EF
		jmp	short loc_40E430
; ---------------------------------------------------------------------------

loc_40E40E:				; CODE XREF: sub_40E38F+4Fj
		mov	eax, [ebp+var_10]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax

loc_40E430:				; CODE XREF: sub_40E38F+71j
					; sub_40E38F+7Dj
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jnz	short loc_40E491
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_40E491
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		jbe	short loc_40E491
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_C]
		mov	edx, [ebp+arg_1C]
		mov	[esp+58h+var_48], edx
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_40D7D7
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_40E491
		mov	eax, [ebp+var_18]
		jmp	loc_40E52A
; ---------------------------------------------------------------------------

loc_40E491:				; CODE XREF: sub_40E38F+ACj
					; sub_40E38F+B6j ...
		mov	eax, [ebp+var_C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_40E4B8
		mov	eax, [ebp+var_18]
		jmp	short loc_40E52A
; ---------------------------------------------------------------------------

loc_40E4B8:				; CODE XREF: sub_40E38F+122j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_C]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+4]
		and	eax, 2
		test	eax, eax
		jz	short loc_40E525
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		test	eax, eax
		js	short loc_40E525
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		cmp	eax, [ebp+var_C]
		jbe	short loc_40E525
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+8]
		sub	eax, [ebp+var_C]
		mov	edx, [ebp+arg_1C]
		mov	[esp+58h+var_48], edx
		mov	[esp+58h+var_4C], eax
		mov	[esp+58h+var_50], 20h
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_40D7D7
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_40E525
		mov	eax, [ebp+var_18]
		jmp	short loc_40E52A
; ---------------------------------------------------------------------------

loc_40E525:				; CODE XREF: sub_40E38F+143j
					; sub_40E38F+14Dj ...
		mov	eax, 0

loc_40E52A:				; CODE XREF: sub_40E38F+2Fj
					; sub_40E38F+FDj ...
		add	esp, 54h
		pop	edi
		pop	ebp
		retn
sub_40E38F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E530	proc near		; CODE XREF: sub_40E6EB+427p

var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_7C		= byte ptr -7Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 0A4h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_98], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_94], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_90], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_8C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		cmp	eax, 13h
		jz	short loc_40E573
		mov	eax, 0FFFFFFFFh
		jmp	loc_40E62E
; ---------------------------------------------------------------------------

loc_40E573:				; CODE XREF: sub_40E530+37j
		mov	eax, [ebp+var_98]
		mov	[ebp+var_C], eax
		lea	eax, [ebp+var_7C]
		add	eax, 64h
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_10], eax

loc_40E58B:				; CODE XREF: sub_40E530+7Ej
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		and	eax, 0Fh
		movzx	edx, ds:byte_41B54F[eax]
		mov	eax, [ebp+var_10]
		mov	[eax], dl
		mov	eax, [ebp+var_C]
		shr	eax, 4
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40E58B
		jmp	short loc_40E5BC
; ---------------------------------------------------------------------------

loc_40E5B2:				; CODE XREF: sub_40E530+9Bj
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	30h

loc_40E5BC:				; CODE XREF: sub_40E530+80j
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		cmp	eax, 7
		jbe	short loc_40E5B2
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	78h
		sub	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	30h
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	[esp+0A8h+var_A0], eax
		mov	eax, [ebp+var_10]
		mov	[esp+0A8h+var_A4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0A8h+var_A8], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_40E611
		mov	eax, [ebp+var_18]
		jmp	short loc_40E62E
; ---------------------------------------------------------------------------

loc_40E611:				; CODE XREF: sub_40E530+DAj
		mov	eax, [ebp+arg_1C]
		mov	edx, [eax]
		mov	ecx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	ebx, ecx
		sub	ebx, eax
		mov	eax, ebx
		add	edx, eax
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		mov	eax, 0

loc_40E62E:				; CODE XREF: sub_40E530+3Ej
					; sub_40E530+DFj
		add	esp, 0A4h
		pop	ebx
		pop	ebp
		retn
sub_40E530	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E637	proc near		; CODE XREF: sub_40E6EB+468p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_10]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_14]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax+24h]
		sub	eax, 15h	; switch 8 cases
		cmp	eax, 7
		ja	short loc_40E6DD ; jumptable 0040E66A default case
		mov	eax, ds:off_41B564[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40E66C:				; CODE XREF: sub_40E637+33j
					; DATA XREF: .rdata:off_41B564o
		mov	eax, [ebp+var_10] ; jumptable 0040E66A case 21
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], dl
		jmp	short loc_40E6E4
; ---------------------------------------------------------------------------

loc_40E678:				; CODE XREF: sub_40E637+33j
					; DATA XREF: .rdata:off_41B564o
		mov	eax, [ebp+var_10] ; jumptable 0040E66A case 22
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], dx
		jmp	short loc_40E6E4
; ---------------------------------------------------------------------------

loc_40E685:				; CODE XREF: sub_40E637+33j
					; DATA XREF: .rdata:off_41B564o
		mov	eax, [ebp+var_10] ; jumptable 0040E66A case 24
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_40E6E4
; ---------------------------------------------------------------------------

loc_40E691:				; CODE XREF: sub_40E637+33j
					; DATA XREF: .rdata:off_41B564o
		mov	ecx, [ebp+var_10] ; jumptable 0040E66A case 25
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, 0
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_40E6E4
; ---------------------------------------------------------------------------

loc_40E6A5:				; CODE XREF: sub_40E637+33j
					; DATA XREF: .rdata:off_41B564o
		mov	ecx, [ebp+var_10] ; jumptable 0040E66A case 26
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, 0
		mov	[ecx], eax
		mov	[ecx+4], edx
		jmp	short loc_40E6E4
; ---------------------------------------------------------------------------

loc_40E6B9:				; CODE XREF: sub_40E637+33j
					; DATA XREF: .rdata:off_41B564o
		mov	eax, [ebp+var_10] ; jumptable 0040E66A case 27
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_40E6E4
; ---------------------------------------------------------------------------

loc_40E6C5:				; CODE XREF: sub_40E637+33j
					; DATA XREF: .rdata:off_41B564o
		mov	eax, [ebp+var_10] ; jumptable 0040E66A case 28
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_40E6E4
; ---------------------------------------------------------------------------

loc_40E6D1:				; CODE XREF: sub_40E637+33j
					; DATA XREF: .rdata:off_41B564o
		mov	eax, [ebp+var_10] ; jumptable 0040E66A case 23
		mov	edx, [ebp+arg_1C]
		mov	edx, [edx]
		mov	[eax], edx
		jmp	short loc_40E6E4
; ---------------------------------------------------------------------------

loc_40E6DD:				; CODE XREF: sub_40E637+2Aj
		mov	eax, 0FFFFFFFFh	; jumptable 0040E66A default case
		jmp	short locret_40E6E9
; ---------------------------------------------------------------------------

loc_40E6E4:				; CODE XREF: sub_40E637+3Fj
					; sub_40E637+4Cj ...
		mov	eax, 0

locret_40E6E9:				; CODE XREF: sub_40E637+ABj
		leave
		retn
sub_40E637	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40E6EB	proc near		; CODE XREF: sub_40EBCB+550p

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_14], eax
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_10], eax
		jmp	loc_40EB6B
; ---------------------------------------------------------------------------

loc_40E710:				; CODE XREF: sub_40E6EB+488j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_40E723
		add	[ebp+var_10], 1
		jmp	loc_40EB6B
; ---------------------------------------------------------------------------

loc_40E723:				; CODE XREF: sub_40E6EB+2Dj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+arg_8]
		jz	short loc_40E773
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40E764
		mov	eax, [ebp+var_C]
		jmp	locret_40EBC9
; ---------------------------------------------------------------------------

loc_40E764:				; CODE XREF: sub_40E6EB+6Fj
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_40E773:				; CODE XREF: sub_40E6EB+3Ej
		mov	eax, [ebp+var_10]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_40E7C7
		mov	[esp+58h+var_50], 1
		mov	eax, [ebp+var_10]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40E7AB
		mov	eax, [ebp+var_C]
		jmp	locret_40EBC9
; ---------------------------------------------------------------------------

loc_40E7AB:				; CODE XREF: sub_40E6EB+B6j
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx
		add	[ebp+var_10], 2
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_8], eax
		jmp	loc_40EB6B
; ---------------------------------------------------------------------------

loc_40E7C7:				; CODE XREF: sub_40E6EB+93j
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		add	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_8], eax
		mov	eax, [ebp+var_18]
		cmp	eax, [ebp+arg_10]
		jb	short loc_40E7F9
		mov	[esp+58h+var_50], 52Dh ; int
		mov	[esp+58h+var_54], offset a____Gnupg22__3 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aArgidxArgspecs ; "argidx < argspecs_len"
		call	sub_4185A0

loc_40E7F9:				; CODE XREF: sub_40E6EB+F0j
		add	[ebp+var_18], 1
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	loc_40E88D
		mov	eax, [ebp+var_14]
		mov	eax, [eax+1Ch]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	eax, 6
		jz	short loc_40E844
		mov	[esp+58h+var_50], 533h ; int
		mov	[esp+58h+var_54], offset a____Gnupg22__3 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aValuetableArgW ; "valuetable[arg->width_pos-1].vt == VALT"...
		call	sub_4185A0

loc_40E844:				; CODE XREF: sub_40E6EB+13Bj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+1Ch]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_14]
		mov	[eax+8], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		test	eax, eax
		jns	short loc_40E88D
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	edx, eax
		neg	edx
		mov	eax, [ebp+var_14]
		mov	[eax+8], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	edx, eax
		or	edx, 2
		mov	eax, [ebp+var_14]
		mov	[eax+4], edx

loc_40E88D:				; CODE XREF: sub_40E6EB+11Bj
					; sub_40E6EB+17Fj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_40E902
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	eax, 6
		jz	short loc_40E8D0
		mov	[esp+58h+var_50], 53Dh ; int
		mov	[esp+58h+var_54], offset a____Gnupg22__3 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aValuetableArgP ; "valuetable[arg->precision_pos-1].vt	== "...
		call	sub_4185A0

loc_40E8D0:				; CODE XREF: sub_40E6EB+1C7j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+20h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_14]
		mov	[eax+0Ch], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jns	short loc_40E902
		mov	eax, [ebp+var_14]
		mov	dword ptr [eax+0Ch], 0FFFFFFFFh

loc_40E902:				; CODE XREF: sub_40E6EB+1ABj
					; sub_40E6EB+20Bj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_40E928
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		cmp	eax, 11h
		jnz	short loc_40E928
		mov	eax, [ebp+arg_18]
		mov	[esp+58h+var_58], eax ;	int
		call	strerror
		mov	[ebp+var_30], eax
		jmp	short loc_40E992
; ---------------------------------------------------------------------------

loc_40E928:				; CODE XREF: sub_40E6EB+220j
					; sub_40E6EB+22Bj
		mov	eax, [ebp+var_14]
		mov	ecx, [eax+24h]
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	eax, [eax]
		cmp	ecx, eax
		jz	short loc_40E965
		mov	[esp+58h+var_50], 547h ; int
		mov	[esp+58h+var_54], offset a____Gnupg22__3 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aArgVtValuetabl ; "arg->vt == valuetable[arg->arg_pos-1].v"...
		call	sub_4185A0

loc_40E965:				; CODE XREF: sub_40E6EB+25Cj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		lea	edx, [eax-1]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+arg_14]
		mov	edx, [eax+8]
		mov	[ebp+var_30], edx
		mov	edx, [eax+0Ch]
		mov	[ebp+var_2C], edx
		mov	edx, [eax+10h]
		mov	[ebp+var_28], edx
		mov	eax, [eax+14h]
		mov	[ebp+var_24], eax

loc_40E992:				; CODE XREF: sub_40E6EB+23Bj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		cmp	eax, 12h	; switch 19 cases
		ja	loc_40EB5C	; jumptable 0040E9A8 default case
		mov	eax, ds:off_41B65C[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40E9AA:				; CODE XREF: sub_40E6EB+2BDj
					; DATA XREF: .rdata:off_41B65Co
		mov	[esp+58h+var_50], 54Dh ; jumptable 0040E9A8 case 0
		mov	[esp+58h+var_54], offset a____Gnupg22__3 ; "../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+58h+var_58], offset aBug ;	"!\"bug\""
		call	sub_4185A0
		jmp	loc_40EB5C	; jumptable 0040E9A8 default case
; ---------------------------------------------------------------------------

loc_40E9CB:				; CODE XREF: sub_40E6EB+2BDj
					; DATA XREF: .rdata:off_41B65Co
		mov	eax, [ebp+arg_1C] ; jumptable 0040E9A8 cases 1-5
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_40D855
		mov	[ebp+var_C], eax
		jmp	loc_40EB5C	; jumptable 0040E9A8 default case
; ---------------------------------------------------------------------------

loc_40EA0F:				; CODE XREF: sub_40E6EB+2BDj
					; DATA XREF: .rdata:off_41B65Co
		mov	eax, [ebp+arg_1C] ; jumptable 0040E9A8 cases 6-13
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_40DEE8
		mov	[ebp+var_C], eax
		jmp	loc_40EB5C	; jumptable 0040E9A8 default case
; ---------------------------------------------------------------------------

loc_40EA53:				; CODE XREF: sub_40E6EB+2BDj
					; DATA XREF: .rdata:off_41B65Co
		mov	eax, [ebp+arg_1C] ; jumptable 0040E9A8 case 14
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_40E31D
		mov	[ebp+var_C], eax
		jmp	loc_40EB5C	; jumptable 0040E9A8 default case
; ---------------------------------------------------------------------------

loc_40EA97:				; CODE XREF: sub_40E6EB+2BDj
					; DATA XREF: .rdata:off_41B65Co
		mov	eax, [ebp+arg_1C] ; jumptable 0040E9A8 cases 15,17
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_40E38F
		mov	[ebp+var_C], eax
		jmp	loc_40EB5C	; jumptable 0040E9A8 default case
; ---------------------------------------------------------------------------

loc_40EADB:				; CODE XREF: sub_40E6EB+2BDj
					; DATA XREF: .rdata:off_41B65Co
		mov	eax, [ebp+arg_1C] ; jumptable 0040E9A8 case 16
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_40E530
		mov	[ebp+var_C], eax
		jmp	short loc_40EB5C ; jumptable 0040E9A8 default case
; ---------------------------------------------------------------------------

loc_40EB1C:				; CODE XREF: sub_40E6EB+2BDj
					; DATA XREF: .rdata:off_41B65Co
		mov	eax, [ebp+arg_1C] ; jumptable 0040E9A8 case 18
		mov	[esp+58h+var_3C], eax
		mov	eax, [ebp+var_30]
		mov	[esp+58h+var_4C], eax
		mov	eax, [ebp+var_2C]
		mov	[esp+58h+var_48], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+var_44], eax
		mov	eax, [ebp+var_24]
		mov	[esp+58h+var_40], eax
		mov	eax, [ebp+var_14]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+var_58], eax
		call	sub_40E637
		mov	[ebp+var_C], eax
		nop

loc_40EB5C:				; CODE XREF: sub_40E6EB+2B0j
					; sub_40E6EB+2DBj ...
		cmp	[ebp+var_C], 0	; jumptable 0040E9A8 default case
		jz	short loc_40EB67
		mov	eax, [ebp+var_C]
		jmp	short locret_40EBC9
; ---------------------------------------------------------------------------

loc_40EB67:				; CODE XREF: sub_40E6EB+475j
		add	[ebp+var_14], 28h

loc_40EB6B:				; CODE XREF: sub_40E6EB+20j
					; sub_40E6EB+33j ...
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_40E710
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	short loc_40EBA9
		mov	eax, [ebp+var_1C]
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+58h+var_54], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+var_58], eax
		mov	eax, [ebp+arg_0]
		call	eax
		jmp	short loc_40EBAE
; ---------------------------------------------------------------------------

loc_40EBA9:				; CODE XREF: sub_40E6EB+4A1j
		mov	eax, 0

loc_40EBAE:				; CODE XREF: sub_40E6EB+4BCj
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40EBC6
		mov	eax, [ebp+arg_1C]
		mov	eax, [eax]
		mov	edx, eax
		add	edx, [ebp+var_1C]
		mov	eax, [ebp+arg_1C]
		mov	[eax], edx

loc_40EBC6:				; CODE XREF: sub_40E6EB+4CAj
		mov	eax, [ebp+var_C]

locret_40EBC9:				; CODE XREF: sub_40E6EB+74j
					; sub_40E6EB+BBj ...
		leave
		retn
sub_40E6EB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40EBCB	proc near		; CODE XREF: sub_40789F+32p
					; .text:0040F1F7p ...

NumOfElements	= dword	ptr -1E8h
SizeOfElements	= dword	ptr -1E4h
var_1E0		= dword	ptr -1E0h
var_1DC		= dword	ptr -1DCh
var_1D8		= dword	ptr -1D8h
var_1D4		= dword	ptr -1D4h
var_1D0		= dword	ptr -1D0h
var_1CC		= dword	ptr -1CCh
var_1BC		= dword	ptr -1BCh
var_1B4		= dword	ptr -1B4h
var_1B0		= byte ptr -1B0h
var_F0		= dword	ptr -0F0h
var_EC		= dword	ptr -0ECh
var_E8		= byte ptr -0E8h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Memory		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 1E0h
		lea	eax, [ebp+var_E8]
		mov	[ebp+var_EC], eax
		lea	eax, [ebp+var_1B0]
		mov	[ebp+Memory], eax
		mov	[ebp+var_1B4], 0
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_F0]
		mov	[esp+1E8h+var_1DC], eax
		mov	[esp+1E8h+var_1E0], 5
		lea	eax, [ebp+var_EC]
		mov	[esp+1E8h+SizeOfElements], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+1E8h+NumOfElements], eax
		call	sub_40CD81
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	loc_40F145
		mov	[ebp+var_14], 0
		mov	[ebp+var_1C], 0
		jmp	loc_40ED11
; ---------------------------------------------------------------------------

loc_40EC48:				; CODE XREF: sub_40EBCB+14Fj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40EC9D
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, [ebp+var_1C]
		jle	short loc_40EC9D
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		mov	[ebp+var_1C], eax

loc_40EC9D:				; CODE XREF: sub_40EBCB+98j
					; sub_40EBCB+B5j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		cmp	eax, [ebp+var_1C]
		jle	short loc_40ECD5
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		mov	[ebp+var_1C], eax

loc_40ECD5:				; CODE XREF: sub_40EBCB+EDj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		cmp	eax, [ebp+var_1C]
		jle	short loc_40ED0D
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		mov	[ebp+var_1C], eax

loc_40ED0D:				; CODE XREF: sub_40EBCB+125j
		add	[ebp+var_14], 1

loc_40ED11:				; CODE XREF: sub_40EBCB+78j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_40EC48
		cmp	[ebp+var_1C], 0
		jnz	loc_40EE05
		mov	[ebp+var_14], 0
		jmp	loc_40EDF1
; ---------------------------------------------------------------------------

loc_40ED36:				; CODE XREF: sub_40EBCB+22Fj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_40ED73
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		lea	edx, [ecx+eax]
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		mov	[edx+1Ch], eax

loc_40ED73:				; CODE XREF: sub_40EBCB+186j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_40EDB0
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		lea	edx, [ecx+eax]
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		mov	[edx+20h], eax

loc_40EDB0:				; CODE XREF: sub_40EBCB+1C3j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40EDED
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		lea	edx, [ecx+eax]
		add	[ebp+var_1C], 1
		mov	eax, [ebp+var_1C]
		mov	[edx+18h], eax

loc_40EDED:				; CODE XREF: sub_40EBCB+200j
		add	[ebp+var_14], 1

loc_40EDF1:				; CODE XREF: sub_40EBCB+166j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_40ED36
		jmp	loc_40EEBE
; ---------------------------------------------------------------------------

loc_40EE05:				; CODE XREF: sub_40EBCB+159j
		mov	[ebp+var_14], 0
		jmp	loc_40EEAF
; ---------------------------------------------------------------------------

loc_40EE11:				; CODE XREF: sub_40EBCB+2EDj
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		test	eax, eax
		jz	loc_40F12F
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_40EE6E
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		test	eax, eax
		jz	loc_40F12F

loc_40EE6E:				; CODE XREF: sub_40EBCB+281j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_40EEAB
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		test	eax, eax
		jz	loc_40F12F

loc_40EEAB:				; CODE XREF: sub_40EBCB+2BEj
		add	[ebp+var_14], 1

loc_40EEAF:				; CODE XREF: sub_40EBCB+241j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_40EE11

loc_40EEBE:				; CODE XREF: sub_40EBCB+235j
		cmp	[ebp+var_1C], 0
		js	loc_40F12F
		mov	ebx, [ebp+var_1C]
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1BC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1BC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	ebx, eax
		jnb	loc_40F12F
		mov	eax, [ebp+var_1C]
		cmp	eax, 8
		jbe	short loc_40EF21
		mov	eax, [ebp+var_1C]
		mov	[esp+1E8h+SizeOfElements], 18h ; SizeOfElements
		mov	[esp+1E8h+NumOfElements], eax ;	NumOfElements
		call	calloc
		mov	[ebp+Memory], eax
		cmp	[ebp+Memory], 0
		jnz	short loc_40EF49
		jmp	loc_40F13C
; ---------------------------------------------------------------------------

loc_40EF21:				; CODE XREF: sub_40EBCB+333j
		mov	[ebp+var_18], 0
		jmp	short loc_40EF43
; ---------------------------------------------------------------------------

loc_40EF2A:				; CODE XREF: sub_40EBCB+37Cj
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	dword ptr [eax], 0
		add	[ebp+var_18], 1

loc_40EF43:				; CODE XREF: sub_40EBCB+35Dj
		cmp	[ebp+var_18], 7
		jbe	short loc_40EF2A

loc_40EF49:				; CODE XREF: sub_40EBCB+34Fj
		mov	[ebp+var_14], 0
		jmp	loc_40F0AA
; ---------------------------------------------------------------------------

loc_40EF55:				; CODE XREF: sub_40EBCB+4E8j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jz	short loc_40EFD4
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+18h]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_40F125
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		mov	ecx, eax
		add	ecx, [ebp+Memory]
		mov	ebx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ebx
		mov	eax, [eax+24h]
		mov	[ecx], eax

loc_40EFD4:				; CODE XREF: sub_40EBCB+3A5j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+8]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_40F03D
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+1Ch]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_40F128
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	dword ptr [eax], 6

loc_40F03D:				; CODE XREF: sub_40EBCB+424j
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+0Ch]
		cmp	eax, 0FFFFFFFEh
		jnz	short loc_40F0A6
		mov	ecx, [ebp+var_EC]
		mov	edx, [ebp+var_14]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		shl	eax, 3
		add	eax, ecx
		mov	eax, [eax+20h]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_40F12B
		mov	edx, [ebp+var_18]
		mov	eax, edx
		add	eax, eax
		add	eax, edx
		shl	eax, 3
		add	eax, [ebp+Memory]
		mov	dword ptr [eax], 6

loc_40F0A6:				; CODE XREF: sub_40EBCB+48Dj
		add	[ebp+var_14], 1

loc_40F0AA:				; CODE XREF: sub_40EBCB+385j
		mov	eax, [ebp+var_F0]
		cmp	[ebp+var_14], eax
		jb	loc_40EF55
		mov	eax, [ebp+var_1C]
		mov	edx, [ebp+arg_C]
		mov	[esp+1E8h+var_1E0], edx
		mov	[esp+1E8h+SizeOfElements], eax
		mov	eax, [ebp+Memory]
		mov	[esp+1E8h+NumOfElements], eax
		call	sub_40D4F9
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40F12E
		mov	edx, [ebp+var_F0]
		mov	eax, [ebp+var_EC]
		lea	ecx, [ebp+var_1B4]
		mov	[esp+1E8h+var_1CC], ecx
		mov	ecx, [ebp+var_20]
		mov	[esp+1E8h+var_1D0], ecx
		mov	ecx, [ebp+Memory]
		mov	[esp+1E8h+var_1D4], ecx
		mov	[esp+1E8h+var_1D8], edx
		mov	[esp+1E8h+var_1DC], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+1E8h+var_1E0], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+1E8h+SizeOfElements], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+1E8h+NumOfElements], eax
		call	sub_40E6EB
		mov	[ebp+var_10], eax
		jmp	short loc_40F146
; ---------------------------------------------------------------------------

loc_40F125:				; CODE XREF: sub_40EBCB+3D8j
		nop
		jmp	short loc_40F12F
; ---------------------------------------------------------------------------

loc_40F128:				; CODE XREF: sub_40EBCB+457j
		nop
		jmp	short loc_40F12F
; ---------------------------------------------------------------------------

loc_40F12B:				; CODE XREF: sub_40EBCB+4C0j
		nop
		jmp	short loc_40F12F
; ---------------------------------------------------------------------------

loc_40F12E:				; CODE XREF: sub_40EBCB+50Ej
		nop

loc_40F12F:				; CODE XREF: sub_40EBCB+260j
					; sub_40EBCB+29Dj ...
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h

loc_40F13C:				; CODE XREF: sub_40EBCB+351j
		mov	[ebp+var_10], 0FFFFFFFFh
		jmp	short loc_40F146
; ---------------------------------------------------------------------------

loc_40F145:				; CODE XREF: sub_40EBCB+64j
		nop

loc_40F146:				; CODE XREF: sub_40EBCB+558j
					; sub_40EBCB+578j
		lea	eax, [ebp+var_1B0]
		cmp	[ebp+Memory], eax
		jz	short loc_40F15C
		mov	eax, [ebp+Memory]
		mov	[esp+1E8h+NumOfElements], eax ;	Memory
		call	free

loc_40F15C:				; CODE XREF: sub_40EBCB+584j
		mov	edx, [ebp+var_EC]
		lea	eax, [ebp+var_E8]
		cmp	edx, eax
		jz	short loc_40F17A
		mov	eax, [ebp+var_EC]
		mov	[esp+1E8h+NumOfElements], eax ;	Memory
		call	free

loc_40F17A:				; CODE XREF: sub_40EBCB+59Fj
		mov	eax, [ebp+var_10]
		add	esp, 1E0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_40EBCB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40F187(int, void *, size_t)
sub_40F187	proc near		; DATA XREF: .text:0040F1F0o
					; .text:0040F227o ...

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 1 ; Count
		mov	edx, [ebp+arg_8]
		mov	[esp+28h+Size],	edx ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		cmp	eax, 1
		jz	short loc_40F1C0
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40F1C5
; ---------------------------------------------------------------------------

loc_40F1C0:				; CODE XREF: sub_40F187+30j
		mov	eax, 0

locret_40F1C5:				; CODE XREF: sub_40F187+37j
		leave
		retn
sub_40F187	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	edx, ds:_iob
		add	edx, 40h
		mov	[esp+0Ch], eax
		mov	eax, [ebp+8]
		mov	[esp+8], eax
		mov	[esp+4], edx
		mov	dword ptr [esp], offset	sub_40F187
		call	sub_40EBCB
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+10h]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	sub_40F187
		call	sub_40EBCB
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	sub_40F187
		call	sub_40EBCB
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40F264(int, void *, size_t)
sub_40F264	proc near		; CODE XREF: sub_40F320+6Dp
					; DATA XREF: sub_40F320+42o

Dst		= dword	ptr -28h
Src		= dword	ptr -24h
Size		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_40F319
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	edx, eax
		jnb	short loc_40F304
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	ecx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		add	eax, ecx
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+Src], edx ; Src
		mov	[esp+28h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		jmp	short loc_40F319
; ---------------------------------------------------------------------------

loc_40F2DC:				; CODE XREF: sub_40F264+B3j
		mov	eax, [ebp+var_C]
		mov	edx, [eax+0Ch]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		lea	ecx, [edx+eax]
		mov	edx, [ebp+arg_4]
		movzx	edx, byte ptr [edx]
		mov	[ecx], dl
		lea	edx, [eax+1]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		add	[ebp+arg_4], 1
		sub	[ebp+arg_8], 1

loc_40F304:				; CODE XREF: sub_40F264+3Dj
		cmp	[ebp+arg_8], 0
		jz	short loc_40F319
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		cmp	edx, eax
		jb	short loc_40F2DC

loc_40F319:				; CODE XREF: sub_40F264+25j
					; sub_40F264+76j ...
		mov	eax, 0
		leave
		retn
sub_40F264	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F320	proc near		; CODE XREF: sub_40F3D9+29p

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_1C], eax
		mov	[ebp+var_18], 0
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_4], 0
		jz	short loc_40F345
		mov	eax, [ebp+arg_0]
		jmp	short loc_40F34A
; ---------------------------------------------------------------------------

loc_40F345:				; CODE XREF: sub_40F320+1Ej
		mov	eax, 0

loc_40F34A:				; CODE XREF: sub_40F320+23j
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_34], eax
		mov	[esp+38h+var_38], offset sub_40F264
		call	sub_40EBCB
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40F395
		mov	[esp+38h+var_30], 1 ; size_t
		mov	[esp+38h+var_34], offset byte_41B6A8 ; void *
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+var_38], eax ;	int
		call	sub_40F264
		mov	[ebp+var_C], eax

loc_40F395:				; CODE XREF: sub_40F320+55j
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_40F3A2
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40F3D7
; ---------------------------------------------------------------------------

loc_40F3A2:				; CODE XREF: sub_40F320+79j
		cmp	[ebp+arg_4], 0
		jz	short loc_40F3CB
		cmp	[ebp+arg_0], 0
		jz	short loc_40F3CB
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jz	short loc_40F3CB
		mov	edx, [ebp+var_18]
		mov	eax, [ebp+var_1C]
		cmp	edx, eax
		jb	short loc_40F3CB
		mov	eax, [ebp+var_1C]
		sub	eax, 1
		add	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0

loc_40F3CB:				; CODE XREF: sub_40F320+86j
					; sub_40F320+8Cj ...
		mov	eax, [ebp+var_18]
		sub	eax, 1
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]

locret_40F3D7:				; CODE XREF: sub_40F320+80j
		leave
		retn
sub_40F320	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F3D9	proc near		; CODE XREF: .text:0040A714p
					; .text:0040ACE4p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_C]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_40F320
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_40F3D9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40F40F(int, void *Src, size_t)
sub_40F40F	proc near		; CODE XREF: sub_40F51B+83p
					; DATA XREF: sub_40F51B+58o

Memory		= dword	ptr -28h
NewSize		= dword	ptr -24h
Size		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
Src		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40F43C
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	edx, [ebp+var_C]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, 0FFFFFFFFh
		jmp	locret_40F519
; ---------------------------------------------------------------------------

loc_40F43C:				; CODE XREF: sub_40F40F+13j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	edx, eax
		jb	loc_40F4DD
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		add	eax, [ebp+arg_8]
		lea	edx, [eax+200h]
		mov	eax, [ebp+var_C]
		mov	[eax+4], edx
		mov	eax, [ebp+var_C]
		mov	edx, [eax+4]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	[esp+28h+NewSize], edx ; NewSize
		mov	[esp+28h+Memory], eax ;	Memory
		call	realloc
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_40F4D4
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_40F4A3
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		jmp	short loc_40F4A8
; ---------------------------------------------------------------------------

loc_40F4A3:				; CODE XREF: sub_40F40F+87j
		mov	eax, 0Ch

loc_40F4A8:				; CODE XREF: sub_40F40F+92j
		mov	edx, [ebp+var_C]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		mov	edx, [eax+8]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	[esp+28h+Size],	edx ; Size
		mov	[esp+28h+NewSize], 0 ; Val
		mov	[esp+28h+Memory], eax ;	Dst
		call	memset
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40F519
; ---------------------------------------------------------------------------

loc_40F4D4:				; CODE XREF: sub_40F40F+7Aj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		mov	[eax+0Ch], edx

loc_40F4DD:				; CODE XREF: sub_40F40F+40j
		mov	edx, [ebp+Src]
		mov	eax, [ebp+var_C]
		mov	eax, [eax+0Ch]
		mov	ecx, eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		add	eax, ecx
		mov	ecx, [ebp+arg_8]
		mov	[esp+28h+Size],	ecx ; Size
		mov	[esp+28h+NewSize], edx ; Src
		mov	[esp+28h+Memory], eax ;	Dst
		call	memcpy
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	edx, eax
		add	edx, [ebp+arg_8]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, 0

locret_40F519:				; CODE XREF: sub_40F40F+28j
					; sub_40F40F+C3j
		leave
		retn
sub_40F40F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_40F51B	proc near		; CODE XREF: .text:004097D1p
					; .text:00409805p ...

Dst		= dword	ptr -38h
Val		= dword	ptr -34h
Size		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[ebp+var_1C], 0
		mov	[ebp+var_18], 200h
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dst], eax ; size_t
		call	sub_404CAE
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		test	eax, eax
		jnz	short loc_40F55E
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh
		jmp	locret_40F632
; ---------------------------------------------------------------------------

loc_40F55E:				; CODE XREF: sub_40F51B+2Ej
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_2C], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Size],	eax
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+Val], eax
		mov	[esp+38h+Dst], offset sub_40F40F
		call	sub_40EBCB
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_40F5A6
		mov	[esp+38h+Size],	1 ; size_t
		mov	[esp+38h+Val], offset byte_41B6A8 ; Src
		lea	eax, [ebp+var_1C]
		mov	[esp+38h+Dst], eax ; int
		call	sub_40F40F
		mov	[ebp+var_C], eax

loc_40F5A6:				; CODE XREF: sub_40F51B+6Bj
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	short loc_40F5C6
		mov	eax, [ebp+var_1C]
		test	eax, eax
		jz	short loc_40F5C6
		mov	[ebp+var_C], 0FFFFFFFFh
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	edx, [ebp+var_1C]
		mov	[eax], edx

loc_40F5C6:				; CODE XREF: sub_40F51B+8Fj
					; sub_40F51B+96j
		cmp	[ebp+var_C], 0FFFFFFFFh
		jnz	short loc_40F601
		mov	edx, [ebp+var_14]
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Val], 0 ; Val
		mov	[esp+38h+Dst], eax ; Dst
		call	memset
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax ; void *
		call	sub_404E31
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], 0
		mov	eax, 0FFFFFFFFh
		jmp	short locret_40F632
; ---------------------------------------------------------------------------

loc_40F601:				; CODE XREF: sub_40F51B+AFj
		mov	eax, [ebp+var_14]
		test	eax, eax
		jnz	short loc_40F624
		mov	[esp+38h+Size],	6E9h ; int
		mov	[esp+38h+Val], offset a____Gnupg22__3 ;	"../../gnupg2-2.0.30/common/estream-prin"...
		mov	[esp+38h+Dst], offset aParm_used ; "parm.used"
		call	sub_4185A0

loc_40F624:				; CODE XREF: sub_40F51B+EBj
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	[eax], edx
		mov	eax, [ebp+var_14]
		sub	eax, 1

locret_40F632:				; CODE XREF: sub_40F51B+3Ej
					; sub_40F51B+E4j
		leave
		retn
sub_40F51B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+10h]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_40F51B
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_40F664(char *)
sub_40F664	proc near		; CODE XREF: sub_41082E+1Dp
					; .text:00411188p

VarName		= dword	ptr -38h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_12		= word ptr -12h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+VarName], offset VarName ; "LC_ALL"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40F691
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40F691
		mov	eax, [ebp+var_C]
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F691:				; CODE XREF: sub_40F664+19j
					; sub_40F664+23j
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+VarName], eax ; VarName
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40F6B7
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40F6B7
		mov	eax, [ebp+var_C]
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F6B7:				; CODE XREF: sub_40F664+3Fj
					; sub_40F664+49j
		mov	[esp+38h+VarName], offset aLang	; "LANG"
		call	getenv
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_40F6DE
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_40F6DE
		mov	eax, [ebp+var_C]
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F6DE:				; CODE XREF: sub_40F664+66j
					; sub_40F664+70j
		mov	eax, ds:GetThreadLocale
		call	eax ; GetThreadLocale
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+var_12], ax
		movzx	eax, [ebp+var_12]
		and	eax, 3FFh
		mov	[ebp+var_18], eax
		movzx	eax, [ebp+var_12]
		shr	ax, 0Ah
		movzx	eax, ax
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_18], 79h ; switch 122 cases
		ja	loc_4101A4	; jumptable 0040F720 default case
		mov	eax, [ebp+var_18]
		shl	eax, 2
		add	eax, offset off_41BC1C
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40F722:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aAf_za ; jumptable 0040F720	case 54
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F72C:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aSq_al ; jumptable 0040F720	case 28
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F736:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aAm_et ; jumptable 0040F720	case 94
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F740:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		cmp	[ebp+var_1C], 10h ; jumptable 0040F720 case 1
		ja	loc_40F7F9	; jumptable 0040F757 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_41BE04
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40F759:				; CODE XREF: sub_40F664+F3j
					; DATA XREF: .rdata:off_41BE04o
		mov	eax, offset aAr_sa ; jumptable 0040F757	case 1
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F763:				; CODE XREF: sub_40F664+F3j
					; DATA XREF: .rdata:off_41BE04o
		mov	eax, offset aAr_iq ; jumptable 0040F757	case 2
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F76D:				; CODE XREF: sub_40F664+F3j
					; DATA XREF: .rdata:off_41BE04o
		mov	eax, offset aAr_eg ; jumptable 0040F757	case 3
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F777:				; CODE XREF: sub_40F664+F3j
					; DATA XREF: .rdata:off_41BE04o
		mov	eax, offset aAr_ly ; jumptable 0040F757	case 4
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F781:				; CODE XREF: sub_40F664+F3j
					; DATA XREF: .rdata:off_41BE04o
		mov	eax, offset aAr_dz ; jumptable 0040F757	case 5
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F78B:				; CODE XREF: sub_40F664+F3j
					; DATA XREF: .rdata:off_41BE04o
		mov	eax, offset aAr_ma ; jumptable 0040F757	case 6
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F795:				; CODE XREF: sub_40F664+F3j
					; DATA XREF: .rdata:off_41BE04o
		mov	eax, offset aAr_tn ; jumptable 0040F757	case 7
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F79F:				; CODE XREF: sub_40F664+F3j
					; DATA XREF: .rdata:off_41BE04o
		mov	eax, offset aAr_om ; jumptable 0040F757	case 8
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F7A9:				; CODE XREF: sub_40F664+F3j
					; DATA XREF: .rdata:off_41BE04o
		mov	eax, offset aAr_ye ; jumptable 0040F757	case 9
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F7B3:				; CODE XREF: sub_40F664+F3j
					; DATA XREF: .rdata:off_41BE04o
		mov	eax, offset aAr_sy ; jumptable 0040F757	case 10
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F7BD:				; CODE XREF: sub_40F664+F3j
					; DATA XREF: .rdata:off_41BE04o
		mov	eax, offset aAr_jo ; jumptable 0040F757	case 11
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F7C7:				; CODE XREF: sub_40F664+F3j
					; DATA XREF: .rdata:off_41BE04o
		mov	eax, offset aAr_lb ; jumptable 0040F757	case 12
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F7D1:				; CODE XREF: sub_40F664+F3j
					; DATA XREF: .rdata:off_41BE04o
		mov	eax, offset aAr_kw ; jumptable 0040F757	case 13
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F7DB:				; CODE XREF: sub_40F664+F3j
					; DATA XREF: .rdata:off_41BE04o
		mov	eax, offset aAr_ae ; jumptable 0040F757	case 14
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F7E5:				; CODE XREF: sub_40F664+F3j
					; DATA XREF: .rdata:off_41BE04o
		mov	eax, offset aAr_bh ; jumptable 0040F757	case 15
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F7EF:				; CODE XREF: sub_40F664+F3j
					; DATA XREF: .rdata:off_41BE04o
		mov	eax, offset aAr_qa ; jumptable 0040F757	case 16
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F7F9:				; CODE XREF: sub_40F664+E0j
					; sub_40F664+F3j
					; DATA XREF: ...
		mov	eax, offset aAr	; jumptable 0040F757 default case
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F803:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aHy_am ; jumptable 0040F720	case 43
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F80D:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aAs_in ; jumptable 0040F720	case 77
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F817:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, [ebp+var_1C] ; jumptable 0040F720 case 44
		cmp	eax, 1
		jz	short loc_40F826
		cmp	eax, 2
		jz	short loc_40F830
		jmp	short loc_40F83A
; ---------------------------------------------------------------------------

loc_40F826:				; CODE XREF: sub_40F664+1B9j
		mov	eax, offset aAz_az@latin ; "az_AZ@latin"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F830:				; CODE XREF: sub_40F664+1BEj
		mov	eax, offset aAz_az@cyrillic ; "az_AZ@cyrillic"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F83A:				; CODE XREF: sub_40F664+1C0j
		mov	eax, offset aAz	; "az"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F844:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aEu	; jumptable 0040F720 case 45
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F84E:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aBe_by ; jumptable 0040F720	case 35
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F858:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, [ebp+var_1C] ; jumptable 0040F720 case 69
		cmp	eax, 1
		jz	short loc_40F867
		cmp	eax, 2
		jz	short loc_40F871
		jmp	short loc_40F87B
; ---------------------------------------------------------------------------

loc_40F867:				; CODE XREF: sub_40F664+1FAj
		mov	eax, offset aBn_in ; "bn_IN"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F871:				; CODE XREF: sub_40F664+1FFj
		mov	eax, offset aBn_bd ; "bn_BD"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F87B:				; CODE XREF: sub_40F664+201j
		mov	eax, offset aBn	; "bn"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F885:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aBg_bg ; jumptable 0040F720	case 2
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F88F:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aMy_mm ; jumptable 0040F720	case 85
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F899:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aKm_kh ; jumptable 0040F720	case 83
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F8A3:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aCa_es ; jumptable 0040F720	case 3
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F8AD:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aChr_us ; jumptable	0040F720 case 92
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F8B7:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		cmp	[ebp+var_1C], 5	; jumptable 0040F720 case 4
		ja	short loc_40F8FE ; jumptable 0040F8CA default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_41BE48
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40F8CC:				; CODE XREF: sub_40F664+266j
					; DATA XREF: .rdata:off_41BE48o
		mov	eax, offset aZh_tw ; jumptable 0040F8CA	case 1
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F8D6:				; CODE XREF: sub_40F664+266j
					; DATA XREF: .rdata:off_41BE48o
		mov	eax, offset aZh_cn ; jumptable 0040F8CA	case 2
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F8E0:				; CODE XREF: sub_40F664+266j
					; DATA XREF: .rdata:off_41BE48o
		mov	eax, offset aZh_hk ; jumptable 0040F8CA	case 3
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F8EA:				; CODE XREF: sub_40F664+266j
					; DATA XREF: .rdata:off_41BE48o
		mov	eax, offset aZh_sg ; jumptable 0040F8CA	case 4
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F8F4:				; CODE XREF: sub_40F664+266j
					; DATA XREF: .rdata:off_41BE48o
		mov	eax, offset aZh_mo ; jumptable 0040F8CA	case 5
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F8FE:				; CODE XREF: sub_40F664+257j
					; sub_40F664+266j
					; DATA XREF: ...
		mov	eax, offset aZh	; jumptable 0040F8CA default case
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F908:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, [ebp+var_1C] ; jumptable 0040F720 case 26
		cmp	eax, 2
		jz	short loc_40F924
		cmp	eax, 3
		jz	short loc_40F92E
		cmp	eax, 1
		jnz	short loc_40F938
		mov	eax, offset aHr_hr ; "hr_HR"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F924:				; CODE XREF: sub_40F664+2AAj
		mov	eax, offset aSr_cs ; "sr_CS"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F92E:				; CODE XREF: sub_40F664+2AFj
		mov	eax, offset aSr_cs@cyrillic ; "sr_CS@cyrillic"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F938:				; CODE XREF: sub_40F664+2B4j
		mov	eax, offset aHr	; "hr"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F942:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aCs_cz ; jumptable 0040F720	case 5
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F94C:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aDa_dk ; jumptable 0040F720	case 6
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F956:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aDiv_mv ; jumptable	0040F720 case 101
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F960:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, [ebp+var_1C] ; jumptable 0040F720 case 19
		cmp	eax, 1
		jz	short loc_40F96F
		cmp	eax, 2
		jz	short loc_40F979
		jmp	short loc_40F983
; ---------------------------------------------------------------------------

loc_40F96F:				; CODE XREF: sub_40F664+302j
		mov	eax, offset aNl_nl ; "nl_NL"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F979:				; CODE XREF: sub_40F664+307j
		mov	eax, offset aNl_be ; "nl_BE"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F983:				; CODE XREF: sub_40F664+309j
		mov	eax, offset aNl	; "nl"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F98D:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aBin_ng ; jumptable	0040F720 case 102
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F997:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		cmp	[ebp+var_1C], 12h ; jumptable 0040F720 case 9
		ja	loc_40FA64	; jumptable 0040F9AE default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_41BE60
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40F9B0:				; CODE XREF: sub_40F664+34Aj
					; DATA XREF: .rdata:off_41BE60o
		mov	eax, offset aEn_us ; jumptable 0040F9AE	case 1
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F9BA:				; CODE XREF: sub_40F664+34Aj
					; DATA XREF: .rdata:off_41BE60o
		mov	eax, offset aEn_gb ; jumptable 0040F9AE	case 2
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F9C4:				; CODE XREF: sub_40F664+34Aj
					; DATA XREF: .rdata:off_41BE60o
		mov	eax, offset aEn_au ; jumptable 0040F9AE	case 3
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F9CE:				; CODE XREF: sub_40F664+34Aj
					; DATA XREF: .rdata:off_41BE60o
		mov	eax, offset aEn_ca ; jumptable 0040F9AE	case 4
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F9D8:				; CODE XREF: sub_40F664+34Aj
					; DATA XREF: .rdata:off_41BE60o
		mov	eax, offset aEn_nz ; jumptable 0040F9AE	case 5
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F9E2:				; CODE XREF: sub_40F664+34Aj
					; DATA XREF: .rdata:off_41BE60o
		mov	eax, offset aEn_ie ; jumptable 0040F9AE	case 6
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F9EC:				; CODE XREF: sub_40F664+34Aj
					; DATA XREF: .rdata:off_41BE60o
		mov	eax, offset aEn_za ; jumptable 0040F9AE	case 7
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40F9F6:				; CODE XREF: sub_40F664+34Aj
					; DATA XREF: .rdata:off_41BE60o
		mov	eax, offset aEn_jm ; jumptable 0040F9AE	case 8
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FA00:				; CODE XREF: sub_40F664+34Aj
					; DATA XREF: .rdata:off_41BE60o
		mov	eax, offset aEn_gd ; jumptable 0040F9AE	case 9
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FA0A:				; CODE XREF: sub_40F664+34Aj
					; DATA XREF: .rdata:off_41BE60o
		mov	eax, offset aEn_bz ; jumptable 0040F9AE	case 10
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FA14:				; CODE XREF: sub_40F664+34Aj
					; DATA XREF: .rdata:off_41BE60o
		mov	eax, offset aEn_tt ; jumptable 0040F9AE	case 11
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FA1E:				; CODE XREF: sub_40F664+34Aj
					; DATA XREF: .rdata:off_41BE60o
		mov	eax, offset aEn_zw ; jumptable 0040F9AE	case 12
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FA28:				; CODE XREF: sub_40F664+34Aj
					; DATA XREF: .rdata:off_41BE60o
		mov	eax, offset aEn_ph ; jumptable 0040F9AE	case 13
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FA32:				; CODE XREF: sub_40F664+34Aj
					; DATA XREF: .rdata:off_41BE60o
		mov	eax, offset aEn_id ; jumptable 0040F9AE	case 14
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FA3C:				; CODE XREF: sub_40F664+34Aj
					; DATA XREF: .rdata:off_41BE60o
		mov	eax, offset aEn_hk ; jumptable 0040F9AE	case 15
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FA46:				; CODE XREF: sub_40F664+34Aj
					; DATA XREF: .rdata:off_41BE60o
		mov	eax, offset aEn_in ; jumptable 0040F9AE	case 16
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FA50:				; CODE XREF: sub_40F664+34Aj
					; DATA XREF: .rdata:off_41BE60o
		mov	eax, offset aEn_my ; jumptable 0040F9AE	case 17
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FA5A:				; CODE XREF: sub_40F664+34Aj
					; DATA XREF: .rdata:off_41BE60o
		mov	eax, offset aEn_sg ; jumptable 0040F9AE	case 18
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FA64:				; CODE XREF: sub_40F664+337j
					; sub_40F664+34Aj
					; DATA XREF: ...
		mov	eax, offset aEn	; jumptable 0040F9AE default case
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FA6E:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aEt_ee ; jumptable 0040F720	case 37
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FA78:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aFo_fo ; jumptable 0040F720	case 56
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FA82:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aFa_ir ; jumptable 0040F720	case 41
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FA8C:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aFi_fi ; jumptable 0040F720	case 11
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FA96:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		cmp	[ebp+var_1C], 0Fh ; jumptable 0040F720 case 12
		ja	loc_40FB45	; jumptable 0040FAAD default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_41BEAC
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40FAAF:				; CODE XREF: sub_40F664+449j
					; DATA XREF: .rdata:off_41BEACo
		mov	eax, offset aFr_fr ; jumptable 0040FAAD	case 1
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FAB9:				; CODE XREF: sub_40F664+449j
					; DATA XREF: .rdata:off_41BEACo
		mov	eax, offset aFr_be ; jumptable 0040FAAD	case 2
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FAC3:				; CODE XREF: sub_40F664+449j
					; DATA XREF: .rdata:off_41BEACo
		mov	eax, offset aFr_ca ; jumptable 0040FAAD	case 3
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FACD:				; CODE XREF: sub_40F664+449j
					; DATA XREF: .rdata:off_41BEACo
		mov	eax, offset aFr_ch ; jumptable 0040FAAD	case 4
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FAD7:				; CODE XREF: sub_40F664+449j
					; DATA XREF: .rdata:off_41BEACo
		mov	eax, offset aFr_lu ; jumptable 0040FAAD	case 5
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FAE1:				; CODE XREF: sub_40F664+449j
					; DATA XREF: .rdata:off_41BEACo
		mov	eax, offset aFr_mc ; jumptable 0040FAAD	case 6
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FAEB:				; CODE XREF: sub_40F664+449j
					; DATA XREF: .rdata:off_41BEACo
		mov	eax, offset aFr	; jumptable 0040FAAD case 7
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FAF5:				; CODE XREF: sub_40F664+449j
					; DATA XREF: .rdata:off_41BEACo
		mov	eax, offset aFr_re ; jumptable 0040FAAD	case 8
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FAFF:				; CODE XREF: sub_40F664+449j
					; DATA XREF: .rdata:off_41BEACo
		mov	eax, offset aFr_cg ; jumptable 0040FAAD	case 9
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FB09:				; CODE XREF: sub_40F664+449j
					; DATA XREF: .rdata:off_41BEACo
		mov	eax, offset aFr_sn ; jumptable 0040FAAD	case 10
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FB13:				; CODE XREF: sub_40F664+449j
					; DATA XREF: .rdata:off_41BEACo
		mov	eax, offset aFr_cm ; jumptable 0040FAAD	case 11
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FB1D:				; CODE XREF: sub_40F664+449j
					; DATA XREF: .rdata:off_41BEACo
		mov	eax, offset aFr_ci ; jumptable 0040FAAD	case 12
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FB27:				; CODE XREF: sub_40F664+449j
					; DATA XREF: .rdata:off_41BEACo
		mov	eax, offset aFr_ml ; jumptable 0040FAAD	case 13
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FB31:				; CODE XREF: sub_40F664+449j
					; DATA XREF: .rdata:off_41BEACo
		mov	eax, offset aFr_ma ; jumptable 0040FAAD	case 14
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FB3B:				; CODE XREF: sub_40F664+449j
					; DATA XREF: .rdata:off_41BEACo
		mov	eax, offset aFr_ht ; jumptable 0040FAAD	case 15
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FB45:				; CODE XREF: sub_40F664+436j
					; sub_40F664+449j
					; DATA XREF: ...
		mov	eax, offset aFr	; jumptable 0040FAAD default case
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FB4F:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aFy_nl ; jumptable 0040F720	case 98
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FB59:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aFul_ng ; jumptable	0040F720 case 103
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FB63:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, [ebp+var_1C] ; jumptable 0040F720 case 60
		cmp	eax, 1
		jz	short loc_40FB72
		cmp	eax, 2
		jz	short loc_40FB7C
		jmp	short loc_40FB86
; ---------------------------------------------------------------------------

loc_40FB72:				; CODE XREF: sub_40F664+505j
		mov	eax, offset aGd_gb ; "gd_GB"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FB7C:				; CODE XREF: sub_40F664+50Aj
		mov	eax, offset aGa_ie ; "ga_IE"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FB86:				; CODE XREF: sub_40F664+50Cj
		mov	eax, offset aC	; "C"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FB90:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aGl_es ; jumptable 0040F720	case 86
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FB9A:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aKa_ge ; jumptable 0040F720	case 55
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FBA4:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		cmp	[ebp+var_1C], 5	; jumptable 0040F720 case 7
		ja	short loc_40FBEB ; jumptable 0040FBB7 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_41BEEC
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40FBB9:				; CODE XREF: sub_40F664+553j
					; DATA XREF: .rdata:off_41BEECo
		mov	eax, offset aDe_de ; jumptable 0040FBB7	case 1
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FBC3:				; CODE XREF: sub_40F664+553j
					; DATA XREF: .rdata:off_41BEECo
		mov	eax, offset aDe_ch ; jumptable 0040FBB7	case 2
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FBCD:				; CODE XREF: sub_40F664+553j
					; DATA XREF: .rdata:off_41BEECo
		mov	eax, offset aDe_at ; jumptable 0040FBB7	case 3
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FBD7:				; CODE XREF: sub_40F664+553j
					; DATA XREF: .rdata:off_41BEECo
		mov	eax, offset aDe_lu ; jumptable 0040FBB7	case 4
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FBE1:				; CODE XREF: sub_40F664+553j
					; DATA XREF: .rdata:off_41BEECo
		mov	eax, offset aDe_li ; jumptable 0040FBB7	case 5
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FBEB:				; CODE XREF: sub_40F664+544j
					; sub_40F664+553j
					; DATA XREF: ...
		mov	eax, offset aDe	; jumptable 0040FBB7 default case
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FBF5:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aEl_gr ; jumptable 0040F720	case 8
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FBFF:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aGn_py ; jumptable 0040F720	case 116
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FC09:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aGu_in ; jumptable 0040F720	case 71
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FC13:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aHa_ng ; jumptable 0040F720	case 104
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FC1D:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aCpe_us ; jumptable	0040F720 case 117
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FC27:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aHe_il ; jumptable 0040F720	case 13
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FC31:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aHi_in ; jumptable 0040F720	case 57
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FC3B:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aHu_hu ; jumptable 0040F720	case 14
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FC45:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aNic_ng ; jumptable	0040F720 case 105
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FC4F:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aIs_is ; jumptable 0040F720	case 15
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FC59:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aIbo_ng ; jumptable	0040F720 case 112
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FC63:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aId_id ; jumptable 0040F720	case 33
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FC6D:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aIu_ca ; jumptable 0040F720	case 93
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FC77:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, [ebp+var_1C] ; jumptable 0040F720 case 16
		cmp	eax, 1
		jz	short loc_40FC86
		cmp	eax, 2
		jz	short loc_40FC90
		jmp	short loc_40FC9A
; ---------------------------------------------------------------------------

loc_40FC86:				; CODE XREF: sub_40F664+619j
		mov	eax, offset aIt_it ; "it_IT"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FC90:				; CODE XREF: sub_40F664+61Ej
		mov	eax, offset aIt_ch ; "it_CH"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FC9A:				; CODE XREF: sub_40F664+620j
		mov	eax, offset aIt	; "it"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FCA4:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aJa_jp ; jumptable 0040F720	case 17
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FCAE:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aKn_in ; jumptable 0040F720	case 75
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FCB8:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aKau_ng ; jumptable	0040F720 case 113
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FCC2:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, [ebp+var_1C] ; jumptable 0040F720 case 96
		cmp	eax, 1
		jz	short loc_40FCD1
		cmp	eax, 2
		jz	short loc_40FCDB
		jmp	short loc_40FCE5
; ---------------------------------------------------------------------------

loc_40FCD1:				; CODE XREF: sub_40F664+664j
		mov	eax, offset aKs_pk ; "ks_PK"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FCDB:				; CODE XREF: sub_40F664+669j
		mov	eax, offset aKs_in ; "ks_IN"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FCE5:				; CODE XREF: sub_40F664+66Bj
		mov	eax, offset aKs	; "ks"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FCEF:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aKk_kz ; jumptable 0040F720	case 63
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FCF9:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aKok_in ; jumptable	0040F720 case 87
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FD03:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aKo_kr ; jumptable 0040F720	case 18
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FD0D:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aKy_kg ; jumptable 0040F720	case 64
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FD17:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aLo_la ; jumptable 0040F720	case 84
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FD21:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aLa_va ; jumptable 0040F720	case 118
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FD2B:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aLv_lv ; jumptable 0040F720	case 38
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FD35:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aLt_lt ; jumptable 0040F720	case 39
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FD3F:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aMk_mk ; jumptable 0040F720	case 47
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FD49:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, [ebp+var_1C] ; jumptable 0040F720 case 62
		cmp	eax, 1
		jz	short loc_40FD58
		cmp	eax, 2
		jz	short loc_40FD62
		jmp	short loc_40FD6C
; ---------------------------------------------------------------------------

loc_40FD58:				; CODE XREF: sub_40F664+6EBj
		mov	eax, offset aMs_my ; "ms_MY"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FD62:				; CODE XREF: sub_40F664+6F0j
		mov	eax, offset aMs_bn ; "ms_BN"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FD6C:				; CODE XREF: sub_40F664+6F2j
		mov	eax, offset aMs	; "ms"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FD76:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aMl_in ; jumptable 0040F720	case 76
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FD80:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aMt_mt ; jumptable 0040F720	case 58
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FD8A:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aMni_in ; jumptable	0040F720 case 88
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FD94:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aMr_in ; jumptable 0040F720	case 78
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FD9E:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aMn	; jumptable 0040F720 case 80
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FDA8:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, [ebp+var_1C] ; jumptable 0040F720 case 97
		cmp	eax, 1
		jz	short loc_40FDB7
		cmp	eax, 2
		jz	short loc_40FDC1
		jmp	short loc_40FDCB
; ---------------------------------------------------------------------------

loc_40FDB7:				; CODE XREF: sub_40F664+74Aj
		mov	eax, offset aNe_np ; "ne_NP"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FDC1:				; CODE XREF: sub_40F664+74Fj
		mov	eax, offset aNe_in ; "ne_IN"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FDCB:				; CODE XREF: sub_40F664+751j
		mov	eax, offset aNe	; "ne"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FDD5:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, [ebp+var_1C] ; jumptable 0040F720 case 20
		cmp	eax, 1
		jz	short loc_40FDE4
		cmp	eax, 2
		jz	short loc_40FDEE
		jmp	short loc_40FDF8
; ---------------------------------------------------------------------------

loc_40FDE4:				; CODE XREF: sub_40F664+777j
		mov	eax, offset aNo_no ; "no_NO"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FDEE:				; CODE XREF: sub_40F664+77Cj
		mov	eax, offset aNn_no ; "nn_NO"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FDF8:				; CODE XREF: sub_40F664+77Ej
		mov	eax, offset aNo	; "no"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FE02:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aOr_in ; jumptable 0040F720	case 72
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FE0C:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aOm_et ; jumptable 0040F720	case 114
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FE16:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aPap_an ; jumptable	0040F720 case 121
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FE20:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aPs	; jumptable 0040F720 case 99
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FE2A:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aPl_pl ; jumptable 0040F720	case 21
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FE34:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, [ebp+var_1C] ; jumptable 0040F720 case 22
		cmp	eax, 1
		jz	short loc_40FE4B
		cmp	eax, 2
		jnz	short loc_40FE55
		mov	eax, offset aPt_pt ; "pt_PT"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FE4B:				; CODE XREF: sub_40F664+7D6j
		mov	eax, offset aPt_br ; "pt_BR"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FE55:				; CODE XREF: sub_40F664+7DBj
		mov	eax, offset aPt	; "pt"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FE5F:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, [ebp+var_1C] ; jumptable 0040F720 case 70
		cmp	eax, 1
		jnz	short loc_40FE71
		mov	eax, offset aPa_in ; "pa_IN"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FE71:				; CODE XREF: sub_40F664+801j
		mov	eax, offset aPa	; "pa"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FE7B:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aRm_ch ; jumptable 0040F720	case 23
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FE85:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, [ebp+var_1C] ; jumptable 0040F720 case 24
		cmp	eax, 1
		jnz	short loc_40FE97
		mov	eax, offset aRo_ro ; "ro_RO"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FE97:				; CODE XREF: sub_40F664+827j
		mov	eax, offset aRo	; "ro"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FEA1:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aRu	; jumptable 0040F720 case 25
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FEAB:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aSe_no ; jumptable 0040F720	case 59
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FEB5:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aSa_in ; jumptable 0040F720	case 79
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FEBF:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, [ebp+var_1C] ; jumptable 0040F720 case 89
		test	eax, eax
		jz	short loc_40FECD
		cmp	eax, 1
		jz	short loc_40FED7
		jmp	short loc_40FEE1
; ---------------------------------------------------------------------------

loc_40FECD:				; CODE XREF: sub_40F664+860j
		mov	eax, offset aSd_in ; "sd_IN"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FED7:				; CODE XREF: sub_40F664+865j
		mov	eax, offset aSd_pk ; "sd_PK"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FEE1:				; CODE XREF: sub_40F664+867j
		mov	eax, offset aSd	; "sd"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FEEB:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aSi_lk ; jumptable 0040F720	case 91
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FEF5:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aSk_sk ; jumptable 0040F720	case 27
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FEFF:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aSl_si ; jumptable 0040F720	case 36
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FF09:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aSo_so ; jumptable 0040F720	case 119
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FF13:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aWen_de ; jumptable	0040F720 case 46
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FF1D:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		cmp	[ebp+var_1C], 14h ; jumptable 0040F720 case 10
		ja	loc_40FFFE	; jumptable 0040FF34 default case
		mov	eax, [ebp+var_1C]
		shl	eax, 2
		add	eax, offset off_41BF04
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_40FF36:				; CODE XREF: sub_40F664+8D0j
					; DATA XREF: .rdata:off_41BF04o
		mov	eax, offset aEs_es ; jumptable 0040FF34	case 1
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FF40:				; CODE XREF: sub_40F664+8D0j
					; DATA XREF: .rdata:off_41BF04o
		mov	eax, offset aEs_mx ; jumptable 0040FF34	case 2
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FF4A:				; CODE XREF: sub_40F664+8D0j
					; DATA XREF: .rdata:off_41BF04o
		mov	eax, offset aEs_es@modern ; jumptable 0040FF34 case 3
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FF54:				; CODE XREF: sub_40F664+8D0j
					; DATA XREF: .rdata:off_41BF04o
		mov	eax, offset aEs_gt ; jumptable 0040FF34	case 4
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FF5E:				; CODE XREF: sub_40F664+8D0j
					; DATA XREF: .rdata:off_41BF04o
		mov	eax, offset aEs_cr ; jumptable 0040FF34	case 5
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FF68:				; CODE XREF: sub_40F664+8D0j
					; DATA XREF: .rdata:off_41BF04o
		mov	eax, offset aEs_pa ; jumptable 0040FF34	case 6
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FF72:				; CODE XREF: sub_40F664+8D0j
					; DATA XREF: .rdata:off_41BF04o
		mov	eax, offset aEs_do ; jumptable 0040FF34	case 7
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FF7C:				; CODE XREF: sub_40F664+8D0j
					; DATA XREF: .rdata:off_41BF04o
		mov	eax, offset aEs_ve ; jumptable 0040FF34	case 8
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FF86:				; CODE XREF: sub_40F664+8D0j
					; DATA XREF: .rdata:off_41BF04o
		mov	eax, offset aEs_co ; jumptable 0040FF34	case 9
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FF90:				; CODE XREF: sub_40F664+8D0j
					; DATA XREF: .rdata:off_41BF04o
		mov	eax, offset aEs_pe ; jumptable 0040FF34	case 10
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FF9A:				; CODE XREF: sub_40F664+8D0j
					; DATA XREF: .rdata:off_41BF04o
		mov	eax, offset aEs_ar ; jumptable 0040FF34	case 11
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FFA4:				; CODE XREF: sub_40F664+8D0j
					; DATA XREF: .rdata:off_41BF04o
		mov	eax, offset aEs_ec ; jumptable 0040FF34	case 12
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FFAE:				; CODE XREF: sub_40F664+8D0j
					; DATA XREF: .rdata:off_41BF04o
		mov	eax, offset aEs_cl ; jumptable 0040FF34	case 13
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FFB8:				; CODE XREF: sub_40F664+8D0j
					; DATA XREF: .rdata:off_41BF04o
		mov	eax, offset aEs_uy ; jumptable 0040FF34	case 14
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FFC2:				; CODE XREF: sub_40F664+8D0j
					; DATA XREF: .rdata:off_41BF04o
		mov	eax, offset aEs_py ; jumptable 0040FF34	case 15
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FFCC:				; CODE XREF: sub_40F664+8D0j
					; DATA XREF: .rdata:off_41BF04o
		mov	eax, offset aEs_bo ; jumptable 0040FF34	case 16
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FFD6:				; CODE XREF: sub_40F664+8D0j
					; DATA XREF: .rdata:off_41BF04o
		mov	eax, offset aEs_sv ; jumptable 0040FF34	case 17
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FFE0:				; CODE XREF: sub_40F664+8D0j
					; DATA XREF: .rdata:off_41BF04o
		mov	eax, offset aEs_hn ; jumptable 0040FF34	case 18
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FFEA:				; CODE XREF: sub_40F664+8D0j
					; DATA XREF: .rdata:off_41BF04o
		mov	eax, offset aEs_ni ; jumptable 0040FF34	case 19
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FFF4:				; CODE XREF: sub_40F664+8D0j
					; DATA XREF: .rdata:off_41BF04o
		mov	eax, offset aEs_pr ; jumptable 0040FF34	case 20
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_40FFFE:				; CODE XREF: sub_40F664+8BDj
					; sub_40F664+8D0j
					; DATA XREF: ...
		mov	eax, offset aEs	; jumptable 0040FF34 default case
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_410008:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aBnt_tz ; jumptable	0040F720 case 48
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_410012:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aSw_ke ; jumptable 0040F720	case 65
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_41001C:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, [ebp+var_1C] ; jumptable 0040F720 case 29
		cmp	eax, 1
		jz	short loc_41002B
		cmp	eax, 2
		jz	short loc_410035
		jmp	short loc_41003F
; ---------------------------------------------------------------------------

loc_41002B:				; CODE XREF: sub_40F664+9BEj
		mov	eax, offset aSv_se ; "sv_SE"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_410035:				; CODE XREF: sub_40F664+9C3j
		mov	eax, offset aSv_fi ; "sv_FI"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_41003F:				; CODE XREF: sub_40F664+9C5j
		mov	eax, offset aSv	; "sv"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_410049:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aSyr_tr ; jumptable	0040F720 case 90
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_410053:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aTl_ph ; jumptable 0040F720	case 100
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_41005D:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aTg_tj ; jumptable 0040F720	case 40
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_410067:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, [ebp+var_1C] ; jumptable 0040F720 case 95
		cmp	eax, 1
		jz	short loc_410076
		cmp	eax, 2
		jz	short loc_410080
		jmp	short loc_41008A
; ---------------------------------------------------------------------------

loc_410076:				; CODE XREF: sub_40F664+A09j
		mov	eax, offset aBer_ma@arabic ; "ber_MA@arabic"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_410080:				; CODE XREF: sub_40F664+A0Ej
		mov	eax, offset aBer_ma@latin ; "ber_MA@latin"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_41008A:				; CODE XREF: sub_40F664+A10j
		mov	eax, offset aBer_ma ; "ber_MA"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_410094:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aTa	; jumptable 0040F720 case 73
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_41009E:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aTt_ru ; jumptable 0040F720	case 68
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_4100A8:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aTe_in ; jumptable 0040F720	case 74
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_4100B2:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aTh_th ; jumptable 0040F720	case 30
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_4100BC:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aBo_cn ; jumptable 0040F720	case 81
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_4100C6:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, [ebp+var_1C] ; jumptable 0040F720 case 115
		test	eax, eax
		jz	short loc_4100D4
		cmp	eax, 1
		jz	short loc_4100DE
		jmp	short loc_4100E8
; ---------------------------------------------------------------------------

loc_4100D4:				; CODE XREF: sub_40F664+A67j
		mov	eax, offset aTi_et ; "ti_ET"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_4100DE:				; CODE XREF: sub_40F664+A6Cj
		mov	eax, offset aTi_er ; "ti_ER"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_4100E8:				; CODE XREF: sub_40F664+A6Ej
		mov	eax, offset aTi	; "ti"
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_4100F2:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aTs_za ; jumptable 0040F720	case 49
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_4100FC:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aTn_bw ; jumptable 0040F720	case 50
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_410106:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aTr_tr ; jumptable 0040F720	case 31
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_410110:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aTk_tm ; jumptable 0040F720	case 66
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_41011A:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aUk_ua ; jumptable 0040F720	case 34
		jmp	locret_4101A9
; ---------------------------------------------------------------------------

loc_410124:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, [ebp+var_1C] ; jumptable 0040F720 case 32
		cmp	eax, 1
		jz	short loc_410133
		cmp	eax, 2
		jz	short loc_41013A
		jmp	short loc_410141
; ---------------------------------------------------------------------------

loc_410133:				; CODE XREF: sub_40F664+AC6j
		mov	eax, offset aUr_pk ; "ur_PK"
		jmp	short locret_4101A9
; ---------------------------------------------------------------------------

loc_41013A:				; CODE XREF: sub_40F664+ACBj
		mov	eax, offset aUr_in ; "ur_IN"
		jmp	short locret_4101A9
; ---------------------------------------------------------------------------

loc_410141:				; CODE XREF: sub_40F664+ACDj
		mov	eax, offset aUr	; "ur"
		jmp	short locret_4101A9
; ---------------------------------------------------------------------------

loc_410148:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, [ebp+var_1C] ; jumptable 0040F720 case 67
		cmp	eax, 1
		jz	short loc_410157
		cmp	eax, 2
		jz	short loc_41015E
		jmp	short loc_410165
; ---------------------------------------------------------------------------

loc_410157:				; CODE XREF: sub_40F664+AEAj
		mov	eax, offset aUz_uz ; "uz_UZ"
		jmp	short locret_4101A9
; ---------------------------------------------------------------------------

loc_41015E:				; CODE XREF: sub_40F664+AEFj
		mov	eax, offset aUz_uz@cyrillic ; "uz_UZ@cyrillic"
		jmp	short locret_4101A9
; ---------------------------------------------------------------------------

loc_410165:				; CODE XREF: sub_40F664+AF1j
		mov	eax, offset aUz	; "uz"
		jmp	short locret_4101A9
; ---------------------------------------------------------------------------

loc_41016C:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aVen_za ; jumptable	0040F720 case 51
		jmp	short locret_4101A9
; ---------------------------------------------------------------------------

loc_410173:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aVi_vn ; jumptable 0040F720	case 42
		jmp	short locret_4101A9
; ---------------------------------------------------------------------------

loc_41017A:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aCy_gb ; jumptable 0040F720	case 82
		jmp	short locret_4101A9
; ---------------------------------------------------------------------------

loc_410181:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aXh_za ; jumptable 0040F720	case 52
		jmp	short locret_4101A9
; ---------------------------------------------------------------------------

loc_410188:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aSit_cn ; jumptable	0040F720 case 120
		jmp	short locret_4101A9
; ---------------------------------------------------------------------------

loc_41018F:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aYi_il ; jumptable 0040F720	case 61
		jmp	short locret_4101A9
; ---------------------------------------------------------------------------

loc_410196:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aYo_ng ; jumptable 0040F720	case 106
		jmp	short locret_4101A9
; ---------------------------------------------------------------------------

loc_41019D:				; CODE XREF: sub_40F664+BCj
					; DATA XREF: .rdata:off_41BC1Co
		mov	eax, offset aZu_za ; jumptable 0040F720	case 53
		jmp	short locret_4101A9
; ---------------------------------------------------------------------------

loc_4101A4:				; CODE XREF: sub_40F664+A9j
					; sub_40F664+BCj
					; DATA XREF: ...
		mov	eax, offset aC	; jumptable 0040F720 default case

locret_4101A9:				; CODE XREF: sub_40F664+28j
					; sub_40F664+4Ej ...
		leave
		retn
sub_40F664	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4101AB	proc near		; CODE XREF: sub_41028A+1EAp
					; sub_41028A+212p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		shl	edx, 18h
		mov	eax, [ebp+arg_0]
		and	eax, 0FF00h
		shl	eax, 8
		or	edx, eax
		mov	eax, [ebp+arg_0]
		shr	eax, 8
		and	eax, 0FF00h
		or	edx, eax
		mov	eax, [ebp+arg_0]
		shr	eax, 18h
		or	eax, edx
		pop	ebp
		retn
sub_4101AB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4101DA	proc near		; CODE XREF: sub_410E59+5Fp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	[ebp+var_4], 0
		jmp	short loc_410223
; ---------------------------------------------------------------------------

loc_4101EF:				; CODE XREF: sub_4101DA+51j
		shl	[ebp+var_4], 4
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		add	[ebp+var_4], eax
		add	[ebp+var_8], 1
		mov	eax, [ebp+var_4]
		and	eax, 0F0000000h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_410223
		mov	eax, [ebp+var_C]
		shr	eax, 18h
		xor	[ebp+var_4], eax
		mov	eax, [ebp+var_C]
		xor	[ebp+var_4], eax

loc_410223:				; CODE XREF: sub_4101DA+13j
					; sub_4101DA+38j
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4101EF
		mov	eax, [ebp+var_4]
		leave
		retn
sub_4101DA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_410232(void *)
sub_410232	proc near		; CODE XREF: sub_41082E+243p

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_404E31
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_404E31
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_C], eax
		jmp	short loc_410277
; ---------------------------------------------------------------------------

loc_41025E:				; CODE XREF: sub_410232+49j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_404E31
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_410277:				; CODE XREF: sub_410232+2Aj
		cmp	[ebp+var_C], 0
		jnz	short loc_41025E
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_404E31
		leave
		retn
sub_410232	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41028A(char *)
sub_41028A	proc near		; CODE XREF: sub_41082E+214p

Filename	= dword	ptr -68h
Mode		= dword	ptr -64h
Count		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= byte ptr -58h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
File		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
DstBuf		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		sub	esp, 60h
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		mov	eax, offset Mode ; "rb"
		mov	[esp+68h+Mode],	eax ; Mode
		mov	eax, [ebp+arg_0]
		mov	[esp+68h+Filename], eax	; Filename
		call	fopen
		mov	[ebp+File], eax
		cmp	[ebp+File], 0
		jnz	short loc_4102C7
		mov	eax, 0
		jmp	loc_4105BE
; ---------------------------------------------------------------------------

loc_4102C7:				; CODE XREF: sub_41028A+31j
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	_fileno
		lea	edx, [ebp+var_58]
		mov	[esp+68h+Mode],	edx
		mov	[esp+68h+Filename], eax
		mov	eax, ds:_fstati64
		call	eax ; _fstati64
		test	eax, eax
		jnz	short loc_410310
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	[ebp+var_20], eax
		mov	ecx, [ebp+var_20]
		mov	ebx, 0
		mov	eax, [ebp+var_40]
		mov	edx, [ebp+var_3C]
		mov	esi, ebx
		xor	esi, edx
		xor	eax, ecx
		or	eax, esi
		test	eax, eax
		jnz	short loc_410310
		cmp	[ebp+var_20], 1Bh
		ja	short loc_410325

loc_410310:				; CODE XREF: sub_41028A+5Bj
					; sub_41028A+7Ej
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, 0
		jmp	loc_4105BE
; ---------------------------------------------------------------------------

loc_410325:				; CODE XREF: sub_41028A+84j
		mov	eax, [ebp+var_20]
		add	eax, eax
		cmp	eax, [ebp+var_20]
		jbe	short loc_41033E
		mov	eax, [ebp+var_20]
		add	eax, eax
		mov	[esp+68h+Filename], eax	; size_t
		call	sub_404CAE
		jmp	short loc_410343
; ---------------------------------------------------------------------------

loc_41033E:				; CODE XREF: sub_41028A+A3j
		mov	eax, 0

loc_410343:				; CODE XREF: sub_41028A+B2j
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_410361
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, 0
		jmp	loc_4105BE
; ---------------------------------------------------------------------------

loc_410361:				; CODE XREF: sub_41028A+C0j
		mov	eax, [ebp+var_20]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+DstBuf], eax

loc_41036D:				; CODE XREF: sub_41028A+13Fj
		mov	eax, [ebp+DstBuf]
		mov	edx, [ebp+File]
		mov	[esp+68h+var_5C], edx ;	File
		mov	edx, [ebp+var_C]
		mov	[esp+68h+Count], edx ; Count
		mov	[esp+68h+Mode],	1 ; ElementSize
		mov	[esp+68h+Filename], eax	; DstBuf
		call	fread
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		cmp	eax, [ebp+var_C]
		jnb	short loc_4103B9
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_404E31
		mov	eax, 0
		jmp	loc_4105BE
; ---------------------------------------------------------------------------

loc_4103B9:				; CODE XREF: sub_41028A+10Dj
		mov	eax, [ebp+var_24]
		add	[ebp+DstBuf], eax
		mov	eax, [ebp+var_24]
		sub	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_41036D
		mov	eax, [ebp+File]
		mov	[esp+68h+Filename], eax	; File
		call	fclose
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 950412DEh
		jz	short loc_410403
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 0DE120495h
		jz	short loc_410403
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_404E31
		mov	eax, 0
		jmp	loc_4105BE
; ---------------------------------------------------------------------------

loc_410403:				; CODE XREF: sub_41028A+156j
					; sub_41028A+162j
		mov	[esp+68h+Mode],	28h ; size_t
		mov	[esp+68h+Filename], 1 ;	size_t
		call	sub_404D92
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jnz	short loc_410435
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_404E31
		mov	eax, 0
		jmp	loc_4105BE
; ---------------------------------------------------------------------------

loc_410435:				; CODE XREF: sub_41028A+194j
		mov	eax, [ebp+var_18]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	edx, [ebp+var_14]
		add	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+4], edx
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		cmp	eax, 950412DEh
		setnz	al
		movzx	edx, al
		mov	eax, [ebp+var_18]
		mov	[eax+8], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41047B
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[esp+68h+Filename], eax
		call	sub_4101AB
		jmp	short loc_410481
; ---------------------------------------------------------------------------

loc_41047B:				; CODE XREF: sub_41028A+1DFj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]

loc_410481:				; CODE XREF: sub_41028A+1EFj
		test	eax, eax
		jnz	loc_410581
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4104A3
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]
		mov	[esp+68h+Filename], eax
		call	sub_4101AB
		jmp	short loc_4104A9
; ---------------------------------------------------------------------------

loc_4104A3:				; CODE XREF: sub_41028A+207j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+8]

loc_4104A9:				; CODE XREF: sub_41028A+217j
		mov	edx, [ebp+var_18]
		mov	[edx+0Ch], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4104C9
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Filename], eax
		call	sub_4101AB
		jmp	short loc_4104CF
; ---------------------------------------------------------------------------

loc_4104C9:				; CODE XREF: sub_41028A+22Dj
		mov	eax, [ebp+var_14]
		mov	eax, [eax+0Ch]

loc_4104CF:				; CODE XREF: sub_41028A+23Dj
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+18h], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_4104F4
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]
		mov	[esp+68h+Filename], eax
		call	sub_4101AB
		jmp	short loc_4104FA
; ---------------------------------------------------------------------------

loc_4104F4:				; CODE XREF: sub_41028A+258j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+10h]

loc_4104FA:				; CODE XREF: sub_41028A+268j
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_41051F
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]
		mov	[esp+68h+Filename], eax
		call	sub_4101AB
		jmp	short loc_410525
; ---------------------------------------------------------------------------

loc_41051F:				; CODE XREF: sub_41028A+283j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+14h]

loc_410525:				; CODE XREF: sub_41028A+293j
		mov	edx, [ebp+var_18]
		mov	[edx+20h], eax
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_410545
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]
		mov	[esp+68h+Filename], eax
		call	sub_4101AB
		jmp	short loc_41054B
; ---------------------------------------------------------------------------

loc_410545:				; CODE XREF: sub_41028A+2A9j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+18h]

loc_41054B:				; CODE XREF: sub_41028A+2B9j
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+var_18]
		mov	[eax+24h], edx
		nop
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		mov	[esp+68h+Mode],	4 ; size_t
		mov	[esp+68h+Filename], eax	; size_t
		call	sub_404D92
		mov	edx, eax
		mov	eax, [ebp+var_18]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+10h]
		test	eax, eax
		jnz	short loc_4105BB
		jmp	short loc_41059E
; ---------------------------------------------------------------------------

loc_410581:				; CODE XREF: sub_41028A+1F9j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_404E31
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_404E31
		mov	eax, 0
		jmp	short loc_4105BE
; ---------------------------------------------------------------------------

loc_41059E:				; CODE XREF: sub_41028A+2F5j
		mov	eax, [ebp+var_14]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_404E31
		mov	eax, [ebp+var_18]
		mov	[esp+68h+Filename], eax	; void *
		call	sub_404E31
		mov	eax, 0
		jmp	short loc_4105BE
; ---------------------------------------------------------------------------

loc_4105BB:				; CODE XREF: sub_41028A+2F3j
		mov	eax, [ebp+var_18]

loc_4105BE:				; CODE XREF: sub_41028A+38j
					; sub_41028A+96j ...
		add	esp, 60h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_41028A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4105C5(LPCSTR, int, int)
sub_4105C5	proc near		; CODE XREF: sub_4107BC+1Ap

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpMultiByteStr	= dword	ptr -30h
cbMultiByte	= dword	ptr -2Ch
lpWideCharStr	= dword	ptr -28h
cchWideChar	= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+cchWideChar], 0 ; cchWideChar
		mov	[esp+38h+lpWideCharStr], 0 ; lpWideCharStr
		mov	[esp+38h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_410615
		mov	eax, [ebp+var_C]
		add	eax, 1
		test	eax, eax
		jg	short loc_41061F

loc_410615:				; CODE XREF: sub_4105C5+44j
		mov	eax, 0
		jmp	locret_4106C5
; ---------------------------------------------------------------------------

loc_41061F:				; CODE XREF: sub_4105C5+4Ej
		mov	eax, [ebp+var_C]
		add	eax, 1
		add	eax, eax
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		mov	edx, eax
		shr	edx, 1
		mov	eax, [ebp+var_C]
		add	eax, 1
		cmp	edx, eax
		jz	short loc_41064F
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 0Ch
		mov	eax, 0
		jmp	short locret_4106C5
; ---------------------------------------------------------------------------

loc_41064F:				; CODE XREF: sub_4105C5+74j
		mov	eax, [ebp+var_10]
		mov	[esp+38h+CodePage], eax	; size_t
		call	sub_404CAE
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_41066A
		mov	eax, 0
		jmp	short locret_4106C5
; ---------------------------------------------------------------------------

loc_41066A:				; CODE XREF: sub_4105C5+9Cj
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+var_C]
		mov	[esp+38h+cchWideChar], edx ; cchWideChar
		mov	edx, [ebp+var_14]
		mov	[esp+38h+lpWideCharStr], edx ; lpWideCharStr
		mov	[esp+38h+cbMultiByte], eax ; cbMultiByte
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpMultiByteStr], eax ;	lpMultiByteStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0FDE9h ; CodePage
		mov	eax, ds:MultiByteToWideChar
		call	eax ; MultiByteToWideChar
		sub	esp, 18h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_4106BA
		mov	eax, [ebp+var_14]
		mov	[esp+38h+CodePage], eax	; void *
		call	sub_404E31
		mov	eax, 0
		jmp	short locret_4106C5
; ---------------------------------------------------------------------------

loc_4106BA:				; CODE XREF: sub_4105C5+E1j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_14]

locret_4106C5:				; CODE XREF: sub_4105C5+55j
					; sub_4105C5+88j ...
		leave
		retn
sub_4105C5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4106C7(LPCWSTR, int, int)
sub_4106C7	proc near		; CODE XREF: sub_4107BC+3Cp

CodePage	= dword	ptr -38h
dwFlags		= dword	ptr -34h
lpWideCharStr	= dword	ptr -30h
cchWideChar	= dword	ptr -2Ch
lpMultiByteStr	= dword	ptr -28h
cbMultiByte	= dword	ptr -24h
lpDefaultChar	= dword	ptr -20h
lpUsedDefaultChar= dword ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	[esp+38h+cbMultiByte], 0 ; cbMultiByte
		mov	[esp+38h+lpMultiByteStr], 0 ; lpMultiByteStr
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0 ;	CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		js	short loc_410727
		mov	eax, [ebp+var_C]
		add	eax, 1
		test	eax, eax
		jg	short loc_410731

loc_410727:				; CODE XREF: sub_4106C7+54j
		mov	eax, 0
		jmp	locret_4107BA
; ---------------------------------------------------------------------------

loc_410731:				; CODE XREF: sub_4106C7+5Ej
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+38h+CodePage], eax	; size_t
		call	sub_404CAE
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_41074F
		mov	eax, 0
		jmp	short locret_4107BA
; ---------------------------------------------------------------------------

loc_41074F:				; CODE XREF: sub_4106C7+7Fj
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+lpUsedDefaultChar], 0 ; lpUsedDefaultChar
		mov	[esp+38h+lpDefaultChar], 0 ; lpDefaultChar
		mov	edx, [ebp+var_C]
		mov	[esp+38h+cbMultiByte], edx ; cbMultiByte
		mov	edx, [ebp+var_10]
		mov	[esp+38h+lpMultiByteStr], edx ;	lpMultiByteStr
		mov	[esp+38h+cchWideChar], eax ; cchWideChar
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+lpWideCharStr], eax ; lpWideCharStr
		mov	[esp+38h+dwFlags], 0 ; dwFlags
		mov	[esp+38h+CodePage], 0 ;	CodePage
		mov	eax, ds:WideCharToMultiByte
		call	eax ; WideCharToMultiByte
		sub	esp, 20h
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jns	short loc_4107AF
		mov	eax, [ebp+var_10]
		mov	[esp+38h+CodePage], eax	; void *
		call	sub_404E31
		mov	eax, 0
		jmp	short locret_4107BA
; ---------------------------------------------------------------------------

loc_4107AF:				; CODE XREF: sub_4106C7+D4j
		mov	edx, [ebp+var_C]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		mov	eax, [ebp+var_10]

locret_4107BA:				; CODE XREF: sub_4106C7+65j
					; sub_4106C7+86j ...
		leave
		retn
sub_4106C7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4107BC(LPCSTR, int, int)
sub_4107BC	proc near		; CODE XREF: sub_410AEE+12Fp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	eax, [ebp+var_14]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	LPCSTR
		call	sub_4105C5
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_41080D
		mov	eax, [ebp+var_14]
		lea	edx, [ebp+var_14]
		mov	[esp+28h+var_20], edx ;	int
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	LPCWSTR
		call	sub_4106C7
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_404E31
		jmp	short loc_410814
; ---------------------------------------------------------------------------

loc_41080D:				; CODE XREF: sub_4107BC+26j
		mov	[ebp+var_C], 0

loc_410814:				; CODE XREF: sub_4107BC+4Fj
		cmp	[ebp+var_C], 0
		jz	short loc_41081F
		mov	eax, [ebp+var_14]
		jmp	short loc_410824
; ---------------------------------------------------------------------------

loc_41081F:				; CODE XREF: sub_4107BC+5Cj
		mov	eax, 0

loc_410824:				; CODE XREF: sub_4107BC+61j
		mov	edx, [ebp+arg_8]
		mov	[edx], eax
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4107BC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41082E(char *, char *)
sub_41082E	proc near		; CODE XREF: sub_405474+16p

Dest		= dword	ptr -48h
Source		= dword	ptr -44h
var_2C		= dword	ptr -2Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Str		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 40h
		mov	[ebp+var_10], 0
		mov	[ebp+Str], 0
		mov	[esp+48h+Dest],	offset aLc_messages ; "LC_MESSAGES"
		call	sub_40F664
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jz	short loc_4108C0
		mov	eax, [ebp+var_14]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+48h+Dest],	eax ; size_t
		call	sub_404CAE
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jz	short loc_4108C0
		mov	eax, [ebp+var_14]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	[esp+48h+Source], 5Fh ;	Val
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax ; Str
		call	strchr
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_4108C0
		mov	eax, [ebp+var_18]
		mov	byte ptr [eax],	0

loc_4108C0:				; CODE XREF: sub_41082E+29j
					; sub_41082E+5Cj ...
		cmp	[ebp+Str], 0
		jnz	short loc_4108D0
		mov	eax, 0
		jmp	loc_410A81
; ---------------------------------------------------------------------------

loc_4108D0:				; CODE XREF: sub_41082E+96j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	ebx, [eax-1]
		mov	eax, [ebp+Str]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	ebx, eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, ebx
		add	eax, 12h
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	[esp+48h+Dest],	eax ; size_t
		call	sub_404CAE
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_410960
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax ; void *
		call	sub_404E31
		mov	eax, 0
		jmp	loc_410A81
; ---------------------------------------------------------------------------

loc_410960:				; CODE XREF: sub_41082E+11Bj
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_24], 1
		mov	eax, [ebp+Str]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+Str]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_24], eax
		mov	edx, offset aLc_messages_0 ; "\\LC_MESSAGES\\"
		mov	eax, [ebp+var_24]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx
		mov	ecx, [edx+8]
		mov	[eax+8], ecx
		movzx	edx, word ptr [edx+0Ch]
		mov	[eax+0Ch], dx
		add	[ebp+var_24], 0Dh
		mov	eax, [ebp+arg_0]
		mov	[esp+48h+Source], eax ;	Source
		mov	eax, [ebp+var_24]
		mov	[esp+48h+Dest],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_24], eax
		mov	edx, offset a_mo ; ".mo"
		mov	eax, [ebp+var_24]
		mov	edx, [edx]
		mov	[eax], edx
		mov	eax, [ebp+var_20]
		mov	[esp+48h+Dest],	eax ; char *
		call	sub_41028A
		mov	[ebp+var_10], eax
		mov	eax, [ebp+Str]
		mov	[esp+48h+Dest],	eax ; void *
		call	sub_404E31
		mov	eax, [ebp+var_20]
		mov	[esp+48h+Dest],	eax ; void *
		call	sub_404E31
		mov	eax, ds:dword_41D300
		test	eax, eax
		jz	short loc_410A76
		mov	eax, ds:dword_41D300
		mov	[esp+48h+Dest],	eax ; void *
		call	sub_410232

loc_410A76:				; CODE XREF: sub_41082E+239j
		mov	eax, [ebp+var_10]
		mov	ds:dword_41D300, eax
		mov	eax, [ebp+arg_4]

loc_410A81:				; CODE XREF: sub_41082E+9Dj
					; sub_41082E+12Dj
		add	esp, 40h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41082E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_410A88(char *, int, int)
sub_410A88	proc near		; CODE XREF: sub_410AEE+35Bp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 1
		setnz	al
		movzx	eax, al
		mov	[ebp+var_C], eax
		jmp	short loc_410AE3
; ---------------------------------------------------------------------------

loc_410A9D:				; CODE XREF: sub_410A88+5Fj
		mov	[esp+28h+Val], 0 ; Val
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	edx, [ebp+arg_0]
		add	eax, edx
		cmp	eax, [ebp+var_10]
		ja	short loc_410ACA
		mov	eax, offset aErrorInGettext ; "ERROR in	GETTEXT	(bad plural entry)"
		jmp	short locret_410AEC
; ---------------------------------------------------------------------------

loc_410ACA:				; CODE XREF: sub_410A88+39j
		mov	edx, [ebp+arg_0]
		mov	eax, [ebp+var_10]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+arg_4], eax
		mov	eax, [ebp+var_10]
		mov	[ebp+arg_0], eax
		sub	[ebp+var_C], 1

loc_410AE3:				; CODE XREF: sub_410A88+13j
		cmp	[ebp+var_C], 0
		jnz	short loc_410A9D
		mov	eax, [ebp+arg_0]

locret_410AEC:				; CODE XREF: sub_410A88+40j
		leave
		retn
sub_410A88	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_410AEE	proc near		; CODE XREF: sub_410E59+158p
					; sub_410E59+27Dp

Dst		= dword	ptr -38h
Src		= dword	ptr -34h
Size		= dword	ptr -30h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		mov	eax, ds:dword_41D304
		test	eax, eax
		jz	short loc_410B7A
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_410B28
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_4101AB
		jmp	short loc_410B39
; ---------------------------------------------------------------------------

loc_410B28:				; CODE XREF: sub_410AEE+1Dj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_410B39:				; CODE XREF: sub_410AEE+38j
		add	eax, ebx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_410B62
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+38h+Dst], eax
		call	sub_4101AB
		jmp	short loc_410B72
; ---------------------------------------------------------------------------

loc_410B62:				; CODE XREF: sub_410AEE+58j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_410B72:				; CODE XREF: sub_410AEE+72j
		mov	[ebp+var_14], eax
		jmp	loc_410E29
; ---------------------------------------------------------------------------

loc_410B7A:				; CODE XREF: sub_410AEE+Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_410D6F
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_410BBC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_4101AB
		jmp	short loc_410BCD
; ---------------------------------------------------------------------------

loc_410BBC:				; CODE XREF: sub_410AEE+B1j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_410BCD:				; CODE XREF: sub_410AEE+CCj
		add	eax, ebx
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_410BF6
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+38h+Dst], eax
		call	sub_4101AB
		jmp	short loc_410C06
; ---------------------------------------------------------------------------

loc_410BF6:				; CODE XREF: sub_410AEE+ECj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_410C06:				; CODE XREF: sub_410AEE+106j
		mov	[ebp+var_1C], eax
		lea	eax, [ebp+var_28]
		mov	[esp+38h+Size],	eax ; int
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Src], eax ; int
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dst], eax ; LPCSTR
		call	sub_4107BC
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_410C3E
		mov	[ebp+var_10], offset aErrorInGette_0 ; "ERROR in GETTEXT MALLOC"
		mov	[ebp+var_14], 0
		jmp	loc_410D5F
; ---------------------------------------------------------------------------

loc_410C3E:				; CODE XREF: sub_410AEE+13Bj
		mov	eax, [ebp+var_28]
		cmp	eax, [ebp+var_1C]
		ja	loc_410CD0
		mov	eax, [ebp+var_28]
		cmp	eax, 1
		jbe	short loc_410CD0
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_410C7D
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_4101AB
		jmp	short loc_410C8E
; ---------------------------------------------------------------------------

loc_410C7D:				; CODE XREF: sub_410AEE+172j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_410C8E:				; CODE XREF: sub_410AEE+18Dj
		add	eax, ebx
		mov	[ebp+var_24], eax
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_24]
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	edx, eax
		mov	eax, [ebp+var_28]
		mov	[edx], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_14], eax
		jmp	loc_410D5F
; ---------------------------------------------------------------------------

loc_410CD0:				; CODE XREF: sub_410AEE+156j
					; sub_410AEE+162j
		mov	eax, [ebp+var_28]
		add	eax, 10h
		mov	[esp+38h+Dst], eax ; size_t
		call	sub_404CAE
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_410D51
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_4]
		mov	[eax+4], edx
		mov	ecx, [ebp+var_28]
		mov	edx, [ebp+var_20]
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[esp+38h+Size],	ecx ; Size
		mov	[esp+38h+Src], edx ; Src
		mov	[esp+38h+Dst], eax ; Dst
		call	memcpy
		mov	edx, [ebp+var_28]
		mov	eax, [ebp+var_C]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+14h]
		mov	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	dword ptr [eax], 1
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		jmp	short loc_410D5F
; ---------------------------------------------------------------------------

loc_410D51:				; CODE XREF: sub_410AEE+1F7j
		mov	[ebp+var_10], offset aErrorInGette_0 ; "ERROR in GETTEXT MALLOC"
		mov	[ebp+var_14], 0

loc_410D5F:				; CODE XREF: sub_410AEE+14Bj
					; sub_410AEE+1DDj ...
		mov	eax, [ebp+var_20]
		mov	[esp+38h+Dst], eax ; void *
		call	sub_404E31
		jmp	loc_410E29
; ---------------------------------------------------------------------------

loc_410D6F:				; CODE XREF: sub_410AEE+9Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		cmp	eax, 1
		jnz	short loc_410DD5
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		mov	[ebp+var_C], eax
		jmp	short loc_410DA2
; ---------------------------------------------------------------------------

loc_410D8F:				; CODE XREF: sub_410AEE+2B8j
		mov	eax, [ebp+var_C]
		mov	eax, [eax+4]
		cmp	eax, [ebp+arg_4]
		jz	short loc_410DAA
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_410DA2:				; CODE XREF: sub_410AEE+29Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_410D8F
		jmp	short loc_410DAB
; ---------------------------------------------------------------------------

loc_410DAA:				; CODE XREF: sub_410AEE+2AAj
		nop

loc_410DAB:				; CODE XREF: sub_410AEE+2BAj
		cmp	[ebp+var_C], 0
		jz	short loc_410DC5
		mov	eax, [ebp+var_C]
		add	eax, 0Ch
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	eax, [eax+8]
		mov	[ebp+var_14], eax
		jmp	short loc_410E29
; ---------------------------------------------------------------------------

loc_410DC5:				; CODE XREF: sub_410AEE+2C1j
		mov	[ebp+var_10], offset aErrorInGette_1 ; "ERROR in GETTEXT (overflow space)\n"
		mov	[ebp+var_14], 0
		jmp	short loc_410E29
; ---------------------------------------------------------------------------

loc_410DD5:				; CODE XREF: sub_410AEE+294j
		mov	eax, [ebp+arg_0]
		mov	ebx, [eax+4]
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_410E00
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+38h+Dst], eax
		call	sub_4101AB
		jmp	short loc_410E11
; ---------------------------------------------------------------------------

loc_410E00:				; CODE XREF: sub_410AEE+2F5j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	edx, [ebp+arg_4]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_410E11:				; CODE XREF: sub_410AEE+310j
		add	eax, ebx
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		mov	edx, [ebp+arg_4]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[ebp+var_14], eax

loc_410E29:				; CODE XREF: sub_410AEE+87j
					; sub_410AEE+27Cj ...
		cmp	[ebp+arg_8], 0
		jz	short loc_410E50
		cmp	[ebp+var_14], 0
		jz	short loc_410E50
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+Size],	eax ; int
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Src], eax ; int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Dst], eax ; char *
		call	sub_410A88
		jmp	short loc_410E53
; ---------------------------------------------------------------------------

loc_410E50:				; CODE XREF: sub_410AEE+33Fj
					; sub_410AEE+345j
		mov	eax, [ebp+var_10]

loc_410E53:				; CODE XREF: sub_410AEE+360j
		add	esp, 34h
		pop	ebx
		pop	ebp
		retn
sub_410AEE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_410E59(char *, int, int)
sub_410E59	proc near		; CODE XREF: sub_411114+1Cp
					; .text:00411153p ...

Str1		= dword	ptr -58h
Str2		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_3C		= dword	ptr -3Ch
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 50h
		mov	eax, ds:dword_41D300
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	loc_4110EB
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		cmp	eax, 2
		jbe	loc_411024
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	loc_411024
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_3C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_3C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax
		call	sub_4101DA
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_18]
		mov	ecx, [eax+20h]
		mov	eax, [ebp+var_20]
		mov	edx, 0
		div	ecx
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		lea	ecx, [eax-2]
		mov	eax, [ebp+var_20]
		mov	edx, 0
		div	ecx
		mov	eax, edx
		add	eax, 1
		mov	[ebp+var_24], eax
		jmp	loc_410FE3
; ---------------------------------------------------------------------------

loc_410EF3:				; CODE XREF: sub_410E59+1C5j
		sub	[ebp+var_28], 1
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		cmp	eax, [ebp+var_28]
		jbe	loc_410FBB
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_410F2A
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	sub_4101AB
		jmp	short loc_410F3A
; ---------------------------------------------------------------------------

loc_410F2A:				; CODE XREF: sub_410E59+B5j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax]

loc_410F3A:				; CODE XREF: sub_410E59+CFj
		cmp	eax, [ebp+var_1C]
		jb	short loc_410FBB
		mov	eax, [ebp+var_18]
		mov	ebx, [eax]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_410F69
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+58h+Str1],	eax
		call	sub_4101AB
		jmp	short loc_410F7A
; ---------------------------------------------------------------------------

loc_410F69:				; CODE XREF: sub_410E59+F3j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_410F7A:				; CODE XREF: sub_410E59+10Ej
		add	eax, ebx
		mov	[esp+58h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_410FBB
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	eax, al
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str1],	eax
		call	sub_410AEE
		jmp	loc_411105
; ---------------------------------------------------------------------------

loc_410FBB:				; CODE XREF: sub_410E59+A7j
					; sub_410E59+E4j ...
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		sub	eax, [ebp+var_24]
		cmp	eax, [ebp+var_14]
		ja	short loc_410FDD
		mov	eax, [ebp+var_18]
		mov	eax, [eax+20h]
		mov	edx, [ebp+var_24]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	[ebp+var_14], eax
		jmp	short loc_410FE3
; ---------------------------------------------------------------------------

loc_410FDD:				; CODE XREF: sub_410E59+16Ej
		mov	eax, [ebp+var_24]
		add	[ebp+var_14], eax

loc_410FE3:				; CODE XREF: sub_410E59+95j
					; sub_410E59+182j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_411007
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]
		mov	[esp+58h+Str1],	eax
		call	sub_4101AB
		jmp	short loc_411017
; ---------------------------------------------------------------------------

loc_411007:				; CODE XREF: sub_410E59+192j
		mov	eax, [ebp+var_18]
		mov	eax, [eax+24h]
		mov	edx, [ebp+var_14]
		shl	edx, 2
		add	eax, edx
		mov	eax, [eax]

loc_411017:				; CODE XREF: sub_410E59+1ACj
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jnz	loc_410EF3

loc_411024:				; CODE XREF: sub_410E59+23j
					; sub_410E59+31j
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_18]
		mov	eax, [eax+0Ch]
		mov	[ebp+var_C], eax
		jmp	loc_4110DD
; ---------------------------------------------------------------------------

loc_411039:				; CODE XREF: sub_410E59+28Aj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		shr	eax, 1
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_18]
		mov	ebx, [eax]
		mov	eax, [ebp+var_18]
		mov	eax, [eax+8]
		test	eax, eax
		jz	short loc_411070
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]
		mov	[esp+58h+Str1],	eax
		call	sub_4101AB
		jmp	short loc_411081
; ---------------------------------------------------------------------------

loc_411070:				; CODE XREF: sub_410E59+1FAj
		mov	eax, [ebp+var_18]
		mov	eax, [eax+18h]
		mov	edx, [ebp+var_28]
		shl	edx, 3
		add	eax, edx
		mov	eax, [eax+4]

loc_411081:				; CODE XREF: sub_410E59+215j
		add	eax, ebx
		mov	[esp+58h+Str2],	eax ; Str2
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+Str1],	eax ; Str1
		call	strcmp
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_2C], 0
		jns	short loc_4110A3
		mov	eax, [ebp+var_28]
		mov	[ebp+var_C], eax
		jmp	short loc_4110DD
; ---------------------------------------------------------------------------

loc_4110A3:				; CODE XREF: sub_410E59+240j
		cmp	[ebp+var_2C], 0
		jle	short loc_4110B4
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_4110DD
; ---------------------------------------------------------------------------

loc_4110B4:				; CODE XREF: sub_410E59+24Ej
		cmp	[ebp+arg_4], 0
		setnz	al
		movzx	eax, al
		mov	edx, [ebp+arg_8]
		mov	[esp+58h+var_4C], edx
		mov	[esp+58h+var_50], eax
		mov	eax, [ebp+var_28]
		mov	[esp+58h+Str2],	eax
		mov	eax, [ebp+var_18]
		mov	[esp+58h+Str1],	eax
		call	sub_410AEE
		jmp	short loc_411105
; ---------------------------------------------------------------------------

loc_4110DD:				; CODE XREF: sub_410E59+1DBj
					; sub_410E59+248j ...
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_C]
		jb	loc_411039
		jmp	short loc_4110EC
; ---------------------------------------------------------------------------

loc_4110EB:				; CODE XREF: sub_410E59+14j
		nop

loc_4110EC:				; CODE XREF: sub_410E59+290j
		cmp	[ebp+arg_4], 0
		jz	short loc_411102
		cmp	[ebp+arg_8], 1
		jnz	short loc_4110FD
		mov	eax, [ebp+arg_0]
		jmp	short loc_411100
; ---------------------------------------------------------------------------

loc_4110FD:				; CODE XREF: sub_410E59+29Dj
		mov	eax, [ebp+arg_4]

loc_411100:				; CODE XREF: sub_410E59+2A2j
		jmp	short loc_411105
; ---------------------------------------------------------------------------

loc_411102:				; CODE XREF: sub_410E59+297j
		mov	eax, [ebp+arg_0]

loc_411105:				; CODE XREF: sub_410E59+15Dj
					; sub_410E59+282j ...
		add	esp, 50h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_410E59	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_411114(char *)
sub_411114	proc near		; CODE XREF: sub_4015A7+3Dp
					; sub_4015A7+4Ep ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_10], 0 ; int
		mov	[esp+18h+var_14], 0 ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax ;	char *
		call	sub_410E59
		leave
		retn
sub_411114	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		call	sub_410E59
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_410E59
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp], offset	aLc_messages ; "LC_MESSAGES"
		call	sub_40F664
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_41119B
		mov	eax, [ebp-0Ch]
		jmp	short locret_4111A0
; ---------------------------------------------------------------------------

loc_41119B:				; CODE XREF: .text:00411194j
		mov	eax, offset byte_41BFDB

locret_4111A0:				; CODE XREF: .text:00411199j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4111A2	proc near		; CODE XREF: sub_405491+Dp
					; sub_4054AA+Dp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ds:dword_41D304, eax
		pop	ebp
		retn
sub_4111A2	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4111B0	proc near		; CODE XREF: sub_401695+266p
					; sub_401695+429p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, ds:dword_41D3AC
		mov	[ebp+var_4], eax
		cmp	[ebp+arg_0], 0
		jz	short loc_4111CE
		mov	ds:dword_41D3AC, 0

loc_4111CE:				; CODE XREF: sub_4111B0+12j
		mov	eax, [ebp+var_4]
		leave
		retn
sub_4111B0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_41D3AC
		add	eax, 1
		mov	ds:dword_41D3AC, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4111E5(char *Filename, int FileHandle)
sub_4111E5	proc near		; CODE XREF: sub_411444+21p
					; .text:00411480p

File		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Filename	= dword	ptr  8
FileHandle	= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 20h
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_41122F
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_411225
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, ds:File
		cmp	edx, eax
		jz	short loc_411225
		mov	eax, ds:File
		mov	[esp+28h+File],	eax ; File
		call	fclose

loc_411225:				; CODE XREF: sub_4111E5+20j
					; sub_4111E5+31j
		mov	ds:File, 0

loc_41122F:				; CODE XREF: sub_4111E5+Fj
		cmp	[ebp+Filename],	0
		jz	short loc_411277
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset asc_41BFDC ; "-"
		mov	ecx, 2
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_411277
		mov	[ebp+Filename],	0
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+28h+File],	eax ; File
		call	_fileno
		mov	[ebp+FileHandle], eax

loc_411277:				; CODE XREF: sub_4111E5+4Ej
					; sub_4111E5+76j
		cmp	[ebp+Filename],	0
		jz	short loc_4112CD
		mov	eax, [ebp+Filename]
		mov	edx, eax
		mov	eax, offset aSocket ; "socket://"
		mov	ecx, 9
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4112B9
		mov	eax, [ebp+Filename]
		add	eax, 9
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4112B9
		mov	eax, 1
		jmp	short loc_4112BE
; ---------------------------------------------------------------------------

loc_4112B9:				; CODE XREF: sub_4111E5+BEj
					; sub_4111E5+CBj
		mov	eax, 0

loc_4112BE:				; CODE XREF: sub_4111E5+D2j
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_4112D4
		add	[ebp+Filename],	9
		jmp	short loc_4112D4
; ---------------------------------------------------------------------------

loc_4112CD:				; CODE XREF: sub_4111E5+96j
		mov	[ebp+var_10], 0

loc_4112D4:				; CODE XREF: sub_4111E5+E0j
					; sub_4111E5+E6j
		cmp	[ebp+var_10], 0
		jz	short loc_411310
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aSystemDoesNotS ; "system does not support logging to a so"...
		mov	[esp+28h+var_1C], edx ;	File
		mov	[esp+28h+Count], 3Bh ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+File],	eax ; Str
		call	fwrite
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_41136B
; ---------------------------------------------------------------------------

loc_411310:				; CODE XREF: sub_4111E5+F3j
		cmp	[ebp+Filename],	0
		jz	short loc_41132F
		mov	eax, offset aA_0 ; "a"
		mov	[esp+28h+Size],	eax ; Mode
		mov	eax, [ebp+Filename]
		mov	[esp+28h+File],	eax ; Filename
		call	fopen
		mov	[ebp+var_C], eax
		jmp	short loc_41136B
; ---------------------------------------------------------------------------

loc_41132F:				; CODE XREF: sub_4111E5+12Fj
		cmp	[ebp+FileHandle], 1
		jnz	short loc_411342
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[ebp+var_C], eax
		jmp	short loc_41136B
; ---------------------------------------------------------------------------

loc_411342:				; CODE XREF: sub_4111E5+14Ej
		cmp	[ebp+FileHandle], 2
		jnz	short loc_411355
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_41136B
; ---------------------------------------------------------------------------

loc_411355:				; CODE XREF: sub_4111E5+161j
		mov	[esp+28h+Size],	offset aA_0 ; "a"
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+File],	eax ; FileHandle
		call	_fdopen
		mov	[ebp+var_C], eax

loc_41136B:				; CODE XREF: sub_4111E5+129j
					; sub_4111E5+148j ...
		mov	dword_41917C, 0FFFFFFFFh
		cmp	[ebp+var_C], 0
		jnz	loc_411400
		cmp	[ebp+Filename],	0
		jz	short loc_4113BD
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToOpenLo ; "failed to open log file `%s': %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+Filename]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf
		jmp	short loc_4113F3
; ---------------------------------------------------------------------------

loc_4113BD:				; CODE XREF: sub_4111E5+19Ej
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+28h+File],	eax ; int
		call	strerror
		mov	edx, offset aFailedToFdopen ; "failed to fdopen	file descriptor	%d: %s"...
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+28h+var_1C], eax
		mov	eax, [ebp+FileHandle]
		mov	[esp+28h+Count], eax
		mov	[esp+28h+Size],	edx ; Format
		mov	[esp+28h+File],	ecx ; File
		call	fprintf

loc_4113F3:				; CODE XREF: sub_4111E5+1D6j
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[ebp+var_C], eax
		jmp	short loc_411423
; ---------------------------------------------------------------------------

loc_411400:				; CODE XREF: sub_4111E5+194j
		mov	[esp+28h+var_1C], 0 ; Size
		mov	[esp+28h+Count], 40h ; Mode
		mov	[esp+28h+Size],	0 ; Buf
		mov	eax, [ebp+var_C]
		mov	[esp+28h+File],	eax ; File
		call	setvbuf

loc_411423:				; CODE XREF: sub_4111E5+219j
		mov	eax, [ebp+var_C]
		mov	ds:File, eax
		mov	eax, [ebp+var_10]
		mov	ds:dword_41D3A4, eax
		mov	ds:dword_41D3A8, 0
		add	esp, 20h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_4111E5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_411444(char *)
sub_411444	proc near		; CODE XREF: sub_411606+19p

Filename	= dword	ptr -18h
FileHandle	= dword	ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_411455
		mov	eax, [ebp+arg_0]
		jmp	short loc_41145A
; ---------------------------------------------------------------------------

loc_411455:				; CODE XREF: sub_411444+Aj
		mov	eax, offset asc_41BFDC ; "-"

loc_41145A:				; CODE XREF: sub_411444+Fj
		mov	[esp+18h+FileHandle], 0FFFFFFFFh ; FileHandle
		mov	[esp+18h+Filename], eax	; Filename
		call	sub_4111E5
		leave
		retn
sub_411444	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_4111E5
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		mov	ds:dword_41D39C, eax
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_411494(char *, int)
sub_411494	proc near		; CODE XREF: sub_401695+5Fp

Dest		= dword	ptr -18h
Source		= dword	ptr -14h
Count		= dword	ptr -10h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		cmp	[ebp+arg_0], 0
		jz	short loc_4114C2
		mov	[esp+18h+Count], 4Fh ; Count
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+Source], eax ;	Source
		mov	[esp+18h+Dest],	offset byte_41D340 ; Dest
		call	strncpy
		mov	ds:byte_41D38F,	0

loc_4114C2:				; CODE XREF: sub_411494+Aj
		mov	eax, [ebp+arg_4]
		and	eax, 1
		mov	ds:dword_41D394, eax
		mov	eax, [ebp+arg_4]
		and	eax, 2
		mov	ds:dword_41D390, eax
		mov	eax, [ebp+arg_4]
		and	eax, 4
		mov	ds:dword_41D398, eax
		mov	eax, [ebp+arg_4]
		and	eax, 100h
		mov	ds:dword_41D3A0, eax
		leave
		retn
sub_411494	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 0
		jz	short loc_411564
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0
		mov	eax, ds:dword_41D394
		test	eax, eax
		jz	short loc_41151C
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 1
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_41151C:				; CODE XREF: .text:0041150Bj
		mov	eax, ds:dword_41D390
		test	eax, eax
		jz	short loc_411534
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 2
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_411534:				; CODE XREF: .text:00411523j
		mov	eax, ds:dword_41D398
		test	eax, eax
		jz	short loc_41154C
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	edx, 4
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_41154C:				; CODE XREF: .text:0041153Bj
		mov	eax, ds:dword_41D3A0
		test	eax, eax
		jz	short loc_411564
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	edx, eax
		or	dh, 1
		mov	eax, [ebp+8]
		mov	[eax], edx

loc_411564:				; CODE XREF: .text:004114F9j
					; .text:00411553j
		mov	eax, offset byte_41D340
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:File
		test	eax, eax
		jz	short loc_41159F
		mov	eax, ds:File
		mov	[esp], eax
		call	_fileno
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0FFFFFFFFh
		jz	short loc_41159F
		mov	eax, [ebp-0Ch]
		cmp	eax, [ebp+8]
		jnz	short loc_41159F
		mov	eax, 1
		jmp	short locret_4115BF
; ---------------------------------------------------------------------------

loc_41159F:				; CODE XREF: .text:00411578j
					; .text:0041158Ej ...
		mov	eax, dword_41917C
		cmp	eax, 0FFFFFFFFh
		jz	short loc_4115BA
		mov	eax, dword_41917C
		cmp	eax, [ebp+8]
		jnz	short loc_4115BA
		mov	eax, 1
		jmp	short locret_4115BF
; ---------------------------------------------------------------------------

loc_4115BA:				; CODE XREF: .text:004115A7j
					; .text:004115B1j
		mov	eax, 0

locret_4115BF:				; CODE XREF: .text:0041159Dj
					; .text:004115B8j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_4115DA
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_4115DF
; ---------------------------------------------------------------------------

loc_4115DA:				; CODE XREF: .text:004115CEj
		mov	eax, ds:File

loc_4115DF:				; CODE XREF: .text:004115D8j
		mov	[esp], eax
		call	_fileno
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_4115FF
		mov	eax, ds:_iob
		add	eax, 40h
		jmp	short loc_411604
; ---------------------------------------------------------------------------

loc_4115FF:				; CODE XREF: .text:004115F3j
		mov	eax, ds:File

loc_411604:				; CODE XREF: .text:004115FDj
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_411606(int, char *Format, va_list ArgList)
sub_411606	proc near		; CODE XREF: sub_411989+22p
					; .text:004119CCp ...

var_58		= dword	ptr -58h
File		= dword	ptr -54h
Count		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
Format		= dword	ptr  0Ch
ArgList		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_411649
		mov	[esp+58h+var_58], 0 ; char *
		call	sub_411444
		mov	eax, ds:File
		test	eax, eax
		jnz	short loc_411649
		mov	[esp+58h+Count], 1C3h ;	int
		mov	[esp+58h+File],	offset a____Gnupg22__4 ; "../../gnupg2-2.0.30/jnlib/logging.c"
		mov	[esp+58h+var_58], offset aLogstream ; "logstream"
		call	sub_4185A0

loc_411649:				; CODE XREF: sub_411606+10j
					; sub_411606+25j
		mov	eax, ds:dword_41D3A8
		test	eax, eax
		jz	short loc_41166D
		cmp	[ebp+arg_0], 1
		jz	short loc_41166D
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_41166D:				; CODE XREF: sub_411606+4Aj
					; sub_411606+50j
		mov	ds:dword_41D3A8, 0
		cmp	[ebp+arg_0], 1
		jz	loc_411804
		mov	eax, ds:dword_41D390
		test	eax, eax
		jz	loc_41171D
		mov	eax, ds:dword_41D3A4
		test	eax, eax
		jnz	loc_41171D
		mov	[esp+58h+var_58], 0
		call	sub_418670
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_20]
		mov	[esp+58h+var_58], eax
		call	sub_4186B0
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		mov	edx, [eax]
		mov	eax, [ebp+var_1C]
		mov	edi, [eax+4]
		mov	eax, [ebp+var_1C]
		mov	esi, [eax+8]
		mov	eax, [ebp+var_1C]
		mov	ebx, [eax+0Ch]
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+10h]
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_1C]
		mov	eax, [eax+14h]
		add	eax, 76Ch
		mov	[ebp+var_30], eax
		mov	ecx, offset a04d02d02d02d_0 ; "%04d-%02d-%02d %02d:%02d:%02d "
		mov	eax, ds:File
		mov	[esp+58h+var_3C], edx
		mov	[esp+58h+var_40], edi
		mov	[esp+58h+var_44], esi
		mov	[esp+58h+var_48], ebx
		mov	edx, [ebp+var_2C]
		mov	[esp+58h+var_4C], edx
		mov	edi, [ebp+var_30]
		mov	[esp+58h+Count], edi
		mov	[esp+58h+File],	ecx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_41171D:				; CODE XREF: sub_411606+82j
					; sub_411606+8Fj
		mov	eax, ds:dword_41D394
		test	eax, eax
		jnz	short loc_41172F
		mov	eax, ds:dword_41D3A4
		test	eax, eax
		jz	short loc_411746

loc_41172F:				; CODE XREF: sub_411606+11Ej
		mov	edx, ds:File
		mov	eax, offset byte_41D340
		mov	[esp+58h+File],	edx ; File
		mov	[esp+58h+var_58], eax ;	Str
		call	fputs

loc_411746:				; CODE XREF: sub_411606+127j
		mov	eax, ds:dword_41D398
		test	eax, eax
		jnz	short loc_411758
		mov	eax, ds:dword_41D3A4
		test	eax, eax
		jz	short loc_4117B2

loc_411758:				; CODE XREF: sub_411606+147j
		mov	eax, ds:dword_41D39C
		test	eax, eax
		jz	short loc_411791
		mov	eax, ds:dword_41D39C
		call	eax ; dword_41D39C
		mov	ebx, eax
		call	_getpid
		mov	ecx, eax
		mov	edx, offset aU_Lx ; "[%u.%lx]"
		mov	eax, ds:File
		mov	[esp+58h+var_4C], ebx
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_4117B2
; ---------------------------------------------------------------------------

loc_411791:				; CODE XREF: sub_411606+159j
		call	_getpid
		mov	ecx, eax
		mov	edx, offset aU	; "[%u]"
		mov	eax, ds:File
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf

loc_4117B2:				; CODE XREF: sub_411606+150j
					; sub_411606+189j
		mov	eax, ds:dword_41D390
		test	eax, eax
		jz	short loc_4117C4
		mov	eax, ds:dword_41D3A4
		test	eax, eax
		jz	short loc_4117D9

loc_4117C4:				; CODE XREF: sub_411606+1B3j
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 3Ah ;	Ch
		call	putc

loc_4117D9:				; CODE XREF: sub_411606+1BCj
		cmp	[ebp+Format], 0
		jz	short loc_4117EF
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_4117EF
		add	[ebp+Format], 1
		jmp	short loc_411804
; ---------------------------------------------------------------------------

loc_4117EF:				; CODE XREF: sub_411606+1D7j
					; sub_411606+1E1j
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 20h ;	Ch
		call	putc

loc_411804:				; CODE XREF: sub_411606+75j
					; sub_411606+1E7j
		cmp	[ebp+arg_0], 7	; switch 8 cases
		ja	loc_411898	; jumptable 0041181B default case
		mov	eax, [ebp+arg_0]
		shl	eax, 2
		add	eax, offset off_41C10C
		mov	eax, [eax]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_41181D:				; CODE XREF: sub_411606+215j
					; DATA XREF: .rdata:off_41C10Co
		mov	edx, ds:File	; jumptable 0041181B case 5
		mov	eax, offset aFatal ; "Fatal: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 7 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_4118B8
; ---------------------------------------------------------------------------

loc_411846:				; CODE XREF: sub_411606+215j
					; DATA XREF: .rdata:off_41C10Co
		mov	edx, ds:File	; jumptable 0041181B case 6
		mov	eax, offset aOhhhhJeeee	; "Ohhhh jeeee:	"
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 0Dh ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_4118B8
; ---------------------------------------------------------------------------

loc_41186F:				; CODE XREF: sub_411606+215j
					; DATA XREF: .rdata:off_41C10Co
		mov	edx, ds:File	; jumptable 0041181B case 7
		mov	eax, offset aDbg ; "DBG: "
		mov	[esp+58h+var_4C], edx ;	File
		mov	[esp+58h+Count], 5 ; Count
		mov	[esp+58h+File],	1 ; Size
		mov	[esp+58h+var_58], eax ;	Str
		call	fwrite
		jmp	short loc_4118B8
; ---------------------------------------------------------------------------

loc_411898:				; CODE XREF: sub_411606+202j
		mov	edx, offset aUnknownLogLeve ; jumptable	0041181B default case
		mov	eax, ds:File
		mov	ecx, [ebp+arg_0]
		mov	[esp+58h+Count], ecx
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	fprintf
		jmp	short loc_4118B8
; ---------------------------------------------------------------------------

loc_4118B7:				; CODE XREF: sub_411606+215j
					; DATA XREF: .rdata:off_41C10Co
		nop			; jumptable 0041181B cases 0-4

loc_4118B8:				; CODE XREF: sub_411606+23Ej
					; sub_411606+267j ...
		cmp	[ebp+Format], 0
		jz	short loc_411928
		mov	eax, ds:File
		mov	edx, [ebp+ArgList]
		mov	[esp+58h+Count], edx ; ArgList
		mov	edx, [ebp+Format]
		mov	[esp+58h+File],	edx ; Format
		mov	[esp+58h+var_58], eax ;	File
		call	vfprintf
		mov	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41191B
		mov	eax, [ebp+Format]
		mov	[ebp+var_34], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_34]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+Format]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_41191B
		mov	ds:dword_41D3A8, 1
		jmp	short loc_411928
; ---------------------------------------------------------------------------

loc_41191B:				; CODE XREF: sub_411606+2DBj
					; sub_411606+307j
		mov	eax, ds:File
		mov	[esp+58h+var_58], eax ;	File
		call	fflush

loc_411928:				; CODE XREF: sub_411606+2B6j
					; sub_411606+313j
		cmp	[ebp+arg_0], 5
		jnz	short loc_411958
		mov	eax, ds:dword_41D3A8
		test	eax, eax
		jz	short loc_41194C
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_41194C:				; CODE XREF: sub_411606+32Fj
		mov	[esp+58h+var_58], 2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_411958:				; CODE XREF: sub_411606+326j
		cmp	[ebp+arg_0], 6
		jnz	short loc_411981
		mov	eax, ds:dword_41D3A8
		test	eax, eax
		jz	short loc_41197C
		mov	eax, ds:File
		mov	[esp+58h+File],	eax ; File
		mov	[esp+58h+var_58], 0Ah ;	Ch
		call	putc

loc_41197C:				; CODE XREF: sub_411606+35Fj
		call	abort
; ---------------------------------------------------------------------------

loc_411981:				; CODE XREF: sub_411606+356j
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_411606	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_411989(int, char *, char)
sub_411989	proc near		; CODE XREF: sub_411B8C+2Ap

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_8]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Format], eax ;	Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	int
		call	sub_411606
		leave
		retn
sub_411989	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_411606
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4119D3(char *, char)
sub_4119D3	proc near		; CODE XREF: sub_401695+2D6p
					; sub_401695+2E9p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 2 ; int
		call	sub_411606
		leave
		retn
sub_4119D3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4119FD(char *, char)
sub_4119FD	proc near		; CODE XREF: sub_40161D+5Dp
					; sub_401695+21Ep ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 4 ; int
		call	sub_411606
		mov	eax, ds:dword_41D3AC
		cmp	eax, 752Fh
		jg	short locret_411A3E
		mov	eax, ds:dword_41D3AC
		add	eax, 1
		mov	ds:dword_41D3AC, eax

locret_411A3E:				; CODE XREF: sub_4119FD+32j
		leave
		retn
sub_4119FD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl sub_411A40(char *, char)
sub_411A40	proc near		; CODE XREF: sub_404C7C+2Dp
					; .text:0040A5A7p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 5 ; int
		call	sub_411606
		call	abort
sub_411A40	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

; int __cdecl sub_411A6D(char *, char)
sub_411A6D	proc near		; CODE XREF: sub_411BC0+88p

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 6 ; int
		call	sub_411606
		call	abort
sub_411A6D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_411A9A(char *, char)
sub_411A9A	proc near		; CODE XREF: sub_40BF40+51p
					; sub_40BF40+103p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	eax, [ebp+var_C]
		mov	[esp+28h+ArgList], eax ; ArgList
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Format], eax ;	Format
		mov	[esp+28h+var_28], 7 ; int
		call	sub_411606
		leave
		retn
sub_411A9A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_411AC4(char *, char)
sub_411AC4	proc near		; CODE XREF: .text:0040B4E0p
					; .text:0040B527p ...

var_28		= dword	ptr -28h
Format		= dword	ptr -24h
ArgList		= dword	ptr -20h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_C]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		cmp	[ebp+arg_0], 0
		setnz	al
		movzx	eax, al
		mov	[esp+28h+ArgList], edx ; ArgList
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+Format], edx ;	Format
		mov	[esp+28h+var_28], eax ;	int
		call	sub_411606
		leave
		retn
sub_411AC4	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	dword ptr [ebp+8], 0
		jz	short loc_411B1D
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_411B1D
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	dword_41C12C
		call	sub_411A9A

loc_411B1D:				; CODE XREF: .text:00411AFEj
					; .text:00411B08j
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_411B78
		mov	eax, [ebp+0Ch]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a02x ; "%02X"
		call	sub_411AC4
		sub	dword ptr [ebp+10h], 1
		add	dword ptr [ebp-0Ch], 1
		jmp	short loc_411B69
; ---------------------------------------------------------------------------

loc_411B4C:				; CODE XREF: .text:00411B76j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+4], eax
		mov	dword ptr [esp], offset	a02x_0 ; " %02X"
		call	sub_411AC4
		add	dword ptr [ebp-0Ch], 1

loc_411B69:				; CODE XREF: .text:00411B4Aj
		cmp	dword ptr [ebp+10h], 0
		setnz	al
		sub	dword ptr [ebp+10h], 1
		test	al, al
		jnz	short loc_411B4C

loc_411B78:				; CODE XREF: .text:00411B21j
		cmp	dword ptr [ebp+8], 0
		jz	short locret_411B8A
		mov	dword ptr [esp], offset	asc_41C13B ; "\n"
		call	sub_411AC4

locret_411B8A:				; CODE XREF: .text:00411B7Cj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_411B8C	proc near		; CODE XREF: sub_402921+166p
					; sub_402921+194p ...

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_18], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_1C], eax
		mov	eax, dword ptr [ebp+arg_0]
		mov	dword ptr [esp+28h+var_20], eax	; char
		mov	[esp+28h+var_24], offset a___ThisIsABugS ; "...	this is	a bug (%s:%d:%s)\n"
		mov	[esp+28h+var_28], 6 ; int
		call	sub_411989
		call	abort
sub_411B8C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411BC0	proc near		; CODE XREF: sub_41212A+57p
					; sub_412B0D+1Cp

Code		= dword	ptr -28h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_C		= byte ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 8000h
		test	eax, eax
		jnz	short loc_411C4D
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+1Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+28h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+30h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+34h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	edx, eax
		or	dh, 80h
		mov	eax, [ebp+arg_0]
		mov	[eax+8], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		test	eax, eax
		jns	short loc_411C4D
		mov	[esp+28h+Code],	offset aInvalidArgumen ; "invalid argument for arg_parsee\n"
		call	sub_411A6D
; ---------------------------------------------------------------------------

loc_411C4D:				; CODE XREF: sub_411BC0+13j
					; sub_411BC0+7Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_411F00
		cmp	dword ptr [ebp+arg_4], 0
		jz	loc_411D85
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFAh
		jnz	short loc_411C84
		mov	[esp+28h+Code],	offset aArgumentNotExp ; "argument not expected"
		call	sub_411114
		mov	dword ptr [ebp+var_C], eax
		jmp	loc_411D5D
; ---------------------------------------------------------------------------

loc_411C84:				; CODE XREF: sub_411BC0+AEj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFBh
		jnz	short loc_411CA3
		mov	[esp+28h+Code],	offset aReadError ; "read error"
		call	sub_411114
		mov	dword ptr [ebp+var_C], eax
		jmp	loc_411D5D
; ---------------------------------------------------------------------------

loc_411CA3:				; CODE XREF: sub_411BC0+CDj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFCh
		jnz	short loc_411CC2
		mov	[esp+28h+Code],	offset aKeywordTooLong ; "keyword too long"
		call	sub_411114
		mov	dword ptr [ebp+var_C], eax
		jmp	loc_411D5D
; ---------------------------------------------------------------------------

loc_411CC2:				; CODE XREF: sub_411BC0+ECj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_411CDE
		mov	[esp+28h+Code],	offset aMissingArgumen ; "missing argument"
		call	sub_411114
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_411D5D
; ---------------------------------------------------------------------------

loc_411CDE:				; CODE XREF: sub_411BC0+10Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF4h
		jnz	short loc_411CFA
		mov	[esp+28h+Code],	offset aInvalidArgum_0 ; "invalid argument"
		call	sub_411114
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_411D5D
; ---------------------------------------------------------------------------

loc_411CFA:				; CODE XREF: sub_411BC0+127j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF9h
		jnz	short loc_411D16
		mov	[esp+28h+Code],	offset aInvalidComma_0 ; "invalid command"
		call	sub_411114
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_411D5D
; ---------------------------------------------------------------------------

loc_411D16:				; CODE XREF: sub_411BC0+143j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF6h
		jnz	short loc_411D32
		mov	[esp+28h+Code],	offset aInvalidAliasDe ; "invalid alias	definition"
		call	sub_411114
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_411D5D
; ---------------------------------------------------------------------------

loc_411D32:				; CODE XREF: sub_411BC0+15Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF5h
		jnz	short loc_411D4E
		mov	[esp+28h+Code],	offset aOutOfCore ; "out of core"
		call	sub_411114
		mov	dword ptr [ebp+var_C], eax
		jmp	short loc_411D5D
; ---------------------------------------------------------------------------

loc_411D4E:				; CODE XREF: sub_411BC0+17Bj
		mov	[esp+28h+Code],	offset aInvalidOption ;	"invalid option"
		call	sub_411114
		mov	dword ptr [ebp+var_C], eax

loc_411D5D:				; CODE XREF: sub_411BC0+BFj
					; sub_411BC0+DEj ...
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		mov	edx, dword ptr [ebp+var_C]
		mov	[esp+28h+var_1C], edx
		mov	[esp+28h+var_20], eax
		mov	eax, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aSUS ; "%s:%u: %s\n"
		call	sub_4119FD
		jmp	loc_411EDF
; ---------------------------------------------------------------------------

loc_411D85:				; CODE XREF: sub_411BC0+9Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		test	eax, eax
		jz	short loc_411D97
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+28h]
		jmp	short loc_411D9C
; ---------------------------------------------------------------------------

loc_411D97:				; CODE XREF: sub_411BC0+1CDj
		mov	eax, offset a??	; "[??]"

loc_411D9C:				; CODE XREF: sub_411BC0+1D5j
		mov	dword ptr [ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_411DCA
		mov	[esp+28h+Code],	offset aMissingArgum_0 ; "missing argument for option \"%.50s\"\n"
		call	sub_411114
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_4119FD
		jmp	loc_411EDF
; ---------------------------------------------------------------------------

loc_411DCA:				; CODE XREF: sub_411BC0+1E8j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF4h
		jnz	short loc_411DF5
		mov	[esp+28h+Code],	offset aInvalidArgum_1 ; "invalid argument for option \"%.50s\"\n"
		call	sub_411114
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_4119FD
		jmp	loc_411EDF
; ---------------------------------------------------------------------------

loc_411DF5:				; CODE XREF: sub_411BC0+213j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFFAh
		jnz	short loc_411E20
		mov	[esp+28h+Code],	offset aOption_50sDoes ; "option \"%.50s\" does	not expect an arg"...
		call	sub_411114
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_4119FD
		jmp	loc_411EDF
; ---------------------------------------------------------------------------

loc_411E20:				; CODE XREF: sub_411BC0+23Ej
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF9h
		jnz	short loc_411E4B
		mov	[esp+28h+Code],	offset aInvalidComma_1 ; "invalid command \"%.50s\"\n"
		call	sub_411114
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_4119FD
		jmp	loc_411EDF
; ---------------------------------------------------------------------------

loc_411E4B:				; CODE XREF: sub_411BC0+269j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF8h
		jnz	short loc_411E73
		mov	[esp+28h+Code],	offset aOption_50sIsAm ; "option \"%.50s\" is ambiguous\n"
		call	sub_411114
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_4119FD
		jmp	short loc_411EDF
; ---------------------------------------------------------------------------

loc_411E73:				; CODE XREF: sub_411BC0+294j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF8h
		jnz	short loc_411E9B
		mov	[esp+28h+Code],	offset aCommand_50sIsA ; "command \"%.50s\" is ambiguous\n"
		call	sub_411114
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_4119FD
		jmp	short loc_411EDF
; ---------------------------------------------------------------------------

loc_411E9B:				; CODE XREF: sub_411BC0+2BCj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		cmp	eax, 0FFFFFFF5h
		jnz	short loc_411EC4
		mov	[esp+28h+Code],	offset aOutOfCore_0 ; "out of core\n"
		call	sub_411114
		mov	dword ptr [esp+28h+var_24], eax	; char
		mov	[esp+28h+Code],	offset aS ; "%s\n"
		call	sub_4119FD
		jmp	short loc_411EDF
; ---------------------------------------------------------------------------

loc_411EC4:				; CODE XREF: sub_411BC0+2E4j
		mov	[esp+28h+Code],	offset aInvalidOption_ ; "invalid option \"%.50s\"\n"
		call	sub_411114
		mov	edx, dword ptr [ebp+var_C]
		mov	dword ptr [esp+28h+var_24], edx	; char
		mov	[esp+28h+Code],	eax ; char *
		call	sub_4119FD

loc_411EDF:				; CODE XREF: sub_411BC0+1C0j
					; sub_411BC0+205j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		cmp	eax, 1
		jz	short loc_411EF6
		mov	[esp+28h+Code],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_411EF6:				; CODE XREF: sub_411BC0+328j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0Ch], 0

loc_411F00:				; CODE XREF: sub_411BC0+95j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		leave
		retn
sub_411BC0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_411F16	proc near		; CODE XREF: sub_41212A+342p
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_411F16	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_411F1B(int, char *)
sub_411F1B	proc near		; CODE XREF: sub_411F61+11Cp
					; sub_41212A+199p ...

Str1		= dword	ptr -28h
Str2		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[ebp+var_C], eax
		jmp	short loc_411F54
; ---------------------------------------------------------------------------

loc_411F2C:				; CODE XREF: sub_411F1B+3Dj
		mov	eax, [ebp+var_C]
		lea	edx, [eax+4]
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str2],	eax ; Str2
		mov	[esp+28h+Str1],	edx ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_411F4C
		mov	eax, 1
		jmp	short locret_411F5F
; ---------------------------------------------------------------------------

loc_411F4C:				; CODE XREF: sub_411F1B+28j
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_C], eax

loc_411F54:				; CODE XREF: sub_411F1B+Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_411F2C
		mov	eax, 0

locret_411F5F:				; CODE XREF: sub_411F1B+2Fj
		leave
		retn
sub_411F1B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_411F61(int, FILE *)
sub_411F61	proc near		; CODE XREF: sub_41212A+643p

File		= dword	ptr -98h
Source		= dword	ptr -94h
var_80		= byte ptr -80h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 98h
		mov	[ebp+var_10], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_18], 0
		jmp	loc_4120DD
; ---------------------------------------------------------------------------

loc_411F84:				; CODE XREF: sub_411F61+180j
		mov	eax, [ebp+arg_4]
		mov	[esp+98h+File],	eax ; File
		call	getc
		mov	[ebp+C], eax
		cmp	[ebp+C], 0Ah
		jnz	short loc_411FA1
		mov	[ebp+var_14], 1
		jmp	short loc_411FB5
; ---------------------------------------------------------------------------

loc_411FA1:				; CODE XREF: sub_411F61+35j
		cmp	[ebp+C], 0FFFFFFFFh
		jnz	short loc_411FB5
		mov	[ebp+C], 0Ah
		mov	[ebp+var_14], 1

loc_411FB5:				; CODE XREF: sub_411F61+3Ej
					; sub_411F61+44j ...
		mov	eax, [ebp+var_18]
		cmp	eax, 1
		jz	short loc_412002
		cmp	eax, 1
		jb	short loc_411FD5
		cmp	eax, 2
		jz	short loc_412046
		cmp	eax, 3
		jz	loc_412067
		jmp	loc_4120DD
; ---------------------------------------------------------------------------

loc_411FD5:				; CODE XREF: sub_411F61+5Fj
		mov	eax, [ebp+C]
		cmp	eax, 7Fh
		ja	short loc_411FF2
		mov	eax, [ebp+C]
		mov	[esp+98h+File],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_4120D9

loc_411FF2:				; CODE XREF: sub_411F61+7Aj
		mov	[ebp+var_10], 0
		mov	[ebp+var_18], 1
		jmp	short loc_411FB5
; ---------------------------------------------------------------------------

loc_412002:				; CODE XREF: sub_411F61+5Aj
		mov	eax, [ebp+C]
		mov	[esp+98h+File],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_41201C
		mov	[ebp+var_18], 3
		jmp	short loc_411FB5
; ---------------------------------------------------------------------------

loc_41201C:				; CODE XREF: sub_411F61+B0j
		mov	eax, [ebp+var_10]
		cmp	eax, 62h
		ja	short loc_41203A
		mov	eax, [ebp+C]
		mov	edx, eax
		lea	eax, [ebp+var_80]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_4120DD
; ---------------------------------------------------------------------------

loc_41203A:				; CODE XREF: sub_411F61+C1j
		mov	[ebp+var_18], 2
		jmp	loc_4120DD
; ---------------------------------------------------------------------------

loc_412046:				; CODE XREF: sub_411F61+64j
		mov	eax, [ebp+C]
		mov	[esp+98h+File],	eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	loc_4120DC
		mov	[ebp+var_18], 0
		jmp	loc_411FB5
; ---------------------------------------------------------------------------

loc_412067:				; CODE XREF: sub_411F61+69j
		lea	eax, [ebp+var_80]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		lea	eax, [ebp+var_80]
		mov	[esp+98h+Source], eax ;	char *
		mov	eax, [ebp+arg_0]
		mov	[esp+98h+File],	eax ; int
		call	sub_411F1B
		test	eax, eax
		jnz	short loc_4120CD
		mov	eax, [ebp+var_10]
		add	eax, 8
		mov	[esp+98h+File],	eax ; size_t
		call	sub_404CAE
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_4120A4
		mov	eax, 1
		jmp	short locret_4120EC
; ---------------------------------------------------------------------------

loc_4120A4:				; CODE XREF: sub_411F61+13Aj
		lea	eax, [ebp+var_80]
		mov	edx, [ebp+var_1C]
		add	edx, 4
		mov	[esp+98h+Source], eax ;	Source
		mov	[esp+98h+File],	edx ; Dest
		call	strcpy
		mov	eax, [ebp+arg_0]
		mov	edx, [eax+34h]
		mov	eax, [ebp+var_1C]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_1C]
		mov	[eax+34h], edx

loc_4120CD:				; CODE XREF: sub_411F61+123j
		mov	[ebp+var_18], 0
		jmp	loc_411FB5
; ---------------------------------------------------------------------------

loc_4120D9:				; CODE XREF: sub_411F61+8Bj
		nop
		jmp	short loc_4120DD
; ---------------------------------------------------------------------------

loc_4120DC:				; CODE XREF: sub_411F61+F4j
		nop

loc_4120DD:				; CODE XREF: sub_411F61+1Ej
					; sub_411F61+6Fj ...
		cmp	[ebp+var_14], 0
		jz	loc_411F84
		mov	eax, 0

locret_4120EC:				; CODE XREF: sub_411F61+141j
		leave
		retn
sub_411F61	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4120EE	proc near		; CODE XREF: sub_41212A+48Ap

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+34h]
		mov	[ebp+var_C], eax
		jmp	short loc_412118
; ---------------------------------------------------------------------------

loc_4120FF:				; CODE XREF: sub_4120EE+2Ej
		mov	eax, [ebp+var_C]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		mov	[esp+28h+var_28], eax ;	void *
		call	sub_404E31
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax

loc_412118:				; CODE XREF: sub_4120EE+Fj
		cmp	[ebp+var_C], 0
		jnz	short loc_4120FF
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+34h], 0
		leave
		retn
sub_4120EE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41212A(FILE *, int, int, int,	int)
sub_41212A	proc near		; CODE XREF: sub_401695+1EEp

File		= dword	ptr -0C8h
Str2		= dword	ptr -0C4h
Size		= dword	ptr -0C0h
var_AC		= dword	ptr -0ACh
Str1		= byte ptr -9Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
Str		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 0C4h
		mov	[ebp+var_14], 0
		mov	[ebp+Str], 0
		mov	[ebp+var_1C], 0
		mov	[ebp+var_20], 0
		cmp	[ebp+arg_0], 0
		jnz	short loc_41216D
		mov	eax, [ebp+arg_10]
		mov	[esp+0C8h+Str2], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax
		call	sub_412B0D
		jmp	loc_4129AC
; ---------------------------------------------------------------------------

loc_41216D:				; CODE XREF: sub_41212A+2Aj
		mov	eax, [ebp+arg_8]
		mov	[esp+0C8h+Size], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Str2], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax
		call	sub_411BC0
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	short loc_412196
; ---------------------------------------------------------------------------

loc_412195:				; CODE XREF: sub_41212A+4D3j
					; sub_41212A+518j ...
		nop

loc_412196:				; CODE XREF: sub_41212A+69j
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+File], eax ; File
		call	getc
		mov	[ebp+C], eax
		cmp	[ebp+C], 0Ah
		jz	short loc_4121B4
		cmp	[ebp+C], 0FFFFFFFFh
		jnz	loc_4125F9

loc_4121B4:				; CODE XREF: sub_41212A+7Ej
		cmp	[ebp+C], 0FFFFFFFFh
		jz	short loc_4121C7
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx

loc_4121C7:				; CODE XREF: sub_41212A+8Ej
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	loc_4129A2
		cmp	[ebp+var_C], 2
		jnz	loc_41235D
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	[ebp+var_10], 0
		jmp	short loc_412226
; ---------------------------------------------------------------------------

loc_4121F0:				; CODE XREF: sub_41212A+109j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_412222
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+4]
		lea	edx, [ebp+Str1]
		mov	[esp+0C8h+Str2], edx ; Str2
		mov	[esp+0C8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_412237

loc_412222:				; CODE XREF: sub_41212A+D4j
		add	[ebp+var_10], 1

loc_412226:				; CODE XREF: sub_41212A+C4j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4121F0
		jmp	short loc_412238
; ---------------------------------------------------------------------------

loc_412237:				; CODE XREF: sub_41212A+F6j
		nop

loc_412238:				; CODE XREF: sub_41212A+10Bj
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	edx, [eax]
		mov	eax, [ebp+arg_C]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jz	short loc_412274
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	loc_41299D
; ---------------------------------------------------------------------------

loc_412274:				; CODE XREF: sub_41212A+136j
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_41230A
		mov	[esp+0C8h+Str2], offset	Str2 ; "ignore-invalid-option"
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4122B3
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	loc_41299D
; ---------------------------------------------------------------------------

loc_4122B3:				; CODE XREF: sub_41212A+175j
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+Str2], eax ; char *
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax ; int
		call	sub_411F1B
		test	eax, eax
		jz	short loc_4122DE
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	loc_41299D
; ---------------------------------------------------------------------------

loc_4122DE:				; CODE XREF: sub_41212A+1A0j
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 80h
		test	eax, eax
		jz	short loc_4122FA
		mov	eax, 0FFFFFFF9h
		jmp	short loc_4122FF
; ---------------------------------------------------------------------------

loc_4122FA:				; CODE XREF: sub_41212A+1C7j
		mov	eax, 0FFFFFFFEh

loc_4122FF:				; CODE XREF: sub_41212A+1CEj
		mov	edx, [ebp+arg_C]
		mov	[edx+10h], eax
		jmp	loc_4129A6
; ---------------------------------------------------------------------------

loc_41230A:				; CODE XREF: sub_41212A+157j
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_41232C
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_4129A6
; ---------------------------------------------------------------------------

loc_41232C:				; CODE XREF: sub_41212A+1F1j
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_41234E
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_4129A6
; ---------------------------------------------------------------------------

loc_41234E:				; CODE XREF: sub_41212A+213j
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_4129A6
; ---------------------------------------------------------------------------

loc_41235D:				; CODE XREF: sub_41212A+ABj
		cmp	[ebp+var_C], 3
		jnz	short loc_4123CB
		cmp	[ebp+var_20], 0
		jz	short loc_412378
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_4129A6
; ---------------------------------------------------------------------------

loc_412378:				; CODE XREF: sub_41212A+23Dj
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_41239A
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_4129A6
; ---------------------------------------------------------------------------

loc_41239A:				; CODE XREF: sub_41212A+25Fj
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_4123BC
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+14h], 0
		jmp	loc_4129A6
; ---------------------------------------------------------------------------

loc_4123BC:				; CODE XREF: sub_41212A+281j
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_4129A6
; ---------------------------------------------------------------------------

loc_4123CB:				; CODE XREF: sub_41212A+237j
		cmp	[ebp+var_C], 4
		jnz	loc_4125A8
		cmp	[ebp+var_20], 0
		jz	loc_412476
		cmp	[ebp+Str], 0
		jnz	short loc_4123F4
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFAh
		jmp	loc_4125A3
; ---------------------------------------------------------------------------

loc_4123F4:				; CODE XREF: sub_41212A+2B9j
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	byte ptr [eax],	0
		mov	[esp+0C8h+Str2], offset	Control	; " \t"
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax ; Str
		call	strpbrk
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_41242E
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_24]
		mov	[esp+0C8h+File], eax
		call	sub_414020

loc_41242E:				; CODE XREF: sub_41212A+2EDj
		cmp	[ebp+var_24], 0
		jz	short loc_41243E
		mov	eax, [ebp+var_24]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_412458

loc_41243E:				; CODE XREF: sub_41212A+308j
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax ; void *
		call	sub_404E31
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFF6h
		jmp	loc_4129A5
; ---------------------------------------------------------------------------

loc_412458:				; CODE XREF: sub_41212A+312j
		mov	eax, [ebp+var_24]
		mov	[esp+0C8h+Size], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+Str2], eax
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax
		call	sub_411F16
		jmp	loc_4125A3
; ---------------------------------------------------------------------------

loc_412476:				; CODE XREF: sub_41212A+2AFj
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jnz	short loc_412498
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFAh
		jmp	loc_4129A5
; ---------------------------------------------------------------------------

loc_412498:				; CODE XREF: sub_41212A+35Dj
		cmp	[ebp+Str], 0
		jnz	short loc_4124CD
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+File], eax ; char *
		call	sub_404CF8
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jnz	short loc_4124D6
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	short loc_4124D6
; ---------------------------------------------------------------------------

loc_4124CD:				; CODE XREF: sub_41212A+372j
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	byte ptr [eax],	0

loc_4124D6:				; CODE XREF: sub_41212A+395j
					; sub_41212A+3A1j
		cmp	[ebp+Str], 0
		jz	loc_4129A5
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax
		call	sub_414020
		mov	eax, [ebp+Str]
		mov	[ebp+var_28], eax
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_412569
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_412569
		mov	eax, [ebp+var_28]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+var_28]
		movzx	eax, byte ptr [eax]
		cmp	al, 22h
		jnz	short loc_412569
		mov	eax, [ebp+var_28]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		sub	eax, 1
		add	eax, [ebp+var_28]
		mov	byte ptr [eax],	0

loc_412569:				; CODE XREF: sub_41212A+3CFj
					; sub_41212A+3DDj ...
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_28]
		mov	[esp+0C8h+Size], edx ; char *
		mov	[esp+0C8h+Str2], eax ; int
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax ; int
		call	sub_4132C2
		test	eax, eax
		jnz	loc_4129A5
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax ; void *
		call	sub_404E31
		jmp	loc_4129A5
; ---------------------------------------------------------------------------

loc_4125A3:				; CODE XREF: sub_41212A+2C5j
					; sub_41212A+347j
		jmp	loc_4129A5
; ---------------------------------------------------------------------------

loc_4125A8:				; CODE XREF: sub_41212A+2A5j
		cmp	[ebp+C], 0FFFFFFFFh
		jnz	short loc_4125E6
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax
		call	sub_4120EE
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+File], eax ; File
		call	ferror
		test	eax, eax
		jz	short loc_4125D7
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFBh
		jmp	loc_4129A6
; ---------------------------------------------------------------------------

loc_4125D7:				; CODE XREF: sub_41212A+49Cj
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0
		jmp	loc_4129A6
; ---------------------------------------------------------------------------

loc_4125E6:				; CODE XREF: sub_41212A+482j
		mov	[ebp+var_C], 0
		mov	[ebp+var_10], 0
		jmp	loc_41299D
; ---------------------------------------------------------------------------

loc_4125F9:				; CODE XREF: sub_41212A+84j
		cmp	[ebp+var_C], 0FFFFFFFFh
		jz	loc_412195
		cmp	[ebp+var_C], 0
		jnz	short loc_412626
		mov	eax, [ebp+C]
		cmp	eax, 7Fh
		ja	short loc_412626
		mov	eax, [ebp+C]
		mov	[esp+0C8h+File], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_41299D

loc_412626:				; CODE XREF: sub_41212A+4DDj
					; sub_41212A+4E5j
		cmp	[ebp+var_C], 0
		jnz	short loc_41263E
		cmp	[ebp+C], 23h
		jnz	short loc_41263E
		mov	[ebp+var_C], 1
		jmp	loc_41299D
; ---------------------------------------------------------------------------

loc_41263E:				; CODE XREF: sub_41212A+500j
					; sub_41212A+506j
		cmp	[ebp+var_C], 1
		jz	loc_412195
		cmp	[ebp+var_C], 2
		jnz	loc_412808
		mov	eax, [ebp+C]
		cmp	eax, 7Fh
		ja	loc_412808
		mov	eax, [ebp+C]
		mov	[esp+0C8h+File], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	loc_412808
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	[ebp+var_10], 0
		jmp	short loc_4126BE
; ---------------------------------------------------------------------------

loc_412688:				; CODE XREF: sub_41212A+5A1j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_4126BA
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+4]
		lea	edx, [ebp+Str1]
		mov	[esp+0C8h+Str2], edx ; Str2
		mov	[esp+0C8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_4126CF

loc_4126BA:				; CODE XREF: sub_41212A+56Cj
		add	[ebp+var_10], 1

loc_4126BE:				; CODE XREF: sub_41212A+55Cj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_412688
		jmp	short loc_4126D0
; ---------------------------------------------------------------------------

loc_4126CF:				; CODE XREF: sub_41212A+58Ej
		nop

loc_4126D0:				; CODE XREF: sub_41212A+5A3j
		mov	eax, [ebp+var_10]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	edx, [eax]
		mov	eax, [ebp+arg_C]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jz	short loc_412706
		mov	[ebp+var_C], 1
		jmp	loc_41299D
; ---------------------------------------------------------------------------

loc_412706:				; CODE XREF: sub_41212A+5CEj
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_4127FC
		mov	[esp+0C8h+Str2], offset	aAlias ; "alias"
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_412746
		mov	[ebp+var_20], 1
		mov	[ebp+var_C], 3
		jmp	loc_41299D
; ---------------------------------------------------------------------------

loc_412746:				; CODE XREF: sub_41212A+607j
		mov	[esp+0C8h+Str2], offset	Str2 ; "ignore-invalid-option"
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+File], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_4127A4
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+Str2], eax ; FILE *
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax ; int
		call	sub_411F61
		test	eax, eax
		jz	short loc_412785
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	loc_4129A6
; ---------------------------------------------------------------------------

loc_412785:				; CODE XREF: sub_41212A+64Aj
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	eax, [eax]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		jmp	loc_41299D
; ---------------------------------------------------------------------------

loc_4127A4:				; CODE XREF: sub_41212A+634j
		lea	eax, [ebp+Str1]
		mov	[esp+0C8h+Str2], eax ; char *
		mov	eax, [ebp+arg_C]
		mov	[esp+0C8h+File], eax ; int
		call	sub_411F1B
		test	eax, eax
		jz	short loc_4127C9
		mov	[ebp+var_C], 1
		jmp	loc_41299D
; ---------------------------------------------------------------------------

loc_4127C9:				; CODE XREF: sub_41212A+691j
		mov	eax, [ebp+var_14]
		shl	eax, 4
		add	eax, [ebp+arg_10]
		mov	eax, [eax+8]
		and	eax, 80h
		test	eax, eax
		jz	short loc_4127E5
		mov	eax, 0FFFFFFF9h
		jmp	short loc_4127EA
; ---------------------------------------------------------------------------

loc_4127E5:				; CODE XREF: sub_41212A+6B2j
		mov	eax, 0FFFFFFFEh

loc_4127EA:				; CODE XREF: sub_41212A+6B9j
		mov	edx, [ebp+arg_C]
		mov	[edx+10h], eax
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_41299D
; ---------------------------------------------------------------------------

loc_4127FC:				; CODE XREF: sub_41212A+5E9j
		mov	[ebp+var_C], 3
		jmp	loc_41299D
; ---------------------------------------------------------------------------

loc_412808:				; CODE XREF: sub_41212A+522j
					; sub_41212A+52Ej ...
		cmp	[ebp+var_C], 3
		jnz	short loc_412852
		mov	eax, [ebp+C]
		cmp	eax, 7Fh
		ja	short loc_41282B
		mov	eax, [ebp+C]
		mov	[esp+0C8h+File], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	loc_412195

loc_41282B:				; CODE XREF: sub_41212A+6EAj
		mov	[ebp+var_10], 0
		mov	eax, [ebp+C]
		mov	edx, eax
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		mov	[ebp+var_C], 4
		jmp	loc_412195
; ---------------------------------------------------------------------------

loc_412852:				; CODE XREF: sub_41212A+6E2j
		cmp	[ebp+var_C], 4
		jnz	loc_41295F
		cmp	[ebp+Str], 0
		jz	short loc_4128E1
		mov	eax, [ebp+var_10]
		mov	edx, [ebp+var_1C]
		sub	edx, 1
		cmp	eax, edx
		jnb	short loc_412883
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	edx, [ebp+C]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_412195
; ---------------------------------------------------------------------------

loc_412883:				; CODE XREF: sub_41212A+743j
		mov	eax, [ebp+var_1C]
		add	eax, 32h
		mov	[ebp+var_30], eax
		mov	eax, [ebp+var_30]
		mov	[esp+0C8h+Str2], eax ; size_t
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax ; void *
		call	sub_404D4D
		mov	[ebp+var_34], eax
		cmp	[ebp+var_34], 0
		jz	short loc_4128C7
		mov	eax, [ebp+var_30]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_34]
		mov	[ebp+Str], eax
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	edx, [ebp+C]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_412195
; ---------------------------------------------------------------------------

loc_4128C7:				; CODE XREF: sub_41212A+77Bj
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+File], eax ; void *
		call	sub_404E31
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	loc_4129A6
; ---------------------------------------------------------------------------

loc_4128E1:				; CODE XREF: sub_41212A+736j
		mov	eax, [ebp+var_10]
		cmp	eax, 62h
		ja	short loc_412902
		mov	eax, [ebp+C]
		mov	edx, eax
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_412195
; ---------------------------------------------------------------------------

loc_412902:				; CODE XREF: sub_41212A+7BDj
		mov	[ebp+var_38], 96h
		mov	eax, [ebp+var_38]
		mov	[esp+0C8h+File], eax ; size_t
		call	sub_404CAE
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jz	short loc_412953
		mov	eax, [ebp+var_38]
		mov	[ebp+var_1C], eax
		mov	ecx, [ebp+var_10]
		lea	edx, [ebp+Str1]
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+Size], ecx ; Size
		mov	[esp+0C8h+Str2], edx ; Src
		mov	[esp+0C8h+File], eax ; Dst
		call	memcpy
		mov	eax, [ebp+var_10]
		add	eax, [ebp+Str]
		mov	edx, [ebp+C]
		mov	[eax], dl
		add	[ebp+var_10], 1
		jmp	loc_412195
; ---------------------------------------------------------------------------

loc_412953:				; CODE XREF: sub_41212A+7F1j
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFF5h
		jmp	short loc_4129A6
; ---------------------------------------------------------------------------

loc_41295F:				; CODE XREF: sub_41212A+72Cj
		mov	eax, [ebp+var_10]
		cmp	eax, 62h
		jbe	short loc_41297D
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+10h], 0FFFFFFFCh
		mov	[ebp+var_C], 0FFFFFFFFh
		jmp	loc_412195
; ---------------------------------------------------------------------------

loc_41297D:				; CODE XREF: sub_41212A+83Bj
		mov	eax, [ebp+C]
		mov	edx, eax
		lea	eax, [ebp+Str1]
		add	eax, [ebp+var_10]
		mov	[eax], dl
		add	[ebp+var_10], 1
		mov	[ebp+var_C], 2
		jmp	loc_412195
; ---------------------------------------------------------------------------

loc_41299D:				; CODE XREF: sub_41212A+145j
					; sub_41212A+184j ...
		jmp	loc_412195
; ---------------------------------------------------------------------------

loc_4129A2:				; CODE XREF: sub_41212A+A1j
		nop
		jmp	short loc_4129A6
; ---------------------------------------------------------------------------

loc_4129A5:				; CODE XREF: sub_41212A+329j
					; sub_41212A+369j ...
		nop

loc_4129A6:				; CODE XREF: sub_41212A+1DBj
					; sub_41212A+1FDj ...
		mov	eax, [ebp+arg_C]
		mov	eax, [eax+10h]

loc_4129AC:				; CODE XREF: sub_41212A+3Ej
		add	esp, 0C4h
		pop	edi
		pop	ebp
		retn
sub_41212A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4129B5(int, int, char	*)
sub_4129B5	proc near		; CODE XREF: sub_412B0D+182p

Str1		= dword	ptr -38h
Str2		= dword	ptr -34h
MaxCount	= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4129D0
		mov	eax, 0FFFFFFFFh
		jmp	loc_412B07
; ---------------------------------------------------------------------------

loc_4129D0:				; CODE XREF: sub_4129B5+Fj
		mov	[ebp+var_C], 0
		jmp	short loc_412A14
; ---------------------------------------------------------------------------

loc_4129D9:				; CODE XREF: sub_4129B5+6Cj
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_412A10
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_412A10
		mov	eax, [ebp+var_C]
		jmp	loc_412B07
; ---------------------------------------------------------------------------

loc_412A10:				; CODE XREF: sub_4129B5+32j
					; sub_4129B5+51j
		add	[ebp+var_C], 1

loc_412A14:				; CODE XREF: sub_4129B5+22j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4129D9
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	loc_412AEF
; ---------------------------------------------------------------------------

loc_412A51:				; CODE XREF: sub_4129B5+147j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	loc_412AEB
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[esp+38h+MaxCount], edx	; MaxCount
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_412AEB
		mov	eax, [ebp+var_C]
		add	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_412AD7
; ---------------------------------------------------------------------------

loc_412A96:				; CODE XREF: sub_4129B5+12Fj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_412AD3
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[esp+38h+MaxCount], edx	; MaxCount
		mov	edx, [ebp+arg_8]
		mov	[esp+38h+Str2],	edx ; Str2
		mov	[esp+38h+Str1],	eax ; Str1
		call	strncmp
		test	eax, eax
		jnz	short loc_412AD3
		mov	eax, 0FFFFFFFEh
		jmp	short loc_412B07
; ---------------------------------------------------------------------------

loc_412AD3:				; CODE XREF: sub_4129B5+EFj
					; sub_4129B5+115j
		add	[ebp+var_10], 1

loc_412AD7:				; CODE XREF: sub_4129B5+DFj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_412A96
		mov	eax, [ebp+var_C]
		jmp	short loc_412B07
; ---------------------------------------------------------------------------

loc_412AEB:				; CODE XREF: sub_4129B5+AAj
					; sub_4129B5+D4j
		add	[ebp+var_C], 1

loc_412AEF:				; CODE XREF: sub_4129B5+97j
		mov	eax, [ebp+var_C]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_412A51
		mov	eax, 0FFFFFFFFh

loc_412B07:				; CODE XREF: sub_4129B5+16j
					; sub_4129B5+56j ...
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_4129B5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_412B0D	proc near		; CODE XREF: sub_41212A+39p

Str		= dword	ptr -38h
Val		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	[esp+38h+Count], 0
		mov	[esp+38h+Val], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_411BC0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp+var_10], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	eax, [eax]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+1Ch]
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_412B71
		cmp	[ebp+var_10], 0
		jz	short loc_412B71
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 10h
		test	eax, eax
		jnz	short loc_412B71
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1

loc_412B71:				; CODE XREF: sub_412B0D+43j
					; sub_412B0D+49j ...
		cmp	[ebp+var_10], 0
		jnz	short loc_412B86
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		jmp	loc_41329C
; ---------------------------------------------------------------------------

loc_412B86:				; CODE XREF: sub_412B0D+68j
		mov	eax, [ebp+var_14]
		mov	eax, [eax]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+28h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_412BDC
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 2
		test	eax, eax
		jz	short loc_412BDC
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_41329C
; ---------------------------------------------------------------------------

loc_412BDC:				; CODE XREF: sub_412B0D+92j
					; sub_412B0D+9Fj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+24h]
		test	eax, eax
		jz	short loc_412BF5
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0
		jmp	loc_41329C
; ---------------------------------------------------------------------------

loc_412BF5:				; CODE XREF: sub_412B0D+D7j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	loc_412F77
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	loc_412F77
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		mov	eax, [ebp+var_18]
		add	eax, 2
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_412C53
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jnz	short loc_412C53
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 1
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_412B71
; ---------------------------------------------------------------------------

loc_412C53:				; CODE XREF: sub_412B0D+11Cj
					; sub_412B0D+129j
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], 3Dh ; Val
		mov	[esp+38h+Str], eax ; Str
		call	strchr
		mov	[ebp+var_28], eax
		cmp	[ebp+var_28], 0
		jz	short loc_412C78
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	0

loc_412C78:				; CODE XREF: sub_412B0D+163j
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Count], eax ; char *
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_4129B5
		mov	[ebp+var_20], eax
		cmp	[ebp+var_28], 0
		jz	short loc_412CA3
		mov	eax, [ebp+var_28]
		mov	byte ptr [eax],	3Dh

loc_412CA3:				; CODE XREF: sub_412B0D+18Ej
		cmp	[ebp+var_20], 0
		jns	short loc_412CDD
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset Str1 ; "help"
		call	strcmp
		test	eax, eax
		jnz	short loc_412CDD
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax
		call	sub_4134F8
; ---------------------------------------------------------------------------
		jmp	loc_412E18
; ---------------------------------------------------------------------------

loc_412CDD:				; CODE XREF: sub_412B0D+19Aj
					; sub_412B0D+1B4j
		cmp	[ebp+var_20], 0
		jns	short loc_412D1F
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aVersion ; "version"
		call	strcmp
		test	eax, eax
		jnz	short loc_412D1F
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jnz	loc_412E18
		call	sub_413A63
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_412D1F:				; CODE XREF: sub_412B0D+1D4j
					; sub_412B0D+1EEj
		cmp	[ebp+var_20], 0
		jns	short loc_412D5F
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aWarranty	; "warranty"
		call	strcmp
		test	eax, eax
		jnz	short loc_412D5F
		mov	[esp+38h+Str], 10h
		call	sub_413D19
		mov	[esp+38h+Str], eax ; Str
		call	puts
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_412D5F:				; CODE XREF: sub_412B0D+216j
					; sub_412B0D+230j
		cmp	[ebp+var_20], 0
		jns	loc_412E18
		mov	eax, [ebp+var_18]
		add	eax, 2
		mov	[esp+38h+Val], eax ; Str2
		mov	[esp+38h+Str], offset aDumpOptions ; "dump-options"
		call	strcmp
		test	eax, eax
		jnz	loc_412E18
		mov	[ebp+var_20], 0
		jmp	short loc_412DD4
; ---------------------------------------------------------------------------

loc_412D90:				; CODE XREF: sub_412B0D+2D4j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_412DD0
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 40h
		test	eax, eax
		jnz	short loc_412DD0
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax+4]
		mov	eax, offset aS_0 ; "--%s\n"
		mov	[esp+38h+Val], edx
		mov	[esp+38h+Str], eax ; Format
		call	printf

loc_412DD0:				; CODE XREF: sub_412B0D+291j
					; sub_412B0D+2A4j
		add	[ebp+var_20], 1

loc_412DD4:				; CODE XREF: sub_412B0D+281j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_412D90
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aDumpOptionsHel ; "--dump-options\n--help\n--version\n--wa"...
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 2Bh ; Count
		mov	[esp+38h+Val], 1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		mov	[esp+38h+Str], 0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_412E18:				; CODE XREF: sub_412B0D+1CBj
					; sub_412B0D+1FBj ...
		cmp	[ebp+var_20], 0FFFFFFFEh
		jnz	short loc_412E2A
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF8h
		jmp	short loc_412E59
; ---------------------------------------------------------------------------

loc_412E2A:				; CODE XREF: sub_412B0D+30Fj
		cmp	[ebp+var_20], 0FFFFFFFFh
		jnz	short loc_412E48
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFEh
		mov	eax, [ebp+var_18]
		lea	edx, [eax+2]
		mov	eax, [ebp+arg_0]
		mov	[eax+18h], edx
		jmp	short loc_412E59
; ---------------------------------------------------------------------------

loc_412E48:				; CODE XREF: sub_412B0D+321j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx

loc_412E59:				; CODE XREF: sub_412B0D+31Bj
					; sub_412B0D+339j
		cmp	[ebp+var_20], 0
		js	loc_412F66
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jz	loc_412F47
		cmp	[ebp+var_28], 0
		jz	short loc_412E9C
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_412EA5
		mov	[ebp+var_1C], 0
		jmp	short loc_412EA5
; ---------------------------------------------------------------------------

loc_412E9C:				; CODE XREF: sub_412B0D+371j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], eax

loc_412EA5:				; CODE XREF: sub_412B0D+384j
					; sub_412B0D+38Dj
		cmp	[ebp+var_1C], 0
		jnz	short loc_412ECD
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_412ECD
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	loc_412F66
; ---------------------------------------------------------------------------

loc_412ECD:				; CODE XREF: sub_412B0D+39Cj
					; sub_412B0D+3AFj
		cmp	[ebp+var_1C], 0
		jnz	short loc_412EE2
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	loc_412F65
; ---------------------------------------------------------------------------

loc_412EE2:				; CODE XREF: sub_412B0D+3C4j
		cmp	[ebp+var_28], 0
		jnz	short loc_412F11
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_412F11
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_412F11
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_412F66
; ---------------------------------------------------------------------------

loc_412F11:				; CODE XREF: sub_412B0D+3D9j
					; sub_412B0D+3E3j ...
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_4132C2
		cmp	[ebp+var_28], 0
		jnz	short loc_412F65
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_412F65
; ---------------------------------------------------------------------------

loc_412F47:				; CODE XREF: sub_412B0D+367j
		cmp	[ebp+var_28], 0
		jz	short loc_412F59
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0FFFFFFFAh
		jmp	short loc_412F66
; ---------------------------------------------------------------------------

loc_412F59:				; CODE XREF: sub_412B0D+43Ej
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_412F66
; ---------------------------------------------------------------------------

loc_412F65:				; CODE XREF: sub_412B0D+3D0j
					; sub_412B0D+42Aj ...
		nop

loc_412F66:				; CODE XREF: sub_412B0D+350j
					; sub_412B0D+3BBj ...
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	loc_41329C
; ---------------------------------------------------------------------------

loc_412F77:				; CODE XREF: sub_412B0D+F0j
					; sub_412B0D+101j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_412F8E
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_412F9C

loc_412F8E:				; CODE XREF: sub_412B0D+472j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jz	loc_413254

loc_412F9C:				; CODE XREF: sub_412B0D+47Fj
		mov	[ebp+var_24], 0
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		test	eax, eax
		jnz	short loc_413027
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 20h
		test	eax, eax
		jz	short loc_413027
		mov	[ebp+var_20], 0
		jmp	short loc_413018
; ---------------------------------------------------------------------------

loc_412FD9:				; CODE XREF: sub_412B0D+518j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_413014
		mov	eax, [ebp+var_18]
		lea	edx, [eax+1]
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+4]
		mov	[esp+38h+Val], edx ; Str2
		mov	[esp+38h+Str], eax ; Str1
		call	strcmp
		test	eax, eax
		jnz	short loc_413014
		mov	[ebp+var_24], 1
		jmp	short loc_413027
; ---------------------------------------------------------------------------

loc_413014:				; CODE XREF: sub_412B0D+4DAj
					; sub_412B0D+4FCj
		add	[ebp+var_20], 1

loc_413018:				; CODE XREF: sub_412B0D+4CAj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_412FD9

loc_413027:				; CODE XREF: sub_412B0D+4A5j
					; sub_412B0D+4C1j ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		add	[ebp+var_18], eax
		cmp	[ebp+var_24], 0
		jnz	short loc_41306D
		mov	[ebp+var_20], 0
		jmp	short loc_41305B
; ---------------------------------------------------------------------------

loc_41303F:				; CODE XREF: sub_412B0D+55Bj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		cmp	edx, eax
		jz	short loc_41306C
		add	[ebp+var_20], 1

loc_41305B:				; CODE XREF: sub_412B0D+530j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_41303F
		jmp	short loc_41306D
; ---------------------------------------------------------------------------

loc_41306C:				; CODE XREF: sub_412B0D+548j
		nop

loc_41306D:				; CODE XREF: sub_412B0D+527j
					; sub_412B0D+55Dj
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_4130A5
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 68h
		jz	short loc_413090
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Fh
		jnz	short loc_4130A5

loc_413090:				; CODE XREF: sub_412B0D+577j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		mov	[esp+38h+Val], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+38h+Str], eax
		call	sub_4134F8
; ---------------------------------------------------------------------------

loc_4130A5:				; CODE XREF: sub_412B0D+56Dj
					; sub_412B0D+581j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	edx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax+10h], edx
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_413109
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 80h
		test	eax, eax
		jz	short loc_4130E1
		mov	eax, 0FFFFFFF9h
		jmp	short loc_4130E6
; ---------------------------------------------------------------------------

loc_4130E1:				; CODE XREF: sub_412B0D+5CBj
		mov	eax, 0FFFFFFFEh

loc_4130E6:				; CODE XREF: sub_412B0D+5D2j
		mov	edx, [ebp+arg_0]
		mov	[edx+10h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		jmp	loc_413229
; ---------------------------------------------------------------------------

loc_413109:				; CODE XREF: sub_412B0D+5B6j
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 7
		test	eax, eax
		jz	loc_413210
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_413163
		cmp	[ebp+var_24], 0
		jnz	short loc_413163
		mov	eax, [ebp+var_18]
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_4132C2
		jmp	loc_413207
; ---------------------------------------------------------------------------

loc_413163:				; CODE XREF: sub_412B0D+61Ej
					; sub_412B0D+624j
		mov	eax, [ebp+var_14]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_413191
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_413191
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_413207
; ---------------------------------------------------------------------------

loc_413191:				; CODE XREF: sub_412B0D+663j
					; sub_412B0D+676j
		cmp	[ebp+var_1C], 0
		jnz	short loc_4131A3
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFDh
		jmp	short loc_413207
; ---------------------------------------------------------------------------

loc_4131A3:				; CODE XREF: sub_412B0D+688j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_4131D9
		mov	eax, [ebp+var_1C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4131D9
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		and	eax, 8
		test	eax, eax
		jz	short loc_4131D9
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		jmp	short loc_413207
; ---------------------------------------------------------------------------

loc_4131D9:				; CODE XREF: sub_412B0D+69Ej
					; sub_412B0D+6ABj ...
		mov	eax, [ebp+var_20]
		shl	eax, 4
		add	eax, [ebp+arg_4]
		mov	eax, [eax+8]
		mov	edx, [ebp+var_1C]
		mov	[esp+38h+Count], edx ; char *
		mov	[esp+38h+Val], eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; int
		call	sub_4132C2
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1

loc_413207:				; CODE XREF: sub_412B0D+651j
					; sub_412B0D+682j ...
		mov	[ebp+var_18], offset asc_41C398	; "x"
		jmp	short loc_413229
; ---------------------------------------------------------------------------

loc_413210:				; CODE XREF: sub_412B0D+60Dj
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 0
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+20h]
		lea	edx, [eax+1]
		mov	eax, [ebp+arg_0]
		mov	[eax+20h], edx

loc_413229:				; CODE XREF: sub_412B0D+5F7j
					; sub_412B0D+701j
		mov	eax, [ebp+var_18]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41323C
		cmp	[ebp+var_24], 0
		jz	short loc_41329B

loc_41323C:				; CODE XREF: sub_412B0D+727j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+20h], 0
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_41329B
; ---------------------------------------------------------------------------

loc_413254:				; CODE XREF: sub_412B0D+489j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+8]
		and	eax, 4
		test	eax, eax
		jz	short loc_41328C
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+14h], 2
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_18]
		mov	[eax+18h], edx
		sub	[ebp+var_10], 1
		add	[ebp+var_14], 4
		add	[ebp+var_C], 1
		jmp	short loc_41329C
; ---------------------------------------------------------------------------

loc_41328C:				; CODE XREF: sub_412B0D+752j
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+24h], 1
		jmp	loc_412B71
; ---------------------------------------------------------------------------

loc_41329B:				; CODE XREF: sub_412B0D+72Dj
					; sub_412B0D+745j
		nop

loc_41329C:				; CODE XREF: sub_412B0D+74j
					; sub_412B0D+CAj ...
		mov	eax, [ebp+arg_0]
		mov	eax, [eax]
		mov	edx, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	edx, [ebp+var_14]
		mov	[eax], edx
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_C]
		mov	[eax+1Ch], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		leave
		retn
sub_412B0D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4132C2(int, int, char	*)
sub_4132C2	proc near		; CODE XREF: sub_41212A+45Cp
					; sub_412B0D+421p ...

Str		= dword	ptr -28h
EndPtr		= dword	ptr -24h
Radix		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		and	eax, 10h
		test	eax, eax
		jz	short loc_4132D9
		mov	eax, 0
		jmp	short loc_4132DE
; ---------------------------------------------------------------------------

loc_4132D9:				; CODE XREF: sub_4132C2+Ej
		mov	eax, 0Ah

loc_4132DE:				; CODE XREF: sub_4132C2+15j
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	edx, eax
		and	edx, 7
		mov	eax, [ebp+arg_0]
		mov	[eax+14h], edx
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jz	short loc_41330C
		cmp	eax, 4
		jz	loc_413399
		cmp	eax, 1
		jnz	loc_41343E

loc_41330C:				; CODE XREF: sub_4132C2+36j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtol
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 80000000h
		jz	short loc_413348
		cmp	[ebp+var_10], 7FFFFFFFh
		jnz	short loc_41336A

loc_413348:				; CODE XREF: sub_4132C2+7Bj
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 22h
		jnz	short loc_41336A
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF4h
		mov	eax, 0FFFFFFFFh
		jmp	locret_41344C
; ---------------------------------------------------------------------------

loc_41336A:				; CODE XREF: sub_4132C2+84j
					; sub_4132C2+92j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+14h]
		cmp	eax, 3
		jnz	short loc_413380
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+18h], edx
		jmp	short loc_413389
; ---------------------------------------------------------------------------

loc_413380:				; CODE XREF: sub_4132C2+B1j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+var_10]
		mov	[eax+18h], edx

loc_413389:				; CODE XREF: sub_4132C2+BCj
		mov	eax, 0
		jmp	locret_41344C
; ---------------------------------------------------------------------------

loc_413393:				; CODE XREF: sub_4132C2+F7j
		add	[ebp+arg_8], 1
		jmp	short loc_41339A
; ---------------------------------------------------------------------------

loc_413399:				; CODE XREF: sub_4132C2+3Bj
		nop

loc_41339A:				; CODE XREF: sub_4132C2+D5j
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_4133BB
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Str], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_413393

loc_4133BB:				; CODE XREF: sub_4132C2+E0j
		mov	eax, [ebp+arg_8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jnz	short loc_4133E0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+18h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF4h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41344C
; ---------------------------------------------------------------------------

loc_4133E0:				; CODE XREF: sub_4132C2+101j
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_8]
		mov	edx, [ebp+var_C]
		mov	[esp+28h+Radix], edx ; Radix
		mov	[esp+28h+EndPtr], 0 ; EndPtr
		mov	[esp+28h+Str], eax ; Str
		call	strtoul
		mov	edx, [ebp+arg_0]
		mov	[edx+18h], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+18h]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_413437
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 22h
		jnz	short loc_413437
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+10h], 0FFFFFFF4h
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41344C
; ---------------------------------------------------------------------------

loc_413437:				; CODE XREF: sub_4132C2+154j
					; sub_4132C2+162j
		mov	eax, 0
		jmp	short locret_41344C
; ---------------------------------------------------------------------------

loc_41343E:				; CODE XREF: sub_4132C2+44j
		mov	eax, [ebp+arg_0]
		mov	edx, [ebp+arg_8]
		mov	[eax+18h], edx
		mov	eax, 1

locret_41344C:				; CODE XREF: sub_4132C2+A3j
					; sub_4132C2+CCj ...
		leave
		retn
sub_4132C2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41344E	proc near		; CODE XREF: sub_4134F8+8Ep

var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_4134EF
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_4134EF
		call	sub_415C77
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_4134DA
		add	[ebp+var_C], 1
		jmp	short loc_4134DA
; ---------------------------------------------------------------------------

loc_4134B5:				; CODE XREF: sub_41344E+9Fj
		cmp	[ebp+var_14], 0
		jz	short loc_4134D4
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0C0h
		cmp	eax, 80h
		jz	short loc_4134D4
		add	[ebp+var_C], 1

loc_4134D4:				; CODE XREF: sub_41344E+6Bj
					; sub_41344E+80j
		add	[ebp+var_10], 1
		jmp	short loc_4134DB
; ---------------------------------------------------------------------------

loc_4134DA:				; CODE XREF: sub_41344E+5Fj
					; sub_41344E+65j
		nop

loc_4134DB:				; CODE XREF: sub_41344E+8Aj
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4134EF
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_4134B5

loc_4134EF:				; CODE XREF: sub_41344E+34j
					; sub_41344E+41j ...
		mov	eax, [ebp+var_C]
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
sub_41344E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn bp-based	frame

sub_4134F8	proc near		; CODE XREF: sub_412B0D+1C6p
					; sub_412B0D+593p

Str		= dword	ptr -38h
Size		= dword	ptr -34h
Count		= dword	ptr -30h
File		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 34h
		call	sub_413A63
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[esp+38h+Str], 29h
		call	sub_413D19
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	puts
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	loc_413960
		mov	[ebp+var_18], 0
		mov	eax, [ebp+var_18]
		mov	[ebp+var_10], eax
		jmp	short loc_4135A6
; ---------------------------------------------------------------------------

loc_413547:				; CODE XREF: sub_4134F8+BBj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	short loc_4135A2
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		test	eax, eax
		jz	short loc_41357A
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jz	short loc_4135A2

loc_41357A:				; CODE XREF: sub_4134F8+6Dj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax
		call	sub_41344E
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jle	short loc_4135A2
		cmp	[ebp+var_14], 22h
		jg	short loc_4135A2
		mov	eax, [ebp+var_14]
		mov	[ebp+var_18], eax

loc_4135A2:				; CODE XREF: sub_4134F8+5Dj
					; sub_4134F8+80j ...
		add	[ebp+var_10], 1

loc_4135A6:				; CODE XREF: sub_4134F8+4Dj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	short loc_413547
		add	[ebp+var_18], 0Ah
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jz	short loc_4135D2
		mov	[esp+38h+Str], offset aOptions ; "Options:"
		call	puts

loc_4135D2:				; CODE XREF: sub_4134F8+CCj
		mov	[ebp+var_10], 0
		jmp	loc_413937
; ---------------------------------------------------------------------------

loc_4135DE:				; CODE XREF: sub_4134F8+44Cj
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+0Ch]
		mov	[esp+38h+Str], eax ; char *
		call	sub_411114
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_413616
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jnz	short loc_413616
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_413932

loc_413616:				; CODE XREF: sub_4134F8+101j
					; sub_4134F8+10Bj
		cmp	[ebp+var_C], 0
		jz	short loc_413681
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jnz	short loc_413681
		add	[ebp+var_C], 1
		jmp	short loc_413666
; ---------------------------------------------------------------------------

loc_41362C:				; CODE XREF: sub_4134F8+176j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_413651
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_413662
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	short loc_413662
; ---------------------------------------------------------------------------

loc_413651:				; CODE XREF: sub_4134F8+13Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar

loc_413662:				; CODE XREF: sub_4134F8+149j
					; sub_4134F8+157j
		add	[ebp+var_C], 1

loc_413666:				; CODE XREF: sub_4134F8+132j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41362C
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	loc_413933
; ---------------------------------------------------------------------------

loc_413681:				; CODE XREF: sub_4134F8+122j
					; sub_4134F8+12Cj
		mov	[ebp+var_14], 3
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 0FFh
		jg	loc_413735
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	edx, [eax]
		mov	eax, offset aC_0 ; " -%c"
		mov	[esp+38h+Size],	edx
		mov	[esp+38h+Str], eax ; Format
		call	printf
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jnz	loc_41375E
		cmp	[ebp+var_C], 0
		jz	loc_41375E
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_41375E
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1
		jmp	short loc_413711
; ---------------------------------------------------------------------------

loc_4136F8:				; CODE XREF: sub_4134F8+22Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1

loc_413711:				; CODE XREF: sub_4134F8+1FEj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_413725
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_4136F8

loc_413725:				; CODE XREF: sub_4134F8+221j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41375E
		add	[ebp+var_C], 1
		jmp	short loc_41375E
; ---------------------------------------------------------------------------

loc_413735:				; CODE XREF: sub_4134F8+1A0j
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset asc_41C3A8 ; "   "
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 3 ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite

loc_41375E:				; CODE XREF: sub_4134F8+1D0j
					; sub_4134F8+1DAj ...
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax+4]
		test	eax, eax
		jz	loc_413861
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		cmp	eax, 0FFh
		jg	short loc_413797
		mov	eax, 2Ch
		jmp	short loc_41379C
; ---------------------------------------------------------------------------

loc_413797:				; CODE XREF: sub_4134F8+296j
		mov	eax, 20h

loc_41379C:				; CODE XREF: sub_4134F8+29Dj
		mov	edx, offset aCS	; "%c --%s"
		mov	[esp+38h+Count], ecx
		mov	[esp+38h+Size],	eax
		mov	[esp+38h+Str], edx ; Format
		call	printf
		add	[ebp+var_14], eax
		cmp	[ebp+var_C], 0
		jz	short loc_413822
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_413822
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Dh
		jz	short loc_4137FF
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1
		jmp	short loc_4137FF
; ---------------------------------------------------------------------------

loc_4137E4:				; CODE XREF: sub_4134F8+31Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar
		add	[ebp+var_C], 1
		add	[ebp+var_14], 1
		jmp	short loc_413800
; ---------------------------------------------------------------------------

loc_4137FF:				; CODE XREF: sub_4134F8+2D8j
					; sub_4134F8+2EAj
		nop

loc_413800:				; CODE XREF: sub_4134F8+305j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_413814
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Ch
		jnz	short loc_4137E4

loc_413814:				; CODE XREF: sub_4134F8+310j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_413822
		add	[ebp+var_C], 1

loc_413822:				; CODE XREF: sub_4134F8+2C0j
					; sub_4134F8+2CAj ...
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset asc_41C3A8 ; "   "
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 3 ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		add	[ebp+var_14], 3
		jmp	short loc_413861
; ---------------------------------------------------------------------------

loc_413851:				; CODE XREF: sub_4134F8+36Fj
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_413861:				; CODE XREF: sub_4134F8+274j
					; sub_4134F8+357j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_413851
		cmp	[ebp+var_C], 0
		jz	loc_413924
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_413919
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jle	loc_413919
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[ebp+var_14], 0
		jmp	short loc_4138B2
; ---------------------------------------------------------------------------

loc_4138A2:				; CODE XREF: sub_4134F8+3C0j
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_4138B2:				; CODE XREF: sub_4134F8+3A8j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_4138A2
		jmp	short loc_413919
; ---------------------------------------------------------------------------

loc_4138BC:				; CODE XREF: sub_4134F8+42Aj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_413902
		mov	eax, [ebp+var_C]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_413913
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[ebp+var_14], 0
		jmp	short loc_4138F8
; ---------------------------------------------------------------------------

loc_4138E8:				; CODE XREF: sub_4134F8+406j
		mov	[esp+38h+Str], 20h ; Ch
		call	putchar
		add	[ebp+var_14], 1

loc_4138F8:				; CODE XREF: sub_4134F8+3EEj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_18]
		jl	short loc_4138E8
		jmp	short loc_413913
; ---------------------------------------------------------------------------

loc_413902:				; CODE XREF: sub_4134F8+3CCj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+38h+Str], eax ; Ch
		call	putchar

loc_413913:				; CODE XREF: sub_4134F8+3D9j
					; sub_4134F8+408j
		add	[ebp+var_C], 1
		jmp	short loc_41391A
; ---------------------------------------------------------------------------

loc_413919:				; CODE XREF: sub_4134F8+383j
					; sub_4134F8+38Fj ...
		nop

loc_41391A:				; CODE XREF: sub_4134F8+41Fj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4138BC

loc_413924:				; CODE XREF: sub_4134F8+375j
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		jmp	short loc_413933
; ---------------------------------------------------------------------------

loc_413932:				; CODE XREF: sub_4134F8+118j
		nop

loc_413933:				; CODE XREF: sub_4134F8+184j
					; sub_4134F8+438j
		add	[ebp+var_10], 1

loc_413937:				; CODE XREF: sub_4134F8+E1j
		mov	eax, [ebp+var_10]
		shl	eax, 4
		add	eax, [ebp+arg_0]
		mov	eax, [eax]
		test	eax, eax
		jnz	loc_4135DE
		mov	eax, [ebp+arg_4]
		and	eax, 20h
		test	eax, eax
		jz	short loc_413960
		mov	[esp+38h+Str], offset aASingleDashMay ;	"\n(A single dash may be used instead of"...
		call	puts

loc_413960:				; CODE XREF: sub_4134F8+3Aj
					; sub_4134F8+45Aj
		mov	[esp+38h+Str], 13h
		call	sub_413D19
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	loc_413A47
		mov	[esp+38h+Str], 0Ah ; Ch
		call	putchar
		mov	[esp+38h+Size],	offset a@email@	; "@EMAIL@"
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	strstr
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jz	loc_413A30
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		cmp	edx, eax
		jz	short loc_4139E0
		mov	eax, ds:_iob
		lea	ecx, [eax+20h]
		mov	edx, [ebp+var_1C]
		mov	eax, [ebp+var_C]
		mov	ebx, edx
		sub	ebx, eax
		mov	eax, ebx
		mov	edx, eax
		mov	eax, [ebp+var_C]
		mov	[esp+38h+File],	ecx ; File
		mov	[esp+38h+Count], 1 ; Count
		mov	[esp+38h+Size],	edx ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite

loc_4139E0:				; CODE XREF: sub_4134F8+4B5j
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, offset aHttpBugs_gnupg ; "http://bugs.gnupg.org"
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Count], 15h ; Count
		mov	[esp+38h+Size],	1 ; Size
		mov	[esp+38h+Str], eax ; Str
		call	fwrite
		add	[ebp+var_1C], 7
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_413A47
		mov	eax, ds:_iob
		lea	edx, [eax+20h]
		mov	eax, [ebp+var_1C]
		mov	[esp+38h+Size],	edx ; File
		mov	[esp+38h+Str], eax ; Str
		call	fputs
		jmp	short loc_413A47
; ---------------------------------------------------------------------------

loc_413A30:				; CODE XREF: sub_4134F8+4A7j
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+38h+Size],	eax ; File
		mov	eax, [ebp+var_C]
		mov	[esp+38h+Str], eax ; Str
		call	fputs

loc_413A47:				; CODE XREF: sub_4134F8+47Bj
					; sub_4134F8+51Dj ...
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+38h+Str], eax ; File
		call	fflush
		mov	[esp+38h+Str], 0 ; Code
		call	exit
sub_4134F8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413A63	proc near		; CODE XREF: sub_412B0D+201p
					; sub_4134F8+7p

Str		= dword	ptr -28h
File		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, ds:_iob
		lea	ebx, [eax+20h]
		mov	[esp+28h+Str], 0Bh
		call	sub_413D19
		mov	[esp+28h+File],	ebx ; File
		mov	[esp+28h+Str], eax ; Str
		call	fputs
		mov	[esp+28h+Str], 0Ch
		call	sub_413D19
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_413AB3
		mov	eax, offset aS_1 ; " (%s)"
		mov	edx, [ebp+var_10]
		mov	[esp+28h+File],	edx
		mov	[esp+28h+Str], eax ; Format
		call	printf

loc_413AB3:				; CODE XREF: sub_413A63+3Aj
		mov	[esp+28h+Str], 0Dh
		call	sub_413D19
		mov	edx, offset aSS	; " %s %s\n"
		mov	[esp+28h+var_20], offset aGpg4win2_3_1 ; "(Gpg4win 2.3.1)"
		mov	[esp+28h+File],	eax
		mov	[esp+28h+Str], edx ; Format
		call	printf
		mov	[ebp+var_C], 14h
		jmp	short loc_413B04
; ---------------------------------------------------------------------------

loc_413AE1:				; CODE XREF: sub_413A63+A5j
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_413D19
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_413B00
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_413B00:				; CODE XREF: sub_413A63+90j
		add	[ebp+var_C], 1

loc_413B04:				; CODE XREF: sub_413A63+7Cj
		cmp	[ebp+var_C], 1Dh
		jle	short loc_413AE1
		mov	[esp+28h+Str], 0Eh
		call	sub_413D19
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_413B2A
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_413B2A:				; CODE XREF: sub_413A63+BAj
		mov	[esp+28h+Str], 0Ah
		call	sub_413D19
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_413B4A
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	puts

loc_413B4A:				; CODE XREF: sub_413A63+DAj
		mov	[esp+28h+Str], 0Fh
		call	sub_413D19
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_413B76
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_413B76:				; CODE XREF: sub_413A63+FAj
		mov	[esp+28h+Str], 12h
		call	sub_413D19
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_413BA2
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_413BA2:				; CODE XREF: sub_413A63+126j
		mov	[ebp+var_C], 1Eh
		jmp	short loc_413BDA
; ---------------------------------------------------------------------------

loc_413BAB:				; CODE XREF: sub_413A63+17Bj
		mov	eax, [ebp+var_C]
		mov	[esp+28h+Str], eax
		call	sub_413D19
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jz	short loc_413BD6
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+File],	eax ; File
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Str], eax ; Str
		call	fputs

loc_413BD6:				; CODE XREF: sub_413A63+15Aj
		add	[ebp+var_C], 1

loc_413BDA:				; CODE XREF: sub_413A63+146j
		cmp	[ebp+var_C], 27h
		jle	short loc_413BAB
		mov	eax, ds:_iob
		add	eax, 20h
		mov	[esp+28h+Str], eax ; File
		call	fflush
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
sub_413A63	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413BF6	proc near		; CODE XREF: sub_401695+2AAp
					; sub_401695+33Ap ...

File		= dword	ptr -58h
Format		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_2C		= dword	ptr -2Ch
Str		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		cmp	[ebp+arg_0], 0
		jnz	short loc_413C68
		mov	[esp+58h+File],	0Eh
		call	sub_413D19
		mov	esi, eax
		mov	[esp+58h+File],	0Dh
		call	sub_413D19
		mov	ebx, eax
		mov	[esp+58h+File],	0Bh
		call	sub_413D19
		mov	edx, offset aSSS ; "%s %s; %s\n"
		mov	ecx, ds:_iob
		add	ecx, 40h
		mov	[esp+58h+var_48], esi
		mov	[esp+58h+var_4C], ebx
		mov	[esp+58h+var_50], eax
		mov	[esp+58h+Format], edx ;	Format
		mov	[esp+58h+File],	ecx ; File
		call	fprintf
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+58h+File],	eax ; File
		call	fflush
		jmp	loc_413D11
; ---------------------------------------------------------------------------

loc_413C68:				; CODE XREF: sub_413BF6+Dj
		cmp	[ebp+arg_0], 1
		jnz	short loc_413CEB
		mov	[esp+58h+File],	28h
		call	sub_413D19
		mov	[ebp+Str], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+58h+Format], eax ;	File
		mov	eax, [ebp+Str]
		mov	[esp+58h+File],	eax ; Str
		call	fputs
		mov	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_413CDF
		mov	eax, [ebp+Str]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+Str]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_413CDF
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+58h+Format], eax ;	File
		mov	[esp+58h+File],	0Ah ; Ch
		call	putc

loc_413CDF:				; CODE XREF: sub_413BF6+A6j
					; sub_413BF6+CFj
		mov	[esp+58h+File],	2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_413CEB:				; CODE XREF: sub_413BF6+76j
		cmp	[ebp+arg_0], 2
		jnz	short loc_413D11
		mov	[esp+58h+File],	29h
		call	sub_413D19
		mov	[esp+58h+File],	eax ; Str
		call	puts
		mov	[esp+58h+File],	0 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_413D11:				; CODE XREF: sub_413BF6+6Dj
					; sub_413BF6+F9j
		add	esp, 4Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_413BF6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413D19	proc near		; CODE XREF: sub_412B0D+239p
					; sub_4134F8+1Fp ...

var_28		= dword	ptr -28h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, ds:dword_41D3C0
		test	eax, eax
		jz	short loc_413D38
		mov	edx, ds:dword_41D3C0
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	edx ; dword_41D3C0
		jmp	short loc_413D3D
; ---------------------------------------------------------------------------

loc_413D38:				; CODE XREF: sub_413D19+Dj
		mov	eax, 0

loc_413D3D:				; CODE XREF: sub_413D19+1Dj
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jz	short loc_413D4B
		mov	eax, [ebp+var_C]
		jmp	short locret_413DA0
; ---------------------------------------------------------------------------

loc_413D4B:				; CODE XREF: sub_413D19+2Bj
		mov	eax, [ebp+arg_0]
		sub	eax, 0Ah	; switch 32 cases
		cmp	eax, 1Fh
		ja	short loc_413D9D ; jumptable 00413D5D default case
		mov	eax, ds:off_41C794[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_413D5F:				; CODE XREF: sub_413D19+44j
					; DATA XREF: .rdata:off_41C794o
		mov	[ebp+var_C], offset aLicenseGplv3Gn ; jumptable	00413D5D case 10
		jmp	short loc_413D9D ; jumptable 00413D5D default case
; ---------------------------------------------------------------------------

loc_413D68:				; CODE XREF: sub_413D19+44j
					; DATA XREF: .rdata:off_41C794o
		mov	[ebp+var_C], offset aFoo ; jumptable 00413D5D case 11
		jmp	short loc_413D9D ; jumptable 00413D5D default case
; ---------------------------------------------------------------------------

loc_413D71:				; CODE XREF: sub_413D19+44j
					; DATA XREF: .rdata:off_41C794o
		mov	[ebp+var_C], offset a0_0 ; jumptable 00413D5D case 13
		jmp	short loc_413D9D ; jumptable 00413D5D default case
; ---------------------------------------------------------------------------

loc_413D7A:				; CODE XREF: sub_413D19+44j
					; DATA XREF: .rdata:off_41C794o
		mov	[ebp+var_C], offset aCopyrightC2015 ; jumptable	00413D5D case 14
		jmp	short loc_413D9D ; jumptable 00413D5D default case
; ---------------------------------------------------------------------------

loc_413D83:				; CODE XREF: sub_413D19+44j
					; DATA XREF: .rdata:off_41C794o
		mov	[ebp+var_C], offset aThisIsFreeSoft ; jumptable	00413D5D case 15
		jmp	short loc_413D9D ; jumptable 00413D5D default case
; ---------------------------------------------------------------------------

loc_413D8C:				; CODE XREF: sub_413D19+44j
					; DATA XREF: .rdata:off_41C794o
		mov	[ebp+var_C], offset aThisIsFreeSo_0 ; jumptable	00413D5D case 16
		jmp	short loc_413D9D ; jumptable 00413D5D default case
; ---------------------------------------------------------------------------

loc_413D95:				; CODE XREF: sub_413D19+44j
					; DATA XREF: .rdata:off_41C794o
		mov	[ebp+var_C], offset dword_41C790 ; jumptable 00413D5D cases 40,41
		nop

loc_413D9D:				; CODE XREF: sub_413D19+3Bj
					; sub_413D19+44j ...
		mov	eax, [ebp+var_C] ; jumptable 00413D5D default case

locret_413DA0:				; CODE XREF: sub_413D19+30j
		leave
		retn
sub_413D19	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_413DA2	proc near		; CODE XREF: sub_401695+4Bp

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		mov	ds:dword_41D3C0, eax
		pop	ebp
		retn
sub_413DA2	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_413DB0(char *)
sub_413DB0	proc near		; CODE XREF: sub_41438A+356p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+Val], 5Ch ; Val
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_413DF3
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		jmp	short loc_413DE9
; ---------------------------------------------------------------------------

loc_413DD5:				; CODE XREF: sub_413DB0+41j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_413DE5
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	5Ch

loc_413DE5:				; CODE XREF: sub_413DB0+2Dj
		add	[ebp+var_C], 1

loc_413DE9:				; CODE XREF: sub_413DB0+23j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_413DD5

loc_413DF3:				; CODE XREF: sub_413DB0+1Bj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_413DB0	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_413EC9
; ---------------------------------------------------------------------------

loc_413E1C:				; CODE XREF: .text:00413ECDj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jnz	short loc_413EC1
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_413E6E
; ---------------------------------------------------------------------------

loc_413E62:				; CODE XREF: .text:00413E9Ej
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_413E6E:				; CODE XREF: .text:00413E60j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_413EA0
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_413E62

loc_413EA0:				; CODE XREF: .text:00413E72j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_413EAF
		mov	eax, [ebp-18h]
		jmp	short loc_413ED8
; ---------------------------------------------------------------------------

loc_413EAF:				; CODE XREF: .text:00413EA8j
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_413EC1:				; CODE XREF: .text:00413E46j
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_413EC9:				; CODE XREF: .text:00413E17j
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_413E1C
		mov	eax, 0

loc_413ED8:				; CODE XREF: .text:00413EADj
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 24h
		mov	eax, [ebp+8]
		mov	[ebp-18h], eax
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax
		jmp	loc_413FA7
; ---------------------------------------------------------------------------

loc_413F02:				; CODE XREF: .text:00413FABj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_414FC1
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_414FC1
		cmp	ebx, eax
		jnz	short loc_413F9F
		mov	eax, [ebp-0Ch]
		mov	[ebp-18h], eax
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp-14h]
		mov	[ebp+0Ch], eax
		sub	dword ptr [ebp-14h], 1
		add	dword ptr [ebp-10h], 1
		jmp	short loc_413F50
; ---------------------------------------------------------------------------

loc_413F44:				; CODE XREF: .text:00413F7Cj
		add	dword ptr [ebp-0Ch], 1
		add	dword ptr [ebp-10h], 1
		sub	dword ptr [ebp-14h], 1

loc_413F50:				; CODE XREF: .text:00413F42j
		cmp	dword ptr [ebp-14h], 0
		jz	short loc_413F7E
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_414FC1
		mov	ebx, eax
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_414FC1
		cmp	ebx, eax
		jz	short loc_413F44

loc_413F7E:				; CODE XREF: .text:00413F54j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_413F8D
		mov	eax, [ebp-18h]
		jmp	short loc_413FB6
; ---------------------------------------------------------------------------

loc_413F8D:				; CODE XREF: .text:00413F86j
		mov	eax, [ebp-18h]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+10h]
		mov	[ebp-10h], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-14h], eax

loc_413F9F:				; CODE XREF: .text:00413F28j
		add	dword ptr [ebp-0Ch], 1
		sub	dword ptr [ebp-14h], 1

loc_413FA7:				; CODE XREF: .text:00413EFDj
		cmp	dword ptr [ebp-14h], 0
		jnz	loc_413F02
		mov	eax, 0

loc_413FB6:				; CODE XREF: .text:00413F8Bj
		add	esp, 24h
		pop	ebx
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_413FBC(int, int, size_t)
sub_413FBC	proc near		; CODE XREF: sub_402ABC+3Ep
					; sub_402ABC+58p ...

var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_8], 0
		jz	short loc_41401B
		cmp	[ebp+arg_0], 0
		jnz	short loc_413FDC
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_28], eax ;	size_t
		call	sub_404CD4
		mov	[ebp+arg_0], eax

loc_413FDC:				; CODE XREF: sub_413FBC+10j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		sub	[ebp+arg_8], 1
		jmp	short loc_414005
; ---------------------------------------------------------------------------

loc_413FEE:				; CODE XREF: sub_413FBC+57j
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1
		sub	[ebp+arg_8], 1

loc_414005:				; CODE XREF: sub_413FBC+30j
		cmp	[ebp+arg_8], 0
		jz	short loc_414015
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_413FEE

loc_414015:				; CODE XREF: sub_413FBC+4Dj
		mov	eax, [ebp+var_C]
		mov	byte ptr [eax],	0

loc_41401B:				; CODE XREF: sub_413FBC+Aj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_413FBC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414020	proc near		; CODE XREF: sub_41212A+2FFp
					; sub_41212A+3BCp

C		= dword	ptr -28h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_414038
; ---------------------------------------------------------------------------

loc_414034:				; CODE XREF: sub_414020+37j
		add	[ebp+var_10], 1

loc_414038:				; CODE XREF: sub_414020+12j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_414059
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jnz	short loc_414034

loc_414059:				; CODE XREF: sub_414020+20j
		mov	[ebp+var_14], 0
		jmp	short loc_414096
; ---------------------------------------------------------------------------

loc_414062:				; CODE XREF: sub_414020+89j
		mov	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+C], eax ; C
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_414087
		cmp	[ebp+var_14], 0
		jnz	short loc_41408E
		mov	eax, [ebp+var_C]
		mov	[ebp+var_14], eax
		jmp	short loc_41408E
; ---------------------------------------------------------------------------

loc_414087:				; CODE XREF: sub_414020+57j
		mov	[ebp+var_14], 0

loc_41408E:				; CODE XREF: sub_414020+5Dj
					; sub_414020+65j
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_414096:				; CODE XREF: sub_414020+40j
		mov	eax, [ebp+var_10]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		mov	[eax], dl
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_414062
		cmp	[ebp+var_14], 0
		jz	short loc_4140B7
		mov	eax, [ebp+var_14]
		mov	byte ptr [eax],	0

loc_4140B7:				; CODE XREF: sub_414020+8Fj
		mov	eax, [ebp+arg_0]
		leave
		retn
sub_414020	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [ebp-10h], 0
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		jmp	short loc_414101
; ---------------------------------------------------------------------------

loc_4140D1:				; CODE XREF: .text:00414109j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		mov	eax, ds:isspace
		call	eax ; isspace
		test	eax, eax
		jz	short loc_4140F6
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_4140FD
		mov	eax, [ebp-0Ch]
		mov	[ebp-10h], eax
		jmp	short loc_4140FD
; ---------------------------------------------------------------------------

loc_4140F6:				; CODE XREF: .text:004140E6j
		mov	dword ptr [ebp-10h], 0

loc_4140FD:				; CODE XREF: .text:004140ECj
					; .text:004140F4j
		add	dword ptr [ebp-0Ch], 1

loc_414101:				; CODE XREF: .text:004140CFj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4140D1
		cmp	dword ptr [ebp-10h], 0
		jz	short loc_414117
		mov	eax, [ebp-10h]
		mov	byte ptr [eax],	0

loc_414117:				; CODE XREF: .text:0041410Fj
		mov	eax, [ebp+8]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41411C(int, int, char	*)
sub_41411C	proc near		; CODE XREF: .text:004141B3p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_414171
; ---------------------------------------------------------------------------

loc_414138:				; CODE XREF: sub_41411C+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_414162
		cmp	[ebp+var_10], 0
		jnz	short loc_414169
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_414169
; ---------------------------------------------------------------------------

loc_414162:				; CODE XREF: sub_41411C+36j
		mov	[ebp+var_10], 0

loc_414169:				; CODE XREF: sub_41411C+3Cj
					; sub_41411C+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_414171:				; CODE XREF: sub_41411C+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_414138
		cmp	[ebp+var_10], 0
		jz	short loc_414193
		mov	eax, [ebp+var_10]
		mov	byte ptr [eax],	0
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_414196
; ---------------------------------------------------------------------------

loc_414193:				; CODE XREF: sub_41411C+61j
		mov	eax, [ebp+arg_4]

locret_414196:				; CODE XREF: sub_41411C+75j
		leave
		retn
sub_41411C	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_41C814 ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41411C
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_4141BA(int, int, char	*)
sub_4141BA	proc near		; CODE XREF: .text:0041424Bp

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[ebp+var_10], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_41420F
; ---------------------------------------------------------------------------

loc_4141D6:				; CODE XREF: sub_4141BA+5Bj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_414200
		cmp	[ebp+var_10], 0
		jnz	short loc_414207
		mov	eax, [ebp+var_C]
		mov	[ebp+var_10], eax
		jmp	short loc_414207
; ---------------------------------------------------------------------------

loc_414200:				; CODE XREF: sub_4141BA+36j
		mov	[ebp+var_10], 0

loc_414207:				; CODE XREF: sub_4141BA+3Cj
					; sub_4141BA+44j
		add	[ebp+var_14], 1
		add	[ebp+var_C], 1

loc_41420F:				; CODE XREF: sub_4141BA+1Aj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jb	short loc_4141D6
		cmp	[ebp+var_10], 0
		jz	short loc_41422B
		mov	edx, [ebp+var_10]
		mov	eax, [ebp+arg_0]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short locret_41422E
; ---------------------------------------------------------------------------

loc_41422B:				; CODE XREF: sub_4141BA+61j
		mov	eax, [ebp+arg_4]

locret_41422E:				; CODE XREF: sub_4141BA+6Fj
		leave
		retn
sub_4141BA	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], offset asc_41C814 ; " \t\r\n"
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_4141BA
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4142B9
		mov	dword ptr [esp+4], 5Ch
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4142B9
		mov	dword ptr [esp+4], 3Ah
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_4142B9
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_404DD7
		jmp	short locret_4142C7
; ---------------------------------------------------------------------------

loc_4142B9:				; CODE XREF: .text:00414272j
					; .text:0041428Ej ...
		mov	eax, [ebp-0Ch]
		add	eax, 1
		mov	[esp], eax
		call	sub_404DD7

locret_4142C7:				; CODE XREF: .text:004142B7j
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	dword ptr [esp+4], 2Fh
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_414331
		mov	dword ptr [esp+4], 5Ch
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_414331
		mov	dword ptr [esp+4], 3Ah
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	strrchr
		mov	[ebp-0Ch], eax
		cmp	dword ptr [ebp-0Ch], 0
		jnz	short loc_414331
		mov	dword ptr [esp], offset	a__1 ; "."
		call	sub_404DD7
		jmp	short locret_414376
; ---------------------------------------------------------------------------

loc_414331:				; CODE XREF: .text:004142E9j
					; .text:00414305j ...
		mov	edx, [ebp-0Ch]
		mov	eax, [ebp+8]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		mov	[ebp-10h], eax
		mov	eax, [ebp-10h]
		add	eax, 1
		mov	[esp], eax
		call	sub_404CD4
		mov	[ebp-14h], eax
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	strncpy
		mov	eax, [ebp-10h]
		add	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-14h]

locret_414376:				; CODE XREF: .text:0041432Fj
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414378	proc near		; CODE XREF: sub_41438A+144p
					; sub_41438A+22Bp

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	[ebp+var_4], 0
		mov	eax, [ebp+var_4]
		leave
		retn
sub_414378	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41438A	proc near		; CODE XREF: .text:00414712p
					; .text:00414742p

VarName		= dword	ptr -0C8h
Val		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
Str		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	ebx
		sub	esp, 0C0h
		mov	[ebp+var_14], 1
		mov	[ebp+var_18], 0
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_414451
; ---------------------------------------------------------------------------

loc_4143D7:				; CODE XREF: sub_41438A+E8j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, [ebp+var_10]
		add	eax, 1
		mov	[ebp+var_10], eax
		mov	eax, [ebp+var_C]
		cmp	eax, 1Eh
		jbe	short loc_41444D
		cmp	[ebp+arg_0], 0
		jz	short loc_414436
		mov	[esp+0C8h+var_C0], offset aDo_make_filena ; "do_make_filename"
		mov	[esp+0C8h+Val],	176h
		mov	[esp+0C8h+VarName], offset a____Gnupg22__5 ; "../../gnupg2-2.0.30/jnlib/stringhelp.c"
		call	sub_411B8C
; ---------------------------------------------------------------------------

loc_414436:				; CODE XREF: sub_41438A+8Ej
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	loc_4146E5
; ---------------------------------------------------------------------------

loc_41444D:				; CODE XREF: sub_41438A+88j
		add	[ebp+var_C], 1

loc_414451:				; CODE XREF: sub_41438A+4Bj
		mov	eax, [ebp+arg_8]
		lea	edx, [eax+4]
		mov	[ebp+arg_8], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_A8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		test	eax, eax
		jnz	loc_4143D7
		add	[ebp+var_10], 1
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Eh
		jnz	loc_414608
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jz	short loc_4144AB
		mov	eax, [ebp+arg_4]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_414521

loc_4144AB:				; CODE XREF: sub_41438A+112j
		mov	[esp+0C8h+VarName], offset aHome_0 ; "HOME"
		call	getenv
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jnz	short loc_4144DC
		mov	[esp+0C8h+Val],	0
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+VarName], eax
		call	sub_414378
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_20], eax

loc_4144DC:				; CODE XREF: sub_41438A+134j
		cmp	[ebp+var_20], 0
		jz	loc_414607
		mov	eax, [ebp+var_20]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	loc_414607
		mov	eax, [ebp+var_20]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		jmp	loc_414607
; ---------------------------------------------------------------------------

loc_414521:				; CODE XREF: sub_41438A+11Fj
		cmp	[ebp+arg_0], 0
		jz	short loc_41453A
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+0C8h+VarName], eax	; char *
		call	sub_404DD7
		mov	[ebp+Str], eax
		jmp	short loc_41455B
; ---------------------------------------------------------------------------

loc_41453A:				; CODE XREF: sub_41438A+19Bj
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[esp+0C8h+VarName], eax	; char *
		call	sub_404CF8
		mov	[ebp+Str], eax
		cmp	[ebp+Str], 0
		jnz	short loc_41455B
		mov	eax, 0
		jmp	loc_4146E5
; ---------------------------------------------------------------------------

loc_41455B:				; CODE XREF: sub_41438A+1AEj
					; sub_41438A+1C5j
		mov	[esp+0C8h+Val],	2Fh ; Val
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+VarName], eax	; Str
		call	strchr
		mov	[ebp+var_24], eax
		cmp	[ebp+var_24], 0
		jz	short loc_41457D
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0

loc_41457D:				; CODE XREF: sub_41438A+1EBj
		mov	eax, [ebp+Str]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+0C8h+VarName], eax
		call	sub_414378
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_18]
		mov	[ebp+var_20], eax
		mov	eax, [ebp+Str]
		mov	[esp+0C8h+VarName], eax	; void *
		call	sub_404E31
		cmp	[ebp+var_20], 0
		jz	short loc_4145FE
		mov	eax, [ebp+var_20]
		mov	[ebp+var_AC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_AC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		jmp	short loc_414608
; ---------------------------------------------------------------------------

loc_4145FE:				; CODE XREF: sub_41438A+248j
		mov	[ebp+var_14], 1
		jmp	short loc_414608
; ---------------------------------------------------------------------------

loc_414607:				; CODE XREF: sub_41438A+156j
					; sub_41438A+164j ...
		nop

loc_414608:				; CODE XREF: sub_41438A+101j
					; sub_41438A+272j ...
		cmp	[ebp+arg_0], 0
		jz	short loc_41461E
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+VarName], eax	; size_t
		call	sub_404CD4
		mov	[ebp+var_1C], eax
		jmp	short loc_414647
; ---------------------------------------------------------------------------

loc_41461E:				; CODE XREF: sub_41438A+282j
		mov	eax, [ebp+var_10]
		mov	[esp+0C8h+VarName], eax	; size_t
		call	sub_404CAE
		mov	[ebp+var_1C], eax
		cmp	[ebp+var_1C], 0
		jnz	short loc_414647
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+VarName], eax	; void *
		call	sub_404E31
		mov	eax, 0
		jmp	loc_4146E5
; ---------------------------------------------------------------------------

loc_414647:				; CODE XREF: sub_41438A+292j
					; sub_41438A+2A6j
		cmp	[ebp+var_20], 0
		jz	short loc_414678
		mov	eax, [ebp+var_14]
		mov	ebx, eax
		add	ebx, [ebp+arg_4]
		mov	eax, [ebp+var_20]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax
		call	sub_4152CD
		mov	[esp+0C8h+Val],	ebx
		mov	[esp+0C8h+VarName], eax
		call	sub_4152CD
		mov	[ebp+var_24], eax
		jmp	short loc_41468D
; ---------------------------------------------------------------------------

loc_414678:				; CODE XREF: sub_41438A+2C1j
		mov	eax, [ebp+arg_4]
		mov	[esp+0C8h+Val],	eax
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax
		call	sub_4152CD
		mov	[ebp+var_24], eax

loc_41468D:				; CODE XREF: sub_41438A+2ECj
		mov	eax, [ebp+var_18]
		mov	[esp+0C8h+VarName], eax	; void *
		call	sub_404E31
		mov	[ebp+var_C], 0
		jmp	short loc_4146CC
; ---------------------------------------------------------------------------

loc_4146A1:				; CODE XREF: sub_41438A+34Ej
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		mov	edx, [ebp+var_24]
		mov	word ptr [edx],	2Fh
		mov	edx, [ebp+var_24]
		add	edx, 1
		mov	[esp+0C8h+Val],	eax
		mov	[esp+0C8h+VarName], edx
		call	sub_4152CD
		mov	[ebp+var_24], eax
		add	[ebp+var_C], 1

loc_4146CC:				; CODE XREF: sub_41438A+315j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_A8]
		test	eax, eax
		jnz	short loc_4146A1
		mov	eax, [ebp+var_1C]
		mov	[esp+0C8h+VarName], eax	; char *
		call	sub_413DB0

loc_4146E5:				; CODE XREF: sub_41438A+BEj
					; sub_41438A+1CCj ...
		add	esp, 0C0h
		pop	ebx
		pop	edi
		pop	ebp
		retn
sub_41438A	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 1
		call	sub_41438A
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		lea	edx, [ebp+0Ch]
		lea	eax, [ebp-10h]
		mov	[eax], edx
		mov	eax, [ebp-10h]
		mov	[esp+8], eax
		mov	eax, [ebp+8]
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	sub_41438A
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41474F	proc near		; CODE XREF: sub_403E11+5Cp
					; sub_403E11+7Dp ...

C		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		jmp	short loc_4147C4
; ---------------------------------------------------------------------------

loc_414758:				; CODE XREF: sub_41474F+87j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4147BC
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+C], eax ; C
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+C], eax ; C
		mov	eax, ds:toupper
		call	eax ; toupper
		cmp	ebx, eax
		jz	short loc_4147BC
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4147A8
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_4147BC

loc_4147A8:				; CODE XREF: sub_41474F+4Dj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_4147D8
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4147D8

loc_4147BC:				; CODE XREF: sub_41474F+17j
					; sub_41474F+43j ...
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_4147C4:				; CODE XREF: sub_41474F+7j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_4147D8
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_414758

loc_4147D8:				; CODE XREF: sub_41474F+61j
					; sub_41474F+6Bj ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_4147EC
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jz	short loc_414800

loc_4147EC:				; CODE XREF: sub_41474F+91j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_414807
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jnz	short loc_414807

loc_414800:				; CODE XREF: sub_41474F+9Bj
		mov	eax, 0
		jmp	short loc_414835
; ---------------------------------------------------------------------------

loc_414807:				; CODE XREF: sub_41474F+A5j
					; sub_41474F+AFj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+C], eax ; C
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp+18h+C], eax ; C
		mov	eax, ds:toupper
		call	eax ; toupper
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx

loc_414835:				; CODE XREF: sub_41474F+B6j
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_41474F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_414869
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_414869
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4148C0
; ---------------------------------------------------------------------------

loc_414869:				; CODE XREF: .text:00414849j
					; .text:00414853j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_414891
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_414891
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4148C0
; ---------------------------------------------------------------------------

loc_414891:				; CODE XREF: .text:00414871j
					; .text:0041487Bj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_4148B9
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_4148B9
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		shl	eax, 4
		mov	[ebp-4], eax
		jmp	short loc_4148C0
; ---------------------------------------------------------------------------

loc_4148B9:				; CODE XREF: .text:00414899j
					; .text:004148A3j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41493D
; ---------------------------------------------------------------------------

loc_4148C0:				; CODE XREF: .text:00414867j
					; .text:0041488Fj ...
		add	dword ptr [ebp+8], 1
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Fh
		jle	short loc_4148E9
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 39h
		jg	short loc_4148E9
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 30h
		add	[ebp-4], eax
		jmp	short loc_41493A
; ---------------------------------------------------------------------------

loc_4148E9:				; CODE XREF: .text:004148CCj
					; .text:004148D6j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 40h
		jle	short loc_41490E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 46h
		jg	short loc_41490E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 37h
		add	[ebp-4], eax
		jmp	short loc_41493A
; ---------------------------------------------------------------------------

loc_41490E:				; CODE XREF: .text:004148F1j
					; .text:004148FBj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 60h
		jle	short loc_414933
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		cmp	al, 66h
		jg	short loc_414933
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		sub	eax, 57h
		add	[ebp-4], eax
		jmp	short loc_41493A
; ---------------------------------------------------------------------------

loc_414933:				; CODE XREF: .text:00414916j
					; .text:00414920j
		mov	eax, 0FFFFFFFFh
		jmp	short locret_41493D
; ---------------------------------------------------------------------------

loc_41493A:				; CODE XREF: .text:004148E7j
					; .text:0041490Cj ...
		mov	eax, [ebp-4]

locret_41493D:				; CODE XREF: .text:004148BEj
					; .text:00414938j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_41493F(FILE *, int, int, int,	int)
sub_41493F	proc near		; CODE XREF: sub_414AF8+29p
					; .text:00414C35p

var_28		= dword	ptr -28h
File		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	[ebp+var_10], 0
		jmp	loc_414AE9
; ---------------------------------------------------------------------------

loc_414957:				; CODE XREF: sub_41493F+1AEj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_4149A5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_4149A5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_C]
		jz	short loc_4149A5
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_10]
		jz	short loc_4149A5
		cmp	[ebp+arg_C], 0
		jnz	short loc_414997
		cmp	[ebp+arg_10], 0
		jz	loc_414AC1

loc_414997:				; CODE XREF: sub_41493F+4Cj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_414AC1

loc_4149A5:				; CODE XREF: sub_41493F+20j
					; sub_41493F+2Aj ...
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 5Ch ;	Ch
		call	putc
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_4149E2
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 6Eh ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_414ADD
; ---------------------------------------------------------------------------

loc_4149E2:				; CODE XREF: sub_41493F+85j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_414A08
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 72h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_414ADD
; ---------------------------------------------------------------------------

loc_414A08:				; CODE XREF: sub_41493F+ABj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_414A2E
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 66h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_414ADD
; ---------------------------------------------------------------------------

loc_414A2E:				; CODE XREF: sub_41493F+D1j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_414A54
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 76h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	loc_414ADD
; ---------------------------------------------------------------------------

loc_414A54:				; CODE XREF: sub_41493F+F7j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_414A77
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 62h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_414ADD
; ---------------------------------------------------------------------------

loc_414A77:				; CODE XREF: sub_41493F+11Dj
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_414A9A
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+File],	eax ; File
		mov	[esp+28h+var_28], 30h ;	Ch
		call	putc
		add	[ebp+var_10], 1
		jmp	short loc_414ADD
; ---------------------------------------------------------------------------

loc_414A9A:				; CODE XREF: sub_41493F+140j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "x%02x"
		mov	[esp+28h+var_20], edx
		mov	[esp+28h+File],	eax ; Format
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	File
		call	fprintf
		add	[ebp+var_10], 3
		jmp	short loc_414ADD
; ---------------------------------------------------------------------------

loc_414AC1:				; CODE XREF: sub_41493F+52j
					; sub_41493F+60j
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	edx, [ebp+arg_0]
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+var_28], eax ;	Ch
		call	putc
		add	[ebp+var_10], 1

loc_414ADD:				; CODE XREF: sub_41493F+9Ej
					; sub_41493F+C4j ...
		sub	[ebp+arg_8], 1
		add	[ebp+var_C], 1
		add	[ebp+var_10], 1

loc_414AE9:				; CODE XREF: sub_41493F+13j
		cmp	[ebp+arg_8], 0
		jnz	loc_414957
		mov	eax, [ebp+var_10]
		leave
		retn
sub_41493F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_414AF8(FILE *, int, int, int)
sub_414AF8	proc near		; CODE XREF: sub_414B28+B7p
					; .text:00414C8Bp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	[esp+28h+var_18], 0 ; int
		mov	eax, [ebp+arg_C]
		mov	[esp+28h+var_1C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+28h+var_20], eax ;	int
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+var_24], eax ;	int
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax ;	FILE *
		call	sub_41493F
		leave
		retn
sub_414AF8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_414B28(FILE *, int, int, int)
sub_414B28	proc near		; CODE XREF: .text:00414CE1p

Str		= dword	ptr -38h
File		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_1C		= dword	ptr -1Ch
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_10], eax
		mov	[ebp+var_C], 0
		jmp	short loc_414B51
; ---------------------------------------------------------------------------

loc_414B3E:				; CODE XREF: sub_414B28+2Fj
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+var_10]
		add	eax, edx
		movzx	eax, byte ptr [eax]
		test	al, al
		js	short loc_414B5B
		add	[ebp+var_C], 1

loc_414B51:				; CODE XREF: sub_414B28+14j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jb	short loc_414B3E
		jmp	short loc_414B5C
; ---------------------------------------------------------------------------

loc_414B5B:				; CODE XREF: sub_414B28+23j
		nop

loc_414B5C:				; CODE XREF: sub_414B28+31j
		mov	eax, [ebp+var_C]
		cmp	eax, [ebp+arg_8]
		jnb	short loc_414BC4
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_30], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+File],	eax
		mov	eax, [ebp+var_10]
		mov	[esp+38h+Str], eax
		call	sub_41669F
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+File],	edx ; File
		mov	[esp+38h+Str], eax ; Str
		call	fputs
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Str], eax ; void *
		call	sub_404E31
		mov	eax, [ebp+var_C]
		jmp	short loc_414BE4
; ---------------------------------------------------------------------------

loc_414BC4:				; CODE XREF: sub_414B28+3Aj
		mov	eax, [ebp+arg_C]
		mov	[esp+38h+var_2C], eax ;	int
		mov	eax, [ebp+arg_8]
		mov	[esp+38h+var_30], eax ;	int
		mov	eax, [ebp+var_10]
		mov	[esp+38h+File],	eax ; int
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Str], eax ; FILE *
		call	sub_414AF8

loc_414BE4:				; CODE XREF: sub_414B28+9Aj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_414B28	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_414C3C
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+14h]
		mov	[esp+10h], eax
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41493F
		jmp	short loc_414C41
; ---------------------------------------------------------------------------

loc_414C3C:				; CODE XREF: .text:00414BF5j
		mov	eax, 0

loc_414C41:				; CODE XREF: .text:00414C3Aj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_414C92
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_414AF8
		jmp	short loc_414C97
; ---------------------------------------------------------------------------

loc_414C92:				; CODE XREF: .text:00414C52j
		mov	eax, 0

loc_414C97:				; CODE XREF: .text:00414C90j
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 24h
		cmp	dword ptr [ebp+0Ch], 0
		jz	short loc_414CE8
		mov	eax, [ebp+0Ch]
		mov	dword ptr [ebp-0Ch], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp-0Ch]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		lea	edx, [eax-1]
		mov	eax, [ebp+10h]
		mov	[esp+0Ch], eax
		mov	[esp+8], edx
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_414B28
		jmp	short loc_414CED
; ---------------------------------------------------------------------------

loc_414CE8:				; CODE XREF: .text:00414CA8j
		mov	eax, 0

loc_414CED:				; CODE XREF: .text:00414CE6j
		add	esp, 24h
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 38h
		mov	eax, [ebp+8]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-18h], eax
		mov	eax, [ebp-0Ch]
		mov	[ebp-1Ch], eax
		mov	dword ptr [ebp-10h], 1
		jmp	loc_414D9D
; ---------------------------------------------------------------------------

loc_414D17:				; CODE XREF: .text:00414DA1j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_414D49
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_414D49
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+10h]
		jz	short loc_414D49
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_414D91
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	short loc_414D91

loc_414D49:				; CODE XREF: .text:00414D1Fj
					; .text:00414D29j ...
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jz	short loc_414D85
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jz	short loc_414D85
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jz	short loc_414D85
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jz	short loc_414D85
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jz	short loc_414D85
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_414D8B

loc_414D85:				; CODE XREF: .text:00414D51j
					; .text:00414D5Bj ...
		add	dword ptr [ebp-10h], 2
		jmp	short loc_414D95
; ---------------------------------------------------------------------------

loc_414D8B:				; CODE XREF: .text:00414D83j
		add	dword ptr [ebp-10h], 5
		jmp	short loc_414D95
; ---------------------------------------------------------------------------

loc_414D91:				; CODE XREF: .text:00414D3Dj
					; .text:00414D47j
		add	dword ptr [ebp-10h], 1

loc_414D95:				; CODE XREF: .text:00414D89j
					; .text:00414D8Fj
		sub	dword ptr [ebp+0Ch], 1
		add	dword ptr [ebp-0Ch], 1

loc_414D9D:				; CODE XREF: .text:00414D12j
		cmp	dword ptr [ebp+0Ch], 0
		jnz	loc_414D17
		mov	eax, [ebp-1Ch]
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-18h]
		mov	[ebp+0Ch], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	sub_404CD4
		mov	[ebp-20h], eax
		mov	eax, [ebp-20h]
		mov	[ebp-14h], eax
		jmp	loc_414EDA
; ---------------------------------------------------------------------------

loc_414DCC:				; CODE XREF: .text:00414EDEj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_414E06
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_414E06
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+10h]
		jz	short loc_414E06
		cmp	dword ptr [ebp+10h], 0
		jz	loc_414EC1
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_414EC1

loc_414E06:				; CODE XREF: .text:00414DD4j
					; .text:00414DDEj ...
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	5Ch
		add	dword ptr [ebp-14h], 1
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ah
		jnz	short loc_414E29
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	6Eh
		add	dword ptr [ebp-14h], 1
		jmp	loc_414ED2
; ---------------------------------------------------------------------------

loc_414E29:				; CODE XREF: .text:00414E18j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Dh
		jnz	short loc_414E42
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	72h
		add	dword ptr [ebp-14h], 1
		jmp	loc_414ED2
; ---------------------------------------------------------------------------

loc_414E42:				; CODE XREF: .text:00414E31j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Ch
		jnz	short loc_414E58
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	66h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_414ED2
; ---------------------------------------------------------------------------

loc_414E58:				; CODE XREF: .text:00414E4Aj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 0Bh
		jnz	short loc_414E6E
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	76h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_414ED2
; ---------------------------------------------------------------------------

loc_414E6E:				; CODE XREF: .text:00414E60j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		cmp	al, 8
		jnz	short loc_414E84
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	62h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_414ED2
; ---------------------------------------------------------------------------

loc_414E84:				; CODE XREF: .text:00414E76j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_414E9A
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	30h
		add	dword ptr [ebp-14h], 1
		jmp	short loc_414ED2
; ---------------------------------------------------------------------------

loc_414E9A:				; CODE XREF: .text:00414E8Cj
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_0 ; "x%02x"
		mov	[esp+8], edx
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		call	sprintf
		add	dword ptr [ebp-14h], 3
		jmp	short loc_414ED2
; ---------------------------------------------------------------------------

loc_414EC1:				; CODE XREF: .text:00414DF2j
					; .text:00414E00j
		mov	eax, [ebp-0Ch]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp-14h]
		mov	[eax], dl
		add	dword ptr [ebp-14h], 1

loc_414ED2:				; CODE XREF: .text:00414E24j
					; .text:00414E3Dj ...
		sub	dword ptr [ebp+0Ch], 1
		add	dword ptr [ebp-0Ch], 1

loc_414EDA:				; CODE XREF: .text:00414DC7j
		cmp	dword ptr [ebp+0Ch], 0
		jnz	loc_414DCC
		mov	eax, [ebp-14h]
		mov	byte ptr [eax],	0
		mov	eax, [ebp-20h]
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	dword ptr [ebp-4], 0
		jmp	short loc_414F1B
; ---------------------------------------------------------------------------

loc_414EFE:				; CODE XREF: .text:00414F23j
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0C0h
		cmp	eax, 80h
		jz	short loc_414F17
		add	dword ptr [ebp-4], 1

loc_414F17:				; CODE XREF: .text:00414F11j
		add	dword ptr [ebp+8], 1

loc_414F1B:				; CODE XREF: .text:00414EFCj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_414EFE
		mov	eax, [ebp-4]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_414F2A(DWORD)
sub_414F2A	proc near		; CODE XREF: sub_401EBC+79p
					; sub_401EBC+CCp ...

dwFlags		= dword	ptr -28h
lpSource	= dword	ptr -24h
dwMessageId	= dword	ptr -20h
dwLanguageId	= dword	ptr -1Ch
lpBuffer	= dword	ptr -18h
nSize		= dword	ptr -14h
Arguments	= dword	ptr -10h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0FFFFFFFFh
		jnz	short loc_414F40
		mov	eax, ds:GetLastError
		call	eax ; GetLastError
		mov	[ebp+arg_0], eax

loc_414F40:				; CODE XREF: sub_414F2A+Aj
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Arguments], 0 ; Arguments
		mov	[esp+28h+nSize], 0FFh ;	nSize
		mov	[esp+28h+lpBuffer], offset Buffer ; lpBuffer
		mov	[esp+28h+dwLanguageId],	400h ; dwLanguageId
		mov	[esp+28h+dwMessageId], eax ; dwMessageId
		mov	[esp+28h+lpSource], 0 ;	lpSource
		mov	[esp+28h+dwFlags], 1000h ; dwFlags
		mov	eax, ds:FormatMessageA
		call	eax ; FormatMessageA
		sub	esp, 1Ch
		mov	eax, offset Buffer
		leave
		retn
sub_414F2A	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 40h
		jle	short loc_414F9D
		cmp	dword ptr [ebp+8], 5Ah
		jg	short loc_414F9D
		mov	eax, 1
		jmp	short loc_414FA2
; ---------------------------------------------------------------------------

loc_414F9D:				; CODE XREF: .text:00414F8Ej
					; .text:00414F94j
		mov	eax, 0

loc_414FA2:				; CODE XREF: .text:00414F9Bj
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		cmp	dword ptr [ebp+8], 60h
		jle	short loc_414FBA
		cmp	dword ptr [ebp+8], 7Ah
		jg	short loc_414FBA
		mov	eax, 1
		jmp	short loc_414FBF
; ---------------------------------------------------------------------------

loc_414FBA:				; CODE XREF: .text:00414FABj
					; .text:00414FB1j
		mov	eax, 0

loc_414FBF:				; CODE XREF: .text:00414FB8j
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414FC1	proc near		; CODE XREF: .text:00413F0Ep
					; .text:00413F21p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 60h
		jle	short loc_414FD4
		cmp	[ebp+arg_0], 7Ah
		jg	short loc_414FD4
		and	[ebp+arg_0], 0FFFFFFDFh

loc_414FD4:				; CODE XREF: sub_414FC1+7j
					; sub_414FC1+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_414FC1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414FD9	proc near		; CODE XREF: .text:004150DEp
					; .text:004150F2p

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_0], 40h
		jle	short loc_414FEC
		cmp	[ebp+arg_0], 5Ah
		jg	short loc_414FEC
		or	[ebp+arg_0], 20h

loc_414FEC:				; CODE XREF: sub_414FD9+7j
					; sub_414FD9+Dj
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_414FD9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_414FF1	proc near		; CODE XREF: sub_41596B+187p
					; sub_41596B+19Ep ...

var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 4
		mov	eax, [ebp+arg_0]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_41504C
		mov	eax, 0
		jmp	loc_4150A5
; ---------------------------------------------------------------------------

loc_41500A:				; CODE XREF: sub_414FF1+6Ej
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_415042
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_414FC1
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_414FC1
		cmp	ebx, eax
		jnz	short loc_415063

loc_415042:				; CODE XREF: sub_414FF1+27j
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1
		jmp	short loc_41504D
; ---------------------------------------------------------------------------

loc_41504C:				; CODE XREF: sub_414FF1+Dj
		nop

loc_41504D:				; CODE XREF: sub_414FF1+59j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_415064
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41500A
		jmp	short loc_415064
; ---------------------------------------------------------------------------

loc_415063:				; CODE XREF: sub_414FF1+4Fj
		nop

loc_415064:				; CODE XREF: sub_414FF1+64j
					; sub_414FF1+70j
		mov	eax, [ebp+arg_0]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4150A0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_414FC1
		mov	ebx, eax
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+8+var_8], eax
		call	sub_414FC1
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_4150A5
; ---------------------------------------------------------------------------

loc_4150A0:				; CODE XREF: sub_414FF1+81j
		mov	eax, 0

loc_4150A5:				; CODE XREF: sub_414FF1+14j
					; sub_414FF1+ADj
		add	esp, 4
		pop	ebx
		pop	ebp
		retn
sub_414FF1	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+0Ch]
		mov	[ebp-8], eax
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jz	short loc_4150CB
		cmp	dword ptr [ebp+10h], 0
		jnz	short loc_4150D2

loc_4150CB:				; CODE XREF: .text:004150C3j
		mov	eax, 0
		jmp	short locret_415129
; ---------------------------------------------------------------------------

loc_4150D2:				; CODE XREF: .text:004150C9j
					; .text:00415119j
		mov	eax, [ebp-4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_414FD9
		mov	[ebp-9], al
		mov	eax, [ebp-8]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		mov	[esp], eax
		call	sub_414FD9
		mov	[ebp-0Ah], al
		sub	dword ptr [ebp+10h], 1
		cmp	dword ptr [ebp+10h], 0
		jz	short loc_41511B
		cmp	byte ptr [ebp-9], 0
		jz	short loc_41511B
		add	dword ptr [ebp-4], 1
		add	dword ptr [ebp-8], 1
		movzx	eax, byte ptr [ebp-9]
		cmp	al, [ebp-0Ah]
		jz	short loc_4150D2

loc_41511B:				; CODE XREF: .text:00415102j
					; .text:00415108j
		movzx	edx, byte ptr [ebp-9]
		movzx	eax, byte ptr [ebp-0Ah]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx

locret_415129:				; CODE XREF: .text:004150D0j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41512B	proc near		; CODE XREF: .text:004152ACp
					; sub_41596B+14Ap

var_18		= dword	ptr -18h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ebx
		sub	esp, 14h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C], eax
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_C]
		jnz	loc_4151DB
		mov	eax, 0
		jmp	loc_4151EA
; ---------------------------------------------------------------------------

loc_415154:				; CODE XREF: sub_41512B+B4j
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4151CF
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_414FC1
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_414FC1
		cmp	ebx, eax
		jz	short loc_4151CF
		mov	eax, [ebp+var_8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_4151C8
		mov	eax, [ebp+var_8]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_414FC1
		mov	ebx, eax
		mov	eax, [ebp+var_C]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+18h+var_18], eax
		call	sub_414FC1
		mov	edx, ebx
		sub	edx, eax
		mov	eax, edx
		jmp	short loc_4151CD
; ---------------------------------------------------------------------------

loc_4151C8:				; CODE XREF: sub_41512B+6Fj
		mov	eax, 0

loc_4151CD:				; CODE XREF: sub_41512B+9Bj
		jmp	short loc_4151EA
; ---------------------------------------------------------------------------

loc_4151CF:				; CODE XREF: sub_41512B+37j
					; sub_41512B+5Fj
		sub	[ebp+arg_8], 1
		add	[ebp+var_8], 1
		add	[ebp+var_C], 1

loc_4151DB:				; CODE XREF: sub_41512B+19j
		cmp	[ebp+arg_8], 0
		jnz	loc_415154
		mov	eax, 0

loc_4151EA:				; CODE XREF: sub_41512B+24j
					; sub_41512B:loc_4151CDj
		add	esp, 14h
		pop	ebx
		pop	ebp
		retn
sub_41512B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+8]
		cmp	eax, [ebp+0Ch]
		jnz	short loc_41521C
		mov	eax, 0
		jmp	short loc_415263
; ---------------------------------------------------------------------------

loc_415202:				; CODE XREF: .text:0041522Fj
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jnz	short loc_415233
		add	dword ptr [ebp+8], 1
		add	dword ptr [ebp+0Ch], 1
		jmp	short loc_41521D
; ---------------------------------------------------------------------------

loc_41521C:				; CODE XREF: .text:004151F9j
		nop

loc_41521D:				; CODE XREF: .text:0041521Aj
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_415234
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_415202
		jmp	short loc_415234
; ---------------------------------------------------------------------------

loc_415233:				; CODE XREF: .text:00415210j
		nop

loc_415234:				; CODE XREF: .text:00415225j
					; .text:00415231j
		mov	eax, [ebp+8]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		cmp	dl, al
		jz	short loc_41525E
		mov	eax, [ebp+8]
		movzx	eax, byte ptr [eax]
		movsx	edx, al
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		jmp	short loc_415263
; ---------------------------------------------------------------------------

loc_41525E:				; CODE XREF: .text:00415242j
		mov	eax, 0

loc_415263:				; CODE XREF: .text:00415200j
					; .text:0041525Cj
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		cmp	dword ptr [ebp+14h], 0
		jnz	short loc_415276
		mov	eax, [ebp+8]
		jmp	short locret_4152CB
; ---------------------------------------------------------------------------

loc_415276:				; CODE XREF: .text:0041526Fj
		mov	eax, [ebp+14h]
		cmp	eax, [ebp+0Ch]
		ja	short loc_4152C6
		mov	eax, [ebp+8]
		mov	[ebp-4], eax
		mov	eax, [ebp+14h]
		mov	edx, [ebp+0Ch]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, [ebp-4]
		mov	[ebp-8], eax
		jmp	short loc_4152BE
; ---------------------------------------------------------------------------

loc_415298:				; CODE XREF: .text:004152C4j
		mov	eax, [ebp+14h]
		mov	[esp+8], eax
		mov	eax, [ebp+10h]
		mov	[esp+4], eax
		mov	eax, [ebp-4]
		mov	[esp], eax
		call	sub_41512B
		test	eax, eax
		jnz	short loc_4152BA
		mov	eax, [ebp-4]
		jmp	short locret_4152CB
; ---------------------------------------------------------------------------

loc_4152BA:				; CODE XREF: .text:004152B3j
		add	dword ptr [ebp-4], 1

loc_4152BE:				; CODE XREF: .text:00415296j
		mov	eax, [ebp-4]
		cmp	eax, [ebp-8]
		jbe	short loc_415298

loc_4152C6:				; CODE XREF: .text:0041527Cj
		mov	eax, 0

locret_4152CB:				; CODE XREF: .text:00415274j
					; .text:004152B8j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4152CD	proc near		; CODE XREF: sub_402192+B0p
					; sub_402302+13Fp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		jmp	short loc_4152E5
; ---------------------------------------------------------------------------

loc_4152D2:				; CODE XREF: sub_4152CD+20j
		mov	eax, [ebp+arg_4]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], dl
		add	[ebp+arg_0], 1
		add	[ebp+arg_4], 1

loc_4152E5:				; CODE XREF: sub_4152CD+3j
		mov	eax, [ebp+arg_4]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_4152D2
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn
sub_4152CD	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+8]
		mov	eax, [eax]
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0
		jnz	short loc_415318
		mov	eax, 0
		jmp	locret_4153C3
; ---------------------------------------------------------------------------

loc_415318:				; CODE XREF: .text:0041530Cj
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_41532F
		mov	eax, [ebp+0Ch]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_415388

loc_41532F:				; CODE XREF: .text:00415320j
		mov	eax, [ebp+0Ch]
		movzx	eax, byte ptr [eax]
		mov	[ebp-11h], al
		cmp	byte ptr [ebp-11h], 0
		jnz	short loc_415347
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_41539D
; ---------------------------------------------------------------------------

loc_415347:				; CODE XREF: .text:0041533Cj
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		cmp	al, [ebp-11h]
		jnz	short loc_41535A
		mov	eax, [ebp-10h]
		mov	[ebp-0Ch], eax
		jmp	short loc_41539D
; ---------------------------------------------------------------------------

loc_41535A:				; CODE XREF: .text:00415350j
		mov	eax, [ebp-10h]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_41536D
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_41539D
; ---------------------------------------------------------------------------

loc_41536D:				; CODE XREF: .text:00415362j
		movsx	eax, byte ptr [ebp-11h]
		mov	edx, [ebp-10h]
		add	edx, 1
		mov	[esp+4], eax
		mov	[esp], edx
		call	strchr
		mov	[ebp-0Ch], eax
		jmp	short loc_41539D
; ---------------------------------------------------------------------------

loc_415388:				; CODE XREF: .text:0041532Dj
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		call	strpbrk
		mov	[ebp-0Ch], eax

loc_41539D:				; CODE XREF: .text:00415345j
					; .text:00415358j ...
		cmp	dword ptr [ebp-0Ch], 0
		jz	short loc_4153B7
		mov	eax, [ebp-0Ch]
		mov	byte ptr [eax],	0
		add	dword ptr [ebp-0Ch], 1
		mov	eax, [ebp+8]
		mov	edx, [ebp-0Ch]
		mov	[eax], edx
		jmp	short loc_4153C0
; ---------------------------------------------------------------------------

loc_4153B7:				; CODE XREF: .text:004153A1j
		mov	eax, [ebp+8]
		mov	dword ptr [eax], 0

loc_4153C0:				; CODE XREF: .text:004153B5j
		mov	eax, [ebp-10h]

locret_4153C3:				; CODE XREF: .text:00415313j
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4153C5	proc near		; CODE XREF: sub_4071DE+30p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_8]
		add	[ebp+var_4], eax
		jmp	short loc_4153F4
; ---------------------------------------------------------------------------

loc_4153D9:				; CODE XREF: sub_4153C5+33j
		sub	[ebp+var_4], 1
		mov	eax, [ebp+var_4]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_4]
		jnz	short loc_4153F0
		mov	eax, [ebp+var_4]
		jmp	short locret_4153FF
; ---------------------------------------------------------------------------

loc_4153F0:				; CODE XREF: sub_4153C5+24j
		sub	[ebp+arg_8], 1

loc_4153F4:				; CODE XREF: sub_4153C5+12j
		cmp	[ebp+arg_8], 0
		jnz	short loc_4153D9
		mov	eax, 0

locret_4153FF:				; CODE XREF: sub_4153C5+29j
		leave
		retn
sub_4153C5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_415401(int, char *, int)
sub_415401	proc near		; CODE XREF: .text:00415631p
					; .text:00415653p

Str		= dword	ptr -28h
Val		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_415417
		mov	eax, 0
		jmp	locret_415614
; ---------------------------------------------------------------------------

loc_415417:				; CODE XREF: sub_415401+Aj
		mov	[ebp+var_10], 0
		mov	eax, [ebp+var_10]
		mov	[ebp+var_C], eax
		jmp	short loc_41546D
; ---------------------------------------------------------------------------

loc_415426:				; CODE XREF: sub_415401+77j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jz	short loc_415465
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jz	short loc_415465
		cmp	[ebp+arg_4], 0
		jz	short loc_415469
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	short loc_415469

loc_415465:				; CODE XREF: sub_415401+30j
					; sub_415401+3Dj
		add	[ebp+var_10], 1

loc_415469:				; CODE XREF: sub_415401+43j
					; sub_415401+62j
		add	[ebp+var_C], 1

loc_41546D:				; CODE XREF: sub_415401+23j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_415426
		cmp	[ebp+arg_8], 0
		jz	short loc_415498
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+Str], eax ; size_t
		call	sub_404CD4
		mov	[ebp+var_14], eax
		jmp	short loc_4154BE
; ---------------------------------------------------------------------------

loc_415498:				; CODE XREF: sub_415401+7Dj
		mov	eax, [ebp+var_10]
		add	eax, eax
		add	eax, [ebp+var_C]
		add	eax, 1
		mov	[esp+28h+Str], eax ; size_t
		call	sub_404CAE
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jnz	short loc_4154BE
		mov	eax, 0
		jmp	locret_415614
; ---------------------------------------------------------------------------

loc_4154BE:				; CODE XREF: sub_415401+95j
					; sub_415401+B1j
		mov	[ebp+var_C], 0
		jmp	loc_4155FA
; ---------------------------------------------------------------------------

loc_4154CA:				; CODE XREF: sub_415401+201j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 3Ah
		jnz	short loc_415500
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	33h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	61h
		add	[ebp+var_C], 1
		jmp	loc_4155F6
; ---------------------------------------------------------------------------

loc_415500:				; CODE XREF: sub_415401+D1j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 25h
		jnz	short loc_415536
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	32h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	35h
		add	[ebp+var_C], 1
		jmp	loc_4155F6
; ---------------------------------------------------------------------------

loc_415536:				; CODE XREF: sub_415401+107j
		cmp	[ebp+arg_4], 0
		jz	loc_4155E4
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		mov	[esp+28h+Val], eax ; Val
		mov	eax, [ebp+arg_4]
		mov	[esp+28h+Str], eax ; Str
		call	strchr
		test	eax, eax
		jz	loc_4155E4
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	25h
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		sar	al, 4
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_415597
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 30h
		jmp	short loc_4155A3
; ---------------------------------------------------------------------------

loc_415597:				; CODE XREF: sub_415401+186j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		shr	al, 4
		add	eax, 57h

loc_4155A3:				; CODE XREF: sub_415401+194j
		mov	[edx], al
		add	[ebp+var_C], 1
		mov	eax, [ebp+var_C]
		mov	edx, eax
		add	edx, [ebp+var_14]
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		movsx	eax, al
		and	eax, 0Fh
		cmp	eax, 9
		jg	short loc_4155D0
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 30h
		jmp	short loc_4155DC
; ---------------------------------------------------------------------------

loc_4155D0:				; CODE XREF: sub_415401+1BFj
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		and	eax, 0Fh
		add	eax, 57h

loc_4155DC:				; CODE XREF: sub_415401+1CDj
		mov	[edx], al
		add	[ebp+var_C], 1
		jmp	short loc_4155F6
; ---------------------------------------------------------------------------

loc_4155E4:				; CODE XREF: sub_415401+139j
					; sub_415401+159j
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	edx, [ebp+arg_0]
		movzx	edx, byte ptr [edx]
		mov	[eax], dl
		add	[ebp+var_C], 1

loc_4155F6:				; CODE XREF: sub_415401+FAj
					; sub_415401+130j ...
		add	[ebp+arg_0], 1

loc_4155FA:				; CODE XREF: sub_415401+C4j
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4154CA
		mov	eax, [ebp+var_C]
		add	eax, [ebp+var_14]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_14]

locret_415614:				; CODE XREF: sub_415401+11j
					; sub_415401+B8j
		leave
		retn
sub_415401	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 1
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_415401
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	dword ptr [esp+8], 0
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_415401
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41565A	proc near		; CODE XREF: sub_415777+32p
					; sub_4157B6+32p

var_F8		= dword	ptr -0F8h
var_F4		= dword	ptr -0F4h
var_DC		= dword	ptr -0DCh
var_D8		= dword	ptr -0D8h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 0F4h
		mov	[ebp+var_C], 0
		mov	eax, [ebp+var_C]
		mov	edx, [ebp+arg_0]
		mov	[ebp+eax*4+var_D8], edx
		add	[ebp+var_C], 1
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_DC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_DC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_10], eax
		jmp	short loc_4156F3
; ---------------------------------------------------------------------------

loc_4156A6:				; CODE XREF: sub_41565A+BAj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		mov	[ebp+var_DC], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_DC]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	[ebp+var_10], eax
		cmp	[ebp+var_C], 2Eh
		jbe	short loc_4156EF
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	dword ptr [eax], 16h
		mov	eax, 0
		jmp	short loc_41576E
; ---------------------------------------------------------------------------

loc_4156EF:				; CODE XREF: sub_41565A+7Fj
		add	[ebp+var_C], 1

loc_4156F3:				; CODE XREF: sub_41565A+4Aj
		mov	eax, [ebp+arg_4]
		lea	edx, [eax+4]
		mov	[ebp+arg_4], edx
		mov	edx, [eax]
		mov	eax, [ebp+var_C]
		mov	[ebp+eax*4+var_D8], edx
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		test	eax, eax
		jnz	short loc_4156A6
		add	[ebp+var_10], 1
		mov	eax, [ebp+var_10]
		mov	[esp+0F8h+var_F8], eax ; size_t
		call	sub_404CAE
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0
		jz	short loc_41576B
		mov	eax, [ebp+var_18]
		mov	[ebp+var_14], eax
		mov	[ebp+var_C], 0
		jmp	short loc_41575D
; ---------------------------------------------------------------------------

loc_41573D:				; CODE XREF: sub_41565A+10Fj
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		mov	[esp+0F8h+var_F4], eax
		mov	eax, [ebp+var_14]
		mov	[esp+0F8h+var_F8], eax
		call	sub_4152CD
		mov	[ebp+var_14], eax
		add	[ebp+var_C], 1

loc_41575D:				; CODE XREF: sub_41565A+E1j
		mov	eax, [ebp+var_C]
		mov	eax, [ebp+eax*4+var_D8]
		test	eax, eax
		jnz	short loc_41573D

loc_41576B:				; CODE XREF: sub_41565A+D2j
		mov	eax, [ebp+var_18]

loc_41576E:				; CODE XREF: sub_41565A+93j
		add	esp, 0F4h
		pop	edi
		pop	ebp
		retn
sub_41565A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415777	proc near		; CODE XREF: sub_4037A4+33p
					; sub_403A04+4Cp

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_415794
		mov	[esp+28h+var_28], offset word_41C84E ; char *
		call	sub_404CF8
		mov	[ebp+var_C], eax
		jmp	short loc_4157B1
; ---------------------------------------------------------------------------

loc_415794:				; CODE XREF: sub_415777+Aj
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+var_28], eax
		call	sub_41565A
		mov	[ebp+var_C], eax

loc_4157B1:				; CODE XREF: sub_415777+1Bj
		mov	eax, [ebp+var_C]
		leave
		retn
sub_415777	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4157B6	proc near		; CODE XREF: sub_40BC73+3Fp
					; sub_40BE8D+1Ep ...

Str		= dword	ptr -28h
Size		= dword	ptr -24h
Count		= dword	ptr -20h
File		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		cmp	[ebp+arg_0], 0
		jnz	short loc_4157D3
		mov	[esp+28h+Str], offset word_41C84E ; char *
		call	sub_404DD7
		mov	[ebp+var_C], eax
		jmp	short loc_4157F0
; ---------------------------------------------------------------------------

loc_4157D3:				; CODE XREF: sub_4157B6+Aj
		lea	edx, [ebp+arg_4]
		lea	eax, [ebp+var_10]
		mov	[eax], edx
		mov	eax, [ebp+var_10]
		mov	[esp+28h+Size],	eax
		mov	eax, [ebp+arg_0]
		mov	[esp+28h+Str], eax
		call	sub_41565A
		mov	[ebp+var_C], eax

loc_4157F0:				; CODE XREF: sub_4157B6+1Bj
		cmp	[ebp+var_C], 0
		jnz	short loc_415864
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_41582F
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aFatalTooManyAr ; "\nfatal:	too many args for xstrconcat\n"
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 25h ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite
		jmp	short loc_415858
; ---------------------------------------------------------------------------

loc_41582F:				; CODE XREF: sub_4157B6+4Cj
		mov	eax, ds:_iob
		lea	edx, [eax+40h]
		mov	eax, offset aFatalOutOfMemo ; "\nfatal:	out of memory\n"
		mov	[esp+28h+File],	edx ; File
		mov	[esp+28h+Count], 16h ; Count
		mov	[esp+28h+Size],	1 ; Size
		mov	[esp+28h+Str], eax ; Str
		call	fwrite

loc_415858:				; CODE XREF: sub_4157B6+77j
		mov	[esp+28h+Str], 2 ; Code
		call	exit
; ---------------------------------------------------------------------------

loc_415864:				; CODE XREF: sub_4157B6+3Ej
		mov	eax, [ebp+var_C]
		leave
		retn
sub_4157B6	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41586C	proc near		; CODE XREF: sub_41596B+27Bp
					; sub_41596B+2C4p ...

var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		cmp	eax, 16h
		jnz	short loc_415901
		cmp	[ebp+arg_0], 0
		jz	short loc_4158C5
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aUtf8 ; "utf-8"
		mov	ecx, 6
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4158C5
		mov	eax, ds:dword_41D510
		mov	[ebp+var_1C], eax
		mov	ds:dword_41D510, 1
		jmp	short loc_4158D7
; ---------------------------------------------------------------------------

loc_4158C5:				; CODE XREF: sub_41586C+1Bj
					; sub_41586C+43j
		mov	eax, ds:dword_41D514
		mov	[ebp+var_1C], eax
		mov	ds:dword_41D514, 1

loc_4158D7:				; CODE XREF: sub_41586C+57j
		cmp	[ebp+var_1C], 0
		jnz	short loc_41593F
		mov	[esp+38h+var_38], offset aConversionFrom ; "conversion from `%s' to `%s' not availa"...
		call	sub_411114
		mov	edx, [ebp+arg_0]
		mov	[esp+38h+var_30], edx
		mov	edx, dword ptr [ebp+arg_4]
		mov	dword ptr [esp+38h+var_34], edx	; char
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_4119D3
		jmp	short loc_41593F
; ---------------------------------------------------------------------------

loc_415901:				; CODE XREF: sub_41586C+15j
		mov	eax, ds:dword_41D518
		test	eax, eax
		jnz	short loc_415935
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+38h+var_38], eax ;	int
		call	strerror
		mov	ebx, eax
		mov	[esp+38h+var_38], offset aIconv_openFail ; "iconv_open failed: %s\n"
		call	sub_411114
		mov	dword ptr [esp+38h+var_34], ebx	; char
		mov	[esp+38h+var_38], eax ;	char *
		call	sub_4119D3

loc_415935:				; CODE XREF: sub_41586C+9Cj
		mov	ds:dword_41D518, 1

loc_41593F:				; CODE XREF: sub_41586C+6Fj
					; sub_41586C+93j
		cmp	[ebp+arg_8], 0
		jz	short loc_415963
		mov	off_419180, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_41D4E0, 0
		mov	ds:dword_41D4E4, 0

loc_415963:				; CODE XREF: sub_41586C+D7j
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_41586C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41596B	proc near		; CODE XREF: sub_4054EC+10p

Dest		= dword	ptr -38h
Format		= dword	ptr -34h
var_30		= dword	ptr -30h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
Str2		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		cmp	[ebp+arg_0], 0
		jnz	loc_415A75
		mov	eax, ds:GetConsoleOutputCP
		call	eax ; GetConsoleOutputCP
		mov	[ebp+var_C], eax
		cmp	[ebp+var_C], 0
		jnz	short loc_415996
		mov	eax, ds:GetACP
		call	eax ; GetACP
		mov	[ebp+var_C], eax

loc_415996:				; CODE XREF: sub_41596B+1Fj
		mov	eax, offset aCpU ; "CP%u"
		mov	edx, [ebp+var_C]
		mov	[esp+38h+var_30], edx
		mov	[esp+38h+Format], eax ;	Format
		mov	[esp+38h+Dest],	offset byte_41D4F0 ; Dest
		call	sprintf
		mov	[ebp+arg_0], offset byte_41D4F0
		mov	[ebp+Str2], offset aCp936 ; "CP936"
		jmp	loc_415A67
; ---------------------------------------------------------------------------

loc_4159C5:				; CODE XREF: sub_41596B+104j
		mov	eax, [ebp+Str2]
		mov	[esp+38h+Format], eax ;	Str2
		mov	[esp+38h+Dest],	offset byte_41D4F0 ; Str1
		call	strcmp
		test	eax, eax
		jz	short loc_4159F3
		mov	eax, [ebp+Str2]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Ah
		jnz	short loc_415A1D
		mov	eax, [ebp+Str2]
		add	eax, 1
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_415A1D

loc_4159F3:				; CODE XREF: sub_41596B+6Fj
		mov	eax, [ebp+Str2]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	eax, [ebp+Str2]
		mov	[ebp+arg_0], eax
		jmp	short loc_415A75
; ---------------------------------------------------------------------------

loc_415A1D:				; CODE XREF: sub_41596B+79j
					; sub_41596B+86j
		mov	eax, [ebp+Str2]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp+Str2], eax
		mov	eax, [ebp+Str2]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		add	[ebp+Str2], eax

loc_415A67:				; CODE XREF: sub_41596B+55j
		mov	eax, [ebp+Str2]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	loc_4159C5

loc_415A75:				; CODE XREF: sub_41596B+Bj
					; sub_41596B+B0j
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		cmp	eax, 3
		jbe	short loc_415ADA
		mov	[esp+38h+var_30], 3
		mov	[esp+38h+Format], offset aIso ;	"iso"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_41512B
		test	eax, eax
		jnz	short loc_415ADA
		add	[ebp+arg_0], 3
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 2Dh
		jz	short loc_415AD6
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Fh
		jnz	short loc_415ADA

loc_415AD6:				; CODE XREF: sub_41596B+15Fj
		add	[ebp+arg_0], 1

loc_415ADA:				; CODE XREF: sub_41596B+132j
					; sub_41596B+151j ...
		mov	eax, [ebp+arg_0]
		movzx	eax, byte ptr [eax]
		test	al, al
		jz	short loc_415B40
		mov	[esp+38h+Format], offset a88591	; "8859-1"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_414FF1
		test	eax, eax
		jz	short loc_415B40
		mov	[esp+38h+Format], offset a646 ;	"646"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_414FF1
		test	eax, eax
		jz	short loc_415B40
		mov	[esp+38h+Format], offset aAscii	; "ASCII"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_414FF1
		test	eax, eax
		jz	short loc_415B40
		mov	[esp+38h+Format], offset aAnsi_x3_41968	; "ANSI_X3.4-1968"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_414FF1
		test	eax, eax
		jnz	short loc_415B63

loc_415B40:				; CODE XREF: sub_41596B+177j
					; sub_41596B+18Ej ...
		mov	off_419180, offset aIso88591 ; "iso-8859-1"
		mov	ds:dword_41D4E0, 0
		mov	ds:dword_41D4E4, 0
		jmp	loc_415C62
; ---------------------------------------------------------------------------

loc_415B63:				; CODE XREF: sub_41596B+1D3j
		mov	[esp+38h+Format], offset aUtf8_0 ; "utf8"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_414FF1
		test	eax, eax
		jz	short loc_415B91
		mov	[esp+38h+Format], offset aUtf8 ; "utf-8"
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+Dest],	eax
		call	sub_414FF1
		test	eax, eax
		jnz	short loc_415BB4

loc_415B91:				; CODE XREF: sub_41596B+20Dj
		mov	off_419180, offset aUtf8 ; "utf-8"
		mov	ds:dword_41D4E0, 1
		mov	ds:dword_41D4E4, 0
		jmp	loc_415C62
; ---------------------------------------------------------------------------

loc_415BB4:				; CODE XREF: sub_41596B+224j
		mov	[esp+38h+Format], offset aUtf8 ; "utf-8"
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Dest],	eax
		call	libiconv_open
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_415BF2
		mov	[esp+38h+var_30], 0
		mov	[esp+38h+Format], offset aUtf8 ; "utf-8"
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Dest],	eax
		call	sub_41586C
		mov	eax, 0FFFFFFFFh
		jmp	short loc_415C67
; ---------------------------------------------------------------------------

loc_415BF2:				; CODE XREF: sub_41596B+263j
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dest],	eax
		call	libiconv_close
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Format], eax
		mov	[esp+38h+Dest],	offset aUtf8 ; "utf-8"
		call	libiconv_open
		mov	[ebp+var_18], eax
		cmp	[ebp+var_18], 0FFFFFFFFh
		jnz	short loc_415C3B
		mov	[esp+38h+var_30], 0
		mov	eax, [ebp+var_14]
		mov	[esp+38h+Format], eax
		mov	[esp+38h+Dest],	offset aUtf8 ; "utf-8"
		call	sub_41586C
		mov	eax, 0FFFFFFFFh
		jmp	short loc_415C67
; ---------------------------------------------------------------------------

loc_415C3B:				; CODE XREF: sub_41596B+2ACj
		mov	eax, [ebp+var_18]
		mov	[esp+38h+Dest],	eax
		call	libiconv_close
		mov	eax, [ebp+var_14]
		mov	off_419180, eax
		mov	ds:dword_41D4E0, 0
		mov	ds:dword_41D4E4, 1

loc_415C62:				; CODE XREF: sub_41596B+1F3j
					; sub_41596B+244j
		mov	eax, 0

loc_415C67:				; CODE XREF: sub_41596B+285j
					; sub_41596B+2CEj
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_41596B	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		mov	eax, off_419180
		pop	ebp
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415C77	proc near		; CODE XREF: sub_41344E+43p
		push	ebp
		mov	ebp, esp
		mov	eax, ds:dword_41D4E0
		pop	ebp
		retn
sub_415C77	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_415C81(char *)
sub_415C81	proc near		; CODE XREF: sub_415C81+129p

Dest		= dword	ptr -78h
Source		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_4C		= dword	ptr -4Ch
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 6Ch
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_28], 0
		mov	eax, ds:dword_41D4E0
		test	eax, eax
		jz	short loc_415CB3
		mov	eax, [ebp+arg_0]
		mov	[esp+78h+Dest],	eax ; char *
		call	sub_404DD7
		mov	[ebp+var_20], eax
		jmp	loc_415EC2
; ---------------------------------------------------------------------------

loc_415CB3:				; CODE XREF: sub_415C81+1Dj
		mov	eax, ds:dword_41D4E4
		test	eax, eax
		jnz	loc_415D69
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_415CDE
; ---------------------------------------------------------------------------

loc_415CC8:				; CODE XREF: sub_415C81+65j
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_415CDA
		add	[ebp+var_28], 1

loc_415CDA:				; CODE XREF: sub_415C81+53j
		add	[ebp+var_1C], 1

loc_415CDE:				; CODE XREF: sub_415C81+45j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_415CC8
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[esp+78h+Dest],	eax ; size_t
		call	sub_404CD4
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_415D54
; ---------------------------------------------------------------------------

loc_415D07:				; CODE XREF: sub_415C81+DBj
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_415D41
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		shr	al, 6
		or	eax, 0FFFFFFC0h
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		and	eax, 3Fh
		or	eax, 0FFFFFF80h
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_415D50
; ---------------------------------------------------------------------------

loc_415D41:				; CODE XREF: sub_415C81+8Ej
		mov	eax, [ebp+var_1C]
		movzx	edx, byte ptr [eax]
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_415D50:				; CODE XREF: sub_415C81+BEj
		add	[ebp+var_1C], 1

loc_415D54:				; CODE XREF: sub_415C81+84j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_415D07
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		jmp	loc_415EC2
; ---------------------------------------------------------------------------

loc_415D69:				; CODE XREF: sub_415C81+39j
		mov	eax, off_419180
		mov	[esp+78h+Source], eax
		mov	[esp+78h+Dest],	offset aUtf8 ; "utf-8"
		call	libiconv_open
		mov	[ebp+var_30], eax
		cmp	[ebp+var_30], 0FFFFFFFFh
		jnz	short loc_415DB4
		mov	eax, off_419180
		mov	[esp+78h+var_70], 1
		mov	[esp+78h+Source], eax
		mov	[esp+78h+Dest],	offset aUtf8 ; "utf-8"
		call	sub_41586C
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Dest],	eax ; char *
		call	sub_415C81
		jmp	loc_415EC5
; ---------------------------------------------------------------------------

loc_415DB4:				; CODE XREF: sub_415C81+104j
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_1C], eax
		jmp	short loc_415DD2
; ---------------------------------------------------------------------------

loc_415DBC:				; CODE XREF: sub_415C81+159j
		add	[ebp+var_28], 1
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_415DCE
		add	[ebp+var_28], 5

loc_415DCE:				; CODE XREF: sub_415C81+147j
		add	[ebp+var_1C], 1

loc_415DD2:				; CODE XREF: sub_415C81+139j
		mov	eax, [ebp+var_1C]
		movzx	eax, byte ptr [eax]
		test	al, al
		jnz	short loc_415DBC
		mov	eax, [ebp+var_28]
		add	eax, 1
		mov	[esp+78h+Dest],	eax ; size_t
		call	sub_404CD4
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_34], eax
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_4C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_4C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_28]
		mov	[ebp+var_40], eax
		lea	eax, [ebp+var_40]
		mov	[esp+78h+var_68], eax
		lea	eax, [ebp+var_38]
		mov	[esp+78h+var_6C], eax
		lea	eax, [ebp+var_3C]
		mov	[esp+78h+var_70], eax
		lea	eax, [ebp+var_34]
		mov	[esp+78h+Source], eax
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Dest],	eax
		call	libiconv
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_415EB1
		mov	eax, ds:dword_41D4EC
		test	eax, eax
		jnz	short loc_415E93
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+78h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	esi, off_419180
		mov	[esp+78h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_411114
		mov	[esp+78h+var_6C], ebx
		mov	[esp+78h+var_70], offset aUtf8 ; "utf-8"
		mov	[esp+78h+Source], esi ;	char
		mov	[esp+78h+Dest],	eax ; char *
		call	sub_4119D3

loc_415E93:				; CODE XREF: sub_415C81+1D3j
		mov	ds:dword_41D4EC, 1
		mov	eax, [ebp+var_2C]
		mov	[esp+78h+Source], eax ;	Source
		mov	eax, [ebp+var_20]
		mov	[esp+78h+Dest],	eax ; Dest
		call	strcpy
		jmp	short loc_415EB7
; ---------------------------------------------------------------------------

loc_415EB1:				; CODE XREF: sub_415C81+1CAj
		mov	eax, [ebp+var_38]
		mov	byte ptr [eax],	0

loc_415EB7:				; CODE XREF: sub_415C81+22Ej
		mov	eax, [ebp+var_30]
		mov	[esp+78h+Dest],	eax
		call	libiconv_close

loc_415EC2:				; CODE XREF: sub_415C81+2Dj
					; sub_415C81+E3j
		mov	eax, [ebp+var_20]

loc_415EC5:				; CODE XREF: sub_415C81+12Ej
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_415C81	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_415ECD	proc near		; CODE XREF: sub_415ECD+797p
					; sub_41669F+23p

Dest		= dword	ptr -88h
Format		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
var_78		= dword	ptr -78h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	ebx
		add	esp, 0FFFFFF80h
		mov	[ebp+var_20], 0
		mov	[ebp+var_24], 0
		mov	[ebp+var_28], 0
		mov	[ebp+var_30], 0

loc_415EF1:				; CODE XREF: sub_415ECD+5EDj
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_14]
		mov	[ebp+var_C], eax
		mov	[ebp+var_1C], 0
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_18], eax
		jmp	loc_416493
; ---------------------------------------------------------------------------

loc_415F16:				; CODE XREF: sub_415ECD+5CAj
		cmp	[ebp+var_30], 0
		jz	short loc_415F75
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_415F6E
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	short loc_415F3A
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0FDh
		jbe	short loc_415F6E

loc_415F3A:				; CODE XREF: sub_415ECD+61j
		cmp	[ebp+var_24], 0
		jz	short loc_415F65
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_415F65:				; CODE XREF: sub_415ECD+71j
		add	[ebp+var_1C], 4
		jmp	loc_41648B
; ---------------------------------------------------------------------------

loc_415F6E:				; CODE XREF: sub_415ECD+57j
					; sub_415ECD+6Bj
		mov	[ebp+var_30], 0

loc_415F75:				; CODE XREF: sub_415ECD+4Dj
		cmp	[ebp+var_C], 0
		jnz	loc_4162A8
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		js	loc_416100
		cmp	[ebp+arg_8], 0FFFFFFFFh
		jz	loc_4160E0
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 1Fh
		jbe	short loc_415FD1
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 7Fh
		jz	short loc_415FD1
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, [ebp+arg_8]
		jz	short loc_415FD1
		cmp	[ebp+arg_8], 0
		jz	loc_4160E0
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 5Ch
		jnz	loc_4160E0

loc_415FD1:				; CODE XREF: sub_415ECD+D2j
					; sub_415ECD+DCj ...
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_415FE5
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	5Ch
		add	[ebp+var_24], 1

loc_415FE5:				; CODE XREF: sub_415ECD+10Cj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		cmp	eax, 0Dh	; switch 14 cases
		ja	loc_416096	; jumptable 00415FFE default case
		mov	eax, ds:off_41CA98[eax*4]
		jmp	eax		; switch jump
; ---------------------------------------------------------------------------

loc_416000:				; CODE XREF: sub_415ECD+131j
					; DATA XREF: .rdata:off_41CA98o
		add	[ebp+var_1C], 1	; jumptable 00415FFE case 10
		cmp	[ebp+var_24], 0
		jz	loc_4160C7
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	6Eh
		add	[ebp+var_24], 1
		jmp	loc_4160C7
; ---------------------------------------------------------------------------

loc_41601D:				; CODE XREF: sub_415ECD+131j
					; DATA XREF: .rdata:off_41CA98o
		add	[ebp+var_1C], 1	; jumptable 00415FFE case 13
		cmp	[ebp+var_24], 0
		jz	loc_4160CA
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	72h
		add	[ebp+var_24], 1
		jmp	loc_4160CA
; ---------------------------------------------------------------------------

loc_41603A:				; CODE XREF: sub_415ECD+131j
					; DATA XREF: .rdata:off_41CA98o
		add	[ebp+var_1C], 1	; jumptable 00415FFE case 12
		cmp	[ebp+var_24], 0
		jz	loc_4160CD
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	66h
		add	[ebp+var_24], 1
		jmp	short loc_4160CD
; ---------------------------------------------------------------------------

loc_416054:				; CODE XREF: sub_415ECD+131j
					; DATA XREF: .rdata:off_41CA98o
		add	[ebp+var_1C], 1	; jumptable 00415FFE case 11
		cmp	[ebp+var_24], 0
		jz	short loc_4160D0
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	76h
		add	[ebp+var_24], 1
		jmp	short loc_4160D0
; ---------------------------------------------------------------------------

loc_41606A:				; CODE XREF: sub_415ECD+131j
					; DATA XREF: .rdata:off_41CA98o
		add	[ebp+var_1C], 1	; jumptable 00415FFE case 8
		cmp	[ebp+var_24], 0
		jz	short loc_4160D3
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	62h
		add	[ebp+var_24], 1
		jmp	short loc_4160D3
; ---------------------------------------------------------------------------

loc_416080:				; CODE XREF: sub_415ECD+131j
					; DATA XREF: .rdata:off_41CA98o
		add	[ebp+var_1C], 1	; jumptable 00415FFE case 0
		cmp	[ebp+var_24], 0
		jz	short loc_4160D6
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	30h
		add	[ebp+var_24], 1
		jmp	short loc_4160D6
; ---------------------------------------------------------------------------

loc_416096:				; CODE XREF: sub_415ECD+124j
					; sub_415ECD+131j
					; DATA XREF: ...
		add	[ebp+var_1C], 3	; jumptable 00415FFE default case
		cmp	[ebp+var_24], 0
		jz	short loc_4160D9
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_2 ; "x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 3
		jmp	short loc_4160D9
; ---------------------------------------------------------------------------

loc_4160C7:				; CODE XREF: sub_415ECD+13Bj
					; sub_415ECD+14Bj
		nop
		jmp	short loc_4160DA
; ---------------------------------------------------------------------------

loc_4160CA:				; CODE XREF: sub_415ECD+158j
					; sub_415ECD+168j
		nop
		jmp	short loc_4160DA
; ---------------------------------------------------------------------------

loc_4160CD:				; CODE XREF: sub_415ECD+175j
					; sub_415ECD+185j
		nop
		jmp	short loc_4160DA
; ---------------------------------------------------------------------------

loc_4160D0:				; CODE XREF: sub_415ECD+18Fj
					; sub_415ECD+19Bj
		nop
		jmp	short loc_4160DA
; ---------------------------------------------------------------------------

loc_4160D3:				; CODE XREF: sub_415ECD+1A5j
					; sub_415ECD+1B1j
		nop
		jmp	short loc_4160DA
; ---------------------------------------------------------------------------

loc_4160D6:				; CODE XREF: sub_415ECD+1BBj
					; sub_415ECD+1C7j
		nop
		jmp	short loc_4160DA
; ---------------------------------------------------------------------------

loc_4160D9:				; CODE XREF: sub_415ECD+1D1j
					; sub_415ECD+1F8j
		nop

loc_4160DA:				; CODE XREF: sub_415ECD+1FBj
					; sub_415ECD+1FEj ...
		nop
		jmp	loc_41648B
; ---------------------------------------------------------------------------

loc_4160E0:				; CODE XREF: sub_415ECD+C4j
					; sub_415ECD+F0j ...
		cmp	[ebp+var_24], 0
		jz	short loc_4160F7
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1

loc_4160F7:				; CODE XREF: sub_415ECD+217j
		add	[ebp+var_1C], 1
		jmp	loc_41648B
; ---------------------------------------------------------------------------

loc_416100:				; CODE XREF: sub_415ECD+BAj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0E0h
		cmp	eax, 0C0h
		jnz	short loc_416149
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 1
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_41648B
; ---------------------------------------------------------------------------

loc_416149:				; CODE XREF: sub_415ECD+246j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F0h
		cmp	eax, 0E0h
		jnz	short loc_416192
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0Fh
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 2
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_41648B
; ---------------------------------------------------------------------------

loc_416192:				; CODE XREF: sub_415ECD+28Fj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0F8h
		cmp	eax, 0F0h
		jnz	short loc_4161DB
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 7
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 3
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_41648B
; ---------------------------------------------------------------------------

loc_4161DB:				; CODE XREF: sub_415ECD+2D8j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FCh
		cmp	eax, 0F8h
		jnz	short loc_416224
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 4
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_41648B
; ---------------------------------------------------------------------------

loc_416224:				; CODE XREF: sub_415ECD+321j
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 0FEh
		cmp	eax, 0FCh
		jnz	short loc_41626D
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 1
		mov	[ebp+var_28], eax
		mov	[ebp+var_C], 5
		mov	[ebp+var_14], 0
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		jmp	loc_41648B
; ---------------------------------------------------------------------------

loc_41626D:				; CODE XREF: sub_415ECD+36Aj
		cmp	[ebp+var_24], 0
		jz	short loc_416298
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_416298:				; CODE XREF: sub_415ECD+3A4j
		add	[ebp+var_1C], 4
		mov	[ebp+var_30], 1
		jmp	loc_41648B
; ---------------------------------------------------------------------------

loc_4162A8:				; CODE XREF: sub_415ECD+ACj
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		test	al, al
		jns	short loc_4162C0
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		cmp	al, 0BFh
		jbe	loc_41634E

loc_4162C0:				; CODE XREF: sub_415ECD+3E3j
		cmp	[ebp+var_24], 0
		jz	short loc_416328
		mov	[ebp+var_10], 0
		jmp	short loc_4162FB
; ---------------------------------------------------------------------------

loc_4162CF:				; CODE XREF: sub_415ECD+434j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_4162FB:				; CODE XREF: sub_415ECD+400j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_4162CF
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4

loc_416328:				; CODE XREF: sub_415ECD+3F7j
		mov	eax, [ebp+var_14]
		add	eax, 1
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_C], 0
		mov	[ebp+var_14], 0
		mov	[ebp+var_30], 1
		jmp	loc_41648B
; ---------------------------------------------------------------------------

loc_41634E:				; CODE XREF: sub_415ECD+3EDj
		mov	eax, [ebp+var_18]
		movzx	edx, byte ptr [eax]
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_14]
		mov	[eax], dl
		add	[ebp+var_14], 1
		shl	[ebp+var_28], 6
		mov	eax, [ebp+var_18]
		movzx	eax, byte ptr [eax]
		movzx	eax, al
		and	eax, 3Fh
		or	[ebp+var_28], eax
		sub	[ebp+var_C], 1
		cmp	[ebp+var_C], 0
		jnz	loc_41648B
		mov	eax, ds:dword_41D4E0
		test	eax, eax
		jz	short loc_4163CB
		cmp	[ebp+var_24], 0
		jz	short loc_4163B9
		mov	[ebp+var_10], 0
		jmp	short loc_4163B1
; ---------------------------------------------------------------------------

loc_416399:				; CODE XREF: sub_415ECD+4EAj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_4163B1:				; CODE XREF: sub_415ECD+4CAj
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_416399

loc_4163B9:				; CODE XREF: sub_415ECD+4C1j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	loc_41648B
; ---------------------------------------------------------------------------

loc_4163CB:				; CODE XREF: sub_415ECD+4BBj
		cmp	[ebp+arg_C], 0
		jz	short loc_41640F
		cmp	[ebp+var_24], 0
		jz	short loc_416400
		mov	[ebp+var_10], 0
		jmp	short loc_4163F8
; ---------------------------------------------------------------------------

loc_4163E0:				; CODE XREF: sub_415ECD+531j
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		add	[ebp+var_10], 1

loc_4163F8:				; CODE XREF: sub_415ECD+511j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_4163E0

loc_416400:				; CODE XREF: sub_415ECD+508j
		mov	eax, [ebp+var_14]
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0
		jmp	short loc_41648B
; ---------------------------------------------------------------------------

loc_41640F:				; CODE XREF: sub_415ECD+502j
		cmp	[ebp+var_28], 7Fh
		jbe	short loc_416438
		cmp	[ebp+var_28], 0FFh
		ja	short loc_416438
		add	[ebp+var_1C], 1
		cmp	[ebp+var_24], 0
		jz	short loc_41648B
		mov	eax, [ebp+var_28]
		mov	edx, eax
		mov	eax, [ebp+var_24]
		mov	[eax], dl
		add	[ebp+var_24], 1
		jmp	short loc_41648B
; ---------------------------------------------------------------------------

loc_416438:				; CODE XREF: sub_415ECD+546j
					; sub_415ECD+54Fj
		cmp	[ebp+var_24], 0
		jz	short loc_41647B
		mov	[ebp+var_10], 0
		jmp	short loc_416473
; ---------------------------------------------------------------------------

loc_416447:				; CODE XREF: sub_415ECD+5ACj
		lea	eax, [ebp+var_40]
		add	eax, [ebp+var_10]
		movzx	eax, byte ptr [eax]
		movzx	edx, al
		mov	eax, offset aX02x_1 ; "\\x%02x"
		mov	[esp+88h+var_80], edx
		mov	[esp+88h+Format], eax ;	Format
		mov	eax, [ebp+var_24]
		mov	[esp+88h+Dest],	eax ; Dest
		call	sprintf
		add	[ebp+var_24], 4
		add	[ebp+var_10], 1

loc_416473:				; CODE XREF: sub_415ECD+578j
		mov	eax, [ebp+var_10]
		cmp	eax, [ebp+var_14]
		jl	short loc_416447

loc_41647B:				; CODE XREF: sub_415ECD+56Fj
		mov	eax, [ebp+var_14]
		shl	eax, 2
		add	[ebp+var_1C], eax
		mov	[ebp+var_14], 0

loc_41648B:				; CODE XREF: sub_415ECD+9Cj
					; sub_415ECD+20Ej ...
		add	[ebp+var_18], 1
		sub	[ebp+var_2C], 1

loc_416493:				; CODE XREF: sub_415ECD+44j
		cmp	[ebp+var_2C], 0
		jnz	loc_415F16
		cmp	[ebp+var_20], 0
		jnz	short loc_4164BF
		mov	eax, [ebp+var_1C]
		add	eax, 1
		mov	[esp+88h+Dest],	eax ; size_t
		call	sub_404CD4
		mov	[ebp+var_24], eax
		mov	eax, [ebp+var_24]
		mov	[ebp+var_20], eax
		jmp	loc_415EF1
; ---------------------------------------------------------------------------

loc_4164BF:				; CODE XREF: sub_415ECD+5D4j
		cmp	[ebp+arg_C], 0
		jz	loc_41668F
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, off_419180
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	libiconv_open
		mov	[ebp+var_38], eax
		cmp	[ebp+var_38], 0FFFFFFFFh
		jnz	short loc_416533
		mov	eax, off_419180
		mov	[esp+88h+var_80], 1
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax
		call	sub_41586C
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_404E31
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_41669F
		jmp	loc_416698
; ---------------------------------------------------------------------------

loc_416533:				; CODE XREF: sub_415ECD+61Ej
		mov	edx, [ebp+var_24]
		mov	eax, [ebp+var_20]
		mov	ecx, edx
		sub	ecx, eax
		mov	eax, ecx
		add	eax, 1
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_1C]
		sub	eax, 1
		mov	[ebp+var_4C], eax
		mov	eax, [ebp+var_20]
		mov	[ebp+var_44], eax
		mov	edx, [ebp+var_1C]
		mov	eax, edx
		shl	eax, 2
		add	eax, edx
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_50]
		mov	[ebp+var_5C], eax
		mov	edx, 0CCCCCCCDh
		mov	eax, [ebp+var_5C]
		mul	edx
		mov	eax, edx
		shr	eax, 2
		cmp	eax, [ebp+var_1C]
		jz	short loc_416597
		mov	[esp+88h+var_80], offset aDo_utf8_to_nat ; "do_utf8_to_native"
		mov	[esp+88h+Format], 24Ah
		mov	[esp+88h+Dest],	offset a____Gnupg22__6 ; "../../gnupg2-2.0.30/jnlib/utf8conv.c"
		call	sub_411B8C
; ---------------------------------------------------------------------------

loc_416597:				; CODE XREF: sub_415ECD+6ACj
		mov	eax, [ebp+var_50]
		mov	[esp+88h+Dest],	eax ; size_t
		call	sub_404CD4
		mov	[ebp+var_48], eax
		mov	eax, [ebp+var_48]
		mov	[ebp+var_34], eax
		lea	eax, [ebp+var_50]
		mov	[esp+88h+var_78], eax
		lea	eax, [ebp+var_48]
		mov	[esp+88h+var_7C], eax
		lea	eax, [ebp+var_4C]
		mov	[esp+88h+var_80], eax
		lea	eax, [ebp+var_44]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	libiconv
		cmp	eax, 0FFFFFFFFh
		jnz	loc_41666E
		mov	eax, ds:dword_41D4E8
		test	eax, eax
		jnz	short loc_416621
		mov	eax, ds:_errno
		call	eax ; _errno
		mov	eax, [eax]
		mov	[esp+88h+Dest],	eax ; int
		call	strerror
		mov	ebx, eax
		mov	esi, off_419180
		mov	[esp+88h+Dest],	offset aConversionFr_0 ; "conversion from `%s' to `%s' failed: %s"...
		call	sub_411114
		mov	[esp+88h+var_7C], ebx
		mov	[esp+88h+var_80], esi
		mov	[esp+88h+Format], offset aUtf8 ; "utf-8"
		mov	[esp+88h+Dest],	eax ; char *
		call	sub_4119D3

loc_416621:				; CODE XREF: sub_415ECD+715j
		mov	ds:dword_41D4E8, 1
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_404E31
		mov	[ebp+var_20], 0
		mov	eax, [ebp+var_34]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_404E31
		mov	[esp+88h+var_7C], 0
		mov	eax, [ebp+arg_8]
		mov	[esp+88h+var_80], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+88h+Format], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+88h+Dest],	eax
		call	sub_415ECD
		mov	[ebp+var_34], eax
		jmp	short loc_41667F
; ---------------------------------------------------------------------------

loc_41666E:				; CODE XREF: sub_415ECD+708j
		mov	eax, [ebp+var_48]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]
		mov	[esp+88h+Dest],	eax ; void *
		call	sub_404E31

loc_41667F:				; CODE XREF: sub_415ECD+79Fj
		mov	eax, [ebp+var_38]
		mov	[esp+88h+Dest],	eax
		call	libiconv_close
		mov	eax, [ebp+var_34]
		jmp	short loc_416698
; ---------------------------------------------------------------------------

loc_41668F:				; CODE XREF: sub_415ECD+5F6j
		mov	eax, [ebp+var_24]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+var_20]

loc_416698:				; CODE XREF: sub_415ECD+661j
					; sub_415ECD+7C0j
		sub	esp, 0FFFFFF80h
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_415ECD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_41669F	proc near		; CODE XREF: .text:0040A4CFp
					; sub_414B28+50p ...

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ds:dword_41D4E4
		mov	[esp+18h+var_C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+18h+var_10], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+18h+var_14], eax
		mov	eax, [ebp+arg_0]
		mov	[esp+18h+var_18], eax
		call	sub_415ECD
		leave
		retn
sub_41669F	endp

; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv_open
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+18h]
		mov	[esp+10h], eax
		mov	eax, [ebp+14h]
		mov	[esp+0Ch], eax
		mov	eax, [ebp+10h]
		mov	[esp+8], eax
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv
		leave
		retn
; ---------------------------------------------------------------------------
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	libiconv_close
		leave
		retn
; ---------------------------------------------------------------------------
		align 4
		push	ebp
		mov	ebp, esp
		sub	esp, 0A8h
		mov	eax, [ebp+0Ch]
		mov	[esp+4], eax
		mov	eax, [ebp+8]
		mov	[esp], eax
		call	sub_41474F
		test	eax, eax
		jnz	short loc_416753
		mov	dword ptr [ebp-0Ch], 1
		jmp	loc_41687D
; ---------------------------------------------------------------------------

loc_416753:				; CODE XREF: .text:00416745j
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 3
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+8]
		mov	[esp], eax
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp-10h], eax
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_4167A8
		mov	dword ptr [ebp-0Ch], 0
		jmp	loc_41687D
; ---------------------------------------------------------------------------

loc_4167A8:				; CODE XREF: .text:0041679Aj
		mov	dword ptr [esp+18h], 0
		mov	dword ptr [esp+14h], 0
		mov	dword ptr [esp+10h], 3
		mov	dword ptr [esp+0Ch], 0
		mov	dword ptr [esp+8], 0
		mov	dword ptr [esp+4], 0
		mov	eax, [ebp+0Ch]
		mov	[esp], eax
		mov	eax, ds:CreateFileA
		call	eax ; CreateFileA
		sub	esp, 1Ch
		mov	[ebp-14h], eax
		cmp	dword ptr [ebp-10h], 0FFFFFFFFh
		jnz	short loc_4167FA
		mov	dword ptr [ebp-0Ch], 0
		jmp	short loc_41686D
; ---------------------------------------------------------------------------

loc_4167FA:				; CODE XREF: .text:004167EFj
		lea	eax, [ebp-7Ch]
		mov	[esp+4], eax
		mov	eax, [ebp-10h]
		mov	[esp], eax
		mov	eax, ds:GetFileInformationByHandle
		call	eax ; GetFileInformationByHandle
		sub	esp, 8
		test	eax, eax
		jz	short loc_416855
		lea	eax, [ebp-48h]
		mov	[esp+4], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		mov	eax, ds:GetFileInformationByHandle
		call	eax ; GetFileInformationByHandle
		sub	esp, 8
		test	eax, eax
		jz	short loc_416855
		mov	edx, [ebp-60h]
		mov	eax, [ebp-2Ch]
		cmp	edx, eax
		jnz	short loc_416855
		mov	edx, [ebp-50h]
		mov	eax, [ebp-1Ch]
		cmp	edx, eax
		jnz	short loc_416855
		mov	edx, [ebp-4Ch]
		mov	eax, [ebp-18h]
		cmp	edx, eax
		jnz	short loc_416855
		mov	eax, 1
		jmp	short loc_41685A
; ---------------------------------------------------------------------------

loc_416855:				; CODE XREF: .text:00416813j
					; .text:0041682Ej ...
		mov	eax, 0

loc_41685A:				; CODE XREF: .text:00416853j
		mov	[ebp-0Ch], eax
		mov	eax, [ebp-14h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_41686D:				; CODE XREF: .text:004167F8j
		mov	eax, [ebp-10h]
		mov	[esp], eax
		mov	eax, ds:CloseHandle
		call	eax ; CloseHandle
		sub	esp, 4

loc_41687D:				; CODE XREF: .text:0041674Ej
					; .text:004167A3j
		mov	eax, [ebp-0Ch]
		leave
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416882	proc near		; CODE XREF: .text:0040AC58p

VarName		= dword	ptr -38h
Source		= dword	ptr -34h
var_1C		= dword	ptr -1Ch
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 34h
		mov	[esp+38h+VarName], offset aTz ;	"TZ"
		call	getenv
		mov	[ebp+var_C], eax
		mov	[esp+38h+VarName], offset EnvString ; "TZ=UTC"
		call	_putenv
		call	_tzset
		mov	eax, [ebp+arg_0]
		mov	[esp+38h+VarName], eax
		call	sub_4186A0
		mov	[ebp+var_10], eax
		cmp	[ebp+var_C], 0
		jz	short loc_416938
		mov	eax, ds:dword_41D51C
		test	eax, eax
		jnz	short loc_416920
		mov	eax, [ebp+var_C]
		mov	[ebp+var_1C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_1C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 4
		mov	[esp+38h+VarName], eax ; Size
		call	malloc
		mov	ds:dword_41D51C, eax
		mov	eax, ds:dword_41D51C
		test	eax, eax
		jz	short loc_416920
		mov	edx, offset aTz_0 ; "TZ="
		mov	eax, ds:dword_41D51C
		mov	edx, [edx]
		mov	[eax], edx
		mov	edx, [ebp+var_C]
		mov	eax, ds:dword_41D51C
		mov	[esp+38h+Source], edx ;	Source
		mov	[esp+38h+VarName], eax ; Dest
		call	strcat

loc_416920:				; CODE XREF: sub_416882+42j
					; sub_416882+7Aj
		mov	eax, ds:dword_41D51C
		test	eax, eax
		jz	short loc_416944
		mov	eax, ds:dword_41D51C
		mov	[esp+38h+VarName], eax ; EnvString
		call	_putenv
		jmp	short loc_416944
; ---------------------------------------------------------------------------

loc_416938:				; CODE XREF: sub_416882+39j
		mov	[esp+38h+VarName], offset aTz ;	"TZ"
		call	_putenv

loc_416944:				; CODE XREF: sub_416882+A5j
					; sub_416882+B4j
		call	_tzset
		mov	eax, [ebp+var_10]
		add	esp, 34h
		pop	edi
		pop	ebp
		retn
sub_416882	endp

; ---------------------------------------------------------------------------
		align 4

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_416954	proc near		; CODE XREF: sub_416AAE+14p

var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		sub	esp, 10h
		cmp	[ebp+arg_0], 0
		jnz	short loc_41696E
		mov	[ebp+var_C], 80000001h
		jmp	loc_416AA4
; ---------------------------------------------------------------------------

loc_41696E:				; CODE XREF: sub_416954+Cj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_classes_r ; "HKEY_CLASSES_ROOT"
		mov	ecx, 12h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4169A2
		mov	[ebp+var_C], 80000000h
		jmp	loc_416AA4
; ---------------------------------------------------------------------------

loc_4169A2:				; CODE XREF: sub_416954+40j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_current_u ; "HKEY_CURRENT_USER"
		mov	ecx, 12h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_4169D6
		mov	[ebp+var_C], 80000001h
		jmp	loc_416AA4
; ---------------------------------------------------------------------------

loc_4169D6:				; CODE XREF: sub_416954+74j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_local_mac ; "HKEY_LOCAL_MACHINE"
		mov	ecx, 13h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_416A0A
		mov	[ebp+var_C], 80000002h
		jmp	loc_416AA4
; ---------------------------------------------------------------------------

loc_416A0A:				; CODE XREF: sub_416954+A8j
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_users	; "HKEY_USERS"
		mov	ecx, 0Bh
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_416A3B
		mov	[ebp+var_C], 80000003h
		jmp	short loc_416AA4
; ---------------------------------------------------------------------------

loc_416A3B:				; CODE XREF: sub_416954+DCj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_performan ; "HKEY_PERFORMANCE_DATA"
		mov	ecx, 16h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_416A6C
		mov	[ebp+var_C], 80000004h
		jmp	short loc_416AA4
; ---------------------------------------------------------------------------

loc_416A6C:				; CODE XREF: sub_416954+10Dj
		mov	eax, [ebp+arg_0]
		mov	edx, eax
		mov	eax, offset aHkey_current_c ; "HKEY_CURRENT_CONFIG"
		mov	ecx, 14h
		mov	esi, edx
		mov	edi, eax
		repe cmpsb
		setnbe	dl
		setb	al
		mov	ecx, edx
		sub	cl, al
		mov	eax, ecx
		movsx	eax, al
		test	eax, eax
		jnz	short loc_416A9D
		mov	[ebp+var_C], 80000005h
		jmp	short loc_416AA4
; ---------------------------------------------------------------------------

loc_416A9D:				; CODE XREF: sub_416954+13Ej
		mov	eax, 0
		jmp	short loc_416AA7
; ---------------------------------------------------------------------------

loc_416AA4:				; CODE XREF: sub_416954+15j
					; sub_416954+49j ...
		mov	eax, [ebp+var_C]

loc_416AA7:				; CODE XREF: sub_416954+14Ej
		add	esp, 10h
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_416954	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_416AAE(int, LPCSTR, LPCSTR lpValueName)
sub_416AAE	proc near		; CODE XREF: .text:0040BE1Ep

hKey		= dword	ptr -58h
lpSubKey	= dword	ptr -54h
ulOptions	= dword	ptr -50h
samDesired	= dword	ptr -4Ch
phkResult	= dword	ptr -48h
lpcbData	= dword	ptr -44h
var_2C		= dword	ptr -2Ch
Type		= dword	ptr -24h
cbData		= dword	ptr -20h
nSize		= dword	ptr -1Ch
var_18		= dword	ptr -18h
lpDst		= dword	ptr -14h
var_10		= dword	ptr -10h
lpData		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
lpValueName	= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	edi
		sub	esp, 54h
		mov	[ebp+lpData], 0
		mov	eax, [ebp+arg_0]
		mov	[esp+58h+hKey],	eax
		call	sub_416954
		mov	[ebp+var_10], eax
		cmp	[ebp+var_10], 0
		jnz	short loc_416ADA
		mov	eax, 0
		jmp	loc_416DCA
; ---------------------------------------------------------------------------

loc_416ADA:				; CODE XREF: sub_416AAE+20j
		lea	eax, [ebp+var_18]
		mov	[esp+58h+phkResult], eax ; phkResult
		mov	[esp+58h+samDesired], 20019h ; samDesired
		mov	[esp+58h+ulOptions], 0 ; ulOptions
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+lpSubKey], eax	; lpSubKey
		mov	eax, [ebp+var_10]
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegOpenKeyExA
		call	eax ; RegOpenKeyExA
		sub	esp, 14h
		test	eax, eax
		jz	short loc_416B59
		cmp	[ebp+arg_0], 0
		jz	short loc_416B1C
		mov	eax, 0
		jmp	loc_416DCA
; ---------------------------------------------------------------------------

loc_416B1C:				; CODE XREF: sub_416AAE+62j
		lea	eax, [ebp+var_18]
		mov	[esp+58h+phkResult], eax ; phkResult
		mov	[esp+58h+samDesired], 20019h ; samDesired
		mov	[esp+58h+ulOptions], 0 ; ulOptions
		mov	eax, [ebp+arg_4]
		mov	[esp+58h+lpSubKey], eax	; lpSubKey
		mov	[esp+58h+hKey],	80000002h ; hKey
		mov	eax, ds:RegOpenKeyExA
		call	eax ; RegOpenKeyExA
		sub	esp, 14h
		test	eax, eax
		jz	short loc_416B59
		mov	eax, 0
		jmp	loc_416DCA
; ---------------------------------------------------------------------------

loc_416B59:				; CODE XREF: sub_416AAE+5Cj
					; sub_416AAE+9Fj
		mov	[ebp+cbData], 1
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+cbData]
		mov	[esp+58h+lpcbData], edx	; lpcbData
		mov	[esp+58h+phkResult], 0 ; lpData
		mov	[esp+58h+samDesired], 0	; lpType
		mov	[esp+58h+ulOptions], 0 ; lpReserved
		mov	edx, [ebp+lpValueName]
		mov	[esp+58h+lpSubKey], edx	; lpValueName
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegQueryValueExA
		call	eax ; RegQueryValueExA
		sub	esp, 18h
		test	eax, eax
		jnz	loc_416DAD
		mov	eax, [ebp+cbData]
		add	eax, 1
		mov	[ebp+nSize], eax
		mov	eax, [ebp+nSize]
		mov	[esp+58h+hKey],	eax ; size_t
		call	sub_404CAE
		mov	[ebp+lpData], eax
		cmp	[ebp+lpData], 0
		jz	loc_416DB0
		mov	eax, [ebp+var_18]
		lea	edx, [ebp+nSize]
		mov	[esp+58h+lpcbData], edx	; lpcbData
		mov	edx, [ebp+lpData]
		mov	[esp+58h+phkResult], edx ; lpData
		lea	edx, [ebp+Type]
		mov	[esp+58h+samDesired], edx ; lpType
		mov	[esp+58h+ulOptions], 0 ; lpReserved
		mov	edx, [ebp+lpValueName]
		mov	[esp+58h+lpSubKey], edx	; lpValueName
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegQueryValueExA
		call	eax ; RegQueryValueExA
		sub	esp, 18h
		test	eax, eax
		jz	short loc_416C0E
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; void *
		call	sub_404E31
		mov	[ebp+lpData], 0
		jmp	loc_416DB7
; ---------------------------------------------------------------------------

loc_416C0E:				; CODE XREF: sub_416AAE+147j
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpData]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+Type]
		cmp	eax, 2
		jnz	loc_416DB7
		mov	[esp+58h+lpSubKey], 25h	; Val
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; Str
		call	strchr
		test	eax, eax
		jz	loc_416DB7
		mov	eax, [ebp+nSize]
		add	eax, 3E8h
		mov	[ebp+nSize], eax
		mov	eax, [ebp+nSize]
		add	eax, 1
		mov	[esp+58h+hKey],	eax ; size_t
		call	sub_404CAE
		mov	[ebp+lpDst], eax
		cmp	[ebp+lpDst], 0
		jz	loc_416DB3
		mov	eax, [ebp+nSize]
		mov	[esp+58h+ulOptions], eax ; nSize
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; lpDst
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; lpSrc
		mov	eax, ds:ExpandEnvironmentStringsA
		call	eax ; ExpandEnvironmentStringsA
		sub	esp, 0Ch
		mov	[ebp+cbData], eax
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	loc_416D2B
		mov	edx, [ebp+cbData]
		mov	eax, [ebp+nSize]
		cmp	edx, eax
		jbe	loc_416D2B
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax ; void *
		call	sub_404E31
		mov	eax, [ebp+cbData]
		mov	[ebp+nSize], eax
		mov	eax, [ebp+nSize]
		add	eax, 1
		mov	[esp+58h+hKey],	eax ; size_t
		call	sub_404CAE
		mov	[ebp+lpDst], eax
		cmp	[ebp+lpDst], 0
		jz	loc_416DB6
		mov	eax, [ebp+nSize]
		mov	[esp+58h+ulOptions], eax ; nSize
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; lpDst
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; lpSrc
		mov	eax, ds:ExpandEnvironmentStringsA
		call	eax ; ExpandEnvironmentStringsA
		sub	esp, 0Ch
		mov	[ebp+cbData], eax
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	short loc_416D0C
		mov	edx, [ebp+cbData]
		mov	eax, [ebp+nSize]
		cmp	edx, eax
		jbe	short loc_416D0C
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax ; void *
		call	sub_404E31
		jmp	loc_416DB7
; ---------------------------------------------------------------------------

loc_416D0C:				; CODE XREF: sub_416AAE+242j
					; sub_416AAE+24Cj
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpDst]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; void *
		call	sub_404E31
		mov	eax, [ebp+lpDst]
		mov	[ebp+lpData], eax
		jmp	loc_416DB7
; ---------------------------------------------------------------------------

loc_416D2B:				; CODE XREF: sub_416AAE+1DCj
					; sub_416AAE+1EAj
		mov	eax, [ebp+cbData]
		test	eax, eax
		jz	short loc_416DA0
		mov	eax, [ebp+cbData]
		add	eax, [ebp+lpDst]
		mov	byte ptr [eax],	0
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; void *
		call	sub_404E31
		mov	eax, [ebp+lpDst]
		mov	[ebp+var_2C], 0FFFFFFFFh
		mov	edx, eax
		mov	eax, 0
		mov	ecx, [ebp+var_2C]
		mov	edi, edx
		repne scasb
		mov	eax, ecx
		not	eax
		sub	eax, 1
		add	eax, 1
		mov	[esp+58h+hKey],	eax ; size_t
		call	sub_404CAE
		mov	[ebp+lpData], eax
		cmp	[ebp+lpData], 0
		jnz	short loc_416D81
		mov	eax, [ebp+lpDst]
		mov	[ebp+lpData], eax
		jmp	short loc_416DB7
; ---------------------------------------------------------------------------

loc_416D81:				; CODE XREF: sub_416AAE+2C9j
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+lpSubKey], eax	; Source
		mov	eax, [ebp+lpData]
		mov	[esp+58h+hKey],	eax ; Dest
		call	strcpy
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax ; void *
		call	sub_404E31
		jmp	short loc_416DB7
; ---------------------------------------------------------------------------

loc_416DA0:				; CODE XREF: sub_416AAE+282j
		mov	eax, [ebp+lpDst]
		mov	[esp+58h+hKey],	eax ; void *
		call	sub_404E31
		jmp	short loc_416DB7
; ---------------------------------------------------------------------------

loc_416DAD:				; CODE XREF: sub_416AAE+EAj
		nop
		jmp	short loc_416DB7
; ---------------------------------------------------------------------------

loc_416DB0:				; CODE XREF: sub_416AAE+10Bj
		nop
		jmp	short loc_416DB7
; ---------------------------------------------------------------------------

loc_416DB3:				; CODE XREF: sub_416AAE+1B0j
		nop
		jmp	short loc_416DB7
; ---------------------------------------------------------------------------

loc_416DB6:				; CODE XREF: sub_416AAE+216j
		nop

loc_416DB7:				; CODE XREF: sub_416AAE+15Bj
					; sub_416AAE+16Fj ...
		mov	eax, [ebp+var_18]
		mov	[esp+58h+hKey],	eax ; hKey
		mov	eax, ds:RegCloseKey
		call	eax ; RegCloseKey
		sub	esp, 4
		mov	eax, [ebp+lpData]

loc_416DCA:				; CODE XREF: sub_416AAE+27j
					; sub_416AAE+69j ...
		mov	edi, [ebp+var_4]
		leave
		retn
sub_416AAE	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gpg_err_code_from_syserror]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION gpg_strerror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION libiconv_open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION libiconv_close]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION libiconv]
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_1
TlsCallback_1	proc near		; DATA XREF: .CRT:0041F024o

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		test	eax, eax
		jz	short loc_416E20
		cmp	eax, 3
		jz	short loc_416E20
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
; ---------------------------------------------------------------------------
		align 10h

loc_416E20:				; CODE XREF: TlsCallback_1+9j
					; TlsCallback_1+Ej
		mov	edx, [esp+1Ch+arg_8]
		mov	[esp+1Ch+var_18], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_14], edx
		mov	[esp+1Ch+var_1C], eax
		call	sub_418010
		mov	eax, 1
		add	esp, 1Ch
		retn	0Ch
TlsCallback_1	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


		public TlsCallback_0
TlsCallback_0	proc near		; CODE XREF: sub_401180+113p
					; DATA XREF: .rdata:off_41CB9Co ...

lpLibFileName	= dword	ptr -1Ch
lpProcName	= dword	ptr -18h
var_14		= dword	ptr -14h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		sub	esp, 18h
		mov	edx, ds:_winmajor
		mov	eax, [esp+1Ch+arg_4]
		cmp	dword ptr [edx], 3
		jbe	short loc_416E94
		cmp	dword_419194, 2
		jz	short loc_416E76
		mov	dword_419194, 2

loc_416E76:				; CODE XREF: TlsCallback_0+1Aj
		cmp	eax, 2
		jz	loc_416F83
		cmp	eax, 1
		jz	loc_416F22

loc_416E88:				; CODE XREF: TlsCallback_0+EEj
					; TlsCallback_0+13Ej
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_416E94:				; CODE XREF: TlsCallback_0+11j
		mov	ds:dword_41D910, 1
		mov	[esp+1Ch+lpLibFileName], offset	LibFileName ; "mingwm10.dll"
		call	ds:LoadLibraryA
		sub	esp, 4
		test	eax, eax
		mov	ds:hLibModule, eax
		jz	loc_416FB3
		mov	ebx, ds:GetProcAddress
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_rem ; "__mingwthr_remove_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	ds:dword_41D90C, eax
		mov	eax, ds:hLibModule
		sub	esp, 8
		mov	[esp+1Ch+lpProcName], offset a__mingwthr_key ; "__mingwthr_key_dtor"
		mov	[esp+1Ch+lpLibFileName], eax ; hModule
		call	ebx ; GetProcAddress
		mov	edx, ds:hLibModule
		sub	esp, 8
		test	edx, edx
		mov	ds:dword_41D908, eax
		jz	loc_416FB3
		mov	ecx, ds:dword_41D90C
		test	ecx, ecx
		jz	short loc_416F43
		test	eax, eax
		jz	short loc_416F43
		mov	dword_419194, 1
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_416F22:				; CODE XREF: TlsCallback_0+32j
		mov	eax, [esp+1Ch+arg_8]
		mov	[esp+1Ch+lpProcName], 1
		mov	[esp+1Ch+var_14], eax
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+lpLibFileName], eax
		call	sub_418010
		jmp	loc_416E88
; ---------------------------------------------------------------------------

loc_416F43:				; CODE XREF: TlsCallback_0+B6j
					; TlsCallback_0+BAj
		mov	ds:dword_41D908, 0
		mov	ds:dword_41D90C, 0
		mov	[esp+1Ch+lpLibFileName], edx ; hLibModule
		call	ds:FreeLibrary
		sub	esp, 4

loc_416F63:				; CODE XREF: TlsCallback_0+177j
		mov	ds:hLibModule, 0
		mov	eax, 1
		mov	dword_419194, 0
		add	esp, 18h
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_416F83:				; CODE XREF: TlsCallback_0+29j
		mov	ebx, offset dword_41F030
		cmp	ebx, offset dword_41F030
		jz	loc_416E88

loc_416F94:				; CODE XREF: TlsCallback_0+155j
		mov	eax, [ebx]
		test	eax, eax
		jz	short loc_416F9C
		call	eax

loc_416F9C:				; CODE XREF: TlsCallback_0+148j
		add	ebx, 4
		cmp	ebx, offset dword_41F030
		jnz	short loc_416F94
		add	esp, 18h
		mov	eax, 1
		pop	ebx
		retn	0Ch
; ---------------------------------------------------------------------------

loc_416FB3:				; CODE XREF: TlsCallback_0+65j
					; TlsCallback_0+A8j
		mov	ds:dword_41D908, 0
		mov	ds:dword_41D90C, 0
		jmp	short loc_416F63
TlsCallback_0	endp

; ---------------------------------------------------------------------------
		align 10h
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_416FE0	proc near		; DATA XREF: .CRT:0041F014o
		mov	eax, ds:__lconv_init
		jmp	eax
sub_416FE0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_416FF0	proc near		; CODE XREF: sub_417010+10p
					; sub_417010+36p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_416FF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_417000	proc near		; CODE XREF: sub_401060+59p
					; sub_417010+71p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		retn
sub_417000	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_417010(_onexit_t)
sub_417010	proc near		; CODE XREF: sub_4170D0+Ap

Func		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	ebx
		sub	esp, 28h
		mov	eax, ds:dword_41D918
		mov	ebx, [esp+2Ch+arg_0]
		mov	[esp+2Ch+Func],	eax
		call	sub_416FF0
		cmp	eax, 0FFFFFFFFh
		mov	[esp+2Ch+var_14], eax
		jz	loc_4170B0
		mov	[esp+2Ch+Func],	8
		call	_lock
		mov	eax, ds:dword_41D918
		mov	[esp+2Ch+Func],	eax
		call	sub_416FF0
		mov	[esp+2Ch+var_14], eax
		mov	eax, ds:dword_41D914
		mov	[esp+2Ch+Func],	eax
		call	sub_416FF0
		mov	[esp+2Ch+Func],	ebx
		mov	[esp+2Ch+var_10], eax
		lea	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+var_24], eax
		lea	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_28], eax
		call	__dllonexit
		mov	ebx, eax
		mov	eax, [esp+2Ch+var_14]
		mov	[esp+2Ch+Func],	eax
		call	sub_417000
		mov	ds:dword_41D918, eax
		mov	eax, [esp+2Ch+var_10]
		mov	[esp+2Ch+Func],	eax
		call	sub_417000
		mov	[esp+2Ch+Func],	8
		mov	ds:dword_41D914, eax
		call	_unlock
		add	esp, 28h
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4170B0:				; CODE XREF: sub_417010+1Cj
		mov	[esp+2Ch+Func],	ebx ; Func
		call	ds:_onexit
		add	esp, 28h
		mov	ebx, eax
		mov	eax, ebx
		pop	ebx
		retn
sub_417010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4170D0(_onexit_t)
sub_4170D0	proc near		; CODE XREF: sub_405721+20p
					; sub_417CF0-27p ...

var_1C		= dword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_1C], eax ;	_onexit_t
		call	sub_417010
		cmp	eax, 1
		sbb	eax, eax
		add	esp, 1Ch
		retn
sub_4170D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; LONG __stdcall TopLevelExceptionFilter(struct	_EXCEPTION_POINTERS *ExceptionInfo)
TopLevelExceptionFilter	proc near	; DATA XREF: sub_401180+11Do

var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_10		= dword	ptr -10h
ExceptionInfo	= dword	ptr  4

		push	esi
		push	ebx
		sub	esp, 24h
		mov	ebx, [esp+2Ch+ExceptionInfo]
		mov	eax, [ebx]
		mov	eax, [eax]
		cmp	eax, 0C0000091h
		ja	short loc_417147
		cmp	eax, 0C000008Dh
		jb	short loc_417174

loc_41710B:				; CODE XREF: TopLevelExceptionFilter+6Aj
		mov	esi, 1

loc_417110:				; CODE XREF: TopLevelExceptionFilter+C7j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 8
		call	signal
		cmp	eax, 1
		jz	loc_417240
		test	eax, eax
		jz	short loc_41715C
		mov	[esp+2Ch+var_2C], 8
		call	eax
		mov	eax, 0FFFFFFFFh

loc_41713F:				; CODE XREF: TopLevelExceptionFilter+120j
					; TopLevelExceptionFilter+13Ej	...
		add	esp, 24h
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_417147:				; CODE XREF: TopLevelExceptionFilter+12j
		cmp	eax, 0C0000094h
		jz	short loc_4171B5
		cmp	eax, 0C0000096h
		jz	short loc_417182
		cmp	eax, 0C0000093h
		jz	short loc_41710B

loc_41715C:				; CODE XREF: TopLevelExceptionFilter+3Fj
					; TopLevelExceptionFilter+90j ...
		mov	eax, ds:dword_41D548
		test	eax, eax
		jz	loc_417233
		mov	[esp+2Ch+ExceptionInfo], ebx
		add	esp, 24h
		pop	ebx
		pop	esi
		jmp	eax
; ---------------------------------------------------------------------------

loc_417174:				; CODE XREF: TopLevelExceptionFilter+19j
		cmp	eax, 0C0000005h
		jz	short loc_4171C0
		cmp	eax, 0C000001Dh
		jnz	short loc_41715C

loc_417182:				; CODE XREF: TopLevelExceptionFilter+63j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 4
		call	signal
		cmp	eax, 1
		jz	short loc_4171F7
		test	eax, eax
		jz	short loc_41715C
		mov	[esp+2Ch+var_2C], 4
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_4171B5:				; CODE XREF: TopLevelExceptionFilter+5Cj
		xor	esi, esi
		jmp	loc_417110
; ---------------------------------------------------------------------------
		align 10h

loc_4171C0:				; CODE XREF: TopLevelExceptionFilter+89j
		mov	[esp+2Ch+var_28], 0
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		cmp	eax, 1
		jz	short loc_417215
		test	eax, eax
		jz	loc_41715C
		mov	[esp+2Ch+var_2C], 0Bh
		call	eax
		add	esp, 24h
		mov	eax, 0FFFFFFFFh
		pop	ebx
		pop	esi
		retn	4
; ---------------------------------------------------------------------------

loc_4171F7:				; CODE XREF: TopLevelExceptionFilter+A9j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 4
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_41713F
; ---------------------------------------------------------------------------

loc_417215:				; CODE XREF: TopLevelExceptionFilter+E7j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 0Bh
		call	signal
		mov	eax, 0FFFFFFFFh
		jmp	loc_41713F
; ---------------------------------------------------------------------------

loc_417233:				; CODE XREF: TopLevelExceptionFilter+73j
		xor	eax, eax
		jmp	loc_41713F
; ---------------------------------------------------------------------------
		align 10h

loc_417240:				; CODE XREF: TopLevelExceptionFilter+37j
		mov	[esp+2Ch+var_28], 1
		mov	[esp+2Ch+var_2C], 8
		call	signal
		test	esi, esi
		mov	eax, 0FFFFFFFFh
		jz	loc_41713F
		mov	[esp+2Ch+var_10], eax
		call	sub_417C60
		mov	eax, [esp+2Ch+var_10]
		jmp	loc_41713F
TopLevelExceptionFilter	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 3Ch
		mov	eax, ds:dword_41D54C
		fld	qword ptr [esp+48h]
		fld	qword ptr [esp+50h]
		fld	qword ptr [esp+58h]
		test	eax, eax
		jz	short loc_4172C1
		fxch	st(2)
		mov	edx, [esp+40h]
		fstp	qword ptr [esp+18h]
		fstp	qword ptr [esp+20h]
		fstp	qword ptr [esp+28h]
		mov	[esp+10h], edx
		mov	edx, [esp+44h]
		mov	[esp+14h], edx
		lea	edx, [esp+10h]
		mov	[esp], edx
		call	eax ; dword_41D54C
		jmp	short loc_4172C7
; ---------------------------------------------------------------------------

loc_4172C1:				; CODE XREF: .text:00417296j
		fstp	st
		fstp	st
		fstp	st

loc_4172C7:				; CODE XREF: .text:004172BFj
		add	esp, 3Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4172D0	proc near		; CODE XREF: sub_401060+F7p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ds:dword_41D54C, eax
		jmp	__setusermatherr
sub_4172D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4172E0	proc near		; DATA XREF: sub_401060:loc_401150o

File		= dword	ptr -3Ch
Format		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= qword	ptr -2Ch
var_24		= qword	ptr -24h
var_1C		= qword	ptr -1Ch
arg_0		= dword	ptr  4

		sub	esp, 3Ch
		mov	edx, offset aUnknownError ; "Unknown error"
		mov	eax, [esp+3Ch+arg_0]
		mov	ecx, [eax]
		sub	ecx, 1
		cmp	ecx, 5
		ja	short loc_4172FD
		mov	edx, ds:off_41CCBC[ecx*4]

loc_4172FD:				; CODE XREF: sub_4172E0+14j
		fld	qword ptr [eax+18h]
		fstp	[esp+3Ch+var_1C]
		fld	qword ptr [eax+10h]
		fstp	[esp+3Ch+var_24]
		fld	qword ptr [eax+8]
		fstp	[esp+3Ch+var_2C]
		mov	eax, [eax+4]
		mov	[esp+3Ch+var_34], edx
		mov	[esp+3Ch+Format], offset a_matherrSInSGG ; "_matherr():	%s in %s(%g, %g)  (retval=%"...
		mov	[esp+3Ch+var_30], eax
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+3Ch+File],	eax ; File
		call	fprintf
		xor	eax, eax
		add	esp, 3Ch
		retn
sub_4172E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_417340	proc near		; CODE XREF: sub_401060+75p
		xor	eax, eax
		retn
sub_417340	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: noreturn

; int __cdecl sub_417350(char *Format, char ArgList)
sub_417350	proc near		; CODE XREF: sub_4173B0+1DDp
					; sub_4173B0+204p ...

Str		= dword	ptr -1Ch
Size		= dword	ptr -18h
Count		= dword	ptr -14h
File		= dword	ptr -10h
Format		= dword	ptr  4
ArgList		= byte ptr  8

		push	ebx
		sub	esp, 18h
		mov	eax, ds:_iob
		mov	[esp+1Ch+Count], 1Bh ; Count
		lea	ebx, [esp+1Ch+ArgList]
		mov	[esp+1Ch+Size],	1 ; Size
		mov	[esp+1Ch+Str], offset aMingwW64Runtim ;	"Mingw-w64 runtime failure:\n"
		add	eax, 40h
		mov	[esp+1Ch+File],	eax ; File
		call	fwrite
		mov	eax, [esp+1Ch+Format]
		mov	[esp+1Ch+Count], ebx ; ArgList
		mov	[esp+1Ch+Size],	eax ; Format
		mov	eax, ds:_iob
		add	eax, 40h
		mov	[esp+1Ch+Str], eax ; File
		call	vfprintf
		call	abort
sub_417350	endp

; ---------------------------------------------------------------------------
		jmp	short sub_4173B0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_4173B0(size_t Size)
sub_4173B0	proc near		; CODE XREF: .text:004173A1j
					; sub_4175F0+B8p ...

lpAddress	= dword	ptr -7Ch
lpBuffer	= dword	ptr -78h
dwLength	= dword	ptr -74h
lpflOldProtect	= dword	ptr -70h
var_64		= dword	ptr -64h
Src		= dword	ptr -60h
var_58		= _MEMORY_BASIC_INFORMATION ptr	-58h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
flOldProtect	= dword	ptr -20h

		push	ebp
		mov	ebp, ecx
		push	edi
		push	esi
		push	ebx
		mov	ebx, eax
		sub	esp, 6Ch
		mov	ecx, ds:dword_41D558
		mov	[esp+7Ch+Src], edx
		test	ecx, ecx
		jle	loc_417592
		mov	eax, ds:dword_41D554
		xor	esi, esi

loc_4173D4:				; CODE XREF: sub_4173B0+41j
		mov	edx, [eax+4]
		cmp	ebx, edx
		jb	short loc_4173E9
		mov	edi, [eax+8]
		add	edx, [edi+8]
		cmp	ebx, edx
		jb	loc_4174C0

loc_4173E9:				; CODE XREF: sub_4173B0+29j
		add	esi, 1
		add	eax, 0Ch
		cmp	esi, ecx
		jnz	short loc_4173D4

loc_4173F3:				; CODE XREF: sub_4173B0+1E4j
		mov	[esp+7Ch+lpAddress], ebx
		call	sub_4179B0
		test	eax, eax
		mov	edi, eax
		jz	loc_4175B9
		lea	edx, [esi+esi*2]
		mov	esi, ds:dword_41D554
		shl	edx, 2
		add	esi, edx
		mov	[esi+8], eax
		mov	dword ptr [esi], 0
		mov	[esp+7Ch+var_64], edx
		call	sub_417A90
		mov	edx, [esp+7Ch+var_64]
		add	eax, [edi+0Ch]
		mov	[esi+4], eax
		lea	eax, [esp+7Ch+Buffer]
		mov	esi, ds:VirtualQuery
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	eax, ds:dword_41D554
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		mov	edx, [esp+7Ch+var_64]
		jz	loc_417599
		mov	eax, [esp+7Ch+Buffer.Protect]
		cmp	eax, 4
		jnz	loc_417541

loc_41746F:				; CODE XREF: sub_4173B0+194j
					; sub_4173B0+1C6j
		add	ds:dword_41D558, 1

loc_417476:				; CODE XREF: sub_4173B0+116j
		lea	eax, [esp+7Ch+var_58]
		mov	[esp+7Ch+dwLength], 1Ch	; dwLength
		mov	[esp+7Ch+lpBuffer], eax	; lpBuffer
		mov	[esp+7Ch+lpAddress], ebx ; lpAddress
		call	esi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_4175C9
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 4
		jnz	short loc_4174C8

loc_41749F:				; CODE XREF: sub_4173B0+11Bj
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy

loc_4174B3:				; CODE XREF: sub_4173B0+162j
					; sub_4173B0+167j
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4174C0:				; CODE XREF: sub_4173B0+33j
		mov	esi, ds:VirtualQuery
		jmp	short loc_417476
; ---------------------------------------------------------------------------

loc_4174C8:				; CODE XREF: sub_4173B0+EDj
		cmp	eax, 40h
		jz	short loc_41749F
		mov	eax, [esp+7Ch+var_58.RegionSize]
		lea	edi, [esp+7Ch+flOldProtect]
		mov	esi, ds:VirtualProtect
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		mov	eax, [esp+7Ch+Src]
		mov	[esp+7Ch+dwLength], ebp	; Size
		mov	[esp+7Ch+lpAddress], ebx ; Dst
		mov	[esp+7Ch+lpBuffer], eax	; Src
		call	memcpy
		mov	eax, [esp+7Ch+var_58.Protect]
		cmp	eax, 40h
		jz	short loc_4174B3
		cmp	eax, 4
		jz	short loc_4174B3
		mov	eax, [esp+7Ch+flOldProtect]
		mov	[esp+7Ch+lpflOldProtect], edi ;	lpflOldProtect
		mov	[esp+7Ch+dwLength], eax	; flNewProtect
		mov	eax, [esp+7Ch+var_58.RegionSize]
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+var_58.BaseAddress]
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	esi ; VirtualProtect
		sub	esp, 10h
		add	esp, 6Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_417541:				; CODE XREF: sub_4173B0+B9j
		cmp	eax, 40h
		jz	loc_41746F
		mov	eax, [esp+7Ch+Buffer.RegionSize]
		add	edx, ds:dword_41D554
		mov	[esp+7Ch+dwLength], 40h	; flNewProtect
		mov	[esp+7Ch+lpBuffer], eax	; dwSize
		mov	eax, [esp+7Ch+Buffer.BaseAddress]
		mov	[esp+7Ch+lpflOldProtect], edx ;	lpflOldProtect
		mov	[esp+7Ch+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		test	eax, eax
		jnz	loc_41746F
		call	ds:GetLastError
		mov	[esp+7Ch+lpAddress], offset aVirtualprotect ; "	 VirtualProtect	failed with code 0x%x"
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_417350
; ---------------------------------------------------------------------------

loc_417592:				; CODE XREF: sub_4173B0+17j
		xor	esi, esi
		jmp	loc_4173F3
; ---------------------------------------------------------------------------

loc_417599:				; CODE XREF: sub_4173B0+ACj
		mov	eax, ds:dword_41D554
		mov	eax, [eax+edx+4]
		mov	[esp+7Ch+dwLength], eax
		mov	eax, [edi+8]
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+7Ch+lpBuffer], eax	; ArgList
		call	sub_417350
; ---------------------------------------------------------------------------

loc_4175B9:				; CODE XREF: sub_4173B0+4Fj
		mov	[esp+7Ch+lpBuffer], ebx	; ArgList
		mov	[esp+7Ch+lpAddress], offset aAddressPHasNoI ; "Address %p has no image-section"
		call	sub_417350
; ---------------------------------------------------------------------------

loc_4175C9:				; CODE XREF: sub_4173B0+E0j
		mov	[esp+7Ch+dwLength], ebx
		mov	[esp+7Ch+lpBuffer], 1Ch	; ArgList
		mov	[esp+7Ch+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		call	sub_417350
sub_4173B0	endp

; ---------------------------------------------------------------------------
		db 0EBh	; 
		db  0Dh
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4175F0	proc near		; CODE XREF: sub_401180:loc_401298p

lpAddress	= dword	ptr -58h
lpBuffer	= dword	ptr -54h
dwLength	= dword	ptr -50h
lpflOldProtect	= dword	ptr -4Ch
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-3Ch
var_20		= dword	ptr -20h
flOldProtect	= dword	ptr -1Ch

		push	ebp
		mov	ebp, esp
		push	edi
		push	esi
		push	ebx
		sub	esp, 4Ch
		mov	eax, ds:dword_41D550
		test	eax, eax
		jz	short loc_417610

loc_417602:				; CODE XREF: sub_4175F0+66j
					; sub_4175F0+96j ...
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_417610:				; CODE XREF: sub_4175F0+10j
		mov	ds:dword_41D550, 1
		call	sub_4179F0
		lea	eax, [eax+eax*2]
		lea	eax, ds:1Eh[eax*4]
		and	eax, 0FFFFFFF0h
		call	sub_4180B0
		mov	ds:dword_41D558, 0
		sub	esp, eax
		lea	eax, [esp+58h+Buffer.BaseAddress+3]
		and	eax, 0FFFFFFF0h
		mov	ds:dword_41D554, eax
		mov	eax, offset dword_41CE4C
		sub	eax, offset dword_41CE4C
		cmp	eax, 7
		jle	short loc_417602
		cmp	eax, 0Bh
		mov	ebx, offset dword_41CE4C
		jle	loc_417750
		mov	eax, ds:dword_41CE4C
		test	eax, eax
		jnz	short loc_417680
		mov	eax, ds:dword_41CE50
		test	eax, eax
		jz	loc_41773C
		lea	esi, [esi+0]

loc_417680:				; CODE XREF: sub_4175F0+7Dj
					; sub_4175F0+164j ...
		cmp	ebx, offset dword_41CE4C
		jnb	loc_417602
		mov	esi, 400000h

loc_417691:				; CODE XREF: sub_4175F0+C3j
		mov	eax, [ebx+4]
		mov	ecx, 4		; Size
		add	eax, esi
		mov	edx, [eax]
		add	edx, [ebx]
		add	ebx, 8
		mov	[ebp+flOldProtect], edx
		lea	edx, [ebp+flOldProtect]
		call	sub_4173B0
		cmp	ebx, offset dword_41CE4C
		jb	short loc_417691

loc_4176B5:				; CODE XREF: sub_4175F0+24Bj
		mov	ecx, ds:dword_41D558
		test	ecx, ecx
		jle	loc_417602
		xor	ebx, ebx
		xor	esi, esi
		mov	edi, ds:VirtualQuery
		jmp	short loc_4176E2
; ---------------------------------------------------------------------------
		align 10h

loc_4176D0:				; CODE XREF: sub_4175F0+FDj
					; sub_4175F0+14Aj
		add	esi, 1
		add	ebx, 0Ch
		cmp	esi, ds:dword_41D558
		jge	loc_417602

loc_4176E2:				; CODE XREF: sub_4175F0+DDj
		mov	eax, ds:dword_41D554
		add	eax, ebx
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_4176D0
		lea	edx, [ebp+Buffer]
		mov	[esp+58h+dwLength], 1Ch	; dwLength
		mov	[esp+58h+lpBuffer], edx	; lpBuffer
		mov	eax, [eax+4]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	edi ; VirtualQuery
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_417862
		lea	eax, [ebp+flOldProtect]
		mov	[esp+58h+lpflOldProtect], eax ;	lpflOldProtect
		mov	eax, ds:dword_41D554
		mov	eax, [eax+ebx]
		mov	[esp+58h+dwLength], eax	; flNewProtect
		mov	eax, [ebp+Buffer.RegionSize]
		mov	[esp+58h+lpBuffer], eax	; dwSize
		mov	eax, [ebp+Buffer.BaseAddress]
		mov	[esp+58h+lpAddress], eax ; lpAddress
		call	ds:VirtualProtect
		sub	esp, 10h
		jmp	short loc_4176D0
; ---------------------------------------------------------------------------

loc_41773C:				; CODE XREF: sub_4175F0+86j
		mov	eax, ds:dword_41CE54
		test	eax, eax
		jnz	short loc_417765
		mov	ebx, offset dword_41CE58
		lea	esi, [esi+0]

loc_417750:				; CODE XREF: sub_4175F0+70j
		mov	edi, [ebx]
		test	edi, edi
		jnz	loc_417680
		mov	esi, [ebx+4]
		test	esi, esi
		jnz	loc_417680

loc_417765:				; CODE XREF: sub_4175F0+153j
		mov	eax, [ebx+8]
		cmp	eax, 1
		jnz	loc_417885
		add	ebx, 0Ch
		cmp	ebx, offset dword_41CE4C
		jnb	loc_417602

loc_417780:				; CODE XREF: sub_4175F0+245j
		movzx	edx, byte ptr [ebx+8]
		mov	eax, 400000h
		mov	ecx, [ebx]
		add	eax, [ebx+4]
		cmp	edx, 10h
		mov	esi, [ecx+400000h]
		jz	short loc_4177DA
		cmp	edx, 20h
		jz	short loc_417810
		cmp	edx, 8
		jz	short loc_4177BA
		mov	[esp+58h+lpBuffer], edx	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseudoR ; "	 Unknown pseudo	relocation bit size %d"...
		mov	[ebp+var_20], 0
		call	sub_417350
; ---------------------------------------------------------------------------

loc_4177BA:				; CODE XREF: sub_4175F0+1B1j
		movzx	edi, byte ptr [eax]
		test	edi, 80h
		jz	short loc_4177E5
		or	edi, 0FFFFFF00h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi
		jmp	short loc_417801
; ---------------------------------------------------------------------------

loc_4177DA:				; CODE XREF: sub_4175F0+1A7j
		movzx	edi, word ptr [eax]
		test	edi, 8000h
		jnz	short loc_417840

loc_4177E5:				; CODE XREF: sub_4175F0+1D3j
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		cmp	edx, 10h
		mov	[ebp+var_20], esi
		jz	short loc_417853
		cmp	edx, 20h
		jz	short loc_41781F
		cmp	edx, 8
		jnz	short loc_41782C

loc_417801:				; CODE XREF: sub_4175F0+1E8j
		mov	ecx, 1		; Size
		lea	edx, [ebp+var_20]
		call	sub_4173B0
		jmp	short loc_41782C
; ---------------------------------------------------------------------------

loc_417810:				; CODE XREF: sub_4175F0+1ACj
		mov	edx, [eax]
		sub	edx, ecx
		sub	edx, 400000h
		add	edx, esi
		mov	[ebp+var_20], edx

loc_41781F:				; CODE XREF: sub_4175F0+20Aj
		mov	ecx, 4		; Size
		lea	edx, [ebp+var_20]
		call	sub_4173B0

loc_41782C:				; CODE XREF: sub_4175F0+20Fj
					; sub_4175F0+21Ej ...
		add	ebx, 0Ch
		cmp	ebx, offset dword_41CE4C
		jb	loc_417780
		jmp	loc_4176B5
; ---------------------------------------------------------------------------

loc_417840:				; CODE XREF: sub_4175F0+1F3j
		or	edi, 0FFFF0000h
		sub	edi, ecx
		sub	edi, 400000h
		add	esi, edi
		mov	[ebp+var_20], esi

loc_417853:				; CODE XREF: sub_4175F0+205j
		mov	ecx, 2		; Size
		lea	edx, [ebp+var_20]
		call	sub_4173B0
		jmp	short loc_41782C
; ---------------------------------------------------------------------------

loc_417862:				; CODE XREF: sub_4175F0+11Bj
		add	ebx, ds:dword_41D554
		mov	eax, [ebx+4]
		mov	[esp+58h+dwLength], eax
		mov	eax, [ebx+8]
		mov	eax, [eax+8]
		mov	[esp+58h+lpAddress], offset aVirtualqueryFa ; "	 VirtualQuery failed for %d bytes at a"...
		mov	[esp+58h+lpBuffer], eax	; ArgList
		call	sub_417350
; ---------------------------------------------------------------------------

loc_417885:				; CODE XREF: sub_4175F0+17Bj
		mov	[esp+58h+lpBuffer], eax	; ArgList
		mov	[esp+58h+lpAddress], offset aUnknownPseud_0 ; "	 Unknown pseudo	relocation protocol ve"...
		call	sub_417350
sub_4175F0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4178A0	proc near		; CODE XREF: .text:00417941p
					; sub_4179B0+Ap ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		xor	eax, eax
		cmp	word ptr [edx],	5A4Dh
		jz	short loc_4178B0

locret_4178AD:				; CODE XREF: sub_4178A0+19j
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_4178B0:				; CODE XREF: sub_4178A0+Bj
		add	edx, [edx+3Ch]
		cmp	dword ptr [edx], 4550h
		jnz	short locret_4178AD
		xor	eax, eax
		cmp	word ptr [edx+18h], 10Bh
		setz	al
		retn
sub_4178A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4178D0	proc near		; CODE XREF: sub_4179B0+2Bp
					; .text:00417AF4p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		xor	eax, eax
		push	ebx
		mov	edx, [esp+8+arg_0]
		mov	ebx, [esp+8+arg_4]
		add	edx, [edx+3Ch]
		movzx	esi, word ptr [edx+6]
		movzx	ecx, word ptr [edx+14h]
		test	esi, esi
		jz	short loc_41790E
		movzx	ecx, cx
		lea	eax, [edx+ecx+18h]
		xor	edx, edx

loc_4178F4:				; CODE XREF: sub_4178D0+3Aj
		mov	ecx, [eax+0Ch]
		cmp	ecx, ebx
		ja	short loc_417902
		add	ecx, [eax+8]
		cmp	ebx, ecx
		jb	short loc_41790E

loc_417902:				; CODE XREF: sub_4178D0+29j
		add	edx, 1
		add	eax, 28h
		cmp	edx, esi
		jb	short loc_4178F4
		xor	eax, eax

loc_41790E:				; CODE XREF: sub_4178D0+19j
					; sub_4178D0+30j
		pop	ebx
		pop	esi
		retn
sub_4178D0	endp

; ---------------------------------------------------------------------------
		jmp	short loc_417920
; ---------------------------------------------------------------------------
		align 10h

loc_417920:				; CODE XREF: .text:00417911j
		push	ebp
		push	edi
		push	esi
		push	ebx
		xor	ebx, ebx
		sub	esp, 1Ch
		mov	edi, [esp+30h]
		mov	[esp], edi
		call	strlen
		cmp	eax, 8
		ja	short loc_417993
		mov	dword ptr [esp], 400000h
		call	sub_4178A0
		test	eax, eax
		jz	short loc_417993
		mov	eax, ds:40003Ch
		movzx	ebp, word ptr [eax+400006h]
		movzx	edx, word ptr [eax+400014h]
		add	eax, 400000h
		test	ebp, ebp
		jz	short loc_417993
		movzx	edx, dx
		xor	esi, esi
		lea	ebx, [eax+edx+18h]
		jmp	short loc_41797B
; ---------------------------------------------------------------------------

loc_417971:				; CODE XREF: .text:00417991j
		add	esi, 1
		add	ebx, 28h
		cmp	esi, ebp
		jnb	short loc_4179A0

loc_41797B:				; CODE XREF: .text:0041796Fj
		mov	dword ptr [esp+8], 8
		mov	[esp+4], edi
		mov	[esp], ebx
		call	strncmp
		test	eax, eax
		jnz	short loc_417971

loc_417993:				; CODE XREF: .text:00417938j
					; .text:00417948j ...
		add	esp, 1Ch
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_4179A0:				; CODE XREF: .text:00417979j
		add	esp, 1Ch
		xor	ebx, ebx
		mov	eax, ebx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4179B0	proc near		; CODE XREF: sub_4173B0+46p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 8
		mov	[esp+8+var_8], 400000h
		call	sub_4178A0
		mov	edx, eax
		xor	eax, eax
		test	edx, edx
		jz	short loc_4179E0
		mov	eax, [esp+8+arg_0]
		mov	[esp+8+var_8], 400000h
		sub	eax, 400000h
		mov	[esp+8+var_4], eax
		call	sub_4178D0

loc_4179E0:				; CODE XREF: sub_4179B0+15j
		add	esp, 8
		retn
sub_4179B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4179F0	proc near		; CODE XREF: sub_4175F0+2Ap

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_4178A0
		xor	edx, edx
		test	eax, eax
		jz	short loc_417A11
		mov	eax, ds:40003Ch
		movzx	edx, word ptr [eax+400006h]

loc_417A11:				; CODE XREF: sub_4179F0+13j
		mov	eax, edx
		add	esp, 4
		retn
sub_4179F0	endp

; ---------------------------------------------------------------------------
		align 10h
		push	esi
		push	ebx
		sub	esp, 4
		mov	dword ptr [esp], 400000h
		mov	ebx, [esp+10h]
		call	sub_4178A0
		xor	edx, edx
		test	eax, eax
		jz	short loc_417A79
		mov	eax, ds:40003Ch
		movzx	ecx, word ptr [eax+400006h]
		movzx	esi, word ptr [eax+400014h]
		add	eax, 400000h
		test	ecx, ecx
		jz	short loc_417A79
		movzx	esi, si
		lea	edx, [eax+esi+18h]
		xor	eax, eax

loc_417A60:				; CODE XREF: .text:00417A75j
		test	byte ptr [edx+27h], 20h
		jz	short loc_417A6D
		test	ebx, ebx
		jz	short loc_417A79
		sub	ebx, 1

loc_417A6D:				; CODE XREF: .text:00417A64j
		add	eax, 1
		add	edx, 28h
		cmp	eax, ecx
		jb	short loc_417A60
		xor	edx, edx

loc_417A79:				; CODE XREF: .text:00417A39j
					; .text:00417A55j ...
		add	esp, 4
		mov	eax, edx
		pop	ebx
		pop	esi
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_417A90
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_417A90	proc near		; CODE XREF: sub_4173B0+70p
					; .text:00417A81j

var_4		= dword	ptr -4

		sub	esp, 4
		mov	[esp+4+var_4], 400000h
		call	sub_4178A0
		xor	edx, edx
		test	eax, eax
		mov	eax, 400000h
		cmovnz	edx, eax
		add	esp, 4
		mov	eax, edx
		retn
sub_417A90	endp

; ---------------------------------------------------------------------------
		jmp	short loc_417AC0
; ---------------------------------------------------------------------------
		align 10h

loc_417AC0:				; CODE XREF: .text:00417AB1j
		push	ebx
		xor	ebx, ebx
		sub	esp, 8
		mov	dword ptr [esp], 400000h
		call	sub_4178A0
		test	eax, eax
		jnz	short loc_417AE0

loc_417AD6:				; CODE XREF: .text:00417AFBj
		add	esp, 8
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_417AE0:				; CODE XREF: .text:00417AD4j
		mov	eax, [esp+10h]
		mov	dword ptr [esp], 400000h
		sub	eax, 400000h
		mov	[esp+4], eax
		call	sub_4178D0
		test	eax, eax
		jz	short loc_417AD6
		mov	ebx, [eax+24h]
		add	esp, 8
		not	ebx
		shr	ebx, 1Fh
		mov	eax, ebx
		pop	ebx
		retn
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_417B10	proc near		; CODE XREF: sub_417BA0+1Ap

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
arg_0		= dword	ptr  4

		push	edi
		xor	edi, edi
		push	esi
		push	ebx
		sub	esp, 8
		mov	[esp+14h+var_14], 400000h
		mov	ebx, [esp+14h+arg_0]
		call	sub_4178A0
		test	eax, eax
		jz	short loc_417B81
		mov	eax, ds:40003Ch
		mov	esi, [eax+400080h]
		test	esi, esi
		jz	short loc_417B81
		mov	[esp+14h+var_10], esi
		mov	[esp+14h+var_14], 400000h
		call	sub_4178D0
		test	eax, eax
		jz	short loc_417B81
		add	esi, 400000h
		jnz	short loc_417B66
		jmp	short loc_417B81
; ---------------------------------------------------------------------------
		align 10h

loc_417B60:				; CODE XREF: sub_417B10+66j
		sub	ebx, 1
		add	esi, 14h

loc_417B66:				; CODE XREF: sub_417B10+45j
		mov	edx, [esi+4]
		test	edx, edx
		jnz	short loc_417B74
		mov	eax, [esi+0Ch]
		test	eax, eax
		jz	short loc_417B90

loc_417B74:				; CODE XREF: sub_417B10+5Bj
		test	ebx, ebx
		jg	short loc_417B60
		mov	edi, [esi+0Ch]
		add	edi, 400000h

loc_417B81:				; CODE XREF: sub_417B10+1Aj
					; sub_417B10+29j ...
		add	esp, 8
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_417B90:				; CODE XREF: sub_417B10+62j
		add	esp, 8
		xor	edi, edi
		mov	eax, edi
		pop	ebx
		pop	esi
		pop	edi
		retn
sub_417B10	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_417BA0	proc near		; CODE XREF: sub_401180+132p

lpModuleName	= dword	ptr -1Ch

		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_41D55C
		test	eax, eax
		jz	short loc_417BB2

loc_417BAD:				; CODE XREF: sub_417BA0+97j
					; sub_417BA0+B5j
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_417BB2:				; CODE XREF: sub_417BA0+Bj
		xor	eax, eax

loc_417BB4:				; CODE XREF: sub_417BA0+82j
		mov	[esp+1Ch+lpModuleName],	eax
		lea	ebx, [eax+1]
		call	sub_417B10
		test	eax, eax
		jz	short loc_417C40
		movzx	edx, byte ptr [eax]
		cmp	dl, 4Dh
		jz	short loc_417BD0
		cmp	dl, 6Dh
		jnz	short loc_417C20

loc_417BD0:				; CODE XREF: sub_417BA0+29j
		movzx	edx, byte ptr [eax+1]
		cmp	dl, 53h
		jz	short loc_417BDE
		cmp	dl, 73h
		jnz	short loc_417C20

loc_417BDE:				; CODE XREF: sub_417BA0+37j
		movzx	edx, byte ptr [eax+2]
		cmp	dl, 56h
		jz	short loc_417BEC
		cmp	dl, 76h
		jnz	short loc_417C20

loc_417BEC:				; CODE XREF: sub_417BA0+45j
		movzx	edx, byte ptr [eax+3]
		cmp	dl, 43h
		jz	short loc_417BFA
		cmp	dl, 63h
		jnz	short loc_417C20

loc_417BFA:				; CODE XREF: sub_417BA0+53j
		movzx	edx, byte ptr [eax+4]
		cmp	dl, 52h
		jz	short loc_417C08
		cmp	dl, 72h
		jnz	short loc_417C20

loc_417C08:				; CODE XREF: sub_417BA0+61j
		movzx	edx, byte ptr [eax+5]
		cmp	dl, 54h
		jz	short loc_417C24
		cmp	dl, 74h
		jz	short loc_417C24
		sub	edx, 30h
		cmp	dl, 9
		jbe	short loc_417C24
		xchg	ax, ax

loc_417C20:				; CODE XREF: sub_417BA0+2Ej
					; sub_417BA0+3Cj ...
		mov	eax, ebx
		jmp	short loc_417BB4
; ---------------------------------------------------------------------------

loc_417C24:				; CODE XREF: sub_417BA0+6Fj
					; sub_417BA0+74j ...
		mov	[esp+1Ch+lpModuleName],	eax ; lpModuleName
		call	ds:GetModuleHandleA
		sub	esp, 4
		test	eax, eax
		mov	ds:dword_41D55C, eax
		jnz	loc_417BAD
		lea	esi, [esi+0]

loc_417C40:				; CODE XREF: sub_417BA0+21j
		mov	[esp+1Ch+lpModuleName],	offset aMsvcrt_dll ; "msvcrt.dll"
		call	ds:LoadLibraryW
		sub	esp, 4
		mov	ds:dword_41D55C, eax
		jmp	loc_417BAD
sub_417BA0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_417C60	proc near		; CODE XREF: sub_401180:loc_4012D8p
					; TopLevelExceptionFilter+175p
		fninit
		retn
sub_417C60	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_417C70()
sub_417C70	proc near		; DATA XREF: sub_417CF0:loc_417CC2o
		sub	esp, 0Ch
		mov	eax, off_419190
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_417C97
		xchg	ax, ax

loc_417C80:				; CODE XREF: sub_417C70+25j
		call	eax
		mov	eax, off_419190
		lea	edx, [eax+4]
		mov	eax, [eax+4]
		mov	off_419190, edx
		test	eax, eax
		jnz	short loc_417C80

loc_417C97:				; CODE XREF: sub_417C70+Cj
		add	esp, 0Ch
		retn
sub_417C70	endp

; ---------------------------------------------------------------------------
		align 10h
; START	OF FUNCTION CHUNK FOR sub_417CF0

loc_417CA0:				; CODE XREF: sub_417CF0+1Aj
		push	ebx
		sub	esp, 18h
		mov	ebx, ds:dword_4188F0
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_417CD3

loc_417CAF:				; CODE XREF: sub_417CF0-9j
		test	ebx, ebx
		jz	short loc_417CC2

loc_417CB3:				; CODE XREF: sub_417CF0-30j
		call	ds:dword_4188F0[ebx*4]
		sub	ebx, 1
		lea	esi, [esi+0]
		jnz	short loc_417CB3

loc_417CC2:				; CODE XREF: sub_417CF0-3Fj
		mov	[esp+1Ch+var_1C], offset sub_417C70 ; _onexit_t
		call	sub_4170D0
		add	esp, 18h
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_417CD3:				; CODE XREF: sub_417CF0-43j
		xor	ebx, ebx
		jmp	short loc_417CD9
; ---------------------------------------------------------------------------

loc_417CD7:				; CODE XREF: sub_417CF0-Bj
		mov	ebx, eax

loc_417CD9:				; CODE XREF: sub_417CF0-1Bj
		lea	eax, [ebx+1]
		mov	edx, ds:dword_4188F0[eax*4]
		test	edx, edx
		jnz	short loc_417CD7
		jmp	short loc_417CAF
; END OF FUNCTION CHUNK	FOR sub_417CF0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_417CF0	proc near		; CODE XREF: sub_401180+239p
					; sub_401695+Bp

var_1C		= dword	ptr -1Ch

; FUNCTION CHUNK AT 00417CA0 SIZE 00000049 BYTES

		mov	ecx, ds:dword_41D560
		test	ecx, ecx
		jz	short loc_417D00
		rep retn
; ---------------------------------------------------------------------------
		align 10h

loc_417D00:				; CODE XREF: sub_417CF0+8j
		mov	ds:dword_41D560, 1
		jmp	short loc_417CA0
sub_417CF0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_417D10	proc near		; CODE XREF: .text:004014BDp start+Dp

lpSystemTimeAsFileTime=	dword ptr -4Ch
var_30		= dword	ptr -30h
SystemTimeAsFileTime= _FILETIME	ptr -2Ch
PerformanceCount= LARGE_INTEGER	ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 4Ch
		mov	eax, dword_41919C
		mov	[esp+4Ch+var_10], ebx
		mov	[esp+4Ch+var_C], esi
		mov	[esp+4Ch+var_8], edi
		cmp	eax, 0BB40E64Eh
		mov	[esp+4Ch+var_4], ebp
		mov	[esp+4Ch+SystemTimeAsFileTime.dwLowDateTime], 0
		mov	[esp+4Ch+SystemTimeAsFileTime.dwHighDateTime], 0
		jz	short loc_417D60
		not	eax
		mov	dword_4191A0, eax

loc_417D46:				; CODE XREF: sub_417D10+BDj
		mov	ebx, [esp+4Ch+var_10]
		mov	esi, [esp+4Ch+var_C]
		mov	edi, [esp+4Ch+var_8]
		mov	ebp, [esp+4Ch+var_4]
		add	esp, 4Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_417D60:				; CODE XREF: sub_417D10+2Dj
		lea	eax, [esp+4Ch+SystemTimeAsFileTime]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		sub	esp, 4
		mov	eax, [esp+4Ch+SystemTimeAsFileTime.dwHighDateTime]
		mov	ebp, [esp+4Ch+SystemTimeAsFileTime.dwLowDateTime]
		mov	[esp+4Ch+var_30], eax
		call	ds:GetCurrentProcessId
		mov	edi, eax
		call	ds:GetCurrentThreadId
		mov	esi, eax
		call	ds:GetTickCount
		mov	ebx, eax
		lea	eax, [esp+4Ch+PerformanceCount]
		mov	[esp+4Ch+lpSystemTimeAsFileTime], eax ;	lpPerformanceCount
		call	ds:QueryPerformanceCounter
		sub	esp, 4
		xor	ebp, [esp+4Ch+var_30]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount]
		xor	ebp, dword ptr [esp+4Ch+PerformanceCount+4]
		xor	ebp, edi
		xor	ebp, esi
		xor	ebp, ebx
		mov	eax, ebp
		cmp	ebp, 0BB40E64Eh
		not	eax
		jz	short loc_417DD2

loc_417DC2:				; CODE XREF: sub_417D10+CCj
		mov	dword_41919C, ebp
		mov	dword_4191A0, eax
		jmp	loc_417D46
; ---------------------------------------------------------------------------

loc_417DD2:				; CODE XREF: sub_417D10+B0j
		mov	eax, 44BF19B0h
		mov	ebp, 0BB40E64Fh
		jmp	short loc_417DC2
sub_417D10	endp

; ---------------------------------------------------------------------------
		align 10h
		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		mov	eax, [ebp+4]
		lea	edx, [ebp+4]
		mov	ds:dword_41D644, edx
		mov	ds:dword_41D860, 0C0000409h
		mov	ds:dword_41D864, 1
		mov	ds:dword_41D638, eax
		mov	ds:dword_41D86C, eax
		mov	eax, [ebp+8]
		mov	dword ptr [esp], 0
		mov	ds:dword_41D62C, eax
		mov	eax, dword_41919C
		mov	[ebp-10h], eax
		mov	eax, dword_4191A0
		mov	[ebp-0Ch], eax
		call	ds:SetUnhandledExceptionFilter
		sub	esp, 4
		mov	dword ptr [esp], offset	off_41CDE4
		call	ds:UnhandledExceptionFilter
		sub	esp, 4
		call	ds:GetCurrentProcess
		mov	dword ptr [esp+4], 0C0000409h
		mov	[esp], eax
		call	ds:TerminateProcess
		sub	esp, 8
		call	abort
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_417E70	proc near		; CODE XREF: sub_418010+79p
					; sub_418010:loc_4180A2p

lpCriticalSection= dword ptr -2Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 1Ch
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ebx, ds:dword_41D8DC
		sub	esp, 4
		test	ebx, ebx
		jz	short loc_417EC5
		mov	ebp, ds:TlsGetValue
		mov	edi, ds:GetLastError
		lea	esi, [esi+0]

loc_417EA0:				; CODE XREF: sub_417E70+53j
		mov	eax, [ebx]
		mov	[esp+2Ch+lpCriticalSection], eax ; dwTlsIndex
		call	ebp ; TlsGetValue
		sub	esp, 4
		mov	esi, eax
		call	edi ; GetLastError
		test	eax, eax
		jnz	short loc_417EBE
		test	esi, esi
		jz	short loc_417EBE
		mov	eax, [ebx+4]
		mov	[esp+2Ch+lpCriticalSection], esi
		call	eax

loc_417EBE:				; CODE XREF: sub_417E70+40j
					; sub_417E70+44j
		mov	ebx, [ebx+8]
		test	ebx, ebx
		jnz	short loc_417EA0

loc_417EC5:				; CODE XREF: sub_417E70+1Fj
		mov	[esp+2Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		add	esp, 1Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
sub_417E70	endp

; ---------------------------------------------------------------------------
		align 10h
		sub	esp, 1Ch
		mov	eax, ds:dword_41D8C0
		mov	[esp+14h], ebx
		xor	ebx, ebx
		mov	[esp+18h], esi
		test	eax, eax
		jnz	short loc_417F04

loc_417EF6:				; CODE XREF: .text:00417F6Cj
		mov	eax, ebx
		mov	esi, [esp+18h]
		mov	ebx, [esp+14h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_417F04:				; CODE XREF: .text:00417EF4j
		mov	dword ptr [esp+4], 0Ch
		mov	dword ptr [esp], 1
		call	calloc
		test	eax, eax
		mov	esi, eax
		jz	short loc_417F67
		mov	eax, [esp+20h]
		mov	dword ptr [esp], offset	CriticalSection
		mov	[esi], eax
		mov	eax, [esp+24h]
		mov	[esi+4], eax
		call	ds:EnterCriticalSection
		mov	eax, ds:dword_41D8DC
		mov	ds:dword_41D8DC, esi
		mov	[esi+8], eax
		sub	esp, 4
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, ebx
		sub	esp, 4
		mov	ebx, [esp+14h]
		mov	esi, [esp+18h]
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_417F67:				; CODE XREF: .text:00417F1Cj
		mov	ebx, 0FFFFFFFFh
		jmp	short loc_417EF6
; ---------------------------------------------------------------------------
		align 10h
		push	ebx
		sub	esp, 18h
		mov	eax, ds:dword_41D8C0
		mov	ebx, [esp+20h]
		test	eax, eax
		jnz	short loc_417F88
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_417F88:				; CODE XREF: .text:00417F7Fj
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:EnterCriticalSection
		mov	edx, ds:dword_41D8DC
		sub	esp, 4
		test	edx, edx
		jz	short loc_417FBF
		mov	eax, [edx]
		cmp	eax, ebx
		jnz	short loc_417FB8
		jmp	short loc_417FF6
; ---------------------------------------------------------------------------
		align 10h

loc_417FB0:				; CODE XREF: .text:00417FBDj
		mov	ecx, [eax]
		cmp	ecx, ebx
		jz	short loc_417FD6
		mov	edx, eax

loc_417FB8:				; CODE XREF: .text:00417FA6j
		mov	eax, [edx+8]
		test	eax, eax
		jnz	short loc_417FB0

loc_417FBF:				; CODE XREF: .text:00417FA0j
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4

loc_417FCF:				; CODE XREF: .text:00417FF4j
		add	esp, 18h
		xor	eax, eax
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_417FD6:				; CODE XREF: .text:00417FB4j
		mov	ecx, [eax+8]
		mov	[edx+8], ecx

loc_417FDC:				; CODE XREF: .text:00418000j
		mov	[esp], eax
		call	free
		mov	dword ptr [esp], offset	CriticalSection
		call	ds:LeaveCriticalSection
		sub	esp, 4
		jmp	short loc_417FCF
; ---------------------------------------------------------------------------

loc_417FF6:				; CODE XREF: .text:00417FA8j
		mov	eax, [edx+8]
		mov	ds:dword_41D8DC, eax
		mov	eax, edx
		jmp	short loc_417FDC
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_418010	proc near		; CODE XREF: TlsCallback_1+33p
					; TlsCallback_0+E9p

lpCriticalSection= dword ptr -1Ch
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, [esp+1Ch+arg_4]
		cmp	eax, 1
		jz	short loc_418060
		jb	short loc_418030
		cmp	eax, 3
		jz	short loc_418080

loc_418023:				; CODE XREF: sub_418010+31j
					; sub_418010+4Dj ...
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_418030:				; CODE XREF: sub_418010+Cj
		mov	eax, ds:dword_41D8C0
		test	eax, eax
		jnz	short loc_4180A2

loc_418039:				; CODE XREF: sub_418010+97j
		mov	eax, ds:dword_41D8C0
		cmp	eax, 1
		jnz	short loc_418023
		mov	ds:dword_41D8C0, 0
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:DeleteCriticalSection
		sub	esp, 4
		jmp	short loc_418023
; ---------------------------------------------------------------------------
		align 10h

loc_418060:				; CODE XREF: sub_418010+Aj
		mov	eax, ds:dword_41D8C0
		test	eax, eax
		jz	short loc_418090

loc_418069:				; CODE XREF: sub_418010+90j
		mov	ds:dword_41D8C0, 1
		mov	eax, 1
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_418080:				; CODE XREF: sub_418010+11j
		mov	eax, ds:dword_41D8C0
		test	eax, eax
		jz	short loc_418023
		call	sub_417E70
		jmp	short loc_418023
; ---------------------------------------------------------------------------

loc_418090:				; CODE XREF: sub_418010+57j
		mov	[esp+1Ch+lpCriticalSection], offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSection
		sub	esp, 4
		jmp	short loc_418069
; ---------------------------------------------------------------------------

loc_4180A2:				; CODE XREF: sub_418010+27j
		call	sub_417E70
		jmp	short loc_418039
sub_418010	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4180B0	proc near		; CODE XREF: sub_401180+19p
					; sub_403264+Bp ...

arg_0		= byte ptr  4

		push	ecx
		push	eax
		cmp	eax, 1000h
		lea	ecx, [esp+8+arg_0]
		jb	short loc_4180D2

loc_4180BD:				; CODE XREF: sub_4180B0+20j
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		cmp	eax, 1000h
		ja	short loc_4180BD

loc_4180D2:				; CODE XREF: sub_4180B0+Bj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		pop	eax
		pop	ecx
		retn
sub_4180B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4180E0	proc near		; CODE XREF: sub_401EBC+2BBp
					; sub_40D855+2F2p

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 2Ch
		mov	edx, [esp+2Ch+arg_C]
		mov	[esp+2Ch+var_C], esi
		mov	ecx, [esp+2Ch+arg_8]
		mov	esi, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_10], ebx
		mov	ebx, [esp+2Ch+arg_4]
		test	edx, edx
		mov	[esp+2Ch+var_8], edi
		mov	edi, ecx
		mov	[esp+2Ch+var_4], ebp
		mov	[esp+2Ch+var_24], esi
		jnz	short loc_418148
		cmp	ecx, ebx
		ja	short loc_418170
		test	ecx, ecx
		jnz	short loc_418120
		mov	eax, 1
		xor	edx, edx
		div	ecx
		mov	ecx, eax

loc_418120:				; CODE XREF: sub_4180E0+33j
		mov	eax, ebx
		xor	edx, edx
		div	ecx
		mov	ebx, eax
		mov	eax, esi
		div	ecx
		mov	ecx, ebx
		mov	esi, eax

loc_418130:				; CODE XREF: sub_4180E0+6Ej
					; sub_4180E0+80j ...
		mov	eax, esi
		mov	edx, ecx
		mov	ebx, [esp+2Ch+var_10]
		mov	esi, [esp+2Ch+var_C]
		mov	edi, [esp+2Ch+var_8]
		mov	ebp, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------

loc_418148:				; CODE XREF: sub_4180E0+2Bj
		xor	ecx, ecx
		xor	esi, esi
		cmp	edx, ebx
		ja	short loc_418130
		bsr	ebp, edx
		xor	ebp, 1Fh
		jnz	short loc_418180
		cmp	edi, [esp+2Ch+var_24]
		jbe	short loc_418162
		cmp	edx, ebx
		jnb	short loc_418130

loc_418162:				; CODE XREF: sub_4180E0+7Cj
		xor	ecx, ecx
		mov	esi, 1
		jmp	short loc_418130
; ---------------------------------------------------------------------------
		align 10h

loc_418170:				; CODE XREF: sub_4180E0+2Fj
		mov	eax, esi
		mov	edx, ebx
		div	ecx
		xor	ecx, ecx
		mov	esi, eax
		jmp	short loc_418130
; ---------------------------------------------------------------------------
		align 10h

loc_418180:				; CODE XREF: sub_4180E0+76j
		mov	eax, 20h
		mov	ecx, ebp
		sub	eax, ebp
		mov	esi, edi
		shl	edx, cl
		mov	ecx, eax
		shr	esi, cl
		mov	ecx, ebp
		or	esi, edx
		mov	edx, ebx
		mov	[esp+2Ch+var_20], esi
		mov	esi, [esp+2Ch+var_24]
		shl	edi, cl
		mov	ecx, eax
		shr	edx, cl
		mov	ecx, ebp
		shl	ebx, cl
		mov	ecx, eax
		shr	esi, cl
		or	esi, ebx
		mov	eax, esi
		div	[esp+2Ch+var_20]
		mov	ebx, edx
		mov	esi, eax
		mul	edi
		cmp	ebx, edx
		jb	short loc_4181CF
		mov	edi, [esp+2Ch+var_24]
		mov	ecx, ebp
		shl	edi, cl
		cmp	edi, eax
		jnb	short loc_4181D2
		cmp	ebx, edx
		jnz	short loc_4181D2

loc_4181CF:				; CODE XREF: sub_4180E0+DDj
		sub	esi, 1

loc_4181D2:				; CODE XREF: sub_4180E0+E9j
					; sub_4180E0+EDj
		xor	ecx, ecx
		jmp	loc_418130
sub_4180E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4181E0	proc near		; CODE XREF: sub_40D855+2C6p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 2Ch
		mov	[esp+2Ch+var_4], ebp
		mov	ebp, [esp+2Ch+arg_C]
		mov	eax, [esp+2Ch+arg_0]
		mov	[esp+2Ch+var_10], ebx
		mov	ecx, [esp+2Ch+arg_8]
		mov	ebx, [esp+2Ch+arg_4]
		test	ebp, ebp
		mov	[esp+2Ch+var_C], esi
		mov	esi, eax
		mov	[esp+2Ch+var_8], edi
		mov	edi, ecx
		mov	[esp+2Ch+var_24], eax
		mov	edx, ebx
		jnz	short loc_418230
		cmp	ecx, ebx
		jbe	short loc_418252
		div	ecx

loc_418217:				; CODE XREF: sub_4181E0+8Bj
		mov	eax, edx
		xor	edx, edx

loc_41821B:				; CODE XREF: sub_4181E0+70j
					; sub_4181E0+92j ...
		mov	ebx, [esp+2Ch+var_10]
		mov	esi, [esp+2Ch+var_C]
		mov	edi, [esp+2Ch+var_8]
		mov	ebp, [esp+2Ch+var_4]
		add	esp, 2Ch
		retn
; ---------------------------------------------------------------------------
		align 10h

loc_418230:				; CODE XREF: sub_4181E0+2Fj
		cmp	ebp, ebx
		ja	short loc_418270
		bsr	eax, ebp
		xor	eax, 1Fh
		mov	[esp+2Ch+var_28], eax
		jnz	short loc_418274
		cmp	ecx, esi
		ja	loc_418308

loc_418248:				; CODE XREF: sub_4181E0+12Aj
		mov	edx, ebx
		sub	esi, ecx
		sbb	edx, ebp
		mov	eax, esi
		jmp	short loc_41821B
; ---------------------------------------------------------------------------

loc_418252:				; CODE XREF: sub_4181E0+33j
		test	ecx, ecx
		jnz	short loc_418261
		mov	eax, 1
		xor	edx, edx
		div	ecx
		mov	ecx, eax

loc_418261:				; CODE XREF: sub_4181E0+74j
		mov	eax, ebx
		xor	edx, edx
		div	ecx
		mov	eax, esi
		div	ecx
		jmp	short loc_418217
; ---------------------------------------------------------------------------
		align 10h

loc_418270:				; CODE XREF: sub_4181E0+52j
		mov	edx, ebx
		jmp	short loc_41821B
; ---------------------------------------------------------------------------

loc_418274:				; CODE XREF: sub_4181E0+5Ej
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		mov	esi, 20h
		mov	eax, ebp
		sub	esi, [esp+2Ch+var_28]
		mov	ebp, edi
		mov	edx, ebx
		shl	eax, cl
		mov	ecx, esi
		shr	ebp, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		or	ebp, eax
		mov	eax, [esp+2Ch+var_24]
		shl	edi, cl
		mov	ecx, esi
		shr	edx, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		mov	[esp+2Ch+var_20], edi
		shl	ebx, cl
		mov	ecx, esi
		shr	eax, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		or	eax, ebx
		mov	ebx, [esp+2Ch+var_24]
		div	ebp
		shl	ebx, cl
		mov	[esp+2Ch+var_24], ebx
		mov	ebx, edx
		mul	edi
		cmp	ebx, edx
		mov	edi, eax
		mov	ecx, edx
		jb	short loc_4182FC
		cmp	[esp+2Ch+var_24], eax
		jb	short loc_4182F8

loc_4182D3:				; CODE XREF: sub_4181E0+11Aj
					; sub_4181E0+126j
		mov	eax, [esp+2Ch+var_24]
		sub	eax, edi
		sbb	ebx, ecx
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		mov	edx, ebx
		shr	eax, cl
		mov	ecx, esi
		shl	edx, cl
		movzx	ecx, byte ptr [esp+2Ch+var_28]
		or	eax, edx
		mov	edx, ebx
		shr	edx, cl
		jmp	loc_41821B
; ---------------------------------------------------------------------------

loc_4182F8:				; CODE XREF: sub_4181E0+F1j
		cmp	ebx, edx
		jnz	short loc_4182D3

loc_4182FC:				; CODE XREF: sub_4181E0+EBj
		mov	ecx, edx
		mov	edi, eax
		sub	edi, [esp+2Ch+var_20]
		sbb	ecx, ebp
		jmp	short loc_4182D3
; ---------------------------------------------------------------------------

loc_418308:				; CODE XREF: sub_4181E0+62j
		cmp	ebp, ebx
		jb	loc_418248
		mov	eax, esi
		jmp	loc_41821B
sub_4181E0	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _mkdir]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _setmode]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _getpid]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fdopen]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _close]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _read]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _write]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _fileno]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _open]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _access]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _putenv]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _tzset]
		align 10h
		mov	eax, [esp+0Ch]
		mov	edx, [esp+8]
		mov	ecx, [esp+4]
		lock cmpxchg [ecx], edx
		retn
; ---------------------------------------------------------------------------
		jmp	short sub_4183A0
; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4183A0	proc near		; CODE XREF: sub_401180+A7p
					; .text:00418391j

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		mov	edx, [esp+arg_4]
		mov	ecx, [esp+arg_0]
		lock cmpxchg [ecx], edx
		retn	0Ch
sub_4183A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame fpd=222h

sub_4183C0	proc near		; CODE XREF: sub_4185A0+A6p

Size		= dword	ptr -348h
lpFilename	= dword	ptr -344h
nSize		= dword	ptr -340h
uType		= dword	ptr -33Ch
var_338		= dword	ptr -338h
var_334		= dword	ptr -334h
Filename	= byte ptr -327h
var_323		= dword	ptr -323h
var_31F		= word ptr -31Fh
var_223		= byte ptr -223h
var_222		= word ptr -222h
var_11D		= dword	ptr -11Dh
var_119		= dword	ptr -119h
var_115		= word ptr -115h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 33Ch
		mov	esi, [esp+348h+arg_0]
		lea	ebp, [esp+126h]
		mov	ebx, [esp+348h+arg_4]
		mov	[esp+348h+Size], 2000h ; Size
		call	malloc
		test	esi, esi
		lea	ecx, [esi+208h]
		mov	edi, eax
		mov	eax, ebp
		jnz	short loc_41840C
		jmp	short loc_418414
; ---------------------------------------------------------------------------
		align 10h

loc_418400:				; CODE XREF: sub_4183C0+52j
		add	esi, 2
		mov	[eax], dl
		add	eax, 1
		cmp	esi, ecx
		jz	short loc_418414

loc_41840C:				; CODE XREF: sub_4183C0+37j
		movzx	edx, word ptr [esi]
		test	dx, dx
		jnz	short loc_418400

loc_418414:				; CODE XREF: sub_4183C0+39j
					; sub_4183C0+4Aj
		lea	esi, [esp+348h+var_11D]
		test	ebx, ebx
		mov	byte ptr [eax],	0
		lea	ecx, [ebx+208h]
		mov	eax, esi
		jnz	short loc_41843C
		jmp	short loc_418444
; ---------------------------------------------------------------------------
		align 10h

loc_418430:				; CODE XREF: sub_4183C0+82j
		add	ebx, 2
		mov	[eax], dl
		add	eax, 1
		cmp	ebx, ecx
		jz	short loc_418444

loc_41843C:				; CODE XREF: sub_4183C0+68j
		movzx	edx, word ptr [ebx]
		test	dx, dx
		jnz	short loc_418430

loc_418444:				; CODE XREF: sub_4183C0+6Aj
					; sub_4183C0+7Aj
		mov	byte ptr [eax],	0
		cmp	byte ptr [esp+348h+var_11D], 0
		jz	loc_418500
		cmp	byte ptr [esp+348h+var_222], 0
		jz	loc_41852E

loc_418463:				; CODE XREF: sub_4183C0+168j
					; sub_4183C0+178j
		lea	ebx, [esp+348h+Filename]
		mov	[esp+348h+var_223], 0
		mov	[esp+348h+nSize], 104h ; nSize
		mov	[esp+348h+lpFilename], ebx ; lpFilename
		mov	[esp+348h+Size], 0 ; hModule
		call	ds:GetModuleFileNameA
		sub	esp, 0Ch
		test	eax, eax
		jz	loc_418540

loc_418493:				; CODE XREF: sub_4183C0+197j
		mov	eax, [esp+348h+arg_8]
		mov	[esp+348h+var_334], ebp
		mov	[esp+348h+uType], esi
		mov	[esp+348h+nSize], ebx
		mov	[esp+348h+var_338], eax
		mov	[esp+348h+lpFilename], offset aAssertionFaile ;	"Assertion failed!\n\nProgram: %s\nFile:"...
		mov	[esp+348h+Size], edi ; Dest
		call	sprintf
		mov	eax, ds:dword_41D540
		test	eax, eax
		jz	loc_418579
		mov	[esp+348h+uType], 12012h ; uType
		mov	[esp+348h+nSize], offset Caption ; "MinGW Runtime Assertion"
		mov	[esp+348h+lpFilename], edi ; lpText
		mov	[esp+348h+Size], 0 ; hWnd
		call	ds:MessageBoxA
		sub	esp, 10h
		cmp	eax, 3
		jz	short loc_418561
		cmp	eax, 5
		jnz	short loc_41855C
		add	esp, 33Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_418500:				; CODE XREF: sub_4183C0+8Fj
		cmp	byte ptr [esp+348h+var_222], 0
		mov	[esp+348h+var_11D], 6B6E753Ch
		mov	[esp+348h+var_119], 6E776F6Eh
		mov	[esp+348h+var_115], 3Eh
		jnz	loc_418463

loc_41852E:				; CODE XREF: sub_4183C0+9Dj
		mov	[esp+348h+var_222], 3Fh
		jmp	loc_418463
; ---------------------------------------------------------------------------
		align 10h

loc_418540:				; CODE XREF: sub_4183C0+CDj
		mov	dword ptr [esp+348h+Filename], 6B6E753Ch
		mov	[esp+348h+var_323], 6E776F6Eh
		mov	[esp+348h+var_31F], 3Eh
		jmp	loc_418493
; ---------------------------------------------------------------------------

loc_41855C:				; CODE XREF: sub_4183C0+133j
		call	abort
; ---------------------------------------------------------------------------

loc_418561:				; CODE XREF: sub_4183C0+12Ej
		mov	[esp+348h+Size], 16h
		call	raise
		mov	[esp+348h+Size], 3 ; Code
		call	_exit
; ---------------------------------------------------------------------------

loc_418579:				; CODE XREF: sub_4183C0+101j
		mov	eax, ds:_iob
		mov	[esp+348h+nSize], edi
		mov	[esp+348h+lpFilename], offset aS_2 ; "%s\n"
		add	eax, 40h
		mov	[esp+348h+Size], eax ; File
		call	fprintf
		call	abort
sub_4183C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_4185A0(char *, char *, int)
sub_4185A0	proc near		; CODE XREF: sub_402192+46p
					; sub_40278B+67p ...

Str		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Memory		= dword	ptr -24h
var_20		= dword	ptr -20h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		push	edi
		push	esi
		push	ebx
		sub	esp, 2Ch
		mov	edi, [esp+3Ch+arg_0]
		mov	edx, [esp+3Ch+arg_8]
		mov	esi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+Str], edi ; Str
		mov	[esp+3Ch+var_20], edx
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		mov	[esp+3Ch+Str], esi ; Str
		mov	ebx, eax
		call	strlen
		lea	eax, [eax+eax+2]
		mov	[esp+3Ch+Str], eax ; Size
		call	malloc
		movzx	ecx, byte ptr [edi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_418606
		xor	ebp, ebp
		lea	esi, [esi+0]

loc_4185F0:				; CODE XREF: sub_4185A0+62j
		add	edx, 1
		movzx	ecx, cl
		mov	[ebx+ebp*2], cx
		movzx	ecx, byte ptr [edi+edx]
		mov	ebp, edx
		test	cl, cl
		jnz	short loc_4185F0
		add	edx, edx

loc_418606:				; CODE XREF: sub_4185A0+48j
		mov	word ptr [ebx+edx], 0
		movzx	ecx, byte ptr [esi]
		xor	edx, edx
		test	cl, cl
		jz	short loc_41862D
		xor	edi, edi

loc_418617:				; CODE XREF: sub_4185A0+89j
		add	edx, 1
		movzx	ecx, cl
		mov	[eax+edi*2], cx
		movzx	ecx, byte ptr [esi+edx]
		mov	edi, edx
		test	cl, cl
		jnz	short loc_418617
		add	edx, edx

loc_41862D:				; CODE XREF: sub_4185A0+73j
		mov	word ptr [eax+edx], 0
		mov	edx, [esp+3Ch+var_20]
		mov	[esp+3Ch+var_38], eax
		mov	[esp+3Ch+Memory], eax
		mov	[esp+3Ch+Str], ebx
		mov	[esp+3Ch+var_34], edx
		call	sub_4183C0
		mov	[esp+3Ch+Str], ebx ; Memory
		call	free
		mov	eax, [esp+3Ch+Memory]
		mov	[esp+3Ch+arg_0], eax ; Memory
		add	esp, 2Ch
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		jmp	free
sub_4185A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_418670	proc near		; CODE XREF: .text:00404EACp
					; sub_40A632+Dp ...
		jmp	sub_4186C0
sub_418670	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000005 BYTES: COLLAPSED FUNCTION j__lseeki64]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_418690	proc near		; CODE XREF: .text:0040A6B2p
					; .text:0040AC82p ...
		jmp	sub_4186D0
sub_418690	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_4186A0	proc near		; CODE XREF: .text:0040A97Cp
					; sub_416882+2Dp
		jmp	sub_4186E0
sub_4186A0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: thunk

sub_4186B0	proc near		; CODE XREF: .text:0040AFFBp
					; sub_411606+AAp
		jmp	sub_4186F0
sub_4186B0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4186C0	proc near		; CODE XREF: sub_418670j
		mov	eax, ds:time
		jmp	eax
sub_4186C0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4186D0	proc near		; CODE XREF: sub_418690j
		mov	eax, ds:gmtime
		jmp	eax
sub_4186D0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4186E0	proc near		; CODE XREF: sub_4186A0j
		mov	eax, ds:mktime
		jmp	eax
sub_4186E0	endp

; ---------------------------------------------------------------------------
		align 10h

; =============== S U B	R O U T	I N E =======================================


sub_4186F0	proc near		; CODE XREF: sub_4186B0j
		mov	eax, ds:localtime
		jmp	eax
sub_4186F0	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __getmainargs]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __set_app_type]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION malloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strlen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _cexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION free]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strcpy]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strerror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION remove]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strstr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strrchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION memcmp]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION realloc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION calloc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION memset]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fread]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION ferror]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fwrite]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fseek]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION ftell]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fflush]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fclose]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION memchr]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION abort]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION atoi]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION sprintf]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strftime]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION getenv]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION fopen]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION setvbuf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncpy]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION putc]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION fputs]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION vfprintf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION getc]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strpbrk]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strncmp]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION printf]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strtol]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION strtoul]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION putchar]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION puts]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION strcat]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION signal]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __setusermatherr]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION raise]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _exit]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _lseeki64]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_4188D0	proc near		; DATA XREF: .text:004188F4o

var_18		= dword	ptr -18h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		call	sub_4014F0
		mov	[esp+18h+var_18], offset sub_401540 ; _onexit_t
		call	sub_4170D0
		leave
		retn
sub_4188D0	endp

; ---------------------------------------------------------------------------
		align 10h
dword_4188F0	dd 0FFFFFFFFh		; DATA XREF: sub_417CF0-4Cr
					; sub_417CF0:loc_417CB3r ...
		dd offset sub_4188D0
		dd 0
		dd 0FFFFFFFFh
dword_418900	dd 40h dup(0)		; DATA XREF: .data:off_419190o
		dd 180h	dup(?)
_text		ends

; Section 2. (virtual address 00019000)
; Virtual size			: 000001A8 (	424.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00017E00
; Flags	C0600040: Data Readable	Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 419000h
dword_419000	dd 12Ch, 2 dup(0)	; DATA XREF: sub_401695+1C7o
		dd offset a@commands	; "@Commands:\n	"
		dd 65h,	41A051h, 80h, 41A059h, 64h, 41A06Bh, 80h, 41A073h
		dd 73h,	41A086h, 80h, 41A08Bh, 74h, 41A0A3h, 80h, 41A0B0h
		dd 12Dh, 2 dup(0)
		dd offset a@Options	; "@\nOptions:\n "
		dd 63h,	41A0CDh, 0
		dd offset aUseSymmetricEn ; "use symmetric encryption"
		dd 72h,	41A0F0h, 2, 41A0FAh, 75h, 41A117h, 2, 41A124h
		dd 6Fh,	41A14Ch, 2, 41A153h, 76h, 41A16Eh, 0
		dd offset aVerbose	; "verbose"
		dd 71h,	41A176h, 0
		dd offset aBeSomewhatMore ; "be	somewhat more quiet"
		dd 1F6h, 41A193h, 0
		dd offset aSkipTheCryptoP ; "skip the crypto processing"
		dd 1F9h, 41A1BAh, 2, 41A1C7h, 54h, 41A1C9h, 2, 41A1D4h
		dd 1FAh, 41A1F8h, 0
		dd offset aTReadsNullTerm ; "-T	reads null-terminated names"
		dd 1F7h, 41A21Fh, 0
		dd offset a@		; "@"
		dd 1F8h, 41A227h, 0
		dd offset a@		; "@"
		align 40h
off_419140	dd offset sub_405837	; DATA XREF: sub_4074CE+8Er
					; .text:00407D49r ...
off_419144	dd offset sub_4058B7	; DATA XREF: sub_4074CE+98r
					; .text:00407D53r ...
off_419148	dd offset sub_405B3B	; DATA XREF: sub_4074CE+A2r
					; .text:00407D5Dr ...
off_41914C	dd offset sub_405DC0	; DATA XREF: sub_4074CE+ACr
					; .text:00407D67r ...
off_419150	dd offset sub_405E5D	; DATA XREF: sub_407B8B+83r
					; sub_408034+7Br ...
off_419154	dd offset sub_405EB3	; DATA XREF: sub_407B8B+8Dr
					; sub_408034+85r ...
off_419158	dd offset sub_405F08	; DATA XREF: sub_407B8B+97r
					; sub_408034+8Fr ...
off_41915C	dd offset sub_405F9A	; DATA XREF: sub_407B8B+A1r
					; sub_407B8B+103r ...
off_419160	dd offset sub_406069	; DATA XREF: sub_408169+A5r
off_419164	dd offset sub_4060D0	; DATA XREF: sub_408169+AFr
off_419168	dd offset sub_406127	; DATA XREF: sub_408169+B9r
off_41916C	dd offset sub_4061B1	; DATA XREF: sub_408169+C3r
					; sub_408169+F5r
; LPCSTR off_419170
off_419170	dd offset aShell32_dll	; DATA XREF: sub_40BB99+30r
					; sub_40BB99+90r
					; "shell32.dll"
		dd offset aShfolder_dll	; "shfolder.dll"
		dd 0
dword_41917C	dd 0FFFFFFFFh		; DATA XREF: sub_4111E5:loc_41136Bw
					; .text:loc_41159Fr ...
; char off_419180[]
off_419180	dd offset aIso88591	; DATA XREF: sub_41586C+D9w
					; sub_41596B:loc_415B40w ...
					; "iso-8859-1"
		dd 0FFh, 2 dup(0FFFFFFFFh)
off_419190	dd offset dword_418900	; DATA XREF: sub_417C70+3r
					; sub_417C70+12r ...
dword_419194	dd 2			; DATA XREF: TlsCallback_0+13r
					; TlsCallback_0+1Cw ...
dword_419198	dd 0FFFFFFFFh		; DATA XREF: sub_401060+7Ar
dword_41919C	dd 0BB40E64Eh		; DATA XREF: sub_417D10+3r
					; sub_417D10:loc_417DC2w ...
dword_4191A0	dd 44BF19B1h		; DATA XREF: sub_417D10+31w
					; sub_417D10+B8w ...
dword_4191A4	dd 0			; DATA XREF: sub_4014F0+6r
					; sub_4014F0+42o
		align 1000h
_data		ends

; Section 3. (virtual address 0001A000)
; Virtual size			: 00002E4C (  11852.)
; Section size in file		: 00003000 (  12288.)
; Offset to raw	data for section: 00018000
; Flags	40300040: Data Readable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 41A000h
; CHAR ProcName[]
ProcName	db '_set_invalid_parameter_handler',0 ; DATA XREF: sub_401180+137o
		align 10h
; CHAR ModuleName[]
ModuleName	db 'libgcj-12.dll',0    ; DATA XREF: sub_4014F0+Fo
; CHAR a_jv_registercl[]
a_jv_registercl	db '_Jv_RegisterClasses',0 ; DATA XREF: sub_4014F0+28o
		align 4
a@commands	db '@Commands:',0Ah     ; DATA XREF: .data:0041900Co
		db ' ',0
aEncrypt	db 'encrypt',0
aCreateAnArchiv	db 'create an archive',0
aDecrypt	db 'decrypt',0
aExtractAnArchi	db 'extract an archive',0
aSign		db 'sign',0
aCreateASignedA	db 'create a signed archive',0
aListArchive	db 'list-archive',0
aListAnArchive	db 'list an archive',0
a@Options	db '@',0Ah              ; DATA XREF: .data:0041905Co
		db 'Options:',0Ah
		db ' ',0
aSymmetric	db 'symmetric',0
aUseSymmetricEn	db 'use symmetric encryption',0 ; DATA XREF: .data:0041906Co
aRecipient	db 'recipient',0
aUserIdEncryptF	db '|USER-ID|encrypt for USER-ID',0
aLocalUser	db 'local-user',0
		align 4
aUserIdUseUserI	db '|USER-ID|use USER-ID to sign or decrypt',0
aOutput		db 'output',0
aFileWriteOutpu	db '|FILE|write output to FILE',0
aVerbose	db 'verbose',0          ; DATA XREF: .data:004190ACo
aQuiet		db 'quiet',0
aBeSomewhatMore	db 'be somewhat more quiet',0 ; DATA XREF: .data:004190BCo
aSkipCrypto	db 'skip-crypto',0
aSkipTheCryptoP	db 'skip the crypto processing',0 ; DATA XREF: .data:004190CCo
aSetFilename	db 'set-filename',0
a@		db '@',0                ; DATA XREF: .data:0041910Co
					; .data:0041911Co
aFilesFrom	db 'files-from',0
aFileGetNamesTo	db '|FILE|get names to create from FILE',0
aNull_0		db 'null',0
		align 10h
aTReadsNullTerm	db '-T reads null-terminated names',0 ; DATA XREF: .data:004190FCo
aOpenpgp	db 'openpgp',0
aCms		db 'cms',0
aGpgtarGnupg	db 'gpgtar (GnuPG)',0   ; DATA XREF: sub_4015A7:loc_4015C2o
a2_0_30		db '2.0.30',0           ; DATA XREF: sub_4015A7:loc_4015CBo
aMingw32	db 'MingW32',0          ; DATA XREF: sub_4015A7:loc_4015D4o
		align 4
; char aPleaseReportBu[]
aPleaseReportBu	db 'Please report bugs to <@EMAIL@>.',0Ah,0
					; DATA XREF: sub_4015A7:loc_4015DDo
		align 10h
; char aUsageGpgtarOpt[]
aUsageGpgtarOpt	db 'Usage: gpgtar [options] [files] [directories] (-h for help)',0
					; DATA XREF: sub_4015A7:loc_4015EEo
; char aSyntaxGpgtarOp[]
aSyntaxGpgtarOp	db 'Syntax: gpgtar [options] [files] [directories]',0Ah
					; DATA XREF: sub_4015A7:loc_4015FFo
		db 'Encrypt or sign files into an archive',0Ah,0
		align 4
off_41A304	dd offset loc_401610	; DATA XREF: sub_4015A7+12o
		dd offset loc_4015EE	; jump table for switch	statement
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_4015C2
		dd offset loc_401610
		dd offset loc_4015CB
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_4015D4
		dd offset loc_401610
		dd offset loc_4015DD
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_401610
		dd offset loc_4015EE
		dd offset loc_4015FF
; char aConflictingCom[]
aConflictingCom	db 'conflicting commands',0Ah,0 ; DATA XREF: sub_40161D:loc_40166Bo
; char aGpgtar[]
aGpgtar		db 'gpgtar',0           ; DATA XREF: sub_401695+38o
					; sub_401695+58o
		align 4
; char aFilesFromAndNu[]
aFilesFromAndNu	db '--files-from and --null may only be used in conjunction',0Ah,0
					; DATA XREF: sub_401695:loc_4018ACo
asc_41A405	db '-',0                ; DATA XREF: sub_401695+230o
		align 4
; char aFilesFromOnlyS[]
aFilesFromOnlyS	db '--files-from only supports argument "-"',0Ah,0
					; DATA XREF: sub_401695+253o
		align 4
; char aNoteIgnoringOp[]
aNoteIgnoringOp	db 'note: ignoring option --set-filename',0Ah,0 ; DATA XREF: sub_401695+2CFo
					; sub_401695+348o
		align 4
; char aNoteIgnoring_0[]
aNoteIgnoring_0	db 'note: ignoring option --files-from',0Ah,0 ; DATA XREF: sub_401695+2E2o
					; sub_401695+3C7o
; char aNoteIgnoring_1[]
aNoteIgnoring_1	db 'note: ignoring option --output',0Ah,0 ; DATA XREF: sub_401695+3B4o
; char aInvalidCommand[]
aInvalidCommand	db 'invalid command (there is no implicit command)',0Ah,0
					; DATA XREF: sub_401695:loc_401AA2o
; char aErrorReadingSS[]
aErrorReadingSS	db 'error reading `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_401AD2+6Co
; char aErrorReadingSP[]
aErrorReadingSP	db 'error reading `%s',27h,': premature EOF (size of last record: %zu)',0Ah
					; DATA XREF: sub_401AD2+90o
		db 0
; char aErrorWritingSS[]
aErrorWritingSS	db 'error writing `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_401B80+5Do
		align 10h
; char aTar_and_encryp[]
aTar_and_encryp	db 'tar_and_encrypt has not yet been implemented',0Ah,0
					; DATA XREF: sub_401BFB+6o
		align 10h
; char aDecrypt_and_un[]
aDecrypt_and_un	db 'decrypt_and_untar has not yet been implemented',0Ah,0
					; DATA XREF: sub_401C0F+6o
; char aDecrypt_and_li[]
aDecrypt_and_li	db 'decrypt_and_list has not yet been implemented',0Ah,0
					; DATA XREF: sub_401C23+6o
		align 10h
; char aErrorUtf8IngSS[]
aErrorUtf8IngSS	db 'error utf8-ing `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_401EBC+8Co
; char aErrorStatIngSS[]
aErrorStatIngSS	db 'error stat-ing `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_401EBC+DFo
		align 4
; char a____Gnupg22_0_[]
a____Gnupg22_0_	db '../../gnupg2-2.0.30/tools/gpgtar-create.c',0 ; DATA XREF: sub_402192+37o
					; sub_40278B+58o ...
; char aDnamelen[]
aDnamelen	db 'dnamelen',0         ; DATA XREF: sub_402192+3Fo
asc_41A637	db '/',0                ; DATA XREF: sub_402302+79o
asc_41A639	db '/*',0               ; DATA XREF: sub_402302+9Co
					; sub_402302+188o
a_		db '.',0                ; DATA XREF: sub_402302+BBo
					; sub_402302+31Fo
asc_41A63E	db '*',0                ; DATA XREF: sub_402302+DEo
					; sub_402302+12Do
; char aErrorReadingDi[]
aErrorReadingDi	db 'error reading directory `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_402302+21Ao
					; sub_402302+277o ...
; char aErrorUtf8IngFi[]
aErrorUtf8IngFi	db 'error utf8-ing filename: %s',0Ah,0 ; DATA XREF: sub_402302+2E3o
a__		db '..',0               ; DATA XREF: sub_402302+347o
a__0		db './',0               ; DATA XREF: sub_402302+378o
		align 4
; char aDirectoriesToo[]
aDirectoriesToo	db 'directories too deeply nested',0Ah,0 ; DATA XREF: sub_40278B+1Ao
; char aScanctrlFlist_[]
aScanctrlFlist_	db 'scanctrl->flist_tail',0 ; DATA XREF: sub_40278B+60o
; char aScanningDirect[]
aScanningDirect	db 'scanning directory `%s',27h,0Ah,0 ; DATA XREF: sub_40278B+B9o
; char aLength1[]
aLength1	db 'length > 1',0       ; DATA XREF: sub_402921+28o
aUser		db 'user',0             ; DATA XREF: sub_402ABC+1Fo
aRoot		db 'root',0             ; DATA XREF: sub_402ABC:loc_402AE2o
					; sub_402B1B:loc_402B41o
aUsers		db 'users',0            ; DATA XREF: sub_402B1B+1Fo
; char aErrorStoringFi[]
aErrorStoringFi	db 'error storing file `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_402B7A+176o
aUstar		db 'ustar',0            ; DATA XREF: sub_402B7A:loc_402E49o
		align 4
off_41A714	dd offset loc_402DE4	; DATA XREF: sub_402B7A+261r
		dd offset loc_402DF0	; jump table for switch	statement
		dd offset loc_402DFC
		dd offset loc_402E08
		dd offset loc_402E14
		dd offset loc_402E20
		dd offset loc_402E2C
; char aSkippingUnsupp[]
aSkippingUnsupp	db 'skipping unsupported file `%s',27h,0Ah,0 ; DATA XREF: sub_402F43+42o
aRb		db 'rb',0               ; DATA XREF: sub_402F43+67o
		align 4
; char aCanTOpenSSSkip[]
aCanTOpenSSSkip	db 'can',27h,'t open `%s',27h,': %s - skipped',0Ah,0
					; DATA XREF: sub_402F43+A8o
aFileShrunk?	db ' (file shrunk?)',0  ; DATA XREF: sub_402F43+191o
byte_41A783	db 0			; DATA XREF: sub_402F43:loc_4030DBo
; char aErrorReadingFi[]
aErrorReadingFi	db 'error reading file `%s',27h,': %s%s',0Ah,0 ; DATA XREF: sub_402F43+1BAo
; char aNoteFileSHasGr[]
aNoteFileSHasGr	db 'note: file `%s',27h,' has grown',0Ah,0 ; DATA XREF: sub_402F43+251o
; char aErrorClosingFi[]
aErrorClosingFi	db 'error closing file `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_402F43+2A3o
aStdin		db '[stdin]',0          ; DATA XREF: sub_403264+11Co
					; sub_403264+161o
; char aErrorReading_0[]
aErrorReading_0	db 'error reading `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_403264+124o
					; sub_403264+169o
aFilenameTooLon	db 'filename too long',0 ; DATA XREF: sub_403264+159o
		align 10h
; char aMemoryAllocati[]
aMemoryAllocati	db 'memory allocation problem: %s',0Ah,0 ; DATA XREF: sub_403264+1E4o
; char aScanningS[]
aScanningS	db 'scanning `%s',27h,0Ah,0 ; DATA XREF: sub_403264+22Co
; char aSkippingInvali[]
aSkippingInvali	db 'skipping invalid name `%s',27h,0Ah,0 ; DATA XREF: sub_403264+25Do
asc_41A85A	db '-',0                ; DATA XREF: sub_403264+2E5o
aWb		db 'wb',0               ; DATA XREF: sub_403264:loc_40357Do
; char aCanTCreateSS[]
aCanTCreateSS	db 'can',27h,'t create `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_403264+353o
		align 4
; char aCreatingTarbal[]
aCreatingTarbal	db 'creating tarball `%s',27h,' failed: %s',0Ah,0
					; DATA XREF: sub_403264+45Eo
aStore_xoctal	db 'store_xoctal',0     ; DATA XREF: sub_402921+14Fo
					; sub_402921:loc_402A9Eo
		align 4
asc_41A8A8	db '/',0                ; DATA XREF: sub_4037A4+25o
					; sub_403A04+3Eo
; char aErrorCreatingF[]
aErrorCreatingF	db 'error creating filename: %s',0Ah,0 ; DATA XREF: sub_4037A4+58o
					; sub_403A04+71o
aWb_0		db 'wb',0               ; DATA XREF: sub_4037A4+70o
; char aErrorCreatingS[]
aErrorCreatingS	db 'error creating `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_4037A4+ABo
; char aErrorWriting_0[]
aErrorWriting_0	db 'error writing `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_4037A4+19Fo
; char aExtractedS[]
aExtractedS	db 'extracted `%s',27h,0Ah,0 ; DATA XREF: sub_4037A4+1EBo
		align 4
; char aErrorRemovingI[]
aErrorRemovingI	db 'error removing incomplete file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_4037A4+23Bo
aRwx		db '-rwx------',0       ; DATA XREF: sub_403A04:loc_403AE1o
					; sub_403A04+130o ...
; char aErrorCreatingD[]
aErrorCreatingD	db 'error creating directory `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_403A04+1B5o
; char aCreatedS[]
aCreatedS	db 'created   `%s/',27h,0Ah,0 ; DATA XREF: sub_403A04+1D7o
; char aFilenameSConta[]
aFilenameSConta	db 'filename `%s',27h,' contains a backslash - can',27h,'t extract on this '
					; DATA XREF: sub_403BFB+5Bo
		db 'system',0Ah,0
; char SubStr[]
SubStr		db '//',0               ; DATA XREF: sub_403BFB+88o
; char a___0[]
a___0		db '/../',0             ; DATA XREF: sub_403BFB+A2o
a___1		db '../',0              ; DATA XREF: sub_403BFB+BEo
a___2		db '/..',0              ; DATA XREF: sub_403BFB+F7o
		align 4
; char aFilenameSAsSus[]
aFilenameSAsSus	db 'filename `%s',27h,' as suspicious parts - not extracting',0Ah,0
					; DATA XREF: sub_403BFB+124o
; char aUnsupportedFil[]
aUnsupportedFil	db 'unsupported file type %d for `%s',27h,' - skipped',0Ah,0
					; DATA XREF: sub_403BFB+1ADo
a_gpg		db '.gpg',0             ; DATA XREF: sub_403E11+51o
a_pgp		db '.pgp',0             ; DATA XREF: sub_403E11+72o
a_asc		db '.asc',0             ; DATA XREF: sub_403E11+8Fo
a_pem		db '.pem',0             ; DATA XREF: sub_403E11+ACo
a_p7m		db '.p7m',0             ; DATA XREF: sub_403E11+C9o
a_p7e		db '.p7e',0             ; DATA XREF: sub_403E11+E6o
aS_D_		db '%s_%d_',0           ; DATA XREF: sub_403E11+14Fo
		align 10h
; char aErrorCreatingA[]
aErrorCreatingA	db 'error creating an extract directory: %s',0Ah,0
					; DATA XREF: sub_403E11+1E3o
asc_41AA79	db '-',0                ; DATA XREF: sub_404026+2Co
aRb_0		db 'rb',0               ; DATA XREF: sub_404026:loc_404086o
; char aErrorOpeningSS[]
aErrorOpeningSS	db 'error opening `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_404026+9Bo
aGpgarch	db 'GPGARCH',0          ; DATA XREF: sub_404026:loc_40419Co
; char aExtractingToS[]
aExtractingToS	db 'extracting to `%s/',27h,0Ah,0 ; DATA XREF: sub_404026+1B2o
		align 4
; char aSInvalidOctalN[]
aSInvalidOctalN	db '%s: invalid octal number encountered - assuming 0',0Ah,0
					; DATA XREF: sub_4042BF+114o
aUstar_0	db 'ustar',0            ; DATA XREF: sub_404407+1Co
		align 10h
; char aSWarningNameNo[]
aSWarningNameNo	db '%s: warning: name not terminated by a nul byte',0Ah,0
					; DATA XREF: sub_404407+8Ao
; char aSWarningGarbag[]
aSWarningGarbag	db '%s: warning: garbage after name',0Ah,0 ; DATA XREF: sub_404407+B7o
		align 4
; char aSWarningPrefix[]
aSWarningPrefix	db '%s: warning: prefix not terminated by a nul byte',0Ah,0
					; DATA XREF: sub_404407+123o
		align 4
; char aSWarningGarb_0[]
aSWarningGarb_0	db '%s: warning: garbage after prefix',0Ah,0 ; DATA XREF: sub_404407+153o
		align 4
; char aSErrorAllocati[]
aSErrorAllocati	db '%s: error allocating header: %s',0Ah,0 ; DATA XREF: sub_404407+1B4o
		align 10h
off_41ABC0	dd offset loc_40473C	; DATA XREF: sub_404407+32Cr
		dd offset loc_404748	; jump table for switch	statement
		dd offset loc_404754
		dd offset loc_404760
		dd offset loc_40476C
		dd offset loc_404778
		dd offset loc_404784
		dd offset loc_404790
; char aSWarningSkippi[]
aSWarningSkippi	db '%s: warning: skipping empty header',0Ah,0 ; DATA XREF: sub_4047F5+C3o
aSLuLuLu12lluSS	db '%s %lu %lu/%lu %12llu %s %s',0Ah,0 ; DATA XREF: sub_40494C+148o
aRwxrwxrwx	db 'rwxrwxrwx',0        ; DATA XREF: sub_40494C+78o
		align 4
off_41AC2C	dd offset loc_40496D	; DATA XREF: sub_40494C+18r
		dd offset loc_404973	; jump table for switch	statement
		dd offset loc_404979
		dd offset loc_40497F
		dd offset loc_404985
		dd offset loc_40498B
		dd offset loc_404991
		dd offset loc_404997
		dd offset loc_40499D
		dd offset loc_40499D
byte_41AC54	db 2Dh,	0		; DATA XREF: sub_404AD9+17o
word_41AC56	dw 6272h		; DATA XREF: sub_404AD9:loc_404B24o
		db 0
; char aErrorOpening_0[]
aErrorOpening_0	db 'error opening `%s',27h,': %s',0Ah,0 ; DATA XREF: sub_404AD9+86o
		align 4
; char aErrorAllocatin[]
aErrorAllocatin	db 'error allocating enough memory: %s',0Ah,0 ; DATA XREF: sub_404C7C+1Ao
; char aFailedToTransl[]
aFailedToTransl	db 'failed to translate osfhandle %p',0Ah,0 ; DATA XREF: sub_404EFF+3Eo
a_tmp		db '.tmp',0             ; DATA XREF: .text:00405100o
aWB		db 'w+b',0              ; DATA XREF: .text:loc_40519Ao
		align 4
aGnupg_allow_se	db 'gnupg_allow_set_foregound_window',0 ; DATA XREF: .text:00405233o
		align 4
aSCalledWithInv	db '%s called with invalid pid %lu',0Ah,0 ; DATA XREF: .text:0040523Bo
aAllowsetforegr	db 'AllowSetForegroundWindow(%lu) failed: %s',0Ah,0
					; DATA XREF: .text:00405281o
		align 4
; char aGnupg2[]
aGnupg2		db 'gnupg2',0           ; DATA XREF: sub_405474+Fo
		align 4
; char a____Gnupg22__0[]
a____Gnupg22__0	db '../../gnupg2-2.0.30/common/estream.c',0 ; DATA XREF: sub_4058B7+4Do
					; sub_4058B7+1CBo ...
		align 4
; char aMem_cookieMemo[]
aMem_cookieMemo	db 'mem_cookie->memory_size >= mem_cookie->offset',0
					; DATA XREF: sub_4058B7+55o
					; sub_4058B7+1D3o
; char aSizeNleft[]
aSizeNleft	db 'size <= nleft',0    ; DATA XREF: sub_4058B7+20Co
; char aStreamFlags_wr[]
aStreamFlags_wr	db 'stream->flags.writing',0 ; DATA XREF: sub_4064AC+35o
; char aStreamFlags__0[]
aStreamFlags__0	db '!stream->flags.writing',0 ; DATA XREF: sub_406645+24o
aR		db 'r',0                ; DATA XREF: sub_40831E+C2o
					; sub_40831E+16Ao ...
aA		db 'a',0                ; DATA XREF: sub_40831E+FDo
					; sub_40831E+132o ...
		align 4
; char Format[]
Format		db 'fatal: error creating a dummy estream for %d: %s',0Ah,0
					; DATA XREF: sub_40831E+22Fo
; char aStdout[]
aStdout		db '[stdout]',0         ; DATA XREF: sub_40831E+2CCo
aStderr		db '[stderr]',0         ; DATA XREF: sub_40831E:loc_4085F1o
aStdin_0	db '[stdin]',0          ; DATA XREF: sub_40831E:loc_4085F8o
a_estream	db '_estream',0         ; DATA XREF: sub_40981F+BAo
a_tmp_0		db '.tmp',0             ; DATA XREF: sub_40981F+165o
a?		db '[?]',0              ; DATA XREF: sub_409E27+5Fo
aX02x		db 'x%02x',0            ; DATA XREF: sub_409E92+307o
aEstream_asprin	db 'estream_asprintf failed: %s',0Ah,0 ; DATA XREF: .text:0040A5A0o
		align 4
a04d02d02dt02d0	db '%04d%02d%02dT%02d%02d%02d',0 ; DATA XREF: .text:0040A6FEo
					; .text:0040ACCEo ...
aGnupg_get_time	db 'gnupg_get_time() failed',0Ah,0 ; DATA XREF: .text:0040A7D4o
aUyUdUhUm	db '%uy%ud%uh%um',0     ; DATA XREF: .text:0040ADE4o
a????????	db '????-??-??',0       ; DATA XREF: .text:0040AE6Eo
					; .text:0040AFC4o
a04d02d02d	db '%04d-%02d-%02d',0   ; DATA XREF: .text:0040AEC3o
a??????????????	db '????-??-?? ??:??:??',0 ; DATA XREF: sub_40AEEF+16o
; char a04d02d02d02d02[]
a04d02d02d02d02	db '%04d-%02d-%02d %02d:%02d:%02d',0 ; DATA XREF: sub_40AEEF+85o
aCZ		db '%c %Z',0            ; DATA XREF: .text:0040B006o
		align 4
a____Gnupg22__1	db '../../gnupg2-2.0.30/common/gettime.c',0 ; DATA XREF: sub_40B0BD+E7o
aNone		db '[none]',0           ; DATA XREF: .text:loc_40B4D1o
a_4s_2s_2s_2s_2	db '%.4s-%.2s-%.2s %.2s:%.2s:%s',0 ; DATA XREF: .text:0040B520o
aDays_per_month	db 'days_per_month',0   ; DATA XREF: sub_40B0BD:loc_40B194o
		align 4
; CHAR aShgetfolderpat[]
aShgetfolderpat	db 'SHGetFolderPathA',0 ; DATA XREF: sub_40BB99+50o
aHome		db '\home',0            ; DATA XREF: sub_40BC73+31o
aGnupg		db '\gnupg',0           ; DATA XREF: sub_40BC73+BAo
aCGnupg		db 'c:/gnupg',0         ; DATA XREF: sub_40BC73:loc_40BD97o
					; .text:loc_40BE81o
aGnupghome	db 'GNUPGHOME',0        ; DATA XREF: .text:loc_40BDCBo
aHomedir	db 'HomeDir',0          ; DATA XREF: .text:loc_40BE07o
aSoftwareGnuGnu	db 'Software\GNU\GnuPG',0 ; DATA XREF: .text:0040BE0Fo
aGpgconf_exe	db '\gpgconf.exe',0     ; DATA XREF: sub_40BE8D+10o
					; .text:0040CAD9o
		align 10h
; char aRequiredBinary[]
aRequiredBinary	db 'required binary ',27h,'%s',27h,' is not installed',0Ah,0
					; DATA XREF: sub_40BE8D+44o
aCtl		db 'ctl',0              ; DATA XREF: sub_40BE8D:loc_40BEDFo
; char aGetmodulefilen[]
aGetmodulefilen	db 'GetModuleFileName failed: %s',0Ah,0 ; DATA XREF: sub_40BF40+4Ao
aBin		db 'bin',0              ; DATA XREF: sub_40BF40+BBo
		align 10h
; char aBadFilenameSRe[]
aBadFilenameSRe	db 'bad filename `%s',27h,' returned for this process',0Ah,0
					; DATA XREF: sub_40BF40+FCo
aCGnupg_0	db 'c:\gnupg',0         ; DATA XREF: sub_40BF40:loc_40C061o
aGnu		db '\GNU',0             ; DATA XREF: sub_40C06D+99o
aEtcGnupg	db '\etc\gnupg',0       ; DATA XREF: .text:0040C171o
aBin_0		db '\bin',0             ; DATA XREF: sub_40C1F7+28o
aLibGnupg	db '\lib\gnupg',0       ; DATA XREF: .text:0040C26Do
aShareGnupg	db '\share\gnupg',0     ; DATA XREF: .text:0040C310o
aShareLocale	db '\share\locale',0    ; DATA XREF: sub_40C396+1Do
aCWindows	db 'C:\WINDOWS',0       ; DATA XREF: .text:0040C483o
aS_dirmngr	db '\S.dirmngr',0       ; DATA XREF: .text:loc_40C4A7o
aGpgAgent_exe	db '\gpg-agent.exe',0   ; DATA XREF: .text:0040C578o
aPinentry_exe	db '\pinentry.exe',0    ; DATA XREF: .text:0040C611o
aScdaemon_exe	db '\scdaemon.exe',0    ; DATA XREF: .text:0040C6AAo
aDirmngr_exe	db '\dirmngr.exe',0     ; DATA XREF: .text:0040C743o
aGpgProtectTool	db '\gpg-protect-tool.exe',0 ; DATA XREF: .text:0040C7DCo
aGpgCheckPatter	db '\gpg-check-pattern.exe',0 ; DATA XREF: .text:0040C875o
aGpgsm_exe	db '\gpgsm.exe',0       ; DATA XREF: .text:0040C90Eo
aGpg2_exe	db '\gpg2.exe',0        ; DATA XREF: .text:0040C9A7o
aGpgConnectAgen	db '\gpg-connect-agent.exe',0 ; DATA XREF: .text:0040CA40o
a____Gnupg22__2	db '../../gnupg2-2.0.30/common/homedir.c',0 ; DATA XREF: .text:0040CB6Ao
		align 10h
off_41B130	dd offset loc_40CB5A	; DATA XREF: .text:0040C55Ao
		dd offset loc_40C563	; jump table for switch	statement
		dd offset loc_40C5FC
		dd offset loc_40C695
		dd offset loc_40C72E
		dd offset loc_40C7C7
		dd offset loc_40C860
		dd offset loc_40C8F9
		dd offset loc_40C992
		dd offset loc_40CA2B
		dd offset loc_40CAC4
aGnupg_module_n	db 'gnupg_module_name',0 ; DATA XREF: .text:loc_40CB5Ao
aShell32_dll	db 'shell32.dll',0      ; DATA XREF: .data:off_419170o
aShfolder_dll	db 'shfolder.dll',0     ; DATA XREF: .data:00419174o
		align 4
off_41B188	dd offset loc_40CB9B	; DATA XREF: sub_40CB80+12r
		dd offset loc_40CBAA	; jump table for switch	statement
		dd offset loc_40CC22
		dd offset loc_40CC22
		dd offset loc_40CC22
		dd offset loc_40CC22
		dd offset loc_40CC9A
		dd offset loc_40CC9A
		dd offset loc_40CC9A
		dd offset loc_40CC9A
		dd offset loc_40CC9A
		dd offset loc_40CC9A
		dd offset loc_40CC9A
		dd offset loc_40CC9A
		dd offset loc_40CCD2
		dd offset loc_40CCE1
		dd offset loc_40CCF0
		dd offset loc_40CCFF
		dd offset loc_40CD0B
off_41B1D4	dd offset loc_40CC12	; DATA XREF: sub_40CB80+35r
		dd offset loc_40CBBE	; jump table for switch	statement
		dd offset loc_40CBCA
		dd offset loc_40CBD6
		dd offset loc_40CBE2
		dd offset loc_40CBEE
		dd offset loc_40CBFA
		dd offset loc_40CC06
off_41B1F4	dd offset loc_40CC8A	; DATA XREF: sub_40CB80+ADr
		dd offset loc_40CC36	; jump table for switch	statement
		dd offset loc_40CC42
		dd offset loc_40CC4E
		dd offset loc_40CC5A
		dd offset loc_40CC66
		dd offset loc_40CC72
		dd offset loc_40CC7E
off_41B214	dd offset loc_40CD73	; DATA XREF: sub_40CB80+196r
		dd offset loc_40CD1F	; jump table for switch	statement
		dd offset loc_40CD2B
		dd offset loc_40CD37
		dd offset loc_40CD43
		dd offset loc_40CD4F
		dd offset loc_40CD5B
		dd offset loc_40CD67
off_41B234	dd offset loc_40CEA6	; DATA XREF: sub_40CD81+10Ar
		dd offset loc_40CEC7	; jump table for switch	statement
		dd offset loc_40CEC7
		dd offset loc_40CEAC
		dd offset loc_40CEC7
		dd offset loc_40CEC7
		dd offset loc_40CEC7
		dd offset loc_40CE94
		dd offset loc_40CEC7
		dd offset loc_40CEC7
		dd offset loc_40CEC7
		dd offset loc_40CEA0
		dd offset loc_40CEC7
		dd offset loc_40CE9A
		dd offset loc_40CEC7
		dd offset loc_40CEC7
		dd offset loc_40CEB2
off_41B278	dd offset loc_40D207	; DATA XREF: sub_40CD81+408r
		dd offset loc_40D214	; jump table for switch	statement
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D192
		dd offset loc_40D214
		dd offset loc_40D1E0
		dd offset loc_40D214
		dd offset loc_40D1B9
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D1FA
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D214
		dd offset loc_40D1ED
off_41B334	dd offset loc_40D2BE, offset loc_40D31B, offset	loc_40D2EB
					; DATA XREF: sub_40CD81+4B0r
		dd offset loc_40D31B, offset loc_40D29A, offset	loc_40D282 ; jump table	for switch statement
		dd offset loc_40D2AC, offset loc_40D31B, offset	loc_40D31B
		dd offset loc_40D31B, offset loc_40D31B, offset	loc_40D31B
		dd offset loc_40D31B, offset loc_40D31B, offset	loc_40D31B
		dd offset loc_40D31B, offset loc_40D31B, offset	loc_40D31B
		dd offset loc_40D2FB, offset loc_40D31B, offset	loc_40D31B
		dd offset loc_40D31B, offset loc_40D31B, offset	loc_40D26A
		dd offset loc_40D31B, offset loc_40D31B, offset	loc_40D31B
		dd offset loc_40D31B, offset loc_40D31B, offset	loc_40D31B
		dd offset loc_40D31B, offset loc_40D31B, offset	loc_40D2B5
		dd offset loc_40D31B, offset loc_40D2C7, offset	loc_40D23A
		dd offset loc_40D28E, offset loc_40D276, offset	loc_40D2A3
		dd offset loc_40D31B, offset loc_40D23A, offset	loc_40D31B
		dd offset loc_40D31B, offset loc_40D31B, offset	loc_40D30B
		dd offset loc_40D2E2, offset loc_40D246, offset	loc_40D2D9
		dd offset loc_40D31B, offset loc_40D31B, offset	loc_40D2D0
		dd offset loc_40D31B, offset loc_40D252, offset	loc_40D31B
		dd offset loc_40D31B, offset loc_40D25E
off_41B414	dd offset loc_40D7B5	; DATA XREF: sub_40D4F9+4Co
		dd offset loc_40D54E	; jump table for switch	statement
		dd offset loc_40D57A
		dd offset loc_40D5A6
		dd offset loc_40D5BD
		dd offset loc_40D5D5
		dd offset loc_40D602
		dd offset loc_40D62C
		dd offset loc_40D641
		dd offset loc_40D656
		dd offset loc_40D680
		dd offset loc_40D69B
		dd offset loc_40D6CB
		dd offset loc_40D6E0
		dd offset loc_40D701
		dd offset loc_40D72B
		dd offset loc_40D755
		dd offset loc_40D76D
		dd offset loc_40D791
		dd offset loc_40D716
		dd offset loc_40D565
		dd offset loc_40D591
		dd offset loc_40D5ED
		dd offset loc_40D617
		dd offset loc_40D66B
		dd offset loc_40D6B6
		dd offset loc_40D743
		dd offset loc_40D77F
		dd offset loc_40D7A3
byte_41B488	db 27h,	0		; DATA XREF: sub_40D855+267o
a0123456789abcd	db '0123456789abcdef',0 ; DATA XREF: sub_40D855+37Eo
a0123456789ab_0	db '0123456789ABCDEF',0 ; DATA XREF: sub_40D855:loc_40DBDAo
a0x		db '0x',0               ; DATA XREF: sub_40D855+550o
a0x_0		db '0X',0               ; DATA XREF: sub_40D855:loc_40DDACo
		align 4
off_41B4B4	dd offset loc_40D8B4	; DATA XREF: sub_40D855+56r
		dd offset loc_40D93C	; jump table for switch	statement
		dd offset loc_40D8C9
		dd offset loc_40D93C
		dd offset loc_40D8DC
		dd offset loc_40D93C
		dd offset loc_40D8EF
		dd offset loc_40D93C
		dd offset loc_40D93C
		dd offset loc_40D93C
		dd offset loc_40D93C
		dd offset loc_40D915
		dd offset loc_40D93C
		dd offset loc_40D903
		dd offset loc_40D929
off_41B4F0	dd offset loc_40D997	; DATA XREF: sub_40D855+139r
		dd offset loc_40DA1E	; jump table for switch	statement
		dd offset loc_40D9AD
		dd offset loc_40DA1E
		dd offset loc_40D9BF
		dd offset loc_40DA1E
		dd offset loc_40D9D1
		dd offset loc_40DA1E
		dd offset loc_40DA1E
		dd offset loc_40DA1E
		dd offset loc_40DA1E
		dd offset loc_40D9F7
		dd offset loc_40D9E5
		dd offset loc_40DA0B
off_41B528	dd offset loc_40DFBA	; DATA XREF: sub_40DEE8+C9r
		dd offset loc_40DFC6	; jump table for switch	statement
		dd offset loc_40DFD2
		dd offset loc_40DFDE
		dd offset loc_40DFEA
		dd offset loc_40DFF6
		dd offset loc_40E002
		dd offset loc_40E00E
aNull		db '(null)',0           ; DATA XREF: sub_40E38F+40o
byte_41B54F	db 30h			; DATA XREF: sub_40E530+65r
a123456789abcde	db '123456789abcdefx',0
		align 4
off_41B564	dd offset loc_40E66C	; DATA XREF: sub_40E637+2Cr
		dd offset loc_40E678	; jump table for switch	statement
		dd offset loc_40E6D1
		dd offset loc_40E685
		dd offset loc_40E691
		dd offset loc_40E6A5
		dd offset loc_40E6B9
		dd offset loc_40E6C5
; char a____Gnupg22__3[]
a____Gnupg22__3	db '../../gnupg2-2.0.30/common/estream-printf.c',0
					; DATA XREF: sub_40E6EB+FAo
					; sub_40E6EB+145o ...
; char aArgidxArgspecs[]
aArgidxArgspecs	db 'argidx < argspecs_len',0 ; DATA XREF: sub_40E6EB+102o
		align 4
; char aValuetableArgW[]
aValuetableArgW	db 'valuetable[arg->width_pos-1].vt == VALTYPE_INT',0
					; DATA XREF: sub_40E6EB+14Do
		align 4
; char aValuetableArgP[]
aValuetableArgP	db 'valuetable[arg->precision_pos-1].vt == VALTYPE_INT',0
					; DATA XREF: sub_40E6EB+1D9o
		align 4
; char aArgVtValuetabl[]
aArgVtValuetabl	db 'arg->vt == valuetable[arg->arg_pos-1].vt',0 ; DATA XREF: sub_40E6EB+26Eo
; char aBug[]
aBug		db '!"bug"',0           ; DATA XREF: sub_40E6EB+2CFo
off_41B65C	dd offset loc_40E9AA	; DATA XREF: sub_40E6EB+2B6r
		dd offset loc_40E9CB	; jump table for switch	statement
		dd offset loc_40E9CB
		dd offset loc_40E9CB
		dd offset loc_40E9CB
		dd offset loc_40E9CB
		dd offset loc_40EA0F
		dd offset loc_40EA0F
		dd offset loc_40EA0F
		dd offset loc_40EA0F
		dd offset loc_40EA0F
		dd offset loc_40EA0F
		dd offset loc_40EA0F
		dd offset loc_40EA0F
		dd offset loc_40EA53
		dd offset loc_40EA97
		dd offset loc_40EADB
		dd offset loc_40EA97
		dd offset loc_40EB1C
byte_41B6A8	db 0			; DATA XREF: sub_40F320+5Fo
					; sub_40F51B+75o
; char aParm_used[]
aParm_used	db 'parm.used',0        ; DATA XREF: sub_40F51B+FDo
		align 4
; char VarName[]
VarName		db 'LC_ALL',0           ; DATA XREF: sub_40F664+6o
; char aLang[]
aLang		db 'LANG',0             ; DATA XREF: sub_40F664:loc_40F6B7o
aAf_za		db 'af_ZA',0            ; DATA XREF: sub_40F664:loc_40F722o
aSq_al		db 'sq_AL',0            ; DATA XREF: sub_40F664:loc_40F72Co
aAm_et		db 'am_ET',0            ; DATA XREF: sub_40F664:loc_40F736o
aAr_sa		db 'ar_SA',0            ; DATA XREF: sub_40F664:loc_40F759o
aAr_iq		db 'ar_IQ',0            ; DATA XREF: sub_40F664:loc_40F763o
aAr_eg		db 'ar_EG',0            ; DATA XREF: sub_40F664:loc_40F76Do
aAr_ly		db 'ar_LY',0            ; DATA XREF: sub_40F664:loc_40F777o
aAr_dz		db 'ar_DZ',0            ; DATA XREF: sub_40F664:loc_40F781o
aAr_ma		db 'ar_MA',0            ; DATA XREF: sub_40F664:loc_40F78Bo
aAr_tn		db 'ar_TN',0            ; DATA XREF: sub_40F664:loc_40F795o
aAr_om		db 'ar_OM',0            ; DATA XREF: sub_40F664:loc_40F79Fo
aAr_ye		db 'ar_YE',0            ; DATA XREF: sub_40F664:loc_40F7A9o
aAr_sy		db 'ar_SY',0            ; DATA XREF: sub_40F664:loc_40F7B3o
aAr_jo		db 'ar_JO',0            ; DATA XREF: sub_40F664:loc_40F7BDo
aAr_lb		db 'ar_LB',0            ; DATA XREF: sub_40F664:loc_40F7C7o
aAr_kw		db 'ar_KW',0            ; DATA XREF: sub_40F664:loc_40F7D1o
aAr_ae		db 'ar_AE',0            ; DATA XREF: sub_40F664:loc_40F7DBo
aAr_bh		db 'ar_BH',0            ; DATA XREF: sub_40F664:loc_40F7E5o
aAr_qa		db 'ar_QA',0            ; DATA XREF: sub_40F664:loc_40F7EFo
aAr		db 'ar',0               ; DATA XREF: sub_40F664:loc_40F7F9o
aHy_am		db 'hy_AM',0            ; DATA XREF: sub_40F664:loc_40F803o
aAs_in		db 'as_IN',0            ; DATA XREF: sub_40F664:loc_40F80Do
aAz_az@latin	db 'az_AZ@latin',0      ; DATA XREF: sub_40F664:loc_40F826o
aAz_az@cyrillic	db 'az_AZ@cyrillic',0   ; DATA XREF: sub_40F664:loc_40F830o
aAz		db 'az',0               ; DATA XREF: sub_40F664:loc_40F83Ao
aEu		db 'eu',0               ; DATA XREF: sub_40F664:loc_40F844o
aBe_by		db 'be_BY',0            ; DATA XREF: sub_40F664:loc_40F84Eo
aBn_in		db 'bn_IN',0            ; DATA XREF: sub_40F664:loc_40F867o
aBn_bd		db 'bn_BD',0            ; DATA XREF: sub_40F664:loc_40F871o
aBn		db 'bn',0               ; DATA XREF: sub_40F664:loc_40F87Bo
aBg_bg		db 'bg_BG',0            ; DATA XREF: sub_40F664:loc_40F885o
aMy_mm		db 'my_MM',0            ; DATA XREF: sub_40F664:loc_40F88Fo
aKm_kh		db 'km_KH',0            ; DATA XREF: sub_40F664:loc_40F899o
aCa_es		db 'ca_ES',0            ; DATA XREF: sub_40F664:loc_40F8A3o
aChr_us		db 'chr_US',0           ; DATA XREF: sub_40F664:loc_40F8ADo
aZh_tw		db 'zh_TW',0            ; DATA XREF: sub_40F664:loc_40F8CCo
aZh_cn		db 'zh_CN',0            ; DATA XREF: sub_40F664:loc_40F8D6o
aZh_hk		db 'zh_HK',0            ; DATA XREF: sub_40F664:loc_40F8E0o
aZh_sg		db 'zh_SG',0            ; DATA XREF: sub_40F664:loc_40F8EAo
aZh_mo		db 'zh_MO',0            ; DATA XREF: sub_40F664:loc_40F8F4o
aZh		db 'zh',0               ; DATA XREF: sub_40F664:loc_40F8FEo
aHr_hr		db 'hr_HR',0            ; DATA XREF: sub_40F664+2B6o
aSr_cs		db 'sr_CS',0            ; DATA XREF: sub_40F664:loc_40F924o
aSr_cs@cyrillic	db 'sr_CS@cyrillic',0   ; DATA XREF: sub_40F664:loc_40F92Eo
aHr		db 'hr',0               ; DATA XREF: sub_40F664:loc_40F938o
aCs_cz		db 'cs_CZ',0            ; DATA XREF: sub_40F664:loc_40F942o
aDa_dk		db 'da_DK',0            ; DATA XREF: sub_40F664:loc_40F94Co
aDiv_mv		db 'div_MV',0           ; DATA XREF: sub_40F664:loc_40F956o
aNl_nl		db 'nl_NL',0            ; DATA XREF: sub_40F664:loc_40F96Fo
aNl_be		db 'nl_BE',0            ; DATA XREF: sub_40F664:loc_40F979o
aNl		db 'nl',0               ; DATA XREF: sub_40F664:loc_40F983o
aBin_ng		db 'bin_NG',0           ; DATA XREF: sub_40F664:loc_40F98Do
aEn_us		db 'en_US',0            ; DATA XREF: sub_40F664:loc_40F9B0o
aEn_gb		db 'en_GB',0            ; DATA XREF: sub_40F664:loc_40F9BAo
aEn_au		db 'en_AU',0            ; DATA XREF: sub_40F664:loc_40F9C4o
aEn_ca		db 'en_CA',0            ; DATA XREF: sub_40F664:loc_40F9CEo
aEn_nz		db 'en_NZ',0            ; DATA XREF: sub_40F664:loc_40F9D8o
aEn_ie		db 'en_IE',0            ; DATA XREF: sub_40F664:loc_40F9E2o
aEn_za		db 'en_ZA',0            ; DATA XREF: sub_40F664:loc_40F9ECo
aEn_jm		db 'en_JM',0            ; DATA XREF: sub_40F664:loc_40F9F6o
aEn_gd		db 'en_GD',0            ; DATA XREF: sub_40F664:loc_40FA00o
aEn_bz		db 'en_BZ',0            ; DATA XREF: sub_40F664:loc_40FA0Ao
aEn_tt		db 'en_TT',0            ; DATA XREF: sub_40F664:loc_40FA14o
aEn_zw		db 'en_ZW',0            ; DATA XREF: sub_40F664:loc_40FA1Eo
aEn_ph		db 'en_PH',0            ; DATA XREF: sub_40F664:loc_40FA28o
aEn_id		db 'en_ID',0            ; DATA XREF: sub_40F664:loc_40FA32o
aEn_hk		db 'en_HK',0            ; DATA XREF: sub_40F664:loc_40FA3Co
aEn_in		db 'en_IN',0            ; DATA XREF: sub_40F664:loc_40FA46o
aEn_my		db 'en_MY',0            ; DATA XREF: sub_40F664:loc_40FA50o
aEn_sg		db 'en_SG',0            ; DATA XREF: sub_40F664:loc_40FA5Ao
aEn		db 'en',0               ; DATA XREF: sub_40F664:loc_40FA64o
aEt_ee		db 'et_EE',0            ; DATA XREF: sub_40F664:loc_40FA6Eo
aFo_fo		db 'fo_FO',0            ; DATA XREF: sub_40F664:loc_40FA78o
aFa_ir		db 'fa_IR',0            ; DATA XREF: sub_40F664:loc_40FA82o
aFi_fi		db 'fi_FI',0            ; DATA XREF: sub_40F664:loc_40FA8Co
aFr_fr		db 'fr_FR',0            ; DATA XREF: sub_40F664:loc_40FAAFo
aFr_be		db 'fr_BE',0            ; DATA XREF: sub_40F664:loc_40FAB9o
aFr_ca		db 'fr_CA',0            ; DATA XREF: sub_40F664:loc_40FAC3o
aFr_ch		db 'fr_CH',0            ; DATA XREF: sub_40F664:loc_40FACDo
aFr_lu		db 'fr_LU',0            ; DATA XREF: sub_40F664:loc_40FAD7o
aFr_mc		db 'fr_MC',0            ; DATA XREF: sub_40F664:loc_40FAE1o
aFr		db 'fr',0               ; DATA XREF: sub_40F664:loc_40FAEBo
					; sub_40F664:loc_40FB45o
aFr_re		db 'fr_RE',0            ; DATA XREF: sub_40F664:loc_40FAF5o
aFr_cg		db 'fr_CG',0            ; DATA XREF: sub_40F664:loc_40FAFFo
aFr_sn		db 'fr_SN',0            ; DATA XREF: sub_40F664:loc_40FB09o
aFr_cm		db 'fr_CM',0            ; DATA XREF: sub_40F664:loc_40FB13o
aFr_ci		db 'fr_CI',0            ; DATA XREF: sub_40F664:loc_40FB1Do
aFr_ml		db 'fr_ML',0            ; DATA XREF: sub_40F664:loc_40FB27o
aFr_ma		db 'fr_MA',0            ; DATA XREF: sub_40F664:loc_40FB31o
aFr_ht		db 'fr_HT',0            ; DATA XREF: sub_40F664:loc_40FB3Bo
aFy_nl		db 'fy_NL',0            ; DATA XREF: sub_40F664:loc_40FB4Fo
aFul_ng		db 'ful_NG',0           ; DATA XREF: sub_40F664:loc_40FB59o
aGd_gb		db 'gd_GB',0            ; DATA XREF: sub_40F664:loc_40FB72o
aGa_ie		db 'ga_IE',0            ; DATA XREF: sub_40F664:loc_40FB7Co
aC		db 'C',0                ; DATA XREF: sub_40F664:loc_40FB86o
					; sub_40F664:loc_4101A4o
aGl_es		db 'gl_ES',0            ; DATA XREF: sub_40F664:loc_40FB90o
aKa_ge		db 'ka_GE',0            ; DATA XREF: sub_40F664:loc_40FB9Ao
aDe_de		db 'de_DE',0            ; DATA XREF: sub_40F664:loc_40FBB9o
aDe_ch		db 'de_CH',0            ; DATA XREF: sub_40F664:loc_40FBC3o
aDe_at		db 'de_AT',0            ; DATA XREF: sub_40F664:loc_40FBCDo
aDe_lu		db 'de_LU',0            ; DATA XREF: sub_40F664:loc_40FBD7o
aDe_li		db 'de_LI',0            ; DATA XREF: sub_40F664:loc_40FBE1o
aDe		db 'de',0               ; DATA XREF: sub_40F664:loc_40FBEBo
aEl_gr		db 'el_GR',0            ; DATA XREF: sub_40F664:loc_40FBF5o
aGn_py		db 'gn_PY',0            ; DATA XREF: sub_40F664:loc_40FBFFo
aGu_in		db 'gu_IN',0            ; DATA XREF: sub_40F664:loc_40FC09o
aHa_ng		db 'ha_NG',0            ; DATA XREF: sub_40F664:loc_40FC13o
aCpe_us		db 'cpe_US',0           ; DATA XREF: sub_40F664:loc_40FC1Do
aHe_il		db 'he_IL',0            ; DATA XREF: sub_40F664:loc_40FC27o
aHi_in		db 'hi_IN',0            ; DATA XREF: sub_40F664:loc_40FC31o
aHu_hu		db 'hu_HU',0            ; DATA XREF: sub_40F664:loc_40FC3Bo
aNic_ng		db 'nic_NG',0           ; DATA XREF: sub_40F664:loc_40FC45o
aIs_is		db 'is_IS',0            ; DATA XREF: sub_40F664:loc_40FC4Fo
aIbo_ng		db 'ibo_NG',0           ; DATA XREF: sub_40F664:loc_40FC59o
aId_id		db 'id_ID',0            ; DATA XREF: sub_40F664:loc_40FC63o
aIu_ca		db 'iu_CA',0            ; DATA XREF: sub_40F664:loc_40FC6Do
aIt_it		db 'it_IT',0            ; DATA XREF: sub_40F664:loc_40FC86o
aIt_ch		db 'it_CH',0            ; DATA XREF: sub_40F664:loc_40FC90o
aIt		db 'it',0               ; DATA XREF: sub_40F664:loc_40FC9Ao
aJa_jp		db 'ja_JP',0            ; DATA XREF: sub_40F664:loc_40FCA4o
aKn_in		db 'kn_IN',0            ; DATA XREF: sub_40F664:loc_40FCAEo
aKau_ng		db 'kau_NG',0           ; DATA XREF: sub_40F664:loc_40FCB8o
aKs_pk		db 'ks_PK',0            ; DATA XREF: sub_40F664:loc_40FCD1o
aKs_in		db 'ks_IN',0            ; DATA XREF: sub_40F664:loc_40FCDBo
aKs		db 'ks',0               ; DATA XREF: sub_40F664:loc_40FCE5o
aKk_kz		db 'kk_KZ',0            ; DATA XREF: sub_40F664:loc_40FCEFo
aKok_in		db 'kok_IN',0           ; DATA XREF: sub_40F664:loc_40FCF9o
aKo_kr		db 'ko_KR',0            ; DATA XREF: sub_40F664:loc_40FD03o
aKy_kg		db 'ky_KG',0            ; DATA XREF: sub_40F664:loc_40FD0Do
aLo_la		db 'lo_LA',0            ; DATA XREF: sub_40F664:loc_40FD17o
aLa_va		db 'la_VA',0            ; DATA XREF: sub_40F664:loc_40FD21o
aLv_lv		db 'lv_LV',0            ; DATA XREF: sub_40F664:loc_40FD2Bo
aLt_lt		db 'lt_LT',0            ; DATA XREF: sub_40F664:loc_40FD35o
aMk_mk		db 'mk_MK',0            ; DATA XREF: sub_40F664:loc_40FD3Fo
aMs_my		db 'ms_MY',0            ; DATA XREF: sub_40F664:loc_40FD58o
aMs_bn		db 'ms_BN',0            ; DATA XREF: sub_40F664:loc_40FD62o
aMs		db 'ms',0               ; DATA XREF: sub_40F664:loc_40FD6Co
aMl_in		db 'ml_IN',0            ; DATA XREF: sub_40F664:loc_40FD76o
aMt_mt		db 'mt_MT',0            ; DATA XREF: sub_40F664:loc_40FD80o
aMni_in		db 'mni_IN',0           ; DATA XREF: sub_40F664:loc_40FD8Ao
aMr_in		db 'mr_IN',0            ; DATA XREF: sub_40F664:loc_40FD94o
aMn		db 'mn',0               ; DATA XREF: sub_40F664:loc_40FD9Eo
aNe_np		db 'ne_NP',0            ; DATA XREF: sub_40F664:loc_40FDB7o
aNe_in		db 'ne_IN',0            ; DATA XREF: sub_40F664:loc_40FDC1o
aNe		db 'ne',0               ; DATA XREF: sub_40F664:loc_40FDCBo
aNo_no		db 'no_NO',0            ; DATA XREF: sub_40F664:loc_40FDE4o
aNn_no		db 'nn_NO',0            ; DATA XREF: sub_40F664:loc_40FDEEo
aNo		db 'no',0               ; DATA XREF: sub_40F664:loc_40FDF8o
aOr_in		db 'or_IN',0            ; DATA XREF: sub_40F664:loc_40FE02o
aOm_et		db 'om_ET',0            ; DATA XREF: sub_40F664:loc_40FE0Co
aPap_an		db 'pap_AN',0           ; DATA XREF: sub_40F664:loc_40FE16o
aPs		db 'ps',0               ; DATA XREF: sub_40F664:loc_40FE20o
aPl_pl		db 'pl_PL',0            ; DATA XREF: sub_40F664:loc_40FE2Ao
aPt_pt		db 'pt_PT',0            ; DATA XREF: sub_40F664+7DDo
aPt_br		db 'pt_BR',0            ; DATA XREF: sub_40F664:loc_40FE4Bo
aPt		db 'pt',0               ; DATA XREF: sub_40F664:loc_40FE55o
aPa_in		db 'pa_IN',0            ; DATA XREF: sub_40F664+803o
aPa		db 'pa',0               ; DATA XREF: sub_40F664:loc_40FE71o
aRm_ch		db 'rm_CH',0            ; DATA XREF: sub_40F664:loc_40FE7Bo
aRo_ro		db 'ro_RO',0            ; DATA XREF: sub_40F664+829o
aRo		db 'ro',0               ; DATA XREF: sub_40F664:loc_40FE97o
aRu		db 'ru',0               ; DATA XREF: sub_40F664:loc_40FEA1o
aSe_no		db 'se_NO',0            ; DATA XREF: sub_40F664:loc_40FEABo
aSa_in		db 'sa_IN',0            ; DATA XREF: sub_40F664:loc_40FEB5o
aSd_in		db 'sd_IN',0            ; DATA XREF: sub_40F664:loc_40FECDo
aSd_pk		db 'sd_PK',0            ; DATA XREF: sub_40F664:loc_40FED7o
aSd		db 'sd',0               ; DATA XREF: sub_40F664:loc_40FEE1o
aSi_lk		db 'si_LK',0            ; DATA XREF: sub_40F664:loc_40FEEBo
aSk_sk		db 'sk_SK',0            ; DATA XREF: sub_40F664:loc_40FEF5o
aSl_si		db 'sl_SI',0            ; DATA XREF: sub_40F664:loc_40FEFFo
aSo_so		db 'so_SO',0            ; DATA XREF: sub_40F664:loc_40FF09o
aWen_de		db 'wen_DE',0           ; DATA XREF: sub_40F664:loc_40FF13o
aEs_es		db 'es_ES',0            ; DATA XREF: sub_40F664:loc_40FF36o
aEs_mx		db 'es_MX',0            ; DATA XREF: sub_40F664:loc_40FF40o
aEs_es@modern	db 'es_ES@modern',0     ; DATA XREF: sub_40F664:loc_40FF4Ao
aEs_gt		db 'es_GT',0            ; DATA XREF: sub_40F664:loc_40FF54o
aEs_cr		db 'es_CR',0            ; DATA XREF: sub_40F664:loc_40FF5Eo
aEs_pa		db 'es_PA',0            ; DATA XREF: sub_40F664:loc_40FF68o
aEs_do		db 'es_DO',0            ; DATA XREF: sub_40F664:loc_40FF72o
aEs_ve		db 'es_VE',0            ; DATA XREF: sub_40F664:loc_40FF7Co
aEs_co		db 'es_CO',0            ; DATA XREF: sub_40F664:loc_40FF86o
aEs_pe		db 'es_PE',0            ; DATA XREF: sub_40F664:loc_40FF90o
aEs_ar		db 'es_AR',0            ; DATA XREF: sub_40F664:loc_40FF9Ao
aEs_ec		db 'es_EC',0            ; DATA XREF: sub_40F664:loc_40FFA4o
aEs_cl		db 'es_CL',0            ; DATA XREF: sub_40F664:loc_40FFAEo
aEs_uy		db 'es_UY',0            ; DATA XREF: sub_40F664:loc_40FFB8o
aEs_py		db 'es_PY',0            ; DATA XREF: sub_40F664:loc_40FFC2o
aEs_bo		db 'es_BO',0            ; DATA XREF: sub_40F664:loc_40FFCCo
aEs_sv		db 'es_SV',0            ; DATA XREF: sub_40F664:loc_40FFD6o
aEs_hn		db 'es_HN',0            ; DATA XREF: sub_40F664:loc_40FFE0o
aEs_ni		db 'es_NI',0            ; DATA XREF: sub_40F664:loc_40FFEAo
aEs_pr		db 'es_PR',0            ; DATA XREF: sub_40F664:loc_40FFF4o
aEs		db 'es',0               ; DATA XREF: sub_40F664:loc_40FFFEo
aBnt_tz		db 'bnt_TZ',0           ; DATA XREF: sub_40F664:loc_410008o
aSw_ke		db 'sw_KE',0            ; DATA XREF: sub_40F664:loc_410012o
aSv_se		db 'sv_SE',0            ; DATA XREF: sub_40F664:loc_41002Bo
aSv_fi		db 'sv_FI',0            ; DATA XREF: sub_40F664:loc_410035o
aSv		db 'sv',0               ; DATA XREF: sub_40F664:loc_41003Fo
aSyr_tr		db 'syr_TR',0           ; DATA XREF: sub_40F664:loc_410049o
aTl_ph		db 'tl_PH',0            ; DATA XREF: sub_40F664:loc_410053o
aTg_tj		db 'tg_TJ',0            ; DATA XREF: sub_40F664:loc_41005Do
aBer_ma@arabic	db 'ber_MA@arabic',0    ; DATA XREF: sub_40F664:loc_410076o
aBer_ma@latin	db 'ber_MA@latin',0     ; DATA XREF: sub_40F664:loc_410080o
aBer_ma		db 'ber_MA',0           ; DATA XREF: sub_40F664:loc_41008Ao
aTa		db 'ta',0               ; DATA XREF: sub_40F664:loc_410094o
aTt_ru		db 'tt_RU',0            ; DATA XREF: sub_40F664:loc_41009Eo
aTe_in		db 'te_IN',0            ; DATA XREF: sub_40F664:loc_4100A8o
aTh_th		db 'th_TH',0            ; DATA XREF: sub_40F664:loc_4100B2o
aBo_cn		db 'bo_CN',0            ; DATA XREF: sub_40F664:loc_4100BCo
aTi_et		db 'ti_ET',0            ; DATA XREF: sub_40F664:loc_4100D4o
aTi_er		db 'ti_ER',0            ; DATA XREF: sub_40F664:loc_4100DEo
aTi		db 'ti',0               ; DATA XREF: sub_40F664:loc_4100E8o
aTs_za		db 'ts_ZA',0            ; DATA XREF: sub_40F664:loc_4100F2o
aTn_bw		db 'tn_BW',0            ; DATA XREF: sub_40F664:loc_4100FCo
aTr_tr		db 'tr_TR',0            ; DATA XREF: sub_40F664:loc_410106o
aTk_tm		db 'tk_TM',0            ; DATA XREF: sub_40F664:loc_410110o
aUk_ua		db 'uk_UA',0            ; DATA XREF: sub_40F664:loc_41011Ao
aUr_pk		db 'ur_PK',0            ; DATA XREF: sub_40F664:loc_410133o
aUr_in		db 'ur_IN',0            ; DATA XREF: sub_40F664:loc_41013Ao
aUr		db 'ur',0               ; DATA XREF: sub_40F664:loc_410141o
aUz_uz		db 'uz_UZ',0            ; DATA XREF: sub_40F664:loc_410157o
aUz_uz@cyrillic	db 'uz_UZ@cyrillic',0   ; DATA XREF: sub_40F664:loc_41015Eo
aUz		db 'uz',0               ; DATA XREF: sub_40F664:loc_410165o
aVen_za		db 'ven_ZA',0           ; DATA XREF: sub_40F664:loc_41016Co
aVi_vn		db 'vi_VN',0            ; DATA XREF: sub_40F664:loc_410173o
aCy_gb		db 'cy_GB',0            ; DATA XREF: sub_40F664:loc_41017Ao
aXh_za		db 'xh_ZA',0            ; DATA XREF: sub_40F664:loc_410181o
aSit_cn		db 'sit_CN',0           ; DATA XREF: sub_40F664:loc_410188o
aYi_il		db 'yi_IL',0            ; DATA XREF: sub_40F664:loc_41018Fo
aYo_ng		db 'yo_NG',0            ; DATA XREF: sub_40F664:loc_410196o
aZu_za		db 'zu_ZA',0            ; DATA XREF: sub_40F664:loc_41019Do
		align 4
off_41BC1C	dd offset loc_4101A4, offset loc_40F740, offset	loc_40F885
					; DATA XREF: sub_40F664+B5o
		dd offset loc_40F8A3, offset loc_40F8B7, offset	loc_40F942 ; jump table	for switch statement
		dd offset loc_40F94C, offset loc_40FBA4, offset	loc_40FBF5
		dd offset loc_40F997, offset loc_40FF1D, offset	loc_40FA8C
		dd offset loc_40FA96, offset loc_40FC27, offset	loc_40FC3B
		dd offset loc_40FC4F, offset loc_40FC77, offset	loc_40FCA4
		dd offset loc_40FD03, offset loc_40F960, offset	loc_40FDD5
		dd offset loc_40FE2A, offset loc_40FE34, offset	loc_40FE7B
		dd offset loc_40FE85, offset loc_40FEA1, offset	loc_40F908
		dd offset loc_40FEF5, offset loc_40F72C, offset	loc_41001C
		dd offset loc_4100B2, offset loc_410106, offset	loc_410124
		dd offset loc_40FC63, offset loc_41011A, offset	loc_40F84E
		dd offset loc_40FEFF, offset loc_40FA6E, offset	loc_40FD2B
		dd offset loc_40FD35, offset loc_41005D, offset	loc_40FA82
		dd offset loc_410173, offset loc_40F803, offset	loc_40F817
		dd offset loc_40F844, offset loc_40FF13, offset	loc_40FD3F
		dd offset loc_410008, offset loc_4100F2, offset	loc_4100FC
		dd offset loc_41016C, offset loc_410181, offset	loc_41019D
		dd offset loc_40F722, offset loc_40FB9A, offset	loc_40FA78
		dd offset loc_40FC31, offset loc_40FD80, offset	loc_40FEAB
		dd offset loc_40FB63, offset loc_41018F, offset	loc_40FD49
		dd offset loc_40FCEF, offset loc_40FD0D, offset	loc_410012
		dd offset loc_410110, offset loc_410148, offset	loc_41009E
		dd offset loc_40F858, offset loc_40FE5F, offset	loc_40FC09
		dd offset loc_40FE02, offset loc_410094, offset	loc_4100A8
		dd offset loc_40FCAE, offset loc_40FD76, offset	loc_40F80D
		dd offset loc_40FD94, offset loc_40FEB5, offset	loc_40FD9E
		dd offset loc_4100BC, offset loc_41017A, offset	loc_40F899
		dd offset loc_40FD17, offset loc_40F88F, offset	loc_40FB90
		dd offset loc_40FCF9, offset loc_40FD8A, offset	loc_40FEBF
		dd offset loc_410049, offset loc_40FEEB, offset	loc_40F8AD
		dd offset loc_40FC6D, offset loc_40F736, offset	loc_410067
		dd offset loc_40FCC2, offset loc_40FDA8, offset	loc_40FB4F
		dd offset loc_40FE20, offset loc_410053, offset	loc_40F956
		dd offset loc_40F98D, offset loc_40FB59, offset	loc_40FC13
		dd offset loc_40FC45, offset loc_410196, offset	loc_4101A4
		dd offset loc_4101A4, offset loc_4101A4, offset	loc_4101A4
		dd offset loc_4101A4, offset loc_40FC59, offset	loc_40FCB8
		dd offset loc_40FE0C, offset loc_4100C6, offset	loc_40FBFF
		dd offset loc_40FC1D, offset loc_40FD21, offset	loc_40FF09
		dd offset loc_410188, offset loc_40FE16
off_41BE04	dd offset loc_40F7F9	; DATA XREF: sub_40F664+ECo
		dd offset loc_40F759	; jump table for switch	statement
		dd offset loc_40F763
		dd offset loc_40F76D
		dd offset loc_40F777
		dd offset loc_40F781
		dd offset loc_40F78B
		dd offset loc_40F795
		dd offset loc_40F79F
		dd offset loc_40F7A9
		dd offset loc_40F7B3
		dd offset loc_40F7BD
		dd offset loc_40F7C7
		dd offset loc_40F7D1
		dd offset loc_40F7DB
		dd offset loc_40F7E5
		dd offset loc_40F7EF
off_41BE48	dd offset loc_40F8FE	; DATA XREF: sub_40F664+25Fo
		dd offset loc_40F8CC	; jump table for switch	statement
		dd offset loc_40F8D6
		dd offset loc_40F8E0
		dd offset loc_40F8EA
		dd offset loc_40F8F4
off_41BE60	dd offset loc_40FA64	; DATA XREF: sub_40F664+343o
		dd offset loc_40F9B0	; jump table for switch	statement
		dd offset loc_40F9BA
		dd offset loc_40F9C4
		dd offset loc_40F9CE
		dd offset loc_40F9D8
		dd offset loc_40F9E2
		dd offset loc_40F9EC
		dd offset loc_40F9F6
		dd offset loc_40FA00
		dd offset loc_40FA0A
		dd offset loc_40FA14
		dd offset loc_40FA1E
		dd offset loc_40FA28
		dd offset loc_40FA32
		dd offset loc_40FA3C
		dd offset loc_40FA46
		dd offset loc_40FA50
		dd offset loc_40FA5A
off_41BEAC	dd offset loc_40FB45	; DATA XREF: sub_40F664+442o
		dd offset loc_40FAAF	; jump table for switch	statement
		dd offset loc_40FAB9
		dd offset loc_40FAC3
		dd offset loc_40FACD
		dd offset loc_40FAD7
		dd offset loc_40FAE1
		dd offset loc_40FAEB
		dd offset loc_40FAF5
		dd offset loc_40FAFF
		dd offset loc_40FB09
		dd offset loc_40FB13
		dd offset loc_40FB1D
		dd offset loc_40FB27
		dd offset loc_40FB31
		dd offset loc_40FB3B
off_41BEEC	dd offset loc_40FBEB	; DATA XREF: sub_40F664+54Co
		dd offset loc_40FBB9	; jump table for switch	statement
		dd offset loc_40FBC3
		dd offset loc_40FBCD
		dd offset loc_40FBD7
		dd offset loc_40FBE1
off_41BF04	dd offset loc_40FFFE	; DATA XREF: sub_40F664+8C9o
		dd offset loc_40FF36	; jump table for switch	statement
		dd offset loc_40FF40
		dd offset loc_40FF4A
		dd offset loc_40FF54
		dd offset loc_40FF5E
		dd offset loc_40FF68
		dd offset loc_40FF72
		dd offset loc_40FF7C
		dd offset loc_40FF86
		dd offset loc_40FF90
		dd offset loc_40FF9A
		dd offset loc_40FFA4
		dd offset loc_40FFAE
		dd offset loc_40FFB8
		dd offset loc_40FFC2
		dd offset loc_40FFCC
		dd offset loc_40FFD6
		dd offset loc_40FFE0
		dd offset loc_40FFEA
		dd offset loc_40FFF4
; char Mode[3]
Mode		db 'rb',0               ; DATA XREF: sub_41028A+16o
; char aLc_messages[]
aLc_messages	db 'LC_MESSAGES',0      ; DATA XREF: sub_41082E+16o
					; .text:00411181o
aLc_messages_0	db '\LC_MESSAGES\',0    ; DATA XREF: sub_41082E+1AAo
a_mo		db '.mo',0              ; DATA XREF: sub_41082E+202o
		align 4
aErrorInGettext	db 'ERROR in GETTEXT (bad plural entry)',0 ; DATA XREF: sub_410A88+3Bo
aErrorInGette_0	db 'ERROR in GETTEXT MALLOC',0 ; DATA XREF: sub_410AEE+13Do
					; sub_410AEE:loc_410D51o
aErrorInGette_1	db 'ERROR in GETTEXT (overflow space)',0Ah,0
					; DATA XREF: sub_410AEE:loc_410DC5o
byte_41BFDB	db 0			; DATA XREF: .text:loc_41119Bo
asc_41BFDC	db '-',0                ; DATA XREF: sub_4111E5+55o
					; sub_411444:loc_411455o
aSocket		db 'socket://',0        ; DATA XREF: sub_4111E5+9Do
aSystemDoesNotS	db 'system does not support logging to a socket - using stderr',0Ah,0
					; DATA XREF: sub_4111E5+FDo
; char aA_0[]
aA_0		db 'a',0                ; DATA XREF: sub_4111E5+131o
					; sub_4111E5:loc_411355o
		align 4
; char aFailedToOpenLo[]
aFailedToOpenLo	db 'failed to open log file `%s',27h,': %s',0Ah,0
					; DATA XREF: sub_4111E5+1B1o
		align 4
; char aFailedToFdopen[]
aFailedToFdopen	db 'failed to fdopen file descriptor %d: %s',0Ah,0
					; DATA XREF: sub_4111E5+1E9o
		align 4
; char a____Gnupg22__4[]
a____Gnupg22__4	db '../../gnupg2-2.0.30/jnlib/logging.c',0 ; DATA XREF: sub_411606+2Fo
; char aLogstream[]
aLogstream	db 'logstream',0        ; DATA XREF: sub_411606+37o
		align 4
; char a04d02d02d02d_0[]
a04d02d02d02d_0	db '%04d-%02d-%02d %02d:%02d:%02d ',0 ; DATA XREF: sub_411606+E3o
; char aU_Lx[]
aU_Lx		db '[%u.%lx]',0         ; DATA XREF: sub_411606+16Bo
; char aU[]
aU		db '[%u]',0             ; DATA XREF: sub_411606+192o
aFatal		db 'Fatal: ',0          ; DATA XREF: sub_411606+21Do
aOhhhhJeeee	db 'Ohhhh jeeee: ',0    ; DATA XREF: sub_411606+246o
aDbg		db 'DBG: ',0            ; DATA XREF: sub_411606+26Fo
; char aUnknownLogLeve[]
aUnknownLogLeve	db '[Unknown log level %d]: ',0 ; DATA XREF: sub_411606:loc_411898o
		align 4
off_41C10C	dd offset loc_4118B7	; DATA XREF: sub_411606+20Eo
		dd offset loc_4118B7	; jump table for switch	statement
		dd offset loc_4118B7
		dd offset loc_4118B7
		dd offset loc_4118B7
		dd offset loc_41181D
		dd offset loc_411846
		dd offset loc_41186F
dword_41C12C	dd 207325h		; DATA XREF: .text:00411B11o
a02x		db '%02X',0             ; DATA XREF: .text:00411B36o
a02x_0		db ' %02X',0            ; DATA XREF: .text:00411B59o
asc_41C13B	db 0Ah,0		; DATA XREF: .text:00411B7Eo
; char a___ThisIsABugS[]
a___ThisIsABugS	db '... this is a bug (%s:%d:%s)',0Ah,0 ; DATA XREF: sub_411B8C+1Bo
		align 4
; char aInvalidArgumen[]
aInvalidArgumen	db 'invalid argument for arg_parsee',0Ah,0 ; DATA XREF: sub_411BC0+81o
; char aArgumentNotExp[]
aArgumentNotExp	db 'argument not expected',0 ; DATA XREF: sub_411BC0+B0o
; char aReadError[]
aReadError	db 'read error',0       ; DATA XREF: sub_411BC0+CFo
; char aKeywordTooLong[]
aKeywordTooLong	db 'keyword too long',0 ; DATA XREF: sub_411BC0+EEo
; char aMissingArgumen[]
aMissingArgumen	db 'missing argument',0 ; DATA XREF: sub_411BC0+10Do
; char aInvalidArgum_0[]
aInvalidArgum_0	db 'invalid argument',0 ; DATA XREF: sub_411BC0+129o
; char aInvalidComma_0[]
aInvalidComma_0	db 'invalid command',0  ; DATA XREF: sub_411BC0+145o
; char aInvalidAliasDe[]
aInvalidAliasDe	db 'invalid alias definition',0 ; DATA XREF: sub_411BC0+161o
; char aOutOfCore[]
aOutOfCore	db 'out of core',0      ; DATA XREF: sub_411BC0+17Do
; char aInvalidOption[]
aInvalidOption	db 'invalid option',0   ; DATA XREF: sub_411BC0:loc_411D4Eo
; char aSUS[]
aSUS		db '%s:%u: %s',0Ah,0    ; DATA XREF: sub_411BC0+1B4o
a??		db '[??]',0             ; DATA XREF: sub_411BC0:loc_411D97o
		align 4
; char aMissingArgum_0[]
aMissingArgum_0	db 'missing argument for option "%.50s"',0Ah,0 ; DATA XREF: sub_411BC0+1EAo
		align 10h
; char aInvalidArgum_1[]
aInvalidArgum_1	db 'invalid argument for option "%.50s"',0Ah,0 ; DATA XREF: sub_411BC0+215o
		align 4
; char aOption_50sDoes[]
aOption_50sDoes	db 'option "%.50s" does not expect an argument',0Ah,0
					; DATA XREF: sub_411BC0+240o
; char aInvalidComma_1[]
aInvalidComma_1	db 'invalid command "%.50s"',0Ah,0 ; DATA XREF: sub_411BC0+26Bo
; char aOption_50sIsAm[]
aOption_50sIsAm	db 'option "%.50s" is ambiguous',0Ah,0 ; DATA XREF: sub_411BC0+296o
; char aCommand_50sIsA[]
aCommand_50sIsA	db 'command "%.50s" is ambiguous',0Ah,0 ; DATA XREF: sub_411BC0+2BEo
; char aOutOfCore_0[]
aOutOfCore_0	db 'out of core',0Ah,0  ; DATA XREF: sub_411BC0+2E6o
; char aS[]
aS		db '%s',0Ah,0           ; DATA XREF: sub_411BC0+2F6o
; char aInvalidOption_[]
aInvalidOption_	db 'invalid option "%.50s"',0Ah,0 ; DATA XREF: sub_411BC0:loc_411EC4o
; char Str2[]
Str2		db 'ignore-invalid-option',0 ; DATA XREF: sub_41212A+15Do
					; sub_41212A:loc_412746o
; char Control[]
Control		db ' ',9,0              ; DATA XREF: sub_41212A+2D3o
; char aAlias[]
aAlias		db 'alias',0            ; DATA XREF: sub_41212A+5EFo
; char Str1[]
Str1		db 'help',0             ; DATA XREF: sub_412B0D+1A6o
; char aVersion[]
aVersion	db 'version',0          ; DATA XREF: sub_412B0D+1E0o
; char aWarranty[]
aWarranty	db 'warranty',0         ; DATA XREF: sub_412B0D+222o
; char aDumpOptions[]
aDumpOptions	db 'dump-options',0     ; DATA XREF: sub_412B0D+266o
; char aS_0[]
aS_0		db '--%s',0Ah,0         ; DATA XREF: sub_412B0D+2B2o
		align 4
aDumpOptionsHel	db '--dump-options',0Ah ; DATA XREF: sub_412B0D+2DEo
		db '--help',0Ah
		db '--version',0Ah
		db '--warranty',0Ah,0
asc_41C398	db 'x',0                ; DATA XREF: sub_412B0D:loc_413207o
; char aOptions[]
aOptions	db 'Options:',0         ; DATA XREF: sub_4134F8+CEo
; char aC_0[]
aC_0		db ' -%c',0             ; DATA XREF: sub_4134F8+1B1o
asc_41C3A8	db '   ',0              ; DATA XREF: sub_4134F8+245o
					; sub_4134F8+332o
; char aCS[]
aCS		db '%c --%s',0          ; DATA XREF: sub_4134F8:loc_41379Co
; char aASingleDashMay[]
aASingleDashMay	db 0Ah			; DATA XREF: sub_4134F8+45Co
		db '(A single dash may be used instead of the double ones)',0
; char a_email_[]
a@email@	db '@EMAIL@',0          ; DATA XREF: sub_4134F8+48Do
aHttpBugs_gnupg	db 'http://bugs.gnupg.org',0 ; DATA XREF: sub_4134F8+4F0o
; char aS_1[]
aS_1		db ' (%s)',0            ; DATA XREF: sub_413A63+3Co
; char aSS[]
aSS		db ' %s %s',0Ah,0       ; DATA XREF: sub_413A63+5Co
aGpg4win2_3_1	db '(Gpg4win 2.3.1)',0  ; DATA XREF: sub_413A63+61o
; char aSSS[]
aSSS		db '%s %s; %s',0Ah,0    ; DATA XREF: sub_413BF6+37o
		align 4
aLicenseGplv3Gn	db 'License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licens'
					; DATA XREF: sub_413D19:loc_413D5Fo
		db 'es/gpl.html>',0
aFoo		db 'foo',0              ; DATA XREF: sub_413D19:loc_413D68o
a0_0		db '0.0',0              ; DATA XREF: sub_413D19:loc_413D71o
		align 4
aCopyrightC2015	db 'Copyright (C) 2015 Free Software Foundation, Inc.',0
					; DATA XREF: sub_413D19:loc_413D7Ao
		align 10h
aThisIsFreeSoft	db 'This is free software: you are free to change and redistribute it'
					; DATA XREF: sub_413D19:loc_413D83o
		db '.',0Ah
		db 'There is NO WARRANTY, to the extent permitted by law.',0Ah,0
		align 4
aThisIsFreeSo_0	db 'This is free software; you can redistribute it and/or modify',0Ah
					; DATA XREF: sub_413D19:loc_413D8Co
		db 'it under the terms of the GNU General Public License as published'
		db ' by',0Ah
		db 'the Free Software Foundation; either version 3 of the License, or'
		db 0Ah
		db '(at your option) any later version.',0Ah
		db 0Ah
		db 'It is distributed in the hope that it will be useful,',0Ah
		db 'but WITHOUT ANY WARRANTY; without even the implied warranty of',0Ah
		db 'MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the',0Ah
		db 'GNU General Public License for more details.',0Ah
		db 0Ah
		db 'You should have received a copy of the GNU General Public License'
		db 0Ah
		db 'along with this software.  If not, see <http://www.gnu.org/licens'
		db 'es/>.',0Ah,0
dword_41C790	dd 0			; DATA XREF: sub_413D19:loc_413D95o
off_41C794	dd offset loc_413D5F	; DATA XREF: sub_413D19+3Dr
		dd offset loc_413D68	; jump table for switch	statement
		dd offset loc_413D9D
		dd offset loc_413D71
		dd offset loc_413D7A
		dd offset loc_413D83
		dd offset loc_413D8C
		dd offset loc_413D9D
		dd offset loc_413D9D
		dd offset loc_413D9D
		dd offset loc_413D9D
		dd offset loc_413D9D
		dd offset loc_413D9D
		dd offset loc_413D9D
		dd offset loc_413D9D
		dd offset loc_413D9D
		dd offset loc_413D9D
		dd offset loc_413D9D
		dd offset loc_413D9D
		dd offset loc_413D9D
		dd offset loc_413D9D
		dd offset loc_413D9D
		dd offset loc_413D9D
		dd offset loc_413D9D
		dd offset loc_413D9D
		dd offset loc_413D9D
		dd offset loc_413D9D
		dd offset loc_413D9D
		dd offset loc_413D9D
		dd offset loc_413D9D
		dd offset loc_413D95
		dd offset loc_413D95
asc_41C814	db ' ',9,0Dh,0Ah,0      ; DATA XREF: .text:0041419Eo
					; .text:00414236o
a__1		db '.',0                ; DATA XREF: .text:00414323o
		align 4
a____Gnupg22__5	db '../../gnupg2-2.0.30/jnlib/stringhelp.c',0 ; DATA XREF: sub_41438A+A0o
; char aHome_0[]
aHome_0		db 'HOME',0             ; DATA XREF: sub_41438A:loc_4144ABo
; char aX02x_0[]
aX02x_0		db 'x%02x',0            ; DATA XREF: sub_41493F+164o
					; .text:00414EA3o
; char word_41C84E[]
word_41C84E	dw 0			; DATA XREF: sub_415777+Co
					; sub_4157B6+Co
aFatalTooManyAr	db 0Ah			; DATA XREF: sub_4157B6+56o
		db 'fatal: too many args for xstrconcat',0Ah,0
aFatalOutOfMemo	db 0Ah			; DATA XREF: sub_4157B6+81o
		db 'fatal: out of memory',0Ah,0
aDo_make_filena	db 'do_make_filename',0 ; DATA XREF: sub_41438A+90o
		align 10h
aIso88591	db 'iso-8859-1',0       ; DATA XREF: sub_41586C+D9o
					; sub_41596B:loc_415B40o ...
aUtf8		db 'utf-8',0            ; DATA XREF: sub_41586C+22o
					; sub_41596B+20Fo ...
		align 4
; char aConversionFrom[]
aConversionFrom	db 'conversion from `%s',27h,' to `%s',27h,' not available',0Ah,0
					; DATA XREF: sub_41586C+71o
; char aIconv_openFail[]
aIconv_openFail	db 'iconv_open failed: %s',0Ah,0 ; DATA XREF: sub_41586C+B1o
; char aCpU[]
aCpU		db 'CP%u',0             ; DATA XREF: sub_41596B:loc_415996o
aCp936		db 'CP936',0            ; DATA XREF: sub_41596B+4Eo
aGbk		db 'GBK',0
aCp1361		db 'CP1361',0
aJohab		db 'JOHAB',0
aCp20127	db 'CP20127',0
aAscii_0	db 'ASCII',0
aCp20866	db 'CP20866',0
aKoi8R		db 'KOI8-R',0
aCp21866	db 'CP21866',0
aKoi8Ru		db 'KOI8-RU',0
aCp28591	db 'CP28591',0
aIso88591_0	db 'ISO-8859-1',0
aCp28592	db 'CP28592',0
aIso88592	db 'ISO-8859-2',0
aCp28593	db 'CP28593',0
aIso88593	db 'ISO-8859-3',0
aCp28594	db 'CP28594',0
aIso88594	db 'ISO-8859-4',0
aCp28595	db 'CP28595',0
aIso88595	db 'ISO-8859-5',0
aCp28596	db 'CP28596',0
aIso88596	db 'ISO-8859-6',0
aCp28597	db 'CP28597',0
aIso88597	db 'ISO-8859-7',0
aCp28598	db 'CP28598',0
aIso88598	db 'ISO-8859-8',0
aCp28599	db 'CP28599',0
aIso88599	db 'ISO-8859-9',0
aCp28605	db 'CP28605',0
aIso885915	db 'ISO-8859-15',0
aCp65001	db 'CP65001',0
aUtf8_1		db 'UTF-8',0
		align 2
aIso		db 'iso',0              ; DATA XREF: sub_41596B+13Co
a88591		db '8859-1',0           ; DATA XREF: sub_41596B+179o
a646		db '646',0              ; DATA XREF: sub_41596B+190o
aAscii		db 'ASCII',0            ; DATA XREF: sub_41596B+1A7o
aAnsi_x3_41968	db 'ANSI_X3.4-1968',0   ; DATA XREF: sub_41596B+1BEo
aUtf8_0		db 'utf8',0             ; DATA XREF: sub_41596B:loc_415B63o
		align 4
; char aConversionFr_0[]
aConversionFr_0	db 'conversion from `%s',27h,' to `%s',27h,' failed: %s',0Ah,0
					; DATA XREF: sub_415C81+1EEo
					; sub_415ECD+730o
; char aX02x_1[]
aX02x_1		db '\x%02x',0           ; DATA XREF: sub_415ECD+7Co
					; sub_415ECD+3AFo ...
; char aX02x_2[]
aX02x_2		db 'x%02x',0            ; DATA XREF: sub_415ECD+1DCo
		align 10h
a____Gnupg22__6	db '../../gnupg2-2.0.30/jnlib/utf8conv.c',0 ; DATA XREF: sub_415ECD+6BEo
		align 4
off_41CA98	dd offset loc_416080	; DATA XREF: sub_415ECD+12Ar
		dd offset loc_416096	; jump table for switch	statement
		dd offset loc_416096
		dd offset loc_416096
		dd offset loc_416096
		dd offset loc_416096
		dd offset loc_416096
		dd offset loc_416096
		dd offset loc_41606A
		dd offset loc_416096
		dd offset loc_416000
		dd offset loc_416054
		dd offset loc_41603A
		dd offset loc_41601D
aDo_utf8_to_nat	db 'do_utf8_to_native',0 ; DATA XREF: sub_415ECD+6AEo
		align 4
; char aTz[]
aTz		db 'TZ',0               ; DATA XREF: sub_416882+7o
					; sub_416882:loc_416938o
; char EnvString[]
EnvString	db 'TZ=UTC',0           ; DATA XREF: sub_416882+16o
aTz_0		db 'TZ=',0              ; DATA XREF: sub_416882+7Co
		align 4
aHkey_classes_r	db 'HKEY_CLASSES_ROOT',0 ; DATA XREF: sub_416954+1Fo
aHkey_current_u	db 'HKEY_CURRENT_USER',0 ; DATA XREF: sub_416954+53o
aHkey_local_mac	db 'HKEY_LOCAL_MACHINE',0 ; DATA XREF: sub_416954+87o
aHkey_users	db 'HKEY_USERS',0       ; DATA XREF: sub_416954+BBo
aHkey_performan	db 'HKEY_PERFORMANCE_DATA',0 ; DATA XREF: sub_416954+ECo
aHkey_current_c	db 'HKEY_CURRENT_CONFIG',0 ; DATA XREF: sub_416954+11Do
; CHAR LibFileName[]
LibFileName	db 'mingwm10.dll',0     ; DATA XREF: TlsCallback_0+4Eo
; CHAR a__mingwthr_rem[]
a__mingwthr_rem	db '__mingwthr_remove_key_dtor',0 ; DATA XREF: TlsCallback_0+71o
; CHAR a__mingwthr_key[]
a__mingwthr_key	db '__mingwthr_key_dtor',0 ; DATA XREF: TlsCallback_0+8Bo
off_41CB9C	dd offset TlsCallback_0	; DATA XREF: sub_401180:loc_401273r
aUnknownError	db 'Unknown error',0    ; DATA XREF: sub_4172E0+3o
		align 10h
; char a_matherrSInSGG[]
a_matherrSInSGG	db '_matherr(): %s in %s(%g, %g)  (retval=%g)',0Ah,0
					; DATA XREF: sub_4172E0+39o
		align 4
aArgumentDomain	db 'Argument domain error (DOMAIN)',0 ; DATA XREF: .rdata:off_41CCBCo
aArgumentSingul	db 'Argument singularity (SIGN)',0 ; DATA XREF: .rdata:0041CCC0o
		align 4
aOverflowRangeE	db 'Overflow range error (OVERFLOW)',0 ; DATA XREF: .rdata:0041CCC4o
aTheResultIsToo	db 'The result is too small to be represented (UNDERFLOW)',0
					; DATA XREF: .rdata:0041CCC8o
		align 10h
aTotalLossOfSig	db 'Total loss of significance (TLOSS)',0 ; DATA XREF: .rdata:0041CCCCo
		align 4
aPartialLossOfS	db 'Partial loss of significance (PLOSS)',0 ; DATA XREF: .rdata:0041CCD0o
		align 4
off_41CCBC	dd offset aArgumentDomain ; DATA XREF: sub_4172E0+16r
					; "Argument domain error (DOMAIN)"
		dd offset aArgumentSingul ; "Argument singularity (SIGN)"
		dd offset aOverflowRangeE ; "Overflow range error (OVERFLOW)"
		dd offset aTheResultIsToo ; "The result	is too small to	be represent"...
		dd offset aTotalLossOfSig ; "Total loss	of significance	(TLOSS)"
		dd offset aPartialLossOfS ; "Partial loss of significance (PLOSS)"
aMingwW64Runtim	db 'Mingw-w64 runtime failure:',0Ah,0 ; DATA XREF: sub_417350+1Do
; char aAddressPHasNoI[]
aAddressPHasNoI	db 'Address %p has no image-section',0 ; DATA XREF: sub_4173B0+20Do
; char aVirtualqueryFa[]
aVirtualqueryFa	db '  VirtualQuery failed for %d bytes at address %p',0
					; DATA XREF: sub_4173B0+1F9o
					; sub_4173B0+225o ...
		align 4
; char aVirtualprotect[]
aVirtualprotect	db '  VirtualProtect failed with code 0x%x',0 ; DATA XREF: sub_4173B0+1D2o
		align 4
; char aUnknownPseud_0[]
aUnknownPseud_0	db '  Unknown pseudo relocation protocol version %d.',0Ah,0
					; DATA XREF: sub_4175F0+299o
		align 10h
; char aUnknownPseudoR[]
aUnknownPseudoR	db '  Unknown pseudo relocation bit size %d.',0Ah,0
					; DATA XREF: sub_4175F0+1B7o
		align 4
; const	WCHAR aMsvcrt_dll
aMsvcrt_dll:				; DATA XREF: sub_417BA0:loc_417C40o
		unicode	0, <msvcrt.dll>,0
		align 4
off_41CDE4	dd offset dword_41D860	; DATA XREF: .text:00417E38o
		dd offset dword_41D580
; char aAssertionFaile[]
aAssertionFaile	db 'Assertion failed!',0Ah ; DATA XREF: sub_4183C0+EAo
		db 0Ah
		db 'Program: %s',0Ah
		db 'File: %s, Line %u',0Ah
		db 0Ah
		db 'Expression: %s',0
; char aS_2[]
aS_2		db '%s',0Ah,0           ; DATA XREF: sub_4183C0+1C2o
; CHAR Caption[]
Caption		db 'MinGW Runtime Assertion',0 ; DATA XREF: sub_4183C0+10Fo
		align 4
dword_41CE4C	dd 0			; DATA XREF: sub_4175F0+59o
					; sub_4175F0+5Eo ...
dword_41CE50	dd 0			; DATA XREF: sub_4175F0+7Fr
dword_41CE54	dd 0			; DATA XREF: sub_4175F0:loc_41773Cr
dword_41CE58	dd 6Ah dup(0)		; DATA XREF: sub_4175F0+155o
_rdata		ends

; Section 4. (virtual address 0001D000)
; Virtual size			: 00000934 (   2356.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0600080: Bss Readable Writable
; Alignment	: 32 bytes
; ===========================================================================

; Segment type:	Uninitialized
; Segment permissions: Read/Write
; Segment alignment '32byte' can not be represented in assembly
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 41D000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_41D000	dd ?			; DATA XREF: sub_401180+D0w
					; sub_401180+27Dr
dword_41D004	dd ?			; DATA XREF: sub_401010+2Ao
					; sub_401180:loc_401344r ...
dword_41D008	dd ?			; DATA XREF: sub_401010+18o
					; sub_401180+1DEr ...
dword_41D00C	dd ?			; DATA XREF: sub_401010+10o
					; sub_401180+243r ...
dword_41D010	dd ?			; DATA XREF: sub_401180+272w
					; sub_401180+28Cr
dword_41D014	dd ?			; DATA XREF: sub_401060:loc_401098w
					; sub_401180+26Ar
dword_41D018	dd ?			; DATA XREF: sub_401010+8o
					; sub_401010+20w
dword_41D01C	dd ?			; DATA XREF: sub_401010+3Aw
dword_41D020	dd ?			; DATA XREF: sub_402B1B+6r
dword_41D024	dd ?			; DATA XREF: sub_402B1B+Fr
		align 20h
dword_41D040	dd 8 dup(?)		; DATA XREF: sub_402B1B+37o
					; sub_402B1B+4Ao
dword_41D060	dd ?			; DATA XREF: sub_402ABC+6r
dword_41D064	dd ?			; DATA XREF: sub_402ABC+Fr
		align 20h
dword_41D080	dd 8 dup(?)		; DATA XREF: sub_402ABC+37o
					; sub_402ABC+4Ao
dword_41D0A0	dd ?			; DATA XREF: .text:00404E83r
					; .text:00404E8Cw
dword_41D0A4	dd ?			; DATA XREF: .text:00404EC0w
					; .text:00404EDAo
dword_41D0A8	dd ?			; DATA XREF: .text:00404EC5o
dword_41D0AC	dd ?			; DATA XREF: sub_405596+3Fr
					; sub_405596+4Eo ...
dword_41D0B0	dd ?			; DATA XREF: sub_405596+2Ar
					; sub_405596+7Ar ...
dword_41D0B4	dd ?			; DATA XREF: .text:004082FDw
					; sub_40831E+ADr
dword_41D0B8	dd ?			; DATA XREF: sub_40831E+E8r
dword_41D0BC	dd ?			; DATA XREF: sub_40831E+11Dr
byte_41D0C0	db ?			; DATA XREF: .text:004082EBo
					; .text:00408307o ...
byte_41D0C1	db ?			; DATA XREF: sub_40831E+DDr
byte_41D0C2	db ?			; DATA XREF: sub_40831E:loc_408430r
		align 4
dword_41D0C4	dd ?			; DATA XREF: sub_405721+6r
					; sub_405721+Fw
		align 20h
dword_41D0E0	dd ?			; DATA XREF: sub_40A632+2Dr
					; sub_40A632+41r ...
dword_41D0E4	dd ?			; DATA XREF: sub_40A632+15r
					; sub_40A632:loc_40A655r ...
		align 20h
dword_41D100	dd ?			; DATA XREF: .text:0040AFCBw
					; .text:0040AFEEo ...
dword_41D104	dd ?			; DATA XREF: .text:0040AFD4w
word_41D108	dw ?			; DATA XREF: .text:0040AFDEw
byte_41D10A	db ?			; DATA XREF: .text:0040AFE9w
		align 4
		dd 9 dup(?)
		db ?
byte_41D131	db ?			; DATA XREF: .text:0040B027w
; char Dest[]
Dest		dd ?			; DATA XREF: sub_40AEEF+1Dw
					; sub_40AEEF+A9o ...
dword_41D136	dd ?			; DATA XREF: sub_40AEEF+26w
dword_41D13A	dd ?			; DATA XREF: sub_40AEEF+2Fw
dword_41D13E	dd ?			; DATA XREF: sub_40AEEF+38w
dword_41D142	dd ?			; DATA XREF: sub_40AEEF+41w
		align 10h
dword_41D150	dd ?			; DATA XREF: .text:0040AE75w
					; .text:0040AED8o ...
dword_41D154	dd ?			; DATA XREF: .text:0040AE7Ew
word_41D158	dw ?			; DATA XREF: .text:0040AE88w
byte_41D15A	db ?			; DATA XREF: .text:0040AE93w
		align 10h
dword_41D160	dd 8 dup(?)		; DATA XREF: .text:0040AE09o
					; .text:0040AE1Bo ...
dword_41D180	dd ?			; DATA XREF: sub_40BC73+20r
					; .text:0040BDB8r ...
dword_41D184	dd ?			; DATA XREF: sub_40BF40+E4w
					; sub_40C1F7+Er
dword_41D188	dd ?			; DATA XREF: .text:loc_40C563r
					; .text:0040C5CAw ...
dword_41D18C	dd ?			; DATA XREF: .text:loc_40C5FCr
					; .text:0040C663w ...
dword_41D190	dd ?			; DATA XREF: .text:loc_40C695r
					; .text:0040C6FCw ...
dword_41D194	dd ?			; DATA XREF: .text:loc_40C72Er
					; .text:0040C795w ...
dword_41D198	dd ?			; DATA XREF: .text:loc_40C7C7r
					; .text:0040C82Ew ...
dword_41D19C	dd ?			; DATA XREF: .text:loc_40C860r
					; .text:0040C8C7w ...
dword_41D1A0	dd ?			; DATA XREF: .text:loc_40C8F9r
					; .text:0040C960w ...
dword_41D1A4	dd ?			; DATA XREF: .text:loc_40C992r
					; .text:0040C9F9w ...
dword_41D1A8	dd ?			; DATA XREF: .text:loc_40CA2Br
					; .text:0040CA92w ...
dword_41D1AC	dd ?			; DATA XREF: .text:loc_40CAC4r
					; .text:0040CB2Bw ...
dword_41D1B0	dd ?			; DATA XREF: .text:0040C444r
					; .text:0040C508w ...
dword_41D1B4	dd ?			; DATA XREF: sub_40C396+8r
					; sub_40C396+6Fw ...
dword_41D1B8	dd ?			; DATA XREF: .text:0040C2FBr
					; .text:0040C362w ...
dword_41D1BC	dd ?			; DATA XREF: .text:0040C258r
					; .text:0040C2BFw ...
dword_41D1C0	dd ?			; DATA XREF: sub_40C1F7+17r
					; sub_40C1F7+3Bw ...
dword_41D1C4	dd ?			; DATA XREF: .text:0040C15Cr
					; .text:0040C1C3w ...
dword_41D1C8	dd ?			; DATA XREF: sub_40C06D+Br
					; sub_40C06D+C1w ...
dword_41D1CC	dd ?			; DATA XREF: sub_40BF40+8r
					; sub_40BF40:loc_40BF9Dw
		align 20h
; CHAR byte_41D1E0
byte_41D1E0	db ?			; DATA XREF: sub_40BF40+1Do
					; sub_40BF40+56w ...
		align 4
		dd 42h dup(?)
dword_41D2EC	dd ?			; DATA XREF: .text:loc_40BDEEr
					; .text:0040BE51w ...
; LPCSTR lpPathName
lpPathName	dd ?			; DATA XREF: sub_40BC73+Br
					; sub_40BC73+44w ...
dword_41D2F4	dd ?			; DATA XREF: sub_40BB99+6r
					; sub_40BB99+13w
dword_41D2F8	dd ?			; DATA XREF: sub_40BB99+63w
					; sub_40BB99+68r ...
		align 10h
; void *dword_41D300
dword_41D300	dd ?			; DATA XREF: sub_41082E+232r
					; sub_41082E+23Br ...
dword_41D304	dd ?			; DATA XREF: sub_410AEE+7r
					; sub_4111A2+6w
		align 20h
; FILE *File
File		dd ?			; DATA XREF: sub_4111E5+8r
					; sub_4111E5+19r ...
		align 20h
; char byte_41D340[79]
byte_41D340	db 4Fh dup(?)		; DATA XREF: sub_411494+1Bo
					; .text:loc_411564o ...
byte_41D38F	db ?			; DATA XREF: sub_411494+27w
dword_41D390	dd ?			; DATA XREF: sub_411494+3Fw
					; .text:loc_41151Cr ...
dword_41D394	dd ?			; DATA XREF: sub_411494+34w
					; .text:00411504r ...
dword_41D398	dd ?			; DATA XREF: sub_411494+4Aw
					; .text:loc_411534r ...
dword_41D39C	dd ?			; DATA XREF: .text:0041148Dw
					; sub_411606:loc_411758r ...
dword_41D3A0	dd ?			; DATA XREF: sub_411494+57w
					; .text:loc_41154Cr
dword_41D3A4	dd ?			; DATA XREF: sub_4111E5+249w
					; sub_411606+88r ...
dword_41D3A8	dd ?			; DATA XREF: sub_4111E5+24Ew
					; sub_411606:loc_411649r ...
dword_41D3AC	dd ?			; DATA XREF: sub_4111B0+6r
					; sub_4111B0+14w ...
		align 20h
dword_41D3C0	dd ?			; DATA XREF: sub_413D19+6r
					; sub_413D19+Fr ...
		align 20h
; CHAR Buffer[256]
Buffer		db 100h	dup(?)		; DATA XREF: sub_414F2A+29o
					; sub_414F2A+56o
dword_41D4E0	dd ?			; DATA XREF: sub_41586C+E3w
					; sub_41596B+1DFw ...
dword_41D4E4	dd ?			; DATA XREF: sub_41586C+EDw
					; sub_41596B+1E9w ...
dword_41D4E8	dd ?			; DATA XREF: sub_415ECD+70Er
					; sub_415ECD:loc_416621w
dword_41D4EC	dd ?			; DATA XREF: sub_415C81+1CCr
					; sub_415C81:loc_415E93w
; char byte_41D4F0[32]
byte_41D4F0	db 20h dup(?)		; DATA XREF: sub_41596B+3Bo
					; sub_41596B+47o ...
dword_41D510	dd ?			; DATA XREF: sub_41586C+45r
					; sub_41586C+4Dw
dword_41D514	dd ?			; DATA XREF: sub_41586C:loc_4158C5r
					; sub_41586C+61w
dword_41D518	dd ?			; DATA XREF: sub_41586C:loc_415901r
					; sub_41586C:loc_415935w
; char *dword_41D51C
dword_41D51C	dd ?			; DATA XREF: sub_416882+3Br
					; sub_416882+6Ew ...
dword_41D520	dd ?			; DATA XREF: sub_401010+3r
dword_41D524	dd ?			; DATA XREF: sub_401010+25r
dword_41D528	dd ?			; DATA XREF: sub_401060+22w
dword_41D52C	dd ?			; DATA XREF: sub_401060+18w
dword_41D530	dd ?			; DATA XREF: sub_401060+Ew
TlsIndex	dd ?			; DATA XREF: .tls:TlsIndex_ptro
; HMODULE hLibModule
hLibModule	dd ?			; DATA XREF: TlsCallback_0+60w
					; TlsCallback_0+83r ...
dword_41D53C	dd ?			; DATA XREF: sub_401060+2Cw
dword_41D540	dd ?			; DATA XREF: sub_401060+3Dr
					; sub_401180+61r ...
dword_41D544	dd ?			; DATA XREF: sub_401060+5Er
dword_41D548	dd ?			; DATA XREF: sub_401180+12Dw
					; TopLevelExceptionFilter:loc_41715Cr
dword_41D54C	dd ?			; DATA XREF: .text:00417283r
					; sub_4172D0+4w
dword_41D550	dd ?			; DATA XREF: sub_4175F0+9r
					; sub_4175F0:loc_417610w
dword_41D554	dd ?			; DATA XREF: sub_4173B0+1Dr
					; sub_4173B0+58r ...
dword_41D558	dd ?			; DATA XREF: sub_4173B0+Br
					; sub_4173B0:loc_41746Fw ...
dword_41D55C	dd ?			; DATA XREF: sub_417BA0+4r
					; sub_417BA0+92w ...
dword_41D560	dd ?			; DATA XREF: sub_417CF0r
					; sub_417CF0:loc_417D00w
		align 20h
dword_41D580	dd 2Bh dup(?)		; DATA XREF: .rdata:0041CDE8o
dword_41D62C	dd ?			; DATA XREF: .text:00417E1Aw
		dd 2 dup(?)
dword_41D638	dd ?			; DATA XREF: .text:00417E06w
		dd 2 dup(?)
dword_41D644	dd ?			; DATA XREF: .text:00417DECw
		dd 86h dup(?)
dword_41D860	dd ?			; DATA XREF: .text:00417DF2w
					; .rdata:off_41CDE4o
dword_41D864	dd ?			; DATA XREF: .text:00417DFCw
		dd ?
dword_41D86C	dd ?			; DATA XREF: .text:00417E0Bw
		dd 14h dup(?)
dword_41D8C0	dd ?			; DATA XREF: .text:00417EE3r
					; .text:00417F74r ...
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_417E70+7o
					; sub_417E70:loc_417EC5o ...
dword_41D8DC	dd ?			; DATA XREF: sub_417E70+14r
					; .text:00417F38r ...
		dd ?
dword_41D8E4	dd ?			; DATA XREF: sub_401180+1A8w
dword_41D8E8	dd ?			; DATA XREF: sub_401180+1BFw
dword_41D8EC	dd ?			; DATA XREF: sub_401180+1B2w
dword_41D8F0	dd ?			; DATA XREF: sub_401695:loc_4017D8r
					; sub_401695+14Bw ...
dword_41D8F4	dd ?			; DATA XREF: sub_401695:loc_4017CCw
; char *Filename
Filename	dd ?			; DATA XREF: sub_401695+11Fw
					; sub_401695:loc_401A40r ...
dword_41D8FC	dd ?			; DATA XREF: sub_401695+19Cw
; char *Str
Str		dd ?			; DATA XREF: sub_401695+12Dw
					; sub_401695+2C6r ...
		align 8
dword_41D908	dd ?			; DATA XREF: TlsCallback_0+A3w
					; TlsCallback_0:loc_416F43w ...
dword_41D90C	dd ?			; DATA XREF: TlsCallback_0+7Ew
					; TlsCallback_0+AEr ...
dword_41D910	dd ?			; DATA XREF: TlsCallback_0:loc_416E94w
dword_41D914	dd ?			; DATA XREF: sub_401060+64w
					; sub_417010+3Fr ...
dword_41D918	dd ?			; DATA XREF: sub_401060+69w
					; sub_417010+4r ...
dword_41D91C	dd ?			; DATA XREF: sub_401180+A0o
					; sub_401180+ECw
dword_41D920	dd ?			; DATA XREF: sub_401180+B3r
					; sub_401180:loc_401243r ...
		align 800h
_bss		ends

;
; Imports from libgpg-error-0.dll
;
; Section 5. (virtual address 0001E000)
; Virtual size			: 00000FF4 (   4084.)
; Section size in file		: 00001000 (   4096.)
; Offset to raw	data for section: 0001B000
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Externs
; _idata
		extrn __imp_gpg_err_code_from_syserror:dword
					; DATA XREF: gpg_err_code_from_syserrorr
		extrn __imp_gpg_strerror:dword ; DATA XREF: gpg_strerrorr

;
; Imports from libiconv-2.dll
;
		extrn __imp_libiconv:dword ; DATA XREF:	libiconvr
		extrn __imp_libiconv_close:dword ; DATA	XREF: libiconv_closer
		extrn __imp_libiconv_open:dword	; DATA XREF: libiconv_openr

;
; Imports from ADVAPI32.dll
;
; BOOL __stdcall CopySid(DWORD nDestinationSidLength, PSID pDestinationSid, PSID pSourceSid)
		extrn CopySid:dword	; CODE XREF: .text:004053F6p
					; DATA XREF: .text:004053F1r
; DWORD	__stdcall GetLengthSid(PSID pSid)
		extrn GetLengthSid:dword ; CODE	XREF: .text:004053BFp
					; DATA XREF: .text:004053BAr
; BOOL __stdcall GetTokenInformation(HANDLE TokenHandle, TOKEN_INFORMATION_CLASS TokenInformationClass,	LPVOID TokenInformation, DWORD TokenInformationLength, PDWORD ReturnLength)
		extrn GetTokenInformation:dword	; CODE XREF: .text:0040533Ap
					; .text:00405393p
					; DATA XREF: ...
; BOOL __stdcall IsValidSid(PSID pSid)
		extrn IsValidSid:dword	; CODE XREF: .text:004053A9p
					; DATA XREF: .text:004053A4r
; BOOL __stdcall OpenProcessToken(HANDLE ProcessHandle,	DWORD DesiredAccess, PHANDLE TokenHandle)
		extrn OpenProcessToken:dword ; CODE XREF: .text:00405303p
					; DATA XREF: .text:004052FEr
; LSTATUS __stdcall RegCloseKey(HKEY hKey)
		extrn RegCloseKey:dword	; CODE XREF: sub_416AAE+314p
					; DATA XREF: sub_416AAE+30Fr
; LSTATUS __stdcall RegOpenKeyExA(HKEY hKey, LPCSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY	phkResult)
		extrn RegOpenKeyExA:dword ; CODE XREF: sub_416AAE+55p
					; sub_416AAE+98p
					; DATA XREF: ...
; LSTATUS __stdcall RegQueryValueExA(HKEY hKey,	LPCSTR lpValueName, LPDWORD lpReserved,	LPDWORD	lpType,	LPBYTE lpData, LPDWORD lpcbData)
		extrn RegQueryValueExA:dword ; CODE XREF: sub_416AAE+E3p
					; sub_416AAE+140p
					; DATA XREF: ...

;
; Imports from KERNEL32.dll
;
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: .text:0040518Ep
					; .text:0040543Bp ...
; BOOL __stdcall CreateDirectoryA(LPCSTR lpPathName, LPSECURITY_ATTRIBUTES lpSecurityAttributes)
		extrn CreateDirectoryA:dword ; CODE XREF: .text:00405088p
					; sub_40981F+EDp ...
; HANDLE __stdcall CreateFileA(LPCSTR lpFileName, DWORD	dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes,	DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE	hTemplateFile)
		extrn CreateFileA:dword	; CODE XREF: .text:00405153p
					; sub_40981F+1B6p ...
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_418010+44p
					; DATA XREF: sub_418010+44r
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_417E70+Ep
					; .text:00417F32p ...
; DWORD	__stdcall ExpandEnvironmentStringsA(LPCSTR lpSrc, LPSTR	lpDst, DWORD nSize)
		extrn ExpandEnvironmentStringsA:dword ;	CODE XREF: sub_416AAE+1CFp
					; sub_416AAE+235p
					; DATA XREF: ...
; BOOL __stdcall FindClose(HANDLE hFindFile)
		extrn FindClose:dword	; CODE XREF: sub_402302+479p
					; DATA XREF: sub_402302+474r
; HANDLE __stdcall FindFirstFileW(LPCWSTR lpFileName, LPWIN32_FIND_DATAW lpFindFileData)
		extrn FindFirstFileW:dword ; CODE XREF:	sub_402302+253p
					; DATA XREF: sub_402302+24Er
; BOOL __stdcall FindNextFileW(HANDLE hFindFile, LPWIN32_FIND_DATAW lpFindFileData)
		extrn FindNextFileW:dword ; CODE XREF: sub_402302+40Bp
					; DATA XREF: sub_402302+406r
; DWORD	__stdcall FormatMessageA(DWORD dwFlags,	LPCVOID	lpSource, DWORD	dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments)
		extrn FormatMessageA:dword ; CODE XREF:	sub_414F2A+51p
					; DATA XREF: sub_414F2A+4Cr
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: TlsCallback_0+10Ap
					; DATA XREF: TlsCallback_0+10Ar
; UINT __stdcall GetACP()
		extrn GetACP:dword	; CODE XREF: sub_41596B+26p
					; DATA XREF: sub_41596B+21r
; UINT __stdcall GetConsoleOutputCP()
		extrn GetConsoleOutputCP:dword ; CODE XREF: sub_41596B+16p
					; DATA XREF: sub_41596B+11r
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: .text:00417E48p
					; DATA XREF: .text:00417E48r
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: .text:00404F82p
					; .text:004052BDp ...
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_417D10+74p
					; DATA XREF: sub_417D10+74r
; BOOL __stdcall GetFileAttributesExW(LPCWSTR lpFileName, GET_FILEEX_INFO_LEVELS fInfoLevelId, LPVOID lpFileInformation)
		extrn GetFileAttributesExW:dword ; CODE	XREF: sub_401EBC+BCp
					; DATA XREF: sub_401EBC+B7r
; BOOL __stdcall GetFileInformationByHandle(HANDLE hFile, LPBY_HANDLE_FILE_INFORMATION lpFileInformation)
		extrn GetFileInformationByHandle:dword ; CODE XREF: .text:0041680Cp
					; .text:00416827p
					; DATA XREF: ...
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_402302+423p
					; .text:00405348p ...
; DWORD	__stdcall GetModuleFileNameA(HMODULE hModule, LPSTR lpFilename,	DWORD nSize)
		extrn GetModuleFileNameA:dword ; CODE XREF: sub_40BF40+31p
					; sub_4183C0+C2p
					; DATA XREF: ...
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_4014F0+16p
					; sub_417BA0+87p
					; DATA XREF: ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_401180+142p
					; sub_4014F0+33p ...
; void __stdcall GetStartupInfoA(LPSTARTUPINFOA	lpStartupInfo)
		extrn GetStartupInfoA:dword ; CODE XREF: sub_401180+2F6p
					; DATA XREF: sub_401180+2F6r
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_417D10+57p
					; DATA XREF: sub_417D10+57r
; DWORD	__stdcall GetTempPathA(DWORD nBufferLength, LPSTR lpBuffer)
		extrn GetTempPathA:dword ; CODE	XREF: .text:00404FCBp
					; sub_40981F+2Ap
					; DATA XREF: ...
; LCID __stdcall GetThreadLocale()
		extrn GetThreadLocale:dword ; CODE XREF: sub_40F664+7Fp
					; DATA XREF: sub_40F664:loc_40F6DEr
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: .text:004050B4p
					; sub_40981F+119p ...
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_418010+87p
					; DATA XREF: sub_418010+87r
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_417E70+5Cp
					; .text:00417F50p ...
; HMODULE __stdcall LoadLibraryA(LPCSTR	lpLibFileName)
		extrn LoadLibraryA:dword ; CODE	XREF: sub_40BB0C+11p
					; TlsCallback_0+55p
					; DATA XREF: ...
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: sub_417BA0+A7p
					; DATA XREF: sub_417BA0+A7r
; int __stdcall	MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr,	int cchWideChar)
		extrn MultiByteToWideChar:dword	; CODE XREF: sub_401D49+39p
					; sub_401D49+DAp ...
; HANDLE __stdcall OpenProcess(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwProcessId)
		extrn OpenProcess:dword	; CODE XREF: .text:004052D7p
					; DATA XREF: .text:004052D2r
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_417D10+8Bp
					; DATA XREF: sub_417D10+8Br
; LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter)
		extrn SetUnhandledExceptionFilter:dword	; CODE XREF: sub_401180+124p
					; .text:00417E2Fp
					; DATA XREF: ...
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_401180+8Fp
					; .text:00404EF8p ...
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: .text:00417E59p
					; DATA XREF: .text:00417E59r
; LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex)
		extrn TlsGetValue:dword	; CODE XREF: sub_417E70+35p
					; DATA XREF: sub_417E70+21r
; LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo)
		extrn UnhandledExceptionFilter:dword ; CODE XREF: .text:00417E3Fp
					; DATA XREF: .text:00417E3Fr
; BOOL __stdcall VirtualProtect(LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtect:dword ; CODE XREF:	sub_4173B0+142p
					; sub_4173B0+184p ...
; SIZE_T __stdcall VirtualQuery(LPCVOID	lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength)
		extrn VirtualQuery:dword ; CODE	XREF: sub_4173B0+A1p
					; sub_4173B0+D9p ...
; int __stdcall	WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR	lpMultiByteStr,	int cbMultiByte, LPCSTR	lpDefaultChar, LPBOOL lpUsedDefaultChar)
		extrn WideCharToMultiByte:dword	; CODE XREF: sub_401C4A+49p
					; sub_401C4A+CDp ...

;
; Imports from msvcrt.dll
;
		extrn __imp__access:dword ; DATA XREF: _accessr
		extrn __imp__close:dword ; DATA	XREF: _closer
; FILE *__cdecl	_fdopen(int FileHandle,	const char *Format)
		extrn __imp__fdopen:dword ; DATA XREF: _fdopenr
; int __cdecl _fileno(FILE *File)
		extrn __imp__fileno:dword ; DATA XREF: _filenor
		extrn __imp__getpid:dword ; DATA XREF: _getpidr
		extrn __imp__mkdir:dword ; DATA	XREF: _mkdirr
		extrn __imp__open:dword	; DATA XREF: _openr
; int __cdecl _putenv(const char *EnvString)
		extrn __imp__putenv:dword ; DATA XREF: _putenvr
		extrn __imp__read:dword	; DATA XREF: _readr
		extrn __imp__setmode:dword ; DATA XREF:	_setmoder
; void __cdecl _tzset()
		extrn __imp__tzset:dword ; DATA	XREF: _tzsetr
		extrn __imp__write:dword ; DATA	XREF: _writer

;
; Imports from msvcrt.dll
;
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
		extrn __imp___getmainargs:dword	; DATA XREF: __getmainargsr
		extrn __initenv:dword	; DATA XREF: sub_401180+23Er
		extrn __lconv_init:dword ; DATA	XREF: sub_416FE0r
		extrn __imp___set_app_type:dword ; DATA	XREF: __set_app_typer
		extrn __imp___setusermatherr:dword ; DATA XREF:	__setusermatherrr
		extrn _acmdln:dword	; DATA XREF: sub_401180+166r
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
		extrn __imp__cexit:dword ; DATA	XREF: _cexitr
; int *__cdecl errno()
		extrn _errno:dword	; CODE XREF: sub_401C4A+5Cp
					; sub_401C4A+EBp ...
; void __cdecl __noreturn _exit(int Code)
		extrn __imp__exit:dword	; DATA XREF: _exitr
; int fmode
		extrn _fmode:dword	; DATA XREF: sub_401060+6Er
		extrn _fstati64:dword	; CODE XREF: sub_41028A+57p
					; DATA XREF: sub_41028A+52r
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
; FILE *iob
		extrn _iob:dword	; DATA XREF: sub_40831E+155r
					; sub_40831E+185r ...
		extrn __imp__lock:dword	; DATA XREF: _lockr
		extrn __imp__lseeki64:dword ; DATA XREF: _lseeki64r
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_417010+A3p
					; DATA XREF: sub_417010+A3r
		extrn _open_osfhandle:dword ; CODE XREF: sub_404EFF+2Cp
					; .text:00405178p ...
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
		extrn _winmajor:dword	; DATA XREF: TlsCallback_0+4r
; void __cdecl abort()
		extrn __imp_abort:dword	; DATA XREF: abortr
; int __cdecl atoi(const char *Str)
		extrn __imp_atoi:dword	; DATA XREF: atoir
; void *__cdecl	calloc(size_t NumOfElements, size_t SizeOfElements)
		extrn __imp_calloc:dword ; DATA	XREF: callocr
; void __cdecl __noreturn exit(int Code)
		extrn __imp_exit:dword	; DATA XREF: exitr
; int __cdecl fclose(FILE *File)
		extrn __imp_fclose:dword ; DATA	XREF: fcloser
; int __cdecl ferror(FILE *File)
		extrn __imp_ferror:dword ; DATA	XREF: ferrorr
; int __cdecl fflush(FILE *File)
		extrn __imp_fflush:dword ; DATA	XREF: fflushr
; FILE *__cdecl	fopen(const char *Filename, const char *Mode)
		extrn __imp_fopen:dword	; DATA XREF: fopenr
; int fprintf(FILE *File, const	char *Format, ...)
		extrn __imp_fprintf:dword ; DATA XREF: fprintfr
; int __cdecl fputs(const char *Str, FILE *File)
		extrn __imp_fputs:dword	; DATA XREF: fputsr
; size_t __cdecl fread(void *DstBuf, size_t ElementSize, size_t	Count, FILE *File)
		extrn __imp_fread:dword	; DATA XREF: freadr
; void __cdecl free(void *Memory)
		extrn __imp_free:dword	; DATA XREF: freer
; int __cdecl fseek(FILE *File,	__int32	Offset,	int Origin)
		extrn __imp_fseek:dword	; DATA XREF: fseekr
; __int32 __cdecl ftell(FILE *File)
		extrn __imp_ftell:dword	; DATA XREF: ftellr
; size_t __cdecl fwrite(const void *Str, size_t	Size, size_t Count, FILE *File)
		extrn __imp_fwrite:dword ; DATA	XREF: fwriter
; int __cdecl getc(FILE	*File)
		extrn __imp_getc:dword	; DATA XREF: getcr
; char *__cdecl	getenv(const char *VarName)
		extrn __imp_getenv:dword ; DATA	XREF: getenvr
; struct tm *__cdecl static gmtime(const time_t	*Time)
		extrn gmtime:dword	; DATA XREF: sub_4186D0r
; int __cdecl isspace(int C)
		extrn isspace:dword	; CODE XREF: .text:0040AA64p
					; sub_411F61+87p ...
; struct tm *__cdecl static localtime(const time_t *Time)
		extrn localtime:dword	; DATA XREF: sub_4186F0r
; void *__cdecl	malloc(size_t Size)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
; void *__cdecl	memchr(const void *Buf,	int Val, size_t	MaxCount)
		extrn __imp_memchr:dword ; DATA	XREF: memchrr
; int __cdecl memcmp(const void	*Buf1, const void *Buf2, size_t	Size)
		extrn __imp_memcmp:dword ; DATA	XREF: memcmpr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn __imp_memset:dword ; DATA	XREF: memsetr
; time_t __cdecl static	mktime(struct tm *Tm)
		extrn mktime:dword	; DATA XREF: sub_4186E0r
; int printf(const char	*Format, ...)
		extrn __imp_printf:dword ; DATA	XREF: printfr
; int __cdecl putc(int Ch, FILE	*File)
		extrn __imp_putc:dword	; DATA XREF: putcr
; int __cdecl putchar(int Ch)
		extrn __imp_putchar:dword ; DATA XREF: putcharr
; int __cdecl puts(const char *Str)
		extrn __imp_puts:dword	; DATA XREF: putsr
		extrn __imp_raise:dword	; DATA XREF: raiser
; void *__cdecl	realloc(void *Memory, size_t NewSize)
		extrn __imp_realloc:dword ; DATA XREF: reallocr
; int __cdecl remove(const char	*Filename)
		extrn __imp_remove:dword ; DATA	XREF: remover
; int __cdecl setvbuf(FILE *File, char *Buf, int Mode, size_t Size)
		extrn __imp_setvbuf:dword ; DATA XREF: setvbufr
		extrn __imp_signal:dword ; DATA	XREF: signalr
; int sprintf(char *Dest, const	char *Format, ...)
		extrn __imp_sprintf:dword ; DATA XREF: sprintfr
; char *__cdecl	strcat(char *Dest, const char *Source)
		extrn __imp_strcat:dword ; DATA	XREF: strcatr
; char *__cdecl	strchr(const char *Str,	int Val)
		extrn __imp_strchr:dword ; DATA	XREF: strchrr
; int __cdecl strcmp(const char	*Str1, const char *Str2)
		extrn __imp_strcmp:dword ; DATA	XREF: strcmpr
; char *__cdecl	strcpy(char *Dest, const char *Source)
		extrn __imp_strcpy:dword ; DATA	XREF: strcpyr
; char *__cdecl	strerror(int)
		extrn __imp_strerror:dword ; DATA XREF:	strerrorr
; size_t __cdecl strftime(char *Buf, size_t SizeInBytes, const char *Format, const struct tm *Tm)
		extrn __imp_strftime:dword ; DATA XREF:	strftimer
; size_t __cdecl strlen(const char *Str)
		extrn __imp_strlen:dword ; DATA	XREF: strlenr
; int __cdecl strncmp(const char *Str1,	const char *Str2, size_t MaxCount)
		extrn __imp_strncmp:dword ; DATA XREF: strncmpr
; char *__cdecl	strncpy(char *Dest, const char *Source,	size_t Count)
		extrn __imp_strncpy:dword ; DATA XREF: strncpyr
; char *__cdecl	strpbrk(const char *Str, const char *Control)
		extrn __imp_strpbrk:dword ; DATA XREF: strpbrkr
; char *__cdecl	strrchr(const char *Str, int Ch)
		extrn __imp_strrchr:dword ; DATA XREF: strrchrr
; char *__cdecl	strstr(const char *Str,	const char *SubStr)
		extrn __imp_strstr:dword ; DATA	XREF: strstrr
; __int32 __cdecl strtol(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtol:dword ; DATA	XREF: strtolr
; unsigned __int32 __cdecl strtoul(const char *Str, char **EndPtr, int Radix)
		extrn __imp_strtoul:dword ; DATA XREF: strtoulr
; time_t __cdecl static	time(time_t *Time)
		extrn time:dword	; DATA XREF: sub_4186C0r
; int __cdecl toupper(int C)
		extrn toupper:dword	; CODE XREF: .text:00413E2Dp
					; .text:00413E42p ...
; int __cdecl vfprintf(FILE *File, const char *Format, va_list ArgList)
		extrn __imp_vfprintf:dword ; DATA XREF:	vfprintfr

;
; Imports from USER32.dll
;
; BOOL __stdcall AllowSetForegroundWindow(DWORD	dwProcessId)
		extrn AllowSetForegroundWindow:dword ; CODE XREF: .text:00405261p
					; DATA XREF: .text:0040525Cr
; int __stdcall	MessageBoxA(HWND hWnd, LPCSTR lpText, LPCSTR lpCaption,	UINT uType)
		extrn MessageBoxA:dword	; CODE XREF: sub_4183C0+122p
					; DATA XREF: sub_4183C0+122r

;
; Imports from WS2_32.dll
;
; int __stdcall	WSAStartup(WORD	wVersionRequested, LPWSADATA lpWSAData)
		extrn WSAStartup:dword	; CODE XREF: sub_4054EC+2Bp
					; DATA XREF: sub_4054EC+26r


; Section 6. (virtual address 0001F000)
; Virtual size			: 00000034 (	 52.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0001C000
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_CRT		segment	dword public 'DATA' use32
		assume cs:_CRT
		;org 41F000h
dword_41F000	dd 0			; DATA XREF: sub_401180+2D8o
		dd offset sub_401010
dword_41F008	dd 0			; DATA XREF: sub_401180:loc_401450o
dword_41F00C	dd 0			; DATA XREF: sub_401180+316o
		dd offset sub_401060
		dd offset sub_416FE0
dword_41F018	dd 2 dup(0)		; DATA XREF: sub_401180+30Eo
TlsCallbacks	dd offset TlsCallback_0	; DATA XREF: .tls:TlsCallbacks_ptro
		dd offset TlsCallback_1
		dd 0
		align 10h
dword_41F030	dd 74h dup(0)		; DATA XREF: TlsCallback_0:loc_416F83o
					; TlsCallback_0+138o ...
		align 1000h
_CRT		ends

; Section 7. (virtual address 00020000)
; Virtual size			: 00000020 (	 32.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0001C200
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_tls		segment	dword public 'DATA' use32
		assume cs:_tls
		;org 420000h
TlsDirectory	dd offset TlsStart
TlsEnd_ptr	dd offset TlsEnd
TlsIndex_ptr	dd offset TlsIndex
TlsCallbacks_ptr dd offset TlsCallbacks
TlsSizeOfZeroFill dd 0
TlsCharacteristics dd 0
		db 0
TlsStart	db 3 dup(0)		; DATA XREF: .tls:TlsDirectoryo
TlsEnd		dd 79h dup(0)		; DATA XREF: .tls:TlsEnd_ptro
		align 1000h
_tls		ends


		end start
